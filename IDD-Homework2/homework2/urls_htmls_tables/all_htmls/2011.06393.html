<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2011.06393] Heterogeneous Data-Aware Federated Learning</title><meta property="og:description" content="Federated learning (FL) is an appealing concept to perform distributed training of Neural Networks (NN) while keeping data private. With the industrialization of the FL framework, we identify several problems hampering…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Heterogeneous Data-Aware Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Heterogeneous Data-Aware Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2011.06393">

<!--Generated on Tue Mar 19 04:52:43 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Heterogeneous Data-Aware Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Lixuan YANG
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Cedric BELIARD
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dario ROSSI
Huawei Technologies Co. Ltd
{lixuan.yang, cedric.beliard, dario.rossi}@huawei.com
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated learning (FL) is an appealing concept to perform distributed training of Neural Networks (NN) while keeping data private. With the industrialization of the FL framework, we identify several problems hampering its successful deployment, such as presence of non i.i.d data, disjoint classes, signal multi-modality across datasets. In this work, we address these problems by proposing a novel method that not only (1) aggregates generic model parameters (e.g. a common set of task generic NN layers) on server (e.g. in traditional FL), but also (2) keeps a set of parameters (e.g, a set of task specific NN layer) specific to each client.
We validate our method on the traditionally used public benchmarks (e.g., Femnist) as well as on our proprietary collected dataset (i.e., traffic classification). Results show the benefit of our method, with significant advantage on extreme cases.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Summary of the State of the Art Federated Learning Methods</figcaption>
<table id="S1.T1.1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S1.T1.1.1.2.1" class="ltx_tr">
<th id="S1.T1.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S1.T1.1.1.2.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Paper</span></th>
<td id="S1.T1.1.1.2.1.2" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.2.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Client</span></td>
<td id="S1.T1.1.1.2.1.3" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.2.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Aggregation</span></td>
<td id="S1.T1.1.1.2.1.4" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.2.1.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Loss</span></td>
<td id="S1.T1.1.1.2.1.5" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.2.1.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Information</span></td>
<td id="S1.T1.1.1.2.1.6" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.2.1.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Model</span></td>
</tr>
<tr id="S1.T1.1.1.3.2" class="ltx_tr">
<th id="S1.T1.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S1.T1.1.1.3.2.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">[Year]</span></th>
<td id="S1.T1.1.1.3.2.2" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.3.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Selection</span></td>
<td id="S1.T1.1.1.3.2.3" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.3.2.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">function</span></td>
<td id="S1.T1.1.1.3.2.4" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.3.2.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">function</span></td>
<td id="S1.T1.1.1.3.2.5" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.3.2.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Exchanged</span></td>
<td id="S1.T1.1.1.3.2.6" class="ltx_td"></td>
</tr>
<tr id="S1.T1.1.1.4.3" class="ltx_tr">
<th id="S1.T1.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S1.T1.1.1.4.3.1.1" class="ltx_text" style="font-size:90%;">FedAvg </span><cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> <span id="S1.T1.1.1.4.3.1.2.1.1.1" class="ltx_text" style="font-size:90%;">(</span><a href="#bib.bib10" title="" class="ltx_ref">2016</a><span id="S1.T1.1.1.4.3.1.3.2.2.1" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S1.T1.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.1.1.4.3.2.1" class="ltx_text" style="font-size:90%;">Random</span></td>
<td id="S1.T1.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.1.1.4.3.3.1" class="ltx_text" style="font-size:90%;">Avg</span></td>
<td id="S1.T1.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.1.1.4.3.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S1.T1.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.1.1.4.3.5.1" class="ltx_text" style="font-size:90%;">Model</span></td>
<td id="S1.T1.1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.1.1.4.3.6.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S1.T1.1.1.5.4" class="ltx_tr">
<th id="S1.T1.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S1.T1.1.1.5.4.1.1" class="ltx_text" style="font-size:90%;">FedProx </span><cite class="ltx_cite ltx_citemacro_cite">Sahu <span class="ltx_text ltx_font_italic">et al.</span> <span id="S1.T1.1.1.5.4.1.2.1.1.1" class="ltx_text" style="font-size:90%;">(</span><a href="#bib.bib12" title="" class="ltx_ref">2018</a><span id="S1.T1.1.1.5.4.1.3.2.2.1" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S1.T1.1.1.5.4.2" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.5.4.2.1" class="ltx_text" style="font-size:90%;">Random</span></td>
<td id="S1.T1.1.1.5.4.3" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.5.4.3.1" class="ltx_text" style="font-size:90%;">Avg</span></td>
<td id="S1.T1.1.1.5.4.4" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.5.4.4.1" class="ltx_text" style="font-size:90%;">Custom</span></td>
<td id="S1.T1.1.1.5.4.5" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.5.4.5.1" class="ltx_text" style="font-size:90%;">Model</span></td>
<td id="S1.T1.1.1.5.4.6" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.5.4.6.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S1.T1.1.1.6.5" class="ltx_tr">
<th id="S1.T1.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><cite class="ltx_cite ltx_citemacro_cite">Zhao <span class="ltx_text ltx_font_italic">et al.</span> <span id="S1.T1.1.1.6.5.1.1.1.1.1" class="ltx_text" style="font-size:90%;">(</span><a href="#bib.bib16" title="" class="ltx_ref">2018</a><span id="S1.T1.1.1.6.5.1.2.2.2.1" class="ltx_text" style="font-size:90%;">)</span></cite></th>
<td id="S1.T1.1.1.6.5.2" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.6.5.2.1" class="ltx_text" style="font-size:90%;">Random</span></td>
<td id="S1.T1.1.1.6.5.3" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.6.5.3.1" class="ltx_text" style="font-size:90%;">Avg</span></td>
<td id="S1.T1.1.1.6.5.4" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.6.5.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S1.T1.1.1.6.5.5" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.6.5.5.1" class="ltx_text" style="font-size:90%;">Model+Data(S2C)</span></td>
<td id="S1.T1.1.1.6.5.6" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.6.5.6.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S1.T1.1.1.7.6" class="ltx_tr">
<th id="S1.T1.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><cite class="ltx_cite ltx_citemacro_cite">Anil <span class="ltx_text ltx_font_italic">et al.</span> <span id="S1.T1.1.1.7.6.1.1.1.1.1" class="ltx_text" style="font-size:90%;">(</span><a href="#bib.bib1" title="" class="ltx_ref">2018</a><span id="S1.T1.1.1.7.6.1.2.2.2.1" class="ltx_text" style="font-size:90%;">)</span></cite></th>
<td id="S1.T1.1.1.7.6.2" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.7.6.2.1" class="ltx_text" style="font-size:90%;">Random</span></td>
<td id="S1.T1.1.1.7.6.3" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.7.6.3.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S1.T1.1.1.7.6.4" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.7.6.4.1" class="ltx_text" style="font-size:90%;">Distillation</span></td>
<td id="S1.T1.1.1.7.6.5" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.7.6.5.1" class="ltx_text" style="font-size:90%;">Model</span></td>
<td id="S1.T1.1.1.7.6.6" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.7.6.6.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S1.T1.1.1.1" class="ltx_tr">
<th id="S1.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><cite class="ltx_cite ltx_citemacro_cite">Jeong <span class="ltx_text ltx_font_italic">et al.</span> <span id="S1.T1.1.1.1.2.1.1.1.1" class="ltx_text" style="font-size:90%;">(</span><a href="#bib.bib6" title="" class="ltx_ref">2018</a><span id="S1.T1.1.1.1.2.2.2.2.1" class="ltx_text" style="font-size:90%;">)</span></cite></th>
<td id="S1.T1.1.1.1.3" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.1.3.1" class="ltx_text" style="font-size:90%;">All</span></td>
<td id="S1.T1.1.1.1.4" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.1.4.1" class="ltx_text" style="font-size:90%;">Avg</span></td>
<td id="S1.T1.1.1.1.5" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.1.5.1" class="ltx_text" style="font-size:90%;">Distillation</span></td>
<td id="S1.T1.1.1.1.1" class="ltx_td ltx_align_center">
<span id="S1.T1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">Each class 1 vector</span><math id="S1.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S1.T1.1.1.1.1.m1.1a"><mo mathsize="90%" id="S1.T1.1.1.1.1.m1.1.1" xref="S1.T1.1.1.1.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S1.T1.1.1.1.1.m1.1b"><ci id="S1.T1.1.1.1.1.m1.1.1.cmml" xref="S1.T1.1.1.1.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.1.1.1.1.m1.1c">\star</annotation></semantics></math>
</td>
<td id="S1.T1.1.1.1.6" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.1.6.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S1.T1.1.1.8.7" class="ltx_tr">
<th id="S1.T1.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S1.T1.1.1.8.7.1.1" class="ltx_text" style="font-size:90%;">Agnos </span><cite class="ltx_cite ltx_citemacro_cite">Mohri <span class="ltx_text ltx_font_italic">et al.</span> <span id="S1.T1.1.1.8.7.1.2.1.1.1" class="ltx_text" style="font-size:90%;">(</span><a href="#bib.bib11" title="" class="ltx_ref">2019</a><span id="S1.T1.1.1.8.7.1.3.2.2.1" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S1.T1.1.1.8.7.2" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.8.7.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S1.T1.1.1.8.7.3" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.8.7.3.1" class="ltx_text" style="font-size:90%;">Avg</span></td>
<td id="S1.T1.1.1.8.7.4" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.8.7.4.1" class="ltx_text" style="font-size:90%;">Custom</span></td>
<td id="S1.T1.1.1.8.7.5" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.8.7.5.1" class="ltx_text" style="font-size:90%;">Distribution Update</span></td>
<td id="S1.T1.1.1.8.7.6" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.8.7.6.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S1.T1.1.1.9.8" class="ltx_tr">
<th id="S1.T1.1.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S1.T1.1.1.9.8.1.1" class="ltx_text" style="font-size:90%;">LG </span><cite class="ltx_cite ltx_citemacro_cite">Liang <span class="ltx_text ltx_font_italic">et al.</span> <span id="S1.T1.1.1.9.8.1.2.1.1.1" class="ltx_text" style="font-size:90%;">(</span><a href="#bib.bib9" title="" class="ltx_ref">2019</a><span id="S1.T1.1.1.9.8.1.3.2.2.1" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S1.T1.1.1.9.8.2" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.9.8.2.1" class="ltx_text" style="font-size:90%;">Random</span></td>
<td id="S1.T1.1.1.9.8.3" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.9.8.3.1" class="ltx_text" style="font-size:90%;">Avg</span></td>
<td id="S1.T1.1.1.9.8.4" class="ltx_td ltx_align_center">
<span id="S1.T1.1.1.9.8.4.1" class="ltx_inline-block">
<span id="S1.T1.1.1.9.8.4.1.1" class="ltx_p"><span id="S1.T1.1.1.9.8.4.1.1.1" class="ltx_text" style="font-size:90%;">Softmax+</span></span>
<span id="S1.T1.1.1.9.8.4.1.2" class="ltx_p"><span id="S1.T1.1.1.9.8.4.1.2.1" class="ltx_text" style="font-size:90%;">feature learning</span></span>
</span>
</td>
<td id="S1.T1.1.1.9.8.5" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.9.8.5.1" class="ltx_text" style="font-size:90%;">partial model</span></td>
<td id="S1.T1.1.1.9.8.6" class="ltx_td ltx_align_center">
<span id="S1.T1.1.1.9.8.6.1" class="ltx_inline-block">
<span id="S1.T1.1.1.9.8.6.1.1" class="ltx_p"><span id="S1.T1.1.1.9.8.6.1.1.1" class="ltx_text" style="font-size:90%;">Feature Extractor +</span></span>
<span id="S1.T1.1.1.9.8.6.1.2" class="ltx_p"><span id="S1.T1.1.1.9.8.6.1.2.1" class="ltx_text" style="font-size:90%;">Class Predictor</span></span>
</span>
</td>
</tr>
<tr id="S1.T1.1.1.10.9" class="ltx_tr">
<th id="S1.T1.1.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><cite class="ltx_cite ltx_citemacro_cite">Sattler <span class="ltx_text ltx_font_italic">et al.</span> <span id="S1.T1.1.1.10.9.1.1.1.1.1" class="ltx_text" style="font-size:90%;">(</span><a href="#bib.bib14" title="" class="ltx_ref">2019</a><span id="S1.T1.1.1.10.9.1.2.2.2.1" class="ltx_text" style="font-size:90%;">)</span></cite></th>
<td id="S1.T1.1.1.10.9.2" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.10.9.2.1" class="ltx_text" style="font-size:90%;">Clustering</span></td>
<td id="S1.T1.1.1.10.9.3" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.10.9.3.1" class="ltx_text" style="font-size:90%;">Avg</span></td>
<td id="S1.T1.1.1.10.9.4" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.10.9.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S1.T1.1.1.10.9.5" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.10.9.5.1" class="ltx_text" style="font-size:90%;">Model</span></td>
<td id="S1.T1.1.1.10.9.6" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.10.9.6.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S1.T1.1.1.11.10" class="ltx_tr">
<th id="S1.T1.1.1.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S1.T1.1.1.11.10.1.1" class="ltx_text" style="font-size:90%;">q-FFL</span><cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> <span id="S1.T1.1.1.11.10.1.2.1.1.1" class="ltx_text" style="font-size:90%;">(</span><a href="#bib.bib8" title="" class="ltx_ref">2019</a><span id="S1.T1.1.1.11.10.1.3.2.2.1" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S1.T1.1.1.11.10.2" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.11.10.2.1" class="ltx_text" style="font-size:90%;">Random</span></td>
<td id="S1.T1.1.1.11.10.3" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.11.10.3.1" class="ltx_text" style="font-size:90%;">Reweight Avg</span></td>
<td id="S1.T1.1.1.11.10.4" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.11.10.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S1.T1.1.1.11.10.5" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.11.10.5.1" class="ltx_text" style="font-size:90%;">Model+qValue</span></td>
<td id="S1.T1.1.1.11.10.6" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.11.10.6.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S1.T1.1.1.12.11" class="ltx_tr">
<th id="S1.T1.1.1.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><cite class="ltx_cite ltx_citemacro_cite">Izbicki and Shelton <span id="S1.T1.1.1.12.11.1.1.1.1.1" class="ltx_text" style="font-size:90%;">(</span><a href="#bib.bib5" title="" class="ltx_ref">2019</a><span id="S1.T1.1.1.12.11.1.2.2.2.1" class="ltx_text" style="font-size:90%;">)</span></cite></th>
<td id="S1.T1.1.1.12.11.2" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.12.11.2.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S1.T1.1.1.12.11.3" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.12.11.3.1" class="ltx_text" style="font-size:90%;">Reweight Avg</span></td>
<td id="S1.T1.1.1.12.11.4" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.12.11.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S1.T1.1.1.12.11.5" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.12.11.5.1" class="ltx_text" style="font-size:90%;">Model</span></td>
<td id="S1.T1.1.1.12.11.6" class="ltx_td ltx_align_center"><span id="S1.T1.1.1.12.11.6.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S1.T1.1.1.13.12" class="ltx_tr">
<th id="S1.T1.1.1.13.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><em id="S1.T1.1.1.13.12.1.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">this paper</em></th>
<td id="S1.T1.1.1.13.12.2" class="ltx_td ltx_align_center ltx_border_t"><em id="S1.T1.1.1.13.12.2.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">Random</em></td>
<td id="S1.T1.1.1.13.12.3" class="ltx_td ltx_align_center ltx_border_t"><em id="S1.T1.1.1.13.12.3.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">Avg</em></td>
<td id="S1.T1.1.1.13.12.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.1.1.13.12.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S1.T1.1.1.13.12.5" class="ltx_td ltx_align_center ltx_border_t"><em id="S1.T1.1.1.13.12.5.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">generic parameters</em></td>
<td id="S1.T1.1.1.13.12.6" class="ltx_td ltx_align_center ltx_border_t"><em id="S1.T1.1.1.13.12.6.1" class="ltx_emph ltx_font_italic" style="font-size:90%;">generic + specific</em></td>
</tr>
</tbody>
</table>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Machine learning and particularly Neural Network (NN) models are now tremendously popular to solve computer vision, natural language processing and networking problems. Proper <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">model training in centralized settings</em> is not without challenges. On the one hand, centralized training raises data sharing concerns, both in terms of transfer volumes and data privacy – which in European countries is very critical due to the recent stringent regulation on private data protection (GDPR).
On the other hand, model training on individual datasets helps solving data sharing concerns, yet generates portability/generalization issues.
To circumvent the above concerns, <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite> introduced the notion of <em id="S1.p1.1.2" class="ltx_emph ltx_font_italic">Federated Learning (FL)</em>, that has a number of appealing properties. First and foremost, FL allows for collaboratively training the model, without having to share the data. Second, sharing models allow additionally to save significant data transfer volume, yielding beneficial cost reduction in cloud-based models (as charging also depends on data transfer). Third, distributed training also reinforces the generalization capabilities of the model.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">However, FL is not without downsides.
First and foremost, even (0) sharing models can be a sensitive issue, either due to the presence of multiple stackholders, or due to stringent regulation. Additionally, in practical deployment scenarios data exhibit properties such as (1) Class imbalance, (2) Disjoint class distribution and (3) Signal multi-modality within each class across datasets,
which lead to model divergence and could limit the practical relevance of FL models.
To make FL viable in presence of (0) model sharing constraints, while at the same time handling the above (1)-(3) data characteristics, we propose in this paper a novel method where clients are not only able to benefit from model sharing, but also and especially retain the ability to <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">keep secret</em> and <em id="S1.p2.1.2" class="ltx_emph ltx_font_italic">specialize</em> part of their model, to respectively handle problems (0) and (1)-(3).
We argue this can be achieved by <em id="S1.p2.1.3" class="ltx_emph ltx_font_italic">divide et impera</em>: in a nutshell, in the NN architecture we isolate a common generic parameters from the client-specific parameters, and treat them differently in the distributed training process.
In particular, we propose that each client keeps a private and independent classifier, while sharing the common feature extraction process by averaging the generic parameters: so doing, clients benefit by the global learning process, whilst being able to keep their own (private) differences at the same time.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">We perform a thorough performance evaluation of our proposed Heterogeneous Data Aware Federated Learning (HDAFL) approach, contrasting it with the classic benchmark in the state of the art, namely <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite>. We leverage different datasets, including the classic FEMNIST dataset, which exhibits characteristics (1)-(2), as well as very large proprietary dataset for TCP/IP traffic classification which which exhibits characteristics (1)-(3). Results show that HDAFL improves the local and global system accuracy, even slightly reducing the volume of information exchanged, which makes FL of practical relevance in real-world situations.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In the rest of this paper, we overview the related work (Sec 2), and contextualize our applications and dataset (Sec 3). We next outline our method (Sec 4), contrast its performance with the state of the art (Sec 5) and summarize our findings (Sec 6).</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>State of the art</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite> pioneered FL by proposing the Federated Averaging (FedAvg) algorithm. This
ignited valuable FL research, that we compactly summarize in Tab.<a href="#S1.T1" title="Table 1 ‣ 1 Introduction ‣ Heterogeneous Data-Aware Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and briefly overview in this section.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Complexity</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">A first wave of research was directed into reducing the communication complexity. For instance,
<cite class="ltx_cite ltx_citemacro_cite">Konecný <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2016</a>)</cite> proposed the model compression and random sampling to send less data possible in each round of communication. <cite class="ltx_cite ltx_citemacro_cite">Izbicki and Shelton (<a href="#bib.bib5" title="" class="ltx_ref">2019</a>)</cite> proposed an extreme case of one round of communication that used a subset of data in server to estimate the optimal merge weights subspace. Other proposals use knowledge distillation for the model aggregation as in <cite class="ltx_cite ltx_citemacro_cite">Anil <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite>, that propose a CoDistillation that the clients use the other clients’ model as teacher model. To economise the communication cost, In <cite class="ltx_cite ltx_citemacro_cite">Jeong <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib6" title="" class="ltx_ref">2018</a>)</cite>, the clients uses directly the average predictions of each class as teacher’s output, these predictions are aggregated in server.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Another stringent constraint in real world is
the computational bottleneck due to system heterogeneity: <cite class="ltx_cite ltx_citemacro_cite">Sahu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib12" title="" class="ltx_ref">2018</a>)</cite> propose a <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\gamma</annotation></semantics></math>-inexactness to measure the amount of local computation from the local solver, while <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite> assign higher weights to devices with poor performance in order to reduce variance.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Data characteristics</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">While the above methods works well on ideal data,  <cite class="ltx_cite ltx_citemacro_cite">Sattler <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2019</a>); Zhao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite> proved that FedAvg diverges in presence of non i.i.d. data or adversarial behavior: this fueled further research to tackle specific aspects of the data, closer to our work.
For instance, to counter the multi-modality problem, the Clustered federated learning proposed by <cite class="ltx_cite ltx_citemacro_cite">Sattler <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite> groups clients by using the cosine similarity of gradient updates, and applying FedAvg in each clusters (for clusters that fail to converge, the clients in that cluster will be bi-partitioned).</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">For non i.i.d data, not only the global distribution is unknown as pointed out by <cite class="ltx_cite ltx_citemacro_cite">Zhao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite>, but and the model divergence coming from weights difference is fundamentally rooted in the data distribution distance
as proven in <cite class="ltx_cite ltx_citemacro_cite">Mohri <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>. To counter these problems, <cite class="ltx_cite ltx_citemacro_cite">Zhao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite> finds that the globally shared data (from server back to clients) reduces weight divergence, which however poses additional privacy problems. <cite class="ltx_cite ltx_citemacro_cite">Mohri <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite> instead propose to optimize a global loss function over all possible distributions. Finally, <cite class="ltx_cite ltx_citemacro_cite">Sahu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib12" title="" class="ltx_ref">2018</a>)</cite> handles non i.i.d data by restricting local updates to be closer to the global model.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">Closest to our work is Local Global FL (LG-FedAvg) by <cite class="ltx_cite ltx_citemacro_cite">Liang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite>, which relies on local data to learn representation on devices and distribute a partial model that predicts on compact feature. Interestingly, LG-FedAvg is similar to our work, as <em id="S2.SS2.p3.1.1" class="ltx_emph ltx_font_italic">only part</em> of the model is shared: however, we make an opposite choice wrt LG-FedAvg about <em id="S2.SS2.p3.1.2" class="ltx_emph ltx_font_italic">which part</em> of the model should be shared, as LG-FedAvg aggregate the specific parameters in the central server.
Roughly speaking, the success of CNN is mainly based on the feature extraction, the specific parameters are just a projection of the feature vector: thus, LG-FedAvg supposes that each client has enough data to train a local feature extractor, which we instead argue not to be always the case. In contrast with LG-FedAvg, we aggregate the common generic parameters of initial layers, i.e., the process of feature extraction. Consequently, client profits from the rich feature extraction from entire data, while further being able to specialize the specific layer to comply with to cope with heterogeneous data, unlike LG-FedAvg.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Applications (and Datasets)</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">For a stackholder such as Huawei, the field of application for AI technologies is broader than the classic image recognition domain, and includes workflows typical of Internet Service Providers. As such, we consider here two example of applications, notably (1) image recognition and (2) the classification of Internet traffic, along with two respective datasets, whose volumes are compactly summarized and illustrated in Fig. <a href="#S3.F1" title="Figure 1 ‣ 3.2 TCP/IP Traffic classification (Huawei) ‣ 3 Applications (and Datasets) ‣ Heterogeneous Data-Aware Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. In this section, we describe relevant characteristics of the datasets, further examplifying the aforementioned properties.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Image recognition (FEMNIST)</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">As typically done in the FL literature, we consider an image recognition application. In the LEAF benchmark, we selected the Federated Extended Mnist (FEMNIST) dataset. The FEMNIST dataset comprises 805k samples of 62 classes including digits and character, and is extensively described by <cite class="ltx_cite ltx_citemacro_cite">Cohen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib3" title="" class="ltx_ref">2017</a>); Caldas <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>, to which we refer the interested reader.
As this dataset is the most commonly used in the FL literature <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>, this allows to readily put results in perspective with the related work.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>TCP/IP Traffic classification (Huawei)</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">We leverage a large proprietary dataset, collected at two different clients representative of Home and Enterprise business respectively, for the purpose of network traffic classification, which is a key function of network traffic management.
Class labels represent fine-grained Internet applications, while input signal are timeseries of the size of the first 10 packets, which are known to have a high discriminative power for the classification task by  <cite class="ltx_cite ltx_citemacro_cite">Crotti <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib4" title="" class="ltx_ref">2007</a>)</cite> and be amenable to real-time inference by <cite class="ltx_cite ltx_citemacro_cite">Santiago <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib13" title="" class="ltx_ref">2012</a>)</cite>, and are well suited as input of a 1D-CNN architecture. This dataset represent a different operational point as it has more than twice of the samples and about half of the classes than FEMNIST.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Datasets at a glance.</figcaption>
<table id="S3.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T2.1.1.1" class="ltx_tr">
<th id="S3.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Application</span></th>
<td id="S3.T2.1.1.1.2" class="ltx_td ltx_align_center">
<span id="S3.T2.1.1.1.2.1" class="ltx_inline-block">
<span id="S3.T2.1.1.1.2.1.1" class="ltx_p"><span id="S3.T2.1.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Image</span></span>
<span id="S3.T2.1.1.1.2.1.2" class="ltx_p"><span id="S3.T2.1.1.1.2.1.2.1" class="ltx_text ltx_font_bold">recognition</span></span>
</span>
</td>
<td id="S3.T2.1.1.1.3" class="ltx_td ltx_align_center">
<span id="S3.T2.1.1.1.3.1" class="ltx_inline-block">
<span id="S3.T2.1.1.1.3.1.1" class="ltx_p"><span id="S3.T2.1.1.1.3.1.1.1" class="ltx_text ltx_font_bold">Traffic</span></span>
<span id="S3.T2.1.1.1.3.1.2" class="ltx_p"><span id="S3.T2.1.1.1.3.1.2.1" class="ltx_text ltx_font_bold">classification</span></span>
</span>
</td>
</tr>
<tr id="S3.T2.1.2.2" class="ltx_tr">
<th id="S3.T2.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Dataset</th>
<td id="S3.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">FEMNIST</td>
<td id="S3.T2.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">Huawei</td>
</tr>
<tr id="S3.T2.1.3.3" class="ltx_tr">
<th id="S3.T2.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Availability</th>
<td id="S3.T2.1.3.3.2" class="ltx_td ltx_align_center">Public</td>
<td id="S3.T2.1.3.3.3" class="ltx_td ltx_align_center">Proprietary</td>
</tr>
<tr id="S3.T2.1.4.4" class="ltx_tr">
<th id="S3.T2.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Samples</th>
<td id="S3.T2.1.4.4.2" class="ltx_td ltx_align_center">805k</td>
<td id="S3.T2.1.4.4.3" class="ltx_td ltx_align_center">1.9M</td>
</tr>
<tr id="S3.T2.1.5.5" class="ltx_tr">
<th id="S3.T2.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Sources</th>
<td id="S3.T2.1.5.5.2" class="ltx_td ltx_align_center">
<span id="S3.T2.1.5.5.2.1" class="ltx_inline-block">
<span id="S3.T2.1.5.5.2.1.1" class="ltx_p">3.5k</span>
<span id="S3.T2.1.5.5.2.1.2" class="ltx_p">writers</span>
</span>
</td>
<td id="S3.T2.1.5.5.3" class="ltx_td ltx_align_center">
<span id="S3.T2.1.5.5.3.1" class="ltx_inline-block">
<span id="S3.T2.1.5.5.3.1.1" class="ltx_p">2</span>
<span id="S3.T2.1.5.5.3.1.2" class="ltx_p">networks</span>
</span>
</td>
</tr>
<tr id="S3.T2.1.6.6" class="ltx_tr">
<th id="S3.T2.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">Classes</th>
<td id="S3.T2.1.6.6.2" class="ltx_td ltx_align_center ltx_border_b">62</td>
<td id="S3.T2.1.6.6.3" class="ltx_td ltx_align_center ltx_border_b">35</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2011.06393/assets/x1.png" id="S3.F1.1.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="369" height="234" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2011.06393/assets/x2.png" id="S3.F1.2.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="461" height="133" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Example of real-world data characteristics in the Huawei TCP/IP dataset: non i.i.d and disjoint data distribution for 10 classes (top plot); example of multi-modal signal for the same class across two clients (bottom plot).
</figcaption>
</figure>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Network traffic comes from two different environment: namely home users’ households vs enterprise business, that can be considered as clients in the FL terminology. This client mixture explains non i.i.d properties of the data: the top plot of Fig.<a href="#S3.F1" title="Figure 1 ‣ 3.2 TCP/IP Traffic classification (Huawei) ‣ 3 Applications (and Datasets) ‣ Heterogeneous Data-Aware Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> depicts 10 samples showing that, as expected, some applications are prevalent in the enterprise environment (such as Skype for business, ExpressVPN, NetBIOS, etc.) while others are exclusively present in the home environment (such as SopCast) so that class labels are even <em id="S3.SS2.p2.1.1" class="ltx_emph ltx_font_italic">disjoint</em> in the two networks.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">Further, from Fig.<a href="#S3.F1" title="Figure 1 ‣ 3.2 TCP/IP Traffic classification (Huawei) ‣ 3 Applications (and Datasets) ‣ Heterogeneous Data-Aware Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-(bottom) notice that applications present in both datasets (DouYouTV in the example) can further exhibit signal multi-modality, as clearly shown in the heatmap of the signal component (y-axis, color encodes the size and direction of the first 10 packets from bottom to top) for different traffic samples (x-axis) in the Home vs Enterprise clients.
Multi-modality is related to the physics of the underlying network and its interaction with specific applications: e.g., for some applications, different environments tied to specific network technologies (e.g., access type, encapsulations) and configuration (e.g., firewalls, NATs) trigger different behavioral modes, which yield to specific and non portable signatures.
While this is perfectly normal and not done on purpose (e.g., to try to “evade” traffic classification), the resulting effect on training can be seen as adversarial with respect to what discussed in <cite class="ltx_cite ltx_citemacro_cite">Sattler <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2019</a>); Zhao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite>, and need to be dealt with.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Our proposed approach relies on convolutional neural networks architectures. CNNs are commonly composed of first stacked convolutional layers and then fully connected layers. <cite class="ltx_cite ltx_citemacro_cite">Yosinski <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib15" title="" class="ltx_ref">2014</a>)</cite> demonstrated that, moving from first layers to last layers, the features also transit from generic to specific. The network parameters can be categorized into two groups: generic parameters are common across different tasks, whilst task specific parameters convert it to high level representation.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> HDAFL</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Server executes</span>:

</div>
<div id="alg1.l2" class="ltx_listingline">  initialize <math id="alg1.l2.m1.2" class="ltx_Math" alttext="wb_{0},wl_{0}" display="inline"><semantics id="alg1.l2.m1.2a"><mrow id="alg1.l2.m1.2.2.2" xref="alg1.l2.m1.2.2.3.cmml"><mrow id="alg1.l2.m1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.cmml"><mi id="alg1.l2.m1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.cmml">​</mo><msub id="alg1.l2.m1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.1.1.3.2" xref="alg1.l2.m1.1.1.1.1.3.2.cmml">b</mi><mn id="alg1.l2.m1.1.1.1.1.3.3" xref="alg1.l2.m1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="alg1.l2.m1.2.2.2.3" xref="alg1.l2.m1.2.2.3.cmml">,</mo><mrow id="alg1.l2.m1.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.cmml"><mi id="alg1.l2.m1.2.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.2.2.2.2.1" xref="alg1.l2.m1.2.2.2.2.1.cmml">​</mo><msub id="alg1.l2.m1.2.2.2.2.3" xref="alg1.l2.m1.2.2.2.2.3.cmml"><mi id="alg1.l2.m1.2.2.2.2.3.2" xref="alg1.l2.m1.2.2.2.2.3.2.cmml">l</mi><mn id="alg1.l2.m1.2.2.2.2.3.3" xref="alg1.l2.m1.2.2.2.2.3.3.cmml">0</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><list id="alg1.l2.m1.2.2.3.cmml" xref="alg1.l2.m1.2.2.2"><apply id="alg1.l2.m1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1"><times id="alg1.l2.m1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1"></times><ci id="alg1.l2.m1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.2">𝑤</ci><apply id="alg1.l2.m1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l2.m1.1.1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.1.1.3.2">𝑏</ci><cn type="integer" id="alg1.l2.m1.1.1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.1.1.3.3">0</cn></apply></apply><apply id="alg1.l2.m1.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2"><times id="alg1.l2.m1.2.2.2.2.1.cmml" xref="alg1.l2.m1.2.2.2.2.1"></times><ci id="alg1.l2.m1.2.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.2">𝑤</ci><apply id="alg1.l2.m1.2.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.2.2.3.1.cmml" xref="alg1.l2.m1.2.2.2.2.3">subscript</csymbol><ci id="alg1.l2.m1.2.2.2.2.3.2.cmml" xref="alg1.l2.m1.2.2.2.2.3.2">𝑙</ci><cn type="integer" id="alg1.l2.m1.2.2.2.2.3.3.cmml" xref="alg1.l2.m1.2.2.2.2.3.3">0</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">wb_{0},wl_{0}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">  <span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.1" class="ltx_Math" alttext="eachclientkinparallel" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1a" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.4" xref="alg1.l3.m1.1.1.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1b" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.5" xref="alg1.l3.m1.1.1.5.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1c" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.6" xref="alg1.l3.m1.1.1.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1d" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.7" xref="alg1.l3.m1.1.1.7.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1e" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.8" xref="alg1.l3.m1.1.1.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1f" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.9" xref="alg1.l3.m1.1.1.9.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1g" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.10" xref="alg1.l3.m1.1.1.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1h" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.11" xref="alg1.l3.m1.1.1.11.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1i" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.12" xref="alg1.l3.m1.1.1.12.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1j" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.13" xref="alg1.l3.m1.1.1.13.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1k" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.14" xref="alg1.l3.m1.1.1.14.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1l" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.15" xref="alg1.l3.m1.1.1.15.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1m" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.16" xref="alg1.l3.m1.1.1.16.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1n" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.17" xref="alg1.l3.m1.1.1.17.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1o" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.18" xref="alg1.l3.m1.1.1.18.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1p" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.19" xref="alg1.l3.m1.1.1.19.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1q" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.20" xref="alg1.l3.m1.1.1.20.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1r" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.21" xref="alg1.l3.m1.1.1.21.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.1s" xref="alg1.l3.m1.1.1.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.22" xref="alg1.l3.m1.1.1.22.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><times id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></times><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑒</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑎</ci><ci id="alg1.l3.m1.1.1.4.cmml" xref="alg1.l3.m1.1.1.4">𝑐</ci><ci id="alg1.l3.m1.1.1.5.cmml" xref="alg1.l3.m1.1.1.5">ℎ</ci><ci id="alg1.l3.m1.1.1.6.cmml" xref="alg1.l3.m1.1.1.6">𝑐</ci><ci id="alg1.l3.m1.1.1.7.cmml" xref="alg1.l3.m1.1.1.7">𝑙</ci><ci id="alg1.l3.m1.1.1.8.cmml" xref="alg1.l3.m1.1.1.8">𝑖</ci><ci id="alg1.l3.m1.1.1.9.cmml" xref="alg1.l3.m1.1.1.9">𝑒</ci><ci id="alg1.l3.m1.1.1.10.cmml" xref="alg1.l3.m1.1.1.10">𝑛</ci><ci id="alg1.l3.m1.1.1.11.cmml" xref="alg1.l3.m1.1.1.11">𝑡</ci><ci id="alg1.l3.m1.1.1.12.cmml" xref="alg1.l3.m1.1.1.12">𝑘</ci><ci id="alg1.l3.m1.1.1.13.cmml" xref="alg1.l3.m1.1.1.13">𝑖</ci><ci id="alg1.l3.m1.1.1.14.cmml" xref="alg1.l3.m1.1.1.14">𝑛</ci><ci id="alg1.l3.m1.1.1.15.cmml" xref="alg1.l3.m1.1.1.15">𝑝</ci><ci id="alg1.l3.m1.1.1.16.cmml" xref="alg1.l3.m1.1.1.16">𝑎</ci><ci id="alg1.l3.m1.1.1.17.cmml" xref="alg1.l3.m1.1.1.17">𝑟</ci><ci id="alg1.l3.m1.1.1.18.cmml" xref="alg1.l3.m1.1.1.18">𝑎</ci><ci id="alg1.l3.m1.1.1.19.cmml" xref="alg1.l3.m1.1.1.19">𝑙</ci><ci id="alg1.l3.m1.1.1.20.cmml" xref="alg1.l3.m1.1.1.20">𝑙</ci><ci id="alg1.l3.m1.1.1.21.cmml" xref="alg1.l3.m1.1.1.21">𝑒</ci><ci id="alg1.l3.m1.1.1.22.cmml" xref="alg1.l3.m1.1.1.22">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">eachclientkinparallel</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">     <math id="alg1.l4.m1.3" class="ltx_Math" alttext="ClientInit(k,wb_{0},wl_{0})" display="inline"><semantics id="alg1.l4.m1.3a"><mrow id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml"><mi id="alg1.l4.m1.3.3.4" xref="alg1.l4.m1.3.3.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.3" xref="alg1.l4.m1.3.3.3.cmml">​</mo><mi id="alg1.l4.m1.3.3.5" xref="alg1.l4.m1.3.3.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.3a" xref="alg1.l4.m1.3.3.3.cmml">​</mo><mi id="alg1.l4.m1.3.3.6" xref="alg1.l4.m1.3.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.3b" xref="alg1.l4.m1.3.3.3.cmml">​</mo><mi id="alg1.l4.m1.3.3.7" xref="alg1.l4.m1.3.3.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.3c" xref="alg1.l4.m1.3.3.3.cmml">​</mo><mi id="alg1.l4.m1.3.3.8" xref="alg1.l4.m1.3.3.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.3d" xref="alg1.l4.m1.3.3.3.cmml">​</mo><mi id="alg1.l4.m1.3.3.9" xref="alg1.l4.m1.3.3.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.3e" xref="alg1.l4.m1.3.3.3.cmml">​</mo><mi id="alg1.l4.m1.3.3.10" xref="alg1.l4.m1.3.3.10.cmml">I</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.3f" xref="alg1.l4.m1.3.3.3.cmml">​</mo><mi id="alg1.l4.m1.3.3.11" xref="alg1.l4.m1.3.3.11.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.3g" xref="alg1.l4.m1.3.3.3.cmml">​</mo><mi id="alg1.l4.m1.3.3.12" xref="alg1.l4.m1.3.3.12.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.3h" xref="alg1.l4.m1.3.3.3.cmml">​</mo><mi id="alg1.l4.m1.3.3.13" xref="alg1.l4.m1.3.3.13.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.3i" xref="alg1.l4.m1.3.3.3.cmml">​</mo><mrow id="alg1.l4.m1.3.3.2.2" xref="alg1.l4.m1.3.3.2.3.cmml"><mo stretchy="false" id="alg1.l4.m1.3.3.2.2.3" xref="alg1.l4.m1.3.3.2.3.cmml">(</mo><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">k</mi><mo id="alg1.l4.m1.3.3.2.2.4" xref="alg1.l4.m1.3.3.2.3.cmml">,</mo><mrow id="alg1.l4.m1.2.2.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.cmml"><mi id="alg1.l4.m1.2.2.1.1.1.2" xref="alg1.l4.m1.2.2.1.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.2.2.1.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.cmml">​</mo><msub id="alg1.l4.m1.2.2.1.1.1.3" xref="alg1.l4.m1.2.2.1.1.1.3.cmml"><mi id="alg1.l4.m1.2.2.1.1.1.3.2" xref="alg1.l4.m1.2.2.1.1.1.3.2.cmml">b</mi><mn id="alg1.l4.m1.2.2.1.1.1.3.3" xref="alg1.l4.m1.2.2.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="alg1.l4.m1.3.3.2.2.5" xref="alg1.l4.m1.3.3.2.3.cmml">,</mo><mrow id="alg1.l4.m1.3.3.2.2.2" xref="alg1.l4.m1.3.3.2.2.2.cmml"><mi id="alg1.l4.m1.3.3.2.2.2.2" xref="alg1.l4.m1.3.3.2.2.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.2.2.2.1" xref="alg1.l4.m1.3.3.2.2.2.1.cmml">​</mo><msub id="alg1.l4.m1.3.3.2.2.2.3" xref="alg1.l4.m1.3.3.2.2.2.3.cmml"><mi id="alg1.l4.m1.3.3.2.2.2.3.2" xref="alg1.l4.m1.3.3.2.2.2.3.2.cmml">l</mi><mn id="alg1.l4.m1.3.3.2.2.2.3.3" xref="alg1.l4.m1.3.3.2.2.2.3.3.cmml">0</mn></msub></mrow><mo stretchy="false" id="alg1.l4.m1.3.3.2.2.6" xref="alg1.l4.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.3b"><apply id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3"><times id="alg1.l4.m1.3.3.3.cmml" xref="alg1.l4.m1.3.3.3"></times><ci id="alg1.l4.m1.3.3.4.cmml" xref="alg1.l4.m1.3.3.4">𝐶</ci><ci id="alg1.l4.m1.3.3.5.cmml" xref="alg1.l4.m1.3.3.5">𝑙</ci><ci id="alg1.l4.m1.3.3.6.cmml" xref="alg1.l4.m1.3.3.6">𝑖</ci><ci id="alg1.l4.m1.3.3.7.cmml" xref="alg1.l4.m1.3.3.7">𝑒</ci><ci id="alg1.l4.m1.3.3.8.cmml" xref="alg1.l4.m1.3.3.8">𝑛</ci><ci id="alg1.l4.m1.3.3.9.cmml" xref="alg1.l4.m1.3.3.9">𝑡</ci><ci id="alg1.l4.m1.3.3.10.cmml" xref="alg1.l4.m1.3.3.10">𝐼</ci><ci id="alg1.l4.m1.3.3.11.cmml" xref="alg1.l4.m1.3.3.11">𝑛</ci><ci id="alg1.l4.m1.3.3.12.cmml" xref="alg1.l4.m1.3.3.12">𝑖</ci><ci id="alg1.l4.m1.3.3.13.cmml" xref="alg1.l4.m1.3.3.13">𝑡</ci><vector id="alg1.l4.m1.3.3.2.3.cmml" xref="alg1.l4.m1.3.3.2.2"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑘</ci><apply id="alg1.l4.m1.2.2.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1"><times id="alg1.l4.m1.2.2.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1"></times><ci id="alg1.l4.m1.2.2.1.1.1.2.cmml" xref="alg1.l4.m1.2.2.1.1.1.2">𝑤</ci><apply id="alg1.l4.m1.2.2.1.1.1.3.cmml" xref="alg1.l4.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.2.2.1.1.1.3.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.3">subscript</csymbol><ci id="alg1.l4.m1.2.2.1.1.1.3.2.cmml" xref="alg1.l4.m1.2.2.1.1.1.3.2">𝑏</ci><cn type="integer" id="alg1.l4.m1.2.2.1.1.1.3.3.cmml" xref="alg1.l4.m1.2.2.1.1.1.3.3">0</cn></apply></apply><apply id="alg1.l4.m1.3.3.2.2.2.cmml" xref="alg1.l4.m1.3.3.2.2.2"><times id="alg1.l4.m1.3.3.2.2.2.1.cmml" xref="alg1.l4.m1.3.3.2.2.2.1"></times><ci id="alg1.l4.m1.3.3.2.2.2.2.cmml" xref="alg1.l4.m1.3.3.2.2.2.2">𝑤</ci><apply id="alg1.l4.m1.3.3.2.2.2.3.cmml" xref="alg1.l4.m1.3.3.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.2.2.2.3.1.cmml" xref="alg1.l4.m1.3.3.2.2.2.3">subscript</csymbol><ci id="alg1.l4.m1.3.3.2.2.2.3.2.cmml" xref="alg1.l4.m1.3.3.2.2.2.3.2">𝑙</ci><cn type="integer" id="alg1.l4.m1.3.3.2.2.2.3.3.cmml" xref="alg1.l4.m1.3.3.2.2.2.3.3">0</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.3c">ClientInit(k,wb_{0},wl_{0})</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">  <span id="alg1.l5.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l6" class="ltx_listingline">  <span id="alg1.l6.1" class="ltx_text ltx_font_bold">for</span> each round t=1,2,…,T <span id="alg1.l6.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l7" class="ltx_listingline">     <math id="alg1.l7.m1.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="alg1.l7.m1.1a"><msub id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">S</mi><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑆</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">S_{t}</annotation></semantics></math>=(random set of C clients)

</div>
<div id="alg1.l8" class="ltx_listingline">     <span id="alg1.l8.1" class="ltx_text ltx_font_bold">for</span> each client k in parallel: <span id="alg1.l8.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l9" class="ltx_listingline">        <math id="alg1.l9.m1.1" class="ltx_Math" alttext="wb_{t}^{k}\leftarrow" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.1" xref="alg1.l9.m1.1.1.2.1.cmml">​</mo><msubsup id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml"><mi id="alg1.l9.m1.1.1.2.3.2.2" xref="alg1.l9.m1.1.1.2.3.2.2.cmml">b</mi><mi id="alg1.l9.m1.1.1.2.3.2.3" xref="alg1.l9.m1.1.1.2.3.2.3.cmml">t</mi><mi id="alg1.l9.m1.1.1.2.3.3" xref="alg1.l9.m1.1.1.2.3.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">←</mo><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><times id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2.1"></times><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑤</ci><apply id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.3.1.cmml" xref="alg1.l9.m1.1.1.2.3">superscript</csymbol><apply id="alg1.l9.m1.1.1.2.3.2.cmml" xref="alg1.l9.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.3.2.1.cmml" xref="alg1.l9.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.3.2.2.cmml" xref="alg1.l9.m1.1.1.2.3.2.2">𝑏</ci><ci id="alg1.l9.m1.1.1.2.3.2.3.cmml" xref="alg1.l9.m1.1.1.2.3.2.3">𝑡</ci></apply><ci id="alg1.l9.m1.1.1.2.3.3.cmml" xref="alg1.l9.m1.1.1.2.3.3">𝑘</ci></apply></apply><csymbol cd="latexml" id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">wb_{t}^{k}\leftarrow</annotation></semantics></math> ClientUpdate(k, <math id="alg1.l9.m2.1" class="ltx_Math" alttext="w_{t}" display="inline"><semantics id="alg1.l9.m2.1a"><msub id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">w</mi><mi id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝑤</ci><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">w_{t}</annotation></semantics></math>)

</div>
<div id="alg1.l10" class="ltx_listingline">     <span id="alg1.l10.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11" class="ltx_listingline">     <math id="alg1.l11.m1.1" class="ltx_Math" alttext="wb_{t+1}\leftarrow\sum_{t=1}^{K}\frac{n_{k}}{\sum_{k=1}^{K}n_{k}}wb_{t}^{k}" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mrow id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml"><mi id="alg1.l11.m1.1.1.2.2" xref="alg1.l11.m1.1.1.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.2.1" xref="alg1.l11.m1.1.1.2.1.cmml">​</mo><msub id="alg1.l11.m1.1.1.2.3" xref="alg1.l11.m1.1.1.2.3.cmml"><mi id="alg1.l11.m1.1.1.2.3.2" xref="alg1.l11.m1.1.1.2.3.2.cmml">b</mi><mrow id="alg1.l11.m1.1.1.2.3.3" xref="alg1.l11.m1.1.1.2.3.3.cmml"><mi id="alg1.l11.m1.1.1.2.3.3.2" xref="alg1.l11.m1.1.1.2.3.3.2.cmml">t</mi><mo id="alg1.l11.m1.1.1.2.3.3.1" xref="alg1.l11.m1.1.1.2.3.3.1.cmml">+</mo><mn id="alg1.l11.m1.1.1.2.3.3.3" xref="alg1.l11.m1.1.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo rspace="0.111em" stretchy="false" id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">←</mo><mrow id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><msubsup id="alg1.l11.m1.1.1.3.1" xref="alg1.l11.m1.1.1.3.1.cmml"><mo id="alg1.l11.m1.1.1.3.1.2.2" xref="alg1.l11.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l11.m1.1.1.3.1.2.3" xref="alg1.l11.m1.1.1.3.1.2.3.cmml"><mi id="alg1.l11.m1.1.1.3.1.2.3.2" xref="alg1.l11.m1.1.1.3.1.2.3.2.cmml">t</mi><mo id="alg1.l11.m1.1.1.3.1.2.3.1" xref="alg1.l11.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l11.m1.1.1.3.1.2.3.3" xref="alg1.l11.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l11.m1.1.1.3.1.3" xref="alg1.l11.m1.1.1.3.1.3.cmml">K</mi></msubsup><mrow id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml"><mfrac id="alg1.l11.m1.1.1.3.2.2" xref="alg1.l11.m1.1.1.3.2.2.cmml"><msub id="alg1.l11.m1.1.1.3.2.2.2" xref="alg1.l11.m1.1.1.3.2.2.2.cmml"><mi id="alg1.l11.m1.1.1.3.2.2.2.2" xref="alg1.l11.m1.1.1.3.2.2.2.2.cmml">n</mi><mi id="alg1.l11.m1.1.1.3.2.2.2.3" xref="alg1.l11.m1.1.1.3.2.2.2.3.cmml">k</mi></msub><mrow id="alg1.l11.m1.1.1.3.2.2.3" xref="alg1.l11.m1.1.1.3.2.2.3.cmml"><mstyle displaystyle="false" id="alg1.l11.m1.1.1.3.2.2.3.1" xref="alg1.l11.m1.1.1.3.2.2.3.1.cmml"><msubsup id="alg1.l11.m1.1.1.3.2.2.3.1a" xref="alg1.l11.m1.1.1.3.2.2.3.1.cmml"><mo id="alg1.l11.m1.1.1.3.2.2.3.1.2.2" xref="alg1.l11.m1.1.1.3.2.2.3.1.2.2.cmml">∑</mo><mrow id="alg1.l11.m1.1.1.3.2.2.3.1.2.3" xref="alg1.l11.m1.1.1.3.2.2.3.1.2.3.cmml"><mi id="alg1.l11.m1.1.1.3.2.2.3.1.2.3.2" xref="alg1.l11.m1.1.1.3.2.2.3.1.2.3.2.cmml">k</mi><mo id="alg1.l11.m1.1.1.3.2.2.3.1.2.3.1" xref="alg1.l11.m1.1.1.3.2.2.3.1.2.3.1.cmml">=</mo><mn id="alg1.l11.m1.1.1.3.2.2.3.1.2.3.3" xref="alg1.l11.m1.1.1.3.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l11.m1.1.1.3.2.2.3.1.3" xref="alg1.l11.m1.1.1.3.2.2.3.1.3.cmml">K</mi></msubsup></mstyle><msub id="alg1.l11.m1.1.1.3.2.2.3.2" xref="alg1.l11.m1.1.1.3.2.2.3.2.cmml"><mi id="alg1.l11.m1.1.1.3.2.2.3.2.2" xref="alg1.l11.m1.1.1.3.2.2.3.2.2.cmml">n</mi><mi id="alg1.l11.m1.1.1.3.2.2.3.2.3" xref="alg1.l11.m1.1.1.3.2.2.3.2.3.cmml">k</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.3.2.1" xref="alg1.l11.m1.1.1.3.2.1.cmml">​</mo><mi id="alg1.l11.m1.1.1.3.2.3" xref="alg1.l11.m1.1.1.3.2.3.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.3.2.1a" xref="alg1.l11.m1.1.1.3.2.1.cmml">​</mo><msubsup id="alg1.l11.m1.1.1.3.2.4" xref="alg1.l11.m1.1.1.3.2.4.cmml"><mi id="alg1.l11.m1.1.1.3.2.4.2.2" xref="alg1.l11.m1.1.1.3.2.4.2.2.cmml">b</mi><mi id="alg1.l11.m1.1.1.3.2.4.2.3" xref="alg1.l11.m1.1.1.3.2.4.2.3.cmml">t</mi><mi id="alg1.l11.m1.1.1.3.2.4.3" xref="alg1.l11.m1.1.1.3.2.4.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">←</ci><apply id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2"><times id="alg1.l11.m1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.2.1"></times><ci id="alg1.l11.m1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.2.2">𝑤</ci><apply id="alg1.l11.m1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.3.1.cmml" xref="alg1.l11.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.3.2.cmml" xref="alg1.l11.m1.1.1.2.3.2">𝑏</ci><apply id="alg1.l11.m1.1.1.2.3.3.cmml" xref="alg1.l11.m1.1.1.2.3.3"><plus id="alg1.l11.m1.1.1.2.3.3.1.cmml" xref="alg1.l11.m1.1.1.2.3.3.1"></plus><ci id="alg1.l11.m1.1.1.2.3.3.2.cmml" xref="alg1.l11.m1.1.1.2.3.3.2">𝑡</ci><cn type="integer" id="alg1.l11.m1.1.1.2.3.3.3.cmml" xref="alg1.l11.m1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><apply id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.1.1.cmml" xref="alg1.l11.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l11.m1.1.1.3.1.2.cmml" xref="alg1.l11.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.1.2.1.cmml" xref="alg1.l11.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l11.m1.1.1.3.1.2.2.cmml" xref="alg1.l11.m1.1.1.3.1.2.2"></sum><apply id="alg1.l11.m1.1.1.3.1.2.3.cmml" xref="alg1.l11.m1.1.1.3.1.2.3"><eq id="alg1.l11.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l11.m1.1.1.3.1.2.3.1"></eq><ci id="alg1.l11.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l11.m1.1.1.3.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l11.m1.1.1.3.1.2.3.3.cmml" xref="alg1.l11.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l11.m1.1.1.3.1.3.cmml" xref="alg1.l11.m1.1.1.3.1.3">𝐾</ci></apply><apply id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2"><times id="alg1.l11.m1.1.1.3.2.1.cmml" xref="alg1.l11.m1.1.1.3.2.1"></times><apply id="alg1.l11.m1.1.1.3.2.2.cmml" xref="alg1.l11.m1.1.1.3.2.2"><divide id="alg1.l11.m1.1.1.3.2.2.1.cmml" xref="alg1.l11.m1.1.1.3.2.2"></divide><apply id="alg1.l11.m1.1.1.3.2.2.2.cmml" xref="alg1.l11.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.2.2.2.1.cmml" xref="alg1.l11.m1.1.1.3.2.2.2">subscript</csymbol><ci id="alg1.l11.m1.1.1.3.2.2.2.2.cmml" xref="alg1.l11.m1.1.1.3.2.2.2.2">𝑛</ci><ci id="alg1.l11.m1.1.1.3.2.2.2.3.cmml" xref="alg1.l11.m1.1.1.3.2.2.2.3">𝑘</ci></apply><apply id="alg1.l11.m1.1.1.3.2.2.3.cmml" xref="alg1.l11.m1.1.1.3.2.2.3"><apply id="alg1.l11.m1.1.1.3.2.2.3.1.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.2.2.3.1.1.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.1">superscript</csymbol><apply id="alg1.l11.m1.1.1.3.2.2.3.1.2.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.2.2.3.1.2.1.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.1">subscript</csymbol><sum id="alg1.l11.m1.1.1.3.2.2.3.1.2.2.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.1.2.2"></sum><apply id="alg1.l11.m1.1.1.3.2.2.3.1.2.3.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.1.2.3"><eq id="alg1.l11.m1.1.1.3.2.2.3.1.2.3.1.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.1.2.3.1"></eq><ci id="alg1.l11.m1.1.1.3.2.2.3.1.2.3.2.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.l11.m1.1.1.3.2.2.3.1.2.3.3.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l11.m1.1.1.3.2.2.3.1.3.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.1.3">𝐾</ci></apply><apply id="alg1.l11.m1.1.1.3.2.2.3.2.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.2.2.3.2.1.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.2">subscript</csymbol><ci id="alg1.l11.m1.1.1.3.2.2.3.2.2.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.2.2">𝑛</ci><ci id="alg1.l11.m1.1.1.3.2.2.3.2.3.cmml" xref="alg1.l11.m1.1.1.3.2.2.3.2.3">𝑘</ci></apply></apply></apply><ci id="alg1.l11.m1.1.1.3.2.3.cmml" xref="alg1.l11.m1.1.1.3.2.3">𝑤</ci><apply id="alg1.l11.m1.1.1.3.2.4.cmml" xref="alg1.l11.m1.1.1.3.2.4"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.2.4.1.cmml" xref="alg1.l11.m1.1.1.3.2.4">superscript</csymbol><apply id="alg1.l11.m1.1.1.3.2.4.2.cmml" xref="alg1.l11.m1.1.1.3.2.4"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.2.4.2.1.cmml" xref="alg1.l11.m1.1.1.3.2.4">subscript</csymbol><ci id="alg1.l11.m1.1.1.3.2.4.2.2.cmml" xref="alg1.l11.m1.1.1.3.2.4.2.2">𝑏</ci><ci id="alg1.l11.m1.1.1.3.2.4.2.3.cmml" xref="alg1.l11.m1.1.1.3.2.4.2.3">𝑡</ci></apply><ci id="alg1.l11.m1.1.1.3.2.4.3.cmml" xref="alg1.l11.m1.1.1.3.2.4.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">wb_{t+1}\leftarrow\sum_{t=1}^{K}\frac{n_{k}}{\sum_{k=1}^{K}n_{k}}wb_{t}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">  <span id="alg1.l12.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l12.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l13" class="ltx_listingline">     

</div>
<div id="alg1.l14" class="ltx_listingline">  <span id="alg1.l14.1" class="ltx_text ltx_font_bold">ClientUpdate</span>(k, <math id="alg1.l14.m1.1" class="ltx_Math" alttext="wb_{t}" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">​</mo><msub id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml">b</mi><mi id="alg1.l14.m1.1.1.3.3" xref="alg1.l14.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><times id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"></times><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑤</ci><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2">𝑏</ci><ci id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">wb_{t}</annotation></semantics></math>)

</div>
<div id="alg1.l15" class="ltx_listingline">  <math id="alg1.l15.m1.1" class="ltx_Math" alttext="wb_{t}^{k}\leftarrow wb_{t}" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mrow id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml"><mi id="alg1.l15.m1.1.1.2.2" xref="alg1.l15.m1.1.1.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.2.1" xref="alg1.l15.m1.1.1.2.1.cmml">​</mo><msubsup id="alg1.l15.m1.1.1.2.3" xref="alg1.l15.m1.1.1.2.3.cmml"><mi id="alg1.l15.m1.1.1.2.3.2.2" xref="alg1.l15.m1.1.1.2.3.2.2.cmml">b</mi><mi id="alg1.l15.m1.1.1.2.3.2.3" xref="alg1.l15.m1.1.1.2.3.2.3.cmml">t</mi><mi id="alg1.l15.m1.1.1.2.3.3" xref="alg1.l15.m1.1.1.2.3.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">←</mo><mrow id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.3.1" xref="alg1.l15.m1.1.1.3.1.cmml">​</mo><msub id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml"><mi id="alg1.l15.m1.1.1.3.3.2" xref="alg1.l15.m1.1.1.3.3.2.cmml">b</mi><mi id="alg1.l15.m1.1.1.3.3.3" xref="alg1.l15.m1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1">←</ci><apply id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2"><times id="alg1.l15.m1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.2.1"></times><ci id="alg1.l15.m1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.2.2">𝑤</ci><apply id="alg1.l15.m1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.3.1.cmml" xref="alg1.l15.m1.1.1.2.3">superscript</csymbol><apply id="alg1.l15.m1.1.1.2.3.2.cmml" xref="alg1.l15.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.3.2.1.cmml" xref="alg1.l15.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.2.3.2.2.cmml" xref="alg1.l15.m1.1.1.2.3.2.2">𝑏</ci><ci id="alg1.l15.m1.1.1.2.3.2.3.cmml" xref="alg1.l15.m1.1.1.2.3.2.3">𝑡</ci></apply><ci id="alg1.l15.m1.1.1.2.3.3.cmml" xref="alg1.l15.m1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><times id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3.1"></times><ci id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2">𝑤</ci><apply id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.3.1.cmml" xref="alg1.l15.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.3.2.cmml" xref="alg1.l15.m1.1.1.3.3.2">𝑏</ci><ci id="alg1.l15.m1.1.1.3.3.3.cmml" xref="alg1.l15.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">wb_{t}^{k}\leftarrow wb_{t}</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">  <span id="alg1.l16.1" class="ltx_text ltx_font_bold">for</span> each local epoch e=1,2,…,E <span id="alg1.l16.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l17" class="ltx_listingline">     Update <math id="alg1.l17.m1.2" class="ltx_Math" alttext="wb_{t}^{k},wl_{t}^{k}" display="inline"><semantics id="alg1.l17.m1.2a"><mrow id="alg1.l17.m1.2.2.2" xref="alg1.l17.m1.2.2.3.cmml"><mrow id="alg1.l17.m1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.cmml"><mi id="alg1.l17.m1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.cmml">​</mo><msubsup id="alg1.l17.m1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.1.1.3.2.2" xref="alg1.l17.m1.1.1.1.1.3.2.2.cmml">b</mi><mi id="alg1.l17.m1.1.1.1.1.3.2.3" xref="alg1.l17.m1.1.1.1.1.3.2.3.cmml">t</mi><mi id="alg1.l17.m1.1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow><mo id="alg1.l17.m1.2.2.2.3" xref="alg1.l17.m1.2.2.3.cmml">,</mo><mrow id="alg1.l17.m1.2.2.2.2" xref="alg1.l17.m1.2.2.2.2.cmml"><mi id="alg1.l17.m1.2.2.2.2.2" xref="alg1.l17.m1.2.2.2.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.2.2.2.2.1" xref="alg1.l17.m1.2.2.2.2.1.cmml">​</mo><msubsup id="alg1.l17.m1.2.2.2.2.3" xref="alg1.l17.m1.2.2.2.2.3.cmml"><mi id="alg1.l17.m1.2.2.2.2.3.2.2" xref="alg1.l17.m1.2.2.2.2.3.2.2.cmml">l</mi><mi id="alg1.l17.m1.2.2.2.2.3.2.3" xref="alg1.l17.m1.2.2.2.2.3.2.3.cmml">t</mi><mi id="alg1.l17.m1.2.2.2.2.3.3" xref="alg1.l17.m1.2.2.2.2.3.3.cmml">k</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.2b"><list id="alg1.l17.m1.2.2.3.cmml" xref="alg1.l17.m1.2.2.2"><apply id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1"><times id="alg1.l17.m1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1"></times><ci id="alg1.l17.m1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.2">𝑤</ci><apply id="alg1.l17.m1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.3">superscript</csymbol><apply id="alg1.l17.m1.1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.3.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.3.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.3.2.2">𝑏</ci><ci id="alg1.l17.m1.1.1.1.1.3.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l17.m1.1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="alg1.l17.m1.2.2.2.2.cmml" xref="alg1.l17.m1.2.2.2.2"><times id="alg1.l17.m1.2.2.2.2.1.cmml" xref="alg1.l17.m1.2.2.2.2.1"></times><ci id="alg1.l17.m1.2.2.2.2.2.cmml" xref="alg1.l17.m1.2.2.2.2.2">𝑤</ci><apply id="alg1.l17.m1.2.2.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.2.3.1.cmml" xref="alg1.l17.m1.2.2.2.2.3">superscript</csymbol><apply id="alg1.l17.m1.2.2.2.2.3.2.cmml" xref="alg1.l17.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.2.3.2.1.cmml" xref="alg1.l17.m1.2.2.2.2.3">subscript</csymbol><ci id="alg1.l17.m1.2.2.2.2.3.2.2.cmml" xref="alg1.l17.m1.2.2.2.2.3.2.2">𝑙</ci><ci id="alg1.l17.m1.2.2.2.2.3.2.3.cmml" xref="alg1.l17.m1.2.2.2.2.3.2.3">𝑡</ci></apply><ci id="alg1.l17.m1.2.2.2.2.3.3.cmml" xref="alg1.l17.m1.2.2.2.2.3.3">𝑘</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.2c">wb_{t}^{k},wl_{t}^{k}</annotation></semantics></math> on local data

</div>
<div id="alg1.l18" class="ltx_listingline">  <span id="alg1.l18.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l18.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l19" class="ltx_listingline">  return <math id="alg1.l19.m1.1" class="ltx_Math" alttext="wb^{k}_{t}" display="inline"><semantics id="alg1.l19.m1.1a"><mrow id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><mi id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.1.1.1" xref="alg1.l19.m1.1.1.1.cmml">​</mo><msubsup id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml"><mi id="alg1.l19.m1.1.1.3.2.2" xref="alg1.l19.m1.1.1.3.2.2.cmml">b</mi><mi id="alg1.l19.m1.1.1.3.3" xref="alg1.l19.m1.1.1.3.3.cmml">t</mi><mi id="alg1.l19.m1.1.1.3.2.3" xref="alg1.l19.m1.1.1.3.2.3.cmml">k</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><times id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1"></times><ci id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2">𝑤</ci><apply id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.3.1.cmml" xref="alg1.l19.m1.1.1.3">subscript</csymbol><apply id="alg1.l19.m1.1.1.3.2.cmml" xref="alg1.l19.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.3.2.1.cmml" xref="alg1.l19.m1.1.1.3">superscript</csymbol><ci id="alg1.l19.m1.1.1.3.2.2.cmml" xref="alg1.l19.m1.1.1.3.2.2">𝑏</ci><ci id="alg1.l19.m1.1.1.3.2.3.cmml" xref="alg1.l19.m1.1.1.3.2.3">𝑘</ci></apply><ci id="alg1.l19.m1.1.1.3.3.cmml" xref="alg1.l19.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">wb^{k}_{t}</annotation></semantics></math> to server

</div>
<div id="alg1.l20" class="ltx_listingline">     

</div>
<div id="alg1.l21" class="ltx_listingline">  <span id="alg1.l21.1" class="ltx_text ltx_font_bold">ClientInit</span>(k, <math id="alg1.l21.m1.1" class="ltx_Math" alttext="wb_{0}" display="inline"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml">​</mo><msub id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml"><mi id="alg1.l21.m1.1.1.3.2" xref="alg1.l21.m1.1.1.3.2.cmml">b</mi><mn id="alg1.l21.m1.1.1.3.3" xref="alg1.l21.m1.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><times id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1"></times><ci id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">𝑤</ci><apply id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.3.1.cmml" xref="alg1.l21.m1.1.1.3">subscript</csymbol><ci id="alg1.l21.m1.1.1.3.2.cmml" xref="alg1.l21.m1.1.1.3.2">𝑏</ci><cn type="integer" id="alg1.l21.m1.1.1.3.3.cmml" xref="alg1.l21.m1.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">wb_{0}</annotation></semantics></math>, <math id="alg1.l21.m2.1" class="ltx_Math" alttext="wl_{0}" display="inline"><semantics id="alg1.l21.m2.1a"><mrow id="alg1.l21.m2.1.1" xref="alg1.l21.m2.1.1.cmml"><mi id="alg1.l21.m2.1.1.2" xref="alg1.l21.m2.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m2.1.1.1" xref="alg1.l21.m2.1.1.1.cmml">​</mo><msub id="alg1.l21.m2.1.1.3" xref="alg1.l21.m2.1.1.3.cmml"><mi id="alg1.l21.m2.1.1.3.2" xref="alg1.l21.m2.1.1.3.2.cmml">l</mi><mn id="alg1.l21.m2.1.1.3.3" xref="alg1.l21.m2.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.1b"><apply id="alg1.l21.m2.1.1.cmml" xref="alg1.l21.m2.1.1"><times id="alg1.l21.m2.1.1.1.cmml" xref="alg1.l21.m2.1.1.1"></times><ci id="alg1.l21.m2.1.1.2.cmml" xref="alg1.l21.m2.1.1.2">𝑤</ci><apply id="alg1.l21.m2.1.1.3.cmml" xref="alg1.l21.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l21.m2.1.1.3.1.cmml" xref="alg1.l21.m2.1.1.3">subscript</csymbol><ci id="alg1.l21.m2.1.1.3.2.cmml" xref="alg1.l21.m2.1.1.3.2">𝑙</ci><cn type="integer" id="alg1.l21.m2.1.1.3.3.cmml" xref="alg1.l21.m2.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.1c">wl_{0}</annotation></semantics></math>)

</div>
<div id="alg1.l22" class="ltx_listingline">  <math id="alg1.l22.m1.1" class="ltx_Math" alttext="wb_{0}^{k}\leftarrow wb_{0}" display="inline"><semantics id="alg1.l22.m1.1a"><mrow id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><mrow id="alg1.l22.m1.1.1.2" xref="alg1.l22.m1.1.1.2.cmml"><mi id="alg1.l22.m1.1.1.2.2" xref="alg1.l22.m1.1.1.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.1.1.2.1" xref="alg1.l22.m1.1.1.2.1.cmml">​</mo><msubsup id="alg1.l22.m1.1.1.2.3" xref="alg1.l22.m1.1.1.2.3.cmml"><mi id="alg1.l22.m1.1.1.2.3.2.2" xref="alg1.l22.m1.1.1.2.3.2.2.cmml">b</mi><mn id="alg1.l22.m1.1.1.2.3.2.3" xref="alg1.l22.m1.1.1.2.3.2.3.cmml">0</mn><mi id="alg1.l22.m1.1.1.2.3.3" xref="alg1.l22.m1.1.1.2.3.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="alg1.l22.m1.1.1.1" xref="alg1.l22.m1.1.1.1.cmml">←</mo><mrow id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml"><mi id="alg1.l22.m1.1.1.3.2" xref="alg1.l22.m1.1.1.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.1.1.3.1" xref="alg1.l22.m1.1.1.3.1.cmml">​</mo><msub id="alg1.l22.m1.1.1.3.3" xref="alg1.l22.m1.1.1.3.3.cmml"><mi id="alg1.l22.m1.1.1.3.3.2" xref="alg1.l22.m1.1.1.3.3.2.cmml">b</mi><mn id="alg1.l22.m1.1.1.3.3.3" xref="alg1.l22.m1.1.1.3.3.3.cmml">0</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><ci id="alg1.l22.m1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1">←</ci><apply id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1.2"><times id="alg1.l22.m1.1.1.2.1.cmml" xref="alg1.l22.m1.1.1.2.1"></times><ci id="alg1.l22.m1.1.1.2.2.cmml" xref="alg1.l22.m1.1.1.2.2">𝑤</ci><apply id="alg1.l22.m1.1.1.2.3.cmml" xref="alg1.l22.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.2.3.1.cmml" xref="alg1.l22.m1.1.1.2.3">superscript</csymbol><apply id="alg1.l22.m1.1.1.2.3.2.cmml" xref="alg1.l22.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.2.3.2.1.cmml" xref="alg1.l22.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l22.m1.1.1.2.3.2.2.cmml" xref="alg1.l22.m1.1.1.2.3.2.2">𝑏</ci><cn type="integer" id="alg1.l22.m1.1.1.2.3.2.3.cmml" xref="alg1.l22.m1.1.1.2.3.2.3">0</cn></apply><ci id="alg1.l22.m1.1.1.2.3.3.cmml" xref="alg1.l22.m1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3"><times id="alg1.l22.m1.1.1.3.1.cmml" xref="alg1.l22.m1.1.1.3.1"></times><ci id="alg1.l22.m1.1.1.3.2.cmml" xref="alg1.l22.m1.1.1.3.2">𝑤</ci><apply id="alg1.l22.m1.1.1.3.3.cmml" xref="alg1.l22.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.3.3.1.cmml" xref="alg1.l22.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l22.m1.1.1.3.3.2.cmml" xref="alg1.l22.m1.1.1.3.3.2">𝑏</ci><cn type="integer" id="alg1.l22.m1.1.1.3.3.3.cmml" xref="alg1.l22.m1.1.1.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">wb_{0}^{k}\leftarrow wb_{0}</annotation></semantics></math>

</div>
<div id="alg1.l23" class="ltx_listingline">  <math id="alg1.l23.m1.1" class="ltx_Math" alttext="wl_{0}^{k}\leftarrow wl_{0}" display="inline"><semantics id="alg1.l23.m1.1a"><mrow id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml"><mrow id="alg1.l23.m1.1.1.2" xref="alg1.l23.m1.1.1.2.cmml"><mi id="alg1.l23.m1.1.1.2.2" xref="alg1.l23.m1.1.1.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.1.1.2.1" xref="alg1.l23.m1.1.1.2.1.cmml">​</mo><msubsup id="alg1.l23.m1.1.1.2.3" xref="alg1.l23.m1.1.1.2.3.cmml"><mi id="alg1.l23.m1.1.1.2.3.2.2" xref="alg1.l23.m1.1.1.2.3.2.2.cmml">l</mi><mn id="alg1.l23.m1.1.1.2.3.2.3" xref="alg1.l23.m1.1.1.2.3.2.3.cmml">0</mn><mi id="alg1.l23.m1.1.1.2.3.3" xref="alg1.l23.m1.1.1.2.3.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="alg1.l23.m1.1.1.1" xref="alg1.l23.m1.1.1.1.cmml">←</mo><mrow id="alg1.l23.m1.1.1.3" xref="alg1.l23.m1.1.1.3.cmml"><mi id="alg1.l23.m1.1.1.3.2" xref="alg1.l23.m1.1.1.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.1.1.3.1" xref="alg1.l23.m1.1.1.3.1.cmml">​</mo><msub id="alg1.l23.m1.1.1.3.3" xref="alg1.l23.m1.1.1.3.3.cmml"><mi id="alg1.l23.m1.1.1.3.3.2" xref="alg1.l23.m1.1.1.3.3.2.cmml">l</mi><mn id="alg1.l23.m1.1.1.3.3.3" xref="alg1.l23.m1.1.1.3.3.3.cmml">0</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><apply id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1"><ci id="alg1.l23.m1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1">←</ci><apply id="alg1.l23.m1.1.1.2.cmml" xref="alg1.l23.m1.1.1.2"><times id="alg1.l23.m1.1.1.2.1.cmml" xref="alg1.l23.m1.1.1.2.1"></times><ci id="alg1.l23.m1.1.1.2.2.cmml" xref="alg1.l23.m1.1.1.2.2">𝑤</ci><apply id="alg1.l23.m1.1.1.2.3.cmml" xref="alg1.l23.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.2.3.1.cmml" xref="alg1.l23.m1.1.1.2.3">superscript</csymbol><apply id="alg1.l23.m1.1.1.2.3.2.cmml" xref="alg1.l23.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.2.3.2.1.cmml" xref="alg1.l23.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l23.m1.1.1.2.3.2.2.cmml" xref="alg1.l23.m1.1.1.2.3.2.2">𝑙</ci><cn type="integer" id="alg1.l23.m1.1.1.2.3.2.3.cmml" xref="alg1.l23.m1.1.1.2.3.2.3">0</cn></apply><ci id="alg1.l23.m1.1.1.2.3.3.cmml" xref="alg1.l23.m1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="alg1.l23.m1.1.1.3.cmml" xref="alg1.l23.m1.1.1.3"><times id="alg1.l23.m1.1.1.3.1.cmml" xref="alg1.l23.m1.1.1.3.1"></times><ci id="alg1.l23.m1.1.1.3.2.cmml" xref="alg1.l23.m1.1.1.3.2">𝑤</ci><apply id="alg1.l23.m1.1.1.3.3.cmml" xref="alg1.l23.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.3.3.1.cmml" xref="alg1.l23.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l23.m1.1.1.3.3.2.cmml" xref="alg1.l23.m1.1.1.3.3.2">𝑙</ci><cn type="integer" id="alg1.l23.m1.1.1.3.3.3.cmml" xref="alg1.l23.m1.1.1.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">wl_{0}^{k}\leftarrow wl_{0}</annotation></semantics></math>


</div>
</div>
<br class="ltx_break ltx_break">
</figure>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Following this split of generic and specific layers, we propose to share the generic feature extraction, like the convolutional layers, between the servers and the clients and more precisely to keep the specific layer as the classification layer only on the clients side.
This scheme allows the feature extraction part to benefit from all the data and therefore to increase its robustness. Each client can also adapt more to the local data distribution with the specific layer.
Additionally, keeping layers specific to the clients decrease the amount of bytes exchange between the clients and the server, in comparison of sharing the whole model.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.11" class="ltx_p">Our proposed Heteregoneous Data Adaptive Federated Learning (HDAFL) algorithm is illustrated as Algorithm 1. In terms of notation, we denote with <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="wb" display="inline"><semantics id="S4.p3.1.m1.1a"><mrow id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mi id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.p3.1.m1.1.1.1" xref="S4.p3.1.m1.1.1.1.cmml">​</mo><mi id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><times id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1.1"></times><ci id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2">𝑤</ci><ci id="S4.p3.1.m1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">wb</annotation></semantics></math> the generic parameters and with <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="wl" display="inline"><semantics id="S4.p3.2.m2.1a"><mrow id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><mi id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.p3.2.m2.1.1.1" xref="S4.p3.2.m2.1.1.1.cmml">​</mo><mi id="S4.p3.2.m2.1.1.3" xref="S4.p3.2.m2.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><times id="S4.p3.2.m2.1.1.1.cmml" xref="S4.p3.2.m2.1.1.1"></times><ci id="S4.p3.2.m2.1.1.2.cmml" xref="S4.p3.2.m2.1.1.2">𝑤</ci><ci id="S4.p3.2.m2.1.1.3.cmml" xref="S4.p3.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">wl</annotation></semantics></math> the specific local layer parameters: <math id="S4.p3.3.m3.1" class="ltx_Math" alttext="wb_{t}^{k}" display="inline"><semantics id="S4.p3.3.m3.1a"><mrow id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml"><mi id="S4.p3.3.m3.1.1.2" xref="S4.p3.3.m3.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.p3.3.m3.1.1.1" xref="S4.p3.3.m3.1.1.1.cmml">​</mo><msubsup id="S4.p3.3.m3.1.1.3" xref="S4.p3.3.m3.1.1.3.cmml"><mi id="S4.p3.3.m3.1.1.3.2.2" xref="S4.p3.3.m3.1.1.3.2.2.cmml">b</mi><mi id="S4.p3.3.m3.1.1.3.2.3" xref="S4.p3.3.m3.1.1.3.2.3.cmml">t</mi><mi id="S4.p3.3.m3.1.1.3.3" xref="S4.p3.3.m3.1.1.3.3.cmml">k</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><apply id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1"><times id="S4.p3.3.m3.1.1.1.cmml" xref="S4.p3.3.m3.1.1.1"></times><ci id="S4.p3.3.m3.1.1.2.cmml" xref="S4.p3.3.m3.1.1.2">𝑤</ci><apply id="S4.p3.3.m3.1.1.3.cmml" xref="S4.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.1.3.1.cmml" xref="S4.p3.3.m3.1.1.3">superscript</csymbol><apply id="S4.p3.3.m3.1.1.3.2.cmml" xref="S4.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.1.3.2.1.cmml" xref="S4.p3.3.m3.1.1.3">subscript</csymbol><ci id="S4.p3.3.m3.1.1.3.2.2.cmml" xref="S4.p3.3.m3.1.1.3.2.2">𝑏</ci><ci id="S4.p3.3.m3.1.1.3.2.3.cmml" xref="S4.p3.3.m3.1.1.3.2.3">𝑡</ci></apply><ci id="S4.p3.3.m3.1.1.3.3.cmml" xref="S4.p3.3.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">wb_{t}^{k}</annotation></semantics></math> indicates the model for client <math id="S4.p3.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.p3.4.m4.1a"><mi id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><ci id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">k</annotation></semantics></math> out of the total number of clients <math id="S4.p3.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.p3.5.m5.1a"><mi id="S4.p3.5.m5.1.1" xref="S4.p3.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.p3.5.m5.1b"><ci id="S4.p3.5.m5.1.1.cmml" xref="S4.p3.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.5.m5.1c">K</annotation></semantics></math> at <math id="S4.p3.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.p3.6.m6.1a"><mi id="S4.p3.6.m6.1.1" xref="S4.p3.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.p3.6.m6.1b"><ci id="S4.p3.6.m6.1.1.cmml" xref="S4.p3.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.6.m6.1c">t</annotation></semantics></math>-th round of communications, and <math id="S4.p3.7.m7.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S4.p3.7.m7.1a"><msub id="S4.p3.7.m7.1.1" xref="S4.p3.7.m7.1.1.cmml"><mi id="S4.p3.7.m7.1.1.2" xref="S4.p3.7.m7.1.1.2.cmml">n</mi><mi id="S4.p3.7.m7.1.1.3" xref="S4.p3.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.7.m7.1b"><apply id="S4.p3.7.m7.1.1.cmml" xref="S4.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p3.7.m7.1.1.1.cmml" xref="S4.p3.7.m7.1.1">subscript</csymbol><ci id="S4.p3.7.m7.1.1.2.cmml" xref="S4.p3.7.m7.1.1.2">𝑛</ci><ci id="S4.p3.7.m7.1.1.3.cmml" xref="S4.p3.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.7.m7.1c">n_{k}</annotation></semantics></math> denotes the total number of samples on client <math id="S4.p3.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.p3.8.m8.1a"><mi id="S4.p3.8.m8.1.1" xref="S4.p3.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p3.8.m8.1b"><ci id="S4.p3.8.m8.1.1.cmml" xref="S4.p3.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.8.m8.1c">k</annotation></semantics></math>. The two free parameters <math id="S4.p3.9.m9.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.p3.9.m9.1a"><mi id="S4.p3.9.m9.1.1" xref="S4.p3.9.m9.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.p3.9.m9.1b"><ci id="S4.p3.9.m9.1.1.cmml" xref="S4.p3.9.m9.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.9.m9.1c">C</annotation></semantics></math> and <math id="S4.p3.10.m10.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.p3.10.m10.1a"><mi id="S4.p3.10.m10.1.1" xref="S4.p3.10.m10.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.p3.10.m10.1b"><ci id="S4.p3.10.m10.1.1.cmml" xref="S4.p3.10.m10.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.10.m10.1c">T</annotation></semantics></math> indicate the number of clients sampled at each round, and the maximum number of rounds respectively. Within each round, the local learning process at each client is governed by the number of epochs <math id="S4.p3.11.m11.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.p3.11.m11.1a"><mi id="S4.p3.11.m11.1.1" xref="S4.p3.11.m11.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.p3.11.m11.1b"><ci id="S4.p3.11.m11.1.1.cmml" xref="S4.p3.11.m11.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.11.m11.1c">E</annotation></semantics></math>.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.8" class="ltx_p">The whole process starts with an initialization step: the server initializes the full parameters <math id="S4.p4.1.m1.2" class="ltx_Math" alttext="wb_{0},wl_{0}" display="inline"><semantics id="S4.p4.1.m1.2a"><mrow id="S4.p4.1.m1.2.2.2" xref="S4.p4.1.m1.2.2.3.cmml"><mrow id="S4.p4.1.m1.1.1.1.1" xref="S4.p4.1.m1.1.1.1.1.cmml"><mi id="S4.p4.1.m1.1.1.1.1.2" xref="S4.p4.1.m1.1.1.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.p4.1.m1.1.1.1.1.1" xref="S4.p4.1.m1.1.1.1.1.1.cmml">​</mo><msub id="S4.p4.1.m1.1.1.1.1.3" xref="S4.p4.1.m1.1.1.1.1.3.cmml"><mi id="S4.p4.1.m1.1.1.1.1.3.2" xref="S4.p4.1.m1.1.1.1.1.3.2.cmml">b</mi><mn id="S4.p4.1.m1.1.1.1.1.3.3" xref="S4.p4.1.m1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S4.p4.1.m1.2.2.2.3" xref="S4.p4.1.m1.2.2.3.cmml">,</mo><mrow id="S4.p4.1.m1.2.2.2.2" xref="S4.p4.1.m1.2.2.2.2.cmml"><mi id="S4.p4.1.m1.2.2.2.2.2" xref="S4.p4.1.m1.2.2.2.2.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.p4.1.m1.2.2.2.2.1" xref="S4.p4.1.m1.2.2.2.2.1.cmml">​</mo><msub id="S4.p4.1.m1.2.2.2.2.3" xref="S4.p4.1.m1.2.2.2.2.3.cmml"><mi id="S4.p4.1.m1.2.2.2.2.3.2" xref="S4.p4.1.m1.2.2.2.2.3.2.cmml">l</mi><mn id="S4.p4.1.m1.2.2.2.2.3.3" xref="S4.p4.1.m1.2.2.2.2.3.3.cmml">0</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.2b"><list id="S4.p4.1.m1.2.2.3.cmml" xref="S4.p4.1.m1.2.2.2"><apply id="S4.p4.1.m1.1.1.1.1.cmml" xref="S4.p4.1.m1.1.1.1.1"><times id="S4.p4.1.m1.1.1.1.1.1.cmml" xref="S4.p4.1.m1.1.1.1.1.1"></times><ci id="S4.p4.1.m1.1.1.1.1.2.cmml" xref="S4.p4.1.m1.1.1.1.1.2">𝑤</ci><apply id="S4.p4.1.m1.1.1.1.1.3.cmml" xref="S4.p4.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p4.1.m1.1.1.1.1.3.1.cmml" xref="S4.p4.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.p4.1.m1.1.1.1.1.3.2.cmml" xref="S4.p4.1.m1.1.1.1.1.3.2">𝑏</ci><cn type="integer" id="S4.p4.1.m1.1.1.1.1.3.3.cmml" xref="S4.p4.1.m1.1.1.1.1.3.3">0</cn></apply></apply><apply id="S4.p4.1.m1.2.2.2.2.cmml" xref="S4.p4.1.m1.2.2.2.2"><times id="S4.p4.1.m1.2.2.2.2.1.cmml" xref="S4.p4.1.m1.2.2.2.2.1"></times><ci id="S4.p4.1.m1.2.2.2.2.2.cmml" xref="S4.p4.1.m1.2.2.2.2.2">𝑤</ci><apply id="S4.p4.1.m1.2.2.2.2.3.cmml" xref="S4.p4.1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.p4.1.m1.2.2.2.2.3.1.cmml" xref="S4.p4.1.m1.2.2.2.2.3">subscript</csymbol><ci id="S4.p4.1.m1.2.2.2.2.3.2.cmml" xref="S4.p4.1.m1.2.2.2.2.3.2">𝑙</ci><cn type="integer" id="S4.p4.1.m1.2.2.2.2.3.3.cmml" xref="S4.p4.1.m1.2.2.2.2.3.3">0</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.2c">wb_{0},wl_{0}</annotation></semantics></math> by using common initialization methods (such as random initialization, that draws value from normal Gaussian distribution). The server then broadcasts the initialized parameters to all the clients.
At each round <math id="S4.p4.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.p4.2.m2.1a"><mi id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><ci id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">t</annotation></semantics></math> of communications, the clients update the local parameters by copying the generic parameters <math id="S4.p4.3.m3.1" class="ltx_Math" alttext="wb_{t}" display="inline"><semantics id="S4.p4.3.m3.1a"><mrow id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml"><mi id="S4.p4.3.m3.1.1.2" xref="S4.p4.3.m3.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.p4.3.m3.1.1.1" xref="S4.p4.3.m3.1.1.1.cmml">​</mo><msub id="S4.p4.3.m3.1.1.3" xref="S4.p4.3.m3.1.1.3.cmml"><mi id="S4.p4.3.m3.1.1.3.2" xref="S4.p4.3.m3.1.1.3.2.cmml">b</mi><mi id="S4.p4.3.m3.1.1.3.3" xref="S4.p4.3.m3.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><apply id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1"><times id="S4.p4.3.m3.1.1.1.cmml" xref="S4.p4.3.m3.1.1.1"></times><ci id="S4.p4.3.m3.1.1.2.cmml" xref="S4.p4.3.m3.1.1.2">𝑤</ci><apply id="S4.p4.3.m3.1.1.3.cmml" xref="S4.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.p4.3.m3.1.1.3.1.cmml" xref="S4.p4.3.m3.1.1.3">subscript</csymbol><ci id="S4.p4.3.m3.1.1.3.2.cmml" xref="S4.p4.3.m3.1.1.3.2">𝑏</ci><ci id="S4.p4.3.m3.1.1.3.3.cmml" xref="S4.p4.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">wb_{t}</annotation></semantics></math>. For the first round of communication, the specific parameters are copied as well. The clients update the received model on their local data with fixed epochs <math id="S4.p4.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.p4.4.m4.1a"><mi id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><ci id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">E</annotation></semantics></math> and send back the updated generic parameters <math id="S4.p4.5.m5.1" class="ltx_Math" alttext="wb^{k}_{t}" display="inline"><semantics id="S4.p4.5.m5.1a"><mrow id="S4.p4.5.m5.1.1" xref="S4.p4.5.m5.1.1.cmml"><mi id="S4.p4.5.m5.1.1.2" xref="S4.p4.5.m5.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.p4.5.m5.1.1.1" xref="S4.p4.5.m5.1.1.1.cmml">​</mo><msubsup id="S4.p4.5.m5.1.1.3" xref="S4.p4.5.m5.1.1.3.cmml"><mi id="S4.p4.5.m5.1.1.3.2.2" xref="S4.p4.5.m5.1.1.3.2.2.cmml">b</mi><mi id="S4.p4.5.m5.1.1.3.3" xref="S4.p4.5.m5.1.1.3.3.cmml">t</mi><mi id="S4.p4.5.m5.1.1.3.2.3" xref="S4.p4.5.m5.1.1.3.2.3.cmml">k</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.5.m5.1b"><apply id="S4.p4.5.m5.1.1.cmml" xref="S4.p4.5.m5.1.1"><times id="S4.p4.5.m5.1.1.1.cmml" xref="S4.p4.5.m5.1.1.1"></times><ci id="S4.p4.5.m5.1.1.2.cmml" xref="S4.p4.5.m5.1.1.2">𝑤</ci><apply id="S4.p4.5.m5.1.1.3.cmml" xref="S4.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.p4.5.m5.1.1.3.1.cmml" xref="S4.p4.5.m5.1.1.3">subscript</csymbol><apply id="S4.p4.5.m5.1.1.3.2.cmml" xref="S4.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.p4.5.m5.1.1.3.2.1.cmml" xref="S4.p4.5.m5.1.1.3">superscript</csymbol><ci id="S4.p4.5.m5.1.1.3.2.2.cmml" xref="S4.p4.5.m5.1.1.3.2.2">𝑏</ci><ci id="S4.p4.5.m5.1.1.3.2.3.cmml" xref="S4.p4.5.m5.1.1.3.2.3">𝑘</ci></apply><ci id="S4.p4.5.m5.1.1.3.3.cmml" xref="S4.p4.5.m5.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m5.1c">wb^{k}_{t}</annotation></semantics></math> to server.
Upon receiving the updates from the selected clients,
the server aggregates the generic parameters <math id="S4.p4.6.m6.1" class="ltx_Math" alttext="wb^{k}_{t}" display="inline"><semantics id="S4.p4.6.m6.1a"><mrow id="S4.p4.6.m6.1.1" xref="S4.p4.6.m6.1.1.cmml"><mi id="S4.p4.6.m6.1.1.2" xref="S4.p4.6.m6.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.p4.6.m6.1.1.1" xref="S4.p4.6.m6.1.1.1.cmml">​</mo><msubsup id="S4.p4.6.m6.1.1.3" xref="S4.p4.6.m6.1.1.3.cmml"><mi id="S4.p4.6.m6.1.1.3.2.2" xref="S4.p4.6.m6.1.1.3.2.2.cmml">b</mi><mi id="S4.p4.6.m6.1.1.3.3" xref="S4.p4.6.m6.1.1.3.3.cmml">t</mi><mi id="S4.p4.6.m6.1.1.3.2.3" xref="S4.p4.6.m6.1.1.3.2.3.cmml">k</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.6.m6.1b"><apply id="S4.p4.6.m6.1.1.cmml" xref="S4.p4.6.m6.1.1"><times id="S4.p4.6.m6.1.1.1.cmml" xref="S4.p4.6.m6.1.1.1"></times><ci id="S4.p4.6.m6.1.1.2.cmml" xref="S4.p4.6.m6.1.1.2">𝑤</ci><apply id="S4.p4.6.m6.1.1.3.cmml" xref="S4.p4.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.p4.6.m6.1.1.3.1.cmml" xref="S4.p4.6.m6.1.1.3">subscript</csymbol><apply id="S4.p4.6.m6.1.1.3.2.cmml" xref="S4.p4.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.p4.6.m6.1.1.3.2.1.cmml" xref="S4.p4.6.m6.1.1.3">superscript</csymbol><ci id="S4.p4.6.m6.1.1.3.2.2.cmml" xref="S4.p4.6.m6.1.1.3.2.2">𝑏</ci><ci id="S4.p4.6.m6.1.1.3.2.3.cmml" xref="S4.p4.6.m6.1.1.3.2.3">𝑘</ci></apply><ci id="S4.p4.6.m6.1.1.3.3.cmml" xref="S4.p4.6.m6.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.m6.1c">wb^{k}_{t}</annotation></semantics></math> by using averaging weighted by the number of total samples <math id="S4.p4.7.m7.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S4.p4.7.m7.1a"><msub id="S4.p4.7.m7.1.1" xref="S4.p4.7.m7.1.1.cmml"><mi id="S4.p4.7.m7.1.1.2" xref="S4.p4.7.m7.1.1.2.cmml">n</mi><mi id="S4.p4.7.m7.1.1.3" xref="S4.p4.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.7.m7.1b"><apply id="S4.p4.7.m7.1.1.cmml" xref="S4.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p4.7.m7.1.1.1.cmml" xref="S4.p4.7.m7.1.1">subscript</csymbol><ci id="S4.p4.7.m7.1.1.2.cmml" xref="S4.p4.7.m7.1.1.2">𝑛</ci><ci id="S4.p4.7.m7.1.1.3.cmml" xref="S4.p4.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.7.m7.1c">n_{k}</annotation></semantics></math> at each clients. Another other option is weighted by the norm of gradient, that we do not consider in what follows for lack of space.
The server then broadcasts the aggregated generic
parameters to clients. Stop conditions can include attaining
a minimum accuracy target, or a maximum number
of rounds <math id="S4.p4.8.m8.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.p4.8.m8.1a"><mi id="S4.p4.8.m8.1.1" xref="S4.p4.8.m8.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.p4.8.m8.1b"><ci id="S4.p4.8.m8.1.1.cmml" xref="S4.p4.8.m8.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.8.m8.1c">T</annotation></semantics></math> (that we limitedly consider in what follows
without loss of generality).</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experimental results</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We start by showing results on an image recognition use-case with the FEMNIST dataset,
to contrast general properties of our federated learning approach on a repeatable dataset,
and next briefly assess its performance on the TCP/IP networks traffic classification use-case.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Image recognition</h3>

<section id="S5.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Experimental settings</h4>

<div id="S5.SS1.SSS1.p1" class="ltx_para">
<p id="S5.SS1.SSS1.p1.1" class="ltx_p">We design three experiments with the FEMNIST dataset according to the distribution of the data on each client.
We consider the data related to 2000 writers which is a subpart of the whole FEMNIST dataset.
We implement three kinds of data sampling methods to distribute the data into clients: i.i.d., non i.i.d. and disjoint. The two latter cases reflect real life scenarios, where each client has its own local data, whose distribution is not identical between clients.</p>
</div>
<div id="S5.SS1.SSS1.p2" class="ltx_para">
<p id="S5.SS1.SSS1.p2.1" class="ltx_p">The <em id="S5.SS1.SSS1.p2.1.1" class="ltx_emph ltx_font_italic">i.i.d sampling policy</em> imposes same data distribution on each clients. We mixed all the data and redistribute the data into <math id="S5.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="K=100" display="inline"><semantics id="S5.SS1.SSS1.p2.1.m1.1a"><mrow id="S5.SS1.SSS1.p2.1.m1.1.1" xref="S5.SS1.SSS1.p2.1.m1.1.1.cmml"><mi id="S5.SS1.SSS1.p2.1.m1.1.1.2" xref="S5.SS1.SSS1.p2.1.m1.1.1.2.cmml">K</mi><mo id="S5.SS1.SSS1.p2.1.m1.1.1.1" xref="S5.SS1.SSS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS1.p2.1.m1.1.1.3" xref="S5.SS1.SSS1.p2.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p2.1.m1.1b"><apply id="S5.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1"><eq id="S5.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1.1"></eq><ci id="S5.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S5.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p2.1.m1.1c">K=100</annotation></semantics></math> clients with random selection. Thus, i.i.d data distribution is artificially obtained by redistributing data, breaking natural data imbalance: while this makes algorithm evaluation convenient, it also hides potential convergence problems.
For the sake of illustration, the top plot of Fig. <a href="#S5.F2" title="Figure 2 ‣ 5.1.1 Experimental settings ‣ 5.1 Image recognition ‣ 5 Experimental results ‣ Heterogeneous Data-Aware Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> reports a heatmap of the class per client distribution under i.i.d sampling.</p>
</div>
<div id="S5.SS1.SSS1.p3" class="ltx_para">
<p id="S5.SS1.SSS1.p3.1" class="ltx_p">The <em id="S5.SS1.SSS1.p3.1.1" class="ltx_emph ltx_font_italic">non-i.i.d sampling policy</em> is done by considering writer of the FEMNIST dataset. The data are split on 100 clients and a client local data corresponds to several writers.
The non-i.i.d sampling preserve the natural imbalance in the raw data distribution by considering each writer as a client, each of which has thus different data distributions.
The bottom plot of Fig. <a href="#S5.F2" title="Figure 2 ‣ 5.1.1 Experimental settings ‣ 5.1 Image recognition ‣ 5 Experimental results ‣ Heterogeneous Data-Aware Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> clearly shows the imbalance in the non-i.i.d. case.</p>
</div>
<div id="S5.SS1.SSS1.p4" class="ltx_para">
<p id="S5.SS1.SSS1.p4.1" class="ltx_p">Finally, the <em id="S5.SS1.SSS1.p4.1.1" class="ltx_emph ltx_font_italic">disjoint sampling policy</em> is obtained by mixing all the dataset and attributing two classes per client. Comparing with highly non i.i.d sampling method used in <cite class="ltx_cite ltx_citemacro_cite">Liang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite>, this sampling ensure there are no overlapping classes presented in two clients.
Thus, the data is artificially redistributed to extremely exacerbate imbalance on purpose. Notice that, given that the total number of classes is 62, this limit the maximum number of clients to 31 in this scenario.</p>
</div>
<figure id="S5.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2011.06393/assets/x3.png" id="S5.F2.1.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="221" height="116" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2011.06393/assets/x4.png" id="S5.F2.2.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="221" height="114" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Client data distribution heatmap: (left plot) i.i.d data distribution; (right plot) non i.i.d data</figcaption>
</figure>
<div id="S5.SS1.SSS1.p5" class="ltx_para">
<p id="S5.SS1.SSS1.p5.1" class="ltx_p">The CNN architecture is composed of two convolutional layers and two fully connected layers. We define the two convolutional layers and the following fully connected layer as the generic parameters, and the last layer as the specific parameters.</p>
</div>
<div id="S5.SS1.SSS1.p6" class="ltx_para">
<p id="S5.SS1.SSS1.p6.3" class="ltx_p">At each round of local training, <math id="S5.SS1.SSS1.p6.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S5.SS1.SSS1.p6.1.m1.1a"><mi id="S5.SS1.SSS1.p6.1.m1.1.1" xref="S5.SS1.SSS1.p6.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p6.1.m1.1b"><ci id="S5.SS1.SSS1.p6.1.m1.1.1.cmml" xref="S5.SS1.SSS1.p6.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p6.1.m1.1c">C</annotation></semantics></math> clients are selected randomly among the available clients. We conducted test with different settings of <math id="S5.SS1.SSS1.p6.2.m2.3" class="ltx_Math" alttext="C\in\{10,20,50\}" display="inline"><semantics id="S5.SS1.SSS1.p6.2.m2.3a"><mrow id="S5.SS1.SSS1.p6.2.m2.3.4" xref="S5.SS1.SSS1.p6.2.m2.3.4.cmml"><mi id="S5.SS1.SSS1.p6.2.m2.3.4.2" xref="S5.SS1.SSS1.p6.2.m2.3.4.2.cmml">C</mi><mo id="S5.SS1.SSS1.p6.2.m2.3.4.1" xref="S5.SS1.SSS1.p6.2.m2.3.4.1.cmml">∈</mo><mrow id="S5.SS1.SSS1.p6.2.m2.3.4.3.2" xref="S5.SS1.SSS1.p6.2.m2.3.4.3.1.cmml"><mo stretchy="false" id="S5.SS1.SSS1.p6.2.m2.3.4.3.2.1" xref="S5.SS1.SSS1.p6.2.m2.3.4.3.1.cmml">{</mo><mn id="S5.SS1.SSS1.p6.2.m2.1.1" xref="S5.SS1.SSS1.p6.2.m2.1.1.cmml">10</mn><mo id="S5.SS1.SSS1.p6.2.m2.3.4.3.2.2" xref="S5.SS1.SSS1.p6.2.m2.3.4.3.1.cmml">,</mo><mn id="S5.SS1.SSS1.p6.2.m2.2.2" xref="S5.SS1.SSS1.p6.2.m2.2.2.cmml">20</mn><mo id="S5.SS1.SSS1.p6.2.m2.3.4.3.2.3" xref="S5.SS1.SSS1.p6.2.m2.3.4.3.1.cmml">,</mo><mn id="S5.SS1.SSS1.p6.2.m2.3.3" xref="S5.SS1.SSS1.p6.2.m2.3.3.cmml">50</mn><mo stretchy="false" id="S5.SS1.SSS1.p6.2.m2.3.4.3.2.4" xref="S5.SS1.SSS1.p6.2.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p6.2.m2.3b"><apply id="S5.SS1.SSS1.p6.2.m2.3.4.cmml" xref="S5.SS1.SSS1.p6.2.m2.3.4"><in id="S5.SS1.SSS1.p6.2.m2.3.4.1.cmml" xref="S5.SS1.SSS1.p6.2.m2.3.4.1"></in><ci id="S5.SS1.SSS1.p6.2.m2.3.4.2.cmml" xref="S5.SS1.SSS1.p6.2.m2.3.4.2">𝐶</ci><set id="S5.SS1.SSS1.p6.2.m2.3.4.3.1.cmml" xref="S5.SS1.SSS1.p6.2.m2.3.4.3.2"><cn type="integer" id="S5.SS1.SSS1.p6.2.m2.1.1.cmml" xref="S5.SS1.SSS1.p6.2.m2.1.1">10</cn><cn type="integer" id="S5.SS1.SSS1.p6.2.m2.2.2.cmml" xref="S5.SS1.SSS1.p6.2.m2.2.2">20</cn><cn type="integer" id="S5.SS1.SSS1.p6.2.m2.3.3.cmml" xref="S5.SS1.SSS1.p6.2.m2.3.3">50</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p6.2.m2.3c">C\in\{10,20,50\}</annotation></semantics></math> for the i.i.d and non-i.i.d settings and <math id="S5.SS1.SSS1.p6.3.m3.3" class="ltx_Math" alttext="C\in\{10,20,31\}" display="inline"><semantics id="S5.SS1.SSS1.p6.3.m3.3a"><mrow id="S5.SS1.SSS1.p6.3.m3.3.4" xref="S5.SS1.SSS1.p6.3.m3.3.4.cmml"><mi id="S5.SS1.SSS1.p6.3.m3.3.4.2" xref="S5.SS1.SSS1.p6.3.m3.3.4.2.cmml">C</mi><mo id="S5.SS1.SSS1.p6.3.m3.3.4.1" xref="S5.SS1.SSS1.p6.3.m3.3.4.1.cmml">∈</mo><mrow id="S5.SS1.SSS1.p6.3.m3.3.4.3.2" xref="S5.SS1.SSS1.p6.3.m3.3.4.3.1.cmml"><mo stretchy="false" id="S5.SS1.SSS1.p6.3.m3.3.4.3.2.1" xref="S5.SS1.SSS1.p6.3.m3.3.4.3.1.cmml">{</mo><mn id="S5.SS1.SSS1.p6.3.m3.1.1" xref="S5.SS1.SSS1.p6.3.m3.1.1.cmml">10</mn><mo id="S5.SS1.SSS1.p6.3.m3.3.4.3.2.2" xref="S5.SS1.SSS1.p6.3.m3.3.4.3.1.cmml">,</mo><mn id="S5.SS1.SSS1.p6.3.m3.2.2" xref="S5.SS1.SSS1.p6.3.m3.2.2.cmml">20</mn><mo id="S5.SS1.SSS1.p6.3.m3.3.4.3.2.3" xref="S5.SS1.SSS1.p6.3.m3.3.4.3.1.cmml">,</mo><mn id="S5.SS1.SSS1.p6.3.m3.3.3" xref="S5.SS1.SSS1.p6.3.m3.3.3.cmml">31</mn><mo stretchy="false" id="S5.SS1.SSS1.p6.3.m3.3.4.3.2.4" xref="S5.SS1.SSS1.p6.3.m3.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p6.3.m3.3b"><apply id="S5.SS1.SSS1.p6.3.m3.3.4.cmml" xref="S5.SS1.SSS1.p6.3.m3.3.4"><in id="S5.SS1.SSS1.p6.3.m3.3.4.1.cmml" xref="S5.SS1.SSS1.p6.3.m3.3.4.1"></in><ci id="S5.SS1.SSS1.p6.3.m3.3.4.2.cmml" xref="S5.SS1.SSS1.p6.3.m3.3.4.2">𝐶</ci><set id="S5.SS1.SSS1.p6.3.m3.3.4.3.1.cmml" xref="S5.SS1.SSS1.p6.3.m3.3.4.3.2"><cn type="integer" id="S5.SS1.SSS1.p6.3.m3.1.1.cmml" xref="S5.SS1.SSS1.p6.3.m3.1.1">10</cn><cn type="integer" id="S5.SS1.SSS1.p6.3.m3.2.2.cmml" xref="S5.SS1.SSS1.p6.3.m3.2.2">20</cn><cn type="integer" id="S5.SS1.SSS1.p6.3.m3.3.3.cmml" xref="S5.SS1.SSS1.p6.3.m3.3.3">31</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p6.3.m3.3c">C\in\{10,20,31\}</annotation></semantics></math> for the disjoint settings (since we are capped by the number of classes in the latter case).
In order to have a fair comparison between algorithms, the clients chosen at each round are the same for a defined setting (number of client, client local data distribution).</p>
</div>
<div id="S5.SS1.SSS1.p7" class="ltx_para">
<p id="S5.SS1.SSS1.p7.2" class="ltx_p">The experiments are repeated 6 times with local epoch <math id="S5.SS1.SSS1.p7.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS1.SSS1.p7.1.m1.1a"><mi id="S5.SS1.SSS1.p7.1.m1.1.1" xref="S5.SS1.SSS1.p7.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p7.1.m1.1b"><ci id="S5.SS1.SSS1.p7.1.m1.1.1.cmml" xref="S5.SS1.SSS1.p7.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p7.1.m1.1c">E</annotation></semantics></math>=1 and a maximum of <math id="S5.SS1.SSS1.p7.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS1.SSS1.p7.2.m2.1a"><mi id="S5.SS1.SSS1.p7.2.m2.1.1" xref="S5.SS1.SSS1.p7.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p7.2.m2.1b"><ci id="S5.SS1.SSS1.p7.2.m2.1.1.cmml" xref="S5.SS1.SSS1.p7.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p7.2.m2.1c">T</annotation></semantics></math>=400 rounds of communications. We haven’t conducted exhaustive search for optimum hyperparameters like batch size, learning rate, etc.</p>
</div>
</section>
<section id="S5.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Accuracy performance</h4>

<div id="S5.SS1.SSS2.p1" class="ltx_para">
<p id="S5.SS1.SSS2.p1.1" class="ltx_p">Tab. <a href="#S5.T3" title="Table 3 ‣ 5.1.2 Accuracy performance ‣ 5.1 Image recognition ‣ 5 Experimental results ‣ Heterogeneous Data-Aware Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> summarizes the results for the three sampling strategies. In the i.i.d case, FedAvg by <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite> gives better results than our approach.
In a centralized learning, having the whole dataset instead of a sub-part will improve the accuracy.
As the local data distribution is the same on each client, what would be beneficial in a centralized scheme is also beneficial on each client. Intuitively, sharing the whole model allows to somehow exploit the whole dataset, and therefore includes more variability during the training that increases the model representation capabilities.
In our approach, even if the feature extraction also benefit from seeing the whole dataset, the specific layers relies on a smaller amount of data, leading to an accuracy decrease.</p>
</div>
<div id="S5.SS1.SSS2.p2" class="ltx_para">
<p id="S5.SS1.SSS2.p2.1" class="ltx_p">In the non-i.i.d case, the results are reversed, our approach gives better results than the FedAvg. In HDAFL, the client specific layer allows to capture more the client data distribution than the FedAvg approach. As non-i.i.d. data is prevalent in the real-world over i.i.d. data, we also expect gains over FedAvg to be consistent in practice.</p>
</div>
<div id="S5.SS1.SSS2.p3" class="ltx_para">
<p id="S5.SS1.SSS2.p3.1" class="ltx_p">The disjoint experiment is an extreme case, that illustrates a limitation of the FedAvg approach, and project the potential benefit of our proposal.
To understand why this happens, consider that <cite class="ltx_cite ltx_citemacro_cite">Zhao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite> show that this disjoint case correspond to the maximum probability distance, thus maximum weights divergence. Consider further that in the disjoint settings, each client has two classes. For example, averaging the classification layer over 10 clients leads to add 9 times a non relevant weight (in the sense the class has not been seen during the training) and 1 time a relevant weight for triggering the neurons corresponding to each class. Our approach do not suffer from this problem, since it keeps the classification layer specific to each client.</p>
</div>
<div id="S5.SS1.SSS2.p4" class="ltx_para">
<p id="S5.SS1.SSS2.p4.1" class="ltx_p">One potential downside of HDAFL is that last layer specificity might leads to some over adaptation. However, we point out this may happen in cases where most classes are disjoint, which is an extreme case considered here only to show the potential gain of the method even where the benefit from joint learning is marginal. At the same time, we expect real world cases to exhibit mixture of non-i.i.d. and occasional disjoint classes: in these cases, sharing generic model parameters is beneficial and client over adaptation less likely since several clients have their own data for the very same classes.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Accuracy results on FEMNIST dataset at 400 rounds of communications for the three experimental settings.</figcaption>
<table id="S5.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.1.1.1" class="ltx_tr" style="background-color:#E6E6E6;">
<th id="S5.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="2"><span id="S5.T3.1.1.1.1.1" class="ltx_text" style="background-color:#E6E6E6;">Experimental</span></th>
<td id="S5.T3.1.1.1.2" class="ltx_td ltx_align_center" colspan="3"><span id="S5.T3.1.1.1.2.1" class="ltx_text" style="background-color:#E6E6E6;">Client selected</span></td>
</tr>
<tr id="S5.T3.1.2.2" class="ltx_tr" style="background-color:#E6E6E6;">
<th id="S5.T3.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T3.1.2.2.1.1" class="ltx_text" style="background-color:#E6E6E6;">Settings</span></th>
<th id="S5.T3.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T3.1.2.2.2.1" class="ltx_text" style="background-color:#E6E6E6;">Method</span></th>
<td id="S5.T3.1.2.2.3" class="ltx_td ltx_align_center"><span id="S5.T3.1.2.2.3.1" class="ltx_text" style="background-color:#E6E6E6;">10</span></td>
<td id="S5.T3.1.2.2.4" class="ltx_td ltx_align_center"><span id="S5.T3.1.2.2.4.1" class="ltx_text" style="background-color:#E6E6E6;">20</span></td>
<td id="S5.T3.1.2.2.5" class="ltx_td ltx_align_center"><span id="S5.T3.1.2.2.5.1" class="ltx_text" style="background-color:#E6E6E6;">50</span></td>
</tr>
<tr id="S5.T3.1.3.3" class="ltx_tr">
<th id="S5.T3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">i.i.d</th>
<th id="S5.T3.1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">HDAFL</th>
<td id="S5.T3.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">74.90</td>
<td id="S5.T3.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">75.37</td>
<td id="S5.T3.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">75.89</td>
</tr>
<tr id="S5.T3.1.4.4" class="ltx_tr">
<th id="S5.T3.1.4.4.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S5.T3.1.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvg</th>
<td id="S5.T3.1.4.4.3" class="ltx_td ltx_align_center"><span id="S5.T3.1.4.4.3.1" class="ltx_text ltx_font_bold">78.26</span></td>
<td id="S5.T3.1.4.4.4" class="ltx_td ltx_align_center"><span id="S5.T3.1.4.4.4.1" class="ltx_text ltx_font_bold">79.00</span></td>
<td id="S5.T3.1.4.4.5" class="ltx_td ltx_align_center"><span id="S5.T3.1.4.4.5.1" class="ltx_text ltx_font_bold">79.03</span></td>
</tr>
<tr id="S5.T3.1.5.5" class="ltx_tr">
<th id="S5.T3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">non-i.i.d</th>
<th id="S5.T3.1.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">HDAFL</th>
<td id="S5.T3.1.5.5.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.5.5.3.1" class="ltx_text ltx_font_bold">79.61</span></td>
<td id="S5.T3.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.5.5.4.1" class="ltx_text ltx_font_bold">79.97</span></td>
<td id="S5.T3.1.5.5.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.5.5.5.1" class="ltx_text ltx_font_bold">80.47</span></td>
</tr>
<tr id="S5.T3.1.6.6" class="ltx_tr">
<th id="S5.T3.1.6.6.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S5.T3.1.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvg</th>
<td id="S5.T3.1.6.6.3" class="ltx_td ltx_align_center">78.00</td>
<td id="S5.T3.1.6.6.4" class="ltx_td ltx_align_center">78.88</td>
<td id="S5.T3.1.6.6.5" class="ltx_td ltx_align_center">79.06</td>
</tr>
<tr id="S5.T3.1.7.7" class="ltx_tr" style="background-color:#E6E6E6;">
<th id="S5.T3.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S5.T3.1.7.7.1.1" class="ltx_text" style="background-color:#E6E6E6;">Settings</span></th>
<th id="S5.T3.1.7.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S5.T3.1.7.7.2.1" class="ltx_text" style="background-color:#E6E6E6;">Method</span></th>
<td id="S5.T3.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.7.7.3.1" class="ltx_text" style="background-color:#E6E6E6;">10</span></td>
<td id="S5.T3.1.7.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.7.7.4.1" class="ltx_text" style="background-color:#E6E6E6;">20</span></td>
<td id="S5.T3.1.7.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.7.7.5.1" class="ltx_text" style="background-color:#E6E6E6;">31</span></td>
</tr>
<tr id="S5.T3.1.8.8" class="ltx_tr">
<th id="S5.T3.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Disjoint</th>
<th id="S5.T3.1.8.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">HDAFL</th>
<td id="S5.T3.1.8.8.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.8.8.3.1" class="ltx_text ltx_font_bold">97.53</span></td>
<td id="S5.T3.1.8.8.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.8.8.4.1" class="ltx_text ltx_font_bold">97.80</span></td>
<td id="S5.T3.1.8.8.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.8.8.5.1" class="ltx_text ltx_font_bold">97.78</span></td>
</tr>
<tr id="S5.T3.1.9.9" class="ltx_tr">
<th id="S5.T3.1.9.9.1" class="ltx_td ltx_th ltx_th_row ltx_border_b"></th>
<th id="S5.T3.1.9.9.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">FedAvg</th>
<td id="S5.T3.1.9.9.3" class="ltx_td ltx_align_center ltx_border_b">17.44</td>
<td id="S5.T3.1.9.9.4" class="ltx_td ltx_align_center ltx_border_b">18.99</td>
<td id="S5.T3.1.9.9.5" class="ltx_td ltx_align_center ltx_border_b">19.51</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3 </span>Communication complexity</h4>

<div id="S5.SS1.SSS3.p1" class="ltx_para">
<p id="S5.SS1.SSS3.p1.1" class="ltx_p">Communication cost is an important metric for federated learning. Two factors concur in reducing communication complexity: the rate of convergence at a target accuracy,
which determines the number of rounds, and the amount of model parameters transferred at each round.
We show in Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.1.3 Communication complexity ‣ 5.1 Image recognition ‣ 5 Experimental results ‣ Heterogeneous Data-Aware Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> the convergence analysis of the accuracy over the number of rounds communications for the non-i.i.d sampling.
Our method converge more quickly than the FedAvg and achieves a higher accuracy. Generally speaking, curves are smoother when more clients participate in learning. This smoothness can also be attained by our method with less clients: sharing only the generic parameters decreases the weights divergence, which in turns increases the model stability, explaining the smoothness. Reduced weight divergence leads to faster convergence and smaller communication costs.</p>
</div>
<div id="S5.SS1.SSS3.p2" class="ltx_para">
<p id="S5.SS1.SSS3.p2.2" class="ltx_p">Tab. <a href="#S5.T4" title="Table 4 ‣ 5.1.3 Communication complexity ‣ 5.1 Image recognition ‣ 5 Experimental results ‣ Heterogeneous Data-Aware Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> report the communication cost needed to attain a target of 78% average accuracy<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>To allow a full comparison, target is selected as the minimum over non-i.i.d settings (FedAvg <math id="footnote1.m1.1" class="ltx_Math" alttext="C=10" display="inline"><semantics id="footnote1.m1.1b"><mrow id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml"><mi id="footnote1.m1.1.1.2" xref="footnote1.m1.1.1.2.cmml">C</mi><mo id="footnote1.m1.1.1.1" xref="footnote1.m1.1.1.1.cmml">=</mo><mn id="footnote1.m1.1.1.3" xref="footnote1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><apply id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1"><eq id="footnote1.m1.1.1.1.cmml" xref="footnote1.m1.1.1.1"></eq><ci id="footnote1.m1.1.1.2.cmml" xref="footnote1.m1.1.1.2">𝐶</ci><cn type="integer" id="footnote1.m1.1.1.3.cmml" xref="footnote1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">C=10</annotation></semantics></math> in Tab.<a href="#S5.T3" title="Table 3 ‣ 5.1.2 Accuracy performance ‣ 5.1 Image recognition ‣ 5 Experimental results ‣ Heterogeneous Data-Aware Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>)</span></span></span>. The minimum communication cost of HDAFL is 86.8 Mbyte, two times lower than FedAvg. If training duration is a priority factor, we can let 50 clients participate in each round, so that learning lasts only 83 rounds, which is 1.3<math id="S5.SS1.SSS3.p2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.SS1.SSS3.p2.1.m1.1a"><mo id="S5.SS1.SSS3.p2.1.m1.1.1" xref="S5.SS1.SSS3.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS3.p2.1.m1.1b"><times id="S5.SS1.SSS3.p2.1.m1.1.1.cmml" xref="S5.SS1.SSS3.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS3.p2.1.m1.1c">\times</annotation></semantics></math> faster than FedAvg and requires a 1.5<math id="S5.SS1.SSS3.p2.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.SS1.SSS3.p2.2.m2.1a"><mo id="S5.SS1.SSS3.p2.2.m2.1.1" xref="S5.SS1.SSS3.p2.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS3.p2.2.m2.1b"><times id="S5.SS1.SSS3.p2.2.m2.1.1.cmml" xref="S5.SS1.SSS3.p2.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS3.p2.2.m2.1c">\times</annotation></semantics></math> smaller volume of exchanges. We stress that these already quite sizeable gains are obtained in the non-i.i.d case, and can be expected to grow when the imbalance grows, as testified by the performance gap in the extreme disjoint case.</p>
</div>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2011.06393/assets/x5.png" id="S5.F3.sf1.g1" class="ltx_graphics ltx_img_landscape" width="230" height="168" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>10 Clients</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2011.06393/assets/x6.png" id="S5.F3.sf2.g1" class="ltx_graphics ltx_img_landscape" width="230" height="168" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>50 Clients</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F3.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2011.06393/assets/x7.png" id="S5.F3.sf3.g1" class="ltx_graphics ltx_img_landscape" width="230" height="168" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>10 Clients</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F3.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2011.06393/assets/x8.png" id="S5.F3.sf4.g1" class="ltx_graphics ltx_img_landscape" width="230" height="168" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>31 Clients</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Clients average testing accuracy evolution over the 400 rounds of communications: non-i.i.d (top a,b plots) and disjoint (bottom c,d plots) sampling policies.
</figcaption>
</figure>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Communication cost to attain 78% accuracy (non-i.i.d)</figcaption>
<table id="S5.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.1.1.1" class="ltx_tr" style="background-color:#E6E6E6;">
<th id="S5.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row">
<span id="S5.T4.1.1.1.1.1" class="ltx_inline-block" style="background-color:#E6E6E6;">
<span id="S5.T4.1.1.1.1.1.1" class="ltx_p">Clients</span>
<span id="S5.T4.1.1.1.1.1.2" class="ltx_p">selected</span>
</span>
</th>
<th id="S5.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S5.T4.1.1.1.2.1" class="ltx_text" style="background-color:#E6E6E6;">Method</span></th>
<th id="S5.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S5.T4.1.1.1.3.1" class="ltx_inline-block" style="background-color:#E6E6E6;">
<span id="S5.T4.1.1.1.3.1.1" class="ltx_p">Rounds</span>
<span id="S5.T4.1.1.1.3.1.2" class="ltx_p">number</span>
</span>
</th>
<th id="S5.T4.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<span id="S5.T4.1.1.1.4.1" class="ltx_inline-block" style="background-color:#E6E6E6;">
<span id="S5.T4.1.1.1.4.1.1" class="ltx_p">Communication</span>
<span id="S5.T4.1.1.1.4.1.2" class="ltx_p">Cost (MB)</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.1.2.1" class="ltx_tr">
<th id="S5.T4.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">10</th>
<td id="S5.T4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">HDAFL</td>
<td id="S5.T4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.1.2.1.3.1" class="ltx_text ltx_font_bold">139</span></td>
<td id="S5.T4.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.1.2.1.4.1" class="ltx_text ltx_font_bold">86.8</span></td>
</tr>
<tr id="S5.T4.1.3.2" class="ltx_tr">
<th id="S5.T4.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">20</th>
<td id="S5.T4.1.3.2.2" class="ltx_td ltx_align_center">HDAFL</td>
<td id="S5.T4.1.3.2.3" class="ltx_td ltx_align_center"><span id="S5.T4.1.3.2.3.1" class="ltx_text ltx_font_bold">110</span></td>
<td id="S5.T4.1.3.2.4" class="ltx_td ltx_align_center"><span id="S5.T4.1.3.2.4.1" class="ltx_text ltx_font_bold">137.5</span></td>
</tr>
<tr id="S5.T4.1.4.3" class="ltx_tr">
<th id="S5.T4.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">50</th>
<td id="S5.T4.1.4.3.2" class="ltx_td ltx_align_center">HDAFL</td>
<td id="S5.T4.1.4.3.3" class="ltx_td ltx_align_center"><span id="S5.T4.1.4.3.3.1" class="ltx_text ltx_font_bold">83</span></td>
<td id="S5.T4.1.4.3.4" class="ltx_td ltx_align_center"><span id="S5.T4.1.4.3.4.1" class="ltx_text ltx_font_bold">259.3</span></td>
</tr>
<tr id="S5.T4.1.5.4" class="ltx_tr">
<th id="S5.T4.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">10</th>
<td id="S5.T4.1.5.4.2" class="ltx_td ltx_align_center ltx_border_t">FedAvg</td>
<td id="S5.T4.1.5.4.3" class="ltx_td ltx_align_center ltx_border_t">259</td>
<td id="S5.T4.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t">171.7</td>
</tr>
<tr id="S5.T4.1.6.5" class="ltx_tr">
<th id="S5.T4.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">20</th>
<td id="S5.T4.1.6.5.2" class="ltx_td ltx_align_center">FedAvg</td>
<td id="S5.T4.1.6.5.3" class="ltx_td ltx_align_center">157</td>
<td id="S5.T4.1.6.5.4" class="ltx_td ltx_align_center">208.2</td>
</tr>
<tr id="S5.T4.1.7.6" class="ltx_tr">
<th id="S5.T4.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">50</th>
<td id="S5.T4.1.7.6.2" class="ltx_td ltx_align_center ltx_border_b">FedAvg</td>
<td id="S5.T4.1.7.6.3" class="ltx_td ltx_align_center ltx_border_b">115</td>
<td id="S5.T4.1.7.6.4" class="ltx_td ltx_align_center ltx_border_b">381.2</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>TCP/IP Traffic classification</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We note that in the TCP/IP Traffic classification use case, FedAvg could be hardly used in practice due to the privacy constraint that HDAFL solves. Still, it makes sense to contrast the performance of both algorithms.
The algorithmic targets are to contain the model accuracy loss due to distributed training to less than 1% (hard constraint) with an at least 10-fold reduction
in the communication cost with respect to the case where all data is sent in a
space efficient and compressed format to a central location for training (soft constraint).</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">As our focus is on the ability of FL algorithms to distributed the training process, we report results relative to the centralized model. As shown in Tab.<a href="#S5.T5" title="Table 5 ‣ 5.2 TCP/IP Traffic classification ‣ 5 Experimental results ‣ Heterogeneous Data-Aware Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, our method always achieves less accuracy drop compared with the FedAvg<cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite>. In particular, accuracy reduction in HDAFL approaches the 1% target already after 4 rounds, with a 33-fold reduction of the communication cost. At 8 rounds, the accuracy reduction is half of the target, for a 16-fold communication cost. In contrast, FedAvg is not able to achieve the accuracy target, and this irrespective of the number of rounds. Finally, it is once more worth stressing the slight but noticeable communication cost reduction of HDAFL over FedAvg, which stems from the confidentiality of the last layers.</p>
</div>
<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Comparison table for the TCP/IP traffic classification. Performance loss (accuracy) and gain (communication) are relative to those of a centralized trained model.</figcaption>
<table id="S5.T5.6.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T5.6.6.7.1" class="ltx_tr">
<th id="S5.T5.6.6.7.1.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S5.T5.6.6.7.1.2" class="ltx_td ltx_th ltx_th_column ltx_th_row"></th>
<th id="S5.T5.6.6.7.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column"><span id="S5.T5.6.6.7.1.3.1" class="ltx_text" style="background-color:#E6E6E6;">Accuracy</span></th>
<th id="S5.T5.6.6.7.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column"><span id="S5.T5.6.6.7.1.4.1" class="ltx_text" style="background-color:#E6E6E6;">Communication</span></th>
</tr>
<tr id="S5.T5.6.6.8.2" class="ltx_tr" style="background-color:#E6E6E6;">
<th id="S5.T5.6.6.8.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row"><span id="S5.T5.6.6.8.2.1.1" class="ltx_text" style="background-color:#E6E6E6;">Method</span></th>
<th id="S5.T5.6.6.8.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row"><span id="S5.T5.6.6.8.2.2.1" class="ltx_text" style="background-color:#E6E6E6;">Rounds</span></th>
<th id="S5.T5.6.6.8.2.3" class="ltx_td ltx_align_right ltx_th ltx_th_column"><span id="S5.T5.6.6.8.2.3.1" class="ltx_text" style="background-color:#E6E6E6;">loss</span></th>
<th id="S5.T5.6.6.8.2.4" class="ltx_td ltx_align_right ltx_th ltx_th_column"><span id="S5.T5.6.6.8.2.4.1" class="ltx_text" style="background-color:#E6E6E6;">gain</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T5.1.1.1" class="ltx_tr">
<th id="S5.T5.1.1.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S5.T5.1.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">4</th>
<td id="S5.T5.1.1.1.4" class="ltx_td ltx_align_right ltx_border_t">-2.0%</td>
<td id="S5.T5.1.1.1.1" class="ltx_td ltx_align_right ltx_border_t">28.9<math id="S5.T5.1.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.T5.1.1.1.1.m1.1a"><mo id="S5.T5.1.1.1.1.m1.1.1" xref="S5.T5.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.T5.1.1.1.1.m1.1b"><times id="S5.T5.1.1.1.1.m1.1.1.cmml" xref="S5.T5.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.1.1.1.1.m1.1c">\times</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T5.2.2.2" class="ltx_tr">
<th id="S5.T5.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvg</th>
<th id="S5.T5.2.2.2.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">8</th>
<td id="S5.T5.2.2.2.4" class="ltx_td ltx_align_right">-1.6%</td>
<td id="S5.T5.2.2.2.1" class="ltx_td ltx_align_right">14.5<math id="S5.T5.2.2.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.T5.2.2.2.1.m1.1a"><mo id="S5.T5.2.2.2.1.m1.1.1" xref="S5.T5.2.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.T5.2.2.2.1.m1.1b"><times id="S5.T5.2.2.2.1.m1.1.1.cmml" xref="S5.T5.2.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.2.2.2.1.m1.1c">\times</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T5.3.3.3" class="ltx_tr">
<th id="S5.T5.3.3.3.2" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S5.T5.3.3.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">20</th>
<td id="S5.T5.3.3.3.4" class="ltx_td ltx_align_right">-1.7%</td>
<td id="S5.T5.3.3.3.1" class="ltx_td ltx_align_right">5.8<math id="S5.T5.3.3.3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.T5.3.3.3.1.m1.1a"><mo id="S5.T5.3.3.3.1.m1.1.1" xref="S5.T5.3.3.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.T5.3.3.3.1.m1.1b"><times id="S5.T5.3.3.3.1.m1.1.1.cmml" xref="S5.T5.3.3.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.3.3.3.1.m1.1c">\times</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T5.4.4.4" class="ltx_tr">
<th id="S5.T5.4.4.4.2" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S5.T5.4.4.4.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">4</th>
<td id="S5.T5.4.4.4.4" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T5.4.4.4.4.1" class="ltx_text ltx_font_bold">-1.2%</span></td>
<td id="S5.T5.4.4.4.1" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T5.4.4.4.1.1" class="ltx_text ltx_font_bold">32.9<math id="S5.T5.4.4.4.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.T5.4.4.4.1.1.m1.1a"><mo id="S5.T5.4.4.4.1.1.m1.1.1" xref="S5.T5.4.4.4.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.T5.4.4.4.1.1.m1.1b"><times id="S5.T5.4.4.4.1.1.m1.1.1.cmml" xref="S5.T5.4.4.4.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.4.4.4.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S5.T5.5.5.5" class="ltx_tr">
<th id="S5.T5.5.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">HDAFL</th>
<th id="S5.T5.5.5.5.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">8</th>
<td id="S5.T5.5.5.5.4" class="ltx_td ltx_align_right"><span id="S5.T5.5.5.5.4.1" class="ltx_text ltx_font_bold">-0.4%</span></td>
<td id="S5.T5.5.5.5.1" class="ltx_td ltx_align_right"><span id="S5.T5.5.5.5.1.1" class="ltx_text ltx_font_bold">16.5<math id="S5.T5.5.5.5.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.T5.5.5.5.1.1.m1.1a"><mo id="S5.T5.5.5.5.1.1.m1.1.1" xref="S5.T5.5.5.5.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.T5.5.5.5.1.1.m1.1b"><times id="S5.T5.5.5.5.1.1.m1.1.1.cmml" xref="S5.T5.5.5.5.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.5.5.5.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
<tr id="S5.T5.6.6.6" class="ltx_tr">
<th id="S5.T5.6.6.6.2" class="ltx_td ltx_th ltx_th_row ltx_border_b"></th>
<th id="S5.T5.6.6.6.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b">20</th>
<td id="S5.T5.6.6.6.4" class="ltx_td ltx_align_right ltx_border_b"><span id="S5.T5.6.6.6.4.1" class="ltx_text ltx_font_bold">-0.5%</span></td>
<td id="S5.T5.6.6.6.1" class="ltx_td ltx_align_right ltx_border_b"><span id="S5.T5.6.6.6.1.1" class="ltx_text ltx_font_bold">6.6<math id="S5.T5.6.6.6.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.T5.6.6.6.1.1.m1.1a"><mo id="S5.T5.6.6.6.1.1.m1.1.1" xref="S5.T5.6.6.6.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.T5.6.6.6.1.1.m1.1b"><times id="S5.T5.6.6.6.1.1.m1.1.1.cmml" xref="S5.T5.6.6.6.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.6.6.6.1.1.m1.1c">\times</annotation></semantics></math></span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">Towards the deployment of federated learning in large scale production system,
we present our method that is specially designed for limiting the share of sensitive model information, and solving the practical problems non i.i.d data, disjoint classes and signal multi-modality across dataset.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">The main idea behind our proposal is to share generic feature extraction among clients, while letting each client keep a local private version of the specific classifier. Experiments show that, with respect to FedAvg by <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite>, our method only exhibit a slight penalty in case of i.i.d data, while performance benefits (in terms of accuracy, convergence rate and communication cost) are noticeable for non-i.i.d. data, and significantly
increase as the imbalance grows.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anil <span id="bib.bib1.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Rohan Anil, Gabriel Pereyra, Alexandre Passos, Róbert Ormándi,
George E. Dahl, and Geoffrey E. Hinton.

</span>
<span class="ltx_bibblock">Large scale distributed neural network training through online
distillation.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1804.03235, 2018.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldas <span id="bib.bib2.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Sebastian Caldas, Peter Wu, Tian Li, Jakub Konecný, H. Brendan McMahan,
Virginia Smith, and Ameet Talwalkar.

</span>
<span class="ltx_bibblock">LEAF: A benchmark for federated settings.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1812.01097, 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohen <span id="bib.bib3.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Gregory Cohen, Saeed Afshar, Jonathan Tapson, and André van Schaik.

</span>
<span class="ltx_bibblock">EMNIST: an extension of MNIST to handwritten letters.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1702.05373, 2017.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Crotti <span id="bib.bib4.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2007]</span>
<span class="ltx_bibblock">
Manuel Crotti, Maurizio Dusi, Francesco Gringoli, and Luca Salgarelli.

</span>
<span class="ltx_bibblock">Traffic classification through simple statistical fingerprinting.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic">ACM SIGCOMM Comput. Commun. Rev.</span>, 37(1):5–16, 2007.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izbicki and Shelton [2019]</span>
<span class="ltx_bibblock">
Mike Izbicki and Christian R. Shelton.

</span>
<span class="ltx_bibblock">Distributed learning of neural networks with one round of
communication.

</span>
<span class="ltx_bibblock">2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeong <span id="bib.bib6.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Eunjeong Jeong, Seungeun Oh, Hyesung Kim, Jihong Park, Mehdi Bennis, and
Seong-Lyun Kim.

</span>
<span class="ltx_bibblock">Communication-efficient on-device machine learning: Federated
distillation and augmentation under non-iid private data.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1811.11479, 2018.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konecný <span id="bib.bib7.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2016]</span>
<span class="ltx_bibblock">
Jakub Konecný, H. Brendan McMahan, Felix X. Yu, Peter Richtárik,
Ananda Theertha Suresh, and Dave Bacon.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication
efficiency.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1610.05492, 2016.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib8.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Tian Li, Maziar Sanjabi, and Virginia Smith.

</span>
<span class="ltx_bibblock">Fair resource allocation in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1905.10497, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang <span id="bib.bib9.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Paul Pu Liang, Terrance Liu, Liu Ziyin, Ruslan Salakhutdinov, and
Louis-Philippe Morency.

</span>
<span class="ltx_bibblock">Think locally, act globally: Federated learning with local and global
representations.

</span>
<span class="ltx_bibblock">2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan <span id="bib.bib10.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2016]</span>
<span class="ltx_bibblock">
H. Brendan McMahan, Eider Moore, Daniel Ramage, and Blaise Agüera
y Arcas.

</span>
<span class="ltx_bibblock">Federated learning of deep networks using model averaging.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1602.05629, 2016.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohri <span id="bib.bib11.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Mehryar Mohri, Gary Sivek, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Agnostic federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1902.00146, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sahu <span id="bib.bib12.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Anit Kumar Sahu, Tian Li, Maziar Sanjabi, Manzil Zaheer, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">On the convergence of federated optimization in heterogeneous
networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1812.06127, 2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Santiago <span id="bib.bib13.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2012]</span>
<span class="ltx_bibblock">
P.M. Santiago, D. Rossi, F. Gringoli, L. Nava, L. Salgarelli, and J. Aracil.

</span>
<span class="ltx_bibblock">Wire-speed statistical classification of network traffic on commodity
hardware.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.3.1" class="ltx_text ltx_font_italic">ACM SIGCOMMM Internet Measurement Conference (IMC)</span>, 2012.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler <span id="bib.bib14.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Felix Sattler, Klaus-Robert Müller, and Wojciech Samek.

</span>
<span class="ltx_bibblock">Clustered federated learning: Model-agnostic distributed multi-task
optimization under privacy constraints.

</span>
<span class="ltx_bibblock">10 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yosinski <span id="bib.bib15.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2014]</span>
<span class="ltx_bibblock">
Jason Yosinski, Jeff Clune, Yoshua Bengio, and Hod Lipson.

</span>
<span class="ltx_bibblock">How transferable are features in deep neural networks?

</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1411.1792, 2014.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao <span id="bib.bib16.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1806.00582, 2018.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2011.06392" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2011.06393" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2011.06393">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2011.06393" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2011.06394" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Mar 19 04:52:43 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
