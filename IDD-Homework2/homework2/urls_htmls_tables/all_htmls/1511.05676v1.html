<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1511.05676] Compositional Memory for Visual Question Answering</title><meta property="og:description" content="Visual Question Answering (VQA) emerges as one of the most fascinating topics in computer vision recently. Many state of the art methods naively use holistic visual features with language features into a Long Short-Ter…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Compositional Memory for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Compositional Memory for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1511.05676">

<!--Generated on Fri Mar  8 04:37:36 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Compositional Memory for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Aiwen Jiang<sup id="id23.22.id1" class="ltx_sup"><span id="id23.22.id1.1" class="ltx_text ltx_font_italic">1,2</span></sup>                    Fang Wang<sup id="id24.23.id2" class="ltx_sup"><span id="id24.23.id2.1" class="ltx_text ltx_font_italic">2</span></sup>                     Fatih Porikli<sup id="id25.24.id3" class="ltx_sup"><span id="id25.24.id3.1" class="ltx_text ltx_font_italic">2</span></sup>                     Yi Li<math id="id10.10.m10.2" class="ltx_math_unparsed" alttext="{}^{*}~{}^{2,3}" display="inline"><semantics id="id10.10.m10.2a"><mmultiscripts id="id10.10.m10.2.3"><msup id="id10.10.m10.2.2"><mi id="id10.10.m10.2.2a"></mi><mrow id="id10.10.m10.2.2.2.4"><mn id="id10.10.m10.1.1.1.1">2</mn><mo id="id10.10.m10.2.2.2.4.1">,</mo><mn id="id10.10.m10.2.2.2.2">3</mn></mrow></msup><mprescripts id="id10.10.m10.2.3a"></mprescripts><mrow id="id10.10.m10.2.3b"></mrow><mo id="id10.10.m10.2.3.2">∗</mo></mmultiscripts><annotation encoding="application/x-tex" id="id10.10.m10.2b">{}^{*}~{}^{2,3}</annotation></semantics></math>
<br class="ltx_break">
<br class="ltx_break"><sup id="id26.25.id4" class="ltx_sup"><span id="id26.25.id4.1" class="ltx_text ltx_font_italic">1</span></sup>Jiangxi Normal University          <sup id="id27.26.id5" class="ltx_sup"><span id="id27.26.id5.1" class="ltx_text ltx_font_italic">2</span></sup>NICTA and ANU                    <sup id="id28.27.id6" class="ltx_sup">3</sup>Toyota Research Institute North America
<br class="ltx_break"><sup id="id29.28.id7" class="ltx_sup"><span id="id29.28.id7.1" class="ltx_text ltx_font_italic">1</span></sup>aiwen.jiang@nicta.com.au      <sup id="id30.29.id8" class="ltx_sup">2</sup>{fang.wang, fatih.porikli}@nicta.com.au      <sup id="id31.30.id9" class="ltx_sup"><span id="id31.30.id9.1" class="ltx_text ltx_font_italic">3</span></sup>yi.li@tema.toyota.com
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id32.id1" class="ltx_p">Visual Question Answering (VQA) emerges as one of the most fascinating topics in computer vision recently. Many state of the art methods naively use holistic visual features with language features into a Long Short-Term Memory (LSTM) module, neglecting the sophisticated interaction between them. This coarse modeling also blocks the possibilities of exploring finer-grained local features that contribute to the question answering dynamically over time.</p>
<p id="id22.1" class="ltx_p">This paper addresses this fundamental problem by directly modeling the temporal dynamics between language and all possible local image patches. When traversing the question words sequentially, our end-to-end approach explicitly fuses the features associated to the words and the ones available at multiple local patches in an attention mechanism, and further combines the fused information to generate dynamic messages, which we call episode. We then feed the episodes to a standard question answering module together with the contextual visual information and linguistic information. Motivated by recent practices in deep learning, we use auxiliary loss functions during training to improve the performance. Our experiments on two latest public datasets suggest that our method has a superior performance. Notably, on the DAQUAR dataset we advanced the state of the art by 6<math id="id22.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="id22.1.m1.1a"><mo id="id22.1.m1.1.1" xref="id22.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="id22.1.m1.1b"><csymbol cd="latexml" id="id22.1.m1.1.1.cmml" xref="id22.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="id22.1.m1.1c">\%</annotation></semantics></math>, and we also evaluated our approach on the most recent MSCOCO-VQA dataset.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Given an image and a question, the goal of Visual Question Answering (VQA) is to directly infer the answer(s) automatically from the image. This is undoubtedly one of the most interesting, and arguably one of the most challenging, topics in computer vision in recent times.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Almost all state-of-the-art methods use predominantly holistic visual features in their systems. For example, Malinowski <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> used the concatenation of linguistic feature and visual feature extracted by a Convolutional Neural Network (CNN), and Ren <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> considered the visual feature as the first word to initialize the sequential learning.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">While the use of holistic approach is straightforward and convenient, it is, however, debatably problematic. For example, in the VQA problems many answers are directly related to the contents of some image regions. Therefore, it is dubious if the holistic features are rich enough to provide the information only available at regions. Also, it may hinder the exploration of finer-grained local features for VQA.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper we propose a Compositional Memory for an end-to-end training framework. Our approach takes the advantage of the recent progresses in image captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, natural language processing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, and computer vision to advance the study of the VQA. Our goal is to fuse local visual features and the linguistic information over time, in a Long Short-Term Memory (LSTM) based framework. The fused information, which we call “episodes”, characterizes the interaction and dynamics between vision and language.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Explicitly addressing the interaction between question words and local visual features has a number of advantages. To begin with, regions provide rich info towards capturing the dynamics in question. Intuitively, parts of an image serve as “candidates” that may have varying importance at different time when parsing a question sentence. Recent study of image captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, a closely related research topic, suggests that visual attention mechanism is very important in generating good descriptions. Obviously, this idea will also improve the accuracy in question answering.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Going deeper, this candidacy is closely related to the concept of semantic “facts” in reasoning. For example, one often begins to dynamically search useful local visual evidences at the same time when (s)he reads words. The use of facts has been explored in the natural language processing recently <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, but this useful concept cannot be explored without local visual information in computer vision.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">While the definition of “visual facts” is still elusive, we can approach the problem through modeling interactions between vision and language. This “sensory interaction” plays a phenomenal role in the information processing and reasoning. It has a significant meaning in memory study as well. Eichenbaum and Cohen argued that part of the human memory needs to be modeled as a form of relationship between spatial, sensory and temporal information <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">Specifically, our method traverses the words in a question sequentially, and explicitly fuses the linguistic and the ones available at local patches to episodes. An attention mechanism is used to re-weight the importance of the regions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.
The fused information is fed to a dynamic network to generate episodes.
We then feed the episodes to a standard question answering module together with the contextual visual information and linguistic information.</p>
</div>
<div id="S1.p9" class="ltx_para">
<p id="S1.p9.1" class="ltx_p">The use of local features inevitably leads to the quest about region selection.
In principle, the regions can be 1) patches generated by object proposals, such as those obtained by edgebox <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> and faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, and 2) overlapping patches that cover most important contents in image. In this paper, we choose the latter and use the features of the last convolutional layer in the CNNs.</p>
</div>
<div id="S1.p10" class="ltx_para">
<p id="S1.p10.1" class="ltx_p">Our experiments on two latest public datasets suggest that our method outperforms the other state of the art methods. We tested on the DAQUAR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and MSCOCO-VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Notably, on the DAQUAR dataset we advanced the state of the art by 6<math id="S1.p10.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S1.p10.1.m1.1a"><mo id="S1.p10.1.m1.1.1" xref="S1.p10.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S1.p10.1.m1.1b"><csymbol cd="latexml" id="S1.p10.1.m1.1.1.cmml" xref="S1.p10.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.p10.1.m1.1c">\%</annotation></semantics></math>.
We also compared a few variants of our method and demonstrated the usefulness of the Compositional Memory for VQA.
We further verified our idea on the latest MSCOCO-VQA dataset.</p>
</div>
<div id="S1.p11" class="ltx_para">
<p id="S1.p11.1" class="ltx_p">The main contributions of the paper are:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We present an end-to-end approach that explores the local fine grained visual information for VQA tasks,</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We develop a Compositional Memory that explicitly models the interactions of vision and language,</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Our method has a superior performance and it outperforms the state of the art methods.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS0.SSS0.P0.SPx1" class="ltx_subparagraph">
<h5 class="ltx_title ltx_title_subparagraph">CNN, RNN, and LSTM</h5>

<div id="S2.SS0.SSS0.P0.SPx1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.P0.SPx1.p1.1" class="ltx_p">Recently, deep learning has achieved great success on many computer vision tasks. For example, CNN has set records on standard object recognition benchmarks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. With a deep structure, CNN can effectively learn complicated mappings from raw images to the target, which requires less domain knowledge compared to handcrafted features and shallow learning frameworks.</p>
</div>
<div id="S2.SS0.SSS0.P0.SPx1.p2" class="ltx_para">
<p id="S2.SS0.SSS0.P0.SPx1.p2.1" class="ltx_p">Recurrent Neural Networks (RNN) have been used for modeling temporal sequences and gained attention in speech recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, machine translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, image captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. The recurrent connections are feedback loops in the unfolded network, and because of these connections, RNNs are suitable for modeling time series with strong nonlinear dynamics and long time correlations. The traditional RNN is hard to train due to the vanishing gradient problem, <span id="S2.SS0.SSS0.P0.SPx1.p2.1.1" class="ltx_text ltx_font_italic">i.e.</span> the weight updates computed via error backpropagation through time may become very small.</p>
</div>
<div id="S2.SS0.SSS0.P0.SPx1.p3" class="ltx_para">
<p id="S2.SS0.SSS0.P0.SPx1.p3.1" class="ltx_p">Long Short Term Memory model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> has been proposed as a solution to overcome these problems. The LSTM architecture uses memory cells with gated access to store and output information, which alleviates the vanishing gradient problem in backpropagation over multiple time steps. Specifically, in addition to the hidden state, the LSTM also includes an input gate, a forget gate, an output gate, and the memory cell.
In this architecture, input gate and forget gate are sigmoidal gating functions, and these two terms learn to control the portions of the current input and the previous memory that the LSTM takes into consideration for overwriting the previous state. Meanwhile, the output gate controls how much of the memory should be transferred to the hidden state. These mechanisms allow LSTM networks to learn temporal dynamics.</p>
</div>
</section>
<section id="S2.SS0.SSS0.P0.SPx2" class="ltx_subparagraph">
<h5 class="ltx_title ltx_title_subparagraph">Language and vision</h5>

<div id="S2.SS0.SSS0.P0.SPx2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.P0.SPx2.p1.1" class="ltx_p">The effort of combining language and vision attracts a lot of attention recently.
Image captioning and VQA are two most intriguing problems.</p>
</div>
<div id="S2.SS0.SSS0.P0.SPx2.p2" class="ltx_para">
<p id="S2.SS0.SSS0.P0.SPx2.p2.1" class="ltx_p">Question answering (QA) is a classical problem in natural language processing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. When images are involved, the goal of VQA is to infer the answer of a question directly from the image <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Multiple questions and answers can be associated to the same image during training.</p>
</div>
<div id="S2.SS0.SSS0.P0.SPx2.p3" class="ltx_para">
<p id="S2.SS0.SSS0.P0.SPx2.p3.1" class="ltx_p">It has been shown that VQA can borrow the idea from image captioning.
Being a related area, image captioning also uses RNN for sentence generation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.
Attention mechanism is recently adopted in image captioning and proves to be a useful component <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.</p>
</div>
</section>
<section id="S2.SS0.SSS0.P0.SPx3" class="ltx_subparagraph">
<h5 class="ltx_title ltx_title_subparagraph">LSTM for VQA</h5>

<div id="S2.SS0.SSS0.P0.SPx3.p1" class="ltx_para">
<p id="S2.SS0.SSS0.P0.SPx3.p1.1" class="ltx_p">Because a VQA system needs to process language and visual information simultaneously, most recent work adopted the LSTM in their approaches.
A typical LSTM-VQA uses holistic image features extracted by CNNs as “visual words”, as shown in Figure <a href="#S2.F1" title="Figure 1 ‣ LSTM for VQA ‣ 2 Related Work ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
The visual word features are used either as the first or at the end of question sequence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> or they are concatenated together with question word vectors into a LSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> .</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/1511.05676/assets/basiclstm-vqa.jpg" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="255" height="68" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Classical LSTM-VQA model.</figcaption>
</figure>
<div id="S2.SS0.SSS0.P0.SPx3.p2" class="ltx_para">
<p id="S2.SS0.SSS0.P0.SPx3.p2.1" class="ltx_p">This LSTM-VQA framework is straightforward and useful.
However, treating the feature interaction as feature vector concatenation lacks the capability that explicitly extracts finer-grained information. As we discussed before, details of facts may be neglected if global visual features are used. This leads to the quest for more effective information fusion model for language and image in VQA problems.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Our Approach</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We present our approach in this section. First, we present our model overview. Then, we discuss the technical details and explain the training process.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Our End-to-End VQA model</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Compared to the basic LSTM approach for VQA in Figure <a href="#S2.F1" title="Figure 1 ‣ LSTM for VQA ‣ 2 Related Work ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, We made two major improvements of the model.
The diagram of the network is shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.1 Our End-to-End VQA model ‣ 3 Our Approach ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/1511.05676/assets/dynamicmemorynetwork.jpg" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="269" height="105" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Proposed VQA network. Please see Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1.1 Compositional Memory ‣ 3.1 Our End-to-End VQA model ‣ 3 Our Approach ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> for the description of the Compositional Memory block</figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">The first, and the most important addition, is a Compositional Memory.
It reasons over those input features to produce an image-level representation for answer module.
It reflects an experience over image contents.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">The second addition is the LSTM module for parsing (factorizing) the question.
It provides input for both the Compositional Memory and the question answering LSTM.
In the experiment we will show the importance of this module for the VQA tasks.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p">In part, this implementation is aligned with the findings in cognitive neuroscience.
It is well known that semantic (<span id="S3.SS1.p4.1.1" class="ltx_text ltx_font_italic">e.g.</span>, visual features and classifiers) and episodic memory (<span id="S3.SS1.p4.1.2" class="ltx_text ltx_font_italic">e.g.</span>, temporal questioning sentence) together make up the declarative memory of human beings, and the interactions among them become the key in representation and reasoning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.
Our model captures this interaction naturally.</p>
</div>
<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Compositional Memory</h4>

<figure id="S3.F3" class="ltx_figure"><img src="/html/1511.05676/assets/compositelstmunit.jpg" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="269" height="135" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Diagram of Compositional Memory.</figcaption>
</figure>
<figure id="S3.F4" class="ltx_figure"><img src="/html/1511.05676/assets/unfoldednetwork.jpg" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="672" height="280" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Unfolding our end-to-end VQA model. CM: Compositional Memory.</figcaption>
</figure>
<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.1" class="ltx_p">We present the details of our Compositional Memory in this section.
This unit consists of a number of Region-LSTM and <math id="S3.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS1.SSS1.p1.1.m1.1a"><mi id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.1b"><ci id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.1c">\alpha</annotation></semantics></math> gates (Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1.1 Compositional Memory ‣ 3.1 Our End-to-End VQA model ‣ 3 Our Approach ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
All these Region-LSTM share the same set of parameters, and their results are combined to generate an episode at each time step.</p>
</div>
<div id="S3.SS1.SSS1.p2" class="ltx_para">
<p id="S3.SS1.SSS1.p2.7" class="ltx_p">The region-LSTMs are mainly in charge of processing input image region contents in parallel. It dynamically generates language-embedded visual information for each region, conditioned on previous episodes, local visual feature, and current question word.
The state, gates and cells of of each Region-LSTM are updated as follows:</p>
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\displaystyle i_{t}^{k}=\sigma(W_{qi}q_{t}+W_{hi}h_{t-1}+W_{xi}X_{k}+b_{i})" display="inline"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><msubsup id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.3.2.2" xref="S3.E1.m1.1.1.3.2.2.cmml">i</mi><mi id="S3.E1.m1.1.1.3.2.3" xref="S3.E1.m1.1.1.3.2.3.cmml">t</mi><mi id="S3.E1.m1.1.1.3.3" xref="S3.E1.m1.1.1.3.3.cmml">k</mi></msubsup><mo id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.3.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.2.1" xref="S3.E1.m1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E1.m1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.2.3.2.cmml">q</mi><mi id="S3.E1.m1.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.3.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E1.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.3.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E1.m1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.3.2.cmml">h</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.3.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1.3.3.3.1" xref="S3.E1.m1.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.E1.m1.1.1.1.1.1.1.3.3.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1a" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.1.1.4.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.4.2" xref="S3.E1.m1.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.4.2.2" xref="S3.E1.m1.1.1.1.1.1.1.4.2.2.cmml">W</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.4.2.3" xref="S3.E1.m1.1.1.1.1.1.1.4.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.4.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.4.2.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.4.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E1.m1.1.1.1.1.1.1.4.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.4.2.3.3.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.4.1" xref="S3.E1.m1.1.1.1.1.1.1.4.1.cmml">​</mo><msub id="S3.E1.m1.1.1.1.1.1.1.4.3" xref="S3.E1.m1.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.4.3.2" xref="S3.E1.m1.1.1.1.1.1.1.4.3.2.cmml">X</mi><mi id="S3.E1.m1.1.1.1.1.1.1.4.3.3" xref="S3.E1.m1.1.1.1.1.1.1.4.3.3.cmml">k</mi></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1b" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E1.m1.1.1.1.1.1.1.5" xref="S3.E1.m1.1.1.1.1.1.1.5.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.5.2" xref="S3.E1.m1.1.1.1.1.1.1.5.2.cmml">b</mi><mi id="S3.E1.m1.1.1.1.1.1.1.5.3" xref="S3.E1.m1.1.1.1.1.1.1.5.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><eq id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"></eq><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3">superscript</csymbol><apply id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.3.2.2">𝑖</ci><ci id="S3.E1.m1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E1.m1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.3.3">𝑘</ci></apply><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><times id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3">𝜎</ci><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><plus id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2"><times id="S3.E1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.1"></times><apply id="S3.E1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2">𝑊</ci><apply id="S3.E1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3"><times id="S3.E1.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.2">𝑞</ci><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.3.2">𝑞</ci><ci id="S3.E1.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><times id="S3.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1"></times><apply id="S3.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.2">𝑊</ci><apply id="S3.E1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3"><times id="S3.E1.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.2">ℎ</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3.2">ℎ</ci><apply id="S3.E1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3.3"><minus id="S3.E1.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S3.E1.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4"><times id="S3.E1.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.1"></times><apply id="S3.E1.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.2.2">𝑊</ci><apply id="S3.E1.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.2.3"><times id="S3.E1.m1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.2.3.1"></times><ci id="S3.E1.m1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.2.3.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.1.1.4.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.2.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.3.2">𝑋</ci><ci id="S3.E1.m1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.3.3">𝑘</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.5.cmml" xref="S3.E1.m1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.5.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.5.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.5.2">𝑏</ci><ci id="S3.E1.m1.1.1.1.1.1.1.5.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.5.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle i_{t}^{k}=\sigma(W_{qi}q_{t}+W_{hi}h_{t-1}+W_{xi}X_{k}+b_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle f_{t}^{k}=\sigma(W_{qf}q_{t}+W_{hf}h_{t-1}+W_{xf}X_{k}+b_{f})" display="inline"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><msubsup id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.3.2.2" xref="S3.E2.m1.1.1.3.2.2.cmml">f</mi><mi id="S3.E2.m1.1.1.3.2.3" xref="S3.E2.m1.1.1.3.2.3.cmml">t</mi><mi id="S3.E2.m1.1.1.3.3" xref="S3.E2.m1.1.1.3.3.cmml">k</mi></msubsup><mo id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.2.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.2.2.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E2.m1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.2.2.3.3.cmml">f</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E2.m1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.2.3.2.cmml">q</mi><mi id="S3.E2.m1.1.1.1.1.1.1.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.3.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.3.2.3.1" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3.3.cmml">f</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E2.m1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.3.3.2.cmml">h</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.3.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S3.E2.m1.1.1.1.1.1.1.3.3.3.1" xref="S3.E2.m1.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.E2.m1.1.1.1.1.1.1.3.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1a" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.1.1.4.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.4.2" xref="S3.E2.m1.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.4.2.2" xref="S3.E2.m1.1.1.1.1.1.1.4.2.2.cmml">W</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.4.2.3" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.4.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.4.2.3.1" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.4.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.3.cmml">f</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.4.1" xref="S3.E2.m1.1.1.1.1.1.1.4.1.cmml">​</mo><msub id="S3.E2.m1.1.1.1.1.1.1.4.3" xref="S3.E2.m1.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.4.3.2" xref="S3.E2.m1.1.1.1.1.1.1.4.3.2.cmml">X</mi><mi id="S3.E2.m1.1.1.1.1.1.1.4.3.3" xref="S3.E2.m1.1.1.1.1.1.1.4.3.3.cmml">k</mi></msub></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1b" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E2.m1.1.1.1.1.1.1.5" xref="S3.E2.m1.1.1.1.1.1.1.5.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.5.2" xref="S3.E2.m1.1.1.1.1.1.1.5.2.cmml">b</mi><mi id="S3.E2.m1.1.1.1.1.1.1.5.3" xref="S3.E2.m1.1.1.1.1.1.1.5.3.cmml">f</mi></msub></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><eq id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2"></eq><apply id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.3">superscript</csymbol><apply id="S3.E2.m1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.3.2.2">𝑓</ci><ci id="S3.E2.m1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E2.m1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.3.3">𝑘</ci></apply><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><times id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3">𝜎</ci><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><plus id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2"><times id="S3.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.1"></times><apply id="S3.E2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2.2">𝑊</ci><apply id="S3.E2.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2.3"><times id="S3.E2.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2.3.2">𝑞</ci><ci id="S3.E2.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2.3.3">𝑓</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.3.2">𝑞</ci><ci id="S3.E2.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3"><times id="S3.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.1"></times><apply id="S3.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.2">𝑊</ci><apply id="S3.E2.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3"><times id="S3.E2.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3.2">ℎ</ci><ci id="S3.E2.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2.3.3">𝑓</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.3.2">ℎ</ci><apply id="S3.E2.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.3.3"><minus id="S3.E2.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S3.E2.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4"><times id="S3.E2.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.1"></times><apply id="S3.E2.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2.2">𝑊</ci><apply id="S3.E2.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3"><times id="S3.E2.m1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.2">𝑥</ci><ci id="S3.E2.m1.1.1.1.1.1.1.4.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.2.3.3">𝑓</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.3.2">𝑋</ci><ci id="S3.E2.m1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.4.3.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.5.cmml" xref="S3.E2.m1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.5.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.5.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.5.2">𝑏</ci><ci id="S3.E2.m1.1.1.1.1.1.1.5.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.5.3">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle f_{t}^{k}=\sigma(W_{qf}q_{t}+W_{hf}h_{t-1}+W_{xf}X_{k}+b_{f})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\displaystyle o_{t}^{k}=\sigma(W_{qo}q_{t}+W_{ho}h_{t-1}+W_{xo}X_{k}+b_{o})" display="inline"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msubsup id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.3.2.2" xref="S3.E3.m1.1.1.3.2.2.cmml">o</mi><mi id="S3.E3.m1.1.1.3.2.3" xref="S3.E3.m1.1.1.3.2.3.cmml">t</mi><mi id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml">k</mi></msubsup><mo id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.3.cmml">o</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.2.1" xref="S3.E3.m1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E3.m1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2.cmml">q</mi><mi id="S3.E3.m1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.3.2.3.1" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.3.cmml">o</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E3.m1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.3.2.cmml">h</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.3.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.3.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S3.E3.m1.1.1.1.1.1.1.3.3.3.1" xref="S3.E3.m1.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.E3.m1.1.1.1.1.1.1.3.3.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1a" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.4" xref="S3.E3.m1.1.1.1.1.1.1.4.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.4.2" xref="S3.E3.m1.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.4.2.2" xref="S3.E3.m1.1.1.1.1.1.1.4.2.2.cmml">W</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.4.2.3" xref="S3.E3.m1.1.1.1.1.1.1.4.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.4.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.4.2.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.4.2.3.1" xref="S3.E3.m1.1.1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.1.1.1.4.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.4.2.3.3.cmml">o</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.4.1" xref="S3.E3.m1.1.1.1.1.1.1.4.1.cmml">​</mo><msub id="S3.E3.m1.1.1.1.1.1.1.4.3" xref="S3.E3.m1.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.4.3.2" xref="S3.E3.m1.1.1.1.1.1.1.4.3.2.cmml">X</mi><mi id="S3.E3.m1.1.1.1.1.1.1.4.3.3" xref="S3.E3.m1.1.1.1.1.1.1.4.3.3.cmml">k</mi></msub></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1b" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E3.m1.1.1.1.1.1.1.5" xref="S3.E3.m1.1.1.1.1.1.1.5.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.5.2" xref="S3.E3.m1.1.1.1.1.1.1.5.2.cmml">b</mi><mi id="S3.E3.m1.1.1.1.1.1.1.5.3" xref="S3.E3.m1.1.1.1.1.1.1.5.3.cmml">o</mi></msub></mrow><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"></eq><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2">𝑜</ci><ci id="S3.E3.m1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3">𝑘</ci></apply><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><times id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3">𝜎</ci><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><plus id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><times id="S3.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.1"></times><apply id="S3.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2">𝑊</ci><apply id="S3.E3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3"><times id="S3.E3.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.2">𝑞</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.3">𝑜</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2">𝑞</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><times id="S3.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1"></times><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2">𝑊</ci><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3"><times id="S3.E3.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.2">ℎ</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.3">𝑜</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3.2">ℎ</ci><apply id="S3.E3.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3.3"><minus id="S3.E3.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S3.E3.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4"><times id="S3.E3.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.1"></times><apply id="S3.E3.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.2.2">𝑊</ci><apply id="S3.E3.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.2.3"><times id="S3.E3.m1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.2.3.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.2.3.2">𝑥</ci><ci id="S3.E3.m1.1.1.1.1.1.1.4.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.2.3.3">𝑜</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.3.2">𝑋</ci><ci id="S3.E3.m1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.4.3.3">𝑘</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.5.cmml" xref="S3.E3.m1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.5.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.5.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.5.2">𝑏</ci><ci id="S3.E3.m1.1.1.1.1.1.1.5.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.5.3">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle o_{t}^{k}=\sigma(W_{qo}q_{t}+W_{ho}h_{t-1}+W_{xo}X_{k}+b_{o})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4.m1.2" class="ltx_Math" alttext="\displaystyle g_{t}^{k}=\tanh(W_{qg}q_{t}+W_{hg}h_{t-1}+W_{xg}X_{k}+b_{g})" display="inline"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml"><msubsup id="S3.E4.m1.2.2.3" xref="S3.E4.m1.2.2.3.cmml"><mi id="S3.E4.m1.2.2.3.2.2" xref="S3.E4.m1.2.2.3.2.2.cmml">g</mi><mi id="S3.E4.m1.2.2.3.2.3" xref="S3.E4.m1.2.2.3.2.3.cmml">t</mi><mi id="S3.E4.m1.2.2.3.3" xref="S3.E4.m1.2.2.3.3.cmml">k</mi></msubsup><mo id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.2.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.2.cmml"><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">tanh</mi><mo id="S3.E4.m1.2.2.1.1a" xref="S3.E4.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.2" xref="S3.E4.m1.2.2.1.2.cmml">(</mo><mrow id="S3.E4.m1.2.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.2.cmml"><msub id="S3.E4.m1.2.2.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.1.1.2.2.2.cmml">W</mi><mrow id="S3.E4.m1.2.2.1.1.1.1.2.2.3" xref="S3.E4.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.2.2.3.2" xref="S3.E4.m1.2.2.1.1.1.1.2.2.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.2.2.3.1" xref="S3.E4.m1.2.2.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.1.1.1.1.2.2.3.3" xref="S3.E4.m1.2.2.1.1.1.1.2.2.3.3.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.2.1" xref="S3.E4.m1.2.2.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E4.m1.2.2.1.1.1.1.2.3" xref="S3.E4.m1.2.2.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.2.3.2" xref="S3.E4.m1.2.2.1.1.1.1.2.3.2.cmml">q</mi><mi id="S3.E4.m1.2.2.1.1.1.1.2.3.3" xref="S3.E4.m1.2.2.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E4.m1.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.cmml">+</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.3.cmml"><msub id="S3.E4.m1.2.2.1.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.1.1.3.2.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.3.2.2" xref="S3.E4.m1.2.2.1.1.1.1.3.2.2.cmml">W</mi><mrow id="S3.E4.m1.2.2.1.1.1.1.3.2.3" xref="S3.E4.m1.2.2.1.1.1.1.3.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.3.2.3.2" xref="S3.E4.m1.2.2.1.1.1.1.3.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.3.2.3.1" xref="S3.E4.m1.2.2.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.1.1.1.1.3.2.3.3" xref="S3.E4.m1.2.2.1.1.1.1.3.2.3.3.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.3.1" xref="S3.E4.m1.2.2.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E4.m1.2.2.1.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.3.3.2" xref="S3.E4.m1.2.2.1.1.1.1.3.3.2.cmml">h</mi><mrow id="S3.E4.m1.2.2.1.1.1.1.3.3.3" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.3.3.3.2" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S3.E4.m1.2.2.1.1.1.1.3.3.3.1" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.E4.m1.2.2.1.1.1.1.3.3.3.3" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E4.m1.2.2.1.1.1.1.1a" xref="S3.E4.m1.2.2.1.1.1.1.1.cmml">+</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.4" xref="S3.E4.m1.2.2.1.1.1.1.4.cmml"><msub id="S3.E4.m1.2.2.1.1.1.1.4.2" xref="S3.E4.m1.2.2.1.1.1.1.4.2.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.4.2.2" xref="S3.E4.m1.2.2.1.1.1.1.4.2.2.cmml">W</mi><mrow id="S3.E4.m1.2.2.1.1.1.1.4.2.3" xref="S3.E4.m1.2.2.1.1.1.1.4.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.4.2.3.2" xref="S3.E4.m1.2.2.1.1.1.1.4.2.3.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.4.2.3.1" xref="S3.E4.m1.2.2.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.1.1.1.1.4.2.3.3" xref="S3.E4.m1.2.2.1.1.1.1.4.2.3.3.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.4.1" xref="S3.E4.m1.2.2.1.1.1.1.4.1.cmml">​</mo><msub id="S3.E4.m1.2.2.1.1.1.1.4.3" xref="S3.E4.m1.2.2.1.1.1.1.4.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.4.3.2" xref="S3.E4.m1.2.2.1.1.1.1.4.3.2.cmml">X</mi><mi id="S3.E4.m1.2.2.1.1.1.1.4.3.3" xref="S3.E4.m1.2.2.1.1.1.1.4.3.3.cmml">k</mi></msub></mrow><mo id="S3.E4.m1.2.2.1.1.1.1.1b" xref="S3.E4.m1.2.2.1.1.1.1.1.cmml">+</mo><msub id="S3.E4.m1.2.2.1.1.1.1.5" xref="S3.E4.m1.2.2.1.1.1.1.5.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.5.2" xref="S3.E4.m1.2.2.1.1.1.1.5.2.cmml">b</mi><mi id="S3.E4.m1.2.2.1.1.1.1.5.3" xref="S3.E4.m1.2.2.1.1.1.1.5.3.cmml">g</mi></msub></mrow><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"><eq id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2.2"></eq><apply id="S3.E4.m1.2.2.3.cmml" xref="S3.E4.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.3.1.cmml" xref="S3.E4.m1.2.2.3">superscript</csymbol><apply id="S3.E4.m1.2.2.3.2.cmml" xref="S3.E4.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.3.2.1.cmml" xref="S3.E4.m1.2.2.3">subscript</csymbol><ci id="S3.E4.m1.2.2.3.2.2.cmml" xref="S3.E4.m1.2.2.3.2.2">𝑔</ci><ci id="S3.E4.m1.2.2.3.2.3.cmml" xref="S3.E4.m1.2.2.3.2.3">𝑡</ci></apply><ci id="S3.E4.m1.2.2.3.3.cmml" xref="S3.E4.m1.2.2.3.3">𝑘</ci></apply><apply id="S3.E4.m1.2.2.1.2.cmml" xref="S3.E4.m1.2.2.1.1"><tanh id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"></tanh><apply id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1"><plus id="S3.E4.m1.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1"></plus><apply id="S3.E4.m1.2.2.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2"><times id="S3.E4.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.1"></times><apply id="S3.E4.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.2.2">𝑊</ci><apply id="S3.E4.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.2.3"><times id="S3.E4.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.2.3.1"></times><ci id="S3.E4.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.2.3.2">𝑞</ci><ci id="S3.E4.m1.2.2.1.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.2.3.3">𝑔</ci></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.3.2">𝑞</ci><ci id="S3.E4.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3"><times id="S3.E4.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.1"></times><apply id="S3.E4.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.2.2">𝑊</ci><apply id="S3.E4.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.2.3"><times id="S3.E4.m1.2.2.1.1.1.1.3.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.2.3.1"></times><ci id="S3.E4.m1.2.2.1.1.1.1.3.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.2.3.2">ℎ</ci><ci id="S3.E4.m1.2.2.1.1.1.1.3.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.2.3.3">𝑔</ci></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3.2">ℎ</ci><apply id="S3.E4.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3"><minus id="S3.E4.m1.2.2.1.1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3.1"></minus><ci id="S3.E4.m1.2.2.1.1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S3.E4.m1.2.2.1.1.1.1.3.3.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4"><times id="S3.E4.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.1"></times><apply id="S3.E4.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.4.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.4.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.2.2">𝑊</ci><apply id="S3.E4.m1.2.2.1.1.1.1.4.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.2.3"><times id="S3.E4.m1.2.2.1.1.1.1.4.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.2.3.1"></times><ci id="S3.E4.m1.2.2.1.1.1.1.4.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.2.3.2">𝑥</ci><ci id="S3.E4.m1.2.2.1.1.1.1.4.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.2.3.3">𝑔</ci></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.1.4.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.4.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.4.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.3.2">𝑋</ci><ci id="S3.E4.m1.2.2.1.1.1.1.4.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.3.3">𝑘</ci></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.1.5.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.5.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.5.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.2">𝑏</ci><ci id="S3.E4.m1.2.2.1.1.1.1.5.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.3">𝑔</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\displaystyle g_{t}^{k}=\tanh(W_{qg}q_{t}+W_{hg}h_{t-1}+W_{xg}X_{k}+b_{g})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\displaystyle c_{t}^{k}=f_{t}^{k}\odot c_{t-1}^{k}+i_{t}^{k}\odot g_{t}^{k}" display="inline"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><msubsup id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml"><mi id="S3.E5.m1.1.1.2.2.2" xref="S3.E5.m1.1.1.2.2.2.cmml">c</mi><mi id="S3.E5.m1.1.1.2.2.3" xref="S3.E5.m1.1.1.2.2.3.cmml">t</mi><mi id="S3.E5.m1.1.1.2.3" xref="S3.E5.m1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mrow id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml"><msubsup id="S3.E5.m1.1.1.3.2.2" xref="S3.E5.m1.1.1.3.2.2.cmml"><mi id="S3.E5.m1.1.1.3.2.2.2.2" xref="S3.E5.m1.1.1.3.2.2.2.2.cmml">f</mi><mi id="S3.E5.m1.1.1.3.2.2.2.3" xref="S3.E5.m1.1.1.3.2.2.2.3.cmml">t</mi><mi id="S3.E5.m1.1.1.3.2.2.3" xref="S3.E5.m1.1.1.3.2.2.3.cmml">k</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.1.1.3.2.1" xref="S3.E5.m1.1.1.3.2.1.cmml">⊙</mo><msubsup id="S3.E5.m1.1.1.3.2.3" xref="S3.E5.m1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.1.1.3.2.3.2.2" xref="S3.E5.m1.1.1.3.2.3.2.2.cmml">c</mi><mrow id="S3.E5.m1.1.1.3.2.3.2.3" xref="S3.E5.m1.1.1.3.2.3.2.3.cmml"><mi id="S3.E5.m1.1.1.3.2.3.2.3.2" xref="S3.E5.m1.1.1.3.2.3.2.3.2.cmml">t</mi><mo id="S3.E5.m1.1.1.3.2.3.2.3.1" xref="S3.E5.m1.1.1.3.2.3.2.3.1.cmml">−</mo><mn id="S3.E5.m1.1.1.3.2.3.2.3.3" xref="S3.E5.m1.1.1.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow><mo id="S3.E5.m1.1.1.3.1" xref="S3.E5.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><msubsup id="S3.E5.m1.1.1.3.3.2" xref="S3.E5.m1.1.1.3.3.2.cmml"><mi id="S3.E5.m1.1.1.3.3.2.2.2" xref="S3.E5.m1.1.1.3.3.2.2.2.cmml">i</mi><mi id="S3.E5.m1.1.1.3.3.2.2.3" xref="S3.E5.m1.1.1.3.3.2.2.3.cmml">t</mi><mi id="S3.E5.m1.1.1.3.3.2.3" xref="S3.E5.m1.1.1.3.3.2.3.cmml">k</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.1.1.3.3.1" xref="S3.E5.m1.1.1.3.3.1.cmml">⊙</mo><msubsup id="S3.E5.m1.1.1.3.3.3" xref="S3.E5.m1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.1.1.3.3.3.2.2" xref="S3.E5.m1.1.1.3.3.3.2.2.cmml">g</mi><mi id="S3.E5.m1.1.1.3.3.3.2.3" xref="S3.E5.m1.1.1.3.3.3.2.3.cmml">t</mi><mi id="S3.E5.m1.1.1.3.3.3.3" xref="S3.E5.m1.1.1.3.3.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"></eq><apply id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.2">superscript</csymbol><apply id="S3.E5.m1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.2.2.2">𝑐</ci><ci id="S3.E5.m1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.2.2.3">𝑡</ci></apply><ci id="S3.E5.m1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><plus id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3.1"></plus><apply id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2"><csymbol cd="latexml" id="S3.E5.m1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.3.2.1">direct-product</csymbol><apply id="S3.E5.m1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.1.1.3.2.2">superscript</csymbol><apply id="S3.E5.m1.1.1.3.2.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.2.2.1.cmml" xref="S3.E5.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.2.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2.2.2">𝑓</ci><ci id="S3.E5.m1.1.1.3.2.2.2.3.cmml" xref="S3.E5.m1.1.1.3.2.2.2.3">𝑡</ci></apply><ci id="S3.E5.m1.1.1.3.2.2.3.cmml" xref="S3.E5.m1.1.1.3.2.2.3">𝑘</ci></apply><apply id="S3.E5.m1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.3.2.3">superscript</csymbol><apply id="S3.E5.m1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.3.2.1.cmml" xref="S3.E5.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.3.2.2.cmml" xref="S3.E5.m1.1.1.3.2.3.2.2">𝑐</ci><apply id="S3.E5.m1.1.1.3.2.3.2.3.cmml" xref="S3.E5.m1.1.1.3.2.3.2.3"><minus id="S3.E5.m1.1.1.3.2.3.2.3.1.cmml" xref="S3.E5.m1.1.1.3.2.3.2.3.1"></minus><ci id="S3.E5.m1.1.1.3.2.3.2.3.2.cmml" xref="S3.E5.m1.1.1.3.2.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E5.m1.1.1.3.2.3.2.3.3.cmml" xref="S3.E5.m1.1.1.3.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.1.1.3.2.3.3">𝑘</ci></apply></apply><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><csymbol cd="latexml" id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3.1">direct-product</csymbol><apply id="S3.E5.m1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.1.1.3.3.2">superscript</csymbol><apply id="S3.E5.m1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.2.2.1.cmml" xref="S3.E5.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.3.3.2.2.2.cmml" xref="S3.E5.m1.1.1.3.3.2.2.2">𝑖</ci><ci id="S3.E5.m1.1.1.3.3.2.2.3.cmml" xref="S3.E5.m1.1.1.3.3.2.2.3">𝑡</ci></apply><ci id="S3.E5.m1.1.1.3.3.2.3.cmml" xref="S3.E5.m1.1.1.3.3.2.3">𝑘</ci></apply><apply id="S3.E5.m1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3.3">superscript</csymbol><apply id="S3.E5.m1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.3.2.1.cmml" xref="S3.E5.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.3.3.2.2.cmml" xref="S3.E5.m1.1.1.3.3.3.2.2">𝑔</ci><ci id="S3.E5.m1.1.1.3.3.3.2.3.cmml" xref="S3.E5.m1.1.1.3.3.3.2.3">𝑡</ci></apply><ci id="S3.E5.m1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle c_{t}^{k}=f_{t}^{k}\odot c_{t-1}^{k}+i_{t}^{k}\odot g_{t}^{k}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6.m1.2" class="ltx_Math" alttext="\displaystyle m_{t}^{k}=o_{t}^{k}\odot\tanh(c_{t}^{k})" display="inline"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml"><msubsup id="S3.E6.m1.2.2.3" xref="S3.E6.m1.2.2.3.cmml"><mi id="S3.E6.m1.2.2.3.2.2" xref="S3.E6.m1.2.2.3.2.2.cmml">m</mi><mi id="S3.E6.m1.2.2.3.2.3" xref="S3.E6.m1.2.2.3.2.3.cmml">t</mi><mi id="S3.E6.m1.2.2.3.3" xref="S3.E6.m1.2.2.3.3.cmml">k</mi></msubsup><mo id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml">=</mo><mrow id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.cmml"><msubsup id="S3.E6.m1.2.2.1.3" xref="S3.E6.m1.2.2.1.3.cmml"><mi id="S3.E6.m1.2.2.1.3.2.2" xref="S3.E6.m1.2.2.1.3.2.2.cmml">o</mi><mi id="S3.E6.m1.2.2.1.3.2.3" xref="S3.E6.m1.2.2.1.3.2.3.cmml">t</mi><mi id="S3.E6.m1.2.2.1.3.3" xref="S3.E6.m1.2.2.1.3.3.cmml">k</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.2.2.1.2" xref="S3.E6.m1.2.2.1.2.cmml">⊙</mo><mrow id="S3.E6.m1.2.2.1.1.1" xref="S3.E6.m1.2.2.1.1.2.cmml"><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">tanh</mi><mo id="S3.E6.m1.2.2.1.1.1a" xref="S3.E6.m1.2.2.1.1.2.cmml">⁡</mo><mrow id="S3.E6.m1.2.2.1.1.1.1" xref="S3.E6.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.2.cmml">(</mo><msubsup id="S3.E6.m1.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.2" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2.cmml">c</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.2.3" xref="S3.E6.m1.2.2.1.1.1.1.1.2.3.cmml">t</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.2b"><apply id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2"><eq id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"></eq><apply id="S3.E6.m1.2.2.3.cmml" xref="S3.E6.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.3.1.cmml" xref="S3.E6.m1.2.2.3">superscript</csymbol><apply id="S3.E6.m1.2.2.3.2.cmml" xref="S3.E6.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.3.2.1.cmml" xref="S3.E6.m1.2.2.3">subscript</csymbol><ci id="S3.E6.m1.2.2.3.2.2.cmml" xref="S3.E6.m1.2.2.3.2.2">𝑚</ci><ci id="S3.E6.m1.2.2.3.2.3.cmml" xref="S3.E6.m1.2.2.3.2.3">𝑡</ci></apply><ci id="S3.E6.m1.2.2.3.3.cmml" xref="S3.E6.m1.2.2.3.3">𝑘</ci></apply><apply id="S3.E6.m1.2.2.1.cmml" xref="S3.E6.m1.2.2.1"><csymbol cd="latexml" id="S3.E6.m1.2.2.1.2.cmml" xref="S3.E6.m1.2.2.1.2">direct-product</csymbol><apply id="S3.E6.m1.2.2.1.3.cmml" xref="S3.E6.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.3.1.cmml" xref="S3.E6.m1.2.2.1.3">superscript</csymbol><apply id="S3.E6.m1.2.2.1.3.2.cmml" xref="S3.E6.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.3.2.1.cmml" xref="S3.E6.m1.2.2.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.3.2.2.cmml" xref="S3.E6.m1.2.2.1.3.2.2">𝑜</ci><ci id="S3.E6.m1.2.2.1.3.2.3.cmml" xref="S3.E6.m1.2.2.1.3.2.3">𝑡</ci></apply><ci id="S3.E6.m1.2.2.1.3.3.cmml" xref="S3.E6.m1.2.2.1.3.3">𝑘</ci></apply><apply id="S3.E6.m1.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1"><tanh id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"></tanh><apply id="S3.E6.m1.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.2">𝑐</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E6.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.2c">\displaystyle m_{t}^{k}=o_{t}^{k}\odot\tanh(c_{t}^{k})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p2.6" class="ltx_p">where the hidden state <math id="S3.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="h_{t}" display="inline"><semantics id="S3.SS1.SSS1.p2.1.m1.1a"><msub id="S3.SS1.SSS1.p2.1.m1.1.1" xref="S3.SS1.SSS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p2.1.m1.1.1.2" xref="S3.SS1.SSS1.p2.1.m1.1.1.2.cmml">h</mi><mi id="S3.SS1.SSS1.p2.1.m1.1.1.3" xref="S3.SS1.SSS1.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.1.m1.1b"><apply id="S3.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.2">ℎ</ci><ci id="S3.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.1.m1.1c">h_{t}</annotation></semantics></math> denotes an episode at every time step, <math id="S3.SS1.SSS1.p2.2.m2.1" class="ltx_Math" alttext="q_{t}" display="inline"><semantics id="S3.SS1.SSS1.p2.2.m2.1a"><msub id="S3.SS1.SSS1.p2.2.m2.1.1" xref="S3.SS1.SSS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.SSS1.p2.2.m2.1.1.2" xref="S3.SS1.SSS1.p2.2.m2.1.1.2.cmml">q</mi><mi id="S3.SS1.SSS1.p2.2.m2.1.1.3" xref="S3.SS1.SSS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.2.m2.1b"><apply id="S3.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.2">𝑞</ci><ci id="S3.SS1.SSS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.2.m2.1c">q_{t}</annotation></semantics></math> is the language information (<span id="S3.SS1.SSS1.p2.6.1" class="ltx_text ltx_font_italic">e.g.,</span> features generated by <span id="S3.SS1.SSS1.p2.6.2" class="ltx_text ltx_font_italic">word2vec</span>), and <math id="S3.SS1.SSS1.p2.3.m3.1" class="ltx_Math" alttext="X_{k}" display="inline"><semantics id="S3.SS1.SSS1.p2.3.m3.1a"><msub id="S3.SS1.SSS1.p2.3.m3.1.1" xref="S3.SS1.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.SSS1.p2.3.m3.1.1.2" xref="S3.SS1.SSS1.p2.3.m3.1.1.2.cmml">X</mi><mi id="S3.SS1.SSS1.p2.3.m3.1.1.3" xref="S3.SS1.SSS1.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.3.m3.1b"><apply id="S3.SS1.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.2">𝑋</ci><ci id="S3.SS1.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.3.m3.1c">X_{k}</annotation></semantics></math> is the <math id="S3.SS1.SSS1.p2.4.m4.1" class="ltx_Math" alttext="k^{th}" display="inline"><semantics id="S3.SS1.SSS1.p2.4.m4.1a"><msup id="S3.SS1.SSS1.p2.4.m4.1.1" xref="S3.SS1.SSS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.SSS1.p2.4.m4.1.1.2" xref="S3.SS1.SSS1.p2.4.m4.1.1.2.cmml">k</mi><mrow id="S3.SS1.SSS1.p2.4.m4.1.1.3" xref="S3.SS1.SSS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.SSS1.p2.4.m4.1.1.3.2" xref="S3.SS1.SSS1.p2.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p2.4.m4.1.1.3.1" xref="S3.SS1.SSS1.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p2.4.m4.1.1.3.3" xref="S3.SS1.SSS1.p2.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.4.m4.1b"><apply id="S3.SS1.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1.2">𝑘</ci><apply id="S3.SS1.SSS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1.3"><times id="S3.SS1.SSS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1.3.1"></times><ci id="S3.SS1.SSS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1.3.2">𝑡</ci><ci id="S3.SS1.SSS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS1.p2.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.4.m4.1c">k^{th}</annotation></semantics></math> regional CNN features.
<math id="S3.SS1.SSS1.p2.5.m5.1" class="ltx_Math" alttext="m_{t}" display="inline"><semantics id="S3.SS1.SSS1.p2.5.m5.1a"><msub id="S3.SS1.SSS1.p2.5.m5.1.1" xref="S3.SS1.SSS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.SSS1.p2.5.m5.1.1.2" xref="S3.SS1.SSS1.p2.5.m5.1.1.2.cmml">m</mi><mi id="S3.SS1.SSS1.p2.5.m5.1.1.3" xref="S3.SS1.SSS1.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.5.m5.1b"><apply id="S3.SS1.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.2">𝑚</ci><ci id="S3.SS1.SSS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.SSS1.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.5.m5.1c">m_{t}</annotation></semantics></math> is the output of region-LSTM <math id="S3.SS1.SSS1.p2.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.SSS1.p2.6.m6.1a"><mi id="S3.SS1.SSS1.p2.6.m6.1.1" xref="S3.SS1.SSS1.p2.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p2.6.m6.1b"><ci id="S3.SS1.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p2.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p2.6.m6.1c">t</annotation></semantics></math>.
Please note that the superscripts are omitted in the above notations for simplicity.</p>
</div>
<div id="S3.SS1.SSS1.p3" class="ltx_para">
<p id="S3.SS1.SSS1.p3.8" class="ltx_p">In Region-LSTM<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Please note that the diagram is not drawn for the purpose of simplicity.</span></span></span>, <math id="S3.SS1.SSS1.p3.1.m1.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S3.SS1.SSS1.p3.1.m1.1a"><msub id="S3.SS1.SSS1.p3.1.m1.1.1" xref="S3.SS1.SSS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p3.1.m1.1.1.2" xref="S3.SS1.SSS1.p3.1.m1.1.1.2.cmml">c</mi><mi id="S3.SS1.SSS1.p3.1.m1.1.1.3" xref="S3.SS1.SSS1.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.1.m1.1b"><apply id="S3.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p3.1.m1.1.1.2">𝑐</ci><ci id="S3.SS1.SSS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.1.m1.1c">c_{t}</annotation></semantics></math> denotes the memory cell, <math id="S3.SS1.SSS1.p3.2.m2.1" class="ltx_Math" alttext="g_{t}" display="inline"><semantics id="S3.SS1.SSS1.p3.2.m2.1a"><msub id="S3.SS1.SSS1.p3.2.m2.1.1" xref="S3.SS1.SSS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.SSS1.p3.2.m2.1.1.2" xref="S3.SS1.SSS1.p3.2.m2.1.1.2.cmml">g</mi><mi id="S3.SS1.SSS1.p3.2.m2.1.1.3" xref="S3.SS1.SSS1.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.2.m2.1b"><apply id="S3.SS1.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.2">𝑔</ci><ci id="S3.SS1.SSS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.2.m2.1c">g_{t}</annotation></semantics></math> denotes an input modulation gate.
<math id="S3.SS1.SSS1.p3.3.m3.1" class="ltx_Math" alttext="i_{t}" display="inline"><semantics id="S3.SS1.SSS1.p3.3.m3.1a"><msub id="S3.SS1.SSS1.p3.3.m3.1.1" xref="S3.SS1.SSS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.SSS1.p3.3.m3.1.1.2" xref="S3.SS1.SSS1.p3.3.m3.1.1.2.cmml">i</mi><mi id="S3.SS1.SSS1.p3.3.m3.1.1.3" xref="S3.SS1.SSS1.p3.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.3.m3.1b"><apply id="S3.SS1.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.2">𝑖</ci><ci id="S3.SS1.SSS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.3.m3.1c">i_{t}</annotation></semantics></math> and <math id="S3.SS1.SSS1.p3.4.m4.1" class="ltx_Math" alttext="f_{t}" display="inline"><semantics id="S3.SS1.SSS1.p3.4.m4.1a"><msub id="S3.SS1.SSS1.p3.4.m4.1.1" xref="S3.SS1.SSS1.p3.4.m4.1.1.cmml"><mi id="S3.SS1.SSS1.p3.4.m4.1.1.2" xref="S3.SS1.SSS1.p3.4.m4.1.1.2.cmml">f</mi><mi id="S3.SS1.SSS1.p3.4.m4.1.1.3" xref="S3.SS1.SSS1.p3.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.4.m4.1b"><apply id="S3.SS1.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.SSS1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.SSS1.p3.4.m4.1.1.2">𝑓</ci><ci id="S3.SS1.SSS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.SSS1.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.4.m4.1c">f_{t}</annotation></semantics></math> are input and forget gates, which control the portions of the current input and the previous memory that LSTM takes into consideration.
<math id="S3.SS1.SSS1.p3.5.m5.1" class="ltx_Math" alttext="o_{t}" display="inline"><semantics id="S3.SS1.SSS1.p3.5.m5.1a"><msub id="S3.SS1.SSS1.p3.5.m5.1.1" xref="S3.SS1.SSS1.p3.5.m5.1.1.cmml"><mi id="S3.SS1.SSS1.p3.5.m5.1.1.2" xref="S3.SS1.SSS1.p3.5.m5.1.1.2.cmml">o</mi><mi id="S3.SS1.SSS1.p3.5.m5.1.1.3" xref="S3.SS1.SSS1.p3.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.5.m5.1b"><apply id="S3.SS1.SSS1.p3.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p3.5.m5.1.1.2">𝑜</ci><ci id="S3.SS1.SSS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.SSS1.p3.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.5.m5.1c">o_{t}</annotation></semantics></math> is output gate that determines how much of the memory to transfer to the hidden state.
<math id="S3.SS1.SSS1.p3.6.m6.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS1.SSS1.p3.6.m6.1a"><mo id="S3.SS1.SSS1.p3.6.m6.1.1" xref="S3.SS1.SSS1.p3.6.m6.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.6.m6.1b"><csymbol cd="latexml" id="S3.SS1.SSS1.p3.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p3.6.m6.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.6.m6.1c">\odot</annotation></semantics></math> is the element-wise multiplication operation, and <math id="S3.SS1.SSS1.p3.7.m7.1" class="ltx_Math" alttext="\sigma()" display="inline"><semantics id="S3.SS1.SSS1.p3.7.m7.1a"><mrow id="S3.SS1.SSS1.p3.7.m7.1.1" xref="S3.SS1.SSS1.p3.7.m7.1.1.cmml"><mi id="S3.SS1.SSS1.p3.7.m7.1.1.2" xref="S3.SS1.SSS1.p3.7.m7.1.1.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.7.m7.1.1.1" xref="S3.SS1.SSS1.p3.7.m7.1.1.1.cmml">​</mo><mrow id="S3.SS1.SSS1.p3.7.m7.1.1.3.2" xref="S3.SS1.SSS1.p3.7.m7.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p3.7.m7.1.1.3.2.1" xref="S3.SS1.SSS1.p3.7.m7.1.1.3.1.cmml">(</mo><mo stretchy="false" id="S3.SS1.SSS1.p3.7.m7.1.1.3.2.2" xref="S3.SS1.SSS1.p3.7.m7.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.7.m7.1b"><apply id="S3.SS1.SSS1.p3.7.m7.1.1.cmml" xref="S3.SS1.SSS1.p3.7.m7.1.1"><times id="S3.SS1.SSS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.SSS1.p3.7.m7.1.1.1"></times><ci id="S3.SS1.SSS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.SSS1.p3.7.m7.1.1.2">𝜎</ci><list id="S3.SS1.SSS1.p3.7.m7.1.1.3.1.cmml" xref="S3.SS1.SSS1.p3.7.m7.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.7.m7.1c">\sigma()</annotation></semantics></math> and <math id="S3.SS1.SSS1.p3.8.m8.1" class="ltx_Math" alttext="tanh()" display="inline"><semantics id="S3.SS1.SSS1.p3.8.m8.1a"><mrow id="S3.SS1.SSS1.p3.8.m8.1.1" xref="S3.SS1.SSS1.p3.8.m8.1.1.cmml"><mi id="S3.SS1.SSS1.p3.8.m8.1.1.2" xref="S3.SS1.SSS1.p3.8.m8.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.8.m8.1.1.1" xref="S3.SS1.SSS1.p3.8.m8.1.1.1.cmml">​</mo><mi id="S3.SS1.SSS1.p3.8.m8.1.1.3" xref="S3.SS1.SSS1.p3.8.m8.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.8.m8.1.1.1a" xref="S3.SS1.SSS1.p3.8.m8.1.1.1.cmml">​</mo><mi id="S3.SS1.SSS1.p3.8.m8.1.1.4" xref="S3.SS1.SSS1.p3.8.m8.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.8.m8.1.1.1b" xref="S3.SS1.SSS1.p3.8.m8.1.1.1.cmml">​</mo><mi id="S3.SS1.SSS1.p3.8.m8.1.1.5" xref="S3.SS1.SSS1.p3.8.m8.1.1.5.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p3.8.m8.1.1.1c" xref="S3.SS1.SSS1.p3.8.m8.1.1.1.cmml">​</mo><mrow id="S3.SS1.SSS1.p3.8.m8.1.1.6.2" xref="S3.SS1.SSS1.p3.8.m8.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p3.8.m8.1.1.6.2.1" xref="S3.SS1.SSS1.p3.8.m8.1.1.6.1.cmml">(</mo><mo stretchy="false" id="S3.SS1.SSS1.p3.8.m8.1.1.6.2.2" xref="S3.SS1.SSS1.p3.8.m8.1.1.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p3.8.m8.1b"><apply id="S3.SS1.SSS1.p3.8.m8.1.1.cmml" xref="S3.SS1.SSS1.p3.8.m8.1.1"><times id="S3.SS1.SSS1.p3.8.m8.1.1.1.cmml" xref="S3.SS1.SSS1.p3.8.m8.1.1.1"></times><ci id="S3.SS1.SSS1.p3.8.m8.1.1.2.cmml" xref="S3.SS1.SSS1.p3.8.m8.1.1.2">𝑡</ci><ci id="S3.SS1.SSS1.p3.8.m8.1.1.3.cmml" xref="S3.SS1.SSS1.p3.8.m8.1.1.3">𝑎</ci><ci id="S3.SS1.SSS1.p3.8.m8.1.1.4.cmml" xref="S3.SS1.SSS1.p3.8.m8.1.1.4">𝑛</ci><ci id="S3.SS1.SSS1.p3.8.m8.1.1.5.cmml" xref="S3.SS1.SSS1.p3.8.m8.1.1.5">ℎ</ci><list id="S3.SS1.SSS1.p3.8.m8.1.1.6.1.cmml" xref="S3.SS1.SSS1.p3.8.m8.1.1.6.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p3.8.m8.1c">tanh()</annotation></semantics></math> denote the sigmoidal and tanh operations, respectively.
These mechanisms allow LSTM to learn long-term temporal dynamics.</p>
</div>
<div id="S3.SS1.SSS1.p4" class="ltx_para">
<p id="S3.SS1.SSS1.p4.1" class="ltx_p">The implementation of Region-LSTM is similar to that of traditional LSTM. However, the important differences lie in the parallel strategy that all parameters (<math id="S3.SS1.SSS1.p4.1.m1.10" class="ltx_Math" alttext="W_{q*},W_{h*},W_{x*},b_{*}" display="inline"><semantics id="S3.SS1.SSS1.p4.1.m1.10a"><mrow id="S3.SS1.SSS1.p4.1.m1.10.10.4" xref="S3.SS1.SSS1.p4.1.m1.10.10.5.cmml"><msub id="S3.SS1.SSS1.p4.1.m1.7.7.1.1" xref="S3.SS1.SSS1.p4.1.m1.7.7.1.1.cmml"><mi id="S3.SS1.SSS1.p4.1.m1.7.7.1.1.2" xref="S3.SS1.SSS1.p4.1.m1.7.7.1.1.2.cmml">W</mi><mrow id="S3.SS1.SSS1.p4.1.m1.2.2.2.4" xref="S3.SS1.SSS1.p4.1.m1.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.p4.1.m1.1.1.1.1" xref="S3.SS1.SSS1.p4.1.m1.1.1.1.1.cmml">q</mi><mo lspace="0.222em" id="S3.SS1.SSS1.p4.1.m1.2.2.2.4.1" xref="S3.SS1.SSS1.p4.1.m1.2.2.2.3.cmml">⁣</mo><mo id="S3.SS1.SSS1.p4.1.m1.2.2.2.2" xref="S3.SS1.SSS1.p4.1.m1.2.2.2.2.cmml">∗</mo></mrow></msub><mo id="S3.SS1.SSS1.p4.1.m1.10.10.4.5" xref="S3.SS1.SSS1.p4.1.m1.10.10.5.cmml">,</mo><msub id="S3.SS1.SSS1.p4.1.m1.8.8.2.2" xref="S3.SS1.SSS1.p4.1.m1.8.8.2.2.cmml"><mi id="S3.SS1.SSS1.p4.1.m1.8.8.2.2.2" xref="S3.SS1.SSS1.p4.1.m1.8.8.2.2.2.cmml">W</mi><mrow id="S3.SS1.SSS1.p4.1.m1.4.4.2.4" xref="S3.SS1.SSS1.p4.1.m1.4.4.2.3.cmml"><mi id="S3.SS1.SSS1.p4.1.m1.3.3.1.1" xref="S3.SS1.SSS1.p4.1.m1.3.3.1.1.cmml">h</mi><mo lspace="0.222em" id="S3.SS1.SSS1.p4.1.m1.4.4.2.4.1" xref="S3.SS1.SSS1.p4.1.m1.4.4.2.3.cmml">⁣</mo><mo id="S3.SS1.SSS1.p4.1.m1.4.4.2.2" xref="S3.SS1.SSS1.p4.1.m1.4.4.2.2.cmml">∗</mo></mrow></msub><mo id="S3.SS1.SSS1.p4.1.m1.10.10.4.6" xref="S3.SS1.SSS1.p4.1.m1.10.10.5.cmml">,</mo><msub id="S3.SS1.SSS1.p4.1.m1.9.9.3.3" xref="S3.SS1.SSS1.p4.1.m1.9.9.3.3.cmml"><mi id="S3.SS1.SSS1.p4.1.m1.9.9.3.3.2" xref="S3.SS1.SSS1.p4.1.m1.9.9.3.3.2.cmml">W</mi><mrow id="S3.SS1.SSS1.p4.1.m1.6.6.2.4" xref="S3.SS1.SSS1.p4.1.m1.6.6.2.3.cmml"><mi id="S3.SS1.SSS1.p4.1.m1.5.5.1.1" xref="S3.SS1.SSS1.p4.1.m1.5.5.1.1.cmml">x</mi><mo lspace="0.222em" id="S3.SS1.SSS1.p4.1.m1.6.6.2.4.1" xref="S3.SS1.SSS1.p4.1.m1.6.6.2.3.cmml">⁣</mo><mo id="S3.SS1.SSS1.p4.1.m1.6.6.2.2" xref="S3.SS1.SSS1.p4.1.m1.6.6.2.2.cmml">∗</mo></mrow></msub><mo id="S3.SS1.SSS1.p4.1.m1.10.10.4.7" xref="S3.SS1.SSS1.p4.1.m1.10.10.5.cmml">,</mo><msub id="S3.SS1.SSS1.p4.1.m1.10.10.4.4" xref="S3.SS1.SSS1.p4.1.m1.10.10.4.4.cmml"><mi id="S3.SS1.SSS1.p4.1.m1.10.10.4.4.2" xref="S3.SS1.SSS1.p4.1.m1.10.10.4.4.2.cmml">b</mi><mo id="S3.SS1.SSS1.p4.1.m1.10.10.4.4.3" xref="S3.SS1.SSS1.p4.1.m1.10.10.4.4.3.cmml">∗</mo></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p4.1.m1.10b"><list id="S3.SS1.SSS1.p4.1.m1.10.10.5.cmml" xref="S3.SS1.SSS1.p4.1.m1.10.10.4"><apply id="S3.SS1.SSS1.p4.1.m1.7.7.1.1.cmml" xref="S3.SS1.SSS1.p4.1.m1.7.7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p4.1.m1.7.7.1.1.1.cmml" xref="S3.SS1.SSS1.p4.1.m1.7.7.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p4.1.m1.7.7.1.1.2.cmml" xref="S3.SS1.SSS1.p4.1.m1.7.7.1.1.2">𝑊</ci><list id="S3.SS1.SSS1.p4.1.m1.2.2.2.3.cmml" xref="S3.SS1.SSS1.p4.1.m1.2.2.2.4"><ci id="S3.SS1.SSS1.p4.1.m1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p4.1.m1.1.1.1.1">𝑞</ci><times id="S3.SS1.SSS1.p4.1.m1.2.2.2.2.cmml" xref="S3.SS1.SSS1.p4.1.m1.2.2.2.2"></times></list></apply><apply id="S3.SS1.SSS1.p4.1.m1.8.8.2.2.cmml" xref="S3.SS1.SSS1.p4.1.m1.8.8.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p4.1.m1.8.8.2.2.1.cmml" xref="S3.SS1.SSS1.p4.1.m1.8.8.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p4.1.m1.8.8.2.2.2.cmml" xref="S3.SS1.SSS1.p4.1.m1.8.8.2.2.2">𝑊</ci><list id="S3.SS1.SSS1.p4.1.m1.4.4.2.3.cmml" xref="S3.SS1.SSS1.p4.1.m1.4.4.2.4"><ci id="S3.SS1.SSS1.p4.1.m1.3.3.1.1.cmml" xref="S3.SS1.SSS1.p4.1.m1.3.3.1.1">ℎ</ci><times id="S3.SS1.SSS1.p4.1.m1.4.4.2.2.cmml" xref="S3.SS1.SSS1.p4.1.m1.4.4.2.2"></times></list></apply><apply id="S3.SS1.SSS1.p4.1.m1.9.9.3.3.cmml" xref="S3.SS1.SSS1.p4.1.m1.9.9.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p4.1.m1.9.9.3.3.1.cmml" xref="S3.SS1.SSS1.p4.1.m1.9.9.3.3">subscript</csymbol><ci id="S3.SS1.SSS1.p4.1.m1.9.9.3.3.2.cmml" xref="S3.SS1.SSS1.p4.1.m1.9.9.3.3.2">𝑊</ci><list id="S3.SS1.SSS1.p4.1.m1.6.6.2.3.cmml" xref="S3.SS1.SSS1.p4.1.m1.6.6.2.4"><ci id="S3.SS1.SSS1.p4.1.m1.5.5.1.1.cmml" xref="S3.SS1.SSS1.p4.1.m1.5.5.1.1">𝑥</ci><times id="S3.SS1.SSS1.p4.1.m1.6.6.2.2.cmml" xref="S3.SS1.SSS1.p4.1.m1.6.6.2.2"></times></list></apply><apply id="S3.SS1.SSS1.p4.1.m1.10.10.4.4.cmml" xref="S3.SS1.SSS1.p4.1.m1.10.10.4.4"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p4.1.m1.10.10.4.4.1.cmml" xref="S3.SS1.SSS1.p4.1.m1.10.10.4.4">subscript</csymbol><ci id="S3.SS1.SSS1.p4.1.m1.10.10.4.4.2.cmml" xref="S3.SS1.SSS1.p4.1.m1.10.10.4.4.2">𝑏</ci><times id="S3.SS1.SSS1.p4.1.m1.10.10.4.4.3.cmml" xref="S3.SS1.SSS1.p4.1.m1.10.10.4.4.3"></times></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p4.1.m1.10c">W_{q*},W_{h*},W_{x*},b_{*}</annotation></semantics></math>) are shared across different regions. Please note that each Region-LSTM has its own gate and cell state, respectively.</p>
</div>
<div id="S3.SS1.SSS1.p5" class="ltx_para">
<p id="S3.SS1.SSS1.p5.10" class="ltx_p">The <math id="S3.SS1.SSS1.p5.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS1.SSS1.p5.1.m1.1a"><mi id="S3.SS1.SSS1.p5.1.m1.1.1" xref="S3.SS1.SSS1.p5.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p5.1.m1.1b"><ci id="S3.SS1.SSS1.p5.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p5.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p5.1.m1.1c">\alpha</annotation></semantics></math> gate is also conditioned on previous episode <math id="S3.SS1.SSS1.p5.2.m2.1" class="ltx_Math" alttext="h_{t-1}" display="inline"><semantics id="S3.SS1.SSS1.p5.2.m2.1a"><msub id="S3.SS1.SSS1.p5.2.m2.1.1" xref="S3.SS1.SSS1.p5.2.m2.1.1.cmml"><mi id="S3.SS1.SSS1.p5.2.m2.1.1.2" xref="S3.SS1.SSS1.p5.2.m2.1.1.2.cmml">h</mi><mrow id="S3.SS1.SSS1.p5.2.m2.1.1.3" xref="S3.SS1.SSS1.p5.2.m2.1.1.3.cmml"><mi id="S3.SS1.SSS1.p5.2.m2.1.1.3.2" xref="S3.SS1.SSS1.p5.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS1.SSS1.p5.2.m2.1.1.3.1" xref="S3.SS1.SSS1.p5.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS1.SSS1.p5.2.m2.1.1.3.3" xref="S3.SS1.SSS1.p5.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p5.2.m2.1b"><apply id="S3.SS1.SSS1.p5.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p5.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p5.2.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p5.2.m2.1.1.2">ℎ</ci><apply id="S3.SS1.SSS1.p5.2.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p5.2.m2.1.1.3"><minus id="S3.SS1.SSS1.p5.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS1.p5.2.m2.1.1.3.1"></minus><ci id="S3.SS1.SSS1.p5.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS1.p5.2.m2.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS1.SSS1.p5.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS1.p5.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p5.2.m2.1c">h_{t-1}</annotation></semantics></math>, region feature <math id="S3.SS1.SSS1.p5.3.m3.1" class="ltx_Math" alttext="X_{k}" display="inline"><semantics id="S3.SS1.SSS1.p5.3.m3.1a"><msub id="S3.SS1.SSS1.p5.3.m3.1.1" xref="S3.SS1.SSS1.p5.3.m3.1.1.cmml"><mi id="S3.SS1.SSS1.p5.3.m3.1.1.2" xref="S3.SS1.SSS1.p5.3.m3.1.1.2.cmml">X</mi><mi id="S3.SS1.SSS1.p5.3.m3.1.1.3" xref="S3.SS1.SSS1.p5.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p5.3.m3.1b"><apply id="S3.SS1.SSS1.p5.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p5.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p5.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p5.3.m3.1.1.2">𝑋</ci><ci id="S3.SS1.SSS1.p5.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p5.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p5.3.m3.1c">X_{k}</annotation></semantics></math>, and current input language feature <math id="S3.SS1.SSS1.p5.4.m4.1" class="ltx_Math" alttext="q_{t}" display="inline"><semantics id="S3.SS1.SSS1.p5.4.m4.1a"><msub id="S3.SS1.SSS1.p5.4.m4.1.1" xref="S3.SS1.SSS1.p5.4.m4.1.1.cmml"><mi id="S3.SS1.SSS1.p5.4.m4.1.1.2" xref="S3.SS1.SSS1.p5.4.m4.1.1.2.cmml">q</mi><mi id="S3.SS1.SSS1.p5.4.m4.1.1.3" xref="S3.SS1.SSS1.p5.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p5.4.m4.1b"><apply id="S3.SS1.SSS1.p5.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p5.4.m4.1.1.1.cmml" xref="S3.SS1.SSS1.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p5.4.m4.1.1.2.cmml" xref="S3.SS1.SSS1.p5.4.m4.1.1.2">𝑞</ci><ci id="S3.SS1.SSS1.p5.4.m4.1.1.3.cmml" xref="S3.SS1.SSS1.p5.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p5.4.m4.1c">q_{t}</annotation></semantics></math>. It returns a single scalar for each region.
This gate is mainly used for weighted combination of region messages for generating episodes, which are dynamically pooled into image-level information.
Similar to <math id="S3.SS1.SSS1.p5.5.m5.6" class="ltx_Math" alttext="W_{zq},W_{zh},W_{zx},b_{z},W_{\alpha},b_{\alpha}" display="inline"><semantics id="S3.SS1.SSS1.p5.5.m5.6a"><mrow id="S3.SS1.SSS1.p5.5.m5.6.6.6" xref="S3.SS1.SSS1.p5.5.m5.6.6.7.cmml"><msub id="S3.SS1.SSS1.p5.5.m5.1.1.1.1" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1.cmml"><mi id="S3.SS1.SSS1.p5.5.m5.1.1.1.1.2" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1.2.cmml">W</mi><mrow id="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.2" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.1" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.3" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="S3.SS1.SSS1.p5.5.m5.6.6.6.7" xref="S3.SS1.SSS1.p5.5.m5.6.6.7.cmml">,</mo><msub id="S3.SS1.SSS1.p5.5.m5.2.2.2.2" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2.cmml"><mi id="S3.SS1.SSS1.p5.5.m5.2.2.2.2.2" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2.2.cmml">W</mi><mrow id="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.2" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.1" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.3" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.3.cmml">h</mi></mrow></msub><mo id="S3.SS1.SSS1.p5.5.m5.6.6.6.8" xref="S3.SS1.SSS1.p5.5.m5.6.6.7.cmml">,</mo><msub id="S3.SS1.SSS1.p5.5.m5.3.3.3.3" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3.cmml"><mi id="S3.SS1.SSS1.p5.5.m5.3.3.3.3.2" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3.2.cmml">W</mi><mrow id="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.cmml"><mi id="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.2" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.1" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.3" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.3.cmml">x</mi></mrow></msub><mo id="S3.SS1.SSS1.p5.5.m5.6.6.6.9" xref="S3.SS1.SSS1.p5.5.m5.6.6.7.cmml">,</mo><msub id="S3.SS1.SSS1.p5.5.m5.4.4.4.4" xref="S3.SS1.SSS1.p5.5.m5.4.4.4.4.cmml"><mi id="S3.SS1.SSS1.p5.5.m5.4.4.4.4.2" xref="S3.SS1.SSS1.p5.5.m5.4.4.4.4.2.cmml">b</mi><mi id="S3.SS1.SSS1.p5.5.m5.4.4.4.4.3" xref="S3.SS1.SSS1.p5.5.m5.4.4.4.4.3.cmml">z</mi></msub><mo id="S3.SS1.SSS1.p5.5.m5.6.6.6.10" xref="S3.SS1.SSS1.p5.5.m5.6.6.7.cmml">,</mo><msub id="S3.SS1.SSS1.p5.5.m5.5.5.5.5" xref="S3.SS1.SSS1.p5.5.m5.5.5.5.5.cmml"><mi id="S3.SS1.SSS1.p5.5.m5.5.5.5.5.2" xref="S3.SS1.SSS1.p5.5.m5.5.5.5.5.2.cmml">W</mi><mi id="S3.SS1.SSS1.p5.5.m5.5.5.5.5.3" xref="S3.SS1.SSS1.p5.5.m5.5.5.5.5.3.cmml">α</mi></msub><mo id="S3.SS1.SSS1.p5.5.m5.6.6.6.11" xref="S3.SS1.SSS1.p5.5.m5.6.6.7.cmml">,</mo><msub id="S3.SS1.SSS1.p5.5.m5.6.6.6.6" xref="S3.SS1.SSS1.p5.5.m5.6.6.6.6.cmml"><mi id="S3.SS1.SSS1.p5.5.m5.6.6.6.6.2" xref="S3.SS1.SSS1.p5.5.m5.6.6.6.6.2.cmml">b</mi><mi id="S3.SS1.SSS1.p5.5.m5.6.6.6.6.3" xref="S3.SS1.SSS1.p5.5.m5.6.6.6.6.3.cmml">α</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p5.5.m5.6b"><list id="S3.SS1.SSS1.p5.5.m5.6.6.7.cmml" xref="S3.SS1.SSS1.p5.5.m5.6.6.6"><apply id="S3.SS1.SSS1.p5.5.m5.1.1.1.1.cmml" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p5.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p5.5.m5.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1.2">𝑊</ci><apply id="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.cmml" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3"><times id="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.1"></times><ci id="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.2">𝑧</ci><ci id="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS1.p5.5.m5.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S3.SS1.SSS1.p5.5.m5.2.2.2.2.cmml" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p5.5.m5.2.2.2.2.1.cmml" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p5.5.m5.2.2.2.2.2.cmml" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2.2">𝑊</ci><apply id="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.cmml" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3"><times id="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.1.cmml" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.1"></times><ci id="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.2.cmml" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.2">𝑧</ci><ci id="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.3.cmml" xref="S3.SS1.SSS1.p5.5.m5.2.2.2.2.3.3">ℎ</ci></apply></apply><apply id="S3.SS1.SSS1.p5.5.m5.3.3.3.3.cmml" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p5.5.m5.3.3.3.3.1.cmml" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS1.p5.5.m5.3.3.3.3.2.cmml" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3.2">𝑊</ci><apply id="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.cmml" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3"><times id="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.1.cmml" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.1"></times><ci id="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.2.cmml" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.2">𝑧</ci><ci id="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.3.cmml" xref="S3.SS1.SSS1.p5.5.m5.3.3.3.3.3.3">𝑥</ci></apply></apply><apply id="S3.SS1.SSS1.p5.5.m5.4.4.4.4.cmml" xref="S3.SS1.SSS1.p5.5.m5.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p5.5.m5.4.4.4.4.1.cmml" xref="S3.SS1.SSS1.p5.5.m5.4.4.4.4">subscript</csymbol><ci id="S3.SS1.SSS1.p5.5.m5.4.4.4.4.2.cmml" xref="S3.SS1.SSS1.p5.5.m5.4.4.4.4.2">𝑏</ci><ci id="S3.SS1.SSS1.p5.5.m5.4.4.4.4.3.cmml" xref="S3.SS1.SSS1.p5.5.m5.4.4.4.4.3">𝑧</ci></apply><apply id="S3.SS1.SSS1.p5.5.m5.5.5.5.5.cmml" xref="S3.SS1.SSS1.p5.5.m5.5.5.5.5"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p5.5.m5.5.5.5.5.1.cmml" xref="S3.SS1.SSS1.p5.5.m5.5.5.5.5">subscript</csymbol><ci id="S3.SS1.SSS1.p5.5.m5.5.5.5.5.2.cmml" xref="S3.SS1.SSS1.p5.5.m5.5.5.5.5.2">𝑊</ci><ci id="S3.SS1.SSS1.p5.5.m5.5.5.5.5.3.cmml" xref="S3.SS1.SSS1.p5.5.m5.5.5.5.5.3">𝛼</ci></apply><apply id="S3.SS1.SSS1.p5.5.m5.6.6.6.6.cmml" xref="S3.SS1.SSS1.p5.5.m5.6.6.6.6"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p5.5.m5.6.6.6.6.1.cmml" xref="S3.SS1.SSS1.p5.5.m5.6.6.6.6">subscript</csymbol><ci id="S3.SS1.SSS1.p5.5.m5.6.6.6.6.2.cmml" xref="S3.SS1.SSS1.p5.5.m5.6.6.6.6.2">𝑏</ci><ci id="S3.SS1.SSS1.p5.5.m5.6.6.6.6.3.cmml" xref="S3.SS1.SSS1.p5.5.m5.6.6.6.6.3">𝛼</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p5.5.m5.6c">W_{zq},W_{zh},W_{zx},b_{z},W_{\alpha},b_{\alpha}</annotation></semantics></math>, the parameters of <math id="S3.SS1.SSS1.p5.6.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS1.SSS1.p5.6.m6.1a"><mi id="S3.SS1.SSS1.p5.6.m6.1.1" xref="S3.SS1.SSS1.p5.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p5.6.m6.1b"><ci id="S3.SS1.SSS1.p5.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p5.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p5.6.m6.1c">\alpha</annotation></semantics></math> gate, are also shared across regions. At every time step <math id="S3.SS1.SSS1.p5.7.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.SSS1.p5.7.m7.1a"><mi id="S3.SS1.SSS1.p5.7.m7.1.1" xref="S3.SS1.SSS1.p5.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p5.7.m7.1b"><ci id="S3.SS1.SSS1.p5.7.m7.1.1.cmml" xref="S3.SS1.SSS1.p5.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p5.7.m7.1c">t</annotation></semantics></math>, <math id="S3.SS1.SSS1.p5.8.m8.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS1.SSS1.p5.8.m8.1a"><mi id="S3.SS1.SSS1.p5.8.m8.1.1" xref="S3.SS1.SSS1.p5.8.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p5.8.m8.1b"><ci id="S3.SS1.SSS1.p5.8.m8.1.1.cmml" xref="S3.SS1.SSS1.p5.8.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p5.8.m8.1c">\alpha</annotation></semantics></math> gate dynamically generates values <math id="S3.SS1.SSS1.p5.9.m9.1" class="ltx_Math" alttext="\alpha_{k}^{t}" display="inline"><semantics id="S3.SS1.SSS1.p5.9.m9.1a"><msubsup id="S3.SS1.SSS1.p5.9.m9.1.1" xref="S3.SS1.SSS1.p5.9.m9.1.1.cmml"><mi id="S3.SS1.SSS1.p5.9.m9.1.1.2.2" xref="S3.SS1.SSS1.p5.9.m9.1.1.2.2.cmml">α</mi><mi id="S3.SS1.SSS1.p5.9.m9.1.1.2.3" xref="S3.SS1.SSS1.p5.9.m9.1.1.2.3.cmml">k</mi><mi id="S3.SS1.SSS1.p5.9.m9.1.1.3" xref="S3.SS1.SSS1.p5.9.m9.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p5.9.m9.1b"><apply id="S3.SS1.SSS1.p5.9.m9.1.1.cmml" xref="S3.SS1.SSS1.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p5.9.m9.1.1.1.cmml" xref="S3.SS1.SSS1.p5.9.m9.1.1">superscript</csymbol><apply id="S3.SS1.SSS1.p5.9.m9.1.1.2.cmml" xref="S3.SS1.SSS1.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p5.9.m9.1.1.2.1.cmml" xref="S3.SS1.SSS1.p5.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p5.9.m9.1.1.2.2.cmml" xref="S3.SS1.SSS1.p5.9.m9.1.1.2.2">𝛼</ci><ci id="S3.SS1.SSS1.p5.9.m9.1.1.2.3.cmml" xref="S3.SS1.SSS1.p5.9.m9.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.SSS1.p5.9.m9.1.1.3.cmml" xref="S3.SS1.SSS1.p5.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p5.9.m9.1c">\alpha_{k}^{t}</annotation></semantics></math> for <math id="S3.SS1.SSS1.p5.10.m10.1" class="ltx_Math" alttext="k^{th}" display="inline"><semantics id="S3.SS1.SSS1.p5.10.m10.1a"><msup id="S3.SS1.SSS1.p5.10.m10.1.1" xref="S3.SS1.SSS1.p5.10.m10.1.1.cmml"><mi id="S3.SS1.SSS1.p5.10.m10.1.1.2" xref="S3.SS1.SSS1.p5.10.m10.1.1.2.cmml">k</mi><mrow id="S3.SS1.SSS1.p5.10.m10.1.1.3" xref="S3.SS1.SSS1.p5.10.m10.1.1.3.cmml"><mi id="S3.SS1.SSS1.p5.10.m10.1.1.3.2" xref="S3.SS1.SSS1.p5.10.m10.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p5.10.m10.1.1.3.1" xref="S3.SS1.SSS1.p5.10.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS1.p5.10.m10.1.1.3.3" xref="S3.SS1.SSS1.p5.10.m10.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p5.10.m10.1b"><apply id="S3.SS1.SSS1.p5.10.m10.1.1.cmml" xref="S3.SS1.SSS1.p5.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p5.10.m10.1.1.1.cmml" xref="S3.SS1.SSS1.p5.10.m10.1.1">superscript</csymbol><ci id="S3.SS1.SSS1.p5.10.m10.1.1.2.cmml" xref="S3.SS1.SSS1.p5.10.m10.1.1.2">𝑘</ci><apply id="S3.SS1.SSS1.p5.10.m10.1.1.3.cmml" xref="S3.SS1.SSS1.p5.10.m10.1.1.3"><times id="S3.SS1.SSS1.p5.10.m10.1.1.3.1.cmml" xref="S3.SS1.SSS1.p5.10.m10.1.1.3.1"></times><ci id="S3.SS1.SSS1.p5.10.m10.1.1.3.2.cmml" xref="S3.SS1.SSS1.p5.10.m10.1.1.3.2">𝑡</ci><ci id="S3.SS1.SSS1.p5.10.m10.1.1.3.3.cmml" xref="S3.SS1.SSS1.p5.10.m10.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p5.10.m10.1c">k^{th}</annotation></semantics></math> region.</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.3" class="ltx_Math" alttext="\begin{array}[]{l}{z_{k}^{t}}=\tanh\left({{W_{zq}}{q_{t}}+{W_{zh}}{h_{t-1}}+{W_{zx}}{x_{k}}+{b_{z}}}\right)\\
{\alpha_{k}^{t}}=\sigma\left({{W_{\alpha}}{z_{k}^{t}}+{b_{\alpha}}}\right)\end{array}" display="block"><semantics id="S3.E7.m1.3a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml"><mtr id="S3.E7.m1.3.3a" xref="S3.E7.m1.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.3.3b" xref="S3.E7.m1.3.3.cmml"><mrow id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.cmml"><msubsup id="S3.E7.m1.2.2.2.2.2.4" xref="S3.E7.m1.2.2.2.2.2.4.cmml"><mi id="S3.E7.m1.2.2.2.2.2.4.2.2" xref="S3.E7.m1.2.2.2.2.2.4.2.2.cmml">z</mi><mi id="S3.E7.m1.2.2.2.2.2.4.2.3" xref="S3.E7.m1.2.2.2.2.2.4.2.3.cmml">k</mi><mi id="S3.E7.m1.2.2.2.2.2.4.3" xref="S3.E7.m1.2.2.2.2.2.4.3.cmml">t</mi></msubsup><mo id="S3.E7.m1.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.3.cmml">=</mo><mrow id="S3.E7.m1.2.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml">tanh</mi><mo id="S3.E7.m1.2.2.2.2.2.2.1a" xref="S3.E7.m1.2.2.2.2.2.2.2.cmml">⁡</mo><mrow id="S3.E7.m1.2.2.2.2.2.2.1.1" xref="S3.E7.m1.2.2.2.2.2.2.2.cmml"><mo id="S3.E7.m1.2.2.2.2.2.2.1.1.2" xref="S3.E7.m1.2.2.2.2.2.2.2.cmml">(</mo><mrow id="S3.E7.m1.2.2.2.2.2.2.1.1.1" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.cmml"><mrow id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.cmml"><msub id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.2.cmml">W</mi><mrow id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.1" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.3.cmml">q</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.1" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.1.cmml">​</mo><msub id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3.2.cmml">q</mi><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E7.m1.2.2.2.2.2.2.1.1.1.1" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.1.cmml">+</mo><mrow id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.cmml"><msub id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.2.cmml">W</mi><mrow id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.1" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.3.cmml">h</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.1" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.1.cmml">​</mo><msub id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.2.cmml">h</mi><mrow id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.2.cmml">t</mi><mo id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.1" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E7.m1.2.2.2.2.2.2.1.1.1.1a" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.1.cmml">+</mo><mrow id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.cmml"><msub id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.2.cmml">W</mi><mrow id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.2.cmml">z</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.1" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.3.cmml">x</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.1" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.1.cmml">​</mo><msub id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3.2.cmml">x</mi><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3.3.cmml">k</mi></msub></mrow><mo id="S3.E7.m1.2.2.2.2.2.2.1.1.1.1b" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.1.cmml">+</mo><msub id="S3.E7.m1.2.2.2.2.2.2.1.1.1.5" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.5.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.5.2" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.5.2.cmml">b</mi><mi id="S3.E7.m1.2.2.2.2.2.2.1.1.1.5.3" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.5.3.cmml">z</mi></msub></mrow><mo id="S3.E7.m1.2.2.2.2.2.2.1.1.3" xref="S3.E7.m1.2.2.2.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E7.m1.3.3c" xref="S3.E7.m1.3.3.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.3.3d" xref="S3.E7.m1.3.3.cmml"><mrow id="S3.E7.m1.3.3.3.1.1" xref="S3.E7.m1.3.3.3.1.1.cmml"><msubsup id="S3.E7.m1.3.3.3.1.1.3" xref="S3.E7.m1.3.3.3.1.1.3.cmml"><mi id="S3.E7.m1.3.3.3.1.1.3.2.2" xref="S3.E7.m1.3.3.3.1.1.3.2.2.cmml">α</mi><mi id="S3.E7.m1.3.3.3.1.1.3.2.3" xref="S3.E7.m1.3.3.3.1.1.3.2.3.cmml">k</mi><mi id="S3.E7.m1.3.3.3.1.1.3.3" xref="S3.E7.m1.3.3.3.1.1.3.3.cmml">t</mi></msubsup><mo id="S3.E7.m1.3.3.3.1.1.2" xref="S3.E7.m1.3.3.3.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.3.3.3.1.1.1" xref="S3.E7.m1.3.3.3.1.1.1.cmml"><mi id="S3.E7.m1.3.3.3.1.1.1.3" xref="S3.E7.m1.3.3.3.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.3.1.1.1.2" xref="S3.E7.m1.3.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.3.3.3.1.1.1.1.1" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.3.3.3.1.1.1.1.1.2" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.3.3.3.1.1.1.1.1.1" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.cmml"><msub id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2.3.cmml">α</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.1" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.2.2" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.2.2.cmml">z</mi><mi id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.2.3" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.2.3.cmml">k</mi><mi id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.3.cmml">t</mi></msubsup></mrow><mo id="S3.E7.m1.3.3.3.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E7.m1.3.3.3.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.3.3.3.1.1.1.1.1.1.3.2" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E7.m1.3.3.3.1.1.1.1.1.1.3.3" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.3.3.cmml">α</mi></msub></mrow><mo id="S3.E7.m1.3.3.3.1.1.1.1.1.3" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><matrix id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3"><matrixrow id="S3.E7.m1.3.3a.cmml" xref="S3.E7.m1.3.3"><apply id="S3.E7.m1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2"><eq id="S3.E7.m1.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3"></eq><apply id="S3.E7.m1.2.2.2.2.2.4.cmml" xref="S3.E7.m1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.4.1.cmml" xref="S3.E7.m1.2.2.2.2.2.4">superscript</csymbol><apply id="S3.E7.m1.2.2.2.2.2.4.2.cmml" xref="S3.E7.m1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.4.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.4">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.4.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.4.2.2">𝑧</ci><ci id="S3.E7.m1.2.2.2.2.2.4.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.4.2.3">𝑘</ci></apply><ci id="S3.E7.m1.2.2.2.2.2.4.3.cmml" xref="S3.E7.m1.2.2.2.2.2.4.3">𝑡</ci></apply><apply id="S3.E7.m1.2.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1"><tanh id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"></tanh><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1"><plus id="S3.E7.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.1"></plus><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2"><times id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.1"></times><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.2">𝑊</ci><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3"><times id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.1"></times><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.2">𝑧</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.2.3.3">𝑞</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3.2">𝑞</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3"><times id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.1"></times><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.2">𝑊</ci><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3"><times id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.1"></times><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.2">𝑧</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.2.3.3">ℎ</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.2">ℎ</ci><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3"><minus id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.1"></minus><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4"><times id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.1"></times><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.2">𝑊</ci><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3"><times id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.1"></times><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.2">𝑧</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.2.3.3">𝑥</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3.2">𝑥</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.4.3.3">𝑘</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.2.2.1.1.1.5.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.5"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.1.1.1.5.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.5">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.5.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.5.2">𝑏</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.1.1.5.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1.1.5.3">𝑧</ci></apply></apply></apply></apply></matrixrow><matrixrow id="S3.E7.m1.3.3b.cmml" xref="S3.E7.m1.3.3"><apply id="S3.E7.m1.3.3.3.1.1.cmml" xref="S3.E7.m1.3.3.3.1.1"><eq id="S3.E7.m1.3.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.3.1.1.2"></eq><apply id="S3.E7.m1.3.3.3.1.1.3.cmml" xref="S3.E7.m1.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.1.1.3.1.cmml" xref="S3.E7.m1.3.3.3.1.1.3">superscript</csymbol><apply id="S3.E7.m1.3.3.3.1.1.3.2.cmml" xref="S3.E7.m1.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.1.1.3.2.1.cmml" xref="S3.E7.m1.3.3.3.1.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.3.1.1.3.2.2.cmml" xref="S3.E7.m1.3.3.3.1.1.3.2.2">𝛼</ci><ci id="S3.E7.m1.3.3.3.1.1.3.2.3.cmml" xref="S3.E7.m1.3.3.3.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E7.m1.3.3.3.1.1.3.3.cmml" xref="S3.E7.m1.3.3.3.1.1.3.3">𝑡</ci></apply><apply id="S3.E7.m1.3.3.3.1.1.1.cmml" xref="S3.E7.m1.3.3.3.1.1.1"><times id="S3.E7.m1.3.3.3.1.1.1.2.cmml" xref="S3.E7.m1.3.3.3.1.1.1.2"></times><ci id="S3.E7.m1.3.3.3.1.1.1.3.cmml" xref="S3.E7.m1.3.3.3.1.1.1.3">𝜎</ci><apply id="S3.E7.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1"><plus id="S3.E7.m1.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.1"></plus><apply id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2"><times id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.1"></times><apply id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.2.3">𝛼</ci></apply><apply id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.2.2">𝑧</ci><ci id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.2.3">𝑘</ci></apply><ci id="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.E7.m1.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.E7.m1.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.1.3.3">𝛼</ci></apply></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\begin{array}[]{l}{z_{k}^{t}}=\tanh\left({{W_{zq}}{q_{t}}+{W_{zh}}{h_{t-1}}+{W_{zx}}{x_{k}}+{b_{z}}}\right)\\
{\alpha_{k}^{t}}=\sigma\left({{W_{\alpha}}{z_{k}^{t}}+{b_{\alpha}}}\right)\end{array}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.SSS1.p6" class="ltx_para">
<p id="S3.SS1.SSS1.p6.1" class="ltx_p">In order to summarize region-level information to an image-level feature, we employ a modified pooling mechanism of gated recurrent style <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. The episode <math id="S3.SS1.SSS1.p6.1.m1.1" class="ltx_Math" alttext="h_{t}" display="inline"><semantics id="S3.SS1.SSS1.p6.1.m1.1a"><msub id="S3.SS1.SSS1.p6.1.m1.1.1" xref="S3.SS1.SSS1.p6.1.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p6.1.m1.1.1.2" xref="S3.SS1.SSS1.p6.1.m1.1.1.2.cmml">h</mi><mi id="S3.SS1.SSS1.p6.1.m1.1.1.3" xref="S3.SS1.SSS1.p6.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p6.1.m1.1b"><apply id="S3.SS1.SSS1.p6.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p6.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p6.1.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p6.1.m1.1.1.2">ℎ</ci><ci id="S3.SS1.SSS1.p6.1.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p6.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p6.1.m1.1c">h_{t}</annotation></semantics></math> acts as dynamic feature as well as hidden state of Compositional Memory unit. It is updated to renew the input information of Region-LSTMs together with language input at every time step.</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\begin{array}[]{l}\beta=1-\frac{1}{K}\sum\limits_{k}{{\alpha_{k}}}\\
{h_{t}}=\beta{h_{t-1}}+\frac{1}{K}\sum\limits_{k}{{\alpha_{k}^{t}}m_{t}^{k}}\end{array}" display="block"><semantics id="S3.E8.m1.1a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mtr id="S3.E8.m1.1.1a" xref="S3.E8.m1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E8.m1.1.1b" xref="S3.E8.m1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.2.cmml">β</mi><mo id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.3.cmml"><mn id="S3.E8.m1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.E8.m1.1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.1.3.1.cmml">−</mo><mrow id="S3.E8.m1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.3.3.cmml"><mstyle displaystyle="false" id="S3.E8.m1.1.1.1.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.1.3.3.2.cmml"><mfrac id="S3.E8.m1.1.1.1.1.1.3.3.2a" xref="S3.E8.m1.1.1.1.1.1.3.3.2.cmml"><mn id="S3.E8.m1.1.1.1.1.1.3.3.2.2" xref="S3.E8.m1.1.1.1.1.1.3.3.2.2.cmml">1</mn><mi id="S3.E8.m1.1.1.1.1.1.3.3.2.3" xref="S3.E8.m1.1.1.1.1.1.3.3.2.3.cmml">K</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.3.3.1" xref="S3.E8.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.1.3.3.3.cmml"><mstyle displaystyle="false" id="S3.E8.m1.1.1.1.1.1.3.3.3.1" xref="S3.E8.m1.1.1.1.1.1.3.3.3.1.cmml"><munder id="S3.E8.m1.1.1.1.1.1.3.3.3.1a" xref="S3.E8.m1.1.1.1.1.1.3.3.3.1.cmml"><mo movablelimits="false" id="S3.E8.m1.1.1.1.1.1.3.3.3.1.2" xref="S3.E8.m1.1.1.1.1.1.3.3.3.1.2.cmml">∑</mo><mi id="S3.E8.m1.1.1.1.1.1.3.3.3.1.3" xref="S3.E8.m1.1.1.1.1.1.3.3.3.1.3.cmml">k</mi></munder></mstyle><msub id="S3.E8.m1.1.1.1.1.1.3.3.3.2" xref="S3.E8.m1.1.1.1.1.1.3.3.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.1.3.3.3.2.2" xref="S3.E8.m1.1.1.1.1.1.3.3.3.2.2.cmml">α</mi><mi id="S3.E8.m1.1.1.1.1.1.3.3.3.2.3" xref="S3.E8.m1.1.1.1.1.1.3.3.3.2.3.cmml">k</mi></msub></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E8.m1.1.1c" xref="S3.E8.m1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E8.m1.1.1d" xref="S3.E8.m1.1.1.cmml"><mrow id="S3.E8.m1.1.1.2.1.1" xref="S3.E8.m1.1.1.2.1.1.cmml"><msub id="S3.E8.m1.1.1.2.1.1.2" xref="S3.E8.m1.1.1.2.1.1.2.cmml"><mi id="S3.E8.m1.1.1.2.1.1.2.2" xref="S3.E8.m1.1.1.2.1.1.2.2.cmml">h</mi><mi id="S3.E8.m1.1.1.2.1.1.2.3" xref="S3.E8.m1.1.1.2.1.1.2.3.cmml">t</mi></msub><mo id="S3.E8.m1.1.1.2.1.1.1" xref="S3.E8.m1.1.1.2.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.2.1.1.3" xref="S3.E8.m1.1.1.2.1.1.3.cmml"><mrow id="S3.E8.m1.1.1.2.1.1.3.2" xref="S3.E8.m1.1.1.2.1.1.3.2.cmml"><mi id="S3.E8.m1.1.1.2.1.1.3.2.2" xref="S3.E8.m1.1.1.2.1.1.3.2.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2.1.1.3.2.1" xref="S3.E8.m1.1.1.2.1.1.3.2.1.cmml">​</mo><msub id="S3.E8.m1.1.1.2.1.1.3.2.3" xref="S3.E8.m1.1.1.2.1.1.3.2.3.cmml"><mi id="S3.E8.m1.1.1.2.1.1.3.2.3.2" xref="S3.E8.m1.1.1.2.1.1.3.2.3.2.cmml">h</mi><mrow id="S3.E8.m1.1.1.2.1.1.3.2.3.3" xref="S3.E8.m1.1.1.2.1.1.3.2.3.3.cmml"><mi id="S3.E8.m1.1.1.2.1.1.3.2.3.3.2" xref="S3.E8.m1.1.1.2.1.1.3.2.3.3.2.cmml">t</mi><mo id="S3.E8.m1.1.1.2.1.1.3.2.3.3.1" xref="S3.E8.m1.1.1.2.1.1.3.2.3.3.1.cmml">−</mo><mn id="S3.E8.m1.1.1.2.1.1.3.2.3.3.3" xref="S3.E8.m1.1.1.2.1.1.3.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E8.m1.1.1.2.1.1.3.1" xref="S3.E8.m1.1.1.2.1.1.3.1.cmml">+</mo><mrow id="S3.E8.m1.1.1.2.1.1.3.3" xref="S3.E8.m1.1.1.2.1.1.3.3.cmml"><mstyle displaystyle="false" id="S3.E8.m1.1.1.2.1.1.3.3.2" xref="S3.E8.m1.1.1.2.1.1.3.3.2.cmml"><mfrac id="S3.E8.m1.1.1.2.1.1.3.3.2a" xref="S3.E8.m1.1.1.2.1.1.3.3.2.cmml"><mn id="S3.E8.m1.1.1.2.1.1.3.3.2.2" xref="S3.E8.m1.1.1.2.1.1.3.3.2.2.cmml">1</mn><mi id="S3.E8.m1.1.1.2.1.1.3.3.2.3" xref="S3.E8.m1.1.1.2.1.1.3.3.2.3.cmml">K</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2.1.1.3.3.1" xref="S3.E8.m1.1.1.2.1.1.3.3.1.cmml">​</mo><mrow id="S3.E8.m1.1.1.2.1.1.3.3.3" xref="S3.E8.m1.1.1.2.1.1.3.3.3.cmml"><mstyle displaystyle="false" id="S3.E8.m1.1.1.2.1.1.3.3.3.1" xref="S3.E8.m1.1.1.2.1.1.3.3.3.1.cmml"><munder id="S3.E8.m1.1.1.2.1.1.3.3.3.1a" xref="S3.E8.m1.1.1.2.1.1.3.3.3.1.cmml"><mo movablelimits="false" id="S3.E8.m1.1.1.2.1.1.3.3.3.1.2" xref="S3.E8.m1.1.1.2.1.1.3.3.3.1.2.cmml">∑</mo><mi id="S3.E8.m1.1.1.2.1.1.3.3.3.1.3" xref="S3.E8.m1.1.1.2.1.1.3.3.3.1.3.cmml">k</mi></munder></mstyle><mrow id="S3.E8.m1.1.1.2.1.1.3.3.3.2" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.cmml"><msubsup id="S3.E8.m1.1.1.2.1.1.3.3.3.2.2" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.cmml"><mi id="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.2.2" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.2.2.cmml">α</mi><mi id="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.2.3" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.2.3.cmml">k</mi><mi id="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.3" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2.1.1.3.3.3.2.1" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.1.cmml">​</mo><msubsup id="S3.E8.m1.1.1.2.1.1.3.3.3.2.3" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.cmml"><mi id="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.2.2" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.2.2.cmml">m</mi><mi id="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.2.3" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.2.3.cmml">t</mi><mi id="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.3" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><matrix id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><matrixrow id="S3.E8.m1.1.1a.cmml" xref="S3.E8.m1.1.1"><apply id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"></eq><ci id="S3.E8.m1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.2">𝛽</ci><apply id="S3.E8.m1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3"><minus id="S3.E8.m1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.3.1"></minus><cn type="integer" id="S3.E8.m1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.3.2">1</cn><apply id="S3.E8.m1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3"><times id="S3.E8.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.1"></times><apply id="S3.E8.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.2"><divide id="S3.E8.m1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.2"></divide><cn type="integer" id="S3.E8.m1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.2.2">1</cn><ci id="S3.E8.m1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.2.3">𝐾</ci></apply><apply id="S3.E8.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.3"><apply id="S3.E8.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.3.3.3.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.3.1">subscript</csymbol><sum id="S3.E8.m1.1.1.1.1.1.3.3.3.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.3.1.2"></sum><ci id="S3.E8.m1.1.1.1.1.1.3.3.3.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.3.1.3">𝑘</ci></apply><apply id="S3.E8.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.3.2.2">𝛼</ci><ci id="S3.E8.m1.1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3.3.2.3">𝑘</ci></apply></apply></apply></apply></apply></matrixrow><matrixrow id="S3.E8.m1.1.1b.cmml" xref="S3.E8.m1.1.1"><apply id="S3.E8.m1.1.1.2.1.1.cmml" xref="S3.E8.m1.1.1.2.1.1"><eq id="S3.E8.m1.1.1.2.1.1.1.cmml" xref="S3.E8.m1.1.1.2.1.1.1"></eq><apply id="S3.E8.m1.1.1.2.1.1.2.cmml" xref="S3.E8.m1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.1.1.2.1.cmml" xref="S3.E8.m1.1.1.2.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.2.1.1.2.2.cmml" xref="S3.E8.m1.1.1.2.1.1.2.2">ℎ</ci><ci id="S3.E8.m1.1.1.2.1.1.2.3.cmml" xref="S3.E8.m1.1.1.2.1.1.2.3">𝑡</ci></apply><apply id="S3.E8.m1.1.1.2.1.1.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3"><plus id="S3.E8.m1.1.1.2.1.1.3.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.1"></plus><apply id="S3.E8.m1.1.1.2.1.1.3.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.2"><times id="S3.E8.m1.1.1.2.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.2.1"></times><ci id="S3.E8.m1.1.1.2.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.2.2">𝛽</ci><apply id="S3.E8.m1.1.1.2.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.1.1.3.2.3.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.2.3">subscript</csymbol><ci id="S3.E8.m1.1.1.2.1.1.3.2.3.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.2.3.2">ℎ</ci><apply id="S3.E8.m1.1.1.2.1.1.3.2.3.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3.2.3.3"><minus id="S3.E8.m1.1.1.2.1.1.3.2.3.3.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.2.3.3.1"></minus><ci id="S3.E8.m1.1.1.2.1.1.3.2.3.3.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.2.3.3.2">𝑡</ci><cn type="integer" id="S3.E8.m1.1.1.2.1.1.3.2.3.3.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E8.m1.1.1.2.1.1.3.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3"><times id="S3.E8.m1.1.1.2.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.1"></times><apply id="S3.E8.m1.1.1.2.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.2"><divide id="S3.E8.m1.1.1.2.1.1.3.3.2.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.2"></divide><cn type="integer" id="S3.E8.m1.1.1.2.1.1.3.3.2.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.2.2">1</cn><ci id="S3.E8.m1.1.1.2.1.1.3.3.2.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.2.3">𝐾</ci></apply><apply id="S3.E8.m1.1.1.2.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3"><apply id="S3.E8.m1.1.1.2.1.1.3.3.3.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.1.1.3.3.3.1.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.1">subscript</csymbol><sum id="S3.E8.m1.1.1.2.1.1.3.3.3.1.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.1.2"></sum><ci id="S3.E8.m1.1.1.2.1.1.3.3.3.1.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.1.3">𝑘</ci></apply><apply id="S3.E8.m1.1.1.2.1.1.3.3.3.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2"><times id="S3.E8.m1.1.1.2.1.1.3.3.3.2.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.1"></times><apply id="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.2">superscript</csymbol><apply id="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.2.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.2.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.2.2">𝛼</ci><ci id="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.2.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.2.3">𝑘</ci></apply><ci id="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.2.3">𝑡</ci></apply><apply id="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.3">superscript</csymbol><apply id="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.2.1.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.3">subscript</csymbol><ci id="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.2.2.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.2.2">𝑚</ci><ci id="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.2.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.2.3">𝑡</ci></apply><ci id="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.3.cmml" xref="S3.E8.m1.1.1.2.1.1.3.3.3.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\begin{array}[]{l}\beta=1-\frac{1}{K}\sum\limits_{k}{{\alpha_{k}}}\\
{h_{t}}=\beta{h_{t-1}}+\frac{1}{K}\sum\limits_{k}{{\alpha_{k}^{t}}m_{t}^{k}}\end{array}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p6.2" class="ltx_p">where <math id="S3.SS1.SSS1.p6.2.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.SSS1.p6.2.m1.1a"><mi id="S3.SS1.SSS1.p6.2.m1.1.1" xref="S3.SS1.SSS1.p6.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p6.2.m1.1b"><ci id="S3.SS1.SSS1.p6.2.m1.1.1.cmml" xref="S3.SS1.SSS1.p6.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p6.2.m1.1c">K</annotation></semantics></math> is the total number of regions.</p>
</div>
<div id="S3.SS1.SSS1.p7" class="ltx_para">
<p id="S3.SS1.SSS1.p7.1" class="ltx_p">One of the advantages of Compositional Memory is that it goes beyond traditional static image feature. The unit incorporates both the merits of LSTM and attention mechanism, and thus it is suitable to generate dynamic episodic messages for visual question answering applications.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Language LSTM</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.1" class="ltx_p">We use a Language LSTM to process linguistic inputs.
We consider this representation as “factorization of questions”, which captures the recurrent relations of question word sequence, and stores semantic memory information about the questions. This strategy for processing language has also been proven to be important in image captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
</section>
<section id="S3.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3 </span>Other components</h4>

<section id="S3.SS1.SSS3.P0.SPx1" class="ltx_subparagraph">
<h5 class="ltx_title ltx_title_subparagraph">Answer generation</h5>

<div id="S3.SS1.SSS3.P0.SPx1.p1" class="ltx_para">
<p id="S3.SS1.SSS3.P0.SPx1.p1.1" class="ltx_p">The answer generation module takes dynamic episodes, together with language and static visual context generated by CNNs to generate the answers in a LSTM framework.</p>
</div>
</section>
<section id="S3.SS1.SSS3.P0.SPx2" class="ltx_subparagraph">
<h5 class="ltx_title ltx_title_subparagraph">CNN</h5>

<div id="S3.SS1.SSS3.P0.SPx2.p1" class="ltx_para">
<p id="S3.SS1.SSS3.P0.SPx2.p1.1" class="ltx_p">Our approach is compatible with all the major CNN network, such as AlexNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> and GoogLeNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>.
In each CNN, we use the last convolution layer as region selections.
For example, GoogleNet, we use the <math id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1" class="ltx_Math" alttext="1024\times 7\times 7" display="inline"><semantics id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1a"><mrow id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1" xref="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.cmml"><mn id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.2" xref="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.2.cmml">1024</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.1" xref="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.3" xref="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.3.cmml">7</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.1a" xref="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.4" xref="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.4.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1b"><apply id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1"><times id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.1"></times><cn type="integer" id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.2">1024</cn><cn type="integer" id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.3">7</cn><cn type="integer" id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.4.cmml" xref="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1.1.4">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.P0.SPx2.p1.1.m1.1c">1024\times 7\times 7</annotation></semantics></math> feature map from the inception_5b/output. This means that Compositional Memory operates on 49 regions, each of which is represented by 1024-dim feature vector.
Following the current practice, we used the output of the last CNN layer as visual context.</p>
</div>
</section>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Training</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Generally, there are three types of the VQA tasks: 1) Single Word, 2) Multiple Words (or called “Open-ended”), and 3) Multiple Choice. The single word category restricts the answer to have only one single word. Multiple Words VQA is an open-ended task, where the length of answer is not limited and the VQA system needs to sequentially generate possible answer words until generating an answer-ending mark. The multiple choice task refers to select most probable answer from a set of answer candidates.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Among these three, the “Open-ended” VQA task is the most difficult one, thus we chose this category to demonstrate the performance of our approach.
In this section, we briefly present the training procedure, the loss function, and other implementation details.</p>
</div>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Protocol</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.1" class="ltx_p">During the training of our VQA system, CNN and LSTMs are jointly learned in an end-to-end way. The unfolded network of our proposed model is shown in Figure <a href="#S3.F4" title="Figure 4 ‣ 3.1.1 Compositional Memory ‣ 3.1 Our End-to-End VQA model ‣ 3 Our Approach ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para">
<p id="S3.SS2.SSS1.p2.6" class="ltx_p">In this Open-ended category of VQA, questions may have multiple word answers.
We consequently decompose the problem to predict a set of answer words <math id="S3.SS2.SSS1.p2.1.m1.4" class="ltx_Math" alttext="A=\left\{{{a_{1}},{a_{2}},...,{a_{M}}}\right\}" display="inline"><semantics id="S3.SS2.SSS1.p2.1.m1.4a"><mrow id="S3.SS2.SSS1.p2.1.m1.4.4" xref="S3.SS2.SSS1.p2.1.m1.4.4.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.4.4.5" xref="S3.SS2.SSS1.p2.1.m1.4.4.5.cmml">A</mi><mo id="S3.SS2.SSS1.p2.1.m1.4.4.4" xref="S3.SS2.SSS1.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS2.SSS1.p2.1.m1.4.4.3.3" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml"><mo id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.4" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml">{</mo><msub id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.cmml">a</mi><mn id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.3" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.5" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2.cmml">a</mi><mn id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.3" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.6" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.7" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2.cmml">a</mi><mi id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.3" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.3.cmml">M</mi></msub><mo id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.8" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.4b"><apply id="S3.SS2.SSS1.p2.1.m1.4.4.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4"><eq id="S3.SS2.SSS1.p2.1.m1.4.4.4.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.4"></eq><ci id="S3.SS2.SSS1.p2.1.m1.4.4.5.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.5">𝐴</ci><set id="S3.SS2.SSS1.p2.1.m1.4.4.3.4.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3"><apply id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.2">𝑎</ci><cn type="integer" id="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.2">𝑎</ci><cn type="integer" id="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1">…</ci><apply id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.2">𝑎</ci><ci id="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.4.4.3.3.3.3">𝑀</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.4c">A=\left\{{{a_{1}},{a_{2}},...,{a_{M}}}\right\}</annotation></semantics></math>, where <math id="S3.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><msub id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.cmml">a</mi><mi id="S3.SS2.SSS1.p2.2.m2.1.1.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><apply id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.2">𝑎</ci><ci id="S3.SS2.SSS1.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">a_{i}</annotation></semantics></math> are words from a finite vocabulary <math id="S3.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="\Omega^{\prime}" display="inline"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><msup id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.SSS1.p2.3.m3.1.1.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml">Ω</mi><mo id="S3.SS2.SSS1.p2.3.m3.1.1.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><apply id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.2">Ω</ci><ci id="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">\Omega^{\prime}</annotation></semantics></math> and M is the number of answer words for a given question and image. To deal with open-ended VQA task, we add an extra token <math id="S3.SS2.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\langle EOA\rangle" display="inline"><semantics id="S3.SS2.SSS1.p2.4.m4.1a"><mrow id="S3.SS2.SSS1.p2.4.m4.1.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.4.m4.1.1.1.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.2.1.cmml">⟨</mo><mrow id="S3.SS2.SSS1.p2.4.m4.1.1.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1a" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.4" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.4.cmml">A</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.4.m4.1.1.1.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.4.m4.1b"><apply id="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1"><times id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.1"></times><ci id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.2">𝐸</ci><ci id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.3">𝑂</ci><ci id="S3.SS2.SSS1.p2.4.m4.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.1.1.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.1c">\langle EOA\rangle</annotation></semantics></math> into the vocabulary <math id="S3.SS2.SSS1.p2.5.m5.1" class="ltx_Math" alttext="\Omega=\Omega^{\prime}\cup\{\langle EOA\rangle\}" display="inline"><semantics id="S3.SS2.SSS1.p2.5.m5.1a"><mrow id="S3.SS2.SSS1.p2.5.m5.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.SSS1.p2.5.m5.1.1.3" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.cmml">Ω</mi><mo id="S3.SS2.SSS1.p2.5.m5.1.1.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.2.cmml">=</mo><mrow id="S3.SS2.SSS1.p2.5.m5.1.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.cmml"><msup id="S3.SS2.SSS1.p2.5.m5.1.1.1.3" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.SS2.SSS1.p2.5.m5.1.1.1.3.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.3.2.cmml">Ω</mi><mo id="S3.SS2.SSS1.p2.5.m5.1.1.1.3.3" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.3.3.cmml">′</mo></msup><mo id="S3.SS2.SSS1.p2.5.m5.1.1.1.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.2.cmml">∪</mo><mrow id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.2.1.cmml">⟨</mo><mrow id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.1a" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.4" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.4.cmml">A</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.2.1.cmml">⟩</mo></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.5.m5.1b"><apply id="S3.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1"><eq id="S3.SS2.SSS1.p2.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.2"></eq><ci id="S3.SS2.SSS1.p2.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3">Ω</ci><apply id="S3.SS2.SSS1.p2.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1"><union id="S3.SS2.SSS1.p2.5.m5.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.2"></union><apply id="S3.SS2.SSS1.p2.5.m5.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.5.m5.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p2.5.m5.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.3.2">Ω</ci><ci id="S3.SS2.SSS1.p2.5.m5.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.3.3">′</ci></apply><set id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1"><apply id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1"><times id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.1"></times><ci id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.2">𝐸</ci><ci id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.3">𝑂</ci><ci id="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.1.1.1.1.1.4">𝐴</ci></apply></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m5.1c">\Omega=\Omega^{\prime}\cup\{\langle EOA\rangle\}</annotation></semantics></math>. The <math id="S3.SS2.SSS1.p2.6.m6.1" class="ltx_Math" alttext="\langle EOA\rangle" display="inline"><semantics id="S3.SS2.SSS1.p2.6.m6.1a"><mrow id="S3.SS2.SSS1.p2.6.m6.1.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.6.m6.1.1.1.2" xref="S3.SS2.SSS1.p2.6.m6.1.1.2.1.cmml">⟨</mo><mrow id="S3.SS2.SSS1.p2.6.m6.1.1.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.2" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1a" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.4" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.4.cmml">A</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.6.m6.1.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.6.m6.1b"><apply id="S3.SS2.SSS1.p2.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.6.m6.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1"><times id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1"></times><ci id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.2">𝐸</ci><ci id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3">𝑂</ci><ci id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.6.m6.1c">\langle EOA\rangle</annotation></semantics></math> indicates the end of the answer sequence. Therefore, we formulate the prediction procedure recursively as:</p>
<table id="S5.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9.m1.4" class="ltx_Math" alttext="\displaystyle{\widehat{a}_{t}}=\arg\max p(a|X,q,{\widehat{A}_{t-1}};\vartheta)" display="inline"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.4" xref="S3.E9.m1.4.4.cmml"><msub id="S3.E9.m1.4.4.3" xref="S3.E9.m1.4.4.3.cmml"><mover accent="true" id="S3.E9.m1.4.4.3.2" xref="S3.E9.m1.4.4.3.2.cmml"><mi id="S3.E9.m1.4.4.3.2.2" xref="S3.E9.m1.4.4.3.2.2.cmml">a</mi><mo id="S3.E9.m1.4.4.3.2.1" xref="S3.E9.m1.4.4.3.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.4.4.3.3" xref="S3.E9.m1.4.4.3.3.cmml">t</mi></msub><mo id="S3.E9.m1.4.4.2" xref="S3.E9.m1.4.4.2.cmml">=</mo><mrow id="S3.E9.m1.4.4.1" xref="S3.E9.m1.4.4.1.cmml"><mrow id="S3.E9.m1.4.4.1.3" xref="S3.E9.m1.4.4.1.3.cmml"><mi id="S3.E9.m1.4.4.1.3.1" xref="S3.E9.m1.4.4.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E9.m1.4.4.1.3a" xref="S3.E9.m1.4.4.1.3.cmml">⁡</mo><mrow id="S3.E9.m1.4.4.1.3.2" xref="S3.E9.m1.4.4.1.3.2.cmml"><mi id="S3.E9.m1.4.4.1.3.2.1" xref="S3.E9.m1.4.4.1.3.2.1.cmml">max</mi><mo lspace="0.167em" id="S3.E9.m1.4.4.1.3.2a" xref="S3.E9.m1.4.4.1.3.2.cmml">⁡</mo><mi id="S3.E9.m1.4.4.1.3.2.2" xref="S3.E9.m1.4.4.1.3.2.2.cmml">p</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E9.m1.4.4.1.2" xref="S3.E9.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E9.m1.4.4.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.4.4.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.4.4.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.cmml"><mi id="S3.E9.m1.4.4.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.1.3.cmml">a</mi><mo fence="false" id="S3.E9.m1.4.4.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.2.cmml">|</mo><mrow id="S3.E9.m1.4.4.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">X</mi><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml">q</mi><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E9.m1.4.4.1.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E9.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">A</mi><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.1.2.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.E9.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.4" xref="S3.E9.m1.4.4.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml">ϑ</mi></mrow></mrow><mo stretchy="false" id="S3.E9.m1.4.4.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.4.cmml" xref="S3.E9.m1.4.4"><eq id="S3.E9.m1.4.4.2.cmml" xref="S3.E9.m1.4.4.2"></eq><apply id="S3.E9.m1.4.4.3.cmml" xref="S3.E9.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.3.1.cmml" xref="S3.E9.m1.4.4.3">subscript</csymbol><apply id="S3.E9.m1.4.4.3.2.cmml" xref="S3.E9.m1.4.4.3.2"><ci id="S3.E9.m1.4.4.3.2.1.cmml" xref="S3.E9.m1.4.4.3.2.1">^</ci><ci id="S3.E9.m1.4.4.3.2.2.cmml" xref="S3.E9.m1.4.4.3.2.2">𝑎</ci></apply><ci id="S3.E9.m1.4.4.3.3.cmml" xref="S3.E9.m1.4.4.3.3">𝑡</ci></apply><apply id="S3.E9.m1.4.4.1.cmml" xref="S3.E9.m1.4.4.1"><times id="S3.E9.m1.4.4.1.2.cmml" xref="S3.E9.m1.4.4.1.2"></times><apply id="S3.E9.m1.4.4.1.3.cmml" xref="S3.E9.m1.4.4.1.3"><arg id="S3.E9.m1.4.4.1.3.1.cmml" xref="S3.E9.m1.4.4.1.3.1"></arg><apply id="S3.E9.m1.4.4.1.3.2.cmml" xref="S3.E9.m1.4.4.1.3.2"><max id="S3.E9.m1.4.4.1.3.2.1.cmml" xref="S3.E9.m1.4.4.1.3.2.1"></max><ci id="S3.E9.m1.4.4.1.3.2.2.cmml" xref="S3.E9.m1.4.4.1.3.2.2">𝑝</ci></apply></apply><apply id="S3.E9.m1.4.4.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1"><csymbol cd="latexml" id="S3.E9.m1.4.4.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.2">conditional</csymbol><ci id="S3.E9.m1.4.4.1.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.1.1.3">𝑎</ci><list id="S3.E9.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1"><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">𝑋</ci><ci id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2">𝑞</ci><apply id="S3.E9.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E9.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.2"><ci id="S3.E9.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E9.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.2.2">𝐴</ci></apply><apply id="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.3"><minus id="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3">italic-ϑ</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">\displaystyle{\widehat{a}_{t}}=\arg\max p(a|X,q,{\widehat{A}_{t-1}};\vartheta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p2.9" class="ltx_p">where <math id="S3.SS2.SSS1.p2.7.m1.1" class="ltx_Math" alttext="{\widehat{A}_{t-1}}" display="inline"><semantics id="S3.SS2.SSS1.p2.7.m1.1a"><msub id="S3.SS2.SSS1.p2.7.m1.1.1" xref="S3.SS2.SSS1.p2.7.m1.1.1.cmml"><mover accent="true" id="S3.SS2.SSS1.p2.7.m1.1.1.2" xref="S3.SS2.SSS1.p2.7.m1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p2.7.m1.1.1.2.2" xref="S3.SS2.SSS1.p2.7.m1.1.1.2.2.cmml">A</mi><mo id="S3.SS2.SSS1.p2.7.m1.1.1.2.1" xref="S3.SS2.SSS1.p2.7.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.SSS1.p2.7.m1.1.1.3" xref="S3.SS2.SSS1.p2.7.m1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.7.m1.1.1.3.2" xref="S3.SS2.SSS1.p2.7.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS2.SSS1.p2.7.m1.1.1.3.1" xref="S3.SS2.SSS1.p2.7.m1.1.1.3.1.cmml">−</mo><mn id="S3.SS2.SSS1.p2.7.m1.1.1.3.3" xref="S3.SS2.SSS1.p2.7.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.7.m1.1b"><apply id="S3.SS2.SSS1.p2.7.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.7.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m1.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.p2.7.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.7.m1.1.1.2"><ci id="S3.SS2.SSS1.p2.7.m1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.7.m1.1.1.2.1">^</ci><ci id="S3.SS2.SSS1.p2.7.m1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.7.m1.1.1.2.2">𝐴</ci></apply><apply id="S3.SS2.SSS1.p2.7.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.7.m1.1.1.3"><minus id="S3.SS2.SSS1.p2.7.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.7.m1.1.1.3.1"></minus><ci id="S3.SS2.SSS1.p2.7.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.7.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS1.p2.7.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.7.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.7.m1.1c">{\widehat{A}_{t-1}}</annotation></semantics></math> is the set of previously predicted answer words, with <math id="S3.SS2.SSS1.p2.8.m2.1" class="ltx_Math" alttext="{\widehat{A}_{0}}=\{\}" display="inline"><semantics id="S3.SS2.SSS1.p2.8.m2.1a"><mrow id="S3.SS2.SSS1.p2.8.m2.1.1" xref="S3.SS2.SSS1.p2.8.m2.1.1.cmml"><msub id="S3.SS2.SSS1.p2.8.m2.1.1.2" xref="S3.SS2.SSS1.p2.8.m2.1.1.2.cmml"><mover accent="true" id="S3.SS2.SSS1.p2.8.m2.1.1.2.2" xref="S3.SS2.SSS1.p2.8.m2.1.1.2.2.cmml"><mi id="S3.SS2.SSS1.p2.8.m2.1.1.2.2.2" xref="S3.SS2.SSS1.p2.8.m2.1.1.2.2.2.cmml">A</mi><mo id="S3.SS2.SSS1.p2.8.m2.1.1.2.2.1" xref="S3.SS2.SSS1.p2.8.m2.1.1.2.2.1.cmml">^</mo></mover><mn id="S3.SS2.SSS1.p2.8.m2.1.1.2.3" xref="S3.SS2.SSS1.p2.8.m2.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS2.SSS1.p2.8.m2.1.1.1" xref="S3.SS2.SSS1.p2.8.m2.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS1.p2.8.m2.1.1.3.2" xref="S3.SS2.SSS1.p2.8.m2.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.8.m2.1.1.3.2.1" xref="S3.SS2.SSS1.p2.8.m2.1.1.3.1.cmml">{</mo><mo stretchy="false" id="S3.SS2.SSS1.p2.8.m2.1.1.3.2.2" xref="S3.SS2.SSS1.p2.8.m2.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.8.m2.1b"><apply id="S3.SS2.SSS1.p2.8.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m2.1.1"><eq id="S3.SS2.SSS1.p2.8.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m2.1.1.1"></eq><apply id="S3.SS2.SSS1.p2.8.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m2.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.8.m2.1.1.2">subscript</csymbol><apply id="S3.SS2.SSS1.p2.8.m2.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m2.1.1.2.2"><ci id="S3.SS2.SSS1.p2.8.m2.1.1.2.2.1.cmml" xref="S3.SS2.SSS1.p2.8.m2.1.1.2.2.1">^</ci><ci id="S3.SS2.SSS1.p2.8.m2.1.1.2.2.2.cmml" xref="S3.SS2.SSS1.p2.8.m2.1.1.2.2.2">𝐴</ci></apply><cn type="integer" id="S3.SS2.SSS1.p2.8.m2.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.8.m2.1.1.2.3">0</cn></apply><list id="S3.SS2.SSS1.p2.8.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.8.m2.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.8.m2.1c">{\widehat{A}_{0}}=\{\}</annotation></semantics></math> at start. The prediction procedure is terminated when <math id="S3.SS2.SSS1.p2.9.m3.1" class="ltx_Math" alttext="{\widehat{a}_{t}}=\langle EOA\rangle" display="inline"><semantics id="S3.SS2.SSS1.p2.9.m3.1a"><mrow id="S3.SS2.SSS1.p2.9.m3.1.1" xref="S3.SS2.SSS1.p2.9.m3.1.1.cmml"><msub id="S3.SS2.SSS1.p2.9.m3.1.1.3" xref="S3.SS2.SSS1.p2.9.m3.1.1.3.cmml"><mover accent="true" id="S3.SS2.SSS1.p2.9.m3.1.1.3.2" xref="S3.SS2.SSS1.p2.9.m3.1.1.3.2.cmml"><mi id="S3.SS2.SSS1.p2.9.m3.1.1.3.2.2" xref="S3.SS2.SSS1.p2.9.m3.1.1.3.2.2.cmml">a</mi><mo id="S3.SS2.SSS1.p2.9.m3.1.1.3.2.1" xref="S3.SS2.SSS1.p2.9.m3.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS1.p2.9.m3.1.1.3.3" xref="S3.SS2.SSS1.p2.9.m3.1.1.3.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.p2.9.m3.1.1.2" xref="S3.SS2.SSS1.p2.9.m3.1.1.2.cmml">=</mo><mrow id="S3.SS2.SSS1.p2.9.m3.1.1.1.1" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.2" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.2.1.cmml">⟨</mo><mrow id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.2" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.1a" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.4" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.4.cmml">A</mi></mrow><mo stretchy="false" id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.3" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.2.1.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.9.m3.1b"><apply id="S3.SS2.SSS1.p2.9.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1"><eq id="S3.SS2.SSS1.p2.9.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.2"></eq><apply id="S3.SS2.SSS1.p2.9.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.9.m3.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.3">subscript</csymbol><apply id="S3.SS2.SSS1.p2.9.m3.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.3.2"><ci id="S3.SS2.SSS1.p2.9.m3.1.1.3.2.1.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.3.2.1">^</ci><ci id="S3.SS2.SSS1.p2.9.m3.1.1.3.2.2.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.3.2.2">𝑎</ci></apply><ci id="S3.SS2.SSS1.p2.9.m3.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.3.3">𝑡</ci></apply><apply id="S3.SS2.SSS1.p2.9.m3.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.9.m3.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1"><times id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.1"></times><ci id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.2">𝐸</ci><ci id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.3">𝑂</ci><ci id="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p2.9.m3.1.1.1.1.1.4">𝐴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.9.m3.1c">{\widehat{a}_{t}}=\langle EOA\rangle</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.SSS1.p3" class="ltx_para">
<p id="S3.SS2.SSS1.p3.7" class="ltx_p">As shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.1 Our End-to-End VQA model ‣ 3 Our Approach ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and Figure <a href="#S3.F4" title="Figure 4 ‣ 3.1.1 Compositional Memory ‣ 3.1 Our End-to-End VQA model ‣ 3 Our Approach ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we feed the VQA system with a question as a sequence of words, <span id="S3.SS2.SSS1.p3.7.1" class="ltx_text ltx_font_italic">i.e.</span> <math id="S3.SS2.SSS1.p3.1.m1.6" class="ltx_Math" alttext="q=[{q_{1}},{q_{2}},...,{q_{n-1}},\left[\kern-1.49994pt\left[?\right]\kern-1.49994pt\right]]" display="inline"><semantics id="S3.SS2.SSS1.p3.1.m1.6a"><mrow id="S3.SS2.SSS1.p3.1.m1.6.6" xref="S3.SS2.SSS1.p3.1.m1.6.6.cmml"><mi id="S3.SS2.SSS1.p3.1.m1.6.6.6" xref="S3.SS2.SSS1.p3.1.m1.6.6.6.cmml">q</mi><mo id="S3.SS2.SSS1.p3.1.m1.6.6.5" xref="S3.SS2.SSS1.p3.1.m1.6.6.5.cmml">=</mo><mrow id="S3.SS2.SSS1.p3.1.m1.6.6.4.4" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.5.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.5" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.5.cmml">[</mo><msub id="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1" xref="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1.2" xref="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1.2.cmml">q</mi><mn id="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1.3" xref="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.6" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.5.cmml">,</mo><msub id="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2" xref="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2.cmml"><mi id="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2.2" xref="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2.2.cmml">q</mi><mn id="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2.3" xref="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.7" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS1.p3.1.m1.2.2" xref="S3.SS2.SSS1.p3.1.m1.2.2.cmml">…</mi><mo id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.8" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.5.cmml">,</mo><msub id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.cmml"><mi id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.2" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.2.cmml">q</mi><mrow id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.cmml"><mi id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.2" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.2.cmml">n</mi><mo id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.1" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.1.cmml">−</mo><mn id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.3" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.9" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.5.cmml">,</mo><mrow id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.2.cmml"><mo id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.2" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.2.1.cmml">[</mo><mrow id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.1.2" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.1.1.cmml"><mo id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.1.2.1" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.1.1.1.cmml">[</mo><mi mathvariant="normal" id="S3.SS2.SSS1.p3.1.m1.1.1" xref="S3.SS2.SSS1.p3.1.m1.1.1.cmml">?</mi><mo id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.1.2.2" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.3" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.2.1.cmml">]</mo></mrow><mo stretchy="false" id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.10" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.1.m1.6b"><apply id="S3.SS2.SSS1.p3.1.m1.6.6.cmml" xref="S3.SS2.SSS1.p3.1.m1.6.6"><eq id="S3.SS2.SSS1.p3.1.m1.6.6.5.cmml" xref="S3.SS2.SSS1.p3.1.m1.6.6.5"></eq><ci id="S3.SS2.SSS1.p3.1.m1.6.6.6.cmml" xref="S3.SS2.SSS1.p3.1.m1.6.6.6">𝑞</ci><list id="S3.SS2.SSS1.p3.1.m1.6.6.4.5.cmml" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.4"><apply id="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1.2">𝑞</ci><cn type="integer" id="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.1.m1.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2.2">𝑞</ci><cn type="integer" id="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2.3.cmml" xref="S3.SS2.SSS1.p3.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS1.p3.1.m1.2.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.2.2">…</ci><apply id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.cmml" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.2">𝑞</ci><apply id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.cmml" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3"><minus id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.1"></minus><ci id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.2">𝑛</ci><cn type="integer" id="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.3.cmml" xref="S3.SS2.SSS1.p3.1.m1.5.5.3.3.3.3.3">1</cn></apply></apply><apply id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.2.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.1.2"><csymbol cd="latexml" id="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.6.6.4.4.4.1.1.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1">?</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.1.m1.6c">q=[{q_{1}},{q_{2}},...,{q_{n-1}},\left[\kern-1.49994pt\left[?\right]\kern-1.49994pt\right]]</annotation></semantics></math>, where <math id="S3.SS2.SSS1.p3.2.m2.2" class="ltx_Math" alttext="\left[\kern-1.49994pt\left[?\right]\kern-1.49994pt\right]" display="inline"><semantics id="S3.SS2.SSS1.p3.2.m2.2a"><mrow id="S3.SS2.SSS1.p3.2.m2.2.2.1" xref="S3.SS2.SSS1.p3.2.m2.2.2.2.cmml"><mo id="S3.SS2.SSS1.p3.2.m2.2.2.1.2" xref="S3.SS2.SSS1.p3.2.m2.2.2.2.1.cmml">[</mo><mrow id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.2" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.cmml"><mo id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.2.1" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.1.cmml">[</mo><mi mathvariant="normal" id="S3.SS2.SSS1.p3.2.m2.1.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.cmml">?</mi><mo id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.2.2" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS2.SSS1.p3.2.m2.2.2.1.3" xref="S3.SS2.SSS1.p3.2.m2.2.2.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.2.m2.2b"><apply id="S3.SS2.SSS1.p3.2.m2.2.2.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p3.2.m2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.2"><csymbol cd="latexml" id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1">?</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.2.m2.2c">\left[\kern-1.49994pt\left[?\right]\kern-1.49994pt\right]</annotation></semantics></math> encodes the end of question. In the training phase, we augment the question word sequence with the corresponding ground truth answer sequence <math id="S3.SS2.SSS1.p3.3.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.SS2.SSS1.p3.3.m3.1a"><mi id="S3.SS2.SSS1.p3.3.m3.1.1" xref="S3.SS2.SSS1.p3.3.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.3.m3.1b"><ci id="S3.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.3.m3.1c">a</annotation></semantics></math>, <span id="S3.SS2.SSS1.p3.7.2" class="ltx_text ltx_font_italic">i.e.</span> <math id="S3.SS2.SSS1.p3.4.m4.2" class="ltx_Math" alttext="\widehat{q}:=[q,a]" display="inline"><semantics id="S3.SS2.SSS1.p3.4.m4.2a"><mrow id="S3.SS2.SSS1.p3.4.m4.2.3" xref="S3.SS2.SSS1.p3.4.m4.2.3.cmml"><mover accent="true" id="S3.SS2.SSS1.p3.4.m4.2.3.2" xref="S3.SS2.SSS1.p3.4.m4.2.3.2.cmml"><mi id="S3.SS2.SSS1.p3.4.m4.2.3.2.2" xref="S3.SS2.SSS1.p3.4.m4.2.3.2.2.cmml">q</mi><mo id="S3.SS2.SSS1.p3.4.m4.2.3.2.1" xref="S3.SS2.SSS1.p3.4.m4.2.3.2.1.cmml">^</mo></mover><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS1.p3.4.m4.2.3.1" xref="S3.SS2.SSS1.p3.4.m4.2.3.1.cmml">:=</mo><mrow id="S3.SS2.SSS1.p3.4.m4.2.3.3.2" xref="S3.SS2.SSS1.p3.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.4.m4.2.3.3.2.1" xref="S3.SS2.SSS1.p3.4.m4.2.3.3.1.cmml">[</mo><mi id="S3.SS2.SSS1.p3.4.m4.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.cmml">q</mi><mo id="S3.SS2.SSS1.p3.4.m4.2.3.3.2.2" xref="S3.SS2.SSS1.p3.4.m4.2.3.3.1.cmml">,</mo><mi id="S3.SS2.SSS1.p3.4.m4.2.2" xref="S3.SS2.SSS1.p3.4.m4.2.2.cmml">a</mi><mo stretchy="false" id="S3.SS2.SSS1.p3.4.m4.2.3.3.2.3" xref="S3.SS2.SSS1.p3.4.m4.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.4.m4.2b"><apply id="S3.SS2.SSS1.p3.4.m4.2.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.2.3"><csymbol cd="latexml" id="S3.SS2.SSS1.p3.4.m4.2.3.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.2.3.1">assign</csymbol><apply id="S3.SS2.SSS1.p3.4.m4.2.3.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.2.3.2"><ci id="S3.SS2.SSS1.p3.4.m4.2.3.2.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.2.3.2.1">^</ci><ci id="S3.SS2.SSS1.p3.4.m4.2.3.2.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.2.3.2.2">𝑞</ci></apply><interval closure="closed" id="S3.SS2.SSS1.p3.4.m4.2.3.3.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.2.3.3.2"><ci id="S3.SS2.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1">𝑞</ci><ci id="S3.SS2.SSS1.p3.4.m4.2.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.4.m4.2c">\widehat{q}:=[q,a]</annotation></semantics></math>. During the test phase, at <math id="S3.SS2.SSS1.p3.5.m5.1" class="ltx_Math" alttext="t^{th}" display="inline"><semantics id="S3.SS2.SSS1.p3.5.m5.1a"><msup id="S3.SS2.SSS1.p3.5.m5.1.1" xref="S3.SS2.SSS1.p3.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p3.5.m5.1.1.2" xref="S3.SS2.SSS1.p3.5.m5.1.1.2.cmml">t</mi><mrow id="S3.SS2.SSS1.p3.5.m5.1.1.3" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.cmml"><mi id="S3.SS2.SSS1.p3.5.m5.1.1.3.2" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p3.5.m5.1.1.3.1" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS1.p3.5.m5.1.1.3.3" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.5.m5.1b"><apply id="S3.SS2.SSS1.p3.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p3.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.2">𝑡</ci><apply id="S3.SS2.SSS1.p3.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.3"><times id="S3.SS2.SSS1.p3.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.1"></times><ci id="S3.SS2.SSS1.p3.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.2">𝑡</ci><ci id="S3.SS2.SSS1.p3.5.m5.1.1.3.3.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.5.m5.1c">t^{th}</annotation></semantics></math> time step we augment question <math id="S3.SS2.SSS1.p3.6.m6.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.SSS1.p3.6.m6.1a"><mi id="S3.SS2.SSS1.p3.6.m6.1.1" xref="S3.SS2.SSS1.p3.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.6.m6.1b"><ci id="S3.SS2.SSS1.p3.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.6.m6.1c">q</annotation></semantics></math>, with previously predicted answer words <math id="S3.SS2.SSS1.p3.7.m7.5" class="ltx_Math" alttext="{\widehat{q}_{t}}:=[q,{\widehat{a}_{1,...,t-1}}]" display="inline"><semantics id="S3.SS2.SSS1.p3.7.m7.5a"><mrow id="S3.SS2.SSS1.p3.7.m7.5.5" xref="S3.SS2.SSS1.p3.7.m7.5.5.cmml"><msub id="S3.SS2.SSS1.p3.7.m7.5.5.3" xref="S3.SS2.SSS1.p3.7.m7.5.5.3.cmml"><mover accent="true" id="S3.SS2.SSS1.p3.7.m7.5.5.3.2" xref="S3.SS2.SSS1.p3.7.m7.5.5.3.2.cmml"><mi id="S3.SS2.SSS1.p3.7.m7.5.5.3.2.2" xref="S3.SS2.SSS1.p3.7.m7.5.5.3.2.2.cmml">q</mi><mo id="S3.SS2.SSS1.p3.7.m7.5.5.3.2.1" xref="S3.SS2.SSS1.p3.7.m7.5.5.3.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS1.p3.7.m7.5.5.3.3" xref="S3.SS2.SSS1.p3.7.m7.5.5.3.3.cmml">t</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS1.p3.7.m7.5.5.2" xref="S3.SS2.SSS1.p3.7.m7.5.5.2.cmml">:=</mo><mrow id="S3.SS2.SSS1.p3.7.m7.5.5.1.1" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.7.m7.5.5.1.1.2" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.2.cmml">[</mo><mi id="S3.SS2.SSS1.p3.7.m7.4.4" xref="S3.SS2.SSS1.p3.7.m7.4.4.cmml">q</mi><mo id="S3.SS2.SSS1.p3.7.m7.5.5.1.1.3" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.2.cmml">,</mo><msub id="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.cmml"><mover accent="true" id="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.2" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.2.2" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.2.2.cmml">a</mi><mo id="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.2.1" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.SSS1.p3.7.m7.3.3.3.3" xref="S3.SS2.SSS1.p3.7.m7.3.3.3.4.cmml"><mn id="S3.SS2.SSS1.p3.7.m7.1.1.1.1" xref="S3.SS2.SSS1.p3.7.m7.1.1.1.1.cmml">1</mn><mo id="S3.SS2.SSS1.p3.7.m7.3.3.3.3.2" xref="S3.SS2.SSS1.p3.7.m7.3.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS1.p3.7.m7.2.2.2.2" xref="S3.SS2.SSS1.p3.7.m7.2.2.2.2.cmml">…</mi><mo id="S3.SS2.SSS1.p3.7.m7.3.3.3.3.3" xref="S3.SS2.SSS1.p3.7.m7.3.3.3.4.cmml">,</mo><mrow id="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1" xref="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.cmml"><mi id="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.2" xref="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.2.cmml">t</mi><mo id="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.1" xref="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.1.cmml">−</mo><mn id="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.3" xref="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.3.cmml">1</mn></mrow></mrow></msub><mo stretchy="false" id="S3.SS2.SSS1.p3.7.m7.5.5.1.1.4" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.7.m7.5b"><apply id="S3.SS2.SSS1.p3.7.m7.5.5.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5"><csymbol cd="latexml" id="S3.SS2.SSS1.p3.7.m7.5.5.2.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.2">assign</csymbol><apply id="S3.SS2.SSS1.p3.7.m7.5.5.3.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.7.m7.5.5.3.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.3">subscript</csymbol><apply id="S3.SS2.SSS1.p3.7.m7.5.5.3.2.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.3.2"><ci id="S3.SS2.SSS1.p3.7.m7.5.5.3.2.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.3.2.1">^</ci><ci id="S3.SS2.SSS1.p3.7.m7.5.5.3.2.2.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.3.2.2">𝑞</ci></apply><ci id="S3.SS2.SSS1.p3.7.m7.5.5.3.3.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.3.3">𝑡</ci></apply><interval closure="closed" id="S3.SS2.SSS1.p3.7.m7.5.5.1.2.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.1"><ci id="S3.SS2.SSS1.p3.7.m7.4.4.cmml" xref="S3.SS2.SSS1.p3.7.m7.4.4">𝑞</ci><apply id="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.2"><ci id="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.2.1">^</ci><ci id="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p3.7.m7.5.5.1.1.1.2.2">𝑎</ci></apply><list id="S3.SS2.SSS1.p3.7.m7.3.3.3.4.cmml" xref="S3.SS2.SSS1.p3.7.m7.3.3.3.3"><cn type="integer" id="S3.SS2.SSS1.p3.7.m7.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.1.1.1.1">1</cn><ci id="S3.SS2.SSS1.p3.7.m7.2.2.2.2.cmml" xref="S3.SS2.SSS1.p3.7.m7.2.2.2.2">…</ci><apply id="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1"><minus id="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.1"></minus><ci id="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.2.cmml" xref="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.3.cmml" xref="S3.SS2.SSS1.p3.7.m7.3.3.3.3.1.3">1</cn></apply></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.7.m7.5c">{\widehat{q}_{t}}:=[q,{\widehat{a}_{1,...,t-1}}]</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Loss function</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.1" class="ltx_p">All the parameters are jointly learned with cross-entropy loss. The output predictions that occur before the ending question mark <math id="S3.SS2.SSS2.p1.1.m1.2" class="ltx_Math" alttext="\left[\kern-1.49994pt\left[?\right]\kern-1.49994pt\right]" display="inline"><semantics id="S3.SS2.SSS2.p1.1.m1.2a"><mrow id="S3.SS2.SSS2.p1.1.m1.2.2.1" xref="S3.SS2.SSS2.p1.1.m1.2.2.2.cmml"><mo id="S3.SS2.SSS2.p1.1.m1.2.2.1.2" xref="S3.SS2.SSS2.p1.1.m1.2.2.2.1.cmml">[</mo><mrow id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.cmml"><mo id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.2.1" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.1.cmml">[</mo><mi mathvariant="normal" id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">?</mi><mo id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.2.2" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.1.cmml">]</mo></mrow><mo id="S3.SS2.SSS2.p1.1.m1.2.2.1.3" xref="S3.SS2.SSS2.p1.1.m1.2.2.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.2b"><apply id="S3.SS2.SSS2.p1.1.m1.2.2.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p1.1.m1.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.2"><csymbol cd="latexml" id="S3.SS2.SSS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.1.1.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">?</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.2c">\left[\kern-1.49994pt\left[?\right]\kern-1.49994pt\right]</annotation></semantics></math> are excluded from the loss computation, so that the model is solely penalized based on the predicted answer words.</p>
</div>
<div id="S3.SS2.SSS2.p2" class="ltx_para">
<p id="S3.SS2.SSS2.p2.1" class="ltx_p">Motivated by the recent success of GoogLeNet, We adopt a multi-task training strategy for learning the parameters of our network.
Specifically, in additional to the question answering LSTM, we add a “Language Only” loss layer on the Language LSTM, and an “Episode Only” loss layer on the Compositional Memory.
These two auxiliary loss functions are added during training to improve the performance, and they are removed during testing.</p>
</div>
</section>
<section id="S3.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Implementation</h4>

<div id="S3.SS2.SSS3.p1" class="ltx_para">
<p id="S3.SS2.SSS3.p1.1" class="ltx_p">We implemented our end-to-end VQA network using Caffe<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://caffe.berkeleyvision.org/</span></span></span></span>. The CNN models are pre-trained, and then fine-tuned in our recurrent network training. The source code of our implementation will be available in public.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We test our approach on two large data sets, namely, DAQUAR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and MSCOCO-VQA<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://www.visualqa.org</span></span></span></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
In the experiments on these two data sets, our method outperforms the state of the arts in different well recognized metrics.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">DAQUAR</span> contains 12,468 human question answer pairs on 1,449 images of indoor scene. The training set contains 795 images and 6,793 question answer pairs, and the testing set contains 654 images and 5,675 question answer pairs.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">We run experiments for the full dataset with all classes, instead of their “reduced set” where the output space is restricted to only 37 object categories and 25 test images in total.
This is because the full dataset is much more challenging and the results are more meaningful in statistics.
The performance is reported using the “Multiple Answers” category but the answers are generated using open-ended approach.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">MSCOCO-VQA</span> is the latest VQA dataset that contains open-ended questions about images.
This dataset contains 369,861 questions and 3,698,610 ground truth answers based on 123,287 MSCOCO images. These questions and answers are sentence-based and open-ended.
The training and testing split follows MSCOCO-VQA official split. Specifically, we use 82,783 images for training and 40,504 validation images for testing.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/1511.05676/assets/examples-daquar.jpg" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="651" height="412" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Examples of questions and answers on DAQUAR. Ground truth answers are colored in blue, our predicted answers in red and answers of state-of-the-art method in green. a)-d) are correct examples, and e)-f) are failure cases.</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Evaluation criteria</h3>

<section id="S4.SS2.SSS0.P0.SPx1" class="ltx_subparagraph">
<h5 class="ltx_title ltx_title_subparagraph">DAQUAR</h5>

<div id="S4.SS2.SSS0.P0.SPx1.p1" class="ltx_para">
<p id="S4.SS2.SSS0.P0.SPx1.p1.1" class="ltx_p">On the DARQUAR dataset, we use the Wu-Palmer Similarity (WUPS) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> score at different thresholds for comparison.
There are three metrics: Standard Metric, Average Consensus Metric and Min Consensus Metric. The Standard Metric is the basic score. The last two metrics are used to study the effects of consensus in question answering tasks.
Please refer to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> for the details.</p>
</div>
</section>
<section id="S4.SS2.SSS0.P0.SPx2" class="ltx_subparagraph">
<h5 class="ltx_title ltx_title_subparagraph">MSCOCO-VQA</h5>

<div id="S4.SS2.SSS0.P0.SPx2.p1" class="ltx_para">
<p id="S4.SS2.SSS0.P0.SPx2.p1.1" class="ltx_p">On the MSCOCO-VQA dataset, we use the evaluation criteria provided by the organizers.
For the open-ended tasks, the generated answers are evaluated using accuracy metric. It is computed as the percentage of answers that exactly agree with the ground truth provided by human. Please refer to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> for details.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Experimental settings</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.2" class="ltx_p">We choose AlexNet and GoogLeNet in our experiments, respectively.
For AlexNet, the region features are from Pool5 layer. For GoogLeNet we use the inception_poo5b/output layer.
That means our Compositional Memory processes flattened <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="36" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mn id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">36</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><cn type="integer" id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">36</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">36</annotation></semantics></math> regions for AlexNet, and <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="49" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mn id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">49</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><cn type="integer" id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">49</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">49</annotation></semantics></math> for GoogLeNet.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.2" class="ltx_p">In our current implementation, the parameters of region-LSTMs and <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\alpha</annotation></semantics></math> gates in Compositional Memory are shared across regions, therefore the computational burden is minimal. However, as regions have to store their respective memory states, the storage space is more than traditional LSTM. In our experiments, the dimension of region inputs <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">d</annotation></semantics></math> is 1024 for GoogLeNet and 256 for AlexNet. The dimension of the episodes is set to 200 for all LSTMs (including our Compositional Memory) on the DAQUAR dataset and the MSCOCO-VQA.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">We used separate dictionaries for training and testing. To generate the dictionary, we first remove the punctuation marks, except those used in timing and measurements, separate them and convert them to lower cases.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p">We stop our training procedure after 100,000 iterations. The base learning rate is set to be 0.01.
During training, it takes about 0.4 sec for one iteration on GTX Nvidia 780.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Results on DAQUAR</h3>

<section id="S4.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.1 </span>Examples</h4>

<div id="S4.SS4.SSS1.p1" class="ltx_para">
<p id="S4.SS4.SSS1.p1.1" class="ltx_p">We first show some examples of the proposed method.
Figure <a href="#S4.F5" title="Figure 5 ‣ 4.1 Datasets ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>a-<a href="#S4.F5" title="Figure 5 ‣ 4.1 Datasets ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>d show some correct examples and Figure <a href="#S4.F5" title="Figure 5 ‣ 4.1 Datasets ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>e-<a href="#S4.F5" title="Figure 5 ‣ 4.1 Datasets ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>f are failure cases.
These examples demonstrate the effectiveness of the local features.</p>
</div>
<div id="S4.SS4.SSS1.p2" class="ltx_para">
<p id="S4.SS4.SSS1.p2.1" class="ltx_p">When questions are sophisticated and location dependent, local features help most.
For example (Figure <a href="#S4.F5" title="Figure 5 ‣ 4.1 Datasets ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>a and Figure <a href="#S4.F5" title="Figure 5 ‣ 4.1 Datasets ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>c), the object name and the color cannot be easily obtained without the focus of the local region.
Take Figure <a href="#S4.F5" title="Figure 5 ‣ 4.1 Datasets ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>d) for another example, the number of chairs need to be counted. These cannot happen without the help of the local feature information encoded in the episodes.</p>
</div>
<div id="S4.SS4.SSS1.p3" class="ltx_para">
<p id="S4.SS4.SSS1.p3.1" class="ltx_p">We also show some failure cases in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.1 Datasets ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>e) and  <a href="#S4.F5" title="Figure 5 ‣ 4.1 Datasets ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>f).
We observe that these are challenging cases, and even the human answers are not consistent.
Yet, our model is still able to find partially correct answers.
For example (Figure <a href="#S4.F5" title="Figure 5 ‣ 4.1 Datasets ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>e), while our answer does not fully match the ground truth, we provide the information that is much closer to the comparison methods.
It also should be noted that, although our answers may be incorrect (Figure <a href="#S4.F5" title="Figure 5 ‣ 4.1 Datasets ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>f), we can still see the answers being related to object near the ground-truth objects.
These answers, albeit wrong, still show that our regional feature episodes are useful and provide potentially meaningful answers.</p>
</div>
</section>
<section id="S4.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.2 </span>Comparisons with state-of-the-art methods</h4>

<div id="S4.SS4.SSS2.p1" class="ltx_para">
<p id="S4.SS4.SSS2.p1.1" class="ltx_p">We compare our proposed model with <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
Because they used different CNN methods, we tested both AlexNet and GoogLeNet.
The performance on “Multiple Answers” (“Open-ended”) category are shown in Table <a href="#S4.T1" title="Table 1 ‣ 4.4.2 Comparisons with state-of-the-art methods ‣ 4.4 Results on DAQUAR ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparisons on full DAQUAR dataset, “Multiple Answers” category. The numbers are shown in percentage.</figcaption>
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" rowspan="2"></th>
<td id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T1.1.1.1.2.1" class="ltx_text">Accuracy</span></td>
<td id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">WUPS</td>
</tr>
<tr id="S4.T1.1.2.2" class="ltx_tr">
<td id="S4.T1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">@0.9</td>
<td id="S4.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">@0.0</td>
</tr>
<tr id="S4.T1.1.3.3" class="ltx_tr">
<th id="S4.T1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="4"><span id="S4.T1.1.3.3.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Standard Metric</span></th>
</tr>
<tr id="S4.T1.1.4.4" class="ltx_tr">
<th id="S4.T1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Malinowski et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</th>
<td id="S4.T1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">7.86</td>
<td id="S4.T1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11.86</td>
<td id="S4.T1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">38.79</td>
</tr>
<tr id="S4.T1.1.5.5" class="ltx_tr">
<th id="S4.T1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Ask-Neurons <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</th>
<td id="S4.T1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">17.57</td>
<td id="S4.T1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">23.31</td>
<td id="S4.T1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">57.49</td>
</tr>
<tr id="S4.T1.1.6.6" class="ltx_tr">
<th id="S4.T1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Our Model (AlexNet)</th>
<td id="S4.T1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">21.92</td>
<td id="S4.T1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">27.67</td>
<td id="S4.T1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.6.6.4.1" class="ltx_text ltx_font_bold">62.74</span></td>
</tr>
<tr id="S4.T1.1.7.7" class="ltx_tr">
<th id="S4.T1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Our Model (GoogleNet)</th>
<td id="S4.T1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.7.7.2.1" class="ltx_text ltx_font_bold">24.37</span></td>
<td id="S4.T1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.7.7.3.1" class="ltx_text ltx_font_bold">29.77</span></td>
<td id="S4.T1.1.7.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">62.73</td>
</tr>
<tr id="S4.T1.1.8.8" class="ltx_tr">
<th id="S4.T1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Human Answers</th>
<td id="S4.T1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">50.20</td>
<td id="S4.T1.1.8.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">50.82</td>
<td id="S4.T1.1.8.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.27</td>
</tr>
<tr id="S4.T1.1.9.9" class="ltx_tr">
<th id="S4.T1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="4"><span id="S4.T1.1.9.9.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Average Consensus Metric</span></th>
</tr>
<tr id="S4.T1.1.10.10" class="ltx_tr">
<th id="S4.T1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Ask-Neurons <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</th>
<td id="S4.T1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11.31</td>
<td id="S4.T1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">18.62</td>
<td id="S4.T1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">53.21</td>
</tr>
<tr id="S4.T1.1.11.11" class="ltx_tr">
<th id="S4.T1.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Our Model (AlexNet)</th>
<td id="S4.T1.1.11.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">14.72</td>
<td id="S4.T1.1.11.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">22.58</td>
<td id="S4.T1.1.11.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.11.11.4.1" class="ltx_text ltx_font_bold">58.17</span></td>
</tr>
<tr id="S4.T1.1.12.12" class="ltx_tr">
<th id="S4.T1.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Our Model (GoogleNet)</th>
<td id="S4.T1.1.12.12.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.12.12.2.1" class="ltx_text ltx_font_bold">16.29</span></td>
<td id="S4.T1.1.12.12.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.12.12.3.1" class="ltx_text ltx_font_bold">23.95</span></td>
<td id="S4.T1.1.12.12.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">57.68</td>
</tr>
<tr id="S4.T1.1.13.13" class="ltx_tr">
<th id="S4.T1.1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="4"><span id="S4.T1.1.13.13.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Min Consensus Metric</span></th>
</tr>
<tr id="S4.T1.1.14.14" class="ltx_tr">
<th id="S4.T1.1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Ask-Neurons <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</th>
<td id="S4.T1.1.14.14.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">22.74</td>
<td id="S4.T1.1.14.14.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">30.54</td>
<td id="S4.T1.1.14.14.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">68.17</td>
</tr>
<tr id="S4.T1.1.15.15" class="ltx_tr">
<th id="S4.T1.1.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Our Model (AlexNet)</th>
<td id="S4.T1.1.15.15.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">29.48</td>
<td id="S4.T1.1.15.15.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">37.60</td>
<td id="S4.T1.1.15.15.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.15.15.4.1" class="ltx_text ltx_font_bold">75.16</span></td>
</tr>
<tr id="S4.T1.1.16.16" class="ltx_tr">
<th id="S4.T1.1.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Our Model (GoogleNet)</th>
<td id="S4.T1.1.16.16.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T1.1.16.16.2.1" class="ltx_text ltx_font_bold">31.52</span></td>
<td id="S4.T1.1.16.16.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T1.1.16.16.3.1" class="ltx_text ltx_font_bold">39.30</span></td>
<td id="S4.T1.1.16.16.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">74.51</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS4.SSS2.p2" class="ltx_para">
<p id="S4.SS4.SSS2.p2.5" class="ltx_p">The statistical results shows that the performance of our model substantially is better than the state of the art. On the WUPS<math id="S4.SS4.SSS2.p2.1.m1.1" class="ltx_Math" alttext="@" display="inline"><semantics id="S4.SS4.SSS2.p2.1.m1.1a"><mi mathvariant="normal" id="S4.SS4.SSS2.p2.1.m1.1.1" xref="S4.SS4.SSS2.p2.1.m1.1.1.cmml">@</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.1.m1.1b"><ci id="S4.SS4.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1">@</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.1.m1.1c">@</annotation></semantics></math>0.9, our method is <math id="S4.SS4.SSS2.p2.2.m2.1" class="ltx_Math" alttext="6\%" display="inline"><semantics id="S4.SS4.SSS2.p2.2.m2.1a"><mrow id="S4.SS4.SSS2.p2.2.m2.1.1" xref="S4.SS4.SSS2.p2.2.m2.1.1.cmml"><mn id="S4.SS4.SSS2.p2.2.m2.1.1.2" xref="S4.SS4.SSS2.p2.2.m2.1.1.2.cmml">6</mn><mo id="S4.SS4.SSS2.p2.2.m2.1.1.1" xref="S4.SS4.SSS2.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.2.m2.1b"><apply id="S4.SS4.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS4.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS4.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1.2">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.2.m2.1c">6\%</annotation></semantics></math> higher (from <math id="S4.SS4.SSS2.p2.3.m3.1" class="ltx_Math" alttext="23.31\%" display="inline"><semantics id="S4.SS4.SSS2.p2.3.m3.1a"><mrow id="S4.SS4.SSS2.p2.3.m3.1.1" xref="S4.SS4.SSS2.p2.3.m3.1.1.cmml"><mn id="S4.SS4.SSS2.p2.3.m3.1.1.2" xref="S4.SS4.SSS2.p2.3.m3.1.1.2.cmml">23.31</mn><mo id="S4.SS4.SSS2.p2.3.m3.1.1.1" xref="S4.SS4.SSS2.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.3.m3.1b"><apply id="S4.SS4.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS4.SSS2.p2.3.m3.1.1"><csymbol cd="latexml" id="S4.SS4.SSS2.p2.3.m3.1.1.1.cmml" xref="S4.SS4.SSS2.p2.3.m3.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.SSS2.p2.3.m3.1.1.2.cmml" xref="S4.SS4.SSS2.p2.3.m3.1.1.2">23.31</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.3.m3.1c">23.31\%</annotation></semantics></math> to <math id="S4.SS4.SSS2.p2.4.m4.1" class="ltx_Math" alttext="29.77\%" display="inline"><semantics id="S4.SS4.SSS2.p2.4.m4.1a"><mrow id="S4.SS4.SSS2.p2.4.m4.1.1" xref="S4.SS4.SSS2.p2.4.m4.1.1.cmml"><mn id="S4.SS4.SSS2.p2.4.m4.1.1.2" xref="S4.SS4.SSS2.p2.4.m4.1.1.2.cmml">29.77</mn><mo id="S4.SS4.SSS2.p2.4.m4.1.1.1" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.4.m4.1b"><apply id="S4.SS4.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1"><csymbol cd="latexml" id="S4.SS4.SSS2.p2.4.m4.1.1.1.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.SSS2.p2.4.m4.1.1.2.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.2">29.77</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.4.m4.1c">29.77\%</annotation></semantics></math>).
When we lower the threshold in the WUPS, we are <math id="S4.SS4.SSS2.p2.5.m5.1" class="ltx_Math" alttext="5.25\%" display="inline"><semantics id="S4.SS4.SSS2.p2.5.m5.1a"><mrow id="S4.SS4.SSS2.p2.5.m5.1.1" xref="S4.SS4.SSS2.p2.5.m5.1.1.cmml"><mn id="S4.SS4.SSS2.p2.5.m5.1.1.2" xref="S4.SS4.SSS2.p2.5.m5.1.1.2.cmml">5.25</mn><mo id="S4.SS4.SSS2.p2.5.m5.1.1.1" xref="S4.SS4.SSS2.p2.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.5.m5.1b"><apply id="S4.SS4.SSS2.p2.5.m5.1.1.cmml" xref="S4.SS4.SSS2.p2.5.m5.1.1"><csymbol cd="latexml" id="S4.SS4.SSS2.p2.5.m5.1.1.1.cmml" xref="S4.SS4.SSS2.p2.5.m5.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.SSS2.p2.5.m5.1.1.2.cmml" xref="S4.SS4.SSS2.p2.5.m5.1.1.2">5.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.5.m5.1c">5.25\%</annotation></semantics></math> superior than the state of the art.</p>
</div>
<div id="S4.SS4.SSS2.p3" class="ltx_para">
<p id="S4.SS4.SSS2.p3.2" class="ltx_p">In other two measurements, where “consensus” is calculated on the answers from multiple subjects, our method also outperforms the state of the art <math id="S4.SS4.SSS2.p3.1.m1.1" class="ltx_Math" alttext="2\%" display="inline"><semantics id="S4.SS4.SSS2.p3.1.m1.1a"><mrow id="S4.SS4.SSS2.p3.1.m1.1.1" xref="S4.SS4.SSS2.p3.1.m1.1.1.cmml"><mn id="S4.SS4.SSS2.p3.1.m1.1.1.2" xref="S4.SS4.SSS2.p3.1.m1.1.1.2.cmml">2</mn><mo id="S4.SS4.SSS2.p3.1.m1.1.1.1" xref="S4.SS4.SSS2.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p3.1.m1.1b"><apply id="S4.SS4.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS4.SSS2.p3.1.m1.1.1"><csymbol cd="latexml" id="S4.SS4.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS4.SSS2.p3.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS4.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS4.SSS2.p3.1.m1.1.1.2">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p3.1.m1.1c">2\%</annotation></semantics></math> to <math id="S4.SS4.SSS2.p3.2.m2.1" class="ltx_Math" alttext="7\%" display="inline"><semantics id="S4.SS4.SSS2.p3.2.m2.1a"><mrow id="S4.SS4.SSS2.p3.2.m2.1.1" xref="S4.SS4.SSS2.p3.2.m2.1.1.cmml"><mn id="S4.SS4.SSS2.p3.2.m2.1.1.2" xref="S4.SS4.SSS2.p3.2.m2.1.1.2.cmml">7</mn><mo id="S4.SS4.SSS2.p3.2.m2.1.1.1" xref="S4.SS4.SSS2.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p3.2.m2.1b"><apply id="S4.SS4.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS4.SSS2.p3.2.m2.1.1"><csymbol cd="latexml" id="S4.SS4.SSS2.p3.2.m2.1.1.1.cmml" xref="S4.SS4.SSS2.p3.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS4.SSS2.p3.2.m2.1.1.2.cmml" xref="S4.SS4.SSS2.p3.2.m2.1.1.2">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p3.2.m2.1c">7\%</annotation></semantics></math>.
This further confirms our system is more accurate and robust.</p>
</div>
<div id="S4.SS4.SSS2.p4" class="ltx_para">
<p id="S4.SS4.SSS2.p4.1" class="ltx_p">We also find that our method has better performance when GoogLeNet is used in our framework, although the difference is marginally noticeable.</p>
</div>
</section>
<section id="S4.SS4.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.3 </span>Effectiveness of Compositional Memory module</h4>

<div id="S4.SS4.SSS3.p1" class="ltx_para">
<p id="S4.SS4.SSS3.p1.1" class="ltx_p">We further present our study on the effectiveness of Compositional Memory and the Language LSTM in our VQA system.
Specifically, we show the comparison in performance when we toggle on and off these components.</p>
</div>
<div id="S4.SS4.SSS3.p2" class="ltx_para">
<p id="S4.SS4.SSS3.p2.1" class="ltx_p">We consider the configuration where all modules are used as the “full model”, and also name the configuration of traditional approach (Fig. <a href="#S2.F1" title="Figure 1 ‣ LSTM for VQA ‣ 2 Related Work ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) as “baseline”.
We then introduce three variants, where only language is used (“Factorized Language Only”), only Compositional Memory is used (“Episodes Only”), and both are used together (“Language+Episodes”).</p>
</div>
<div id="S4.SS4.SSS3.p3" class="ltx_para">
<p id="S4.SS4.SSS3.p3.1" class="ltx_p">The statistic results are shown in Figure <a href="#S4.F6" title="Figure 6 ‣ 4.4.3 Effectiveness of Compositional Memory module ‣ 4.4 Results on DAQUAR ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> and Table <a href="#S4.T2" title="Table 2 ‣ 4.4.3 Effectiveness of Compositional Memory module ‣ 4.4 Results on DAQUAR ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
One can easily see that, the performance drops seriously when all the proposed memory are toggled off.The episodes provide more information than the language, because it contains visual information from local image patch.
All together they achieve the score that each of them cannot reach.
This demonstrates that our Compositional Memory module contains critical information for visual question answering and the importance of the Language LSTM.</p>
</div>
<div id="S4.SS4.SSS3.p4" class="ltx_para">
<p id="S4.SS4.SSS3.p4.2" class="ltx_p">Using regional information does not rule out the importance of the visual context.
This holistic image features describes the abstraction of image.
One can see that the performance decreases, for example, from <math id="S4.SS4.SSS3.p4.1.m1.1" class="ltx_Math" alttext="24.37\%" display="inline"><semantics id="S4.SS4.SSS3.p4.1.m1.1a"><mrow id="S4.SS4.SSS3.p4.1.m1.1.1" xref="S4.SS4.SSS3.p4.1.m1.1.1.cmml"><mn id="S4.SS4.SSS3.p4.1.m1.1.1.2" xref="S4.SS4.SSS3.p4.1.m1.1.1.2.cmml">24.37</mn><mo id="S4.SS4.SSS3.p4.1.m1.1.1.1" xref="S4.SS4.SSS3.p4.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS3.p4.1.m1.1b"><apply id="S4.SS4.SSS3.p4.1.m1.1.1.cmml" xref="S4.SS4.SSS3.p4.1.m1.1.1"><csymbol cd="latexml" id="S4.SS4.SSS3.p4.1.m1.1.1.1.cmml" xref="S4.SS4.SSS3.p4.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.SSS3.p4.1.m1.1.1.2.cmml" xref="S4.SS4.SSS3.p4.1.m1.1.1.2">24.37</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS3.p4.1.m1.1c">24.37\%</annotation></semantics></math> to <math id="S4.SS4.SSS3.p4.2.m2.1" class="ltx_Math" alttext="23.15\%" display="inline"><semantics id="S4.SS4.SSS3.p4.2.m2.1a"><mrow id="S4.SS4.SSS3.p4.2.m2.1.1" xref="S4.SS4.SSS3.p4.2.m2.1.1.cmml"><mn id="S4.SS4.SSS3.p4.2.m2.1.1.2" xref="S4.SS4.SSS3.p4.2.m2.1.1.2.cmml">23.15</mn><mo id="S4.SS4.SSS3.p4.2.m2.1.1.1" xref="S4.SS4.SSS3.p4.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS3.p4.2.m2.1b"><apply id="S4.SS4.SSS3.p4.2.m2.1.1.cmml" xref="S4.SS4.SSS3.p4.2.m2.1.1"><csymbol cd="latexml" id="S4.SS4.SSS3.p4.2.m2.1.1.1.cmml" xref="S4.SS4.SSS3.p4.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.SSS3.p4.2.m2.1.1.2.cmml" xref="S4.SS4.SSS3.p4.2.m2.1.1.2">23.15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS3.p4.2.m2.1c">23.15\%</annotation></semantics></math> on standard accuracy without the context.</p>
</div>
<div id="S4.SS4.SSS3.p5" class="ltx_para">
<p id="S4.SS4.SSS3.p5.2" class="ltx_p">Table <a href="#S4.T2" title="Table 2 ‣ 4.4.3 Effectiveness of Compositional Memory module ‣ 4.4 Results on DAQUAR ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the performance under different threshold in the WUPS metric.
For example, it is over 4% better than the “Language Only” variant.
Since language semantics are important for answering questions and logical reasoning, while regional contents are more critical for answering questions about the existence of objects in image, Their fusion can further improve the qualities of answers.
As shown in “Language+Episodes”, this fusion increases WUPS@0.9 from <math id="S4.SS4.SSS3.p5.1.m1.1" class="ltx_Math" alttext="25.77\%" display="inline"><semantics id="S4.SS4.SSS3.p5.1.m1.1a"><mrow id="S4.SS4.SSS3.p5.1.m1.1.1" xref="S4.SS4.SSS3.p5.1.m1.1.1.cmml"><mn id="S4.SS4.SSS3.p5.1.m1.1.1.2" xref="S4.SS4.SSS3.p5.1.m1.1.1.2.cmml">25.77</mn><mo id="S4.SS4.SSS3.p5.1.m1.1.1.1" xref="S4.SS4.SSS3.p5.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS3.p5.1.m1.1b"><apply id="S4.SS4.SSS3.p5.1.m1.1.1.cmml" xref="S4.SS4.SSS3.p5.1.m1.1.1"><csymbol cd="latexml" id="S4.SS4.SSS3.p5.1.m1.1.1.1.cmml" xref="S4.SS4.SSS3.p5.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.SSS3.p5.1.m1.1.1.2.cmml" xref="S4.SS4.SSS3.p5.1.m1.1.1.2">25.77</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS3.p5.1.m1.1c">25.77\%</annotation></semantics></math> to <math id="S4.SS4.SSS3.p5.2.m2.1" class="ltx_Math" alttext="28.73\%" display="inline"><semantics id="S4.SS4.SSS3.p5.2.m2.1a"><mrow id="S4.SS4.SSS3.p5.2.m2.1.1" xref="S4.SS4.SSS3.p5.2.m2.1.1.cmml"><mn id="S4.SS4.SSS3.p5.2.m2.1.1.2" xref="S4.SS4.SSS3.p5.2.m2.1.1.2.cmml">28.73</mn><mo id="S4.SS4.SSS3.p5.2.m2.1.1.1" xref="S4.SS4.SSS3.p5.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS3.p5.2.m2.1b"><apply id="S4.SS4.SSS3.p5.2.m2.1.1.cmml" xref="S4.SS4.SSS3.p5.2.m2.1.1"><csymbol cd="latexml" id="S4.SS4.SSS3.p5.2.m2.1.1.1.cmml" xref="S4.SS4.SSS3.p5.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS4.SSS3.p5.2.m2.1.1.2.cmml" xref="S4.SS4.SSS3.p5.2.m2.1.1.2">28.73</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS3.p5.2.m2.1c">28.73\%</annotation></semantics></math>.
With all components, our full model is consistently better than other variants.</p>
</div>
<div id="S4.SS4.SSS3.p6" class="ltx_para">
<p id="S4.SS4.SSS3.p6.1" class="ltx_p">As a conclusion, these three types of information are complementary and their combinations improve the solution of the VQA problem.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/1511.05676/assets/selfcomparisonaccuracy.jpg" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="290" height="171" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Comparisons of different variants of our model.</figcaption>
</figure>
<figure id="S4.F7" class="ltx_figure"><img src="/html/1511.05676/assets/examples-vqa.jpg" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="669" height="124" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Examples on MSCOCO-VQA. Ground truth answers are colored in blue, and our predicted answers in red.</figcaption>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>WUPS@R: Comparisons of different variants of our model.</figcaption>
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.3.1.1" class="ltx_tr">
<td id="S4.T2.3.1.1.1" class="ltx_td ltx_border_l ltx_border_t" rowspan="2"></td>
<td id="S4.T2.3.1.1.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="4"><span id="S4.T2.3.1.1.2.1" class="ltx_text" style="font-size:90%;">WUPS</span></td>
</tr>
<tr id="S4.T2.3.2.2" class="ltx_tr">
<td id="S4.T2.3.2.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.2.2.1.1" class="ltx_text" style="font-size:90%;">@0.9</span></td>
<td id="S4.T2.3.2.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.2.2.2.1" class="ltx_text" style="font-size:90%;">@0.7</span></td>
<td id="S4.T2.3.2.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.2.2.3.1" class="ltx_text" style="font-size:90%;">@0.5</span></td>
<td id="S4.T2.3.2.2.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.2.2.4.1" class="ltx_text" style="font-size:90%;">@0.0</span></td>
</tr>
<tr id="S4.T2.3.3.3" class="ltx_tr">
<td id="S4.T2.3.3.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.1.1" class="ltx_text" style="font-size:90%;">Baseline</span></td>
<td id="S4.T2.3.3.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.2.1" class="ltx_text" style="font-size:90%;">15.64</span></td>
<td id="S4.T2.3.3.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.1" class="ltx_text" style="font-size:90%;">36.12</span></td>
<td id="S4.T2.3.3.3.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.4.1" class="ltx_text" style="font-size:90%;">52.43</span></td>
<td id="S4.T2.3.3.3.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.5.1" class="ltx_text" style="font-size:90%;">54.41</span></td>
</tr>
<tr id="S4.T2.3.4.4" class="ltx_tr">
<td id="S4.T2.3.4.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.4.4.1.1" class="ltx_text" style="font-size:90%;">Factorized Language Only</span></td>
<td id="S4.T2.3.4.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.4.4.2.1" class="ltx_text" style="font-size:90%;">25.77</span></td>
<td id="S4.T2.3.4.4.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.4.4.3.1" class="ltx_text" style="font-size:90%;">47.90</span></td>
<td id="S4.T2.3.4.4.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.4.4.4.1" class="ltx_text" style="font-size:90%;">59.00</span></td>
<td id="S4.T2.3.4.4.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.4.4.5.1" class="ltx_text" style="font-size:90%;">59.52</span></td>
</tr>
<tr id="S4.T2.3.5.5" class="ltx_tr">
<td id="S4.T2.3.5.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.5.5.1.1" class="ltx_text" style="font-size:90%;">Episodes Only</span></td>
<td id="S4.T2.3.5.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T2.3.5.5.2.1" class="ltx_text" style="font-size:90%;">27.43</span></td>
<td id="S4.T2.3.5.5.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T2.3.5.5.3.1" class="ltx_text" style="font-size:90%;">49.92</span></td>
<td id="S4.T2.3.5.5.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T2.3.5.5.4.1" class="ltx_text" style="font-size:90%;">60.95</span></td>
<td id="S4.T2.3.5.5.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T2.3.5.5.5.1" class="ltx_text" style="font-size:90%;">61.35</span></td>
</tr>
<tr id="S4.T2.3.6.6" class="ltx_tr">
<td id="S4.T2.3.6.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.6.6.1.1" class="ltx_text" style="font-size:90%;">Language + Episodes</span></td>
<td id="S4.T2.3.6.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.6.6.2.1" class="ltx_text" style="font-size:90%;">28.73</span></td>
<td id="S4.T2.3.6.6.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.6.6.3.1" class="ltx_text" style="font-size:90%;">51.16</span></td>
<td id="S4.T2.3.6.6.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.6.6.4.1" class="ltx_text" style="font-size:90%;">61.28</span></td>
<td id="S4.T2.3.6.6.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.3.6.6.5.1" class="ltx_text" style="font-size:90%;">61.70</span></td>
</tr>
<tr id="S4.T2.3.7.7" class="ltx_tr">
<td id="S4.T2.3.7.7.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.7.7.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Full Model</span></td>
<td id="S4.T2.3.7.7.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T2.3.7.7.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">29.77</span></td>
<td id="S4.T2.3.7.7.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T2.3.7.7.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">52.64</span></td>
<td id="S4.T2.3.7.7.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T2.3.7.7.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">62.35</span></td>
<td id="S4.T2.3.7.7.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T2.3.7.7.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">62.73</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Results on MSCOCO-VQA</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">Compared to DAQUAR, MSCOCO-VQA is the latest VQA dataset. It is much larger and contains more scenes and question types that are not covered by DARQUAR.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.2" class="ltx_p">Possibly because this is the latest outcome, there are different ways of evaluating the performances and reporting the results.
For example, while the measurement of accuracy is well defined, the evaluation protocols are not standardized.
Some practitioners use the organizer’s previous release for training and validating, and further split the validation sets.
Only until recently the organizers release their <span id="S4.SS5.p2.2.1" class="ltx_text ltx_font_typewriter">test-dev</span> set online, however, there are still many ways of handling the input.
For example, the official version <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> selects the most frequent <math id="S4.SS5.p2.1.m1.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S4.SS5.p2.1.m1.1a"><mn id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.1b"><cn type="integer" id="S4.SS5.p2.1.m1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">1000</annotation></semantics></math> answers, which covers only <math id="S4.SS5.p2.2.m2.1" class="ltx_Math" alttext="82.67\%" display="inline"><semantics id="S4.SS5.p2.2.m2.1a"><mrow id="S4.SS5.p2.2.m2.1.1" xref="S4.SS5.p2.2.m2.1.1.cmml"><mn id="S4.SS5.p2.2.m2.1.1.2" xref="S4.SS5.p2.2.m2.1.1.2.cmml">82.67</mn><mo id="S4.SS5.p2.2.m2.1.1.1" xref="S4.SS5.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.2.m2.1b"><apply id="S4.SS5.p2.2.m2.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS5.p2.2.m2.1.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS5.p2.2.m2.1.1.2.cmml" xref="S4.SS5.p2.2.m2.1.1.2">82.67</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.2.m2.1c">82.67\%</annotation></semantics></math> of the answer set.
Different selections of dictionary can lead to fluctuations in the accuracy.
Finally, the tokenizers used in different practitioners may lead to other uncertainties in accuracy.</p>
</div>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.1" class="ltx_p">Due to the above concerns, we conclude that it is in the early stage of the evaluation, and would like to clearly outline our practices when readers examine the numbers.</p>
</div>
<div id="S4.SS5.p4" class="ltx_para">
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p">We used a naive tokenizer as specified in Sec. <a href="#S4.SS3" title="4.3 Experimental settings ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p">We used 13,880 words appeared in the training + validation answer set as our answer dictionary.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p">We report results on both the <span id="S4.I1.i3.p1.1.1" class="ltx_text ltx_font_typewriter">test-dev</span> and the full validation set.</p>
</div>
</li>
</ul>
</div>
<div id="S4.SS5.p5" class="ltx_para">
<p id="S4.SS5.p5.1" class="ltx_p">We first show results of our method in Fig.  <a href="#S4.F7" title="Figure 7 ‣ 4.4.3 Effectiveness of Compositional Memory module ‣ 4.4 Results on DAQUAR ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.
Compared to Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.1 Datasets ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, one can see that MSCOCO-VQA is more diversified.
More results are shown in Supplementary Materials.</p>
</div>
<section id="S4.SS5.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.5.1 </span>Statistical results</h4>

<div id="S4.SS5.SSS1.p1" class="ltx_para">
<p id="S4.SS5.SSS1.p1.1" class="ltx_p">MSCOCO-VQA is grouped to a number of categories based on the types of the questions, and the types of answers.
We show the statistics on both categories in this section.</p>
</div>
<section id="S4.SS5.SSS1.P0.SPx1" class="ltx_subparagraph">
<h5 class="ltx_title ltx_title_subparagraph">Answer type</h5>

<div id="S4.SS5.SSS1.P0.SPx1.p1" class="ltx_para">
<p id="S4.SS5.SSS1.P0.SPx1.p1.1" class="ltx_p">We report the overall accuracy and those of different answer types using both <span id="S4.SS5.SSS1.P0.SPx1.p1.1.1" class="ltx_text ltx_font_typewriter">text-dev</span> and the full validation set (Table <a href="#S4.T3" title="Table 3 ‣ Question type ‣ 4.5.1 Statistical results ‣ 4.5 Results on MSCOCO-VQA ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
Please note that we used a larger answer dictionary, which means potentially it is more difficult to deliver correct answers, but still our method achieved similar performance of the state of the art.</p>
</div>
<div id="S4.SS5.SSS1.P0.SPx1.p2" class="ltx_para">
<p id="S4.SS5.SSS1.P0.SPx1.p2.1" class="ltx_p">One can notice that the accuracy of simple answer type (<span id="S4.SS5.SSS1.P0.SPx1.p2.1.1" class="ltx_text ltx_font_italic">e.g.</span> “yes/no”) is very high, but the accuracies drop significantly when the answers become more sophisticated.
This indicates the potential issues and directions of our method.</p>
</div>
</section>
<section id="S4.SS5.SSS1.P0.SPx2" class="ltx_subparagraph">
<h5 class="ltx_title ltx_title_subparagraph">Question type</h5>

<div id="S4.SS5.SSS1.P0.SPx2.p1" class="ltx_para">
<p id="S4.SS5.SSS1.P0.SPx2.p1.1" class="ltx_p">We use validation set to report the accuracy of our method when question type varies (Figure <a href="#S4.F8" title="Figure 8 ‣ Question type ‣ 4.5.1 Statistical results ‣ 4.5 Results on MSCOCO-VQA ‣ 4 Experiments ‣ Compositional Memory for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>).
The colored bar chart and sorted according to the accuracy, with the numbers displayed next to the bars.</p>
</div>
<div id="S4.SS5.SSS1.P0.SPx2.p2" class="ltx_para">
<p id="S4.SS5.SSS1.P0.SPx2.p2.1" class="ltx_p">It is interesting to see a significant drop when the questions ascend from simple forms (<span id="S4.SS5.SSS1.P0.SPx2.p2.1.1" class="ltx_text ltx_font_italic">e.g.</span>, “is there?”) to complicated ones (<span id="S4.SS5.SSS1.P0.SPx2.p2.1.2" class="ltx_text ltx_font_italic">e.g.</span>, “what”,“how”).
This suggest that a practical VQA system needs to take this prior into consideration.</p>
</div>
<figure id="S4.F8" class="ltx_figure"><img src="/html/1511.05676/assets/per_type_accuracy.jpg" id="S4.F8.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="314" height="395" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Accuracy on the Open-ended task of MSCOCO-VQA (validation) for different question types.</figcaption>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results on MSCOCO-VQA (Open-ended). Red, blue and green are used to denote top 3. The baseline is <span id="S4.T3.2.1" class="ltx_text ltx_font_bold">LSTM Q+I</span> in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</figcaption>
<table id="S4.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.3.1.1" class="ltx_tr">
<th id="S4.T3.3.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"></th>
<td id="S4.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">All</td>
<td id="S4.T3.3.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Yes/No</td>
<td id="S4.T3.3.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Number</td>
<td id="S4.T3.3.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Other</td>
</tr>
<tr id="S4.T3.3.2.2" class="ltx_tr">
<th id="S4.T3.3.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Baseline</th>
<td id="S4.T3.3.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.2.2.2.1" class="ltx_text" style="color:#FF0000;">53.74</span></td>
<td id="S4.T3.3.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.2.2.3.1" class="ltx_text" style="color:#0000FF;">78.94</span></td>
<td id="S4.T3.3.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.2.2.4.1" class="ltx_text" style="color:#0000FF;">35.24</span></td>
<td id="S4.T3.3.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.2.2.5.1" class="ltx_text" style="color:#FF0000;">36.42</span></td>
</tr>
<tr id="S4.T3.3.3.3" class="ltx_tr">
<th id="S4.T3.3.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Ours (test-dev)</th>
<td id="S4.T3.3.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.3.3.2.1" class="ltx_text" style="color:#0000FF;">52.62</span></td>
<td id="S4.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.3.3.3.1" class="ltx_text" style="color:#00FF00;">78.33</span></td>
<td id="S4.T3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.3.3.4.1" class="ltx_text" style="color:#FF0000;">35.93</span></td>
<td id="S4.T3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.3.3.5.1" class="ltx_text" style="color:#0000FF;">34.46</span></td>
</tr>
<tr id="S4.T3.3.4.4" class="ltx_tr">
<th id="S4.T3.3.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Ours (val)</th>
<td id="S4.T3.3.4.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T3.3.4.4.2.1" class="ltx_text" style="color:#00FF00;">50.48</span></td>
<td id="S4.T3.3.4.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T3.3.4.4.3.1" class="ltx_text" style="color:#FF0000;">79.05</span></td>
<td id="S4.T3.3.4.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T3.3.4.4.4.1" class="ltx_text" style="color:#00FF00;">32.60</span></td>
<td id="S4.T3.3.4.4.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T3.3.4.4.5.1" class="ltx_text" style="color:#00FF00;">33.59</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper we propose to use the Compositional Memory as the core element in the VQA.
Our end-to-end approach is capable of dynamically extracting local the features.
The Long Short-Term Memory (LSTM) based approach fuses image regions and language, and generates the episodes that is effective for high level reasoning.
Our experiments on the latest public datasets suggest that our method has a superior performance.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
M. Malinowski, M. Rohrbach, and M. Fritz, “Ask your neurons: A neural-based
approach to answering questions about images,” in </span><span id="bib.bib1.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib1.3.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
M. Ren, R. Kiros, and R. Zemel, “Exploring models and data for image question
answering,” in </span><span id="bib.bib2.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib2.3.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
J. Donahue, L. A. Hendricks, S. Guadarrama, M. Rohrbach, S. Venugopalan,
K. Saenko, and T. Darrell, “Long-term recurrent convolutional networks for
visual recognition and description,” in </span><span id="bib.bib3.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib3.3.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
A. Karpathy and L. Fei-Fei, “Deep visual-semantic alignments for generating
image descriptions,” in </span><span id="bib.bib4.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib4.3.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
A. Kumar, O. Irsoy, J. Su, J. Bradbury, R. English, B. Pierce, P. Ondruska,
I. Gulrajani, and R. Socher, “Ask me anything: Dynamic memory networks for
natural language processing,” </span><span id="bib.bib5.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib5.3.3" class="ltx_text" style="font-size:90%;">, vol. abs/1506.07285, 2015.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
K. Xu, J. Ba, R. Kiros, K. Cho, A. Courville, R. Salakhudinov, R. Zemel, and
Y. Bengio, “Show, attend and tell: Neural image caption generation with
visual attention,” in </span><span id="bib.bib6.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib6.3.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
N. Cohen and H. Eichenbaum, </span><span id="bib.bib7.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Memory, Amnesia, and the Hippocampal System</span><span id="bib.bib7.3.3" class="ltx_text" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.4.1" class="ltx_text" style="font-size:90%;">Bradford Books, MIT Press, 1995.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
C. L. Zitnick and P. Dollár, “Edge boxes: Locating object proposals from
edges,” in </span><span id="bib.bib8.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib8.3.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
S. Ren, K. He, R. Girshick, and J. Sun, “Faster R-CNN: Towards real-time
object detection with region proposal networks,” in </span><span id="bib.bib9.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib9.3.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
M. Malinowski and M. Fritz, “A multi-world approach to question answering
about real-world scenes based on uncertain input,” in </span><span id="bib.bib10.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib10.3.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
S. Antol, A. Agrawal, J. Lu, M. Mitchell, D. Batra, C. L. Zitnick, and
D. Parikh, “VQA: visual question answering,” </span><span id="bib.bib11.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib11.3.3" class="ltx_text" style="font-size:90%;">,
vol. abs/1505.00468, 2015.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
A. Krizhevsky, I. Sutskever, and G. Hinton, “Imagenet classification with deep
convolutional neural networks,” in </span><span id="bib.bib12.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib12.3.3" class="ltx_text" style="font-size:90%;">, 2012.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
A. Graves, A. Mohamed, and G. E. Hinton, “Speech recognition with deep
recurrent neural networks,” </span><span id="bib.bib13.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib13.3.3" class="ltx_text" style="font-size:90%;">, vol. abs/1303.5778, 2013.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
D. Bahdanau, K. Cho, and Y. Bengio, “Neural machine translation by jointly
learning to align and translate,” </span><span id="bib.bib14.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib14.3.3" class="ltx_text" style="font-size:90%;">, vol. abs/1409.0473, 2014.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
S. Hochreiter and J. Schmidhuber, “Long short-term memory,” </span><span id="bib.bib15.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Neural
computation</span><span id="bib.bib15.3.3" class="ltx_text" style="font-size:90%;">, vol. 9, no. 8, pp. 1735–1780, 1997.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
H. Gao, J. Mao, J. Zhou, Z. Huang, L. Wang, and W. Xu, “Are you talking to a
machine? dataset and methods for multilingual image question answering,”
</span><span id="bib.bib16.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1505.05612</span><span id="bib.bib16.3.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
E. Tulving, “Episodic and semantic memory,” </span><span id="bib.bib17.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Organization of Memory.
London: Academic</span><span id="bib.bib17.3.3" class="ltx_text" style="font-size:90%;">, vol. 381, no. e402, p. 4, 1972.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
J. Chung, Ç. Gülçehre, K. Cho, and Y. Bengio, “Empirical
evaluation of gated recurrent neural networks on sequence modeling,” in </span><span id="bib.bib18.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS workshop on Deep Learning</span><span id="bib.bib18.3.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
A. Krizhevsky, I. Sutskever, and G. E. Hinton, “Imagenet classification with
deep convolutional neural networks,” in </span><span id="bib.bib19.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib19.3.3" class="ltx_text" style="font-size:90%;">, 2012.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
C. Szegedy, W. Liu, Y. Jia, P. Sermanet, S. Reed, D. Anguelov, D. Erhan,
V. Vanhoucke, and A. Rabinovich, “Going deeper with convolutions,” in </span><span id="bib.bib20.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib20.3.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Z. Wu and M. Palmer, “Verbs semantics and lexical selection,” in </span><span id="bib.bib21.2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ACL</span><span id="bib.bib21.3.3" class="ltx_text" style="font-size:90%;">,
1994.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1511.05675" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1511.05676" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1511.05676">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1511.05676" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1511.05677" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  8 04:37:36 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
