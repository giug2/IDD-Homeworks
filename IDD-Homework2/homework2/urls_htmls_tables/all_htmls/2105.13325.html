<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2105.13325] Federated Learning for Short-term Residential Load Forecasting</title><meta property="og:description" content="Load forecasting is an essential task performed within the energy industry to help balance supply with demand and maintain a stable load on the electricity grid. As supply transitions towards less reliable renewable en…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning for Short-term Residential Load Forecasting">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning for Short-term Residential Load Forecasting">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2105.13325">

<!--Generated on Tue Mar 19 05:48:41 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
federated learning,  load forecasting,  distributed machine learning,  deep learning,  data privacy,  internet-of-things
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Learning for Short-term Residential Load Forecasting</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Christopher Briggs,
Zhong Fan, 
and Peter Andras
</span><span class="ltx_author_notes">C. Briggs, Z. Fan and P. Andras are with the School of Computing and Mathematics, Keele University, Staffordshire, ST5 5BG, UK</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.2" class="ltx_p">Load forecasting is an essential task performed within the energy industry to help balance supply with demand and maintain a stable load on the electricity grid. As supply transitions towards less reliable renewable energy generation, smart meters will prove a vital component to facilitate these forecasting tasks. However, smart meter adoption is low among privacy-conscious consumers that fear intrusion upon their fine-grained consumption data. In this work we propose and explore a federated learning (FL) based approach for training forecasting models in a distributed, collaborative manner whilst retaining the privacy of the underlying data. We compare two approaches: FL, and a clustered variant, FL+HC against a non-private, centralised learning approach and a fully private, localised learning approach. Within these approaches, we measure model performance using RMSE and computational efficiency. In addition, we suggest the FL strategies are followed by a personalisation step and show that model performance can be improved by doing so. We show that FL+HC followed by personalisation can achieve a <math id="id1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="id1.1.m1.1a"><mo id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><csymbol cd="latexml" id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\sim</annotation></semantics></math>5% improvement in model performance with a <math id="id2.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="id2.2.m2.1a"><mo id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><csymbol cd="latexml" id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">\sim</annotation></semantics></math>10x reduction in computation compared to localised learning. Finally we provide advice on private aggregation of predictions for building a private end-to-end load forecasting application.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
federated learning, load forecasting, distributed machine learning, deep learning, data privacy, internet-of-things

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Smart meters are being deployed in many countries across the world for the purpose of optimising efficiency within electricity grids and providing consumers with insights into their energy usage. The meters record energy consumption within a building directly from the electricity supply and periodically communicate this data to energy suppliers and other entities in the energy sector. Smart meter data contain an enormous amount of potential predictive power that will aid the transition from fossil fuel technologies to cleaner and renewable technologies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. However this high-resolution data is particularly sensitive as it can easily enable inference about household occupancy, lifestyle habits or even what and when specific appliances are being used in a household <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">A large contribution of renewables in the energy mix poses a significant challenge for balancing supply and demand. If peak demand coincides with low wind/solar inputs, energy must be provided by reliable backup generation, such as idling gas turbines. Such solutions are very costly, both economically and environmentally and serve to discourage the installation of large amounts of renewable energy generation. Reliable forecasting will provide opportunity for more efficient optimisation of electricity grids to cope with varying energy demand.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Despite the benefits for promoting a greener energy sector, smart meter installation in most countries is an opt-in process and levels of adoption of smart meters are beginning to stagnate. Data privacy and security concerns are among the most cited reasons consumers give for rejecting a smart meter installation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Specific privacy concerns with smart meters include government surveillance, energy companies selling data and illegal data acquisition/use <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Deep learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> - a subset of machine learning that makes use of multi-layered neural networks for classification and regression tasks, among others - has shown great promise in many applications in recent years. Time-series forecasting is one such strength of deep learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> using specific architectures such as recurrent neural networks (RNNs) that are designed to capture temporal dependencies during training. Among the most successful RNN architectures for forecasting are Long-Short Term Memory networks (LSTMs), that learn long-range dependencies particularly well.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this paper, we propose the use of a modern distributed machine learning setting known as federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> to train load forecasting LSTM models while preserving the privacy of consumer energy consumption data that could enable greater adoption of smart meters by privacy-conscious consumers. Our main contributions are: (a) a thorough comparison of how FL training strategies and non-FL benchmarks affect a model’s forecasting performance (b) a comparative analysis of FL to a FL variant, designed specifically to perform well over non-iid data, applied to load forecasting, (c) an evaluation of computational efficiency issues arising in the FL forecasting system, and (d) the identification of the necessity of a personalisation step in FL-based forecasting to improve model performance beyond training individual local models in isolation.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The remainder of this paper is organised as follows. A short literature study is presented in <a href="#S2" title="II Literature review ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section II</span></a>. We explore properties of the smart meter energy demand dataset used in our experiments in <a href="#S3" title="III Exploratory Data Analysis ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section III</span></a>. In <a href="#S4" title="IV Methodology ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section IV</span></a> we provide our methodology and in <a href="#S5" title="V Results &amp; Discussion ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section V</span></a> we present our results along with discussion. Finally we conclude our work in <a href="#S6" title="VI Conclusion ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section VI</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Literature review</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In the literature, AI and machine learning have been adopted for load forecasting since 1990s. In particular, artificial neural networks have been the most popular technique during the past three decades <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, while fuzzy logic and support vector machines (SVM) have also been used in many papers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. Since 2015 there has been a huge increase of applying deep learning to load forecasting, e.g. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> Notably, the authors of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> have developed a bespoke deep learning application for household load forecasting and the method was tested on 920 smart metered customers from Ireland. It is shown to outperform some of the state-of-the-art techniques in household load forecasting, such as ARIMA (AutoRegressive Integrated Moving Average) and SVR (support vector regression) in terms of RMSE (Root Mean Square Error).</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Despite the above technical advancements, as pointed out by the authors of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, load forecasting is still an evolving field, and ”no technique is superior to all other methods in load forecasting”. Therefore, power system academics should work together with industry as well as researchers in other disciplines, such as big data, computer science, and meteorology, to facilitate wide deployment of better load forecasting models in practice.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">The most successful neural network architectures for forecasting are based on recurrent neural networks (RNNs), such as Long-Short Term Memory networks (LSTMs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. These architectures can learn what long and short term information to pay attention to during the training process. Recent surveys compare and contrast traditional and modern approaches to load forecasting and conclude that AI-based methods (such as those that utilise neural networks) offer the greatest predictive performance across all forecasting horizons <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Kong et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> investigate the use of an LSTM architecture to predict short-term electrical load for residential properties. The authors show that forecasting with an LSTM outperforms other statistical and machine learning methods for this purpose. We draw inspiration from this work to form our comparative centralised learning approach and thus the architecture for our FL training scenarios.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">The key drawback to how both traditional and AI-based methods have been applied in the load forecasting literature is the need for data to be centralised. Clearly the privacy of consumer energy consumption data can easily be violated in such cases. FL provides a key mechanism to tackle the issue of training a model over private data. FL research has its roots in distributed optimisation within the datacentre to deal with very large datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. The term ‘federated learning’ was coined in a paper by researchers at Google who presented a simple distributed stochastic gradient descent (SGD) procedure known as federated averaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> which allows a selection of devices to train on local data and contribute updates to a shared, global model. The procedure keeps raw data private but requires significantly greater wall-clock time to train models that can compete with models trained in the more conventional centralised fashion. One key concern with training models under FL is degraded optimisation performance and/or reduced model performance in the presence of non-IID data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Several approaches have been suggested to tackle this issue. One idea is to regularise the updates from individual devices to constrain the distance between local models and the global model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Another approach is to abandon the idea of training a single global model in favour of multiple specialised models to fit divergent data. Such ideas include federated multi-task learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> and clustered FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. In this paper we explore the effect of a variant of FL using hierarchical clustering (HC) known as FL+HC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, that introduces a hierarchical clustering algorithm during the FL procedure to partition devices by update similarity.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">For load forecasting applications, few works exist that consider the use FL. The authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> investigate how to predict chiller efficiency in HVAC systems with the goal of reducing energy consumption. The work compares a centralised learning approach with FL, concluding that FL model performance suffers when training over all installation sites but can be improved when data is grouped by installation site. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, the authors apply FL to predict energy demand in the scenario of electric vehicle charging networks. They show that clustering charging stations geographically prior to learning improved model performance and reduced communication overhead.</p>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.1" class="ltx_p">On smart meter data, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> apply FL to privately predict the value of various socio-demographic data features of each household in order for energy utilities to offer diversified services to their consumers. The work most similar to our own in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> provides a simple study of Fl for load forecasting using household energy consumption data. Where our work differs is the depth of our analysis and our comparison of training strategies including multiple model approaches to tackle the known issue of poor FL performance on non-IID datasets. We additionally benchmark against both centralised learning and localised learning - the latter already provides a fully-private forecast, so is very important to compare an FL system against. Finally we test a wide variety of time-series sequence lengths to understand how this affects learning in all our different approaches.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Exploratory Data Analysis</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In order to test an application for short-term energy load forecasting, a suitable dataset with reliable real-world high to medium resolution electricity meter readings was required. Additionally, summarising and visualising the data and distribution of various facets of a dataset will allow us to draw insights about individual households’ energy demand over time. This section briefly describes the dataset used, our sub-sample of the dataset and provides some exploratory visualisations of the sampled data.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Dataset</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The dataset used for our experiments was gathered under the Low Carbon London project delivered by UK Power networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. This 4 year project was designed to support low carbon energy solutions within the UK and was conducted between 2011 and 2014. The project made available the smart electricity meter readings for a sample of 5,567 London households, many of which cover 1 or more years of the duration of the project. The data is provided as discretised 30-minute meter readings showing total energy consumption (in kWh) recorded within each interval.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">In order to carry out a detailed comparative study between different training methods, a small sample of 100 households was randomly selected over the period 1st Jan 2013 to 30th June 2013. The selection criteria for these 100 households required that meter readings should cover the period described above and that the meters were gathering consumption data under a standard flat-rate electricity billing tariff (as opposed to a dynamic time of use tariff that was also present in the dataset). This final criterion was applied to reduce the behavioural bias that time of use tariffs induce in energy consumption habits within a household. The resulting sample was therefore expected to contain households who use energy with no influence other than their normal daily habits and occupancy.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">In conjunction with the energy consumption data, we also considered how weather related data might impact on forecasting models trained under different scenarios. As all the consumption data is collected within the greater London area, it was possible to collect weather readings that could be easily fused with the consumption data. These included the air temperature (in degrees Celsius) and relative humidity (as a percentage) recorded by the Met Office <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. As the exact location of each household is not recorded in the dataset, the London Heathrow weather station was selected as it contained a full set of hourly readings for the duration of the study period.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p">A detailed description of all specific data pre-processing techniques that were applied to the resulting data sample in our study are provided in <a href="#S4.SS1" title="IV-A Dataset preparation ‣ IV Methodology ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">subsection <span class="ltx_text">IV-A</span></span></a></p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Data visualisation</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">The hourly and daily energy consumption profiles of 3 random households from our sampled dataset (over 7 days and 6 month respectively) are presented in <a href="#S3.F1" title="Figure 1 ‣ III-B Data visualisation ‣ III Exploratory Data Analysis ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 1</span></a> and <a href="#S3.F2" title="Figure 2 ‣ III-B Data visualisation ‣ III Exploratory Data Analysis ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a>. From the hourly profiles, each household uses more energy during the day than at night as would be expected for most people. However, the maximum level of energy consumption is quite different among the households, as is the time of day when most energy is used. Houses 1 and 2 show 2 or 3 peaks roughly corresponding with increased energy consumption in the morning and evening, whereas House 3 uses energy more consistently throughout the day. Another insight that becomes clear from visualising the hourly data is that private habitual activity is visible at this granularity. For example, low energy consumption in House 1 on the evening of the 17th might suggest low or zero occupancy at that time, especially considering high energy consumption in the evenings of all other days in this time window.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Visualising the daily energy consumption profiles reveals that longer term energy usage is quite different over these same 3 households as well. House 1 uses more energy for 7-14 day periods followed by lower energy use. House 2 used more or less energy sporadically day to day with a considerable drop in energy use in early April (perhaps indicating electric heating use in the colder months which would account for the relatively high daily energy consumption). Finally, House 3 is incredibly consistent in its energy usage habits at this granularity, as was the case at the hourly resolution.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2105.13325/assets/example-hourly-energy-consumption.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="422" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An example of the hourly energy consumption profiles for 3 random households in the sampled dataset over a 7 day period between 15th January 2013 and 22nd January 2013</figcaption>
</figure>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2105.13325/assets/example-daily-energy-consumption.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="420" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>An example of the daily energy consumption profiles for the same 3 random households as in <a href="#S3.F1" title="Figure 1 ‣ III-B Data visualisation ‣ III Exploratory Data Analysis ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 1</span></a> in the sampled dataset over a 6 month period between 1st January 2013 and 30th June 2013</figcaption>
</figure>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">Visualising just 3 households from the sample reveals the non-iid nature of individual household energy consumption at both a high and low resolution. Clearly, any forecasting model built on this data will need to capture this variability in energy usage between households. More broadly, we have produced heatmaps showing the aggregated daily energy consumption per household (<a href="#S3.F3" title="Figure 3 ‣ III-B Data visualisation ‣ III Exploratory Data Analysis ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 3</span></a>) and the mean energy consumption by hour of the day for each houshold (<a href="#S3.F4" title="Figure 4 ‣ III-B Data visualisation ‣ III Exploratory Data Analysis ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 4</span></a>). Both plots show min-max normalised energy consumption profiles (normalisation applied to each household individually) and are sorted by total energy consumption for each household.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2105.13325/assets/energy-consumption-by-day-norm.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="418" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Aggregated daily energy consumption per household in the sampled dataset. The heatmap presents energy consumption as min-max normalised values (by household) between 0 and 1. Households are sorted (top to bottom) by total energy consumption.</figcaption>
</figure>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2105.13325/assets/mean-energy-consumption-by-hour-norm.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="442" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Mean hourly energy consumption per household in the sampled dataset. The heatmap presents energy consumption as min-max normalised values (by household) between 0 and 1. Households are sorted (top to bottom) by total energy consumption.</figcaption>
</figure>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p"><a href="#S3.F3" title="Figure 3 ‣ III-B Data visualisation ‣ III Exploratory Data Analysis ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 3</span></a> reveals a large variance in aggregated daily energy consumption between households. Additionally, households where energy consumption remains consistent day to day are visible, in contrast with households that display an irregular distribution of energy usage depending on the day. <a href="#S3.F4" title="Figure 4 ‣ III-B Data visualisation ‣ III Exploratory Data Analysis ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 4</span></a> shows that peak energy demand tends to occur between 7am and 9am and 5pm until 10pm, likely consistent with occupancy and waking hours. However, the hour of peak energy demand shifts slightly from household to household which may prove difficult for a single joint forecasting model to represent. In this paper we will investigate how well several machine learning training approaches affect the ability of a model to produce accurate forecasts under the described non-iid data distribution over individual households’ energy consumption habits.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Methodology</span>
</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Dataset preparation</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.4" class="ltx_p">After selecting 100 households from the Low Carbon London dataset (see <a href="#S3.SS1" title="III-A Dataset ‣ III Exploratory Data Analysis ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">subsection <span class="ltx_text">III-A</span></span></a> for selection criteria), the raw energy consumption readings were passed though a pipeline of transformations to clean the data. For each individual household, this included dropping duplicated readings, forward filling empty readings and resampling the reading intervals to give an hourly record of energy consumption. A design matrix <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\bm{X}_{c}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">𝑿</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝑿</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\bm{X}_{c}</annotation></semantics></math> was then built for each household <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">c</annotation></semantics></math> based on this transformed data containing feature vectors of the form <math id="S4.SS1.p1.3.m3.5" class="ltx_Math" alttext="\bm{x}_{t}=\{e_{t},y_{t},w_{t},d_{t},h_{t}\}" display="inline"><semantics id="S4.SS1.p1.3.m3.5a"><mrow id="S4.SS1.p1.3.m3.5.5" xref="S4.SS1.p1.3.m3.5.5.cmml"><msub id="S4.SS1.p1.3.m3.5.5.7" xref="S4.SS1.p1.3.m3.5.5.7.cmml"><mi id="S4.SS1.p1.3.m3.5.5.7.2" xref="S4.SS1.p1.3.m3.5.5.7.2.cmml">𝒙</mi><mi id="S4.SS1.p1.3.m3.5.5.7.3" xref="S4.SS1.p1.3.m3.5.5.7.3.cmml">t</mi></msub><mo id="S4.SS1.p1.3.m3.5.5.6" xref="S4.SS1.p1.3.m3.5.5.6.cmml">=</mo><mrow id="S4.SS1.p1.3.m3.5.5.5.5" xref="S4.SS1.p1.3.m3.5.5.5.6.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.5.5.5.5.6" xref="S4.SS1.p1.3.m3.5.5.5.6.cmml">{</mo><msub id="S4.SS1.p1.3.m3.1.1.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.1.1.1.2" xref="S4.SS1.p1.3.m3.1.1.1.1.1.2.cmml">e</mi><mi id="S4.SS1.p1.3.m3.1.1.1.1.1.3" xref="S4.SS1.p1.3.m3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.p1.3.m3.5.5.5.5.7" xref="S4.SS1.p1.3.m3.5.5.5.6.cmml">,</mo><msub id="S4.SS1.p1.3.m3.2.2.2.2.2" xref="S4.SS1.p1.3.m3.2.2.2.2.2.cmml"><mi id="S4.SS1.p1.3.m3.2.2.2.2.2.2" xref="S4.SS1.p1.3.m3.2.2.2.2.2.2.cmml">y</mi><mi id="S4.SS1.p1.3.m3.2.2.2.2.2.3" xref="S4.SS1.p1.3.m3.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS1.p1.3.m3.5.5.5.5.8" xref="S4.SS1.p1.3.m3.5.5.5.6.cmml">,</mo><msub id="S4.SS1.p1.3.m3.3.3.3.3.3" xref="S4.SS1.p1.3.m3.3.3.3.3.3.cmml"><mi id="S4.SS1.p1.3.m3.3.3.3.3.3.2" xref="S4.SS1.p1.3.m3.3.3.3.3.3.2.cmml">w</mi><mi id="S4.SS1.p1.3.m3.3.3.3.3.3.3" xref="S4.SS1.p1.3.m3.3.3.3.3.3.3.cmml">t</mi></msub><mo id="S4.SS1.p1.3.m3.5.5.5.5.9" xref="S4.SS1.p1.3.m3.5.5.5.6.cmml">,</mo><msub id="S4.SS1.p1.3.m3.4.4.4.4.4" xref="S4.SS1.p1.3.m3.4.4.4.4.4.cmml"><mi id="S4.SS1.p1.3.m3.4.4.4.4.4.2" xref="S4.SS1.p1.3.m3.4.4.4.4.4.2.cmml">d</mi><mi id="S4.SS1.p1.3.m3.4.4.4.4.4.3" xref="S4.SS1.p1.3.m3.4.4.4.4.4.3.cmml">t</mi></msub><mo id="S4.SS1.p1.3.m3.5.5.5.5.10" xref="S4.SS1.p1.3.m3.5.5.5.6.cmml">,</mo><msub id="S4.SS1.p1.3.m3.5.5.5.5.5" xref="S4.SS1.p1.3.m3.5.5.5.5.5.cmml"><mi id="S4.SS1.p1.3.m3.5.5.5.5.5.2" xref="S4.SS1.p1.3.m3.5.5.5.5.5.2.cmml">h</mi><mi id="S4.SS1.p1.3.m3.5.5.5.5.5.3" xref="S4.SS1.p1.3.m3.5.5.5.5.5.3.cmml">t</mi></msub><mo stretchy="false" id="S4.SS1.p1.3.m3.5.5.5.5.11" xref="S4.SS1.p1.3.m3.5.5.5.6.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.5b"><apply id="S4.SS1.p1.3.m3.5.5.cmml" xref="S4.SS1.p1.3.m3.5.5"><eq id="S4.SS1.p1.3.m3.5.5.6.cmml" xref="S4.SS1.p1.3.m3.5.5.6"></eq><apply id="S4.SS1.p1.3.m3.5.5.7.cmml" xref="S4.SS1.p1.3.m3.5.5.7"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.5.5.7.1.cmml" xref="S4.SS1.p1.3.m3.5.5.7">subscript</csymbol><ci id="S4.SS1.p1.3.m3.5.5.7.2.cmml" xref="S4.SS1.p1.3.m3.5.5.7.2">𝒙</ci><ci id="S4.SS1.p1.3.m3.5.5.7.3.cmml" xref="S4.SS1.p1.3.m3.5.5.7.3">𝑡</ci></apply><set id="S4.SS1.p1.3.m3.5.5.5.6.cmml" xref="S4.SS1.p1.3.m3.5.5.5.5"><apply id="S4.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1.2">𝑒</ci><ci id="S4.SS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.p1.3.m3.2.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2.2">𝑦</ci><ci id="S4.SS1.p1.3.m3.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2.3">𝑡</ci></apply><apply id="S4.SS1.p1.3.m3.3.3.3.3.3.cmml" xref="S4.SS1.p1.3.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.3.3.3.3.3.1.cmml" xref="S4.SS1.p1.3.m3.3.3.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.3.m3.3.3.3.3.3.2.cmml" xref="S4.SS1.p1.3.m3.3.3.3.3.3.2">𝑤</ci><ci id="S4.SS1.p1.3.m3.3.3.3.3.3.3.cmml" xref="S4.SS1.p1.3.m3.3.3.3.3.3.3">𝑡</ci></apply><apply id="S4.SS1.p1.3.m3.4.4.4.4.4.cmml" xref="S4.SS1.p1.3.m3.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.4.4.4.4.4.1.cmml" xref="S4.SS1.p1.3.m3.4.4.4.4.4">subscript</csymbol><ci id="S4.SS1.p1.3.m3.4.4.4.4.4.2.cmml" xref="S4.SS1.p1.3.m3.4.4.4.4.4.2">𝑑</ci><ci id="S4.SS1.p1.3.m3.4.4.4.4.4.3.cmml" xref="S4.SS1.p1.3.m3.4.4.4.4.4.3">𝑡</ci></apply><apply id="S4.SS1.p1.3.m3.5.5.5.5.5.cmml" xref="S4.SS1.p1.3.m3.5.5.5.5.5"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.5.5.5.5.5.1.cmml" xref="S4.SS1.p1.3.m3.5.5.5.5.5">subscript</csymbol><ci id="S4.SS1.p1.3.m3.5.5.5.5.5.2.cmml" xref="S4.SS1.p1.3.m3.5.5.5.5.5.2">ℎ</ci><ci id="S4.SS1.p1.3.m3.5.5.5.5.5.3.cmml" xref="S4.SS1.p1.3.m3.5.5.5.5.5.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.5c">\bm{x}_{t}=\{e_{t},y_{t},w_{t},d_{t},h_{t}\}</annotation></semantics></math> for each time index <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">t</annotation></semantics></math> composed of:</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<ol id="S4.I1" class="ltx_enumerate">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p">the energy consumption value <math id="S4.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="e_{t}" display="inline"><semantics id="S4.I1.i1.p1.1.m1.1a"><msub id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">e</mi><mi id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">𝑒</ci><ci id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">e_{t}</annotation></semantics></math> in kWh</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p">the year <math id="S4.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="y_{t}" display="inline"><semantics id="S4.I1.i2.p1.1.m1.1a"><msub id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.2.cmml">y</mi><mi id="S4.I1.i2.p1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><apply id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.2">𝑦</ci><ci id="S4.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">y_{t}</annotation></semantics></math> corresponding with the time index</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p">the week of the year <math id="S4.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="w_{t}" display="inline"><semantics id="S4.I1.i3.p1.1.m1.1a"><msub id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.2" xref="S4.I1.i3.p1.1.m1.1.1.2.cmml">w</mi><mi id="S4.I1.i3.p1.1.m1.1.1.3" xref="S4.I1.i3.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><apply id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.1.m1.1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.2">𝑤</ci><ci id="S4.I1.i3.p1.1.m1.1.1.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">w_{t}</annotation></semantics></math> in the range 0-51</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.1" class="ltx_p">the day of the week <math id="S4.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="d_{t}" display="inline"><semantics id="S4.I1.i4.p1.1.m1.1a"><msub id="S4.I1.i4.p1.1.m1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.cmml"><mi id="S4.I1.i4.p1.1.m1.1.1.2" xref="S4.I1.i4.p1.1.m1.1.1.2.cmml">d</mi><mi id="S4.I1.i4.p1.1.m1.1.1.3" xref="S4.I1.i4.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.1.m1.1b"><apply id="S4.I1.i4.p1.1.m1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.1.m1.1.1.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.2">𝑑</ci><ci id="S4.I1.i4.p1.1.m1.1.1.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.1.m1.1c">d_{t}</annotation></semantics></math> in the range 0-6</p>
</div>
</li>
<li id="S4.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span> 
<div id="S4.I1.i5.p1" class="ltx_para">
<p id="S4.I1.i5.p1.1" class="ltx_p">the hour of the day <math id="S4.I1.i5.p1.1.m1.1" class="ltx_Math" alttext="h_{t}" display="inline"><semantics id="S4.I1.i5.p1.1.m1.1a"><msub id="S4.I1.i5.p1.1.m1.1.1" xref="S4.I1.i5.p1.1.m1.1.1.cmml"><mi id="S4.I1.i5.p1.1.m1.1.1.2" xref="S4.I1.i5.p1.1.m1.1.1.2.cmml">h</mi><mi id="S4.I1.i5.p1.1.m1.1.1.3" xref="S4.I1.i5.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i5.p1.1.m1.1b"><apply id="S4.I1.i5.p1.1.m1.1.1.cmml" xref="S4.I1.i5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i5.p1.1.m1.1.1.1.cmml" xref="S4.I1.i5.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i5.p1.1.m1.1.1.2.cmml" xref="S4.I1.i5.p1.1.m1.1.1.2">ℎ</ci><ci id="S4.I1.i5.p1.1.m1.1.1.3.cmml" xref="S4.I1.i5.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i5.p1.1.m1.1c">h_{t}</annotation></semantics></math> in the range 0-23</p>
</div>
</li>
</ol>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.3" class="ltx_p">A second design matrix <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\bm{W_{c}}" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><msub id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">𝑾</mi><mi id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">𝒄</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝑾</ci><ci id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">𝒄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\bm{W_{c}}</annotation></semantics></math> was also built for each household <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">c</annotation></semantics></math> that included weather data from the Met Office (discussed in more detail in <a href="#S3.SS1" title="III-A Dataset ‣ III Exploratory Data Analysis ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">subsection <span class="ltx_text">III-A</span></span></a>). The feature vectors of the form <math id="S4.SS1.p3.3.m3.7" class="ltx_Math" alttext="\bm{w}_{t}=\{e_{t},y_{t},w_{t},d_{t},h_{t},a_{t},r_{t}\}" display="inline"><semantics id="S4.SS1.p3.3.m3.7a"><mrow id="S4.SS1.p3.3.m3.7.7" xref="S4.SS1.p3.3.m3.7.7.cmml"><msub id="S4.SS1.p3.3.m3.7.7.9" xref="S4.SS1.p3.3.m3.7.7.9.cmml"><mi id="S4.SS1.p3.3.m3.7.7.9.2" xref="S4.SS1.p3.3.m3.7.7.9.2.cmml">𝒘</mi><mi id="S4.SS1.p3.3.m3.7.7.9.3" xref="S4.SS1.p3.3.m3.7.7.9.3.cmml">t</mi></msub><mo id="S4.SS1.p3.3.m3.7.7.8" xref="S4.SS1.p3.3.m3.7.7.8.cmml">=</mo><mrow id="S4.SS1.p3.3.m3.7.7.7.7" xref="S4.SS1.p3.3.m3.7.7.7.8.cmml"><mo stretchy="false" id="S4.SS1.p3.3.m3.7.7.7.7.8" xref="S4.SS1.p3.3.m3.7.7.7.8.cmml">{</mo><msub id="S4.SS1.p3.3.m3.1.1.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.3.m3.1.1.1.1.1.2" xref="S4.SS1.p3.3.m3.1.1.1.1.1.2.cmml">e</mi><mi id="S4.SS1.p3.3.m3.1.1.1.1.1.3" xref="S4.SS1.p3.3.m3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.p3.3.m3.7.7.7.7.9" xref="S4.SS1.p3.3.m3.7.7.7.8.cmml">,</mo><msub id="S4.SS1.p3.3.m3.2.2.2.2.2" xref="S4.SS1.p3.3.m3.2.2.2.2.2.cmml"><mi id="S4.SS1.p3.3.m3.2.2.2.2.2.2" xref="S4.SS1.p3.3.m3.2.2.2.2.2.2.cmml">y</mi><mi id="S4.SS1.p3.3.m3.2.2.2.2.2.3" xref="S4.SS1.p3.3.m3.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.SS1.p3.3.m3.7.7.7.7.10" xref="S4.SS1.p3.3.m3.7.7.7.8.cmml">,</mo><msub id="S4.SS1.p3.3.m3.3.3.3.3.3" xref="S4.SS1.p3.3.m3.3.3.3.3.3.cmml"><mi id="S4.SS1.p3.3.m3.3.3.3.3.3.2" xref="S4.SS1.p3.3.m3.3.3.3.3.3.2.cmml">w</mi><mi id="S4.SS1.p3.3.m3.3.3.3.3.3.3" xref="S4.SS1.p3.3.m3.3.3.3.3.3.3.cmml">t</mi></msub><mo id="S4.SS1.p3.3.m3.7.7.7.7.11" xref="S4.SS1.p3.3.m3.7.7.7.8.cmml">,</mo><msub id="S4.SS1.p3.3.m3.4.4.4.4.4" xref="S4.SS1.p3.3.m3.4.4.4.4.4.cmml"><mi id="S4.SS1.p3.3.m3.4.4.4.4.4.2" xref="S4.SS1.p3.3.m3.4.4.4.4.4.2.cmml">d</mi><mi id="S4.SS1.p3.3.m3.4.4.4.4.4.3" xref="S4.SS1.p3.3.m3.4.4.4.4.4.3.cmml">t</mi></msub><mo id="S4.SS1.p3.3.m3.7.7.7.7.12" xref="S4.SS1.p3.3.m3.7.7.7.8.cmml">,</mo><msub id="S4.SS1.p3.3.m3.5.5.5.5.5" xref="S4.SS1.p3.3.m3.5.5.5.5.5.cmml"><mi id="S4.SS1.p3.3.m3.5.5.5.5.5.2" xref="S4.SS1.p3.3.m3.5.5.5.5.5.2.cmml">h</mi><mi id="S4.SS1.p3.3.m3.5.5.5.5.5.3" xref="S4.SS1.p3.3.m3.5.5.5.5.5.3.cmml">t</mi></msub><mo id="S4.SS1.p3.3.m3.7.7.7.7.13" xref="S4.SS1.p3.3.m3.7.7.7.8.cmml">,</mo><msub id="S4.SS1.p3.3.m3.6.6.6.6.6" xref="S4.SS1.p3.3.m3.6.6.6.6.6.cmml"><mi id="S4.SS1.p3.3.m3.6.6.6.6.6.2" xref="S4.SS1.p3.3.m3.6.6.6.6.6.2.cmml">a</mi><mi id="S4.SS1.p3.3.m3.6.6.6.6.6.3" xref="S4.SS1.p3.3.m3.6.6.6.6.6.3.cmml">t</mi></msub><mo id="S4.SS1.p3.3.m3.7.7.7.7.14" xref="S4.SS1.p3.3.m3.7.7.7.8.cmml">,</mo><msub id="S4.SS1.p3.3.m3.7.7.7.7.7" xref="S4.SS1.p3.3.m3.7.7.7.7.7.cmml"><mi id="S4.SS1.p3.3.m3.7.7.7.7.7.2" xref="S4.SS1.p3.3.m3.7.7.7.7.7.2.cmml">r</mi><mi id="S4.SS1.p3.3.m3.7.7.7.7.7.3" xref="S4.SS1.p3.3.m3.7.7.7.7.7.3.cmml">t</mi></msub><mo stretchy="false" id="S4.SS1.p3.3.m3.7.7.7.7.15" xref="S4.SS1.p3.3.m3.7.7.7.8.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.7b"><apply id="S4.SS1.p3.3.m3.7.7.cmml" xref="S4.SS1.p3.3.m3.7.7"><eq id="S4.SS1.p3.3.m3.7.7.8.cmml" xref="S4.SS1.p3.3.m3.7.7.8"></eq><apply id="S4.SS1.p3.3.m3.7.7.9.cmml" xref="S4.SS1.p3.3.m3.7.7.9"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.7.7.9.1.cmml" xref="S4.SS1.p3.3.m3.7.7.9">subscript</csymbol><ci id="S4.SS1.p3.3.m3.7.7.9.2.cmml" xref="S4.SS1.p3.3.m3.7.7.9.2">𝒘</ci><ci id="S4.SS1.p3.3.m3.7.7.9.3.cmml" xref="S4.SS1.p3.3.m3.7.7.9.3">𝑡</ci></apply><set id="S4.SS1.p3.3.m3.7.7.7.8.cmml" xref="S4.SS1.p3.3.m3.7.7.7.7"><apply id="S4.SS1.p3.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.1.2">𝑒</ci><ci id="S4.SS1.p3.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.p3.3.m3.2.2.2.2.2.cmml" xref="S4.SS1.p3.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.3.m3.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.3.m3.2.2.2.2.2.2">𝑦</ci><ci id="S4.SS1.p3.3.m3.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.3.m3.2.2.2.2.2.3">𝑡</ci></apply><apply id="S4.SS1.p3.3.m3.3.3.3.3.3.cmml" xref="S4.SS1.p3.3.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.3.3.3.3.3.1.cmml" xref="S4.SS1.p3.3.m3.3.3.3.3.3">subscript</csymbol><ci id="S4.SS1.p3.3.m3.3.3.3.3.3.2.cmml" xref="S4.SS1.p3.3.m3.3.3.3.3.3.2">𝑤</ci><ci id="S4.SS1.p3.3.m3.3.3.3.3.3.3.cmml" xref="S4.SS1.p3.3.m3.3.3.3.3.3.3">𝑡</ci></apply><apply id="S4.SS1.p3.3.m3.4.4.4.4.4.cmml" xref="S4.SS1.p3.3.m3.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.4.4.4.4.4.1.cmml" xref="S4.SS1.p3.3.m3.4.4.4.4.4">subscript</csymbol><ci id="S4.SS1.p3.3.m3.4.4.4.4.4.2.cmml" xref="S4.SS1.p3.3.m3.4.4.4.4.4.2">𝑑</ci><ci id="S4.SS1.p3.3.m3.4.4.4.4.4.3.cmml" xref="S4.SS1.p3.3.m3.4.4.4.4.4.3">𝑡</ci></apply><apply id="S4.SS1.p3.3.m3.5.5.5.5.5.cmml" xref="S4.SS1.p3.3.m3.5.5.5.5.5"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.5.5.5.5.5.1.cmml" xref="S4.SS1.p3.3.m3.5.5.5.5.5">subscript</csymbol><ci id="S4.SS1.p3.3.m3.5.5.5.5.5.2.cmml" xref="S4.SS1.p3.3.m3.5.5.5.5.5.2">ℎ</ci><ci id="S4.SS1.p3.3.m3.5.5.5.5.5.3.cmml" xref="S4.SS1.p3.3.m3.5.5.5.5.5.3">𝑡</ci></apply><apply id="S4.SS1.p3.3.m3.6.6.6.6.6.cmml" xref="S4.SS1.p3.3.m3.6.6.6.6.6"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.6.6.6.6.6.1.cmml" xref="S4.SS1.p3.3.m3.6.6.6.6.6">subscript</csymbol><ci id="S4.SS1.p3.3.m3.6.6.6.6.6.2.cmml" xref="S4.SS1.p3.3.m3.6.6.6.6.6.2">𝑎</ci><ci id="S4.SS1.p3.3.m3.6.6.6.6.6.3.cmml" xref="S4.SS1.p3.3.m3.6.6.6.6.6.3">𝑡</ci></apply><apply id="S4.SS1.p3.3.m3.7.7.7.7.7.cmml" xref="S4.SS1.p3.3.m3.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.7.7.7.7.7.1.cmml" xref="S4.SS1.p3.3.m3.7.7.7.7.7">subscript</csymbol><ci id="S4.SS1.p3.3.m3.7.7.7.7.7.2.cmml" xref="S4.SS1.p3.3.m3.7.7.7.7.7.2">𝑟</ci><ci id="S4.SS1.p3.3.m3.7.7.7.7.7.3.cmml" xref="S4.SS1.p3.3.m3.7.7.7.7.7.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.7c">\bm{w}_{t}=\{e_{t},y_{t},w_{t},d_{t},h_{t},a_{t},r_{t}\}</annotation></semantics></math> comprising this design matrix were additionally composed of:</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<ol id="S4.I2" class="ltx_enumerate">
<li id="S4.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S4.I2.i1.p1" class="ltx_para">
<p id="S4.I2.i1.p1.1" class="ltx_p">the recorded air temperature <math id="S4.I2.i1.p1.1.m1.1" class="ltx_Math" alttext="a_{t}" display="inline"><semantics id="S4.I2.i1.p1.1.m1.1a"><msub id="S4.I2.i1.p1.1.m1.1.1" xref="S4.I2.i1.p1.1.m1.1.1.cmml"><mi id="S4.I2.i1.p1.1.m1.1.1.2" xref="S4.I2.i1.p1.1.m1.1.1.2.cmml">a</mi><mi id="S4.I2.i1.p1.1.m1.1.1.3" xref="S4.I2.i1.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.1.m1.1b"><apply id="S4.I2.i1.p1.1.m1.1.1.cmml" xref="S4.I2.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.p1.1.m1.1.1.1.cmml" xref="S4.I2.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I2.i1.p1.1.m1.1.1.2.cmml" xref="S4.I2.i1.p1.1.m1.1.1.2">𝑎</ci><ci id="S4.I2.i1.p1.1.m1.1.1.3.cmml" xref="S4.I2.i1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.1.m1.1c">a_{t}</annotation></semantics></math> in degrees Celsius corresponding with the time index</p>
</div>
</li>
<li id="S4.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S4.I2.i2.p1" class="ltx_para">
<p id="S4.I2.i2.p1.1" class="ltx_p">the calculated relative humidity <math id="S4.I2.i2.p1.1.m1.1" class="ltx_Math" alttext="r_{t}" display="inline"><semantics id="S4.I2.i2.p1.1.m1.1a"><msub id="S4.I2.i2.p1.1.m1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.cmml"><mi id="S4.I2.i2.p1.1.m1.1.1.2" xref="S4.I2.i2.p1.1.m1.1.1.2.cmml">r</mi><mi id="S4.I2.i2.p1.1.m1.1.1.3" xref="S4.I2.i2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.1.m1.1b"><apply id="S4.I2.i2.p1.1.m1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I2.i2.p1.1.m1.1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I2.i2.p1.1.m1.1.1.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.2">𝑟</ci><ci id="S4.I2.i2.p1.1.m1.1.1.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.1.m1.1c">r_{t}</annotation></semantics></math> (as a percentage)</p>
</div>
</li>
</ol>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.3" class="ltx_p">Finally both <math id="S4.SS1.p5.1.m1.1" class="ltx_Math" alttext="\bm{X_{c}}" display="inline"><semantics id="S4.SS1.p5.1.m1.1a"><msub id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml"><mi id="S4.SS1.p5.1.m1.1.1.2" xref="S4.SS1.p5.1.m1.1.1.2.cmml">𝑿</mi><mi id="S4.SS1.p5.1.m1.1.1.3" xref="S4.SS1.p5.1.m1.1.1.3.cmml">𝒄</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><apply id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2">𝑿</ci><ci id="S4.SS1.p5.1.m1.1.1.3.cmml" xref="S4.SS1.p5.1.m1.1.1.3">𝒄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">\bm{X_{c}}</annotation></semantics></math> and <math id="S4.SS1.p5.2.m2.1" class="ltx_Math" alttext="\bm{W_{c}}" display="inline"><semantics id="S4.SS1.p5.2.m2.1a"><msub id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml"><mi id="S4.SS1.p5.2.m2.1.1.2" xref="S4.SS1.p5.2.m2.1.1.2.cmml">𝑾</mi><mi id="S4.SS1.p5.2.m2.1.1.3" xref="S4.SS1.p5.2.m2.1.1.3.cmml">𝒄</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><apply id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p5.2.m2.1.1.2.cmml" xref="S4.SS1.p5.2.m2.1.1.2">𝑾</ci><ci id="S4.SS1.p5.2.m2.1.1.3.cmml" xref="S4.SS1.p5.2.m2.1.1.3">𝒄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">\bm{W_{c}}</annotation></semantics></math> for each household <math id="S4.SS1.p5.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p5.3.m3.1a"><mi id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b"><ci id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">c</annotation></semantics></math> were partitioned into training, validation and testing datasets according to 0.7/0.2/0.1 split. As the time series data is sequential by its very nature, the validation split contains time indices strictly greater than those in the training split and the test split contains time indices strictly greater than those in the validation split.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Forecasting task</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.9" class="ltx_p">The forecasting task is designed specifically for how LSTMs ingest data to be trained to perform predictions. As such, the initial design matrices for each household are transformed into consecutive rolling sequences of <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">K</annotation></semantics></math> feature vectors. For example, each sequence <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\bm{S}_{t}\in\bm{S}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><msub id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2.2" xref="S4.SS2.p1.2.m2.1.1.2.2.cmml">𝑺</mi><mi id="S4.SS2.p1.2.m2.1.1.2.3" xref="S4.SS2.p1.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">∈</mo><mi id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">𝑺</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><in id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></in><apply id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2.2">𝑺</ci><ci id="S4.SS2.p1.2.m2.1.1.2.3.cmml" xref="S4.SS2.p1.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">𝑺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\bm{S}_{t}\in\bm{S}</annotation></semantics></math> drawn from the design matrix <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\bm{X}_{c}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><msub id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">𝑿</mi><mi id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝑿</ci><ci id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\bm{X}_{c}</annotation></semantics></math> takes the form <math id="S4.SS2.p1.4.m4.4" class="ltx_Math" alttext="\bm{S}_{t}=\{\bm{x}_{t-K},...,\bm{x}_{t-2},\bm{x}_{t-1}\}" display="inline"><semantics id="S4.SS2.p1.4.m4.4a"><mrow id="S4.SS2.p1.4.m4.4.4" xref="S4.SS2.p1.4.m4.4.4.cmml"><msub id="S4.SS2.p1.4.m4.4.4.5" xref="S4.SS2.p1.4.m4.4.4.5.cmml"><mi id="S4.SS2.p1.4.m4.4.4.5.2" xref="S4.SS2.p1.4.m4.4.4.5.2.cmml">𝑺</mi><mi id="S4.SS2.p1.4.m4.4.4.5.3" xref="S4.SS2.p1.4.m4.4.4.5.3.cmml">t</mi></msub><mo id="S4.SS2.p1.4.m4.4.4.4" xref="S4.SS2.p1.4.m4.4.4.4.cmml">=</mo><mrow id="S4.SS2.p1.4.m4.4.4.3.3" xref="S4.SS2.p1.4.m4.4.4.3.4.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m4.4.4.3.3.4" xref="S4.SS2.p1.4.m4.4.4.3.4.cmml">{</mo><msub id="S4.SS2.p1.4.m4.2.2.1.1.1" xref="S4.SS2.p1.4.m4.2.2.1.1.1.cmml"><mi id="S4.SS2.p1.4.m4.2.2.1.1.1.2" xref="S4.SS2.p1.4.m4.2.2.1.1.1.2.cmml">𝒙</mi><mrow id="S4.SS2.p1.4.m4.2.2.1.1.1.3" xref="S4.SS2.p1.4.m4.2.2.1.1.1.3.cmml"><mi id="S4.SS2.p1.4.m4.2.2.1.1.1.3.2" xref="S4.SS2.p1.4.m4.2.2.1.1.1.3.2.cmml">t</mi><mo id="S4.SS2.p1.4.m4.2.2.1.1.1.3.1" xref="S4.SS2.p1.4.m4.2.2.1.1.1.3.1.cmml">−</mo><mi id="S4.SS2.p1.4.m4.2.2.1.1.1.3.3" xref="S4.SS2.p1.4.m4.2.2.1.1.1.3.3.cmml">K</mi></mrow></msub><mo id="S4.SS2.p1.4.m4.4.4.3.3.5" xref="S4.SS2.p1.4.m4.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">…</mi><mo id="S4.SS2.p1.4.m4.4.4.3.3.6" xref="S4.SS2.p1.4.m4.4.4.3.4.cmml">,</mo><msub id="S4.SS2.p1.4.m4.3.3.2.2.2" xref="S4.SS2.p1.4.m4.3.3.2.2.2.cmml"><mi id="S4.SS2.p1.4.m4.3.3.2.2.2.2" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2.cmml">𝒙</mi><mrow id="S4.SS2.p1.4.m4.3.3.2.2.2.3" xref="S4.SS2.p1.4.m4.3.3.2.2.2.3.cmml"><mi id="S4.SS2.p1.4.m4.3.3.2.2.2.3.2" xref="S4.SS2.p1.4.m4.3.3.2.2.2.3.2.cmml">t</mi><mo id="S4.SS2.p1.4.m4.3.3.2.2.2.3.1" xref="S4.SS2.p1.4.m4.3.3.2.2.2.3.1.cmml">−</mo><mn id="S4.SS2.p1.4.m4.3.3.2.2.2.3.3" xref="S4.SS2.p1.4.m4.3.3.2.2.2.3.3.cmml">2</mn></mrow></msub><mo id="S4.SS2.p1.4.m4.4.4.3.3.7" xref="S4.SS2.p1.4.m4.4.4.3.4.cmml">,</mo><msub id="S4.SS2.p1.4.m4.4.4.3.3.3" xref="S4.SS2.p1.4.m4.4.4.3.3.3.cmml"><mi id="S4.SS2.p1.4.m4.4.4.3.3.3.2" xref="S4.SS2.p1.4.m4.4.4.3.3.3.2.cmml">𝒙</mi><mrow id="S4.SS2.p1.4.m4.4.4.3.3.3.3" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.cmml"><mi id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.cmml">t</mi><mo id="S4.SS2.p1.4.m4.4.4.3.3.3.3.1" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.1.cmml">−</mo><mn id="S4.SS2.p1.4.m4.4.4.3.3.3.3.3" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.SS2.p1.4.m4.4.4.3.3.8" xref="S4.SS2.p1.4.m4.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.4b"><apply id="S4.SS2.p1.4.m4.4.4.cmml" xref="S4.SS2.p1.4.m4.4.4"><eq id="S4.SS2.p1.4.m4.4.4.4.cmml" xref="S4.SS2.p1.4.m4.4.4.4"></eq><apply id="S4.SS2.p1.4.m4.4.4.5.cmml" xref="S4.SS2.p1.4.m4.4.4.5"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.4.4.5.1.cmml" xref="S4.SS2.p1.4.m4.4.4.5">subscript</csymbol><ci id="S4.SS2.p1.4.m4.4.4.5.2.cmml" xref="S4.SS2.p1.4.m4.4.4.5.2">𝑺</ci><ci id="S4.SS2.p1.4.m4.4.4.5.3.cmml" xref="S4.SS2.p1.4.m4.4.4.5.3">𝑡</ci></apply><set id="S4.SS2.p1.4.m4.4.4.3.4.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3"><apply id="S4.SS2.p1.4.m4.2.2.1.1.1.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.4.m4.2.2.1.1.1.2.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.2">𝒙</ci><apply id="S4.SS2.p1.4.m4.2.2.1.1.1.3.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.3"><minus id="S4.SS2.p1.4.m4.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.3.1"></minus><ci id="S4.SS2.p1.4.m4.2.2.1.1.1.3.2.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.3.2">𝑡</ci><ci id="S4.SS2.p1.4.m4.2.2.1.1.1.3.3.cmml" xref="S4.SS2.p1.4.m4.2.2.1.1.1.3.3">𝐾</ci></apply></apply><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">…</ci><apply id="S4.SS2.p1.4.m4.3.3.2.2.2.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.3.3.2.2.2.1.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.4.m4.3.3.2.2.2.2.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.2">𝒙</ci><apply id="S4.SS2.p1.4.m4.3.3.2.2.2.3.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.3"><minus id="S4.SS2.p1.4.m4.3.3.2.2.2.3.1.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.3.1"></minus><ci id="S4.SS2.p1.4.m4.3.3.2.2.2.3.2.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.3.2">𝑡</ci><cn type="integer" id="S4.SS2.p1.4.m4.3.3.2.2.2.3.3.cmml" xref="S4.SS2.p1.4.m4.3.3.2.2.2.3.3">2</cn></apply></apply><apply id="S4.SS2.p1.4.m4.4.4.3.3.3.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.4.4.3.3.3.1.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.4.m4.4.4.3.3.3.2.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.2">𝒙</ci><apply id="S4.SS2.p1.4.m4.4.4.3.3.3.3.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3"><minus id="S4.SS2.p1.4.m4.4.4.3.3.3.3.1.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.1"></minus><ci id="S4.SS2.p1.4.m4.4.4.3.3.3.3.2.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.2">𝑡</ci><cn type="integer" id="S4.SS2.p1.4.m4.4.4.3.3.3.3.3.cmml" xref="S4.SS2.p1.4.m4.4.4.3.3.3.3.3">1</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.4c">\bm{S}_{t}=\{\bm{x}_{t-K},...,\bm{x}_{t-2},\bm{x}_{t-1}\}</annotation></semantics></math>. This forms a single input sequence to the LSTM. The corresponding label for this sequence is the energy consumption <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="e_{t}" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><msub id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">e</mi><mi id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">𝑒</ci><ci id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">e_{t}</annotation></semantics></math> at time index <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mi id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">t</annotation></semantics></math>. The task of the LSTM is therefore to learn an appropriate mapping from <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="\bm{S}\rightarrow\hat{e}_{t}" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><mrow id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">𝑺</mi><mo stretchy="false" id="S4.SS2.p1.7.m7.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.cmml">→</mo><msub id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml"><mover accent="true" id="S4.SS2.p1.7.m7.1.1.3.2" xref="S4.SS2.p1.7.m7.1.1.3.2.cmml"><mi id="S4.SS2.p1.7.m7.1.1.3.2.2" xref="S4.SS2.p1.7.m7.1.1.3.2.2.cmml">e</mi><mo id="S4.SS2.p1.7.m7.1.1.3.2.1" xref="S4.SS2.p1.7.m7.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.SS2.p1.7.m7.1.1.3.3" xref="S4.SS2.p1.7.m7.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><ci id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1">→</ci><ci id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">𝑺</ci><apply id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.3.1.cmml" xref="S4.SS2.p1.7.m7.1.1.3">subscript</csymbol><apply id="S4.SS2.p1.7.m7.1.1.3.2.cmml" xref="S4.SS2.p1.7.m7.1.1.3.2"><ci id="S4.SS2.p1.7.m7.1.1.3.2.1.cmml" xref="S4.SS2.p1.7.m7.1.1.3.2.1">^</ci><ci id="S4.SS2.p1.7.m7.1.1.3.2.2.cmml" xref="S4.SS2.p1.7.m7.1.1.3.2.2">𝑒</ci></apply><ci id="S4.SS2.p1.7.m7.1.1.3.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">\bm{S}\rightarrow\hat{e}_{t}</annotation></semantics></math> by minimising the error between the observed energy consumption <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="e_{t}" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><msub id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml"><mi id="S4.SS2.p1.8.m8.1.1.2" xref="S4.SS2.p1.8.m8.1.1.2.cmml">e</mi><mi id="S4.SS2.p1.8.m8.1.1.3" xref="S4.SS2.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><apply id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p1.8.m8.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.2">𝑒</ci><ci id="S4.SS2.p1.8.m8.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">e_{t}</annotation></semantics></math> and the predicted or forecasted energy consumption <math id="S4.SS2.p1.9.m9.1" class="ltx_Math" alttext="\hat{e}_{t}" display="inline"><semantics id="S4.SS2.p1.9.m9.1a"><msub id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml"><mover accent="true" id="S4.SS2.p1.9.m9.1.1.2" xref="S4.SS2.p1.9.m9.1.1.2.cmml"><mi id="S4.SS2.p1.9.m9.1.1.2.2" xref="S4.SS2.p1.9.m9.1.1.2.2.cmml">e</mi><mo id="S4.SS2.p1.9.m9.1.1.2.1" xref="S4.SS2.p1.9.m9.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.p1.9.m9.1.1.3" xref="S4.SS2.p1.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><apply id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.1.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">subscript</csymbol><apply id="S4.SS2.p1.9.m9.1.1.2.cmml" xref="S4.SS2.p1.9.m9.1.1.2"><ci id="S4.SS2.p1.9.m9.1.1.2.1.cmml" xref="S4.SS2.p1.9.m9.1.1.2.1">^</ci><ci id="S4.SS2.p1.9.m9.1.1.2.2.cmml" xref="S4.SS2.p1.9.m9.1.1.2.2">𝑒</ci></apply><ci id="S4.SS2.p1.9.m9.1.1.3.cmml" xref="S4.SS2.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">\hat{e}_{t}</annotation></semantics></math>. For all our experiments we report the root mean squared error (RMSE) to compare the different training strategies set out in this paper:</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.1" class="ltx_Math" alttext="\text{RMSE}=\sqrt{\sum{(\hat{e}_{t}-e_{t})^{2}}/N}" display="block"><semantics id="S4.E1.m1.1a"><mrow id="S4.E1.m1.1.2" xref="S4.E1.m1.1.2.cmml"><mtext id="S4.E1.m1.1.2.2" xref="S4.E1.m1.1.2.2a.cmml">RMSE</mtext><mo id="S4.E1.m1.1.2.1" xref="S4.E1.m1.1.2.1.cmml">=</mo><msqrt id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml"><mrow id="S4.E1.m1.1.1.1" xref="S4.E1.m1.1.1.1.cmml"><mo movablelimits="false" rspace="0em" id="S4.E1.m1.1.1.1.2" xref="S4.E1.m1.1.1.1.2.cmml">∑</mo><mrow id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml"><msup id="S4.E1.m1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.cmml"><mrow id="S4.E1.m1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E1.m1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E1.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">e</mi><mo id="S4.E1.m1.1.1.1.1.1.1.1.1.2.2.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S4.E1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml">e</mi><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S4.E1.m1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E1.m1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E1.m1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.2.cmml">/</mo><mi id="S4.E1.m1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.3.cmml">N</mi></mrow></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.1b"><apply id="S4.E1.m1.1.2.cmml" xref="S4.E1.m1.1.2"><eq id="S4.E1.m1.1.2.1.cmml" xref="S4.E1.m1.1.2.1"></eq><ci id="S4.E1.m1.1.2.2a.cmml" xref="S4.E1.m1.1.2.2"><mtext id="S4.E1.m1.1.2.2.cmml" xref="S4.E1.m1.1.2.2">RMSE</mtext></ci><apply id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1"><root id="S4.E1.m1.1.1a.cmml" xref="S4.E1.m1.1.1"></root><apply id="S4.E1.m1.1.1.1.cmml" xref="S4.E1.m1.1.1.1"><sum id="S4.E1.m1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.2"></sum><apply id="S4.E1.m1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1"><divide id="S4.E1.m1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.2"></divide><apply id="S4.E1.m1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1"><minus id="S4.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.2"><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.2.2">𝑒</ci></apply><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.3.2">𝑒</ci><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><cn type="integer" id="S4.E1.m1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.3">2</cn></apply><ci id="S4.E1.m1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.1c">\text{RMSE}=\sqrt{\sum{(\hat{e}_{t}-e_{t})^{2}}/N}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.3" class="ltx_p">We chose to create sequence datasets for <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="K=6" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">K</mi><mo id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><eq id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1"></eq><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">K=6</annotation></semantics></math>, <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="K=12" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">K</mi><mo id="S4.SS2.p3.2.m2.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">12</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><eq id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1"></eq><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝐾</ci><cn type="integer" id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">K=12</annotation></semantics></math> and <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="K=24" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">K</mi><mo id="S4.SS2.p3.3.m3.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">24</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><eq id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1"></eq><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝐾</ci><cn type="integer" id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">K=24</annotation></semantics></math> hours. As we started with two design matrices (with and without weather data fused), this results in 6 sequence datasets for each household which we denote:</p>
</div>
<div class="ltx_pagination ltx_role_start_2_columns"></div>
<div id="S4.SS2.p4" class="ltx_para">
<ul id="S4.I3" class="ltx_itemize">
<li id="S4.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.i1.p1" class="ltx_para">
<p id="S4.I3.i1.p1.1" class="ltx_p"><math id="S4.I3.i1.p1.1.m1.2" class="ltx_Math" alttext="\bm{S}_{K=6,\text{+weather}}" display="inline"><semantics id="S4.I3.i1.p1.1.m1.2a"><msub id="S4.I3.i1.p1.1.m1.2.3" xref="S4.I3.i1.p1.1.m1.2.3.cmml"><mi id="S4.I3.i1.p1.1.m1.2.3.2" xref="S4.I3.i1.p1.1.m1.2.3.2.cmml">𝑺</mi><mrow id="S4.I3.i1.p1.1.m1.2.2.2" xref="S4.I3.i1.p1.1.m1.2.2.2.cmml"><mi id="S4.I3.i1.p1.1.m1.2.2.2.4" xref="S4.I3.i1.p1.1.m1.2.2.2.4.cmml">K</mi><mo id="S4.I3.i1.p1.1.m1.2.2.2.3" xref="S4.I3.i1.p1.1.m1.2.2.2.3.cmml">=</mo><mrow id="S4.I3.i1.p1.1.m1.2.2.2.5.2" xref="S4.I3.i1.p1.1.m1.2.2.2.5.1.cmml"><mn id="S4.I3.i1.p1.1.m1.1.1.1.1" xref="S4.I3.i1.p1.1.m1.1.1.1.1.cmml">6</mn><mo id="S4.I3.i1.p1.1.m1.2.2.2.5.2.1" xref="S4.I3.i1.p1.1.m1.2.2.2.5.1.cmml">,</mo><mtext id="S4.I3.i1.p1.1.m1.2.2.2.2" xref="S4.I3.i1.p1.1.m1.2.2.2.2a.cmml">+weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I3.i1.p1.1.m1.2b"><apply id="S4.I3.i1.p1.1.m1.2.3.cmml" xref="S4.I3.i1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I3.i1.p1.1.m1.2.3.1.cmml" xref="S4.I3.i1.p1.1.m1.2.3">subscript</csymbol><ci id="S4.I3.i1.p1.1.m1.2.3.2.cmml" xref="S4.I3.i1.p1.1.m1.2.3.2">𝑺</ci><apply id="S4.I3.i1.p1.1.m1.2.2.2.cmml" xref="S4.I3.i1.p1.1.m1.2.2.2"><eq id="S4.I3.i1.p1.1.m1.2.2.2.3.cmml" xref="S4.I3.i1.p1.1.m1.2.2.2.3"></eq><ci id="S4.I3.i1.p1.1.m1.2.2.2.4.cmml" xref="S4.I3.i1.p1.1.m1.2.2.2.4">𝐾</ci><list id="S4.I3.i1.p1.1.m1.2.2.2.5.1.cmml" xref="S4.I3.i1.p1.1.m1.2.2.2.5.2"><cn type="integer" id="S4.I3.i1.p1.1.m1.1.1.1.1.cmml" xref="S4.I3.i1.p1.1.m1.1.1.1.1">6</cn><ci id="S4.I3.i1.p1.1.m1.2.2.2.2a.cmml" xref="S4.I3.i1.p1.1.m1.2.2.2.2"><mtext mathsize="70%" id="S4.I3.i1.p1.1.m1.2.2.2.2.cmml" xref="S4.I3.i1.p1.1.m1.2.2.2.2">+weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i1.p1.1.m1.2c">\bm{S}_{K=6,\text{+weather}}</annotation></semantics></math></p>
</div>
</li>
<li id="S4.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.i2.p1" class="ltx_para">
<p id="S4.I3.i2.p1.1" class="ltx_p"><math id="S4.I3.i2.p1.1.m1.2" class="ltx_Math" alttext="\bm{S}_{K=12,\text{+weather}}" display="inline"><semantics id="S4.I3.i2.p1.1.m1.2a"><msub id="S4.I3.i2.p1.1.m1.2.3" xref="S4.I3.i2.p1.1.m1.2.3.cmml"><mi id="S4.I3.i2.p1.1.m1.2.3.2" xref="S4.I3.i2.p1.1.m1.2.3.2.cmml">𝑺</mi><mrow id="S4.I3.i2.p1.1.m1.2.2.2" xref="S4.I3.i2.p1.1.m1.2.2.2.cmml"><mi id="S4.I3.i2.p1.1.m1.2.2.2.4" xref="S4.I3.i2.p1.1.m1.2.2.2.4.cmml">K</mi><mo id="S4.I3.i2.p1.1.m1.2.2.2.3" xref="S4.I3.i2.p1.1.m1.2.2.2.3.cmml">=</mo><mrow id="S4.I3.i2.p1.1.m1.2.2.2.5.2" xref="S4.I3.i2.p1.1.m1.2.2.2.5.1.cmml"><mn id="S4.I3.i2.p1.1.m1.1.1.1.1" xref="S4.I3.i2.p1.1.m1.1.1.1.1.cmml">12</mn><mo id="S4.I3.i2.p1.1.m1.2.2.2.5.2.1" xref="S4.I3.i2.p1.1.m1.2.2.2.5.1.cmml">,</mo><mtext id="S4.I3.i2.p1.1.m1.2.2.2.2" xref="S4.I3.i2.p1.1.m1.2.2.2.2a.cmml">+weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I3.i2.p1.1.m1.2b"><apply id="S4.I3.i2.p1.1.m1.2.3.cmml" xref="S4.I3.i2.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I3.i2.p1.1.m1.2.3.1.cmml" xref="S4.I3.i2.p1.1.m1.2.3">subscript</csymbol><ci id="S4.I3.i2.p1.1.m1.2.3.2.cmml" xref="S4.I3.i2.p1.1.m1.2.3.2">𝑺</ci><apply id="S4.I3.i2.p1.1.m1.2.2.2.cmml" xref="S4.I3.i2.p1.1.m1.2.2.2"><eq id="S4.I3.i2.p1.1.m1.2.2.2.3.cmml" xref="S4.I3.i2.p1.1.m1.2.2.2.3"></eq><ci id="S4.I3.i2.p1.1.m1.2.2.2.4.cmml" xref="S4.I3.i2.p1.1.m1.2.2.2.4">𝐾</ci><list id="S4.I3.i2.p1.1.m1.2.2.2.5.1.cmml" xref="S4.I3.i2.p1.1.m1.2.2.2.5.2"><cn type="integer" id="S4.I3.i2.p1.1.m1.1.1.1.1.cmml" xref="S4.I3.i2.p1.1.m1.1.1.1.1">12</cn><ci id="S4.I3.i2.p1.1.m1.2.2.2.2a.cmml" xref="S4.I3.i2.p1.1.m1.2.2.2.2"><mtext mathsize="70%" id="S4.I3.i2.p1.1.m1.2.2.2.2.cmml" xref="S4.I3.i2.p1.1.m1.2.2.2.2">+weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i2.p1.1.m1.2c">\bm{S}_{K=12,\text{+weather}}</annotation></semantics></math></p>
</div>
</li>
<li id="S4.I3.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.i3.p1" class="ltx_para">
<p id="S4.I3.i3.p1.1" class="ltx_p"><math id="S4.I3.i3.p1.1.m1.2" class="ltx_Math" alttext="\bm{S}_{K=24,\text{+weather}}" display="inline"><semantics id="S4.I3.i3.p1.1.m1.2a"><msub id="S4.I3.i3.p1.1.m1.2.3" xref="S4.I3.i3.p1.1.m1.2.3.cmml"><mi id="S4.I3.i3.p1.1.m1.2.3.2" xref="S4.I3.i3.p1.1.m1.2.3.2.cmml">𝑺</mi><mrow id="S4.I3.i3.p1.1.m1.2.2.2" xref="S4.I3.i3.p1.1.m1.2.2.2.cmml"><mi id="S4.I3.i3.p1.1.m1.2.2.2.4" xref="S4.I3.i3.p1.1.m1.2.2.2.4.cmml">K</mi><mo id="S4.I3.i3.p1.1.m1.2.2.2.3" xref="S4.I3.i3.p1.1.m1.2.2.2.3.cmml">=</mo><mrow id="S4.I3.i3.p1.1.m1.2.2.2.5.2" xref="S4.I3.i3.p1.1.m1.2.2.2.5.1.cmml"><mn id="S4.I3.i3.p1.1.m1.1.1.1.1" xref="S4.I3.i3.p1.1.m1.1.1.1.1.cmml">24</mn><mo id="S4.I3.i3.p1.1.m1.2.2.2.5.2.1" xref="S4.I3.i3.p1.1.m1.2.2.2.5.1.cmml">,</mo><mtext id="S4.I3.i3.p1.1.m1.2.2.2.2" xref="S4.I3.i3.p1.1.m1.2.2.2.2a.cmml">+weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I3.i3.p1.1.m1.2b"><apply id="S4.I3.i3.p1.1.m1.2.3.cmml" xref="S4.I3.i3.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I3.i3.p1.1.m1.2.3.1.cmml" xref="S4.I3.i3.p1.1.m1.2.3">subscript</csymbol><ci id="S4.I3.i3.p1.1.m1.2.3.2.cmml" xref="S4.I3.i3.p1.1.m1.2.3.2">𝑺</ci><apply id="S4.I3.i3.p1.1.m1.2.2.2.cmml" xref="S4.I3.i3.p1.1.m1.2.2.2"><eq id="S4.I3.i3.p1.1.m1.2.2.2.3.cmml" xref="S4.I3.i3.p1.1.m1.2.2.2.3"></eq><ci id="S4.I3.i3.p1.1.m1.2.2.2.4.cmml" xref="S4.I3.i3.p1.1.m1.2.2.2.4">𝐾</ci><list id="S4.I3.i3.p1.1.m1.2.2.2.5.1.cmml" xref="S4.I3.i3.p1.1.m1.2.2.2.5.2"><cn type="integer" id="S4.I3.i3.p1.1.m1.1.1.1.1.cmml" xref="S4.I3.i3.p1.1.m1.1.1.1.1">24</cn><ci id="S4.I3.i3.p1.1.m1.2.2.2.2a.cmml" xref="S4.I3.i3.p1.1.m1.2.2.2.2"><mtext mathsize="70%" id="S4.I3.i3.p1.1.m1.2.2.2.2.cmml" xref="S4.I3.i3.p1.1.m1.2.2.2.2">+weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i3.p1.1.m1.2c">\bm{S}_{K=24,\text{+weather}}</annotation></semantics></math></p>
</div>
</li>
<li id="S4.I3.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.i4.p1" class="ltx_para">
<p id="S4.I3.i4.p1.1" class="ltx_p"><math id="S4.I3.i4.p1.1.m1.2" class="ltx_Math" alttext="\bm{S}_{K=6,\text{-weather}}" display="inline"><semantics id="S4.I3.i4.p1.1.m1.2a"><msub id="S4.I3.i4.p1.1.m1.2.3" xref="S4.I3.i4.p1.1.m1.2.3.cmml"><mi id="S4.I3.i4.p1.1.m1.2.3.2" xref="S4.I3.i4.p1.1.m1.2.3.2.cmml">𝑺</mi><mrow id="S4.I3.i4.p1.1.m1.2.2.2" xref="S4.I3.i4.p1.1.m1.2.2.2.cmml"><mi id="S4.I3.i4.p1.1.m1.2.2.2.4" xref="S4.I3.i4.p1.1.m1.2.2.2.4.cmml">K</mi><mo id="S4.I3.i4.p1.1.m1.2.2.2.3" xref="S4.I3.i4.p1.1.m1.2.2.2.3.cmml">=</mo><mrow id="S4.I3.i4.p1.1.m1.2.2.2.5.2" xref="S4.I3.i4.p1.1.m1.2.2.2.5.1.cmml"><mn id="S4.I3.i4.p1.1.m1.1.1.1.1" xref="S4.I3.i4.p1.1.m1.1.1.1.1.cmml">6</mn><mo id="S4.I3.i4.p1.1.m1.2.2.2.5.2.1" xref="S4.I3.i4.p1.1.m1.2.2.2.5.1.cmml">,</mo><mtext id="S4.I3.i4.p1.1.m1.2.2.2.2" xref="S4.I3.i4.p1.1.m1.2.2.2.2a.cmml">-weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I3.i4.p1.1.m1.2b"><apply id="S4.I3.i4.p1.1.m1.2.3.cmml" xref="S4.I3.i4.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I3.i4.p1.1.m1.2.3.1.cmml" xref="S4.I3.i4.p1.1.m1.2.3">subscript</csymbol><ci id="S4.I3.i4.p1.1.m1.2.3.2.cmml" xref="S4.I3.i4.p1.1.m1.2.3.2">𝑺</ci><apply id="S4.I3.i4.p1.1.m1.2.2.2.cmml" xref="S4.I3.i4.p1.1.m1.2.2.2"><eq id="S4.I3.i4.p1.1.m1.2.2.2.3.cmml" xref="S4.I3.i4.p1.1.m1.2.2.2.3"></eq><ci id="S4.I3.i4.p1.1.m1.2.2.2.4.cmml" xref="S4.I3.i4.p1.1.m1.2.2.2.4">𝐾</ci><list id="S4.I3.i4.p1.1.m1.2.2.2.5.1.cmml" xref="S4.I3.i4.p1.1.m1.2.2.2.5.2"><cn type="integer" id="S4.I3.i4.p1.1.m1.1.1.1.1.cmml" xref="S4.I3.i4.p1.1.m1.1.1.1.1">6</cn><ci id="S4.I3.i4.p1.1.m1.2.2.2.2a.cmml" xref="S4.I3.i4.p1.1.m1.2.2.2.2"><mtext mathsize="70%" id="S4.I3.i4.p1.1.m1.2.2.2.2.cmml" xref="S4.I3.i4.p1.1.m1.2.2.2.2">-weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i4.p1.1.m1.2c">\bm{S}_{K=6,\text{-weather}}</annotation></semantics></math></p>
</div>
</li>
<li id="S4.I3.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.i5.p1" class="ltx_para">
<p id="S4.I3.i5.p1.1" class="ltx_p"><math id="S4.I3.i5.p1.1.m1.2" class="ltx_Math" alttext="\bm{S}_{K=12,\text{-weather}}" display="inline"><semantics id="S4.I3.i5.p1.1.m1.2a"><msub id="S4.I3.i5.p1.1.m1.2.3" xref="S4.I3.i5.p1.1.m1.2.3.cmml"><mi id="S4.I3.i5.p1.1.m1.2.3.2" xref="S4.I3.i5.p1.1.m1.2.3.2.cmml">𝑺</mi><mrow id="S4.I3.i5.p1.1.m1.2.2.2" xref="S4.I3.i5.p1.1.m1.2.2.2.cmml"><mi id="S4.I3.i5.p1.1.m1.2.2.2.4" xref="S4.I3.i5.p1.1.m1.2.2.2.4.cmml">K</mi><mo id="S4.I3.i5.p1.1.m1.2.2.2.3" xref="S4.I3.i5.p1.1.m1.2.2.2.3.cmml">=</mo><mrow id="S4.I3.i5.p1.1.m1.2.2.2.5.2" xref="S4.I3.i5.p1.1.m1.2.2.2.5.1.cmml"><mn id="S4.I3.i5.p1.1.m1.1.1.1.1" xref="S4.I3.i5.p1.1.m1.1.1.1.1.cmml">12</mn><mo id="S4.I3.i5.p1.1.m1.2.2.2.5.2.1" xref="S4.I3.i5.p1.1.m1.2.2.2.5.1.cmml">,</mo><mtext id="S4.I3.i5.p1.1.m1.2.2.2.2" xref="S4.I3.i5.p1.1.m1.2.2.2.2a.cmml">-weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I3.i5.p1.1.m1.2b"><apply id="S4.I3.i5.p1.1.m1.2.3.cmml" xref="S4.I3.i5.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I3.i5.p1.1.m1.2.3.1.cmml" xref="S4.I3.i5.p1.1.m1.2.3">subscript</csymbol><ci id="S4.I3.i5.p1.1.m1.2.3.2.cmml" xref="S4.I3.i5.p1.1.m1.2.3.2">𝑺</ci><apply id="S4.I3.i5.p1.1.m1.2.2.2.cmml" xref="S4.I3.i5.p1.1.m1.2.2.2"><eq id="S4.I3.i5.p1.1.m1.2.2.2.3.cmml" xref="S4.I3.i5.p1.1.m1.2.2.2.3"></eq><ci id="S4.I3.i5.p1.1.m1.2.2.2.4.cmml" xref="S4.I3.i5.p1.1.m1.2.2.2.4">𝐾</ci><list id="S4.I3.i5.p1.1.m1.2.2.2.5.1.cmml" xref="S4.I3.i5.p1.1.m1.2.2.2.5.2"><cn type="integer" id="S4.I3.i5.p1.1.m1.1.1.1.1.cmml" xref="S4.I3.i5.p1.1.m1.1.1.1.1">12</cn><ci id="S4.I3.i5.p1.1.m1.2.2.2.2a.cmml" xref="S4.I3.i5.p1.1.m1.2.2.2.2"><mtext mathsize="70%" id="S4.I3.i5.p1.1.m1.2.2.2.2.cmml" xref="S4.I3.i5.p1.1.m1.2.2.2.2">-weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i5.p1.1.m1.2c">\bm{S}_{K=12,\text{-weather}}</annotation></semantics></math></p>
</div>
</li>
<li id="S4.I3.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.i6.p1" class="ltx_para">
<p id="S4.I3.i6.p1.1" class="ltx_p"><math id="S4.I3.i6.p1.1.m1.2" class="ltx_Math" alttext="\bm{S}_{K=24,\text{-weather}}" display="inline"><semantics id="S4.I3.i6.p1.1.m1.2a"><msub id="S4.I3.i6.p1.1.m1.2.3" xref="S4.I3.i6.p1.1.m1.2.3.cmml"><mi id="S4.I3.i6.p1.1.m1.2.3.2" xref="S4.I3.i6.p1.1.m1.2.3.2.cmml">𝑺</mi><mrow id="S4.I3.i6.p1.1.m1.2.2.2" xref="S4.I3.i6.p1.1.m1.2.2.2.cmml"><mi id="S4.I3.i6.p1.1.m1.2.2.2.4" xref="S4.I3.i6.p1.1.m1.2.2.2.4.cmml">K</mi><mo id="S4.I3.i6.p1.1.m1.2.2.2.3" xref="S4.I3.i6.p1.1.m1.2.2.2.3.cmml">=</mo><mrow id="S4.I3.i6.p1.1.m1.2.2.2.5.2" xref="S4.I3.i6.p1.1.m1.2.2.2.5.1.cmml"><mn id="S4.I3.i6.p1.1.m1.1.1.1.1" xref="S4.I3.i6.p1.1.m1.1.1.1.1.cmml">24</mn><mo id="S4.I3.i6.p1.1.m1.2.2.2.5.2.1" xref="S4.I3.i6.p1.1.m1.2.2.2.5.1.cmml">,</mo><mtext id="S4.I3.i6.p1.1.m1.2.2.2.2" xref="S4.I3.i6.p1.1.m1.2.2.2.2a.cmml">-weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I3.i6.p1.1.m1.2b"><apply id="S4.I3.i6.p1.1.m1.2.3.cmml" xref="S4.I3.i6.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.I3.i6.p1.1.m1.2.3.1.cmml" xref="S4.I3.i6.p1.1.m1.2.3">subscript</csymbol><ci id="S4.I3.i6.p1.1.m1.2.3.2.cmml" xref="S4.I3.i6.p1.1.m1.2.3.2">𝑺</ci><apply id="S4.I3.i6.p1.1.m1.2.2.2.cmml" xref="S4.I3.i6.p1.1.m1.2.2.2"><eq id="S4.I3.i6.p1.1.m1.2.2.2.3.cmml" xref="S4.I3.i6.p1.1.m1.2.2.2.3"></eq><ci id="S4.I3.i6.p1.1.m1.2.2.2.4.cmml" xref="S4.I3.i6.p1.1.m1.2.2.2.4">𝐾</ci><list id="S4.I3.i6.p1.1.m1.2.2.2.5.1.cmml" xref="S4.I3.i6.p1.1.m1.2.2.2.5.2"><cn type="integer" id="S4.I3.i6.p1.1.m1.1.1.1.1.cmml" xref="S4.I3.i6.p1.1.m1.1.1.1.1">24</cn><ci id="S4.I3.i6.p1.1.m1.2.2.2.2a.cmml" xref="S4.I3.i6.p1.1.m1.2.2.2.2"><mtext mathsize="70%" id="S4.I3.i6.p1.1.m1.2.2.2.2.cmml" xref="S4.I3.i6.p1.1.m1.2.2.2.2">-weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i6.p1.1.m1.2c">\bm{S}_{K=24,\text{-weather}}</annotation></semantics></math></p>
</div>
</li>
</ul>
<div class="ltx_pagination ltx_role_end_2_columns"></div>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.1" class="ltx_p">The forecasting task can be formally verbalised as: “Predict the current energy consumption from the preceding <math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><mi id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">K</annotation></semantics></math> hour’s energy consumption readings”.</p>
</div>
<div id="S4.SS2.p6" class="ltx_para">
<p id="S4.SS2.p6.2" class="ltx_p">As LSTMs are more efficiently optimised when the data in different dimensions are equally scaled, we apply a min-max normalisation (independently in each dimension) to the data to ensure all values fall between 0 and 1. The minimum and maximum values for <math id="S4.SS2.p6.1.m1.1" class="ltx_Math" alttext="e_{t}" display="inline"><semantics id="S4.SS2.p6.1.m1.1a"><msub id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml"><mi id="S4.SS2.p6.1.m1.1.1.2" xref="S4.SS2.p6.1.m1.1.1.2.cmml">e</mi><mi id="S4.SS2.p6.1.m1.1.1.3" xref="S4.SS2.p6.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><apply id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.1.m1.1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p6.1.m1.1.1.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2">𝑒</ci><ci id="S4.SS2.p6.1.m1.1.1.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">e_{t}</annotation></semantics></math> are drawn globally from across all the household datasets and therefore each sequence dataset <math id="S4.SS2.p6.2.m2.1" class="ltx_Math" alttext="\bm{S}" display="inline"><semantics id="S4.SS2.p6.2.m2.1a"><mi id="S4.SS2.p6.2.m2.1.1" xref="S4.SS2.p6.2.m2.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.2.m2.1b"><ci id="S4.SS2.p6.2.m2.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.2.m2.1c">\bm{S}</annotation></semantics></math> makes use of the same normalisation operation across all households.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">LSTM framework</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">The long short term memory (LTSM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> network belongs to a family of neural network architectures known as recurrent neural networks (RNNs). Such networks are designed to handle sequential data such as time series data or language fragments such as sentences. The major distinction between RNNs and standard feed forward neural networks is the ability to pass the output of hidden units back into themselves as well as incorporating gates to control the flow of past and current information. These conditions allow for learning of temporal patterns. For an energy forecasting problem a RNN can potentially learn how daily patterns of energy consumption affect future consumption by way of the memory built into RNNs.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">The LSTM is one of the most sophisticated RNN architectures in that it works exceptionally well to store long-term temporal dependencies. Earlier RNN architectural designs are plagued with issues related to vanishing or exploding gradients during training via backpropagation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. Such issues resulted in the network becoming unable to learn anything from information earlier in the sequence beyond the preceding few time steps. LSTMs introduce an internal memory state that can persist over many time steps allowing the network to learn from long-term patterns.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.13" class="ltx_p">In each LSTM cell, an internal state <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="\bm{c}_{t}" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><msub id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2.cmml">𝒄</mi><mi id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2">𝒄</ci><ci id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\bm{c}_{t}</annotation></semantics></math> is regulated by a forget gate <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="\bm{f}_{t}" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><msub id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">𝒇</mi><mi id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">𝒇</ci><ci id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">\bm{f}_{t}</annotation></semantics></math> controlling the weight of information from the output during the previous time step <math id="S4.SS3.p3.3.m3.1" class="ltx_Math" alttext="\bm{h}_{t-1}" display="inline"><semantics id="S4.SS3.p3.3.m3.1a"><msub id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml"><mi id="S4.SS3.p3.3.m3.1.1.2" xref="S4.SS3.p3.3.m3.1.1.2.cmml">𝒉</mi><mrow id="S4.SS3.p3.3.m3.1.1.3" xref="S4.SS3.p3.3.m3.1.1.3.cmml"><mi id="S4.SS3.p3.3.m3.1.1.3.2" xref="S4.SS3.p3.3.m3.1.1.3.2.cmml">t</mi><mo id="S4.SS3.p3.3.m3.1.1.3.1" xref="S4.SS3.p3.3.m3.1.1.3.1.cmml">−</mo><mn id="S4.SS3.p3.3.m3.1.1.3.3" xref="S4.SS3.p3.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p3.3.m3.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.2">𝒉</ci><apply id="S4.SS3.p3.3.m3.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3"><minus id="S4.SS3.p3.3.m3.1.1.3.1.cmml" xref="S4.SS3.p3.3.m3.1.1.3.1"></minus><ci id="S4.SS3.p3.3.m3.1.1.3.2.cmml" xref="S4.SS3.p3.3.m3.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS3.p3.3.m3.1.1.3.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">\bm{h}_{t-1}</annotation></semantics></math> and the input for the current time step <math id="S4.SS3.p3.4.m4.1" class="ltx_Math" alttext="\bm{x}_{t}" display="inline"><semantics id="S4.SS3.p3.4.m4.1a"><msub id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml"><mi id="S4.SS3.p3.4.m4.1.1.2" xref="S4.SS3.p3.4.m4.1.1.2.cmml">𝒙</mi><mi id="S4.SS3.p3.4.m4.1.1.3" xref="S4.SS3.p3.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><apply id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m4.1.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p3.4.m4.1.1.2.cmml" xref="S4.SS3.p3.4.m4.1.1.2">𝒙</ci><ci id="S4.SS3.p3.4.m4.1.1.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">\bm{x}_{t}</annotation></semantics></math>. The input feature for the current time step <math id="S4.SS3.p3.5.m5.1" class="ltx_Math" alttext="\bm{i}_{t}" display="inline"><semantics id="S4.SS3.p3.5.m5.1a"><msub id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml"><mi id="S4.SS3.p3.5.m5.1.1.2" xref="S4.SS3.p3.5.m5.1.1.2.cmml">𝒊</mi><mi id="S4.SS3.p3.5.m5.1.1.3" xref="S4.SS3.p3.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><apply id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m5.1.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p3.5.m5.1.1.2.cmml" xref="S4.SS3.p3.5.m5.1.1.2">𝒊</ci><ci id="S4.SS3.p3.5.m5.1.1.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">\bm{i}_{t}</annotation></semantics></math> is accumulated into the internal state under the influence of the input gate <math id="S4.SS3.p3.6.m6.1" class="ltx_Math" alttext="\bm{g}_{t}" display="inline"><semantics id="S4.SS3.p3.6.m6.1a"><msub id="S4.SS3.p3.6.m6.1.1" xref="S4.SS3.p3.6.m6.1.1.cmml"><mi id="S4.SS3.p3.6.m6.1.1.2" xref="S4.SS3.p3.6.m6.1.1.2.cmml">𝒈</mi><mi id="S4.SS3.p3.6.m6.1.1.3" xref="S4.SS3.p3.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.1b"><apply id="S4.SS3.p3.6.m6.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.1.2.cmml" xref="S4.SS3.p3.6.m6.1.1.2">𝒈</ci><ci id="S4.SS3.p3.6.m6.1.1.3.cmml" xref="S4.SS3.p3.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.1c">\bm{g}_{t}</annotation></semantics></math>. Finally the output gate <math id="S4.SS3.p3.7.m7.1" class="ltx_Math" alttext="\bm{o}_{t}" display="inline"><semantics id="S4.SS3.p3.7.m7.1a"><msub id="S4.SS3.p3.7.m7.1.1" xref="S4.SS3.p3.7.m7.1.1.cmml"><mi id="S4.SS3.p3.7.m7.1.1.2" xref="S4.SS3.p3.7.m7.1.1.2.cmml">𝒐</mi><mi id="S4.SS3.p3.7.m7.1.1.3" xref="S4.SS3.p3.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m7.1b"><apply id="S4.SS3.p3.7.m7.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m7.1.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.p3.7.m7.1.1.2.cmml" xref="S4.SS3.p3.7.m7.1.1.2">𝒐</ci><ci id="S4.SS3.p3.7.m7.1.1.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m7.1c">\bm{o}_{t}</annotation></semantics></math> governs the output <math id="S4.SS3.p3.8.m8.1" class="ltx_Math" alttext="\bm{h}_{t}" display="inline"><semantics id="S4.SS3.p3.8.m8.1a"><msub id="S4.SS3.p3.8.m8.1.1" xref="S4.SS3.p3.8.m8.1.1.cmml"><mi id="S4.SS3.p3.8.m8.1.1.2" xref="S4.SS3.p3.8.m8.1.1.2.cmml">𝒉</mi><mi id="S4.SS3.p3.8.m8.1.1.3" xref="S4.SS3.p3.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m8.1b"><apply id="S4.SS3.p3.8.m8.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m8.1.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1">subscript</csymbol><ci id="S4.SS3.p3.8.m8.1.1.2.cmml" xref="S4.SS3.p3.8.m8.1.1.2">𝒉</ci><ci id="S4.SS3.p3.8.m8.1.1.3.cmml" xref="S4.SS3.p3.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m8.1c">\bm{h}_{t}</annotation></semantics></math> formed from the inputs and the internal cell state. The new internal state <math id="S4.SS3.p3.9.m9.1" class="ltx_Math" alttext="\bm{c}_{t}" display="inline"><semantics id="S4.SS3.p3.9.m9.1a"><msub id="S4.SS3.p3.9.m9.1.1" xref="S4.SS3.p3.9.m9.1.1.cmml"><mi id="S4.SS3.p3.9.m9.1.1.2" xref="S4.SS3.p3.9.m9.1.1.2.cmml">𝒄</mi><mi id="S4.SS3.p3.9.m9.1.1.3" xref="S4.SS3.p3.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.9.m9.1b"><apply id="S4.SS3.p3.9.m9.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.1.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1">subscript</csymbol><ci id="S4.SS3.p3.9.m9.1.1.2.cmml" xref="S4.SS3.p3.9.m9.1.1.2">𝒄</ci><ci id="S4.SS3.p3.9.m9.1.1.3.cmml" xref="S4.SS3.p3.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.9.m9.1c">\bm{c}_{t}</annotation></semantics></math> and cell output <math id="S4.SS3.p3.10.m10.1" class="ltx_Math" alttext="\bm{h}_{t}" display="inline"><semantics id="S4.SS3.p3.10.m10.1a"><msub id="S4.SS3.p3.10.m10.1.1" xref="S4.SS3.p3.10.m10.1.1.cmml"><mi id="S4.SS3.p3.10.m10.1.1.2" xref="S4.SS3.p3.10.m10.1.1.2.cmml">𝒉</mi><mi id="S4.SS3.p3.10.m10.1.1.3" xref="S4.SS3.p3.10.m10.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.10.m10.1b"><apply id="S4.SS3.p3.10.m10.1.1.cmml" xref="S4.SS3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.10.m10.1.1.1.cmml" xref="S4.SS3.p3.10.m10.1.1">subscript</csymbol><ci id="S4.SS3.p3.10.m10.1.1.2.cmml" xref="S4.SS3.p3.10.m10.1.1.2">𝒉</ci><ci id="S4.SS3.p3.10.m10.1.1.3.cmml" xref="S4.SS3.p3.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.10.m10.1c">\bm{h}_{t}</annotation></semantics></math> become inputs for the the cell at the next time step (additionally the final cell output <math id="S4.SS3.p3.11.m11.1" class="ltx_Math" alttext="\bm{h}_{t}" display="inline"><semantics id="S4.SS3.p3.11.m11.1a"><msub id="S4.SS3.p3.11.m11.1.1" xref="S4.SS3.p3.11.m11.1.1.cmml"><mi id="S4.SS3.p3.11.m11.1.1.2" xref="S4.SS3.p3.11.m11.1.1.2.cmml">𝒉</mi><mi id="S4.SS3.p3.11.m11.1.1.3" xref="S4.SS3.p3.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.11.m11.1b"><apply id="S4.SS3.p3.11.m11.1.1.cmml" xref="S4.SS3.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.11.m11.1.1.1.cmml" xref="S4.SS3.p3.11.m11.1.1">subscript</csymbol><ci id="S4.SS3.p3.11.m11.1.1.2.cmml" xref="S4.SS3.p3.11.m11.1.1.2">𝒉</ci><ci id="S4.SS3.p3.11.m11.1.1.3.cmml" xref="S4.SS3.p3.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.11.m11.1c">\bm{h}_{t}</annotation></semantics></math> is passed to the next layer in a deep network). The memory cell state <math id="S4.SS3.p3.12.m12.1" class="ltx_Math" alttext="\bm{c}_{t}" display="inline"><semantics id="S4.SS3.p3.12.m12.1a"><msub id="S4.SS3.p3.12.m12.1.1" xref="S4.SS3.p3.12.m12.1.1.cmml"><mi id="S4.SS3.p3.12.m12.1.1.2" xref="S4.SS3.p3.12.m12.1.1.2.cmml">𝒄</mi><mi id="S4.SS3.p3.12.m12.1.1.3" xref="S4.SS3.p3.12.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.12.m12.1b"><apply id="S4.SS3.p3.12.m12.1.1.cmml" xref="S4.SS3.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.12.m12.1.1.1.cmml" xref="S4.SS3.p3.12.m12.1.1">subscript</csymbol><ci id="S4.SS3.p3.12.m12.1.1.2.cmml" xref="S4.SS3.p3.12.m12.1.1.2">𝒄</ci><ci id="S4.SS3.p3.12.m12.1.1.3.cmml" xref="S4.SS3.p3.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.12.m12.1c">\bm{c}_{t}</annotation></semantics></math> and output activation <math id="S4.SS3.p3.13.m13.1" class="ltx_Math" alttext="\bm{h}_{t}" display="inline"><semantics id="S4.SS3.p3.13.m13.1a"><msub id="S4.SS3.p3.13.m13.1.1" xref="S4.SS3.p3.13.m13.1.1.cmml"><mi id="S4.SS3.p3.13.m13.1.1.2" xref="S4.SS3.p3.13.m13.1.1.2.cmml">𝒉</mi><mi id="S4.SS3.p3.13.m13.1.1.3" xref="S4.SS3.p3.13.m13.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.13.m13.1b"><apply id="S4.SS3.p3.13.m13.1.1.cmml" xref="S4.SS3.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.13.m13.1.1.1.cmml" xref="S4.SS3.p3.13.m13.1.1">subscript</csymbol><ci id="S4.SS3.p3.13.m13.1.1.2.cmml" xref="S4.SS3.p3.13.m13.1.1.2">𝒉</ci><ci id="S4.SS3.p3.13.m13.1.1.3.cmml" xref="S4.SS3.p3.13.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.13.m13.1c">\bm{h}_{t}</annotation></semantics></math> are calculated using equations <a href="#S4.E2" title="In IV-C LSTM framework ‣ IV Methodology ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> to <a href="#S4.E7" title="In IV-C LSTM framework ‣ IV Methodology ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<table id="Sx1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E2.m1.20" class="ltx_Math" alttext="\displaystyle\begin{split}\bm{f}_{t}=\sigma(\bm{W}_{fx}\bm{x}_{t}+\bm{W}_{fh}\bm{h}_{t-1}+\bm{b}_{f})\end{split}" display="inline"><semantics id="S4.E2.m1.20a"><mtable id="S4.E2.m1.20.20.2" xref="S4.E2.m1.19.19.1.cmml"><mtr id="S4.E2.m1.20.20.2a" xref="S4.E2.m1.19.19.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S4.E2.m1.20.20.2b" xref="S4.E2.m1.19.19.1.cmml"><mrow id="S4.E2.m1.20.20.2.19.19.19" xref="S4.E2.m1.19.19.1.cmml"><msub id="S4.E2.m1.20.20.2.19.19.19.20" xref="S4.E2.m1.19.19.1.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml">𝒇</mi><mi id="S4.E2.m1.2.2.2.2.2.2.1" xref="S4.E2.m1.2.2.2.2.2.2.1.cmml">t</mi></msub><mo id="S4.E2.m1.3.3.3.3.3.3" xref="S4.E2.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E2.m1.20.20.2.19.19.19.19" xref="S4.E2.m1.19.19.1.cmml"><mi id="S4.E2.m1.4.4.4.4.4.4" xref="S4.E2.m1.4.4.4.4.4.4.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.20.20.2.19.19.19.19.2" xref="S4.E2.m1.19.19.1.cmml">​</mo><mrow id="S4.E2.m1.20.20.2.19.19.19.19.1.1" xref="S4.E2.m1.19.19.1.cmml"><mo stretchy="false" id="S4.E2.m1.5.5.5.5.5.5" xref="S4.E2.m1.19.19.1.cmml">(</mo><mrow id="S4.E2.m1.20.20.2.19.19.19.19.1.1.1" xref="S4.E2.m1.19.19.1.cmml"><mrow id="S4.E2.m1.20.20.2.19.19.19.19.1.1.1.1" xref="S4.E2.m1.19.19.1.cmml"><msub id="S4.E2.m1.20.20.2.19.19.19.19.1.1.1.1.2" xref="S4.E2.m1.19.19.1.cmml"><mi id="S4.E2.m1.6.6.6.6.6.6" xref="S4.E2.m1.6.6.6.6.6.6.cmml">𝑾</mi><mrow id="S4.E2.m1.7.7.7.7.7.7.1" xref="S4.E2.m1.7.7.7.7.7.7.1.cmml"><mi id="S4.E2.m1.7.7.7.7.7.7.1.2" xref="S4.E2.m1.7.7.7.7.7.7.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.7.7.7.7.7.7.1.1" xref="S4.E2.m1.7.7.7.7.7.7.1.1.cmml">​</mo><mi id="S4.E2.m1.7.7.7.7.7.7.1.3" xref="S4.E2.m1.7.7.7.7.7.7.1.3.cmml">x</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.20.20.2.19.19.19.19.1.1.1.1.1" xref="S4.E2.m1.19.19.1.cmml">​</mo><msub id="S4.E2.m1.20.20.2.19.19.19.19.1.1.1.1.3" xref="S4.E2.m1.19.19.1.cmml"><mi id="S4.E2.m1.8.8.8.8.8.8" xref="S4.E2.m1.8.8.8.8.8.8.cmml">𝒙</mi><mi id="S4.E2.m1.9.9.9.9.9.9.1" xref="S4.E2.m1.9.9.9.9.9.9.1.cmml">t</mi></msub></mrow><mo id="S4.E2.m1.10.10.10.10.10.10" xref="S4.E2.m1.10.10.10.10.10.10.cmml">+</mo><mrow id="S4.E2.m1.20.20.2.19.19.19.19.1.1.1.2" xref="S4.E2.m1.19.19.1.cmml"><msub id="S4.E2.m1.20.20.2.19.19.19.19.1.1.1.2.2" xref="S4.E2.m1.19.19.1.cmml"><mi id="S4.E2.m1.11.11.11.11.11.11" xref="S4.E2.m1.11.11.11.11.11.11.cmml">𝑾</mi><mrow id="S4.E2.m1.12.12.12.12.12.12.1" xref="S4.E2.m1.12.12.12.12.12.12.1.cmml"><mi id="S4.E2.m1.12.12.12.12.12.12.1.2" xref="S4.E2.m1.12.12.12.12.12.12.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.12.12.12.12.12.12.1.1" xref="S4.E2.m1.12.12.12.12.12.12.1.1.cmml">​</mo><mi id="S4.E2.m1.12.12.12.12.12.12.1.3" xref="S4.E2.m1.12.12.12.12.12.12.1.3.cmml">h</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.20.20.2.19.19.19.19.1.1.1.2.1" xref="S4.E2.m1.19.19.1.cmml">​</mo><msub id="S4.E2.m1.20.20.2.19.19.19.19.1.1.1.2.3" xref="S4.E2.m1.19.19.1.cmml"><mi id="S4.E2.m1.13.13.13.13.13.13" xref="S4.E2.m1.13.13.13.13.13.13.cmml">𝒉</mi><mrow id="S4.E2.m1.14.14.14.14.14.14.1" xref="S4.E2.m1.14.14.14.14.14.14.1.cmml"><mi id="S4.E2.m1.14.14.14.14.14.14.1.2" xref="S4.E2.m1.14.14.14.14.14.14.1.2.cmml">t</mi><mo id="S4.E2.m1.14.14.14.14.14.14.1.1" xref="S4.E2.m1.14.14.14.14.14.14.1.1.cmml">−</mo><mn id="S4.E2.m1.14.14.14.14.14.14.1.3" xref="S4.E2.m1.14.14.14.14.14.14.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S4.E2.m1.10.10.10.10.10.10a" xref="S4.E2.m1.10.10.10.10.10.10.cmml">+</mo><msub id="S4.E2.m1.20.20.2.19.19.19.19.1.1.1.3" xref="S4.E2.m1.19.19.1.cmml"><mi id="S4.E2.m1.16.16.16.16.16.16" xref="S4.E2.m1.16.16.16.16.16.16.cmml">𝒃</mi><mi id="S4.E2.m1.17.17.17.17.17.17.1" xref="S4.E2.m1.17.17.17.17.17.17.1.cmml">f</mi></msub></mrow><mo stretchy="false" id="S4.E2.m1.18.18.18.18.18.18" xref="S4.E2.m1.19.19.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E2.m1.20b"><apply id="S4.E2.m1.19.19.1.cmml" xref="S4.E2.m1.20.20.2"><eq id="S4.E2.m1.3.3.3.3.3.3.cmml" xref="S4.E2.m1.3.3.3.3.3.3"></eq><apply id="S4.E2.m1.19.19.1.3.cmml" xref="S4.E2.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E2.m1.19.19.1.3.1.cmml" xref="S4.E2.m1.20.20.2">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1">𝒇</ci><ci id="S4.E2.m1.2.2.2.2.2.2.1.cmml" xref="S4.E2.m1.2.2.2.2.2.2.1">𝑡</ci></apply><apply id="S4.E2.m1.19.19.1.1.cmml" xref="S4.E2.m1.20.20.2"><times id="S4.E2.m1.19.19.1.1.2.cmml" xref="S4.E2.m1.20.20.2"></times><ci id="S4.E2.m1.4.4.4.4.4.4.cmml" xref="S4.E2.m1.4.4.4.4.4.4">𝜎</ci><apply id="S4.E2.m1.19.19.1.1.1.1.1.cmml" xref="S4.E2.m1.20.20.2"><plus id="S4.E2.m1.10.10.10.10.10.10.cmml" xref="S4.E2.m1.10.10.10.10.10.10"></plus><apply id="S4.E2.m1.19.19.1.1.1.1.1.2.cmml" xref="S4.E2.m1.20.20.2"><times id="S4.E2.m1.19.19.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.20.20.2"></times><apply id="S4.E2.m1.19.19.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E2.m1.19.19.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.20.20.2">subscript</csymbol><ci id="S4.E2.m1.6.6.6.6.6.6.cmml" xref="S4.E2.m1.6.6.6.6.6.6">𝑾</ci><apply id="S4.E2.m1.7.7.7.7.7.7.1.cmml" xref="S4.E2.m1.7.7.7.7.7.7.1"><times id="S4.E2.m1.7.7.7.7.7.7.1.1.cmml" xref="S4.E2.m1.7.7.7.7.7.7.1.1"></times><ci id="S4.E2.m1.7.7.7.7.7.7.1.2.cmml" xref="S4.E2.m1.7.7.7.7.7.7.1.2">𝑓</ci><ci id="S4.E2.m1.7.7.7.7.7.7.1.3.cmml" xref="S4.E2.m1.7.7.7.7.7.7.1.3">𝑥</ci></apply></apply><apply id="S4.E2.m1.19.19.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E2.m1.19.19.1.1.1.1.1.2.3.1.cmml" xref="S4.E2.m1.20.20.2">subscript</csymbol><ci id="S4.E2.m1.8.8.8.8.8.8.cmml" xref="S4.E2.m1.8.8.8.8.8.8">𝒙</ci><ci id="S4.E2.m1.9.9.9.9.9.9.1.cmml" xref="S4.E2.m1.9.9.9.9.9.9.1">𝑡</ci></apply></apply><apply id="S4.E2.m1.19.19.1.1.1.1.1.3.cmml" xref="S4.E2.m1.20.20.2"><times id="S4.E2.m1.19.19.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.20.20.2"></times><apply id="S4.E2.m1.19.19.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E2.m1.19.19.1.1.1.1.1.3.2.1.cmml" xref="S4.E2.m1.20.20.2">subscript</csymbol><ci id="S4.E2.m1.11.11.11.11.11.11.cmml" xref="S4.E2.m1.11.11.11.11.11.11">𝑾</ci><apply id="S4.E2.m1.12.12.12.12.12.12.1.cmml" xref="S4.E2.m1.12.12.12.12.12.12.1"><times id="S4.E2.m1.12.12.12.12.12.12.1.1.cmml" xref="S4.E2.m1.12.12.12.12.12.12.1.1"></times><ci id="S4.E2.m1.12.12.12.12.12.12.1.2.cmml" xref="S4.E2.m1.12.12.12.12.12.12.1.2">𝑓</ci><ci id="S4.E2.m1.12.12.12.12.12.12.1.3.cmml" xref="S4.E2.m1.12.12.12.12.12.12.1.3">ℎ</ci></apply></apply><apply id="S4.E2.m1.19.19.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E2.m1.19.19.1.1.1.1.1.3.3.1.cmml" xref="S4.E2.m1.20.20.2">subscript</csymbol><ci id="S4.E2.m1.13.13.13.13.13.13.cmml" xref="S4.E2.m1.13.13.13.13.13.13">𝒉</ci><apply id="S4.E2.m1.14.14.14.14.14.14.1.cmml" xref="S4.E2.m1.14.14.14.14.14.14.1"><minus id="S4.E2.m1.14.14.14.14.14.14.1.1.cmml" xref="S4.E2.m1.14.14.14.14.14.14.1.1"></minus><ci id="S4.E2.m1.14.14.14.14.14.14.1.2.cmml" xref="S4.E2.m1.14.14.14.14.14.14.1.2">𝑡</ci><cn type="integer" id="S4.E2.m1.14.14.14.14.14.14.1.3.cmml" xref="S4.E2.m1.14.14.14.14.14.14.1.3">1</cn></apply></apply></apply><apply id="S4.E2.m1.19.19.1.1.1.1.1.4.cmml" xref="S4.E2.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E2.m1.19.19.1.1.1.1.1.4.1.cmml" xref="S4.E2.m1.20.20.2">subscript</csymbol><ci id="S4.E2.m1.16.16.16.16.16.16.cmml" xref="S4.E2.m1.16.16.16.16.16.16">𝒃</ci><ci id="S4.E2.m1.17.17.17.17.17.17.1.cmml" xref="S4.E2.m1.17.17.17.17.17.17.1">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.20c">\displaystyle\begin{split}\bm{f}_{t}=\sigma(\bm{W}_{fx}\bm{x}_{t}+\bm{W}_{fh}\bm{h}_{t-1}+\bm{b}_{f})\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E3.m1.20" class="ltx_Math" alttext="\displaystyle\begin{split}\bm{i}_{t}=\sigma(\bm{W}_{ix}\bm{x}_{t}+\bm{W}_{ih}\bm{h}_{t-1}+\bm{b}_{i})\end{split}" display="inline"><semantics id="S4.E3.m1.20a"><mtable id="S4.E3.m1.20.20.2" xref="S4.E3.m1.19.19.1.cmml"><mtr id="S4.E3.m1.20.20.2a" xref="S4.E3.m1.19.19.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S4.E3.m1.20.20.2b" xref="S4.E3.m1.19.19.1.cmml"><mrow id="S4.E3.m1.20.20.2.19.19.19" xref="S4.E3.m1.19.19.1.cmml"><msub id="S4.E3.m1.20.20.2.19.19.19.20" xref="S4.E3.m1.19.19.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml">𝒊</mi><mi id="S4.E3.m1.2.2.2.2.2.2.1" xref="S4.E3.m1.2.2.2.2.2.2.1.cmml">t</mi></msub><mo id="S4.E3.m1.3.3.3.3.3.3" xref="S4.E3.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E3.m1.20.20.2.19.19.19.19" xref="S4.E3.m1.19.19.1.cmml"><mi id="S4.E3.m1.4.4.4.4.4.4" xref="S4.E3.m1.4.4.4.4.4.4.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.20.20.2.19.19.19.19.2" xref="S4.E3.m1.19.19.1.cmml">​</mo><mrow id="S4.E3.m1.20.20.2.19.19.19.19.1.1" xref="S4.E3.m1.19.19.1.cmml"><mo stretchy="false" id="S4.E3.m1.5.5.5.5.5.5" xref="S4.E3.m1.19.19.1.cmml">(</mo><mrow id="S4.E3.m1.20.20.2.19.19.19.19.1.1.1" xref="S4.E3.m1.19.19.1.cmml"><mrow id="S4.E3.m1.20.20.2.19.19.19.19.1.1.1.1" xref="S4.E3.m1.19.19.1.cmml"><msub id="S4.E3.m1.20.20.2.19.19.19.19.1.1.1.1.2" xref="S4.E3.m1.19.19.1.cmml"><mi id="S4.E3.m1.6.6.6.6.6.6" xref="S4.E3.m1.6.6.6.6.6.6.cmml">𝑾</mi><mrow id="S4.E3.m1.7.7.7.7.7.7.1" xref="S4.E3.m1.7.7.7.7.7.7.1.cmml"><mi id="S4.E3.m1.7.7.7.7.7.7.1.2" xref="S4.E3.m1.7.7.7.7.7.7.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.7.7.7.7.7.7.1.1" xref="S4.E3.m1.7.7.7.7.7.7.1.1.cmml">​</mo><mi id="S4.E3.m1.7.7.7.7.7.7.1.3" xref="S4.E3.m1.7.7.7.7.7.7.1.3.cmml">x</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.20.20.2.19.19.19.19.1.1.1.1.1" xref="S4.E3.m1.19.19.1.cmml">​</mo><msub id="S4.E3.m1.20.20.2.19.19.19.19.1.1.1.1.3" xref="S4.E3.m1.19.19.1.cmml"><mi id="S4.E3.m1.8.8.8.8.8.8" xref="S4.E3.m1.8.8.8.8.8.8.cmml">𝒙</mi><mi id="S4.E3.m1.9.9.9.9.9.9.1" xref="S4.E3.m1.9.9.9.9.9.9.1.cmml">t</mi></msub></mrow><mo id="S4.E3.m1.10.10.10.10.10.10" xref="S4.E3.m1.10.10.10.10.10.10.cmml">+</mo><mrow id="S4.E3.m1.20.20.2.19.19.19.19.1.1.1.2" xref="S4.E3.m1.19.19.1.cmml"><msub id="S4.E3.m1.20.20.2.19.19.19.19.1.1.1.2.2" xref="S4.E3.m1.19.19.1.cmml"><mi id="S4.E3.m1.11.11.11.11.11.11" xref="S4.E3.m1.11.11.11.11.11.11.cmml">𝑾</mi><mrow id="S4.E3.m1.12.12.12.12.12.12.1" xref="S4.E3.m1.12.12.12.12.12.12.1.cmml"><mi id="S4.E3.m1.12.12.12.12.12.12.1.2" xref="S4.E3.m1.12.12.12.12.12.12.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.12.12.12.12.12.12.1.1" xref="S4.E3.m1.12.12.12.12.12.12.1.1.cmml">​</mo><mi id="S4.E3.m1.12.12.12.12.12.12.1.3" xref="S4.E3.m1.12.12.12.12.12.12.1.3.cmml">h</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.20.20.2.19.19.19.19.1.1.1.2.1" xref="S4.E3.m1.19.19.1.cmml">​</mo><msub id="S4.E3.m1.20.20.2.19.19.19.19.1.1.1.2.3" xref="S4.E3.m1.19.19.1.cmml"><mi id="S4.E3.m1.13.13.13.13.13.13" xref="S4.E3.m1.13.13.13.13.13.13.cmml">𝒉</mi><mrow id="S4.E3.m1.14.14.14.14.14.14.1" xref="S4.E3.m1.14.14.14.14.14.14.1.cmml"><mi id="S4.E3.m1.14.14.14.14.14.14.1.2" xref="S4.E3.m1.14.14.14.14.14.14.1.2.cmml">t</mi><mo id="S4.E3.m1.14.14.14.14.14.14.1.1" xref="S4.E3.m1.14.14.14.14.14.14.1.1.cmml">−</mo><mn id="S4.E3.m1.14.14.14.14.14.14.1.3" xref="S4.E3.m1.14.14.14.14.14.14.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S4.E3.m1.10.10.10.10.10.10a" xref="S4.E3.m1.10.10.10.10.10.10.cmml">+</mo><msub id="S4.E3.m1.20.20.2.19.19.19.19.1.1.1.3" xref="S4.E3.m1.19.19.1.cmml"><mi id="S4.E3.m1.16.16.16.16.16.16" xref="S4.E3.m1.16.16.16.16.16.16.cmml">𝒃</mi><mi id="S4.E3.m1.17.17.17.17.17.17.1" xref="S4.E3.m1.17.17.17.17.17.17.1.cmml">i</mi></msub></mrow><mo stretchy="false" id="S4.E3.m1.18.18.18.18.18.18" xref="S4.E3.m1.19.19.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E3.m1.20b"><apply id="S4.E3.m1.19.19.1.cmml" xref="S4.E3.m1.20.20.2"><eq id="S4.E3.m1.3.3.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3.3.3"></eq><apply id="S4.E3.m1.19.19.1.3.cmml" xref="S4.E3.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E3.m1.19.19.1.3.1.cmml" xref="S4.E3.m1.20.20.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1">𝒊</ci><ci id="S4.E3.m1.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.1">𝑡</ci></apply><apply id="S4.E3.m1.19.19.1.1.cmml" xref="S4.E3.m1.20.20.2"><times id="S4.E3.m1.19.19.1.1.2.cmml" xref="S4.E3.m1.20.20.2"></times><ci id="S4.E3.m1.4.4.4.4.4.4.cmml" xref="S4.E3.m1.4.4.4.4.4.4">𝜎</ci><apply id="S4.E3.m1.19.19.1.1.1.1.1.cmml" xref="S4.E3.m1.20.20.2"><plus id="S4.E3.m1.10.10.10.10.10.10.cmml" xref="S4.E3.m1.10.10.10.10.10.10"></plus><apply id="S4.E3.m1.19.19.1.1.1.1.1.2.cmml" xref="S4.E3.m1.20.20.2"><times id="S4.E3.m1.19.19.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.20.20.2"></times><apply id="S4.E3.m1.19.19.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E3.m1.19.19.1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.20.20.2">subscript</csymbol><ci id="S4.E3.m1.6.6.6.6.6.6.cmml" xref="S4.E3.m1.6.6.6.6.6.6">𝑾</ci><apply id="S4.E3.m1.7.7.7.7.7.7.1.cmml" xref="S4.E3.m1.7.7.7.7.7.7.1"><times id="S4.E3.m1.7.7.7.7.7.7.1.1.cmml" xref="S4.E3.m1.7.7.7.7.7.7.1.1"></times><ci id="S4.E3.m1.7.7.7.7.7.7.1.2.cmml" xref="S4.E3.m1.7.7.7.7.7.7.1.2">𝑖</ci><ci id="S4.E3.m1.7.7.7.7.7.7.1.3.cmml" xref="S4.E3.m1.7.7.7.7.7.7.1.3">𝑥</ci></apply></apply><apply id="S4.E3.m1.19.19.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E3.m1.19.19.1.1.1.1.1.2.3.1.cmml" xref="S4.E3.m1.20.20.2">subscript</csymbol><ci id="S4.E3.m1.8.8.8.8.8.8.cmml" xref="S4.E3.m1.8.8.8.8.8.8">𝒙</ci><ci id="S4.E3.m1.9.9.9.9.9.9.1.cmml" xref="S4.E3.m1.9.9.9.9.9.9.1">𝑡</ci></apply></apply><apply id="S4.E3.m1.19.19.1.1.1.1.1.3.cmml" xref="S4.E3.m1.20.20.2"><times id="S4.E3.m1.19.19.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.20.20.2"></times><apply id="S4.E3.m1.19.19.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E3.m1.19.19.1.1.1.1.1.3.2.1.cmml" xref="S4.E3.m1.20.20.2">subscript</csymbol><ci id="S4.E3.m1.11.11.11.11.11.11.cmml" xref="S4.E3.m1.11.11.11.11.11.11">𝑾</ci><apply id="S4.E3.m1.12.12.12.12.12.12.1.cmml" xref="S4.E3.m1.12.12.12.12.12.12.1"><times id="S4.E3.m1.12.12.12.12.12.12.1.1.cmml" xref="S4.E3.m1.12.12.12.12.12.12.1.1"></times><ci id="S4.E3.m1.12.12.12.12.12.12.1.2.cmml" xref="S4.E3.m1.12.12.12.12.12.12.1.2">𝑖</ci><ci id="S4.E3.m1.12.12.12.12.12.12.1.3.cmml" xref="S4.E3.m1.12.12.12.12.12.12.1.3">ℎ</ci></apply></apply><apply id="S4.E3.m1.19.19.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E3.m1.19.19.1.1.1.1.1.3.3.1.cmml" xref="S4.E3.m1.20.20.2">subscript</csymbol><ci id="S4.E3.m1.13.13.13.13.13.13.cmml" xref="S4.E3.m1.13.13.13.13.13.13">𝒉</ci><apply id="S4.E3.m1.14.14.14.14.14.14.1.cmml" xref="S4.E3.m1.14.14.14.14.14.14.1"><minus id="S4.E3.m1.14.14.14.14.14.14.1.1.cmml" xref="S4.E3.m1.14.14.14.14.14.14.1.1"></minus><ci id="S4.E3.m1.14.14.14.14.14.14.1.2.cmml" xref="S4.E3.m1.14.14.14.14.14.14.1.2">𝑡</ci><cn type="integer" id="S4.E3.m1.14.14.14.14.14.14.1.3.cmml" xref="S4.E3.m1.14.14.14.14.14.14.1.3">1</cn></apply></apply></apply><apply id="S4.E3.m1.19.19.1.1.1.1.1.4.cmml" xref="S4.E3.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E3.m1.19.19.1.1.1.1.1.4.1.cmml" xref="S4.E3.m1.20.20.2">subscript</csymbol><ci id="S4.E3.m1.16.16.16.16.16.16.cmml" xref="S4.E3.m1.16.16.16.16.16.16">𝒃</ci><ci id="S4.E3.m1.17.17.17.17.17.17.1.cmml" xref="S4.E3.m1.17.17.17.17.17.17.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.20c">\displaystyle\begin{split}\bm{i}_{t}=\sigma(\bm{W}_{ix}\bm{x}_{t}+\bm{W}_{ih}\bm{h}_{t-1}+\bm{b}_{i})\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E4.m1.20" class="ltx_Math" alttext="\displaystyle\begin{split}\bm{o}_{t}=\sigma(\bm{W}_{ox}\bm{x}_{t}+\bm{W}_{oh}\bm{h}_{t-1}+\bm{b}_{o})\end{split}" display="inline"><semantics id="S4.E4.m1.20a"><mtable id="S4.E4.m1.20.20.2" xref="S4.E4.m1.19.19.1.cmml"><mtr id="S4.E4.m1.20.20.2a" xref="S4.E4.m1.19.19.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S4.E4.m1.20.20.2b" xref="S4.E4.m1.19.19.1.cmml"><mrow id="S4.E4.m1.20.20.2.19.19.19" xref="S4.E4.m1.19.19.1.cmml"><msub id="S4.E4.m1.20.20.2.19.19.19.20" xref="S4.E4.m1.19.19.1.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml">𝒐</mi><mi id="S4.E4.m1.2.2.2.2.2.2.1" xref="S4.E4.m1.2.2.2.2.2.2.1.cmml">t</mi></msub><mo id="S4.E4.m1.3.3.3.3.3.3" xref="S4.E4.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E4.m1.20.20.2.19.19.19.19" xref="S4.E4.m1.19.19.1.cmml"><mi id="S4.E4.m1.4.4.4.4.4.4" xref="S4.E4.m1.4.4.4.4.4.4.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.20.20.2.19.19.19.19.2" xref="S4.E4.m1.19.19.1.cmml">​</mo><mrow id="S4.E4.m1.20.20.2.19.19.19.19.1.1" xref="S4.E4.m1.19.19.1.cmml"><mo stretchy="false" id="S4.E4.m1.5.5.5.5.5.5" xref="S4.E4.m1.19.19.1.cmml">(</mo><mrow id="S4.E4.m1.20.20.2.19.19.19.19.1.1.1" xref="S4.E4.m1.19.19.1.cmml"><mrow id="S4.E4.m1.20.20.2.19.19.19.19.1.1.1.1" xref="S4.E4.m1.19.19.1.cmml"><msub id="S4.E4.m1.20.20.2.19.19.19.19.1.1.1.1.2" xref="S4.E4.m1.19.19.1.cmml"><mi id="S4.E4.m1.6.6.6.6.6.6" xref="S4.E4.m1.6.6.6.6.6.6.cmml">𝑾</mi><mrow id="S4.E4.m1.7.7.7.7.7.7.1" xref="S4.E4.m1.7.7.7.7.7.7.1.cmml"><mi id="S4.E4.m1.7.7.7.7.7.7.1.2" xref="S4.E4.m1.7.7.7.7.7.7.1.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.7.7.7.7.7.7.1.1" xref="S4.E4.m1.7.7.7.7.7.7.1.1.cmml">​</mo><mi id="S4.E4.m1.7.7.7.7.7.7.1.3" xref="S4.E4.m1.7.7.7.7.7.7.1.3.cmml">x</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.20.20.2.19.19.19.19.1.1.1.1.1" xref="S4.E4.m1.19.19.1.cmml">​</mo><msub id="S4.E4.m1.20.20.2.19.19.19.19.1.1.1.1.3" xref="S4.E4.m1.19.19.1.cmml"><mi id="S4.E4.m1.8.8.8.8.8.8" xref="S4.E4.m1.8.8.8.8.8.8.cmml">𝒙</mi><mi id="S4.E4.m1.9.9.9.9.9.9.1" xref="S4.E4.m1.9.9.9.9.9.9.1.cmml">t</mi></msub></mrow><mo id="S4.E4.m1.10.10.10.10.10.10" xref="S4.E4.m1.10.10.10.10.10.10.cmml">+</mo><mrow id="S4.E4.m1.20.20.2.19.19.19.19.1.1.1.2" xref="S4.E4.m1.19.19.1.cmml"><msub id="S4.E4.m1.20.20.2.19.19.19.19.1.1.1.2.2" xref="S4.E4.m1.19.19.1.cmml"><mi id="S4.E4.m1.11.11.11.11.11.11" xref="S4.E4.m1.11.11.11.11.11.11.cmml">𝑾</mi><mrow id="S4.E4.m1.12.12.12.12.12.12.1" xref="S4.E4.m1.12.12.12.12.12.12.1.cmml"><mi id="S4.E4.m1.12.12.12.12.12.12.1.2" xref="S4.E4.m1.12.12.12.12.12.12.1.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.12.12.12.12.12.12.1.1" xref="S4.E4.m1.12.12.12.12.12.12.1.1.cmml">​</mo><mi id="S4.E4.m1.12.12.12.12.12.12.1.3" xref="S4.E4.m1.12.12.12.12.12.12.1.3.cmml">h</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.20.20.2.19.19.19.19.1.1.1.2.1" xref="S4.E4.m1.19.19.1.cmml">​</mo><msub id="S4.E4.m1.20.20.2.19.19.19.19.1.1.1.2.3" xref="S4.E4.m1.19.19.1.cmml"><mi id="S4.E4.m1.13.13.13.13.13.13" xref="S4.E4.m1.13.13.13.13.13.13.cmml">𝒉</mi><mrow id="S4.E4.m1.14.14.14.14.14.14.1" xref="S4.E4.m1.14.14.14.14.14.14.1.cmml"><mi id="S4.E4.m1.14.14.14.14.14.14.1.2" xref="S4.E4.m1.14.14.14.14.14.14.1.2.cmml">t</mi><mo id="S4.E4.m1.14.14.14.14.14.14.1.1" xref="S4.E4.m1.14.14.14.14.14.14.1.1.cmml">−</mo><mn id="S4.E4.m1.14.14.14.14.14.14.1.3" xref="S4.E4.m1.14.14.14.14.14.14.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S4.E4.m1.10.10.10.10.10.10a" xref="S4.E4.m1.10.10.10.10.10.10.cmml">+</mo><msub id="S4.E4.m1.20.20.2.19.19.19.19.1.1.1.3" xref="S4.E4.m1.19.19.1.cmml"><mi id="S4.E4.m1.16.16.16.16.16.16" xref="S4.E4.m1.16.16.16.16.16.16.cmml">𝒃</mi><mi id="S4.E4.m1.17.17.17.17.17.17.1" xref="S4.E4.m1.17.17.17.17.17.17.1.cmml">o</mi></msub></mrow><mo stretchy="false" id="S4.E4.m1.18.18.18.18.18.18" xref="S4.E4.m1.19.19.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E4.m1.20b"><apply id="S4.E4.m1.19.19.1.cmml" xref="S4.E4.m1.20.20.2"><eq id="S4.E4.m1.3.3.3.3.3.3.cmml" xref="S4.E4.m1.3.3.3.3.3.3"></eq><apply id="S4.E4.m1.19.19.1.3.cmml" xref="S4.E4.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E4.m1.19.19.1.3.1.cmml" xref="S4.E4.m1.20.20.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1">𝒐</ci><ci id="S4.E4.m1.2.2.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1">𝑡</ci></apply><apply id="S4.E4.m1.19.19.1.1.cmml" xref="S4.E4.m1.20.20.2"><times id="S4.E4.m1.19.19.1.1.2.cmml" xref="S4.E4.m1.20.20.2"></times><ci id="S4.E4.m1.4.4.4.4.4.4.cmml" xref="S4.E4.m1.4.4.4.4.4.4">𝜎</ci><apply id="S4.E4.m1.19.19.1.1.1.1.1.cmml" xref="S4.E4.m1.20.20.2"><plus id="S4.E4.m1.10.10.10.10.10.10.cmml" xref="S4.E4.m1.10.10.10.10.10.10"></plus><apply id="S4.E4.m1.19.19.1.1.1.1.1.2.cmml" xref="S4.E4.m1.20.20.2"><times id="S4.E4.m1.19.19.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.20.20.2"></times><apply id="S4.E4.m1.19.19.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E4.m1.19.19.1.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.20.20.2">subscript</csymbol><ci id="S4.E4.m1.6.6.6.6.6.6.cmml" xref="S4.E4.m1.6.6.6.6.6.6">𝑾</ci><apply id="S4.E4.m1.7.7.7.7.7.7.1.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1"><times id="S4.E4.m1.7.7.7.7.7.7.1.1.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.1"></times><ci id="S4.E4.m1.7.7.7.7.7.7.1.2.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.2">𝑜</ci><ci id="S4.E4.m1.7.7.7.7.7.7.1.3.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.3">𝑥</ci></apply></apply><apply id="S4.E4.m1.19.19.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E4.m1.19.19.1.1.1.1.1.2.3.1.cmml" xref="S4.E4.m1.20.20.2">subscript</csymbol><ci id="S4.E4.m1.8.8.8.8.8.8.cmml" xref="S4.E4.m1.8.8.8.8.8.8">𝒙</ci><ci id="S4.E4.m1.9.9.9.9.9.9.1.cmml" xref="S4.E4.m1.9.9.9.9.9.9.1">𝑡</ci></apply></apply><apply id="S4.E4.m1.19.19.1.1.1.1.1.3.cmml" xref="S4.E4.m1.20.20.2"><times id="S4.E4.m1.19.19.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.20.20.2"></times><apply id="S4.E4.m1.19.19.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E4.m1.19.19.1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.20.20.2">subscript</csymbol><ci id="S4.E4.m1.11.11.11.11.11.11.cmml" xref="S4.E4.m1.11.11.11.11.11.11">𝑾</ci><apply id="S4.E4.m1.12.12.12.12.12.12.1.cmml" xref="S4.E4.m1.12.12.12.12.12.12.1"><times id="S4.E4.m1.12.12.12.12.12.12.1.1.cmml" xref="S4.E4.m1.12.12.12.12.12.12.1.1"></times><ci id="S4.E4.m1.12.12.12.12.12.12.1.2.cmml" xref="S4.E4.m1.12.12.12.12.12.12.1.2">𝑜</ci><ci id="S4.E4.m1.12.12.12.12.12.12.1.3.cmml" xref="S4.E4.m1.12.12.12.12.12.12.1.3">ℎ</ci></apply></apply><apply id="S4.E4.m1.19.19.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E4.m1.19.19.1.1.1.1.1.3.3.1.cmml" xref="S4.E4.m1.20.20.2">subscript</csymbol><ci id="S4.E4.m1.13.13.13.13.13.13.cmml" xref="S4.E4.m1.13.13.13.13.13.13">𝒉</ci><apply id="S4.E4.m1.14.14.14.14.14.14.1.cmml" xref="S4.E4.m1.14.14.14.14.14.14.1"><minus id="S4.E4.m1.14.14.14.14.14.14.1.1.cmml" xref="S4.E4.m1.14.14.14.14.14.14.1.1"></minus><ci id="S4.E4.m1.14.14.14.14.14.14.1.2.cmml" xref="S4.E4.m1.14.14.14.14.14.14.1.2">𝑡</ci><cn type="integer" id="S4.E4.m1.14.14.14.14.14.14.1.3.cmml" xref="S4.E4.m1.14.14.14.14.14.14.1.3">1</cn></apply></apply></apply><apply id="S4.E4.m1.19.19.1.1.1.1.1.4.cmml" xref="S4.E4.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E4.m1.19.19.1.1.1.1.1.4.1.cmml" xref="S4.E4.m1.20.20.2">subscript</csymbol><ci id="S4.E4.m1.16.16.16.16.16.16.cmml" xref="S4.E4.m1.16.16.16.16.16.16">𝒃</ci><ci id="S4.E4.m1.17.17.17.17.17.17.1.cmml" xref="S4.E4.m1.17.17.17.17.17.17.1">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.20c">\displaystyle\begin{split}\bm{o}_{t}=\sigma(\bm{W}_{ox}\bm{x}_{t}+\bm{W}_{oh}\bm{h}_{t-1}+\bm{b}_{o})\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E5.m1.20" class="ltx_Math" alttext="\displaystyle\begin{split}\bm{g}_{t}=\text{tanh}(\bm{W}_{gx}\bm{x}_{t}+\bm{W}_{gh}\bm{h}_{t-1}+\bm{b}_{g})\end{split}" display="inline"><semantics id="S4.E5.m1.20a"><mtable id="S4.E5.m1.20.20.2" xref="S4.E5.m1.19.19.1.cmml"><mtr id="S4.E5.m1.20.20.2a" xref="S4.E5.m1.19.19.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S4.E5.m1.20.20.2b" xref="S4.E5.m1.19.19.1.cmml"><mrow id="S4.E5.m1.20.20.2.19.19.19" xref="S4.E5.m1.19.19.1.cmml"><msub id="S4.E5.m1.20.20.2.19.19.19.20" xref="S4.E5.m1.19.19.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml">𝒈</mi><mi id="S4.E5.m1.2.2.2.2.2.2.1" xref="S4.E5.m1.2.2.2.2.2.2.1.cmml">t</mi></msub><mo id="S4.E5.m1.3.3.3.3.3.3" xref="S4.E5.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E5.m1.20.20.2.19.19.19.19" xref="S4.E5.m1.19.19.1.cmml"><mtext id="S4.E5.m1.4.4.4.4.4.4" xref="S4.E5.m1.4.4.4.4.4.4a.cmml">tanh</mtext><mo lspace="0em" rspace="0em" id="S4.E5.m1.20.20.2.19.19.19.19.2" xref="S4.E5.m1.19.19.1.cmml">​</mo><mrow id="S4.E5.m1.20.20.2.19.19.19.19.1.1" xref="S4.E5.m1.19.19.1.cmml"><mo stretchy="false" id="S4.E5.m1.5.5.5.5.5.5" xref="S4.E5.m1.19.19.1.cmml">(</mo><mrow id="S4.E5.m1.20.20.2.19.19.19.19.1.1.1" xref="S4.E5.m1.19.19.1.cmml"><mrow id="S4.E5.m1.20.20.2.19.19.19.19.1.1.1.1" xref="S4.E5.m1.19.19.1.cmml"><msub id="S4.E5.m1.20.20.2.19.19.19.19.1.1.1.1.2" xref="S4.E5.m1.19.19.1.cmml"><mi id="S4.E5.m1.6.6.6.6.6.6" xref="S4.E5.m1.6.6.6.6.6.6.cmml">𝑾</mi><mrow id="S4.E5.m1.7.7.7.7.7.7.1" xref="S4.E5.m1.7.7.7.7.7.7.1.cmml"><mi id="S4.E5.m1.7.7.7.7.7.7.1.2" xref="S4.E5.m1.7.7.7.7.7.7.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.7.7.7.7.7.7.1.1" xref="S4.E5.m1.7.7.7.7.7.7.1.1.cmml">​</mo><mi id="S4.E5.m1.7.7.7.7.7.7.1.3" xref="S4.E5.m1.7.7.7.7.7.7.1.3.cmml">x</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.20.20.2.19.19.19.19.1.1.1.1.1" xref="S4.E5.m1.19.19.1.cmml">​</mo><msub id="S4.E5.m1.20.20.2.19.19.19.19.1.1.1.1.3" xref="S4.E5.m1.19.19.1.cmml"><mi id="S4.E5.m1.8.8.8.8.8.8" xref="S4.E5.m1.8.8.8.8.8.8.cmml">𝒙</mi><mi id="S4.E5.m1.9.9.9.9.9.9.1" xref="S4.E5.m1.9.9.9.9.9.9.1.cmml">t</mi></msub></mrow><mo id="S4.E5.m1.10.10.10.10.10.10" xref="S4.E5.m1.10.10.10.10.10.10.cmml">+</mo><mrow id="S4.E5.m1.20.20.2.19.19.19.19.1.1.1.2" xref="S4.E5.m1.19.19.1.cmml"><msub id="S4.E5.m1.20.20.2.19.19.19.19.1.1.1.2.2" xref="S4.E5.m1.19.19.1.cmml"><mi id="S4.E5.m1.11.11.11.11.11.11" xref="S4.E5.m1.11.11.11.11.11.11.cmml">𝑾</mi><mrow id="S4.E5.m1.12.12.12.12.12.12.1" xref="S4.E5.m1.12.12.12.12.12.12.1.cmml"><mi id="S4.E5.m1.12.12.12.12.12.12.1.2" xref="S4.E5.m1.12.12.12.12.12.12.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.12.12.12.12.12.12.1.1" xref="S4.E5.m1.12.12.12.12.12.12.1.1.cmml">​</mo><mi id="S4.E5.m1.12.12.12.12.12.12.1.3" xref="S4.E5.m1.12.12.12.12.12.12.1.3.cmml">h</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.20.20.2.19.19.19.19.1.1.1.2.1" xref="S4.E5.m1.19.19.1.cmml">​</mo><msub id="S4.E5.m1.20.20.2.19.19.19.19.1.1.1.2.3" xref="S4.E5.m1.19.19.1.cmml"><mi id="S4.E5.m1.13.13.13.13.13.13" xref="S4.E5.m1.13.13.13.13.13.13.cmml">𝒉</mi><mrow id="S4.E5.m1.14.14.14.14.14.14.1" xref="S4.E5.m1.14.14.14.14.14.14.1.cmml"><mi id="S4.E5.m1.14.14.14.14.14.14.1.2" xref="S4.E5.m1.14.14.14.14.14.14.1.2.cmml">t</mi><mo id="S4.E5.m1.14.14.14.14.14.14.1.1" xref="S4.E5.m1.14.14.14.14.14.14.1.1.cmml">−</mo><mn id="S4.E5.m1.14.14.14.14.14.14.1.3" xref="S4.E5.m1.14.14.14.14.14.14.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S4.E5.m1.10.10.10.10.10.10a" xref="S4.E5.m1.10.10.10.10.10.10.cmml">+</mo><msub id="S4.E5.m1.20.20.2.19.19.19.19.1.1.1.3" xref="S4.E5.m1.19.19.1.cmml"><mi id="S4.E5.m1.16.16.16.16.16.16" xref="S4.E5.m1.16.16.16.16.16.16.cmml">𝒃</mi><mi id="S4.E5.m1.17.17.17.17.17.17.1" xref="S4.E5.m1.17.17.17.17.17.17.1.cmml">g</mi></msub></mrow><mo stretchy="false" id="S4.E5.m1.18.18.18.18.18.18" xref="S4.E5.m1.19.19.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E5.m1.20b"><apply id="S4.E5.m1.19.19.1.cmml" xref="S4.E5.m1.20.20.2"><eq id="S4.E5.m1.3.3.3.3.3.3.cmml" xref="S4.E5.m1.3.3.3.3.3.3"></eq><apply id="S4.E5.m1.19.19.1.3.cmml" xref="S4.E5.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E5.m1.19.19.1.3.1.cmml" xref="S4.E5.m1.20.20.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1">𝒈</ci><ci id="S4.E5.m1.2.2.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.2.2.2.1">𝑡</ci></apply><apply id="S4.E5.m1.19.19.1.1.cmml" xref="S4.E5.m1.20.20.2"><times id="S4.E5.m1.19.19.1.1.2.cmml" xref="S4.E5.m1.20.20.2"></times><ci id="S4.E5.m1.4.4.4.4.4.4a.cmml" xref="S4.E5.m1.4.4.4.4.4.4"><mtext id="S4.E5.m1.4.4.4.4.4.4.cmml" xref="S4.E5.m1.4.4.4.4.4.4">tanh</mtext></ci><apply id="S4.E5.m1.19.19.1.1.1.1.1.cmml" xref="S4.E5.m1.20.20.2"><plus id="S4.E5.m1.10.10.10.10.10.10.cmml" xref="S4.E5.m1.10.10.10.10.10.10"></plus><apply id="S4.E5.m1.19.19.1.1.1.1.1.2.cmml" xref="S4.E5.m1.20.20.2"><times id="S4.E5.m1.19.19.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.20.20.2"></times><apply id="S4.E5.m1.19.19.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E5.m1.19.19.1.1.1.1.1.2.2.1.cmml" xref="S4.E5.m1.20.20.2">subscript</csymbol><ci id="S4.E5.m1.6.6.6.6.6.6.cmml" xref="S4.E5.m1.6.6.6.6.6.6">𝑾</ci><apply id="S4.E5.m1.7.7.7.7.7.7.1.cmml" xref="S4.E5.m1.7.7.7.7.7.7.1"><times id="S4.E5.m1.7.7.7.7.7.7.1.1.cmml" xref="S4.E5.m1.7.7.7.7.7.7.1.1"></times><ci id="S4.E5.m1.7.7.7.7.7.7.1.2.cmml" xref="S4.E5.m1.7.7.7.7.7.7.1.2">𝑔</ci><ci id="S4.E5.m1.7.7.7.7.7.7.1.3.cmml" xref="S4.E5.m1.7.7.7.7.7.7.1.3">𝑥</ci></apply></apply><apply id="S4.E5.m1.19.19.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E5.m1.19.19.1.1.1.1.1.2.3.1.cmml" xref="S4.E5.m1.20.20.2">subscript</csymbol><ci id="S4.E5.m1.8.8.8.8.8.8.cmml" xref="S4.E5.m1.8.8.8.8.8.8">𝒙</ci><ci id="S4.E5.m1.9.9.9.9.9.9.1.cmml" xref="S4.E5.m1.9.9.9.9.9.9.1">𝑡</ci></apply></apply><apply id="S4.E5.m1.19.19.1.1.1.1.1.3.cmml" xref="S4.E5.m1.20.20.2"><times id="S4.E5.m1.19.19.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.20.20.2"></times><apply id="S4.E5.m1.19.19.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E5.m1.19.19.1.1.1.1.1.3.2.1.cmml" xref="S4.E5.m1.20.20.2">subscript</csymbol><ci id="S4.E5.m1.11.11.11.11.11.11.cmml" xref="S4.E5.m1.11.11.11.11.11.11">𝑾</ci><apply id="S4.E5.m1.12.12.12.12.12.12.1.cmml" xref="S4.E5.m1.12.12.12.12.12.12.1"><times id="S4.E5.m1.12.12.12.12.12.12.1.1.cmml" xref="S4.E5.m1.12.12.12.12.12.12.1.1"></times><ci id="S4.E5.m1.12.12.12.12.12.12.1.2.cmml" xref="S4.E5.m1.12.12.12.12.12.12.1.2">𝑔</ci><ci id="S4.E5.m1.12.12.12.12.12.12.1.3.cmml" xref="S4.E5.m1.12.12.12.12.12.12.1.3">ℎ</ci></apply></apply><apply id="S4.E5.m1.19.19.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E5.m1.19.19.1.1.1.1.1.3.3.1.cmml" xref="S4.E5.m1.20.20.2">subscript</csymbol><ci id="S4.E5.m1.13.13.13.13.13.13.cmml" xref="S4.E5.m1.13.13.13.13.13.13">𝒉</ci><apply id="S4.E5.m1.14.14.14.14.14.14.1.cmml" xref="S4.E5.m1.14.14.14.14.14.14.1"><minus id="S4.E5.m1.14.14.14.14.14.14.1.1.cmml" xref="S4.E5.m1.14.14.14.14.14.14.1.1"></minus><ci id="S4.E5.m1.14.14.14.14.14.14.1.2.cmml" xref="S4.E5.m1.14.14.14.14.14.14.1.2">𝑡</ci><cn type="integer" id="S4.E5.m1.14.14.14.14.14.14.1.3.cmml" xref="S4.E5.m1.14.14.14.14.14.14.1.3">1</cn></apply></apply></apply><apply id="S4.E5.m1.19.19.1.1.1.1.1.4.cmml" xref="S4.E5.m1.20.20.2"><csymbol cd="ambiguous" id="S4.E5.m1.19.19.1.1.1.1.1.4.1.cmml" xref="S4.E5.m1.20.20.2">subscript</csymbol><ci id="S4.E5.m1.16.16.16.16.16.16.cmml" xref="S4.E5.m1.16.16.16.16.16.16">𝒃</ci><ci id="S4.E5.m1.17.17.17.17.17.17.1.cmml" xref="S4.E5.m1.17.17.17.17.17.17.1">𝑔</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.20c">\displaystyle\begin{split}\bm{g}_{t}=\text{tanh}(\bm{W}_{gx}\bm{x}_{t}+\bm{W}_{gh}\bm{h}_{t-1}+\bm{b}_{g})\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E6.m1.14" class="ltx_Math" alttext="\displaystyle\begin{split}\bm{c}_{t}=\bm{c}_{t-1}\odot\bm{f}_{t}+\bm{i}_{t}\odot\bm{g}_{t}\end{split}" display="inline"><semantics id="S4.E6.m1.14a"><mtable id="S4.E6.m1.14.14a" xref="S4.E6.m1.14.15.1.cmml"><mtr id="S4.E6.m1.14.14aa" xref="S4.E6.m1.14.15.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S4.E6.m1.14.14ab" xref="S4.E6.m1.14.15.1.cmml"><mrow id="S4.E6.m1.14.14.14.14.14a" xref="S4.E6.m1.14.15.1.cmml"><msub id="S4.E6.m1.14.14.14.14.14a.15" xref="S4.E6.m1.14.15.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml">𝒄</mi><mi id="S4.E6.m1.2.2.2.2.2.2.1" xref="S4.E6.m1.2.2.2.2.2.2.1.cmml">t</mi></msub><mo id="S4.E6.m1.3.3.3.3.3.3" xref="S4.E6.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E6.m1.14.14.14.14.14a.16" xref="S4.E6.m1.14.15.1.cmml"><mrow id="S4.E6.m1.14.14.14.14.14a.16.1" xref="S4.E6.m1.14.15.1.cmml"><msub id="S4.E6.m1.14.14.14.14.14a.16.1.1" xref="S4.E6.m1.14.15.1.cmml"><mi id="S4.E6.m1.4.4.4.4.4.4" xref="S4.E6.m1.4.4.4.4.4.4.cmml">𝒄</mi><mrow id="S4.E6.m1.5.5.5.5.5.5.1" xref="S4.E6.m1.5.5.5.5.5.5.1.cmml"><mi id="S4.E6.m1.5.5.5.5.5.5.1.2" xref="S4.E6.m1.5.5.5.5.5.5.1.2.cmml">t</mi><mo id="S4.E6.m1.5.5.5.5.5.5.1.1" xref="S4.E6.m1.5.5.5.5.5.5.1.1.cmml">−</mo><mn id="S4.E6.m1.5.5.5.5.5.5.1.3" xref="S4.E6.m1.5.5.5.5.5.5.1.3.cmml">1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m1.6.6.6.6.6.6" xref="S4.E6.m1.6.6.6.6.6.6.cmml">⊙</mo><msub id="S4.E6.m1.14.14.14.14.14a.16.1.2" xref="S4.E6.m1.14.15.1.cmml"><mi id="S4.E6.m1.7.7.7.7.7.7" xref="S4.E6.m1.7.7.7.7.7.7.cmml">𝒇</mi><mi id="S4.E6.m1.8.8.8.8.8.8.1" xref="S4.E6.m1.8.8.8.8.8.8.1.cmml">t</mi></msub></mrow><mo id="S4.E6.m1.9.9.9.9.9.9" xref="S4.E6.m1.9.9.9.9.9.9.cmml">+</mo><mrow id="S4.E6.m1.14.14.14.14.14a.16.2" xref="S4.E6.m1.14.15.1.cmml"><msub id="S4.E6.m1.14.14.14.14.14a.16.2.1" xref="S4.E6.m1.14.15.1.cmml"><mi id="S4.E6.m1.10.10.10.10.10.10" xref="S4.E6.m1.10.10.10.10.10.10.cmml">𝒊</mi><mi id="S4.E6.m1.11.11.11.11.11.11.1" xref="S4.E6.m1.11.11.11.11.11.11.1.cmml">t</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m1.12.12.12.12.12.12" xref="S4.E6.m1.12.12.12.12.12.12.cmml">⊙</mo><msub id="S4.E6.m1.14.14.14.14.14a.16.2.2" xref="S4.E6.m1.14.15.1.cmml"><mi id="S4.E6.m1.13.13.13.13.13.13" xref="S4.E6.m1.13.13.13.13.13.13.cmml">𝒈</mi><mi id="S4.E6.m1.14.14.14.14.14.14.1" xref="S4.E6.m1.14.14.14.14.14.14.1.cmml">t</mi></msub></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E6.m1.14b"><apply id="S4.E6.m1.14.15.1.cmml" xref="S4.E6.m1.14.14a"><eq id="S4.E6.m1.3.3.3.3.3.3.cmml" xref="S4.E6.m1.3.3.3.3.3.3"></eq><apply id="S4.E6.m1.14.15.1.2.cmml" xref="S4.E6.m1.14.14a"><csymbol cd="ambiguous" id="S4.E6.m1.14.15.1.2.1.cmml" xref="S4.E6.m1.14.14a">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1">𝒄</ci><ci id="S4.E6.m1.2.2.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2.2.2.1">𝑡</ci></apply><apply id="S4.E6.m1.14.15.1.3.cmml" xref="S4.E6.m1.14.14a"><plus id="S4.E6.m1.9.9.9.9.9.9.cmml" xref="S4.E6.m1.9.9.9.9.9.9"></plus><apply id="S4.E6.m1.14.15.1.3.2.cmml" xref="S4.E6.m1.14.14a"><csymbol cd="latexml" id="S4.E6.m1.6.6.6.6.6.6.cmml" xref="S4.E6.m1.6.6.6.6.6.6">direct-product</csymbol><apply id="S4.E6.m1.14.15.1.3.2.2.cmml" xref="S4.E6.m1.14.14a"><csymbol cd="ambiguous" id="S4.E6.m1.14.15.1.3.2.2.1.cmml" xref="S4.E6.m1.14.14a">subscript</csymbol><ci id="S4.E6.m1.4.4.4.4.4.4.cmml" xref="S4.E6.m1.4.4.4.4.4.4">𝒄</ci><apply id="S4.E6.m1.5.5.5.5.5.5.1.cmml" xref="S4.E6.m1.5.5.5.5.5.5.1"><minus id="S4.E6.m1.5.5.5.5.5.5.1.1.cmml" xref="S4.E6.m1.5.5.5.5.5.5.1.1"></minus><ci id="S4.E6.m1.5.5.5.5.5.5.1.2.cmml" xref="S4.E6.m1.5.5.5.5.5.5.1.2">𝑡</ci><cn type="integer" id="S4.E6.m1.5.5.5.5.5.5.1.3.cmml" xref="S4.E6.m1.5.5.5.5.5.5.1.3">1</cn></apply></apply><apply id="S4.E6.m1.14.15.1.3.2.3.cmml" xref="S4.E6.m1.14.14a"><csymbol cd="ambiguous" id="S4.E6.m1.14.15.1.3.2.3.1.cmml" xref="S4.E6.m1.14.14a">subscript</csymbol><ci id="S4.E6.m1.7.7.7.7.7.7.cmml" xref="S4.E6.m1.7.7.7.7.7.7">𝒇</ci><ci id="S4.E6.m1.8.8.8.8.8.8.1.cmml" xref="S4.E6.m1.8.8.8.8.8.8.1">𝑡</ci></apply></apply><apply id="S4.E6.m1.14.15.1.3.3.cmml" xref="S4.E6.m1.14.14a"><csymbol cd="latexml" id="S4.E6.m1.12.12.12.12.12.12.cmml" xref="S4.E6.m1.12.12.12.12.12.12">direct-product</csymbol><apply id="S4.E6.m1.14.15.1.3.3.2.cmml" xref="S4.E6.m1.14.14a"><csymbol cd="ambiguous" id="S4.E6.m1.14.15.1.3.3.2.1.cmml" xref="S4.E6.m1.14.14a">subscript</csymbol><ci id="S4.E6.m1.10.10.10.10.10.10.cmml" xref="S4.E6.m1.10.10.10.10.10.10">𝒊</ci><ci id="S4.E6.m1.11.11.11.11.11.11.1.cmml" xref="S4.E6.m1.11.11.11.11.11.11.1">𝑡</ci></apply><apply id="S4.E6.m1.14.15.1.3.3.3.cmml" xref="S4.E6.m1.14.14a"><csymbol cd="ambiguous" id="S4.E6.m1.14.15.1.3.3.3.1.cmml" xref="S4.E6.m1.14.14a">subscript</csymbol><ci id="S4.E6.m1.13.13.13.13.13.13.cmml" xref="S4.E6.m1.13.13.13.13.13.13">𝒈</ci><ci id="S4.E6.m1.14.14.14.14.14.14.1.cmml" xref="S4.E6.m1.14.14.14.14.14.14.1">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.14c">\displaystyle\begin{split}\bm{c}_{t}=\bm{c}_{t-1}\odot\bm{f}_{t}+\bm{i}_{t}\odot\bm{g}_{t}\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E7.m1.13" class="ltx_Math" alttext="\displaystyle\begin{split}\bm{h}_{t}=\text{tanh}(\bm{c}_{t}\odot\bm{o}_{t})\end{split}" display="inline"><semantics id="S4.E7.m1.13a"><mtable id="S4.E7.m1.13.13.2" xref="S4.E7.m1.12.12.1.cmml"><mtr id="S4.E7.m1.13.13.2a" xref="S4.E7.m1.12.12.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S4.E7.m1.13.13.2b" xref="S4.E7.m1.12.12.1.cmml"><mrow id="S4.E7.m1.13.13.2.12.12.12" xref="S4.E7.m1.12.12.1.cmml"><msub id="S4.E7.m1.13.13.2.12.12.12.13" xref="S4.E7.m1.12.12.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml">𝒉</mi><mi id="S4.E7.m1.2.2.2.2.2.2.1" xref="S4.E7.m1.2.2.2.2.2.2.1.cmml">t</mi></msub><mo id="S4.E7.m1.3.3.3.3.3.3" xref="S4.E7.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E7.m1.13.13.2.12.12.12.12" xref="S4.E7.m1.12.12.1.cmml"><mtext id="S4.E7.m1.4.4.4.4.4.4" xref="S4.E7.m1.4.4.4.4.4.4a.cmml">tanh</mtext><mo lspace="0em" rspace="0em" id="S4.E7.m1.13.13.2.12.12.12.12.2" xref="S4.E7.m1.12.12.1.cmml">​</mo><mrow id="S4.E7.m1.13.13.2.12.12.12.12.1.1" xref="S4.E7.m1.12.12.1.cmml"><mo stretchy="false" id="S4.E7.m1.5.5.5.5.5.5" xref="S4.E7.m1.12.12.1.cmml">(</mo><mrow id="S4.E7.m1.13.13.2.12.12.12.12.1.1.1" xref="S4.E7.m1.12.12.1.cmml"><msub id="S4.E7.m1.13.13.2.12.12.12.12.1.1.1.1" xref="S4.E7.m1.12.12.1.cmml"><mi id="S4.E7.m1.6.6.6.6.6.6" xref="S4.E7.m1.6.6.6.6.6.6.cmml">𝒄</mi><mi id="S4.E7.m1.7.7.7.7.7.7.1" xref="S4.E7.m1.7.7.7.7.7.7.1.cmml">t</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E7.m1.8.8.8.8.8.8" xref="S4.E7.m1.8.8.8.8.8.8.cmml">⊙</mo><msub id="S4.E7.m1.13.13.2.12.12.12.12.1.1.1.2" xref="S4.E7.m1.12.12.1.cmml"><mi id="S4.E7.m1.9.9.9.9.9.9" xref="S4.E7.m1.9.9.9.9.9.9.cmml">𝒐</mi><mi id="S4.E7.m1.10.10.10.10.10.10.1" xref="S4.E7.m1.10.10.10.10.10.10.1.cmml">t</mi></msub></mrow><mo stretchy="false" id="S4.E7.m1.11.11.11.11.11.11" xref="S4.E7.m1.12.12.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E7.m1.13b"><apply id="S4.E7.m1.12.12.1.cmml" xref="S4.E7.m1.13.13.2"><eq id="S4.E7.m1.3.3.3.3.3.3.cmml" xref="S4.E7.m1.3.3.3.3.3.3"></eq><apply id="S4.E7.m1.12.12.1.3.cmml" xref="S4.E7.m1.13.13.2"><csymbol cd="ambiguous" id="S4.E7.m1.12.12.1.3.1.cmml" xref="S4.E7.m1.13.13.2">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1">𝒉</ci><ci id="S4.E7.m1.2.2.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1">𝑡</ci></apply><apply id="S4.E7.m1.12.12.1.1.cmml" xref="S4.E7.m1.13.13.2"><times id="S4.E7.m1.12.12.1.1.2.cmml" xref="S4.E7.m1.13.13.2"></times><ci id="S4.E7.m1.4.4.4.4.4.4a.cmml" xref="S4.E7.m1.4.4.4.4.4.4"><mtext id="S4.E7.m1.4.4.4.4.4.4.cmml" xref="S4.E7.m1.4.4.4.4.4.4">tanh</mtext></ci><apply id="S4.E7.m1.12.12.1.1.1.1.1.cmml" xref="S4.E7.m1.13.13.2"><csymbol cd="latexml" id="S4.E7.m1.8.8.8.8.8.8.cmml" xref="S4.E7.m1.8.8.8.8.8.8">direct-product</csymbol><apply id="S4.E7.m1.12.12.1.1.1.1.1.2.cmml" xref="S4.E7.m1.13.13.2"><csymbol cd="ambiguous" id="S4.E7.m1.12.12.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.13.13.2">subscript</csymbol><ci id="S4.E7.m1.6.6.6.6.6.6.cmml" xref="S4.E7.m1.6.6.6.6.6.6">𝒄</ci><ci id="S4.E7.m1.7.7.7.7.7.7.1.cmml" xref="S4.E7.m1.7.7.7.7.7.7.1">𝑡</ci></apply><apply id="S4.E7.m1.12.12.1.1.1.1.1.3.cmml" xref="S4.E7.m1.13.13.2"><csymbol cd="ambiguous" id="S4.E7.m1.12.12.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.13.13.2">subscript</csymbol><ci id="S4.E7.m1.9.9.9.9.9.9.cmml" xref="S4.E7.m1.9.9.9.9.9.9">𝒐</ci><ci id="S4.E7.m1.10.10.10.10.10.10.1.cmml" xref="S4.E7.m1.10.10.10.10.10.10.1">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.13c">\displaystyle\begin{split}\bm{h}_{t}=\text{tanh}(\bm{c}_{t}\odot\bm{o}_{t})\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.16" class="ltx_p">The weight matrices associated with the inputs <math id="S4.SS3.p5.1.m1.1" class="ltx_Math" alttext="\bm{x}_{t}" display="inline"><semantics id="S4.SS3.p5.1.m1.1a"><msub id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml"><mi id="S4.SS3.p5.1.m1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.2.cmml">𝒙</mi><mi id="S4.SS3.p5.1.m1.1.1.3" xref="S4.SS3.p5.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><apply id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p5.1.m1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.1.2">𝒙</ci><ci id="S4.SS3.p5.1.m1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">\bm{x}_{t}</annotation></semantics></math> and <math id="S4.SS3.p5.2.m2.1" class="ltx_Math" alttext="\bm{h}_{t-1}" display="inline"><semantics id="S4.SS3.p5.2.m2.1a"><msub id="S4.SS3.p5.2.m2.1.1" xref="S4.SS3.p5.2.m2.1.1.cmml"><mi id="S4.SS3.p5.2.m2.1.1.2" xref="S4.SS3.p5.2.m2.1.1.2.cmml">𝒉</mi><mrow id="S4.SS3.p5.2.m2.1.1.3" xref="S4.SS3.p5.2.m2.1.1.3.cmml"><mi id="S4.SS3.p5.2.m2.1.1.3.2" xref="S4.SS3.p5.2.m2.1.1.3.2.cmml">t</mi><mo id="S4.SS3.p5.2.m2.1.1.3.1" xref="S4.SS3.p5.2.m2.1.1.3.1.cmml">−</mo><mn id="S4.SS3.p5.2.m2.1.1.3.3" xref="S4.SS3.p5.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.1b"><apply id="S4.SS3.p5.2.m2.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.2.m2.1.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p5.2.m2.1.1.2.cmml" xref="S4.SS3.p5.2.m2.1.1.2">𝒉</ci><apply id="S4.SS3.p5.2.m2.1.1.3.cmml" xref="S4.SS3.p5.2.m2.1.1.3"><minus id="S4.SS3.p5.2.m2.1.1.3.1.cmml" xref="S4.SS3.p5.2.m2.1.1.3.1"></minus><ci id="S4.SS3.p5.2.m2.1.1.3.2.cmml" xref="S4.SS3.p5.2.m2.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS3.p5.2.m2.1.1.3.3.cmml" xref="S4.SS3.p5.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.1c">\bm{h}_{t-1}</annotation></semantics></math> destined for each gate are given by <math id="S4.SS3.p5.3.m3.1" class="ltx_Math" alttext="\bm{W}_{fx}" display="inline"><semantics id="S4.SS3.p5.3.m3.1a"><msub id="S4.SS3.p5.3.m3.1.1" xref="S4.SS3.p5.3.m3.1.1.cmml"><mi id="S4.SS3.p5.3.m3.1.1.2" xref="S4.SS3.p5.3.m3.1.1.2.cmml">𝑾</mi><mrow id="S4.SS3.p5.3.m3.1.1.3" xref="S4.SS3.p5.3.m3.1.1.3.cmml"><mi id="S4.SS3.p5.3.m3.1.1.3.2" xref="S4.SS3.p5.3.m3.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.3.m3.1.1.3.1" xref="S4.SS3.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.3.m3.1.1.3.3" xref="S4.SS3.p5.3.m3.1.1.3.3.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.3.m3.1b"><apply id="S4.SS3.p5.3.m3.1.1.cmml" xref="S4.SS3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.3.m3.1.1.1.cmml" xref="S4.SS3.p5.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p5.3.m3.1.1.2.cmml" xref="S4.SS3.p5.3.m3.1.1.2">𝑾</ci><apply id="S4.SS3.p5.3.m3.1.1.3.cmml" xref="S4.SS3.p5.3.m3.1.1.3"><times id="S4.SS3.p5.3.m3.1.1.3.1.cmml" xref="S4.SS3.p5.3.m3.1.1.3.1"></times><ci id="S4.SS3.p5.3.m3.1.1.3.2.cmml" xref="S4.SS3.p5.3.m3.1.1.3.2">𝑓</ci><ci id="S4.SS3.p5.3.m3.1.1.3.3.cmml" xref="S4.SS3.p5.3.m3.1.1.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.3.m3.1c">\bm{W}_{fx}</annotation></semantics></math>, <math id="S4.SS3.p5.4.m4.1" class="ltx_Math" alttext="\bm{W}_{fh}" display="inline"><semantics id="S4.SS3.p5.4.m4.1a"><msub id="S4.SS3.p5.4.m4.1.1" xref="S4.SS3.p5.4.m4.1.1.cmml"><mi id="S4.SS3.p5.4.m4.1.1.2" xref="S4.SS3.p5.4.m4.1.1.2.cmml">𝑾</mi><mrow id="S4.SS3.p5.4.m4.1.1.3" xref="S4.SS3.p5.4.m4.1.1.3.cmml"><mi id="S4.SS3.p5.4.m4.1.1.3.2" xref="S4.SS3.p5.4.m4.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.4.m4.1.1.3.1" xref="S4.SS3.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.4.m4.1.1.3.3" xref="S4.SS3.p5.4.m4.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.4.m4.1b"><apply id="S4.SS3.p5.4.m4.1.1.cmml" xref="S4.SS3.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.4.m4.1.1.1.cmml" xref="S4.SS3.p5.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p5.4.m4.1.1.2.cmml" xref="S4.SS3.p5.4.m4.1.1.2">𝑾</ci><apply id="S4.SS3.p5.4.m4.1.1.3.cmml" xref="S4.SS3.p5.4.m4.1.1.3"><times id="S4.SS3.p5.4.m4.1.1.3.1.cmml" xref="S4.SS3.p5.4.m4.1.1.3.1"></times><ci id="S4.SS3.p5.4.m4.1.1.3.2.cmml" xref="S4.SS3.p5.4.m4.1.1.3.2">𝑓</ci><ci id="S4.SS3.p5.4.m4.1.1.3.3.cmml" xref="S4.SS3.p5.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.4.m4.1c">\bm{W}_{fh}</annotation></semantics></math>, <math id="S4.SS3.p5.5.m5.1" class="ltx_Math" alttext="\bm{W}_{ix}" display="inline"><semantics id="S4.SS3.p5.5.m5.1a"><msub id="S4.SS3.p5.5.m5.1.1" xref="S4.SS3.p5.5.m5.1.1.cmml"><mi id="S4.SS3.p5.5.m5.1.1.2" xref="S4.SS3.p5.5.m5.1.1.2.cmml">𝑾</mi><mrow id="S4.SS3.p5.5.m5.1.1.3" xref="S4.SS3.p5.5.m5.1.1.3.cmml"><mi id="S4.SS3.p5.5.m5.1.1.3.2" xref="S4.SS3.p5.5.m5.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.5.m5.1.1.3.1" xref="S4.SS3.p5.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.5.m5.1.1.3.3" xref="S4.SS3.p5.5.m5.1.1.3.3.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.5.m5.1b"><apply id="S4.SS3.p5.5.m5.1.1.cmml" xref="S4.SS3.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.5.m5.1.1.1.cmml" xref="S4.SS3.p5.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p5.5.m5.1.1.2.cmml" xref="S4.SS3.p5.5.m5.1.1.2">𝑾</ci><apply id="S4.SS3.p5.5.m5.1.1.3.cmml" xref="S4.SS3.p5.5.m5.1.1.3"><times id="S4.SS3.p5.5.m5.1.1.3.1.cmml" xref="S4.SS3.p5.5.m5.1.1.3.1"></times><ci id="S4.SS3.p5.5.m5.1.1.3.2.cmml" xref="S4.SS3.p5.5.m5.1.1.3.2">𝑖</ci><ci id="S4.SS3.p5.5.m5.1.1.3.3.cmml" xref="S4.SS3.p5.5.m5.1.1.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.5.m5.1c">\bm{W}_{ix}</annotation></semantics></math>, <math id="S4.SS3.p5.6.m6.1" class="ltx_Math" alttext="\bm{W}_{ih}" display="inline"><semantics id="S4.SS3.p5.6.m6.1a"><msub id="S4.SS3.p5.6.m6.1.1" xref="S4.SS3.p5.6.m6.1.1.cmml"><mi id="S4.SS3.p5.6.m6.1.1.2" xref="S4.SS3.p5.6.m6.1.1.2.cmml">𝑾</mi><mrow id="S4.SS3.p5.6.m6.1.1.3" xref="S4.SS3.p5.6.m6.1.1.3.cmml"><mi id="S4.SS3.p5.6.m6.1.1.3.2" xref="S4.SS3.p5.6.m6.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.6.m6.1.1.3.1" xref="S4.SS3.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.6.m6.1.1.3.3" xref="S4.SS3.p5.6.m6.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.6.m6.1b"><apply id="S4.SS3.p5.6.m6.1.1.cmml" xref="S4.SS3.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.6.m6.1.1.1.cmml" xref="S4.SS3.p5.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.p5.6.m6.1.1.2.cmml" xref="S4.SS3.p5.6.m6.1.1.2">𝑾</ci><apply id="S4.SS3.p5.6.m6.1.1.3.cmml" xref="S4.SS3.p5.6.m6.1.1.3"><times id="S4.SS3.p5.6.m6.1.1.3.1.cmml" xref="S4.SS3.p5.6.m6.1.1.3.1"></times><ci id="S4.SS3.p5.6.m6.1.1.3.2.cmml" xref="S4.SS3.p5.6.m6.1.1.3.2">𝑖</ci><ci id="S4.SS3.p5.6.m6.1.1.3.3.cmml" xref="S4.SS3.p5.6.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.6.m6.1c">\bm{W}_{ih}</annotation></semantics></math>, <math id="S4.SS3.p5.7.m7.1" class="ltx_Math" alttext="\bm{W}_{ox}" display="inline"><semantics id="S4.SS3.p5.7.m7.1a"><msub id="S4.SS3.p5.7.m7.1.1" xref="S4.SS3.p5.7.m7.1.1.cmml"><mi id="S4.SS3.p5.7.m7.1.1.2" xref="S4.SS3.p5.7.m7.1.1.2.cmml">𝑾</mi><mrow id="S4.SS3.p5.7.m7.1.1.3" xref="S4.SS3.p5.7.m7.1.1.3.cmml"><mi id="S4.SS3.p5.7.m7.1.1.3.2" xref="S4.SS3.p5.7.m7.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.7.m7.1.1.3.1" xref="S4.SS3.p5.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.7.m7.1.1.3.3" xref="S4.SS3.p5.7.m7.1.1.3.3.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.7.m7.1b"><apply id="S4.SS3.p5.7.m7.1.1.cmml" xref="S4.SS3.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.7.m7.1.1.1.cmml" xref="S4.SS3.p5.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.p5.7.m7.1.1.2.cmml" xref="S4.SS3.p5.7.m7.1.1.2">𝑾</ci><apply id="S4.SS3.p5.7.m7.1.1.3.cmml" xref="S4.SS3.p5.7.m7.1.1.3"><times id="S4.SS3.p5.7.m7.1.1.3.1.cmml" xref="S4.SS3.p5.7.m7.1.1.3.1"></times><ci id="S4.SS3.p5.7.m7.1.1.3.2.cmml" xref="S4.SS3.p5.7.m7.1.1.3.2">𝑜</ci><ci id="S4.SS3.p5.7.m7.1.1.3.3.cmml" xref="S4.SS3.p5.7.m7.1.1.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.7.m7.1c">\bm{W}_{ox}</annotation></semantics></math>, <math id="S4.SS3.p5.8.m8.1" class="ltx_Math" alttext="\bm{W}_{oh}" display="inline"><semantics id="S4.SS3.p5.8.m8.1a"><msub id="S4.SS3.p5.8.m8.1.1" xref="S4.SS3.p5.8.m8.1.1.cmml"><mi id="S4.SS3.p5.8.m8.1.1.2" xref="S4.SS3.p5.8.m8.1.1.2.cmml">𝑾</mi><mrow id="S4.SS3.p5.8.m8.1.1.3" xref="S4.SS3.p5.8.m8.1.1.3.cmml"><mi id="S4.SS3.p5.8.m8.1.1.3.2" xref="S4.SS3.p5.8.m8.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.8.m8.1.1.3.1" xref="S4.SS3.p5.8.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.8.m8.1.1.3.3" xref="S4.SS3.p5.8.m8.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.8.m8.1b"><apply id="S4.SS3.p5.8.m8.1.1.cmml" xref="S4.SS3.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.8.m8.1.1.1.cmml" xref="S4.SS3.p5.8.m8.1.1">subscript</csymbol><ci id="S4.SS3.p5.8.m8.1.1.2.cmml" xref="S4.SS3.p5.8.m8.1.1.2">𝑾</ci><apply id="S4.SS3.p5.8.m8.1.1.3.cmml" xref="S4.SS3.p5.8.m8.1.1.3"><times id="S4.SS3.p5.8.m8.1.1.3.1.cmml" xref="S4.SS3.p5.8.m8.1.1.3.1"></times><ci id="S4.SS3.p5.8.m8.1.1.3.2.cmml" xref="S4.SS3.p5.8.m8.1.1.3.2">𝑜</ci><ci id="S4.SS3.p5.8.m8.1.1.3.3.cmml" xref="S4.SS3.p5.8.m8.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.8.m8.1c">\bm{W}_{oh}</annotation></semantics></math>, <math id="S4.SS3.p5.9.m9.1" class="ltx_Math" alttext="\bm{W}_{gx}" display="inline"><semantics id="S4.SS3.p5.9.m9.1a"><msub id="S4.SS3.p5.9.m9.1.1" xref="S4.SS3.p5.9.m9.1.1.cmml"><mi id="S4.SS3.p5.9.m9.1.1.2" xref="S4.SS3.p5.9.m9.1.1.2.cmml">𝑾</mi><mrow id="S4.SS3.p5.9.m9.1.1.3" xref="S4.SS3.p5.9.m9.1.1.3.cmml"><mi id="S4.SS3.p5.9.m9.1.1.3.2" xref="S4.SS3.p5.9.m9.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.9.m9.1.1.3.1" xref="S4.SS3.p5.9.m9.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.9.m9.1.1.3.3" xref="S4.SS3.p5.9.m9.1.1.3.3.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.9.m9.1b"><apply id="S4.SS3.p5.9.m9.1.1.cmml" xref="S4.SS3.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.9.m9.1.1.1.cmml" xref="S4.SS3.p5.9.m9.1.1">subscript</csymbol><ci id="S4.SS3.p5.9.m9.1.1.2.cmml" xref="S4.SS3.p5.9.m9.1.1.2">𝑾</ci><apply id="S4.SS3.p5.9.m9.1.1.3.cmml" xref="S4.SS3.p5.9.m9.1.1.3"><times id="S4.SS3.p5.9.m9.1.1.3.1.cmml" xref="S4.SS3.p5.9.m9.1.1.3.1"></times><ci id="S4.SS3.p5.9.m9.1.1.3.2.cmml" xref="S4.SS3.p5.9.m9.1.1.3.2">𝑔</ci><ci id="S4.SS3.p5.9.m9.1.1.3.3.cmml" xref="S4.SS3.p5.9.m9.1.1.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.9.m9.1c">\bm{W}_{gx}</annotation></semantics></math> and <math id="S4.SS3.p5.10.m10.1" class="ltx_Math" alttext="\bm{W}_{gh}" display="inline"><semantics id="S4.SS3.p5.10.m10.1a"><msub id="S4.SS3.p5.10.m10.1.1" xref="S4.SS3.p5.10.m10.1.1.cmml"><mi id="S4.SS3.p5.10.m10.1.1.2" xref="S4.SS3.p5.10.m10.1.1.2.cmml">𝑾</mi><mrow id="S4.SS3.p5.10.m10.1.1.3" xref="S4.SS3.p5.10.m10.1.1.3.cmml"><mi id="S4.SS3.p5.10.m10.1.1.3.2" xref="S4.SS3.p5.10.m10.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p5.10.m10.1.1.3.1" xref="S4.SS3.p5.10.m10.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p5.10.m10.1.1.3.3" xref="S4.SS3.p5.10.m10.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.10.m10.1b"><apply id="S4.SS3.p5.10.m10.1.1.cmml" xref="S4.SS3.p5.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.10.m10.1.1.1.cmml" xref="S4.SS3.p5.10.m10.1.1">subscript</csymbol><ci id="S4.SS3.p5.10.m10.1.1.2.cmml" xref="S4.SS3.p5.10.m10.1.1.2">𝑾</ci><apply id="S4.SS3.p5.10.m10.1.1.3.cmml" xref="S4.SS3.p5.10.m10.1.1.3"><times id="S4.SS3.p5.10.m10.1.1.3.1.cmml" xref="S4.SS3.p5.10.m10.1.1.3.1"></times><ci id="S4.SS3.p5.10.m10.1.1.3.2.cmml" xref="S4.SS3.p5.10.m10.1.1.3.2">𝑔</ci><ci id="S4.SS3.p5.10.m10.1.1.3.3.cmml" xref="S4.SS3.p5.10.m10.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.10.m10.1c">\bm{W}_{gh}</annotation></semantics></math> and the bias vectors are given by <math id="S4.SS3.p5.11.m11.1" class="ltx_Math" alttext="\bm{b}_{f}" display="inline"><semantics id="S4.SS3.p5.11.m11.1a"><msub id="S4.SS3.p5.11.m11.1.1" xref="S4.SS3.p5.11.m11.1.1.cmml"><mi id="S4.SS3.p5.11.m11.1.1.2" xref="S4.SS3.p5.11.m11.1.1.2.cmml">𝒃</mi><mi id="S4.SS3.p5.11.m11.1.1.3" xref="S4.SS3.p5.11.m11.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.11.m11.1b"><apply id="S4.SS3.p5.11.m11.1.1.cmml" xref="S4.SS3.p5.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.11.m11.1.1.1.cmml" xref="S4.SS3.p5.11.m11.1.1">subscript</csymbol><ci id="S4.SS3.p5.11.m11.1.1.2.cmml" xref="S4.SS3.p5.11.m11.1.1.2">𝒃</ci><ci id="S4.SS3.p5.11.m11.1.1.3.cmml" xref="S4.SS3.p5.11.m11.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.11.m11.1c">\bm{b}_{f}</annotation></semantics></math>, <math id="S4.SS3.p5.12.m12.1" class="ltx_Math" alttext="\bm{b}_{i}" display="inline"><semantics id="S4.SS3.p5.12.m12.1a"><msub id="S4.SS3.p5.12.m12.1.1" xref="S4.SS3.p5.12.m12.1.1.cmml"><mi id="S4.SS3.p5.12.m12.1.1.2" xref="S4.SS3.p5.12.m12.1.1.2.cmml">𝒃</mi><mi id="S4.SS3.p5.12.m12.1.1.3" xref="S4.SS3.p5.12.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.12.m12.1b"><apply id="S4.SS3.p5.12.m12.1.1.cmml" xref="S4.SS3.p5.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.12.m12.1.1.1.cmml" xref="S4.SS3.p5.12.m12.1.1">subscript</csymbol><ci id="S4.SS3.p5.12.m12.1.1.2.cmml" xref="S4.SS3.p5.12.m12.1.1.2">𝒃</ci><ci id="S4.SS3.p5.12.m12.1.1.3.cmml" xref="S4.SS3.p5.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.12.m12.1c">\bm{b}_{i}</annotation></semantics></math>, <math id="S4.SS3.p5.13.m13.1" class="ltx_Math" alttext="\bm{b}_{o}" display="inline"><semantics id="S4.SS3.p5.13.m13.1a"><msub id="S4.SS3.p5.13.m13.1.1" xref="S4.SS3.p5.13.m13.1.1.cmml"><mi id="S4.SS3.p5.13.m13.1.1.2" xref="S4.SS3.p5.13.m13.1.1.2.cmml">𝒃</mi><mi id="S4.SS3.p5.13.m13.1.1.3" xref="S4.SS3.p5.13.m13.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.13.m13.1b"><apply id="S4.SS3.p5.13.m13.1.1.cmml" xref="S4.SS3.p5.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.13.m13.1.1.1.cmml" xref="S4.SS3.p5.13.m13.1.1">subscript</csymbol><ci id="S4.SS3.p5.13.m13.1.1.2.cmml" xref="S4.SS3.p5.13.m13.1.1.2">𝒃</ci><ci id="S4.SS3.p5.13.m13.1.1.3.cmml" xref="S4.SS3.p5.13.m13.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.13.m13.1c">\bm{b}_{o}</annotation></semantics></math> and <math id="S4.SS3.p5.14.m14.1" class="ltx_Math" alttext="\bm{b}_{g}" display="inline"><semantics id="S4.SS3.p5.14.m14.1a"><msub id="S4.SS3.p5.14.m14.1.1" xref="S4.SS3.p5.14.m14.1.1.cmml"><mi id="S4.SS3.p5.14.m14.1.1.2" xref="S4.SS3.p5.14.m14.1.1.2.cmml">𝒃</mi><mi id="S4.SS3.p5.14.m14.1.1.3" xref="S4.SS3.p5.14.m14.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.14.m14.1b"><apply id="S4.SS3.p5.14.m14.1.1.cmml" xref="S4.SS3.p5.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.14.m14.1.1.1.cmml" xref="S4.SS3.p5.14.m14.1.1">subscript</csymbol><ci id="S4.SS3.p5.14.m14.1.1.2.cmml" xref="S4.SS3.p5.14.m14.1.1.2">𝒃</ci><ci id="S4.SS3.p5.14.m14.1.1.3.cmml" xref="S4.SS3.p5.14.m14.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.14.m14.1c">\bm{b}_{g}</annotation></semantics></math>. The <math id="S4.SS3.p5.15.m15.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S4.SS3.p5.15.m15.1a"><mo id="S4.SS3.p5.15.m15.1.1" xref="S4.SS3.p5.15.m15.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.15.m15.1b"><csymbol cd="latexml" id="S4.SS3.p5.15.m15.1.1.cmml" xref="S4.SS3.p5.15.m15.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.15.m15.1c">\odot</annotation></semantics></math> operator denotes element-wise multiplication and <math id="S4.SS3.p5.16.m16.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS3.p5.16.m16.1a"><mi id="S4.SS3.p5.16.m16.1.1" xref="S4.SS3.p5.16.m16.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.16.m16.1b"><ci id="S4.SS3.p5.16.m16.1.1.cmml" xref="S4.SS3.p5.16.m16.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.16.m16.1c">\sigma</annotation></semantics></math> is an application of the sigmoid function. A schematic of the internal workings of an individual LSTM cell is given in <a href="#S4.F5" title="Figure 5 ‣ IV-C LSTM framework ‣ IV Methodology ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 5</span></a>.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2105.13325/assets/LSTM-cell.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="675" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Schematic of the operations associated within an LSTM hidden unit. The computed internal state <math id="S4.F5.6.m1.1" class="ltx_Math" alttext="\bm{c}_{t}" display="inline"><semantics id="S4.F5.6.m1.1b"><msub id="S4.F5.6.m1.1.1" xref="S4.F5.6.m1.1.1.cmml"><mi id="S4.F5.6.m1.1.1.2" xref="S4.F5.6.m1.1.1.2.cmml">𝒄</mi><mi id="S4.F5.6.m1.1.1.3" xref="S4.F5.6.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F5.6.m1.1c"><apply id="S4.F5.6.m1.1.1.cmml" xref="S4.F5.6.m1.1.1"><csymbol cd="ambiguous" id="S4.F5.6.m1.1.1.1.cmml" xref="S4.F5.6.m1.1.1">subscript</csymbol><ci id="S4.F5.6.m1.1.1.2.cmml" xref="S4.F5.6.m1.1.1.2">𝒄</ci><ci id="S4.F5.6.m1.1.1.3.cmml" xref="S4.F5.6.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.6.m1.1d">\bm{c}_{t}</annotation></semantics></math>, and output <math id="S4.F5.7.m2.1" class="ltx_Math" alttext="\bm{h}_{t}" display="inline"><semantics id="S4.F5.7.m2.1b"><msub id="S4.F5.7.m2.1.1" xref="S4.F5.7.m2.1.1.cmml"><mi id="S4.F5.7.m2.1.1.2" xref="S4.F5.7.m2.1.1.2.cmml">𝒉</mi><mi id="S4.F5.7.m2.1.1.3" xref="S4.F5.7.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F5.7.m2.1c"><apply id="S4.F5.7.m2.1.1.cmml" xref="S4.F5.7.m2.1.1"><csymbol cd="ambiguous" id="S4.F5.7.m2.1.1.1.cmml" xref="S4.F5.7.m2.1.1">subscript</csymbol><ci id="S4.F5.7.m2.1.1.2.cmml" xref="S4.F5.7.m2.1.1.2">𝒉</ci><ci id="S4.F5.7.m2.1.1.3.cmml" xref="S4.F5.7.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.7.m2.1d">\bm{h}_{t}</annotation></semantics></math> calculated at time step <math id="S4.F5.8.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.F5.8.m3.1b"><mi id="S4.F5.8.m3.1.1" xref="S4.F5.8.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.F5.8.m3.1c"><ci id="S4.F5.8.m3.1.1.cmml" xref="S4.F5.8.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.8.m3.1d">t</annotation></semantics></math> form the next inputs to the same cell at time step <math id="S4.F5.9.m4.1" class="ltx_Math" alttext="t+1" display="inline"><semantics id="S4.F5.9.m4.1b"><mrow id="S4.F5.9.m4.1.1" xref="S4.F5.9.m4.1.1.cmml"><mi id="S4.F5.9.m4.1.1.2" xref="S4.F5.9.m4.1.1.2.cmml">t</mi><mo id="S4.F5.9.m4.1.1.1" xref="S4.F5.9.m4.1.1.1.cmml">+</mo><mn id="S4.F5.9.m4.1.1.3" xref="S4.F5.9.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.9.m4.1c"><apply id="S4.F5.9.m4.1.1.cmml" xref="S4.F5.9.m4.1.1"><plus id="S4.F5.9.m4.1.1.1.cmml" xref="S4.F5.9.m4.1.1.1"></plus><ci id="S4.F5.9.m4.1.1.2.cmml" xref="S4.F5.9.m4.1.1.2">𝑡</ci><cn type="integer" id="S4.F5.9.m4.1.1.3.cmml" xref="S4.F5.9.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.9.m4.1d">t+1</annotation></semantics></math> along with the next input vector <math id="S4.F5.10.m5.1" class="ltx_Math" alttext="\bm{x}_{t+1}" display="inline"><semantics id="S4.F5.10.m5.1b"><msub id="S4.F5.10.m5.1.1" xref="S4.F5.10.m5.1.1.cmml"><mi id="S4.F5.10.m5.1.1.2" xref="S4.F5.10.m5.1.1.2.cmml">𝒙</mi><mrow id="S4.F5.10.m5.1.1.3" xref="S4.F5.10.m5.1.1.3.cmml"><mi id="S4.F5.10.m5.1.1.3.2" xref="S4.F5.10.m5.1.1.3.2.cmml">t</mi><mo id="S4.F5.10.m5.1.1.3.1" xref="S4.F5.10.m5.1.1.3.1.cmml">+</mo><mn id="S4.F5.10.m5.1.1.3.3" xref="S4.F5.10.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F5.10.m5.1c"><apply id="S4.F5.10.m5.1.1.cmml" xref="S4.F5.10.m5.1.1"><csymbol cd="ambiguous" id="S4.F5.10.m5.1.1.1.cmml" xref="S4.F5.10.m5.1.1">subscript</csymbol><ci id="S4.F5.10.m5.1.1.2.cmml" xref="S4.F5.10.m5.1.1.2">𝒙</ci><apply id="S4.F5.10.m5.1.1.3.cmml" xref="S4.F5.10.m5.1.1.3"><plus id="S4.F5.10.m5.1.1.3.1.cmml" xref="S4.F5.10.m5.1.1.3.1"></plus><ci id="S4.F5.10.m5.1.1.3.2.cmml" xref="S4.F5.10.m5.1.1.3.2">𝑡</ci><cn type="integer" id="S4.F5.10.m5.1.1.3.3.cmml" xref="S4.F5.10.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.10.m5.1d">\bm{x}_{t+1}</annotation></semantics></math> in the sequence.</figcaption>
</figure>
<div id="S4.SS3.p6" class="ltx_para">
<p id="S4.SS3.p6.1" class="ltx_p">For our experiments we took inspiration from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> and designed our LSTM network using 2 connected layers, each containing 20 hidden LTSM cells followed by a single linear feed-forward layer. The loss function used for optimisation was a simple mean squared error. The Adam optimiser was used for training the network in all experiments using the recommended default hyperparameters in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> combined with a fixed learning rate of 0.001 and a fixed batch size of 256 sequences.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.5.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.6.2" class="ltx_text ltx_font_italic">Training scenarios</span>
</h3>

<figure id="S4.F6" class="ltx_figure"><img src="/html/2105.13325/assets/training-scenarios.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="728" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Diagrams detailing the the different training scenarios. a) Centralised learning - data is sent from clients to server, model and training is on the server. b) Localised training - data, model and training are isolated to each client. c) FL - data and training isolated to each client, model is aggregated from client updates at the server. d) FL+HC - after n rounds of FL, clients are clustered and model updates from each cluster are aggregated to specialised cluster models at the server (colours represent clusters). e) Local fine-tuning (LFT) - an extra step after either FL or FL+HC where training is isolated to each client starting with the model produced at the FL stage.</figcaption>
</figure>
<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">In order to test the effectiveness of applying FL to load forecasting, we provide benchmarks against centralised learning, local-only learning and various FL training scenarios. These different training approaches are summarised in <a href="#S4.T1" title="TABLE I ‣ IV-D Training scenarios ‣ IV Methodology ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table I</span></a> and described diagrammatically in <a href="#S4.F6" title="Figure 6 ‣ IV-D Training scenarios ‣ IV Methodology ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 6</span></a>.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">Firstly we developed a non-distributed, centralised learning approach that is most commonly applied where the privacy of data is not a major concern during training. This approach pools individual household datasets together and training is conducted in a single location. This approach provides a baseline for what a single, joint forecasting model can achieve in a non-private setting. In this scenario, the same network parameters are used by all households at the inference stage. Under this centralised approach we train models for 500 epochs with early stopping based on the lowest error achieved on the validation set.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.1" class="ltx_p">The most important benchmark we developed is a fully-private localised learning setting. All individual datasets remain private and unseen by other data owners under this scenario and the training procedure is isolated to each household. This approach results in unique forecasting models tailored to each household but cannot benefit from knowledge that could be embedded in data owned by other households. As per the centralised learning approach, training was conducted for a maximum of 500 epochs with early stopping.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Summary of training scenarios, the forecasting models produced by each scenario and the privacy associated with each scenario.</figcaption>
<table id="S4.T1.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.2.3.1" class="ltx_tr">
<th id="S4.T1.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S4.T1.2.3.1.1.1" class="ltx_text" style="font-size:90%;">Training scenario</span></th>
<th id="S4.T1.2.3.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.2.3.1.2.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<th id="S4.T1.2.3.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.2.3.1.3.1" class="ltx_text" style="font-size:90%;">Private?</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.2.4.1" class="ltx_tr">
<th id="S4.T1.2.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T1.2.4.1.1.1" class="ltx_text" style="font-size:90%;">Centralised</span></th>
<td id="S4.T1.2.4.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.2.4.1.2.1" class="ltx_text" style="font-size:90%;">Single/Joint</span></td>
<td id="S4.T1.2.4.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.2.4.1.3.1" class="ltx_text" style="font-size:90%;">✗</span></td>
</tr>
<tr id="S4.T1.2.5.2" class="ltx_tr">
<th id="S4.T1.2.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.2.5.2.1.1" class="ltx_text" style="font-size:90%;">Localised</span></th>
<td id="S4.T1.2.5.2.2" class="ltx_td ltx_align_left"><span id="S4.T1.2.5.2.2.1" class="ltx_text" style="font-size:90%;">Multiple/Specialised</span></td>
<td id="S4.T1.2.5.2.3" class="ltx_td ltx_align_left"><span id="S4.T1.2.5.2.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
</tr>
<tr id="S4.T1.2.6.3" class="ltx_tr">
<th id="S4.T1.2.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.2.6.3.1.1" class="ltx_text" style="font-size:90%;">FL</span></th>
<td id="S4.T1.2.6.3.2" class="ltx_td ltx_align_left"><span id="S4.T1.2.6.3.2.1" class="ltx_text" style="font-size:90%;">Single/Joint</span></td>
<td id="S4.T1.2.6.3.3" class="ltx_td ltx_align_left"><span id="S4.T1.2.6.3.3.1" class="ltx_text" style="font-size:90%;">✓ w.r.t. raw data</span></td>
</tr>
<tr id="S4.T1.2.7.4" class="ltx_tr">
<th id="S4.T1.2.7.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T1.2.7.4.1.1" class="ltx_text" style="font-size:90%;">FL+HC</span></th>
<td id="S4.T1.2.7.4.2" class="ltx_td ltx_align_left"><span id="S4.T1.2.7.4.2.1" class="ltx_text" style="font-size:90%;">Multiple/Specialised</span></td>
<td id="S4.T1.2.7.4.3" class="ltx_td ltx_align_left"><span id="S4.T1.2.7.4.3.1" class="ltx_text" style="font-size:90%;">✓ w.r.t. raw data</span></td>
</tr>
<tr id="S4.T1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T1.1.1.1.1" class="ltx_text" style="font-size:90%;">FL </span><math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">\rightarrow</annotation></semantics></math><span id="S4.T1.1.1.1.2" class="ltx_text" style="font-size:90%;"> LFT</span>
</th>
<td id="S4.T1.1.1.2" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.2.1" class="ltx_text" style="font-size:90%;">Multiple/Specialised</span></td>
<td id="S4.T1.1.1.3" class="ltx_td ltx_align_left"><span id="S4.T1.1.1.3.1" class="ltx_text" style="font-size:90%;">✓ w.r.t. raw data</span></td>
</tr>
<tr id="S4.T1.2.2" class="ltx_tr">
<th id="S4.T1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">
<span id="S4.T1.2.2.1.1" class="ltx_text" style="font-size:90%;">FL+HC </span><math id="S4.T1.2.2.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.T1.2.2.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><ci id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">\rightarrow</annotation></semantics></math><span id="S4.T1.2.2.1.2" class="ltx_text" style="font-size:90%;"> LFT</span>
</th>
<td id="S4.T1.2.2.2" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T1.2.2.2.1" class="ltx_text" style="font-size:90%;">Multiple/Specialised</span></td>
<td id="S4.T1.2.2.3" class="ltx_td ltx_align_left ltx_border_b"><span id="S4.T1.2.2.3.1" class="ltx_text" style="font-size:90%;">✓ w.r.t. raw data</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS4.p4" class="ltx_para">
<p id="S4.SS4.p4.1" class="ltx_p">Any FL system needs to offer benefits above and beyond what can be achieved in the localised learning setting as this is already a fully private approach. In this paper we investigate how individual learners can benefit from patterns in energy usage from other households in the population.</p>
</div>
<div id="S4.SS4.p5" class="ltx_para">
<p id="S4.SS4.p5.2" class="ltx_p">The goal of FL is the same as centralised learning - to learn a single, joint model that generalises well enough to provide accurate forecasts for all individual households. In FL however, the training data belonging to each household (or client in the parlance of FL) is not pooled as in centralised learning. Instead, the training data remains private to each local client. Whereas centralised learning seeks to optimise a global objective of the form: <math id="S4.SS4.p5.1.m1.1" class="ltx_Math" alttext="\min f(w)" display="inline"><semantics id="S4.SS4.p5.1.m1.1a"><mrow id="S4.SS4.p5.1.m1.1.2" xref="S4.SS4.p5.1.m1.1.2.cmml"><mrow id="S4.SS4.p5.1.m1.1.2.2" xref="S4.SS4.p5.1.m1.1.2.2.cmml"><mi id="S4.SS4.p5.1.m1.1.2.2.1" xref="S4.SS4.p5.1.m1.1.2.2.1.cmml">min</mi><mo lspace="0.167em" id="S4.SS4.p5.1.m1.1.2.2a" xref="S4.SS4.p5.1.m1.1.2.2.cmml">⁡</mo><mi id="S4.SS4.p5.1.m1.1.2.2.2" xref="S4.SS4.p5.1.m1.1.2.2.2.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS4.p5.1.m1.1.2.1" xref="S4.SS4.p5.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS4.p5.1.m1.1.2.3.2" xref="S4.SS4.p5.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS4.p5.1.m1.1.2.3.2.1" xref="S4.SS4.p5.1.m1.1.2.cmml">(</mo><mi id="S4.SS4.p5.1.m1.1.1" xref="S4.SS4.p5.1.m1.1.1.cmml">w</mi><mo stretchy="false" id="S4.SS4.p5.1.m1.1.2.3.2.2" xref="S4.SS4.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.1.m1.1b"><apply id="S4.SS4.p5.1.m1.1.2.cmml" xref="S4.SS4.p5.1.m1.1.2"><times id="S4.SS4.p5.1.m1.1.2.1.cmml" xref="S4.SS4.p5.1.m1.1.2.1"></times><apply id="S4.SS4.p5.1.m1.1.2.2.cmml" xref="S4.SS4.p5.1.m1.1.2.2"><min id="S4.SS4.p5.1.m1.1.2.2.1.cmml" xref="S4.SS4.p5.1.m1.1.2.2.1"></min><ci id="S4.SS4.p5.1.m1.1.2.2.2.cmml" xref="S4.SS4.p5.1.m1.1.2.2.2">𝑓</ci></apply><ci id="S4.SS4.p5.1.m1.1.1.cmml" xref="S4.SS4.p5.1.m1.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.1.m1.1c">\min f(w)</annotation></semantics></math>, FL optimises an objective as the finite sum of local objectives taking the form: <math id="S4.SS4.p5.2.m2.1" class="ltx_Math" alttext="\min\frac{1}{m}\sum^{m}_{i=1}f_{i}(w)" display="inline"><semantics id="S4.SS4.p5.2.m2.1a"><mrow id="S4.SS4.p5.2.m2.1.2" xref="S4.SS4.p5.2.m2.1.2.cmml"><mrow id="S4.SS4.p5.2.m2.1.2.2" xref="S4.SS4.p5.2.m2.1.2.2.cmml"><mi id="S4.SS4.p5.2.m2.1.2.2.1" xref="S4.SS4.p5.2.m2.1.2.2.1.cmml">min</mi><mo lspace="0.167em" id="S4.SS4.p5.2.m2.1.2.2a" xref="S4.SS4.p5.2.m2.1.2.2.cmml">⁡</mo><mfrac id="S4.SS4.p5.2.m2.1.2.2.2" xref="S4.SS4.p5.2.m2.1.2.2.2.cmml"><mn id="S4.SS4.p5.2.m2.1.2.2.2.2" xref="S4.SS4.p5.2.m2.1.2.2.2.2.cmml">1</mn><mi id="S4.SS4.p5.2.m2.1.2.2.2.3" xref="S4.SS4.p5.2.m2.1.2.2.2.3.cmml">m</mi></mfrac></mrow><mo lspace="0em" rspace="0em" id="S4.SS4.p5.2.m2.1.2.1" xref="S4.SS4.p5.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS4.p5.2.m2.1.2.3" xref="S4.SS4.p5.2.m2.1.2.3.cmml"><msubsup id="S4.SS4.p5.2.m2.1.2.3.1" xref="S4.SS4.p5.2.m2.1.2.3.1.cmml"><mo id="S4.SS4.p5.2.m2.1.2.3.1.2.2" xref="S4.SS4.p5.2.m2.1.2.3.1.2.2.cmml">∑</mo><mrow id="S4.SS4.p5.2.m2.1.2.3.1.3" xref="S4.SS4.p5.2.m2.1.2.3.1.3.cmml"><mi id="S4.SS4.p5.2.m2.1.2.3.1.3.2" xref="S4.SS4.p5.2.m2.1.2.3.1.3.2.cmml">i</mi><mo id="S4.SS4.p5.2.m2.1.2.3.1.3.1" xref="S4.SS4.p5.2.m2.1.2.3.1.3.1.cmml">=</mo><mn id="S4.SS4.p5.2.m2.1.2.3.1.3.3" xref="S4.SS4.p5.2.m2.1.2.3.1.3.3.cmml">1</mn></mrow><mi id="S4.SS4.p5.2.m2.1.2.3.1.2.3" xref="S4.SS4.p5.2.m2.1.2.3.1.2.3.cmml">m</mi></msubsup><mrow id="S4.SS4.p5.2.m2.1.2.3.2" xref="S4.SS4.p5.2.m2.1.2.3.2.cmml"><msub id="S4.SS4.p5.2.m2.1.2.3.2.2" xref="S4.SS4.p5.2.m2.1.2.3.2.2.cmml"><mi id="S4.SS4.p5.2.m2.1.2.3.2.2.2" xref="S4.SS4.p5.2.m2.1.2.3.2.2.2.cmml">f</mi><mi id="S4.SS4.p5.2.m2.1.2.3.2.2.3" xref="S4.SS4.p5.2.m2.1.2.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.p5.2.m2.1.2.3.2.1" xref="S4.SS4.p5.2.m2.1.2.3.2.1.cmml">​</mo><mrow id="S4.SS4.p5.2.m2.1.2.3.2.3.2" xref="S4.SS4.p5.2.m2.1.2.3.2.cmml"><mo stretchy="false" id="S4.SS4.p5.2.m2.1.2.3.2.3.2.1" xref="S4.SS4.p5.2.m2.1.2.3.2.cmml">(</mo><mi id="S4.SS4.p5.2.m2.1.1" xref="S4.SS4.p5.2.m2.1.1.cmml">w</mi><mo stretchy="false" id="S4.SS4.p5.2.m2.1.2.3.2.3.2.2" xref="S4.SS4.p5.2.m2.1.2.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.2.m2.1b"><apply id="S4.SS4.p5.2.m2.1.2.cmml" xref="S4.SS4.p5.2.m2.1.2"><times id="S4.SS4.p5.2.m2.1.2.1.cmml" xref="S4.SS4.p5.2.m2.1.2.1"></times><apply id="S4.SS4.p5.2.m2.1.2.2.cmml" xref="S4.SS4.p5.2.m2.1.2.2"><min id="S4.SS4.p5.2.m2.1.2.2.1.cmml" xref="S4.SS4.p5.2.m2.1.2.2.1"></min><apply id="S4.SS4.p5.2.m2.1.2.2.2.cmml" xref="S4.SS4.p5.2.m2.1.2.2.2"><divide id="S4.SS4.p5.2.m2.1.2.2.2.1.cmml" xref="S4.SS4.p5.2.m2.1.2.2.2"></divide><cn type="integer" id="S4.SS4.p5.2.m2.1.2.2.2.2.cmml" xref="S4.SS4.p5.2.m2.1.2.2.2.2">1</cn><ci id="S4.SS4.p5.2.m2.1.2.2.2.3.cmml" xref="S4.SS4.p5.2.m2.1.2.2.2.3">𝑚</ci></apply></apply><apply id="S4.SS4.p5.2.m2.1.2.3.cmml" xref="S4.SS4.p5.2.m2.1.2.3"><apply id="S4.SS4.p5.2.m2.1.2.3.1.cmml" xref="S4.SS4.p5.2.m2.1.2.3.1"><csymbol cd="ambiguous" id="S4.SS4.p5.2.m2.1.2.3.1.1.cmml" xref="S4.SS4.p5.2.m2.1.2.3.1">subscript</csymbol><apply id="S4.SS4.p5.2.m2.1.2.3.1.2.cmml" xref="S4.SS4.p5.2.m2.1.2.3.1"><csymbol cd="ambiguous" id="S4.SS4.p5.2.m2.1.2.3.1.2.1.cmml" xref="S4.SS4.p5.2.m2.1.2.3.1">superscript</csymbol><sum id="S4.SS4.p5.2.m2.1.2.3.1.2.2.cmml" xref="S4.SS4.p5.2.m2.1.2.3.1.2.2"></sum><ci id="S4.SS4.p5.2.m2.1.2.3.1.2.3.cmml" xref="S4.SS4.p5.2.m2.1.2.3.1.2.3">𝑚</ci></apply><apply id="S4.SS4.p5.2.m2.1.2.3.1.3.cmml" xref="S4.SS4.p5.2.m2.1.2.3.1.3"><eq id="S4.SS4.p5.2.m2.1.2.3.1.3.1.cmml" xref="S4.SS4.p5.2.m2.1.2.3.1.3.1"></eq><ci id="S4.SS4.p5.2.m2.1.2.3.1.3.2.cmml" xref="S4.SS4.p5.2.m2.1.2.3.1.3.2">𝑖</ci><cn type="integer" id="S4.SS4.p5.2.m2.1.2.3.1.3.3.cmml" xref="S4.SS4.p5.2.m2.1.2.3.1.3.3">1</cn></apply></apply><apply id="S4.SS4.p5.2.m2.1.2.3.2.cmml" xref="S4.SS4.p5.2.m2.1.2.3.2"><times id="S4.SS4.p5.2.m2.1.2.3.2.1.cmml" xref="S4.SS4.p5.2.m2.1.2.3.2.1"></times><apply id="S4.SS4.p5.2.m2.1.2.3.2.2.cmml" xref="S4.SS4.p5.2.m2.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS4.p5.2.m2.1.2.3.2.2.1.cmml" xref="S4.SS4.p5.2.m2.1.2.3.2.2">subscript</csymbol><ci id="S4.SS4.p5.2.m2.1.2.3.2.2.2.cmml" xref="S4.SS4.p5.2.m2.1.2.3.2.2.2">𝑓</ci><ci id="S4.SS4.p5.2.m2.1.2.3.2.2.3.cmml" xref="S4.SS4.p5.2.m2.1.2.3.2.2.3">𝑖</ci></apply><ci id="S4.SS4.p5.2.m2.1.1.cmml" xref="S4.SS4.p5.2.m2.1.1">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.2.m2.1c">\min\frac{1}{m}\sum^{m}_{i=1}f_{i}(w)</annotation></semantics></math>.</p>
</div>
<div id="S4.SS4.p6" class="ltx_para">
<p id="S4.SS4.p6.6" class="ltx_p">Training proceeds via communication rounds, beginning with an initialised model state <math id="S4.SS4.p6.1.m1.1" class="ltx_Math" alttext="w_{t}" display="inline"><semantics id="S4.SS4.p6.1.m1.1a"><msub id="S4.SS4.p6.1.m1.1.1" xref="S4.SS4.p6.1.m1.1.1.cmml"><mi id="S4.SS4.p6.1.m1.1.1.2" xref="S4.SS4.p6.1.m1.1.1.2.cmml">w</mi><mi id="S4.SS4.p6.1.m1.1.1.3" xref="S4.SS4.p6.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p6.1.m1.1b"><apply id="S4.SS4.p6.1.m1.1.1.cmml" xref="S4.SS4.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p6.1.m1.1.1.1.cmml" xref="S4.SS4.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p6.1.m1.1.1.2.cmml" xref="S4.SS4.p6.1.m1.1.1.2">𝑤</ci><ci id="S4.SS4.p6.1.m1.1.1.3.cmml" xref="S4.SS4.p6.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p6.1.m1.1c">w_{t}</annotation></semantics></math> that is transmitted to a small set of clients <math id="S4.SS4.p6.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS4.p6.2.m2.1a"><mi id="S4.SS4.p6.2.m2.1.1" xref="S4.SS4.p6.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p6.2.m2.1b"><ci id="S4.SS4.p6.2.m2.1.1.cmml" xref="S4.SS4.p6.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p6.2.m2.1c">K</annotation></semantics></math>. Each client <math id="S4.SS4.p6.3.m3.1" class="ltx_Math" alttext="k\in K" display="inline"><semantics id="S4.SS4.p6.3.m3.1a"><mrow id="S4.SS4.p6.3.m3.1.1" xref="S4.SS4.p6.3.m3.1.1.cmml"><mi id="S4.SS4.p6.3.m3.1.1.2" xref="S4.SS4.p6.3.m3.1.1.2.cmml">k</mi><mo id="S4.SS4.p6.3.m3.1.1.1" xref="S4.SS4.p6.3.m3.1.1.1.cmml">∈</mo><mi id="S4.SS4.p6.3.m3.1.1.3" xref="S4.SS4.p6.3.m3.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p6.3.m3.1b"><apply id="S4.SS4.p6.3.m3.1.1.cmml" xref="S4.SS4.p6.3.m3.1.1"><in id="S4.SS4.p6.3.m3.1.1.1.cmml" xref="S4.SS4.p6.3.m3.1.1.1"></in><ci id="S4.SS4.p6.3.m3.1.1.2.cmml" xref="S4.SS4.p6.3.m3.1.1.2">𝑘</ci><ci id="S4.SS4.p6.3.m3.1.1.3.cmml" xref="S4.SS4.p6.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p6.3.m3.1c">k\in K</annotation></semantics></math> computes an update <math id="S4.SS4.p6.4.m4.1" class="ltx_Math" alttext="w^{k}_{t+1}" display="inline"><semantics id="S4.SS4.p6.4.m4.1a"><msubsup id="S4.SS4.p6.4.m4.1.1" xref="S4.SS4.p6.4.m4.1.1.cmml"><mi id="S4.SS4.p6.4.m4.1.1.2.2" xref="S4.SS4.p6.4.m4.1.1.2.2.cmml">w</mi><mrow id="S4.SS4.p6.4.m4.1.1.3" xref="S4.SS4.p6.4.m4.1.1.3.cmml"><mi id="S4.SS4.p6.4.m4.1.1.3.2" xref="S4.SS4.p6.4.m4.1.1.3.2.cmml">t</mi><mo id="S4.SS4.p6.4.m4.1.1.3.1" xref="S4.SS4.p6.4.m4.1.1.3.1.cmml">+</mo><mn id="S4.SS4.p6.4.m4.1.1.3.3" xref="S4.SS4.p6.4.m4.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS4.p6.4.m4.1.1.2.3" xref="S4.SS4.p6.4.m4.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p6.4.m4.1b"><apply id="S4.SS4.p6.4.m4.1.1.cmml" xref="S4.SS4.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p6.4.m4.1.1.1.cmml" xref="S4.SS4.p6.4.m4.1.1">subscript</csymbol><apply id="S4.SS4.p6.4.m4.1.1.2.cmml" xref="S4.SS4.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p6.4.m4.1.1.2.1.cmml" xref="S4.SS4.p6.4.m4.1.1">superscript</csymbol><ci id="S4.SS4.p6.4.m4.1.1.2.2.cmml" xref="S4.SS4.p6.4.m4.1.1.2.2">𝑤</ci><ci id="S4.SS4.p6.4.m4.1.1.2.3.cmml" xref="S4.SS4.p6.4.m4.1.1.2.3">𝑘</ci></apply><apply id="S4.SS4.p6.4.m4.1.1.3.cmml" xref="S4.SS4.p6.4.m4.1.1.3"><plus id="S4.SS4.p6.4.m4.1.1.3.1.cmml" xref="S4.SS4.p6.4.m4.1.1.3.1"></plus><ci id="S4.SS4.p6.4.m4.1.1.3.2.cmml" xref="S4.SS4.p6.4.m4.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS4.p6.4.m4.1.1.3.3.cmml" xref="S4.SS4.p6.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p6.4.m4.1c">w^{k}_{t+1}</annotation></semantics></math> to the model state based on their dataset by optimising a local forecasting objective <math id="S4.SS4.p6.5.m5.1" class="ltx_Math" alttext="f_{k}(w_{t})" display="inline"><semantics id="S4.SS4.p6.5.m5.1a"><mrow id="S4.SS4.p6.5.m5.1.1" xref="S4.SS4.p6.5.m5.1.1.cmml"><msub id="S4.SS4.p6.5.m5.1.1.3" xref="S4.SS4.p6.5.m5.1.1.3.cmml"><mi id="S4.SS4.p6.5.m5.1.1.3.2" xref="S4.SS4.p6.5.m5.1.1.3.2.cmml">f</mi><mi id="S4.SS4.p6.5.m5.1.1.3.3" xref="S4.SS4.p6.5.m5.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.p6.5.m5.1.1.2" xref="S4.SS4.p6.5.m5.1.1.2.cmml">​</mo><mrow id="S4.SS4.p6.5.m5.1.1.1.1" xref="S4.SS4.p6.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS4.p6.5.m5.1.1.1.1.2" xref="S4.SS4.p6.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S4.SS4.p6.5.m5.1.1.1.1.1" xref="S4.SS4.p6.5.m5.1.1.1.1.1.cmml"><mi id="S4.SS4.p6.5.m5.1.1.1.1.1.2" xref="S4.SS4.p6.5.m5.1.1.1.1.1.2.cmml">w</mi><mi id="S4.SS4.p6.5.m5.1.1.1.1.1.3" xref="S4.SS4.p6.5.m5.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S4.SS4.p6.5.m5.1.1.1.1.3" xref="S4.SS4.p6.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p6.5.m5.1b"><apply id="S4.SS4.p6.5.m5.1.1.cmml" xref="S4.SS4.p6.5.m5.1.1"><times id="S4.SS4.p6.5.m5.1.1.2.cmml" xref="S4.SS4.p6.5.m5.1.1.2"></times><apply id="S4.SS4.p6.5.m5.1.1.3.cmml" xref="S4.SS4.p6.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p6.5.m5.1.1.3.1.cmml" xref="S4.SS4.p6.5.m5.1.1.3">subscript</csymbol><ci id="S4.SS4.p6.5.m5.1.1.3.2.cmml" xref="S4.SS4.p6.5.m5.1.1.3.2">𝑓</ci><ci id="S4.SS4.p6.5.m5.1.1.3.3.cmml" xref="S4.SS4.p6.5.m5.1.1.3.3">𝑘</ci></apply><apply id="S4.SS4.p6.5.m5.1.1.1.1.1.cmml" xref="S4.SS4.p6.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p6.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS4.p6.5.m5.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p6.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS4.p6.5.m5.1.1.1.1.1.2">𝑤</ci><ci id="S4.SS4.p6.5.m5.1.1.1.1.1.3.cmml" xref="S4.SS4.p6.5.m5.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p6.5.m5.1c">f_{k}(w_{t})</annotation></semantics></math>. In practice this usually involves training just a few epochs on each client. Each client then transmits their update to a centralised server that aggregates the updates into a new model <math id="S4.SS4.p6.6.m6.1" class="ltx_Math" alttext="w_{t+1}" display="inline"><semantics id="S4.SS4.p6.6.m6.1a"><msub id="S4.SS4.p6.6.m6.1.1" xref="S4.SS4.p6.6.m6.1.1.cmml"><mi id="S4.SS4.p6.6.m6.1.1.2" xref="S4.SS4.p6.6.m6.1.1.2.cmml">w</mi><mrow id="S4.SS4.p6.6.m6.1.1.3" xref="S4.SS4.p6.6.m6.1.1.3.cmml"><mi id="S4.SS4.p6.6.m6.1.1.3.2" xref="S4.SS4.p6.6.m6.1.1.3.2.cmml">t</mi><mo id="S4.SS4.p6.6.m6.1.1.3.1" xref="S4.SS4.p6.6.m6.1.1.3.1.cmml">+</mo><mn id="S4.SS4.p6.6.m6.1.1.3.3" xref="S4.SS4.p6.6.m6.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p6.6.m6.1b"><apply id="S4.SS4.p6.6.m6.1.1.cmml" xref="S4.SS4.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.p6.6.m6.1.1.1.cmml" xref="S4.SS4.p6.6.m6.1.1">subscript</csymbol><ci id="S4.SS4.p6.6.m6.1.1.2.cmml" xref="S4.SS4.p6.6.m6.1.1.2">𝑤</ci><apply id="S4.SS4.p6.6.m6.1.1.3.cmml" xref="S4.SS4.p6.6.m6.1.1.3"><plus id="S4.SS4.p6.6.m6.1.1.3.1.cmml" xref="S4.SS4.p6.6.m6.1.1.3.1"></plus><ci id="S4.SS4.p6.6.m6.1.1.3.2.cmml" xref="S4.SS4.p6.6.m6.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS4.p6.6.m6.1.1.3.3.cmml" xref="S4.SS4.p6.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p6.6.m6.1c">w_{t+1}</annotation></semantics></math>. For our experiments we apply federated averaging (FedAvg) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> as the FL algorithm for aggregating client updates. FedAvg aggregates incoming client model updates via a data weighted average such that:</p>
</div>
<div id="S4.SS4.p7" class="ltx_para">
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.1" class="ltx_Math" alttext="w_{t+1}=\sum^{K}_{k=1}\frac{n_{k}}{n}w^{k}_{t+1}" display="block"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><msub id="S4.E8.m1.1.1.2" xref="S4.E8.m1.1.1.2.cmml"><mi id="S4.E8.m1.1.1.2.2" xref="S4.E8.m1.1.1.2.2.cmml">w</mi><mrow id="S4.E8.m1.1.1.2.3" xref="S4.E8.m1.1.1.2.3.cmml"><mi id="S4.E8.m1.1.1.2.3.2" xref="S4.E8.m1.1.1.2.3.2.cmml">t</mi><mo id="S4.E8.m1.1.1.2.3.1" xref="S4.E8.m1.1.1.2.3.1.cmml">+</mo><mn id="S4.E8.m1.1.1.2.3.3" xref="S4.E8.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml">=</mo><mrow id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3.cmml"><munderover id="S4.E8.m1.1.1.3.1" xref="S4.E8.m1.1.1.3.1.cmml"><mo movablelimits="false" id="S4.E8.m1.1.1.3.1.2.2" xref="S4.E8.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E8.m1.1.1.3.1.3" xref="S4.E8.m1.1.1.3.1.3.cmml"><mi id="S4.E8.m1.1.1.3.1.3.2" xref="S4.E8.m1.1.1.3.1.3.2.cmml">k</mi><mo id="S4.E8.m1.1.1.3.1.3.1" xref="S4.E8.m1.1.1.3.1.3.1.cmml">=</mo><mn id="S4.E8.m1.1.1.3.1.3.3" xref="S4.E8.m1.1.1.3.1.3.3.cmml">1</mn></mrow><mi id="S4.E8.m1.1.1.3.1.2.3" xref="S4.E8.m1.1.1.3.1.2.3.cmml">K</mi></munderover><mrow id="S4.E8.m1.1.1.3.2" xref="S4.E8.m1.1.1.3.2.cmml"><mfrac id="S4.E8.m1.1.1.3.2.2" xref="S4.E8.m1.1.1.3.2.2.cmml"><msub id="S4.E8.m1.1.1.3.2.2.2" xref="S4.E8.m1.1.1.3.2.2.2.cmml"><mi id="S4.E8.m1.1.1.3.2.2.2.2" xref="S4.E8.m1.1.1.3.2.2.2.2.cmml">n</mi><mi id="S4.E8.m1.1.1.3.2.2.2.3" xref="S4.E8.m1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="S4.E8.m1.1.1.3.2.2.3" xref="S4.E8.m1.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.3.2.1" xref="S4.E8.m1.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E8.m1.1.1.3.2.3" xref="S4.E8.m1.1.1.3.2.3.cmml"><mi id="S4.E8.m1.1.1.3.2.3.2.2" xref="S4.E8.m1.1.1.3.2.3.2.2.cmml">w</mi><mrow id="S4.E8.m1.1.1.3.2.3.3" xref="S4.E8.m1.1.1.3.2.3.3.cmml"><mi id="S4.E8.m1.1.1.3.2.3.3.2" xref="S4.E8.m1.1.1.3.2.3.3.2.cmml">t</mi><mo id="S4.E8.m1.1.1.3.2.3.3.1" xref="S4.E8.m1.1.1.3.2.3.3.1.cmml">+</mo><mn id="S4.E8.m1.1.1.3.2.3.3.3" xref="S4.E8.m1.1.1.3.2.3.3.3.cmml">1</mn></mrow><mi id="S4.E8.m1.1.1.3.2.3.2.3" xref="S4.E8.m1.1.1.3.2.3.2.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><eq id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"></eq><apply id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.2">subscript</csymbol><ci id="S4.E8.m1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.2.2">𝑤</ci><apply id="S4.E8.m1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.2.3"><plus id="S4.E8.m1.1.1.2.3.1.cmml" xref="S4.E8.m1.1.1.2.3.1"></plus><ci id="S4.E8.m1.1.1.2.3.2.cmml" xref="S4.E8.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.E8.m1.1.1.2.3.3.cmml" xref="S4.E8.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E8.m1.1.1.3.cmml" xref="S4.E8.m1.1.1.3"><apply id="S4.E8.m1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.1.1.cmml" xref="S4.E8.m1.1.1.3.1">subscript</csymbol><apply id="S4.E8.m1.1.1.3.1.2.cmml" xref="S4.E8.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.1.2.1.cmml" xref="S4.E8.m1.1.1.3.1">superscript</csymbol><sum id="S4.E8.m1.1.1.3.1.2.2.cmml" xref="S4.E8.m1.1.1.3.1.2.2"></sum><ci id="S4.E8.m1.1.1.3.1.2.3.cmml" xref="S4.E8.m1.1.1.3.1.2.3">𝐾</ci></apply><apply id="S4.E8.m1.1.1.3.1.3.cmml" xref="S4.E8.m1.1.1.3.1.3"><eq id="S4.E8.m1.1.1.3.1.3.1.cmml" xref="S4.E8.m1.1.1.3.1.3.1"></eq><ci id="S4.E8.m1.1.1.3.1.3.2.cmml" xref="S4.E8.m1.1.1.3.1.3.2">𝑘</ci><cn type="integer" id="S4.E8.m1.1.1.3.1.3.3.cmml" xref="S4.E8.m1.1.1.3.1.3.3">1</cn></apply></apply><apply id="S4.E8.m1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.3.2"><times id="S4.E8.m1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.3.2.1"></times><apply id="S4.E8.m1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.3.2.2"><divide id="S4.E8.m1.1.1.3.2.2.1.cmml" xref="S4.E8.m1.1.1.3.2.2"></divide><apply id="S4.E8.m1.1.1.3.2.2.2.cmml" xref="S4.E8.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.2.2.2.1.cmml" xref="S4.E8.m1.1.1.3.2.2.2">subscript</csymbol><ci id="S4.E8.m1.1.1.3.2.2.2.2.cmml" xref="S4.E8.m1.1.1.3.2.2.2.2">𝑛</ci><ci id="S4.E8.m1.1.1.3.2.2.2.3.cmml" xref="S4.E8.m1.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="S4.E8.m1.1.1.3.2.2.3.cmml" xref="S4.E8.m1.1.1.3.2.2.3">𝑛</ci></apply><apply id="S4.E8.m1.1.1.3.2.3.cmml" xref="S4.E8.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.2.3.1.cmml" xref="S4.E8.m1.1.1.3.2.3">subscript</csymbol><apply id="S4.E8.m1.1.1.3.2.3.2.cmml" xref="S4.E8.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.2.3.2.1.cmml" xref="S4.E8.m1.1.1.3.2.3">superscript</csymbol><ci id="S4.E8.m1.1.1.3.2.3.2.2.cmml" xref="S4.E8.m1.1.1.3.2.3.2.2">𝑤</ci><ci id="S4.E8.m1.1.1.3.2.3.2.3.cmml" xref="S4.E8.m1.1.1.3.2.3.2.3">𝑘</ci></apply><apply id="S4.E8.m1.1.1.3.2.3.3.cmml" xref="S4.E8.m1.1.1.3.2.3.3"><plus id="S4.E8.m1.1.1.3.2.3.3.1.cmml" xref="S4.E8.m1.1.1.3.2.3.3.1"></plus><ci id="S4.E8.m1.1.1.3.2.3.3.2.cmml" xref="S4.E8.m1.1.1.3.2.3.3.2">𝑡</ci><cn type="integer" id="S4.E8.m1.1.1.3.2.3.3.3.cmml" xref="S4.E8.m1.1.1.3.2.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">w_{t+1}=\sum^{K}_{k=1}\frac{n_{k}}{n}w^{k}_{t+1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS4.p8" class="ltx_para">
<p id="S4.SS4.p8.4" class="ltx_p">Here, <math id="S4.SS4.p8.1.m1.1" class="ltx_Math" alttext="\frac{n_{k}}{n}" display="inline"><semantics id="S4.SS4.p8.1.m1.1a"><mfrac id="S4.SS4.p8.1.m1.1.1" xref="S4.SS4.p8.1.m1.1.1.cmml"><msub id="S4.SS4.p8.1.m1.1.1.2" xref="S4.SS4.p8.1.m1.1.1.2.cmml"><mi id="S4.SS4.p8.1.m1.1.1.2.2" xref="S4.SS4.p8.1.m1.1.1.2.2.cmml">n</mi><mi id="S4.SS4.p8.1.m1.1.1.2.3" xref="S4.SS4.p8.1.m1.1.1.2.3.cmml">k</mi></msub><mi id="S4.SS4.p8.1.m1.1.1.3" xref="S4.SS4.p8.1.m1.1.1.3.cmml">n</mi></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS4.p8.1.m1.1b"><apply id="S4.SS4.p8.1.m1.1.1.cmml" xref="S4.SS4.p8.1.m1.1.1"><divide id="S4.SS4.p8.1.m1.1.1.1.cmml" xref="S4.SS4.p8.1.m1.1.1"></divide><apply id="S4.SS4.p8.1.m1.1.1.2.cmml" xref="S4.SS4.p8.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p8.1.m1.1.1.2.1.cmml" xref="S4.SS4.p8.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS4.p8.1.m1.1.1.2.2.cmml" xref="S4.SS4.p8.1.m1.1.1.2.2">𝑛</ci><ci id="S4.SS4.p8.1.m1.1.1.2.3.cmml" xref="S4.SS4.p8.1.m1.1.1.2.3">𝑘</ci></apply><ci id="S4.SS4.p8.1.m1.1.1.3.cmml" xref="S4.SS4.p8.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p8.1.m1.1c">\frac{n_{k}}{n}</annotation></semantics></math> represents the number of samples available to client <math id="S4.SS4.p8.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS4.p8.2.m2.1a"><mi id="S4.SS4.p8.2.m2.1.1" xref="S4.SS4.p8.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p8.2.m2.1b"><ci id="S4.SS4.p8.2.m2.1.1.cmml" xref="S4.SS4.p8.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p8.2.m2.1c">k</annotation></semantics></math> compared to the total number of samples used for training in round <math id="S4.SS4.p8.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS4.p8.3.m3.1a"><mi id="S4.SS4.p8.3.m3.1.1" xref="S4.SS4.p8.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p8.3.m3.1b"><ci id="S4.SS4.p8.3.m3.1.1.cmml" xref="S4.SS4.p8.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p8.3.m3.1c">t</annotation></semantics></math>, thus determining the data-weighted contribution of client <math id="S4.SS4.p8.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS4.p8.4.m4.1a"><mi id="S4.SS4.p8.4.m4.1.1" xref="S4.SS4.p8.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p8.4.m4.1b"><ci id="S4.SS4.p8.4.m4.1.1.cmml" xref="S4.SS4.p8.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p8.4.m4.1c">k</annotation></semantics></math>. In the FL training scenario, model performance is affected by additional hyperparameters that we also test for:</p>
</div>
<div id="S4.SS4.p9" class="ltx_para">
<ul id="S4.I4" class="ltx_itemize">
<li id="S4.I4.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I4.i1.p1" class="ltx_para">
<p id="S4.I4.i1.p1.1" class="ltx_p">fraction of clients participating in each communication round: 0.1, 0.2 &amp; 0.3</p>
</div>
</li>
<li id="S4.I4.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I4.i2.p1" class="ltx_para">
<p id="S4.I4.i2.p1.1" class="ltx_p">Number of epochs of training on clients: 1, 3 &amp; 5</p>
</div>
</li>
</ul>
</div>
<div id="S4.SS4.p10" class="ltx_para">
<p id="S4.SS4.p10.1" class="ltx_p">All FL training runs are capped at 500 communication rounds with early stopping based on the best average validation set performance across all clients.</p>
</div>
<div id="S4.SS4.p11" class="ltx_para">
<p id="S4.SS4.p11.6" class="ltx_p">Models trained via FL have been shown to suffer under non-IID distributions. As we have explored, the individual household datasets exhibit differing data distributions due to the varied ways in which household occupants consume energy. As such, we investigate the use of a modification of FedAvg known as FL+HC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> (our previous work) that incorporates a clustering step into the FL protocol. In FL, the local objectives are expected to approximate the global objective, however if data among clients is distributed non-IID, this expectation over data available to client <math id="S4.SS4.p11.1.m1.1" class="ltx_Math" alttext="D_{k}" display="inline"><semantics id="S4.SS4.p11.1.m1.1a"><msub id="S4.SS4.p11.1.m1.1.1" xref="S4.SS4.p11.1.m1.1.1.cmml"><mi id="S4.SS4.p11.1.m1.1.1.2" xref="S4.SS4.p11.1.m1.1.1.2.cmml">D</mi><mi id="S4.SS4.p11.1.m1.1.1.3" xref="S4.SS4.p11.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p11.1.m1.1b"><apply id="S4.SS4.p11.1.m1.1.1.cmml" xref="S4.SS4.p11.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p11.1.m1.1.1.1.cmml" xref="S4.SS4.p11.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p11.1.m1.1.1.2.cmml" xref="S4.SS4.p11.1.m1.1.1.2">𝐷</ci><ci id="S4.SS4.p11.1.m1.1.1.3.cmml" xref="S4.SS4.p11.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p11.1.m1.1c">D_{k}</annotation></semantics></math> is not valid: <math id="S4.SS4.p11.2.m2.3" class="ltx_Math" alttext="\mathbb{E}_{D_{k}}[f_{k}(w)]\neq f(w)" display="inline"><semantics id="S4.SS4.p11.2.m2.3a"><mrow id="S4.SS4.p11.2.m2.3.3" xref="S4.SS4.p11.2.m2.3.3.cmml"><mrow id="S4.SS4.p11.2.m2.3.3.1" xref="S4.SS4.p11.2.m2.3.3.1.cmml"><msub id="S4.SS4.p11.2.m2.3.3.1.3" xref="S4.SS4.p11.2.m2.3.3.1.3.cmml"><mi id="S4.SS4.p11.2.m2.3.3.1.3.2" xref="S4.SS4.p11.2.m2.3.3.1.3.2.cmml">𝔼</mi><msub id="S4.SS4.p11.2.m2.3.3.1.3.3" xref="S4.SS4.p11.2.m2.3.3.1.3.3.cmml"><mi id="S4.SS4.p11.2.m2.3.3.1.3.3.2" xref="S4.SS4.p11.2.m2.3.3.1.3.3.2.cmml">D</mi><mi id="S4.SS4.p11.2.m2.3.3.1.3.3.3" xref="S4.SS4.p11.2.m2.3.3.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S4.SS4.p11.2.m2.3.3.1.2" xref="S4.SS4.p11.2.m2.3.3.1.2.cmml">​</mo><mrow id="S4.SS4.p11.2.m2.3.3.1.1.1" xref="S4.SS4.p11.2.m2.3.3.1.1.2.cmml"><mo stretchy="false" id="S4.SS4.p11.2.m2.3.3.1.1.1.2" xref="S4.SS4.p11.2.m2.3.3.1.1.2.1.cmml">[</mo><mrow id="S4.SS4.p11.2.m2.3.3.1.1.1.1" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.cmml"><msub id="S4.SS4.p11.2.m2.3.3.1.1.1.1.2" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.2.cmml"><mi id="S4.SS4.p11.2.m2.3.3.1.1.1.1.2.2" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.2.2.cmml">f</mi><mi id="S4.SS4.p11.2.m2.3.3.1.1.1.1.2.3" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.p11.2.m2.3.3.1.1.1.1.1" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.1.cmml">​</mo><mrow id="S4.SS4.p11.2.m2.3.3.1.1.1.1.3.2" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS4.p11.2.m2.3.3.1.1.1.1.3.2.1" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.cmml">(</mo><mi id="S4.SS4.p11.2.m2.1.1" xref="S4.SS4.p11.2.m2.1.1.cmml">w</mi><mo stretchy="false" id="S4.SS4.p11.2.m2.3.3.1.1.1.1.3.2.2" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS4.p11.2.m2.3.3.1.1.1.3" xref="S4.SS4.p11.2.m2.3.3.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.SS4.p11.2.m2.3.3.2" xref="S4.SS4.p11.2.m2.3.3.2.cmml">≠</mo><mrow id="S4.SS4.p11.2.m2.3.3.3" xref="S4.SS4.p11.2.m2.3.3.3.cmml"><mi id="S4.SS4.p11.2.m2.3.3.3.2" xref="S4.SS4.p11.2.m2.3.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p11.2.m2.3.3.3.1" xref="S4.SS4.p11.2.m2.3.3.3.1.cmml">​</mo><mrow id="S4.SS4.p11.2.m2.3.3.3.3.2" xref="S4.SS4.p11.2.m2.3.3.3.cmml"><mo stretchy="false" id="S4.SS4.p11.2.m2.3.3.3.3.2.1" xref="S4.SS4.p11.2.m2.3.3.3.cmml">(</mo><mi id="S4.SS4.p11.2.m2.2.2" xref="S4.SS4.p11.2.m2.2.2.cmml">w</mi><mo stretchy="false" id="S4.SS4.p11.2.m2.3.3.3.3.2.2" xref="S4.SS4.p11.2.m2.3.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p11.2.m2.3b"><apply id="S4.SS4.p11.2.m2.3.3.cmml" xref="S4.SS4.p11.2.m2.3.3"><neq id="S4.SS4.p11.2.m2.3.3.2.cmml" xref="S4.SS4.p11.2.m2.3.3.2"></neq><apply id="S4.SS4.p11.2.m2.3.3.1.cmml" xref="S4.SS4.p11.2.m2.3.3.1"><times id="S4.SS4.p11.2.m2.3.3.1.2.cmml" xref="S4.SS4.p11.2.m2.3.3.1.2"></times><apply id="S4.SS4.p11.2.m2.3.3.1.3.cmml" xref="S4.SS4.p11.2.m2.3.3.1.3"><csymbol cd="ambiguous" id="S4.SS4.p11.2.m2.3.3.1.3.1.cmml" xref="S4.SS4.p11.2.m2.3.3.1.3">subscript</csymbol><ci id="S4.SS4.p11.2.m2.3.3.1.3.2.cmml" xref="S4.SS4.p11.2.m2.3.3.1.3.2">𝔼</ci><apply id="S4.SS4.p11.2.m2.3.3.1.3.3.cmml" xref="S4.SS4.p11.2.m2.3.3.1.3.3"><csymbol cd="ambiguous" id="S4.SS4.p11.2.m2.3.3.1.3.3.1.cmml" xref="S4.SS4.p11.2.m2.3.3.1.3.3">subscript</csymbol><ci id="S4.SS4.p11.2.m2.3.3.1.3.3.2.cmml" xref="S4.SS4.p11.2.m2.3.3.1.3.3.2">𝐷</ci><ci id="S4.SS4.p11.2.m2.3.3.1.3.3.3.cmml" xref="S4.SS4.p11.2.m2.3.3.1.3.3.3">𝑘</ci></apply></apply><apply id="S4.SS4.p11.2.m2.3.3.1.1.2.cmml" xref="S4.SS4.p11.2.m2.3.3.1.1.1"><csymbol cd="latexml" id="S4.SS4.p11.2.m2.3.3.1.1.2.1.cmml" xref="S4.SS4.p11.2.m2.3.3.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS4.p11.2.m2.3.3.1.1.1.1.cmml" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1"><times id="S4.SS4.p11.2.m2.3.3.1.1.1.1.1.cmml" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.1"></times><apply id="S4.SS4.p11.2.m2.3.3.1.1.1.1.2.cmml" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p11.2.m2.3.3.1.1.1.1.2.1.cmml" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.2">subscript</csymbol><ci id="S4.SS4.p11.2.m2.3.3.1.1.1.1.2.2.cmml" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.2.2">𝑓</ci><ci id="S4.SS4.p11.2.m2.3.3.1.1.1.1.2.3.cmml" xref="S4.SS4.p11.2.m2.3.3.1.1.1.1.2.3">𝑘</ci></apply><ci id="S4.SS4.p11.2.m2.1.1.cmml" xref="S4.SS4.p11.2.m2.1.1">𝑤</ci></apply></apply></apply><apply id="S4.SS4.p11.2.m2.3.3.3.cmml" xref="S4.SS4.p11.2.m2.3.3.3"><times id="S4.SS4.p11.2.m2.3.3.3.1.cmml" xref="S4.SS4.p11.2.m2.3.3.3.1"></times><ci id="S4.SS4.p11.2.m2.3.3.3.2.cmml" xref="S4.SS4.p11.2.m2.3.3.3.2">𝑓</ci><ci id="S4.SS4.p11.2.m2.2.2.cmml" xref="S4.SS4.p11.2.m2.2.2">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p11.2.m2.3c">\mathbb{E}_{D_{k}}[f_{k}(w)]\neq f(w)</annotation></semantics></math>. In FL+HC, clients are assigned to a cluster <math id="S4.SS4.p11.3.m3.1" class="ltx_Math" alttext="c\in C" display="inline"><semantics id="S4.SS4.p11.3.m3.1a"><mrow id="S4.SS4.p11.3.m3.1.1" xref="S4.SS4.p11.3.m3.1.1.cmml"><mi id="S4.SS4.p11.3.m3.1.1.2" xref="S4.SS4.p11.3.m3.1.1.2.cmml">c</mi><mo id="S4.SS4.p11.3.m3.1.1.1" xref="S4.SS4.p11.3.m3.1.1.1.cmml">∈</mo><mi id="S4.SS4.p11.3.m3.1.1.3" xref="S4.SS4.p11.3.m3.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p11.3.m3.1b"><apply id="S4.SS4.p11.3.m3.1.1.cmml" xref="S4.SS4.p11.3.m3.1.1"><in id="S4.SS4.p11.3.m3.1.1.1.cmml" xref="S4.SS4.p11.3.m3.1.1.1"></in><ci id="S4.SS4.p11.3.m3.1.1.2.cmml" xref="S4.SS4.p11.3.m3.1.1.2">𝑐</ci><ci id="S4.SS4.p11.3.m3.1.1.3.cmml" xref="S4.SS4.p11.3.m3.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p11.3.m3.1c">c\in C</annotation></semantics></math>, where the goal is to train a specialised model <math id="S4.SS4.p11.4.m4.1" class="ltx_Math" alttext="f_{c}" display="inline"><semantics id="S4.SS4.p11.4.m4.1a"><msub id="S4.SS4.p11.4.m4.1.1" xref="S4.SS4.p11.4.m4.1.1.cmml"><mi id="S4.SS4.p11.4.m4.1.1.2" xref="S4.SS4.p11.4.m4.1.1.2.cmml">f</mi><mi id="S4.SS4.p11.4.m4.1.1.3" xref="S4.SS4.p11.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p11.4.m4.1b"><apply id="S4.SS4.p11.4.m4.1.1.cmml" xref="S4.SS4.p11.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p11.4.m4.1.1.1.cmml" xref="S4.SS4.p11.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p11.4.m4.1.1.2.cmml" xref="S4.SS4.p11.4.m4.1.1.2">𝑓</ci><ci id="S4.SS4.p11.4.m4.1.1.3.cmml" xref="S4.SS4.p11.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p11.4.m4.1c">f_{c}</annotation></semantics></math> tailored to clients that share a similar data distribution. We use client updates as a proxy for client similarity in order to preserve the privacy of the raw training data. A hierarchical clustering algorithm is run at communication round <math id="S4.SS4.p11.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS4.p11.5.m5.1a"><mi id="S4.SS4.p11.5.m5.1.1" xref="S4.SS4.p11.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p11.5.m5.1b"><ci id="S4.SS4.p11.5.m5.1.1.cmml" xref="S4.SS4.p11.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p11.5.m5.1c">n</annotation></semantics></math> taking as input the weight updates from all clients. Clients that produce similar updates are clustered together and further training via FL proceeds for each cluster in isolation. For a good clustering under FL+HC, the expectation of local objectives (clients) assigned to a cluster <math id="S4.SS4.p11.6.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS4.p11.6.m6.1a"><mi id="S4.SS4.p11.6.m6.1.1" xref="S4.SS4.p11.6.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p11.6.m6.1b"><ci id="S4.SS4.p11.6.m6.1.1.cmml" xref="S4.SS4.p11.6.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p11.6.m6.1c">c</annotation></semantics></math> approximates the cluster objective:</p>
</div>
<div id="S4.SS4.p12" class="ltx_para">
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.4" class="ltx_Math" alttext="\forall{c\in C},\mathbb{E}_{D_{k}}[f_{k}(w)]=f_{c}(w)\text{ where }k\in c" display="block"><semantics id="S4.E9.m1.4a"><mrow id="S4.E9.m1.4.4.2" xref="S4.E9.m1.4.4.3.cmml"><mrow id="S4.E9.m1.3.3.1.1" xref="S4.E9.m1.3.3.1.1.cmml"><mrow id="S4.E9.m1.3.3.1.1.2" xref="S4.E9.m1.3.3.1.1.2.cmml"><mo rspace="0.167em" id="S4.E9.m1.3.3.1.1.2.1" xref="S4.E9.m1.3.3.1.1.2.1.cmml">∀</mo><mi id="S4.E9.m1.3.3.1.1.2.2" xref="S4.E9.m1.3.3.1.1.2.2.cmml">c</mi></mrow><mo id="S4.E9.m1.3.3.1.1.1" xref="S4.E9.m1.3.3.1.1.1.cmml">∈</mo><mi id="S4.E9.m1.3.3.1.1.3" xref="S4.E9.m1.3.3.1.1.3.cmml">C</mi></mrow><mo id="S4.E9.m1.4.4.2.3" xref="S4.E9.m1.4.4.3a.cmml">,</mo><mrow id="S4.E9.m1.4.4.2.2" xref="S4.E9.m1.4.4.2.2.cmml"><mrow id="S4.E9.m1.4.4.2.2.1" xref="S4.E9.m1.4.4.2.2.1.cmml"><msub id="S4.E9.m1.4.4.2.2.1.3" xref="S4.E9.m1.4.4.2.2.1.3.cmml"><mi id="S4.E9.m1.4.4.2.2.1.3.2" xref="S4.E9.m1.4.4.2.2.1.3.2.cmml">𝔼</mi><msub id="S4.E9.m1.4.4.2.2.1.3.3" xref="S4.E9.m1.4.4.2.2.1.3.3.cmml"><mi id="S4.E9.m1.4.4.2.2.1.3.3.2" xref="S4.E9.m1.4.4.2.2.1.3.3.2.cmml">D</mi><mi id="S4.E9.m1.4.4.2.2.1.3.3.3" xref="S4.E9.m1.4.4.2.2.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.2.2.1.2" xref="S4.E9.m1.4.4.2.2.1.2.cmml">​</mo><mrow id="S4.E9.m1.4.4.2.2.1.1.1" xref="S4.E9.m1.4.4.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.E9.m1.4.4.2.2.1.1.1.2" xref="S4.E9.m1.4.4.2.2.1.1.2.1.cmml">[</mo><mrow id="S4.E9.m1.4.4.2.2.1.1.1.1" xref="S4.E9.m1.4.4.2.2.1.1.1.1.cmml"><msub id="S4.E9.m1.4.4.2.2.1.1.1.1.2" xref="S4.E9.m1.4.4.2.2.1.1.1.1.2.cmml"><mi id="S4.E9.m1.4.4.2.2.1.1.1.1.2.2" xref="S4.E9.m1.4.4.2.2.1.1.1.1.2.2.cmml">f</mi><mi id="S4.E9.m1.4.4.2.2.1.1.1.1.2.3" xref="S4.E9.m1.4.4.2.2.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.2.2.1.1.1.1.1" xref="S4.E9.m1.4.4.2.2.1.1.1.1.1.cmml">​</mo><mrow id="S4.E9.m1.4.4.2.2.1.1.1.1.3.2" xref="S4.E9.m1.4.4.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.4.4.2.2.1.1.1.1.3.2.1" xref="S4.E9.m1.4.4.2.2.1.1.1.1.cmml">(</mo><mi id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml">w</mi><mo stretchy="false" id="S4.E9.m1.4.4.2.2.1.1.1.1.3.2.2" xref="S4.E9.m1.4.4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E9.m1.4.4.2.2.1.1.1.3" xref="S4.E9.m1.4.4.2.2.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E9.m1.4.4.2.2.3" xref="S4.E9.m1.4.4.2.2.3.cmml">=</mo><mrow id="S4.E9.m1.4.4.2.2.4" xref="S4.E9.m1.4.4.2.2.4.cmml"><msub id="S4.E9.m1.4.4.2.2.4.2" xref="S4.E9.m1.4.4.2.2.4.2.cmml"><mi id="S4.E9.m1.4.4.2.2.4.2.2" xref="S4.E9.m1.4.4.2.2.4.2.2.cmml">f</mi><mi id="S4.E9.m1.4.4.2.2.4.2.3" xref="S4.E9.m1.4.4.2.2.4.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.2.2.4.1" xref="S4.E9.m1.4.4.2.2.4.1.cmml">​</mo><mrow id="S4.E9.m1.4.4.2.2.4.3.2" xref="S4.E9.m1.4.4.2.2.4.cmml"><mo stretchy="false" id="S4.E9.m1.4.4.2.2.4.3.2.1" xref="S4.E9.m1.4.4.2.2.4.cmml">(</mo><mi id="S4.E9.m1.2.2" xref="S4.E9.m1.2.2.cmml">w</mi><mo stretchy="false" id="S4.E9.m1.4.4.2.2.4.3.2.2" xref="S4.E9.m1.4.4.2.2.4.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.2.2.4.1a" xref="S4.E9.m1.4.4.2.2.4.1.cmml">​</mo><mtext id="S4.E9.m1.4.4.2.2.4.4" xref="S4.E9.m1.4.4.2.2.4.4a.cmml"> where </mtext><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.2.2.4.1b" xref="S4.E9.m1.4.4.2.2.4.1.cmml">​</mo><mi id="S4.E9.m1.4.4.2.2.4.5" xref="S4.E9.m1.4.4.2.2.4.5.cmml">k</mi></mrow><mo id="S4.E9.m1.4.4.2.2.5" xref="S4.E9.m1.4.4.2.2.5.cmml">∈</mo><mi id="S4.E9.m1.4.4.2.2.6" xref="S4.E9.m1.4.4.2.2.6.cmml">c</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.4b"><apply id="S4.E9.m1.4.4.3.cmml" xref="S4.E9.m1.4.4.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.3a.cmml" xref="S4.E9.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S4.E9.m1.3.3.1.1.cmml" xref="S4.E9.m1.3.3.1.1"><in id="S4.E9.m1.3.3.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1"></in><apply id="S4.E9.m1.3.3.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.2"><csymbol cd="latexml" id="S4.E9.m1.3.3.1.1.2.1.cmml" xref="S4.E9.m1.3.3.1.1.2.1">for-all</csymbol><ci id="S4.E9.m1.3.3.1.1.2.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2">𝑐</ci></apply><ci id="S4.E9.m1.3.3.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.3">𝐶</ci></apply><apply id="S4.E9.m1.4.4.2.2.cmml" xref="S4.E9.m1.4.4.2.2"><and id="S4.E9.m1.4.4.2.2a.cmml" xref="S4.E9.m1.4.4.2.2"></and><apply id="S4.E9.m1.4.4.2.2b.cmml" xref="S4.E9.m1.4.4.2.2"><eq id="S4.E9.m1.4.4.2.2.3.cmml" xref="S4.E9.m1.4.4.2.2.3"></eq><apply id="S4.E9.m1.4.4.2.2.1.cmml" xref="S4.E9.m1.4.4.2.2.1"><times id="S4.E9.m1.4.4.2.2.1.2.cmml" xref="S4.E9.m1.4.4.2.2.1.2"></times><apply id="S4.E9.m1.4.4.2.2.1.3.cmml" xref="S4.E9.m1.4.4.2.2.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.2.2.1.3.1.cmml" xref="S4.E9.m1.4.4.2.2.1.3">subscript</csymbol><ci id="S4.E9.m1.4.4.2.2.1.3.2.cmml" xref="S4.E9.m1.4.4.2.2.1.3.2">𝔼</ci><apply id="S4.E9.m1.4.4.2.2.1.3.3.cmml" xref="S4.E9.m1.4.4.2.2.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.2.2.1.3.3.1.cmml" xref="S4.E9.m1.4.4.2.2.1.3.3">subscript</csymbol><ci id="S4.E9.m1.4.4.2.2.1.3.3.2.cmml" xref="S4.E9.m1.4.4.2.2.1.3.3.2">𝐷</ci><ci id="S4.E9.m1.4.4.2.2.1.3.3.3.cmml" xref="S4.E9.m1.4.4.2.2.1.3.3.3">𝑘</ci></apply></apply><apply id="S4.E9.m1.4.4.2.2.1.1.2.cmml" xref="S4.E9.m1.4.4.2.2.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.4.4.2.2.1.1.2.1.cmml" xref="S4.E9.m1.4.4.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S4.E9.m1.4.4.2.2.1.1.1.1.cmml" xref="S4.E9.m1.4.4.2.2.1.1.1.1"><times id="S4.E9.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.2.2.1.1.1.1.1"></times><apply id="S4.E9.m1.4.4.2.2.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.2.2.1.1.1.1.2.1.cmml" xref="S4.E9.m1.4.4.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.E9.m1.4.4.2.2.1.1.1.1.2.2.cmml" xref="S4.E9.m1.4.4.2.2.1.1.1.1.2.2">𝑓</ci><ci id="S4.E9.m1.4.4.2.2.1.1.1.1.2.3.cmml" xref="S4.E9.m1.4.4.2.2.1.1.1.1.2.3">𝑘</ci></apply><ci id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1">𝑤</ci></apply></apply></apply><apply id="S4.E9.m1.4.4.2.2.4.cmml" xref="S4.E9.m1.4.4.2.2.4"><times id="S4.E9.m1.4.4.2.2.4.1.cmml" xref="S4.E9.m1.4.4.2.2.4.1"></times><apply id="S4.E9.m1.4.4.2.2.4.2.cmml" xref="S4.E9.m1.4.4.2.2.4.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.2.2.4.2.1.cmml" xref="S4.E9.m1.4.4.2.2.4.2">subscript</csymbol><ci id="S4.E9.m1.4.4.2.2.4.2.2.cmml" xref="S4.E9.m1.4.4.2.2.4.2.2">𝑓</ci><ci id="S4.E9.m1.4.4.2.2.4.2.3.cmml" xref="S4.E9.m1.4.4.2.2.4.2.3">𝑐</ci></apply><ci id="S4.E9.m1.2.2.cmml" xref="S4.E9.m1.2.2">𝑤</ci><ci id="S4.E9.m1.4.4.2.2.4.4a.cmml" xref="S4.E9.m1.4.4.2.2.4.4"><mtext id="S4.E9.m1.4.4.2.2.4.4.cmml" xref="S4.E9.m1.4.4.2.2.4.4"> where </mtext></ci><ci id="S4.E9.m1.4.4.2.2.4.5.cmml" xref="S4.E9.m1.4.4.2.2.4.5">𝑘</ci></apply></apply><apply id="S4.E9.m1.4.4.2.2c.cmml" xref="S4.E9.m1.4.4.2.2"><in id="S4.E9.m1.4.4.2.2.5.cmml" xref="S4.E9.m1.4.4.2.2.5"></in><share href="#S4.E9.m1.4.4.2.2.4.cmml" id="S4.E9.m1.4.4.2.2d.cmml" xref="S4.E9.m1.4.4.2.2"></share><ci id="S4.E9.m1.4.4.2.2.6.cmml" xref="S4.E9.m1.4.4.2.2.6">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.4c">\forall{c\in C},\mathbb{E}_{D_{k}}[f_{k}(w)]=f_{c}(w)\text{ where }k\in c</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS4.p13" class="ltx_para">
<p id="S4.SS4.p13.1" class="ltx_p">FL+HC introduces more hyperparameters to control the clustering process which we test for:</p>
</div>
<div id="S4.SS4.p14" class="ltx_para">
<ul id="S4.I5" class="ltx_itemize">
<li id="S4.I5.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I5.i1.p1" class="ltx_para">
<p id="S4.I5.i1.p1.1" class="ltx_p">clustering distance threshold: 0.8, 1.4 &amp; 2.0</p>
</div>
</li>
<li id="S4.I5.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I5.i2.p1" class="ltx_para">
<p id="S4.I5.i2.p1.1" class="ltx_p">hierarchical clustering linkage mechanism: ward, average, complete &amp; single</p>
</div>
</li>
<li id="S4.I5.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I5.i3.p1" class="ltx_para">
<p id="S4.I5.i3.p1.1" class="ltx_p">number of rounds of FL prior to clustering step <math id="S4.I5.i3.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.I5.i3.p1.1.m1.1a"><mi id="S4.I5.i3.p1.1.m1.1.1" xref="S4.I5.i3.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.I5.i3.p1.1.m1.1b"><ci id="S4.I5.i3.p1.1.m1.1.1.cmml" xref="S4.I5.i3.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I5.i3.p1.1.m1.1c">n</annotation></semantics></math>: 3, 5 &amp; 10</p>
</div>
</li>
</ul>
</div>
<div id="S4.SS4.p15" class="ltx_para">
<p id="S4.SS4.p15.1" class="ltx_p">To keep the number of permutations of experiments for the FL+HC scenario manageable, we fix the client fraction at 0.1, the number of epochs to 3 and exclusively use the Euclidean (L2) clustering distance metric. All FL+HC training runs are capped at 200 communication rounds with early stopping based on the best average validation set performance per cluster.</p>
</div>
<div id="S4.SS4.p16" class="ltx_para">
<p id="S4.SS4.p16.2" class="ltx_p">Finally, we also test scenarios where the models produced by FL and FL+HC are further fine-tuned on the local clients for a small number of epochs (a process known as personalisation). These local fine-tuning (LFT) scenarios are termed FL <math id="S4.SS4.p16.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.SS4.p16.1.m1.1a"><mo stretchy="false" id="S4.SS4.p16.1.m1.1.1" xref="S4.SS4.p16.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS4.p16.1.m1.1b"><ci id="S4.SS4.p16.1.m1.1.1.cmml" xref="S4.SS4.p16.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p16.1.m1.1c">\rightarrow</annotation></semantics></math> LFT and FL+HC <math id="S4.SS4.p16.2.m2.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S4.SS4.p16.2.m2.1a"><mo stretchy="false" id="S4.SS4.p16.2.m2.1.1" xref="S4.SS4.p16.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS4.p16.2.m2.1b"><ci id="S4.SS4.p16.2.m2.1.1.cmml" xref="S4.SS4.p16.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p16.2.m2.1c">\rightarrow</annotation></semantics></math> LFT. We test whether personalisation produces more accurate, highly specialised models for each household that also builds on the wisdom of the private data of other households. The fine-tuning step is limited to 25 epochs on all clients with early stopping based on the best validation set performance.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS5.5.1.1" class="ltx_text">IV-E</span> </span><span id="S4.SS5.6.2" class="ltx_text ltx_font_italic">Running the experiments</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">All experiments are run in the PyTorch deep learning framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> on the Google Cloud Computing (GCP) platform using a single NVIDIA Tesla K80 GPU attached to 30GB of memory, a 128GB SSD and 8 virtual CPUs on an Intel Xeon processor (n1-standard-8 GCP machine type). The distributed training scenarios are all simulated on a single machine.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Results &amp; Discussion</span>
</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.5.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.6.2" class="ltx_text ltx_font_italic">Forecasting performance</span>
</h3>

<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Forecasting error (RMSE) values for the 6 datasets and 6 training scenarios. ’Mean’ and ’Best’ columns show percentage difference compared to fully-private localised learning</figcaption>
<table id="S5.T2.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.2.3.1" class="ltx_tr">
<td id="S5.T2.2.3.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S5.T2.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="6"><span id="S5.T2.2.3.1.2.1" class="ltx_text" style="font-size:90%;">Dataset</span></th>
<th id="S5.T2.2.3.1.3" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<td id="S5.T2.2.3.1.4" class="ltx_td ltx_border_tt"></td>
</tr>
<tr id="S5.T2.2.4.2" class="ltx_tr">
<td id="S5.T2.2.4.2.1" class="ltx_td"></td>
<th id="S5.T2.2.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3"><span id="S5.T2.2.4.2.2.1" class="ltx_text" style="font-size:90%;">incl. weather</span></th>
<th id="S5.T2.2.4.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3"><span id="S5.T2.2.4.2.3.1" class="ltx_text" style="font-size:90%;">not incl. weather</span></th>
<th id="S5.T2.2.4.2.4" class="ltx_td ltx_th ltx_th_column"></th>
<td id="S5.T2.2.4.2.5" class="ltx_td"></td>
</tr>
<tr id="S5.T2.2.5.3" class="ltx_tr">
<th id="S5.T2.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="S5.T2.2.5.3.1.1" class="ltx_text" style="font-size:90%;">Training scenario</span></th>
<th id="S5.T2.2.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.2.5.3.2.1" class="ltx_text" style="font-size:90%;">6 steps</span></th>
<th id="S5.T2.2.5.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.2.5.3.3.1" class="ltx_text" style="font-size:90%;">12 steps</span></th>
<th id="S5.T2.2.5.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.2.5.3.4.1" class="ltx_text" style="font-size:90%;">24 steps</span></th>
<th id="S5.T2.2.5.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.2.5.3.5.1" class="ltx_text" style="font-size:90%;">6 steps</span></th>
<th id="S5.T2.2.5.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.2.5.3.6.1" class="ltx_text" style="font-size:90%;">12 steps</span></th>
<th id="S5.T2.2.5.3.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.2.5.3.7.1" class="ltx_text" style="font-size:90%;">24 steps</span></th>
<th id="S5.T2.2.5.3.8" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S5.T2.2.5.3.8.1" class="ltx_text" style="font-size:90%;">mean</span></th>
<th id="S5.T2.2.5.3.9" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S5.T2.2.5.3.9.1" class="ltx_text" style="font-size:90%;">best</span></th>
</tr>
<tr id="S5.T2.2.6.4" class="ltx_tr">
<td id="S5.T2.2.6.4.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T2.2.6.4.1.1" class="ltx_text" style="font-size:90%;">Centralised</span></td>
<td id="S5.T2.2.6.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.2.6.4.2.1" class="ltx_text" style="font-size:90%;">0.0210</span></td>
<td id="S5.T2.2.6.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.2.6.4.3.1" class="ltx_text" style="font-size:90%;">0.0207</span></td>
<td id="S5.T2.2.6.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.2.6.4.4.1" class="ltx_text" style="font-size:90%;">0.0198</span></td>
<td id="S5.T2.2.6.4.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.2.6.4.5.1" class="ltx_text" style="font-size:90%;">0.0210</span></td>
<td id="S5.T2.2.6.4.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.2.6.4.6.1" class="ltx_text" style="font-size:90%;">0.0208</span></td>
<td id="S5.T2.2.6.4.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.2.6.4.7.1" class="ltx_text" style="font-size:90%;">0.0198</span></td>
<td id="S5.T2.2.6.4.8" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T2.2.6.4.8.1" class="ltx_text" style="font-size:90%;">0.0205  (-4.8%)</span></td>
<td id="S5.T2.2.6.4.9" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T2.2.6.4.9.1" class="ltx_text" style="font-size:90%;">0.0198  (-8.0%)</span></td>
</tr>
<tr id="S5.T2.2.7.5" class="ltx_tr">
<td id="S5.T2.2.7.5.1" class="ltx_td ltx_align_left"><span id="S5.T2.2.7.5.1.1" class="ltx_text" style="font-size:90%;">Localised</span></td>
<td id="S5.T2.2.7.5.2" class="ltx_td ltx_align_center"><span id="S5.T2.2.7.5.2.1" class="ltx_text" style="font-size:90%;">0.0198</span></td>
<td id="S5.T2.2.7.5.3" class="ltx_td ltx_align_center"><span id="S5.T2.2.7.5.3.1" class="ltx_text" style="font-size:90%;">0.0183</span></td>
<td id="S5.T2.2.7.5.4" class="ltx_td ltx_align_center"><span id="S5.T2.2.7.5.4.1" class="ltx_text" style="font-size:90%;">0.0201</span></td>
<td id="S5.T2.2.7.5.5" class="ltx_td ltx_align_center"><span id="S5.T2.2.7.5.5.1" class="ltx_text" style="font-size:90%;">0.0201</span></td>
<td id="S5.T2.2.7.5.6" class="ltx_td ltx_align_center"><span id="S5.T2.2.7.5.6.1" class="ltx_text" style="font-size:90%;">0.0188</span></td>
<td id="S5.T2.2.7.5.7" class="ltx_td ltx_align_center"><span id="S5.T2.2.7.5.7.1" class="ltx_text" style="font-size:90%;">0.0202</span></td>
<td id="S5.T2.2.7.5.8" class="ltx_td ltx_align_left"><span id="S5.T2.2.7.5.8.1" class="ltx_text" style="font-size:90%;">0.0196  (—)</span></td>
<td id="S5.T2.2.7.5.9" class="ltx_td ltx_align_left"><span id="S5.T2.2.7.5.9.1" class="ltx_text" style="font-size:90%;">0.0183  (—)</span></td>
</tr>
<tr id="S5.T2.2.8.6" class="ltx_tr">
<td id="S5.T2.2.8.6.1" class="ltx_td ltx_align_left"><span id="S5.T2.2.8.6.1.1" class="ltx_text" style="font-size:90%;">FL</span></td>
<td id="S5.T2.2.8.6.2" class="ltx_td ltx_align_center"><span id="S5.T2.2.8.6.2.1" class="ltx_text" style="font-size:90%;">0.0219</span></td>
<td id="S5.T2.2.8.6.3" class="ltx_td ltx_align_center"><span id="S5.T2.2.8.6.3.1" class="ltx_text" style="font-size:90%;">0.0202</span></td>
<td id="S5.T2.2.8.6.4" class="ltx_td ltx_align_center"><span id="S5.T2.2.8.6.4.1" class="ltx_text" style="font-size:90%;">0.0207</span></td>
<td id="S5.T2.2.8.6.5" class="ltx_td ltx_align_center"><span id="S5.T2.2.8.6.5.1" class="ltx_text" style="font-size:90%;">0.0219</span></td>
<td id="S5.T2.2.8.6.6" class="ltx_td ltx_align_center"><span id="S5.T2.2.8.6.6.1" class="ltx_text" style="font-size:90%;">0.0205</span></td>
<td id="S5.T2.2.8.6.7" class="ltx_td ltx_align_center"><span id="S5.T2.2.8.6.7.1" class="ltx_text" style="font-size:90%;">0.0210</span></td>
<td id="S5.T2.2.8.6.8" class="ltx_td ltx_align_left"><span id="S5.T2.2.8.6.8.1" class="ltx_text" style="font-size:90%;">0.0210  (-7.6%)</span></td>
<td id="S5.T2.2.8.6.9" class="ltx_td ltx_align_left"><span id="S5.T2.2.8.6.9.1" class="ltx_text" style="font-size:90%;">0.0202  (-10.5%)</span></td>
</tr>
<tr id="S5.T2.2.9.7" class="ltx_tr">
<td id="S5.T2.2.9.7.1" class="ltx_td ltx_align_left"><span id="S5.T2.2.9.7.1.1" class="ltx_text" style="font-size:90%;">FL+HC</span></td>
<td id="S5.T2.2.9.7.2" class="ltx_td ltx_align_center"><span id="S5.T2.2.9.7.2.1" class="ltx_text" style="font-size:90%;">0.0209</span></td>
<td id="S5.T2.2.9.7.3" class="ltx_td ltx_align_center"><span id="S5.T2.2.9.7.3.1" class="ltx_text" style="font-size:90%;">0.0189</span></td>
<td id="S5.T2.2.9.7.4" class="ltx_td ltx_align_center"><span id="S5.T2.2.9.7.4.1" class="ltx_text" style="font-size:90%;">0.0208</span></td>
<td id="S5.T2.2.9.7.5" class="ltx_td ltx_align_center"><span id="S5.T2.2.9.7.5.1" class="ltx_text" style="font-size:90%;">0.0214</span></td>
<td id="S5.T2.2.9.7.6" class="ltx_td ltx_align_center"><span id="S5.T2.2.9.7.6.1" class="ltx_text" style="font-size:90%;">0.0198</span></td>
<td id="S5.T2.2.9.7.7" class="ltx_td ltx_align_center"><span id="S5.T2.2.9.7.7.1" class="ltx_text" style="font-size:90%;">0.0210</span></td>
<td id="S5.T2.2.9.7.8" class="ltx_td ltx_align_left"><span id="S5.T2.2.9.7.8.1" class="ltx_text" style="font-size:90%;">0.0205  (-4.7%)</span></td>
<td id="S5.T2.2.9.7.9" class="ltx_td ltx_align_left"><span id="S5.T2.2.9.7.9.1" class="ltx_text" style="font-size:90%;">0.0189  (-3.5%)</span></td>
</tr>
<tr id="S5.T2.1.1" class="ltx_tr">
<td id="S5.T2.1.1.1" class="ltx_td ltx_align_left">
<span id="S5.T2.1.1.1.1" class="ltx_text" style="font-size:90%;">FL </span><math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><ci id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\rightarrow</annotation></semantics></math><span id="S5.T2.1.1.1.2" class="ltx_text" style="font-size:90%;"> LFT</span>
</td>
<td id="S5.T2.1.1.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.2.1" class="ltx_text" style="font-size:90%;">0.0194</span></td>
<td id="S5.T2.1.1.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.3.1" class="ltx_text" style="font-size:90%;">0.0177</span></td>
<td id="S5.T2.1.1.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.4.1" class="ltx_text" style="font-size:90%;">0.0192</span></td>
<td id="S5.T2.1.1.5" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.5.1" class="ltx_text" style="font-size:90%;">0.0195</span></td>
<td id="S5.T2.1.1.6" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.0174</span></td>
<td id="S5.T2.1.1.7" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.7.1" class="ltx_text" style="font-size:90%;">0.0192</span></td>
<td id="S5.T2.1.1.8" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.8.1" class="ltx_text" style="font-size:90%;">0.0187  (+4.3%)</span></td>
<td id="S5.T2.1.1.9" class="ltx_td ltx_align_left"><span id="S5.T2.1.1.9.1" class="ltx_text" style="font-size:90%;">0.0174  (+4.9%)</span></td>
</tr>
<tr id="S5.T2.2.2" class="ltx_tr">
<td id="S5.T2.2.2.1" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S5.T2.2.2.1.1" class="ltx_text" style="font-size:90%;">FL+HC </span><math id="S5.T2.2.2.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.T2.2.2.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S5.T2.2.2.1.m1.1.1" xref="S5.T2.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.1.m1.1b"><ci id="S5.T2.2.2.1.m1.1.1.cmml" xref="S5.T2.2.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.1.m1.1c">\rightarrow</annotation></semantics></math><span id="S5.T2.2.2.1.2" class="ltx_text" style="font-size:90%;"> LFT</span>
</td>
<td id="S5.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.2.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.0193</span></td>
<td id="S5.T2.2.2.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.2.2.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.0176</span></td>
<td id="S5.T2.2.2.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.2.2.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.0192</span></td>
<td id="S5.T2.2.2.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.2.2.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.0193</span></td>
<td id="S5.T2.2.2.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.2.2.6.1" class="ltx_text" style="font-size:90%;">0.0175</span></td>
<td id="S5.T2.2.2.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.2.2.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.0192</span></td>
<td id="S5.T2.2.2.8" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T2.2.2.8.1" class="ltx_text" style="font-size:90%;">0.0187  (+4.5%)</span></td>
<td id="S5.T2.2.2.9" class="ltx_td ltx_align_left ltx_border_bb"><span id="S5.T2.2.2.9.1" class="ltx_text" style="font-size:90%;">0.0175  (+4.5%)</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.6" class="ltx_p">To understand how the different training approaches perform compared to one another, we report the RMSE achieved on the test set for each of the 6 datasets, <math id="S5.SS1.p1.1.m1.2" class="ltx_Math" alttext="\bm{S}_{K=6,\text{+weather}}" display="inline"><semantics id="S5.SS1.p1.1.m1.2a"><msub id="S5.SS1.p1.1.m1.2.3" xref="S5.SS1.p1.1.m1.2.3.cmml"><mi id="S5.SS1.p1.1.m1.2.3.2" xref="S5.SS1.p1.1.m1.2.3.2.cmml">𝑺</mi><mrow id="S5.SS1.p1.1.m1.2.2.2" xref="S5.SS1.p1.1.m1.2.2.2.cmml"><mi id="S5.SS1.p1.1.m1.2.2.2.4" xref="S5.SS1.p1.1.m1.2.2.2.4.cmml">K</mi><mo id="S5.SS1.p1.1.m1.2.2.2.3" xref="S5.SS1.p1.1.m1.2.2.2.3.cmml">=</mo><mrow id="S5.SS1.p1.1.m1.2.2.2.5.2" xref="S5.SS1.p1.1.m1.2.2.2.5.1.cmml"><mn id="S5.SS1.p1.1.m1.1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.1.cmml">6</mn><mo id="S5.SS1.p1.1.m1.2.2.2.5.2.1" xref="S5.SS1.p1.1.m1.2.2.2.5.1.cmml">,</mo><mtext id="S5.SS1.p1.1.m1.2.2.2.2" xref="S5.SS1.p1.1.m1.2.2.2.2a.cmml">+weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.2b"><apply id="S5.SS1.p1.1.m1.2.3.cmml" xref="S5.SS1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.2.3.1.cmml" xref="S5.SS1.p1.1.m1.2.3">subscript</csymbol><ci id="S5.SS1.p1.1.m1.2.3.2.cmml" xref="S5.SS1.p1.1.m1.2.3.2">𝑺</ci><apply id="S5.SS1.p1.1.m1.2.2.2.cmml" xref="S5.SS1.p1.1.m1.2.2.2"><eq id="S5.SS1.p1.1.m1.2.2.2.3.cmml" xref="S5.SS1.p1.1.m1.2.2.2.3"></eq><ci id="S5.SS1.p1.1.m1.2.2.2.4.cmml" xref="S5.SS1.p1.1.m1.2.2.2.4">𝐾</ci><list id="S5.SS1.p1.1.m1.2.2.2.5.1.cmml" xref="S5.SS1.p1.1.m1.2.2.2.5.2"><cn type="integer" id="S5.SS1.p1.1.m1.1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1.1">6</cn><ci id="S5.SS1.p1.1.m1.2.2.2.2a.cmml" xref="S5.SS1.p1.1.m1.2.2.2.2"><mtext mathsize="70%" id="S5.SS1.p1.1.m1.2.2.2.2.cmml" xref="S5.SS1.p1.1.m1.2.2.2.2">+weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.2c">\bm{S}_{K=6,\text{+weather}}</annotation></semantics></math>, <math id="S5.SS1.p1.2.m2.2" class="ltx_Math" alttext="\bm{S}_{K=12,\text{+weather}}" display="inline"><semantics id="S5.SS1.p1.2.m2.2a"><msub id="S5.SS1.p1.2.m2.2.3" xref="S5.SS1.p1.2.m2.2.3.cmml"><mi id="S5.SS1.p1.2.m2.2.3.2" xref="S5.SS1.p1.2.m2.2.3.2.cmml">𝑺</mi><mrow id="S5.SS1.p1.2.m2.2.2.2" xref="S5.SS1.p1.2.m2.2.2.2.cmml"><mi id="S5.SS1.p1.2.m2.2.2.2.4" xref="S5.SS1.p1.2.m2.2.2.2.4.cmml">K</mi><mo id="S5.SS1.p1.2.m2.2.2.2.3" xref="S5.SS1.p1.2.m2.2.2.2.3.cmml">=</mo><mrow id="S5.SS1.p1.2.m2.2.2.2.5.2" xref="S5.SS1.p1.2.m2.2.2.2.5.1.cmml"><mn id="S5.SS1.p1.2.m2.1.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.1.cmml">12</mn><mo id="S5.SS1.p1.2.m2.2.2.2.5.2.1" xref="S5.SS1.p1.2.m2.2.2.2.5.1.cmml">,</mo><mtext id="S5.SS1.p1.2.m2.2.2.2.2" xref="S5.SS1.p1.2.m2.2.2.2.2a.cmml">+weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.2b"><apply id="S5.SS1.p1.2.m2.2.3.cmml" xref="S5.SS1.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S5.SS1.p1.2.m2.2.3.1.cmml" xref="S5.SS1.p1.2.m2.2.3">subscript</csymbol><ci id="S5.SS1.p1.2.m2.2.3.2.cmml" xref="S5.SS1.p1.2.m2.2.3.2">𝑺</ci><apply id="S5.SS1.p1.2.m2.2.2.2.cmml" xref="S5.SS1.p1.2.m2.2.2.2"><eq id="S5.SS1.p1.2.m2.2.2.2.3.cmml" xref="S5.SS1.p1.2.m2.2.2.2.3"></eq><ci id="S5.SS1.p1.2.m2.2.2.2.4.cmml" xref="S5.SS1.p1.2.m2.2.2.2.4">𝐾</ci><list id="S5.SS1.p1.2.m2.2.2.2.5.1.cmml" xref="S5.SS1.p1.2.m2.2.2.2.5.2"><cn type="integer" id="S5.SS1.p1.2.m2.1.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1.1">12</cn><ci id="S5.SS1.p1.2.m2.2.2.2.2a.cmml" xref="S5.SS1.p1.2.m2.2.2.2.2"><mtext mathsize="70%" id="S5.SS1.p1.2.m2.2.2.2.2.cmml" xref="S5.SS1.p1.2.m2.2.2.2.2">+weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.2c">\bm{S}_{K=12,\text{+weather}}</annotation></semantics></math>, <math id="S5.SS1.p1.3.m3.2" class="ltx_Math" alttext="\bm{S}_{K=24,\text{+weather}}" display="inline"><semantics id="S5.SS1.p1.3.m3.2a"><msub id="S5.SS1.p1.3.m3.2.3" xref="S5.SS1.p1.3.m3.2.3.cmml"><mi id="S5.SS1.p1.3.m3.2.3.2" xref="S5.SS1.p1.3.m3.2.3.2.cmml">𝑺</mi><mrow id="S5.SS1.p1.3.m3.2.2.2" xref="S5.SS1.p1.3.m3.2.2.2.cmml"><mi id="S5.SS1.p1.3.m3.2.2.2.4" xref="S5.SS1.p1.3.m3.2.2.2.4.cmml">K</mi><mo id="S5.SS1.p1.3.m3.2.2.2.3" xref="S5.SS1.p1.3.m3.2.2.2.3.cmml">=</mo><mrow id="S5.SS1.p1.3.m3.2.2.2.5.2" xref="S5.SS1.p1.3.m3.2.2.2.5.1.cmml"><mn id="S5.SS1.p1.3.m3.1.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.1.cmml">24</mn><mo id="S5.SS1.p1.3.m3.2.2.2.5.2.1" xref="S5.SS1.p1.3.m3.2.2.2.5.1.cmml">,</mo><mtext id="S5.SS1.p1.3.m3.2.2.2.2" xref="S5.SS1.p1.3.m3.2.2.2.2a.cmml">+weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.2b"><apply id="S5.SS1.p1.3.m3.2.3.cmml" xref="S5.SS1.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.2.3.1.cmml" xref="S5.SS1.p1.3.m3.2.3">subscript</csymbol><ci id="S5.SS1.p1.3.m3.2.3.2.cmml" xref="S5.SS1.p1.3.m3.2.3.2">𝑺</ci><apply id="S5.SS1.p1.3.m3.2.2.2.cmml" xref="S5.SS1.p1.3.m3.2.2.2"><eq id="S5.SS1.p1.3.m3.2.2.2.3.cmml" xref="S5.SS1.p1.3.m3.2.2.2.3"></eq><ci id="S5.SS1.p1.3.m3.2.2.2.4.cmml" xref="S5.SS1.p1.3.m3.2.2.2.4">𝐾</ci><list id="S5.SS1.p1.3.m3.2.2.2.5.1.cmml" xref="S5.SS1.p1.3.m3.2.2.2.5.2"><cn type="integer" id="S5.SS1.p1.3.m3.1.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1.1">24</cn><ci id="S5.SS1.p1.3.m3.2.2.2.2a.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2"><mtext mathsize="70%" id="S5.SS1.p1.3.m3.2.2.2.2.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2">+weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.2c">\bm{S}_{K=24,\text{+weather}}</annotation></semantics></math>, <math id="S5.SS1.p1.4.m4.2" class="ltx_Math" alttext="\bm{S}_{K=6,\text{-weather}}" display="inline"><semantics id="S5.SS1.p1.4.m4.2a"><msub id="S5.SS1.p1.4.m4.2.3" xref="S5.SS1.p1.4.m4.2.3.cmml"><mi id="S5.SS1.p1.4.m4.2.3.2" xref="S5.SS1.p1.4.m4.2.3.2.cmml">𝑺</mi><mrow id="S5.SS1.p1.4.m4.2.2.2" xref="S5.SS1.p1.4.m4.2.2.2.cmml"><mi id="S5.SS1.p1.4.m4.2.2.2.4" xref="S5.SS1.p1.4.m4.2.2.2.4.cmml">K</mi><mo id="S5.SS1.p1.4.m4.2.2.2.3" xref="S5.SS1.p1.4.m4.2.2.2.3.cmml">=</mo><mrow id="S5.SS1.p1.4.m4.2.2.2.5.2" xref="S5.SS1.p1.4.m4.2.2.2.5.1.cmml"><mn id="S5.SS1.p1.4.m4.1.1.1.1" xref="S5.SS1.p1.4.m4.1.1.1.1.cmml">6</mn><mo id="S5.SS1.p1.4.m4.2.2.2.5.2.1" xref="S5.SS1.p1.4.m4.2.2.2.5.1.cmml">,</mo><mtext id="S5.SS1.p1.4.m4.2.2.2.2" xref="S5.SS1.p1.4.m4.2.2.2.2a.cmml">-weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.2b"><apply id="S5.SS1.p1.4.m4.2.3.cmml" xref="S5.SS1.p1.4.m4.2.3"><csymbol cd="ambiguous" id="S5.SS1.p1.4.m4.2.3.1.cmml" xref="S5.SS1.p1.4.m4.2.3">subscript</csymbol><ci id="S5.SS1.p1.4.m4.2.3.2.cmml" xref="S5.SS1.p1.4.m4.2.3.2">𝑺</ci><apply id="S5.SS1.p1.4.m4.2.2.2.cmml" xref="S5.SS1.p1.4.m4.2.2.2"><eq id="S5.SS1.p1.4.m4.2.2.2.3.cmml" xref="S5.SS1.p1.4.m4.2.2.2.3"></eq><ci id="S5.SS1.p1.4.m4.2.2.2.4.cmml" xref="S5.SS1.p1.4.m4.2.2.2.4">𝐾</ci><list id="S5.SS1.p1.4.m4.2.2.2.5.1.cmml" xref="S5.SS1.p1.4.m4.2.2.2.5.2"><cn type="integer" id="S5.SS1.p1.4.m4.1.1.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1.1.1">6</cn><ci id="S5.SS1.p1.4.m4.2.2.2.2a.cmml" xref="S5.SS1.p1.4.m4.2.2.2.2"><mtext mathsize="70%" id="S5.SS1.p1.4.m4.2.2.2.2.cmml" xref="S5.SS1.p1.4.m4.2.2.2.2">-weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.2c">\bm{S}_{K=6,\text{-weather}}</annotation></semantics></math>, <math id="S5.SS1.p1.5.m5.2" class="ltx_Math" alttext="\bm{S}_{K=12,\text{-weather}}" display="inline"><semantics id="S5.SS1.p1.5.m5.2a"><msub id="S5.SS1.p1.5.m5.2.3" xref="S5.SS1.p1.5.m5.2.3.cmml"><mi id="S5.SS1.p1.5.m5.2.3.2" xref="S5.SS1.p1.5.m5.2.3.2.cmml">𝑺</mi><mrow id="S5.SS1.p1.5.m5.2.2.2" xref="S5.SS1.p1.5.m5.2.2.2.cmml"><mi id="S5.SS1.p1.5.m5.2.2.2.4" xref="S5.SS1.p1.5.m5.2.2.2.4.cmml">K</mi><mo id="S5.SS1.p1.5.m5.2.2.2.3" xref="S5.SS1.p1.5.m5.2.2.2.3.cmml">=</mo><mrow id="S5.SS1.p1.5.m5.2.2.2.5.2" xref="S5.SS1.p1.5.m5.2.2.2.5.1.cmml"><mn id="S5.SS1.p1.5.m5.1.1.1.1" xref="S5.SS1.p1.5.m5.1.1.1.1.cmml">12</mn><mo id="S5.SS1.p1.5.m5.2.2.2.5.2.1" xref="S5.SS1.p1.5.m5.2.2.2.5.1.cmml">,</mo><mtext id="S5.SS1.p1.5.m5.2.2.2.2" xref="S5.SS1.p1.5.m5.2.2.2.2a.cmml">-weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.2b"><apply id="S5.SS1.p1.5.m5.2.3.cmml" xref="S5.SS1.p1.5.m5.2.3"><csymbol cd="ambiguous" id="S5.SS1.p1.5.m5.2.3.1.cmml" xref="S5.SS1.p1.5.m5.2.3">subscript</csymbol><ci id="S5.SS1.p1.5.m5.2.3.2.cmml" xref="S5.SS1.p1.5.m5.2.3.2">𝑺</ci><apply id="S5.SS1.p1.5.m5.2.2.2.cmml" xref="S5.SS1.p1.5.m5.2.2.2"><eq id="S5.SS1.p1.5.m5.2.2.2.3.cmml" xref="S5.SS1.p1.5.m5.2.2.2.3"></eq><ci id="S5.SS1.p1.5.m5.2.2.2.4.cmml" xref="S5.SS1.p1.5.m5.2.2.2.4">𝐾</ci><list id="S5.SS1.p1.5.m5.2.2.2.5.1.cmml" xref="S5.SS1.p1.5.m5.2.2.2.5.2"><cn type="integer" id="S5.SS1.p1.5.m5.1.1.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1.1.1">12</cn><ci id="S5.SS1.p1.5.m5.2.2.2.2a.cmml" xref="S5.SS1.p1.5.m5.2.2.2.2"><mtext mathsize="70%" id="S5.SS1.p1.5.m5.2.2.2.2.cmml" xref="S5.SS1.p1.5.m5.2.2.2.2">-weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.2c">\bm{S}_{K=12,\text{-weather}}</annotation></semantics></math> and <math id="S5.SS1.p1.6.m6.2" class="ltx_Math" alttext="\bm{S}_{K=24,\text{-weather}}" display="inline"><semantics id="S5.SS1.p1.6.m6.2a"><msub id="S5.SS1.p1.6.m6.2.3" xref="S5.SS1.p1.6.m6.2.3.cmml"><mi id="S5.SS1.p1.6.m6.2.3.2" xref="S5.SS1.p1.6.m6.2.3.2.cmml">𝑺</mi><mrow id="S5.SS1.p1.6.m6.2.2.2" xref="S5.SS1.p1.6.m6.2.2.2.cmml"><mi id="S5.SS1.p1.6.m6.2.2.2.4" xref="S5.SS1.p1.6.m6.2.2.2.4.cmml">K</mi><mo id="S5.SS1.p1.6.m6.2.2.2.3" xref="S5.SS1.p1.6.m6.2.2.2.3.cmml">=</mo><mrow id="S5.SS1.p1.6.m6.2.2.2.5.2" xref="S5.SS1.p1.6.m6.2.2.2.5.1.cmml"><mn id="S5.SS1.p1.6.m6.1.1.1.1" xref="S5.SS1.p1.6.m6.1.1.1.1.cmml">24</mn><mo id="S5.SS1.p1.6.m6.2.2.2.5.2.1" xref="S5.SS1.p1.6.m6.2.2.2.5.1.cmml">,</mo><mtext id="S5.SS1.p1.6.m6.2.2.2.2" xref="S5.SS1.p1.6.m6.2.2.2.2a.cmml">-weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m6.2b"><apply id="S5.SS1.p1.6.m6.2.3.cmml" xref="S5.SS1.p1.6.m6.2.3"><csymbol cd="ambiguous" id="S5.SS1.p1.6.m6.2.3.1.cmml" xref="S5.SS1.p1.6.m6.2.3">subscript</csymbol><ci id="S5.SS1.p1.6.m6.2.3.2.cmml" xref="S5.SS1.p1.6.m6.2.3.2">𝑺</ci><apply id="S5.SS1.p1.6.m6.2.2.2.cmml" xref="S5.SS1.p1.6.m6.2.2.2"><eq id="S5.SS1.p1.6.m6.2.2.2.3.cmml" xref="S5.SS1.p1.6.m6.2.2.2.3"></eq><ci id="S5.SS1.p1.6.m6.2.2.2.4.cmml" xref="S5.SS1.p1.6.m6.2.2.2.4">𝐾</ci><list id="S5.SS1.p1.6.m6.2.2.2.5.1.cmml" xref="S5.SS1.p1.6.m6.2.2.2.5.2"><cn type="integer" id="S5.SS1.p1.6.m6.1.1.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1.1.1">24</cn><ci id="S5.SS1.p1.6.m6.2.2.2.2a.cmml" xref="S5.SS1.p1.6.m6.2.2.2.2"><mtext mathsize="70%" id="S5.SS1.p1.6.m6.2.2.2.2.cmml" xref="S5.SS1.p1.6.m6.2.2.2.2">-weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m6.2c">\bm{S}_{K=24,\text{-weather}}</annotation></semantics></math>. The RMSE reported is an average over all clients (in distributed approaches) or over all sequences (in the centralised approach).
For experiments that involve tuning hyperparameters (namely those that involve FL), we report the test set RMSE for the best performing model based on the lowest error on the validation set. We also report the mean RMSE and lowest RMSE over all datasets for each training approach along with a percentage difference to compare with the fully private localised approach. Model performance results are detailed in <a href="#S5.T2" title="TABLE II ‣ V-A Forecasting performance ‣ V Results &amp; Discussion ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table II</span></a>.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">In the centralised approach, the training procedure has access to all sequences pooled from across the individual household datasets. Therefore model performance might be expected to be relatively high compared to the other approaches where there is much less data to learn from. Conversely, we show that average model performance in the centralised approach is actually 4.8% worse than the localised approach and the best centralised model is 8.0% worse than the best localised model. This is somewhat surprising given that the localised models only have access to <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="1/100" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mrow id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml"><mn id="S5.SS1.p2.1.m1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.2.cmml">1</mn><mo id="S5.SS1.p2.1.m1.1.1.1" xref="S5.SS1.p2.1.m1.1.1.1.cmml">/</mo><mn id="S5.SS1.p2.1.m1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><apply id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1"><divide id="S5.SS1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1"></divide><cn type="integer" id="S5.SS1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1.2">1</cn><cn type="integer" id="S5.SS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">1/100</annotation></semantics></math> the amount of data. This implies that the centralised models (and possibly single, joint models in general) struggle to capture individual household behaviours in energy usage and/or suffer from trying to optimise for competing objectives. Larger models might allow for learning more individual behaviours but as data has to be gathered into a single location, the privacy risk to energy consumers is by far the highest in this training approach. The 24-step sequence (1 whole of day of prior readings) provides the model with the most information with which to make a prediction, resulting in the lowest RMSE in the centralised approach (followed by the 12-step, then 6-step).</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">In the localised learning approach, a model for each household is trained in isolation using only the data available to that household. Model performance is exceptionally good in this approach and the simple LSTM architecture is sufficient to learn more nuanced energy demand behaviours unique to each household. This approach represents a fully private setting in that nothing is shared between households. Datasets formed around 12-step sequences result in models that significantly outperform 6-step and 24-step sequence datasets in this approach. We see a similar pattern for the remaining training approaches, suggesting that a 12-hour time window is optimal for local learners to most accurately predict future energy demand.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.1" class="ltx_p">In the FL approach, only a fraction of clients are selected for each round of training (and each client trains on its local data set in isolation for a small number of epochs). Additionally a single, joint model is being co-trained by these selected clients when model updates are aggregated. As such, we see that the RMSE for FL models suffers in the same way as centralised models when we compare to the localised approach. Additionally, as FL has been shown to perform sub-optimally in cases where the training data is non-IID as is the case with the individual household datasets, the RMSE suffers even more so than in the centralised learning approach. Compared with localised learning the average model performance in the FL approach was 7.6% worse with the best FL model significantly worse (10.5% higher RMSE) than the best localised learning model.</p>
</div>
<div id="S5.SS1.p5" class="ltx_para">
<p id="S5.SS1.p5.1" class="ltx_p">The FL+HC approach produces specialised models for a number of clusters of clients that can more specifically tailor forecasts for groups of households that provide similar model updates (a proxy for similar underlying energy demand distributions across clients). As such, the average RMSE of clients is no longer tied to a single, joint model as in the FL training approach, but rather to a specialised cluster model. In the average case across the 6 datasets, FL+HC produces models 4.7% worse than the localised approach - comparable to centralised learning. However, the best model trained with FL+HC significantly outperforms models trained with FL or centralised learning but remains 3.5% worse than localised learning. Although the FL approaches (FL and FL+HC) do occasionally produce a slightly better model than the centralised training scenario, the mean RMSE across all datasets shows that on average FL performance is degraded compared to centralised learning, consistent with the findings of most previous FL literature.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Computational efficiency (measured in millions of samples required to train top performing models) for the 6 datasets and 6 training scenarios. ’Mean’ and ’Best’ columns show savings in computation compared to fully-private localised learning.</figcaption>
<table id="S5.T3.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.2.3.1" class="ltx_tr">
<td id="S5.T3.2.3.1.1" class="ltx_td ltx_border_tt"></td>
<td id="S5.T3.2.3.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="6"><span id="S5.T3.2.3.1.2.1" class="ltx_text" style="font-size:90%;">Dataset</span></td>
<td id="S5.T3.2.3.1.3" class="ltx_td ltx_border_tt"></td>
<td id="S5.T3.2.3.1.4" class="ltx_td ltx_border_tt"></td>
<td id="S5.T3.2.3.1.5" class="ltx_td ltx_border_tt"></td>
<td id="S5.T3.2.3.1.6" class="ltx_td ltx_border_tt"></td>
</tr>
<tr id="S5.T3.2.4.2" class="ltx_tr">
<td id="S5.T3.2.4.2.1" class="ltx_td"></td>
<td id="S5.T3.2.4.2.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3"><span id="S5.T3.2.4.2.2.1" class="ltx_text" style="font-size:90%;">incl. weather</span></td>
<td id="S5.T3.2.4.2.3" class="ltx_td ltx_align_center ltx_border_t" colspan="3"><span id="S5.T3.2.4.2.3.1" class="ltx_text" style="font-size:90%;">not incl. weather</span></td>
<td id="S5.T3.2.4.2.4" class="ltx_td"></td>
<td id="S5.T3.2.4.2.5" class="ltx_td"></td>
<td id="S5.T3.2.4.2.6" class="ltx_td"></td>
<td id="S5.T3.2.4.2.7" class="ltx_td"></td>
</tr>
<tr id="S5.T3.2.5.3" class="ltx_tr">
<td id="S5.T3.2.5.3.1" class="ltx_td ltx_align_left"><span id="S5.T3.2.5.3.1.1" class="ltx_text" style="font-size:90%;">Training scenario</span></td>
<td id="S5.T3.2.5.3.2" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.5.3.2.1" class="ltx_text" style="font-size:90%;">6 steps</span></td>
<td id="S5.T3.2.5.3.3" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.5.3.3.1" class="ltx_text" style="font-size:90%;">12 steps</span></td>
<td id="S5.T3.2.5.3.4" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.5.3.4.1" class="ltx_text" style="font-size:90%;">24 steps</span></td>
<td id="S5.T3.2.5.3.5" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.5.3.5.1" class="ltx_text" style="font-size:90%;">6 steps</span></td>
<td id="S5.T3.2.5.3.6" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.5.3.6.1" class="ltx_text" style="font-size:90%;">12 steps</span></td>
<td id="S5.T3.2.5.3.7" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.5.3.7.1" class="ltx_text" style="font-size:90%;">24 steps</span></td>
<td id="S5.T3.2.5.3.8" class="ltx_td ltx_align_center" colspan="2"><span id="S5.T3.2.5.3.8.1" class="ltx_text" style="font-size:90%;">mean</span></td>
<td id="S5.T3.2.5.3.9" class="ltx_td ltx_align_center" colspan="2"><span id="S5.T3.2.5.3.9.1" class="ltx_text" style="font-size:90%;">best*</span></td>
</tr>
<tr id="S5.T3.2.6.4" class="ltx_tr">
<td id="S5.T3.2.6.4.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T3.2.6.4.1.1" class="ltx_text" style="font-size:90%;">Centralised</span></td>
<td id="S5.T3.2.6.4.2" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.6.4.2.1" class="ltx_text" style="font-size:90%;">78.9</span></td>
<td id="S5.T3.2.6.4.3" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.6.4.3.1" class="ltx_text" style="font-size:90%;">19.5</span></td>
<td id="S5.T3.2.6.4.4" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.6.4.4.1" class="ltx_text" style="font-size:90%;">21.2</span></td>
<td id="S5.T3.2.6.4.5" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.6.4.5.1" class="ltx_text" style="font-size:90%;">15.6</span></td>
<td id="S5.T3.2.6.4.6" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.6.4.6.1" class="ltx_text" style="font-size:90%;">26.6</span></td>
<td id="S5.T3.2.6.4.7" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.6.4.7.1" class="ltx_text" style="font-size:90%;">57.7</span></td>
<td id="S5.T3.2.6.4.8" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.6.4.8.1" class="ltx_text" style="font-size:90%;">36.6</span></td>
<td id="S5.T3.2.6.4.9" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T3.2.6.4.9.1" class="ltx_text" style="font-size:90%;">(1.9x)</span></td>
<td id="S5.T3.2.6.4.10" class="ltx_td ltx_align_right ltx_border_t"><span id="S5.T3.2.6.4.10.1" class="ltx_text" style="font-size:90%;">57.7</span></td>
<td id="S5.T3.2.6.4.11" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T3.2.6.4.11.1" class="ltx_text" style="font-size:90%;">(1.4x)</span></td>
</tr>
<tr id="S5.T3.2.7.5" class="ltx_tr">
<td id="S5.T3.2.7.5.1" class="ltx_td ltx_align_left"><span id="S5.T3.2.7.5.1.1" class="ltx_text" style="font-size:90%;">Localised</span></td>
<td id="S5.T3.2.7.5.2" class="ltx_td ltx_align_right"><span id="S5.T3.2.7.5.2.1" class="ltx_text" style="font-size:90%;">71.5</span></td>
<td id="S5.T3.2.7.5.3" class="ltx_td ltx_align_right"><span id="S5.T3.2.7.5.3.1" class="ltx_text" style="font-size:90%;">79.5</span></td>
<td id="S5.T3.2.7.5.4" class="ltx_td ltx_align_right"><span id="S5.T3.2.7.5.4.1" class="ltx_text" style="font-size:90%;">52.7</span></td>
<td id="S5.T3.2.7.5.5" class="ltx_td ltx_align_right"><span id="S5.T3.2.7.5.5.1" class="ltx_text" style="font-size:90%;">94.9</span></td>
<td id="S5.T3.2.7.5.6" class="ltx_td ltx_align_right"><span id="S5.T3.2.7.5.6.1" class="ltx_text" style="font-size:90%;">67.1</span></td>
<td id="S5.T3.2.7.5.7" class="ltx_td ltx_align_right"><span id="S5.T3.2.7.5.7.1" class="ltx_text" style="font-size:90%;">60.5</span></td>
<td id="S5.T3.2.7.5.8" class="ltx_td ltx_align_right"><span id="S5.T3.2.7.5.8.1" class="ltx_text" style="font-size:90%;">71.0</span></td>
<td id="S5.T3.2.7.5.9" class="ltx_td ltx_align_left"><span id="S5.T3.2.7.5.9.1" class="ltx_text" style="font-size:90%;">(—)</span></td>
<td id="S5.T3.2.7.5.10" class="ltx_td ltx_align_right"><span id="S5.T3.2.7.5.10.1" class="ltx_text" style="font-size:90%;">79.5</span></td>
<td id="S5.T3.2.7.5.11" class="ltx_td ltx_align_left"><span id="S5.T3.2.7.5.11.1" class="ltx_text" style="font-size:90%;">(—)</span></td>
</tr>
<tr id="S5.T3.2.8.6" class="ltx_tr">
<td id="S5.T3.2.8.6.1" class="ltx_td ltx_align_left"><span id="S5.T3.2.8.6.1.1" class="ltx_text" style="font-size:90%;">FL</span></td>
<td id="S5.T3.2.8.6.2" class="ltx_td ltx_align_right"><span id="S5.T3.2.8.6.2.1" class="ltx_text" style="font-size:90%;">266.3</span></td>
<td id="S5.T3.2.8.6.3" class="ltx_td ltx_align_right"><span id="S5.T3.2.8.6.3.1" class="ltx_text" style="font-size:90%;">290.7</span></td>
<td id="S5.T3.2.8.6.4" class="ltx_td ltx_align_right"><span id="S5.T3.2.8.6.4.1" class="ltx_text" style="font-size:90%;">384.4</span></td>
<td id="S5.T3.2.8.6.5" class="ltx_td ltx_align_right"><span id="S5.T3.2.8.6.5.1" class="ltx_text" style="font-size:90%;">238.1</span></td>
<td id="S5.T3.2.8.6.6" class="ltx_td ltx_align_right"><span id="S5.T3.2.8.6.6.1" class="ltx_text" style="font-size:90%;">424.3</span></td>
<td id="S5.T3.2.8.6.7" class="ltx_td ltx_align_right"><span id="S5.T3.2.8.6.7.1" class="ltx_text" style="font-size:90%;">455.3</span></td>
<td id="S5.T3.2.8.6.8" class="ltx_td ltx_align_right"><span id="S5.T3.2.8.6.8.1" class="ltx_text" style="font-size:90%;">343.2</span></td>
<td id="S5.T3.2.8.6.9" class="ltx_td ltx_align_left"><span id="S5.T3.2.8.6.9.1" class="ltx_text" style="font-size:90%;">(0.2x)</span></td>
<td id="S5.T3.2.8.6.10" class="ltx_td ltx_align_right"><span id="S5.T3.2.8.6.10.1" class="ltx_text" style="font-size:90%;">290.7</span></td>
<td id="S5.T3.2.8.6.11" class="ltx_td ltx_align_left"><span id="S5.T3.2.8.6.11.1" class="ltx_text" style="font-size:90%;">(0.3x)</span></td>
</tr>
<tr id="S5.T3.2.9.7" class="ltx_tr">
<td id="S5.T3.2.9.7.1" class="ltx_td ltx_align_left"><span id="S5.T3.2.9.7.1.1" class="ltx_text" style="font-size:90%;">FL+HC</span></td>
<td id="S5.T3.2.9.7.2" class="ltx_td ltx_align_right"><span id="S5.T3.2.9.7.2.1" class="ltx_text" style="font-size:90%;">6.3</span></td>
<td id="S5.T3.2.9.7.3" class="ltx_td ltx_align_right"><span id="S5.T3.2.9.7.3.1" class="ltx_text" style="font-size:90%;">6.1</span></td>
<td id="S5.T3.2.9.7.4" class="ltx_td ltx_align_right"><span id="S5.T3.2.9.7.4.1" class="ltx_text" style="font-size:90%;">6.8</span></td>
<td id="S5.T3.2.9.7.5" class="ltx_td ltx_align_right"><span id="S5.T3.2.9.7.5.1" class="ltx_text" style="font-size:90%;">7.3</span></td>
<td id="S5.T3.2.9.7.6" class="ltx_td ltx_align_right"><span id="S5.T3.2.9.7.6.1" class="ltx_text" style="font-size:90%;">7.0</span></td>
<td id="S5.T3.2.9.7.7" class="ltx_td ltx_align_right"><span id="S5.T3.2.9.7.7.1" class="ltx_text" style="font-size:90%;">0.1</span></td>
<td id="S5.T3.2.9.7.8" class="ltx_td ltx_align_right"><span id="S5.T3.2.9.7.8.1" class="ltx_text" style="font-size:90%;">5.6</span></td>
<td id="S5.T3.2.9.7.9" class="ltx_td ltx_align_left"><span id="S5.T3.2.9.7.9.1" class="ltx_text" style="font-size:90%;">(12.7x)</span></td>
<td id="S5.T3.2.9.7.10" class="ltx_td ltx_align_right"><span id="S5.T3.2.9.7.10.1" class="ltx_text" style="font-size:90%;">6.1</span></td>
<td id="S5.T3.2.9.7.11" class="ltx_td ltx_align_left"><span id="S5.T3.2.9.7.11.1" class="ltx_text" style="font-size:90%;">(13.1x)</span></td>
</tr>
<tr id="S5.T3.1.1" class="ltx_tr">
<td id="S5.T3.1.1.1" class="ltx_td ltx_align_left">
<span id="S5.T3.1.1.1.1" class="ltx_text" style="font-size:90%;">FL </span><math id="S5.T3.1.1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.T3.1.1.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.1c">\rightarrow</annotation></semantics></math><span id="S5.T3.1.1.1.2" class="ltx_text" style="font-size:90%;"> LFT</span>
</td>
<td id="S5.T3.1.1.2" class="ltx_td ltx_align_right"><span id="S5.T3.1.1.2.1" class="ltx_text" style="font-size:90%;">268.4</span></td>
<td id="S5.T3.1.1.3" class="ltx_td ltx_align_right"><span id="S5.T3.1.1.3.1" class="ltx_text" style="font-size:90%;">292.5</span></td>
<td id="S5.T3.1.1.4" class="ltx_td ltx_align_right"><span id="S5.T3.1.1.4.1" class="ltx_text" style="font-size:90%;">388.0</span></td>
<td id="S5.T3.1.1.5" class="ltx_td ltx_align_right"><span id="S5.T3.1.1.5.1" class="ltx_text" style="font-size:90%;">239.2</span></td>
<td id="S5.T3.1.1.6" class="ltx_td ltx_align_right"><span id="S5.T3.1.1.6.1" class="ltx_text" style="font-size:90%;">429.6</span></td>
<td id="S5.T3.1.1.7" class="ltx_td ltx_align_right"><span id="S5.T3.1.1.7.1" class="ltx_text" style="font-size:90%;">458.2</span></td>
<td id="S5.T3.1.1.8" class="ltx_td ltx_align_right"><span id="S5.T3.1.1.8.1" class="ltx_text" style="font-size:90%;">346.0</span></td>
<td id="S5.T3.1.1.9" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.9.1" class="ltx_text" style="font-size:90%;">(0.2x)</span></td>
<td id="S5.T3.1.1.10" class="ltx_td ltx_align_right"><span id="S5.T3.1.1.10.1" class="ltx_text" style="font-size:90%;">429.6</span></td>
<td id="S5.T3.1.1.11" class="ltx_td ltx_align_left"><span id="S5.T3.1.1.11.1" class="ltx_text" style="font-size:90%;">(0.2x)</span></td>
</tr>
<tr id="S5.T3.2.2" class="ltx_tr">
<td id="S5.T3.2.2.1" class="ltx_td ltx_align_left">
<span id="S5.T3.2.2.1.1" class="ltx_text" style="font-size:90%;">FL+HC </span><math id="S5.T3.2.2.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.T3.2.2.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S5.T3.2.2.1.m1.1.1" xref="S5.T3.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.1.m1.1b"><ci id="S5.T3.2.2.1.m1.1.1.cmml" xref="S5.T3.2.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.1.m1.1c">\rightarrow</annotation></semantics></math><span id="S5.T3.2.2.1.2" class="ltx_text" style="font-size:90%;"> LFT</span>
</td>
<td id="S5.T3.2.2.2" class="ltx_td ltx_align_right"><span id="S5.T3.2.2.2.1" class="ltx_text" style="font-size:90%;">7.2</span></td>
<td id="S5.T3.2.2.3" class="ltx_td ltx_align_right"><span id="S5.T3.2.2.3.1" class="ltx_text" style="font-size:90%;">6.9</span></td>
<td id="S5.T3.2.2.4" class="ltx_td ltx_align_right"><span id="S5.T3.2.2.4.1" class="ltx_text" style="font-size:90%;">7.9</span></td>
<td id="S5.T3.2.2.5" class="ltx_td ltx_align_right"><span id="S5.T3.2.2.5.1" class="ltx_text" style="font-size:90%;">8.0</span></td>
<td id="S5.T3.2.2.6" class="ltx_td ltx_align_right"><span id="S5.T3.2.2.6.1" class="ltx_text" style="font-size:90%;">8.7</span></td>
<td id="S5.T3.2.2.7" class="ltx_td ltx_align_right"><span id="S5.T3.2.2.7.1" class="ltx_text" style="font-size:90%;">1.2</span></td>
<td id="S5.T3.2.2.8" class="ltx_td ltx_align_right"><span id="S5.T3.2.2.8.1" class="ltx_text" style="font-size:90%;">6.7</span></td>
<td id="S5.T3.2.2.9" class="ltx_td ltx_align_left"><span id="S5.T3.2.2.9.1" class="ltx_text" style="font-size:90%;">(10.7x)</span></td>
<td id="S5.T3.2.2.10" class="ltx_td ltx_align_right"><span id="S5.T3.2.2.10.1" class="ltx_text" style="font-size:90%;">8.7</span></td>
<td id="S5.T3.2.2.11" class="ltx_td ltx_align_left"><span id="S5.T3.2.2.11.1" class="ltx_text" style="font-size:90%;">(9.1x)</span></td>
</tr>
<tr id="S5.T3.2.10.8" class="ltx_tr">
<td id="S5.T3.2.10.8.1" class="ltx_td ltx_align_left ltx_border_tt" colspan="11">
<span id="S5.T3.2.10.8.1.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:426.8pt;">
<span id="S5.T3.2.10.8.1.1.1" class="ltx_p"><span id="S5.T3.2.10.8.1.1.1.1" class="ltx_text" style="font-size:80%;">* the best savings are calculated by comparing the best performing model for each training scenario to the best performing localised model, as reported in <a href="#S5.T2" title="TABLE II ‣ V-A Forecasting performance ‣ V Results &amp; Discussion ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table II</span></a>.</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.p6" class="ltx_para">
<p id="S5.SS1.p6.3" class="ltx_p">Although the base models trained with FL and FL+HC show a higher RMSE than those trained with fully private localised learning, we now show how the situation can be improved if we treat FL or FL+HC as a pre-training task to be followed by further fine-tuning on the local clients in isolation. In the FL <math id="S5.SS1.p6.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.SS1.p6.1.m1.1a"><mo stretchy="false" id="S5.SS1.p6.1.m1.1.1" xref="S5.SS1.p6.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.1.m1.1b"><ci id="S5.SS1.p6.1.m1.1.1.cmml" xref="S5.SS1.p6.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.1.m1.1c">\rightarrow</annotation></semantics></math> LFT approach, we use each joint model trained under FL on each of the 6 datasets and perform a small amount of further training per client to produced highly specialised models. The trained parameters of the base models serve as a good initialisation point for rapid training on the clients which often converge within just a few epochs of fine-tuning. These personalised models exhibit a lower RMSE than the other approaches across all datasets. On average FL <math id="S5.SS1.p6.2.m2.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.SS1.p6.2.m2.1a"><mo stretchy="false" id="S5.SS1.p6.2.m2.1.1" xref="S5.SS1.p6.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.2.m2.1b"><ci id="S5.SS1.p6.2.m2.1.1.cmml" xref="S5.SS1.p6.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.2.m2.1c">\rightarrow</annotation></semantics></math> LFT produces models with a 4.5% lower RMSE than localised training with the best model performing 4.9% better than the best localised model. In FL+HC <math id="S5.SS1.p6.3.m3.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.SS1.p6.3.m3.1a"><mo stretchy="false" id="S5.SS1.p6.3.m3.1.1" xref="S5.SS1.p6.3.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.3.m3.1b"><ci id="S5.SS1.p6.3.m3.1.1.cmml" xref="S5.SS1.p6.3.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.3.m3.1c">\rightarrow</annotation></semantics></math> LFT approach, clients initialise their personalised models from the specialised model trained within the cluster each client belongs to. This approach produces similarly performing models (4.5% better than the average and best localised model). These personalisation approaches clearly show that local models can benefit by learning from the energy demand patterns of other users. FL allows for energy consumers to contribute to the shared learning task whilst retaining the privacy of their raw consumption data prior to privately fine-tuning their own models to produce more accurate forecasts.</p>
</div>
<div id="S5.SS1.p7" class="ltx_para">
<p id="S5.SS1.p7.3" class="ltx_p">The datasets that included weather features (<math id="S5.SS1.p7.1.m1.2" class="ltx_Math" alttext="\bm{S}_{K=6,\text{+weather}}" display="inline"><semantics id="S5.SS1.p7.1.m1.2a"><msub id="S5.SS1.p7.1.m1.2.3" xref="S5.SS1.p7.1.m1.2.3.cmml"><mi id="S5.SS1.p7.1.m1.2.3.2" xref="S5.SS1.p7.1.m1.2.3.2.cmml">𝑺</mi><mrow id="S5.SS1.p7.1.m1.2.2.2" xref="S5.SS1.p7.1.m1.2.2.2.cmml"><mi id="S5.SS1.p7.1.m1.2.2.2.4" xref="S5.SS1.p7.1.m1.2.2.2.4.cmml">K</mi><mo id="S5.SS1.p7.1.m1.2.2.2.3" xref="S5.SS1.p7.1.m1.2.2.2.3.cmml">=</mo><mrow id="S5.SS1.p7.1.m1.2.2.2.5.2" xref="S5.SS1.p7.1.m1.2.2.2.5.1.cmml"><mn id="S5.SS1.p7.1.m1.1.1.1.1" xref="S5.SS1.p7.1.m1.1.1.1.1.cmml">6</mn><mo id="S5.SS1.p7.1.m1.2.2.2.5.2.1" xref="S5.SS1.p7.1.m1.2.2.2.5.1.cmml">,</mo><mtext id="S5.SS1.p7.1.m1.2.2.2.2" xref="S5.SS1.p7.1.m1.2.2.2.2a.cmml">+weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p7.1.m1.2b"><apply id="S5.SS1.p7.1.m1.2.3.cmml" xref="S5.SS1.p7.1.m1.2.3"><csymbol cd="ambiguous" id="S5.SS1.p7.1.m1.2.3.1.cmml" xref="S5.SS1.p7.1.m1.2.3">subscript</csymbol><ci id="S5.SS1.p7.1.m1.2.3.2.cmml" xref="S5.SS1.p7.1.m1.2.3.2">𝑺</ci><apply id="S5.SS1.p7.1.m1.2.2.2.cmml" xref="S5.SS1.p7.1.m1.2.2.2"><eq id="S5.SS1.p7.1.m1.2.2.2.3.cmml" xref="S5.SS1.p7.1.m1.2.2.2.3"></eq><ci id="S5.SS1.p7.1.m1.2.2.2.4.cmml" xref="S5.SS1.p7.1.m1.2.2.2.4">𝐾</ci><list id="S5.SS1.p7.1.m1.2.2.2.5.1.cmml" xref="S5.SS1.p7.1.m1.2.2.2.5.2"><cn type="integer" id="S5.SS1.p7.1.m1.1.1.1.1.cmml" xref="S5.SS1.p7.1.m1.1.1.1.1">6</cn><ci id="S5.SS1.p7.1.m1.2.2.2.2a.cmml" xref="S5.SS1.p7.1.m1.2.2.2.2"><mtext mathsize="70%" id="S5.SS1.p7.1.m1.2.2.2.2.cmml" xref="S5.SS1.p7.1.m1.2.2.2.2">+weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p7.1.m1.2c">\bm{S}_{K=6,\text{+weather}}</annotation></semantics></math>, <math id="S5.SS1.p7.2.m2.2" class="ltx_Math" alttext="\bm{S}_{K=12,\text{+weather}}" display="inline"><semantics id="S5.SS1.p7.2.m2.2a"><msub id="S5.SS1.p7.2.m2.2.3" xref="S5.SS1.p7.2.m2.2.3.cmml"><mi id="S5.SS1.p7.2.m2.2.3.2" xref="S5.SS1.p7.2.m2.2.3.2.cmml">𝑺</mi><mrow id="S5.SS1.p7.2.m2.2.2.2" xref="S5.SS1.p7.2.m2.2.2.2.cmml"><mi id="S5.SS1.p7.2.m2.2.2.2.4" xref="S5.SS1.p7.2.m2.2.2.2.4.cmml">K</mi><mo id="S5.SS1.p7.2.m2.2.2.2.3" xref="S5.SS1.p7.2.m2.2.2.2.3.cmml">=</mo><mrow id="S5.SS1.p7.2.m2.2.2.2.5.2" xref="S5.SS1.p7.2.m2.2.2.2.5.1.cmml"><mn id="S5.SS1.p7.2.m2.1.1.1.1" xref="S5.SS1.p7.2.m2.1.1.1.1.cmml">12</mn><mo id="S5.SS1.p7.2.m2.2.2.2.5.2.1" xref="S5.SS1.p7.2.m2.2.2.2.5.1.cmml">,</mo><mtext id="S5.SS1.p7.2.m2.2.2.2.2" xref="S5.SS1.p7.2.m2.2.2.2.2a.cmml">+weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p7.2.m2.2b"><apply id="S5.SS1.p7.2.m2.2.3.cmml" xref="S5.SS1.p7.2.m2.2.3"><csymbol cd="ambiguous" id="S5.SS1.p7.2.m2.2.3.1.cmml" xref="S5.SS1.p7.2.m2.2.3">subscript</csymbol><ci id="S5.SS1.p7.2.m2.2.3.2.cmml" xref="S5.SS1.p7.2.m2.2.3.2">𝑺</ci><apply id="S5.SS1.p7.2.m2.2.2.2.cmml" xref="S5.SS1.p7.2.m2.2.2.2"><eq id="S5.SS1.p7.2.m2.2.2.2.3.cmml" xref="S5.SS1.p7.2.m2.2.2.2.3"></eq><ci id="S5.SS1.p7.2.m2.2.2.2.4.cmml" xref="S5.SS1.p7.2.m2.2.2.2.4">𝐾</ci><list id="S5.SS1.p7.2.m2.2.2.2.5.1.cmml" xref="S5.SS1.p7.2.m2.2.2.2.5.2"><cn type="integer" id="S5.SS1.p7.2.m2.1.1.1.1.cmml" xref="S5.SS1.p7.2.m2.1.1.1.1">12</cn><ci id="S5.SS1.p7.2.m2.2.2.2.2a.cmml" xref="S5.SS1.p7.2.m2.2.2.2.2"><mtext mathsize="70%" id="S5.SS1.p7.2.m2.2.2.2.2.cmml" xref="S5.SS1.p7.2.m2.2.2.2.2">+weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p7.2.m2.2c">\bm{S}_{K=12,\text{+weather}}</annotation></semantics></math> and <math id="S5.SS1.p7.3.m3.2" class="ltx_Math" alttext="\bm{S}_{K=24,\text{+weather}}" display="inline"><semantics id="S5.SS1.p7.3.m3.2a"><msub id="S5.SS1.p7.3.m3.2.3" xref="S5.SS1.p7.3.m3.2.3.cmml"><mi id="S5.SS1.p7.3.m3.2.3.2" xref="S5.SS1.p7.3.m3.2.3.2.cmml">𝑺</mi><mrow id="S5.SS1.p7.3.m3.2.2.2" xref="S5.SS1.p7.3.m3.2.2.2.cmml"><mi id="S5.SS1.p7.3.m3.2.2.2.4" xref="S5.SS1.p7.3.m3.2.2.2.4.cmml">K</mi><mo id="S5.SS1.p7.3.m3.2.2.2.3" xref="S5.SS1.p7.3.m3.2.2.2.3.cmml">=</mo><mrow id="S5.SS1.p7.3.m3.2.2.2.5.2" xref="S5.SS1.p7.3.m3.2.2.2.5.1.cmml"><mn id="S5.SS1.p7.3.m3.1.1.1.1" xref="S5.SS1.p7.3.m3.1.1.1.1.cmml">24</mn><mo id="S5.SS1.p7.3.m3.2.2.2.5.2.1" xref="S5.SS1.p7.3.m3.2.2.2.5.1.cmml">,</mo><mtext id="S5.SS1.p7.3.m3.2.2.2.2" xref="S5.SS1.p7.3.m3.2.2.2.2a.cmml">+weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p7.3.m3.2b"><apply id="S5.SS1.p7.3.m3.2.3.cmml" xref="S5.SS1.p7.3.m3.2.3"><csymbol cd="ambiguous" id="S5.SS1.p7.3.m3.2.3.1.cmml" xref="S5.SS1.p7.3.m3.2.3">subscript</csymbol><ci id="S5.SS1.p7.3.m3.2.3.2.cmml" xref="S5.SS1.p7.3.m3.2.3.2">𝑺</ci><apply id="S5.SS1.p7.3.m3.2.2.2.cmml" xref="S5.SS1.p7.3.m3.2.2.2"><eq id="S5.SS1.p7.3.m3.2.2.2.3.cmml" xref="S5.SS1.p7.3.m3.2.2.2.3"></eq><ci id="S5.SS1.p7.3.m3.2.2.2.4.cmml" xref="S5.SS1.p7.3.m3.2.2.2.4">𝐾</ci><list id="S5.SS1.p7.3.m3.2.2.2.5.1.cmml" xref="S5.SS1.p7.3.m3.2.2.2.5.2"><cn type="integer" id="S5.SS1.p7.3.m3.1.1.1.1.cmml" xref="S5.SS1.p7.3.m3.1.1.1.1">24</cn><ci id="S5.SS1.p7.3.m3.2.2.2.2a.cmml" xref="S5.SS1.p7.3.m3.2.2.2.2"><mtext mathsize="70%" id="S5.SS1.p7.3.m3.2.2.2.2.cmml" xref="S5.SS1.p7.3.m3.2.2.2.2">+weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p7.3.m3.2c">\bm{S}_{K=24,\text{+weather}}</annotation></semantics></math>) show a small improvement in model performance in almost all scenarios compared to datasets without such features. We would therefore recommend that an load forecasting system should make use of weather related features if possible as these indicators can help the model to make better predictions on the whole.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.5.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.6.2" class="ltx_text ltx_font_italic">Computational efficiency</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">In addition to measuring the accuracy of forecasts produced by the various training approaches, we note the computational efficiency via the number of samples passing through the optimiser during training. In this sense we can understand how many data samples are required to train the best performing model for each training scenario/dataset. Fewer training samples corresponds with models that can be trained with less computational effort - a desirable characteristic if the forecasting task is to be run at the network edge on low-compute smart meter devices in the homes of energy consumers. In FL it is also very desireable to reduce the amount of communication during training which would otherwise require large amounts of bandwidth. In a practical implementation of FL, communicating large models between household smart meters and entities coordinating the model training could become a bottleneck in the learning process. Any measures to reduce the total number of communication rounds will be beneficial, therefore we present a study of the computational efficiency of each training method within this section. We provide results for computational efficiency (measured in millions of samples) in <a href="#S5.T3" title="TABLE III ‣ V-A Forecasting performance ‣ V Results &amp; Discussion ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table III</span></a>. We also benchmark each method against the fully private localised case, reporting average savings in computation and the savings for the best performing models for each training scenario. In all scenarios where multiple specialised models are trained, we report the total number of samples required to train all models (be they clustered or individual to each client).</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.2" class="ltx_p">Although non-private we noted that 36.6 million samples were required on average to train the single, joint centralised model. The fewest samples (15.6 million) were required for the model trained using the <math id="S5.SS2.p2.1.m1.2" class="ltx_Math" alttext="\bm{S}_{K=6,\text{-weather}}" display="inline"><semantics id="S5.SS2.p2.1.m1.2a"><msub id="S5.SS2.p2.1.m1.2.3" xref="S5.SS2.p2.1.m1.2.3.cmml"><mi id="S5.SS2.p2.1.m1.2.3.2" xref="S5.SS2.p2.1.m1.2.3.2.cmml">𝑺</mi><mrow id="S5.SS2.p2.1.m1.2.2.2" xref="S5.SS2.p2.1.m1.2.2.2.cmml"><mi id="S5.SS2.p2.1.m1.2.2.2.4" xref="S5.SS2.p2.1.m1.2.2.2.4.cmml">K</mi><mo id="S5.SS2.p2.1.m1.2.2.2.3" xref="S5.SS2.p2.1.m1.2.2.2.3.cmml">=</mo><mrow id="S5.SS2.p2.1.m1.2.2.2.5.2" xref="S5.SS2.p2.1.m1.2.2.2.5.1.cmml"><mn id="S5.SS2.p2.1.m1.1.1.1.1" xref="S5.SS2.p2.1.m1.1.1.1.1.cmml">6</mn><mo id="S5.SS2.p2.1.m1.2.2.2.5.2.1" xref="S5.SS2.p2.1.m1.2.2.2.5.1.cmml">,</mo><mtext id="S5.SS2.p2.1.m1.2.2.2.2" xref="S5.SS2.p2.1.m1.2.2.2.2a.cmml">-weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.2b"><apply id="S5.SS2.p2.1.m1.2.3.cmml" xref="S5.SS2.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S5.SS2.p2.1.m1.2.3.1.cmml" xref="S5.SS2.p2.1.m1.2.3">subscript</csymbol><ci id="S5.SS2.p2.1.m1.2.3.2.cmml" xref="S5.SS2.p2.1.m1.2.3.2">𝑺</ci><apply id="S5.SS2.p2.1.m1.2.2.2.cmml" xref="S5.SS2.p2.1.m1.2.2.2"><eq id="S5.SS2.p2.1.m1.2.2.2.3.cmml" xref="S5.SS2.p2.1.m1.2.2.2.3"></eq><ci id="S5.SS2.p2.1.m1.2.2.2.4.cmml" xref="S5.SS2.p2.1.m1.2.2.2.4">𝐾</ci><list id="S5.SS2.p2.1.m1.2.2.2.5.1.cmml" xref="S5.SS2.p2.1.m1.2.2.2.5.2"><cn type="integer" id="S5.SS2.p2.1.m1.1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1.1">6</cn><ci id="S5.SS2.p2.1.m1.2.2.2.2a.cmml" xref="S5.SS2.p2.1.m1.2.2.2.2"><mtext mathsize="70%" id="S5.SS2.p2.1.m1.2.2.2.2.cmml" xref="S5.SS2.p2.1.m1.2.2.2.2">-weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.2c">\bm{S}_{K=6,\text{-weather}}</annotation></semantics></math> dataset. Training the best performing centralised model required 1.4x fewer samples than were required to train all the localised models. Training the individual localised models required 71.0 million samples on average and 79.5 million samples for the best performing model using the <math id="S5.SS2.p2.2.m2.2" class="ltx_Math" alttext="\bm{S}_{K=12,\text{+weather}}" display="inline"><semantics id="S5.SS2.p2.2.m2.2a"><msub id="S5.SS2.p2.2.m2.2.3" xref="S5.SS2.p2.2.m2.2.3.cmml"><mi id="S5.SS2.p2.2.m2.2.3.2" xref="S5.SS2.p2.2.m2.2.3.2.cmml">𝑺</mi><mrow id="S5.SS2.p2.2.m2.2.2.2" xref="S5.SS2.p2.2.m2.2.2.2.cmml"><mi id="S5.SS2.p2.2.m2.2.2.2.4" xref="S5.SS2.p2.2.m2.2.2.2.4.cmml">K</mi><mo id="S5.SS2.p2.2.m2.2.2.2.3" xref="S5.SS2.p2.2.m2.2.2.2.3.cmml">=</mo><mrow id="S5.SS2.p2.2.m2.2.2.2.5.2" xref="S5.SS2.p2.2.m2.2.2.2.5.1.cmml"><mn id="S5.SS2.p2.2.m2.1.1.1.1" xref="S5.SS2.p2.2.m2.1.1.1.1.cmml">12</mn><mo id="S5.SS2.p2.2.m2.2.2.2.5.2.1" xref="S5.SS2.p2.2.m2.2.2.2.5.1.cmml">,</mo><mtext id="S5.SS2.p2.2.m2.2.2.2.2" xref="S5.SS2.p2.2.m2.2.2.2.2a.cmml">+weather</mtext></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.2b"><apply id="S5.SS2.p2.2.m2.2.3.cmml" xref="S5.SS2.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S5.SS2.p2.2.m2.2.3.1.cmml" xref="S5.SS2.p2.2.m2.2.3">subscript</csymbol><ci id="S5.SS2.p2.2.m2.2.3.2.cmml" xref="S5.SS2.p2.2.m2.2.3.2">𝑺</ci><apply id="S5.SS2.p2.2.m2.2.2.2.cmml" xref="S5.SS2.p2.2.m2.2.2.2"><eq id="S5.SS2.p2.2.m2.2.2.2.3.cmml" xref="S5.SS2.p2.2.m2.2.2.2.3"></eq><ci id="S5.SS2.p2.2.m2.2.2.2.4.cmml" xref="S5.SS2.p2.2.m2.2.2.2.4">𝐾</ci><list id="S5.SS2.p2.2.m2.2.2.2.5.1.cmml" xref="S5.SS2.p2.2.m2.2.2.2.5.2"><cn type="integer" id="S5.SS2.p2.2.m2.1.1.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1.1.1">12</cn><ci id="S5.SS2.p2.2.m2.2.2.2.2a.cmml" xref="S5.SS2.p2.2.m2.2.2.2.2"><mtext mathsize="70%" id="S5.SS2.p2.2.m2.2.2.2.2.cmml" xref="S5.SS2.p2.2.m2.2.2.2.2">+weather</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.2c">\bm{S}_{K=12,\text{+weather}}</annotation></semantics></math> dataset.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p">Under the FL training scenario, many hundreds of communication rounds were required to reach the minimum training loss before overfitting. Although only a fraction of clients are selected during each communication round, training proceeds on each client for a number of epochs. These factors lead to a significant amount of computation in total over the whole training operation. On average 5x more computation is required to train the FL models vs the localised models. The best performing FL model required nearly 4x more computation to train vs the best localised models.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p">The FL+HC training scenario only trains a single, joint model for a small number of rounds prior to producing specialised models at the clustering step. Post-clustering, each specialised model is exclusively trained on the cluster’s subset of clients. This has the effect of drastically reducing the amount of computation required to train each model. In <a href="#S5.T3" title="TABLE III ‣ V-A Forecasting performance ‣ V Results &amp; Discussion ‣ Federated Learning for Short-term Residential Load Forecasting" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table III</span></a> We report the total number of samples required to train the FL+HC models across all the clusters. There is a drastic saving in computation in this training scenario as FL+HC strikes a good balance between learning from all clients initially to produce specialised models that are quick to train. On average FL+HC requires 12.7x fewer samples to train models vs localised training and 13.1x fewer samples to train the best performing models.</p>
</div>
<div id="S5.SS2.p5" class="ltx_para">
<p id="S5.SS2.p5.2" class="ltx_p">Where FL and FL+HC are followed by a fine tuning step, only a few epochs of training are required to produce the best performing personalised models. Therefore very little extra computation is required to fine-tune. As we showed earlier, these personalised models exhibit the lowest error of all the models we tested and FL+HC <math id="S5.SS2.p5.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.SS2.p5.1.m1.1a"><mo stretchy="false" id="S5.SS2.p5.1.m1.1.1" xref="S5.SS2.p5.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.1.m1.1b"><ci id="S5.SS2.p5.1.m1.1.1.cmml" xref="S5.SS2.p5.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.1.m1.1c">\rightarrow</annotation></semantics></math> LFT in particular produces low error models with <math id="S5.SS2.p5.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS2.p5.2.m2.1a"><mo id="S5.SS2.p5.2.m2.1.1" xref="S5.SS2.p5.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.2.m2.1b"><csymbol cd="latexml" id="S5.SS2.p5.2.m2.1.1.cmml" xref="S5.SS2.p5.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.2.m2.1c">\sim</annotation></semantics></math>10x reduction in computation compared to localised training.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we explored the use of FL for the purpose of private load forecasting using an LSTM network. We compared our results with benchmarks - a non-private centralised training approach and a fully private localised learning approach. Additionally we investigated the use of FL+HC - a clustered variant of FL shown to perform well on non-IID data. We determined that FL approaches can outperform centralised learning but perform worse than localised learning. We presented favourable results however, when a personalisation step is applied to the models trained by FL and FL+HC. In this case model performance can be improved by up to 5% compared to localised learning while still retaining the privacy of the raw energy consumption data. We also reported the computational efficiency of the various training methods, concluding that FL+HC and FL+HC followed by fine-tuning result in vast computational savings (on the order of 10x reduction) in the number of samples required to train the best models. Finally we provide some brief advice on aggregation of predictions after the training procedure to inform the design of a complete privacy-preserving training/inference framework for load forecasting.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work is partly supported by the SEND project (grant ref. 32R16P00706) funded by ERDF and BEIS as well as EPSRC EnergyREV (EP/S031863/1).</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Smart Energy GB. (2019, May) Smart meter benefits: Role of smart meters in
responding to climate change. [Online]. Available:
<a target="_blank" href="https://www.smartenergygb.org/en/-/media/SmartEnergy/essential-documents/press-resources/Documents/Smart-Energy-GB-report-2---Role-in-climate-change-mitigation-Final_updated-300819.ashx?la=en&amp;hash=E353C643DBFA500BDA2DDBB55F599575B1FE21B5" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.smartenergygb.org/en/-/media/SmartEnergy/essential-documents/press-resources/Documents/Smart-Energy-GB-report-2---Role-in-climate-change-mitigation-Final_updated-300819.ashx?la=en&amp;hash=E353C643DBFA500BDA2DDBB55F599575B1FE21B5</a>

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
E. McKenna, I. Richardson, and M. Thomson, “Smart meter data: Balancing
consumer privacy concerns with legitimate applications,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Energy
Policy</em>, vol. 41, pp. 807–814, Feb. 2012.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
N. Balta-Ozkan, O. Amerighi, and B. Boteler, “A comparison of consumer
perceptions towards smart homes in the UK, Germany and Italy: reflections for
policy and future research,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Technology Analysis &amp; Strategic
Management</em>, vol. 26, no. 10, pp. 1176–1195, Dec. 2014.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Y. Lecun, Y. Bengio, and G. E. Hinton, “Deep learning,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Nature</em>, vol.
521, no. 7, pp. 436–444, May 2015.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, M. Zaheer, M. Sanjabi, A. Talwalkar, and V. Smith,
“Federated Optimization for Heterogeneous Networks,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv.org</em>, p.
arXiv:1812.06127, Dec. 2018.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-Efficient Learning of Deep Networks from Decentralized
Data,” in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>, 2017, pp.
1273–1282.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
T. Hong and P. Wang, “Artificial Intelligence for Load Forecasting: History,
Illusions, and Opportunities,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">IEEE Power and Energy Magazine</em>,
vol. 20, no. 3, pp. 14–23, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
B.-J. Chen, M.-W. Chang, and C.-J. lin, “Load forecasting using support
vector Machines: a study on EUNITE competition 2001,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">IEEE
Transactions on Power Systems</em>, vol. 19, no. 4, pp. 1821–1830, 2004.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
A. Jain, E. Srinivas, and R. Rauta, “Short term load forecasting using fuzzy
adaptive inference and similarity,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">2009 World Congress on Nature
&amp; Biologically Inspired Computing (NaBIC)</em>, 2009, pp. 1743–1748.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
S. Bouktif, A. Fiaz, A. Ouni, and M. A. Serhani, “Optimal Deep Learning LSTM
Model for Electric Load Forecasting using Feature Selection and Genetic
Algorithm: Comparison with Machine Learning Approaches †,”
<em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Energies</em>, vol. 11, no. 7, 2018.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
H. Shi, M. Xu, and R. Li, “Deep Learning for Household Load
Forecasting—A Novel Pooling Deep RNN,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions
on Smart Grid</em>, vol. 9, no. 5, pp. 5271–5280, 2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
K. Amarasinghe, D. L. Marino, and M. Manic, “Deep neural networks for energy
load forecasting,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">2017 IEEE 26th International Symposium on
Industrial Electronics (ISIE)</em>, 2017, pp. 1483–1488.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
S. Hochreiter and J. Schmidhuber, “Long Short-Term Memory,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Neural
Computation</em>, vol. 9, no. 8, pp. 1735–1780, Nov. 1997.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
N. Wei, C. Li, X. Peng, F. Zeng, and X. Lu, “Conventional models and
artificial intelligence-based models for energy consumption forecasting: A
review,” <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Journal of Petroleum Science and Engineering</em>, vol. 181,
Oct. 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M. Bourdeau, X. Q. Zhai, E. Nefzaoui, X. Guo, and P. Chatellier, “Modeling
and forecasting building energy consumption: A review of data-driven
techniques,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Sustainable Cities and Society</em>, vol. 48, Jul. 2019.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
W. Kong, Z. Y. Dong, Y. Jia, D. J. Hill, Y. Xu, and Y. Zhang, “Short-Term
Residential Load Forecasting Based on LSTM Recurrent Neural Network,”
<em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Smart Grid</em>, vol. 10, no. 1, pp. 841–851, Jan.
2019.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
J. Dean, G. S. Corrado, R. Monga, K. Chen, M. Devin, Q. V. Le, M. Z. Mao,
M. Ranzato, A. Senior, P. Tucker, K. Yang, and A. Y. Ng, “Large scale
distributed deep networks,” in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Advances in neural information
processing systems</em>.   Curran Associates
Inc., Dec. 2012, pp. 1223–1231.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
K. Hsieh, A. Phanishayee, O. Mutlu, and P. Gibbons, “The non-iid data
quagmire of decentralized machine learning,” in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">International
Conference on Machine Learning</em>.   PMLR,
2020, pp. 4387–4398.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
V. Smith, C.-K. Chiang, M. Sanjabi, and A. Talwalkar, “Federated Multi-Task
Learning,” in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, May
2017, p. arXiv:1705.10467.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
F. Sattler, S. Wiedemann, K.-R. Müller, and W. Samek, “Robust and
Communication-Efficient Federated Learning from Non-IID Data,”
<em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv.org</em>, p. arXiv:1903.02891, Mar. 2019.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
C. Briggs, Z. Fan, and P. Andras, “Federated learning with hierarchical
clustering of local updates to improve training on non-IID data,” in
<em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">2020 International Joint Conference on Neural Networks (IJCNN)</em>.   IEEE, Sep. 2020.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Y. Guo, D. Wang, A. Vishwanath, C. Xu, and Q. Li, “Towards Federated Learning
for HVAC Analytics: A Measurement Study,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
Eleventh ACM International Conference on Future Energy Systems</em>.   New York, NY, USA: Association for Computing
Machinery, 2020, pp. 68–73.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Y. M. Saputra, D. T. Hoang, D. N. Nguyen, E. Dutkiewicz, M. D. Mueck, and
S. Srikanteswara, “Energy Demand Prediction with Federated Learning for
Electric Vehicle Networks,” in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">GLOBECOM 2019 - 2019 IEEE Global
Communications Conference</em>.   IEEE,
2019, pp. 1–6.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Y. Wang, I. L. Bennani, X. Liu, M. Sun, and Y. Zhou, “Electricity Consumer
Characteristics Identification: A Federated Learning Approach,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">IEEE
Transactions on Smart Grid</em>, pp. 1–1, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
A. Taïk and S. Cherkaoui, “Electrical Load Forecasting Using Edge
Computing and Federated Learning,” in <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">ICC 2020 - 2020 IEEE
International Conference on Communications (ICC)</em>, 2020, pp. 1–6.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
SmartMeter Energy Consumption Data in London Households. [Online]. Available:
<a target="_blank" href="https://data.london.gov.uk/dataset/smartmeter-energy-use-data-in-london-households" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://data.london.gov.uk/dataset/smartmeter-energy-use-data-in-london-households</a>

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Met Office, “UK hourly weather observation data,” Centre for
Environmental Data Analysis, Oct. 2020.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Y. Bengio, P. Simard, and P. Frasconi, “Learning long-term dependencies with
gradient descent is difficult,” <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural
Networks</em>, vol. 5, no. 2, pp. 157–166, 1994.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
D. P. Kingma and J. Ba, “Adam: A Method for Stochastic Optimization,”
<em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv.org</em>, p. arXiv:1412.6980, Dec. 2014.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
A. Paszke, S. Gross, F. Massa, A. Lerer, J. Bradbury, G. Chanan, T. Killeen,
Z. Lin, N. Gimelshein, L. Antiga, A. Desmaison, A. Kopf, E. Yang, Z. DeVito,
M. Raison, A. Tejani, S. Chilamkurthy, B. Steiner, L. Fang, J. Bai, and
S. Chintala, “PyTorch: An Imperative Style, High-Performance Deep Learning
Library,” in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 32</em>,
H. Wallach, H. Larochelle, A. Beygelzimer, F. d. A. e. Buc, E. Fox, and
R. Garnett, Eds.   Curran Associates,
Inc., 2019, pp. 8024–8035.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2105.13324" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2105.13325" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2105.13325">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2105.13325" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2105.13326" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Mar 19 05:48:41 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
