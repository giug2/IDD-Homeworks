<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation</title>
<!--Generated on Wed Oct  2 15:57:49 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.16627v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S1" title="In Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S2" title="In Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S2.SS1" title="In 2 Related Works ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Multimodal Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S2.SS2" title="In 2 Related Works ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Matryoshka Representation Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3" title="In Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodologies</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS1" title="In 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Statement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS2" title="In 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Full-Scale Matryoshka Representation Learning for Recommendation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS2.SSS0.Px1" title="In 3.2 Full-Scale Matryoshka Representation Learning for Recommendation ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title">The fMRLRec Operator</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS3" title="In 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Overall Framework</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS3.SSS1" title="In 3.3 Overall Framework ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Language and Image Encoding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS3.SSS2" title="In 3.3 Overall Framework ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Linear Recurrent Units</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS3.SSS3" title="In 3.3 Overall Framework ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.3 </span>Overall LRU-Based Recommendation Framework</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS3.SSS4" title="In 3.3 Overall Framework ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.4 </span>fMRLRec Plugin to Overall Framework</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS3.SSS4.Px1" title="In 3.3.4 fMRLRec Plugin to Overall Framework ‣ 3.3 Overall Framework ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title">Prediction Layer</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS3.SSS5" title="In 3.3 Overall Framework ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.5 </span>Network Training</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S4" title="In Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>fMRLRec Memory Efficiency</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S5" title="In Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S5.SS1" title="In 5 Experimental Setup ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S5.SS2" title="In 5 Experimental Setup ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Baseline Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S5.SS3" title="In 5 Experimental Setup ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Implementations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S6" title="In Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Experimental Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S6.SS1" title="In 6 Experimental Results ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Main Performance Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S6.SS2" title="In 6 Experimental Results ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>fMRLRec Model-Series Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S6.SS3" title="In 6 Experimental Results ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Parameter Saving of fMRLRec</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S6.SS4" title="In 6 Experimental Results ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Ablation Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S7" title="In Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S8" title="In Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#A1" title="In Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#A1.SS1" title="In Appendix A Appendix ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#A1.SS2" title="In Appendix A Appendix ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Implementations</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">
Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yueqi Wang<sup class="ltx_sup" id="id1.1.id1">1</sup>  Zhenrui Yue<sup class="ltx_sup" id="id2.2.id2">2</sup><span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span>  Huimin Zeng<sup class="ltx_sup" id="id3.3.id3">2</sup>  Dong Wang<sup class="ltx_sup" id="id4.4.id4">2</sup>  Julian McAuley<sup class="ltx_sup" id="id5.5.id5">3</sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id6.6.id6">1</sup>University of California, Berkeley  <sup class="ltx_sup" id="id7.7.id7">2</sup>University of Illinois Urbana-Champaign 
<br class="ltx_break"/><sup class="ltx_sup" id="id8.8.id8">3</sup>University of California, San Diego 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id9.9.id9">yueqi@berkeley.edu</span>  <span class="ltx_text ltx_font_typewriter" id="id10.10.id10">{zhenrui3, huiminz3, dwang24}@illinois.edu</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id11.11.id11">jmcauley@ucsd.edu</span>
<br class="ltx_break"/>
</span><span class="ltx_author_notes">Both authors contributed equally to this research.Corresponding Author</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id12.id1">Despite recent advancements in language and vision modeling, integrating rich multimodal knowledge into recommender systems continues to pose significant challenges. This is primarily due to the need for
efficient recommendation, which requires adaptive and interactive responses.
In this study, we focus on sequential recommendation and introduce a lightweight framework called full-scale Matryoshka representation learning for multimodal recommendation (fMRLRec). Our fMRLRec captures item features at different granularities, learning informative representations for efficient recommendation across multiple dimensions. To integrate item features from diverse modalities, fMRLRec employs a simple mapping to project multimodal item features into an aligned feature space. Additionally, we design an efficient linear transformation that embeds smaller features into larger ones, substantially reducing memory requirements for large-scale training on recommendation data. Combined with improved state space modeling techniques, fMRLRec scales to different dimensions and only requires one-time training to produce multiple models tailored to various granularities. We demonstrate the effectiveness and efficiency of fMRLRec on multiple benchmark datasets, which consistently achieves superior performance over state-of-the-art baseline methods. We make our code and data publicly available at https://github.com/yueqirex/fMRLRec.
</p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<div class="ltx_block ltx_align_bottom" id="p1.1">
<p class="ltx_p" id="p1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1.1">Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation</span></p>
<br class="ltx_break ltx_centering"/>
<p class="ltx_p ltx_align_center" id="p1.1.2" style="width:433.6pt;"><span class="ltx_text ltx_inline-block" id="p1.1.2.1" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p1.1.2.1.1">
<span class="ltx_tr" id="p1.1.2.1.1.1">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.2.1.1.1.1.1">Yueqi Wang<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.1">1</sup><span class="ltx_note ltx_role_thanks" id="p1.1.2.1.1.1.1.1.2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span>Both authors contributed equally to this research.</span></span></span>  Zhenrui Yue<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.3">2</sup><span class="ltx_note ltx_role_footnotemark" id="footnotex2"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex2.1.1.1">1</span></span></span></span></span>  Huimin Zeng<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.4">2</sup>  Dong Wang<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.5">2</sup><span class="ltx_note ltx_role_thanks" id="p1.1.2.1.1.1.1.1.6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span>Corresponding Author</span></span></span>  Julian McAuley<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.7">3</sup></span></span></span>
<span class="ltx_tr" id="p1.1.2.1.1.2">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.2.1"><sup class="ltx_sup" id="p1.1.2.1.1.2.1.1">1</sup>University of California, Berkeley  <sup class="ltx_sup" id="p1.1.2.1.1.2.1.2">2</sup>University of Illinois Urbana-Champaign</span></span>
<span class="ltx_tr" id="p1.1.2.1.1.3">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.3.1"><sup class="ltx_sup" id="p1.1.2.1.1.3.1.1">3</sup>University of California, San Diego</span></span>
<span class="ltx_tr" id="p1.1.2.1.1.4">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.4.1"><span class="ltx_text ltx_font_typewriter" id="p1.1.2.1.1.4.1.1">yueqi@berkeley.edu</span>  <span class="ltx_text ltx_font_typewriter" id="p1.1.2.1.1.4.1.2">{zhenrui3, huiminz3, dwang24}@illinois.edu</span></span></span>
<span class="ltx_tr" id="p1.1.2.1.1.5">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.5.1"><span class="ltx_text ltx_font_typewriter" id="p1.1.2.1.1.5.1.1">jmcauley@ucsd.edu</span></span></span>
</span></span></p>
<br class="ltx_break ltx_centering"/>
</div>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recent advancements in language and multimodal modeling demonstrates significant potential for improving recommender systems <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib26" title="">2023</a>); Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib17" title="">2023</a>); OpenAI (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib21" title="">2023</a>); Reid et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib23" title="">2024</a>)</cite>. Such progress can be largely attributed to: (1) language / vision features can provide additional descriptive information for understanding user preference and item characteristics (e.g. item descriptions); and (2) generic language capabilities acquired through language and vision pretraining tasks could be transferred for use in recommendation systems. Consequently, language and multimodal representations provide a robust foundation for enhancing the contextual relevance and accuracy of recommendations <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib14" title="">2023a</a>); Geng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib3" title="">2023</a>); Yue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib36" title="">2023</a>); Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib31" title="">2024b</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite performance improvements, different recommendation scenarios (e.g., centralized or federated recommender systems) often require varying granularities (i.e., model / dimension sizes) in item representations to achieve the balance between performance and efficiency <cite class="ltx_cite ltx_citemacro_cite">Han et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib5" title="">2021</a>); Luo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib19" title="">2022</a>); Xia et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib33" title="">2023</a>); Zeng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib39" title="">2024</a>)</cite>. For instance, larger dimensions are typically required to encode language and vision features for fine-grained understanding and generation tasks, although marginally lower performance can often be achieved using considerably smaller feature sizes <cite class="ltx_cite ltx_citemacro_cite">Kusupati et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib13" title="">2022</a>)</cite>.
To identify the optimal granularity for specific use cases in recommendation systems, methods like grid search or adaptive search heuristics are frequently utilized in training <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib28" title="">2024</a>)</cite>. However, such searches can lead to substantial training expenses or fail to identify the optimal model, particularly when given a large configuration space and constrained computational resources. Therefore, a train-once and deploy-anywhere solution is optimal for the efficient training of recommender systems, which should ideally meet the following criteria:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">Training is only need once to yield multiple models of different sizes corresponding to various performance and memory requirements;</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Training and inference should demand no more computational costs than training a single large model, allowing deployment of various model sizes at inference time.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Inspired by Matryoshka Representation Learning (MRL) <cite class="ltx_cite ltx_citemacro_cite">Kusupati et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib13" title="">2022</a>)</cite>, we introduce a lightweight multimodal recommendation framework named full-scale Matryoshka Representation Learning for Recommendation (fMRLRec). fMRLRec embeds smaller vector/matrix representations in larger ones like Matryoshka dolls and is only trained once without additional computation costs. Different from MRL that only embeds smaller final-layer activations into larger ones during training, fMRLRec pushes the efficiency of MRL training by introducing an efficient linear transformation that embeds both smaller weights and activations into larger ones, thereby reducing memory costs associated with both aspects. This approach is particularly effective for training recommender systems on large-scale data, offering a highly efficient framework for multi-granularity model training. Combined with further improvements in state-space modeling represented by <cite class="ltx_cite ltx_citemacro_cite">Yue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib37" title="">2024</a>); Orvieto et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib22" title="">2023</a>); Gu and Dao (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib4" title="">2023</a>)</cite>, the linear recurrence architecture in fMRLRec delivers both effectiveness and efficiency in recommendation performance across various benchmark datasets. We summarize our contributions below<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We adopt publicly available datasets in our experiments and will release our implementation upon publication.</span></span></span>:</p>
<ol class="ltx_enumerate" id="S1.I2">
<li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I2.i1.p1">
<p class="ltx_p" id="S1.I2.i1.p1.1">We introduce a novel training framework for multimodal sequential recommendation (fMRLRec), which provides an efficient paradigm to learn models of varying granularities within a single training session.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I2.i2.p1">
<p class="ltx_p" id="S1.I2.i2.p1.1">fMRLRec introduces an efficient linear transformation that reduces memory costs by embedding smaller features into larger ones. Combined with improved state-space modeling, fMRLRec achieves both efficiency and effectiveness in multimodal recommendation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I2.i3.p1">
<p class="ltx_p" id="S1.I2.i3.p1.1">We show the effectiveness and efficiency of our fMRLRec on benchmark datasets, where the proposed fMRLRec consistently outperforms state-of-the-art baselines with considerable improvements in training efficiency and recommendation performance.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Multimodal Recommendation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Language and multimodal models are applied as recommender systems to understand user preferences and item properties <cite class="ltx_cite ltx_citemacro_cite">Hou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib9" title="">2022</a>); Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib14" title="">2023a</a>); He and McAuley (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib7" title="">2016b</a>); Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib30" title="">2023</a>)</cite>. Current language-based approaches leverage pretrained models to improve item representations or re-rank retrieved items <cite class="ltx_cite ltx_citemacro_cite">Chen (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib2" title="">2023</a>); Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib15" title="">2023b</a>); Luo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib18" title="">2023</a>); Yue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib36" title="">2023</a>); Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib35" title="">2024</a>)</cite>. For example, VQ-Rec utilizes a language encoder and vector quantization to improve item features in cross-domain recommendation <cite class="ltx_cite ltx_citemacro_cite">Hou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib8" title="">2023</a>)</cite>. To further incorporate visual data, existing methods focus on developing strategies that extracts informative user / item representations <cite class="ltx_cite ltx_citemacro_cite">Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib32" title="">2019</a>); Tao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib25" title="">2020</a>); Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib27" title="">2023</a>); Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib29" title="">2024a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib31" title="">b</a>)</cite>. For instance, VIP5 leverages a pretrained transformer with additional vision encoder to learn user transition patters and improve recommendation performance <cite class="ltx_cite ltx_citemacro_cite">Geng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib3" title="">2023</a>)</cite>. However, current models are not tailored to accommodate flexible item attributes or modalities, nor are they optimized for scalable model sizes and efficient inference. Moreover, multimodal approaches require substantial computational resources and separate training sessions for each model, rendering them largely ineffective for real-world applications. To address this, we introduce a lightweight multimodal recommendation framework in fMRLRec, offering multiple model sizes within a single training session and efficient inference capabilities across various scenarios.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Matryoshka Representation Learning</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Matryoshka representation learning (MRL) constructs embeddings at different granularities using an identical model, thereby providing adaptability to varying computational resources without additional training <cite class="ltx_cite ltx_citemacro_cite">Kusupati et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib13" title="">2022</a>)</cite>. MRL proposes nested optimization of vectors in multiple dimensions using shared model parameters, demonstrating promising results on multiple downstream tasks and further applications <cite class="ltx_cite ltx_citemacro_cite">Cai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib1" title="">2024</a>); Hu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib10" title="">2024</a>); Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib16" title="">2024</a>)</cite>. Nevertheless, training MRL models demands additional memory for activations in its nested optimization, posing challenges for training recommender systems with large batches on extensive data. Furthermore, MRL remains unexplored for sequential modeling and efficient multimodal recommendation. As such, our fMRLRec aims to provide an adaptive framework for learning recommender systems using arbitrary modalities, delivering both efficacy and efficiency in multimodal sequential recommendation.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodologies</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Statement</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.9">We present fMRLRec with a research focus in multimodal sequential recommendation. Formally, given a user set <math alttext="\mathcal{U}=\{u1,u2,...,u_{|U|}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.5"><semantics id="S3.SS1.p1.1.m1.5a"><mrow id="S3.SS1.p1.1.m1.5.5" xref="S3.SS1.p1.1.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.5.5.5" xref="S3.SS1.p1.1.m1.5.5.5.cmml">𝒰</mi><mo id="S3.SS1.p1.1.m1.5.5.4" xref="S3.SS1.p1.1.m1.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.5.5.3.3" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml"><mo id="S3.SS1.p1.1.m1.5.5.3.3.4" stretchy="false" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">{</mo><mrow id="S3.SS1.p1.1.m1.3.3.1.1.1" xref="S3.SS1.p1.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.3.3.1.1.1.2" xref="S3.SS1.p1.1.m1.3.3.1.1.1.2.cmml">u</mi><mo id="S3.SS1.p1.1.m1.3.3.1.1.1.1" xref="S3.SS1.p1.1.m1.3.3.1.1.1.1.cmml">⁢</mo><mn id="S3.SS1.p1.1.m1.3.3.1.1.1.3" xref="S3.SS1.p1.1.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.1.m1.5.5.3.3.5" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><mrow id="S3.SS1.p1.1.m1.4.4.2.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.4.4.2.2.2.2" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2.cmml">u</mi><mo id="S3.SS1.p1.1.m1.4.4.2.2.2.1" xref="S3.SS1.p1.1.m1.4.4.2.2.2.1.cmml">⁢</mo><mn id="S3.SS1.p1.1.m1.4.4.2.2.2.3" xref="S3.SS1.p1.1.m1.4.4.2.2.2.3.cmml">2</mn></mrow><mo id="S3.SS1.p1.1.m1.5.5.3.3.6" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.1.m1.2.2" mathvariant="normal" xref="S3.SS1.p1.1.m1.2.2.cmml">…</mi><mo id="S3.SS1.p1.1.m1.5.5.3.3.7" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.5.5.3.3.3" xref="S3.SS1.p1.1.m1.5.5.3.3.3.cmml"><mi id="S3.SS1.p1.1.m1.5.5.3.3.3.2" xref="S3.SS1.p1.1.m1.5.5.3.3.3.2.cmml">u</mi><mrow id="S3.SS1.p1.1.m1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi id="S3.SS1.p1.1.m1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.cmml">U</mi><mo id="S3.SS1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.SS1.p1.1.m1.5.5.3.3.8" stretchy="false" xref="S3.SS1.p1.1.m1.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.5b"><apply id="S3.SS1.p1.1.m1.5.5.cmml" xref="S3.SS1.p1.1.m1.5.5"><eq id="S3.SS1.p1.1.m1.5.5.4.cmml" xref="S3.SS1.p1.1.m1.5.5.4"></eq><ci id="S3.SS1.p1.1.m1.5.5.5.cmml" xref="S3.SS1.p1.1.m1.5.5.5">𝒰</ci><set id="S3.SS1.p1.1.m1.5.5.3.4.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3"><apply id="S3.SS1.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1"><times id="S3.SS1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1.1"></times><ci id="S3.SS1.p1.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.3.3.1.1.1.2">𝑢</ci><cn id="S3.SS1.p1.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.1.m1.4.4.2.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2"><times id="S3.SS1.p1.1.m1.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.1"></times><ci id="S3.SS1.p1.1.m1.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.2.2.2.2">𝑢</ci><cn id="S3.SS1.p1.1.m1.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">…</ci><apply id="S3.SS1.p1.1.m1.5.5.3.3.3.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.1.m1.5.5.3.3.3.2">𝑢</ci><apply id="S3.SS1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3"><abs id="S3.SS1.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3.1"></abs><ci id="S3.SS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1">𝑈</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.5c">\mathcal{U}=\{u1,u2,...,u_{|U|}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.5d">caligraphic_U = { italic_u 1 , italic_u 2 , … , italic_u start_POSTSUBSCRIPT | italic_U | end_POSTSUBSCRIPT }</annotation></semantics></math> and an item set <math alttext="\mathcal{V}=\{v1,v2,...,v_{|V|}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.5"><semantics id="S3.SS1.p1.2.m2.5a"><mrow id="S3.SS1.p1.2.m2.5.5" xref="S3.SS1.p1.2.m2.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.5.5.5" xref="S3.SS1.p1.2.m2.5.5.5.cmml">𝒱</mi><mo id="S3.SS1.p1.2.m2.5.5.4" xref="S3.SS1.p1.2.m2.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.5.5.3.3" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml"><mo id="S3.SS1.p1.2.m2.5.5.3.3.4" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">{</mo><mrow id="S3.SS1.p1.2.m2.3.3.1.1.1" xref="S3.SS1.p1.2.m2.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.3.3.1.1.1.2" xref="S3.SS1.p1.2.m2.3.3.1.1.1.2.cmml">v</mi><mo id="S3.SS1.p1.2.m2.3.3.1.1.1.1" xref="S3.SS1.p1.2.m2.3.3.1.1.1.1.cmml">⁢</mo><mn id="S3.SS1.p1.2.m2.3.3.1.1.1.3" xref="S3.SS1.p1.2.m2.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.2.m2.5.5.3.3.5" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><mrow id="S3.SS1.p1.2.m2.4.4.2.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.4.4.2.2.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.2.2.cmml">v</mi><mo id="S3.SS1.p1.2.m2.4.4.2.2.2.1" xref="S3.SS1.p1.2.m2.4.4.2.2.2.1.cmml">⁢</mo><mn id="S3.SS1.p1.2.m2.4.4.2.2.2.3" xref="S3.SS1.p1.2.m2.4.4.2.2.2.3.cmml">2</mn></mrow><mo id="S3.SS1.p1.2.m2.5.5.3.3.6" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.2.m2.2.2" mathvariant="normal" xref="S3.SS1.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS1.p1.2.m2.5.5.3.3.7" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.5.5.3.3.3" xref="S3.SS1.p1.2.m2.5.5.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.5.5.3.3.3.2" xref="S3.SS1.p1.2.m2.5.5.3.3.3.2.cmml">v</mi><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">V</mi><mo id="S3.SS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.8" stretchy="false" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.5b"><apply id="S3.SS1.p1.2.m2.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5"><eq id="S3.SS1.p1.2.m2.5.5.4.cmml" xref="S3.SS1.p1.2.m2.5.5.4"></eq><ci id="S3.SS1.p1.2.m2.5.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5.5">𝒱</ci><set id="S3.SS1.p1.2.m2.5.5.3.4.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3"><apply id="S3.SS1.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1"><times id="S3.SS1.p1.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1.1"></times><ci id="S3.SS1.p1.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1.2">𝑣</ci><cn id="S3.SS1.p1.2.m2.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.4.4.2.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2"><times id="S3.SS1.p1.2.m2.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2.1"></times><ci id="S3.SS1.p1.2.m2.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2.2">𝑣</ci><cn id="S3.SS1.p1.2.m2.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2">…</ci><apply id="S3.SS1.p1.2.m2.5.5.3.3.3.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3.2">𝑣</ci><apply id="S3.SS1.p1.2.m2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3"><abs id="S3.SS1.p1.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.1"></abs><ci id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">𝑉</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.5c">\mathcal{V}=\{v1,v2,...,v_{|V|}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.5d">caligraphic_V = { italic_v 1 , italic_v 2 , … , italic_v start_POSTSUBSCRIPT | italic_V | end_POSTSUBSCRIPT }</annotation></semantics></math>, user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_u</annotation></semantics></math>’s interacted item sequence in chronological order is denoted with <math alttext="\mathcal{S}_{u}=[v_{1}^{(u)},v_{2}^{(u)},...,v_{n}^{(u)}]" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.7"><semantics id="S3.SS1.p1.4.m4.7a"><mrow id="S3.SS1.p1.4.m4.7.7" xref="S3.SS1.p1.4.m4.7.7.cmml"><msub id="S3.SS1.p1.4.m4.7.7.5" xref="S3.SS1.p1.4.m4.7.7.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.7.7.5.2" xref="S3.SS1.p1.4.m4.7.7.5.2.cmml">𝒮</mi><mi id="S3.SS1.p1.4.m4.7.7.5.3" xref="S3.SS1.p1.4.m4.7.7.5.3.cmml">u</mi></msub><mo id="S3.SS1.p1.4.m4.7.7.4" xref="S3.SS1.p1.4.m4.7.7.4.cmml">=</mo><mrow id="S3.SS1.p1.4.m4.7.7.3.3" xref="S3.SS1.p1.4.m4.7.7.3.4.cmml"><mo id="S3.SS1.p1.4.m4.7.7.3.3.4" stretchy="false" xref="S3.SS1.p1.4.m4.7.7.3.4.cmml">[</mo><msubsup id="S3.SS1.p1.4.m4.5.5.1.1.1" xref="S3.SS1.p1.4.m4.5.5.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.5.5.1.1.1.2.2" xref="S3.SS1.p1.4.m4.5.5.1.1.1.2.2.cmml">v</mi><mn id="S3.SS1.p1.4.m4.5.5.1.1.1.2.3" xref="S3.SS1.p1.4.m4.5.5.1.1.1.2.3.cmml">1</mn><mrow id="S3.SS1.p1.4.m4.1.1.1.3" xref="S3.SS1.p1.4.m4.5.5.1.1.1.cmml"><mo id="S3.SS1.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.4.m4.5.5.1.1.1.cmml">(</mo><mi id="S3.SS1.p1.4.m4.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.cmml">u</mi><mo id="S3.SS1.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.4.m4.5.5.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS1.p1.4.m4.7.7.3.3.5" xref="S3.SS1.p1.4.m4.7.7.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.4.m4.6.6.2.2.2" xref="S3.SS1.p1.4.m4.6.6.2.2.2.cmml"><mi id="S3.SS1.p1.4.m4.6.6.2.2.2.2.2" xref="S3.SS1.p1.4.m4.6.6.2.2.2.2.2.cmml">v</mi><mn id="S3.SS1.p1.4.m4.6.6.2.2.2.2.3" xref="S3.SS1.p1.4.m4.6.6.2.2.2.2.3.cmml">2</mn><mrow id="S3.SS1.p1.4.m4.2.2.1.3" xref="S3.SS1.p1.4.m4.6.6.2.2.2.cmml"><mo id="S3.SS1.p1.4.m4.2.2.1.3.1" stretchy="false" xref="S3.SS1.p1.4.m4.6.6.2.2.2.cmml">(</mo><mi id="S3.SS1.p1.4.m4.2.2.1.1" xref="S3.SS1.p1.4.m4.2.2.1.1.cmml">u</mi><mo id="S3.SS1.p1.4.m4.2.2.1.3.2" stretchy="false" xref="S3.SS1.p1.4.m4.6.6.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS1.p1.4.m4.7.7.3.3.6" xref="S3.SS1.p1.4.m4.7.7.3.4.cmml">,</mo><mi id="S3.SS1.p1.4.m4.4.4" mathvariant="normal" xref="S3.SS1.p1.4.m4.4.4.cmml">…</mi><mo id="S3.SS1.p1.4.m4.7.7.3.3.7" xref="S3.SS1.p1.4.m4.7.7.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.4.m4.7.7.3.3.3" xref="S3.SS1.p1.4.m4.7.7.3.3.3.cmml"><mi id="S3.SS1.p1.4.m4.7.7.3.3.3.2.2" xref="S3.SS1.p1.4.m4.7.7.3.3.3.2.2.cmml">v</mi><mi id="S3.SS1.p1.4.m4.7.7.3.3.3.2.3" xref="S3.SS1.p1.4.m4.7.7.3.3.3.2.3.cmml">n</mi><mrow id="S3.SS1.p1.4.m4.3.3.1.3" xref="S3.SS1.p1.4.m4.7.7.3.3.3.cmml"><mo id="S3.SS1.p1.4.m4.3.3.1.3.1" stretchy="false" xref="S3.SS1.p1.4.m4.7.7.3.3.3.cmml">(</mo><mi id="S3.SS1.p1.4.m4.3.3.1.1" xref="S3.SS1.p1.4.m4.3.3.1.1.cmml">u</mi><mo id="S3.SS1.p1.4.m4.3.3.1.3.2" stretchy="false" xref="S3.SS1.p1.4.m4.7.7.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS1.p1.4.m4.7.7.3.3.8" stretchy="false" xref="S3.SS1.p1.4.m4.7.7.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.7b"><apply id="S3.SS1.p1.4.m4.7.7.cmml" xref="S3.SS1.p1.4.m4.7.7"><eq id="S3.SS1.p1.4.m4.7.7.4.cmml" xref="S3.SS1.p1.4.m4.7.7.4"></eq><apply id="S3.SS1.p1.4.m4.7.7.5.cmml" xref="S3.SS1.p1.4.m4.7.7.5"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.7.7.5.1.cmml" xref="S3.SS1.p1.4.m4.7.7.5">subscript</csymbol><ci id="S3.SS1.p1.4.m4.7.7.5.2.cmml" xref="S3.SS1.p1.4.m4.7.7.5.2">𝒮</ci><ci id="S3.SS1.p1.4.m4.7.7.5.3.cmml" xref="S3.SS1.p1.4.m4.7.7.5.3">𝑢</ci></apply><list id="S3.SS1.p1.4.m4.7.7.3.4.cmml" xref="S3.SS1.p1.4.m4.7.7.3.3"><apply id="S3.SS1.p1.4.m4.5.5.1.1.1.cmml" xref="S3.SS1.p1.4.m4.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.5.5.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.5.5.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.4.m4.5.5.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.5.5.1.1.1.2.1.cmml" xref="S3.SS1.p1.4.m4.5.5.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.5.5.1.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.5.5.1.1.1.2.2">𝑣</ci><cn id="S3.SS1.p1.4.m4.5.5.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.5.5.1.1.1.2.3">1</cn></apply><ci id="S3.SS1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1">𝑢</ci></apply><apply id="S3.SS1.p1.4.m4.6.6.2.2.2.cmml" xref="S3.SS1.p1.4.m4.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.6.6.2.2.2.1.cmml" xref="S3.SS1.p1.4.m4.6.6.2.2.2">superscript</csymbol><apply id="S3.SS1.p1.4.m4.6.6.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.6.6.2.2.2.2.1.cmml" xref="S3.SS1.p1.4.m4.6.6.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.6.6.2.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.6.6.2.2.2.2.2">𝑣</ci><cn id="S3.SS1.p1.4.m4.6.6.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.6.6.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.4.m4.2.2.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1">𝑢</ci></apply><ci id="S3.SS1.p1.4.m4.4.4.cmml" xref="S3.SS1.p1.4.m4.4.4">…</ci><apply id="S3.SS1.p1.4.m4.7.7.3.3.3.cmml" xref="S3.SS1.p1.4.m4.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.7.7.3.3.3.1.cmml" xref="S3.SS1.p1.4.m4.7.7.3.3.3">superscript</csymbol><apply id="S3.SS1.p1.4.m4.7.7.3.3.3.2.cmml" xref="S3.SS1.p1.4.m4.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.7.7.3.3.3.2.1.cmml" xref="S3.SS1.p1.4.m4.7.7.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.7.7.3.3.3.2.2.cmml" xref="S3.SS1.p1.4.m4.7.7.3.3.3.2.2">𝑣</ci><ci id="S3.SS1.p1.4.m4.7.7.3.3.3.2.3.cmml" xref="S3.SS1.p1.4.m4.7.7.3.3.3.2.3">𝑛</ci></apply><ci id="S3.SS1.p1.4.m4.3.3.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1">𝑢</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.7c">\mathcal{S}_{u}=[v_{1}^{(u)},v_{2}^{(u)},...,v_{n}^{(u)}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.7d">caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = [ italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT ]</annotation></semantics></math>, where <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_n</annotation></semantics></math> is the sequence length. The sequential recommendation task is to predict the next item <math alttext="v_{n+1}^{(u)}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><msubsup id="S3.SS1.p1.6.m6.1.2" xref="S3.SS1.p1.6.m6.1.2.cmml"><mi id="S3.SS1.p1.6.m6.1.2.2.2" xref="S3.SS1.p1.6.m6.1.2.2.2.cmml">v</mi><mrow id="S3.SS1.p1.6.m6.1.2.2.3" xref="S3.SS1.p1.6.m6.1.2.2.3.cmml"><mi id="S3.SS1.p1.6.m6.1.2.2.3.2" xref="S3.SS1.p1.6.m6.1.2.2.3.2.cmml">n</mi><mo id="S3.SS1.p1.6.m6.1.2.2.3.1" xref="S3.SS1.p1.6.m6.1.2.2.3.1.cmml">+</mo><mn id="S3.SS1.p1.6.m6.1.2.2.3.3" xref="S3.SS1.p1.6.m6.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p1.6.m6.1.1.1.3" xref="S3.SS1.p1.6.m6.1.2.cmml"><mo id="S3.SS1.p1.6.m6.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.6.m6.1.2.cmml">(</mo><mi id="S3.SS1.p1.6.m6.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.cmml">u</mi><mo id="S3.SS1.p1.6.m6.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.2.cmml" xref="S3.SS1.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2">superscript</csymbol><apply id="S3.SS1.p1.6.m6.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.2.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.2.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2.2.2">𝑣</ci><apply id="S3.SS1.p1.6.m6.1.2.2.3.cmml" xref="S3.SS1.p1.6.m6.1.2.2.3"><plus id="S3.SS1.p1.6.m6.1.2.2.3.1.cmml" xref="S3.SS1.p1.6.m6.1.2.2.3.1"></plus><ci id="S3.SS1.p1.6.m6.1.2.2.3.2.cmml" xref="S3.SS1.p1.6.m6.1.2.2.3.2">𝑛</ci><cn id="S3.SS1.p1.6.m6.1.2.2.3.3.cmml" type="integer" xref="S3.SS1.p1.6.m6.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.6.m6.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">v_{n+1}^{(u)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_v start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT</annotation></semantics></math> that user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_u</annotation></semantics></math> will interact with. Mathematically, our objective can be formulated as the maximization of the probability of the next interacted item <math alttext="v_{n+1}^{(u)}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><msubsup id="S3.SS1.p1.8.m8.1.2" xref="S3.SS1.p1.8.m8.1.2.cmml"><mi id="S3.SS1.p1.8.m8.1.2.2.2" xref="S3.SS1.p1.8.m8.1.2.2.2.cmml">v</mi><mrow id="S3.SS1.p1.8.m8.1.2.2.3" xref="S3.SS1.p1.8.m8.1.2.2.3.cmml"><mi id="S3.SS1.p1.8.m8.1.2.2.3.2" xref="S3.SS1.p1.8.m8.1.2.2.3.2.cmml">n</mi><mo id="S3.SS1.p1.8.m8.1.2.2.3.1" xref="S3.SS1.p1.8.m8.1.2.2.3.1.cmml">+</mo><mn id="S3.SS1.p1.8.m8.1.2.2.3.3" xref="S3.SS1.p1.8.m8.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p1.8.m8.1.1.1.3" xref="S3.SS1.p1.8.m8.1.2.cmml"><mo id="S3.SS1.p1.8.m8.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.8.m8.1.2.cmml">(</mo><mi id="S3.SS1.p1.8.m8.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.cmml">u</mi><mo id="S3.SS1.p1.8.m8.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.8.m8.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.2.cmml" xref="S3.SS1.p1.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.2.1.cmml" xref="S3.SS1.p1.8.m8.1.2">superscript</csymbol><apply id="S3.SS1.p1.8.m8.1.2.2.cmml" xref="S3.SS1.p1.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.2.2.1.cmml" xref="S3.SS1.p1.8.m8.1.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.2.2.2.cmml" xref="S3.SS1.p1.8.m8.1.2.2.2">𝑣</ci><apply id="S3.SS1.p1.8.m8.1.2.2.3.cmml" xref="S3.SS1.p1.8.m8.1.2.2.3"><plus id="S3.SS1.p1.8.m8.1.2.2.3.1.cmml" xref="S3.SS1.p1.8.m8.1.2.2.3.1"></plus><ci id="S3.SS1.p1.8.m8.1.2.2.3.2.cmml" xref="S3.SS1.p1.8.m8.1.2.2.3.2">𝑛</ci><cn id="S3.SS1.p1.8.m8.1.2.2.3.3.cmml" type="integer" xref="S3.SS1.p1.8.m8.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.8.m8.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">v_{n+1}^{(u)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_v start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT</annotation></semantics></math> given <math alttext="\mathcal{S}_{u}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><msub id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">𝒮</mi><mi id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝒮</ci><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\mathcal{S}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(v_{n+1}^{(u)}=v|\mathcal{S}_{u})" class="ltx_Math" display="block" id="S3.E1.m1.2"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mi id="S3.E1.m1.2.2.3" xref="S3.E1.m1.2.2.3.cmml">p</mi><mo id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml"><mo id="S3.E1.m1.2.2.1.1.2" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml"><msubsup id="S3.E1.m1.2.2.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.2.cmml"><mi id="S3.E1.m1.2.2.1.1.1.2.2.2" xref="S3.E1.m1.2.2.1.1.1.2.2.2.cmml">v</mi><mrow id="S3.E1.m1.2.2.1.1.1.2.2.3" xref="S3.E1.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.2.2.3.2" xref="S3.E1.m1.2.2.1.1.1.2.2.3.2.cmml">n</mi><mo id="S3.E1.m1.2.2.1.1.1.2.2.3.1" xref="S3.E1.m1.2.2.1.1.1.2.2.3.1.cmml">+</mo><mn id="S3.E1.m1.2.2.1.1.1.2.2.3.3" xref="S3.E1.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.3.1" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">u</mi><mo id="S3.E1.m1.1.1.1.3.2" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.E1.m1.2.2.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.3.2" xref="S3.E1.m1.2.2.1.1.1.3.2.cmml">v</mi><mo fence="false" id="S3.E1.m1.2.2.1.1.1.3.1" xref="S3.E1.m1.2.2.1.1.1.3.1.cmml">|</mo><msub id="S3.E1.m1.2.2.1.1.1.3.3" xref="S3.E1.m1.2.2.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1.1.3.3.2" xref="S3.E1.m1.2.2.1.1.1.3.3.2.cmml">𝒮</mi><mi id="S3.E1.m1.2.2.1.1.1.3.3.3" xref="S3.E1.m1.2.2.1.1.1.3.3.3.cmml">u</mi></msub></mrow></mrow><mo id="S3.E1.m1.2.2.1.1.3" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><times id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"></times><ci id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2.3">𝑝</ci><apply id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1"><eq id="S3.E1.m1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1"></eq><apply id="S3.E1.m1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.2.2.1.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2.2.2">𝑣</ci><apply id="S3.E1.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.2.2.3"><plus id="S3.E1.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.2.2.3.1"></plus><ci id="S3.E1.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2.2.3.2">𝑛</ci><cn id="S3.E1.m1.2.2.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑢</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.3"><csymbol cd="latexml" id="S3.E1.m1.2.2.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.3.1">conditional</csymbol><ci id="S3.E1.m1.2.2.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.3.2">𝑣</ci><apply id="S3.E1.m1.2.2.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.3.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.3.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3.2">𝒮</ci><ci id="S3.E1.m1.2.2.1.1.1.3.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">p(v_{n+1}^{(u)}=v|\mathcal{S}_{u})</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.2d">italic_p ( italic_v start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT = italic_v | caligraphic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Full-Scale Matryoshka Representation Learning for Recommendation</h3>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="509" id="S3.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>fMRLRec-based weight design, white cells indicate zeros and arrows show vector-matrix multiplication. Input slice <math alttext="[0:m]" class="ltx_Math" display="inline" id="S3.F1.3.m1.1"><semantics id="S3.F1.3.m1.1b"><mrow id="S3.F1.3.m1.1.1.1" xref="S3.F1.3.m1.1.1.2.cmml"><mo id="S3.F1.3.m1.1.1.1.2" stretchy="false" xref="S3.F1.3.m1.1.1.2.1.cmml">[</mo><mrow id="S3.F1.3.m1.1.1.1.1" xref="S3.F1.3.m1.1.1.1.1.cmml"><mn id="S3.F1.3.m1.1.1.1.1.2" xref="S3.F1.3.m1.1.1.1.1.2.cmml">0</mn><mo id="S3.F1.3.m1.1.1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.F1.3.m1.1.1.1.1.1.cmml">:</mo><mi id="S3.F1.3.m1.1.1.1.1.3" xref="S3.F1.3.m1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S3.F1.3.m1.1.1.1.3" stretchy="false" xref="S3.F1.3.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.3.m1.1c"><apply id="S3.F1.3.m1.1.1.2.cmml" xref="S3.F1.3.m1.1.1.1"><csymbol cd="latexml" id="S3.F1.3.m1.1.1.2.1.cmml" xref="S3.F1.3.m1.1.1.1.2">delimited-[]</csymbol><apply id="S3.F1.3.m1.1.1.1.1.cmml" xref="S3.F1.3.m1.1.1.1.1"><ci id="S3.F1.3.m1.1.1.1.1.1.cmml" xref="S3.F1.3.m1.1.1.1.1.1">:</ci><cn id="S3.F1.3.m1.1.1.1.1.2.cmml" type="integer" xref="S3.F1.3.m1.1.1.1.1.2">0</cn><ci id="S3.F1.3.m1.1.1.1.1.3.cmml" xref="S3.F1.3.m1.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.3.m1.1d">[0:m]</annotation><annotation encoding="application/x-llamapun" id="S3.F1.3.m1.1e">[ 0 : italic_m ]</annotation></semantics></math> is only relevant to weight matrix slice <math alttext="[0:m,0:km]" class="ltx_Math" display="inline" id="S3.F1.4.m2.3"><semantics id="S3.F1.4.m2.3b"><mrow id="S3.F1.4.m2.3.3.1" xref="S3.F1.4.m2.3.3.2.cmml"><mo id="S3.F1.4.m2.3.3.1.2" stretchy="false" xref="S3.F1.4.m2.3.3.2.1.cmml">[</mo><mrow id="S3.F1.4.m2.3.3.1.1" xref="S3.F1.4.m2.3.3.1.1.cmml"><mn id="S3.F1.4.m2.3.3.1.1.2" xref="S3.F1.4.m2.3.3.1.1.2.cmml">0</mn><mo id="S3.F1.4.m2.3.3.1.1.3" lspace="0.278em" rspace="0.278em" xref="S3.F1.4.m2.3.3.1.1.3.cmml">:</mo><mrow id="S3.F1.4.m2.3.3.1.1.4.2" xref="S3.F1.4.m2.3.3.1.1.4.1.cmml"><mi id="S3.F1.4.m2.1.1" xref="S3.F1.4.m2.1.1.cmml">m</mi><mo id="S3.F1.4.m2.3.3.1.1.4.2.1" xref="S3.F1.4.m2.3.3.1.1.4.1.cmml">,</mo><mn id="S3.F1.4.m2.2.2" xref="S3.F1.4.m2.2.2.cmml">0</mn></mrow><mo id="S3.F1.4.m2.3.3.1.1.5" lspace="0.278em" rspace="0.278em" xref="S3.F1.4.m2.3.3.1.1.5.cmml">:</mo><mrow id="S3.F1.4.m2.3.3.1.1.6" xref="S3.F1.4.m2.3.3.1.1.6.cmml"><mi id="S3.F1.4.m2.3.3.1.1.6.2" xref="S3.F1.4.m2.3.3.1.1.6.2.cmml">k</mi><mo id="S3.F1.4.m2.3.3.1.1.6.1" xref="S3.F1.4.m2.3.3.1.1.6.1.cmml">⁢</mo><mi id="S3.F1.4.m2.3.3.1.1.6.3" xref="S3.F1.4.m2.3.3.1.1.6.3.cmml">m</mi></mrow></mrow><mo id="S3.F1.4.m2.3.3.1.3" stretchy="false" xref="S3.F1.4.m2.3.3.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.4.m2.3c"><apply id="S3.F1.4.m2.3.3.2.cmml" xref="S3.F1.4.m2.3.3.1"><csymbol cd="latexml" id="S3.F1.4.m2.3.3.2.1.cmml" xref="S3.F1.4.m2.3.3.1.2">delimited-[]</csymbol><apply id="S3.F1.4.m2.3.3.1.1.cmml" xref="S3.F1.4.m2.3.3.1.1"><and id="S3.F1.4.m2.3.3.1.1a.cmml" xref="S3.F1.4.m2.3.3.1.1"></and><apply id="S3.F1.4.m2.3.3.1.1b.cmml" xref="S3.F1.4.m2.3.3.1.1"><ci id="S3.F1.4.m2.3.3.1.1.3.cmml" xref="S3.F1.4.m2.3.3.1.1.3">:</ci><cn id="S3.F1.4.m2.3.3.1.1.2.cmml" type="integer" xref="S3.F1.4.m2.3.3.1.1.2">0</cn><list id="S3.F1.4.m2.3.3.1.1.4.1.cmml" xref="S3.F1.4.m2.3.3.1.1.4.2"><ci id="S3.F1.4.m2.1.1.cmml" xref="S3.F1.4.m2.1.1">𝑚</ci><cn id="S3.F1.4.m2.2.2.cmml" type="integer" xref="S3.F1.4.m2.2.2">0</cn></list></apply><apply id="S3.F1.4.m2.3.3.1.1c.cmml" xref="S3.F1.4.m2.3.3.1.1"><ci id="S3.F1.4.m2.3.3.1.1.5.cmml" xref="S3.F1.4.m2.3.3.1.1.5">:</ci><share href="https://arxiv.org/html/2409.16627v2#S3.F1.4.m2.3.3.1.1.4.cmml" id="S3.F1.4.m2.3.3.1.1d.cmml" xref="S3.F1.4.m2.3.3.1.1"></share><apply id="S3.F1.4.m2.3.3.1.1.6.cmml" xref="S3.F1.4.m2.3.3.1.1.6"><times id="S3.F1.4.m2.3.3.1.1.6.1.cmml" xref="S3.F1.4.m2.3.3.1.1.6.1"></times><ci id="S3.F1.4.m2.3.3.1.1.6.2.cmml" xref="S3.F1.4.m2.3.3.1.1.6.2">𝑘</ci><ci id="S3.F1.4.m2.3.3.1.1.6.3.cmml" xref="S3.F1.4.m2.3.3.1.1.6.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.4.m2.3d">[0:m,0:km]</annotation><annotation encoding="application/x-llamapun" id="S3.F1.4.m2.3e">[ 0 : italic_m , 0 : italic_k italic_m ]</annotation></semantics></math> during training, convenient for variously-sized model weights extraction during inference time.</figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.14">In this section, we elaborate on how we design the full-scale Matryoshka Representation Learning for multimodal sequential recommendation (fMRLRec). The majority of model parameters in neural networks can be represented with a set of 2-dimensional weights <math alttext="\mathcal{W}=\{W_{1},W_{2},\ldots,W_{n}\}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.4"><semantics id="S3.SS2.p1.1.m1.4a"><mrow id="S3.SS2.p1.1.m1.4.4" xref="S3.SS2.p1.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.4.4.5" xref="S3.SS2.p1.1.m1.4.4.5.cmml">𝒲</mi><mo id="S3.SS2.p1.1.m1.4.4.4" xref="S3.SS2.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.4.4.3.3" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml"><mo id="S3.SS2.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S3.SS2.p1.1.m1.2.2.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.1.1.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml">W</mi><mn id="S3.SS2.p1.1.m1.2.2.1.1.1.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.1.m1.4.4.3.3.5" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.1.m1.3.3.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.3.3.2.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml">W</mi><mn id="S3.SS2.p1.1.m1.3.3.2.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p1.1.m1.4.4.3.3.6" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS2.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS2.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p1.1.m1.4.4.3.3.7" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.1.m1.4.4.3.3.3" xref="S3.SS2.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS2.p1.1.m1.4.4.3.3.3.2" xref="S3.SS2.p1.1.m1.4.4.3.3.3.2.cmml">W</mi><mi id="S3.SS2.p1.1.m1.4.4.3.3.3.3" xref="S3.SS2.p1.1.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S3.SS2.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.4b"><apply id="S3.SS2.p1.1.m1.4.4.cmml" xref="S3.SS2.p1.1.m1.4.4"><eq id="S3.SS2.p1.1.m1.4.4.4.cmml" xref="S3.SS2.p1.1.m1.4.4.4"></eq><ci id="S3.SS2.p1.1.m1.4.4.5.cmml" xref="S3.SS2.p1.1.m1.4.4.5">𝒲</ci><set id="S3.SS2.p1.1.m1.4.4.3.4.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3"><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2">𝑊</ci><cn id="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2">𝑊</ci><cn id="S3.SS2.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">…</ci><apply id="S3.SS2.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3.2">𝑊</ci><ci id="S3.SS2.p1.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.4c">\mathcal{W}=\{W_{1},W_{2},\ldots,W_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.4d">caligraphic_W = { italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_W start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> where <math alttext="W_{i}\in\mathbb{R}^{d_{1}\times d_{2}},i\in\{1,2,\ldots,n\}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.6"><semantics id="S3.SS2.p1.2.m2.6a"><mrow id="S3.SS2.p1.2.m2.6.6.2" xref="S3.SS2.p1.2.m2.6.6.3.cmml"><mrow id="S3.SS2.p1.2.m2.5.5.1.1" xref="S3.SS2.p1.2.m2.5.5.1.1.cmml"><msub id="S3.SS2.p1.2.m2.5.5.1.1.2" xref="S3.SS2.p1.2.m2.5.5.1.1.2.cmml"><mi id="S3.SS2.p1.2.m2.5.5.1.1.2.2" xref="S3.SS2.p1.2.m2.5.5.1.1.2.2.cmml">W</mi><mi id="S3.SS2.p1.2.m2.5.5.1.1.2.3" xref="S3.SS2.p1.2.m2.5.5.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.2.m2.5.5.1.1.1" xref="S3.SS2.p1.2.m2.5.5.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.2.m2.5.5.1.1.3" xref="S3.SS2.p1.2.m2.5.5.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.5.5.1.1.3.2" xref="S3.SS2.p1.2.m2.5.5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.2.m2.5.5.1.1.3.3" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.cmml"><msub id="S3.SS2.p1.2.m2.5.5.1.1.3.3.2" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.2.cmml"><mi id="S3.SS2.p1.2.m2.5.5.1.1.3.3.2.2" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.2.2.cmml">d</mi><mn id="S3.SS2.p1.2.m2.5.5.1.1.3.3.2.3" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.2.3.cmml">1</mn></msub><mo id="S3.SS2.p1.2.m2.5.5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p1.2.m2.5.5.1.1.3.3.3" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.2.m2.5.5.1.1.3.3.3.2" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.3.2.cmml">d</mi><mn id="S3.SS2.p1.2.m2.5.5.1.1.3.3.3.3" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.3.3.cmml">2</mn></msub></mrow></msup></mrow><mo id="S3.SS2.p1.2.m2.6.6.2.3" xref="S3.SS2.p1.2.m2.6.6.3a.cmml">,</mo><mrow id="S3.SS2.p1.2.m2.6.6.2.2" xref="S3.SS2.p1.2.m2.6.6.2.2.cmml"><mi id="S3.SS2.p1.2.m2.6.6.2.2.2" xref="S3.SS2.p1.2.m2.6.6.2.2.2.cmml">i</mi><mo id="S3.SS2.p1.2.m2.6.6.2.2.1" xref="S3.SS2.p1.2.m2.6.6.2.2.1.cmml">∈</mo><mrow id="S3.SS2.p1.2.m2.6.6.2.2.3.2" xref="S3.SS2.p1.2.m2.6.6.2.2.3.1.cmml"><mo id="S3.SS2.p1.2.m2.6.6.2.2.3.2.1" stretchy="false" xref="S3.SS2.p1.2.m2.6.6.2.2.3.1.cmml">{</mo><mn id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">1</mn><mo id="S3.SS2.p1.2.m2.6.6.2.2.3.2.2" xref="S3.SS2.p1.2.m2.6.6.2.2.3.1.cmml">,</mo><mn id="S3.SS2.p1.2.m2.2.2" xref="S3.SS2.p1.2.m2.2.2.cmml">2</mn><mo id="S3.SS2.p1.2.m2.6.6.2.2.3.2.3" xref="S3.SS2.p1.2.m2.6.6.2.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.2.m2.3.3" mathvariant="normal" xref="S3.SS2.p1.2.m2.3.3.cmml">…</mi><mo id="S3.SS2.p1.2.m2.6.6.2.2.3.2.4" xref="S3.SS2.p1.2.m2.6.6.2.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.2.m2.4.4" xref="S3.SS2.p1.2.m2.4.4.cmml">n</mi><mo id="S3.SS2.p1.2.m2.6.6.2.2.3.2.5" stretchy="false" xref="S3.SS2.p1.2.m2.6.6.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.6b"><apply id="S3.SS2.p1.2.m2.6.6.3.cmml" xref="S3.SS2.p1.2.m2.6.6.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.6.6.3a.cmml" xref="S3.SS2.p1.2.m2.6.6.2.3">formulae-sequence</csymbol><apply id="S3.SS2.p1.2.m2.5.5.1.1.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1"><in id="S3.SS2.p1.2.m2.5.5.1.1.1.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.1"></in><apply id="S3.SS2.p1.2.m2.5.5.1.1.2.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.5.5.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.5.5.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.2.2">𝑊</ci><ci id="S3.SS2.p1.2.m2.5.5.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.2.m2.5.5.1.1.3.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.5.5.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.5.5.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.2.m2.5.5.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3"><times id="S3.SS2.p1.2.m2.5.5.1.1.3.3.1.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.1"></times><apply id="S3.SS2.p1.2.m2.5.5.1.1.3.3.2.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.5.5.1.1.3.3.2.1.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.5.5.1.1.3.3.2.2.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.2.2">𝑑</ci><cn id="S3.SS2.p1.2.m2.5.5.1.1.3.3.2.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.2.3">1</cn></apply><apply id="S3.SS2.p1.2.m2.5.5.1.1.3.3.3.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.5.5.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.5.5.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.3.2">𝑑</ci><cn id="S3.SS2.p1.2.m2.5.5.1.1.3.3.3.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.5.5.1.1.3.3.3.3">2</cn></apply></apply></apply></apply><apply id="S3.SS2.p1.2.m2.6.6.2.2.cmml" xref="S3.SS2.p1.2.m2.6.6.2.2"><in id="S3.SS2.p1.2.m2.6.6.2.2.1.cmml" xref="S3.SS2.p1.2.m2.6.6.2.2.1"></in><ci id="S3.SS2.p1.2.m2.6.6.2.2.2.cmml" xref="S3.SS2.p1.2.m2.6.6.2.2.2">𝑖</ci><set id="S3.SS2.p1.2.m2.6.6.2.2.3.1.cmml" xref="S3.SS2.p1.2.m2.6.6.2.2.3.2"><cn id="S3.SS2.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1">1</cn><cn id="S3.SS2.p1.2.m2.2.2.cmml" type="integer" xref="S3.SS2.p1.2.m2.2.2">2</cn><ci id="S3.SS2.p1.2.m2.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3">…</ci><ci id="S3.SS2.p1.2.m2.4.4.cmml" xref="S3.SS2.p1.2.m2.4.4">𝑛</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.6c">W_{i}\in\mathbb{R}^{d_{1}\times d_{2}},i\in\{1,2,\ldots,n\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.6d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_i ∈ { 1 , 2 , … , italic_n }</annotation></semantics></math>, regardless of specific model architecture. Intuitively, fMRLRec aims to design the <math alttext="W_{i}\in\mathcal{W}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><msub id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">W</mi><mi id="S3.SS2.p1.3.m3.1.1.2.3" xref="S3.SS2.p1.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">𝒲</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><in id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></in><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">𝑊</ci><ci id="S3.SS2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝒲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">W_{i}\in\mathcal{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_W</annotation></semantics></math> s.t. models of differently sizes <math alttext="\mathcal{M}=[2,4,8,16,\ldots,D]" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.6"><semantics id="S3.SS2.p1.4.m4.6a"><mrow id="S3.SS2.p1.4.m4.6.7" xref="S3.SS2.p1.4.m4.6.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.6.7.2" xref="S3.SS2.p1.4.m4.6.7.2.cmml">ℳ</mi><mo id="S3.SS2.p1.4.m4.6.7.1" xref="S3.SS2.p1.4.m4.6.7.1.cmml">=</mo><mrow id="S3.SS2.p1.4.m4.6.7.3.2" xref="S3.SS2.p1.4.m4.6.7.3.1.cmml"><mo id="S3.SS2.p1.4.m4.6.7.3.2.1" stretchy="false" xref="S3.SS2.p1.4.m4.6.7.3.1.cmml">[</mo><mn id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">2</mn><mo id="S3.SS2.p1.4.m4.6.7.3.2.2" xref="S3.SS2.p1.4.m4.6.7.3.1.cmml">,</mo><mn id="S3.SS2.p1.4.m4.2.2" xref="S3.SS2.p1.4.m4.2.2.cmml">4</mn><mo id="S3.SS2.p1.4.m4.6.7.3.2.3" xref="S3.SS2.p1.4.m4.6.7.3.1.cmml">,</mo><mn id="S3.SS2.p1.4.m4.3.3" xref="S3.SS2.p1.4.m4.3.3.cmml">8</mn><mo id="S3.SS2.p1.4.m4.6.7.3.2.4" xref="S3.SS2.p1.4.m4.6.7.3.1.cmml">,</mo><mn id="S3.SS2.p1.4.m4.4.4" xref="S3.SS2.p1.4.m4.4.4.cmml">16</mn><mo id="S3.SS2.p1.4.m4.6.7.3.2.5" xref="S3.SS2.p1.4.m4.6.7.3.1.cmml">,</mo><mi id="S3.SS2.p1.4.m4.5.5" mathvariant="normal" xref="S3.SS2.p1.4.m4.5.5.cmml">…</mi><mo id="S3.SS2.p1.4.m4.6.7.3.2.6" xref="S3.SS2.p1.4.m4.6.7.3.1.cmml">,</mo><mi id="S3.SS2.p1.4.m4.6.6" xref="S3.SS2.p1.4.m4.6.6.cmml">D</mi><mo id="S3.SS2.p1.4.m4.6.7.3.2.7" stretchy="false" xref="S3.SS2.p1.4.m4.6.7.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.6b"><apply id="S3.SS2.p1.4.m4.6.7.cmml" xref="S3.SS2.p1.4.m4.6.7"><eq id="S3.SS2.p1.4.m4.6.7.1.cmml" xref="S3.SS2.p1.4.m4.6.7.1"></eq><ci id="S3.SS2.p1.4.m4.6.7.2.cmml" xref="S3.SS2.p1.4.m4.6.7.2">ℳ</ci><list id="S3.SS2.p1.4.m4.6.7.3.1.cmml" xref="S3.SS2.p1.4.m4.6.7.3.2"><cn id="S3.SS2.p1.4.m4.1.1.cmml" type="integer" xref="S3.SS2.p1.4.m4.1.1">2</cn><cn id="S3.SS2.p1.4.m4.2.2.cmml" type="integer" xref="S3.SS2.p1.4.m4.2.2">4</cn><cn id="S3.SS2.p1.4.m4.3.3.cmml" type="integer" xref="S3.SS2.p1.4.m4.3.3">8</cn><cn id="S3.SS2.p1.4.m4.4.4.cmml" type="integer" xref="S3.SS2.p1.4.m4.4.4">16</cn><ci id="S3.SS2.p1.4.m4.5.5.cmml" xref="S3.SS2.p1.4.m4.5.5">…</ci><ci id="S3.SS2.p1.4.m4.6.6.cmml" xref="S3.SS2.p1.4.m4.6.6">𝐷</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.6c">\mathcal{M}=[2,4,8,16,\ldots,D]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.6d">caligraphic_M = [ 2 , 4 , 8 , 16 , … , italic_D ]</annotation></semantics></math> are trained only once at the same cost of only training size-<math alttext="D" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_D</annotation></semantics></math> model. After training, any model sizes in <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">caligraphic_M</annotation></semantics></math> can be extracted from the size-<math alttext="D" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">italic_D</annotation></semantics></math> model to form <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.14.1">independent</span> small models for deployment. To achieve this goal, fMRLRec allows small models to be <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.14.2">embedded</span> in the largest model. Define sequential input as <math alttext="X_{i}\in\mathbb{R}^{B\times L\times D}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><mrow id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><msub id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml"><mi id="S3.SS2.p1.8.m8.1.1.2.2" xref="S3.SS2.p1.8.m8.1.1.2.2.cmml">X</mi><mi id="S3.SS2.p1.8.m8.1.1.2.3" xref="S3.SS2.p1.8.m8.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.8.m8.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml"><mi id="S3.SS2.p1.8.m8.1.1.3.2" xref="S3.SS2.p1.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.8.m8.1.1.3.3" xref="S3.SS2.p1.8.m8.1.1.3.3.cmml"><mi id="S3.SS2.p1.8.m8.1.1.3.3.2" xref="S3.SS2.p1.8.m8.1.1.3.3.2.cmml">B</mi><mo id="S3.SS2.p1.8.m8.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.8.m8.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.8.m8.1.1.3.3.3" xref="S3.SS2.p1.8.m8.1.1.3.3.3.cmml">L</mi><mo id="S3.SS2.p1.8.m8.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.8.m8.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.8.m8.1.1.3.3.4" xref="S3.SS2.p1.8.m8.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><in id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1"></in><apply id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.2.1.cmml" xref="S3.SS2.p1.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2.2">𝑋</ci><ci id="S3.SS2.p1.8.m8.1.1.2.3.cmml" xref="S3.SS2.p1.8.m8.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.3.1.cmml" xref="S3.SS2.p1.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.3.2.cmml" xref="S3.SS2.p1.8.m8.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.8.m8.1.1.3.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3.3"><times id="S3.SS2.p1.8.m8.1.1.3.3.1.cmml" xref="S3.SS2.p1.8.m8.1.1.3.3.1"></times><ci id="S3.SS2.p1.8.m8.1.1.3.3.2.cmml" xref="S3.SS2.p1.8.m8.1.1.3.3.2">𝐵</ci><ci id="S3.SS2.p1.8.m8.1.1.3.3.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3.3.3">𝐿</ci><ci id="S3.SS2.p1.8.m8.1.1.3.3.4.cmml" xref="S3.SS2.p1.8.m8.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">X_{i}\in\mathbb{R}^{B\times L\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> to be processed by <math alttext="\mathcal{W}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.1"><semantics id="S3.SS2.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><ci id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\mathcal{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.1d">caligraphic_W</annotation></semantics></math>, where <math alttext="B" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m10.1"><semantics id="S3.SS2.p1.10.m10.1a"><mi id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><ci id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m10.1d">italic_B</annotation></semantics></math> is batch size, <math alttext="L" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m11.1"><semantics id="S3.SS2.p1.11.m11.1a"><mi id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><ci id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m11.1d">italic_L</annotation></semantics></math> is item sequence length and <math alttext="D" class="ltx_Math" display="inline" id="S3.SS2.p1.12.m12.1"><semantics id="S3.SS2.p1.12.m12.1a"><mi id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><ci id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.12.m12.1d">italic_D</annotation></semantics></math> is the embedding size, there are three cases for the shape of <math alttext="W_{i}\in\mathbb{R}^{d_{1}\times d_{2}}" class="ltx_Math" display="inline" id="S3.SS2.p1.13.m13.1"><semantics id="S3.SS2.p1.13.m13.1a"><mrow id="S3.SS2.p1.13.m13.1.1" xref="S3.SS2.p1.13.m13.1.1.cmml"><msub id="S3.SS2.p1.13.m13.1.1.2" xref="S3.SS2.p1.13.m13.1.1.2.cmml"><mi id="S3.SS2.p1.13.m13.1.1.2.2" xref="S3.SS2.p1.13.m13.1.1.2.2.cmml">W</mi><mi id="S3.SS2.p1.13.m13.1.1.2.3" xref="S3.SS2.p1.13.m13.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.13.m13.1.1.1" xref="S3.SS2.p1.13.m13.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.13.m13.1.1.3" xref="S3.SS2.p1.13.m13.1.1.3.cmml"><mi id="S3.SS2.p1.13.m13.1.1.3.2" xref="S3.SS2.p1.13.m13.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.13.m13.1.1.3.3" xref="S3.SS2.p1.13.m13.1.1.3.3.cmml"><msub id="S3.SS2.p1.13.m13.1.1.3.3.2" xref="S3.SS2.p1.13.m13.1.1.3.3.2.cmml"><mi id="S3.SS2.p1.13.m13.1.1.3.3.2.2" xref="S3.SS2.p1.13.m13.1.1.3.3.2.2.cmml">d</mi><mn id="S3.SS2.p1.13.m13.1.1.3.3.2.3" xref="S3.SS2.p1.13.m13.1.1.3.3.2.3.cmml">1</mn></msub><mo id="S3.SS2.p1.13.m13.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.13.m13.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p1.13.m13.1.1.3.3.3" xref="S3.SS2.p1.13.m13.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.13.m13.1.1.3.3.3.2" xref="S3.SS2.p1.13.m13.1.1.3.3.3.2.cmml">d</mi><mn id="S3.SS2.p1.13.m13.1.1.3.3.3.3" xref="S3.SS2.p1.13.m13.1.1.3.3.3.3.cmml">2</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m13.1b"><apply id="S3.SS2.p1.13.m13.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1"><in id="S3.SS2.p1.13.m13.1.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1.1"></in><apply id="S3.SS2.p1.13.m13.1.1.2.cmml" xref="S3.SS2.p1.13.m13.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m13.1.1.2.1.cmml" xref="S3.SS2.p1.13.m13.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.13.m13.1.1.2.2.cmml" xref="S3.SS2.p1.13.m13.1.1.2.2">𝑊</ci><ci id="S3.SS2.p1.13.m13.1.1.2.3.cmml" xref="S3.SS2.p1.13.m13.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.13.m13.1.1.3.cmml" xref="S3.SS2.p1.13.m13.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m13.1.1.3.1.cmml" xref="S3.SS2.p1.13.m13.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.13.m13.1.1.3.2.cmml" xref="S3.SS2.p1.13.m13.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.13.m13.1.1.3.3.cmml" xref="S3.SS2.p1.13.m13.1.1.3.3"><times id="S3.SS2.p1.13.m13.1.1.3.3.1.cmml" xref="S3.SS2.p1.13.m13.1.1.3.3.1"></times><apply id="S3.SS2.p1.13.m13.1.1.3.3.2.cmml" xref="S3.SS2.p1.13.m13.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m13.1.1.3.3.2.1.cmml" xref="S3.SS2.p1.13.m13.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.p1.13.m13.1.1.3.3.2.2.cmml" xref="S3.SS2.p1.13.m13.1.1.3.3.2.2">𝑑</ci><cn id="S3.SS2.p1.13.m13.1.1.3.3.2.3.cmml" type="integer" xref="S3.SS2.p1.13.m13.1.1.3.3.2.3">1</cn></apply><apply id="S3.SS2.p1.13.m13.1.1.3.3.3.cmml" xref="S3.SS2.p1.13.m13.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m13.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.13.m13.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.13.m13.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.13.m13.1.1.3.3.3.2">𝑑</ci><cn id="S3.SS2.p1.13.m13.1.1.3.3.3.3.cmml" type="integer" xref="S3.SS2.p1.13.m13.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m13.1c">W_{i}\in\mathbb{R}^{d_{1}\times d_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.13.m13.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, denoted as <math alttext="D(W_{i})" class="ltx_Math" display="inline" id="S3.SS2.p1.14.m14.1"><semantics id="S3.SS2.p1.14.m14.1a"><mrow id="S3.SS2.p1.14.m14.1.1" xref="S3.SS2.p1.14.m14.1.1.cmml"><mi id="S3.SS2.p1.14.m14.1.1.3" xref="S3.SS2.p1.14.m14.1.1.3.cmml">D</mi><mo id="S3.SS2.p1.14.m14.1.1.2" xref="S3.SS2.p1.14.m14.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.14.m14.1.1.1.1" xref="S3.SS2.p1.14.m14.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.14.m14.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.14.m14.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.14.m14.1.1.1.1.1" xref="S3.SS2.p1.14.m14.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.14.m14.1.1.1.1.1.2" xref="S3.SS2.p1.14.m14.1.1.1.1.1.2.cmml">W</mi><mi id="S3.SS2.p1.14.m14.1.1.1.1.1.3" xref="S3.SS2.p1.14.m14.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p1.14.m14.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.14.m14.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m14.1b"><apply id="S3.SS2.p1.14.m14.1.1.cmml" xref="S3.SS2.p1.14.m14.1.1"><times id="S3.SS2.p1.14.m14.1.1.2.cmml" xref="S3.SS2.p1.14.m14.1.1.2"></times><ci id="S3.SS2.p1.14.m14.1.1.3.cmml" xref="S3.SS2.p1.14.m14.1.1.3">𝐷</ci><apply id="S3.SS2.p1.14.m14.1.1.1.1.1.cmml" xref="S3.SS2.p1.14.m14.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.14.m14.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.14.m14.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.14.m14.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.14.m14.1.1.1.1.1.2">𝑊</ci><ci id="S3.SS2.p1.14.m14.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.14.m14.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m14.1c">D(W_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.14.m14.1d">italic_D ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{D}(\mathbf{W}_{i})=\begin{cases}\mathbf{D}\times\mathbf{k}\mathbf{D}&amp;%
\text{if }\mathbf{d}_{1}&lt;\mathbf{d}_{2}\\
\mathbf{k}\mathbf{D}\times\mathbf{D}&amp;\text{if }\mathbf{d}_{1}&gt;\mathbf{d}_{2}\\
\mathbf{D}\times\mathbf{D}&amp;\text{if }\mathbf{d}_{1}=\mathbf{d}_{2}\end{cases}" class="ltx_Math" display="block" id="S3.E2.m1.7"><semantics id="S3.E2.m1.7a"><mrow id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml"><mrow id="S3.E2.m1.7.7.1" xref="S3.E2.m1.7.7.1.cmml"><mi id="S3.E2.m1.7.7.1.3" xref="S3.E2.m1.7.7.1.3.cmml">𝐃</mi><mo id="S3.E2.m1.7.7.1.2" xref="S3.E2.m1.7.7.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.7.7.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.cmml"><mo id="S3.E2.m1.7.7.1.1.1.2" stretchy="false" xref="S3.E2.m1.7.7.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.7.7.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.2.cmml">𝐖</mi><mi id="S3.E2.m1.7.7.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.m1.7.7.1.1.1.3" stretchy="false" xref="S3.E2.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.7.7.2" xref="S3.E2.m1.7.7.2.cmml">=</mo><mrow id="S3.E2.m1.6.6" xref="S3.E2.m1.7.7.3.1.cmml"><mo id="S3.E2.m1.6.6.7" xref="S3.E2.m1.7.7.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E2.m1.6.6.6" rowspacing="0pt" xref="S3.E2.m1.7.7.3.1.cmml"><mtr id="S3.E2.m1.6.6.6a" xref="S3.E2.m1.7.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.6.6.6b" xref="S3.E2.m1.7.7.3.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.2.cmml">𝐃</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">×</mo><mi id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml">𝐤𝐃</mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.6.6.6c" xref="S3.E2.m1.7.7.3.1.cmml"><mrow id="S3.E2.m1.2.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.2.1.cmml"><mrow id="S3.E2.m1.2.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.2.1.2.cmml"><mtext id="S3.E2.m1.2.2.2.2.2.1.2.2" xref="S3.E2.m1.2.2.2.2.2.1.2.2a.cmml">if </mtext><mo id="S3.E2.m1.2.2.2.2.2.1.2.1" xref="S3.E2.m1.2.2.2.2.2.1.2.1.cmml">⁢</mo><msub id="S3.E2.m1.2.2.2.2.2.1.2.3" xref="S3.E2.m1.2.2.2.2.2.1.2.3.cmml"><mi id="S3.E2.m1.2.2.2.2.2.1.2.3.2" xref="S3.E2.m1.2.2.2.2.2.1.2.3.2.cmml">𝐝</mi><mn id="S3.E2.m1.2.2.2.2.2.1.2.3.3" xref="S3.E2.m1.2.2.2.2.2.1.2.3.3.cmml">1</mn></msub></mrow><mo id="S3.E2.m1.2.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.2.1.1.cmml">&lt;</mo><msub id="S3.E2.m1.2.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.2.1.3.cmml"><mi id="S3.E2.m1.2.2.2.2.2.1.3.2" xref="S3.E2.m1.2.2.2.2.2.1.3.2.cmml">𝐝</mi><mn id="S3.E2.m1.2.2.2.2.2.1.3.3" xref="S3.E2.m1.2.2.2.2.2.1.3.3.cmml">2</mn></msub></mrow></mtd></mtr><mtr id="S3.E2.m1.6.6.6d" xref="S3.E2.m1.7.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.6.6.6e" xref="S3.E2.m1.7.7.3.1.cmml"><mrow id="S3.E2.m1.3.3.3.3.1.1" xref="S3.E2.m1.3.3.3.3.1.1.cmml"><mi id="S3.E2.m1.3.3.3.3.1.1.2" xref="S3.E2.m1.3.3.3.3.1.1.2.cmml">𝐤𝐃</mi><mo id="S3.E2.m1.3.3.3.3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.3.3.3.3.1.1.1.cmml">×</mo><mi id="S3.E2.m1.3.3.3.3.1.1.3" xref="S3.E2.m1.3.3.3.3.1.1.3.cmml">𝐃</mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.6.6.6f" xref="S3.E2.m1.7.7.3.1.cmml"><mrow id="S3.E2.m1.4.4.4.4.2.1" xref="S3.E2.m1.4.4.4.4.2.1.cmml"><mrow id="S3.E2.m1.4.4.4.4.2.1.2" xref="S3.E2.m1.4.4.4.4.2.1.2.cmml"><mtext id="S3.E2.m1.4.4.4.4.2.1.2.2" xref="S3.E2.m1.4.4.4.4.2.1.2.2a.cmml">if </mtext><mo id="S3.E2.m1.4.4.4.4.2.1.2.1" xref="S3.E2.m1.4.4.4.4.2.1.2.1.cmml">⁢</mo><msub id="S3.E2.m1.4.4.4.4.2.1.2.3" xref="S3.E2.m1.4.4.4.4.2.1.2.3.cmml"><mi id="S3.E2.m1.4.4.4.4.2.1.2.3.2" xref="S3.E2.m1.4.4.4.4.2.1.2.3.2.cmml">𝐝</mi><mn id="S3.E2.m1.4.4.4.4.2.1.2.3.3" xref="S3.E2.m1.4.4.4.4.2.1.2.3.3.cmml">1</mn></msub></mrow><mo id="S3.E2.m1.4.4.4.4.2.1.1" xref="S3.E2.m1.4.4.4.4.2.1.1.cmml">&gt;</mo><msub id="S3.E2.m1.4.4.4.4.2.1.3" xref="S3.E2.m1.4.4.4.4.2.1.3.cmml"><mi id="S3.E2.m1.4.4.4.4.2.1.3.2" xref="S3.E2.m1.4.4.4.4.2.1.3.2.cmml">𝐝</mi><mn id="S3.E2.m1.4.4.4.4.2.1.3.3" xref="S3.E2.m1.4.4.4.4.2.1.3.3.cmml">2</mn></msub></mrow></mtd></mtr><mtr id="S3.E2.m1.6.6.6g" xref="S3.E2.m1.7.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.6.6.6h" xref="S3.E2.m1.7.7.3.1.cmml"><mrow id="S3.E2.m1.5.5.5.5.1.1" xref="S3.E2.m1.5.5.5.5.1.1.cmml"><mi id="S3.E2.m1.5.5.5.5.1.1.2" xref="S3.E2.m1.5.5.5.5.1.1.2.cmml">𝐃</mi><mo id="S3.E2.m1.5.5.5.5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.5.5.5.5.1.1.1.cmml">×</mo><mi id="S3.E2.m1.5.5.5.5.1.1.3" xref="S3.E2.m1.5.5.5.5.1.1.3.cmml">𝐃</mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.6.6.6i" xref="S3.E2.m1.7.7.3.1.cmml"><mrow id="S3.E2.m1.6.6.6.6.2.1" xref="S3.E2.m1.6.6.6.6.2.1.cmml"><mrow id="S3.E2.m1.6.6.6.6.2.1.2" xref="S3.E2.m1.6.6.6.6.2.1.2.cmml"><mtext id="S3.E2.m1.6.6.6.6.2.1.2.2" xref="S3.E2.m1.6.6.6.6.2.1.2.2a.cmml">if </mtext><mo id="S3.E2.m1.6.6.6.6.2.1.2.1" xref="S3.E2.m1.6.6.6.6.2.1.2.1.cmml">⁢</mo><msub id="S3.E2.m1.6.6.6.6.2.1.2.3" xref="S3.E2.m1.6.6.6.6.2.1.2.3.cmml"><mi id="S3.E2.m1.6.6.6.6.2.1.2.3.2" xref="S3.E2.m1.6.6.6.6.2.1.2.3.2.cmml">𝐝</mi><mn id="S3.E2.m1.6.6.6.6.2.1.2.3.3" xref="S3.E2.m1.6.6.6.6.2.1.2.3.3.cmml">1</mn></msub></mrow><mo id="S3.E2.m1.6.6.6.6.2.1.1" xref="S3.E2.m1.6.6.6.6.2.1.1.cmml">=</mo><msub id="S3.E2.m1.6.6.6.6.2.1.3" xref="S3.E2.m1.6.6.6.6.2.1.3.cmml"><mi id="S3.E2.m1.6.6.6.6.2.1.3.2" xref="S3.E2.m1.6.6.6.6.2.1.3.2.cmml">𝐝</mi><mn id="S3.E2.m1.6.6.6.6.2.1.3.3" xref="S3.E2.m1.6.6.6.6.2.1.3.3.cmml">2</mn></msub></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.7b"><apply id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7"><eq id="S3.E2.m1.7.7.2.cmml" xref="S3.E2.m1.7.7.2"></eq><apply id="S3.E2.m1.7.7.1.cmml" xref="S3.E2.m1.7.7.1"><times id="S3.E2.m1.7.7.1.2.cmml" xref="S3.E2.m1.7.7.1.2"></times><ci id="S3.E2.m1.7.7.1.3.cmml" xref="S3.E2.m1.7.7.1.3">𝐃</ci><apply id="S3.E2.m1.7.7.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2">𝐖</ci><ci id="S3.E2.m1.7.7.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.7.7.3.1.cmml" xref="S3.E2.m1.6.6"><csymbol cd="latexml" id="S3.E2.m1.7.7.3.1.1.cmml" xref="S3.E2.m1.6.6.7">cases</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2">𝐃</ci><ci id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3">𝐤𝐃</ci></apply><apply id="S3.E2.m1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.1"><lt id="S3.E2.m1.2.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.1.1"></lt><apply id="S3.E2.m1.2.2.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.1.2"><times id="S3.E2.m1.2.2.2.2.2.1.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.1.2.1"></times><ci id="S3.E2.m1.2.2.2.2.2.1.2.2a.cmml" xref="S3.E2.m1.2.2.2.2.2.1.2.2"><mtext id="S3.E2.m1.2.2.2.2.2.1.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.1.2.2">if </mtext></ci><apply id="S3.E2.m1.2.2.2.2.2.1.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.1.2.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.1.2.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.1.2.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.1.2.3.2">𝐝</ci><cn id="S3.E2.m1.2.2.2.2.2.1.2.3.3.cmml" type="integer" xref="S3.E2.m1.2.2.2.2.2.1.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.2.2.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.1.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.1.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.1.3.2">𝐝</ci><cn id="S3.E2.m1.2.2.2.2.2.1.3.3.cmml" type="integer" xref="S3.E2.m1.2.2.2.2.2.1.3.3">2</cn></apply></apply><apply id="S3.E2.m1.3.3.3.3.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1"><times id="S3.E2.m1.3.3.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1"></times><ci id="S3.E2.m1.3.3.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.2">𝐤𝐃</ci><ci id="S3.E2.m1.3.3.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.3">𝐃</ci></apply><apply id="S3.E2.m1.4.4.4.4.2.1.cmml" xref="S3.E2.m1.4.4.4.4.2.1"><gt id="S3.E2.m1.4.4.4.4.2.1.1.cmml" xref="S3.E2.m1.4.4.4.4.2.1.1"></gt><apply id="S3.E2.m1.4.4.4.4.2.1.2.cmml" xref="S3.E2.m1.4.4.4.4.2.1.2"><times id="S3.E2.m1.4.4.4.4.2.1.2.1.cmml" xref="S3.E2.m1.4.4.4.4.2.1.2.1"></times><ci id="S3.E2.m1.4.4.4.4.2.1.2.2a.cmml" xref="S3.E2.m1.4.4.4.4.2.1.2.2"><mtext id="S3.E2.m1.4.4.4.4.2.1.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2.1.2.2">if </mtext></ci><apply id="S3.E2.m1.4.4.4.4.2.1.2.3.cmml" xref="S3.E2.m1.4.4.4.4.2.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.1.2.3.1.cmml" xref="S3.E2.m1.4.4.4.4.2.1.2.3">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.2.1.2.3.2.cmml" xref="S3.E2.m1.4.4.4.4.2.1.2.3.2">𝐝</ci><cn id="S3.E2.m1.4.4.4.4.2.1.2.3.3.cmml" type="integer" xref="S3.E2.m1.4.4.4.4.2.1.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.4.4.4.4.2.1.3.cmml" xref="S3.E2.m1.4.4.4.4.2.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.1.3.1.cmml" xref="S3.E2.m1.4.4.4.4.2.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.2.1.3.2.cmml" xref="S3.E2.m1.4.4.4.4.2.1.3.2">𝐝</ci><cn id="S3.E2.m1.4.4.4.4.2.1.3.3.cmml" type="integer" xref="S3.E2.m1.4.4.4.4.2.1.3.3">2</cn></apply></apply><apply id="S3.E2.m1.5.5.5.5.1.1.cmml" xref="S3.E2.m1.5.5.5.5.1.1"><times id="S3.E2.m1.5.5.5.5.1.1.1.cmml" xref="S3.E2.m1.5.5.5.5.1.1.1"></times><ci id="S3.E2.m1.5.5.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.5.5.1.1.2">𝐃</ci><ci id="S3.E2.m1.5.5.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.5.5.1.1.3">𝐃</ci></apply><apply id="S3.E2.m1.6.6.6.6.2.1.cmml" xref="S3.E2.m1.6.6.6.6.2.1"><eq id="S3.E2.m1.6.6.6.6.2.1.1.cmml" xref="S3.E2.m1.6.6.6.6.2.1.1"></eq><apply id="S3.E2.m1.6.6.6.6.2.1.2.cmml" xref="S3.E2.m1.6.6.6.6.2.1.2"><times id="S3.E2.m1.6.6.6.6.2.1.2.1.cmml" xref="S3.E2.m1.6.6.6.6.2.1.2.1"></times><ci id="S3.E2.m1.6.6.6.6.2.1.2.2a.cmml" xref="S3.E2.m1.6.6.6.6.2.1.2.2"><mtext id="S3.E2.m1.6.6.6.6.2.1.2.2.cmml" xref="S3.E2.m1.6.6.6.6.2.1.2.2">if </mtext></ci><apply id="S3.E2.m1.6.6.6.6.2.1.2.3.cmml" xref="S3.E2.m1.6.6.6.6.2.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.6.2.1.2.3.1.cmml" xref="S3.E2.m1.6.6.6.6.2.1.2.3">subscript</csymbol><ci id="S3.E2.m1.6.6.6.6.2.1.2.3.2.cmml" xref="S3.E2.m1.6.6.6.6.2.1.2.3.2">𝐝</ci><cn id="S3.E2.m1.6.6.6.6.2.1.2.3.3.cmml" type="integer" xref="S3.E2.m1.6.6.6.6.2.1.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.6.6.6.6.2.1.3.cmml" xref="S3.E2.m1.6.6.6.6.2.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.6.2.1.3.1.cmml" xref="S3.E2.m1.6.6.6.6.2.1.3">subscript</csymbol><ci id="S3.E2.m1.6.6.6.6.2.1.3.2.cmml" xref="S3.E2.m1.6.6.6.6.2.1.3.2">𝐝</ci><cn id="S3.E2.m1.6.6.6.6.2.1.3.3.cmml" type="integer" xref="S3.E2.m1.6.6.6.6.2.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.7c">\mathbf{D}(\mathbf{W}_{i})=\begin{cases}\mathbf{D}\times\mathbf{k}\mathbf{D}&amp;%
\text{if }\mathbf{d}_{1}&lt;\mathbf{d}_{2}\\
\mathbf{k}\mathbf{D}\times\mathbf{D}&amp;\text{if }\mathbf{d}_{1}&gt;\mathbf{d}_{2}\\
\mathbf{D}\times\mathbf{D}&amp;\text{if }\mathbf{d}_{1}=\mathbf{d}_{2}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.7d">bold_D ( bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = { start_ROW start_CELL bold_D × bold_kD end_CELL start_CELL if bold_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &lt; bold_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL bold_kD × bold_D end_CELL start_CELL if bold_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &gt; bold_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL bold_D × bold_D end_CELL start_CELL if bold_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = bold_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.17">Here, we assume <math alttext="k\in\mathbb{Z}^{+}/\{1\}" class="ltx_Math" display="inline" id="S3.SS2.p1.15.m1.1"><semantics id="S3.SS2.p1.15.m1.1a"><mrow id="S3.SS2.p1.15.m1.1.2" xref="S3.SS2.p1.15.m1.1.2.cmml"><mi id="S3.SS2.p1.15.m1.1.2.2" xref="S3.SS2.p1.15.m1.1.2.2.cmml">k</mi><mo id="S3.SS2.p1.15.m1.1.2.1" xref="S3.SS2.p1.15.m1.1.2.1.cmml">∈</mo><mrow id="S3.SS2.p1.15.m1.1.2.3" xref="S3.SS2.p1.15.m1.1.2.3.cmml"><msup id="S3.SS2.p1.15.m1.1.2.3.2" xref="S3.SS2.p1.15.m1.1.2.3.2.cmml"><mi id="S3.SS2.p1.15.m1.1.2.3.2.2" xref="S3.SS2.p1.15.m1.1.2.3.2.2.cmml">ℤ</mi><mo id="S3.SS2.p1.15.m1.1.2.3.2.3" xref="S3.SS2.p1.15.m1.1.2.3.2.3.cmml">+</mo></msup><mo id="S3.SS2.p1.15.m1.1.2.3.1" xref="S3.SS2.p1.15.m1.1.2.3.1.cmml">/</mo><mrow id="S3.SS2.p1.15.m1.1.2.3.3.2" xref="S3.SS2.p1.15.m1.1.2.3.3.1.cmml"><mo id="S3.SS2.p1.15.m1.1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p1.15.m1.1.2.3.3.1.cmml">{</mo><mn id="S3.SS2.p1.15.m1.1.1" xref="S3.SS2.p1.15.m1.1.1.cmml">1</mn><mo id="S3.SS2.p1.15.m1.1.2.3.3.2.2" stretchy="false" xref="S3.SS2.p1.15.m1.1.2.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m1.1b"><apply id="S3.SS2.p1.15.m1.1.2.cmml" xref="S3.SS2.p1.15.m1.1.2"><in id="S3.SS2.p1.15.m1.1.2.1.cmml" xref="S3.SS2.p1.15.m1.1.2.1"></in><ci id="S3.SS2.p1.15.m1.1.2.2.cmml" xref="S3.SS2.p1.15.m1.1.2.2">𝑘</ci><apply id="S3.SS2.p1.15.m1.1.2.3.cmml" xref="S3.SS2.p1.15.m1.1.2.3"><divide id="S3.SS2.p1.15.m1.1.2.3.1.cmml" xref="S3.SS2.p1.15.m1.1.2.3.1"></divide><apply id="S3.SS2.p1.15.m1.1.2.3.2.cmml" xref="S3.SS2.p1.15.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m1.1.2.3.2.1.cmml" xref="S3.SS2.p1.15.m1.1.2.3.2">superscript</csymbol><ci id="S3.SS2.p1.15.m1.1.2.3.2.2.cmml" xref="S3.SS2.p1.15.m1.1.2.3.2.2">ℤ</ci><plus id="S3.SS2.p1.15.m1.1.2.3.2.3.cmml" xref="S3.SS2.p1.15.m1.1.2.3.2.3"></plus></apply><set id="S3.SS2.p1.15.m1.1.2.3.3.1.cmml" xref="S3.SS2.p1.15.m1.1.2.3.3.2"><cn id="S3.SS2.p1.15.m1.1.1.cmml" type="integer" xref="S3.SS2.p1.15.m1.1.1">1</cn></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m1.1c">k\in\mathbb{Z}^{+}/\{1\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.15.m1.1d">italic_k ∈ blackboard_Z start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT / { 1 }</annotation></semantics></math> to ease the derivation since <math alttext="W_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.16.m2.1"><semantics id="S3.SS2.p1.16.m2.1a"><msub id="S3.SS2.p1.16.m2.1.1" xref="S3.SS2.p1.16.m2.1.1.cmml"><mi id="S3.SS2.p1.16.m2.1.1.2" xref="S3.SS2.p1.16.m2.1.1.2.cmml">W</mi><mi id="S3.SS2.p1.16.m2.1.1.3" xref="S3.SS2.p1.16.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m2.1b"><apply id="S3.SS2.p1.16.m2.1.1.cmml" xref="S3.SS2.p1.16.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.16.m2.1.1.1.cmml" xref="S3.SS2.p1.16.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.16.m2.1.1.2.cmml" xref="S3.SS2.p1.16.m2.1.1.2">𝑊</ci><ci id="S3.SS2.p1.16.m2.1.1.3.cmml" xref="S3.SS2.p1.16.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m2.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.16.m2.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> often indicates linear up/down scaling by an integer <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.p1.17.m3.1"><semantics id="S3.SS2.p1.17.m3.1a"><mi id="S3.SS2.p1.17.m3.1.1" xref="S3.SS2.p1.17.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m3.1b"><ci id="S3.SS2.p1.17.m3.1.1.cmml" xref="S3.SS2.p1.17.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.17.m3.1d">italic_k</annotation></semantics></math> times (e.g., post-attention MLPs in transformer).</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.8">For case 1 where <math alttext="D(W_{i})=D\times kD" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mrow id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.3.cmml">D</mi><mo id="S3.SS2.p2.1.m1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.1.m1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p2.1.m1.1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.cmml">W</mi><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p2.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">=</mo><mrow id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mrow id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2.2" xref="S3.SS2.p2.1.m1.1.1.3.2.2.cmml">D</mi><mo id="S3.SS2.p2.1.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.1.m1.1.1.3.2.1.cmml">×</mo><mi id="S3.SS2.p2.1.m1.1.1.3.2.3" xref="S3.SS2.p2.1.m1.1.1.3.2.3.cmml">k</mi></mrow><mo id="S3.SS2.p2.1.m1.1.1.3.1" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">D</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><eq id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2"></eq><apply id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1"><times id="S3.SS2.p2.1.m1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.2"></times><ci id="S3.SS2.p2.1.m1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.3">𝐷</ci><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><times id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1"></times><apply id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2"><times id="S3.SS2.p2.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.1"></times><ci id="S3.SS2.p2.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2">𝐷</ci><ci id="S3.SS2.p2.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">D(W_{i})=D\times kD</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_D ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_D × italic_k italic_D</annotation></semantics></math> and <math alttext="X_{i}\in\mathbb{R}^{B\times L\times D}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><msub id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.2.2.cmml">X</mi><mi id="S3.SS2.p2.2.m2.1.1.2.3" xref="S3.SS2.p2.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p2.2.m2.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.2.m2.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.3.3.2" xref="S3.SS2.p2.2.m2.1.1.3.3.2.cmml">B</mi><mo id="S3.SS2.p2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.2.m2.1.1.3.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.3.cmml">L</mi><mo id="S3.SS2.p2.2.m2.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.2.m2.1.1.3.3.4" xref="S3.SS2.p2.2.m2.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><in id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1"></in><apply id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2.2">𝑋</ci><ci id="S3.SS2.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.p2.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3"><times id="S3.SS2.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3.1"></times><ci id="S3.SS2.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3.2">𝐵</ci><ci id="S3.SS2.p2.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3.3">𝐿</ci><ci id="S3.SS2.p2.2.m2.1.1.3.3.4.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">X_{i}\in\mathbb{R}^{B\times L\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="X_{i}W_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><msub id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2.2" xref="S3.SS2.p2.3.m3.1.1.2.2.cmml">X</mi><mi id="S3.SS2.p2.3.m3.1.1.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.3.2.cmml">W</mi><mi id="S3.SS2.p2.3.m3.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><times id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1"></times><apply id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2">𝑋</ci><ci id="S3.SS2.p2.3.m3.1.1.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.2">𝑊</ci><ci id="S3.SS2.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">X_{i}W_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> indicates an up scale. We define the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_j</annotation></semantics></math>’s slice of <math alttext="X_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">X</mi><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝑋</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">X_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as <math alttext="\mathbf{X}_{i}^{(j)}=\mathbf{X}_{i}[0:\mathbf{M}[j]]" class="ltx_math_unparsed" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mrow id="S3.SS2.p2.6.m6.1b"><msubsup id="S3.SS2.p2.6.m6.1.2"><mi id="S3.SS2.p2.6.m6.1.2.2.2">𝐗</mi><mi id="S3.SS2.p2.6.m6.1.2.2.3">i</mi><mrow id="S3.SS2.p2.6.m6.1.1.1.3"><mo id="S3.SS2.p2.6.m6.1.1.1.3.1" stretchy="false">(</mo><mi id="S3.SS2.p2.6.m6.1.1.1.1">j</mi><mo id="S3.SS2.p2.6.m6.1.1.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S3.SS2.p2.6.m6.1.3">=</mo><msub id="S3.SS2.p2.6.m6.1.4"><mi id="S3.SS2.p2.6.m6.1.4.2">𝐗</mi><mi id="S3.SS2.p2.6.m6.1.4.3">i</mi></msub><mrow id="S3.SS2.p2.6.m6.1.5"><mo id="S3.SS2.p2.6.m6.1.5.1" stretchy="false">[</mo><mn id="S3.SS2.p2.6.m6.1.5.2">0</mn><mo id="S3.SS2.p2.6.m6.1.5.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.SS2.p2.6.m6.1.5.4">𝐌</mi><mrow id="S3.SS2.p2.6.m6.1.5.5"><mo id="S3.SS2.p2.6.m6.1.5.5.1" stretchy="false">[</mo><mi id="S3.SS2.p2.6.m6.1.5.5.2">j</mi><mo id="S3.SS2.p2.6.m6.1.5.5.3" stretchy="false">]</mo></mrow><mo id="S3.SS2.p2.6.m6.1.5.6" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\mathbf{X}_{i}^{(j)}=\mathbf{X}_{i}[0:\mathbf{M}[j]]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">bold_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT = bold_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ 0 : bold_M [ italic_j ] ]</annotation></semantics></math> and the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.1"><semantics id="S3.SS2.p2.7.m7.1a"><mi id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.1d">italic_j</annotation></semantics></math>’s slice of <math alttext="W_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m8.1"><semantics id="S3.SS2.p2.8.m8.1a"><msub id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml"><mi id="S3.SS2.p2.8.m8.1.1.2" xref="S3.SS2.p2.8.m8.1.1.2.cmml">W</mi><mi id="S3.SS2.p2.8.m8.1.1.3" xref="S3.SS2.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><apply id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m8.1.1.2.cmml" xref="S3.SS2.p2.8.m8.1.1.2">𝑊</ci><ci id="S3.SS2.p2.8.m8.1.1.3.cmml" xref="S3.SS2.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m8.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{W}_{i}^{(j)}=\begin{cases}\mathbf{W}_{i}[0:\mathbf{M}[0],0:\mathbf{k}%
\mathbf{M}[0]]&amp;\quad\text{if }j=0\\
\mathbf{W}_{i}[0:\mathbf{M}[j],\mathbf{k}\mathbf{M}[j-1]&amp;\quad\text{if }j&gt;0\\
\quad\quad\;\;:\mathbf{k}\mathbf{M}[j]]\end{cases}" class="ltx_math_unparsed" display="block" id="S3.Ex1.m1.6"><semantics id="S3.Ex1.m1.6a"><mrow id="S3.Ex1.m1.6.7"><msubsup id="S3.Ex1.m1.6.7.2"><mi id="S3.Ex1.m1.6.7.2.2.2">𝐖</mi><mi id="S3.Ex1.m1.6.7.2.2.3">i</mi><mrow id="S3.Ex1.m1.6.6.1.3"><mo id="S3.Ex1.m1.6.6.1.3.1" stretchy="false">(</mo><mi id="S3.Ex1.m1.6.6.1.1">j</mi><mo id="S3.Ex1.m1.6.6.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S3.Ex1.m1.6.7.1">=</mo><mrow id="S3.Ex1.m1.5.5"><mo id="S3.Ex1.m1.5.5.6">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.Ex1.m1.5.5.5" rowspacing="0pt"><mtr id="S3.Ex1.m1.5.5.5a"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.5.5.5b"><mrow id="S3.Ex1.m1.1.1.1.1.1.1"><msub id="S3.Ex1.m1.1.1.1.1.1.1.1"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.2">𝐖</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.3">i</mi></msub><mrow id="S3.Ex1.m1.1.1.1.1.1.1.2"><mo id="S3.Ex1.m1.1.1.1.1.1.1.2.1" stretchy="false">[</mo><mn id="S3.Ex1.m1.1.1.1.1.1.1.2.2">0</mn><mo id="S3.Ex1.m1.1.1.1.1.1.1.2.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.2.4">𝐌</mi><mrow id="S3.Ex1.m1.1.1.1.1.1.1.2.5"><mo id="S3.Ex1.m1.1.1.1.1.1.1.2.5.1" stretchy="false">[</mo><mn id="S3.Ex1.m1.1.1.1.1.1.1.2.5.2">0</mn><mo id="S3.Ex1.m1.1.1.1.1.1.1.2.5.3" stretchy="false">]</mo></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.2.6">,</mo><mn id="S3.Ex1.m1.1.1.1.1.1.1.2.7">0</mn><mo id="S3.Ex1.m1.1.1.1.1.1.1.2.8" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.2.9">𝐤𝐌</mi><mrow id="S3.Ex1.m1.1.1.1.1.1.1.2.10"><mo id="S3.Ex1.m1.1.1.1.1.1.1.2.10.1" stretchy="false">[</mo><mn id="S3.Ex1.m1.1.1.1.1.1.1.2.10.2">0</mn><mo id="S3.Ex1.m1.1.1.1.1.1.1.2.10.3" stretchy="false">]</mo></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.2.11" stretchy="false">]</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.5.5.5c"><mrow id="S3.Ex1.m1.2.2.2.2.2.1"><mrow id="S3.Ex1.m1.2.2.2.2.2.1.2"><mtext id="S3.Ex1.m1.2.2.2.2.2.1.2.2">if </mtext><mo id="S3.Ex1.m1.2.2.2.2.2.1.2.1">⁢</mo><mi id="S3.Ex1.m1.2.2.2.2.2.1.2.3">j</mi></mrow><mo id="S3.Ex1.m1.2.2.2.2.2.1.1">=</mo><mn id="S3.Ex1.m1.2.2.2.2.2.1.3">0</mn></mrow></mtd></mtr><mtr id="S3.Ex1.m1.5.5.5d"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.5.5.5e"><mrow id="S3.Ex1.m1.3.3.3.3.1.1"><msub id="S3.Ex1.m1.3.3.3.3.1.1.1"><mi id="S3.Ex1.m1.3.3.3.3.1.1.1.2">𝐖</mi><mi id="S3.Ex1.m1.3.3.3.3.1.1.1.3">i</mi></msub><mrow id="S3.Ex1.m1.3.3.3.3.1.1.2"><mo id="S3.Ex1.m1.3.3.3.3.1.1.2.1" stretchy="false">[</mo><mn id="S3.Ex1.m1.3.3.3.3.1.1.2.2">0</mn><mo id="S3.Ex1.m1.3.3.3.3.1.1.2.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.Ex1.m1.3.3.3.3.1.1.2.4">𝐌</mi><mrow id="S3.Ex1.m1.3.3.3.3.1.1.2.5"><mo id="S3.Ex1.m1.3.3.3.3.1.1.2.5.1" stretchy="false">[</mo><mi id="S3.Ex1.m1.3.3.3.3.1.1.2.5.2">j</mi><mo id="S3.Ex1.m1.3.3.3.3.1.1.2.5.3" stretchy="false">]</mo></mrow><mo id="S3.Ex1.m1.3.3.3.3.1.1.2.6">,</mo><mi id="S3.Ex1.m1.3.3.3.3.1.1.2.7">𝐤𝐌</mi><mrow id="S3.Ex1.m1.3.3.3.3.1.1.2.8"><mo id="S3.Ex1.m1.3.3.3.3.1.1.2.8.1" stretchy="false">[</mo><mi id="S3.Ex1.m1.3.3.3.3.1.1.2.8.2">j</mi><mo id="S3.Ex1.m1.3.3.3.3.1.1.2.8.3">−</mo><mn id="S3.Ex1.m1.3.3.3.3.1.1.2.8.4">1</mn><mo id="S3.Ex1.m1.3.3.3.3.1.1.2.8.5" stretchy="false">]</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.5.5.5f"><mrow id="S3.Ex1.m1.4.4.4.4.2.1"><mrow id="S3.Ex1.m1.4.4.4.4.2.1.2"><mtext id="S3.Ex1.m1.4.4.4.4.2.1.2.2">if </mtext><mo id="S3.Ex1.m1.4.4.4.4.2.1.2.1">⁢</mo><mi id="S3.Ex1.m1.4.4.4.4.2.1.2.3">j</mi></mrow><mo id="S3.Ex1.m1.4.4.4.4.2.1.1">&gt;</mo><mn id="S3.Ex1.m1.4.4.4.4.2.1.3">0</mn></mrow></mtd></mtr><mtr id="S3.Ex1.m1.5.5.5g"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.5.5.5h"><mrow id="S3.Ex1.m1.5.5.5.5.1.1"><mo id="S3.Ex1.m1.5.5.5.5.1.1.2" rspace="0.278em">:</mo><mi id="S3.Ex1.m1.5.5.5.5.1.1.3">𝐤𝐌</mi><mrow id="S3.Ex1.m1.5.5.5.5.1.1.4"><mo id="S3.Ex1.m1.5.5.5.5.1.1.4.1" stretchy="false">[</mo><mi id="S3.Ex1.m1.5.5.5.5.1.1.1">j</mi><mo id="S3.Ex1.m1.5.5.5.5.1.1.4.2" stretchy="false">]</mo></mrow><mo id="S3.Ex1.m1.5.5.5.5.1.1.5" stretchy="false">]</mo></mrow></mtd><mtd id="S3.Ex1.m1.5.5.5i"></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex1.m1.6b">\mathbf{W}_{i}^{(j)}=\begin{cases}\mathbf{W}_{i}[0:\mathbf{M}[0],0:\mathbf{k}%
\mathbf{M}[0]]&amp;\quad\text{if }j=0\\
\mathbf{W}_{i}[0:\mathbf{M}[j],\mathbf{k}\mathbf{M}[j-1]&amp;\quad\text{if }j&gt;0\\
\quad\quad\;\;:\mathbf{k}\mathbf{M}[j]]\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.6c">bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT = { start_ROW start_CELL bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ 0 : bold_M [ 0 ] , 0 : bold_kM [ 0 ] ] end_CELL start_CELL if italic_j = 0 end_CELL end_ROW start_ROW start_CELL bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ 0 : bold_M [ italic_j ] , bold_kM [ italic_j - 1 ] end_CELL start_CELL if italic_j &gt; 0 end_CELL end_ROW start_ROW start_CELL : bold_kM [ italic_j ] ] end_CELL start_CELL end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.8">For case 2 where <math alttext="D(w_{i})=kD\times D" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mrow id="S3.SS2.p4.1.m1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.1.3.cmml">D</mi><mo id="S3.SS2.p4.1.m1.1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p4.1.m1.1.1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p4.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p4.1.m1.1.1.1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.SS2.p4.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p4.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">=</mo><mrow id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml"><mrow id="S3.SS2.p4.1.m1.1.1.3.2" xref="S3.SS2.p4.1.m1.1.1.3.2.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3.2.2" xref="S3.SS2.p4.1.m1.1.1.3.2.2.cmml">k</mi><mo id="S3.SS2.p4.1.m1.1.1.3.2.1" xref="S3.SS2.p4.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S3.SS2.p4.1.m1.1.1.3.2.3" xref="S3.SS2.p4.1.m1.1.1.3.2.3.cmml">D</mi></mrow><mo id="S3.SS2.p4.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p4.1.m1.1.1.3.1.cmml">×</mo><mi id="S3.SS2.p4.1.m1.1.1.3.3" xref="S3.SS2.p4.1.m1.1.1.3.3.cmml">D</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><eq id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2"></eq><apply id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1"><times id="S3.SS2.p4.1.m1.1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.1.2"></times><ci id="S3.SS2.p4.1.m1.1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.1.3">𝐷</ci><apply id="S3.SS2.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.SS2.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3"><times id="S3.SS2.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.1"></times><apply id="S3.SS2.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2"><times id="S3.SS2.p4.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.1"></times><ci id="S3.SS2.p4.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.2">𝑘</ci><ci id="S3.SS2.p4.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2.3">𝐷</ci></apply><ci id="S3.SS2.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">D(w_{i})=kD\times D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_D ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_k italic_D × italic_D</annotation></semantics></math> and the corresponding input <math alttext="X_{i}\in\mathbb{R}^{B\times L\times kD}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><mrow id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><msub id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2.2" xref="S3.SS2.p4.2.m2.1.1.2.2.cmml">X</mi><mi id="S3.SS2.p4.2.m2.1.1.2.3" xref="S3.SS2.p4.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p4.2.m2.1.1.1" xref="S3.SS2.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml"><mi id="S3.SS2.p4.2.m2.1.1.3.2" xref="S3.SS2.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.2.m2.1.1.3.3" xref="S3.SS2.p4.2.m2.1.1.3.3.cmml"><mrow id="S3.SS2.p4.2.m2.1.1.3.3.2" xref="S3.SS2.p4.2.m2.1.1.3.3.2.cmml"><mi id="S3.SS2.p4.2.m2.1.1.3.3.2.2" xref="S3.SS2.p4.2.m2.1.1.3.3.2.2.cmml">B</mi><mo id="S3.SS2.p4.2.m2.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p4.2.m2.1.1.3.3.2.1.cmml">×</mo><mi id="S3.SS2.p4.2.m2.1.1.3.3.2.3" xref="S3.SS2.p4.2.m2.1.1.3.3.2.3.cmml">L</mi><mo id="S3.SS2.p4.2.m2.1.1.3.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p4.2.m2.1.1.3.3.2.1.cmml">×</mo><mi id="S3.SS2.p4.2.m2.1.1.3.3.2.4" xref="S3.SS2.p4.2.m2.1.1.3.3.2.4.cmml">k</mi></mrow><mo id="S3.SS2.p4.2.m2.1.1.3.3.1" xref="S3.SS2.p4.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.2.m2.1.1.3.3.3" xref="S3.SS2.p4.2.m2.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><in id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1"></in><apply id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.2.1.cmml" xref="S3.SS2.p4.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2.2">𝑋</ci><ci id="S3.SS2.p4.2.m2.1.1.2.3.cmml" xref="S3.SS2.p4.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p4.2.m2.1.1.3.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3"><times id="S3.SS2.p4.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.1"></times><apply id="S3.SS2.p4.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.2"><times id="S3.SS2.p4.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.2.1"></times><ci id="S3.SS2.p4.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.2.2">𝐵</ci><ci id="S3.SS2.p4.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.2.3">𝐿</ci><ci id="S3.SS2.p4.2.m2.1.1.3.3.2.4.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.2.4">𝑘</ci></apply><ci id="S3.SS2.p4.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">X_{i}\in\mathbb{R}^{B\times L\times kD}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L × italic_k italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="X_{i}W_{i}" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><mrow id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><msub id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml"><mi id="S3.SS2.p4.3.m3.1.1.2.2" xref="S3.SS2.p4.3.m3.1.1.2.2.cmml">X</mi><mi id="S3.SS2.p4.3.m3.1.1.2.3" xref="S3.SS2.p4.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p4.3.m3.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml"><mi id="S3.SS2.p4.3.m3.1.1.3.2" xref="S3.SS2.p4.3.m3.1.1.3.2.cmml">W</mi><mi id="S3.SS2.p4.3.m3.1.1.3.3" xref="S3.SS2.p4.3.m3.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><times id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1"></times><apply id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.2.1.cmml" xref="S3.SS2.p4.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2.2">𝑋</ci><ci id="S3.SS2.p4.3.m3.1.1.2.3.cmml" xref="S3.SS2.p4.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.3.1.cmml" xref="S3.SS2.p4.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.3.2.cmml" xref="S3.SS2.p4.3.m3.1.1.3.2">𝑊</ci><ci id="S3.SS2.p4.3.m3.1.1.3.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">X_{i}W_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> indicates a down scale. We define the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.1"><semantics id="S3.SS2.p4.4.m4.1a"><mi id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.1d">italic_j</annotation></semantics></math>’s slice of sequential input <math alttext="X_{i}" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.1"><semantics id="S3.SS2.p4.5.m5.1a"><msub id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml"><mi id="S3.SS2.p4.5.m5.1.1.2" xref="S3.SS2.p4.5.m5.1.1.2.cmml">X</mi><mi id="S3.SS2.p4.5.m5.1.1.3" xref="S3.SS2.p4.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p4.5.m5.1.1.2.cmml" xref="S3.SS2.p4.5.m5.1.1.2">𝑋</ci><ci id="S3.SS2.p4.5.m5.1.1.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">X_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m5.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as <math alttext="\mathbf{X}_{i}^{(j)}=\mathbf{X}_{i}[0:2\mathbf{M}[j]]" class="ltx_math_unparsed" display="inline" id="S3.SS2.p4.6.m6.1"><semantics id="S3.SS2.p4.6.m6.1a"><mrow id="S3.SS2.p4.6.m6.1b"><msubsup id="S3.SS2.p4.6.m6.1.2"><mi id="S3.SS2.p4.6.m6.1.2.2.2">𝐗</mi><mi id="S3.SS2.p4.6.m6.1.2.2.3">i</mi><mrow id="S3.SS2.p4.6.m6.1.1.1.3"><mo id="S3.SS2.p4.6.m6.1.1.1.3.1" stretchy="false">(</mo><mi id="S3.SS2.p4.6.m6.1.1.1.1">j</mi><mo id="S3.SS2.p4.6.m6.1.1.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S3.SS2.p4.6.m6.1.3">=</mo><msub id="S3.SS2.p4.6.m6.1.4"><mi id="S3.SS2.p4.6.m6.1.4.2">𝐗</mi><mi id="S3.SS2.p4.6.m6.1.4.3">i</mi></msub><mrow id="S3.SS2.p4.6.m6.1.5"><mo id="S3.SS2.p4.6.m6.1.5.1" stretchy="false">[</mo><mn id="S3.SS2.p4.6.m6.1.5.2">0</mn><mo id="S3.SS2.p4.6.m6.1.5.3" lspace="0.278em" rspace="0.278em">:</mo><mn id="S3.SS2.p4.6.m6.1.5.4">2</mn><mi id="S3.SS2.p4.6.m6.1.5.5">𝐌</mi><mrow id="S3.SS2.p4.6.m6.1.5.6"><mo id="S3.SS2.p4.6.m6.1.5.6.1" stretchy="false">[</mo><mi id="S3.SS2.p4.6.m6.1.5.6.2">j</mi><mo id="S3.SS2.p4.6.m6.1.5.6.3" stretchy="false">]</mo></mrow><mo id="S3.SS2.p4.6.m6.1.5.7" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">\mathbf{X}_{i}^{(j)}=\mathbf{X}_{i}[0:2\mathbf{M}[j]]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.6.m6.1d">bold_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT = bold_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ 0 : 2 bold_M [ italic_j ] ]</annotation></semantics></math> and the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p4.7.m7.1"><semantics id="S3.SS2.p4.7.m7.1a"><mi id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><ci id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.7.m7.1d">italic_j</annotation></semantics></math>’s slice of <math alttext="W_{i}" class="ltx_Math" display="inline" id="S3.SS2.p4.8.m8.1"><semantics id="S3.SS2.p4.8.m8.1a"><msub id="S3.SS2.p4.8.m8.1.1" xref="S3.SS2.p4.8.m8.1.1.cmml"><mi id="S3.SS2.p4.8.m8.1.1.2" xref="S3.SS2.p4.8.m8.1.1.2.cmml">W</mi><mi id="S3.SS2.p4.8.m8.1.1.3" xref="S3.SS2.p4.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m8.1b"><apply id="S3.SS2.p4.8.m8.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m8.1.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p4.8.m8.1.1.2.cmml" xref="S3.SS2.p4.8.m8.1.1.2">𝑊</ci><ci id="S3.SS2.p4.8.m8.1.1.3.cmml" xref="S3.SS2.p4.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m8.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.8.m8.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{W}_{i}^{(j)}=\begin{cases}\mathbf{W}_{i}[0:\mathbf{k}\mathbf{M}[0],0:%
\mathbf{M}[0]]&amp;\text{if }j=0\\
\mathbf{W}_{i}[0:\mathbf{k}\mathbf{M}[j],\mathbf{M}[j-1]&amp;\text{if }j&gt;0\\
\quad\quad\;\;:\mathbf{M}[j]]\end{cases}" class="ltx_math_unparsed" display="block" id="S3.Ex2.m1.6"><semantics id="S3.Ex2.m1.6a"><mrow id="S3.Ex2.m1.6.7"><msubsup id="S3.Ex2.m1.6.7.2"><mi id="S3.Ex2.m1.6.7.2.2.2">𝐖</mi><mi id="S3.Ex2.m1.6.7.2.2.3">i</mi><mrow id="S3.Ex2.m1.6.6.1.3"><mo id="S3.Ex2.m1.6.6.1.3.1" stretchy="false">(</mo><mi id="S3.Ex2.m1.6.6.1.1">j</mi><mo id="S3.Ex2.m1.6.6.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S3.Ex2.m1.6.7.1">=</mo><mrow id="S3.Ex2.m1.5.5"><mo id="S3.Ex2.m1.5.5.6">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.Ex2.m1.5.5.5" rowspacing="0pt"><mtr id="S3.Ex2.m1.5.5.5a"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.5.5.5b"><mrow id="S3.Ex2.m1.1.1.1.1.1.1"><msub id="S3.Ex2.m1.1.1.1.1.1.1.1"><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.2">𝐖</mi><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.3">i</mi></msub><mrow id="S3.Ex2.m1.1.1.1.1.1.1.2"><mo id="S3.Ex2.m1.1.1.1.1.1.1.2.1" stretchy="false">[</mo><mn id="S3.Ex2.m1.1.1.1.1.1.1.2.2">0</mn><mo id="S3.Ex2.m1.1.1.1.1.1.1.2.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.Ex2.m1.1.1.1.1.1.1.2.4">𝐤𝐌</mi><mrow id="S3.Ex2.m1.1.1.1.1.1.1.2.5"><mo id="S3.Ex2.m1.1.1.1.1.1.1.2.5.1" stretchy="false">[</mo><mn id="S3.Ex2.m1.1.1.1.1.1.1.2.5.2">0</mn><mo id="S3.Ex2.m1.1.1.1.1.1.1.2.5.3" stretchy="false">]</mo></mrow><mo id="S3.Ex2.m1.1.1.1.1.1.1.2.6">,</mo><mn id="S3.Ex2.m1.1.1.1.1.1.1.2.7">0</mn><mo id="S3.Ex2.m1.1.1.1.1.1.1.2.8" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.Ex2.m1.1.1.1.1.1.1.2.9">𝐌</mi><mrow id="S3.Ex2.m1.1.1.1.1.1.1.2.10"><mo id="S3.Ex2.m1.1.1.1.1.1.1.2.10.1" stretchy="false">[</mo><mn id="S3.Ex2.m1.1.1.1.1.1.1.2.10.2">0</mn><mo id="S3.Ex2.m1.1.1.1.1.1.1.2.10.3" stretchy="false">]</mo></mrow><mo id="S3.Ex2.m1.1.1.1.1.1.1.2.11" stretchy="false">]</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.5.5.5c"><mrow id="S3.Ex2.m1.2.2.2.2.2.1"><mrow id="S3.Ex2.m1.2.2.2.2.2.1.2"><mtext id="S3.Ex2.m1.2.2.2.2.2.1.2.2">if </mtext><mo id="S3.Ex2.m1.2.2.2.2.2.1.2.1">⁢</mo><mi id="S3.Ex2.m1.2.2.2.2.2.1.2.3">j</mi></mrow><mo id="S3.Ex2.m1.2.2.2.2.2.1.1">=</mo><mn id="S3.Ex2.m1.2.2.2.2.2.1.3">0</mn></mrow></mtd></mtr><mtr id="S3.Ex2.m1.5.5.5d"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.5.5.5e"><mrow id="S3.Ex2.m1.3.3.3.3.1.1"><msub id="S3.Ex2.m1.3.3.3.3.1.1.1"><mi id="S3.Ex2.m1.3.3.3.3.1.1.1.2">𝐖</mi><mi id="S3.Ex2.m1.3.3.3.3.1.1.1.3">i</mi></msub><mrow id="S3.Ex2.m1.3.3.3.3.1.1.2"><mo id="S3.Ex2.m1.3.3.3.3.1.1.2.1" stretchy="false">[</mo><mn id="S3.Ex2.m1.3.3.3.3.1.1.2.2">0</mn><mo id="S3.Ex2.m1.3.3.3.3.1.1.2.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.Ex2.m1.3.3.3.3.1.1.2.4">𝐤𝐌</mi><mrow id="S3.Ex2.m1.3.3.3.3.1.1.2.5"><mo id="S3.Ex2.m1.3.3.3.3.1.1.2.5.1" stretchy="false">[</mo><mi id="S3.Ex2.m1.3.3.3.3.1.1.2.5.2">j</mi><mo id="S3.Ex2.m1.3.3.3.3.1.1.2.5.3" stretchy="false">]</mo></mrow><mo id="S3.Ex2.m1.3.3.3.3.1.1.2.6">,</mo><mi id="S3.Ex2.m1.3.3.3.3.1.1.2.7">𝐌</mi><mrow id="S3.Ex2.m1.3.3.3.3.1.1.2.8"><mo id="S3.Ex2.m1.3.3.3.3.1.1.2.8.1" stretchy="false">[</mo><mi id="S3.Ex2.m1.3.3.3.3.1.1.2.8.2">j</mi><mo id="S3.Ex2.m1.3.3.3.3.1.1.2.8.3">−</mo><mn id="S3.Ex2.m1.3.3.3.3.1.1.2.8.4">1</mn><mo id="S3.Ex2.m1.3.3.3.3.1.1.2.8.5" stretchy="false">]</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.5.5.5f"><mrow id="S3.Ex2.m1.4.4.4.4.2.1"><mrow id="S3.Ex2.m1.4.4.4.4.2.1.2"><mtext id="S3.Ex2.m1.4.4.4.4.2.1.2.2">if </mtext><mo id="S3.Ex2.m1.4.4.4.4.2.1.2.1">⁢</mo><mi id="S3.Ex2.m1.4.4.4.4.2.1.2.3">j</mi></mrow><mo id="S3.Ex2.m1.4.4.4.4.2.1.1">&gt;</mo><mn id="S3.Ex2.m1.4.4.4.4.2.1.3">0</mn></mrow></mtd></mtr><mtr id="S3.Ex2.m1.5.5.5g"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex2.m1.5.5.5h"><mrow id="S3.Ex2.m1.5.5.5.5.1.1"><mo id="S3.Ex2.m1.5.5.5.5.1.1.2" rspace="0.278em">:</mo><mi id="S3.Ex2.m1.5.5.5.5.1.1.3">𝐌</mi><mrow id="S3.Ex2.m1.5.5.5.5.1.1.4"><mo id="S3.Ex2.m1.5.5.5.5.1.1.4.1" stretchy="false">[</mo><mi id="S3.Ex2.m1.5.5.5.5.1.1.1">j</mi><mo id="S3.Ex2.m1.5.5.5.5.1.1.4.2" stretchy="false">]</mo></mrow><mo id="S3.Ex2.m1.5.5.5.5.1.1.5" stretchy="false">]</mo></mrow></mtd><mtd id="S3.Ex2.m1.5.5.5i"></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex2.m1.6b">\mathbf{W}_{i}^{(j)}=\begin{cases}\mathbf{W}_{i}[0:\mathbf{k}\mathbf{M}[0],0:%
\mathbf{M}[0]]&amp;\text{if }j=0\\
\mathbf{W}_{i}[0:\mathbf{k}\mathbf{M}[j],\mathbf{M}[j-1]&amp;\text{if }j&gt;0\\
\quad\quad\;\;:\mathbf{M}[j]]\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.6c">bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT = { start_ROW start_CELL bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ 0 : bold_kM [ 0 ] , 0 : bold_M [ 0 ] ] end_CELL start_CELL if italic_j = 0 end_CELL end_ROW start_ROW start_CELL bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ 0 : bold_kM [ italic_j ] , bold_M [ italic_j - 1 ] end_CELL start_CELL if italic_j &gt; 0 end_CELL end_ROW start_ROW start_CELL : bold_M [ italic_j ] ] end_CELL start_CELL end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.3">For case3 where <math alttext="D(w_{i})=D\times D" class="ltx_Math" display="inline" id="S3.SS2.p6.1.m1.1"><semantics id="S3.SS2.p6.1.m1.1a"><mrow id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml"><mrow id="S3.SS2.p6.1.m1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.cmml"><mi id="S3.SS2.p6.1.m1.1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.1.3.cmml">D</mi><mo id="S3.SS2.p6.1.m1.1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p6.1.m1.1.1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p6.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p6.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p6.1.m1.1.1.1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p6.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.SS2.p6.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p6.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p6.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p6.1.m1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.2.cmml">=</mo><mrow id="S3.SS2.p6.1.m1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.3.cmml"><mi id="S3.SS2.p6.1.m1.1.1.3.2" xref="S3.SS2.p6.1.m1.1.1.3.2.cmml">D</mi><mo id="S3.SS2.p6.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p6.1.m1.1.1.3.1.cmml">×</mo><mi id="S3.SS2.p6.1.m1.1.1.3.3" xref="S3.SS2.p6.1.m1.1.1.3.3.cmml">D</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1"><eq id="S3.SS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2"></eq><apply id="S3.SS2.p6.1.m1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1"><times id="S3.SS2.p6.1.m1.1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.1.2"></times><ci id="S3.SS2.p6.1.m1.1.1.1.3.cmml" xref="S3.SS2.p6.1.m1.1.1.1.3">𝐷</ci><apply id="S3.SS2.p6.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p6.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.SS2.p6.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p6.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS2.p6.1.m1.1.1.3.cmml" xref="S3.SS2.p6.1.m1.1.1.3"><times id="S3.SS2.p6.1.m1.1.1.3.1.cmml" xref="S3.SS2.p6.1.m1.1.1.3.1"></times><ci id="S3.SS2.p6.1.m1.1.1.3.2.cmml" xref="S3.SS2.p6.1.m1.1.1.3.2">𝐷</ci><ci id="S3.SS2.p6.1.m1.1.1.3.3.cmml" xref="S3.SS2.p6.1.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">D(w_{i})=D\times D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.1.m1.1d">italic_D ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_D × italic_D</annotation></semantics></math>, assign <math alttext="k=1" class="ltx_Math" display="inline" id="S3.SS2.p6.2.m2.1"><semantics id="S3.SS2.p6.2.m2.1a"><mrow id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml"><mi id="S3.SS2.p6.2.m2.1.1.2" xref="S3.SS2.p6.2.m2.1.1.2.cmml">k</mi><mo id="S3.SS2.p6.2.m2.1.1.1" xref="S3.SS2.p6.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.p6.2.m2.1.1.3" xref="S3.SS2.p6.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><apply id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1"><eq id="S3.SS2.p6.2.m2.1.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1.1"></eq><ci id="S3.SS2.p6.2.m2.1.1.2.cmml" xref="S3.SS2.p6.2.m2.1.1.2">𝑘</ci><cn id="S3.SS2.p6.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p6.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">k=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.2.m2.1d">italic_k = 1</annotation></semantics></math> for any of above two cases yields <math alttext="\mathbf{W}_{i}^{(j)}" class="ltx_Math" display="inline" id="S3.SS2.p6.3.m3.1"><semantics id="S3.SS2.p6.3.m3.1a"><msubsup id="S3.SS2.p6.3.m3.1.2" xref="S3.SS2.p6.3.m3.1.2.cmml"><mi id="S3.SS2.p6.3.m3.1.2.2.2" xref="S3.SS2.p6.3.m3.1.2.2.2.cmml">𝐖</mi><mi id="S3.SS2.p6.3.m3.1.2.2.3" xref="S3.SS2.p6.3.m3.1.2.2.3.cmml">i</mi><mrow id="S3.SS2.p6.3.m3.1.1.1.3" xref="S3.SS2.p6.3.m3.1.2.cmml"><mo id="S3.SS2.p6.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS2.p6.3.m3.1.2.cmml">(</mo><mi id="S3.SS2.p6.3.m3.1.1.1.1" xref="S3.SS2.p6.3.m3.1.1.1.1.cmml">j</mi><mo id="S3.SS2.p6.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS2.p6.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.3.m3.1b"><apply id="S3.SS2.p6.3.m3.1.2.cmml" xref="S3.SS2.p6.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS2.p6.3.m3.1.2.1.cmml" xref="S3.SS2.p6.3.m3.1.2">superscript</csymbol><apply id="S3.SS2.p6.3.m3.1.2.2.cmml" xref="S3.SS2.p6.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS2.p6.3.m3.1.2.2.1.cmml" xref="S3.SS2.p6.3.m3.1.2">subscript</csymbol><ci id="S3.SS2.p6.3.m3.1.2.2.2.cmml" xref="S3.SS2.p6.3.m3.1.2.2.2">𝐖</ci><ci id="S3.SS2.p6.3.m3.1.2.2.3.cmml" xref="S3.SS2.p6.3.m3.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p6.3.m3.1.1.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.3.m3.1c">\mathbf{W}_{i}^{(j)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.3.m3.1d">bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p7">
<p class="ltx_p" id="S3.SS2.p7.3">Then, we perform matrix multiplication between <math alttext="X_{i}^{(j)}" class="ltx_Math" display="inline" id="S3.SS2.p7.1.m1.1"><semantics id="S3.SS2.p7.1.m1.1a"><msubsup id="S3.SS2.p7.1.m1.1.2" xref="S3.SS2.p7.1.m1.1.2.cmml"><mi id="S3.SS2.p7.1.m1.1.2.2.2" xref="S3.SS2.p7.1.m1.1.2.2.2.cmml">X</mi><mi id="S3.SS2.p7.1.m1.1.2.2.3" xref="S3.SS2.p7.1.m1.1.2.2.3.cmml">i</mi><mrow id="S3.SS2.p7.1.m1.1.1.1.3" xref="S3.SS2.p7.1.m1.1.2.cmml"><mo id="S3.SS2.p7.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.p7.1.m1.1.2.cmml">(</mo><mi id="S3.SS2.p7.1.m1.1.1.1.1" xref="S3.SS2.p7.1.m1.1.1.1.1.cmml">j</mi><mo id="S3.SS2.p7.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.p7.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b"><apply id="S3.SS2.p7.1.m1.1.2.cmml" xref="S3.SS2.p7.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.1.2.1.cmml" xref="S3.SS2.p7.1.m1.1.2">superscript</csymbol><apply id="S3.SS2.p7.1.m1.1.2.2.cmml" xref="S3.SS2.p7.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.1.2.2.1.cmml" xref="S3.SS2.p7.1.m1.1.2">subscript</csymbol><ci id="S3.SS2.p7.1.m1.1.2.2.2.cmml" xref="S3.SS2.p7.1.m1.1.2.2.2">𝑋</ci><ci id="S3.SS2.p7.1.m1.1.2.2.3.cmml" xref="S3.SS2.p7.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p7.1.m1.1.1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">X_{i}^{(j)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.1.m1.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="W_{i}^{(j)}" class="ltx_Math" display="inline" id="S3.SS2.p7.2.m2.1"><semantics id="S3.SS2.p7.2.m2.1a"><msubsup id="S3.SS2.p7.2.m2.1.2" xref="S3.SS2.p7.2.m2.1.2.cmml"><mi id="S3.SS2.p7.2.m2.1.2.2.2" xref="S3.SS2.p7.2.m2.1.2.2.2.cmml">W</mi><mi id="S3.SS2.p7.2.m2.1.2.2.3" xref="S3.SS2.p7.2.m2.1.2.2.3.cmml">i</mi><mrow id="S3.SS2.p7.2.m2.1.1.1.3" xref="S3.SS2.p7.2.m2.1.2.cmml"><mo id="S3.SS2.p7.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS2.p7.2.m2.1.2.cmml">(</mo><mi id="S3.SS2.p7.2.m2.1.1.1.1" xref="S3.SS2.p7.2.m2.1.1.1.1.cmml">j</mi><mo id="S3.SS2.p7.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS2.p7.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m2.1b"><apply id="S3.SS2.p7.2.m2.1.2.cmml" xref="S3.SS2.p7.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.p7.2.m2.1.2.1.cmml" xref="S3.SS2.p7.2.m2.1.2">superscript</csymbol><apply id="S3.SS2.p7.2.m2.1.2.2.cmml" xref="S3.SS2.p7.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.p7.2.m2.1.2.2.1.cmml" xref="S3.SS2.p7.2.m2.1.2">subscript</csymbol><ci id="S3.SS2.p7.2.m2.1.2.2.2.cmml" xref="S3.SS2.p7.2.m2.1.2.2.2">𝑊</ci><ci id="S3.SS2.p7.2.m2.1.2.2.3.cmml" xref="S3.SS2.p7.2.m2.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p7.2.m2.1.1.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.2.m2.1c">W_{i}^{(j)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math> followed by concatenation along dimension <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p7.3.m3.1"><semantics id="S3.SS2.p7.3.m3.1a"><mi id="S3.SS2.p7.3.m3.1.1" xref="S3.SS2.p7.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.3.m3.1b"><ci id="S3.SS2.p7.3.m3.1.1.cmml" xref="S3.SS2.p7.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.3.m3.1d">italic_j</annotation></semantics></math> to form the output</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Y}_{i}=[\mathbf{X}_{i}^{(0)}\mathbf{W}_{i}^{(0)},\ldots,\mathbf{X}_{i}%
^{(z)}\mathbf{W}_{i}^{(z)}]" class="ltx_Math" display="block" id="S3.E3.m1.7"><semantics id="S3.E3.m1.7a"><mrow id="S3.E3.m1.7.7" xref="S3.E3.m1.7.7.cmml"><msub id="S3.E3.m1.7.7.4" xref="S3.E3.m1.7.7.4.cmml"><mi id="S3.E3.m1.7.7.4.2" xref="S3.E3.m1.7.7.4.2.cmml">𝐘</mi><mi id="S3.E3.m1.7.7.4.3" xref="S3.E3.m1.7.7.4.3.cmml">i</mi></msub><mo id="S3.E3.m1.7.7.3" xref="S3.E3.m1.7.7.3.cmml">=</mo><mrow id="S3.E3.m1.7.7.2.2" xref="S3.E3.m1.7.7.2.3.cmml"><mo id="S3.E3.m1.7.7.2.2.3" stretchy="false" xref="S3.E3.m1.7.7.2.3.cmml">[</mo><mrow id="S3.E3.m1.6.6.1.1.1" xref="S3.E3.m1.6.6.1.1.1.cmml"><msubsup id="S3.E3.m1.6.6.1.1.1.2" xref="S3.E3.m1.6.6.1.1.1.2.cmml"><mi id="S3.E3.m1.6.6.1.1.1.2.2.2" xref="S3.E3.m1.6.6.1.1.1.2.2.2.cmml">𝐗</mi><mi id="S3.E3.m1.6.6.1.1.1.2.2.3" xref="S3.E3.m1.6.6.1.1.1.2.2.3.cmml">i</mi><mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.6.6.1.1.1.2.cmml"><mo id="S3.E3.m1.1.1.1.3.1" stretchy="false" xref="S3.E3.m1.6.6.1.1.1.2.cmml">(</mo><mn id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">0</mn><mo id="S3.E3.m1.1.1.1.3.2" stretchy="false" xref="S3.E3.m1.6.6.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.E3.m1.6.6.1.1.1.1" xref="S3.E3.m1.6.6.1.1.1.1.cmml">⁢</mo><msubsup id="S3.E3.m1.6.6.1.1.1.3" xref="S3.E3.m1.6.6.1.1.1.3.cmml"><mi id="S3.E3.m1.6.6.1.1.1.3.2.2" xref="S3.E3.m1.6.6.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S3.E3.m1.6.6.1.1.1.3.2.3" xref="S3.E3.m1.6.6.1.1.1.3.2.3.cmml">i</mi><mrow id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.6.6.1.1.1.3.cmml"><mo id="S3.E3.m1.2.2.1.3.1" stretchy="false" xref="S3.E3.m1.6.6.1.1.1.3.cmml">(</mo><mn id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml">0</mn><mo id="S3.E3.m1.2.2.1.3.2" stretchy="false" xref="S3.E3.m1.6.6.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E3.m1.7.7.2.2.4" xref="S3.E3.m1.7.7.2.3.cmml">,</mo><mi id="S3.E3.m1.5.5" mathvariant="normal" xref="S3.E3.m1.5.5.cmml">…</mi><mo id="S3.E3.m1.7.7.2.2.5" xref="S3.E3.m1.7.7.2.3.cmml">,</mo><mrow id="S3.E3.m1.7.7.2.2.2" xref="S3.E3.m1.7.7.2.2.2.cmml"><msubsup id="S3.E3.m1.7.7.2.2.2.2" xref="S3.E3.m1.7.7.2.2.2.2.cmml"><mi id="S3.E3.m1.7.7.2.2.2.2.2.2" xref="S3.E3.m1.7.7.2.2.2.2.2.2.cmml">𝐗</mi><mi id="S3.E3.m1.7.7.2.2.2.2.2.3" xref="S3.E3.m1.7.7.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.E3.m1.3.3.1.3" xref="S3.E3.m1.7.7.2.2.2.2.cmml"><mo id="S3.E3.m1.3.3.1.3.1" stretchy="false" xref="S3.E3.m1.7.7.2.2.2.2.cmml">(</mo><mi id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml">z</mi><mo id="S3.E3.m1.3.3.1.3.2" stretchy="false" xref="S3.E3.m1.7.7.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.E3.m1.7.7.2.2.2.1" xref="S3.E3.m1.7.7.2.2.2.1.cmml">⁢</mo><msubsup id="S3.E3.m1.7.7.2.2.2.3" xref="S3.E3.m1.7.7.2.2.2.3.cmml"><mi id="S3.E3.m1.7.7.2.2.2.3.2.2" xref="S3.E3.m1.7.7.2.2.2.3.2.2.cmml">𝐖</mi><mi id="S3.E3.m1.7.7.2.2.2.3.2.3" xref="S3.E3.m1.7.7.2.2.2.3.2.3.cmml">i</mi><mrow id="S3.E3.m1.4.4.1.3" xref="S3.E3.m1.7.7.2.2.2.3.cmml"><mo id="S3.E3.m1.4.4.1.3.1" stretchy="false" xref="S3.E3.m1.7.7.2.2.2.3.cmml">(</mo><mi id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml">z</mi><mo id="S3.E3.m1.4.4.1.3.2" stretchy="false" xref="S3.E3.m1.7.7.2.2.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E3.m1.7.7.2.2.6" stretchy="false" xref="S3.E3.m1.7.7.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.7b"><apply id="S3.E3.m1.7.7.cmml" xref="S3.E3.m1.7.7"><eq id="S3.E3.m1.7.7.3.cmml" xref="S3.E3.m1.7.7.3"></eq><apply id="S3.E3.m1.7.7.4.cmml" xref="S3.E3.m1.7.7.4"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.4.1.cmml" xref="S3.E3.m1.7.7.4">subscript</csymbol><ci id="S3.E3.m1.7.7.4.2.cmml" xref="S3.E3.m1.7.7.4.2">𝐘</ci><ci id="S3.E3.m1.7.7.4.3.cmml" xref="S3.E3.m1.7.7.4.3">𝑖</ci></apply><list id="S3.E3.m1.7.7.2.3.cmml" xref="S3.E3.m1.7.7.2.2"><apply id="S3.E3.m1.6.6.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1"><times id="S3.E3.m1.6.6.1.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1"></times><apply id="S3.E3.m1.6.6.1.1.1.2.cmml" xref="S3.E3.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.2.1.cmml" xref="S3.E3.m1.6.6.1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.6.6.1.1.1.2.2.cmml" xref="S3.E3.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.2.2.1.cmml" xref="S3.E3.m1.6.6.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.6.6.1.1.1.2.2.2.cmml" xref="S3.E3.m1.6.6.1.1.1.2.2.2">𝐗</ci><ci id="S3.E3.m1.6.6.1.1.1.2.2.3.cmml" xref="S3.E3.m1.6.6.1.1.1.2.2.3">𝑖</ci></apply><cn id="S3.E3.m1.1.1.1.1.cmml" type="integer" xref="S3.E3.m1.1.1.1.1">0</cn></apply><apply id="S3.E3.m1.6.6.1.1.1.3.cmml" xref="S3.E3.m1.6.6.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.3.1.cmml" xref="S3.E3.m1.6.6.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.6.6.1.1.1.3.2.cmml" xref="S3.E3.m1.6.6.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.3.2.1.cmml" xref="S3.E3.m1.6.6.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.6.6.1.1.1.3.2.2.cmml" xref="S3.E3.m1.6.6.1.1.1.3.2.2">𝐖</ci><ci id="S3.E3.m1.6.6.1.1.1.3.2.3.cmml" xref="S3.E3.m1.6.6.1.1.1.3.2.3">𝑖</ci></apply><cn id="S3.E3.m1.2.2.1.1.cmml" type="integer" xref="S3.E3.m1.2.2.1.1">0</cn></apply></apply><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">…</ci><apply id="S3.E3.m1.7.7.2.2.2.cmml" xref="S3.E3.m1.7.7.2.2.2"><times id="S3.E3.m1.7.7.2.2.2.1.cmml" xref="S3.E3.m1.7.7.2.2.2.1"></times><apply id="S3.E3.m1.7.7.2.2.2.2.cmml" xref="S3.E3.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.2.2.2.2.1.cmml" xref="S3.E3.m1.7.7.2.2.2.2">superscript</csymbol><apply id="S3.E3.m1.7.7.2.2.2.2.2.cmml" xref="S3.E3.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.2.2.2.2.2.1.cmml" xref="S3.E3.m1.7.7.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.7.7.2.2.2.2.2.2.cmml" xref="S3.E3.m1.7.7.2.2.2.2.2.2">𝐗</ci><ci id="S3.E3.m1.7.7.2.2.2.2.2.3.cmml" xref="S3.E3.m1.7.7.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1">𝑧</ci></apply><apply id="S3.E3.m1.7.7.2.2.2.3.cmml" xref="S3.E3.m1.7.7.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.2.2.2.3.1.cmml" xref="S3.E3.m1.7.7.2.2.2.3">superscript</csymbol><apply id="S3.E3.m1.7.7.2.2.2.3.2.cmml" xref="S3.E3.m1.7.7.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.2.2.2.3.2.1.cmml" xref="S3.E3.m1.7.7.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.7.7.2.2.2.3.2.2.cmml" xref="S3.E3.m1.7.7.2.2.2.3.2.2">𝐖</ci><ci id="S3.E3.m1.7.7.2.2.2.3.2.3.cmml" xref="S3.E3.m1.7.7.2.2.2.3.2.3">𝑖</ci></apply><ci id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1.1">𝑧</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.7c">\mathbf{Y}_{i}=[\mathbf{X}_{i}^{(0)}\mathbf{W}_{i}^{(0)},\ldots,\mathbf{X}_{i}%
^{(z)}\mathbf{W}_{i}^{(z)}]</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.7d">bold_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = [ bold_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT , … , bold_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_z ) end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_z ) end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p7.4">where <math alttext="z=\log(D/2)" class="ltx_Math" display="inline" id="S3.SS2.p7.4.m1.2"><semantics id="S3.SS2.p7.4.m1.2a"><mrow id="S3.SS2.p7.4.m1.2.2" xref="S3.SS2.p7.4.m1.2.2.cmml"><mi id="S3.SS2.p7.4.m1.2.2.3" xref="S3.SS2.p7.4.m1.2.2.3.cmml">z</mi><mo id="S3.SS2.p7.4.m1.2.2.2" xref="S3.SS2.p7.4.m1.2.2.2.cmml">=</mo><mrow id="S3.SS2.p7.4.m1.2.2.1.1" xref="S3.SS2.p7.4.m1.2.2.1.2.cmml"><mi id="S3.SS2.p7.4.m1.1.1" xref="S3.SS2.p7.4.m1.1.1.cmml">log</mi><mo id="S3.SS2.p7.4.m1.2.2.1.1a" xref="S3.SS2.p7.4.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.SS2.p7.4.m1.2.2.1.1.1" xref="S3.SS2.p7.4.m1.2.2.1.2.cmml"><mo id="S3.SS2.p7.4.m1.2.2.1.1.1.2" stretchy="false" xref="S3.SS2.p7.4.m1.2.2.1.2.cmml">(</mo><mrow id="S3.SS2.p7.4.m1.2.2.1.1.1.1" xref="S3.SS2.p7.4.m1.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p7.4.m1.2.2.1.1.1.1.2" xref="S3.SS2.p7.4.m1.2.2.1.1.1.1.2.cmml">D</mi><mo id="S3.SS2.p7.4.m1.2.2.1.1.1.1.1" xref="S3.SS2.p7.4.m1.2.2.1.1.1.1.1.cmml">/</mo><mn id="S3.SS2.p7.4.m1.2.2.1.1.1.1.3" xref="S3.SS2.p7.4.m1.2.2.1.1.1.1.3.cmml">2</mn></mrow><mo id="S3.SS2.p7.4.m1.2.2.1.1.1.3" stretchy="false" xref="S3.SS2.p7.4.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.4.m1.2b"><apply id="S3.SS2.p7.4.m1.2.2.cmml" xref="S3.SS2.p7.4.m1.2.2"><eq id="S3.SS2.p7.4.m1.2.2.2.cmml" xref="S3.SS2.p7.4.m1.2.2.2"></eq><ci id="S3.SS2.p7.4.m1.2.2.3.cmml" xref="S3.SS2.p7.4.m1.2.2.3">𝑧</ci><apply id="S3.SS2.p7.4.m1.2.2.1.2.cmml" xref="S3.SS2.p7.4.m1.2.2.1.1"><log id="S3.SS2.p7.4.m1.1.1.cmml" xref="S3.SS2.p7.4.m1.1.1"></log><apply id="S3.SS2.p7.4.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p7.4.m1.2.2.1.1.1.1"><divide id="S3.SS2.p7.4.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p7.4.m1.2.2.1.1.1.1.1"></divide><ci id="S3.SS2.p7.4.m1.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p7.4.m1.2.2.1.1.1.1.2">𝐷</ci><cn id="S3.SS2.p7.4.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p7.4.m1.2.2.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.4.m1.2c">z=\log(D/2)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.4.m1.2d">italic_z = roman_log ( italic_D / 2 )</annotation></semantics></math>. Refer to figure <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.F1" title="Figure 1 ‣ 3.2 Full-Scale Matryoshka Representation Learning for Recommendation ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> for case 1 of this process.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="257" id="S3.F2.g1" src="x2.png" width="748"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The overall architecture for fMRLRec.</figcaption>
</figure>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">The fMRLRec Operator</h5>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.5">Instead of computing equation <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.E3" title="Equation 3 ‣ 3.2 Full-Scale Matryoshka Representation Learning for Recommendation ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, we would like the chunk/slice-wise multiplication of <math alttext="X_{i}^{(j)}W_{i}^{(j)}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.2"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.2a"><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.2.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.cmml"><msubsup id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.2.2.cmml">X</mi><mi id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.2.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.2.3.cmml">i</mi><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.cmml">j</mi><mo id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.1.cmml">⁢</mo><msubsup id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.2.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.2.2.cmml">W</mi><mi id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.2.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.2.3.cmml">i</mi><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.1.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.cmml"><mo id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.cmml">j</mi><mo id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.2b"><apply id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3"><times id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.1"></times><apply id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.2.2">𝑋</ci><ci id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.1">𝑗</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.2.2">𝑊</ci><ci id="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.3.3.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.1.m1.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.2.2.1.1">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.2c">X_{i}^{(j)}W_{i}^{(j)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.1.m1.2d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math> for all <math alttext="j={1,2,\ldots,\log(D/2)}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.2.m2.5"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.5a"><mrow id="S3.SS2.SSS0.Px1.p1.2.m2.5.5" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.3.cmml">j</mi><mo id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.2.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.2.cmml"><mn id="S3.SS2.SSS0.Px1.p1.2.m2.2.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.cmml">1</mn><mo id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.2.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p1.2.m2.3.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.cmml">2</mn><mo id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.2.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.2.m2.4.4" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.4" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.2.cmml">,</mo><mrow id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">log</mi><mo id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1a" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.2.cmml">⁡</mo><mrow id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.2.cmml">(</mo><mrow id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.2.cmml">D</mi><mo id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.1.cmml">/</mo><mn id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.3.cmml">2</mn></mrow><mo id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.5b"><apply id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5"><eq id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.2"></eq><ci id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.3">𝑗</ci><list id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1"><cn id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2">1</cn><cn id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3">2</cn><ci id="S3.SS2.SSS0.Px1.p1.2.m2.4.4.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.4.4">…</ci><apply id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1"><log id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1"></log><apply id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1"><divide id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.1"></divide><ci id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.2">𝐷</ci><cn id="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.2.m2.5.5.1.1.1.1.1.1.3">2</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.5c">j={1,2,\ldots,\log(D/2)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.2.m2.5d">italic_j = 1 , 2 , … , roman_log ( italic_D / 2 )</annotation></semantics></math> is computed by <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px1.p1.5.1">one</span> forward pass to derive output <math alttext="Y_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p1.3.m3.1a"><msub id="S3.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml">Y</mi><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.2">𝑌</ci><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.3.m3.1c">Y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.3.m3.1d">italic_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Specifically, we create a padding mask <math alttext="P_{i}(\mathcal{M})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p1.4.m4.1a"><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.1.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.cmml"><msub id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2.cmml">P</mi><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.3.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml">ℳ</mi><mo id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2"><times id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.1"></times><apply id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.2">𝑃</ci><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.4.m4.1c">P_{i}(\mathcal{M})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( caligraphic_M )</annotation></semantics></math> of the same size as <math alttext="W_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p1.5.m5.1a"><msub id="S3.SS2.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2">𝑊</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.5.m5.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.5.m5.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> that</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{P}_{i}(\mathcal{M})=\{p_{rs}=0|w_{rs}\in\mathbf{W}_{i},w_{rs}\notin%
\mathbf{W}_{i}^{(j)}\}" class="ltx_Math" display="block" id="S3.E4.m1.4"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml"><msub id="S3.E4.m1.4.4.4.2" xref="S3.E4.m1.4.4.4.2.cmml"><mi id="S3.E4.m1.4.4.4.2.2" xref="S3.E4.m1.4.4.4.2.2.cmml">𝐏</mi><mi id="S3.E4.m1.4.4.4.2.3" xref="S3.E4.m1.4.4.4.2.3.cmml">i</mi></msub><mo id="S3.E4.m1.4.4.4.1" xref="S3.E4.m1.4.4.4.1.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.4.3.2" xref="S3.E4.m1.4.4.4.cmml"><mo id="S3.E4.m1.4.4.4.3.2.1" stretchy="false" xref="S3.E4.m1.4.4.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">ℳ</mi><mo id="S3.E4.m1.4.4.4.3.2.2" stretchy="false" xref="S3.E4.m1.4.4.4.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.3" xref="S3.E4.m1.4.4.3.cmml">=</mo><mrow id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.3.cmml"><mo id="S3.E4.m1.4.4.2.2.3" stretchy="false" xref="S3.E4.m1.4.4.2.3.1.cmml">{</mo><mrow id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.2.cmml"><mi id="S3.E4.m1.3.3.1.1.1.2.2" xref="S3.E4.m1.3.3.1.1.1.2.2.cmml">p</mi><mrow id="S3.E4.m1.3.3.1.1.1.2.3" xref="S3.E4.m1.3.3.1.1.1.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.2.3.2" xref="S3.E4.m1.3.3.1.1.1.2.3.2.cmml">r</mi><mo id="S3.E4.m1.3.3.1.1.1.2.3.1" xref="S3.E4.m1.3.3.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.1.2.3.3" xref="S3.E4.m1.3.3.1.1.1.2.3.3.cmml">s</mi></mrow></msub><mo id="S3.E4.m1.3.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml">=</mo><mn id="S3.E4.m1.3.3.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.3.cmml">0</mn></mrow><mo id="S3.E4.m1.4.4.2.2.4" lspace="0em" rspace="0em" xref="S3.E4.m1.4.4.2.3.1.cmml">|</mo><mrow id="S3.E4.m1.4.4.2.2.2.2" xref="S3.E4.m1.4.4.2.2.2.3.cmml"><mrow id="S3.E4.m1.4.4.2.2.2.1.1" xref="S3.E4.m1.4.4.2.2.2.1.1.cmml"><msub id="S3.E4.m1.4.4.2.2.2.1.1.2" xref="S3.E4.m1.4.4.2.2.2.1.1.2.cmml"><mi id="S3.E4.m1.4.4.2.2.2.1.1.2.2" xref="S3.E4.m1.4.4.2.2.2.1.1.2.2.cmml">w</mi><mrow id="S3.E4.m1.4.4.2.2.2.1.1.2.3" xref="S3.E4.m1.4.4.2.2.2.1.1.2.3.cmml"><mi id="S3.E4.m1.4.4.2.2.2.1.1.2.3.2" xref="S3.E4.m1.4.4.2.2.2.1.1.2.3.2.cmml">r</mi><mo id="S3.E4.m1.4.4.2.2.2.1.1.2.3.1" xref="S3.E4.m1.4.4.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.2.2.2.1.1.2.3.3" xref="S3.E4.m1.4.4.2.2.2.1.1.2.3.3.cmml">s</mi></mrow></msub><mo id="S3.E4.m1.4.4.2.2.2.1.1.1" xref="S3.E4.m1.4.4.2.2.2.1.1.1.cmml">∈</mo><msub id="S3.E4.m1.4.4.2.2.2.1.1.3" xref="S3.E4.m1.4.4.2.2.2.1.1.3.cmml"><mi id="S3.E4.m1.4.4.2.2.2.1.1.3.2" xref="S3.E4.m1.4.4.2.2.2.1.1.3.2.cmml">𝐖</mi><mi id="S3.E4.m1.4.4.2.2.2.1.1.3.3" xref="S3.E4.m1.4.4.2.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E4.m1.4.4.2.2.2.2.3" xref="S3.E4.m1.4.4.2.2.2.3a.cmml">,</mo><mrow id="S3.E4.m1.4.4.2.2.2.2.2" xref="S3.E4.m1.4.4.2.2.2.2.2.cmml"><msub id="S3.E4.m1.4.4.2.2.2.2.2.2" xref="S3.E4.m1.4.4.2.2.2.2.2.2.cmml"><mi id="S3.E4.m1.4.4.2.2.2.2.2.2.2" xref="S3.E4.m1.4.4.2.2.2.2.2.2.2.cmml">w</mi><mrow id="S3.E4.m1.4.4.2.2.2.2.2.2.3" xref="S3.E4.m1.4.4.2.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.4.4.2.2.2.2.2.2.3.2" xref="S3.E4.m1.4.4.2.2.2.2.2.2.3.2.cmml">r</mi><mo id="S3.E4.m1.4.4.2.2.2.2.2.2.3.1" xref="S3.E4.m1.4.4.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.2.2.2.2.2.2.3.3" xref="S3.E4.m1.4.4.2.2.2.2.2.2.3.3.cmml">s</mi></mrow></msub><mo id="S3.E4.m1.4.4.2.2.2.2.2.1" xref="S3.E4.m1.4.4.2.2.2.2.2.1.cmml">∉</mo><msubsup id="S3.E4.m1.4.4.2.2.2.2.2.3" xref="S3.E4.m1.4.4.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.4.4.2.2.2.2.2.3.2.2" xref="S3.E4.m1.4.4.2.2.2.2.2.3.2.2.cmml">𝐖</mi><mi id="S3.E4.m1.4.4.2.2.2.2.2.3.2.3" xref="S3.E4.m1.4.4.2.2.2.2.2.3.2.3.cmml">i</mi><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.4.4.2.2.2.2.2.3.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.4.4.2.2.2.2.2.3.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">j</mi><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.4.4.2.2.2.2.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S3.E4.m1.4.4.2.2.5" stretchy="false" xref="S3.E4.m1.4.4.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><eq id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3"></eq><apply id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"><times id="S3.E4.m1.4.4.4.1.cmml" xref="S3.E4.m1.4.4.4.1"></times><apply id="S3.E4.m1.4.4.4.2.cmml" xref="S3.E4.m1.4.4.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.2.1.cmml" xref="S3.E4.m1.4.4.4.2">subscript</csymbol><ci id="S3.E4.m1.4.4.4.2.2.cmml" xref="S3.E4.m1.4.4.4.2.2">𝐏</ci><ci id="S3.E4.m1.4.4.4.2.3.cmml" xref="S3.E4.m1.4.4.4.2.3">𝑖</ci></apply><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">ℳ</ci></apply><apply id="S3.E4.m1.4.4.2.3.cmml" xref="S3.E4.m1.4.4.2.2"><csymbol cd="latexml" id="S3.E4.m1.4.4.2.3.1.cmml" xref="S3.E4.m1.4.4.2.2.3">conditional-set</csymbol><apply id="S3.E4.m1.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"><eq id="S3.E4.m1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1"></eq><apply id="S3.E4.m1.3.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.2.2">𝑝</ci><apply id="S3.E4.m1.3.3.1.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.1.2.3"><times id="S3.E4.m1.3.3.1.1.1.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.2.3.1"></times><ci id="S3.E4.m1.3.3.1.1.1.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.2.3.2">𝑟</ci><ci id="S3.E4.m1.3.3.1.1.1.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.2.3.3">𝑠</ci></apply></apply><cn id="S3.E4.m1.3.3.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.3.3.1.1.1.3">0</cn></apply><apply id="S3.E4.m1.4.4.2.2.2.3.cmml" xref="S3.E4.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.2.3a.cmml" xref="S3.E4.m1.4.4.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.4.4.2.2.2.1.1.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1"><in id="S3.E4.m1.4.4.2.2.2.1.1.1.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.1"></in><apply id="S3.E4.m1.4.4.2.2.2.1.1.2.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.2.1.1.2.1.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E4.m1.4.4.2.2.2.1.1.2.2.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.2.2">𝑤</ci><apply id="S3.E4.m1.4.4.2.2.2.1.1.2.3.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.2.3"><times id="S3.E4.m1.4.4.2.2.2.1.1.2.3.1.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.2.3.1"></times><ci id="S3.E4.m1.4.4.2.2.2.1.1.2.3.2.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.2.3.2">𝑟</ci><ci id="S3.E4.m1.4.4.2.2.2.1.1.2.3.3.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.2.3.3">𝑠</ci></apply></apply><apply id="S3.E4.m1.4.4.2.2.2.1.1.3.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.2.1.1.3.1.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E4.m1.4.4.2.2.2.1.1.3.2.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.3.2">𝐖</ci><ci id="S3.E4.m1.4.4.2.2.2.1.1.3.3.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.4.4.2.2.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2"><notin id="S3.E4.m1.4.4.2.2.2.2.2.1.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.1"></notin><apply id="S3.E4.m1.4.4.2.2.2.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.4.4.2.2.2.2.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.2.2">𝑤</ci><apply id="S3.E4.m1.4.4.2.2.2.2.2.2.3.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.2.3"><times id="S3.E4.m1.4.4.2.2.2.2.2.2.3.1.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.2.3.1"></times><ci id="S3.E4.m1.4.4.2.2.2.2.2.2.3.2.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.2.3.2">𝑟</ci><ci id="S3.E4.m1.4.4.2.2.2.2.2.2.3.3.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.2.3.3">𝑠</ci></apply></apply><apply id="S3.E4.m1.4.4.2.2.2.2.2.3.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.2.2.2.3.1.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.3">superscript</csymbol><apply id="S3.E4.m1.4.4.2.2.2.2.2.3.2.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.2.2.2.3.2.1.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E4.m1.4.4.2.2.2.2.2.3.2.2.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.3.2.2">𝐖</ci><ci id="S3.E4.m1.4.4.2.2.2.2.2.3.2.3.cmml" xref="S3.E4.m1.4.4.2.2.2.2.2.3.2.3">𝑖</ci></apply><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\mathbf{P}_{i}(\mathcal{M})=\{p_{rs}=0|w_{rs}\in\mathbf{W}_{i},w_{rs}\notin%
\mathbf{W}_{i}^{(j)}\}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.4d">bold_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( caligraphic_M ) = { italic_p start_POSTSUBSCRIPT italic_r italic_s end_POSTSUBSCRIPT = 0 | italic_w start_POSTSUBSCRIPT italic_r italic_s end_POSTSUBSCRIPT ∈ bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT italic_r italic_s end_POSTSUBSCRIPT ∉ bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.9">Then we define the fMRLRec operator as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{{fMRLRec}}(\mathbf{W}_{i},\mathcal{M})=\mathbf{P}_{i}(\mathcal{M})\odot%
\mathbf{W}_{i}" class="ltx_Math" display="block" id="S3.E5.m1.3"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml"><mrow id="S3.E5.m1.3.3.1" xref="S3.E5.m1.3.3.1.cmml"><mtext id="S3.E5.m1.3.3.1.3" xref="S3.E5.m1.3.3.1.3a.cmml">fMRLRec</mtext><mo id="S3.E5.m1.3.3.1.2" xref="S3.E5.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.2.cmml"><mo id="S3.E5.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.2.cmml">(</mo><msub id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.2.cmml">𝐖</mi><mi id="S3.E5.m1.3.3.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.3.3.1.1.1.3" xref="S3.E5.m1.3.3.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">ℳ</mi><mo id="S3.E5.m1.3.3.1.1.1.4" stretchy="false" xref="S3.E5.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.2" xref="S3.E5.m1.3.3.2.cmml">=</mo><mrow id="S3.E5.m1.3.3.3" xref="S3.E5.m1.3.3.3.cmml"><mrow id="S3.E5.m1.3.3.3.2" xref="S3.E5.m1.3.3.3.2.cmml"><msub id="S3.E5.m1.3.3.3.2.2" xref="S3.E5.m1.3.3.3.2.2.cmml"><mi id="S3.E5.m1.3.3.3.2.2.2" xref="S3.E5.m1.3.3.3.2.2.2.cmml">𝐏</mi><mi id="S3.E5.m1.3.3.3.2.2.3" xref="S3.E5.m1.3.3.3.2.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.3.3.3.2.1" xref="S3.E5.m1.3.3.3.2.1.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.3.2.3.2" xref="S3.E5.m1.3.3.3.2.cmml"><mo id="S3.E5.m1.3.3.3.2.3.2.1" stretchy="false" xref="S3.E5.m1.3.3.3.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">ℳ</mi><mo id="S3.E5.m1.3.3.3.2.3.2.2" rspace="0.055em" stretchy="false" xref="S3.E5.m1.3.3.3.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.3.1" rspace="0.222em" xref="S3.E5.m1.3.3.3.1.cmml">⊙</mo><msub id="S3.E5.m1.3.3.3.3" xref="S3.E5.m1.3.3.3.3.cmml"><mi id="S3.E5.m1.3.3.3.3.2" xref="S3.E5.m1.3.3.3.3.2.cmml">𝐖</mi><mi id="S3.E5.m1.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3"><eq id="S3.E5.m1.3.3.2.cmml" xref="S3.E5.m1.3.3.2"></eq><apply id="S3.E5.m1.3.3.1.cmml" xref="S3.E5.m1.3.3.1"><times id="S3.E5.m1.3.3.1.2.cmml" xref="S3.E5.m1.3.3.1.2"></times><ci id="S3.E5.m1.3.3.1.3a.cmml" xref="S3.E5.m1.3.3.1.3"><mtext id="S3.E5.m1.3.3.1.3.cmml" xref="S3.E5.m1.3.3.1.3">fMRLRec</mtext></ci><interval closure="open" id="S3.E5.m1.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1"><apply id="S3.E5.m1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2">𝐖</ci><ci id="S3.E5.m1.3.3.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">ℳ</ci></interval></apply><apply id="S3.E5.m1.3.3.3.cmml" xref="S3.E5.m1.3.3.3"><csymbol cd="latexml" id="S3.E5.m1.3.3.3.1.cmml" xref="S3.E5.m1.3.3.3.1">direct-product</csymbol><apply id="S3.E5.m1.3.3.3.2.cmml" xref="S3.E5.m1.3.3.3.2"><times id="S3.E5.m1.3.3.3.2.1.cmml" xref="S3.E5.m1.3.3.3.2.1"></times><apply id="S3.E5.m1.3.3.3.2.2.cmml" xref="S3.E5.m1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.2.2.1.cmml" xref="S3.E5.m1.3.3.3.2.2">subscript</csymbol><ci id="S3.E5.m1.3.3.3.2.2.2.cmml" xref="S3.E5.m1.3.3.3.2.2.2">𝐏</ci><ci id="S3.E5.m1.3.3.3.2.2.3.cmml" xref="S3.E5.m1.3.3.3.2.2.3">𝑖</ci></apply><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">ℳ</ci></apply><apply id="S3.E5.m1.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.1.cmml" xref="S3.E5.m1.3.3.3.3">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.2.cmml" xref="S3.E5.m1.3.3.3.3.2">𝐖</ci><ci id="S3.E5.m1.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\text{{fMRLRec}}(\mathbf{W}_{i},\mathcal{M})=\mathbf{P}_{i}(\mathcal{M})\odot%
\mathbf{W}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.3d">fMRLRec ( bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , caligraphic_M ) = bold_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( caligraphic_M ) ⊙ bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.8">Thus, <math alttext="X_{i}\cdot\text{{fMRLRec}}(\mathbf{W}_{i},P_{i}(\mathcal{M}))" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.6.m1.3"><semantics id="S3.SS2.SSS0.Px1.p1.6.m1.3a"><mrow id="S3.SS2.SSS0.Px1.p1.6.m1.3.3" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.cmml"><msub id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2.2.cmml">X</mi><mi id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2.3" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.1.cmml">⋅</mo><mtext id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.3" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.3a.cmml">fMRLRec</mtext></mrow><mo id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.3" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.3.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.3.cmml"><mo id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.3.cmml">(</mo><msub id="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1.2.cmml">𝐖</mi><mi id="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.4" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.3.cmml">,</mo><mrow id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.cmml"><msub id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2.2.cmml">P</mi><mi id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.1" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.3.2" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p1.6.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.1.cmml">ℳ</mi><mo id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.5" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.6.m1.3b"><apply id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3"><times id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.3"></times><apply id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4"><ci id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.1">⋅</ci><apply id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2.2">𝑋</ci><ci id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.3a.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.3"><mtext id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.4.3">fMRLRec</mtext></ci></apply><interval closure="open" id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2"><apply id="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1.2">𝐖</ci><ci id="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2"><times id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.1"></times><apply id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2.2">𝑃</ci><ci id="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.3.3.2.2.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.6.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m1.1.1">ℳ</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.6.m1.3c">X_{i}\cdot\text{{fMRLRec}}(\mathbf{W}_{i},P_{i}(\mathcal{M}))</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.6.m1.3d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ fMRLRec ( bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( caligraphic_M ) )</annotation></semantics></math> is equivalent to perform equation <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.E3" title="Equation 3 ‣ 3.2 Full-Scale Matryoshka Representation Learning for Recommendation ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> but only with one time multiplication of <math alttext="X_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.7.m2.1"><semantics id="S3.SS2.SSS0.Px1.p1.7.m2.1a"><msub id="S3.SS2.SSS0.Px1.p1.7.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.2.cmml">X</mi><mi id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.7.m2.1b"><apply id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.2">𝑋</ci><ci id="S3.SS2.SSS0.Px1.p1.7.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.7.m2.1c">X_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.7.m2.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and masked <math alttext="W_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.8.m3.1"><semantics id="S3.SS2.SSS0.Px1.p1.8.m3.1a"><msub id="S3.SS2.SSS0.Px1.p1.8.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.8.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.8.m3.1.1.2" xref="S3.SS2.SSS0.Px1.p1.8.m3.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS0.Px1.p1.8.m3.1.1.3" xref="S3.SS2.SSS0.Px1.p1.8.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.8.m3.1b"><apply id="S3.SS2.SSS0.Px1.p1.8.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.8.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.8.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m3.1.1.2">𝑊</ci><ci id="S3.SS2.SSS0.Px1.p1.8.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.8.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.8.m3.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.8.m3.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. See figure <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.F1" title="Figure 1 ‣ 3.2 Full-Scale Matryoshka Representation Learning for Recommendation ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> for an illustration of the fMRLRec operator.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.12">In summary, given a neural network represented by <math alttext="\mathcal{W}=\{W_{1},W_{2},\ldots W_{n}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.1.m1.3"><semantics id="S3.SS2.SSS0.Px1.p2.1.m1.3a"><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.5" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.5.cmml">𝒲</mi><mo id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.4.cmml"><mo id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.4" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.4.cmml">{</mo><msub id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.cmml">W</mi><mn id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.5" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.2.cmml">W</mi><mn id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.6" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.4.cmml">,</mo><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.2" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.2.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.1.cmml">⁢</mo><msub id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.2.cmml">W</mi><mi id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.3.cmml">n</mi></msub></mrow><mo id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.7" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.1.m1.3b"><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3"><eq id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.4"></eq><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.5.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.5">𝒲</ci><set id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3"><apply id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2">𝑊</ci><cn id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.2">𝑊</ci><cn id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.3">2</cn></apply><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3"><times id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.1"></times><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.2">…</ci><apply id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.2">𝑊</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.3.3.3.3.3.3.3">𝑛</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.1.m1.3c">\mathcal{W}=\{W_{1},W_{2},\ldots W_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.1.m1.3d">caligraphic_W = { italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … italic_W start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> where <math alttext="W_{i}\in\mathbb{R}^{d1\times d2}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p2.2.m2.1a"><mrow id="S3.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.2.cmml">W</mi><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.cmml"><mrow id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.2.cmml">d</mi><mo id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.1.cmml">⁢</mo><mn id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.3.cmml">1</mn></mrow><mo id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.3.cmml">d</mi></mrow><mo id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.1.cmml">⁢</mo><mn id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1"><in id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1"></in><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.2">𝑊</ci><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3"><times id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.1"></times><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2"><times id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.1"></times><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2"><times id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.1"></times><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.2">𝑑</ci><cn id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.3">1</cn></apply><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.3">𝑑</ci></apply><cn id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.2.m2.1c">W_{i}\in\mathbb{R}^{d1\times d2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d 1 × italic_d 2 end_POSTSUPERSCRIPT</annotation></semantics></math> and a set of sizes <math alttext="\mathcal{M}=\{2,4,8,\ldots,D\}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.3.m3.5"><semantics id="S3.SS2.SSS0.Px1.p2.3.m3.5a"><mrow id="S3.SS2.SSS0.Px1.p2.3.m3.5.6" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.2.cmml">ℳ</mi><mo id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.1.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.1.cmml"><mo id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.1.cmml">{</mo><mn id="S3.SS2.SSS0.Px1.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.cmml">2</mn><mo id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p2.3.m3.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m3.2.2.cmml">4</mn><mo id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.2.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.1.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p2.3.m3.3.3" xref="S3.SS2.SSS0.Px1.p2.3.m3.3.3.cmml">8</mn><mo id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.2.4" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p2.3.m3.4.4" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p2.3.m3.4.4.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.2.5" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p2.3.m3.5.5" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5.cmml">D</mi><mo id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.2.6" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.3.m3.5b"><apply id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6"><eq id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.1"></eq><ci id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.2">ℳ</ci><set id="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.6.3.2"><cn id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1">2</cn><cn id="S3.SS2.SSS0.Px1.p2.3.m3.2.2.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.3.m3.2.2">4</cn><cn id="S3.SS2.SSS0.Px1.p2.3.m3.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.3.m3.3.3">8</cn><ci id="S3.SS2.SSS0.Px1.p2.3.m3.4.4.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.4.4">…</ci><ci id="S3.SS2.SSS0.Px1.p2.3.m3.5.5.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.5.5">𝐷</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.3.m3.5c">\mathcal{M}=\{2,4,8,\ldots,D\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.3.m3.5d">caligraphic_M = { 2 , 4 , 8 , … , italic_D }</annotation></semantics></math>, we could find an fMRLRec-slicing of <math alttext="\mathcal{W}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.4.m4.1b"><ci id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.4.m4.1c">\mathcal{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.4.m4.1d">caligraphic_W</annotation></semantics></math> such that the first <math alttext="\mathcal{M}[j]" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p2.5.m5.1a"><mrow id="S3.SS2.SSS0.Px1.p2.5.m5.1.2" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.5.m5.1.2.2" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.2.2.cmml">ℳ</mi><mo id="S3.SS2.SSS0.Px1.p2.5.m5.1.2.1" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p2.5.m5.1.2.3.2" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.2.3.1.cmml"><mo id="S3.SS2.SSS0.Px1.p2.5.m5.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.2.3.1.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.cmml">j</mi><mo id="S3.SS2.SSS0.Px1.p2.5.m5.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.5.m5.1b"><apply id="S3.SS2.SSS0.Px1.p2.5.m5.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.2"><times id="S3.SS2.SSS0.Px1.p2.5.m5.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.2.1"></times><ci id="S3.SS2.SSS0.Px1.p2.5.m5.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.2.2">ℳ</ci><apply id="S3.SS2.SSS0.Px1.p2.5.m5.1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.2.3.2"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p2.5.m5.1.2.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.5.m5.1c">\mathcal{M}[j]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.5.m5.1d">caligraphic_M [ italic_j ]</annotation></semantics></math> elements of input <math alttext="X_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.6.m6.1"><semantics id="S3.SS2.SSS0.Px1.p2.6.m6.1a"><msub id="S3.SS2.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.cmml">X</mi><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.6.m6.1b"><apply id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.2">𝑋</ci><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.6.m6.1c">X_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.6.m6.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is only processed by corresponding chunks in <math alttext="W_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.7.m7.1"><semantics id="S3.SS2.SSS0.Px1.p2.7.m7.1a"><msub id="S3.SS2.SSS0.Px1.p2.7.m7.1.1" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.2" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.3" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.7.m7.1b"><apply id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.2">𝑊</ci><ci id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.7.m7.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.7.m7.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. After the model is trained, we take the first <math alttext="[0:\mathcal{M}[j],0:k\mathcal{M}[j]" class="ltx_math_unparsed" display="inline" id="S3.SS2.SSS0.Px1.p2.8.m8.3"><semantics id="S3.SS2.SSS0.Px1.p2.8.m8.3a"><mrow id="S3.SS2.SSS0.Px1.p2.8.m8.3b"><mo id="S3.SS2.SSS0.Px1.p2.8.m8.3.4" stretchy="false">[</mo><mn id="S3.SS2.SSS0.Px1.p2.8.m8.3.5">0</mn><mo id="S3.SS2.SSS0.Px1.p2.8.m8.3.6" lspace="0.278em" rspace="0.278em">:</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.8.m8.3.7">ℳ</mi><mrow id="S3.SS2.SSS0.Px1.p2.8.m8.3.8"><mo id="S3.SS2.SSS0.Px1.p2.8.m8.3.8.1" stretchy="false">[</mo><mi id="S3.SS2.SSS0.Px1.p2.8.m8.1.1">j</mi><mo id="S3.SS2.SSS0.Px1.p2.8.m8.3.8.2" stretchy="false">]</mo></mrow><mo id="S3.SS2.SSS0.Px1.p2.8.m8.3.9">,</mo><mn id="S3.SS2.SSS0.Px1.p2.8.m8.2.2">0</mn><mo id="S3.SS2.SSS0.Px1.p2.8.m8.3.10" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.SS2.SSS0.Px1.p2.8.m8.3.11">k</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.8.m8.3.12">ℳ</mi><mrow id="S3.SS2.SSS0.Px1.p2.8.m8.3.13"><mo id="S3.SS2.SSS0.Px1.p2.8.m8.3.13.1" stretchy="false">[</mo><mi id="S3.SS2.SSS0.Px1.p2.8.m8.3.3">j</mi><mo id="S3.SS2.SSS0.Px1.p2.8.m8.3.13.2" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.8.m8.3c">[0:\mathcal{M}[j],0:k\mathcal{M}[j]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.8.m8.3d">[ 0 : caligraphic_M [ italic_j ] , 0 : italic_k caligraphic_M [ italic_j ]</annotation></semantics></math> or <math alttext="[0:k\mathcal{M}[j],0:\mathcal{M}[j]]" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.9.m9.4"><semantics id="S3.SS2.SSS0.Px1.p2.9.m9.4a"><mrow id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.2.cmml"><mo id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.2.1.cmml">[</mo><mrow id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.cmml"><mn id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.3" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.3.cmml">0</mn><mo id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.4" lspace="0.278em" rspace="0.278em" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.4.cmml">:</mo><mrow id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.2.cmml"><mrow id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.2.cmml">k</mi><mo id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.3.cmml">ℳ</mi><mo id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.1a" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.4.2" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.4.1.cmml"><mo id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.4.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.4.1.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p2.9.m9.1.1" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.cmml">j</mi><mo id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.4.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.2.cmml">,</mo><mn id="S3.SS2.SSS0.Px1.p2.9.m9.2.2" xref="S3.SS2.SSS0.Px1.p2.9.m9.2.2.cmml">0</mn></mrow><mo id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.5" lspace="0.278em" rspace="0.278em" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.5.cmml">:</mo><mrow id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.2" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.2.cmml">ℳ</mi><mo id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.1" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.3.2" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.3.1.cmml"><mo id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.3.1.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p2.9.m9.3.3" xref="S3.SS2.SSS0.Px1.p2.9.m9.3.3.cmml">j</mi><mo id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.9.m9.4b"><apply id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.2.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1"><and id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1a.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1"></and><apply id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1b.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1"><ci id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.4.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.4">:</ci><cn id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.3">0</cn><list id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1"><apply id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1"><times id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.1"></times><ci id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.2">𝑘</ci><ci id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.3">ℳ</ci><apply id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.4.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.4.2"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1">𝑗</ci></apply></apply><cn id="S3.SS2.SSS0.Px1.p2.9.m9.2.2.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.9.m9.2.2">0</cn></list></apply><apply id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1c.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1"><ci id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.5.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.5">:</ci><share href="https://arxiv.org/html/2409.16627v2#S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.1.cmml" id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1d.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1"></share><apply id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6"><times id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.1"></times><ci id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.2.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.2">ℳ</ci><apply id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.3.2"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.4.4.1.1.6.3.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p2.9.m9.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.9.m9.4c">[0:k\mathcal{M}[j],0:\mathcal{M}[j]]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.9.m9.4d">[ 0 : italic_k caligraphic_M [ italic_j ] , 0 : caligraphic_M [ italic_j ] ]</annotation></semantics></math> (depending on the cases in equation <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.E2" title="Equation 2 ‣ 3.2 Full-Scale Matryoshka Representation Learning for Recommendation ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>) slice for each <math alttext="W_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.10.m10.1"><semantics id="S3.SS2.SSS0.Px1.p2.10.m10.1a"><msub id="S3.SS2.SSS0.Px1.p2.10.m10.1.1" xref="S3.SS2.SSS0.Px1.p2.10.m10.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.10.m10.1.1.2" xref="S3.SS2.SSS0.Px1.p2.10.m10.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS0.Px1.p2.10.m10.1.1.3" xref="S3.SS2.SSS0.Px1.p2.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.10.m10.1b"><apply id="S3.SS2.SSS0.Px1.p2.10.m10.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.10.m10.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.10.m10.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.10.m10.1.1.2">𝑊</ci><ci id="S3.SS2.SSS0.Px1.p2.10.m10.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.10.m10.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.10.m10.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to form <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px1.p2.12.1">independent</span> small models called fMRLRec-series models for inference. Also refer to the upper left of figure <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.F1" title="Figure 1 ‣ 3.2 Full-Scale Matryoshka Representation Learning for Recommendation ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> for the slicing process. For <math alttext="W_{i}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.11.m11.1"><semantics id="S3.SS2.SSS0.Px1.p2.11.m11.1a"><mrow id="S3.SS2.SSS0.Px1.p2.11.m11.1.1" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2.2" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2.2.cmml">W</mi><mi id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.1" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3.3" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.11.m11.1b"><apply id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1"><in id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.1"></in><apply id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2.2">𝑊</ci><ci id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.11.m11.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.11.m11.1c">W_{i}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.11.m11.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, one can leave it as is during training and naturally extract <math alttext="[0:\mathcal{M}[j]]" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.12.m12.2"><semantics id="S3.SS2.SSS0.Px1.p2.12.m12.2a"><mrow id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.2.cmml"><mo id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.2.1.cmml">[</mo><mrow id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.cmml"><mn id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.2" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.2.cmml">0</mn><mo id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.1.cmml">:</mo><mrow id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.2.cmml">ℳ</mi><mo id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.1" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.3.1.cmml"><mo id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.3.1.1.cmml">[</mo><mi id="S3.SS2.SSS0.Px1.p2.12.m12.1.1" xref="S3.SS2.SSS0.Px1.p2.12.m12.1.1.cmml">j</mi><mo id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.12.m12.2b"><apply id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.2">delimited-[]</csymbol><apply id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1"><ci id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.1">:</ci><cn id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.2.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.2">0</cn><apply id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3"><times id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.1"></times><ci id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.2">ℳ</ci><apply id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.3.2"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.12.m12.2.2.1.1.3.3.2.1">delimited-[]</csymbol><ci id="S3.SS2.SSS0.Px1.p2.12.m12.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.12.m12.1.1">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.12.m12.2c">[0:\mathcal{M}[j]]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.12.m12.2d">[ 0 : caligraphic_M [ italic_j ] ]</annotation></semantics></math> of it during inference.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Overall Framework</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The overall framework of fMRLRec is illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.F2" title="In 3.2 Full-Scale Matryoshka Representation Learning for Recommendation ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, including feature encodings, LRU-based recommendation module, fMRLRec weight masking, etc.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Language and Image Encoding</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.2">We adopt textural item description as the language input source and image as visual input. Given a metadata dictionary <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><ci id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">caligraphic_M</annotation></semantics></math> containing attributes for each item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.1"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mi id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.1d">italic_i</annotation></semantics></math>, we extract its attributes Title, Price, Brand and Categories and perform concatenation of attributes:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Text}_{i}=\text{Title}_{i}+\text{Price}_{i}+\text{Brand}_{i}+\text{%
Categories}_{i}" class="ltx_Math" display="block" id="S3.Ex3.m1.1"><semantics id="S3.Ex3.m1.1a"><mrow id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml"><msub id="S3.Ex3.m1.1.1.2" xref="S3.Ex3.m1.1.1.2.cmml"><mtext id="S3.Ex3.m1.1.1.2.2" xref="S3.Ex3.m1.1.1.2.2a.cmml">Text</mtext><mi id="S3.Ex3.m1.1.1.2.3" xref="S3.Ex3.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.cmml">=</mo><mrow id="S3.Ex3.m1.1.1.3" xref="S3.Ex3.m1.1.1.3.cmml"><msub id="S3.Ex3.m1.1.1.3.2" xref="S3.Ex3.m1.1.1.3.2.cmml"><mtext id="S3.Ex3.m1.1.1.3.2.2" xref="S3.Ex3.m1.1.1.3.2.2a.cmml">Title</mtext><mi id="S3.Ex3.m1.1.1.3.2.3" xref="S3.Ex3.m1.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.Ex3.m1.1.1.3.1" xref="S3.Ex3.m1.1.1.3.1.cmml">+</mo><msub id="S3.Ex3.m1.1.1.3.3" xref="S3.Ex3.m1.1.1.3.3.cmml"><mtext id="S3.Ex3.m1.1.1.3.3.2" xref="S3.Ex3.m1.1.1.3.3.2a.cmml">Price</mtext><mi id="S3.Ex3.m1.1.1.3.3.3" xref="S3.Ex3.m1.1.1.3.3.3.cmml">i</mi></msub><mo id="S3.Ex3.m1.1.1.3.1a" xref="S3.Ex3.m1.1.1.3.1.cmml">+</mo><msub id="S3.Ex3.m1.1.1.3.4" xref="S3.Ex3.m1.1.1.3.4.cmml"><mtext id="S3.Ex3.m1.1.1.3.4.2" xref="S3.Ex3.m1.1.1.3.4.2a.cmml">Brand</mtext><mi id="S3.Ex3.m1.1.1.3.4.3" xref="S3.Ex3.m1.1.1.3.4.3.cmml">i</mi></msub><mo id="S3.Ex3.m1.1.1.3.1b" xref="S3.Ex3.m1.1.1.3.1.cmml">+</mo><msub id="S3.Ex3.m1.1.1.3.5" xref="S3.Ex3.m1.1.1.3.5.cmml"><mtext id="S3.Ex3.m1.1.1.3.5.2" xref="S3.Ex3.m1.1.1.3.5.2a.cmml">Categories</mtext><mi id="S3.Ex3.m1.1.1.3.5.3" xref="S3.Ex3.m1.1.1.3.5.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><apply id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1"><eq id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"></eq><apply id="S3.Ex3.m1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.2.1.cmml" xref="S3.Ex3.m1.1.1.2">subscript</csymbol><ci id="S3.Ex3.m1.1.1.2.2a.cmml" xref="S3.Ex3.m1.1.1.2.2"><mtext id="S3.Ex3.m1.1.1.2.2.cmml" xref="S3.Ex3.m1.1.1.2.2">Text</mtext></ci><ci id="S3.Ex3.m1.1.1.2.3.cmml" xref="S3.Ex3.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.Ex3.m1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.3"><plus id="S3.Ex3.m1.1.1.3.1.cmml" xref="S3.Ex3.m1.1.1.3.1"></plus><apply id="S3.Ex3.m1.1.1.3.2.cmml" xref="S3.Ex3.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.3.2.1.cmml" xref="S3.Ex3.m1.1.1.3.2">subscript</csymbol><ci id="S3.Ex3.m1.1.1.3.2.2a.cmml" xref="S3.Ex3.m1.1.1.3.2.2"><mtext id="S3.Ex3.m1.1.1.3.2.2.cmml" xref="S3.Ex3.m1.1.1.3.2.2">Title</mtext></ci><ci id="S3.Ex3.m1.1.1.3.2.3.cmml" xref="S3.Ex3.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.Ex3.m1.1.1.3.3.cmml" xref="S3.Ex3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.3.3.1.cmml" xref="S3.Ex3.m1.1.1.3.3">subscript</csymbol><ci id="S3.Ex3.m1.1.1.3.3.2a.cmml" xref="S3.Ex3.m1.1.1.3.3.2"><mtext id="S3.Ex3.m1.1.1.3.3.2.cmml" xref="S3.Ex3.m1.1.1.3.3.2">Price</mtext></ci><ci id="S3.Ex3.m1.1.1.3.3.3.cmml" xref="S3.Ex3.m1.1.1.3.3.3">𝑖</ci></apply><apply id="S3.Ex3.m1.1.1.3.4.cmml" xref="S3.Ex3.m1.1.1.3.4"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.3.4.1.cmml" xref="S3.Ex3.m1.1.1.3.4">subscript</csymbol><ci id="S3.Ex3.m1.1.1.3.4.2a.cmml" xref="S3.Ex3.m1.1.1.3.4.2"><mtext id="S3.Ex3.m1.1.1.3.4.2.cmml" xref="S3.Ex3.m1.1.1.3.4.2">Brand</mtext></ci><ci id="S3.Ex3.m1.1.1.3.4.3.cmml" xref="S3.Ex3.m1.1.1.3.4.3">𝑖</ci></apply><apply id="S3.Ex3.m1.1.1.3.5.cmml" xref="S3.Ex3.m1.1.1.3.5"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.3.5.1.cmml" xref="S3.Ex3.m1.1.1.3.5">subscript</csymbol><ci id="S3.Ex3.m1.1.1.3.5.2a.cmml" xref="S3.Ex3.m1.1.1.3.5.2"><mtext id="S3.Ex3.m1.1.1.3.5.2.cmml" xref="S3.Ex3.m1.1.1.3.5.2">Categories</mtext></ci><ci id="S3.Ex3.m1.1.1.3.5.3.cmml" xref="S3.Ex3.m1.1.1.3.5.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\text{Text}_{i}=\text{Title}_{i}+\text{Price}_{i}+\text{Brand}_{i}+\text{%
Categories}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.1d">Text start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = Title start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + Price start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + Brand start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + Categories start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS1.p1.4">We then encode these text attributes and image attributes using pretrained embedding models <math alttext="f" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.3.m1.1"><semantics id="S3.SS3.SSS1.p1.3.m1.1a"><mi id="S3.SS3.SSS1.p1.3.m1.1.1" xref="S3.SS3.SSS1.p1.3.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m1.1b"><ci id="S3.SS3.SSS1.p1.3.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.3.m1.1d">italic_f</annotation></semantics></math>. For each item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.4.m2.1"><semantics id="S3.SS3.SSS1.p1.4.m2.1a"><mi id="S3.SS3.SSS1.p1.4.m2.1.1" xref="S3.SS3.SSS1.p1.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.4.m2.1b"><ci id="S3.SS3.SSS1.p1.4.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.4.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.4.m2.1d">italic_i</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{E}_{\text{lang},i}=f_{\text{lang}}(\text{Text}_{i}),\;\mathbf{E}_{%
\text{img},i}=f_{\text{img}}(\text{Img}_{i})" class="ltx_Math" display="block" id="S3.E6.m1.6"><semantics id="S3.E6.m1.6a"><mrow id="S3.E6.m1.6.6.2" xref="S3.E6.m1.6.6.3.cmml"><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml"><msub id="S3.E6.m1.5.5.1.1.3" xref="S3.E6.m1.5.5.1.1.3.cmml"><mi id="S3.E6.m1.5.5.1.1.3.2" xref="S3.E6.m1.5.5.1.1.3.2.cmml">𝐄</mi><mrow id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.3.cmml"><mtext id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1a.cmml">lang</mtext><mo id="S3.E6.m1.2.2.2.4.1" xref="S3.E6.m1.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E6.m1.5.5.1.1.2" xref="S3.E6.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.5.5.1.1.1" xref="S3.E6.m1.5.5.1.1.1.cmml"><msub id="S3.E6.m1.5.5.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.3.cmml"><mi id="S3.E6.m1.5.5.1.1.1.3.2" xref="S3.E6.m1.5.5.1.1.1.3.2.cmml">f</mi><mtext id="S3.E6.m1.5.5.1.1.1.3.3" xref="S3.E6.m1.5.5.1.1.1.3.3a.cmml">lang</mtext></msub><mo id="S3.E6.m1.5.5.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.5.5.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.5.5.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml"><mtext id="S3.E6.m1.5.5.1.1.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2a.cmml">Text</mtext><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.6.6.2.3" rspace="0.447em" xref="S3.E6.m1.6.6.3a.cmml">,</mo><mrow id="S3.E6.m1.6.6.2.2" xref="S3.E6.m1.6.6.2.2.cmml"><msub id="S3.E6.m1.6.6.2.2.3" xref="S3.E6.m1.6.6.2.2.3.cmml"><mi id="S3.E6.m1.6.6.2.2.3.2" xref="S3.E6.m1.6.6.2.2.3.2.cmml">𝐄</mi><mrow id="S3.E6.m1.4.4.2.4" xref="S3.E6.m1.4.4.2.3.cmml"><mtext id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1a.cmml">img</mtext><mo id="S3.E6.m1.4.4.2.4.1" xref="S3.E6.m1.4.4.2.3.cmml">,</mo><mi id="S3.E6.m1.4.4.2.2" xref="S3.E6.m1.4.4.2.2.cmml">i</mi></mrow></msub><mo id="S3.E6.m1.6.6.2.2.2" xref="S3.E6.m1.6.6.2.2.2.cmml">=</mo><mrow id="S3.E6.m1.6.6.2.2.1" xref="S3.E6.m1.6.6.2.2.1.cmml"><msub id="S3.E6.m1.6.6.2.2.1.3" xref="S3.E6.m1.6.6.2.2.1.3.cmml"><mi id="S3.E6.m1.6.6.2.2.1.3.2" xref="S3.E6.m1.6.6.2.2.1.3.2.cmml">f</mi><mtext id="S3.E6.m1.6.6.2.2.1.3.3" xref="S3.E6.m1.6.6.2.2.1.3.3a.cmml">img</mtext></msub><mo id="S3.E6.m1.6.6.2.2.1.2" xref="S3.E6.m1.6.6.2.2.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.6.6.2.2.1.1.1" xref="S3.E6.m1.6.6.2.2.1.1.1.1.cmml"><mo id="S3.E6.m1.6.6.2.2.1.1.1.2" stretchy="false" xref="S3.E6.m1.6.6.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.6.6.2.2.1.1.1.1" xref="S3.E6.m1.6.6.2.2.1.1.1.1.cmml"><mtext id="S3.E6.m1.6.6.2.2.1.1.1.1.2" xref="S3.E6.m1.6.6.2.2.1.1.1.1.2a.cmml">Img</mtext><mi id="S3.E6.m1.6.6.2.2.1.1.1.1.3" xref="S3.E6.m1.6.6.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.6.6.2.2.1.1.1.3" stretchy="false" xref="S3.E6.m1.6.6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.6b"><apply id="S3.E6.m1.6.6.3.cmml" xref="S3.E6.m1.6.6.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.3a.cmml" xref="S3.E6.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1.1"><eq id="S3.E6.m1.5.5.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.2"></eq><apply id="S3.E6.m1.5.5.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.3">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.3.2.cmml" xref="S3.E6.m1.5.5.1.1.3.2">𝐄</ci><list id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.4"><ci id="S3.E6.m1.1.1.1.1a.cmml" xref="S3.E6.m1.1.1.1.1"><mtext id="S3.E6.m1.1.1.1.1.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1">lang</mtext></ci><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E6.m1.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1"><times id="S3.E6.m1.5.5.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.2"></times><apply id="S3.E6.m1.5.5.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.3.2.cmml" xref="S3.E6.m1.5.5.1.1.1.3.2">𝑓</ci><ci id="S3.E6.m1.5.5.1.1.1.3.3a.cmml" xref="S3.E6.m1.5.5.1.1.1.3.3"><mtext id="S3.E6.m1.5.5.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E6.m1.5.5.1.1.1.3.3">lang</mtext></ci></apply><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.2a.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2"><mtext id="S3.E6.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2">Text</mtext></ci><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E6.m1.6.6.2.2.cmml" xref="S3.E6.m1.6.6.2.2"><eq id="S3.E6.m1.6.6.2.2.2.cmml" xref="S3.E6.m1.6.6.2.2.2"></eq><apply id="S3.E6.m1.6.6.2.2.3.cmml" xref="S3.E6.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.2.2.3.1.cmml" xref="S3.E6.m1.6.6.2.2.3">subscript</csymbol><ci id="S3.E6.m1.6.6.2.2.3.2.cmml" xref="S3.E6.m1.6.6.2.2.3.2">𝐄</ci><list id="S3.E6.m1.4.4.2.3.cmml" xref="S3.E6.m1.4.4.2.4"><ci id="S3.E6.m1.3.3.1.1a.cmml" xref="S3.E6.m1.3.3.1.1"><mtext id="S3.E6.m1.3.3.1.1.cmml" mathsize="70%" xref="S3.E6.m1.3.3.1.1">img</mtext></ci><ci id="S3.E6.m1.4.4.2.2.cmml" xref="S3.E6.m1.4.4.2.2">𝑖</ci></list></apply><apply id="S3.E6.m1.6.6.2.2.1.cmml" xref="S3.E6.m1.6.6.2.2.1"><times id="S3.E6.m1.6.6.2.2.1.2.cmml" xref="S3.E6.m1.6.6.2.2.1.2"></times><apply id="S3.E6.m1.6.6.2.2.1.3.cmml" xref="S3.E6.m1.6.6.2.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.2.2.1.3.1.cmml" xref="S3.E6.m1.6.6.2.2.1.3">subscript</csymbol><ci id="S3.E6.m1.6.6.2.2.1.3.2.cmml" xref="S3.E6.m1.6.6.2.2.1.3.2">𝑓</ci><ci id="S3.E6.m1.6.6.2.2.1.3.3a.cmml" xref="S3.E6.m1.6.6.2.2.1.3.3"><mtext id="S3.E6.m1.6.6.2.2.1.3.3.cmml" mathsize="70%" xref="S3.E6.m1.6.6.2.2.1.3.3">img</mtext></ci></apply><apply id="S3.E6.m1.6.6.2.2.1.1.1.1.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1">subscript</csymbol><ci id="S3.E6.m1.6.6.2.2.1.1.1.1.2a.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1.1.2"><mtext id="S3.E6.m1.6.6.2.2.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1.1.2">Img</mtext></ci><ci id="S3.E6.m1.6.6.2.2.1.1.1.1.3.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.6c">\mathbf{E}_{\text{lang},i}=f_{\text{lang}}(\text{Text}_{i}),\;\mathbf{E}_{%
\text{img},i}=f_{\text{img}}(\text{Img}_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.6d">bold_E start_POSTSUBSCRIPT lang , italic_i end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT lang end_POSTSUBSCRIPT ( Text start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , bold_E start_POSTSUBSCRIPT img , italic_i end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT img end_POSTSUBSCRIPT ( Img start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p2">
<p class="ltx_p" id="S3.SS3.SSS1.p2.5">We combine text and image embedding through concatenation followed by a simple yet effective linear projection:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{E}=(\text{Concat}(\mathbf{E}_{\text{lang}},\mathbf{E}_{\text{img}}))%
\mathbf{W}_{\text{proj}}+\mathbf{b}_{\text{proj}}" class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mi id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml">𝐄</mi><mo id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E7.m1.1.1.1.1.1.1.1.4" xref="S3.E7.m1.1.1.1.1.1.1.1.4a.cmml">Concat</mtext><mo id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐄</mi><mtext id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3a.cmml">lang</mtext></msub><mo id="S3.E7.m1.1.1.1.1.1.1.1.2.2.4" xref="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐄</mi><mtext id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3a.cmml">img</mtext></msub><mo id="S3.E7.m1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml">𝐖</mi><mtext id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3a.cmml">proj</mtext></msub></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.2.cmml">+</mo><msub id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.3.2.cmml">𝐛</mi><mtext id="S3.E7.m1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.3.3a.cmml">proj</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><eq id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2"></eq><ci id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3">𝐄</ci><apply id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><plus id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.2"></plus><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"></times><apply id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3"></times><ci id="S3.E7.m1.1.1.1.1.1.1.1.4a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.4"><mtext id="S3.E7.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.4">Concat</mtext></ci><interval closure="open" id="S3.E7.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2"><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2">𝐄</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3">lang</mtext></ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.2">𝐄</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3"><mtext id="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" mathsize="70%" xref="S3.E7.m1.1.1.1.1.1.1.1.2.2.2.3">img</mtext></ci></apply></interval></apply><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2">𝐖</ci><ci id="S3.E7.m1.1.1.1.1.3.3a.cmml" xref="S3.E7.m1.1.1.1.1.3.3"><mtext id="S3.E7.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E7.m1.1.1.1.1.3.3">proj</mtext></ci></apply></apply><apply id="S3.E7.m1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.3.2">𝐛</ci><ci id="S3.E7.m1.1.1.1.3.3a.cmml" xref="S3.E7.m1.1.1.1.3.3"><mtext id="S3.E7.m1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E7.m1.1.1.1.3.3">proj</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\mathbf{E}=(\text{Concat}(\mathbf{E}_{\text{lang}},\mathbf{E}_{\text{img}}))%
\mathbf{W}_{\text{proj}}+\mathbf{b}_{\text{proj}}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">bold_E = ( Concat ( bold_E start_POSTSUBSCRIPT lang end_POSTSUBSCRIPT , bold_E start_POSTSUBSCRIPT img end_POSTSUBSCRIPT ) ) bold_W start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS1.p2.4">where <math alttext="\mathbf{W}_{\text{proj}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.1.m1.1"><semantics id="S3.SS3.SSS1.p2.1.m1.1a"><msub id="S3.SS3.SSS1.p2.1.m1.1.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.1.1.2" xref="S3.SS3.SSS1.p2.1.m1.1.1.2.cmml">𝐖</mi><mtext id="S3.SS3.SSS1.p2.1.m1.1.1.3" xref="S3.SS3.SSS1.p2.1.m1.1.1.3a.cmml">proj</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.1.m1.1b"><apply id="S3.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.2">𝐖</ci><ci id="S3.SS3.SSS1.p2.1.m1.1.1.3a.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1.3"><mtext id="S3.SS3.SSS1.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS1.p2.1.m1.1.1.3">proj</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.1.m1.1c">\mathbf{W}_{\text{proj}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.1.m1.1d">bold_W start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{b}_{\text{proj}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.2.m2.1"><semantics id="S3.SS3.SSS1.p2.2.m2.1a"><msub id="S3.SS3.SSS1.p2.2.m2.1.1" xref="S3.SS3.SSS1.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p2.2.m2.1.1.2" xref="S3.SS3.SSS1.p2.2.m2.1.1.2.cmml">𝐛</mi><mtext id="S3.SS3.SSS1.p2.2.m2.1.1.3" xref="S3.SS3.SSS1.p2.2.m2.1.1.3a.cmml">proj</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.2.m2.1b"><apply id="S3.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1.2">𝐛</ci><ci id="S3.SS3.SSS1.p2.2.m2.1.1.3a.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1.3"><mtext id="S3.SS3.SSS1.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS1.p2.2.m2.1.1.3">proj</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.2.m2.1c">\mathbf{b}_{\text{proj}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.2.m2.1d">bold_b start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT</annotation></semantics></math> are the projection weights and <math alttext="\mathbf{W}_{\text{proj}}\in\mathbb{R}^{(D_{\text{lang}}+D_{\text{img}})\times D}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.3.m3.1"><semantics id="S3.SS3.SSS1.p2.3.m3.1a"><mrow id="S3.SS3.SSS1.p2.3.m3.1.2" xref="S3.SS3.SSS1.p2.3.m3.1.2.cmml"><msub id="S3.SS3.SSS1.p2.3.m3.1.2.2" xref="S3.SS3.SSS1.p2.3.m3.1.2.2.cmml"><mi id="S3.SS3.SSS1.p2.3.m3.1.2.2.2" xref="S3.SS3.SSS1.p2.3.m3.1.2.2.2.cmml">𝐖</mi><mtext id="S3.SS3.SSS1.p2.3.m3.1.2.2.3" xref="S3.SS3.SSS1.p2.3.m3.1.2.2.3a.cmml">proj</mtext></msub><mo id="S3.SS3.SSS1.p2.3.m3.1.2.1" xref="S3.SS3.SSS1.p2.3.m3.1.2.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p2.3.m3.1.2.3" xref="S3.SS3.SSS1.p2.3.m3.1.2.3.cmml"><mi id="S3.SS3.SSS1.p2.3.m3.1.2.3.2" xref="S3.SS3.SSS1.p2.3.m3.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p2.3.m3.1.1.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.cmml"><mrow id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.cmml"><msub id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.2.cmml">D</mi><mtext id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.3a.cmml">lang</mtext></msub><mo id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.2" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.2.cmml">D</mi><mtext id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.3a.cmml">img</mtext></msub></mrow><mo id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.SSS1.p2.3.m3.1.1.1.2" rspace="0.222em" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.2.cmml">×</mo><mi id="S3.SS3.SSS1.p2.3.m3.1.1.1.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.3.m3.1b"><apply id="S3.SS3.SSS1.p2.3.m3.1.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.2"><in id="S3.SS3.SSS1.p2.3.m3.1.2.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.2.1"></in><apply id="S3.SS3.SSS1.p2.3.m3.1.2.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.3.m3.1.2.2.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p2.3.m3.1.2.2.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.2.2.2">𝐖</ci><ci id="S3.SS3.SSS1.p2.3.m3.1.2.2.3a.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.2.2.3"><mtext id="S3.SS3.SSS1.p2.3.m3.1.2.2.3.cmml" mathsize="70%" xref="S3.SS3.SSS1.p2.3.m3.1.2.2.3">proj</mtext></ci></apply><apply id="S3.SS3.SSS1.p2.3.m3.1.2.3.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.3.m3.1.2.3.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.2.3">superscript</csymbol><ci id="S3.SS3.SSS1.p2.3.m3.1.2.3.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.2.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1"><times id="S3.SS3.SSS1.p2.3.m3.1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.2"></times><apply id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1"><plus id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.1"></plus><apply id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.2">𝐷</ci><ci id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.3a.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.3"><mtext id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.3.cmml" mathsize="50%" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.2.3">lang</mtext></ci></apply><apply id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.2">𝐷</ci><ci id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.3a.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.3"><mtext id="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.3.cmml" mathsize="50%" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.3.3">img</mtext></ci></apply></apply><ci id="S3.SS3.SSS1.p2.3.m3.1.1.1.3.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.1.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.3.m3.1c">\mathbf{W}_{\text{proj}}\in\mathbb{R}^{(D_{\text{lang}}+D_{\text{img}})\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.3.m3.1d">bold_W start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_D start_POSTSUBSCRIPT lang end_POSTSUBSCRIPT + italic_D start_POSTSUBSCRIPT img end_POSTSUBSCRIPT ) × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{b}_{\text{proj}}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.4.m4.1"><semantics id="S3.SS3.SSS1.p2.4.m4.1a"><mrow id="S3.SS3.SSS1.p2.4.m4.1.1" xref="S3.SS3.SSS1.p2.4.m4.1.1.cmml"><msub id="S3.SS3.SSS1.p2.4.m4.1.1.2" xref="S3.SS3.SSS1.p2.4.m4.1.1.2.cmml"><mi id="S3.SS3.SSS1.p2.4.m4.1.1.2.2" xref="S3.SS3.SSS1.p2.4.m4.1.1.2.2.cmml">𝐛</mi><mtext id="S3.SS3.SSS1.p2.4.m4.1.1.2.3" xref="S3.SS3.SSS1.p2.4.m4.1.1.2.3a.cmml">proj</mtext></msub><mo id="S3.SS3.SSS1.p2.4.m4.1.1.1" xref="S3.SS3.SSS1.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p2.4.m4.1.1.3" xref="S3.SS3.SSS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSS1.p2.4.m4.1.1.3.2" xref="S3.SS3.SSS1.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS1.p2.4.m4.1.1.3.3" xref="S3.SS3.SSS1.p2.4.m4.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.4.m4.1b"><apply id="S3.SS3.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1"><in id="S3.SS3.SSS1.p2.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.1"></in><apply id="S3.SS3.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.4.m4.1.1.2.1.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p2.4.m4.1.1.2.2.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.2.2">𝐛</ci><ci id="S3.SS3.SSS1.p2.4.m4.1.1.2.3a.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.2.3"><mtext id="S3.SS3.SSS1.p2.4.m4.1.1.2.3.cmml" mathsize="70%" xref="S3.SS3.SSS1.p2.4.m4.1.1.2.3">proj</mtext></ci></apply><apply id="S3.SS3.SSS1.p2.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.4.m4.1c">\mathbf{b}_{\text{proj}}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.4.m4.1d">bold_b start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Linear Recurrent Units</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.1">We adopt Linear Recurrent Units (LRU) for sequence processing for its (1) superior performance and (2) both low training and inference cost compared with RNN and Self-Attention-based models <cite class="ltx_cite ltx_citemacro_cite">Orvieto et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib22" title="">2023</a>); Yue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib37" title="">2024</a>)</cite>. Intuitively, LRU is capable of parallel training like Self-Attention and inference like RNN, where inference complexity can be performed incrementally.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p2">
<p class="ltx_p" id="S3.SS3.SSS2.p2.7">Given input <math alttext="x_{k}\in\mathbb{R}^{B\times H_{\mathrm{in}}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.1.m1.1"><semantics id="S3.SS3.SSS2.p2.1.m1.1a"><mrow id="S3.SS3.SSS2.p2.1.m1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.cmml"><msub id="S3.SS3.SSS2.p2.1.m1.1.1.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.1.2.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.2.cmml">x</mi><mi id="S3.SS3.SSS2.p2.1.m1.1.1.2.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS3.SSS2.p2.1.m1.1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.1.m1.1.1.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.1.3.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.1.m1.1.1.3.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.2.cmml">B</mi><mo id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3.2.cmml">H</mi><mi id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3.3.cmml">in</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.m1.1b"><apply id="S3.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1"><in id="S3.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.1"></in><apply id="S3.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.2">𝑥</ci><ci id="S3.SS3.SSS2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3"><times id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.2">𝐵</ci><apply id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3.2">𝐻</ci><ci id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.3.3">in</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.m1.1c">x_{k}\in\mathbb{R}^{B\times H_{\mathrm{in}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> at time step <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.2.m2.1"><semantics id="S3.SS3.SSS2.p2.2.m2.1a"><mi id="S3.SS3.SSS2.p2.2.m2.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m2.1b"><ci id="S3.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.2.m2.1d">italic_k</annotation></semantics></math>, hidden state <math alttext="h_{k-1}\in\mathbb{R}^{B\times H_{\mathrm{in}}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.3.m3.1"><semantics id="S3.SS3.SSS2.p2.3.m3.1a"><mrow id="S3.SS3.SSS2.p2.3.m3.1.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.cmml"><msub id="S3.SS3.SSS2.p2.3.m3.1.1.2" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.1.2.2" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.2.cmml">h</mi><mrow id="S3.SS3.SSS2.p2.3.m3.1.1.2.3" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.1.2.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.3.2.cmml">k</mi><mo id="S3.SS3.SSS2.p2.3.m3.1.1.2.3.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.3.1.cmml">−</mo><mn id="S3.SS3.SSS2.p2.3.m3.1.1.2.3.3" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.SSS2.p2.3.m3.1.1.1" xref="S3.SS3.SSS2.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.3.m3.1.1.3" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.1.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.3.m3.1.1.3.3" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.2.cmml">B</mi><mo id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3.2" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3.2.cmml">H</mi><mi id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3.3" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3.3.cmml">in</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.3.m3.1b"><apply id="S3.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1"><in id="S3.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.1"></in><apply id="S3.SS3.SSS2.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.2">ℎ</ci><apply id="S3.SS3.SSS2.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.3"><minus id="S3.SS3.SSS2.p2.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.3.1"></minus><ci id="S3.SS3.SSS2.p2.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.3.2">𝑘</ci><cn id="S3.SS3.SSS2.p2.3.m3.1.1.2.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p2.3.m3.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS3.SSS2.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3"><times id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.2">𝐵</ci><apply id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3.2">𝐻</ci><ci id="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.3.m3.1.1.3.3.3.3">in</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.3.m3.1c">h_{k-1}\in\mathbb{R}^{B\times H_{\mathrm{in}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.3.m3.1d">italic_h start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, learnable matrices <math alttext="A\in\mathbb{R}^{H\times H_{\mathrm{in}}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.4.m4.1"><semantics id="S3.SS3.SSS2.p2.4.m4.1a"><mrow id="S3.SS3.SSS2.p2.4.m4.1.1" xref="S3.SS3.SSS2.p2.4.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p2.4.m4.1.1.2" xref="S3.SS3.SSS2.p2.4.m4.1.1.2.cmml">A</mi><mo id="S3.SS3.SSS2.p2.4.m4.1.1.1" xref="S3.SS3.SSS2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.4.m4.1.1.3" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.4.m4.1.1.3.2" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.4.m4.1.1.3.3" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p2.4.m4.1.1.3.3.2" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3.2.cmml">H</mi><mo id="S3.SS3.SSS2.p2.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3.2" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3.2.cmml">H</mi><mi id="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3.3" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3.3.cmml">in</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.4.m4.1b"><apply id="S3.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1"><in id="S3.SS3.SSS2.p2.4.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.1"></in><ci id="S3.SS3.SSS2.p2.4.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.2">𝐴</ci><apply id="S3.SS3.SSS2.p2.4.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3"><times id="S3.SS3.SSS2.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p2.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3.2">𝐻</ci><apply id="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3.2">𝐻</ci><ci id="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.4.m4.1.1.3.3.3.3">in</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.4.m4.1c">A\in\mathbb{R}^{H\times H_{\mathrm{in}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.4.m4.1d">italic_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_H start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="B\in\mathbb{R}^{H\times H_{\mathrm{in}}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.5.m5.1"><semantics id="S3.SS3.SSS2.p2.5.m5.1a"><mrow id="S3.SS3.SSS2.p2.5.m5.1.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p2.5.m5.1.1.2" xref="S3.SS3.SSS2.p2.5.m5.1.1.2.cmml">B</mi><mo id="S3.SS3.SSS2.p2.5.m5.1.1.1" xref="S3.SS3.SSS2.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.5.m5.1.1.3" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.5.m5.1.1.3.2" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.5.m5.1.1.3.3" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p2.5.m5.1.1.3.3.2" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3.2.cmml">H</mi><mo id="S3.SS3.SSS2.p2.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3.2" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3.2.cmml">H</mi><mi id="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3.3" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3.3.cmml">in</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.5.m5.1b"><apply id="S3.SS3.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1"><in id="S3.SS3.SSS2.p2.5.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.1"></in><ci id="S3.SS3.SSS2.p2.5.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.2">𝐵</ci><apply id="S3.SS3.SSS2.p2.5.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.5.m5.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.5.m5.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.5.m5.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3"><times id="S3.SS3.SSS2.p2.5.m5.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3.1"></times><ci id="S3.SS3.SSS2.p2.5.m5.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3.2">𝐻</ci><apply id="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3.2">𝐻</ci><ci id="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.5.m5.1.1.3.3.3.3">in</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.5.m5.1c">B\in\mathbb{R}^{H\times H_{\mathrm{in}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.5.m5.1d">italic_B ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_H start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="C\in\mathbb{R}^{H_{\mathrm{out}}\times H_{\mathrm{in}}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.6.m6.1"><semantics id="S3.SS3.SSS2.p2.6.m6.1a"><mrow id="S3.SS3.SSS2.p2.6.m6.1.1" xref="S3.SS3.SSS2.p2.6.m6.1.1.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.1.1.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.2.cmml">C</mi><mo id="S3.SS3.SSS2.p2.6.m6.1.1.1" xref="S3.SS3.SSS2.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.6.m6.1.1.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.1.1.3.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.6.m6.1.1.3.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.cmml"><msub id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.2.cmml">H</mi><mi id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.3.cmml">out</mi></msub><mo id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.2" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.2.cmml">H</mi><mi id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.3" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.3.cmml">in</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.6.m6.1b"><apply id="S3.SS3.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1"><in id="S3.SS3.SSS2.p2.6.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.1"></in><ci id="S3.SS3.SSS2.p2.6.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.2">𝐶</ci><apply id="S3.SS3.SSS2.p2.6.m6.1.1.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m6.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.6.m6.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3"><times id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.1"></times><apply id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.2">𝐻</ci><ci id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.2.3">out</ci></apply><apply id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.2">𝐻</ci><ci id="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.6.m6.1.1.3.3.3.3">in</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.6.m6.1c">C\in\mathbb{R}^{H_{\mathrm{out}}\times H_{\mathrm{in}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.6.m6.1d">italic_C ∈ blackboard_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT roman_out end_POSTSUBSCRIPT × italic_H start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="D\in\mathbb{R}^{H_{\mathrm{out}}\times H_{\mathrm{in}}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.7.m7.1"><semantics id="S3.SS3.SSS2.p2.7.m7.1a"><mrow id="S3.SS3.SSS2.p2.7.m7.1.1" xref="S3.SS3.SSS2.p2.7.m7.1.1.cmml"><mi id="S3.SS3.SSS2.p2.7.m7.1.1.2" xref="S3.SS3.SSS2.p2.7.m7.1.1.2.cmml">D</mi><mo id="S3.SS3.SSS2.p2.7.m7.1.1.1" xref="S3.SS3.SSS2.p2.7.m7.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS2.p2.7.m7.1.1.3" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.7.m7.1.1.3.2" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS2.p2.7.m7.1.1.3.3" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.cmml"><msub id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2.cmml"><mi id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2.2" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2.2.cmml">H</mi><mi id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2.3" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2.3.cmml">out</mi></msub><mo id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3.2" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3.2.cmml">H</mi><mi id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3.3" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3.3.cmml">in</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.7.m7.1b"><apply id="S3.SS3.SSS2.p2.7.m7.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1"><in id="S3.SS3.SSS2.p2.7.m7.1.1.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.1"></in><ci id="S3.SS3.SSS2.p2.7.m7.1.1.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.2">𝐷</ci><apply id="S3.SS3.SSS2.p2.7.m7.1.1.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m7.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3"><times id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.1"></times><apply id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2.2">𝐻</ci><ci id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.2.3">out</ci></apply><apply id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3.2">𝐻</ci><ci id="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS2.p2.7.m7.1.1.3.3.3.3">in</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.7.m7.1c">D\in\mathbb{R}^{H_{\mathrm{out}}\times H_{\mathrm{in}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.7.m7.1d">italic_D ∈ blackboard_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT roman_out end_POSTSUBSCRIPT × italic_H start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{h}_{\mathrm{k}}=\mathbf{A}\mathbf{h}_{\mathrm{k-1}}+\mathbf{B}\mathbf{%
x}_{\mathrm{k}},\quad\mathbf{y}_{\mathrm{k}}=\mathbf{C}\mathbf{h}_{\mathrm{k}}%
+\mathbf{D}\mathbf{x}_{\mathrm{k}}," class="ltx_Math" display="block" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1"><mrow id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.3.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S3.E8.m1.1.1.1.1.1.1.2.3" mathvariant="normal" xref="S3.E8.m1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.3.cmml"><msub id="S3.E8.m1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.1.1.3.2.2.cmml">𝐀𝐡</mi><mrow id="S3.E8.m1.1.1.1.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.2.3.2" mathvariant="normal" xref="S3.E8.m1.1.1.1.1.1.1.3.2.3.2.cmml">k</mi><mo id="S3.E8.m1.1.1.1.1.1.1.3.2.3.1" xref="S3.E8.m1.1.1.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="S3.E8.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.E8.m1.1.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E8.m1.1.1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E8.m1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.cmml">𝐁𝐱</mi><mi id="S3.E8.m1.1.1.1.1.1.1.3.3.3" mathvariant="normal" xref="S3.E8.m1.1.1.1.1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E8.m1.1.1.1.1.2.3" rspace="1.167em" xref="S3.E8.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E8.m1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.2.2.cmml"><msub id="S3.E8.m1.1.1.1.1.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.cmml">𝐲</mi><mi id="S3.E8.m1.1.1.1.1.2.2.2.3" mathvariant="normal" xref="S3.E8.m1.1.1.1.1.2.2.2.3.cmml">k</mi></msub><mo id="S3.E8.m1.1.1.1.1.2.2.1" xref="S3.E8.m1.1.1.1.1.2.2.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.3.cmml"><msub id="S3.E8.m1.1.1.1.1.2.2.3.2" xref="S3.E8.m1.1.1.1.1.2.2.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.3.2.2" xref="S3.E8.m1.1.1.1.1.2.2.3.2.2.cmml">𝐂𝐡</mi><mi id="S3.E8.m1.1.1.1.1.2.2.3.2.3" mathvariant="normal" xref="S3.E8.m1.1.1.1.1.2.2.3.2.3.cmml">k</mi></msub><mo id="S3.E8.m1.1.1.1.1.2.2.3.1" xref="S3.E8.m1.1.1.1.1.2.2.3.1.cmml">+</mo><msub id="S3.E8.m1.1.1.1.1.2.2.3.3" xref="S3.E8.m1.1.1.1.1.2.2.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.3.3.2" xref="S3.E8.m1.1.1.1.1.2.2.3.3.2.cmml">𝐃𝐱</mi><mi id="S3.E8.m1.1.1.1.1.2.2.3.3.3" mathvariant="normal" xref="S3.E8.m1.1.1.1.1.2.2.3.3.3.cmml">k</mi></msub></mrow></mrow></mrow><mo id="S3.E8.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3a.cmml" xref="S3.E8.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"></eq><apply id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2.2">𝐡</ci><ci id="S3.E8.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2.3">k</ci></apply><apply id="S3.E8.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3"><plus id="S3.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.1"></plus><apply id="S3.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2.2">𝐀𝐡</ci><apply id="S3.E8.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2.3"><minus id="S3.E8.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2.3.1"></minus><ci id="S3.E8.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2.3.2">k</ci><cn id="S3.E8.m1.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S3.E8.m1.1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><apply id="S3.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2">𝐁𝐱</ci><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.3">k</ci></apply></apply></apply><apply id="S3.E8.m1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2"><eq id="S3.E8.m1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1"></eq><apply id="S3.E8.m1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2">𝐲</ci><ci id="S3.E8.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3">k</ci></apply><apply id="S3.E8.m1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3"><plus id="S3.E8.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.1"></plus><apply id="S3.E8.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.2.2">𝐂𝐡</ci><ci id="S3.E8.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.2.3">k</ci></apply><apply id="S3.E8.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.2">𝐃𝐱</ci><ci id="S3.E8.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.3">k</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\mathbf{h}_{\mathrm{k}}=\mathbf{A}\mathbf{h}_{\mathrm{k-1}}+\mathbf{B}\mathbf{%
x}_{\mathrm{k}},\quad\mathbf{y}_{\mathrm{k}}=\mathbf{C}\mathbf{h}_{\mathrm{k}}%
+\mathbf{D}\mathbf{x}_{\mathrm{k}},</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">bold_h start_POSTSUBSCRIPT roman_k end_POSTSUBSCRIPT = bold_Ah start_POSTSUBSCRIPT roman_k - 1 end_POSTSUBSCRIPT + bold_Bx start_POSTSUBSCRIPT roman_k end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT roman_k end_POSTSUBSCRIPT = bold_Ch start_POSTSUBSCRIPT roman_k end_POSTSUBSCRIPT + bold_Dx start_POSTSUBSCRIPT roman_k end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p2.12">The input and output dimensions are denoted with <math alttext="H_{\mathrm{in}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.8.m1.1"><semantics id="S3.SS3.SSS2.p2.8.m1.1a"><msub id="S3.SS3.SSS2.p2.8.m1.1.1" xref="S3.SS3.SSS2.p2.8.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.8.m1.1.1.2" xref="S3.SS3.SSS2.p2.8.m1.1.1.2.cmml">H</mi><mi id="S3.SS3.SSS2.p2.8.m1.1.1.3" xref="S3.SS3.SSS2.p2.8.m1.1.1.3.cmml">in</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.8.m1.1b"><apply id="S3.SS3.SSS2.p2.8.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.8.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.8.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.8.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.8.m1.1.1.2">𝐻</ci><ci id="S3.SS3.SSS2.p2.8.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.8.m1.1.1.3">in</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.8.m1.1c">H_{\mathrm{in}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.8.m1.1d">italic_H start_POSTSUBSCRIPT roman_in end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="H_{\mathrm{out}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.9.m2.1"><semantics id="S3.SS3.SSS2.p2.9.m2.1a"><msub id="S3.SS3.SSS2.p2.9.m2.1.1" xref="S3.SS3.SSS2.p2.9.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p2.9.m2.1.1.2" xref="S3.SS3.SSS2.p2.9.m2.1.1.2.cmml">H</mi><mi id="S3.SS3.SSS2.p2.9.m2.1.1.3" xref="S3.SS3.SSS2.p2.9.m2.1.1.3.cmml">out</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.9.m2.1b"><apply id="S3.SS3.SSS2.p2.9.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.9.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p2.9.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.9.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p2.9.m2.1.1.2">𝐻</ci><ci id="S3.SS3.SSS2.p2.9.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p2.9.m2.1.1.3">out</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.9.m2.1c">H_{\mathrm{out}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.9.m2.1d">italic_H start_POSTSUBSCRIPT roman_out end_POSTSUBSCRIPT</annotation></semantics></math> (i.e., embedding size), and the hidden dimension size with <math alttext="H" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.10.m3.1"><semantics id="S3.SS3.SSS2.p2.10.m3.1a"><mi id="S3.SS3.SSS2.p2.10.m3.1.1" xref="S3.SS3.SSS2.p2.10.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.10.m3.1b"><ci id="S3.SS3.SSS2.p2.10.m3.1.1.cmml" xref="S3.SS3.SSS2.p2.10.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.10.m3.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.10.m3.1d">italic_H</annotation></semantics></math>. Different from RNN models (i.e., <math alttext="h_{k}=\sigma(Ah_{k-1}+Bx_{k})" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.11.m4.1"><semantics id="S3.SS3.SSS2.p2.11.m4.1a"><mrow id="S3.SS3.SSS2.p2.11.m4.1.1" xref="S3.SS3.SSS2.p2.11.m4.1.1.cmml"><msub id="S3.SS3.SSS2.p2.11.m4.1.1.3" xref="S3.SS3.SSS2.p2.11.m4.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.11.m4.1.1.3.2" xref="S3.SS3.SSS2.p2.11.m4.1.1.3.2.cmml">h</mi><mi id="S3.SS3.SSS2.p2.11.m4.1.1.3.3" xref="S3.SS3.SSS2.p2.11.m4.1.1.3.3.cmml">k</mi></msub><mo id="S3.SS3.SSS2.p2.11.m4.1.1.2" xref="S3.SS3.SSS2.p2.11.m4.1.1.2.cmml">=</mo><mrow id="S3.SS3.SSS2.p2.11.m4.1.1.1" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.11.m4.1.1.1.3" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.3.cmml">σ</mi><mo id="S3.SS3.SSS2.p2.11.m4.1.1.1.2" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.cmml"><mrow id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.2.cmml">A</mi><mo id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.1" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.2" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.2.cmml">h</mi><mrow id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.2" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.2.cmml">k</mi><mo id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.1" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.1.cmml">−</mo><mn id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.3" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.2" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.2.cmml">B</mi><mo id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.1" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3.2" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3.2.cmml">x</mi><mi id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3.3" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.11.m4.1b"><apply id="S3.SS3.SSS2.p2.11.m4.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1"><eq id="S3.SS3.SSS2.p2.11.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.2"></eq><apply id="S3.SS3.SSS2.p2.11.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.11.m4.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.11.m4.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.3.2">ℎ</ci><ci id="S3.SS3.SSS2.p2.11.m4.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.3.3">𝑘</ci></apply><apply id="S3.SS3.SSS2.p2.11.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1"><times id="S3.SS3.SSS2.p2.11.m4.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.2"></times><ci id="S3.SS3.SSS2.p2.11.m4.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.3">𝜎</ci><apply id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1"><plus id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.1"></plus><apply id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2"><times id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.1"></times><ci id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.2">𝐴</ci><apply id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.2">ℎ</ci><apply id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3"><minus id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.1"></minus><ci id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.2">𝑘</ci><cn id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.3.cmml" type="integer" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3"><times id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.1"></times><ci id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.2">𝐵</ci><apply id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3.2">𝑥</ci><ci id="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS3.SSS2.p2.11.m4.1.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.11.m4.1c">h_{k}=\sigma(Ah_{k-1}+Bx_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.11.m4.1d">italic_h start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_σ ( italic_A italic_h start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT + italic_B italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>), we discard the non-linearity <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.12.m5.1"><semantics id="S3.SS3.SSS2.p2.12.m5.1a"><mi id="S3.SS3.SSS2.p2.12.m5.1.1" xref="S3.SS3.SSS2.p2.12.m5.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.12.m5.1b"><ci id="S3.SS3.SSS2.p2.12.m5.1.1.cmml" xref="S3.SS3.SSS2.p2.12.m5.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.12.m5.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.12.m5.1d">italic_σ</annotation></semantics></math> to enable parallelization:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E9">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E9X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}_{\mathrm{k}}" class="ltx_Math" display="inline" id="S3.E9X.2.1.1.m1.1"><semantics id="S3.E9X.2.1.1.m1.1a"><msub id="S3.E9X.2.1.1.m1.1.1" xref="S3.E9X.2.1.1.m1.1.1.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.2.cmml">𝐡</mi><mi id="S3.E9X.2.1.1.m1.1.1.3" mathvariant="normal" xref="S3.E9X.2.1.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E9X.2.1.1.m1.1b"><apply id="S3.E9X.2.1.1.m1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E9X.2.1.1.m1.1.1.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.2">𝐡</ci><ci id="S3.E9X.2.1.1.m1.1.1.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.3">k</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9X.2.1.1.m1.1c">\displaystyle\mathbf{h}_{\mathrm{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.E9X.2.1.1.m1.1d">bold_h start_POSTSUBSCRIPT roman_k end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{A}\mathbf{h}_{\mathrm{k}-1}+\mathbf{B}\mathbf{x}_{%
\mathrm{k}}" class="ltx_Math" display="inline" id="S3.E9X.3.2.2.m1.1"><semantics id="S3.E9X.3.2.2.m1.1a"><mrow id="S3.E9X.3.2.2.m1.1.1" xref="S3.E9X.3.2.2.m1.1.1.cmml"><mi id="S3.E9X.3.2.2.m1.1.1.2" xref="S3.E9X.3.2.2.m1.1.1.2.cmml"></mi><mo id="S3.E9X.3.2.2.m1.1.1.1" xref="S3.E9X.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="S3.E9X.3.2.2.m1.1.1.3" xref="S3.E9X.3.2.2.m1.1.1.3.cmml"><msub id="S3.E9X.3.2.2.m1.1.1.3.2" xref="S3.E9X.3.2.2.m1.1.1.3.2.cmml"><mi id="S3.E9X.3.2.2.m1.1.1.3.2.2" xref="S3.E9X.3.2.2.m1.1.1.3.2.2.cmml">𝐀𝐡</mi><mrow id="S3.E9X.3.2.2.m1.1.1.3.2.3" xref="S3.E9X.3.2.2.m1.1.1.3.2.3.cmml"><mi id="S3.E9X.3.2.2.m1.1.1.3.2.3.2" mathvariant="normal" xref="S3.E9X.3.2.2.m1.1.1.3.2.3.2.cmml">k</mi><mo id="S3.E9X.3.2.2.m1.1.1.3.2.3.1" xref="S3.E9X.3.2.2.m1.1.1.3.2.3.1.cmml">−</mo><mn id="S3.E9X.3.2.2.m1.1.1.3.2.3.3" xref="S3.E9X.3.2.2.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E9X.3.2.2.m1.1.1.3.1" xref="S3.E9X.3.2.2.m1.1.1.3.1.cmml">+</mo><msub id="S3.E9X.3.2.2.m1.1.1.3.3" xref="S3.E9X.3.2.2.m1.1.1.3.3.cmml"><mi id="S3.E9X.3.2.2.m1.1.1.3.3.2" xref="S3.E9X.3.2.2.m1.1.1.3.3.2.cmml">𝐁𝐱</mi><mi id="S3.E9X.3.2.2.m1.1.1.3.3.3" mathvariant="normal" xref="S3.E9X.3.2.2.m1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9X.3.2.2.m1.1b"><apply id="S3.E9X.3.2.2.m1.1.1.cmml" xref="S3.E9X.3.2.2.m1.1.1"><eq id="S3.E9X.3.2.2.m1.1.1.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="S3.E9X.3.2.2.m1.1.1.2.cmml" xref="S3.E9X.3.2.2.m1.1.1.2">absent</csymbol><apply id="S3.E9X.3.2.2.m1.1.1.3.cmml" xref="S3.E9X.3.2.2.m1.1.1.3"><plus id="S3.E9X.3.2.2.m1.1.1.3.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.3.1"></plus><apply id="S3.E9X.3.2.2.m1.1.1.3.2.cmml" xref="S3.E9X.3.2.2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.1.1.3.2.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.3.2">subscript</csymbol><ci id="S3.E9X.3.2.2.m1.1.1.3.2.2.cmml" xref="S3.E9X.3.2.2.m1.1.1.3.2.2">𝐀𝐡</ci><apply id="S3.E9X.3.2.2.m1.1.1.3.2.3.cmml" xref="S3.E9X.3.2.2.m1.1.1.3.2.3"><minus id="S3.E9X.3.2.2.m1.1.1.3.2.3.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.3.2.3.1"></minus><ci id="S3.E9X.3.2.2.m1.1.1.3.2.3.2.cmml" xref="S3.E9X.3.2.2.m1.1.1.3.2.3.2">k</ci><cn id="S3.E9X.3.2.2.m1.1.1.3.2.3.3.cmml" type="integer" xref="S3.E9X.3.2.2.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="S3.E9X.3.2.2.m1.1.1.3.3.cmml" xref="S3.E9X.3.2.2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.1.1.3.3.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.3.3">subscript</csymbol><ci id="S3.E9X.3.2.2.m1.1.1.3.3.2.cmml" xref="S3.E9X.3.2.2.m1.1.1.3.3.2">𝐁𝐱</ci><ci id="S3.E9X.3.2.2.m1.1.1.3.3.3.cmml" xref="S3.E9X.3.2.2.m1.1.1.3.3.3">k</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9X.3.2.2.m1.1c">\displaystyle=\mathbf{A}\mathbf{h}_{\mathrm{k}-1}+\mathbf{B}\mathbf{x}_{%
\mathrm{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.E9X.3.2.2.m1.1d">= bold_Ah start_POSTSUBSCRIPT roman_k - 1 end_POSTSUBSCRIPT + bold_Bx start_POSTSUBSCRIPT roman_k end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E9Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{A}^{2}\mathbf{h}_{\mathrm{k}-2}+\mathbf{A}\mathbf{B}%
\mathbf{x}_{\mathrm{k}-1}+\mathbf{B}\mathbf{x}_{\mathrm{k}}=\ldots" class="ltx_Math" display="inline" id="S3.E9Xa.2.1.1.m1.1"><semantics id="S3.E9Xa.2.1.1.m1.1a"><mrow id="S3.E9Xa.2.1.1.m1.1.1" xref="S3.E9Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E9Xa.2.1.1.m1.1.1.2" xref="S3.E9Xa.2.1.1.m1.1.1.2.cmml"></mi><mo id="S3.E9Xa.2.1.1.m1.1.1.3" xref="S3.E9Xa.2.1.1.m1.1.1.3.cmml">=</mo><mrow id="S3.E9Xa.2.1.1.m1.1.1.4" xref="S3.E9Xa.2.1.1.m1.1.1.4.cmml"><mrow id="S3.E9Xa.2.1.1.m1.1.1.4.2" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.cmml"><msup id="S3.E9Xa.2.1.1.m1.1.1.4.2.2" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.2.cmml"><mi id="S3.E9Xa.2.1.1.m1.1.1.4.2.2.2" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.2.2.cmml">𝐀</mi><mn id="S3.E9Xa.2.1.1.m1.1.1.4.2.2.3" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.2.3.cmml">2</mn></msup><mo id="S3.E9Xa.2.1.1.m1.1.1.4.2.1" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.1.cmml">⁢</mo><msub id="S3.E9Xa.2.1.1.m1.1.1.4.2.3" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3.cmml"><mi id="S3.E9Xa.2.1.1.m1.1.1.4.2.3.2" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3.2.cmml">𝐡</mi><mrow id="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.cmml"><mi id="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.2" mathvariant="normal" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.2.cmml">k</mi><mo id="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.1" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.1.cmml">−</mo><mn id="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.3" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.3.cmml">2</mn></mrow></msub></mrow><mo id="S3.E9Xa.2.1.1.m1.1.1.4.1" xref="S3.E9Xa.2.1.1.m1.1.1.4.1.cmml">+</mo><msub id="S3.E9Xa.2.1.1.m1.1.1.4.3" xref="S3.E9Xa.2.1.1.m1.1.1.4.3.cmml"><mi id="S3.E9Xa.2.1.1.m1.1.1.4.3.2" xref="S3.E9Xa.2.1.1.m1.1.1.4.3.2.cmml">𝐀𝐁𝐱</mi><mrow id="S3.E9Xa.2.1.1.m1.1.1.4.3.3" xref="S3.E9Xa.2.1.1.m1.1.1.4.3.3.cmml"><mi id="S3.E9Xa.2.1.1.m1.1.1.4.3.3.2" mathvariant="normal" xref="S3.E9Xa.2.1.1.m1.1.1.4.3.3.2.cmml">k</mi><mo id="S3.E9Xa.2.1.1.m1.1.1.4.3.3.1" xref="S3.E9Xa.2.1.1.m1.1.1.4.3.3.1.cmml">−</mo><mn id="S3.E9Xa.2.1.1.m1.1.1.4.3.3.3" xref="S3.E9Xa.2.1.1.m1.1.1.4.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E9Xa.2.1.1.m1.1.1.4.1a" xref="S3.E9Xa.2.1.1.m1.1.1.4.1.cmml">+</mo><msub id="S3.E9Xa.2.1.1.m1.1.1.4.4" xref="S3.E9Xa.2.1.1.m1.1.1.4.4.cmml"><mi id="S3.E9Xa.2.1.1.m1.1.1.4.4.2" xref="S3.E9Xa.2.1.1.m1.1.1.4.4.2.cmml">𝐁𝐱</mi><mi id="S3.E9Xa.2.1.1.m1.1.1.4.4.3" mathvariant="normal" xref="S3.E9Xa.2.1.1.m1.1.1.4.4.3.cmml">k</mi></msub></mrow><mo id="S3.E9Xa.2.1.1.m1.1.1.5" xref="S3.E9Xa.2.1.1.m1.1.1.5.cmml">=</mo><mi id="S3.E9Xa.2.1.1.m1.1.1.6" mathvariant="normal" xref="S3.E9Xa.2.1.1.m1.1.1.6.cmml">…</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E9Xa.2.1.1.m1.1b"><apply id="S3.E9Xa.2.1.1.m1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1"><and id="S3.E9Xa.2.1.1.m1.1.1a.cmml" xref="S3.E9Xa.2.1.1.m1.1.1"></and><apply id="S3.E9Xa.2.1.1.m1.1.1b.cmml" xref="S3.E9Xa.2.1.1.m1.1.1"><eq id="S3.E9Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.3"></eq><csymbol cd="latexml" id="S3.E9Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.2">absent</csymbol><apply id="S3.E9Xa.2.1.1.m1.1.1.4.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4"><plus id="S3.E9Xa.2.1.1.m1.1.1.4.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.1"></plus><apply id="S3.E9Xa.2.1.1.m1.1.1.4.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.2"><times id="S3.E9Xa.2.1.1.m1.1.1.4.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.1"></times><apply id="S3.E9Xa.2.1.1.m1.1.1.4.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.1.1.4.2.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.2">superscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.1.1.4.2.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.2.2">𝐀</ci><cn id="S3.E9Xa.2.1.1.m1.1.1.4.2.2.3.cmml" type="integer" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.2.3">2</cn></apply><apply id="S3.E9Xa.2.1.1.m1.1.1.4.2.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.1.1.4.2.3.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3">subscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.1.1.4.2.3.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3.2">𝐡</ci><apply id="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3"><minus id="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.1"></minus><ci id="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.2">k</ci><cn id="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.3.cmml" type="integer" xref="S3.E9Xa.2.1.1.m1.1.1.4.2.3.3.3">2</cn></apply></apply></apply><apply id="S3.E9Xa.2.1.1.m1.1.1.4.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.1.1.4.3.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.3">subscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.1.1.4.3.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.3.2">𝐀𝐁𝐱</ci><apply id="S3.E9Xa.2.1.1.m1.1.1.4.3.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.3.3"><minus id="S3.E9Xa.2.1.1.m1.1.1.4.3.3.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.3.3.1"></minus><ci id="S3.E9Xa.2.1.1.m1.1.1.4.3.3.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.3.3.2">k</ci><cn id="S3.E9Xa.2.1.1.m1.1.1.4.3.3.3.cmml" type="integer" xref="S3.E9Xa.2.1.1.m1.1.1.4.3.3.3">1</cn></apply></apply><apply id="S3.E9Xa.2.1.1.m1.1.1.4.4.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.4"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.1.1.4.4.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.4">subscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.1.1.4.4.2.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.4.2">𝐁𝐱</ci><ci id="S3.E9Xa.2.1.1.m1.1.1.4.4.3.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.4.4.3">k</ci></apply></apply></apply><apply id="S3.E9Xa.2.1.1.m1.1.1c.cmml" xref="S3.E9Xa.2.1.1.m1.1.1"><eq id="S3.E9Xa.2.1.1.m1.1.1.5.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.5"></eq><share href="https://arxiv.org/html/2409.16627v2#S3.E9Xa.2.1.1.m1.1.1.4.cmml" id="S3.E9Xa.2.1.1.m1.1.1d.cmml" xref="S3.E9Xa.2.1.1.m1.1.1"></share><ci id="S3.E9Xa.2.1.1.m1.1.1.6.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.6">…</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9Xa.2.1.1.m1.1c">\displaystyle=\mathbf{A}^{2}\mathbf{h}_{\mathrm{k}-2}+\mathbf{A}\mathbf{B}%
\mathbf{x}_{\mathrm{k}-1}+\mathbf{B}\mathbf{x}_{\mathrm{k}}=\ldots</annotation><annotation encoding="application/x-llamapun" id="S3.E9Xa.2.1.1.m1.1d">= bold_A start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_h start_POSTSUBSCRIPT roman_k - 2 end_POSTSUBSCRIPT + bold_ABx start_POSTSUBSCRIPT roman_k - 1 end_POSTSUBSCRIPT + bold_Bx start_POSTSUBSCRIPT roman_k end_POSTSUBSCRIPT = …</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E9Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{\mathrm{i}=1}^{\mathrm{k}}\mathbf{A}^{\mathrm{k}-\mathrm{i%
}}\mathbf{B}\mathbf{x}_{\mathrm{i}}\quad\mathrm{with}\quad\mathbf{h}_{1}=%
\mathbf{B}\mathbf{x}_{1}." class="ltx_Math" display="inline" id="S3.E9Xb.2.1.1.m1.2"><semantics id="S3.E9Xb.2.1.1.m1.2a"><mrow id="S3.E9Xb.2.1.1.m1.2.2.1"><mrow id="S3.E9Xb.2.1.1.m1.2.2.1.1.2" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.3.cmml"><mrow id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.cmml"><mi id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.3" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.3.cmml"></mi><mo id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.2" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.2.cmml">=</mo><mrow id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.2.cmml"><mrow id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1a" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2" movablelimits="false" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" mathvariant="normal" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3" mathvariant="normal" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">k</mi></munderover></mstyle><mrow id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msup id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">𝐀</mi><mrow id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.2" mathvariant="normal" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml">−</mo><mi id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.3" mathvariant="normal" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml">i</mi></mrow></msup><mo id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml">𝐁𝐱</mi><mi id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3" mathvariant="normal" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow></mrow><mspace id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.2" width="1em" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.2.cmml"></mspace><mi id="S3.E9Xb.2.1.1.m1.1.1" xref="S3.E9Xb.2.1.1.m1.1.1.cmml">with</mi></mrow></mrow><mspace id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.3" width="1em" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.3a.cmml"></mspace><mrow id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.cmml"><msub id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2.2" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2.2.cmml">𝐡</mi><mn id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2.3" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2.3.cmml">1</mn></msub><mo id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.1" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.1.cmml">=</mo><msub id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3.cmml"><mi id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3.2" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3.2.cmml">𝐁𝐱</mi><mn id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3.3" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3.3.cmml">1</mn></msub></mrow></mrow><mo id="S3.E9Xb.2.1.1.m1.2.2.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9Xb.2.1.1.m1.2b"><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E9Xb.2.1.1.m1.2.2.1.1.3a.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1"><eq id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.3.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.3">absent</csymbol><list id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1"><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1"><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3"><eq id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">i</ci><cn id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3">k</ci></apply><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2"><times id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝐀</ci><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3"><minus id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.1"></minus><ci id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.2">k</ci><ci id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.3.3">i</ci></apply></apply><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.2">𝐁𝐱</ci><ci id="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.3.3">i</ci></apply></apply></apply><ci id="S3.E9Xb.2.1.1.m1.1.1.cmml" xref="S3.E9Xb.2.1.1.m1.1.1">with</ci></list></apply><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2"><eq id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.1"></eq><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2.2">𝐡</ci><cn id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2.3.cmml" type="integer" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.2.3">1</cn></apply><apply id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3">subscript</csymbol><ci id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3.2">𝐁𝐱</ci><cn id="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3.3.cmml" type="integer" xref="S3.E9Xb.2.1.1.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9Xb.2.1.1.m1.2c">\displaystyle=\sum_{\mathrm{i}=1}^{\mathrm{k}}\mathbf{A}^{\mathrm{k}-\mathrm{i%
}}\mathbf{B}\mathbf{x}_{\mathrm{i}}\quad\mathrm{with}\quad\mathbf{h}_{1}=%
\mathbf{B}\mathbf{x}_{1}.</annotation><annotation encoding="application/x-llamapun" id="S3.E9Xb.2.1.1.m1.2d">= ∑ start_POSTSUBSCRIPT roman_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_k end_POSTSUPERSCRIPT bold_A start_POSTSUPERSCRIPT roman_k - roman_i end_POSTSUPERSCRIPT bold_Bx start_POSTSUBSCRIPT roman_i end_POSTSUBSCRIPT roman_with bold_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = bold_Bx start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p2.13">Therefore, LRU can be trained in parallel (via parallel scan) as Self-Attention (equation <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.E9" title="Equation 9 ‣ 3.3.2 Linear Recurrent Units ‣ 3.3 Overall Framework ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">9</span></a>) and enable fast inference as RNN models (equation <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.E8" title="Equation 8 ‣ 3.3.2 Linear Recurrent Units ‣ 3.3 Overall Framework ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a>).</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3 </span>Overall LRU-Based Recommendation Framework</h4>
<div class="ltx_para" id="S3.SS3.SSS3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.p1.4">We first pad for the combined embeddings <math alttext="\mathbf{E}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.1.m1.1"><semantics id="S3.SS3.SSS3.p1.1.m1.1a"><msub id="S3.SS3.SSS3.p1.1.m1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.1.m1.1.1.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml">𝐄</mi><mi id="S3.SS3.SSS3.p1.1.m1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.1.m1.1b"><apply id="S3.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.2">𝐄</ci><ci id="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.1.m1.1c">\mathbf{E}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.1.m1.1d">bold_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> output by equation <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.E7" title="Equation 7 ‣ 3.3.1 Language and Image Encoding ‣ 3.3 Overall Framework ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a> to maximum length of all sequences. Then, the padded embeddings <math alttext="\mathbf{E}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.2.m2.1"><semantics id="S3.SS3.SSS3.p1.2.m2.1a"><msub id="S3.SS3.SSS3.p1.2.m2.1.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS3.p1.2.m2.1.1.2" xref="S3.SS3.SSS3.p1.2.m2.1.1.2.cmml">𝐄</mi><mi id="S3.SS3.SSS3.p1.2.m2.1.1.3" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.2.m2.1b"><apply id="S3.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.2">𝐄</ci><ci id="S3.SS3.SSS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.2.m2.1c">\mathbf{E}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.2.m2.1d">bold_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are processed through <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.3.m3.1"><semantics id="S3.SS3.SSS3.p1.3.m3.1a"><mi id="S3.SS3.SSS3.p1.3.m3.1.1" xref="S3.SS3.SSS3.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.3.m3.1b"><ci id="S3.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.3.m3.1d">italic_N</annotation></semantics></math> blocks. For each block <math alttext="i\in\{1,\ldots,N\}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.4.m4.3"><semantics id="S3.SS3.SSS3.p1.4.m4.3a"><mrow id="S3.SS3.SSS3.p1.4.m4.3.4" xref="S3.SS3.SSS3.p1.4.m4.3.4.cmml"><mi id="S3.SS3.SSS3.p1.4.m4.3.4.2" xref="S3.SS3.SSS3.p1.4.m4.3.4.2.cmml">i</mi><mo id="S3.SS3.SSS3.p1.4.m4.3.4.1" xref="S3.SS3.SSS3.p1.4.m4.3.4.1.cmml">∈</mo><mrow id="S3.SS3.SSS3.p1.4.m4.3.4.3.2" xref="S3.SS3.SSS3.p1.4.m4.3.4.3.1.cmml"><mo id="S3.SS3.SSS3.p1.4.m4.3.4.3.2.1" stretchy="false" xref="S3.SS3.SSS3.p1.4.m4.3.4.3.1.cmml">{</mo><mn id="S3.SS3.SSS3.p1.4.m4.1.1" xref="S3.SS3.SSS3.p1.4.m4.1.1.cmml">1</mn><mo id="S3.SS3.SSS3.p1.4.m4.3.4.3.2.2" xref="S3.SS3.SSS3.p1.4.m4.3.4.3.1.cmml">,</mo><mi id="S3.SS3.SSS3.p1.4.m4.2.2" mathvariant="normal" xref="S3.SS3.SSS3.p1.4.m4.2.2.cmml">…</mi><mo id="S3.SS3.SSS3.p1.4.m4.3.4.3.2.3" xref="S3.SS3.SSS3.p1.4.m4.3.4.3.1.cmml">,</mo><mi id="S3.SS3.SSS3.p1.4.m4.3.3" xref="S3.SS3.SSS3.p1.4.m4.3.3.cmml">N</mi><mo id="S3.SS3.SSS3.p1.4.m4.3.4.3.2.4" stretchy="false" xref="S3.SS3.SSS3.p1.4.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.4.m4.3b"><apply id="S3.SS3.SSS3.p1.4.m4.3.4.cmml" xref="S3.SS3.SSS3.p1.4.m4.3.4"><in id="S3.SS3.SSS3.p1.4.m4.3.4.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.3.4.1"></in><ci id="S3.SS3.SSS3.p1.4.m4.3.4.2.cmml" xref="S3.SS3.SSS3.p1.4.m4.3.4.2">𝑖</ci><set id="S3.SS3.SSS3.p1.4.m4.3.4.3.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.3.4.3.2"><cn id="S3.SS3.SSS3.p1.4.m4.1.1.cmml" type="integer" xref="S3.SS3.SSS3.p1.4.m4.1.1">1</cn><ci id="S3.SS3.SSS3.p1.4.m4.2.2.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2">…</ci><ci id="S3.SS3.SSS3.p1.4.m4.3.3.cmml" xref="S3.SS3.SSS3.p1.4.m4.3.3">𝑁</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.4.m4.3c">i\in\{1,\ldots,N\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.4.m4.3d">italic_i ∈ { 1 , … , italic_N }</annotation></semantics></math>, we first perform layer normalization to the input followed by a LRU layer:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{LayerNorm}(\mathbf{X})" class="ltx_Math" display="inline" id="S3.E10.m1.1"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.2" xref="S3.E10.m1.1.2.cmml"><mtext id="S3.E10.m1.1.2.2" xref="S3.E10.m1.1.2.2a.cmml">LayerNorm</mtext><mo id="S3.E10.m1.1.2.1" xref="S3.E10.m1.1.2.1.cmml">⁢</mo><mrow id="S3.E10.m1.1.2.3.2" xref="S3.E10.m1.1.2.cmml"><mo id="S3.E10.m1.1.2.3.2.1" stretchy="false" xref="S3.E10.m1.1.2.cmml">(</mo><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">𝐗</mi><mo id="S3.E10.m1.1.2.3.2.2" stretchy="false" xref="S3.E10.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.2.cmml" xref="S3.E10.m1.1.2"><times id="S3.E10.m1.1.2.1.cmml" xref="S3.E10.m1.1.2.1"></times><ci id="S3.E10.m1.1.2.2a.cmml" xref="S3.E10.m1.1.2.2"><mtext id="S3.E10.m1.1.2.2.cmml" xref="S3.E10.m1.1.2.2">LayerNorm</mtext></ci><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">𝐗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\displaystyle\text{LayerNorm}(\mathbf{X})</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.1d">LayerNorm ( bold_X )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\alpha\odot\frac{\mathbf{X}-\mu}{\sqrt{\sigma^{2}+\epsilon}}+\beta" class="ltx_Math" display="inline" id="S3.E10.m2.1"><semantics id="S3.E10.m2.1a"><mrow id="S3.E10.m2.1.1" xref="S3.E10.m2.1.1.cmml"><mi id="S3.E10.m2.1.1.2" xref="S3.E10.m2.1.1.2.cmml"></mi><mo id="S3.E10.m2.1.1.1" xref="S3.E10.m2.1.1.1.cmml">=</mo><mrow id="S3.E10.m2.1.1.3" xref="S3.E10.m2.1.1.3.cmml"><mrow id="S3.E10.m2.1.1.3.2" xref="S3.E10.m2.1.1.3.2.cmml"><mi id="S3.E10.m2.1.1.3.2.2" xref="S3.E10.m2.1.1.3.2.2.cmml">α</mi><mo id="S3.E10.m2.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E10.m2.1.1.3.2.1.cmml">⊙</mo><mstyle displaystyle="true" id="S3.E10.m2.1.1.3.2.3" xref="S3.E10.m2.1.1.3.2.3.cmml"><mfrac id="S3.E10.m2.1.1.3.2.3a" xref="S3.E10.m2.1.1.3.2.3.cmml"><mrow id="S3.E10.m2.1.1.3.2.3.2" xref="S3.E10.m2.1.1.3.2.3.2.cmml"><mi id="S3.E10.m2.1.1.3.2.3.2.2" xref="S3.E10.m2.1.1.3.2.3.2.2.cmml">𝐗</mi><mo id="S3.E10.m2.1.1.3.2.3.2.1" xref="S3.E10.m2.1.1.3.2.3.2.1.cmml">−</mo><mi id="S3.E10.m2.1.1.3.2.3.2.3" xref="S3.E10.m2.1.1.3.2.3.2.3.cmml">μ</mi></mrow><msqrt id="S3.E10.m2.1.1.3.2.3.3" xref="S3.E10.m2.1.1.3.2.3.3.cmml"><mrow id="S3.E10.m2.1.1.3.2.3.3.2" xref="S3.E10.m2.1.1.3.2.3.3.2.cmml"><msup id="S3.E10.m2.1.1.3.2.3.3.2.2" xref="S3.E10.m2.1.1.3.2.3.3.2.2.cmml"><mi id="S3.E10.m2.1.1.3.2.3.3.2.2.2" xref="S3.E10.m2.1.1.3.2.3.3.2.2.2.cmml">σ</mi><mn id="S3.E10.m2.1.1.3.2.3.3.2.2.3" xref="S3.E10.m2.1.1.3.2.3.3.2.2.3.cmml">2</mn></msup><mo id="S3.E10.m2.1.1.3.2.3.3.2.1" xref="S3.E10.m2.1.1.3.2.3.3.2.1.cmml">+</mo><mi id="S3.E10.m2.1.1.3.2.3.3.2.3" xref="S3.E10.m2.1.1.3.2.3.3.2.3.cmml">ϵ</mi></mrow></msqrt></mfrac></mstyle></mrow><mo id="S3.E10.m2.1.1.3.1" xref="S3.E10.m2.1.1.3.1.cmml">+</mo><mi id="S3.E10.m2.1.1.3.3" xref="S3.E10.m2.1.1.3.3.cmml">β</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m2.1b"><apply id="S3.E10.m2.1.1.cmml" xref="S3.E10.m2.1.1"><eq id="S3.E10.m2.1.1.1.cmml" xref="S3.E10.m2.1.1.1"></eq><csymbol cd="latexml" id="S3.E10.m2.1.1.2.cmml" xref="S3.E10.m2.1.1.2">absent</csymbol><apply id="S3.E10.m2.1.1.3.cmml" xref="S3.E10.m2.1.1.3"><plus id="S3.E10.m2.1.1.3.1.cmml" xref="S3.E10.m2.1.1.3.1"></plus><apply id="S3.E10.m2.1.1.3.2.cmml" xref="S3.E10.m2.1.1.3.2"><csymbol cd="latexml" id="S3.E10.m2.1.1.3.2.1.cmml" xref="S3.E10.m2.1.1.3.2.1">direct-product</csymbol><ci id="S3.E10.m2.1.1.3.2.2.cmml" xref="S3.E10.m2.1.1.3.2.2">𝛼</ci><apply id="S3.E10.m2.1.1.3.2.3.cmml" xref="S3.E10.m2.1.1.3.2.3"><divide id="S3.E10.m2.1.1.3.2.3.1.cmml" xref="S3.E10.m2.1.1.3.2.3"></divide><apply id="S3.E10.m2.1.1.3.2.3.2.cmml" xref="S3.E10.m2.1.1.3.2.3.2"><minus id="S3.E10.m2.1.1.3.2.3.2.1.cmml" xref="S3.E10.m2.1.1.3.2.3.2.1"></minus><ci id="S3.E10.m2.1.1.3.2.3.2.2.cmml" xref="S3.E10.m2.1.1.3.2.3.2.2">𝐗</ci><ci id="S3.E10.m2.1.1.3.2.3.2.3.cmml" xref="S3.E10.m2.1.1.3.2.3.2.3">𝜇</ci></apply><apply id="S3.E10.m2.1.1.3.2.3.3.cmml" xref="S3.E10.m2.1.1.3.2.3.3"><root id="S3.E10.m2.1.1.3.2.3.3a.cmml" xref="S3.E10.m2.1.1.3.2.3.3"></root><apply id="S3.E10.m2.1.1.3.2.3.3.2.cmml" xref="S3.E10.m2.1.1.3.2.3.3.2"><plus id="S3.E10.m2.1.1.3.2.3.3.2.1.cmml" xref="S3.E10.m2.1.1.3.2.3.3.2.1"></plus><apply id="S3.E10.m2.1.1.3.2.3.3.2.2.cmml" xref="S3.E10.m2.1.1.3.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E10.m2.1.1.3.2.3.3.2.2.1.cmml" xref="S3.E10.m2.1.1.3.2.3.3.2.2">superscript</csymbol><ci id="S3.E10.m2.1.1.3.2.3.3.2.2.2.cmml" xref="S3.E10.m2.1.1.3.2.3.3.2.2.2">𝜎</ci><cn id="S3.E10.m2.1.1.3.2.3.3.2.2.3.cmml" type="integer" xref="S3.E10.m2.1.1.3.2.3.3.2.2.3">2</cn></apply><ci id="S3.E10.m2.1.1.3.2.3.3.2.3.cmml" xref="S3.E10.m2.1.1.3.2.3.3.2.3">italic-ϵ</ci></apply></apply></apply></apply><ci id="S3.E10.m2.1.1.3.3.cmml" xref="S3.E10.m2.1.1.3.3">𝛽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m2.1c">\displaystyle=\alpha\odot\frac{\mathbf{X}-\mu}{\sqrt{\sigma^{2}+\epsilon}}+\beta</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m2.1d">= italic_α ⊙ divide start_ARG bold_X - italic_μ end_ARG start_ARG square-root start_ARG italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_ϵ end_ARG end_ARG + italic_β</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{LRUNorm}(\mathbf{X})" class="ltx_Math" display="inline" id="S3.E11.m1.1"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1.2" xref="S3.E11.m1.1.2.cmml"><mtext id="S3.E11.m1.1.2.2" xref="S3.E11.m1.1.2.2a.cmml">LRUNorm</mtext><mo id="S3.E11.m1.1.2.1" xref="S3.E11.m1.1.2.1.cmml">⁢</mo><mrow id="S3.E11.m1.1.2.3.2" xref="S3.E11.m1.1.2.cmml"><mo id="S3.E11.m1.1.2.3.2.1" stretchy="false" xref="S3.E11.m1.1.2.cmml">(</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">𝐗</mi><mo id="S3.E11.m1.1.2.3.2.2" stretchy="false" xref="S3.E11.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1b"><apply id="S3.E11.m1.1.2.cmml" xref="S3.E11.m1.1.2"><times id="S3.E11.m1.1.2.1.cmml" xref="S3.E11.m1.1.2.1"></times><ci id="S3.E11.m1.1.2.2a.cmml" xref="S3.E11.m1.1.2.2"><mtext id="S3.E11.m1.1.2.2.cmml" xref="S3.E11.m1.1.2.2">LRUNorm</mtext></ci><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝐗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1c">\displaystyle\text{LRUNorm}(\mathbf{X})</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.1d">LRUNorm ( bold_X )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{LRU}(\text{LayerNorm}(\mathbf{X}))" class="ltx_Math" display="inline" id="S3.E11.m2.2"><semantics id="S3.E11.m2.2a"><mrow id="S3.E11.m2.2.2" xref="S3.E11.m2.2.2.cmml"><mi id="S3.E11.m2.2.2.3" xref="S3.E11.m2.2.2.3.cmml"></mi><mo id="S3.E11.m2.2.2.2" xref="S3.E11.m2.2.2.2.cmml">=</mo><mrow id="S3.E11.m2.2.2.1" xref="S3.E11.m2.2.2.1.cmml"><mtext id="S3.E11.m2.2.2.1.3" xref="S3.E11.m2.2.2.1.3a.cmml">LRU</mtext><mo id="S3.E11.m2.2.2.1.2" xref="S3.E11.m2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E11.m2.2.2.1.1.1" xref="S3.E11.m2.2.2.1.1.1.1.cmml"><mo id="S3.E11.m2.2.2.1.1.1.2" stretchy="false" xref="S3.E11.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m2.2.2.1.1.1.1" xref="S3.E11.m2.2.2.1.1.1.1.cmml"><mtext id="S3.E11.m2.2.2.1.1.1.1.2" xref="S3.E11.m2.2.2.1.1.1.1.2a.cmml">LayerNorm</mtext><mo id="S3.E11.m2.2.2.1.1.1.1.1" xref="S3.E11.m2.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E11.m2.2.2.1.1.1.1.3.2" xref="S3.E11.m2.2.2.1.1.1.1.cmml"><mo id="S3.E11.m2.2.2.1.1.1.1.3.2.1" stretchy="false" xref="S3.E11.m2.2.2.1.1.1.1.cmml">(</mo><mi id="S3.E11.m2.1.1" xref="S3.E11.m2.1.1.cmml">𝐗</mi><mo id="S3.E11.m2.2.2.1.1.1.1.3.2.2" stretchy="false" xref="S3.E11.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m2.2.2.1.1.1.3" stretchy="false" xref="S3.E11.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m2.2b"><apply id="S3.E11.m2.2.2.cmml" xref="S3.E11.m2.2.2"><eq id="S3.E11.m2.2.2.2.cmml" xref="S3.E11.m2.2.2.2"></eq><csymbol cd="latexml" id="S3.E11.m2.2.2.3.cmml" xref="S3.E11.m2.2.2.3">absent</csymbol><apply id="S3.E11.m2.2.2.1.cmml" xref="S3.E11.m2.2.2.1"><times id="S3.E11.m2.2.2.1.2.cmml" xref="S3.E11.m2.2.2.1.2"></times><ci id="S3.E11.m2.2.2.1.3a.cmml" xref="S3.E11.m2.2.2.1.3"><mtext id="S3.E11.m2.2.2.1.3.cmml" xref="S3.E11.m2.2.2.1.3">LRU</mtext></ci><apply id="S3.E11.m2.2.2.1.1.1.1.cmml" xref="S3.E11.m2.2.2.1.1.1"><times id="S3.E11.m2.2.2.1.1.1.1.1.cmml" xref="S3.E11.m2.2.2.1.1.1.1.1"></times><ci id="S3.E11.m2.2.2.1.1.1.1.2a.cmml" xref="S3.E11.m2.2.2.1.1.1.1.2"><mtext id="S3.E11.m2.2.2.1.1.1.1.2.cmml" xref="S3.E11.m2.2.2.1.1.1.1.2">LayerNorm</mtext></ci><ci id="S3.E11.m2.1.1.cmml" xref="S3.E11.m2.1.1">𝐗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m2.2c">\displaystyle=\text{LRU}(\text{LayerNorm}(\mathbf{X}))</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m2.2d">= LRU ( LayerNorm ( bold_X ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p2">
<p class="ltx_p" id="S3.SS3.SSS3.p2.1">Due to the lack of non-linearity for LRU, we
further process the output of LRU layer by a gated non-linear feed-forward network (FFN) to improve training dynamics and model performance. Specifically, our FFN is defined as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
<tbody id="S3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath" id="S3.Ex4.2.1.1.1">Gate</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{SiLU}(\mathbf{X}\mathbf{W}^{(g)}+\mathbf{b}^{(g)})" class="ltx_Math" display="inline" id="S3.Ex4.m2.3"><semantics id="S3.Ex4.m2.3a"><mrow id="S3.Ex4.m2.3.3" xref="S3.Ex4.m2.3.3.cmml"><mi id="S3.Ex4.m2.3.3.3" xref="S3.Ex4.m2.3.3.3.cmml"></mi><mo id="S3.Ex4.m2.3.3.2" xref="S3.Ex4.m2.3.3.2.cmml">=</mo><mrow id="S3.Ex4.m2.3.3.1" xref="S3.Ex4.m2.3.3.1.cmml"><mtext id="S3.Ex4.m2.3.3.1.3" xref="S3.Ex4.m2.3.3.1.3a.cmml">SiLU</mtext><mo id="S3.Ex4.m2.3.3.1.2" xref="S3.Ex4.m2.3.3.1.2.cmml">⁢</mo><mrow id="S3.Ex4.m2.3.3.1.1.1" xref="S3.Ex4.m2.3.3.1.1.1.1.cmml"><mo id="S3.Ex4.m2.3.3.1.1.1.2" stretchy="false" xref="S3.Ex4.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m2.3.3.1.1.1.1" xref="S3.Ex4.m2.3.3.1.1.1.1.cmml"><msup id="S3.Ex4.m2.3.3.1.1.1.1.2" xref="S3.Ex4.m2.3.3.1.1.1.1.2.cmml"><mi id="S3.Ex4.m2.3.3.1.1.1.1.2.2" xref="S3.Ex4.m2.3.3.1.1.1.1.2.2.cmml">𝐗𝐖</mi><mrow id="S3.Ex4.m2.1.1.1.3" xref="S3.Ex4.m2.3.3.1.1.1.1.2.cmml"><mo id="S3.Ex4.m2.1.1.1.3.1" stretchy="false" xref="S3.Ex4.m2.3.3.1.1.1.1.2.cmml">(</mo><mi id="S3.Ex4.m2.1.1.1.1" xref="S3.Ex4.m2.1.1.1.1.cmml">g</mi><mo id="S3.Ex4.m2.1.1.1.3.2" stretchy="false" xref="S3.Ex4.m2.3.3.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S3.Ex4.m2.3.3.1.1.1.1.1" xref="S3.Ex4.m2.3.3.1.1.1.1.1.cmml">+</mo><msup id="S3.Ex4.m2.3.3.1.1.1.1.3" xref="S3.Ex4.m2.3.3.1.1.1.1.3.cmml"><mi id="S3.Ex4.m2.3.3.1.1.1.1.3.2" xref="S3.Ex4.m2.3.3.1.1.1.1.3.2.cmml">𝐛</mi><mrow id="S3.Ex4.m2.2.2.1.3" xref="S3.Ex4.m2.3.3.1.1.1.1.3.cmml"><mo id="S3.Ex4.m2.2.2.1.3.1" stretchy="false" xref="S3.Ex4.m2.3.3.1.1.1.1.3.cmml">(</mo><mi id="S3.Ex4.m2.2.2.1.1" xref="S3.Ex4.m2.2.2.1.1.cmml">g</mi><mo id="S3.Ex4.m2.2.2.1.3.2" stretchy="false" xref="S3.Ex4.m2.3.3.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.Ex4.m2.3.3.1.1.1.3" stretchy="false" xref="S3.Ex4.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m2.3b"><apply id="S3.Ex4.m2.3.3.cmml" xref="S3.Ex4.m2.3.3"><eq id="S3.Ex4.m2.3.3.2.cmml" xref="S3.Ex4.m2.3.3.2"></eq><csymbol cd="latexml" id="S3.Ex4.m2.3.3.3.cmml" xref="S3.Ex4.m2.3.3.3">absent</csymbol><apply id="S3.Ex4.m2.3.3.1.cmml" xref="S3.Ex4.m2.3.3.1"><times id="S3.Ex4.m2.3.3.1.2.cmml" xref="S3.Ex4.m2.3.3.1.2"></times><ci id="S3.Ex4.m2.3.3.1.3a.cmml" xref="S3.Ex4.m2.3.3.1.3"><mtext id="S3.Ex4.m2.3.3.1.3.cmml" xref="S3.Ex4.m2.3.3.1.3">SiLU</mtext></ci><apply id="S3.Ex4.m2.3.3.1.1.1.1.cmml" xref="S3.Ex4.m2.3.3.1.1.1"><plus id="S3.Ex4.m2.3.3.1.1.1.1.1.cmml" xref="S3.Ex4.m2.3.3.1.1.1.1.1"></plus><apply id="S3.Ex4.m2.3.3.1.1.1.1.2.cmml" xref="S3.Ex4.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex4.m2.3.3.1.1.1.1.2.1.cmml" xref="S3.Ex4.m2.3.3.1.1.1.1.2">superscript</csymbol><ci id="S3.Ex4.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.Ex4.m2.3.3.1.1.1.1.2.2">𝐗𝐖</ci><ci id="S3.Ex4.m2.1.1.1.1.cmml" xref="S3.Ex4.m2.1.1.1.1">𝑔</ci></apply><apply id="S3.Ex4.m2.3.3.1.1.1.1.3.cmml" xref="S3.Ex4.m2.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex4.m2.3.3.1.1.1.1.3.1.cmml" xref="S3.Ex4.m2.3.3.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex4.m2.3.3.1.1.1.1.3.2.cmml" xref="S3.Ex4.m2.3.3.1.1.1.1.3.2">𝐛</ci><ci id="S3.Ex4.m2.2.2.1.1.cmml" xref="S3.Ex4.m2.2.2.1.1">𝑔</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m2.3c">\displaystyle=\text{SiLU}(\mathbf{X}\mathbf{W}^{(g)}+\mathbf{b}^{(g)})</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m2.3d">= SiLU ( bold_XW start_POSTSUPERSCRIPT ( italic_g ) end_POSTSUPERSCRIPT + bold_b start_POSTSUPERSCRIPT ( italic_g ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath" id="S3.Ex5.2.1.1.1">FFN</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(\text{Gate}\odot(\mathbf{X}\mathbf{W}^{(1)}+\mathbf{b}^{(1)}))%
\mathbf{W}^{(2)}+\mathbf{b}^{(2)}" class="ltx_Math" display="inline" id="S3.Ex5.m2.5"><semantics id="S3.Ex5.m2.5a"><mrow id="S3.Ex5.m2.5.5" xref="S3.Ex5.m2.5.5.cmml"><mi id="S3.Ex5.m2.5.5.3" xref="S3.Ex5.m2.5.5.3.cmml"></mi><mo id="S3.Ex5.m2.5.5.2" xref="S3.Ex5.m2.5.5.2.cmml">=</mo><mrow id="S3.Ex5.m2.5.5.1" xref="S3.Ex5.m2.5.5.1.cmml"><mrow id="S3.Ex5.m2.5.5.1.1" xref="S3.Ex5.m2.5.5.1.1.cmml"><mrow id="S3.Ex5.m2.5.5.1.1.1.1" xref="S3.Ex5.m2.5.5.1.1.1.1.1.cmml"><mo id="S3.Ex5.m2.5.5.1.1.1.1.2" stretchy="false" xref="S3.Ex5.m2.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex5.m2.5.5.1.1.1.1.1" xref="S3.Ex5.m2.5.5.1.1.1.1.1.cmml"><mtext id="S3.Ex5.m2.5.5.1.1.1.1.1.3" xref="S3.Ex5.m2.5.5.1.1.1.1.1.3a.cmml">Gate</mtext><mo id="S3.Ex5.m2.5.5.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.Ex5.m2.5.5.1.1.1.1.1.2.cmml">⊙</mo><mrow id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.cmml"><msup id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2.2.cmml">𝐗𝐖</mi><mrow id="S3.Ex5.m2.1.1.1.3" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex5.m2.1.1.1.3.1" stretchy="false" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2.cmml">(</mo><mn id="S3.Ex5.m2.1.1.1.1" xref="S3.Ex5.m2.1.1.1.1.cmml">1</mn><mo id="S3.Ex5.m2.1.1.1.3.2" stretchy="false" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.1" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">+</mo><msup id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mrow id="S3.Ex5.m2.2.2.1.3" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.Ex5.m2.2.2.1.3.1" stretchy="false" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3.cmml">(</mo><mn id="S3.Ex5.m2.2.2.1.1" xref="S3.Ex5.m2.2.2.1.1.cmml">1</mn><mo id="S3.Ex5.m2.2.2.1.3.2" stretchy="false" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex5.m2.5.5.1.1.1.1.3" stretchy="false" xref="S3.Ex5.m2.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex5.m2.5.5.1.1.2" xref="S3.Ex5.m2.5.5.1.1.2.cmml">⁢</mo><msup id="S3.Ex5.m2.5.5.1.1.3" xref="S3.Ex5.m2.5.5.1.1.3.cmml"><mi id="S3.Ex5.m2.5.5.1.1.3.2" xref="S3.Ex5.m2.5.5.1.1.3.2.cmml">𝐖</mi><mrow id="S3.Ex5.m2.3.3.1.3" xref="S3.Ex5.m2.5.5.1.1.3.cmml"><mo id="S3.Ex5.m2.3.3.1.3.1" stretchy="false" xref="S3.Ex5.m2.5.5.1.1.3.cmml">(</mo><mn id="S3.Ex5.m2.3.3.1.1" xref="S3.Ex5.m2.3.3.1.1.cmml">2</mn><mo id="S3.Ex5.m2.3.3.1.3.2" stretchy="false" xref="S3.Ex5.m2.5.5.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.Ex5.m2.5.5.1.2" xref="S3.Ex5.m2.5.5.1.2.cmml">+</mo><msup id="S3.Ex5.m2.5.5.1.3" xref="S3.Ex5.m2.5.5.1.3.cmml"><mi id="S3.Ex5.m2.5.5.1.3.2" xref="S3.Ex5.m2.5.5.1.3.2.cmml">𝐛</mi><mrow id="S3.Ex5.m2.4.4.1.3" xref="S3.Ex5.m2.5.5.1.3.cmml"><mo id="S3.Ex5.m2.4.4.1.3.1" stretchy="false" xref="S3.Ex5.m2.5.5.1.3.cmml">(</mo><mn id="S3.Ex5.m2.4.4.1.1" xref="S3.Ex5.m2.4.4.1.1.cmml">2</mn><mo id="S3.Ex5.m2.4.4.1.3.2" stretchy="false" xref="S3.Ex5.m2.5.5.1.3.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m2.5b"><apply id="S3.Ex5.m2.5.5.cmml" xref="S3.Ex5.m2.5.5"><eq id="S3.Ex5.m2.5.5.2.cmml" xref="S3.Ex5.m2.5.5.2"></eq><csymbol cd="latexml" id="S3.Ex5.m2.5.5.3.cmml" xref="S3.Ex5.m2.5.5.3">absent</csymbol><apply id="S3.Ex5.m2.5.5.1.cmml" xref="S3.Ex5.m2.5.5.1"><plus id="S3.Ex5.m2.5.5.1.2.cmml" xref="S3.Ex5.m2.5.5.1.2"></plus><apply id="S3.Ex5.m2.5.5.1.1.cmml" xref="S3.Ex5.m2.5.5.1.1"><times id="S3.Ex5.m2.5.5.1.1.2.cmml" xref="S3.Ex5.m2.5.5.1.1.2"></times><apply id="S3.Ex5.m2.5.5.1.1.1.1.1.cmml" xref="S3.Ex5.m2.5.5.1.1.1.1"><csymbol cd="latexml" id="S3.Ex5.m2.5.5.1.1.1.1.1.2.cmml" xref="S3.Ex5.m2.5.5.1.1.1.1.1.2">direct-product</csymbol><ci id="S3.Ex5.m2.5.5.1.1.1.1.1.3a.cmml" xref="S3.Ex5.m2.5.5.1.1.1.1.1.3"><mtext id="S3.Ex5.m2.5.5.1.1.1.1.1.3.cmml" xref="S3.Ex5.m2.5.5.1.1.1.1.1.3">Gate</mtext></ci><apply id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1"><plus id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.2.2">𝐗𝐖</ci><cn id="S3.Ex5.m2.1.1.1.1.cmml" type="integer" xref="S3.Ex5.m2.1.1.1.1">1</cn></apply><apply id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex5.m2.5.5.1.1.1.1.1.1.1.1.3.2">𝐛</ci><cn id="S3.Ex5.m2.2.2.1.1.cmml" type="integer" xref="S3.Ex5.m2.2.2.1.1">1</cn></apply></apply></apply><apply id="S3.Ex5.m2.5.5.1.1.3.cmml" xref="S3.Ex5.m2.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.5.5.1.1.3.1.cmml" xref="S3.Ex5.m2.5.5.1.1.3">superscript</csymbol><ci id="S3.Ex5.m2.5.5.1.1.3.2.cmml" xref="S3.Ex5.m2.5.5.1.1.3.2">𝐖</ci><cn id="S3.Ex5.m2.3.3.1.1.cmml" type="integer" xref="S3.Ex5.m2.3.3.1.1">2</cn></apply></apply><apply id="S3.Ex5.m2.5.5.1.3.cmml" xref="S3.Ex5.m2.5.5.1.3"><csymbol cd="ambiguous" id="S3.Ex5.m2.5.5.1.3.1.cmml" xref="S3.Ex5.m2.5.5.1.3">superscript</csymbol><ci id="S3.Ex5.m2.5.5.1.3.2.cmml" xref="S3.Ex5.m2.5.5.1.3.2">𝐛</ci><cn id="S3.Ex5.m2.4.4.1.1.cmml" type="integer" xref="S3.Ex5.m2.4.4.1.1">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m2.5c">\displaystyle=(\text{Gate}\odot(\mathbf{X}\mathbf{W}^{(1)}+\mathbf{b}^{(1)}))%
\mathbf{W}^{(2)}+\mathbf{b}^{(2)}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5.m2.5d">= ( Gate ⊙ ( bold_XW start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT + bold_b start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ) ) bold_W start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT + bold_b start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p2.2">As the network gets deeper, some signal of the input from the earlier layers might be forgotten. Thus, we add sub-layer connections in FFN by adding pre-layer normalization and residual connection:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{SubLayer}(\text{FFN},\mathbf{X})=\text{FFN}(\text{LayerNorm}(\mathbf{X})%
)+\mathbf{X}" class="ltx_Math" display="block" id="S3.Ex6.m1.4"><semantics id="S3.Ex6.m1.4a"><mrow id="S3.Ex6.m1.4.4" xref="S3.Ex6.m1.4.4.cmml"><mrow id="S3.Ex6.m1.4.4.3" xref="S3.Ex6.m1.4.4.3.cmml"><mtext id="S3.Ex6.m1.4.4.3.2" xref="S3.Ex6.m1.4.4.3.2a.cmml">SubLayer</mtext><mo id="S3.Ex6.m1.4.4.3.1" xref="S3.Ex6.m1.4.4.3.1.cmml">⁢</mo><mrow id="S3.Ex6.m1.4.4.3.3.2" xref="S3.Ex6.m1.4.4.3.3.1.cmml"><mo id="S3.Ex6.m1.4.4.3.3.2.1" stretchy="false" xref="S3.Ex6.m1.4.4.3.3.1.cmml">(</mo><mtext id="S3.Ex6.m1.1.1" xref="S3.Ex6.m1.1.1a.cmml">FFN</mtext><mo id="S3.Ex6.m1.4.4.3.3.2.2" xref="S3.Ex6.m1.4.4.3.3.1.cmml">,</mo><mi id="S3.Ex6.m1.2.2" xref="S3.Ex6.m1.2.2.cmml">𝐗</mi><mo id="S3.Ex6.m1.4.4.3.3.2.3" stretchy="false" xref="S3.Ex6.m1.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex6.m1.4.4.2" xref="S3.Ex6.m1.4.4.2.cmml">=</mo><mrow id="S3.Ex6.m1.4.4.1" xref="S3.Ex6.m1.4.4.1.cmml"><mrow id="S3.Ex6.m1.4.4.1.1" xref="S3.Ex6.m1.4.4.1.1.cmml"><mtext id="S3.Ex6.m1.4.4.1.1.3" xref="S3.Ex6.m1.4.4.1.1.3a.cmml">FFN</mtext><mo id="S3.Ex6.m1.4.4.1.1.2" xref="S3.Ex6.m1.4.4.1.1.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.4.4.1.1.1.1" xref="S3.Ex6.m1.4.4.1.1.1.1.1.cmml"><mo id="S3.Ex6.m1.4.4.1.1.1.1.2" stretchy="false" xref="S3.Ex6.m1.4.4.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m1.4.4.1.1.1.1.1" xref="S3.Ex6.m1.4.4.1.1.1.1.1.cmml"><mtext id="S3.Ex6.m1.4.4.1.1.1.1.1.2" xref="S3.Ex6.m1.4.4.1.1.1.1.1.2a.cmml">LayerNorm</mtext><mo id="S3.Ex6.m1.4.4.1.1.1.1.1.1" xref="S3.Ex6.m1.4.4.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex6.m1.4.4.1.1.1.1.1.3.2" xref="S3.Ex6.m1.4.4.1.1.1.1.1.cmml"><mo id="S3.Ex6.m1.4.4.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex6.m1.4.4.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex6.m1.3.3" xref="S3.Ex6.m1.3.3.cmml">𝐗</mi><mo id="S3.Ex6.m1.4.4.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex6.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex6.m1.4.4.1.1.1.1.3" stretchy="false" xref="S3.Ex6.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex6.m1.4.4.1.2" xref="S3.Ex6.m1.4.4.1.2.cmml">+</mo><mi id="S3.Ex6.m1.4.4.1.3" xref="S3.Ex6.m1.4.4.1.3.cmml">𝐗</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.4b"><apply id="S3.Ex6.m1.4.4.cmml" xref="S3.Ex6.m1.4.4"><eq id="S3.Ex6.m1.4.4.2.cmml" xref="S3.Ex6.m1.4.4.2"></eq><apply id="S3.Ex6.m1.4.4.3.cmml" xref="S3.Ex6.m1.4.4.3"><times id="S3.Ex6.m1.4.4.3.1.cmml" xref="S3.Ex6.m1.4.4.3.1"></times><ci id="S3.Ex6.m1.4.4.3.2a.cmml" xref="S3.Ex6.m1.4.4.3.2"><mtext id="S3.Ex6.m1.4.4.3.2.cmml" xref="S3.Ex6.m1.4.4.3.2">SubLayer</mtext></ci><interval closure="open" id="S3.Ex6.m1.4.4.3.3.1.cmml" xref="S3.Ex6.m1.4.4.3.3.2"><ci id="S3.Ex6.m1.1.1a.cmml" xref="S3.Ex6.m1.1.1"><mtext id="S3.Ex6.m1.1.1.cmml" xref="S3.Ex6.m1.1.1">FFN</mtext></ci><ci id="S3.Ex6.m1.2.2.cmml" xref="S3.Ex6.m1.2.2">𝐗</ci></interval></apply><apply id="S3.Ex6.m1.4.4.1.cmml" xref="S3.Ex6.m1.4.4.1"><plus id="S3.Ex6.m1.4.4.1.2.cmml" xref="S3.Ex6.m1.4.4.1.2"></plus><apply id="S3.Ex6.m1.4.4.1.1.cmml" xref="S3.Ex6.m1.4.4.1.1"><times id="S3.Ex6.m1.4.4.1.1.2.cmml" xref="S3.Ex6.m1.4.4.1.1.2"></times><ci id="S3.Ex6.m1.4.4.1.1.3a.cmml" xref="S3.Ex6.m1.4.4.1.1.3"><mtext id="S3.Ex6.m1.4.4.1.1.3.cmml" xref="S3.Ex6.m1.4.4.1.1.3">FFN</mtext></ci><apply id="S3.Ex6.m1.4.4.1.1.1.1.1.cmml" xref="S3.Ex6.m1.4.4.1.1.1.1"><times id="S3.Ex6.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.4.4.1.1.1.1.1.1"></times><ci id="S3.Ex6.m1.4.4.1.1.1.1.1.2a.cmml" xref="S3.Ex6.m1.4.4.1.1.1.1.1.2"><mtext id="S3.Ex6.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.4.4.1.1.1.1.1.2">LayerNorm</mtext></ci><ci id="S3.Ex6.m1.3.3.cmml" xref="S3.Ex6.m1.3.3">𝐗</ci></apply></apply><ci id="S3.Ex6.m1.4.4.1.3.cmml" xref="S3.Ex6.m1.4.4.1.3">𝐗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.4c">\text{SubLayer}(\text{FFN},\mathbf{X})=\text{FFN}(\text{LayerNorm}(\mathbf{X})%
)+\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex6.m1.4d">SubLayer ( FFN , bold_X ) = FFN ( LayerNorm ( bold_X ) ) + bold_X</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.4 </span>fMRLRec Plugin to Overall Framework</h4>
<div class="ltx_para" id="S3.SS3.SSS4.p1">
<p class="ltx_p" id="S3.SS3.SSS4.p1.4">Next, we apply fMRLRec-based weight design. Given a set of sizes <math alttext="\mathcal{M}=\{2,4,8,\ldots,D\}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.p1.1.m1.5"><semantics id="S3.SS3.SSS4.p1.1.m1.5a"><mrow id="S3.SS3.SSS4.p1.1.m1.5.6" xref="S3.SS3.SSS4.p1.1.m1.5.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS4.p1.1.m1.5.6.2" xref="S3.SS3.SSS4.p1.1.m1.5.6.2.cmml">ℳ</mi><mo id="S3.SS3.SSS4.p1.1.m1.5.6.1" xref="S3.SS3.SSS4.p1.1.m1.5.6.1.cmml">=</mo><mrow id="S3.SS3.SSS4.p1.1.m1.5.6.3.2" xref="S3.SS3.SSS4.p1.1.m1.5.6.3.1.cmml"><mo id="S3.SS3.SSS4.p1.1.m1.5.6.3.2.1" stretchy="false" xref="S3.SS3.SSS4.p1.1.m1.5.6.3.1.cmml">{</mo><mn id="S3.SS3.SSS4.p1.1.m1.1.1" xref="S3.SS3.SSS4.p1.1.m1.1.1.cmml">2</mn><mo id="S3.SS3.SSS4.p1.1.m1.5.6.3.2.2" xref="S3.SS3.SSS4.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S3.SS3.SSS4.p1.1.m1.2.2" xref="S3.SS3.SSS4.p1.1.m1.2.2.cmml">4</mn><mo id="S3.SS3.SSS4.p1.1.m1.5.6.3.2.3" xref="S3.SS3.SSS4.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S3.SS3.SSS4.p1.1.m1.3.3" xref="S3.SS3.SSS4.p1.1.m1.3.3.cmml">8</mn><mo id="S3.SS3.SSS4.p1.1.m1.5.6.3.2.4" xref="S3.SS3.SSS4.p1.1.m1.5.6.3.1.cmml">,</mo><mi id="S3.SS3.SSS4.p1.1.m1.4.4" mathvariant="normal" xref="S3.SS3.SSS4.p1.1.m1.4.4.cmml">…</mi><mo id="S3.SS3.SSS4.p1.1.m1.5.6.3.2.5" xref="S3.SS3.SSS4.p1.1.m1.5.6.3.1.cmml">,</mo><mi id="S3.SS3.SSS4.p1.1.m1.5.5" xref="S3.SS3.SSS4.p1.1.m1.5.5.cmml">D</mi><mo id="S3.SS3.SSS4.p1.1.m1.5.6.3.2.6" stretchy="false" xref="S3.SS3.SSS4.p1.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.p1.1.m1.5b"><apply id="S3.SS3.SSS4.p1.1.m1.5.6.cmml" xref="S3.SS3.SSS4.p1.1.m1.5.6"><eq id="S3.SS3.SSS4.p1.1.m1.5.6.1.cmml" xref="S3.SS3.SSS4.p1.1.m1.5.6.1"></eq><ci id="S3.SS3.SSS4.p1.1.m1.5.6.2.cmml" xref="S3.SS3.SSS4.p1.1.m1.5.6.2">ℳ</ci><set id="S3.SS3.SSS4.p1.1.m1.5.6.3.1.cmml" xref="S3.SS3.SSS4.p1.1.m1.5.6.3.2"><cn id="S3.SS3.SSS4.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS3.SSS4.p1.1.m1.1.1">2</cn><cn id="S3.SS3.SSS4.p1.1.m1.2.2.cmml" type="integer" xref="S3.SS3.SSS4.p1.1.m1.2.2">4</cn><cn id="S3.SS3.SSS4.p1.1.m1.3.3.cmml" type="integer" xref="S3.SS3.SSS4.p1.1.m1.3.3">8</cn><ci id="S3.SS3.SSS4.p1.1.m1.4.4.cmml" xref="S3.SS3.SSS4.p1.1.m1.4.4">…</ci><ci id="S3.SS3.SSS4.p1.1.m1.5.5.cmml" xref="S3.SS3.SSS4.p1.1.m1.5.5">𝐷</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.p1.1.m1.5c">\mathcal{M}=\{2,4,8,\ldots,D\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.p1.1.m1.5d">caligraphic_M = { 2 , 4 , 8 , … , italic_D }</annotation></semantics></math>, any <math alttext="W_{i}\in\mathbb{R}_{d}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.p1.2.m2.1"><semantics id="S3.SS3.SSS4.p1.2.m2.1a"><mrow id="S3.SS3.SSS4.p1.2.m2.1.1" xref="S3.SS3.SSS4.p1.2.m2.1.1.cmml"><msub id="S3.SS3.SSS4.p1.2.m2.1.1.2" xref="S3.SS3.SSS4.p1.2.m2.1.1.2.cmml"><mi id="S3.SS3.SSS4.p1.2.m2.1.1.2.2" xref="S3.SS3.SSS4.p1.2.m2.1.1.2.2.cmml">W</mi><mi id="S3.SS3.SSS4.p1.2.m2.1.1.2.3" xref="S3.SS3.SSS4.p1.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS4.p1.2.m2.1.1.1" xref="S3.SS3.SSS4.p1.2.m2.1.1.1.cmml">∈</mo><msub id="S3.SS3.SSS4.p1.2.m2.1.1.3" xref="S3.SS3.SSS4.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS4.p1.2.m2.1.1.3.2" xref="S3.SS3.SSS4.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS4.p1.2.m2.1.1.3.3" xref="S3.SS3.SSS4.p1.2.m2.1.1.3.3.cmml">d</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.p1.2.m2.1b"><apply id="S3.SS3.SSS4.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS4.p1.2.m2.1.1"><in id="S3.SS3.SSS4.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS4.p1.2.m2.1.1.1"></in><apply id="S3.SS3.SSS4.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS4.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS4.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS4.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS4.p1.2.m2.1.1.2.2">𝑊</ci><ci id="S3.SS3.SSS4.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.SSS4.p1.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS4.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS4.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS4.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS4.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS4.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS4.p1.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.p1.2.m2.1c">W_{i}\in\mathbb{R}_{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.p1.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, we leave it as is. For <math alttext="W_{i}\in\mathbb{R}^{d_{1}\times d_{2}}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.p1.3.m3.1"><semantics id="S3.SS3.SSS4.p1.3.m3.1a"><mrow id="S3.SS3.SSS4.p1.3.m3.1.1" xref="S3.SS3.SSS4.p1.3.m3.1.1.cmml"><msub id="S3.SS3.SSS4.p1.3.m3.1.1.2" xref="S3.SS3.SSS4.p1.3.m3.1.1.2.cmml"><mi id="S3.SS3.SSS4.p1.3.m3.1.1.2.2" xref="S3.SS3.SSS4.p1.3.m3.1.1.2.2.cmml">W</mi><mi id="S3.SS3.SSS4.p1.3.m3.1.1.2.3" xref="S3.SS3.SSS4.p1.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS4.p1.3.m3.1.1.1" xref="S3.SS3.SSS4.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS4.p1.3.m3.1.1.3" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.cmml"><mi id="S3.SS3.SSS4.p1.3.m3.1.1.3.2" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS4.p1.3.m3.1.1.3.3" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.cmml"><msub id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2.2" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2.2.cmml">d</mi><mn id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2.3" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2.3.cmml">1</mn></msub><mo id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3.2" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3.2.cmml">d</mi><mn id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3.3" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3.3.cmml">2</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.p1.3.m3.1b"><apply id="S3.SS3.SSS4.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1"><in id="S3.SS3.SSS4.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.1"></in><apply id="S3.SS3.SSS4.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p1.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS4.p1.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.2.2">𝑊</ci><ci id="S3.SS3.SSS4.p1.3.m3.1.1.2.3.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS4.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS4.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3"><times id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.1"></times><apply id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2.2">𝑑</ci><cn id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2.3.cmml" type="integer" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.2.3">1</cn></apply><apply id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3.2">𝑑</ci><cn id="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3.3.cmml" type="integer" xref="S3.SS3.SSS4.p1.3.m3.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.p1.3.m3.1c">W_{i}\in\mathbb{R}^{d_{1}\times d_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.p1.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, we apply the fMRLRec operator defined in section <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS2" title="3.2 Full-Scale Matryoshka Representation Learning for Recommendation ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">3.2</span></a> to <math alttext="W_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.p1.4.m4.1"><semantics id="S3.SS3.SSS4.p1.4.m4.1a"><msub id="S3.SS3.SSS4.p1.4.m4.1.1" xref="S3.SS3.SSS4.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS4.p1.4.m4.1.1.2" xref="S3.SS3.SSS4.p1.4.m4.1.1.2.cmml">W</mi><mi id="S3.SS3.SSS4.p1.4.m4.1.1.3" xref="S3.SS3.SSS4.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.p1.4.m4.1b"><apply id="S3.SS3.SSS4.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS4.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS4.p1.4.m4.1.1.2">𝑊</ci><ci id="S3.SS3.SSS4.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS4.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.p1.4.m4.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.p1.4.m4.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{W^{\prime}}_{i}=\text{{fMRLRec}}(\mathbf{W}_{i},\mathcal{M})" class="ltx_Math" display="block" id="S3.E12.m1.2"><semantics id="S3.E12.m1.2a"><mrow id="S3.E12.m1.2.2" xref="S3.E12.m1.2.2.cmml"><mmultiscripts id="S3.E12.m1.2.2.3" xref="S3.E12.m1.2.2.3.cmml"><mi id="S3.E12.m1.2.2.3.2.2" xref="S3.E12.m1.2.2.3.2.2.cmml">𝐖</mi><mrow id="S3.E12.m1.2.2.3a" xref="S3.E12.m1.2.2.3.cmml"></mrow><mo id="S3.E12.m1.2.2.3.2.3" xref="S3.E12.m1.2.2.3.2.3.cmml">′</mo><mi id="S3.E12.m1.2.2.3.3" xref="S3.E12.m1.2.2.3.3.cmml">i</mi><mrow id="S3.E12.m1.2.2.3b" xref="S3.E12.m1.2.2.3.cmml"></mrow></mmultiscripts><mo id="S3.E12.m1.2.2.2" xref="S3.E12.m1.2.2.2.cmml">=</mo><mrow id="S3.E12.m1.2.2.1" xref="S3.E12.m1.2.2.1.cmml"><mtext id="S3.E12.m1.2.2.1.3" xref="S3.E12.m1.2.2.1.3a.cmml">fMRLRec</mtext><mo id="S3.E12.m1.2.2.1.2" xref="S3.E12.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.2.2.1.1.1" xref="S3.E12.m1.2.2.1.1.2.cmml"><mo id="S3.E12.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E12.m1.2.2.1.1.2.cmml">(</mo><msub id="S3.E12.m1.2.2.1.1.1.1" xref="S3.E12.m1.2.2.1.1.1.1.cmml"><mi id="S3.E12.m1.2.2.1.1.1.1.2" xref="S3.E12.m1.2.2.1.1.1.1.2.cmml">𝐖</mi><mi id="S3.E12.m1.2.2.1.1.1.1.3" xref="S3.E12.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E12.m1.2.2.1.1.1.3" xref="S3.E12.m1.2.2.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml">ℳ</mi><mo id="S3.E12.m1.2.2.1.1.1.4" stretchy="false" xref="S3.E12.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.2b"><apply id="S3.E12.m1.2.2.cmml" xref="S3.E12.m1.2.2"><eq id="S3.E12.m1.2.2.2.cmml" xref="S3.E12.m1.2.2.2"></eq><apply id="S3.E12.m1.2.2.3.cmml" xref="S3.E12.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.3.1.cmml" xref="S3.E12.m1.2.2.3">subscript</csymbol><apply id="S3.E12.m1.2.2.3.2.cmml" xref="S3.E12.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.3.2.1.cmml" xref="S3.E12.m1.2.2.3">superscript</csymbol><ci id="S3.E12.m1.2.2.3.2.2.cmml" xref="S3.E12.m1.2.2.3.2.2">𝐖</ci><ci id="S3.E12.m1.2.2.3.2.3.cmml" xref="S3.E12.m1.2.2.3.2.3">′</ci></apply><ci id="S3.E12.m1.2.2.3.3.cmml" xref="S3.E12.m1.2.2.3.3">𝑖</ci></apply><apply id="S3.E12.m1.2.2.1.cmml" xref="S3.E12.m1.2.2.1"><times id="S3.E12.m1.2.2.1.2.cmml" xref="S3.E12.m1.2.2.1.2"></times><ci id="S3.E12.m1.2.2.1.3a.cmml" xref="S3.E12.m1.2.2.1.3"><mtext id="S3.E12.m1.2.2.1.3.cmml" xref="S3.E12.m1.2.2.1.3">fMRLRec</mtext></ci><interval closure="open" id="S3.E12.m1.2.2.1.1.2.cmml" xref="S3.E12.m1.2.2.1.1.1"><apply id="S3.E12.m1.2.2.1.1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.1.1.1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.2.2.1.1.1.1.2.cmml" xref="S3.E12.m1.2.2.1.1.1.1.2">𝐖</ci><ci id="S3.E12.m1.2.2.1.1.1.1.3.cmml" xref="S3.E12.m1.2.2.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1">ℳ</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.2c">\mathbf{W^{\prime}}_{i}=\text{{fMRLRec}}(\mathbf{W}_{i},\mathcal{M})</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.2d">bold_W start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = fMRLRec ( bold_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , caligraphic_M )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS4.p2">
<p class="ltx_p" id="S3.SS3.SSS4.p2.1">During inference time, <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS4.p2.1.1">independent</span> models <math alttext="\mathcal{Q}=\{\mathcal{W}^{\prime(1)},\mathcal{W}^{\prime(2)},\ldots,\mathcal{%
W}^{\prime(|\mathcal{M}|)}\}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.p2.1.m1.13"><semantics id="S3.SS3.SSS4.p2.1.m1.13a"><mrow id="S3.SS3.SSS4.p2.1.m1.13.13" xref="S3.SS3.SSS4.p2.1.m1.13.13.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS4.p2.1.m1.13.13.5" xref="S3.SS3.SSS4.p2.1.m1.13.13.5.cmml">𝒬</mi><mo id="S3.SS3.SSS4.p2.1.m1.13.13.4" xref="S3.SS3.SSS4.p2.1.m1.13.13.4.cmml">=</mo><mrow id="S3.SS3.SSS4.p2.1.m1.13.13.3.3" xref="S3.SS3.SSS4.p2.1.m1.13.13.3.4.cmml"><mo id="S3.SS3.SSS4.p2.1.m1.13.13.3.3.4" stretchy="false" xref="S3.SS3.SSS4.p2.1.m1.13.13.3.4.cmml">{</mo><msup id="S3.SS3.SSS4.p2.1.m1.11.11.1.1.1" xref="S3.SS3.SSS4.p2.1.m1.11.11.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS4.p2.1.m1.11.11.1.1.1.2" xref="S3.SS3.SSS4.p2.1.m1.11.11.1.1.1.2.cmml">𝒲</mi><mrow id="S3.SS3.SSS4.p2.1.m1.3.3.3.3" xref="S3.SS3.SSS4.p2.1.m1.3.3.3.4.cmml"><mo id="S3.SS3.SSS4.p2.1.m1.2.2.2.2.1" mathsize="142%" xref="S3.SS3.SSS4.p2.1.m1.2.2.2.2.1.cmml">′</mo><mo id="S3.SS3.SSS4.p2.1.m1.3.3.3.3.3" lspace="0em" xref="S3.SS3.SSS4.p2.1.m1.3.3.3.4.cmml">⁣</mo><mrow id="S3.SS3.SSS4.p2.1.m1.3.3.3.3.2.2" xref="S3.SS3.SSS4.p2.1.m1.3.3.3.4.cmml"><mo id="S3.SS3.SSS4.p2.1.m1.3.3.3.3.2.2.1" stretchy="false" xref="S3.SS3.SSS4.p2.1.m1.3.3.3.4.cmml">(</mo><mn id="S3.SS3.SSS4.p2.1.m1.1.1.1.1" xref="S3.SS3.SSS4.p2.1.m1.1.1.1.1.cmml">1</mn><mo id="S3.SS3.SSS4.p2.1.m1.3.3.3.3.2.2.2" stretchy="false" xref="S3.SS3.SSS4.p2.1.m1.3.3.3.4.cmml">)</mo></mrow></mrow></msup><mo id="S3.SS3.SSS4.p2.1.m1.13.13.3.3.5" xref="S3.SS3.SSS4.p2.1.m1.13.13.3.4.cmml">,</mo><msup id="S3.SS3.SSS4.p2.1.m1.12.12.2.2.2" xref="S3.SS3.SSS4.p2.1.m1.12.12.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS4.p2.1.m1.12.12.2.2.2.2" xref="S3.SS3.SSS4.p2.1.m1.12.12.2.2.2.2.cmml">𝒲</mi><mrow id="S3.SS3.SSS4.p2.1.m1.6.6.3.3" xref="S3.SS3.SSS4.p2.1.m1.6.6.3.4.cmml"><mo id="S3.SS3.SSS4.p2.1.m1.5.5.2.2.1" mathsize="142%" xref="S3.SS3.SSS4.p2.1.m1.5.5.2.2.1.cmml">′</mo><mo id="S3.SS3.SSS4.p2.1.m1.6.6.3.3.3" lspace="0em" xref="S3.SS3.SSS4.p2.1.m1.6.6.3.4.cmml">⁣</mo><mrow id="S3.SS3.SSS4.p2.1.m1.6.6.3.3.2.2" xref="S3.SS3.SSS4.p2.1.m1.6.6.3.4.cmml"><mo id="S3.SS3.SSS4.p2.1.m1.6.6.3.3.2.2.1" stretchy="false" xref="S3.SS3.SSS4.p2.1.m1.6.6.3.4.cmml">(</mo><mn id="S3.SS3.SSS4.p2.1.m1.4.4.1.1" xref="S3.SS3.SSS4.p2.1.m1.4.4.1.1.cmml">2</mn><mo id="S3.SS3.SSS4.p2.1.m1.6.6.3.3.2.2.2" stretchy="false" xref="S3.SS3.SSS4.p2.1.m1.6.6.3.4.cmml">)</mo></mrow></mrow></msup><mo id="S3.SS3.SSS4.p2.1.m1.13.13.3.3.6" xref="S3.SS3.SSS4.p2.1.m1.13.13.3.4.cmml">,</mo><mi id="S3.SS3.SSS4.p2.1.m1.10.10" mathvariant="normal" xref="S3.SS3.SSS4.p2.1.m1.10.10.cmml">…</mi><mo id="S3.SS3.SSS4.p2.1.m1.13.13.3.3.7" xref="S3.SS3.SSS4.p2.1.m1.13.13.3.4.cmml">,</mo><msup id="S3.SS3.SSS4.p2.1.m1.13.13.3.3.3" xref="S3.SS3.SSS4.p2.1.m1.13.13.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS4.p2.1.m1.13.13.3.3.3.2" xref="S3.SS3.SSS4.p2.1.m1.13.13.3.3.3.2.cmml">𝒲</mi><mrow id="S3.SS3.SSS4.p2.1.m1.9.9.3.3" xref="S3.SS3.SSS4.p2.1.m1.9.9.3.4.cmml"><mo id="S3.SS3.SSS4.p2.1.m1.8.8.2.2.1" mathsize="142%" xref="S3.SS3.SSS4.p2.1.m1.8.8.2.2.1.cmml">′</mo><mo id="S3.SS3.SSS4.p2.1.m1.9.9.3.3.3" lspace="0em" xref="S3.SS3.SSS4.p2.1.m1.9.9.3.4.cmml">⁣</mo><mrow id="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1" xref="S3.SS3.SSS4.p2.1.m1.9.9.3.4.cmml"><mo id="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1.2" stretchy="false" xref="S3.SS3.SSS4.p2.1.m1.9.9.3.4.cmml">(</mo><mrow id="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1.1.2" xref="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1.1.1.cmml"><mo id="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1.1.2.1" stretchy="false" xref="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1.1.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS4.p2.1.m1.7.7.1.1" xref="S3.SS3.SSS4.p2.1.m1.7.7.1.1.cmml">ℳ</mi><mo id="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1.1.2.2" stretchy="false" xref="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1.1.1.1.cmml">|</mo></mrow><mo id="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1.3" stretchy="false" xref="S3.SS3.SSS4.p2.1.m1.9.9.3.4.cmml">)</mo></mrow></mrow></msup><mo id="S3.SS3.SSS4.p2.1.m1.13.13.3.3.8" stretchy="false" xref="S3.SS3.SSS4.p2.1.m1.13.13.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.p2.1.m1.13b"><apply id="S3.SS3.SSS4.p2.1.m1.13.13.cmml" xref="S3.SS3.SSS4.p2.1.m1.13.13"><eq id="S3.SS3.SSS4.p2.1.m1.13.13.4.cmml" xref="S3.SS3.SSS4.p2.1.m1.13.13.4"></eq><ci id="S3.SS3.SSS4.p2.1.m1.13.13.5.cmml" xref="S3.SS3.SSS4.p2.1.m1.13.13.5">𝒬</ci><set id="S3.SS3.SSS4.p2.1.m1.13.13.3.4.cmml" xref="S3.SS3.SSS4.p2.1.m1.13.13.3.3"><apply id="S3.SS3.SSS4.p2.1.m1.11.11.1.1.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.11.11.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p2.1.m1.11.11.1.1.1.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.11.11.1.1.1">superscript</csymbol><ci id="S3.SS3.SSS4.p2.1.m1.11.11.1.1.1.2.cmml" xref="S3.SS3.SSS4.p2.1.m1.11.11.1.1.1.2">𝒲</ci><list id="S3.SS3.SSS4.p2.1.m1.3.3.3.4.cmml" xref="S3.SS3.SSS4.p2.1.m1.3.3.3.3"><ci id="S3.SS3.SSS4.p2.1.m1.2.2.2.2.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.2.2.2.2.1">′</ci><cn id="S3.SS3.SSS4.p2.1.m1.1.1.1.1.cmml" type="integer" xref="S3.SS3.SSS4.p2.1.m1.1.1.1.1">1</cn></list></apply><apply id="S3.SS3.SSS4.p2.1.m1.12.12.2.2.2.cmml" xref="S3.SS3.SSS4.p2.1.m1.12.12.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p2.1.m1.12.12.2.2.2.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.12.12.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS4.p2.1.m1.12.12.2.2.2.2.cmml" xref="S3.SS3.SSS4.p2.1.m1.12.12.2.2.2.2">𝒲</ci><list id="S3.SS3.SSS4.p2.1.m1.6.6.3.4.cmml" xref="S3.SS3.SSS4.p2.1.m1.6.6.3.3"><ci id="S3.SS3.SSS4.p2.1.m1.5.5.2.2.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.5.5.2.2.1">′</ci><cn id="S3.SS3.SSS4.p2.1.m1.4.4.1.1.cmml" type="integer" xref="S3.SS3.SSS4.p2.1.m1.4.4.1.1">2</cn></list></apply><ci id="S3.SS3.SSS4.p2.1.m1.10.10.cmml" xref="S3.SS3.SSS4.p2.1.m1.10.10">…</ci><apply id="S3.SS3.SSS4.p2.1.m1.13.13.3.3.3.cmml" xref="S3.SS3.SSS4.p2.1.m1.13.13.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS4.p2.1.m1.13.13.3.3.3.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.13.13.3.3.3">superscript</csymbol><ci id="S3.SS3.SSS4.p2.1.m1.13.13.3.3.3.2.cmml" xref="S3.SS3.SSS4.p2.1.m1.13.13.3.3.3.2">𝒲</ci><list id="S3.SS3.SSS4.p2.1.m1.9.9.3.4.cmml" xref="S3.SS3.SSS4.p2.1.m1.9.9.3.3"><ci id="S3.SS3.SSS4.p2.1.m1.8.8.2.2.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.8.8.2.2.1">′</ci><apply id="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1.1.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1.1.2"><abs id="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1.1.1.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.9.9.3.3.2.1.1.2.1"></abs><ci id="S3.SS3.SSS4.p2.1.m1.7.7.1.1.cmml" xref="S3.SS3.SSS4.p2.1.m1.7.7.1.1">ℳ</ci></apply></list></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.p2.1.m1.13c">\mathcal{Q}=\{\mathcal{W}^{\prime(1)},\mathcal{W}^{\prime(2)},\ldots,\mathcal{%
W}^{\prime(|\mathcal{M}|)}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.p2.1.m1.13d">caligraphic_Q = { caligraphic_W start_POSTSUPERSCRIPT ′ ( 1 ) end_POSTSUPERSCRIPT , caligraphic_W start_POSTSUPERSCRIPT ′ ( 2 ) end_POSTSUPERSCRIPT , … , caligraphic_W start_POSTSUPERSCRIPT ′ ( | caligraphic_M | ) end_POSTSUPERSCRIPT }</annotation></semantics></math> could be extracted as described in the last paragraph of section <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS2" title="3.2 Full-Scale Matryoshka Representation Learning for Recommendation ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">3.2</span></a>.</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS4.Px1">
<h5 class="ltx_title ltx_title_paragraph">Prediction Layer</h5>
<div class="ltx_para" id="S3.SS3.SSS4.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS4.Px1.p1.7">After the final layer <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.SSS4.Px1.p1.1.m1.1"><semantics id="S3.SS3.SSS4.Px1.p1.1.m1.1a"><mi id="S3.SS3.SSS4.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS4.Px1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.Px1.p1.1.m1.1b"><ci id="S3.SS3.SSS4.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.Px1.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.Px1.p1.1.m1.1d">italic_N</annotation></semantics></math>, we extract the activation at the last time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.SSS4.Px1.p1.2.m2.1"><semantics id="S3.SS3.SSS4.Px1.p1.2.m2.1a"><mi id="S3.SS3.SSS4.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS4.Px1.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.Px1.p1.2.m2.1b"><ci id="S3.SS3.SSS4.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.Px1.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.Px1.p1.2.m2.1d">italic_t</annotation></semantics></math> of the final layer as <math alttext="z_{t}^{(N)}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.Px1.p1.3.m3.1"><semantics id="S3.SS3.SSS4.Px1.p1.3.m3.1a"><mrow id="S3.SS3.SSS4.Px1.p1.3.m3.1.2" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.cmml"><msubsup id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.cmml"><mi id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.2.2" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.2.2.cmml">z</mi><mi id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.2.3" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.2.3.cmml">t</mi><mrow id="S3.SS3.SSS4.Px1.p1.3.m3.1.1.1.3" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.cmml"><mo id="S3.SS3.SSS4.Px1.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.cmml">(</mo><mi id="S3.SS3.SSS4.Px1.p1.3.m3.1.1.1.1" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.1.1.1.cmml">N</mi><mo id="S3.SS3.SSS4.Px1.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.1" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.1.cmml">∈</mo><msup id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3.cmml"><mi id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3.2" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3.3" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.Px1.p1.3.m3.1b"><apply id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2"><in id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.1.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.1"></in><apply id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.1.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2">superscript</csymbol><apply id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.2.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.2.1.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.2.2.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.2.2">𝑧</ci><ci id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.2.3.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.2.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS4.Px1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.1.1.1">𝑁</ci></apply><apply id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3.1.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3">superscript</csymbol><ci id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3.2.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3.2">ℝ</ci><ci id="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3.3.cmml" xref="S3.SS3.SSS4.Px1.p1.3.m3.1.2.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.Px1.p1.3.m3.1c">z_{t}^{(N)}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.Px1.p1.3.m3.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, and use it to compute the relevance <math alttext="r_{i,t}\in\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.Px1.p1.4.m4.2"><semantics id="S3.SS3.SSS4.Px1.p1.4.m4.2a"><mrow id="S3.SS3.SSS4.Px1.p1.4.m4.2.3" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.3.cmml"><msub id="S3.SS3.SSS4.Px1.p1.4.m4.2.3.2" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.3.2.cmml"><mi id="S3.SS3.SSS4.Px1.p1.4.m4.2.3.2.2" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.3.2.2.cmml">r</mi><mrow id="S3.SS3.SSS4.Px1.p1.4.m4.2.2.2.4" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.2.2.3.cmml"><mi id="S3.SS3.SSS4.Px1.p1.4.m4.1.1.1.1" xref="S3.SS3.SSS4.Px1.p1.4.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS4.Px1.p1.4.m4.2.2.2.4.1" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS4.Px1.p1.4.m4.2.2.2.2" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.SS3.SSS4.Px1.p1.4.m4.2.3.1" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.3.1.cmml">∈</mo><mi id="S3.SS3.SSS4.Px1.p1.4.m4.2.3.3" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.3.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.Px1.p1.4.m4.2b"><apply id="S3.SS3.SSS4.Px1.p1.4.m4.2.3.cmml" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.3"><in id="S3.SS3.SSS4.Px1.p1.4.m4.2.3.1.cmml" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.3.1"></in><apply id="S3.SS3.SSS4.Px1.p1.4.m4.2.3.2.cmml" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS4.Px1.p1.4.m4.2.3.2.1.cmml" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.3.2">subscript</csymbol><ci id="S3.SS3.SSS4.Px1.p1.4.m4.2.3.2.2.cmml" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.3.2.2">𝑟</ci><list id="S3.SS3.SSS4.Px1.p1.4.m4.2.2.2.3.cmml" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.2.2.4"><ci id="S3.SS3.SSS4.Px1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.4.m4.1.1.1.1">𝑖</ci><ci id="S3.SS3.SSS4.Px1.p1.4.m4.2.2.2.2.cmml" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.2.2.2">𝑡</ci></list></apply><ci id="S3.SS3.SSS4.Px1.p1.4.m4.2.3.3.cmml" xref="S3.SS3.SSS4.Px1.p1.4.m4.2.3.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.Px1.p1.4.m4.2c">r_{i,t}\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.Px1.p1.4.m4.2d">italic_r start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ∈ blackboard_R</annotation></semantics></math> for all items in the pool <math alttext="v_{i}\in\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.Px1.p1.5.m5.1"><semantics id="S3.SS3.SSS4.Px1.p1.5.m5.1a"><mrow id="S3.SS3.SSS4.Px1.p1.5.m5.1.1" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1.cmml"><msub id="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2.cmml"><mi id="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2.2" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2.2.cmml">v</mi><mi id="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2.3" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS4.Px1.p1.5.m5.1.1.1" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS4.Px1.p1.5.m5.1.1.3" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.Px1.p1.5.m5.1b"><apply id="S3.SS3.SSS4.Px1.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1"><in id="S3.SS3.SSS4.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1.1"></in><apply id="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2.2">𝑣</ci><ci id="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS4.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSS4.Px1.p1.5.m5.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.Px1.p1.5.m5.1c">v_{i}\in\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.Px1.p1.5.m5.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_V</annotation></semantics></math>.
Specifically, we perform dot product between <math alttext="z_{t}^{(N)}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.Px1.p1.6.m6.1"><semantics id="S3.SS3.SSS4.Px1.p1.6.m6.1a"><msubsup id="S3.SS3.SSS4.Px1.p1.6.m6.1.2" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.2.cmml"><mi id="S3.SS3.SSS4.Px1.p1.6.m6.1.2.2.2" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.2.2.2.cmml">z</mi><mi id="S3.SS3.SSS4.Px1.p1.6.m6.1.2.2.3" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.2.2.3.cmml">t</mi><mrow id="S3.SS3.SSS4.Px1.p1.6.m6.1.1.1.3" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.2.cmml"><mo id="S3.SS3.SSS4.Px1.p1.6.m6.1.1.1.3.1" stretchy="false" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.2.cmml">(</mo><mi id="S3.SS3.SSS4.Px1.p1.6.m6.1.1.1.1" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.1.1.1.cmml">N</mi><mo id="S3.SS3.SSS4.Px1.p1.6.m6.1.1.1.3.2" stretchy="false" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.Px1.p1.6.m6.1b"><apply id="S3.SS3.SSS4.Px1.p1.6.m6.1.2.cmml" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS4.Px1.p1.6.m6.1.2.1.cmml" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.2">superscript</csymbol><apply id="S3.SS3.SSS4.Px1.p1.6.m6.1.2.2.cmml" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS4.Px1.p1.6.m6.1.2.2.1.cmml" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.2">subscript</csymbol><ci id="S3.SS3.SSS4.Px1.p1.6.m6.1.2.2.2.cmml" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.2.2.2">𝑧</ci><ci id="S3.SS3.SSS4.Px1.p1.6.m6.1.2.2.3.cmml" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.2.2.3">𝑡</ci></apply><ci id="S3.SS3.SSS4.Px1.p1.6.m6.1.1.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.6.m6.1.1.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.Px1.p1.6.m6.1c">z_{t}^{(N)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.Px1.p1.6.m6.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT</annotation></semantics></math> with the input/shared embedding layer weight <math alttext="E_{W}\in\mathbb{R}^{|\mathcal{V}|\times D}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.Px1.p1.7.m7.1"><semantics id="S3.SS3.SSS4.Px1.p1.7.m7.1a"><mrow id="S3.SS3.SSS4.Px1.p1.7.m7.1.2" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.cmml"><msub id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2.cmml"><mi id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2.2" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2.2.cmml">E</mi><mi id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2.3" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2.3.cmml">W</mi></msub><mo id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.1" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.1.cmml">∈</mo><msup id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.3" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.3.cmml"><mi id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.3.2" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.cmml"><mrow id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.3.2" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.3.1.cmml"><mo id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.3.2.1" stretchy="false" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.1" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.1.cmml">𝒱</mi><mo id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.2" rspace="0.222em" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.2.cmml">×</mo><mi id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.4" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.Px1.p1.7.m7.1b"><apply id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2"><in id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.1.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.1"></in><apply id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2.1.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2.2.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2.2">𝐸</ci><ci id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2.3.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.2.3">𝑊</ci></apply><apply id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.3.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.3.1.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.3">superscript</csymbol><ci id="S3.SS3.SSS4.Px1.p1.7.m7.1.2.3.2.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.2.3.2">ℝ</ci><apply id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1"><times id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.2.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.2"></times><apply id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.3.1.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.3.2"><abs id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.3.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.3.2.1"></abs><ci id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.1">𝒱</ci></apply><ci id="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.4.cmml" xref="S3.SS3.SSS4.Px1.p1.7.m7.1.1.1.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.Px1.p1.7.m7.1c">E_{W}\in\mathbb{R}^{|\mathcal{V}|\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.Px1.p1.7.m7.1d">italic_E start_POSTSUBSCRIPT italic_W end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_V | × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{i,t}=\left(\mathbf{z}_{t}^{(N)}\mathbf{E}_{w}^{T}\right)_{i}" class="ltx_Math" display="block" id="S3.E13.m1.4"><semantics id="S3.E13.m1.4a"><mrow id="S3.E13.m1.4.4" xref="S3.E13.m1.4.4.cmml"><msub id="S3.E13.m1.4.4.3" xref="S3.E13.m1.4.4.3.cmml"><mi id="S3.E13.m1.4.4.3.2" xref="S3.E13.m1.4.4.3.2.cmml">r</mi><mrow id="S3.E13.m1.2.2.2.4" xref="S3.E13.m1.2.2.2.3.cmml"><mi id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml">i</mi><mo id="S3.E13.m1.2.2.2.4.1" xref="S3.E13.m1.2.2.2.3.cmml">,</mo><mi id="S3.E13.m1.2.2.2.2" xref="S3.E13.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E13.m1.4.4.2" xref="S3.E13.m1.4.4.2.cmml">=</mo><msub id="S3.E13.m1.4.4.1" xref="S3.E13.m1.4.4.1.cmml"><mrow id="S3.E13.m1.4.4.1.1.1" xref="S3.E13.m1.4.4.1.1.1.1.cmml"><mo id="S3.E13.m1.4.4.1.1.1.2" xref="S3.E13.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.4.4.1.1.1.1" xref="S3.E13.m1.4.4.1.1.1.1.cmml"><msubsup id="S3.E13.m1.4.4.1.1.1.1.2" xref="S3.E13.m1.4.4.1.1.1.1.2.cmml"><mi id="S3.E13.m1.4.4.1.1.1.1.2.2.2" xref="S3.E13.m1.4.4.1.1.1.1.2.2.2.cmml">𝐳</mi><mi id="S3.E13.m1.4.4.1.1.1.1.2.2.3" xref="S3.E13.m1.4.4.1.1.1.1.2.2.3.cmml">t</mi><mrow id="S3.E13.m1.3.3.1.3" xref="S3.E13.m1.4.4.1.1.1.1.2.cmml"><mo id="S3.E13.m1.3.3.1.3.1" stretchy="false" xref="S3.E13.m1.4.4.1.1.1.1.2.cmml">(</mo><mi id="S3.E13.m1.3.3.1.1" xref="S3.E13.m1.3.3.1.1.cmml">N</mi><mo id="S3.E13.m1.3.3.1.3.2" stretchy="false" xref="S3.E13.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.E13.m1.4.4.1.1.1.1.1" xref="S3.E13.m1.4.4.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.E13.m1.4.4.1.1.1.1.3" xref="S3.E13.m1.4.4.1.1.1.1.3.cmml"><mi id="S3.E13.m1.4.4.1.1.1.1.3.2.2" xref="S3.E13.m1.4.4.1.1.1.1.3.2.2.cmml">𝐄</mi><mi id="S3.E13.m1.4.4.1.1.1.1.3.2.3" xref="S3.E13.m1.4.4.1.1.1.1.3.2.3.cmml">w</mi><mi id="S3.E13.m1.4.4.1.1.1.1.3.3" xref="S3.E13.m1.4.4.1.1.1.1.3.3.cmml">T</mi></msubsup></mrow><mo id="S3.E13.m1.4.4.1.1.1.3" xref="S3.E13.m1.4.4.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E13.m1.4.4.1.3" xref="S3.E13.m1.4.4.1.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.4b"><apply id="S3.E13.m1.4.4.cmml" xref="S3.E13.m1.4.4"><eq id="S3.E13.m1.4.4.2.cmml" xref="S3.E13.m1.4.4.2"></eq><apply id="S3.E13.m1.4.4.3.cmml" xref="S3.E13.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.3.1.cmml" xref="S3.E13.m1.4.4.3">subscript</csymbol><ci id="S3.E13.m1.4.4.3.2.cmml" xref="S3.E13.m1.4.4.3.2">𝑟</ci><list id="S3.E13.m1.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.4"><ci id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1">𝑖</ci><ci id="S3.E13.m1.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E13.m1.4.4.1.cmml" xref="S3.E13.m1.4.4.1"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.2.cmml" xref="S3.E13.m1.4.4.1">subscript</csymbol><apply id="S3.E13.m1.4.4.1.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.1"><times id="S3.E13.m1.4.4.1.1.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.1.1.1"></times><apply id="S3.E13.m1.4.4.1.1.1.1.2.cmml" xref="S3.E13.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E13.m1.4.4.1.1.1.1.2">superscript</csymbol><apply id="S3.E13.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E13.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.1.1.2.2.1.cmml" xref="S3.E13.m1.4.4.1.1.1.1.2">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S3.E13.m1.4.4.1.1.1.1.2.2.2">𝐳</ci><ci id="S3.E13.m1.4.4.1.1.1.1.2.2.3.cmml" xref="S3.E13.m1.4.4.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="S3.E13.m1.3.3.1.1.cmml" xref="S3.E13.m1.3.3.1.1">𝑁</ci></apply><apply id="S3.E13.m1.4.4.1.1.1.1.3.cmml" xref="S3.E13.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E13.m1.4.4.1.1.1.1.3">superscript</csymbol><apply id="S3.E13.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E13.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S3.E13.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S3.E13.m1.4.4.1.1.1.1.3.2.2">𝐄</ci><ci id="S3.E13.m1.4.4.1.1.1.1.3.2.3.cmml" xref="S3.E13.m1.4.4.1.1.1.1.3.2.3">𝑤</ci></apply><ci id="S3.E13.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.E13.m1.4.4.1.1.1.1.3.3">𝑇</ci></apply></apply><ci id="S3.E13.m1.4.4.1.3.cmml" xref="S3.E13.m1.4.4.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.4c">r_{i,t}=\left(\mathbf{z}_{t}^{(N)}\mathbf{E}_{w}^{T}\right)_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.4d">italic_r start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT = ( bold_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_N ) end_POSTSUPERSCRIPT bold_E start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS4.Px1.p1.10">The higher <math alttext="r_{i,t}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.Px1.p1.8.m1.2"><semantics id="S3.SS3.SSS4.Px1.p1.8.m1.2a"><msub id="S3.SS3.SSS4.Px1.p1.8.m1.2.3" xref="S3.SS3.SSS4.Px1.p1.8.m1.2.3.cmml"><mi id="S3.SS3.SSS4.Px1.p1.8.m1.2.3.2" xref="S3.SS3.SSS4.Px1.p1.8.m1.2.3.2.cmml">r</mi><mrow id="S3.SS3.SSS4.Px1.p1.8.m1.2.2.2.4" xref="S3.SS3.SSS4.Px1.p1.8.m1.2.2.2.3.cmml"><mi id="S3.SS3.SSS4.Px1.p1.8.m1.1.1.1.1" xref="S3.SS3.SSS4.Px1.p1.8.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS4.Px1.p1.8.m1.2.2.2.4.1" xref="S3.SS3.SSS4.Px1.p1.8.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS4.Px1.p1.8.m1.2.2.2.2" xref="S3.SS3.SSS4.Px1.p1.8.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.Px1.p1.8.m1.2b"><apply id="S3.SS3.SSS4.Px1.p1.8.m1.2.3.cmml" xref="S3.SS3.SSS4.Px1.p1.8.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS4.Px1.p1.8.m1.2.3.1.cmml" xref="S3.SS3.SSS4.Px1.p1.8.m1.2.3">subscript</csymbol><ci id="S3.SS3.SSS4.Px1.p1.8.m1.2.3.2.cmml" xref="S3.SS3.SSS4.Px1.p1.8.m1.2.3.2">𝑟</ci><list id="S3.SS3.SSS4.Px1.p1.8.m1.2.2.2.3.cmml" xref="S3.SS3.SSS4.Px1.p1.8.m1.2.2.2.4"><ci id="S3.SS3.SSS4.Px1.p1.8.m1.1.1.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.8.m1.1.1.1.1">𝑖</ci><ci id="S3.SS3.SSS4.Px1.p1.8.m1.2.2.2.2.cmml" xref="S3.SS3.SSS4.Px1.p1.8.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.Px1.p1.8.m1.2c">r_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.Px1.p1.8.m1.2d">italic_r start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, the more likely a user is to consider item <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.Px1.p1.9.m2.1"><semantics id="S3.SS3.SSS4.Px1.p1.9.m2.1a"><msub id="S3.SS3.SSS4.Px1.p1.9.m2.1.1" xref="S3.SS3.SSS4.Px1.p1.9.m2.1.1.cmml"><mi id="S3.SS3.SSS4.Px1.p1.9.m2.1.1.2" xref="S3.SS3.SSS4.Px1.p1.9.m2.1.1.2.cmml">v</mi><mi id="S3.SS3.SSS4.Px1.p1.9.m2.1.1.3" xref="S3.SS3.SSS4.Px1.p1.9.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.Px1.p1.9.m2.1b"><apply id="S3.SS3.SSS4.Px1.p1.9.m2.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.9.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS4.Px1.p1.9.m2.1.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.9.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS4.Px1.p1.9.m2.1.1.2.cmml" xref="S3.SS3.SSS4.Px1.p1.9.m2.1.1.2">𝑣</ci><ci id="S3.SS3.SSS4.Px1.p1.9.m2.1.1.3.cmml" xref="S3.SS3.SSS4.Px1.p1.9.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.Px1.p1.9.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.Px1.p1.9.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for the next time step. This way we could generate recommendations by ranking the relevance score <math alttext="r_{i,t}" class="ltx_Math" display="inline" id="S3.SS3.SSS4.Px1.p1.10.m3.2"><semantics id="S3.SS3.SSS4.Px1.p1.10.m3.2a"><msub id="S3.SS3.SSS4.Px1.p1.10.m3.2.3" xref="S3.SS3.SSS4.Px1.p1.10.m3.2.3.cmml"><mi id="S3.SS3.SSS4.Px1.p1.10.m3.2.3.2" xref="S3.SS3.SSS4.Px1.p1.10.m3.2.3.2.cmml">r</mi><mrow id="S3.SS3.SSS4.Px1.p1.10.m3.2.2.2.4" xref="S3.SS3.SSS4.Px1.p1.10.m3.2.2.2.3.cmml"><mi id="S3.SS3.SSS4.Px1.p1.10.m3.1.1.1.1" xref="S3.SS3.SSS4.Px1.p1.10.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS4.Px1.p1.10.m3.2.2.2.4.1" xref="S3.SS3.SSS4.Px1.p1.10.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS4.Px1.p1.10.m3.2.2.2.2" xref="S3.SS3.SSS4.Px1.p1.10.m3.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS4.Px1.p1.10.m3.2b"><apply id="S3.SS3.SSS4.Px1.p1.10.m3.2.3.cmml" xref="S3.SS3.SSS4.Px1.p1.10.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS4.Px1.p1.10.m3.2.3.1.cmml" xref="S3.SS3.SSS4.Px1.p1.10.m3.2.3">subscript</csymbol><ci id="S3.SS3.SSS4.Px1.p1.10.m3.2.3.2.cmml" xref="S3.SS3.SSS4.Px1.p1.10.m3.2.3.2">𝑟</ci><list id="S3.SS3.SSS4.Px1.p1.10.m3.2.2.2.3.cmml" xref="S3.SS3.SSS4.Px1.p1.10.m3.2.2.2.4"><ci id="S3.SS3.SSS4.Px1.p1.10.m3.1.1.1.1.cmml" xref="S3.SS3.SSS4.Px1.p1.10.m3.1.1.1.1">𝑖</ci><ci id="S3.SS3.SSS4.Px1.p1.10.m3.2.2.2.2.cmml" xref="S3.SS3.SSS4.Px1.p1.10.m3.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS4.Px1.p1.10.m3.2c">r_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS4.Px1.p1.10.m3.2d">italic_r start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.5 </span>Network Training</h4>
<div class="ltx_para" id="S3.SS3.SSS5.p1">
<p class="ltx_p" id="S3.SS3.SSS5.p1.6">As we derive the relevance score of item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p1.1.m1.1"><semantics id="S3.SS3.SSS5.p1.1.m1.1a"><mi id="S3.SS3.SSS5.p1.1.m1.1.1" xref="S3.SS3.SSS5.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p1.1.m1.1b"><ci id="S3.SS3.SSS5.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS5.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p1.1.m1.1d">italic_i</annotation></semantics></math> as <math alttext="r_{i,t}(\theta)" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p1.2.m2.3"><semantics id="S3.SS3.SSS5.p1.2.m2.3a"><mrow id="S3.SS3.SSS5.p1.2.m2.3.4" xref="S3.SS3.SSS5.p1.2.m2.3.4.cmml"><msub id="S3.SS3.SSS5.p1.2.m2.3.4.2" xref="S3.SS3.SSS5.p1.2.m2.3.4.2.cmml"><mi id="S3.SS3.SSS5.p1.2.m2.3.4.2.2" xref="S3.SS3.SSS5.p1.2.m2.3.4.2.2.cmml">r</mi><mrow id="S3.SS3.SSS5.p1.2.m2.2.2.2.4" xref="S3.SS3.SSS5.p1.2.m2.2.2.2.3.cmml"><mi id="S3.SS3.SSS5.p1.2.m2.1.1.1.1" xref="S3.SS3.SSS5.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.SSS5.p1.2.m2.2.2.2.4.1" xref="S3.SS3.SSS5.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS5.p1.2.m2.2.2.2.2" xref="S3.SS3.SSS5.p1.2.m2.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.SS3.SSS5.p1.2.m2.3.4.1" xref="S3.SS3.SSS5.p1.2.m2.3.4.1.cmml">⁢</mo><mrow id="S3.SS3.SSS5.p1.2.m2.3.4.3.2" xref="S3.SS3.SSS5.p1.2.m2.3.4.cmml"><mo id="S3.SS3.SSS5.p1.2.m2.3.4.3.2.1" stretchy="false" xref="S3.SS3.SSS5.p1.2.m2.3.4.cmml">(</mo><mi id="S3.SS3.SSS5.p1.2.m2.3.3" xref="S3.SS3.SSS5.p1.2.m2.3.3.cmml">θ</mi><mo id="S3.SS3.SSS5.p1.2.m2.3.4.3.2.2" stretchy="false" xref="S3.SS3.SSS5.p1.2.m2.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p1.2.m2.3b"><apply id="S3.SS3.SSS5.p1.2.m2.3.4.cmml" xref="S3.SS3.SSS5.p1.2.m2.3.4"><times id="S3.SS3.SSS5.p1.2.m2.3.4.1.cmml" xref="S3.SS3.SSS5.p1.2.m2.3.4.1"></times><apply id="S3.SS3.SSS5.p1.2.m2.3.4.2.cmml" xref="S3.SS3.SSS5.p1.2.m2.3.4.2"><csymbol cd="ambiguous" id="S3.SS3.SSS5.p1.2.m2.3.4.2.1.cmml" xref="S3.SS3.SSS5.p1.2.m2.3.4.2">subscript</csymbol><ci id="S3.SS3.SSS5.p1.2.m2.3.4.2.2.cmml" xref="S3.SS3.SSS5.p1.2.m2.3.4.2.2">𝑟</ci><list id="S3.SS3.SSS5.p1.2.m2.2.2.2.3.cmml" xref="S3.SS3.SSS5.p1.2.m2.2.2.2.4"><ci id="S3.SS3.SSS5.p1.2.m2.1.1.1.1.cmml" xref="S3.SS3.SSS5.p1.2.m2.1.1.1.1">𝑖</ci><ci id="S3.SS3.SSS5.p1.2.m2.2.2.2.2.cmml" xref="S3.SS3.SSS5.p1.2.m2.2.2.2.2">𝑡</ci></list></apply><ci id="S3.SS3.SSS5.p1.2.m2.3.3.cmml" xref="S3.SS3.SSS5.p1.2.m2.3.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p1.2.m2.3c">r_{i,t}(\theta)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p1.2.m2.3d">italic_r start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ( italic_θ )</annotation></semantics></math> where <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p1.3.m3.1"><semantics id="S3.SS3.SSS5.p1.3.m3.1a"><mi id="S3.SS3.SSS5.p1.3.m3.1.1" xref="S3.SS3.SSS5.p1.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p1.3.m3.1b"><ci id="S3.SS3.SSS5.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS5.p1.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p1.3.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p1.3.m3.1d">italic_θ</annotation></semantics></math> stands for all parameters used to compute <math alttext="r" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p1.4.m4.1"><semantics id="S3.SS3.SSS5.p1.4.m4.1a"><mi id="S3.SS3.SSS5.p1.4.m4.1.1" xref="S3.SS3.SSS5.p1.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p1.4.m4.1b"><ci id="S3.SS3.SSS5.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS5.p1.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p1.4.m4.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p1.4.m4.1d">italic_r</annotation></semantics></math>, we treat the relevance score as logits to compute Cross-Entropy (CE) loss for entire network optimization.
While LRURec can be trained with CE loss, it is not enough to yield performant models of sizes <math alttext="\mathcal{M}=\{2,4,8,\ldots,D\}" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p1.5.m5.5"><semantics id="S3.SS3.SSS5.p1.5.m5.5a"><mrow id="S3.SS3.SSS5.p1.5.m5.5.6" xref="S3.SS3.SSS5.p1.5.m5.5.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS5.p1.5.m5.5.6.2" xref="S3.SS3.SSS5.p1.5.m5.5.6.2.cmml">ℳ</mi><mo id="S3.SS3.SSS5.p1.5.m5.5.6.1" xref="S3.SS3.SSS5.p1.5.m5.5.6.1.cmml">=</mo><mrow id="S3.SS3.SSS5.p1.5.m5.5.6.3.2" xref="S3.SS3.SSS5.p1.5.m5.5.6.3.1.cmml"><mo id="S3.SS3.SSS5.p1.5.m5.5.6.3.2.1" stretchy="false" xref="S3.SS3.SSS5.p1.5.m5.5.6.3.1.cmml">{</mo><mn id="S3.SS3.SSS5.p1.5.m5.1.1" xref="S3.SS3.SSS5.p1.5.m5.1.1.cmml">2</mn><mo id="S3.SS3.SSS5.p1.5.m5.5.6.3.2.2" xref="S3.SS3.SSS5.p1.5.m5.5.6.3.1.cmml">,</mo><mn id="S3.SS3.SSS5.p1.5.m5.2.2" xref="S3.SS3.SSS5.p1.5.m5.2.2.cmml">4</mn><mo id="S3.SS3.SSS5.p1.5.m5.5.6.3.2.3" xref="S3.SS3.SSS5.p1.5.m5.5.6.3.1.cmml">,</mo><mn id="S3.SS3.SSS5.p1.5.m5.3.3" xref="S3.SS3.SSS5.p1.5.m5.3.3.cmml">8</mn><mo id="S3.SS3.SSS5.p1.5.m5.5.6.3.2.4" xref="S3.SS3.SSS5.p1.5.m5.5.6.3.1.cmml">,</mo><mi id="S3.SS3.SSS5.p1.5.m5.4.4" mathvariant="normal" xref="S3.SS3.SSS5.p1.5.m5.4.4.cmml">…</mi><mo id="S3.SS3.SSS5.p1.5.m5.5.6.3.2.5" xref="S3.SS3.SSS5.p1.5.m5.5.6.3.1.cmml">,</mo><mi id="S3.SS3.SSS5.p1.5.m5.5.5" xref="S3.SS3.SSS5.p1.5.m5.5.5.cmml">D</mi><mo id="S3.SS3.SSS5.p1.5.m5.5.6.3.2.6" stretchy="false" xref="S3.SS3.SSS5.p1.5.m5.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p1.5.m5.5b"><apply id="S3.SS3.SSS5.p1.5.m5.5.6.cmml" xref="S3.SS3.SSS5.p1.5.m5.5.6"><eq id="S3.SS3.SSS5.p1.5.m5.5.6.1.cmml" xref="S3.SS3.SSS5.p1.5.m5.5.6.1"></eq><ci id="S3.SS3.SSS5.p1.5.m5.5.6.2.cmml" xref="S3.SS3.SSS5.p1.5.m5.5.6.2">ℳ</ci><set id="S3.SS3.SSS5.p1.5.m5.5.6.3.1.cmml" xref="S3.SS3.SSS5.p1.5.m5.5.6.3.2"><cn id="S3.SS3.SSS5.p1.5.m5.1.1.cmml" type="integer" xref="S3.SS3.SSS5.p1.5.m5.1.1">2</cn><cn id="S3.SS3.SSS5.p1.5.m5.2.2.cmml" type="integer" xref="S3.SS3.SSS5.p1.5.m5.2.2">4</cn><cn id="S3.SS3.SSS5.p1.5.m5.3.3.cmml" type="integer" xref="S3.SS3.SSS5.p1.5.m5.3.3">8</cn><ci id="S3.SS3.SSS5.p1.5.m5.4.4.cmml" xref="S3.SS3.SSS5.p1.5.m5.4.4">…</ci><ci id="S3.SS3.SSS5.p1.5.m5.5.5.cmml" xref="S3.SS3.SSS5.p1.5.m5.5.5">𝐷</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p1.5.m5.5c">\mathcal{M}=\{2,4,8,\ldots,D\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p1.5.m5.5d">caligraphic_M = { 2 , 4 , 8 , … , italic_D }</annotation></semantics></math> as traditional CE loss only explicitly optimizes the largest model of size <math alttext="D" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p1.6.m6.1"><semantics id="S3.SS3.SSS5.p1.6.m6.1a"><mi id="S3.SS3.SSS5.p1.6.m6.1.1" xref="S3.SS3.SSS5.p1.6.m6.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p1.6.m6.1b"><ci id="S3.SS3.SSS5.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS5.p1.6.m6.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p1.6.m6.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p1.6.m6.1d">italic_D</annotation></semantics></math>. We solve this issue by introducing explicit loss terms as introduced in <cite class="ltx_cite ltx_citemacro_cite">Kusupati et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib13" title="">2022</a>)</cite> to pair with our fMRLRec-style weight matrix for best performance:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{{fMRLRec}}}=\underset{\theta}{\text{min}}\frac{1}{|\mathcal%
{V}|}\sum_{i=1}^{|\mathcal{V}|}\sum_{m\in\mathcal{M}}\mathcal{L}\left(\mathbf{%
r}_{i}(\theta[:m]),\mathbf{y}_{i}\right)" class="ltx_math_unparsed" display="block" id="S3.E14.m1.2"><semantics id="S3.E14.m1.2a"><mrow id="S3.E14.m1.2b"><msub id="S3.E14.m1.2.3"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.2.3.2">ℒ</mi><mtext id="S3.E14.m1.2.3.3">fMRLRec</mtext></msub><mo id="S3.E14.m1.2.4">=</mo><munder accentunder="true" id="S3.E14.m1.2.5"><mtext id="S3.E14.m1.2.5.2">min</mtext><mo id="S3.E14.m1.2.5.1">𝜃</mo></munder><mfrac id="S3.E14.m1.1.1"><mn id="S3.E14.m1.1.1.3">1</mn><mrow id="S3.E14.m1.1.1.1.3"><mo id="S3.E14.m1.1.1.1.3.1" stretchy="false">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.1.1.1.1">𝒱</mi><mo id="S3.E14.m1.1.1.1.3.2" stretchy="false">|</mo></mrow></mfrac><munderover id="S3.E14.m1.2.6"><mo id="S3.E14.m1.2.6.2.2" movablelimits="false" rspace="0em">∑</mo><mrow id="S3.E14.m1.2.6.2.3"><mi id="S3.E14.m1.2.6.2.3.2">i</mi><mo id="S3.E14.m1.2.6.2.3.1">=</mo><mn id="S3.E14.m1.2.6.2.3.3">1</mn></mrow><mrow id="S3.E14.m1.2.2.1.3"><mo id="S3.E14.m1.2.2.1.3.1" stretchy="false">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.2.2.1.1">𝒱</mi><mo id="S3.E14.m1.2.2.1.3.2" stretchy="false">|</mo></mrow></munderover><munder id="S3.E14.m1.2.7"><mo id="S3.E14.m1.2.7.2" movablelimits="false">∑</mo><mrow id="S3.E14.m1.2.7.3"><mi id="S3.E14.m1.2.7.3.2">m</mi><mo id="S3.E14.m1.2.7.3.1">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.2.7.3.3">ℳ</mi></mrow></munder><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.2.8">ℒ</mi><mrow id="S3.E14.m1.2.9"><mo id="S3.E14.m1.2.9.1">(</mo><msub id="S3.E14.m1.2.9.2"><mi id="S3.E14.m1.2.9.2.2">𝐫</mi><mi id="S3.E14.m1.2.9.2.3">i</mi></msub><mrow id="S3.E14.m1.2.9.3"><mo id="S3.E14.m1.2.9.3.1" stretchy="false">(</mo><mi id="S3.E14.m1.2.9.3.2">θ</mi><mrow id="S3.E14.m1.2.9.3.3"><mo id="S3.E14.m1.2.9.3.3.1" stretchy="false">[</mo><mo id="S3.E14.m1.2.9.3.3.2" rspace="0.278em">:</mo><mi id="S3.E14.m1.2.9.3.3.3">m</mi><mo id="S3.E14.m1.2.9.3.3.4" stretchy="false">]</mo></mrow><mo id="S3.E14.m1.2.9.3.4" stretchy="false">)</mo></mrow><mo id="S3.E14.m1.2.9.4">,</mo><msub id="S3.E14.m1.2.9.5"><mi id="S3.E14.m1.2.9.5.2">𝐲</mi><mi id="S3.E14.m1.2.9.5.3">i</mi></msub><mo id="S3.E14.m1.2.9.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E14.m1.2c">\mathcal{L}_{\text{{fMRLRec}}}=\underset{\theta}{\text{min}}\frac{1}{|\mathcal%
{V}|}\sum_{i=1}^{|\mathcal{V}|}\sum_{m\in\mathcal{M}}\mathcal{L}\left(\mathbf{%
r}_{i}(\theta[:m]),\mathbf{y}_{i}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.2d">caligraphic_L start_POSTSUBSCRIPT fMRLRec end_POSTSUBSCRIPT = underitalic_θ start_ARG min end_ARG divide start_ARG 1 end_ARG start_ARG | caligraphic_V | end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_V | end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_m ∈ caligraphic_M end_POSTSUBSCRIPT caligraphic_L ( bold_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_θ [ : italic_m ] ) , bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS5.p1.7">where <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.SS3.SSS5.p1.7.m1.1"><semantics id="S3.SS3.SSS5.p1.7.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS5.p1.7.m1.1.1" xref="S3.SS3.SSS5.p1.7.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS5.p1.7.m1.1b"><ci id="S3.SS3.SSS5.p1.7.m1.1.1.cmml" xref="S3.SS3.SSS5.p1.7.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS5.p1.7.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS5.p1.7.m1.1d">caligraphic_L</annotation></semantics></math> is a multi-class softmax cross-entropy loss function based on ranking scores and the label item.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>fMRLRec Memory Efficiency</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.12">In this subsection, we analyze fMRLRec model-series memory efficiency by driving the number of parameters plus activations needed to train model sizes of <math alttext="\mathcal{M}=\{2,4,8,\ldots,D\}" class="ltx_Math" display="inline" id="S4.p1.1.m1.5"><semantics id="S4.p1.1.m1.5a"><mrow id="S4.p1.1.m1.5.6" xref="S4.p1.1.m1.5.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.1.m1.5.6.2" xref="S4.p1.1.m1.5.6.2.cmml">ℳ</mi><mo id="S4.p1.1.m1.5.6.1" xref="S4.p1.1.m1.5.6.1.cmml">=</mo><mrow id="S4.p1.1.m1.5.6.3.2" xref="S4.p1.1.m1.5.6.3.1.cmml"><mo id="S4.p1.1.m1.5.6.3.2.1" stretchy="false" xref="S4.p1.1.m1.5.6.3.1.cmml">{</mo><mn id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">2</mn><mo id="S4.p1.1.m1.5.6.3.2.2" xref="S4.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.p1.1.m1.2.2" xref="S4.p1.1.m1.2.2.cmml">4</mn><mo id="S4.p1.1.m1.5.6.3.2.3" xref="S4.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.p1.1.m1.3.3" xref="S4.p1.1.m1.3.3.cmml">8</mn><mo id="S4.p1.1.m1.5.6.3.2.4" xref="S4.p1.1.m1.5.6.3.1.cmml">,</mo><mi id="S4.p1.1.m1.4.4" mathvariant="normal" xref="S4.p1.1.m1.4.4.cmml">…</mi><mo id="S4.p1.1.m1.5.6.3.2.5" xref="S4.p1.1.m1.5.6.3.1.cmml">,</mo><mi id="S4.p1.1.m1.5.5" xref="S4.p1.1.m1.5.5.cmml">D</mi><mo id="S4.p1.1.m1.5.6.3.2.6" stretchy="false" xref="S4.p1.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.5b"><apply id="S4.p1.1.m1.5.6.cmml" xref="S4.p1.1.m1.5.6"><eq id="S4.p1.1.m1.5.6.1.cmml" xref="S4.p1.1.m1.5.6.1"></eq><ci id="S4.p1.1.m1.5.6.2.cmml" xref="S4.p1.1.m1.5.6.2">ℳ</ci><set id="S4.p1.1.m1.5.6.3.1.cmml" xref="S4.p1.1.m1.5.6.3.2"><cn id="S4.p1.1.m1.1.1.cmml" type="integer" xref="S4.p1.1.m1.1.1">2</cn><cn id="S4.p1.1.m1.2.2.cmml" type="integer" xref="S4.p1.1.m1.2.2">4</cn><cn id="S4.p1.1.m1.3.3.cmml" type="integer" xref="S4.p1.1.m1.3.3">8</cn><ci id="S4.p1.1.m1.4.4.cmml" xref="S4.p1.1.m1.4.4">…</ci><ci id="S4.p1.1.m1.5.5.cmml" xref="S4.p1.1.m1.5.5">𝐷</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.5c">\mathcal{M}=\{2,4,8,\ldots,D\}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.5d">caligraphic_M = { 2 , 4 , 8 , … , italic_D }</annotation></semantics></math> or <math alttext="\mathcal{M}=\{2^{j}|j=1,2,\ldots,k\}" class="ltx_Math" display="inline" id="S4.p1.2.m2.6"><semantics id="S4.p1.2.m2.6a"><mrow id="S4.p1.2.m2.6.6" xref="S4.p1.2.m2.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.2.m2.6.6.4" xref="S4.p1.2.m2.6.6.4.cmml">ℳ</mi><mo id="S4.p1.2.m2.6.6.3" xref="S4.p1.2.m2.6.6.3.cmml">=</mo><mrow id="S4.p1.2.m2.6.6.2.2" xref="S4.p1.2.m2.6.6.2.3.cmml"><mo id="S4.p1.2.m2.6.6.2.2.3" stretchy="false" xref="S4.p1.2.m2.6.6.2.3.1.cmml">{</mo><msup id="S4.p1.2.m2.5.5.1.1.1" xref="S4.p1.2.m2.5.5.1.1.1.cmml"><mn id="S4.p1.2.m2.5.5.1.1.1.2" xref="S4.p1.2.m2.5.5.1.1.1.2.cmml">2</mn><mi id="S4.p1.2.m2.5.5.1.1.1.3" xref="S4.p1.2.m2.5.5.1.1.1.3.cmml">j</mi></msup><mo id="S4.p1.2.m2.6.6.2.2.4" lspace="0em" rspace="0em" xref="S4.p1.2.m2.6.6.2.3.1.cmml">|</mo><mrow id="S4.p1.2.m2.6.6.2.2.2" xref="S4.p1.2.m2.6.6.2.2.2.cmml"><mi id="S4.p1.2.m2.6.6.2.2.2.2" xref="S4.p1.2.m2.6.6.2.2.2.2.cmml">j</mi><mo id="S4.p1.2.m2.6.6.2.2.2.1" xref="S4.p1.2.m2.6.6.2.2.2.1.cmml">=</mo><mrow id="S4.p1.2.m2.6.6.2.2.2.3.2" xref="S4.p1.2.m2.6.6.2.2.2.3.1.cmml"><mn id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">1</mn><mo id="S4.p1.2.m2.6.6.2.2.2.3.2.1" xref="S4.p1.2.m2.6.6.2.2.2.3.1.cmml">,</mo><mn id="S4.p1.2.m2.2.2" xref="S4.p1.2.m2.2.2.cmml">2</mn><mo id="S4.p1.2.m2.6.6.2.2.2.3.2.2" xref="S4.p1.2.m2.6.6.2.2.2.3.1.cmml">,</mo><mi id="S4.p1.2.m2.3.3" mathvariant="normal" xref="S4.p1.2.m2.3.3.cmml">…</mi><mo id="S4.p1.2.m2.6.6.2.2.2.3.2.3" xref="S4.p1.2.m2.6.6.2.2.2.3.1.cmml">,</mo><mi id="S4.p1.2.m2.4.4" xref="S4.p1.2.m2.4.4.cmml">k</mi></mrow></mrow><mo id="S4.p1.2.m2.6.6.2.2.5" stretchy="false" xref="S4.p1.2.m2.6.6.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.6b"><apply id="S4.p1.2.m2.6.6.cmml" xref="S4.p1.2.m2.6.6"><eq id="S4.p1.2.m2.6.6.3.cmml" xref="S4.p1.2.m2.6.6.3"></eq><ci id="S4.p1.2.m2.6.6.4.cmml" xref="S4.p1.2.m2.6.6.4">ℳ</ci><apply id="S4.p1.2.m2.6.6.2.3.cmml" xref="S4.p1.2.m2.6.6.2.2"><csymbol cd="latexml" id="S4.p1.2.m2.6.6.2.3.1.cmml" xref="S4.p1.2.m2.6.6.2.2.3">conditional-set</csymbol><apply id="S4.p1.2.m2.5.5.1.1.1.cmml" xref="S4.p1.2.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.p1.2.m2.5.5.1.1.1.1.cmml" xref="S4.p1.2.m2.5.5.1.1.1">superscript</csymbol><cn id="S4.p1.2.m2.5.5.1.1.1.2.cmml" type="integer" xref="S4.p1.2.m2.5.5.1.1.1.2">2</cn><ci id="S4.p1.2.m2.5.5.1.1.1.3.cmml" xref="S4.p1.2.m2.5.5.1.1.1.3">𝑗</ci></apply><apply id="S4.p1.2.m2.6.6.2.2.2.cmml" xref="S4.p1.2.m2.6.6.2.2.2"><eq id="S4.p1.2.m2.6.6.2.2.2.1.cmml" xref="S4.p1.2.m2.6.6.2.2.2.1"></eq><ci id="S4.p1.2.m2.6.6.2.2.2.2.cmml" xref="S4.p1.2.m2.6.6.2.2.2.2">𝑗</ci><list id="S4.p1.2.m2.6.6.2.2.2.3.1.cmml" xref="S4.p1.2.m2.6.6.2.2.2.3.2"><cn id="S4.p1.2.m2.1.1.cmml" type="integer" xref="S4.p1.2.m2.1.1">1</cn><cn id="S4.p1.2.m2.2.2.cmml" type="integer" xref="S4.p1.2.m2.2.2">2</cn><ci id="S4.p1.2.m2.3.3.cmml" xref="S4.p1.2.m2.3.3">…</ci><ci id="S4.p1.2.m2.4.4.cmml" xref="S4.p1.2.m2.4.4">𝑘</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.6c">\mathcal{M}=\{2^{j}|j=1,2,\ldots,k\}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.6d">caligraphic_M = { 2 start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT | italic_j = 1 , 2 , … , italic_k }</annotation></semantics></math> as (1) A train-once fMRLRec model-series and (2) Independent models. Define <math alttext="W^{(j)}=\{w_{1}^{(j)},w_{2}^{(j)},\cdot,w_{n}^{(j)}\}" class="ltx_Math" display="inline" id="S4.p1.3.m3.8"><semantics id="S4.p1.3.m3.8a"><mrow id="S4.p1.3.m3.8.8" xref="S4.p1.3.m3.8.8.cmml"><msup id="S4.p1.3.m3.8.8.5" xref="S4.p1.3.m3.8.8.5.cmml"><mi id="S4.p1.3.m3.8.8.5.2" xref="S4.p1.3.m3.8.8.5.2.cmml">W</mi><mrow id="S4.p1.3.m3.1.1.1.3" xref="S4.p1.3.m3.8.8.5.cmml"><mo id="S4.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S4.p1.3.m3.8.8.5.cmml">(</mo><mi id="S4.p1.3.m3.1.1.1.1" xref="S4.p1.3.m3.1.1.1.1.cmml">j</mi><mo id="S4.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S4.p1.3.m3.8.8.5.cmml">)</mo></mrow></msup><mo id="S4.p1.3.m3.8.8.4" xref="S4.p1.3.m3.8.8.4.cmml">=</mo><mrow id="S4.p1.3.m3.8.8.3.3" xref="S4.p1.3.m3.8.8.3.4.cmml"><mo id="S4.p1.3.m3.8.8.3.3.4" stretchy="false" xref="S4.p1.3.m3.8.8.3.4.cmml">{</mo><msubsup id="S4.p1.3.m3.6.6.1.1.1" xref="S4.p1.3.m3.6.6.1.1.1.cmml"><mi id="S4.p1.3.m3.6.6.1.1.1.2.2" xref="S4.p1.3.m3.6.6.1.1.1.2.2.cmml">w</mi><mn id="S4.p1.3.m3.6.6.1.1.1.2.3" xref="S4.p1.3.m3.6.6.1.1.1.2.3.cmml">1</mn><mrow id="S4.p1.3.m3.2.2.1.3" xref="S4.p1.3.m3.6.6.1.1.1.cmml"><mo id="S4.p1.3.m3.2.2.1.3.1" stretchy="false" xref="S4.p1.3.m3.6.6.1.1.1.cmml">(</mo><mi id="S4.p1.3.m3.2.2.1.1" xref="S4.p1.3.m3.2.2.1.1.cmml">j</mi><mo id="S4.p1.3.m3.2.2.1.3.2" stretchy="false" xref="S4.p1.3.m3.6.6.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.p1.3.m3.8.8.3.3.5" xref="S4.p1.3.m3.8.8.3.4.cmml">,</mo><msubsup id="S4.p1.3.m3.7.7.2.2.2" xref="S4.p1.3.m3.7.7.2.2.2.cmml"><mi id="S4.p1.3.m3.7.7.2.2.2.2.2" xref="S4.p1.3.m3.7.7.2.2.2.2.2.cmml">w</mi><mn id="S4.p1.3.m3.7.7.2.2.2.2.3" xref="S4.p1.3.m3.7.7.2.2.2.2.3.cmml">2</mn><mrow id="S4.p1.3.m3.3.3.1.3" xref="S4.p1.3.m3.7.7.2.2.2.cmml"><mo id="S4.p1.3.m3.3.3.1.3.1" stretchy="false" xref="S4.p1.3.m3.7.7.2.2.2.cmml">(</mo><mi id="S4.p1.3.m3.3.3.1.1" xref="S4.p1.3.m3.3.3.1.1.cmml">j</mi><mo id="S4.p1.3.m3.3.3.1.3.2" stretchy="false" xref="S4.p1.3.m3.7.7.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.p1.3.m3.8.8.3.3.6" rspace="0em" xref="S4.p1.3.m3.8.8.3.4.cmml">,</mo><mo id="S4.p1.3.m3.5.5" lspace="0em" rspace="0em" xref="S4.p1.3.m3.5.5.cmml">⋅</mo><mo id="S4.p1.3.m3.8.8.3.3.7" xref="S4.p1.3.m3.8.8.3.4.cmml">,</mo><msubsup id="S4.p1.3.m3.8.8.3.3.3" xref="S4.p1.3.m3.8.8.3.3.3.cmml"><mi id="S4.p1.3.m3.8.8.3.3.3.2.2" xref="S4.p1.3.m3.8.8.3.3.3.2.2.cmml">w</mi><mi id="S4.p1.3.m3.8.8.3.3.3.2.3" xref="S4.p1.3.m3.8.8.3.3.3.2.3.cmml">n</mi><mrow id="S4.p1.3.m3.4.4.1.3" xref="S4.p1.3.m3.8.8.3.3.3.cmml"><mo id="S4.p1.3.m3.4.4.1.3.1" stretchy="false" xref="S4.p1.3.m3.8.8.3.3.3.cmml">(</mo><mi id="S4.p1.3.m3.4.4.1.1" xref="S4.p1.3.m3.4.4.1.1.cmml">j</mi><mo id="S4.p1.3.m3.4.4.1.3.2" stretchy="false" xref="S4.p1.3.m3.8.8.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S4.p1.3.m3.8.8.3.3.8" stretchy="false" xref="S4.p1.3.m3.8.8.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.8b"><apply id="S4.p1.3.m3.8.8.cmml" xref="S4.p1.3.m3.8.8"><eq id="S4.p1.3.m3.8.8.4.cmml" xref="S4.p1.3.m3.8.8.4"></eq><apply id="S4.p1.3.m3.8.8.5.cmml" xref="S4.p1.3.m3.8.8.5"><csymbol cd="ambiguous" id="S4.p1.3.m3.8.8.5.1.cmml" xref="S4.p1.3.m3.8.8.5">superscript</csymbol><ci id="S4.p1.3.m3.8.8.5.2.cmml" xref="S4.p1.3.m3.8.8.5.2">𝑊</ci><ci id="S4.p1.3.m3.1.1.1.1.cmml" xref="S4.p1.3.m3.1.1.1.1">𝑗</ci></apply><set id="S4.p1.3.m3.8.8.3.4.cmml" xref="S4.p1.3.m3.8.8.3.3"><apply id="S4.p1.3.m3.6.6.1.1.1.cmml" xref="S4.p1.3.m3.6.6.1.1.1"><csymbol cd="ambiguous" id="S4.p1.3.m3.6.6.1.1.1.1.cmml" xref="S4.p1.3.m3.6.6.1.1.1">superscript</csymbol><apply id="S4.p1.3.m3.6.6.1.1.1.2.cmml" xref="S4.p1.3.m3.6.6.1.1.1"><csymbol cd="ambiguous" id="S4.p1.3.m3.6.6.1.1.1.2.1.cmml" xref="S4.p1.3.m3.6.6.1.1.1">subscript</csymbol><ci id="S4.p1.3.m3.6.6.1.1.1.2.2.cmml" xref="S4.p1.3.m3.6.6.1.1.1.2.2">𝑤</ci><cn id="S4.p1.3.m3.6.6.1.1.1.2.3.cmml" type="integer" xref="S4.p1.3.m3.6.6.1.1.1.2.3">1</cn></apply><ci id="S4.p1.3.m3.2.2.1.1.cmml" xref="S4.p1.3.m3.2.2.1.1">𝑗</ci></apply><apply id="S4.p1.3.m3.7.7.2.2.2.cmml" xref="S4.p1.3.m3.7.7.2.2.2"><csymbol cd="ambiguous" id="S4.p1.3.m3.7.7.2.2.2.1.cmml" xref="S4.p1.3.m3.7.7.2.2.2">superscript</csymbol><apply id="S4.p1.3.m3.7.7.2.2.2.2.cmml" xref="S4.p1.3.m3.7.7.2.2.2"><csymbol cd="ambiguous" id="S4.p1.3.m3.7.7.2.2.2.2.1.cmml" xref="S4.p1.3.m3.7.7.2.2.2">subscript</csymbol><ci id="S4.p1.3.m3.7.7.2.2.2.2.2.cmml" xref="S4.p1.3.m3.7.7.2.2.2.2.2">𝑤</ci><cn id="S4.p1.3.m3.7.7.2.2.2.2.3.cmml" type="integer" xref="S4.p1.3.m3.7.7.2.2.2.2.3">2</cn></apply><ci id="S4.p1.3.m3.3.3.1.1.cmml" xref="S4.p1.3.m3.3.3.1.1">𝑗</ci></apply><ci id="S4.p1.3.m3.5.5.cmml" xref="S4.p1.3.m3.5.5">⋅</ci><apply id="S4.p1.3.m3.8.8.3.3.3.cmml" xref="S4.p1.3.m3.8.8.3.3.3"><csymbol cd="ambiguous" id="S4.p1.3.m3.8.8.3.3.3.1.cmml" xref="S4.p1.3.m3.8.8.3.3.3">superscript</csymbol><apply id="S4.p1.3.m3.8.8.3.3.3.2.cmml" xref="S4.p1.3.m3.8.8.3.3.3"><csymbol cd="ambiguous" id="S4.p1.3.m3.8.8.3.3.3.2.1.cmml" xref="S4.p1.3.m3.8.8.3.3.3">subscript</csymbol><ci id="S4.p1.3.m3.8.8.3.3.3.2.2.cmml" xref="S4.p1.3.m3.8.8.3.3.3.2.2">𝑤</ci><ci id="S4.p1.3.m3.8.8.3.3.3.2.3.cmml" xref="S4.p1.3.m3.8.8.3.3.3.2.3">𝑛</ci></apply><ci id="S4.p1.3.m3.4.4.1.1.cmml" xref="S4.p1.3.m3.4.4.1.1">𝑗</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.8c">W^{(j)}=\{w_{1}^{(j)},w_{2}^{(j)},\cdot,w_{n}^{(j)}\}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.3.m3.8d">italic_W start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT = { italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT , ⋅ , italic_w start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT }</annotation></semantics></math> as the layer weights of model size <math alttext="j" class="ltx_Math" display="inline" id="S4.p1.4.m4.1"><semantics id="S4.p1.4.m4.1a"><mi id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><ci id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.p1.4.m4.1d">italic_j</annotation></semantics></math> and <math alttext="X_{i}\in\mathbb{R}^{B\times L\times D}" class="ltx_Math" display="inline" id="S4.p1.5.m5.1"><semantics id="S4.p1.5.m5.1a"><mrow id="S4.p1.5.m5.1.1" xref="S4.p1.5.m5.1.1.cmml"><msub id="S4.p1.5.m5.1.1.2" xref="S4.p1.5.m5.1.1.2.cmml"><mi id="S4.p1.5.m5.1.1.2.2" xref="S4.p1.5.m5.1.1.2.2.cmml">X</mi><mi id="S4.p1.5.m5.1.1.2.3" xref="S4.p1.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="S4.p1.5.m5.1.1.1" xref="S4.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.p1.5.m5.1.1.3" xref="S4.p1.5.m5.1.1.3.cmml"><mi id="S4.p1.5.m5.1.1.3.2" xref="S4.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.p1.5.m5.1.1.3.3" xref="S4.p1.5.m5.1.1.3.3.cmml"><mi id="S4.p1.5.m5.1.1.3.3.2" xref="S4.p1.5.m5.1.1.3.3.2.cmml">B</mi><mo id="S4.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S4.p1.5.m5.1.1.3.3.3" xref="S4.p1.5.m5.1.1.3.3.3.cmml">L</mi><mo id="S4.p1.5.m5.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S4.p1.5.m5.1.1.3.3.4" xref="S4.p1.5.m5.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.5.m5.1b"><apply id="S4.p1.5.m5.1.1.cmml" xref="S4.p1.5.m5.1.1"><in id="S4.p1.5.m5.1.1.1.cmml" xref="S4.p1.5.m5.1.1.1"></in><apply id="S4.p1.5.m5.1.1.2.cmml" xref="S4.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.p1.5.m5.1.1.2.1.cmml" xref="S4.p1.5.m5.1.1.2">subscript</csymbol><ci id="S4.p1.5.m5.1.1.2.2.cmml" xref="S4.p1.5.m5.1.1.2.2">𝑋</ci><ci id="S4.p1.5.m5.1.1.2.3.cmml" xref="S4.p1.5.m5.1.1.2.3">𝑖</ci></apply><apply id="S4.p1.5.m5.1.1.3.cmml" xref="S4.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.p1.5.m5.1.1.3.1.cmml" xref="S4.p1.5.m5.1.1.3">superscript</csymbol><ci id="S4.p1.5.m5.1.1.3.2.cmml" xref="S4.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S4.p1.5.m5.1.1.3.3.cmml" xref="S4.p1.5.m5.1.1.3.3"><times id="S4.p1.5.m5.1.1.3.3.1.cmml" xref="S4.p1.5.m5.1.1.3.3.1"></times><ci id="S4.p1.5.m5.1.1.3.3.2.cmml" xref="S4.p1.5.m5.1.1.3.3.2">𝐵</ci><ci id="S4.p1.5.m5.1.1.3.3.3.cmml" xref="S4.p1.5.m5.1.1.3.3.3">𝐿</ci><ci id="S4.p1.5.m5.1.1.3.3.4.cmml" xref="S4.p1.5.m5.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">X_{i}\in\mathbb{R}^{B\times L\times D}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.5.m5.1d">italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> as sequential input data for <math alttext="w_{i}" class="ltx_Math" display="inline" id="S4.p1.6.m6.1"><semantics id="S4.p1.6.m6.1a"><msub id="S4.p1.6.m6.1.1" xref="S4.p1.6.m6.1.1.cmml"><mi id="S4.p1.6.m6.1.1.2" xref="S4.p1.6.m6.1.1.2.cmml">w</mi><mi id="S4.p1.6.m6.1.1.3" xref="S4.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.6.m6.1b"><apply id="S4.p1.6.m6.1.1.cmml" xref="S4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p1.6.m6.1.1.1.cmml" xref="S4.p1.6.m6.1.1">subscript</csymbol><ci id="S4.p1.6.m6.1.1.2.cmml" xref="S4.p1.6.m6.1.1.2">𝑤</ci><ci id="S4.p1.6.m6.1.1.3.cmml" xref="S4.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m6.1c">w_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.6.m6.1d">italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="B" class="ltx_Math" display="inline" id="S4.p1.7.m7.1"><semantics id="S4.p1.7.m7.1a"><mi id="S4.p1.7.m7.1.1" xref="S4.p1.7.m7.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.p1.7.m7.1b"><ci id="S4.p1.7.m7.1.1.cmml" xref="S4.p1.7.m7.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.7.m7.1c">B</annotation><annotation encoding="application/x-llamapun" id="S4.p1.7.m7.1d">italic_B</annotation></semantics></math> is the batch size, <math alttext="L" class="ltx_Math" display="inline" id="S4.p1.8.m8.1"><semantics id="S4.p1.8.m8.1a"><mi id="S4.p1.8.m8.1.1" xref="S4.p1.8.m8.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.p1.8.m8.1b"><ci id="S4.p1.8.m8.1.1.cmml" xref="S4.p1.8.m8.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.8.m8.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.p1.8.m8.1d">italic_L</annotation></semantics></math> is the sequence length and <math alttext="D=2^{j}" class="ltx_Math" display="inline" id="S4.p1.9.m9.1"><semantics id="S4.p1.9.m9.1a"><mrow id="S4.p1.9.m9.1.1" xref="S4.p1.9.m9.1.1.cmml"><mi id="S4.p1.9.m9.1.1.2" xref="S4.p1.9.m9.1.1.2.cmml">D</mi><mo id="S4.p1.9.m9.1.1.1" xref="S4.p1.9.m9.1.1.1.cmml">=</mo><msup id="S4.p1.9.m9.1.1.3" xref="S4.p1.9.m9.1.1.3.cmml"><mn id="S4.p1.9.m9.1.1.3.2" xref="S4.p1.9.m9.1.1.3.2.cmml">2</mn><mi id="S4.p1.9.m9.1.1.3.3" xref="S4.p1.9.m9.1.1.3.3.cmml">j</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.9.m9.1b"><apply id="S4.p1.9.m9.1.1.cmml" xref="S4.p1.9.m9.1.1"><eq id="S4.p1.9.m9.1.1.1.cmml" xref="S4.p1.9.m9.1.1.1"></eq><ci id="S4.p1.9.m9.1.1.2.cmml" xref="S4.p1.9.m9.1.1.2">𝐷</ci><apply id="S4.p1.9.m9.1.1.3.cmml" xref="S4.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.p1.9.m9.1.1.3.1.cmml" xref="S4.p1.9.m9.1.1.3">superscript</csymbol><cn id="S4.p1.9.m9.1.1.3.2.cmml" type="integer" xref="S4.p1.9.m9.1.1.3.2">2</cn><ci id="S4.p1.9.m9.1.1.3.3.cmml" xref="S4.p1.9.m9.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.9.m9.1c">D=2^{j}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.9.m9.1d">italic_D = 2 start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> is the model size. We assume every weight has the same scaling factor <math alttext="\gamma" class="ltx_Math" display="inline" id="S4.p1.10.m10.1"><semantics id="S4.p1.10.m10.1a"><mi id="S4.p1.10.m10.1.1" xref="S4.p1.10.m10.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.p1.10.m10.1b"><ci id="S4.p1.10.m10.1.1.cmml" xref="S4.p1.10.m10.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.10.m10.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.p1.10.m10.1d">italic_γ</annotation></semantics></math> to simplify notations. Thus, <math alttext="\gamma\cdot(2^{j})^{2}" class="ltx_Math" display="inline" id="S4.p1.11.m11.1"><semantics id="S4.p1.11.m11.1a"><mrow id="S4.p1.11.m11.1.1" xref="S4.p1.11.m11.1.1.cmml"><mi id="S4.p1.11.m11.1.1.3" xref="S4.p1.11.m11.1.1.3.cmml">γ</mi><mo id="S4.p1.11.m11.1.1.2" lspace="0.222em" rspace="0.222em" xref="S4.p1.11.m11.1.1.2.cmml">⋅</mo><msup id="S4.p1.11.m11.1.1.1" xref="S4.p1.11.m11.1.1.1.cmml"><mrow id="S4.p1.11.m11.1.1.1.1.1" xref="S4.p1.11.m11.1.1.1.1.1.1.cmml"><mo id="S4.p1.11.m11.1.1.1.1.1.2" stretchy="false" xref="S4.p1.11.m11.1.1.1.1.1.1.cmml">(</mo><msup id="S4.p1.11.m11.1.1.1.1.1.1" xref="S4.p1.11.m11.1.1.1.1.1.1.cmml"><mn id="S4.p1.11.m11.1.1.1.1.1.1.2" xref="S4.p1.11.m11.1.1.1.1.1.1.2.cmml">2</mn><mi id="S4.p1.11.m11.1.1.1.1.1.1.3" xref="S4.p1.11.m11.1.1.1.1.1.1.3.cmml">j</mi></msup><mo id="S4.p1.11.m11.1.1.1.1.1.3" stretchy="false" xref="S4.p1.11.m11.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.p1.11.m11.1.1.1.3" xref="S4.p1.11.m11.1.1.1.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.11.m11.1b"><apply id="S4.p1.11.m11.1.1.cmml" xref="S4.p1.11.m11.1.1"><ci id="S4.p1.11.m11.1.1.2.cmml" xref="S4.p1.11.m11.1.1.2">⋅</ci><ci id="S4.p1.11.m11.1.1.3.cmml" xref="S4.p1.11.m11.1.1.3">𝛾</ci><apply id="S4.p1.11.m11.1.1.1.cmml" xref="S4.p1.11.m11.1.1.1"><csymbol cd="ambiguous" id="S4.p1.11.m11.1.1.1.2.cmml" xref="S4.p1.11.m11.1.1.1">superscript</csymbol><apply id="S4.p1.11.m11.1.1.1.1.1.1.cmml" xref="S4.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p1.11.m11.1.1.1.1.1.1.1.cmml" xref="S4.p1.11.m11.1.1.1.1.1">superscript</csymbol><cn id="S4.p1.11.m11.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.p1.11.m11.1.1.1.1.1.1.2">2</cn><ci id="S4.p1.11.m11.1.1.1.1.1.1.3.cmml" xref="S4.p1.11.m11.1.1.1.1.1.1.3">𝑗</ci></apply><cn id="S4.p1.11.m11.1.1.1.3.cmml" type="integer" xref="S4.p1.11.m11.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.11.m11.1c">\gamma\cdot(2^{j})^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.11.m11.1d">italic_γ ⋅ ( 2 start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\gamma\cdot 2^{j}" class="ltx_Math" display="inline" id="S4.p1.12.m12.1"><semantics id="S4.p1.12.m12.1a"><mrow id="S4.p1.12.m12.1.1" xref="S4.p1.12.m12.1.1.cmml"><mi id="S4.p1.12.m12.1.1.2" xref="S4.p1.12.m12.1.1.2.cmml">γ</mi><mo id="S4.p1.12.m12.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p1.12.m12.1.1.1.cmml">⋅</mo><msup id="S4.p1.12.m12.1.1.3" xref="S4.p1.12.m12.1.1.3.cmml"><mn id="S4.p1.12.m12.1.1.3.2" xref="S4.p1.12.m12.1.1.3.2.cmml">2</mn><mi id="S4.p1.12.m12.1.1.3.3" xref="S4.p1.12.m12.1.1.3.3.cmml">j</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.12.m12.1b"><apply id="S4.p1.12.m12.1.1.cmml" xref="S4.p1.12.m12.1.1"><ci id="S4.p1.12.m12.1.1.1.cmml" xref="S4.p1.12.m12.1.1.1">⋅</ci><ci id="S4.p1.12.m12.1.1.2.cmml" xref="S4.p1.12.m12.1.1.2">𝛾</ci><apply id="S4.p1.12.m12.1.1.3.cmml" xref="S4.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S4.p1.12.m12.1.1.3.1.cmml" xref="S4.p1.12.m12.1.1.3">superscript</csymbol><cn id="S4.p1.12.m12.1.1.3.2.cmml" type="integer" xref="S4.p1.12.m12.1.1.3.2">2</cn><ci id="S4.p1.12.m12.1.1.3.3.cmml" xref="S4.p1.12.m12.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.12.m12.1c">\gamma\cdot 2^{j}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.12.m12.1d">italic_γ ⋅ 2 start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> are number of parameters for 2d and 1d weight. Here, we only consider 2d weights saves the most parameters.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.8">Case 1: For fMRLRec-based training, number of parameters needed <math alttext="N(W)=\sum_{i=1}^{n}\gamma(\cdot(2^{k})^{2})" class="ltx_math_unparsed" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1b"><mi id="S4.p2.1.m1.1.2">N</mi><mrow id="S4.p2.1.m1.1.3"><mo id="S4.p2.1.m1.1.3.1" stretchy="false">(</mo><mi id="S4.p2.1.m1.1.1">W</mi><mo id="S4.p2.1.m1.1.3.2" stretchy="false">)</mo></mrow><mo id="S4.p2.1.m1.1.4" rspace="0.111em">=</mo><msubsup id="S4.p2.1.m1.1.5"><mo id="S4.p2.1.m1.1.5.2.2">∑</mo><mrow id="S4.p2.1.m1.1.5.2.3"><mi id="S4.p2.1.m1.1.5.2.3.2">i</mi><mo id="S4.p2.1.m1.1.5.2.3.1">=</mo><mn id="S4.p2.1.m1.1.5.2.3.3">1</mn></mrow><mi id="S4.p2.1.m1.1.5.3">n</mi></msubsup><mi id="S4.p2.1.m1.1.6">γ</mi><mrow id="S4.p2.1.m1.1.7"><mo id="S4.p2.1.m1.1.7.1" stretchy="false">(</mo><mo id="S4.p2.1.m1.1.7.2" lspace="0em" rspace="0.222em">⋅</mo><msup id="S4.p2.1.m1.1.7.3"><mrow id="S4.p2.1.m1.1.7.3.2"><mo id="S4.p2.1.m1.1.7.3.2.1" stretchy="false">(</mo><msup id="S4.p2.1.m1.1.7.3.2.2"><mn id="S4.p2.1.m1.1.7.3.2.2.2">2</mn><mi id="S4.p2.1.m1.1.7.3.2.2.3">k</mi></msup><mo id="S4.p2.1.m1.1.7.3.2.3" stretchy="false">)</mo></mrow><mn id="S4.p2.1.m1.1.7.3.3">2</mn></msup><mo id="S4.p2.1.m1.1.7.4" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">N(W)=\sum_{i=1}^{n}\gamma(\cdot(2^{k})^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">italic_N ( italic_W ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_γ ( ⋅ ( 2 start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, which is <math alttext="n\cdot\gamma\cdot 2^{(2k)}" class="ltx_Math" display="inline" id="S4.p2.2.m2.1"><semantics id="S4.p2.2.m2.1a"><mrow id="S4.p2.2.m2.1.2" xref="S4.p2.2.m2.1.2.cmml"><mi id="S4.p2.2.m2.1.2.2" xref="S4.p2.2.m2.1.2.2.cmml">n</mi><mo id="S4.p2.2.m2.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.p2.2.m2.1.2.1.cmml">⋅</mo><mi id="S4.p2.2.m2.1.2.3" xref="S4.p2.2.m2.1.2.3.cmml">γ</mi><mo id="S4.p2.2.m2.1.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.p2.2.m2.1.2.1.cmml">⋅</mo><msup id="S4.p2.2.m2.1.2.4" xref="S4.p2.2.m2.1.2.4.cmml"><mn id="S4.p2.2.m2.1.2.4.2" xref="S4.p2.2.m2.1.2.4.2.cmml">2</mn><mrow id="S4.p2.2.m2.1.1.1.1" xref="S4.p2.2.m2.1.1.1.1.1.cmml"><mo id="S4.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S4.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.p2.2.m2.1.1.1.1.1" xref="S4.p2.2.m2.1.1.1.1.1.cmml"><mn id="S4.p2.2.m2.1.1.1.1.1.2" xref="S4.p2.2.m2.1.1.1.1.1.2.cmml">2</mn><mo id="S4.p2.2.m2.1.1.1.1.1.1" xref="S4.p2.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.p2.2.m2.1.1.1.1.1.3" xref="S4.p2.2.m2.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S4.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S4.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.2.cmml" xref="S4.p2.2.m2.1.2"><ci id="S4.p2.2.m2.1.2.1.cmml" xref="S4.p2.2.m2.1.2.1">⋅</ci><ci id="S4.p2.2.m2.1.2.2.cmml" xref="S4.p2.2.m2.1.2.2">𝑛</ci><ci id="S4.p2.2.m2.1.2.3.cmml" xref="S4.p2.2.m2.1.2.3">𝛾</ci><apply id="S4.p2.2.m2.1.2.4.cmml" xref="S4.p2.2.m2.1.2.4"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.2.4.1.cmml" xref="S4.p2.2.m2.1.2.4">superscript</csymbol><cn id="S4.p2.2.m2.1.2.4.2.cmml" type="integer" xref="S4.p2.2.m2.1.2.4.2">2</cn><apply id="S4.p2.2.m2.1.1.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1.1"><times id="S4.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1.1.1.1"></times><cn id="S4.p2.2.m2.1.1.1.1.1.2.cmml" type="integer" xref="S4.p2.2.m2.1.1.1.1.1.2">2</cn><ci id="S4.p2.2.m2.1.1.1.1.1.3.cmml" xref="S4.p2.2.m2.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">n\cdot\gamma\cdot 2^{(2k)}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m2.1d">italic_n ⋅ italic_γ ⋅ 2 start_POSTSUPERSCRIPT ( 2 italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math>; The number of activation generated <math alttext="N(A)=\sum_{i=1}^{n}\gamma\cdot B\cdot L\cdot D" class="ltx_Math" display="inline" id="S4.p2.3.m3.1"><semantics id="S4.p2.3.m3.1a"><mrow id="S4.p2.3.m3.1.2" xref="S4.p2.3.m3.1.2.cmml"><mrow id="S4.p2.3.m3.1.2.2" xref="S4.p2.3.m3.1.2.2.cmml"><mi id="S4.p2.3.m3.1.2.2.2" xref="S4.p2.3.m3.1.2.2.2.cmml">N</mi><mo id="S4.p2.3.m3.1.2.2.1" xref="S4.p2.3.m3.1.2.2.1.cmml">⁢</mo><mrow id="S4.p2.3.m3.1.2.2.3.2" xref="S4.p2.3.m3.1.2.2.cmml"><mo id="S4.p2.3.m3.1.2.2.3.2.1" stretchy="false" xref="S4.p2.3.m3.1.2.2.cmml">(</mo><mi id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">A</mi><mo id="S4.p2.3.m3.1.2.2.3.2.2" stretchy="false" xref="S4.p2.3.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.p2.3.m3.1.2.1" rspace="0.111em" xref="S4.p2.3.m3.1.2.1.cmml">=</mo><mrow id="S4.p2.3.m3.1.2.3" xref="S4.p2.3.m3.1.2.3.cmml"><msubsup id="S4.p2.3.m3.1.2.3.1" xref="S4.p2.3.m3.1.2.3.1.cmml"><mo id="S4.p2.3.m3.1.2.3.1.2.2" xref="S4.p2.3.m3.1.2.3.1.2.2.cmml">∑</mo><mrow id="S4.p2.3.m3.1.2.3.1.2.3" xref="S4.p2.3.m3.1.2.3.1.2.3.cmml"><mi id="S4.p2.3.m3.1.2.3.1.2.3.2" xref="S4.p2.3.m3.1.2.3.1.2.3.2.cmml">i</mi><mo id="S4.p2.3.m3.1.2.3.1.2.3.1" xref="S4.p2.3.m3.1.2.3.1.2.3.1.cmml">=</mo><mn id="S4.p2.3.m3.1.2.3.1.2.3.3" xref="S4.p2.3.m3.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.p2.3.m3.1.2.3.1.3" xref="S4.p2.3.m3.1.2.3.1.3.cmml">n</mi></msubsup><mrow id="S4.p2.3.m3.1.2.3.2" xref="S4.p2.3.m3.1.2.3.2.cmml"><mi id="S4.p2.3.m3.1.2.3.2.2" xref="S4.p2.3.m3.1.2.3.2.2.cmml">γ</mi><mo id="S4.p2.3.m3.1.2.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.p2.3.m3.1.2.3.2.1.cmml">⋅</mo><mi id="S4.p2.3.m3.1.2.3.2.3" xref="S4.p2.3.m3.1.2.3.2.3.cmml">B</mi><mo id="S4.p2.3.m3.1.2.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.p2.3.m3.1.2.3.2.1.cmml">⋅</mo><mi id="S4.p2.3.m3.1.2.3.2.4" xref="S4.p2.3.m3.1.2.3.2.4.cmml">L</mi><mo id="S4.p2.3.m3.1.2.3.2.1b" lspace="0.222em" rspace="0.222em" xref="S4.p2.3.m3.1.2.3.2.1.cmml">⋅</mo><mi id="S4.p2.3.m3.1.2.3.2.5" xref="S4.p2.3.m3.1.2.3.2.5.cmml">D</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.2.cmml" xref="S4.p2.3.m3.1.2"><eq id="S4.p2.3.m3.1.2.1.cmml" xref="S4.p2.3.m3.1.2.1"></eq><apply id="S4.p2.3.m3.1.2.2.cmml" xref="S4.p2.3.m3.1.2.2"><times id="S4.p2.3.m3.1.2.2.1.cmml" xref="S4.p2.3.m3.1.2.2.1"></times><ci id="S4.p2.3.m3.1.2.2.2.cmml" xref="S4.p2.3.m3.1.2.2.2">𝑁</ci><ci id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">𝐴</ci></apply><apply id="S4.p2.3.m3.1.2.3.cmml" xref="S4.p2.3.m3.1.2.3"><apply id="S4.p2.3.m3.1.2.3.1.cmml" xref="S4.p2.3.m3.1.2.3.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.2.3.1.1.cmml" xref="S4.p2.3.m3.1.2.3.1">superscript</csymbol><apply id="S4.p2.3.m3.1.2.3.1.2.cmml" xref="S4.p2.3.m3.1.2.3.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.2.3.1.2.1.cmml" xref="S4.p2.3.m3.1.2.3.1">subscript</csymbol><sum id="S4.p2.3.m3.1.2.3.1.2.2.cmml" xref="S4.p2.3.m3.1.2.3.1.2.2"></sum><apply id="S4.p2.3.m3.1.2.3.1.2.3.cmml" xref="S4.p2.3.m3.1.2.3.1.2.3"><eq id="S4.p2.3.m3.1.2.3.1.2.3.1.cmml" xref="S4.p2.3.m3.1.2.3.1.2.3.1"></eq><ci id="S4.p2.3.m3.1.2.3.1.2.3.2.cmml" xref="S4.p2.3.m3.1.2.3.1.2.3.2">𝑖</ci><cn id="S4.p2.3.m3.1.2.3.1.2.3.3.cmml" type="integer" xref="S4.p2.3.m3.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S4.p2.3.m3.1.2.3.1.3.cmml" xref="S4.p2.3.m3.1.2.3.1.3">𝑛</ci></apply><apply id="S4.p2.3.m3.1.2.3.2.cmml" xref="S4.p2.3.m3.1.2.3.2"><ci id="S4.p2.3.m3.1.2.3.2.1.cmml" xref="S4.p2.3.m3.1.2.3.2.1">⋅</ci><ci id="S4.p2.3.m3.1.2.3.2.2.cmml" xref="S4.p2.3.m3.1.2.3.2.2">𝛾</ci><ci id="S4.p2.3.m3.1.2.3.2.3.cmml" xref="S4.p2.3.m3.1.2.3.2.3">𝐵</ci><ci id="S4.p2.3.m3.1.2.3.2.4.cmml" xref="S4.p2.3.m3.1.2.3.2.4">𝐿</ci><ci id="S4.p2.3.m3.1.2.3.2.5.cmml" xref="S4.p2.3.m3.1.2.3.2.5">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">N(A)=\sum_{i=1}^{n}\gamma\cdot B\cdot L\cdot D</annotation><annotation encoding="application/x-llamapun" id="S4.p2.3.m3.1d">italic_N ( italic_A ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_γ ⋅ italic_B ⋅ italic_L ⋅ italic_D</annotation></semantics></math>. Empirically, <math alttext="B\in\{32,64,128\}" class="ltx_Math" display="inline" id="S4.p2.4.m4.3"><semantics id="S4.p2.4.m4.3a"><mrow id="S4.p2.4.m4.3.4" xref="S4.p2.4.m4.3.4.cmml"><mi id="S4.p2.4.m4.3.4.2" xref="S4.p2.4.m4.3.4.2.cmml">B</mi><mo id="S4.p2.4.m4.3.4.1" xref="S4.p2.4.m4.3.4.1.cmml">∈</mo><mrow id="S4.p2.4.m4.3.4.3.2" xref="S4.p2.4.m4.3.4.3.1.cmml"><mo id="S4.p2.4.m4.3.4.3.2.1" stretchy="false" xref="S4.p2.4.m4.3.4.3.1.cmml">{</mo><mn id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml">32</mn><mo id="S4.p2.4.m4.3.4.3.2.2" xref="S4.p2.4.m4.3.4.3.1.cmml">,</mo><mn id="S4.p2.4.m4.2.2" xref="S4.p2.4.m4.2.2.cmml">64</mn><mo id="S4.p2.4.m4.3.4.3.2.3" xref="S4.p2.4.m4.3.4.3.1.cmml">,</mo><mn id="S4.p2.4.m4.3.3" xref="S4.p2.4.m4.3.3.cmml">128</mn><mo id="S4.p2.4.m4.3.4.3.2.4" stretchy="false" xref="S4.p2.4.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.3b"><apply id="S4.p2.4.m4.3.4.cmml" xref="S4.p2.4.m4.3.4"><in id="S4.p2.4.m4.3.4.1.cmml" xref="S4.p2.4.m4.3.4.1"></in><ci id="S4.p2.4.m4.3.4.2.cmml" xref="S4.p2.4.m4.3.4.2">𝐵</ci><set id="S4.p2.4.m4.3.4.3.1.cmml" xref="S4.p2.4.m4.3.4.3.2"><cn id="S4.p2.4.m4.1.1.cmml" type="integer" xref="S4.p2.4.m4.1.1">32</cn><cn id="S4.p2.4.m4.2.2.cmml" type="integer" xref="S4.p2.4.m4.2.2">64</cn><cn id="S4.p2.4.m4.3.3.cmml" type="integer" xref="S4.p2.4.m4.3.3">128</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.3c">B\in\{32,64,128\}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.4.m4.3d">italic_B ∈ { 32 , 64 , 128 }</annotation></semantics></math> and <math alttext="L=50" class="ltx_Math" display="inline" id="S4.p2.5.m5.1"><semantics id="S4.p2.5.m5.1a"><mrow id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml"><mi id="S4.p2.5.m5.1.1.2" xref="S4.p2.5.m5.1.1.2.cmml">L</mi><mo id="S4.p2.5.m5.1.1.1" xref="S4.p2.5.m5.1.1.1.cmml">=</mo><mn id="S4.p2.5.m5.1.1.3" xref="S4.p2.5.m5.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><apply id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1"><eq id="S4.p2.5.m5.1.1.1.cmml" xref="S4.p2.5.m5.1.1.1"></eq><ci id="S4.p2.5.m5.1.1.2.cmml" xref="S4.p2.5.m5.1.1.2">𝐿</ci><cn id="S4.p2.5.m5.1.1.3.cmml" type="integer" xref="S4.p2.5.m5.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">L=50</annotation><annotation encoding="application/x-llamapun" id="S4.p2.5.m5.1d">italic_L = 50</annotation></semantics></math>, thus <math alttext="B\cdot L=\delta\cdot 2^{k}" class="ltx_Math" display="inline" id="S4.p2.6.m6.1"><semantics id="S4.p2.6.m6.1a"><mrow id="S4.p2.6.m6.1.1" xref="S4.p2.6.m6.1.1.cmml"><mrow id="S4.p2.6.m6.1.1.2" xref="S4.p2.6.m6.1.1.2.cmml"><mi id="S4.p2.6.m6.1.1.2.2" xref="S4.p2.6.m6.1.1.2.2.cmml">B</mi><mo id="S4.p2.6.m6.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.p2.6.m6.1.1.2.1.cmml">⋅</mo><mi id="S4.p2.6.m6.1.1.2.3" xref="S4.p2.6.m6.1.1.2.3.cmml">L</mi></mrow><mo id="S4.p2.6.m6.1.1.1" xref="S4.p2.6.m6.1.1.1.cmml">=</mo><mrow id="S4.p2.6.m6.1.1.3" xref="S4.p2.6.m6.1.1.3.cmml"><mi id="S4.p2.6.m6.1.1.3.2" xref="S4.p2.6.m6.1.1.3.2.cmml">δ</mi><mo id="S4.p2.6.m6.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.p2.6.m6.1.1.3.1.cmml">⋅</mo><msup id="S4.p2.6.m6.1.1.3.3" xref="S4.p2.6.m6.1.1.3.3.cmml"><mn id="S4.p2.6.m6.1.1.3.3.2" xref="S4.p2.6.m6.1.1.3.3.2.cmml">2</mn><mi id="S4.p2.6.m6.1.1.3.3.3" xref="S4.p2.6.m6.1.1.3.3.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.6.m6.1b"><apply id="S4.p2.6.m6.1.1.cmml" xref="S4.p2.6.m6.1.1"><eq id="S4.p2.6.m6.1.1.1.cmml" xref="S4.p2.6.m6.1.1.1"></eq><apply id="S4.p2.6.m6.1.1.2.cmml" xref="S4.p2.6.m6.1.1.2"><ci id="S4.p2.6.m6.1.1.2.1.cmml" xref="S4.p2.6.m6.1.1.2.1">⋅</ci><ci id="S4.p2.6.m6.1.1.2.2.cmml" xref="S4.p2.6.m6.1.1.2.2">𝐵</ci><ci id="S4.p2.6.m6.1.1.2.3.cmml" xref="S4.p2.6.m6.1.1.2.3">𝐿</ci></apply><apply id="S4.p2.6.m6.1.1.3.cmml" xref="S4.p2.6.m6.1.1.3"><ci id="S4.p2.6.m6.1.1.3.1.cmml" xref="S4.p2.6.m6.1.1.3.1">⋅</ci><ci id="S4.p2.6.m6.1.1.3.2.cmml" xref="S4.p2.6.m6.1.1.3.2">𝛿</ci><apply id="S4.p2.6.m6.1.1.3.3.cmml" xref="S4.p2.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S4.p2.6.m6.1.1.3.3.1.cmml" xref="S4.p2.6.m6.1.1.3.3">superscript</csymbol><cn id="S4.p2.6.m6.1.1.3.3.2.cmml" type="integer" xref="S4.p2.6.m6.1.1.3.3.2">2</cn><ci id="S4.p2.6.m6.1.1.3.3.3.cmml" xref="S4.p2.6.m6.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m6.1c">B\cdot L=\delta\cdot 2^{k}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.6.m6.1d">italic_B ⋅ italic_L = italic_δ ⋅ 2 start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\delta&gt;1" class="ltx_Math" display="inline" id="S4.p2.7.m7.1"><semantics id="S4.p2.7.m7.1a"><mrow id="S4.p2.7.m7.1.1" xref="S4.p2.7.m7.1.1.cmml"><mi id="S4.p2.7.m7.1.1.2" xref="S4.p2.7.m7.1.1.2.cmml">δ</mi><mo id="S4.p2.7.m7.1.1.1" xref="S4.p2.7.m7.1.1.1.cmml">&gt;</mo><mn id="S4.p2.7.m7.1.1.3" xref="S4.p2.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.7.m7.1b"><apply id="S4.p2.7.m7.1.1.cmml" xref="S4.p2.7.m7.1.1"><gt id="S4.p2.7.m7.1.1.1.cmml" xref="S4.p2.7.m7.1.1.1"></gt><ci id="S4.p2.7.m7.1.1.2.cmml" xref="S4.p2.7.m7.1.1.2">𝛿</ci><cn id="S4.p2.7.m7.1.1.3.cmml" type="integer" xref="S4.p2.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m7.1c">\delta&gt;1</annotation><annotation encoding="application/x-llamapun" id="S4.p2.7.m7.1d">italic_δ &gt; 1</annotation></semantics></math>. Then, we have <math alttext="N(A)=n\cdot\gamma\cdot\delta\cdot 2^{(2k)}" class="ltx_Math" display="inline" id="S4.p2.8.m8.2"><semantics id="S4.p2.8.m8.2a"><mrow id="S4.p2.8.m8.2.3" xref="S4.p2.8.m8.2.3.cmml"><mrow id="S4.p2.8.m8.2.3.2" xref="S4.p2.8.m8.2.3.2.cmml"><mi id="S4.p2.8.m8.2.3.2.2" xref="S4.p2.8.m8.2.3.2.2.cmml">N</mi><mo id="S4.p2.8.m8.2.3.2.1" xref="S4.p2.8.m8.2.3.2.1.cmml">⁢</mo><mrow id="S4.p2.8.m8.2.3.2.3.2" xref="S4.p2.8.m8.2.3.2.cmml"><mo id="S4.p2.8.m8.2.3.2.3.2.1" stretchy="false" xref="S4.p2.8.m8.2.3.2.cmml">(</mo><mi id="S4.p2.8.m8.2.2" xref="S4.p2.8.m8.2.2.cmml">A</mi><mo id="S4.p2.8.m8.2.3.2.3.2.2" stretchy="false" xref="S4.p2.8.m8.2.3.2.cmml">)</mo></mrow></mrow><mo id="S4.p2.8.m8.2.3.1" xref="S4.p2.8.m8.2.3.1.cmml">=</mo><mrow id="S4.p2.8.m8.2.3.3" xref="S4.p2.8.m8.2.3.3.cmml"><mi id="S4.p2.8.m8.2.3.3.2" xref="S4.p2.8.m8.2.3.3.2.cmml">n</mi><mo id="S4.p2.8.m8.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.p2.8.m8.2.3.3.1.cmml">⋅</mo><mi id="S4.p2.8.m8.2.3.3.3" xref="S4.p2.8.m8.2.3.3.3.cmml">γ</mi><mo id="S4.p2.8.m8.2.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.p2.8.m8.2.3.3.1.cmml">⋅</mo><mi id="S4.p2.8.m8.2.3.3.4" xref="S4.p2.8.m8.2.3.3.4.cmml">δ</mi><mo id="S4.p2.8.m8.2.3.3.1b" lspace="0.222em" rspace="0.222em" xref="S4.p2.8.m8.2.3.3.1.cmml">⋅</mo><msup id="S4.p2.8.m8.2.3.3.5" xref="S4.p2.8.m8.2.3.3.5.cmml"><mn id="S4.p2.8.m8.2.3.3.5.2" xref="S4.p2.8.m8.2.3.3.5.2.cmml">2</mn><mrow id="S4.p2.8.m8.1.1.1.1" xref="S4.p2.8.m8.1.1.1.1.1.cmml"><mo id="S4.p2.8.m8.1.1.1.1.2" stretchy="false" xref="S4.p2.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S4.p2.8.m8.1.1.1.1.1" xref="S4.p2.8.m8.1.1.1.1.1.cmml"><mn id="S4.p2.8.m8.1.1.1.1.1.2" xref="S4.p2.8.m8.1.1.1.1.1.2.cmml">2</mn><mo id="S4.p2.8.m8.1.1.1.1.1.1" xref="S4.p2.8.m8.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.p2.8.m8.1.1.1.1.1.3" xref="S4.p2.8.m8.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S4.p2.8.m8.1.1.1.1.3" stretchy="false" xref="S4.p2.8.m8.1.1.1.1.1.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.8.m8.2b"><apply id="S4.p2.8.m8.2.3.cmml" xref="S4.p2.8.m8.2.3"><eq id="S4.p2.8.m8.2.3.1.cmml" xref="S4.p2.8.m8.2.3.1"></eq><apply id="S4.p2.8.m8.2.3.2.cmml" xref="S4.p2.8.m8.2.3.2"><times id="S4.p2.8.m8.2.3.2.1.cmml" xref="S4.p2.8.m8.2.3.2.1"></times><ci id="S4.p2.8.m8.2.3.2.2.cmml" xref="S4.p2.8.m8.2.3.2.2">𝑁</ci><ci id="S4.p2.8.m8.2.2.cmml" xref="S4.p2.8.m8.2.2">𝐴</ci></apply><apply id="S4.p2.8.m8.2.3.3.cmml" xref="S4.p2.8.m8.2.3.3"><ci id="S4.p2.8.m8.2.3.3.1.cmml" xref="S4.p2.8.m8.2.3.3.1">⋅</ci><ci id="S4.p2.8.m8.2.3.3.2.cmml" xref="S4.p2.8.m8.2.3.3.2">𝑛</ci><ci id="S4.p2.8.m8.2.3.3.3.cmml" xref="S4.p2.8.m8.2.3.3.3">𝛾</ci><ci id="S4.p2.8.m8.2.3.3.4.cmml" xref="S4.p2.8.m8.2.3.3.4">𝛿</ci><apply id="S4.p2.8.m8.2.3.3.5.cmml" xref="S4.p2.8.m8.2.3.3.5"><csymbol cd="ambiguous" id="S4.p2.8.m8.2.3.3.5.1.cmml" xref="S4.p2.8.m8.2.3.3.5">superscript</csymbol><cn id="S4.p2.8.m8.2.3.3.5.2.cmml" type="integer" xref="S4.p2.8.m8.2.3.3.5.2">2</cn><apply id="S4.p2.8.m8.1.1.1.1.1.cmml" xref="S4.p2.8.m8.1.1.1.1"><times id="S4.p2.8.m8.1.1.1.1.1.1.cmml" xref="S4.p2.8.m8.1.1.1.1.1.1"></times><cn id="S4.p2.8.m8.1.1.1.1.1.2.cmml" type="integer" xref="S4.p2.8.m8.1.1.1.1.1.2">2</cn><ci id="S4.p2.8.m8.1.1.1.1.1.3.cmml" xref="S4.p2.8.m8.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.8.m8.2c">N(A)=n\cdot\gamma\cdot\delta\cdot 2^{(2k)}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.8.m8.2d">italic_N ( italic_A ) = italic_n ⋅ italic_γ ⋅ italic_δ ⋅ 2 start_POSTSUPERSCRIPT ( 2 italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.9">Case 2: For Independent training, the number of parameters needed <math alttext="N(W)=\sum_{j=1}^{k}\sum_{i=1}^{n}\gamma\cdot(2^{j})^{2}" class="ltx_Math" display="inline" id="S4.p3.1.m1.2"><semantics id="S4.p3.1.m1.2a"><mrow id="S4.p3.1.m1.2.2" xref="S4.p3.1.m1.2.2.cmml"><mrow id="S4.p3.1.m1.2.2.3" xref="S4.p3.1.m1.2.2.3.cmml"><mi id="S4.p3.1.m1.2.2.3.2" xref="S4.p3.1.m1.2.2.3.2.cmml">N</mi><mo id="S4.p3.1.m1.2.2.3.1" xref="S4.p3.1.m1.2.2.3.1.cmml">⁢</mo><mrow id="S4.p3.1.m1.2.2.3.3.2" xref="S4.p3.1.m1.2.2.3.cmml"><mo id="S4.p3.1.m1.2.2.3.3.2.1" stretchy="false" xref="S4.p3.1.m1.2.2.3.cmml">(</mo><mi id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">W</mi><mo id="S4.p3.1.m1.2.2.3.3.2.2" stretchy="false" xref="S4.p3.1.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.p3.1.m1.2.2.2" rspace="0.111em" xref="S4.p3.1.m1.2.2.2.cmml">=</mo><mrow id="S4.p3.1.m1.2.2.1" xref="S4.p3.1.m1.2.2.1.cmml"><msubsup id="S4.p3.1.m1.2.2.1.2" xref="S4.p3.1.m1.2.2.1.2.cmml"><mo id="S4.p3.1.m1.2.2.1.2.2.2" rspace="0em" xref="S4.p3.1.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="S4.p3.1.m1.2.2.1.2.2.3" xref="S4.p3.1.m1.2.2.1.2.2.3.cmml"><mi id="S4.p3.1.m1.2.2.1.2.2.3.2" xref="S4.p3.1.m1.2.2.1.2.2.3.2.cmml">j</mi><mo id="S4.p3.1.m1.2.2.1.2.2.3.1" xref="S4.p3.1.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="S4.p3.1.m1.2.2.1.2.2.3.3" xref="S4.p3.1.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.p3.1.m1.2.2.1.2.3" xref="S4.p3.1.m1.2.2.1.2.3.cmml">k</mi></msubsup><mrow id="S4.p3.1.m1.2.2.1.1" xref="S4.p3.1.m1.2.2.1.1.cmml"><msubsup id="S4.p3.1.m1.2.2.1.1.2" xref="S4.p3.1.m1.2.2.1.1.2.cmml"><mo id="S4.p3.1.m1.2.2.1.1.2.2.2" xref="S4.p3.1.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S4.p3.1.m1.2.2.1.1.2.2.3" xref="S4.p3.1.m1.2.2.1.1.2.2.3.cmml"><mi id="S4.p3.1.m1.2.2.1.1.2.2.3.2" xref="S4.p3.1.m1.2.2.1.1.2.2.3.2.cmml">i</mi><mo id="S4.p3.1.m1.2.2.1.1.2.2.3.1" xref="S4.p3.1.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S4.p3.1.m1.2.2.1.1.2.2.3.3" xref="S4.p3.1.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.p3.1.m1.2.2.1.1.2.3" xref="S4.p3.1.m1.2.2.1.1.2.3.cmml">n</mi></msubsup><mrow id="S4.p3.1.m1.2.2.1.1.1" xref="S4.p3.1.m1.2.2.1.1.1.cmml"><mi id="S4.p3.1.m1.2.2.1.1.1.3" xref="S4.p3.1.m1.2.2.1.1.1.3.cmml">γ</mi><mo id="S4.p3.1.m1.2.2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S4.p3.1.m1.2.2.1.1.1.2.cmml">⋅</mo><msup id="S4.p3.1.m1.2.2.1.1.1.1" xref="S4.p3.1.m1.2.2.1.1.1.1.cmml"><mrow id="S4.p3.1.m1.2.2.1.1.1.1.1.1" xref="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S4.p3.1.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.p3.1.m1.2.2.1.1.1.1.1.1.1" xref="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mn id="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.2.cmml">2</mn><mi id="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.3.cmml">j</mi></msup><mo id="S4.p3.1.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.p3.1.m1.2.2.1.1.1.1.3" xref="S4.p3.1.m1.2.2.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.2b"><apply id="S4.p3.1.m1.2.2.cmml" xref="S4.p3.1.m1.2.2"><eq id="S4.p3.1.m1.2.2.2.cmml" xref="S4.p3.1.m1.2.2.2"></eq><apply id="S4.p3.1.m1.2.2.3.cmml" xref="S4.p3.1.m1.2.2.3"><times id="S4.p3.1.m1.2.2.3.1.cmml" xref="S4.p3.1.m1.2.2.3.1"></times><ci id="S4.p3.1.m1.2.2.3.2.cmml" xref="S4.p3.1.m1.2.2.3.2">𝑁</ci><ci id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">𝑊</ci></apply><apply id="S4.p3.1.m1.2.2.1.cmml" xref="S4.p3.1.m1.2.2.1"><apply id="S4.p3.1.m1.2.2.1.2.cmml" xref="S4.p3.1.m1.2.2.1.2"><csymbol cd="ambiguous" id="S4.p3.1.m1.2.2.1.2.1.cmml" xref="S4.p3.1.m1.2.2.1.2">superscript</csymbol><apply id="S4.p3.1.m1.2.2.1.2.2.cmml" xref="S4.p3.1.m1.2.2.1.2"><csymbol cd="ambiguous" id="S4.p3.1.m1.2.2.1.2.2.1.cmml" xref="S4.p3.1.m1.2.2.1.2">subscript</csymbol><sum id="S4.p3.1.m1.2.2.1.2.2.2.cmml" xref="S4.p3.1.m1.2.2.1.2.2.2"></sum><apply id="S4.p3.1.m1.2.2.1.2.2.3.cmml" xref="S4.p3.1.m1.2.2.1.2.2.3"><eq id="S4.p3.1.m1.2.2.1.2.2.3.1.cmml" xref="S4.p3.1.m1.2.2.1.2.2.3.1"></eq><ci id="S4.p3.1.m1.2.2.1.2.2.3.2.cmml" xref="S4.p3.1.m1.2.2.1.2.2.3.2">𝑗</ci><cn id="S4.p3.1.m1.2.2.1.2.2.3.3.cmml" type="integer" xref="S4.p3.1.m1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S4.p3.1.m1.2.2.1.2.3.cmml" xref="S4.p3.1.m1.2.2.1.2.3">𝑘</ci></apply><apply id="S4.p3.1.m1.2.2.1.1.cmml" xref="S4.p3.1.m1.2.2.1.1"><apply id="S4.p3.1.m1.2.2.1.1.2.cmml" xref="S4.p3.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.p3.1.m1.2.2.1.1.2.1.cmml" xref="S4.p3.1.m1.2.2.1.1.2">superscript</csymbol><apply id="S4.p3.1.m1.2.2.1.1.2.2.cmml" xref="S4.p3.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.p3.1.m1.2.2.1.1.2.2.1.cmml" xref="S4.p3.1.m1.2.2.1.1.2">subscript</csymbol><sum id="S4.p3.1.m1.2.2.1.1.2.2.2.cmml" xref="S4.p3.1.m1.2.2.1.1.2.2.2"></sum><apply id="S4.p3.1.m1.2.2.1.1.2.2.3.cmml" xref="S4.p3.1.m1.2.2.1.1.2.2.3"><eq id="S4.p3.1.m1.2.2.1.1.2.2.3.1.cmml" xref="S4.p3.1.m1.2.2.1.1.2.2.3.1"></eq><ci id="S4.p3.1.m1.2.2.1.1.2.2.3.2.cmml" xref="S4.p3.1.m1.2.2.1.1.2.2.3.2">𝑖</ci><cn id="S4.p3.1.m1.2.2.1.1.2.2.3.3.cmml" type="integer" xref="S4.p3.1.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.p3.1.m1.2.2.1.1.2.3.cmml" xref="S4.p3.1.m1.2.2.1.1.2.3">𝑛</ci></apply><apply id="S4.p3.1.m1.2.2.1.1.1.cmml" xref="S4.p3.1.m1.2.2.1.1.1"><ci id="S4.p3.1.m1.2.2.1.1.1.2.cmml" xref="S4.p3.1.m1.2.2.1.1.1.2">⋅</ci><ci id="S4.p3.1.m1.2.2.1.1.1.3.cmml" xref="S4.p3.1.m1.2.2.1.1.1.3">𝛾</ci><apply id="S4.p3.1.m1.2.2.1.1.1.1.cmml" xref="S4.p3.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.p3.1.m1.2.2.1.1.1.1.2.cmml" xref="S4.p3.1.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.p3.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.p3.1.m1.2.2.1.1.1.1.1.1">superscript</csymbol><cn id="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.2">2</cn><ci id="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.p3.1.m1.2.2.1.1.1.1.1.1.1.3">𝑗</ci></apply><cn id="S4.p3.1.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.p3.1.m1.2.2.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.2c">N(W)=\sum_{j=1}^{k}\sum_{i=1}^{n}\gamma\cdot(2^{j})^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.1.m1.2d">italic_N ( italic_W ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_γ ⋅ ( 2 start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, by summation of the geometric series, <math alttext="N(W)=n\cdot\gamma\cdot\frac{4^{k+1}-4}{3}" class="ltx_Math" display="inline" id="S4.p3.2.m2.1"><semantics id="S4.p3.2.m2.1a"><mrow id="S4.p3.2.m2.1.2" xref="S4.p3.2.m2.1.2.cmml"><mrow id="S4.p3.2.m2.1.2.2" xref="S4.p3.2.m2.1.2.2.cmml"><mi id="S4.p3.2.m2.1.2.2.2" xref="S4.p3.2.m2.1.2.2.2.cmml">N</mi><mo id="S4.p3.2.m2.1.2.2.1" xref="S4.p3.2.m2.1.2.2.1.cmml">⁢</mo><mrow id="S4.p3.2.m2.1.2.2.3.2" xref="S4.p3.2.m2.1.2.2.cmml"><mo id="S4.p3.2.m2.1.2.2.3.2.1" stretchy="false" xref="S4.p3.2.m2.1.2.2.cmml">(</mo><mi id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml">W</mi><mo id="S4.p3.2.m2.1.2.2.3.2.2" stretchy="false" xref="S4.p3.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.p3.2.m2.1.2.1" xref="S4.p3.2.m2.1.2.1.cmml">=</mo><mrow id="S4.p3.2.m2.1.2.3" xref="S4.p3.2.m2.1.2.3.cmml"><mi id="S4.p3.2.m2.1.2.3.2" xref="S4.p3.2.m2.1.2.3.2.cmml">n</mi><mo id="S4.p3.2.m2.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.p3.2.m2.1.2.3.1.cmml">⋅</mo><mi id="S4.p3.2.m2.1.2.3.3" xref="S4.p3.2.m2.1.2.3.3.cmml">γ</mi><mo id="S4.p3.2.m2.1.2.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.p3.2.m2.1.2.3.1.cmml">⋅</mo><mfrac id="S4.p3.2.m2.1.2.3.4" xref="S4.p3.2.m2.1.2.3.4.cmml"><mrow id="S4.p3.2.m2.1.2.3.4.2" xref="S4.p3.2.m2.1.2.3.4.2.cmml"><msup id="S4.p3.2.m2.1.2.3.4.2.2" xref="S4.p3.2.m2.1.2.3.4.2.2.cmml"><mn id="S4.p3.2.m2.1.2.3.4.2.2.2" xref="S4.p3.2.m2.1.2.3.4.2.2.2.cmml">4</mn><mrow id="S4.p3.2.m2.1.2.3.4.2.2.3" xref="S4.p3.2.m2.1.2.3.4.2.2.3.cmml"><mi id="S4.p3.2.m2.1.2.3.4.2.2.3.2" xref="S4.p3.2.m2.1.2.3.4.2.2.3.2.cmml">k</mi><mo id="S4.p3.2.m2.1.2.3.4.2.2.3.1" xref="S4.p3.2.m2.1.2.3.4.2.2.3.1.cmml">+</mo><mn id="S4.p3.2.m2.1.2.3.4.2.2.3.3" xref="S4.p3.2.m2.1.2.3.4.2.2.3.3.cmml">1</mn></mrow></msup><mo id="S4.p3.2.m2.1.2.3.4.2.1" xref="S4.p3.2.m2.1.2.3.4.2.1.cmml">−</mo><mn id="S4.p3.2.m2.1.2.3.4.2.3" xref="S4.p3.2.m2.1.2.3.4.2.3.cmml">4</mn></mrow><mn id="S4.p3.2.m2.1.2.3.4.3" xref="S4.p3.2.m2.1.2.3.4.3.cmml">3</mn></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.2.cmml" xref="S4.p3.2.m2.1.2"><eq id="S4.p3.2.m2.1.2.1.cmml" xref="S4.p3.2.m2.1.2.1"></eq><apply id="S4.p3.2.m2.1.2.2.cmml" xref="S4.p3.2.m2.1.2.2"><times id="S4.p3.2.m2.1.2.2.1.cmml" xref="S4.p3.2.m2.1.2.2.1"></times><ci id="S4.p3.2.m2.1.2.2.2.cmml" xref="S4.p3.2.m2.1.2.2.2">𝑁</ci><ci id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1">𝑊</ci></apply><apply id="S4.p3.2.m2.1.2.3.cmml" xref="S4.p3.2.m2.1.2.3"><ci id="S4.p3.2.m2.1.2.3.1.cmml" xref="S4.p3.2.m2.1.2.3.1">⋅</ci><ci id="S4.p3.2.m2.1.2.3.2.cmml" xref="S4.p3.2.m2.1.2.3.2">𝑛</ci><ci id="S4.p3.2.m2.1.2.3.3.cmml" xref="S4.p3.2.m2.1.2.3.3">𝛾</ci><apply id="S4.p3.2.m2.1.2.3.4.cmml" xref="S4.p3.2.m2.1.2.3.4"><divide id="S4.p3.2.m2.1.2.3.4.1.cmml" xref="S4.p3.2.m2.1.2.3.4"></divide><apply id="S4.p3.2.m2.1.2.3.4.2.cmml" xref="S4.p3.2.m2.1.2.3.4.2"><minus id="S4.p3.2.m2.1.2.3.4.2.1.cmml" xref="S4.p3.2.m2.1.2.3.4.2.1"></minus><apply id="S4.p3.2.m2.1.2.3.4.2.2.cmml" xref="S4.p3.2.m2.1.2.3.4.2.2"><csymbol cd="ambiguous" id="S4.p3.2.m2.1.2.3.4.2.2.1.cmml" xref="S4.p3.2.m2.1.2.3.4.2.2">superscript</csymbol><cn id="S4.p3.2.m2.1.2.3.4.2.2.2.cmml" type="integer" xref="S4.p3.2.m2.1.2.3.4.2.2.2">4</cn><apply id="S4.p3.2.m2.1.2.3.4.2.2.3.cmml" xref="S4.p3.2.m2.1.2.3.4.2.2.3"><plus id="S4.p3.2.m2.1.2.3.4.2.2.3.1.cmml" xref="S4.p3.2.m2.1.2.3.4.2.2.3.1"></plus><ci id="S4.p3.2.m2.1.2.3.4.2.2.3.2.cmml" xref="S4.p3.2.m2.1.2.3.4.2.2.3.2">𝑘</ci><cn id="S4.p3.2.m2.1.2.3.4.2.2.3.3.cmml" type="integer" xref="S4.p3.2.m2.1.2.3.4.2.2.3.3">1</cn></apply></apply><cn id="S4.p3.2.m2.1.2.3.4.2.3.cmml" type="integer" xref="S4.p3.2.m2.1.2.3.4.2.3">4</cn></apply><cn id="S4.p3.2.m2.1.2.3.4.3.cmml" type="integer" xref="S4.p3.2.m2.1.2.3.4.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">N(W)=n\cdot\gamma\cdot\frac{4^{k+1}-4}{3}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.2.m2.1d">italic_N ( italic_W ) = italic_n ⋅ italic_γ ⋅ divide start_ARG 4 start_POSTSUPERSCRIPT italic_k + 1 end_POSTSUPERSCRIPT - 4 end_ARG start_ARG 3 end_ARG</annotation></semantics></math>, the number of activation generated <math alttext="N(A)=\sum_{j=1}^{k}\sum_{i=1}^{n}\gamma\cdot B\cdot L\cdot D" class="ltx_Math" display="inline" id="S4.p3.3.m3.1"><semantics id="S4.p3.3.m3.1a"><mrow id="S4.p3.3.m3.1.2" xref="S4.p3.3.m3.1.2.cmml"><mrow id="S4.p3.3.m3.1.2.2" xref="S4.p3.3.m3.1.2.2.cmml"><mi id="S4.p3.3.m3.1.2.2.2" xref="S4.p3.3.m3.1.2.2.2.cmml">N</mi><mo id="S4.p3.3.m3.1.2.2.1" xref="S4.p3.3.m3.1.2.2.1.cmml">⁢</mo><mrow id="S4.p3.3.m3.1.2.2.3.2" xref="S4.p3.3.m3.1.2.2.cmml"><mo id="S4.p3.3.m3.1.2.2.3.2.1" stretchy="false" xref="S4.p3.3.m3.1.2.2.cmml">(</mo><mi id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml">A</mi><mo id="S4.p3.3.m3.1.2.2.3.2.2" stretchy="false" xref="S4.p3.3.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.p3.3.m3.1.2.1" rspace="0.111em" xref="S4.p3.3.m3.1.2.1.cmml">=</mo><mrow id="S4.p3.3.m3.1.2.3" xref="S4.p3.3.m3.1.2.3.cmml"><msubsup id="S4.p3.3.m3.1.2.3.1" xref="S4.p3.3.m3.1.2.3.1.cmml"><mo id="S4.p3.3.m3.1.2.3.1.2.2" rspace="0em" xref="S4.p3.3.m3.1.2.3.1.2.2.cmml">∑</mo><mrow id="S4.p3.3.m3.1.2.3.1.2.3" xref="S4.p3.3.m3.1.2.3.1.2.3.cmml"><mi id="S4.p3.3.m3.1.2.3.1.2.3.2" xref="S4.p3.3.m3.1.2.3.1.2.3.2.cmml">j</mi><mo id="S4.p3.3.m3.1.2.3.1.2.3.1" xref="S4.p3.3.m3.1.2.3.1.2.3.1.cmml">=</mo><mn id="S4.p3.3.m3.1.2.3.1.2.3.3" xref="S4.p3.3.m3.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.p3.3.m3.1.2.3.1.3" xref="S4.p3.3.m3.1.2.3.1.3.cmml">k</mi></msubsup><mrow id="S4.p3.3.m3.1.2.3.2" xref="S4.p3.3.m3.1.2.3.2.cmml"><msubsup id="S4.p3.3.m3.1.2.3.2.1" xref="S4.p3.3.m3.1.2.3.2.1.cmml"><mo id="S4.p3.3.m3.1.2.3.2.1.2.2" xref="S4.p3.3.m3.1.2.3.2.1.2.2.cmml">∑</mo><mrow id="S4.p3.3.m3.1.2.3.2.1.2.3" xref="S4.p3.3.m3.1.2.3.2.1.2.3.cmml"><mi id="S4.p3.3.m3.1.2.3.2.1.2.3.2" xref="S4.p3.3.m3.1.2.3.2.1.2.3.2.cmml">i</mi><mo id="S4.p3.3.m3.1.2.3.2.1.2.3.1" xref="S4.p3.3.m3.1.2.3.2.1.2.3.1.cmml">=</mo><mn id="S4.p3.3.m3.1.2.3.2.1.2.3.3" xref="S4.p3.3.m3.1.2.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.p3.3.m3.1.2.3.2.1.3" xref="S4.p3.3.m3.1.2.3.2.1.3.cmml">n</mi></msubsup><mrow id="S4.p3.3.m3.1.2.3.2.2" xref="S4.p3.3.m3.1.2.3.2.2.cmml"><mi id="S4.p3.3.m3.1.2.3.2.2.2" xref="S4.p3.3.m3.1.2.3.2.2.2.cmml">γ</mi><mo id="S4.p3.3.m3.1.2.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.p3.3.m3.1.2.3.2.2.1.cmml">⋅</mo><mi id="S4.p3.3.m3.1.2.3.2.2.3" xref="S4.p3.3.m3.1.2.3.2.2.3.cmml">B</mi><mo id="S4.p3.3.m3.1.2.3.2.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.p3.3.m3.1.2.3.2.2.1.cmml">⋅</mo><mi id="S4.p3.3.m3.1.2.3.2.2.4" xref="S4.p3.3.m3.1.2.3.2.2.4.cmml">L</mi><mo id="S4.p3.3.m3.1.2.3.2.2.1b" lspace="0.222em" rspace="0.222em" xref="S4.p3.3.m3.1.2.3.2.2.1.cmml">⋅</mo><mi id="S4.p3.3.m3.1.2.3.2.2.5" xref="S4.p3.3.m3.1.2.3.2.2.5.cmml">D</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><apply id="S4.p3.3.m3.1.2.cmml" xref="S4.p3.3.m3.1.2"><eq id="S4.p3.3.m3.1.2.1.cmml" xref="S4.p3.3.m3.1.2.1"></eq><apply id="S4.p3.3.m3.1.2.2.cmml" xref="S4.p3.3.m3.1.2.2"><times id="S4.p3.3.m3.1.2.2.1.cmml" xref="S4.p3.3.m3.1.2.2.1"></times><ci id="S4.p3.3.m3.1.2.2.2.cmml" xref="S4.p3.3.m3.1.2.2.2">𝑁</ci><ci id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1">𝐴</ci></apply><apply id="S4.p3.3.m3.1.2.3.cmml" xref="S4.p3.3.m3.1.2.3"><apply id="S4.p3.3.m3.1.2.3.1.cmml" xref="S4.p3.3.m3.1.2.3.1"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.2.3.1.1.cmml" xref="S4.p3.3.m3.1.2.3.1">superscript</csymbol><apply id="S4.p3.3.m3.1.2.3.1.2.cmml" xref="S4.p3.3.m3.1.2.3.1"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.2.3.1.2.1.cmml" xref="S4.p3.3.m3.1.2.3.1">subscript</csymbol><sum id="S4.p3.3.m3.1.2.3.1.2.2.cmml" xref="S4.p3.3.m3.1.2.3.1.2.2"></sum><apply id="S4.p3.3.m3.1.2.3.1.2.3.cmml" xref="S4.p3.3.m3.1.2.3.1.2.3"><eq id="S4.p3.3.m3.1.2.3.1.2.3.1.cmml" xref="S4.p3.3.m3.1.2.3.1.2.3.1"></eq><ci id="S4.p3.3.m3.1.2.3.1.2.3.2.cmml" xref="S4.p3.3.m3.1.2.3.1.2.3.2">𝑗</ci><cn id="S4.p3.3.m3.1.2.3.1.2.3.3.cmml" type="integer" xref="S4.p3.3.m3.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S4.p3.3.m3.1.2.3.1.3.cmml" xref="S4.p3.3.m3.1.2.3.1.3">𝑘</ci></apply><apply id="S4.p3.3.m3.1.2.3.2.cmml" xref="S4.p3.3.m3.1.2.3.2"><apply id="S4.p3.3.m3.1.2.3.2.1.cmml" xref="S4.p3.3.m3.1.2.3.2.1"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.2.3.2.1.1.cmml" xref="S4.p3.3.m3.1.2.3.2.1">superscript</csymbol><apply id="S4.p3.3.m3.1.2.3.2.1.2.cmml" xref="S4.p3.3.m3.1.2.3.2.1"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.2.3.2.1.2.1.cmml" xref="S4.p3.3.m3.1.2.3.2.1">subscript</csymbol><sum id="S4.p3.3.m3.1.2.3.2.1.2.2.cmml" xref="S4.p3.3.m3.1.2.3.2.1.2.2"></sum><apply id="S4.p3.3.m3.1.2.3.2.1.2.3.cmml" xref="S4.p3.3.m3.1.2.3.2.1.2.3"><eq id="S4.p3.3.m3.1.2.3.2.1.2.3.1.cmml" xref="S4.p3.3.m3.1.2.3.2.1.2.3.1"></eq><ci id="S4.p3.3.m3.1.2.3.2.1.2.3.2.cmml" xref="S4.p3.3.m3.1.2.3.2.1.2.3.2">𝑖</ci><cn id="S4.p3.3.m3.1.2.3.2.1.2.3.3.cmml" type="integer" xref="S4.p3.3.m3.1.2.3.2.1.2.3.3">1</cn></apply></apply><ci id="S4.p3.3.m3.1.2.3.2.1.3.cmml" xref="S4.p3.3.m3.1.2.3.2.1.3">𝑛</ci></apply><apply id="S4.p3.3.m3.1.2.3.2.2.cmml" xref="S4.p3.3.m3.1.2.3.2.2"><ci id="S4.p3.3.m3.1.2.3.2.2.1.cmml" xref="S4.p3.3.m3.1.2.3.2.2.1">⋅</ci><ci id="S4.p3.3.m3.1.2.3.2.2.2.cmml" xref="S4.p3.3.m3.1.2.3.2.2.2">𝛾</ci><ci id="S4.p3.3.m3.1.2.3.2.2.3.cmml" xref="S4.p3.3.m3.1.2.3.2.2.3">𝐵</ci><ci id="S4.p3.3.m3.1.2.3.2.2.4.cmml" xref="S4.p3.3.m3.1.2.3.2.2.4">𝐿</ci><ci id="S4.p3.3.m3.1.2.3.2.2.5.cmml" xref="S4.p3.3.m3.1.2.3.2.2.5">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">N(A)=\sum_{j=1}^{k}\sum_{i=1}^{n}\gamma\cdot B\cdot L\cdot D</annotation><annotation encoding="application/x-llamapun" id="S4.p3.3.m3.1d">italic_N ( italic_A ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_γ ⋅ italic_B ⋅ italic_L ⋅ italic_D</annotation></semantics></math>. Empirically, <math alttext="B\in\{32,64,128\}" class="ltx_Math" display="inline" id="S4.p3.4.m4.3"><semantics id="S4.p3.4.m4.3a"><mrow id="S4.p3.4.m4.3.4" xref="S4.p3.4.m4.3.4.cmml"><mi id="S4.p3.4.m4.3.4.2" xref="S4.p3.4.m4.3.4.2.cmml">B</mi><mo id="S4.p3.4.m4.3.4.1" xref="S4.p3.4.m4.3.4.1.cmml">∈</mo><mrow id="S4.p3.4.m4.3.4.3.2" xref="S4.p3.4.m4.3.4.3.1.cmml"><mo id="S4.p3.4.m4.3.4.3.2.1" stretchy="false" xref="S4.p3.4.m4.3.4.3.1.cmml">{</mo><mn id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml">32</mn><mo id="S4.p3.4.m4.3.4.3.2.2" xref="S4.p3.4.m4.3.4.3.1.cmml">,</mo><mn id="S4.p3.4.m4.2.2" xref="S4.p3.4.m4.2.2.cmml">64</mn><mo id="S4.p3.4.m4.3.4.3.2.3" xref="S4.p3.4.m4.3.4.3.1.cmml">,</mo><mn id="S4.p3.4.m4.3.3" xref="S4.p3.4.m4.3.3.cmml">128</mn><mo id="S4.p3.4.m4.3.4.3.2.4" stretchy="false" xref="S4.p3.4.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.3b"><apply id="S4.p3.4.m4.3.4.cmml" xref="S4.p3.4.m4.3.4"><in id="S4.p3.4.m4.3.4.1.cmml" xref="S4.p3.4.m4.3.4.1"></in><ci id="S4.p3.4.m4.3.4.2.cmml" xref="S4.p3.4.m4.3.4.2">𝐵</ci><set id="S4.p3.4.m4.3.4.3.1.cmml" xref="S4.p3.4.m4.3.4.3.2"><cn id="S4.p3.4.m4.1.1.cmml" type="integer" xref="S4.p3.4.m4.1.1">32</cn><cn id="S4.p3.4.m4.2.2.cmml" type="integer" xref="S4.p3.4.m4.2.2">64</cn><cn id="S4.p3.4.m4.3.3.cmml" type="integer" xref="S4.p3.4.m4.3.3">128</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.3c">B\in\{32,64,128\}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.4.m4.3d">italic_B ∈ { 32 , 64 , 128 }</annotation></semantics></math> and <math alttext="L=50" class="ltx_Math" display="inline" id="S4.p3.5.m5.1"><semantics id="S4.p3.5.m5.1a"><mrow id="S4.p3.5.m5.1.1" xref="S4.p3.5.m5.1.1.cmml"><mi id="S4.p3.5.m5.1.1.2" xref="S4.p3.5.m5.1.1.2.cmml">L</mi><mo id="S4.p3.5.m5.1.1.1" xref="S4.p3.5.m5.1.1.1.cmml">=</mo><mn id="S4.p3.5.m5.1.1.3" xref="S4.p3.5.m5.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.5.m5.1b"><apply id="S4.p3.5.m5.1.1.cmml" xref="S4.p3.5.m5.1.1"><eq id="S4.p3.5.m5.1.1.1.cmml" xref="S4.p3.5.m5.1.1.1"></eq><ci id="S4.p3.5.m5.1.1.2.cmml" xref="S4.p3.5.m5.1.1.2">𝐿</ci><cn id="S4.p3.5.m5.1.1.3.cmml" type="integer" xref="S4.p3.5.m5.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.5.m5.1c">L=50</annotation><annotation encoding="application/x-llamapun" id="S4.p3.5.m5.1d">italic_L = 50</annotation></semantics></math>, thus <math alttext="B\cdot L=\delta\cdot 2^{j}" class="ltx_Math" display="inline" id="S4.p3.6.m6.1"><semantics id="S4.p3.6.m6.1a"><mrow id="S4.p3.6.m6.1.1" xref="S4.p3.6.m6.1.1.cmml"><mrow id="S4.p3.6.m6.1.1.2" xref="S4.p3.6.m6.1.1.2.cmml"><mi id="S4.p3.6.m6.1.1.2.2" xref="S4.p3.6.m6.1.1.2.2.cmml">B</mi><mo id="S4.p3.6.m6.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.p3.6.m6.1.1.2.1.cmml">⋅</mo><mi id="S4.p3.6.m6.1.1.2.3" xref="S4.p3.6.m6.1.1.2.3.cmml">L</mi></mrow><mo id="S4.p3.6.m6.1.1.1" xref="S4.p3.6.m6.1.1.1.cmml">=</mo><mrow id="S4.p3.6.m6.1.1.3" xref="S4.p3.6.m6.1.1.3.cmml"><mi id="S4.p3.6.m6.1.1.3.2" xref="S4.p3.6.m6.1.1.3.2.cmml">δ</mi><mo id="S4.p3.6.m6.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.p3.6.m6.1.1.3.1.cmml">⋅</mo><msup id="S4.p3.6.m6.1.1.3.3" xref="S4.p3.6.m6.1.1.3.3.cmml"><mn id="S4.p3.6.m6.1.1.3.3.2" xref="S4.p3.6.m6.1.1.3.3.2.cmml">2</mn><mi id="S4.p3.6.m6.1.1.3.3.3" xref="S4.p3.6.m6.1.1.3.3.3.cmml">j</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.6.m6.1b"><apply id="S4.p3.6.m6.1.1.cmml" xref="S4.p3.6.m6.1.1"><eq id="S4.p3.6.m6.1.1.1.cmml" xref="S4.p3.6.m6.1.1.1"></eq><apply id="S4.p3.6.m6.1.1.2.cmml" xref="S4.p3.6.m6.1.1.2"><ci id="S4.p3.6.m6.1.1.2.1.cmml" xref="S4.p3.6.m6.1.1.2.1">⋅</ci><ci id="S4.p3.6.m6.1.1.2.2.cmml" xref="S4.p3.6.m6.1.1.2.2">𝐵</ci><ci id="S4.p3.6.m6.1.1.2.3.cmml" xref="S4.p3.6.m6.1.1.2.3">𝐿</ci></apply><apply id="S4.p3.6.m6.1.1.3.cmml" xref="S4.p3.6.m6.1.1.3"><ci id="S4.p3.6.m6.1.1.3.1.cmml" xref="S4.p3.6.m6.1.1.3.1">⋅</ci><ci id="S4.p3.6.m6.1.1.3.2.cmml" xref="S4.p3.6.m6.1.1.3.2">𝛿</ci><apply id="S4.p3.6.m6.1.1.3.3.cmml" xref="S4.p3.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S4.p3.6.m6.1.1.3.3.1.cmml" xref="S4.p3.6.m6.1.1.3.3">superscript</csymbol><cn id="S4.p3.6.m6.1.1.3.3.2.cmml" type="integer" xref="S4.p3.6.m6.1.1.3.3.2">2</cn><ci id="S4.p3.6.m6.1.1.3.3.3.cmml" xref="S4.p3.6.m6.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.6.m6.1c">B\cdot L=\delta\cdot 2^{j}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.6.m6.1d">italic_B ⋅ italic_L = italic_δ ⋅ 2 start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\delta&gt;1" class="ltx_Math" display="inline" id="S4.p3.7.m7.1"><semantics id="S4.p3.7.m7.1a"><mrow id="S4.p3.7.m7.1.1" xref="S4.p3.7.m7.1.1.cmml"><mi id="S4.p3.7.m7.1.1.2" xref="S4.p3.7.m7.1.1.2.cmml">δ</mi><mo id="S4.p3.7.m7.1.1.1" xref="S4.p3.7.m7.1.1.1.cmml">&gt;</mo><mn id="S4.p3.7.m7.1.1.3" xref="S4.p3.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.7.m7.1b"><apply id="S4.p3.7.m7.1.1.cmml" xref="S4.p3.7.m7.1.1"><gt id="S4.p3.7.m7.1.1.1.cmml" xref="S4.p3.7.m7.1.1.1"></gt><ci id="S4.p3.7.m7.1.1.2.cmml" xref="S4.p3.7.m7.1.1.2">𝛿</ci><cn id="S4.p3.7.m7.1.1.3.cmml" type="integer" xref="S4.p3.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.7.m7.1c">\delta&gt;1</annotation><annotation encoding="application/x-llamapun" id="S4.p3.7.m7.1d">italic_δ &gt; 1</annotation></semantics></math>. Then, we have <math alttext="N(A)=\sum_{j=1}^{k}n\cdot\gamma\cdot\delta\cdot 2^{(2j)}" class="ltx_Math" display="inline" id="S4.p3.8.m8.2"><semantics id="S4.p3.8.m8.2a"><mrow id="S4.p3.8.m8.2.3" xref="S4.p3.8.m8.2.3.cmml"><mrow id="S4.p3.8.m8.2.3.2" xref="S4.p3.8.m8.2.3.2.cmml"><mi id="S4.p3.8.m8.2.3.2.2" xref="S4.p3.8.m8.2.3.2.2.cmml">N</mi><mo id="S4.p3.8.m8.2.3.2.1" xref="S4.p3.8.m8.2.3.2.1.cmml">⁢</mo><mrow id="S4.p3.8.m8.2.3.2.3.2" xref="S4.p3.8.m8.2.3.2.cmml"><mo id="S4.p3.8.m8.2.3.2.3.2.1" stretchy="false" xref="S4.p3.8.m8.2.3.2.cmml">(</mo><mi id="S4.p3.8.m8.2.2" xref="S4.p3.8.m8.2.2.cmml">A</mi><mo id="S4.p3.8.m8.2.3.2.3.2.2" stretchy="false" xref="S4.p3.8.m8.2.3.2.cmml">)</mo></mrow></mrow><mo id="S4.p3.8.m8.2.3.1" rspace="0.111em" xref="S4.p3.8.m8.2.3.1.cmml">=</mo><mrow id="S4.p3.8.m8.2.3.3" xref="S4.p3.8.m8.2.3.3.cmml"><msubsup id="S4.p3.8.m8.2.3.3.1" xref="S4.p3.8.m8.2.3.3.1.cmml"><mo id="S4.p3.8.m8.2.3.3.1.2.2" xref="S4.p3.8.m8.2.3.3.1.2.2.cmml">∑</mo><mrow id="S4.p3.8.m8.2.3.3.1.2.3" xref="S4.p3.8.m8.2.3.3.1.2.3.cmml"><mi id="S4.p3.8.m8.2.3.3.1.2.3.2" xref="S4.p3.8.m8.2.3.3.1.2.3.2.cmml">j</mi><mo id="S4.p3.8.m8.2.3.3.1.2.3.1" xref="S4.p3.8.m8.2.3.3.1.2.3.1.cmml">=</mo><mn id="S4.p3.8.m8.2.3.3.1.2.3.3" xref="S4.p3.8.m8.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.p3.8.m8.2.3.3.1.3" xref="S4.p3.8.m8.2.3.3.1.3.cmml">k</mi></msubsup><mrow id="S4.p3.8.m8.2.3.3.2" xref="S4.p3.8.m8.2.3.3.2.cmml"><mi id="S4.p3.8.m8.2.3.3.2.2" xref="S4.p3.8.m8.2.3.3.2.2.cmml">n</mi><mo id="S4.p3.8.m8.2.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.p3.8.m8.2.3.3.2.1.cmml">⋅</mo><mi id="S4.p3.8.m8.2.3.3.2.3" xref="S4.p3.8.m8.2.3.3.2.3.cmml">γ</mi><mo id="S4.p3.8.m8.2.3.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S4.p3.8.m8.2.3.3.2.1.cmml">⋅</mo><mi id="S4.p3.8.m8.2.3.3.2.4" xref="S4.p3.8.m8.2.3.3.2.4.cmml">δ</mi><mo id="S4.p3.8.m8.2.3.3.2.1b" lspace="0.222em" rspace="0.222em" xref="S4.p3.8.m8.2.3.3.2.1.cmml">⋅</mo><msup id="S4.p3.8.m8.2.3.3.2.5" xref="S4.p3.8.m8.2.3.3.2.5.cmml"><mn id="S4.p3.8.m8.2.3.3.2.5.2" xref="S4.p3.8.m8.2.3.3.2.5.2.cmml">2</mn><mrow id="S4.p3.8.m8.1.1.1.1" xref="S4.p3.8.m8.1.1.1.1.1.cmml"><mo id="S4.p3.8.m8.1.1.1.1.2" stretchy="false" xref="S4.p3.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S4.p3.8.m8.1.1.1.1.1" xref="S4.p3.8.m8.1.1.1.1.1.cmml"><mn id="S4.p3.8.m8.1.1.1.1.1.2" xref="S4.p3.8.m8.1.1.1.1.1.2.cmml">2</mn><mo id="S4.p3.8.m8.1.1.1.1.1.1" xref="S4.p3.8.m8.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.p3.8.m8.1.1.1.1.1.3" xref="S4.p3.8.m8.1.1.1.1.1.3.cmml">j</mi></mrow><mo id="S4.p3.8.m8.1.1.1.1.3" stretchy="false" xref="S4.p3.8.m8.1.1.1.1.1.cmml">)</mo></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.8.m8.2b"><apply id="S4.p3.8.m8.2.3.cmml" xref="S4.p3.8.m8.2.3"><eq id="S4.p3.8.m8.2.3.1.cmml" xref="S4.p3.8.m8.2.3.1"></eq><apply id="S4.p3.8.m8.2.3.2.cmml" xref="S4.p3.8.m8.2.3.2"><times id="S4.p3.8.m8.2.3.2.1.cmml" xref="S4.p3.8.m8.2.3.2.1"></times><ci id="S4.p3.8.m8.2.3.2.2.cmml" xref="S4.p3.8.m8.2.3.2.2">𝑁</ci><ci id="S4.p3.8.m8.2.2.cmml" xref="S4.p3.8.m8.2.2">𝐴</ci></apply><apply id="S4.p3.8.m8.2.3.3.cmml" xref="S4.p3.8.m8.2.3.3"><apply id="S4.p3.8.m8.2.3.3.1.cmml" xref="S4.p3.8.m8.2.3.3.1"><csymbol cd="ambiguous" id="S4.p3.8.m8.2.3.3.1.1.cmml" xref="S4.p3.8.m8.2.3.3.1">superscript</csymbol><apply id="S4.p3.8.m8.2.3.3.1.2.cmml" xref="S4.p3.8.m8.2.3.3.1"><csymbol cd="ambiguous" id="S4.p3.8.m8.2.3.3.1.2.1.cmml" xref="S4.p3.8.m8.2.3.3.1">subscript</csymbol><sum id="S4.p3.8.m8.2.3.3.1.2.2.cmml" xref="S4.p3.8.m8.2.3.3.1.2.2"></sum><apply id="S4.p3.8.m8.2.3.3.1.2.3.cmml" xref="S4.p3.8.m8.2.3.3.1.2.3"><eq id="S4.p3.8.m8.2.3.3.1.2.3.1.cmml" xref="S4.p3.8.m8.2.3.3.1.2.3.1"></eq><ci id="S4.p3.8.m8.2.3.3.1.2.3.2.cmml" xref="S4.p3.8.m8.2.3.3.1.2.3.2">𝑗</ci><cn id="S4.p3.8.m8.2.3.3.1.2.3.3.cmml" type="integer" xref="S4.p3.8.m8.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.p3.8.m8.2.3.3.1.3.cmml" xref="S4.p3.8.m8.2.3.3.1.3">𝑘</ci></apply><apply id="S4.p3.8.m8.2.3.3.2.cmml" xref="S4.p3.8.m8.2.3.3.2"><ci id="S4.p3.8.m8.2.3.3.2.1.cmml" xref="S4.p3.8.m8.2.3.3.2.1">⋅</ci><ci id="S4.p3.8.m8.2.3.3.2.2.cmml" xref="S4.p3.8.m8.2.3.3.2.2">𝑛</ci><ci id="S4.p3.8.m8.2.3.3.2.3.cmml" xref="S4.p3.8.m8.2.3.3.2.3">𝛾</ci><ci id="S4.p3.8.m8.2.3.3.2.4.cmml" xref="S4.p3.8.m8.2.3.3.2.4">𝛿</ci><apply id="S4.p3.8.m8.2.3.3.2.5.cmml" xref="S4.p3.8.m8.2.3.3.2.5"><csymbol cd="ambiguous" id="S4.p3.8.m8.2.3.3.2.5.1.cmml" xref="S4.p3.8.m8.2.3.3.2.5">superscript</csymbol><cn id="S4.p3.8.m8.2.3.3.2.5.2.cmml" type="integer" xref="S4.p3.8.m8.2.3.3.2.5.2">2</cn><apply id="S4.p3.8.m8.1.1.1.1.1.cmml" xref="S4.p3.8.m8.1.1.1.1"><times id="S4.p3.8.m8.1.1.1.1.1.1.cmml" xref="S4.p3.8.m8.1.1.1.1.1.1"></times><cn id="S4.p3.8.m8.1.1.1.1.1.2.cmml" type="integer" xref="S4.p3.8.m8.1.1.1.1.1.2">2</cn><ci id="S4.p3.8.m8.1.1.1.1.1.3.cmml" xref="S4.p3.8.m8.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.8.m8.2c">N(A)=\sum_{j=1}^{k}n\cdot\gamma\cdot\delta\cdot 2^{(2j)}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.8.m8.2d">italic_N ( italic_A ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_n ⋅ italic_γ ⋅ italic_δ ⋅ 2 start_POSTSUPERSCRIPT ( 2 italic_j ) end_POSTSUPERSCRIPT</annotation></semantics></math>, which is equivalent to <math alttext="N(A)=n\cdot\gamma\cdot\delta\cdot\frac{4^{k+1}-4}{3}" class="ltx_Math" display="inline" id="S4.p3.9.m9.1"><semantics id="S4.p3.9.m9.1a"><mrow id="S4.p3.9.m9.1.2" xref="S4.p3.9.m9.1.2.cmml"><mrow id="S4.p3.9.m9.1.2.2" xref="S4.p3.9.m9.1.2.2.cmml"><mi id="S4.p3.9.m9.1.2.2.2" xref="S4.p3.9.m9.1.2.2.2.cmml">N</mi><mo id="S4.p3.9.m9.1.2.2.1" xref="S4.p3.9.m9.1.2.2.1.cmml">⁢</mo><mrow id="S4.p3.9.m9.1.2.2.3.2" xref="S4.p3.9.m9.1.2.2.cmml"><mo id="S4.p3.9.m9.1.2.2.3.2.1" stretchy="false" xref="S4.p3.9.m9.1.2.2.cmml">(</mo><mi id="S4.p3.9.m9.1.1" xref="S4.p3.9.m9.1.1.cmml">A</mi><mo id="S4.p3.9.m9.1.2.2.3.2.2" stretchy="false" xref="S4.p3.9.m9.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.p3.9.m9.1.2.1" xref="S4.p3.9.m9.1.2.1.cmml">=</mo><mrow id="S4.p3.9.m9.1.2.3" xref="S4.p3.9.m9.1.2.3.cmml"><mi id="S4.p3.9.m9.1.2.3.2" xref="S4.p3.9.m9.1.2.3.2.cmml">n</mi><mo id="S4.p3.9.m9.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.p3.9.m9.1.2.3.1.cmml">⋅</mo><mi id="S4.p3.9.m9.1.2.3.3" xref="S4.p3.9.m9.1.2.3.3.cmml">γ</mi><mo id="S4.p3.9.m9.1.2.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.p3.9.m9.1.2.3.1.cmml">⋅</mo><mi id="S4.p3.9.m9.1.2.3.4" xref="S4.p3.9.m9.1.2.3.4.cmml">δ</mi><mo id="S4.p3.9.m9.1.2.3.1b" lspace="0.222em" rspace="0.222em" xref="S4.p3.9.m9.1.2.3.1.cmml">⋅</mo><mfrac id="S4.p3.9.m9.1.2.3.5" xref="S4.p3.9.m9.1.2.3.5.cmml"><mrow id="S4.p3.9.m9.1.2.3.5.2" xref="S4.p3.9.m9.1.2.3.5.2.cmml"><msup id="S4.p3.9.m9.1.2.3.5.2.2" xref="S4.p3.9.m9.1.2.3.5.2.2.cmml"><mn id="S4.p3.9.m9.1.2.3.5.2.2.2" xref="S4.p3.9.m9.1.2.3.5.2.2.2.cmml">4</mn><mrow id="S4.p3.9.m9.1.2.3.5.2.2.3" xref="S4.p3.9.m9.1.2.3.5.2.2.3.cmml"><mi id="S4.p3.9.m9.1.2.3.5.2.2.3.2" xref="S4.p3.9.m9.1.2.3.5.2.2.3.2.cmml">k</mi><mo id="S4.p3.9.m9.1.2.3.5.2.2.3.1" xref="S4.p3.9.m9.1.2.3.5.2.2.3.1.cmml">+</mo><mn id="S4.p3.9.m9.1.2.3.5.2.2.3.3" xref="S4.p3.9.m9.1.2.3.5.2.2.3.3.cmml">1</mn></mrow></msup><mo id="S4.p3.9.m9.1.2.3.5.2.1" xref="S4.p3.9.m9.1.2.3.5.2.1.cmml">−</mo><mn id="S4.p3.9.m9.1.2.3.5.2.3" xref="S4.p3.9.m9.1.2.3.5.2.3.cmml">4</mn></mrow><mn id="S4.p3.9.m9.1.2.3.5.3" xref="S4.p3.9.m9.1.2.3.5.3.cmml">3</mn></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.9.m9.1b"><apply id="S4.p3.9.m9.1.2.cmml" xref="S4.p3.9.m9.1.2"><eq id="S4.p3.9.m9.1.2.1.cmml" xref="S4.p3.9.m9.1.2.1"></eq><apply id="S4.p3.9.m9.1.2.2.cmml" xref="S4.p3.9.m9.1.2.2"><times id="S4.p3.9.m9.1.2.2.1.cmml" xref="S4.p3.9.m9.1.2.2.1"></times><ci id="S4.p3.9.m9.1.2.2.2.cmml" xref="S4.p3.9.m9.1.2.2.2">𝑁</ci><ci id="S4.p3.9.m9.1.1.cmml" xref="S4.p3.9.m9.1.1">𝐴</ci></apply><apply id="S4.p3.9.m9.1.2.3.cmml" xref="S4.p3.9.m9.1.2.3"><ci id="S4.p3.9.m9.1.2.3.1.cmml" xref="S4.p3.9.m9.1.2.3.1">⋅</ci><ci id="S4.p3.9.m9.1.2.3.2.cmml" xref="S4.p3.9.m9.1.2.3.2">𝑛</ci><ci id="S4.p3.9.m9.1.2.3.3.cmml" xref="S4.p3.9.m9.1.2.3.3">𝛾</ci><ci id="S4.p3.9.m9.1.2.3.4.cmml" xref="S4.p3.9.m9.1.2.3.4">𝛿</ci><apply id="S4.p3.9.m9.1.2.3.5.cmml" xref="S4.p3.9.m9.1.2.3.5"><divide id="S4.p3.9.m9.1.2.3.5.1.cmml" xref="S4.p3.9.m9.1.2.3.5"></divide><apply id="S4.p3.9.m9.1.2.3.5.2.cmml" xref="S4.p3.9.m9.1.2.3.5.2"><minus id="S4.p3.9.m9.1.2.3.5.2.1.cmml" xref="S4.p3.9.m9.1.2.3.5.2.1"></minus><apply id="S4.p3.9.m9.1.2.3.5.2.2.cmml" xref="S4.p3.9.m9.1.2.3.5.2.2"><csymbol cd="ambiguous" id="S4.p3.9.m9.1.2.3.5.2.2.1.cmml" xref="S4.p3.9.m9.1.2.3.5.2.2">superscript</csymbol><cn id="S4.p3.9.m9.1.2.3.5.2.2.2.cmml" type="integer" xref="S4.p3.9.m9.1.2.3.5.2.2.2">4</cn><apply id="S4.p3.9.m9.1.2.3.5.2.2.3.cmml" xref="S4.p3.9.m9.1.2.3.5.2.2.3"><plus id="S4.p3.9.m9.1.2.3.5.2.2.3.1.cmml" xref="S4.p3.9.m9.1.2.3.5.2.2.3.1"></plus><ci id="S4.p3.9.m9.1.2.3.5.2.2.3.2.cmml" xref="S4.p3.9.m9.1.2.3.5.2.2.3.2">𝑘</ci><cn id="S4.p3.9.m9.1.2.3.5.2.2.3.3.cmml" type="integer" xref="S4.p3.9.m9.1.2.3.5.2.2.3.3">1</cn></apply></apply><cn id="S4.p3.9.m9.1.2.3.5.2.3.cmml" type="integer" xref="S4.p3.9.m9.1.2.3.5.2.3">4</cn></apply><cn id="S4.p3.9.m9.1.2.3.5.3.cmml" type="integer" xref="S4.p3.9.m9.1.2.3.5.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.9.m9.1c">N(A)=n\cdot\gamma\cdot\delta\cdot\frac{4^{k+1}-4}{3}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.9.m9.1d">italic_N ( italic_A ) = italic_n ⋅ italic_γ ⋅ italic_δ ⋅ divide start_ARG 4 start_POSTSUPERSCRIPT italic_k + 1 end_POSTSUPERSCRIPT - 4 end_ARG start_ARG 3 end_ARG</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.9">In summary, the ratio of parameters and activations between fMRLRec-based training and Independent training is <math alttext="R=(n\cdot\gamma\cdot\frac{4^{k+1}-4}{3})/(n\cdot\gamma\cdot 2^{(2k)})" class="ltx_Math" display="inline" id="S4.p4.1.m1.3"><semantics id="S4.p4.1.m1.3a"><mrow id="S4.p4.1.m1.3.3" xref="S4.p4.1.m1.3.3.cmml"><mi id="S4.p4.1.m1.3.3.4" xref="S4.p4.1.m1.3.3.4.cmml">R</mi><mo id="S4.p4.1.m1.3.3.3" xref="S4.p4.1.m1.3.3.3.cmml">=</mo><mrow id="S4.p4.1.m1.3.3.2" xref="S4.p4.1.m1.3.3.2.cmml"><mrow id="S4.p4.1.m1.2.2.1.1.1" xref="S4.p4.1.m1.2.2.1.1.1.1.cmml"><mo id="S4.p4.1.m1.2.2.1.1.1.2" stretchy="false" xref="S4.p4.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.p4.1.m1.2.2.1.1.1.1" xref="S4.p4.1.m1.2.2.1.1.1.1.cmml"><mi id="S4.p4.1.m1.2.2.1.1.1.1.2" xref="S4.p4.1.m1.2.2.1.1.1.1.2.cmml">n</mi><mo id="S4.p4.1.m1.2.2.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p4.1.m1.2.2.1.1.1.1.1.cmml">⋅</mo><mi id="S4.p4.1.m1.2.2.1.1.1.1.3" xref="S4.p4.1.m1.2.2.1.1.1.1.3.cmml">γ</mi><mo id="S4.p4.1.m1.2.2.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S4.p4.1.m1.2.2.1.1.1.1.1.cmml">⋅</mo><mfrac id="S4.p4.1.m1.2.2.1.1.1.1.4" xref="S4.p4.1.m1.2.2.1.1.1.1.4.cmml"><mrow id="S4.p4.1.m1.2.2.1.1.1.1.4.2" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.cmml"><msup id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.cmml"><mn id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.2" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.2.cmml">4</mn><mrow id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.cmml"><mi id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.2" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.2.cmml">k</mi><mo id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.1" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.1.cmml">+</mo><mn id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.3" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.3.cmml">1</mn></mrow></msup><mo id="S4.p4.1.m1.2.2.1.1.1.1.4.2.1" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.1.cmml">−</mo><mn id="S4.p4.1.m1.2.2.1.1.1.1.4.2.3" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.3.cmml">4</mn></mrow><mn id="S4.p4.1.m1.2.2.1.1.1.1.4.3" xref="S4.p4.1.m1.2.2.1.1.1.1.4.3.cmml">3</mn></mfrac></mrow><mo id="S4.p4.1.m1.2.2.1.1.1.3" stretchy="false" xref="S4.p4.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S4.p4.1.m1.3.3.2.3" xref="S4.p4.1.m1.3.3.2.3.cmml">/</mo><mrow id="S4.p4.1.m1.3.3.2.2.1" xref="S4.p4.1.m1.3.3.2.2.1.1.cmml"><mo id="S4.p4.1.m1.3.3.2.2.1.2" stretchy="false" xref="S4.p4.1.m1.3.3.2.2.1.1.cmml">(</mo><mrow id="S4.p4.1.m1.3.3.2.2.1.1" xref="S4.p4.1.m1.3.3.2.2.1.1.cmml"><mi id="S4.p4.1.m1.3.3.2.2.1.1.2" xref="S4.p4.1.m1.3.3.2.2.1.1.2.cmml">n</mi><mo id="S4.p4.1.m1.3.3.2.2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p4.1.m1.3.3.2.2.1.1.1.cmml">⋅</mo><mi id="S4.p4.1.m1.3.3.2.2.1.1.3" xref="S4.p4.1.m1.3.3.2.2.1.1.3.cmml">γ</mi><mo id="S4.p4.1.m1.3.3.2.2.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S4.p4.1.m1.3.3.2.2.1.1.1.cmml">⋅</mo><msup id="S4.p4.1.m1.3.3.2.2.1.1.4" xref="S4.p4.1.m1.3.3.2.2.1.1.4.cmml"><mn id="S4.p4.1.m1.3.3.2.2.1.1.4.2" xref="S4.p4.1.m1.3.3.2.2.1.1.4.2.cmml">2</mn><mrow id="S4.p4.1.m1.1.1.1.1" xref="S4.p4.1.m1.1.1.1.1.1.cmml"><mo id="S4.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S4.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p4.1.m1.1.1.1.1.1" xref="S4.p4.1.m1.1.1.1.1.1.cmml"><mn id="S4.p4.1.m1.1.1.1.1.1.2" xref="S4.p4.1.m1.1.1.1.1.1.2.cmml">2</mn><mo id="S4.p4.1.m1.1.1.1.1.1.1" xref="S4.p4.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.p4.1.m1.1.1.1.1.1.3" xref="S4.p4.1.m1.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S4.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S4.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></msup></mrow><mo id="S4.p4.1.m1.3.3.2.2.1.3" stretchy="false" xref="S4.p4.1.m1.3.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.3b"><apply id="S4.p4.1.m1.3.3.cmml" xref="S4.p4.1.m1.3.3"><eq id="S4.p4.1.m1.3.3.3.cmml" xref="S4.p4.1.m1.3.3.3"></eq><ci id="S4.p4.1.m1.3.3.4.cmml" xref="S4.p4.1.m1.3.3.4">𝑅</ci><apply id="S4.p4.1.m1.3.3.2.cmml" xref="S4.p4.1.m1.3.3.2"><divide id="S4.p4.1.m1.3.3.2.3.cmml" xref="S4.p4.1.m1.3.3.2.3"></divide><apply id="S4.p4.1.m1.2.2.1.1.1.1.cmml" xref="S4.p4.1.m1.2.2.1.1.1"><ci id="S4.p4.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.p4.1.m1.2.2.1.1.1.1.1">⋅</ci><ci id="S4.p4.1.m1.2.2.1.1.1.1.2.cmml" xref="S4.p4.1.m1.2.2.1.1.1.1.2">𝑛</ci><ci id="S4.p4.1.m1.2.2.1.1.1.1.3.cmml" xref="S4.p4.1.m1.2.2.1.1.1.1.3">𝛾</ci><apply id="S4.p4.1.m1.2.2.1.1.1.1.4.cmml" xref="S4.p4.1.m1.2.2.1.1.1.1.4"><divide id="S4.p4.1.m1.2.2.1.1.1.1.4.1.cmml" xref="S4.p4.1.m1.2.2.1.1.1.1.4"></divide><apply id="S4.p4.1.m1.2.2.1.1.1.1.4.2.cmml" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2"><minus id="S4.p4.1.m1.2.2.1.1.1.1.4.2.1.cmml" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.1"></minus><apply id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.cmml" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.1.cmml" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2">superscript</csymbol><cn id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.2.cmml" type="integer" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.2">4</cn><apply id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.cmml" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3"><plus id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.1.cmml" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.1"></plus><ci id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.2.cmml" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.2">𝑘</ci><cn id="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.3.cmml" type="integer" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.2.3.3">1</cn></apply></apply><cn id="S4.p4.1.m1.2.2.1.1.1.1.4.2.3.cmml" type="integer" xref="S4.p4.1.m1.2.2.1.1.1.1.4.2.3">4</cn></apply><cn id="S4.p4.1.m1.2.2.1.1.1.1.4.3.cmml" type="integer" xref="S4.p4.1.m1.2.2.1.1.1.1.4.3">3</cn></apply></apply><apply id="S4.p4.1.m1.3.3.2.2.1.1.cmml" xref="S4.p4.1.m1.3.3.2.2.1"><ci id="S4.p4.1.m1.3.3.2.2.1.1.1.cmml" xref="S4.p4.1.m1.3.3.2.2.1.1.1">⋅</ci><ci id="S4.p4.1.m1.3.3.2.2.1.1.2.cmml" xref="S4.p4.1.m1.3.3.2.2.1.1.2">𝑛</ci><ci id="S4.p4.1.m1.3.3.2.2.1.1.3.cmml" xref="S4.p4.1.m1.3.3.2.2.1.1.3">𝛾</ci><apply id="S4.p4.1.m1.3.3.2.2.1.1.4.cmml" xref="S4.p4.1.m1.3.3.2.2.1.1.4"><csymbol cd="ambiguous" id="S4.p4.1.m1.3.3.2.2.1.1.4.1.cmml" xref="S4.p4.1.m1.3.3.2.2.1.1.4">superscript</csymbol><cn id="S4.p4.1.m1.3.3.2.2.1.1.4.2.cmml" type="integer" xref="S4.p4.1.m1.3.3.2.2.1.1.4.2">2</cn><apply id="S4.p4.1.m1.1.1.1.1.1.cmml" xref="S4.p4.1.m1.1.1.1.1"><times id="S4.p4.1.m1.1.1.1.1.1.1.cmml" xref="S4.p4.1.m1.1.1.1.1.1.1"></times><cn id="S4.p4.1.m1.1.1.1.1.1.2.cmml" type="integer" xref="S4.p4.1.m1.1.1.1.1.1.2">2</cn><ci id="S4.p4.1.m1.1.1.1.1.1.3.cmml" xref="S4.p4.1.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.3c">R=(n\cdot\gamma\cdot\frac{4^{k+1}-4}{3})/(n\cdot\gamma\cdot 2^{(2k)})</annotation><annotation encoding="application/x-llamapun" id="S4.p4.1.m1.3d">italic_R = ( italic_n ⋅ italic_γ ⋅ divide start_ARG 4 start_POSTSUPERSCRIPT italic_k + 1 end_POSTSUPERSCRIPT - 4 end_ARG start_ARG 3 end_ARG ) / ( italic_n ⋅ italic_γ ⋅ 2 start_POSTSUPERSCRIPT ( 2 italic_k ) end_POSTSUPERSCRIPT )</annotation></semantics></math> or <math alttext="(n\cdot\gamma\cdot\delta\cdot\frac{4^{k+1}-4}{3})/(n\cdot\gamma\cdot\delta%
\cdot 2^{(2k)})\approx 1.33" class="ltx_Math" display="inline" id="S4.p4.2.m2.3"><semantics id="S4.p4.2.m2.3a"><mrow id="S4.p4.2.m2.3.3" xref="S4.p4.2.m2.3.3.cmml"><mrow id="S4.p4.2.m2.3.3.2" xref="S4.p4.2.m2.3.3.2.cmml"><mrow id="S4.p4.2.m2.2.2.1.1.1" xref="S4.p4.2.m2.2.2.1.1.1.1.cmml"><mo id="S4.p4.2.m2.2.2.1.1.1.2" stretchy="false" xref="S4.p4.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.p4.2.m2.2.2.1.1.1.1" xref="S4.p4.2.m2.2.2.1.1.1.1.cmml"><mi id="S4.p4.2.m2.2.2.1.1.1.1.2" xref="S4.p4.2.m2.2.2.1.1.1.1.2.cmml">n</mi><mo id="S4.p4.2.m2.2.2.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p4.2.m2.2.2.1.1.1.1.1.cmml">⋅</mo><mi id="S4.p4.2.m2.2.2.1.1.1.1.3" xref="S4.p4.2.m2.2.2.1.1.1.1.3.cmml">γ</mi><mo id="S4.p4.2.m2.2.2.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S4.p4.2.m2.2.2.1.1.1.1.1.cmml">⋅</mo><mi id="S4.p4.2.m2.2.2.1.1.1.1.4" xref="S4.p4.2.m2.2.2.1.1.1.1.4.cmml">δ</mi><mo id="S4.p4.2.m2.2.2.1.1.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S4.p4.2.m2.2.2.1.1.1.1.1.cmml">⋅</mo><mfrac id="S4.p4.2.m2.2.2.1.1.1.1.5" xref="S4.p4.2.m2.2.2.1.1.1.1.5.cmml"><mrow id="S4.p4.2.m2.2.2.1.1.1.1.5.2" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.cmml"><msup id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.cmml"><mn id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.2" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.2.cmml">4</mn><mrow id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.cmml"><mi id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.2" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.2.cmml">k</mi><mo id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.1" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.1.cmml">+</mo><mn id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.3" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.3.cmml">1</mn></mrow></msup><mo id="S4.p4.2.m2.2.2.1.1.1.1.5.2.1" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.1.cmml">−</mo><mn id="S4.p4.2.m2.2.2.1.1.1.1.5.2.3" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.3.cmml">4</mn></mrow><mn id="S4.p4.2.m2.2.2.1.1.1.1.5.3" xref="S4.p4.2.m2.2.2.1.1.1.1.5.3.cmml">3</mn></mfrac></mrow><mo id="S4.p4.2.m2.2.2.1.1.1.3" stretchy="false" xref="S4.p4.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S4.p4.2.m2.3.3.2.3" xref="S4.p4.2.m2.3.3.2.3.cmml">/</mo><mrow id="S4.p4.2.m2.3.3.2.2.1" xref="S4.p4.2.m2.3.3.2.2.1.1.cmml"><mo id="S4.p4.2.m2.3.3.2.2.1.2" stretchy="false" xref="S4.p4.2.m2.3.3.2.2.1.1.cmml">(</mo><mrow id="S4.p4.2.m2.3.3.2.2.1.1" xref="S4.p4.2.m2.3.3.2.2.1.1.cmml"><mi id="S4.p4.2.m2.3.3.2.2.1.1.2" xref="S4.p4.2.m2.3.3.2.2.1.1.2.cmml">n</mi><mo id="S4.p4.2.m2.3.3.2.2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p4.2.m2.3.3.2.2.1.1.1.cmml">⋅</mo><mi id="S4.p4.2.m2.3.3.2.2.1.1.3" xref="S4.p4.2.m2.3.3.2.2.1.1.3.cmml">γ</mi><mo id="S4.p4.2.m2.3.3.2.2.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S4.p4.2.m2.3.3.2.2.1.1.1.cmml">⋅</mo><mi id="S4.p4.2.m2.3.3.2.2.1.1.4" xref="S4.p4.2.m2.3.3.2.2.1.1.4.cmml">δ</mi><mo id="S4.p4.2.m2.3.3.2.2.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S4.p4.2.m2.3.3.2.2.1.1.1.cmml">⋅</mo><msup id="S4.p4.2.m2.3.3.2.2.1.1.5" xref="S4.p4.2.m2.3.3.2.2.1.1.5.cmml"><mn id="S4.p4.2.m2.3.3.2.2.1.1.5.2" xref="S4.p4.2.m2.3.3.2.2.1.1.5.2.cmml">2</mn><mrow id="S4.p4.2.m2.1.1.1.1" xref="S4.p4.2.m2.1.1.1.1.1.cmml"><mo id="S4.p4.2.m2.1.1.1.1.2" stretchy="false" xref="S4.p4.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.p4.2.m2.1.1.1.1.1" xref="S4.p4.2.m2.1.1.1.1.1.cmml"><mn id="S4.p4.2.m2.1.1.1.1.1.2" xref="S4.p4.2.m2.1.1.1.1.1.2.cmml">2</mn><mo id="S4.p4.2.m2.1.1.1.1.1.1" xref="S4.p4.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.p4.2.m2.1.1.1.1.1.3" xref="S4.p4.2.m2.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S4.p4.2.m2.1.1.1.1.3" stretchy="false" xref="S4.p4.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msup></mrow><mo id="S4.p4.2.m2.3.3.2.2.1.3" stretchy="false" xref="S4.p4.2.m2.3.3.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p4.2.m2.3.3.3" xref="S4.p4.2.m2.3.3.3.cmml">≈</mo><mn id="S4.p4.2.m2.3.3.4" xref="S4.p4.2.m2.3.3.4.cmml">1.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.3b"><apply id="S4.p4.2.m2.3.3.cmml" xref="S4.p4.2.m2.3.3"><approx id="S4.p4.2.m2.3.3.3.cmml" xref="S4.p4.2.m2.3.3.3"></approx><apply id="S4.p4.2.m2.3.3.2.cmml" xref="S4.p4.2.m2.3.3.2"><divide id="S4.p4.2.m2.3.3.2.3.cmml" xref="S4.p4.2.m2.3.3.2.3"></divide><apply id="S4.p4.2.m2.2.2.1.1.1.1.cmml" xref="S4.p4.2.m2.2.2.1.1.1"><ci id="S4.p4.2.m2.2.2.1.1.1.1.1.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.1">⋅</ci><ci id="S4.p4.2.m2.2.2.1.1.1.1.2.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.2">𝑛</ci><ci id="S4.p4.2.m2.2.2.1.1.1.1.3.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.3">𝛾</ci><ci id="S4.p4.2.m2.2.2.1.1.1.1.4.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.4">𝛿</ci><apply id="S4.p4.2.m2.2.2.1.1.1.1.5.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.5"><divide id="S4.p4.2.m2.2.2.1.1.1.1.5.1.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.5"></divide><apply id="S4.p4.2.m2.2.2.1.1.1.1.5.2.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2"><minus id="S4.p4.2.m2.2.2.1.1.1.1.5.2.1.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.1"></minus><apply id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2"><csymbol cd="ambiguous" id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.1.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2">superscript</csymbol><cn id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.2.cmml" type="integer" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.2">4</cn><apply id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3"><plus id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.1.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.1"></plus><ci id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.2.cmml" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.2">𝑘</ci><cn id="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.3.cmml" type="integer" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.2.3.3">1</cn></apply></apply><cn id="S4.p4.2.m2.2.2.1.1.1.1.5.2.3.cmml" type="integer" xref="S4.p4.2.m2.2.2.1.1.1.1.5.2.3">4</cn></apply><cn id="S4.p4.2.m2.2.2.1.1.1.1.5.3.cmml" type="integer" xref="S4.p4.2.m2.2.2.1.1.1.1.5.3">3</cn></apply></apply><apply id="S4.p4.2.m2.3.3.2.2.1.1.cmml" xref="S4.p4.2.m2.3.3.2.2.1"><ci id="S4.p4.2.m2.3.3.2.2.1.1.1.cmml" xref="S4.p4.2.m2.3.3.2.2.1.1.1">⋅</ci><ci id="S4.p4.2.m2.3.3.2.2.1.1.2.cmml" xref="S4.p4.2.m2.3.3.2.2.1.1.2">𝑛</ci><ci id="S4.p4.2.m2.3.3.2.2.1.1.3.cmml" xref="S4.p4.2.m2.3.3.2.2.1.1.3">𝛾</ci><ci id="S4.p4.2.m2.3.3.2.2.1.1.4.cmml" xref="S4.p4.2.m2.3.3.2.2.1.1.4">𝛿</ci><apply id="S4.p4.2.m2.3.3.2.2.1.1.5.cmml" xref="S4.p4.2.m2.3.3.2.2.1.1.5"><csymbol cd="ambiguous" id="S4.p4.2.m2.3.3.2.2.1.1.5.1.cmml" xref="S4.p4.2.m2.3.3.2.2.1.1.5">superscript</csymbol><cn id="S4.p4.2.m2.3.3.2.2.1.1.5.2.cmml" type="integer" xref="S4.p4.2.m2.3.3.2.2.1.1.5.2">2</cn><apply id="S4.p4.2.m2.1.1.1.1.1.cmml" xref="S4.p4.2.m2.1.1.1.1"><times id="S4.p4.2.m2.1.1.1.1.1.1.cmml" xref="S4.p4.2.m2.1.1.1.1.1.1"></times><cn id="S4.p4.2.m2.1.1.1.1.1.2.cmml" type="integer" xref="S4.p4.2.m2.1.1.1.1.1.2">2</cn><ci id="S4.p4.2.m2.1.1.1.1.1.3.cmml" xref="S4.p4.2.m2.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply><cn id="S4.p4.2.m2.3.3.4.cmml" type="float" xref="S4.p4.2.m2.3.3.4">1.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.3c">(n\cdot\gamma\cdot\delta\cdot\frac{4^{k+1}-4}{3})/(n\cdot\gamma\cdot\delta%
\cdot 2^{(2k)})\approx 1.33</annotation><annotation encoding="application/x-llamapun" id="S4.p4.2.m2.3d">( italic_n ⋅ italic_γ ⋅ italic_δ ⋅ divide start_ARG 4 start_POSTSUPERSCRIPT italic_k + 1 end_POSTSUPERSCRIPT - 4 end_ARG start_ARG 3 end_ARG ) / ( italic_n ⋅ italic_γ ⋅ italic_δ ⋅ 2 start_POSTSUPERSCRIPT ( 2 italic_k ) end_POSTSUPERSCRIPT ) ≈ 1.33</annotation></semantics></math>. This indicates a parameter saving rate <math alttext="R_{s}" class="ltx_Math" display="inline" id="S4.p4.3.m3.1"><semantics id="S4.p4.3.m3.1a"><msub id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml"><mi id="S4.p4.3.m3.1.1.2" xref="S4.p4.3.m3.1.1.2.cmml">R</mi><mi id="S4.p4.3.m3.1.1.3" xref="S4.p4.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><apply id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p4.3.m3.1.1.1.cmml" xref="S4.p4.3.m3.1.1">subscript</csymbol><ci id="S4.p4.3.m3.1.1.2.cmml" xref="S4.p4.3.m3.1.1.2">𝑅</ci><ci id="S4.p4.3.m3.1.1.3.cmml" xref="S4.p4.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">R_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.p4.3.m3.1d">italic_R start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="\approx 0.33" class="ltx_Math" display="inline" id="S4.p4.4.m4.1"><semantics id="S4.p4.4.m4.1a"><mrow id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml"><mi id="S4.p4.4.m4.1.1.2" xref="S4.p4.4.m4.1.1.2.cmml"></mi><mo id="S4.p4.4.m4.1.1.1" xref="S4.p4.4.m4.1.1.1.cmml">≈</mo><mn id="S4.p4.4.m4.1.1.3" xref="S4.p4.4.m4.1.1.3.cmml">0.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><apply id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1"><approx id="S4.p4.4.m4.1.1.1.cmml" xref="S4.p4.4.m4.1.1.1"></approx><csymbol cd="latexml" id="S4.p4.4.m4.1.1.2.cmml" xref="S4.p4.4.m4.1.1.2">absent</csymbol><cn id="S4.p4.4.m4.1.1.3.cmml" type="float" xref="S4.p4.4.m4.1.1.3">0.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">\approx 0.33</annotation><annotation encoding="application/x-llamapun" id="S4.p4.4.m4.1d">≈ 0.33</annotation></semantics></math> against the fMRLRec model. Empirically, for a common setting <math alttext="n=4" class="ltx_Math" display="inline" id="S4.p4.5.m5.1"><semantics id="S4.p4.5.m5.1a"><mrow id="S4.p4.5.m5.1.1" xref="S4.p4.5.m5.1.1.cmml"><mi id="S4.p4.5.m5.1.1.2" xref="S4.p4.5.m5.1.1.2.cmml">n</mi><mo id="S4.p4.5.m5.1.1.1" xref="S4.p4.5.m5.1.1.1.cmml">=</mo><mn id="S4.p4.5.m5.1.1.3" xref="S4.p4.5.m5.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.5.m5.1b"><apply id="S4.p4.5.m5.1.1.cmml" xref="S4.p4.5.m5.1.1"><eq id="S4.p4.5.m5.1.1.1.cmml" xref="S4.p4.5.m5.1.1.1"></eq><ci id="S4.p4.5.m5.1.1.2.cmml" xref="S4.p4.5.m5.1.1.2">𝑛</ci><cn id="S4.p4.5.m5.1.1.3.cmml" type="integer" xref="S4.p4.5.m5.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m5.1c">n=4</annotation><annotation encoding="application/x-llamapun" id="S4.p4.5.m5.1d">italic_n = 4</annotation></semantics></math> linear layers with scaling factor <math alttext="\gamma=2" class="ltx_Math" display="inline" id="S4.p4.6.m6.1"><semantics id="S4.p4.6.m6.1a"><mrow id="S4.p4.6.m6.1.1" xref="S4.p4.6.m6.1.1.cmml"><mi id="S4.p4.6.m6.1.1.2" xref="S4.p4.6.m6.1.1.2.cmml">γ</mi><mo id="S4.p4.6.m6.1.1.1" xref="S4.p4.6.m6.1.1.1.cmml">=</mo><mn id="S4.p4.6.m6.1.1.3" xref="S4.p4.6.m6.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.6.m6.1b"><apply id="S4.p4.6.m6.1.1.cmml" xref="S4.p4.6.m6.1.1"><eq id="S4.p4.6.m6.1.1.1.cmml" xref="S4.p4.6.m6.1.1.1"></eq><ci id="S4.p4.6.m6.1.1.2.cmml" xref="S4.p4.6.m6.1.1.2">𝛾</ci><cn id="S4.p4.6.m6.1.1.3.cmml" type="integer" xref="S4.p4.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.m6.1c">\gamma=2</annotation><annotation encoding="application/x-llamapun" id="S4.p4.6.m6.1d">italic_γ = 2</annotation></semantics></math> and <math alttext="D=512" class="ltx_Math" display="inline" id="S4.p4.7.m7.1"><semantics id="S4.p4.7.m7.1a"><mrow id="S4.p4.7.m7.1.1" xref="S4.p4.7.m7.1.1.cmml"><mi id="S4.p4.7.m7.1.1.2" xref="S4.p4.7.m7.1.1.2.cmml">D</mi><mo id="S4.p4.7.m7.1.1.1" xref="S4.p4.7.m7.1.1.1.cmml">=</mo><mn id="S4.p4.7.m7.1.1.3" xref="S4.p4.7.m7.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.7.m7.1b"><apply id="S4.p4.7.m7.1.1.cmml" xref="S4.p4.7.m7.1.1"><eq id="S4.p4.7.m7.1.1.1.cmml" xref="S4.p4.7.m7.1.1.1"></eq><ci id="S4.p4.7.m7.1.1.2.cmml" xref="S4.p4.7.m7.1.1.2">𝐷</ci><cn id="S4.p4.7.m7.1.1.3.cmml" type="integer" xref="S4.p4.7.m7.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.7.m7.1c">D=512</annotation><annotation encoding="application/x-llamapun" id="S4.p4.7.m7.1d">italic_D = 512</annotation></semantics></math>, the weights saved are approximately <math alttext="4(n)\times 0.33(R)\times 512(D)\times 1024(2D)\approx 700K" class="ltx_Math" display="inline" id="S4.p4.8.m8.4"><semantics id="S4.p4.8.m8.4a"><mrow id="S4.p4.8.m8.4.4" xref="S4.p4.8.m8.4.4.cmml"><mrow id="S4.p4.8.m8.4.4.1" xref="S4.p4.8.m8.4.4.1.cmml"><mrow id="S4.p4.8.m8.4.4.1.3" xref="S4.p4.8.m8.4.4.1.3.cmml"><mrow id="S4.p4.8.m8.4.4.1.3.2" xref="S4.p4.8.m8.4.4.1.3.2.cmml"><mrow id="S4.p4.8.m8.4.4.1.3.2.2" xref="S4.p4.8.m8.4.4.1.3.2.2.cmml"><mrow id="S4.p4.8.m8.4.4.1.3.2.2.2" xref="S4.p4.8.m8.4.4.1.3.2.2.2.cmml"><mrow id="S4.p4.8.m8.4.4.1.3.2.2.2.2" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.cmml"><mrow id="S4.p4.8.m8.4.4.1.3.2.2.2.2.2" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.cmml"><mn id="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.2" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.2.cmml">4</mn><mo id="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.1" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.3.2" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.cmml"><mo id="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.3.2.1" stretchy="false" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.cmml">(</mo><mi id="S4.p4.8.m8.1.1" xref="S4.p4.8.m8.1.1.cmml">n</mi><mo id="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.3.2.2" rspace="0.055em" stretchy="false" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.p4.8.m8.4.4.1.3.2.2.2.2.1" rspace="0.222em" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.1.cmml">×</mo><mn id="S4.p4.8.m8.4.4.1.3.2.2.2.2.3" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.3.cmml">0.33</mn></mrow><mo id="S4.p4.8.m8.4.4.1.3.2.2.2.1" xref="S4.p4.8.m8.4.4.1.3.2.2.2.1.cmml">⁢</mo><mrow id="S4.p4.8.m8.4.4.1.3.2.2.2.3.2" xref="S4.p4.8.m8.4.4.1.3.2.2.2.cmml"><mo id="S4.p4.8.m8.4.4.1.3.2.2.2.3.2.1" stretchy="false" xref="S4.p4.8.m8.4.4.1.3.2.2.2.cmml">(</mo><mi id="S4.p4.8.m8.2.2" xref="S4.p4.8.m8.2.2.cmml">R</mi><mo id="S4.p4.8.m8.4.4.1.3.2.2.2.3.2.2" rspace="0.055em" stretchy="false" xref="S4.p4.8.m8.4.4.1.3.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.p4.8.m8.4.4.1.3.2.2.1" rspace="0.222em" xref="S4.p4.8.m8.4.4.1.3.2.2.1.cmml">×</mo><mn id="S4.p4.8.m8.4.4.1.3.2.2.3" xref="S4.p4.8.m8.4.4.1.3.2.2.3.cmml">512</mn></mrow><mo id="S4.p4.8.m8.4.4.1.3.2.1" xref="S4.p4.8.m8.4.4.1.3.2.1.cmml">⁢</mo><mrow id="S4.p4.8.m8.4.4.1.3.2.3.2" xref="S4.p4.8.m8.4.4.1.3.2.cmml"><mo id="S4.p4.8.m8.4.4.1.3.2.3.2.1" stretchy="false" xref="S4.p4.8.m8.4.4.1.3.2.cmml">(</mo><mi id="S4.p4.8.m8.3.3" xref="S4.p4.8.m8.3.3.cmml">D</mi><mo id="S4.p4.8.m8.4.4.1.3.2.3.2.2" rspace="0.055em" stretchy="false" xref="S4.p4.8.m8.4.4.1.3.2.cmml">)</mo></mrow></mrow><mo id="S4.p4.8.m8.4.4.1.3.1" rspace="0.222em" xref="S4.p4.8.m8.4.4.1.3.1.cmml">×</mo><mn id="S4.p4.8.m8.4.4.1.3.3" xref="S4.p4.8.m8.4.4.1.3.3.cmml">1024</mn></mrow><mo id="S4.p4.8.m8.4.4.1.2" xref="S4.p4.8.m8.4.4.1.2.cmml">⁢</mo><mrow id="S4.p4.8.m8.4.4.1.1.1" xref="S4.p4.8.m8.4.4.1.1.1.1.cmml"><mo id="S4.p4.8.m8.4.4.1.1.1.2" stretchy="false" xref="S4.p4.8.m8.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.p4.8.m8.4.4.1.1.1.1" xref="S4.p4.8.m8.4.4.1.1.1.1.cmml"><mn id="S4.p4.8.m8.4.4.1.1.1.1.2" xref="S4.p4.8.m8.4.4.1.1.1.1.2.cmml">2</mn><mo id="S4.p4.8.m8.4.4.1.1.1.1.1" xref="S4.p4.8.m8.4.4.1.1.1.1.1.cmml">⁢</mo><mi id="S4.p4.8.m8.4.4.1.1.1.1.3" xref="S4.p4.8.m8.4.4.1.1.1.1.3.cmml">D</mi></mrow><mo id="S4.p4.8.m8.4.4.1.1.1.3" stretchy="false" xref="S4.p4.8.m8.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p4.8.m8.4.4.2" xref="S4.p4.8.m8.4.4.2.cmml">≈</mo><mrow id="S4.p4.8.m8.4.4.3" xref="S4.p4.8.m8.4.4.3.cmml"><mn id="S4.p4.8.m8.4.4.3.2" xref="S4.p4.8.m8.4.4.3.2.cmml">700</mn><mo id="S4.p4.8.m8.4.4.3.1" xref="S4.p4.8.m8.4.4.3.1.cmml">⁢</mo><mi id="S4.p4.8.m8.4.4.3.3" xref="S4.p4.8.m8.4.4.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.8.m8.4b"><apply id="S4.p4.8.m8.4.4.cmml" xref="S4.p4.8.m8.4.4"><approx id="S4.p4.8.m8.4.4.2.cmml" xref="S4.p4.8.m8.4.4.2"></approx><apply id="S4.p4.8.m8.4.4.1.cmml" xref="S4.p4.8.m8.4.4.1"><times id="S4.p4.8.m8.4.4.1.2.cmml" xref="S4.p4.8.m8.4.4.1.2"></times><apply id="S4.p4.8.m8.4.4.1.3.cmml" xref="S4.p4.8.m8.4.4.1.3"><times id="S4.p4.8.m8.4.4.1.3.1.cmml" xref="S4.p4.8.m8.4.4.1.3.1"></times><apply id="S4.p4.8.m8.4.4.1.3.2.cmml" xref="S4.p4.8.m8.4.4.1.3.2"><times id="S4.p4.8.m8.4.4.1.3.2.1.cmml" xref="S4.p4.8.m8.4.4.1.3.2.1"></times><apply id="S4.p4.8.m8.4.4.1.3.2.2.cmml" xref="S4.p4.8.m8.4.4.1.3.2.2"><times id="S4.p4.8.m8.4.4.1.3.2.2.1.cmml" xref="S4.p4.8.m8.4.4.1.3.2.2.1"></times><apply id="S4.p4.8.m8.4.4.1.3.2.2.2.cmml" xref="S4.p4.8.m8.4.4.1.3.2.2.2"><times id="S4.p4.8.m8.4.4.1.3.2.2.2.1.cmml" xref="S4.p4.8.m8.4.4.1.3.2.2.2.1"></times><apply id="S4.p4.8.m8.4.4.1.3.2.2.2.2.cmml" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2"><times id="S4.p4.8.m8.4.4.1.3.2.2.2.2.1.cmml" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.1"></times><apply id="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.cmml" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.2"><times id="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.1.cmml" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.1"></times><cn id="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.2.cmml" type="integer" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.2.2">4</cn><ci id="S4.p4.8.m8.1.1.cmml" xref="S4.p4.8.m8.1.1">𝑛</ci></apply><cn id="S4.p4.8.m8.4.4.1.3.2.2.2.2.3.cmml" type="float" xref="S4.p4.8.m8.4.4.1.3.2.2.2.2.3">0.33</cn></apply><ci id="S4.p4.8.m8.2.2.cmml" xref="S4.p4.8.m8.2.2">𝑅</ci></apply><cn id="S4.p4.8.m8.4.4.1.3.2.2.3.cmml" type="integer" xref="S4.p4.8.m8.4.4.1.3.2.2.3">512</cn></apply><ci id="S4.p4.8.m8.3.3.cmml" xref="S4.p4.8.m8.3.3">𝐷</ci></apply><cn id="S4.p4.8.m8.4.4.1.3.3.cmml" type="integer" xref="S4.p4.8.m8.4.4.1.3.3">1024</cn></apply><apply id="S4.p4.8.m8.4.4.1.1.1.1.cmml" xref="S4.p4.8.m8.4.4.1.1.1"><times id="S4.p4.8.m8.4.4.1.1.1.1.1.cmml" xref="S4.p4.8.m8.4.4.1.1.1.1.1"></times><cn id="S4.p4.8.m8.4.4.1.1.1.1.2.cmml" type="integer" xref="S4.p4.8.m8.4.4.1.1.1.1.2">2</cn><ci id="S4.p4.8.m8.4.4.1.1.1.1.3.cmml" xref="S4.p4.8.m8.4.4.1.1.1.1.3">𝐷</ci></apply></apply><apply id="S4.p4.8.m8.4.4.3.cmml" xref="S4.p4.8.m8.4.4.3"><times id="S4.p4.8.m8.4.4.3.1.cmml" xref="S4.p4.8.m8.4.4.3.1"></times><cn id="S4.p4.8.m8.4.4.3.2.cmml" type="integer" xref="S4.p4.8.m8.4.4.3.2">700</cn><ci id="S4.p4.8.m8.4.4.3.3.cmml" xref="S4.p4.8.m8.4.4.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.8.m8.4c">4(n)\times 0.33(R)\times 512(D)\times 1024(2D)\approx 700K</annotation><annotation encoding="application/x-llamapun" id="S4.p4.8.m8.4d">4 ( italic_n ) × 0.33 ( italic_R ) × 512 ( italic_D ) × 1024 ( 2 italic_D ) ≈ 700 italic_K</annotation></semantics></math>, the number of activation saved for four layer is approximately <math alttext="4(n)\times 0.33(R)\times 32(B)\times 50(L)\times 1024(2D)\approx 2M" class="ltx_Math" display="inline" id="S4.p4.9.m9.5"><semantics id="S4.p4.9.m9.5a"><mrow id="S4.p4.9.m9.5.5" xref="S4.p4.9.m9.5.5.cmml"><mrow id="S4.p4.9.m9.5.5.1" xref="S4.p4.9.m9.5.5.1.cmml"><mrow id="S4.p4.9.m9.5.5.1.3" xref="S4.p4.9.m9.5.5.1.3.cmml"><mrow id="S4.p4.9.m9.5.5.1.3.2" xref="S4.p4.9.m9.5.5.1.3.2.cmml"><mrow id="S4.p4.9.m9.5.5.1.3.2.2" xref="S4.p4.9.m9.5.5.1.3.2.2.cmml"><mrow id="S4.p4.9.m9.5.5.1.3.2.2.2" xref="S4.p4.9.m9.5.5.1.3.2.2.2.cmml"><mrow id="S4.p4.9.m9.5.5.1.3.2.2.2.2" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.cmml"><mrow id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.cmml"><mrow id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.cmml"><mrow id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.cmml"><mn id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.2" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.2.cmml">4</mn><mo id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.1" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.3.2" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.cmml"><mo id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.3.2.1" stretchy="false" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.cmml">(</mo><mi id="S4.p4.9.m9.1.1" xref="S4.p4.9.m9.1.1.cmml">n</mi><mo id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.3.2.2" rspace="0.055em" stretchy="false" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.1" rspace="0.222em" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.1.cmml">×</mo><mn id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.3" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.3.cmml">0.33</mn></mrow><mo id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.1" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.3.2" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.cmml"><mo id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.3.2.1" stretchy="false" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.cmml">(</mo><mi id="S4.p4.9.m9.2.2" xref="S4.p4.9.m9.2.2.cmml">R</mi><mo id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.3.2.2" rspace="0.055em" stretchy="false" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.p4.9.m9.5.5.1.3.2.2.2.2.1" rspace="0.222em" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.1.cmml">×</mo><mn id="S4.p4.9.m9.5.5.1.3.2.2.2.2.3" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.3.cmml">32</mn></mrow><mo id="S4.p4.9.m9.5.5.1.3.2.2.2.1" xref="S4.p4.9.m9.5.5.1.3.2.2.2.1.cmml">⁢</mo><mrow id="S4.p4.9.m9.5.5.1.3.2.2.2.3.2" xref="S4.p4.9.m9.5.5.1.3.2.2.2.cmml"><mo id="S4.p4.9.m9.5.5.1.3.2.2.2.3.2.1" stretchy="false" xref="S4.p4.9.m9.5.5.1.3.2.2.2.cmml">(</mo><mi id="S4.p4.9.m9.3.3" xref="S4.p4.9.m9.3.3.cmml">B</mi><mo id="S4.p4.9.m9.5.5.1.3.2.2.2.3.2.2" rspace="0.055em" stretchy="false" xref="S4.p4.9.m9.5.5.1.3.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.p4.9.m9.5.5.1.3.2.2.1" rspace="0.222em" xref="S4.p4.9.m9.5.5.1.3.2.2.1.cmml">×</mo><mn id="S4.p4.9.m9.5.5.1.3.2.2.3" xref="S4.p4.9.m9.5.5.1.3.2.2.3.cmml">50</mn></mrow><mo id="S4.p4.9.m9.5.5.1.3.2.1" xref="S4.p4.9.m9.5.5.1.3.2.1.cmml">⁢</mo><mrow id="S4.p4.9.m9.5.5.1.3.2.3.2" xref="S4.p4.9.m9.5.5.1.3.2.cmml"><mo id="S4.p4.9.m9.5.5.1.3.2.3.2.1" stretchy="false" xref="S4.p4.9.m9.5.5.1.3.2.cmml">(</mo><mi id="S4.p4.9.m9.4.4" xref="S4.p4.9.m9.4.4.cmml">L</mi><mo id="S4.p4.9.m9.5.5.1.3.2.3.2.2" rspace="0.055em" stretchy="false" xref="S4.p4.9.m9.5.5.1.3.2.cmml">)</mo></mrow></mrow><mo id="S4.p4.9.m9.5.5.1.3.1" rspace="0.222em" xref="S4.p4.9.m9.5.5.1.3.1.cmml">×</mo><mn id="S4.p4.9.m9.5.5.1.3.3" xref="S4.p4.9.m9.5.5.1.3.3.cmml">1024</mn></mrow><mo id="S4.p4.9.m9.5.5.1.2" xref="S4.p4.9.m9.5.5.1.2.cmml">⁢</mo><mrow id="S4.p4.9.m9.5.5.1.1.1" xref="S4.p4.9.m9.5.5.1.1.1.1.cmml"><mo id="S4.p4.9.m9.5.5.1.1.1.2" stretchy="false" xref="S4.p4.9.m9.5.5.1.1.1.1.cmml">(</mo><mrow id="S4.p4.9.m9.5.5.1.1.1.1" xref="S4.p4.9.m9.5.5.1.1.1.1.cmml"><mn id="S4.p4.9.m9.5.5.1.1.1.1.2" xref="S4.p4.9.m9.5.5.1.1.1.1.2.cmml">2</mn><mo id="S4.p4.9.m9.5.5.1.1.1.1.1" xref="S4.p4.9.m9.5.5.1.1.1.1.1.cmml">⁢</mo><mi id="S4.p4.9.m9.5.5.1.1.1.1.3" xref="S4.p4.9.m9.5.5.1.1.1.1.3.cmml">D</mi></mrow><mo id="S4.p4.9.m9.5.5.1.1.1.3" stretchy="false" xref="S4.p4.9.m9.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p4.9.m9.5.5.2" xref="S4.p4.9.m9.5.5.2.cmml">≈</mo><mrow id="S4.p4.9.m9.5.5.3" xref="S4.p4.9.m9.5.5.3.cmml"><mn id="S4.p4.9.m9.5.5.3.2" xref="S4.p4.9.m9.5.5.3.2.cmml">2</mn><mo id="S4.p4.9.m9.5.5.3.1" xref="S4.p4.9.m9.5.5.3.1.cmml">⁢</mo><mi id="S4.p4.9.m9.5.5.3.3" xref="S4.p4.9.m9.5.5.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.9.m9.5b"><apply id="S4.p4.9.m9.5.5.cmml" xref="S4.p4.9.m9.5.5"><approx id="S4.p4.9.m9.5.5.2.cmml" xref="S4.p4.9.m9.5.5.2"></approx><apply id="S4.p4.9.m9.5.5.1.cmml" xref="S4.p4.9.m9.5.5.1"><times id="S4.p4.9.m9.5.5.1.2.cmml" xref="S4.p4.9.m9.5.5.1.2"></times><apply id="S4.p4.9.m9.5.5.1.3.cmml" xref="S4.p4.9.m9.5.5.1.3"><times id="S4.p4.9.m9.5.5.1.3.1.cmml" xref="S4.p4.9.m9.5.5.1.3.1"></times><apply id="S4.p4.9.m9.5.5.1.3.2.cmml" xref="S4.p4.9.m9.5.5.1.3.2"><times id="S4.p4.9.m9.5.5.1.3.2.1.cmml" xref="S4.p4.9.m9.5.5.1.3.2.1"></times><apply id="S4.p4.9.m9.5.5.1.3.2.2.cmml" xref="S4.p4.9.m9.5.5.1.3.2.2"><times id="S4.p4.9.m9.5.5.1.3.2.2.1.cmml" xref="S4.p4.9.m9.5.5.1.3.2.2.1"></times><apply id="S4.p4.9.m9.5.5.1.3.2.2.2.cmml" xref="S4.p4.9.m9.5.5.1.3.2.2.2"><times id="S4.p4.9.m9.5.5.1.3.2.2.2.1.cmml" xref="S4.p4.9.m9.5.5.1.3.2.2.2.1"></times><apply id="S4.p4.9.m9.5.5.1.3.2.2.2.2.cmml" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2"><times id="S4.p4.9.m9.5.5.1.3.2.2.2.2.1.cmml" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.1"></times><apply id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.cmml" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2"><times id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.1.cmml" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.1"></times><apply id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.cmml" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2"><times id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.1.cmml" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.1"></times><apply id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.cmml" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2"><times id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.1.cmml" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.1"></times><cn id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.2.cmml" type="integer" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.2.2">4</cn><ci id="S4.p4.9.m9.1.1.cmml" xref="S4.p4.9.m9.1.1">𝑛</ci></apply><cn id="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.3.cmml" type="float" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.2.2.3">0.33</cn></apply><ci id="S4.p4.9.m9.2.2.cmml" xref="S4.p4.9.m9.2.2">𝑅</ci></apply><cn id="S4.p4.9.m9.5.5.1.3.2.2.2.2.3.cmml" type="integer" xref="S4.p4.9.m9.5.5.1.3.2.2.2.2.3">32</cn></apply><ci id="S4.p4.9.m9.3.3.cmml" xref="S4.p4.9.m9.3.3">𝐵</ci></apply><cn id="S4.p4.9.m9.5.5.1.3.2.2.3.cmml" type="integer" xref="S4.p4.9.m9.5.5.1.3.2.2.3">50</cn></apply><ci id="S4.p4.9.m9.4.4.cmml" xref="S4.p4.9.m9.4.4">𝐿</ci></apply><cn id="S4.p4.9.m9.5.5.1.3.3.cmml" type="integer" xref="S4.p4.9.m9.5.5.1.3.3">1024</cn></apply><apply id="S4.p4.9.m9.5.5.1.1.1.1.cmml" xref="S4.p4.9.m9.5.5.1.1.1"><times id="S4.p4.9.m9.5.5.1.1.1.1.1.cmml" xref="S4.p4.9.m9.5.5.1.1.1.1.1"></times><cn id="S4.p4.9.m9.5.5.1.1.1.1.2.cmml" type="integer" xref="S4.p4.9.m9.5.5.1.1.1.1.2">2</cn><ci id="S4.p4.9.m9.5.5.1.1.1.1.3.cmml" xref="S4.p4.9.m9.5.5.1.1.1.1.3">𝐷</ci></apply></apply><apply id="S4.p4.9.m9.5.5.3.cmml" xref="S4.p4.9.m9.5.5.3"><times id="S4.p4.9.m9.5.5.3.1.cmml" xref="S4.p4.9.m9.5.5.3.1"></times><cn id="S4.p4.9.m9.5.5.3.2.cmml" type="integer" xref="S4.p4.9.m9.5.5.3.2">2</cn><ci id="S4.p4.9.m9.5.5.3.3.cmml" xref="S4.p4.9.m9.5.5.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.9.m9.5c">4(n)\times 0.33(R)\times 32(B)\times 50(L)\times 1024(2D)\approx 2M</annotation><annotation encoding="application/x-llamapun" id="S4.p4.9.m9.5d">4 ( italic_n ) × 0.33 ( italic_R ) × 32 ( italic_B ) × 50 ( italic_L ) × 1024 ( 2 italic_D ) ≈ 2 italic_M</annotation></semantics></math>. This is to a great extent saving memory usage if independent training is executed in parallel or saving training time if executed sequentially.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experimental Setup</h2>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Statistics of the datasets.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T1.1" style="width:433.6pt;height:145.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(83.1pt,-28.0pt) scale(1.62151203578568,1.62151203578568) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.1.1">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.1.1">Name</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.2.1">#User</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.3.1">#Item</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.4.1">#Image</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.5.1">#Inter.</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="S5.T1.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.6.1">Density</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.1.2.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.2.1.1">Beauty</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.2">22,363</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.3">12,101</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.4">12,023</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.5">198k</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.1.1.2.6">0.073</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.3">
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.3.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.3.1.1">Clothing</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.3.2">39,387</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.3.3">23,033</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.3.4">22,299</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.3.5">278k</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.1.1.3.6">0.031</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.4">
<td class="ltx_td ltx_align_left" id="S5.T1.1.1.4.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.4.1.1">Sports</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.2">35,598</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.3">18,357</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.4">17,943</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.5">296k</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.1.1.4.6">0.045</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.5">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T1.1.1.5.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.5.1.1">Toys</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.5.2">19,412</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.5.3">11,924</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.5.4">11,895</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.5.5">167k</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S5.T1.1.1.5.6">0.072</td>
</tr>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Main performance results of fMRLRec and baselines.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.1" style="width:433.6pt;height:336.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-38.6pt,29.9pt) scale(0.848754531994535,0.848754531994535) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.1.1">
<tr class="ltx_tr" id="S5.T2.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T2.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.1.1">Dataset</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T2.1.1.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.2.1">Metric</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S5.T2.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.3.1">ID-Based</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S5.T2.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.4.1">Text-Based</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S5.T2.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.5.1">Multimodal</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.1">SAS</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.2">BERT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.3">FMLP</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.4">LRU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.5">UniS.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.6">VQRec</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.7">RecF.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.8">MMSSL</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.9">VIP5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.10">fMRLRec</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.1.3.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.3.1.1">Beauty</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.1.3.2">N@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.3.3">0.0274</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.3.4">0.0275</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.3.5">0.0318</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.3.6">0.0339</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.3.7">0.0274</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.3.8">0.0303</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.3.9">0.0258</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.3.10">0.0189</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.3.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.3.11.1">0.0339</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.3.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.3.12.1">0.0415</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.4">
<td class="ltx_td" id="S5.T2.1.1.4.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.4.2">R@5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.3">0.0456</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.4">0.0420</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.5">0.0539</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.4.6.1">0.0565</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.7">0.0484</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.8">0.0514</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.9">0.0428</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.10">0.0308</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.11">0.0417</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.4.12.1">0.0613</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.5">
<td class="ltx_td" id="S5.T2.1.1.5.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.5.2">N@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.3">0.0364</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.4">0.0350</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.5">0.0416</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.5.6.1">0.0438</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.7">0.0375</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.8">0.0411</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.9">0.0341</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.10">0.0252</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.11">0.0367</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.5.12.1">0.0520</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.6">
<td class="ltx_td" id="S5.T2.1.1.6.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.6.2">R@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.3">0.0734</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.4">0.0653</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.5">0.0846</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.6.6.1">0.0871</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.7">0.0799</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.8">0.0849</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.9">0.0686</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.10">0.0506</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.11">0.0603</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.6.12.1">0.0939</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.7">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.1.7.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.7.1.1">Cloth.</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.1.7.2">N@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.7.3">0.0075</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.7.4">0.0062</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.7.5">0.0091</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.7.6">0.0104</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.7.7">0.0127</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.7.8">0.0104</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.7.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.7.9.1">0.0137</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.7.10">0.0089</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.7.11">0.0122</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.7.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.7.12.1">0.0193</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.8">
<td class="ltx_td" id="S5.T2.1.1.8.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.8.2">R@5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.8.3">0.0134</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.8.4">0.0100</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.8.5">0.0167</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.8.6">0.0192</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.8.7">0.0221</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.8.8">0.0197</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.8.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.8.9.1">0.0234</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.8.10">0.0146</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.8.11">0.0152</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.8.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.8.12.1">0.0333</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.9">
<td class="ltx_td" id="S5.T2.1.1.9.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.9.2">N@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.9.3">0.0104</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.9.4">0.0084</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.9.5">0.0123</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.9.6">0.0140</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.9.7">0.0175</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.9.8">0.0149</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.9.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.9.9.1">0.0192</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.9.10">0.0122</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.9.11">0.0183</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.9.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.9.12.1">0.0259</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.10">
<td class="ltx_td" id="S5.T2.1.1.10.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.10.2">R@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.10.3">0.0227</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.10.4">0.0169</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.10.5">0.0266</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.10.6">0.0304</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.10.7">0.0372</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.10.8">0.0336</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.10.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.10.9.1">0.0405</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.10.10">0.0249</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.10.11">0.0298</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.10.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.10.12.1">0.0541</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.11">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.1.11.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.11.1.1">Sports</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.1.11.2">N@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.11.3">0.0143</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.11.4">0.0137</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.11.5">0.0194</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.11.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.11.6.1">0.0204</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.11.7">0.0141</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.11.8">0.0173</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.11.9">0.0127</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.11.10">0.0123</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.11.11">0.0136</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.11.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.11.12.1">0.0230</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.12">
<td class="ltx_td" id="S5.T2.1.1.12.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.12.2">R@5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.12.3">0.0267</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.12.4">0.0215</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.12.5">0.0329</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.12.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.12.6.1">0.0344</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.12.7">0.0237</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.12.8">0.0304</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.12.9">0.0211</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.12.10">0.0198</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.12.11">0.0264</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.12.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.12.12.1">0.0349</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.13">
<td class="ltx_td" id="S5.T2.1.1.13.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.13.2">N@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.13.3">0.0210</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.13.4">0.0181</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.13.5">0.0252</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.13.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.13.6.1">0.0266</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.13.7">0.0195</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.13.8">0.0235</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.13.9">0.0173</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.13.10">0.0163</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.13.11">0.0213</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.13.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.13.12.1">0.0284</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.14">
<td class="ltx_td" id="S5.T2.1.1.14.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.14.2">R@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.14.3">0.0474</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.14.4">0.0355</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.14.5">0.0508</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.14.6"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.14.6.1">0.0536</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.14.7">0.0408</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.14.8">0.0497</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.14.9">0.0350</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.14.10">0.0321</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.14.11">0.0315</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.14.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.14.12.1">0.0516</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.15">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.1.15.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.15.1.1">Toys</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.1.15.2">N@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.15.3">0.0291</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.15.4">0.0241</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.15.5">0.0308</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.15.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.15.6.1">0.0366</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.15.7">0.0254</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.15.8">0.0314</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.15.9">0.0292</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.15.10">0.0173</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.15.11">0.0334</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.15.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.15.12.1">0.0461</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.16">
<td class="ltx_td" id="S5.T2.1.1.16.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.16.2">R@5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.16.3">0.0534</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.16.4">0.0355</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.16.5">0.0534</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.16.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.16.6.1">0.0601</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.16.7">0.0477</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.16.8">0.0577</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.16.9">0.0501</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.16.10">0.0286</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.16.11">0.0474</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.16.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.16.12.1">0.0672</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.17">
<td class="ltx_td" id="S5.T2.1.1.17.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.17.2">N@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.17.3">0.0380</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.17.4">0.0299</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.17.5">0.0408</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.17.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.17.6.1">0.0463</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.17.7">0.0362</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.17.8">0.0423</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.17.9">0.0398</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.17.10">0.0224</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.17.11">0.0374</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.17.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.17.12.1">0.0552</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.18">
<td class="ltx_td" id="S5.T2.1.1.18.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.18.2">R@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.18.3">0.0807</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.18.4">0.0535</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.18.5">0.0845</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.18.6">0.0901</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.18.7">0.0811</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.18.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.18.8.1">0.0915</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.18.9">0.0832</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.18.10">0.0445</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.18.11">0.0642</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.18.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.18.12.1">0.0956</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.19">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.1.19.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.19.1.1">Avg.</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.1.19.2">N@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.19.3">0.0196</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.19.4">0.0179</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.19.5">0.0228</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.19.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.19.6.1">0.0253</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.19.7">0.0199</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.19.8">0.0224</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.19.9">0.0204</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.19.10">0.0144</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.19.11">0.0233</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.19.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.19.12.1">0.0325</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.20">
<td class="ltx_td" id="S5.T2.1.1.20.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.20.2">R@5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.20.3">0.0348</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.20.4">0.0273</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.20.5">0.0392</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.20.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.20.6.1">0.0426</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.20.7">0.0355</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.20.8">0.0398</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.20.9">0.0344</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.20.10">0.0235</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.20.11">0.0327</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.20.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.20.12.1">0.0492</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.21">
<td class="ltx_td" id="S5.T2.1.1.21.1"></td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.1.21.2">N@10</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.21.3">0.0265</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.21.4">0.0229</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.21.5">0.0300</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.21.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.21.6.1">0.0327</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.21.7">0.0277</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.21.8">0.0305</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.21.9">0.0276</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.21.10">0.0191</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.21.11">0.0284</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.21.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.21.12.1">0.0404</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.22">
<td class="ltx_td ltx_border_bb" id="S5.T2.1.1.22.1"></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T2.1.1.22.2">R@10</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.1.22.3">0.0561</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.1.22.4">0.0428</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.1.22.5">0.0616</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.1.22.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.1.22.6.1">0.0653</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.1.22.7">0.0598</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.1.22.8">0.0649</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.1.22.9">0.0568</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.1.22.10">0.0381</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.1.22.11">0.0465</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.1.22.12"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.22.12.1">0.0738</span></td>
</tr>
</table>
</span></div>
</figure>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Datasets</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">For evaluating our models, we select four commonly used benchmarks from <em class="ltx_emph ltx_font_italic" id="S5.SS1.p1.1.1">Amazon.com</em> known for real-word sparsity, namely <em class="ltx_emph ltx_font_italic" id="S5.SS1.p1.1.2">Beauty</em>, <em class="ltx_emph ltx_font_italic" id="S5.SS1.p1.1.3">Clothing, Shoes &amp; Jewelry</em> (Clothing), <em class="ltx_emph ltx_font_italic" id="S5.SS1.p1.1.4">Sports &amp; Outdoors</em> (Sports) and <em class="ltx_emph ltx_font_italic" id="S5.SS1.p1.1.5">Toys &amp; Games</em> (Toys) <cite class="ltx_cite ltx_citemacro_cite">McAuley et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib20" title="">2015</a>); He and McAuley (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib6" title="">2016a</a>)</cite>. For preprocessing, we follow <cite class="ltx_cite ltx_citemacro_cite">Yue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib38" title="">2022</a>); Chen (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib2" title="">2023</a>); Geng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib3" title="">2023</a>)</cite> to construct the input sequence in chronological order and apply 5-core filtering to exclude users and items with less than five-time appearances. For textural feature selection, we choose <em class="ltx_emph ltx_font_italic" id="S5.SS1.p1.1.6">title</em>, <em class="ltx_emph ltx_font_italic" id="S5.SS1.p1.1.7">price</em>, <em class="ltx_emph ltx_font_italic" id="S5.SS1.p1.1.8">brand</em> and <em class="ltx_emph ltx_font_italic" id="S5.SS1.p1.1.9">categories</em>; For visual features, we use <em class="ltx_emph ltx_font_italic" id="S5.SS1.p1.1.10">photos</em> of the items. We also filter out items without above metadata. Detailed statistics of the datasets are reported in table <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S5.T1" title="Table 1 ‣ 5 Experimental Setup ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> including users (#User), items (#Item), images (#Image), interactions (#Inter.) and dataset density in percentages.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Baseline Methods</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">For baseline models, we select a series of state-of-the-art recommendation models grouped as <em class="ltx_emph ltx_font_italic" id="S5.SS2.p1.1.1">ID-based</em>, <em class="ltx_emph ltx_font_italic" id="S5.SS2.p1.1.2">Text-based</em> and <em class="ltx_emph ltx_font_italic" id="S5.SS2.p1.1.3">Multimodal</em>. <em class="ltx_emph ltx_font_italic" id="S5.SS2.p1.1.4">ID-based</em> models include SASRec, BERT4Rec, FMLP-Rec and LRURec <cite class="ltx_cite ltx_citemacro_cite">Kang and McAuley (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib11" title="">2018</a>); Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib24" title="">2019</a>); Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib41" title="">2022</a>); Yue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib37" title="">2024</a>)</cite>. Text-based methods include UniSRec, VQRec and RecFormer <cite class="ltx_cite ltx_citemacro_cite">Hou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib9" title="">2022</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib8" title="">2023</a>); Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib14" title="">2023a</a>)</cite>. We also include multimodal baselines MMSSL, VIP5 <cite class="ltx_cite ltx_citemacro_cite">Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib30" title="">2023</a>); Geng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib3" title="">2023</a>)</cite>, More details about baselines is discussed in <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#A1.SS1" title="A.1 Baselines ‣ Appendix A Appendix ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.1</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Implementations</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.3">For training fMRLRec and all baseline models, we utilize AdamW optimizer with learning rate of 1e-3/1e-4 with maximum epochs of 500. Validation is performed per epoch and the training is stopped once validation performance does not improve for 10 epochs. The model with best validation performance is saved for testing and metrics report. For hyperparameters, we find (1) embedding/model size, the number of fMRLRec-LRU layers, dropout rate and weight decay be the most sensitive ones for model performance. Specifically, we grid-search the embedding/model size in [64, 128, 256, 512, 1024, 2048], the number of fMRLRec-LRU layers in [1,2,4,8], dropout rate from [0.1,…,0.8] on a 0.1-stride and weight decay from [1e-6, 1e-4, 1e-2]. For ring-initialization of LRU layers, we grid-search the minimum radius in [0.0,…,0.5] on a 0.1-stride. The max radius is set to the minimum radius plus 0.1. The best hyper-parameters for each datasets are reported in <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#A1.SS2" title="A.2 Implementations ‣ Appendix A Appendix ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.2</span></a>; We follow <cite class="ltx_cite ltx_citemacro_cite">Geng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib3" title="">2023</a>)</cite> and set maximum length of input sequence as 50. For validation and test, we adopt two metrics NDCG@<math alttext="k" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><mi id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><ci id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">italic_k</annotation></semantics></math> and Recall@<math alttext="k" class="ltx_Math" display="inline" id="S5.SS3.p1.2.m2.1"><semantics id="S5.SS3.p1.2.m2.1a"><mi id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><ci id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">italic_k</annotation></semantics></math>, <math alttext="k\in\{5,10\}" class="ltx_Math" display="inline" id="S5.SS3.p1.3.m3.2"><semantics id="S5.SS3.p1.3.m3.2a"><mrow id="S5.SS3.p1.3.m3.2.3" xref="S5.SS3.p1.3.m3.2.3.cmml"><mi id="S5.SS3.p1.3.m3.2.3.2" xref="S5.SS3.p1.3.m3.2.3.2.cmml">k</mi><mo id="S5.SS3.p1.3.m3.2.3.1" xref="S5.SS3.p1.3.m3.2.3.1.cmml">∈</mo><mrow id="S5.SS3.p1.3.m3.2.3.3.2" xref="S5.SS3.p1.3.m3.2.3.3.1.cmml"><mo id="S5.SS3.p1.3.m3.2.3.3.2.1" stretchy="false" xref="S5.SS3.p1.3.m3.2.3.3.1.cmml">{</mo><mn id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">5</mn><mo id="S5.SS3.p1.3.m3.2.3.3.2.2" xref="S5.SS3.p1.3.m3.2.3.3.1.cmml">,</mo><mn id="S5.SS3.p1.3.m3.2.2" xref="S5.SS3.p1.3.m3.2.2.cmml">10</mn><mo id="S5.SS3.p1.3.m3.2.3.3.2.3" stretchy="false" xref="S5.SS3.p1.3.m3.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.2b"><apply id="S5.SS3.p1.3.m3.2.3.cmml" xref="S5.SS3.p1.3.m3.2.3"><in id="S5.SS3.p1.3.m3.2.3.1.cmml" xref="S5.SS3.p1.3.m3.2.3.1"></in><ci id="S5.SS3.p1.3.m3.2.3.2.cmml" xref="S5.SS3.p1.3.m3.2.3.2">𝑘</ci><set id="S5.SS3.p1.3.m3.2.3.3.1.cmml" xref="S5.SS3.p1.3.m3.2.3.3.2"><cn id="S5.SS3.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS3.p1.3.m3.1.1">5</cn><cn id="S5.SS3.p1.3.m3.2.2.cmml" type="integer" xref="S5.SS3.p1.3.m3.2.2">10</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.2c">k\in\{5,10\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.3.m3.2d">italic_k ∈ { 5 , 10 }</annotation></semantics></math> typical for recommendation algorithm evaluation.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experimental Results</h2>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Main Performance Analysis</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">Here, we compare the performance of fMRLRec with state-of-the-art baseline models in table <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S5.T2" title="Table 2 ‣ 5 Experimental Setup ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>. We use SAS, BERT, FMLP, LRU, UniS., RecF., fMRLRec to abbreviate SASRec BERT4Rec, FMLP-Rec LRURec, UniSRec, RecFormer and fMRLRec. The best metrics are marked in bold and the second best metrics are underlined. Overall, fMRLRec outperforms all baseline models in almost all cases with exceptions of Recall@10 for Sports. Specifically, We observe that: (1) fMRLRec on average outperforms the second-best model by 17.98% across all datasets and metrics (2) fMRLRec shows superior ranking performance by having a more significant gain of NDCG which is ranking sensitive than Recall. For example, fMRLRec achieves NDCG@5 improvement of 25.42% over the second best model, which is greater than the Recall@5 gains of 16.01%. This is also true for NDCG@10 gains of 19.97% compared with recall gains of 10.51%. (3) fMRLRec demonstrates significant benefits for sparse datasets, Clothing and Sports, by averaging 21.11% improvements. In contrast, the average gains is lower as 14.84% for relatively denser datasets as Beauty and Toys. In summary, our results suggest fMRLRec can effectively leverage multimodal item representation to rank items of user preference and improve recommendation performance.</p>
</div>
<figure class="ltx_figure" id="S6.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="531" id="S6.F3.sf1.g1" src="extracted/5896442/materials/MRL_plot_clothing_Recall.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Recall for Clothing</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="531" id="S6.F3.sf2.g1" src="extracted/5896442/materials/MRL_plot_beauty_Recall.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Recall for Beauty</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="446" id="S6.F3.sf3.g1" src="extracted/5896442/materials/MRL_plot_clothing_NDCG.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>NDCG for Clothing</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F3.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="462" id="S6.F3.sf4.g1" src="extracted/5896442/materials/MRL_plot_beauty_NDCG.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(d) </span>NDCG for Beauty</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>fMRLRec-model series performance curve against model size. fMRLRec features a significantly slower performance drop for example with drop rates from 6.14% to 37.69% (Recall@10 for Clothing) compared to the model compression rate of 50%.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>fMRLRec Model-Series Performance</h3>
<figure class="ltx_table" id="S6.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Ablation performance for fMRLRec by removing either of language (lang.) or visual features or both.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T3.1" style="width:433.6pt;height:150.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-42.2pt,14.7pt) scale(0.837012985846306,0.837012985846306) ;">
<table class="ltx_tabular ltx_align_middle" id="S6.T3.1.1">
<tr class="ltx_tr" id="S6.T3.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S6.T3.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.1.1.1">Variants / Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S6.T3.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.1.2.1">Beauty</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S6.T3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.1.3.1">Clothing</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S6.T3.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.1.4.1">Sports</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S6.T3.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.1.5.1">Toys</span></td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S6.T3.1.1.2.1"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.2.1.1">Metric</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.2.2">NDCG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.2.3">Recall</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.2.4">NDCG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.2.5">Recall</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.2.6">NDCG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.2.7">Recall</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.2.8">NDCG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.2.9">Recall</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.1.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T3.1.1.3.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.3.1.1">fMRLRec</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T3.1.1.3.2">@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.3.3"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.3.3.1">0.0415</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.3.4"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.3.4.1">0.0613</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.3.5"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.3.5.1">0.0193</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.3.6"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.3.6.1">0.0333</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.3.7"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.3.7.1">0.0230</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.3.8"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.3.8.1">0.0349</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.3.9"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.3.9.1">0.0461</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.3.10"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.3.10.1">0.0672</span></td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.1.4">
<td class="ltx_td ltx_align_left" id="S6.T3.1.1.4.1">@10</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.4.2"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.4.2.1">0.0520</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.4.3"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.4.3.1">0.0939</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.4.4"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.4.4.1">0.0259</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.4.5"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.4.5.1">0.0541</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.4.6"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.4.6.1">0.0284</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.4.7"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.4.7.1">0.0516</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.4.8"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.4.8.1">0.0552</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.4.9"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.4.9.1">0.0956</span></td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.1.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T3.1.1.5.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.5.1.1">fMRLRec w/ Lang. only</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T3.1.1.5.2">@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.5.3">0.0353</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.5.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.5.4.1">0.0561</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.5.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.5.5.1">0.0167</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.5.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.5.6.1">0.0279</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.5.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.5.7.1">0.0205</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.5.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.5.8.1">0.0313</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.5.9">0.0403</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.5.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.5.10.1">0.0618</span></td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.1.6">
<td class="ltx_td ltx_align_left" id="S6.T3.1.1.6.1">@10</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.6.2">0.0449</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.6.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.6.3.1">0.0859</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.6.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.6.4.1">0.0225</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.6.5">0.0461</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.6.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.6.6.1">0.0261</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.6.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.6.7.1">0.0487</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.6.8">0.0503</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.6.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.6.9.1">0.0927</span></td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.1.7">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T3.1.1.7.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.7.1.1">fMRLRec w/ Image only</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T3.1.1.7.2">@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.7.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.7.3.1">0.0370</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.7.4">0.0540</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.7.5">0.0162</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.7.6">0.0279</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.7.7">0.0194</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.7.8">0.0291</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.7.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.7.9.1">0.0416</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.7.10">0.0613</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.1.8">
<td class="ltx_td ltx_align_left" id="S6.T3.1.1.8.1">@10</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.8.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.8.2.1">0.0464</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.8.3">0.0833</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.8.4">0.0222</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.8.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.8.5.1">0.0467</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.8.6">0.0238</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.8.7">0.0430</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.8.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T3.1.1.8.8.1">0.0516</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.1.8.9">0.0920</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.1.9">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T3.1.1.9.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.9.1.1">fMRLRec w/o Lang. &amp; Image</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T3.1.1.9.2">@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.9.3">0.0257</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.9.4">0.0335</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.9.5">0.0035</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.9.6">0.0046</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.9.7">0.0113</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.9.8">0.0153</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.9.9">0.0287</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.1.9.10">0.0350</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.1.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T3.1.1.10.1">@10</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.1.10.2">0.0288</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.1.10.3">0.0431</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.1.10.4">0.0040</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.1.10.5">0.0062</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.1.10.6">0.0127</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.1.10.7">0.0197</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.1.10.8">0.0309</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.1.10.9">0.0418</td>
</tr>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.2">In this subsection, we analyze the performance of our full scale Matryoshka Representation Learning (fMRLRec) by extracting from trained models the differently-sized sub-models of <math alttext="\mathcal{M}=\{8,16,32,\ldots,D\}" class="ltx_Math" display="inline" id="S6.SS2.p1.1.m1.5"><semantics id="S6.SS2.p1.1.m1.5a"><mrow id="S6.SS2.p1.1.m1.5.6" xref="S6.SS2.p1.1.m1.5.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS2.p1.1.m1.5.6.2" xref="S6.SS2.p1.1.m1.5.6.2.cmml">ℳ</mi><mo id="S6.SS2.p1.1.m1.5.6.1" xref="S6.SS2.p1.1.m1.5.6.1.cmml">=</mo><mrow id="S6.SS2.p1.1.m1.5.6.3.2" xref="S6.SS2.p1.1.m1.5.6.3.1.cmml"><mo id="S6.SS2.p1.1.m1.5.6.3.2.1" stretchy="false" xref="S6.SS2.p1.1.m1.5.6.3.1.cmml">{</mo><mn id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml">8</mn><mo id="S6.SS2.p1.1.m1.5.6.3.2.2" xref="S6.SS2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S6.SS2.p1.1.m1.2.2" xref="S6.SS2.p1.1.m1.2.2.cmml">16</mn><mo id="S6.SS2.p1.1.m1.5.6.3.2.3" xref="S6.SS2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S6.SS2.p1.1.m1.3.3" xref="S6.SS2.p1.1.m1.3.3.cmml">32</mn><mo id="S6.SS2.p1.1.m1.5.6.3.2.4" xref="S6.SS2.p1.1.m1.5.6.3.1.cmml">,</mo><mi id="S6.SS2.p1.1.m1.4.4" mathvariant="normal" xref="S6.SS2.p1.1.m1.4.4.cmml">…</mi><mo id="S6.SS2.p1.1.m1.5.6.3.2.5" xref="S6.SS2.p1.1.m1.5.6.3.1.cmml">,</mo><mi id="S6.SS2.p1.1.m1.5.5" xref="S6.SS2.p1.1.m1.5.5.cmml">D</mi><mo id="S6.SS2.p1.1.m1.5.6.3.2.6" stretchy="false" xref="S6.SS2.p1.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.5b"><apply id="S6.SS2.p1.1.m1.5.6.cmml" xref="S6.SS2.p1.1.m1.5.6"><eq id="S6.SS2.p1.1.m1.5.6.1.cmml" xref="S6.SS2.p1.1.m1.5.6.1"></eq><ci id="S6.SS2.p1.1.m1.5.6.2.cmml" xref="S6.SS2.p1.1.m1.5.6.2">ℳ</ci><set id="S6.SS2.p1.1.m1.5.6.3.1.cmml" xref="S6.SS2.p1.1.m1.5.6.3.2"><cn id="S6.SS2.p1.1.m1.1.1.cmml" type="integer" xref="S6.SS2.p1.1.m1.1.1">8</cn><cn id="S6.SS2.p1.1.m1.2.2.cmml" type="integer" xref="S6.SS2.p1.1.m1.2.2">16</cn><cn id="S6.SS2.p1.1.m1.3.3.cmml" type="integer" xref="S6.SS2.p1.1.m1.3.3">32</cn><ci id="S6.SS2.p1.1.m1.4.4.cmml" xref="S6.SS2.p1.1.m1.4.4">…</ci><ci id="S6.SS2.p1.1.m1.5.5.cmml" xref="S6.SS2.p1.1.m1.5.5">𝐷</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.5c">\mathcal{M}=\{8,16,32,\ldots,D\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.1.m1.5d">caligraphic_M = { 8 , 16 , 32 , … , italic_D }</annotation></semantics></math>, where <math alttext="D=1024" class="ltx_Math" display="inline" id="S6.SS2.p1.2.m2.1"><semantics id="S6.SS2.p1.2.m2.1a"><mrow id="S6.SS2.p1.2.m2.1.1" xref="S6.SS2.p1.2.m2.1.1.cmml"><mi id="S6.SS2.p1.2.m2.1.1.2" xref="S6.SS2.p1.2.m2.1.1.2.cmml">D</mi><mo id="S6.SS2.p1.2.m2.1.1.1" xref="S6.SS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS2.p1.2.m2.1.1.3" xref="S6.SS2.p1.2.m2.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.2.m2.1b"><apply id="S6.SS2.p1.2.m2.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1"><eq id="S6.SS2.p1.2.m2.1.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1.1"></eq><ci id="S6.SS2.p1.2.m2.1.1.2.cmml" xref="S6.SS2.p1.2.m2.1.1.2">𝐷</ci><cn id="S6.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S6.SS2.p1.2.m2.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.2.m2.1c">D=1024</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.2.m2.1d">italic_D = 1024</annotation></semantics></math> here for best performance. Specific sub-model performance is shown in figure <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S6.F3" title="Figure 3 ‣ 6.1 Main Performance Analysis ‣ 6 Experimental Results ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>. Using Recall for Clothing as an example, we observe that: (1) The Recall decrease rate for Clothing ranges from 6.14% to 37.69% which is significantly lower than the exponential model compressed by a rate of 50%. This is consistent with the <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.2.1">Scaling Law</span> <cite class="ltx_cite ltx_citemacro_cite">Kaplan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib12" title="">2020</a>)</cite> that doubling the model size usually does not mean doubling performance. Despite statement of the <span class="ltx_text ltx_font_italic" id="S6.SS2.p1.2.2">Scaling Law</span>, the specific performance retained varies for datasets/tasks and are expensive to tune. Tackling this pain point, fMRLRec curve in figure <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S6.F3" title="Figure 3 ‣ 6.1 Main Performance Analysis ‣ 6 Experimental Results ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> provides flexible options of how much metric score to retain for developers with limited computational resources. And obtaining fMRLRec such patterns only requires a one-time training of the largest model as introduced in section <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S3.SS2" title="3.2 Full-Scale Matryoshka Representation Learning for Recommendation ‣ 3 Methodologies ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">3.2</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Parameter Saving of fMRLRec</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.7">Discussed in <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S4" title="4 fMRLRec Memory Efficiency ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a>, the model parameter saving rate <math alttext="R_{s}" class="ltx_Math" display="inline" id="S6.SS3.p1.1.m1.1"><semantics id="S6.SS3.p1.1.m1.1a"><msub id="S6.SS3.p1.1.m1.1.1" xref="S6.SS3.p1.1.m1.1.1.cmml"><mi id="S6.SS3.p1.1.m1.1.1.2" xref="S6.SS3.p1.1.m1.1.1.2.cmml">R</mi><mi id="S6.SS3.p1.1.m1.1.1.3" xref="S6.SS3.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.1.m1.1b"><apply id="S6.SS3.p1.1.m1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.p1.1.m1.1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS3.p1.1.m1.1.1.2.cmml" xref="S6.SS3.p1.1.m1.1.1.2">𝑅</ci><ci id="S6.SS3.p1.1.m1.1.1.3.cmml" xref="S6.SS3.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.1.m1.1c">R_{s}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> between fMRLRec-model series and independently trained models is theoretically around <math alttext="1/3" class="ltx_Math" display="inline" id="S6.SS3.p1.2.m2.1"><semantics id="S6.SS3.p1.2.m2.1a"><mrow id="S6.SS3.p1.2.m2.1.1" xref="S6.SS3.p1.2.m2.1.1.cmml"><mn id="S6.SS3.p1.2.m2.1.1.2" xref="S6.SS3.p1.2.m2.1.1.2.cmml">1</mn><mo id="S6.SS3.p1.2.m2.1.1.1" xref="S6.SS3.p1.2.m2.1.1.1.cmml">/</mo><mn id="S6.SS3.p1.2.m2.1.1.3" xref="S6.SS3.p1.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.2.m2.1b"><apply id="S6.SS3.p1.2.m2.1.1.cmml" xref="S6.SS3.p1.2.m2.1.1"><divide id="S6.SS3.p1.2.m2.1.1.1.cmml" xref="S6.SS3.p1.2.m2.1.1.1"></divide><cn id="S6.SS3.p1.2.m2.1.1.2.cmml" type="integer" xref="S6.SS3.p1.2.m2.1.1.2">1</cn><cn id="S6.SS3.p1.2.m2.1.1.3.cmml" type="integer" xref="S6.SS3.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.2.m2.1c">1/3</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.2.m2.1d">1 / 3</annotation></semantics></math> of the former. We demonstrate in figure <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S6.F4" title="Figure 4 ‣ 6.4 Ablation Study ‣ 6 Experimental Results ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> this behavior given model sizes of <math alttext="\mathcal{M}=\{2^{7},2^{8},\ldots,2^{11}\}" class="ltx_Math" display="inline" id="S6.SS3.p1.3.m3.4"><semantics id="S6.SS3.p1.3.m3.4a"><mrow id="S6.SS3.p1.3.m3.4.4" xref="S6.SS3.p1.3.m3.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS3.p1.3.m3.4.4.5" xref="S6.SS3.p1.3.m3.4.4.5.cmml">ℳ</mi><mo id="S6.SS3.p1.3.m3.4.4.4" xref="S6.SS3.p1.3.m3.4.4.4.cmml">=</mo><mrow id="S6.SS3.p1.3.m3.4.4.3.3" xref="S6.SS3.p1.3.m3.4.4.3.4.cmml"><mo id="S6.SS3.p1.3.m3.4.4.3.3.4" stretchy="false" xref="S6.SS3.p1.3.m3.4.4.3.4.cmml">{</mo><msup id="S6.SS3.p1.3.m3.2.2.1.1.1" xref="S6.SS3.p1.3.m3.2.2.1.1.1.cmml"><mn id="S6.SS3.p1.3.m3.2.2.1.1.1.2" xref="S6.SS3.p1.3.m3.2.2.1.1.1.2.cmml">2</mn><mn id="S6.SS3.p1.3.m3.2.2.1.1.1.3" xref="S6.SS3.p1.3.m3.2.2.1.1.1.3.cmml">7</mn></msup><mo id="S6.SS3.p1.3.m3.4.4.3.3.5" xref="S6.SS3.p1.3.m3.4.4.3.4.cmml">,</mo><msup id="S6.SS3.p1.3.m3.3.3.2.2.2" xref="S6.SS3.p1.3.m3.3.3.2.2.2.cmml"><mn id="S6.SS3.p1.3.m3.3.3.2.2.2.2" xref="S6.SS3.p1.3.m3.3.3.2.2.2.2.cmml">2</mn><mn id="S6.SS3.p1.3.m3.3.3.2.2.2.3" xref="S6.SS3.p1.3.m3.3.3.2.2.2.3.cmml">8</mn></msup><mo id="S6.SS3.p1.3.m3.4.4.3.3.6" xref="S6.SS3.p1.3.m3.4.4.3.4.cmml">,</mo><mi id="S6.SS3.p1.3.m3.1.1" mathvariant="normal" xref="S6.SS3.p1.3.m3.1.1.cmml">…</mi><mo id="S6.SS3.p1.3.m3.4.4.3.3.7" xref="S6.SS3.p1.3.m3.4.4.3.4.cmml">,</mo><msup id="S6.SS3.p1.3.m3.4.4.3.3.3" xref="S6.SS3.p1.3.m3.4.4.3.3.3.cmml"><mn id="S6.SS3.p1.3.m3.4.4.3.3.3.2" xref="S6.SS3.p1.3.m3.4.4.3.3.3.2.cmml">2</mn><mn id="S6.SS3.p1.3.m3.4.4.3.3.3.3" xref="S6.SS3.p1.3.m3.4.4.3.3.3.3.cmml">11</mn></msup><mo id="S6.SS3.p1.3.m3.4.4.3.3.8" stretchy="false" xref="S6.SS3.p1.3.m3.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.3.m3.4b"><apply id="S6.SS3.p1.3.m3.4.4.cmml" xref="S6.SS3.p1.3.m3.4.4"><eq id="S6.SS3.p1.3.m3.4.4.4.cmml" xref="S6.SS3.p1.3.m3.4.4.4"></eq><ci id="S6.SS3.p1.3.m3.4.4.5.cmml" xref="S6.SS3.p1.3.m3.4.4.5">ℳ</ci><set id="S6.SS3.p1.3.m3.4.4.3.4.cmml" xref="S6.SS3.p1.3.m3.4.4.3.3"><apply id="S6.SS3.p1.3.m3.2.2.1.1.1.cmml" xref="S6.SS3.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS3.p1.3.m3.2.2.1.1.1.1.cmml" xref="S6.SS3.p1.3.m3.2.2.1.1.1">superscript</csymbol><cn id="S6.SS3.p1.3.m3.2.2.1.1.1.2.cmml" type="integer" xref="S6.SS3.p1.3.m3.2.2.1.1.1.2">2</cn><cn id="S6.SS3.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S6.SS3.p1.3.m3.2.2.1.1.1.3">7</cn></apply><apply id="S6.SS3.p1.3.m3.3.3.2.2.2.cmml" xref="S6.SS3.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS3.p1.3.m3.3.3.2.2.2.1.cmml" xref="S6.SS3.p1.3.m3.3.3.2.2.2">superscript</csymbol><cn id="S6.SS3.p1.3.m3.3.3.2.2.2.2.cmml" type="integer" xref="S6.SS3.p1.3.m3.3.3.2.2.2.2">2</cn><cn id="S6.SS3.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S6.SS3.p1.3.m3.3.3.2.2.2.3">8</cn></apply><ci id="S6.SS3.p1.3.m3.1.1.cmml" xref="S6.SS3.p1.3.m3.1.1">…</ci><apply id="S6.SS3.p1.3.m3.4.4.3.3.3.cmml" xref="S6.SS3.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS3.p1.3.m3.4.4.3.3.3.1.cmml" xref="S6.SS3.p1.3.m3.4.4.3.3.3">superscript</csymbol><cn id="S6.SS3.p1.3.m3.4.4.3.3.3.2.cmml" type="integer" xref="S6.SS3.p1.3.m3.4.4.3.3.3.2">2</cn><cn id="S6.SS3.p1.3.m3.4.4.3.3.3.3.cmml" type="integer" xref="S6.SS3.p1.3.m3.4.4.3.3.3.3">11</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.3.m3.4c">\mathcal{M}=\{2^{7},2^{8},\ldots,2^{11}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.3.m3.4d">caligraphic_M = { 2 start_POSTSUPERSCRIPT 7 end_POSTSUPERSCRIPT , 2 start_POSTSUPERSCRIPT 8 end_POSTSUPERSCRIPT , … , 2 start_POSTSUPERSCRIPT 11 end_POSTSUPERSCRIPT }</annotation></semantics></math>. The green, blue and orange bar represents the number of parameters of fMRLRec-series, independently trained models and ones saved, respectively. Empirically, <math alttext="R_{s}=[0,25.16\%,31.39\%,32.90\%,33.25\%]" class="ltx_Math" display="inline" id="S6.SS3.p1.4.m4.5"><semantics id="S6.SS3.p1.4.m4.5a"><mrow id="S6.SS3.p1.4.m4.5.5" xref="S6.SS3.p1.4.m4.5.5.cmml"><msub id="S6.SS3.p1.4.m4.5.5.6" xref="S6.SS3.p1.4.m4.5.5.6.cmml"><mi id="S6.SS3.p1.4.m4.5.5.6.2" xref="S6.SS3.p1.4.m4.5.5.6.2.cmml">R</mi><mi id="S6.SS3.p1.4.m4.5.5.6.3" xref="S6.SS3.p1.4.m4.5.5.6.3.cmml">s</mi></msub><mo id="S6.SS3.p1.4.m4.5.5.5" xref="S6.SS3.p1.4.m4.5.5.5.cmml">=</mo><mrow id="S6.SS3.p1.4.m4.5.5.4.4" xref="S6.SS3.p1.4.m4.5.5.4.5.cmml"><mo id="S6.SS3.p1.4.m4.5.5.4.4.5" stretchy="false" xref="S6.SS3.p1.4.m4.5.5.4.5.cmml">[</mo><mn id="S6.SS3.p1.4.m4.1.1" xref="S6.SS3.p1.4.m4.1.1.cmml">0</mn><mo id="S6.SS3.p1.4.m4.5.5.4.4.6" xref="S6.SS3.p1.4.m4.5.5.4.5.cmml">,</mo><mrow id="S6.SS3.p1.4.m4.2.2.1.1.1" xref="S6.SS3.p1.4.m4.2.2.1.1.1.cmml"><mn id="S6.SS3.p1.4.m4.2.2.1.1.1.2" xref="S6.SS3.p1.4.m4.2.2.1.1.1.2.cmml">25.16</mn><mo id="S6.SS3.p1.4.m4.2.2.1.1.1.1" xref="S6.SS3.p1.4.m4.2.2.1.1.1.1.cmml">%</mo></mrow><mo id="S6.SS3.p1.4.m4.5.5.4.4.7" xref="S6.SS3.p1.4.m4.5.5.4.5.cmml">,</mo><mrow id="S6.SS3.p1.4.m4.3.3.2.2.2" xref="S6.SS3.p1.4.m4.3.3.2.2.2.cmml"><mn id="S6.SS3.p1.4.m4.3.3.2.2.2.2" xref="S6.SS3.p1.4.m4.3.3.2.2.2.2.cmml">31.39</mn><mo id="S6.SS3.p1.4.m4.3.3.2.2.2.1" xref="S6.SS3.p1.4.m4.3.3.2.2.2.1.cmml">%</mo></mrow><mo id="S6.SS3.p1.4.m4.5.5.4.4.8" xref="S6.SS3.p1.4.m4.5.5.4.5.cmml">,</mo><mrow id="S6.SS3.p1.4.m4.4.4.3.3.3" xref="S6.SS3.p1.4.m4.4.4.3.3.3.cmml"><mn id="S6.SS3.p1.4.m4.4.4.3.3.3.2" xref="S6.SS3.p1.4.m4.4.4.3.3.3.2.cmml">32.90</mn><mo id="S6.SS3.p1.4.m4.4.4.3.3.3.1" xref="S6.SS3.p1.4.m4.4.4.3.3.3.1.cmml">%</mo></mrow><mo id="S6.SS3.p1.4.m4.5.5.4.4.9" xref="S6.SS3.p1.4.m4.5.5.4.5.cmml">,</mo><mrow id="S6.SS3.p1.4.m4.5.5.4.4.4" xref="S6.SS3.p1.4.m4.5.5.4.4.4.cmml"><mn id="S6.SS3.p1.4.m4.5.5.4.4.4.2" xref="S6.SS3.p1.4.m4.5.5.4.4.4.2.cmml">33.25</mn><mo id="S6.SS3.p1.4.m4.5.5.4.4.4.1" xref="S6.SS3.p1.4.m4.5.5.4.4.4.1.cmml">%</mo></mrow><mo id="S6.SS3.p1.4.m4.5.5.4.4.10" stretchy="false" xref="S6.SS3.p1.4.m4.5.5.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.4.m4.5b"><apply id="S6.SS3.p1.4.m4.5.5.cmml" xref="S6.SS3.p1.4.m4.5.5"><eq id="S6.SS3.p1.4.m4.5.5.5.cmml" xref="S6.SS3.p1.4.m4.5.5.5"></eq><apply id="S6.SS3.p1.4.m4.5.5.6.cmml" xref="S6.SS3.p1.4.m4.5.5.6"><csymbol cd="ambiguous" id="S6.SS3.p1.4.m4.5.5.6.1.cmml" xref="S6.SS3.p1.4.m4.5.5.6">subscript</csymbol><ci id="S6.SS3.p1.4.m4.5.5.6.2.cmml" xref="S6.SS3.p1.4.m4.5.5.6.2">𝑅</ci><ci id="S6.SS3.p1.4.m4.5.5.6.3.cmml" xref="S6.SS3.p1.4.m4.5.5.6.3">𝑠</ci></apply><list id="S6.SS3.p1.4.m4.5.5.4.5.cmml" xref="S6.SS3.p1.4.m4.5.5.4.4"><cn id="S6.SS3.p1.4.m4.1.1.cmml" type="integer" xref="S6.SS3.p1.4.m4.1.1">0</cn><apply id="S6.SS3.p1.4.m4.2.2.1.1.1.cmml" xref="S6.SS3.p1.4.m4.2.2.1.1.1"><csymbol cd="latexml" id="S6.SS3.p1.4.m4.2.2.1.1.1.1.cmml" xref="S6.SS3.p1.4.m4.2.2.1.1.1.1">percent</csymbol><cn id="S6.SS3.p1.4.m4.2.2.1.1.1.2.cmml" type="float" xref="S6.SS3.p1.4.m4.2.2.1.1.1.2">25.16</cn></apply><apply id="S6.SS3.p1.4.m4.3.3.2.2.2.cmml" xref="S6.SS3.p1.4.m4.3.3.2.2.2"><csymbol cd="latexml" id="S6.SS3.p1.4.m4.3.3.2.2.2.1.cmml" xref="S6.SS3.p1.4.m4.3.3.2.2.2.1">percent</csymbol><cn id="S6.SS3.p1.4.m4.3.3.2.2.2.2.cmml" type="float" xref="S6.SS3.p1.4.m4.3.3.2.2.2.2">31.39</cn></apply><apply id="S6.SS3.p1.4.m4.4.4.3.3.3.cmml" xref="S6.SS3.p1.4.m4.4.4.3.3.3"><csymbol cd="latexml" id="S6.SS3.p1.4.m4.4.4.3.3.3.1.cmml" xref="S6.SS3.p1.4.m4.4.4.3.3.3.1">percent</csymbol><cn id="S6.SS3.p1.4.m4.4.4.3.3.3.2.cmml" type="float" xref="S6.SS3.p1.4.m4.4.4.3.3.3.2">32.90</cn></apply><apply id="S6.SS3.p1.4.m4.5.5.4.4.4.cmml" xref="S6.SS3.p1.4.m4.5.5.4.4.4"><csymbol cd="latexml" id="S6.SS3.p1.4.m4.5.5.4.4.4.1.cmml" xref="S6.SS3.p1.4.m4.5.5.4.4.4.1">percent</csymbol><cn id="S6.SS3.p1.4.m4.5.5.4.4.4.2.cmml" type="float" xref="S6.SS3.p1.4.m4.5.5.4.4.4.2">33.25</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.4.m4.5c">R_{s}=[0,25.16\%,31.39\%,32.90\%,33.25\%]</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.4.m4.5d">italic_R start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = [ 0 , 25.16 % , 31.39 % , 32.90 % , 33.25 % ]</annotation></semantics></math> for <math alttext="\mathcal{M}[j]\in\mathcal{M}" class="ltx_Math" display="inline" id="S6.SS3.p1.5.m5.1"><semantics id="S6.SS3.p1.5.m5.1a"><mrow id="S6.SS3.p1.5.m5.1.2" xref="S6.SS3.p1.5.m5.1.2.cmml"><mrow id="S6.SS3.p1.5.m5.1.2.2" xref="S6.SS3.p1.5.m5.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS3.p1.5.m5.1.2.2.2" xref="S6.SS3.p1.5.m5.1.2.2.2.cmml">ℳ</mi><mo id="S6.SS3.p1.5.m5.1.2.2.1" xref="S6.SS3.p1.5.m5.1.2.2.1.cmml">⁢</mo><mrow id="S6.SS3.p1.5.m5.1.2.2.3.2" xref="S6.SS3.p1.5.m5.1.2.2.3.1.cmml"><mo id="S6.SS3.p1.5.m5.1.2.2.3.2.1" stretchy="false" xref="S6.SS3.p1.5.m5.1.2.2.3.1.1.cmml">[</mo><mi id="S6.SS3.p1.5.m5.1.1" xref="S6.SS3.p1.5.m5.1.1.cmml">j</mi><mo id="S6.SS3.p1.5.m5.1.2.2.3.2.2" stretchy="false" xref="S6.SS3.p1.5.m5.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S6.SS3.p1.5.m5.1.2.1" xref="S6.SS3.p1.5.m5.1.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S6.SS3.p1.5.m5.1.2.3" xref="S6.SS3.p1.5.m5.1.2.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.5.m5.1b"><apply id="S6.SS3.p1.5.m5.1.2.cmml" xref="S6.SS3.p1.5.m5.1.2"><in id="S6.SS3.p1.5.m5.1.2.1.cmml" xref="S6.SS3.p1.5.m5.1.2.1"></in><apply id="S6.SS3.p1.5.m5.1.2.2.cmml" xref="S6.SS3.p1.5.m5.1.2.2"><times id="S6.SS3.p1.5.m5.1.2.2.1.cmml" xref="S6.SS3.p1.5.m5.1.2.2.1"></times><ci id="S6.SS3.p1.5.m5.1.2.2.2.cmml" xref="S6.SS3.p1.5.m5.1.2.2.2">ℳ</ci><apply id="S6.SS3.p1.5.m5.1.2.2.3.1.cmml" xref="S6.SS3.p1.5.m5.1.2.2.3.2"><csymbol cd="latexml" id="S6.SS3.p1.5.m5.1.2.2.3.1.1.cmml" xref="S6.SS3.p1.5.m5.1.2.2.3.2.1">delimited-[]</csymbol><ci id="S6.SS3.p1.5.m5.1.1.cmml" xref="S6.SS3.p1.5.m5.1.1">𝑗</ci></apply></apply><ci id="S6.SS3.p1.5.m5.1.2.3.cmml" xref="S6.SS3.p1.5.m5.1.2.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.5.m5.1c">\mathcal{M}[j]\in\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.5.m5.1d">caligraphic_M [ italic_j ] ∈ caligraphic_M</annotation></semantics></math>, which converges to <math alttext="\approx 0.33" class="ltx_Math" display="inline" id="S6.SS3.p1.6.m6.1"><semantics id="S6.SS3.p1.6.m6.1a"><mrow id="S6.SS3.p1.6.m6.1.1" xref="S6.SS3.p1.6.m6.1.1.cmml"><mi id="S6.SS3.p1.6.m6.1.1.2" xref="S6.SS3.p1.6.m6.1.1.2.cmml"></mi><mo id="S6.SS3.p1.6.m6.1.1.1" xref="S6.SS3.p1.6.m6.1.1.1.cmml">≈</mo><mn id="S6.SS3.p1.6.m6.1.1.3" xref="S6.SS3.p1.6.m6.1.1.3.cmml">0.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.6.m6.1b"><apply id="S6.SS3.p1.6.m6.1.1.cmml" xref="S6.SS3.p1.6.m6.1.1"><approx id="S6.SS3.p1.6.m6.1.1.1.cmml" xref="S6.SS3.p1.6.m6.1.1.1"></approx><csymbol cd="latexml" id="S6.SS3.p1.6.m6.1.1.2.cmml" xref="S6.SS3.p1.6.m6.1.1.2">absent</csymbol><cn id="S6.SS3.p1.6.m6.1.1.3.cmml" type="float" xref="S6.SS3.p1.6.m6.1.1.3">0.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.6.m6.1c">\approx 0.33</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.6.m6.1d">≈ 0.33</annotation></semantics></math> as <math alttext="j" class="ltx_Math" display="inline" id="S6.SS3.p1.7.m7.1"><semantics id="S6.SS3.p1.7.m7.1a"><mi id="S6.SS3.p1.7.m7.1.1" xref="S6.SS3.p1.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.7.m7.1b"><ci id="S6.SS3.p1.7.m7.1.1.cmml" xref="S6.SS3.p1.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.7.m7.1c">j</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.7.m7.1d">italic_j</annotation></semantics></math> gets larger and is consistent with our theoretical analysis in <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S4" title="4 fMRLRec Memory Efficiency ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Ablation Study</h3>
<figure class="ltx_figure" id="S6.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="350" id="S6.F4.g1" src="extracted/5896442/materials/fig_param_size.png" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>fMRL features a one-time training of model sizes <math alttext="\mathcal{M}=\{2,4,\ldots,2^{n}\}" class="ltx_Math" display="inline" id="S6.F4.3.m1.4"><semantics id="S6.F4.3.m1.4b"><mrow id="S6.F4.3.m1.4.4" xref="S6.F4.3.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.F4.3.m1.4.4.3" xref="S6.F4.3.m1.4.4.3.cmml">ℳ</mi><mo id="S6.F4.3.m1.4.4.2" xref="S6.F4.3.m1.4.4.2.cmml">=</mo><mrow id="S6.F4.3.m1.4.4.1.1" xref="S6.F4.3.m1.4.4.1.2.cmml"><mo id="S6.F4.3.m1.4.4.1.1.2" stretchy="false" xref="S6.F4.3.m1.4.4.1.2.cmml">{</mo><mn id="S6.F4.3.m1.1.1" xref="S6.F4.3.m1.1.1.cmml">2</mn><mo id="S6.F4.3.m1.4.4.1.1.3" xref="S6.F4.3.m1.4.4.1.2.cmml">,</mo><mn id="S6.F4.3.m1.2.2" xref="S6.F4.3.m1.2.2.cmml">4</mn><mo id="S6.F4.3.m1.4.4.1.1.4" xref="S6.F4.3.m1.4.4.1.2.cmml">,</mo><mi id="S6.F4.3.m1.3.3" mathvariant="normal" xref="S6.F4.3.m1.3.3.cmml">…</mi><mo id="S6.F4.3.m1.4.4.1.1.5" xref="S6.F4.3.m1.4.4.1.2.cmml">,</mo><msup id="S6.F4.3.m1.4.4.1.1.1" xref="S6.F4.3.m1.4.4.1.1.1.cmml"><mn id="S6.F4.3.m1.4.4.1.1.1.2" xref="S6.F4.3.m1.4.4.1.1.1.2.cmml">2</mn><mi id="S6.F4.3.m1.4.4.1.1.1.3" xref="S6.F4.3.m1.4.4.1.1.1.3.cmml">n</mi></msup><mo id="S6.F4.3.m1.4.4.1.1.6" stretchy="false" xref="S6.F4.3.m1.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F4.3.m1.4c"><apply id="S6.F4.3.m1.4.4.cmml" xref="S6.F4.3.m1.4.4"><eq id="S6.F4.3.m1.4.4.2.cmml" xref="S6.F4.3.m1.4.4.2"></eq><ci id="S6.F4.3.m1.4.4.3.cmml" xref="S6.F4.3.m1.4.4.3">ℳ</ci><set id="S6.F4.3.m1.4.4.1.2.cmml" xref="S6.F4.3.m1.4.4.1.1"><cn id="S6.F4.3.m1.1.1.cmml" type="integer" xref="S6.F4.3.m1.1.1">2</cn><cn id="S6.F4.3.m1.2.2.cmml" type="integer" xref="S6.F4.3.m1.2.2">4</cn><ci id="S6.F4.3.m1.3.3.cmml" xref="S6.F4.3.m1.3.3">…</ci><apply id="S6.F4.3.m1.4.4.1.1.1.cmml" xref="S6.F4.3.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S6.F4.3.m1.4.4.1.1.1.1.cmml" xref="S6.F4.3.m1.4.4.1.1.1">superscript</csymbol><cn id="S6.F4.3.m1.4.4.1.1.1.2.cmml" type="integer" xref="S6.F4.3.m1.4.4.1.1.1.2">2</cn><ci id="S6.F4.3.m1.4.4.1.1.1.3.cmml" xref="S6.F4.3.m1.4.4.1.1.1.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.3.m1.4d">\mathcal{M}=\{2,4,\ldots,2^{n}\}</annotation><annotation encoding="application/x-llamapun" id="S6.F4.3.m1.4e">caligraphic_M = { 2 , 4 , … , 2 start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT }</annotation></semantics></math> that saves <math alttext="\approx 33\%" class="ltx_Math" display="inline" id="S6.F4.4.m2.1"><semantics id="S6.F4.4.m2.1b"><mrow id="S6.F4.4.m2.1.1" xref="S6.F4.4.m2.1.1.cmml"><mi id="S6.F4.4.m2.1.1.2" xref="S6.F4.4.m2.1.1.2.cmml"></mi><mo id="S6.F4.4.m2.1.1.1" xref="S6.F4.4.m2.1.1.1.cmml">≈</mo><mrow id="S6.F4.4.m2.1.1.3" xref="S6.F4.4.m2.1.1.3.cmml"><mn id="S6.F4.4.m2.1.1.3.2" xref="S6.F4.4.m2.1.1.3.2.cmml">33</mn><mo id="S6.F4.4.m2.1.1.3.1" xref="S6.F4.4.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F4.4.m2.1c"><apply id="S6.F4.4.m2.1.1.cmml" xref="S6.F4.4.m2.1.1"><approx id="S6.F4.4.m2.1.1.1.cmml" xref="S6.F4.4.m2.1.1.1"></approx><csymbol cd="latexml" id="S6.F4.4.m2.1.1.2.cmml" xref="S6.F4.4.m2.1.1.2">absent</csymbol><apply id="S6.F4.4.m2.1.1.3.cmml" xref="S6.F4.4.m2.1.1.3"><csymbol cd="latexml" id="S6.F4.4.m2.1.1.3.1.cmml" xref="S6.F4.4.m2.1.1.3.1">percent</csymbol><cn id="S6.F4.4.m2.1.1.3.2.cmml" type="integer" xref="S6.F4.4.m2.1.1.3.2">33</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.4.m2.1d">\approx 33\%</annotation><annotation encoding="application/x-llamapun" id="S6.F4.4.m2.1e">≈ 33 %</annotation></semantics></math> parameters compared to training every size independently.</figcaption>
</figure>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">In this section, we further evaluate the designs of features and modules of fMRLRec by a series of ablation studies in <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S6.T3" title="In 6.2 fMRLRec Model-Series Performance ‣ 6 Experimental Results ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">3</span></a>. Specifically, we construct different variants of fMRLRec as: (1) fMRLRec w/ Language only: the fMRLRec model with only the text-based attributes of items such as Title, brand, etc. and their corresponding embeddings. (2) fMRLRec w/ Image only: the fMRLRec model only with the image processor and embeddings. (3) fMRLRec w/o Language &amp; Image: fMRLRec removing all the language and image related feature processing and embeddings. A randomly initialized embedding table is used as item representations. We monitor the change of NDCG and Recall of above variants. In particular, (1) Language features show a predominant contribution for the overall performance as removing language features (fMRLRec w/ Image only) induces the largest performance drop of 12.45%. (2) Image feature also constitute a vital but relatively lighter contribution compared with language features with a performance drop of 10.67% when removed (fMRLRec w/ Lang. only); (3) Losing both image and language features induces the largest performance drop of 58.35% which justifies contributions of both modalities; In summary, our ablation results show that both language and image feature processing and fusion are effective towards improving the recommendation performance of fMRLRec.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusions</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this work, we introduce a lightweight framework fMRLRec for efficient multimodal recommendation across multiple granularities. In particular, we adopt Matryoshka representation learning and design an efficient linear transformation to embeds smaller features into larger ones. Moreover, we incorporate cross-modal features and further improves the state-space modeling for sequential recommendation. Consequently, fMRLRec can yield multiple model sizes with competitive performance within a single training session. To validate the effectiveness and efficiency of fMRLRec, we conducted extensive experiments, where fMRLRec consistently demonstrate the superior performance over state-of-the-art baseline models.</p>
</div>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Limitations</h2>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">We have discussed the the ability of fMRLRec to perform one-time training and yield models in multiples sizes ready for deployment. However, we have not experimented on other recommendation tasks such as click rate prediction and multi-basket recommendation, etc. Even though we adopted LRU, a state-of-the-art recommendation module for fMRLRec, other types of sequential/non-sequential models needs to be tested for a more compete performance pattern. More broadly, The idea of full-Scale Matryoshka Representation Learning (fMRL) can be applied to other ML domains that utilize neural network weights; We have yet to explore behaviors of fMRL in those fields where the scale of models and data varies significantly. We plan to conduct more theoretical analysis and experiments for above mentioned aspects in future works.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al. (2024)</span>
<span class="ltx_bibblock">
Mu Cai, Jianwei Yang, Jianfeng Gao, and Yong Jae Lee. 2024.

</span>
<span class="ltx_bibblock">Matryoshka multimodal models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2405.17430</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen (2023)</span>
<span class="ltx_bibblock">
Zheng Chen. 2023.

</span>
<span class="ltx_bibblock">Palr: Personalization aware llms for recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2305.07622</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al. (2023)</span>
<span class="ltx_bibblock">
Shijie Geng, Juntao Tan, Shuchang Liu, Zuohui Fu, and Yongfeng Zhang. 2023.

</span>
<span class="ltx_bibblock">Vip5: Towards multimodal foundation models for recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2305.14302</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu and Dao (2023)</span>
<span class="ltx_bibblock">
Albert Gu and Tri Dao. 2023.

</span>
<span class="ltx_bibblock">Mamba: Linear-time sequence modeling with selective state spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2312.00752</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2021)</span>
<span class="ltx_bibblock">
Jialiang Han, Yun Ma, Qiaozhu Mei, and Xuanzhe Liu. 2021.

</span>
<span class="ltx_bibblock">Deeprec: On-device deep learning for privacy-preserving sequential recommendation in mobile commerce.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the Web Conference 2021</em>, pages 900–911.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and McAuley (2016a)</span>
<span class="ltx_bibblock">
Ruining He and Julian McAuley. 2016a.

</span>
<span class="ltx_bibblock">Ups and downs: Modeling the visual evolution of fashion trends with one-class collaborative filtering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">proceedings of the 25th international conference on world wide web</em>, pages 507–517.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and McAuley (2016b)</span>
<span class="ltx_bibblock">
Ruining He and Julian McAuley. 2016b.

</span>
<span class="ltx_bibblock">Vbpr: visual bayesian personalized ranking from implicit feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, volume 30.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al. (2023)</span>
<span class="ltx_bibblock">
Yupeng Hou, Zhankui He, Julian McAuley, and Wayne Xin Zhao. 2023.

</span>
<span class="ltx_bibblock">Learning vector-quantized item representation for transferable sequential recommenders.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the ACM Web Conference 2023</em>, pages 1162–1171.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al. (2022)</span>
<span class="ltx_bibblock">
Yupeng Hou, Shanlei Mu, Wayne Xin Zhao, Yaliang Li, Bolin Ding, and Ji-Rong Wen. 2022.

</span>
<span class="ltx_bibblock">Towards universal sequence representation learning for recommender systems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, pages 585–593.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2024)</span>
<span class="ltx_bibblock">
Wenbo Hu, Zi-Yi Dou, Liunian Harold Li, Amita Kamath, Nanyun Peng, and Kai-Wei Chang. 2024.

</span>
<span class="ltx_bibblock">Matryoshka query transformer for large vision-language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2405.19315</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">2018 IEEE international conference on data mining (ICDM)</em>, pages 197–206. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaplan et al. (2020)</span>
<span class="ltx_bibblock">
Jared Kaplan, Sam McCandlish, Tom Henighan, Tom B Brown, Benjamin Chess, Rewon Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei. 2020.

</span>
<span class="ltx_bibblock">Scaling laws for neural language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2001.08361</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kusupati et al. (2022)</span>
<span class="ltx_bibblock">
Aditya Kusupati, Gantavya Bhatt, Aniket Rege, Matthew Wallingford, Aditya Sinha, Vivek Ramanujan, William Howard-Snyder, Kaifeng Chen, Sham Kakade, Prateek Jain, et al. 2022.

</span>
<span class="ltx_bibblock">Matryoshka representation learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Advances in Neural Information Processing Systems</em>, 35:30233–30249.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023a)</span>
<span class="ltx_bibblock">
Jiacheng Li, Ming Wang, Jin Li, Jinmiao Fu, Xin Shen, Jingbo Shang, and Julian McAuley. 2023a.

</span>
<span class="ltx_bibblock">Text is all you need: Learning language representations for sequential recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2305.13731</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023b)</span>
<span class="ltx_bibblock">
Jinming Li, Wentao Zhang, Tian Wang, Guanglei Xiong, Alan Lu, and Gerard Medioni. 2023b.

</span>
<span class="ltx_bibblock">Gpt4rec: A generative framework for personalized recommendation and user interests interpretation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2304.03879</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024)</span>
<span class="ltx_bibblock">
Xianming Li, Zongxi Li, Jing Li, Haoran Xie, and Qing Li. 2024.

</span>
<span class="ltx_bibblock">2d matryoshka sentence embeddings.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2402.14776</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023)</span>
<span class="ltx_bibblock">
Haotian Liu, Chunyuan Li, Qingyang Wu, and Yong Jae Lee. 2023.

</span>
<span class="ltx_bibblock">Visual instruction tuning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2304.08485</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. (2023)</span>
<span class="ltx_bibblock">
Sichun Luo, Bowei He, Haohan Zhao, Yinya Huang, Aojun Zhou, Zongpeng Li, Yuanzhang Xiao, Mingjie Zhan, and Linqi Song. 2023.

</span>
<span class="ltx_bibblock">Recranker: Instruction tuning large language model as ranker for top-k recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2312.16018</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. (2022)</span>
<span class="ltx_bibblock">
Sichun Luo, Yuanzhang Xiao, and Linqi Song. 2022.

</span>
<span class="ltx_bibblock">Personalized federated recommendation via joint representation learning, user clustering, and model adaptation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the 31st ACM international conference on information &amp; knowledge management</em>, pages 4289–4293.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McAuley et al. (2015)</span>
<span class="ltx_bibblock">
Julian McAuley, Christopher Targett, Qinfeng Shi, and Anton Van Den Hengel. 2015.

</span>
<span class="ltx_bibblock">Image-based recommendations on styles and substitutes.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 38th international ACM SIGIR conference on research and development in information retrieval</em>, pages 43–52.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI. 2023.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">ArXiv</em>, abs/2303.08774.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Orvieto et al. (2023)</span>
<span class="ltx_bibblock">
Antonio Orvieto, Samuel L Smith, Albert Gu, Anushan Fernando, Caglar Gulcehre, Razvan Pascanu, and Soham De. 2023.

</span>
<span class="ltx_bibblock">Resurrecting recurrent neural networks for long sequences.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2303.06349</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reid et al. (2024)</span>
<span class="ltx_bibblock">
Machel Reid, Nikolay Savinov, Denis Teplyashin, Dmitry Lepikhin, Timothy Lillicrap, Jean-baptiste Alayrac, Radu Soricut, Angeliki Lazaridou, Orhan Firat, Julian Schrittwieser, et al. 2024.

</span>
<span class="ltx_bibblock">Gemini 1.5: Unlocking multimodal understanding across millions of tokens of context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2403.05530</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">Bert4rec: Sequential recommendation with bidirectional encoder representations from transformer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>, pages 1441–1450.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tao et al. (2020)</span>
<span class="ltx_bibblock">
Zhulin Tao, Yinwei Wei, Xiang Wang, Xiangnan He, Xianglin Huang, and Tat-Seng Chua. 2020.

</span>
<span class="ltx_bibblock">Mgat: Multimodal graph attention network for recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Information Processing &amp; Management</em>, 57(5):102277.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al. 2023.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2307.09288</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023)</span>
<span class="ltx_bibblock">
Jinpeng Wang, Ziyun Zeng, Yunxiao Wang, Yuting Wang, Xingyu Lu, Tianxiang Li, Jun Yuan, Rui Zhang, Hai-Tao Zheng, and Shu-Tao Xia. 2023.

</span>
<span class="ltx_bibblock">Missrec: Pre-training and transferring multi-modal interest-aware sequence representation for recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the 31st ACM International Conference on Multimedia</em>, pages 6548–6557.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024)</span>
<span class="ltx_bibblock">
Yueqi Wang, Zhankui He, Zhenrui Yue, Julian McAuley, and Dong Wang. 2024.

</span>
<span class="ltx_bibblock">Auto-encoding or auto-regression? a reality check on causality of self-attention-based sequential recommenders.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2406.02048</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2024a)</span>
<span class="ltx_bibblock">
Tianxin Wei, Bowen Jin, Ruirui Li, Hansi Zeng, Zhengyang Wang, Jianhui Sun, Qingyu Yin, Hanqing Lu, Suhang Wang, Jingrui He, et al. 2024a.

</span>
<span class="ltx_bibblock">Towards unified multi-modal personalization: Large vision-language models for generative recommendation and beyond.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:2403.10667</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2023)</span>
<span class="ltx_bibblock">
Wei Wei, Chao Huang, Lianghao Xia, and Chuxu Zhang. 2023.

</span>
<span class="ltx_bibblock">Multi-modal self-supervised learning for recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the ACM Web Conference 2023</em>, pages 790–800.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2024b)</span>
<span class="ltx_bibblock">
Wei Wei, Xubin Ren, Jiabin Tang, Qinyong Wang, Lixin Su, Suqi Cheng, Junfeng Wang, Dawei Yin, and Chao Huang. 2024b.

</span>
<span class="ltx_bibblock">Llmrec: Large language models with graph augmentation for recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 17th ACM International Conference on Web Search and Data Mining</em>, pages 806–815.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2019)</span>
<span class="ltx_bibblock">
Yinwei Wei, Xiang Wang, Liqiang Nie, Xiangnan He, Richang Hong, and Tat-Seng Chua. 2019.

</span>
<span class="ltx_bibblock">Mmgcn: Multi-modal graph convolution network for personalized recommendation of micro-video.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 27th ACM international conference on multimedia</em>, pages 1437–1445.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xia et al. (2023)</span>
<span class="ltx_bibblock">
Xin Xia, Junliang Yu, Qinyong Wang, Chaoqun Yang, Nguyen Quoc Viet Hung, and Hongzhi Yin. 2023.

</span>
<span class="ltx_bibblock">Efficient on-device session-based recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">ACM Transactions on Information Systems</em>, 41(4):1–24.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2024)</span>
<span class="ltx_bibblock">
Shitao Xiao, Zheng Liu, Peitian Zhang, Niklas Muennighoff, Defu Lian, and Jian-Yun Nie. 2024.

</span>
<span class="ltx_bibblock">C-pack: Packed resources for general chinese embeddings.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, pages 641–649.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2024)</span>
<span class="ltx_bibblock">
Lanling Xu, Junjie Zhang, Bingqian Li, Jinpeng Wang, Mingchen Cai, Wayne Xin Zhao, and Ji-Rong Wen. 2024.

</span>
<span class="ltx_bibblock">Prompting large language models for recommender systems: A comprehensive framework and empirical analysis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2401.04997</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et al. (2023)</span>
<span class="ltx_bibblock">
Zhenrui Yue, Sara Rabhi, Gabriel de Souza Pereira Moreira, Dong Wang, and Even Oldridge. 2023.

</span>
<span class="ltx_bibblock">Llamarec: Two-stage recommendation using large language models for ranking.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2311.02089</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et al. (2024)</span>
<span class="ltx_bibblock">
Zhenrui Yue, Yueqi Wang, Zhankui He, Huimin Zeng, Julian McAuley, and Dong Wang. 2024.

</span>
<span class="ltx_bibblock">Linear recurrent units for sequential recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the 17th ACM International Conference on Web Search and Data Mining</em>, pages 930–938.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et al. (2022)</span>
<span class="ltx_bibblock">
Zhenrui Yue, Huimin Zeng, Ziyi Kou, Lanyu Shang, and Dong Wang. 2022.

</span>
<span class="ltx_bibblock">Defending substitution-based profile pollution attacks on sequential recommenders.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the 16th ACM Conference on Recommender Systems</em>, pages 59–70.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeng et al. (2024)</span>
<span class="ltx_bibblock">
Huimin Zeng, Zhenrui Yue, Qian Jiang, and Dong Wang. 2024.

</span>
<span class="ltx_bibblock">Federated recommendation via hybrid retrieval augmented generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:2403.04256</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhai et al. (2023)</span>
<span class="ltx_bibblock">
Xiaohua Zhai, Basil Mustafa, Alexander Kolesnikov, and Lucas Beyer. 2023.

</span>
<span class="ltx_bibblock">Sigmoid loss for language image pre-training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pages 11975–11986.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2022)</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Yu, Wayne Xin Zhao, and Ji-Rong Wen. 2022.

</span>
<span class="ltx_bibblock">Filter-enhanced mlp is all you need for sequential recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Proceedings of the ACM web conference 2022</em>, pages 2388–2399.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Baselines</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">We select multiple state-of-the-art baselines to compare with fMRLRec. In particular, we adopt <span class="ltx_text ltx_font_italic" id="A1.SS1.p1.1.1">ID-based</span> SASRec, BERT4Rec, FMLP-Rec and LRURec <cite class="ltx_cite ltx_citemacro_cite">Kang and McAuley (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib11" title="">2018</a>); Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib24" title="">2019</a>); Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib41" title="">2022</a>); Yue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib37" title="">2024</a>)</cite>, text-based UniSRec, VQRec and RecFormer <cite class="ltx_cite ltx_citemacro_cite">Hou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib9" title="">2022</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib8" title="">2023</a>); Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib14" title="">2023a</a>)</cite>, and multimodal baselines MMSSL, VIP5 <cite class="ltx_cite ltx_citemacro_cite">Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib30" title="">2023</a>); Geng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib3" title="">2023</a>)</cite>. We report the details of baseline methods:</p>
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i1.p1">
<p class="ltx_p" id="A1.I1.i1.p1.1"><em class="ltx_emph ltx_font_italic" id="A1.I1.i1.p1.1.1">Self-Attentive Sequential Recommendation (SASRec)</em> is the first transformer-based sequential recommender. SASRec uses unidirectional self-attention to capture transition patterns <cite class="ltx_cite ltx_citemacro_cite">Kang and McAuley (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib11" title="">2018</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i2.p1">
<p class="ltx_p" id="A1.I1.i2.p1.1"><em class="ltx_emph ltx_font_italic" id="A1.I1.i2.p1.1.1">Bidirectional Encoder Representations from Transformers for Sequential Recommendation (BERT4Rec)</em> is similar to SASRec but utilizes bidirectional self-attention. BERT4Rec learns via masked training <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib24" title="">2019</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i3.p1">
<p class="ltx_p" id="A1.I1.i3.p1.1"><em class="ltx_emph ltx_font_italic" id="A1.I1.i3.p1.1.1">Filter-enhanced MLP for Recommendation (FMLP-Rec)</em> also adopts an all-MLP architecture with filter-enhanced layers. FMLP-Rec also applies Fast Fourier Transform (FFT) to improve representation learning <cite class="ltx_cite ltx_citemacro_cite">Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib41" title="">2022</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i4.p1">
<p class="ltx_p" id="A1.I1.i4.p1.1"><em class="ltx_emph ltx_font_italic" id="A1.I1.i4.p1.1.1">Linear Recurrence Units for Sequential Recommendation (LRURec)</em> is based on linear recurrence and is optimized for parallelized training. LRURec thus provides both efficient training and inference speed <cite class="ltx_cite ltx_citemacro_cite">Yue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib37" title="">2024</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i5.p1">
<p class="ltx_p" id="A1.I1.i5.p1.1"><em class="ltx_emph ltx_font_italic" id="A1.I1.i5.p1.1.1">Universal Sequence Representation for Recommender Systems (UniSRec)</em> is a text-based recommender system. UniSRec leverage pretrained language models to generate item features for next-item prediction <cite class="ltx_cite ltx_citemacro_cite">Hou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib9" title="">2022</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i6.p1">
<p class="ltx_p" id="A1.I1.i6.p1.1"><em class="ltx_emph ltx_font_italic" id="A1.I1.i6.p1.1.1">Vector-Quantized Item Representation for Sequential Recommenders (VQRec)</em> is also text-based sequential recommender. VQRec quantizes language model-based item features to improve performance <cite class="ltx_cite ltx_citemacro_cite">Hou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib8" title="">2023</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i7.p1">
<p class="ltx_p" id="A1.I1.i7.p1.1"><em class="ltx_emph ltx_font_italic" id="A1.I1.i7.p1.1.1">Language Representations for Sequential Recommendation (RecFormer)</em> is language model-based architecture for recommendation. RecFormer adopts contrastive learning to improve item representation <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib14" title="">2023a</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i8.p1">
<p class="ltx_p" id="A1.I1.i8.p1.1"><em class="ltx_emph ltx_font_italic" id="A1.I1.i8.p1.1.1">Multi-Modal Self-Supervised Learning for Recommendation (MMSSL)</em> is a multimodal recommender using graphs and multimodal item features for recommendation. MMSSL is trained in a self-supervised fashion <cite class="ltx_cite ltx_citemacro_cite">Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib30" title="">2023</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i9" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i9.p1">
<p class="ltx_p" id="A1.I1.i9.p1.1"><em class="ltx_emph ltx_font_italic" id="A1.I1.i9.p1.1.1">Multimodal Foundation Models for Recommendation (VIP5)</em> is a multimodal recommender using item IDs and multimodal attributes for multi-taks recommendation. VIP5 is trained via conditional generation <cite class="ltx_cite ltx_citemacro_cite">Geng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib3" title="">2023</a>)</cite>.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="A1.SS1.p1.2">All models are trained according to the methodologies described in the original works, with unspecified hyperparameters used as recommended. All baseline methods and fMRLRec are evaluated under identical conditions.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Implementations</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">We discuss further implementation details other than data processing, evaluation metrics, early stopping, etc., as already reported in section <a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#S5" title="5 Experimental Setup ‣ Train Once, Deploy Anywhere: Matryoshka Representation Learning for Multimodal Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>. We adopt pretrained BAAI/bge-large-en-v1.5 <cite class="ltx_cite ltx_citemacro_cite">Xiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib34" title="">2024</a>)</cite> and SigLip <cite class="ltx_cite ltx_citemacro_cite">Zhai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.16627v2#bib.bib40" title="">2023</a>)</cite> for language and image encoding; The tuning phase basically lasts for 5-6 hours on a single NVIDIA-A100 (40GB) GPU. For hyperparameters, we find the most sensitive ones towards performance as follows and report the best hyper-parameters found:</p>
<ul class="ltx_itemize" id="A1.I2">
<li class="ltx_item" id="A1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i1.p1">
<p class="ltx_p" id="A1.I2.i1.p1.1">Embedding/model size: We grid-search Embedding/model size among [64, 128, 256, 512, 1024, 2048], the best performing values is 1024 for all datasets, namely Beauty, Clothing, Sport and Toys. This shows that our fMRLRec scales well to large dimensions of pretrained vision/language models with effective modality alignment.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i2.p1">
<p class="ltx_p" id="A1.I2.i2.p1.1">The number of fMRLRec-based LRU layers: We grid-search the number of layers among [1,2,4,8]. The best performing value is 2 for all datasets.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i3.p1">
<p class="ltx_p" id="A1.I2.i3.p1.1">Dropout rate: We grid-search the dropout rate among [0.1,0,2, …, 0.8] on a 0.1-stride. We find dropout rates, 0.5 or 0.6, is typically optimal for all datasets.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i4.p1">
<p class="ltx_p" id="A1.I2.i4.p1.1">Weight decay: We grid-search the weight decay among [1e-6, 1e-4, 1e-2] and finds 1e-2 to be the best performing value.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i5.p1">
<p class="ltx_p" id="A1.I2.i5.p1.1">Radius of ring-initialization: For ring initialization of LRU layers, We grid-search the minimum radius of the ring in [0.0,…,0.5] on a 0.1-stride and set the maximum radius to the minimum radius plus 0.1. The best minimum radius is 0.0, 0.1, 0.1, 0.0 for Beauty, Clothing, Sports, Toys, respectively.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct  2 15:57:49 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
