<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2409.13148] UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition</title><meta property="og:description" content="In the digital era, table structure recognition technology is a critical tool for processing and analyzing large volumes of tabular data. Previous methods primarily focus on visual aspects of table structure recovery b…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2409.13148">

<!--Generated on Sun Oct  6 01:30:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">UniTabNet: Bridging Vision and Language Models for Enhanced 
<br class="ltx_break">Table Structure Recognition</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id1.1.id1" class="ltx_text ltx_font_bold">Zhenrong Zhang<sup id="id1.1.id1.1" class="ltx_sup">1</sup><span id="footnotex1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span id="footnotex1.1.1.1" class="ltx_text ltx_font_medium">1</span></span>Equal contribution.</span></span></span></span>,
<span id="id2.2.id2" class="ltx_text ltx_font_bold">Shuhang Liu<sup id="id2.2.id2.1" class="ltx_sup">1</sup><span id="footnotex2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span id="footnotex2.1.1.1" class="ltx_text ltx_font_medium">1</span></span>Equal contribution.</span></span></span></span>,
<span id="id3.3.id3" class="ltx_text ltx_font_bold">Pengfei Hu<sup id="id3.3.id3.1" class="ltx_sup">1</sup></span>,
<span id="id4.4.id4" class="ltx_text ltx_font_bold">Jiefeng Ma<sup id="id4.4.id4.1" class="ltx_sup">1</sup></span>,

<br class="ltx_break"><span id="id5.5.id5" class="ltx_text ltx_font_bold">Jun Du<sup id="id5.5.id5.1" class="ltx_sup">1</sup><span id="footnotex3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span id="footnotex3.1.1.1" class="ltx_text ltx_font_medium">2</span></span>Correspondence author. <a href="mailto:jundu@ustc.edu.cn" title="" class="ltx_ref ltx_href ltx_font_medium">jundu@ustc.edu.cn</a></span></span></span></span>,
<span id="id6.6.id6" class="ltx_text ltx_font_bold">Jianshu Zhang<sup id="id6.6.id6.1" class="ltx_sup">2</sup></span>,
<span id="id7.7.id7" class="ltx_text ltx_font_bold">Yu Hu<sup id="id7.7.id7.1" class="ltx_sup">2</sup></span>

<br class="ltx_break"><sup id="id8.8.id8" class="ltx_sup">1</sup>University of Science and Technology of China,
<sup id="id9.9.id9" class="ltx_sup">2</sup>iFLYTEK AI Research
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id10.id1" class="ltx_p">In the digital era, table structure recognition technology is a critical tool for processing and analyzing large volumes of tabular data. Previous methods primarily focus on visual aspects of table structure recovery but often fail to effectively comprehend the textual semantics within tables, particularly for descriptive textual cells. In this paper, we introduce UniTabNet, a novel framework for table structure parsing based on the image-to-text model. UniTabNet employs a “divide-and-conquer” strategy, utilizing an image-to-text model to decouple table cells and integrating both physical and logical decoders to reconstruct the complete table structure. We further enhance our framework with the Vision Guider, which directs the model’s focus towards pertinent areas, thereby boosting prediction accuracy. Additionally, we introduce the Language Guider to refine the model’s capability to understand textual semantics in table images. Evaluated on prominent table structure datasets such as PubTabNet, PubTables1M, WTW, and iFLYTAB, UniTabNet achieves a new state-of-the-art performance, demonstrating the efficacy of our approach. The code will also be made publicly available.</p>
</div>
<div id="p1" class="ltx_para ltx_noindent">
<div id="p1.1" class="ltx_block ltx_align_bottom">
<p id="p1.1.1" class="ltx_p"><span id="p1.1.1.1" class="ltx_text ltx_font_bold">UniTabNet: Bridging Vision and Language Models for Enhanced 
<br class="ltx_break">Table Structure Recognition</span></p>
<br class="ltx_break ltx_centering">
<p id="p1.1.2" class="ltx_p ltx_align_center" style="width:433.6pt;"><span id="p1.1.2.1" class="ltx_text ltx_inline-block" style="width:0.0pt;">
<span id="p1.1.2.1.1" class="ltx_tabular ltx_align_top">
<span class="ltx_tbody">
<span id="p1.1.2.1.1.1.1" class="ltx_tr">
<span id="p1.1.2.1.1.1.1.1" class="ltx_td ltx_align_center"><span id="p1.1.2.1.1.1.1.1.1" class="ltx_text ltx_font_bold">
Zhenrong Zhang<sup id="p1.1.2.1.1.1.1.1.1.1" class="ltx_sup">1</sup><span id="footnotex4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span id="footnotex4.1.1.1" class="ltx_text ltx_font_medium">1</span></span>Equal contribution.</span></span></span>,
Shuhang Liu<sup id="p1.1.2.1.1.1.1.1.1.2" class="ltx_sup">1</sup><span id="footnotex5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span id="footnotex5.1.1.1" class="ltx_text ltx_font_medium">1</span></span>Equal contribution.</span></span></span>,
Pengfei Hu<sup id="p1.1.2.1.1.1.1.1.1.3" class="ltx_sup">1</sup>,
Jiefeng Ma<sup id="p1.1.2.1.1.1.1.1.1.4" class="ltx_sup">1</sup>,</span></span></span>
<span id="p1.1.2.1.1.2.2" class="ltx_tr">
<span id="p1.1.2.1.1.2.2.1" class="ltx_td ltx_align_center"><span id="p1.1.2.1.1.2.2.1.1" class="ltx_text ltx_font_bold">Jun Du<sup id="p1.1.2.1.1.2.2.1.1.1" class="ltx_sup">1</sup><span id="footnotex6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span id="footnotex6.1.1.1" class="ltx_text ltx_font_medium">2</span></span>Correspondence author. <a href="mailto:jundu@ustc.edu.cn" title="" class="ltx_ref ltx_href ltx_font_medium">jundu@ustc.edu.cn</a></span></span></span></span>,
<span id="p1.1.2.1.1.2.2.1.2" class="ltx_text ltx_font_bold">Jianshu Zhang<sup id="p1.1.2.1.1.2.2.1.2.1" class="ltx_sup">2</sup></span>,
<span id="p1.1.2.1.1.2.2.1.3" class="ltx_text ltx_font_bold">Yu Hu<sup id="p1.1.2.1.1.2.2.1.3.1" class="ltx_sup">2</sup></span></span></span>
<span id="p1.1.2.1.1.3.3" class="ltx_tr">
<span id="p1.1.2.1.1.3.3.1" class="ltx_td ltx_align_center"><sup id="p1.1.2.1.1.3.3.1.1" class="ltx_sup">1</sup>University of Science and Technology of China,
<sup id="p1.1.2.1.1.3.3.1.2" class="ltx_sup">2</sup>iFLYTEK AI Research,</span></span>
</span>
</span></span></p>
<br class="ltx_break ltx_centering">
</div>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">In this era of knowledge and information, documents serve as crucial repositories for various cognitive processes, including the creation of knowledge databases, optical character recognition (OCR), and document retrieval. Among the various document elements, tabular structures are particularly notable. These structures distill complex information into a concise format, playing a pivotal role in fields such as finance, administration, research, and archival management <cite class="ltx_cite ltx_citemacro_citep">(Zanibbi et al., <a href="#bib.bib35" title="" class="ltx_ref">2004</a>)</cite>. Table structure recognition (TSR) focuses on converting these tabular structures into machine-readable data, facilitating their interpretation and utilization. Therefore, TSR as a precursor to contextual document understanding will be beneficial in a wide range of applications <cite class="ltx_cite ltx_citemacro_citep">(Siddiqui et al., <a href="#bib.bib27" title="" class="ltx_ref">2018</a>; Schreiber et al., <a href="#bib.bib26" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2409.13148/assets/01_problem.png" id="S1.F1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="245" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The illustration of the rich textual features in tabular images. (a) displays the original tabular image. (b) and (c) provide zoomed-in views of the area outlined by the red dashed box in (a). (b) shows the prediction result of the recent state-of-the-art table structure recognition method SEMv2<cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib36" title="" class="ltx_ref">2024</a>)</cite>. (c) presents the ground truth label for table structure. The red dashed box highlights the discrepancy between the prediction and the ground truth label.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Table images efficiently convey information through visual clues, layout structures, and plain text. However, most previous methods<cite class="ltx_cite ltx_citemacro_citep">(Chi et al., <a href="#bib.bib3" title="" class="ltx_ref">2019</a>; Long et al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>; Zhang et al., <a href="#bib.bib36" title="" class="ltx_ref">2024</a>)</cite> in TSR primarily utilize visual or spatial features, neglecting the textual content within each table cell. The structures of some tables exhibit inherent ambiguities when assessed solely based on visual appearance, especially for wireless tables which contain cells with descriptive content, as illustrated in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. To enhance accuracy in TSR, it is crucial to leverage the cross-modality characteristics of visually-rich table images by jointly modeling both visual and textual information <cite class="ltx_cite ltx_citemacro_citep">(Peng et al., <a href="#bib.bib22" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Recent advancements in document understanding, exemplified by methods such as Donut <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite> and Pix2Struct <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a href="#bib.bib11" title="" class="ltx_ref">2023</a>)</cite>, have embraced an end-to-end image-to-text paradigm. These approaches leverage the Transformer architecture <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib31" title="" class="ltx_ref">2017</a>)</cite> during pre-training to decode OCR results, demonstrating superior perception of image content. By diminishing reliance on traditional OCR engines, they exhibit remarkable adaptability across diverse document understanding tasks, highlighting their robust ability to comprehend text embedded in images. Despite these advancements, the application of this framework to TSR remains unexplored. While there are related works <cite class="ltx_cite ltx_citemacro_citep">(Nassar et al., <a href="#bib.bib20" title="" class="ltx_ref">2022</a>; Huang et al., <a href="#bib.bib6" title="" class="ltx_ref">2023</a>)</cite> that employ this framework, they primarily focus on reconstructing table structures from a visual perspective, without adequately addressing the depth of textual understanding in images.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this work, we adopt the image-to-text framework and introduce a visually linguistic unified model for TSR, named UniTabNet. This model is built on a “divide and conquer” design philosophy, initially using the image-to-text model to decouple table cells. According to the attributes of the table structure <cite class="ltx_cite ltx_citemacro_citep">(Zanibbi et al., <a href="#bib.bib35" title="" class="ltx_ref">2004</a>)</cite>, the decoupled cells contain two types of attributes: logical and physical. The logical attributes cover the row and column span information of each cell, while the physical attributes include the bounding box coordinates of the cells. To parse these attributes independently, we design a logical decoder and a physical decoder. Since table images differ significantly from regular document images, each step of the decoding output is grounded in a clear visual basis, specifically visual cues from rows, columns, and cells. Therefore, we design a Vision Guider module, which directs the model to focus on relevant areas and make more precise predictions. Furthermore, to enhance the UniTabNet’s understanding of text content in images, we develop a Language Guider. This module enables the model to perceive the corresponding text content at each decoding step, thereby understanding the textual semantics within the image. Experimental results on multiple public TSR datasets, such as PubTables1M <cite class="ltx_cite ltx_citemacro_citep">(Smock et al., <a href="#bib.bib28" title="" class="ltx_ref">2022</a>)</cite>, PubTabNet <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al., <a href="#bib.bib38" title="" class="ltx_ref">2020a</a>)</cite>, iFLYTAB <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib36" title="" class="ltx_ref">2024</a>)</cite>, and WTW <cite class="ltx_cite ltx_citemacro_cite">Long et al. (<a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>, demonstrate that our approach achieves state-of-the-art performance, validating the effectiveness of our method.
The main contributions of this paper are as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We introduce UniTabNet, a unified visually linguistic model for TSR that adheres the “divide and conquer” strategy by first separating table cells, then using both logical and physical decoders to reconstruct the table structure.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We develop the Vision Guider module, designed to direct the model’s focus towards critical areas such as rows and columns, thereby enhancing the overall prediction accuracy.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We enhance UniTabNet with the Language Guider module, which enhances the model’s ability to perceive textual content within images, thereby improving its accuracy in predicting the structure of tables rich in descriptive content.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Based on our proposed method, we achieve state-of-the-art performance on publicly available datasets such as PubTabNet, PubTables1M, WTW and iFLYTAB.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Due to the rapid development of deep learning in documents, many deep learning-based TSR approaches have been presented. These methods can be roughly divided into three categories: bottom-up methods, split-and-merge based methods and image-to-text based methods.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">One group of bottom-up methods <cite class="ltx_cite ltx_citemacro_citep">(Chi et al., <a href="#bib.bib3" title="" class="ltx_ref">2019</a>; Xue et al., <a href="#bib.bib34" title="" class="ltx_ref">2019</a>; Liu et al., <a href="#bib.bib15" title="" class="ltx_ref">2022</a>)</cite> treat words or cell contents as nodes in a graph and use graph neural networks to predict whether each sampled node pair belongs to the same cell, row, or column. These methods depend on the availability of bounding boxes for words or cell contents as additional inputs, which are challenging to obtain directly from table images. To eliminate this assumption, another group of methods <cite class="ltx_cite ltx_citemacro_citep">(Raja et al., <a href="#bib.bib25" title="" class="ltx_ref">2020</a>; Qiao et al., <a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite> has proposed directly detecting the bounding boxes of table cells. After cell detection, they design some rules to cluster cells into rows and columns. However, these methods regard the cells as bounding box, which is difficult to handle the cells in distorted tables. Other methods <cite class="ltx_cite ltx_citemacro_citep">(Xing et al., <a href="#bib.bib33" title="" class="ltx_ref">2023</a>; Long et al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite> detect cells through detecting the corner points of cells, making them more suitable for handling distorted cells. Nevertheless, they suffer from tables containing a lot of empty cells and wireless tables.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Split-and-merge based methods initially split a table into basic grid pattern, followed by a merging process to reconstruct the table cells.
Previous methods <cite class="ltx_cite ltx_citemacro_citep">(Tensmeyer et al., <a href="#bib.bib30" title="" class="ltx_ref">2019</a>; Zhang et al., <a href="#bib.bib37" title="" class="ltx_ref">2022</a>)</cite> utilize semantic segmentation <cite class="ltx_cite ltx_citemacro_citep">(Long et al., <a href="#bib.bib17" title="" class="ltx_ref">2015</a>)</cite> for identifying rows, columns within tables in the “split” stage. However, segmenting table row/column separation lines in a pixel-wise manner is inaccurate due to the limited receptive field, and heuristic mask-to-line modules designed with strong assumptions in split stage make these methods work only on tables in digital documents. To enhance the accuracy of grid splitting in distorted tables, RobustTabNet <cite class="ltx_cite ltx_citemacro_citep">(Ma et al., <a href="#bib.bib19" title="" class="ltx_ref">2023</a>)</cite> uses a spatial CNN-based separation line predictor to propagate contextual information across the entire table image in both horizontal and vertical directions. SEMv2 <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib36" title="" class="ltx_ref">2024</a>)</cite> formulates the table separation line detection as the instance segmentation task. The table separation line can be accurately obtained by processing the table separation line mask in a row-wise/column-wise manner. TSRFormer with SepRETR <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite> formulates the table separation line prediction as a line regression problem and regresses separation line by DETR <cite class="ltx_cite ltx_citemacro_citep">(Carion et al., <a href="#bib.bib1" title="" class="ltx_ref">2020</a>)</cite>, but it can’t regress too long separation line well. TSRFormer with DQ-DETR <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib32" title="" class="ltx_ref">2023</a>)</cite> progressively regresses separation lines, which further enhances localization accuracy for distorted tables.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Image-to-text based methods conceptualize the structure of tables as sequential data (HTML or LaTeX), utilizing an end-to-end image-to-text paradigm to decode table structures. The EDD model <cite class="ltx_cite ltx_citemacro_cite">Zhong et al. (<a href="#bib.bib38" title="" class="ltx_ref">2020a</a>)</cite> employs an encoder-dual-decoder architecture to generate both the logical structure and the cell content. During the decoding phase, EDD utilizes two attention-based recurrent neural networks; one is tasked with decoding the structural code of the table, while the other decodes the content. Building on this framework, TableFormer <cite class="ltx_cite ltx_citemacro_cite">Nassar et al. (<a href="#bib.bib20" title="" class="ltx_ref">2022</a>)</cite> employs a transformer-based decoder to enhance the capabilities of EDD’s decoder. Additionally, it introduces a regression decoder that predicts bounding boxes rather than content, thus refining the focus on spatial elements. Addressing the challenge of limited local visual cues, VAST <cite class="ltx_cite ltx_citemacro_cite">Huang et al. (<a href="#bib.bib6" title="" class="ltx_ref">2023</a>)</cite> redefines bounding box prediction as a coordinate sequence generation task and incorporates a visual alignment loss to achieve more accurate bounding box outcomes.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2409.13148/assets/02_taskdefinition.png" id="S2.F2.g1" class="ltx_graphics ltx_img_square" width="598" height="492" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The illustration of the table structure recognition task.</figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Task Definition</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.12" class="ltx_p">As illustrated in Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, given a table image <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{I}\in\mathbb{R}^{H\times W\times 3}" display="inline"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">𝑰</mi><mo id="S3.p1.1.m1.1.1.1" xref="S3.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml"><mi id="S3.p1.1.m1.1.1.3.2" xref="S3.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.1.m1.1.1.3.3" xref="S3.p1.1.m1.1.1.3.3.cmml"><mi id="S3.p1.1.m1.1.1.3.3.2" xref="S3.p1.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p1.1.m1.1.1.3.3.1" xref="S3.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.1.m1.1.1.3.3.3" xref="S3.p1.1.m1.1.1.3.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p1.1.m1.1.1.3.3.1a" xref="S3.p1.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.p1.1.m1.1.1.3.3.4" xref="S3.p1.1.m1.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><in id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1"></in><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝑰</ci><apply id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.p1.1.m1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.p1.1.m1.1.1.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3"><times id="S3.p1.1.m1.1.1.3.3.1.cmml" xref="S3.p1.1.m1.1.1.3.3.1"></times><ci id="S3.p1.1.m1.1.1.3.3.2.cmml" xref="S3.p1.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.p1.1.m1.1.1.3.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3.3">𝑊</ci><cn type="integer" id="S3.p1.1.m1.1.1.3.3.4.cmml" xref="S3.p1.1.m1.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\boldsymbol{I}\in\mathbb{R}^{H\times W\times 3}</annotation></semantics></math>, our objective is to enable the model to predict the table structure sequence <math id="S3.p1.2.m2.5" class="ltx_Math" alttext="\boldsymbol{S}=\left\{\boldsymbol{s}_{{i}}\in\mathbb{R}^{v}\mid i=1,\ldots,T\right\}" display="inline"><semantics id="S3.p1.2.m2.5a"><mrow id="S3.p1.2.m2.5.5" xref="S3.p1.2.m2.5.5.cmml"><mi id="S3.p1.2.m2.5.5.4" xref="S3.p1.2.m2.5.5.4.cmml">𝑺</mi><mo id="S3.p1.2.m2.5.5.3" xref="S3.p1.2.m2.5.5.3.cmml">=</mo><mrow id="S3.p1.2.m2.5.5.2.2" xref="S3.p1.2.m2.5.5.2.3.cmml"><mo id="S3.p1.2.m2.5.5.2.2.3" xref="S3.p1.2.m2.5.5.2.3.1.cmml">{</mo><mrow id="S3.p1.2.m2.4.4.1.1.1" xref="S3.p1.2.m2.4.4.1.1.1.cmml"><msub id="S3.p1.2.m2.4.4.1.1.1.2" xref="S3.p1.2.m2.4.4.1.1.1.2.cmml"><mi id="S3.p1.2.m2.4.4.1.1.1.2.2" xref="S3.p1.2.m2.4.4.1.1.1.2.2.cmml">𝒔</mi><mi id="S3.p1.2.m2.4.4.1.1.1.2.3" xref="S3.p1.2.m2.4.4.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.p1.2.m2.4.4.1.1.1.1" xref="S3.p1.2.m2.4.4.1.1.1.1.cmml">∈</mo><msup id="S3.p1.2.m2.4.4.1.1.1.3" xref="S3.p1.2.m2.4.4.1.1.1.3.cmml"><mi id="S3.p1.2.m2.4.4.1.1.1.3.2" xref="S3.p1.2.m2.4.4.1.1.1.3.2.cmml">ℝ</mi><mi id="S3.p1.2.m2.4.4.1.1.1.3.3" xref="S3.p1.2.m2.4.4.1.1.1.3.3.cmml">v</mi></msup></mrow><mo fence="true" lspace="0em" rspace="0em" id="S3.p1.2.m2.5.5.2.2.4" xref="S3.p1.2.m2.5.5.2.3.1.cmml">∣</mo><mrow id="S3.p1.2.m2.5.5.2.2.2" xref="S3.p1.2.m2.5.5.2.2.2.cmml"><mi id="S3.p1.2.m2.5.5.2.2.2.2" xref="S3.p1.2.m2.5.5.2.2.2.2.cmml">i</mi><mo id="S3.p1.2.m2.5.5.2.2.2.1" xref="S3.p1.2.m2.5.5.2.2.2.1.cmml">=</mo><mrow id="S3.p1.2.m2.5.5.2.2.2.3.2" xref="S3.p1.2.m2.5.5.2.2.2.3.1.cmml"><mn id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">1</mn><mo id="S3.p1.2.m2.5.5.2.2.2.3.2.1" xref="S3.p1.2.m2.5.5.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.p1.2.m2.2.2" xref="S3.p1.2.m2.2.2.cmml">…</mi><mo id="S3.p1.2.m2.5.5.2.2.2.3.2.2" xref="S3.p1.2.m2.5.5.2.2.2.3.1.cmml">,</mo><mi id="S3.p1.2.m2.3.3" xref="S3.p1.2.m2.3.3.cmml">T</mi></mrow></mrow><mo id="S3.p1.2.m2.5.5.2.2.5" xref="S3.p1.2.m2.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.5b"><apply id="S3.p1.2.m2.5.5.cmml" xref="S3.p1.2.m2.5.5"><eq id="S3.p1.2.m2.5.5.3.cmml" xref="S3.p1.2.m2.5.5.3"></eq><ci id="S3.p1.2.m2.5.5.4.cmml" xref="S3.p1.2.m2.5.5.4">𝑺</ci><apply id="S3.p1.2.m2.5.5.2.3.cmml" xref="S3.p1.2.m2.5.5.2.2"><csymbol cd="latexml" id="S3.p1.2.m2.5.5.2.3.1.cmml" xref="S3.p1.2.m2.5.5.2.2.3">conditional-set</csymbol><apply id="S3.p1.2.m2.4.4.1.1.1.cmml" xref="S3.p1.2.m2.4.4.1.1.1"><in id="S3.p1.2.m2.4.4.1.1.1.1.cmml" xref="S3.p1.2.m2.4.4.1.1.1.1"></in><apply id="S3.p1.2.m2.4.4.1.1.1.2.cmml" xref="S3.p1.2.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.4.4.1.1.1.2.1.cmml" xref="S3.p1.2.m2.4.4.1.1.1.2">subscript</csymbol><ci id="S3.p1.2.m2.4.4.1.1.1.2.2.cmml" xref="S3.p1.2.m2.4.4.1.1.1.2.2">𝒔</ci><ci id="S3.p1.2.m2.4.4.1.1.1.2.3.cmml" xref="S3.p1.2.m2.4.4.1.1.1.2.3">𝑖</ci></apply><apply id="S3.p1.2.m2.4.4.1.1.1.3.cmml" xref="S3.p1.2.m2.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.2.m2.4.4.1.1.1.3.1.cmml" xref="S3.p1.2.m2.4.4.1.1.1.3">superscript</csymbol><ci id="S3.p1.2.m2.4.4.1.1.1.3.2.cmml" xref="S3.p1.2.m2.4.4.1.1.1.3.2">ℝ</ci><ci id="S3.p1.2.m2.4.4.1.1.1.3.3.cmml" xref="S3.p1.2.m2.4.4.1.1.1.3.3">𝑣</ci></apply></apply><apply id="S3.p1.2.m2.5.5.2.2.2.cmml" xref="S3.p1.2.m2.5.5.2.2.2"><eq id="S3.p1.2.m2.5.5.2.2.2.1.cmml" xref="S3.p1.2.m2.5.5.2.2.2.1"></eq><ci id="S3.p1.2.m2.5.5.2.2.2.2.cmml" xref="S3.p1.2.m2.5.5.2.2.2.2">𝑖</ci><list id="S3.p1.2.m2.5.5.2.2.2.3.1.cmml" xref="S3.p1.2.m2.5.5.2.2.2.3.2"><cn type="integer" id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">1</cn><ci id="S3.p1.2.m2.2.2.cmml" xref="S3.p1.2.m2.2.2">…</ci><ci id="S3.p1.2.m2.3.3.cmml" xref="S3.p1.2.m2.3.3">𝑇</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.5c">\boldsymbol{S}=\left\{\boldsymbol{s}_{{i}}\in\mathbb{R}^{v}\mid i=1,\ldots,T\right\}</annotation></semantics></math>, where <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">T</annotation></semantics></math> is the length of the sequence and <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">v</annotation></semantics></math> is the the size of token vocabulary, to reconstruct the table’s layout. Previous methods <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al., <a href="#bib.bib39" title="" class="ltx_ref">2020b</a>; Nassar et al., <a href="#bib.bib20" title="" class="ltx_ref">2022</a>; Huang et al., <a href="#bib.bib6" title="" class="ltx_ref">2023</a>)</cite> have employed various formats for the output table structure sequence <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="\boldsymbol{S}" display="inline"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\boldsymbol{S}</annotation></semantics></math>, such as HTML and LaTeX. In contrast, our approach simplifies the decoding process significantly by using only two types of tokens: &lt;C&gt; and &lt;NL&gt;. &lt;C&gt; denotes a table cell, and &lt;NL&gt; indicates a newline, facilitating a concise representation of the table structure. According to the attributes of the table structure <cite class="ltx_cite ltx_citemacro_citep">(Zanibbi et al., <a href="#bib.bib35" title="" class="ltx_ref">2004</a>)</cite>, each table cell encompasses both logical attribute <math id="S3.p1.6.m6.2" class="ltx_Math" alttext="\boldsymbol{l}=\{l_{\text{row}},l_{\text{col}}\mid l_{\text{row}},l_{\text{col}}\in\mathbb{N}^{+}\}" display="inline"><semantics id="S3.p1.6.m6.2a"><mrow id="S3.p1.6.m6.2.2" xref="S3.p1.6.m6.2.2.cmml"><mi id="S3.p1.6.m6.2.2.4" xref="S3.p1.6.m6.2.2.4.cmml">𝒍</mi><mo id="S3.p1.6.m6.2.2.3" xref="S3.p1.6.m6.2.2.3.cmml">=</mo><mrow id="S3.p1.6.m6.2.2.2.2" xref="S3.p1.6.m6.2.2.2.3.cmml"><mo stretchy="false" id="S3.p1.6.m6.2.2.2.2.3" xref="S3.p1.6.m6.2.2.2.3.1.cmml">{</mo><mrow id="S3.p1.6.m6.1.1.1.1.1.2" xref="S3.p1.6.m6.1.1.1.1.1.3.cmml"><msub id="S3.p1.6.m6.1.1.1.1.1.1.1" xref="S3.p1.6.m6.1.1.1.1.1.1.1.cmml"><mi id="S3.p1.6.m6.1.1.1.1.1.1.1.2" xref="S3.p1.6.m6.1.1.1.1.1.1.1.2.cmml">l</mi><mtext id="S3.p1.6.m6.1.1.1.1.1.1.1.3" xref="S3.p1.6.m6.1.1.1.1.1.1.1.3a.cmml">row</mtext></msub><mo id="S3.p1.6.m6.1.1.1.1.1.2.3" xref="S3.p1.6.m6.1.1.1.1.1.3.cmml">,</mo><msub id="S3.p1.6.m6.1.1.1.1.1.2.2" xref="S3.p1.6.m6.1.1.1.1.1.2.2.cmml"><mi id="S3.p1.6.m6.1.1.1.1.1.2.2.2" xref="S3.p1.6.m6.1.1.1.1.1.2.2.2.cmml">l</mi><mtext id="S3.p1.6.m6.1.1.1.1.1.2.2.3" xref="S3.p1.6.m6.1.1.1.1.1.2.2.3a.cmml">col</mtext></msub></mrow><mo fence="true" lspace="0em" rspace="0em" id="S3.p1.6.m6.2.2.2.2.4" xref="S3.p1.6.m6.2.2.2.3.1.cmml">∣</mo><mrow id="S3.p1.6.m6.2.2.2.2.2" xref="S3.p1.6.m6.2.2.2.2.2.cmml"><mrow id="S3.p1.6.m6.2.2.2.2.2.2.2" xref="S3.p1.6.m6.2.2.2.2.2.2.3.cmml"><msub id="S3.p1.6.m6.2.2.2.2.2.1.1.1" xref="S3.p1.6.m6.2.2.2.2.2.1.1.1.cmml"><mi id="S3.p1.6.m6.2.2.2.2.2.1.1.1.2" xref="S3.p1.6.m6.2.2.2.2.2.1.1.1.2.cmml">l</mi><mtext id="S3.p1.6.m6.2.2.2.2.2.1.1.1.3" xref="S3.p1.6.m6.2.2.2.2.2.1.1.1.3a.cmml">row</mtext></msub><mo id="S3.p1.6.m6.2.2.2.2.2.2.2.3" xref="S3.p1.6.m6.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.p1.6.m6.2.2.2.2.2.2.2.2" xref="S3.p1.6.m6.2.2.2.2.2.2.2.2.cmml"><mi id="S3.p1.6.m6.2.2.2.2.2.2.2.2.2" xref="S3.p1.6.m6.2.2.2.2.2.2.2.2.2.cmml">l</mi><mtext id="S3.p1.6.m6.2.2.2.2.2.2.2.2.3" xref="S3.p1.6.m6.2.2.2.2.2.2.2.2.3a.cmml">col</mtext></msub></mrow><mo id="S3.p1.6.m6.2.2.2.2.2.3" xref="S3.p1.6.m6.2.2.2.2.2.3.cmml">∈</mo><msup id="S3.p1.6.m6.2.2.2.2.2.4" xref="S3.p1.6.m6.2.2.2.2.2.4.cmml"><mi id="S3.p1.6.m6.2.2.2.2.2.4.2" xref="S3.p1.6.m6.2.2.2.2.2.4.2.cmml">ℕ</mi><mo id="S3.p1.6.m6.2.2.2.2.2.4.3" xref="S3.p1.6.m6.2.2.2.2.2.4.3.cmml">+</mo></msup></mrow><mo stretchy="false" id="S3.p1.6.m6.2.2.2.2.5" xref="S3.p1.6.m6.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.2b"><apply id="S3.p1.6.m6.2.2.cmml" xref="S3.p1.6.m6.2.2"><eq id="S3.p1.6.m6.2.2.3.cmml" xref="S3.p1.6.m6.2.2.3"></eq><ci id="S3.p1.6.m6.2.2.4.cmml" xref="S3.p1.6.m6.2.2.4">𝒍</ci><apply id="S3.p1.6.m6.2.2.2.3.cmml" xref="S3.p1.6.m6.2.2.2.2"><csymbol cd="latexml" id="S3.p1.6.m6.2.2.2.3.1.cmml" xref="S3.p1.6.m6.2.2.2.2.3">conditional-set</csymbol><list id="S3.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.p1.6.m6.1.1.1.1.1.2"><apply id="S3.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.6.m6.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.1.2">𝑙</ci><ci id="S3.p1.6.m6.1.1.1.1.1.1.1.3a.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.p1.6.m6.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.1.3">row</mtext></ci></apply><apply id="S3.p1.6.m6.1.1.1.1.1.2.2.cmml" xref="S3.p1.6.m6.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.1.1.2.2.1.cmml" xref="S3.p1.6.m6.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.p1.6.m6.1.1.1.1.1.2.2.2.cmml" xref="S3.p1.6.m6.1.1.1.1.1.2.2.2">𝑙</ci><ci id="S3.p1.6.m6.1.1.1.1.1.2.2.3a.cmml" xref="S3.p1.6.m6.1.1.1.1.1.2.2.3"><mtext mathsize="70%" id="S3.p1.6.m6.1.1.1.1.1.2.2.3.cmml" xref="S3.p1.6.m6.1.1.1.1.1.2.2.3">col</mtext></ci></apply></list><apply id="S3.p1.6.m6.2.2.2.2.2.cmml" xref="S3.p1.6.m6.2.2.2.2.2"><in id="S3.p1.6.m6.2.2.2.2.2.3.cmml" xref="S3.p1.6.m6.2.2.2.2.2.3"></in><list id="S3.p1.6.m6.2.2.2.2.2.2.3.cmml" xref="S3.p1.6.m6.2.2.2.2.2.2.2"><apply id="S3.p1.6.m6.2.2.2.2.2.1.1.1.cmml" xref="S3.p1.6.m6.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.2.2.2.2.2.1.1.1.1.cmml" xref="S3.p1.6.m6.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.6.m6.2.2.2.2.2.1.1.1.2.cmml" xref="S3.p1.6.m6.2.2.2.2.2.1.1.1.2">𝑙</ci><ci id="S3.p1.6.m6.2.2.2.2.2.1.1.1.3a.cmml" xref="S3.p1.6.m6.2.2.2.2.2.1.1.1.3"><mtext mathsize="70%" id="S3.p1.6.m6.2.2.2.2.2.1.1.1.3.cmml" xref="S3.p1.6.m6.2.2.2.2.2.1.1.1.3">row</mtext></ci></apply><apply id="S3.p1.6.m6.2.2.2.2.2.2.2.2.cmml" xref="S3.p1.6.m6.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.2.2.2.2.2.2.2.2.1.cmml" xref="S3.p1.6.m6.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p1.6.m6.2.2.2.2.2.2.2.2.2.cmml" xref="S3.p1.6.m6.2.2.2.2.2.2.2.2.2">𝑙</ci><ci id="S3.p1.6.m6.2.2.2.2.2.2.2.2.3a.cmml" xref="S3.p1.6.m6.2.2.2.2.2.2.2.2.3"><mtext mathsize="70%" id="S3.p1.6.m6.2.2.2.2.2.2.2.2.3.cmml" xref="S3.p1.6.m6.2.2.2.2.2.2.2.2.3">col</mtext></ci></apply></list><apply id="S3.p1.6.m6.2.2.2.2.2.4.cmml" xref="S3.p1.6.m6.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.p1.6.m6.2.2.2.2.2.4.1.cmml" xref="S3.p1.6.m6.2.2.2.2.2.4">superscript</csymbol><ci id="S3.p1.6.m6.2.2.2.2.2.4.2.cmml" xref="S3.p1.6.m6.2.2.2.2.2.4.2">ℕ</ci><plus id="S3.p1.6.m6.2.2.2.2.2.4.3.cmml" xref="S3.p1.6.m6.2.2.2.2.2.4.3"></plus></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.2c">\boldsymbol{l}=\{l_{\text{row}},l_{\text{col}}\mid l_{\text{row}},l_{\text{col}}\in\mathbb{N}^{+}\}</annotation></semantics></math> and physical attribute <math id="S3.p1.7.m7.5" class="ltx_Math" alttext="\boldsymbol{p}=\{p_{j}\in\mathbb{N}\mid j=1,\ldots,8\}" display="inline"><semantics id="S3.p1.7.m7.5a"><mrow id="S3.p1.7.m7.5.5" xref="S3.p1.7.m7.5.5.cmml"><mi id="S3.p1.7.m7.5.5.4" xref="S3.p1.7.m7.5.5.4.cmml">𝒑</mi><mo id="S3.p1.7.m7.5.5.3" xref="S3.p1.7.m7.5.5.3.cmml">=</mo><mrow id="S3.p1.7.m7.5.5.2.2" xref="S3.p1.7.m7.5.5.2.3.cmml"><mo stretchy="false" id="S3.p1.7.m7.5.5.2.2.3" xref="S3.p1.7.m7.5.5.2.3.1.cmml">{</mo><mrow id="S3.p1.7.m7.4.4.1.1.1" xref="S3.p1.7.m7.4.4.1.1.1.cmml"><msub id="S3.p1.7.m7.4.4.1.1.1.2" xref="S3.p1.7.m7.4.4.1.1.1.2.cmml"><mi id="S3.p1.7.m7.4.4.1.1.1.2.2" xref="S3.p1.7.m7.4.4.1.1.1.2.2.cmml">p</mi><mi id="S3.p1.7.m7.4.4.1.1.1.2.3" xref="S3.p1.7.m7.4.4.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.p1.7.m7.4.4.1.1.1.1" xref="S3.p1.7.m7.4.4.1.1.1.1.cmml">∈</mo><mi id="S3.p1.7.m7.4.4.1.1.1.3" xref="S3.p1.7.m7.4.4.1.1.1.3.cmml">ℕ</mi></mrow><mo fence="true" lspace="0em" rspace="0em" id="S3.p1.7.m7.5.5.2.2.4" xref="S3.p1.7.m7.5.5.2.3.1.cmml">∣</mo><mrow id="S3.p1.7.m7.5.5.2.2.2" xref="S3.p1.7.m7.5.5.2.2.2.cmml"><mi id="S3.p1.7.m7.5.5.2.2.2.2" xref="S3.p1.7.m7.5.5.2.2.2.2.cmml">j</mi><mo id="S3.p1.7.m7.5.5.2.2.2.1" xref="S3.p1.7.m7.5.5.2.2.2.1.cmml">=</mo><mrow id="S3.p1.7.m7.5.5.2.2.2.3.2" xref="S3.p1.7.m7.5.5.2.2.2.3.1.cmml"><mn id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">1</mn><mo id="S3.p1.7.m7.5.5.2.2.2.3.2.1" xref="S3.p1.7.m7.5.5.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.p1.7.m7.2.2" xref="S3.p1.7.m7.2.2.cmml">…</mi><mo id="S3.p1.7.m7.5.5.2.2.2.3.2.2" xref="S3.p1.7.m7.5.5.2.2.2.3.1.cmml">,</mo><mn id="S3.p1.7.m7.3.3" xref="S3.p1.7.m7.3.3.cmml">8</mn></mrow></mrow><mo stretchy="false" id="S3.p1.7.m7.5.5.2.2.5" xref="S3.p1.7.m7.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.5b"><apply id="S3.p1.7.m7.5.5.cmml" xref="S3.p1.7.m7.5.5"><eq id="S3.p1.7.m7.5.5.3.cmml" xref="S3.p1.7.m7.5.5.3"></eq><ci id="S3.p1.7.m7.5.5.4.cmml" xref="S3.p1.7.m7.5.5.4">𝒑</ci><apply id="S3.p1.7.m7.5.5.2.3.cmml" xref="S3.p1.7.m7.5.5.2.2"><csymbol cd="latexml" id="S3.p1.7.m7.5.5.2.3.1.cmml" xref="S3.p1.7.m7.5.5.2.2.3">conditional-set</csymbol><apply id="S3.p1.7.m7.4.4.1.1.1.cmml" xref="S3.p1.7.m7.4.4.1.1.1"><in id="S3.p1.7.m7.4.4.1.1.1.1.cmml" xref="S3.p1.7.m7.4.4.1.1.1.1"></in><apply id="S3.p1.7.m7.4.4.1.1.1.2.cmml" xref="S3.p1.7.m7.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.7.m7.4.4.1.1.1.2.1.cmml" xref="S3.p1.7.m7.4.4.1.1.1.2">subscript</csymbol><ci id="S3.p1.7.m7.4.4.1.1.1.2.2.cmml" xref="S3.p1.7.m7.4.4.1.1.1.2.2">𝑝</ci><ci id="S3.p1.7.m7.4.4.1.1.1.2.3.cmml" xref="S3.p1.7.m7.4.4.1.1.1.2.3">𝑗</ci></apply><ci id="S3.p1.7.m7.4.4.1.1.1.3.cmml" xref="S3.p1.7.m7.4.4.1.1.1.3">ℕ</ci></apply><apply id="S3.p1.7.m7.5.5.2.2.2.cmml" xref="S3.p1.7.m7.5.5.2.2.2"><eq id="S3.p1.7.m7.5.5.2.2.2.1.cmml" xref="S3.p1.7.m7.5.5.2.2.2.1"></eq><ci id="S3.p1.7.m7.5.5.2.2.2.2.cmml" xref="S3.p1.7.m7.5.5.2.2.2.2">𝑗</ci><list id="S3.p1.7.m7.5.5.2.2.2.3.1.cmml" xref="S3.p1.7.m7.5.5.2.2.2.3.2"><cn type="integer" id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">1</cn><ci id="S3.p1.7.m7.2.2.cmml" xref="S3.p1.7.m7.2.2">…</ci><cn type="integer" id="S3.p1.7.m7.3.3.cmml" xref="S3.p1.7.m7.3.3">8</cn></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.5c">\boldsymbol{p}=\{p_{j}\in\mathbb{N}\mid j=1,\ldots,8\}</annotation></semantics></math>. The logical attribute <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="\boldsymbol{l}" display="inline"><semantics id="S3.p1.8.m8.1a"><mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">𝒍</mi><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">𝒍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\boldsymbol{l}</annotation></semantics></math> specifies the cell’s span across rows and columns, while the physical attribute <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="\boldsymbol{p}" display="inline"><semantics id="S3.p1.9.m9.1a"><mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">\boldsymbol{p}</annotation></semantics></math> defines the spatial positioning of the cell within the image. Consequently, the output of our proposed model, UniTabNet, includes the structure sequence <math id="S3.p1.10.m10.1" class="ltx_Math" alttext="\boldsymbol{S}" display="inline"><semantics id="S3.p1.10.m10.1a"><mi id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><ci id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">\boldsymbol{S}</annotation></semantics></math>, along with logical attributes <math id="S3.p1.11.m11.5" class="ltx_Math" alttext="\boldsymbol{L}=\left\{\boldsymbol{l}_{{i}}\in\mathbb{R}^{2}\mid i=1,\ldots,T\right\}" display="inline"><semantics id="S3.p1.11.m11.5a"><mrow id="S3.p1.11.m11.5.5" xref="S3.p1.11.m11.5.5.cmml"><mi id="S3.p1.11.m11.5.5.4" xref="S3.p1.11.m11.5.5.4.cmml">𝑳</mi><mo id="S3.p1.11.m11.5.5.3" xref="S3.p1.11.m11.5.5.3.cmml">=</mo><mrow id="S3.p1.11.m11.5.5.2.2" xref="S3.p1.11.m11.5.5.2.3.cmml"><mo id="S3.p1.11.m11.5.5.2.2.3" xref="S3.p1.11.m11.5.5.2.3.1.cmml">{</mo><mrow id="S3.p1.11.m11.4.4.1.1.1" xref="S3.p1.11.m11.4.4.1.1.1.cmml"><msub id="S3.p1.11.m11.4.4.1.1.1.2" xref="S3.p1.11.m11.4.4.1.1.1.2.cmml"><mi id="S3.p1.11.m11.4.4.1.1.1.2.2" xref="S3.p1.11.m11.4.4.1.1.1.2.2.cmml">𝒍</mi><mi id="S3.p1.11.m11.4.4.1.1.1.2.3" xref="S3.p1.11.m11.4.4.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.p1.11.m11.4.4.1.1.1.1" xref="S3.p1.11.m11.4.4.1.1.1.1.cmml">∈</mo><msup id="S3.p1.11.m11.4.4.1.1.1.3" xref="S3.p1.11.m11.4.4.1.1.1.3.cmml"><mi id="S3.p1.11.m11.4.4.1.1.1.3.2" xref="S3.p1.11.m11.4.4.1.1.1.3.2.cmml">ℝ</mi><mn id="S3.p1.11.m11.4.4.1.1.1.3.3" xref="S3.p1.11.m11.4.4.1.1.1.3.3.cmml">2</mn></msup></mrow><mo fence="true" lspace="0em" rspace="0em" id="S3.p1.11.m11.5.5.2.2.4" xref="S3.p1.11.m11.5.5.2.3.1.cmml">∣</mo><mrow id="S3.p1.11.m11.5.5.2.2.2" xref="S3.p1.11.m11.5.5.2.2.2.cmml"><mi id="S3.p1.11.m11.5.5.2.2.2.2" xref="S3.p1.11.m11.5.5.2.2.2.2.cmml">i</mi><mo id="S3.p1.11.m11.5.5.2.2.2.1" xref="S3.p1.11.m11.5.5.2.2.2.1.cmml">=</mo><mrow id="S3.p1.11.m11.5.5.2.2.2.3.2" xref="S3.p1.11.m11.5.5.2.2.2.3.1.cmml"><mn id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml">1</mn><mo id="S3.p1.11.m11.5.5.2.2.2.3.2.1" xref="S3.p1.11.m11.5.5.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.p1.11.m11.2.2" xref="S3.p1.11.m11.2.2.cmml">…</mi><mo id="S3.p1.11.m11.5.5.2.2.2.3.2.2" xref="S3.p1.11.m11.5.5.2.2.2.3.1.cmml">,</mo><mi id="S3.p1.11.m11.3.3" xref="S3.p1.11.m11.3.3.cmml">T</mi></mrow></mrow><mo id="S3.p1.11.m11.5.5.2.2.5" xref="S3.p1.11.m11.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.5b"><apply id="S3.p1.11.m11.5.5.cmml" xref="S3.p1.11.m11.5.5"><eq id="S3.p1.11.m11.5.5.3.cmml" xref="S3.p1.11.m11.5.5.3"></eq><ci id="S3.p1.11.m11.5.5.4.cmml" xref="S3.p1.11.m11.5.5.4">𝑳</ci><apply id="S3.p1.11.m11.5.5.2.3.cmml" xref="S3.p1.11.m11.5.5.2.2"><csymbol cd="latexml" id="S3.p1.11.m11.5.5.2.3.1.cmml" xref="S3.p1.11.m11.5.5.2.2.3">conditional-set</csymbol><apply id="S3.p1.11.m11.4.4.1.1.1.cmml" xref="S3.p1.11.m11.4.4.1.1.1"><in id="S3.p1.11.m11.4.4.1.1.1.1.cmml" xref="S3.p1.11.m11.4.4.1.1.1.1"></in><apply id="S3.p1.11.m11.4.4.1.1.1.2.cmml" xref="S3.p1.11.m11.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.11.m11.4.4.1.1.1.2.1.cmml" xref="S3.p1.11.m11.4.4.1.1.1.2">subscript</csymbol><ci id="S3.p1.11.m11.4.4.1.1.1.2.2.cmml" xref="S3.p1.11.m11.4.4.1.1.1.2.2">𝒍</ci><ci id="S3.p1.11.m11.4.4.1.1.1.2.3.cmml" xref="S3.p1.11.m11.4.4.1.1.1.2.3">𝑖</ci></apply><apply id="S3.p1.11.m11.4.4.1.1.1.3.cmml" xref="S3.p1.11.m11.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.11.m11.4.4.1.1.1.3.1.cmml" xref="S3.p1.11.m11.4.4.1.1.1.3">superscript</csymbol><ci id="S3.p1.11.m11.4.4.1.1.1.3.2.cmml" xref="S3.p1.11.m11.4.4.1.1.1.3.2">ℝ</ci><cn type="integer" id="S3.p1.11.m11.4.4.1.1.1.3.3.cmml" xref="S3.p1.11.m11.4.4.1.1.1.3.3">2</cn></apply></apply><apply id="S3.p1.11.m11.5.5.2.2.2.cmml" xref="S3.p1.11.m11.5.5.2.2.2"><eq id="S3.p1.11.m11.5.5.2.2.2.1.cmml" xref="S3.p1.11.m11.5.5.2.2.2.1"></eq><ci id="S3.p1.11.m11.5.5.2.2.2.2.cmml" xref="S3.p1.11.m11.5.5.2.2.2.2">𝑖</ci><list id="S3.p1.11.m11.5.5.2.2.2.3.1.cmml" xref="S3.p1.11.m11.5.5.2.2.2.3.2"><cn type="integer" id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1">1</cn><ci id="S3.p1.11.m11.2.2.cmml" xref="S3.p1.11.m11.2.2">…</ci><ci id="S3.p1.11.m11.3.3.cmml" xref="S3.p1.11.m11.3.3">𝑇</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.5c">\boldsymbol{L}=\left\{\boldsymbol{l}_{{i}}\in\mathbb{R}^{2}\mid i=1,\ldots,T\right\}</annotation></semantics></math> and physical attributes <math id="S3.p1.12.m12.5" class="ltx_Math" alttext="\boldsymbol{P}=\left\{\boldsymbol{p}_{{i}}\in\mathbb{R}^{8}\mid i=1,\ldots,T\right\}" display="inline"><semantics id="S3.p1.12.m12.5a"><mrow id="S3.p1.12.m12.5.5" xref="S3.p1.12.m12.5.5.cmml"><mi id="S3.p1.12.m12.5.5.4" xref="S3.p1.12.m12.5.5.4.cmml">𝑷</mi><mo id="S3.p1.12.m12.5.5.3" xref="S3.p1.12.m12.5.5.3.cmml">=</mo><mrow id="S3.p1.12.m12.5.5.2.2" xref="S3.p1.12.m12.5.5.2.3.cmml"><mo id="S3.p1.12.m12.5.5.2.2.3" xref="S3.p1.12.m12.5.5.2.3.1.cmml">{</mo><mrow id="S3.p1.12.m12.4.4.1.1.1" xref="S3.p1.12.m12.4.4.1.1.1.cmml"><msub id="S3.p1.12.m12.4.4.1.1.1.2" xref="S3.p1.12.m12.4.4.1.1.1.2.cmml"><mi id="S3.p1.12.m12.4.4.1.1.1.2.2" xref="S3.p1.12.m12.4.4.1.1.1.2.2.cmml">𝒑</mi><mi id="S3.p1.12.m12.4.4.1.1.1.2.3" xref="S3.p1.12.m12.4.4.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.p1.12.m12.4.4.1.1.1.1" xref="S3.p1.12.m12.4.4.1.1.1.1.cmml">∈</mo><msup id="S3.p1.12.m12.4.4.1.1.1.3" xref="S3.p1.12.m12.4.4.1.1.1.3.cmml"><mi id="S3.p1.12.m12.4.4.1.1.1.3.2" xref="S3.p1.12.m12.4.4.1.1.1.3.2.cmml">ℝ</mi><mn id="S3.p1.12.m12.4.4.1.1.1.3.3" xref="S3.p1.12.m12.4.4.1.1.1.3.3.cmml">8</mn></msup></mrow><mo fence="true" lspace="0em" rspace="0em" id="S3.p1.12.m12.5.5.2.2.4" xref="S3.p1.12.m12.5.5.2.3.1.cmml">∣</mo><mrow id="S3.p1.12.m12.5.5.2.2.2" xref="S3.p1.12.m12.5.5.2.2.2.cmml"><mi id="S3.p1.12.m12.5.5.2.2.2.2" xref="S3.p1.12.m12.5.5.2.2.2.2.cmml">i</mi><mo id="S3.p1.12.m12.5.5.2.2.2.1" xref="S3.p1.12.m12.5.5.2.2.2.1.cmml">=</mo><mrow id="S3.p1.12.m12.5.5.2.2.2.3.2" xref="S3.p1.12.m12.5.5.2.2.2.3.1.cmml"><mn id="S3.p1.12.m12.1.1" xref="S3.p1.12.m12.1.1.cmml">1</mn><mo id="S3.p1.12.m12.5.5.2.2.2.3.2.1" xref="S3.p1.12.m12.5.5.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.p1.12.m12.2.2" xref="S3.p1.12.m12.2.2.cmml">…</mi><mo id="S3.p1.12.m12.5.5.2.2.2.3.2.2" xref="S3.p1.12.m12.5.5.2.2.2.3.1.cmml">,</mo><mi id="S3.p1.12.m12.3.3" xref="S3.p1.12.m12.3.3.cmml">T</mi></mrow></mrow><mo id="S3.p1.12.m12.5.5.2.2.5" xref="S3.p1.12.m12.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.5b"><apply id="S3.p1.12.m12.5.5.cmml" xref="S3.p1.12.m12.5.5"><eq id="S3.p1.12.m12.5.5.3.cmml" xref="S3.p1.12.m12.5.5.3"></eq><ci id="S3.p1.12.m12.5.5.4.cmml" xref="S3.p1.12.m12.5.5.4">𝑷</ci><apply id="S3.p1.12.m12.5.5.2.3.cmml" xref="S3.p1.12.m12.5.5.2.2"><csymbol cd="latexml" id="S3.p1.12.m12.5.5.2.3.1.cmml" xref="S3.p1.12.m12.5.5.2.2.3">conditional-set</csymbol><apply id="S3.p1.12.m12.4.4.1.1.1.cmml" xref="S3.p1.12.m12.4.4.1.1.1"><in id="S3.p1.12.m12.4.4.1.1.1.1.cmml" xref="S3.p1.12.m12.4.4.1.1.1.1"></in><apply id="S3.p1.12.m12.4.4.1.1.1.2.cmml" xref="S3.p1.12.m12.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.12.m12.4.4.1.1.1.2.1.cmml" xref="S3.p1.12.m12.4.4.1.1.1.2">subscript</csymbol><ci id="S3.p1.12.m12.4.4.1.1.1.2.2.cmml" xref="S3.p1.12.m12.4.4.1.1.1.2.2">𝒑</ci><ci id="S3.p1.12.m12.4.4.1.1.1.2.3.cmml" xref="S3.p1.12.m12.4.4.1.1.1.2.3">𝑖</ci></apply><apply id="S3.p1.12.m12.4.4.1.1.1.3.cmml" xref="S3.p1.12.m12.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.12.m12.4.4.1.1.1.3.1.cmml" xref="S3.p1.12.m12.4.4.1.1.1.3">superscript</csymbol><ci id="S3.p1.12.m12.4.4.1.1.1.3.2.cmml" xref="S3.p1.12.m12.4.4.1.1.1.3.2">ℝ</ci><cn type="integer" id="S3.p1.12.m12.4.4.1.1.1.3.3.cmml" xref="S3.p1.12.m12.4.4.1.1.1.3.3">8</cn></apply></apply><apply id="S3.p1.12.m12.5.5.2.2.2.cmml" xref="S3.p1.12.m12.5.5.2.2.2"><eq id="S3.p1.12.m12.5.5.2.2.2.1.cmml" xref="S3.p1.12.m12.5.5.2.2.2.1"></eq><ci id="S3.p1.12.m12.5.5.2.2.2.2.cmml" xref="S3.p1.12.m12.5.5.2.2.2.2">𝑖</ci><list id="S3.p1.12.m12.5.5.2.2.2.3.1.cmml" xref="S3.p1.12.m12.5.5.2.2.2.3.2"><cn type="integer" id="S3.p1.12.m12.1.1.cmml" xref="S3.p1.12.m12.1.1">1</cn><ci id="S3.p1.12.m12.2.2.cmml" xref="S3.p1.12.m12.2.2">…</ci><ci id="S3.p1.12.m12.3.3.cmml" xref="S3.p1.12.m12.3.3">𝑇</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.5c">\boldsymbol{P}=\left\{\boldsymbol{p}_{{i}}\in\mathbb{R}^{8}\mid i=1,\ldots,T\right\}</annotation></semantics></math>, providing a comprehensive description of the table’s layout.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2409.13148/assets/03_unitabnet.png" id="S3.F3.g1" class="ltx_graphics ltx_img_landscape" width="598" height="285" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The overall architecture of UniTabNet. It mainly consists of a vision encoder and a text decoder. Using the text decoder’s output, the Cell Decoder decodes the physical and logical attributes of table cells. The Vision Guider directs the model’s focus on row and column information, while the Language Guider aids in understanding textual semantics.</figcaption>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methodology</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.3" class="ltx_p">As illustrated in Figure <a href="#S3.F3" title="Figure 3 ‣ 3 Task Definition ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, UniTabNet is built upon the Donut <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite> and primarily consists of a vision encoder and a text decoder, which decodes image features to generate the table structure sequence <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{S}" display="inline"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">\boldsymbol{S}</annotation></semantics></math>. To further decode the logical and physical attributes contained within each cell, we additionally design a logical decoder and a physical decoder to predict the cell attributes <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="\boldsymbol{l}" display="inline"><semantics id="S4.p1.2.m2.1a"><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">𝒍</mi><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝒍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">\boldsymbol{l}</annotation></semantics></math> and <math id="S4.p1.3.m3.1" class="ltx_Math" alttext="\boldsymbol{p}" display="inline"><semantics id="S4.p1.3.m3.1a"><mi id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><ci id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">\boldsymbol{p}</annotation></semantics></math>, respectively. Considering the nature of table images, we incorporate a Vision Guider and a Language Guider at the output of the text decoder. The Vision Guider directs the model to focus on relevant areas during cell decoding, while the Language Guider aids in understanding the corresponding textual information within the cells. Detailed descriptions of these modules will follow.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.8" class="ltx_p"><span id="S4.p2.8.1" class="ltx_text ltx_font_bold">Vision Encoder.</span> The vision encoder converts the table image <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="\boldsymbol{I}" display="inline"><semantics id="S4.p2.1.m1.1a"><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">𝑰</mi><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝑰</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\boldsymbol{I}</annotation></semantics></math> into a set of embeddings <math id="S4.p2.2.m2.5" class="ltx_Math" alttext="\boldsymbol{Z}=\{\boldsymbol{z}_{i}\in\mathbb{R}^{D}\mid i=1,\ldots,N\}" display="inline"><semantics id="S4.p2.2.m2.5a"><mrow id="S4.p2.2.m2.5.5" xref="S4.p2.2.m2.5.5.cmml"><mi id="S4.p2.2.m2.5.5.4" xref="S4.p2.2.m2.5.5.4.cmml">𝒁</mi><mo id="S4.p2.2.m2.5.5.3" xref="S4.p2.2.m2.5.5.3.cmml">=</mo><mrow id="S4.p2.2.m2.5.5.2.2" xref="S4.p2.2.m2.5.5.2.3.cmml"><mo stretchy="false" id="S4.p2.2.m2.5.5.2.2.3" xref="S4.p2.2.m2.5.5.2.3.1.cmml">{</mo><mrow id="S4.p2.2.m2.4.4.1.1.1" xref="S4.p2.2.m2.4.4.1.1.1.cmml"><msub id="S4.p2.2.m2.4.4.1.1.1.2" xref="S4.p2.2.m2.4.4.1.1.1.2.cmml"><mi id="S4.p2.2.m2.4.4.1.1.1.2.2" xref="S4.p2.2.m2.4.4.1.1.1.2.2.cmml">𝒛</mi><mi id="S4.p2.2.m2.4.4.1.1.1.2.3" xref="S4.p2.2.m2.4.4.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.p2.2.m2.4.4.1.1.1.1" xref="S4.p2.2.m2.4.4.1.1.1.1.cmml">∈</mo><msup id="S4.p2.2.m2.4.4.1.1.1.3" xref="S4.p2.2.m2.4.4.1.1.1.3.cmml"><mi id="S4.p2.2.m2.4.4.1.1.1.3.2" xref="S4.p2.2.m2.4.4.1.1.1.3.2.cmml">ℝ</mi><mi id="S4.p2.2.m2.4.4.1.1.1.3.3" xref="S4.p2.2.m2.4.4.1.1.1.3.3.cmml">D</mi></msup></mrow><mo fence="true" lspace="0em" rspace="0em" id="S4.p2.2.m2.5.5.2.2.4" xref="S4.p2.2.m2.5.5.2.3.1.cmml">∣</mo><mrow id="S4.p2.2.m2.5.5.2.2.2" xref="S4.p2.2.m2.5.5.2.2.2.cmml"><mi id="S4.p2.2.m2.5.5.2.2.2.2" xref="S4.p2.2.m2.5.5.2.2.2.2.cmml">i</mi><mo id="S4.p2.2.m2.5.5.2.2.2.1" xref="S4.p2.2.m2.5.5.2.2.2.1.cmml">=</mo><mrow id="S4.p2.2.m2.5.5.2.2.2.3.2" xref="S4.p2.2.m2.5.5.2.2.2.3.1.cmml"><mn id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">1</mn><mo id="S4.p2.2.m2.5.5.2.2.2.3.2.1" xref="S4.p2.2.m2.5.5.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.p2.2.m2.2.2" xref="S4.p2.2.m2.2.2.cmml">…</mi><mo id="S4.p2.2.m2.5.5.2.2.2.3.2.2" xref="S4.p2.2.m2.5.5.2.2.2.3.1.cmml">,</mo><mi id="S4.p2.2.m2.3.3" xref="S4.p2.2.m2.3.3.cmml">N</mi></mrow></mrow><mo stretchy="false" id="S4.p2.2.m2.5.5.2.2.5" xref="S4.p2.2.m2.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.5b"><apply id="S4.p2.2.m2.5.5.cmml" xref="S4.p2.2.m2.5.5"><eq id="S4.p2.2.m2.5.5.3.cmml" xref="S4.p2.2.m2.5.5.3"></eq><ci id="S4.p2.2.m2.5.5.4.cmml" xref="S4.p2.2.m2.5.5.4">𝒁</ci><apply id="S4.p2.2.m2.5.5.2.3.cmml" xref="S4.p2.2.m2.5.5.2.2"><csymbol cd="latexml" id="S4.p2.2.m2.5.5.2.3.1.cmml" xref="S4.p2.2.m2.5.5.2.2.3">conditional-set</csymbol><apply id="S4.p2.2.m2.4.4.1.1.1.cmml" xref="S4.p2.2.m2.4.4.1.1.1"><in id="S4.p2.2.m2.4.4.1.1.1.1.cmml" xref="S4.p2.2.m2.4.4.1.1.1.1"></in><apply id="S4.p2.2.m2.4.4.1.1.1.2.cmml" xref="S4.p2.2.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.p2.2.m2.4.4.1.1.1.2.1.cmml" xref="S4.p2.2.m2.4.4.1.1.1.2">subscript</csymbol><ci id="S4.p2.2.m2.4.4.1.1.1.2.2.cmml" xref="S4.p2.2.m2.4.4.1.1.1.2.2">𝒛</ci><ci id="S4.p2.2.m2.4.4.1.1.1.2.3.cmml" xref="S4.p2.2.m2.4.4.1.1.1.2.3">𝑖</ci></apply><apply id="S4.p2.2.m2.4.4.1.1.1.3.cmml" xref="S4.p2.2.m2.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S4.p2.2.m2.4.4.1.1.1.3.1.cmml" xref="S4.p2.2.m2.4.4.1.1.1.3">superscript</csymbol><ci id="S4.p2.2.m2.4.4.1.1.1.3.2.cmml" xref="S4.p2.2.m2.4.4.1.1.1.3.2">ℝ</ci><ci id="S4.p2.2.m2.4.4.1.1.1.3.3.cmml" xref="S4.p2.2.m2.4.4.1.1.1.3.3">𝐷</ci></apply></apply><apply id="S4.p2.2.m2.5.5.2.2.2.cmml" xref="S4.p2.2.m2.5.5.2.2.2"><eq id="S4.p2.2.m2.5.5.2.2.2.1.cmml" xref="S4.p2.2.m2.5.5.2.2.2.1"></eq><ci id="S4.p2.2.m2.5.5.2.2.2.2.cmml" xref="S4.p2.2.m2.5.5.2.2.2.2">𝑖</ci><list id="S4.p2.2.m2.5.5.2.2.2.3.1.cmml" xref="S4.p2.2.m2.5.5.2.2.2.3.2"><cn type="integer" id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">1</cn><ci id="S4.p2.2.m2.2.2.cmml" xref="S4.p2.2.m2.2.2">…</ci><ci id="S4.p2.2.m2.3.3.cmml" xref="S4.p2.2.m2.3.3">𝑁</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.5c">\boldsymbol{Z}=\{\boldsymbol{z}_{i}\in\mathbb{R}^{D}\mid i=1,\ldots,N\}</annotation></semantics></math>, where <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.p2.3.m3.1a"><mi id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><ci id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">N</annotation></semantics></math> is feature map size and <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.p2.4.m4.1a"><mi id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><ci id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">D</annotation></semantics></math> is the dimension of the latent vectors of the encoder. As depicted in Figure <a href="#S3.F3" title="Figure 3 ‣ 3 Task Definition ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we adopt the Swin Transformer <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite> as our primary vision backbone, following the Donut, to encode <math id="S4.p2.5.m5.1" class="ltx_Math" alttext="\boldsymbol{I}" display="inline"><semantics id="S4.p2.5.m5.1a"><mi id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml">𝑰</mi><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><ci id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1">𝑰</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">\boldsymbol{I}</annotation></semantics></math> into feature map <math id="S4.p2.6.m6.1" class="ltx_Math" alttext="\boldsymbol{F}" display="inline"><semantics id="S4.p2.6.m6.1a"><mi id="S4.p2.6.m6.1.1" xref="S4.p2.6.m6.1.1.cmml">𝑭</mi><annotation-xml encoding="MathML-Content" id="S4.p2.6.m6.1b"><ci id="S4.p2.6.m6.1.1.cmml" xref="S4.p2.6.m6.1.1">𝑭</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m6.1c">\boldsymbol{F}</annotation></semantics></math>. Additionally, we incorporate positional encoding <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib31" title="" class="ltx_ref">2017</a>)</cite> into <math id="S4.p2.7.m7.1" class="ltx_Math" alttext="\boldsymbol{F}" display="inline"><semantics id="S4.p2.7.m7.1a"><mi id="S4.p2.7.m7.1.1" xref="S4.p2.7.m7.1.1.cmml">𝑭</mi><annotation-xml encoding="MathML-Content" id="S4.p2.7.m7.1b"><ci id="S4.p2.7.m7.1.1.cmml" xref="S4.p2.7.m7.1.1">𝑭</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m7.1c">\boldsymbol{F}</annotation></semantics></math> to generate the final vision embeddings <math id="S4.p2.8.m8.1" class="ltx_Math" alttext="\boldsymbol{Z}" display="inline"><semantics id="S4.p2.8.m8.1a"><mi id="S4.p2.8.m8.1.1" xref="S4.p2.8.m8.1.1.cmml">𝒁</mi><annotation-xml encoding="MathML-Content" id="S4.p2.8.m8.1b"><ci id="S4.p2.8.m8.1.1.cmml" xref="S4.p2.8.m8.1.1">𝒁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.8.m8.1c">\boldsymbol{Z}</annotation></semantics></math>.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.2" class="ltx_p"><span id="S4.p3.2.1" class="ltx_text ltx_font_bold">Text Decoder.</span> Similar to Donut, we utilize the BART <cite class="ltx_cite ltx_citemacro_citep">(Lewis et al., <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite> decoder to generate the table structure sequence <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="\boldsymbol{S}" display="inline"><semantics id="S4.p3.1.m1.1a"><mi id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><ci id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">\boldsymbol{S}</annotation></semantics></math>, conditioned on the <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="\boldsymbol{Z}" display="inline"><semantics id="S4.p3.2.m2.1a"><mi id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml">𝒁</mi><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><ci id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1">𝒁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">\boldsymbol{Z}</annotation></semantics></math>. Since UniTabNet is trained to predict the next tokens like LLMs <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a href="#bib.bib21" title="" class="ltx_ref">2023</a>)</cite>, it only requires maximizing the likelihood of loss at training time.</p>
<table id="A1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E1.m1.2" class="ltx_Math" alttext="\displaystyle\mathscr{L}_{\text{lm}}=\max\sum_{i=1}^{T}{\log P\left(\boldsymbol{s}_{i}\left|\boldsymbol{Z},\boldsymbol{s}_{1:i}\right.\right)}" display="inline"><semantics id="S4.E1.m1.2a"><mrow id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml"><msub id="S4.E1.m1.2.2.3" xref="S4.E1.m1.2.2.3.cmml"><mi class="ltx_font_mathscript" id="S4.E1.m1.2.2.3.2" xref="S4.E1.m1.2.2.3.2.cmml">ℒ</mi><mtext id="S4.E1.m1.2.2.3.3" xref="S4.E1.m1.2.2.3.3a.cmml">lm</mtext></msub><mo id="S4.E1.m1.2.2.2" xref="S4.E1.m1.2.2.2.cmml">=</mo><mrow id="S4.E1.m1.2.2.1" xref="S4.E1.m1.2.2.1.cmml"><mi id="S4.E1.m1.2.2.1.3" xref="S4.E1.m1.2.2.1.3.cmml">max</mi><mo lspace="0.167em" rspace="0em" id="S4.E1.m1.2.2.1.2" xref="S4.E1.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E1.m1.2.2.1.1" xref="S4.E1.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S4.E1.m1.2.2.1.1.2" xref="S4.E1.m1.2.2.1.1.2.cmml"><munderover id="S4.E1.m1.2.2.1.1.2a" xref="S4.E1.m1.2.2.1.1.2.cmml"><mo movablelimits="false" id="S4.E1.m1.2.2.1.1.2.2.2" xref="S4.E1.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E1.m1.2.2.1.1.2.2.3" xref="S4.E1.m1.2.2.1.1.2.2.3.cmml"><mi id="S4.E1.m1.2.2.1.1.2.2.3.2" xref="S4.E1.m1.2.2.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E1.m1.2.2.1.1.2.2.3.1" xref="S4.E1.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E1.m1.2.2.1.1.2.2.3.3" xref="S4.E1.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E1.m1.2.2.1.1.2.3" xref="S4.E1.m1.2.2.1.1.2.3.cmml">T</mi></munderover></mstyle><mrow id="S4.E1.m1.2.2.1.1.1" xref="S4.E1.m1.2.2.1.1.1.cmml"><mrow id="S4.E1.m1.2.2.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.3.cmml"><mi id="S4.E1.m1.2.2.1.1.1.3.1" xref="S4.E1.m1.2.2.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E1.m1.2.2.1.1.1.3a" xref="S4.E1.m1.2.2.1.1.1.3.cmml">⁡</mo><mi id="S4.E1.m1.2.2.1.1.1.3.2" xref="S4.E1.m1.2.2.1.1.1.3.2.cmml">P</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E1.m1.2.2.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E1.m1.2.2.1.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E1.m1.2.2.1.1.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.2.2.1.1.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S4.E1.m1.2.2.1.1.1.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.2.2.1.1.1.1.1.1.3.2" xref="S4.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml">𝒔</mi><mi id="S4.E1.m1.2.2.1.1.1.1.1.1.3.3" xref="S4.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" stretchy="true" id="S4.E1.m1.2.2.1.1.1.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">𝒁</mi><mo id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝒔</mi><mrow id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S4.E1.m1.2.2.1.1.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.2b"><apply id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2"><eq id="S4.E1.m1.2.2.2.cmml" xref="S4.E1.m1.2.2.2"></eq><apply id="S4.E1.m1.2.2.3.cmml" xref="S4.E1.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.3.1.cmml" xref="S4.E1.m1.2.2.3">subscript</csymbol><ci id="S4.E1.m1.2.2.3.2.cmml" xref="S4.E1.m1.2.2.3.2">ℒ</ci><ci id="S4.E1.m1.2.2.3.3a.cmml" xref="S4.E1.m1.2.2.3.3"><mtext mathsize="70%" id="S4.E1.m1.2.2.3.3.cmml" xref="S4.E1.m1.2.2.3.3">lm</mtext></ci></apply><apply id="S4.E1.m1.2.2.1.cmml" xref="S4.E1.m1.2.2.1"><times id="S4.E1.m1.2.2.1.2.cmml" xref="S4.E1.m1.2.2.1.2"></times><max id="S4.E1.m1.2.2.1.3.cmml" xref="S4.E1.m1.2.2.1.3"></max><apply id="S4.E1.m1.2.2.1.1.cmml" xref="S4.E1.m1.2.2.1.1"><apply id="S4.E1.m1.2.2.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.2.1.cmml" xref="S4.E1.m1.2.2.1.1.2">superscript</csymbol><apply id="S4.E1.m1.2.2.1.1.2.2.cmml" xref="S4.E1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.2.2.1.cmml" xref="S4.E1.m1.2.2.1.1.2">subscript</csymbol><sum id="S4.E1.m1.2.2.1.1.2.2.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.2"></sum><apply id="S4.E1.m1.2.2.1.1.2.2.3.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3"><eq id="S4.E1.m1.2.2.1.1.2.2.3.1.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.1"></eq><ci id="S4.E1.m1.2.2.1.1.2.2.3.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E1.m1.2.2.1.1.2.2.3.3.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E1.m1.2.2.1.1.2.3.cmml" xref="S4.E1.m1.2.2.1.1.2.3">𝑇</ci></apply><apply id="S4.E1.m1.2.2.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1"><times id="S4.E1.m1.2.2.1.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.1.2"></times><apply id="S4.E1.m1.2.2.1.1.1.3.cmml" xref="S4.E1.m1.2.2.1.1.1.3"><log id="S4.E1.m1.2.2.1.1.1.3.1.cmml" xref="S4.E1.m1.2.2.1.1.1.3.1"></log><ci id="S4.E1.m1.2.2.1.1.1.3.2.cmml" xref="S4.E1.m1.2.2.1.1.1.3.2">𝑃</ci></apply><apply id="S4.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.2">conditional</csymbol><apply id="S4.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.3.2">𝒔</ci><ci id="S4.E1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.3.3">𝑖</ci></apply><list id="S4.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1"><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝒁</ci><apply id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝒔</ci><apply id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3"><ci id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.2c">\displaystyle\mathscr{L}_{\text{lm}}=\max\sum_{i=1}^{T}{\log P\left(\boldsymbol{s}_{i}\left|\boldsymbol{Z},\boldsymbol{s}_{1:i}\right.\right)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.p4" class="ltx_para ltx_noindent">
<p id="S4.p4.11" class="ltx_p"><span id="S4.p4.11.1" class="ltx_text ltx_font_bold">Physical Decoder.</span>
Given the output <math id="S4.p4.1.m1.5" class="ltx_Math" alttext="\boldsymbol{H}=\{\boldsymbol{h}_{i}\in\mathbb{R}^{D}\mid i=1,\ldots,T\}" display="inline"><semantics id="S4.p4.1.m1.5a"><mrow id="S4.p4.1.m1.5.5" xref="S4.p4.1.m1.5.5.cmml"><mi id="S4.p4.1.m1.5.5.4" xref="S4.p4.1.m1.5.5.4.cmml">𝑯</mi><mo id="S4.p4.1.m1.5.5.3" xref="S4.p4.1.m1.5.5.3.cmml">=</mo><mrow id="S4.p4.1.m1.5.5.2.2" xref="S4.p4.1.m1.5.5.2.3.cmml"><mo stretchy="false" id="S4.p4.1.m1.5.5.2.2.3" xref="S4.p4.1.m1.5.5.2.3.1.cmml">{</mo><mrow id="S4.p4.1.m1.4.4.1.1.1" xref="S4.p4.1.m1.4.4.1.1.1.cmml"><msub id="S4.p4.1.m1.4.4.1.1.1.2" xref="S4.p4.1.m1.4.4.1.1.1.2.cmml"><mi id="S4.p4.1.m1.4.4.1.1.1.2.2" xref="S4.p4.1.m1.4.4.1.1.1.2.2.cmml">𝒉</mi><mi id="S4.p4.1.m1.4.4.1.1.1.2.3" xref="S4.p4.1.m1.4.4.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.p4.1.m1.4.4.1.1.1.1" xref="S4.p4.1.m1.4.4.1.1.1.1.cmml">∈</mo><msup id="S4.p4.1.m1.4.4.1.1.1.3" xref="S4.p4.1.m1.4.4.1.1.1.3.cmml"><mi id="S4.p4.1.m1.4.4.1.1.1.3.2" xref="S4.p4.1.m1.4.4.1.1.1.3.2.cmml">ℝ</mi><mi id="S4.p4.1.m1.4.4.1.1.1.3.3" xref="S4.p4.1.m1.4.4.1.1.1.3.3.cmml">D</mi></msup></mrow><mo fence="true" lspace="0em" rspace="0em" id="S4.p4.1.m1.5.5.2.2.4" xref="S4.p4.1.m1.5.5.2.3.1.cmml">∣</mo><mrow id="S4.p4.1.m1.5.5.2.2.2" xref="S4.p4.1.m1.5.5.2.2.2.cmml"><mi id="S4.p4.1.m1.5.5.2.2.2.2" xref="S4.p4.1.m1.5.5.2.2.2.2.cmml">i</mi><mo id="S4.p4.1.m1.5.5.2.2.2.1" xref="S4.p4.1.m1.5.5.2.2.2.1.cmml">=</mo><mrow id="S4.p4.1.m1.5.5.2.2.2.3.2" xref="S4.p4.1.m1.5.5.2.2.2.3.1.cmml"><mn id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml">1</mn><mo id="S4.p4.1.m1.5.5.2.2.2.3.2.1" xref="S4.p4.1.m1.5.5.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.p4.1.m1.2.2" xref="S4.p4.1.m1.2.2.cmml">…</mi><mo id="S4.p4.1.m1.5.5.2.2.2.3.2.2" xref="S4.p4.1.m1.5.5.2.2.2.3.1.cmml">,</mo><mi id="S4.p4.1.m1.3.3" xref="S4.p4.1.m1.3.3.cmml">T</mi></mrow></mrow><mo stretchy="false" id="S4.p4.1.m1.5.5.2.2.5" xref="S4.p4.1.m1.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.5b"><apply id="S4.p4.1.m1.5.5.cmml" xref="S4.p4.1.m1.5.5"><eq id="S4.p4.1.m1.5.5.3.cmml" xref="S4.p4.1.m1.5.5.3"></eq><ci id="S4.p4.1.m1.5.5.4.cmml" xref="S4.p4.1.m1.5.5.4">𝑯</ci><apply id="S4.p4.1.m1.5.5.2.3.cmml" xref="S4.p4.1.m1.5.5.2.2"><csymbol cd="latexml" id="S4.p4.1.m1.5.5.2.3.1.cmml" xref="S4.p4.1.m1.5.5.2.2.3">conditional-set</csymbol><apply id="S4.p4.1.m1.4.4.1.1.1.cmml" xref="S4.p4.1.m1.4.4.1.1.1"><in id="S4.p4.1.m1.4.4.1.1.1.1.cmml" xref="S4.p4.1.m1.4.4.1.1.1.1"></in><apply id="S4.p4.1.m1.4.4.1.1.1.2.cmml" xref="S4.p4.1.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.p4.1.m1.4.4.1.1.1.2.1.cmml" xref="S4.p4.1.m1.4.4.1.1.1.2">subscript</csymbol><ci id="S4.p4.1.m1.4.4.1.1.1.2.2.cmml" xref="S4.p4.1.m1.4.4.1.1.1.2.2">𝒉</ci><ci id="S4.p4.1.m1.4.4.1.1.1.2.3.cmml" xref="S4.p4.1.m1.4.4.1.1.1.2.3">𝑖</ci></apply><apply id="S4.p4.1.m1.4.4.1.1.1.3.cmml" xref="S4.p4.1.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S4.p4.1.m1.4.4.1.1.1.3.1.cmml" xref="S4.p4.1.m1.4.4.1.1.1.3">superscript</csymbol><ci id="S4.p4.1.m1.4.4.1.1.1.3.2.cmml" xref="S4.p4.1.m1.4.4.1.1.1.3.2">ℝ</ci><ci id="S4.p4.1.m1.4.4.1.1.1.3.3.cmml" xref="S4.p4.1.m1.4.4.1.1.1.3.3">𝐷</ci></apply></apply><apply id="S4.p4.1.m1.5.5.2.2.2.cmml" xref="S4.p4.1.m1.5.5.2.2.2"><eq id="S4.p4.1.m1.5.5.2.2.2.1.cmml" xref="S4.p4.1.m1.5.5.2.2.2.1"></eq><ci id="S4.p4.1.m1.5.5.2.2.2.2.cmml" xref="S4.p4.1.m1.5.5.2.2.2.2">𝑖</ci><list id="S4.p4.1.m1.5.5.2.2.2.3.1.cmml" xref="S4.p4.1.m1.5.5.2.2.2.3.2"><cn type="integer" id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1">1</cn><ci id="S4.p4.1.m1.2.2.cmml" xref="S4.p4.1.m1.2.2">…</ci><ci id="S4.p4.1.m1.3.3.cmml" xref="S4.p4.1.m1.3.3">𝑇</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.5c">\boldsymbol{H}=\{\boldsymbol{h}_{i}\in\mathbb{R}^{D}\mid i=1,\ldots,T\}</annotation></semantics></math> from the last layer of the text decoder, the physical decoder decodes these hidden states to obtain the polygon coordinates <math id="S4.p4.2.m2.1" class="ltx_Math" alttext="\boldsymbol{p}_{i}" display="inline"><semantics id="S4.p4.2.m2.1a"><msub id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml"><mi id="S4.p4.2.m2.1.1.2" xref="S4.p4.2.m2.1.1.2.cmml">𝒑</mi><mi id="S4.p4.2.m2.1.1.3" xref="S4.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><apply id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p4.2.m2.1.1.1.cmml" xref="S4.p4.2.m2.1.1">subscript</csymbol><ci id="S4.p4.2.m2.1.1.2.cmml" xref="S4.p4.2.m2.1.1.2">𝒑</ci><ci id="S4.p4.2.m2.1.1.3.cmml" xref="S4.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">\boldsymbol{p}_{i}</annotation></semantics></math> in the image. To facilitate this prediction, we introduce a set of 1,000 special tokens—&lt;0&gt;, &lt;1&gt;, …, &lt;999&gt;—which are utilized for quantizing the coordinates of the polygons, forming a specialized vocabulary <math id="S4.p4.3.m3.1" class="ltx_Math" alttext="\boldsymbol{Loc}\in\mathbb{R}^{1000\times D}" display="inline"><semantics id="S4.p4.3.m3.1a"><mrow id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml"><mrow id="S4.p4.3.m3.1.1.2" xref="S4.p4.3.m3.1.1.2.cmml"><mi id="S4.p4.3.m3.1.1.2.2" xref="S4.p4.3.m3.1.1.2.2.cmml">𝑳</mi><mo lspace="0em" rspace="0em" id="S4.p4.3.m3.1.1.2.1" xref="S4.p4.3.m3.1.1.2.1.cmml">​</mo><mi id="S4.p4.3.m3.1.1.2.3" xref="S4.p4.3.m3.1.1.2.3.cmml">𝒐</mi><mo lspace="0em" rspace="0em" id="S4.p4.3.m3.1.1.2.1a" xref="S4.p4.3.m3.1.1.2.1.cmml">​</mo><mi id="S4.p4.3.m3.1.1.2.4" xref="S4.p4.3.m3.1.1.2.4.cmml">𝒄</mi></mrow><mo id="S4.p4.3.m3.1.1.1" xref="S4.p4.3.m3.1.1.1.cmml">∈</mo><msup id="S4.p4.3.m3.1.1.3" xref="S4.p4.3.m3.1.1.3.cmml"><mi id="S4.p4.3.m3.1.1.3.2" xref="S4.p4.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.p4.3.m3.1.1.3.3" xref="S4.p4.3.m3.1.1.3.3.cmml"><mn id="S4.p4.3.m3.1.1.3.3.2" xref="S4.p4.3.m3.1.1.3.3.2.cmml">1000</mn><mo lspace="0.222em" rspace="0.222em" id="S4.p4.3.m3.1.1.3.3.1" xref="S4.p4.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.p4.3.m3.1.1.3.3.3" xref="S4.p4.3.m3.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><apply id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1"><in id="S4.p4.3.m3.1.1.1.cmml" xref="S4.p4.3.m3.1.1.1"></in><apply id="S4.p4.3.m3.1.1.2.cmml" xref="S4.p4.3.m3.1.1.2"><times id="S4.p4.3.m3.1.1.2.1.cmml" xref="S4.p4.3.m3.1.1.2.1"></times><ci id="S4.p4.3.m3.1.1.2.2.cmml" xref="S4.p4.3.m3.1.1.2.2">𝑳</ci><ci id="S4.p4.3.m3.1.1.2.3.cmml" xref="S4.p4.3.m3.1.1.2.3">𝒐</ci><ci id="S4.p4.3.m3.1.1.2.4.cmml" xref="S4.p4.3.m3.1.1.2.4">𝒄</ci></apply><apply id="S4.p4.3.m3.1.1.3.cmml" xref="S4.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.p4.3.m3.1.1.3.1.cmml" xref="S4.p4.3.m3.1.1.3">superscript</csymbol><ci id="S4.p4.3.m3.1.1.3.2.cmml" xref="S4.p4.3.m3.1.1.3.2">ℝ</ci><apply id="S4.p4.3.m3.1.1.3.3.cmml" xref="S4.p4.3.m3.1.1.3.3"><times id="S4.p4.3.m3.1.1.3.3.1.cmml" xref="S4.p4.3.m3.1.1.3.3.1"></times><cn type="integer" id="S4.p4.3.m3.1.1.3.3.2.cmml" xref="S4.p4.3.m3.1.1.3.3.2">1000</cn><ci id="S4.p4.3.m3.1.1.3.3.3.cmml" xref="S4.p4.3.m3.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">\boldsymbol{Loc}\in\mathbb{R}^{1000\times D}</annotation></semantics></math>. Specifically, for each coordinate point <math id="S4.p4.4.m4.1" class="ltx_Math" alttext="p_{j}" display="inline"><semantics id="S4.p4.4.m4.1a"><msub id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml"><mi id="S4.p4.4.m4.1.1.2" xref="S4.p4.4.m4.1.1.2.cmml">p</mi><mi id="S4.p4.4.m4.1.1.3" xref="S4.p4.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><apply id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p4.4.m4.1.1.1.cmml" xref="S4.p4.4.m4.1.1">subscript</csymbol><ci id="S4.p4.4.m4.1.1.2.cmml" xref="S4.p4.4.m4.1.1.2">𝑝</ci><ci id="S4.p4.4.m4.1.1.3.cmml" xref="S4.p4.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">p_{j}</annotation></semantics></math> in the polygon <math id="S4.p4.5.m5.1" class="ltx_Math" alttext="\boldsymbol{p}_{i}" display="inline"><semantics id="S4.p4.5.m5.1a"><msub id="S4.p4.5.m5.1.1" xref="S4.p4.5.m5.1.1.cmml"><mi id="S4.p4.5.m5.1.1.2" xref="S4.p4.5.m5.1.1.2.cmml">𝒑</mi><mi id="S4.p4.5.m5.1.1.3" xref="S4.p4.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.5.m5.1b"><apply id="S4.p4.5.m5.1.1.cmml" xref="S4.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p4.5.m5.1.1.1.cmml" xref="S4.p4.5.m5.1.1">subscript</csymbol><ci id="S4.p4.5.m5.1.1.2.cmml" xref="S4.p4.5.m5.1.1.2">𝒑</ci><ci id="S4.p4.5.m5.1.1.3.cmml" xref="S4.p4.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m5.1c">\boldsymbol{p}_{i}</annotation></semantics></math>, the prediction process is as follows: The corresponding hidden state <math id="S4.p4.6.m6.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}" display="inline"><semantics id="S4.p4.6.m6.1a"><msub id="S4.p4.6.m6.1.1" xref="S4.p4.6.m6.1.1.cmml"><mi id="S4.p4.6.m6.1.1.2" xref="S4.p4.6.m6.1.1.2.cmml">𝒉</mi><mi id="S4.p4.6.m6.1.1.3" xref="S4.p4.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.6.m6.1b"><apply id="S4.p4.6.m6.1.1.cmml" xref="S4.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p4.6.m6.1.1.1.cmml" xref="S4.p4.6.m6.1.1">subscript</csymbol><ci id="S4.p4.6.m6.1.1.2.cmml" xref="S4.p4.6.m6.1.1.2">𝒉</ci><ci id="S4.p4.6.m6.1.1.3.cmml" xref="S4.p4.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.m6.1c">\boldsymbol{h}_{i}</annotation></semantics></math> is transformed via a linear mapping to produce the <math id="S4.p4.7.m7.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}^{p_{j}}" display="inline"><semantics id="S4.p4.7.m7.1a"><msubsup id="S4.p4.7.m7.1.1" xref="S4.p4.7.m7.1.1.cmml"><mi id="S4.p4.7.m7.1.1.2.2" xref="S4.p4.7.m7.1.1.2.2.cmml">𝒉</mi><mi id="S4.p4.7.m7.1.1.2.3" xref="S4.p4.7.m7.1.1.2.3.cmml">i</mi><msub id="S4.p4.7.m7.1.1.3" xref="S4.p4.7.m7.1.1.3.cmml"><mi id="S4.p4.7.m7.1.1.3.2" xref="S4.p4.7.m7.1.1.3.2.cmml">p</mi><mi id="S4.p4.7.m7.1.1.3.3" xref="S4.p4.7.m7.1.1.3.3.cmml">j</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S4.p4.7.m7.1b"><apply id="S4.p4.7.m7.1.1.cmml" xref="S4.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p4.7.m7.1.1.1.cmml" xref="S4.p4.7.m7.1.1">superscript</csymbol><apply id="S4.p4.7.m7.1.1.2.cmml" xref="S4.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p4.7.m7.1.1.2.1.cmml" xref="S4.p4.7.m7.1.1">subscript</csymbol><ci id="S4.p4.7.m7.1.1.2.2.cmml" xref="S4.p4.7.m7.1.1.2.2">𝒉</ci><ci id="S4.p4.7.m7.1.1.2.3.cmml" xref="S4.p4.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S4.p4.7.m7.1.1.3.cmml" xref="S4.p4.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.p4.7.m7.1.1.3.1.cmml" xref="S4.p4.7.m7.1.1.3">subscript</csymbol><ci id="S4.p4.7.m7.1.1.3.2.cmml" xref="S4.p4.7.m7.1.1.3.2">𝑝</ci><ci id="S4.p4.7.m7.1.1.3.3.cmml" xref="S4.p4.7.m7.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.7.m7.1c">\boldsymbol{h}_{i}^{p_{j}}</annotation></semantics></math>, which serves as a query against the vocabulary <math id="S4.p4.8.m8.1" class="ltx_Math" alttext="\boldsymbol{Loc}" display="inline"><semantics id="S4.p4.8.m8.1a"><mrow id="S4.p4.8.m8.1.1" xref="S4.p4.8.m8.1.1.cmml"><mi id="S4.p4.8.m8.1.1.2" xref="S4.p4.8.m8.1.1.2.cmml">𝑳</mi><mo lspace="0em" rspace="0em" id="S4.p4.8.m8.1.1.1" xref="S4.p4.8.m8.1.1.1.cmml">​</mo><mi id="S4.p4.8.m8.1.1.3" xref="S4.p4.8.m8.1.1.3.cmml">𝒐</mi><mo lspace="0em" rspace="0em" id="S4.p4.8.m8.1.1.1a" xref="S4.p4.8.m8.1.1.1.cmml">​</mo><mi id="S4.p4.8.m8.1.1.4" xref="S4.p4.8.m8.1.1.4.cmml">𝒄</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.8.m8.1b"><apply id="S4.p4.8.m8.1.1.cmml" xref="S4.p4.8.m8.1.1"><times id="S4.p4.8.m8.1.1.1.cmml" xref="S4.p4.8.m8.1.1.1"></times><ci id="S4.p4.8.m8.1.1.2.cmml" xref="S4.p4.8.m8.1.1.2">𝑳</ci><ci id="S4.p4.8.m8.1.1.3.cmml" xref="S4.p4.8.m8.1.1.3">𝒐</ci><ci id="S4.p4.8.m8.1.1.4.cmml" xref="S4.p4.8.m8.1.1.4">𝒄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.8.m8.1c">\boldsymbol{Loc}</annotation></semantics></math>. Unlike previous method <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>)</cite>, which perform direct classification over the location vocabulary, we define the final position of <math id="S4.p4.9.m9.1" class="ltx_Math" alttext="p_{j}" display="inline"><semantics id="S4.p4.9.m9.1a"><msub id="S4.p4.9.m9.1.1" xref="S4.p4.9.m9.1.1.cmml"><mi id="S4.p4.9.m9.1.1.2" xref="S4.p4.9.m9.1.1.2.cmml">p</mi><mi id="S4.p4.9.m9.1.1.3" xref="S4.p4.9.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.9.m9.1b"><apply id="S4.p4.9.m9.1.1.cmml" xref="S4.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S4.p4.9.m9.1.1.1.cmml" xref="S4.p4.9.m9.1.1">subscript</csymbol><ci id="S4.p4.9.m9.1.1.2.cmml" xref="S4.p4.9.m9.1.1.2">𝑝</ci><ci id="S4.p4.9.m9.1.1.3.cmml" xref="S4.p4.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.9.m9.1c">p_{j}</annotation></semantics></math> as the expected location based on the distribution given by <math id="S4.p4.10.m10.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}^{p_{j}}" display="inline"><semantics id="S4.p4.10.m10.1a"><msubsup id="S4.p4.10.m10.1.1" xref="S4.p4.10.m10.1.1.cmml"><mi id="S4.p4.10.m10.1.1.2.2" xref="S4.p4.10.m10.1.1.2.2.cmml">𝒉</mi><mi id="S4.p4.10.m10.1.1.2.3" xref="S4.p4.10.m10.1.1.2.3.cmml">i</mi><msub id="S4.p4.10.m10.1.1.3" xref="S4.p4.10.m10.1.1.3.cmml"><mi id="S4.p4.10.m10.1.1.3.2" xref="S4.p4.10.m10.1.1.3.2.cmml">p</mi><mi id="S4.p4.10.m10.1.1.3.3" xref="S4.p4.10.m10.1.1.3.3.cmml">j</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S4.p4.10.m10.1b"><apply id="S4.p4.10.m10.1.1.cmml" xref="S4.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S4.p4.10.m10.1.1.1.cmml" xref="S4.p4.10.m10.1.1">superscript</csymbol><apply id="S4.p4.10.m10.1.1.2.cmml" xref="S4.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S4.p4.10.m10.1.1.2.1.cmml" xref="S4.p4.10.m10.1.1">subscript</csymbol><ci id="S4.p4.10.m10.1.1.2.2.cmml" xref="S4.p4.10.m10.1.1.2.2">𝒉</ci><ci id="S4.p4.10.m10.1.1.2.3.cmml" xref="S4.p4.10.m10.1.1.2.3">𝑖</ci></apply><apply id="S4.p4.10.m10.1.1.3.cmml" xref="S4.p4.10.m10.1.1.3"><csymbol cd="ambiguous" id="S4.p4.10.m10.1.1.3.1.cmml" xref="S4.p4.10.m10.1.1.3">subscript</csymbol><ci id="S4.p4.10.m10.1.1.3.2.cmml" xref="S4.p4.10.m10.1.1.3.2">𝑝</ci><ci id="S4.p4.10.m10.1.1.3.3.cmml" xref="S4.p4.10.m10.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.10.m10.1c">\boldsymbol{h}_{i}^{p_{j}}</annotation></semantics></math> over <math id="S4.p4.11.m11.1" class="ltx_Math" alttext="\boldsymbol{Loc}" display="inline"><semantics id="S4.p4.11.m11.1a"><mrow id="S4.p4.11.m11.1.1" xref="S4.p4.11.m11.1.1.cmml"><mi id="S4.p4.11.m11.1.1.2" xref="S4.p4.11.m11.1.1.2.cmml">𝑳</mi><mo lspace="0em" rspace="0em" id="S4.p4.11.m11.1.1.1" xref="S4.p4.11.m11.1.1.1.cmml">​</mo><mi id="S4.p4.11.m11.1.1.3" xref="S4.p4.11.m11.1.1.3.cmml">𝒐</mi><mo lspace="0em" rspace="0em" id="S4.p4.11.m11.1.1.1a" xref="S4.p4.11.m11.1.1.1.cmml">​</mo><mi id="S4.p4.11.m11.1.1.4" xref="S4.p4.11.m11.1.1.4.cmml">𝒄</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.11.m11.1b"><apply id="S4.p4.11.m11.1.1.cmml" xref="S4.p4.11.m11.1.1"><times id="S4.p4.11.m11.1.1.1.cmml" xref="S4.p4.11.m11.1.1.1"></times><ci id="S4.p4.11.m11.1.1.2.cmml" xref="S4.p4.11.m11.1.1.2">𝑳</ci><ci id="S4.p4.11.m11.1.1.3.cmml" xref="S4.p4.11.m11.1.1.3">𝒐</ci><ci id="S4.p4.11.m11.1.1.4.cmml" xref="S4.p4.11.m11.1.1.4">𝒄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.11.m11.1c">\boldsymbol{Loc}</annotation></semantics></math>:</p>
<table id="A1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E2.m1.1" class="ltx_Math" alttext="\displaystyle\boldsymbol{h}_{i}^{p_{j}}=\text{Linear}\left(\boldsymbol{h}_{i}\right)" display="inline"><semantics id="S4.E2.m1.1a"><mrow id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml"><msubsup id="S4.E2.m1.1.1.3" xref="S4.E2.m1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.3.2.2" xref="S4.E2.m1.1.1.3.2.2.cmml">𝒉</mi><mi id="S4.E2.m1.1.1.3.2.3" xref="S4.E2.m1.1.1.3.2.3.cmml">i</mi><msub id="S4.E2.m1.1.1.3.3" xref="S4.E2.m1.1.1.3.3.cmml"><mi id="S4.E2.m1.1.1.3.3.2" xref="S4.E2.m1.1.1.3.3.2.cmml">p</mi><mi id="S4.E2.m1.1.1.3.3.3" xref="S4.E2.m1.1.1.3.3.3.cmml">j</mi></msub></msubsup><mo id="S4.E2.m1.1.1.2" xref="S4.E2.m1.1.1.2.cmml">=</mo><mrow id="S4.E2.m1.1.1.1" xref="S4.E2.m1.1.1.1.cmml"><mtext id="S4.E2.m1.1.1.1.3" xref="S4.E2.m1.1.1.1.3a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.2" xref="S4.E2.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E2.m1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.2.cmml">𝒉</mi><mi id="S4.E2.m1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E2.m1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><apply id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1"><eq id="S4.E2.m1.1.1.2.cmml" xref="S4.E2.m1.1.1.2"></eq><apply id="S4.E2.m1.1.1.3.cmml" xref="S4.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.3">superscript</csymbol><apply id="S4.E2.m1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.3.2.1.cmml" xref="S4.E2.m1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.1.1.3.2.2.cmml" xref="S4.E2.m1.1.1.3.2.2">𝒉</ci><ci id="S4.E2.m1.1.1.3.2.3.cmml" xref="S4.E2.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S4.E2.m1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.3.3.1.cmml" xref="S4.E2.m1.1.1.3.3">subscript</csymbol><ci id="S4.E2.m1.1.1.3.3.2.cmml" xref="S4.E2.m1.1.1.3.3.2">𝑝</ci><ci id="S4.E2.m1.1.1.3.3.3.cmml" xref="S4.E2.m1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S4.E2.m1.1.1.1.cmml" xref="S4.E2.m1.1.1.1"><times id="S4.E2.m1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.2"></times><ci id="S4.E2.m1.1.1.1.3a.cmml" xref="S4.E2.m1.1.1.1.3"><mtext id="S4.E2.m1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.3">Linear</mtext></ci><apply id="S4.E2.m1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2">𝒉</ci><ci id="S4.E2.m1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">\displaystyle\boldsymbol{h}_{i}^{p_{j}}=\text{Linear}\left(\boldsymbol{h}_{i}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table id="A1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E3.m1.1" class="ltx_Math" alttext="\displaystyle\boldsymbol{a}^{p_{j}}=\text{softmax}\left(\boldsymbol{h}_{i}^{p_{j}}\boldsymbol{Loc}^{\top}\right)" display="inline"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml"><msup id="S4.E3.m1.1.1.3" xref="S4.E3.m1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.3.2" xref="S4.E3.m1.1.1.3.2.cmml">𝒂</mi><msub id="S4.E3.m1.1.1.3.3" xref="S4.E3.m1.1.1.3.3.cmml"><mi id="S4.E3.m1.1.1.3.3.2" xref="S4.E3.m1.1.1.3.3.2.cmml">p</mi><mi id="S4.E3.m1.1.1.3.3.3" xref="S4.E3.m1.1.1.3.3.3.cmml">j</mi></msub></msup><mo id="S4.E3.m1.1.1.2" xref="S4.E3.m1.1.1.2.cmml">=</mo><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.cmml"><mtext id="S4.E3.m1.1.1.1.3" xref="S4.E3.m1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml"><msubsup id="S4.E3.m1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.2.2.2" xref="S4.E3.m1.1.1.1.1.1.1.2.2.2.cmml">𝒉</mi><mi id="S4.E3.m1.1.1.1.1.1.1.2.2.3" xref="S4.E3.m1.1.1.1.1.1.1.2.2.3.cmml">i</mi><msub id="S4.E3.m1.1.1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.2.3.2" xref="S4.E3.m1.1.1.1.1.1.1.2.3.2.cmml">p</mi><mi id="S4.E3.m1.1.1.1.1.1.1.2.3.3" xref="S4.E3.m1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.E3.m1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.3.cmml">𝑳</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.1.1.1a" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.E3.m1.1.1.1.1.1.1.4" xref="S4.E3.m1.1.1.1.1.1.1.4.cmml">𝒐</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.1.1.1b" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml">​</mo><msup id="S4.E3.m1.1.1.1.1.1.1.5" xref="S4.E3.m1.1.1.1.1.1.1.5.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.5.2" xref="S4.E3.m1.1.1.1.1.1.1.5.2.cmml">𝒄</mi><mo id="S4.E3.m1.1.1.1.1.1.1.5.3" xref="S4.E3.m1.1.1.1.1.1.1.5.3.cmml">⊤</mo></msup></mrow><mo id="S4.E3.m1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1"><eq id="S4.E3.m1.1.1.2.cmml" xref="S4.E3.m1.1.1.2"></eq><apply id="S4.E3.m1.1.1.3.cmml" xref="S4.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.3">superscript</csymbol><ci id="S4.E3.m1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.3.2">𝒂</ci><apply id="S4.E3.m1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.3.3.1.cmml" xref="S4.E3.m1.1.1.3.3">subscript</csymbol><ci id="S4.E3.m1.1.1.3.3.2.cmml" xref="S4.E3.m1.1.1.3.3.2">𝑝</ci><ci id="S4.E3.m1.1.1.3.3.3.cmml" xref="S4.E3.m1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><times id="S4.E3.m1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.2"></times><ci id="S4.E3.m1.1.1.1.3a.cmml" xref="S4.E3.m1.1.1.1.3"><mtext id="S4.E3.m1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.3">softmax</mtext></ci><apply id="S4.E3.m1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1"><times id="S4.E3.m1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1"></times><apply id="S4.E3.m1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.2.2">𝒉</ci><ci id="S4.E3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.3.2">𝑝</ci><ci id="S4.E3.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><ci id="S4.E3.m1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.3">𝑳</ci><ci id="S4.E3.m1.1.1.1.1.1.1.4.cmml" xref="S4.E3.m1.1.1.1.1.1.1.4">𝒐</ci><apply id="S4.E3.m1.1.1.1.1.1.1.5.cmml" xref="S4.E3.m1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.5.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.5">superscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.5.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.5.2">𝒄</ci><csymbol cd="latexml" id="S4.E3.m1.1.1.1.1.1.1.5.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.5.3">top</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\displaystyle\boldsymbol{a}^{p_{j}}=\text{softmax}\left(\boldsymbol{h}_{i}^{p_{j}}\boldsymbol{Loc}^{\top}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<table id="A1.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4.m1.1" class="ltx_Math" alttext="\displaystyle E\left(p_{j}\right)=\sum_{i=0}^{999}{i\cdot a_{i}^{p_{j}}}" display="inline"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml"><mo id="S4.E4.m1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S4.E4.m1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.E4.m1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.1.1.2" xref="S4.E4.m1.1.1.2.cmml">=</mo><mrow id="S4.E4.m1.1.1.3" xref="S4.E4.m1.1.1.3.cmml"><mstyle displaystyle="true" id="S4.E4.m1.1.1.3.1" xref="S4.E4.m1.1.1.3.1.cmml"><munderover id="S4.E4.m1.1.1.3.1a" xref="S4.E4.m1.1.1.3.1.cmml"><mo movablelimits="false" id="S4.E4.m1.1.1.3.1.2.2" xref="S4.E4.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E4.m1.1.1.3.1.2.3" xref="S4.E4.m1.1.1.3.1.2.3.cmml"><mi id="S4.E4.m1.1.1.3.1.2.3.2" xref="S4.E4.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.E4.m1.1.1.3.1.2.3.1" xref="S4.E4.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E4.m1.1.1.3.1.2.3.3" xref="S4.E4.m1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mn id="S4.E4.m1.1.1.3.1.3" xref="S4.E4.m1.1.1.3.1.3.cmml">999</mn></munderover></mstyle><mrow id="S4.E4.m1.1.1.3.2" xref="S4.E4.m1.1.1.3.2.cmml"><mi id="S4.E4.m1.1.1.3.2.2" xref="S4.E4.m1.1.1.3.2.2.cmml">i</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E4.m1.1.1.3.2.1" xref="S4.E4.m1.1.1.3.2.1.cmml">⋅</mo><msubsup id="S4.E4.m1.1.1.3.2.3" xref="S4.E4.m1.1.1.3.2.3.cmml"><mi id="S4.E4.m1.1.1.3.2.3.2.2" xref="S4.E4.m1.1.1.3.2.3.2.2.cmml">a</mi><mi id="S4.E4.m1.1.1.3.2.3.2.3" xref="S4.E4.m1.1.1.3.2.3.2.3.cmml">i</mi><msub id="S4.E4.m1.1.1.3.2.3.3" xref="S4.E4.m1.1.1.3.2.3.3.cmml"><mi id="S4.E4.m1.1.1.3.2.3.3.2" xref="S4.E4.m1.1.1.3.2.3.3.2.cmml">p</mi><mi id="S4.E4.m1.1.1.3.2.3.3.3" xref="S4.E4.m1.1.1.3.2.3.3.3.cmml">j</mi></msub></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"><eq id="S4.E4.m1.1.1.2.cmml" xref="S4.E4.m1.1.1.2"></eq><apply id="S4.E4.m1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><times id="S4.E4.m1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.2"></times><ci id="S4.E4.m1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.3">𝐸</ci><apply id="S4.E4.m1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="S4.E4.m1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S4.E4.m1.1.1.3.cmml" xref="S4.E4.m1.1.1.3"><apply id="S4.E4.m1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.3.1.1.cmml" xref="S4.E4.m1.1.1.3.1">superscript</csymbol><apply id="S4.E4.m1.1.1.3.1.2.cmml" xref="S4.E4.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.3.1.2.1.cmml" xref="S4.E4.m1.1.1.3.1">subscript</csymbol><sum id="S4.E4.m1.1.1.3.1.2.2.cmml" xref="S4.E4.m1.1.1.3.1.2.2"></sum><apply id="S4.E4.m1.1.1.3.1.2.3.cmml" xref="S4.E4.m1.1.1.3.1.2.3"><eq id="S4.E4.m1.1.1.3.1.2.3.1.cmml" xref="S4.E4.m1.1.1.3.1.2.3.1"></eq><ci id="S4.E4.m1.1.1.3.1.2.3.2.cmml" xref="S4.E4.m1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E4.m1.1.1.3.1.2.3.3.cmml" xref="S4.E4.m1.1.1.3.1.2.3.3">0</cn></apply></apply><cn type="integer" id="S4.E4.m1.1.1.3.1.3.cmml" xref="S4.E4.m1.1.1.3.1.3">999</cn></apply><apply id="S4.E4.m1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.3.2"><ci id="S4.E4.m1.1.1.3.2.1.cmml" xref="S4.E4.m1.1.1.3.2.1">⋅</ci><ci id="S4.E4.m1.1.1.3.2.2.cmml" xref="S4.E4.m1.1.1.3.2.2">𝑖</ci><apply id="S4.E4.m1.1.1.3.2.3.cmml" xref="S4.E4.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.3.2.3.1.cmml" xref="S4.E4.m1.1.1.3.2.3">superscript</csymbol><apply id="S4.E4.m1.1.1.3.2.3.2.cmml" xref="S4.E4.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.3.2.3.2.1.cmml" xref="S4.E4.m1.1.1.3.2.3">subscript</csymbol><ci id="S4.E4.m1.1.1.3.2.3.2.2.cmml" xref="S4.E4.m1.1.1.3.2.3.2.2">𝑎</ci><ci id="S4.E4.m1.1.1.3.2.3.2.3.cmml" xref="S4.E4.m1.1.1.3.2.3.2.3">𝑖</ci></apply><apply id="S4.E4.m1.1.1.3.2.3.3.cmml" xref="S4.E4.m1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.3.2.3.3.1.cmml" xref="S4.E4.m1.1.1.3.2.3.3">subscript</csymbol><ci id="S4.E4.m1.1.1.3.2.3.3.2.cmml" xref="S4.E4.m1.1.1.3.2.3.3.2">𝑝</ci><ci id="S4.E4.m1.1.1.3.2.3.3.3.cmml" xref="S4.E4.m1.1.1.3.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\displaystyle E\left(p_{j}\right)=\sum_{i=0}^{999}{i\cdot a_{i}^{p_{j}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.p4.13" class="ltx_p">The polygon regression loss is defined as follows:</p>
<table id="A1.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E5.m1.1" class="ltx_Math" alttext="\displaystyle\mathscr{L}_{\text{poly}}=\frac{1}{8}\sum_{j=1}^{8}\left(E(p_{j})-p_{j}^{*}\right)^{2}" display="inline"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml"><msub id="S4.E5.m1.1.1.3" xref="S4.E5.m1.1.1.3.cmml"><mi class="ltx_font_mathscript" id="S4.E5.m1.1.1.3.2" xref="S4.E5.m1.1.1.3.2.cmml">ℒ</mi><mtext id="S4.E5.m1.1.1.3.3" xref="S4.E5.m1.1.1.3.3a.cmml">poly</mtext></msub><mo id="S4.E5.m1.1.1.2" xref="S4.E5.m1.1.1.2.cmml">=</mo><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E5.m1.1.1.1.3" xref="S4.E5.m1.1.1.1.3.cmml"><mfrac id="S4.E5.m1.1.1.1.3a" xref="S4.E5.m1.1.1.1.3.cmml"><mn id="S4.E5.m1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.3.2.cmml">1</mn><mn id="S4.E5.m1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.3.3.cmml">8</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.cmml"><munderover id="S4.E5.m1.1.1.1.1.2a" xref="S4.E5.m1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E5.m1.1.1.1.1.2.2.2" xref="S4.E5.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E5.m1.1.1.1.1.2.2.3" xref="S4.E5.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.2.2.3.2" xref="S4.E5.m1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S4.E5.m1.1.1.1.1.2.2.3.1" xref="S4.E5.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E5.m1.1.1.1.1.2.2.3.3" xref="S4.E5.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mn id="S4.E5.m1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.2.3.cmml">8</mn></munderover></mstyle><msup id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2.cmml">−</mo><msubsup id="S4.E5.m1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">j</mi><mo id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.cmml">∗</mo></msubsup></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"><eq id="S4.E5.m1.1.1.2.cmml" xref="S4.E5.m1.1.1.2"></eq><apply id="S4.E5.m1.1.1.3.cmml" xref="S4.E5.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.3.2">ℒ</ci><ci id="S4.E5.m1.1.1.3.3a.cmml" xref="S4.E5.m1.1.1.3.3"><mtext mathsize="70%" id="S4.E5.m1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.3.3">poly</mtext></ci></apply><apply id="S4.E5.m1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><times id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.2"></times><apply id="S4.E5.m1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.3"><divide id="S4.E5.m1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.3"></divide><cn type="integer" id="S4.E5.m1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.3.2">1</cn><cn type="integer" id="S4.E5.m1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.3.3">8</cn></apply><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1"><apply id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2">subscript</csymbol><sum id="S4.E5.m1.1.1.1.1.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.2"></sum><apply id="S4.E5.m1.1.1.1.1.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3"><eq id="S4.E5.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E5.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.2.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><cn type="integer" id="S4.E5.m1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.3">8</cn></apply><apply id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1"><minus id="S4.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.2"></minus><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3">𝐸</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.2.3">𝑗</ci></apply><times id="S4.E5.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.3.3"></times></apply></apply><cn type="integer" id="S4.E5.m1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">\displaystyle\mathscr{L}_{\text{poly}}=\frac{1}{8}\sum_{j=1}^{8}\left(E(p_{j})-p_{j}^{*}\right)^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.p4.12" class="ltx_p">where <math id="S4.p4.12.m1.1" class="ltx_Math" alttext="p_{j}^{*}" display="inline"><semantics id="S4.p4.12.m1.1a"><msubsup id="S4.p4.12.m1.1.1" xref="S4.p4.12.m1.1.1.cmml"><mi id="S4.p4.12.m1.1.1.2.2" xref="S4.p4.12.m1.1.1.2.2.cmml">p</mi><mi id="S4.p4.12.m1.1.1.2.3" xref="S4.p4.12.m1.1.1.2.3.cmml">j</mi><mo id="S4.p4.12.m1.1.1.3" xref="S4.p4.12.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.p4.12.m1.1b"><apply id="S4.p4.12.m1.1.1.cmml" xref="S4.p4.12.m1.1.1"><csymbol cd="ambiguous" id="S4.p4.12.m1.1.1.1.cmml" xref="S4.p4.12.m1.1.1">superscript</csymbol><apply id="S4.p4.12.m1.1.1.2.cmml" xref="S4.p4.12.m1.1.1"><csymbol cd="ambiguous" id="S4.p4.12.m1.1.1.2.1.cmml" xref="S4.p4.12.m1.1.1">subscript</csymbol><ci id="S4.p4.12.m1.1.1.2.2.cmml" xref="S4.p4.12.m1.1.1.2.2">𝑝</ci><ci id="S4.p4.12.m1.1.1.2.3.cmml" xref="S4.p4.12.m1.1.1.2.3">𝑗</ci></apply><times id="S4.p4.12.m1.1.1.3.cmml" xref="S4.p4.12.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.12.m1.1c">p_{j}^{*}</annotation></semantics></math> denotes the ground truth label.</p>
</div>
<div id="S4.p5" class="ltx_para ltx_noindent">
<p id="S4.p5.11" class="ltx_p"><span id="S4.p5.11.1" class="ltx_text ltx_font_bold">Logical Decoder.</span>
The logical decoder predicts the rowspan and colspan information <math id="S4.p5.1.m1.1" class="ltx_Math" alttext="\boldsymbol{L}" display="inline"><semantics id="S4.p5.1.m1.1a"><mi id="S4.p5.1.m1.1.1" xref="S4.p5.1.m1.1.1.cmml">𝑳</mi><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.1b"><ci id="S4.p5.1.m1.1.1.cmml" xref="S4.p5.1.m1.1.1">𝑳</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">\boldsymbol{L}</annotation></semantics></math> for table cells based on the output <math id="S4.p5.2.m2.1" class="ltx_Math" alttext="\boldsymbol{H}" display="inline"><semantics id="S4.p5.2.m2.1a"><mi id="S4.p5.2.m2.1.1" xref="S4.p5.2.m2.1.1.cmml">𝑯</mi><annotation-xml encoding="MathML-Content" id="S4.p5.2.m2.1b"><ci id="S4.p5.2.m2.1.1.cmml" xref="S4.p5.2.m2.1.1">𝑯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.2.m2.1c">\boldsymbol{H}</annotation></semantics></math> from the final hidden state of the text decoder. To illustrate, for predicting the rowspan information <math id="S4.p5.3.m3.1" class="ltx_Math" alttext="l_{\text{row}}" display="inline"><semantics id="S4.p5.3.m3.1a"><msub id="S4.p5.3.m3.1.1" xref="S4.p5.3.m3.1.1.cmml"><mi id="S4.p5.3.m3.1.1.2" xref="S4.p5.3.m3.1.1.2.cmml">l</mi><mtext id="S4.p5.3.m3.1.1.3" xref="S4.p5.3.m3.1.1.3a.cmml">row</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p5.3.m3.1b"><apply id="S4.p5.3.m3.1.1.cmml" xref="S4.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p5.3.m3.1.1.1.cmml" xref="S4.p5.3.m3.1.1">subscript</csymbol><ci id="S4.p5.3.m3.1.1.2.cmml" xref="S4.p5.3.m3.1.1.2">𝑙</ci><ci id="S4.p5.3.m3.1.1.3a.cmml" xref="S4.p5.3.m3.1.1.3"><mtext mathsize="70%" id="S4.p5.3.m3.1.1.3.cmml" xref="S4.p5.3.m3.1.1.3">row</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.3.m3.1c">l_{\text{row}}</annotation></semantics></math> within <math id="S4.p5.4.m4.1" class="ltx_Math" alttext="\boldsymbol{l}_{i}" display="inline"><semantics id="S4.p5.4.m4.1a"><msub id="S4.p5.4.m4.1.1" xref="S4.p5.4.m4.1.1.cmml"><mi id="S4.p5.4.m4.1.1.2" xref="S4.p5.4.m4.1.1.2.cmml">𝒍</mi><mi id="S4.p5.4.m4.1.1.3" xref="S4.p5.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p5.4.m4.1b"><apply id="S4.p5.4.m4.1.1.cmml" xref="S4.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p5.4.m4.1.1.1.cmml" xref="S4.p5.4.m4.1.1">subscript</csymbol><ci id="S4.p5.4.m4.1.1.2.cmml" xref="S4.p5.4.m4.1.1.2">𝒍</ci><ci id="S4.p5.4.m4.1.1.3.cmml" xref="S4.p5.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.4.m4.1c">\boldsymbol{l}_{i}</annotation></semantics></math>, the hidden state <math id="S4.p5.5.m5.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}" display="inline"><semantics id="S4.p5.5.m5.1a"><msub id="S4.p5.5.m5.1.1" xref="S4.p5.5.m5.1.1.cmml"><mi id="S4.p5.5.m5.1.1.2" xref="S4.p5.5.m5.1.1.2.cmml">𝒉</mi><mi id="S4.p5.5.m5.1.1.3" xref="S4.p5.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p5.5.m5.1b"><apply id="S4.p5.5.m5.1.1.cmml" xref="S4.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p5.5.m5.1.1.1.cmml" xref="S4.p5.5.m5.1.1">subscript</csymbol><ci id="S4.p5.5.m5.1.1.2.cmml" xref="S4.p5.5.m5.1.1.2">𝒉</ci><ci id="S4.p5.5.m5.1.1.3.cmml" xref="S4.p5.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.5.m5.1c">\boldsymbol{h}_{i}</annotation></semantics></math> is first mapped through a matrix transformation to a vector <math id="S4.p5.6.m6.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}^{l_{\text{row}}}" display="inline"><semantics id="S4.p5.6.m6.1a"><msubsup id="S4.p5.6.m6.1.1" xref="S4.p5.6.m6.1.1.cmml"><mi id="S4.p5.6.m6.1.1.2.2" xref="S4.p5.6.m6.1.1.2.2.cmml">𝒉</mi><mi id="S4.p5.6.m6.1.1.2.3" xref="S4.p5.6.m6.1.1.2.3.cmml">i</mi><msub id="S4.p5.6.m6.1.1.3" xref="S4.p5.6.m6.1.1.3.cmml"><mi id="S4.p5.6.m6.1.1.3.2" xref="S4.p5.6.m6.1.1.3.2.cmml">l</mi><mtext id="S4.p5.6.m6.1.1.3.3" xref="S4.p5.6.m6.1.1.3.3a.cmml">row</mtext></msub></msubsup><annotation-xml encoding="MathML-Content" id="S4.p5.6.m6.1b"><apply id="S4.p5.6.m6.1.1.cmml" xref="S4.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p5.6.m6.1.1.1.cmml" xref="S4.p5.6.m6.1.1">superscript</csymbol><apply id="S4.p5.6.m6.1.1.2.cmml" xref="S4.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p5.6.m6.1.1.2.1.cmml" xref="S4.p5.6.m6.1.1">subscript</csymbol><ci id="S4.p5.6.m6.1.1.2.2.cmml" xref="S4.p5.6.m6.1.1.2.2">𝒉</ci><ci id="S4.p5.6.m6.1.1.2.3.cmml" xref="S4.p5.6.m6.1.1.2.3">𝑖</ci></apply><apply id="S4.p5.6.m6.1.1.3.cmml" xref="S4.p5.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.p5.6.m6.1.1.3.1.cmml" xref="S4.p5.6.m6.1.1.3">subscript</csymbol><ci id="S4.p5.6.m6.1.1.3.2.cmml" xref="S4.p5.6.m6.1.1.3.2">𝑙</ci><ci id="S4.p5.6.m6.1.1.3.3a.cmml" xref="S4.p5.6.m6.1.1.3.3"><mtext mathsize="50%" id="S4.p5.6.m6.1.1.3.3.cmml" xref="S4.p5.6.m6.1.1.3.3">row</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.6.m6.1c">\boldsymbol{h}_{i}^{l_{\text{row}}}</annotation></semantics></math>. The <math id="S4.p5.7.m7.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}^{l_{\text{row}}}" display="inline"><semantics id="S4.p5.7.m7.1a"><msubsup id="S4.p5.7.m7.1.1" xref="S4.p5.7.m7.1.1.cmml"><mi id="S4.p5.7.m7.1.1.2.2" xref="S4.p5.7.m7.1.1.2.2.cmml">𝒉</mi><mi id="S4.p5.7.m7.1.1.2.3" xref="S4.p5.7.m7.1.1.2.3.cmml">i</mi><msub id="S4.p5.7.m7.1.1.3" xref="S4.p5.7.m7.1.1.3.cmml"><mi id="S4.p5.7.m7.1.1.3.2" xref="S4.p5.7.m7.1.1.3.2.cmml">l</mi><mtext id="S4.p5.7.m7.1.1.3.3" xref="S4.p5.7.m7.1.1.3.3a.cmml">row</mtext></msub></msubsup><annotation-xml encoding="MathML-Content" id="S4.p5.7.m7.1b"><apply id="S4.p5.7.m7.1.1.cmml" xref="S4.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p5.7.m7.1.1.1.cmml" xref="S4.p5.7.m7.1.1">superscript</csymbol><apply id="S4.p5.7.m7.1.1.2.cmml" xref="S4.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p5.7.m7.1.1.2.1.cmml" xref="S4.p5.7.m7.1.1">subscript</csymbol><ci id="S4.p5.7.m7.1.1.2.2.cmml" xref="S4.p5.7.m7.1.1.2.2">𝒉</ci><ci id="S4.p5.7.m7.1.1.2.3.cmml" xref="S4.p5.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S4.p5.7.m7.1.1.3.cmml" xref="S4.p5.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.p5.7.m7.1.1.3.1.cmml" xref="S4.p5.7.m7.1.1.3">subscript</csymbol><ci id="S4.p5.7.m7.1.1.3.2.cmml" xref="S4.p5.7.m7.1.1.3.2">𝑙</ci><ci id="S4.p5.7.m7.1.1.3.3a.cmml" xref="S4.p5.7.m7.1.1.3.3"><mtext mathsize="50%" id="S4.p5.7.m7.1.1.3.3.cmml" xref="S4.p5.7.m7.1.1.3.3">row</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.7.m7.1c">\boldsymbol{h}_{i}^{l_{\text{row}}}</annotation></semantics></math> then serves as a query, computing the dot product with entries in the vocabulary <math id="S4.p5.8.m8.1" class="ltx_Math" alttext="\boldsymbol{Loc}" display="inline"><semantics id="S4.p5.8.m8.1a"><mrow id="S4.p5.8.m8.1.1" xref="S4.p5.8.m8.1.1.cmml"><mi id="S4.p5.8.m8.1.1.2" xref="S4.p5.8.m8.1.1.2.cmml">𝑳</mi><mo lspace="0em" rspace="0em" id="S4.p5.8.m8.1.1.1" xref="S4.p5.8.m8.1.1.1.cmml">​</mo><mi id="S4.p5.8.m8.1.1.3" xref="S4.p5.8.m8.1.1.3.cmml">𝒐</mi><mo lspace="0em" rspace="0em" id="S4.p5.8.m8.1.1.1a" xref="S4.p5.8.m8.1.1.1.cmml">​</mo><mi id="S4.p5.8.m8.1.1.4" xref="S4.p5.8.m8.1.1.4.cmml">𝒄</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.8.m8.1b"><apply id="S4.p5.8.m8.1.1.cmml" xref="S4.p5.8.m8.1.1"><times id="S4.p5.8.m8.1.1.1.cmml" xref="S4.p5.8.m8.1.1.1"></times><ci id="S4.p5.8.m8.1.1.2.cmml" xref="S4.p5.8.m8.1.1.2">𝑳</ci><ci id="S4.p5.8.m8.1.1.3.cmml" xref="S4.p5.8.m8.1.1.3">𝒐</ci><ci id="S4.p5.8.m8.1.1.4.cmml" xref="S4.p5.8.m8.1.1.4">𝒄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.8.m8.1c">\boldsymbol{Loc}</annotation></semantics></math>, resulting in a score vector <math id="S4.p5.9.m9.1" class="ltx_Math" alttext="\boldsymbol{a}^{l_{\text{row}}}" display="inline"><semantics id="S4.p5.9.m9.1a"><msup id="S4.p5.9.m9.1.1" xref="S4.p5.9.m9.1.1.cmml"><mi id="S4.p5.9.m9.1.1.2" xref="S4.p5.9.m9.1.1.2.cmml">𝒂</mi><msub id="S4.p5.9.m9.1.1.3" xref="S4.p5.9.m9.1.1.3.cmml"><mi id="S4.p5.9.m9.1.1.3.2" xref="S4.p5.9.m9.1.1.3.2.cmml">l</mi><mtext id="S4.p5.9.m9.1.1.3.3" xref="S4.p5.9.m9.1.1.3.3a.cmml">row</mtext></msub></msup><annotation-xml encoding="MathML-Content" id="S4.p5.9.m9.1b"><apply id="S4.p5.9.m9.1.1.cmml" xref="S4.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S4.p5.9.m9.1.1.1.cmml" xref="S4.p5.9.m9.1.1">superscript</csymbol><ci id="S4.p5.9.m9.1.1.2.cmml" xref="S4.p5.9.m9.1.1.2">𝒂</ci><apply id="S4.p5.9.m9.1.1.3.cmml" xref="S4.p5.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.p5.9.m9.1.1.3.1.cmml" xref="S4.p5.9.m9.1.1.3">subscript</csymbol><ci id="S4.p5.9.m9.1.1.3.2.cmml" xref="S4.p5.9.m9.1.1.3.2">𝑙</ci><ci id="S4.p5.9.m9.1.1.3.3a.cmml" xref="S4.p5.9.m9.1.1.3.3"><mtext mathsize="50%" id="S4.p5.9.m9.1.1.3.3.cmml" xref="S4.p5.9.m9.1.1.3.3">row</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.9.m9.1c">\boldsymbol{a}^{l_{\text{row}}}</annotation></semantics></math>. The rowspan information <math id="S4.p5.10.m10.1" class="ltx_Math" alttext="l_{\text{row}}" display="inline"><semantics id="S4.p5.10.m10.1a"><msub id="S4.p5.10.m10.1.1" xref="S4.p5.10.m10.1.1.cmml"><mi id="S4.p5.10.m10.1.1.2" xref="S4.p5.10.m10.1.1.2.cmml">l</mi><mtext id="S4.p5.10.m10.1.1.3" xref="S4.p5.10.m10.1.1.3a.cmml">row</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.p5.10.m10.1b"><apply id="S4.p5.10.m10.1.1.cmml" xref="S4.p5.10.m10.1.1"><csymbol cd="ambiguous" id="S4.p5.10.m10.1.1.1.cmml" xref="S4.p5.10.m10.1.1">subscript</csymbol><ci id="S4.p5.10.m10.1.1.2.cmml" xref="S4.p5.10.m10.1.1.2">𝑙</ci><ci id="S4.p5.10.m10.1.1.3a.cmml" xref="S4.p5.10.m10.1.1.3"><mtext mathsize="70%" id="S4.p5.10.m10.1.1.3.cmml" xref="S4.p5.10.m10.1.1.3">row</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.10.m10.1c">l_{\text{row}}</annotation></semantics></math> is then determined by locating the index of the maximum value in the score vector <math id="S4.p5.11.m11.1" class="ltx_Math" alttext="\boldsymbol{a}^{l_{\text{row}}}" display="inline"><semantics id="S4.p5.11.m11.1a"><msup id="S4.p5.11.m11.1.1" xref="S4.p5.11.m11.1.1.cmml"><mi id="S4.p5.11.m11.1.1.2" xref="S4.p5.11.m11.1.1.2.cmml">𝒂</mi><msub id="S4.p5.11.m11.1.1.3" xref="S4.p5.11.m11.1.1.3.cmml"><mi id="S4.p5.11.m11.1.1.3.2" xref="S4.p5.11.m11.1.1.3.2.cmml">l</mi><mtext id="S4.p5.11.m11.1.1.3.3" xref="S4.p5.11.m11.1.1.3.3a.cmml">row</mtext></msub></msup><annotation-xml encoding="MathML-Content" id="S4.p5.11.m11.1b"><apply id="S4.p5.11.m11.1.1.cmml" xref="S4.p5.11.m11.1.1"><csymbol cd="ambiguous" id="S4.p5.11.m11.1.1.1.cmml" xref="S4.p5.11.m11.1.1">superscript</csymbol><ci id="S4.p5.11.m11.1.1.2.cmml" xref="S4.p5.11.m11.1.1.2">𝒂</ci><apply id="S4.p5.11.m11.1.1.3.cmml" xref="S4.p5.11.m11.1.1.3"><csymbol cd="ambiguous" id="S4.p5.11.m11.1.1.3.1.cmml" xref="S4.p5.11.m11.1.1.3">subscript</csymbol><ci id="S4.p5.11.m11.1.1.3.2.cmml" xref="S4.p5.11.m11.1.1.3.2">𝑙</ci><ci id="S4.p5.11.m11.1.1.3.3a.cmml" xref="S4.p5.11.m11.1.1.3.3"><mtext mathsize="50%" id="S4.p5.11.m11.1.1.3.3.cmml" xref="S4.p5.11.m11.1.1.3.3">row</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.11.m11.1c">\boldsymbol{a}^{l_{\text{row}}}</annotation></semantics></math>.</p>
<table id="A1.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6.m1.1" class="ltx_Math" alttext="\displaystyle\boldsymbol{h}_{i}^{l_{\text{row}}}=\text{Linear}\left(\boldsymbol{h}_{i}\right)" display="inline"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><msubsup id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.3.2.2" xref="S4.E6.m1.1.1.3.2.2.cmml">𝒉</mi><mi id="S4.E6.m1.1.1.3.2.3" xref="S4.E6.m1.1.1.3.2.3.cmml">i</mi><msub id="S4.E6.m1.1.1.3.3" xref="S4.E6.m1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.3.3.2" xref="S4.E6.m1.1.1.3.3.2.cmml">l</mi><mtext id="S4.E6.m1.1.1.3.3.3" xref="S4.E6.m1.1.1.3.3.3a.cmml">row</mtext></msub></msubsup><mo id="S4.E6.m1.1.1.2" xref="S4.E6.m1.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml"><mtext id="S4.E6.m1.1.1.1.3" xref="S4.E6.m1.1.1.1.3a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.2.cmml">𝒉</mi><mi id="S4.E6.m1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><eq id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1.2"></eq><apply id="S4.E6.m1.1.1.3.cmml" xref="S4.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.3">superscript</csymbol><apply id="S4.E6.m1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.3.2.1.cmml" xref="S4.E6.m1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.3.2.2.cmml" xref="S4.E6.m1.1.1.3.2.2">𝒉</ci><ci id="S4.E6.m1.1.1.3.2.3.cmml" xref="S4.E6.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S4.E6.m1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.3.3">subscript</csymbol><ci id="S4.E6.m1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.3.3.2">𝑙</ci><ci id="S4.E6.m1.1.1.3.3.3a.cmml" xref="S4.E6.m1.1.1.3.3.3"><mtext mathsize="50%" id="S4.E6.m1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.3.3.3">row</mtext></ci></apply></apply><apply id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><times id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.2"></times><ci id="S4.E6.m1.1.1.1.3a.cmml" xref="S4.E6.m1.1.1.1.3"><mtext id="S4.E6.m1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.3">Linear</mtext></ci><apply id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2">𝒉</ci><ci id="S4.E6.m1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\displaystyle\boldsymbol{h}_{i}^{l_{\text{row}}}=\text{Linear}\left(\boldsymbol{h}_{i}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<table id="A1.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E7.m1.1" class="ltx_Math" alttext="\displaystyle\boldsymbol{a}^{l_{\text{row}}}=\boldsymbol{h}_{i}^{l_{\text{row}}}\boldsymbol{Loc}^{\top}" display="inline"><semantics id="S4.E7.m1.1a"><mrow id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml"><msup id="S4.E7.m1.1.1.2" xref="S4.E7.m1.1.1.2.cmml"><mi id="S4.E7.m1.1.1.2.2" xref="S4.E7.m1.1.1.2.2.cmml">𝒂</mi><msub id="S4.E7.m1.1.1.2.3" xref="S4.E7.m1.1.1.2.3.cmml"><mi id="S4.E7.m1.1.1.2.3.2" xref="S4.E7.m1.1.1.2.3.2.cmml">l</mi><mtext id="S4.E7.m1.1.1.2.3.3" xref="S4.E7.m1.1.1.2.3.3a.cmml">row</mtext></msub></msup><mo id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.cmml">=</mo><mrow id="S4.E7.m1.1.1.3" xref="S4.E7.m1.1.1.3.cmml"><msubsup id="S4.E7.m1.1.1.3.2" xref="S4.E7.m1.1.1.3.2.cmml"><mi id="S4.E7.m1.1.1.3.2.2.2" xref="S4.E7.m1.1.1.3.2.2.2.cmml">𝒉</mi><mi id="S4.E7.m1.1.1.3.2.2.3" xref="S4.E7.m1.1.1.3.2.2.3.cmml">i</mi><msub id="S4.E7.m1.1.1.3.2.3" xref="S4.E7.m1.1.1.3.2.3.cmml"><mi id="S4.E7.m1.1.1.3.2.3.2" xref="S4.E7.m1.1.1.3.2.3.2.cmml">l</mi><mtext id="S4.E7.m1.1.1.3.2.3.3" xref="S4.E7.m1.1.1.3.2.3.3a.cmml">row</mtext></msub></msubsup><mo lspace="0em" rspace="0em" id="S4.E7.m1.1.1.3.1" xref="S4.E7.m1.1.1.3.1.cmml">​</mo><mi id="S4.E7.m1.1.1.3.3" xref="S4.E7.m1.1.1.3.3.cmml">𝑳</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.1.1.3.1a" xref="S4.E7.m1.1.1.3.1.cmml">​</mo><mi id="S4.E7.m1.1.1.3.4" xref="S4.E7.m1.1.1.3.4.cmml">𝒐</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.1.1.3.1b" xref="S4.E7.m1.1.1.3.1.cmml">​</mo><msup id="S4.E7.m1.1.1.3.5" xref="S4.E7.m1.1.1.3.5.cmml"><mi id="S4.E7.m1.1.1.3.5.2" xref="S4.E7.m1.1.1.3.5.2.cmml">𝒄</mi><mo id="S4.E7.m1.1.1.3.5.3" xref="S4.E7.m1.1.1.3.5.3.cmml">⊤</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.1b"><apply id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1"><eq id="S4.E7.m1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"></eq><apply id="S4.E7.m1.1.1.2.cmml" xref="S4.E7.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.2">superscript</csymbol><ci id="S4.E7.m1.1.1.2.2.cmml" xref="S4.E7.m1.1.1.2.2">𝒂</ci><apply id="S4.E7.m1.1.1.2.3.cmml" xref="S4.E7.m1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.2.3.1.cmml" xref="S4.E7.m1.1.1.2.3">subscript</csymbol><ci id="S4.E7.m1.1.1.2.3.2.cmml" xref="S4.E7.m1.1.1.2.3.2">𝑙</ci><ci id="S4.E7.m1.1.1.2.3.3a.cmml" xref="S4.E7.m1.1.1.2.3.3"><mtext mathsize="50%" id="S4.E7.m1.1.1.2.3.3.cmml" xref="S4.E7.m1.1.1.2.3.3">row</mtext></ci></apply></apply><apply id="S4.E7.m1.1.1.3.cmml" xref="S4.E7.m1.1.1.3"><times id="S4.E7.m1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.3.1"></times><apply id="S4.E7.m1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.3.2.1.cmml" xref="S4.E7.m1.1.1.3.2">superscript</csymbol><apply id="S4.E7.m1.1.1.3.2.2.cmml" xref="S4.E7.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.3.2.2.1.cmml" xref="S4.E7.m1.1.1.3.2">subscript</csymbol><ci id="S4.E7.m1.1.1.3.2.2.2.cmml" xref="S4.E7.m1.1.1.3.2.2.2">𝒉</ci><ci id="S4.E7.m1.1.1.3.2.2.3.cmml" xref="S4.E7.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S4.E7.m1.1.1.3.2.3.cmml" xref="S4.E7.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.3.2.3.1.cmml" xref="S4.E7.m1.1.1.3.2.3">subscript</csymbol><ci id="S4.E7.m1.1.1.3.2.3.2.cmml" xref="S4.E7.m1.1.1.3.2.3.2">𝑙</ci><ci id="S4.E7.m1.1.1.3.2.3.3a.cmml" xref="S4.E7.m1.1.1.3.2.3.3"><mtext mathsize="50%" id="S4.E7.m1.1.1.3.2.3.3.cmml" xref="S4.E7.m1.1.1.3.2.3.3">row</mtext></ci></apply></apply><ci id="S4.E7.m1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.3.3">𝑳</ci><ci id="S4.E7.m1.1.1.3.4.cmml" xref="S4.E7.m1.1.1.3.4">𝒐</ci><apply id="S4.E7.m1.1.1.3.5.cmml" xref="S4.E7.m1.1.1.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.3.5.1.cmml" xref="S4.E7.m1.1.1.3.5">superscript</csymbol><ci id="S4.E7.m1.1.1.3.5.2.cmml" xref="S4.E7.m1.1.1.3.5.2">𝒄</ci><csymbol cd="latexml" id="S4.E7.m1.1.1.3.5.3.cmml" xref="S4.E7.m1.1.1.3.5.3">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.1c">\displaystyle\boldsymbol{a}^{l_{\text{row}}}=\boldsymbol{h}_{i}^{l_{\text{row}}}\boldsymbol{Loc}^{\top}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<table id="A1.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E8.m1.1" class="ltx_Math" alttext="\displaystyle l_{\text{row}}=\text{argmax}\left(\boldsymbol{a}^{l_{\text{row}}}\right)" display="inline"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><msub id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.3.2" xref="S4.E8.m1.1.1.3.2.cmml">l</mi><mtext id="S4.E8.m1.1.1.3.3" xref="S4.E8.m1.1.1.3.3a.cmml">row</mtext></msub><mo id="S4.E8.m1.1.1.2" xref="S4.E8.m1.1.1.2.cmml">=</mo><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml"><mtext id="S4.E8.m1.1.1.1.3" xref="S4.E8.m1.1.1.1.3a.cmml">argmax</mtext><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml">𝒂</mi><msub id="S4.E8.m1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.1.1.3.2.cmml">l</mi><mtext id="S4.E8.m1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.1.3.3a.cmml">row</mtext></msub></msup><mo id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><eq id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1.2"></eq><apply id="S4.E8.m1.1.1.3.cmml" xref="S4.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.3.2">𝑙</ci><ci id="S4.E8.m1.1.1.3.3a.cmml" xref="S4.E8.m1.1.1.3.3"><mtext mathsize="70%" id="S4.E8.m1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.3.3">row</mtext></ci></apply><apply id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><times id="S4.E8.m1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.2"></times><ci id="S4.E8.m1.1.1.1.3a.cmml" xref="S4.E8.m1.1.1.1.3"><mtext id="S4.E8.m1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.3">argmax</mtext></ci><apply id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2">𝒂</ci><apply id="S4.E8.m1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.2">𝑙</ci><ci id="S4.E8.m1.1.1.1.1.1.1.3.3a.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.3"><mtext mathsize="50%" id="S4.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.3">row</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\displaystyle l_{\text{row}}=\text{argmax}\left(\boldsymbol{a}^{l_{\text{row}}}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.p5.15" class="ltx_p">Given the extreme imbalance in the distribution of rowspan and colspan across cells, we optimize our model using sigmoid focal loss <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib13" title="" class="ltx_ref">2017</a>)</cite>. The span prediction loss for the logical decoder is defined as follows:</p>
<table id="A1.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E9.m1.4" class="ltx_Math" alttext="\displaystyle\mathscr{L}_{\text{span}}=L_{f}\left(\boldsymbol{a}^{l_{\text{row}}},\boldsymbol{l}_{\text{row}}^{*}\right)+L_{f}\left(\boldsymbol{a}^{l_{\text{col}}},\boldsymbol{l}_{\text{col}}^{*}\right)" display="inline"><semantics id="S4.E9.m1.4a"><mrow id="S4.E9.m1.4.4" xref="S4.E9.m1.4.4.cmml"><msub id="S4.E9.m1.4.4.6" xref="S4.E9.m1.4.4.6.cmml"><mi class="ltx_font_mathscript" id="S4.E9.m1.4.4.6.2" xref="S4.E9.m1.4.4.6.2.cmml">ℒ</mi><mtext id="S4.E9.m1.4.4.6.3" xref="S4.E9.m1.4.4.6.3a.cmml">span</mtext></msub><mo id="S4.E9.m1.4.4.5" xref="S4.E9.m1.4.4.5.cmml">=</mo><mrow id="S4.E9.m1.4.4.4" xref="S4.E9.m1.4.4.4.cmml"><mrow id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.2.cmml"><msub id="S4.E9.m1.2.2.2.2.4" xref="S4.E9.m1.2.2.2.2.4.cmml"><mi id="S4.E9.m1.2.2.2.2.4.2" xref="S4.E9.m1.2.2.2.2.4.2.cmml">L</mi><mi id="S4.E9.m1.2.2.2.2.4.3" xref="S4.E9.m1.2.2.2.2.4.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.2.2.3" xref="S4.E9.m1.2.2.2.2.3.cmml">​</mo><mrow id="S4.E9.m1.2.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.3.cmml"><mo id="S4.E9.m1.2.2.2.2.2.2.3" xref="S4.E9.m1.2.2.2.2.2.3.cmml">(</mo><msup id="S4.E9.m1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.2.cmml">𝒂</mi><msub id="S4.E9.m1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mtext id="S4.E9.m1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.1.1.1.3.3a.cmml">row</mtext></msub></msup><mo id="S4.E9.m1.2.2.2.2.2.2.4" xref="S4.E9.m1.2.2.2.2.2.3.cmml">,</mo><msubsup id="S4.E9.m1.2.2.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.2.2.cmml"><mi id="S4.E9.m1.2.2.2.2.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2.cmml">𝒍</mi><mtext id="S4.E9.m1.2.2.2.2.2.2.2.2.3" xref="S4.E9.m1.2.2.2.2.2.2.2.2.3a.cmml">row</mtext><mo id="S4.E9.m1.2.2.2.2.2.2.2.3" xref="S4.E9.m1.2.2.2.2.2.2.2.3.cmml">∗</mo></msubsup><mo id="S4.E9.m1.2.2.2.2.2.2.5" xref="S4.E9.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.4.4.4.5" xref="S4.E9.m1.4.4.4.5.cmml">+</mo><mrow id="S4.E9.m1.4.4.4.4" xref="S4.E9.m1.4.4.4.4.cmml"><msub id="S4.E9.m1.4.4.4.4.4" xref="S4.E9.m1.4.4.4.4.4.cmml"><mi id="S4.E9.m1.4.4.4.4.4.2" xref="S4.E9.m1.4.4.4.4.4.2.cmml">L</mi><mi id="S4.E9.m1.4.4.4.4.4.3" xref="S4.E9.m1.4.4.4.4.4.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.4.4.4.4.3" xref="S4.E9.m1.4.4.4.4.3.cmml">​</mo><mrow id="S4.E9.m1.4.4.4.4.2.2" xref="S4.E9.m1.4.4.4.4.2.3.cmml"><mo id="S4.E9.m1.4.4.4.4.2.2.3" xref="S4.E9.m1.4.4.4.4.2.3.cmml">(</mo><msup id="S4.E9.m1.3.3.3.3.1.1.1" xref="S4.E9.m1.3.3.3.3.1.1.1.cmml"><mi id="S4.E9.m1.3.3.3.3.1.1.1.2" xref="S4.E9.m1.3.3.3.3.1.1.1.2.cmml">𝒂</mi><msub id="S4.E9.m1.3.3.3.3.1.1.1.3" xref="S4.E9.m1.3.3.3.3.1.1.1.3.cmml"><mi id="S4.E9.m1.3.3.3.3.1.1.1.3.2" xref="S4.E9.m1.3.3.3.3.1.1.1.3.2.cmml">l</mi><mtext id="S4.E9.m1.3.3.3.3.1.1.1.3.3" xref="S4.E9.m1.3.3.3.3.1.1.1.3.3a.cmml">col</mtext></msub></msup><mo id="S4.E9.m1.4.4.4.4.2.2.4" xref="S4.E9.m1.4.4.4.4.2.3.cmml">,</mo><msubsup id="S4.E9.m1.4.4.4.4.2.2.2" xref="S4.E9.m1.4.4.4.4.2.2.2.cmml"><mi id="S4.E9.m1.4.4.4.4.2.2.2.2.2" xref="S4.E9.m1.4.4.4.4.2.2.2.2.2.cmml">𝒍</mi><mtext id="S4.E9.m1.4.4.4.4.2.2.2.2.3" xref="S4.E9.m1.4.4.4.4.2.2.2.2.3a.cmml">col</mtext><mo id="S4.E9.m1.4.4.4.4.2.2.2.3" xref="S4.E9.m1.4.4.4.4.2.2.2.3.cmml">∗</mo></msubsup><mo id="S4.E9.m1.4.4.4.4.2.2.5" xref="S4.E9.m1.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.4b"><apply id="S4.E9.m1.4.4.cmml" xref="S4.E9.m1.4.4"><eq id="S4.E9.m1.4.4.5.cmml" xref="S4.E9.m1.4.4.5"></eq><apply id="S4.E9.m1.4.4.6.cmml" xref="S4.E9.m1.4.4.6"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.6.1.cmml" xref="S4.E9.m1.4.4.6">subscript</csymbol><ci id="S4.E9.m1.4.4.6.2.cmml" xref="S4.E9.m1.4.4.6.2">ℒ</ci><ci id="S4.E9.m1.4.4.6.3a.cmml" xref="S4.E9.m1.4.4.6.3"><mtext mathsize="70%" id="S4.E9.m1.4.4.6.3.cmml" xref="S4.E9.m1.4.4.6.3">span</mtext></ci></apply><apply id="S4.E9.m1.4.4.4.cmml" xref="S4.E9.m1.4.4.4"><plus id="S4.E9.m1.4.4.4.5.cmml" xref="S4.E9.m1.4.4.4.5"></plus><apply id="S4.E9.m1.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2"><times id="S4.E9.m1.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.3"></times><apply id="S4.E9.m1.2.2.2.2.4.cmml" xref="S4.E9.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.4.1.cmml" xref="S4.E9.m1.2.2.2.2.4">subscript</csymbol><ci id="S4.E9.m1.2.2.2.2.4.2.cmml" xref="S4.E9.m1.2.2.2.2.4.2">𝐿</ci><ci id="S4.E9.m1.2.2.2.2.4.3.cmml" xref="S4.E9.m1.2.2.2.2.4.3">𝑓</ci></apply><interval closure="open" id="S4.E9.m1.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.2"><apply id="S4.E9.m1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.2">𝒂</ci><apply id="S4.E9.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.3.2">𝑙</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.3.3a.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.3.3"><mtext mathsize="50%" id="S4.E9.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.3.3">row</mtext></ci></apply></apply><apply id="S4.E9.m1.2.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2">superscript</csymbol><apply id="S4.E9.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2.2.2">𝒍</ci><ci id="S4.E9.m1.2.2.2.2.2.2.2.2.3a.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2.2.3"><mtext mathsize="70%" id="S4.E9.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2.2.3">row</mtext></ci></apply><times id="S4.E9.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2.3"></times></apply></interval></apply><apply id="S4.E9.m1.4.4.4.4.cmml" xref="S4.E9.m1.4.4.4.4"><times id="S4.E9.m1.4.4.4.4.3.cmml" xref="S4.E9.m1.4.4.4.4.3"></times><apply id="S4.E9.m1.4.4.4.4.4.cmml" xref="S4.E9.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.4.4.1.cmml" xref="S4.E9.m1.4.4.4.4.4">subscript</csymbol><ci id="S4.E9.m1.4.4.4.4.4.2.cmml" xref="S4.E9.m1.4.4.4.4.4.2">𝐿</ci><ci id="S4.E9.m1.4.4.4.4.4.3.cmml" xref="S4.E9.m1.4.4.4.4.4.3">𝑓</ci></apply><interval closure="open" id="S4.E9.m1.4.4.4.4.2.3.cmml" xref="S4.E9.m1.4.4.4.4.2.2"><apply id="S4.E9.m1.3.3.3.3.1.1.1.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1">superscript</csymbol><ci id="S4.E9.m1.3.3.3.3.1.1.1.2.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1.2">𝒂</ci><apply id="S4.E9.m1.3.3.3.3.1.1.1.3.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.3.1.1.1.3.1.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.3.3.3.3.1.1.1.3.2.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1.3.2">𝑙</ci><ci id="S4.E9.m1.3.3.3.3.1.1.1.3.3a.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1.3.3"><mtext mathsize="50%" id="S4.E9.m1.3.3.3.3.1.1.1.3.3.cmml" xref="S4.E9.m1.3.3.3.3.1.1.1.3.3">col</mtext></ci></apply></apply><apply id="S4.E9.m1.4.4.4.4.2.2.2.cmml" xref="S4.E9.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.4.2.2.2.1.cmml" xref="S4.E9.m1.4.4.4.4.2.2.2">superscript</csymbol><apply id="S4.E9.m1.4.4.4.4.2.2.2.2.cmml" xref="S4.E9.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.4.2.2.2.2.1.cmml" xref="S4.E9.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="S4.E9.m1.4.4.4.4.2.2.2.2.2.cmml" xref="S4.E9.m1.4.4.4.4.2.2.2.2.2">𝒍</ci><ci id="S4.E9.m1.4.4.4.4.2.2.2.2.3a.cmml" xref="S4.E9.m1.4.4.4.4.2.2.2.2.3"><mtext mathsize="70%" id="S4.E9.m1.4.4.4.4.2.2.2.2.3.cmml" xref="S4.E9.m1.4.4.4.4.2.2.2.2.3">col</mtext></ci></apply><times id="S4.E9.m1.4.4.4.4.2.2.2.3.cmml" xref="S4.E9.m1.4.4.4.4.2.2.2.3"></times></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.4c">\displaystyle\mathscr{L}_{\text{span}}=L_{f}\left(\boldsymbol{a}^{l_{\text{row}}},\boldsymbol{l}_{\text{row}}^{*}\right)+L_{f}\left(\boldsymbol{a}^{l_{\text{col}}},\boldsymbol{l}_{\text{col}}^{*}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.p5.14" class="ltx_p">where <math id="S4.p5.12.m1.1" class="ltx_Math" alttext="L_{f}" display="inline"><semantics id="S4.p5.12.m1.1a"><msub id="S4.p5.12.m1.1.1" xref="S4.p5.12.m1.1.1.cmml"><mi id="S4.p5.12.m1.1.1.2" xref="S4.p5.12.m1.1.1.2.cmml">L</mi><mi id="S4.p5.12.m1.1.1.3" xref="S4.p5.12.m1.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p5.12.m1.1b"><apply id="S4.p5.12.m1.1.1.cmml" xref="S4.p5.12.m1.1.1"><csymbol cd="ambiguous" id="S4.p5.12.m1.1.1.1.cmml" xref="S4.p5.12.m1.1.1">subscript</csymbol><ci id="S4.p5.12.m1.1.1.2.cmml" xref="S4.p5.12.m1.1.1.2">𝐿</ci><ci id="S4.p5.12.m1.1.1.3.cmml" xref="S4.p5.12.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.12.m1.1c">L_{f}</annotation></semantics></math> represents the sigmoid focal loss function. The vectors <math id="S4.p5.13.m2.1" class="ltx_Math" alttext="\boldsymbol{l}_{\text{row}}^{*}" display="inline"><semantics id="S4.p5.13.m2.1a"><msubsup id="S4.p5.13.m2.1.1" xref="S4.p5.13.m2.1.1.cmml"><mi id="S4.p5.13.m2.1.1.2.2" xref="S4.p5.13.m2.1.1.2.2.cmml">𝒍</mi><mtext id="S4.p5.13.m2.1.1.2.3" xref="S4.p5.13.m2.1.1.2.3a.cmml">row</mtext><mo id="S4.p5.13.m2.1.1.3" xref="S4.p5.13.m2.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.p5.13.m2.1b"><apply id="S4.p5.13.m2.1.1.cmml" xref="S4.p5.13.m2.1.1"><csymbol cd="ambiguous" id="S4.p5.13.m2.1.1.1.cmml" xref="S4.p5.13.m2.1.1">superscript</csymbol><apply id="S4.p5.13.m2.1.1.2.cmml" xref="S4.p5.13.m2.1.1"><csymbol cd="ambiguous" id="S4.p5.13.m2.1.1.2.1.cmml" xref="S4.p5.13.m2.1.1">subscript</csymbol><ci id="S4.p5.13.m2.1.1.2.2.cmml" xref="S4.p5.13.m2.1.1.2.2">𝒍</ci><ci id="S4.p5.13.m2.1.1.2.3a.cmml" xref="S4.p5.13.m2.1.1.2.3"><mtext mathsize="70%" id="S4.p5.13.m2.1.1.2.3.cmml" xref="S4.p5.13.m2.1.1.2.3">row</mtext></ci></apply><times id="S4.p5.13.m2.1.1.3.cmml" xref="S4.p5.13.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.13.m2.1c">\boldsymbol{l}_{\text{row}}^{*}</annotation></semantics></math> and <math id="S4.p5.14.m3.1" class="ltx_Math" alttext="\boldsymbol{l}_{\text{col}}^{*}" display="inline"><semantics id="S4.p5.14.m3.1a"><msubsup id="S4.p5.14.m3.1.1" xref="S4.p5.14.m3.1.1.cmml"><mi id="S4.p5.14.m3.1.1.2.2" xref="S4.p5.14.m3.1.1.2.2.cmml">𝒍</mi><mtext id="S4.p5.14.m3.1.1.2.3" xref="S4.p5.14.m3.1.1.2.3a.cmml">col</mtext><mo id="S4.p5.14.m3.1.1.3" xref="S4.p5.14.m3.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.p5.14.m3.1b"><apply id="S4.p5.14.m3.1.1.cmml" xref="S4.p5.14.m3.1.1"><csymbol cd="ambiguous" id="S4.p5.14.m3.1.1.1.cmml" xref="S4.p5.14.m3.1.1">superscript</csymbol><apply id="S4.p5.14.m3.1.1.2.cmml" xref="S4.p5.14.m3.1.1"><csymbol cd="ambiguous" id="S4.p5.14.m3.1.1.2.1.cmml" xref="S4.p5.14.m3.1.1">subscript</csymbol><ci id="S4.p5.14.m3.1.1.2.2.cmml" xref="S4.p5.14.m3.1.1.2.2">𝒍</ci><ci id="S4.p5.14.m3.1.1.2.3a.cmml" xref="S4.p5.14.m3.1.1.2.3"><mtext mathsize="70%" id="S4.p5.14.m3.1.1.2.3.cmml" xref="S4.p5.14.m3.1.1.2.3">col</mtext></ci></apply><times id="S4.p5.14.m3.1.1.3.cmml" xref="S4.p5.14.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.14.m3.1c">\boldsymbol{l}_{\text{col}}^{*}</annotation></semantics></math> are one-hot representations of the ground truth span information for rowspan and colspan, respectively.</p>
</div>
<div id="S4.p6" class="ltx_para ltx_noindent">
<p id="S4.p6.6" class="ltx_p"><span id="S4.p6.6.1" class="ltx_text ltx_font_bold">Vision Guider.</span>
Unlike conventional document images, table images exhibit significant interdependencies among cells within the same row, column, or cell block. To enhance the model’s ability to accurately capture these details during the decoding process, we develop the Vision Guider. This mechanism enables the model to focus more on the row and column information for each cell during decoding. Specifically, to capture the same row visual cues, we input the last layer’s output <math id="S4.p6.1.m1.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}" display="inline"><semantics id="S4.p6.1.m1.1a"><msub id="S4.p6.1.m1.1.1" xref="S4.p6.1.m1.1.1.cmml"><mi id="S4.p6.1.m1.1.1.2" xref="S4.p6.1.m1.1.1.2.cmml">𝒉</mi><mi id="S4.p6.1.m1.1.1.3" xref="S4.p6.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p6.1.m1.1b"><apply id="S4.p6.1.m1.1.1.cmml" xref="S4.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p6.1.m1.1.1.1.cmml" xref="S4.p6.1.m1.1.1">subscript</csymbol><ci id="S4.p6.1.m1.1.1.2.cmml" xref="S4.p6.1.m1.1.1.2">𝒉</ci><ci id="S4.p6.1.m1.1.1.3.cmml" xref="S4.p6.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.1.m1.1c">\boldsymbol{h}_{i}</annotation></semantics></math> of the decoder into a matrix mapping to generate vector <math id="S4.p6.2.m2.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}^{\text{row}}" display="inline"><semantics id="S4.p6.2.m2.1a"><msubsup id="S4.p6.2.m2.1.1" xref="S4.p6.2.m2.1.1.cmml"><mi id="S4.p6.2.m2.1.1.2.2" xref="S4.p6.2.m2.1.1.2.2.cmml">𝒉</mi><mi id="S4.p6.2.m2.1.1.2.3" xref="S4.p6.2.m2.1.1.2.3.cmml">i</mi><mtext id="S4.p6.2.m2.1.1.3" xref="S4.p6.2.m2.1.1.3a.cmml">row</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.p6.2.m2.1b"><apply id="S4.p6.2.m2.1.1.cmml" xref="S4.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p6.2.m2.1.1.1.cmml" xref="S4.p6.2.m2.1.1">superscript</csymbol><apply id="S4.p6.2.m2.1.1.2.cmml" xref="S4.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p6.2.m2.1.1.2.1.cmml" xref="S4.p6.2.m2.1.1">subscript</csymbol><ci id="S4.p6.2.m2.1.1.2.2.cmml" xref="S4.p6.2.m2.1.1.2.2">𝒉</ci><ci id="S4.p6.2.m2.1.1.2.3.cmml" xref="S4.p6.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S4.p6.2.m2.1.1.3a.cmml" xref="S4.p6.2.m2.1.1.3"><mtext mathsize="70%" id="S4.p6.2.m2.1.1.3.cmml" xref="S4.p6.2.m2.1.1.3">row</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.2.m2.1c">\boldsymbol{h}_{i}^{\text{row}}</annotation></semantics></math>. The vector <math id="S4.p6.3.m3.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}^{\text{row}}" display="inline"><semantics id="S4.p6.3.m3.1a"><msubsup id="S4.p6.3.m3.1.1" xref="S4.p6.3.m3.1.1.cmml"><mi id="S4.p6.3.m3.1.1.2.2" xref="S4.p6.3.m3.1.1.2.2.cmml">𝒉</mi><mi id="S4.p6.3.m3.1.1.2.3" xref="S4.p6.3.m3.1.1.2.3.cmml">i</mi><mtext id="S4.p6.3.m3.1.1.3" xref="S4.p6.3.m3.1.1.3a.cmml">row</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.p6.3.m3.1b"><apply id="S4.p6.3.m3.1.1.cmml" xref="S4.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p6.3.m3.1.1.1.cmml" xref="S4.p6.3.m3.1.1">superscript</csymbol><apply id="S4.p6.3.m3.1.1.2.cmml" xref="S4.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p6.3.m3.1.1.2.1.cmml" xref="S4.p6.3.m3.1.1">subscript</csymbol><ci id="S4.p6.3.m3.1.1.2.2.cmml" xref="S4.p6.3.m3.1.1.2.2">𝒉</ci><ci id="S4.p6.3.m3.1.1.2.3.cmml" xref="S4.p6.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S4.p6.3.m3.1.1.3a.cmml" xref="S4.p6.3.m3.1.1.3"><mtext mathsize="70%" id="S4.p6.3.m3.1.1.3.cmml" xref="S4.p6.3.m3.1.1.3">row</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.3.m3.1c">\boldsymbol{h}_{i}^{\text{row}}</annotation></semantics></math>, serving as the query, is then used to fetch attention scores <math id="S4.p6.4.m4.1" class="ltx_Math" alttext="\boldsymbol{a}^{\text{row}}" display="inline"><semantics id="S4.p6.4.m4.1a"><msup id="S4.p6.4.m4.1.1" xref="S4.p6.4.m4.1.1.cmml"><mi id="S4.p6.4.m4.1.1.2" xref="S4.p6.4.m4.1.1.2.cmml">𝒂</mi><mtext id="S4.p6.4.m4.1.1.3" xref="S4.p6.4.m4.1.1.3a.cmml">row</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.p6.4.m4.1b"><apply id="S4.p6.4.m4.1.1.cmml" xref="S4.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p6.4.m4.1.1.1.cmml" xref="S4.p6.4.m4.1.1">superscript</csymbol><ci id="S4.p6.4.m4.1.1.2.cmml" xref="S4.p6.4.m4.1.1.2">𝒂</ci><ci id="S4.p6.4.m4.1.1.3a.cmml" xref="S4.p6.4.m4.1.1.3"><mtext mathsize="70%" id="S4.p6.4.m4.1.1.3.cmml" xref="S4.p6.4.m4.1.1.3">row</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.4.m4.1c">\boldsymbol{a}^{\text{row}}</annotation></semantics></math> from the visual embedding <math id="S4.p6.5.m5.1" class="ltx_Math" alttext="\boldsymbol{Z}\in\mathbb{R}^{N\times D}" display="inline"><semantics id="S4.p6.5.m5.1a"><mrow id="S4.p6.5.m5.1.1" xref="S4.p6.5.m5.1.1.cmml"><mi id="S4.p6.5.m5.1.1.2" xref="S4.p6.5.m5.1.1.2.cmml">𝒁</mi><mo id="S4.p6.5.m5.1.1.1" xref="S4.p6.5.m5.1.1.1.cmml">∈</mo><msup id="S4.p6.5.m5.1.1.3" xref="S4.p6.5.m5.1.1.3.cmml"><mi id="S4.p6.5.m5.1.1.3.2" xref="S4.p6.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.p6.5.m5.1.1.3.3" xref="S4.p6.5.m5.1.1.3.3.cmml"><mi id="S4.p6.5.m5.1.1.3.3.2" xref="S4.p6.5.m5.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S4.p6.5.m5.1.1.3.3.1" xref="S4.p6.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S4.p6.5.m5.1.1.3.3.3" xref="S4.p6.5.m5.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.5.m5.1b"><apply id="S4.p6.5.m5.1.1.cmml" xref="S4.p6.5.m5.1.1"><in id="S4.p6.5.m5.1.1.1.cmml" xref="S4.p6.5.m5.1.1.1"></in><ci id="S4.p6.5.m5.1.1.2.cmml" xref="S4.p6.5.m5.1.1.2">𝒁</ci><apply id="S4.p6.5.m5.1.1.3.cmml" xref="S4.p6.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.p6.5.m5.1.1.3.1.cmml" xref="S4.p6.5.m5.1.1.3">superscript</csymbol><ci id="S4.p6.5.m5.1.1.3.2.cmml" xref="S4.p6.5.m5.1.1.3.2">ℝ</ci><apply id="S4.p6.5.m5.1.1.3.3.cmml" xref="S4.p6.5.m5.1.1.3.3"><times id="S4.p6.5.m5.1.1.3.3.1.cmml" xref="S4.p6.5.m5.1.1.3.3.1"></times><ci id="S4.p6.5.m5.1.1.3.3.2.cmml" xref="S4.p6.5.m5.1.1.3.3.2">𝑁</ci><ci id="S4.p6.5.m5.1.1.3.3.3.cmml" xref="S4.p6.5.m5.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.5.m5.1c">\boldsymbol{Z}\in\mathbb{R}^{N\times D}</annotation></semantics></math>. A similar approach is adopted for the same column information <math id="S4.p6.6.m6.1" class="ltx_Math" alttext="\boldsymbol{a}^{\text{col}}" display="inline"><semantics id="S4.p6.6.m6.1a"><msup id="S4.p6.6.m6.1.1" xref="S4.p6.6.m6.1.1.cmml"><mi id="S4.p6.6.m6.1.1.2" xref="S4.p6.6.m6.1.1.2.cmml">𝒂</mi><mtext id="S4.p6.6.m6.1.1.3" xref="S4.p6.6.m6.1.1.3a.cmml">col</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.p6.6.m6.1b"><apply id="S4.p6.6.m6.1.1.cmml" xref="S4.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p6.6.m6.1.1.1.cmml" xref="S4.p6.6.m6.1.1">superscript</csymbol><ci id="S4.p6.6.m6.1.1.2.cmml" xref="S4.p6.6.m6.1.1.2">𝒂</ci><ci id="S4.p6.6.m6.1.1.3a.cmml" xref="S4.p6.6.m6.1.1.3"><mtext mathsize="70%" id="S4.p6.6.m6.1.1.3.cmml" xref="S4.p6.6.m6.1.1.3">col</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.6.m6.1c">\boldsymbol{a}^{\text{col}}</annotation></semantics></math>.</p>
<table id="A1.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E10.m1.1" class="ltx_Math" alttext="\displaystyle\boldsymbol{h}_{i}^{\text{row}}=\text{Linear}\left(\boldsymbol{h}_{i}\right)" display="inline"><semantics id="S4.E10.m1.1a"><mrow id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml"><msubsup id="S4.E10.m1.1.1.3" xref="S4.E10.m1.1.1.3.cmml"><mi id="S4.E10.m1.1.1.3.2.2" xref="S4.E10.m1.1.1.3.2.2.cmml">𝒉</mi><mi id="S4.E10.m1.1.1.3.2.3" xref="S4.E10.m1.1.1.3.2.3.cmml">i</mi><mtext id="S4.E10.m1.1.1.3.3" xref="S4.E10.m1.1.1.3.3a.cmml">row</mtext></msubsup><mo id="S4.E10.m1.1.1.2" xref="S4.E10.m1.1.1.2.cmml">=</mo><mrow id="S4.E10.m1.1.1.1" xref="S4.E10.m1.1.1.1.cmml"><mtext id="S4.E10.m1.1.1.1.3" xref="S4.E10.m1.1.1.1.3a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.2" xref="S4.E10.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E10.m1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.2.cmml">𝒉</mi><mi id="S4.E10.m1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E10.m1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.1b"><apply id="S4.E10.m1.1.1.cmml" xref="S4.E10.m1.1.1"><eq id="S4.E10.m1.1.1.2.cmml" xref="S4.E10.m1.1.1.2"></eq><apply id="S4.E10.m1.1.1.3.cmml" xref="S4.E10.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.3">superscript</csymbol><apply id="S4.E10.m1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.3.2.1.cmml" xref="S4.E10.m1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.1.1.3.2.2.cmml" xref="S4.E10.m1.1.1.3.2.2">𝒉</ci><ci id="S4.E10.m1.1.1.3.2.3.cmml" xref="S4.E10.m1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E10.m1.1.1.3.3a.cmml" xref="S4.E10.m1.1.1.3.3"><mtext mathsize="70%" id="S4.E10.m1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.3.3">row</mtext></ci></apply><apply id="S4.E10.m1.1.1.1.cmml" xref="S4.E10.m1.1.1.1"><times id="S4.E10.m1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.2"></times><ci id="S4.E10.m1.1.1.1.3a.cmml" xref="S4.E10.m1.1.1.1.3"><mtext id="S4.E10.m1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.3">Linear</mtext></ci><apply id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2">𝒉</ci><ci id="S4.E10.m1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.1c">\displaystyle\boldsymbol{h}_{i}^{\text{row}}=\text{Linear}\left(\boldsymbol{h}_{i}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<table id="A1.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E11.m1.1" class="ltx_Math" alttext="\displaystyle\boldsymbol{a}^{\text{row}}=\boldsymbol{h}_{i}^{\text{row}}\boldsymbol{Z}^{\top}" display="inline"><semantics id="S4.E11.m1.1a"><mrow id="S4.E11.m1.1.1" xref="S4.E11.m1.1.1.cmml"><msup id="S4.E11.m1.1.1.2" xref="S4.E11.m1.1.1.2.cmml"><mi id="S4.E11.m1.1.1.2.2" xref="S4.E11.m1.1.1.2.2.cmml">𝒂</mi><mtext id="S4.E11.m1.1.1.2.3" xref="S4.E11.m1.1.1.2.3a.cmml">row</mtext></msup><mo id="S4.E11.m1.1.1.1" xref="S4.E11.m1.1.1.1.cmml">=</mo><mrow id="S4.E11.m1.1.1.3" xref="S4.E11.m1.1.1.3.cmml"><msubsup id="S4.E11.m1.1.1.3.2" xref="S4.E11.m1.1.1.3.2.cmml"><mi id="S4.E11.m1.1.1.3.2.2.2" xref="S4.E11.m1.1.1.3.2.2.2.cmml">𝒉</mi><mi id="S4.E11.m1.1.1.3.2.2.3" xref="S4.E11.m1.1.1.3.2.2.3.cmml">i</mi><mtext id="S4.E11.m1.1.1.3.2.3" xref="S4.E11.m1.1.1.3.2.3a.cmml">row</mtext></msubsup><mo lspace="0em" rspace="0em" id="S4.E11.m1.1.1.3.1" xref="S4.E11.m1.1.1.3.1.cmml">​</mo><msup id="S4.E11.m1.1.1.3.3" xref="S4.E11.m1.1.1.3.3.cmml"><mi id="S4.E11.m1.1.1.3.3.2" xref="S4.E11.m1.1.1.3.3.2.cmml">𝒁</mi><mo id="S4.E11.m1.1.1.3.3.3" xref="S4.E11.m1.1.1.3.3.3.cmml">⊤</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.1b"><apply id="S4.E11.m1.1.1.cmml" xref="S4.E11.m1.1.1"><eq id="S4.E11.m1.1.1.1.cmml" xref="S4.E11.m1.1.1.1"></eq><apply id="S4.E11.m1.1.1.2.cmml" xref="S4.E11.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.2">superscript</csymbol><ci id="S4.E11.m1.1.1.2.2.cmml" xref="S4.E11.m1.1.1.2.2">𝒂</ci><ci id="S4.E11.m1.1.1.2.3a.cmml" xref="S4.E11.m1.1.1.2.3"><mtext mathsize="70%" id="S4.E11.m1.1.1.2.3.cmml" xref="S4.E11.m1.1.1.2.3">row</mtext></ci></apply><apply id="S4.E11.m1.1.1.3.cmml" xref="S4.E11.m1.1.1.3"><times id="S4.E11.m1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.3.1"></times><apply id="S4.E11.m1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.3.2.1.cmml" xref="S4.E11.m1.1.1.3.2">superscript</csymbol><apply id="S4.E11.m1.1.1.3.2.2.cmml" xref="S4.E11.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.3.2.2.1.cmml" xref="S4.E11.m1.1.1.3.2">subscript</csymbol><ci id="S4.E11.m1.1.1.3.2.2.2.cmml" xref="S4.E11.m1.1.1.3.2.2.2">𝒉</ci><ci id="S4.E11.m1.1.1.3.2.2.3.cmml" xref="S4.E11.m1.1.1.3.2.2.3">𝑖</ci></apply><ci id="S4.E11.m1.1.1.3.2.3a.cmml" xref="S4.E11.m1.1.1.3.2.3"><mtext mathsize="70%" id="S4.E11.m1.1.1.3.2.3.cmml" xref="S4.E11.m1.1.1.3.2.3">row</mtext></ci></apply><apply id="S4.E11.m1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.3.3.1.cmml" xref="S4.E11.m1.1.1.3.3">superscript</csymbol><ci id="S4.E11.m1.1.1.3.3.2.cmml" xref="S4.E11.m1.1.1.3.3.2">𝒁</ci><csymbol cd="latexml" id="S4.E11.m1.1.1.3.3.3.cmml" xref="S4.E11.m1.1.1.3.3.3">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.1c">\displaystyle\boldsymbol{a}^{\text{row}}=\boldsymbol{h}_{i}^{\text{row}}\boldsymbol{Z}^{\top}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.p6.10" class="ltx_p">The loss function for the Vision Guider is defined as:</p>
<table id="A1.EGx12" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E12.m1.4" class="ltx_Math" alttext="\displaystyle\mathscr{L}_{\text{vis}}=L_{f}\left(\boldsymbol{a}^{\text{row}},\boldsymbol{g}_{\text{row}}^{*}\right)+L_{f}\left(\boldsymbol{a}^{\text{col}},\boldsymbol{g}_{\text{col}}^{*}\right)" display="inline"><semantics id="S4.E12.m1.4a"><mrow id="S4.E12.m1.4.4" xref="S4.E12.m1.4.4.cmml"><msub id="S4.E12.m1.4.4.6" xref="S4.E12.m1.4.4.6.cmml"><mi class="ltx_font_mathscript" id="S4.E12.m1.4.4.6.2" xref="S4.E12.m1.4.4.6.2.cmml">ℒ</mi><mtext id="S4.E12.m1.4.4.6.3" xref="S4.E12.m1.4.4.6.3a.cmml">vis</mtext></msub><mo id="S4.E12.m1.4.4.5" xref="S4.E12.m1.4.4.5.cmml">=</mo><mrow id="S4.E12.m1.4.4.4" xref="S4.E12.m1.4.4.4.cmml"><mrow id="S4.E12.m1.2.2.2.2" xref="S4.E12.m1.2.2.2.2.cmml"><msub id="S4.E12.m1.2.2.2.2.4" xref="S4.E12.m1.2.2.2.2.4.cmml"><mi id="S4.E12.m1.2.2.2.2.4.2" xref="S4.E12.m1.2.2.2.2.4.2.cmml">L</mi><mi id="S4.E12.m1.2.2.2.2.4.3" xref="S4.E12.m1.2.2.2.2.4.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S4.E12.m1.2.2.2.2.3" xref="S4.E12.m1.2.2.2.2.3.cmml">​</mo><mrow id="S4.E12.m1.2.2.2.2.2.2" xref="S4.E12.m1.2.2.2.2.2.3.cmml"><mo id="S4.E12.m1.2.2.2.2.2.2.3" xref="S4.E12.m1.2.2.2.2.2.3.cmml">(</mo><msup id="S4.E12.m1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.2.cmml">𝒂</mi><mtext id="S4.E12.m1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.3a.cmml">row</mtext></msup><mo id="S4.E12.m1.2.2.2.2.2.2.4" xref="S4.E12.m1.2.2.2.2.2.3.cmml">,</mo><msubsup id="S4.E12.m1.2.2.2.2.2.2.2" xref="S4.E12.m1.2.2.2.2.2.2.2.cmml"><mi id="S4.E12.m1.2.2.2.2.2.2.2.2.2" xref="S4.E12.m1.2.2.2.2.2.2.2.2.2.cmml">𝒈</mi><mtext id="S4.E12.m1.2.2.2.2.2.2.2.2.3" xref="S4.E12.m1.2.2.2.2.2.2.2.2.3a.cmml">row</mtext><mo id="S4.E12.m1.2.2.2.2.2.2.2.3" xref="S4.E12.m1.2.2.2.2.2.2.2.3.cmml">∗</mo></msubsup><mo id="S4.E12.m1.2.2.2.2.2.2.5" xref="S4.E12.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.4.4.4.5" xref="S4.E12.m1.4.4.4.5.cmml">+</mo><mrow id="S4.E12.m1.4.4.4.4" xref="S4.E12.m1.4.4.4.4.cmml"><msub id="S4.E12.m1.4.4.4.4.4" xref="S4.E12.m1.4.4.4.4.4.cmml"><mi id="S4.E12.m1.4.4.4.4.4.2" xref="S4.E12.m1.4.4.4.4.4.2.cmml">L</mi><mi id="S4.E12.m1.4.4.4.4.4.3" xref="S4.E12.m1.4.4.4.4.4.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S4.E12.m1.4.4.4.4.3" xref="S4.E12.m1.4.4.4.4.3.cmml">​</mo><mrow id="S4.E12.m1.4.4.4.4.2.2" xref="S4.E12.m1.4.4.4.4.2.3.cmml"><mo id="S4.E12.m1.4.4.4.4.2.2.3" xref="S4.E12.m1.4.4.4.4.2.3.cmml">(</mo><msup id="S4.E12.m1.3.3.3.3.1.1.1" xref="S4.E12.m1.3.3.3.3.1.1.1.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.1.2" xref="S4.E12.m1.3.3.3.3.1.1.1.2.cmml">𝒂</mi><mtext id="S4.E12.m1.3.3.3.3.1.1.1.3" xref="S4.E12.m1.3.3.3.3.1.1.1.3a.cmml">col</mtext></msup><mo id="S4.E12.m1.4.4.4.4.2.2.4" xref="S4.E12.m1.4.4.4.4.2.3.cmml">,</mo><msubsup id="S4.E12.m1.4.4.4.4.2.2.2" xref="S4.E12.m1.4.4.4.4.2.2.2.cmml"><mi id="S4.E12.m1.4.4.4.4.2.2.2.2.2" xref="S4.E12.m1.4.4.4.4.2.2.2.2.2.cmml">𝒈</mi><mtext id="S4.E12.m1.4.4.4.4.2.2.2.2.3" xref="S4.E12.m1.4.4.4.4.2.2.2.2.3a.cmml">col</mtext><mo id="S4.E12.m1.4.4.4.4.2.2.2.3" xref="S4.E12.m1.4.4.4.4.2.2.2.3.cmml">∗</mo></msubsup><mo id="S4.E12.m1.4.4.4.4.2.2.5" xref="S4.E12.m1.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.4b"><apply id="S4.E12.m1.4.4.cmml" xref="S4.E12.m1.4.4"><eq id="S4.E12.m1.4.4.5.cmml" xref="S4.E12.m1.4.4.5"></eq><apply id="S4.E12.m1.4.4.6.cmml" xref="S4.E12.m1.4.4.6"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.6.1.cmml" xref="S4.E12.m1.4.4.6">subscript</csymbol><ci id="S4.E12.m1.4.4.6.2.cmml" xref="S4.E12.m1.4.4.6.2">ℒ</ci><ci id="S4.E12.m1.4.4.6.3a.cmml" xref="S4.E12.m1.4.4.6.3"><mtext mathsize="70%" id="S4.E12.m1.4.4.6.3.cmml" xref="S4.E12.m1.4.4.6.3">vis</mtext></ci></apply><apply id="S4.E12.m1.4.4.4.cmml" xref="S4.E12.m1.4.4.4"><plus id="S4.E12.m1.4.4.4.5.cmml" xref="S4.E12.m1.4.4.4.5"></plus><apply id="S4.E12.m1.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2"><times id="S4.E12.m1.2.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.2.3"></times><apply id="S4.E12.m1.2.2.2.2.4.cmml" xref="S4.E12.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.4.1.cmml" xref="S4.E12.m1.2.2.2.2.4">subscript</csymbol><ci id="S4.E12.m1.2.2.2.2.4.2.cmml" xref="S4.E12.m1.2.2.2.2.4.2">𝐿</ci><ci id="S4.E12.m1.2.2.2.2.4.3.cmml" xref="S4.E12.m1.2.2.2.2.4.3">𝑓</ci></apply><interval closure="open" id="S4.E12.m1.2.2.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.2.2.2"><apply id="S4.E12.m1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.2">𝒂</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S4.E12.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.3">row</mtext></ci></apply><apply id="S4.E12.m1.2.2.2.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E12.m1.2.2.2.2.2.2.2">superscript</csymbol><apply id="S4.E12.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E12.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E12.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2.2.2.2.2.2">𝒈</ci><ci id="S4.E12.m1.2.2.2.2.2.2.2.2.3a.cmml" xref="S4.E12.m1.2.2.2.2.2.2.2.2.3"><mtext mathsize="70%" id="S4.E12.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.2.2.2.2.2.3">row</mtext></ci></apply><times id="S4.E12.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.2.2.2.2.3"></times></apply></interval></apply><apply id="S4.E12.m1.4.4.4.4.cmml" xref="S4.E12.m1.4.4.4.4"><times id="S4.E12.m1.4.4.4.4.3.cmml" xref="S4.E12.m1.4.4.4.4.3"></times><apply id="S4.E12.m1.4.4.4.4.4.cmml" xref="S4.E12.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.4.4.4.1.cmml" xref="S4.E12.m1.4.4.4.4.4">subscript</csymbol><ci id="S4.E12.m1.4.4.4.4.4.2.cmml" xref="S4.E12.m1.4.4.4.4.4.2">𝐿</ci><ci id="S4.E12.m1.4.4.4.4.4.3.cmml" xref="S4.E12.m1.4.4.4.4.4.3">𝑓</ci></apply><interval closure="open" id="S4.E12.m1.4.4.4.4.2.3.cmml" xref="S4.E12.m1.4.4.4.4.2.2"><apply id="S4.E12.m1.3.3.3.3.1.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1">superscript</csymbol><ci id="S4.E12.m1.3.3.3.3.1.1.1.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.2">𝒂</ci><ci id="S4.E12.m1.3.3.3.3.1.1.1.3a.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.3"><mtext mathsize="70%" id="S4.E12.m1.3.3.3.3.1.1.1.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.3">col</mtext></ci></apply><apply id="S4.E12.m1.4.4.4.4.2.2.2.cmml" xref="S4.E12.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.4.4.2.2.2.1.cmml" xref="S4.E12.m1.4.4.4.4.2.2.2">superscript</csymbol><apply id="S4.E12.m1.4.4.4.4.2.2.2.2.cmml" xref="S4.E12.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.4.4.2.2.2.2.1.cmml" xref="S4.E12.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="S4.E12.m1.4.4.4.4.2.2.2.2.2.cmml" xref="S4.E12.m1.4.4.4.4.2.2.2.2.2">𝒈</ci><ci id="S4.E12.m1.4.4.4.4.2.2.2.2.3a.cmml" xref="S4.E12.m1.4.4.4.4.2.2.2.2.3"><mtext mathsize="70%" id="S4.E12.m1.4.4.4.4.2.2.2.2.3.cmml" xref="S4.E12.m1.4.4.4.4.2.2.2.2.3">col</mtext></ci></apply><times id="S4.E12.m1.4.4.4.4.2.2.2.3.cmml" xref="S4.E12.m1.4.4.4.4.2.2.2.3"></times></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.4c">\displaystyle\mathscr{L}_{\text{vis}}=L_{f}\left(\boldsymbol{a}^{\text{row}},\boldsymbol{g}_{\text{row}}^{*}\right)+L_{f}\left(\boldsymbol{a}^{\text{col}},\boldsymbol{g}_{\text{col}}^{*}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S4.p6.9" class="ltx_p">where <math id="S4.p6.7.m1.1" class="ltx_Math" alttext="L_{f}" display="inline"><semantics id="S4.p6.7.m1.1a"><msub id="S4.p6.7.m1.1.1" xref="S4.p6.7.m1.1.1.cmml"><mi id="S4.p6.7.m1.1.1.2" xref="S4.p6.7.m1.1.1.2.cmml">L</mi><mi id="S4.p6.7.m1.1.1.3" xref="S4.p6.7.m1.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p6.7.m1.1b"><apply id="S4.p6.7.m1.1.1.cmml" xref="S4.p6.7.m1.1.1"><csymbol cd="ambiguous" id="S4.p6.7.m1.1.1.1.cmml" xref="S4.p6.7.m1.1.1">subscript</csymbol><ci id="S4.p6.7.m1.1.1.2.cmml" xref="S4.p6.7.m1.1.1.2">𝐿</ci><ci id="S4.p6.7.m1.1.1.3.cmml" xref="S4.p6.7.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.7.m1.1c">L_{f}</annotation></semantics></math> denotes the sigmoid focal loss function, and <math id="S4.p6.8.m2.1" class="ltx_Math" alttext="\boldsymbol{g}_{\text{row}}^{*}" display="inline"><semantics id="S4.p6.8.m2.1a"><msubsup id="S4.p6.8.m2.1.1" xref="S4.p6.8.m2.1.1.cmml"><mi id="S4.p6.8.m2.1.1.2.2" xref="S4.p6.8.m2.1.1.2.2.cmml">𝒈</mi><mtext id="S4.p6.8.m2.1.1.2.3" xref="S4.p6.8.m2.1.1.2.3a.cmml">row</mtext><mo id="S4.p6.8.m2.1.1.3" xref="S4.p6.8.m2.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.p6.8.m2.1b"><apply id="S4.p6.8.m2.1.1.cmml" xref="S4.p6.8.m2.1.1"><csymbol cd="ambiguous" id="S4.p6.8.m2.1.1.1.cmml" xref="S4.p6.8.m2.1.1">superscript</csymbol><apply id="S4.p6.8.m2.1.1.2.cmml" xref="S4.p6.8.m2.1.1"><csymbol cd="ambiguous" id="S4.p6.8.m2.1.1.2.1.cmml" xref="S4.p6.8.m2.1.1">subscript</csymbol><ci id="S4.p6.8.m2.1.1.2.2.cmml" xref="S4.p6.8.m2.1.1.2.2">𝒈</ci><ci id="S4.p6.8.m2.1.1.2.3a.cmml" xref="S4.p6.8.m2.1.1.2.3"><mtext mathsize="70%" id="S4.p6.8.m2.1.1.2.3.cmml" xref="S4.p6.8.m2.1.1.2.3">row</mtext></ci></apply><times id="S4.p6.8.m2.1.1.3.cmml" xref="S4.p6.8.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.8.m2.1c">\boldsymbol{g}_{\text{row}}^{*}</annotation></semantics></math> and <math id="S4.p6.9.m3.1" class="ltx_Math" alttext="\boldsymbol{g}_{\text{col}}^{*}" display="inline"><semantics id="S4.p6.9.m3.1a"><msubsup id="S4.p6.9.m3.1.1" xref="S4.p6.9.m3.1.1.cmml"><mi id="S4.p6.9.m3.1.1.2.2" xref="S4.p6.9.m3.1.1.2.2.cmml">𝒈</mi><mtext id="S4.p6.9.m3.1.1.2.3" xref="S4.p6.9.m3.1.1.2.3a.cmml">col</mtext><mo id="S4.p6.9.m3.1.1.3" xref="S4.p6.9.m3.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.p6.9.m3.1b"><apply id="S4.p6.9.m3.1.1.cmml" xref="S4.p6.9.m3.1.1"><csymbol cd="ambiguous" id="S4.p6.9.m3.1.1.1.cmml" xref="S4.p6.9.m3.1.1">superscript</csymbol><apply id="S4.p6.9.m3.1.1.2.cmml" xref="S4.p6.9.m3.1.1"><csymbol cd="ambiguous" id="S4.p6.9.m3.1.1.2.1.cmml" xref="S4.p6.9.m3.1.1">subscript</csymbol><ci id="S4.p6.9.m3.1.1.2.2.cmml" xref="S4.p6.9.m3.1.1.2.2">𝒈</ci><ci id="S4.p6.9.m3.1.1.2.3a.cmml" xref="S4.p6.9.m3.1.1.2.3"><mtext mathsize="70%" id="S4.p6.9.m3.1.1.2.3.cmml" xref="S4.p6.9.m3.1.1.2.3">col</mtext></ci></apply><times id="S4.p6.9.m3.1.1.3.cmml" xref="S4.p6.9.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.9.m3.1c">\boldsymbol{g}_{\text{col}}^{*}</annotation></semantics></math> represent the row and column mask maps, respectively.</p>
</div>
<div id="S4.p7" class="ltx_para ltx_noindent">
<p id="S4.p7.7" class="ltx_p"><span id="S4.p7.7.1" class="ltx_text ltx_font_bold">Language Guider.</span>
Tables present data relationships in an exceedingly concise format. Beyond the prevalent numerical tables, there are also descriptive table images. To accurately recognize these descriptive tables, it is imperative that the model comprehends the content within the table to make more precise structural predictions. To this end, we introduce the Language Guider, which directs the model to understand the textual semantic information in the table. As illustrated in Figure <a href="#S5.F4" title="Figure 4 ‣ 5 Implementation Details ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, during the training phase, in addition to the essential Table Structure Recognition (TSR) task, we design an additional task named Table Read (TR), which prompts the model to sequentially output the content within table images, thereby enhancing the model’s understanding of the text in the images. To ensure that the tokens in TSR possess text comprehension abilities similar to those in TR, we align the tokens from both tasks. Specifically, suppose a token &lt;C&gt; in TSR produces an output <math id="S4.p7.1.m1.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}" display="inline"><semantics id="S4.p7.1.m1.1a"><msub id="S4.p7.1.m1.1.1" xref="S4.p7.1.m1.1.1.cmml"><mi id="S4.p7.1.m1.1.1.2" xref="S4.p7.1.m1.1.1.2.cmml">𝒉</mi><mi id="S4.p7.1.m1.1.1.3" xref="S4.p7.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p7.1.m1.1b"><apply id="S4.p7.1.m1.1.1.cmml" xref="S4.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p7.1.m1.1.1.1.cmml" xref="S4.p7.1.m1.1.1">subscript</csymbol><ci id="S4.p7.1.m1.1.1.2.cmml" xref="S4.p7.1.m1.1.1.2">𝒉</ci><ci id="S4.p7.1.m1.1.1.3.cmml" xref="S4.p7.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.1.m1.1c">\boldsymbol{h}_{i}</annotation></semantics></math> at the decoder’s last layer; we first map <math id="S4.p7.2.m2.1" class="ltx_Math" alttext="\boldsymbol{h}_{i}" display="inline"><semantics id="S4.p7.2.m2.1a"><msub id="S4.p7.2.m2.1.1" xref="S4.p7.2.m2.1.1.cmml"><mi id="S4.p7.2.m2.1.1.2" xref="S4.p7.2.m2.1.1.2.cmml">𝒉</mi><mi id="S4.p7.2.m2.1.1.3" xref="S4.p7.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p7.2.m2.1b"><apply id="S4.p7.2.m2.1.1.cmml" xref="S4.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p7.2.m2.1.1.1.cmml" xref="S4.p7.2.m2.1.1">subscript</csymbol><ci id="S4.p7.2.m2.1.1.2.cmml" xref="S4.p7.2.m2.1.1.2">𝒉</ci><ci id="S4.p7.2.m2.1.1.3.cmml" xref="S4.p7.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.2.m2.1c">\boldsymbol{h}_{i}</annotation></semantics></math> to <math id="S4.p7.3.m3.1" class="ltx_Math" alttext="\boldsymbol{h}^{\text{lang}}_{i}" display="inline"><semantics id="S4.p7.3.m3.1a"><msubsup id="S4.p7.3.m3.1.1" xref="S4.p7.3.m3.1.1.cmml"><mi id="S4.p7.3.m3.1.1.2.2" xref="S4.p7.3.m3.1.1.2.2.cmml">𝒉</mi><mi id="S4.p7.3.m3.1.1.3" xref="S4.p7.3.m3.1.1.3.cmml">i</mi><mtext id="S4.p7.3.m3.1.1.2.3" xref="S4.p7.3.m3.1.1.2.3a.cmml">lang</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.p7.3.m3.1b"><apply id="S4.p7.3.m3.1.1.cmml" xref="S4.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p7.3.m3.1.1.1.cmml" xref="S4.p7.3.m3.1.1">subscript</csymbol><apply id="S4.p7.3.m3.1.1.2.cmml" xref="S4.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p7.3.m3.1.1.2.1.cmml" xref="S4.p7.3.m3.1.1">superscript</csymbol><ci id="S4.p7.3.m3.1.1.2.2.cmml" xref="S4.p7.3.m3.1.1.2.2">𝒉</ci><ci id="S4.p7.3.m3.1.1.2.3a.cmml" xref="S4.p7.3.m3.1.1.2.3"><mtext mathsize="70%" id="S4.p7.3.m3.1.1.2.3.cmml" xref="S4.p7.3.m3.1.1.2.3">lang</mtext></ci></apply><ci id="S4.p7.3.m3.1.1.3.cmml" xref="S4.p7.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.3.m3.1c">\boldsymbol{h}^{\text{lang}}_{i}</annotation></semantics></math> using a matrix mapping. The corresponding token for &lt;C&gt; in TR, represented as <math id="S4.p7.4.m4.1" class="ltx_Math" alttext="\boldsymbol{h}_{\left[n:m\right]}" display="inline"><semantics id="S4.p7.4.m4.1a"><msub id="S4.p7.4.m4.1.2" xref="S4.p7.4.m4.1.2.cmml"><mi id="S4.p7.4.m4.1.2.2" xref="S4.p7.4.m4.1.2.2.cmml">𝒉</mi><mrow id="S4.p7.4.m4.1.1.1.1" xref="S4.p7.4.m4.1.1.1.2.cmml"><mo id="S4.p7.4.m4.1.1.1.1.2" xref="S4.p7.4.m4.1.1.1.2.1.cmml">[</mo><mrow id="S4.p7.4.m4.1.1.1.1.1" xref="S4.p7.4.m4.1.1.1.1.1.cmml"><mi id="S4.p7.4.m4.1.1.1.1.1.2" xref="S4.p7.4.m4.1.1.1.1.1.2.cmml">n</mi><mo lspace="0.278em" rspace="0.278em" id="S4.p7.4.m4.1.1.1.1.1.1" xref="S4.p7.4.m4.1.1.1.1.1.1.cmml">:</mo><mi id="S4.p7.4.m4.1.1.1.1.1.3" xref="S4.p7.4.m4.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S4.p7.4.m4.1.1.1.1.3" xref="S4.p7.4.m4.1.1.1.2.1.cmml">]</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p7.4.m4.1b"><apply id="S4.p7.4.m4.1.2.cmml" xref="S4.p7.4.m4.1.2"><csymbol cd="ambiguous" id="S4.p7.4.m4.1.2.1.cmml" xref="S4.p7.4.m4.1.2">subscript</csymbol><ci id="S4.p7.4.m4.1.2.2.cmml" xref="S4.p7.4.m4.1.2.2">𝒉</ci><apply id="S4.p7.4.m4.1.1.1.2.cmml" xref="S4.p7.4.m4.1.1.1.1"><csymbol cd="latexml" id="S4.p7.4.m4.1.1.1.2.1.cmml" xref="S4.p7.4.m4.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.p7.4.m4.1.1.1.1.1.cmml" xref="S4.p7.4.m4.1.1.1.1.1"><ci id="S4.p7.4.m4.1.1.1.1.1.1.cmml" xref="S4.p7.4.m4.1.1.1.1.1.1">:</ci><ci id="S4.p7.4.m4.1.1.1.1.1.2.cmml" xref="S4.p7.4.m4.1.1.1.1.1.2">𝑛</ci><ci id="S4.p7.4.m4.1.1.1.1.1.3.cmml" xref="S4.p7.4.m4.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.4.m4.1c">\boldsymbol{h}_{\left[n:m\right]}</annotation></semantics></math> at the decoder’s last layer, is then subject to mean pooling to produce <math id="S4.p7.5.m5.1" class="ltx_Math" alttext="\boldsymbol{h}_{\text{lang}}^{*}" display="inline"><semantics id="S4.p7.5.m5.1a"><msubsup id="S4.p7.5.m5.1.1" xref="S4.p7.5.m5.1.1.cmml"><mi id="S4.p7.5.m5.1.1.2.2" xref="S4.p7.5.m5.1.1.2.2.cmml">𝒉</mi><mtext id="S4.p7.5.m5.1.1.2.3" xref="S4.p7.5.m5.1.1.2.3a.cmml">lang</mtext><mo id="S4.p7.5.m5.1.1.3" xref="S4.p7.5.m5.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.p7.5.m5.1b"><apply id="S4.p7.5.m5.1.1.cmml" xref="S4.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p7.5.m5.1.1.1.cmml" xref="S4.p7.5.m5.1.1">superscript</csymbol><apply id="S4.p7.5.m5.1.1.2.cmml" xref="S4.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p7.5.m5.1.1.2.1.cmml" xref="S4.p7.5.m5.1.1">subscript</csymbol><ci id="S4.p7.5.m5.1.1.2.2.cmml" xref="S4.p7.5.m5.1.1.2.2">𝒉</ci><ci id="S4.p7.5.m5.1.1.2.3a.cmml" xref="S4.p7.5.m5.1.1.2.3"><mtext mathsize="70%" id="S4.p7.5.m5.1.1.2.3.cmml" xref="S4.p7.5.m5.1.1.2.3">lang</mtext></ci></apply><times id="S4.p7.5.m5.1.1.3.cmml" xref="S4.p7.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.5.m5.1c">\boldsymbol{h}_{\text{lang}}^{*}</annotation></semantics></math>. Subsequently, a mean squared-error (MSE) loss is applied between <math id="S4.p7.6.m6.1" class="ltx_Math" alttext="\boldsymbol{h}^{\text{lang}}_{i}" display="inline"><semantics id="S4.p7.6.m6.1a"><msubsup id="S4.p7.6.m6.1.1" xref="S4.p7.6.m6.1.1.cmml"><mi id="S4.p7.6.m6.1.1.2.2" xref="S4.p7.6.m6.1.1.2.2.cmml">𝒉</mi><mi id="S4.p7.6.m6.1.1.3" xref="S4.p7.6.m6.1.1.3.cmml">i</mi><mtext id="S4.p7.6.m6.1.1.2.3" xref="S4.p7.6.m6.1.1.2.3a.cmml">lang</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.p7.6.m6.1b"><apply id="S4.p7.6.m6.1.1.cmml" xref="S4.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p7.6.m6.1.1.1.cmml" xref="S4.p7.6.m6.1.1">subscript</csymbol><apply id="S4.p7.6.m6.1.1.2.cmml" xref="S4.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p7.6.m6.1.1.2.1.cmml" xref="S4.p7.6.m6.1.1">superscript</csymbol><ci id="S4.p7.6.m6.1.1.2.2.cmml" xref="S4.p7.6.m6.1.1.2.2">𝒉</ci><ci id="S4.p7.6.m6.1.1.2.3a.cmml" xref="S4.p7.6.m6.1.1.2.3"><mtext mathsize="70%" id="S4.p7.6.m6.1.1.2.3.cmml" xref="S4.p7.6.m6.1.1.2.3">lang</mtext></ci></apply><ci id="S4.p7.6.m6.1.1.3.cmml" xref="S4.p7.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.6.m6.1c">\boldsymbol{h}^{\text{lang}}_{i}</annotation></semantics></math> and <math id="S4.p7.7.m7.1" class="ltx_Math" alttext="\boldsymbol{h}_{\text{lang}}^{*}" display="inline"><semantics id="S4.p7.7.m7.1a"><msubsup id="S4.p7.7.m7.1.1" xref="S4.p7.7.m7.1.1.cmml"><mi id="S4.p7.7.m7.1.1.2.2" xref="S4.p7.7.m7.1.1.2.2.cmml">𝒉</mi><mtext id="S4.p7.7.m7.1.1.2.3" xref="S4.p7.7.m7.1.1.2.3a.cmml">lang</mtext><mo id="S4.p7.7.m7.1.1.3" xref="S4.p7.7.m7.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.p7.7.m7.1b"><apply id="S4.p7.7.m7.1.1.cmml" xref="S4.p7.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p7.7.m7.1.1.1.cmml" xref="S4.p7.7.m7.1.1">superscript</csymbol><apply id="S4.p7.7.m7.1.1.2.cmml" xref="S4.p7.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p7.7.m7.1.1.2.1.cmml" xref="S4.p7.7.m7.1.1">subscript</csymbol><ci id="S4.p7.7.m7.1.1.2.2.cmml" xref="S4.p7.7.m7.1.1.2.2">𝒉</ci><ci id="S4.p7.7.m7.1.1.2.3a.cmml" xref="S4.p7.7.m7.1.1.2.3"><mtext mathsize="70%" id="S4.p7.7.m7.1.1.2.3.cmml" xref="S4.p7.7.m7.1.1.2.3">lang</mtext></ci></apply><times id="S4.p7.7.m7.1.1.3.cmml" xref="S4.p7.7.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.7.m7.1c">\boldsymbol{h}_{\text{lang}}^{*}</annotation></semantics></math>, thus endowing TSR tokens with substantial text perception capabilities.</p>
<table id="A1.EGx13" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E13.m1.1" class="ltx_Math" alttext="\displaystyle\boldsymbol{h}_{i}^{\text{lang}}=\text{Linear}\left(\boldsymbol{h}_{i}\right)" display="inline"><semantics id="S4.E13.m1.1a"><mrow id="S4.E13.m1.1.1" xref="S4.E13.m1.1.1.cmml"><msubsup id="S4.E13.m1.1.1.3" xref="S4.E13.m1.1.1.3.cmml"><mi id="S4.E13.m1.1.1.3.2.2" xref="S4.E13.m1.1.1.3.2.2.cmml">𝒉</mi><mi id="S4.E13.m1.1.1.3.2.3" xref="S4.E13.m1.1.1.3.2.3.cmml">i</mi><mtext id="S4.E13.m1.1.1.3.3" xref="S4.E13.m1.1.1.3.3a.cmml">lang</mtext></msubsup><mo id="S4.E13.m1.1.1.2" xref="S4.E13.m1.1.1.2.cmml">=</mo><mrow id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.cmml"><mtext id="S4.E13.m1.1.1.1.3" xref="S4.E13.m1.1.1.1.3a.cmml">Linear</mtext><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.1.2" xref="S4.E13.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E13.m1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E13.m1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.2.cmml">𝒉</mi><mi id="S4.E13.m1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E13.m1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.1b"><apply id="S4.E13.m1.1.1.cmml" xref="S4.E13.m1.1.1"><eq id="S4.E13.m1.1.1.2.cmml" xref="S4.E13.m1.1.1.2"></eq><apply id="S4.E13.m1.1.1.3.cmml" xref="S4.E13.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.3.1.cmml" xref="S4.E13.m1.1.1.3">superscript</csymbol><apply id="S4.E13.m1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.3.2.1.cmml" xref="S4.E13.m1.1.1.3">subscript</csymbol><ci id="S4.E13.m1.1.1.3.2.2.cmml" xref="S4.E13.m1.1.1.3.2.2">𝒉</ci><ci id="S4.E13.m1.1.1.3.2.3.cmml" xref="S4.E13.m1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E13.m1.1.1.3.3a.cmml" xref="S4.E13.m1.1.1.3.3"><mtext mathsize="70%" id="S4.E13.m1.1.1.3.3.cmml" xref="S4.E13.m1.1.1.3.3">lang</mtext></ci></apply><apply id="S4.E13.m1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"><times id="S4.E13.m1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.2"></times><ci id="S4.E13.m1.1.1.1.3a.cmml" xref="S4.E13.m1.1.1.1.3"><mtext id="S4.E13.m1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.3">Linear</mtext></ci><apply id="S4.E13.m1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.2">𝒉</ci><ci id="S4.E13.m1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.1c">\displaystyle\boldsymbol{h}_{i}^{\text{lang}}=\text{Linear}\left(\boldsymbol{h}_{i}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<table id="A1.EGx14" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E14.m1.2" class="ltx_Math" alttext="\displaystyle\boldsymbol{h}_{\text{lang}}^{*}=\text{Mean}\left(\boldsymbol{h}_{\left[n:m\right]}\right)" display="inline"><semantics id="S4.E14.m1.2a"><mrow id="S4.E14.m1.2.2" xref="S4.E14.m1.2.2.cmml"><msubsup id="S4.E14.m1.2.2.3" xref="S4.E14.m1.2.2.3.cmml"><mi id="S4.E14.m1.2.2.3.2.2" xref="S4.E14.m1.2.2.3.2.2.cmml">𝒉</mi><mtext id="S4.E14.m1.2.2.3.2.3" xref="S4.E14.m1.2.2.3.2.3a.cmml">lang</mtext><mo id="S4.E14.m1.2.2.3.3" xref="S4.E14.m1.2.2.3.3.cmml">∗</mo></msubsup><mo id="S4.E14.m1.2.2.2" xref="S4.E14.m1.2.2.2.cmml">=</mo><mrow id="S4.E14.m1.2.2.1" xref="S4.E14.m1.2.2.1.cmml"><mtext id="S4.E14.m1.2.2.1.3" xref="S4.E14.m1.2.2.1.3a.cmml">Mean</mtext><mo lspace="0em" rspace="0em" id="S4.E14.m1.2.2.1.2" xref="S4.E14.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E14.m1.2.2.1.1.1" xref="S4.E14.m1.2.2.1.1.1.1.cmml"><mo id="S4.E14.m1.2.2.1.1.1.2" xref="S4.E14.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S4.E14.m1.2.2.1.1.1.1" xref="S4.E14.m1.2.2.1.1.1.1.cmml"><mi id="S4.E14.m1.2.2.1.1.1.1.2" xref="S4.E14.m1.2.2.1.1.1.1.2.cmml">𝒉</mi><mrow id="S4.E14.m1.1.1.1.1" xref="S4.E14.m1.1.1.1.2.cmml"><mo id="S4.E14.m1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E14.m1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.2.cmml">n</mi><mo lspace="0.278em" rspace="0.278em" id="S4.E14.m1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.cmml">:</mo><mi id="S4.E14.m1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S4.E14.m1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.2.1.cmml">]</mo></mrow></msub><mo id="S4.E14.m1.2.2.1.1.1.3" xref="S4.E14.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.2b"><apply id="S4.E14.m1.2.2.cmml" xref="S4.E14.m1.2.2"><eq id="S4.E14.m1.2.2.2.cmml" xref="S4.E14.m1.2.2.2"></eq><apply id="S4.E14.m1.2.2.3.cmml" xref="S4.E14.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.3.1.cmml" xref="S4.E14.m1.2.2.3">superscript</csymbol><apply id="S4.E14.m1.2.2.3.2.cmml" xref="S4.E14.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.3.2.1.cmml" xref="S4.E14.m1.2.2.3">subscript</csymbol><ci id="S4.E14.m1.2.2.3.2.2.cmml" xref="S4.E14.m1.2.2.3.2.2">𝒉</ci><ci id="S4.E14.m1.2.2.3.2.3a.cmml" xref="S4.E14.m1.2.2.3.2.3"><mtext mathsize="70%" id="S4.E14.m1.2.2.3.2.3.cmml" xref="S4.E14.m1.2.2.3.2.3">lang</mtext></ci></apply><times id="S4.E14.m1.2.2.3.3.cmml" xref="S4.E14.m1.2.2.3.3"></times></apply><apply id="S4.E14.m1.2.2.1.cmml" xref="S4.E14.m1.2.2.1"><times id="S4.E14.m1.2.2.1.2.cmml" xref="S4.E14.m1.2.2.1.2"></times><ci id="S4.E14.m1.2.2.1.3a.cmml" xref="S4.E14.m1.2.2.1.3"><mtext id="S4.E14.m1.2.2.1.3.cmml" xref="S4.E14.m1.2.2.1.3">Mean</mtext></ci><apply id="S4.E14.m1.2.2.1.1.1.1.cmml" xref="S4.E14.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.1.1.1.1.1.cmml" xref="S4.E14.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.E14.m1.2.2.1.1.1.1.2.cmml" xref="S4.E14.m1.2.2.1.1.1.1.2">𝒉</ci><apply id="S4.E14.m1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1"><csymbol cd="latexml" id="S4.E14.m1.1.1.1.2.1.cmml" xref="S4.E14.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E14.m1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1"><ci id="S4.E14.m1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1">:</ci><ci id="S4.E14.m1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.2">𝑛</ci><ci id="S4.E14.m1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.2c">\displaystyle\boldsymbol{h}_{\text{lang}}^{*}=\text{Mean}\left(\boldsymbol{h}_{\left[n:m\right]}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<table id="A1.EGx15" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E15.m1.2" class="ltx_Math" alttext="\displaystyle\mathscr{L}_{\text{lang}}=\text{MSE}\left(\boldsymbol{h}_{i}^{\text{lang}},\boldsymbol{h}_{\text{lang}}^{*}\right)" display="inline"><semantics id="S4.E15.m1.2a"><mrow id="S4.E15.m1.2.2" xref="S4.E15.m1.2.2.cmml"><msub id="S4.E15.m1.2.2.4" xref="S4.E15.m1.2.2.4.cmml"><mi class="ltx_font_mathscript" id="S4.E15.m1.2.2.4.2" xref="S4.E15.m1.2.2.4.2.cmml">ℒ</mi><mtext id="S4.E15.m1.2.2.4.3" xref="S4.E15.m1.2.2.4.3a.cmml">lang</mtext></msub><mo id="S4.E15.m1.2.2.3" xref="S4.E15.m1.2.2.3.cmml">=</mo><mrow id="S4.E15.m1.2.2.2" xref="S4.E15.m1.2.2.2.cmml"><mtext id="S4.E15.m1.2.2.2.4" xref="S4.E15.m1.2.2.2.4a.cmml">MSE</mtext><mo lspace="0em" rspace="0em" id="S4.E15.m1.2.2.2.3" xref="S4.E15.m1.2.2.2.3.cmml">​</mo><mrow id="S4.E15.m1.2.2.2.2.2" xref="S4.E15.m1.2.2.2.2.3.cmml"><mo id="S4.E15.m1.2.2.2.2.2.3" xref="S4.E15.m1.2.2.2.2.3.cmml">(</mo><msubsup id="S4.E15.m1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.2.2" xref="S4.E15.m1.1.1.1.1.1.1.2.2.cmml">𝒉</mi><mi id="S4.E15.m1.1.1.1.1.1.1.2.3" xref="S4.E15.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mtext id="S4.E15.m1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.3a.cmml">lang</mtext></msubsup><mo id="S4.E15.m1.2.2.2.2.2.4" xref="S4.E15.m1.2.2.2.2.3.cmml">,</mo><msubsup id="S4.E15.m1.2.2.2.2.2.2" xref="S4.E15.m1.2.2.2.2.2.2.cmml"><mi id="S4.E15.m1.2.2.2.2.2.2.2.2" xref="S4.E15.m1.2.2.2.2.2.2.2.2.cmml">𝒉</mi><mtext id="S4.E15.m1.2.2.2.2.2.2.2.3" xref="S4.E15.m1.2.2.2.2.2.2.2.3a.cmml">lang</mtext><mo id="S4.E15.m1.2.2.2.2.2.2.3" xref="S4.E15.m1.2.2.2.2.2.2.3.cmml">∗</mo></msubsup><mo id="S4.E15.m1.2.2.2.2.2.5" xref="S4.E15.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.2b"><apply id="S4.E15.m1.2.2.cmml" xref="S4.E15.m1.2.2"><eq id="S4.E15.m1.2.2.3.cmml" xref="S4.E15.m1.2.2.3"></eq><apply id="S4.E15.m1.2.2.4.cmml" xref="S4.E15.m1.2.2.4"><csymbol cd="ambiguous" id="S4.E15.m1.2.2.4.1.cmml" xref="S4.E15.m1.2.2.4">subscript</csymbol><ci id="S4.E15.m1.2.2.4.2.cmml" xref="S4.E15.m1.2.2.4.2">ℒ</ci><ci id="S4.E15.m1.2.2.4.3a.cmml" xref="S4.E15.m1.2.2.4.3"><mtext mathsize="70%" id="S4.E15.m1.2.2.4.3.cmml" xref="S4.E15.m1.2.2.4.3">lang</mtext></ci></apply><apply id="S4.E15.m1.2.2.2.cmml" xref="S4.E15.m1.2.2.2"><times id="S4.E15.m1.2.2.2.3.cmml" xref="S4.E15.m1.2.2.2.3"></times><ci id="S4.E15.m1.2.2.2.4a.cmml" xref="S4.E15.m1.2.2.2.4"><mtext id="S4.E15.m1.2.2.2.4.cmml" xref="S4.E15.m1.2.2.2.4">MSE</mtext></ci><interval closure="open" id="S4.E15.m1.2.2.2.2.3.cmml" xref="S4.E15.m1.2.2.2.2.2"><apply id="S4.E15.m1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E15.m1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.2">𝒉</ci><ci id="S4.E15.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E15.m1.1.1.1.1.1.1.3a.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S4.E15.m1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3">lang</mtext></ci></apply><apply id="S4.E15.m1.2.2.2.2.2.2.cmml" xref="S4.E15.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E15.m1.2.2.2.2.2.2.1.cmml" xref="S4.E15.m1.2.2.2.2.2.2">superscript</csymbol><apply id="S4.E15.m1.2.2.2.2.2.2.2.cmml" xref="S4.E15.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E15.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E15.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E15.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E15.m1.2.2.2.2.2.2.2.2">𝒉</ci><ci id="S4.E15.m1.2.2.2.2.2.2.2.3a.cmml" xref="S4.E15.m1.2.2.2.2.2.2.2.3"><mtext mathsize="70%" id="S4.E15.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E15.m1.2.2.2.2.2.2.2.3">lang</mtext></ci></apply><times id="S4.E15.m1.2.2.2.2.2.2.3.cmml" xref="S4.E15.m1.2.2.2.2.2.2.3"></times></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.2c">\displaystyle\mathscr{L}_{\text{lang}}=\text{MSE}\left(\boldsymbol{h}_{i}^{\text{lang}},\boldsymbol{h}_{\text{lang}}^{*}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Implementation Details</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Our methodology employs the following hyperparameters: The longest side of the image is resized to 1600 while maintaining the original aspect ratio. The downsampling factor of the visual backbone is set to 32. The dimension <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S5.p1.1.m1.1a"><mi id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><ci id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">D</annotation></semantics></math> of the feature is set to 1024. The decoders consist of a stack of 4 identical layers, and the number of multi-heads is set to 16.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Training.</span>
To train UniTabNet, we design three training tasks as depicted in Figure <a href="#S5.F4" title="Figure 4 ‣ 5 Implementation Details ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. These tasks aim to enable the model to comprehensively perceive tabular images. Specifically, the training process is divided into two phases. Initially, during the pre-training phase, we use a synthetic dataset comprising 1.4 million Chinese and English entries from SynthDog <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite>, along with the training set from PubTables1M <cite class="ltx_cite ltx_citemacro_citep">(Smock et al., <a href="#bib.bib28" title="" class="ltx_ref">2022</a>)</cite>. After pre-training, the model is fine-tuned on specialized datasets dedicated to table structure recognition.
We fine-tune UniTabNet using the Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a href="#bib.bib10" title="" class="ltx_ref">2015</a>)</cite> optimizer with the learning rate of <math id="S5.p2.1.m1.1" class="ltx_Math" alttext="5\times 10^{-5}" display="inline"><semantics id="S5.p2.1.m1.1a"><mrow id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml"><mn id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S5.p2.1.m1.1.1.1" xref="S5.p2.1.m1.1.1.1.cmml">×</mo><msup id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3.cmml"><mn id="S5.p2.1.m1.1.1.3.2" xref="S5.p2.1.m1.1.1.3.2.cmml">10</mn><mrow id="S5.p2.1.m1.1.1.3.3" xref="S5.p2.1.m1.1.1.3.3.cmml"><mo id="S5.p2.1.m1.1.1.3.3a" xref="S5.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S5.p2.1.m1.1.1.3.3.2" xref="S5.p2.1.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1"><times id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1.1"></times><cn type="integer" id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">5</cn><apply id="S5.p2.1.m1.1.1.3.cmml" xref="S5.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.p2.1.m1.1.1.3.1.cmml" xref="S5.p2.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S5.p2.1.m1.1.1.3.2.cmml" xref="S5.p2.1.m1.1.1.3.2">10</cn><apply id="S5.p2.1.m1.1.1.3.3.cmml" xref="S5.p2.1.m1.1.1.3.3"><minus id="S5.p2.1.m1.1.1.3.3.1.cmml" xref="S5.p2.1.m1.1.1.3.3"></minus><cn type="integer" id="S5.p2.1.m1.1.1.3.3.2.cmml" xref="S5.p2.1.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">5\times 10^{-5}</annotation></semantics></math>.The learning rate is linearly warmed up over the first 10% steps then linearly decayed. The training is conducted on 8 Telsa A40 48GB GPUs. The model is trained for 100 epochs on the iFLYTAB <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib36" title="" class="ltx_ref">2024</a>)</cite> and WTW <cite class="ltx_cite ltx_citemacro_citep">(Long et al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite> datasets, and for 10 epochs on the PubTables1M and PubTabNet <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al., <a href="#bib.bib39" title="" class="ltx_ref">2020b</a>)</cite> datasets.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.5" class="ltx_p">In the overall loss of UniTabNet, there are primarily two categories: regression losses (<math id="S5.p3.1.m1.1" class="ltx_Math" alttext="\mathscr{L}_{\text{poly}}" display="inline"><semantics id="S5.p3.1.m1.1a"><msub id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathscript" id="S5.p3.1.m1.1.1.2" xref="S5.p3.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S5.p3.1.m1.1.1.3" xref="S5.p3.1.m1.1.1.3a.cmml">poly</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><apply id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p3.1.m1.1.1.1.cmml" xref="S5.p3.1.m1.1.1">subscript</csymbol><ci id="S5.p3.1.m1.1.1.2.cmml" xref="S5.p3.1.m1.1.1.2">ℒ</ci><ci id="S5.p3.1.m1.1.1.3a.cmml" xref="S5.p3.1.m1.1.1.3"><mtext mathsize="70%" id="S5.p3.1.m1.1.1.3.cmml" xref="S5.p3.1.m1.1.1.3">poly</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">\mathscr{L}_{\text{poly}}</annotation></semantics></math>, <math id="S5.p3.2.m2.1" class="ltx_Math" alttext="\mathscr{L}_{\text{lang}}" display="inline"><semantics id="S5.p3.2.m2.1a"><msub id="S5.p3.2.m2.1.1" xref="S5.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathscript" id="S5.p3.2.m2.1.1.2" xref="S5.p3.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S5.p3.2.m2.1.1.3" xref="S5.p3.2.m2.1.1.3a.cmml">lang</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.p3.2.m2.1b"><apply id="S5.p3.2.m2.1.1.cmml" xref="S5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p3.2.m2.1.1.1.cmml" xref="S5.p3.2.m2.1.1">subscript</csymbol><ci id="S5.p3.2.m2.1.1.2.cmml" xref="S5.p3.2.m2.1.1.2">ℒ</ci><ci id="S5.p3.2.m2.1.1.3a.cmml" xref="S5.p3.2.m2.1.1.3"><mtext mathsize="70%" id="S5.p3.2.m2.1.1.3.cmml" xref="S5.p3.2.m2.1.1.3">lang</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.2.m2.1c">\mathscr{L}_{\text{lang}}</annotation></semantics></math>) and classification losses (<math id="S5.p3.3.m3.1" class="ltx_Math" alttext="\mathscr{L}_{\text{lm}}" display="inline"><semantics id="S5.p3.3.m3.1a"><msub id="S5.p3.3.m3.1.1" xref="S5.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathscript" id="S5.p3.3.m3.1.1.2" xref="S5.p3.3.m3.1.1.2.cmml">ℒ</mi><mtext id="S5.p3.3.m3.1.1.3" xref="S5.p3.3.m3.1.1.3a.cmml">lm</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.p3.3.m3.1b"><apply id="S5.p3.3.m3.1.1.cmml" xref="S5.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S5.p3.3.m3.1.1.1.cmml" xref="S5.p3.3.m3.1.1">subscript</csymbol><ci id="S5.p3.3.m3.1.1.2.cmml" xref="S5.p3.3.m3.1.1.2">ℒ</ci><ci id="S5.p3.3.m3.1.1.3a.cmml" xref="S5.p3.3.m3.1.1.3"><mtext mathsize="70%" id="S5.p3.3.m3.1.1.3.cmml" xref="S5.p3.3.m3.1.1.3">lm</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.3.m3.1c">\mathscr{L}_{\text{lm}}</annotation></semantics></math>, <math id="S5.p3.4.m4.1" class="ltx_Math" alttext="\mathscr{L}_{\text{span}}" display="inline"><semantics id="S5.p3.4.m4.1a"><msub id="S5.p3.4.m4.1.1" xref="S5.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathscript" id="S5.p3.4.m4.1.1.2" xref="S5.p3.4.m4.1.1.2.cmml">ℒ</mi><mtext id="S5.p3.4.m4.1.1.3" xref="S5.p3.4.m4.1.1.3a.cmml">span</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.p3.4.m4.1b"><apply id="S5.p3.4.m4.1.1.cmml" xref="S5.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S5.p3.4.m4.1.1.1.cmml" xref="S5.p3.4.m4.1.1">subscript</csymbol><ci id="S5.p3.4.m4.1.1.2.cmml" xref="S5.p3.4.m4.1.1.2">ℒ</ci><ci id="S5.p3.4.m4.1.1.3a.cmml" xref="S5.p3.4.m4.1.1.3"><mtext mathsize="70%" id="S5.p3.4.m4.1.1.3.cmml" xref="S5.p3.4.m4.1.1.3">span</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.4.m4.1c">\mathscr{L}_{\text{span}}</annotation></semantics></math>, <math id="S5.p3.5.m5.1" class="ltx_Math" alttext="\mathscr{L}_{\text{vis}}" display="inline"><semantics id="S5.p3.5.m5.1a"><msub id="S5.p3.5.m5.1.1" xref="S5.p3.5.m5.1.1.cmml"><mi class="ltx_font_mathscript" id="S5.p3.5.m5.1.1.2" xref="S5.p3.5.m5.1.1.2.cmml">ℒ</mi><mtext id="S5.p3.5.m5.1.1.3" xref="S5.p3.5.m5.1.1.3a.cmml">vis</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.p3.5.m5.1b"><apply id="S5.p3.5.m5.1.1.cmml" xref="S5.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S5.p3.5.m5.1.1.1.cmml" xref="S5.p3.5.m5.1.1">subscript</csymbol><ci id="S5.p3.5.m5.1.1.2.cmml" xref="S5.p3.5.m5.1.1.2">ℒ</ci><ci id="S5.p3.5.m5.1.1.3a.cmml" xref="S5.p3.5.m5.1.1.3"><mtext mathsize="70%" id="S5.p3.5.m5.1.1.3.cmml" xref="S5.p3.5.m5.1.1.3">vis</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.5.m5.1c">\mathscr{L}_{\text{vis}}</annotation></semantics></math>). Given the significant scale differences among these losses, it is necessary to adjust their coefficients. Inspired by <cite class="ltx_cite ltx_citemacro_citep">(Kendall et al., <a href="#bib.bib8" title="" class="ltx_ref">2018</a>)</cite> , we optimize the model by maximising the Gaussian likelihood with homoscedastic uncertainty.</p>
<table id="A1.EGx16" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E16.m1.2" class="ltx_Math" alttext="\displaystyle\mathscr{L}_{\text{total}}=\sum_{k=1}^{5}{\frac{1}{2\sigma_{k}^{2}}\mathscr{L}_{k}+\log\left(1+\sigma_{k}^{2}\right)}" display="inline"><semantics id="S5.E16.m1.2a"><mrow id="S5.E16.m1.2.2" xref="S5.E16.m1.2.2.cmml"><msub id="S5.E16.m1.2.2.3" xref="S5.E16.m1.2.2.3.cmml"><mi class="ltx_font_mathscript" id="S5.E16.m1.2.2.3.2" xref="S5.E16.m1.2.2.3.2.cmml">ℒ</mi><mtext id="S5.E16.m1.2.2.3.3" xref="S5.E16.m1.2.2.3.3a.cmml">total</mtext></msub><mo id="S5.E16.m1.2.2.2" xref="S5.E16.m1.2.2.2.cmml">=</mo><mrow id="S5.E16.m1.2.2.1" xref="S5.E16.m1.2.2.1.cmml"><mrow id="S5.E16.m1.2.2.1.3" xref="S5.E16.m1.2.2.1.3.cmml"><mstyle displaystyle="true" id="S5.E16.m1.2.2.1.3.1" xref="S5.E16.m1.2.2.1.3.1.cmml"><munderover id="S5.E16.m1.2.2.1.3.1a" xref="S5.E16.m1.2.2.1.3.1.cmml"><mo movablelimits="false" id="S5.E16.m1.2.2.1.3.1.2.2" xref="S5.E16.m1.2.2.1.3.1.2.2.cmml">∑</mo><mrow id="S5.E16.m1.2.2.1.3.1.2.3" xref="S5.E16.m1.2.2.1.3.1.2.3.cmml"><mi id="S5.E16.m1.2.2.1.3.1.2.3.2" xref="S5.E16.m1.2.2.1.3.1.2.3.2.cmml">k</mi><mo id="S5.E16.m1.2.2.1.3.1.2.3.1" xref="S5.E16.m1.2.2.1.3.1.2.3.1.cmml">=</mo><mn id="S5.E16.m1.2.2.1.3.1.2.3.3" xref="S5.E16.m1.2.2.1.3.1.2.3.3.cmml">1</mn></mrow><mn id="S5.E16.m1.2.2.1.3.1.3" xref="S5.E16.m1.2.2.1.3.1.3.cmml">5</mn></munderover></mstyle><mrow id="S5.E16.m1.2.2.1.3.2" xref="S5.E16.m1.2.2.1.3.2.cmml"><mstyle displaystyle="true" id="S5.E16.m1.2.2.1.3.2.2" xref="S5.E16.m1.2.2.1.3.2.2.cmml"><mfrac id="S5.E16.m1.2.2.1.3.2.2a" xref="S5.E16.m1.2.2.1.3.2.2.cmml"><mn id="S5.E16.m1.2.2.1.3.2.2.2" xref="S5.E16.m1.2.2.1.3.2.2.2.cmml">1</mn><mrow id="S5.E16.m1.2.2.1.3.2.2.3" xref="S5.E16.m1.2.2.1.3.2.2.3.cmml"><mn id="S5.E16.m1.2.2.1.3.2.2.3.2" xref="S5.E16.m1.2.2.1.3.2.2.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S5.E16.m1.2.2.1.3.2.2.3.1" xref="S5.E16.m1.2.2.1.3.2.2.3.1.cmml">​</mo><msubsup id="S5.E16.m1.2.2.1.3.2.2.3.3" xref="S5.E16.m1.2.2.1.3.2.2.3.3.cmml"><mi id="S5.E16.m1.2.2.1.3.2.2.3.3.2.2" xref="S5.E16.m1.2.2.1.3.2.2.3.3.2.2.cmml">σ</mi><mi id="S5.E16.m1.2.2.1.3.2.2.3.3.2.3" xref="S5.E16.m1.2.2.1.3.2.2.3.3.2.3.cmml">k</mi><mn id="S5.E16.m1.2.2.1.3.2.2.3.3.3" xref="S5.E16.m1.2.2.1.3.2.2.3.3.3.cmml">2</mn></msubsup></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S5.E16.m1.2.2.1.3.2.1" xref="S5.E16.m1.2.2.1.3.2.1.cmml">​</mo><msub id="S5.E16.m1.2.2.1.3.2.3" xref="S5.E16.m1.2.2.1.3.2.3.cmml"><mi class="ltx_font_mathscript" id="S5.E16.m1.2.2.1.3.2.3.2" xref="S5.E16.m1.2.2.1.3.2.3.2.cmml">ℒ</mi><mi id="S5.E16.m1.2.2.1.3.2.3.3" xref="S5.E16.m1.2.2.1.3.2.3.3.cmml">k</mi></msub></mrow></mrow><mo id="S5.E16.m1.2.2.1.2" xref="S5.E16.m1.2.2.1.2.cmml">+</mo><mrow id="S5.E16.m1.2.2.1.1.1" xref="S5.E16.m1.2.2.1.1.2.cmml"><mi id="S5.E16.m1.1.1" xref="S5.E16.m1.1.1.cmml">log</mi><mo id="S5.E16.m1.2.2.1.1.1a" xref="S5.E16.m1.2.2.1.1.2.cmml">⁡</mo><mrow id="S5.E16.m1.2.2.1.1.1.1" xref="S5.E16.m1.2.2.1.1.2.cmml"><mo id="S5.E16.m1.2.2.1.1.1.1.2" xref="S5.E16.m1.2.2.1.1.2.cmml">(</mo><mrow id="S5.E16.m1.2.2.1.1.1.1.1" xref="S5.E16.m1.2.2.1.1.1.1.1.cmml"><mn id="S5.E16.m1.2.2.1.1.1.1.1.2" xref="S5.E16.m1.2.2.1.1.1.1.1.2.cmml">1</mn><mo id="S5.E16.m1.2.2.1.1.1.1.1.1" xref="S5.E16.m1.2.2.1.1.1.1.1.1.cmml">+</mo><msubsup id="S5.E16.m1.2.2.1.1.1.1.1.3" xref="S5.E16.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S5.E16.m1.2.2.1.1.1.1.1.3.2.2" xref="S5.E16.m1.2.2.1.1.1.1.1.3.2.2.cmml">σ</mi><mi id="S5.E16.m1.2.2.1.1.1.1.1.3.2.3" xref="S5.E16.m1.2.2.1.1.1.1.1.3.2.3.cmml">k</mi><mn id="S5.E16.m1.2.2.1.1.1.1.1.3.3" xref="S5.E16.m1.2.2.1.1.1.1.1.3.3.cmml">2</mn></msubsup></mrow><mo id="S5.E16.m1.2.2.1.1.1.1.3" xref="S5.E16.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E16.m1.2b"><apply id="S5.E16.m1.2.2.cmml" xref="S5.E16.m1.2.2"><eq id="S5.E16.m1.2.2.2.cmml" xref="S5.E16.m1.2.2.2"></eq><apply id="S5.E16.m1.2.2.3.cmml" xref="S5.E16.m1.2.2.3"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.3.1.cmml" xref="S5.E16.m1.2.2.3">subscript</csymbol><ci id="S5.E16.m1.2.2.3.2.cmml" xref="S5.E16.m1.2.2.3.2">ℒ</ci><ci id="S5.E16.m1.2.2.3.3a.cmml" xref="S5.E16.m1.2.2.3.3"><mtext mathsize="70%" id="S5.E16.m1.2.2.3.3.cmml" xref="S5.E16.m1.2.2.3.3">total</mtext></ci></apply><apply id="S5.E16.m1.2.2.1.cmml" xref="S5.E16.m1.2.2.1"><plus id="S5.E16.m1.2.2.1.2.cmml" xref="S5.E16.m1.2.2.1.2"></plus><apply id="S5.E16.m1.2.2.1.3.cmml" xref="S5.E16.m1.2.2.1.3"><apply id="S5.E16.m1.2.2.1.3.1.cmml" xref="S5.E16.m1.2.2.1.3.1"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.3.1.1.cmml" xref="S5.E16.m1.2.2.1.3.1">superscript</csymbol><apply id="S5.E16.m1.2.2.1.3.1.2.cmml" xref="S5.E16.m1.2.2.1.3.1"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.3.1.2.1.cmml" xref="S5.E16.m1.2.2.1.3.1">subscript</csymbol><sum id="S5.E16.m1.2.2.1.3.1.2.2.cmml" xref="S5.E16.m1.2.2.1.3.1.2.2"></sum><apply id="S5.E16.m1.2.2.1.3.1.2.3.cmml" xref="S5.E16.m1.2.2.1.3.1.2.3"><eq id="S5.E16.m1.2.2.1.3.1.2.3.1.cmml" xref="S5.E16.m1.2.2.1.3.1.2.3.1"></eq><ci id="S5.E16.m1.2.2.1.3.1.2.3.2.cmml" xref="S5.E16.m1.2.2.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S5.E16.m1.2.2.1.3.1.2.3.3.cmml" xref="S5.E16.m1.2.2.1.3.1.2.3.3">1</cn></apply></apply><cn type="integer" id="S5.E16.m1.2.2.1.3.1.3.cmml" xref="S5.E16.m1.2.2.1.3.1.3">5</cn></apply><apply id="S5.E16.m1.2.2.1.3.2.cmml" xref="S5.E16.m1.2.2.1.3.2"><times id="S5.E16.m1.2.2.1.3.2.1.cmml" xref="S5.E16.m1.2.2.1.3.2.1"></times><apply id="S5.E16.m1.2.2.1.3.2.2.cmml" xref="S5.E16.m1.2.2.1.3.2.2"><divide id="S5.E16.m1.2.2.1.3.2.2.1.cmml" xref="S5.E16.m1.2.2.1.3.2.2"></divide><cn type="integer" id="S5.E16.m1.2.2.1.3.2.2.2.cmml" xref="S5.E16.m1.2.2.1.3.2.2.2">1</cn><apply id="S5.E16.m1.2.2.1.3.2.2.3.cmml" xref="S5.E16.m1.2.2.1.3.2.2.3"><times id="S5.E16.m1.2.2.1.3.2.2.3.1.cmml" xref="S5.E16.m1.2.2.1.3.2.2.3.1"></times><cn type="integer" id="S5.E16.m1.2.2.1.3.2.2.3.2.cmml" xref="S5.E16.m1.2.2.1.3.2.2.3.2">2</cn><apply id="S5.E16.m1.2.2.1.3.2.2.3.3.cmml" xref="S5.E16.m1.2.2.1.3.2.2.3.3"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.3.2.2.3.3.1.cmml" xref="S5.E16.m1.2.2.1.3.2.2.3.3">superscript</csymbol><apply id="S5.E16.m1.2.2.1.3.2.2.3.3.2.cmml" xref="S5.E16.m1.2.2.1.3.2.2.3.3"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.3.2.2.3.3.2.1.cmml" xref="S5.E16.m1.2.2.1.3.2.2.3.3">subscript</csymbol><ci id="S5.E16.m1.2.2.1.3.2.2.3.3.2.2.cmml" xref="S5.E16.m1.2.2.1.3.2.2.3.3.2.2">𝜎</ci><ci id="S5.E16.m1.2.2.1.3.2.2.3.3.2.3.cmml" xref="S5.E16.m1.2.2.1.3.2.2.3.3.2.3">𝑘</ci></apply><cn type="integer" id="S5.E16.m1.2.2.1.3.2.2.3.3.3.cmml" xref="S5.E16.m1.2.2.1.3.2.2.3.3.3">2</cn></apply></apply></apply><apply id="S5.E16.m1.2.2.1.3.2.3.cmml" xref="S5.E16.m1.2.2.1.3.2.3"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.3.2.3.1.cmml" xref="S5.E16.m1.2.2.1.3.2.3">subscript</csymbol><ci id="S5.E16.m1.2.2.1.3.2.3.2.cmml" xref="S5.E16.m1.2.2.1.3.2.3.2">ℒ</ci><ci id="S5.E16.m1.2.2.1.3.2.3.3.cmml" xref="S5.E16.m1.2.2.1.3.2.3.3">𝑘</ci></apply></apply></apply><apply id="S5.E16.m1.2.2.1.1.2.cmml" xref="S5.E16.m1.2.2.1.1.1"><log id="S5.E16.m1.1.1.cmml" xref="S5.E16.m1.1.1"></log><apply id="S5.E16.m1.2.2.1.1.1.1.1.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1"><plus id="S5.E16.m1.2.2.1.1.1.1.1.1.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.1"></plus><cn type="integer" id="S5.E16.m1.2.2.1.1.1.1.1.2.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.2">1</cn><apply id="S5.E16.m1.2.2.1.1.1.1.1.3.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.3">superscript</csymbol><apply id="S5.E16.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E16.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S5.E16.m1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.3.2.2">𝜎</ci><ci id="S5.E16.m1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.3.2.3">𝑘</ci></apply><cn type="integer" id="S5.E16.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S5.E16.m1.2.2.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E16.m1.2c">\displaystyle\mathscr{L}_{\text{total}}=\sum_{k=1}^{5}{\frac{1}{2\sigma_{k}^{2}}\mathscr{L}_{k}+\log\left(1+\sigma_{k}^{2}\right)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="S5.p3.7" class="ltx_p">The <math id="S5.p3.6.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S5.p3.6.m1.1a"><mi id="S5.p3.6.m1.1.1" xref="S5.p3.6.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S5.p3.6.m1.1b"><ci id="S5.p3.6.m1.1.1.cmml" xref="S5.p3.6.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.6.m1.1c">\sigma</annotation></semantics></math> is a learnable factor that adaptively adjusts the weight ratios among these losses. <math id="S5.p3.7.m2.1" class="ltx_Math" alttext="\mathscr{L}_{k}" display="inline"><semantics id="S5.p3.7.m2.1a"><msub id="S5.p3.7.m2.1.1" xref="S5.p3.7.m2.1.1.cmml"><mi class="ltx_font_mathscript" id="S5.p3.7.m2.1.1.2" xref="S5.p3.7.m2.1.1.2.cmml">ℒ</mi><mi id="S5.p3.7.m2.1.1.3" xref="S5.p3.7.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p3.7.m2.1b"><apply id="S5.p3.7.m2.1.1.cmml" xref="S5.p3.7.m2.1.1"><csymbol cd="ambiguous" id="S5.p3.7.m2.1.1.1.cmml" xref="S5.p3.7.m2.1.1">subscript</csymbol><ci id="S5.p3.7.m2.1.1.2.cmml" xref="S5.p3.7.m2.1.1.2">ℒ</ci><ci id="S5.p3.7.m2.1.1.3.cmml" xref="S5.p3.7.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.7.m2.1c">\mathscr{L}_{k}</annotation></semantics></math> represents the five losses mentioned above.</p>
</div>
<figure id="S5.F4" class="ltx_figure"><img src="/html/2409.13148/assets/04_taskdesign.png" id="S5.F4.g1" class="ltx_graphics ltx_img_landscape" width="598" height="408" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The illustration of the task design.</figcaption>
</figure>
<div id="S5.p4" class="ltx_para ltx_noindent">
<p id="S5.p4.4" class="ltx_p"><span id="S5.p4.4.1" class="ltx_text ltx_font_bold">Inference.</span>
During the inference phase, we feed the &lt;tsr&gt; token into UniTabNet and utilize a greedy search algorithm to decode the table structure sequence <math id="S5.p4.1.m1.1" class="ltx_Math" alttext="\boldsymbol{S}" display="inline"><semantics id="S5.p4.1.m1.1a"><mi id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S5.p4.1.m1.1b"><ci id="S5.p4.1.m1.1.1.cmml" xref="S5.p4.1.m1.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.1.m1.1c">\boldsymbol{S}</annotation></semantics></math>. Relying on the hidden states <math id="S5.p4.2.m2.1" class="ltx_Math" alttext="\boldsymbol{H}" display="inline"><semantics id="S5.p4.2.m2.1a"><mi id="S5.p4.2.m2.1.1" xref="S5.p4.2.m2.1.1.cmml">𝑯</mi><annotation-xml encoding="MathML-Content" id="S5.p4.2.m2.1b"><ci id="S5.p4.2.m2.1.1.cmml" xref="S5.p4.2.m2.1.1">𝑯</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.2.m2.1c">\boldsymbol{H}</annotation></semantics></math> from the last layer of the decoder, we can decode the physical <math id="S5.p4.3.m3.1" class="ltx_Math" alttext="\boldsymbol{P}" display="inline"><semantics id="S5.p4.3.m3.1a"><mi id="S5.p4.3.m3.1.1" xref="S5.p4.3.m3.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S5.p4.3.m3.1b"><ci id="S5.p4.3.m3.1.1.cmml" xref="S5.p4.3.m3.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.3.m3.1c">\boldsymbol{P}</annotation></semantics></math> and logical <math id="S5.p4.4.m4.1" class="ltx_Math" alttext="\boldsymbol{L}" display="inline"><semantics id="S5.p4.4.m4.1a"><mi id="S5.p4.4.m4.1.1" xref="S5.p4.4.m4.1.1.cmml">𝑳</mi><annotation-xml encoding="MathML-Content" id="S5.p4.4.m4.1b"><ci id="S5.p4.4.m4.1.1.cmml" xref="S5.p4.4.m4.1.1">𝑳</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.4.m4.1c">\boldsymbol{L}</annotation></semantics></math> information corresponding to each cell. This allows for the complete reconstruction of the table structure.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experiments</h2>

<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Datasets and Evaluation Metrics</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p">To fully demonstrate the effectiveness of the UniTabNet, we conduct experiments across four datasets. Firstly, for single-scene electronic document table images, we select two representative datasets, PubTabNet <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al., <a href="#bib.bib39" title="" class="ltx_ref">2020b</a>)</cite> and PubTables1M <cite class="ltx_cite ltx_citemacro_citep">(Smock et al., <a href="#bib.bib28" title="" class="ltx_ref">2022</a>)</cite>, for evaluation. We assess these datasets using the TEDS-Struct <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al., <a href="#bib.bib39" title="" class="ltx_ref">2020b</a>)</cite> and GriTS <cite class="ltx_cite ltx_citemacro_citep">(Smock et al., <a href="#bib.bib29" title="" class="ltx_ref">2023</a>)</cite> metrics to ensure comprehensive and comparative results. For complex scene table images, we chose the WTW <cite class="ltx_cite ltx_citemacro_citep">(Long et al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite> and iFLYTAB <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib36" title="" class="ltx_ref">2024</a>)</cite> datasets for evaluation, employing the F1-Measure <cite class="ltx_cite ltx_citemacro_citep">(Hurst, <a href="#bib.bib7" title="" class="ltx_ref">2003</a>)</cite> and TEDS-Struct metrics to quantify the model’s performance. Notably, we also extract a subset from the iFLYTAB validation set, termed iFLYTAB-DP, which comprises 322 descriptive table images. For more details on the datasets and evaluation metrics, please refer to the Appendix <a href="#A1.SS1" title="A.1 Datasets and Evaluation Metrics ‣ Appendix A Appendix ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a>.</p>
</div>
<figure id="S6.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison on PubTables1M</figcaption>
<div id="S6.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:155.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(91.7pt,-33.0pt) scale(1.73241089987252,1.73241089987252) ;">
<table id="S6.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T1.1.1.1.1" class="ltx_tr">
<th id="S6.T1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Type</th>
<th id="S6.T1.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Method</th>
<th id="S6.T1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">GriTS-Top</th>
<th id="S6.T1.1.1.1.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">GriTS-Loc</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T1.1.1.2.1" class="ltx_tr">
<th id="S6.T1.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="S6.T1.1.1.2.1.1.1" class="ltx_text">
<span id="S6.T1.1.1.2.1.1.1.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:51.2pt;">
<span id="S6.T1.1.1.2.1.1.1.1.1" class="ltx_p">Bottom-up</span>
</span></span></th>
<th id="S6.T1.1.1.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Faster RCNN</th>
<td id="S6.T1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">86.16</td>
<td id="S6.T1.1.1.2.1.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">72.11</td>
</tr>
<tr id="S6.T1.1.1.3.2" class="ltx_tr">
<th id="S6.T1.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">DETR</th>
<td id="S6.T1.1.1.3.2.2" class="ltx_td ltx_align_center">98.45</td>
<td id="S6.T1.1.1.3.2.3" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S6.T1.1.1.3.2.3.1" class="ltx_text ltx_font_bold">97.81</span></td>
</tr>
<tr id="S6.T1.1.1.4.3" class="ltx_tr">
<th id="S6.T1.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="2"><span id="S6.T1.1.1.4.3.1.1" class="ltx_text">
<span id="S6.T1.1.1.4.3.1.1.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:51.2pt;">
<span id="S6.T1.1.1.4.3.1.1.1.1" class="ltx_p">Image-to-Text</span>
</span></span></th>
<th id="S6.T1.1.1.4.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">VAST</th>
<td id="S6.T1.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t">99.22</td>
<td id="S6.T1.1.1.4.3.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">94.99</td>
</tr>
<tr id="S6.T1.1.1.5.4" class="ltx_tr">
<th id="S6.T1.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Ours</th>
<td id="S6.T1.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S6.T1.1.1.5.4.2.1" class="ltx_text ltx_font_bold">99.43</span></td>
<td id="S6.T1.1.1.5.4.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb">95.37</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S6.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Comparison with SOTA methods across different datasets. <span id="S6.T2.2.1" class="ltx_text ltx_font_bold">Bold</span> indicates the best result.</figcaption>
<table id="S6.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T2.3.1.1" class="ltx_tr">
<th id="S6.T2.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_tt">
<span id="S6.T2.3.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.1.1.1.1.1" class="ltx_p" style="width:56.9pt;">Type</span>
</span>
</th>
<th id="S6.T2.3.1.1.2" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_tt">
<span id="S6.T2.3.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.1.1.2.1.1" class="ltx_p" style="width:125.2pt;">Method</span>
</span>
</th>
<td id="S6.T2.3.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">PubTabNet</td>
<td id="S6.T2.3.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="3">WTW</td>
<td id="S6.T2.3.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">iFLYTAB</td>
</tr>
<tr id="S6.T2.3.2.2" class="ltx_tr">
<th id="S6.T2.3.2.2.1" class="ltx_td ltx_nopad_r ltx_align_top ltx_th ltx_th_row"></th>
<th id="S6.T2.3.2.2.2" class="ltx_td ltx_nopad_l ltx_align_top ltx_th ltx_th_row"></th>
<td id="S6.T2.3.2.2.3" class="ltx_td ltx_align_center ltx_border_t">TEDS-Struct</td>
<td id="S6.T2.3.2.2.4" class="ltx_td ltx_align_center ltx_border_t">P</td>
<td id="S6.T2.3.2.2.5" class="ltx_td ltx_align_center ltx_border_t">R</td>
<td id="S6.T2.3.2.2.6" class="ltx_td ltx_align_center ltx_border_t">F1</td>
<td id="S6.T2.3.2.2.7" class="ltx_td ltx_align_center ltx_border_t">TEDS-Struct</td>
</tr>
<tr id="S6.T2.3.3.3" class="ltx_tr">
<th id="S6.T2.3.3.3.1" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t" rowspan="3">
<span id="S6.T2.3.3.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.3.3.1.1.1" class="ltx_p" style="width:56.9pt;"><span id="S6.T2.3.3.3.1.1.1.1" class="ltx_text">
<span id="S6.T2.3.3.3.1.1.1.1.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:56.9pt;">
<span id="S6.T2.3.3.3.1.1.1.1.1.1" class="ltx_p">Bottom-up</span>
</span></span></span>
</span>
</th>
<th id="S6.T2.3.3.3.2" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t">
<span id="S6.T2.3.3.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.3.3.2.1.1" class="ltx_p" style="width:125.2pt;">Cycle-CenterNet <cite class="ltx_cite ltx_citemacro_citep">(Long et al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite></span>
</span>
</th>
<td id="S6.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S6.T2.3.3.3.4" class="ltx_td ltx_align_center ltx_border_t">93.3</td>
<td id="S6.T2.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t">91.5</td>
<td id="S6.T2.3.3.3.6" class="ltx_td ltx_align_center ltx_border_t">92.4</td>
<td id="S6.T2.3.3.3.7" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="S6.T2.3.4.4" class="ltx_tr">
<th id="S6.T2.3.4.4.1" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S6.T2.3.4.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.4.4.1.1.1" class="ltx_p" style="width:125.2pt;">LORE <cite class="ltx_cite ltx_citemacro_citep">(Xing et al., <a href="#bib.bib33" title="" class="ltx_ref">2023</a>)</cite></span>
</span>
</th>
<td id="S6.T2.3.4.4.2" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.4.4.3" class="ltx_td ltx_align_center">94.5</td>
<td id="S6.T2.3.4.4.4" class="ltx_td ltx_align_center"><span id="S6.T2.3.4.4.4.1" class="ltx_text ltx_font_bold">95.9</span></td>
<td id="S6.T2.3.4.4.5" class="ltx_td ltx_align_center"><span id="S6.T2.3.4.4.5.1" class="ltx_text ltx_font_bold">95.1</span></td>
<td id="S6.T2.3.4.4.6" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S6.T2.3.5.5" class="ltx_tr">
<th id="S6.T2.3.5.5.1" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S6.T2.3.5.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.5.5.1.1.1" class="ltx_p" style="width:125.2pt;">LGPMA <cite class="ltx_cite ltx_citemacro_citep">(Qiao et al., <a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite></span>
</span>
</th>
<td id="S6.T2.3.5.5.2" class="ltx_td ltx_align_center">96.70</td>
<td id="S6.T2.3.5.5.3" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.5.5.4" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.5.5.5" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.5.5.6" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S6.T2.3.6.6" class="ltx_tr">
<th id="S6.T2.3.6.6.1" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t" rowspan="6">
<span id="S6.T2.3.6.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.6.6.1.1.1" class="ltx_p" style="width:56.9pt;"><span id="S6.T2.3.6.6.1.1.1.1" class="ltx_text">
<span id="S6.T2.3.6.6.1.1.1.1.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:56.9pt;">
<span id="S6.T2.3.6.6.1.1.1.1.1.1" class="ltx_p">Split-and-merge</span>
</span></span></span>
</span>
</th>
<th id="S6.T2.3.6.6.2" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t">
<span id="S6.T2.3.6.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.6.6.2.1.1" class="ltx_p" style="width:125.2pt;">SEM <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib37" title="" class="ltx_ref">2022</a>)</cite></span>
</span>
</th>
<td id="S6.T2.3.6.6.3" class="ltx_td ltx_align_center ltx_border_t">96.30</td>
<td id="S6.T2.3.6.6.4" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S6.T2.3.6.6.5" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S6.T2.3.6.6.6" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S6.T2.3.6.6.7" class="ltx_td ltx_align_center ltx_border_t">75.9</td>
</tr>
<tr id="S6.T2.3.7.7" class="ltx_tr">
<th id="S6.T2.3.7.7.1" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S6.T2.3.7.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.7.7.1.1.1" class="ltx_p" style="width:125.2pt;">RobustTabNet <cite class="ltx_cite ltx_citemacro_citep">(Ma et al., <a href="#bib.bib19" title="" class="ltx_ref">2023</a>)</cite></span>
</span>
</th>
<td id="S6.T2.3.7.7.2" class="ltx_td ltx_align_center">97.00</td>
<td id="S6.T2.3.7.7.3" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.7.7.4" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.7.7.5" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.7.7.6" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S6.T2.3.8.8" class="ltx_tr">
<th id="S6.T2.3.8.8.1" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S6.T2.3.8.8.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.8.8.1.1.1" class="ltx_p" style="width:125.2pt;">TSRFormer <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite></span>
</span>
</th>
<td id="S6.T2.3.8.8.2" class="ltx_td ltx_align_center"><span id="S6.T2.3.8.8.2.1" class="ltx_text ltx_font_bold">97.50</span></td>
<td id="S6.T2.3.8.8.3" class="ltx_td ltx_align_center">93.7</td>
<td id="S6.T2.3.8.8.4" class="ltx_td ltx_align_center">93.2</td>
<td id="S6.T2.3.8.8.5" class="ltx_td ltx_align_center">93.4</td>
<td id="S6.T2.3.8.8.6" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S6.T2.3.9.9" class="ltx_tr">
<th id="S6.T2.3.9.9.1" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S6.T2.3.9.9.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.9.9.1.1.1" class="ltx_p" style="width:125.2pt;">SEMv2 <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib36" title="" class="ltx_ref">2024</a>)</cite></span>
</span>
</th>
<td id="S6.T2.3.9.9.2" class="ltx_td ltx_align_center"><span id="S6.T2.3.9.9.2.1" class="ltx_text ltx_font_bold">97.50</span></td>
<td id="S6.T2.3.9.9.3" class="ltx_td ltx_align_center">93.8</td>
<td id="S6.T2.3.9.9.4" class="ltx_td ltx_align_center">93.4</td>
<td id="S6.T2.3.9.9.5" class="ltx_td ltx_align_center">93.6</td>
<td id="S6.T2.3.9.9.6" class="ltx_td ltx_align_center">92.0</td>
</tr>
<tr id="S6.T2.3.10.10" class="ltx_tr">
<th id="S6.T2.3.10.10.1" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S6.T2.3.10.10.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.10.10.1.1.1" class="ltx_p" style="width:125.2pt;">TRUST <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib5" title="" class="ltx_ref">2022</a>)</cite></span>
</span>
</th>
<td id="S6.T2.3.10.10.2" class="ltx_td ltx_align_center">97.10</td>
<td id="S6.T2.3.10.10.3" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.10.10.4" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.10.10.5" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.10.10.6" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S6.T2.3.11.11" class="ltx_tr">
<th id="S6.T2.3.11.11.1" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S6.T2.3.11.11.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.11.11.1.1.1" class="ltx_p" style="width:125.2pt;">SEMv3 <cite class="ltx_cite ltx_citemacro_citep">(Qin et al., <a href="#bib.bib24" title="" class="ltx_ref">2024</a>)</cite></span>
</span>
</th>
<td id="S6.T2.3.11.11.2" class="ltx_td ltx_align_center"><span id="S6.T2.3.11.11.2.1" class="ltx_text ltx_font_bold">97.50</span></td>
<td id="S6.T2.3.11.11.3" class="ltx_td ltx_align_center">94.8</td>
<td id="S6.T2.3.11.11.4" class="ltx_td ltx_align_center">95.4</td>
<td id="S6.T2.3.11.11.5" class="ltx_td ltx_align_center"><span id="S6.T2.3.11.11.5.1" class="ltx_text ltx_font_bold">95.1</span></td>
<td id="S6.T2.3.11.11.6" class="ltx_td ltx_align_center">93.2</td>
</tr>
<tr id="S6.T2.3.12.12" class="ltx_tr">
<th id="S6.T2.3.12.12.1" class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="4">
<span id="S6.T2.3.12.12.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.12.12.1.1.1" class="ltx_p" style="width:56.9pt;"><span id="S6.T2.3.12.12.1.1.1.1" class="ltx_text">
<span id="S6.T2.3.12.12.1.1.1.1.1" class="ltx_inline-block ltx_parbox ltx_align_middle" style="width:56.9pt;">
<span id="S6.T2.3.12.12.1.1.1.1.1.1" class="ltx_p">Image-to-Text</span>
</span></span></span>
</span>
</th>
<th id="S6.T2.3.12.12.2" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t">
<span id="S6.T2.3.12.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.12.12.2.1.1" class="ltx_p" style="width:125.2pt;">EDD <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al., <a href="#bib.bib39" title="" class="ltx_ref">2020b</a>)</cite></span>
</span>
</th>
<td id="S6.T2.3.12.12.3" class="ltx_td ltx_align_center ltx_border_t">89.90</td>
<td id="S6.T2.3.12.12.4" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S6.T2.3.12.12.5" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S6.T2.3.12.12.6" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S6.T2.3.12.12.7" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="S6.T2.3.13.13" class="ltx_tr">
<th id="S6.T2.3.13.13.1" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S6.T2.3.13.13.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.13.13.1.1.1" class="ltx_p" style="width:125.2pt;">TableFromer <cite class="ltx_cite ltx_citemacro_citep">(Nassar et al., <a href="#bib.bib20" title="" class="ltx_ref">2022</a>)</cite></span>
</span>
</th>
<td id="S6.T2.3.13.13.2" class="ltx_td ltx_align_center">96.75</td>
<td id="S6.T2.3.13.13.3" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.13.13.4" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.13.13.5" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.13.13.6" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S6.T2.3.14.14" class="ltx_tr">
<th id="S6.T2.3.14.14.1" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="S6.T2.3.14.14.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.14.14.1.1.1" class="ltx_p" style="width:125.2pt;">VAST <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib6" title="" class="ltx_ref">2023</a>)</cite></span>
</span>
</th>
<td id="S6.T2.3.14.14.2" class="ltx_td ltx_align_center">97.23</td>
<td id="S6.T2.3.14.14.3" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.14.14.4" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.14.14.5" class="ltx_td ltx_align_center">-</td>
<td id="S6.T2.3.14.14.6" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S6.T2.3.15.15" class="ltx_tr">
<th id="S6.T2.3.15.15.1" class="ltx_td ltx_nopad_l ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_bb">
<span id="S6.T2.3.15.15.1.1" class="ltx_inline-block ltx_align_top">
<span id="S6.T2.3.15.15.1.1.1" class="ltx_p" style="width:125.2pt;">Ours</span>
</span>
</th>
<td id="S6.T2.3.15.15.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S6.T2.3.15.15.2.1" class="ltx_text ltx_font_bold">97.50</span></td>
<td id="S6.T2.3.15.15.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S6.T2.3.15.15.3.1" class="ltx_text ltx_font_bold">95.6</span></td>
<td id="S6.T2.3.15.15.4" class="ltx_td ltx_align_center ltx_border_bb">94.7</td>
<td id="S6.T2.3.15.15.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S6.T2.3.15.15.5.1" class="ltx_text ltx_font_bold">95.1</span></td>
<td id="S6.T2.3.15.15.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S6.T2.3.15.15.6.1" class="ltx_text ltx_font_bold">94.0</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Results</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p">In this section, we evaluate the effectiveness of UniTabNet from three different perspectives. More details are provided in the Appendix <a href="#A1.SS2" title="A.2 Results ‣ Appendix A Appendix ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a>.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para ltx_noindent">
<p id="S6.SS2.p2.1" class="ltx_p"><span id="S6.SS2.p2.1.1" class="ltx_text ltx_font_bold">Results from Electronic Document.</span>
As shown in Table <a href="#S6.T1" title="Table 1 ‣ 6.1 Datasets and Evaluation Metrics ‣ 6 Experiments ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, compared to Image-to-Text approaches, our method has achieved a new state-of-the-art level. Although the bottom-up method <cite class="ltx_cite ltx_citemacro_citep">(Carion et al., <a href="#bib.bib1" title="" class="ltx_ref">2020</a>)</cite> performs better on the GriTS-Loc metric, this is due to their use of the bounding box of the content within the cell to adjust the predicted bounding box of the cell. As illustrated in Table <a href="#S6.T2" title="Table 2 ‣ 6.1 Datasets and Evaluation Metrics ‣ 6 Experiments ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, UniTabNet also performs comparably to the current advanced methods on the PubTabNet dataset.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para ltx_noindent">
<p id="S6.SS2.p3.1" class="ltx_p"><span id="S6.SS2.p3.1.1" class="ltx_text ltx_font_bold">Results from Complex Scenarios.</span>
As shown in Table <a href="#S6.T2" title="Table 2 ‣ 6.1 Datasets and Evaluation Metrics ‣ 6 Experiments ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, to demonstrate the robustness of UniTabNet in visual scenarios, we conduct experiments on the WTW and iFLYTAB datasets. On the WTW dataset, our method exhibits high precision but lower recall, primarily constrained by the maximum decoding length of the model. Therefore, compared to other non-autoregressive methods (Bottom-up and Split-and-merge), it achieves lower recall but comparable overall F1 scores with current methods. On the iFLYTAB dataset, UniTabNet achieves a new state-of-the-art performance.</p>
</div>
<div id="S6.SS2.p4" class="ltx_para ltx_noindent">
<p id="S6.SS2.p4.1" class="ltx_p"><span id="S6.SS2.p4.1.1" class="ltx_text ltx_font_bold">Results from Descriptive Tables.</span>
To demonstrate the effectiveness of UniTabNet in addressing descriptive tables, as shown in Table <a href="#S6.T3" title="Table 3 ‣ 6.3 Ablation Study ‣ 6 Experiments ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we compare UniTabNet with the previously state-of-the-art SEMv3 <cite class="ltx_cite ltx_citemacro_citep">(Qin et al., <a href="#bib.bib24" title="" class="ltx_ref">2024</a>)</cite> on the iFLYTAB-DP dataset. SEMv3 is a purely visual approach for reconstructing table structures. However, iFLYTAB-DP contains a large number of tables with descriptive cells, requiring the model to understand the textual information within to make accurate structural predictions. The comparison shows that UniTabNet significantly outperforms SEMv3 in this scenario.</p>
</div>
<figure id="S6.F5" class="ltx_figure"><img src="/html/2409.13148/assets/05_ablation.png" id="S6.F5.g1" class="ltx_graphics ltx_img_landscape" width="598" height="221" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>The illustration of the Vision Guider and Language Guider. Panels (a) and (b) compare the attention distributions within the decoding cells (regions indicated by red dashed boxes) for systems T2 and T3, respectively. Panels (c) and (d) display the comparative structural prediction results on iFLYTAB-DP for systems T3 and T4. The red dashed boxes highlight the regions where the predictions differ between the two systems, with system T4 accurately predicting in these areas.</figcaption>
</figure>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Ablation Study</h3>

<figure id="S6.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results of the TEDS-Struct evaluation for the UniTabNet model on the iFLYTAB and iFLYTAB-DB datasets. “UL” denotes “Use of Uncertainty in Likelihood Optimization” as detailed in Eq. <a href="#S5.E16" title="In 5 Implementation Details ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>. “VG” indicates the inclusion of a vision guider, and “LG” signifies the use of a language guider. “D1” and “D2” correspond to the performance metrics on the iFLYTAB validation set and iFLYTAB-DP set, respectively.</figcaption>
<table id="S6.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T3.1.1.1" class="ltx_tr">
<th id="S6.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">System</th>
<th id="S6.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">UL</th>
<th id="S6.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">VG</th>
<th id="S6.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">LG</th>
<th id="S6.T3.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">D1</th>
<th id="S6.T3.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">D2</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T3.1.2.1" class="ltx_tr">
<td id="S6.T3.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">SEMv3</td>
<td id="S6.T3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S6.T3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S6.T3.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S6.T3.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">93.2</td>
<td id="S6.T3.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">82.6</td>
</tr>
<tr id="S6.T3.1.3.2" class="ltx_tr">
<td id="S6.T3.1.3.2.1" class="ltx_td ltx_align_center">T1</td>
<td id="S6.T3.1.3.2.2" class="ltx_td ltx_align_center">✗</td>
<td id="S6.T3.1.3.2.3" class="ltx_td ltx_align_center">✗</td>
<td id="S6.T3.1.3.2.4" class="ltx_td ltx_align_center">✗</td>
<td id="S6.T3.1.3.2.5" class="ltx_td ltx_align_center">92.4</td>
<td id="S6.T3.1.3.2.6" class="ltx_td ltx_align_center">82.9</td>
</tr>
<tr id="S6.T3.1.4.3" class="ltx_tr">
<td id="S6.T3.1.4.3.1" class="ltx_td ltx_align_center">T2</td>
<td id="S6.T3.1.4.3.2" class="ltx_td ltx_align_center">✓</td>
<td id="S6.T3.1.4.3.3" class="ltx_td ltx_align_center">✗</td>
<td id="S6.T3.1.4.3.4" class="ltx_td ltx_align_center">✗</td>
<td id="S6.T3.1.4.3.5" class="ltx_td ltx_align_center">93.2</td>
<td id="S6.T3.1.4.3.6" class="ltx_td ltx_align_center">83.3</td>
</tr>
<tr id="S6.T3.1.5.4" class="ltx_tr">
<td id="S6.T3.1.5.4.1" class="ltx_td ltx_align_center">T3</td>
<td id="S6.T3.1.5.4.2" class="ltx_td ltx_align_center">✓</td>
<td id="S6.T3.1.5.4.3" class="ltx_td ltx_align_center">✓</td>
<td id="S6.T3.1.5.4.4" class="ltx_td ltx_align_center">✗</td>
<td id="S6.T3.1.5.4.5" class="ltx_td ltx_align_center">93.7</td>
<td id="S6.T3.1.5.4.6" class="ltx_td ltx_align_center">83.6</td>
</tr>
<tr id="S6.T3.1.6.5" class="ltx_tr">
<td id="S6.T3.1.6.5.1" class="ltx_td ltx_align_center ltx_border_bb">T4</td>
<td id="S6.T3.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S6.T3.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S6.T3.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S6.T3.1.6.5.5" class="ltx_td ltx_align_center ltx_border_bb">94.0</td>
<td id="S6.T3.1.6.5.6" class="ltx_td ltx_align_center ltx_border_bb">84.9</td>
</tr>
</tbody>
</table>
</figure>
<div id="S6.SS3.p1" class="ltx_para">
<p id="S6.SS3.p1.1" class="ltx_p">As shown in Table <a href="#S6.T3" title="Table 3 ‣ 6.3 Ablation Study ‣ 6 Experiments ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, to demonstrate the effectiveness of each module within the model, we design systems T1 through T4, which were evaluated on both iFLYTAB and iFLYTAB-DP datasets.</p>
</div>
<div id="S6.SS3.p2" class="ltx_para ltx_noindent">
<p id="S6.SS3.p2.1" class="ltx_p"><span id="S6.SS3.p2.1.1" class="ltx_text ltx_font_bold">The Effectiveness of Loss Design.</span>
During the entire training process of UniTabNet, the primary losses include regression loss and classification loss, which differ significantly in scale. Inspired by <cite class="ltx_cite ltx_citemacro_citep">(Kendall et al., <a href="#bib.bib8" title="" class="ltx_ref">2018</a>)</cite>, we optimize the model by maximizing the Gaussian likelihood with homoscedastic uncertainty, as described in Eq. <a href="#S5.E16" title="In 5 Implementation Details ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>. Comparing systems T1 and T2 demonstrates the effectiveness of this loss design.</p>
</div>
<div id="S6.SS3.p3" class="ltx_para ltx_noindent">
<p id="S6.SS3.p3.1" class="ltx_p"><span id="S6.SS3.p3.1.1" class="ltx_text ltx_font_bold">The Effectiveness of Vision Guider.</span>
Table images are distinct from conventional document images, as each table cell provides unique visual cues linked to the corresponding row or column. In UniTabNet, we incorporate a Vision Guider at the final decoder layer to steer the model’s focus towards pertinent visual segments of the table image. Figure <a href="#S6.F5" title="Figure 5 ‣ 6.2 Results ‣ 6 Experiments ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> illustrates the cross-attention mechanisms (averaged across the heads of the final layer) during the decoding stages of systems T2 and T3. The visualizations reveal that T3 more effectively concentrates on the regions pertaining to table cells throughout the decoding process. Furthermore, as shown in Table <a href="#S6.T3" title="Table 3 ‣ 6.3 Ablation Study ‣ 6 Experiments ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, T3 outperforms T2, demonstrating the effectiveness of the Vision Guider.</p>
</div>
<div id="S6.SS3.p4" class="ltx_para ltx_noindent">
<p id="S6.SS3.p4.1" class="ltx_p"><span id="S6.SS3.p4.1.1" class="ltx_text ltx_font_bold">The Effectiveness of Language Guider.</span>
Most previous methods for table structure recognition focus on reconstructing the table structure from a visual perspective. However, for tables rich in descriptive content, relying solely on visual cues can introduce ambiguities. In UniTabNet, we integrate a Language Guider into the final layer of the decoder, enhancing the model’s capability to interpret the semantic content of the text. Figure <a href="#S6.F5" title="Figure 5 ‣ 6.2 Results ‣ 6 Experiments ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> displays the prediction results for systems T3 and T4 on the iFLYTAB-DP dataset, illustrating that T4 effectively mitigates visual ambiguities and improves text comprehension. Furthermore, as demonstrated in Table <a href="#S6.T3" title="Table 3 ‣ 6.3 Ablation Study ‣ 6 Experiments ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, T4 significantly outperforms T3 on the iFLYTAB-DP dataset, highlighting the effectiveness of the Language Guider.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In this paper, we present UniTabNet, a novel table structure recognition model leveraging the image-to-text paradigm, consisting of a vision encoder and a text decoder. UniTabNet employs a “divide-and-conquer” strategy to initially separate table cells, then uses physical and logical decoders to reconstruct cell polygon and span information. To improve visual focus and textual understanding within cells, we integrate a Vision Guider and a Language Guider in the text decoder. Comprehensive experiments conducted on publicly available datasets, including PubTables1M, PubTabNet, WTW, and iFLYTAB, demonstrate that UniTabNet achieves state-of-the-art performance in table structure recognition.</p>
</div>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Limitations</h2>

<div id="S8.p1" class="ltx_para">
<p id="S8.p1.1" class="ltx_p">Although UniTabNet has significantly streamlined the structure sequence of table outputs to only include two tokens: &lt;C&gt; and &lt;NL&gt;, its inference efficiency decreases as the number of table cells increases. Furthermore, due to limitations on maximum decoding length, UniTabNet exhibits relatively lower recall rates for table images with a large number of cells. Moreover, unlike the split-and-merge approach which utilizes a carefully designed merge module to handle a variety of table grid structures, UniTabNet employs classification to predict the span of rows and columns. This approach renders UniTabNet ineffective at dealing with previously unseen spans.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carion et al. (2020)</span>
<span class="ltx_bibblock">
Nicolas Carion, Francisco Massa, Gabriel Synnaeve, Nicolas Usunier, Alexander
Kirillov, and Sergey Zagoruyko. 2020.

</span>
<span class="ltx_bibblock">End-to-end object detection with transformers.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, volume 12346, pages 213–229.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2022)</span>
<span class="ltx_bibblock">
Ting Chen, Saurabh Saxena, Lala Li, David J. Fleet, and Geoffrey E. Hinton.
2022.

</span>
<span class="ltx_bibblock">Pix2seq: A language modeling framework for object detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">ICLR</em>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chi et al. (2019)</span>
<span class="ltx_bibblock">
Zewen Chi, Heyan Huang, Heng-Da Xu, Houjin Yu, Wanxuan Yin, and Xian-Ling Mao.
2019.

</span>
<span class="ltx_bibblock">Complicated table structure recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv</em>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Göbel et al. (2012)</span>
<span class="ltx_bibblock">
Max C. Göbel, Tamir Hassan, Ermelinda Oro, and Giorgio Orsi. 2012.

</span>
<span class="ltx_bibblock">A methodology for evaluating algorithms for table understanding in
PDF documents.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">ACM Symposium on Document Engineering, DocEng ’12, Paris,
France, September 4-7, 2012</em>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2022)</span>
<span class="ltx_bibblock">
Zengyuan Guo, Yuechen Yu, Pengyuan Lv, Chengquan Zhang, Haojie Li, Zhihui Wang,
Kun Yao, Jingtuo Liu, and Jingdong Wang. 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://arxiv.org/abs/2208.14687" title="" class="ltx_ref ltx_href">TRUST: an accurate and
end-to-end table structure recognizer using splitting-based transformers</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2208.14687.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2023)</span>
<span class="ltx_bibblock">
Yongshuai Huang, Ning Lu, Dapeng Chen, Yibo Li, Zecheng Xie, Shenggao Zhu,
Liangcai Gao, and Wei Peng. 2023.

</span>
<span class="ltx_bibblock">Improving table structure recognition with visual-alignment
sequential coordinate modeling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, pages 11134–11143.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hurst (2003)</span>
<span class="ltx_bibblock">
Matthew Hurst. 2003.

</span>
<span class="ltx_bibblock">A constraint-based approach to table structure derivation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">ICDAR</em>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kendall et al. (2018)</span>
<span class="ltx_bibblock">
Alex Kendall, Yarin Gal, and Roberto Cipolla. 2018.

</span>
<span class="ltx_bibblock">Multi-task learning using uncertainty to weigh losses for scene
geometry and semantics.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2022)</span>
<span class="ltx_bibblock">
Geewook Kim, Teakgyu Hong, Moonbin Yim, JeongYeon Nam, Jinyoung Park, Jinyeong
Yim, Wonseok Hwang, Sangdoo Yun, Dongyoon Han, and Seunghyun Park. 2022.

</span>
<span class="ltx_bibblock">Ocr-free document understanding transformer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, volume 13688, pages 498–517.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2015)</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Jimmy Ba. 2015.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">ICLR</em>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2023)</span>
<span class="ltx_bibblock">
Kenton Lee, Mandar Joshi, Iulia Raluca Turc, Hexiang Hu, Fangyu Liu,
Julian Martin Eisenschlos, Urvashi Khandelwal, Peter Shaw, Ming-Wei Chang,
and Kristina Toutanova. 2023.

</span>
<span class="ltx_bibblock">Pix2struct: Screenshot parsing as pretraining for visual language
understanding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">ICML</em>, volume 202, pages 18893–18912.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2020)</span>
<span class="ltx_bibblock">
Mike Lewis, Yinhan Liu, Naman Goyal, Marjan Ghazvininejad, Abdelrahman Mohamed,
Omer Levy, Veselin Stoyanov, and Luke Zettlemoyer. 2020.

</span>
<span class="ltx_bibblock">BART: denoising sequence-to-sequence pre-training for natural
language generation, translation, and comprehension.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">ACL</em>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2017)</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Priya Goyal, Ross B. Girshick, Kaiming He, and Piotr
Dollár. 2017.

</span>
<span class="ltx_bibblock">Focal loss for dense object detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">ICCV</em>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2022)</span>
<span class="ltx_bibblock">
Weihong Lin, Zheng Sun, Chixiang Ma, Mingze Li, Jiawei Wang, Lei Sun, and Qiang
Huo. 2022.

</span>
<span class="ltx_bibblock">Tsrformer: Table structure recognition with transformers.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">ACM MM</em>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2022)</span>
<span class="ltx_bibblock">
Hao Liu, Xin Li, Bing Liu, Deqiang Jiang, Yinsong Liu, and Bo Ren. 2022.

</span>
<span class="ltx_bibblock">Neural collaborative graph machines for table structure recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Ze Liu, Yutong Lin, Yue Cao, Han Hu, Yixuan Wei, Zheng Zhang, Stephen Lin, and
Baining Guo. 2021.

</span>
<span class="ltx_bibblock">Swin transformer: Hierarchical vision transformer using shifted
windows.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">ICCV</em>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Long et al. (2015)</span>
<span class="ltx_bibblock">
Jonathan Long, Evan Shelhamer, and Trevor Darrell. 2015.

</span>
<span class="ltx_bibblock">Fully convolutional networks for semantic segmentation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Long et al. (2021)</span>
<span class="ltx_bibblock">
Rujiao Long, Wen Wang, Nan Xue, Feiyu Gao, Zhibo Yang, Yongpan Wang, and
Gui-Song Xia. 2021.

</span>
<span class="ltx_bibblock">Parsing table structures in the wild.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">ICCV</em>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2023)</span>
<span class="ltx_bibblock">
Chixiang Ma, Weihong Lin, Lei Sun, and Qiang Huo. 2023.

</span>
<span class="ltx_bibblock">Robust table detection and structure recognition from heterogeneous
document images.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Pattern Recognition</em>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nassar et al. (2022)</span>
<span class="ltx_bibblock">
Ahmed Nassar, Nikolaos Livathinos, Maksym Lysak, and Peter Staar. 2022.

</span>
<span class="ltx_bibblock">Tableformer: Table structure understanding with transformers.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI. 2023.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://arxiv.org/abs/2303.08774" title="" class="ltx_ref ltx_href">GPT-4 technical report</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">CoRR</em>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2022)</span>
<span class="ltx_bibblock">
Qiming Peng, Yinxu Pan, Wenjin Wang, Bin Luo, Zhenyu Zhang, Zhengjie Huang,
Yuhui Cao, Weichong Yin, Yongfeng Chen, Yin Zhang, Shikun Feng, Yu Sun, Hao
Tian, Hua Wu, and Haifeng Wang. 2022.

</span>
<span class="ltx_bibblock">Ernie-layout: Layout knowledge enhanced pre-training for
visually-rich document understanding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Findings of the Association for Computational Linguistics:
EMNLP 2022</em>, pages 3744–3756.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiao et al. (2021)</span>
<span class="ltx_bibblock">
Liang Qiao, Zaisheng Li, Zhanzhan Cheng, Peng Zhang, Shiliang Pu, Yi Niu, Wenqi
Ren, Wenming Tan, and Fei Wu. 2021.

</span>
<span class="ltx_bibblock">Lgpma: Complicated table structure recognition with local and global
pyramid mask alignment.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">ICDAR</em>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al. (2024)</span>
<span class="ltx_bibblock">
Chunxia Qin, Zhenrong Zhang, Pengfei Hu, Chenyu Liu, Jiefeng Ma, and Jun Du.
2024.

</span>
<span class="ltx_bibblock">Semv3: A fast and robust approach to table separation line detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2405.11862</em>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raja et al. (2020)</span>
<span class="ltx_bibblock">
Sachin Raja, Ajoy Mondal, and C. V. Jawahar. 2020.

</span>
<span class="ltx_bibblock">Table structure recognition using top-down and bottom-up cues.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schreiber et al. (2017)</span>
<span class="ltx_bibblock">
Sebastian Schreiber, Stefan Agne, Ivo Wolf, Andreas Dengel, and Sheraz Ahmed.
2017.

</span>
<span class="ltx_bibblock">Deepdesrt: Deep learning for detection and structure recognition of
tables in document images.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">ICDAR</em>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Siddiqui et al. (2018)</span>
<span class="ltx_bibblock">
Shoaib Ahmed Siddiqui, Muhammad Imran Malik, Stefan Agne, Andreas Dengel, and
Sheraz Ahmed. 2018.

</span>
<span class="ltx_bibblock">Decnt: deep deformable cnn for table detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smock et al. (2022)</span>
<span class="ltx_bibblock">
Brandon Smock, Rohith Pesala, and Robin Abraham. 2022.

</span>
<span class="ltx_bibblock">Pubtables-1m: Towards comprehensive table extraction from
unstructured documents.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smock et al. (2023)</span>
<span class="ltx_bibblock">
Brandon Smock, Rohith Pesala, and Robin Abraham. 2023.

</span>
<span class="ltx_bibblock">Grits: Grid table similarity metric for table structure recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">ICDAR</em>, volume 14191, pages 535–549. Springer.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tensmeyer et al. (2019)</span>
<span class="ltx_bibblock">
Chris Tensmeyer, Vlad I. Morariu, Brian Price, Scott Cohen, and Tony Martinez.
2019.

</span>
<span class="ltx_bibblock">Deep splitting and merging for table structure decomposition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">ICDAR</em>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">NIPS</em>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023)</span>
<span class="ltx_bibblock">
Jiawei Wang, Weihong Lin, Chixiang Ma, Mingze Li, Zheng Sun, Lei Sun, and Qiang
Huo. 2023.

</span>
<span class="ltx_bibblock">Robust table structure recognition with dynamic queries enhanced
detection transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Pattern Recognition</em>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xing et al. (2023)</span>
<span class="ltx_bibblock">
Hangdi Xing, Feiyu Gao, Rujiao Long, Jiajun Bu, Qi Zheng, Liangcheng Li, Cong
Yao, and Zhi Yu. 2023.

</span>
<span class="ltx_bibblock">LORE: logical location regression network for table structure
recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">AAAI</em>, pages 2992–3000.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xue et al. (2019)</span>
<span class="ltx_bibblock">
Wenyuan Xue, Qingyong Li, and Dacheng Tao. 2019.

</span>
<span class="ltx_bibblock">Res2tim: Reconstruct syntactic structures from table images.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">ICDAR</em>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zanibbi et al. (2004)</span>
<span class="ltx_bibblock">
Richard Zanibbi, Dorothea Blostein, and R. Cordy. 2004.

</span>
<span class="ltx_bibblock">A survey of table recognition: models, observations, transformations,
and inferences.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">IJDAR</em>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Zhenrong Zhang, Pengfei Hu, Jiefeng Ma, Jun Du, Jianshu Zhang, Baocai Yin, Bing
Yin, and Cong Liu. 2024.

</span>
<span class="ltx_bibblock">Semv2: Table separation line detection based on instance
segmentation.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Pattern Recognition</em>, 149:110279.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Zhenrong Zhang, Jianshu Zhang, Jun Du, and Fengren Wang. 2022.

</span>
<span class="ltx_bibblock">Split, embed and merge: An accurate table structure recognizer.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Pattern Recognition</em>.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. (2020a)</span>
<span class="ltx_bibblock">
Xu Zhong, Elaheh ShafieiBavani, and Antonio Jimeno Yepes. 2020a.

</span>
<span class="ltx_bibblock">Image-based table recognition: Data, model, and evaluation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">ECCV</em>.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. (2020b)</span>
<span class="ltx_bibblock">
Xu Zhong, Elaheh ShafieiBavani, and Antonio Jimeno Yepes. 2020b.

</span>
<span class="ltx_bibblock">Image-based table recognition: Data, model, and evaluation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">ECCV</em>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Datasets and Evaluation Metrics</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.1" class="ltx_p">As shown in Table <a href="#A1.T4" title="Table 4 ‣ A.1 Datasets and Evaluation Metrics ‣ Appendix A Appendix ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we summarize the datasets used during our experiments, along with the evaluation metrics employed to assess our model’s performance on each dataset. We will detail each of these in the subsequent sections.</p>
</div>
<div id="A1.SS1.p2" class="ltx_para ltx_noindent">
<p id="A1.SS1.p2.5" class="ltx_p"><span id="A1.SS1.p2.5.1" class="ltx_text ltx_font_bold">PubTabNet.</span> PubTabNet is a large-scale table recognition dataset. PubTabNet annotates each table image with information about both the structure of table and the text content with position of each non-empty table cell. All tables are also axis-aligned and collected from scientific articles. The authors also proposed a new Tree-Edit-Distance-based Similarity (TEDS) metric for table recognition task, which can identify both table structure recognition and OCR errors. TEDS measures the similarity of the tree structure of tables.
While using the TEDS metric, we need to present tables as a tree structure in the HTML format.
Finally, TEDS between two trees is computed as:</p>
<table id="A1.EGx17" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E17.m1.7" class="ltx_Math" alttext="\displaystyle\text{TEDS}(T_{a},T_{b})=1-\frac{\text{EditDist}(T_{a},T_{b})}{\max(\lvert T_{a}\rvert,\lvert T_{b}\rvert)}" display="inline"><semantics id="A1.E17.m1.7a"><mrow id="A1.E17.m1.7.7" xref="A1.E17.m1.7.7.cmml"><mrow id="A1.E17.m1.7.7.2" xref="A1.E17.m1.7.7.2.cmml"><mtext id="A1.E17.m1.7.7.2.4" xref="A1.E17.m1.7.7.2.4a.cmml">TEDS</mtext><mo lspace="0em" rspace="0em" id="A1.E17.m1.7.7.2.3" xref="A1.E17.m1.7.7.2.3.cmml">​</mo><mrow id="A1.E17.m1.7.7.2.2.2" xref="A1.E17.m1.7.7.2.2.3.cmml"><mo stretchy="false" id="A1.E17.m1.7.7.2.2.2.3" xref="A1.E17.m1.7.7.2.2.3.cmml">(</mo><msub id="A1.E17.m1.6.6.1.1.1.1" xref="A1.E17.m1.6.6.1.1.1.1.cmml"><mi id="A1.E17.m1.6.6.1.1.1.1.2" xref="A1.E17.m1.6.6.1.1.1.1.2.cmml">T</mi><mi id="A1.E17.m1.6.6.1.1.1.1.3" xref="A1.E17.m1.6.6.1.1.1.1.3.cmml">a</mi></msub><mo id="A1.E17.m1.7.7.2.2.2.4" xref="A1.E17.m1.7.7.2.2.3.cmml">,</mo><msub id="A1.E17.m1.7.7.2.2.2.2" xref="A1.E17.m1.7.7.2.2.2.2.cmml"><mi id="A1.E17.m1.7.7.2.2.2.2.2" xref="A1.E17.m1.7.7.2.2.2.2.2.cmml">T</mi><mi id="A1.E17.m1.7.7.2.2.2.2.3" xref="A1.E17.m1.7.7.2.2.2.2.3.cmml">b</mi></msub><mo stretchy="false" id="A1.E17.m1.7.7.2.2.2.5" xref="A1.E17.m1.7.7.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E17.m1.7.7.3" xref="A1.E17.m1.7.7.3.cmml">=</mo><mrow id="A1.E17.m1.7.7.4" xref="A1.E17.m1.7.7.4.cmml"><mn id="A1.E17.m1.7.7.4.2" xref="A1.E17.m1.7.7.4.2.cmml">1</mn><mo id="A1.E17.m1.7.7.4.1" xref="A1.E17.m1.7.7.4.1.cmml">−</mo><mstyle displaystyle="true" id="A1.E17.m1.5.5" xref="A1.E17.m1.5.5.cmml"><mfrac id="A1.E17.m1.5.5a" xref="A1.E17.m1.5.5.cmml"><mrow id="A1.E17.m1.2.2.2" xref="A1.E17.m1.2.2.2.cmml"><mtext id="A1.E17.m1.2.2.2.4" xref="A1.E17.m1.2.2.2.4a.cmml">EditDist</mtext><mo lspace="0em" rspace="0em" id="A1.E17.m1.2.2.2.3" xref="A1.E17.m1.2.2.2.3.cmml">​</mo><mrow id="A1.E17.m1.2.2.2.2.2" xref="A1.E17.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.E17.m1.2.2.2.2.2.3" xref="A1.E17.m1.2.2.2.2.3.cmml">(</mo><msub id="A1.E17.m1.1.1.1.1.1.1" xref="A1.E17.m1.1.1.1.1.1.1.cmml"><mi id="A1.E17.m1.1.1.1.1.1.1.2" xref="A1.E17.m1.1.1.1.1.1.1.2.cmml">T</mi><mi id="A1.E17.m1.1.1.1.1.1.1.3" xref="A1.E17.m1.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="A1.E17.m1.2.2.2.2.2.4" xref="A1.E17.m1.2.2.2.2.3.cmml">,</mo><msub id="A1.E17.m1.2.2.2.2.2.2" xref="A1.E17.m1.2.2.2.2.2.2.cmml"><mi id="A1.E17.m1.2.2.2.2.2.2.2" xref="A1.E17.m1.2.2.2.2.2.2.2.cmml">T</mi><mi id="A1.E17.m1.2.2.2.2.2.2.3" xref="A1.E17.m1.2.2.2.2.2.2.3.cmml">b</mi></msub><mo stretchy="false" id="A1.E17.m1.2.2.2.2.2.5" xref="A1.E17.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="A1.E17.m1.5.5.5.3" xref="A1.E17.m1.5.5.5.4.cmml"><mi id="A1.E17.m1.3.3.3.1" xref="A1.E17.m1.3.3.3.1.cmml">max</mi><mo id="A1.E17.m1.5.5.5.3a" xref="A1.E17.m1.5.5.5.4.cmml">⁡</mo><mrow id="A1.E17.m1.5.5.5.3.2" xref="A1.E17.m1.5.5.5.4.cmml"><mo stretchy="false" id="A1.E17.m1.5.5.5.3.2.3" xref="A1.E17.m1.5.5.5.4.cmml">(</mo><mrow id="A1.E17.m1.4.4.4.2.1.1.1" xref="A1.E17.m1.4.4.4.2.1.1.2.cmml"><mo stretchy="false" id="A1.E17.m1.4.4.4.2.1.1.1.2" xref="A1.E17.m1.4.4.4.2.1.1.2.1.cmml">|</mo><msub id="A1.E17.m1.4.4.4.2.1.1.1.1" xref="A1.E17.m1.4.4.4.2.1.1.1.1.cmml"><mi id="A1.E17.m1.4.4.4.2.1.1.1.1.2" xref="A1.E17.m1.4.4.4.2.1.1.1.1.2.cmml">T</mi><mi id="A1.E17.m1.4.4.4.2.1.1.1.1.3" xref="A1.E17.m1.4.4.4.2.1.1.1.1.3.cmml">a</mi></msub><mo stretchy="false" id="A1.E17.m1.4.4.4.2.1.1.1.3" xref="A1.E17.m1.4.4.4.2.1.1.2.1.cmml">|</mo></mrow><mo id="A1.E17.m1.5.5.5.3.2.4" xref="A1.E17.m1.5.5.5.4.cmml">,</mo><mrow id="A1.E17.m1.5.5.5.3.2.2.1" xref="A1.E17.m1.5.5.5.3.2.2.2.cmml"><mo stretchy="false" id="A1.E17.m1.5.5.5.3.2.2.1.2" xref="A1.E17.m1.5.5.5.3.2.2.2.1.cmml">|</mo><msub id="A1.E17.m1.5.5.5.3.2.2.1.1" xref="A1.E17.m1.5.5.5.3.2.2.1.1.cmml"><mi id="A1.E17.m1.5.5.5.3.2.2.1.1.2" xref="A1.E17.m1.5.5.5.3.2.2.1.1.2.cmml">T</mi><mi id="A1.E17.m1.5.5.5.3.2.2.1.1.3" xref="A1.E17.m1.5.5.5.3.2.2.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="A1.E17.m1.5.5.5.3.2.2.1.3" xref="A1.E17.m1.5.5.5.3.2.2.2.1.cmml">|</mo></mrow><mo stretchy="false" id="A1.E17.m1.5.5.5.3.2.5" xref="A1.E17.m1.5.5.5.4.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E17.m1.7b"><apply id="A1.E17.m1.7.7.cmml" xref="A1.E17.m1.7.7"><eq id="A1.E17.m1.7.7.3.cmml" xref="A1.E17.m1.7.7.3"></eq><apply id="A1.E17.m1.7.7.2.cmml" xref="A1.E17.m1.7.7.2"><times id="A1.E17.m1.7.7.2.3.cmml" xref="A1.E17.m1.7.7.2.3"></times><ci id="A1.E17.m1.7.7.2.4a.cmml" xref="A1.E17.m1.7.7.2.4"><mtext id="A1.E17.m1.7.7.2.4.cmml" xref="A1.E17.m1.7.7.2.4">TEDS</mtext></ci><interval closure="open" id="A1.E17.m1.7.7.2.2.3.cmml" xref="A1.E17.m1.7.7.2.2.2"><apply id="A1.E17.m1.6.6.1.1.1.1.cmml" xref="A1.E17.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.6.6.1.1.1.1.1.cmml" xref="A1.E17.m1.6.6.1.1.1.1">subscript</csymbol><ci id="A1.E17.m1.6.6.1.1.1.1.2.cmml" xref="A1.E17.m1.6.6.1.1.1.1.2">𝑇</ci><ci id="A1.E17.m1.6.6.1.1.1.1.3.cmml" xref="A1.E17.m1.6.6.1.1.1.1.3">𝑎</ci></apply><apply id="A1.E17.m1.7.7.2.2.2.2.cmml" xref="A1.E17.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.7.7.2.2.2.2.1.cmml" xref="A1.E17.m1.7.7.2.2.2.2">subscript</csymbol><ci id="A1.E17.m1.7.7.2.2.2.2.2.cmml" xref="A1.E17.m1.7.7.2.2.2.2.2">𝑇</ci><ci id="A1.E17.m1.7.7.2.2.2.2.3.cmml" xref="A1.E17.m1.7.7.2.2.2.2.3">𝑏</ci></apply></interval></apply><apply id="A1.E17.m1.7.7.4.cmml" xref="A1.E17.m1.7.7.4"><minus id="A1.E17.m1.7.7.4.1.cmml" xref="A1.E17.m1.7.7.4.1"></minus><cn type="integer" id="A1.E17.m1.7.7.4.2.cmml" xref="A1.E17.m1.7.7.4.2">1</cn><apply id="A1.E17.m1.5.5.cmml" xref="A1.E17.m1.5.5"><divide id="A1.E17.m1.5.5.6.cmml" xref="A1.E17.m1.5.5"></divide><apply id="A1.E17.m1.2.2.2.cmml" xref="A1.E17.m1.2.2.2"><times id="A1.E17.m1.2.2.2.3.cmml" xref="A1.E17.m1.2.2.2.3"></times><ci id="A1.E17.m1.2.2.2.4a.cmml" xref="A1.E17.m1.2.2.2.4"><mtext id="A1.E17.m1.2.2.2.4.cmml" xref="A1.E17.m1.2.2.2.4">EditDist</mtext></ci><interval closure="open" id="A1.E17.m1.2.2.2.2.3.cmml" xref="A1.E17.m1.2.2.2.2.2"><apply id="A1.E17.m1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.1.1.1.1.1.1.1.cmml" xref="A1.E17.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E17.m1.1.1.1.1.1.1.2.cmml" xref="A1.E17.m1.1.1.1.1.1.1.2">𝑇</ci><ci id="A1.E17.m1.1.1.1.1.1.1.3.cmml" xref="A1.E17.m1.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="A1.E17.m1.2.2.2.2.2.2.cmml" xref="A1.E17.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E17.m1.2.2.2.2.2.2.1.cmml" xref="A1.E17.m1.2.2.2.2.2.2">subscript</csymbol><ci id="A1.E17.m1.2.2.2.2.2.2.2.cmml" xref="A1.E17.m1.2.2.2.2.2.2.2">𝑇</ci><ci id="A1.E17.m1.2.2.2.2.2.2.3.cmml" xref="A1.E17.m1.2.2.2.2.2.2.3">𝑏</ci></apply></interval></apply><apply id="A1.E17.m1.5.5.5.4.cmml" xref="A1.E17.m1.5.5.5.3"><max id="A1.E17.m1.3.3.3.1.cmml" xref="A1.E17.m1.3.3.3.1"></max><apply id="A1.E17.m1.4.4.4.2.1.1.2.cmml" xref="A1.E17.m1.4.4.4.2.1.1.1"><abs id="A1.E17.m1.4.4.4.2.1.1.2.1.cmml" xref="A1.E17.m1.4.4.4.2.1.1.1.2"></abs><apply id="A1.E17.m1.4.4.4.2.1.1.1.1.cmml" xref="A1.E17.m1.4.4.4.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.4.4.4.2.1.1.1.1.1.cmml" xref="A1.E17.m1.4.4.4.2.1.1.1.1">subscript</csymbol><ci id="A1.E17.m1.4.4.4.2.1.1.1.1.2.cmml" xref="A1.E17.m1.4.4.4.2.1.1.1.1.2">𝑇</ci><ci id="A1.E17.m1.4.4.4.2.1.1.1.1.3.cmml" xref="A1.E17.m1.4.4.4.2.1.1.1.1.3">𝑎</ci></apply></apply><apply id="A1.E17.m1.5.5.5.3.2.2.2.cmml" xref="A1.E17.m1.5.5.5.3.2.2.1"><abs id="A1.E17.m1.5.5.5.3.2.2.2.1.cmml" xref="A1.E17.m1.5.5.5.3.2.2.1.2"></abs><apply id="A1.E17.m1.5.5.5.3.2.2.1.1.cmml" xref="A1.E17.m1.5.5.5.3.2.2.1.1"><csymbol cd="ambiguous" id="A1.E17.m1.5.5.5.3.2.2.1.1.1.cmml" xref="A1.E17.m1.5.5.5.3.2.2.1.1">subscript</csymbol><ci id="A1.E17.m1.5.5.5.3.2.2.1.1.2.cmml" xref="A1.E17.m1.5.5.5.3.2.2.1.1.2">𝑇</ci><ci id="A1.E17.m1.5.5.5.3.2.2.1.1.3.cmml" xref="A1.E17.m1.5.5.5.3.2.2.1.1.3">𝑏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E17.m1.7c">\displaystyle\text{TEDS}(T_{a},T_{b})=1-\frac{\text{EditDist}(T_{a},T_{b})}{\max(\lvert T_{a}\rvert,\lvert T_{b}\rvert)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="A1.SS1.p2.4" class="ltx_p">where <math id="A1.SS1.p2.1.m1.1" class="ltx_Math" alttext="T_{a}" display="inline"><semantics id="A1.SS1.p2.1.m1.1a"><msub id="A1.SS1.p2.1.m1.1.1" xref="A1.SS1.p2.1.m1.1.1.cmml"><mi id="A1.SS1.p2.1.m1.1.1.2" xref="A1.SS1.p2.1.m1.1.1.2.cmml">T</mi><mi id="A1.SS1.p2.1.m1.1.1.3" xref="A1.SS1.p2.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.1b"><apply id="A1.SS1.p2.1.m1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p2.1.m1.1.1.2.cmml" xref="A1.SS1.p2.1.m1.1.1.2">𝑇</ci><ci id="A1.SS1.p2.1.m1.1.1.3.cmml" xref="A1.SS1.p2.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.1c">T_{a}</annotation></semantics></math> and <math id="A1.SS1.p2.2.m2.1" class="ltx_Math" alttext="T_{b}" display="inline"><semantics id="A1.SS1.p2.2.m2.1a"><msub id="A1.SS1.p2.2.m2.1.1" xref="A1.SS1.p2.2.m2.1.1.cmml"><mi id="A1.SS1.p2.2.m2.1.1.2" xref="A1.SS1.p2.2.m2.1.1.2.cmml">T</mi><mi id="A1.SS1.p2.2.m2.1.1.3" xref="A1.SS1.p2.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.2.m2.1b"><apply id="A1.SS1.p2.2.m2.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.2.m2.1.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p2.2.m2.1.1.2.cmml" xref="A1.SS1.p2.2.m2.1.1.2">𝑇</ci><ci id="A1.SS1.p2.2.m2.1.1.3.cmml" xref="A1.SS1.p2.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.2.m2.1c">T_{b}</annotation></semantics></math> are the tree structure of tables in the HTML formats.
EditDist represents the tree-edit distance, and <math id="A1.SS1.p2.3.m3.1" class="ltx_Math" alttext="\lvert T\rvert" display="inline"><semantics id="A1.SS1.p2.3.m3.1a"><mrow id="A1.SS1.p2.3.m3.1.2.2" xref="A1.SS1.p2.3.m3.1.2.1.cmml"><mo stretchy="false" id="A1.SS1.p2.3.m3.1.2.2.1" xref="A1.SS1.p2.3.m3.1.2.1.1.cmml">|</mo><mi id="A1.SS1.p2.3.m3.1.1" xref="A1.SS1.p2.3.m3.1.1.cmml">T</mi><mo stretchy="false" id="A1.SS1.p2.3.m3.1.2.2.2" xref="A1.SS1.p2.3.m3.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.3.m3.1b"><apply id="A1.SS1.p2.3.m3.1.2.1.cmml" xref="A1.SS1.p2.3.m3.1.2.2"><abs id="A1.SS1.p2.3.m3.1.2.1.1.cmml" xref="A1.SS1.p2.3.m3.1.2.2.1"></abs><ci id="A1.SS1.p2.3.m3.1.1.cmml" xref="A1.SS1.p2.3.m3.1.1">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.3.m3.1c">\lvert T\rvert</annotation></semantics></math> is the number of nodes in <math id="A1.SS1.p2.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A1.SS1.p2.4.m4.1a"><mi id="A1.SS1.p2.4.m4.1.1" xref="A1.SS1.p2.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.4.m4.1b"><ci id="A1.SS1.p2.4.m4.1.1.cmml" xref="A1.SS1.p2.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.4.m4.1c">T</annotation></semantics></math>. Since taking OCR errors into account may lead to an unfair comparison due to the different OCR models used by various TSR methods, we also employ a modified version of TEDS, called TEDS-Struct. The TEDS-Struct assesses the accuracy of table structure recognition, while disregarding the specific outcomes generated by OCR.</p>
</div>
<figure id="A1.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>The overview of datasets and respective metrics.</figcaption>
<table id="A1.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T4.1.1.1" class="ltx_tr">
<th id="A1.T4.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_th_row ltx_border_tt">
<span id="A1.T4.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.T4.1.1.1.1.1.1" class="ltx_p" style="width:85.4pt;">Datasets</span>
</span>
</th>
<th id="A1.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">Digital</th>
<th id="A1.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">Camera-captured</th>
<th id="A1.T4.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Num</th>
<th id="A1.T4.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Metric</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T4.1.2.1" class="ltx_tr">
<th id="A1.T4.1.2.1.1" class="ltx_td ltx_align_top ltx_th ltx_th_row"></th>
<th id="A1.T4.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Wired</th>
<th id="A1.T4.1.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Wireless</th>
<th id="A1.T4.1.2.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Wired</th>
<th id="A1.T4.1.2.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Wireless</th>
<th id="A1.T4.1.2.1.6" class="ltx_td ltx_th ltx_th_column"></th>
<td id="A1.T4.1.2.1.7" class="ltx_td"></td>
</tr>
<tr id="A1.T4.1.3.2" class="ltx_tr">
<th id="A1.T4.1.3.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t">
<span id="A1.T4.1.3.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.T4.1.3.2.1.1.1" class="ltx_p" style="width:85.4pt;">PubTabNet <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al., <a href="#bib.bib39" title="" class="ltx_ref">2020b</a>)</cite></span>
</span>
</th>
<td id="A1.T4.1.3.2.2" class="ltx_td ltx_align_center ltx_border_t">✓</td>
<td id="A1.T4.1.3.2.3" class="ltx_td ltx_align_center ltx_border_t">✓</td>
<td id="A1.T4.1.3.2.4" class="ltx_td ltx_align_center ltx_border_t">✗</td>
<td id="A1.T4.1.3.2.5" class="ltx_td ltx_align_center ltx_border_t">✗</td>
<td id="A1.T4.1.3.2.6" class="ltx_td ltx_align_center ltx_border_t">568,000</td>
<td id="A1.T4.1.3.2.7" class="ltx_td ltx_align_center ltx_border_t">TEDS-Struct</td>
</tr>
<tr id="A1.T4.1.4.3" class="ltx_tr">
<th id="A1.T4.1.4.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="A1.T4.1.4.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.T4.1.4.3.1.1.1" class="ltx_p" style="width:85.4pt;">PubTables1M <cite class="ltx_cite ltx_citemacro_citep">(Smock et al., <a href="#bib.bib28" title="" class="ltx_ref">2022</a>)</cite></span>
</span>
</th>
<td id="A1.T4.1.4.3.2" class="ltx_td ltx_align_center">✓</td>
<td id="A1.T4.1.4.3.3" class="ltx_td ltx_align_center">✓</td>
<td id="A1.T4.1.4.3.4" class="ltx_td ltx_align_center">✗</td>
<td id="A1.T4.1.4.3.5" class="ltx_td ltx_align_center">✗</td>
<td id="A1.T4.1.4.3.6" class="ltx_td ltx_align_center">948,000</td>
<td id="A1.T4.1.4.3.7" class="ltx_td ltx_align_center">GriTS</td>
</tr>
<tr id="A1.T4.1.5.4" class="ltx_tr">
<th id="A1.T4.1.5.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="A1.T4.1.5.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.T4.1.5.4.1.1.1" class="ltx_p" style="width:85.4pt;">WTW <cite class="ltx_cite ltx_citemacro_citep">(Long et al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite></span>
</span>
</th>
<td id="A1.T4.1.5.4.2" class="ltx_td ltx_align_center">✓</td>
<td id="A1.T4.1.5.4.3" class="ltx_td ltx_align_center">✗</td>
<td id="A1.T4.1.5.4.4" class="ltx_td ltx_align_center">✓</td>
<td id="A1.T4.1.5.4.5" class="ltx_td ltx_align_center">✗</td>
<td id="A1.T4.1.5.4.6" class="ltx_td ltx_align_center">14,581</td>
<td id="A1.T4.1.5.4.7" class="ltx_td ltx_align_center">F1-Measure</td>
</tr>
<tr id="A1.T4.1.6.5" class="ltx_tr">
<th id="A1.T4.1.6.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row">
<span id="A1.T4.1.6.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.T4.1.6.5.1.1.1" class="ltx_p" style="width:85.4pt;">iFLYTAB <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib36" title="" class="ltx_ref">2024</a>)</cite></span>
</span>
</th>
<td id="A1.T4.1.6.5.2" class="ltx_td ltx_align_center">✓</td>
<td id="A1.T4.1.6.5.3" class="ltx_td ltx_align_center">✓</td>
<td id="A1.T4.1.6.5.4" class="ltx_td ltx_align_center">✓</td>
<td id="A1.T4.1.6.5.5" class="ltx_td ltx_align_center">✓</td>
<td id="A1.T4.1.6.5.6" class="ltx_td ltx_align_center">17,291</td>
<td id="A1.T4.1.6.5.7" class="ltx_td ltx_align_center">TEDS-Struct</td>
</tr>
<tr id="A1.T4.1.7.6" class="ltx_tr">
<th id="A1.T4.1.7.6.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_bb">
<span id="A1.T4.1.7.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="A1.T4.1.7.6.1.1.1" class="ltx_p" style="width:85.4pt;">iFLYTAB-DP</span>
</span>
</th>
<td id="A1.T4.1.7.6.2" class="ltx_td ltx_align_center ltx_border_bb">✗</td>
<td id="A1.T4.1.7.6.3" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="A1.T4.1.7.6.4" class="ltx_td ltx_align_center ltx_border_bb">✗</td>
<td id="A1.T4.1.7.6.5" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="A1.T4.1.7.6.6" class="ltx_td ltx_align_center ltx_border_bb">322</td>
<td id="A1.T4.1.7.6.7" class="ltx_td ltx_align_center ltx_border_bb">TEDS-Struct</td>
</tr>
</tbody>
</table>
</figure>
<figure id="A1.F6" class="ltx_figure"><img src="/html/2409.13148/assets/01_app_iflytab_db.png" id="A1.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="238" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Some examples of the iFLYTAB-DP dataset.</figcaption>
</figure>
<figure id="A1.F7" class="ltx_figure"><img src="/html/2409.13148/assets/02_app_lowrecall.png" id="A1.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="129" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>The illustration of the maximum decoding length limitation in UniTabNet. The samples are from the WTW dataset. The “PT” label in the top right corner of the image denotes the predicted results by UniTabNet, while “GT” indicates the ground truth structure of the table. Areas missed by the model due to the maximum decoding length limitation are highlighted with red dashed boxes.</figcaption>
</figure>
<figure id="A1.F8" class="ltx_figure"><img src="/html/2409.13148/assets/03_app_row_column.png" id="A1.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="129" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>The illustration of row and column information learned by the Vision Guider. Panel (a) is from the PubTables1M dataset, and (b) is from the iFLYTAB dataset. The red dashed boxes highlight the area of the table cell currently being decoded. The green mask indicates the row and column information of the table cell as predicted by UniTabNet.</figcaption>
</figure>
<figure id="A1.F9" class="ltx_figure"><img src="/html/2409.13148/assets/04_app_results.png" id="A1.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="306" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>The prediction results of UniTabNet across different datasets. The blue boxes in the images represent the cell polygons decoded by UniTabNet. Panels (a) to (c) show predictions for the PubTabNet dataset, (d) to (f) for the PubTables1M dataset, (g) to (i) for the WTW dataset, and (j) to (l) for the iFLYTAB dataset.</figcaption>
</figure>
<div id="A1.SS1.p3" class="ltx_para ltx_noindent">
<p id="A1.SS1.p3.1" class="ltx_p"><span id="A1.SS1.p3.1.1" class="ltx_text ltx_font_bold">PubTables1M.</span> Both the PubTables1M and PubTabNet datasets are sourced from the PubMed Central Open Access (PMCOA) database. The primary distinction between the two lies in the richness of annotation provided by PubTables1M. This dataset includes detailed annotations for projected row headers and bounding boxes for all rows, columns, and cells, encompassing even the blank cells. Additionally, it introduces a novel canonicalization procedure aimed at correcting oversegmentation. The purpose of this procedure is to ensure that each table is presented with a unique and unambiguous structural interpretation. To contrast our method with others, we evaluated it using the GriTS metric on this dataset. The recently proposed GriTS metric <cite class="ltx_cite ltx_citemacro_citep">(Smock et al., <a href="#bib.bib29" title="" class="ltx_ref">2023</a>)</cite> directly compares predicted tables with the ground truth in matrix form and can be interpreted as an F-score reflecting the accuracy of predicted cells. Exact match accuracy is assessed by the percentage of tables for which all cells, including blank cells, are perfectly matched.</p>
</div>
<div id="A1.SS1.p4" class="ltx_para ltx_noindent">
<p id="A1.SS1.p4.1" class="ltx_p"><span id="A1.SS1.p4.1.1" class="ltx_text ltx_font_bold">WTW.</span> WTW dataset comprises 10,970 training images and 3,611 testing images, collected from wild and complex scenes. This dataset is specifically tailored to wired tabular objects and provides annotated information including tabular cell coordinates, and row/column data. We utilize the F1-Measure to evaluate our method on this dataset. To apply the F1-Measure, it is essential to detect the adjacency relationships among the table cells. The F1-Measure calculates the percentage of correctly detected pairs of adjacent cells, where both cells are accurately segmented and identified as neighbors. When evaluating on the WTW dataset, we employ the cell adjacency relationship metric <cite class="ltx_cite ltx_citemacro_cite">Göbel et al. (<a href="#bib.bib4" title="" class="ltx_ref">2012</a>)</cite>, a variant of the F1-Measure. This metric aligns a ground truth cell with a predicted cell based on the Intersection over Union (IoU) criterion. For our assessments, we set the IoU threshold at 0.6.</p>
</div>
<div id="A1.SS1.p5" class="ltx_para ltx_noindent">
<p id="A1.SS1.p5.1" class="ltx_p"><span id="A1.SS1.p5.1.1" class="ltx_text ltx_font_bold">iFLYTAB.</span>
The iFLYTAB dataset comprises 12,104 training samples and 5,187 testing samples. It offers comprehensive annotations for each table image, including physical coordinates and structural information. This dataset not only includes axis-aligned digital documents but also images captured by cameras, which present more challenges due to complex backgrounds and non-rigid image deformations. For evaluating our method on this dataset, we employ the official TEDS-Struct metric<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">*</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">*</sup><span class="ltx_tag ltx_tag_note">*</span><a target="_blank" href="https://github.com/ZZR8066/SEMv2" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/ZZR8066/SEMv2</a></span></span></span>. Specifically, during the evaluation process on iFLYTAB, we assign a distinctive marker to each text line, which signifies its individual content.</p>
</div>
<div id="A1.SS1.p6" class="ltx_para ltx_noindent">
<p id="A1.SS1.p6.1" class="ltx_p"><span id="A1.SS1.p6.1.1" class="ltx_text ltx_font_bold">iFLYTAB-DP.</span> To more precisely evaluate our model’s performance on descriptive table images, we select 322 images from the iFLYTAB validation dataset, as shown in Figure <a href="#A1.F6" title="Figure 6 ‣ A.1 Datasets and Evaluation Metrics ‣ Appendix A Appendix ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. To minimize the influence of visual cues such as table lines, which could assist the model’s predictions, we specifically chose images of wireless tables. Our selection criteria primarily focuses on the presence of extensive textual descriptions within the cells. Additionally, we have contacted the authors of iFLYTAB, and they have agreed to make this subset of the dataset available on the official website soon<math id="A1.SS1.p6.1.m1.1" class="ltx_Math" alttext="{}^{\ref{link:semv2}}" display="inline"><semantics id="A1.SS1.p6.1.m1.1a"><msup id="A1.SS1.p6.1.m1.1.1" xref="A1.SS1.p6.1.m1.1.1.cmml"><mi id="A1.SS1.p6.1.m1.1.1a" xref="A1.SS1.p6.1.m1.1.1.cmml"></mi><mtext class="ltx_mathvariant_italic" id="A1.SS1.p6.1.m1.1.1.1" xref="A1.SS1.p6.1.m1.1.1.1d.cmml"><a href="#footnote1" title="footnote * ‣ A.1 Datasets and Evaluation Metrics ‣ Appendix A Appendix ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref ltx_font_italic" style="font-size:70%;"><span class="ltx_text ltx_ref_tag">*</span> ‣ <span class="ltx_text ltx_ref_tag">A.1</span></a></mtext></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p6.1.m1.1b"><apply id="A1.SS1.p6.1.m1.1.1.cmml" xref="A1.SS1.p6.1.m1.1.1"><ci id="A1.SS1.p6.1.m1.1.1.1d.cmml" xref="A1.SS1.p6.1.m1.1.1.1"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="A1.SS1.p6.1.m1.1.1.1.cmml" xref="A1.SS1.p6.1.m1.1.1.1"><a href="#footnote1" title="footnote * ‣ A.1 Datasets and Evaluation Metrics ‣ Appendix A Appendix ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref ltx_font_italic" style="font-size:70%;"><span class="ltx_text ltx_ref_tag">*</span> ‣ <span class="ltx_text ltx_ref_tag">A.1</span></a></mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p6.1.m1.1c">{}^{\ref{link:semv2}}</annotation></semantics></math>.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Results</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p">In this section, we explain the issue of the relatively low recall rate exhibited by UniTabNet due to the limitation imposed by the maximum decoding length. As illustrated in Figure <a href="#A1.F7" title="Figure 7 ‣ A.1 Datasets and Evaluation Metrics ‣ Appendix A Appendix ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, we select some table images from the WTW dataset that contain a large number of cells. Due to the maximum decoding length constraint set at 500, this limitation significantly impacts the model’s recall performance. However, as shown in Table <a href="#S6.T2" title="Table 2 ‣ 6.1 Datasets and Evaluation Metrics ‣ 6 Experiments ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, UniTabNet achieves relatively high precision. When considering both precision and recall, UniTabNet’s performance on the WTW dataset is comparable to current methods.</p>
</div>
<div id="A1.SS2.p2" class="ltx_para">
<p id="A1.SS2.p2.1" class="ltx_p">Additionally, as depicted in Figure <a href="#A1.F8" title="Figure 8 ‣ A.1 Datasets and Evaluation Metrics ‣ Appendix A Appendix ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, we visualize the row and column information learned by UniTabNet through the Vision Guider. The Vision Guider enables UniTabNet to focus more effectively on cell-related areas during the cell decoding process, as demonstrated in Figure <a href="#S6.F5" title="Figure 5 ‣ 6.2 Results ‣ 6 Experiments ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div id="A1.SS2.p3" class="ltx_para">
<p id="A1.SS2.p3.1" class="ltx_p">Finally, Figure <a href="#A1.F9" title="Figure 9 ‣ A.1 Datasets and Evaluation Metrics ‣ Appendix A Appendix ‣ UniTabNet: Bridging Vision and Language Models for Enhanced Table Structure Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> presents the prediction results of UniTabNet on the experimental datasets used. The model effectively processes both both simple and complex scenarios of table images. Notably, the cell polygons detected by UniTabNet in the PubTabNet dataset significantly differ from those in other datasets. This discrepancy arises because we directly use the official cell bounding box annotations provided, without any postprocessing.</p>
</div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2409.13147" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2409.13148" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2409.13148">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2409.13148" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2409.13150" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Oct  6 01:30:13 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
