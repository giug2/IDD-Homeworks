<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2206.14355] EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering</title><meta property="og:description" content="Context.
The availability of clean and diverse labeled data is a major roadblock for training models on complex tasks such as visual question answering (VQA).
The extensive work on large vision-and-language models has …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2206.14355">

<!--Generated on Mon Mar 11 19:52:31 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span id="id9.id1" class="ltx_text ltx_font_italic">EBMs vs. CL</span>: Exploring Self-Supervised Visual Pretraining for
<br class="ltx_break">Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Violetta Shevchenko<sup id="id10.9.id1" class="ltx_sup">1</sup>, Ehsan Abbasnejad<sup id="id11.10.id2" class="ltx_sup">1</sup>, Anthony Dick<sup id="id12.11.id3" class="ltx_sup">1</sup>, Anton van den Hengel<sup id="id13.12.id4" class="ltx_sup"><span id="id13.12.id4.1" class="ltx_text ltx_font_italic">1,2</span></sup>, Damien Teney<sup id="id14.13.id5" class="ltx_sup"><span id="id14.13.id5.1" class="ltx_text ltx_font_italic">1,3</span></sup> 
<br class="ltx_break"><sup id="id15.14.id6" class="ltx_sup">1</sup>University of Adelaide    <sup id="id16.15.id7" class="ltx_sup">2</sup>Amazon    <sup id="id17.16.id8" class="ltx_sup">3</sup>Idiap Research Institute
<br class="ltx_break"><span id="id18.17.id9" class="ltx_text ltx_font_typewriter" style="font-size:90%;">[firstname].[lastname]@adelaide.edu.au</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id19.id1" class="ltx_p"><span id="id19.id1.1" class="ltx_text ltx_font_bold">Context.</span>
The availability of clean and diverse labeled data is a major roadblock for training models on complex tasks such as visual question answering (VQA).
The extensive work on large vision-and-language models has shown that self-supervised learning is effective for pretraining multimodal interactions.
In this technical report, we focus on visual representations.
We review and evaluate self-supervised methods to leverage unlabeled images and pretrain a model, which we then fine-tune on a custom VQA task that allows controlled evaluation and diagnosis.
We compare energy-based models (EBMs) with contrastive learning (CL).
While EBMs are growing in popularity, they lack an evaluation on downstream tasks.
</p>
<p id="id20.id2" class="ltx_p"><span id="id20.id2.1" class="ltx_text ltx_font_bold">Findings.</span>
Both EBMs and CL can learn representations from unlabeled images that enable training a VQA model on very little annotated data.
In a simple setting similar to CLEVR, we find that CL representations also improve systematic generalization, and even match the performance of representations from a larger, supervised, ImageNet-pretrained model.
However, we find EBMs to be difficult to train because of instabilities and high variability in their results.
We, therefore, investigate other purported benefits of EBMs.
They prove useful for OOD detection, but other results on supervised energy-based training and uncertainty calibration are largely negative.</p>
<p id="id21.id3" class="ltx_p"><span id="id21.id3.1" class="ltx_text ltx_font_bold">Conclusions.</span>
(1) We make the encouraging observation that self-supervised visual pretraining allows displacing some of the requirements for training data from the main/supervised to a pretraining/unsupervised stage. (2) CL currently seems a preferable option over EBMs.
To our surprise, EBMs could not achieve the benefits purported in the literature, even in a toy setting.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The availability of large-scale diverse datasets has been a driving force in deep learning research for computer vision as well as natural language processing (NLP). Tasks like visual question answering (VQA), that combine vision and language and involve complex reasoning, require a large amount of aligned visual and textual data for training.
The generation of such data involves human annotators, making it expensive and time-consuming. Moreover, task-specific data collection from humans often introduces biases and noise in the data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> that are subsequently difficult to deal with during training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> or evaluation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib67" title="" class="ltx_ref">67</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Early methods for VQA made use of pretrained image models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and language features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>, <a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>.
Most recent work has focused on pretraining general-purpose vision-and-language models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>, <a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib51" title="" class="ltx_ref">51</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
These models are pretrained with self-supervised objectives, which alleviates the need for tasks-specific VQA training examples, but they usually require aligned vision and language, such as images with captions.
This motivates our exploration of self-supervised methods for pretraining the visual encoder, which only requires unlabeled images.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Our study explores the potential benefits of two popular self-supervised paradigms, energy-based models (EBMs) and contrastive learning (CL).
These are applied specifically to <em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">visual</em> data.
Our findings are therefore particularly relevant to the training of vision-and-language models for particular visual domains (<em id="S1.p3.1.2" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S1.p3.1.3" class="ltx_text"></span> industrial or medical images) where little annotated data is available.
We conduct our experiments with a simple VQA model and a custom toy task similar to CLEVR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, which allows a controlled evaluation.
Unlike most recent papers on vision and language, we do not deal with large-scale datasets nor large transformer-based models.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">An important novelty of this study is the consideration of EBMs.
Generative models are generally attractive in unsupervised machine learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>.
EBMs in particular have grown in popularity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib79" title="" class="ltx_ref">79</a>]</cite>
because they were shown to be also effective on discriminative tasks, with claims of improved calibration, robustness, and out-of-distribution (OOD) detection capabilities.
The current literature however lacks evaluations on complex downstream tasks, which we partly remedy.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">The contents of this report are summarized as follows.</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We review the general concepts behind energy-based models (EBMs) and contrastive learning (CL).</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We devise a simple VQA setting with data similar to CLEVR, and a simple CNN–LSTM model. Both allow a constrained and controlled evaluation, including OOD generalization (novel object/color combinations at test time).</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">In this setting, we compare EBMs with CL (SimCLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>) for pretraining visual representations used by the VQA model. Both methods are effective and allow training the VQA model with little annotated data.
However, EBMs are practically difficult to train.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">We compare EBMs with CL for OOD detection of images, which could serve in VQA for determining unanswerable cases at test time.
EBMs are generally more reliable, but they can fail when ID and OOD data are visually similar.</p>
</div>
</li>
<li id="S1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span> 
<div id="S1.I1.i5.p1" class="ltx_para">
<p id="S1.I1.i5.p1.1" class="ltx_p">We investigate potential benefits of supervised energy-based training of the VQA model itself, using JEM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and CEBM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
Our results are mixed, with some improvements in accuracy (at the expense of a finicky training), but none of the expected improvements in calibration.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Training VQA models.</h4>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">Visual question answering is a popular task to evaluate the progress of AI on vision and language <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib69" title="" class="ltx_ref">69</a>, <a href="#bib.bib74" title="" class="ltx_ref">74</a>]</cite>.
Early work on VQA trained models with supervision from question/image/answer triplets. These models (e.g. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>) used visual features from a CNN or object detector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> itself trained with supervision from annotated datasets such as ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> or Visual Genome <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>.
Modern approaches to VQA use large-scale transformer models trained with self-supervised objectives on vision-and-language data (e.g. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>), before being fine-tuned with supervision of VQA triplets.
The self-supervision in these models serves to learn correspondences across the visual and textual modalities, and the visual inputs are often processed by a pretrained visual encoder. Recent exceptions that appeared after our study include ViLT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> and VLC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, which take image patches as input, and
MDETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, X-DETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, SOHO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>, TxT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite> and E2E-VLP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib78" title="" class="ltx_ref">78</a>]</cite>, which jointly train an object detector.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Energy-based models</h4>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">(EBMs) offer an attractive framework to unify various areas of machine learning, and also lead to a new class of generative models.
See <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> for an early tutorial.
Recent studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite> have investigated training techniques that enable the application of EBMs to high-dimensional data and address issues of training stability.
EBMs have been applied to various areas including image generation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib77" title="" class="ltx_ref">77</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib76" title="" class="ltx_ref">76</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>,
graph generation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>, image classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, regression <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, continual learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> and natural language processing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib71" title="" class="ltx_ref">71</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Contrastive learning</h4>

<div id="S2.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px3.p1.1" class="ltx_p">(CL) is one of the most popular approaches to learn representations of high-dimensional data such as images without access to training labels.
A contrastive training objective essentially trains a model to differentiate between similar and dissimilar samples.
While early application in computer vision <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib75" title="" class="ltx_ref">75</a>, <a href="#bib.bib59" title="" class="ltx_ref">59</a>, <a href="#bib.bib80" title="" class="ltx_ref">80</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib70" title="" class="ltx_ref">70</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> could not compete with supervised training, recent methods such as SimCLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and SwAV <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> introduced novel data augmentations and architectural modifications that narrowed this gap and can now compete with the supervised paradigm.
In this work, we apply contrastive learning to the visual question answering task. Another VQA method that incorporates contrastive loss was proposed by Whitehead <em id="S2.SS0.SSS0.Px3.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px3.p1.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib73" title="" class="ltx_ref">73</a>]</cite>, where the model is trained on image-question pairs in a self-supervised manner. In contrast, in this work we utilize images without any additional annotations.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Background</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The setup of our main experiments consists in pretraining a convolutional neural network (CNN) on unlabeled images with self-supervision.
This CNN is then used as the visual encoder of a VQA model.
The CNN is fine-tuned while training the VQA model with question/image/answer examples.
With this setup, we investigate whether visual pretraining can facilitate the training of the VQA model (<em id="S3.p1.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S3.p1.1.2" class="ltx_text"></span> with less task-specific data) and/or improve its generalization capabilities.
Our work does not introduce new methods besides the adaptation of EBMs and contrastive learning to the pretraining of visual representations for VQA.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">This section reviews the methods used under a common technical umbrella.
This background justifies the comparison of these methods in a same study and it sets the stage in terms of expectations for our experiments of Section <a href="#S5" title="5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>A common self-learning objective</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.6" class="ltx_p">The self-supervised learning objective of the interest in this report can be described as:</p>
<table id="A1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{{\boldsymbol{\theta}}}({\boldsymbol{x}})~{}" display="inline"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.2" xref="S3.Ex1.m1.1.2.cmml"><msub id="S3.Ex1.m1.1.2.2" xref="S3.Ex1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.1.2.2.2" xref="S3.Ex1.m1.1.2.2.2.cmml">ℒ</mi><mi id="S3.Ex1.m1.1.2.2.3" xref="S3.Ex1.m1.1.2.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.1.2.1" xref="S3.Ex1.m1.1.2.1.cmml">​</mo><mrow id="S3.Ex1.m1.1.2.3.2" xref="S3.Ex1.m1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.2.3.2.1" xref="S3.Ex1.m1.1.2.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.Ex1.m1.1.2.3.2.2" xref="S3.Ex1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.2.cmml" xref="S3.Ex1.m1.1.2"><times id="S3.Ex1.m1.1.2.1.cmml" xref="S3.Ex1.m1.1.2.1"></times><apply id="S3.Ex1.m1.1.2.2.cmml" xref="S3.Ex1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.2.2.1.cmml" xref="S3.Ex1.m1.1.2.2">subscript</csymbol><ci id="S3.Ex1.m1.1.2.2.2.cmml" xref="S3.Ex1.m1.1.2.2.2">ℒ</ci><ci id="S3.Ex1.m1.1.2.2.3.cmml" xref="S3.Ex1.m1.1.2.2.3">𝜽</ci></apply><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle\mathcal{L}_{{\boldsymbol{\theta}}}({\boldsymbol{x}})~{}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m2.4" class="ltx_Math" alttext="\displaystyle=~{}-\!\mathbb{E}_{{\boldsymbol{x}}\sim\mathcal{D}}\big{[}\log\left(\tilde{p}_{{\boldsymbol{\theta}}}({\boldsymbol{x}})\right)\big{]}~{},~{}~{}\text{with}" display="inline"><semantics id="S3.Ex1.m2.4a"><mrow id="S3.Ex1.m2.4.4" xref="S3.Ex1.m2.4.4.cmml"><mi id="S3.Ex1.m2.4.4.3" xref="S3.Ex1.m2.4.4.3.cmml"></mi><mo rspace="0.608em" id="S3.Ex1.m2.4.4.2" xref="S3.Ex1.m2.4.4.2.cmml">=</mo><mrow id="S3.Ex1.m2.4.4.1.1" xref="S3.Ex1.m2.4.4.1.2.cmml"><mrow id="S3.Ex1.m2.4.4.1.1.1" xref="S3.Ex1.m2.4.4.1.1.1.cmml"><mo id="S3.Ex1.m2.4.4.1.1.1a" xref="S3.Ex1.m2.4.4.1.1.1.cmml">−</mo><mrow id="S3.Ex1.m2.4.4.1.1.1.1" xref="S3.Ex1.m2.4.4.1.1.1.1.cmml"><msub id="S3.Ex1.m2.4.4.1.1.1.1.3" xref="S3.Ex1.m2.4.4.1.1.1.1.3.cmml"><mi id="S3.Ex1.m2.4.4.1.1.1.1.3.2" xref="S3.Ex1.m2.4.4.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.Ex1.m2.4.4.1.1.1.1.3.3" xref="S3.Ex1.m2.4.4.1.1.1.1.3.3.cmml"><mi id="S3.Ex1.m2.4.4.1.1.1.1.3.3.2" xref="S3.Ex1.m2.4.4.1.1.1.1.3.3.2.cmml">𝒙</mi><mo id="S3.Ex1.m2.4.4.1.1.1.1.3.3.1" xref="S3.Ex1.m2.4.4.1.1.1.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.4.4.1.1.1.1.3.3.3" xref="S3.Ex1.m2.4.4.1.1.1.1.3.3.3.cmml">𝒟</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.4.4.1.1.1.1.2" xref="S3.Ex1.m2.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m2.4.4.1.1.1.1.1.1" xref="S3.Ex1.m2.4.4.1.1.1.1.1.2.cmml"><mo maxsize="120%" minsize="120%" id="S3.Ex1.m2.4.4.1.1.1.1.1.1.2" xref="S3.Ex1.m2.4.4.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m2.2.2" xref="S3.Ex1.m2.2.2.cmml">log</mi><mo id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1a" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">p</mi><mo id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex1.m2.1.1" xref="S3.Ex1.m2.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo maxsize="120%" minsize="120%" rspace="0.330em" id="S3.Ex1.m2.4.4.1.1.1.1.1.1.3" xref="S3.Ex1.m2.4.4.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo rspace="0.827em" id="S3.Ex1.m2.4.4.1.1.2" xref="S3.Ex1.m2.4.4.1.2.cmml">,</mo><mtext id="S3.Ex1.m2.3.3" xref="S3.Ex1.m2.3.3a.cmml">with</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.4b"><apply id="S3.Ex1.m2.4.4.cmml" xref="S3.Ex1.m2.4.4"><eq id="S3.Ex1.m2.4.4.2.cmml" xref="S3.Ex1.m2.4.4.2"></eq><csymbol cd="latexml" id="S3.Ex1.m2.4.4.3.cmml" xref="S3.Ex1.m2.4.4.3">absent</csymbol><list id="S3.Ex1.m2.4.4.1.2.cmml" xref="S3.Ex1.m2.4.4.1.1"><apply id="S3.Ex1.m2.4.4.1.1.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1"><minus id="S3.Ex1.m2.4.4.1.1.1.2.cmml" xref="S3.Ex1.m2.4.4.1.1.1"></minus><apply id="S3.Ex1.m2.4.4.1.1.1.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1"><times id="S3.Ex1.m2.4.4.1.1.1.1.2.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.2"></times><apply id="S3.Ex1.m2.4.4.1.1.1.1.3.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.4.4.1.1.1.1.3.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m2.4.4.1.1.1.1.3.2.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.3.2">𝔼</ci><apply id="S3.Ex1.m2.4.4.1.1.1.1.3.3.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.3.3"><csymbol cd="latexml" id="S3.Ex1.m2.4.4.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.3.3.1">similar-to</csymbol><ci id="S3.Ex1.m2.4.4.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.3.3.2">𝒙</ci><ci id="S3.Ex1.m2.4.4.1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.3.3.3">𝒟</ci></apply></apply><apply id="S3.Ex1.m2.4.4.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m2.4.4.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1"><log id="S3.Ex1.m2.2.2.cmml" xref="S3.Ex1.m2.2.2"></log><apply id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.2.1">~</ci><ci id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑝</ci></apply><ci id="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="S3.Ex1.m2.1.1.cmml" xref="S3.Ex1.m2.1.1">𝒙</ci></apply></apply></apply></apply></apply><ci id="S3.Ex1.m2.3.3a.cmml" xref="S3.Ex1.m2.3.3"><mtext id="S3.Ex1.m2.3.3.cmml" xref="S3.Ex1.m2.3.3">with</mtext></ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.4c">\displaystyle=~{}-\!\mathbb{E}_{{\boldsymbol{x}}\sim\mathcal{D}}\big{[}\log\left(\tilde{p}_{{\boldsymbol{\theta}}}({\boldsymbol{x}})\right)\big{]}~{},~{}~{}\text{with}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\displaystyle\tilde{p}_{{\boldsymbol{\theta}}}({\boldsymbol{x}})~{}" display="inline"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.2" xref="S3.E1.m1.1.2.cmml"><msub id="S3.E1.m1.1.2.2" xref="S3.E1.m1.1.2.2.cmml"><mover accent="true" id="S3.E1.m1.1.2.2.2" xref="S3.E1.m1.1.2.2.2.cmml"><mi id="S3.E1.m1.1.2.2.2.2" xref="S3.E1.m1.1.2.2.2.2.cmml">p</mi><mo id="S3.E1.m1.1.2.2.2.1" xref="S3.E1.m1.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.E1.m1.1.2.2.3" xref="S3.E1.m1.1.2.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.2.1" xref="S3.E1.m1.1.2.1.cmml">​</mo><mrow id="S3.E1.m1.1.2.3.2" xref="S3.E1.m1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.2.3.2.1" xref="S3.E1.m1.1.2.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.E1.m1.1.2.3.2.2" xref="S3.E1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.2.cmml" xref="S3.E1.m1.1.2"><times id="S3.E1.m1.1.2.1.cmml" xref="S3.E1.m1.1.2.1"></times><apply id="S3.E1.m1.1.2.2.cmml" xref="S3.E1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.2.1.cmml" xref="S3.E1.m1.1.2.2">subscript</csymbol><apply id="S3.E1.m1.1.2.2.2.cmml" xref="S3.E1.m1.1.2.2.2"><ci id="S3.E1.m1.1.2.2.2.1.cmml" xref="S3.E1.m1.1.2.2.2.1">~</ci><ci id="S3.E1.m1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.2.2.2.2">𝑝</ci></apply><ci id="S3.E1.m1.1.2.2.3.cmml" xref="S3.E1.m1.1.2.2.3">𝜽</ci></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle\tilde{p}_{{\boldsymbol{\theta}}}({\boldsymbol{x}})~{}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1.m2.4" class="ltx_math_unparsed" alttext="\displaystyle=~{}\frac{\exp{\big{(}\text{score}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))\big{)}}}{Z({\boldsymbol{\theta}})}~{}," display="inline"><semantics id="S3.E1.m2.4a"><mrow id="S3.E1.m2.4.4.1"><mrow id="S3.E1.m2.4.4.1.1"><mi id="S3.E1.m2.4.4.1.1.2"></mi><mo rspace="0.608em" id="S3.E1.m2.4.4.1.1.1">=</mo><mstyle displaystyle="true" id="S3.E1.m2.3.3"><mfrac id="S3.E1.m2.3.3a"><mrow id="S3.E1.m2.2.2.2"><mi id="S3.E1.m2.2.2.2.2">exp</mi><mrow id="S3.E1.m2.2.2.2.3"><mo maxsize="120%" minsize="120%" id="S3.E1.m2.2.2.2.3.1">(</mo><mtext id="S3.E1.m2.2.2.2.3.2">score</mtext><mrow id="S3.E1.m2.2.2.2.3.3"><mo stretchy="false" id="S3.E1.m2.2.2.2.3.3.1">(</mo><msub id="S3.E1.m2.2.2.2.3.3.2"><mi id="S3.E1.m2.2.2.2.3.3.2.2">f</mi><mi id="S3.E1.m2.2.2.2.3.3.2.3">𝜽</mi></msub><mrow id="S3.E1.m2.2.2.2.3.3.3"><mo stretchy="false" id="S3.E1.m2.2.2.2.3.3.3.1">(</mo><mi id="S3.E1.m2.1.1.1.1">𝒙</mi><mo stretchy="false" id="S3.E1.m2.2.2.2.3.3.3.2">)</mo></mrow><mo stretchy="false" id="S3.E1.m2.2.2.2.3.3.4">)</mo></mrow><mo stretchy="false" id="S3.E1.m2.2.2.2.3.4">)</mo></mrow><mo maxsize="120%" minsize="120%" id="S3.E1.m2.2.2.2.4">)</mo></mrow><mrow id="S3.E1.m2.3.3.3"><mi id="S3.E1.m2.3.3.3.3">Z</mi><mo lspace="0em" rspace="0em" id="S3.E1.m2.3.3.3.2">​</mo><mrow id="S3.E1.m2.3.3.3.4.2"><mo stretchy="false" id="S3.E1.m2.3.3.3.4.2.1">(</mo><mi id="S3.E1.m2.3.3.3.1">𝜽</mi><mo stretchy="false" id="S3.E1.m2.3.3.3.4.2.2">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo lspace="0.330em" id="S3.E1.m2.4.4.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E1.m2.4b">\displaystyle=~{}\frac{\exp{\big{(}\text{score}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))\big{)}}}{Z({\boldsymbol{\theta}})}~{},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.5" class="ltx_p">where <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="{\boldsymbol{x}}\in\mathbb{R}^{D}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝒙</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝒙</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">{\boldsymbol{x}}\in\mathbb{R}^{D}</annotation></semantics></math> is an input (unlabeled image), <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="f_{{\boldsymbol{\theta}}}:\mathbb{R}^{D}\rightarrow\mathbb{R}^{d}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><msub id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2.2" xref="S3.SS1.p1.2.m2.1.1.2.2.cmml">f</mi><mi id="S3.SS1.p1.2.m2.1.1.2.3" xref="S3.SS1.p1.2.m2.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml">:</mo><mrow id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml"><msup id="S3.SS1.p1.2.m2.1.1.3.2" xref="S3.SS1.p1.2.m2.1.1.3.2.cmml"><mi id="S3.SS1.p1.2.m2.1.1.3.2.2" xref="S3.SS1.p1.2.m2.1.1.3.2.2.cmml">ℝ</mi><mi id="S3.SS1.p1.2.m2.1.1.3.2.3" xref="S3.SS1.p1.2.m2.1.1.3.2.3.cmml">D</mi></msup><mo stretchy="false" id="S3.SS1.p1.2.m2.1.1.3.1" xref="S3.SS1.p1.2.m2.1.1.3.1.cmml">→</mo><msup id="S3.SS1.p1.2.m2.1.1.3.3" xref="S3.SS1.p1.2.m2.1.1.3.3.cmml"><mi id="S3.SS1.p1.2.m2.1.1.3.3.2" xref="S3.SS1.p1.2.m2.1.1.3.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.2.m2.1.1.3.3.3" xref="S3.SS1.p1.2.m2.1.1.3.3.3.cmml">d</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><ci id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1">:</ci><apply id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2.2">𝑓</ci><ci id="S3.SS1.p1.2.m2.1.1.2.3.cmml" xref="S3.SS1.p1.2.m2.1.1.2.3">𝜽</ci></apply><apply id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3"><ci id="S3.SS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.3.1">→</ci><apply id="S3.SS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.3.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2">superscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.3.2.2.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2.2">ℝ</ci><ci id="S3.SS1.p1.2.m2.1.1.3.2.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3.2.3">𝐷</ci></apply><apply id="S3.SS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.3.3.2">ℝ</ci><ci id="S3.SS1.p1.2.m2.1.1.3.3.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">f_{{\boldsymbol{\theta}}}:\mathbb{R}^{D}\rightarrow\mathbb{R}^{d}</annotation></semantics></math> is the neural network of parameters <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">{\boldsymbol{\theta}}</annotation></semantics></math> that learns a mapping from inputs to an embedding space, <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="Z({\boldsymbol{\theta}})" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.2" xref="S3.SS1.p1.4.m4.1.2.cmml"><mi id="S3.SS1.p1.4.m4.1.2.2" xref="S3.SS1.p1.4.m4.1.2.2.cmml">Z</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.1.2.1" xref="S3.SS1.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.4.m4.1.2.3.2" xref="S3.SS1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.1.2.3.2.1" xref="S3.SS1.p1.4.m4.1.2.cmml">(</mo><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">𝜽</mi><mo stretchy="false" id="S3.SS1.p1.4.m4.1.2.3.2.2" xref="S3.SS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.2.cmml" xref="S3.SS1.p1.4.m4.1.2"><times id="S3.SS1.p1.4.m4.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.2.1"></times><ci id="S3.SS1.p1.4.m4.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.2.2">𝑍</ci><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">Z({\boldsymbol{\theta}})</annotation></semantics></math> is a normalizer and <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathcal{D}</annotation></semantics></math> is our dataset of unlabeled examples. Different choices of score function and normalizer give rise to different self-supervised learning algorithms. In particular, considering EBMs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib76" title="" class="ltx_ref">76</a>]</cite> and the popular SimCLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> method for CL:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p">The <span id="S3.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">score function</span> in EBMs is learnable. It is implemented as a separate neural network that maps an embedding to a scalar that represents an unnormalized density of the input.
SimCLR uses a predetermined score function. It uses the similarity of the embeddings of different views (<em id="S3.I1.i1.p1.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.I1.i1.p1.1.3" class="ltx_text"></span> semantic-preserving transformations) of the input.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.3" class="ltx_p">The <span id="S3.I1.i2.p1.3.1" class="ltx_text ltx_font_bold">normalizer</span> in EBMs is designed to ensure <math id="S3.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\int\tilde{p}({\boldsymbol{x}})d{\boldsymbol{x}}=1" display="inline"><semantics id="S3.I1.i2.p1.1.m1.1a"><mrow id="S3.I1.i2.p1.1.m1.1.2" xref="S3.I1.i2.p1.1.m1.1.2.cmml"><mrow id="S3.I1.i2.p1.1.m1.1.2.2" xref="S3.I1.i2.p1.1.m1.1.2.2.cmml"><mo id="S3.I1.i2.p1.1.m1.1.2.2.1" xref="S3.I1.i2.p1.1.m1.1.2.2.1.cmml">∫</mo><mrow id="S3.I1.i2.p1.1.m1.1.2.2.2" xref="S3.I1.i2.p1.1.m1.1.2.2.2.cmml"><mover accent="true" id="S3.I1.i2.p1.1.m1.1.2.2.2.2" xref="S3.I1.i2.p1.1.m1.1.2.2.2.2.cmml"><mi id="S3.I1.i2.p1.1.m1.1.2.2.2.2.2" xref="S3.I1.i2.p1.1.m1.1.2.2.2.2.2.cmml">p</mi><mo id="S3.I1.i2.p1.1.m1.1.2.2.2.2.1" xref="S3.I1.i2.p1.1.m1.1.2.2.2.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.1.m1.1.2.2.2.1" xref="S3.I1.i2.p1.1.m1.1.2.2.2.1.cmml">​</mo><mrow id="S3.I1.i2.p1.1.m1.1.2.2.2.3.2" xref="S3.I1.i2.p1.1.m1.1.2.2.2.cmml"><mo stretchy="false" id="S3.I1.i2.p1.1.m1.1.2.2.2.3.2.1" xref="S3.I1.i2.p1.1.m1.1.2.2.2.cmml">(</mo><mi id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.I1.i2.p1.1.m1.1.2.2.2.3.2.2" xref="S3.I1.i2.p1.1.m1.1.2.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.1.m1.1.2.2.2.1a" xref="S3.I1.i2.p1.1.m1.1.2.2.2.1.cmml">​</mo><mrow id="S3.I1.i2.p1.1.m1.1.2.2.2.4" xref="S3.I1.i2.p1.1.m1.1.2.2.2.4.cmml"><mo rspace="0em" id="S3.I1.i2.p1.1.m1.1.2.2.2.4.1" xref="S3.I1.i2.p1.1.m1.1.2.2.2.4.1.cmml">𝑑</mo><mi id="S3.I1.i2.p1.1.m1.1.2.2.2.4.2" xref="S3.I1.i2.p1.1.m1.1.2.2.2.4.2.cmml">𝒙</mi></mrow></mrow></mrow><mo id="S3.I1.i2.p1.1.m1.1.2.1" xref="S3.I1.i2.p1.1.m1.1.2.1.cmml">=</mo><mn id="S3.I1.i2.p1.1.m1.1.2.3" xref="S3.I1.i2.p1.1.m1.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.2"><eq id="S3.I1.i2.p1.1.m1.1.2.1.cmml" xref="S3.I1.i2.p1.1.m1.1.2.1"></eq><apply id="S3.I1.i2.p1.1.m1.1.2.2.cmml" xref="S3.I1.i2.p1.1.m1.1.2.2"><int id="S3.I1.i2.p1.1.m1.1.2.2.1.cmml" xref="S3.I1.i2.p1.1.m1.1.2.2.1"></int><apply id="S3.I1.i2.p1.1.m1.1.2.2.2.cmml" xref="S3.I1.i2.p1.1.m1.1.2.2.2"><times id="S3.I1.i2.p1.1.m1.1.2.2.2.1.cmml" xref="S3.I1.i2.p1.1.m1.1.2.2.2.1"></times><apply id="S3.I1.i2.p1.1.m1.1.2.2.2.2.cmml" xref="S3.I1.i2.p1.1.m1.1.2.2.2.2"><ci id="S3.I1.i2.p1.1.m1.1.2.2.2.2.1.cmml" xref="S3.I1.i2.p1.1.m1.1.2.2.2.2.1">~</ci><ci id="S3.I1.i2.p1.1.m1.1.2.2.2.2.2.cmml" xref="S3.I1.i2.p1.1.m1.1.2.2.2.2.2">𝑝</ci></apply><ci id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">𝒙</ci><apply id="S3.I1.i2.p1.1.m1.1.2.2.2.4.cmml" xref="S3.I1.i2.p1.1.m1.1.2.2.2.4"><csymbol cd="latexml" id="S3.I1.i2.p1.1.m1.1.2.2.2.4.1.cmml" xref="S3.I1.i2.p1.1.m1.1.2.2.2.4.1">differential-d</csymbol><ci id="S3.I1.i2.p1.1.m1.1.2.2.2.4.2.cmml" xref="S3.I1.i2.p1.1.m1.1.2.2.2.4.2">𝒙</ci></apply></apply></apply><cn type="integer" id="S3.I1.i2.p1.1.m1.1.2.3.cmml" xref="S3.I1.i2.p1.1.m1.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">\int\tilde{p}({\boldsymbol{x}})d{\boldsymbol{x}}=1</annotation></semantics></math>. One approach to accomplish this is to estimate the normalizer using sampling, <em id="S3.I1.i2.p1.3.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.I1.i2.p1.3.3" class="ltx_text"></span> learning to generate samples.
This is practically challenging and produces training instability.
In SimCLR, rather than generating samples, augmented views of the training samples are used to compute <math id="S3.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="Z({\boldsymbol{\theta}})" display="inline"><semantics id="S3.I1.i2.p1.2.m2.1a"><mrow id="S3.I1.i2.p1.2.m2.1.2" xref="S3.I1.i2.p1.2.m2.1.2.cmml"><mi id="S3.I1.i2.p1.2.m2.1.2.2" xref="S3.I1.i2.p1.2.m2.1.2.2.cmml">Z</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.2.m2.1.2.1" xref="S3.I1.i2.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S3.I1.i2.p1.2.m2.1.2.3.2" xref="S3.I1.i2.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S3.I1.i2.p1.2.m2.1.2.3.2.1" xref="S3.I1.i2.p1.2.m2.1.2.cmml">(</mo><mi id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml">𝜽</mi><mo stretchy="false" id="S3.I1.i2.p1.2.m2.1.2.3.2.2" xref="S3.I1.i2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><apply id="S3.I1.i2.p1.2.m2.1.2.cmml" xref="S3.I1.i2.p1.2.m2.1.2"><times id="S3.I1.i2.p1.2.m2.1.2.1.cmml" xref="S3.I1.i2.p1.2.m2.1.2.1"></times><ci id="S3.I1.i2.p1.2.m2.1.2.2.cmml" xref="S3.I1.i2.p1.2.m2.1.2.2">𝑍</ci><ci id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">Z({\boldsymbol{\theta}})</annotation></semantics></math>. The estimation of <math id="S3.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="Z({\boldsymbol{\theta}})" display="inline"><semantics id="S3.I1.i2.p1.3.m3.1a"><mrow id="S3.I1.i2.p1.3.m3.1.2" xref="S3.I1.i2.p1.3.m3.1.2.cmml"><mi id="S3.I1.i2.p1.3.m3.1.2.2" xref="S3.I1.i2.p1.3.m3.1.2.2.cmml">Z</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.3.m3.1.2.1" xref="S3.I1.i2.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S3.I1.i2.p1.3.m3.1.2.3.2" xref="S3.I1.i2.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S3.I1.i2.p1.3.m3.1.2.3.2.1" xref="S3.I1.i2.p1.3.m3.1.2.cmml">(</mo><mi id="S3.I1.i2.p1.3.m3.1.1" xref="S3.I1.i2.p1.3.m3.1.1.cmml">𝜽</mi><mo stretchy="false" id="S3.I1.i2.p1.3.m3.1.2.3.2.2" xref="S3.I1.i2.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.3.m3.1b"><apply id="S3.I1.i2.p1.3.m3.1.2.cmml" xref="S3.I1.i2.p1.3.m3.1.2"><times id="S3.I1.i2.p1.3.m3.1.2.1.cmml" xref="S3.I1.i2.p1.3.m3.1.2.1"></times><ci id="S3.I1.i2.p1.3.m3.1.2.2.cmml" xref="S3.I1.i2.p1.3.m3.1.2.2">𝑍</ci><ci id="S3.I1.i2.p1.3.m3.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.3.m3.1c">Z({\boldsymbol{\theta}})</annotation></semantics></math> is simpler in SimCLR but the choice of the samples use is important.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Energy-based models</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Energy-based models (EBMs) are a form of generative model that relies on an energy function to capture dependencies between the random variables to be modeled. The energy function maps each configuration of variables to a scalar energy value. It is optimized such that observed values (<em id="S3.SS2.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS2.p1.1.2" class="ltx_text"></span> the training examples) have a low energy <em id="S3.SS2.p1.1.3" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS2.p1.1.4" class="ltx_text"></span> a high probability.
The probability density for an input <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="{\boldsymbol{x}}\in\mathbb{R}^{D}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝒙</mi><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><in id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></in><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝒙</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">{\boldsymbol{x}}\in\mathbb{R}^{D}</annotation></semantics></math> is represented as</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_math_unparsed" alttext="\text{score}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))=E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))~{}," display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1b"><mrow id="S3.E2.m1.1.2"><mtext id="S3.E2.m1.1.2.1">score</mtext><mrow id="S3.E2.m1.1.2.2"><mo stretchy="false" id="S3.E2.m1.1.2.2.1">(</mo><msub id="S3.E2.m1.1.2.2.2"><mi id="S3.E2.m1.1.2.2.2.2">f</mi><mi id="S3.E2.m1.1.2.2.2.3">𝜽</mi></msub><mrow id="S3.E2.m1.1.2.2.3"><mo stretchy="false" id="S3.E2.m1.1.2.2.3.1">(</mo><mi id="S3.E2.m1.1.1">𝒙</mi><mo stretchy="false" id="S3.E2.m1.1.2.2.3.2">)</mo></mrow><mo stretchy="false" id="S3.E2.m1.1.2.2.4">)</mo></mrow><mo stretchy="false" id="S3.E2.m1.1.2.3">)</mo></mrow><mo id="S3.E2.m1.1.3">=</mo><msub id="S3.E2.m1.1.4"><mi id="S3.E2.m1.1.4.2">E</mi><mi id="S3.E2.m1.1.4.3">𝜽</mi></msub><mrow id="S3.E2.m1.1.5"><mo stretchy="false" id="S3.E2.m1.1.5.1">(</mo><msub id="S3.E2.m1.1.5.2"><mi id="S3.E2.m1.1.5.2.2">f</mi><mi id="S3.E2.m1.1.5.2.3">𝜽</mi></msub><mrow id="S3.E2.m1.1.5.3"><mo stretchy="false" id="S3.E2.m1.1.5.3.1">(</mo><mi id="S3.E2.m1.1.5.3.2">𝒙</mi><mo stretchy="false" id="S3.E2.m1.1.5.3.3">)</mo></mrow><mo stretchy="false" id="S3.E2.m1.1.5.4">)</mo></mrow><mo rspace="0.330em" stretchy="false" id="S3.E2.m1.1.6">)</mo><mo id="S3.E2.m1.1.7">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\text{score}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))=E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))~{},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.6" class="ltx_p">where <math id="S3.SS2.p1.2.m1.1" class="ltx_Math" alttext="E_{{\boldsymbol{\theta}}}:\mathbb{R}^{d}\rightarrow\mathbb{R}" display="inline"><semantics id="S3.SS2.p1.2.m1.1a"><mrow id="S3.SS2.p1.2.m1.1.1" xref="S3.SS2.p1.2.m1.1.1.cmml"><msub id="S3.SS2.p1.2.m1.1.1.2" xref="S3.SS2.p1.2.m1.1.1.2.cmml"><mi id="S3.SS2.p1.2.m1.1.1.2.2" xref="S3.SS2.p1.2.m1.1.1.2.2.cmml">E</mi><mi id="S3.SS2.p1.2.m1.1.1.2.3" xref="S3.SS2.p1.2.m1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p1.2.m1.1.1.1" xref="S3.SS2.p1.2.m1.1.1.1.cmml">:</mo><mrow id="S3.SS2.p1.2.m1.1.1.3" xref="S3.SS2.p1.2.m1.1.1.3.cmml"><msup id="S3.SS2.p1.2.m1.1.1.3.2" xref="S3.SS2.p1.2.m1.1.1.3.2.cmml"><mi id="S3.SS2.p1.2.m1.1.1.3.2.2" xref="S3.SS2.p1.2.m1.1.1.3.2.2.cmml">ℝ</mi><mi id="S3.SS2.p1.2.m1.1.1.3.2.3" xref="S3.SS2.p1.2.m1.1.1.3.2.3.cmml">d</mi></msup><mo stretchy="false" id="S3.SS2.p1.2.m1.1.1.3.1" xref="S3.SS2.p1.2.m1.1.1.3.1.cmml">→</mo><mi id="S3.SS2.p1.2.m1.1.1.3.3" xref="S3.SS2.p1.2.m1.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m1.1b"><apply id="S3.SS2.p1.2.m1.1.1.cmml" xref="S3.SS2.p1.2.m1.1.1"><ci id="S3.SS2.p1.2.m1.1.1.1.cmml" xref="S3.SS2.p1.2.m1.1.1.1">:</ci><apply id="S3.SS2.p1.2.m1.1.1.2.cmml" xref="S3.SS2.p1.2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m1.1.1.2.1.cmml" xref="S3.SS2.p1.2.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.2.m1.1.1.2.2.cmml" xref="S3.SS2.p1.2.m1.1.1.2.2">𝐸</ci><ci id="S3.SS2.p1.2.m1.1.1.2.3.cmml" xref="S3.SS2.p1.2.m1.1.1.2.3">𝜽</ci></apply><apply id="S3.SS2.p1.2.m1.1.1.3.cmml" xref="S3.SS2.p1.2.m1.1.1.3"><ci id="S3.SS2.p1.2.m1.1.1.3.1.cmml" xref="S3.SS2.p1.2.m1.1.1.3.1">→</ci><apply id="S3.SS2.p1.2.m1.1.1.3.2.cmml" xref="S3.SS2.p1.2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m1.1.1.3.2.1.cmml" xref="S3.SS2.p1.2.m1.1.1.3.2">superscript</csymbol><ci id="S3.SS2.p1.2.m1.1.1.3.2.2.cmml" xref="S3.SS2.p1.2.m1.1.1.3.2.2">ℝ</ci><ci id="S3.SS2.p1.2.m1.1.1.3.2.3.cmml" xref="S3.SS2.p1.2.m1.1.1.3.2.3">𝑑</ci></apply><ci id="S3.SS2.p1.2.m1.1.1.3.3.cmml" xref="S3.SS2.p1.2.m1.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m1.1c">E_{{\boldsymbol{\theta}}}:\mathbb{R}^{d}\rightarrow\mathbb{R}</annotation></semantics></math> is the energy function (with abuse of notation, we denote all parameters with <math id="S3.SS2.p1.3.m2.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}" display="inline"><semantics id="S3.SS2.p1.3.m2.1a"><mi id="S3.SS2.p1.3.m2.1.1" xref="S3.SS2.p1.3.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m2.1b"><ci id="S3.SS2.p1.3.m2.1.1.cmml" xref="S3.SS2.p1.3.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m2.1c">{\boldsymbol{\theta}}</annotation></semantics></math>), and <math id="S3.SS2.p1.4.m3.4" class="ltx_Math" alttext="Z({\boldsymbol{\theta}})\!\!\!~{}=~{}\!\!\!\!\int\exp{(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}\,d{\boldsymbol{x}}" display="inline"><semantics id="S3.SS2.p1.4.m3.4a"><mrow id="S3.SS2.p1.4.m3.4.4" xref="S3.SS2.p1.4.m3.4.4.cmml"><mrow id="S3.SS2.p1.4.m3.4.4.3" xref="S3.SS2.p1.4.m3.4.4.3.cmml"><mi id="S3.SS2.p1.4.m3.4.4.3.2" xref="S3.SS2.p1.4.m3.4.4.3.2.cmml">Z</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m3.4.4.3.1" xref="S3.SS2.p1.4.m3.4.4.3.1.cmml">​</mo><mrow id="S3.SS2.p1.4.m3.4.4.3.3.2" xref="S3.SS2.p1.4.m3.4.4.3.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m3.4.4.3.3.2.1" xref="S3.SS2.p1.4.m3.4.4.3.cmml">(</mo><mi id="S3.SS2.p1.4.m3.1.1" xref="S3.SS2.p1.4.m3.1.1.cmml">𝜽</mi><mo stretchy="false" id="S3.SS2.p1.4.m3.4.4.3.3.2.2" xref="S3.SS2.p1.4.m3.4.4.3.cmml">)</mo></mrow></mrow><mpadded width="0.716em"><mo lspace="0.108em" id="S3.SS2.p1.4.m3.4.4.2" xref="S3.SS2.p1.4.m3.4.4.2.cmml">=</mo></mpadded><mrow id="S3.SS2.p1.4.m3.4.4.1" xref="S3.SS2.p1.4.m3.4.4.1.cmml"><mo id="S3.SS2.p1.4.m3.4.4.1.2" xref="S3.SS2.p1.4.m3.4.4.1.2.cmml">∫</mo><mrow id="S3.SS2.p1.4.m3.4.4.1.1" xref="S3.SS2.p1.4.m3.4.4.1.1.cmml"><mrow id="S3.SS2.p1.4.m3.4.4.1.1.1.1" xref="S3.SS2.p1.4.m3.4.4.1.1.1.2.cmml"><mi id="S3.SS2.p1.4.m3.3.3" xref="S3.SS2.p1.4.m3.3.3.cmml">exp</mi><mo id="S3.SS2.p1.4.m3.4.4.1.1.1.1a" xref="S3.SS2.p1.4.m3.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1" xref="S3.SS2.p1.4.m3.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.2" xref="S3.SS2.p1.4.m3.4.4.1.1.1.2.cmml">(</mo><mrow id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3.2" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3.3" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.2" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS2.p1.4.m3.2.2" xref="S3.SS2.p1.4.m3.2.2.cmml">𝒙</mi><mo stretchy="false" id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.3" xref="S3.SS2.p1.4.m3.4.4.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0.170em" rspace="0em" id="S3.SS2.p1.4.m3.4.4.1.1.2" xref="S3.SS2.p1.4.m3.4.4.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.4.m3.4.4.1.1.3" xref="S3.SS2.p1.4.m3.4.4.1.1.3.cmml"><mo rspace="0em" id="S3.SS2.p1.4.m3.4.4.1.1.3.1" xref="S3.SS2.p1.4.m3.4.4.1.1.3.1.cmml">𝑑</mo><mi id="S3.SS2.p1.4.m3.4.4.1.1.3.2" xref="S3.SS2.p1.4.m3.4.4.1.1.3.2.cmml">𝒙</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m3.4b"><apply id="S3.SS2.p1.4.m3.4.4.cmml" xref="S3.SS2.p1.4.m3.4.4"><eq id="S3.SS2.p1.4.m3.4.4.2.cmml" xref="S3.SS2.p1.4.m3.4.4.2"></eq><apply id="S3.SS2.p1.4.m3.4.4.3.cmml" xref="S3.SS2.p1.4.m3.4.4.3"><times id="S3.SS2.p1.4.m3.4.4.3.1.cmml" xref="S3.SS2.p1.4.m3.4.4.3.1"></times><ci id="S3.SS2.p1.4.m3.4.4.3.2.cmml" xref="S3.SS2.p1.4.m3.4.4.3.2">𝑍</ci><ci id="S3.SS2.p1.4.m3.1.1.cmml" xref="S3.SS2.p1.4.m3.1.1">𝜽</ci></apply><apply id="S3.SS2.p1.4.m3.4.4.1.cmml" xref="S3.SS2.p1.4.m3.4.4.1"><int id="S3.SS2.p1.4.m3.4.4.1.2.cmml" xref="S3.SS2.p1.4.m3.4.4.1.2"></int><apply id="S3.SS2.p1.4.m3.4.4.1.1.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1"><times id="S3.SS2.p1.4.m3.4.4.1.1.2.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.2"></times><apply id="S3.SS2.p1.4.m3.4.4.1.1.1.2.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1"><exp id="S3.SS2.p1.4.m3.3.3.cmml" xref="S3.SS2.p1.4.m3.3.3"></exp><apply id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1"><times id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.2"></times><apply id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.3.3">𝜽</ci></apply><apply id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1"><times id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="S3.SS2.p1.4.m3.2.2.cmml" xref="S3.SS2.p1.4.m3.2.2">𝒙</ci></apply></apply></apply><apply id="S3.SS2.p1.4.m3.4.4.1.1.3.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.3"><csymbol cd="latexml" id="S3.SS2.p1.4.m3.4.4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.3.1">differential-d</csymbol><ci id="S3.SS2.p1.4.m3.4.4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m3.4.4.1.1.3.2">𝒙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m3.4c">Z({\boldsymbol{\theta}})\!\!\!~{}=~{}\!\!\!\!\int\exp{(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}\,d{\boldsymbol{x}}</annotation></semantics></math> is the partition function. With this definition of <math id="S3.SS2.p1.5.m4.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S3.SS2.p1.5.m4.1a"><mi id="S3.SS2.p1.5.m4.1.1" xref="S3.SS2.p1.5.m4.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m4.1b"><ci id="S3.SS2.p1.5.m4.1.1.cmml" xref="S3.SS2.p1.5.m4.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m4.1c">Z</annotation></semantics></math>, we have <math id="S3.SS2.p1.6.m5.6" class="ltx_Math" alttext="{p}_{{\boldsymbol{\theta}}}({\boldsymbol{x}})=\tilde{p}_{{\boldsymbol{\theta}}}({\boldsymbol{x}})={\exp{(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}}/{Z({\boldsymbol{\theta}})}" display="inline"><semantics id="S3.SS2.p1.6.m5.6a"><mrow id="S3.SS2.p1.6.m5.6.6" xref="S3.SS2.p1.6.m5.6.6.cmml"><mrow id="S3.SS2.p1.6.m5.6.6.3" xref="S3.SS2.p1.6.m5.6.6.3.cmml"><msub id="S3.SS2.p1.6.m5.6.6.3.2" xref="S3.SS2.p1.6.m5.6.6.3.2.cmml"><mi id="S3.SS2.p1.6.m5.6.6.3.2.2" xref="S3.SS2.p1.6.m5.6.6.3.2.2.cmml">p</mi><mi id="S3.SS2.p1.6.m5.6.6.3.2.3" xref="S3.SS2.p1.6.m5.6.6.3.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m5.6.6.3.1" xref="S3.SS2.p1.6.m5.6.6.3.1.cmml">​</mo><mrow id="S3.SS2.p1.6.m5.6.6.3.3.2" xref="S3.SS2.p1.6.m5.6.6.3.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m5.6.6.3.3.2.1" xref="S3.SS2.p1.6.m5.6.6.3.cmml">(</mo><mi id="S3.SS2.p1.6.m5.1.1" xref="S3.SS2.p1.6.m5.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.SS2.p1.6.m5.6.6.3.3.2.2" xref="S3.SS2.p1.6.m5.6.6.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.6.m5.6.6.4" xref="S3.SS2.p1.6.m5.6.6.4.cmml">=</mo><mrow id="S3.SS2.p1.6.m5.6.6.5" xref="S3.SS2.p1.6.m5.6.6.5.cmml"><msub id="S3.SS2.p1.6.m5.6.6.5.2" xref="S3.SS2.p1.6.m5.6.6.5.2.cmml"><mover accent="true" id="S3.SS2.p1.6.m5.6.6.5.2.2" xref="S3.SS2.p1.6.m5.6.6.5.2.2.cmml"><mi id="S3.SS2.p1.6.m5.6.6.5.2.2.2" xref="S3.SS2.p1.6.m5.6.6.5.2.2.2.cmml">p</mi><mo id="S3.SS2.p1.6.m5.6.6.5.2.2.1" xref="S3.SS2.p1.6.m5.6.6.5.2.2.1.cmml">~</mo></mover><mi id="S3.SS2.p1.6.m5.6.6.5.2.3" xref="S3.SS2.p1.6.m5.6.6.5.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m5.6.6.5.1" xref="S3.SS2.p1.6.m5.6.6.5.1.cmml">​</mo><mrow id="S3.SS2.p1.6.m5.6.6.5.3.2" xref="S3.SS2.p1.6.m5.6.6.5.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m5.6.6.5.3.2.1" xref="S3.SS2.p1.6.m5.6.6.5.cmml">(</mo><mi id="S3.SS2.p1.6.m5.2.2" xref="S3.SS2.p1.6.m5.2.2.cmml">𝒙</mi><mo stretchy="false" id="S3.SS2.p1.6.m5.6.6.5.3.2.2" xref="S3.SS2.p1.6.m5.6.6.5.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.6.m5.6.6.6" xref="S3.SS2.p1.6.m5.6.6.6.cmml">=</mo><mrow id="S3.SS2.p1.6.m5.6.6.1" xref="S3.SS2.p1.6.m5.6.6.1.cmml"><mrow id="S3.SS2.p1.6.m5.6.6.1.1" xref="S3.SS2.p1.6.m5.6.6.1.1.cmml"><mrow id="S3.SS2.p1.6.m5.6.6.1.1.1.1" xref="S3.SS2.p1.6.m5.6.6.1.1.1.2.cmml"><mi id="S3.SS2.p1.6.m5.4.4" xref="S3.SS2.p1.6.m5.4.4.cmml">exp</mi><mo id="S3.SS2.p1.6.m5.6.6.1.1.1.1a" xref="S3.SS2.p1.6.m5.6.6.1.1.1.2.cmml">⁡</mo><mrow id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1" xref="S3.SS2.p1.6.m5.6.6.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.2" xref="S3.SS2.p1.6.m5.6.6.1.1.1.2.cmml">(</mo><mrow id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3.2" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3.3" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.2" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.3.2" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS2.p1.6.m5.3.3" xref="S3.SS2.p1.6.m5.3.3.cmml">𝒙</mi><mo stretchy="false" id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.3" xref="S3.SS2.p1.6.m5.6.6.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.6.m5.6.6.1.1.2" xref="S3.SS2.p1.6.m5.6.6.1.1.2.cmml">/</mo><mi id="S3.SS2.p1.6.m5.6.6.1.1.3" xref="S3.SS2.p1.6.m5.6.6.1.1.3.cmml">Z</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m5.6.6.1.2" xref="S3.SS2.p1.6.m5.6.6.1.2.cmml">​</mo><mrow id="S3.SS2.p1.6.m5.6.6.1.3.2" xref="S3.SS2.p1.6.m5.6.6.1.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m5.6.6.1.3.2.1" xref="S3.SS2.p1.6.m5.6.6.1.cmml">(</mo><mi id="S3.SS2.p1.6.m5.5.5" xref="S3.SS2.p1.6.m5.5.5.cmml">𝜽</mi><mo stretchy="false" id="S3.SS2.p1.6.m5.6.6.1.3.2.2" xref="S3.SS2.p1.6.m5.6.6.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m5.6b"><apply id="S3.SS2.p1.6.m5.6.6.cmml" xref="S3.SS2.p1.6.m5.6.6"><and id="S3.SS2.p1.6.m5.6.6a.cmml" xref="S3.SS2.p1.6.m5.6.6"></and><apply id="S3.SS2.p1.6.m5.6.6b.cmml" xref="S3.SS2.p1.6.m5.6.6"><eq id="S3.SS2.p1.6.m5.6.6.4.cmml" xref="S3.SS2.p1.6.m5.6.6.4"></eq><apply id="S3.SS2.p1.6.m5.6.6.3.cmml" xref="S3.SS2.p1.6.m5.6.6.3"><times id="S3.SS2.p1.6.m5.6.6.3.1.cmml" xref="S3.SS2.p1.6.m5.6.6.3.1"></times><apply id="S3.SS2.p1.6.m5.6.6.3.2.cmml" xref="S3.SS2.p1.6.m5.6.6.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m5.6.6.3.2.1.cmml" xref="S3.SS2.p1.6.m5.6.6.3.2">subscript</csymbol><ci id="S3.SS2.p1.6.m5.6.6.3.2.2.cmml" xref="S3.SS2.p1.6.m5.6.6.3.2.2">𝑝</ci><ci id="S3.SS2.p1.6.m5.6.6.3.2.3.cmml" xref="S3.SS2.p1.6.m5.6.6.3.2.3">𝜽</ci></apply><ci id="S3.SS2.p1.6.m5.1.1.cmml" xref="S3.SS2.p1.6.m5.1.1">𝒙</ci></apply><apply id="S3.SS2.p1.6.m5.6.6.5.cmml" xref="S3.SS2.p1.6.m5.6.6.5"><times id="S3.SS2.p1.6.m5.6.6.5.1.cmml" xref="S3.SS2.p1.6.m5.6.6.5.1"></times><apply id="S3.SS2.p1.6.m5.6.6.5.2.cmml" xref="S3.SS2.p1.6.m5.6.6.5.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m5.6.6.5.2.1.cmml" xref="S3.SS2.p1.6.m5.6.6.5.2">subscript</csymbol><apply id="S3.SS2.p1.6.m5.6.6.5.2.2.cmml" xref="S3.SS2.p1.6.m5.6.6.5.2.2"><ci id="S3.SS2.p1.6.m5.6.6.5.2.2.1.cmml" xref="S3.SS2.p1.6.m5.6.6.5.2.2.1">~</ci><ci id="S3.SS2.p1.6.m5.6.6.5.2.2.2.cmml" xref="S3.SS2.p1.6.m5.6.6.5.2.2.2">𝑝</ci></apply><ci id="S3.SS2.p1.6.m5.6.6.5.2.3.cmml" xref="S3.SS2.p1.6.m5.6.6.5.2.3">𝜽</ci></apply><ci id="S3.SS2.p1.6.m5.2.2.cmml" xref="S3.SS2.p1.6.m5.2.2">𝒙</ci></apply></apply><apply id="S3.SS2.p1.6.m5.6.6c.cmml" xref="S3.SS2.p1.6.m5.6.6"><eq id="S3.SS2.p1.6.m5.6.6.6.cmml" xref="S3.SS2.p1.6.m5.6.6.6"></eq><share href="#S3.SS2.p1.6.m5.6.6.5.cmml" id="S3.SS2.p1.6.m5.6.6d.cmml" xref="S3.SS2.p1.6.m5.6.6"></share><apply id="S3.SS2.p1.6.m5.6.6.1.cmml" xref="S3.SS2.p1.6.m5.6.6.1"><times id="S3.SS2.p1.6.m5.6.6.1.2.cmml" xref="S3.SS2.p1.6.m5.6.6.1.2"></times><apply id="S3.SS2.p1.6.m5.6.6.1.1.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1"><divide id="S3.SS2.p1.6.m5.6.6.1.1.2.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.2"></divide><apply id="S3.SS2.p1.6.m5.6.6.1.1.1.2.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1"><exp id="S3.SS2.p1.6.m5.4.4.cmml" xref="S3.SS2.p1.6.m5.4.4"></exp><apply id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1"><times id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.2"></times><apply id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.3.3">𝜽</ci></apply><apply id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1"><times id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="S3.SS2.p1.6.m5.3.3.cmml" xref="S3.SS2.p1.6.m5.3.3">𝒙</ci></apply></apply></apply><ci id="S3.SS2.p1.6.m5.6.6.1.1.3.cmml" xref="S3.SS2.p1.6.m5.6.6.1.1.3">𝑍</ci></apply><ci id="S3.SS2.p1.6.m5.5.5.cmml" xref="S3.SS2.p1.6.m5.5.5">𝜽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m5.6c">{p}_{{\boldsymbol{\theta}}}({\boldsymbol{x}})=\tilde{p}_{{\boldsymbol{\theta}}}({\boldsymbol{x}})={\exp{(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}}/{Z({\boldsymbol{\theta}})}</annotation></semantics></math>, a proper density function that represents the distribution of input data.
In this work, we implement the energy function with a CNN that takes an image as input and returns a scalar.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.2" class="ltx_p">The computation of the partition function <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="Z({\boldsymbol{\theta}})" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.2" xref="S3.SS2.p2.1.m1.1.2.cmml"><mi id="S3.SS2.p2.1.m1.1.2.2" xref="S3.SS2.p2.1.m1.1.2.2.cmml">Z</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.1.2.1" xref="S3.SS2.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS2.p2.1.m1.1.2.3.2" xref="S3.SS2.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.1.2.3.2.1" xref="S3.SS2.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S3.SS2.p2.1.m1.1.2.3.2.2" xref="S3.SS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.2"><times id="S3.SS2.p2.1.m1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.2.1"></times><ci id="S3.SS2.p2.1.m1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.2.2">𝑍</ci><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">Z({\boldsymbol{\theta}})</annotation></semantics></math> is usually intractable.
The standard maximum likelihood approach cannot therefore be applied directly to train the model.
Instead, we can use gradient-based optimization using the derivative of the log-likelihood of a sample <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="{\boldsymbol{x}}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">{\boldsymbol{x}}</annotation></semantics></math> (see Appendix <a href="#A1" title="Appendix A Derivation of Equation 3 ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a> for the full derivation):</p>
<table id="A1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial\log p_{{\boldsymbol{\theta}}}({\boldsymbol{x}})}{\partial{\boldsymbol{\theta}}}" display="inline"><semantics id="S3.E3.m1.1a"><mstyle displaystyle="true" id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mfrac id="S3.E3.m1.1.1a" xref="S3.E3.m1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mo mathsize="90%" rspace="0.167em" id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">∂</mo><mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml"><mrow id="S3.E3.m1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.3.2.cmml"><mi mathsize="90%" id="S3.E3.m1.1.1.1.3.2.1" xref="S3.E3.m1.1.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.E3.m1.1.1.1.3.2a" xref="S3.E3.m1.1.1.1.3.2.cmml">⁡</mo><msub id="S3.E3.m1.1.1.1.3.2.2" xref="S3.E3.m1.1.1.1.3.2.2.cmml"><mi mathsize="90%" id="S3.E3.m1.1.1.1.3.2.2.2" xref="S3.E3.m1.1.1.1.3.2.2.2.cmml">p</mi><mi mathsize="90%" id="S3.E3.m1.1.1.1.3.2.2.3" xref="S3.E3.m1.1.1.1.3.2.2.3.cmml">𝜽</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.3.3.2" xref="S3.E3.m1.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.E3.m1.1.1.1.3.3.2.1" xref="S3.E3.m1.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">𝒙</mi><mo maxsize="90%" minsize="90%" id="S3.E3.m1.1.1.1.3.3.2.2" xref="S3.E3.m1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mo mathsize="90%" rspace="0em" id="S3.E3.m1.1.1.3.1" xref="S3.E3.m1.1.1.3.1.cmml">∂</mo><mi mathsize="90%" id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml">𝜽</mi></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><divide id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1"></divide><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><partialdiff id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2"></partialdiff><apply id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3"><times id="S3.E3.m1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.3.1"></times><apply id="S3.E3.m1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.3.2"><log id="S3.E3.m1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.3.2.1"></log><apply id="S3.E3.m1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.3.2.2.2">𝑝</ci><ci id="S3.E3.m1.1.1.1.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.3.2.2.3">𝜽</ci></apply></apply><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝒙</ci></apply></apply><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><partialdiff id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3.1"></partialdiff><ci id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle\frac{\partial\log p_{{\boldsymbol{\theta}}}({\boldsymbol{x}})}{\partial{\boldsymbol{\theta}}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3.m2.4" class="ltx_math_unparsed" alttext="\displaystyle=\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}{\partial{\boldsymbol{\theta}}}-\mathbb{E}_{{\boldsymbol{x}}^{\prime}\sim p_{{\boldsymbol{\theta}}}({\boldsymbol{x}}^{\prime})}\left[\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}^{\prime}))}{\partial{\boldsymbol{\theta}}}\right]\,," display="inline"><semantics id="S3.E3.m2.4a"><mrow id="S3.E3.m2.4.4.1"><mrow id="S3.E3.m2.4.4.1.1"><mi id="S3.E3.m2.4.4.1.1.2"></mi><mo mathsize="90%" id="S3.E3.m2.4.4.1.1.1">=</mo><mrow id="S3.E3.m2.4.4.1.1.3"><mstyle displaystyle="true" id="S3.E3.m2.1.1"><mfrac id="S3.E3.m2.1.1a"><mrow id="S3.E3.m2.1.1.1"><mo mathsize="90%" rspace="0em" id="S3.E3.m2.1.1.1.2">∂</mo><msub id="S3.E3.m2.1.1.1.3"><mi mathsize="90%" id="S3.E3.m2.1.1.1.3.2">E</mi><mi mathsize="90%" id="S3.E3.m2.1.1.1.3.3">𝜽</mi></msub><mrow id="S3.E3.m2.1.1.1.4"><mo maxsize="90%" minsize="90%" id="S3.E3.m2.1.1.1.4.1">(</mo><msub id="S3.E3.m2.1.1.1.4.2"><mi mathsize="90%" id="S3.E3.m2.1.1.1.4.2.2">f</mi><mi mathsize="90%" id="S3.E3.m2.1.1.1.4.2.3">𝜽</mi></msub><mrow id="S3.E3.m2.1.1.1.4.3"><mo maxsize="90%" minsize="90%" id="S3.E3.m2.1.1.1.4.3.1">(</mo><mi mathsize="90%" id="S3.E3.m2.1.1.1.1">𝒙</mi><mo maxsize="90%" minsize="90%" id="S3.E3.m2.1.1.1.4.3.2">)</mo></mrow><mo maxsize="90%" minsize="90%" id="S3.E3.m2.1.1.1.4.4">)</mo></mrow><mo maxsize="90%" minsize="90%" id="S3.E3.m2.1.1.1.5">)</mo></mrow><mrow id="S3.E3.m2.1.1.3"><mo mathsize="90%" rspace="0em" id="S3.E3.m2.1.1.3.1">∂</mo><mi mathsize="90%" id="S3.E3.m2.1.1.3.2">𝜽</mi></mrow></mfrac></mstyle><mo mathsize="90%" id="S3.E3.m2.4.4.1.1.3.1">−</mo><mrow id="S3.E3.m2.4.4.1.1.3.2"><msub id="S3.E3.m2.4.4.1.1.3.2.2"><mi mathsize="90%" id="S3.E3.m2.4.4.1.1.3.2.2.2">𝔼</mi><mrow id="S3.E3.m2.2.2.1"><msup id="S3.E3.m2.2.2.1.3"><mi mathsize="90%" id="S3.E3.m2.2.2.1.3.2">𝒙</mi><mo mathsize="90%" id="S3.E3.m2.2.2.1.3.3">′</mo></msup><mo mathsize="90%" id="S3.E3.m2.2.2.1.2">∼</mo><mrow id="S3.E3.m2.2.2.1.1"><msub id="S3.E3.m2.2.2.1.1.3"><mi mathsize="90%" id="S3.E3.m2.2.2.1.1.3.2">p</mi><mi mathsize="90%" id="S3.E3.m2.2.2.1.1.3.3">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m2.2.2.1.1.2">​</mo><mrow id="S3.E3.m2.2.2.1.1.1.1"><mo maxsize="90%" minsize="90%" id="S3.E3.m2.2.2.1.1.1.1.2">(</mo><msup id="S3.E3.m2.2.2.1.1.1.1.1"><mi mathsize="90%" id="S3.E3.m2.2.2.1.1.1.1.1.2">𝒙</mi><mo mathsize="90%" id="S3.E3.m2.2.2.1.1.1.1.1.3">′</mo></msup><mo maxsize="90%" minsize="90%" id="S3.E3.m2.2.2.1.1.1.1.3">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m2.4.4.1.1.3.2.1">​</mo><mrow id="S3.E3.m2.4.4.1.1.3.2.3.2"><mo id="S3.E3.m2.4.4.1.1.3.2.3.2.1">[</mo><mstyle displaystyle="true" id="S3.E3.m2.3.3"><mfrac id="S3.E3.m2.3.3a"><mrow id="S3.E3.m2.3.3.1"><mo mathsize="90%" rspace="0em" id="S3.E3.m2.3.3.1.2">∂</mo><mrow id="S3.E3.m2.3.3.1.1"><msub id="S3.E3.m2.3.3.1.1.3"><mi mathsize="90%" id="S3.E3.m2.3.3.1.1.3.2">E</mi><mi mathsize="90%" id="S3.E3.m2.3.3.1.1.3.3">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m2.3.3.1.1.2">​</mo><mrow id="S3.E3.m2.3.3.1.1.1.1"><mo maxsize="90%" minsize="90%" id="S3.E3.m2.3.3.1.1.1.1.2">(</mo><mrow id="S3.E3.m2.3.3.1.1.1.1.1"><msub id="S3.E3.m2.3.3.1.1.1.1.1.3"><mi mathsize="90%" id="S3.E3.m2.3.3.1.1.1.1.1.3.2">f</mi><mi mathsize="90%" id="S3.E3.m2.3.3.1.1.1.1.1.3.3">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m2.3.3.1.1.1.1.1.2">​</mo><mrow id="S3.E3.m2.3.3.1.1.1.1.1.1.1"><mo maxsize="90%" minsize="90%" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.2">(</mo><msup id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1"><mi mathsize="90%" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.2">𝒙</mi><mo mathsize="90%" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3">′</mo></msup><mo maxsize="90%" minsize="90%" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="S3.E3.m2.3.3.1.1.1.1.3">)</mo></mrow></mrow></mrow><mrow id="S3.E3.m2.3.3.3"><mo mathsize="90%" rspace="0em" id="S3.E3.m2.3.3.3.1">∂</mo><mi mathsize="90%" id="S3.E3.m2.3.3.3.2">𝜽</mi></mrow></mfrac></mstyle><mo rspace="0.170em" id="S3.E3.m2.4.4.1.1.3.2.3.2.2">]</mo></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S3.E3.m2.4.4.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E3.m2.4b">\displaystyle=\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}{\partial{\boldsymbol{\theta}}}-\mathbb{E}_{{\boldsymbol{x}}^{\prime}\sim p_{{\boldsymbol{\theta}}}({\boldsymbol{x}}^{\prime})}\left[\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}^{\prime}))}{\partial{\boldsymbol{\theta}}}\right]\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.4" class="ltx_p">where <math id="S3.SS2.p2.3.m1.1" class="ltx_Math" alttext="{\boldsymbol{x}}^{\prime}" display="inline"><semantics id="S3.SS2.p2.3.m1.1a"><msup id="S3.SS2.p2.3.m1.1.1" xref="S3.SS2.p2.3.m1.1.1.cmml"><mi id="S3.SS2.p2.3.m1.1.1.2" xref="S3.SS2.p2.3.m1.1.1.2.cmml">𝒙</mi><mo id="S3.SS2.p2.3.m1.1.1.3" xref="S3.SS2.p2.3.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m1.1b"><apply id="S3.SS2.p2.3.m1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m1.1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.3.m1.1.1.2.cmml" xref="S3.SS2.p2.3.m1.1.1.2">𝒙</ci><ci id="S3.SS2.p2.3.m1.1.1.3.cmml" xref="S3.SS2.p2.3.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m1.1c">{\boldsymbol{x}}^{\prime}</annotation></semantics></math> is sampled from the model distribution.
Recent works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite> have proposed to estimate this gradient with MCMC sampling (Markov Chain Monte Carlo). Using a number of <math id="S3.SS2.p2.4.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p2.4.m2.1a"><mi id="S3.SS2.p2.4.m2.1.1" xref="S3.SS2.p2.4.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m2.1b"><ci id="S3.SS2.p2.4.m2.1.1.cmml" xref="S3.SS2.p2.4.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m2.1c">K</annotation></semantics></math> samples, this gives:</p>
<table id="A1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial\log p_{{\boldsymbol{\theta}}}({\boldsymbol{x}})}{\partial{\boldsymbol{\theta}}}" display="inline"><semantics id="S3.E4.m1.1a"><mstyle displaystyle="true" id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mfrac id="S3.E4.m1.1.1a" xref="S3.E4.m1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mo mathsize="90%" rspace="0.167em" id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">∂</mo><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml"><mrow id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.3.2.cmml"><mi mathsize="90%" id="S3.E4.m1.1.1.1.3.2.1" xref="S3.E4.m1.1.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.E4.m1.1.1.1.3.2a" xref="S3.E4.m1.1.1.1.3.2.cmml">⁡</mo><msub id="S3.E4.m1.1.1.1.3.2.2" xref="S3.E4.m1.1.1.1.3.2.2.cmml"><mi mathsize="90%" id="S3.E4.m1.1.1.1.3.2.2.2" xref="S3.E4.m1.1.1.1.3.2.2.2.cmml">p</mi><mi mathsize="90%" id="S3.E4.m1.1.1.1.3.2.2.3" xref="S3.E4.m1.1.1.1.3.2.2.3.cmml">𝜽</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E4.m1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.E4.m1.1.1.1.3.3.2.1" xref="S3.E4.m1.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">𝒙</mi><mo maxsize="90%" minsize="90%" id="S3.E4.m1.1.1.1.3.3.2.2" xref="S3.E4.m1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><mo mathsize="90%" rspace="0em" id="S3.E4.m1.1.1.3.1" xref="S3.E4.m1.1.1.3.1.cmml">∂</mo><mi mathsize="90%" id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml">𝜽</mi></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><divide id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1"></divide><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><partialdiff id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></partialdiff><apply id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3"><times id="S3.E4.m1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.3.1"></times><apply id="S3.E4.m1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.3.2"><log id="S3.E4.m1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.3.2.1"></log><apply id="S3.E4.m1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.3.2.2.1.cmml" xref="S3.E4.m1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.3.2.2.2.cmml" xref="S3.E4.m1.1.1.1.3.2.2.2">𝑝</ci><ci id="S3.E4.m1.1.1.1.3.2.2.3.cmml" xref="S3.E4.m1.1.1.1.3.2.2.3">𝜽</ci></apply></apply><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝒙</ci></apply></apply><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><partialdiff id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3.1"></partialdiff><ci id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\displaystyle\frac{\partial\log p_{{\boldsymbol{\theta}}}({\boldsymbol{x}})}{\partial{\boldsymbol{\theta}}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4.m2.2" class="ltx_math_unparsed" alttext="\displaystyle\approx\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}{\partial{\boldsymbol{\theta}}}-\frac{1}{K}\sum_{k}\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}_{k}^{\prime})))}{\partial{\boldsymbol{\theta}}}\,," display="inline"><semantics id="S3.E4.m2.2a"><mrow id="S3.E4.m2.2.2.1"><mrow id="S3.E4.m2.2.2.1.1"><mi id="S3.E4.m2.2.2.1.1.2"></mi><mo mathsize="90%" id="S3.E4.m2.2.2.1.1.1">≈</mo><mrow id="S3.E4.m2.2.2.1.1.3"><mstyle displaystyle="true" id="S3.E4.m2.1.1"><mfrac id="S3.E4.m2.1.1a"><mrow id="S3.E4.m2.1.1.1"><mo mathsize="90%" rspace="0em" id="S3.E4.m2.1.1.1.2">∂</mo><msub id="S3.E4.m2.1.1.1.3"><mi mathsize="90%" id="S3.E4.m2.1.1.1.3.2">E</mi><mi mathsize="90%" id="S3.E4.m2.1.1.1.3.3">𝜽</mi></msub><mrow id="S3.E4.m2.1.1.1.4"><mo maxsize="90%" minsize="90%" id="S3.E4.m2.1.1.1.4.1">(</mo><msub id="S3.E4.m2.1.1.1.4.2"><mi mathsize="90%" id="S3.E4.m2.1.1.1.4.2.2">f</mi><mi mathsize="90%" id="S3.E4.m2.1.1.1.4.2.3">𝜽</mi></msub><mrow id="S3.E4.m2.1.1.1.4.3"><mo maxsize="90%" minsize="90%" id="S3.E4.m2.1.1.1.4.3.1">(</mo><mi mathsize="90%" id="S3.E4.m2.1.1.1.1">𝒙</mi><mo maxsize="90%" minsize="90%" id="S3.E4.m2.1.1.1.4.3.2">)</mo></mrow><mo maxsize="90%" minsize="90%" id="S3.E4.m2.1.1.1.4.4">)</mo></mrow><mo maxsize="90%" minsize="90%" id="S3.E4.m2.1.1.1.5">)</mo></mrow><mrow id="S3.E4.m2.1.1.3"><mo mathsize="90%" rspace="0em" id="S3.E4.m2.1.1.3.1">∂</mo><mi mathsize="90%" id="S3.E4.m2.1.1.3.2">𝜽</mi></mrow></mfrac></mstyle><mo mathsize="90%" id="S3.E4.m2.2.2.1.1.3.1">−</mo><mrow id="S3.E4.m2.2.2.1.1.3.2"><mstyle displaystyle="true" id="S3.E4.m2.2.2.1.1.3.2.2"><mfrac id="S3.E4.m2.2.2.1.1.3.2.2a"><mn mathsize="90%" id="S3.E4.m2.2.2.1.1.3.2.2.2">1</mn><mi mathsize="90%" id="S3.E4.m2.2.2.1.1.3.2.2.3">K</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E4.m2.2.2.1.1.3.2.1">​</mo><mrow id="S3.E4.m2.2.2.1.1.3.2.3"><mstyle displaystyle="true" id="S3.E4.m2.2.2.1.1.3.2.3.1"><munder id="S3.E4.m2.2.2.1.1.3.2.3.1a"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E4.m2.2.2.1.1.3.2.3.1.2">∑</mo><mi mathsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.1.3">k</mi></munder></mstyle><mstyle displaystyle="true" id="S3.E4.m2.2.2.1.1.3.2.3.2"><mfrac id="S3.E4.m2.2.2.1.1.3.2.3.2a"><mrow id="S3.E4.m2.2.2.1.1.3.2.3.2.2"><mo mathsize="90%" rspace="0em" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.1">∂</mo><msub id="S3.E4.m2.2.2.1.1.3.2.3.2.2.2"><mi mathsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.2.2">E</mi><mi mathsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.2.3">𝜽</mi></msub><mrow id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3"><mo maxsize="90%" minsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3.1">(</mo><msub id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3.2"><mi mathsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3.2.2">f</mi><mi mathsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3.2.3">𝜽</mi></msub><mrow id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3.3"><mo maxsize="90%" minsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3.3.1">(</mo><msubsup id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3.3.2"><mi mathsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3.3.2.2.2">𝒙</mi><mi mathsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3.3.2.2.3">k</mi><mo mathsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3.3.2.3">′</mo></msubsup><mo maxsize="90%" minsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3.3.3">)</mo></mrow><mo maxsize="90%" minsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.3.4">)</mo></mrow><mo maxsize="90%" minsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.2.4">)</mo></mrow><mrow id="S3.E4.m2.2.2.1.1.3.2.3.2.3"><mo mathsize="90%" rspace="0em" id="S3.E4.m2.2.2.1.1.3.2.3.2.3.1">∂</mo><mi mathsize="90%" id="S3.E4.m2.2.2.1.1.3.2.3.2.3.2">𝜽</mi></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow><mo lspace="0.170em" mathsize="90%" id="S3.E4.m2.2.2.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E4.m2.2b">\displaystyle\approx\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}{\partial{\boldsymbol{\theta}}}-\frac{1}{K}\sum_{k}\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}_{k}^{\prime})))}{\partial{\boldsymbol{\theta}}}\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.5" class="ltx_p">In this estimation, a single sample is typically obtained using Langevin dynamics <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite> from <math id="S3.SS2.p2.5.m1.1" class="ltx_Math" alttext="p_{{\boldsymbol{\theta}}}" display="inline"><semantics id="S3.SS2.p2.5.m1.1a"><msub id="S3.SS2.p2.5.m1.1.1" xref="S3.SS2.p2.5.m1.1.1.cmml"><mi id="S3.SS2.p2.5.m1.1.1.2" xref="S3.SS2.p2.5.m1.1.1.2.cmml">p</mi><mi id="S3.SS2.p2.5.m1.1.1.3" xref="S3.SS2.p2.5.m1.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m1.1b"><apply id="S3.SS2.p2.5.m1.1.1.cmml" xref="S3.SS2.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m1.1.1.1.cmml" xref="S3.SS2.p2.5.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m1.1.1.2.cmml" xref="S3.SS2.p2.5.m1.1.1.2">𝑝</ci><ci id="S3.SS2.p2.5.m1.1.1.3.cmml" xref="S3.SS2.p2.5.m1.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m1.1c">p_{{\boldsymbol{\theta}}}</annotation></semantics></math> as follows:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.8" class="ltx_Math" alttext="{\boldsymbol{x}}^{\prime}_{k,t}\,=\,{\boldsymbol{x}}^{\prime}_{k,t-1}\,+\,\frac{\lambda}{2}\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}^{\prime}_{k,t-1}))}{\partial{\boldsymbol{x}}^{\prime}_{k}}\,+\,\omega_{t}\,," display="block"><semantics id="S3.E5.m1.8a"><mrow id="S3.E5.m1.8.8.1" xref="S3.E5.m1.8.8.1.1.cmml"><mrow id="S3.E5.m1.8.8.1.1" xref="S3.E5.m1.8.8.1.1.cmml"><msubsup id="S3.E5.m1.8.8.1.1.2" xref="S3.E5.m1.8.8.1.1.2.cmml"><mi id="S3.E5.m1.8.8.1.1.2.2.2" xref="S3.E5.m1.8.8.1.1.2.2.2.cmml">𝒙</mi><mrow id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">k</mi><mo id="S3.E5.m1.2.2.2.4.1" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">t</mi></mrow><mo id="S3.E5.m1.8.8.1.1.2.2.3" xref="S3.E5.m1.8.8.1.1.2.2.3.cmml">′</mo></msubsup><mo lspace="0.448em" rspace="0.448em" id="S3.E5.m1.8.8.1.1.1" xref="S3.E5.m1.8.8.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.8.8.1.1.3" xref="S3.E5.m1.8.8.1.1.3.cmml"><msubsup id="S3.E5.m1.8.8.1.1.3.2" xref="S3.E5.m1.8.8.1.1.3.2.cmml"><mi id="S3.E5.m1.8.8.1.1.3.2.2.2" xref="S3.E5.m1.8.8.1.1.3.2.2.2.cmml">𝒙</mi><mrow id="S3.E5.m1.4.4.2.2" xref="S3.E5.m1.4.4.2.3.cmml"><mi id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml">k</mi><mo id="S3.E5.m1.4.4.2.2.2" xref="S3.E5.m1.4.4.2.3.cmml">,</mo><mrow id="S3.E5.m1.4.4.2.2.1" xref="S3.E5.m1.4.4.2.2.1.cmml"><mi id="S3.E5.m1.4.4.2.2.1.2" xref="S3.E5.m1.4.4.2.2.1.2.cmml">t</mi><mo id="S3.E5.m1.4.4.2.2.1.1" xref="S3.E5.m1.4.4.2.2.1.1.cmml">−</mo><mn id="S3.E5.m1.4.4.2.2.1.3" xref="S3.E5.m1.4.4.2.2.1.3.cmml">1</mn></mrow></mrow><mo id="S3.E5.m1.8.8.1.1.3.2.2.3" xref="S3.E5.m1.8.8.1.1.3.2.2.3.cmml">′</mo></msubsup><mo rspace="0.392em" id="S3.E5.m1.8.8.1.1.3.1" xref="S3.E5.m1.8.8.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.8.8.1.1.3.3" xref="S3.E5.m1.8.8.1.1.3.3.cmml"><mfrac id="S3.E5.m1.8.8.1.1.3.3.2" xref="S3.E5.m1.8.8.1.1.3.3.2.cmml"><mi id="S3.E5.m1.8.8.1.1.3.3.2.2" xref="S3.E5.m1.8.8.1.1.3.3.2.2.cmml">λ</mi><mn id="S3.E5.m1.8.8.1.1.3.3.2.3" xref="S3.E5.m1.8.8.1.1.3.3.2.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S3.E5.m1.8.8.1.1.3.3.1" xref="S3.E5.m1.8.8.1.1.3.3.1.cmml">​</mo><mfrac id="S3.E5.m1.7.7" xref="S3.E5.m1.7.7.cmml"><mrow id="S3.E5.m1.7.7.3" xref="S3.E5.m1.7.7.3.cmml"><mo rspace="0em" id="S3.E5.m1.7.7.3.4" xref="S3.E5.m1.7.7.3.4.cmml">∂</mo><mrow id="S3.E5.m1.7.7.3.3" xref="S3.E5.m1.7.7.3.3.cmml"><msub id="S3.E5.m1.7.7.3.3.3" xref="S3.E5.m1.7.7.3.3.3.cmml"><mi id="S3.E5.m1.7.7.3.3.3.2" xref="S3.E5.m1.7.7.3.3.3.2.cmml">E</mi><mi id="S3.E5.m1.7.7.3.3.3.3" xref="S3.E5.m1.7.7.3.3.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.3.3.2" xref="S3.E5.m1.7.7.3.3.2.cmml">​</mo><mrow id="S3.E5.m1.7.7.3.3.1.1" xref="S3.E5.m1.7.7.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.7.7.3.3.1.1.2" xref="S3.E5.m1.7.7.3.3.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.7.7.3.3.1.1.1" xref="S3.E5.m1.7.7.3.3.1.1.1.cmml"><msub id="S3.E5.m1.7.7.3.3.1.1.1.3" xref="S3.E5.m1.7.7.3.3.1.1.1.3.cmml"><mi id="S3.E5.m1.7.7.3.3.1.1.1.3.2" xref="S3.E5.m1.7.7.3.3.1.1.1.3.2.cmml">f</mi><mi id="S3.E5.m1.7.7.3.3.1.1.1.3.3" xref="S3.E5.m1.7.7.3.3.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.3.3.1.1.1.2" xref="S3.E5.m1.7.7.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.7.7.3.3.1.1.1.1.1" xref="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.7.7.3.3.1.1.1.1.1.2" xref="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.7.7.3.3.1.1.1.1.1.1" xref="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.2.2" xref="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mrow id="S3.E5.m1.6.6.2.2.2.2" xref="S3.E5.m1.6.6.2.2.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.cmml">k</mi><mo id="S3.E5.m1.6.6.2.2.2.2.2" xref="S3.E5.m1.6.6.2.2.2.3.cmml">,</mo><mrow id="S3.E5.m1.6.6.2.2.2.2.1" xref="S3.E5.m1.6.6.2.2.2.2.1.cmml"><mi id="S3.E5.m1.6.6.2.2.2.2.1.2" xref="S3.E5.m1.6.6.2.2.2.2.1.2.cmml">t</mi><mo id="S3.E5.m1.6.6.2.2.2.2.1.1" xref="S3.E5.m1.6.6.2.2.2.2.1.1.cmml">−</mo><mn id="S3.E5.m1.6.6.2.2.2.2.1.3" xref="S3.E5.m1.6.6.2.2.2.2.1.3.cmml">1</mn></mrow></mrow><mo id="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.2.3" xref="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.E5.m1.7.7.3.3.1.1.1.1.1.3" xref="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E5.m1.7.7.3.3.1.1.3" xref="S3.E5.m1.7.7.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.E5.m1.7.7.5" xref="S3.E5.m1.7.7.5.cmml"><mo rspace="0em" id="S3.E5.m1.7.7.5.1" xref="S3.E5.m1.7.7.5.1.cmml">∂</mo><msubsup id="S3.E5.m1.7.7.5.2" xref="S3.E5.m1.7.7.5.2.cmml"><mi id="S3.E5.m1.7.7.5.2.2.2" xref="S3.E5.m1.7.7.5.2.2.2.cmml">𝒙</mi><mi id="S3.E5.m1.7.7.5.2.3" xref="S3.E5.m1.7.7.5.2.3.cmml">k</mi><mo id="S3.E5.m1.7.7.5.2.2.3" xref="S3.E5.m1.7.7.5.2.2.3.cmml">′</mo></msubsup></mrow></mfrac></mrow><mo lspace="0.392em" rspace="0.392em" id="S3.E5.m1.8.8.1.1.3.1a" xref="S3.E5.m1.8.8.1.1.3.1.cmml">+</mo><msub id="S3.E5.m1.8.8.1.1.3.4" xref="S3.E5.m1.8.8.1.1.3.4.cmml"><mi id="S3.E5.m1.8.8.1.1.3.4.2" xref="S3.E5.m1.8.8.1.1.3.4.2.cmml">ω</mi><mi id="S3.E5.m1.8.8.1.1.3.4.3" xref="S3.E5.m1.8.8.1.1.3.4.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.E5.m1.8.8.1.2" xref="S3.E5.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.8b"><apply id="S3.E5.m1.8.8.1.1.cmml" xref="S3.E5.m1.8.8.1"><eq id="S3.E5.m1.8.8.1.1.1.cmml" xref="S3.E5.m1.8.8.1.1.1"></eq><apply id="S3.E5.m1.8.8.1.1.2.cmml" xref="S3.E5.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.1.1.2.1.cmml" xref="S3.E5.m1.8.8.1.1.2">subscript</csymbol><apply id="S3.E5.m1.8.8.1.1.2.2.cmml" xref="S3.E5.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.1.1.2.2.1.cmml" xref="S3.E5.m1.8.8.1.1.2">superscript</csymbol><ci id="S3.E5.m1.8.8.1.1.2.2.2.cmml" xref="S3.E5.m1.8.8.1.1.2.2.2">𝒙</ci><ci id="S3.E5.m1.8.8.1.1.2.2.3.cmml" xref="S3.E5.m1.8.8.1.1.2.2.3">′</ci></apply><list id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.4"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑘</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E5.m1.8.8.1.1.3.cmml" xref="S3.E5.m1.8.8.1.1.3"><plus id="S3.E5.m1.8.8.1.1.3.1.cmml" xref="S3.E5.m1.8.8.1.1.3.1"></plus><apply id="S3.E5.m1.8.8.1.1.3.2.cmml" xref="S3.E5.m1.8.8.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.1.1.3.2.1.cmml" xref="S3.E5.m1.8.8.1.1.3.2">subscript</csymbol><apply id="S3.E5.m1.8.8.1.1.3.2.2.cmml" xref="S3.E5.m1.8.8.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.1.1.3.2.2.1.cmml" xref="S3.E5.m1.8.8.1.1.3.2">superscript</csymbol><ci id="S3.E5.m1.8.8.1.1.3.2.2.2.cmml" xref="S3.E5.m1.8.8.1.1.3.2.2.2">𝒙</ci><ci id="S3.E5.m1.8.8.1.1.3.2.2.3.cmml" xref="S3.E5.m1.8.8.1.1.3.2.2.3">′</ci></apply><list id="S3.E5.m1.4.4.2.3.cmml" xref="S3.E5.m1.4.4.2.2"><ci id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1.1">𝑘</ci><apply id="S3.E5.m1.4.4.2.2.1.cmml" xref="S3.E5.m1.4.4.2.2.1"><minus id="S3.E5.m1.4.4.2.2.1.1.cmml" xref="S3.E5.m1.4.4.2.2.1.1"></minus><ci id="S3.E5.m1.4.4.2.2.1.2.cmml" xref="S3.E5.m1.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="S3.E5.m1.4.4.2.2.1.3.cmml" xref="S3.E5.m1.4.4.2.2.1.3">1</cn></apply></list></apply><apply id="S3.E5.m1.8.8.1.1.3.3.cmml" xref="S3.E5.m1.8.8.1.1.3.3"><times id="S3.E5.m1.8.8.1.1.3.3.1.cmml" xref="S3.E5.m1.8.8.1.1.3.3.1"></times><apply id="S3.E5.m1.8.8.1.1.3.3.2.cmml" xref="S3.E5.m1.8.8.1.1.3.3.2"><divide id="S3.E5.m1.8.8.1.1.3.3.2.1.cmml" xref="S3.E5.m1.8.8.1.1.3.3.2"></divide><ci id="S3.E5.m1.8.8.1.1.3.3.2.2.cmml" xref="S3.E5.m1.8.8.1.1.3.3.2.2">𝜆</ci><cn type="integer" id="S3.E5.m1.8.8.1.1.3.3.2.3.cmml" xref="S3.E5.m1.8.8.1.1.3.3.2.3">2</cn></apply><apply id="S3.E5.m1.7.7.cmml" xref="S3.E5.m1.7.7"><divide id="S3.E5.m1.7.7.4.cmml" xref="S3.E5.m1.7.7"></divide><apply id="S3.E5.m1.7.7.3.cmml" xref="S3.E5.m1.7.7.3"><partialdiff id="S3.E5.m1.7.7.3.4.cmml" xref="S3.E5.m1.7.7.3.4"></partialdiff><apply id="S3.E5.m1.7.7.3.3.cmml" xref="S3.E5.m1.7.7.3.3"><times id="S3.E5.m1.7.7.3.3.2.cmml" xref="S3.E5.m1.7.7.3.3.2"></times><apply id="S3.E5.m1.7.7.3.3.3.cmml" xref="S3.E5.m1.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.3.3.3.1.cmml" xref="S3.E5.m1.7.7.3.3.3">subscript</csymbol><ci id="S3.E5.m1.7.7.3.3.3.2.cmml" xref="S3.E5.m1.7.7.3.3.3.2">𝐸</ci><ci id="S3.E5.m1.7.7.3.3.3.3.cmml" xref="S3.E5.m1.7.7.3.3.3.3">𝜽</ci></apply><apply id="S3.E5.m1.7.7.3.3.1.1.1.cmml" xref="S3.E5.m1.7.7.3.3.1.1"><times id="S3.E5.m1.7.7.3.3.1.1.1.2.cmml" xref="S3.E5.m1.7.7.3.3.1.1.1.2"></times><apply id="S3.E5.m1.7.7.3.3.1.1.1.3.cmml" xref="S3.E5.m1.7.7.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.3.3.1.1.1.3.1.cmml" xref="S3.E5.m1.7.7.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.7.7.3.3.1.1.1.3.2.cmml" xref="S3.E5.m1.7.7.3.3.1.1.1.3.2">𝑓</ci><ci id="S3.E5.m1.7.7.3.3.1.1.1.3.3.cmml" xref="S3.E5.m1.7.7.3.3.1.1.1.3.3">𝜽</ci></apply><apply id="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.3.3.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.7.7.3.3.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.7.7.3.3.1.1.1.1.1.1.2.3">′</ci></apply><list id="S3.E5.m1.6.6.2.2.2.3.cmml" xref="S3.E5.m1.6.6.2.2.2.2"><ci id="S3.E5.m1.5.5.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1">𝑘</ci><apply id="S3.E5.m1.6.6.2.2.2.2.1.cmml" xref="S3.E5.m1.6.6.2.2.2.2.1"><minus id="S3.E5.m1.6.6.2.2.2.2.1.1.cmml" xref="S3.E5.m1.6.6.2.2.2.2.1.1"></minus><ci id="S3.E5.m1.6.6.2.2.2.2.1.2.cmml" xref="S3.E5.m1.6.6.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S3.E5.m1.6.6.2.2.2.2.1.3.cmml" xref="S3.E5.m1.6.6.2.2.2.2.1.3">1</cn></apply></list></apply></apply></apply></apply><apply id="S3.E5.m1.7.7.5.cmml" xref="S3.E5.m1.7.7.5"><partialdiff id="S3.E5.m1.7.7.5.1.cmml" xref="S3.E5.m1.7.7.5.1"></partialdiff><apply id="S3.E5.m1.7.7.5.2.cmml" xref="S3.E5.m1.7.7.5.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.5.2.1.cmml" xref="S3.E5.m1.7.7.5.2">subscript</csymbol><apply id="S3.E5.m1.7.7.5.2.2.cmml" xref="S3.E5.m1.7.7.5.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.5.2.2.1.cmml" xref="S3.E5.m1.7.7.5.2">superscript</csymbol><ci id="S3.E5.m1.7.7.5.2.2.2.cmml" xref="S3.E5.m1.7.7.5.2.2.2">𝒙</ci><ci id="S3.E5.m1.7.7.5.2.2.3.cmml" xref="S3.E5.m1.7.7.5.2.2.3">′</ci></apply><ci id="S3.E5.m1.7.7.5.2.3.cmml" xref="S3.E5.m1.7.7.5.2.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E5.m1.8.8.1.1.3.4.cmml" xref="S3.E5.m1.8.8.1.1.3.4"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.1.1.3.4.1.cmml" xref="S3.E5.m1.8.8.1.1.3.4">subscript</csymbol><ci id="S3.E5.m1.8.8.1.1.3.4.2.cmml" xref="S3.E5.m1.8.8.1.1.3.4.2">𝜔</ci><ci id="S3.E5.m1.8.8.1.1.3.4.3.cmml" xref="S3.E5.m1.8.8.1.1.3.4.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.8c">{\boldsymbol{x}}^{\prime}_{k,t}\,=\,{\boldsymbol{x}}^{\prime}_{k,t-1}\,+\,\frac{\lambda}{2}\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}^{\prime}_{k,t-1}))}{\partial{\boldsymbol{x}}^{\prime}_{k}}\,+\,\omega_{t}\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.15" class="ltx_p">with <math id="S3.SS2.p2.6.m1.2" class="ltx_Math" alttext="{\boldsymbol{x}}^{\prime}_{k,t}" display="inline"><semantics id="S3.SS2.p2.6.m1.2a"><msubsup id="S3.SS2.p2.6.m1.2.3" xref="S3.SS2.p2.6.m1.2.3.cmml"><mi id="S3.SS2.p2.6.m1.2.3.2.2" xref="S3.SS2.p2.6.m1.2.3.2.2.cmml">𝒙</mi><mrow id="S3.SS2.p2.6.m1.2.2.2.4" xref="S3.SS2.p2.6.m1.2.2.2.3.cmml"><mi id="S3.SS2.p2.6.m1.1.1.1.1" xref="S3.SS2.p2.6.m1.1.1.1.1.cmml">k</mi><mo id="S3.SS2.p2.6.m1.2.2.2.4.1" xref="S3.SS2.p2.6.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p2.6.m1.2.2.2.2" xref="S3.SS2.p2.6.m1.2.2.2.2.cmml">t</mi></mrow><mo id="S3.SS2.p2.6.m1.2.3.2.3" xref="S3.SS2.p2.6.m1.2.3.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m1.2b"><apply id="S3.SS2.p2.6.m1.2.3.cmml" xref="S3.SS2.p2.6.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m1.2.3.1.cmml" xref="S3.SS2.p2.6.m1.2.3">subscript</csymbol><apply id="S3.SS2.p2.6.m1.2.3.2.cmml" xref="S3.SS2.p2.6.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m1.2.3.2.1.cmml" xref="S3.SS2.p2.6.m1.2.3">superscript</csymbol><ci id="S3.SS2.p2.6.m1.2.3.2.2.cmml" xref="S3.SS2.p2.6.m1.2.3.2.2">𝒙</ci><ci id="S3.SS2.p2.6.m1.2.3.2.3.cmml" xref="S3.SS2.p2.6.m1.2.3.2.3">′</ci></apply><list id="S3.SS2.p2.6.m1.2.2.2.3.cmml" xref="S3.SS2.p2.6.m1.2.2.2.4"><ci id="S3.SS2.p2.6.m1.1.1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1.1.1">𝑘</ci><ci id="S3.SS2.p2.6.m1.2.2.2.2.cmml" xref="S3.SS2.p2.6.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m1.2c">{\boldsymbol{x}}^{\prime}_{k,t}</annotation></semantics></math> denoting the <math id="S3.SS2.p2.7.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p2.7.m2.1a"><mi id="S3.SS2.p2.7.m2.1.1" xref="S3.SS2.p2.7.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m2.1b"><ci id="S3.SS2.p2.7.m2.1.1.cmml" xref="S3.SS2.p2.7.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m2.1c">t</annotation></semantics></math>th iteration in the Markov chain for generating the <math id="S3.SS2.p2.8.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p2.8.m3.1a"><mi id="S3.SS2.p2.8.m3.1.1" xref="S3.SS2.p2.8.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m3.1b"><ci id="S3.SS2.p2.8.m3.1.1.cmml" xref="S3.SS2.p2.8.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m3.1c">k</annotation></semantics></math>th instance, <math id="S3.SS2.p2.9.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p2.9.m4.1a"><mi id="S3.SS2.p2.9.m4.1.1" xref="S3.SS2.p2.9.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m4.1b"><ci id="S3.SS2.p2.9.m4.1.1.cmml" xref="S3.SS2.p2.9.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m4.1c">\lambda</annotation></semantics></math> being the step size, <math id="S3.SS2.p2.10.m5.2" class="ltx_Math" alttext="\omega_{t}\sim\mathcal{N}(0,\lambda)" display="inline"><semantics id="S3.SS2.p2.10.m5.2a"><mrow id="S3.SS2.p2.10.m5.2.3" xref="S3.SS2.p2.10.m5.2.3.cmml"><msub id="S3.SS2.p2.10.m5.2.3.2" xref="S3.SS2.p2.10.m5.2.3.2.cmml"><mi id="S3.SS2.p2.10.m5.2.3.2.2" xref="S3.SS2.p2.10.m5.2.3.2.2.cmml">ω</mi><mi id="S3.SS2.p2.10.m5.2.3.2.3" xref="S3.SS2.p2.10.m5.2.3.2.3.cmml">t</mi></msub><mo id="S3.SS2.p2.10.m5.2.3.1" xref="S3.SS2.p2.10.m5.2.3.1.cmml">∼</mo><mrow id="S3.SS2.p2.10.m5.2.3.3" xref="S3.SS2.p2.10.m5.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.10.m5.2.3.3.2" xref="S3.SS2.p2.10.m5.2.3.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.10.m5.2.3.3.1" xref="S3.SS2.p2.10.m5.2.3.3.1.cmml">​</mo><mrow id="S3.SS2.p2.10.m5.2.3.3.3.2" xref="S3.SS2.p2.10.m5.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.10.m5.2.3.3.3.2.1" xref="S3.SS2.p2.10.m5.2.3.3.3.1.cmml">(</mo><mn id="S3.SS2.p2.10.m5.1.1" xref="S3.SS2.p2.10.m5.1.1.cmml">0</mn><mo id="S3.SS2.p2.10.m5.2.3.3.3.2.2" xref="S3.SS2.p2.10.m5.2.3.3.3.1.cmml">,</mo><mi id="S3.SS2.p2.10.m5.2.2" xref="S3.SS2.p2.10.m5.2.2.cmml">λ</mi><mo stretchy="false" id="S3.SS2.p2.10.m5.2.3.3.3.2.3" xref="S3.SS2.p2.10.m5.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m5.2b"><apply id="S3.SS2.p2.10.m5.2.3.cmml" xref="S3.SS2.p2.10.m5.2.3"><csymbol cd="latexml" id="S3.SS2.p2.10.m5.2.3.1.cmml" xref="S3.SS2.p2.10.m5.2.3.1">similar-to</csymbol><apply id="S3.SS2.p2.10.m5.2.3.2.cmml" xref="S3.SS2.p2.10.m5.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m5.2.3.2.1.cmml" xref="S3.SS2.p2.10.m5.2.3.2">subscript</csymbol><ci id="S3.SS2.p2.10.m5.2.3.2.2.cmml" xref="S3.SS2.p2.10.m5.2.3.2.2">𝜔</ci><ci id="S3.SS2.p2.10.m5.2.3.2.3.cmml" xref="S3.SS2.p2.10.m5.2.3.2.3">𝑡</ci></apply><apply id="S3.SS2.p2.10.m5.2.3.3.cmml" xref="S3.SS2.p2.10.m5.2.3.3"><times id="S3.SS2.p2.10.m5.2.3.3.1.cmml" xref="S3.SS2.p2.10.m5.2.3.3.1"></times><ci id="S3.SS2.p2.10.m5.2.3.3.2.cmml" xref="S3.SS2.p2.10.m5.2.3.3.2">𝒩</ci><interval closure="open" id="S3.SS2.p2.10.m5.2.3.3.3.1.cmml" xref="S3.SS2.p2.10.m5.2.3.3.3.2"><cn type="integer" id="S3.SS2.p2.10.m5.1.1.cmml" xref="S3.SS2.p2.10.m5.1.1">0</cn><ci id="S3.SS2.p2.10.m5.2.2.cmml" xref="S3.SS2.p2.10.m5.2.2">𝜆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m5.2c">\omega_{t}\sim\mathcal{N}(0,\lambda)</annotation></semantics></math>, and <math id="S3.SS2.p2.11.m6.2" class="ltx_Math" alttext="{\boldsymbol{x}}^{\prime}_{k,0}" display="inline"><semantics id="S3.SS2.p2.11.m6.2a"><msubsup id="S3.SS2.p2.11.m6.2.3" xref="S3.SS2.p2.11.m6.2.3.cmml"><mi id="S3.SS2.p2.11.m6.2.3.2.2" xref="S3.SS2.p2.11.m6.2.3.2.2.cmml">𝒙</mi><mrow id="S3.SS2.p2.11.m6.2.2.2.4" xref="S3.SS2.p2.11.m6.2.2.2.3.cmml"><mi id="S3.SS2.p2.11.m6.1.1.1.1" xref="S3.SS2.p2.11.m6.1.1.1.1.cmml">k</mi><mo id="S3.SS2.p2.11.m6.2.2.2.4.1" xref="S3.SS2.p2.11.m6.2.2.2.3.cmml">,</mo><mn id="S3.SS2.p2.11.m6.2.2.2.2" xref="S3.SS2.p2.11.m6.2.2.2.2.cmml">0</mn></mrow><mo id="S3.SS2.p2.11.m6.2.3.2.3" xref="S3.SS2.p2.11.m6.2.3.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m6.2b"><apply id="S3.SS2.p2.11.m6.2.3.cmml" xref="S3.SS2.p2.11.m6.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m6.2.3.1.cmml" xref="S3.SS2.p2.11.m6.2.3">subscript</csymbol><apply id="S3.SS2.p2.11.m6.2.3.2.cmml" xref="S3.SS2.p2.11.m6.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m6.2.3.2.1.cmml" xref="S3.SS2.p2.11.m6.2.3">superscript</csymbol><ci id="S3.SS2.p2.11.m6.2.3.2.2.cmml" xref="S3.SS2.p2.11.m6.2.3.2.2">𝒙</ci><ci id="S3.SS2.p2.11.m6.2.3.2.3.cmml" xref="S3.SS2.p2.11.m6.2.3.2.3">′</ci></apply><list id="S3.SS2.p2.11.m6.2.2.2.3.cmml" xref="S3.SS2.p2.11.m6.2.2.2.4"><ci id="S3.SS2.p2.11.m6.1.1.1.1.cmml" xref="S3.SS2.p2.11.m6.1.1.1.1">𝑘</ci><cn type="integer" id="S3.SS2.p2.11.m6.2.2.2.2.cmml" xref="S3.SS2.p2.11.m6.2.2.2.2">0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m6.2c">{\boldsymbol{x}}^{\prime}_{k,0}</annotation></semantics></math> initialized as uniform random noise.
The procedure defines a distribution <math id="S3.SS2.p2.12.m7.1" class="ltx_Math" alttext="q_{{\boldsymbol{\theta}}}" display="inline"><semantics id="S3.SS2.p2.12.m7.1a"><msub id="S3.SS2.p2.12.m7.1.1" xref="S3.SS2.p2.12.m7.1.1.cmml"><mi id="S3.SS2.p2.12.m7.1.1.2" xref="S3.SS2.p2.12.m7.1.1.2.cmml">q</mi><mi id="S3.SS2.p2.12.m7.1.1.3" xref="S3.SS2.p2.12.m7.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m7.1b"><apply id="S3.SS2.p2.12.m7.1.1.cmml" xref="S3.SS2.p2.12.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m7.1.1.1.cmml" xref="S3.SS2.p2.12.m7.1.1">subscript</csymbol><ci id="S3.SS2.p2.12.m7.1.1.2.cmml" xref="S3.SS2.p2.12.m7.1.1.2">𝑞</ci><ci id="S3.SS2.p2.12.m7.1.1.3.cmml" xref="S3.SS2.p2.12.m7.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m7.1c">q_{{\boldsymbol{\theta}}}</annotation></semantics></math> such that, if <math id="S3.SS2.p2.13.m8.1" class="ltx_Math" alttext="t\!\!\rightarrow\!\infty" display="inline"><semantics id="S3.SS2.p2.13.m8.1a"><mrow id="S3.SS2.p2.13.m8.1.1" xref="S3.SS2.p2.13.m8.1.1.cmml"><mpadded width="0.309em"><mi id="S3.SS2.p2.13.m8.1.1.2" xref="S3.SS2.p2.13.m8.1.1.2.cmml">t</mi></mpadded><mo rspace="0.108em" stretchy="false" id="S3.SS2.p2.13.m8.1.1.1" xref="S3.SS2.p2.13.m8.1.1.1.cmml">→</mo><mi mathvariant="normal" id="S3.SS2.p2.13.m8.1.1.3" xref="S3.SS2.p2.13.m8.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m8.1b"><apply id="S3.SS2.p2.13.m8.1.1.cmml" xref="S3.SS2.p2.13.m8.1.1"><ci id="S3.SS2.p2.13.m8.1.1.1.cmml" xref="S3.SS2.p2.13.m8.1.1.1">→</ci><ci id="S3.SS2.p2.13.m8.1.1.2.cmml" xref="S3.SS2.p2.13.m8.1.1.2">𝑡</ci><infinity id="S3.SS2.p2.13.m8.1.1.3.cmml" xref="S3.SS2.p2.13.m8.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m8.1c">t\!\!\rightarrow\!\infty</annotation></semantics></math> and <math id="S3.SS2.p2.14.m9.1" class="ltx_Math" alttext="\lambda\!\rightarrow\!0" display="inline"><semantics id="S3.SS2.p2.14.m9.1a"><mrow id="S3.SS2.p2.14.m9.1.1" xref="S3.SS2.p2.14.m9.1.1.cmml"><mi id="S3.SS2.p2.14.m9.1.1.2" xref="S3.SS2.p2.14.m9.1.1.2.cmml">λ</mi><mo lspace="0.108em" rspace="0.108em" stretchy="false" id="S3.SS2.p2.14.m9.1.1.1" xref="S3.SS2.p2.14.m9.1.1.1.cmml">→</mo><mn id="S3.SS2.p2.14.m9.1.1.3" xref="S3.SS2.p2.14.m9.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.m9.1b"><apply id="S3.SS2.p2.14.m9.1.1.cmml" xref="S3.SS2.p2.14.m9.1.1"><ci id="S3.SS2.p2.14.m9.1.1.1.cmml" xref="S3.SS2.p2.14.m9.1.1.1">→</ci><ci id="S3.SS2.p2.14.m9.1.1.2.cmml" xref="S3.SS2.p2.14.m9.1.1.2">𝜆</ci><cn type="integer" id="S3.SS2.p2.14.m9.1.1.3.cmml" xref="S3.SS2.p2.14.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.m9.1c">\lambda\!\rightarrow\!0</annotation></semantics></math>, then <math id="S3.SS2.p2.15.m10.1" class="ltx_Math" alttext="q_{{\boldsymbol{\theta}}}\!\rightarrow\!p_{{\boldsymbol{\theta}}}" display="inline"><semantics id="S3.SS2.p2.15.m10.1a"><mrow id="S3.SS2.p2.15.m10.1.1" xref="S3.SS2.p2.15.m10.1.1.cmml"><msub id="S3.SS2.p2.15.m10.1.1.2" xref="S3.SS2.p2.15.m10.1.1.2.cmml"><mi id="S3.SS2.p2.15.m10.1.1.2.2" xref="S3.SS2.p2.15.m10.1.1.2.2.cmml">q</mi><mi id="S3.SS2.p2.15.m10.1.1.2.3" xref="S3.SS2.p2.15.m10.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0.108em" rspace="0.108em" stretchy="false" id="S3.SS2.p2.15.m10.1.1.1" xref="S3.SS2.p2.15.m10.1.1.1.cmml">→</mo><msub id="S3.SS2.p2.15.m10.1.1.3" xref="S3.SS2.p2.15.m10.1.1.3.cmml"><mi id="S3.SS2.p2.15.m10.1.1.3.2" xref="S3.SS2.p2.15.m10.1.1.3.2.cmml">p</mi><mi id="S3.SS2.p2.15.m10.1.1.3.3" xref="S3.SS2.p2.15.m10.1.1.3.3.cmml">𝜽</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.15.m10.1b"><apply id="S3.SS2.p2.15.m10.1.1.cmml" xref="S3.SS2.p2.15.m10.1.1"><ci id="S3.SS2.p2.15.m10.1.1.1.cmml" xref="S3.SS2.p2.15.m10.1.1.1">→</ci><apply id="S3.SS2.p2.15.m10.1.1.2.cmml" xref="S3.SS2.p2.15.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.15.m10.1.1.2.1.cmml" xref="S3.SS2.p2.15.m10.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.15.m10.1.1.2.2.cmml" xref="S3.SS2.p2.15.m10.1.1.2.2">𝑞</ci><ci id="S3.SS2.p2.15.m10.1.1.2.3.cmml" xref="S3.SS2.p2.15.m10.1.1.2.3">𝜽</ci></apply><apply id="S3.SS2.p2.15.m10.1.1.3.cmml" xref="S3.SS2.p2.15.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.15.m10.1.1.3.1.cmml" xref="S3.SS2.p2.15.m10.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.15.m10.1.1.3.2.cmml" xref="S3.SS2.p2.15.m10.1.1.3.2">𝑝</ci><ci id="S3.SS2.p2.15.m10.1.1.3.3.cmml" xref="S3.SS2.p2.15.m10.1.1.3.3">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.15.m10.1c">q_{{\boldsymbol{\theta}}}\!\rightarrow\!p_{{\boldsymbol{\theta}}}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite>.
In practice, we differentiate only through the last step to reduce the computational cost as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. The model is trained with a contrastive divergence objective <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. This minimizes the energy of the training data and maximizes that of the generated samples, as illustrated in Figure <a href="#S3.F1" title="Figure 1 ‣ 3.2 Energy-based models ‣ 3 Background ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The alternatives for training EBMs where the normalizer is approximated using a generator network is proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> that helps mitigate part of these practical limitations.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2206.14355/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="120" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S3.F1.3.2" class="ltx_text" style="font-size:90%;">High-level illustration of the training of an EBM.</span></figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Contrastive learning</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Contrastive learning (CL) is another self-supervised technique whose core idea is to learn data representations such that similar samples are grouped together and dissimilar ones are pushed apart. In the absence of ground-truth annotations, all training examples are considered “dissimilar” from one another. “Similar” pairs are obtained by generating several views of each example with data augmentations (<em id="S3.SS3.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS3.p1.1.2" class="ltx_text"></span> hard-coded transformations that do not affect the semantic contents of the image).
The key components of CL are

<span id="S3.I2" class="ltx_inline-enumerate">
<span id="S3.I2.i1" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item">(1)</span> <span id="S3.I2.i1.1" class="ltx_text">the data augmentations,
</span></span>
<span id="S3.I2.i2" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item">(2)</span> <span id="S3.I2.i2.1" class="ltx_text">the encoding function mapping pixels to the embedding space, and
</span></span>
<span id="S3.I2.i3" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item">(3)</span> <span id="S3.I2.i3.1" class="ltx_text">the contrastive loss that maximizes the similarity between encodings of similar pairs and minimizes that of dissimilar ones, as illustrated in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.3 Contrastive learning ‣ 3 Background ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
</span></span>
</span></p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.3" class="ltx_p">On a high level, CL proceeds as follows.
Each training example <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="{\boldsymbol{x}}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">{\boldsymbol{x}}</annotation></semantics></math> is transformed with two sets of augmentations into a pair of views <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\widetilde{\boldsymbol{x}}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mover accent="true" id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">𝒙</mi><mo id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><ci id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1">~</ci><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\widetilde{\boldsymbol{x}}</annotation></semantics></math> and <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\widetilde{\boldsymbol{x}}^{\prime}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msup id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mover accent="true" id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml">𝒙</mi><mo id="S3.SS3.p2.3.m3.1.1.2.1" xref="S3.SS3.p2.3.m3.1.1.2.1.cmml">~</mo></mover><mo id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2"><ci id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1">~</ci><ci id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">𝒙</ci></apply><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\widetilde{\boldsymbol{x}}^{\prime}</annotation></semantics></math>.
They are passed through an encoding function such as a CNN to obtain representations. These form a <em id="S3.SS3.p2.3.1" class="ltx_emph ltx_font_italic">positive</em> pair, while combinations of views from different examples form <em id="S3.SS3.p2.3.2" class="ltx_emph ltx_font_italic">negative</em> pairs.
The training objective then maximizes the similarity of positive pairs while minimizing that of negative ones.
A common implementation of this objective is the normalized temperature-scaled cross-entropy loss over the cosine similarity of representations:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.7" class="ltx_Math" alttext="\text{score}(\widetilde{\boldsymbol{x}},\widetilde{\boldsymbol{x}}^{\prime})~{}=~{}\frac{f_{{\boldsymbol{\theta}}}(\widetilde{\boldsymbol{x}})^{\top}f_{{\boldsymbol{\theta}}}(\widetilde{\boldsymbol{x}}^{\prime})}{\tau\|f_{{\boldsymbol{\theta}}}(\widetilde{\boldsymbol{x}})\|\|f_{{\boldsymbol{\theta}}}(\widetilde{\boldsymbol{x}}^{\prime})\|}~{}," display="block"><semantics id="S3.E6.m1.7a"><mrow id="S3.E6.m1.7.7.1" xref="S3.E6.m1.7.7.1.1.cmml"><mrow id="S3.E6.m1.7.7.1.1" xref="S3.E6.m1.7.7.1.1.cmml"><mrow id="S3.E6.m1.7.7.1.1.1" xref="S3.E6.m1.7.7.1.1.1.cmml"><mtext id="S3.E6.m1.7.7.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.3a.cmml">score</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.7.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.7.7.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.7.7.1.1.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.1.2.cmml">(</mo><mover accent="true" id="S3.E6.m1.6.6" xref="S3.E6.m1.6.6.cmml"><mi id="S3.E6.m1.6.6.2" xref="S3.E6.m1.6.6.2.cmml">𝒙</mi><mo id="S3.E6.m1.6.6.1" xref="S3.E6.m1.6.6.1.cmml">~</mo></mover><mo id="S3.E6.m1.7.7.1.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.2.cmml">,</mo><msup id="S3.E6.m1.7.7.1.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E6.m1.7.7.1.1.1.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.2.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3.cmml">′</mo></msup><mo rspace="0.330em" stretchy="false" id="S3.E6.m1.7.7.1.1.1.1.1.4" xref="S3.E6.m1.7.7.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.608em" id="S3.E6.m1.7.7.1.1.2" xref="S3.E6.m1.7.7.1.1.2.cmml">=</mo><mfrac id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml"><mrow id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml"><msub id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.4.cmml"><mi id="S3.E6.m1.2.2.2.4.2" xref="S3.E6.m1.2.2.2.4.2.cmml">f</mi><mi id="S3.E6.m1.2.2.2.4.3" xref="S3.E6.m1.2.2.2.4.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.3" xref="S3.E6.m1.2.2.2.3.cmml">​</mo><msup id="S3.E6.m1.2.2.2.5" xref="S3.E6.m1.2.2.2.5.cmml"><mrow id="S3.E6.m1.2.2.2.5.2.2" xref="S3.E6.m1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.2.5.2.2.1" xref="S3.E6.m1.1.1.1.1.cmml">(</mo><mover accent="true" id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml">𝒙</mi><mo id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="S3.E6.m1.2.2.2.5.2.2.2" xref="S3.E6.m1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E6.m1.2.2.2.5.3" xref="S3.E6.m1.2.2.2.5.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.3a" xref="S3.E6.m1.2.2.2.3.cmml">​</mo><msub id="S3.E6.m1.2.2.2.6" xref="S3.E6.m1.2.2.2.6.cmml"><mi id="S3.E6.m1.2.2.2.6.2" xref="S3.E6.m1.2.2.2.6.2.cmml">f</mi><mi id="S3.E6.m1.2.2.2.6.3" xref="S3.E6.m1.2.2.2.6.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.3b" xref="S3.E6.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E6.m1.2.2.2.2.1" xref="S3.E6.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.2.2.1.2" xref="S3.E6.m1.2.2.2.2.1.1.cmml">(</mo><msup id="S3.E6.m1.2.2.2.2.1.1" xref="S3.E6.m1.2.2.2.2.1.1.cmml"><mover accent="true" id="S3.E6.m1.2.2.2.2.1.1.2" xref="S3.E6.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.E6.m1.2.2.2.2.1.1.2.2" xref="S3.E6.m1.2.2.2.2.1.1.2.2.cmml">𝒙</mi><mo id="S3.E6.m1.2.2.2.2.1.1.2.1" xref="S3.E6.m1.2.2.2.2.1.1.2.1.cmml">~</mo></mover><mo id="S3.E6.m1.2.2.2.2.1.1.3" xref="S3.E6.m1.2.2.2.2.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S3.E6.m1.2.2.2.2.1.3" xref="S3.E6.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E6.m1.5.5.5" xref="S3.E6.m1.5.5.5.cmml"><mi id="S3.E6.m1.5.5.5.5" xref="S3.E6.m1.5.5.5.5.cmml">τ</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.5.4" xref="S3.E6.m1.5.5.5.4.cmml">​</mo><mrow id="S3.E6.m1.4.4.4.2.1" xref="S3.E6.m1.4.4.4.2.2.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.4.2.1.2" xref="S3.E6.m1.4.4.4.2.2.1.cmml">‖</mo><mrow id="S3.E6.m1.4.4.4.2.1.1" xref="S3.E6.m1.4.4.4.2.1.1.cmml"><msub id="S3.E6.m1.4.4.4.2.1.1.2" xref="S3.E6.m1.4.4.4.2.1.1.2.cmml"><mi id="S3.E6.m1.4.4.4.2.1.1.2.2" xref="S3.E6.m1.4.4.4.2.1.1.2.2.cmml">f</mi><mi id="S3.E6.m1.4.4.4.2.1.1.2.3" xref="S3.E6.m1.4.4.4.2.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.4.4.2.1.1.1" xref="S3.E6.m1.4.4.4.2.1.1.1.cmml">​</mo><mrow id="S3.E6.m1.4.4.4.2.1.1.3.2" xref="S3.E6.m1.3.3.3.1.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.4.2.1.1.3.2.1" xref="S3.E6.m1.3.3.3.1.cmml">(</mo><mover accent="true" id="S3.E6.m1.3.3.3.1" xref="S3.E6.m1.3.3.3.1.cmml"><mi id="S3.E6.m1.3.3.3.1.2" xref="S3.E6.m1.3.3.3.1.2.cmml">𝒙</mi><mo id="S3.E6.m1.3.3.3.1.1" xref="S3.E6.m1.3.3.3.1.1.cmml">~</mo></mover><mo stretchy="false" id="S3.E6.m1.4.4.4.2.1.1.3.2.2" xref="S3.E6.m1.3.3.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.4.4.4.2.1.3" xref="S3.E6.m1.4.4.4.2.2.1.cmml">‖</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.5.4a" xref="S3.E6.m1.5.5.5.4.cmml">​</mo><mrow id="S3.E6.m1.5.5.5.3.1" xref="S3.E6.m1.5.5.5.3.2.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.5.3.1.2" xref="S3.E6.m1.5.5.5.3.2.1.cmml">‖</mo><mrow id="S3.E6.m1.5.5.5.3.1.1" xref="S3.E6.m1.5.5.5.3.1.1.cmml"><msub id="S3.E6.m1.5.5.5.3.1.1.3" xref="S3.E6.m1.5.5.5.3.1.1.3.cmml"><mi id="S3.E6.m1.5.5.5.3.1.1.3.2" xref="S3.E6.m1.5.5.5.3.1.1.3.2.cmml">f</mi><mi id="S3.E6.m1.5.5.5.3.1.1.3.3" xref="S3.E6.m1.5.5.5.3.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.5.3.1.1.2" xref="S3.E6.m1.5.5.5.3.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.5.5.5.3.1.1.1.1" xref="S3.E6.m1.5.5.5.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.5.3.1.1.1.1.2" xref="S3.E6.m1.5.5.5.3.1.1.1.1.1.cmml">(</mo><msup id="S3.E6.m1.5.5.5.3.1.1.1.1.1" xref="S3.E6.m1.5.5.5.3.1.1.1.1.1.cmml"><mover accent="true" id="S3.E6.m1.5.5.5.3.1.1.1.1.1.2" xref="S3.E6.m1.5.5.5.3.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.5.5.5.3.1.1.1.1.1.2.2" xref="S3.E6.m1.5.5.5.3.1.1.1.1.1.2.2.cmml">𝒙</mi><mo id="S3.E6.m1.5.5.5.3.1.1.1.1.1.2.1" xref="S3.E6.m1.5.5.5.3.1.1.1.1.1.2.1.cmml">~</mo></mover><mo id="S3.E6.m1.5.5.5.3.1.1.1.1.1.3" xref="S3.E6.m1.5.5.5.3.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S3.E6.m1.5.5.5.3.1.1.1.1.3" xref="S3.E6.m1.5.5.5.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.5.5.5.3.1.3" xref="S3.E6.m1.5.5.5.3.2.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><mo lspace="0.330em" id="S3.E6.m1.7.7.1.2" xref="S3.E6.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.7b"><apply id="S3.E6.m1.7.7.1.1.cmml" xref="S3.E6.m1.7.7.1"><eq id="S3.E6.m1.7.7.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.2"></eq><apply id="S3.E6.m1.7.7.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1"><times id="S3.E6.m1.7.7.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.2"></times><ci id="S3.E6.m1.7.7.1.1.1.3a.cmml" xref="S3.E6.m1.7.7.1.1.1.3"><mtext id="S3.E6.m1.7.7.1.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.1.3">score</mtext></ci><interval closure="open" id="S3.E6.m1.7.7.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1"><apply id="S3.E6.m1.6.6.cmml" xref="S3.E6.m1.6.6"><ci id="S3.E6.m1.6.6.1.cmml" xref="S3.E6.m1.6.6.1">~</ci><ci id="S3.E6.m1.6.6.2.cmml" xref="S3.E6.m1.6.6.2">𝒙</ci></apply><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2"><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2">𝒙</ci></apply><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3">′</ci></apply></interval></apply><apply id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5"><divide id="S3.E6.m1.5.5.6.cmml" xref="S3.E6.m1.5.5"></divide><apply id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"><times id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.3"></times><apply id="S3.E6.m1.2.2.2.4.cmml" xref="S3.E6.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.4.1.cmml" xref="S3.E6.m1.2.2.2.4">subscript</csymbol><ci id="S3.E6.m1.2.2.2.4.2.cmml" xref="S3.E6.m1.2.2.2.4.2">𝑓</ci><ci id="S3.E6.m1.2.2.2.4.3.cmml" xref="S3.E6.m1.2.2.2.4.3">𝜽</ci></apply><apply id="S3.E6.m1.2.2.2.5.cmml" xref="S3.E6.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.5.1.cmml" xref="S3.E6.m1.2.2.2.5">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.5.2.2"><ci id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1">~</ci><ci id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2">𝒙</ci></apply><csymbol cd="latexml" id="S3.E6.m1.2.2.2.5.3.cmml" xref="S3.E6.m1.2.2.2.5.3">top</csymbol></apply><apply id="S3.E6.m1.2.2.2.6.cmml" xref="S3.E6.m1.2.2.2.6"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.6.1.cmml" xref="S3.E6.m1.2.2.2.6">subscript</csymbol><ci id="S3.E6.m1.2.2.2.6.2.cmml" xref="S3.E6.m1.2.2.2.6.2">𝑓</ci><ci id="S3.E6.m1.2.2.2.6.3.cmml" xref="S3.E6.m1.2.2.2.6.3">𝜽</ci></apply><apply id="S3.E6.m1.2.2.2.2.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1">superscript</csymbol><apply id="S3.E6.m1.2.2.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.2"><ci id="S3.E6.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1.2.1">~</ci><ci id="S3.E6.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.2.2">𝒙</ci></apply><ci id="S3.E6.m1.2.2.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.2.2.1.1.3">′</ci></apply></apply><apply id="S3.E6.m1.5.5.5.cmml" xref="S3.E6.m1.5.5.5"><times id="S3.E6.m1.5.5.5.4.cmml" xref="S3.E6.m1.5.5.5.4"></times><ci id="S3.E6.m1.5.5.5.5.cmml" xref="S3.E6.m1.5.5.5.5">𝜏</ci><apply id="S3.E6.m1.4.4.4.2.2.cmml" xref="S3.E6.m1.4.4.4.2.1"><csymbol cd="latexml" id="S3.E6.m1.4.4.4.2.2.1.cmml" xref="S3.E6.m1.4.4.4.2.1.2">norm</csymbol><apply id="S3.E6.m1.4.4.4.2.1.1.cmml" xref="S3.E6.m1.4.4.4.2.1.1"><times id="S3.E6.m1.4.4.4.2.1.1.1.cmml" xref="S3.E6.m1.4.4.4.2.1.1.1"></times><apply id="S3.E6.m1.4.4.4.2.1.1.2.cmml" xref="S3.E6.m1.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.4.2.1.1.2.1.cmml" xref="S3.E6.m1.4.4.4.2.1.1.2">subscript</csymbol><ci id="S3.E6.m1.4.4.4.2.1.1.2.2.cmml" xref="S3.E6.m1.4.4.4.2.1.1.2.2">𝑓</ci><ci id="S3.E6.m1.4.4.4.2.1.1.2.3.cmml" xref="S3.E6.m1.4.4.4.2.1.1.2.3">𝜽</ci></apply><apply id="S3.E6.m1.3.3.3.1.cmml" xref="S3.E6.m1.4.4.4.2.1.1.3.2"><ci id="S3.E6.m1.3.3.3.1.1.cmml" xref="S3.E6.m1.3.3.3.1.1">~</ci><ci id="S3.E6.m1.3.3.3.1.2.cmml" xref="S3.E6.m1.3.3.3.1.2">𝒙</ci></apply></apply></apply><apply id="S3.E6.m1.5.5.5.3.2.cmml" xref="S3.E6.m1.5.5.5.3.1"><csymbol cd="latexml" id="S3.E6.m1.5.5.5.3.2.1.cmml" xref="S3.E6.m1.5.5.5.3.1.2">norm</csymbol><apply id="S3.E6.m1.5.5.5.3.1.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1"><times id="S3.E6.m1.5.5.5.3.1.1.2.cmml" xref="S3.E6.m1.5.5.5.3.1.1.2"></times><apply id="S3.E6.m1.5.5.5.3.1.1.3.cmml" xref="S3.E6.m1.5.5.5.3.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.5.3.1.1.3.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1.3">subscript</csymbol><ci id="S3.E6.m1.5.5.5.3.1.1.3.2.cmml" xref="S3.E6.m1.5.5.5.3.1.1.3.2">𝑓</ci><ci id="S3.E6.m1.5.5.5.3.1.1.3.3.cmml" xref="S3.E6.m1.5.5.5.3.1.1.3.3">𝜽</ci></apply><apply id="S3.E6.m1.5.5.5.3.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.5.3.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.5.5.5.3.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.5.3.1.1.1.1.1.2"><ci id="S3.E6.m1.5.5.5.3.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.5.5.5.3.1.1.1.1.1.2.1">~</ci><ci id="S3.E6.m1.5.5.5.3.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.5.5.5.3.1.1.1.1.1.2.2">𝒙</ci></apply><ci id="S3.E6.m1.5.5.5.3.1.1.1.1.1.3.cmml" xref="S3.E6.m1.5.5.5.3.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.7c">\text{score}(\widetilde{\boldsymbol{x}},\widetilde{\boldsymbol{x}}^{\prime})~{}=~{}\frac{f_{{\boldsymbol{\theta}}}(\widetilde{\boldsymbol{x}})^{\top}f_{{\boldsymbol{\theta}}}(\widetilde{\boldsymbol{x}}^{\prime})}{\tau\|f_{{\boldsymbol{\theta}}}(\widetilde{\boldsymbol{x}})\|\|f_{{\boldsymbol{\theta}}}(\widetilde{\boldsymbol{x}}^{\prime})\|}~{},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.4" class="ltx_p">where <math id="S3.SS3.p2.4.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS3.p2.4.m1.1a"><mi id="S3.SS3.p2.4.m1.1.1" xref="S3.SS3.p2.4.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m1.1b"><ci id="S3.SS3.p2.4.m1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m1.1c">\tau</annotation></semantics></math> is a temperature hyperparameter. Further,</p>
<table id="A1.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex2.m1.1" class="ltx_Math" alttext="\displaystyle Z_{\text{CL}}({\boldsymbol{\theta}})" display="inline"><semantics id="S3.Ex2.m1.1a"><mrow id="S3.Ex2.m1.1.2" xref="S3.Ex2.m1.1.2.cmml"><msub id="S3.Ex2.m1.1.2.2" xref="S3.Ex2.m1.1.2.2.cmml"><mi id="S3.Ex2.m1.1.2.2.2" xref="S3.Ex2.m1.1.2.2.2.cmml">Z</mi><mtext id="S3.Ex2.m1.1.2.2.3" xref="S3.Ex2.m1.1.2.2.3a.cmml">CL</mtext></msub><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.1.2.1" xref="S3.Ex2.m1.1.2.1.cmml">​</mo><mrow id="S3.Ex2.m1.1.2.3.2" xref="S3.Ex2.m1.1.2.cmml"><mo stretchy="false" id="S3.Ex2.m1.1.2.3.2.1" xref="S3.Ex2.m1.1.2.cmml">(</mo><mi id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S3.Ex2.m1.1.2.3.2.2" xref="S3.Ex2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><apply id="S3.Ex2.m1.1.2.cmml" xref="S3.Ex2.m1.1.2"><times id="S3.Ex2.m1.1.2.1.cmml" xref="S3.Ex2.m1.1.2.1"></times><apply id="S3.Ex2.m1.1.2.2.cmml" xref="S3.Ex2.m1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.2.2.1.cmml" xref="S3.Ex2.m1.1.2.2">subscript</csymbol><ci id="S3.Ex2.m1.1.2.2.2.cmml" xref="S3.Ex2.m1.1.2.2.2">𝑍</ci><ci id="S3.Ex2.m1.1.2.2.3a.cmml" xref="S3.Ex2.m1.1.2.2.3"><mtext mathsize="70%" id="S3.Ex2.m1.1.2.2.3.cmml" xref="S3.Ex2.m1.1.2.2.3">CL</mtext></ci></apply><ci id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\displaystyle Z_{\text{CL}}({\boldsymbol{\theta}})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2.m2.3" class="ltx_Math" alttext="\displaystyle~{}=~{}{\sum_{k}^{K}\exp(\text{score}(f_{{\boldsymbol{\theta}}}(\widetilde{\boldsymbol{x}}),f_{{\boldsymbol{\theta}}}(\widetilde{\boldsymbol{x}}_{k})))}\quad{\boldsymbol{x}}\neq{\boldsymbol{x}}_{k}~{}." display="inline"><semantics id="S3.Ex2.m2.3a"><mrow id="S3.Ex2.m2.3.3.1"><mrow id="S3.Ex2.m2.3.3.1.1.2" xref="S3.Ex2.m2.3.3.1.1.3.cmml"><mrow id="S3.Ex2.m2.3.3.1.1.1.1" xref="S3.Ex2.m2.3.3.1.1.1.1.cmml"><mi id="S3.Ex2.m2.3.3.1.1.1.1.3" xref="S3.Ex2.m2.3.3.1.1.1.1.3.cmml"></mi><mo lspace="0.608em" rspace="0.608em" id="S3.Ex2.m2.3.3.1.1.1.1.2" xref="S3.Ex2.m2.3.3.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex2.m2.3.3.1.1.1.1.1" xref="S3.Ex2.m2.3.3.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex2.m2.3.3.1.1.1.1.1.2" xref="S3.Ex2.m2.3.3.1.1.1.1.1.2.cmml"><munderover id="S3.Ex2.m2.3.3.1.1.1.1.1.2a" xref="S3.Ex2.m2.3.3.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex2.m2.3.3.1.1.1.1.1.2.2.2" xref="S3.Ex2.m2.3.3.1.1.1.1.1.2.2.2.cmml">∑</mo><mi id="S3.Ex2.m2.3.3.1.1.1.1.1.2.2.3" xref="S3.Ex2.m2.3.3.1.1.1.1.1.2.2.3.cmml">k</mi><mi id="S3.Ex2.m2.3.3.1.1.1.1.1.2.3" xref="S3.Ex2.m2.3.3.1.1.1.1.1.2.3.cmml">K</mi></munderover></mstyle><mrow id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2.m2.2.2" xref="S3.Ex2.m2.2.2.cmml">exp</mi><mo id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1a" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.2" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.4" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.4a.cmml">score</mtext><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex2.m2.1.1.cmml"><mo stretchy="false" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.Ex2.m2.1.1.cmml">(</mo><mover accent="true" id="S3.Ex2.m2.1.1" xref="S3.Ex2.m2.1.1.cmml"><mi id="S3.Ex2.m2.1.1.2" xref="S3.Ex2.m2.1.1.2.cmml">𝒙</mi><mo id="S3.Ex2.m2.1.1.1" xref="S3.Ex2.m2.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex2.m2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><msub id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">f</mi><mi id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">​</mo><mrow id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.2" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><msub id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mover accent="true" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml"><mi id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml">𝒙</mi><mo id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.1" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.3" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.5" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mspace width="1em" id="S3.Ex2.m2.3.3.1.1.2.3" xref="S3.Ex2.m2.3.3.1.1.3a.cmml"></mspace><mrow id="S3.Ex2.m2.3.3.1.1.2.2" xref="S3.Ex2.m2.3.3.1.1.2.2.cmml"><mi id="S3.Ex2.m2.3.3.1.1.2.2.2" xref="S3.Ex2.m2.3.3.1.1.2.2.2.cmml">𝒙</mi><mo id="S3.Ex2.m2.3.3.1.1.2.2.1" xref="S3.Ex2.m2.3.3.1.1.2.2.1.cmml">≠</mo><msub id="S3.Ex2.m2.3.3.1.1.2.2.3" xref="S3.Ex2.m2.3.3.1.1.2.2.3.cmml"><mi id="S3.Ex2.m2.3.3.1.1.2.2.3.2" xref="S3.Ex2.m2.3.3.1.1.2.2.3.2.cmml">𝒙</mi><mi id="S3.Ex2.m2.3.3.1.1.2.2.3.3" xref="S3.Ex2.m2.3.3.1.1.2.2.3.3.cmml">k</mi></msub></mrow></mrow><mo lspace="0em" id="S3.Ex2.m2.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m2.3b"><apply id="S3.Ex2.m2.3.3.1.1.3.cmml" xref="S3.Ex2.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m2.3.3.1.1.3a.cmml" xref="S3.Ex2.m2.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex2.m2.3.3.1.1.1.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1"><eq id="S3.Ex2.m2.3.3.1.1.1.1.2.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.Ex2.m2.3.3.1.1.1.1.3.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.3">absent</csymbol><apply id="S3.Ex2.m2.3.3.1.1.1.1.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1"><apply id="S3.Ex2.m2.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m2.3.3.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex2.m2.3.3.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m2.3.3.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex2.m2.3.3.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.2.2.2"></sum><ci id="S3.Ex2.m2.3.3.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.2.2.3">𝑘</ci></apply><ci id="S3.Ex2.m2.3.3.1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S3.Ex2.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1"><exp id="S3.Ex2.m2.2.2.cmml" xref="S3.Ex2.m2.2.2"></exp><apply id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1"><times id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.3"></times><ci id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.4a.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.4"><mtext id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.4">score</mtext></ci><interval closure="open" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><apply id="S3.Ex2.m2.1.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.Ex2.m2.1.1.1.cmml" xref="S3.Ex2.m2.1.1.1">~</ci><ci id="S3.Ex2.m2.1.1.2.cmml" xref="S3.Ex2.m2.1.1.2">𝒙</ci></apply></apply><apply id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2"><times id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2"></times><apply id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.2">𝑓</ci><ci id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.3">𝜽</ci></apply><apply id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1">subscript</csymbol><apply id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2"><ci id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.1">~</ci><ci id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2">𝒙</ci></apply><ci id="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.Ex2.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3">𝑘</ci></apply></apply></interval></apply></apply></apply></apply><apply id="S3.Ex2.m2.3.3.1.1.2.2.cmml" xref="S3.Ex2.m2.3.3.1.1.2.2"><neq id="S3.Ex2.m2.3.3.1.1.2.2.1.cmml" xref="S3.Ex2.m2.3.3.1.1.2.2.1"></neq><ci id="S3.Ex2.m2.3.3.1.1.2.2.2.cmml" xref="S3.Ex2.m2.3.3.1.1.2.2.2">𝒙</ci><apply id="S3.Ex2.m2.3.3.1.1.2.2.3.cmml" xref="S3.Ex2.m2.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m2.3.3.1.1.2.2.3.1.cmml" xref="S3.Ex2.m2.3.3.1.1.2.2.3">subscript</csymbol><ci id="S3.Ex2.m2.3.3.1.1.2.2.3.2.cmml" xref="S3.Ex2.m2.3.3.1.1.2.2.3.2">𝒙</ci><ci id="S3.Ex2.m2.3.3.1.1.2.2.3.3.cmml" xref="S3.Ex2.m2.3.3.1.1.2.2.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m2.3c">\displaystyle~{}=~{}{\sum_{k}^{K}\exp(\text{score}(f_{{\boldsymbol{\theta}}}(\widetilde{\boldsymbol{x}}),f_{{\boldsymbol{\theta}}}(\widetilde{\boldsymbol{x}}_{k})))}\quad{\boldsymbol{x}}\neq{\boldsymbol{x}}_{k}~{}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.5" class="ltx_p">Here, <math id="S3.SS3.p2.5.m1.1" class="ltx_Math" alttext="{\boldsymbol{x}}_{k}" display="inline"><semantics id="S3.SS3.p2.5.m1.1a"><msub id="S3.SS3.p2.5.m1.1.1" xref="S3.SS3.p2.5.m1.1.1.cmml"><mi id="S3.SS3.p2.5.m1.1.1.2" xref="S3.SS3.p2.5.m1.1.1.2.cmml">𝒙</mi><mi id="S3.SS3.p2.5.m1.1.1.3" xref="S3.SS3.p2.5.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m1.1b"><apply id="S3.SS3.p2.5.m1.1.1.cmml" xref="S3.SS3.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m1.1.1.1.cmml" xref="S3.SS3.p2.5.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m1.1.1.2.cmml" xref="S3.SS3.p2.5.m1.1.1.2">𝒙</ci><ci id="S3.SS3.p2.5.m1.1.1.3.cmml" xref="S3.SS3.p2.5.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m1.1c">{\boldsymbol{x}}_{k}</annotation></semantics></math> samples are usually chosen to be paired with the current mini-batch during SGD.
The overall loss is the sum over all positive pairs in the current mini-batch.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2206.14355/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="139" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.3.2" class="ltx_text" style="font-size:90%;">High-level illustration of contrastive learning.</span></figcaption>
</figure>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>VQA Model</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.6" class="ltx_p">In our main experiments we use a simple VQA model that is built from a pretrained visual encoder as follows.
We combine a visual encoder <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="f^{I}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msup id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">f</mi><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">I</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝑓</ci><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">f^{I}</annotation></semantics></math> (a CNN) with a question encoder <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="f^{Q}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msup id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">f</mi><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝑓</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">f^{Q}</annotation></semantics></math> (an LSTM).
They respectively process an image <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="{\boldsymbol{x}}^{I}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><msup id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">𝒙</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">I</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">𝒙</ci><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">{\boldsymbol{x}}^{I}</annotation></semantics></math> and question <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="{\boldsymbol{x}}^{Q}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><msup id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml">𝒙</mi><mi id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2">𝒙</ci><ci id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">{\boldsymbol{x}}^{Q}</annotation></semantics></math> into representations <math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="{\boldsymbol{v}}\in\mathbb{R}^{D_{I}}" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><mrow id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><mi id="S3.SS4.p1.5.m5.1.1.2" xref="S3.SS4.p1.5.m5.1.1.2.cmml">𝒗</mi><mo id="S3.SS4.p1.5.m5.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3.cmml"><mi id="S3.SS4.p1.5.m5.1.1.3.2" xref="S3.SS4.p1.5.m5.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS4.p1.5.m5.1.1.3.3" xref="S3.SS4.p1.5.m5.1.1.3.3.cmml"><mi id="S3.SS4.p1.5.m5.1.1.3.3.2" xref="S3.SS4.p1.5.m5.1.1.3.3.2.cmml">D</mi><mi id="S3.SS4.p1.5.m5.1.1.3.3.3" xref="S3.SS4.p1.5.m5.1.1.3.3.3.cmml">I</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><in id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1"></in><ci id="S3.SS4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2">𝒗</ci><apply id="S3.SS4.p1.5.m5.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.3.1.cmml" xref="S3.SS4.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.3.2.cmml" xref="S3.SS4.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.5.m5.1.1.3.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.3.3.1.cmml" xref="S3.SS4.p1.5.m5.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.3.3.2.cmml" xref="S3.SS4.p1.5.m5.1.1.3.3.2">𝐷</ci><ci id="S3.SS4.p1.5.m5.1.1.3.3.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3.3.3">𝐼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">{\boldsymbol{v}}\in\mathbb{R}^{D_{I}}</annotation></semantics></math> and <math id="S3.SS4.p1.6.m6.1" class="ltx_Math" alttext="{\boldsymbol{q}}\in\mathbb{R}^{D_{Q}}" display="inline"><semantics id="S3.SS4.p1.6.m6.1a"><mrow id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml"><mi id="S3.SS4.p1.6.m6.1.1.2" xref="S3.SS4.p1.6.m6.1.1.2.cmml">𝒒</mi><mo id="S3.SS4.p1.6.m6.1.1.1" xref="S3.SS4.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.6.m6.1.1.3" xref="S3.SS4.p1.6.m6.1.1.3.cmml"><mi id="S3.SS4.p1.6.m6.1.1.3.2" xref="S3.SS4.p1.6.m6.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS4.p1.6.m6.1.1.3.3" xref="S3.SS4.p1.6.m6.1.1.3.3.cmml"><mi id="S3.SS4.p1.6.m6.1.1.3.3.2" xref="S3.SS4.p1.6.m6.1.1.3.3.2.cmml">D</mi><mi id="S3.SS4.p1.6.m6.1.1.3.3.3" xref="S3.SS4.p1.6.m6.1.1.3.3.3.cmml">Q</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><apply id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1"><in id="S3.SS4.p1.6.m6.1.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1.1"></in><ci id="S3.SS4.p1.6.m6.1.1.2.cmml" xref="S3.SS4.p1.6.m6.1.1.2">𝒒</ci><apply id="S3.SS4.p1.6.m6.1.1.3.cmml" xref="S3.SS4.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.1.1.3.1.cmml" xref="S3.SS4.p1.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.6.m6.1.1.3.2.cmml" xref="S3.SS4.p1.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.6.m6.1.1.3.3.cmml" xref="S3.SS4.p1.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.1.1.3.3.1.cmml" xref="S3.SS4.p1.6.m6.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p1.6.m6.1.1.3.3.2.cmml" xref="S3.SS4.p1.6.m6.1.1.3.3.2">𝐷</ci><ci id="S3.SS4.p1.6.m6.1.1.3.3.3.cmml" xref="S3.SS4.p1.6.m6.1.1.3.3.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">{\boldsymbol{q}}\in\mathbb{R}^{D_{Q}}</annotation></semantics></math>:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.3" class="ltx_Math" alttext="{\boldsymbol{v}}=f_{{\boldsymbol{\theta}}}^{I}({\boldsymbol{x}}^{I})~{}~{}~{}~{}~{}~{}\textrm{and}~{}~{}~{}~{}~{}~{}{\boldsymbol{q}}=f_{{\boldsymbol{\theta}}}^{Q}({\boldsymbol{x}}^{Q})" display="block"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3.2" xref="S3.E7.m1.3.3.3.cmml"><mrow id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.3" xref="S3.E7.m1.2.2.1.1.3.cmml">𝒗</mi><mo id="S3.E7.m1.2.2.1.1.2" xref="S3.E7.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.2.2.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.2.cmml"><mrow id="S3.E7.m1.2.2.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.cmml"><msubsup id="S3.E7.m1.2.2.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.1.3.2.2" xref="S3.E7.m1.2.2.1.1.1.1.1.3.2.2.cmml">f</mi><mi id="S3.E7.m1.2.2.1.1.1.1.1.3.2.3" xref="S3.E7.m1.2.2.1.1.1.1.1.3.2.3.cmml">𝜽</mi><mi id="S3.E7.m1.2.2.1.1.1.1.1.3.3" xref="S3.E7.m1.2.2.1.1.1.1.1.3.3.cmml">I</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.2.2.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">I</mi></msup><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mspace width="1.98em" id="S3.E7.m1.2.2.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.2.cmml"></mspace><mtext id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1a.cmml">and</mtext></mrow></mrow><mspace width="1.98em" id="S3.E7.m1.3.3.2.3" xref="S3.E7.m1.3.3.3a.cmml"></mspace><mrow id="S3.E7.m1.3.3.2.2" xref="S3.E7.m1.3.3.2.2.cmml"><mi id="S3.E7.m1.3.3.2.2.3" xref="S3.E7.m1.3.3.2.2.3.cmml">𝒒</mi><mo id="S3.E7.m1.3.3.2.2.2" xref="S3.E7.m1.3.3.2.2.2.cmml">=</mo><mrow id="S3.E7.m1.3.3.2.2.1" xref="S3.E7.m1.3.3.2.2.1.cmml"><msubsup id="S3.E7.m1.3.3.2.2.1.3" xref="S3.E7.m1.3.3.2.2.1.3.cmml"><mi id="S3.E7.m1.3.3.2.2.1.3.2.2" xref="S3.E7.m1.3.3.2.2.1.3.2.2.cmml">f</mi><mi id="S3.E7.m1.3.3.2.2.1.3.2.3" xref="S3.E7.m1.3.3.2.2.1.3.2.3.cmml">𝜽</mi><mi id="S3.E7.m1.3.3.2.2.1.3.3" xref="S3.E7.m1.3.3.2.2.1.3.3.cmml">Q</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.2.2.1.2" xref="S3.E7.m1.3.3.2.2.1.2.cmml">​</mo><mrow id="S3.E7.m1.3.3.2.2.1.1.1" xref="S3.E7.m1.3.3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.2.2.1.1.1.2" xref="S3.E7.m1.3.3.2.2.1.1.1.1.cmml">(</mo><msup id="S3.E7.m1.3.3.2.2.1.1.1.1" xref="S3.E7.m1.3.3.2.2.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.2.2.1.1.1.1.2" xref="S3.E7.m1.3.3.2.2.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.E7.m1.3.3.2.2.1.1.1.1.3" xref="S3.E7.m1.3.3.2.2.1.1.1.1.3.cmml">Q</mi></msup><mo stretchy="false" id="S3.E7.m1.3.3.2.2.1.1.1.3" xref="S3.E7.m1.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.3.cmml" xref="S3.E7.m1.3.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3a.cmml" xref="S3.E7.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1.1"><eq id="S3.E7.m1.2.2.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.2"></eq><ci id="S3.E7.m1.2.2.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.3">𝒗</ci><list id="S3.E7.m1.2.2.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1"><apply id="S3.E7.m1.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1"><times id="S3.E7.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.2"></times><apply id="S3.E7.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E7.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.3.2.2">𝑓</ci><ci id="S3.E7.m1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.3.2.3">𝜽</ci></apply><ci id="S3.E7.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.3.3">𝐼</ci></apply><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3">𝐼</ci></apply></apply><ci id="S3.E7.m1.1.1a.cmml" xref="S3.E7.m1.1.1"><mtext id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">and</mtext></ci></list></apply><apply id="S3.E7.m1.3.3.2.2.cmml" xref="S3.E7.m1.3.3.2.2"><eq id="S3.E7.m1.3.3.2.2.2.cmml" xref="S3.E7.m1.3.3.2.2.2"></eq><ci id="S3.E7.m1.3.3.2.2.3.cmml" xref="S3.E7.m1.3.3.2.2.3">𝒒</ci><apply id="S3.E7.m1.3.3.2.2.1.cmml" xref="S3.E7.m1.3.3.2.2.1"><times id="S3.E7.m1.3.3.2.2.1.2.cmml" xref="S3.E7.m1.3.3.2.2.1.2"></times><apply id="S3.E7.m1.3.3.2.2.1.3.cmml" xref="S3.E7.m1.3.3.2.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.2.1.3.1.cmml" xref="S3.E7.m1.3.3.2.2.1.3">superscript</csymbol><apply id="S3.E7.m1.3.3.2.2.1.3.2.cmml" xref="S3.E7.m1.3.3.2.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.2.1.3.2.1.cmml" xref="S3.E7.m1.3.3.2.2.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.2.2.1.3.2.2.cmml" xref="S3.E7.m1.3.3.2.2.1.3.2.2">𝑓</ci><ci id="S3.E7.m1.3.3.2.2.1.3.2.3.cmml" xref="S3.E7.m1.3.3.2.2.1.3.2.3">𝜽</ci></apply><ci id="S3.E7.m1.3.3.2.2.1.3.3.cmml" xref="S3.E7.m1.3.3.2.2.1.3.3">𝑄</ci></apply><apply id="S3.E7.m1.3.3.2.2.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.2.2.1.1.1">superscript</csymbol><ci id="S3.E7.m1.3.3.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.2.2.1.1.1.1.2">𝒙</ci><ci id="S3.E7.m1.3.3.2.2.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.2.2.1.1.1.1.3">𝑄</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">{\boldsymbol{v}}=f_{{\boldsymbol{\theta}}}^{I}({\boldsymbol{x}}^{I})~{}~{}~{}~{}~{}~{}\textrm{and}~{}~{}~{}~{}~{}~{}{\boldsymbol{q}}=f_{{\boldsymbol{\theta}}}^{Q}({\boldsymbol{x}}^{Q})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.11" class="ltx_p">These are concatenated into a single vector <math id="S3.SS4.p1.7.m1.2" class="ltx_Math" alttext="{\boldsymbol{p}}=[{\boldsymbol{v}},{\boldsymbol{q}}]" display="inline"><semantics id="S3.SS4.p1.7.m1.2a"><mrow id="S3.SS4.p1.7.m1.2.3" xref="S3.SS4.p1.7.m1.2.3.cmml"><mi id="S3.SS4.p1.7.m1.2.3.2" xref="S3.SS4.p1.7.m1.2.3.2.cmml">𝒑</mi><mo id="S3.SS4.p1.7.m1.2.3.1" xref="S3.SS4.p1.7.m1.2.3.1.cmml">=</mo><mrow id="S3.SS4.p1.7.m1.2.3.3.2" xref="S3.SS4.p1.7.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS4.p1.7.m1.2.3.3.2.1" xref="S3.SS4.p1.7.m1.2.3.3.1.cmml">[</mo><mi id="S3.SS4.p1.7.m1.1.1" xref="S3.SS4.p1.7.m1.1.1.cmml">𝒗</mi><mo id="S3.SS4.p1.7.m1.2.3.3.2.2" xref="S3.SS4.p1.7.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS4.p1.7.m1.2.2" xref="S3.SS4.p1.7.m1.2.2.cmml">𝒒</mi><mo stretchy="false" id="S3.SS4.p1.7.m1.2.3.3.2.3" xref="S3.SS4.p1.7.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m1.2b"><apply id="S3.SS4.p1.7.m1.2.3.cmml" xref="S3.SS4.p1.7.m1.2.3"><eq id="S3.SS4.p1.7.m1.2.3.1.cmml" xref="S3.SS4.p1.7.m1.2.3.1"></eq><ci id="S3.SS4.p1.7.m1.2.3.2.cmml" xref="S3.SS4.p1.7.m1.2.3.2">𝒑</ci><interval closure="closed" id="S3.SS4.p1.7.m1.2.3.3.1.cmml" xref="S3.SS4.p1.7.m1.2.3.3.2"><ci id="S3.SS4.p1.7.m1.1.1.cmml" xref="S3.SS4.p1.7.m1.1.1">𝒗</ci><ci id="S3.SS4.p1.7.m1.2.2.cmml" xref="S3.SS4.p1.7.m1.2.2">𝒒</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m1.2c">{\boldsymbol{p}}=[{\boldsymbol{v}},{\boldsymbol{q}}]</annotation></semantics></math>, <math id="S3.SS4.p1.8.m2.1" class="ltx_Math" alttext="{\boldsymbol{p}}\in\mathbb{R}^{D_{I}+D_{Q}}" display="inline"><semantics id="S3.SS4.p1.8.m2.1a"><mrow id="S3.SS4.p1.8.m2.1.1" xref="S3.SS4.p1.8.m2.1.1.cmml"><mi id="S3.SS4.p1.8.m2.1.1.2" xref="S3.SS4.p1.8.m2.1.1.2.cmml">𝒑</mi><mo id="S3.SS4.p1.8.m2.1.1.1" xref="S3.SS4.p1.8.m2.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.8.m2.1.1.3" xref="S3.SS4.p1.8.m2.1.1.3.cmml"><mi id="S3.SS4.p1.8.m2.1.1.3.2" xref="S3.SS4.p1.8.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.8.m2.1.1.3.3" xref="S3.SS4.p1.8.m2.1.1.3.3.cmml"><msub id="S3.SS4.p1.8.m2.1.1.3.3.2" xref="S3.SS4.p1.8.m2.1.1.3.3.2.cmml"><mi id="S3.SS4.p1.8.m2.1.1.3.3.2.2" xref="S3.SS4.p1.8.m2.1.1.3.3.2.2.cmml">D</mi><mi id="S3.SS4.p1.8.m2.1.1.3.3.2.3" xref="S3.SS4.p1.8.m2.1.1.3.3.2.3.cmml">I</mi></msub><mo id="S3.SS4.p1.8.m2.1.1.3.3.1" xref="S3.SS4.p1.8.m2.1.1.3.3.1.cmml">+</mo><msub id="S3.SS4.p1.8.m2.1.1.3.3.3" xref="S3.SS4.p1.8.m2.1.1.3.3.3.cmml"><mi id="S3.SS4.p1.8.m2.1.1.3.3.3.2" xref="S3.SS4.p1.8.m2.1.1.3.3.3.2.cmml">D</mi><mi id="S3.SS4.p1.8.m2.1.1.3.3.3.3" xref="S3.SS4.p1.8.m2.1.1.3.3.3.3.cmml">Q</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m2.1b"><apply id="S3.SS4.p1.8.m2.1.1.cmml" xref="S3.SS4.p1.8.m2.1.1"><in id="S3.SS4.p1.8.m2.1.1.1.cmml" xref="S3.SS4.p1.8.m2.1.1.1"></in><ci id="S3.SS4.p1.8.m2.1.1.2.cmml" xref="S3.SS4.p1.8.m2.1.1.2">𝒑</ci><apply id="S3.SS4.p1.8.m2.1.1.3.cmml" xref="S3.SS4.p1.8.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m2.1.1.3.1.cmml" xref="S3.SS4.p1.8.m2.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.8.m2.1.1.3.2.cmml" xref="S3.SS4.p1.8.m2.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.8.m2.1.1.3.3.cmml" xref="S3.SS4.p1.8.m2.1.1.3.3"><plus id="S3.SS4.p1.8.m2.1.1.3.3.1.cmml" xref="S3.SS4.p1.8.m2.1.1.3.3.1"></plus><apply id="S3.SS4.p1.8.m2.1.1.3.3.2.cmml" xref="S3.SS4.p1.8.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m2.1.1.3.3.2.1.cmml" xref="S3.SS4.p1.8.m2.1.1.3.3.2">subscript</csymbol><ci id="S3.SS4.p1.8.m2.1.1.3.3.2.2.cmml" xref="S3.SS4.p1.8.m2.1.1.3.3.2.2">𝐷</ci><ci id="S3.SS4.p1.8.m2.1.1.3.3.2.3.cmml" xref="S3.SS4.p1.8.m2.1.1.3.3.2.3">𝐼</ci></apply><apply id="S3.SS4.p1.8.m2.1.1.3.3.3.cmml" xref="S3.SS4.p1.8.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m2.1.1.3.3.3.1.cmml" xref="S3.SS4.p1.8.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS4.p1.8.m2.1.1.3.3.3.2.cmml" xref="S3.SS4.p1.8.m2.1.1.3.3.3.2">𝐷</ci><ci id="S3.SS4.p1.8.m2.1.1.3.3.3.3.cmml" xref="S3.SS4.p1.8.m2.1.1.3.3.3.3">𝑄</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m2.1c">{\boldsymbol{p}}\in\mathbb{R}^{D_{I}+D_{Q}}</annotation></semantics></math>. This vector is passed through an MLP classifier to obtain answer scores <math id="S3.SS4.p1.9.m3.1" class="ltx_Math" alttext="{\boldsymbol{y}}=f^{CLS}({\boldsymbol{p}})" display="inline"><semantics id="S3.SS4.p1.9.m3.1a"><mrow id="S3.SS4.p1.9.m3.1.2" xref="S3.SS4.p1.9.m3.1.2.cmml"><mi id="S3.SS4.p1.9.m3.1.2.2" xref="S3.SS4.p1.9.m3.1.2.2.cmml">𝒚</mi><mo id="S3.SS4.p1.9.m3.1.2.1" xref="S3.SS4.p1.9.m3.1.2.1.cmml">=</mo><mrow id="S3.SS4.p1.9.m3.1.2.3" xref="S3.SS4.p1.9.m3.1.2.3.cmml"><msup id="S3.SS4.p1.9.m3.1.2.3.2" xref="S3.SS4.p1.9.m3.1.2.3.2.cmml"><mi id="S3.SS4.p1.9.m3.1.2.3.2.2" xref="S3.SS4.p1.9.m3.1.2.3.2.2.cmml">f</mi><mrow id="S3.SS4.p1.9.m3.1.2.3.2.3" xref="S3.SS4.p1.9.m3.1.2.3.2.3.cmml"><mi id="S3.SS4.p1.9.m3.1.2.3.2.3.2" xref="S3.SS4.p1.9.m3.1.2.3.2.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.9.m3.1.2.3.2.3.1" xref="S3.SS4.p1.9.m3.1.2.3.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.9.m3.1.2.3.2.3.3" xref="S3.SS4.p1.9.m3.1.2.3.2.3.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.9.m3.1.2.3.2.3.1a" xref="S3.SS4.p1.9.m3.1.2.3.2.3.1.cmml">​</mo><mi id="S3.SS4.p1.9.m3.1.2.3.2.3.4" xref="S3.SS4.p1.9.m3.1.2.3.2.3.4.cmml">S</mi></mrow></msup><mo lspace="0em" rspace="0em" id="S3.SS4.p1.9.m3.1.2.3.1" xref="S3.SS4.p1.9.m3.1.2.3.1.cmml">​</mo><mrow id="S3.SS4.p1.9.m3.1.2.3.3.2" xref="S3.SS4.p1.9.m3.1.2.3.cmml"><mo stretchy="false" id="S3.SS4.p1.9.m3.1.2.3.3.2.1" xref="S3.SS4.p1.9.m3.1.2.3.cmml">(</mo><mi id="S3.SS4.p1.9.m3.1.1" xref="S3.SS4.p1.9.m3.1.1.cmml">𝒑</mi><mo stretchy="false" id="S3.SS4.p1.9.m3.1.2.3.3.2.2" xref="S3.SS4.p1.9.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m3.1b"><apply id="S3.SS4.p1.9.m3.1.2.cmml" xref="S3.SS4.p1.9.m3.1.2"><eq id="S3.SS4.p1.9.m3.1.2.1.cmml" xref="S3.SS4.p1.9.m3.1.2.1"></eq><ci id="S3.SS4.p1.9.m3.1.2.2.cmml" xref="S3.SS4.p1.9.m3.1.2.2">𝒚</ci><apply id="S3.SS4.p1.9.m3.1.2.3.cmml" xref="S3.SS4.p1.9.m3.1.2.3"><times id="S3.SS4.p1.9.m3.1.2.3.1.cmml" xref="S3.SS4.p1.9.m3.1.2.3.1"></times><apply id="S3.SS4.p1.9.m3.1.2.3.2.cmml" xref="S3.SS4.p1.9.m3.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m3.1.2.3.2.1.cmml" xref="S3.SS4.p1.9.m3.1.2.3.2">superscript</csymbol><ci id="S3.SS4.p1.9.m3.1.2.3.2.2.cmml" xref="S3.SS4.p1.9.m3.1.2.3.2.2">𝑓</ci><apply id="S3.SS4.p1.9.m3.1.2.3.2.3.cmml" xref="S3.SS4.p1.9.m3.1.2.3.2.3"><times id="S3.SS4.p1.9.m3.1.2.3.2.3.1.cmml" xref="S3.SS4.p1.9.m3.1.2.3.2.3.1"></times><ci id="S3.SS4.p1.9.m3.1.2.3.2.3.2.cmml" xref="S3.SS4.p1.9.m3.1.2.3.2.3.2">𝐶</ci><ci id="S3.SS4.p1.9.m3.1.2.3.2.3.3.cmml" xref="S3.SS4.p1.9.m3.1.2.3.2.3.3">𝐿</ci><ci id="S3.SS4.p1.9.m3.1.2.3.2.3.4.cmml" xref="S3.SS4.p1.9.m3.1.2.3.2.3.4">𝑆</ci></apply></apply><ci id="S3.SS4.p1.9.m3.1.1.cmml" xref="S3.SS4.p1.9.m3.1.1">𝒑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m3.1c">{\boldsymbol{y}}=f^{CLS}({\boldsymbol{p}})</annotation></semantics></math>, with <math id="S3.SS4.p1.10.m4.1" class="ltx_Math" alttext="{\boldsymbol{y}}\in\mathbb{R}^{A}" display="inline"><semantics id="S3.SS4.p1.10.m4.1a"><mrow id="S3.SS4.p1.10.m4.1.1" xref="S3.SS4.p1.10.m4.1.1.cmml"><mi id="S3.SS4.p1.10.m4.1.1.2" xref="S3.SS4.p1.10.m4.1.1.2.cmml">𝒚</mi><mo id="S3.SS4.p1.10.m4.1.1.1" xref="S3.SS4.p1.10.m4.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.10.m4.1.1.3" xref="S3.SS4.p1.10.m4.1.1.3.cmml"><mi id="S3.SS4.p1.10.m4.1.1.3.2" xref="S3.SS4.p1.10.m4.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS4.p1.10.m4.1.1.3.3" xref="S3.SS4.p1.10.m4.1.1.3.3.cmml">A</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m4.1b"><apply id="S3.SS4.p1.10.m4.1.1.cmml" xref="S3.SS4.p1.10.m4.1.1"><in id="S3.SS4.p1.10.m4.1.1.1.cmml" xref="S3.SS4.p1.10.m4.1.1.1"></in><ci id="S3.SS4.p1.10.m4.1.1.2.cmml" xref="S3.SS4.p1.10.m4.1.1.2">𝒚</ci><apply id="S3.SS4.p1.10.m4.1.1.3.cmml" xref="S3.SS4.p1.10.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m4.1.1.3.1.cmml" xref="S3.SS4.p1.10.m4.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.10.m4.1.1.3.2.cmml" xref="S3.SS4.p1.10.m4.1.1.3.2">ℝ</ci><ci id="S3.SS4.p1.10.m4.1.1.3.3.cmml" xref="S3.SS4.p1.10.m4.1.1.3.3">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m4.1c">{\boldsymbol{y}}\in\mathbb{R}^{A}</annotation></semantics></math> where <math id="S3.SS4.p1.11.m5.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS4.p1.11.m5.1a"><mi id="S3.SS4.p1.11.m5.1.1" xref="S3.SS4.p1.11.m5.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m5.1b"><ci id="S3.SS4.p1.11.m5.1.1.cmml" xref="S3.SS4.p1.11.m5.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m5.1c">A</annotation></semantics></math> is the size of a set of candidate answers.
The model is trained with supervision on question/image/answer triplets to minimize a cross-entropy loss:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.6" class="ltx_Math" alttext="\operatorname*{softmax}(y_{i})~{}=~{}\frac{\exp(y_{i})}{\sum_{j=1}^{A}\exp(y_{j})}~{}," display="block"><semantics id="S3.E8.m1.6a"><mrow id="S3.E8.m1.6.6.1" xref="S3.E8.m1.6.6.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1" xref="S3.E8.m1.6.6.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.2.cmml"><mo rspace="0em" id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml">softmax</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.6.6.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.2.cmml">(</mo><msub id="S3.E8.m1.6.6.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2.cmml">y</mi><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.3.cmml">i</mi></msub><mo rspace="0.330em" stretchy="false" id="S3.E8.m1.6.6.1.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.608em" id="S3.E8.m1.6.6.1.1.2" xref="S3.E8.m1.6.6.1.1.2.cmml">=</mo><mfrac id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml"><mrow id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E8.m1.2.2.2.2a" xref="S3.E8.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E8.m1.2.2.2.2.1" xref="S3.E8.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.2.2.1.2" xref="S3.E8.m1.2.2.2.3.cmml">(</mo><msub id="S3.E8.m1.2.2.2.2.1.1" xref="S3.E8.m1.2.2.2.2.1.1.cmml"><mi id="S3.E8.m1.2.2.2.2.1.1.2" xref="S3.E8.m1.2.2.2.2.1.1.2.cmml">y</mi><mi id="S3.E8.m1.2.2.2.2.1.1.3" xref="S3.E8.m1.2.2.2.2.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E8.m1.2.2.2.2.1.3" xref="S3.E8.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E8.m1.4.4.4" xref="S3.E8.m1.4.4.4.cmml"><msubsup id="S3.E8.m1.4.4.4.3" xref="S3.E8.m1.4.4.4.3.cmml"><mo id="S3.E8.m1.4.4.4.3.2.2" xref="S3.E8.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S3.E8.m1.4.4.4.3.2.3" xref="S3.E8.m1.4.4.4.3.2.3.cmml"><mi id="S3.E8.m1.4.4.4.3.2.3.2" xref="S3.E8.m1.4.4.4.3.2.3.2.cmml">j</mi><mo id="S3.E8.m1.4.4.4.3.2.3.1" xref="S3.E8.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S3.E8.m1.4.4.4.3.2.3.3" xref="S3.E8.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.4.4.4.3.3" xref="S3.E8.m1.4.4.4.3.3.cmml">A</mi></msubsup><mrow id="S3.E8.m1.4.4.4.2.1" xref="S3.E8.m1.4.4.4.2.2.cmml"><mi id="S3.E8.m1.3.3.3.1" xref="S3.E8.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E8.m1.4.4.4.2.1a" xref="S3.E8.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S3.E8.m1.4.4.4.2.1.1" xref="S3.E8.m1.4.4.4.2.2.cmml"><mo stretchy="false" id="S3.E8.m1.4.4.4.2.1.1.2" xref="S3.E8.m1.4.4.4.2.2.cmml">(</mo><msub id="S3.E8.m1.4.4.4.2.1.1.1" xref="S3.E8.m1.4.4.4.2.1.1.1.cmml"><mi id="S3.E8.m1.4.4.4.2.1.1.1.2" xref="S3.E8.m1.4.4.4.2.1.1.1.2.cmml">y</mi><mi id="S3.E8.m1.4.4.4.2.1.1.1.3" xref="S3.E8.m1.4.4.4.2.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E8.m1.4.4.4.2.1.1.3" xref="S3.E8.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo lspace="0.330em" id="S3.E8.m1.6.6.1.2" xref="S3.E8.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.6b"><apply id="S3.E8.m1.6.6.1.1.cmml" xref="S3.E8.m1.6.6.1"><eq id="S3.E8.m1.6.6.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.2"></eq><apply id="S3.E8.m1.6.6.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1"><ci id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5">softmax</ci><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4"><divide id="S3.E8.m1.4.4.5.cmml" xref="S3.E8.m1.4.4"></divide><apply id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.2"><exp id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1"></exp><apply id="S3.E8.m1.2.2.2.2.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2">𝑦</ci><ci id="S3.E8.m1.2.2.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.3">𝑖</ci></apply></apply><apply id="S3.E8.m1.4.4.4.cmml" xref="S3.E8.m1.4.4.4"><apply id="S3.E8.m1.4.4.4.3.cmml" xref="S3.E8.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.4.3.1.cmml" xref="S3.E8.m1.4.4.4.3">superscript</csymbol><apply id="S3.E8.m1.4.4.4.3.2.cmml" xref="S3.E8.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.4.3.2.1.cmml" xref="S3.E8.m1.4.4.4.3">subscript</csymbol><sum id="S3.E8.m1.4.4.4.3.2.2.cmml" xref="S3.E8.m1.4.4.4.3.2.2"></sum><apply id="S3.E8.m1.4.4.4.3.2.3.cmml" xref="S3.E8.m1.4.4.4.3.2.3"><eq id="S3.E8.m1.4.4.4.3.2.3.1.cmml" xref="S3.E8.m1.4.4.4.3.2.3.1"></eq><ci id="S3.E8.m1.4.4.4.3.2.3.2.cmml" xref="S3.E8.m1.4.4.4.3.2.3.2">𝑗</ci><cn type="integer" id="S3.E8.m1.4.4.4.3.2.3.3.cmml" xref="S3.E8.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.4.4.4.3.3.cmml" xref="S3.E8.m1.4.4.4.3.3">𝐴</ci></apply><apply id="S3.E8.m1.4.4.4.2.2.cmml" xref="S3.E8.m1.4.4.4.2.1"><exp id="S3.E8.m1.3.3.3.1.cmml" xref="S3.E8.m1.3.3.3.1"></exp><apply id="S3.E8.m1.4.4.4.2.1.1.1.cmml" xref="S3.E8.m1.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.4.2.1.1.1.1.cmml" xref="S3.E8.m1.4.4.4.2.1.1.1">subscript</csymbol><ci id="S3.E8.m1.4.4.4.2.1.1.1.2.cmml" xref="S3.E8.m1.4.4.4.2.1.1.1.2">𝑦</ci><ci id="S3.E8.m1.4.4.4.2.1.1.1.3.cmml" xref="S3.E8.m1.4.4.4.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.6c">\operatorname*{softmax}(y_{i})~{}=~{}\frac{\exp(y_{i})}{\sum_{j=1}^{A}\exp(y_{j})}~{},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.3" class="ltx_Math" alttext="\mathcal{L}_{CE}~{}=~{}-\sum_{i=1}^{A}\hat{a}_{i}\cdot\log(\operatorname*{softmax}(y_{i}))~{}," display="block"><semantics id="S3.E9.m1.3a"><mrow id="S3.E9.m1.3.3.1" xref="S3.E9.m1.3.3.1.1.cmml"><mrow id="S3.E9.m1.3.3.1.1" xref="S3.E9.m1.3.3.1.1.cmml"><msub id="S3.E9.m1.3.3.1.1.3" xref="S3.E9.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.3.3.1.1.3.2" xref="S3.E9.m1.3.3.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E9.m1.3.3.1.1.3.3" xref="S3.E9.m1.3.3.1.1.3.3.cmml"><mi id="S3.E9.m1.3.3.1.1.3.3.2" xref="S3.E9.m1.3.3.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.1.1.3.3.1" xref="S3.E9.m1.3.3.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.3.3.1.1.3.3.3" xref="S3.E9.m1.3.3.1.1.3.3.3.cmml">E</mi></mrow></msub><mo lspace="0.608em" rspace="0.608em" id="S3.E9.m1.3.3.1.1.2" xref="S3.E9.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.3.3.1.1.1" xref="S3.E9.m1.3.3.1.1.1.cmml"><mo id="S3.E9.m1.3.3.1.1.1a" xref="S3.E9.m1.3.3.1.1.1.cmml">−</mo><mrow id="S3.E9.m1.3.3.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.cmml"><munderover id="S3.E9.m1.3.3.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E9.m1.3.3.1.1.1.1.2.2.2" xref="S3.E9.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.2.2.3" xref="S3.E9.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.2.2.3.2" xref="S3.E9.m1.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E9.m1.3.3.1.1.1.1.2.2.3.1" xref="S3.E9.m1.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E9.m1.3.3.1.1.1.1.2.2.3.3" xref="S3.E9.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.3.3.1.1.1.1.2.3" xref="S3.E9.m1.3.3.1.1.1.1.2.3.cmml">A</mi></munderover><mrow id="S3.E9.m1.3.3.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.cmml"><msub id="S3.E9.m1.3.3.1.1.1.1.1.3" xref="S3.E9.m1.3.3.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.3.3.1.1.1.1.1.3.2" xref="S3.E9.m1.3.3.1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.1.3.2.2" xref="S3.E9.m1.3.3.1.1.1.1.1.3.2.2.cmml">a</mi><mo id="S3.E9.m1.3.3.1.1.1.1.1.3.2.1" xref="S3.E9.m1.3.3.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.3.3.1.1.1.1.1.3.3" xref="S3.E9.m1.3.3.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E9.m1.3.3.1.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml">log</mi><mo id="S3.E9.m1.3.3.1.1.1.1.1.1.1a" xref="S3.E9.m1.3.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">softmax</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.330em" stretchy="false" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E9.m1.3.3.1.2" xref="S3.E9.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.3b"><apply id="S3.E9.m1.3.3.1.1.cmml" xref="S3.E9.m1.3.3.1"><eq id="S3.E9.m1.3.3.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.2"></eq><apply id="S3.E9.m1.3.3.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.3.1.cmml" xref="S3.E9.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.3.2.cmml" xref="S3.E9.m1.3.3.1.1.3.2">ℒ</ci><apply id="S3.E9.m1.3.3.1.1.3.3.cmml" xref="S3.E9.m1.3.3.1.1.3.3"><times id="S3.E9.m1.3.3.1.1.3.3.1.cmml" xref="S3.E9.m1.3.3.1.1.3.3.1"></times><ci id="S3.E9.m1.3.3.1.1.3.3.2.cmml" xref="S3.E9.m1.3.3.1.1.3.3.2">𝐶</ci><ci id="S3.E9.m1.3.3.1.1.3.3.3.cmml" xref="S3.E9.m1.3.3.1.1.3.3.3">𝐸</ci></apply></apply><apply id="S3.E9.m1.3.3.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1"><minus id="S3.E9.m1.3.3.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1"></minus><apply id="S3.E9.m1.3.3.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1"><apply id="S3.E9.m1.3.3.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E9.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E9.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E9.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.2.3"><eq id="S3.E9.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E9.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E9.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.3">𝐴</ci></apply><apply id="S3.E9.m1.3.3.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1"><ci id="S3.E9.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.2">⋅</ci><apply id="S3.E9.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E9.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.3.2"><ci id="S3.E9.m1.3.3.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E9.m1.3.3.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.3.2.2">𝑎</ci></apply><ci id="S3.E9.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E9.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1"><log id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2"></log><apply id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1"><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">softmax</ci><apply id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.3c">\mathcal{L}_{CE}~{}=~{}-\sum_{i=1}^{A}\hat{a}_{i}\cdot\log(\operatorname*{softmax}(y_{i}))~{},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.13" class="ltx_p">where <math id="S3.SS4.p1.12.m1.2" class="ltx_Math" alttext="\hat{\boldsymbol{a}}\in\{0,1\}^{A}" display="inline"><semantics id="S3.SS4.p1.12.m1.2a"><mrow id="S3.SS4.p1.12.m1.2.3" xref="S3.SS4.p1.12.m1.2.3.cmml"><mover accent="true" id="S3.SS4.p1.12.m1.2.3.2" xref="S3.SS4.p1.12.m1.2.3.2.cmml"><mi id="S3.SS4.p1.12.m1.2.3.2.2" xref="S3.SS4.p1.12.m1.2.3.2.2.cmml">𝒂</mi><mo id="S3.SS4.p1.12.m1.2.3.2.1" xref="S3.SS4.p1.12.m1.2.3.2.1.cmml">^</mo></mover><mo id="S3.SS4.p1.12.m1.2.3.1" xref="S3.SS4.p1.12.m1.2.3.1.cmml">∈</mo><msup id="S3.SS4.p1.12.m1.2.3.3" xref="S3.SS4.p1.12.m1.2.3.3.cmml"><mrow id="S3.SS4.p1.12.m1.2.3.3.2.2" xref="S3.SS4.p1.12.m1.2.3.3.2.1.cmml"><mo stretchy="false" id="S3.SS4.p1.12.m1.2.3.3.2.2.1" xref="S3.SS4.p1.12.m1.2.3.3.2.1.cmml">{</mo><mn id="S3.SS4.p1.12.m1.1.1" xref="S3.SS4.p1.12.m1.1.1.cmml">0</mn><mo id="S3.SS4.p1.12.m1.2.3.3.2.2.2" xref="S3.SS4.p1.12.m1.2.3.3.2.1.cmml">,</mo><mn id="S3.SS4.p1.12.m1.2.2" xref="S3.SS4.p1.12.m1.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS4.p1.12.m1.2.3.3.2.2.3" xref="S3.SS4.p1.12.m1.2.3.3.2.1.cmml">}</mo></mrow><mi id="S3.SS4.p1.12.m1.2.3.3.3" xref="S3.SS4.p1.12.m1.2.3.3.3.cmml">A</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m1.2b"><apply id="S3.SS4.p1.12.m1.2.3.cmml" xref="S3.SS4.p1.12.m1.2.3"><in id="S3.SS4.p1.12.m1.2.3.1.cmml" xref="S3.SS4.p1.12.m1.2.3.1"></in><apply id="S3.SS4.p1.12.m1.2.3.2.cmml" xref="S3.SS4.p1.12.m1.2.3.2"><ci id="S3.SS4.p1.12.m1.2.3.2.1.cmml" xref="S3.SS4.p1.12.m1.2.3.2.1">^</ci><ci id="S3.SS4.p1.12.m1.2.3.2.2.cmml" xref="S3.SS4.p1.12.m1.2.3.2.2">𝒂</ci></apply><apply id="S3.SS4.p1.12.m1.2.3.3.cmml" xref="S3.SS4.p1.12.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m1.2.3.3.1.cmml" xref="S3.SS4.p1.12.m1.2.3.3">superscript</csymbol><set id="S3.SS4.p1.12.m1.2.3.3.2.1.cmml" xref="S3.SS4.p1.12.m1.2.3.3.2.2"><cn type="integer" id="S3.SS4.p1.12.m1.1.1.cmml" xref="S3.SS4.p1.12.m1.1.1">0</cn><cn type="integer" id="S3.SS4.p1.12.m1.2.2.cmml" xref="S3.SS4.p1.12.m1.2.2">1</cn></set><ci id="S3.SS4.p1.12.m1.2.3.3.3.cmml" xref="S3.SS4.p1.12.m1.2.3.3.3">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m1.2c">\hat{\boldsymbol{a}}\in\{0,1\}^{A}</annotation></semantics></math> denotes the one-hot (multi-hot) vector of the ground-truth answer(s), and <math id="S3.SS4.p1.13.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS4.p1.13.m2.1a"><mi id="S3.SS4.p1.13.m2.1.1" xref="S3.SS4.p1.13.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.13.m2.1b"><ci id="S3.SS4.p1.13.m2.1.1.cmml" xref="S3.SS4.p1.13.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.13.m2.1c">i</annotation></semantics></math> indexes vector elements.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Our implementation</h2>

<section id="S4.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Our VQA model</h4>

<div id="S4.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px1.p1.1" class="ltx_p">is a simple CNN–LSTM architecture, commonly used as a baseline in early work on VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>.
We settled on this simple option because it reduces the training instabilities arising when training EBMs within more complex architectures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
The CNN in this architecture is the EBM version of a ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> from Du <em id="S4.SS0.SSS0.Px1.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S4.SS0.SSS0.Px1.p1.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
The same ResNet backbone is used in all pretraining and fine-tuning experiments to enable transfer learning. We only modify its last few layers for each pretraining task, as discussed below.</p>
</div>
</section>
<section id="S4.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">For EBM pretraining,</h4>

<div id="S4.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px2.p1.1" class="ltx_p">we append the CNN model with a linear layer producing a scalar energy value. To facilitate the training we incorporate three changes proposed by Du <em id="S4.SS0.SSS0.Px2.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S4.SS0.SSS0.Px2.p1.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. (1) We use a replay buffer to store previously generated samples that are randomly chosen to reinitialize the sampling chain (Equation <a href="#S3.E5" title="Equation 5 ‣ 3.2 Energy-based models ‣ 3 Background ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) instead of the uniform noise. (2) We apply random data augmentations (cropping, horizontal flipping, blurring, and color distortions) to images sampled from the buffer, which improves the diversity and mixing of the sampling chain. (3) We include additional losses that improve the contrastive-divergence training (see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> for details).</p>
</div>
</section>
<section id="S4.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">For contrastive pretraining,</h4>

<div id="S4.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px3.p1.1" class="ltx_p">we use the popular SimCLR method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
The standard SimCLR uses a standard ResNet-50 to extract visual representations and an additional projection head into the space where the contrastive loss is applied.
We swap the ResNet-50 for the one mentioned above and keep the standard projection head (a 1-layer MLP with ReLU activations).
This model is referred to as SimCLR<math id="S4.SS0.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S4.SS0.SSS0.Px3.p1.1.m1.1a"><mo id="S4.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px3.p1.1.m1.1b"><ci id="S4.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px3.p1.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px3.p1.1.m1.1c">\star</annotation></semantics></math> to emphasize the modified architecture. We use the same data augmentations as for EBM pretraining.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<figure id="S5.T1" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S5.T1.4" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.4.5.1" class="ltx_tr">
<th id="S5.T1.4.5.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.4.5.1.1.1" class="ltx_text" style="font-size:90%;">Split</span></th>
<th id="S5.T1.4.5.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.4.5.1.2.1" class="ltx_text" style="font-size:90%;">Object/color</span></th>
<td id="S5.T1.4.5.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.4.5.1.3.1" class="ltx_text" style="font-size:90%;">Nb. of</span></td>
<td id="S5.T1.4.5.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.4.5.1.4.1" class="ltx_text" style="font-size:90%;">Nb. of</span></td>
</tr>
<tr id="S5.T1.4.6.2" class="ltx_tr">
<th id="S5.T1.4.6.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"></th>
<th id="S5.T1.4.6.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.4.6.2.2.1" class="ltx_text" style="font-size:90%;">combinations</span></th>
<td id="S5.T1.4.6.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.4.6.2.3.1" class="ltx_text" style="font-size:90%;">images</span></td>
<td id="S5.T1.4.6.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.4.6.2.4.1" class="ltx_text" style="font-size:90%;">questions</span></td>
</tr>
<tr id="S5.T1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.1.1.2.1" class="ltx_text" style="font-size:90%;">Pretraining</span></th>
<th id="S5.T1.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><math id="S5.T1.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S5.T1.1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S5.T1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.m1.1b"><ci id="S5.T1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.m1.1c">\mathcal{A}</annotation></semantics></math></th>
<td id="S5.T1.1.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.1.1.3.1" class="ltx_text" style="font-size:90%;">12,000</span></td>
<td id="S5.T1.1.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.1.1.4.1" class="ltx_text" style="font-size:90%;">—</span></td>
</tr>
<tr id="S5.T1.2.2" class="ltx_tr">
<th id="S5.T1.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.2.2.2.1" class="ltx_text" style="font-size:90%;">Training</span></th>
<th id="S5.T1.2.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"><math id="S5.T1.2.2.1.m1.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="S5.T1.2.2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S5.T1.2.2.1.m1.1.1" xref="S5.T1.2.2.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.1.m1.1b"><ci id="S5.T1.2.2.1.m1.1.1.cmml" xref="S5.T1.2.2.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.1.m1.1c">\mathcal{B}</annotation></semantics></math></th>
<td id="S5.T1.2.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.2.2.3.1" class="ltx_text" style="font-size:90%;"> 3,600</span></td>
<td id="S5.T1.2.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.2.2.4.1" class="ltx_text" style="font-size:90%;">3,600</span></td>
</tr>
<tr id="S5.T1.3.3" class="ltx_tr">
<th id="S5.T1.3.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.3.3.2.1" class="ltx_text" style="font-size:90%;">Validation</span></th>
<th id="S5.T1.3.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"><math id="S5.T1.3.3.1.m1.1" class="ltx_Math" alttext="\mathcal{B}\cup\mathcal{C}" display="inline"><semantics id="S5.T1.3.3.1.m1.1a"><mrow id="S5.T1.3.3.1.m1.1.1" xref="S5.T1.3.3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S5.T1.3.3.1.m1.1.1.2" xref="S5.T1.3.3.1.m1.1.1.2.cmml">ℬ</mi><mo mathsize="90%" id="S5.T1.3.3.1.m1.1.1.1" xref="S5.T1.3.3.1.m1.1.1.1.cmml">∪</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S5.T1.3.3.1.m1.1.1.3" xref="S5.T1.3.3.1.m1.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.3.3.1.m1.1b"><apply id="S5.T1.3.3.1.m1.1.1.cmml" xref="S5.T1.3.3.1.m1.1.1"><union id="S5.T1.3.3.1.m1.1.1.1.cmml" xref="S5.T1.3.3.1.m1.1.1.1"></union><ci id="S5.T1.3.3.1.m1.1.1.2.cmml" xref="S5.T1.3.3.1.m1.1.1.2">ℬ</ci><ci id="S5.T1.3.3.1.m1.1.1.3.cmml" xref="S5.T1.3.3.1.m1.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.3.1.m1.1c">\mathcal{B}\cup\mathcal{C}</annotation></semantics></math></th>
<td id="S5.T1.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.3.3.3.1" class="ltx_text" style="font-size:90%;">   800</span></td>
<td id="S5.T1.3.3.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.3.3.4.1" class="ltx_text" style="font-size:90%;">  800</span></td>
</tr>
<tr id="S5.T1.4.4" class="ltx_tr">
<th id="S5.T1.4.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.4.4.2.1" class="ltx_text" style="font-size:90%;">Test</span></th>
<th id="S5.T1.4.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><math id="S5.T1.4.4.1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S5.T1.4.4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S5.T1.4.4.1.m1.1.1" xref="S5.T1.4.4.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S5.T1.4.4.1.m1.1b"><ci id="S5.T1.4.4.1.m1.1.1.cmml" xref="S5.T1.4.4.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.4.1.m1.1c">\mathcal{C}</annotation></semantics></math></th>
<td id="S5.T1.4.4.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.4.4.3.1" class="ltx_text" style="font-size:90%;"> 3,600</span></td>
<td id="S5.T1.4.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.4.4.4.1" class="ltx_text" style="font-size:90%;">3,600</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.T1.7" class="ltx_p ltx_figure_panel ltx_align_center"><span id="S5.T1.7.3" class="ltx_text ltx_font_italic" style="font-size:90%;">(a) Data splits.<span id="S5.T1.7.3.3" class="ltx_text ltx_font_upright">

<br class="ltx_break">


<span id="S5.T1.7.3.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_tbody">
<span id="S5.T1.7.3.3.3.4.1" class="ltx_tr">
<span id="S5.T1.7.3.3.3.4.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;"></span>
<span id="S5.T1.7.3.3.3.4.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;">Object</span>
<span id="S5.T1.7.3.3.3.4.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;">Color</span></span>
<span id="S5.T1.5.1.1.1.1" class="ltx_tr">
<span id="S5.T1.5.1.1.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_3" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.5.1.1.1.1.1.1" class="ltx_text"><math id="S5.T1.5.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S5.T1.5.1.1.1.1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S5.T1.5.1.1.1.1.1.1.m1.1.1" xref="S5.T1.5.1.1.1.1.1.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S5.T1.5.1.1.1.1.1.1.m1.1b"><ci id="S5.T1.5.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T1.5.1.1.1.1.1.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.1.1.1.1.1.1.m1.1c">\mathcal{A}</annotation></semantics></math></span></span>
<span id="S5.T1.5.1.1.1.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">Cylinder</span>
<span id="S5.T1.5.1.1.1.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">Any.</span></span>
<span id="S5.T1.7.3.3.3.5.2" class="ltx_tr">
<span id="S5.T1.7.3.3.3.5.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-left:0.0pt;padding-right:0.0pt;">Cube</span>
<span id="S5.T1.7.3.3.3.5.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;">Any.</span></span>
<span id="S5.T1.7.3.3.3.6.3" class="ltx_tr">
<span id="S5.T1.7.3.3.3.6.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-left:0.0pt;padding-right:0.0pt;">Sphere</span>
<span id="S5.T1.7.3.3.3.6.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;">Any.</span></span>
<span id="S5.T1.6.2.2.2.2" class="ltx_tr">
<span id="S5.T1.6.2.2.2.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_2" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.6.2.2.2.2.1.1" class="ltx_text"><math id="S5.T1.6.2.2.2.2.1.1.m1.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="S5.T1.6.2.2.2.2.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S5.T1.6.2.2.2.2.1.1.m1.1.1" xref="S5.T1.6.2.2.2.2.1.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S5.T1.6.2.2.2.2.1.1.m1.1b"><ci id="S5.T1.6.2.2.2.2.1.1.m1.1.1.cmml" xref="S5.T1.6.2.2.2.2.1.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.2.2.2.2.1.1.m1.1c">\mathcal{B}</annotation></semantics></math></span></span>
<span id="S5.T1.6.2.2.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">Cube</span>
<span id="S5.T1.6.2.2.2.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">Gray, blue, brown, yellow.</span></span>
<span id="S5.T1.7.3.3.3.7.4" class="ltx_tr">
<span id="S5.T1.7.3.3.3.7.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left" style="padding-left:0.0pt;padding-right:0.0pt;">Sphere</span>
<span id="S5.T1.7.3.3.3.7.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;">Red, green, purple, cyan.</span></span>
<span id="S5.T1.7.3.3.3.3" class="ltx_tr">
<span id="S5.T1.7.3.3.3.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t ltx_rowspan ltx_rowspan_2" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T1.7.3.3.3.3.1.1" class="ltx_text"><math id="S5.T1.7.3.3.3.3.1.1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S5.T1.7.3.3.3.3.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S5.T1.7.3.3.3.3.1.1.m1.1.1" xref="S5.T1.7.3.3.3.3.1.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S5.T1.7.3.3.3.3.1.1.m1.1b"><ci id="S5.T1.7.3.3.3.3.1.1.m1.1.1.cmml" xref="S5.T1.7.3.3.3.3.1.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.3.3.3.3.1.1.m1.1c">\mathcal{C}</annotation></semantics></math></span></span>
<span id="S5.T1.7.3.3.3.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">Cube</span>
<span id="S5.T1.7.3.3.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">Red, green, purple, cyan.</span></span>
<span id="S5.T1.7.3.3.3.8.5" class="ltx_tr">
<span id="S5.T1.7.3.3.3.8.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;">Sphere</span>
<span id="S5.T1.7.3.3.3.8.5.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;">Gray, blue, brown, yellow.</span></span>
</span>
</span>

<br class="ltx_break">
</span>(b) Sets of object/color combinations.<span id="S5.T1.7.3.4" class="ltx_text ltx_font_upright">

<br class="ltx_break"></span></span></p>
</div>
</div>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Summary of our diagnostic dataset. The pretraining, fine-tuning, and test splits contain different object/color combinations.</figcaption>
</figure>
<section id="S5.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Diagnostic dataset.</h4>

<div id="S5.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p1.1" class="ltx_p">Our main experiments use a custom controlled small-scale dataset, most similar to the existing CLEVR-CoGenT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>.
It similarly allows evaluating systematic generalization to unseen combinations of objects/colors.
The reason for a new small-scale dataset is our desire to evaluate EBMs, which remain computationally expensive at the time of this study (mid 2021).
Contemporary work on EBMs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> indeed focuses on small datasets like MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, CIFAR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> and CelebA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>.</p>
</div>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2206.14355/assets/Figures/ebm_fig_dataset/1.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="64" height="64" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2206.14355/assets/Figures/ebm_fig_dataset/2.png" id="S5.F3.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="64" height="64" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2206.14355/assets/Figures/ebm_fig_dataset/5.png" id="S5.F3.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="64" height="64" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2206.14355/assets/Figures/ebm_fig_dataset/6.png" id="S5.F3.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="64" height="64" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2206.14355/assets/Figures/ebm_fig_dataset/7.png" id="S5.F3.g5" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="64" height="64" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2206.14355/assets/Figures/ebm_fig_dataset/8.png" id="S5.F3.g6" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="64" height="64" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.4.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.5.2" class="ltx_text" style="font-size:90%;">Example images from our diagnostic dataset.
Questions are designed to query the object’s shape. For example, for the first image: <span id="S5.F3.5.2.1" class="ltx_text ltx_font_italic">There is a blue object in the image; what is it?</span>, with the correct answer being <span id="S5.F3.5.2.2" class="ltx_text ltx_font_italic">cube</span>.
</span></figcaption>
</figure>
<div id="S5.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p2.1" class="ltx_p">We generate our dataset following the procedure of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
We render <math id="S5.SS0.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="64\!\times\!64" display="inline"><semantics id="S5.SS0.SSS0.Px1.p2.1.m1.1a"><mrow id="S5.SS0.SSS0.Px1.p2.1.m1.1.1" xref="S5.SS0.SSS0.Px1.p2.1.m1.1.1.cmml"><mn id="S5.SS0.SSS0.Px1.p2.1.m1.1.1.2" xref="S5.SS0.SSS0.Px1.p2.1.m1.1.1.2.cmml">64</mn><mo lspace="0.052em" rspace="0.052em" id="S5.SS0.SSS0.Px1.p2.1.m1.1.1.1" xref="S5.SS0.SSS0.Px1.p2.1.m1.1.1.1.cmml">×</mo><mn id="S5.SS0.SSS0.Px1.p2.1.m1.1.1.3" xref="S5.SS0.SSS0.Px1.p2.1.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px1.p2.1.m1.1b"><apply id="S5.SS0.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px1.p2.1.m1.1.1"><times id="S5.SS0.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S5.SS0.SSS0.Px1.p2.1.m1.1.1.1"></times><cn type="integer" id="S5.SS0.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S5.SS0.SSS0.Px1.p2.1.m1.1.1.2">64</cn><cn type="integer" id="S5.SS0.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S5.SS0.SSS0.Px1.p2.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px1.p2.1.m1.1c">64\!\times\!64</annotation></semantics></math> images with Blender <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.
Each image contains one of three objects (sphere, cube, or cylinder) in one of eight colors (red, purple, yellow, blue, green, cyan, gray, or brown).
For each object/color combination, we generate 2000 samples, randomizing the object size, material (rubber or metallic), position, and lightning.
We assign disjoint subsets of object/color combinations to the pretraining, fine-tuning, and evaluation sets, as summarized in Table <a href="#S5.T1" title="Table 1 ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
The validation set contains a mix of in-domain (ID) and out-of-distribution (OOD) data, while the test set if fully OOD. The validation set serves to select hyperparameters and perform early stopping.</p>
</div>
<div id="S5.SS0.SSS0.Px1.p3" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p3.1" class="ltx_p">For each image, we use templates from CLEVR to generate a question that queries the object shape (<em id="S5.SS0.SSS0.Px1.p3.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS0.SSS0.Px1.p3.1.2" class="ltx_text"></span> <span id="S5.SS0.SSS0.Px1.p3.1.3" class="ltx_text ltx_font_italic">There is a blue object in the image; what is it?</span>, with the three possible answers <span id="S5.SS0.SSS0.Px1.p3.1.4" class="ltx_text ltx_font_italic">sphere</span>, <span id="S5.SS0.SSS0.Px1.p3.1.5" class="ltx_text ltx_font_italic">cube</span> and <span id="S5.SS0.SSS0.Px1.p3.1.6" class="ltx_text ltx_font_italic">cylinder</span>).
Because the range of questions is limited, <span id="S5.SS0.SSS0.Px1.p3.1.7" class="ltx_text ltx_font_bold">the input questions are in fact not necessary for a VQA model to find the correct answer. However they act as <em id="S5.SS0.SSS0.Px1.p3.1.7.1" class="ltx_emph ltx_font_italic">distractors</em> since they are spuriously correlated with the correct answers</span> because of mentioning colors.
A model relying on these spurious correlations would however perform badly on our test set because of the novel object/color combinations.
See Figure <a href="#S5.F3" title="Figure 3 ‣ Diagnostic dataset. ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> for examples.</p>
</div>
</section>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Generalization without/with pretraining</h3>

<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.17" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.17.18.1" class="ltx_tr">
<th id="S5.T2.17.18.1.1" class="ltx_td ltx_nopad_l ltx_th ltx_th_row ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;"></th>
<th id="S5.T2.17.18.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T2.17.18.1.2.1" class="ltx_text" style="font-size:90%;">Validation</span></th>
<th id="S5.T2.17.18.1.3" class="ltx_td ltx_nopad_l ltx_th ltx_th_column ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;"></th>
<th id="S5.T2.17.18.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;" colspan="3"><span id="S5.T2.17.18.1.4.1" class="ltx_text" style="font-size:90%;">Test</span></th>
</tr>
<tr id="S5.T2.17.19.2" class="ltx_tr">
<th id="S5.T2.17.19.2.1" class="ltx_td ltx_nopad_l ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"></th>
<th id="S5.T2.17.19.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T2.17.19.2.2.1" class="ltx_text" style="font-size:90%;">Overall</span></th>
<th id="S5.T2.17.19.2.3" class="ltx_td ltx_nopad_l ltx_th ltx_th_column" style="padding-left:0.0pt;padding-right:0.0pt;"></th>
<th id="S5.T2.17.19.2.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T2.17.19.2.4.1" class="ltx_text" style="font-size:90%;">Overall</span></th>
<th id="S5.T2.17.19.2.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T2.17.19.2.5.1" class="ltx_text" style="font-size:90%;">Cube only</span></th>
<th id="S5.T2.17.19.2.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T2.17.19.2.6.1" class="ltx_text" style="font-size:90%;">Sphere only</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.4.4" class="ltx_tr">
<th id="S5.T2.4.4.5" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T2.4.4.5.1" class="ltx_text" style="font-size:90%;">Baseline without visual pretraining</span></th>
<td id="S5.T2.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.1.1.1.1" class="ltx_text" style="font-size:90%;">56.96 </span><math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mo mathsize="80%" id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.1.1.1.2" class="ltx_text" style="font-size:80%;">6.08</span>
</td>
<td id="S5.T2.4.4.6" class="ltx_td ltx_nopad_l ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td id="S5.T2.2.2.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.2.2.2.1" class="ltx_text" style="font-size:90%;">12.78 </span><math id="S5.T2.2.2.2.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.2.2.2.m1.1a"><mo mathsize="80%" id="S5.T2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><csymbol cd="latexml" id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.2.2.2.2" class="ltx_text" style="font-size:80%;">9.75</span>
</td>
<td id="S5.T2.3.3.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.3.3.3.1" class="ltx_text" style="font-size:90%;">0.04 </span><math id="S5.T2.3.3.3.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.3.3.3.m1.1a"><mo mathsize="80%" id="S5.T2.3.3.3.m1.1.1" xref="S5.T2.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.m1.1b"><csymbol cd="latexml" id="S5.T2.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.3.3.3.2" class="ltx_text" style="font-size:80%;">0.06</span>
</td>
<td id="S5.T2.4.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.4.4.4.1" class="ltx_text" style="font-size:90%;">25.52 </span><math id="S5.T2.4.4.4.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.4.4.4.m1.1a"><mo mathsize="80%" id="S5.T2.4.4.4.m1.1.1" xref="S5.T2.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.m1.1b"><csymbol cd="latexml" id="S5.T2.4.4.4.m1.1.1.cmml" xref="S5.T2.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.4.4.4.2" class="ltx_text" style="font-size:80%;">19.57</span>
</td>
</tr>
<tr id="S5.T2.8.8" class="ltx_tr">
<th id="S5.T2.8.8.5" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T2.8.8.5.1" class="ltx_text" style="font-size:90%;">Baseline with supervised ImageNet pretraining</span></th>
<td id="S5.T2.5.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.5.5.1.1" class="ltx_text" style="font-size:90%;">99.43 </span><math id="S5.T2.5.5.1.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.5.5.1.m1.1a"><mo mathsize="80%" id="S5.T2.5.5.1.m1.1.1" xref="S5.T2.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.1.m1.1b"><csymbol cd="latexml" id="S5.T2.5.5.1.m1.1.1.cmml" xref="S5.T2.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.1.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.5.5.1.2" class="ltx_text" style="font-size:80%;">0.33</span>
</td>
<td id="S5.T2.8.8.6" class="ltx_td ltx_nopad_l" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td id="S5.T2.6.6.2" class="ltx_td ltx_nopad_l ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.6.6.2.1" class="ltx_text" style="font-size:90%;">99.14 </span><math id="S5.T2.6.6.2.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.6.6.2.m1.1a"><mo mathsize="80%" id="S5.T2.6.6.2.m1.1.1" xref="S5.T2.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.2.m1.1b"><csymbol cd="latexml" id="S5.T2.6.6.2.m1.1.1.cmml" xref="S5.T2.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.2.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.6.6.2.2" class="ltx_text" style="font-size:80%;">0.20</span>
</td>
<td id="S5.T2.7.7.3" class="ltx_td ltx_nopad_l ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.7.7.3.1" class="ltx_text" style="font-size:90%;">98.35 </span><math id="S5.T2.7.7.3.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.7.7.3.m1.1a"><mo mathsize="80%" id="S5.T2.7.7.3.m1.1.1" xref="S5.T2.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.3.m1.1b"><csymbol cd="latexml" id="S5.T2.7.7.3.m1.1.1.cmml" xref="S5.T2.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.3.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.7.7.3.2" class="ltx_text" style="font-size:80%;">0.33</span>
</td>
<td id="S5.T2.8.8.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.8.8.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">99.92</span><span id="S5.T2.8.8.4.2" class="ltx_text" style="font-size:90%;"> </span><math id="S5.T2.8.8.4.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.8.8.4.m1.1a"><mo mathsize="80%" id="S5.T2.8.8.4.m1.1.1" xref="S5.T2.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.4.m1.1b"><csymbol cd="latexml" id="S5.T2.8.8.4.m1.1.1.cmml" xref="S5.T2.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.4.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.8.8.4.3" class="ltx_text" style="font-size:80%;">0.09</span>
</td>
</tr>
<tr id="S5.T2.12.12" class="ltx_tr">
<th id="S5.T2.12.12.5" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T2.12.12.5.1" class="ltx_text" style="font-size:90%;">With self-supervised pretraining: EBM</span></th>
<td id="S5.T2.9.9.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.9.9.1.1" class="ltx_text" style="font-size:90%;">93.67 </span><math id="S5.T2.9.9.1.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.9.9.1.m1.1a"><mo mathsize="80%" id="S5.T2.9.9.1.m1.1.1" xref="S5.T2.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.1.m1.1b"><csymbol cd="latexml" id="S5.T2.9.9.1.m1.1.1.cmml" xref="S5.T2.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.1.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.9.9.1.2" class="ltx_text" style="font-size:80%;">3.18</span>
</td>
<td id="S5.T2.12.12.6" class="ltx_td ltx_nopad_l ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td id="S5.T2.10.10.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.10.10.2.1" class="ltx_text" style="font-size:90%;">86.74 </span><math id="S5.T2.10.10.2.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.10.10.2.m1.1a"><mo mathsize="80%" id="S5.T2.10.10.2.m1.1.1" xref="S5.T2.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.2.m1.1b"><csymbol cd="latexml" id="S5.T2.10.10.2.m1.1.1.cmml" xref="S5.T2.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.2.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.10.10.2.2" class="ltx_text" style="font-size:80%;">8.34</span>
</td>
<td id="S5.T2.11.11.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.11.11.3.1" class="ltx_text" style="font-size:90%;">96.57 </span><math id="S5.T2.11.11.3.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.11.11.3.m1.1a"><mo mathsize="80%" id="S5.T2.11.11.3.m1.1.1" xref="S5.T2.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.3.m1.1b"><csymbol cd="latexml" id="S5.T2.11.11.3.m1.1.1.cmml" xref="S5.T2.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.3.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.11.11.3.2" class="ltx_text" style="font-size:80%;">1.99</span>
</td>
<td id="S5.T2.12.12.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.12.12.4.1" class="ltx_text" style="font-size:90%;">76.91 </span><math id="S5.T2.12.12.4.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.12.12.4.m1.1a"><mo mathsize="80%" id="S5.T2.12.12.4.m1.1.1" xref="S5.T2.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.12.12.4.m1.1b"><csymbol cd="latexml" id="S5.T2.12.12.4.m1.1.1.cmml" xref="S5.T2.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.12.4.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.12.12.4.2" class="ltx_text" style="font-size:80%;">14.75</span>
</td>
</tr>
<tr id="S5.T2.17.17" class="ltx_tr">
<th id="S5.T2.13.13.1" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.13.13.1.1" class="ltx_text" style="font-size:90%;">With self-supervised pretraining: SimCLR</span><math id="S5.T2.13.13.1.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.T2.13.13.1.m1.1a"><mo mathsize="90%" id="S5.T2.13.13.1.m1.1.1" xref="S5.T2.13.13.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.T2.13.13.1.m1.1b"><ci id="S5.T2.13.13.1.m1.1.1.cmml" xref="S5.T2.13.13.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.13.1.m1.1c">\star</annotation></semantics></math><span id="S5.T2.13.13.1.2" class="ltx_text" style="font-size:90%;"></span>
</th>
<td id="S5.T2.14.14.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.14.14.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">99.75</span><span id="S5.T2.14.14.2.2" class="ltx_text" style="font-size:90%;"> </span><math id="S5.T2.14.14.2.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.14.14.2.m1.1a"><mo mathsize="80%" id="S5.T2.14.14.2.m1.1.1" xref="S5.T2.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.14.14.2.m1.1b"><csymbol cd="latexml" id="S5.T2.14.14.2.m1.1.1.cmml" xref="S5.T2.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.14.2.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.14.14.2.3" class="ltx_text" style="font-size:80%;">0.33</span>
</td>
<td id="S5.T2.17.17.6" class="ltx_td ltx_nopad_l ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td id="S5.T2.15.15.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.15.15.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">99.26</span><span id="S5.T2.15.15.3.2" class="ltx_text" style="font-size:90%;"> </span><math id="S5.T2.15.15.3.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.15.15.3.m1.1a"><mo mathsize="80%" id="S5.T2.15.15.3.m1.1.1" xref="S5.T2.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.15.15.3.m1.1b"><csymbol cd="latexml" id="S5.T2.15.15.3.m1.1.1.cmml" xref="S5.T2.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.15.3.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.15.15.3.3" class="ltx_text" style="font-size:80%;">0.29</span>
</td>
<td id="S5.T2.16.16.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.16.16.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">98.87</span><span id="S5.T2.16.16.4.2" class="ltx_text" style="font-size:90%;"> </span><math id="S5.T2.16.16.4.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.16.16.4.m1.1a"><mo mathsize="80%" id="S5.T2.16.16.4.m1.1.1" xref="S5.T2.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.16.16.4.m1.1b"><csymbol cd="latexml" id="S5.T2.16.16.4.m1.1.1.cmml" xref="S5.T2.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.16.4.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.16.16.4.3" class="ltx_text" style="font-size:80%;">0.27</span>
</td>
<td id="S5.T2.17.17.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T2.17.17.5.1" class="ltx_text" style="font-size:90%;">99.65 </span><math id="S5.T2.17.17.5.m1.1" class="ltx_Math" alttext="\pm\," display="inline"><semantics id="S5.T2.17.17.5.m1.1a"><mo mathsize="80%" id="S5.T2.17.17.5.m1.1.1" xref="S5.T2.17.17.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.17.17.5.m1.1b"><csymbol cd="latexml" id="S5.T2.17.17.5.m1.1.1.cmml" xref="S5.T2.17.17.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.17.5.m1.1c">\pm\,</annotation></semantics></math><span id="S5.T2.17.17.5.2" class="ltx_text" style="font-size:80%;">0.32</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>Main results (average accuracy in % <math id="S5.T2.20.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.20.m1.1b"><mo id="S5.T2.20.m1.1.1" xref="S5.T2.20.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.20.m1.1c"><csymbol cd="latexml" id="S5.T2.20.m1.1.1.cmml" xref="S5.T2.20.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.20.m1.1d">\pm</annotation></semantics></math> one standard deviation over 3 random seeds).
The baseline overfits to spurious correlations in the training data and performs poorly on the OOD validation and test sets.
The EBM pretraining improves generalization, but SimCLR<math id="S5.T2.21.m2.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.T2.21.m2.1b"><mo id="S5.T2.21.m2.1.1" xref="S5.T2.21.m2.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.T2.21.m2.1c"><ci id="S5.T2.21.m2.1.1.cmml" xref="S5.T2.21.m2.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.21.m2.1d">\star</annotation></semantics></math> performs significantly better and achieves near-perfect accuracy.</figcaption>
</figure>
<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.2" class="ltx_p">We report our main results in Table <a href="#S5.T2" title="Table 2 ‣ 5.1 Generalization without/with pretraining ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
We compare models built with an EBM– or CL–pretrained vision encoder, with a baseline that is not pretrained, <em id="S5.SS1.p1.2.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS1.p1.2.3" class="ltx_text"></span> only trained with supervision on the VQA data.
The baseline overfits to the particular object/color combinations of the VQA data and is therefore unable to generalize to the novel combinations of the validation (ID+OOD data) nor test splits (fully OOD data).
Of our pretrained models, <span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_bold">the CL method (SimCLR<math id="S5.SS1.p1.1.1.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.SS1.p1.1.1.m1.1a"><mo id="S5.SS1.p1.1.1.m1.1.1" xref="S5.SS1.p1.1.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.1.m1.1b"><ci id="S5.SS1.p1.1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.1.m1.1c">\star</annotation></semantics></math>) achieves the highest, near-perfect accuracy of 99.26% on the test set.</span>
It seems to better disentangle the representations of shape from color, such that the VQA model can generalize to new combinations at test time without overfitting to the particular combinations seen during training.
EBM pretraining also improves generalization (86.74% on the test set) but with a high variance across runs (standard deviation of 8.34%).
SimCLR<math id="S5.SS1.p1.2.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.SS1.p1.2.m1.1a"><mo id="S5.SS1.p1.2.m1.1.1" xref="S5.SS1.p1.2.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m1.1b"><ci id="S5.SS1.p1.2.m1.1.1.cmml" xref="S5.SS1.p1.2.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m1.1c">\star</annotation></semantics></math> shows no such stability issues (standard deviation of 0.29%).</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">We also evaluate a model with ImageNet-pretrained ResNet-18 as the visual encoder, which is the most common paradigm for pretraining via transfer learning.
However the comparison is relatively unfair to our self-supervised models since this model relies on vastly more pretraining data as well as the ImageNet labels.
Still, SimCLR<math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mo id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">\star</annotation></semantics></math> performs on par with this model.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">We also experimented with using our pretrained visual encoders frozen within a VQA model.
These results were always worse than with fine-tuning and are not included in the tables.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Amount of pretraining data</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">To better understand the benefits of pretraining in low-data regimes, we repeat our experiments while decreasing the amount of pretraining data (unlabeled images) or labeled training data (VQA examples).
See Figures <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:experiments_data_size_train</span>–<span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:experiments_data_size_finetune</span>.</p>
</div>
<figure id="S5.F4" class="ltx_figure">
</figure>
<figure id="S5.F5" class="ltx_figure">
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Out-of-distribution detection</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">OOD Detection is relevant to VQA because it can help determine whether a given image/question is answerable <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.
An image of low quality or from a different domain than the training examples (<em id="S5.SS3.p1.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS3.p1.1.2" class="ltx_text"></span> clip art vs. photographs) can be detected as OOD and warn the user that the VQA model may not be reliable on this particular input.
A common baseline for OOD detection with a discriminative model (such as our VQA model pretrained with CL) is to compare the top softmax score with a predefined threshold. A low score means a low confidence hence an OOD sample <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>.
EBMs have been purported to be useful for OOD detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> by their generative nature since they specifically model the distribution of the training data.
To use EBMs for OOD detection, one can simply compare the negative energy estimated by the model with a threshold.</p>
</div>
<section id="S5.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Experimental setup.</h4>

<div id="S5.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS3.SSS0.Px1.p1.1" class="ltx_p">We evaluate our EBM and CL visual encoders from Section <a href="#S5.SS1" title="5.1 Generalization without/with pretraining ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>.
As ID test data, we use the images from the test set of our toy VQA task.
As OOD data, we use images from various existing datasets (CIFAR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, SVHN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>, and VQA v2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>) as well as images of random noise, of cone shapes (of similar style as the toy VQA data), and of empty backgrounds (see Figure <a href="#S5.F6" title="Figure 6 ‣ Results. ‣ 5.3 Out-of-distribution detection ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>).
We compare our SimCLR<math id="S5.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.SS3.SSS0.Px1.p1.1.m1.1a"><mo id="S5.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px1.p1.1.m1.1b"><ci id="S5.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S5.SS3.SSS0.Px1.p1.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px1.p1.1.m1.1c">\star</annotation></semantics></math> and EBM models using their softmax score and negative energy, respectively, for OOD detection.
To quantify detection performance across possible thresholds, we compute the area under the ROC curve (AUROC).</p>
</div>
</section>
<section id="S5.SS3.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4>

<div id="S5.SS3.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS3.SSS0.Px2.p1.1" class="ltx_p">On five out of our seven datasets, EBMs are superior to CL (see Table <a href="#S5.T3" title="Table 3 ‣ Results. ‣ 5.3 Out-of-distribution detection ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
They can distinguish ID from OOD data almost perfectly (AUROC of <math id="S5.SS3.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS3.SSS0.Px2.p1.1.m1.1a"><mo id="S5.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px2.p1.1.m1.1b"><csymbol cd="latexml" id="S5.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS3.SSS0.Px2.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px2.p1.1.m1.1c">\sim</annotation></semantics></math>1.0).
However, when the OOD data is visually similar to the training data (<em id="S5.SS3.SSS0.Px2.p1.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS3.SSS0.Px2.p1.1.2" class="ltx_text"></span> images of backgrounds and cones), the detection performance of our EBM falls well below CL.
<span id="S5.SS3.SSS0.Px2.p1.1.3" class="ltx_text ltx_font_bold">The estimated energies appear generally reliable for filtering out OOD samples, but they seem less able to spot fine-grained differences.</span>
See also Figure <a href="#S5.F7" title="Figure 7 ‣ Results. ‣ 5.3 Out-of-distribution detection ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> for the distributions of scores over different datasets.</p>
</div>
<figure id="S5.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/cifar.png" id="S5.F6.sf1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="359" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.sf1.3.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F6.sf1.4.2" class="ltx_text" style="font-size:80%;">CIFAR</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/mnist.png" id="S5.F6.sf2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="359" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.sf2.3.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F6.sf2.4.2" class="ltx_text" style="font-size:80%;">MNIST</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F6.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/svhn.png" id="S5.F6.sf3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="359" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.sf3.3.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S5.F6.sf3.4.2" class="ltx_text" style="font-size:80%;">SVHN</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/vqa.png" id="S5.F6.sf4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="359" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.sf4.3.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="S5.F6.sf4.4.2" class="ltx_text" style="font-size:80%;">VQA v2</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/background.png" id="S5.F6.sf5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="359" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.sf5.3.1.1" class="ltx_text" style="font-size:90%;">(e)</span> </span><span id="S5.F6.sf5.4.2" class="ltx_text" style="font-size:80%;">Background</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F6.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/cone.png" id="S5.F6.sf6.g1" class="ltx_graphics ltx_centering ltx_img_square" width="359" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.sf6.3.1.1" class="ltx_text" style="font-size:90%;">(f)</span> </span><span id="S5.F6.sf6.4.2" class="ltx_text" style="font-size:80%;">Cones</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S5.F6.3.2" class="ltx_text" style="font-size:90%;">Test examples used in our OOD detection experiment.</span></figcaption>
</figure>
<figure id="S5.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/noise_ebm.png" id="S5.F7.sf1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="411" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F7.sf1.3.2" class="ltx_text" style="font-size:90%;">EBM (random noise)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/noise_sim.png" id="S5.F7.sf2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="418" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.sf2.4.2.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F7.sf2.2.1" class="ltx_text" style="font-size:90%;">SimCLR<math id="S5.F7.sf2.2.1.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.F7.sf2.2.1.m1.1b"><mo id="S5.F7.sf2.2.1.m1.1.1" xref="S5.F7.sf2.2.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.F7.sf2.2.1.m1.1c"><ci id="S5.F7.sf2.2.1.m1.1.1.cmml" xref="S5.F7.sf2.2.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.sf2.2.1.m1.1d">\star</annotation></semantics></math> (random noise)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F7.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/cifar_ebm.png" id="S5.F7.sf3.g1" class="ltx_graphics ltx_img_landscape" width="598" height="418" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S5.F7.sf3.3.2" class="ltx_text" style="font-size:90%;">EBM (CIFAR)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F7.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/cifar_sim.png" id="S5.F7.sf4.g1" class="ltx_graphics ltx_img_landscape" width="598" height="418" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.sf4.4.2.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="S5.F7.sf4.2.1" class="ltx_text" style="font-size:90%;">SimCLR<math id="S5.F7.sf4.2.1.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.F7.sf4.2.1.m1.1b"><mo id="S5.F7.sf4.2.1.m1.1.1" xref="S5.F7.sf4.2.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.F7.sf4.2.1.m1.1c"><ci id="S5.F7.sf4.2.1.m1.1.1.cmml" xref="S5.F7.sf4.2.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.sf4.2.1.m1.1d">\star</annotation></semantics></math> (CIFAR)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F7.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/empty_ebm.png" id="S5.F7.sf5.g1" class="ltx_graphics ltx_img_landscape" width="598" height="418" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.sf5.2.1.1" class="ltx_text" style="font-size:90%;">(e)</span> </span><span id="S5.F7.sf5.3.2" class="ltx_text" style="font-size:90%;">EBM (backgrounds)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F7.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/empty_sim.png" id="S5.F7.sf6.g1" class="ltx_graphics ltx_img_landscape" width="598" height="418" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.sf6.4.2.1" class="ltx_text" style="font-size:90%;">(f)</span> </span><span id="S5.F7.sf6.2.1" class="ltx_text" style="font-size:90%;">SimCLR<math id="S5.F7.sf6.2.1.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.F7.sf6.2.1.m1.1b"><mo id="S5.F7.sf6.2.1.m1.1.1" xref="S5.F7.sf6.2.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.F7.sf6.2.1.m1.1c"><ci id="S5.F7.sf6.2.1.m1.1.1.cmml" xref="S5.F7.sf6.2.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.sf6.2.1.m1.1d">\star</annotation></semantics></math> (backgrounds)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F7.sf7" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/cone_ebm.png" id="S5.F7.sf7.g1" class="ltx_graphics ltx_img_landscape" width="598" height="418" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.sf7.2.1.1" class="ltx_text" style="font-size:90%;">(g)</span> </span><span id="S5.F7.sf7.3.2" class="ltx_text" style="font-size:90%;">EBM (cones)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F7.sf8" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2206.14355/assets/Figures/cone_sim.png" id="S5.F7.sf8.g1" class="ltx_graphics ltx_img_landscape" width="598" height="418" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.sf8.4.2.1" class="ltx_text" style="font-size:90%;">(h)</span> </span><span id="S5.F7.sf8.2.1" class="ltx_text" style="font-size:90%;">SimCLR<math id="S5.F7.sf8.2.1.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.F7.sf8.2.1.m1.1b"><mo id="S5.F7.sf8.2.1.m1.1.1" xref="S5.F7.sf8.2.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.F7.sf8.2.1.m1.1c"><ci id="S5.F7.sf8.2.1.m1.1.1.cmml" xref="S5.F7.sf8.2.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.sf8.2.1.m1.1d">\star</annotation></semantics></math> (cones)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.4.2.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S5.F7.2.1" class="ltx_text" style="font-size:90%;">OOD Detection experiment. Distributions of energy and softmax scores, respectively from an EBM (left column) and a SimCLR<math id="S5.F7.2.1.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.F7.2.1.m1.1b"><mo id="S5.F7.2.1.m1.1.1" xref="S5.F7.2.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.F7.2.1.m1.1c"><ci id="S5.F7.2.1.m1.1.1.cmml" xref="S5.F7.2.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.2.1.m1.1d">\star</annotation></semantics></math> model (right column) with test data from various sources (rows).
EBMs allow separating ID from OOD data almost perfectly by simple thresholding on some datasets (a,c).
However they do poorly when ID and OOD data are visual similar (e,g).</span></figcaption>
</figure>
<figure id="S5.T3" class="ltx_table">
<table id="S5.T3.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.6.7.1" class="ltx_tr">
<th id="S5.T3.6.7.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;"></th>
<th id="S5.T3.6.7.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;" colspan="7"><span id="S5.T3.6.7.1.2.1" class="ltx_text" style="font-size:90%;">Source of OOD test data</span></th>
</tr>
<tr id="S5.T3.6.8.2" class="ltx_tr">
<th id="S5.T3.6.8.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"></th>
<th id="S5.T3.6.8.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.8.2.2.1" class="ltx_text" style="font-size:90%;">Noise</span></th>
<th id="S5.T3.6.8.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.8.2.3.1" class="ltx_text" style="font-size:90%;">CIFAR</span></th>
<th id="S5.T3.6.8.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.8.2.4.1" class="ltx_text" style="font-size:90%;">MNIST</span></th>
<th id="S5.T3.6.8.2.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.8.2.5.1" class="ltx_text" style="font-size:90%;">SVHN</span></th>
<th id="S5.T3.6.8.2.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.8.2.6.1" class="ltx_text" style="font-size:90%;">VQA v2</span></th>
<th id="S5.T3.6.8.2.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.8.2.7.1" class="ltx_text" style="font-size:90%;">Background</span></th>
<th id="S5.T3.6.8.2.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.8.2.8.1" class="ltx_text" style="font-size:90%;">Cones</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.5.5" class="ltx_tr">
<th id="S5.T3.5.5.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_th ltx_th_row ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T3.5.5.6.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.5.5.6.1.1" class="ltx_p"><span id="S5.T3.5.5.6.1.1.1" class="ltx_text" style="font-size:90%;">EBM</span></span>
</span>
</th>
<td id="S5.T3.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<math id="S5.T3.1.1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.T3.1.1.1.m1.1a"><mo mathsize="90%" id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.1c">\sim</annotation></semantics></math><span id="S5.T3.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">1.00</span>
</td>
<td id="S5.T3.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<math id="S5.T3.2.2.2.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.T3.2.2.2.m1.1a"><mo mathsize="90%" id="S5.T3.2.2.2.m1.1.1" xref="S5.T3.2.2.2.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.m1.1b"><csymbol cd="latexml" id="S5.T3.2.2.2.m1.1.1.cmml" xref="S5.T3.2.2.2.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.m1.1c">\sim</annotation></semantics></math><span id="S5.T3.2.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">1.00</span>
</td>
<td id="S5.T3.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<math id="S5.T3.3.3.3.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.T3.3.3.3.m1.1a"><mo mathsize="90%" id="S5.T3.3.3.3.m1.1.1" xref="S5.T3.3.3.3.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.m1.1b"><csymbol cd="latexml" id="S5.T3.3.3.3.m1.1.1.cmml" xref="S5.T3.3.3.3.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.m1.1c">\sim</annotation></semantics></math><span id="S5.T3.3.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">1.00</span>
</td>
<td id="S5.T3.4.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<math id="S5.T3.4.4.4.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.T3.4.4.4.m1.1a"><mo mathsize="90%" id="S5.T3.4.4.4.m1.1.1" xref="S5.T3.4.4.4.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.4.m1.1b"><csymbol cd="latexml" id="S5.T3.4.4.4.m1.1.1.cmml" xref="S5.T3.4.4.4.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.4.m1.1c">\sim</annotation></semantics></math><span id="S5.T3.4.4.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">1.00</span>
</td>
<td id="S5.T3.5.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<math id="S5.T3.5.5.5.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.T3.5.5.5.m1.1a"><mo mathsize="90%" id="S5.T3.5.5.5.m1.1.1" xref="S5.T3.5.5.5.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.T3.5.5.5.m1.1b"><csymbol cd="latexml" id="S5.T3.5.5.5.m1.1.1.cmml" xref="S5.T3.5.5.5.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.5.5.m1.1c">\sim</annotation></semantics></math><span id="S5.T3.5.5.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">1.00</span>
</td>
<td id="S5.T3.5.5.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.5.5.7.1" class="ltx_text" style="font-size:90%;">0.52</span></td>
<td id="S5.T3.5.5.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.5.5.8.1" class="ltx_text" style="font-size:90%;">0.30</span></td>
</tr>
<tr id="S5.T3.6.6" class="ltx_tr">
<th id="S5.T3.6.6.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_th ltx_th_row ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T3.6.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.6.6.1.1.1" class="ltx_p"><span id="S5.T3.6.6.1.1.1.1" class="ltx_text" style="font-size:90%;">SimCLR</span><math id="S5.T3.6.6.1.1.1.m1.1" class="ltx_Math" alttext="\star" display="inline"><semantics id="S5.T3.6.6.1.1.1.m1.1a"><mo mathsize="90%" id="S5.T3.6.6.1.1.1.m1.1.1" xref="S5.T3.6.6.1.1.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S5.T3.6.6.1.1.1.m1.1b"><ci id="S5.T3.6.6.1.1.1.m1.1.1.cmml" xref="S5.T3.6.6.1.1.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.6.1.1.1.m1.1c">\star</annotation></semantics></math></span>
</span>
</th>
<td id="S5.T3.6.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.6.2.1" class="ltx_text" style="font-size:90%;">   0.96</span></td>
<td id="S5.T3.6.6.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.6.3.1" class="ltx_text" style="font-size:90%;">   0.92</span></td>
<td id="S5.T3.6.6.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.6.4.1" class="ltx_text" style="font-size:90%;">   0.97</span></td>
<td id="S5.T3.6.6.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.6.5.1" class="ltx_text" style="font-size:90%;">   0.91</span></td>
<td id="S5.T3.6.6.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.6.6.1" class="ltx_text" style="font-size:90%;">   0.94</span></td>
<td id="S5.T3.6.6.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.6.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.94</span></td>
<td id="S5.T3.6.6.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T3.6.6.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">0.82</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>OOD Detection experiment. The AUROC is near-perfect (<math id="S5.T3.8.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.T3.8.m1.1b"><mo id="S5.T3.8.m1.1.1" xref="S5.T3.8.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.T3.8.m1.1c"><csymbol cd="latexml" id="S5.T3.8.m1.1.1.cmml" xref="S5.T3.8.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.8.m1.1d">\sim</annotation></semantics></math>1.0) for our EBM model on most test sets.
However, it falls well below our CL model when the OOD test data is visually similar to the training (ID) data (last two columns).</figcaption>
</figure>
</section>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Supervised energy-based training</h3>

<figure id="S5.T4" class="ltx_table">
<table id="S5.T4.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T4.2.1.1" class="ltx_tr">
<th id="S5.T4.2.1.1.1" class="ltx_td ltx_nopad_l ltx_th ltx_th_row ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;"></th>
<td id="S5.T4.2.1.1.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;" colspan="4"><span id="S5.T4.2.1.1.2.1" class="ltx_text" style="font-size:90%;">Answer accuracy (%)</span></td>
<td id="S5.T4.2.1.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.1.1.3.1" class="ltx_text" style="font-size:90%;">Calibration</span></td>
</tr>
<tr id="S5.T4.2.2.2" class="ltx_tr">
<th id="S5.T4.2.2.2.1" class="ltx_td ltx_nopad_l ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"></th>
<td id="S5.T4.2.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.2.2.2.1" class="ltx_text" style="font-size:90%;">Overall</span></td>
<td id="S5.T4.2.2.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.2.2.3.1" class="ltx_text" style="font-size:90%;">Spheres</span></td>
<td id="S5.T4.2.2.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.2.2.4.1" class="ltx_text" style="font-size:90%;">Cubes</span></td>
<td id="S5.T4.2.2.2.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.2.2.5.1" class="ltx_text" style="font-size:90%;">Cylinders</span></td>
<td id="S5.T4.2.2.2.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.2.2.6.1" class="ltx_text" style="font-size:90%;">ECE (%)</span></td>
</tr>
<tr id="S5.T4.2.3.3" class="ltx_tr">
<th id="S5.T4.2.3.3.1" class="ltx_td ltx_nopad_l ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"></th>
<td id="S5.T4.2.3.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r" style="padding-left:0.0pt;padding-right:0.0pt;"></td>
<td id="S5.T4.2.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.3.3.3.1" class="ltx_text" style="font-size:70%;">(Seen combinations)</span></td>
<td id="S5.T4.2.3.3.4" class="ltx_td ltx_nopad_l ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;" colspan="2"><span id="S5.T4.2.3.3.4.1" class="ltx_text" style="font-size:70%;">(OOD object/color combinations)</span></td>
<td id="S5.T4.2.3.3.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.3.3.5.1" class="ltx_text" style="font-size:70%;">(Lower is better)</span></td>
</tr>
<tr id="S5.T4.2.4.4" class="ltx_tr">
<th id="S5.T4.2.4.4.1" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.4.4.1.1" class="ltx_text" style="font-size:90%;">Random guessing</span></th>
<td id="S5.T4.2.4.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.4.4.2.1" class="ltx_text" style="font-size:90%;">33.34</span></td>
<td id="S5.T4.2.4.4.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.4.4.3.1" class="ltx_text" style="font-size:90%;">33.34</span></td>
<td id="S5.T4.2.4.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.4.4.4.1" class="ltx_text" style="font-size:90%;">33.34</span></td>
<td id="S5.T4.2.4.4.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.4.4.5.1" class="ltx_text" style="font-size:90%;">33.34</span></td>
<td id="S5.T4.2.4.4.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.4.4.6.1" class="ltx_text" style="font-size:90%;">—</span></td>
</tr>
<tr id="S5.T4.2.5.5" class="ltx_tr">
<th id="S5.T4.2.5.5.1" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.5.5.1.1" class="ltx_text" style="font-size:90%;">Baseline, cross-entropy classification objective</span></th>
<td id="S5.T4.2.5.5.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.5.5.2.1" class="ltx_text" style="font-size:90%;">33.34</span></td>
<td id="S5.T4.2.5.5.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.5.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">100.00</span></td>
<td id="S5.T4.2.5.5.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.5.5.4.1" class="ltx_text" style="font-size:90%;">0.00</span></td>
<td id="S5.T4.2.5.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.5.5.5.1" class="ltx_text" style="font-size:90%;">0.00</span></td>
<td id="S5.T4.2.5.5.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.5.5.6.1" class="ltx_text" style="font-size:90%;">71.54</span></td>
</tr>
<tr id="S5.T4.2.6.6" class="ltx_tr">
<th id="S5.T4.2.6.6.1" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T4.2.6.6.1.1" class="ltx_text" style="font-size:90%;">Standard JEM </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T4.2.6.6.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib24" title="" class="ltx_ref">24</a><span id="S5.T4.2.6.6.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S5.T4.2.6.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.6.6.2.1" class="ltx_text" style="font-size:90%;">29.98</span></td>
<td id="S5.T4.2.6.6.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.6.6.3.1" class="ltx_text" style="font-size:90%;">99.93</span></td>
<td id="S5.T4.2.6.6.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.6.6.4.1" class="ltx_text" style="font-size:90%;">0.00</span></td>
<td id="S5.T4.2.6.6.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.6.6.5.1" class="ltx_text" style="font-size:90%;">0.00</span></td>
<td id="S5.T4.2.6.6.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.6.6.6.1" class="ltx_text" style="font-size:90%;">71.28</span></td>
</tr>
<tr id="S5.T4.2.7.7" class="ltx_tr">
<th id="S5.T4.2.7.7.1" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.7.7.1.1" class="ltx_text" style="font-size:90%;">Modified JEM: downscaled classification loss &amp; early stopping</span></th>
<td id="S5.T4.2.7.7.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.7.7.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">49.10</span></td>
<td id="S5.T4.2.7.7.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.7.7.3.1" class="ltx_text" style="font-size:90%;">99.93</span></td>
<td id="S5.T4.2.7.7.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.7.7.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">39.23</span></td>
<td id="S5.T4.2.7.7.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.7.7.5.1" class="ltx_text" style="font-size:90%;">8.12</span></td>
<td id="S5.T4.2.7.7.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.7.7.6.1" class="ltx_text" style="font-size:90%;">36.55</span></td>
</tr>
<tr id="S5.T4.2.8.8" class="ltx_tr">
<th id="S5.T4.2.8.8.1" class="ltx_td ltx_nopad_l ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;">
<span id="S5.T4.2.8.8.1.1" class="ltx_text" style="font-size:90%;">CEBM </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T4.2.8.8.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib19" title="" class="ltx_ref">19</a><span id="S5.T4.2.8.8.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S5.T4.2.8.8.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.8.8.2.1" class="ltx_text" style="font-size:90%;">35.75</span></td>
<td id="S5.T4.2.8.8.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.8.8.3.1" class="ltx_text" style="font-size:90%;">54.60</span></td>
<td id="S5.T4.2.8.8.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.8.8.4.1" class="ltx_text" style="font-size:90%;">31.56</span></td>
<td id="S5.T4.2.8.8.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.8.8.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">21.10</span></td>
<td id="S5.T4.2.8.8.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:0.0pt;padding-right:0.0pt;"><span id="S5.T4.2.8.8.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">9.24</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4: </span>Supervised energy-based training of a VQA model. Modified JEM correctly classifies some of the OOD samples and improves calibration over the standard classification baseline. However, its performance is still far below optimal.</figcaption>
</figure>
<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">This section looks at energy-based methods for training the VQA model itself <em id="S5.SS4.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS4.p1.1.2" class="ltx_text"></span> not solely the visual encoder.
In our experiments so far, EBMs have proved generally inferior to CL.
This section investigates whether other purported capabilities of EBMs have value for VQA.
We look in particular at (1) their ability to simultaneously address generative and discriminative tasks and (2) their improved calibration compared to standard discriminative models.
We test two existing energy-based methods to train the VQA model with supervision from standard question/image/answer triplets.</p>
</div>
<section id="S5.SS4.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Setup.</h4>

<div id="S5.SS4.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS4.SSS0.Px1.p1.1" class="ltx_p">We use a dataset similar to Section <a href="#S5.SS0.SSS0.Px1" title="Diagnostic dataset. ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> that allows evaluating ID and OOD accuracy.
Every image/question contains either a sphere, a cube, or a cylinder.
Spheres can be of any color (ID test data),
whereas the sets of possible colors of cubes and cylinders are disjoint and swapped between training and test (OOD data).
Our baseline is the same CNN–LSTM as mentioned in Section <a href="#S4" title="4 Our implementation ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
The JEM and CEBM methods build on this same architecture.
We briefly review these methods before presenting our results.</p>
</div>
</section>
<section id="S5.SS4.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">The JEM approach</h4>

<div id="S5.SS4.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS4.SSS0.Px2.p1.4" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> treats a discriminative classifier as an energy-based model by optimizing a double objective:</p>
<table id="S5.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E10.m1.4" class="ltx_Math" alttext="\log p_{{\boldsymbol{\theta}}}({\boldsymbol{x}},y)~{}=~{}\log p_{{\boldsymbol{\theta}}}({\boldsymbol{x}})+\log p_{{\boldsymbol{\theta}}}(y|{\boldsymbol{x}})~{}," display="block"><semantics id="S5.E10.m1.4a"><mrow id="S5.E10.m1.4.4.1" xref="S5.E10.m1.4.4.1.1.cmml"><mrow id="S5.E10.m1.4.4.1.1" xref="S5.E10.m1.4.4.1.1.cmml"><mrow id="S5.E10.m1.4.4.1.1.3" xref="S5.E10.m1.4.4.1.1.3.cmml"><mrow id="S5.E10.m1.4.4.1.1.3.2" xref="S5.E10.m1.4.4.1.1.3.2.cmml"><mi id="S5.E10.m1.4.4.1.1.3.2.1" xref="S5.E10.m1.4.4.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S5.E10.m1.4.4.1.1.3.2a" xref="S5.E10.m1.4.4.1.1.3.2.cmml">⁡</mo><msub id="S5.E10.m1.4.4.1.1.3.2.2" xref="S5.E10.m1.4.4.1.1.3.2.2.cmml"><mi id="S5.E10.m1.4.4.1.1.3.2.2.2" xref="S5.E10.m1.4.4.1.1.3.2.2.2.cmml">p</mi><mi id="S5.E10.m1.4.4.1.1.3.2.2.3" xref="S5.E10.m1.4.4.1.1.3.2.2.3.cmml">𝜽</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S5.E10.m1.4.4.1.1.3.1" xref="S5.E10.m1.4.4.1.1.3.1.cmml">​</mo><mrow id="S5.E10.m1.4.4.1.1.3.3.2" xref="S5.E10.m1.4.4.1.1.3.3.1.cmml"><mo stretchy="false" id="S5.E10.m1.4.4.1.1.3.3.2.1" xref="S5.E10.m1.4.4.1.1.3.3.1.cmml">(</mo><mi id="S5.E10.m1.1.1" xref="S5.E10.m1.1.1.cmml">𝒙</mi><mo id="S5.E10.m1.4.4.1.1.3.3.2.2" xref="S5.E10.m1.4.4.1.1.3.3.1.cmml">,</mo><mi id="S5.E10.m1.2.2" xref="S5.E10.m1.2.2.cmml">y</mi><mo rspace="0.330em" stretchy="false" id="S5.E10.m1.4.4.1.1.3.3.2.3" xref="S5.E10.m1.4.4.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.608em" id="S5.E10.m1.4.4.1.1.2" xref="S5.E10.m1.4.4.1.1.2.cmml">=</mo><mrow id="S5.E10.m1.4.4.1.1.1" xref="S5.E10.m1.4.4.1.1.1.cmml"><mrow id="S5.E10.m1.4.4.1.1.1.3" xref="S5.E10.m1.4.4.1.1.1.3.cmml"><mrow id="S5.E10.m1.4.4.1.1.1.3.2" xref="S5.E10.m1.4.4.1.1.1.3.2.cmml"><mi id="S5.E10.m1.4.4.1.1.1.3.2.1" xref="S5.E10.m1.4.4.1.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S5.E10.m1.4.4.1.1.1.3.2a" xref="S5.E10.m1.4.4.1.1.1.3.2.cmml">⁡</mo><msub id="S5.E10.m1.4.4.1.1.1.3.2.2" xref="S5.E10.m1.4.4.1.1.1.3.2.2.cmml"><mi id="S5.E10.m1.4.4.1.1.1.3.2.2.2" xref="S5.E10.m1.4.4.1.1.1.3.2.2.2.cmml">p</mi><mi id="S5.E10.m1.4.4.1.1.1.3.2.2.3" xref="S5.E10.m1.4.4.1.1.1.3.2.2.3.cmml">𝜽</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S5.E10.m1.4.4.1.1.1.3.1" xref="S5.E10.m1.4.4.1.1.1.3.1.cmml">​</mo><mrow id="S5.E10.m1.4.4.1.1.1.3.3.2" xref="S5.E10.m1.4.4.1.1.1.3.cmml"><mo stretchy="false" id="S5.E10.m1.4.4.1.1.1.3.3.2.1" xref="S5.E10.m1.4.4.1.1.1.3.cmml">(</mo><mi id="S5.E10.m1.3.3" xref="S5.E10.m1.3.3.cmml">𝒙</mi><mo stretchy="false" id="S5.E10.m1.4.4.1.1.1.3.3.2.2" xref="S5.E10.m1.4.4.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S5.E10.m1.4.4.1.1.1.2" xref="S5.E10.m1.4.4.1.1.1.2.cmml">+</mo><mrow id="S5.E10.m1.4.4.1.1.1.1" xref="S5.E10.m1.4.4.1.1.1.1.cmml"><mrow id="S5.E10.m1.4.4.1.1.1.1.3" xref="S5.E10.m1.4.4.1.1.1.1.3.cmml"><mi id="S5.E10.m1.4.4.1.1.1.1.3.1" xref="S5.E10.m1.4.4.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S5.E10.m1.4.4.1.1.1.1.3a" xref="S5.E10.m1.4.4.1.1.1.1.3.cmml">⁡</mo><msub id="S5.E10.m1.4.4.1.1.1.1.3.2" xref="S5.E10.m1.4.4.1.1.1.1.3.2.cmml"><mi id="S5.E10.m1.4.4.1.1.1.1.3.2.2" xref="S5.E10.m1.4.4.1.1.1.1.3.2.2.cmml">p</mi><mi id="S5.E10.m1.4.4.1.1.1.1.3.2.3" xref="S5.E10.m1.4.4.1.1.1.1.3.2.3.cmml">𝜽</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S5.E10.m1.4.4.1.1.1.1.2" xref="S5.E10.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S5.E10.m1.4.4.1.1.1.1.1.1" xref="S5.E10.m1.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E10.m1.4.4.1.1.1.1.1.1.2" xref="S5.E10.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E10.m1.4.4.1.1.1.1.1.1.1" xref="S5.E10.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S5.E10.m1.4.4.1.1.1.1.1.1.1.2" xref="S5.E10.m1.4.4.1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S5.E10.m1.4.4.1.1.1.1.1.1.1.1" xref="S5.E10.m1.4.4.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S5.E10.m1.4.4.1.1.1.1.1.1.1.3" xref="S5.E10.m1.4.4.1.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo rspace="0.330em" stretchy="false" id="S5.E10.m1.4.4.1.1.1.1.1.1.3" xref="S5.E10.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S5.E10.m1.4.4.1.2" xref="S5.E10.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E10.m1.4b"><apply id="S5.E10.m1.4.4.1.1.cmml" xref="S5.E10.m1.4.4.1"><eq id="S5.E10.m1.4.4.1.1.2.cmml" xref="S5.E10.m1.4.4.1.1.2"></eq><apply id="S5.E10.m1.4.4.1.1.3.cmml" xref="S5.E10.m1.4.4.1.1.3"><times id="S5.E10.m1.4.4.1.1.3.1.cmml" xref="S5.E10.m1.4.4.1.1.3.1"></times><apply id="S5.E10.m1.4.4.1.1.3.2.cmml" xref="S5.E10.m1.4.4.1.1.3.2"><log id="S5.E10.m1.4.4.1.1.3.2.1.cmml" xref="S5.E10.m1.4.4.1.1.3.2.1"></log><apply id="S5.E10.m1.4.4.1.1.3.2.2.cmml" xref="S5.E10.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.E10.m1.4.4.1.1.3.2.2.1.cmml" xref="S5.E10.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="S5.E10.m1.4.4.1.1.3.2.2.2.cmml" xref="S5.E10.m1.4.4.1.1.3.2.2.2">𝑝</ci><ci id="S5.E10.m1.4.4.1.1.3.2.2.3.cmml" xref="S5.E10.m1.4.4.1.1.3.2.2.3">𝜽</ci></apply></apply><interval closure="open" id="S5.E10.m1.4.4.1.1.3.3.1.cmml" xref="S5.E10.m1.4.4.1.1.3.3.2"><ci id="S5.E10.m1.1.1.cmml" xref="S5.E10.m1.1.1">𝒙</ci><ci id="S5.E10.m1.2.2.cmml" xref="S5.E10.m1.2.2">𝑦</ci></interval></apply><apply id="S5.E10.m1.4.4.1.1.1.cmml" xref="S5.E10.m1.4.4.1.1.1"><plus id="S5.E10.m1.4.4.1.1.1.2.cmml" xref="S5.E10.m1.4.4.1.1.1.2"></plus><apply id="S5.E10.m1.4.4.1.1.1.3.cmml" xref="S5.E10.m1.4.4.1.1.1.3"><times id="S5.E10.m1.4.4.1.1.1.3.1.cmml" xref="S5.E10.m1.4.4.1.1.1.3.1"></times><apply id="S5.E10.m1.4.4.1.1.1.3.2.cmml" xref="S5.E10.m1.4.4.1.1.1.3.2"><log id="S5.E10.m1.4.4.1.1.1.3.2.1.cmml" xref="S5.E10.m1.4.4.1.1.1.3.2.1"></log><apply id="S5.E10.m1.4.4.1.1.1.3.2.2.cmml" xref="S5.E10.m1.4.4.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.E10.m1.4.4.1.1.1.3.2.2.1.cmml" xref="S5.E10.m1.4.4.1.1.1.3.2.2">subscript</csymbol><ci id="S5.E10.m1.4.4.1.1.1.3.2.2.2.cmml" xref="S5.E10.m1.4.4.1.1.1.3.2.2.2">𝑝</ci><ci id="S5.E10.m1.4.4.1.1.1.3.2.2.3.cmml" xref="S5.E10.m1.4.4.1.1.1.3.2.2.3">𝜽</ci></apply></apply><ci id="S5.E10.m1.3.3.cmml" xref="S5.E10.m1.3.3">𝒙</ci></apply><apply id="S5.E10.m1.4.4.1.1.1.1.cmml" xref="S5.E10.m1.4.4.1.1.1.1"><times id="S5.E10.m1.4.4.1.1.1.1.2.cmml" xref="S5.E10.m1.4.4.1.1.1.1.2"></times><apply id="S5.E10.m1.4.4.1.1.1.1.3.cmml" xref="S5.E10.m1.4.4.1.1.1.1.3"><log id="S5.E10.m1.4.4.1.1.1.1.3.1.cmml" xref="S5.E10.m1.4.4.1.1.1.1.3.1"></log><apply id="S5.E10.m1.4.4.1.1.1.1.3.2.cmml" xref="S5.E10.m1.4.4.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.E10.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S5.E10.m1.4.4.1.1.1.1.3.2">subscript</csymbol><ci id="S5.E10.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S5.E10.m1.4.4.1.1.1.1.3.2.2">𝑝</ci><ci id="S5.E10.m1.4.4.1.1.1.1.3.2.3.cmml" xref="S5.E10.m1.4.4.1.1.1.1.3.2.3">𝜽</ci></apply></apply><apply id="S5.E10.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S5.E10.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S5.E10.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S5.E10.m1.4.4.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S5.E10.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S5.E10.m1.4.4.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S5.E10.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S5.E10.m1.4.4.1.1.1.1.1.1.1.3">𝒙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E10.m1.4c">\log p_{{\boldsymbol{\theta}}}({\boldsymbol{x}},y)~{}=~{}\log p_{{\boldsymbol{\theta}}}({\boldsymbol{x}})+\log p_{{\boldsymbol{\theta}}}(y|{\boldsymbol{x}})~{},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S5.SS4.SSS0.Px2.p1.3" class="ltx_p">where <math id="S5.SS4.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="{\boldsymbol{x}}" display="inline"><semantics id="S5.SS4.SSS0.Px2.p1.1.m1.1a"><mi id="S5.SS4.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS4.SSS0.Px2.p1.1.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px2.p1.1.m1.1b"><ci id="S5.SS4.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS4.SSS0.Px2.p1.1.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px2.p1.1.m1.1c">{\boldsymbol{x}}</annotation></semantics></math> is a training point and <math id="S5.SS4.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S5.SS4.SSS0.Px2.p1.2.m2.1a"><mi id="S5.SS4.SSS0.Px2.p1.2.m2.1.1" xref="S5.SS4.SSS0.Px2.p1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px2.p1.2.m2.1b"><ci id="S5.SS4.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S5.SS4.SSS0.Px2.p1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px2.p1.2.m2.1c">y</annotation></semantics></math> is its class label. This objective can be optimized with standard cross-entropy for classification part and log-likelihood (Equation <a href="#S3.E4" title="Equation 4 ‣ 3.2 Energy-based models ‣ 3 Background ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) for energy learning. The energy function is defined as the negative <math id="S5.SS4.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="\text{LogSumExp}(\cdot)" display="inline"><semantics id="S5.SS4.SSS0.Px2.p1.3.m3.1a"><mrow id="S5.SS4.SSS0.Px2.p1.3.m3.1.2" xref="S5.SS4.SSS0.Px2.p1.3.m3.1.2.cmml"><mtext id="S5.SS4.SSS0.Px2.p1.3.m3.1.2.2" xref="S5.SS4.SSS0.Px2.p1.3.m3.1.2.2a.cmml">LogSumExp</mtext><mo lspace="0em" rspace="0em" id="S5.SS4.SSS0.Px2.p1.3.m3.1.2.1" xref="S5.SS4.SSS0.Px2.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S5.SS4.SSS0.Px2.p1.3.m3.1.2.3.2" xref="S5.SS4.SSS0.Px2.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S5.SS4.SSS0.Px2.p1.3.m3.1.2.3.2.1" xref="S5.SS4.SSS0.Px2.p1.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S5.SS4.SSS0.Px2.p1.3.m3.1.1" xref="S5.SS4.SSS0.Px2.p1.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S5.SS4.SSS0.Px2.p1.3.m3.1.2.3.2.2" xref="S5.SS4.SSS0.Px2.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px2.p1.3.m3.1b"><apply id="S5.SS4.SSS0.Px2.p1.3.m3.1.2.cmml" xref="S5.SS4.SSS0.Px2.p1.3.m3.1.2"><times id="S5.SS4.SSS0.Px2.p1.3.m3.1.2.1.cmml" xref="S5.SS4.SSS0.Px2.p1.3.m3.1.2.1"></times><ci id="S5.SS4.SSS0.Px2.p1.3.m3.1.2.2a.cmml" xref="S5.SS4.SSS0.Px2.p1.3.m3.1.2.2"><mtext id="S5.SS4.SSS0.Px2.p1.3.m3.1.2.2.cmml" xref="S5.SS4.SSS0.Px2.p1.3.m3.1.2.2">LogSumExp</mtext></ci><ci id="S5.SS4.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S5.SS4.SSS0.Px2.p1.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px2.p1.3.m3.1c">\text{LogSumExp}(\cdot)</annotation></semantics></math> function of the logits of the classifier:</p>
<table id="S5.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E11.m1.5" class="ltx_Math" alttext="E_{{\boldsymbol{\theta}}}({\boldsymbol{x}})~{}=~{}-\log\sum_{y}\exp(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})[y])~{}." display="block"><semantics id="S5.E11.m1.5a"><mrow id="S5.E11.m1.5.5.1" xref="S5.E11.m1.5.5.1.1.cmml"><mrow id="S5.E11.m1.5.5.1.1" xref="S5.E11.m1.5.5.1.1.cmml"><mrow id="S5.E11.m1.5.5.1.1.3" xref="S5.E11.m1.5.5.1.1.3.cmml"><msub id="S5.E11.m1.5.5.1.1.3.2" xref="S5.E11.m1.5.5.1.1.3.2.cmml"><mi id="S5.E11.m1.5.5.1.1.3.2.2" xref="S5.E11.m1.5.5.1.1.3.2.2.cmml">E</mi><mi id="S5.E11.m1.5.5.1.1.3.2.3" xref="S5.E11.m1.5.5.1.1.3.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S5.E11.m1.5.5.1.1.3.1" xref="S5.E11.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="S5.E11.m1.5.5.1.1.3.3.2" xref="S5.E11.m1.5.5.1.1.3.cmml"><mo stretchy="false" id="S5.E11.m1.5.5.1.1.3.3.2.1" xref="S5.E11.m1.5.5.1.1.3.cmml">(</mo><mi id="S5.E11.m1.1.1" xref="S5.E11.m1.1.1.cmml">𝒙</mi><mo rspace="0.330em" stretchy="false" id="S5.E11.m1.5.5.1.1.3.3.2.2" xref="S5.E11.m1.5.5.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.608em" id="S5.E11.m1.5.5.1.1.2" xref="S5.E11.m1.5.5.1.1.2.cmml">=</mo><mrow id="S5.E11.m1.5.5.1.1.1" xref="S5.E11.m1.5.5.1.1.1.cmml"><mo rspace="0.167em" id="S5.E11.m1.5.5.1.1.1a" xref="S5.E11.m1.5.5.1.1.1.cmml">−</mo><mrow id="S5.E11.m1.5.5.1.1.1.1" xref="S5.E11.m1.5.5.1.1.1.1.cmml"><mi id="S5.E11.m1.5.5.1.1.1.1.3" xref="S5.E11.m1.5.5.1.1.1.1.3.cmml">log</mi><mo lspace="0em" rspace="0em" id="S5.E11.m1.5.5.1.1.1.1.2" xref="S5.E11.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S5.E11.m1.5.5.1.1.1.1.1" xref="S5.E11.m1.5.5.1.1.1.1.1.cmml"><munder id="S5.E11.m1.5.5.1.1.1.1.1.2" xref="S5.E11.m1.5.5.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S5.E11.m1.5.5.1.1.1.1.1.2.2" xref="S5.E11.m1.5.5.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S5.E11.m1.5.5.1.1.1.1.1.2.3" xref="S5.E11.m1.5.5.1.1.1.1.1.2.3.cmml">y</mi></munder><mrow id="S5.E11.m1.5.5.1.1.1.1.1.1.1" xref="S5.E11.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S5.E11.m1.4.4" xref="S5.E11.m1.4.4.cmml">exp</mi><mo id="S5.E11.m1.5.5.1.1.1.1.1.1.1a" xref="S5.E11.m1.5.5.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1" xref="S5.E11.m1.5.5.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S5.E11.m1.5.5.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><msub id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.3" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S5.E11.m1.2.2" xref="S5.E11.m1.2.2.cmml">𝒙</mi><mo stretchy="false" id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.1a" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.4.2" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.4.1.cmml"><mo stretchy="false" id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.4.2.1" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.4.1.1.cmml">[</mo><mi id="S5.E11.m1.3.3" xref="S5.E11.m1.3.3.cmml">y</mi><mo stretchy="false" id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.4.2.2" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow><mo rspace="0.052em" stretchy="false" id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S5.E11.m1.5.5.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S5.E11.m1.5.5.1.2" xref="S5.E11.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E11.m1.5b"><apply id="S5.E11.m1.5.5.1.1.cmml" xref="S5.E11.m1.5.5.1"><eq id="S5.E11.m1.5.5.1.1.2.cmml" xref="S5.E11.m1.5.5.1.1.2"></eq><apply id="S5.E11.m1.5.5.1.1.3.cmml" xref="S5.E11.m1.5.5.1.1.3"><times id="S5.E11.m1.5.5.1.1.3.1.cmml" xref="S5.E11.m1.5.5.1.1.3.1"></times><apply id="S5.E11.m1.5.5.1.1.3.2.cmml" xref="S5.E11.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S5.E11.m1.5.5.1.1.3.2.1.cmml" xref="S5.E11.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S5.E11.m1.5.5.1.1.3.2.2.cmml" xref="S5.E11.m1.5.5.1.1.3.2.2">𝐸</ci><ci id="S5.E11.m1.5.5.1.1.3.2.3.cmml" xref="S5.E11.m1.5.5.1.1.3.2.3">𝜽</ci></apply><ci id="S5.E11.m1.1.1.cmml" xref="S5.E11.m1.1.1">𝒙</ci></apply><apply id="S5.E11.m1.5.5.1.1.1.cmml" xref="S5.E11.m1.5.5.1.1.1"><minus id="S5.E11.m1.5.5.1.1.1.2.cmml" xref="S5.E11.m1.5.5.1.1.1"></minus><apply id="S5.E11.m1.5.5.1.1.1.1.cmml" xref="S5.E11.m1.5.5.1.1.1.1"><times id="S5.E11.m1.5.5.1.1.1.1.2.cmml" xref="S5.E11.m1.5.5.1.1.1.1.2"></times><log id="S5.E11.m1.5.5.1.1.1.1.3.cmml" xref="S5.E11.m1.5.5.1.1.1.1.3"></log><apply id="S5.E11.m1.5.5.1.1.1.1.1.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1"><apply id="S5.E11.m1.5.5.1.1.1.1.1.2.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E11.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.2">subscript</csymbol><sum id="S5.E11.m1.5.5.1.1.1.1.1.2.2.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.2.2"></sum><ci id="S5.E11.m1.5.5.1.1.1.1.1.2.3.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.2.3">𝑦</ci></apply><apply id="S5.E11.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1"><exp id="S5.E11.m1.4.4.cmml" xref="S5.E11.m1.4.4"></exp><apply id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1"><times id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.1"></times><apply id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="S5.E11.m1.2.2.cmml" xref="S5.E11.m1.2.2">𝒙</ci><apply id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.4.2"><csymbol cd="latexml" id="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.4.1.1.cmml" xref="S5.E11.m1.5.5.1.1.1.1.1.1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S5.E11.m1.3.3.cmml" xref="S5.E11.m1.3.3">𝑦</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E11.m1.5c">E_{{\boldsymbol{\theta}}}({\boldsymbol{x}})~{}=~{}-\log\sum_{y}\exp(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})[y])~{}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S5.SS4.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">The CEBM approach</h4>

<div id="S5.SS4.SSS0.Px3.p1" class="ltx_para">
<p id="S5.SS4.SSS0.Px3.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> learns a conditional energy function <math id="S5.SS4.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="E_{{\boldsymbol{\theta}}}({\boldsymbol{x}}|c)" display="inline"><semantics id="S5.SS4.SSS0.Px3.p1.1.m1.1a"><mrow id="S5.SS4.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.cmml"><msub id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3.cmml"><mi id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3.2" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3.2.cmml">E</mi><mi id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3.3" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.2" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.2" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.2" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.1" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.3" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.3" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px3.p1.1.m1.1b"><apply id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1"><times id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.2"></times><apply id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3.1.cmml" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3">subscript</csymbol><ci id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3.2.cmml" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3.2">𝐸</ci><ci id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3.3.cmml" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.3.3">𝜽</ci></apply><apply id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.cmml" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.2">𝒙</ci><ci id="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS4.SSS0.Px3.p1.1.m1.1.1.1.1.1.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px3.p1.1.m1.1c">E_{{\boldsymbol{\theta}}}({\boldsymbol{x}}|c)</annotation></semantics></math>.
Although CEBMs are mainly designed for image generation, they have also shown solid classification performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> by using the class-conditioned energy of an image to predict its label:</p>
<table id="S5.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E12.m1.1" class="ltx_Math" alttext="y^{\star}~{}=~{}\operatorname*{arg\,min}_{y}E_{{\boldsymbol{\theta}}}({\boldsymbol{x}}|y)~{}." display="block"><semantics id="S5.E12.m1.1a"><mrow id="S5.E12.m1.1.1.1" xref="S5.E12.m1.1.1.1.1.cmml"><mrow id="S5.E12.m1.1.1.1.1" xref="S5.E12.m1.1.1.1.1.cmml"><msup id="S5.E12.m1.1.1.1.1.3" xref="S5.E12.m1.1.1.1.1.3.cmml"><mi id="S5.E12.m1.1.1.1.1.3.2" xref="S5.E12.m1.1.1.1.1.3.2.cmml">y</mi><mo id="S5.E12.m1.1.1.1.1.3.3" xref="S5.E12.m1.1.1.1.1.3.3.cmml">⋆</mo></msup><mo lspace="0.608em" rspace="0.608em" id="S5.E12.m1.1.1.1.1.2" xref="S5.E12.m1.1.1.1.1.2.cmml">=</mo><mrow id="S5.E12.m1.1.1.1.1.1" xref="S5.E12.m1.1.1.1.1.1.cmml"><mrow id="S5.E12.m1.1.1.1.1.1.3" xref="S5.E12.m1.1.1.1.1.1.3.cmml"><munder id="S5.E12.m1.1.1.1.1.1.3.1" xref="S5.E12.m1.1.1.1.1.1.3.1.cmml"><mrow id="S5.E12.m1.1.1.1.1.1.3.1.2" xref="S5.E12.m1.1.1.1.1.1.3.1.2.cmml"><mi id="S5.E12.m1.1.1.1.1.1.3.1.2.2" xref="S5.E12.m1.1.1.1.1.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S5.E12.m1.1.1.1.1.1.3.1.2.1" xref="S5.E12.m1.1.1.1.1.1.3.1.2.1.cmml">​</mo><mi id="S5.E12.m1.1.1.1.1.1.3.1.2.3" xref="S5.E12.m1.1.1.1.1.1.3.1.2.3.cmml">min</mi></mrow><mi id="S5.E12.m1.1.1.1.1.1.3.1.3" xref="S5.E12.m1.1.1.1.1.1.3.1.3.cmml">y</mi></munder><mo id="S5.E12.m1.1.1.1.1.1.3a" xref="S5.E12.m1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S5.E12.m1.1.1.1.1.1.3.2" xref="S5.E12.m1.1.1.1.1.1.3.2.cmml"><mi id="S5.E12.m1.1.1.1.1.1.3.2.2" xref="S5.E12.m1.1.1.1.1.1.3.2.2.cmml">E</mi><mi id="S5.E12.m1.1.1.1.1.1.3.2.3" xref="S5.E12.m1.1.1.1.1.1.3.2.3.cmml">𝜽</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S5.E12.m1.1.1.1.1.1.2" xref="S5.E12.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S5.E12.m1.1.1.1.1.1.1.1" xref="S5.E12.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E12.m1.1.1.1.1.1.1.1.2" xref="S5.E12.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E12.m1.1.1.1.1.1.1.1.1" xref="S5.E12.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E12.m1.1.1.1.1.1.1.1.1.2" xref="S5.E12.m1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S5.E12.m1.1.1.1.1.1.1.1.1.1" xref="S5.E12.m1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S5.E12.m1.1.1.1.1.1.1.1.1.3" xref="S5.E12.m1.1.1.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo rspace="0.052em" stretchy="false" id="S5.E12.m1.1.1.1.1.1.1.1.3" xref="S5.E12.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.E12.m1.1.1.1.2" xref="S5.E12.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E12.m1.1b"><apply id="S5.E12.m1.1.1.1.1.cmml" xref="S5.E12.m1.1.1.1"><eq id="S5.E12.m1.1.1.1.1.2.cmml" xref="S5.E12.m1.1.1.1.1.2"></eq><apply id="S5.E12.m1.1.1.1.1.3.cmml" xref="S5.E12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E12.m1.1.1.1.1.3.1.cmml" xref="S5.E12.m1.1.1.1.1.3">superscript</csymbol><ci id="S5.E12.m1.1.1.1.1.3.2.cmml" xref="S5.E12.m1.1.1.1.1.3.2">𝑦</ci><ci id="S5.E12.m1.1.1.1.1.3.3.cmml" xref="S5.E12.m1.1.1.1.1.3.3">⋆</ci></apply><apply id="S5.E12.m1.1.1.1.1.1.cmml" xref="S5.E12.m1.1.1.1.1.1"><times id="S5.E12.m1.1.1.1.1.1.2.cmml" xref="S5.E12.m1.1.1.1.1.1.2"></times><apply id="S5.E12.m1.1.1.1.1.1.3.cmml" xref="S5.E12.m1.1.1.1.1.1.3"><apply id="S5.E12.m1.1.1.1.1.1.3.1.cmml" xref="S5.E12.m1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S5.E12.m1.1.1.1.1.1.3.1.1.cmml" xref="S5.E12.m1.1.1.1.1.1.3.1">subscript</csymbol><apply id="S5.E12.m1.1.1.1.1.1.3.1.2.cmml" xref="S5.E12.m1.1.1.1.1.1.3.1.2"><times id="S5.E12.m1.1.1.1.1.1.3.1.2.1.cmml" xref="S5.E12.m1.1.1.1.1.1.3.1.2.1"></times><ci id="S5.E12.m1.1.1.1.1.1.3.1.2.2.cmml" xref="S5.E12.m1.1.1.1.1.1.3.1.2.2">arg</ci><ci id="S5.E12.m1.1.1.1.1.1.3.1.2.3.cmml" xref="S5.E12.m1.1.1.1.1.1.3.1.2.3">min</ci></apply><ci id="S5.E12.m1.1.1.1.1.1.3.1.3.cmml" xref="S5.E12.m1.1.1.1.1.1.3.1.3">𝑦</ci></apply><apply id="S5.E12.m1.1.1.1.1.1.3.2.cmml" xref="S5.E12.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.E12.m1.1.1.1.1.1.3.2.1.cmml" xref="S5.E12.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S5.E12.m1.1.1.1.1.1.3.2.2.cmml" xref="S5.E12.m1.1.1.1.1.1.3.2.2">𝐸</ci><ci id="S5.E12.m1.1.1.1.1.1.3.2.3.cmml" xref="S5.E12.m1.1.1.1.1.1.3.2.3">𝜽</ci></apply></apply><apply id="S5.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="S5.E12.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S5.E12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E12.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S5.E12.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E12.m1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S5.E12.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E12.m1.1.1.1.1.1.1.1.1.3">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E12.m1.1c">y^{\star}~{}=~{}\operatorname*{arg\,min}_{y}E_{{\boldsymbol{\theta}}}({\boldsymbol{x}}|y)~{}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S5.SS4.SSS0.Px3.p1.2" class="ltx_p">The generative objective of CEBMs lacks a clear stopping criterion.
During training, we monitor the model’s FID score <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> and halt the optimization when the FID becomes stable and reaches a value indicating that generated images are visually similar to the training data.</p>
</div>
</section>
<section id="S5.SS4.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Calibration of uncertainty.</h4>

<div id="S5.SS4.SSS0.Px4.p1" class="ltx_para">
<p id="S5.SS4.SSS0.Px4.p1.1" class="ltx_p">We also propose to look at the models’ calibration since this was previously shown to be improved by energy-based training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>.
A model is considered well-calibrated if its confidence (<em id="S5.SS4.SSS0.Px4.p1.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS4.SSS0.Px4.p1.1.2" class="ltx_text"></span> top softmax score) is higher for correct predictions than incorrect ones.
We use the standard <em id="S5.SS4.SSS0.Px4.p1.1.3" class="ltx_emph ltx_font_italic">expected calibration error</em> (ECE) metric <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. To compute the ECE, one splits the predictions into <math id="S5.SS4.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S5.SS4.SSS0.Px4.p1.1.m1.1a"><mi id="S5.SS4.SSS0.Px4.p1.1.m1.1.1" xref="S5.SS4.SSS0.Px4.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px4.p1.1.m1.1b"><ci id="S5.SS4.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px4.p1.1.m1.1c">M</annotation></semantics></math> bins according to their confidence, and measures the weighted average of the difference between accuracy and confidence of each bin as follows:
</p>
<table id="A1.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E13.m1.1" class="ltx_Math" alttext="\displaystyle\text{acc}(B_{m})" display="inline"><semantics id="S5.E13.m1.1a"><mrow id="S5.E13.m1.1.1" xref="S5.E13.m1.1.1.cmml"><mtext id="S5.E13.m1.1.1.3" xref="S5.E13.m1.1.1.3a.cmml">acc</mtext><mo lspace="0em" rspace="0em" id="S5.E13.m1.1.1.2" xref="S5.E13.m1.1.1.2.cmml">​</mo><mrow id="S5.E13.m1.1.1.1.1" xref="S5.E13.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E13.m1.1.1.1.1.2" xref="S5.E13.m1.1.1.1.1.1.cmml">(</mo><msub id="S5.E13.m1.1.1.1.1.1" xref="S5.E13.m1.1.1.1.1.1.cmml"><mi id="S5.E13.m1.1.1.1.1.1.2" xref="S5.E13.m1.1.1.1.1.1.2.cmml">B</mi><mi id="S5.E13.m1.1.1.1.1.1.3" xref="S5.E13.m1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S5.E13.m1.1.1.1.1.3" xref="S5.E13.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E13.m1.1b"><apply id="S5.E13.m1.1.1.cmml" xref="S5.E13.m1.1.1"><times id="S5.E13.m1.1.1.2.cmml" xref="S5.E13.m1.1.1.2"></times><ci id="S5.E13.m1.1.1.3a.cmml" xref="S5.E13.m1.1.1.3"><mtext id="S5.E13.m1.1.1.3.cmml" xref="S5.E13.m1.1.1.3">acc</mtext></ci><apply id="S5.E13.m1.1.1.1.1.1.cmml" xref="S5.E13.m1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E13.m1.1.1.1.1.1.1.cmml" xref="S5.E13.m1.1.1.1.1">subscript</csymbol><ci id="S5.E13.m1.1.1.1.1.1.2.cmml" xref="S5.E13.m1.1.1.1.1.1.2">𝐵</ci><ci id="S5.E13.m1.1.1.1.1.1.3.cmml" xref="S5.E13.m1.1.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E13.m1.1c">\displaystyle\text{acc}(B_{m})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S5.E13.m2.2" class="ltx_Math" alttext="\displaystyle~{}=~{}{(1\,/\,|B_{m}|)}~{}~{}\Sigma_{i\in B_{m}}1(\hat{y}_{i}=y_{i})" display="inline"><semantics id="S5.E13.m2.2a"><mrow id="S5.E13.m2.2.2" xref="S5.E13.m2.2.2.cmml"><mi id="S5.E13.m2.2.2.4" xref="S5.E13.m2.2.2.4.cmml"></mi><mo lspace="0.608em" rspace="0.608em" id="S5.E13.m2.2.2.3" xref="S5.E13.m2.2.2.3.cmml">=</mo><mrow id="S5.E13.m2.2.2.2" xref="S5.E13.m2.2.2.2.cmml"><mrow id="S5.E13.m2.1.1.1.1.1" xref="S5.E13.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E13.m2.1.1.1.1.1.2" xref="S5.E13.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.E13.m2.1.1.1.1.1.1" xref="S5.E13.m2.1.1.1.1.1.1.cmml"><mn id="S5.E13.m2.1.1.1.1.1.1.3" xref="S5.E13.m2.1.1.1.1.1.1.3.cmml">1</mn><mo lspace="0.392em" rspace="0.392em" id="S5.E13.m2.1.1.1.1.1.1.2" xref="S5.E13.m2.1.1.1.1.1.1.2.cmml">/</mo><mrow id="S5.E13.m2.1.1.1.1.1.1.1.1" xref="S5.E13.m2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E13.m2.1.1.1.1.1.1.1.1.2" xref="S5.E13.m2.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S5.E13.m2.1.1.1.1.1.1.1.1.1" xref="S5.E13.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E13.m2.1.1.1.1.1.1.1.1.1.2" xref="S5.E13.m2.1.1.1.1.1.1.1.1.1.2.cmml">B</mi><mi id="S5.E13.m2.1.1.1.1.1.1.1.1.1.3" xref="S5.E13.m2.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S5.E13.m2.1.1.1.1.1.1.1.1.3" xref="S5.E13.m2.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S5.E13.m2.1.1.1.1.1.3" xref="S5.E13.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.660em" rspace="0em" id="S5.E13.m2.2.2.2.3" xref="S5.E13.m2.2.2.2.3.cmml">​</mo><msub id="S5.E13.m2.2.2.2.4" xref="S5.E13.m2.2.2.2.4.cmml"><mi mathvariant="normal" id="S5.E13.m2.2.2.2.4.2" xref="S5.E13.m2.2.2.2.4.2.cmml">Σ</mi><mrow id="S5.E13.m2.2.2.2.4.3" xref="S5.E13.m2.2.2.2.4.3.cmml"><mi id="S5.E13.m2.2.2.2.4.3.2" xref="S5.E13.m2.2.2.2.4.3.2.cmml">i</mi><mo id="S5.E13.m2.2.2.2.4.3.1" xref="S5.E13.m2.2.2.2.4.3.1.cmml">∈</mo><msub id="S5.E13.m2.2.2.2.4.3.3" xref="S5.E13.m2.2.2.2.4.3.3.cmml"><mi id="S5.E13.m2.2.2.2.4.3.3.2" xref="S5.E13.m2.2.2.2.4.3.3.2.cmml">B</mi><mi id="S5.E13.m2.2.2.2.4.3.3.3" xref="S5.E13.m2.2.2.2.4.3.3.3.cmml">m</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S5.E13.m2.2.2.2.3a" xref="S5.E13.m2.2.2.2.3.cmml">​</mo><mn id="S5.E13.m2.2.2.2.5" xref="S5.E13.m2.2.2.2.5.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.E13.m2.2.2.2.3b" xref="S5.E13.m2.2.2.2.3.cmml">​</mo><mrow id="S5.E13.m2.2.2.2.2.1" xref="S5.E13.m2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S5.E13.m2.2.2.2.2.1.2" xref="S5.E13.m2.2.2.2.2.1.1.cmml">(</mo><mrow id="S5.E13.m2.2.2.2.2.1.1" xref="S5.E13.m2.2.2.2.2.1.1.cmml"><msub id="S5.E13.m2.2.2.2.2.1.1.2" xref="S5.E13.m2.2.2.2.2.1.1.2.cmml"><mover accent="true" id="S5.E13.m2.2.2.2.2.1.1.2.2" xref="S5.E13.m2.2.2.2.2.1.1.2.2.cmml"><mi id="S5.E13.m2.2.2.2.2.1.1.2.2.2" xref="S5.E13.m2.2.2.2.2.1.1.2.2.2.cmml">y</mi><mo id="S5.E13.m2.2.2.2.2.1.1.2.2.1" xref="S5.E13.m2.2.2.2.2.1.1.2.2.1.cmml">^</mo></mover><mi id="S5.E13.m2.2.2.2.2.1.1.2.3" xref="S5.E13.m2.2.2.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S5.E13.m2.2.2.2.2.1.1.1" xref="S5.E13.m2.2.2.2.2.1.1.1.cmml">=</mo><msub id="S5.E13.m2.2.2.2.2.1.1.3" xref="S5.E13.m2.2.2.2.2.1.1.3.cmml"><mi id="S5.E13.m2.2.2.2.2.1.1.3.2" xref="S5.E13.m2.2.2.2.2.1.1.3.2.cmml">y</mi><mi id="S5.E13.m2.2.2.2.2.1.1.3.3" xref="S5.E13.m2.2.2.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S5.E13.m2.2.2.2.2.1.3" xref="S5.E13.m2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E13.m2.2b"><apply id="S5.E13.m2.2.2.cmml" xref="S5.E13.m2.2.2"><eq id="S5.E13.m2.2.2.3.cmml" xref="S5.E13.m2.2.2.3"></eq><csymbol cd="latexml" id="S5.E13.m2.2.2.4.cmml" xref="S5.E13.m2.2.2.4">absent</csymbol><apply id="S5.E13.m2.2.2.2.cmml" xref="S5.E13.m2.2.2.2"><times id="S5.E13.m2.2.2.2.3.cmml" xref="S5.E13.m2.2.2.2.3"></times><apply id="S5.E13.m2.1.1.1.1.1.1.cmml" xref="S5.E13.m2.1.1.1.1.1"><divide id="S5.E13.m2.1.1.1.1.1.1.2.cmml" xref="S5.E13.m2.1.1.1.1.1.1.2"></divide><cn type="integer" id="S5.E13.m2.1.1.1.1.1.1.3.cmml" xref="S5.E13.m2.1.1.1.1.1.1.3">1</cn><apply id="S5.E13.m2.1.1.1.1.1.1.1.2.cmml" xref="S5.E13.m2.1.1.1.1.1.1.1.1"><abs id="S5.E13.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E13.m2.1.1.1.1.1.1.1.1.2"></abs><apply id="S5.E13.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E13.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E13.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E13.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E13.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E13.m2.1.1.1.1.1.1.1.1.1.2">𝐵</ci><ci id="S5.E13.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E13.m2.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply><apply id="S5.E13.m2.2.2.2.4.cmml" xref="S5.E13.m2.2.2.2.4"><csymbol cd="ambiguous" id="S5.E13.m2.2.2.2.4.1.cmml" xref="S5.E13.m2.2.2.2.4">subscript</csymbol><ci id="S5.E13.m2.2.2.2.4.2.cmml" xref="S5.E13.m2.2.2.2.4.2">Σ</ci><apply id="S5.E13.m2.2.2.2.4.3.cmml" xref="S5.E13.m2.2.2.2.4.3"><in id="S5.E13.m2.2.2.2.4.3.1.cmml" xref="S5.E13.m2.2.2.2.4.3.1"></in><ci id="S5.E13.m2.2.2.2.4.3.2.cmml" xref="S5.E13.m2.2.2.2.4.3.2">𝑖</ci><apply id="S5.E13.m2.2.2.2.4.3.3.cmml" xref="S5.E13.m2.2.2.2.4.3.3"><csymbol cd="ambiguous" id="S5.E13.m2.2.2.2.4.3.3.1.cmml" xref="S5.E13.m2.2.2.2.4.3.3">subscript</csymbol><ci id="S5.E13.m2.2.2.2.4.3.3.2.cmml" xref="S5.E13.m2.2.2.2.4.3.3.2">𝐵</ci><ci id="S5.E13.m2.2.2.2.4.3.3.3.cmml" xref="S5.E13.m2.2.2.2.4.3.3.3">𝑚</ci></apply></apply></apply><cn type="integer" id="S5.E13.m2.2.2.2.5.cmml" xref="S5.E13.m2.2.2.2.5">1</cn><apply id="S5.E13.m2.2.2.2.2.1.1.cmml" xref="S5.E13.m2.2.2.2.2.1"><eq id="S5.E13.m2.2.2.2.2.1.1.1.cmml" xref="S5.E13.m2.2.2.2.2.1.1.1"></eq><apply id="S5.E13.m2.2.2.2.2.1.1.2.cmml" xref="S5.E13.m2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.E13.m2.2.2.2.2.1.1.2.1.cmml" xref="S5.E13.m2.2.2.2.2.1.1.2">subscript</csymbol><apply id="S5.E13.m2.2.2.2.2.1.1.2.2.cmml" xref="S5.E13.m2.2.2.2.2.1.1.2.2"><ci id="S5.E13.m2.2.2.2.2.1.1.2.2.1.cmml" xref="S5.E13.m2.2.2.2.2.1.1.2.2.1">^</ci><ci id="S5.E13.m2.2.2.2.2.1.1.2.2.2.cmml" xref="S5.E13.m2.2.2.2.2.1.1.2.2.2">𝑦</ci></apply><ci id="S5.E13.m2.2.2.2.2.1.1.2.3.cmml" xref="S5.E13.m2.2.2.2.2.1.1.2.3">𝑖</ci></apply><apply id="S5.E13.m2.2.2.2.2.1.1.3.cmml" xref="S5.E13.m2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S5.E13.m2.2.2.2.2.1.1.3.1.cmml" xref="S5.E13.m2.2.2.2.2.1.1.3">subscript</csymbol><ci id="S5.E13.m2.2.2.2.2.1.1.3.2.cmml" xref="S5.E13.m2.2.2.2.2.1.1.3.2">𝑦</ci><ci id="S5.E13.m2.2.2.2.2.1.1.3.3.cmml" xref="S5.E13.m2.2.2.2.2.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E13.m2.2c">\displaystyle~{}=~{}{(1\,/\,|B_{m}|)}~{}~{}\Sigma_{i\in B_{m}}1(\hat{y}_{i}=y_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
<tbody id="S5.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.Ex3.m1.1" class="ltx_Math" alttext="\displaystyle\text{conf}(B_{m})" display="inline"><semantics id="S5.Ex3.m1.1a"><mrow id="S5.Ex3.m1.1.1" xref="S5.Ex3.m1.1.1.cmml"><mtext id="S5.Ex3.m1.1.1.3" xref="S5.Ex3.m1.1.1.3a.cmml">conf</mtext><mo lspace="0em" rspace="0em" id="S5.Ex3.m1.1.1.2" xref="S5.Ex3.m1.1.1.2.cmml">​</mo><mrow id="S5.Ex3.m1.1.1.1.1" xref="S5.Ex3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.Ex3.m1.1.1.1.1.2" xref="S5.Ex3.m1.1.1.1.1.1.cmml">(</mo><msub id="S5.Ex3.m1.1.1.1.1.1" xref="S5.Ex3.m1.1.1.1.1.1.cmml"><mi id="S5.Ex3.m1.1.1.1.1.1.2" xref="S5.Ex3.m1.1.1.1.1.1.2.cmml">B</mi><mi id="S5.Ex3.m1.1.1.1.1.1.3" xref="S5.Ex3.m1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S5.Ex3.m1.1.1.1.1.3" xref="S5.Ex3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex3.m1.1b"><apply id="S5.Ex3.m1.1.1.cmml" xref="S5.Ex3.m1.1.1"><times id="S5.Ex3.m1.1.1.2.cmml" xref="S5.Ex3.m1.1.1.2"></times><ci id="S5.Ex3.m1.1.1.3a.cmml" xref="S5.Ex3.m1.1.1.3"><mtext id="S5.Ex3.m1.1.1.3.cmml" xref="S5.Ex3.m1.1.1.3">conf</mtext></ci><apply id="S5.Ex3.m1.1.1.1.1.1.cmml" xref="S5.Ex3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S5.Ex3.m1.1.1.1.1.1.1.cmml" xref="S5.Ex3.m1.1.1.1.1">subscript</csymbol><ci id="S5.Ex3.m1.1.1.1.1.1.2.cmml" xref="S5.Ex3.m1.1.1.1.1.1.2">𝐵</ci><ci id="S5.Ex3.m1.1.1.1.1.1.3.cmml" xref="S5.Ex3.m1.1.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex3.m1.1c">\displaystyle\text{conf}(B_{m})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S5.Ex3.m2.1" class="ltx_Math" alttext="\displaystyle~{}=~{}{(1\,/\,|B_{m}|)}~{}~{}\Sigma_{i\in B_{m}}\hat{p}_{i}" display="inline"><semantics id="S5.Ex3.m2.1a"><mrow id="S5.Ex3.m2.1.1" xref="S5.Ex3.m2.1.1.cmml"><mi id="S5.Ex3.m2.1.1.3" xref="S5.Ex3.m2.1.1.3.cmml"></mi><mo lspace="0.608em" rspace="0.608em" id="S5.Ex3.m2.1.1.2" xref="S5.Ex3.m2.1.1.2.cmml">=</mo><mrow id="S5.Ex3.m2.1.1.1" xref="S5.Ex3.m2.1.1.1.cmml"><mrow id="S5.Ex3.m2.1.1.1.1.1" xref="S5.Ex3.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.Ex3.m2.1.1.1.1.1.2" xref="S5.Ex3.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.Ex3.m2.1.1.1.1.1.1" xref="S5.Ex3.m2.1.1.1.1.1.1.cmml"><mn id="S5.Ex3.m2.1.1.1.1.1.1.3" xref="S5.Ex3.m2.1.1.1.1.1.1.3.cmml">1</mn><mo lspace="0.392em" rspace="0.392em" id="S5.Ex3.m2.1.1.1.1.1.1.2" xref="S5.Ex3.m2.1.1.1.1.1.1.2.cmml">/</mo><mrow id="S5.Ex3.m2.1.1.1.1.1.1.1.1" xref="S5.Ex3.m2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.Ex3.m2.1.1.1.1.1.1.1.1.2" xref="S5.Ex3.m2.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S5.Ex3.m2.1.1.1.1.1.1.1.1.1" xref="S5.Ex3.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.Ex3.m2.1.1.1.1.1.1.1.1.1.2" xref="S5.Ex3.m2.1.1.1.1.1.1.1.1.1.2.cmml">B</mi><mi id="S5.Ex3.m2.1.1.1.1.1.1.1.1.1.3" xref="S5.Ex3.m2.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S5.Ex3.m2.1.1.1.1.1.1.1.1.3" xref="S5.Ex3.m2.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S5.Ex3.m2.1.1.1.1.1.3" xref="S5.Ex3.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.660em" rspace="0em" id="S5.Ex3.m2.1.1.1.2" xref="S5.Ex3.m2.1.1.1.2.cmml">​</mo><msub id="S5.Ex3.m2.1.1.1.3" xref="S5.Ex3.m2.1.1.1.3.cmml"><mi mathvariant="normal" id="S5.Ex3.m2.1.1.1.3.2" xref="S5.Ex3.m2.1.1.1.3.2.cmml">Σ</mi><mrow id="S5.Ex3.m2.1.1.1.3.3" xref="S5.Ex3.m2.1.1.1.3.3.cmml"><mi id="S5.Ex3.m2.1.1.1.3.3.2" xref="S5.Ex3.m2.1.1.1.3.3.2.cmml">i</mi><mo id="S5.Ex3.m2.1.1.1.3.3.1" xref="S5.Ex3.m2.1.1.1.3.3.1.cmml">∈</mo><msub id="S5.Ex3.m2.1.1.1.3.3.3" xref="S5.Ex3.m2.1.1.1.3.3.3.cmml"><mi id="S5.Ex3.m2.1.1.1.3.3.3.2" xref="S5.Ex3.m2.1.1.1.3.3.3.2.cmml">B</mi><mi id="S5.Ex3.m2.1.1.1.3.3.3.3" xref="S5.Ex3.m2.1.1.1.3.3.3.3.cmml">m</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S5.Ex3.m2.1.1.1.2a" xref="S5.Ex3.m2.1.1.1.2.cmml">​</mo><msub id="S5.Ex3.m2.1.1.1.4" xref="S5.Ex3.m2.1.1.1.4.cmml"><mover accent="true" id="S5.Ex3.m2.1.1.1.4.2" xref="S5.Ex3.m2.1.1.1.4.2.cmml"><mi id="S5.Ex3.m2.1.1.1.4.2.2" xref="S5.Ex3.m2.1.1.1.4.2.2.cmml">p</mi><mo id="S5.Ex3.m2.1.1.1.4.2.1" xref="S5.Ex3.m2.1.1.1.4.2.1.cmml">^</mo></mover><mi id="S5.Ex3.m2.1.1.1.4.3" xref="S5.Ex3.m2.1.1.1.4.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex3.m2.1b"><apply id="S5.Ex3.m2.1.1.cmml" xref="S5.Ex3.m2.1.1"><eq id="S5.Ex3.m2.1.1.2.cmml" xref="S5.Ex3.m2.1.1.2"></eq><csymbol cd="latexml" id="S5.Ex3.m2.1.1.3.cmml" xref="S5.Ex3.m2.1.1.3">absent</csymbol><apply id="S5.Ex3.m2.1.1.1.cmml" xref="S5.Ex3.m2.1.1.1"><times id="S5.Ex3.m2.1.1.1.2.cmml" xref="S5.Ex3.m2.1.1.1.2"></times><apply id="S5.Ex3.m2.1.1.1.1.1.1.cmml" xref="S5.Ex3.m2.1.1.1.1.1"><divide id="S5.Ex3.m2.1.1.1.1.1.1.2.cmml" xref="S5.Ex3.m2.1.1.1.1.1.1.2"></divide><cn type="integer" id="S5.Ex3.m2.1.1.1.1.1.1.3.cmml" xref="S5.Ex3.m2.1.1.1.1.1.1.3">1</cn><apply id="S5.Ex3.m2.1.1.1.1.1.1.1.2.cmml" xref="S5.Ex3.m2.1.1.1.1.1.1.1.1"><abs id="S5.Ex3.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S5.Ex3.m2.1.1.1.1.1.1.1.1.2"></abs><apply id="S5.Ex3.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex3.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.Ex3.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex3.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.Ex3.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.Ex3.m2.1.1.1.1.1.1.1.1.1.2">𝐵</ci><ci id="S5.Ex3.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.Ex3.m2.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply><apply id="S5.Ex3.m2.1.1.1.3.cmml" xref="S5.Ex3.m2.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex3.m2.1.1.1.3.1.cmml" xref="S5.Ex3.m2.1.1.1.3">subscript</csymbol><ci id="S5.Ex3.m2.1.1.1.3.2.cmml" xref="S5.Ex3.m2.1.1.1.3.2">Σ</ci><apply id="S5.Ex3.m2.1.1.1.3.3.cmml" xref="S5.Ex3.m2.1.1.1.3.3"><in id="S5.Ex3.m2.1.1.1.3.3.1.cmml" xref="S5.Ex3.m2.1.1.1.3.3.1"></in><ci id="S5.Ex3.m2.1.1.1.3.3.2.cmml" xref="S5.Ex3.m2.1.1.1.3.3.2">𝑖</ci><apply id="S5.Ex3.m2.1.1.1.3.3.3.cmml" xref="S5.Ex3.m2.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S5.Ex3.m2.1.1.1.3.3.3.1.cmml" xref="S5.Ex3.m2.1.1.1.3.3.3">subscript</csymbol><ci id="S5.Ex3.m2.1.1.1.3.3.3.2.cmml" xref="S5.Ex3.m2.1.1.1.3.3.3.2">𝐵</ci><ci id="S5.Ex3.m2.1.1.1.3.3.3.3.cmml" xref="S5.Ex3.m2.1.1.1.3.3.3.3">𝑚</ci></apply></apply></apply><apply id="S5.Ex3.m2.1.1.1.4.cmml" xref="S5.Ex3.m2.1.1.1.4"><csymbol cd="ambiguous" id="S5.Ex3.m2.1.1.1.4.1.cmml" xref="S5.Ex3.m2.1.1.1.4">subscript</csymbol><apply id="S5.Ex3.m2.1.1.1.4.2.cmml" xref="S5.Ex3.m2.1.1.1.4.2"><ci id="S5.Ex3.m2.1.1.1.4.2.1.cmml" xref="S5.Ex3.m2.1.1.1.4.2.1">^</ci><ci id="S5.Ex3.m2.1.1.1.4.2.2.cmml" xref="S5.Ex3.m2.1.1.1.4.2.2">𝑝</ci></apply><ci id="S5.Ex3.m2.1.1.1.4.3.cmml" xref="S5.Ex3.m2.1.1.1.4.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex3.m2.1c">\displaystyle~{}=~{}{(1\,/\,|B_{m}|)}~{}~{}\Sigma_{i\in B_{m}}\hat{p}_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S5.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S5.Ex4.2.1.1.1" class="ltx_text ltx_markedasmath">ECE</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S5.Ex4.m2.2" class="ltx_Math" alttext="\displaystyle~{}=~{}\Sigma_{m=1}^{M}\,(|B_{m}|/n)~{}~{}\big{|}\,\text{acc}(B_{m})-\text{conf}(B_{m})\,\big{|}" display="inline"><semantics id="S5.Ex4.m2.2a"><mrow id="S5.Ex4.m2.2.2" xref="S5.Ex4.m2.2.2.cmml"><mi id="S5.Ex4.m2.2.2.4" xref="S5.Ex4.m2.2.2.4.cmml"></mi><mo lspace="0.608em" rspace="0.608em" id="S5.Ex4.m2.2.2.3" xref="S5.Ex4.m2.2.2.3.cmml">=</mo><mrow id="S5.Ex4.m2.2.2.2" xref="S5.Ex4.m2.2.2.2.cmml"><msubsup id="S5.Ex4.m2.2.2.2.4" xref="S5.Ex4.m2.2.2.2.4.cmml"><mi mathvariant="normal" id="S5.Ex4.m2.2.2.2.4.2.2" xref="S5.Ex4.m2.2.2.2.4.2.2.cmml">Σ</mi><mrow id="S5.Ex4.m2.2.2.2.4.2.3" xref="S5.Ex4.m2.2.2.2.4.2.3.cmml"><mi id="S5.Ex4.m2.2.2.2.4.2.3.2" xref="S5.Ex4.m2.2.2.2.4.2.3.2.cmml">m</mi><mo id="S5.Ex4.m2.2.2.2.4.2.3.1" xref="S5.Ex4.m2.2.2.2.4.2.3.1.cmml">=</mo><mn id="S5.Ex4.m2.2.2.2.4.2.3.3" xref="S5.Ex4.m2.2.2.2.4.2.3.3.cmml">1</mn></mrow><mi id="S5.Ex4.m2.2.2.2.4.3" xref="S5.Ex4.m2.2.2.2.4.3.cmml">M</mi></msubsup><mo lspace="0em" rspace="0em" id="S5.Ex4.m2.2.2.2.3" xref="S5.Ex4.m2.2.2.2.3.cmml">​</mo><mrow id="S5.Ex4.m2.1.1.1.1.1" xref="S5.Ex4.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.Ex4.m2.1.1.1.1.1.2" xref="S5.Ex4.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.Ex4.m2.1.1.1.1.1.1" xref="S5.Ex4.m2.1.1.1.1.1.1.cmml"><mrow id="S5.Ex4.m2.1.1.1.1.1.1.1.1" xref="S5.Ex4.m2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.Ex4.m2.1.1.1.1.1.1.1.1.2" xref="S5.Ex4.m2.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S5.Ex4.m2.1.1.1.1.1.1.1.1.1" xref="S5.Ex4.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.Ex4.m2.1.1.1.1.1.1.1.1.1.2" xref="S5.Ex4.m2.1.1.1.1.1.1.1.1.1.2.cmml">B</mi><mi id="S5.Ex4.m2.1.1.1.1.1.1.1.1.1.3" xref="S5.Ex4.m2.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S5.Ex4.m2.1.1.1.1.1.1.1.1.3" xref="S5.Ex4.m2.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S5.Ex4.m2.1.1.1.1.1.1.2" xref="S5.Ex4.m2.1.1.1.1.1.1.2.cmml">/</mo><mi id="S5.Ex4.m2.1.1.1.1.1.1.3" xref="S5.Ex4.m2.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo stretchy="false" id="S5.Ex4.m2.1.1.1.1.1.3" xref="S5.Ex4.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.660em" rspace="0em" id="S5.Ex4.m2.2.2.2.3a" xref="S5.Ex4.m2.2.2.2.3.cmml">​</mo><mrow id="S5.Ex4.m2.2.2.2.2.1" xref="S5.Ex4.m2.2.2.2.2.2.cmml"><mo maxsize="120%" minsize="120%" rspace="0.170em" id="S5.Ex4.m2.2.2.2.2.1.2" xref="S5.Ex4.m2.2.2.2.2.2.1.cmml">|</mo><mrow id="S5.Ex4.m2.2.2.2.2.1.1" xref="S5.Ex4.m2.2.2.2.2.1.1.cmml"><mrow id="S5.Ex4.m2.2.2.2.2.1.1.1" xref="S5.Ex4.m2.2.2.2.2.1.1.1.cmml"><mtext id="S5.Ex4.m2.2.2.2.2.1.1.1.3" xref="S5.Ex4.m2.2.2.2.2.1.1.1.3a.cmml">acc</mtext><mo lspace="0em" rspace="0em" id="S5.Ex4.m2.2.2.2.2.1.1.1.2" xref="S5.Ex4.m2.2.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S5.Ex4.m2.2.2.2.2.1.1.1.1.1" xref="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.2" xref="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1" xref="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.2" xref="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.2.cmml">B</mi><mi id="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.3" xref="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.3" xref="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.Ex4.m2.2.2.2.2.1.1.3" xref="S5.Ex4.m2.2.2.2.2.1.1.3.cmml">−</mo><mrow id="S5.Ex4.m2.2.2.2.2.1.1.2" xref="S5.Ex4.m2.2.2.2.2.1.1.2.cmml"><mtext id="S5.Ex4.m2.2.2.2.2.1.1.2.3" xref="S5.Ex4.m2.2.2.2.2.1.1.2.3a.cmml">conf</mtext><mo lspace="0em" rspace="0em" id="S5.Ex4.m2.2.2.2.2.1.1.2.2" xref="S5.Ex4.m2.2.2.2.2.1.1.2.2.cmml">​</mo><mrow id="S5.Ex4.m2.2.2.2.2.1.1.2.1.1" xref="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.2" xref="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.cmml">(</mo><msub id="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1" xref="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.cmml"><mi id="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.2" xref="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.2.cmml">B</mi><mi id="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.3" xref="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.3.cmml">m</mi></msub><mo rspace="0.170em" stretchy="false" id="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.3" xref="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="120%" minsize="120%" id="S5.Ex4.m2.2.2.2.2.1.3" xref="S5.Ex4.m2.2.2.2.2.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex4.m2.2b"><apply id="S5.Ex4.m2.2.2.cmml" xref="S5.Ex4.m2.2.2"><eq id="S5.Ex4.m2.2.2.3.cmml" xref="S5.Ex4.m2.2.2.3"></eq><csymbol cd="latexml" id="S5.Ex4.m2.2.2.4.cmml" xref="S5.Ex4.m2.2.2.4">absent</csymbol><apply id="S5.Ex4.m2.2.2.2.cmml" xref="S5.Ex4.m2.2.2.2"><times id="S5.Ex4.m2.2.2.2.3.cmml" xref="S5.Ex4.m2.2.2.2.3"></times><apply id="S5.Ex4.m2.2.2.2.4.cmml" xref="S5.Ex4.m2.2.2.2.4"><csymbol cd="ambiguous" id="S5.Ex4.m2.2.2.2.4.1.cmml" xref="S5.Ex4.m2.2.2.2.4">superscript</csymbol><apply id="S5.Ex4.m2.2.2.2.4.2.cmml" xref="S5.Ex4.m2.2.2.2.4"><csymbol cd="ambiguous" id="S5.Ex4.m2.2.2.2.4.2.1.cmml" xref="S5.Ex4.m2.2.2.2.4">subscript</csymbol><ci id="S5.Ex4.m2.2.2.2.4.2.2.cmml" xref="S5.Ex4.m2.2.2.2.4.2.2">Σ</ci><apply id="S5.Ex4.m2.2.2.2.4.2.3.cmml" xref="S5.Ex4.m2.2.2.2.4.2.3"><eq id="S5.Ex4.m2.2.2.2.4.2.3.1.cmml" xref="S5.Ex4.m2.2.2.2.4.2.3.1"></eq><ci id="S5.Ex4.m2.2.2.2.4.2.3.2.cmml" xref="S5.Ex4.m2.2.2.2.4.2.3.2">𝑚</ci><cn type="integer" id="S5.Ex4.m2.2.2.2.4.2.3.3.cmml" xref="S5.Ex4.m2.2.2.2.4.2.3.3">1</cn></apply></apply><ci id="S5.Ex4.m2.2.2.2.4.3.cmml" xref="S5.Ex4.m2.2.2.2.4.3">𝑀</ci></apply><apply id="S5.Ex4.m2.1.1.1.1.1.1.cmml" xref="S5.Ex4.m2.1.1.1.1.1"><divide id="S5.Ex4.m2.1.1.1.1.1.1.2.cmml" xref="S5.Ex4.m2.1.1.1.1.1.1.2"></divide><apply id="S5.Ex4.m2.1.1.1.1.1.1.1.2.cmml" xref="S5.Ex4.m2.1.1.1.1.1.1.1.1"><abs id="S5.Ex4.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S5.Ex4.m2.1.1.1.1.1.1.1.1.2"></abs><apply id="S5.Ex4.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex4.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.Ex4.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex4.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.Ex4.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.Ex4.m2.1.1.1.1.1.1.1.1.1.2">𝐵</ci><ci id="S5.Ex4.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.Ex4.m2.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply><ci id="S5.Ex4.m2.1.1.1.1.1.1.3.cmml" xref="S5.Ex4.m2.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S5.Ex4.m2.2.2.2.2.2.cmml" xref="S5.Ex4.m2.2.2.2.2.1"><abs id="S5.Ex4.m2.2.2.2.2.2.1.cmml" xref="S5.Ex4.m2.2.2.2.2.1.2"></abs><apply id="S5.Ex4.m2.2.2.2.2.1.1.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1"><minus id="S5.Ex4.m2.2.2.2.2.1.1.3.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.3"></minus><apply id="S5.Ex4.m2.2.2.2.2.1.1.1.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.1"><times id="S5.Ex4.m2.2.2.2.2.1.1.1.2.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.1.2"></times><ci id="S5.Ex4.m2.2.2.2.2.1.1.1.3a.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.1.3"><mtext id="S5.Ex4.m2.2.2.2.2.1.1.1.3.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.1.3">acc</mtext></ci><apply id="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.2">𝐵</ci><ci id="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.1.1.1.1.3">𝑚</ci></apply></apply><apply id="S5.Ex4.m2.2.2.2.2.1.1.2.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.2"><times id="S5.Ex4.m2.2.2.2.2.1.1.2.2.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.2.2"></times><ci id="S5.Ex4.m2.2.2.2.2.1.1.2.3a.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.2.3"><mtext id="S5.Ex4.m2.2.2.2.2.1.1.2.3.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.2.3">conf</mtext></ci><apply id="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.1.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.2.1.1">subscript</csymbol><ci id="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.2.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.2">𝐵</ci><ci id="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.3.cmml" xref="S5.Ex4.m2.2.2.2.2.1.1.2.1.1.1.3">𝑚</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex4.m2.2c">\displaystyle~{}=~{}\Sigma_{m=1}^{M}\,(|B_{m}|/n)~{}~{}\big{|}\,\text{acc}(B_{m})-\text{conf}(B_{m})\,\big{|}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S5.SS4.SSS0.Px4.p1.10" class="ltx_p">where <math id="S5.SS4.SSS0.Px4.p1.2.m1.1" class="ltx_Math" alttext="B_{m}" display="inline"><semantics id="S5.SS4.SSS0.Px4.p1.2.m1.1a"><msub id="S5.SS4.SSS0.Px4.p1.2.m1.1.1" xref="S5.SS4.SSS0.Px4.p1.2.m1.1.1.cmml"><mi id="S5.SS4.SSS0.Px4.p1.2.m1.1.1.2" xref="S5.SS4.SSS0.Px4.p1.2.m1.1.1.2.cmml">B</mi><mi id="S5.SS4.SSS0.Px4.p1.2.m1.1.1.3" xref="S5.SS4.SSS0.Px4.p1.2.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px4.p1.2.m1.1b"><apply id="S5.SS4.SSS0.Px4.p1.2.m1.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS0.Px4.p1.2.m1.1.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.2.m1.1.1">subscript</csymbol><ci id="S5.SS4.SSS0.Px4.p1.2.m1.1.1.2.cmml" xref="S5.SS4.SSS0.Px4.p1.2.m1.1.1.2">𝐵</ci><ci id="S5.SS4.SSS0.Px4.p1.2.m1.1.1.3.cmml" xref="S5.SS4.SSS0.Px4.p1.2.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px4.p1.2.m1.1c">B_{m}</annotation></semantics></math> is the set of indices in bin <math id="S5.SS4.SSS0.Px4.p1.3.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS4.SSS0.Px4.p1.3.m2.1a"><mi id="S5.SS4.SSS0.Px4.p1.3.m2.1.1" xref="S5.SS4.SSS0.Px4.p1.3.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px4.p1.3.m2.1b"><ci id="S5.SS4.SSS0.Px4.p1.3.m2.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.3.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px4.p1.3.m2.1c">m</annotation></semantics></math>, <math id="S5.SS4.SSS0.Px4.p1.4.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S5.SS4.SSS0.Px4.p1.4.m3.1a"><mi id="S5.SS4.SSS0.Px4.p1.4.m3.1.1" xref="S5.SS4.SSS0.Px4.p1.4.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px4.p1.4.m3.1b"><ci id="S5.SS4.SSS0.Px4.p1.4.m3.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.4.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px4.p1.4.m3.1c">n</annotation></semantics></math> is the total number of instances, <math id="S5.SS4.SSS0.Px4.p1.5.m4.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S5.SS4.SSS0.Px4.p1.5.m4.1a"><msub id="S5.SS4.SSS0.Px4.p1.5.m4.1.1" xref="S5.SS4.SSS0.Px4.p1.5.m4.1.1.cmml"><mi id="S5.SS4.SSS0.Px4.p1.5.m4.1.1.2" xref="S5.SS4.SSS0.Px4.p1.5.m4.1.1.2.cmml">y</mi><mi id="S5.SS4.SSS0.Px4.p1.5.m4.1.1.3" xref="S5.SS4.SSS0.Px4.p1.5.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px4.p1.5.m4.1b"><apply id="S5.SS4.SSS0.Px4.p1.5.m4.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS0.Px4.p1.5.m4.1.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.5.m4.1.1">subscript</csymbol><ci id="S5.SS4.SSS0.Px4.p1.5.m4.1.1.2.cmml" xref="S5.SS4.SSS0.Px4.p1.5.m4.1.1.2">𝑦</ci><ci id="S5.SS4.SSS0.Px4.p1.5.m4.1.1.3.cmml" xref="S5.SS4.SSS0.Px4.p1.5.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px4.p1.5.m4.1c">y_{i}</annotation></semantics></math> and <math id="S5.SS4.SSS0.Px4.p1.6.m5.1" class="ltx_Math" alttext="\hat{y}_{i}" display="inline"><semantics id="S5.SS4.SSS0.Px4.p1.6.m5.1a"><msub id="S5.SS4.SSS0.Px4.p1.6.m5.1.1" xref="S5.SS4.SSS0.Px4.p1.6.m5.1.1.cmml"><mover accent="true" id="S5.SS4.SSS0.Px4.p1.6.m5.1.1.2" xref="S5.SS4.SSS0.Px4.p1.6.m5.1.1.2.cmml"><mi id="S5.SS4.SSS0.Px4.p1.6.m5.1.1.2.2" xref="S5.SS4.SSS0.Px4.p1.6.m5.1.1.2.2.cmml">y</mi><mo id="S5.SS4.SSS0.Px4.p1.6.m5.1.1.2.1" xref="S5.SS4.SSS0.Px4.p1.6.m5.1.1.2.1.cmml">^</mo></mover><mi id="S5.SS4.SSS0.Px4.p1.6.m5.1.1.3" xref="S5.SS4.SSS0.Px4.p1.6.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px4.p1.6.m5.1b"><apply id="S5.SS4.SSS0.Px4.p1.6.m5.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS0.Px4.p1.6.m5.1.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.6.m5.1.1">subscript</csymbol><apply id="S5.SS4.SSS0.Px4.p1.6.m5.1.1.2.cmml" xref="S5.SS4.SSS0.Px4.p1.6.m5.1.1.2"><ci id="S5.SS4.SSS0.Px4.p1.6.m5.1.1.2.1.cmml" xref="S5.SS4.SSS0.Px4.p1.6.m5.1.1.2.1">^</ci><ci id="S5.SS4.SSS0.Px4.p1.6.m5.1.1.2.2.cmml" xref="S5.SS4.SSS0.Px4.p1.6.m5.1.1.2.2">𝑦</ci></apply><ci id="S5.SS4.SSS0.Px4.p1.6.m5.1.1.3.cmml" xref="S5.SS4.SSS0.Px4.p1.6.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px4.p1.6.m5.1c">\hat{y}_{i}</annotation></semantics></math> are the predicted and ground truth labels for instance <math id="S5.SS4.SSS0.Px4.p1.7.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS4.SSS0.Px4.p1.7.m6.1a"><mi id="S5.SS4.SSS0.Px4.p1.7.m6.1.1" xref="S5.SS4.SSS0.Px4.p1.7.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px4.p1.7.m6.1b"><ci id="S5.SS4.SSS0.Px4.p1.7.m6.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.7.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px4.p1.7.m6.1c">i</annotation></semantics></math>, and <math id="S5.SS4.SSS0.Px4.p1.8.m7.1" class="ltx_Math" alttext="\hat{p}_{i}" display="inline"><semantics id="S5.SS4.SSS0.Px4.p1.8.m7.1a"><msub id="S5.SS4.SSS0.Px4.p1.8.m7.1.1" xref="S5.SS4.SSS0.Px4.p1.8.m7.1.1.cmml"><mover accent="true" id="S5.SS4.SSS0.Px4.p1.8.m7.1.1.2" xref="S5.SS4.SSS0.Px4.p1.8.m7.1.1.2.cmml"><mi id="S5.SS4.SSS0.Px4.p1.8.m7.1.1.2.2" xref="S5.SS4.SSS0.Px4.p1.8.m7.1.1.2.2.cmml">p</mi><mo id="S5.SS4.SSS0.Px4.p1.8.m7.1.1.2.1" xref="S5.SS4.SSS0.Px4.p1.8.m7.1.1.2.1.cmml">^</mo></mover><mi id="S5.SS4.SSS0.Px4.p1.8.m7.1.1.3" xref="S5.SS4.SSS0.Px4.p1.8.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px4.p1.8.m7.1b"><apply id="S5.SS4.SSS0.Px4.p1.8.m7.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.8.m7.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS0.Px4.p1.8.m7.1.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.8.m7.1.1">subscript</csymbol><apply id="S5.SS4.SSS0.Px4.p1.8.m7.1.1.2.cmml" xref="S5.SS4.SSS0.Px4.p1.8.m7.1.1.2"><ci id="S5.SS4.SSS0.Px4.p1.8.m7.1.1.2.1.cmml" xref="S5.SS4.SSS0.Px4.p1.8.m7.1.1.2.1">^</ci><ci id="S5.SS4.SSS0.Px4.p1.8.m7.1.1.2.2.cmml" xref="S5.SS4.SSS0.Px4.p1.8.m7.1.1.2.2">𝑝</ci></apply><ci id="S5.SS4.SSS0.Px4.p1.8.m7.1.1.3.cmml" xref="S5.SS4.SSS0.Px4.p1.8.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px4.p1.8.m7.1c">\hat{p}_{i}</annotation></semantics></math> is the individual confidence (<em id="S5.SS4.SSS0.Px4.p1.10.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS4.SSS0.Px4.p1.10.2" class="ltx_text"></span> softmax score) for instance <math id="S5.SS4.SSS0.Px4.p1.9.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS4.SSS0.Px4.p1.9.m8.1a"><mi id="S5.SS4.SSS0.Px4.p1.9.m8.1.1" xref="S5.SS4.SSS0.Px4.p1.9.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px4.p1.9.m8.1b"><ci id="S5.SS4.SSS0.Px4.p1.9.m8.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.9.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px4.p1.9.m8.1c">i</annotation></semantics></math>.
An ECE of 0 indicates perfect calibration <em id="S5.SS4.SSS0.Px4.p1.10.3" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS4.SSS0.Px4.p1.10.4" class="ltx_text"></span> <math id="S5.SS4.SSS0.Px4.p1.10.m9.1" class="ltx_Math" alttext="p_{i}\!=\!1" display="inline"><semantics id="S5.SS4.SSS0.Px4.p1.10.m9.1a"><mrow id="S5.SS4.SSS0.Px4.p1.10.m9.1.1" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1.cmml"><msub id="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2.cmml"><mi id="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2.2" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2.2.cmml">p</mi><mi id="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2.3" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2.3.cmml">i</mi></msub><mo lspace="0.108em" rspace="0.108em" id="S5.SS4.SSS0.Px4.p1.10.m9.1.1.1" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1.1.cmml">=</mo><mn id="S5.SS4.SSS0.Px4.p1.10.m9.1.1.3" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px4.p1.10.m9.1b"><apply id="S5.SS4.SSS0.Px4.p1.10.m9.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1"><eq id="S5.SS4.SSS0.Px4.p1.10.m9.1.1.1.cmml" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1.1"></eq><apply id="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2.cmml" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2.1.cmml" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2">subscript</csymbol><ci id="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2.2.cmml" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2.2">𝑝</ci><ci id="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2.3.cmml" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S5.SS4.SSS0.Px4.p1.10.m9.1.1.3.cmml" xref="S5.SS4.SSS0.Px4.p1.10.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px4.p1.10.m9.1c">p_{i}\!=\!1</annotation></semantics></math> for correct predictions and 0 for incorrect ones.</p>
</div>
</section>
<section id="S5.SS4.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Results of supervised energy-based training.</h4>

<div id="S5.SS4.SSS0.Px5.p1" class="ltx_para">
<p id="S5.SS4.SSS0.Px5.p1.3" class="ltx_p">The baseline model (Table <a href="#S5.T4" title="Table 4 ‣ 5.4 Supervised energy-based training ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, second row) unsurprisingly overfits the object/color combinations of the training data and is therefore unable to generalize to novel combinations at test time.
The model obtains an accuracy of <math id="S5.SS4.SSS0.Px5.p1.1.m1.1" class="ltx_Math" alttext="100\%" display="inline"><semantics id="S5.SS4.SSS0.Px5.p1.1.m1.1a"><mrow id="S5.SS4.SSS0.Px5.p1.1.m1.1.1" xref="S5.SS4.SSS0.Px5.p1.1.m1.1.1.cmml"><mn id="S5.SS4.SSS0.Px5.p1.1.m1.1.1.2" xref="S5.SS4.SSS0.Px5.p1.1.m1.1.1.2.cmml">100</mn><mo id="S5.SS4.SSS0.Px5.p1.1.m1.1.1.1" xref="S5.SS4.SSS0.Px5.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px5.p1.1.m1.1b"><apply id="S5.SS4.SSS0.Px5.p1.1.m1.1.1.cmml" xref="S5.SS4.SSS0.Px5.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS4.SSS0.Px5.p1.1.m1.1.1.1.cmml" xref="S5.SS4.SSS0.Px5.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.SS4.SSS0.Px5.p1.1.m1.1.1.2.cmml" xref="S5.SS4.SSS0.Px5.p1.1.m1.1.1.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px5.p1.1.m1.1c">100\%</annotation></semantics></math> on questions about spheres (same combinations in training and test) but <math id="S5.SS4.SSS0.Px5.p1.2.m2.1" class="ltx_Math" alttext="0\%" display="inline"><semantics id="S5.SS4.SSS0.Px5.p1.2.m2.1a"><mrow id="S5.SS4.SSS0.Px5.p1.2.m2.1.1" xref="S5.SS4.SSS0.Px5.p1.2.m2.1.1.cmml"><mn id="S5.SS4.SSS0.Px5.p1.2.m2.1.1.2" xref="S5.SS4.SSS0.Px5.p1.2.m2.1.1.2.cmml">0</mn><mo id="S5.SS4.SSS0.Px5.p1.2.m2.1.1.1" xref="S5.SS4.SSS0.Px5.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px5.p1.2.m2.1b"><apply id="S5.SS4.SSS0.Px5.p1.2.m2.1.1.cmml" xref="S5.SS4.SSS0.Px5.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS4.SSS0.Px5.p1.2.m2.1.1.1.cmml" xref="S5.SS4.SSS0.Px5.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S5.SS4.SSS0.Px5.p1.2.m2.1.1.2.cmml" xref="S5.SS4.SSS0.Px5.p1.2.m2.1.1.2">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px5.p1.2.m2.1c">0\%</annotation></semantics></math> on cubes and cylinders (OOD combinations).
The calibration is also poor (high ECE of <math id="S5.SS4.SSS0.Px5.p1.3.m3.1" class="ltx_Math" alttext="71.54" display="inline"><semantics id="S5.SS4.SSS0.Px5.p1.3.m3.1a"><mn id="S5.SS4.SSS0.Px5.p1.3.m3.1.1" xref="S5.SS4.SSS0.Px5.p1.3.m3.1.1.cmml">71.54</mn><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px5.p1.3.m3.1b"><cn type="float" id="S5.SS4.SSS0.Px5.p1.3.m3.1.1.cmml" xref="S5.SS4.SSS0.Px5.p1.3.m3.1.1">71.54</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px5.p1.3.m3.1c">71.54</annotation></semantics></math>%) indicating that the model is confident about its wrong predictions.</p>
</div>
</section>
<section id="S5.SS4.SSS0.Px6" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">The standard JEM</h4>

<div id="S5.SS4.SSS0.Px6.p1" class="ltx_para">
<p id="S5.SS4.SSS0.Px6.p1.1" class="ltx_p">(Table <a href="#S5.T4" title="Table 4 ‣ 5.4 Supervised energy-based training ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, third row) shows poor accuracy and calibration similar to the baseline.
Careful inspection revealed that the classification objective quickly dominates the energy learning.
In other words, the model could not simultaneously predict correct answers and be capable of generating new images.
The classification loss would typically converge much faster and, to minimize the energy loss, the model would start generating non-realistic images that always give a high energy.
The energy learning objective is thus ineffective in this regime.
We mitigate the dominance of the classification objective by down-scaling the corresponding term by a constant factor (0.1 proved effective).
The resulting model then learns to produce naturally-looking images (see Figure <a href="#S5.F8" title="Figure 8 ‣ The modified JEM ‣ 5.4 Supervised energy-based training ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, bottom row).
Nevertheless, at some point during training, we always observed that the model would start generating noisy images that quickly diverge from the training data (see Figure <a href="#S5.F8" title="Figure 8 ‣ The modified JEM ‣ 5.4 Supervised energy-based training ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, top row).
We solve this issue with early stopping, which we trigger when the energies of real and generated images diverge past a threshold: <math id="S5.SS4.SSS0.Px6.p1.1.m1.2" class="ltx_Math" alttext="|E_{{\boldsymbol{\theta}}}({\boldsymbol{x}}^{\prime})-E_{{\boldsymbol{\theta}}}({\boldsymbol{x}})|&gt;0.8" display="inline"><semantics id="S5.SS4.SSS0.Px6.p1.1.m1.2a"><mrow id="S5.SS4.SSS0.Px6.p1.1.m1.2.2" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.cmml"><mrow id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.2" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.2.1.cmml">|</mo><mrow id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.cmml"><mrow id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.cmml"><msub id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3.cmml"><mi id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3.2" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3.2.cmml">E</mi><mi id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3.3" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.2" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.2" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msup id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mo id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.3" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.2" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.2.cmml">−</mo><mrow id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.cmml"><msub id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2.cmml"><mi id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2.2" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2.2.cmml">E</mi><mi id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2.3" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.1" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.1.cmml">​</mo><mrow id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.3.2" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.3.2.1" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.cmml">(</mo><mi id="S5.SS4.SSS0.Px6.p1.1.m1.1.1" xref="S5.SS4.SSS0.Px6.p1.1.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.3.2.2" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.3" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.2.1.cmml">|</mo></mrow><mo id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.2" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.2.cmml">&gt;</mo><mn id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.3" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px6.p1.1.m1.2b"><apply id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2"><gt id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.2.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.2"></gt><apply id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.2.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1"><abs id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.2.1.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.2"></abs><apply id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1"><minus id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.2.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.2"></minus><apply id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1"><times id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.2"></times><apply id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3.1.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3.2.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3.2">𝐸</ci><ci id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3.3.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.3.3">𝜽</ci></apply><apply id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.1.1.1.1.3">′</ci></apply></apply><apply id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3"><times id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.1.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.1"></times><apply id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2.1.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2">subscript</csymbol><ci id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2.2.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2.2">𝐸</ci><ci id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2.3.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.1.1.1.3.2.3">𝜽</ci></apply><ci id="S5.SS4.SSS0.Px6.p1.1.m1.1.1.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.1.1">𝒙</ci></apply></apply></apply><cn type="float" id="S5.SS4.SSS0.Px6.p1.1.m1.2.2.3.cmml" xref="S5.SS4.SSS0.Px6.p1.1.m1.2.2.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px6.p1.1.m1.2c">|E_{{\boldsymbol{\theta}}}({\boldsymbol{x}}^{\prime})-E_{{\boldsymbol{\theta}}}({\boldsymbol{x}})|&gt;0.8</annotation></semantics></math>.</p>
</div>
</section>
<section id="S5.SS4.SSS0.Px7" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">The modified JEM</h4>

<div id="S5.SS4.SSS0.Px7.p1" class="ltx_para">
<p id="S5.SS4.SSS0.Px7.p1.2" class="ltx_p">(Table <a href="#S5.T4" title="Table 4 ‣ 5.4 Supervised energy-based training ‣ 5 Experiments ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, fourth row) gives a higher overall accuracy (<math id="S5.SS4.SSS0.Px7.p1.1.m1.1" class="ltx_Math" alttext="49.10\%" display="inline"><semantics id="S5.SS4.SSS0.Px7.p1.1.m1.1a"><mrow id="S5.SS4.SSS0.Px7.p1.1.m1.1.1" xref="S5.SS4.SSS0.Px7.p1.1.m1.1.1.cmml"><mn id="S5.SS4.SSS0.Px7.p1.1.m1.1.1.2" xref="S5.SS4.SSS0.Px7.p1.1.m1.1.1.2.cmml">49.10</mn><mo id="S5.SS4.SSS0.Px7.p1.1.m1.1.1.1" xref="S5.SS4.SSS0.Px7.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px7.p1.1.m1.1b"><apply id="S5.SS4.SSS0.Px7.p1.1.m1.1.1.cmml" xref="S5.SS4.SSS0.Px7.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS4.SSS0.Px7.p1.1.m1.1.1.1.cmml" xref="S5.SS4.SSS0.Px7.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S5.SS4.SSS0.Px7.p1.1.m1.1.1.2.cmml" xref="S5.SS4.SSS0.Px7.p1.1.m1.1.1.2">49.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px7.p1.1.m1.1c">49.10\%</annotation></semantics></math>) as well as a better calibration (ECE of <math id="S5.SS4.SSS0.Px7.p1.2.m2.1" class="ltx_Math" alttext="36.55" display="inline"><semantics id="S5.SS4.SSS0.Px7.p1.2.m2.1a"><mn id="S5.SS4.SSS0.Px7.p1.2.m2.1.1" xref="S5.SS4.SSS0.Px7.p1.2.m2.1.1.cmml">36.55</mn><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px7.p1.2.m2.1b"><cn type="float" id="S5.SS4.SSS0.Px7.p1.2.m2.1.1.cmml" xref="S5.SS4.SSS0.Px7.p1.2.m2.1.1">36.55</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px7.p1.2.m2.1c">36.55</annotation></semantics></math>%).
Contrary to the baseline, this model can therefore correctly handle some of the OOD data, although it still often confuses cubes and cylinders with relatively high confidence.</p>
</div>
<figure id="S5.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2206.14355/assets/Figures/ebm_gen/gen_1.png" id="S5.F8.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="120" height="120" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2206.14355/assets/Figures/ebm_gen/gen_2.png" id="S5.F8.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="120" height="120" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2206.14355/assets/Figures/ebm_gen/gen_3.png" id="S5.F8.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="120" height="120" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2206.14355/assets/Figures/ebm_gen/gen_4.png" id="S5.F8.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="120" height="120" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2206.14355/assets/Figures/ebm_gen/gen_5.png" id="S5.F8.g5" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="120" height="120" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2206.14355/assets/Figures/ebm_gen/gen_6.png" id="S5.F8.g6" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="120" height="120" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2206.14355/assets/Figures/ebm_gen/gen_7.png" id="S5.F8.g7" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="120" height="120" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2206.14355/assets/Figures/ebm_gen/gen_8.png" id="S5.F8.g8" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="120" height="120" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F8.2.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="S5.F8.3.2" class="ltx_text" style="font-size:90%;">Generated images of high (top) and low energy (bottom).</span></figcaption>
</figure>
</section>
<section id="S5.SS4.SSS0.Px8" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">The CEBM</h4>

<div id="S5.SS4.SSS0.Px8.p1" class="ltx_para">
<p id="S5.SS4.SSS0.Px8.p1.1" class="ltx_p">seems to surpass the baseline, but its results are in fact not much better than random predictions.
Indeed, even though the CEBM does not overfit to the spurious correlations in the training data like the baseline, but it also fails to correctly answer questions about spheres (the ID test data), which were handled perfectly by the baseline and the JEM.
Moreover, we observed a surprising lack of correlation between the CEBM’s FID score (<em id="S5.SS4.SSS0.Px8.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS4.SSS0.Px8.p1.1.2" class="ltx_text"></span> its generative performance, which we use for early stopping) and its VQA accuracy (<em id="S5.SS4.SSS0.Px8.p1.1.3" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS4.SSS0.Px8.p1.1.4" class="ltx_text"></span> its discriminative performance).
In fact, the answers predicted by the model fluctuate wildly across epochs.
The low ECE score of the CEBM (<math id="S5.SS4.SSS0.Px8.p1.1.m1.1" class="ltx_Math" alttext="9.24" display="inline"><semantics id="S5.SS4.SSS0.Px8.p1.1.m1.1a"><mn id="S5.SS4.SSS0.Px8.p1.1.m1.1.1" xref="S5.SS4.SSS0.Px8.p1.1.m1.1.1.cmml">9.24</mn><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS0.Px8.p1.1.m1.1b"><cn type="float" id="S5.SS4.SSS0.Px8.p1.1.m1.1.1.cmml" xref="S5.SS4.SSS0.Px8.p1.1.m1.1.1">9.24</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS0.Px8.p1.1.m1.1c">9.24</annotation></semantics></math>%) is simply due a low confidence for all (mostly wrong) predictions. Thus it does not correspond to a desirable behavior.</p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">The first part of this paper explored the applicability of self-supervised learning to pretrain visual representations for VQA.
We experimented with two instantiations of contrastive learning (CL) and energy-based models (EBMs).
With both, we could learn representations from unlabeled images that proved effective in a toy VQA setting.
After pretraining, the VQA models could be trained with little annotated data and handle OOD instances to some extent.
However, we found EBMs to be difficult to put into practice because of unstable training and variability in their results.
On the opposite, CL proved much more practical. In our setting, representations learned with CL on little data could compete with those from a supervised, ImageNet-pretrained model.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">Overall, self-supervised pretraining is an increasingly attractive alternative to traditional transfer learning from a supervised model.
This option is particularly relevant when dealing with particular visual domains <em id="S6.p2.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S6.p2.1.2" class="ltx_text"></span> for medical VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">In the second part of this paper, we investigated various purported benefits of EBMs (OOD detection, supervised energy-based training, calibration). These experiments were unfortunately largely negative.
This study is limited by the implementation choices that were necessarily made, and by our simplistic evaluation setting – admittedly a far cry from open-domain VQA.
Still, our experience suggests that the state of the art on EBMs at the time of this study (mid 2021) is not ready for complex tasks like VQA. Other choices and future developments may of course affect this recommendation.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
M. Ehsan Abbasnejad, Qinfeng Shi, Anton van den Hengel, and Lingqiao Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">A generative adversarial density estimator.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2019 IEEE/CVF Conference on Computer Vision and Pattern
Recognition (CVPR)</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, pages 10774–10783, 2019.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Peter Anderson, Xiaodong He, Chris Buehler, Damien Teney, Mark Johnson, Stephen
Gould, and Lei Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Bottom-up and top-down attention for image captioning and visual
question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, volume 3, page 6, 2018.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Stanislaw Antol, Aishwarya Agrawal, Jiasen Lu, Margaret Mitchell, Dhruv Batra,
C Lawrence Zitnick, and Devi Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Vqa: Visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, pages 2425–2433, 2015.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Michael Arbel, Liang Zhou, and Arthur Gretton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Generalized energy based models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">,
2020.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Yuval Atzmon, Felix Kreuk, Uri Shalit, and Gal Chechik.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">A causal view of compositional zero-shot recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2006.14610</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Philip Bachman, R Devon Hjelm, and William Buchwalter.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Learning representations by maximizing mutual information across
views.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib6.4.2" class="ltx_text" style="font-size:90%;">,
32:15535–15545, 2019.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Nilavra Bhattacharya, Qing Li, and Danna Gurari.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Why does a visual question have different answers?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, pages 4271–4280, 2019.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Zhaowei Cai, Gukyeong Kwon, Avinash Ravichandran, Erhan Bas, Zhuowen Tu, Rahul
Bhotika, and Stefano Soatto.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">X-DETR: A versatile architecture for instance-wise vision-language
tasks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2204.05626</span><span id="bib.bib8.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Mathilde Caron, Ishan Misra, Julien Mairal, Priya Goyal, Piotr Bojanowski, and
Armand Joulin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Unsupervised learning of visual features by contrasting cluster
assignments.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Thirty-fourth Conference on Neural Information Processing
Systems (NeurIPS)</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Ting Chen, Simon Kornblith, Mohammad Norouzi, and Geoffrey Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">A simple framework for contrastive learning of visual
representations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, pages 1597–1607. PMLR, 2020.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Yen-Chun Chen, Linjie Li, Licheng Yu, Ahmed El Kholy, Faisal Ahmed, Zhe Gan, Yu
Cheng, and Jingjing Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Uniter: Universal image-text representation learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">,
2020.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Tai-Yin Chiu, Yinan Zhao, and Danna Gurari.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Assessing image quality issues for real-world problems.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, pages 3646–3656, 2020.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Blender Online Community.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Blender - a 3D modelling and rendering package</span><span id="bib.bib13.3.2" class="ltx_text" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.4.1" class="ltx_text" style="font-size:90%;">Blender Foundation, Stichting Blender Foundation, Amsterdam, 2018.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Corentin Dancette, Remi Cadene, Damien Teney, and Matthieu Cord.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Beyond question-based biases: Assessing multimodal shortcut learning
in visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, pages 1574–1583, 2021.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Imagenet: A large-scale hierarchical image database.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">, pages 248–255, 2009.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Li Deng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">The mnist database of handwritten digit images for machine learning
research.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Signal Processing Magazine</span><span id="bib.bib16.4.2" class="ltx_text" style="font-size:90%;">, 29(6):141–142, 2012.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Yuntian Deng, Anton Bakhtin, Myle Ott, Arthur Szlam, and Marc’Aurelio Ranzato.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Residual energy-based models for text generation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">,
2019.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Yilun Du, Shuang Li, and Igor Mordatch.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Compositional visual generation with energy based models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">,
33:6637–6647, 2020.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Yilun Du, Shuang Li, Joshua Tenenbaum, and Igor Mordatch.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Improved contrastive divergence training of energy based models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2012.01316</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Yilun Du and Igor Mordatch.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Implicit generation and modeling with energy based models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib20.4.2" class="ltx_text" style="font-size:90%;">,
32:3608–3618, 2019.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Sven Elflein, Bertrand Charpentier, Daniel Zügner, and Stephan
Günnemann.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">On out-of-distribution detection with energy-based models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2107.08785</span><span id="bib.bib21.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley,
Sherjil Ozair, Aaron Courville, and Yoshua Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Generative adversarial nets.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib22.4.2" class="ltx_text" style="font-size:90%;">, 27, 2014.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Yash Goyal, Tejas Khot, Douglas Summers-Stay, Dhruv Batra, and Devi Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Making the v in VQA matter: Elevating the role of image
understanding in visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, pages 6904–6913, 2017.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Will Grathwohl, Kuan-Chieh Wang, Joern-Henrik Jacobsen, David Duvenaud,
Mohammad Norouzi, and Kevin Swersky.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Your classifier is secretly an energy based model and you should
treat it like one.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">,
2019.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Liangke Gui, Qiuyuan Huang, Alex Hauptmann, Yonatan Bisk, and Jianfeng Gao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Training vision-language transformers from captions alone.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2205.09256</span><span id="bib.bib25.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Chuan Guo, Geoff Pleiss, Yu Sun, and Kilian Q Weinberger.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">On calibration of modern neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, pages 1321–1330. PMLR, 2017.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Fredrik Gustafsson, Martin Danelljan, Radu Timofte, and Thomas B Schön.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">How to train your energy-based model for regression.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the British Machine Vision Conference</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">,
2020.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Fredrik K Gustafsson, Martin Danelljan, Goutam Bhat, and Thomas B Schön.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Energy-based models for deep probabilistic regression.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">,
pages 325–343. Springer, 2020.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Tian Han, Erik Nijkamp, Xiaolin Fang, Mitch Hill, Song-Chun Zhu, and Ying Nian
Wu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Divergence triangle for joint training of generator model,
energy-based model, and inferential model.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, pages 8670–8679, 2019.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Haoqi Fan, Yuxin Wu, Saining Xie, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Momentum contrast for unsupervised visual representation learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, pages 9729–9738, 2020.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, pages 770–778, 2016.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Tianxing He, Bryan McCann, Caiming Xiong, and Ehsan Hosseini-Asl.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Joint energy-based model training for better calibrated natural
language understanding models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the Conference of the European Chapter of the
Association for Computational Linguistics</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, pages 1754–1761, 2021.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Xuehai He, Yichen Zhang, Luntian Mou, Eric Xing, and Pengtao Xie.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Pathvqa: 30000+ questions for medical visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2003.10286</span><span id="bib.bib33.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Olivier Henaff.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Data-efficient image recognition with contrastive predictive coding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib34.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib34.5.3" class="ltx_text" style="font-size:90%;">, pages 4182–4192. PMLR, 2020.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Dan Hendrycks and Kevin Gimpel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">A baseline for detecting misclassified and out-of-distribution
examples in neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1610.02136</span><span id="bib.bib35.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Martin Heusel, Hubert Ramsauer, Thomas Unterthiner, Bernhard Nessler, and Sepp
Hochreiter.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Gans trained by a two time-scale update rule converge to a local nash
equilibrium.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib36.4.2" class="ltx_text" style="font-size:90%;">, 30, 2017.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Geoffrey E Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Training products of experts by minimizing contrastive divergence.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Neural computation</span><span id="bib.bib37.4.2" class="ltx_text" style="font-size:90%;">, 14(8):1771–1800, 2002.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Zhicheng Huang, Zhaoyang Zeng, Yupan Huang, Bei Liu, Dongmei Fu, and Jianlong
Fu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Seeing out of the box: End-to-end pre-training for
vision-language representation learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib38.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib38.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Justin Johnson, Bharath Hariharan, Laurens van der Maaten, Li Fei-Fei,
C Lawrence Zitnick, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Clevr: A diagnostic dataset for compositional language and
elementary visual reasoning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib39.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib39.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Kushal Kafle and Christopher Kanan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Visual question answering: Datasets, algorithms, and future
challenges.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision and Image Understanding</span><span id="bib.bib40.4.2" class="ltx_text" style="font-size:90%;">, 163:3–20, 2017.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Kushal Kafle, Robik Shrestha, and Christopher Kanan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Challenges and prospects in vision and language research.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Frontiers in Artificial Intelligence</span><span id="bib.bib41.4.2" class="ltx_text" style="font-size:90%;">, 2:28, 2019.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Aishwarya Kamath, Mannat Singh, Yann LeCun, Gabriel Synnaeve, Ishan Misra, and
Nicolas Carion.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">MDETR-modulated detection for end-to-end multi-modal understanding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib42.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib42.5.3" class="ltx_text" style="font-size:90%;">, pages 1780–1790, 2021.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Wonjae Kim, Bokyung Son, and Ildoo Kim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">ViLT: Vision-and-language transformer without convolution or region
supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib43.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib43.5.3" class="ltx_text" style="font-size:90%;">, pages 5583–5594. PMLR, 2021.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Diederik P Kingma and Max Welling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Auto-encoding variational bayes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1312.6114</span><span id="bib.bib44.4.2" class="ltx_text" style="font-size:90%;">, 2013.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson, Kenji Hata, Joshua
Kravitz, Stephanie Chen, Yannis Kalantidis, Li-Jia Li, David A Shamma, and
Others.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Visual genome: Connecting language and vision using crowdsourced
dense image annotations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">International Journal of Computer Vision</span><span id="bib.bib45.4.2" class="ltx_text" style="font-size:90%;">, 123(1):32–73, 2017.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Alex Krizhevsky, Geoffrey Hinton, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">Learning multiple layers of features from tiny images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text" style="font-size:90%;">2009.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text" style="font-size:90%;">
Jason J Lau, Soumya Gayen, Asma Ben Abacha, and Dina Demner-Fushman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.2.1" class="ltx_text" style="font-size:90%;">A dataset of clinically generated visual questions and answers about
radiology images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Scientific data</span><span id="bib.bib47.4.2" class="ltx_text" style="font-size:90%;">, 5(1):1–10, 2018.
</span>
</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text" style="font-size:90%;">
Yann LeCun, Sumit Chopra, Raia Hadsell, M Ranzato, and F Huang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.2.1" class="ltx_text" style="font-size:90%;">A tutorial on energy-based learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Predicting structured data</span><span id="bib.bib48.4.2" class="ltx_text" style="font-size:90%;">, 1(0), 2006.
</span>
</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text" style="font-size:90%;">
Liunian Harold Li, Mark Yatskar, Da Yin, Cho-Jui Hsieh, and Kai-Wei Chang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.2.1" class="ltx_text" style="font-size:90%;">Visualbert: A simple and performant baseline for vision and
language.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1908.03557</span><span id="bib.bib49.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text" style="font-size:90%;">
Shuang Li, Yilun Du, Gido M van de Ven, and Igor Mordatch.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.2.1" class="ltx_text" style="font-size:90%;">Energy-based models for continual learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2011.12216</span><span id="bib.bib50.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text" style="font-size:90%;">
Xiujun Li, Xi Yin, Chunyuan Li, Pengchuan Zhang, Xiaowei Hu, Lei Zhang, Lijuan
Wang, Houdong Hu, Li Dong, Furu Wei, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.2.1" class="ltx_text" style="font-size:90%;">Oscar: Object-semantics aligned pre-training for vision-language
tasks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib51.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision</span><span id="bib.bib51.5.3" class="ltx_text" style="font-size:90%;">,
pages 121–137. Springer, 2020.
</span>
</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock"><span id="bib.bib52.1.1" class="ltx_text" style="font-size:90%;">
Weitang Liu, Xiaoyun Wang, John D Owens, and Yixuan Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.2.1" class="ltx_text" style="font-size:90%;">Energy-based out-of-distribution detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2010.03759</span><span id="bib.bib52.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock"><span id="bib.bib53.1.1" class="ltx_text" style="font-size:90%;">
Ziwei Liu, Ping Luo, Xiaogang Wang, and Xiaoou Tang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.2.1" class="ltx_text" style="font-size:90%;">Deep learning face attributes in the wild.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib53.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib53.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib53.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock"><span id="bib.bib54.1.1" class="ltx_text" style="font-size:90%;">
Mateusz Malinowski, Marcus Rohrbach, and Mario Fritz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.2.1" class="ltx_text" style="font-size:90%;">Ask your neurons: A neural-based approach to answering questions
about images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib54.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib54.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib54.5.3" class="ltx_text" style="font-size:90%;">, pages 1–9, 2015.
</span>
</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock"><span id="bib.bib55.1.1" class="ltx_text" style="font-size:90%;">
Tomas Mikolov, Kai Chen, Greg Corrado, and Jeffrey Dean.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.2.1" class="ltx_text" style="font-size:90%;">Efficient estimation of word representations in vector space.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib55.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1301.3781</span><span id="bib.bib55.4.2" class="ltx_text" style="font-size:90%;">, 2013.
</span>
</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock"><span id="bib.bib56.1.1" class="ltx_text" style="font-size:90%;">
Yuval Netzer, Tao Wang, Adam Coates, Alessandro Bissacco, Bo Wu, and Andrew Y
Ng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.2.1" class="ltx_text" style="font-size:90%;">Reading digits in natural images with unsupervised feature learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib56.3.1" class="ltx_text" style="font-size:90%;">2011.
</span>
</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock"><span id="bib.bib57.1.1" class="ltx_text" style="font-size:90%;">
Erik Nijkamp, Mitch Hill, Tian Han, Song-Chun Zhu, and Ying Nian Wu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.2.1" class="ltx_text" style="font-size:90%;">On the anatomy of mcmc-based maximum likelihood learning of
energy-based models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib57.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib57.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial
Intelligence</span><span id="bib.bib57.5.3" class="ltx_text" style="font-size:90%;">, volume 34, pages 5272–5280, 2020.
</span>
</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock"><span id="bib.bib58.1.1" class="ltx_text" style="font-size:90%;">
Erik Nijkamp, Mitch Hill, Song-Chun Zhu, and Ying Nian Wu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib58.2.1" class="ltx_text" style="font-size:90%;">Learning non-convergent non-persistent short-run MCMC toward
energy-based model.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib58.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1904.09770</span><span id="bib.bib58.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock"><span id="bib.bib59.1.1" class="ltx_text" style="font-size:90%;">
Aaron van den Oord, Yazhe Li, and Oriol Vinyals.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib59.2.1" class="ltx_text" style="font-size:90%;">Representation learning with contrastive predictive coding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib59.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1807.03748</span><span id="bib.bib59.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock"><span id="bib.bib60.1.1" class="ltx_text" style="font-size:90%;">
Jeffrey Pennington, Richard Socher, and Christopher Manning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib60.2.1" class="ltx_text" style="font-size:90%;">Glove: Global vectors for word representation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib60.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib60.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the Conference on Empirical Methods in
Natural Language Processing</span><span id="bib.bib60.5.3" class="ltx_text" style="font-size:90%;">, pages 1532–1543, 2014.
</span>
</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock"><span id="bib.bib61.1.1" class="ltx_text" style="font-size:90%;">
Mengye Ren, Ryan Kiros, and Richard Zemel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib61.2.1" class="ltx_text" style="font-size:90%;">Exploring models and data for image question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib61.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib61.4.2" class="ltx_text" style="font-size:90%;">,
28:2953–2961, 2015.
</span>
</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock"><span id="bib.bib62.1.1" class="ltx_text" style="font-size:90%;">
Jan-Martin O Steitz, Jonas Pfeiffer, Iryna Gurevych, and Stefan Roth.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib62.2.1" class="ltx_text" style="font-size:90%;">TxT: Crossmodal end-to-end learning with transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib62.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib62.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">DAGM German Conference on Pattern Recognition</span><span id="bib.bib62.5.3" class="ltx_text" style="font-size:90%;">, pages
405–420. Springer, 2021.
</span>
</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock"><span id="bib.bib63.1.1" class="ltx_text" style="font-size:90%;">
Mohammed Suhail, Abhay Mittal, Behjat Siddiquie, Chris Broaddus, Jayan Eledath,
Gerard Medioni, and Leonid Sigal.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib63.2.1" class="ltx_text" style="font-size:90%;">Energy-based learning for scene graph generation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib63.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib63.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib63.5.3" class="ltx_text" style="font-size:90%;">, pages 13936–13945, 2021.
</span>
</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock"><span id="bib.bib64.1.1" class="ltx_text" style="font-size:90%;">
Hao Tan and Mohit Bansal.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib64.2.1" class="ltx_text" style="font-size:90%;">Lxmert: Learning cross-modality encoder representations from
transformers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib64.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib64.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the Conference on Empirical Methods in
Natural Language Processing and the International Joint Conference on Natural
Language Processing</span><span id="bib.bib64.5.3" class="ltx_text" style="font-size:90%;">, pages 5103–5114, 2019.
</span>
</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock"><span id="bib.bib65.1.1" class="ltx_text" style="font-size:90%;">
Damien Teney, Ehsan Abbasnedjad, and Anton van den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib65.2.1" class="ltx_text" style="font-size:90%;">Learning what makes a difference from counterfactual examples and
gradient supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib65.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib65.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">European Conference on Computer Vision</span><span id="bib.bib65.5.3" class="ltx_text" style="font-size:90%;">, pages 580–599.
Springer, 2020.
</span>
</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock"><span id="bib.bib66.1.1" class="ltx_text" style="font-size:90%;">
Damien Teney, Ehsan Abbasnejad, and Anton van den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib66.2.1" class="ltx_text" style="font-size:90%;">Unshuffling data for improved generalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib66.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2002.11894</span><span id="bib.bib66.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock"><span id="bib.bib67.1.1" class="ltx_text" style="font-size:90%;">
Damien Teney, Ehsan Abbasnejad, Kushal Kafle, Robik Shrestha, Christopher
Kanan, and Anton Van Den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib67.2.1" class="ltx_text" style="font-size:90%;">On the value of out-of-distribution testing: An example of goodhart’s
law.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib67.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib67.4.2" class="ltx_text" style="font-size:90%;">, 33:407–417,
2020.
</span>
</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock"><span id="bib.bib68.1.1" class="ltx_text" style="font-size:90%;">
Damien Teney, Peter Anderson, Xiaodong He, and Anton van den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib68.2.1" class="ltx_text" style="font-size:90%;">Tips and tricks for visual question answering: Learnings from the
2017 challenge.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib68.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1708.02711</span><span id="bib.bib68.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock"><span id="bib.bib69.1.1" class="ltx_text" style="font-size:90%;">
Damien Teney, Qi Wu, and Anton van den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib69.2.1" class="ltx_text" style="font-size:90%;">Visual question answering: A tutorial.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib69.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Signal Processing Magazine</span><span id="bib.bib69.4.2" class="ltx_text" style="font-size:90%;">, 34:63–75, 2017.
</span>
</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock"><span id="bib.bib70.1.1" class="ltx_text" style="font-size:90%;">
Yonglong Tian, Dilip Krishnan, and Phillip Isola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib70.2.1" class="ltx_text" style="font-size:90%;">Contrastive multiview coding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib70.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib70.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision–ECCV 2020: 16th European Conference,
Glasgow, UK, August 23–28, 2020, Proceedings, Part XI 16</span><span id="bib.bib70.5.3" class="ltx_text" style="font-size:90%;">, pages 776–794.
Springer, 2020.
</span>
</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock"><span id="bib.bib71.1.1" class="ltx_text" style="font-size:90%;">
Lifu Tu, Richard Yuanzhe Pang, Sam Wiseman, and Kevin Gimpel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib71.2.1" class="ltx_text" style="font-size:90%;">Engine: Energy-based inference networks for non-autoregressive
machine translation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib71.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib71.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the Annual Meeting of the Association for
Computational Linguistics</span><span id="bib.bib71.5.3" class="ltx_text" style="font-size:90%;">, pages 2819–2826, 2020.
</span>
</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock"><span id="bib.bib72.1.1" class="ltx_text" style="font-size:90%;">
Max Welling and Yee W Teh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib72.2.1" class="ltx_text" style="font-size:90%;">Bayesian learning via stochastic gradient Langevin dynamics.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib72.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib72.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib72.5.3" class="ltx_text" style="font-size:90%;">, pages 681–688. Citeseer, 2011.
</span>
</span>
</li>
<li id="bib.bib73" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[73]</span>
<span class="ltx_bibblock"><span id="bib.bib73.1.1" class="ltx_text" style="font-size:90%;">
Spencer Whitehead, Hui Wu, Heng Ji, Rogerio Feris, and Kate Saenko.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib73.2.1" class="ltx_text" style="font-size:90%;">Separating skills and concepts for novel visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib73.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib73.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib73.5.3" class="ltx_text" style="font-size:90%;">, pages 5632–5641, 2021.
</span>
</span>
</li>
<li id="bib.bib74" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[74]</span>
<span class="ltx_bibblock"><span id="bib.bib74.1.1" class="ltx_text" style="font-size:90%;">
Qi Wu, Damien Teney, Peng Wang, Chunhua Shen, Anthony Dick, and Anton van den
Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib74.2.1" class="ltx_text" style="font-size:90%;">Visual question answering: A survey of methods and datasets.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib74.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision and Image Understanding</span><span id="bib.bib74.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib75" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[75]</span>
<span class="ltx_bibblock"><span id="bib.bib75.1.1" class="ltx_text" style="font-size:90%;">
Zhirong Wu, Yuanjun Xiong, Stella X Yu, and Dahua Lin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib75.2.1" class="ltx_text" style="font-size:90%;">Unsupervised feature learning via non-parametric instance
discrimination.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib75.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib75.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib75.5.3" class="ltx_text" style="font-size:90%;">, pages 3733–3742, 2018.
</span>
</span>
</li>
<li id="bib.bib76" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[76]</span>
<span class="ltx_bibblock"><span id="bib.bib76.1.1" class="ltx_text" style="font-size:90%;">
Zhisheng Xiao, Karsten Kreis, Jan Kautz, and Arash Vahdat.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib76.2.1" class="ltx_text" style="font-size:90%;">Vaebm: A symbiosis between variational autoencoders and energy-based
models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib76.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib76.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib76.5.3" class="ltx_text" style="font-size:90%;">,
2020.
</span>
</span>
</li>
<li id="bib.bib77" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[77]</span>
<span class="ltx_bibblock"><span id="bib.bib77.1.1" class="ltx_text" style="font-size:90%;">
Jianwen Xie, Yang Lu, Ruiqi Gao, and Ying Nian Wu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib77.2.1" class="ltx_text" style="font-size:90%;">Cooperative learning of energy-based model and latent variable model
via mcmc teaching.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib77.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib77.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the AAAI Conference on Artificial
Intelligence</span><span id="bib.bib77.5.3" class="ltx_text" style="font-size:90%;">, volume 32, 2018.
</span>
</span>
</li>
<li id="bib.bib78" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[78]</span>
<span class="ltx_bibblock"><span id="bib.bib78.1.1" class="ltx_text" style="font-size:90%;">
Haiyang Xu, Ming Yan, Chenliang Li, Bin Bi, Songfang Huang, Wenming Xiao, and
Fei Huang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib78.2.1" class="ltx_text" style="font-size:90%;">E2E-VLP: End-to-end vision-language pre-training enhanced by visual
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib78.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2106.01804</span><span id="bib.bib78.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib79" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[79]</span>
<span class="ltx_bibblock"><span id="bib.bib79.1.1" class="ltx_text" style="font-size:90%;">
Stephen Zhao, Jörn-Henrik Jacobsen, and Will Grathwohl.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib79.2.1" class="ltx_text" style="font-size:90%;">Joint energy-based models for semi-supervised classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib79.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib79.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML Workshop on Uncertainty and Robustness in Deep
Learning</span><span id="bib.bib79.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib80" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[80]</span>
<span class="ltx_bibblock"><span id="bib.bib80.1.1" class="ltx_text" style="font-size:90%;">
Chengxu Zhuang, Alex Lin Zhai, and Daniel Yamins.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib80.2.1" class="ltx_text" style="font-size:90%;">Local aggregation for unsupervised learning of visual embeddings.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib80.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib80.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib80.5.3" class="ltx_text" style="font-size:90%;">, pages 6002–6012, 2019.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="Ax1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">Appendices</h2>

</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Derivation of Equation <a href="#S3.E3" title="Equation 3 ‣ 3.2 Energy-based models ‣ 3 Background ‣ EBMs vs. CL: Exploring Self-Supervised Visual Pretraining for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>
</h2>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.1" class="ltx_p">The log of the EBM objective is:</p>
<table id="A1.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E14.m1.3" class="ltx_math_unparsed" alttext="\log(p_{{\boldsymbol{\theta}}}({\boldsymbol{x}}))=E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))-\log(Z({\boldsymbol{\theta}}))\,," display="block"><semantics id="A1.E14.m1.3a"><mrow id="A1.E14.m1.3b"><mi id="A1.E14.m1.2.2">log</mi><mrow id="A1.E14.m1.3.4"><mo stretchy="false" id="A1.E14.m1.3.4.1">(</mo><msub id="A1.E14.m1.3.4.2"><mi id="A1.E14.m1.3.4.2.2">p</mi><mi id="A1.E14.m1.3.4.2.3">𝜽</mi></msub><mrow id="A1.E14.m1.3.4.3"><mo stretchy="false" id="A1.E14.m1.3.4.3.1">(</mo><mi id="A1.E14.m1.1.1">𝒙</mi><mo stretchy="false" id="A1.E14.m1.3.4.3.2">)</mo></mrow><mo stretchy="false" id="A1.E14.m1.3.4.4">)</mo></mrow><mo id="A1.E14.m1.3.5">=</mo><msub id="A1.E14.m1.3.6"><mi id="A1.E14.m1.3.6.2">E</mi><mi id="A1.E14.m1.3.6.3">𝜽</mi></msub><mrow id="A1.E14.m1.3.7"><mo stretchy="false" id="A1.E14.m1.3.7.1">(</mo><msub id="A1.E14.m1.3.7.2"><mi id="A1.E14.m1.3.7.2.2">f</mi><mi id="A1.E14.m1.3.7.2.3">𝜽</mi></msub><mrow id="A1.E14.m1.3.7.3"><mo stretchy="false" id="A1.E14.m1.3.7.3.1">(</mo><mi id="A1.E14.m1.3.3">𝒙</mi><mo stretchy="false" id="A1.E14.m1.3.7.3.2">)</mo></mrow><mo stretchy="false" id="A1.E14.m1.3.7.4">)</mo></mrow><mo stretchy="false" id="A1.E14.m1.3.8">)</mo><mo id="A1.E14.m1.3.9">−</mo><mi id="A1.E14.m1.3.10">log</mi><mo stretchy="false" id="A1.E14.m1.3.11">(</mo><mi id="A1.E14.m1.3.12">Z</mi><mrow id="A1.E14.m1.3.13"><mo stretchy="false" id="A1.E14.m1.3.13.1">(</mo><mi id="A1.E14.m1.3.13.2">𝜽</mi><mo stretchy="false" id="A1.E14.m1.3.13.3">)</mo></mrow><mo rspace="0.170em" stretchy="false" id="A1.E14.m1.3.14">)</mo><mo id="A1.E14.m1.3.15">,</mo></mrow><annotation encoding="application/x-tex" id="A1.E14.m1.3c">\log(p_{{\boldsymbol{\theta}}}({\boldsymbol{x}}))=E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))-\log(Z({\boldsymbol{\theta}}))\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="A1.p1.2" class="ltx_p">and the gradient of the normalizer is:</p>
<table id="A1.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.Ex5.m1.3" class="ltx_Math" alttext="\displaystyle\frac{\partial}{\partial{\boldsymbol{\theta}}}\log\left(Z({\boldsymbol{\theta}})\right)" display="inline"><semantics id="A1.Ex5.m1.3a"><mrow id="A1.Ex5.m1.3.3" xref="A1.Ex5.m1.3.3.cmml"><mstyle displaystyle="true" id="A1.Ex5.m1.3.3.3" xref="A1.Ex5.m1.3.3.3.cmml"><mfrac id="A1.Ex5.m1.3.3.3a" xref="A1.Ex5.m1.3.3.3.cmml"><mo id="A1.Ex5.m1.3.3.3.2" xref="A1.Ex5.m1.3.3.3.2.cmml">∂</mo><mrow id="A1.Ex5.m1.3.3.3.3" xref="A1.Ex5.m1.3.3.3.3.cmml"><mo rspace="0em" id="A1.Ex5.m1.3.3.3.3.1" xref="A1.Ex5.m1.3.3.3.3.1.cmml">∂</mo><mi id="A1.Ex5.m1.3.3.3.3.2" xref="A1.Ex5.m1.3.3.3.3.2.cmml">𝜽</mi></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="A1.Ex5.m1.3.3.2" xref="A1.Ex5.m1.3.3.2.cmml">​</mo><mrow id="A1.Ex5.m1.3.3.1.1" xref="A1.Ex5.m1.3.3.1.2.cmml"><mi id="A1.Ex5.m1.2.2" xref="A1.Ex5.m1.2.2.cmml">log</mi><mo id="A1.Ex5.m1.3.3.1.1a" xref="A1.Ex5.m1.3.3.1.2.cmml">⁡</mo><mrow id="A1.Ex5.m1.3.3.1.1.1" xref="A1.Ex5.m1.3.3.1.2.cmml"><mo id="A1.Ex5.m1.3.3.1.1.1.2" xref="A1.Ex5.m1.3.3.1.2.cmml">(</mo><mrow id="A1.Ex5.m1.3.3.1.1.1.1" xref="A1.Ex5.m1.3.3.1.1.1.1.cmml"><mi id="A1.Ex5.m1.3.3.1.1.1.1.2" xref="A1.Ex5.m1.3.3.1.1.1.1.2.cmml">Z</mi><mo lspace="0em" rspace="0em" id="A1.Ex5.m1.3.3.1.1.1.1.1" xref="A1.Ex5.m1.3.3.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex5.m1.3.3.1.1.1.1.3.2" xref="A1.Ex5.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex5.m1.3.3.1.1.1.1.3.2.1" xref="A1.Ex5.m1.3.3.1.1.1.1.cmml">(</mo><mi id="A1.Ex5.m1.1.1" xref="A1.Ex5.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="A1.Ex5.m1.3.3.1.1.1.1.3.2.2" xref="A1.Ex5.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex5.m1.3.3.1.1.1.3" xref="A1.Ex5.m1.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex5.m1.3b"><apply id="A1.Ex5.m1.3.3.cmml" xref="A1.Ex5.m1.3.3"><times id="A1.Ex5.m1.3.3.2.cmml" xref="A1.Ex5.m1.3.3.2"></times><apply id="A1.Ex5.m1.3.3.3.cmml" xref="A1.Ex5.m1.3.3.3"><divide id="A1.Ex5.m1.3.3.3.1.cmml" xref="A1.Ex5.m1.3.3.3"></divide><partialdiff id="A1.Ex5.m1.3.3.3.2.cmml" xref="A1.Ex5.m1.3.3.3.2"></partialdiff><apply id="A1.Ex5.m1.3.3.3.3.cmml" xref="A1.Ex5.m1.3.3.3.3"><partialdiff id="A1.Ex5.m1.3.3.3.3.1.cmml" xref="A1.Ex5.m1.3.3.3.3.1"></partialdiff><ci id="A1.Ex5.m1.3.3.3.3.2.cmml" xref="A1.Ex5.m1.3.3.3.3.2">𝜽</ci></apply></apply><apply id="A1.Ex5.m1.3.3.1.2.cmml" xref="A1.Ex5.m1.3.3.1.1"><log id="A1.Ex5.m1.2.2.cmml" xref="A1.Ex5.m1.2.2"></log><apply id="A1.Ex5.m1.3.3.1.1.1.1.cmml" xref="A1.Ex5.m1.3.3.1.1.1.1"><times id="A1.Ex5.m1.3.3.1.1.1.1.1.cmml" xref="A1.Ex5.m1.3.3.1.1.1.1.1"></times><ci id="A1.Ex5.m1.3.3.1.1.1.1.2.cmml" xref="A1.Ex5.m1.3.3.1.1.1.1.2">𝑍</ci><ci id="A1.Ex5.m1.1.1.cmml" xref="A1.Ex5.m1.1.1">𝜽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex5.m1.3c">\displaystyle\frac{\partial}{\partial{\boldsymbol{\theta}}}\log\left(Z({\boldsymbol{\theta}})\right)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.Ex5.m2.4" class="ltx_Math" alttext="\displaystyle=\frac{\partial}{\partial{\boldsymbol{\theta}}}\log\left(\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}\right)" display="inline"><semantics id="A1.Ex5.m2.4a"><mrow id="A1.Ex5.m2.4.4" xref="A1.Ex5.m2.4.4.cmml"><mi id="A1.Ex5.m2.4.4.3" xref="A1.Ex5.m2.4.4.3.cmml"></mi><mo id="A1.Ex5.m2.4.4.2" xref="A1.Ex5.m2.4.4.2.cmml">=</mo><mrow id="A1.Ex5.m2.4.4.1" xref="A1.Ex5.m2.4.4.1.cmml"><mstyle displaystyle="true" id="A1.Ex5.m2.4.4.1.3" xref="A1.Ex5.m2.4.4.1.3.cmml"><mfrac id="A1.Ex5.m2.4.4.1.3a" xref="A1.Ex5.m2.4.4.1.3.cmml"><mo id="A1.Ex5.m2.4.4.1.3.2" xref="A1.Ex5.m2.4.4.1.3.2.cmml">∂</mo><mrow id="A1.Ex5.m2.4.4.1.3.3" xref="A1.Ex5.m2.4.4.1.3.3.cmml"><mo rspace="0em" id="A1.Ex5.m2.4.4.1.3.3.1" xref="A1.Ex5.m2.4.4.1.3.3.1.cmml">∂</mo><mi id="A1.Ex5.m2.4.4.1.3.3.2" xref="A1.Ex5.m2.4.4.1.3.3.2.cmml">𝜽</mi></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="A1.Ex5.m2.4.4.1.2" xref="A1.Ex5.m2.4.4.1.2.cmml">​</mo><mrow id="A1.Ex5.m2.4.4.1.1.1" xref="A1.Ex5.m2.4.4.1.1.2.cmml"><mi id="A1.Ex5.m2.3.3" xref="A1.Ex5.m2.3.3.cmml">log</mi><mo id="A1.Ex5.m2.4.4.1.1.1a" xref="A1.Ex5.m2.4.4.1.1.2.cmml">⁡</mo><mrow id="A1.Ex5.m2.4.4.1.1.1.1" xref="A1.Ex5.m2.4.4.1.1.2.cmml"><mo id="A1.Ex5.m2.4.4.1.1.1.1.2" xref="A1.Ex5.m2.4.4.1.1.2.cmml">(</mo><mstyle displaystyle="true" id="A1.Ex5.m2.4.4.1.1.1.1.1" xref="A1.Ex5.m2.4.4.1.1.1.1.1.cmml"><mrow id="A1.Ex5.m2.4.4.1.1.1.1.1a" xref="A1.Ex5.m2.4.4.1.1.1.1.1.cmml"><mo id="A1.Ex5.m2.4.4.1.1.1.1.1.2" xref="A1.Ex5.m2.4.4.1.1.1.1.1.2.cmml">∫</mo><mrow id="A1.Ex5.m2.4.4.1.1.1.1.1.1" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.cmml"><mrow id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex5.m2.2.2" xref="A1.Ex5.m2.2.2.cmml">exp</mi><mo id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1a" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex5.m2.1.1" xref="A1.Ex5.m2.1.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.2" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.Ex5.m2.4.4.1.1.1.1.1.1.3" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.3.cmml"><mo rspace="0em" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.3.1" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.3.1.cmml">𝑑</mo><mi id="A1.Ex5.m2.4.4.1.1.1.1.1.1.3.2" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.3.2.cmml">𝒙</mi></mrow></mrow></mrow></mstyle><mo id="A1.Ex5.m2.4.4.1.1.1.1.3" xref="A1.Ex5.m2.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex5.m2.4b"><apply id="A1.Ex5.m2.4.4.cmml" xref="A1.Ex5.m2.4.4"><eq id="A1.Ex5.m2.4.4.2.cmml" xref="A1.Ex5.m2.4.4.2"></eq><csymbol cd="latexml" id="A1.Ex5.m2.4.4.3.cmml" xref="A1.Ex5.m2.4.4.3">absent</csymbol><apply id="A1.Ex5.m2.4.4.1.cmml" xref="A1.Ex5.m2.4.4.1"><times id="A1.Ex5.m2.4.4.1.2.cmml" xref="A1.Ex5.m2.4.4.1.2"></times><apply id="A1.Ex5.m2.4.4.1.3.cmml" xref="A1.Ex5.m2.4.4.1.3"><divide id="A1.Ex5.m2.4.4.1.3.1.cmml" xref="A1.Ex5.m2.4.4.1.3"></divide><partialdiff id="A1.Ex5.m2.4.4.1.3.2.cmml" xref="A1.Ex5.m2.4.4.1.3.2"></partialdiff><apply id="A1.Ex5.m2.4.4.1.3.3.cmml" xref="A1.Ex5.m2.4.4.1.3.3"><partialdiff id="A1.Ex5.m2.4.4.1.3.3.1.cmml" xref="A1.Ex5.m2.4.4.1.3.3.1"></partialdiff><ci id="A1.Ex5.m2.4.4.1.3.3.2.cmml" xref="A1.Ex5.m2.4.4.1.3.3.2">𝜽</ci></apply></apply><apply id="A1.Ex5.m2.4.4.1.1.2.cmml" xref="A1.Ex5.m2.4.4.1.1.1"><log id="A1.Ex5.m2.3.3.cmml" xref="A1.Ex5.m2.3.3"></log><apply id="A1.Ex5.m2.4.4.1.1.1.1.1.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1"><int id="A1.Ex5.m2.4.4.1.1.1.1.1.2.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.2"></int><apply id="A1.Ex5.m2.4.4.1.1.1.1.1.1.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1"><times id="A1.Ex5.m2.4.4.1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.2"></times><apply id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1"><exp id="A1.Ex5.m2.2.2.cmml" xref="A1.Ex5.m2.2.2"></exp><apply id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1"><times id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.2">𝐸</ci><ci id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.3.3">𝜽</ci></apply><apply id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1"><times id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex5.m2.1.1.cmml" xref="A1.Ex5.m2.1.1">𝒙</ci></apply></apply></apply><apply id="A1.Ex5.m2.4.4.1.1.1.1.1.1.3.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.Ex5.m2.4.4.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.3.1">differential-d</csymbol><ci id="A1.Ex5.m2.4.4.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex5.m2.4.4.1.1.1.1.1.1.3.2">𝒙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex5.m2.4c">\displaystyle=\frac{\partial}{\partial{\boldsymbol{\theta}}}\log\left(\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.Ex6.m1.4" class="ltx_Math" alttext="\displaystyle=\frac{\partial}{\partial{\boldsymbol{\theta}}}\log\left(\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}\right)" display="inline"><semantics id="A1.Ex6.m1.4a"><mrow id="A1.Ex6.m1.4.4" xref="A1.Ex6.m1.4.4.cmml"><mi id="A1.Ex6.m1.4.4.3" xref="A1.Ex6.m1.4.4.3.cmml"></mi><mo id="A1.Ex6.m1.4.4.2" xref="A1.Ex6.m1.4.4.2.cmml">=</mo><mrow id="A1.Ex6.m1.4.4.1" xref="A1.Ex6.m1.4.4.1.cmml"><mstyle displaystyle="true" id="A1.Ex6.m1.4.4.1.3" xref="A1.Ex6.m1.4.4.1.3.cmml"><mfrac id="A1.Ex6.m1.4.4.1.3a" xref="A1.Ex6.m1.4.4.1.3.cmml"><mo id="A1.Ex6.m1.4.4.1.3.2" xref="A1.Ex6.m1.4.4.1.3.2.cmml">∂</mo><mrow id="A1.Ex6.m1.4.4.1.3.3" xref="A1.Ex6.m1.4.4.1.3.3.cmml"><mo rspace="0em" id="A1.Ex6.m1.4.4.1.3.3.1" xref="A1.Ex6.m1.4.4.1.3.3.1.cmml">∂</mo><mi id="A1.Ex6.m1.4.4.1.3.3.2" xref="A1.Ex6.m1.4.4.1.3.3.2.cmml">𝜽</mi></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="A1.Ex6.m1.4.4.1.2" xref="A1.Ex6.m1.4.4.1.2.cmml">​</mo><mrow id="A1.Ex6.m1.4.4.1.1.1" xref="A1.Ex6.m1.4.4.1.1.2.cmml"><mi id="A1.Ex6.m1.3.3" xref="A1.Ex6.m1.3.3.cmml">log</mi><mo id="A1.Ex6.m1.4.4.1.1.1a" xref="A1.Ex6.m1.4.4.1.1.2.cmml">⁡</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.2.cmml"><mo id="A1.Ex6.m1.4.4.1.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.2.cmml">(</mo><mstyle displaystyle="true" id="A1.Ex6.m1.4.4.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.cmml"><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1a" xref="A1.Ex6.m1.4.4.1.1.1.1.1.cmml"><mo id="A1.Ex6.m1.4.4.1.1.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.2.cmml">∫</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex6.m1.2.2" xref="A1.Ex6.m1.2.2.cmml">exp</mi><mo id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1a" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex6.m1.1.1" xref="A1.Ex6.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.Ex6.m1.4.4.1.1.1.1.1.1.3" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.3.cmml"><mo rspace="0em" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.3.1" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.3.1.cmml">𝑑</mo><mi id="A1.Ex6.m1.4.4.1.1.1.1.1.1.3.2" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.3.2.cmml">𝒙</mi></mrow></mrow></mrow></mstyle><mo id="A1.Ex6.m1.4.4.1.1.1.1.3" xref="A1.Ex6.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex6.m1.4b"><apply id="A1.Ex6.m1.4.4.cmml" xref="A1.Ex6.m1.4.4"><eq id="A1.Ex6.m1.4.4.2.cmml" xref="A1.Ex6.m1.4.4.2"></eq><csymbol cd="latexml" id="A1.Ex6.m1.4.4.3.cmml" xref="A1.Ex6.m1.4.4.3">absent</csymbol><apply id="A1.Ex6.m1.4.4.1.cmml" xref="A1.Ex6.m1.4.4.1"><times id="A1.Ex6.m1.4.4.1.2.cmml" xref="A1.Ex6.m1.4.4.1.2"></times><apply id="A1.Ex6.m1.4.4.1.3.cmml" xref="A1.Ex6.m1.4.4.1.3"><divide id="A1.Ex6.m1.4.4.1.3.1.cmml" xref="A1.Ex6.m1.4.4.1.3"></divide><partialdiff id="A1.Ex6.m1.4.4.1.3.2.cmml" xref="A1.Ex6.m1.4.4.1.3.2"></partialdiff><apply id="A1.Ex6.m1.4.4.1.3.3.cmml" xref="A1.Ex6.m1.4.4.1.3.3"><partialdiff id="A1.Ex6.m1.4.4.1.3.3.1.cmml" xref="A1.Ex6.m1.4.4.1.3.3.1"></partialdiff><ci id="A1.Ex6.m1.4.4.1.3.3.2.cmml" xref="A1.Ex6.m1.4.4.1.3.3.2">𝜽</ci></apply></apply><apply id="A1.Ex6.m1.4.4.1.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1"><log id="A1.Ex6.m1.3.3.cmml" xref="A1.Ex6.m1.3.3"></log><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1"><int id="A1.Ex6.m1.4.4.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.2"></int><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1"><times id="A1.Ex6.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.2"></times><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1"><exp id="A1.Ex6.m1.2.2.cmml" xref="A1.Ex6.m1.2.2"></exp><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1"><times id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2">𝐸</ci><ci id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3">𝜽</ci></apply><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"><times id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex6.m1.1.1.cmml" xref="A1.Ex6.m1.1.1">𝒙</ci></apply></apply></apply><apply id="A1.Ex6.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="latexml" id="A1.Ex6.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.3.1">differential-d</csymbol><ci id="A1.Ex6.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex6.m1.4.4.1.1.1.1.1.1.3.2">𝒙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex6.m1.4c">\displaystyle=\frac{\partial}{\partial{\boldsymbol{\theta}}}\log\left(\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.Ex7.m1.6" class="ltx_Math" alttext="\displaystyle=\frac{\frac{\partial}{\partial{\boldsymbol{\theta}}}\left(\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}\right)}{\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}}" display="inline"><semantics id="A1.Ex7.m1.6a"><mrow id="A1.Ex7.m1.6.7" xref="A1.Ex7.m1.6.7.cmml"><mi id="A1.Ex7.m1.6.7.2" xref="A1.Ex7.m1.6.7.2.cmml"></mi><mo id="A1.Ex7.m1.6.7.1" xref="A1.Ex7.m1.6.7.1.cmml">=</mo><mstyle displaystyle="true" id="A1.Ex7.m1.6.6" xref="A1.Ex7.m1.6.6.cmml"><mfrac id="A1.Ex7.m1.6.6a" xref="A1.Ex7.m1.6.6.cmml"><mrow id="A1.Ex7.m1.3.3.3" xref="A1.Ex7.m1.3.3.3.cmml"><mfrac id="A1.Ex7.m1.3.3.3.5" xref="A1.Ex7.m1.3.3.3.5.cmml"><mo id="A1.Ex7.m1.3.3.3.5.2" xref="A1.Ex7.m1.3.3.3.5.2.cmml">∂</mo><mrow id="A1.Ex7.m1.3.3.3.5.3" xref="A1.Ex7.m1.3.3.3.5.3.cmml"><mo rspace="0em" id="A1.Ex7.m1.3.3.3.5.3.1" xref="A1.Ex7.m1.3.3.3.5.3.1.cmml">∂</mo><mi id="A1.Ex7.m1.3.3.3.5.3.2" xref="A1.Ex7.m1.3.3.3.5.3.2.cmml">𝜽</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="A1.Ex7.m1.3.3.3.4" xref="A1.Ex7.m1.3.3.3.4.cmml">​</mo><mrow id="A1.Ex7.m1.3.3.3.3.1" xref="A1.Ex7.m1.3.3.3.3.1.1.cmml"><mo id="A1.Ex7.m1.3.3.3.3.1.2" xref="A1.Ex7.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="A1.Ex7.m1.3.3.3.3.1.1" xref="A1.Ex7.m1.3.3.3.3.1.1.cmml"><mo lspace="0em" id="A1.Ex7.m1.3.3.3.3.1.1.2" xref="A1.Ex7.m1.3.3.3.3.1.1.2.cmml">∫</mo><mrow id="A1.Ex7.m1.3.3.3.3.1.1.1" xref="A1.Ex7.m1.3.3.3.3.1.1.1.cmml"><mrow id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.cmml"><mi id="A1.Ex7.m1.2.2.2.2" xref="A1.Ex7.m1.2.2.2.2.cmml">exp</mi><mo id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1a" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.cmml">⁡</mo><mrow id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.2" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.cmml">(</mo><mrow id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3.2" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3.3" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.2" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex7.m1.1.1.1.1" xref="A1.Ex7.m1.1.1.1.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.3" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="A1.Ex7.m1.3.3.3.3.1.1.1.2" xref="A1.Ex7.m1.3.3.3.3.1.1.1.2.cmml">​</mo><mrow id="A1.Ex7.m1.3.3.3.3.1.1.1.3" xref="A1.Ex7.m1.3.3.3.3.1.1.1.3.cmml"><mo rspace="0em" id="A1.Ex7.m1.3.3.3.3.1.1.1.3.1" xref="A1.Ex7.m1.3.3.3.3.1.1.1.3.1.cmml">𝑑</mo><mi id="A1.Ex7.m1.3.3.3.3.1.1.1.3.2" xref="A1.Ex7.m1.3.3.3.3.1.1.1.3.2.cmml">𝒙</mi></mrow></mrow></mrow><mo id="A1.Ex7.m1.3.3.3.3.1.3" xref="A1.Ex7.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex7.m1.6.6.6" xref="A1.Ex7.m1.6.6.6.cmml"><mo id="A1.Ex7.m1.6.6.6.4" xref="A1.Ex7.m1.6.6.6.4.cmml">∫</mo><mrow id="A1.Ex7.m1.6.6.6.3" xref="A1.Ex7.m1.6.6.6.3.cmml"><mrow id="A1.Ex7.m1.6.6.6.3.1.1" xref="A1.Ex7.m1.6.6.6.3.1.2.cmml"><mi id="A1.Ex7.m1.5.5.5.2" xref="A1.Ex7.m1.5.5.5.2.cmml">exp</mi><mo id="A1.Ex7.m1.6.6.6.3.1.1a" xref="A1.Ex7.m1.6.6.6.3.1.2.cmml">⁡</mo><mrow id="A1.Ex7.m1.6.6.6.3.1.1.1" xref="A1.Ex7.m1.6.6.6.3.1.2.cmml"><mo stretchy="false" id="A1.Ex7.m1.6.6.6.3.1.1.1.2" xref="A1.Ex7.m1.6.6.6.3.1.2.cmml">(</mo><mrow id="A1.Ex7.m1.6.6.6.3.1.1.1.1" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.cmml"><msub id="A1.Ex7.m1.6.6.6.3.1.1.1.1.3" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.3.cmml"><mi id="A1.Ex7.m1.6.6.6.3.1.1.1.1.3.2" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.3.2.cmml">E</mi><mi id="A1.Ex7.m1.6.6.6.3.1.1.1.1.3.3" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex7.m1.6.6.6.3.1.1.1.1.2" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.2.cmml">​</mo><mrow id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.2" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2.2" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2.3" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.1" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.3.2" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.1" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex7.m1.4.4.4.1" xref="A1.Ex7.m1.4.4.4.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.3" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex7.m1.6.6.6.3.1.1.1.3" xref="A1.Ex7.m1.6.6.6.3.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="A1.Ex7.m1.6.6.6.3.2" xref="A1.Ex7.m1.6.6.6.3.2.cmml">​</mo><mrow id="A1.Ex7.m1.6.6.6.3.3" xref="A1.Ex7.m1.6.6.6.3.3.cmml"><mo rspace="0em" id="A1.Ex7.m1.6.6.6.3.3.1" xref="A1.Ex7.m1.6.6.6.3.3.1.cmml">𝑑</mo><mi id="A1.Ex7.m1.6.6.6.3.3.2" xref="A1.Ex7.m1.6.6.6.3.3.2.cmml">𝒙</mi></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex7.m1.6b"><apply id="A1.Ex7.m1.6.7.cmml" xref="A1.Ex7.m1.6.7"><eq id="A1.Ex7.m1.6.7.1.cmml" xref="A1.Ex7.m1.6.7.1"></eq><csymbol cd="latexml" id="A1.Ex7.m1.6.7.2.cmml" xref="A1.Ex7.m1.6.7.2">absent</csymbol><apply id="A1.Ex7.m1.6.6.cmml" xref="A1.Ex7.m1.6.6"><divide id="A1.Ex7.m1.6.6.7.cmml" xref="A1.Ex7.m1.6.6"></divide><apply id="A1.Ex7.m1.3.3.3.cmml" xref="A1.Ex7.m1.3.3.3"><times id="A1.Ex7.m1.3.3.3.4.cmml" xref="A1.Ex7.m1.3.3.3.4"></times><apply id="A1.Ex7.m1.3.3.3.5.cmml" xref="A1.Ex7.m1.3.3.3.5"><divide id="A1.Ex7.m1.3.3.3.5.1.cmml" xref="A1.Ex7.m1.3.3.3.5"></divide><partialdiff id="A1.Ex7.m1.3.3.3.5.2.cmml" xref="A1.Ex7.m1.3.3.3.5.2"></partialdiff><apply id="A1.Ex7.m1.3.3.3.5.3.cmml" xref="A1.Ex7.m1.3.3.3.5.3"><partialdiff id="A1.Ex7.m1.3.3.3.5.3.1.cmml" xref="A1.Ex7.m1.3.3.3.5.3.1"></partialdiff><ci id="A1.Ex7.m1.3.3.3.5.3.2.cmml" xref="A1.Ex7.m1.3.3.3.5.3.2">𝜽</ci></apply></apply><apply id="A1.Ex7.m1.3.3.3.3.1.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1"><int id="A1.Ex7.m1.3.3.3.3.1.1.2.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.2"></int><apply id="A1.Ex7.m1.3.3.3.3.1.1.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1"><times id="A1.Ex7.m1.3.3.3.3.1.1.1.2.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.2"></times><apply id="A1.Ex7.m1.3.3.3.3.1.1.1.1.2.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1"><exp id="A1.Ex7.m1.2.2.2.2.cmml" xref="A1.Ex7.m1.2.2.2.2"></exp><apply id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1"><times id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.2"></times><apply id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3.2">𝐸</ci><ci id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.3.3">𝜽</ci></apply><apply id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1"><times id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex7.m1.1.1.1.1.cmml" xref="A1.Ex7.m1.1.1.1.1">𝒙</ci></apply></apply></apply><apply id="A1.Ex7.m1.3.3.3.3.1.1.1.3.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.3"><csymbol cd="latexml" id="A1.Ex7.m1.3.3.3.3.1.1.1.3.1.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.3.1">differential-d</csymbol><ci id="A1.Ex7.m1.3.3.3.3.1.1.1.3.2.cmml" xref="A1.Ex7.m1.3.3.3.3.1.1.1.3.2">𝒙</ci></apply></apply></apply></apply><apply id="A1.Ex7.m1.6.6.6.cmml" xref="A1.Ex7.m1.6.6.6"><int id="A1.Ex7.m1.6.6.6.4.cmml" xref="A1.Ex7.m1.6.6.6.4"></int><apply id="A1.Ex7.m1.6.6.6.3.cmml" xref="A1.Ex7.m1.6.6.6.3"><times id="A1.Ex7.m1.6.6.6.3.2.cmml" xref="A1.Ex7.m1.6.6.6.3.2"></times><apply id="A1.Ex7.m1.6.6.6.3.1.2.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1"><exp id="A1.Ex7.m1.5.5.5.2.cmml" xref="A1.Ex7.m1.5.5.5.2"></exp><apply id="A1.Ex7.m1.6.6.6.3.1.1.1.1.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1"><times id="A1.Ex7.m1.6.6.6.3.1.1.1.1.2.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.2"></times><apply id="A1.Ex7.m1.6.6.6.3.1.1.1.1.3.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex7.m1.6.6.6.3.1.1.1.1.3.1.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex7.m1.6.6.6.3.1.1.1.1.3.2.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.3.2">𝐸</ci><ci id="A1.Ex7.m1.6.6.6.3.1.1.1.1.3.3.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.3.3">𝜽</ci></apply><apply id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1"><times id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex7.m1.6.6.6.3.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex7.m1.4.4.4.1.cmml" xref="A1.Ex7.m1.4.4.4.1">𝒙</ci></apply></apply></apply><apply id="A1.Ex7.m1.6.6.6.3.3.cmml" xref="A1.Ex7.m1.6.6.6.3.3"><csymbol cd="latexml" id="A1.Ex7.m1.6.6.6.3.3.1.cmml" xref="A1.Ex7.m1.6.6.6.3.3.1">differential-d</csymbol><ci id="A1.Ex7.m1.6.6.6.3.3.2.cmml" xref="A1.Ex7.m1.6.6.6.3.3.2">𝒙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex7.m1.6c">\displaystyle=\frac{\frac{\partial}{\partial{\boldsymbol{\theta}}}\left(\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}\right)}{\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.Ex8.m1.6" class="ltx_Math" alttext="\displaystyle=\frac{\int\frac{\partial}{\partial{\boldsymbol{\theta}}}\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}}{\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}}" display="inline"><semantics id="A1.Ex8.m1.6a"><mrow id="A1.Ex8.m1.6.7" xref="A1.Ex8.m1.6.7.cmml"><mi id="A1.Ex8.m1.6.7.2" xref="A1.Ex8.m1.6.7.2.cmml"></mi><mo id="A1.Ex8.m1.6.7.1" xref="A1.Ex8.m1.6.7.1.cmml">=</mo><mstyle displaystyle="true" id="A1.Ex8.m1.6.6" xref="A1.Ex8.m1.6.6.cmml"><mfrac id="A1.Ex8.m1.6.6a" xref="A1.Ex8.m1.6.6.cmml"><mrow id="A1.Ex8.m1.3.3.3" xref="A1.Ex8.m1.3.3.3.cmml"><mo id="A1.Ex8.m1.3.3.3.4" xref="A1.Ex8.m1.3.3.3.4.cmml">∫</mo><mrow id="A1.Ex8.m1.3.3.3.3" xref="A1.Ex8.m1.3.3.3.3.cmml"><mfrac id="A1.Ex8.m1.3.3.3.3.3" xref="A1.Ex8.m1.3.3.3.3.3.cmml"><mo id="A1.Ex8.m1.3.3.3.3.3.2" xref="A1.Ex8.m1.3.3.3.3.3.2.cmml">∂</mo><mrow id="A1.Ex8.m1.3.3.3.3.3.3" xref="A1.Ex8.m1.3.3.3.3.3.3.cmml"><mo rspace="0em" id="A1.Ex8.m1.3.3.3.3.3.3.1" xref="A1.Ex8.m1.3.3.3.3.3.3.1.cmml">∂</mo><mi id="A1.Ex8.m1.3.3.3.3.3.3.2" xref="A1.Ex8.m1.3.3.3.3.3.3.2.cmml">𝜽</mi></mrow></mfrac><mo lspace="0.167em" rspace="0em" id="A1.Ex8.m1.3.3.3.3.2" xref="A1.Ex8.m1.3.3.3.3.2.cmml">​</mo><mrow id="A1.Ex8.m1.3.3.3.3.1.1" xref="A1.Ex8.m1.3.3.3.3.1.2.cmml"><mi id="A1.Ex8.m1.2.2.2.2" xref="A1.Ex8.m1.2.2.2.2.cmml">exp</mi><mo id="A1.Ex8.m1.3.3.3.3.1.1a" xref="A1.Ex8.m1.3.3.3.3.1.2.cmml">⁡</mo><mrow id="A1.Ex8.m1.3.3.3.3.1.1.1" xref="A1.Ex8.m1.3.3.3.3.1.2.cmml"><mo stretchy="false" id="A1.Ex8.m1.3.3.3.3.1.1.1.2" xref="A1.Ex8.m1.3.3.3.3.1.2.cmml">(</mo><mrow id="A1.Ex8.m1.3.3.3.3.1.1.1.1" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.cmml"><msub id="A1.Ex8.m1.3.3.3.3.1.1.1.1.3" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.3.cmml"><mi id="A1.Ex8.m1.3.3.3.3.1.1.1.1.3.2" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.3.2.cmml">E</mi><mi id="A1.Ex8.m1.3.3.3.3.1.1.1.1.3.3" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex8.m1.3.3.3.3.1.1.1.1.2" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.2.cmml">​</mo><mrow id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.2" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2.2" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2.3" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.1" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.3.2" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.3.2.1" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex8.m1.1.1.1.1" xref="A1.Ex8.m1.1.1.1.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.3" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex8.m1.3.3.3.3.1.1.1.3" xref="A1.Ex8.m1.3.3.3.3.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="A1.Ex8.m1.3.3.3.3.2a" xref="A1.Ex8.m1.3.3.3.3.2.cmml">​</mo><mrow id="A1.Ex8.m1.3.3.3.3.4" xref="A1.Ex8.m1.3.3.3.3.4.cmml"><mo rspace="0em" id="A1.Ex8.m1.3.3.3.3.4.1" xref="A1.Ex8.m1.3.3.3.3.4.1.cmml">𝑑</mo><mi id="A1.Ex8.m1.3.3.3.3.4.2" xref="A1.Ex8.m1.3.3.3.3.4.2.cmml">𝒙</mi></mrow></mrow></mrow><mrow id="A1.Ex8.m1.6.6.6" xref="A1.Ex8.m1.6.6.6.cmml"><mo id="A1.Ex8.m1.6.6.6.4" xref="A1.Ex8.m1.6.6.6.4.cmml">∫</mo><mrow id="A1.Ex8.m1.6.6.6.3" xref="A1.Ex8.m1.6.6.6.3.cmml"><mrow id="A1.Ex8.m1.6.6.6.3.1.1" xref="A1.Ex8.m1.6.6.6.3.1.2.cmml"><mi id="A1.Ex8.m1.5.5.5.2" xref="A1.Ex8.m1.5.5.5.2.cmml">exp</mi><mo id="A1.Ex8.m1.6.6.6.3.1.1a" xref="A1.Ex8.m1.6.6.6.3.1.2.cmml">⁡</mo><mrow id="A1.Ex8.m1.6.6.6.3.1.1.1" xref="A1.Ex8.m1.6.6.6.3.1.2.cmml"><mo stretchy="false" id="A1.Ex8.m1.6.6.6.3.1.1.1.2" xref="A1.Ex8.m1.6.6.6.3.1.2.cmml">(</mo><mrow id="A1.Ex8.m1.6.6.6.3.1.1.1.1" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.cmml"><msub id="A1.Ex8.m1.6.6.6.3.1.1.1.1.3" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.3.cmml"><mi id="A1.Ex8.m1.6.6.6.3.1.1.1.1.3.2" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.3.2.cmml">E</mi><mi id="A1.Ex8.m1.6.6.6.3.1.1.1.1.3.3" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex8.m1.6.6.6.3.1.1.1.1.2" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.2.cmml">​</mo><mrow id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.2" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2.2" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2.3" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.1" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.3.2" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.1" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex8.m1.4.4.4.1" xref="A1.Ex8.m1.4.4.4.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.3" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex8.m1.6.6.6.3.1.1.1.3" xref="A1.Ex8.m1.6.6.6.3.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="A1.Ex8.m1.6.6.6.3.2" xref="A1.Ex8.m1.6.6.6.3.2.cmml">​</mo><mrow id="A1.Ex8.m1.6.6.6.3.3" xref="A1.Ex8.m1.6.6.6.3.3.cmml"><mo rspace="0em" id="A1.Ex8.m1.6.6.6.3.3.1" xref="A1.Ex8.m1.6.6.6.3.3.1.cmml">𝑑</mo><mi id="A1.Ex8.m1.6.6.6.3.3.2" xref="A1.Ex8.m1.6.6.6.3.3.2.cmml">𝒙</mi></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex8.m1.6b"><apply id="A1.Ex8.m1.6.7.cmml" xref="A1.Ex8.m1.6.7"><eq id="A1.Ex8.m1.6.7.1.cmml" xref="A1.Ex8.m1.6.7.1"></eq><csymbol cd="latexml" id="A1.Ex8.m1.6.7.2.cmml" xref="A1.Ex8.m1.6.7.2">absent</csymbol><apply id="A1.Ex8.m1.6.6.cmml" xref="A1.Ex8.m1.6.6"><divide id="A1.Ex8.m1.6.6.7.cmml" xref="A1.Ex8.m1.6.6"></divide><apply id="A1.Ex8.m1.3.3.3.cmml" xref="A1.Ex8.m1.3.3.3"><int id="A1.Ex8.m1.3.3.3.4.cmml" xref="A1.Ex8.m1.3.3.3.4"></int><apply id="A1.Ex8.m1.3.3.3.3.cmml" xref="A1.Ex8.m1.3.3.3.3"><times id="A1.Ex8.m1.3.3.3.3.2.cmml" xref="A1.Ex8.m1.3.3.3.3.2"></times><apply id="A1.Ex8.m1.3.3.3.3.3.cmml" xref="A1.Ex8.m1.3.3.3.3.3"><divide id="A1.Ex8.m1.3.3.3.3.3.1.cmml" xref="A1.Ex8.m1.3.3.3.3.3"></divide><partialdiff id="A1.Ex8.m1.3.3.3.3.3.2.cmml" xref="A1.Ex8.m1.3.3.3.3.3.2"></partialdiff><apply id="A1.Ex8.m1.3.3.3.3.3.3.cmml" xref="A1.Ex8.m1.3.3.3.3.3.3"><partialdiff id="A1.Ex8.m1.3.3.3.3.3.3.1.cmml" xref="A1.Ex8.m1.3.3.3.3.3.3.1"></partialdiff><ci id="A1.Ex8.m1.3.3.3.3.3.3.2.cmml" xref="A1.Ex8.m1.3.3.3.3.3.3.2">𝜽</ci></apply></apply><apply id="A1.Ex8.m1.3.3.3.3.1.2.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1"><exp id="A1.Ex8.m1.2.2.2.2.cmml" xref="A1.Ex8.m1.2.2.2.2"></exp><apply id="A1.Ex8.m1.3.3.3.3.1.1.1.1.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1"><times id="A1.Ex8.m1.3.3.3.3.1.1.1.1.2.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.2"></times><apply id="A1.Ex8.m1.3.3.3.3.1.1.1.1.3.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.3.3.3.3.1.1.1.1.3.1.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex8.m1.3.3.3.3.1.1.1.1.3.2.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.3.2">𝐸</ci><ci id="A1.Ex8.m1.3.3.3.3.1.1.1.1.3.3.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.3.3">𝜽</ci></apply><apply id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1"><times id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex8.m1.3.3.3.3.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex8.m1.1.1.1.1.cmml" xref="A1.Ex8.m1.1.1.1.1">𝒙</ci></apply></apply></apply><apply id="A1.Ex8.m1.3.3.3.3.4.cmml" xref="A1.Ex8.m1.3.3.3.3.4"><csymbol cd="latexml" id="A1.Ex8.m1.3.3.3.3.4.1.cmml" xref="A1.Ex8.m1.3.3.3.3.4.1">differential-d</csymbol><ci id="A1.Ex8.m1.3.3.3.3.4.2.cmml" xref="A1.Ex8.m1.3.3.3.3.4.2">𝒙</ci></apply></apply></apply><apply id="A1.Ex8.m1.6.6.6.cmml" xref="A1.Ex8.m1.6.6.6"><int id="A1.Ex8.m1.6.6.6.4.cmml" xref="A1.Ex8.m1.6.6.6.4"></int><apply id="A1.Ex8.m1.6.6.6.3.cmml" xref="A1.Ex8.m1.6.6.6.3"><times id="A1.Ex8.m1.6.6.6.3.2.cmml" xref="A1.Ex8.m1.6.6.6.3.2"></times><apply id="A1.Ex8.m1.6.6.6.3.1.2.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1"><exp id="A1.Ex8.m1.5.5.5.2.cmml" xref="A1.Ex8.m1.5.5.5.2"></exp><apply id="A1.Ex8.m1.6.6.6.3.1.1.1.1.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1"><times id="A1.Ex8.m1.6.6.6.3.1.1.1.1.2.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.2"></times><apply id="A1.Ex8.m1.6.6.6.3.1.1.1.1.3.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.6.6.6.3.1.1.1.1.3.1.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex8.m1.6.6.6.3.1.1.1.1.3.2.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.3.2">𝐸</ci><ci id="A1.Ex8.m1.6.6.6.3.1.1.1.1.3.3.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.3.3">𝜽</ci></apply><apply id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1"><times id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex8.m1.6.6.6.3.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex8.m1.4.4.4.1.cmml" xref="A1.Ex8.m1.4.4.4.1">𝒙</ci></apply></apply></apply><apply id="A1.Ex8.m1.6.6.6.3.3.cmml" xref="A1.Ex8.m1.6.6.6.3.3"><csymbol cd="latexml" id="A1.Ex8.m1.6.6.6.3.3.1.cmml" xref="A1.Ex8.m1.6.6.6.3.3.1">differential-d</csymbol><ci id="A1.Ex8.m1.6.6.6.3.3.2.cmml" xref="A1.Ex8.m1.6.6.6.3.3.2">𝒙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex8.m1.6c">\displaystyle=\frac{\int\frac{\partial}{\partial{\boldsymbol{\theta}}}\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}}{\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.Ex9.m1.6" class="ltx_Math" alttext="\displaystyle=\int\frac{\frac{\partial}{\partial{\boldsymbol{\theta}}}\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}{\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}}d{\boldsymbol{x}}" display="inline"><semantics id="A1.Ex9.m1.6a"><mrow id="A1.Ex9.m1.6.7" xref="A1.Ex9.m1.6.7.cmml"><mi id="A1.Ex9.m1.6.7.2" xref="A1.Ex9.m1.6.7.2.cmml"></mi><mo id="A1.Ex9.m1.6.7.1" xref="A1.Ex9.m1.6.7.1.cmml">=</mo><mstyle displaystyle="true" id="A1.Ex9.m1.6.7.3" xref="A1.Ex9.m1.6.7.3.cmml"><mrow id="A1.Ex9.m1.6.7.3a" xref="A1.Ex9.m1.6.7.3.cmml"><mo id="A1.Ex9.m1.6.7.3.1" xref="A1.Ex9.m1.6.7.3.1.cmml">∫</mo><mrow id="A1.Ex9.m1.6.7.3.2" xref="A1.Ex9.m1.6.7.3.2.cmml"><mfrac id="A1.Ex9.m1.6.6" xref="A1.Ex9.m1.6.6.cmml"><mrow id="A1.Ex9.m1.3.3.3" xref="A1.Ex9.m1.3.3.3.cmml"><mfrac id="A1.Ex9.m1.3.3.3.5" xref="A1.Ex9.m1.3.3.3.5.cmml"><mo id="A1.Ex9.m1.3.3.3.5.2" xref="A1.Ex9.m1.3.3.3.5.2.cmml">∂</mo><mrow id="A1.Ex9.m1.3.3.3.5.3" xref="A1.Ex9.m1.3.3.3.5.3.cmml"><mo rspace="0em" id="A1.Ex9.m1.3.3.3.5.3.1" xref="A1.Ex9.m1.3.3.3.5.3.1.cmml">∂</mo><mi id="A1.Ex9.m1.3.3.3.5.3.2" xref="A1.Ex9.m1.3.3.3.5.3.2.cmml">𝜽</mi></mrow></mfrac><mo lspace="0.167em" rspace="0em" id="A1.Ex9.m1.3.3.3.4" xref="A1.Ex9.m1.3.3.3.4.cmml">​</mo><mrow id="A1.Ex9.m1.3.3.3.3.1" xref="A1.Ex9.m1.3.3.3.3.2.cmml"><mi id="A1.Ex9.m1.2.2.2.2" xref="A1.Ex9.m1.2.2.2.2.cmml">exp</mi><mo id="A1.Ex9.m1.3.3.3.3.1a" xref="A1.Ex9.m1.3.3.3.3.2.cmml">⁡</mo><mrow id="A1.Ex9.m1.3.3.3.3.1.1" xref="A1.Ex9.m1.3.3.3.3.2.cmml"><mo stretchy="false" id="A1.Ex9.m1.3.3.3.3.1.1.2" xref="A1.Ex9.m1.3.3.3.3.2.cmml">(</mo><mrow id="A1.Ex9.m1.3.3.3.3.1.1.1" xref="A1.Ex9.m1.3.3.3.3.1.1.1.cmml"><msub id="A1.Ex9.m1.3.3.3.3.1.1.1.3" xref="A1.Ex9.m1.3.3.3.3.1.1.1.3.cmml"><mi id="A1.Ex9.m1.3.3.3.3.1.1.1.3.2" xref="A1.Ex9.m1.3.3.3.3.1.1.1.3.2.cmml">E</mi><mi id="A1.Ex9.m1.3.3.3.3.1.1.1.3.3" xref="A1.Ex9.m1.3.3.3.3.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex9.m1.3.3.3.3.1.1.1.2" xref="A1.Ex9.m1.3.3.3.3.1.1.1.2.cmml">​</mo><mrow id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.2" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.cmml"><msub id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2.2" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2.3" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.1" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.3.2" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.3.2.1" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex9.m1.1.1.1.1" xref="A1.Ex9.m1.1.1.1.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.3.2.2" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.3" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex9.m1.3.3.3.3.1.1.3" xref="A1.Ex9.m1.3.3.3.3.2.cmml">)</mo></mrow></mrow></mrow><mrow id="A1.Ex9.m1.6.6.6" xref="A1.Ex9.m1.6.6.6.cmml"><mo id="A1.Ex9.m1.6.6.6.4" xref="A1.Ex9.m1.6.6.6.4.cmml">∫</mo><mrow id="A1.Ex9.m1.6.6.6.3" xref="A1.Ex9.m1.6.6.6.3.cmml"><mrow id="A1.Ex9.m1.6.6.6.3.1.1" xref="A1.Ex9.m1.6.6.6.3.1.2.cmml"><mi id="A1.Ex9.m1.5.5.5.2" xref="A1.Ex9.m1.5.5.5.2.cmml">exp</mi><mo id="A1.Ex9.m1.6.6.6.3.1.1a" xref="A1.Ex9.m1.6.6.6.3.1.2.cmml">⁡</mo><mrow id="A1.Ex9.m1.6.6.6.3.1.1.1" xref="A1.Ex9.m1.6.6.6.3.1.2.cmml"><mo stretchy="false" id="A1.Ex9.m1.6.6.6.3.1.1.1.2" xref="A1.Ex9.m1.6.6.6.3.1.2.cmml">(</mo><mrow id="A1.Ex9.m1.6.6.6.3.1.1.1.1" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.cmml"><msub id="A1.Ex9.m1.6.6.6.3.1.1.1.1.3" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.3.cmml"><mi id="A1.Ex9.m1.6.6.6.3.1.1.1.1.3.2" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.3.2.cmml">E</mi><mi id="A1.Ex9.m1.6.6.6.3.1.1.1.1.3.3" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex9.m1.6.6.6.3.1.1.1.1.2" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.2.cmml">​</mo><mrow id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.2" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2.2" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2.3" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.1" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.3.2" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.1" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex9.m1.4.4.4.1" xref="A1.Ex9.m1.4.4.4.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.3" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex9.m1.6.6.6.3.1.1.1.3" xref="A1.Ex9.m1.6.6.6.3.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="A1.Ex9.m1.6.6.6.3.2" xref="A1.Ex9.m1.6.6.6.3.2.cmml">​</mo><mrow id="A1.Ex9.m1.6.6.6.3.3" xref="A1.Ex9.m1.6.6.6.3.3.cmml"><mo rspace="0em" id="A1.Ex9.m1.6.6.6.3.3.1" xref="A1.Ex9.m1.6.6.6.3.3.1.cmml">𝑑</mo><mi id="A1.Ex9.m1.6.6.6.3.3.2" xref="A1.Ex9.m1.6.6.6.3.3.2.cmml">𝒙</mi></mrow></mrow></mrow></mfrac><mo lspace="0em" rspace="0em" id="A1.Ex9.m1.6.7.3.2.1" xref="A1.Ex9.m1.6.7.3.2.1.cmml">​</mo><mrow id="A1.Ex9.m1.6.7.3.2.2" xref="A1.Ex9.m1.6.7.3.2.2.cmml"><mo rspace="0em" id="A1.Ex9.m1.6.7.3.2.2.1" xref="A1.Ex9.m1.6.7.3.2.2.1.cmml">𝑑</mo><mi id="A1.Ex9.m1.6.7.3.2.2.2" xref="A1.Ex9.m1.6.7.3.2.2.2.cmml">𝒙</mi></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex9.m1.6b"><apply id="A1.Ex9.m1.6.7.cmml" xref="A1.Ex9.m1.6.7"><eq id="A1.Ex9.m1.6.7.1.cmml" xref="A1.Ex9.m1.6.7.1"></eq><csymbol cd="latexml" id="A1.Ex9.m1.6.7.2.cmml" xref="A1.Ex9.m1.6.7.2">absent</csymbol><apply id="A1.Ex9.m1.6.7.3.cmml" xref="A1.Ex9.m1.6.7.3"><int id="A1.Ex9.m1.6.7.3.1.cmml" xref="A1.Ex9.m1.6.7.3.1"></int><apply id="A1.Ex9.m1.6.7.3.2.cmml" xref="A1.Ex9.m1.6.7.3.2"><times id="A1.Ex9.m1.6.7.3.2.1.cmml" xref="A1.Ex9.m1.6.7.3.2.1"></times><apply id="A1.Ex9.m1.6.6.cmml" xref="A1.Ex9.m1.6.6"><divide id="A1.Ex9.m1.6.6.7.cmml" xref="A1.Ex9.m1.6.6"></divide><apply id="A1.Ex9.m1.3.3.3.cmml" xref="A1.Ex9.m1.3.3.3"><times id="A1.Ex9.m1.3.3.3.4.cmml" xref="A1.Ex9.m1.3.3.3.4"></times><apply id="A1.Ex9.m1.3.3.3.5.cmml" xref="A1.Ex9.m1.3.3.3.5"><divide id="A1.Ex9.m1.3.3.3.5.1.cmml" xref="A1.Ex9.m1.3.3.3.5"></divide><partialdiff id="A1.Ex9.m1.3.3.3.5.2.cmml" xref="A1.Ex9.m1.3.3.3.5.2"></partialdiff><apply id="A1.Ex9.m1.3.3.3.5.3.cmml" xref="A1.Ex9.m1.3.3.3.5.3"><partialdiff id="A1.Ex9.m1.3.3.3.5.3.1.cmml" xref="A1.Ex9.m1.3.3.3.5.3.1"></partialdiff><ci id="A1.Ex9.m1.3.3.3.5.3.2.cmml" xref="A1.Ex9.m1.3.3.3.5.3.2">𝜽</ci></apply></apply><apply id="A1.Ex9.m1.3.3.3.3.2.cmml" xref="A1.Ex9.m1.3.3.3.3.1"><exp id="A1.Ex9.m1.2.2.2.2.cmml" xref="A1.Ex9.m1.2.2.2.2"></exp><apply id="A1.Ex9.m1.3.3.3.3.1.1.1.cmml" xref="A1.Ex9.m1.3.3.3.3.1.1.1"><times id="A1.Ex9.m1.3.3.3.3.1.1.1.2.cmml" xref="A1.Ex9.m1.3.3.3.3.1.1.1.2"></times><apply id="A1.Ex9.m1.3.3.3.3.1.1.1.3.cmml" xref="A1.Ex9.m1.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex9.m1.3.3.3.3.1.1.1.3.1.cmml" xref="A1.Ex9.m1.3.3.3.3.1.1.1.3">subscript</csymbol><ci id="A1.Ex9.m1.3.3.3.3.1.1.1.3.2.cmml" xref="A1.Ex9.m1.3.3.3.3.1.1.1.3.2">𝐸</ci><ci id="A1.Ex9.m1.3.3.3.3.1.1.1.3.3.cmml" xref="A1.Ex9.m1.3.3.3.3.1.1.1.3.3">𝜽</ci></apply><apply id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1"><times id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.1"></times><apply id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex9.m1.3.3.3.3.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex9.m1.1.1.1.1.cmml" xref="A1.Ex9.m1.1.1.1.1">𝒙</ci></apply></apply></apply></apply><apply id="A1.Ex9.m1.6.6.6.cmml" xref="A1.Ex9.m1.6.6.6"><int id="A1.Ex9.m1.6.6.6.4.cmml" xref="A1.Ex9.m1.6.6.6.4"></int><apply id="A1.Ex9.m1.6.6.6.3.cmml" xref="A1.Ex9.m1.6.6.6.3"><times id="A1.Ex9.m1.6.6.6.3.2.cmml" xref="A1.Ex9.m1.6.6.6.3.2"></times><apply id="A1.Ex9.m1.6.6.6.3.1.2.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1"><exp id="A1.Ex9.m1.5.5.5.2.cmml" xref="A1.Ex9.m1.5.5.5.2"></exp><apply id="A1.Ex9.m1.6.6.6.3.1.1.1.1.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1"><times id="A1.Ex9.m1.6.6.6.3.1.1.1.1.2.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.2"></times><apply id="A1.Ex9.m1.6.6.6.3.1.1.1.1.3.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex9.m1.6.6.6.3.1.1.1.1.3.1.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex9.m1.6.6.6.3.1.1.1.1.3.2.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.3.2">𝐸</ci><ci id="A1.Ex9.m1.6.6.6.3.1.1.1.1.3.3.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.3.3">𝜽</ci></apply><apply id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1"><times id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex9.m1.6.6.6.3.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex9.m1.4.4.4.1.cmml" xref="A1.Ex9.m1.4.4.4.1">𝒙</ci></apply></apply></apply><apply id="A1.Ex9.m1.6.6.6.3.3.cmml" xref="A1.Ex9.m1.6.6.6.3.3"><csymbol cd="latexml" id="A1.Ex9.m1.6.6.6.3.3.1.cmml" xref="A1.Ex9.m1.6.6.6.3.3.1">differential-d</csymbol><ci id="A1.Ex9.m1.6.6.6.3.3.2.cmml" xref="A1.Ex9.m1.6.6.6.3.3.2">𝒙</ci></apply></apply></apply></apply><apply id="A1.Ex9.m1.6.7.3.2.2.cmml" xref="A1.Ex9.m1.6.7.3.2.2"><csymbol cd="latexml" id="A1.Ex9.m1.6.7.3.2.2.1.cmml" xref="A1.Ex9.m1.6.7.3.2.2.1">differential-d</csymbol><ci id="A1.Ex9.m1.6.7.3.2.2.2.cmml" xref="A1.Ex9.m1.6.7.3.2.2.2">𝒙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex9.m1.6c">\displaystyle=\int\frac{\frac{\partial}{\partial{\boldsymbol{\theta}}}\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}{\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}}d{\boldsymbol{x}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.Ex10.m1.8" class="ltx_Math" alttext="\displaystyle=\int\frac{\frac{\partial}{\partial{\boldsymbol{\theta}}}E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}))\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}{\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}}d{\boldsymbol{x}}" display="inline"><semantics id="A1.Ex10.m1.8a"><mrow id="A1.Ex10.m1.8.9" xref="A1.Ex10.m1.8.9.cmml"><mi id="A1.Ex10.m1.8.9.2" xref="A1.Ex10.m1.8.9.2.cmml"></mi><mo id="A1.Ex10.m1.8.9.1" xref="A1.Ex10.m1.8.9.1.cmml">=</mo><mstyle displaystyle="true" id="A1.Ex10.m1.8.9.3" xref="A1.Ex10.m1.8.9.3.cmml"><mrow id="A1.Ex10.m1.8.9.3a" xref="A1.Ex10.m1.8.9.3.cmml"><mo id="A1.Ex10.m1.8.9.3.1" xref="A1.Ex10.m1.8.9.3.1.cmml">∫</mo><mrow id="A1.Ex10.m1.8.9.3.2" xref="A1.Ex10.m1.8.9.3.2.cmml"><mfrac id="A1.Ex10.m1.8.8" xref="A1.Ex10.m1.8.8.cmml"><mrow id="A1.Ex10.m1.5.5.5" xref="A1.Ex10.m1.5.5.5.cmml"><mfrac id="A1.Ex10.m1.5.5.5.7" xref="A1.Ex10.m1.5.5.5.7.cmml"><mo id="A1.Ex10.m1.5.5.5.7.2" xref="A1.Ex10.m1.5.5.5.7.2.cmml">∂</mo><mrow id="A1.Ex10.m1.5.5.5.7.3" xref="A1.Ex10.m1.5.5.5.7.3.cmml"><mo rspace="0em" id="A1.Ex10.m1.5.5.5.7.3.1" xref="A1.Ex10.m1.5.5.5.7.3.1.cmml">∂</mo><mi id="A1.Ex10.m1.5.5.5.7.3.2" xref="A1.Ex10.m1.5.5.5.7.3.2.cmml">𝜽</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="A1.Ex10.m1.5.5.5.6" xref="A1.Ex10.m1.5.5.5.6.cmml">​</mo><msub id="A1.Ex10.m1.5.5.5.8" xref="A1.Ex10.m1.5.5.5.8.cmml"><mi id="A1.Ex10.m1.5.5.5.8.2" xref="A1.Ex10.m1.5.5.5.8.2.cmml">E</mi><mi id="A1.Ex10.m1.5.5.5.8.3" xref="A1.Ex10.m1.5.5.5.8.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex10.m1.5.5.5.6a" xref="A1.Ex10.m1.5.5.5.6.cmml">​</mo><mrow id="A1.Ex10.m1.4.4.4.4.1" xref="A1.Ex10.m1.4.4.4.4.1.1.cmml"><mo stretchy="false" id="A1.Ex10.m1.4.4.4.4.1.2" xref="A1.Ex10.m1.4.4.4.4.1.1.cmml">(</mo><mrow id="A1.Ex10.m1.4.4.4.4.1.1" xref="A1.Ex10.m1.4.4.4.4.1.1.cmml"><msub id="A1.Ex10.m1.4.4.4.4.1.1.2" xref="A1.Ex10.m1.4.4.4.4.1.1.2.cmml"><mi id="A1.Ex10.m1.4.4.4.4.1.1.2.2" xref="A1.Ex10.m1.4.4.4.4.1.1.2.2.cmml">f</mi><mi id="A1.Ex10.m1.4.4.4.4.1.1.2.3" xref="A1.Ex10.m1.4.4.4.4.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex10.m1.4.4.4.4.1.1.1" xref="A1.Ex10.m1.4.4.4.4.1.1.1.cmml">​</mo><mrow id="A1.Ex10.m1.4.4.4.4.1.1.3.2" xref="A1.Ex10.m1.4.4.4.4.1.1.cmml"><mo stretchy="false" id="A1.Ex10.m1.4.4.4.4.1.1.3.2.1" xref="A1.Ex10.m1.4.4.4.4.1.1.cmml">(</mo><mi id="A1.Ex10.m1.1.1.1.1" xref="A1.Ex10.m1.1.1.1.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex10.m1.4.4.4.4.1.1.3.2.2" xref="A1.Ex10.m1.4.4.4.4.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex10.m1.4.4.4.4.1.3" xref="A1.Ex10.m1.4.4.4.4.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="A1.Ex10.m1.5.5.5.6b" xref="A1.Ex10.m1.5.5.5.6.cmml">​</mo><mrow id="A1.Ex10.m1.5.5.5.5.1" xref="A1.Ex10.m1.5.5.5.5.2.cmml"><mi id="A1.Ex10.m1.3.3.3.3" xref="A1.Ex10.m1.3.3.3.3.cmml">exp</mi><mo id="A1.Ex10.m1.5.5.5.5.1a" xref="A1.Ex10.m1.5.5.5.5.2.cmml">⁡</mo><mrow id="A1.Ex10.m1.5.5.5.5.1.1" xref="A1.Ex10.m1.5.5.5.5.2.cmml"><mo stretchy="false" id="A1.Ex10.m1.5.5.5.5.1.1.2" xref="A1.Ex10.m1.5.5.5.5.2.cmml">(</mo><mrow id="A1.Ex10.m1.5.5.5.5.1.1.1" xref="A1.Ex10.m1.5.5.5.5.1.1.1.cmml"><msub id="A1.Ex10.m1.5.5.5.5.1.1.1.3" xref="A1.Ex10.m1.5.5.5.5.1.1.1.3.cmml"><mi id="A1.Ex10.m1.5.5.5.5.1.1.1.3.2" xref="A1.Ex10.m1.5.5.5.5.1.1.1.3.2.cmml">E</mi><mi id="A1.Ex10.m1.5.5.5.5.1.1.1.3.3" xref="A1.Ex10.m1.5.5.5.5.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex10.m1.5.5.5.5.1.1.1.2" xref="A1.Ex10.m1.5.5.5.5.1.1.1.2.cmml">​</mo><mrow id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.2" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.cmml"><msub id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.2" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.3" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.1" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.3.2" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.3.2.1" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex10.m1.2.2.2.2" xref="A1.Ex10.m1.2.2.2.2.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.3.2.2" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.3" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex10.m1.5.5.5.5.1.1.3" xref="A1.Ex10.m1.5.5.5.5.2.cmml">)</mo></mrow></mrow></mrow><mrow id="A1.Ex10.m1.8.8.8" xref="A1.Ex10.m1.8.8.8.cmml"><mo id="A1.Ex10.m1.8.8.8.4" xref="A1.Ex10.m1.8.8.8.4.cmml">∫</mo><mrow id="A1.Ex10.m1.8.8.8.3" xref="A1.Ex10.m1.8.8.8.3.cmml"><mrow id="A1.Ex10.m1.8.8.8.3.1.1" xref="A1.Ex10.m1.8.8.8.3.1.2.cmml"><mi id="A1.Ex10.m1.7.7.7.2" xref="A1.Ex10.m1.7.7.7.2.cmml">exp</mi><mo id="A1.Ex10.m1.8.8.8.3.1.1a" xref="A1.Ex10.m1.8.8.8.3.1.2.cmml">⁡</mo><mrow id="A1.Ex10.m1.8.8.8.3.1.1.1" xref="A1.Ex10.m1.8.8.8.3.1.2.cmml"><mo stretchy="false" id="A1.Ex10.m1.8.8.8.3.1.1.1.2" xref="A1.Ex10.m1.8.8.8.3.1.2.cmml">(</mo><mrow id="A1.Ex10.m1.8.8.8.3.1.1.1.1" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.cmml"><msub id="A1.Ex10.m1.8.8.8.3.1.1.1.1.3" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.3.cmml"><mi id="A1.Ex10.m1.8.8.8.3.1.1.1.1.3.2" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.3.2.cmml">E</mi><mi id="A1.Ex10.m1.8.8.8.3.1.1.1.1.3.3" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex10.m1.8.8.8.3.1.1.1.1.2" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.2.cmml">​</mo><mrow id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.2" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2.2" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2.3" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.1" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.3.2" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.3.2.1" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex10.m1.6.6.6.1" xref="A1.Ex10.m1.6.6.6.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.3" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex10.m1.8.8.8.3.1.1.1.3" xref="A1.Ex10.m1.8.8.8.3.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="A1.Ex10.m1.8.8.8.3.2" xref="A1.Ex10.m1.8.8.8.3.2.cmml">​</mo><mrow id="A1.Ex10.m1.8.8.8.3.3" xref="A1.Ex10.m1.8.8.8.3.3.cmml"><mo rspace="0em" id="A1.Ex10.m1.8.8.8.3.3.1" xref="A1.Ex10.m1.8.8.8.3.3.1.cmml">𝑑</mo><mi id="A1.Ex10.m1.8.8.8.3.3.2" xref="A1.Ex10.m1.8.8.8.3.3.2.cmml">𝒙</mi></mrow></mrow></mrow></mfrac><mo lspace="0em" rspace="0em" id="A1.Ex10.m1.8.9.3.2.1" xref="A1.Ex10.m1.8.9.3.2.1.cmml">​</mo><mrow id="A1.Ex10.m1.8.9.3.2.2" xref="A1.Ex10.m1.8.9.3.2.2.cmml"><mo rspace="0em" id="A1.Ex10.m1.8.9.3.2.2.1" xref="A1.Ex10.m1.8.9.3.2.2.1.cmml">𝑑</mo><mi id="A1.Ex10.m1.8.9.3.2.2.2" xref="A1.Ex10.m1.8.9.3.2.2.2.cmml">𝒙</mi></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex10.m1.8b"><apply id="A1.Ex10.m1.8.9.cmml" xref="A1.Ex10.m1.8.9"><eq id="A1.Ex10.m1.8.9.1.cmml" xref="A1.Ex10.m1.8.9.1"></eq><csymbol cd="latexml" id="A1.Ex10.m1.8.9.2.cmml" xref="A1.Ex10.m1.8.9.2">absent</csymbol><apply id="A1.Ex10.m1.8.9.3.cmml" xref="A1.Ex10.m1.8.9.3"><int id="A1.Ex10.m1.8.9.3.1.cmml" xref="A1.Ex10.m1.8.9.3.1"></int><apply id="A1.Ex10.m1.8.9.3.2.cmml" xref="A1.Ex10.m1.8.9.3.2"><times id="A1.Ex10.m1.8.9.3.2.1.cmml" xref="A1.Ex10.m1.8.9.3.2.1"></times><apply id="A1.Ex10.m1.8.8.cmml" xref="A1.Ex10.m1.8.8"><divide id="A1.Ex10.m1.8.8.9.cmml" xref="A1.Ex10.m1.8.8"></divide><apply id="A1.Ex10.m1.5.5.5.cmml" xref="A1.Ex10.m1.5.5.5"><times id="A1.Ex10.m1.5.5.5.6.cmml" xref="A1.Ex10.m1.5.5.5.6"></times><apply id="A1.Ex10.m1.5.5.5.7.cmml" xref="A1.Ex10.m1.5.5.5.7"><divide id="A1.Ex10.m1.5.5.5.7.1.cmml" xref="A1.Ex10.m1.5.5.5.7"></divide><partialdiff id="A1.Ex10.m1.5.5.5.7.2.cmml" xref="A1.Ex10.m1.5.5.5.7.2"></partialdiff><apply id="A1.Ex10.m1.5.5.5.7.3.cmml" xref="A1.Ex10.m1.5.5.5.7.3"><partialdiff id="A1.Ex10.m1.5.5.5.7.3.1.cmml" xref="A1.Ex10.m1.5.5.5.7.3.1"></partialdiff><ci id="A1.Ex10.m1.5.5.5.7.3.2.cmml" xref="A1.Ex10.m1.5.5.5.7.3.2">𝜽</ci></apply></apply><apply id="A1.Ex10.m1.5.5.5.8.cmml" xref="A1.Ex10.m1.5.5.5.8"><csymbol cd="ambiguous" id="A1.Ex10.m1.5.5.5.8.1.cmml" xref="A1.Ex10.m1.5.5.5.8">subscript</csymbol><ci id="A1.Ex10.m1.5.5.5.8.2.cmml" xref="A1.Ex10.m1.5.5.5.8.2">𝐸</ci><ci id="A1.Ex10.m1.5.5.5.8.3.cmml" xref="A1.Ex10.m1.5.5.5.8.3">𝜽</ci></apply><apply id="A1.Ex10.m1.4.4.4.4.1.1.cmml" xref="A1.Ex10.m1.4.4.4.4.1"><times id="A1.Ex10.m1.4.4.4.4.1.1.1.cmml" xref="A1.Ex10.m1.4.4.4.4.1.1.1"></times><apply id="A1.Ex10.m1.4.4.4.4.1.1.2.cmml" xref="A1.Ex10.m1.4.4.4.4.1.1.2"><csymbol cd="ambiguous" id="A1.Ex10.m1.4.4.4.4.1.1.2.1.cmml" xref="A1.Ex10.m1.4.4.4.4.1.1.2">subscript</csymbol><ci id="A1.Ex10.m1.4.4.4.4.1.1.2.2.cmml" xref="A1.Ex10.m1.4.4.4.4.1.1.2.2">𝑓</ci><ci id="A1.Ex10.m1.4.4.4.4.1.1.2.3.cmml" xref="A1.Ex10.m1.4.4.4.4.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex10.m1.1.1.1.1.cmml" xref="A1.Ex10.m1.1.1.1.1">𝒙</ci></apply><apply id="A1.Ex10.m1.5.5.5.5.2.cmml" xref="A1.Ex10.m1.5.5.5.5.1"><exp id="A1.Ex10.m1.3.3.3.3.cmml" xref="A1.Ex10.m1.3.3.3.3"></exp><apply id="A1.Ex10.m1.5.5.5.5.1.1.1.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1"><times id="A1.Ex10.m1.5.5.5.5.1.1.1.2.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.2"></times><apply id="A1.Ex10.m1.5.5.5.5.1.1.1.3.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex10.m1.5.5.5.5.1.1.1.3.1.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.3">subscript</csymbol><ci id="A1.Ex10.m1.5.5.5.5.1.1.1.3.2.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.3.2">𝐸</ci><ci id="A1.Ex10.m1.5.5.5.5.1.1.1.3.3.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.3.3">𝜽</ci></apply><apply id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1"><times id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.1"></times><apply id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex10.m1.5.5.5.5.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex10.m1.2.2.2.2.cmml" xref="A1.Ex10.m1.2.2.2.2">𝒙</ci></apply></apply></apply></apply><apply id="A1.Ex10.m1.8.8.8.cmml" xref="A1.Ex10.m1.8.8.8"><int id="A1.Ex10.m1.8.8.8.4.cmml" xref="A1.Ex10.m1.8.8.8.4"></int><apply id="A1.Ex10.m1.8.8.8.3.cmml" xref="A1.Ex10.m1.8.8.8.3"><times id="A1.Ex10.m1.8.8.8.3.2.cmml" xref="A1.Ex10.m1.8.8.8.3.2"></times><apply id="A1.Ex10.m1.8.8.8.3.1.2.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1"><exp id="A1.Ex10.m1.7.7.7.2.cmml" xref="A1.Ex10.m1.7.7.7.2"></exp><apply id="A1.Ex10.m1.8.8.8.3.1.1.1.1.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1"><times id="A1.Ex10.m1.8.8.8.3.1.1.1.1.2.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.2"></times><apply id="A1.Ex10.m1.8.8.8.3.1.1.1.1.3.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex10.m1.8.8.8.3.1.1.1.1.3.1.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex10.m1.8.8.8.3.1.1.1.1.3.2.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.3.2">𝐸</ci><ci id="A1.Ex10.m1.8.8.8.3.1.1.1.1.3.3.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.3.3">𝜽</ci></apply><apply id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1"><times id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex10.m1.8.8.8.3.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex10.m1.6.6.6.1.cmml" xref="A1.Ex10.m1.6.6.6.1">𝒙</ci></apply></apply></apply><apply id="A1.Ex10.m1.8.8.8.3.3.cmml" xref="A1.Ex10.m1.8.8.8.3.3"><csymbol cd="latexml" id="A1.Ex10.m1.8.8.8.3.3.1.cmml" xref="A1.Ex10.m1.8.8.8.3.3.1">differential-d</csymbol><ci id="A1.Ex10.m1.8.8.8.3.3.2.cmml" xref="A1.Ex10.m1.8.8.8.3.3.2">𝒙</ci></apply></apply></apply></apply><apply id="A1.Ex10.m1.8.9.3.2.2.cmml" xref="A1.Ex10.m1.8.9.3.2.2"><csymbol cd="latexml" id="A1.Ex10.m1.8.9.3.2.2.1.cmml" xref="A1.Ex10.m1.8.9.3.2.2.1">differential-d</csymbol><ci id="A1.Ex10.m1.8.9.3.2.2.2.cmml" xref="A1.Ex10.m1.8.9.3.2.2.2">𝒙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex10.m1.8c">\displaystyle=\int\frac{\frac{\partial}{\partial{\boldsymbol{\theta}}}E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}))\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}{\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}}d{\boldsymbol{x}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.Ex11.m1.8" class="ltx_Math" alttext="\displaystyle=\int\frac{\partial}{\partial{\boldsymbol{\theta}}}E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}))\frac{\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}{\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}}d{\boldsymbol{x}}" display="inline"><semantics id="A1.Ex11.m1.8a"><mrow id="A1.Ex11.m1.8.8" xref="A1.Ex11.m1.8.8.cmml"><mi id="A1.Ex11.m1.8.8.3" xref="A1.Ex11.m1.8.8.3.cmml"></mi><mo id="A1.Ex11.m1.8.8.2" xref="A1.Ex11.m1.8.8.2.cmml">=</mo><mstyle displaystyle="true" id="A1.Ex11.m1.8.8.1" xref="A1.Ex11.m1.8.8.1.cmml"><mrow id="A1.Ex11.m1.8.8.1a" xref="A1.Ex11.m1.8.8.1.cmml"><mo id="A1.Ex11.m1.8.8.1.2" xref="A1.Ex11.m1.8.8.1.2.cmml">∫</mo><mrow id="A1.Ex11.m1.8.8.1.1" xref="A1.Ex11.m1.8.8.1.1.cmml"><mfrac id="A1.Ex11.m1.8.8.1.1.3" xref="A1.Ex11.m1.8.8.1.1.3.cmml"><mo id="A1.Ex11.m1.8.8.1.1.3.2" xref="A1.Ex11.m1.8.8.1.1.3.2.cmml">∂</mo><mrow id="A1.Ex11.m1.8.8.1.1.3.3" xref="A1.Ex11.m1.8.8.1.1.3.3.cmml"><mo rspace="0em" id="A1.Ex11.m1.8.8.1.1.3.3.1" xref="A1.Ex11.m1.8.8.1.1.3.3.1.cmml">∂</mo><mi id="A1.Ex11.m1.8.8.1.1.3.3.2" xref="A1.Ex11.m1.8.8.1.1.3.3.2.cmml">𝜽</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="A1.Ex11.m1.8.8.1.1.2" xref="A1.Ex11.m1.8.8.1.1.2.cmml">​</mo><msub id="A1.Ex11.m1.8.8.1.1.4" xref="A1.Ex11.m1.8.8.1.1.4.cmml"><mi id="A1.Ex11.m1.8.8.1.1.4.2" xref="A1.Ex11.m1.8.8.1.1.4.2.cmml">E</mi><mi id="A1.Ex11.m1.8.8.1.1.4.3" xref="A1.Ex11.m1.8.8.1.1.4.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex11.m1.8.8.1.1.2a" xref="A1.Ex11.m1.8.8.1.1.2.cmml">​</mo><mrow id="A1.Ex11.m1.8.8.1.1.1.1" xref="A1.Ex11.m1.8.8.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex11.m1.8.8.1.1.1.1.2" xref="A1.Ex11.m1.8.8.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex11.m1.8.8.1.1.1.1.1" xref="A1.Ex11.m1.8.8.1.1.1.1.1.cmml"><msub id="A1.Ex11.m1.8.8.1.1.1.1.1.2" xref="A1.Ex11.m1.8.8.1.1.1.1.1.2.cmml"><mi id="A1.Ex11.m1.8.8.1.1.1.1.1.2.2" xref="A1.Ex11.m1.8.8.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex11.m1.8.8.1.1.1.1.1.2.3" xref="A1.Ex11.m1.8.8.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex11.m1.8.8.1.1.1.1.1.1" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex11.m1.8.8.1.1.1.1.1.3.2" xref="A1.Ex11.m1.8.8.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex11.m1.8.8.1.1.1.1.1.3.2.1" xref="A1.Ex11.m1.8.8.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex11.m1.7.7" xref="A1.Ex11.m1.7.7.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex11.m1.8.8.1.1.1.1.1.3.2.2" xref="A1.Ex11.m1.8.8.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex11.m1.8.8.1.1.1.1.3" xref="A1.Ex11.m1.8.8.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A1.Ex11.m1.8.8.1.1.2b" xref="A1.Ex11.m1.8.8.1.1.2.cmml">​</mo><mfrac id="A1.Ex11.m1.6.6" xref="A1.Ex11.m1.6.6.cmml"><mrow id="A1.Ex11.m1.3.3.3.3" xref="A1.Ex11.m1.3.3.3.4.cmml"><mi id="A1.Ex11.m1.2.2.2.2" xref="A1.Ex11.m1.2.2.2.2.cmml">exp</mi><mo id="A1.Ex11.m1.3.3.3.3a" xref="A1.Ex11.m1.3.3.3.4.cmml">⁡</mo><mrow id="A1.Ex11.m1.3.3.3.3.1" xref="A1.Ex11.m1.3.3.3.4.cmml"><mo stretchy="false" id="A1.Ex11.m1.3.3.3.3.1.2" xref="A1.Ex11.m1.3.3.3.4.cmml">(</mo><mrow id="A1.Ex11.m1.3.3.3.3.1.1" xref="A1.Ex11.m1.3.3.3.3.1.1.cmml"><msub id="A1.Ex11.m1.3.3.3.3.1.1.3" xref="A1.Ex11.m1.3.3.3.3.1.1.3.cmml"><mi id="A1.Ex11.m1.3.3.3.3.1.1.3.2" xref="A1.Ex11.m1.3.3.3.3.1.1.3.2.cmml">E</mi><mi id="A1.Ex11.m1.3.3.3.3.1.1.3.3" xref="A1.Ex11.m1.3.3.3.3.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex11.m1.3.3.3.3.1.1.2" xref="A1.Ex11.m1.3.3.3.3.1.1.2.cmml">​</mo><mrow id="A1.Ex11.m1.3.3.3.3.1.1.1.1" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex11.m1.3.3.3.3.1.1.1.1.2" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.cmml"><msub id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2.cmml"><mi id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2.2" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2.3" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.1" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.3.2" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.3.2.1" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex11.m1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.3.2.2" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex11.m1.3.3.3.3.1.1.1.1.3" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex11.m1.3.3.3.3.1.3" xref="A1.Ex11.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="A1.Ex11.m1.6.6.6" xref="A1.Ex11.m1.6.6.6.cmml"><mo id="A1.Ex11.m1.6.6.6.4" xref="A1.Ex11.m1.6.6.6.4.cmml">∫</mo><mrow id="A1.Ex11.m1.6.6.6.3" xref="A1.Ex11.m1.6.6.6.3.cmml"><mrow id="A1.Ex11.m1.6.6.6.3.1.1" xref="A1.Ex11.m1.6.6.6.3.1.2.cmml"><mi id="A1.Ex11.m1.5.5.5.2" xref="A1.Ex11.m1.5.5.5.2.cmml">exp</mi><mo id="A1.Ex11.m1.6.6.6.3.1.1a" xref="A1.Ex11.m1.6.6.6.3.1.2.cmml">⁡</mo><mrow id="A1.Ex11.m1.6.6.6.3.1.1.1" xref="A1.Ex11.m1.6.6.6.3.1.2.cmml"><mo stretchy="false" id="A1.Ex11.m1.6.6.6.3.1.1.1.2" xref="A1.Ex11.m1.6.6.6.3.1.2.cmml">(</mo><mrow id="A1.Ex11.m1.6.6.6.3.1.1.1.1" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.cmml"><msub id="A1.Ex11.m1.6.6.6.3.1.1.1.1.3" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.3.cmml"><mi id="A1.Ex11.m1.6.6.6.3.1.1.1.1.3.2" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.3.2.cmml">E</mi><mi id="A1.Ex11.m1.6.6.6.3.1.1.1.1.3.3" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex11.m1.6.6.6.3.1.1.1.1.2" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.2.cmml">​</mo><mrow id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.2" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><msub id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml"><mi id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2.2" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2.3" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.1" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.3.2" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.1" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex11.m1.4.4.4.1" xref="A1.Ex11.m1.4.4.4.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.3" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex11.m1.6.6.6.3.1.1.1.3" xref="A1.Ex11.m1.6.6.6.3.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="A1.Ex11.m1.6.6.6.3.2" xref="A1.Ex11.m1.6.6.6.3.2.cmml">​</mo><mrow id="A1.Ex11.m1.6.6.6.3.3" xref="A1.Ex11.m1.6.6.6.3.3.cmml"><mo rspace="0em" id="A1.Ex11.m1.6.6.6.3.3.1" xref="A1.Ex11.m1.6.6.6.3.3.1.cmml">𝑑</mo><mi id="A1.Ex11.m1.6.6.6.3.3.2" xref="A1.Ex11.m1.6.6.6.3.3.2.cmml">𝒙</mi></mrow></mrow></mrow></mfrac><mo lspace="0em" rspace="0em" id="A1.Ex11.m1.8.8.1.1.2c" xref="A1.Ex11.m1.8.8.1.1.2.cmml">​</mo><mrow id="A1.Ex11.m1.8.8.1.1.5" xref="A1.Ex11.m1.8.8.1.1.5.cmml"><mo rspace="0em" id="A1.Ex11.m1.8.8.1.1.5.1" xref="A1.Ex11.m1.8.8.1.1.5.1.cmml">𝑑</mo><mi id="A1.Ex11.m1.8.8.1.1.5.2" xref="A1.Ex11.m1.8.8.1.1.5.2.cmml">𝒙</mi></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex11.m1.8b"><apply id="A1.Ex11.m1.8.8.cmml" xref="A1.Ex11.m1.8.8"><eq id="A1.Ex11.m1.8.8.2.cmml" xref="A1.Ex11.m1.8.8.2"></eq><csymbol cd="latexml" id="A1.Ex11.m1.8.8.3.cmml" xref="A1.Ex11.m1.8.8.3">absent</csymbol><apply id="A1.Ex11.m1.8.8.1.cmml" xref="A1.Ex11.m1.8.8.1"><int id="A1.Ex11.m1.8.8.1.2.cmml" xref="A1.Ex11.m1.8.8.1.2"></int><apply id="A1.Ex11.m1.8.8.1.1.cmml" xref="A1.Ex11.m1.8.8.1.1"><times id="A1.Ex11.m1.8.8.1.1.2.cmml" xref="A1.Ex11.m1.8.8.1.1.2"></times><apply id="A1.Ex11.m1.8.8.1.1.3.cmml" xref="A1.Ex11.m1.8.8.1.1.3"><divide id="A1.Ex11.m1.8.8.1.1.3.1.cmml" xref="A1.Ex11.m1.8.8.1.1.3"></divide><partialdiff id="A1.Ex11.m1.8.8.1.1.3.2.cmml" xref="A1.Ex11.m1.8.8.1.1.3.2"></partialdiff><apply id="A1.Ex11.m1.8.8.1.1.3.3.cmml" xref="A1.Ex11.m1.8.8.1.1.3.3"><partialdiff id="A1.Ex11.m1.8.8.1.1.3.3.1.cmml" xref="A1.Ex11.m1.8.8.1.1.3.3.1"></partialdiff><ci id="A1.Ex11.m1.8.8.1.1.3.3.2.cmml" xref="A1.Ex11.m1.8.8.1.1.3.3.2">𝜽</ci></apply></apply><apply id="A1.Ex11.m1.8.8.1.1.4.cmml" xref="A1.Ex11.m1.8.8.1.1.4"><csymbol cd="ambiguous" id="A1.Ex11.m1.8.8.1.1.4.1.cmml" xref="A1.Ex11.m1.8.8.1.1.4">subscript</csymbol><ci id="A1.Ex11.m1.8.8.1.1.4.2.cmml" xref="A1.Ex11.m1.8.8.1.1.4.2">𝐸</ci><ci id="A1.Ex11.m1.8.8.1.1.4.3.cmml" xref="A1.Ex11.m1.8.8.1.1.4.3">𝜽</ci></apply><apply id="A1.Ex11.m1.8.8.1.1.1.1.1.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1"><times id="A1.Ex11.m1.8.8.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.1"></times><apply id="A1.Ex11.m1.8.8.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex11.m1.8.8.1.1.1.1.1.2.1.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex11.m1.8.8.1.1.1.1.1.2.2.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex11.m1.8.8.1.1.1.1.1.2.3.cmml" xref="A1.Ex11.m1.8.8.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex11.m1.7.7.cmml" xref="A1.Ex11.m1.7.7">𝒙</ci></apply><apply id="A1.Ex11.m1.6.6.cmml" xref="A1.Ex11.m1.6.6"><divide id="A1.Ex11.m1.6.6.7.cmml" xref="A1.Ex11.m1.6.6"></divide><apply id="A1.Ex11.m1.3.3.3.4.cmml" xref="A1.Ex11.m1.3.3.3.3"><exp id="A1.Ex11.m1.2.2.2.2.cmml" xref="A1.Ex11.m1.2.2.2.2"></exp><apply id="A1.Ex11.m1.3.3.3.3.1.1.cmml" xref="A1.Ex11.m1.3.3.3.3.1.1"><times id="A1.Ex11.m1.3.3.3.3.1.1.2.cmml" xref="A1.Ex11.m1.3.3.3.3.1.1.2"></times><apply id="A1.Ex11.m1.3.3.3.3.1.1.3.cmml" xref="A1.Ex11.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.3.3.3.3.1.1.3.1.cmml" xref="A1.Ex11.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="A1.Ex11.m1.3.3.3.3.1.1.3.2.cmml" xref="A1.Ex11.m1.3.3.3.3.1.1.3.2">𝐸</ci><ci id="A1.Ex11.m1.3.3.3.3.1.1.3.3.cmml" xref="A1.Ex11.m1.3.3.3.3.1.1.3.3">𝜽</ci></apply><apply id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.cmml" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1"><times id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.1"></times><apply id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2.1.cmml" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2.2.cmml" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2.3.cmml" xref="A1.Ex11.m1.3.3.3.3.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex11.m1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1">𝒙</ci></apply></apply></apply><apply id="A1.Ex11.m1.6.6.6.cmml" xref="A1.Ex11.m1.6.6.6"><int id="A1.Ex11.m1.6.6.6.4.cmml" xref="A1.Ex11.m1.6.6.6.4"></int><apply id="A1.Ex11.m1.6.6.6.3.cmml" xref="A1.Ex11.m1.6.6.6.3"><times id="A1.Ex11.m1.6.6.6.3.2.cmml" xref="A1.Ex11.m1.6.6.6.3.2"></times><apply id="A1.Ex11.m1.6.6.6.3.1.2.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1"><exp id="A1.Ex11.m1.5.5.5.2.cmml" xref="A1.Ex11.m1.5.5.5.2"></exp><apply id="A1.Ex11.m1.6.6.6.3.1.1.1.1.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1"><times id="A1.Ex11.m1.6.6.6.3.1.1.1.1.2.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.2"></times><apply id="A1.Ex11.m1.6.6.6.3.1.1.1.1.3.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.6.6.6.3.1.1.1.1.3.1.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex11.m1.6.6.6.3.1.1.1.1.3.2.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.3.2">𝐸</ci><ci id="A1.Ex11.m1.6.6.6.3.1.1.1.1.3.3.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.3.3">𝜽</ci></apply><apply id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1"><times id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.1"></times><apply id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex11.m1.6.6.6.3.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex11.m1.4.4.4.1.cmml" xref="A1.Ex11.m1.4.4.4.1">𝒙</ci></apply></apply></apply><apply id="A1.Ex11.m1.6.6.6.3.3.cmml" xref="A1.Ex11.m1.6.6.6.3.3"><csymbol cd="latexml" id="A1.Ex11.m1.6.6.6.3.3.1.cmml" xref="A1.Ex11.m1.6.6.6.3.3.1">differential-d</csymbol><ci id="A1.Ex11.m1.6.6.6.3.3.2.cmml" xref="A1.Ex11.m1.6.6.6.3.3.2">𝒙</ci></apply></apply></apply></apply><apply id="A1.Ex11.m1.8.8.1.1.5.cmml" xref="A1.Ex11.m1.8.8.1.1.5"><csymbol cd="latexml" id="A1.Ex11.m1.8.8.1.1.5.1.cmml" xref="A1.Ex11.m1.8.8.1.1.5.1">differential-d</csymbol><ci id="A1.Ex11.m1.8.8.1.1.5.2.cmml" xref="A1.Ex11.m1.8.8.1.1.5.2">𝒙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex11.m1.8c">\displaystyle=\int\frac{\partial}{\partial{\boldsymbol{\theta}}}E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}))\frac{\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}{\int\exp(E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))d{\boldsymbol{x}}}d{\boldsymbol{x}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.Ex12.m1.3" class="ltx_Math" alttext="\displaystyle=\int p_{{\boldsymbol{\theta}}}({\boldsymbol{x}})\frac{\partial}{\partial{\boldsymbol{\theta}}}E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}))" display="inline"><semantics id="A1.Ex12.m1.3a"><mrow id="A1.Ex12.m1.3.3" xref="A1.Ex12.m1.3.3.cmml"><mi id="A1.Ex12.m1.3.3.3" xref="A1.Ex12.m1.3.3.3.cmml"></mi><mo id="A1.Ex12.m1.3.3.2" xref="A1.Ex12.m1.3.3.2.cmml">=</mo><mstyle displaystyle="true" id="A1.Ex12.m1.3.3.1" xref="A1.Ex12.m1.3.3.1.cmml"><mrow id="A1.Ex12.m1.3.3.1a" xref="A1.Ex12.m1.3.3.1.cmml"><mo id="A1.Ex12.m1.3.3.1.2" xref="A1.Ex12.m1.3.3.1.2.cmml">∫</mo><mrow id="A1.Ex12.m1.3.3.1.1" xref="A1.Ex12.m1.3.3.1.1.cmml"><msub id="A1.Ex12.m1.3.3.1.1.3" xref="A1.Ex12.m1.3.3.1.1.3.cmml"><mi id="A1.Ex12.m1.3.3.1.1.3.2" xref="A1.Ex12.m1.3.3.1.1.3.2.cmml">p</mi><mi id="A1.Ex12.m1.3.3.1.1.3.3" xref="A1.Ex12.m1.3.3.1.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex12.m1.3.3.1.1.2" xref="A1.Ex12.m1.3.3.1.1.2.cmml">​</mo><mrow id="A1.Ex12.m1.3.3.1.1.4.2" xref="A1.Ex12.m1.3.3.1.1.cmml"><mo stretchy="false" id="A1.Ex12.m1.3.3.1.1.4.2.1" xref="A1.Ex12.m1.3.3.1.1.cmml">(</mo><mi id="A1.Ex12.m1.1.1" xref="A1.Ex12.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex12.m1.3.3.1.1.4.2.2" xref="A1.Ex12.m1.3.3.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A1.Ex12.m1.3.3.1.1.2a" xref="A1.Ex12.m1.3.3.1.1.2.cmml">​</mo><mfrac id="A1.Ex12.m1.3.3.1.1.5" xref="A1.Ex12.m1.3.3.1.1.5.cmml"><mo id="A1.Ex12.m1.3.3.1.1.5.2" xref="A1.Ex12.m1.3.3.1.1.5.2.cmml">∂</mo><mrow id="A1.Ex12.m1.3.3.1.1.5.3" xref="A1.Ex12.m1.3.3.1.1.5.3.cmml"><mo rspace="0em" id="A1.Ex12.m1.3.3.1.1.5.3.1" xref="A1.Ex12.m1.3.3.1.1.5.3.1.cmml">∂</mo><mi id="A1.Ex12.m1.3.3.1.1.5.3.2" xref="A1.Ex12.m1.3.3.1.1.5.3.2.cmml">𝜽</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="A1.Ex12.m1.3.3.1.1.2b" xref="A1.Ex12.m1.3.3.1.1.2.cmml">​</mo><msub id="A1.Ex12.m1.3.3.1.1.6" xref="A1.Ex12.m1.3.3.1.1.6.cmml"><mi id="A1.Ex12.m1.3.3.1.1.6.2" xref="A1.Ex12.m1.3.3.1.1.6.2.cmml">E</mi><mi id="A1.Ex12.m1.3.3.1.1.6.3" xref="A1.Ex12.m1.3.3.1.1.6.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex12.m1.3.3.1.1.2c" xref="A1.Ex12.m1.3.3.1.1.2.cmml">​</mo><mrow id="A1.Ex12.m1.3.3.1.1.1.1" xref="A1.Ex12.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex12.m1.3.3.1.1.1.1.2" xref="A1.Ex12.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex12.m1.3.3.1.1.1.1.1" xref="A1.Ex12.m1.3.3.1.1.1.1.1.cmml"><msub id="A1.Ex12.m1.3.3.1.1.1.1.1.2" xref="A1.Ex12.m1.3.3.1.1.1.1.1.2.cmml"><mi id="A1.Ex12.m1.3.3.1.1.1.1.1.2.2" xref="A1.Ex12.m1.3.3.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.Ex12.m1.3.3.1.1.1.1.1.2.3" xref="A1.Ex12.m1.3.3.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex12.m1.3.3.1.1.1.1.1.1" xref="A1.Ex12.m1.3.3.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.Ex12.m1.3.3.1.1.1.1.1.3.2" xref="A1.Ex12.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex12.m1.3.3.1.1.1.1.1.3.2.1" xref="A1.Ex12.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="A1.Ex12.m1.2.2" xref="A1.Ex12.m1.2.2.cmml">𝒙</mi><mo stretchy="false" id="A1.Ex12.m1.3.3.1.1.1.1.1.3.2.2" xref="A1.Ex12.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.Ex12.m1.3.3.1.1.1.1.3" xref="A1.Ex12.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex12.m1.3b"><apply id="A1.Ex12.m1.3.3.cmml" xref="A1.Ex12.m1.3.3"><eq id="A1.Ex12.m1.3.3.2.cmml" xref="A1.Ex12.m1.3.3.2"></eq><csymbol cd="latexml" id="A1.Ex12.m1.3.3.3.cmml" xref="A1.Ex12.m1.3.3.3">absent</csymbol><apply id="A1.Ex12.m1.3.3.1.cmml" xref="A1.Ex12.m1.3.3.1"><int id="A1.Ex12.m1.3.3.1.2.cmml" xref="A1.Ex12.m1.3.3.1.2"></int><apply id="A1.Ex12.m1.3.3.1.1.cmml" xref="A1.Ex12.m1.3.3.1.1"><times id="A1.Ex12.m1.3.3.1.1.2.cmml" xref="A1.Ex12.m1.3.3.1.1.2"></times><apply id="A1.Ex12.m1.3.3.1.1.3.cmml" xref="A1.Ex12.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="A1.Ex12.m1.3.3.1.1.3.1.cmml" xref="A1.Ex12.m1.3.3.1.1.3">subscript</csymbol><ci id="A1.Ex12.m1.3.3.1.1.3.2.cmml" xref="A1.Ex12.m1.3.3.1.1.3.2">𝑝</ci><ci id="A1.Ex12.m1.3.3.1.1.3.3.cmml" xref="A1.Ex12.m1.3.3.1.1.3.3">𝜽</ci></apply><ci id="A1.Ex12.m1.1.1.cmml" xref="A1.Ex12.m1.1.1">𝒙</ci><apply id="A1.Ex12.m1.3.3.1.1.5.cmml" xref="A1.Ex12.m1.3.3.1.1.5"><divide id="A1.Ex12.m1.3.3.1.1.5.1.cmml" xref="A1.Ex12.m1.3.3.1.1.5"></divide><partialdiff id="A1.Ex12.m1.3.3.1.1.5.2.cmml" xref="A1.Ex12.m1.3.3.1.1.5.2"></partialdiff><apply id="A1.Ex12.m1.3.3.1.1.5.3.cmml" xref="A1.Ex12.m1.3.3.1.1.5.3"><partialdiff id="A1.Ex12.m1.3.3.1.1.5.3.1.cmml" xref="A1.Ex12.m1.3.3.1.1.5.3.1"></partialdiff><ci id="A1.Ex12.m1.3.3.1.1.5.3.2.cmml" xref="A1.Ex12.m1.3.3.1.1.5.3.2">𝜽</ci></apply></apply><apply id="A1.Ex12.m1.3.3.1.1.6.cmml" xref="A1.Ex12.m1.3.3.1.1.6"><csymbol cd="ambiguous" id="A1.Ex12.m1.3.3.1.1.6.1.cmml" xref="A1.Ex12.m1.3.3.1.1.6">subscript</csymbol><ci id="A1.Ex12.m1.3.3.1.1.6.2.cmml" xref="A1.Ex12.m1.3.3.1.1.6.2">𝐸</ci><ci id="A1.Ex12.m1.3.3.1.1.6.3.cmml" xref="A1.Ex12.m1.3.3.1.1.6.3">𝜽</ci></apply><apply id="A1.Ex12.m1.3.3.1.1.1.1.1.cmml" xref="A1.Ex12.m1.3.3.1.1.1.1"><times id="A1.Ex12.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.Ex12.m1.3.3.1.1.1.1.1.1"></times><apply id="A1.Ex12.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.Ex12.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex12.m1.3.3.1.1.1.1.1.2.1.cmml" xref="A1.Ex12.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="A1.Ex12.m1.3.3.1.1.1.1.1.2.2.cmml" xref="A1.Ex12.m1.3.3.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.Ex12.m1.3.3.1.1.1.1.1.2.3.cmml" xref="A1.Ex12.m1.3.3.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.Ex12.m1.2.2.cmml" xref="A1.Ex12.m1.2.2">𝒙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex12.m1.3c">\displaystyle=\int p_{{\boldsymbol{\theta}}}({\boldsymbol{x}})\frac{\partial}{\partial{\boldsymbol{\theta}}}E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E15.m1.3" class="ltx_Math" alttext="\displaystyle=\mathbb{E}_{{\boldsymbol{x}}\sim p_{{\boldsymbol{\theta}}}({\boldsymbol{x}})}\left[\frac{\partial}{\partial{\boldsymbol{\theta}}}E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}))\right]\,," display="inline"><semantics id="A1.E15.m1.3a"><mrow id="A1.E15.m1.3.3.1" xref="A1.E15.m1.3.3.1.1.cmml"><mrow id="A1.E15.m1.3.3.1.1" xref="A1.E15.m1.3.3.1.1.cmml"><mi id="A1.E15.m1.3.3.1.1.3" xref="A1.E15.m1.3.3.1.1.3.cmml"></mi><mo id="A1.E15.m1.3.3.1.1.2" xref="A1.E15.m1.3.3.1.1.2.cmml">=</mo><mrow id="A1.E15.m1.3.3.1.1.1" xref="A1.E15.m1.3.3.1.1.1.cmml"><msub id="A1.E15.m1.3.3.1.1.1.3" xref="A1.E15.m1.3.3.1.1.1.3.cmml"><mi id="A1.E15.m1.3.3.1.1.1.3.2" xref="A1.E15.m1.3.3.1.1.1.3.2.cmml">𝔼</mi><mrow id="A1.E15.m1.1.1.1" xref="A1.E15.m1.1.1.1.cmml"><mi id="A1.E15.m1.1.1.1.3" xref="A1.E15.m1.1.1.1.3.cmml">𝒙</mi><mo id="A1.E15.m1.1.1.1.2" xref="A1.E15.m1.1.1.1.2.cmml">∼</mo><mrow id="A1.E15.m1.1.1.1.4" xref="A1.E15.m1.1.1.1.4.cmml"><msub id="A1.E15.m1.1.1.1.4.2" xref="A1.E15.m1.1.1.1.4.2.cmml"><mi id="A1.E15.m1.1.1.1.4.2.2" xref="A1.E15.m1.1.1.1.4.2.2.cmml">p</mi><mi id="A1.E15.m1.1.1.1.4.2.3" xref="A1.E15.m1.1.1.1.4.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.E15.m1.1.1.1.4.1" xref="A1.E15.m1.1.1.1.4.1.cmml">​</mo><mrow id="A1.E15.m1.1.1.1.4.3.2" xref="A1.E15.m1.1.1.1.4.cmml"><mo stretchy="false" id="A1.E15.m1.1.1.1.4.3.2.1" xref="A1.E15.m1.1.1.1.4.cmml">(</mo><mi id="A1.E15.m1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.cmml">𝒙</mi><mo stretchy="false" id="A1.E15.m1.1.1.1.4.3.2.2" xref="A1.E15.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E15.m1.3.3.1.1.1.2" xref="A1.E15.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="A1.E15.m1.3.3.1.1.1.1.1" xref="A1.E15.m1.3.3.1.1.1.1.2.cmml"><mo id="A1.E15.m1.3.3.1.1.1.1.1.2" xref="A1.E15.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E15.m1.3.3.1.1.1.1.1.1" xref="A1.E15.m1.3.3.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E15.m1.3.3.1.1.1.1.1.1.3" xref="A1.E15.m1.3.3.1.1.1.1.1.1.3.cmml"><mfrac id="A1.E15.m1.3.3.1.1.1.1.1.1.3a" xref="A1.E15.m1.3.3.1.1.1.1.1.1.3.cmml"><mo id="A1.E15.m1.3.3.1.1.1.1.1.1.3.2" xref="A1.E15.m1.3.3.1.1.1.1.1.1.3.2.cmml">∂</mo><mrow id="A1.E15.m1.3.3.1.1.1.1.1.1.3.3" xref="A1.E15.m1.3.3.1.1.1.1.1.1.3.3.cmml"><mo rspace="0em" id="A1.E15.m1.3.3.1.1.1.1.1.1.3.3.1" xref="A1.E15.m1.3.3.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="A1.E15.m1.3.3.1.1.1.1.1.1.3.3.2" xref="A1.E15.m1.3.3.1.1.1.1.1.1.3.3.2.cmml">𝜽</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A1.E15.m1.3.3.1.1.1.1.1.1.2" xref="A1.E15.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><msub id="A1.E15.m1.3.3.1.1.1.1.1.1.4" xref="A1.E15.m1.3.3.1.1.1.1.1.1.4.cmml"><mi id="A1.E15.m1.3.3.1.1.1.1.1.1.4.2" xref="A1.E15.m1.3.3.1.1.1.1.1.1.4.2.cmml">E</mi><mi id="A1.E15.m1.3.3.1.1.1.1.1.1.4.3" xref="A1.E15.m1.3.3.1.1.1.1.1.1.4.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.E15.m1.3.3.1.1.1.1.1.1.2a" xref="A1.E15.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.2" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.1" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E15.m1.2.2" xref="A1.E15.m1.2.2.cmml">𝒙</mi><mo stretchy="false" id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.3" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.170em" id="A1.E15.m1.3.3.1.1.1.1.1.3" xref="A1.E15.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.E15.m1.3.3.1.2" xref="A1.E15.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E15.m1.3b"><apply id="A1.E15.m1.3.3.1.1.cmml" xref="A1.E15.m1.3.3.1"><eq id="A1.E15.m1.3.3.1.1.2.cmml" xref="A1.E15.m1.3.3.1.1.2"></eq><csymbol cd="latexml" id="A1.E15.m1.3.3.1.1.3.cmml" xref="A1.E15.m1.3.3.1.1.3">absent</csymbol><apply id="A1.E15.m1.3.3.1.1.1.cmml" xref="A1.E15.m1.3.3.1.1.1"><times id="A1.E15.m1.3.3.1.1.1.2.cmml" xref="A1.E15.m1.3.3.1.1.1.2"></times><apply id="A1.E15.m1.3.3.1.1.1.3.cmml" xref="A1.E15.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.E15.m1.3.3.1.1.1.3.1.cmml" xref="A1.E15.m1.3.3.1.1.1.3">subscript</csymbol><ci id="A1.E15.m1.3.3.1.1.1.3.2.cmml" xref="A1.E15.m1.3.3.1.1.1.3.2">𝔼</ci><apply id="A1.E15.m1.1.1.1.cmml" xref="A1.E15.m1.1.1.1"><csymbol cd="latexml" id="A1.E15.m1.1.1.1.2.cmml" xref="A1.E15.m1.1.1.1.2">similar-to</csymbol><ci id="A1.E15.m1.1.1.1.3.cmml" xref="A1.E15.m1.1.1.1.3">𝒙</ci><apply id="A1.E15.m1.1.1.1.4.cmml" xref="A1.E15.m1.1.1.1.4"><times id="A1.E15.m1.1.1.1.4.1.cmml" xref="A1.E15.m1.1.1.1.4.1"></times><apply id="A1.E15.m1.1.1.1.4.2.cmml" xref="A1.E15.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="A1.E15.m1.1.1.1.4.2.1.cmml" xref="A1.E15.m1.1.1.1.4.2">subscript</csymbol><ci id="A1.E15.m1.1.1.1.4.2.2.cmml" xref="A1.E15.m1.1.1.1.4.2.2">𝑝</ci><ci id="A1.E15.m1.1.1.1.4.2.3.cmml" xref="A1.E15.m1.1.1.1.4.2.3">𝜽</ci></apply><ci id="A1.E15.m1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1">𝒙</ci></apply></apply></apply><apply id="A1.E15.m1.3.3.1.1.1.1.2.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="A1.E15.m1.3.3.1.1.1.1.2.1.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E15.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1"><times id="A1.E15.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.2"></times><apply id="A1.E15.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.3"><divide id="A1.E15.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.3"></divide><partialdiff id="A1.E15.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.3.2"></partialdiff><apply id="A1.E15.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.3.3"><partialdiff id="A1.E15.m1.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="A1.E15.m1.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.3.3.2">𝜽</ci></apply></apply><apply id="A1.E15.m1.3.3.1.1.1.1.1.1.4.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E15.m1.3.3.1.1.1.1.1.1.4.1.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.4">subscript</csymbol><ci id="A1.E15.m1.3.3.1.1.1.1.1.1.4.2.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.4.2">𝐸</ci><ci id="A1.E15.m1.3.3.1.1.1.1.1.1.4.3.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.4.3">𝜽</ci></apply><apply id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1"><times id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.1"></times><apply id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E15.m1.3.3.1.1.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><ci id="A1.E15.m1.2.2.cmml" xref="A1.E15.m1.2.2">𝒙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.3c">\displaystyle=\mathbb{E}_{{\boldsymbol{x}}\sim p_{{\boldsymbol{\theta}}}({\boldsymbol{x}})}\left[\frac{\partial}{\partial{\boldsymbol{\theta}}}E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}))\right]\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="A1.p1.3" class="ltx_p">Thus, the gradient of the log probability is:</p>
<table id="A1.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E16.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial\log p_{{\boldsymbol{\theta}}}({\boldsymbol{x}})}{\partial{\boldsymbol{\theta}}}" display="inline"><semantics id="A1.E16.m1.1a"><mstyle displaystyle="true" id="A1.E16.m1.1.1" xref="A1.E16.m1.1.1.cmml"><mfrac id="A1.E16.m1.1.1a" xref="A1.E16.m1.1.1.cmml"><mrow id="A1.E16.m1.1.1.1" xref="A1.E16.m1.1.1.1.cmml"><mo mathsize="90%" rspace="0.167em" id="A1.E16.m1.1.1.1.2" xref="A1.E16.m1.1.1.1.2.cmml">∂</mo><mrow id="A1.E16.m1.1.1.1.3" xref="A1.E16.m1.1.1.1.3.cmml"><mrow id="A1.E16.m1.1.1.1.3.2" xref="A1.E16.m1.1.1.1.3.2.cmml"><mi mathsize="90%" id="A1.E16.m1.1.1.1.3.2.1" xref="A1.E16.m1.1.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="A1.E16.m1.1.1.1.3.2a" xref="A1.E16.m1.1.1.1.3.2.cmml">⁡</mo><msub id="A1.E16.m1.1.1.1.3.2.2" xref="A1.E16.m1.1.1.1.3.2.2.cmml"><mi mathsize="90%" id="A1.E16.m1.1.1.1.3.2.2.2" xref="A1.E16.m1.1.1.1.3.2.2.2.cmml">p</mi><mi mathsize="90%" id="A1.E16.m1.1.1.1.3.2.2.3" xref="A1.E16.m1.1.1.1.3.2.2.3.cmml">𝜽</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A1.E16.m1.1.1.1.3.1" xref="A1.E16.m1.1.1.1.3.1.cmml">​</mo><mrow id="A1.E16.m1.1.1.1.3.3.2" xref="A1.E16.m1.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="A1.E16.m1.1.1.1.3.3.2.1" xref="A1.E16.m1.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="A1.E16.m1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.cmml">𝒙</mi><mo maxsize="90%" minsize="90%" id="A1.E16.m1.1.1.1.3.3.2.2" xref="A1.E16.m1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="A1.E16.m1.1.1.3" xref="A1.E16.m1.1.1.3.cmml"><mo mathsize="90%" rspace="0em" id="A1.E16.m1.1.1.3.1" xref="A1.E16.m1.1.1.3.1.cmml">∂</mo><mi mathsize="90%" id="A1.E16.m1.1.1.3.2" xref="A1.E16.m1.1.1.3.2.cmml">𝜽</mi></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A1.E16.m1.1b"><apply id="A1.E16.m1.1.1.cmml" xref="A1.E16.m1.1.1"><divide id="A1.E16.m1.1.1.2.cmml" xref="A1.E16.m1.1.1"></divide><apply id="A1.E16.m1.1.1.1.cmml" xref="A1.E16.m1.1.1.1"><partialdiff id="A1.E16.m1.1.1.1.2.cmml" xref="A1.E16.m1.1.1.1.2"></partialdiff><apply id="A1.E16.m1.1.1.1.3.cmml" xref="A1.E16.m1.1.1.1.3"><times id="A1.E16.m1.1.1.1.3.1.cmml" xref="A1.E16.m1.1.1.1.3.1"></times><apply id="A1.E16.m1.1.1.1.3.2.cmml" xref="A1.E16.m1.1.1.1.3.2"><log id="A1.E16.m1.1.1.1.3.2.1.cmml" xref="A1.E16.m1.1.1.1.3.2.1"></log><apply id="A1.E16.m1.1.1.1.3.2.2.cmml" xref="A1.E16.m1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E16.m1.1.1.1.3.2.2.1.cmml" xref="A1.E16.m1.1.1.1.3.2.2">subscript</csymbol><ci id="A1.E16.m1.1.1.1.3.2.2.2.cmml" xref="A1.E16.m1.1.1.1.3.2.2.2">𝑝</ci><ci id="A1.E16.m1.1.1.1.3.2.2.3.cmml" xref="A1.E16.m1.1.1.1.3.2.2.3">𝜽</ci></apply></apply><ci id="A1.E16.m1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1">𝒙</ci></apply></apply><apply id="A1.E16.m1.1.1.3.cmml" xref="A1.E16.m1.1.1.3"><partialdiff id="A1.E16.m1.1.1.3.1.cmml" xref="A1.E16.m1.1.1.3.1"></partialdiff><ci id="A1.E16.m1.1.1.3.2.cmml" xref="A1.E16.m1.1.1.3.2">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.1c">\displaystyle\frac{\partial\log p_{{\boldsymbol{\theta}}}({\boldsymbol{x}})}{\partial{\boldsymbol{\theta}}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.E16.m2.4" class="ltx_math_unparsed" alttext="\displaystyle=\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}{\partial{\boldsymbol{\theta}}}-\mathbb{E}_{{\boldsymbol{x}}^{\prime}\sim p_{{\boldsymbol{\theta}}}({\boldsymbol{x}}^{\prime})}\left[\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}^{\prime}))}{\partial{\boldsymbol{\theta}}}\right]\,," display="inline"><semantics id="A1.E16.m2.4a"><mrow id="A1.E16.m2.4.4.1"><mrow id="A1.E16.m2.4.4.1.1"><mi id="A1.E16.m2.4.4.1.1.2"></mi><mo mathsize="90%" id="A1.E16.m2.4.4.1.1.1">=</mo><mrow id="A1.E16.m2.4.4.1.1.3"><mstyle displaystyle="true" id="A1.E16.m2.1.1"><mfrac id="A1.E16.m2.1.1a"><mrow id="A1.E16.m2.1.1.1"><mo mathsize="90%" rspace="0em" id="A1.E16.m2.1.1.1.2">∂</mo><msub id="A1.E16.m2.1.1.1.3"><mi mathsize="90%" id="A1.E16.m2.1.1.1.3.2">E</mi><mi mathsize="90%" id="A1.E16.m2.1.1.1.3.3">𝜽</mi></msub><mrow id="A1.E16.m2.1.1.1.4"><mo maxsize="90%" minsize="90%" id="A1.E16.m2.1.1.1.4.1">(</mo><msub id="A1.E16.m2.1.1.1.4.2"><mi mathsize="90%" id="A1.E16.m2.1.1.1.4.2.2">f</mi><mi mathsize="90%" id="A1.E16.m2.1.1.1.4.2.3">𝜽</mi></msub><mrow id="A1.E16.m2.1.1.1.4.3"><mo maxsize="90%" minsize="90%" id="A1.E16.m2.1.1.1.4.3.1">(</mo><mi mathsize="90%" id="A1.E16.m2.1.1.1.1">𝒙</mi><mo maxsize="90%" minsize="90%" id="A1.E16.m2.1.1.1.4.3.2">)</mo></mrow><mo maxsize="90%" minsize="90%" id="A1.E16.m2.1.1.1.4.4">)</mo></mrow><mo maxsize="90%" minsize="90%" id="A1.E16.m2.1.1.1.5">)</mo></mrow><mrow id="A1.E16.m2.1.1.3"><mo mathsize="90%" rspace="0em" id="A1.E16.m2.1.1.3.1">∂</mo><mi mathsize="90%" id="A1.E16.m2.1.1.3.2">𝜽</mi></mrow></mfrac></mstyle><mo mathsize="90%" id="A1.E16.m2.4.4.1.1.3.1">−</mo><mrow id="A1.E16.m2.4.4.1.1.3.2"><msub id="A1.E16.m2.4.4.1.1.3.2.2"><mi mathsize="90%" id="A1.E16.m2.4.4.1.1.3.2.2.2">𝔼</mi><mrow id="A1.E16.m2.2.2.1"><msup id="A1.E16.m2.2.2.1.3"><mi mathsize="90%" id="A1.E16.m2.2.2.1.3.2">𝒙</mi><mo mathsize="90%" id="A1.E16.m2.2.2.1.3.3">′</mo></msup><mo mathsize="90%" id="A1.E16.m2.2.2.1.2">∼</mo><mrow id="A1.E16.m2.2.2.1.1"><msub id="A1.E16.m2.2.2.1.1.3"><mi mathsize="90%" id="A1.E16.m2.2.2.1.1.3.2">p</mi><mi mathsize="90%" id="A1.E16.m2.2.2.1.1.3.3">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.E16.m2.2.2.1.1.2">​</mo><mrow id="A1.E16.m2.2.2.1.1.1.1"><mo maxsize="90%" minsize="90%" id="A1.E16.m2.2.2.1.1.1.1.2">(</mo><msup id="A1.E16.m2.2.2.1.1.1.1.1"><mi mathsize="90%" id="A1.E16.m2.2.2.1.1.1.1.1.2">𝒙</mi><mo mathsize="90%" id="A1.E16.m2.2.2.1.1.1.1.1.3">′</mo></msup><mo maxsize="90%" minsize="90%" id="A1.E16.m2.2.2.1.1.1.1.3">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A1.E16.m2.4.4.1.1.3.2.1">​</mo><mrow id="A1.E16.m2.4.4.1.1.3.2.3.2"><mo id="A1.E16.m2.4.4.1.1.3.2.3.2.1">[</mo><mstyle displaystyle="true" id="A1.E16.m2.3.3"><mfrac id="A1.E16.m2.3.3a"><mrow id="A1.E16.m2.3.3.1"><mo mathsize="90%" rspace="0em" id="A1.E16.m2.3.3.1.2">∂</mo><mrow id="A1.E16.m2.3.3.1.1"><msub id="A1.E16.m2.3.3.1.1.3"><mi mathsize="90%" id="A1.E16.m2.3.3.1.1.3.2">E</mi><mi mathsize="90%" id="A1.E16.m2.3.3.1.1.3.3">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.E16.m2.3.3.1.1.2">​</mo><mrow id="A1.E16.m2.3.3.1.1.1.1"><mo maxsize="90%" minsize="90%" id="A1.E16.m2.3.3.1.1.1.1.2">(</mo><mrow id="A1.E16.m2.3.3.1.1.1.1.1"><msub id="A1.E16.m2.3.3.1.1.1.1.1.3"><mi mathsize="90%" id="A1.E16.m2.3.3.1.1.1.1.1.3.2">f</mi><mi mathsize="90%" id="A1.E16.m2.3.3.1.1.1.1.1.3.3">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.E16.m2.3.3.1.1.1.1.1.2">​</mo><mrow id="A1.E16.m2.3.3.1.1.1.1.1.1.1"><mo maxsize="90%" minsize="90%" id="A1.E16.m2.3.3.1.1.1.1.1.1.1.2">(</mo><msup id="A1.E16.m2.3.3.1.1.1.1.1.1.1.1"><mi mathsize="90%" id="A1.E16.m2.3.3.1.1.1.1.1.1.1.1.2">𝒙</mi><mo mathsize="90%" id="A1.E16.m2.3.3.1.1.1.1.1.1.1.1.3">′</mo></msup><mo maxsize="90%" minsize="90%" id="A1.E16.m2.3.3.1.1.1.1.1.1.1.3">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="A1.E16.m2.3.3.1.1.1.1.3">)</mo></mrow></mrow></mrow><mrow id="A1.E16.m2.3.3.3"><mo mathsize="90%" rspace="0em" id="A1.E16.m2.3.3.3.1">∂</mo><mi mathsize="90%" id="A1.E16.m2.3.3.3.2">𝜽</mi></mrow></mfrac></mstyle><mo rspace="0.170em" id="A1.E16.m2.4.4.1.1.3.2.3.2.2">]</mo></mrow></mrow></mrow></mrow><mo mathsize="90%" id="A1.E16.m2.4.4.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="A1.E16.m2.4b">\displaystyle=\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}})))}{\partial{\boldsymbol{\theta}}}-\mathbb{E}_{{\boldsymbol{x}}^{\prime}\sim p_{{\boldsymbol{\theta}}}({\boldsymbol{x}}^{\prime})}\left[\frac{\partial E_{{\boldsymbol{\theta}}}(f_{{\boldsymbol{\theta}}}({\boldsymbol{x}}^{\prime}))}{\partial{\boldsymbol{\theta}}}\right]\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2206.14354" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2206.14355" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2206.14355">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2206.14355" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2206.14356" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Mar 11 19:52:31 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
