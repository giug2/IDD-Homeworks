<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Efficient Retrieval with Learned Similarities</title>
<!--Generated on Wed Aug 14 00:56:58 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2407.15462v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S1" title="In Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S2" title="In Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Expressiveness of Mixture of Logits</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S2.SS0.SSS0.Px1" title="In 2 Expressiveness of Mixture of Logits ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Mixture of Logits (MoL)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S3" title="In Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Retrieval Algorithms</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S3.SS1" title="In 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Exact algorithm</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S3.SS2" title="In 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Approximate algorithms</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S3.SS2.SSS0.Px1" title="In 3.2 Approximate algorithms ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Top <math alttext="K" class="ltx_Math" display="inline"><semantics><mi>K</mi><annotation-xml encoding="MathML-Content"><ci>𝐾</ci></annotation-xml><annotation encoding="application/x-tex">K</annotation><annotation encoding="application/x-llamapun">italic_K</annotation></semantics></math> per embedding.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S3.SS2.SSS0.Px2" title="In 3.2 Approximate algorithms ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Top <math alttext="K" class="ltx_Math" display="inline"><semantics><mi>K</mi><annotation-xml encoding="MathML-Content"><ci>𝐾</ci></annotation-xml><annotation encoding="application/x-tex">K</annotation><annotation encoding="application/x-llamapun">italic_K</annotation></semantics></math> average.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S3.SS2.SSS0.Px3" title="In 3.2 Approximate algorithms ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Combined top <math alttext="K" class="ltx_Math" display="inline"><semantics><mi>K</mi><annotation-xml encoding="MathML-Content"><ci>𝐾</ci></annotation-xml><annotation encoding="application/x-tex">K</annotation><annotation encoding="application/x-llamapun">italic_K</annotation></semantics></math>.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4" title="In Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.SS1" title="In 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.SS1.SSS0.Px1" title="In 4.1 Setup ‣ 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Workloads.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.SS1.SSS0.Px2" title="In 4.1 Setup ‣ 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Model.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.SS1.SSS0.Px3" title="In 4.1 Setup ‣ 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Metrics.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.SS2" title="In 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Top <math alttext="K" class="ltx_Math" display="inline"><semantics><mi>K</mi><annotation-xml encoding="MathML-Content"><ci>𝐾</ci></annotation-xml><annotation encoding="application/x-tex">K</annotation><annotation encoding="application/x-llamapun">italic_K</annotation></semantics></math> retrieval performance</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S5" title="In Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S5.SS0.SSS0.Px1" title="In 5 Related work ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Similarity Functions in Retrieval.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S5.SS0.SSS0.Px2" title="In 5 Related work ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Efficient Nearest Neighbor Search (NNS).</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S6" title="In Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#A1" title="In Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Experiment Setups</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#A1.SS0.SSS0.Px1" title="In Appendix A Experiment Setups ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Reproducibility.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#A1.SS0.SSS0.Px2" title="In Appendix A Experiment Setups ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Parameterization of low-rank (“component-level”) embeddings, <math alttext="f_{p}(q)" class="ltx_Math" display="inline"><semantics><mrow><msub><mi>f</mi><mi>p</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply><times></times><apply><csymbol cd="ambiguous">subscript</csymbol><ci>𝑓</ci><ci>𝑝</ci></apply><ci>𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex">f_{p}(q)</annotation><annotation encoding="application/x-llamapun">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math> and <math alttext="g_{p}(x)" class="ltx_Math" display="inline"><semantics><mrow><msub><mi>g</mi><mi>p</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply><times></times><apply><csymbol cd="ambiguous">subscript</csymbol><ci>𝑔</ci><ci>𝑝</ci></apply><ci>𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex">g_{p}(x)</annotation><annotation encoding="application/x-llamapun">italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math>s for <math alttext="1\leq p\leq P" class="ltx_Math" display="inline"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>p</mi><mo>≤</mo><mi>P</mi></mrow><annotation-xml encoding="MathML-Content"><apply><and></and><apply><leq></leq><cn type="integer">1</cn><ci>𝑝</ci></apply><apply><leq></leq><share></share><ci>𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex">1\leq p\leq P</annotation><annotation encoding="application/x-llamapun">1 ≤ italic_p ≤ italic_P</annotation></semantics></math>.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#A1.SS0.SSS0.Px3" title="In Appendix A Experiment Setups ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Parameterization of <math alttext="\pi_{p}(q,x)" class="ltx_Math" display="inline"><semantics><mrow><msub><mi>π</mi><mi>p</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply><times></times><apply><csymbol cd="ambiguous">subscript</csymbol><ci>𝜋</ci><ci>𝑝</ci></apply><interval closure="open"><ci>𝑞</ci><ci>𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex">\pi_{p}(q,x)</annotation><annotation encoding="application/x-llamapun">italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q , italic_x )</annotation></semantics></math> matrices.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#A1.SS0.SSS0.Px4" title="In Appendix A Experiment Setups ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Hyperparameter settings.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#A1.SS1" title="In Appendix A Experiment Setups ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Efficiency</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#A1.SS1.SSS0.Px1" title="In A.1 Efficiency ‣ Appendix A Experiment Setups ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Training efficiency.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#A1.SS1.SSS0.Px2" title="In A.1 Efficiency ‣ Appendix A Experiment Setups ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_title">Inference efficiency.</span></a></li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Efficient Retrieval with Learned Similarities</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Bailu Ding
<br class="ltx_break"/>Microsoft Research
<br class="ltx_break"/>USA
<br class="ltx_break"/><a class="ltx_ref ltx_url ltx_font_typewriter" href="badin@microsoft.com" title="">badin@microsoft.com</a>
&amp;Jiaqi Zhai<span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotemark: </span></span></span></span>
<br class="ltx_break"/>Meta 
<br class="ltx_break"/>USA 
<br class="ltx_break"/><a class="ltx_ref ltx_url ltx_font_typewriter" href="jiaqiz@meta.com" title="">jiaqiz@meta.com</a>
<br class="ltx_break"/>
</span><span class="ltx_author_notes">Equal contribution.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id3.3">Retrieval plays a fundamental role in recommendation systems, search, and natural language processing by efficiently finding relevant items from a large corpus given a query. Dot products have been widely used as the similarity function in such retrieval tasks, thanks to Maximum Inner Product Search (MIPS) that enabled efficient retrieval based on dot products. However, state-of-the-art retrieval algorithms have migrated to learned similarities. Such algorithms vary in form; the queries can be represented with multiple embeddings, complex neural networks can be deployed, the item ids can be decoded directly from queries using beam search, and multiple approaches can be combined in hybrid solutions. Unfortunately, we lack efficient solutions for retrieval in these state-of-the-art setups. Our work investigates techniques for approximate nearest neighbor search with learned similarity functions. We first prove that Mixture-of-Logits (MoL) is a universal approximator, and can express all learned similarity functions. We next propose techniques to retrieve the approximate top <math alttext="K" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><mi id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><ci id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">italic_K</annotation></semantics></math> results using MoL with a tight bound. We finally compare our techniques with existing approaches, showing that MoL sets new state-of-the-art results on recommendation retrieval tasks, and our approximate top-k retrieval with learned similarities outperforms baselines by up to <math alttext="91\times" class="ltx_math_unparsed" display="inline" id="id2.2.m2.1"><semantics id="id2.2.m2.1a"><mrow id="id2.2.m2.1b"><mn id="id2.2.m2.1.1">91</mn><mo id="id2.2.m2.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="id2.2.m2.1c">91\times</annotation><annotation encoding="application/x-llamapun" id="id2.2.m2.1d">91 ×</annotation></semantics></math> in latency, while achieving <math alttext="&gt;.99" class="ltx_Math" display="inline" id="id3.3.m3.1"><semantics id="id3.3.m3.1a"><mrow id="id3.3.m3.1.1" xref="id3.3.m3.1.1.cmml"><mi id="id3.3.m3.1.1.2" xref="id3.3.m3.1.1.2.cmml"></mi><mo id="id3.3.m3.1.1.1" xref="id3.3.m3.1.1.1.cmml">&gt;</mo><mn id="id3.3.m3.1.1.3" xref="id3.3.m3.1.1.3.cmml">.99</mn></mrow><annotation-xml encoding="MathML-Content" id="id3.3.m3.1b"><apply id="id3.3.m3.1.1.cmml" xref="id3.3.m3.1.1"><gt id="id3.3.m3.1.1.1.cmml" xref="id3.3.m3.1.1.1"></gt><csymbol cd="latexml" id="id3.3.m3.1.1.2.cmml" xref="id3.3.m3.1.1.2">absent</csymbol><cn id="id3.3.m3.1.1.3.cmml" type="float" xref="id3.3.m3.1.1.3">.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m3.1c">&gt;.99</annotation><annotation encoding="application/x-llamapun" id="id3.3.m3.1d">&gt; .99</annotation></semantics></math> recall rate of exact algorithms.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Retrieval requires efficient storing, indexing, and querying relevant candidate items represented by high-dimensional vectors. Retrieval is widely used as the initial preprocessing stage for applications such as recommendations and natural language processing that operate over corpus with up to billions of items <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib2" title="">2</a>]</cite>.  In many concrete use cases, such as vector databases <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib19" title="">19</a>]</cite>, the query- and the item- embeddings are learned with deep neural networks in a dual-encoder setup, and dot products are applied on top of such embeddings as the similarity function for measuring relevance.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite the popularity of dot products and numerous work done to improve their efficiency <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib4" title="">4</a>]</cite>, state-of-the-art retrieval algorithms have long moved to various learned similarity functions. Their most basic versions preserve some dot product-related structures, but turn either the query or the item into multiple embeddings, and rely on a max operator to combine those similarity values <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib22" title="">22</a>]</cite>. As another example, Probabilistic Label Trees (PLTs) <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib16" title="">16</a>]</cite> and Tree-based Deep Models (TDMs) <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib46" title="">46</a>]</cite> map items to leaf nodes in a tree, and reduce retrieval to beam search by making decisions sequentially using learned classifiers while traversing trees from root to leaf. More recent work on generative retrieval in recommendations and natural language processing directly map the query to the item ids in sequence-to-sequence or decoder-only setups <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib40" title="">40</a>]</cite>. Combinations of these approaches have also been studied, with some performing coarse-grained retrieval with generative approaches, followed by re-ranking using dot products <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib8" title="">8</a>]</cite>. Finally, the similarity function can be directly parameterized by carefully designed deep neural networks that take various forms <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Supporting efficient retrieval with these diverse learned similarities is challenging. Learned similarity functions are generally expensive to compute; with learned index structures, traversing a binary tree with 4 million items requires running beam search for 20 non-parallelizable steps <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite>, while recommendation and NLP deployments commonly need to handle billions of items <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite> with low end-to-end latency. When an arbitrary deep neural network is employed, it’s no longer clear how to perform top-<math alttext="K" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_K</annotation></semantics></math> retrieval other than through brute-force <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib14" title="">14</a>]</cite> or heuristics <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite>. What is worse, these algorithms vary significantly in terms of their exact formulations, and the lack of a universal interface  makes it even more difficult for designing a general solution for efficient retrieval.
</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.6">Taking a step back, our key insight is that learned similarity approaches are but different ways to increase expressiveness of the retrieval stage. Formally, for a query <math alttext="q" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mi id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">italic_q</annotation></semantics></math> and an item <math alttext="x" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mi id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">italic_x</annotation></semantics></math>, the expressiveness of the similarity function boils down to deriving alternative parameterizations of <math alttext="p(x|q)" class="ltx_Math" display="inline" id="S1.p4.3.m3.1"><semantics id="S1.p4.3.m3.1a"><mrow id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml"><mi id="S1.p4.3.m3.1.1.3" xref="S1.p4.3.m3.1.1.3.cmml">p</mi><mo id="S1.p4.3.m3.1.1.2" xref="S1.p4.3.m3.1.1.2.cmml">⁢</mo><mrow id="S1.p4.3.m3.1.1.1.1" xref="S1.p4.3.m3.1.1.1.1.1.cmml"><mo id="S1.p4.3.m3.1.1.1.1.2" stretchy="false" xref="S1.p4.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S1.p4.3.m3.1.1.1.1.1" xref="S1.p4.3.m3.1.1.1.1.1.cmml"><mi id="S1.p4.3.m3.1.1.1.1.1.2" xref="S1.p4.3.m3.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S1.p4.3.m3.1.1.1.1.1.1" xref="S1.p4.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S1.p4.3.m3.1.1.1.1.1.3" xref="S1.p4.3.m3.1.1.1.1.1.3.cmml">q</mi></mrow><mo id="S1.p4.3.m3.1.1.1.1.3" stretchy="false" xref="S1.p4.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><apply id="S1.p4.3.m3.1.1.cmml" xref="S1.p4.3.m3.1.1"><times id="S1.p4.3.m3.1.1.2.cmml" xref="S1.p4.3.m3.1.1.2"></times><ci id="S1.p4.3.m3.1.1.3.cmml" xref="S1.p4.3.m3.1.1.3">𝑝</ci><apply id="S1.p4.3.m3.1.1.1.1.1.cmml" xref="S1.p4.3.m3.1.1.1.1"><csymbol cd="latexml" id="S1.p4.3.m3.1.1.1.1.1.1.cmml" xref="S1.p4.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p4.3.m3.1.1.1.1.1.2.cmml" xref="S1.p4.3.m3.1.1.1.1.1.2">𝑥</ci><ci id="S1.p4.3.m3.1.1.1.1.1.3.cmml" xref="S1.p4.3.m3.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">p(x|q)</annotation><annotation encoding="application/x-llamapun" id="S1.p4.3.m3.1d">italic_p ( italic_x | italic_q )</annotation></semantics></math> matrices, with full rank matrices being the most expressive among them. Dot products, on the other hand, induces a low-rank bottleneck due to the dimensionality of the embedding, i.e., <math alttext="\ln p(x|q)\propto\langle f(q),g(x)\rangle" class="ltx_Math" display="inline" id="S1.p4.4.m4.5"><semantics id="S1.p4.4.m4.5a"><mrow id="S1.p4.4.m4.5.5" xref="S1.p4.4.m4.5.5.cmml"><mrow id="S1.p4.4.m4.3.3.1" xref="S1.p4.4.m4.3.3.1.cmml"><mrow id="S1.p4.4.m4.3.3.1.3" xref="S1.p4.4.m4.3.3.1.3.cmml"><mi id="S1.p4.4.m4.3.3.1.3.1" xref="S1.p4.4.m4.3.3.1.3.1.cmml">ln</mi><mo id="S1.p4.4.m4.3.3.1.3a" lspace="0.167em" xref="S1.p4.4.m4.3.3.1.3.cmml">⁡</mo><mi id="S1.p4.4.m4.3.3.1.3.2" xref="S1.p4.4.m4.3.3.1.3.2.cmml">p</mi></mrow><mo id="S1.p4.4.m4.3.3.1.2" xref="S1.p4.4.m4.3.3.1.2.cmml">⁢</mo><mrow id="S1.p4.4.m4.3.3.1.1.1" xref="S1.p4.4.m4.3.3.1.1.1.1.cmml"><mo id="S1.p4.4.m4.3.3.1.1.1.2" stretchy="false" xref="S1.p4.4.m4.3.3.1.1.1.1.cmml">(</mo><mrow id="S1.p4.4.m4.3.3.1.1.1.1" xref="S1.p4.4.m4.3.3.1.1.1.1.cmml"><mi id="S1.p4.4.m4.3.3.1.1.1.1.2" xref="S1.p4.4.m4.3.3.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S1.p4.4.m4.3.3.1.1.1.1.1" xref="S1.p4.4.m4.3.3.1.1.1.1.1.cmml">|</mo><mi id="S1.p4.4.m4.3.3.1.1.1.1.3" xref="S1.p4.4.m4.3.3.1.1.1.1.3.cmml">q</mi></mrow><mo id="S1.p4.4.m4.3.3.1.1.1.3" stretchy="false" xref="S1.p4.4.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S1.p4.4.m4.5.5.4" xref="S1.p4.4.m4.5.5.4.cmml">∝</mo><mrow id="S1.p4.4.m4.5.5.3.2" xref="S1.p4.4.m4.5.5.3.3.cmml"><mo id="S1.p4.4.m4.5.5.3.2.3" stretchy="false" xref="S1.p4.4.m4.5.5.3.3.cmml">⟨</mo><mrow id="S1.p4.4.m4.4.4.2.1.1" xref="S1.p4.4.m4.4.4.2.1.1.cmml"><mi id="S1.p4.4.m4.4.4.2.1.1.2" xref="S1.p4.4.m4.4.4.2.1.1.2.cmml">f</mi><mo id="S1.p4.4.m4.4.4.2.1.1.1" xref="S1.p4.4.m4.4.4.2.1.1.1.cmml">⁢</mo><mrow id="S1.p4.4.m4.4.4.2.1.1.3.2" xref="S1.p4.4.m4.4.4.2.1.1.cmml"><mo id="S1.p4.4.m4.4.4.2.1.1.3.2.1" stretchy="false" xref="S1.p4.4.m4.4.4.2.1.1.cmml">(</mo><mi id="S1.p4.4.m4.1.1" xref="S1.p4.4.m4.1.1.cmml">q</mi><mo id="S1.p4.4.m4.4.4.2.1.1.3.2.2" stretchy="false" xref="S1.p4.4.m4.4.4.2.1.1.cmml">)</mo></mrow></mrow><mo id="S1.p4.4.m4.5.5.3.2.4" xref="S1.p4.4.m4.5.5.3.3.cmml">,</mo><mrow id="S1.p4.4.m4.5.5.3.2.2" xref="S1.p4.4.m4.5.5.3.2.2.cmml"><mi id="S1.p4.4.m4.5.5.3.2.2.2" xref="S1.p4.4.m4.5.5.3.2.2.2.cmml">g</mi><mo id="S1.p4.4.m4.5.5.3.2.2.1" xref="S1.p4.4.m4.5.5.3.2.2.1.cmml">⁢</mo><mrow id="S1.p4.4.m4.5.5.3.2.2.3.2" xref="S1.p4.4.m4.5.5.3.2.2.cmml"><mo id="S1.p4.4.m4.5.5.3.2.2.3.2.1" stretchy="false" xref="S1.p4.4.m4.5.5.3.2.2.cmml">(</mo><mi id="S1.p4.4.m4.2.2" xref="S1.p4.4.m4.2.2.cmml">x</mi><mo id="S1.p4.4.m4.5.5.3.2.2.3.2.2" stretchy="false" xref="S1.p4.4.m4.5.5.3.2.2.cmml">)</mo></mrow></mrow><mo id="S1.p4.4.m4.5.5.3.2.5" stretchy="false" xref="S1.p4.4.m4.5.5.3.3.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.4.m4.5b"><apply id="S1.p4.4.m4.5.5.cmml" xref="S1.p4.4.m4.5.5"><csymbol cd="latexml" id="S1.p4.4.m4.5.5.4.cmml" xref="S1.p4.4.m4.5.5.4">proportional-to</csymbol><apply id="S1.p4.4.m4.3.3.1.cmml" xref="S1.p4.4.m4.3.3.1"><times id="S1.p4.4.m4.3.3.1.2.cmml" xref="S1.p4.4.m4.3.3.1.2"></times><apply id="S1.p4.4.m4.3.3.1.3.cmml" xref="S1.p4.4.m4.3.3.1.3"><ln id="S1.p4.4.m4.3.3.1.3.1.cmml" xref="S1.p4.4.m4.3.3.1.3.1"></ln><ci id="S1.p4.4.m4.3.3.1.3.2.cmml" xref="S1.p4.4.m4.3.3.1.3.2">𝑝</ci></apply><apply id="S1.p4.4.m4.3.3.1.1.1.1.cmml" xref="S1.p4.4.m4.3.3.1.1.1"><csymbol cd="latexml" id="S1.p4.4.m4.3.3.1.1.1.1.1.cmml" xref="S1.p4.4.m4.3.3.1.1.1.1.1">conditional</csymbol><ci id="S1.p4.4.m4.3.3.1.1.1.1.2.cmml" xref="S1.p4.4.m4.3.3.1.1.1.1.2">𝑥</ci><ci id="S1.p4.4.m4.3.3.1.1.1.1.3.cmml" xref="S1.p4.4.m4.3.3.1.1.1.1.3">𝑞</ci></apply></apply><list id="S1.p4.4.m4.5.5.3.3.cmml" xref="S1.p4.4.m4.5.5.3.2"><apply id="S1.p4.4.m4.4.4.2.1.1.cmml" xref="S1.p4.4.m4.4.4.2.1.1"><times id="S1.p4.4.m4.4.4.2.1.1.1.cmml" xref="S1.p4.4.m4.4.4.2.1.1.1"></times><ci id="S1.p4.4.m4.4.4.2.1.1.2.cmml" xref="S1.p4.4.m4.4.4.2.1.1.2">𝑓</ci><ci id="S1.p4.4.m4.1.1.cmml" xref="S1.p4.4.m4.1.1">𝑞</ci></apply><apply id="S1.p4.4.m4.5.5.3.2.2.cmml" xref="S1.p4.4.m4.5.5.3.2.2"><times id="S1.p4.4.m4.5.5.3.2.2.1.cmml" xref="S1.p4.4.m4.5.5.3.2.2.1"></times><ci id="S1.p4.4.m4.5.5.3.2.2.2.cmml" xref="S1.p4.4.m4.5.5.3.2.2.2">𝑔</ci><ci id="S1.p4.4.m4.2.2.cmml" xref="S1.p4.4.m4.2.2">𝑥</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.m4.5c">\ln p(x|q)\propto\langle f(q),g(x)\rangle</annotation><annotation encoding="application/x-llamapun" id="S1.p4.4.m4.5d">roman_ln italic_p ( italic_x | italic_q ) ∝ ⟨ italic_f ( italic_q ) , italic_g ( italic_x ) ⟩</annotation></semantics></math> (<math alttext="f(q),g(x)\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S1.p4.5.m5.4"><semantics id="S1.p4.5.m5.4a"><mrow id="S1.p4.5.m5.4.4" xref="S1.p4.5.m5.4.4.cmml"><mrow id="S1.p4.5.m5.4.4.2.2" xref="S1.p4.5.m5.4.4.2.3.cmml"><mrow id="S1.p4.5.m5.3.3.1.1.1" xref="S1.p4.5.m5.3.3.1.1.1.cmml"><mi id="S1.p4.5.m5.3.3.1.1.1.2" xref="S1.p4.5.m5.3.3.1.1.1.2.cmml">f</mi><mo id="S1.p4.5.m5.3.3.1.1.1.1" xref="S1.p4.5.m5.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S1.p4.5.m5.3.3.1.1.1.3.2" xref="S1.p4.5.m5.3.3.1.1.1.cmml"><mo id="S1.p4.5.m5.3.3.1.1.1.3.2.1" stretchy="false" xref="S1.p4.5.m5.3.3.1.1.1.cmml">(</mo><mi id="S1.p4.5.m5.1.1" xref="S1.p4.5.m5.1.1.cmml">q</mi><mo id="S1.p4.5.m5.3.3.1.1.1.3.2.2" stretchy="false" xref="S1.p4.5.m5.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S1.p4.5.m5.4.4.2.2.3" xref="S1.p4.5.m5.4.4.2.3.cmml">,</mo><mrow id="S1.p4.5.m5.4.4.2.2.2" xref="S1.p4.5.m5.4.4.2.2.2.cmml"><mi id="S1.p4.5.m5.4.4.2.2.2.2" xref="S1.p4.5.m5.4.4.2.2.2.2.cmml">g</mi><mo id="S1.p4.5.m5.4.4.2.2.2.1" xref="S1.p4.5.m5.4.4.2.2.2.1.cmml">⁢</mo><mrow id="S1.p4.5.m5.4.4.2.2.2.3.2" xref="S1.p4.5.m5.4.4.2.2.2.cmml"><mo id="S1.p4.5.m5.4.4.2.2.2.3.2.1" stretchy="false" xref="S1.p4.5.m5.4.4.2.2.2.cmml">(</mo><mi id="S1.p4.5.m5.2.2" xref="S1.p4.5.m5.2.2.cmml">x</mi><mo id="S1.p4.5.m5.4.4.2.2.2.3.2.2" stretchy="false" xref="S1.p4.5.m5.4.4.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S1.p4.5.m5.4.4.3" xref="S1.p4.5.m5.4.4.3.cmml">∈</mo><msup id="S1.p4.5.m5.4.4.4" xref="S1.p4.5.m5.4.4.4.cmml"><mi id="S1.p4.5.m5.4.4.4.2" xref="S1.p4.5.m5.4.4.4.2.cmml">ℝ</mi><mi id="S1.p4.5.m5.4.4.4.3" xref="S1.p4.5.m5.4.4.4.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.5.m5.4b"><apply id="S1.p4.5.m5.4.4.cmml" xref="S1.p4.5.m5.4.4"><in id="S1.p4.5.m5.4.4.3.cmml" xref="S1.p4.5.m5.4.4.3"></in><list id="S1.p4.5.m5.4.4.2.3.cmml" xref="S1.p4.5.m5.4.4.2.2"><apply id="S1.p4.5.m5.3.3.1.1.1.cmml" xref="S1.p4.5.m5.3.3.1.1.1"><times id="S1.p4.5.m5.3.3.1.1.1.1.cmml" xref="S1.p4.5.m5.3.3.1.1.1.1"></times><ci id="S1.p4.5.m5.3.3.1.1.1.2.cmml" xref="S1.p4.5.m5.3.3.1.1.1.2">𝑓</ci><ci id="S1.p4.5.m5.1.1.cmml" xref="S1.p4.5.m5.1.1">𝑞</ci></apply><apply id="S1.p4.5.m5.4.4.2.2.2.cmml" xref="S1.p4.5.m5.4.4.2.2.2"><times id="S1.p4.5.m5.4.4.2.2.2.1.cmml" xref="S1.p4.5.m5.4.4.2.2.2.1"></times><ci id="S1.p4.5.m5.4.4.2.2.2.2.cmml" xref="S1.p4.5.m5.4.4.2.2.2.2">𝑔</ci><ci id="S1.p4.5.m5.2.2.cmml" xref="S1.p4.5.m5.2.2">𝑥</ci></apply></list><apply id="S1.p4.5.m5.4.4.4.cmml" xref="S1.p4.5.m5.4.4.4"><csymbol cd="ambiguous" id="S1.p4.5.m5.4.4.4.1.cmml" xref="S1.p4.5.m5.4.4.4">superscript</csymbol><ci id="S1.p4.5.m5.4.4.4.2.cmml" xref="S1.p4.5.m5.4.4.4.2">ℝ</ci><ci id="S1.p4.5.m5.4.4.4.3.cmml" xref="S1.p4.5.m5.4.4.4.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.5.m5.4c">f(q),g(x)\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.5.m5.4d">italic_f ( italic_q ) , italic_g ( italic_x ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>). This cannot be alleviated by simply increasing the embedding dimension <math alttext="d" class="ltx_Math" display="inline" id="S1.p4.6.m6.1"><semantics id="S1.p4.6.m6.1a"><mi id="S1.p4.6.m6.1.1" xref="S1.p4.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S1.p4.6.m6.1b"><ci id="S1.p4.6.m6.1.1.cmml" xref="S1.p4.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.6.m6.1c">d</annotation><annotation encoding="application/x-llamapun" id="S1.p4.6.m6.1d">italic_d</annotation></semantics></math>, due to memory bandwidth being the main bottleneck in modern dot-product based retrieval systems, such as vector databases <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib4" title="">4</a>]</cite>, and overfitting issues that come with larger embedding dimensions due to the need to co-train query- and item- encoders from data <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib43" title="">43</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.4">This insight enables us to support efficient retrieval with learned similarity functions by approximating them with MoL.
To the best of our knowledge, this is the first work that tackles the problem of efficient retrieval with universal learned similarities.
We first show that Mixture-of-Logits (MoL) is a universal approximator as it can express <math alttext="p(x|q)" class="ltx_Math" display="inline" id="S1.p5.1.m1.1"><semantics id="S1.p5.1.m1.1a"><mrow id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml"><mi id="S1.p5.1.m1.1.1.3" xref="S1.p5.1.m1.1.1.3.cmml">p</mi><mo id="S1.p5.1.m1.1.1.2" xref="S1.p5.1.m1.1.1.2.cmml">⁢</mo><mrow id="S1.p5.1.m1.1.1.1.1" xref="S1.p5.1.m1.1.1.1.1.1.cmml"><mo id="S1.p5.1.m1.1.1.1.1.2" stretchy="false" xref="S1.p5.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S1.p5.1.m1.1.1.1.1.1" xref="S1.p5.1.m1.1.1.1.1.1.cmml"><mi id="S1.p5.1.m1.1.1.1.1.1.2" xref="S1.p5.1.m1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S1.p5.1.m1.1.1.1.1.1.1" xref="S1.p5.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S1.p5.1.m1.1.1.1.1.1.3" xref="S1.p5.1.m1.1.1.1.1.1.3.cmml">q</mi></mrow><mo id="S1.p5.1.m1.1.1.1.1.3" stretchy="false" xref="S1.p5.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><apply id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1"><times id="S1.p5.1.m1.1.1.2.cmml" xref="S1.p5.1.m1.1.1.2"></times><ci id="S1.p5.1.m1.1.1.3.cmml" xref="S1.p5.1.m1.1.1.3">𝑝</ci><apply id="S1.p5.1.m1.1.1.1.1.1.cmml" xref="S1.p5.1.m1.1.1.1.1"><csymbol cd="latexml" id="S1.p5.1.m1.1.1.1.1.1.1.cmml" xref="S1.p5.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p5.1.m1.1.1.1.1.1.2.cmml" xref="S1.p5.1.m1.1.1.1.1.1.2">𝑥</ci><ci id="S1.p5.1.m1.1.1.1.1.1.3.cmml" xref="S1.p5.1.m1.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">p(x|q)</annotation><annotation encoding="application/x-llamapun" id="S1.p5.1.m1.1d">italic_p ( italic_x | italic_q )</annotation></semantics></math> matrices of arbitrary high rank, and hence approximate all learned similarity functions. Compared with prior work on learned similarities <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib38" title="">38</a>]</cite> which often fail to outperform dot product baselines in large-scale settings <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib36" title="">36</a>]</cite>, our work lays theoretical foundations for MoL’s empirical impressive performance gains of 20%-30% across Hit Rate@50-400 on corpus with hundreds of millions to billions of items <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite>.
We next propose techniques to retrieve the approximate top-<math alttext="K" class="ltx_Math" display="inline" id="S1.p5.2.m2.1"><semantics id="S1.p5.2.m2.1a"><mi id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b"><ci id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S1.p5.2.m2.1d">italic_K</annotation></semantics></math> results using MoL with a tight bound.
Our solution leverages existing widely used APIs of vector databases like top-K queries, thus benefiting from prior work on efficient vector search like MIPS <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib12" title="">12</a>]</cite>.
We empirically compare our techniques with existing approaches, showing that MoL sets new state-of-the-art results on recommendation retrieval tasks, and our approximate top-k retrieval with learned similarities outperforms baselines by up to <math alttext="91\times" class="ltx_math_unparsed" display="inline" id="S1.p5.3.m3.1"><semantics id="S1.p5.3.m3.1a"><mrow id="S1.p5.3.m3.1b"><mn id="S1.p5.3.m3.1.1">91</mn><mo id="S1.p5.3.m3.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S1.p5.3.m3.1c">91\times</annotation><annotation encoding="application/x-llamapun" id="S1.p5.3.m3.1d">91 ×</annotation></semantics></math> in latency, while achieving <math alttext="&gt;.99" class="ltx_Math" display="inline" id="S1.p5.4.m4.1"><semantics id="S1.p5.4.m4.1a"><mrow id="S1.p5.4.m4.1.1" xref="S1.p5.4.m4.1.1.cmml"><mi id="S1.p5.4.m4.1.1.2" xref="S1.p5.4.m4.1.1.2.cmml"></mi><mo id="S1.p5.4.m4.1.1.1" xref="S1.p5.4.m4.1.1.1.cmml">&gt;</mo><mn id="S1.p5.4.m4.1.1.3" xref="S1.p5.4.m4.1.1.3.cmml">.99</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.4.m4.1b"><apply id="S1.p5.4.m4.1.1.cmml" xref="S1.p5.4.m4.1.1"><gt id="S1.p5.4.m4.1.1.1.cmml" xref="S1.p5.4.m4.1.1.1"></gt><csymbol cd="latexml" id="S1.p5.4.m4.1.1.2.cmml" xref="S1.p5.4.m4.1.1.2">absent</csymbol><cn id="S1.p5.4.m4.1.1.3.cmml" type="float" xref="S1.p5.4.m4.1.1.3">.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.4.m4.1c">&gt;.99</annotation><annotation encoding="application/x-llamapun" id="S1.p5.4.m4.1d">&gt; .99</annotation></semantics></math> recall rate of exact algorithms. Importantly, our approach with learned similarities efficiently utilizes modern accelerators due to MoL’s higher arithmetic intensity <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite>, which results in MIPS-level inference latency and throughput. This concludes both theoretical and practical justifications to migrate away from the broadly adopted MIPS solution in vector databases to Retriev<span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p5.4.1">a</span>l w<span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p5.4.2">i</span>th Learned Similarities (RAILS) on GPUs.

</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Expressiveness of Mixture of Logits</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we describe Mixture of Logits (MoL) and show that MoL is expressive enough to represent any learned similarity function. Table <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S2.T1" title="Table 1 ‣ 2 Expressiveness of Mixture of Logits ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the notations in this paper.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">We first describe the learned similarity function with Mixture of Logits (MoL).</p>
</div>
<figure class="ltx_table" id="S2.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S2.T1.34.34">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T1.34.34.35.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S2.T1.34.34.35.1.1"><span class="ltx_text ltx_font_bold" id="S2.T1.34.34.35.1.1.1" style="font-size:90%;">Notation</span></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S2.T1.34.34.35.1.2"><span class="ltx_text ltx_font_bold" id="S2.T1.34.34.35.1.2.1" style="font-size:90%;">Description</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.3.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S2.T1.3.3.3.3">
<math alttext="q" class="ltx_Math" display="inline" id="S2.T1.1.1.1.1.m1.1"><semantics id="S2.T1.1.1.1.1.m1.1a"><mi id="S2.T1.1.1.1.1.m1.1.1" mathsize="90%" xref="S2.T1.1.1.1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.T1.1.1.1.1.m1.1b"><ci id="S2.T1.1.1.1.1.m1.1.1.cmml" xref="S2.T1.1.1.1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.1.1.1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.T1.1.1.1.1.m1.1d">italic_q</annotation></semantics></math><span class="ltx_text" id="S2.T1.3.3.3.3.1" style="font-size:90%;"> (</span><math alttext="Q" class="ltx_Math" display="inline" id="S2.T1.2.2.2.2.m2.1"><semantics id="S2.T1.2.2.2.2.m2.1a"><mi id="S2.T1.2.2.2.2.m2.1.1" mathsize="90%" xref="S2.T1.2.2.2.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.T1.2.2.2.2.m2.1b"><ci id="S2.T1.2.2.2.2.m2.1.1.cmml" xref="S2.T1.2.2.2.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.2.2.2.2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.T1.2.2.2.2.m2.1d">italic_Q</annotation></semantics></math><span class="ltx_text" id="S2.T1.3.3.3.3.2" style="font-size:90%;">, </span><math alttext="|Q|" class="ltx_Math" display="inline" id="S2.T1.3.3.3.3.m3.1"><semantics id="S2.T1.3.3.3.3.m3.1a"><mrow id="S2.T1.3.3.3.3.m3.1.2.2" xref="S2.T1.3.3.3.3.m3.1.2.1.cmml"><mo id="S2.T1.3.3.3.3.m3.1.2.2.1" maxsize="90%" minsize="90%" xref="S2.T1.3.3.3.3.m3.1.2.1.1.cmml">|</mo><mi id="S2.T1.3.3.3.3.m3.1.1" mathsize="90%" xref="S2.T1.3.3.3.3.m3.1.1.cmml">Q</mi><mo id="S2.T1.3.3.3.3.m3.1.2.2.2" maxsize="90%" minsize="90%" xref="S2.T1.3.3.3.3.m3.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.3.3.3.3.m3.1b"><apply id="S2.T1.3.3.3.3.m3.1.2.1.cmml" xref="S2.T1.3.3.3.3.m3.1.2.2"><abs id="S2.T1.3.3.3.3.m3.1.2.1.1.cmml" xref="S2.T1.3.3.3.3.m3.1.2.2.1"></abs><ci id="S2.T1.3.3.3.3.m3.1.1.cmml" xref="S2.T1.3.3.3.3.m3.1.1">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.3.3.3.3.m3.1c">|Q|</annotation><annotation encoding="application/x-llamapun" id="S2.T1.3.3.3.3.m3.1d">| italic_Q |</annotation></semantics></math><span class="ltx_text" id="S2.T1.3.3.3.3.3" style="font-size:90%;">)</span>
</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S2.T1.3.3.3.4"><span class="ltx_text" id="S2.T1.3.3.3.4.1" style="font-size:90%;">query (set of queries, number of queries)</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.6.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S2.T1.6.6.6.3">
<math alttext="x" class="ltx_Math" display="inline" id="S2.T1.4.4.4.1.m1.1"><semantics id="S2.T1.4.4.4.1.m1.1a"><mi id="S2.T1.4.4.4.1.m1.1.1" mathsize="90%" xref="S2.T1.4.4.4.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.T1.4.4.4.1.m1.1b"><ci id="S2.T1.4.4.4.1.m1.1.1.cmml" xref="S2.T1.4.4.4.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.4.4.4.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.T1.4.4.4.1.m1.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="S2.T1.6.6.6.3.1" style="font-size:90%;"> (</span><math alttext="X" class="ltx_Math" display="inline" id="S2.T1.5.5.5.2.m2.1"><semantics id="S2.T1.5.5.5.2.m2.1a"><mi id="S2.T1.5.5.5.2.m2.1.1" mathsize="90%" xref="S2.T1.5.5.5.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.T1.5.5.5.2.m2.1b"><ci id="S2.T1.5.5.5.2.m2.1.1.cmml" xref="S2.T1.5.5.5.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.5.5.5.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.T1.5.5.5.2.m2.1d">italic_X</annotation></semantics></math><span class="ltx_text" id="S2.T1.6.6.6.3.2" style="font-size:90%;">, </span><math alttext="|X|" class="ltx_Math" display="inline" id="S2.T1.6.6.6.3.m3.1"><semantics id="S2.T1.6.6.6.3.m3.1a"><mrow id="S2.T1.6.6.6.3.m3.1.2.2" xref="S2.T1.6.6.6.3.m3.1.2.1.cmml"><mo id="S2.T1.6.6.6.3.m3.1.2.2.1" maxsize="90%" minsize="90%" xref="S2.T1.6.6.6.3.m3.1.2.1.1.cmml">|</mo><mi id="S2.T1.6.6.6.3.m3.1.1" mathsize="90%" xref="S2.T1.6.6.6.3.m3.1.1.cmml">X</mi><mo id="S2.T1.6.6.6.3.m3.1.2.2.2" maxsize="90%" minsize="90%" xref="S2.T1.6.6.6.3.m3.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.6.6.6.3.m3.1b"><apply id="S2.T1.6.6.6.3.m3.1.2.1.cmml" xref="S2.T1.6.6.6.3.m3.1.2.2"><abs id="S2.T1.6.6.6.3.m3.1.2.1.1.cmml" xref="S2.T1.6.6.6.3.m3.1.2.2.1"></abs><ci id="S2.T1.6.6.6.3.m3.1.1.cmml" xref="S2.T1.6.6.6.3.m3.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.6.6.6.3.m3.1c">|X|</annotation><annotation encoding="application/x-llamapun" id="S2.T1.6.6.6.3.m3.1d">| italic_X |</annotation></semantics></math><span class="ltx_text" id="S2.T1.6.6.6.3.3" style="font-size:90%;">)</span>
</th>
<td class="ltx_td ltx_align_left" id="S2.T1.6.6.6.4"><span class="ltx_text" id="S2.T1.6.6.6.4.1" style="font-size:90%;">item (set of items, number of items)</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.7.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S2.T1.7.7.7.1"><math alttext="\phi(q,x)" class="ltx_Math" display="inline" id="S2.T1.7.7.7.1.m1.2"><semantics id="S2.T1.7.7.7.1.m1.2a"><mrow id="S2.T1.7.7.7.1.m1.2.3" xref="S2.T1.7.7.7.1.m1.2.3.cmml"><mi id="S2.T1.7.7.7.1.m1.2.3.2" mathsize="90%" xref="S2.T1.7.7.7.1.m1.2.3.2.cmml">ϕ</mi><mo id="S2.T1.7.7.7.1.m1.2.3.1" xref="S2.T1.7.7.7.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.T1.7.7.7.1.m1.2.3.3.2" xref="S2.T1.7.7.7.1.m1.2.3.3.1.cmml"><mo id="S2.T1.7.7.7.1.m1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.7.7.7.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.T1.7.7.7.1.m1.1.1" mathsize="90%" xref="S2.T1.7.7.7.1.m1.1.1.cmml">q</mi><mo id="S2.T1.7.7.7.1.m1.2.3.3.2.2" mathsize="90%" xref="S2.T1.7.7.7.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.T1.7.7.7.1.m1.2.2" mathsize="90%" xref="S2.T1.7.7.7.1.m1.2.2.cmml">x</mi><mo id="S2.T1.7.7.7.1.m1.2.3.3.2.3" maxsize="90%" minsize="90%" xref="S2.T1.7.7.7.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.7.7.7.1.m1.2b"><apply id="S2.T1.7.7.7.1.m1.2.3.cmml" xref="S2.T1.7.7.7.1.m1.2.3"><times id="S2.T1.7.7.7.1.m1.2.3.1.cmml" xref="S2.T1.7.7.7.1.m1.2.3.1"></times><ci id="S2.T1.7.7.7.1.m1.2.3.2.cmml" xref="S2.T1.7.7.7.1.m1.2.3.2">italic-ϕ</ci><interval closure="open" id="S2.T1.7.7.7.1.m1.2.3.3.1.cmml" xref="S2.T1.7.7.7.1.m1.2.3.3.2"><ci id="S2.T1.7.7.7.1.m1.1.1.cmml" xref="S2.T1.7.7.7.1.m1.1.1">𝑞</ci><ci id="S2.T1.7.7.7.1.m1.2.2.cmml" xref="S2.T1.7.7.7.1.m1.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.7.7.7.1.m1.2c">\phi(q,x)</annotation><annotation encoding="application/x-llamapun" id="S2.T1.7.7.7.1.m1.2d">italic_ϕ ( italic_q , italic_x )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S2.T1.7.7.7.2"><span class="ltx_text" id="S2.T1.7.7.7.2.1" style="font-size:90%;">the learned similarity function, i.e., Mixture-of-Logits (MoL).</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.18.18.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S2.T1.10.10.10.3"><span class="ltx_text" id="S2.T1.10.10.10.3.3" style="font-size:90%;"><math alttext="P" class="ltx_Math" display="inline" id="S2.T1.8.8.8.1.1.m1.1"><semantics id="S2.T1.8.8.8.1.1.m1.1a"><mi id="S2.T1.8.8.8.1.1.m1.1.1" xref="S2.T1.8.8.8.1.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.T1.8.8.8.1.1.m1.1b"><ci id="S2.T1.8.8.8.1.1.m1.1.1.cmml" xref="S2.T1.8.8.8.1.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.8.8.8.1.1.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="S2.T1.8.8.8.1.1.m1.1d">italic_P</annotation></semantics></math> (<math alttext="P_{q}" class="ltx_Math" display="inline" id="S2.T1.9.9.9.2.2.m2.1"><semantics id="S2.T1.9.9.9.2.2.m2.1a"><msub id="S2.T1.9.9.9.2.2.m2.1.1" xref="S2.T1.9.9.9.2.2.m2.1.1.cmml"><mi id="S2.T1.9.9.9.2.2.m2.1.1.2" xref="S2.T1.9.9.9.2.2.m2.1.1.2.cmml">P</mi><mi id="S2.T1.9.9.9.2.2.m2.1.1.3" xref="S2.T1.9.9.9.2.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.T1.9.9.9.2.2.m2.1b"><apply id="S2.T1.9.9.9.2.2.m2.1.1.cmml" xref="S2.T1.9.9.9.2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.T1.9.9.9.2.2.m2.1.1.1.cmml" xref="S2.T1.9.9.9.2.2.m2.1.1">subscript</csymbol><ci id="S2.T1.9.9.9.2.2.m2.1.1.2.cmml" xref="S2.T1.9.9.9.2.2.m2.1.1.2">𝑃</ci><ci id="S2.T1.9.9.9.2.2.m2.1.1.3.cmml" xref="S2.T1.9.9.9.2.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.9.9.9.2.2.m2.1c">P_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.9.9.9.2.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="P_{x}" class="ltx_Math" display="inline" id="S2.T1.10.10.10.3.3.m3.1"><semantics id="S2.T1.10.10.10.3.3.m3.1a"><msub id="S2.T1.10.10.10.3.3.m3.1.1" xref="S2.T1.10.10.10.3.3.m3.1.1.cmml"><mi id="S2.T1.10.10.10.3.3.m3.1.1.2" xref="S2.T1.10.10.10.3.3.m3.1.1.2.cmml">P</mi><mi id="S2.T1.10.10.10.3.3.m3.1.1.3" xref="S2.T1.10.10.10.3.3.m3.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S2.T1.10.10.10.3.3.m3.1b"><apply id="S2.T1.10.10.10.3.3.m3.1.1.cmml" xref="S2.T1.10.10.10.3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.T1.10.10.10.3.3.m3.1.1.1.cmml" xref="S2.T1.10.10.10.3.3.m3.1.1">subscript</csymbol><ci id="S2.T1.10.10.10.3.3.m3.1.1.2.cmml" xref="S2.T1.10.10.10.3.3.m3.1.1.2">𝑃</ci><ci id="S2.T1.10.10.10.3.3.m3.1.1.3.cmml" xref="S2.T1.10.10.10.3.3.m3.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.10.10.10.3.3.m3.1c">P_{x}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.10.10.10.3.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math>)</span></th>
<td class="ltx_td ltx_align_left" id="S2.T1.18.18.18.11"><span class="ltx_text" id="S2.T1.18.18.18.11.8" style="font-size:90%;">MoL uses <math alttext="P" class="ltx_Math" display="inline" id="S2.T1.11.11.11.4.1.m1.1"><semantics id="S2.T1.11.11.11.4.1.m1.1a"><mi id="S2.T1.11.11.11.4.1.m1.1.1" xref="S2.T1.11.11.11.4.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.T1.11.11.11.4.1.m1.1b"><ci id="S2.T1.11.11.11.4.1.m1.1.1.cmml" xref="S2.T1.11.11.11.4.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.11.11.11.4.1.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="S2.T1.11.11.11.4.1.m1.1d">italic_P</annotation></semantics></math> low-rank embeddings ("component-level embeddings") to represent <math alttext="q" class="ltx_Math" display="inline" id="S2.T1.12.12.12.5.2.m2.1"><semantics id="S2.T1.12.12.12.5.2.m2.1a"><mi id="S2.T1.12.12.12.5.2.m2.1.1" xref="S2.T1.12.12.12.5.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.T1.12.12.12.5.2.m2.1b"><ci id="S2.T1.12.12.12.5.2.m2.1.1.cmml" xref="S2.T1.12.12.12.5.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.12.12.12.5.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.T1.12.12.12.5.2.m2.1d">italic_q</annotation></semantics></math> and <math alttext="x" class="ltx_Math" display="inline" id="S2.T1.13.13.13.6.3.m3.1"><semantics id="S2.T1.13.13.13.6.3.m3.1a"><mi id="S2.T1.13.13.13.6.3.m3.1.1" xref="S2.T1.13.13.13.6.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.T1.13.13.13.6.3.m3.1b"><ci id="S2.T1.13.13.13.6.3.m3.1.1.cmml" xref="S2.T1.13.13.13.6.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.13.13.13.6.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.T1.13.13.13.6.3.m3.1d">italic_x</annotation></semantics></math>. With the (batched) outer product form of MoL, <math alttext="P_{q}" class="ltx_Math" display="inline" id="S2.T1.14.14.14.7.4.m4.1"><semantics id="S2.T1.14.14.14.7.4.m4.1a"><msub id="S2.T1.14.14.14.7.4.m4.1.1" xref="S2.T1.14.14.14.7.4.m4.1.1.cmml"><mi id="S2.T1.14.14.14.7.4.m4.1.1.2" xref="S2.T1.14.14.14.7.4.m4.1.1.2.cmml">P</mi><mi id="S2.T1.14.14.14.7.4.m4.1.1.3" xref="S2.T1.14.14.14.7.4.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.T1.14.14.14.7.4.m4.1b"><apply id="S2.T1.14.14.14.7.4.m4.1.1.cmml" xref="S2.T1.14.14.14.7.4.m4.1.1"><csymbol cd="ambiguous" id="S2.T1.14.14.14.7.4.m4.1.1.1.cmml" xref="S2.T1.14.14.14.7.4.m4.1.1">subscript</csymbol><ci id="S2.T1.14.14.14.7.4.m4.1.1.2.cmml" xref="S2.T1.14.14.14.7.4.m4.1.1.2">𝑃</ci><ci id="S2.T1.14.14.14.7.4.m4.1.1.3.cmml" xref="S2.T1.14.14.14.7.4.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.14.14.14.7.4.m4.1c">P_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.14.14.14.7.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="P_{x}" class="ltx_Math" display="inline" id="S2.T1.15.15.15.8.5.m5.1"><semantics id="S2.T1.15.15.15.8.5.m5.1a"><msub id="S2.T1.15.15.15.8.5.m5.1.1" xref="S2.T1.15.15.15.8.5.m5.1.1.cmml"><mi id="S2.T1.15.15.15.8.5.m5.1.1.2" xref="S2.T1.15.15.15.8.5.m5.1.1.2.cmml">P</mi><mi id="S2.T1.15.15.15.8.5.m5.1.1.3" xref="S2.T1.15.15.15.8.5.m5.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S2.T1.15.15.15.8.5.m5.1b"><apply id="S2.T1.15.15.15.8.5.m5.1.1.cmml" xref="S2.T1.15.15.15.8.5.m5.1.1"><csymbol cd="ambiguous" id="S2.T1.15.15.15.8.5.m5.1.1.1.cmml" xref="S2.T1.15.15.15.8.5.m5.1.1">subscript</csymbol><ci id="S2.T1.15.15.15.8.5.m5.1.1.2.cmml" xref="S2.T1.15.15.15.8.5.m5.1.1.2">𝑃</ci><ci id="S2.T1.15.15.15.8.5.m5.1.1.3.cmml" xref="S2.T1.15.15.15.8.5.m5.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.15.15.15.8.5.m5.1c">P_{x}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.15.15.15.8.5.m5.1d">italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> are the numbers of embeddings for <math alttext="q" class="ltx_Math" display="inline" id="S2.T1.16.16.16.9.6.m6.1"><semantics id="S2.T1.16.16.16.9.6.m6.1a"><mi id="S2.T1.16.16.16.9.6.m6.1.1" xref="S2.T1.16.16.16.9.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.T1.16.16.16.9.6.m6.1b"><ci id="S2.T1.16.16.16.9.6.m6.1.1.cmml" xref="S2.T1.16.16.16.9.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.16.16.16.9.6.m6.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.T1.16.16.16.9.6.m6.1d">italic_q</annotation></semantics></math> and <math alttext="x" class="ltx_Math" display="inline" id="S2.T1.17.17.17.10.7.m7.1"><semantics id="S2.T1.17.17.17.10.7.m7.1a"><mi id="S2.T1.17.17.17.10.7.m7.1.1" xref="S2.T1.17.17.17.10.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.T1.17.17.17.10.7.m7.1b"><ci id="S2.T1.17.17.17.10.7.m7.1.1.cmml" xref="S2.T1.17.17.17.10.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.17.17.17.10.7.m7.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.T1.17.17.17.10.7.m7.1d">italic_x</annotation></semantics></math>, respectively, and <math alttext="P=P_{q}\times P_{x}" class="ltx_Math" display="inline" id="S2.T1.18.18.18.11.8.m8.1"><semantics id="S2.T1.18.18.18.11.8.m8.1a"><mrow id="S2.T1.18.18.18.11.8.m8.1.1" xref="S2.T1.18.18.18.11.8.m8.1.1.cmml"><mi id="S2.T1.18.18.18.11.8.m8.1.1.2" xref="S2.T1.18.18.18.11.8.m8.1.1.2.cmml">P</mi><mo id="S2.T1.18.18.18.11.8.m8.1.1.1" xref="S2.T1.18.18.18.11.8.m8.1.1.1.cmml">=</mo><mrow id="S2.T1.18.18.18.11.8.m8.1.1.3" xref="S2.T1.18.18.18.11.8.m8.1.1.3.cmml"><msub id="S2.T1.18.18.18.11.8.m8.1.1.3.2" xref="S2.T1.18.18.18.11.8.m8.1.1.3.2.cmml"><mi id="S2.T1.18.18.18.11.8.m8.1.1.3.2.2" xref="S2.T1.18.18.18.11.8.m8.1.1.3.2.2.cmml">P</mi><mi id="S2.T1.18.18.18.11.8.m8.1.1.3.2.3" xref="S2.T1.18.18.18.11.8.m8.1.1.3.2.3.cmml">q</mi></msub><mo id="S2.T1.18.18.18.11.8.m8.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.T1.18.18.18.11.8.m8.1.1.3.1.cmml">×</mo><msub id="S2.T1.18.18.18.11.8.m8.1.1.3.3" xref="S2.T1.18.18.18.11.8.m8.1.1.3.3.cmml"><mi id="S2.T1.18.18.18.11.8.m8.1.1.3.3.2" xref="S2.T1.18.18.18.11.8.m8.1.1.3.3.2.cmml">P</mi><mi id="S2.T1.18.18.18.11.8.m8.1.1.3.3.3" xref="S2.T1.18.18.18.11.8.m8.1.1.3.3.3.cmml">x</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.18.18.18.11.8.m8.1b"><apply id="S2.T1.18.18.18.11.8.m8.1.1.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1"><eq id="S2.T1.18.18.18.11.8.m8.1.1.1.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1.1"></eq><ci id="S2.T1.18.18.18.11.8.m8.1.1.2.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1.2">𝑃</ci><apply id="S2.T1.18.18.18.11.8.m8.1.1.3.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1.3"><times id="S2.T1.18.18.18.11.8.m8.1.1.3.1.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1.3.1"></times><apply id="S2.T1.18.18.18.11.8.m8.1.1.3.2.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="S2.T1.18.18.18.11.8.m8.1.1.3.2.1.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1.3.2">subscript</csymbol><ci id="S2.T1.18.18.18.11.8.m8.1.1.3.2.2.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1.3.2.2">𝑃</ci><ci id="S2.T1.18.18.18.11.8.m8.1.1.3.2.3.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1.3.2.3">𝑞</ci></apply><apply id="S2.T1.18.18.18.11.8.m8.1.1.3.3.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1.3.3"><csymbol cd="ambiguous" id="S2.T1.18.18.18.11.8.m8.1.1.3.3.1.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1.3.3">subscript</csymbol><ci id="S2.T1.18.18.18.11.8.m8.1.1.3.3.2.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1.3.3.2">𝑃</ci><ci id="S2.T1.18.18.18.11.8.m8.1.1.3.3.3.cmml" xref="S2.T1.18.18.18.11.8.m8.1.1.3.3.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.18.18.18.11.8.m8.1c">P=P_{q}\times P_{x}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.18.18.18.11.8.m8.1d">italic_P = italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT × italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math>.</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.24.24.24">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S2.T1.20.20.20.2">
<math alttext="\pi_{p}(q,x)" class="ltx_Math" display="inline" id="S2.T1.19.19.19.1.m1.2"><semantics id="S2.T1.19.19.19.1.m1.2a"><mrow id="S2.T1.19.19.19.1.m1.2.3" xref="S2.T1.19.19.19.1.m1.2.3.cmml"><msub id="S2.T1.19.19.19.1.m1.2.3.2" xref="S2.T1.19.19.19.1.m1.2.3.2.cmml"><mi id="S2.T1.19.19.19.1.m1.2.3.2.2" mathsize="90%" xref="S2.T1.19.19.19.1.m1.2.3.2.2.cmml">π</mi><mi id="S2.T1.19.19.19.1.m1.2.3.2.3" mathsize="90%" xref="S2.T1.19.19.19.1.m1.2.3.2.3.cmml">p</mi></msub><mo id="S2.T1.19.19.19.1.m1.2.3.1" xref="S2.T1.19.19.19.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.T1.19.19.19.1.m1.2.3.3.2" xref="S2.T1.19.19.19.1.m1.2.3.3.1.cmml"><mo id="S2.T1.19.19.19.1.m1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.19.19.19.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.T1.19.19.19.1.m1.1.1" mathsize="90%" xref="S2.T1.19.19.19.1.m1.1.1.cmml">q</mi><mo id="S2.T1.19.19.19.1.m1.2.3.3.2.2" mathsize="90%" xref="S2.T1.19.19.19.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.T1.19.19.19.1.m1.2.2" mathsize="90%" xref="S2.T1.19.19.19.1.m1.2.2.cmml">x</mi><mo id="S2.T1.19.19.19.1.m1.2.3.3.2.3" maxsize="90%" minsize="90%" xref="S2.T1.19.19.19.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.19.19.19.1.m1.2b"><apply id="S2.T1.19.19.19.1.m1.2.3.cmml" xref="S2.T1.19.19.19.1.m1.2.3"><times id="S2.T1.19.19.19.1.m1.2.3.1.cmml" xref="S2.T1.19.19.19.1.m1.2.3.1"></times><apply id="S2.T1.19.19.19.1.m1.2.3.2.cmml" xref="S2.T1.19.19.19.1.m1.2.3.2"><csymbol cd="ambiguous" id="S2.T1.19.19.19.1.m1.2.3.2.1.cmml" xref="S2.T1.19.19.19.1.m1.2.3.2">subscript</csymbol><ci id="S2.T1.19.19.19.1.m1.2.3.2.2.cmml" xref="S2.T1.19.19.19.1.m1.2.3.2.2">𝜋</ci><ci id="S2.T1.19.19.19.1.m1.2.3.2.3.cmml" xref="S2.T1.19.19.19.1.m1.2.3.2.3">𝑝</ci></apply><interval closure="open" id="S2.T1.19.19.19.1.m1.2.3.3.1.cmml" xref="S2.T1.19.19.19.1.m1.2.3.3.2"><ci id="S2.T1.19.19.19.1.m1.1.1.cmml" xref="S2.T1.19.19.19.1.m1.1.1">𝑞</ci><ci id="S2.T1.19.19.19.1.m1.2.2.cmml" xref="S2.T1.19.19.19.1.m1.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.19.19.19.1.m1.2c">\pi_{p}(q,x)</annotation><annotation encoding="application/x-llamapun" id="S2.T1.19.19.19.1.m1.2d">italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q , italic_x )</annotation></semantics></math><span class="ltx_text" id="S2.T1.20.20.20.2.1" style="font-size:90%;"> (</span><math alttext="\pi_{p_{q},p_{x}}(q,x)" class="ltx_Math" display="inline" id="S2.T1.20.20.20.2.m2.4"><semantics id="S2.T1.20.20.20.2.m2.4a"><mrow id="S2.T1.20.20.20.2.m2.4.5" xref="S2.T1.20.20.20.2.m2.4.5.cmml"><msub id="S2.T1.20.20.20.2.m2.4.5.2" xref="S2.T1.20.20.20.2.m2.4.5.2.cmml"><mi id="S2.T1.20.20.20.2.m2.4.5.2.2" mathsize="90%" xref="S2.T1.20.20.20.2.m2.4.5.2.2.cmml">π</mi><mrow id="S2.T1.20.20.20.2.m2.2.2.2.2" xref="S2.T1.20.20.20.2.m2.2.2.2.3.cmml"><msub id="S2.T1.20.20.20.2.m2.1.1.1.1.1" xref="S2.T1.20.20.20.2.m2.1.1.1.1.1.cmml"><mi id="S2.T1.20.20.20.2.m2.1.1.1.1.1.2" mathsize="90%" xref="S2.T1.20.20.20.2.m2.1.1.1.1.1.2.cmml">p</mi><mi id="S2.T1.20.20.20.2.m2.1.1.1.1.1.3" mathsize="90%" xref="S2.T1.20.20.20.2.m2.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S2.T1.20.20.20.2.m2.2.2.2.2.3" mathsize="90%" xref="S2.T1.20.20.20.2.m2.2.2.2.3.cmml">,</mo><msub id="S2.T1.20.20.20.2.m2.2.2.2.2.2" xref="S2.T1.20.20.20.2.m2.2.2.2.2.2.cmml"><mi id="S2.T1.20.20.20.2.m2.2.2.2.2.2.2" mathsize="90%" xref="S2.T1.20.20.20.2.m2.2.2.2.2.2.2.cmml">p</mi><mi id="S2.T1.20.20.20.2.m2.2.2.2.2.2.3" mathsize="90%" xref="S2.T1.20.20.20.2.m2.2.2.2.2.2.3.cmml">x</mi></msub></mrow></msub><mo id="S2.T1.20.20.20.2.m2.4.5.1" xref="S2.T1.20.20.20.2.m2.4.5.1.cmml">⁢</mo><mrow id="S2.T1.20.20.20.2.m2.4.5.3.2" xref="S2.T1.20.20.20.2.m2.4.5.3.1.cmml"><mo id="S2.T1.20.20.20.2.m2.4.5.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.20.20.20.2.m2.4.5.3.1.cmml">(</mo><mi id="S2.T1.20.20.20.2.m2.3.3" mathsize="90%" xref="S2.T1.20.20.20.2.m2.3.3.cmml">q</mi><mo id="S2.T1.20.20.20.2.m2.4.5.3.2.2" mathsize="90%" xref="S2.T1.20.20.20.2.m2.4.5.3.1.cmml">,</mo><mi id="S2.T1.20.20.20.2.m2.4.4" mathsize="90%" xref="S2.T1.20.20.20.2.m2.4.4.cmml">x</mi><mo id="S2.T1.20.20.20.2.m2.4.5.3.2.3" maxsize="90%" minsize="90%" xref="S2.T1.20.20.20.2.m2.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.20.20.20.2.m2.4b"><apply id="S2.T1.20.20.20.2.m2.4.5.cmml" xref="S2.T1.20.20.20.2.m2.4.5"><times id="S2.T1.20.20.20.2.m2.4.5.1.cmml" xref="S2.T1.20.20.20.2.m2.4.5.1"></times><apply id="S2.T1.20.20.20.2.m2.4.5.2.cmml" xref="S2.T1.20.20.20.2.m2.4.5.2"><csymbol cd="ambiguous" id="S2.T1.20.20.20.2.m2.4.5.2.1.cmml" xref="S2.T1.20.20.20.2.m2.4.5.2">subscript</csymbol><ci id="S2.T1.20.20.20.2.m2.4.5.2.2.cmml" xref="S2.T1.20.20.20.2.m2.4.5.2.2">𝜋</ci><list id="S2.T1.20.20.20.2.m2.2.2.2.3.cmml" xref="S2.T1.20.20.20.2.m2.2.2.2.2"><apply id="S2.T1.20.20.20.2.m2.1.1.1.1.1.cmml" xref="S2.T1.20.20.20.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.T1.20.20.20.2.m2.1.1.1.1.1.1.cmml" xref="S2.T1.20.20.20.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.T1.20.20.20.2.m2.1.1.1.1.1.2.cmml" xref="S2.T1.20.20.20.2.m2.1.1.1.1.1.2">𝑝</ci><ci id="S2.T1.20.20.20.2.m2.1.1.1.1.1.3.cmml" xref="S2.T1.20.20.20.2.m2.1.1.1.1.1.3">𝑞</ci></apply><apply id="S2.T1.20.20.20.2.m2.2.2.2.2.2.cmml" xref="S2.T1.20.20.20.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.T1.20.20.20.2.m2.2.2.2.2.2.1.cmml" xref="S2.T1.20.20.20.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S2.T1.20.20.20.2.m2.2.2.2.2.2.2.cmml" xref="S2.T1.20.20.20.2.m2.2.2.2.2.2.2">𝑝</ci><ci id="S2.T1.20.20.20.2.m2.2.2.2.2.2.3.cmml" xref="S2.T1.20.20.20.2.m2.2.2.2.2.2.3">𝑥</ci></apply></list></apply><interval closure="open" id="S2.T1.20.20.20.2.m2.4.5.3.1.cmml" xref="S2.T1.20.20.20.2.m2.4.5.3.2"><ci id="S2.T1.20.20.20.2.m2.3.3.cmml" xref="S2.T1.20.20.20.2.m2.3.3">𝑞</ci><ci id="S2.T1.20.20.20.2.m2.4.4.cmml" xref="S2.T1.20.20.20.2.m2.4.4">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.20.20.20.2.m2.4c">\pi_{p_{q},p_{x}}(q,x)</annotation><annotation encoding="application/x-llamapun" id="S2.T1.20.20.20.2.m2.4d">italic_π start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_q , italic_x )</annotation></semantics></math><span class="ltx_text" id="S2.T1.20.20.20.2.2" style="font-size:90%;">)</span>
</th>
<td class="ltx_td ltx_align_left" id="S2.T1.24.24.24.6">
<span class="ltx_text" id="S2.T1.24.24.24.6.1" style="font-size:90%;">weight for the </span><math alttext="p" class="ltx_Math" display="inline" id="S2.T1.21.21.21.3.m1.1"><semantics id="S2.T1.21.21.21.3.m1.1a"><mi id="S2.T1.21.21.21.3.m1.1.1" mathsize="90%" xref="S2.T1.21.21.21.3.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.T1.21.21.21.3.m1.1b"><ci id="S2.T1.21.21.21.3.m1.1.1.cmml" xref="S2.T1.21.21.21.3.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.21.21.21.3.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.T1.21.21.21.3.m1.1d">italic_p</annotation></semantics></math><span class="ltx_text" id="S2.T1.24.24.24.6.2" style="font-size:90%;">-th (or </span><math alttext="p_{q}" class="ltx_Math" display="inline" id="S2.T1.22.22.22.4.m2.1"><semantics id="S2.T1.22.22.22.4.m2.1a"><msub id="S2.T1.22.22.22.4.m2.1.1" xref="S2.T1.22.22.22.4.m2.1.1.cmml"><mi id="S2.T1.22.22.22.4.m2.1.1.2" mathsize="90%" xref="S2.T1.22.22.22.4.m2.1.1.2.cmml">p</mi><mi id="S2.T1.22.22.22.4.m2.1.1.3" mathsize="90%" xref="S2.T1.22.22.22.4.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.T1.22.22.22.4.m2.1b"><apply id="S2.T1.22.22.22.4.m2.1.1.cmml" xref="S2.T1.22.22.22.4.m2.1.1"><csymbol cd="ambiguous" id="S2.T1.22.22.22.4.m2.1.1.1.cmml" xref="S2.T1.22.22.22.4.m2.1.1">subscript</csymbol><ci id="S2.T1.22.22.22.4.m2.1.1.2.cmml" xref="S2.T1.22.22.22.4.m2.1.1.2">𝑝</ci><ci id="S2.T1.22.22.22.4.m2.1.1.3.cmml" xref="S2.T1.22.22.22.4.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.22.22.22.4.m2.1c">p_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.22.22.22.4.m2.1d">italic_p start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="S2.T1.24.24.24.6.3" style="font-size:90%;">-th by </span><math alttext="p_{x}" class="ltx_Math" display="inline" id="S2.T1.23.23.23.5.m3.1"><semantics id="S2.T1.23.23.23.5.m3.1a"><msub id="S2.T1.23.23.23.5.m3.1.1" xref="S2.T1.23.23.23.5.m3.1.1.cmml"><mi id="S2.T1.23.23.23.5.m3.1.1.2" mathsize="90%" xref="S2.T1.23.23.23.5.m3.1.1.2.cmml">p</mi><mi id="S2.T1.23.23.23.5.m3.1.1.3" mathsize="90%" xref="S2.T1.23.23.23.5.m3.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S2.T1.23.23.23.5.m3.1b"><apply id="S2.T1.23.23.23.5.m3.1.1.cmml" xref="S2.T1.23.23.23.5.m3.1.1"><csymbol cd="ambiguous" id="S2.T1.23.23.23.5.m3.1.1.1.cmml" xref="S2.T1.23.23.23.5.m3.1.1">subscript</csymbol><ci id="S2.T1.23.23.23.5.m3.1.1.2.cmml" xref="S2.T1.23.23.23.5.m3.1.1.2">𝑝</ci><ci id="S2.T1.23.23.23.5.m3.1.1.3.cmml" xref="S2.T1.23.23.23.5.m3.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.23.23.23.5.m3.1c">p_{x}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.23.23.23.5.m3.1d">italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="S2.T1.24.24.24.6.4" style="font-size:90%;">-th with outer product) embedding set for </span><math alttext="(q,x)" class="ltx_Math" display="inline" id="S2.T1.24.24.24.6.m4.2"><semantics id="S2.T1.24.24.24.6.m4.2a"><mrow id="S2.T1.24.24.24.6.m4.2.3.2" xref="S2.T1.24.24.24.6.m4.2.3.1.cmml"><mo id="S2.T1.24.24.24.6.m4.2.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.24.24.24.6.m4.2.3.1.cmml">(</mo><mi id="S2.T1.24.24.24.6.m4.1.1" mathsize="90%" xref="S2.T1.24.24.24.6.m4.1.1.cmml">q</mi><mo id="S2.T1.24.24.24.6.m4.2.3.2.2" mathsize="90%" xref="S2.T1.24.24.24.6.m4.2.3.1.cmml">,</mo><mi id="S2.T1.24.24.24.6.m4.2.2" mathsize="90%" xref="S2.T1.24.24.24.6.m4.2.2.cmml">x</mi><mo id="S2.T1.24.24.24.6.m4.2.3.2.3" maxsize="90%" minsize="90%" xref="S2.T1.24.24.24.6.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.24.24.24.6.m4.2b"><interval closure="open" id="S2.T1.24.24.24.6.m4.2.3.1.cmml" xref="S2.T1.24.24.24.6.m4.2.3.2"><ci id="S2.T1.24.24.24.6.m4.1.1.cmml" xref="S2.T1.24.24.24.6.m4.1.1">𝑞</ci><ci id="S2.T1.24.24.24.6.m4.2.2.cmml" xref="S2.T1.24.24.24.6.m4.2.2">𝑥</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.24.24.24.6.m4.2c">(q,x)</annotation><annotation encoding="application/x-llamapun" id="S2.T1.24.24.24.6.m4.2d">( italic_q , italic_x )</annotation></semantics></math><span class="ltx_text" id="S2.T1.24.24.24.6.5" style="font-size:90%;">.</span>
</td>
</tr>
<tr class="ltx_tr" id="S2.T1.27.27.27">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S2.T1.26.26.26.2">
<math alttext="f(q)" class="ltx_Math" display="inline" id="S2.T1.25.25.25.1.m1.1"><semantics id="S2.T1.25.25.25.1.m1.1a"><mrow id="S2.T1.25.25.25.1.m1.1.2" xref="S2.T1.25.25.25.1.m1.1.2.cmml"><mi id="S2.T1.25.25.25.1.m1.1.2.2" mathsize="90%" xref="S2.T1.25.25.25.1.m1.1.2.2.cmml">f</mi><mo id="S2.T1.25.25.25.1.m1.1.2.1" xref="S2.T1.25.25.25.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.T1.25.25.25.1.m1.1.2.3.2" xref="S2.T1.25.25.25.1.m1.1.2.cmml"><mo id="S2.T1.25.25.25.1.m1.1.2.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.25.25.25.1.m1.1.2.cmml">(</mo><mi id="S2.T1.25.25.25.1.m1.1.1" mathsize="90%" xref="S2.T1.25.25.25.1.m1.1.1.cmml">q</mi><mo id="S2.T1.25.25.25.1.m1.1.2.3.2.2" maxsize="90%" minsize="90%" xref="S2.T1.25.25.25.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.25.25.25.1.m1.1b"><apply id="S2.T1.25.25.25.1.m1.1.2.cmml" xref="S2.T1.25.25.25.1.m1.1.2"><times id="S2.T1.25.25.25.1.m1.1.2.1.cmml" xref="S2.T1.25.25.25.1.m1.1.2.1"></times><ci id="S2.T1.25.25.25.1.m1.1.2.2.cmml" xref="S2.T1.25.25.25.1.m1.1.2.2">𝑓</ci><ci id="S2.T1.25.25.25.1.m1.1.1.cmml" xref="S2.T1.25.25.25.1.m1.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.25.25.25.1.m1.1c">f(q)</annotation><annotation encoding="application/x-llamapun" id="S2.T1.25.25.25.1.m1.1d">italic_f ( italic_q )</annotation></semantics></math><span class="ltx_text" id="S2.T1.26.26.26.2.1" style="font-size:90%;"> (</span><math alttext="f_{p}(q)" class="ltx_Math" display="inline" id="S2.T1.26.26.26.2.m2.1"><semantics id="S2.T1.26.26.26.2.m2.1a"><mrow id="S2.T1.26.26.26.2.m2.1.2" xref="S2.T1.26.26.26.2.m2.1.2.cmml"><msub id="S2.T1.26.26.26.2.m2.1.2.2" xref="S2.T1.26.26.26.2.m2.1.2.2.cmml"><mi id="S2.T1.26.26.26.2.m2.1.2.2.2" mathsize="90%" xref="S2.T1.26.26.26.2.m2.1.2.2.2.cmml">f</mi><mi id="S2.T1.26.26.26.2.m2.1.2.2.3" mathsize="90%" xref="S2.T1.26.26.26.2.m2.1.2.2.3.cmml">p</mi></msub><mo id="S2.T1.26.26.26.2.m2.1.2.1" xref="S2.T1.26.26.26.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.T1.26.26.26.2.m2.1.2.3.2" xref="S2.T1.26.26.26.2.m2.1.2.cmml"><mo id="S2.T1.26.26.26.2.m2.1.2.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.26.26.26.2.m2.1.2.cmml">(</mo><mi id="S2.T1.26.26.26.2.m2.1.1" mathsize="90%" xref="S2.T1.26.26.26.2.m2.1.1.cmml">q</mi><mo id="S2.T1.26.26.26.2.m2.1.2.3.2.2" maxsize="90%" minsize="90%" xref="S2.T1.26.26.26.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.26.26.26.2.m2.1b"><apply id="S2.T1.26.26.26.2.m2.1.2.cmml" xref="S2.T1.26.26.26.2.m2.1.2"><times id="S2.T1.26.26.26.2.m2.1.2.1.cmml" xref="S2.T1.26.26.26.2.m2.1.2.1"></times><apply id="S2.T1.26.26.26.2.m2.1.2.2.cmml" xref="S2.T1.26.26.26.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.T1.26.26.26.2.m2.1.2.2.1.cmml" xref="S2.T1.26.26.26.2.m2.1.2.2">subscript</csymbol><ci id="S2.T1.26.26.26.2.m2.1.2.2.2.cmml" xref="S2.T1.26.26.26.2.m2.1.2.2.2">𝑓</ci><ci id="S2.T1.26.26.26.2.m2.1.2.2.3.cmml" xref="S2.T1.26.26.26.2.m2.1.2.2.3">𝑝</ci></apply><ci id="S2.T1.26.26.26.2.m2.1.1.cmml" xref="S2.T1.26.26.26.2.m2.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.26.26.26.2.m2.1c">f_{p}(q)</annotation><annotation encoding="application/x-llamapun" id="S2.T1.26.26.26.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math><span class="ltx_text" id="S2.T1.26.26.26.2.2" style="font-size:90%;">)</span>
</th>
<td class="ltx_td ltx_align_left" id="S2.T1.27.27.27.3">
<span class="ltx_text" id="S2.T1.27.27.27.3.1" style="font-size:90%;">learned embedding for the query (</span><math alttext="p" class="ltx_Math" display="inline" id="S2.T1.27.27.27.3.m1.1"><semantics id="S2.T1.27.27.27.3.m1.1a"><mi id="S2.T1.27.27.27.3.m1.1.1" mathsize="90%" xref="S2.T1.27.27.27.3.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.T1.27.27.27.3.m1.1b"><ci id="S2.T1.27.27.27.3.m1.1.1.cmml" xref="S2.T1.27.27.27.3.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.27.27.27.3.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.T1.27.27.27.3.m1.1d">italic_p</annotation></semantics></math><span class="ltx_text" id="S2.T1.27.27.27.3.2" style="font-size:90%;">-th component-level query embedding)</span>
</td>
</tr>
<tr class="ltx_tr" id="S2.T1.30.30.30">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S2.T1.29.29.29.2">
<math alttext="g(x)" class="ltx_Math" display="inline" id="S2.T1.28.28.28.1.m1.1"><semantics id="S2.T1.28.28.28.1.m1.1a"><mrow id="S2.T1.28.28.28.1.m1.1.2" xref="S2.T1.28.28.28.1.m1.1.2.cmml"><mi id="S2.T1.28.28.28.1.m1.1.2.2" mathsize="90%" xref="S2.T1.28.28.28.1.m1.1.2.2.cmml">g</mi><mo id="S2.T1.28.28.28.1.m1.1.2.1" xref="S2.T1.28.28.28.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.T1.28.28.28.1.m1.1.2.3.2" xref="S2.T1.28.28.28.1.m1.1.2.cmml"><mo id="S2.T1.28.28.28.1.m1.1.2.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.28.28.28.1.m1.1.2.cmml">(</mo><mi id="S2.T1.28.28.28.1.m1.1.1" mathsize="90%" xref="S2.T1.28.28.28.1.m1.1.1.cmml">x</mi><mo id="S2.T1.28.28.28.1.m1.1.2.3.2.2" maxsize="90%" minsize="90%" xref="S2.T1.28.28.28.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.28.28.28.1.m1.1b"><apply id="S2.T1.28.28.28.1.m1.1.2.cmml" xref="S2.T1.28.28.28.1.m1.1.2"><times id="S2.T1.28.28.28.1.m1.1.2.1.cmml" xref="S2.T1.28.28.28.1.m1.1.2.1"></times><ci id="S2.T1.28.28.28.1.m1.1.2.2.cmml" xref="S2.T1.28.28.28.1.m1.1.2.2">𝑔</ci><ci id="S2.T1.28.28.28.1.m1.1.1.cmml" xref="S2.T1.28.28.28.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.28.28.28.1.m1.1c">g(x)</annotation><annotation encoding="application/x-llamapun" id="S2.T1.28.28.28.1.m1.1d">italic_g ( italic_x )</annotation></semantics></math><span class="ltx_text" id="S2.T1.29.29.29.2.1" style="font-size:90%;"> (</span><math alttext="g_{p}(x)" class="ltx_Math" display="inline" id="S2.T1.29.29.29.2.m2.1"><semantics id="S2.T1.29.29.29.2.m2.1a"><mrow id="S2.T1.29.29.29.2.m2.1.2" xref="S2.T1.29.29.29.2.m2.1.2.cmml"><msub id="S2.T1.29.29.29.2.m2.1.2.2" xref="S2.T1.29.29.29.2.m2.1.2.2.cmml"><mi id="S2.T1.29.29.29.2.m2.1.2.2.2" mathsize="90%" xref="S2.T1.29.29.29.2.m2.1.2.2.2.cmml">g</mi><mi id="S2.T1.29.29.29.2.m2.1.2.2.3" mathsize="90%" xref="S2.T1.29.29.29.2.m2.1.2.2.3.cmml">p</mi></msub><mo id="S2.T1.29.29.29.2.m2.1.2.1" xref="S2.T1.29.29.29.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.T1.29.29.29.2.m2.1.2.3.2" xref="S2.T1.29.29.29.2.m2.1.2.cmml"><mo id="S2.T1.29.29.29.2.m2.1.2.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.29.29.29.2.m2.1.2.cmml">(</mo><mi id="S2.T1.29.29.29.2.m2.1.1" mathsize="90%" xref="S2.T1.29.29.29.2.m2.1.1.cmml">x</mi><mo id="S2.T1.29.29.29.2.m2.1.2.3.2.2" maxsize="90%" minsize="90%" xref="S2.T1.29.29.29.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.29.29.29.2.m2.1b"><apply id="S2.T1.29.29.29.2.m2.1.2.cmml" xref="S2.T1.29.29.29.2.m2.1.2"><times id="S2.T1.29.29.29.2.m2.1.2.1.cmml" xref="S2.T1.29.29.29.2.m2.1.2.1"></times><apply id="S2.T1.29.29.29.2.m2.1.2.2.cmml" xref="S2.T1.29.29.29.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.T1.29.29.29.2.m2.1.2.2.1.cmml" xref="S2.T1.29.29.29.2.m2.1.2.2">subscript</csymbol><ci id="S2.T1.29.29.29.2.m2.1.2.2.2.cmml" xref="S2.T1.29.29.29.2.m2.1.2.2.2">𝑔</ci><ci id="S2.T1.29.29.29.2.m2.1.2.2.3.cmml" xref="S2.T1.29.29.29.2.m2.1.2.2.3">𝑝</ci></apply><ci id="S2.T1.29.29.29.2.m2.1.1.cmml" xref="S2.T1.29.29.29.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.29.29.29.2.m2.1c">g_{p}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.T1.29.29.29.2.m2.1d">italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math><span class="ltx_text" id="S2.T1.29.29.29.2.2" style="font-size:90%;">)</span>
</th>
<td class="ltx_td ltx_align_left" id="S2.T1.30.30.30.3">
<span class="ltx_text" id="S2.T1.30.30.30.3.1" style="font-size:90%;">learned embedding for the item (</span><math alttext="p" class="ltx_Math" display="inline" id="S2.T1.30.30.30.3.m1.1"><semantics id="S2.T1.30.30.30.3.m1.1a"><mi id="S2.T1.30.30.30.3.m1.1.1" mathsize="90%" xref="S2.T1.30.30.30.3.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.T1.30.30.30.3.m1.1b"><ci id="S2.T1.30.30.30.3.m1.1.1.cmml" xref="S2.T1.30.30.30.3.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.30.30.30.3.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.T1.30.30.30.3.m1.1d">italic_p</annotation></semantics></math><span class="ltx_text" id="S2.T1.30.30.30.3.2" style="font-size:90%;">-th component-level item embedding)</span>
</td>
</tr>
<tr class="ltx_tr" id="S2.T1.32.32.32">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S2.T1.31.31.31.1"><math alttext="d_{P}" class="ltx_Math" display="inline" id="S2.T1.31.31.31.1.m1.1"><semantics id="S2.T1.31.31.31.1.m1.1a"><msub id="S2.T1.31.31.31.1.m1.1.1" xref="S2.T1.31.31.31.1.m1.1.1.cmml"><mi id="S2.T1.31.31.31.1.m1.1.1.2" mathsize="90%" xref="S2.T1.31.31.31.1.m1.1.1.2.cmml">d</mi><mi id="S2.T1.31.31.31.1.m1.1.1.3" mathsize="90%" xref="S2.T1.31.31.31.1.m1.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="S2.T1.31.31.31.1.m1.1b"><apply id="S2.T1.31.31.31.1.m1.1.1.cmml" xref="S2.T1.31.31.31.1.m1.1.1"><csymbol cd="ambiguous" id="S2.T1.31.31.31.1.m1.1.1.1.cmml" xref="S2.T1.31.31.31.1.m1.1.1">subscript</csymbol><ci id="S2.T1.31.31.31.1.m1.1.1.2.cmml" xref="S2.T1.31.31.31.1.m1.1.1.2">𝑑</ci><ci id="S2.T1.31.31.31.1.m1.1.1.3.cmml" xref="S2.T1.31.31.31.1.m1.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.31.31.31.1.m1.1c">d_{P}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.31.31.31.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S2.T1.32.32.32.2">
<span class="ltx_text" id="S2.T1.32.32.32.2.1" style="font-size:90%;">dimensionality of low-rank (component-level) embeddings. </span><math alttext="f_{p}(q),g_{p}(q)\in\mathbb{R}^{d_{P}}" class="ltx_Math" display="inline" id="S2.T1.32.32.32.2.m1.4"><semantics id="S2.T1.32.32.32.2.m1.4a"><mrow id="S2.T1.32.32.32.2.m1.4.4" xref="S2.T1.32.32.32.2.m1.4.4.cmml"><mrow id="S2.T1.32.32.32.2.m1.4.4.2.2" xref="S2.T1.32.32.32.2.m1.4.4.2.3.cmml"><mrow id="S2.T1.32.32.32.2.m1.3.3.1.1.1" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.cmml"><msub id="S2.T1.32.32.32.2.m1.3.3.1.1.1.2" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.2.cmml"><mi id="S2.T1.32.32.32.2.m1.3.3.1.1.1.2.2" mathsize="90%" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.2.2.cmml">f</mi><mi id="S2.T1.32.32.32.2.m1.3.3.1.1.1.2.3" mathsize="90%" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.2.3.cmml">p</mi></msub><mo id="S2.T1.32.32.32.2.m1.3.3.1.1.1.1" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S2.T1.32.32.32.2.m1.3.3.1.1.1.3.2" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.cmml"><mo id="S2.T1.32.32.32.2.m1.3.3.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.cmml">(</mo><mi id="S2.T1.32.32.32.2.m1.1.1" mathsize="90%" xref="S2.T1.32.32.32.2.m1.1.1.cmml">q</mi><mo id="S2.T1.32.32.32.2.m1.3.3.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.T1.32.32.32.2.m1.4.4.2.2.3" mathsize="90%" xref="S2.T1.32.32.32.2.m1.4.4.2.3.cmml">,</mo><mrow id="S2.T1.32.32.32.2.m1.4.4.2.2.2" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.cmml"><msub id="S2.T1.32.32.32.2.m1.4.4.2.2.2.2" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.2.cmml"><mi id="S2.T1.32.32.32.2.m1.4.4.2.2.2.2.2" mathsize="90%" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.2.2.cmml">g</mi><mi id="S2.T1.32.32.32.2.m1.4.4.2.2.2.2.3" mathsize="90%" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.2.3.cmml">p</mi></msub><mo id="S2.T1.32.32.32.2.m1.4.4.2.2.2.1" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.1.cmml">⁢</mo><mrow id="S2.T1.32.32.32.2.m1.4.4.2.2.2.3.2" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.cmml"><mo id="S2.T1.32.32.32.2.m1.4.4.2.2.2.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.cmml">(</mo><mi id="S2.T1.32.32.32.2.m1.2.2" mathsize="90%" xref="S2.T1.32.32.32.2.m1.2.2.cmml">q</mi><mo id="S2.T1.32.32.32.2.m1.4.4.2.2.2.3.2.2" maxsize="90%" minsize="90%" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.T1.32.32.32.2.m1.4.4.3" mathsize="90%" xref="S2.T1.32.32.32.2.m1.4.4.3.cmml">∈</mo><msup id="S2.T1.32.32.32.2.m1.4.4.4" xref="S2.T1.32.32.32.2.m1.4.4.4.cmml"><mi id="S2.T1.32.32.32.2.m1.4.4.4.2" mathsize="90%" xref="S2.T1.32.32.32.2.m1.4.4.4.2.cmml">ℝ</mi><msub id="S2.T1.32.32.32.2.m1.4.4.4.3" xref="S2.T1.32.32.32.2.m1.4.4.4.3.cmml"><mi id="S2.T1.32.32.32.2.m1.4.4.4.3.2" mathsize="90%" xref="S2.T1.32.32.32.2.m1.4.4.4.3.2.cmml">d</mi><mi id="S2.T1.32.32.32.2.m1.4.4.4.3.3" mathsize="90%" xref="S2.T1.32.32.32.2.m1.4.4.4.3.3.cmml">P</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.32.32.32.2.m1.4b"><apply id="S2.T1.32.32.32.2.m1.4.4.cmml" xref="S2.T1.32.32.32.2.m1.4.4"><in id="S2.T1.32.32.32.2.m1.4.4.3.cmml" xref="S2.T1.32.32.32.2.m1.4.4.3"></in><list id="S2.T1.32.32.32.2.m1.4.4.2.3.cmml" xref="S2.T1.32.32.32.2.m1.4.4.2.2"><apply id="S2.T1.32.32.32.2.m1.3.3.1.1.1.cmml" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1"><times id="S2.T1.32.32.32.2.m1.3.3.1.1.1.1.cmml" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.1"></times><apply id="S2.T1.32.32.32.2.m1.3.3.1.1.1.2.cmml" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.T1.32.32.32.2.m1.3.3.1.1.1.2.1.cmml" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.2">subscript</csymbol><ci id="S2.T1.32.32.32.2.m1.3.3.1.1.1.2.2.cmml" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.2.2">𝑓</ci><ci id="S2.T1.32.32.32.2.m1.3.3.1.1.1.2.3.cmml" xref="S2.T1.32.32.32.2.m1.3.3.1.1.1.2.3">𝑝</ci></apply><ci id="S2.T1.32.32.32.2.m1.1.1.cmml" xref="S2.T1.32.32.32.2.m1.1.1">𝑞</ci></apply><apply id="S2.T1.32.32.32.2.m1.4.4.2.2.2.cmml" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2"><times id="S2.T1.32.32.32.2.m1.4.4.2.2.2.1.cmml" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.1"></times><apply id="S2.T1.32.32.32.2.m1.4.4.2.2.2.2.cmml" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S2.T1.32.32.32.2.m1.4.4.2.2.2.2.1.cmml" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.2">subscript</csymbol><ci id="S2.T1.32.32.32.2.m1.4.4.2.2.2.2.2.cmml" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.2.2">𝑔</ci><ci id="S2.T1.32.32.32.2.m1.4.4.2.2.2.2.3.cmml" xref="S2.T1.32.32.32.2.m1.4.4.2.2.2.2.3">𝑝</ci></apply><ci id="S2.T1.32.32.32.2.m1.2.2.cmml" xref="S2.T1.32.32.32.2.m1.2.2">𝑞</ci></apply></list><apply id="S2.T1.32.32.32.2.m1.4.4.4.cmml" xref="S2.T1.32.32.32.2.m1.4.4.4"><csymbol cd="ambiguous" id="S2.T1.32.32.32.2.m1.4.4.4.1.cmml" xref="S2.T1.32.32.32.2.m1.4.4.4">superscript</csymbol><ci id="S2.T1.32.32.32.2.m1.4.4.4.2.cmml" xref="S2.T1.32.32.32.2.m1.4.4.4.2">ℝ</ci><apply id="S2.T1.32.32.32.2.m1.4.4.4.3.cmml" xref="S2.T1.32.32.32.2.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.T1.32.32.32.2.m1.4.4.4.3.1.cmml" xref="S2.T1.32.32.32.2.m1.4.4.4.3">subscript</csymbol><ci id="S2.T1.32.32.32.2.m1.4.4.4.3.2.cmml" xref="S2.T1.32.32.32.2.m1.4.4.4.3.2">𝑑</ci><ci id="S2.T1.32.32.32.2.m1.4.4.4.3.3.cmml" xref="S2.T1.32.32.32.2.m1.4.4.4.3.3">𝑃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.32.32.32.2.m1.4c">f_{p}(q),g_{p}(q)\in\mathbb{R}^{d_{P}}</annotation><annotation encoding="application/x-llamapun" id="S2.T1.32.32.32.2.m1.4d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="S2.T1.32.32.32.2.2" style="font-size:90%;">.</span>
</td>
</tr>
<tr class="ltx_tr" id="S2.T1.34.34.34">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S2.T1.33.33.33.1"><math alttext="\langle f(q),g(x)\rangle" class="ltx_Math" display="inline" id="S2.T1.33.33.33.1.m1.4"><semantics id="S2.T1.33.33.33.1.m1.4a"><mrow id="S2.T1.33.33.33.1.m1.4.4.2" xref="S2.T1.33.33.33.1.m1.4.4.3.cmml"><mo id="S2.T1.33.33.33.1.m1.4.4.2.3" maxsize="90%" minsize="90%" xref="S2.T1.33.33.33.1.m1.4.4.3.cmml">⟨</mo><mrow id="S2.T1.33.33.33.1.m1.3.3.1.1" xref="S2.T1.33.33.33.1.m1.3.3.1.1.cmml"><mi id="S2.T1.33.33.33.1.m1.3.3.1.1.2" mathsize="90%" xref="S2.T1.33.33.33.1.m1.3.3.1.1.2.cmml">f</mi><mo id="S2.T1.33.33.33.1.m1.3.3.1.1.1" xref="S2.T1.33.33.33.1.m1.3.3.1.1.1.cmml">⁢</mo><mrow id="S2.T1.33.33.33.1.m1.3.3.1.1.3.2" xref="S2.T1.33.33.33.1.m1.3.3.1.1.cmml"><mo id="S2.T1.33.33.33.1.m1.3.3.1.1.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.33.33.33.1.m1.3.3.1.1.cmml">(</mo><mi id="S2.T1.33.33.33.1.m1.1.1" mathsize="90%" xref="S2.T1.33.33.33.1.m1.1.1.cmml">q</mi><mo id="S2.T1.33.33.33.1.m1.3.3.1.1.3.2.2" maxsize="90%" minsize="90%" xref="S2.T1.33.33.33.1.m1.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S2.T1.33.33.33.1.m1.4.4.2.4" mathsize="90%" xref="S2.T1.33.33.33.1.m1.4.4.3.cmml">,</mo><mrow id="S2.T1.33.33.33.1.m1.4.4.2.2" xref="S2.T1.33.33.33.1.m1.4.4.2.2.cmml"><mi id="S2.T1.33.33.33.1.m1.4.4.2.2.2" mathsize="90%" xref="S2.T1.33.33.33.1.m1.4.4.2.2.2.cmml">g</mi><mo id="S2.T1.33.33.33.1.m1.4.4.2.2.1" xref="S2.T1.33.33.33.1.m1.4.4.2.2.1.cmml">⁢</mo><mrow id="S2.T1.33.33.33.1.m1.4.4.2.2.3.2" xref="S2.T1.33.33.33.1.m1.4.4.2.2.cmml"><mo id="S2.T1.33.33.33.1.m1.4.4.2.2.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.33.33.33.1.m1.4.4.2.2.cmml">(</mo><mi id="S2.T1.33.33.33.1.m1.2.2" mathsize="90%" xref="S2.T1.33.33.33.1.m1.2.2.cmml">x</mi><mo id="S2.T1.33.33.33.1.m1.4.4.2.2.3.2.2" maxsize="90%" minsize="90%" xref="S2.T1.33.33.33.1.m1.4.4.2.2.cmml">)</mo></mrow></mrow><mo id="S2.T1.33.33.33.1.m1.4.4.2.5" maxsize="90%" minsize="90%" xref="S2.T1.33.33.33.1.m1.4.4.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.33.33.33.1.m1.4b"><list id="S2.T1.33.33.33.1.m1.4.4.3.cmml" xref="S2.T1.33.33.33.1.m1.4.4.2"><apply id="S2.T1.33.33.33.1.m1.3.3.1.1.cmml" xref="S2.T1.33.33.33.1.m1.3.3.1.1"><times id="S2.T1.33.33.33.1.m1.3.3.1.1.1.cmml" xref="S2.T1.33.33.33.1.m1.3.3.1.1.1"></times><ci id="S2.T1.33.33.33.1.m1.3.3.1.1.2.cmml" xref="S2.T1.33.33.33.1.m1.3.3.1.1.2">𝑓</ci><ci id="S2.T1.33.33.33.1.m1.1.1.cmml" xref="S2.T1.33.33.33.1.m1.1.1">𝑞</ci></apply><apply id="S2.T1.33.33.33.1.m1.4.4.2.2.cmml" xref="S2.T1.33.33.33.1.m1.4.4.2.2"><times id="S2.T1.33.33.33.1.m1.4.4.2.2.1.cmml" xref="S2.T1.33.33.33.1.m1.4.4.2.2.1"></times><ci id="S2.T1.33.33.33.1.m1.4.4.2.2.2.cmml" xref="S2.T1.33.33.33.1.m1.4.4.2.2.2">𝑔</ci><ci id="S2.T1.33.33.33.1.m1.2.2.cmml" xref="S2.T1.33.33.33.1.m1.2.2">𝑥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.33.33.33.1.m1.4c">\langle f(q),g(x)\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.T1.33.33.33.1.m1.4d">⟨ italic_f ( italic_q ) , italic_g ( italic_x ) ⟩</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S2.T1.34.34.34.2">
<span class="ltx_text" id="S2.T1.34.34.34.2.1" style="font-size:90%;">the dot product similarity function; </span><math alttext="\langle f(q),g(x)\rangle=g(x)^{T}f(q)" class="ltx_Math" display="inline" id="S2.T1.34.34.34.2.m1.6"><semantics id="S2.T1.34.34.34.2.m1.6a"><mrow id="S2.T1.34.34.34.2.m1.6.6" xref="S2.T1.34.34.34.2.m1.6.6.cmml"><mrow id="S2.T1.34.34.34.2.m1.6.6.2.2" xref="S2.T1.34.34.34.2.m1.6.6.2.3.cmml"><mo id="S2.T1.34.34.34.2.m1.6.6.2.2.3" maxsize="90%" minsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.2.3.cmml">⟨</mo><mrow id="S2.T1.34.34.34.2.m1.5.5.1.1.1" xref="S2.T1.34.34.34.2.m1.5.5.1.1.1.cmml"><mi id="S2.T1.34.34.34.2.m1.5.5.1.1.1.2" mathsize="90%" xref="S2.T1.34.34.34.2.m1.5.5.1.1.1.2.cmml">f</mi><mo id="S2.T1.34.34.34.2.m1.5.5.1.1.1.1" xref="S2.T1.34.34.34.2.m1.5.5.1.1.1.1.cmml">⁢</mo><mrow id="S2.T1.34.34.34.2.m1.5.5.1.1.1.3.2" xref="S2.T1.34.34.34.2.m1.5.5.1.1.1.cmml"><mo id="S2.T1.34.34.34.2.m1.5.5.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.34.34.34.2.m1.5.5.1.1.1.cmml">(</mo><mi id="S2.T1.34.34.34.2.m1.1.1" mathsize="90%" xref="S2.T1.34.34.34.2.m1.1.1.cmml">q</mi><mo id="S2.T1.34.34.34.2.m1.5.5.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="S2.T1.34.34.34.2.m1.5.5.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.T1.34.34.34.2.m1.6.6.2.2.4" mathsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.2.3.cmml">,</mo><mrow id="S2.T1.34.34.34.2.m1.6.6.2.2.2" xref="S2.T1.34.34.34.2.m1.6.6.2.2.2.cmml"><mi id="S2.T1.34.34.34.2.m1.6.6.2.2.2.2" mathsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.2.2.2.2.cmml">g</mi><mo id="S2.T1.34.34.34.2.m1.6.6.2.2.2.1" xref="S2.T1.34.34.34.2.m1.6.6.2.2.2.1.cmml">⁢</mo><mrow id="S2.T1.34.34.34.2.m1.6.6.2.2.2.3.2" xref="S2.T1.34.34.34.2.m1.6.6.2.2.2.cmml"><mo id="S2.T1.34.34.34.2.m1.6.6.2.2.2.3.2.1" maxsize="90%" minsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.2.2.2.cmml">(</mo><mi id="S2.T1.34.34.34.2.m1.2.2" mathsize="90%" xref="S2.T1.34.34.34.2.m1.2.2.cmml">x</mi><mo id="S2.T1.34.34.34.2.m1.6.6.2.2.2.3.2.2" maxsize="90%" minsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.T1.34.34.34.2.m1.6.6.2.2.5" maxsize="90%" minsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.2.3.cmml">⟩</mo></mrow><mo id="S2.T1.34.34.34.2.m1.6.6.3" mathsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.3.cmml">=</mo><mrow id="S2.T1.34.34.34.2.m1.6.6.4" xref="S2.T1.34.34.34.2.m1.6.6.4.cmml"><mi id="S2.T1.34.34.34.2.m1.6.6.4.2" mathsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.4.2.cmml">g</mi><mo id="S2.T1.34.34.34.2.m1.6.6.4.1" xref="S2.T1.34.34.34.2.m1.6.6.4.1.cmml">⁢</mo><msup id="S2.T1.34.34.34.2.m1.6.6.4.3" xref="S2.T1.34.34.34.2.m1.6.6.4.3.cmml"><mrow id="S2.T1.34.34.34.2.m1.6.6.4.3.2.2" xref="S2.T1.34.34.34.2.m1.6.6.4.3.cmml"><mo id="S2.T1.34.34.34.2.m1.6.6.4.3.2.2.1" maxsize="90%" minsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.4.3.cmml">(</mo><mi id="S2.T1.34.34.34.2.m1.3.3" mathsize="90%" xref="S2.T1.34.34.34.2.m1.3.3.cmml">x</mi><mo id="S2.T1.34.34.34.2.m1.6.6.4.3.2.2.2" maxsize="90%" minsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.4.3.cmml">)</mo></mrow><mi id="S2.T1.34.34.34.2.m1.6.6.4.3.3" mathsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.4.3.3.cmml">T</mi></msup><mo id="S2.T1.34.34.34.2.m1.6.6.4.1a" xref="S2.T1.34.34.34.2.m1.6.6.4.1.cmml">⁢</mo><mi id="S2.T1.34.34.34.2.m1.6.6.4.4" mathsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.4.4.cmml">f</mi><mo id="S2.T1.34.34.34.2.m1.6.6.4.1b" xref="S2.T1.34.34.34.2.m1.6.6.4.1.cmml">⁢</mo><mrow id="S2.T1.34.34.34.2.m1.6.6.4.5.2" xref="S2.T1.34.34.34.2.m1.6.6.4.cmml"><mo id="S2.T1.34.34.34.2.m1.6.6.4.5.2.1" maxsize="90%" minsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.4.cmml">(</mo><mi id="S2.T1.34.34.34.2.m1.4.4" mathsize="90%" xref="S2.T1.34.34.34.2.m1.4.4.cmml">q</mi><mo id="S2.T1.34.34.34.2.m1.6.6.4.5.2.2" maxsize="90%" minsize="90%" xref="S2.T1.34.34.34.2.m1.6.6.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T1.34.34.34.2.m1.6b"><apply id="S2.T1.34.34.34.2.m1.6.6.cmml" xref="S2.T1.34.34.34.2.m1.6.6"><eq id="S2.T1.34.34.34.2.m1.6.6.3.cmml" xref="S2.T1.34.34.34.2.m1.6.6.3"></eq><list id="S2.T1.34.34.34.2.m1.6.6.2.3.cmml" xref="S2.T1.34.34.34.2.m1.6.6.2.2"><apply id="S2.T1.34.34.34.2.m1.5.5.1.1.1.cmml" xref="S2.T1.34.34.34.2.m1.5.5.1.1.1"><times id="S2.T1.34.34.34.2.m1.5.5.1.1.1.1.cmml" xref="S2.T1.34.34.34.2.m1.5.5.1.1.1.1"></times><ci id="S2.T1.34.34.34.2.m1.5.5.1.1.1.2.cmml" xref="S2.T1.34.34.34.2.m1.5.5.1.1.1.2">𝑓</ci><ci id="S2.T1.34.34.34.2.m1.1.1.cmml" xref="S2.T1.34.34.34.2.m1.1.1">𝑞</ci></apply><apply id="S2.T1.34.34.34.2.m1.6.6.2.2.2.cmml" xref="S2.T1.34.34.34.2.m1.6.6.2.2.2"><times id="S2.T1.34.34.34.2.m1.6.6.2.2.2.1.cmml" xref="S2.T1.34.34.34.2.m1.6.6.2.2.2.1"></times><ci id="S2.T1.34.34.34.2.m1.6.6.2.2.2.2.cmml" xref="S2.T1.34.34.34.2.m1.6.6.2.2.2.2">𝑔</ci><ci id="S2.T1.34.34.34.2.m1.2.2.cmml" xref="S2.T1.34.34.34.2.m1.2.2">𝑥</ci></apply></list><apply id="S2.T1.34.34.34.2.m1.6.6.4.cmml" xref="S2.T1.34.34.34.2.m1.6.6.4"><times id="S2.T1.34.34.34.2.m1.6.6.4.1.cmml" xref="S2.T1.34.34.34.2.m1.6.6.4.1"></times><ci id="S2.T1.34.34.34.2.m1.6.6.4.2.cmml" xref="S2.T1.34.34.34.2.m1.6.6.4.2">𝑔</ci><apply id="S2.T1.34.34.34.2.m1.6.6.4.3.cmml" xref="S2.T1.34.34.34.2.m1.6.6.4.3"><csymbol cd="ambiguous" id="S2.T1.34.34.34.2.m1.6.6.4.3.1.cmml" xref="S2.T1.34.34.34.2.m1.6.6.4.3">superscript</csymbol><ci id="S2.T1.34.34.34.2.m1.3.3.cmml" xref="S2.T1.34.34.34.2.m1.3.3">𝑥</ci><ci id="S2.T1.34.34.34.2.m1.6.6.4.3.3.cmml" xref="S2.T1.34.34.34.2.m1.6.6.4.3.3">𝑇</ci></apply><ci id="S2.T1.34.34.34.2.m1.6.6.4.4.cmml" xref="S2.T1.34.34.34.2.m1.6.6.4.4">𝑓</ci><ci id="S2.T1.34.34.34.2.m1.4.4.cmml" xref="S2.T1.34.34.34.2.m1.4.4">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.34.34.34.2.m1.6c">\langle f(q),g(x)\rangle=g(x)^{T}f(q)</annotation><annotation encoding="application/x-llamapun" id="S2.T1.34.34.34.2.m1.6d">⟨ italic_f ( italic_q ) , italic_g ( italic_x ) ⟩ = italic_g ( italic_x ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f ( italic_q )</annotation></semantics></math><span class="ltx_text" id="S2.T1.34.34.34.2.2" style="font-size:90%;">.</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Table of Notations.</figcaption>
</figure>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Mixture of Logits (MoL)</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.15">MoL <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite> assumes that the query <math alttext="q" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.1.m1.1d">italic_q</annotation></semantics></math> and the item <math alttext="x" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.2.m2.1d">italic_x</annotation></semantics></math> are already mapped to <math alttext="P" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.3.m3.1"><semantics id="S2.SS0.SSS0.Px1.p1.3.m3.1a"><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.3.m3.1b"><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.3.m3.1c">P</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.3.m3.1d">italic_P</annotation></semantics></math> groups of low-rank embeddings (“component-level embeddings”), <math alttext="f_{p}(q),g_{p}(x)\in\mathbb{R}^{d_{P}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.4.m4.4"><semantics id="S2.SS0.SSS0.Px1.p1.4.m4.4a"><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.4.4" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.3.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2.2.cmml">f</mi><mi id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.cmml"><mo id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml">q</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.3.cmml">,</mo><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.cmml"><msub id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2.2.cmml">g</mi><mi id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.cmml"><mo id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.4.m4.2.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.2.2.cmml">x</mi><mo id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.3.cmml">∈</mo><msup id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.2.cmml">ℝ</mi><msub id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3.cmml"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3.2" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3.2.cmml">d</mi><mi id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3.3" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3.3.cmml">P</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.4.m4.4b"><apply id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4"><in id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.3"></in><list id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2"><apply id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1"><times id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.1"></times><apply id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2.2">𝑓</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.3.3.1.1.1.2.3">𝑝</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1">𝑞</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2"><times id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.1"></times><apply id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2.2">𝑔</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.2.2.2.2.3">𝑝</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.4.m4.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.2.2">𝑥</ci></apply></list><apply id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.2">ℝ</ci><apply id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3.2">𝑑</ci><ci id="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3.3.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.4.4.4.3.3">𝑃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.4.m4.4c">f_{p}(q),g_{p}(x)\in\mathbb{R}^{d_{P}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.4.m4.4d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="f_{p}(q),g_{p}(x)" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.5.m5.4"><semantics id="S2.SS0.SSS0.Px1.p1.5.m5.4a"><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.3.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2.2.cmml">f</mi><mi id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.cmml"><mo id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml">q</mi><mo id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.3.cmml">,</mo><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.cmml"><msub id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2.2.cmml">g</mi><mi id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.3.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.cmml"><mo id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.5.m5.2.2" xref="S2.SS0.SSS0.Px1.p1.5.m5.2.2.cmml">x</mi><mo id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.5.m5.4b"><list id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2"><apply id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1"><times id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.1"></times><apply id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2.2">𝑓</ci><ci id="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.3.3.1.1.2.3">𝑝</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1">𝑞</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2"><times id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.1"></times><apply id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2.2">𝑔</ci><ci id="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.4.4.2.2.2.3">𝑝</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.5.m5.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.2.2">𝑥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.5.m5.4c">f_{p}(q),g_{p}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.5.m5.4d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> are parameterized with some neural networks based on query and item features, respectively. MoL then calculates the similarity between the query <math alttext="q" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.6.m6.1"><semantics id="S2.SS0.SSS0.Px1.p1.6.m6.1a"><mi id="S2.SS0.SSS0.Px1.p1.6.m6.1.1" xref="S2.SS0.SSS0.Px1.p1.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.6.m6.1b"><ci id="S2.SS0.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.6.m6.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.6.m6.1d">italic_q</annotation></semantics></math> and the item <math alttext="x" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.7.m7.1"><semantics id="S2.SS0.SSS0.Px1.p1.7.m7.1a"><mi id="S2.SS0.SSS0.Px1.p1.7.m7.1.1" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.7.m7.1b"><ci id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.7.m7.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.7.m7.1d">italic_x</annotation></semantics></math> by applying adaptive gating weights, <math alttext="\pi_{p}(q,x)\in[0,1]" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.8.m8.4"><semantics id="S2.SS0.SSS0.Px1.p1.8.m8.4a"><mrow id="S2.SS0.SSS0.Px1.p1.8.m8.4.5" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.cmml"><msub id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2.2.cmml">π</mi><mi id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2.3" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.1" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.3.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.3.1.cmml"><mo id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.3.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.8.m8.1.1" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1.cmml">q</mi><mo id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.3.2.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.p1.8.m8.2.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.2.2.cmml">x</mi><mo id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.3.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.1" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.1.cmml">∈</mo><mrow id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.3.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.3.1.cmml"><mo id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.3.1.cmml">[</mo><mn id="S2.SS0.SSS0.Px1.p1.8.m8.3.3" xref="S2.SS0.SSS0.Px1.p1.8.m8.3.3.cmml">0</mn><mo id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.3.2.2" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.3.1.cmml">,</mo><mn id="S2.SS0.SSS0.Px1.p1.8.m8.4.4" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.4.cmml">1</mn><mo id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.3.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.8.m8.4b"><apply id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5"><in id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.1"></in><apply id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2"><times id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.1"></times><apply id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2.2">𝜋</ci><ci id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.2.3">𝑝</ci></apply><interval closure="open" id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.2.3.2"><ci id="S2.SS0.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.1.1">𝑞</ci><ci id="S2.SS0.SSS0.Px1.p1.8.m8.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.2.2">𝑥</ci></interval></apply><interval closure="closed" id="S2.SS0.SSS0.Px1.p1.8.m8.4.5.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.5.3.2"><cn id="S2.SS0.SSS0.Px1.p1.8.m8.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.8.m8.3.3">0</cn><cn id="S2.SS0.SSS0.Px1.p1.8.m8.4.4.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.8.m8.4.4">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.8.m8.4c">\pi_{p}(q,x)\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.8.m8.4d">italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q , italic_x ) ∈ [ 0 , 1 ]</annotation></semantics></math>, to the inner products of these <math alttext="P" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.9.m9.1"><semantics id="S2.SS0.SSS0.Px1.p1.9.m9.1a"><mi id="S2.SS0.SSS0.Px1.p1.9.m9.1.1" xref="S2.SS0.SSS0.Px1.p1.9.m9.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.9.m9.1b"><ci id="S2.SS0.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.9.m9.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.9.m9.1c">P</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.9.m9.1d">italic_P</annotation></semantics></math> pairs of low-rank embeddings, or <math alttext="\langle f_{p}(q),g_{p}(x)\rangle" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.10.m10.4"><semantics id="S2.SS0.SSS0.Px1.p1.10.m10.4a"><mrow id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.3.cmml"><mo id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.3.cmml">⟨</mo><mrow id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2.2.cmml">f</mi><mi id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.1" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.cmml"><mo id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.10.m10.1.1" xref="S2.SS0.SSS0.Px1.p1.10.m10.1.1.cmml">q</mi><mo id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.4" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.3.cmml">,</mo><mrow id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.cmml"><msub id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2.2.cmml">g</mi><mi id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.1" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.3.2" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.cmml"><mo id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.10.m10.2.2" xref="S2.SS0.SSS0.Px1.p1.10.m10.2.2.cmml">x</mi><mo id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.5" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.10.m10.4b"><list id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2"><apply id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1"><times id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.1"></times><apply id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2.2">𝑓</ci><ci id="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.3.3.1.1.2.3">𝑝</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.1.1">𝑞</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2"><times id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.1"></times><apply id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2.2">𝑔</ci><ci id="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.4.4.2.2.2.3">𝑝</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.10.m10.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.10.m10.2.2">𝑥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.10.m10.4c">\langle f_{p}(q),g_{p}(x)\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.10.m10.4d">⟨ italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ⟩</annotation></semantics></math>s. Note that prior work assumes that <math alttext="\sum_{p}\pi_{p}(q,x)=1" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.11.m11.2"><semantics id="S2.SS0.SSS0.Px1.p1.11.m11.2a"><mrow id="S2.SS0.SSS0.Px1.p1.11.m11.2.3" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.cmml"><msub id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1.cmml"><mo id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1.2" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1.2.cmml">∑</mo><mi id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1.3" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1.3.cmml">p</mi></msub><mrow id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.cmml"><msub id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2.2.cmml">π</mi><mi id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.1" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.3.2" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.3.1.cmml"><mo id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.3.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.11.m11.1.1" xref="S2.SS0.SSS0.Px1.p1.11.m11.1.1.cmml">q</mi><mo id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.3.2.2" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.p1.11.m11.2.2" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.2.cmml">x</mi><mo id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.3.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.1" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.3" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.11.m11.2b"><apply id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3"><eq id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.1"></eq><apply id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2"><apply id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1">subscript</csymbol><sum id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1.2"></sum><ci id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.1.3">𝑝</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2"><times id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.1"></times><apply id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2.2">𝜋</ci><ci id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.2.3">𝑝</ci></apply><interval closure="open" id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.2.2.3.2"><ci id="S2.SS0.SSS0.Px1.p1.11.m11.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.1.1">𝑞</ci><ci id="S2.SS0.SSS0.Px1.p1.11.m11.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.2">𝑥</ci></interval></apply></apply><cn id="S2.SS0.SSS0.Px1.p1.11.m11.2.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.11.m11.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.11.m11.2c">\sum_{p}\pi_{p}(q,x)=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.11.m11.2d">∑ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q , italic_x ) = 1</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite>, and parameterizes <math alttext="\pi_{p}(q,x)" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.12.m12.2"><semantics id="S2.SS0.SSS0.Px1.p1.12.m12.2a"><mrow id="S2.SS0.SSS0.Px1.p1.12.m12.2.3" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.cmml"><msub id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2.2" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2.2.cmml">π</mi><mi id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2.3" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.1" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.3.2" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.3.1.cmml"><mo id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.3.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.12.m12.1.1" xref="S2.SS0.SSS0.Px1.p1.12.m12.1.1.cmml">q</mi><mo id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.3.2.2" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.p1.12.m12.2.2" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.2.cmml">x</mi><mo id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.3.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.12.m12.2b"><apply id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3"><times id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.1"></times><apply id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2.2">𝜋</ci><ci id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.2.3">𝑝</ci></apply><interval closure="open" id="S2.SS0.SSS0.Px1.p1.12.m12.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.3.3.2"><ci id="S2.SS0.SSS0.Px1.p1.12.m12.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m12.1.1">𝑞</ci><ci id="S2.SS0.SSS0.Px1.p1.12.m12.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.12.m12.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.12.m12.2c">\pi_{p}(q,x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.12.m12.2d">italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q , italic_x )</annotation></semantics></math> utilizing some neural network with <math alttext="f_{p}(q)" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.13.m13.1"><semantics id="S2.SS0.SSS0.Px1.p1.13.m13.1a"><mrow id="S2.SS0.SSS0.Px1.p1.13.m13.1.2" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.cmml"><msub id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2.2" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2.2.cmml">f</mi><mi id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2.3" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.1" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.3.2" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.13.m13.1.1" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.1.cmml">q</mi><mo id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.13.m13.1b"><apply id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2"><times id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.1"></times><apply id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2.2">𝑓</ci><ci id="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.2.2.3">𝑝</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.13.m13.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.13.m13.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.13.m13.1c">f_{p}(q)</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.13.m13.1d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math>s, <math alttext="g_{p}(x)" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.14.m14.1"><semantics id="S2.SS0.SSS0.Px1.p1.14.m14.1a"><mrow id="S2.SS0.SSS0.Px1.p1.14.m14.1.2" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.cmml"><msub id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2.2" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2.2.cmml">g</mi><mi id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2.3" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.1" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.3.2" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.14.m14.1.1" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.1.cmml">x</mi><mo id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.14.m14.1b"><apply id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2"><times id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.1"></times><apply id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2.2">𝑔</ci><ci id="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.2.2.3">𝑝</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.14.m14.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.14.m14.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.14.m14.1c">g_{p}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.14.m14.1d">italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math>s, and <math alttext="\langle f_{p}(q),g_{p}(x)\rangle" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.15.m15.4"><semantics id="S2.SS0.SSS0.Px1.p1.15.m15.4a"><mrow id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.3.cmml"><mo id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.3.cmml">⟨</mo><mrow id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2.2.cmml">f</mi><mi id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.1" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.3.2" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.cmml"><mo id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.15.m15.1.1" xref="S2.SS0.SSS0.Px1.p1.15.m15.1.1.cmml">q</mi><mo id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.4" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.3.cmml">,</mo><mrow id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.cmml"><msub id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2.2" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2.2.cmml">g</mi><mi id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2.3" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.1" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.3.2" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.cmml"><mo id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p1.15.m15.2.2" xref="S2.SS0.SSS0.Px1.p1.15.m15.2.2.cmml">x</mi><mo id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.5" stretchy="false" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.15.m15.4b"><list id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.3.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2"><apply id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1"><times id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.1"></times><apply id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2.2">𝑓</ci><ci id="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.3.3.1.1.2.3">𝑝</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.15.m15.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.1.1">𝑞</ci></apply><apply id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2"><times id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.1"></times><apply id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2.2">𝑔</ci><ci id="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.4.4.2.2.2.3">𝑝</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.15.m15.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.15.m15.2.2">𝑥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.15.m15.4c">\langle f_{p}(q),g_{p}(x)\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.15.m15.4d">⟨ italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ⟩</annotation></semantics></math>s as input features, but these details do not affect our analyses in this paper. Following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\phi(q,x)=\sum_{p=1}^{P}\pi_{p}(q,x)\langle f_{p}(q),g_{p}(x)\rangle" class="ltx_Math" display="block" id="S2.E1.m1.8"><semantics id="S2.E1.m1.8a"><mrow id="S2.E1.m1.8.8" xref="S2.E1.m1.8.8.cmml"><mrow id="S2.E1.m1.8.8.4" xref="S2.E1.m1.8.8.4.cmml"><mi id="S2.E1.m1.8.8.4.2" xref="S2.E1.m1.8.8.4.2.cmml">ϕ</mi><mo id="S2.E1.m1.8.8.4.1" xref="S2.E1.m1.8.8.4.1.cmml">⁢</mo><mrow id="S2.E1.m1.8.8.4.3.2" xref="S2.E1.m1.8.8.4.3.1.cmml"><mo id="S2.E1.m1.8.8.4.3.2.1" stretchy="false" xref="S2.E1.m1.8.8.4.3.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">q</mi><mo id="S2.E1.m1.8.8.4.3.2.2" xref="S2.E1.m1.8.8.4.3.1.cmml">,</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">x</mi><mo id="S2.E1.m1.8.8.4.3.2.3" stretchy="false" xref="S2.E1.m1.8.8.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.8.8.3" rspace="0.111em" xref="S2.E1.m1.8.8.3.cmml">=</mo><mrow id="S2.E1.m1.8.8.2" xref="S2.E1.m1.8.8.2.cmml"><munderover id="S2.E1.m1.8.8.2.3" xref="S2.E1.m1.8.8.2.3.cmml"><mo id="S2.E1.m1.8.8.2.3.2.2" movablelimits="false" xref="S2.E1.m1.8.8.2.3.2.2.cmml">∑</mo><mrow id="S2.E1.m1.8.8.2.3.2.3" xref="S2.E1.m1.8.8.2.3.2.3.cmml"><mi id="S2.E1.m1.8.8.2.3.2.3.2" xref="S2.E1.m1.8.8.2.3.2.3.2.cmml">p</mi><mo id="S2.E1.m1.8.8.2.3.2.3.1" xref="S2.E1.m1.8.8.2.3.2.3.1.cmml">=</mo><mn id="S2.E1.m1.8.8.2.3.2.3.3" xref="S2.E1.m1.8.8.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.8.8.2.3.3" xref="S2.E1.m1.8.8.2.3.3.cmml">P</mi></munderover><mrow id="S2.E1.m1.8.8.2.2" xref="S2.E1.m1.8.8.2.2.cmml"><msub id="S2.E1.m1.8.8.2.2.4" xref="S2.E1.m1.8.8.2.2.4.cmml"><mi id="S2.E1.m1.8.8.2.2.4.2" xref="S2.E1.m1.8.8.2.2.4.2.cmml">π</mi><mi id="S2.E1.m1.8.8.2.2.4.3" xref="S2.E1.m1.8.8.2.2.4.3.cmml">p</mi></msub><mo id="S2.E1.m1.8.8.2.2.3" xref="S2.E1.m1.8.8.2.2.3.cmml">⁢</mo><mrow id="S2.E1.m1.8.8.2.2.5.2" xref="S2.E1.m1.8.8.2.2.5.1.cmml"><mo id="S2.E1.m1.8.8.2.2.5.2.1" stretchy="false" xref="S2.E1.m1.8.8.2.2.5.1.cmml">(</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">q</mi><mo id="S2.E1.m1.8.8.2.2.5.2.2" xref="S2.E1.m1.8.8.2.2.5.1.cmml">,</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">x</mi><mo id="S2.E1.m1.8.8.2.2.5.2.3" stretchy="false" xref="S2.E1.m1.8.8.2.2.5.1.cmml">)</mo></mrow><mo id="S2.E1.m1.8.8.2.2.3a" xref="S2.E1.m1.8.8.2.2.3.cmml">⁢</mo><mrow id="S2.E1.m1.8.8.2.2.2.2" xref="S2.E1.m1.8.8.2.2.2.3.cmml"><mo id="S2.E1.m1.8.8.2.2.2.2.3" stretchy="false" xref="S2.E1.m1.8.8.2.2.2.3.cmml">⟨</mo><mrow id="S2.E1.m1.7.7.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.1.cmml"><msub id="S2.E1.m1.7.7.1.1.1.1.1.2" xref="S2.E1.m1.7.7.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.7.7.1.1.1.1.1.2.2" xref="S2.E1.m1.7.7.1.1.1.1.1.2.2.cmml">f</mi><mi id="S2.E1.m1.7.7.1.1.1.1.1.2.3" xref="S2.E1.m1.7.7.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="S2.E1.m1.7.7.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E1.m1.7.7.1.1.1.1.1.3.2" xref="S2.E1.m1.7.7.1.1.1.1.1.cmml"><mo id="S2.E1.m1.7.7.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E1.m1.7.7.1.1.1.1.1.cmml">(</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">q</mi><mo id="S2.E1.m1.7.7.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E1.m1.7.7.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.8.8.2.2.2.2.4" xref="S2.E1.m1.8.8.2.2.2.3.cmml">,</mo><mrow id="S2.E1.m1.8.8.2.2.2.2.2" xref="S2.E1.m1.8.8.2.2.2.2.2.cmml"><msub id="S2.E1.m1.8.8.2.2.2.2.2.2" xref="S2.E1.m1.8.8.2.2.2.2.2.2.cmml"><mi id="S2.E1.m1.8.8.2.2.2.2.2.2.2" xref="S2.E1.m1.8.8.2.2.2.2.2.2.2.cmml">g</mi><mi id="S2.E1.m1.8.8.2.2.2.2.2.2.3" xref="S2.E1.m1.8.8.2.2.2.2.2.2.3.cmml">p</mi></msub><mo id="S2.E1.m1.8.8.2.2.2.2.2.1" xref="S2.E1.m1.8.8.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S2.E1.m1.8.8.2.2.2.2.2.3.2" xref="S2.E1.m1.8.8.2.2.2.2.2.cmml"><mo id="S2.E1.m1.8.8.2.2.2.2.2.3.2.1" stretchy="false" xref="S2.E1.m1.8.8.2.2.2.2.2.cmml">(</mo><mi id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml">x</mi><mo id="S2.E1.m1.8.8.2.2.2.2.2.3.2.2" stretchy="false" xref="S2.E1.m1.8.8.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.8.8.2.2.2.2.5" stretchy="false" xref="S2.E1.m1.8.8.2.2.2.3.cmml">⟩</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.8b"><apply id="S2.E1.m1.8.8.cmml" xref="S2.E1.m1.8.8"><eq id="S2.E1.m1.8.8.3.cmml" xref="S2.E1.m1.8.8.3"></eq><apply id="S2.E1.m1.8.8.4.cmml" xref="S2.E1.m1.8.8.4"><times id="S2.E1.m1.8.8.4.1.cmml" xref="S2.E1.m1.8.8.4.1"></times><ci id="S2.E1.m1.8.8.4.2.cmml" xref="S2.E1.m1.8.8.4.2">italic-ϕ</ci><interval closure="open" id="S2.E1.m1.8.8.4.3.1.cmml" xref="S2.E1.m1.8.8.4.3.2"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑞</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑥</ci></interval></apply><apply id="S2.E1.m1.8.8.2.cmml" xref="S2.E1.m1.8.8.2"><apply id="S2.E1.m1.8.8.2.3.cmml" xref="S2.E1.m1.8.8.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.2.3.1.cmml" xref="S2.E1.m1.8.8.2.3">superscript</csymbol><apply id="S2.E1.m1.8.8.2.3.2.cmml" xref="S2.E1.m1.8.8.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.2.3.2.1.cmml" xref="S2.E1.m1.8.8.2.3">subscript</csymbol><sum id="S2.E1.m1.8.8.2.3.2.2.cmml" xref="S2.E1.m1.8.8.2.3.2.2"></sum><apply id="S2.E1.m1.8.8.2.3.2.3.cmml" xref="S2.E1.m1.8.8.2.3.2.3"><eq id="S2.E1.m1.8.8.2.3.2.3.1.cmml" xref="S2.E1.m1.8.8.2.3.2.3.1"></eq><ci id="S2.E1.m1.8.8.2.3.2.3.2.cmml" xref="S2.E1.m1.8.8.2.3.2.3.2">𝑝</ci><cn id="S2.E1.m1.8.8.2.3.2.3.3.cmml" type="integer" xref="S2.E1.m1.8.8.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.8.8.2.3.3.cmml" xref="S2.E1.m1.8.8.2.3.3">𝑃</ci></apply><apply id="S2.E1.m1.8.8.2.2.cmml" xref="S2.E1.m1.8.8.2.2"><times id="S2.E1.m1.8.8.2.2.3.cmml" xref="S2.E1.m1.8.8.2.2.3"></times><apply id="S2.E1.m1.8.8.2.2.4.cmml" xref="S2.E1.m1.8.8.2.2.4"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.2.2.4.1.cmml" xref="S2.E1.m1.8.8.2.2.4">subscript</csymbol><ci id="S2.E1.m1.8.8.2.2.4.2.cmml" xref="S2.E1.m1.8.8.2.2.4.2">𝜋</ci><ci id="S2.E1.m1.8.8.2.2.4.3.cmml" xref="S2.E1.m1.8.8.2.2.4.3">𝑝</ci></apply><interval closure="open" id="S2.E1.m1.8.8.2.2.5.1.cmml" xref="S2.E1.m1.8.8.2.2.5.2"><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑞</ci><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝑥</ci></interval><list id="S2.E1.m1.8.8.2.2.2.3.cmml" xref="S2.E1.m1.8.8.2.2.2.2"><apply id="S2.E1.m1.7.7.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1"><times id="S2.E1.m1.7.7.1.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1"></times><apply id="S2.E1.m1.7.7.1.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.2.2">𝑓</ci><ci id="S2.E1.m1.7.7.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝑞</ci></apply><apply id="S2.E1.m1.8.8.2.2.2.2.2.cmml" xref="S2.E1.m1.8.8.2.2.2.2.2"><times id="S2.E1.m1.8.8.2.2.2.2.2.1.cmml" xref="S2.E1.m1.8.8.2.2.2.2.2.1"></times><apply id="S2.E1.m1.8.8.2.2.2.2.2.2.cmml" xref="S2.E1.m1.8.8.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.8.8.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.8.8.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.8.8.2.2.2.2.2.2.2">𝑔</ci><ci id="S2.E1.m1.8.8.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.8.8.2.2.2.2.2.2.3">𝑝</ci></apply><ci id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6">𝑥</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.8c">\phi(q,x)=\sum_{p=1}^{P}\pi_{p}(q,x)\langle f_{p}(q),g_{p}(x)\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.8d">italic_ϕ ( italic_q , italic_x ) = ∑ start_POSTSUBSCRIPT italic_p = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q , italic_x ) ⟨ italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ⟩</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p2.6">To extend this to large-scale datasets and to enable hardware-efficient implementations on accelerators like GPUs, Equation <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S2.E1" title="In Mixture of Logits (MoL) ‣ 2 Expressiveness of Mixture of Logits ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">1</span></a> was further modified by decomposing those <math alttext="P" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p2.1.m1.1a"><mi id="S2.SS0.SSS0.Px1.p2.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.1.m1.1b"><ci id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.1.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.1.m1.1d">italic_P</annotation></semantics></math> dot products as (batched) outer products of <math alttext="P_{q}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p2.2.m2.1a"><msub id="S2.SS0.SSS0.Px1.p2.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.2" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.2.cmml">P</mi><mi id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.3" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.2.m2.1b"><apply id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.2">𝑃</ci><ci id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.2.m2.1c">P_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> query-side and <math alttext="P_{x}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.3.m3.1"><semantics id="S2.SS0.SSS0.Px1.p2.3.m3.1a"><msub id="S2.SS0.SSS0.Px1.p2.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.2" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.2.cmml">P</mi><mi id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.3" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.3.m3.1b"><apply id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.2">𝑃</ci><ci id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.3.m3.1c">P_{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> item-side embedding, where <math alttext="P_{q}\times P_{x}=P" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.4.m4.1"><semantics id="S2.SS0.SSS0.Px1.p2.4.m4.1a"><mrow id="S2.SS0.SSS0.Px1.p2.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.cmml"><msub id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2.2" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2.2.cmml">P</mi><mi id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2.3" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2.3.cmml">q</mi></msub><mo id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.1.cmml">×</mo><msub id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3.2" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3.2.cmml">P</mi><mi id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3.3" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3.3.cmml">x</mi></msub></mrow><mo id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.1" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.1.cmml">=</mo><mi id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.3" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.4.m4.1b"><apply id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1"><eq id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.1"></eq><apply id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2"><times id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.1"></times><apply id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2.2">𝑃</ci><ci id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.2.3">𝑞</ci></apply><apply id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3.2">𝑃</ci><ci id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.3.3">𝑥</ci></apply></apply><ci id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.4.m4.1c">P_{q}\times P_{x}=P</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT × italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT = italic_P</annotation></semantics></math>, and applying l2-norm to <math alttext="f_{p}(q)" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.5.m5.1"><semantics id="S2.SS0.SSS0.Px1.p2.5.m5.1a"><mrow id="S2.SS0.SSS0.Px1.p2.5.m5.1.2" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.cmml"><msub id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2.2" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2.2.cmml">f</mi><mi id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2.3" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.1" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.3.2" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p2.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.1.cmml">q</mi><mo id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.5.m5.1b"><apply id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2"><times id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.1"></times><apply id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2.2">𝑓</ci><ci id="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.2.2.3">𝑝</ci></apply><ci id="S2.SS0.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.5.m5.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.5.m5.1c">f_{p}(q)</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.5.m5.1d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math>s and <math alttext="g_{p}(x)" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.6.m6.1"><semantics id="S2.SS0.SSS0.Px1.p2.6.m6.1a"><mrow id="S2.SS0.SSS0.Px1.p2.6.m6.1.2" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.cmml"><msub id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2.2" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2.2.cmml">g</mi><mi id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2.3" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2.3.cmml">p</mi></msub><mo id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.1" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.3.2" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p2.6.m6.1.1" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.1.cmml">x</mi><mo id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.6.m6.1b"><apply id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2"><times id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.1"></times><apply id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2.2">𝑔</ci><ci id="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.2.2.3">𝑝</ci></apply><ci id="S2.SS0.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.6.m6.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.6.m6.1c">g_{p}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.6.m6.1d">italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math>s:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\phi(q,x)=\sum_{p_{q}=1}^{P_{q}}\sum_{p_{x}=1}^{P_{x}}\pi_{p_{q},p_{x}}(q,x)%
\left\langle\frac{f_{p_{q}}(q)}{||f_{p_{q}}(q)||_{2}},\frac{g_{p_{x}}(x)}{||g_%
{p_{x}}(x)||_{2}}\right\rangle" class="ltx_Math" display="block" id="S2.E2.m1.12"><semantics id="S2.E2.m1.12a"><mrow id="S2.E2.m1.12.13" xref="S2.E2.m1.12.13.cmml"><mrow id="S2.E2.m1.12.13.2" xref="S2.E2.m1.12.13.2.cmml"><mi id="S2.E2.m1.12.13.2.2" xref="S2.E2.m1.12.13.2.2.cmml">ϕ</mi><mo id="S2.E2.m1.12.13.2.1" xref="S2.E2.m1.12.13.2.1.cmml">⁢</mo><mrow id="S2.E2.m1.12.13.2.3.2" xref="S2.E2.m1.12.13.2.3.1.cmml"><mo id="S2.E2.m1.12.13.2.3.2.1" stretchy="false" xref="S2.E2.m1.12.13.2.3.1.cmml">(</mo><mi id="S2.E2.m1.9.9" xref="S2.E2.m1.9.9.cmml">q</mi><mo id="S2.E2.m1.12.13.2.3.2.2" xref="S2.E2.m1.12.13.2.3.1.cmml">,</mo><mi id="S2.E2.m1.10.10" xref="S2.E2.m1.10.10.cmml">x</mi><mo id="S2.E2.m1.12.13.2.3.2.3" stretchy="false" xref="S2.E2.m1.12.13.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.12.13.1" rspace="0.111em" xref="S2.E2.m1.12.13.1.cmml">=</mo><mrow id="S2.E2.m1.12.13.3" xref="S2.E2.m1.12.13.3.cmml"><munderover id="S2.E2.m1.12.13.3.1" xref="S2.E2.m1.12.13.3.1.cmml"><mo id="S2.E2.m1.12.13.3.1.2.2" movablelimits="false" rspace="0em" xref="S2.E2.m1.12.13.3.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.12.13.3.1.2.3" xref="S2.E2.m1.12.13.3.1.2.3.cmml"><msub id="S2.E2.m1.12.13.3.1.2.3.2" xref="S2.E2.m1.12.13.3.1.2.3.2.cmml"><mi id="S2.E2.m1.12.13.3.1.2.3.2.2" xref="S2.E2.m1.12.13.3.1.2.3.2.2.cmml">p</mi><mi id="S2.E2.m1.12.13.3.1.2.3.2.3" xref="S2.E2.m1.12.13.3.1.2.3.2.3.cmml">q</mi></msub><mo id="S2.E2.m1.12.13.3.1.2.3.1" xref="S2.E2.m1.12.13.3.1.2.3.1.cmml">=</mo><mn id="S2.E2.m1.12.13.3.1.2.3.3" xref="S2.E2.m1.12.13.3.1.2.3.3.cmml">1</mn></mrow><msub id="S2.E2.m1.12.13.3.1.3" xref="S2.E2.m1.12.13.3.1.3.cmml"><mi id="S2.E2.m1.12.13.3.1.3.2" xref="S2.E2.m1.12.13.3.1.3.2.cmml">P</mi><mi id="S2.E2.m1.12.13.3.1.3.3" xref="S2.E2.m1.12.13.3.1.3.3.cmml">q</mi></msub></munderover><mrow id="S2.E2.m1.12.13.3.2" xref="S2.E2.m1.12.13.3.2.cmml"><munderover id="S2.E2.m1.12.13.3.2.1" xref="S2.E2.m1.12.13.3.2.1.cmml"><mo id="S2.E2.m1.12.13.3.2.1.2.2" movablelimits="false" xref="S2.E2.m1.12.13.3.2.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.12.13.3.2.1.2.3" xref="S2.E2.m1.12.13.3.2.1.2.3.cmml"><msub id="S2.E2.m1.12.13.3.2.1.2.3.2" xref="S2.E2.m1.12.13.3.2.1.2.3.2.cmml"><mi id="S2.E2.m1.12.13.3.2.1.2.3.2.2" xref="S2.E2.m1.12.13.3.2.1.2.3.2.2.cmml">p</mi><mi id="S2.E2.m1.12.13.3.2.1.2.3.2.3" xref="S2.E2.m1.12.13.3.2.1.2.3.2.3.cmml">x</mi></msub><mo id="S2.E2.m1.12.13.3.2.1.2.3.1" xref="S2.E2.m1.12.13.3.2.1.2.3.1.cmml">=</mo><mn id="S2.E2.m1.12.13.3.2.1.2.3.3" xref="S2.E2.m1.12.13.3.2.1.2.3.3.cmml">1</mn></mrow><msub id="S2.E2.m1.12.13.3.2.1.3" xref="S2.E2.m1.12.13.3.2.1.3.cmml"><mi id="S2.E2.m1.12.13.3.2.1.3.2" xref="S2.E2.m1.12.13.3.2.1.3.2.cmml">P</mi><mi id="S2.E2.m1.12.13.3.2.1.3.3" xref="S2.E2.m1.12.13.3.2.1.3.3.cmml">x</mi></msub></munderover><mrow id="S2.E2.m1.12.13.3.2.2" xref="S2.E2.m1.12.13.3.2.2.cmml"><msub id="S2.E2.m1.12.13.3.2.2.2" xref="S2.E2.m1.12.13.3.2.2.2.cmml"><mi id="S2.E2.m1.12.13.3.2.2.2.2" xref="S2.E2.m1.12.13.3.2.2.2.2.cmml">π</mi><mrow id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.3.cmml"><msub id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.cmml">p</mi><mi id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S2.E2.m1.2.2.2.2.3" xref="S2.E2.m1.2.2.2.3.cmml">,</mo><msub id="S2.E2.m1.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.cmml"><mi id="S2.E2.m1.2.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.2.cmml">p</mi><mi id="S2.E2.m1.2.2.2.2.2.3" xref="S2.E2.m1.2.2.2.2.2.3.cmml">x</mi></msub></mrow></msub><mo id="S2.E2.m1.12.13.3.2.2.1" xref="S2.E2.m1.12.13.3.2.2.1.cmml">⁢</mo><mrow id="S2.E2.m1.12.13.3.2.2.3.2" xref="S2.E2.m1.12.13.3.2.2.3.1.cmml"><mo id="S2.E2.m1.12.13.3.2.2.3.2.1" stretchy="false" xref="S2.E2.m1.12.13.3.2.2.3.1.cmml">(</mo><mi id="S2.E2.m1.11.11" xref="S2.E2.m1.11.11.cmml">q</mi><mo id="S2.E2.m1.12.13.3.2.2.3.2.2" xref="S2.E2.m1.12.13.3.2.2.3.1.cmml">,</mo><mi id="S2.E2.m1.12.12" xref="S2.E2.m1.12.12.cmml">x</mi><mo id="S2.E2.m1.12.13.3.2.2.3.2.3" stretchy="false" xref="S2.E2.m1.12.13.3.2.2.3.1.cmml">)</mo></mrow><mo id="S2.E2.m1.12.13.3.2.2.1a" xref="S2.E2.m1.12.13.3.2.2.1.cmml">⁢</mo><mrow id="S2.E2.m1.12.13.3.2.2.4.2" xref="S2.E2.m1.12.13.3.2.2.4.1.cmml"><mo id="S2.E2.m1.12.13.3.2.2.4.2.1" xref="S2.E2.m1.12.13.3.2.2.4.1.cmml">⟨</mo><mfrac id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.cmml"><msub id="S2.E2.m1.3.3.1.3" xref="S2.E2.m1.3.3.1.3.cmml"><mi id="S2.E2.m1.3.3.1.3.2" xref="S2.E2.m1.3.3.1.3.2.cmml">f</mi><msub id="S2.E2.m1.3.3.1.3.3" xref="S2.E2.m1.3.3.1.3.3.cmml"><mi id="S2.E2.m1.3.3.1.3.3.2" xref="S2.E2.m1.3.3.1.3.3.2.cmml">p</mi><mi id="S2.E2.m1.3.3.1.3.3.3" xref="S2.E2.m1.3.3.1.3.3.3.cmml">q</mi></msub></msub><mo id="S2.E2.m1.3.3.1.2" xref="S2.E2.m1.3.3.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.3.3.1.4.2" xref="S2.E2.m1.3.3.1.cmml"><mo id="S2.E2.m1.3.3.1.4.2.1" stretchy="false" xref="S2.E2.m1.3.3.1.cmml">(</mo><mi id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml">q</mi><mo id="S2.E2.m1.3.3.1.4.2.2" stretchy="false" xref="S2.E2.m1.3.3.1.cmml">)</mo></mrow></mrow><msub id="S2.E2.m1.5.5.3" xref="S2.E2.m1.5.5.3.cmml"><mrow id="S2.E2.m1.5.5.3.2.1" xref="S2.E2.m1.5.5.3.2.2.cmml"><mo id="S2.E2.m1.5.5.3.2.1.2" stretchy="false" xref="S2.E2.m1.5.5.3.2.2.1.cmml">‖</mo><mrow id="S2.E2.m1.5.5.3.2.1.1" xref="S2.E2.m1.5.5.3.2.1.1.cmml"><msub id="S2.E2.m1.5.5.3.2.1.1.2" xref="S2.E2.m1.5.5.3.2.1.1.2.cmml"><mi id="S2.E2.m1.5.5.3.2.1.1.2.2" xref="S2.E2.m1.5.5.3.2.1.1.2.2.cmml">f</mi><msub id="S2.E2.m1.5.5.3.2.1.1.2.3" xref="S2.E2.m1.5.5.3.2.1.1.2.3.cmml"><mi id="S2.E2.m1.5.5.3.2.1.1.2.3.2" xref="S2.E2.m1.5.5.3.2.1.1.2.3.2.cmml">p</mi><mi id="S2.E2.m1.5.5.3.2.1.1.2.3.3" xref="S2.E2.m1.5.5.3.2.1.1.2.3.3.cmml">q</mi></msub></msub><mo id="S2.E2.m1.5.5.3.2.1.1.1" xref="S2.E2.m1.5.5.3.2.1.1.1.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.3.2.1.1.3.2" xref="S2.E2.m1.5.5.3.2.1.1.cmml"><mo id="S2.E2.m1.5.5.3.2.1.1.3.2.1" stretchy="false" xref="S2.E2.m1.5.5.3.2.1.1.cmml">(</mo><mi id="S2.E2.m1.4.4.2.1" xref="S2.E2.m1.4.4.2.1.cmml">q</mi><mo id="S2.E2.m1.5.5.3.2.1.1.3.2.2" stretchy="false" xref="S2.E2.m1.5.5.3.2.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.5.5.3.2.1.3" stretchy="false" xref="S2.E2.m1.5.5.3.2.2.1.cmml">‖</mo></mrow><mn id="S2.E2.m1.5.5.3.4" xref="S2.E2.m1.5.5.3.4.cmml">2</mn></msub></mfrac><mo id="S2.E2.m1.12.13.3.2.2.4.2.2" xref="S2.E2.m1.12.13.3.2.2.4.1.cmml">,</mo><mfrac id="S2.E2.m1.8.8" xref="S2.E2.m1.8.8.cmml"><mrow id="S2.E2.m1.6.6.1" xref="S2.E2.m1.6.6.1.cmml"><msub id="S2.E2.m1.6.6.1.3" xref="S2.E2.m1.6.6.1.3.cmml"><mi id="S2.E2.m1.6.6.1.3.2" xref="S2.E2.m1.6.6.1.3.2.cmml">g</mi><msub id="S2.E2.m1.6.6.1.3.3" xref="S2.E2.m1.6.6.1.3.3.cmml"><mi id="S2.E2.m1.6.6.1.3.3.2" xref="S2.E2.m1.6.6.1.3.3.2.cmml">p</mi><mi id="S2.E2.m1.6.6.1.3.3.3" xref="S2.E2.m1.6.6.1.3.3.3.cmml">x</mi></msub></msub><mo id="S2.E2.m1.6.6.1.2" xref="S2.E2.m1.6.6.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.1.4.2" xref="S2.E2.m1.6.6.1.cmml"><mo id="S2.E2.m1.6.6.1.4.2.1" stretchy="false" xref="S2.E2.m1.6.6.1.cmml">(</mo><mi id="S2.E2.m1.6.6.1.1" xref="S2.E2.m1.6.6.1.1.cmml">x</mi><mo id="S2.E2.m1.6.6.1.4.2.2" stretchy="false" xref="S2.E2.m1.6.6.1.cmml">)</mo></mrow></mrow><msub id="S2.E2.m1.8.8.3" xref="S2.E2.m1.8.8.3.cmml"><mrow id="S2.E2.m1.8.8.3.2.1" xref="S2.E2.m1.8.8.3.2.2.cmml"><mo id="S2.E2.m1.8.8.3.2.1.2" stretchy="false" xref="S2.E2.m1.8.8.3.2.2.1.cmml">‖</mo><mrow id="S2.E2.m1.8.8.3.2.1.1" xref="S2.E2.m1.8.8.3.2.1.1.cmml"><msub id="S2.E2.m1.8.8.3.2.1.1.2" xref="S2.E2.m1.8.8.3.2.1.1.2.cmml"><mi id="S2.E2.m1.8.8.3.2.1.1.2.2" xref="S2.E2.m1.8.8.3.2.1.1.2.2.cmml">g</mi><msub id="S2.E2.m1.8.8.3.2.1.1.2.3" xref="S2.E2.m1.8.8.3.2.1.1.2.3.cmml"><mi id="S2.E2.m1.8.8.3.2.1.1.2.3.2" xref="S2.E2.m1.8.8.3.2.1.1.2.3.2.cmml">p</mi><mi id="S2.E2.m1.8.8.3.2.1.1.2.3.3" xref="S2.E2.m1.8.8.3.2.1.1.2.3.3.cmml">x</mi></msub></msub><mo id="S2.E2.m1.8.8.3.2.1.1.1" xref="S2.E2.m1.8.8.3.2.1.1.1.cmml">⁢</mo><mrow id="S2.E2.m1.8.8.3.2.1.1.3.2" xref="S2.E2.m1.8.8.3.2.1.1.cmml"><mo id="S2.E2.m1.8.8.3.2.1.1.3.2.1" stretchy="false" xref="S2.E2.m1.8.8.3.2.1.1.cmml">(</mo><mi id="S2.E2.m1.7.7.2.1" xref="S2.E2.m1.7.7.2.1.cmml">x</mi><mo id="S2.E2.m1.8.8.3.2.1.1.3.2.2" stretchy="false" xref="S2.E2.m1.8.8.3.2.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.8.8.3.2.1.3" stretchy="false" xref="S2.E2.m1.8.8.3.2.2.1.cmml">‖</mo></mrow><mn id="S2.E2.m1.8.8.3.4" xref="S2.E2.m1.8.8.3.4.cmml">2</mn></msub></mfrac><mo id="S2.E2.m1.12.13.3.2.2.4.2.3" xref="S2.E2.m1.12.13.3.2.2.4.1.cmml">⟩</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.12b"><apply id="S2.E2.m1.12.13.cmml" xref="S2.E2.m1.12.13"><eq id="S2.E2.m1.12.13.1.cmml" xref="S2.E2.m1.12.13.1"></eq><apply id="S2.E2.m1.12.13.2.cmml" xref="S2.E2.m1.12.13.2"><times id="S2.E2.m1.12.13.2.1.cmml" xref="S2.E2.m1.12.13.2.1"></times><ci id="S2.E2.m1.12.13.2.2.cmml" xref="S2.E2.m1.12.13.2.2">italic-ϕ</ci><interval closure="open" id="S2.E2.m1.12.13.2.3.1.cmml" xref="S2.E2.m1.12.13.2.3.2"><ci id="S2.E2.m1.9.9.cmml" xref="S2.E2.m1.9.9">𝑞</ci><ci id="S2.E2.m1.10.10.cmml" xref="S2.E2.m1.10.10">𝑥</ci></interval></apply><apply id="S2.E2.m1.12.13.3.cmml" xref="S2.E2.m1.12.13.3"><apply id="S2.E2.m1.12.13.3.1.cmml" xref="S2.E2.m1.12.13.3.1"><csymbol cd="ambiguous" id="S2.E2.m1.12.13.3.1.1.cmml" xref="S2.E2.m1.12.13.3.1">superscript</csymbol><apply id="S2.E2.m1.12.13.3.1.2.cmml" xref="S2.E2.m1.12.13.3.1"><csymbol cd="ambiguous" id="S2.E2.m1.12.13.3.1.2.1.cmml" xref="S2.E2.m1.12.13.3.1">subscript</csymbol><sum id="S2.E2.m1.12.13.3.1.2.2.cmml" xref="S2.E2.m1.12.13.3.1.2.2"></sum><apply id="S2.E2.m1.12.13.3.1.2.3.cmml" xref="S2.E2.m1.12.13.3.1.2.3"><eq id="S2.E2.m1.12.13.3.1.2.3.1.cmml" xref="S2.E2.m1.12.13.3.1.2.3.1"></eq><apply id="S2.E2.m1.12.13.3.1.2.3.2.cmml" xref="S2.E2.m1.12.13.3.1.2.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.12.13.3.1.2.3.2.1.cmml" xref="S2.E2.m1.12.13.3.1.2.3.2">subscript</csymbol><ci id="S2.E2.m1.12.13.3.1.2.3.2.2.cmml" xref="S2.E2.m1.12.13.3.1.2.3.2.2">𝑝</ci><ci id="S2.E2.m1.12.13.3.1.2.3.2.3.cmml" xref="S2.E2.m1.12.13.3.1.2.3.2.3">𝑞</ci></apply><cn id="S2.E2.m1.12.13.3.1.2.3.3.cmml" type="integer" xref="S2.E2.m1.12.13.3.1.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.12.13.3.1.3.cmml" xref="S2.E2.m1.12.13.3.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.12.13.3.1.3.1.cmml" xref="S2.E2.m1.12.13.3.1.3">subscript</csymbol><ci id="S2.E2.m1.12.13.3.1.3.2.cmml" xref="S2.E2.m1.12.13.3.1.3.2">𝑃</ci><ci id="S2.E2.m1.12.13.3.1.3.3.cmml" xref="S2.E2.m1.12.13.3.1.3.3">𝑞</ci></apply></apply><apply id="S2.E2.m1.12.13.3.2.cmml" xref="S2.E2.m1.12.13.3.2"><apply id="S2.E2.m1.12.13.3.2.1.cmml" xref="S2.E2.m1.12.13.3.2.1"><csymbol cd="ambiguous" id="S2.E2.m1.12.13.3.2.1.1.cmml" xref="S2.E2.m1.12.13.3.2.1">superscript</csymbol><apply id="S2.E2.m1.12.13.3.2.1.2.cmml" xref="S2.E2.m1.12.13.3.2.1"><csymbol cd="ambiguous" id="S2.E2.m1.12.13.3.2.1.2.1.cmml" xref="S2.E2.m1.12.13.3.2.1">subscript</csymbol><sum id="S2.E2.m1.12.13.3.2.1.2.2.cmml" xref="S2.E2.m1.12.13.3.2.1.2.2"></sum><apply id="S2.E2.m1.12.13.3.2.1.2.3.cmml" xref="S2.E2.m1.12.13.3.2.1.2.3"><eq id="S2.E2.m1.12.13.3.2.1.2.3.1.cmml" xref="S2.E2.m1.12.13.3.2.1.2.3.1"></eq><apply id="S2.E2.m1.12.13.3.2.1.2.3.2.cmml" xref="S2.E2.m1.12.13.3.2.1.2.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.12.13.3.2.1.2.3.2.1.cmml" xref="S2.E2.m1.12.13.3.2.1.2.3.2">subscript</csymbol><ci id="S2.E2.m1.12.13.3.2.1.2.3.2.2.cmml" xref="S2.E2.m1.12.13.3.2.1.2.3.2.2">𝑝</ci><ci id="S2.E2.m1.12.13.3.2.1.2.3.2.3.cmml" xref="S2.E2.m1.12.13.3.2.1.2.3.2.3">𝑥</ci></apply><cn id="S2.E2.m1.12.13.3.2.1.2.3.3.cmml" type="integer" xref="S2.E2.m1.12.13.3.2.1.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.12.13.3.2.1.3.cmml" xref="S2.E2.m1.12.13.3.2.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.12.13.3.2.1.3.1.cmml" xref="S2.E2.m1.12.13.3.2.1.3">subscript</csymbol><ci id="S2.E2.m1.12.13.3.2.1.3.2.cmml" xref="S2.E2.m1.12.13.3.2.1.3.2">𝑃</ci><ci id="S2.E2.m1.12.13.3.2.1.3.3.cmml" xref="S2.E2.m1.12.13.3.2.1.3.3">𝑥</ci></apply></apply><apply id="S2.E2.m1.12.13.3.2.2.cmml" xref="S2.E2.m1.12.13.3.2.2"><times id="S2.E2.m1.12.13.3.2.2.1.cmml" xref="S2.E2.m1.12.13.3.2.2.1"></times><apply id="S2.E2.m1.12.13.3.2.2.2.cmml" xref="S2.E2.m1.12.13.3.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.12.13.3.2.2.2.1.cmml" xref="S2.E2.m1.12.13.3.2.2.2">subscript</csymbol><ci id="S2.E2.m1.12.13.3.2.2.2.2.cmml" xref="S2.E2.m1.12.13.3.2.2.2.2">𝜋</ci><list id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2"><apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2">𝑝</ci><ci id="S2.E2.m1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S2.E2.m1.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2">𝑝</ci><ci id="S2.E2.m1.2.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.2.3">𝑥</ci></apply></list></apply><interval closure="open" id="S2.E2.m1.12.13.3.2.2.3.1.cmml" xref="S2.E2.m1.12.13.3.2.2.3.2"><ci id="S2.E2.m1.11.11.cmml" xref="S2.E2.m1.11.11">𝑞</ci><ci id="S2.E2.m1.12.12.cmml" xref="S2.E2.m1.12.12">𝑥</ci></interval><list id="S2.E2.m1.12.13.3.2.2.4.1.cmml" xref="S2.E2.m1.12.13.3.2.2.4.2"><apply id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5"><divide id="S2.E2.m1.5.5.4.cmml" xref="S2.E2.m1.5.5"></divide><apply id="S2.E2.m1.3.3.1.cmml" xref="S2.E2.m1.3.3.1"><times id="S2.E2.m1.3.3.1.2.cmml" xref="S2.E2.m1.3.3.1.2"></times><apply id="S2.E2.m1.3.3.1.3.cmml" xref="S2.E2.m1.3.3.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.3.1.cmml" xref="S2.E2.m1.3.3.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.3.2.cmml" xref="S2.E2.m1.3.3.1.3.2">𝑓</ci><apply id="S2.E2.m1.3.3.1.3.3.cmml" xref="S2.E2.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.3.3.1.cmml" xref="S2.E2.m1.3.3.1.3.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.3.3.2.cmml" xref="S2.E2.m1.3.3.1.3.3.2">𝑝</ci><ci id="S2.E2.m1.3.3.1.3.3.3.cmml" xref="S2.E2.m1.3.3.1.3.3.3">𝑞</ci></apply></apply><ci id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1.1">𝑞</ci></apply><apply id="S2.E2.m1.5.5.3.cmml" xref="S2.E2.m1.5.5.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.3.3.cmml" xref="S2.E2.m1.5.5.3">subscript</csymbol><apply id="S2.E2.m1.5.5.3.2.2.cmml" xref="S2.E2.m1.5.5.3.2.1"><csymbol cd="latexml" id="S2.E2.m1.5.5.3.2.2.1.cmml" xref="S2.E2.m1.5.5.3.2.1.2">norm</csymbol><apply id="S2.E2.m1.5.5.3.2.1.1.cmml" xref="S2.E2.m1.5.5.3.2.1.1"><times id="S2.E2.m1.5.5.3.2.1.1.1.cmml" xref="S2.E2.m1.5.5.3.2.1.1.1"></times><apply id="S2.E2.m1.5.5.3.2.1.1.2.cmml" xref="S2.E2.m1.5.5.3.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.3.2.1.1.2.1.cmml" xref="S2.E2.m1.5.5.3.2.1.1.2">subscript</csymbol><ci id="S2.E2.m1.5.5.3.2.1.1.2.2.cmml" xref="S2.E2.m1.5.5.3.2.1.1.2.2">𝑓</ci><apply id="S2.E2.m1.5.5.3.2.1.1.2.3.cmml" xref="S2.E2.m1.5.5.3.2.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.3.2.1.1.2.3.1.cmml" xref="S2.E2.m1.5.5.3.2.1.1.2.3">subscript</csymbol><ci id="S2.E2.m1.5.5.3.2.1.1.2.3.2.cmml" xref="S2.E2.m1.5.5.3.2.1.1.2.3.2">𝑝</ci><ci id="S2.E2.m1.5.5.3.2.1.1.2.3.3.cmml" xref="S2.E2.m1.5.5.3.2.1.1.2.3.3">𝑞</ci></apply></apply><ci id="S2.E2.m1.4.4.2.1.cmml" xref="S2.E2.m1.4.4.2.1">𝑞</ci></apply></apply><cn id="S2.E2.m1.5.5.3.4.cmml" type="integer" xref="S2.E2.m1.5.5.3.4">2</cn></apply></apply><apply id="S2.E2.m1.8.8.cmml" xref="S2.E2.m1.8.8"><divide id="S2.E2.m1.8.8.4.cmml" xref="S2.E2.m1.8.8"></divide><apply id="S2.E2.m1.6.6.1.cmml" xref="S2.E2.m1.6.6.1"><times id="S2.E2.m1.6.6.1.2.cmml" xref="S2.E2.m1.6.6.1.2"></times><apply id="S2.E2.m1.6.6.1.3.cmml" xref="S2.E2.m1.6.6.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.3.1.cmml" xref="S2.E2.m1.6.6.1.3">subscript</csymbol><ci id="S2.E2.m1.6.6.1.3.2.cmml" xref="S2.E2.m1.6.6.1.3.2">𝑔</ci><apply id="S2.E2.m1.6.6.1.3.3.cmml" xref="S2.E2.m1.6.6.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.3.3.1.cmml" xref="S2.E2.m1.6.6.1.3.3">subscript</csymbol><ci id="S2.E2.m1.6.6.1.3.3.2.cmml" xref="S2.E2.m1.6.6.1.3.3.2">𝑝</ci><ci id="S2.E2.m1.6.6.1.3.3.3.cmml" xref="S2.E2.m1.6.6.1.3.3.3">𝑥</ci></apply></apply><ci id="S2.E2.m1.6.6.1.1.cmml" xref="S2.E2.m1.6.6.1.1">𝑥</ci></apply><apply id="S2.E2.m1.8.8.3.cmml" xref="S2.E2.m1.8.8.3"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.3.3.cmml" xref="S2.E2.m1.8.8.3">subscript</csymbol><apply id="S2.E2.m1.8.8.3.2.2.cmml" xref="S2.E2.m1.8.8.3.2.1"><csymbol cd="latexml" id="S2.E2.m1.8.8.3.2.2.1.cmml" xref="S2.E2.m1.8.8.3.2.1.2">norm</csymbol><apply id="S2.E2.m1.8.8.3.2.1.1.cmml" xref="S2.E2.m1.8.8.3.2.1.1"><times id="S2.E2.m1.8.8.3.2.1.1.1.cmml" xref="S2.E2.m1.8.8.3.2.1.1.1"></times><apply id="S2.E2.m1.8.8.3.2.1.1.2.cmml" xref="S2.E2.m1.8.8.3.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.3.2.1.1.2.1.cmml" xref="S2.E2.m1.8.8.3.2.1.1.2">subscript</csymbol><ci id="S2.E2.m1.8.8.3.2.1.1.2.2.cmml" xref="S2.E2.m1.8.8.3.2.1.1.2.2">𝑔</ci><apply id="S2.E2.m1.8.8.3.2.1.1.2.3.cmml" xref="S2.E2.m1.8.8.3.2.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.3.2.1.1.2.3.1.cmml" xref="S2.E2.m1.8.8.3.2.1.1.2.3">subscript</csymbol><ci id="S2.E2.m1.8.8.3.2.1.1.2.3.2.cmml" xref="S2.E2.m1.8.8.3.2.1.1.2.3.2">𝑝</ci><ci id="S2.E2.m1.8.8.3.2.1.1.2.3.3.cmml" xref="S2.E2.m1.8.8.3.2.1.1.2.3.3">𝑥</ci></apply></apply><ci id="S2.E2.m1.7.7.2.1.cmml" xref="S2.E2.m1.7.7.2.1">𝑥</ci></apply></apply><cn id="S2.E2.m1.8.8.3.4.cmml" type="integer" xref="S2.E2.m1.8.8.3.4">2</cn></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.12c">\phi(q,x)=\sum_{p_{q}=1}^{P_{q}}\sum_{p_{x}=1}^{P_{x}}\pi_{p_{q},p_{x}}(q,x)%
\left\langle\frac{f_{p_{q}}(q)}{||f_{p_{q}}(q)||_{2}},\frac{g_{p_{x}}(x)}{||g_%
{p_{x}}(x)||_{2}}\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.12d">italic_ϕ ( italic_q , italic_x ) = ∑ start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_q , italic_x ) ⟨ divide start_ARG italic_f start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_q ) end_ARG start_ARG | | italic_f start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_q ) | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG , divide start_ARG italic_g start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x ) end_ARG start_ARG | | italic_g start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x ) | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG ⟩</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p2.8">We use Equation <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S2.E1" title="In Mixture of Logits (MoL) ‣ 2 Expressiveness of Mixture of Logits ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S2.E2" title="In Mixture of Logits (MoL) ‣ 2 Expressiveness of Mixture of Logits ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">2</span></a> interchangeably as the MoL form to analyze throughout the rest of this paper, given that the embedding normalization for <math alttext="f_{p_{q}}(q)" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.7.m1.1"><semantics id="S2.SS0.SSS0.Px1.p2.7.m1.1a"><mrow id="S2.SS0.SSS0.Px1.p2.7.m1.1.2" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.cmml"><msub id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.2" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.2.cmml">f</mi><msub id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3.2" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3.2.cmml">p</mi><mi id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3.3" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3.3.cmml">q</mi></msub></msub><mo id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.1" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.3.2" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p2.7.m1.1.1" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.1.cmml">q</mi><mo id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.7.m1.1b"><apply id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2"><times id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.1"></times><apply id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.2">𝑓</ci><apply id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3.2">𝑝</ci><ci id="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.2.2.3.3">𝑞</ci></apply></apply><ci id="S2.SS0.SSS0.Px1.p2.7.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.7.m1.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.7.m1.1c">f_{p_{q}}(q)</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.7.m1.1d">italic_f start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math>s and <math alttext="g_{p_{x}}(x)" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.8.m2.1"><semantics id="S2.SS0.SSS0.Px1.p2.8.m2.1a"><mrow id="S2.SS0.SSS0.Px1.p2.8.m2.1.2" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.cmml"><msub id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.2" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.2.cmml">g</mi><msub id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3.2" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3.2.cmml">p</mi><mi id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3.3" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3.3.cmml">x</mi></msub></msub><mo id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.1" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.3.2" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p2.8.m2.1.1" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.1.cmml">x</mi><mo id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.3.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.8.m2.1b"><apply id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2"><times id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.1"></times><apply id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.2">𝑔</ci><apply id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3.2">𝑝</ci><ci id="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.2.2.3.3">𝑥</ci></apply></apply><ci id="S2.SS0.SSS0.Px1.p2.8.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.8.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.8.m2.1c">g_{p_{x}}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p2.8.m2.1d">italic_g start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math>s can be precomputed.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="272" id="S2.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S2.F1.3.2" style="font-size:90%;">Mixture-of-logits (MoL) learned similarity.</span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p3">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p3.1">Now we show that any high rank matrix can be decomposed into a mixture of logits based on low rank matrices. Specifically, without loss of generality, we prove the following:</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmtheorem1.1.1.1">Theorem 1</span></span><span class="ltx_text ltx_font_bold" id="Thmtheorem1.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmtheorem1.p1">
<p class="ltx_p" id="Thmtheorem1.p1.14"><span class="ltx_text ltx_font_bold ltx_font_italic" id="Thmtheorem1.p1.14.14">MoL decomposition<span class="ltx_text ltx_font_medium" id="Thmtheorem1.p1.14.14.14">: Let <math alttext="A" class="ltx_Math" display="inline" id="Thmtheorem1.p1.1.1.1.m1.1"><semantics id="Thmtheorem1.p1.1.1.1.m1.1a"><mi id="Thmtheorem1.p1.1.1.1.m1.1.1" mathvariant="normal" xref="Thmtheorem1.p1.1.1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.1.1.1.m1.1b"><ci id="Thmtheorem1.p1.1.1.1.m1.1.1.cmml" xref="Thmtheorem1.p1.1.1.1.m1.1.1">A</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.1.1.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.1.1.1.m1.1d">italic_A</annotation></semantics></math> be a matrix of <math alttext="n\times m" class="ltx_Math" display="inline" id="Thmtheorem1.p1.2.2.2.m2.1"><semantics id="Thmtheorem1.p1.2.2.2.m2.1a"><mrow id="Thmtheorem1.p1.2.2.2.m2.1.1" xref="Thmtheorem1.p1.2.2.2.m2.1.1.cmml"><mi id="Thmtheorem1.p1.2.2.2.m2.1.1.2" mathvariant="normal" xref="Thmtheorem1.p1.2.2.2.m2.1.1.2.cmml">n</mi><mo id="Thmtheorem1.p1.2.2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="Thmtheorem1.p1.2.2.2.m2.1.1.1.cmml">×</mo><mi id="Thmtheorem1.p1.2.2.2.m2.1.1.3" mathvariant="normal" xref="Thmtheorem1.p1.2.2.2.m2.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.2.2.2.m2.1b"><apply id="Thmtheorem1.p1.2.2.2.m2.1.1.cmml" xref="Thmtheorem1.p1.2.2.2.m2.1.1"><times id="Thmtheorem1.p1.2.2.2.m2.1.1.1.cmml" xref="Thmtheorem1.p1.2.2.2.m2.1.1.1"></times><ci id="Thmtheorem1.p1.2.2.2.m2.1.1.2.cmml" xref="Thmtheorem1.p1.2.2.2.m2.1.1.2">n</ci><ci id="Thmtheorem1.p1.2.2.2.m2.1.1.3.cmml" xref="Thmtheorem1.p1.2.2.2.m2.1.1.3">m</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.2.2.2.m2.1c">n\times m</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.2.2.2.m2.1d">italic_n × italic_m</annotation></semantics></math>, where <math alttext="n\leq m" class="ltx_Math" display="inline" id="Thmtheorem1.p1.3.3.3.m3.1"><semantics id="Thmtheorem1.p1.3.3.3.m3.1a"><mrow id="Thmtheorem1.p1.3.3.3.m3.1.1" xref="Thmtheorem1.p1.3.3.3.m3.1.1.cmml"><mi id="Thmtheorem1.p1.3.3.3.m3.1.1.2" mathvariant="normal" xref="Thmtheorem1.p1.3.3.3.m3.1.1.2.cmml">n</mi><mo id="Thmtheorem1.p1.3.3.3.m3.1.1.1" xref="Thmtheorem1.p1.3.3.3.m3.1.1.1.cmml">≤</mo><mi id="Thmtheorem1.p1.3.3.3.m3.1.1.3" mathvariant="normal" xref="Thmtheorem1.p1.3.3.3.m3.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.3.3.3.m3.1b"><apply id="Thmtheorem1.p1.3.3.3.m3.1.1.cmml" xref="Thmtheorem1.p1.3.3.3.m3.1.1"><leq id="Thmtheorem1.p1.3.3.3.m3.1.1.1.cmml" xref="Thmtheorem1.p1.3.3.3.m3.1.1.1"></leq><ci id="Thmtheorem1.p1.3.3.3.m3.1.1.2.cmml" xref="Thmtheorem1.p1.3.3.3.m3.1.1.2">n</ci><ci id="Thmtheorem1.p1.3.3.3.m3.1.1.3.cmml" xref="Thmtheorem1.p1.3.3.3.m3.1.1.3">m</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.3.3.3.m3.1c">n\leq m</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.3.3.3.m3.1d">italic_n ≤ italic_m</annotation></semantics></math>. There exists <math alttext="\pi_{1},B_{1},\pi_{2},B_{2},\cdots,\pi_{p},B_{p}" class="ltx_Math" display="inline" id="Thmtheorem1.p1.4.4.4.m4.7"><semantics id="Thmtheorem1.p1.4.4.4.m4.7a"><mrow id="Thmtheorem1.p1.4.4.4.m4.7.7.6" xref="Thmtheorem1.p1.4.4.4.m4.7.7.7.cmml"><msub id="Thmtheorem1.p1.4.4.4.m4.2.2.1.1" xref="Thmtheorem1.p1.4.4.4.m4.2.2.1.1.cmml"><mi id="Thmtheorem1.p1.4.4.4.m4.2.2.1.1.2" mathvariant="normal" xref="Thmtheorem1.p1.4.4.4.m4.2.2.1.1.2.cmml">π</mi><mn id="Thmtheorem1.p1.4.4.4.m4.2.2.1.1.3" xref="Thmtheorem1.p1.4.4.4.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="Thmtheorem1.p1.4.4.4.m4.7.7.6.7" xref="Thmtheorem1.p1.4.4.4.m4.7.7.7.cmml">,</mo><msub id="Thmtheorem1.p1.4.4.4.m4.3.3.2.2" xref="Thmtheorem1.p1.4.4.4.m4.3.3.2.2.cmml"><mi id="Thmtheorem1.p1.4.4.4.m4.3.3.2.2.2" mathvariant="normal" xref="Thmtheorem1.p1.4.4.4.m4.3.3.2.2.2.cmml">B</mi><mn id="Thmtheorem1.p1.4.4.4.m4.3.3.2.2.3" xref="Thmtheorem1.p1.4.4.4.m4.3.3.2.2.3.cmml">1</mn></msub><mo id="Thmtheorem1.p1.4.4.4.m4.7.7.6.8" xref="Thmtheorem1.p1.4.4.4.m4.7.7.7.cmml">,</mo><msub id="Thmtheorem1.p1.4.4.4.m4.4.4.3.3" xref="Thmtheorem1.p1.4.4.4.m4.4.4.3.3.cmml"><mi id="Thmtheorem1.p1.4.4.4.m4.4.4.3.3.2" mathvariant="normal" xref="Thmtheorem1.p1.4.4.4.m4.4.4.3.3.2.cmml">π</mi><mn id="Thmtheorem1.p1.4.4.4.m4.4.4.3.3.3" xref="Thmtheorem1.p1.4.4.4.m4.4.4.3.3.3.cmml">2</mn></msub><mo id="Thmtheorem1.p1.4.4.4.m4.7.7.6.9" xref="Thmtheorem1.p1.4.4.4.m4.7.7.7.cmml">,</mo><msub id="Thmtheorem1.p1.4.4.4.m4.5.5.4.4" xref="Thmtheorem1.p1.4.4.4.m4.5.5.4.4.cmml"><mi id="Thmtheorem1.p1.4.4.4.m4.5.5.4.4.2" mathvariant="normal" xref="Thmtheorem1.p1.4.4.4.m4.5.5.4.4.2.cmml">B</mi><mn id="Thmtheorem1.p1.4.4.4.m4.5.5.4.4.3" xref="Thmtheorem1.p1.4.4.4.m4.5.5.4.4.3.cmml">2</mn></msub><mo id="Thmtheorem1.p1.4.4.4.m4.7.7.6.10" xref="Thmtheorem1.p1.4.4.4.m4.7.7.7.cmml">,</mo><mi id="Thmtheorem1.p1.4.4.4.m4.1.1" mathvariant="normal" xref="Thmtheorem1.p1.4.4.4.m4.1.1.cmml">⋯</mi><mo id="Thmtheorem1.p1.4.4.4.m4.7.7.6.11" xref="Thmtheorem1.p1.4.4.4.m4.7.7.7.cmml">,</mo><msub id="Thmtheorem1.p1.4.4.4.m4.6.6.5.5" xref="Thmtheorem1.p1.4.4.4.m4.6.6.5.5.cmml"><mi id="Thmtheorem1.p1.4.4.4.m4.6.6.5.5.2" mathvariant="normal" xref="Thmtheorem1.p1.4.4.4.m4.6.6.5.5.2.cmml">π</mi><mi id="Thmtheorem1.p1.4.4.4.m4.6.6.5.5.3" mathvariant="normal" xref="Thmtheorem1.p1.4.4.4.m4.6.6.5.5.3.cmml">p</mi></msub><mo id="Thmtheorem1.p1.4.4.4.m4.7.7.6.12" xref="Thmtheorem1.p1.4.4.4.m4.7.7.7.cmml">,</mo><msub id="Thmtheorem1.p1.4.4.4.m4.7.7.6.6" xref="Thmtheorem1.p1.4.4.4.m4.7.7.6.6.cmml"><mi id="Thmtheorem1.p1.4.4.4.m4.7.7.6.6.2" mathvariant="normal" xref="Thmtheorem1.p1.4.4.4.m4.7.7.6.6.2.cmml">B</mi><mi id="Thmtheorem1.p1.4.4.4.m4.7.7.6.6.3" mathvariant="normal" xref="Thmtheorem1.p1.4.4.4.m4.7.7.6.6.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.4.4.4.m4.7b"><list id="Thmtheorem1.p1.4.4.4.m4.7.7.7.cmml" xref="Thmtheorem1.p1.4.4.4.m4.7.7.6"><apply id="Thmtheorem1.p1.4.4.4.m4.2.2.1.1.cmml" xref="Thmtheorem1.p1.4.4.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="Thmtheorem1.p1.4.4.4.m4.2.2.1.1.1.cmml" xref="Thmtheorem1.p1.4.4.4.m4.2.2.1.1">subscript</csymbol><ci id="Thmtheorem1.p1.4.4.4.m4.2.2.1.1.2.cmml" xref="Thmtheorem1.p1.4.4.4.m4.2.2.1.1.2">π</ci><cn id="Thmtheorem1.p1.4.4.4.m4.2.2.1.1.3.cmml" type="integer" xref="Thmtheorem1.p1.4.4.4.m4.2.2.1.1.3">1</cn></apply><apply id="Thmtheorem1.p1.4.4.4.m4.3.3.2.2.cmml" xref="Thmtheorem1.p1.4.4.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="Thmtheorem1.p1.4.4.4.m4.3.3.2.2.1.cmml" xref="Thmtheorem1.p1.4.4.4.m4.3.3.2.2">subscript</csymbol><ci id="Thmtheorem1.p1.4.4.4.m4.3.3.2.2.2.cmml" xref="Thmtheorem1.p1.4.4.4.m4.3.3.2.2.2">B</ci><cn id="Thmtheorem1.p1.4.4.4.m4.3.3.2.2.3.cmml" type="integer" xref="Thmtheorem1.p1.4.4.4.m4.3.3.2.2.3">1</cn></apply><apply id="Thmtheorem1.p1.4.4.4.m4.4.4.3.3.cmml" xref="Thmtheorem1.p1.4.4.4.m4.4.4.3.3"><csymbol cd="ambiguous" id="Thmtheorem1.p1.4.4.4.m4.4.4.3.3.1.cmml" xref="Thmtheorem1.p1.4.4.4.m4.4.4.3.3">subscript</csymbol><ci id="Thmtheorem1.p1.4.4.4.m4.4.4.3.3.2.cmml" xref="Thmtheorem1.p1.4.4.4.m4.4.4.3.3.2">π</ci><cn id="Thmtheorem1.p1.4.4.4.m4.4.4.3.3.3.cmml" type="integer" xref="Thmtheorem1.p1.4.4.4.m4.4.4.3.3.3">2</cn></apply><apply id="Thmtheorem1.p1.4.4.4.m4.5.5.4.4.cmml" xref="Thmtheorem1.p1.4.4.4.m4.5.5.4.4"><csymbol cd="ambiguous" id="Thmtheorem1.p1.4.4.4.m4.5.5.4.4.1.cmml" xref="Thmtheorem1.p1.4.4.4.m4.5.5.4.4">subscript</csymbol><ci id="Thmtheorem1.p1.4.4.4.m4.5.5.4.4.2.cmml" xref="Thmtheorem1.p1.4.4.4.m4.5.5.4.4.2">B</ci><cn id="Thmtheorem1.p1.4.4.4.m4.5.5.4.4.3.cmml" type="integer" xref="Thmtheorem1.p1.4.4.4.m4.5.5.4.4.3">2</cn></apply><ci id="Thmtheorem1.p1.4.4.4.m4.1.1.cmml" xref="Thmtheorem1.p1.4.4.4.m4.1.1">⋯</ci><apply id="Thmtheorem1.p1.4.4.4.m4.6.6.5.5.cmml" xref="Thmtheorem1.p1.4.4.4.m4.6.6.5.5"><csymbol cd="ambiguous" id="Thmtheorem1.p1.4.4.4.m4.6.6.5.5.1.cmml" xref="Thmtheorem1.p1.4.4.4.m4.6.6.5.5">subscript</csymbol><ci id="Thmtheorem1.p1.4.4.4.m4.6.6.5.5.2.cmml" xref="Thmtheorem1.p1.4.4.4.m4.6.6.5.5.2">π</ci><ci id="Thmtheorem1.p1.4.4.4.m4.6.6.5.5.3.cmml" xref="Thmtheorem1.p1.4.4.4.m4.6.6.5.5.3">p</ci></apply><apply id="Thmtheorem1.p1.4.4.4.m4.7.7.6.6.cmml" xref="Thmtheorem1.p1.4.4.4.m4.7.7.6.6"><csymbol cd="ambiguous" id="Thmtheorem1.p1.4.4.4.m4.7.7.6.6.1.cmml" xref="Thmtheorem1.p1.4.4.4.m4.7.7.6.6">subscript</csymbol><ci id="Thmtheorem1.p1.4.4.4.m4.7.7.6.6.2.cmml" xref="Thmtheorem1.p1.4.4.4.m4.7.7.6.6.2">B</ci><ci id="Thmtheorem1.p1.4.4.4.m4.7.7.6.6.3.cmml" xref="Thmtheorem1.p1.4.4.4.m4.7.7.6.6.3">p</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.4.4.4.m4.7c">\pi_{1},B_{1},\pi_{2},B_{2},\cdots,\pi_{p},B_{p}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.4.4.4.m4.7d">italic_π start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_B start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="|A-\sum_{p=1}^{P}\pi_{p}\circ B_{i}|&lt;\epsilon" class="ltx_Math" display="inline" id="Thmtheorem1.p1.5.5.5.m5.1"><semantics id="Thmtheorem1.p1.5.5.5.m5.1a"><mrow id="Thmtheorem1.p1.5.5.5.m5.1.1" xref="Thmtheorem1.p1.5.5.5.m5.1.1.cmml"><mrow id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.2.cmml"><mo id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.2" stretchy="false" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.2.1.cmml">|</mo><mrow id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.cmml"><mi id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.2" mathvariant="normal" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.2.cmml">A</mi><mo id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.1" rspace="0.055em" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.1.cmml">−</mo><mrow id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.cmml"><msubsup id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.cmml"><mo id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.2" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.cmml"><mi id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.2" mathvariant="normal" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.2.cmml">p</mi><mo id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.1" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.3" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.3" mathvariant="normal" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.3.cmml">P</mi></msubsup><mrow id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.cmml"><msub id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2.cmml"><mi id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2.2" mathvariant="normal" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2.2.cmml">π</mi><mi id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2.3" mathvariant="normal" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2.3.cmml">p</mi></msub><mo id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.1.cmml">∘</mo><msub id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3.cmml"><mi id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3.2" mathvariant="normal" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3.2.cmml">B</mi><mi id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3.3" mathvariant="normal" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.3" stretchy="false" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.2.1.cmml">|</mo></mrow><mo id="Thmtheorem1.p1.5.5.5.m5.1.1.2" xref="Thmtheorem1.p1.5.5.5.m5.1.1.2.cmml">&lt;</mo><mi id="Thmtheorem1.p1.5.5.5.m5.1.1.3" mathvariant="normal" xref="Thmtheorem1.p1.5.5.5.m5.1.1.3.cmml">ϵ</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.5.5.5.m5.1b"><apply id="Thmtheorem1.p1.5.5.5.m5.1.1.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1"><lt id="Thmtheorem1.p1.5.5.5.m5.1.1.2.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.2"></lt><apply id="Thmtheorem1.p1.5.5.5.m5.1.1.1.2.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1"><abs id="Thmtheorem1.p1.5.5.5.m5.1.1.1.2.1.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.2"></abs><apply id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1"><minus id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.1.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.1"></minus><ci id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.2.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.2">A</ci><apply id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3"><apply id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.1.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1">superscript</csymbol><apply id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.1.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1">subscript</csymbol><sum id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.2.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.2"></sum><apply id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3"><eq id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.1.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.1"></eq><ci id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.2.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.2">p</ci><cn id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.3.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.1.3">P</ci></apply><apply id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2"><compose id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.1.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.1"></compose><apply id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2.1.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2.2.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2.2">π</ci><ci id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2.3.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.2.3">p</ci></apply><apply id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3.1.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3.2.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3.2">B</ci><ci id="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3.3.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.1.1.1.3.2.3.3">i</ci></apply></apply></apply></apply></apply><ci id="Thmtheorem1.p1.5.5.5.m5.1.1.3.cmml" xref="Thmtheorem1.p1.5.5.5.m5.1.1.3">ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.5.5.5.m5.1c">|A-\sum_{p=1}^{P}\pi_{p}\circ B_{i}|&lt;\epsilon</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.5.5.5.m5.1d">| italic_A - ∑ start_POSTSUBSCRIPT italic_p = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ∘ italic_B start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | &lt; italic_ϵ</annotation></semantics></math>, where <math alttext="\epsilon" class="ltx_Math" display="inline" id="Thmtheorem1.p1.6.6.6.m6.1"><semantics id="Thmtheorem1.p1.6.6.6.m6.1a"><mi id="Thmtheorem1.p1.6.6.6.m6.1.1" mathvariant="normal" xref="Thmtheorem1.p1.6.6.6.m6.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.6.6.6.m6.1b"><ci id="Thmtheorem1.p1.6.6.6.m6.1.1.cmml" xref="Thmtheorem1.p1.6.6.6.m6.1.1">ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.6.6.6.m6.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.6.6.6.m6.1d">italic_ϵ</annotation></semantics></math> is a small positive number. Here <math alttext="B_{i}" class="ltx_Math" display="inline" id="Thmtheorem1.p1.7.7.7.m7.1"><semantics id="Thmtheorem1.p1.7.7.7.m7.1a"><msub id="Thmtheorem1.p1.7.7.7.m7.1.1" xref="Thmtheorem1.p1.7.7.7.m7.1.1.cmml"><mi id="Thmtheorem1.p1.7.7.7.m7.1.1.2" mathvariant="normal" xref="Thmtheorem1.p1.7.7.7.m7.1.1.2.cmml">B</mi><mi id="Thmtheorem1.p1.7.7.7.m7.1.1.3" mathvariant="normal" xref="Thmtheorem1.p1.7.7.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.7.7.7.m7.1b"><apply id="Thmtheorem1.p1.7.7.7.m7.1.1.cmml" xref="Thmtheorem1.p1.7.7.7.m7.1.1"><csymbol cd="ambiguous" id="Thmtheorem1.p1.7.7.7.m7.1.1.1.cmml" xref="Thmtheorem1.p1.7.7.7.m7.1.1">subscript</csymbol><ci id="Thmtheorem1.p1.7.7.7.m7.1.1.2.cmml" xref="Thmtheorem1.p1.7.7.7.m7.1.1.2">B</ci><ci id="Thmtheorem1.p1.7.7.7.m7.1.1.3.cmml" xref="Thmtheorem1.p1.7.7.7.m7.1.1.3">i</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.7.7.7.m7.1c">B_{i}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.7.7.7.m7.1d">italic_B start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is a matrix of <math alttext="n\times m" class="ltx_Math" display="inline" id="Thmtheorem1.p1.8.8.8.m8.1"><semantics id="Thmtheorem1.p1.8.8.8.m8.1a"><mrow id="Thmtheorem1.p1.8.8.8.m8.1.1" xref="Thmtheorem1.p1.8.8.8.m8.1.1.cmml"><mi id="Thmtheorem1.p1.8.8.8.m8.1.1.2" mathvariant="normal" xref="Thmtheorem1.p1.8.8.8.m8.1.1.2.cmml">n</mi><mo id="Thmtheorem1.p1.8.8.8.m8.1.1.1" lspace="0.222em" rspace="0.222em" xref="Thmtheorem1.p1.8.8.8.m8.1.1.1.cmml">×</mo><mi id="Thmtheorem1.p1.8.8.8.m8.1.1.3" mathvariant="normal" xref="Thmtheorem1.p1.8.8.8.m8.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.8.8.8.m8.1b"><apply id="Thmtheorem1.p1.8.8.8.m8.1.1.cmml" xref="Thmtheorem1.p1.8.8.8.m8.1.1"><times id="Thmtheorem1.p1.8.8.8.m8.1.1.1.cmml" xref="Thmtheorem1.p1.8.8.8.m8.1.1.1"></times><ci id="Thmtheorem1.p1.8.8.8.m8.1.1.2.cmml" xref="Thmtheorem1.p1.8.8.8.m8.1.1.2">n</ci><ci id="Thmtheorem1.p1.8.8.8.m8.1.1.3.cmml" xref="Thmtheorem1.p1.8.8.8.m8.1.1.3">m</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.8.8.8.m8.1c">n\times m</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.8.8.8.m8.1d">italic_n × italic_m</annotation></semantics></math> with rank equal to or less than <math alttext="d" class="ltx_Math" display="inline" id="Thmtheorem1.p1.9.9.9.m9.1"><semantics id="Thmtheorem1.p1.9.9.9.m9.1a"><mi id="Thmtheorem1.p1.9.9.9.m9.1.1" mathvariant="normal" xref="Thmtheorem1.p1.9.9.9.m9.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.9.9.9.m9.1b"><ci id="Thmtheorem1.p1.9.9.9.m9.1.1.cmml" xref="Thmtheorem1.p1.9.9.9.m9.1.1">d</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.9.9.9.m9.1c">d</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.9.9.9.m9.1d">italic_d</annotation></semantics></math>, and <math alttext="\pi_{1},\pi_{2},\cdots,\pi_{P}" class="ltx_Math" display="inline" id="Thmtheorem1.p1.10.10.10.m10.4"><semantics id="Thmtheorem1.p1.10.10.10.m10.4a"><mrow id="Thmtheorem1.p1.10.10.10.m10.4.4.3" xref="Thmtheorem1.p1.10.10.10.m10.4.4.4.cmml"><msub id="Thmtheorem1.p1.10.10.10.m10.2.2.1.1" xref="Thmtheorem1.p1.10.10.10.m10.2.2.1.1.cmml"><mi id="Thmtheorem1.p1.10.10.10.m10.2.2.1.1.2" mathvariant="normal" xref="Thmtheorem1.p1.10.10.10.m10.2.2.1.1.2.cmml">π</mi><mn id="Thmtheorem1.p1.10.10.10.m10.2.2.1.1.3" xref="Thmtheorem1.p1.10.10.10.m10.2.2.1.1.3.cmml">1</mn></msub><mo id="Thmtheorem1.p1.10.10.10.m10.4.4.3.4" xref="Thmtheorem1.p1.10.10.10.m10.4.4.4.cmml">,</mo><msub id="Thmtheorem1.p1.10.10.10.m10.3.3.2.2" xref="Thmtheorem1.p1.10.10.10.m10.3.3.2.2.cmml"><mi id="Thmtheorem1.p1.10.10.10.m10.3.3.2.2.2" mathvariant="normal" xref="Thmtheorem1.p1.10.10.10.m10.3.3.2.2.2.cmml">π</mi><mn id="Thmtheorem1.p1.10.10.10.m10.3.3.2.2.3" xref="Thmtheorem1.p1.10.10.10.m10.3.3.2.2.3.cmml">2</mn></msub><mo id="Thmtheorem1.p1.10.10.10.m10.4.4.3.5" xref="Thmtheorem1.p1.10.10.10.m10.4.4.4.cmml">,</mo><mi id="Thmtheorem1.p1.10.10.10.m10.1.1" mathvariant="normal" xref="Thmtheorem1.p1.10.10.10.m10.1.1.cmml">⋯</mi><mo id="Thmtheorem1.p1.10.10.10.m10.4.4.3.6" xref="Thmtheorem1.p1.10.10.10.m10.4.4.4.cmml">,</mo><msub id="Thmtheorem1.p1.10.10.10.m10.4.4.3.3" xref="Thmtheorem1.p1.10.10.10.m10.4.4.3.3.cmml"><mi id="Thmtheorem1.p1.10.10.10.m10.4.4.3.3.2" mathvariant="normal" xref="Thmtheorem1.p1.10.10.10.m10.4.4.3.3.2.cmml">π</mi><mi id="Thmtheorem1.p1.10.10.10.m10.4.4.3.3.3" mathvariant="normal" xref="Thmtheorem1.p1.10.10.10.m10.4.4.3.3.3.cmml">P</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.10.10.10.m10.4b"><list id="Thmtheorem1.p1.10.10.10.m10.4.4.4.cmml" xref="Thmtheorem1.p1.10.10.10.m10.4.4.3"><apply id="Thmtheorem1.p1.10.10.10.m10.2.2.1.1.cmml" xref="Thmtheorem1.p1.10.10.10.m10.2.2.1.1"><csymbol cd="ambiguous" id="Thmtheorem1.p1.10.10.10.m10.2.2.1.1.1.cmml" xref="Thmtheorem1.p1.10.10.10.m10.2.2.1.1">subscript</csymbol><ci id="Thmtheorem1.p1.10.10.10.m10.2.2.1.1.2.cmml" xref="Thmtheorem1.p1.10.10.10.m10.2.2.1.1.2">π</ci><cn id="Thmtheorem1.p1.10.10.10.m10.2.2.1.1.3.cmml" type="integer" xref="Thmtheorem1.p1.10.10.10.m10.2.2.1.1.3">1</cn></apply><apply id="Thmtheorem1.p1.10.10.10.m10.3.3.2.2.cmml" xref="Thmtheorem1.p1.10.10.10.m10.3.3.2.2"><csymbol cd="ambiguous" id="Thmtheorem1.p1.10.10.10.m10.3.3.2.2.1.cmml" xref="Thmtheorem1.p1.10.10.10.m10.3.3.2.2">subscript</csymbol><ci id="Thmtheorem1.p1.10.10.10.m10.3.3.2.2.2.cmml" xref="Thmtheorem1.p1.10.10.10.m10.3.3.2.2.2">π</ci><cn id="Thmtheorem1.p1.10.10.10.m10.3.3.2.2.3.cmml" type="integer" xref="Thmtheorem1.p1.10.10.10.m10.3.3.2.2.3">2</cn></apply><ci id="Thmtheorem1.p1.10.10.10.m10.1.1.cmml" xref="Thmtheorem1.p1.10.10.10.m10.1.1">⋯</ci><apply id="Thmtheorem1.p1.10.10.10.m10.4.4.3.3.cmml" xref="Thmtheorem1.p1.10.10.10.m10.4.4.3.3"><csymbol cd="ambiguous" id="Thmtheorem1.p1.10.10.10.m10.4.4.3.3.1.cmml" xref="Thmtheorem1.p1.10.10.10.m10.4.4.3.3">subscript</csymbol><ci id="Thmtheorem1.p1.10.10.10.m10.4.4.3.3.2.cmml" xref="Thmtheorem1.p1.10.10.10.m10.4.4.3.3.2">π</ci><ci id="Thmtheorem1.p1.10.10.10.m10.4.4.3.3.3.cmml" xref="Thmtheorem1.p1.10.10.10.m10.4.4.3.3.3">P</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.10.10.10.m10.4c">\pi_{1},\pi_{2},\cdots,\pi_{P}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.10.10.10.m10.4d">italic_π start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_π start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT</annotation></semantics></math> are <math alttext="n\times m" class="ltx_Math" display="inline" id="Thmtheorem1.p1.11.11.11.m11.1"><semantics id="Thmtheorem1.p1.11.11.11.m11.1a"><mrow id="Thmtheorem1.p1.11.11.11.m11.1.1" xref="Thmtheorem1.p1.11.11.11.m11.1.1.cmml"><mi id="Thmtheorem1.p1.11.11.11.m11.1.1.2" mathvariant="normal" xref="Thmtheorem1.p1.11.11.11.m11.1.1.2.cmml">n</mi><mo id="Thmtheorem1.p1.11.11.11.m11.1.1.1" lspace="0.222em" rspace="0.222em" xref="Thmtheorem1.p1.11.11.11.m11.1.1.1.cmml">×</mo><mi id="Thmtheorem1.p1.11.11.11.m11.1.1.3" mathvariant="normal" xref="Thmtheorem1.p1.11.11.11.m11.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.11.11.11.m11.1b"><apply id="Thmtheorem1.p1.11.11.11.m11.1.1.cmml" xref="Thmtheorem1.p1.11.11.11.m11.1.1"><times id="Thmtheorem1.p1.11.11.11.m11.1.1.1.cmml" xref="Thmtheorem1.p1.11.11.11.m11.1.1.1"></times><ci id="Thmtheorem1.p1.11.11.11.m11.1.1.2.cmml" xref="Thmtheorem1.p1.11.11.11.m11.1.1.2">n</ci><ci id="Thmtheorem1.p1.11.11.11.m11.1.1.3.cmml" xref="Thmtheorem1.p1.11.11.11.m11.1.1.3">m</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.11.11.11.m11.1c">n\times m</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.11.11.11.m11.1d">italic_n × italic_m</annotation></semantics></math> matrices that together define a probability distribution over each <math alttext="(i,j)" class="ltx_Math" display="inline" id="Thmtheorem1.p1.12.12.12.m12.2"><semantics id="Thmtheorem1.p1.12.12.12.m12.2a"><mrow id="Thmtheorem1.p1.12.12.12.m12.2.3.2" xref="Thmtheorem1.p1.12.12.12.m12.2.3.1.cmml"><mo id="Thmtheorem1.p1.12.12.12.m12.2.3.2.1" stretchy="false" xref="Thmtheorem1.p1.12.12.12.m12.2.3.1.cmml">(</mo><mi id="Thmtheorem1.p1.12.12.12.m12.1.1" mathvariant="normal" xref="Thmtheorem1.p1.12.12.12.m12.1.1.cmml">i</mi><mo id="Thmtheorem1.p1.12.12.12.m12.2.3.2.2" xref="Thmtheorem1.p1.12.12.12.m12.2.3.1.cmml">,</mo><mi id="Thmtheorem1.p1.12.12.12.m12.2.2" mathvariant="normal" xref="Thmtheorem1.p1.12.12.12.m12.2.2.cmml">j</mi><mo id="Thmtheorem1.p1.12.12.12.m12.2.3.2.3" stretchy="false" xref="Thmtheorem1.p1.12.12.12.m12.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.12.12.12.m12.2b"><interval closure="open" id="Thmtheorem1.p1.12.12.12.m12.2.3.1.cmml" xref="Thmtheorem1.p1.12.12.12.m12.2.3.2"><ci id="Thmtheorem1.p1.12.12.12.m12.1.1.cmml" xref="Thmtheorem1.p1.12.12.12.m12.1.1">i</ci><ci id="Thmtheorem1.p1.12.12.12.m12.2.2.cmml" xref="Thmtheorem1.p1.12.12.12.m12.2.2">j</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.12.12.12.m12.2c">(i,j)</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.12.12.12.m12.2d">( italic_i , italic_j )</annotation></semantics></math> tuple, such that <math alttext="\sum_{p=1}^{P}\pi_{p}(i,j)=1,0\leq\pi_{p}(i,j)\leq 1" class="ltx_Math" display="inline" id="Thmtheorem1.p1.13.13.13.m13.6"><semantics id="Thmtheorem1.p1.13.13.13.m13.6a"><mrow id="Thmtheorem1.p1.13.13.13.m13.6.6.2" xref="Thmtheorem1.p1.13.13.13.m13.6.6.3.cmml"><mrow id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.cmml"><mrow id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.cmml"><msubsup id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.cmml"><mo id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.2" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.2.cmml">∑</mo><mrow id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.cmml"><mi id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.2" mathvariant="normal" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.2.cmml">p</mi><mo id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.1" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.1.cmml">=</mo><mn id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.3" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.3" mathvariant="normal" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.3.cmml">P</mi></msubsup><mrow id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.cmml"><msub id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2.cmml"><mi id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2.2" mathvariant="normal" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2.2.cmml">π</mi><mi id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2.3" mathvariant="normal" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2.3.cmml">p</mi></msub><mo id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.1" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.1.cmml">⁢</mo><mrow id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.3.2" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.3.1.cmml"><mo id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.3.2.1" stretchy="false" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.3.1.cmml">(</mo><mi id="Thmtheorem1.p1.13.13.13.m13.1.1" mathvariant="normal" xref="Thmtheorem1.p1.13.13.13.m13.1.1.cmml">i</mi><mo id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.3.2.2" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.3.1.cmml">,</mo><mi id="Thmtheorem1.p1.13.13.13.m13.2.2" mathvariant="normal" xref="Thmtheorem1.p1.13.13.13.m13.2.2.cmml">j</mi><mo id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.3.2.3" stretchy="false" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.1" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.1.cmml">=</mo><mn id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.3" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.3.cmml">1</mn></mrow><mo id="Thmtheorem1.p1.13.13.13.m13.6.6.2.3" xref="Thmtheorem1.p1.13.13.13.m13.6.6.3a.cmml">,</mo><mrow id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.cmml"><mn id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.2" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.2.cmml">0</mn><mo id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.3" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.3.cmml">≤</mo><mrow id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.cmml"><msub id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2.cmml"><mi id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2.2" mathvariant="normal" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2.2.cmml">π</mi><mi id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2.3" mathvariant="normal" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2.3.cmml">p</mi></msub><mo id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.1" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.1.cmml">⁢</mo><mrow id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.3.2" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.3.1.cmml"><mo id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.3.2.1" stretchy="false" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.3.1.cmml">(</mo><mi id="Thmtheorem1.p1.13.13.13.m13.3.3" mathvariant="normal" xref="Thmtheorem1.p1.13.13.13.m13.3.3.cmml">i</mi><mo id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.3.2.2" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.3.1.cmml">,</mo><mi id="Thmtheorem1.p1.13.13.13.m13.4.4" mathvariant="normal" xref="Thmtheorem1.p1.13.13.13.m13.4.4.cmml">j</mi><mo id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.3.2.3" stretchy="false" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.3.1.cmml">)</mo></mrow></mrow><mo id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.5" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.5.cmml">≤</mo><mn id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.6" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.6.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.13.13.13.m13.6b"><apply id="Thmtheorem1.p1.13.13.13.m13.6.6.3.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2"><csymbol cd="ambiguous" id="Thmtheorem1.p1.13.13.13.m13.6.6.3a.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.3">formulae-sequence</csymbol><apply id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1"><eq id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.1"></eq><apply id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2"><apply id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1"><csymbol cd="ambiguous" id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1">superscript</csymbol><apply id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1"><csymbol cd="ambiguous" id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1">subscript</csymbol><sum id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.2.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.2"></sum><apply id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3"><eq id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.1"></eq><ci id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.2.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.2">p</ci><cn id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.3.cmml" type="integer" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.3.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.1.3">P</ci></apply><apply id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2"><times id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.1"></times><apply id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2">subscript</csymbol><ci id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2.2.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2.2">π</ci><ci id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2.3.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.2.3">p</ci></apply><interval closure="open" id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.3.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.2.2.3.2"><ci id="Thmtheorem1.p1.13.13.13.m13.1.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.1.1">i</ci><ci id="Thmtheorem1.p1.13.13.13.m13.2.2.cmml" xref="Thmtheorem1.p1.13.13.13.m13.2.2">j</ci></interval></apply></apply><cn id="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.3.cmml" type="integer" xref="Thmtheorem1.p1.13.13.13.m13.5.5.1.1.3">1</cn></apply><apply id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2"><and id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2a.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2"></and><apply id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2b.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2"><leq id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.3.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.3"></leq><cn id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.2.cmml" type="integer" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.2">0</cn><apply id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4"><times id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.1"></times><apply id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2"><csymbol cd="ambiguous" id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2">subscript</csymbol><ci id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2.2.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2.2">π</ci><ci id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2.3.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.2.3">p</ci></apply><interval closure="open" id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.3.1.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.3.2"><ci id="Thmtheorem1.p1.13.13.13.m13.3.3.cmml" xref="Thmtheorem1.p1.13.13.13.m13.3.3">i</ci><ci id="Thmtheorem1.p1.13.13.13.m13.4.4.cmml" xref="Thmtheorem1.p1.13.13.13.m13.4.4">j</ci></interval></apply></apply><apply id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2c.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2"><leq id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.5.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.5"></leq><share href="https://arxiv.org/html/2407.15462v2#Thmtheorem1.p1.13.13.13.m13.6.6.2.2.4.cmml" id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2d.cmml" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2"></share><cn id="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.6.cmml" type="integer" xref="Thmtheorem1.p1.13.13.13.m13.6.6.2.2.6">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.13.13.13.m13.6c">\sum_{p=1}^{P}\pi_{p}(i,j)=1,0\leq\pi_{p}(i,j)\leq 1</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.13.13.13.m13.6d">∑ start_POSTSUBSCRIPT italic_p = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_i , italic_j ) = 1 , 0 ≤ italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_i , italic_j ) ≤ 1</annotation></semantics></math> for any <math alttext="1\leq i\leq n,1\leq j\leq m,1\leq p\leq P" class="ltx_Math" display="inline" id="Thmtheorem1.p1.14.14.14.m14.3"><semantics id="Thmtheorem1.p1.14.14.14.m14.3a"><mrow id="Thmtheorem1.p1.14.14.14.m14.3.3.3" xref="Thmtheorem1.p1.14.14.14.m14.3.3.4.cmml"><mrow id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.cmml"><mn id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.2" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.2.cmml">1</mn><mo id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.3" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.3.cmml">≤</mo><mi id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.4" mathvariant="normal" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.4.cmml">i</mi><mo id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.5" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.5.cmml">≤</mo><mi id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.6" mathvariant="normal" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.6.cmml">n</mi></mrow><mo id="Thmtheorem1.p1.14.14.14.m14.3.3.3.4" xref="Thmtheorem1.p1.14.14.14.m14.3.3.4a.cmml">,</mo><mrow id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.cmml"><mn id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.2" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.2.cmml">1</mn><mo id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.3" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.3.cmml">≤</mo><mi id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.4" mathvariant="normal" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.4.cmml">j</mi><mo id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.5" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.5.cmml">≤</mo><mi id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.6" mathvariant="normal" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.6.cmml">m</mi></mrow><mo id="Thmtheorem1.p1.14.14.14.m14.3.3.3.5" xref="Thmtheorem1.p1.14.14.14.m14.3.3.4a.cmml">,</mo><mrow id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.cmml"><mn id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.2" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.2.cmml">1</mn><mo id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.3" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.3.cmml">≤</mo><mi id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.4" mathvariant="normal" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.4.cmml">p</mi><mo id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.5" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.5.cmml">≤</mo><mi id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.6" mathvariant="normal" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.6.cmml">P</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.14.14.14.m14.3b"><apply id="Thmtheorem1.p1.14.14.14.m14.3.3.4.cmml" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3"><csymbol cd="ambiguous" id="Thmtheorem1.p1.14.14.14.m14.3.3.4a.cmml" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.4">formulae-sequence</csymbol><apply id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.cmml" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1"><and id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1a.cmml" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1"></and><apply id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1b.cmml" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1"><leq id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.3.cmml" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.3"></leq><cn id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.2.cmml" type="integer" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.2">1</cn><ci id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.4.cmml" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.4">i</ci></apply><apply id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1c.cmml" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1"><leq id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.5.cmml" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.5"></leq><share href="https://arxiv.org/html/2407.15462v2#Thmtheorem1.p1.14.14.14.m14.1.1.1.1.4.cmml" id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1d.cmml" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1"></share><ci id="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.6.cmml" xref="Thmtheorem1.p1.14.14.14.m14.1.1.1.1.6">n</ci></apply></apply><apply id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.cmml" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2"><and id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2a.cmml" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2"></and><apply id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2b.cmml" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2"><leq id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.3.cmml" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.3"></leq><cn id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.2.cmml" type="integer" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.2">1</cn><ci id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.4.cmml" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.4">j</ci></apply><apply id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2c.cmml" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2"><leq id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.5.cmml" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2407.15462v2#Thmtheorem1.p1.14.14.14.m14.2.2.2.2.4.cmml" id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2d.cmml" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2"></share><ci id="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.6.cmml" xref="Thmtheorem1.p1.14.14.14.m14.2.2.2.2.6">m</ci></apply></apply><apply id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.cmml" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3"><and id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3a.cmml" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3"></and><apply id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3b.cmml" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3"><leq id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.3.cmml" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.3"></leq><cn id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.2.cmml" type="integer" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.2">1</cn><ci id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.4.cmml" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.4">p</ci></apply><apply id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3c.cmml" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3"><leq id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.5.cmml" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.5"></leq><share href="https://arxiv.org/html/2407.15462v2#Thmtheorem1.p1.14.14.14.m14.3.3.3.3.4.cmml" id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3d.cmml" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3"></share><ci id="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.6.cmml" xref="Thmtheorem1.p1.14.14.14.m14.3.3.3.3.6">P</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.14.14.14.m14.3c">1\leq i\leq n,1\leq j\leq m,1\leq p\leq P</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem1.p1.14.14.14.m14.3d">1 ≤ italic_i ≤ italic_n , 1 ≤ italic_j ≤ italic_m , 1 ≤ italic_p ≤ italic_P</annotation></semantics></math>.</span></span></p>
</div>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p4">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p4.5">We can think about <math alttext="n" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p4.1.m1.1a"><mi id="S2.SS0.SSS0.Px1.p4.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p4.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.1.m1.1b"><ci id="S2.SS0.SSS0.Px1.p4.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p4.1.m1.1d">italic_n</annotation></semantics></math> as the number of queries and <math alttext="m" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p4.2.m2.1a"><mi id="S2.SS0.SSS0.Px1.p4.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p4.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.2.m2.1b"><ci id="S2.SS0.SSS0.Px1.p4.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p4.2.m2.1d">italic_m</annotation></semantics></math> the number of items (or vice versa). First, the theorem trivially holds if the rank of <math alttext="A" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.3.m3.1"><semantics id="S2.SS0.SSS0.Px1.p4.3.m3.1a"><mi id="S2.SS0.SSS0.Px1.p4.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p4.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.3.m3.1b"><ci id="S2.SS0.SSS0.Px1.p4.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.3.m3.1c">A</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p4.3.m3.1d">italic_A</annotation></semantics></math> is less than or equal to <math alttext="d" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.4.m4.1"><semantics id="S2.SS0.SSS0.Px1.p4.4.m4.1a"><mi id="S2.SS0.SSS0.Px1.p4.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p4.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.4.m4.1b"><ci id="S2.SS0.SSS0.Px1.p4.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.4.m4.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p4.4.m4.1d">italic_d</annotation></semantics></math> (<math alttext="d\leq n" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.5.m5.1"><semantics id="S2.SS0.SSS0.Px1.p4.5.m5.1a"><mrow id="S2.SS0.SSS0.Px1.p4.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p4.5.m5.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.p4.5.m5.1.1.2" xref="S2.SS0.SSS0.Px1.p4.5.m5.1.1.2.cmml">d</mi><mo id="S2.SS0.SSS0.Px1.p4.5.m5.1.1.1" xref="S2.SS0.SSS0.Px1.p4.5.m5.1.1.1.cmml">≤</mo><mi id="S2.SS0.SSS0.Px1.p4.5.m5.1.1.3" xref="S2.SS0.SSS0.Px1.p4.5.m5.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.5.m5.1b"><apply id="S2.SS0.SSS0.Px1.p4.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.5.m5.1.1"><leq id="S2.SS0.SSS0.Px1.p4.5.m5.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.5.m5.1.1.1"></leq><ci id="S2.SS0.SSS0.Px1.p4.5.m5.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p4.5.m5.1.1.2">𝑑</ci><ci id="S2.SS0.SSS0.Px1.p4.5.m5.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p4.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.5.m5.1c">d\leq n</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p4.5.m5.1d">italic_d ≤ italic_n</annotation></semantics></math>):</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmlemma1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmlemma1.1.1.1">Lemma 1</span></span><span class="ltx_text ltx_font_bold" id="Thmlemma1.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmlemma1.p1">
<p class="ltx_p" id="Thmlemma1.p1.7"><span class="ltx_text ltx_font_bold ltx_font_italic" id="Thmlemma1.p1.7.7">MoL decomposition when <math alttext="Rank(A)\leq d" class="ltx_Math" display="inline" id="Thmlemma1.p1.1.1.m1.1"><semantics id="Thmlemma1.p1.1.1.m1.1a"><mrow id="Thmlemma1.p1.1.1.m1.1.2" xref="Thmlemma1.p1.1.1.m1.1.2.cmml"><mrow id="Thmlemma1.p1.1.1.m1.1.2.2" xref="Thmlemma1.p1.1.1.m1.1.2.2.cmml"><mi id="Thmlemma1.p1.1.1.m1.1.2.2.2" mathvariant="normal" xref="Thmlemma1.p1.1.1.m1.1.2.2.2.cmml">R</mi><mo id="Thmlemma1.p1.1.1.m1.1.2.2.1" xref="Thmlemma1.p1.1.1.m1.1.2.2.1.cmml">⁢</mo><mi id="Thmlemma1.p1.1.1.m1.1.2.2.3" mathvariant="normal" xref="Thmlemma1.p1.1.1.m1.1.2.2.3.cmml">a</mi><mo id="Thmlemma1.p1.1.1.m1.1.2.2.1a" xref="Thmlemma1.p1.1.1.m1.1.2.2.1.cmml">⁢</mo><mi id="Thmlemma1.p1.1.1.m1.1.2.2.4" mathvariant="normal" xref="Thmlemma1.p1.1.1.m1.1.2.2.4.cmml">n</mi><mo id="Thmlemma1.p1.1.1.m1.1.2.2.1b" xref="Thmlemma1.p1.1.1.m1.1.2.2.1.cmml">⁢</mo><mi id="Thmlemma1.p1.1.1.m1.1.2.2.5" mathvariant="normal" xref="Thmlemma1.p1.1.1.m1.1.2.2.5.cmml">k</mi><mo id="Thmlemma1.p1.1.1.m1.1.2.2.1c" xref="Thmlemma1.p1.1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="Thmlemma1.p1.1.1.m1.1.2.2.6.2" xref="Thmlemma1.p1.1.1.m1.1.2.2.cmml"><mo id="Thmlemma1.p1.1.1.m1.1.2.2.6.2.1" stretchy="false" xref="Thmlemma1.p1.1.1.m1.1.2.2.cmml">(</mo><mi id="Thmlemma1.p1.1.1.m1.1.1" mathvariant="normal" xref="Thmlemma1.p1.1.1.m1.1.1.cmml">A</mi><mo id="Thmlemma1.p1.1.1.m1.1.2.2.6.2.2" stretchy="false" xref="Thmlemma1.p1.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="Thmlemma1.p1.1.1.m1.1.2.1" xref="Thmlemma1.p1.1.1.m1.1.2.1.cmml">≤</mo><mi id="Thmlemma1.p1.1.1.m1.1.2.3" mathvariant="normal" xref="Thmlemma1.p1.1.1.m1.1.2.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.1.1.m1.1b"><apply id="Thmlemma1.p1.1.1.m1.1.2.cmml" xref="Thmlemma1.p1.1.1.m1.1.2"><leq id="Thmlemma1.p1.1.1.m1.1.2.1.cmml" xref="Thmlemma1.p1.1.1.m1.1.2.1"></leq><apply id="Thmlemma1.p1.1.1.m1.1.2.2.cmml" xref="Thmlemma1.p1.1.1.m1.1.2.2"><times id="Thmlemma1.p1.1.1.m1.1.2.2.1.cmml" xref="Thmlemma1.p1.1.1.m1.1.2.2.1"></times><ci id="Thmlemma1.p1.1.1.m1.1.2.2.2.cmml" xref="Thmlemma1.p1.1.1.m1.1.2.2.2">R</ci><ci id="Thmlemma1.p1.1.1.m1.1.2.2.3.cmml" xref="Thmlemma1.p1.1.1.m1.1.2.2.3">a</ci><ci id="Thmlemma1.p1.1.1.m1.1.2.2.4.cmml" xref="Thmlemma1.p1.1.1.m1.1.2.2.4">n</ci><ci id="Thmlemma1.p1.1.1.m1.1.2.2.5.cmml" xref="Thmlemma1.p1.1.1.m1.1.2.2.5">k</ci><ci id="Thmlemma1.p1.1.1.m1.1.1.cmml" xref="Thmlemma1.p1.1.1.m1.1.1">A</ci></apply><ci id="Thmlemma1.p1.1.1.m1.1.2.3.cmml" xref="Thmlemma1.p1.1.1.m1.1.2.3">d</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.1.1.m1.1c">Rank(A)\leq d</annotation><annotation encoding="application/x-llamapun" id="Thmlemma1.p1.1.1.m1.1d">italic_R italic_a italic_n italic_k ( italic_A ) ≤ italic_d</annotation></semantics></math><span class="ltx_text ltx_font_medium" id="Thmlemma1.p1.7.7.6">: Let <math alttext="A" class="ltx_Math" display="inline" id="Thmlemma1.p1.2.2.1.m1.1"><semantics id="Thmlemma1.p1.2.2.1.m1.1a"><mi id="Thmlemma1.p1.2.2.1.m1.1.1" mathvariant="normal" xref="Thmlemma1.p1.2.2.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.2.2.1.m1.1b"><ci id="Thmlemma1.p1.2.2.1.m1.1.1.cmml" xref="Thmlemma1.p1.2.2.1.m1.1.1">A</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.2.2.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="Thmlemma1.p1.2.2.1.m1.1d">italic_A</annotation></semantics></math> be a matrix as defined in Theorem <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#Thmtheorem1" title="Theorem 1. ‣ Mixture of Logits (MoL) ‣ 2 Expressiveness of Mixture of Logits ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">1</span></a>. If the rank of <math alttext="A" class="ltx_Math" display="inline" id="Thmlemma1.p1.3.3.2.m2.1"><semantics id="Thmlemma1.p1.3.3.2.m2.1a"><mi id="Thmlemma1.p1.3.3.2.m2.1.1" mathvariant="normal" xref="Thmlemma1.p1.3.3.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.3.3.2.m2.1b"><ci id="Thmlemma1.p1.3.3.2.m2.1.1.cmml" xref="Thmlemma1.p1.3.3.2.m2.1.1">A</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.3.3.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="Thmlemma1.p1.3.3.2.m2.1d">italic_A</annotation></semantics></math> is less than or equal to <math alttext="d" class="ltx_Math" display="inline" id="Thmlemma1.p1.4.4.3.m3.1"><semantics id="Thmlemma1.p1.4.4.3.m3.1a"><mi id="Thmlemma1.p1.4.4.3.m3.1.1" mathvariant="normal" xref="Thmlemma1.p1.4.4.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.4.4.3.m3.1b"><ci id="Thmlemma1.p1.4.4.3.m3.1.1.cmml" xref="Thmlemma1.p1.4.4.3.m3.1.1">d</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.4.4.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="Thmlemma1.p1.4.4.3.m3.1d">italic_d</annotation></semantics></math>, then we have <math alttext="A=\pi\circ A" class="ltx_Math" display="inline" id="Thmlemma1.p1.5.5.4.m4.1"><semantics id="Thmlemma1.p1.5.5.4.m4.1a"><mrow id="Thmlemma1.p1.5.5.4.m4.1.1" xref="Thmlemma1.p1.5.5.4.m4.1.1.cmml"><mi id="Thmlemma1.p1.5.5.4.m4.1.1.2" mathvariant="normal" xref="Thmlemma1.p1.5.5.4.m4.1.1.2.cmml">A</mi><mo id="Thmlemma1.p1.5.5.4.m4.1.1.1" xref="Thmlemma1.p1.5.5.4.m4.1.1.1.cmml">=</mo><mrow id="Thmlemma1.p1.5.5.4.m4.1.1.3" xref="Thmlemma1.p1.5.5.4.m4.1.1.3.cmml"><mi id="Thmlemma1.p1.5.5.4.m4.1.1.3.2" mathvariant="normal" xref="Thmlemma1.p1.5.5.4.m4.1.1.3.2.cmml">π</mi><mo id="Thmlemma1.p1.5.5.4.m4.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="Thmlemma1.p1.5.5.4.m4.1.1.3.1.cmml">∘</mo><mi id="Thmlemma1.p1.5.5.4.m4.1.1.3.3" mathvariant="normal" xref="Thmlemma1.p1.5.5.4.m4.1.1.3.3.cmml">A</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.5.5.4.m4.1b"><apply id="Thmlemma1.p1.5.5.4.m4.1.1.cmml" xref="Thmlemma1.p1.5.5.4.m4.1.1"><eq id="Thmlemma1.p1.5.5.4.m4.1.1.1.cmml" xref="Thmlemma1.p1.5.5.4.m4.1.1.1"></eq><ci id="Thmlemma1.p1.5.5.4.m4.1.1.2.cmml" xref="Thmlemma1.p1.5.5.4.m4.1.1.2">A</ci><apply id="Thmlemma1.p1.5.5.4.m4.1.1.3.cmml" xref="Thmlemma1.p1.5.5.4.m4.1.1.3"><compose id="Thmlemma1.p1.5.5.4.m4.1.1.3.1.cmml" xref="Thmlemma1.p1.5.5.4.m4.1.1.3.1"></compose><ci id="Thmlemma1.p1.5.5.4.m4.1.1.3.2.cmml" xref="Thmlemma1.p1.5.5.4.m4.1.1.3.2">π</ci><ci id="Thmlemma1.p1.5.5.4.m4.1.1.3.3.cmml" xref="Thmlemma1.p1.5.5.4.m4.1.1.3.3">A</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.5.5.4.m4.1c">A=\pi\circ A</annotation><annotation encoding="application/x-llamapun" id="Thmlemma1.p1.5.5.4.m4.1d">italic_A = italic_π ∘ italic_A</annotation></semantics></math>, where <math alttext="\pi(i,j)=1" class="ltx_Math" display="inline" id="Thmlemma1.p1.6.6.5.m5.2"><semantics id="Thmlemma1.p1.6.6.5.m5.2a"><mrow id="Thmlemma1.p1.6.6.5.m5.2.3" xref="Thmlemma1.p1.6.6.5.m5.2.3.cmml"><mrow id="Thmlemma1.p1.6.6.5.m5.2.3.2" xref="Thmlemma1.p1.6.6.5.m5.2.3.2.cmml"><mi id="Thmlemma1.p1.6.6.5.m5.2.3.2.2" mathvariant="normal" xref="Thmlemma1.p1.6.6.5.m5.2.3.2.2.cmml">π</mi><mo id="Thmlemma1.p1.6.6.5.m5.2.3.2.1" xref="Thmlemma1.p1.6.6.5.m5.2.3.2.1.cmml">⁢</mo><mrow id="Thmlemma1.p1.6.6.5.m5.2.3.2.3.2" xref="Thmlemma1.p1.6.6.5.m5.2.3.2.3.1.cmml"><mo id="Thmlemma1.p1.6.6.5.m5.2.3.2.3.2.1" stretchy="false" xref="Thmlemma1.p1.6.6.5.m5.2.3.2.3.1.cmml">(</mo><mi id="Thmlemma1.p1.6.6.5.m5.1.1" mathvariant="normal" xref="Thmlemma1.p1.6.6.5.m5.1.1.cmml">i</mi><mo id="Thmlemma1.p1.6.6.5.m5.2.3.2.3.2.2" xref="Thmlemma1.p1.6.6.5.m5.2.3.2.3.1.cmml">,</mo><mi id="Thmlemma1.p1.6.6.5.m5.2.2" mathvariant="normal" xref="Thmlemma1.p1.6.6.5.m5.2.2.cmml">j</mi><mo id="Thmlemma1.p1.6.6.5.m5.2.3.2.3.2.3" stretchy="false" xref="Thmlemma1.p1.6.6.5.m5.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="Thmlemma1.p1.6.6.5.m5.2.3.1" xref="Thmlemma1.p1.6.6.5.m5.2.3.1.cmml">=</mo><mn id="Thmlemma1.p1.6.6.5.m5.2.3.3" xref="Thmlemma1.p1.6.6.5.m5.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.6.6.5.m5.2b"><apply id="Thmlemma1.p1.6.6.5.m5.2.3.cmml" xref="Thmlemma1.p1.6.6.5.m5.2.3"><eq id="Thmlemma1.p1.6.6.5.m5.2.3.1.cmml" xref="Thmlemma1.p1.6.6.5.m5.2.3.1"></eq><apply id="Thmlemma1.p1.6.6.5.m5.2.3.2.cmml" xref="Thmlemma1.p1.6.6.5.m5.2.3.2"><times id="Thmlemma1.p1.6.6.5.m5.2.3.2.1.cmml" xref="Thmlemma1.p1.6.6.5.m5.2.3.2.1"></times><ci id="Thmlemma1.p1.6.6.5.m5.2.3.2.2.cmml" xref="Thmlemma1.p1.6.6.5.m5.2.3.2.2">π</ci><interval closure="open" id="Thmlemma1.p1.6.6.5.m5.2.3.2.3.1.cmml" xref="Thmlemma1.p1.6.6.5.m5.2.3.2.3.2"><ci id="Thmlemma1.p1.6.6.5.m5.1.1.cmml" xref="Thmlemma1.p1.6.6.5.m5.1.1">i</ci><ci id="Thmlemma1.p1.6.6.5.m5.2.2.cmml" xref="Thmlemma1.p1.6.6.5.m5.2.2">j</ci></interval></apply><cn id="Thmlemma1.p1.6.6.5.m5.2.3.3.cmml" type="integer" xref="Thmlemma1.p1.6.6.5.m5.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.6.6.5.m5.2c">\pi(i,j)=1</annotation><annotation encoding="application/x-llamapun" id="Thmlemma1.p1.6.6.5.m5.2d">italic_π ( italic_i , italic_j ) = 1</annotation></semantics></math> for any <math alttext="1\leq i\leq n,1\leq j\leq m" class="ltx_Math" display="inline" id="Thmlemma1.p1.7.7.6.m6.2"><semantics id="Thmlemma1.p1.7.7.6.m6.2a"><mrow id="Thmlemma1.p1.7.7.6.m6.2.2.2" xref="Thmlemma1.p1.7.7.6.m6.2.2.3.cmml"><mrow id="Thmlemma1.p1.7.7.6.m6.1.1.1.1" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1.cmml"><mn id="Thmlemma1.p1.7.7.6.m6.1.1.1.1.2" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1.2.cmml">1</mn><mo id="Thmlemma1.p1.7.7.6.m6.1.1.1.1.3" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1.3.cmml">≤</mo><mi id="Thmlemma1.p1.7.7.6.m6.1.1.1.1.4" mathvariant="normal" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1.4.cmml">i</mi><mo id="Thmlemma1.p1.7.7.6.m6.1.1.1.1.5" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1.5.cmml">≤</mo><mi id="Thmlemma1.p1.7.7.6.m6.1.1.1.1.6" mathvariant="normal" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1.6.cmml">n</mi></mrow><mo id="Thmlemma1.p1.7.7.6.m6.2.2.2.3" xref="Thmlemma1.p1.7.7.6.m6.2.2.3a.cmml">,</mo><mrow id="Thmlemma1.p1.7.7.6.m6.2.2.2.2" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2.cmml"><mn id="Thmlemma1.p1.7.7.6.m6.2.2.2.2.2" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2.2.cmml">1</mn><mo id="Thmlemma1.p1.7.7.6.m6.2.2.2.2.3" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2.3.cmml">≤</mo><mi id="Thmlemma1.p1.7.7.6.m6.2.2.2.2.4" mathvariant="normal" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2.4.cmml">j</mi><mo id="Thmlemma1.p1.7.7.6.m6.2.2.2.2.5" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2.5.cmml">≤</mo><mi id="Thmlemma1.p1.7.7.6.m6.2.2.2.2.6" mathvariant="normal" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2.6.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.7.7.6.m6.2b"><apply id="Thmlemma1.p1.7.7.6.m6.2.2.3.cmml" xref="Thmlemma1.p1.7.7.6.m6.2.2.2"><csymbol cd="ambiguous" id="Thmlemma1.p1.7.7.6.m6.2.2.3a.cmml" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.3">formulae-sequence</csymbol><apply id="Thmlemma1.p1.7.7.6.m6.1.1.1.1.cmml" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1"><and id="Thmlemma1.p1.7.7.6.m6.1.1.1.1a.cmml" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1"></and><apply id="Thmlemma1.p1.7.7.6.m6.1.1.1.1b.cmml" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1"><leq id="Thmlemma1.p1.7.7.6.m6.1.1.1.1.3.cmml" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1.3"></leq><cn id="Thmlemma1.p1.7.7.6.m6.1.1.1.1.2.cmml" type="integer" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1.2">1</cn><ci id="Thmlemma1.p1.7.7.6.m6.1.1.1.1.4.cmml" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1.4">i</ci></apply><apply id="Thmlemma1.p1.7.7.6.m6.1.1.1.1c.cmml" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1"><leq id="Thmlemma1.p1.7.7.6.m6.1.1.1.1.5.cmml" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1.5"></leq><share href="https://arxiv.org/html/2407.15462v2#Thmlemma1.p1.7.7.6.m6.1.1.1.1.4.cmml" id="Thmlemma1.p1.7.7.6.m6.1.1.1.1d.cmml" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1"></share><ci id="Thmlemma1.p1.7.7.6.m6.1.1.1.1.6.cmml" xref="Thmlemma1.p1.7.7.6.m6.1.1.1.1.6">n</ci></apply></apply><apply id="Thmlemma1.p1.7.7.6.m6.2.2.2.2.cmml" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2"><and id="Thmlemma1.p1.7.7.6.m6.2.2.2.2a.cmml" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2"></and><apply id="Thmlemma1.p1.7.7.6.m6.2.2.2.2b.cmml" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2"><leq id="Thmlemma1.p1.7.7.6.m6.2.2.2.2.3.cmml" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2.3"></leq><cn id="Thmlemma1.p1.7.7.6.m6.2.2.2.2.2.cmml" type="integer" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2.2">1</cn><ci id="Thmlemma1.p1.7.7.6.m6.2.2.2.2.4.cmml" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2.4">j</ci></apply><apply id="Thmlemma1.p1.7.7.6.m6.2.2.2.2c.cmml" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2"><leq id="Thmlemma1.p1.7.7.6.m6.2.2.2.2.5.cmml" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2407.15462v2#Thmlemma1.p1.7.7.6.m6.2.2.2.2.4.cmml" id="Thmlemma1.p1.7.7.6.m6.2.2.2.2d.cmml" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2"></share><ci id="Thmlemma1.p1.7.7.6.m6.2.2.2.2.6.cmml" xref="Thmlemma1.p1.7.7.6.m6.2.2.2.2.6">m</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.7.7.6.m6.2c">1\leq i\leq n,1\leq j\leq m</annotation><annotation encoding="application/x-llamapun" id="Thmlemma1.p1.7.7.6.m6.2d">1 ≤ italic_i ≤ italic_n , 1 ≤ italic_j ≤ italic_m</annotation></semantics></math>.</span></span></p>
</div>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p5">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p5.3">Then we prove for the case where the rank of <math alttext="A" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p5.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p5.1.m1.1a"><mi id="S2.SS0.SSS0.Px1.p5.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p5.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p5.1.m1.1b"><ci id="S2.SS0.SSS0.Px1.p5.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p5.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p5.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p5.1.m1.1d">italic_A</annotation></semantics></math> is greater than <math alttext="d" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p5.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p5.2.m2.1a"><mi id="S2.SS0.SSS0.Px1.p5.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p5.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p5.2.m2.1b"><ci id="S2.SS0.SSS0.Px1.p5.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p5.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p5.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p5.2.m2.1d">italic_d</annotation></semantics></math>. Without loss of generality, we prove the case where the matrix has full rank, i.e., <math alttext="Rank(A)=n" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p5.3.m3.1"><semantics id="S2.SS0.SSS0.Px1.p5.3.m3.1a"><mrow id="S2.SS0.SSS0.Px1.p5.3.m3.1.2" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.cmml"><mrow id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.2" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.2.cmml">R</mi><mo id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.1" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.3" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.3.cmml">a</mi><mo id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.1a" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.4" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.4.cmml">n</mi><mo id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.1b" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.5" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.5.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.1c" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.6.2" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.cmml"><mo id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.6.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.p5.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.1.cmml">A</mi><mo id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.6.2.2" stretchy="false" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.1" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.1.cmml">=</mo><mi id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.3" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p5.3.m3.1b"><apply id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2"><eq id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.1"></eq><apply id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2"><times id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.1"></times><ci id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.2">𝑅</ci><ci id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.3">𝑎</ci><ci id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.4.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.4">𝑛</ci><ci id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.5.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.2.5">𝑘</ci><ci id="S2.SS0.SSS0.Px1.p5.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.1">𝐴</ci></apply><ci id="S2.SS0.SSS0.Px1.p5.3.m3.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.2.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p5.3.m3.1c">Rank(A)=n</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p5.3.m3.1d">italic_R italic_a italic_n italic_k ( italic_A ) = italic_n</annotation></semantics></math>:</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmlemma2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmlemma2.1.1.1">Lemma 2</span></span><span class="ltx_text ltx_font_bold" id="Thmlemma2.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmlemma2.p1">
<p class="ltx_p" id="Thmlemma2.p1.8"><span class="ltx_text ltx_font_bold ltx_font_italic" id="Thmlemma2.p1.8.8">MoL decomposition when <math alttext="Rank(A)=n" class="ltx_Math" display="inline" id="Thmlemma2.p1.1.1.m1.1"><semantics id="Thmlemma2.p1.1.1.m1.1a"><mrow id="Thmlemma2.p1.1.1.m1.1.2" xref="Thmlemma2.p1.1.1.m1.1.2.cmml"><mrow id="Thmlemma2.p1.1.1.m1.1.2.2" xref="Thmlemma2.p1.1.1.m1.1.2.2.cmml"><mi id="Thmlemma2.p1.1.1.m1.1.2.2.2" mathvariant="normal" xref="Thmlemma2.p1.1.1.m1.1.2.2.2.cmml">R</mi><mo id="Thmlemma2.p1.1.1.m1.1.2.2.1" xref="Thmlemma2.p1.1.1.m1.1.2.2.1.cmml">⁢</mo><mi id="Thmlemma2.p1.1.1.m1.1.2.2.3" mathvariant="normal" xref="Thmlemma2.p1.1.1.m1.1.2.2.3.cmml">a</mi><mo id="Thmlemma2.p1.1.1.m1.1.2.2.1a" xref="Thmlemma2.p1.1.1.m1.1.2.2.1.cmml">⁢</mo><mi id="Thmlemma2.p1.1.1.m1.1.2.2.4" mathvariant="normal" xref="Thmlemma2.p1.1.1.m1.1.2.2.4.cmml">n</mi><mo id="Thmlemma2.p1.1.1.m1.1.2.2.1b" xref="Thmlemma2.p1.1.1.m1.1.2.2.1.cmml">⁢</mo><mi id="Thmlemma2.p1.1.1.m1.1.2.2.5" mathvariant="normal" xref="Thmlemma2.p1.1.1.m1.1.2.2.5.cmml">k</mi><mo id="Thmlemma2.p1.1.1.m1.1.2.2.1c" xref="Thmlemma2.p1.1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="Thmlemma2.p1.1.1.m1.1.2.2.6.2" xref="Thmlemma2.p1.1.1.m1.1.2.2.cmml"><mo id="Thmlemma2.p1.1.1.m1.1.2.2.6.2.1" stretchy="false" xref="Thmlemma2.p1.1.1.m1.1.2.2.cmml">(</mo><mi id="Thmlemma2.p1.1.1.m1.1.1" mathvariant="normal" xref="Thmlemma2.p1.1.1.m1.1.1.cmml">A</mi><mo id="Thmlemma2.p1.1.1.m1.1.2.2.6.2.2" stretchy="false" xref="Thmlemma2.p1.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="Thmlemma2.p1.1.1.m1.1.2.1" xref="Thmlemma2.p1.1.1.m1.1.2.1.cmml">=</mo><mi id="Thmlemma2.p1.1.1.m1.1.2.3" mathvariant="normal" xref="Thmlemma2.p1.1.1.m1.1.2.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma2.p1.1.1.m1.1b"><apply id="Thmlemma2.p1.1.1.m1.1.2.cmml" xref="Thmlemma2.p1.1.1.m1.1.2"><eq id="Thmlemma2.p1.1.1.m1.1.2.1.cmml" xref="Thmlemma2.p1.1.1.m1.1.2.1"></eq><apply id="Thmlemma2.p1.1.1.m1.1.2.2.cmml" xref="Thmlemma2.p1.1.1.m1.1.2.2"><times id="Thmlemma2.p1.1.1.m1.1.2.2.1.cmml" xref="Thmlemma2.p1.1.1.m1.1.2.2.1"></times><ci id="Thmlemma2.p1.1.1.m1.1.2.2.2.cmml" xref="Thmlemma2.p1.1.1.m1.1.2.2.2">R</ci><ci id="Thmlemma2.p1.1.1.m1.1.2.2.3.cmml" xref="Thmlemma2.p1.1.1.m1.1.2.2.3">a</ci><ci id="Thmlemma2.p1.1.1.m1.1.2.2.4.cmml" xref="Thmlemma2.p1.1.1.m1.1.2.2.4">n</ci><ci id="Thmlemma2.p1.1.1.m1.1.2.2.5.cmml" xref="Thmlemma2.p1.1.1.m1.1.2.2.5">k</ci><ci id="Thmlemma2.p1.1.1.m1.1.1.cmml" xref="Thmlemma2.p1.1.1.m1.1.1">A</ci></apply><ci id="Thmlemma2.p1.1.1.m1.1.2.3.cmml" xref="Thmlemma2.p1.1.1.m1.1.2.3">n</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma2.p1.1.1.m1.1c">Rank(A)=n</annotation><annotation encoding="application/x-llamapun" id="Thmlemma2.p1.1.1.m1.1d">italic_R italic_a italic_n italic_k ( italic_A ) = italic_n</annotation></semantics></math><span class="ltx_text ltx_font_medium" id="Thmlemma2.p1.8.8.7">: Let <math alttext="A" class="ltx_Math" display="inline" id="Thmlemma2.p1.2.2.1.m1.1"><semantics id="Thmlemma2.p1.2.2.1.m1.1a"><mi id="Thmlemma2.p1.2.2.1.m1.1.1" mathvariant="normal" xref="Thmlemma2.p1.2.2.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="Thmlemma2.p1.2.2.1.m1.1b"><ci id="Thmlemma2.p1.2.2.1.m1.1.1.cmml" xref="Thmlemma2.p1.2.2.1.m1.1.1">A</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma2.p1.2.2.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="Thmlemma2.p1.2.2.1.m1.1d">italic_A</annotation></semantics></math> be a matrix as defined in Theorem <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#Thmtheorem1" title="Theorem 1. ‣ Mixture of Logits (MoL) ‣ 2 Expressiveness of Mixture of Logits ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">1</span></a>. Then there exists <math alttext="\pi,B_{1},B_{2}" class="ltx_Math" display="inline" id="Thmlemma2.p1.3.3.2.m2.3"><semantics id="Thmlemma2.p1.3.3.2.m2.3a"><mrow id="Thmlemma2.p1.3.3.2.m2.3.3.2" xref="Thmlemma2.p1.3.3.2.m2.3.3.3.cmml"><mi id="Thmlemma2.p1.3.3.2.m2.1.1" mathvariant="normal" xref="Thmlemma2.p1.3.3.2.m2.1.1.cmml">π</mi><mo id="Thmlemma2.p1.3.3.2.m2.3.3.2.3" xref="Thmlemma2.p1.3.3.2.m2.3.3.3.cmml">,</mo><msub id="Thmlemma2.p1.3.3.2.m2.2.2.1.1" xref="Thmlemma2.p1.3.3.2.m2.2.2.1.1.cmml"><mi id="Thmlemma2.p1.3.3.2.m2.2.2.1.1.2" mathvariant="normal" xref="Thmlemma2.p1.3.3.2.m2.2.2.1.1.2.cmml">B</mi><mn id="Thmlemma2.p1.3.3.2.m2.2.2.1.1.3" xref="Thmlemma2.p1.3.3.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="Thmlemma2.p1.3.3.2.m2.3.3.2.4" xref="Thmlemma2.p1.3.3.2.m2.3.3.3.cmml">,</mo><msub id="Thmlemma2.p1.3.3.2.m2.3.3.2.2" xref="Thmlemma2.p1.3.3.2.m2.3.3.2.2.cmml"><mi id="Thmlemma2.p1.3.3.2.m2.3.3.2.2.2" mathvariant="normal" xref="Thmlemma2.p1.3.3.2.m2.3.3.2.2.2.cmml">B</mi><mn id="Thmlemma2.p1.3.3.2.m2.3.3.2.2.3" xref="Thmlemma2.p1.3.3.2.m2.3.3.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma2.p1.3.3.2.m2.3b"><list id="Thmlemma2.p1.3.3.2.m2.3.3.3.cmml" xref="Thmlemma2.p1.3.3.2.m2.3.3.2"><ci id="Thmlemma2.p1.3.3.2.m2.1.1.cmml" xref="Thmlemma2.p1.3.3.2.m2.1.1">π</ci><apply id="Thmlemma2.p1.3.3.2.m2.2.2.1.1.cmml" xref="Thmlemma2.p1.3.3.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="Thmlemma2.p1.3.3.2.m2.2.2.1.1.1.cmml" xref="Thmlemma2.p1.3.3.2.m2.2.2.1.1">subscript</csymbol><ci id="Thmlemma2.p1.3.3.2.m2.2.2.1.1.2.cmml" xref="Thmlemma2.p1.3.3.2.m2.2.2.1.1.2">B</ci><cn id="Thmlemma2.p1.3.3.2.m2.2.2.1.1.3.cmml" type="integer" xref="Thmlemma2.p1.3.3.2.m2.2.2.1.1.3">1</cn></apply><apply id="Thmlemma2.p1.3.3.2.m2.3.3.2.2.cmml" xref="Thmlemma2.p1.3.3.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="Thmlemma2.p1.3.3.2.m2.3.3.2.2.1.cmml" xref="Thmlemma2.p1.3.3.2.m2.3.3.2.2">subscript</csymbol><ci id="Thmlemma2.p1.3.3.2.m2.3.3.2.2.2.cmml" xref="Thmlemma2.p1.3.3.2.m2.3.3.2.2.2">B</ci><cn id="Thmlemma2.p1.3.3.2.m2.3.3.2.2.3.cmml" type="integer" xref="Thmlemma2.p1.3.3.2.m2.3.3.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma2.p1.3.3.2.m2.3c">\pi,B_{1},B_{2}</annotation><annotation encoding="application/x-llamapun" id="Thmlemma2.p1.3.3.2.m2.3d">italic_π , italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="|A-(\pi\circ B_{1}+(1-\pi)\circ B_{2})|&lt;\epsilon" class="ltx_Math" display="inline" id="Thmlemma2.p1.4.4.3.m3.1"><semantics id="Thmlemma2.p1.4.4.3.m3.1a"><mrow id="Thmlemma2.p1.4.4.3.m3.1.1" xref="Thmlemma2.p1.4.4.3.m3.1.1.cmml"><mrow id="Thmlemma2.p1.4.4.3.m3.1.1.1.1" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.2.cmml"><mo id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.2" stretchy="false" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.2.1.cmml">|</mo><mrow id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.cmml"><mi id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.3" mathvariant="normal" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.3.cmml">A</mi><mo id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.2" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.2.cmml">−</mo><mrow id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.cmml"><mo id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.2" stretchy="false" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.cmml"><mrow id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.cmml"><mi id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.2.cmml">π</mi><mo id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.1.cmml">∘</mo><msub id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3.2" mathvariant="normal" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3.2.cmml">B</mi><mn id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3.3" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></msub></mrow><mo id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.2" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mrow id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3" mathvariant="normal" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">π</mi></mrow><mo id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">∘</mo><msub id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3.2.cmml">B</mi><mn id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3.3" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow></mrow><mo id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.3" stretchy="false" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.3" stretchy="false" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.2.1.cmml">|</mo></mrow><mo id="Thmlemma2.p1.4.4.3.m3.1.1.2" xref="Thmlemma2.p1.4.4.3.m3.1.1.2.cmml">&lt;</mo><mi id="Thmlemma2.p1.4.4.3.m3.1.1.3" mathvariant="normal" xref="Thmlemma2.p1.4.4.3.m3.1.1.3.cmml">ϵ</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma2.p1.4.4.3.m3.1b"><apply id="Thmlemma2.p1.4.4.3.m3.1.1.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1"><lt id="Thmlemma2.p1.4.4.3.m3.1.1.2.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.2"></lt><apply id="Thmlemma2.p1.4.4.3.m3.1.1.1.2.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1"><abs id="Thmlemma2.p1.4.4.3.m3.1.1.1.2.1.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.2"></abs><apply id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1"><minus id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.2.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.2"></minus><ci id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.3.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.3">A</ci><apply id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1"><plus id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.2"></plus><apply id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3"><compose id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.1.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.1"></compose><ci id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.2.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.2">π</ci><apply id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3.2">B</ci><cn id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1"><compose id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.2"></compose><apply id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1"><minus id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3">π</ci></apply><apply id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3.2">B</ci><cn id="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="Thmlemma2.p1.4.4.3.m3.1.1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></apply><ci id="Thmlemma2.p1.4.4.3.m3.1.1.3.cmml" xref="Thmlemma2.p1.4.4.3.m3.1.1.3">ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma2.p1.4.4.3.m3.1c">|A-(\pi\circ B_{1}+(1-\pi)\circ B_{2})|&lt;\epsilon</annotation><annotation encoding="application/x-llamapun" id="Thmlemma2.p1.4.4.3.m3.1d">| italic_A - ( italic_π ∘ italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + ( 1 - italic_π ) ∘ italic_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) | &lt; italic_ϵ</annotation></semantics></math>, where <math alttext="Rank(B_{1})\leq d" class="ltx_Math" display="inline" id="Thmlemma2.p1.5.5.4.m4.1"><semantics id="Thmlemma2.p1.5.5.4.m4.1a"><mrow id="Thmlemma2.p1.5.5.4.m4.1.1" xref="Thmlemma2.p1.5.5.4.m4.1.1.cmml"><mrow id="Thmlemma2.p1.5.5.4.m4.1.1.1" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.cmml"><mi id="Thmlemma2.p1.5.5.4.m4.1.1.1.3" mathvariant="normal" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.3.cmml">R</mi><mo id="Thmlemma2.p1.5.5.4.m4.1.1.1.2" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.2.cmml">⁢</mo><mi id="Thmlemma2.p1.5.5.4.m4.1.1.1.4" mathvariant="normal" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.4.cmml">a</mi><mo id="Thmlemma2.p1.5.5.4.m4.1.1.1.2a" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.2.cmml">⁢</mo><mi id="Thmlemma2.p1.5.5.4.m4.1.1.1.5" mathvariant="normal" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.5.cmml">n</mi><mo id="Thmlemma2.p1.5.5.4.m4.1.1.1.2b" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.2.cmml">⁢</mo><mi id="Thmlemma2.p1.5.5.4.m4.1.1.1.6" mathvariant="normal" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.6.cmml">k</mi><mo id="Thmlemma2.p1.5.5.4.m4.1.1.1.2c" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.cmml"><mo id="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.2" stretchy="false" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.cmml">(</mo><msub id="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.cmml"><mi id="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.2" mathvariant="normal" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.2.cmml">B</mi><mn id="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.3" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.3" stretchy="false" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmlemma2.p1.5.5.4.m4.1.1.2" xref="Thmlemma2.p1.5.5.4.m4.1.1.2.cmml">≤</mo><mi id="Thmlemma2.p1.5.5.4.m4.1.1.3" mathvariant="normal" xref="Thmlemma2.p1.5.5.4.m4.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma2.p1.5.5.4.m4.1b"><apply id="Thmlemma2.p1.5.5.4.m4.1.1.cmml" xref="Thmlemma2.p1.5.5.4.m4.1.1"><leq id="Thmlemma2.p1.5.5.4.m4.1.1.2.cmml" xref="Thmlemma2.p1.5.5.4.m4.1.1.2"></leq><apply id="Thmlemma2.p1.5.5.4.m4.1.1.1.cmml" xref="Thmlemma2.p1.5.5.4.m4.1.1.1"><times id="Thmlemma2.p1.5.5.4.m4.1.1.1.2.cmml" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.2"></times><ci id="Thmlemma2.p1.5.5.4.m4.1.1.1.3.cmml" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.3">R</ci><ci id="Thmlemma2.p1.5.5.4.m4.1.1.1.4.cmml" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.4">a</ci><ci id="Thmlemma2.p1.5.5.4.m4.1.1.1.5.cmml" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.5">n</ci><ci id="Thmlemma2.p1.5.5.4.m4.1.1.1.6.cmml" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.6">k</ci><apply id="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.cmml" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.1.cmml" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1">subscript</csymbol><ci id="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.2.cmml" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.2">B</ci><cn id="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.3.cmml" type="integer" xref="Thmlemma2.p1.5.5.4.m4.1.1.1.1.1.1.3">1</cn></apply></apply><ci id="Thmlemma2.p1.5.5.4.m4.1.1.3.cmml" xref="Thmlemma2.p1.5.5.4.m4.1.1.3">d</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma2.p1.5.5.4.m4.1c">Rank(B_{1})\leq d</annotation><annotation encoding="application/x-llamapun" id="Thmlemma2.p1.5.5.4.m4.1d">italic_R italic_a italic_n italic_k ( italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ≤ italic_d</annotation></semantics></math>, <math alttext="Rank(B_{2})\leq d" class="ltx_Math" display="inline" id="Thmlemma2.p1.6.6.5.m5.1"><semantics id="Thmlemma2.p1.6.6.5.m5.1a"><mrow id="Thmlemma2.p1.6.6.5.m5.1.1" xref="Thmlemma2.p1.6.6.5.m5.1.1.cmml"><mrow id="Thmlemma2.p1.6.6.5.m5.1.1.1" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.cmml"><mi id="Thmlemma2.p1.6.6.5.m5.1.1.1.3" mathvariant="normal" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.3.cmml">R</mi><mo id="Thmlemma2.p1.6.6.5.m5.1.1.1.2" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.2.cmml">⁢</mo><mi id="Thmlemma2.p1.6.6.5.m5.1.1.1.4" mathvariant="normal" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.4.cmml">a</mi><mo id="Thmlemma2.p1.6.6.5.m5.1.1.1.2a" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.2.cmml">⁢</mo><mi id="Thmlemma2.p1.6.6.5.m5.1.1.1.5" mathvariant="normal" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.5.cmml">n</mi><mo id="Thmlemma2.p1.6.6.5.m5.1.1.1.2b" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.2.cmml">⁢</mo><mi id="Thmlemma2.p1.6.6.5.m5.1.1.1.6" mathvariant="normal" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.6.cmml">k</mi><mo id="Thmlemma2.p1.6.6.5.m5.1.1.1.2c" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.2.cmml">⁢</mo><mrow id="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.cmml"><mo id="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.2" stretchy="false" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.cmml">(</mo><msub id="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.cmml"><mi id="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.2" mathvariant="normal" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.2.cmml">B</mi><mn id="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.3" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.3" stretchy="false" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmlemma2.p1.6.6.5.m5.1.1.2" xref="Thmlemma2.p1.6.6.5.m5.1.1.2.cmml">≤</mo><mi id="Thmlemma2.p1.6.6.5.m5.1.1.3" mathvariant="normal" xref="Thmlemma2.p1.6.6.5.m5.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma2.p1.6.6.5.m5.1b"><apply id="Thmlemma2.p1.6.6.5.m5.1.1.cmml" xref="Thmlemma2.p1.6.6.5.m5.1.1"><leq id="Thmlemma2.p1.6.6.5.m5.1.1.2.cmml" xref="Thmlemma2.p1.6.6.5.m5.1.1.2"></leq><apply id="Thmlemma2.p1.6.6.5.m5.1.1.1.cmml" xref="Thmlemma2.p1.6.6.5.m5.1.1.1"><times id="Thmlemma2.p1.6.6.5.m5.1.1.1.2.cmml" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.2"></times><ci id="Thmlemma2.p1.6.6.5.m5.1.1.1.3.cmml" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.3">R</ci><ci id="Thmlemma2.p1.6.6.5.m5.1.1.1.4.cmml" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.4">a</ci><ci id="Thmlemma2.p1.6.6.5.m5.1.1.1.5.cmml" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.5">n</ci><ci id="Thmlemma2.p1.6.6.5.m5.1.1.1.6.cmml" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.6">k</ci><apply id="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.cmml" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.1.cmml" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1">subscript</csymbol><ci id="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.2.cmml" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.2">B</ci><cn id="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.3.cmml" type="integer" xref="Thmlemma2.p1.6.6.5.m5.1.1.1.1.1.1.3">2</cn></apply></apply><ci id="Thmlemma2.p1.6.6.5.m5.1.1.3.cmml" xref="Thmlemma2.p1.6.6.5.m5.1.1.3">d</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma2.p1.6.6.5.m5.1c">Rank(B_{2})\leq d</annotation><annotation encoding="application/x-llamapun" id="Thmlemma2.p1.6.6.5.m5.1d">italic_R italic_a italic_n italic_k ( italic_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ≤ italic_d</annotation></semantics></math>, and <math alttext="0\leq\pi(i,j)\leq 1" class="ltx_Math" display="inline" id="Thmlemma2.p1.7.7.6.m6.2"><semantics id="Thmlemma2.p1.7.7.6.m6.2a"><mrow id="Thmlemma2.p1.7.7.6.m6.2.3" xref="Thmlemma2.p1.7.7.6.m6.2.3.cmml"><mn id="Thmlemma2.p1.7.7.6.m6.2.3.2" xref="Thmlemma2.p1.7.7.6.m6.2.3.2.cmml">0</mn><mo id="Thmlemma2.p1.7.7.6.m6.2.3.3" xref="Thmlemma2.p1.7.7.6.m6.2.3.3.cmml">≤</mo><mrow id="Thmlemma2.p1.7.7.6.m6.2.3.4" xref="Thmlemma2.p1.7.7.6.m6.2.3.4.cmml"><mi id="Thmlemma2.p1.7.7.6.m6.2.3.4.2" mathvariant="normal" xref="Thmlemma2.p1.7.7.6.m6.2.3.4.2.cmml">π</mi><mo id="Thmlemma2.p1.7.7.6.m6.2.3.4.1" xref="Thmlemma2.p1.7.7.6.m6.2.3.4.1.cmml">⁢</mo><mrow id="Thmlemma2.p1.7.7.6.m6.2.3.4.3.2" xref="Thmlemma2.p1.7.7.6.m6.2.3.4.3.1.cmml"><mo id="Thmlemma2.p1.7.7.6.m6.2.3.4.3.2.1" stretchy="false" xref="Thmlemma2.p1.7.7.6.m6.2.3.4.3.1.cmml">(</mo><mi id="Thmlemma2.p1.7.7.6.m6.1.1" mathvariant="normal" xref="Thmlemma2.p1.7.7.6.m6.1.1.cmml">i</mi><mo id="Thmlemma2.p1.7.7.6.m6.2.3.4.3.2.2" xref="Thmlemma2.p1.7.7.6.m6.2.3.4.3.1.cmml">,</mo><mi id="Thmlemma2.p1.7.7.6.m6.2.2" mathvariant="normal" xref="Thmlemma2.p1.7.7.6.m6.2.2.cmml">j</mi><mo id="Thmlemma2.p1.7.7.6.m6.2.3.4.3.2.3" stretchy="false" xref="Thmlemma2.p1.7.7.6.m6.2.3.4.3.1.cmml">)</mo></mrow></mrow><mo id="Thmlemma2.p1.7.7.6.m6.2.3.5" xref="Thmlemma2.p1.7.7.6.m6.2.3.5.cmml">≤</mo><mn id="Thmlemma2.p1.7.7.6.m6.2.3.6" xref="Thmlemma2.p1.7.7.6.m6.2.3.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma2.p1.7.7.6.m6.2b"><apply id="Thmlemma2.p1.7.7.6.m6.2.3.cmml" xref="Thmlemma2.p1.7.7.6.m6.2.3"><and id="Thmlemma2.p1.7.7.6.m6.2.3a.cmml" xref="Thmlemma2.p1.7.7.6.m6.2.3"></and><apply id="Thmlemma2.p1.7.7.6.m6.2.3b.cmml" xref="Thmlemma2.p1.7.7.6.m6.2.3"><leq id="Thmlemma2.p1.7.7.6.m6.2.3.3.cmml" xref="Thmlemma2.p1.7.7.6.m6.2.3.3"></leq><cn id="Thmlemma2.p1.7.7.6.m6.2.3.2.cmml" type="integer" xref="Thmlemma2.p1.7.7.6.m6.2.3.2">0</cn><apply id="Thmlemma2.p1.7.7.6.m6.2.3.4.cmml" xref="Thmlemma2.p1.7.7.6.m6.2.3.4"><times id="Thmlemma2.p1.7.7.6.m6.2.3.4.1.cmml" xref="Thmlemma2.p1.7.7.6.m6.2.3.4.1"></times><ci id="Thmlemma2.p1.7.7.6.m6.2.3.4.2.cmml" xref="Thmlemma2.p1.7.7.6.m6.2.3.4.2">π</ci><interval closure="open" id="Thmlemma2.p1.7.7.6.m6.2.3.4.3.1.cmml" xref="Thmlemma2.p1.7.7.6.m6.2.3.4.3.2"><ci id="Thmlemma2.p1.7.7.6.m6.1.1.cmml" xref="Thmlemma2.p1.7.7.6.m6.1.1">i</ci><ci id="Thmlemma2.p1.7.7.6.m6.2.2.cmml" xref="Thmlemma2.p1.7.7.6.m6.2.2">j</ci></interval></apply></apply><apply id="Thmlemma2.p1.7.7.6.m6.2.3c.cmml" xref="Thmlemma2.p1.7.7.6.m6.2.3"><leq id="Thmlemma2.p1.7.7.6.m6.2.3.5.cmml" xref="Thmlemma2.p1.7.7.6.m6.2.3.5"></leq><share href="https://arxiv.org/html/2407.15462v2#Thmlemma2.p1.7.7.6.m6.2.3.4.cmml" id="Thmlemma2.p1.7.7.6.m6.2.3d.cmml" xref="Thmlemma2.p1.7.7.6.m6.2.3"></share><cn id="Thmlemma2.p1.7.7.6.m6.2.3.6.cmml" type="integer" xref="Thmlemma2.p1.7.7.6.m6.2.3.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma2.p1.7.7.6.m6.2c">0\leq\pi(i,j)\leq 1</annotation><annotation encoding="application/x-llamapun" id="Thmlemma2.p1.7.7.6.m6.2d">0 ≤ italic_π ( italic_i , italic_j ) ≤ 1</annotation></semantics></math> for <math alttext="1\leq i\leq n,1\leq j\leq m" class="ltx_Math" display="inline" id="Thmlemma2.p1.8.8.7.m7.2"><semantics id="Thmlemma2.p1.8.8.7.m7.2a"><mrow id="Thmlemma2.p1.8.8.7.m7.2.2.2" xref="Thmlemma2.p1.8.8.7.m7.2.2.3.cmml"><mrow id="Thmlemma2.p1.8.8.7.m7.1.1.1.1" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1.cmml"><mn id="Thmlemma2.p1.8.8.7.m7.1.1.1.1.2" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1.2.cmml">1</mn><mo id="Thmlemma2.p1.8.8.7.m7.1.1.1.1.3" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1.3.cmml">≤</mo><mi id="Thmlemma2.p1.8.8.7.m7.1.1.1.1.4" mathvariant="normal" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1.4.cmml">i</mi><mo id="Thmlemma2.p1.8.8.7.m7.1.1.1.1.5" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1.5.cmml">≤</mo><mi id="Thmlemma2.p1.8.8.7.m7.1.1.1.1.6" mathvariant="normal" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1.6.cmml">n</mi></mrow><mo id="Thmlemma2.p1.8.8.7.m7.2.2.2.3" xref="Thmlemma2.p1.8.8.7.m7.2.2.3a.cmml">,</mo><mrow id="Thmlemma2.p1.8.8.7.m7.2.2.2.2" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2.cmml"><mn id="Thmlemma2.p1.8.8.7.m7.2.2.2.2.2" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2.2.cmml">1</mn><mo id="Thmlemma2.p1.8.8.7.m7.2.2.2.2.3" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2.3.cmml">≤</mo><mi id="Thmlemma2.p1.8.8.7.m7.2.2.2.2.4" mathvariant="normal" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2.4.cmml">j</mi><mo id="Thmlemma2.p1.8.8.7.m7.2.2.2.2.5" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2.5.cmml">≤</mo><mi id="Thmlemma2.p1.8.8.7.m7.2.2.2.2.6" mathvariant="normal" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2.6.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma2.p1.8.8.7.m7.2b"><apply id="Thmlemma2.p1.8.8.7.m7.2.2.3.cmml" xref="Thmlemma2.p1.8.8.7.m7.2.2.2"><csymbol cd="ambiguous" id="Thmlemma2.p1.8.8.7.m7.2.2.3a.cmml" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.3">formulae-sequence</csymbol><apply id="Thmlemma2.p1.8.8.7.m7.1.1.1.1.cmml" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1"><and id="Thmlemma2.p1.8.8.7.m7.1.1.1.1a.cmml" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1"></and><apply id="Thmlemma2.p1.8.8.7.m7.1.1.1.1b.cmml" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1"><leq id="Thmlemma2.p1.8.8.7.m7.1.1.1.1.3.cmml" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1.3"></leq><cn id="Thmlemma2.p1.8.8.7.m7.1.1.1.1.2.cmml" type="integer" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1.2">1</cn><ci id="Thmlemma2.p1.8.8.7.m7.1.1.1.1.4.cmml" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1.4">i</ci></apply><apply id="Thmlemma2.p1.8.8.7.m7.1.1.1.1c.cmml" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1"><leq id="Thmlemma2.p1.8.8.7.m7.1.1.1.1.5.cmml" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1.5"></leq><share href="https://arxiv.org/html/2407.15462v2#Thmlemma2.p1.8.8.7.m7.1.1.1.1.4.cmml" id="Thmlemma2.p1.8.8.7.m7.1.1.1.1d.cmml" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1"></share><ci id="Thmlemma2.p1.8.8.7.m7.1.1.1.1.6.cmml" xref="Thmlemma2.p1.8.8.7.m7.1.1.1.1.6">n</ci></apply></apply><apply id="Thmlemma2.p1.8.8.7.m7.2.2.2.2.cmml" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2"><and id="Thmlemma2.p1.8.8.7.m7.2.2.2.2a.cmml" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2"></and><apply id="Thmlemma2.p1.8.8.7.m7.2.2.2.2b.cmml" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2"><leq id="Thmlemma2.p1.8.8.7.m7.2.2.2.2.3.cmml" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2.3"></leq><cn id="Thmlemma2.p1.8.8.7.m7.2.2.2.2.2.cmml" type="integer" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2.2">1</cn><ci id="Thmlemma2.p1.8.8.7.m7.2.2.2.2.4.cmml" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2.4">j</ci></apply><apply id="Thmlemma2.p1.8.8.7.m7.2.2.2.2c.cmml" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2"><leq id="Thmlemma2.p1.8.8.7.m7.2.2.2.2.5.cmml" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2407.15462v2#Thmlemma2.p1.8.8.7.m7.2.2.2.2.4.cmml" id="Thmlemma2.p1.8.8.7.m7.2.2.2.2d.cmml" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2"></share><ci id="Thmlemma2.p1.8.8.7.m7.2.2.2.2.6.cmml" xref="Thmlemma2.p1.8.8.7.m7.2.2.2.2.6">m</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma2.p1.8.8.7.m7.2c">1\leq i\leq n,1\leq j\leq m</annotation><annotation encoding="application/x-llamapun" id="Thmlemma2.p1.8.8.7.m7.2d">1 ≤ italic_i ≤ italic_n , 1 ≤ italic_j ≤ italic_m</annotation></semantics></math>.</span></span></p>
</div>
</div>
<div class="ltx_proof" id="S2.SS0.SSS0.Px1.3">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.1.p1.14">Because <math alttext="A" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.1.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px1.1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.1.p1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px1.1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.1.m1.1d">italic_A</annotation></semantics></math> is a matrix of rank <math alttext="n" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.1.p1.2.m2.1a"><mi id="S2.SS0.SSS0.Px1.1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.1.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.2.m2.1b"><ci id="S2.SS0.SSS0.Px1.1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.2.m2.1d">italic_n</annotation></semantics></math>, it can be rewritten as <math alttext="A=UI_{n}V" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.3.m3.1"><semantics id="S2.SS0.SSS0.Px1.1.p1.3.m3.1a"><mrow id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.2.cmml">A</mi><mo id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.1" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.2" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.2.cmml">U</mi><mo id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.1" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3.2.cmml">I</mi><mi id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3.3.cmml">n</mi></msub><mo id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.1a" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.4" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.4.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.3.m3.1b"><apply id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1"><eq id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.1"></eq><ci id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.2">𝐴</ci><apply id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3"><times id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.2">𝑈</ci><apply id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3.2">𝐼</ci><ci id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.3.3">𝑛</ci></apply><ci id="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.4.cmml" xref="S2.SS0.SSS0.Px1.1.p1.3.m3.1.1.3.4">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.3.m3.1c">A=UI_{n}V</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.3.m3.1d">italic_A = italic_U italic_I start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT italic_V</annotation></semantics></math>, where <math alttext="I_{n}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.4.m4.1"><semantics id="S2.SS0.SSS0.Px1.1.p1.4.m4.1a"><msub id="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1" xref="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1.2.cmml">I</mi><mi id="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1.3" xref="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.4.m4.1b"><apply id="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1.2">𝐼</ci><ci id="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.4.m4.1c">I_{n}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.4.m4.1d">italic_I start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> is an identity matrix with rank <math alttext="n" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.5.m5.1"><semantics id="S2.SS0.SSS0.Px1.1.p1.5.m5.1a"><mi id="S2.SS0.SSS0.Px1.1.p1.5.m5.1.1" xref="S2.SS0.SSS0.Px1.1.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.5.m5.1b"><ci id="S2.SS0.SSS0.Px1.1.p1.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.5.m5.1d">italic_n</annotation></semantics></math>. 
Thus, <math alttext="A_{ij}=\sum_{k=1}^{n}U_{ik}V_{kj},1\leq i\leq n,1\leq j\leq m" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.6.m6.2"><semantics id="S2.SS0.SSS0.Px1.1.p1.6.m6.2a"><mrow id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.3.cmml"><mrow id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.3.cmml"><mrow id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.2.cmml">A</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.1" rspace="0.111em" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.cmml"><msubsup id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.cmml"><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.3.cmml">n</mi></msubsup><mrow id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.cmml"><msub id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.2.cmml">U</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.3.cmml">k</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.1" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.2.cmml">V</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.1" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.3a.cmml">,</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.cmml"><mn id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.3.cmml">≤</mo><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.4" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.4.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.5" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.5.cmml">≤</mo><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.6" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.6.cmml">n</mi></mrow></mrow><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.3a.cmml">,</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.cmml"><mn id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.3.cmml">≤</mo><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.4" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.4.cmml">j</mi><mo id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.5" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.5.cmml">≤</mo><mi id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.6" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.6.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.6.m6.2b"><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.3a.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.3a.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1"><eq id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.1"></eq><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.2">𝐴</ci><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3"><times id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3"><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3"><eq id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.2">𝑘</ci><cn id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.1.3">𝑛</ci></apply><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2"><times id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.1"></times><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.2">𝑈</ci><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3"><times id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.2">𝑉</ci><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3"><times id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.2">𝑘</ci><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.1.1.3.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2"><and id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2a.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2"></and><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2b.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2"><leq id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.3"></leq><cn id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.2">1</cn><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.4.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.4">𝑖</ci></apply><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2c.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2"><leq id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.5.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.5"></leq><share href="https://arxiv.org/html/2407.15462v2#S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.4.cmml" id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2d.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2"></share><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.6.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.1.1.1.1.2.2.6">𝑛</ci></apply></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2"><and id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2a.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2"></and><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2b.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2"><leq id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.3"></leq><cn id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.2">1</cn><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.4.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.4">𝑗</ci></apply><apply id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2c.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2"><leq id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.5.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2407.15462v2#S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.4.cmml" id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2d.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2"></share><ci id="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.6.cmml" xref="S2.SS0.SSS0.Px1.1.p1.6.m6.2.2.2.2.6">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.6.m6.2c">A_{ij}=\sum_{k=1}^{n}U_{ik}V_{kj},1\leq i\leq n,1\leq j\leq m</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.6.m6.2d">italic_A start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_k italic_j end_POSTSUBSCRIPT , 1 ≤ italic_i ≤ italic_n , 1 ≤ italic_j ≤ italic_m</annotation></semantics></math>. Let <math alttext="A^{\prime}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.7.m7.1"><semantics id="S2.SS0.SSS0.Px1.1.p1.7.m7.1a"><msup id="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1" xref="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1.2.cmml">A</mi><mo id="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1.3" xref="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.7.m7.1b"><apply id="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1.2">𝐴</ci><ci id="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.7.m7.1c">A^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.7.m7.1d">italic_A start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> be a matrix of <math alttext="n\times m" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.8.m8.1"><semantics id="S2.SS0.SSS0.Px1.1.p1.8.m8.1a"><mrow id="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1" xref="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.2.cmml">n</mi><mo id="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.1.cmml">×</mo><mi id="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.3" xref="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.8.m8.1b"><apply id="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1"><times id="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.2">𝑛</ci><ci id="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.8.m8.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.8.m8.1c">n\times m</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.8.m8.1d">italic_n × italic_m</annotation></semantics></math>, where <math alttext="A^{\prime}_{ij}=\lambda_{ij}\cdot\sum_{k=1}^{d}U_{ik}V_{kj}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.9.m9.1"><semantics id="S2.SS0.SSS0.Px1.1.p1.9.m9.1a"><mrow id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.cmml"><msubsup id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.2.2.cmml">A</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.3.cmml">j</mi></mrow><mo id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.1" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.cmml"><msub id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.1" lspace="0.222em" rspace="0.055em" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.1.cmml">⋅</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.cmml"><msubsup id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.cmml"><mo id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.3.cmml">d</mi></msubsup><mrow id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.cmml"><msub id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.2.cmml">U</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.3.cmml">k</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.1" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.2.cmml">V</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.1" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.3" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.9.m9.1b"><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1"><eq id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.1"></eq><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2">subscript</csymbol><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.2.2">𝐴</ci><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.2.3">′</ci></apply><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3"><times id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3"><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.1">⋅</ci><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3"><times id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3"><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1">subscript</csymbol><sum id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.2"></sum><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3"><eq id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.1"></eq><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.2">𝑘</ci><cn id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.1.3">𝑑</ci></apply><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2"><times id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.1"></times><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.2">𝑈</ci><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3"><times id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.2">𝑉</ci><apply id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3"><times id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.2">𝑘</ci><ci id="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.9.m9.1.1.3.3.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.9.m9.1c">A^{\prime}_{ij}=\lambda_{ij}\cdot\sum_{k=1}^{d}U_{ik}V_{kj}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.9.m9.1d">italic_A start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = italic_λ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ⋅ ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_k italic_j end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="1\leq i\leq n,1\leq j\leq m" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.10.m10.2"><semantics id="S2.SS0.SSS0.Px1.1.p1.10.m10.2a"><mrow id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.3.cmml"><mrow id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.cmml"><mn id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.3.cmml">≤</mo><mi id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.4" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.4.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.5" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.5.cmml">≤</mo><mi id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.6" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.6.cmml">n</mi></mrow><mo id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.3a.cmml">,</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.cmml"><mn id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.3.cmml">≤</mo><mi id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.4" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.4.cmml">j</mi><mo id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.5" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.5.cmml">≤</mo><mi id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.6" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.6.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.10.m10.2b"><apply id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.3a.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1"><and id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1a.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1"></and><apply id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1b.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1"><leq id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.3"></leq><cn id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.2">1</cn><ci id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.4.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.4">𝑖</ci></apply><apply id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1c.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1"><leq id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.5.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.5"></leq><share href="https://arxiv.org/html/2407.15462v2#S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.4.cmml" id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1d.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1"></share><ci id="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.6.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.1.1.1.1.6">𝑛</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2"><and id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2a.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2"></and><apply id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2b.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2"><leq id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.3"></leq><cn id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.2">1</cn><ci id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.4.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.4">𝑗</ci></apply><apply id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2c.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2"><leq id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.5.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2407.15462v2#S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.4.cmml" id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2d.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2"></share><ci id="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.6.cmml" xref="S2.SS0.SSS0.Px1.1.p1.10.m10.2.2.2.2.6">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.10.m10.2c">1\leq i\leq n,1\leq j\leq m</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.10.m10.2d">1 ≤ italic_i ≤ italic_n , 1 ≤ italic_j ≤ italic_m</annotation></semantics></math>. Here, <math alttext="\lambda_{ij}=1+\frac{\sum_{k=d+1}^{n}U_{ik}V_{kj}}{\sum_{k=1}^{d}U_{ik}V_{kj}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1"><semantics id="S2.SS0.SSS0.Px1.1.p1.11.m11.1a"><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.cmml"><mn id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.1.cmml">+</mo><mfrac id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.cmml"><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.cmml"><mstyle displaystyle="false" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.cmml"><msubsup id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1a" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.cmml"><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.2.cmml">∑</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.2.cmml">d</mi><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.1.cmml">+</mo><mn id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.3.cmml">n</mi></msubsup></mstyle><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.cmml"><msub id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.2.cmml">U</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.3.cmml">k</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.2.cmml">V</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.cmml"><mstyle displaystyle="false" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.cmml"><msubsup id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1a" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.cmml"><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.2.cmml">∑</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.3.cmml">d</mi></msubsup></mstyle><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.cmml"><msub id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.2.cmml">U</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.3.cmml">k</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.2.cmml">V</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.1" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.3" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1b"><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1"><eq id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.1"></eq><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3"><times id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3"><plus id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.1"></plus><cn id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.2">1</cn><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3"><divide id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3"></divide><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2"><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1">subscript</csymbol><sum id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.2"></sum><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3"><eq id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.1"></eq><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.2">𝑘</ci><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3"><plus id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.1"></plus><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.2">𝑑</ci><cn id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.2.3.3.3">1</cn></apply></apply></apply><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.1.3">𝑛</ci></apply><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2"><times id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.1"></times><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.2">𝑈</ci><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3"><times id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.2">𝑉</ci><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3"><times id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.2">𝑘</ci><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.2.2.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3"><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1">subscript</csymbol><sum id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.2"></sum><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3"><eq id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.1"></eq><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.2">𝑘</ci><cn id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.1.3">𝑑</ci></apply><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2"><times id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.1"></times><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.2">𝑈</ci><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3"><times id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.2">𝑉</ci><apply id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3"><times id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.2">𝑘</ci><ci id="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.11.m11.1.1.3.3.3.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1c">\lambda_{ij}=1+\frac{\sum_{k=d+1}^{n}U_{ik}V_{kj}}{\sum_{k=1}^{d}U_{ik}V_{kj}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.11.m11.1d">italic_λ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = 1 + divide start_ARG ∑ start_POSTSUBSCRIPT italic_k = italic_d + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_k italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_k italic_j end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> if <math alttext="\sum_{k=1}^{d}U_{ik}V_{kj}\neq 0" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.12.m12.1"><semantics id="S2.SS0.SSS0.Px1.1.p1.12.m12.1a"><mrow id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.cmml"><msubsup id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.cmml"><mo id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.2" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.2.cmml">∑</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.3" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.3.cmml">d</mi></msubsup><mrow id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.cmml"><msub id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.2.cmml">U</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.3.cmml">k</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.1" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.2.cmml">V</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.1" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.3" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.1" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.1.cmml">≠</mo><mn id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.3" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.12.m12.1b"><apply id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1"><neq id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.1"></neq><apply id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2"><apply id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1">subscript</csymbol><sum id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.2"></sum><apply id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3"><eq id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.1"></eq><ci id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.2">𝑘</ci><cn id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.1.3">𝑑</ci></apply><apply id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2"><times id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.1"></times><apply id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.2">𝑈</ci><apply id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3"><times id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.2">𝑉</ci><apply id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3"><times id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.2">𝑘</ci><ci id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.2.2.3.3.3">𝑗</ci></apply></apply></apply></apply><cn id="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.12.m12.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.12.m12.1c">\sum_{k=1}^{d}U_{ik}V_{kj}\neq 0</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.12.m12.1d">∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_k italic_j end_POSTSUBSCRIPT ≠ 0</annotation></semantics></math>, otherwise <math alttext="\lambda_{ij}=1+\frac{\sum_{k=d+1}^{n}U_{ik}V_{kj}}{\epsilon}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.13.m13.1"><semantics id="S2.SS0.SSS0.Px1.1.p1.13.m13.1a"><mrow id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.1" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.cmml"><mn id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.1" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.1.cmml">+</mo><mfrac id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.cmml"><mrow id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.cmml"><mstyle displaystyle="false" id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.cmml"><msubsup id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1a" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.cmml"><mo id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.2.cmml">∑</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.2.cmml">d</mi><mo id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.1" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.1.cmml">+</mo><mn id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.3.cmml">n</mi></msubsup></mstyle><mrow id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.cmml"><msub id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.2.cmml">U</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.1" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.3.cmml">k</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.1" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.2.cmml">V</mi><mrow id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.2" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.1" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mi id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.3.cmml">ϵ</mi></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.13.m13.1b"><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1"><eq id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.1"></eq><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3"><times id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3"><plus id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.1"></plus><cn id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.2">1</cn><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3"><divide id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3"></divide><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2"><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1">subscript</csymbol><sum id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.2"></sum><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3"><eq id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.1"></eq><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.2">𝑘</ci><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3"><plus id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.1"></plus><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.2">𝑑</ci><cn id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.2.3.3.3">1</cn></apply></apply></apply><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.1.3">𝑛</ci></apply><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2"><times id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.1"></times><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.2">𝑈</ci><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3"><times id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.2">𝑉</ci><apply id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3"><times id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.1"></times><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.2">𝑘</ci><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.2.2.3.3.3">𝑗</ci></apply></apply></apply></apply><ci id="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.13.m13.1.1.3.3.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.13.m13.1c">\lambda_{ij}=1+\frac{\sum_{k=d+1}^{n}U_{ik}V_{kj}}{\epsilon}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.13.m13.1d">italic_λ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = 1 + divide start_ARG ∑ start_POSTSUBSCRIPT italic_k = italic_d + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_k italic_j end_POSTSUBSCRIPT end_ARG start_ARG italic_ϵ end_ARG</annotation></semantics></math>. Thus, we have <math alttext="|A-A^{\prime}|\leq\epsilon" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.1.p1.14.m14.1"><semantics id="S2.SS0.SSS0.Px1.1.p1.14.m14.1a"><mrow id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.2.1.cmml">|</mo><mrow id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.2.cmml">A</mi><mo id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.1.cmml">−</mo><msup id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3.2.cmml">A</mi><mo id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3.3" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.3" stretchy="false" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.2" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.2.cmml">≤</mo><mi id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.3" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.3.cmml">ϵ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.1.p1.14.m14.1b"><apply id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1"><leq id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.2"></leq><apply id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1"><abs id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.2"></abs><apply id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1"><minus id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.1"></minus><ci id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.2">𝐴</ci><apply id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3.2">𝐴</ci><ci id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.1.1.1.3.3">′</ci></apply></apply></apply><ci id="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.1.p1.14.m14.1.1.3">italic-ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.1.p1.14.m14.1c">|A-A^{\prime}|\leq\epsilon</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.1.p1.14.m14.1d">| italic_A - italic_A start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | ≤ italic_ϵ</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.2.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.2.p2.14">Let <math alttext="\lambda_{min}=\min{\lambda_{ij}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.2.p2.1.m1.1a"><mrow id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.2" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.2.cmml">m</mi><mo id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.3.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.4" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.4.cmml">n</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.1" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.1" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.1.cmml">min</mi><mo id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3a" lspace="0.167em" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.cmml">⁡</mo><msub id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.1.m1.1b"><apply id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1"><eq id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.1"></eq><apply id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3"><times id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.2">𝑚</ci><ci id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.3">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.2.3.4">𝑛</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3"><min id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.1"></min><apply id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3"><times id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.1.m1.1.1.3.2.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.1.m1.1c">\lambda_{min}=\min{\lambda_{ij}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT = roman_min italic_λ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\lambda_{max}=\max{\lambda_{ij}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.2.p2.2.m2.1a"><mrow id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.2" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.2.cmml">m</mi><mo id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.3.cmml">a</mi><mo id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.4" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.4.cmml">x</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.1" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.1" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.1.cmml">max</mi><mo id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3a" lspace="0.167em" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.cmml">⁡</mo><msub id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.2.m2.1b"><apply id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1"><eq id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.1"></eq><apply id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3"><times id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.2">𝑚</ci><ci id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.3">𝑎</ci><ci id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.2.3.4">𝑥</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3"><max id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.1"></max><apply id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3"><times id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.2.m2.1.1.3.2.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.2.m2.1c">\lambda_{max}=\max{\lambda_{ij}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.2.m2.1d">italic_λ start_POSTSUBSCRIPT italic_m italic_a italic_x end_POSTSUBSCRIPT = roman_max italic_λ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. Let <math alttext="B_{1}=\lambda_{min}U{D_{n,d}}V" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.3.m3.2"><semantics id="S2.SS0.SSS0.Px1.2.p2.3.m3.2a"><mrow id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.cmml"><msub id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2.2.cmml">B</mi><mn id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2.3" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2.3.cmml">1</mn></msub><mo id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.cmml"><msub id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.2.cmml">m</mi><mo id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.3.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.4" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.4.cmml">n</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.1" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.3" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.3.cmml">U</mi><mo id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.4" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.4.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.4.2" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.4.2.cmml">D</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.2.2.4" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.3.m3.1.1.1.1" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.1.1.1.1.cmml">n</mi><mo id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.2.2.4.1" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.2.2.2" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.2.2.2.cmml">d</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.1b" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.5" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.5.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.3.m3.2b"><apply id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3"><eq id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.1"></eq><apply id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2.2">𝐵</ci><cn id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.2.3">1</cn></apply><apply id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3"><times id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.1"></times><apply id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3"><times id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.2">𝑚</ci><ci id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.3">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.2.3.4">𝑛</ci></apply></apply><ci id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.3">𝑈</ci><apply id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.4.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.4">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.4.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.4.2">𝐷</ci><list id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.2.2.4"><ci id="S2.SS0.SSS0.Px1.2.p2.3.m3.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.1.1.1.1">𝑛</ci><ci id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.2.2.2">𝑑</ci></list></apply><ci id="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.5.cmml" xref="S2.SS0.SSS0.Px1.2.p2.3.m3.2.3.3.5">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.3.m3.2c">B_{1}=\lambda_{min}U{D_{n,d}}V</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.3.m3.2d">italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_λ start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT italic_U italic_D start_POSTSUBSCRIPT italic_n , italic_d end_POSTSUBSCRIPT italic_V</annotation></semantics></math>, <math alttext="B_{2}=\lambda_{max}U{D_{n,d}}V" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.4.m4.2"><semantics id="S2.SS0.SSS0.Px1.2.p2.4.m4.2a"><mrow id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.cmml"><msub id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2.2.cmml">B</mi><mn id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2.3" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2.3.cmml">2</mn></msub><mo id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.1.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.cmml"><msub id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.2.cmml">m</mi><mo id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.3.cmml">a</mi><mo id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.4" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.4.cmml">x</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.1" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.3" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.3.cmml">U</mi><mo id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.4" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.4.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.4.2" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.4.2.cmml">D</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.2.2.4" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.4.m4.1.1.1.1" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.1.1.1.1.cmml">n</mi><mo id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.2.2.4.1" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.2.2.3.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.2.2.2" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.2.2.2.cmml">d</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.1b" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.5" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.5.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.4.m4.2b"><apply id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3"><eq id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.1"></eq><apply id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2.2">𝐵</ci><cn id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.2.3">2</cn></apply><apply id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3"><times id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.1"></times><apply id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3"><times id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.2">𝑚</ci><ci id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.3">𝑎</ci><ci id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.2.3.4">𝑥</ci></apply></apply><ci id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.3">𝑈</ci><apply id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.4.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.4">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.4.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.4.2">𝐷</ci><list id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.2.2.4"><ci id="S2.SS0.SSS0.Px1.2.p2.4.m4.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.1.1.1.1">𝑛</ci><ci id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.2.2.2">𝑑</ci></list></apply><ci id="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.5.cmml" xref="S2.SS0.SSS0.Px1.2.p2.4.m4.2.3.3.5">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.4.m4.2c">B_{2}=\lambda_{max}U{D_{n,d}}V</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.4.m4.2d">italic_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_λ start_POSTSUBSCRIPT italic_m italic_a italic_x end_POSTSUBSCRIPT italic_U italic_D start_POSTSUBSCRIPT italic_n , italic_d end_POSTSUBSCRIPT italic_V</annotation></semantics></math>, where <math alttext="D_{n,d}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.5.m5.2"><semantics id="S2.SS0.SSS0.Px1.2.p2.5.m5.2a"><msub id="S2.SS0.SSS0.Px1.2.p2.5.m5.2.3" xref="S2.SS0.SSS0.Px1.2.p2.5.m5.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.5.m5.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.5.m5.2.3.2.cmml">D</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.5.m5.2.2.2.4" xref="S2.SS0.SSS0.Px1.2.p2.5.m5.2.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.5.m5.1.1.1.1" xref="S2.SS0.SSS0.Px1.2.p2.5.m5.1.1.1.1.cmml">n</mi><mo id="S2.SS0.SSS0.Px1.2.p2.5.m5.2.2.2.4.1" xref="S2.SS0.SSS0.Px1.2.p2.5.m5.2.2.2.3.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.2.p2.5.m5.2.2.2.2" xref="S2.SS0.SSS0.Px1.2.p2.5.m5.2.2.2.2.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.5.m5.2b"><apply id="S2.SS0.SSS0.Px1.2.p2.5.m5.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.5.m5.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.5.m5.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.5.m5.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.5.m5.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.5.m5.2.3.2">𝐷</ci><list id="S2.SS0.SSS0.Px1.2.p2.5.m5.2.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.5.m5.2.2.2.4"><ci id="S2.SS0.SSS0.Px1.2.p2.5.m5.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.5.m5.1.1.1.1">𝑛</ci><ci id="S2.SS0.SSS0.Px1.2.p2.5.m5.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.5.m5.2.2.2.2">𝑑</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.5.m5.2c">D_{n,d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.5.m5.2d">italic_D start_POSTSUBSCRIPT italic_n , italic_d end_POSTSUBSCRIPT</annotation></semantics></math> denotes an <math alttext="n" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.6.m6.1"><semantics id="S2.SS0.SSS0.Px1.2.p2.6.m6.1a"><mi id="S2.SS0.SSS0.Px1.2.p2.6.m6.1.1" xref="S2.SS0.SSS0.Px1.2.p2.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.6.m6.1b"><ci id="S2.SS0.SSS0.Px1.2.p2.6.m6.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.6.m6.1d">italic_n</annotation></semantics></math>-by-<math alttext="n" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.7.m7.1"><semantics id="S2.SS0.SSS0.Px1.2.p2.7.m7.1a"><mi id="S2.SS0.SSS0.Px1.2.p2.7.m7.1.1" xref="S2.SS0.SSS0.Px1.2.p2.7.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.7.m7.1b"><ci id="S2.SS0.SSS0.Px1.2.p2.7.m7.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.7.m7.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.7.m7.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.7.m7.1d">italic_n</annotation></semantics></math> diagonal matrix with the first <math alttext="d" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.8.m8.1"><semantics id="S2.SS0.SSS0.Px1.2.p2.8.m8.1a"><mi id="S2.SS0.SSS0.Px1.2.p2.8.m8.1.1" xref="S2.SS0.SSS0.Px1.2.p2.8.m8.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.8.m8.1b"><ci id="S2.SS0.SSS0.Px1.2.p2.8.m8.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.8.m8.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.8.m8.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.8.m8.1d">italic_d</annotation></semantics></math> elements of the diagonal being <math alttext="1" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.9.m9.1"><semantics id="S2.SS0.SSS0.Px1.2.p2.9.m9.1a"><mn id="S2.SS0.SSS0.Px1.2.p2.9.m9.1.1" xref="S2.SS0.SSS0.Px1.2.p2.9.m9.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.9.m9.1b"><cn id="S2.SS0.SSS0.Px1.2.p2.9.m9.1.1.cmml" type="integer" xref="S2.SS0.SSS0.Px1.2.p2.9.m9.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.9.m9.1c">1</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.9.m9.1d">1</annotation></semantics></math>s and the rest being <math alttext="0" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.10.m10.1"><semantics id="S2.SS0.SSS0.Px1.2.p2.10.m10.1a"><mn id="S2.SS0.SSS0.Px1.2.p2.10.m10.1.1" xref="S2.SS0.SSS0.Px1.2.p2.10.m10.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.10.m10.1b"><cn id="S2.SS0.SSS0.Px1.2.p2.10.m10.1.1.cmml" type="integer" xref="S2.SS0.SSS0.Px1.2.p2.10.m10.1.1">0</cn></annotation-xml></semantics></math>s. We have <math alttext="A^{\prime}_{ij}=\lambda_{ij}\sum_{k=1}^{d}U_{ik}V_{kj}=\pi(i,j)\cdot B_{1ij}+(%
1-\pi(i,j))\cdot B_{2ij}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5"><semantics id="S2.SS0.SSS0.Px1.2.p2.11.m11.5a"><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.cmml"><msubsup id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.2.2.cmml">A</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.3.cmml">j</mi></mrow><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.2.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.2.3.cmml">′</mo></msubsup><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.4" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.4.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.cmml"><msub id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.cmml"><msubsup id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.cmml"><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.2.cmml">∑</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.1.cmml">=</mo><mn id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.3.cmml">d</mi></msubsup><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.cmml"><msub id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.2.cmml">U</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.3.cmml">k</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.1.cmml">⁢</mo><msub id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.2.cmml">V</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.2.cmml">k</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.6" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.6.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.cmml"><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.cmml"><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.2.cmml">π</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.3.1.cmml"><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.3.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.1.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.1.1.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.2.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.2.2.cmml">j</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.3.2.3" rspace="0.055em" stretchy="false" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.1" rspace="0.222em" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.1.cmml">⋅</mo><msub id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.2.cmml">B</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.cmml"><mn id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.3.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.4" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.4.cmml">j</mi></mrow></msub></mrow><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.2.cmml">+</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.cmml"><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.cmml"><mn id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.2.cmml">π</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.3.1.cmml"><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.3.3.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.4.4" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.4.4.cmml">j</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.2" rspace="0.222em" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.2.cmml">⋅</mo><msub id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.2.cmml">B</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.cmml"><mn id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.2.cmml">2</mn><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.1" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.3.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.4" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.4.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5b"><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5"><and id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5a.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5"></and><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5b.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5"><eq id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.4"></eq><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3">subscript</csymbol><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.2.2">𝐴</ci><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.2.3">′</ci></apply><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3"><times id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.3.3.3">𝑗</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5"><times id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.1"></times><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3"><times id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3"><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1">superscript</csymbol><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1">subscript</csymbol><sum id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.2"></sum><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3"><eq id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.1"></eq><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.2">𝑘</ci><cn id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.2.3.3">1</cn></apply></apply><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.1.3">𝑑</ci></apply><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2"><times id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.1"></times><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.2">𝑈</ci><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3"><times id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.2.3.3">𝑘</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.2">𝑉</ci><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3"><times id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.2">𝑘</ci><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.3.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5c.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5"><eq id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.6.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.6"></eq><share href="https://arxiv.org/html/2407.15462v2#S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.5.cmml" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5d.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5"></share><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1"><plus id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.2"></plus><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3"><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.1">⋅</ci><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2"><times id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.2">𝜋</ci><interval closure="open" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.2.3.2"><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.1.1">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.2.2">𝑗</ci></interval></apply><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.2">𝐵</ci><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3"><times id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.1"></times><cn id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.2">1</cn><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.3">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.3.3.3.4">𝑗</ci></apply></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1"><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.2">⋅</ci><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1"><minus id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.1"></minus><cn id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.2">1</cn><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3"><times id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.2">𝜋</ci><interval closure="open" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.1.1.1.3.3.2"><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.3.3">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.4.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.4.4">𝑗</ci></interval></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.2">𝐵</ci><apply id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3"><times id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.1"></times><cn id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.2">2</cn><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.3">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.11.m11.5.5.1.1.3.3.4">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5c">A^{\prime}_{ij}=\lambda_{ij}\sum_{k=1}^{d}U_{ik}V_{kj}=\pi(i,j)\cdot B_{1ij}+(%
1-\pi(i,j))\cdot B_{2ij}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.11.m11.5d">italic_A start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = italic_λ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_k italic_j end_POSTSUBSCRIPT = italic_π ( italic_i , italic_j ) ⋅ italic_B start_POSTSUBSCRIPT 1 italic_i italic_j end_POSTSUBSCRIPT + ( 1 - italic_π ( italic_i , italic_j ) ) ⋅ italic_B start_POSTSUBSCRIPT 2 italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\pi(i,j)=\frac{\lambda_{max}-\lambda_{ij}}{\lambda_{max}-\lambda_{min}}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.12.m12.2"><semantics id="S2.SS0.SSS0.Px1.2.p2.12.m12.2a"><mrow id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.cmml"><mrow id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.2.cmml">π</mi><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.1" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.3.1.cmml"><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.3.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.1.1" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.1.1.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.2.cmml">j</mi><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.3.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.1.cmml">=</mo><mfrac id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.cmml"><mrow id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.cmml"><msub id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.2.cmml">m</mi><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.3.cmml">a</mi><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.4" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.4.cmml">x</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.1" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.1.cmml">−</mo><msub id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.1" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.3.cmml">j</mi></mrow></msub></mrow><mrow id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.cmml"><msub id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.2.cmml">m</mi><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.3.cmml">a</mi><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.4" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.4.cmml">x</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.1" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.1.cmml">−</mo><msub id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.2" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.2.cmml">m</mi><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.1" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.3" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.3.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.4" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.4.cmml">n</mi></mrow></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.12.m12.2b"><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3"><eq id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.1"></eq><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2"><times id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.2">𝜋</ci><interval closure="open" id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.2.3.2"><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.1.1">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.2">𝑗</ci></interval></apply><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3"><divide id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3"></divide><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2"><minus id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.1"></minus><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3"><times id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.2">𝑚</ci><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.3">𝑎</ci><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.2.3.4">𝑥</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3"><times id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.2.3.3.3">𝑗</ci></apply></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3"><minus id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.1"></minus><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3"><times id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.2">𝑚</ci><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.3">𝑎</ci><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.2.3.4">𝑥</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3"><times id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.2">𝑚</ci><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.3">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.12.m12.2.3.3.3.3.3.4">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.12.m12.2c">\pi(i,j)=\frac{\lambda_{max}-\lambda_{ij}}{\lambda_{max}-\lambda_{min}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.12.m12.2d">italic_π ( italic_i , italic_j ) = divide start_ARG italic_λ start_POSTSUBSCRIPT italic_m italic_a italic_x end_POSTSUBSCRIPT - italic_λ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_ARG start_ARG italic_λ start_POSTSUBSCRIPT italic_m italic_a italic_x end_POSTSUBSCRIPT - italic_λ start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>. Because <math alttext="\lambda_{min}\leq\lambda_{ij}\leq\lambda_{max}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.13.m13.1"><semantics id="S2.SS0.SSS0.Px1.2.p2.13.m13.1a"><mrow id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.cmml"><msub id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.2" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.2.cmml">m</mi><mo id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.1" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.3.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.4" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.4.cmml">n</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.3" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.3.cmml">≤</mo><msub id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.2" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.2" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.2.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.1" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.3" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.5" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.5.cmml">≤</mo><msub id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.2" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.2.cmml">λ</mi><mrow id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.2" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.2.cmml">m</mi><mo id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.1" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.3" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.3.cmml">a</mi><mo id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.1a" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.1.cmml">⁢</mo><mi id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.4" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.4.cmml">x</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.13.m13.1b"><apply id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1"><and id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1a.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1"></and><apply id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1b.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1"><leq id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.3"></leq><apply id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3"><times id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.2">𝑚</ci><ci id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.3">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.2.3.4">𝑛</ci></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3"><times id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.2">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.3.3">𝑗</ci></apply></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1c.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1"><leq id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.5.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.5"></leq><share href="https://arxiv.org/html/2407.15462v2#S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.4.cmml" id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1d.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1"></share><apply id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.2">𝜆</ci><apply id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3"><times id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.2">𝑚</ci><ci id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.3">𝑎</ci><ci id="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.13.m13.1.1.6.3.4">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.13.m13.1c">\lambda_{min}\leq\lambda_{ij}\leq\lambda_{max}</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.13.m13.1d">italic_λ start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT ≤ italic_λ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ≤ italic_λ start_POSTSUBSCRIPT italic_m italic_a italic_x end_POSTSUBSCRIPT</annotation></semantics></math>, we have <math alttext="0\leq\pi(i,j)\leq 1" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.2.p2.14.m14.2"><semantics id="S2.SS0.SSS0.Px1.2.p2.14.m14.2a"><mrow id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.cmml"><mn id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.2" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.2.cmml">0</mn><mo id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.3" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.3.cmml">≤</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.cmml"><mi id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.2" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.2.cmml">π</mi><mo id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.1" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.1.cmml">⁢</mo><mrow id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.3.2" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.3.1.cmml"><mo id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.3.1.cmml">(</mo><mi id="S2.SS0.SSS0.Px1.2.p2.14.m14.1.1" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.1.1.cmml">i</mi><mo id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.3.2.2" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.3.1.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.2" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.2.cmml">j</mi><mo id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.3.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.5" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.5.cmml">≤</mo><mn id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.6" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.2.p2.14.m14.2b"><apply id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3"><and id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3a.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3"></and><apply id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3b.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3"><leq id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.3.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.3"></leq><cn id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.2">0</cn><apply id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4"><times id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.1"></times><ci id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.2">𝜋</ci><interval closure="open" id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.3.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.3.2"><ci id="S2.SS0.SSS0.Px1.2.p2.14.m14.1.1.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.1.1">𝑖</ci><ci id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.2.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.2">𝑗</ci></interval></apply></apply><apply id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3c.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3"><leq id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.5.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.5"></leq><share href="https://arxiv.org/html/2407.15462v2#S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.4.cmml" id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3d.cmml" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3"></share><cn id="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.6.cmml" type="integer" xref="S2.SS0.SSS0.Px1.2.p2.14.m14.2.3.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.2.p2.14.m14.2c">0\leq\pi(i,j)\leq 1</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.2.p2.14.m14.2d">0 ≤ italic_π ( italic_i , italic_j ) ≤ 1</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.3.p3">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.3.p3.2">Thus, we have constructed <math alttext="B_{1},B_{2},\pi" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.3.p3.1.m1.3"><semantics id="S2.SS0.SSS0.Px1.3.p3.1.m1.3a"><mrow id="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.3.cmml"><msub id="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1.2" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1.2.cmml">B</mi><mn id="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1.3" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.3" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.3.cmml">,</mo><msub id="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2.cmml"><mi id="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2.2" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2.2.cmml">B</mi><mn id="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2.3" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.4" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.3.cmml">,</mo><mi id="S2.SS0.SSS0.Px1.3.p3.1.m1.1.1" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.1.1.cmml">π</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.3.p3.1.m1.3b"><list id="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.3.cmml" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2"><apply id="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1.2">𝐵</ci><cn id="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.2.2.1.1.3">1</cn></apply><apply id="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2.2">𝐵</ci><cn id="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.3.3.2.2.3">2</cn></apply><ci id="S2.SS0.SSS0.Px1.3.p3.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.1.m1.1.1">𝜋</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.3.p3.1.m1.3c">B_{1},B_{2},\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.3.p3.1.m1.3d">italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_π</annotation></semantics></math> such that <math alttext="|A-(\pi\circ B_{1}+(1-\pi)\circ B_{2})|=|A-A^{\prime}|\leq\epsilon" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.3.p3.2.m2.2"><semantics id="S2.SS0.SSS0.Px1.3.p3.2.m2.2a"><mrow id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.cmml"><mrow id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.2.cmml"><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.2.1.cmml">|</mo><mrow id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.3.cmml">A</mi><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.2.cmml">−</mo><mrow id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.2.cmml">π</mi><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.1.cmml">∘</mo><msub id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3.2" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3.2.cmml">B</mi><mn id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3.3" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></msub></mrow><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">π</mi></mrow><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.2.cmml">∘</mo><msub id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3.2" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">B</mi><mn id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3.3" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.3" stretchy="false" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.4" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.4.cmml">=</mo><mrow id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.2.cmml"><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.2" stretchy="false" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.2.1.cmml">|</mo><mrow id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.cmml"><mi id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.2" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.2.cmml">A</mi><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.1" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.1.cmml">−</mo><msup id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3.cmml"><mi id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3.2" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3.2.cmml">A</mi><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3.3" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.3" stretchy="false" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.2.1.cmml">|</mo></mrow><mo id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.5" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.5.cmml">≤</mo><mi id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.6" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.6.cmml">ϵ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.3.p3.2.m2.2b"><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2"><and id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2a.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2"></and><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2b.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2"><eq id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.4.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.4"></eq><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1"><abs id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.2"></abs><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1"><minus id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.2"></minus><ci id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.3">𝐴</ci><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1"><plus id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.2"></plus><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3"><compose id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.1"></compose><ci id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.2">𝜋</ci><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3.2">𝐵</ci><cn id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1"><compose id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.2"></compose><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1"><minus id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜋</ci></apply><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3.2">𝐵</ci><cn id="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.1.1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></apply><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1"><abs id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.2.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.2"></abs><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1"><minus id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.1"></minus><ci id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.2">𝐴</ci><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3">superscript</csymbol><ci id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3.2.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3.2">𝐴</ci><ci id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.1.1.3.3">′</ci></apply></apply></apply></apply><apply id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2c.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2"><leq id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.5.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.5"></leq><share href="https://arxiv.org/html/2407.15462v2#S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.2.cmml" id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2d.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2"></share><ci id="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.6.cmml" xref="S2.SS0.SSS0.Px1.3.p3.2.m2.2.2.6">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.3.p3.2.m2.2c">|A-(\pi\circ B_{1}+(1-\pi)\circ B_{2})|=|A-A^{\prime}|\leq\epsilon</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.3.p3.2.m2.2d">| italic_A - ( italic_π ∘ italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + ( 1 - italic_π ) ∘ italic_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) | = | italic_A - italic_A start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | ≤ italic_ϵ</annotation></semantics></math>.
∎</p>
</div>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p6">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p6.1"><span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px1.p6.1.1">Remark</span>
Here, we have shown that any high-rank matrix can be expressed as a mixture of logits of two low-rank matrices. Note that our decomposition is not intended to be used as a distillation of the original high-rank matrix. For instance, it is prohibitively expensive to populate the full matrix with a learned similarity function. In addition, the proof also does not indicate that having a sum of two mixture of logits is sufficient to train the embeddings and the learned similarity function. It is well-known that overparameterization is often necessary to enable efficient and performant training.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Retrieval Algorithms</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.2">In this section, we describe the problem of retrieving the top <math alttext="K" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_K</annotation></semantics></math> items with <span class="ltx_text ltx_font_italic" id="S3.p1.2.1">MoL</span> and both exact and approximate algorithms for retrieval.  Formally, we define the top <math alttext="K" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_K</annotation></semantics></math> retrieval problem as follows:</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="Thmdefinition1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmdefinition1.1.1.1">Definition 1</span></span><span class="ltx_text ltx_font_bold" id="Thmdefinition1.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmdefinition1.p1">
<p class="ltx_p" id="Thmdefinition1.p1.15"><span class="ltx_text ltx_font_bold ltx_font_italic" id="Thmdefinition1.p1.15.15">Top <math alttext="K" class="ltx_Math" display="inline" id="Thmdefinition1.p1.1.1.m1.1"><semantics id="Thmdefinition1.p1.1.1.m1.1a"><mi id="Thmdefinition1.p1.1.1.m1.1.1" mathvariant="normal" xref="Thmdefinition1.p1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.1.1.m1.1b"><ci id="Thmdefinition1.p1.1.1.m1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.1.1.m1.1d">italic_K</annotation></semantics></math> with MoL<span class="ltx_text ltx_font_medium" id="Thmdefinition1.p1.15.15.14">: Let <math alttext="q" class="ltx_Math" display="inline" id="Thmdefinition1.p1.2.2.1.m1.1"><semantics id="Thmdefinition1.p1.2.2.1.m1.1a"><mi id="Thmdefinition1.p1.2.2.1.m1.1.1" mathvariant="normal" xref="Thmdefinition1.p1.2.2.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.2.2.1.m1.1b"><ci id="Thmdefinition1.p1.2.2.1.m1.1.1.cmml" xref="Thmdefinition1.p1.2.2.1.m1.1.1">q</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.2.2.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.2.2.1.m1.1d">italic_q</annotation></semantics></math> be a query and <math alttext="X" class="ltx_Math" display="inline" id="Thmdefinition1.p1.3.3.2.m2.1"><semantics id="Thmdefinition1.p1.3.3.2.m2.1a"><mi id="Thmdefinition1.p1.3.3.2.m2.1.1" mathvariant="normal" xref="Thmdefinition1.p1.3.3.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.3.3.2.m2.1b"><ci id="Thmdefinition1.p1.3.3.2.m2.1.1.cmml" xref="Thmdefinition1.p1.3.3.2.m2.1.1">X</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.3.3.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.3.3.2.m2.1d">italic_X</annotation></semantics></math> be a set of items, where both the query <math alttext="q" class="ltx_Math" display="inline" id="Thmdefinition1.p1.4.4.3.m3.1"><semantics id="Thmdefinition1.p1.4.4.3.m3.1a"><mi id="Thmdefinition1.p1.4.4.3.m3.1.1" mathvariant="normal" xref="Thmdefinition1.p1.4.4.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.4.4.3.m3.1b"><ci id="Thmdefinition1.p1.4.4.3.m3.1.1.cmml" xref="Thmdefinition1.p1.4.4.3.m3.1.1">q</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.4.4.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.4.4.3.m3.1d">italic_q</annotation></semantics></math> and each item <math alttext="x\in X" class="ltx_Math" display="inline" id="Thmdefinition1.p1.5.5.4.m4.1"><semantics id="Thmdefinition1.p1.5.5.4.m4.1a"><mrow id="Thmdefinition1.p1.5.5.4.m4.1.1" xref="Thmdefinition1.p1.5.5.4.m4.1.1.cmml"><mi id="Thmdefinition1.p1.5.5.4.m4.1.1.2" mathvariant="normal" xref="Thmdefinition1.p1.5.5.4.m4.1.1.2.cmml">x</mi><mo id="Thmdefinition1.p1.5.5.4.m4.1.1.1" xref="Thmdefinition1.p1.5.5.4.m4.1.1.1.cmml">∈</mo><mi id="Thmdefinition1.p1.5.5.4.m4.1.1.3" mathvariant="normal" xref="Thmdefinition1.p1.5.5.4.m4.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.5.5.4.m4.1b"><apply id="Thmdefinition1.p1.5.5.4.m4.1.1.cmml" xref="Thmdefinition1.p1.5.5.4.m4.1.1"><in id="Thmdefinition1.p1.5.5.4.m4.1.1.1.cmml" xref="Thmdefinition1.p1.5.5.4.m4.1.1.1"></in><ci id="Thmdefinition1.p1.5.5.4.m4.1.1.2.cmml" xref="Thmdefinition1.p1.5.5.4.m4.1.1.2">x</ci><ci id="Thmdefinition1.p1.5.5.4.m4.1.1.3.cmml" xref="Thmdefinition1.p1.5.5.4.m4.1.1.3">X</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.5.5.4.m4.1c">x\in X</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.5.5.4.m4.1d">italic_x ∈ italic_X</annotation></semantics></math> are associated with <math alttext="P" class="ltx_Math" display="inline" id="Thmdefinition1.p1.6.6.5.m5.1"><semantics id="Thmdefinition1.p1.6.6.5.m5.1a"><mi id="Thmdefinition1.p1.6.6.5.m5.1.1" mathvariant="normal" xref="Thmdefinition1.p1.6.6.5.m5.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.6.6.5.m5.1b"><ci id="Thmdefinition1.p1.6.6.5.m5.1.1.cmml" xref="Thmdefinition1.p1.6.6.5.m5.1.1">P</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.6.6.5.m5.1c">P</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.6.6.5.m5.1d">italic_P</annotation></semantics></math> embeddings. Together we have <math alttext="P" class="ltx_Math" display="inline" id="Thmdefinition1.p1.7.7.6.m6.1"><semantics id="Thmdefinition1.p1.7.7.6.m6.1a"><mi id="Thmdefinition1.p1.7.7.6.m6.1.1" mathvariant="normal" xref="Thmdefinition1.p1.7.7.6.m6.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.7.7.6.m6.1b"><ci id="Thmdefinition1.p1.7.7.6.m6.1.1.cmml" xref="Thmdefinition1.p1.7.7.6.m6.1.1">P</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.7.7.6.m6.1c">P</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.7.7.6.m6.1d">italic_P</annotation></semantics></math> pairs of embeddings, <math alttext="(f_{p}(q),g_{p}(x)),1\leq p\leq P" class="ltx_Math" display="inline" id="Thmdefinition1.p1.8.8.7.m7.4"><semantics id="Thmdefinition1.p1.8.8.7.m7.4a"><mrow id="Thmdefinition1.p1.8.8.7.m7.4.4" xref="Thmdefinition1.p1.8.8.7.m7.4.4.cmml"><mrow id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.2.cmml"><mrow id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.3.cmml"><mo id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.3" stretchy="false" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.3.cmml">(</mo><mrow id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.cmml"><msub id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2.cmml"><mi id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2.2" mathvariant="normal" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2.2.cmml">f</mi><mi id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2.3" mathvariant="normal" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.1" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.3.2" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.cmml"><mo id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.3.2.1" stretchy="false" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.cmml">(</mo><mi id="Thmdefinition1.p1.8.8.7.m7.1.1" mathvariant="normal" xref="Thmdefinition1.p1.8.8.7.m7.1.1.cmml">q</mi><mo id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.3.2.2" stretchy="false" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.4" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.3.cmml">,</mo><mrow id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.cmml"><msub id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2.cmml"><mi id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2.2" mathvariant="normal" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2.2.cmml">g</mi><mi id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2.3" mathvariant="normal" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2.3.cmml">p</mi></msub><mo id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.1" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.1.cmml">⁢</mo><mrow id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.3.2" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.cmml"><mo id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.3.2.1" stretchy="false" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.cmml">(</mo><mi id="Thmdefinition1.p1.8.8.7.m7.2.2" mathvariant="normal" xref="Thmdefinition1.p1.8.8.7.m7.2.2.cmml">x</mi><mo id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.3.2.2" stretchy="false" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.cmml">)</mo></mrow></mrow><mo id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.5" stretchy="false" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.3.cmml">)</mo></mrow><mo id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.2" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.2.cmml">,</mo><mn id="Thmdefinition1.p1.8.8.7.m7.3.3" xref="Thmdefinition1.p1.8.8.7.m7.3.3.cmml">1</mn></mrow><mo id="Thmdefinition1.p1.8.8.7.m7.4.4.3" xref="Thmdefinition1.p1.8.8.7.m7.4.4.3.cmml">≤</mo><mi id="Thmdefinition1.p1.8.8.7.m7.4.4.4" mathvariant="normal" xref="Thmdefinition1.p1.8.8.7.m7.4.4.4.cmml">p</mi><mo id="Thmdefinition1.p1.8.8.7.m7.4.4.5" xref="Thmdefinition1.p1.8.8.7.m7.4.4.5.cmml">≤</mo><mi id="Thmdefinition1.p1.8.8.7.m7.4.4.6" mathvariant="normal" xref="Thmdefinition1.p1.8.8.7.m7.4.4.6.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.8.8.7.m7.4b"><apply id="Thmdefinition1.p1.8.8.7.m7.4.4.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4"><and id="Thmdefinition1.p1.8.8.7.m7.4.4a.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4"></and><apply id="Thmdefinition1.p1.8.8.7.m7.4.4b.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4"><leq id="Thmdefinition1.p1.8.8.7.m7.4.4.3.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.3"></leq><list id="Thmdefinition1.p1.8.8.7.m7.4.4.1.2.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1"><interval closure="open" id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.3.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2"><apply id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1"><times id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.1"></times><apply id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2.1.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2">subscript</csymbol><ci id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2.2.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2.2">f</ci><ci id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2.3.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.1.1.2.3">p</ci></apply><ci id="Thmdefinition1.p1.8.8.7.m7.1.1.cmml" xref="Thmdefinition1.p1.8.8.7.m7.1.1">q</ci></apply><apply id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2"><times id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.1.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.1"></times><apply id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2.1.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2">subscript</csymbol><ci id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2.2.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2.2">g</ci><ci id="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2.3.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.1.1.1.2.2.2.3">p</ci></apply><ci id="Thmdefinition1.p1.8.8.7.m7.2.2.cmml" xref="Thmdefinition1.p1.8.8.7.m7.2.2">x</ci></apply></interval><cn id="Thmdefinition1.p1.8.8.7.m7.3.3.cmml" type="integer" xref="Thmdefinition1.p1.8.8.7.m7.3.3">1</cn></list><ci id="Thmdefinition1.p1.8.8.7.m7.4.4.4.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.4">p</ci></apply><apply id="Thmdefinition1.p1.8.8.7.m7.4.4c.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4"><leq id="Thmdefinition1.p1.8.8.7.m7.4.4.5.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.5"></leq><share href="https://arxiv.org/html/2407.15462v2#Thmdefinition1.p1.8.8.7.m7.4.4.4.cmml" id="Thmdefinition1.p1.8.8.7.m7.4.4d.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4"></share><ci id="Thmdefinition1.p1.8.8.7.m7.4.4.6.cmml" xref="Thmdefinition1.p1.8.8.7.m7.4.4.6">P</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.8.8.7.m7.4c">(f_{p}(q),g_{p}(x)),1\leq p\leq P</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.8.8.7.m7.4d">( italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ) , 1 ≤ italic_p ≤ italic_P</annotation></semantics></math>. Let <math alttext="\phi(q,x)=\sum_{p=1}^{P}\pi_{p}(q,x)\langle f_{p}(q),g_{p}(x)\rangle" class="ltx_Math" display="inline" id="Thmdefinition1.p1.9.9.8.m8.8"><semantics id="Thmdefinition1.p1.9.9.8.m8.8a"><mrow id="Thmdefinition1.p1.9.9.8.m8.8.8" xref="Thmdefinition1.p1.9.9.8.m8.8.8.cmml"><mrow id="Thmdefinition1.p1.9.9.8.m8.8.8.4" xref="Thmdefinition1.p1.9.9.8.m8.8.8.4.cmml"><mi id="Thmdefinition1.p1.9.9.8.m8.8.8.4.2" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.8.8.4.2.cmml">ϕ</mi><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.4.1" xref="Thmdefinition1.p1.9.9.8.m8.8.8.4.1.cmml">⁢</mo><mrow id="Thmdefinition1.p1.9.9.8.m8.8.8.4.3.2" xref="Thmdefinition1.p1.9.9.8.m8.8.8.4.3.1.cmml"><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.4.3.2.1" stretchy="false" xref="Thmdefinition1.p1.9.9.8.m8.8.8.4.3.1.cmml">(</mo><mi id="Thmdefinition1.p1.9.9.8.m8.1.1" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.1.1.cmml">q</mi><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.4.3.2.2" xref="Thmdefinition1.p1.9.9.8.m8.8.8.4.3.1.cmml">,</mo><mi id="Thmdefinition1.p1.9.9.8.m8.2.2" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.2.2.cmml">x</mi><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.4.3.2.3" stretchy="false" xref="Thmdefinition1.p1.9.9.8.m8.8.8.4.3.1.cmml">)</mo></mrow></mrow><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.3" rspace="0.111em" xref="Thmdefinition1.p1.9.9.8.m8.8.8.3.cmml">=</mo><mrow id="Thmdefinition1.p1.9.9.8.m8.8.8.2" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.cmml"><msubsup id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.cmml"><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.2" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.2.cmml">∑</mo><mrow id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.cmml"><mi id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.2" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.2.cmml">p</mi><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.1" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.1.cmml">=</mo><mn id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.3" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.3.cmml">1</mn></mrow><mi id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.3" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.3.cmml">P</mi></msubsup><mrow id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.cmml"><msub id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4.cmml"><mi id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4.2" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4.2.cmml">π</mi><mi id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4.3" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4.3.cmml">p</mi></msub><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.3" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.3.cmml">⁢</mo><mrow id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.5.2" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.5.1.cmml"><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.5.2.1" stretchy="false" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.5.1.cmml">(</mo><mi id="Thmdefinition1.p1.9.9.8.m8.3.3" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.3.3.cmml">q</mi><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.5.2.2" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.5.1.cmml">,</mo><mi id="Thmdefinition1.p1.9.9.8.m8.4.4" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.4.4.cmml">x</mi><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.5.2.3" stretchy="false" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.5.1.cmml">)</mo></mrow><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.3a" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.3.cmml">⁢</mo><mrow id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.3.cmml"><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.3" stretchy="false" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.3.cmml">⟨</mo><mrow id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.cmml"><msub id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2.cmml"><mi id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2.2" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2.2.cmml">f</mi><mi id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2.3" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.1" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.3.2" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.cmml"><mo id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.3.2.1" stretchy="false" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.cmml">(</mo><mi id="Thmdefinition1.p1.9.9.8.m8.5.5" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.5.5.cmml">q</mi><mo id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.3.2.2" stretchy="false" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.4" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.3.cmml">,</mo><mrow id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.cmml"><msub id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2.cmml"><mi id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2.2" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2.2.cmml">g</mi><mi id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2.3" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2.3.cmml">p</mi></msub><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.1" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.1.cmml">⁢</mo><mrow id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.3.2" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.cmml"><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.3.2.1" stretchy="false" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.cmml">(</mo><mi id="Thmdefinition1.p1.9.9.8.m8.6.6" mathvariant="normal" xref="Thmdefinition1.p1.9.9.8.m8.6.6.cmml">x</mi><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.3.2.2" stretchy="false" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.5" stretchy="false" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.3.cmml">⟩</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.9.9.8.m8.8b"><apply id="Thmdefinition1.p1.9.9.8.m8.8.8.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8"><eq id="Thmdefinition1.p1.9.9.8.m8.8.8.3.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.3"></eq><apply id="Thmdefinition1.p1.9.9.8.m8.8.8.4.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.4"><times id="Thmdefinition1.p1.9.9.8.m8.8.8.4.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.4.1"></times><ci id="Thmdefinition1.p1.9.9.8.m8.8.8.4.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.4.2">ϕ</ci><interval closure="open" id="Thmdefinition1.p1.9.9.8.m8.8.8.4.3.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.4.3.2"><ci id="Thmdefinition1.p1.9.9.8.m8.1.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.1.1">q</ci><ci id="Thmdefinition1.p1.9.9.8.m8.2.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.2.2">x</ci></interval></apply><apply id="Thmdefinition1.p1.9.9.8.m8.8.8.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2"><apply id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3"><csymbol cd="ambiguous" id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3">superscript</csymbol><apply id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3"><csymbol cd="ambiguous" id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3">subscript</csymbol><sum id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.2"></sum><apply id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3"><eq id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.1"></eq><ci id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.2">p</ci><cn id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.3.cmml" type="integer" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.2.3.3">1</cn></apply></apply><ci id="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.3.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.3.3">P</ci></apply><apply id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2"><times id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.3.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.3"></times><apply id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4"><csymbol cd="ambiguous" id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4">subscript</csymbol><ci id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4.2">π</ci><ci id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4.3.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.4.3">p</ci></apply><interval closure="open" id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.5.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.5.2"><ci id="Thmdefinition1.p1.9.9.8.m8.3.3.cmml" xref="Thmdefinition1.p1.9.9.8.m8.3.3">q</ci><ci id="Thmdefinition1.p1.9.9.8.m8.4.4.cmml" xref="Thmdefinition1.p1.9.9.8.m8.4.4">x</ci></interval><list id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.3.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2"><apply id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1"><times id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.1"></times><apply id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2">subscript</csymbol><ci id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2.2">f</ci><ci id="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2.3.cmml" xref="Thmdefinition1.p1.9.9.8.m8.7.7.1.1.1.1.1.2.3">p</ci></apply><ci id="Thmdefinition1.p1.9.9.8.m8.5.5.cmml" xref="Thmdefinition1.p1.9.9.8.m8.5.5">q</ci></apply><apply id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2"><times id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.1"></times><apply id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2.1.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2">subscript</csymbol><ci id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2.2.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2.2">g</ci><ci id="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2.3.cmml" xref="Thmdefinition1.p1.9.9.8.m8.8.8.2.2.2.2.2.2.3">p</ci></apply><ci id="Thmdefinition1.p1.9.9.8.m8.6.6.cmml" xref="Thmdefinition1.p1.9.9.8.m8.6.6">x</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.9.9.8.m8.8c">\phi(q,x)=\sum_{p=1}^{P}\pi_{p}(q,x)\langle f_{p}(q),g_{p}(x)\rangle</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.9.9.8.m8.8d">italic_ϕ ( italic_q , italic_x ) = ∑ start_POSTSUBSCRIPT italic_p = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q , italic_x ) ⟨ italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ⟩</annotation></semantics></math> be the similarity score of <math alttext="q,x" class="ltx_Math" display="inline" id="Thmdefinition1.p1.10.10.9.m9.2"><semantics id="Thmdefinition1.p1.10.10.9.m9.2a"><mrow id="Thmdefinition1.p1.10.10.9.m9.2.3.2" xref="Thmdefinition1.p1.10.10.9.m9.2.3.1.cmml"><mi id="Thmdefinition1.p1.10.10.9.m9.1.1" mathvariant="normal" xref="Thmdefinition1.p1.10.10.9.m9.1.1.cmml">q</mi><mo id="Thmdefinition1.p1.10.10.9.m9.2.3.2.1" xref="Thmdefinition1.p1.10.10.9.m9.2.3.1.cmml">,</mo><mi id="Thmdefinition1.p1.10.10.9.m9.2.2" mathvariant="normal" xref="Thmdefinition1.p1.10.10.9.m9.2.2.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.10.10.9.m9.2b"><list id="Thmdefinition1.p1.10.10.9.m9.2.3.1.cmml" xref="Thmdefinition1.p1.10.10.9.m9.2.3.2"><ci id="Thmdefinition1.p1.10.10.9.m9.1.1.cmml" xref="Thmdefinition1.p1.10.10.9.m9.1.1">q</ci><ci id="Thmdefinition1.p1.10.10.9.m9.2.2.cmml" xref="Thmdefinition1.p1.10.10.9.m9.2.2">x</ci></list></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.10.10.9.m9.2c">q,x</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.10.10.9.m9.2d">italic_q , italic_x</annotation></semantics></math>, where <math alttext="x\in X" class="ltx_Math" display="inline" id="Thmdefinition1.p1.11.11.10.m10.1"><semantics id="Thmdefinition1.p1.11.11.10.m10.1a"><mrow id="Thmdefinition1.p1.11.11.10.m10.1.1" xref="Thmdefinition1.p1.11.11.10.m10.1.1.cmml"><mi id="Thmdefinition1.p1.11.11.10.m10.1.1.2" mathvariant="normal" xref="Thmdefinition1.p1.11.11.10.m10.1.1.2.cmml">x</mi><mo id="Thmdefinition1.p1.11.11.10.m10.1.1.1" xref="Thmdefinition1.p1.11.11.10.m10.1.1.1.cmml">∈</mo><mi id="Thmdefinition1.p1.11.11.10.m10.1.1.3" mathvariant="normal" xref="Thmdefinition1.p1.11.11.10.m10.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.11.11.10.m10.1b"><apply id="Thmdefinition1.p1.11.11.10.m10.1.1.cmml" xref="Thmdefinition1.p1.11.11.10.m10.1.1"><in id="Thmdefinition1.p1.11.11.10.m10.1.1.1.cmml" xref="Thmdefinition1.p1.11.11.10.m10.1.1.1"></in><ci id="Thmdefinition1.p1.11.11.10.m10.1.1.2.cmml" xref="Thmdefinition1.p1.11.11.10.m10.1.1.2">x</ci><ci id="Thmdefinition1.p1.11.11.10.m10.1.1.3.cmml" xref="Thmdefinition1.p1.11.11.10.m10.1.1.3">X</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.11.11.10.m10.1c">x\in X</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.11.11.10.m10.1d">italic_x ∈ italic_X</annotation></semantics></math>. The top <math alttext="K" class="ltx_Math" display="inline" id="Thmdefinition1.p1.12.12.11.m11.1"><semantics id="Thmdefinition1.p1.12.12.11.m11.1a"><mi id="Thmdefinition1.p1.12.12.11.m11.1.1" mathvariant="normal" xref="Thmdefinition1.p1.12.12.11.m11.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.12.12.11.m11.1b"><ci id="Thmdefinition1.p1.12.12.11.m11.1.1.cmml" xref="Thmdefinition1.p1.12.12.11.m11.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.12.12.11.m11.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.12.12.11.m11.1d">italic_K</annotation></semantics></math> query with MoL returns the <math alttext="K" class="ltx_Math" display="inline" id="Thmdefinition1.p1.13.13.12.m12.1"><semantics id="Thmdefinition1.p1.13.13.12.m12.1a"><mi id="Thmdefinition1.p1.13.13.12.m12.1.1" mathvariant="normal" xref="Thmdefinition1.p1.13.13.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.13.13.12.m12.1b"><ci id="Thmdefinition1.p1.13.13.12.m12.1.1.cmml" xref="Thmdefinition1.p1.13.13.12.m12.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.13.13.12.m12.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.13.13.12.m12.1d">italic_K</annotation></semantics></math> items from <math alttext="X" class="ltx_Math" display="inline" id="Thmdefinition1.p1.14.14.13.m13.1"><semantics id="Thmdefinition1.p1.14.14.13.m13.1a"><mi id="Thmdefinition1.p1.14.14.13.m13.1.1" mathvariant="normal" xref="Thmdefinition1.p1.14.14.13.m13.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.14.14.13.m13.1b"><ci id="Thmdefinition1.p1.14.14.13.m13.1.1.cmml" xref="Thmdefinition1.p1.14.14.13.m13.1.1">X</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.14.14.13.m13.1c">X</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.14.14.13.m13.1d">italic_X</annotation></semantics></math> with the highest <math alttext="\phi(q,x)" class="ltx_Math" display="inline" id="Thmdefinition1.p1.15.15.14.m14.2"><semantics id="Thmdefinition1.p1.15.15.14.m14.2a"><mrow id="Thmdefinition1.p1.15.15.14.m14.2.3" xref="Thmdefinition1.p1.15.15.14.m14.2.3.cmml"><mi id="Thmdefinition1.p1.15.15.14.m14.2.3.2" mathvariant="normal" xref="Thmdefinition1.p1.15.15.14.m14.2.3.2.cmml">ϕ</mi><mo id="Thmdefinition1.p1.15.15.14.m14.2.3.1" xref="Thmdefinition1.p1.15.15.14.m14.2.3.1.cmml">⁢</mo><mrow id="Thmdefinition1.p1.15.15.14.m14.2.3.3.2" xref="Thmdefinition1.p1.15.15.14.m14.2.3.3.1.cmml"><mo id="Thmdefinition1.p1.15.15.14.m14.2.3.3.2.1" stretchy="false" xref="Thmdefinition1.p1.15.15.14.m14.2.3.3.1.cmml">(</mo><mi id="Thmdefinition1.p1.15.15.14.m14.1.1" mathvariant="normal" xref="Thmdefinition1.p1.15.15.14.m14.1.1.cmml">q</mi><mo id="Thmdefinition1.p1.15.15.14.m14.2.3.3.2.2" xref="Thmdefinition1.p1.15.15.14.m14.2.3.3.1.cmml">,</mo><mi id="Thmdefinition1.p1.15.15.14.m14.2.2" mathvariant="normal" xref="Thmdefinition1.p1.15.15.14.m14.2.2.cmml">x</mi><mo id="Thmdefinition1.p1.15.15.14.m14.2.3.3.2.3" stretchy="false" xref="Thmdefinition1.p1.15.15.14.m14.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.15.15.14.m14.2b"><apply id="Thmdefinition1.p1.15.15.14.m14.2.3.cmml" xref="Thmdefinition1.p1.15.15.14.m14.2.3"><times id="Thmdefinition1.p1.15.15.14.m14.2.3.1.cmml" xref="Thmdefinition1.p1.15.15.14.m14.2.3.1"></times><ci id="Thmdefinition1.p1.15.15.14.m14.2.3.2.cmml" xref="Thmdefinition1.p1.15.15.14.m14.2.3.2">ϕ</ci><interval closure="open" id="Thmdefinition1.p1.15.15.14.m14.2.3.3.1.cmml" xref="Thmdefinition1.p1.15.15.14.m14.2.3.3.2"><ci id="Thmdefinition1.p1.15.15.14.m14.1.1.cmml" xref="Thmdefinition1.p1.15.15.14.m14.1.1">q</ci><ci id="Thmdefinition1.p1.15.15.14.m14.2.2.cmml" xref="Thmdefinition1.p1.15.15.14.m14.2.2">x</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.15.15.14.m14.2c">\phi(q,x)</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.15.15.14.m14.2d">italic_ϕ ( italic_q , italic_x )</annotation></semantics></math>s.</span></span></p>
</div>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.2">For approximate top <math alttext="K" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_K</annotation></semantics></math> retrieval with <span class="ltx_text ltx_font_italic" id="S3.p2.2.1">MoL</span>, we define the gap of the approximate and exact top <math alttext="K" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_K</annotation></semantics></math> results as follows:</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="Thmdefinition2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmdefinition2.1.1.1">Definition 2</span></span><span class="ltx_text ltx_font_bold" id="Thmdefinition2.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmdefinition2.p1">
<p class="ltx_p" id="Thmdefinition2.p1.14"><span class="ltx_text ltx_font_bold ltx_font_italic" id="Thmdefinition2.p1.14.14">Gap of approximate top <math alttext="K" class="ltx_Math" display="inline" id="Thmdefinition2.p1.1.1.m1.1"><semantics id="Thmdefinition2.p1.1.1.m1.1a"><mi id="Thmdefinition2.p1.1.1.m1.1.1" mathvariant="normal" xref="Thmdefinition2.p1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.1.1.m1.1b"><ci id="Thmdefinition2.p1.1.1.m1.1.1.cmml" xref="Thmdefinition2.p1.1.1.m1.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.1.1.m1.1d">italic_K</annotation></semantics></math>:<span class="ltx_text ltx_font_medium" id="Thmdefinition2.p1.14.14.13"> Let <math alttext="q" class="ltx_Math" display="inline" id="Thmdefinition2.p1.2.2.1.m1.1"><semantics id="Thmdefinition2.p1.2.2.1.m1.1a"><mi id="Thmdefinition2.p1.2.2.1.m1.1.1" mathvariant="normal" xref="Thmdefinition2.p1.2.2.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.2.2.1.m1.1b"><ci id="Thmdefinition2.p1.2.2.1.m1.1.1.cmml" xref="Thmdefinition2.p1.2.2.1.m1.1.1">q</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.2.2.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.2.2.1.m1.1d">italic_q</annotation></semantics></math> be a query and <math alttext="X_{K}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.3.3.2.m2.1"><semantics id="Thmdefinition2.p1.3.3.2.m2.1a"><msub id="Thmdefinition2.p1.3.3.2.m2.1.1" xref="Thmdefinition2.p1.3.3.2.m2.1.1.cmml"><mi id="Thmdefinition2.p1.3.3.2.m2.1.1.2" mathvariant="normal" xref="Thmdefinition2.p1.3.3.2.m2.1.1.2.cmml">X</mi><mi id="Thmdefinition2.p1.3.3.2.m2.1.1.3" mathvariant="normal" xref="Thmdefinition2.p1.3.3.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.3.3.2.m2.1b"><apply id="Thmdefinition2.p1.3.3.2.m2.1.1.cmml" xref="Thmdefinition2.p1.3.3.2.m2.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.3.3.2.m2.1.1.1.cmml" xref="Thmdefinition2.p1.3.3.2.m2.1.1">subscript</csymbol><ci id="Thmdefinition2.p1.3.3.2.m2.1.1.2.cmml" xref="Thmdefinition2.p1.3.3.2.m2.1.1.2">X</ci><ci id="Thmdefinition2.p1.3.3.2.m2.1.1.3.cmml" xref="Thmdefinition2.p1.3.3.2.m2.1.1.3">K</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.3.3.2.m2.1c">X_{K}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.3.3.2.m2.1d">italic_X start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> be the set of exact top <math alttext="K" class="ltx_Math" display="inline" id="Thmdefinition2.p1.4.4.3.m3.1"><semantics id="Thmdefinition2.p1.4.4.3.m3.1a"><mi id="Thmdefinition2.p1.4.4.3.m3.1.1" mathvariant="normal" xref="Thmdefinition2.p1.4.4.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.4.4.3.m3.1b"><ci id="Thmdefinition2.p1.4.4.3.m3.1.1.cmml" xref="Thmdefinition2.p1.4.4.3.m3.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.4.4.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.4.4.3.m3.1d">italic_K</annotation></semantics></math> items for the query <math alttext="q" class="ltx_Math" display="inline" id="Thmdefinition2.p1.5.5.4.m4.1"><semantics id="Thmdefinition2.p1.5.5.4.m4.1a"><mi id="Thmdefinition2.p1.5.5.4.m4.1.1" mathvariant="normal" xref="Thmdefinition2.p1.5.5.4.m4.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.5.5.4.m4.1b"><ci id="Thmdefinition2.p1.5.5.4.m4.1.1.cmml" xref="Thmdefinition2.p1.5.5.4.m4.1.1">q</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.5.5.4.m4.1c">q</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.5.5.4.m4.1d">italic_q</annotation></semantics></math> from a set of items <math alttext="X" class="ltx_Math" display="inline" id="Thmdefinition2.p1.6.6.5.m5.1"><semantics id="Thmdefinition2.p1.6.6.5.m5.1a"><mi id="Thmdefinition2.p1.6.6.5.m5.1.1" mathvariant="normal" xref="Thmdefinition2.p1.6.6.5.m5.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.6.6.5.m5.1b"><ci id="Thmdefinition2.p1.6.6.5.m5.1.1.cmml" xref="Thmdefinition2.p1.6.6.5.m5.1.1">X</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.6.6.5.m5.1c">X</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.6.6.5.m5.1d">italic_X</annotation></semantics></math>. Let <math alttext="X^{*}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.7.7.6.m6.1"><semantics id="Thmdefinition2.p1.7.7.6.m6.1a"><msup id="Thmdefinition2.p1.7.7.6.m6.1.1" xref="Thmdefinition2.p1.7.7.6.m6.1.1.cmml"><mi id="Thmdefinition2.p1.7.7.6.m6.1.1.2" mathvariant="normal" xref="Thmdefinition2.p1.7.7.6.m6.1.1.2.cmml">X</mi><mo id="Thmdefinition2.p1.7.7.6.m6.1.1.3" xref="Thmdefinition2.p1.7.7.6.m6.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.7.7.6.m6.1b"><apply id="Thmdefinition2.p1.7.7.6.m6.1.1.cmml" xref="Thmdefinition2.p1.7.7.6.m6.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.7.7.6.m6.1.1.1.cmml" xref="Thmdefinition2.p1.7.7.6.m6.1.1">superscript</csymbol><ci id="Thmdefinition2.p1.7.7.6.m6.1.1.2.cmml" xref="Thmdefinition2.p1.7.7.6.m6.1.1.2">X</ci><times id="Thmdefinition2.p1.7.7.6.m6.1.1.3.cmml" xref="Thmdefinition2.p1.7.7.6.m6.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.7.7.6.m6.1c">X^{*}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.7.7.6.m6.1d">italic_X start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> be the approximate top <math alttext="K" class="ltx_Math" display="inline" id="Thmdefinition2.p1.8.8.7.m7.1"><semantics id="Thmdefinition2.p1.8.8.7.m7.1a"><mi id="Thmdefinition2.p1.8.8.7.m7.1.1" mathvariant="normal" xref="Thmdefinition2.p1.8.8.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.8.8.7.m7.1b"><ci id="Thmdefinition2.p1.8.8.7.m7.1.1.cmml" xref="Thmdefinition2.p1.8.8.7.m7.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.8.8.7.m7.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.8.8.7.m7.1d">italic_K</annotation></semantics></math> results, where <math alttext="X^{*}\subseteq X" class="ltx_Math" display="inline" id="Thmdefinition2.p1.9.9.8.m8.1"><semantics id="Thmdefinition2.p1.9.9.8.m8.1a"><mrow id="Thmdefinition2.p1.9.9.8.m8.1.1" xref="Thmdefinition2.p1.9.9.8.m8.1.1.cmml"><msup id="Thmdefinition2.p1.9.9.8.m8.1.1.2" xref="Thmdefinition2.p1.9.9.8.m8.1.1.2.cmml"><mi id="Thmdefinition2.p1.9.9.8.m8.1.1.2.2" mathvariant="normal" xref="Thmdefinition2.p1.9.9.8.m8.1.1.2.2.cmml">X</mi><mo id="Thmdefinition2.p1.9.9.8.m8.1.1.2.3" xref="Thmdefinition2.p1.9.9.8.m8.1.1.2.3.cmml">∗</mo></msup><mo id="Thmdefinition2.p1.9.9.8.m8.1.1.1" xref="Thmdefinition2.p1.9.9.8.m8.1.1.1.cmml">⊆</mo><mi id="Thmdefinition2.p1.9.9.8.m8.1.1.3" mathvariant="normal" xref="Thmdefinition2.p1.9.9.8.m8.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.9.9.8.m8.1b"><apply id="Thmdefinition2.p1.9.9.8.m8.1.1.cmml" xref="Thmdefinition2.p1.9.9.8.m8.1.1"><subset id="Thmdefinition2.p1.9.9.8.m8.1.1.1.cmml" xref="Thmdefinition2.p1.9.9.8.m8.1.1.1"></subset><apply id="Thmdefinition2.p1.9.9.8.m8.1.1.2.cmml" xref="Thmdefinition2.p1.9.9.8.m8.1.1.2"><csymbol cd="ambiguous" id="Thmdefinition2.p1.9.9.8.m8.1.1.2.1.cmml" xref="Thmdefinition2.p1.9.9.8.m8.1.1.2">superscript</csymbol><ci id="Thmdefinition2.p1.9.9.8.m8.1.1.2.2.cmml" xref="Thmdefinition2.p1.9.9.8.m8.1.1.2.2">X</ci><times id="Thmdefinition2.p1.9.9.8.m8.1.1.2.3.cmml" xref="Thmdefinition2.p1.9.9.8.m8.1.1.2.3"></times></apply><ci id="Thmdefinition2.p1.9.9.8.m8.1.1.3.cmml" xref="Thmdefinition2.p1.9.9.8.m8.1.1.3">X</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.9.9.8.m8.1c">X^{*}\subseteq X</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.9.9.8.m8.1d">italic_X start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ⊆ italic_X</annotation></semantics></math>. Let <math alttext="S=\min\{\phi(q,x),x\in X^{*}\}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.10.10.9.m9.5"><semantics id="Thmdefinition2.p1.10.10.9.m9.5a"><mrow id="Thmdefinition2.p1.10.10.9.m9.5.5" xref="Thmdefinition2.p1.10.10.9.m9.5.5.cmml"><mi id="Thmdefinition2.p1.10.10.9.m9.5.5.4" mathvariant="normal" xref="Thmdefinition2.p1.10.10.9.m9.5.5.4.cmml">S</mi><mo id="Thmdefinition2.p1.10.10.9.m9.5.5.3" xref="Thmdefinition2.p1.10.10.9.m9.5.5.3.cmml">=</mo><mrow id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.3.cmml"><mi id="Thmdefinition2.p1.10.10.9.m9.3.3" xref="Thmdefinition2.p1.10.10.9.m9.3.3.cmml">min</mi><mo id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2a" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.3.cmml">⁡</mo><mrow id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.3.cmml"><mo id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.3" stretchy="false" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.3.cmml">{</mo><mrow id="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1" xref="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.cmml"><mi id="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.2" mathvariant="normal" xref="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.2.cmml">ϕ</mi><mo id="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.1" xref="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.3.2" xref="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.3.1.cmml"><mo id="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.3.2.1" stretchy="false" xref="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.3.1.cmml">(</mo><mi id="Thmdefinition2.p1.10.10.9.m9.1.1" mathvariant="normal" xref="Thmdefinition2.p1.10.10.9.m9.1.1.cmml">q</mi><mo id="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.3.2.2" xref="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="Thmdefinition2.p1.10.10.9.m9.2.2" mathvariant="normal" xref="Thmdefinition2.p1.10.10.9.m9.2.2.cmml">x</mi><mo id="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.3.2.3" stretchy="false" xref="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.4" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.3.cmml">,</mo><mrow id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.cmml"><mi id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.2" mathvariant="normal" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.2.cmml">x</mi><mo id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.1" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.1.cmml">∈</mo><msup id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3.cmml"><mi id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3.2" mathvariant="normal" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3.2.cmml">X</mi><mo id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3.3" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3.3.cmml">∗</mo></msup></mrow><mo id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.5" stretchy="false" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.3.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.10.10.9.m9.5b"><apply id="Thmdefinition2.p1.10.10.9.m9.5.5.cmml" xref="Thmdefinition2.p1.10.10.9.m9.5.5"><eq id="Thmdefinition2.p1.10.10.9.m9.5.5.3.cmml" xref="Thmdefinition2.p1.10.10.9.m9.5.5.3"></eq><ci id="Thmdefinition2.p1.10.10.9.m9.5.5.4.cmml" xref="Thmdefinition2.p1.10.10.9.m9.5.5.4">S</ci><apply id="Thmdefinition2.p1.10.10.9.m9.5.5.2.3.cmml" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2"><min id="Thmdefinition2.p1.10.10.9.m9.3.3.cmml" xref="Thmdefinition2.p1.10.10.9.m9.3.3"></min><apply id="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.cmml" xref="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1"><times id="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.1.cmml" xref="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.1"></times><ci id="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.2.cmml" xref="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.2">ϕ</ci><interval closure="open" id="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.3.1.cmml" xref="Thmdefinition2.p1.10.10.9.m9.4.4.1.1.1.1.3.2"><ci id="Thmdefinition2.p1.10.10.9.m9.1.1.cmml" xref="Thmdefinition2.p1.10.10.9.m9.1.1">q</ci><ci id="Thmdefinition2.p1.10.10.9.m9.2.2.cmml" xref="Thmdefinition2.p1.10.10.9.m9.2.2">x</ci></interval></apply><apply id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.cmml" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2"><in id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.1.cmml" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.1"></in><ci id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.2.cmml" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.2">x</ci><apply id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3.cmml" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3"><csymbol cd="ambiguous" id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3.1.cmml" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3">superscript</csymbol><ci id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3.2.cmml" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3.2">X</ci><times id="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3.3.cmml" xref="Thmdefinition2.p1.10.10.9.m9.5.5.2.2.2.2.3.3"></times></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.10.10.9.m9.5c">S=\min\{\phi(q,x),x\in X^{*}\}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.10.10.9.m9.5d">italic_S = roman_min { italic_ϕ ( italic_q , italic_x ) , italic_x ∈ italic_X start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT }</annotation></semantics></math> and <math alttext="S^{\prime}=\max\{\phi(q,x),x\in X_{K}\setminus X^{*}\}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.11.11.10.m10.5"><semantics id="Thmdefinition2.p1.11.11.10.m10.5a"><mrow id="Thmdefinition2.p1.11.11.10.m10.5.5" xref="Thmdefinition2.p1.11.11.10.m10.5.5.cmml"><msup id="Thmdefinition2.p1.11.11.10.m10.5.5.4" xref="Thmdefinition2.p1.11.11.10.m10.5.5.4.cmml"><mi id="Thmdefinition2.p1.11.11.10.m10.5.5.4.2" mathvariant="normal" xref="Thmdefinition2.p1.11.11.10.m10.5.5.4.2.cmml">S</mi><mo id="Thmdefinition2.p1.11.11.10.m10.5.5.4.3" xref="Thmdefinition2.p1.11.11.10.m10.5.5.4.3.cmml">′</mo></msup><mo id="Thmdefinition2.p1.11.11.10.m10.5.5.3" xref="Thmdefinition2.p1.11.11.10.m10.5.5.3.cmml">=</mo><mrow id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.3.cmml"><mi id="Thmdefinition2.p1.11.11.10.m10.3.3" xref="Thmdefinition2.p1.11.11.10.m10.3.3.cmml">max</mi><mo id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2a" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.3.cmml">⁡</mo><mrow id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.3.cmml"><mo id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.3" stretchy="false" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.3.cmml">{</mo><mrow id="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1" xref="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.cmml"><mi id="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.2" mathvariant="normal" xref="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.2.cmml">ϕ</mi><mo id="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.1" xref="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.3.2" xref="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.3.1.cmml"><mo id="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.3.2.1" stretchy="false" xref="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.3.1.cmml">(</mo><mi id="Thmdefinition2.p1.11.11.10.m10.1.1" mathvariant="normal" xref="Thmdefinition2.p1.11.11.10.m10.1.1.cmml">q</mi><mo id="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.3.2.2" xref="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="Thmdefinition2.p1.11.11.10.m10.2.2" mathvariant="normal" xref="Thmdefinition2.p1.11.11.10.m10.2.2.cmml">x</mi><mo id="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.3.2.3" stretchy="false" xref="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.4" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.3.cmml">,</mo><mrow id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.cmml"><mi id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.2" mathvariant="normal" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.2.cmml">x</mi><mo id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.1" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.1.cmml">∈</mo><mrow id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.cmml"><msub id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2.cmml"><mi id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2.2" mathvariant="normal" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2.2.cmml">X</mi><mi id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2.3" mathvariant="normal" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2.3.cmml">K</mi></msub><mo id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.1" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.1.cmml">∖</mo><msup id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3.cmml"><mi id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3.2" mathvariant="normal" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3.2.cmml">X</mi><mo id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3.3" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3.3.cmml">∗</mo></msup></mrow></mrow><mo id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.5" stretchy="false" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.3.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.11.11.10.m10.5b"><apply id="Thmdefinition2.p1.11.11.10.m10.5.5.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5"><eq id="Thmdefinition2.p1.11.11.10.m10.5.5.3.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.3"></eq><apply id="Thmdefinition2.p1.11.11.10.m10.5.5.4.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.4"><csymbol cd="ambiguous" id="Thmdefinition2.p1.11.11.10.m10.5.5.4.1.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.4">superscript</csymbol><ci id="Thmdefinition2.p1.11.11.10.m10.5.5.4.2.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.4.2">S</ci><ci id="Thmdefinition2.p1.11.11.10.m10.5.5.4.3.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.4.3">′</ci></apply><apply id="Thmdefinition2.p1.11.11.10.m10.5.5.2.3.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2"><max id="Thmdefinition2.p1.11.11.10.m10.3.3.cmml" xref="Thmdefinition2.p1.11.11.10.m10.3.3"></max><apply id="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.cmml" xref="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1"><times id="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.1.cmml" xref="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.1"></times><ci id="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.2.cmml" xref="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.2">ϕ</ci><interval closure="open" id="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.3.1.cmml" xref="Thmdefinition2.p1.11.11.10.m10.4.4.1.1.1.1.3.2"><ci id="Thmdefinition2.p1.11.11.10.m10.1.1.cmml" xref="Thmdefinition2.p1.11.11.10.m10.1.1">q</ci><ci id="Thmdefinition2.p1.11.11.10.m10.2.2.cmml" xref="Thmdefinition2.p1.11.11.10.m10.2.2">x</ci></interval></apply><apply id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2"><in id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.1.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.1"></in><ci id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.2.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.2">x</ci><apply id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3"><setdiff id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.1.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.1"></setdiff><apply id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2"><csymbol cd="ambiguous" id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2.1.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2">subscript</csymbol><ci id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2.2.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2.2">X</ci><ci id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2.3.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.2.3">K</ci></apply><apply id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3"><csymbol cd="ambiguous" id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3.1.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3">superscript</csymbol><ci id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3.2.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3.2">X</ci><times id="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3.3.cmml" xref="Thmdefinition2.p1.11.11.10.m10.5.5.2.2.2.2.3.3.3"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.11.11.10.m10.5c">S^{\prime}=\max\{\phi(q,x),x\in X_{K}\setminus X^{*}\}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.11.11.10.m10.5d">italic_S start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = roman_max { italic_ϕ ( italic_q , italic_x ) , italic_x ∈ italic_X start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ∖ italic_X start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT }</annotation></semantics></math>. We call <math alttext="S_{\Delta}=S^{\prime}-S" class="ltx_Math" display="inline" id="Thmdefinition2.p1.12.12.11.m11.1"><semantics id="Thmdefinition2.p1.12.12.11.m11.1a"><mrow id="Thmdefinition2.p1.12.12.11.m11.1.1" xref="Thmdefinition2.p1.12.12.11.m11.1.1.cmml"><msub id="Thmdefinition2.p1.12.12.11.m11.1.1.2" xref="Thmdefinition2.p1.12.12.11.m11.1.1.2.cmml"><mi id="Thmdefinition2.p1.12.12.11.m11.1.1.2.2" mathvariant="normal" xref="Thmdefinition2.p1.12.12.11.m11.1.1.2.2.cmml">S</mi><mi id="Thmdefinition2.p1.12.12.11.m11.1.1.2.3" mathvariant="normal" xref="Thmdefinition2.p1.12.12.11.m11.1.1.2.3.cmml">Δ</mi></msub><mo id="Thmdefinition2.p1.12.12.11.m11.1.1.1" xref="Thmdefinition2.p1.12.12.11.m11.1.1.1.cmml">=</mo><mrow id="Thmdefinition2.p1.12.12.11.m11.1.1.3" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3.cmml"><msup id="Thmdefinition2.p1.12.12.11.m11.1.1.3.2" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3.2.cmml"><mi id="Thmdefinition2.p1.12.12.11.m11.1.1.3.2.2" mathvariant="normal" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3.2.2.cmml">S</mi><mo id="Thmdefinition2.p1.12.12.11.m11.1.1.3.2.3" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3.2.3.cmml">′</mo></msup><mo id="Thmdefinition2.p1.12.12.11.m11.1.1.3.1" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3.1.cmml">−</mo><mi id="Thmdefinition2.p1.12.12.11.m11.1.1.3.3" mathvariant="normal" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3.3.cmml">S</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.12.12.11.m11.1b"><apply id="Thmdefinition2.p1.12.12.11.m11.1.1.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1"><eq id="Thmdefinition2.p1.12.12.11.m11.1.1.1.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1.1"></eq><apply id="Thmdefinition2.p1.12.12.11.m11.1.1.2.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1.2"><csymbol cd="ambiguous" id="Thmdefinition2.p1.12.12.11.m11.1.1.2.1.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1.2">subscript</csymbol><ci id="Thmdefinition2.p1.12.12.11.m11.1.1.2.2.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1.2.2">S</ci><ci id="Thmdefinition2.p1.12.12.11.m11.1.1.2.3.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1.2.3">Δ</ci></apply><apply id="Thmdefinition2.p1.12.12.11.m11.1.1.3.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3"><minus id="Thmdefinition2.p1.12.12.11.m11.1.1.3.1.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3.1"></minus><apply id="Thmdefinition2.p1.12.12.11.m11.1.1.3.2.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3.2"><csymbol cd="ambiguous" id="Thmdefinition2.p1.12.12.11.m11.1.1.3.2.1.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3.2">superscript</csymbol><ci id="Thmdefinition2.p1.12.12.11.m11.1.1.3.2.2.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3.2.2">S</ci><ci id="Thmdefinition2.p1.12.12.11.m11.1.1.3.2.3.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3.2.3">′</ci></apply><ci id="Thmdefinition2.p1.12.12.11.m11.1.1.3.3.cmml" xref="Thmdefinition2.p1.12.12.11.m11.1.1.3.3">S</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.12.12.11.m11.1c">S_{\Delta}=S^{\prime}-S</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.12.12.11.m11.1d">italic_S start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT = italic_S start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT - italic_S</annotation></semantics></math> the gap of the top <math alttext="K" class="ltx_Math" display="inline" id="Thmdefinition2.p1.13.13.12.m12.1"><semantics id="Thmdefinition2.p1.13.13.12.m12.1a"><mi id="Thmdefinition2.p1.13.13.12.m12.1.1" mathvariant="normal" xref="Thmdefinition2.p1.13.13.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.13.13.12.m12.1b"><ci id="Thmdefinition2.p1.13.13.12.m12.1.1.cmml" xref="Thmdefinition2.p1.13.13.12.m12.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.13.13.12.m12.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.13.13.12.m12.1d">italic_K</annotation></semantics></math> with <math alttext="X^{*}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.14.14.13.m13.1"><semantics id="Thmdefinition2.p1.14.14.13.m13.1a"><msup id="Thmdefinition2.p1.14.14.13.m13.1.1" xref="Thmdefinition2.p1.14.14.13.m13.1.1.cmml"><mi id="Thmdefinition2.p1.14.14.13.m13.1.1.2" mathvariant="normal" xref="Thmdefinition2.p1.14.14.13.m13.1.1.2.cmml">X</mi><mo id="Thmdefinition2.p1.14.14.13.m13.1.1.3" xref="Thmdefinition2.p1.14.14.13.m13.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.14.14.13.m13.1b"><apply id="Thmdefinition2.p1.14.14.13.m13.1.1.cmml" xref="Thmdefinition2.p1.14.14.13.m13.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.14.14.13.m13.1.1.1.cmml" xref="Thmdefinition2.p1.14.14.13.m13.1.1">superscript</csymbol><ci id="Thmdefinition2.p1.14.14.13.m13.1.1.2.cmml" xref="Thmdefinition2.p1.14.14.13.m13.1.1.2">X</ci><times id="Thmdefinition2.p1.14.14.13.m13.1.1.3.cmml" xref="Thmdefinition2.p1.14.14.13.m13.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.14.14.13.m13.1c">X^{*}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition2.p1.14.14.13.m13.1d">italic_X start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>.</span></span></p>
</div>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Exact algorithm</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.5">The brute-force algorithm to retrieve the exact top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_K</annotation></semantics></math> with <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.5.1">MoL</span> is to evaluate <math alttext="\phi(q,x)" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.2"><semantics id="S3.SS1.p1.2.m2.2a"><mrow id="S3.SS1.p1.2.m2.2.3" xref="S3.SS1.p1.2.m2.2.3.cmml"><mi id="S3.SS1.p1.2.m2.2.3.2" xref="S3.SS1.p1.2.m2.2.3.2.cmml">ϕ</mi><mo id="S3.SS1.p1.2.m2.2.3.1" xref="S3.SS1.p1.2.m2.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.2.m2.2.3.3.2" xref="S3.SS1.p1.2.m2.2.3.3.1.cmml"><mo id="S3.SS1.p1.2.m2.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.2.m2.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">q</mi><mo id="S3.SS1.p1.2.m2.2.3.3.2.2" xref="S3.SS1.p1.2.m2.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml">x</mi><mo id="S3.SS1.p1.2.m2.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.2b"><apply id="S3.SS1.p1.2.m2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.3"><times id="S3.SS1.p1.2.m2.2.3.1.cmml" xref="S3.SS1.p1.2.m2.2.3.1"></times><ci id="S3.SS1.p1.2.m2.2.3.2.cmml" xref="S3.SS1.p1.2.m2.2.3.2">italic-ϕ</ci><interval closure="open" id="S3.SS1.p1.2.m2.2.3.3.1.cmml" xref="S3.SS1.p1.2.m2.2.3.3.2"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑞</ci><ci id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.2c">\phi(q,x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.2d">italic_ϕ ( italic_q , italic_x )</annotation></semantics></math> for each query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_q</annotation></semantics></math> and item <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_x</annotation></semantics></math>. This algorithm can be prohibitively expensive if the number of items is large. Instead, we describe a more efficient two-pass algorithm to retrieve the exact top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_K</annotation></semantics></math> items as shown in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#alg1" title="Algorithm 1 ‣ 3.1 Exact algorithm ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.7.1.1">Algorithm 1</span> </span> Exact top <math alttext="K" class="ltx_Math" display="inline" id="alg1.2.m1.1"><semantics id="alg1.2.m1.1b"><mi id="alg1.2.m1.1.1" xref="alg1.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m1.1c"><ci id="alg1.2.m1.1.1.cmml" xref="alg1.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="alg1.2.m1.1e">italic_K</annotation></semantics></math> algorithm.</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.8">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text" id="alg1.l1.2" style="font-size:90%;">query </span><math alttext="q" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" mathsize="90%" xref="alg1.l1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_q</annotation></semantics></math><span class="ltx_text" id="alg1.l1.3" style="font-size:90%;">, a set of items </span><math alttext="X" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" mathsize="90%" xref="alg1.l1.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_X</annotation></semantics></math><span class="ltx_text" id="alg1.l1.4" style="font-size:90%;">, </span><math alttext="f_{p}(\cdot)" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.2" xref="alg1.l1.m3.1.2.cmml"><msub id="alg1.l1.m3.1.2.2" xref="alg1.l1.m3.1.2.2.cmml"><mi id="alg1.l1.m3.1.2.2.2" mathsize="90%" xref="alg1.l1.m3.1.2.2.2.cmml">f</mi><mi id="alg1.l1.m3.1.2.2.3" mathsize="90%" xref="alg1.l1.m3.1.2.2.3.cmml">p</mi></msub><mo id="alg1.l1.m3.1.2.1" xref="alg1.l1.m3.1.2.1.cmml">⁢</mo><mrow id="alg1.l1.m3.1.2.3.2" xref="alg1.l1.m3.1.2.cmml"><mo id="alg1.l1.m3.1.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l1.m3.1.2.cmml">(</mo><mo id="alg1.l1.m3.1.1" lspace="0em" mathsize="90%" rspace="0em" xref="alg1.l1.m3.1.1.cmml">⋅</mo><mo id="alg1.l1.m3.1.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l1.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.2.cmml" xref="alg1.l1.m3.1.2"><times id="alg1.l1.m3.1.2.1.cmml" xref="alg1.l1.m3.1.2.1"></times><apply id="alg1.l1.m3.1.2.2.cmml" xref="alg1.l1.m3.1.2.2"><csymbol cd="ambiguous" id="alg1.l1.m3.1.2.2.1.cmml" xref="alg1.l1.m3.1.2.2">subscript</csymbol><ci id="alg1.l1.m3.1.2.2.2.cmml" xref="alg1.l1.m3.1.2.2.2">𝑓</ci><ci id="alg1.l1.m3.1.2.2.3.cmml" xref="alg1.l1.m3.1.2.2.3">𝑝</ci></apply><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">f_{p}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math><span class="ltx_text" id="alg1.l1.5" style="font-size:90%;">, </span><math alttext="g_{p}(\cdot)" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><mrow id="alg1.l1.m4.1.2" xref="alg1.l1.m4.1.2.cmml"><msub id="alg1.l1.m4.1.2.2" xref="alg1.l1.m4.1.2.2.cmml"><mi id="alg1.l1.m4.1.2.2.2" mathsize="90%" xref="alg1.l1.m4.1.2.2.2.cmml">g</mi><mi id="alg1.l1.m4.1.2.2.3" mathsize="90%" xref="alg1.l1.m4.1.2.2.3.cmml">p</mi></msub><mo id="alg1.l1.m4.1.2.1" xref="alg1.l1.m4.1.2.1.cmml">⁢</mo><mrow id="alg1.l1.m4.1.2.3.2" xref="alg1.l1.m4.1.2.cmml"><mo id="alg1.l1.m4.1.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l1.m4.1.2.cmml">(</mo><mo id="alg1.l1.m4.1.1" lspace="0em" mathsize="90%" rspace="0em" xref="alg1.l1.m4.1.1.cmml">⋅</mo><mo id="alg1.l1.m4.1.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l1.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.2.cmml" xref="alg1.l1.m4.1.2"><times id="alg1.l1.m4.1.2.1.cmml" xref="alg1.l1.m4.1.2.1"></times><apply id="alg1.l1.m4.1.2.2.cmml" xref="alg1.l1.m4.1.2.2"><csymbol cd="ambiguous" id="alg1.l1.m4.1.2.2.1.cmml" xref="alg1.l1.m4.1.2.2">subscript</csymbol><ci id="alg1.l1.m4.1.2.2.2.cmml" xref="alg1.l1.m4.1.2.2.2">𝑔</ci><ci id="alg1.l1.m4.1.2.2.3.cmml" xref="alg1.l1.m4.1.2.2.3">𝑝</ci></apply><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">g_{p}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math><span class="ltx_text" id="alg1.l1.6" style="font-size:90%;"> for constructing the component-level embeddings </span><math alttext="f_{p}(q),g_{p}(x)" class="ltx_Math" display="inline" id="alg1.l1.m5.4"><semantics id="alg1.l1.m5.4a"><mrow id="alg1.l1.m5.4.4.2" xref="alg1.l1.m5.4.4.3.cmml"><mrow id="alg1.l1.m5.3.3.1.1" xref="alg1.l1.m5.3.3.1.1.cmml"><msub id="alg1.l1.m5.3.3.1.1.2" xref="alg1.l1.m5.3.3.1.1.2.cmml"><mi id="alg1.l1.m5.3.3.1.1.2.2" mathsize="90%" xref="alg1.l1.m5.3.3.1.1.2.2.cmml">f</mi><mi id="alg1.l1.m5.3.3.1.1.2.3" mathsize="90%" xref="alg1.l1.m5.3.3.1.1.2.3.cmml">p</mi></msub><mo id="alg1.l1.m5.3.3.1.1.1" xref="alg1.l1.m5.3.3.1.1.1.cmml">⁢</mo><mrow id="alg1.l1.m5.3.3.1.1.3.2" xref="alg1.l1.m5.3.3.1.1.cmml"><mo id="alg1.l1.m5.3.3.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l1.m5.3.3.1.1.cmml">(</mo><mi id="alg1.l1.m5.1.1" mathsize="90%" xref="alg1.l1.m5.1.1.cmml">q</mi><mo id="alg1.l1.m5.3.3.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l1.m5.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l1.m5.4.4.2.3" mathsize="90%" xref="alg1.l1.m5.4.4.3.cmml">,</mo><mrow id="alg1.l1.m5.4.4.2.2" xref="alg1.l1.m5.4.4.2.2.cmml"><msub id="alg1.l1.m5.4.4.2.2.2" xref="alg1.l1.m5.4.4.2.2.2.cmml"><mi id="alg1.l1.m5.4.4.2.2.2.2" mathsize="90%" xref="alg1.l1.m5.4.4.2.2.2.2.cmml">g</mi><mi id="alg1.l1.m5.4.4.2.2.2.3" mathsize="90%" xref="alg1.l1.m5.4.4.2.2.2.3.cmml">p</mi></msub><mo id="alg1.l1.m5.4.4.2.2.1" xref="alg1.l1.m5.4.4.2.2.1.cmml">⁢</mo><mrow id="alg1.l1.m5.4.4.2.2.3.2" xref="alg1.l1.m5.4.4.2.2.cmml"><mo id="alg1.l1.m5.4.4.2.2.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l1.m5.4.4.2.2.cmml">(</mo><mi id="alg1.l1.m5.2.2" mathsize="90%" xref="alg1.l1.m5.2.2.cmml">x</mi><mo id="alg1.l1.m5.4.4.2.2.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l1.m5.4.4.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.4b"><list id="alg1.l1.m5.4.4.3.cmml" xref="alg1.l1.m5.4.4.2"><apply id="alg1.l1.m5.3.3.1.1.cmml" xref="alg1.l1.m5.3.3.1.1"><times id="alg1.l1.m5.3.3.1.1.1.cmml" xref="alg1.l1.m5.3.3.1.1.1"></times><apply id="alg1.l1.m5.3.3.1.1.2.cmml" xref="alg1.l1.m5.3.3.1.1.2"><csymbol cd="ambiguous" id="alg1.l1.m5.3.3.1.1.2.1.cmml" xref="alg1.l1.m5.3.3.1.1.2">subscript</csymbol><ci id="alg1.l1.m5.3.3.1.1.2.2.cmml" xref="alg1.l1.m5.3.3.1.1.2.2">𝑓</ci><ci id="alg1.l1.m5.3.3.1.1.2.3.cmml" xref="alg1.l1.m5.3.3.1.1.2.3">𝑝</ci></apply><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝑞</ci></apply><apply id="alg1.l1.m5.4.4.2.2.cmml" xref="alg1.l1.m5.4.4.2.2"><times id="alg1.l1.m5.4.4.2.2.1.cmml" xref="alg1.l1.m5.4.4.2.2.1"></times><apply id="alg1.l1.m5.4.4.2.2.2.cmml" xref="alg1.l1.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m5.4.4.2.2.2.1.cmml" xref="alg1.l1.m5.4.4.2.2.2">subscript</csymbol><ci id="alg1.l1.m5.4.4.2.2.2.2.cmml" xref="alg1.l1.m5.4.4.2.2.2.2">𝑔</ci><ci id="alg1.l1.m5.4.4.2.2.2.3.cmml" xref="alg1.l1.m5.4.4.2.2.2.3">𝑝</ci></apply><ci id="alg1.l1.m5.2.2.cmml" xref="alg1.l1.m5.2.2">𝑥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.4c">f_{p}(q),g_{p}(x)</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m5.4d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math><span class="ltx_text" id="alg1.l1.7" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text" id="alg1.l2.2" style="font-size:90%;">exact top </span><math alttext="K" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" mathsize="90%" xref="alg1.l2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_K</annotation></semantics></math><span class="ltx_text" id="alg1.l2.3" style="font-size:90%;"> items
</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><math alttext="G\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" mathsize="90%" xref="alg1.l3.m1.1.1.2.cmml">G</mi><mo id="alg1.l3.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l3.m1.1.1.1.cmml">←</mo><mi id="alg1.l3.m1.1.1.3" mathsize="90%" mathvariant="normal" xref="alg1.l3.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝐺</ci><emptyset id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">G\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_G ← ∅</annotation></semantics></math><span class="ltx_text" id="alg1.l3.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l4.2" style="font-size:90%;">for</span><span class="ltx_text" id="alg1.l4.3" style="font-size:90%;"> </span><math alttext="p\in P" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" mathsize="90%" xref="alg1.l4.m1.1.1.2.cmml">p</mi><mo id="alg1.l4.m1.1.1.1" mathsize="90%" xref="alg1.l4.m1.1.1.1.cmml">∈</mo><mi id="alg1.l4.m1.1.1.3" mathsize="90%" xref="alg1.l4.m1.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><in id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></in><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑝</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">p\in P</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_p ∈ italic_P</annotation></semantics></math><span class="ltx_text" id="alg1.l4.4" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l4.5" style="font-size:90%;">do</span><span class="ltx_text" id="alg1.l4.6" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.2.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text" id="alg1.l5.3" style="font-size:90%;">    </span><math alttext="X_{p}\leftarrow\{g_{p}(x),x\in X\}" class="ltx_Math" display="inline" id="alg1.l5.m1.3"><semantics id="alg1.l5.m1.3a"><mrow id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml"><msub id="alg1.l5.m1.3.3.3" xref="alg1.l5.m1.3.3.3.cmml"><mi id="alg1.l5.m1.3.3.3.2" mathsize="90%" xref="alg1.l5.m1.3.3.3.2.cmml">X</mi><mi id="alg1.l5.m1.3.3.3.3" mathsize="90%" xref="alg1.l5.m1.3.3.3.3.cmml">p</mi></msub><mo id="alg1.l5.m1.3.3.2" mathsize="90%" stretchy="false" xref="alg1.l5.m1.3.3.2.cmml">←</mo><mrow id="alg1.l5.m1.3.3.1.1" xref="alg1.l5.m1.3.3.1.2.cmml"><mo id="alg1.l5.m1.3.3.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l5.m1.3.3.1.2.cmml">{</mo><mrow id="alg1.l5.m1.3.3.1.1.1" xref="alg1.l5.m1.3.3.1.1.1.cmml"><mrow id="alg1.l5.m1.3.3.1.1.1.1.1" xref="alg1.l5.m1.3.3.1.1.1.1.2.cmml"><mrow id="alg1.l5.m1.3.3.1.1.1.1.1.1" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.cmml"><msub id="alg1.l5.m1.3.3.1.1.1.1.1.1.2" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="alg1.l5.m1.3.3.1.1.1.1.1.1.2.2" mathsize="90%" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="alg1.l5.m1.3.3.1.1.1.1.1.1.2.3" mathsize="90%" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="alg1.l5.m1.3.3.1.1.1.1.1.1.1" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l5.m1.3.3.1.1.1.1.1.1.3.2" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.cmml"><mo id="alg1.l5.m1.3.3.1.1.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="alg1.l5.m1.1.1" mathsize="90%" xref="alg1.l5.m1.1.1.cmml">x</mi><mo id="alg1.l5.m1.3.3.1.1.1.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l5.m1.3.3.1.1.1.1.1.2" mathsize="90%" xref="alg1.l5.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="alg1.l5.m1.2.2" mathsize="90%" xref="alg1.l5.m1.2.2.cmml">x</mi></mrow><mo id="alg1.l5.m1.3.3.1.1.1.2" mathsize="90%" xref="alg1.l5.m1.3.3.1.1.1.2.cmml">∈</mo><mi id="alg1.l5.m1.3.3.1.1.1.3" mathsize="90%" xref="alg1.l5.m1.3.3.1.1.1.3.cmml">X</mi></mrow><mo id="alg1.l5.m1.3.3.1.1.3" maxsize="90%" minsize="90%" xref="alg1.l5.m1.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.3b"><apply id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3"><ci id="alg1.l5.m1.3.3.2.cmml" xref="alg1.l5.m1.3.3.2">←</ci><apply id="alg1.l5.m1.3.3.3.cmml" xref="alg1.l5.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.3.1.cmml" xref="alg1.l5.m1.3.3.3">subscript</csymbol><ci id="alg1.l5.m1.3.3.3.2.cmml" xref="alg1.l5.m1.3.3.3.2">𝑋</ci><ci id="alg1.l5.m1.3.3.3.3.cmml" xref="alg1.l5.m1.3.3.3.3">𝑝</ci></apply><set id="alg1.l5.m1.3.3.1.2.cmml" xref="alg1.l5.m1.3.3.1.1"><apply id="alg1.l5.m1.3.3.1.1.1.cmml" xref="alg1.l5.m1.3.3.1.1.1"><in id="alg1.l5.m1.3.3.1.1.1.2.cmml" xref="alg1.l5.m1.3.3.1.1.1.2"></in><list id="alg1.l5.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1"><apply id="alg1.l5.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.1"><times id="alg1.l5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.1"></times><apply id="alg1.l5.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.2.2">𝑔</ci><ci id="alg1.l5.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑥</ci></apply><ci id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">𝑥</ci></list><ci id="alg1.l5.m1.3.3.1.1.1.3.cmml" xref="alg1.l5.m1.3.3.1.1.1.3">𝑋</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.3c">X_{p}\leftarrow\{g_{p}(x),x\in X\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.3d">italic_X start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ← { italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) , italic_x ∈ italic_X }</annotation></semantics></math><span class="ltx_text" id="alg1.l5.4" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l5.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l5.1.m1.1"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.1.m1.1d">▷</annotation></semantics></math> Can be preprocessed and materialized.
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.3.1.1" style="font-size:80%;">6:</span></span><span class="ltx_text" id="alg1.l6.4" style="font-size:90%;">    </span><math alttext="G\leftarrow G\cup TopKDotProduct(f_{p}(q),X_{p})" class="ltx_Math" display="inline" id="alg1.l6.m1.3"><semantics id="alg1.l6.m1.3a"><mrow id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml"><mi id="alg1.l6.m1.3.3.4" mathsize="90%" xref="alg1.l6.m1.3.3.4.cmml">G</mi><mo id="alg1.l6.m1.3.3.3" mathsize="90%" stretchy="false" xref="alg1.l6.m1.3.3.3.cmml">←</mo><mrow id="alg1.l6.m1.3.3.2" xref="alg1.l6.m1.3.3.2.cmml"><mi id="alg1.l6.m1.3.3.2.4" mathsize="90%" xref="alg1.l6.m1.3.3.2.4.cmml">G</mi><mo id="alg1.l6.m1.3.3.2.3" mathsize="90%" xref="alg1.l6.m1.3.3.2.3.cmml">∪</mo><mrow id="alg1.l6.m1.3.3.2.2" xref="alg1.l6.m1.3.3.2.2.cmml"><mi id="alg1.l6.m1.3.3.2.2.4" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.4.cmml">T</mi><mo id="alg1.l6.m1.3.3.2.2.3" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.5" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.5.cmml">o</mi><mo id="alg1.l6.m1.3.3.2.2.3a" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.6" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.6.cmml">p</mi><mo id="alg1.l6.m1.3.3.2.2.3b" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.7" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.7.cmml">K</mi><mo id="alg1.l6.m1.3.3.2.2.3c" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.8" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.8.cmml">D</mi><mo id="alg1.l6.m1.3.3.2.2.3d" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.9" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.9.cmml">o</mi><mo id="alg1.l6.m1.3.3.2.2.3e" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.10" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.10.cmml">t</mi><mo id="alg1.l6.m1.3.3.2.2.3f" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.11" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.11.cmml">P</mi><mo id="alg1.l6.m1.3.3.2.2.3g" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.12" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.12.cmml">r</mi><mo id="alg1.l6.m1.3.3.2.2.3h" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.13" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.13.cmml">o</mi><mo id="alg1.l6.m1.3.3.2.2.3i" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.14" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.14.cmml">d</mi><mo id="alg1.l6.m1.3.3.2.2.3j" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.15" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.15.cmml">u</mi><mo id="alg1.l6.m1.3.3.2.2.3k" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.16" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.16.cmml">c</mi><mo id="alg1.l6.m1.3.3.2.2.3l" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.3.3.2.2.17" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.17.cmml">t</mi><mo id="alg1.l6.m1.3.3.2.2.3m" xref="alg1.l6.m1.3.3.2.2.3.cmml">⁢</mo><mrow id="alg1.l6.m1.3.3.2.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.3.cmml"><mo id="alg1.l6.m1.3.3.2.2.2.2.3" maxsize="90%" minsize="90%" xref="alg1.l6.m1.3.3.2.2.2.3.cmml">(</mo><mrow id="alg1.l6.m1.2.2.1.1.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.1.cmml"><msub id="alg1.l6.m1.2.2.1.1.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.1.1.1.2.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.1.1.2.2" mathsize="90%" xref="alg1.l6.m1.2.2.1.1.1.1.1.2.2.cmml">f</mi><mi id="alg1.l6.m1.2.2.1.1.1.1.1.2.3" mathsize="90%" xref="alg1.l6.m1.2.2.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="alg1.l6.m1.2.2.1.1.1.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l6.m1.2.2.1.1.1.1.1.3.2" xref="alg1.l6.m1.2.2.1.1.1.1.1.cmml"><mo id="alg1.l6.m1.2.2.1.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l6.m1.2.2.1.1.1.1.1.cmml">(</mo><mi id="alg1.l6.m1.1.1" mathsize="90%" xref="alg1.l6.m1.1.1.cmml">q</mi><mo id="alg1.l6.m1.2.2.1.1.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l6.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l6.m1.3.3.2.2.2.2.4" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.2.3.cmml">,</mo><msub id="alg1.l6.m1.3.3.2.2.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.2.2.cmml"><mi id="alg1.l6.m1.3.3.2.2.2.2.2.2" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.2.2.2.2.cmml">X</mi><mi id="alg1.l6.m1.3.3.2.2.2.2.2.3" mathsize="90%" xref="alg1.l6.m1.3.3.2.2.2.2.2.3.cmml">p</mi></msub><mo id="alg1.l6.m1.3.3.2.2.2.2.5" maxsize="90%" minsize="90%" xref="alg1.l6.m1.3.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.3b"><apply id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3"><ci id="alg1.l6.m1.3.3.3.cmml" xref="alg1.l6.m1.3.3.3">←</ci><ci id="alg1.l6.m1.3.3.4.cmml" xref="alg1.l6.m1.3.3.4">𝐺</ci><apply id="alg1.l6.m1.3.3.2.cmml" xref="alg1.l6.m1.3.3.2"><union id="alg1.l6.m1.3.3.2.3.cmml" xref="alg1.l6.m1.3.3.2.3"></union><ci id="alg1.l6.m1.3.3.2.4.cmml" xref="alg1.l6.m1.3.3.2.4">𝐺</ci><apply id="alg1.l6.m1.3.3.2.2.cmml" xref="alg1.l6.m1.3.3.2.2"><times id="alg1.l6.m1.3.3.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.3"></times><ci id="alg1.l6.m1.3.3.2.2.4.cmml" xref="alg1.l6.m1.3.3.2.2.4">𝑇</ci><ci id="alg1.l6.m1.3.3.2.2.5.cmml" xref="alg1.l6.m1.3.3.2.2.5">𝑜</ci><ci id="alg1.l6.m1.3.3.2.2.6.cmml" xref="alg1.l6.m1.3.3.2.2.6">𝑝</ci><ci id="alg1.l6.m1.3.3.2.2.7.cmml" xref="alg1.l6.m1.3.3.2.2.7">𝐾</ci><ci id="alg1.l6.m1.3.3.2.2.8.cmml" xref="alg1.l6.m1.3.3.2.2.8">𝐷</ci><ci id="alg1.l6.m1.3.3.2.2.9.cmml" xref="alg1.l6.m1.3.3.2.2.9">𝑜</ci><ci id="alg1.l6.m1.3.3.2.2.10.cmml" xref="alg1.l6.m1.3.3.2.2.10">𝑡</ci><ci id="alg1.l6.m1.3.3.2.2.11.cmml" xref="alg1.l6.m1.3.3.2.2.11">𝑃</ci><ci id="alg1.l6.m1.3.3.2.2.12.cmml" xref="alg1.l6.m1.3.3.2.2.12">𝑟</ci><ci id="alg1.l6.m1.3.3.2.2.13.cmml" xref="alg1.l6.m1.3.3.2.2.13">𝑜</ci><ci id="alg1.l6.m1.3.3.2.2.14.cmml" xref="alg1.l6.m1.3.3.2.2.14">𝑑</ci><ci id="alg1.l6.m1.3.3.2.2.15.cmml" xref="alg1.l6.m1.3.3.2.2.15">𝑢</ci><ci id="alg1.l6.m1.3.3.2.2.16.cmml" xref="alg1.l6.m1.3.3.2.2.16">𝑐</ci><ci id="alg1.l6.m1.3.3.2.2.17.cmml" xref="alg1.l6.m1.3.3.2.2.17">𝑡</ci><interval closure="open" id="alg1.l6.m1.3.3.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.2.2"><apply id="alg1.l6.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1"><times id="alg1.l6.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1.1"></times><apply id="alg1.l6.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.2.2.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1.2.2">𝑓</ci><ci id="alg1.l6.m1.2.2.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑞</ci></apply><apply id="alg1.l6.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.3.3.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.2.2">𝑋</ci><ci id="alg1.l6.m1.3.3.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.2.3">𝑝</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.3c">G\leftarrow G\cup TopKDotProduct(f_{p}(q),X_{p})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.3d">italic_G ← italic_G ∪ italic_T italic_o italic_p italic_K italic_D italic_o italic_t italic_P italic_r italic_o italic_d italic_u italic_c italic_t ( italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_X start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l6.5" style="font-size:90%;"> </span><span class="ltx_text" id="alg1.l6.2" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.m1.1"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.m1.1d">▷</annotation></semantics></math> Retrieve top <math alttext="K" class="ltx_Math" display="inline" id="alg1.l6.2.m2.1"><semantics id="alg1.l6.2.m2.1a"><mi id="alg1.l6.2.m2.1.1" xref="alg1.l6.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.2.m2.1b"><ci id="alg1.l6.2.m2.1.1.cmml" xref="alg1.l6.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.2.m2.1d">italic_K</annotation></semantics></math> items for each pair of embeddings
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span><math alttext="S_{min}\leftarrow\infty" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msub id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2" mathsize="90%" xref="alg1.l7.m1.1.1.2.2.cmml">S</mi><mrow id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml"><mi id="alg1.l7.m1.1.1.2.3.2" mathsize="90%" xref="alg1.l7.m1.1.1.2.3.2.cmml">m</mi><mo id="alg1.l7.m1.1.1.2.3.1" xref="alg1.l7.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.2.3.3" mathsize="90%" xref="alg1.l7.m1.1.1.2.3.3.cmml">i</mi><mo id="alg1.l7.m1.1.1.2.3.1a" xref="alg1.l7.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.2.3.4" mathsize="90%" xref="alg1.l7.m1.1.1.2.3.4.cmml">n</mi></mrow></msub><mo id="alg1.l7.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mi id="alg1.l7.m1.1.1.3" mathsize="90%" mathvariant="normal" xref="alg1.l7.m1.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝑆</ci><apply id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3"><times id="alg1.l7.m1.1.1.2.3.1.cmml" xref="alg1.l7.m1.1.1.2.3.1"></times><ci id="alg1.l7.m1.1.1.2.3.2.cmml" xref="alg1.l7.m1.1.1.2.3.2">𝑚</ci><ci id="alg1.l7.m1.1.1.2.3.3.cmml" xref="alg1.l7.m1.1.1.2.3.3">𝑖</ci><ci id="alg1.l7.m1.1.1.2.3.4.cmml" xref="alg1.l7.m1.1.1.2.3.4">𝑛</ci></apply></apply><infinity id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">S_{min}\leftarrow\infty</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT ← ∞</annotation></semantics></math><span class="ltx_text" id="alg1.l7.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l8.2" style="font-size:90%;">for</span><span class="ltx_text" id="alg1.l8.3" style="font-size:90%;"> </span><math alttext="x\in G" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" mathsize="90%" xref="alg1.l8.m1.1.1.2.cmml">x</mi><mo id="alg1.l8.m1.1.1.1" mathsize="90%" xref="alg1.l8.m1.1.1.1.cmml">∈</mo><mi id="alg1.l8.m1.1.1.3" mathsize="90%" xref="alg1.l8.m1.1.1.3.cmml">G</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><in id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></in><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑥</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">x\in G</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_x ∈ italic_G</annotation></semantics></math><span class="ltx_text" id="alg1.l8.4" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l8.5" style="font-size:90%;">do</span><span class="ltx_text" id="alg1.l8.6" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text" id="alg1.l9.2" style="font-size:90%;">    </span><math alttext="s\leftarrow MoL(q,x)" class="ltx_Math" display="inline" id="alg1.l9.m1.2"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.3" xref="alg1.l9.m1.2.3.cmml"><mi id="alg1.l9.m1.2.3.2" mathsize="90%" xref="alg1.l9.m1.2.3.2.cmml">s</mi><mo id="alg1.l9.m1.2.3.1" mathsize="90%" stretchy="false" xref="alg1.l9.m1.2.3.1.cmml">←</mo><mrow id="alg1.l9.m1.2.3.3" xref="alg1.l9.m1.2.3.3.cmml"><mi id="alg1.l9.m1.2.3.3.2" mathsize="90%" xref="alg1.l9.m1.2.3.3.2.cmml">M</mi><mo id="alg1.l9.m1.2.3.3.1" xref="alg1.l9.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.2.3.3.3" mathsize="90%" xref="alg1.l9.m1.2.3.3.3.cmml">o</mi><mo id="alg1.l9.m1.2.3.3.1a" xref="alg1.l9.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.2.3.3.4" mathsize="90%" xref="alg1.l9.m1.2.3.3.4.cmml">L</mi><mo id="alg1.l9.m1.2.3.3.1b" xref="alg1.l9.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l9.m1.2.3.3.5.2" xref="alg1.l9.m1.2.3.3.5.1.cmml"><mo id="alg1.l9.m1.2.3.3.5.2.1" maxsize="90%" minsize="90%" xref="alg1.l9.m1.2.3.3.5.1.cmml">(</mo><mi id="alg1.l9.m1.1.1" mathsize="90%" xref="alg1.l9.m1.1.1.cmml">q</mi><mo id="alg1.l9.m1.2.3.3.5.2.2" mathsize="90%" xref="alg1.l9.m1.2.3.3.5.1.cmml">,</mo><mi id="alg1.l9.m1.2.2" mathsize="90%" xref="alg1.l9.m1.2.2.cmml">x</mi><mo id="alg1.l9.m1.2.3.3.5.2.3" maxsize="90%" minsize="90%" xref="alg1.l9.m1.2.3.3.5.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.3.cmml" xref="alg1.l9.m1.2.3"><ci id="alg1.l9.m1.2.3.1.cmml" xref="alg1.l9.m1.2.3.1">←</ci><ci id="alg1.l9.m1.2.3.2.cmml" xref="alg1.l9.m1.2.3.2">𝑠</ci><apply id="alg1.l9.m1.2.3.3.cmml" xref="alg1.l9.m1.2.3.3"><times id="alg1.l9.m1.2.3.3.1.cmml" xref="alg1.l9.m1.2.3.3.1"></times><ci id="alg1.l9.m1.2.3.3.2.cmml" xref="alg1.l9.m1.2.3.3.2">𝑀</ci><ci id="alg1.l9.m1.2.3.3.3.cmml" xref="alg1.l9.m1.2.3.3.3">𝑜</ci><ci id="alg1.l9.m1.2.3.3.4.cmml" xref="alg1.l9.m1.2.3.3.4">𝐿</ci><interval closure="open" id="alg1.l9.m1.2.3.3.5.1.cmml" xref="alg1.l9.m1.2.3.3.5.2"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝑞</ci><ci id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2">𝑥</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">s\leftarrow MoL(q,x)</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.2d">italic_s ← italic_M italic_o italic_L ( italic_q , italic_x )</annotation></semantics></math><span class="ltx_text" id="alg1.l9.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span><span class="ltx_text" id="alg1.l10.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg1.l10.3" style="font-size:90%;">if</span><span class="ltx_text" id="alg1.l10.4" style="font-size:90%;"> </span><math alttext="s&lt;S_{min}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" mathsize="90%" xref="alg1.l10.m1.1.1.2.cmml">s</mi><mo id="alg1.l10.m1.1.1.1" mathsize="90%" xref="alg1.l10.m1.1.1.1.cmml">&lt;</mo><msub id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" mathsize="90%" xref="alg1.l10.m1.1.1.3.2.cmml">S</mi><mrow id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml"><mi id="alg1.l10.m1.1.1.3.3.2" mathsize="90%" xref="alg1.l10.m1.1.1.3.3.2.cmml">m</mi><mo id="alg1.l10.m1.1.1.3.3.1" xref="alg1.l10.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.3.3" mathsize="90%" xref="alg1.l10.m1.1.1.3.3.3.cmml">i</mi><mo id="alg1.l10.m1.1.1.3.3.1a" xref="alg1.l10.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.3.3.4" mathsize="90%" xref="alg1.l10.m1.1.1.3.3.4.cmml">n</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><lt id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></lt><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑠</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑆</ci><apply id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3"><times id="alg1.l10.m1.1.1.3.3.1.cmml" xref="alg1.l10.m1.1.1.3.3.1"></times><ci id="alg1.l10.m1.1.1.3.3.2.cmml" xref="alg1.l10.m1.1.1.3.3.2">𝑚</ci><ci id="alg1.l10.m1.1.1.3.3.3.cmml" xref="alg1.l10.m1.1.1.3.3.3">𝑖</ci><ci id="alg1.l10.m1.1.1.3.3.4.cmml" xref="alg1.l10.m1.1.1.3.3.4">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">s&lt;S_{min}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_s &lt; italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.l10.5" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l10.6" style="font-size:90%;">then</span><span class="ltx_text" id="alg1.l10.7" style="font-size:90%;"> </span><math alttext="S_{min}\leftarrow s" class="ltx_Math" display="inline" id="alg1.l10.m2.1"><semantics id="alg1.l10.m2.1a"><mrow id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><msub id="alg1.l10.m2.1.1.2" xref="alg1.l10.m2.1.1.2.cmml"><mi id="alg1.l10.m2.1.1.2.2" mathsize="90%" xref="alg1.l10.m2.1.1.2.2.cmml">S</mi><mrow id="alg1.l10.m2.1.1.2.3" xref="alg1.l10.m2.1.1.2.3.cmml"><mi id="alg1.l10.m2.1.1.2.3.2" mathsize="90%" xref="alg1.l10.m2.1.1.2.3.2.cmml">m</mi><mo id="alg1.l10.m2.1.1.2.3.1" xref="alg1.l10.m2.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m2.1.1.2.3.3" mathsize="90%" xref="alg1.l10.m2.1.1.2.3.3.cmml">i</mi><mo id="alg1.l10.m2.1.1.2.3.1a" xref="alg1.l10.m2.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m2.1.1.2.3.4" mathsize="90%" xref="alg1.l10.m2.1.1.2.3.4.cmml">n</mi></mrow></msub><mo id="alg1.l10.m2.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l10.m2.1.1.1.cmml">←</mo><mi id="alg1.l10.m2.1.1.3" mathsize="90%" xref="alg1.l10.m2.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><ci id="alg1.l10.m2.1.1.1.cmml" xref="alg1.l10.m2.1.1.1">←</ci><apply id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.2.1.cmml" xref="alg1.l10.m2.1.1.2">subscript</csymbol><ci id="alg1.l10.m2.1.1.2.2.cmml" xref="alg1.l10.m2.1.1.2.2">𝑆</ci><apply id="alg1.l10.m2.1.1.2.3.cmml" xref="alg1.l10.m2.1.1.2.3"><times id="alg1.l10.m2.1.1.2.3.1.cmml" xref="alg1.l10.m2.1.1.2.3.1"></times><ci id="alg1.l10.m2.1.1.2.3.2.cmml" xref="alg1.l10.m2.1.1.2.3.2">𝑚</ci><ci id="alg1.l10.m2.1.1.2.3.3.cmml" xref="alg1.l10.m2.1.1.2.3.3">𝑖</ci><ci id="alg1.l10.m2.1.1.2.3.4.cmml" xref="alg1.l10.m2.1.1.2.3.4">𝑛</ci></apply></apply><ci id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">S_{min}\leftarrow s</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m2.1d">italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT ← italic_s</annotation></semantics></math><span class="ltx_text" id="alg1.l10.8" style="font-size:90%;">
    </span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span><math alttext="G^{\prime}\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><msup id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml"><mi id="alg1.l11.m1.1.1.2.2" mathsize="90%" xref="alg1.l11.m1.1.1.2.2.cmml">G</mi><mo id="alg1.l11.m1.1.1.2.3" mathsize="90%" xref="alg1.l11.m1.1.1.2.3.cmml">′</mo></msup><mo id="alg1.l11.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.l11.m1.1.1.1.cmml">←</mo><mi id="alg1.l11.m1.1.1.3" mathsize="90%" mathvariant="normal" xref="alg1.l11.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">←</ci><apply id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.2">superscript</csymbol><ci id="alg1.l11.m1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.2.2">𝐺</ci><ci id="alg1.l11.m1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.2.3">′</ci></apply><emptyset id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">G^{\prime}\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← ∅</annotation></semantics></math><span class="ltx_text" id="alg1.l11.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l12.2" style="font-size:90%;">for</span><span class="ltx_text" id="alg1.l12.3" style="font-size:90%;"> </span><math alttext="p\in P" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" mathsize="90%" xref="alg1.l12.m1.1.1.2.cmml">p</mi><mo id="alg1.l12.m1.1.1.1" mathsize="90%" xref="alg1.l12.m1.1.1.1.cmml">∈</mo><mi id="alg1.l12.m1.1.1.3" mathsize="90%" xref="alg1.l12.m1.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><in id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"></in><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑝</ci><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">p\in P</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_p ∈ italic_P</annotation></semantics></math><span class="ltx_text" id="alg1.l12.4" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.l12.5" style="font-size:90%;">do</span><span class="ltx_text" id="alg1.l12.6" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.5.1.1" style="font-size:80%;">13:</span></span><span class="ltx_text" id="alg1.l13.6" style="font-size:90%;">    </span><math alttext="G^{\prime}\leftarrow G^{\prime}\cup RangeDotProduct(f_{p}(q),S_{min},X_{p})" class="ltx_Math" display="inline" id="alg1.l13.m1.4"><semantics id="alg1.l13.m1.4a"><mrow id="alg1.l13.m1.4.4" xref="alg1.l13.m1.4.4.cmml"><msup id="alg1.l13.m1.4.4.5" xref="alg1.l13.m1.4.4.5.cmml"><mi id="alg1.l13.m1.4.4.5.2" mathsize="90%" xref="alg1.l13.m1.4.4.5.2.cmml">G</mi><mo id="alg1.l13.m1.4.4.5.3" mathsize="90%" xref="alg1.l13.m1.4.4.5.3.cmml">′</mo></msup><mo id="alg1.l13.m1.4.4.4" mathsize="90%" stretchy="false" xref="alg1.l13.m1.4.4.4.cmml">←</mo><mrow id="alg1.l13.m1.4.4.3" xref="alg1.l13.m1.4.4.3.cmml"><msup id="alg1.l13.m1.4.4.3.5" xref="alg1.l13.m1.4.4.3.5.cmml"><mi id="alg1.l13.m1.4.4.3.5.2" mathsize="90%" xref="alg1.l13.m1.4.4.3.5.2.cmml">G</mi><mo id="alg1.l13.m1.4.4.3.5.3" mathsize="90%" xref="alg1.l13.m1.4.4.3.5.3.cmml">′</mo></msup><mo id="alg1.l13.m1.4.4.3.4" mathsize="90%" xref="alg1.l13.m1.4.4.3.4.cmml">∪</mo><mrow id="alg1.l13.m1.4.4.3.3" xref="alg1.l13.m1.4.4.3.3.cmml"><mi id="alg1.l13.m1.4.4.3.3.5" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.5.cmml">R</mi><mo id="alg1.l13.m1.4.4.3.3.4" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.6" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.6.cmml">a</mi><mo id="alg1.l13.m1.4.4.3.3.4a" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.7" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.7.cmml">n</mi><mo id="alg1.l13.m1.4.4.3.3.4b" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.8" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.8.cmml">g</mi><mo id="alg1.l13.m1.4.4.3.3.4c" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.9" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.9.cmml">e</mi><mo id="alg1.l13.m1.4.4.3.3.4d" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.10" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.10.cmml">D</mi><mo id="alg1.l13.m1.4.4.3.3.4e" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.11" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.11.cmml">o</mi><mo id="alg1.l13.m1.4.4.3.3.4f" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.12" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.12.cmml">t</mi><mo id="alg1.l13.m1.4.4.3.3.4g" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.13" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.13.cmml">P</mi><mo id="alg1.l13.m1.4.4.3.3.4h" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.14" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.14.cmml">r</mi><mo id="alg1.l13.m1.4.4.3.3.4i" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.15" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.15.cmml">o</mi><mo id="alg1.l13.m1.4.4.3.3.4j" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.16" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.16.cmml">d</mi><mo id="alg1.l13.m1.4.4.3.3.4k" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.17" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.17.cmml">u</mi><mo id="alg1.l13.m1.4.4.3.3.4l" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.18" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.18.cmml">c</mi><mo id="alg1.l13.m1.4.4.3.3.4m" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mi id="alg1.l13.m1.4.4.3.3.19" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.19.cmml">t</mi><mo id="alg1.l13.m1.4.4.3.3.4n" xref="alg1.l13.m1.4.4.3.3.4.cmml">⁢</mo><mrow id="alg1.l13.m1.4.4.3.3.3.3" xref="alg1.l13.m1.4.4.3.3.3.4.cmml"><mo id="alg1.l13.m1.4.4.3.3.3.3.4" maxsize="90%" minsize="90%" xref="alg1.l13.m1.4.4.3.3.3.4.cmml">(</mo><mrow id="alg1.l13.m1.2.2.1.1.1.1.1" xref="alg1.l13.m1.2.2.1.1.1.1.1.cmml"><msub id="alg1.l13.m1.2.2.1.1.1.1.1.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.2.cmml"><mi id="alg1.l13.m1.2.2.1.1.1.1.1.2.2" mathsize="90%" xref="alg1.l13.m1.2.2.1.1.1.1.1.2.2.cmml">f</mi><mi id="alg1.l13.m1.2.2.1.1.1.1.1.2.3" mathsize="90%" xref="alg1.l13.m1.2.2.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="alg1.l13.m1.2.2.1.1.1.1.1.1" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l13.m1.2.2.1.1.1.1.1.3.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.cmml"><mo id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg1.l13.m1.2.2.1.1.1.1.1.cmml">(</mo><mi id="alg1.l13.m1.1.1" mathsize="90%" xref="alg1.l13.m1.1.1.cmml">q</mi><mo id="alg1.l13.m1.2.2.1.1.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg1.l13.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l13.m1.4.4.3.3.3.3.5" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.3.4.cmml">,</mo><msub id="alg1.l13.m1.3.3.2.2.2.2.2" xref="alg1.l13.m1.3.3.2.2.2.2.2.cmml"><mi id="alg1.l13.m1.3.3.2.2.2.2.2.2" mathsize="90%" xref="alg1.l13.m1.3.3.2.2.2.2.2.2.cmml">S</mi><mrow id="alg1.l13.m1.3.3.2.2.2.2.2.3" xref="alg1.l13.m1.3.3.2.2.2.2.2.3.cmml"><mi id="alg1.l13.m1.3.3.2.2.2.2.2.3.2" mathsize="90%" xref="alg1.l13.m1.3.3.2.2.2.2.2.3.2.cmml">m</mi><mo id="alg1.l13.m1.3.3.2.2.2.2.2.3.1" xref="alg1.l13.m1.3.3.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.3.3.2.2.2.2.2.3.3" mathsize="90%" xref="alg1.l13.m1.3.3.2.2.2.2.2.3.3.cmml">i</mi><mo id="alg1.l13.m1.3.3.2.2.2.2.2.3.1a" xref="alg1.l13.m1.3.3.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.3.3.2.2.2.2.2.3.4" mathsize="90%" xref="alg1.l13.m1.3.3.2.2.2.2.2.3.4.cmml">n</mi></mrow></msub><mo id="alg1.l13.m1.4.4.3.3.3.3.6" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.3.4.cmml">,</mo><msub id="alg1.l13.m1.4.4.3.3.3.3.3" xref="alg1.l13.m1.4.4.3.3.3.3.3.cmml"><mi id="alg1.l13.m1.4.4.3.3.3.3.3.2" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.3.3.3.2.cmml">X</mi><mi id="alg1.l13.m1.4.4.3.3.3.3.3.3" mathsize="90%" xref="alg1.l13.m1.4.4.3.3.3.3.3.3.cmml">p</mi></msub><mo id="alg1.l13.m1.4.4.3.3.3.3.7" maxsize="90%" minsize="90%" xref="alg1.l13.m1.4.4.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.4b"><apply id="alg1.l13.m1.4.4.cmml" xref="alg1.l13.m1.4.4"><ci id="alg1.l13.m1.4.4.4.cmml" xref="alg1.l13.m1.4.4.4">←</ci><apply id="alg1.l13.m1.4.4.5.cmml" xref="alg1.l13.m1.4.4.5"><csymbol cd="ambiguous" id="alg1.l13.m1.4.4.5.1.cmml" xref="alg1.l13.m1.4.4.5">superscript</csymbol><ci id="alg1.l13.m1.4.4.5.2.cmml" xref="alg1.l13.m1.4.4.5.2">𝐺</ci><ci id="alg1.l13.m1.4.4.5.3.cmml" xref="alg1.l13.m1.4.4.5.3">′</ci></apply><apply id="alg1.l13.m1.4.4.3.cmml" xref="alg1.l13.m1.4.4.3"><union id="alg1.l13.m1.4.4.3.4.cmml" xref="alg1.l13.m1.4.4.3.4"></union><apply id="alg1.l13.m1.4.4.3.5.cmml" xref="alg1.l13.m1.4.4.3.5"><csymbol cd="ambiguous" id="alg1.l13.m1.4.4.3.5.1.cmml" xref="alg1.l13.m1.4.4.3.5">superscript</csymbol><ci id="alg1.l13.m1.4.4.3.5.2.cmml" xref="alg1.l13.m1.4.4.3.5.2">𝐺</ci><ci id="alg1.l13.m1.4.4.3.5.3.cmml" xref="alg1.l13.m1.4.4.3.5.3">′</ci></apply><apply id="alg1.l13.m1.4.4.3.3.cmml" xref="alg1.l13.m1.4.4.3.3"><times id="alg1.l13.m1.4.4.3.3.4.cmml" xref="alg1.l13.m1.4.4.3.3.4"></times><ci id="alg1.l13.m1.4.4.3.3.5.cmml" xref="alg1.l13.m1.4.4.3.3.5">𝑅</ci><ci id="alg1.l13.m1.4.4.3.3.6.cmml" xref="alg1.l13.m1.4.4.3.3.6">𝑎</ci><ci id="alg1.l13.m1.4.4.3.3.7.cmml" xref="alg1.l13.m1.4.4.3.3.7">𝑛</ci><ci id="alg1.l13.m1.4.4.3.3.8.cmml" xref="alg1.l13.m1.4.4.3.3.8">𝑔</ci><ci id="alg1.l13.m1.4.4.3.3.9.cmml" xref="alg1.l13.m1.4.4.3.3.9">𝑒</ci><ci id="alg1.l13.m1.4.4.3.3.10.cmml" xref="alg1.l13.m1.4.4.3.3.10">𝐷</ci><ci id="alg1.l13.m1.4.4.3.3.11.cmml" xref="alg1.l13.m1.4.4.3.3.11">𝑜</ci><ci id="alg1.l13.m1.4.4.3.3.12.cmml" xref="alg1.l13.m1.4.4.3.3.12">𝑡</ci><ci id="alg1.l13.m1.4.4.3.3.13.cmml" xref="alg1.l13.m1.4.4.3.3.13">𝑃</ci><ci id="alg1.l13.m1.4.4.3.3.14.cmml" xref="alg1.l13.m1.4.4.3.3.14">𝑟</ci><ci id="alg1.l13.m1.4.4.3.3.15.cmml" xref="alg1.l13.m1.4.4.3.3.15">𝑜</ci><ci id="alg1.l13.m1.4.4.3.3.16.cmml" xref="alg1.l13.m1.4.4.3.3.16">𝑑</ci><ci id="alg1.l13.m1.4.4.3.3.17.cmml" xref="alg1.l13.m1.4.4.3.3.17">𝑢</ci><ci id="alg1.l13.m1.4.4.3.3.18.cmml" xref="alg1.l13.m1.4.4.3.3.18">𝑐</ci><ci id="alg1.l13.m1.4.4.3.3.19.cmml" xref="alg1.l13.m1.4.4.3.3.19">𝑡</ci><vector id="alg1.l13.m1.4.4.3.3.3.4.cmml" xref="alg1.l13.m1.4.4.3.3.3.3"><apply id="alg1.l13.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1"><times id="alg1.l13.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1"></times><apply id="alg1.l13.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.1.1.1.1.2.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.1.1.1.1.1.2.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.2.2">𝑓</ci><ci id="alg1.l13.m1.2.2.1.1.1.1.1.2.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">𝑞</ci></apply><apply id="alg1.l13.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.3.3.2.2.2.2.2.1.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="alg1.l13.m1.3.3.2.2.2.2.2.2.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.2.2">𝑆</ci><apply id="alg1.l13.m1.3.3.2.2.2.2.2.3.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.2.3"><times id="alg1.l13.m1.3.3.2.2.2.2.2.3.1.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.2.3.1"></times><ci id="alg1.l13.m1.3.3.2.2.2.2.2.3.2.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.2.3.2">𝑚</ci><ci id="alg1.l13.m1.3.3.2.2.2.2.2.3.3.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.2.3.3">𝑖</ci><ci id="alg1.l13.m1.3.3.2.2.2.2.2.3.4.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.2.3.4">𝑛</ci></apply></apply><apply id="alg1.l13.m1.4.4.3.3.3.3.3.cmml" xref="alg1.l13.m1.4.4.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l13.m1.4.4.3.3.3.3.3.1.cmml" xref="alg1.l13.m1.4.4.3.3.3.3.3">subscript</csymbol><ci id="alg1.l13.m1.4.4.3.3.3.3.3.2.cmml" xref="alg1.l13.m1.4.4.3.3.3.3.3.2">𝑋</ci><ci id="alg1.l13.m1.4.4.3.3.3.3.3.3.cmml" xref="alg1.l13.m1.4.4.3.3.3.3.3.3">𝑝</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.4c">G^{\prime}\leftarrow G^{\prime}\cup RangeDotProduct(f_{p}(q),S_{min},X_{p})</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.4d">italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∪ italic_R italic_a italic_n italic_g italic_e italic_D italic_o italic_t italic_P italic_r italic_o italic_d italic_u italic_c italic_t ( italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l13.4" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l13.1.m1.1"><semantics id="alg1.l13.1.m1.1a"><mo id="alg1.l13.1.m1.1.1" xref="alg1.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l13.1.m1.1b"><ci id="alg1.l13.1.m1.1.1.cmml" xref="alg1.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.1.m1.1d">▷</annotation></semantics></math> Retrieve all items with a dot product higher than or equal to <math alttext="S_{min}" class="ltx_Math" display="inline" id="alg1.l13.2.m2.1"><semantics id="alg1.l13.2.m2.1a"><msub id="alg1.l13.2.m2.1.1" xref="alg1.l13.2.m2.1.1.cmml"><mi id="alg1.l13.2.m2.1.1.2" xref="alg1.l13.2.m2.1.1.2.cmml">S</mi><mrow id="alg1.l13.2.m2.1.1.3" xref="alg1.l13.2.m2.1.1.3.cmml"><mi id="alg1.l13.2.m2.1.1.3.2" xref="alg1.l13.2.m2.1.1.3.2.cmml">m</mi><mo id="alg1.l13.2.m2.1.1.3.1" xref="alg1.l13.2.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l13.2.m2.1.1.3.3" xref="alg1.l13.2.m2.1.1.3.3.cmml">i</mi><mo id="alg1.l13.2.m2.1.1.3.1a" xref="alg1.l13.2.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l13.2.m2.1.1.3.4" xref="alg1.l13.2.m2.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l13.2.m2.1b"><apply id="alg1.l13.2.m2.1.1.cmml" xref="alg1.l13.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l13.2.m2.1.1.1.cmml" xref="alg1.l13.2.m2.1.1">subscript</csymbol><ci id="alg1.l13.2.m2.1.1.2.cmml" xref="alg1.l13.2.m2.1.1.2">𝑆</ci><apply id="alg1.l13.2.m2.1.1.3.cmml" xref="alg1.l13.2.m2.1.1.3"><times id="alg1.l13.2.m2.1.1.3.1.cmml" xref="alg1.l13.2.m2.1.1.3.1"></times><ci id="alg1.l13.2.m2.1.1.3.2.cmml" xref="alg1.l13.2.m2.1.1.3.2">𝑚</ci><ci id="alg1.l13.2.m2.1.1.3.3.cmml" xref="alg1.l13.2.m2.1.1.3.3">𝑖</ci><ci id="alg1.l13.2.m2.1.1.3.4.cmml" xref="alg1.l13.2.m2.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.2.m2.1c">S_{min}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.2.m2.1d">italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="f_{p}(q)" class="ltx_Math" display="inline" id="alg1.l13.3.m3.1"><semantics id="alg1.l13.3.m3.1a"><mrow id="alg1.l13.3.m3.1.2" xref="alg1.l13.3.m3.1.2.cmml"><msub id="alg1.l13.3.m3.1.2.2" xref="alg1.l13.3.m3.1.2.2.cmml"><mi id="alg1.l13.3.m3.1.2.2.2" xref="alg1.l13.3.m3.1.2.2.2.cmml">f</mi><mi id="alg1.l13.3.m3.1.2.2.3" xref="alg1.l13.3.m3.1.2.2.3.cmml">p</mi></msub><mo id="alg1.l13.3.m3.1.2.1" xref="alg1.l13.3.m3.1.2.1.cmml">⁢</mo><mrow id="alg1.l13.3.m3.1.2.3.2" xref="alg1.l13.3.m3.1.2.cmml"><mo id="alg1.l13.3.m3.1.2.3.2.1" stretchy="false" xref="alg1.l13.3.m3.1.2.cmml">(</mo><mi id="alg1.l13.3.m3.1.1" xref="alg1.l13.3.m3.1.1.cmml">q</mi><mo id="alg1.l13.3.m3.1.2.3.2.2" stretchy="false" xref="alg1.l13.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.3.m3.1b"><apply id="alg1.l13.3.m3.1.2.cmml" xref="alg1.l13.3.m3.1.2"><times id="alg1.l13.3.m3.1.2.1.cmml" xref="alg1.l13.3.m3.1.2.1"></times><apply id="alg1.l13.3.m3.1.2.2.cmml" xref="alg1.l13.3.m3.1.2.2"><csymbol cd="ambiguous" id="alg1.l13.3.m3.1.2.2.1.cmml" xref="alg1.l13.3.m3.1.2.2">subscript</csymbol><ci id="alg1.l13.3.m3.1.2.2.2.cmml" xref="alg1.l13.3.m3.1.2.2.2">𝑓</ci><ci id="alg1.l13.3.m3.1.2.2.3.cmml" xref="alg1.l13.3.m3.1.2.2.3">𝑝</ci></apply><ci id="alg1.l13.3.m3.1.1.cmml" xref="alg1.l13.3.m3.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.3.m3.1c">f_{p}(q)</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math> from <math alttext="X_{p}" class="ltx_Math" display="inline" id="alg1.l13.4.m4.1"><semantics id="alg1.l13.4.m4.1a"><msub id="alg1.l13.4.m4.1.1" xref="alg1.l13.4.m4.1.1.cmml"><mi id="alg1.l13.4.m4.1.1.2" xref="alg1.l13.4.m4.1.1.2.cmml">X</mi><mi id="alg1.l13.4.m4.1.1.3" xref="alg1.l13.4.m4.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l13.4.m4.1b"><apply id="alg1.l13.4.m4.1.1.cmml" xref="alg1.l13.4.m4.1.1"><csymbol cd="ambiguous" id="alg1.l13.4.m4.1.1.1.cmml" xref="alg1.l13.4.m4.1.1">subscript</csymbol><ci id="alg1.l13.4.m4.1.1.2.cmml" xref="alg1.l13.4.m4.1.1.2">𝑋</ci><ci id="alg1.l13.4.m4.1.1.3.cmml" xref="alg1.l13.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.4.m4.1c">X_{p}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.4.m4.1d">italic_X start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.4.1.1" style="font-size:80%;">14:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l14.5" style="font-size:90%;">return</span><span class="ltx_text" id="alg1.l14.6" style="font-size:90%;"> </span><math alttext="BruteForceTopKMoL(q,G^{\prime})" class="ltx_Math" display="inline" id="alg1.l14.m1.2"><semantics id="alg1.l14.m1.2a"><mrow id="alg1.l14.m1.2.2" xref="alg1.l14.m1.2.2.cmml"><mi id="alg1.l14.m1.2.2.3" mathsize="90%" xref="alg1.l14.m1.2.2.3.cmml">B</mi><mo id="alg1.l14.m1.2.2.2" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.4" mathsize="90%" xref="alg1.l14.m1.2.2.4.cmml">r</mi><mo id="alg1.l14.m1.2.2.2a" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.5" mathsize="90%" xref="alg1.l14.m1.2.2.5.cmml">u</mi><mo id="alg1.l14.m1.2.2.2b" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.6" mathsize="90%" xref="alg1.l14.m1.2.2.6.cmml">t</mi><mo id="alg1.l14.m1.2.2.2c" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.7" mathsize="90%" xref="alg1.l14.m1.2.2.7.cmml">e</mi><mo id="alg1.l14.m1.2.2.2d" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.8" mathsize="90%" xref="alg1.l14.m1.2.2.8.cmml">F</mi><mo id="alg1.l14.m1.2.2.2e" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.9" mathsize="90%" xref="alg1.l14.m1.2.2.9.cmml">o</mi><mo id="alg1.l14.m1.2.2.2f" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.10" mathsize="90%" xref="alg1.l14.m1.2.2.10.cmml">r</mi><mo id="alg1.l14.m1.2.2.2g" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.11" mathsize="90%" xref="alg1.l14.m1.2.2.11.cmml">c</mi><mo id="alg1.l14.m1.2.2.2h" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.12" mathsize="90%" xref="alg1.l14.m1.2.2.12.cmml">e</mi><mo id="alg1.l14.m1.2.2.2i" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.13" mathsize="90%" xref="alg1.l14.m1.2.2.13.cmml">T</mi><mo id="alg1.l14.m1.2.2.2j" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.14" mathsize="90%" xref="alg1.l14.m1.2.2.14.cmml">o</mi><mo id="alg1.l14.m1.2.2.2k" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.15" mathsize="90%" xref="alg1.l14.m1.2.2.15.cmml">p</mi><mo id="alg1.l14.m1.2.2.2l" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.16" mathsize="90%" xref="alg1.l14.m1.2.2.16.cmml">K</mi><mo id="alg1.l14.m1.2.2.2m" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.17" mathsize="90%" xref="alg1.l14.m1.2.2.17.cmml">M</mi><mo id="alg1.l14.m1.2.2.2n" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.18" mathsize="90%" xref="alg1.l14.m1.2.2.18.cmml">o</mi><mo id="alg1.l14.m1.2.2.2o" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mi id="alg1.l14.m1.2.2.19" mathsize="90%" xref="alg1.l14.m1.2.2.19.cmml">L</mi><mo id="alg1.l14.m1.2.2.2p" xref="alg1.l14.m1.2.2.2.cmml">⁢</mo><mrow id="alg1.l14.m1.2.2.1.1" xref="alg1.l14.m1.2.2.1.2.cmml"><mo id="alg1.l14.m1.2.2.1.1.2" maxsize="90%" minsize="90%" xref="alg1.l14.m1.2.2.1.2.cmml">(</mo><mi id="alg1.l14.m1.1.1" mathsize="90%" xref="alg1.l14.m1.1.1.cmml">q</mi><mo id="alg1.l14.m1.2.2.1.1.3" mathsize="90%" xref="alg1.l14.m1.2.2.1.2.cmml">,</mo><msup id="alg1.l14.m1.2.2.1.1.1" xref="alg1.l14.m1.2.2.1.1.1.cmml"><mi id="alg1.l14.m1.2.2.1.1.1.2" mathsize="90%" xref="alg1.l14.m1.2.2.1.1.1.2.cmml">G</mi><mo id="alg1.l14.m1.2.2.1.1.1.3" mathsize="90%" xref="alg1.l14.m1.2.2.1.1.1.3.cmml">′</mo></msup><mo id="alg1.l14.m1.2.2.1.1.4" maxsize="90%" minsize="90%" xref="alg1.l14.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.2b"><apply id="alg1.l14.m1.2.2.cmml" xref="alg1.l14.m1.2.2"><times id="alg1.l14.m1.2.2.2.cmml" xref="alg1.l14.m1.2.2.2"></times><ci id="alg1.l14.m1.2.2.3.cmml" xref="alg1.l14.m1.2.2.3">𝐵</ci><ci id="alg1.l14.m1.2.2.4.cmml" xref="alg1.l14.m1.2.2.4">𝑟</ci><ci id="alg1.l14.m1.2.2.5.cmml" xref="alg1.l14.m1.2.2.5">𝑢</ci><ci id="alg1.l14.m1.2.2.6.cmml" xref="alg1.l14.m1.2.2.6">𝑡</ci><ci id="alg1.l14.m1.2.2.7.cmml" xref="alg1.l14.m1.2.2.7">𝑒</ci><ci id="alg1.l14.m1.2.2.8.cmml" xref="alg1.l14.m1.2.2.8">𝐹</ci><ci id="alg1.l14.m1.2.2.9.cmml" xref="alg1.l14.m1.2.2.9">𝑜</ci><ci id="alg1.l14.m1.2.2.10.cmml" xref="alg1.l14.m1.2.2.10">𝑟</ci><ci id="alg1.l14.m1.2.2.11.cmml" xref="alg1.l14.m1.2.2.11">𝑐</ci><ci id="alg1.l14.m1.2.2.12.cmml" xref="alg1.l14.m1.2.2.12">𝑒</ci><ci id="alg1.l14.m1.2.2.13.cmml" xref="alg1.l14.m1.2.2.13">𝑇</ci><ci id="alg1.l14.m1.2.2.14.cmml" xref="alg1.l14.m1.2.2.14">𝑜</ci><ci id="alg1.l14.m1.2.2.15.cmml" xref="alg1.l14.m1.2.2.15">𝑝</ci><ci id="alg1.l14.m1.2.2.16.cmml" xref="alg1.l14.m1.2.2.16">𝐾</ci><ci id="alg1.l14.m1.2.2.17.cmml" xref="alg1.l14.m1.2.2.17">𝑀</ci><ci id="alg1.l14.m1.2.2.18.cmml" xref="alg1.l14.m1.2.2.18">𝑜</ci><ci id="alg1.l14.m1.2.2.19.cmml" xref="alg1.l14.m1.2.2.19">𝐿</ci><interval closure="open" id="alg1.l14.m1.2.2.1.2.cmml" xref="alg1.l14.m1.2.2.1.1"><ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">𝑞</ci><apply id="alg1.l14.m1.2.2.1.1.1.cmml" xref="alg1.l14.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.1.1.1.1.cmml" xref="alg1.l14.m1.2.2.1.1.1">superscript</csymbol><ci id="alg1.l14.m1.2.2.1.1.1.2.cmml" xref="alg1.l14.m1.2.2.1.1.1.2">𝐺</ci><ci id="alg1.l14.m1.2.2.1.1.1.3.cmml" xref="alg1.l14.m1.2.2.1.1.1.3">′</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.2c">BruteForceTopKMoL(q,G^{\prime})</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.2d">italic_B italic_r italic_u italic_t italic_e italic_F italic_o italic_r italic_c italic_e italic_T italic_o italic_p italic_K italic_M italic_o italic_L ( italic_q , italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.l14.3" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l14.1.m1.1"><semantics id="alg1.l14.1.m1.1a"><mo id="alg1.l14.1.m1.1.1" xref="alg1.l14.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l14.1.m1.1b"><ci id="alg1.l14.1.m1.1.1.cmml" xref="alg1.l14.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.1.m1.1d">▷</annotation></semantics></math> Retrieve the top <math alttext="K" class="ltx_Math" display="inline" id="alg1.l14.2.m2.1"><semantics id="alg1.l14.2.m2.1a"><mi id="alg1.l14.2.m2.1.1" xref="alg1.l14.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l14.2.m2.1b"><ci id="alg1.l14.2.m2.1.1.cmml" xref="alg1.l14.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.2.m2.1d">italic_K</annotation></semantics></math> items from <math alttext="G^{\prime}" class="ltx_Math" display="inline" id="alg1.l14.3.m3.1"><semantics id="alg1.l14.3.m3.1a"><msup id="alg1.l14.3.m3.1.1" xref="alg1.l14.3.m3.1.1.cmml"><mi id="alg1.l14.3.m3.1.1.2" xref="alg1.l14.3.m3.1.1.2.cmml">G</mi><mo id="alg1.l14.3.m3.1.1.3" xref="alg1.l14.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l14.3.m3.1b"><apply id="alg1.l14.3.m3.1.1.cmml" xref="alg1.l14.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l14.3.m3.1.1.1.cmml" xref="alg1.l14.3.m3.1.1">superscript</csymbol><ci id="alg1.l14.3.m3.1.1.2.cmml" xref="alg1.l14.3.m3.1.1.2">𝐺</ci><ci id="alg1.l14.3.m3.1.1.3.cmml" xref="alg1.l14.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.3.m3.1c">G^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.3.m3.1d">italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> with <span class="ltx_text ltx_font_italic" id="alg1.l14.3.1">MoL</span>
</span>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.9">We start by retrieving the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_K</annotation></semantics></math> items with the highest dot product scores for each group of embeddings as the initial candidate set <math alttext="G" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_G</annotation></semantics></math> (line 1-4). Then we evaluate the <span class="ltx_text ltx_font_italic" id="S3.SS1.p2.9.1">MoL</span> scores of the items in <math alttext="G" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">G</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_G</annotation></semantics></math> and find the minimal learned similarity score <math alttext="S_{min}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">S</mi><mrow id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml">m</mi><mo id="S3.SS1.p2.4.m4.1.1.3.1" xref="S3.SS1.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml">i</mi><mo id="S3.SS1.p2.4.m4.1.1.3.1a" xref="S3.SS1.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.3.4" xref="S3.SS1.p2.4.m4.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑆</ci><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><times id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.1"></times><ci id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2">𝑚</ci><ci id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3">𝑖</ci><ci id="S3.SS1.p2.4.m4.1.1.3.4.cmml" xref="S3.SS1.p2.4.m4.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">S_{min}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> (line 5-8). Next we retrieve all items within a distance of <math alttext="S_{min}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><msub id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">S</mi><mrow id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.cmml">m</mi><mo id="S3.SS1.p2.5.m5.1.1.3.1" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.5.m5.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.cmml">i</mi><mo id="S3.SS1.p2.5.m5.1.1.3.1a" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.5.m5.1.1.3.4" xref="S3.SS1.p2.5.m5.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝑆</ci><apply id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3"><times id="S3.SS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1"></times><ci id="S3.SS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2">𝑚</ci><ci id="S3.SS1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3">𝑖</ci><ci id="S3.SS1.p2.5.m5.1.1.3.4.cmml" xref="S3.SS1.p2.5.m5.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">S_{min}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> with the query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">italic_q</annotation></semantics></math> as the candidate set <math alttext="G^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><msup id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2" xref="S3.SS1.p2.7.m7.1.1.2.cmml">G</mi><mo id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2">𝐺</ci><ci id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">G^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> (line 9-11). Finally, we evaluate the <span class="ltx_text ltx_font_italic" id="S3.SS1.p2.9.2">MoL</span> scores of the items in <math alttext="G^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><msup id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">G</mi><mo id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">superscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">𝐺</ci><ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">G^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, and return the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.1"><semantics id="S3.SS1.p2.9.m9.1a"><mi id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m9.1d">italic_K</annotation></semantics></math> items with the highest scores (line 12).</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.18">We argue that Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#alg1" title="Algorithm 1 ‣ 3.1 Exact algorithm ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">1</span></a> retrieves the exact top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_K</annotation></semantics></math> items with <span class="ltx_text ltx_font_italic" id="S3.SS1.p3.18.1">MoL</span>. Let <math alttext="X_{K}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">X</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝑋</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">X_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_X start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> be the set of the exact top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_K</annotation></semantics></math> items and <math alttext="X^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><msup id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml">X</mi><mo id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2">𝑋</ci><ci id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">X^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">italic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> be the result of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#alg1" title="Algorithm 1 ‣ 3.1 Exact algorithm ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">1</span></a>. Let <math alttext="x\in X_{K}" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m5.1"><semantics id="S3.SS1.p3.5.m5.1a"><mrow id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2" xref="S3.SS1.p3.5.m5.1.1.2.cmml">x</mi><mo id="S3.SS1.p3.5.m5.1.1.1" xref="S3.SS1.p3.5.m5.1.1.1.cmml">∈</mo><msub id="S3.SS1.p3.5.m5.1.1.3" xref="S3.SS1.p3.5.m5.1.1.3.cmml"><mi id="S3.SS1.p3.5.m5.1.1.3.2" xref="S3.SS1.p3.5.m5.1.1.3.2.cmml">X</mi><mi id="S3.SS1.p3.5.m5.1.1.3.3" xref="S3.SS1.p3.5.m5.1.1.3.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1"><in id="S3.SS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1.1"></in><ci id="S3.SS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2">𝑥</ci><apply id="S3.SS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.3.1.cmml" xref="S3.SS1.p3.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.3.2.cmml" xref="S3.SS1.p3.5.m5.1.1.3.2">𝑋</ci><ci id="S3.SS1.p3.5.m5.1.1.3.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">x\in X_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m5.1d">italic_x ∈ italic_X start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\phi(q,x)" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m6.2"><semantics id="S3.SS1.p3.6.m6.2a"><mrow id="S3.SS1.p3.6.m6.2.3" xref="S3.SS1.p3.6.m6.2.3.cmml"><mi id="S3.SS1.p3.6.m6.2.3.2" xref="S3.SS1.p3.6.m6.2.3.2.cmml">ϕ</mi><mo id="S3.SS1.p3.6.m6.2.3.1" xref="S3.SS1.p3.6.m6.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p3.6.m6.2.3.3.2" xref="S3.SS1.p3.6.m6.2.3.3.1.cmml"><mo id="S3.SS1.p3.6.m6.2.3.3.2.1" stretchy="false" xref="S3.SS1.p3.6.m6.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">q</mi><mo id="S3.SS1.p3.6.m6.2.3.3.2.2" xref="S3.SS1.p3.6.m6.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p3.6.m6.2.2" xref="S3.SS1.p3.6.m6.2.2.cmml">x</mi><mo id="S3.SS1.p3.6.m6.2.3.3.2.3" stretchy="false" xref="S3.SS1.p3.6.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.2b"><apply id="S3.SS1.p3.6.m6.2.3.cmml" xref="S3.SS1.p3.6.m6.2.3"><times id="S3.SS1.p3.6.m6.2.3.1.cmml" xref="S3.SS1.p3.6.m6.2.3.1"></times><ci id="S3.SS1.p3.6.m6.2.3.2.cmml" xref="S3.SS1.p3.6.m6.2.3.2">italic-ϕ</ci><interval closure="open" id="S3.SS1.p3.6.m6.2.3.3.1.cmml" xref="S3.SS1.p3.6.m6.2.3.3.2"><ci id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">𝑞</ci><ci id="S3.SS1.p3.6.m6.2.2.cmml" xref="S3.SS1.p3.6.m6.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.2c">\phi(q,x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m6.2d">italic_ϕ ( italic_q , italic_x )</annotation></semantics></math> be the <span class="ltx_text ltx_font_italic" id="S3.SS1.p3.18.2">MoL</span> score of <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.p3.7.m7.1"><semantics id="S3.SS1.p3.7.m7.1a"><mi id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><ci id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m7.1d">italic_x</annotation></semantics></math> and <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p3.8.m8.1"><semantics id="S3.SS1.p3.8.m8.1a"><mi id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><ci id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.8.m8.1d">italic_q</annotation></semantics></math>. Since <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.p3.9.m9.1"><semantics id="S3.SS1.p3.9.m9.1a"><mi id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><ci id="S3.SS1.p3.9.m9.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.9.m9.1d">italic_x</annotation></semantics></math> has the highest top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p3.10.m10.1"><semantics id="S3.SS1.p3.10.m10.1a"><mi id="S3.SS1.p3.10.m10.1.1" xref="S3.SS1.p3.10.m10.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m10.1b"><ci id="S3.SS1.p3.10.m10.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m10.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.10.m10.1d">italic_K</annotation></semantics></math> score with <span class="ltx_text ltx_font_italic" id="S3.SS1.p3.18.3">MoL</span>, <math alttext="\phi(q,x)\geq S_{min}" class="ltx_Math" display="inline" id="S3.SS1.p3.11.m11.2"><semantics id="S3.SS1.p3.11.m11.2a"><mrow id="S3.SS1.p3.11.m11.2.3" xref="S3.SS1.p3.11.m11.2.3.cmml"><mrow id="S3.SS1.p3.11.m11.2.3.2" xref="S3.SS1.p3.11.m11.2.3.2.cmml"><mi id="S3.SS1.p3.11.m11.2.3.2.2" xref="S3.SS1.p3.11.m11.2.3.2.2.cmml">ϕ</mi><mo id="S3.SS1.p3.11.m11.2.3.2.1" xref="S3.SS1.p3.11.m11.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS1.p3.11.m11.2.3.2.3.2" xref="S3.SS1.p3.11.m11.2.3.2.3.1.cmml"><mo id="S3.SS1.p3.11.m11.2.3.2.3.2.1" stretchy="false" xref="S3.SS1.p3.11.m11.2.3.2.3.1.cmml">(</mo><mi id="S3.SS1.p3.11.m11.1.1" xref="S3.SS1.p3.11.m11.1.1.cmml">q</mi><mo id="S3.SS1.p3.11.m11.2.3.2.3.2.2" xref="S3.SS1.p3.11.m11.2.3.2.3.1.cmml">,</mo><mi id="S3.SS1.p3.11.m11.2.2" xref="S3.SS1.p3.11.m11.2.2.cmml">x</mi><mo id="S3.SS1.p3.11.m11.2.3.2.3.2.3" stretchy="false" xref="S3.SS1.p3.11.m11.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.11.m11.2.3.1" xref="S3.SS1.p3.11.m11.2.3.1.cmml">≥</mo><msub id="S3.SS1.p3.11.m11.2.3.3" xref="S3.SS1.p3.11.m11.2.3.3.cmml"><mi id="S3.SS1.p3.11.m11.2.3.3.2" xref="S3.SS1.p3.11.m11.2.3.3.2.cmml">S</mi><mrow id="S3.SS1.p3.11.m11.2.3.3.3" xref="S3.SS1.p3.11.m11.2.3.3.3.cmml"><mi id="S3.SS1.p3.11.m11.2.3.3.3.2" xref="S3.SS1.p3.11.m11.2.3.3.3.2.cmml">m</mi><mo id="S3.SS1.p3.11.m11.2.3.3.3.1" xref="S3.SS1.p3.11.m11.2.3.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.11.m11.2.3.3.3.3" xref="S3.SS1.p3.11.m11.2.3.3.3.3.cmml">i</mi><mo id="S3.SS1.p3.11.m11.2.3.3.3.1a" xref="S3.SS1.p3.11.m11.2.3.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.11.m11.2.3.3.3.4" xref="S3.SS1.p3.11.m11.2.3.3.3.4.cmml">n</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m11.2b"><apply id="S3.SS1.p3.11.m11.2.3.cmml" xref="S3.SS1.p3.11.m11.2.3"><geq id="S3.SS1.p3.11.m11.2.3.1.cmml" xref="S3.SS1.p3.11.m11.2.3.1"></geq><apply id="S3.SS1.p3.11.m11.2.3.2.cmml" xref="S3.SS1.p3.11.m11.2.3.2"><times id="S3.SS1.p3.11.m11.2.3.2.1.cmml" xref="S3.SS1.p3.11.m11.2.3.2.1"></times><ci id="S3.SS1.p3.11.m11.2.3.2.2.cmml" xref="S3.SS1.p3.11.m11.2.3.2.2">italic-ϕ</ci><interval closure="open" id="S3.SS1.p3.11.m11.2.3.2.3.1.cmml" xref="S3.SS1.p3.11.m11.2.3.2.3.2"><ci id="S3.SS1.p3.11.m11.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1">𝑞</ci><ci id="S3.SS1.p3.11.m11.2.2.cmml" xref="S3.SS1.p3.11.m11.2.2">𝑥</ci></interval></apply><apply id="S3.SS1.p3.11.m11.2.3.3.cmml" xref="S3.SS1.p3.11.m11.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.11.m11.2.3.3.1.cmml" xref="S3.SS1.p3.11.m11.2.3.3">subscript</csymbol><ci id="S3.SS1.p3.11.m11.2.3.3.2.cmml" xref="S3.SS1.p3.11.m11.2.3.3.2">𝑆</ci><apply id="S3.SS1.p3.11.m11.2.3.3.3.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3"><times id="S3.SS1.p3.11.m11.2.3.3.3.1.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.1"></times><ci id="S3.SS1.p3.11.m11.2.3.3.3.2.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.2">𝑚</ci><ci id="S3.SS1.p3.11.m11.2.3.3.3.3.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.3">𝑖</ci><ci id="S3.SS1.p3.11.m11.2.3.3.3.4.cmml" xref="S3.SS1.p3.11.m11.2.3.3.3.4">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m11.2c">\phi(q,x)\geq S_{min}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.11.m11.2d">italic_ϕ ( italic_q , italic_x ) ≥ italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math>. Since the <span class="ltx_text ltx_font_italic" id="S3.SS1.p3.18.4">MoL</span> score is a weighted score over the dot product scores, we have <math alttext="\max\{\langle f_{p}(q),g_{p}(x)\rangle,1\leq p\leq P\}\geq\phi(q,x)\geq S_{min}" class="ltx_Math" display="inline" id="S3.SS1.p3.12.m12.7"><semantics id="S3.SS1.p3.12.m12.7a"><mrow id="S3.SS1.p3.12.m12.7.7" xref="S3.SS1.p3.12.m12.7.7.cmml"><mrow id="S3.SS1.p3.12.m12.7.7.2.2" xref="S3.SS1.p3.12.m12.7.7.2.3.cmml"><mi id="S3.SS1.p3.12.m12.3.3" xref="S3.SS1.p3.12.m12.3.3.cmml">max</mi><mo id="S3.SS1.p3.12.m12.7.7.2.2a" xref="S3.SS1.p3.12.m12.7.7.2.3.cmml">⁡</mo><mrow id="S3.SS1.p3.12.m12.7.7.2.2.2" xref="S3.SS1.p3.12.m12.7.7.2.3.cmml"><mo id="S3.SS1.p3.12.m12.7.7.2.2.2.3" stretchy="false" xref="S3.SS1.p3.12.m12.7.7.2.3.cmml">{</mo><mrow id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.3.cmml"><mo id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.3" stretchy="false" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.3.cmml">⟨</mo><mrow id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2.2" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2.3" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.1" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.3.2" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p3.12.m12.1.1" xref="S3.SS1.p3.12.m12.1.1.cmml">q</mi><mo id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.4" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.3.cmml">,</mo><mrow id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.cmml"><msub id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2.2" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2.2.cmml">g</mi><mi id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2.3" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2.3.cmml">p</mi></msub><mo id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.1" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.3.2" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.cmml"><mo id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.3.2.1" stretchy="false" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.cmml">(</mo><mi id="S3.SS1.p3.12.m12.2.2" xref="S3.SS1.p3.12.m12.2.2.cmml">x</mi><mo id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.3.2.2" stretchy="false" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.5" stretchy="false" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.3.cmml">⟩</mo></mrow><mo id="S3.SS1.p3.12.m12.7.7.2.2.2.4" xref="S3.SS1.p3.12.m12.7.7.2.3.cmml">,</mo><mrow id="S3.SS1.p3.12.m12.7.7.2.2.2.2" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2.cmml"><mn id="S3.SS1.p3.12.m12.7.7.2.2.2.2.2" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2.2.cmml">1</mn><mo id="S3.SS1.p3.12.m12.7.7.2.2.2.2.3" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS1.p3.12.m12.7.7.2.2.2.2.4" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2.4.cmml">p</mi><mo id="S3.SS1.p3.12.m12.7.7.2.2.2.2.5" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS1.p3.12.m12.7.7.2.2.2.2.6" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2.6.cmml">P</mi></mrow><mo id="S3.SS1.p3.12.m12.7.7.2.2.2.5" stretchy="false" xref="S3.SS1.p3.12.m12.7.7.2.3.cmml">}</mo></mrow></mrow><mo id="S3.SS1.p3.12.m12.7.7.4" xref="S3.SS1.p3.12.m12.7.7.4.cmml">≥</mo><mrow id="S3.SS1.p3.12.m12.7.7.5" xref="S3.SS1.p3.12.m12.7.7.5.cmml"><mi id="S3.SS1.p3.12.m12.7.7.5.2" xref="S3.SS1.p3.12.m12.7.7.5.2.cmml">ϕ</mi><mo id="S3.SS1.p3.12.m12.7.7.5.1" xref="S3.SS1.p3.12.m12.7.7.5.1.cmml">⁢</mo><mrow id="S3.SS1.p3.12.m12.7.7.5.3.2" xref="S3.SS1.p3.12.m12.7.7.5.3.1.cmml"><mo id="S3.SS1.p3.12.m12.7.7.5.3.2.1" stretchy="false" xref="S3.SS1.p3.12.m12.7.7.5.3.1.cmml">(</mo><mi id="S3.SS1.p3.12.m12.4.4" xref="S3.SS1.p3.12.m12.4.4.cmml">q</mi><mo id="S3.SS1.p3.12.m12.7.7.5.3.2.2" xref="S3.SS1.p3.12.m12.7.7.5.3.1.cmml">,</mo><mi id="S3.SS1.p3.12.m12.5.5" xref="S3.SS1.p3.12.m12.5.5.cmml">x</mi><mo id="S3.SS1.p3.12.m12.7.7.5.3.2.3" stretchy="false" xref="S3.SS1.p3.12.m12.7.7.5.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.12.m12.7.7.6" xref="S3.SS1.p3.12.m12.7.7.6.cmml">≥</mo><msub id="S3.SS1.p3.12.m12.7.7.7" xref="S3.SS1.p3.12.m12.7.7.7.cmml"><mi id="S3.SS1.p3.12.m12.7.7.7.2" xref="S3.SS1.p3.12.m12.7.7.7.2.cmml">S</mi><mrow id="S3.SS1.p3.12.m12.7.7.7.3" xref="S3.SS1.p3.12.m12.7.7.7.3.cmml"><mi id="S3.SS1.p3.12.m12.7.7.7.3.2" xref="S3.SS1.p3.12.m12.7.7.7.3.2.cmml">m</mi><mo id="S3.SS1.p3.12.m12.7.7.7.3.1" xref="S3.SS1.p3.12.m12.7.7.7.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.12.m12.7.7.7.3.3" xref="S3.SS1.p3.12.m12.7.7.7.3.3.cmml">i</mi><mo id="S3.SS1.p3.12.m12.7.7.7.3.1a" xref="S3.SS1.p3.12.m12.7.7.7.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.12.m12.7.7.7.3.4" xref="S3.SS1.p3.12.m12.7.7.7.3.4.cmml">n</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.12.m12.7b"><apply id="S3.SS1.p3.12.m12.7.7.cmml" xref="S3.SS1.p3.12.m12.7.7"><and id="S3.SS1.p3.12.m12.7.7a.cmml" xref="S3.SS1.p3.12.m12.7.7"></and><apply id="S3.SS1.p3.12.m12.7.7b.cmml" xref="S3.SS1.p3.12.m12.7.7"><geq id="S3.SS1.p3.12.m12.7.7.4.cmml" xref="S3.SS1.p3.12.m12.7.7.4"></geq><apply id="S3.SS1.p3.12.m12.7.7.2.3.cmml" xref="S3.SS1.p3.12.m12.7.7.2.2"><max id="S3.SS1.p3.12.m12.3.3.cmml" xref="S3.SS1.p3.12.m12.3.3"></max><list id="S3.SS1.p3.12.m12.6.6.1.1.1.1.3.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2"><apply id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1"><times id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.1"></times><apply id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="S3.SS1.p3.12.m12.1.1.cmml" xref="S3.SS1.p3.12.m12.1.1">𝑞</ci></apply><apply id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2"><times id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.1"></times><apply id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2.2">𝑔</ci><ci id="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p3.12.m12.6.6.1.1.1.1.2.2.2.3">𝑝</ci></apply><ci id="S3.SS1.p3.12.m12.2.2.cmml" xref="S3.SS1.p3.12.m12.2.2">𝑥</ci></apply></list><apply id="S3.SS1.p3.12.m12.7.7.2.2.2.2.cmml" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2"><and id="S3.SS1.p3.12.m12.7.7.2.2.2.2a.cmml" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2"></and><apply id="S3.SS1.p3.12.m12.7.7.2.2.2.2b.cmml" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2"><leq id="S3.SS1.p3.12.m12.7.7.2.2.2.2.3.cmml" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2.3"></leq><cn id="S3.SS1.p3.12.m12.7.7.2.2.2.2.2.cmml" type="integer" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2.2">1</cn><ci id="S3.SS1.p3.12.m12.7.7.2.2.2.2.4.cmml" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2.4">𝑝</ci></apply><apply id="S3.SS1.p3.12.m12.7.7.2.2.2.2c.cmml" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2"><leq id="S3.SS1.p3.12.m12.7.7.2.2.2.2.5.cmml" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2407.15462v2#S3.SS1.p3.12.m12.7.7.2.2.2.2.4.cmml" id="S3.SS1.p3.12.m12.7.7.2.2.2.2d.cmml" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2"></share><ci id="S3.SS1.p3.12.m12.7.7.2.2.2.2.6.cmml" xref="S3.SS1.p3.12.m12.7.7.2.2.2.2.6">𝑃</ci></apply></apply></apply><apply id="S3.SS1.p3.12.m12.7.7.5.cmml" xref="S3.SS1.p3.12.m12.7.7.5"><times id="S3.SS1.p3.12.m12.7.7.5.1.cmml" xref="S3.SS1.p3.12.m12.7.7.5.1"></times><ci id="S3.SS1.p3.12.m12.7.7.5.2.cmml" xref="S3.SS1.p3.12.m12.7.7.5.2">italic-ϕ</ci><interval closure="open" id="S3.SS1.p3.12.m12.7.7.5.3.1.cmml" xref="S3.SS1.p3.12.m12.7.7.5.3.2"><ci id="S3.SS1.p3.12.m12.4.4.cmml" xref="S3.SS1.p3.12.m12.4.4">𝑞</ci><ci id="S3.SS1.p3.12.m12.5.5.cmml" xref="S3.SS1.p3.12.m12.5.5">𝑥</ci></interval></apply></apply><apply id="S3.SS1.p3.12.m12.7.7c.cmml" xref="S3.SS1.p3.12.m12.7.7"><geq id="S3.SS1.p3.12.m12.7.7.6.cmml" xref="S3.SS1.p3.12.m12.7.7.6"></geq><share href="https://arxiv.org/html/2407.15462v2#S3.SS1.p3.12.m12.7.7.5.cmml" id="S3.SS1.p3.12.m12.7.7d.cmml" xref="S3.SS1.p3.12.m12.7.7"></share><apply id="S3.SS1.p3.12.m12.7.7.7.cmml" xref="S3.SS1.p3.12.m12.7.7.7"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m12.7.7.7.1.cmml" xref="S3.SS1.p3.12.m12.7.7.7">subscript</csymbol><ci id="S3.SS1.p3.12.m12.7.7.7.2.cmml" xref="S3.SS1.p3.12.m12.7.7.7.2">𝑆</ci><apply id="S3.SS1.p3.12.m12.7.7.7.3.cmml" xref="S3.SS1.p3.12.m12.7.7.7.3"><times id="S3.SS1.p3.12.m12.7.7.7.3.1.cmml" xref="S3.SS1.p3.12.m12.7.7.7.3.1"></times><ci id="S3.SS1.p3.12.m12.7.7.7.3.2.cmml" xref="S3.SS1.p3.12.m12.7.7.7.3.2">𝑚</ci><ci id="S3.SS1.p3.12.m12.7.7.7.3.3.cmml" xref="S3.SS1.p3.12.m12.7.7.7.3.3">𝑖</ci><ci id="S3.SS1.p3.12.m12.7.7.7.3.4.cmml" xref="S3.SS1.p3.12.m12.7.7.7.3.4">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.12.m12.7c">\max\{\langle f_{p}(q),g_{p}(x)\rangle,1\leq p\leq P\}\geq\phi(q,x)\geq S_{min}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.12.m12.7d">roman_max { ⟨ italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ⟩ , 1 ≤ italic_p ≤ italic_P } ≥ italic_ϕ ( italic_q , italic_x ) ≥ italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math>. Since Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#alg1" title="Algorithm 1 ‣ 3.1 Exact algorithm ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">1</span></a> retrieves all the items with a dot product higher than or equal to <math alttext="S_{min}" class="ltx_Math" display="inline" id="S3.SS1.p3.13.m13.1"><semantics id="S3.SS1.p3.13.m13.1a"><msub id="S3.SS1.p3.13.m13.1.1" xref="S3.SS1.p3.13.m13.1.1.cmml"><mi id="S3.SS1.p3.13.m13.1.1.2" xref="S3.SS1.p3.13.m13.1.1.2.cmml">S</mi><mrow id="S3.SS1.p3.13.m13.1.1.3" xref="S3.SS1.p3.13.m13.1.1.3.cmml"><mi id="S3.SS1.p3.13.m13.1.1.3.2" xref="S3.SS1.p3.13.m13.1.1.3.2.cmml">m</mi><mo id="S3.SS1.p3.13.m13.1.1.3.1" xref="S3.SS1.p3.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.13.m13.1.1.3.3" xref="S3.SS1.p3.13.m13.1.1.3.3.cmml">i</mi><mo id="S3.SS1.p3.13.m13.1.1.3.1a" xref="S3.SS1.p3.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.13.m13.1.1.3.4" xref="S3.SS1.p3.13.m13.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.13.m13.1b"><apply id="S3.SS1.p3.13.m13.1.1.cmml" xref="S3.SS1.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.13.m13.1.1.1.cmml" xref="S3.SS1.p3.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p3.13.m13.1.1.2.cmml" xref="S3.SS1.p3.13.m13.1.1.2">𝑆</ci><apply id="S3.SS1.p3.13.m13.1.1.3.cmml" xref="S3.SS1.p3.13.m13.1.1.3"><times id="S3.SS1.p3.13.m13.1.1.3.1.cmml" xref="S3.SS1.p3.13.m13.1.1.3.1"></times><ci id="S3.SS1.p3.13.m13.1.1.3.2.cmml" xref="S3.SS1.p3.13.m13.1.1.3.2">𝑚</ci><ci id="S3.SS1.p3.13.m13.1.1.3.3.cmml" xref="S3.SS1.p3.13.m13.1.1.3.3">𝑖</ci><ci id="S3.SS1.p3.13.m13.1.1.3.4.cmml" xref="S3.SS1.p3.13.m13.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.13.m13.1c">S_{min}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.13.m13.1d">italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p3.14.m14.1"><semantics id="S3.SS1.p3.14.m14.1a"><mi id="S3.SS1.p3.14.m14.1.1" xref="S3.SS1.p3.14.m14.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.14.m14.1b"><ci id="S3.SS1.p3.14.m14.1.1.cmml" xref="S3.SS1.p3.14.m14.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.14.m14.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.14.m14.1d">italic_q</annotation></semantics></math> for each embedding <math alttext="q_{p}" class="ltx_Math" display="inline" id="S3.SS1.p3.15.m15.1"><semantics id="S3.SS1.p3.15.m15.1a"><msub id="S3.SS1.p3.15.m15.1.1" xref="S3.SS1.p3.15.m15.1.1.cmml"><mi id="S3.SS1.p3.15.m15.1.1.2" xref="S3.SS1.p3.15.m15.1.1.2.cmml">q</mi><mi id="S3.SS1.p3.15.m15.1.1.3" xref="S3.SS1.p3.15.m15.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.15.m15.1b"><apply id="S3.SS1.p3.15.m15.1.1.cmml" xref="S3.SS1.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.15.m15.1.1.1.cmml" xref="S3.SS1.p3.15.m15.1.1">subscript</csymbol><ci id="S3.SS1.p3.15.m15.1.1.2.cmml" xref="S3.SS1.p3.15.m15.1.1.2">𝑞</ci><ci id="S3.SS1.p3.15.m15.1.1.3.cmml" xref="S3.SS1.p3.15.m15.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.15.m15.1c">q_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.15.m15.1d">italic_q start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> (line 9-11), we have <math alttext="x\in G^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p3.16.m16.1"><semantics id="S3.SS1.p3.16.m16.1a"><mrow id="S3.SS1.p3.16.m16.1.1" xref="S3.SS1.p3.16.m16.1.1.cmml"><mi id="S3.SS1.p3.16.m16.1.1.2" xref="S3.SS1.p3.16.m16.1.1.2.cmml">x</mi><mo id="S3.SS1.p3.16.m16.1.1.1" xref="S3.SS1.p3.16.m16.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.16.m16.1.1.3" xref="S3.SS1.p3.16.m16.1.1.3.cmml"><mi id="S3.SS1.p3.16.m16.1.1.3.2" xref="S3.SS1.p3.16.m16.1.1.3.2.cmml">G</mi><mo id="S3.SS1.p3.16.m16.1.1.3.3" xref="S3.SS1.p3.16.m16.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.16.m16.1b"><apply id="S3.SS1.p3.16.m16.1.1.cmml" xref="S3.SS1.p3.16.m16.1.1"><in id="S3.SS1.p3.16.m16.1.1.1.cmml" xref="S3.SS1.p3.16.m16.1.1.1"></in><ci id="S3.SS1.p3.16.m16.1.1.2.cmml" xref="S3.SS1.p3.16.m16.1.1.2">𝑥</ci><apply id="S3.SS1.p3.16.m16.1.1.3.cmml" xref="S3.SS1.p3.16.m16.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.16.m16.1.1.3.1.cmml" xref="S3.SS1.p3.16.m16.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.16.m16.1.1.3.2.cmml" xref="S3.SS1.p3.16.m16.1.1.3.2">𝐺</ci><ci id="S3.SS1.p3.16.m16.1.1.3.3.cmml" xref="S3.SS1.p3.16.m16.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.16.m16.1c">x\in G^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.16.m16.1d">italic_x ∈ italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. Thus, <math alttext="x\in X^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p3.17.m17.1"><semantics id="S3.SS1.p3.17.m17.1a"><mrow id="S3.SS1.p3.17.m17.1.1" xref="S3.SS1.p3.17.m17.1.1.cmml"><mi id="S3.SS1.p3.17.m17.1.1.2" xref="S3.SS1.p3.17.m17.1.1.2.cmml">x</mi><mo id="S3.SS1.p3.17.m17.1.1.1" xref="S3.SS1.p3.17.m17.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.17.m17.1.1.3" xref="S3.SS1.p3.17.m17.1.1.3.cmml"><mi id="S3.SS1.p3.17.m17.1.1.3.2" xref="S3.SS1.p3.17.m17.1.1.3.2.cmml">X</mi><mo id="S3.SS1.p3.17.m17.1.1.3.3" xref="S3.SS1.p3.17.m17.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.17.m17.1b"><apply id="S3.SS1.p3.17.m17.1.1.cmml" xref="S3.SS1.p3.17.m17.1.1"><in id="S3.SS1.p3.17.m17.1.1.1.cmml" xref="S3.SS1.p3.17.m17.1.1.1"></in><ci id="S3.SS1.p3.17.m17.1.1.2.cmml" xref="S3.SS1.p3.17.m17.1.1.2">𝑥</ci><apply id="S3.SS1.p3.17.m17.1.1.3.cmml" xref="S3.SS1.p3.17.m17.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.17.m17.1.1.3.1.cmml" xref="S3.SS1.p3.17.m17.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.17.m17.1.1.3.2.cmml" xref="S3.SS1.p3.17.m17.1.1.3.2">𝑋</ci><ci id="S3.SS1.p3.17.m17.1.1.3.3.cmml" xref="S3.SS1.p3.17.m17.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.17.m17.1c">x\in X^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.17.m17.1d">italic_x ∈ italic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. So we have shown that <math alttext="X_{K}=X^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p3.18.m18.1"><semantics id="S3.SS1.p3.18.m18.1a"><mrow id="S3.SS1.p3.18.m18.1.1" xref="S3.SS1.p3.18.m18.1.1.cmml"><msub id="S3.SS1.p3.18.m18.1.1.2" xref="S3.SS1.p3.18.m18.1.1.2.cmml"><mi id="S3.SS1.p3.18.m18.1.1.2.2" xref="S3.SS1.p3.18.m18.1.1.2.2.cmml">X</mi><mi id="S3.SS1.p3.18.m18.1.1.2.3" xref="S3.SS1.p3.18.m18.1.1.2.3.cmml">K</mi></msub><mo id="S3.SS1.p3.18.m18.1.1.1" xref="S3.SS1.p3.18.m18.1.1.1.cmml">=</mo><msup id="S3.SS1.p3.18.m18.1.1.3" xref="S3.SS1.p3.18.m18.1.1.3.cmml"><mi id="S3.SS1.p3.18.m18.1.1.3.2" xref="S3.SS1.p3.18.m18.1.1.3.2.cmml">X</mi><mo id="S3.SS1.p3.18.m18.1.1.3.3" xref="S3.SS1.p3.18.m18.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.18.m18.1b"><apply id="S3.SS1.p3.18.m18.1.1.cmml" xref="S3.SS1.p3.18.m18.1.1"><eq id="S3.SS1.p3.18.m18.1.1.1.cmml" xref="S3.SS1.p3.18.m18.1.1.1"></eq><apply id="S3.SS1.p3.18.m18.1.1.2.cmml" xref="S3.SS1.p3.18.m18.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.18.m18.1.1.2.1.cmml" xref="S3.SS1.p3.18.m18.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.18.m18.1.1.2.2.cmml" xref="S3.SS1.p3.18.m18.1.1.2.2">𝑋</ci><ci id="S3.SS1.p3.18.m18.1.1.2.3.cmml" xref="S3.SS1.p3.18.m18.1.1.2.3">𝐾</ci></apply><apply id="S3.SS1.p3.18.m18.1.1.3.cmml" xref="S3.SS1.p3.18.m18.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.18.m18.1.1.3.1.cmml" xref="S3.SS1.p3.18.m18.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.18.m18.1.1.3.2.cmml" xref="S3.SS1.p3.18.m18.1.1.3.2">𝑋</ci><ci id="S3.SS1.p3.18.m18.1.1.3.3.cmml" xref="S3.SS1.p3.18.m18.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.18.m18.1c">X_{K}=X^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.18.m18.1d">italic_X start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT = italic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Approximate algorithms</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.3">In the exact algorithm shown in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#alg1" title="Algorithm 1 ‣ 3.1 Exact algorithm ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">1</span></a>, we need to retrieve all the items with a dot product higher than or equal to a threshold. When the threshold is a loose filter of the item set, which may happen when the dot product scores are skewed, <math alttext="G^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msup id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">G</mi><mo id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝐺</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">G^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_G start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> can be large, and the evaluation of <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.3.1">MoL</span> over a large set of candidate items can still be expensive. Here, we describe two heuristics to approximately retrieve the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_K</annotation></semantics></math> items and analyze their gap against the exact top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_K</annotation></semantics></math> algorithm.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.4">In both heuristics, we perform a two-stage retrieval as shown in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#alg2" title="Algorithm 2 ‣ 3.2 Approximate algorithms ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">2</span></a>. In the first stage, we retrieve a set of <math alttext="K^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msup id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">K</mi><mo id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐾</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">K^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_K start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> candidate items that are potentially high in <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.4.1">MoL</span> score by using dot products (line 2). Note that <math alttext="K^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msup id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">K</mi><mo id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐾</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">K^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_K start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> can be larger than <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_K</annotation></semantics></math>, e.g., due to oversampling. In the second stage, we evaluate the <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.4.2">MoL</span> scores of the candidate items and return the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_K</annotation></semantics></math> items (line 3).</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.7.1.1">Algorithm 2</span> </span> Approximate top <math alttext="K" class="ltx_Math" display="inline" id="alg2.2.m1.1"><semantics id="alg2.2.m1.1b"><mi id="alg2.2.m1.1.1" xref="alg2.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.2.m1.1c"><ci id="alg2.2.m1.1.1.cmml" xref="alg2.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="alg2.2.m1.1e">italic_K</annotation></semantics></math> algorithms.</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.8">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text" id="alg2.l1.2" style="font-size:90%;">a query </span><math alttext="q" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" mathsize="90%" xref="alg2.l1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">italic_q</annotation></semantics></math><span class="ltx_text" id="alg2.l1.3" style="font-size:90%;">, a set of items </span><math alttext="X" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><mi id="alg2.l1.m2.1.1" mathsize="90%" xref="alg2.l1.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">italic_X</annotation></semantics></math><span class="ltx_text" id="alg2.l1.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text" id="alg2.l2.2" style="font-size:90%;">approximate top </span><math alttext="K" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mi id="alg2.l2.m1.1.1" mathsize="90%" xref="alg2.l2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">italic_K</annotation></semantics></math><span class="ltx_text" id="alg2.l2.3" style="font-size:90%;"> items
</span>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l3.2" style="font-size:90%;">function</span><span class="ltx_text" id="alg2.l3.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg2.l3.4" style="font-size:90%;">ApproxTopK</span><span class="ltx_text" id="alg2.l3.5" style="font-size:90%;">(</span><math alttext="q,X,K,K^{\prime}" class="ltx_Math" display="inline" id="alg2.l3.m1.4"><semantics id="alg2.l3.m1.4a"><mrow id="alg2.l3.m1.4.4.1" xref="alg2.l3.m1.4.4.2.cmml"><mi id="alg2.l3.m1.1.1" mathsize="90%" xref="alg2.l3.m1.1.1.cmml">q</mi><mo id="alg2.l3.m1.4.4.1.2" mathsize="90%" xref="alg2.l3.m1.4.4.2.cmml">,</mo><mi id="alg2.l3.m1.2.2" mathsize="90%" xref="alg2.l3.m1.2.2.cmml">X</mi><mo id="alg2.l3.m1.4.4.1.3" mathsize="90%" xref="alg2.l3.m1.4.4.2.cmml">,</mo><mi id="alg2.l3.m1.3.3" mathsize="90%" xref="alg2.l3.m1.3.3.cmml">K</mi><mo id="alg2.l3.m1.4.4.1.4" mathsize="90%" xref="alg2.l3.m1.4.4.2.cmml">,</mo><msup id="alg2.l3.m1.4.4.1.1" xref="alg2.l3.m1.4.4.1.1.cmml"><mi id="alg2.l3.m1.4.4.1.1.2" mathsize="90%" xref="alg2.l3.m1.4.4.1.1.2.cmml">K</mi><mo id="alg2.l3.m1.4.4.1.1.3" mathsize="90%" xref="alg2.l3.m1.4.4.1.1.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.4b"><list id="alg2.l3.m1.4.4.2.cmml" xref="alg2.l3.m1.4.4.1"><ci id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">𝑞</ci><ci id="alg2.l3.m1.2.2.cmml" xref="alg2.l3.m1.2.2">𝑋</ci><ci id="alg2.l3.m1.3.3.cmml" xref="alg2.l3.m1.3.3">𝐾</ci><apply id="alg2.l3.m1.4.4.1.1.cmml" xref="alg2.l3.m1.4.4.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.4.4.1.1.1.cmml" xref="alg2.l3.m1.4.4.1.1">superscript</csymbol><ci id="alg2.l3.m1.4.4.1.1.2.cmml" xref="alg2.l3.m1.4.4.1.1.2">𝐾</ci><ci id="alg2.l3.m1.4.4.1.1.3.cmml" xref="alg2.l3.m1.4.4.1.1.3">′</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.4c">q,X,K,K^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.4d">italic_q , italic_X , italic_K , italic_K start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg2.l3.6" style="font-size:90%;">)
</span>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4.3.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text" id="alg2.l4.4" style="font-size:90%;">    </span><math alttext="G\leftarrow TopKCandidate(q,X,K^{\prime})" class="ltx_Math" display="inline" id="alg2.l4.m1.3"><semantics id="alg2.l4.m1.3a"><mrow id="alg2.l4.m1.3.3" xref="alg2.l4.m1.3.3.cmml"><mi id="alg2.l4.m1.3.3.3" mathsize="90%" xref="alg2.l4.m1.3.3.3.cmml">G</mi><mo id="alg2.l4.m1.3.3.2" mathsize="90%" stretchy="false" xref="alg2.l4.m1.3.3.2.cmml">←</mo><mrow id="alg2.l4.m1.3.3.1" xref="alg2.l4.m1.3.3.1.cmml"><mi id="alg2.l4.m1.3.3.1.3" mathsize="90%" xref="alg2.l4.m1.3.3.1.3.cmml">T</mi><mo id="alg2.l4.m1.3.3.1.2" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg2.l4.m1.3.3.1.4" mathsize="90%" xref="alg2.l4.m1.3.3.1.4.cmml">o</mi><mo id="alg2.l4.m1.3.3.1.2a" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg2.l4.m1.3.3.1.5" mathsize="90%" xref="alg2.l4.m1.3.3.1.5.cmml">p</mi><mo id="alg2.l4.m1.3.3.1.2b" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg2.l4.m1.3.3.1.6" mathsize="90%" xref="alg2.l4.m1.3.3.1.6.cmml">K</mi><mo id="alg2.l4.m1.3.3.1.2c" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg2.l4.m1.3.3.1.7" mathsize="90%" xref="alg2.l4.m1.3.3.1.7.cmml">C</mi><mo id="alg2.l4.m1.3.3.1.2d" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg2.l4.m1.3.3.1.8" mathsize="90%" xref="alg2.l4.m1.3.3.1.8.cmml">a</mi><mo id="alg2.l4.m1.3.3.1.2e" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg2.l4.m1.3.3.1.9" mathsize="90%" xref="alg2.l4.m1.3.3.1.9.cmml">n</mi><mo id="alg2.l4.m1.3.3.1.2f" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg2.l4.m1.3.3.1.10" mathsize="90%" xref="alg2.l4.m1.3.3.1.10.cmml">d</mi><mo id="alg2.l4.m1.3.3.1.2g" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg2.l4.m1.3.3.1.11" mathsize="90%" xref="alg2.l4.m1.3.3.1.11.cmml">i</mi><mo id="alg2.l4.m1.3.3.1.2h" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg2.l4.m1.3.3.1.12" mathsize="90%" xref="alg2.l4.m1.3.3.1.12.cmml">d</mi><mo id="alg2.l4.m1.3.3.1.2i" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg2.l4.m1.3.3.1.13" mathsize="90%" xref="alg2.l4.m1.3.3.1.13.cmml">a</mi><mo id="alg2.l4.m1.3.3.1.2j" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg2.l4.m1.3.3.1.14" mathsize="90%" xref="alg2.l4.m1.3.3.1.14.cmml">t</mi><mo id="alg2.l4.m1.3.3.1.2k" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg2.l4.m1.3.3.1.15" mathsize="90%" xref="alg2.l4.m1.3.3.1.15.cmml">e</mi><mo id="alg2.l4.m1.3.3.1.2l" xref="alg2.l4.m1.3.3.1.2.cmml">⁢</mo><mrow id="alg2.l4.m1.3.3.1.1.1" xref="alg2.l4.m1.3.3.1.1.2.cmml"><mo id="alg2.l4.m1.3.3.1.1.1.2" maxsize="90%" minsize="90%" xref="alg2.l4.m1.3.3.1.1.2.cmml">(</mo><mi id="alg2.l4.m1.1.1" mathsize="90%" xref="alg2.l4.m1.1.1.cmml">q</mi><mo id="alg2.l4.m1.3.3.1.1.1.3" mathsize="90%" xref="alg2.l4.m1.3.3.1.1.2.cmml">,</mo><mi id="alg2.l4.m1.2.2" mathsize="90%" xref="alg2.l4.m1.2.2.cmml">X</mi><mo id="alg2.l4.m1.3.3.1.1.1.4" mathsize="90%" xref="alg2.l4.m1.3.3.1.1.2.cmml">,</mo><msup id="alg2.l4.m1.3.3.1.1.1.1" xref="alg2.l4.m1.3.3.1.1.1.1.cmml"><mi id="alg2.l4.m1.3.3.1.1.1.1.2" mathsize="90%" xref="alg2.l4.m1.3.3.1.1.1.1.2.cmml">K</mi><mo id="alg2.l4.m1.3.3.1.1.1.1.3" mathsize="90%" xref="alg2.l4.m1.3.3.1.1.1.1.3.cmml">′</mo></msup><mo id="alg2.l4.m1.3.3.1.1.1.5" maxsize="90%" minsize="90%" xref="alg2.l4.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.3b"><apply id="alg2.l4.m1.3.3.cmml" xref="alg2.l4.m1.3.3"><ci id="alg2.l4.m1.3.3.2.cmml" xref="alg2.l4.m1.3.3.2">←</ci><ci id="alg2.l4.m1.3.3.3.cmml" xref="alg2.l4.m1.3.3.3">𝐺</ci><apply id="alg2.l4.m1.3.3.1.cmml" xref="alg2.l4.m1.3.3.1"><times id="alg2.l4.m1.3.3.1.2.cmml" xref="alg2.l4.m1.3.3.1.2"></times><ci id="alg2.l4.m1.3.3.1.3.cmml" xref="alg2.l4.m1.3.3.1.3">𝑇</ci><ci id="alg2.l4.m1.3.3.1.4.cmml" xref="alg2.l4.m1.3.3.1.4">𝑜</ci><ci id="alg2.l4.m1.3.3.1.5.cmml" xref="alg2.l4.m1.3.3.1.5">𝑝</ci><ci id="alg2.l4.m1.3.3.1.6.cmml" xref="alg2.l4.m1.3.3.1.6">𝐾</ci><ci id="alg2.l4.m1.3.3.1.7.cmml" xref="alg2.l4.m1.3.3.1.7">𝐶</ci><ci id="alg2.l4.m1.3.3.1.8.cmml" xref="alg2.l4.m1.3.3.1.8">𝑎</ci><ci id="alg2.l4.m1.3.3.1.9.cmml" xref="alg2.l4.m1.3.3.1.9">𝑛</ci><ci id="alg2.l4.m1.3.3.1.10.cmml" xref="alg2.l4.m1.3.3.1.10">𝑑</ci><ci id="alg2.l4.m1.3.3.1.11.cmml" xref="alg2.l4.m1.3.3.1.11">𝑖</ci><ci id="alg2.l4.m1.3.3.1.12.cmml" xref="alg2.l4.m1.3.3.1.12">𝑑</ci><ci id="alg2.l4.m1.3.3.1.13.cmml" xref="alg2.l4.m1.3.3.1.13">𝑎</ci><ci id="alg2.l4.m1.3.3.1.14.cmml" xref="alg2.l4.m1.3.3.1.14">𝑡</ci><ci id="alg2.l4.m1.3.3.1.15.cmml" xref="alg2.l4.m1.3.3.1.15">𝑒</ci><vector id="alg2.l4.m1.3.3.1.1.2.cmml" xref="alg2.l4.m1.3.3.1.1.1"><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝑞</ci><ci id="alg2.l4.m1.2.2.cmml" xref="alg2.l4.m1.2.2">𝑋</ci><apply id="alg2.l4.m1.3.3.1.1.1.1.cmml" xref="alg2.l4.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l4.m1.3.3.1.1.1.1">superscript</csymbol><ci id="alg2.l4.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l4.m1.3.3.1.1.1.1.2">𝐾</ci><ci id="alg2.l4.m1.3.3.1.1.1.1.3.cmml" xref="alg2.l4.m1.3.3.1.1.1.1.3">′</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.3c">G\leftarrow TopKCandidate(q,X,K^{\prime})</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.3d">italic_G ← italic_T italic_o italic_p italic_K italic_C italic_a italic_n italic_d italic_i italic_d italic_a italic_t italic_e ( italic_q , italic_X , italic_K start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg2.l4.5" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l4.2" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l4.1.m1.1"><semantics id="alg2.l4.1.m1.1a"><mo id="alg2.l4.1.m1.1.1" xref="alg2.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l4.1.m1.1b"><ci id="alg2.l4.1.m1.1.1.cmml" xref="alg2.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.1.m1.1d">▷</annotation></semantics></math> Retrieve the top <math alttext="K^{\prime}" class="ltx_Math" display="inline" id="alg2.l4.2.m2.1"><semantics id="alg2.l4.2.m2.1a"><msup id="alg2.l4.2.m2.1.1" xref="alg2.l4.2.m2.1.1.cmml"><mi id="alg2.l4.2.m2.1.1.2" xref="alg2.l4.2.m2.1.1.2.cmml">K</mi><mo id="alg2.l4.2.m2.1.1.3" xref="alg2.l4.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l4.2.m2.1b"><apply id="alg2.l4.2.m2.1.1.cmml" xref="alg2.l4.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l4.2.m2.1.1.1.cmml" xref="alg2.l4.2.m2.1.1">superscript</csymbol><ci id="alg2.l4.2.m2.1.1.2.cmml" xref="alg2.l4.2.m2.1.1.2">𝐾</ci><ci id="alg2.l4.2.m2.1.1.3.cmml" xref="alg2.l4.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.2.m2.1c">K^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.2.m2.1d">italic_K start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> candidate items
</span>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l5.3.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text" id="alg2.l5.4" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg2.l5.5" style="font-size:90%;">return</span><span class="ltx_text" id="alg2.l5.6" style="font-size:90%;"> </span><math alttext="BruteForceTopKMoL(q,G,K)" class="ltx_Math" display="inline" id="alg2.l5.m1.3"><semantics id="alg2.l5.m1.3a"><mrow id="alg2.l5.m1.3.4" xref="alg2.l5.m1.3.4.cmml"><mi id="alg2.l5.m1.3.4.2" mathsize="90%" xref="alg2.l5.m1.3.4.2.cmml">B</mi><mo id="alg2.l5.m1.3.4.1" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.3" mathsize="90%" xref="alg2.l5.m1.3.4.3.cmml">r</mi><mo id="alg2.l5.m1.3.4.1a" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.4" mathsize="90%" xref="alg2.l5.m1.3.4.4.cmml">u</mi><mo id="alg2.l5.m1.3.4.1b" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.5" mathsize="90%" xref="alg2.l5.m1.3.4.5.cmml">t</mi><mo id="alg2.l5.m1.3.4.1c" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.6" mathsize="90%" xref="alg2.l5.m1.3.4.6.cmml">e</mi><mo id="alg2.l5.m1.3.4.1d" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.7" mathsize="90%" xref="alg2.l5.m1.3.4.7.cmml">F</mi><mo id="alg2.l5.m1.3.4.1e" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.8" mathsize="90%" xref="alg2.l5.m1.3.4.8.cmml">o</mi><mo id="alg2.l5.m1.3.4.1f" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.9" mathsize="90%" xref="alg2.l5.m1.3.4.9.cmml">r</mi><mo id="alg2.l5.m1.3.4.1g" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.10" mathsize="90%" xref="alg2.l5.m1.3.4.10.cmml">c</mi><mo id="alg2.l5.m1.3.4.1h" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.11" mathsize="90%" xref="alg2.l5.m1.3.4.11.cmml">e</mi><mo id="alg2.l5.m1.3.4.1i" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.12" mathsize="90%" xref="alg2.l5.m1.3.4.12.cmml">T</mi><mo id="alg2.l5.m1.3.4.1j" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.13" mathsize="90%" xref="alg2.l5.m1.3.4.13.cmml">o</mi><mo id="alg2.l5.m1.3.4.1k" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.14" mathsize="90%" xref="alg2.l5.m1.3.4.14.cmml">p</mi><mo id="alg2.l5.m1.3.4.1l" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.15" mathsize="90%" xref="alg2.l5.m1.3.4.15.cmml">K</mi><mo id="alg2.l5.m1.3.4.1m" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.16" mathsize="90%" xref="alg2.l5.m1.3.4.16.cmml">M</mi><mo id="alg2.l5.m1.3.4.1n" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.17" mathsize="90%" xref="alg2.l5.m1.3.4.17.cmml">o</mi><mo id="alg2.l5.m1.3.4.1o" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mi id="alg2.l5.m1.3.4.18" mathsize="90%" xref="alg2.l5.m1.3.4.18.cmml">L</mi><mo id="alg2.l5.m1.3.4.1p" xref="alg2.l5.m1.3.4.1.cmml">⁢</mo><mrow id="alg2.l5.m1.3.4.19.2" xref="alg2.l5.m1.3.4.19.1.cmml"><mo id="alg2.l5.m1.3.4.19.2.1" maxsize="90%" minsize="90%" xref="alg2.l5.m1.3.4.19.1.cmml">(</mo><mi id="alg2.l5.m1.1.1" mathsize="90%" xref="alg2.l5.m1.1.1.cmml">q</mi><mo id="alg2.l5.m1.3.4.19.2.2" mathsize="90%" xref="alg2.l5.m1.3.4.19.1.cmml">,</mo><mi id="alg2.l5.m1.2.2" mathsize="90%" xref="alg2.l5.m1.2.2.cmml">G</mi><mo id="alg2.l5.m1.3.4.19.2.3" mathsize="90%" xref="alg2.l5.m1.3.4.19.1.cmml">,</mo><mi id="alg2.l5.m1.3.3" mathsize="90%" xref="alg2.l5.m1.3.3.cmml">K</mi><mo id="alg2.l5.m1.3.4.19.2.4" maxsize="90%" minsize="90%" xref="alg2.l5.m1.3.4.19.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.3b"><apply id="alg2.l5.m1.3.4.cmml" xref="alg2.l5.m1.3.4"><times id="alg2.l5.m1.3.4.1.cmml" xref="alg2.l5.m1.3.4.1"></times><ci id="alg2.l5.m1.3.4.2.cmml" xref="alg2.l5.m1.3.4.2">𝐵</ci><ci id="alg2.l5.m1.3.4.3.cmml" xref="alg2.l5.m1.3.4.3">𝑟</ci><ci id="alg2.l5.m1.3.4.4.cmml" xref="alg2.l5.m1.3.4.4">𝑢</ci><ci id="alg2.l5.m1.3.4.5.cmml" xref="alg2.l5.m1.3.4.5">𝑡</ci><ci id="alg2.l5.m1.3.4.6.cmml" xref="alg2.l5.m1.3.4.6">𝑒</ci><ci id="alg2.l5.m1.3.4.7.cmml" xref="alg2.l5.m1.3.4.7">𝐹</ci><ci id="alg2.l5.m1.3.4.8.cmml" xref="alg2.l5.m1.3.4.8">𝑜</ci><ci id="alg2.l5.m1.3.4.9.cmml" xref="alg2.l5.m1.3.4.9">𝑟</ci><ci id="alg2.l5.m1.3.4.10.cmml" xref="alg2.l5.m1.3.4.10">𝑐</ci><ci id="alg2.l5.m1.3.4.11.cmml" xref="alg2.l5.m1.3.4.11">𝑒</ci><ci id="alg2.l5.m1.3.4.12.cmml" xref="alg2.l5.m1.3.4.12">𝑇</ci><ci id="alg2.l5.m1.3.4.13.cmml" xref="alg2.l5.m1.3.4.13">𝑜</ci><ci id="alg2.l5.m1.3.4.14.cmml" xref="alg2.l5.m1.3.4.14">𝑝</ci><ci id="alg2.l5.m1.3.4.15.cmml" xref="alg2.l5.m1.3.4.15">𝐾</ci><ci id="alg2.l5.m1.3.4.16.cmml" xref="alg2.l5.m1.3.4.16">𝑀</ci><ci id="alg2.l5.m1.3.4.17.cmml" xref="alg2.l5.m1.3.4.17">𝑜</ci><ci id="alg2.l5.m1.3.4.18.cmml" xref="alg2.l5.m1.3.4.18">𝐿</ci><vector id="alg2.l5.m1.3.4.19.1.cmml" xref="alg2.l5.m1.3.4.19.2"><ci id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">𝑞</ci><ci id="alg2.l5.m1.2.2.cmml" xref="alg2.l5.m1.2.2">𝐺</ci><ci id="alg2.l5.m1.3.3.cmml" xref="alg2.l5.m1.3.3">𝐾</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.3c">BruteForceTopKMoL(q,G,K)</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.3d">italic_B italic_r italic_u italic_t italic_e italic_F italic_o italic_r italic_c italic_e italic_T italic_o italic_p italic_K italic_M italic_o italic_L ( italic_q , italic_G , italic_K )</annotation></semantics></math><span class="ltx_text" id="alg2.l5.2" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l5.1.m1.1"><semantics id="alg2.l5.1.m1.1a"><mo id="alg2.l5.1.m1.1.1" xref="alg2.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l5.1.m1.1b"><ci id="alg2.l5.1.m1.1.1.cmml" xref="alg2.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.1.m1.1d">▷</annotation></semantics></math> Retrieve the top <math alttext="K" class="ltx_Math" display="inline" id="alg2.l5.2.m2.1"><semantics id="alg2.l5.2.m2.1a"><mi id="alg2.l5.2.m2.1.1" xref="alg2.l5.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.2.m2.1b"><ci id="alg2.l5.2.m2.1.1.cmml" xref="alg2.l5.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.2.m2.1d">italic_K</annotation></semantics></math> items with <span class="ltx_text ltx_font_italic" id="alg2.l5.2.1">MoL</span>
</span>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l6.1.1.1" style="font-size:80%;">6:</span></span><span class="ltx_text" id="alg2.l6.2" style="font-size:90%;">a query </span><math alttext="q" class="ltx_Math" display="inline" id="alg2.l6.m1.1"><semantics id="alg2.l6.m1.1a"><mi id="alg2.l6.m1.1.1" mathsize="90%" xref="alg2.l6.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.1d">italic_q</annotation></semantics></math><span class="ltx_text" id="alg2.l6.3" style="font-size:90%;">, a set of items </span><math alttext="X" class="ltx_Math" display="inline" id="alg2.l6.m2.1"><semantics id="alg2.l6.m2.1a"><mi id="alg2.l6.m2.1.1" mathsize="90%" xref="alg2.l6.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><ci id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m2.1d">italic_X</annotation></semantics></math><span class="ltx_text" id="alg2.l6.4" style="font-size:90%;">, </span><math alttext="f_{p}(\cdot)" class="ltx_Math" display="inline" id="alg2.l6.m3.1"><semantics id="alg2.l6.m3.1a"><mrow id="alg2.l6.m3.1.2" xref="alg2.l6.m3.1.2.cmml"><msub id="alg2.l6.m3.1.2.2" xref="alg2.l6.m3.1.2.2.cmml"><mi id="alg2.l6.m3.1.2.2.2" mathsize="90%" xref="alg2.l6.m3.1.2.2.2.cmml">f</mi><mi id="alg2.l6.m3.1.2.2.3" mathsize="90%" xref="alg2.l6.m3.1.2.2.3.cmml">p</mi></msub><mo id="alg2.l6.m3.1.2.1" xref="alg2.l6.m3.1.2.1.cmml">⁢</mo><mrow id="alg2.l6.m3.1.2.3.2" xref="alg2.l6.m3.1.2.cmml"><mo id="alg2.l6.m3.1.2.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l6.m3.1.2.cmml">(</mo><mo id="alg2.l6.m3.1.1" lspace="0em" mathsize="90%" rspace="0em" xref="alg2.l6.m3.1.1.cmml">⋅</mo><mo id="alg2.l6.m3.1.2.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l6.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m3.1b"><apply id="alg2.l6.m3.1.2.cmml" xref="alg2.l6.m3.1.2"><times id="alg2.l6.m3.1.2.1.cmml" xref="alg2.l6.m3.1.2.1"></times><apply id="alg2.l6.m3.1.2.2.cmml" xref="alg2.l6.m3.1.2.2"><csymbol cd="ambiguous" id="alg2.l6.m3.1.2.2.1.cmml" xref="alg2.l6.m3.1.2.2">subscript</csymbol><ci id="alg2.l6.m3.1.2.2.2.cmml" xref="alg2.l6.m3.1.2.2.2">𝑓</ci><ci id="alg2.l6.m3.1.2.2.3.cmml" xref="alg2.l6.m3.1.2.2.3">𝑝</ci></apply><ci id="alg2.l6.m3.1.1.cmml" xref="alg2.l6.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m3.1c">f_{p}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m3.1d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math><span class="ltx_text" id="alg2.l6.5" style="font-size:90%;">, </span><math alttext="g_{p}(\cdot)" class="ltx_Math" display="inline" id="alg2.l6.m4.1"><semantics id="alg2.l6.m4.1a"><mrow id="alg2.l6.m4.1.2" xref="alg2.l6.m4.1.2.cmml"><msub id="alg2.l6.m4.1.2.2" xref="alg2.l6.m4.1.2.2.cmml"><mi id="alg2.l6.m4.1.2.2.2" mathsize="90%" xref="alg2.l6.m4.1.2.2.2.cmml">g</mi><mi id="alg2.l6.m4.1.2.2.3" mathsize="90%" xref="alg2.l6.m4.1.2.2.3.cmml">p</mi></msub><mo id="alg2.l6.m4.1.2.1" xref="alg2.l6.m4.1.2.1.cmml">⁢</mo><mrow id="alg2.l6.m4.1.2.3.2" xref="alg2.l6.m4.1.2.cmml"><mo id="alg2.l6.m4.1.2.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l6.m4.1.2.cmml">(</mo><mo id="alg2.l6.m4.1.1" lspace="0em" mathsize="90%" rspace="0em" xref="alg2.l6.m4.1.1.cmml">⋅</mo><mo id="alg2.l6.m4.1.2.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l6.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m4.1b"><apply id="alg2.l6.m4.1.2.cmml" xref="alg2.l6.m4.1.2"><times id="alg2.l6.m4.1.2.1.cmml" xref="alg2.l6.m4.1.2.1"></times><apply id="alg2.l6.m4.1.2.2.cmml" xref="alg2.l6.m4.1.2.2"><csymbol cd="ambiguous" id="alg2.l6.m4.1.2.2.1.cmml" xref="alg2.l6.m4.1.2.2">subscript</csymbol><ci id="alg2.l6.m4.1.2.2.2.cmml" xref="alg2.l6.m4.1.2.2.2">𝑔</ci><ci id="alg2.l6.m4.1.2.2.3.cmml" xref="alg2.l6.m4.1.2.2.3">𝑝</ci></apply><ci id="alg2.l6.m4.1.1.cmml" xref="alg2.l6.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m4.1c">g_{p}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m4.1d">italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math><span class="ltx_text" id="alg2.l6.6" style="font-size:90%;"> for constructing the component-level embeddings </span><math alttext="f_{p}(q),g_{p}(x)" class="ltx_Math" display="inline" id="alg2.l6.m5.4"><semantics id="alg2.l6.m5.4a"><mrow id="alg2.l6.m5.4.4.2" xref="alg2.l6.m5.4.4.3.cmml"><mrow id="alg2.l6.m5.3.3.1.1" xref="alg2.l6.m5.3.3.1.1.cmml"><msub id="alg2.l6.m5.3.3.1.1.2" xref="alg2.l6.m5.3.3.1.1.2.cmml"><mi id="alg2.l6.m5.3.3.1.1.2.2" mathsize="90%" xref="alg2.l6.m5.3.3.1.1.2.2.cmml">f</mi><mi id="alg2.l6.m5.3.3.1.1.2.3" mathsize="90%" xref="alg2.l6.m5.3.3.1.1.2.3.cmml">p</mi></msub><mo id="alg2.l6.m5.3.3.1.1.1" xref="alg2.l6.m5.3.3.1.1.1.cmml">⁢</mo><mrow id="alg2.l6.m5.3.3.1.1.3.2" xref="alg2.l6.m5.3.3.1.1.cmml"><mo id="alg2.l6.m5.3.3.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l6.m5.3.3.1.1.cmml">(</mo><mi id="alg2.l6.m5.1.1" mathsize="90%" xref="alg2.l6.m5.1.1.cmml">q</mi><mo id="alg2.l6.m5.3.3.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l6.m5.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l6.m5.4.4.2.3" mathsize="90%" xref="alg2.l6.m5.4.4.3.cmml">,</mo><mrow id="alg2.l6.m5.4.4.2.2" xref="alg2.l6.m5.4.4.2.2.cmml"><msub id="alg2.l6.m5.4.4.2.2.2" xref="alg2.l6.m5.4.4.2.2.2.cmml"><mi id="alg2.l6.m5.4.4.2.2.2.2" mathsize="90%" xref="alg2.l6.m5.4.4.2.2.2.2.cmml">g</mi><mi id="alg2.l6.m5.4.4.2.2.2.3" mathsize="90%" xref="alg2.l6.m5.4.4.2.2.2.3.cmml">p</mi></msub><mo id="alg2.l6.m5.4.4.2.2.1" xref="alg2.l6.m5.4.4.2.2.1.cmml">⁢</mo><mrow id="alg2.l6.m5.4.4.2.2.3.2" xref="alg2.l6.m5.4.4.2.2.cmml"><mo id="alg2.l6.m5.4.4.2.2.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l6.m5.4.4.2.2.cmml">(</mo><mi id="alg2.l6.m5.2.2" mathsize="90%" xref="alg2.l6.m5.2.2.cmml">x</mi><mo id="alg2.l6.m5.4.4.2.2.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l6.m5.4.4.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m5.4b"><list id="alg2.l6.m5.4.4.3.cmml" xref="alg2.l6.m5.4.4.2"><apply id="alg2.l6.m5.3.3.1.1.cmml" xref="alg2.l6.m5.3.3.1.1"><times id="alg2.l6.m5.3.3.1.1.1.cmml" xref="alg2.l6.m5.3.3.1.1.1"></times><apply id="alg2.l6.m5.3.3.1.1.2.cmml" xref="alg2.l6.m5.3.3.1.1.2"><csymbol cd="ambiguous" id="alg2.l6.m5.3.3.1.1.2.1.cmml" xref="alg2.l6.m5.3.3.1.1.2">subscript</csymbol><ci id="alg2.l6.m5.3.3.1.1.2.2.cmml" xref="alg2.l6.m5.3.3.1.1.2.2">𝑓</ci><ci id="alg2.l6.m5.3.3.1.1.2.3.cmml" xref="alg2.l6.m5.3.3.1.1.2.3">𝑝</ci></apply><ci id="alg2.l6.m5.1.1.cmml" xref="alg2.l6.m5.1.1">𝑞</ci></apply><apply id="alg2.l6.m5.4.4.2.2.cmml" xref="alg2.l6.m5.4.4.2.2"><times id="alg2.l6.m5.4.4.2.2.1.cmml" xref="alg2.l6.m5.4.4.2.2.1"></times><apply id="alg2.l6.m5.4.4.2.2.2.cmml" xref="alg2.l6.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="alg2.l6.m5.4.4.2.2.2.1.cmml" xref="alg2.l6.m5.4.4.2.2.2">subscript</csymbol><ci id="alg2.l6.m5.4.4.2.2.2.2.cmml" xref="alg2.l6.m5.4.4.2.2.2.2">𝑔</ci><ci id="alg2.l6.m5.4.4.2.2.2.3.cmml" xref="alg2.l6.m5.4.4.2.2.2.3">𝑝</ci></apply><ci id="alg2.l6.m5.2.2.cmml" xref="alg2.l6.m5.2.2">𝑥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m5.4c">f_{p}(q),g_{p}(x)</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m5.4d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math><span class="ltx_text" id="alg2.l6.7" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l7.1.1.1" style="font-size:80%;">7:</span></span><span class="ltx_text" id="alg2.l7.2" style="font-size:90%;">union of top </span><math alttext="K" class="ltx_Math" display="inline" id="alg2.l7.m1.1"><semantics id="alg2.l7.m1.1a"><mi id="alg2.l7.m1.1.1" mathsize="90%" xref="alg2.l7.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.1d">italic_K</annotation></semantics></math><span class="ltx_text" id="alg2.l7.3" style="font-size:90%;"> items over </span><math alttext="P" class="ltx_Math" display="inline" id="alg2.l7.m2.1"><semantics id="alg2.l7.m2.1a"><mi id="alg2.l7.m2.1.1" mathsize="90%" xref="alg2.l7.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.1b"><ci id="alg2.l7.m2.1.1.cmml" xref="alg2.l7.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m2.1d">italic_P</annotation></semantics></math><span class="ltx_text" id="alg2.l7.4" style="font-size:90%;"> component-level embeddings by dot product
</span>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l8.1.1.1" style="font-size:80%;">8:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l8.2" style="font-size:90%;">function</span><span class="ltx_text" id="alg2.l8.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg2.l8.4" style="font-size:90%;">TopKPerEmbedding</span><span class="ltx_text" id="alg2.l8.5" style="font-size:90%;">(</span><math alttext="q,X,K" class="ltx_Math" display="inline" id="alg2.l8.m1.3"><semantics id="alg2.l8.m1.3a"><mrow id="alg2.l8.m1.3.4.2" xref="alg2.l8.m1.3.4.1.cmml"><mi id="alg2.l8.m1.1.1" mathsize="90%" xref="alg2.l8.m1.1.1.cmml">q</mi><mo id="alg2.l8.m1.3.4.2.1" mathsize="90%" xref="alg2.l8.m1.3.4.1.cmml">,</mo><mi id="alg2.l8.m1.2.2" mathsize="90%" xref="alg2.l8.m1.2.2.cmml">X</mi><mo id="alg2.l8.m1.3.4.2.2" mathsize="90%" xref="alg2.l8.m1.3.4.1.cmml">,</mo><mi id="alg2.l8.m1.3.3" mathsize="90%" xref="alg2.l8.m1.3.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.3b"><list id="alg2.l8.m1.3.4.1.cmml" xref="alg2.l8.m1.3.4.2"><ci id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">𝑞</ci><ci id="alg2.l8.m1.2.2.cmml" xref="alg2.l8.m1.2.2">𝑋</ci><ci id="alg2.l8.m1.3.3.cmml" xref="alg2.l8.m1.3.3">𝐾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.3c">q,X,K</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.3d">italic_q , italic_X , italic_K</annotation></semantics></math><span class="ltx_text" id="alg2.l8.6" style="font-size:90%;">)
</span>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text" id="alg2.l9.2" style="font-size:90%;">    </span><math alttext="G\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg2.l9.m1.1"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><mi id="alg2.l9.m1.1.1.2" mathsize="90%" xref="alg2.l9.m1.1.1.2.cmml">G</mi><mo id="alg2.l9.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.l9.m1.1.1.1.cmml">←</mo><mi id="alg2.l9.m1.1.1.3" mathsize="90%" mathvariant="normal" xref="alg2.l9.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><ci id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1">←</ci><ci id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2">𝐺</ci><emptyset id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">G\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.1d">italic_G ← ∅</annotation></semantics></math><span class="ltx_text" id="alg2.l9.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l10.1.1.1" style="font-size:80%;">10:</span></span><span class="ltx_text" id="alg2.l10.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg2.l10.3" style="font-size:90%;">for</span><span class="ltx_text" id="alg2.l10.4" style="font-size:90%;"> </span><math alttext="p\in P" class="ltx_Math" display="inline" id="alg2.l10.m1.1"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><mi id="alg2.l10.m1.1.1.2" mathsize="90%" xref="alg2.l10.m1.1.1.2.cmml">p</mi><mo id="alg2.l10.m1.1.1.1" mathsize="90%" xref="alg2.l10.m1.1.1.1.cmml">∈</mo><mi id="alg2.l10.m1.1.1.3" mathsize="90%" xref="alg2.l10.m1.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><in id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1"></in><ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">𝑝</ci><ci id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">p\in P</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.1d">italic_p ∈ italic_P</annotation></semantics></math><span class="ltx_text" id="alg2.l10.5" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.l10.6" style="font-size:90%;">do</span><span class="ltx_text" id="alg2.l10.7" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l11.2.1.1" style="font-size:80%;">11:</span></span><span class="ltx_text" id="alg2.l11.3" style="font-size:90%;">         </span><math alttext="X_{p}\leftarrow\{g_{p}(x),x\in X\}" class="ltx_Math" display="inline" id="alg2.l11.m1.3"><semantics id="alg2.l11.m1.3a"><mrow id="alg2.l11.m1.3.3" xref="alg2.l11.m1.3.3.cmml"><msub id="alg2.l11.m1.3.3.3" xref="alg2.l11.m1.3.3.3.cmml"><mi id="alg2.l11.m1.3.3.3.2" mathsize="90%" xref="alg2.l11.m1.3.3.3.2.cmml">X</mi><mi id="alg2.l11.m1.3.3.3.3" mathsize="90%" xref="alg2.l11.m1.3.3.3.3.cmml">p</mi></msub><mo id="alg2.l11.m1.3.3.2" mathsize="90%" stretchy="false" xref="alg2.l11.m1.3.3.2.cmml">←</mo><mrow id="alg2.l11.m1.3.3.1.1" xref="alg2.l11.m1.3.3.1.2.cmml"><mo id="alg2.l11.m1.3.3.1.1.2" maxsize="90%" minsize="90%" xref="alg2.l11.m1.3.3.1.2.cmml">{</mo><mrow id="alg2.l11.m1.3.3.1.1.1" xref="alg2.l11.m1.3.3.1.1.1.cmml"><mrow id="alg2.l11.m1.3.3.1.1.1.1.1" xref="alg2.l11.m1.3.3.1.1.1.1.2.cmml"><mrow id="alg2.l11.m1.3.3.1.1.1.1.1.1" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.cmml"><msub id="alg2.l11.m1.3.3.1.1.1.1.1.1.2" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="alg2.l11.m1.3.3.1.1.1.1.1.1.2.2" mathsize="90%" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="alg2.l11.m1.3.3.1.1.1.1.1.1.2.3" mathsize="90%" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="alg2.l11.m1.3.3.1.1.1.1.1.1.1" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="alg2.l11.m1.3.3.1.1.1.1.1.1.3.2" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.cmml"><mo id="alg2.l11.m1.3.3.1.1.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="alg2.l11.m1.1.1" mathsize="90%" xref="alg2.l11.m1.1.1.cmml">x</mi><mo id="alg2.l11.m1.3.3.1.1.1.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l11.m1.3.3.1.1.1.1.1.2" mathsize="90%" xref="alg2.l11.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="alg2.l11.m1.2.2" mathsize="90%" xref="alg2.l11.m1.2.2.cmml">x</mi></mrow><mo id="alg2.l11.m1.3.3.1.1.1.2" mathsize="90%" xref="alg2.l11.m1.3.3.1.1.1.2.cmml">∈</mo><mi id="alg2.l11.m1.3.3.1.1.1.3" mathsize="90%" xref="alg2.l11.m1.3.3.1.1.1.3.cmml">X</mi></mrow><mo id="alg2.l11.m1.3.3.1.1.3" maxsize="90%" minsize="90%" xref="alg2.l11.m1.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.3b"><apply id="alg2.l11.m1.3.3.cmml" xref="alg2.l11.m1.3.3"><ci id="alg2.l11.m1.3.3.2.cmml" xref="alg2.l11.m1.3.3.2">←</ci><apply id="alg2.l11.m1.3.3.3.cmml" xref="alg2.l11.m1.3.3.3"><csymbol cd="ambiguous" id="alg2.l11.m1.3.3.3.1.cmml" xref="alg2.l11.m1.3.3.3">subscript</csymbol><ci id="alg2.l11.m1.3.3.3.2.cmml" xref="alg2.l11.m1.3.3.3.2">𝑋</ci><ci id="alg2.l11.m1.3.3.3.3.cmml" xref="alg2.l11.m1.3.3.3.3">𝑝</ci></apply><set id="alg2.l11.m1.3.3.1.2.cmml" xref="alg2.l11.m1.3.3.1.1"><apply id="alg2.l11.m1.3.3.1.1.1.cmml" xref="alg2.l11.m1.3.3.1.1.1"><in id="alg2.l11.m1.3.3.1.1.1.2.cmml" xref="alg2.l11.m1.3.3.1.1.1.2"></in><list id="alg2.l11.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l11.m1.3.3.1.1.1.1.1"><apply id="alg2.l11.m1.3.3.1.1.1.1.1.1.cmml" xref="alg2.l11.m1.3.3.1.1.1.1.1.1"><times id="alg2.l11.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.1"></times><apply id="alg2.l11.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l11.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l11.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.2.2">𝑔</ci><ci id="alg2.l11.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="alg2.l11.m1.3.3.1.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1">𝑥</ci></apply><ci id="alg2.l11.m1.2.2.cmml" xref="alg2.l11.m1.2.2">𝑥</ci></list><ci id="alg2.l11.m1.3.3.1.1.1.3.cmml" xref="alg2.l11.m1.3.3.1.1.1.3">𝑋</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.3c">X_{p}\leftarrow\{g_{p}(x),x\in X\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m1.3d">italic_X start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ← { italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) , italic_x ∈ italic_X }</annotation></semantics></math><span class="ltx_text" id="alg2.l11.4" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l11.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l11.1.m1.1"><semantics id="alg2.l11.1.m1.1a"><mo id="alg2.l11.1.m1.1.1" xref="alg2.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l11.1.m1.1b"><ci id="alg2.l11.1.m1.1.1.cmml" xref="alg2.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.1.m1.1d">▷</annotation></semantics></math> Can be preprocessed and materialized.
</span>
</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l12.3.1.1" style="font-size:80%;">12:</span></span><span class="ltx_text" id="alg2.l12.4" style="font-size:90%;">         </span><math alttext="G\leftarrow G\cup TopKDotProduct(f_{p}(q),X_{p},K)" class="ltx_Math" display="inline" id="alg2.l12.m1.4"><semantics id="alg2.l12.m1.4a"><mrow id="alg2.l12.m1.4.4" xref="alg2.l12.m1.4.4.cmml"><mi id="alg2.l12.m1.4.4.4" mathsize="90%" xref="alg2.l12.m1.4.4.4.cmml">G</mi><mo id="alg2.l12.m1.4.4.3" mathsize="90%" stretchy="false" xref="alg2.l12.m1.4.4.3.cmml">←</mo><mrow id="alg2.l12.m1.4.4.2" xref="alg2.l12.m1.4.4.2.cmml"><mi id="alg2.l12.m1.4.4.2.4" mathsize="90%" xref="alg2.l12.m1.4.4.2.4.cmml">G</mi><mo id="alg2.l12.m1.4.4.2.3" mathsize="90%" xref="alg2.l12.m1.4.4.2.3.cmml">∪</mo><mrow id="alg2.l12.m1.4.4.2.2" xref="alg2.l12.m1.4.4.2.2.cmml"><mi id="alg2.l12.m1.4.4.2.2.4" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.4.cmml">T</mi><mo id="alg2.l12.m1.4.4.2.2.3" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.5" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.5.cmml">o</mi><mo id="alg2.l12.m1.4.4.2.2.3a" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.6" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.6.cmml">p</mi><mo id="alg2.l12.m1.4.4.2.2.3b" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.7" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.7.cmml">K</mi><mo id="alg2.l12.m1.4.4.2.2.3c" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.8" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.8.cmml">D</mi><mo id="alg2.l12.m1.4.4.2.2.3d" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.9" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.9.cmml">o</mi><mo id="alg2.l12.m1.4.4.2.2.3e" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.10" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.10.cmml">t</mi><mo id="alg2.l12.m1.4.4.2.2.3f" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.11" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.11.cmml">P</mi><mo id="alg2.l12.m1.4.4.2.2.3g" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.12" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.12.cmml">r</mi><mo id="alg2.l12.m1.4.4.2.2.3h" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.13" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.13.cmml">o</mi><mo id="alg2.l12.m1.4.4.2.2.3i" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.14" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.14.cmml">d</mi><mo id="alg2.l12.m1.4.4.2.2.3j" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.15" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.15.cmml">u</mi><mo id="alg2.l12.m1.4.4.2.2.3k" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.16" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.16.cmml">c</mi><mo id="alg2.l12.m1.4.4.2.2.3l" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mi id="alg2.l12.m1.4.4.2.2.17" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.17.cmml">t</mi><mo id="alg2.l12.m1.4.4.2.2.3m" xref="alg2.l12.m1.4.4.2.2.3.cmml">⁢</mo><mrow id="alg2.l12.m1.4.4.2.2.2.2" xref="alg2.l12.m1.4.4.2.2.2.3.cmml"><mo id="alg2.l12.m1.4.4.2.2.2.2.3" maxsize="90%" minsize="90%" xref="alg2.l12.m1.4.4.2.2.2.3.cmml">(</mo><mrow id="alg2.l12.m1.3.3.1.1.1.1.1" xref="alg2.l12.m1.3.3.1.1.1.1.1.cmml"><msub id="alg2.l12.m1.3.3.1.1.1.1.1.2" xref="alg2.l12.m1.3.3.1.1.1.1.1.2.cmml"><mi id="alg2.l12.m1.3.3.1.1.1.1.1.2.2" mathsize="90%" xref="alg2.l12.m1.3.3.1.1.1.1.1.2.2.cmml">f</mi><mi id="alg2.l12.m1.3.3.1.1.1.1.1.2.3" mathsize="90%" xref="alg2.l12.m1.3.3.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="alg2.l12.m1.3.3.1.1.1.1.1.1" xref="alg2.l12.m1.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="alg2.l12.m1.3.3.1.1.1.1.1.3.2" xref="alg2.l12.m1.3.3.1.1.1.1.1.cmml"><mo id="alg2.l12.m1.3.3.1.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l12.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="alg2.l12.m1.1.1" mathsize="90%" xref="alg2.l12.m1.1.1.cmml">q</mi><mo id="alg2.l12.m1.3.3.1.1.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l12.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l12.m1.4.4.2.2.2.2.4" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.2.3.cmml">,</mo><msub id="alg2.l12.m1.4.4.2.2.2.2.2" xref="alg2.l12.m1.4.4.2.2.2.2.2.cmml"><mi id="alg2.l12.m1.4.4.2.2.2.2.2.2" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.2.2.2.2.cmml">X</mi><mi id="alg2.l12.m1.4.4.2.2.2.2.2.3" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.2.2.2.3.cmml">p</mi></msub><mo id="alg2.l12.m1.4.4.2.2.2.2.5" mathsize="90%" xref="alg2.l12.m1.4.4.2.2.2.3.cmml">,</mo><mi id="alg2.l12.m1.2.2" mathsize="90%" xref="alg2.l12.m1.2.2.cmml">K</mi><mo id="alg2.l12.m1.4.4.2.2.2.2.6" maxsize="90%" minsize="90%" xref="alg2.l12.m1.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.4b"><apply id="alg2.l12.m1.4.4.cmml" xref="alg2.l12.m1.4.4"><ci id="alg2.l12.m1.4.4.3.cmml" xref="alg2.l12.m1.4.4.3">←</ci><ci id="alg2.l12.m1.4.4.4.cmml" xref="alg2.l12.m1.4.4.4">𝐺</ci><apply id="alg2.l12.m1.4.4.2.cmml" xref="alg2.l12.m1.4.4.2"><union id="alg2.l12.m1.4.4.2.3.cmml" xref="alg2.l12.m1.4.4.2.3"></union><ci id="alg2.l12.m1.4.4.2.4.cmml" xref="alg2.l12.m1.4.4.2.4">𝐺</ci><apply id="alg2.l12.m1.4.4.2.2.cmml" xref="alg2.l12.m1.4.4.2.2"><times id="alg2.l12.m1.4.4.2.2.3.cmml" xref="alg2.l12.m1.4.4.2.2.3"></times><ci id="alg2.l12.m1.4.4.2.2.4.cmml" xref="alg2.l12.m1.4.4.2.2.4">𝑇</ci><ci id="alg2.l12.m1.4.4.2.2.5.cmml" xref="alg2.l12.m1.4.4.2.2.5">𝑜</ci><ci id="alg2.l12.m1.4.4.2.2.6.cmml" xref="alg2.l12.m1.4.4.2.2.6">𝑝</ci><ci id="alg2.l12.m1.4.4.2.2.7.cmml" xref="alg2.l12.m1.4.4.2.2.7">𝐾</ci><ci id="alg2.l12.m1.4.4.2.2.8.cmml" xref="alg2.l12.m1.4.4.2.2.8">𝐷</ci><ci id="alg2.l12.m1.4.4.2.2.9.cmml" xref="alg2.l12.m1.4.4.2.2.9">𝑜</ci><ci id="alg2.l12.m1.4.4.2.2.10.cmml" xref="alg2.l12.m1.4.4.2.2.10">𝑡</ci><ci id="alg2.l12.m1.4.4.2.2.11.cmml" xref="alg2.l12.m1.4.4.2.2.11">𝑃</ci><ci id="alg2.l12.m1.4.4.2.2.12.cmml" xref="alg2.l12.m1.4.4.2.2.12">𝑟</ci><ci id="alg2.l12.m1.4.4.2.2.13.cmml" xref="alg2.l12.m1.4.4.2.2.13">𝑜</ci><ci id="alg2.l12.m1.4.4.2.2.14.cmml" xref="alg2.l12.m1.4.4.2.2.14">𝑑</ci><ci id="alg2.l12.m1.4.4.2.2.15.cmml" xref="alg2.l12.m1.4.4.2.2.15">𝑢</ci><ci id="alg2.l12.m1.4.4.2.2.16.cmml" xref="alg2.l12.m1.4.4.2.2.16">𝑐</ci><ci id="alg2.l12.m1.4.4.2.2.17.cmml" xref="alg2.l12.m1.4.4.2.2.17">𝑡</ci><vector id="alg2.l12.m1.4.4.2.2.2.3.cmml" xref="alg2.l12.m1.4.4.2.2.2.2"><apply id="alg2.l12.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.1"><times id="alg2.l12.m1.3.3.1.1.1.1.1.1.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.1.1"></times><apply id="alg2.l12.m1.3.3.1.1.1.1.1.2.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l12.m1.3.3.1.1.1.1.1.2.1.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l12.m1.3.3.1.1.1.1.1.2.2.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.1.2.2">𝑓</ci><ci id="alg2.l12.m1.3.3.1.1.1.1.1.2.3.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1">𝑞</ci></apply><apply id="alg2.l12.m1.4.4.2.2.2.2.2.cmml" xref="alg2.l12.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l12.m1.4.4.2.2.2.2.2.1.cmml" xref="alg2.l12.m1.4.4.2.2.2.2.2">subscript</csymbol><ci id="alg2.l12.m1.4.4.2.2.2.2.2.2.cmml" xref="alg2.l12.m1.4.4.2.2.2.2.2.2">𝑋</ci><ci id="alg2.l12.m1.4.4.2.2.2.2.2.3.cmml" xref="alg2.l12.m1.4.4.2.2.2.2.2.3">𝑝</ci></apply><ci id="alg2.l12.m1.2.2.cmml" xref="alg2.l12.m1.2.2">𝐾</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.4c">G\leftarrow G\cup TopKDotProduct(f_{p}(q),X_{p},K)</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.m1.4d">italic_G ← italic_G ∪ italic_T italic_o italic_p italic_K italic_D italic_o italic_t italic_P italic_r italic_o italic_d italic_u italic_c italic_t ( italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_X start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_K )</annotation></semantics></math><span class="ltx_text" id="alg2.l12.2" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l12.1.m1.1"><semantics id="alg2.l12.1.m1.1a"><mo id="alg2.l12.1.m1.1.1" xref="alg2.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l12.1.m1.1b"><ci id="alg2.l12.1.m1.1.1.cmml" xref="alg2.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.1.m1.1d">▷</annotation></semantics></math> Retrieve the top <math alttext="K" class="ltx_Math" display="inline" id="alg2.l12.2.m2.1"><semantics id="alg2.l12.2.m2.1a"><mi id="alg2.l12.2.m2.1.1" xref="alg2.l12.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.l12.2.m2.1b"><ci id="alg2.l12.2.m2.1.1.cmml" xref="alg2.l12.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.2.m2.1d">italic_K</annotation></semantics></math> items by dot product
    </span>
</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l13.1.1.1" style="font-size:80%;">13:</span></span><span class="ltx_text" id="alg2.l13.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg2.l13.3" style="font-size:90%;">return</span><span class="ltx_text" id="alg2.l13.4" style="font-size:90%;"> </span><math alttext="G" class="ltx_Math" display="inline" id="alg2.l13.m1.1"><semantics id="alg2.l13.m1.1a"><mi id="alg2.l13.m1.1.1" mathsize="90%" xref="alg2.l13.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><ci id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m1.1d">italic_G</annotation></semantics></math><span class="ltx_text" id="alg2.l13.5" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l14.1.1.1" style="font-size:80%;">14:</span></span><span class="ltx_text" id="alg2.l14.2" style="font-size:90%;">a query </span><math alttext="q" class="ltx_Math" display="inline" id="alg2.l14.m1.1"><semantics id="alg2.l14.m1.1a"><mi id="alg2.l14.m1.1.1" mathsize="90%" xref="alg2.l14.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><ci id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m1.1d">italic_q</annotation></semantics></math><span class="ltx_text" id="alg2.l14.3" style="font-size:90%;">, a set of items </span><math alttext="X" class="ltx_Math" display="inline" id="alg2.l14.m2.1"><semantics id="alg2.l14.m2.1a"><mi id="alg2.l14.m2.1.1" mathsize="90%" xref="alg2.l14.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="alg2.l14.m2.1b"><ci id="alg2.l14.m2.1.1.cmml" xref="alg2.l14.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m2.1d">italic_X</annotation></semantics></math><span class="ltx_text" id="alg2.l14.4" style="font-size:90%;">, </span><math alttext="f_{p}(\cdot)" class="ltx_Math" display="inline" id="alg2.l14.m3.1"><semantics id="alg2.l14.m3.1a"><mrow id="alg2.l14.m3.1.2" xref="alg2.l14.m3.1.2.cmml"><msub id="alg2.l14.m3.1.2.2" xref="alg2.l14.m3.1.2.2.cmml"><mi id="alg2.l14.m3.1.2.2.2" mathsize="90%" xref="alg2.l14.m3.1.2.2.2.cmml">f</mi><mi id="alg2.l14.m3.1.2.2.3" mathsize="90%" xref="alg2.l14.m3.1.2.2.3.cmml">p</mi></msub><mo id="alg2.l14.m3.1.2.1" xref="alg2.l14.m3.1.2.1.cmml">⁢</mo><mrow id="alg2.l14.m3.1.2.3.2" xref="alg2.l14.m3.1.2.cmml"><mo id="alg2.l14.m3.1.2.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l14.m3.1.2.cmml">(</mo><mo id="alg2.l14.m3.1.1" lspace="0em" mathsize="90%" rspace="0em" xref="alg2.l14.m3.1.1.cmml">⋅</mo><mo id="alg2.l14.m3.1.2.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l14.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m3.1b"><apply id="alg2.l14.m3.1.2.cmml" xref="alg2.l14.m3.1.2"><times id="alg2.l14.m3.1.2.1.cmml" xref="alg2.l14.m3.1.2.1"></times><apply id="alg2.l14.m3.1.2.2.cmml" xref="alg2.l14.m3.1.2.2"><csymbol cd="ambiguous" id="alg2.l14.m3.1.2.2.1.cmml" xref="alg2.l14.m3.1.2.2">subscript</csymbol><ci id="alg2.l14.m3.1.2.2.2.cmml" xref="alg2.l14.m3.1.2.2.2">𝑓</ci><ci id="alg2.l14.m3.1.2.2.3.cmml" xref="alg2.l14.m3.1.2.2.3">𝑝</ci></apply><ci id="alg2.l14.m3.1.1.cmml" xref="alg2.l14.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m3.1c">f_{p}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m3.1d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math><span class="ltx_text" id="alg2.l14.5" style="font-size:90%;">, </span><math alttext="g_{p}(\cdot)" class="ltx_Math" display="inline" id="alg2.l14.m4.1"><semantics id="alg2.l14.m4.1a"><mrow id="alg2.l14.m4.1.2" xref="alg2.l14.m4.1.2.cmml"><msub id="alg2.l14.m4.1.2.2" xref="alg2.l14.m4.1.2.2.cmml"><mi id="alg2.l14.m4.1.2.2.2" mathsize="90%" xref="alg2.l14.m4.1.2.2.2.cmml">g</mi><mi id="alg2.l14.m4.1.2.2.3" mathsize="90%" xref="alg2.l14.m4.1.2.2.3.cmml">p</mi></msub><mo id="alg2.l14.m4.1.2.1" xref="alg2.l14.m4.1.2.1.cmml">⁢</mo><mrow id="alg2.l14.m4.1.2.3.2" xref="alg2.l14.m4.1.2.cmml"><mo id="alg2.l14.m4.1.2.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l14.m4.1.2.cmml">(</mo><mo id="alg2.l14.m4.1.1" lspace="0em" mathsize="90%" rspace="0em" xref="alg2.l14.m4.1.1.cmml">⋅</mo><mo id="alg2.l14.m4.1.2.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l14.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m4.1b"><apply id="alg2.l14.m4.1.2.cmml" xref="alg2.l14.m4.1.2"><times id="alg2.l14.m4.1.2.1.cmml" xref="alg2.l14.m4.1.2.1"></times><apply id="alg2.l14.m4.1.2.2.cmml" xref="alg2.l14.m4.1.2.2"><csymbol cd="ambiguous" id="alg2.l14.m4.1.2.2.1.cmml" xref="alg2.l14.m4.1.2.2">subscript</csymbol><ci id="alg2.l14.m4.1.2.2.2.cmml" xref="alg2.l14.m4.1.2.2.2">𝑔</ci><ci id="alg2.l14.m4.1.2.2.3.cmml" xref="alg2.l14.m4.1.2.2.3">𝑝</ci></apply><ci id="alg2.l14.m4.1.1.cmml" xref="alg2.l14.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m4.1c">g_{p}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m4.1d">italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math><span class="ltx_text" id="alg2.l14.6" style="font-size:90%;"> for constructing the component-level embedding </span><math alttext="f_{p}(q),g_{p}(x)" class="ltx_Math" display="inline" id="alg2.l14.m5.4"><semantics id="alg2.l14.m5.4a"><mrow id="alg2.l14.m5.4.4.2" xref="alg2.l14.m5.4.4.3.cmml"><mrow id="alg2.l14.m5.3.3.1.1" xref="alg2.l14.m5.3.3.1.1.cmml"><msub id="alg2.l14.m5.3.3.1.1.2" xref="alg2.l14.m5.3.3.1.1.2.cmml"><mi id="alg2.l14.m5.3.3.1.1.2.2" mathsize="90%" xref="alg2.l14.m5.3.3.1.1.2.2.cmml">f</mi><mi id="alg2.l14.m5.3.3.1.1.2.3" mathsize="90%" xref="alg2.l14.m5.3.3.1.1.2.3.cmml">p</mi></msub><mo id="alg2.l14.m5.3.3.1.1.1" xref="alg2.l14.m5.3.3.1.1.1.cmml">⁢</mo><mrow id="alg2.l14.m5.3.3.1.1.3.2" xref="alg2.l14.m5.3.3.1.1.cmml"><mo id="alg2.l14.m5.3.3.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l14.m5.3.3.1.1.cmml">(</mo><mi id="alg2.l14.m5.1.1" mathsize="90%" xref="alg2.l14.m5.1.1.cmml">q</mi><mo id="alg2.l14.m5.3.3.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l14.m5.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l14.m5.4.4.2.3" mathsize="90%" xref="alg2.l14.m5.4.4.3.cmml">,</mo><mrow id="alg2.l14.m5.4.4.2.2" xref="alg2.l14.m5.4.4.2.2.cmml"><msub id="alg2.l14.m5.4.4.2.2.2" xref="alg2.l14.m5.4.4.2.2.2.cmml"><mi id="alg2.l14.m5.4.4.2.2.2.2" mathsize="90%" xref="alg2.l14.m5.4.4.2.2.2.2.cmml">g</mi><mi id="alg2.l14.m5.4.4.2.2.2.3" mathsize="90%" xref="alg2.l14.m5.4.4.2.2.2.3.cmml">p</mi></msub><mo id="alg2.l14.m5.4.4.2.2.1" xref="alg2.l14.m5.4.4.2.2.1.cmml">⁢</mo><mrow id="alg2.l14.m5.4.4.2.2.3.2" xref="alg2.l14.m5.4.4.2.2.cmml"><mo id="alg2.l14.m5.4.4.2.2.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l14.m5.4.4.2.2.cmml">(</mo><mi id="alg2.l14.m5.2.2" mathsize="90%" xref="alg2.l14.m5.2.2.cmml">x</mi><mo id="alg2.l14.m5.4.4.2.2.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l14.m5.4.4.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m5.4b"><list id="alg2.l14.m5.4.4.3.cmml" xref="alg2.l14.m5.4.4.2"><apply id="alg2.l14.m5.3.3.1.1.cmml" xref="alg2.l14.m5.3.3.1.1"><times id="alg2.l14.m5.3.3.1.1.1.cmml" xref="alg2.l14.m5.3.3.1.1.1"></times><apply id="alg2.l14.m5.3.3.1.1.2.cmml" xref="alg2.l14.m5.3.3.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m5.3.3.1.1.2.1.cmml" xref="alg2.l14.m5.3.3.1.1.2">subscript</csymbol><ci id="alg2.l14.m5.3.3.1.1.2.2.cmml" xref="alg2.l14.m5.3.3.1.1.2.2">𝑓</ci><ci id="alg2.l14.m5.3.3.1.1.2.3.cmml" xref="alg2.l14.m5.3.3.1.1.2.3">𝑝</ci></apply><ci id="alg2.l14.m5.1.1.cmml" xref="alg2.l14.m5.1.1">𝑞</ci></apply><apply id="alg2.l14.m5.4.4.2.2.cmml" xref="alg2.l14.m5.4.4.2.2"><times id="alg2.l14.m5.4.4.2.2.1.cmml" xref="alg2.l14.m5.4.4.2.2.1"></times><apply id="alg2.l14.m5.4.4.2.2.2.cmml" xref="alg2.l14.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="alg2.l14.m5.4.4.2.2.2.1.cmml" xref="alg2.l14.m5.4.4.2.2.2">subscript</csymbol><ci id="alg2.l14.m5.4.4.2.2.2.2.cmml" xref="alg2.l14.m5.4.4.2.2.2.2">𝑔</ci><ci id="alg2.l14.m5.4.4.2.2.2.3.cmml" xref="alg2.l14.m5.4.4.2.2.2.3">𝑝</ci></apply><ci id="alg2.l14.m5.2.2.cmml" xref="alg2.l14.m5.2.2">𝑥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m5.4c">f_{p}(q),g_{p}(x)</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m5.4d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math><span class="ltx_text" id="alg2.l14.7" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l15.1.1.1" style="font-size:80%;">15:</span></span><span class="ltx_text" id="alg2.l15.2" style="font-size:90%;">top </span><math alttext="K" class="ltx_Math" display="inline" id="alg2.l15.m1.1"><semantics id="alg2.l15.m1.1a"><mi id="alg2.l15.m1.1.1" mathsize="90%" xref="alg2.l15.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><ci id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg2.l15.m1.1d">italic_K</annotation></semantics></math><span class="ltx_text" id="alg2.l15.3" style="font-size:90%;"> items based on the averaged dot product, </span><math alttext="\sum_{p}\langle f_{p}(q),g_{p}(x)\rangle/P" class="ltx_Math" display="inline" id="alg2.l15.m2.4"><semantics id="alg2.l15.m2.4a"><mrow id="alg2.l15.m2.4.4" xref="alg2.l15.m2.4.4.cmml"><msub id="alg2.l15.m2.4.4.3" xref="alg2.l15.m2.4.4.3.cmml"><mo id="alg2.l15.m2.4.4.3.2" maxsize="90%" minsize="90%" stretchy="true" xref="alg2.l15.m2.4.4.3.2.cmml">∑</mo><mi id="alg2.l15.m2.4.4.3.3" mathsize="90%" xref="alg2.l15.m2.4.4.3.3.cmml">p</mi></msub><mrow id="alg2.l15.m2.4.4.2" xref="alg2.l15.m2.4.4.2.cmml"><mrow id="alg2.l15.m2.4.4.2.2.2" xref="alg2.l15.m2.4.4.2.2.3.cmml"><mo id="alg2.l15.m2.4.4.2.2.2.3" lspace="0em" maxsize="90%" minsize="90%" xref="alg2.l15.m2.4.4.2.2.3.cmml">⟨</mo><mrow id="alg2.l15.m2.3.3.1.1.1.1" xref="alg2.l15.m2.3.3.1.1.1.1.cmml"><msub id="alg2.l15.m2.3.3.1.1.1.1.2" xref="alg2.l15.m2.3.3.1.1.1.1.2.cmml"><mi id="alg2.l15.m2.3.3.1.1.1.1.2.2" mathsize="90%" xref="alg2.l15.m2.3.3.1.1.1.1.2.2.cmml">f</mi><mi id="alg2.l15.m2.3.3.1.1.1.1.2.3" mathsize="90%" xref="alg2.l15.m2.3.3.1.1.1.1.2.3.cmml">p</mi></msub><mo id="alg2.l15.m2.3.3.1.1.1.1.1" xref="alg2.l15.m2.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="alg2.l15.m2.3.3.1.1.1.1.3.2" xref="alg2.l15.m2.3.3.1.1.1.1.cmml"><mo id="alg2.l15.m2.3.3.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l15.m2.3.3.1.1.1.1.cmml">(</mo><mi id="alg2.l15.m2.1.1" mathsize="90%" xref="alg2.l15.m2.1.1.cmml">q</mi><mo id="alg2.l15.m2.3.3.1.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l15.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l15.m2.4.4.2.2.2.4" mathsize="90%" xref="alg2.l15.m2.4.4.2.2.3.cmml">,</mo><mrow id="alg2.l15.m2.4.4.2.2.2.2" xref="alg2.l15.m2.4.4.2.2.2.2.cmml"><msub id="alg2.l15.m2.4.4.2.2.2.2.2" xref="alg2.l15.m2.4.4.2.2.2.2.2.cmml"><mi id="alg2.l15.m2.4.4.2.2.2.2.2.2" mathsize="90%" xref="alg2.l15.m2.4.4.2.2.2.2.2.2.cmml">g</mi><mi id="alg2.l15.m2.4.4.2.2.2.2.2.3" mathsize="90%" xref="alg2.l15.m2.4.4.2.2.2.2.2.3.cmml">p</mi></msub><mo id="alg2.l15.m2.4.4.2.2.2.2.1" xref="alg2.l15.m2.4.4.2.2.2.2.1.cmml">⁢</mo><mrow id="alg2.l15.m2.4.4.2.2.2.2.3.2" xref="alg2.l15.m2.4.4.2.2.2.2.cmml"><mo id="alg2.l15.m2.4.4.2.2.2.2.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l15.m2.4.4.2.2.2.2.cmml">(</mo><mi id="alg2.l15.m2.2.2" mathsize="90%" xref="alg2.l15.m2.2.2.cmml">x</mi><mo id="alg2.l15.m2.4.4.2.2.2.2.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l15.m2.4.4.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="alg2.l15.m2.4.4.2.2.2.5" maxsize="90%" minsize="90%" xref="alg2.l15.m2.4.4.2.2.3.cmml">⟩</mo></mrow><mo id="alg2.l15.m2.4.4.2.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg2.l15.m2.4.4.2.3.cmml">/</mo><mi id="alg2.l15.m2.4.4.2.4" mathsize="90%" xref="alg2.l15.m2.4.4.2.4.cmml">P</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m2.4b"><apply id="alg2.l15.m2.4.4.cmml" xref="alg2.l15.m2.4.4"><apply id="alg2.l15.m2.4.4.3.cmml" xref="alg2.l15.m2.4.4.3"><csymbol cd="ambiguous" id="alg2.l15.m2.4.4.3.1.cmml" xref="alg2.l15.m2.4.4.3">subscript</csymbol><sum id="alg2.l15.m2.4.4.3.2.cmml" xref="alg2.l15.m2.4.4.3.2"></sum><ci id="alg2.l15.m2.4.4.3.3.cmml" xref="alg2.l15.m2.4.4.3.3">𝑝</ci></apply><apply id="alg2.l15.m2.4.4.2.cmml" xref="alg2.l15.m2.4.4.2"><divide id="alg2.l15.m2.4.4.2.3.cmml" xref="alg2.l15.m2.4.4.2.3"></divide><list id="alg2.l15.m2.4.4.2.2.3.cmml" xref="alg2.l15.m2.4.4.2.2.2"><apply id="alg2.l15.m2.3.3.1.1.1.1.cmml" xref="alg2.l15.m2.3.3.1.1.1.1"><times id="alg2.l15.m2.3.3.1.1.1.1.1.cmml" xref="alg2.l15.m2.3.3.1.1.1.1.1"></times><apply id="alg2.l15.m2.3.3.1.1.1.1.2.cmml" xref="alg2.l15.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l15.m2.3.3.1.1.1.1.2.1.cmml" xref="alg2.l15.m2.3.3.1.1.1.1.2">subscript</csymbol><ci id="alg2.l15.m2.3.3.1.1.1.1.2.2.cmml" xref="alg2.l15.m2.3.3.1.1.1.1.2.2">𝑓</ci><ci id="alg2.l15.m2.3.3.1.1.1.1.2.3.cmml" xref="alg2.l15.m2.3.3.1.1.1.1.2.3">𝑝</ci></apply><ci id="alg2.l15.m2.1.1.cmml" xref="alg2.l15.m2.1.1">𝑞</ci></apply><apply id="alg2.l15.m2.4.4.2.2.2.2.cmml" xref="alg2.l15.m2.4.4.2.2.2.2"><times id="alg2.l15.m2.4.4.2.2.2.2.1.cmml" xref="alg2.l15.m2.4.4.2.2.2.2.1"></times><apply id="alg2.l15.m2.4.4.2.2.2.2.2.cmml" xref="alg2.l15.m2.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l15.m2.4.4.2.2.2.2.2.1.cmml" xref="alg2.l15.m2.4.4.2.2.2.2.2">subscript</csymbol><ci id="alg2.l15.m2.4.4.2.2.2.2.2.2.cmml" xref="alg2.l15.m2.4.4.2.2.2.2.2.2">𝑔</ci><ci id="alg2.l15.m2.4.4.2.2.2.2.2.3.cmml" xref="alg2.l15.m2.4.4.2.2.2.2.2.3">𝑝</ci></apply><ci id="alg2.l15.m2.2.2.cmml" xref="alg2.l15.m2.2.2">𝑥</ci></apply></list><ci id="alg2.l15.m2.4.4.2.4.cmml" xref="alg2.l15.m2.4.4.2.4">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m2.4c">\sum_{p}\langle f_{p}(q),g_{p}(x)\rangle/P</annotation><annotation encoding="application/x-llamapun" id="alg2.l15.m2.4d">∑ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ⟨ italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ⟩ / italic_P</annotation></semantics></math><span class="ltx_text" id="alg2.l15.4" style="font-size:90%;">. </span>
</div>
<div class="ltx_listingline" id="alg2.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l16.1.1.1" style="font-size:80%;">16:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l16.2" style="font-size:90%;">function</span><span class="ltx_text" id="alg2.l16.3" style="font-size:90%;"> </span><span class="ltx_text ltx_font_smallcaps" id="alg2.l16.4" style="font-size:90%;">TopKAvg</span><span class="ltx_text" id="alg2.l16.5" style="font-size:90%;">(</span><math alttext="q,X,K" class="ltx_Math" display="inline" id="alg2.l16.m1.3"><semantics id="alg2.l16.m1.3a"><mrow id="alg2.l16.m1.3.4.2" xref="alg2.l16.m1.3.4.1.cmml"><mi id="alg2.l16.m1.1.1" mathsize="90%" xref="alg2.l16.m1.1.1.cmml">q</mi><mo id="alg2.l16.m1.3.4.2.1" mathsize="90%" xref="alg2.l16.m1.3.4.1.cmml">,</mo><mi id="alg2.l16.m1.2.2" mathsize="90%" xref="alg2.l16.m1.2.2.cmml">X</mi><mo id="alg2.l16.m1.3.4.2.2" mathsize="90%" xref="alg2.l16.m1.3.4.1.cmml">,</mo><mi id="alg2.l16.m1.3.3" mathsize="90%" xref="alg2.l16.m1.3.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.3b"><list id="alg2.l16.m1.3.4.1.cmml" xref="alg2.l16.m1.3.4.2"><ci id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1">𝑞</ci><ci id="alg2.l16.m1.2.2.cmml" xref="alg2.l16.m1.2.2">𝑋</ci><ci id="alg2.l16.m1.3.3.cmml" xref="alg2.l16.m1.3.3">𝐾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.3c">q,X,K</annotation><annotation encoding="application/x-llamapun" id="alg2.l16.m1.3d">italic_q , italic_X , italic_K</annotation></semantics></math><span class="ltx_text" id="alg2.l16.6" style="font-size:90%;">)
</span>
</div>
<div class="ltx_listingline" id="alg2.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l17.1.1.1" style="font-size:80%;">17:</span></span><span class="ltx_text" id="alg2.l17.2" style="font-size:90%;">    </span><math alttext="q^{\prime}\leftarrow\sum_{p=1}^{P}f_{p}(q)" class="ltx_Math" display="inline" id="alg2.l17.m1.1"><semantics id="alg2.l17.m1.1a"><mrow id="alg2.l17.m1.1.2" xref="alg2.l17.m1.1.2.cmml"><msup id="alg2.l17.m1.1.2.2" xref="alg2.l17.m1.1.2.2.cmml"><mi id="alg2.l17.m1.1.2.2.2" mathsize="90%" xref="alg2.l17.m1.1.2.2.2.cmml">q</mi><mo id="alg2.l17.m1.1.2.2.3" mathsize="90%" xref="alg2.l17.m1.1.2.2.3.cmml">′</mo></msup><mo id="alg2.l17.m1.1.2.1" mathsize="90%" rspace="0.111em" stretchy="false" xref="alg2.l17.m1.1.2.1.cmml">←</mo><mrow id="alg2.l17.m1.1.2.3" xref="alg2.l17.m1.1.2.3.cmml"><msubsup id="alg2.l17.m1.1.2.3.1" xref="alg2.l17.m1.1.2.3.1.cmml"><mo id="alg2.l17.m1.1.2.3.1.2.2" maxsize="90%" minsize="90%" stretchy="true" xref="alg2.l17.m1.1.2.3.1.2.2.cmml">∑</mo><mrow id="alg2.l17.m1.1.2.3.1.2.3" xref="alg2.l17.m1.1.2.3.1.2.3.cmml"><mi id="alg2.l17.m1.1.2.3.1.2.3.2" mathsize="90%" xref="alg2.l17.m1.1.2.3.1.2.3.2.cmml">p</mi><mo id="alg2.l17.m1.1.2.3.1.2.3.1" mathsize="90%" xref="alg2.l17.m1.1.2.3.1.2.3.1.cmml">=</mo><mn id="alg2.l17.m1.1.2.3.1.2.3.3" mathsize="90%" xref="alg2.l17.m1.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg2.l17.m1.1.2.3.1.3" mathsize="90%" xref="alg2.l17.m1.1.2.3.1.3.cmml">P</mi></msubsup><mrow id="alg2.l17.m1.1.2.3.2" xref="alg2.l17.m1.1.2.3.2.cmml"><msub id="alg2.l17.m1.1.2.3.2.2" xref="alg2.l17.m1.1.2.3.2.2.cmml"><mi id="alg2.l17.m1.1.2.3.2.2.2" mathsize="90%" xref="alg2.l17.m1.1.2.3.2.2.2.cmml">f</mi><mi id="alg2.l17.m1.1.2.3.2.2.3" mathsize="90%" xref="alg2.l17.m1.1.2.3.2.2.3.cmml">p</mi></msub><mo id="alg2.l17.m1.1.2.3.2.1" xref="alg2.l17.m1.1.2.3.2.1.cmml">⁢</mo><mrow id="alg2.l17.m1.1.2.3.2.3.2" xref="alg2.l17.m1.1.2.3.2.cmml"><mo id="alg2.l17.m1.1.2.3.2.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l17.m1.1.2.3.2.cmml">(</mo><mi id="alg2.l17.m1.1.1" mathsize="90%" xref="alg2.l17.m1.1.1.cmml">q</mi><mo id="alg2.l17.m1.1.2.3.2.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l17.m1.1.2.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.1b"><apply id="alg2.l17.m1.1.2.cmml" xref="alg2.l17.m1.1.2"><ci id="alg2.l17.m1.1.2.1.cmml" xref="alg2.l17.m1.1.2.1">←</ci><apply id="alg2.l17.m1.1.2.2.cmml" xref="alg2.l17.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l17.m1.1.2.2.1.cmml" xref="alg2.l17.m1.1.2.2">superscript</csymbol><ci id="alg2.l17.m1.1.2.2.2.cmml" xref="alg2.l17.m1.1.2.2.2">𝑞</ci><ci id="alg2.l17.m1.1.2.2.3.cmml" xref="alg2.l17.m1.1.2.2.3">′</ci></apply><apply id="alg2.l17.m1.1.2.3.cmml" xref="alg2.l17.m1.1.2.3"><apply id="alg2.l17.m1.1.2.3.1.cmml" xref="alg2.l17.m1.1.2.3.1"><csymbol cd="ambiguous" id="alg2.l17.m1.1.2.3.1.1.cmml" xref="alg2.l17.m1.1.2.3.1">superscript</csymbol><apply id="alg2.l17.m1.1.2.3.1.2.cmml" xref="alg2.l17.m1.1.2.3.1"><csymbol cd="ambiguous" id="alg2.l17.m1.1.2.3.1.2.1.cmml" xref="alg2.l17.m1.1.2.3.1">subscript</csymbol><sum id="alg2.l17.m1.1.2.3.1.2.2.cmml" xref="alg2.l17.m1.1.2.3.1.2.2"></sum><apply id="alg2.l17.m1.1.2.3.1.2.3.cmml" xref="alg2.l17.m1.1.2.3.1.2.3"><eq id="alg2.l17.m1.1.2.3.1.2.3.1.cmml" xref="alg2.l17.m1.1.2.3.1.2.3.1"></eq><ci id="alg2.l17.m1.1.2.3.1.2.3.2.cmml" xref="alg2.l17.m1.1.2.3.1.2.3.2">𝑝</ci><cn id="alg2.l17.m1.1.2.3.1.2.3.3.cmml" type="integer" xref="alg2.l17.m1.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="alg2.l17.m1.1.2.3.1.3.cmml" xref="alg2.l17.m1.1.2.3.1.3">𝑃</ci></apply><apply id="alg2.l17.m1.1.2.3.2.cmml" xref="alg2.l17.m1.1.2.3.2"><times id="alg2.l17.m1.1.2.3.2.1.cmml" xref="alg2.l17.m1.1.2.3.2.1"></times><apply id="alg2.l17.m1.1.2.3.2.2.cmml" xref="alg2.l17.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="alg2.l17.m1.1.2.3.2.2.1.cmml" xref="alg2.l17.m1.1.2.3.2.2">subscript</csymbol><ci id="alg2.l17.m1.1.2.3.2.2.2.cmml" xref="alg2.l17.m1.1.2.3.2.2.2">𝑓</ci><ci id="alg2.l17.m1.1.2.3.2.2.3.cmml" xref="alg2.l17.m1.1.2.3.2.2.3">𝑝</ci></apply><ci id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.1c">q^{\prime}\leftarrow\sum_{p=1}^{P}f_{p}(q)</annotation><annotation encoding="application/x-llamapun" id="alg2.l17.m1.1d">italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← ∑ start_POSTSUBSCRIPT italic_p = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math><span class="ltx_text" id="alg2.l17.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l18.2.1.1" style="font-size:80%;">18:</span></span><span class="ltx_text" id="alg2.l18.3" style="font-size:90%;">    </span><math alttext="X^{\prime}\leftarrow\{\sum_{p=1}^{P}g_{p}(x)/P,x\in X\}" class="ltx_Math" display="inline" id="alg2.l18.m1.3"><semantics id="alg2.l18.m1.3a"><mrow id="alg2.l18.m1.3.3" xref="alg2.l18.m1.3.3.cmml"><msup id="alg2.l18.m1.3.3.3" xref="alg2.l18.m1.3.3.3.cmml"><mi id="alg2.l18.m1.3.3.3.2" mathsize="90%" xref="alg2.l18.m1.3.3.3.2.cmml">X</mi><mo id="alg2.l18.m1.3.3.3.3" mathsize="90%" xref="alg2.l18.m1.3.3.3.3.cmml">′</mo></msup><mo id="alg2.l18.m1.3.3.2" mathsize="90%" stretchy="false" xref="alg2.l18.m1.3.3.2.cmml">←</mo><mrow id="alg2.l18.m1.3.3.1.1" xref="alg2.l18.m1.3.3.1.2.cmml"><mo id="alg2.l18.m1.3.3.1.1.2" maxsize="90%" minsize="90%" xref="alg2.l18.m1.3.3.1.2.cmml">{</mo><mrow id="alg2.l18.m1.3.3.1.1.1" xref="alg2.l18.m1.3.3.1.1.1.cmml"><mrow id="alg2.l18.m1.3.3.1.1.1.1.1" xref="alg2.l18.m1.3.3.1.1.1.1.2.cmml"><mrow id="alg2.l18.m1.3.3.1.1.1.1.1.1" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.cmml"><msubsup id="alg2.l18.m1.3.3.1.1.1.1.1.1.1" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.2" lspace="0em" maxsize="90%" minsize="90%" stretchy="true" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.2" mathsize="90%" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml">p</mi><mo id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.1" mathsize="90%" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.3" mathsize="90%" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.3" mathsize="90%" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.3.cmml">P</mi></msubsup><mrow id="alg2.l18.m1.3.3.1.1.1.1.1.1.2" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.cmml"><mrow id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.cmml"><msub id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2.2" mathsize="90%" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml">g</mi><mi id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2.3" mathsize="90%" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml">p</mi></msub><mo id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.1" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mrow id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.3.2" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mo id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.3.2.1" maxsize="90%" minsize="90%" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.cmml">(</mo><mi id="alg2.l18.m1.1.1" mathsize="90%" xref="alg2.l18.m1.1.1.cmml">x</mi><mo id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.3.2.2" maxsize="90%" minsize="90%" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></mrow><mo id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.1" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.1.cmml">/</mo><mi id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.3" mathsize="90%" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.3.cmml">P</mi></mrow></mrow><mo id="alg2.l18.m1.3.3.1.1.1.1.1.2" mathsize="90%" xref="alg2.l18.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="alg2.l18.m1.2.2" mathsize="90%" xref="alg2.l18.m1.2.2.cmml">x</mi></mrow><mo id="alg2.l18.m1.3.3.1.1.1.2" mathsize="90%" xref="alg2.l18.m1.3.3.1.1.1.2.cmml">∈</mo><mi id="alg2.l18.m1.3.3.1.1.1.3" mathsize="90%" xref="alg2.l18.m1.3.3.1.1.1.3.cmml">X</mi></mrow><mo id="alg2.l18.m1.3.3.1.1.3" maxsize="90%" minsize="90%" xref="alg2.l18.m1.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.3b"><apply id="alg2.l18.m1.3.3.cmml" xref="alg2.l18.m1.3.3"><ci id="alg2.l18.m1.3.3.2.cmml" xref="alg2.l18.m1.3.3.2">←</ci><apply id="alg2.l18.m1.3.3.3.cmml" xref="alg2.l18.m1.3.3.3"><csymbol cd="ambiguous" id="alg2.l18.m1.3.3.3.1.cmml" xref="alg2.l18.m1.3.3.3">superscript</csymbol><ci id="alg2.l18.m1.3.3.3.2.cmml" xref="alg2.l18.m1.3.3.3.2">𝑋</ci><ci id="alg2.l18.m1.3.3.3.3.cmml" xref="alg2.l18.m1.3.3.3.3">′</ci></apply><set id="alg2.l18.m1.3.3.1.2.cmml" xref="alg2.l18.m1.3.3.1.1"><apply id="alg2.l18.m1.3.3.1.1.1.cmml" xref="alg2.l18.m1.3.3.1.1.1"><in id="alg2.l18.m1.3.3.1.1.1.2.cmml" xref="alg2.l18.m1.3.3.1.1.1.2"></in><list id="alg2.l18.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1"><apply id="alg2.l18.m1.3.3.1.1.1.1.1.1.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1"><apply id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><sum id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.2"></sum><apply id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3"><eq id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.1"></eq><ci id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.2">𝑝</ci><cn id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="alg2.l18.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.1.3">𝑃</ci></apply><apply id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2"><divide id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.1"></divide><apply id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2"><times id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.1"></times><apply id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2.2">𝑔</ci><ci id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.2.2.3">𝑝</ci></apply><ci id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1">𝑥</ci></apply><ci id="alg2.l18.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.1.2.3">𝑃</ci></apply></apply><ci id="alg2.l18.m1.2.2.cmml" xref="alg2.l18.m1.2.2">𝑥</ci></list><ci id="alg2.l18.m1.3.3.1.1.1.3.cmml" xref="alg2.l18.m1.3.3.1.1.1.3">𝑋</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.3c">X^{\prime}\leftarrow\{\sum_{p=1}^{P}g_{p}(x)/P,x\in X\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l18.m1.3d">italic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← { ∑ start_POSTSUBSCRIPT italic_p = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) / italic_P , italic_x ∈ italic_X }</annotation></semantics></math><span class="ltx_text" id="alg2.l18.4" style="font-size:90%;"> </span><span class="ltx_text" id="alg2.l18.1" style="font-size:90%;float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l18.1.m1.1"><semantics id="alg2.l18.1.m1.1a"><mo id="alg2.l18.1.m1.1.1" xref="alg2.l18.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l18.1.m1.1b"><ci id="alg2.l18.1.m1.1.1.cmml" xref="alg2.l18.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l18.1.m1.1d">▷</annotation></semantics></math> Can be preprocessed and materialized.
</span>
</div>
<div class="ltx_listingline" id="alg2.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l19.1.1.1" style="font-size:80%;">19:</span></span><span class="ltx_text" id="alg2.l19.2" style="font-size:90%;">    </span><span class="ltx_text ltx_font_bold" id="alg2.l19.3" style="font-size:90%;">return</span><span class="ltx_text" id="alg2.l19.4" style="font-size:90%;"> </span><math alttext="TopKDotProduct(q^{\prime},X^{\prime},K)" class="ltx_Math" display="inline" id="alg2.l19.m1.3"><semantics id="alg2.l19.m1.3a"><mrow id="alg2.l19.m1.3.3" xref="alg2.l19.m1.3.3.cmml"><mi id="alg2.l19.m1.3.3.4" mathsize="90%" xref="alg2.l19.m1.3.3.4.cmml">T</mi><mo id="alg2.l19.m1.3.3.3" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.5" mathsize="90%" xref="alg2.l19.m1.3.3.5.cmml">o</mi><mo id="alg2.l19.m1.3.3.3a" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.6" mathsize="90%" xref="alg2.l19.m1.3.3.6.cmml">p</mi><mo id="alg2.l19.m1.3.3.3b" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.7" mathsize="90%" xref="alg2.l19.m1.3.3.7.cmml">K</mi><mo id="alg2.l19.m1.3.3.3c" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.8" mathsize="90%" xref="alg2.l19.m1.3.3.8.cmml">D</mi><mo id="alg2.l19.m1.3.3.3d" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.9" mathsize="90%" xref="alg2.l19.m1.3.3.9.cmml">o</mi><mo id="alg2.l19.m1.3.3.3e" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.10" mathsize="90%" xref="alg2.l19.m1.3.3.10.cmml">t</mi><mo id="alg2.l19.m1.3.3.3f" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.11" mathsize="90%" xref="alg2.l19.m1.3.3.11.cmml">P</mi><mo id="alg2.l19.m1.3.3.3g" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.12" mathsize="90%" xref="alg2.l19.m1.3.3.12.cmml">r</mi><mo id="alg2.l19.m1.3.3.3h" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.13" mathsize="90%" xref="alg2.l19.m1.3.3.13.cmml">o</mi><mo id="alg2.l19.m1.3.3.3i" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.14" mathsize="90%" xref="alg2.l19.m1.3.3.14.cmml">d</mi><mo id="alg2.l19.m1.3.3.3j" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.15" mathsize="90%" xref="alg2.l19.m1.3.3.15.cmml">u</mi><mo id="alg2.l19.m1.3.3.3k" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.16" mathsize="90%" xref="alg2.l19.m1.3.3.16.cmml">c</mi><mo id="alg2.l19.m1.3.3.3l" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mi id="alg2.l19.m1.3.3.17" mathsize="90%" xref="alg2.l19.m1.3.3.17.cmml">t</mi><mo id="alg2.l19.m1.3.3.3m" xref="alg2.l19.m1.3.3.3.cmml">⁢</mo><mrow id="alg2.l19.m1.3.3.2.2" xref="alg2.l19.m1.3.3.2.3.cmml"><mo id="alg2.l19.m1.3.3.2.2.3" maxsize="90%" minsize="90%" xref="alg2.l19.m1.3.3.2.3.cmml">(</mo><msup id="alg2.l19.m1.2.2.1.1.1" xref="alg2.l19.m1.2.2.1.1.1.cmml"><mi id="alg2.l19.m1.2.2.1.1.1.2" mathsize="90%" xref="alg2.l19.m1.2.2.1.1.1.2.cmml">q</mi><mo id="alg2.l19.m1.2.2.1.1.1.3" mathsize="90%" xref="alg2.l19.m1.2.2.1.1.1.3.cmml">′</mo></msup><mo id="alg2.l19.m1.3.3.2.2.4" mathsize="90%" xref="alg2.l19.m1.3.3.2.3.cmml">,</mo><msup id="alg2.l19.m1.3.3.2.2.2" xref="alg2.l19.m1.3.3.2.2.2.cmml"><mi id="alg2.l19.m1.3.3.2.2.2.2" mathsize="90%" xref="alg2.l19.m1.3.3.2.2.2.2.cmml">X</mi><mo id="alg2.l19.m1.3.3.2.2.2.3" mathsize="90%" xref="alg2.l19.m1.3.3.2.2.2.3.cmml">′</mo></msup><mo id="alg2.l19.m1.3.3.2.2.5" mathsize="90%" xref="alg2.l19.m1.3.3.2.3.cmml">,</mo><mi id="alg2.l19.m1.1.1" mathsize="90%" xref="alg2.l19.m1.1.1.cmml">K</mi><mo id="alg2.l19.m1.3.3.2.2.6" maxsize="90%" minsize="90%" xref="alg2.l19.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l19.m1.3b"><apply id="alg2.l19.m1.3.3.cmml" xref="alg2.l19.m1.3.3"><times id="alg2.l19.m1.3.3.3.cmml" xref="alg2.l19.m1.3.3.3"></times><ci id="alg2.l19.m1.3.3.4.cmml" xref="alg2.l19.m1.3.3.4">𝑇</ci><ci id="alg2.l19.m1.3.3.5.cmml" xref="alg2.l19.m1.3.3.5">𝑜</ci><ci id="alg2.l19.m1.3.3.6.cmml" xref="alg2.l19.m1.3.3.6">𝑝</ci><ci id="alg2.l19.m1.3.3.7.cmml" xref="alg2.l19.m1.3.3.7">𝐾</ci><ci id="alg2.l19.m1.3.3.8.cmml" xref="alg2.l19.m1.3.3.8">𝐷</ci><ci id="alg2.l19.m1.3.3.9.cmml" xref="alg2.l19.m1.3.3.9">𝑜</ci><ci id="alg2.l19.m1.3.3.10.cmml" xref="alg2.l19.m1.3.3.10">𝑡</ci><ci id="alg2.l19.m1.3.3.11.cmml" xref="alg2.l19.m1.3.3.11">𝑃</ci><ci id="alg2.l19.m1.3.3.12.cmml" xref="alg2.l19.m1.3.3.12">𝑟</ci><ci id="alg2.l19.m1.3.3.13.cmml" xref="alg2.l19.m1.3.3.13">𝑜</ci><ci id="alg2.l19.m1.3.3.14.cmml" xref="alg2.l19.m1.3.3.14">𝑑</ci><ci id="alg2.l19.m1.3.3.15.cmml" xref="alg2.l19.m1.3.3.15">𝑢</ci><ci id="alg2.l19.m1.3.3.16.cmml" xref="alg2.l19.m1.3.3.16">𝑐</ci><ci id="alg2.l19.m1.3.3.17.cmml" xref="alg2.l19.m1.3.3.17">𝑡</ci><vector id="alg2.l19.m1.3.3.2.3.cmml" xref="alg2.l19.m1.3.3.2.2"><apply id="alg2.l19.m1.2.2.1.1.1.cmml" xref="alg2.l19.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l19.m1.2.2.1.1.1.1.cmml" xref="alg2.l19.m1.2.2.1.1.1">superscript</csymbol><ci id="alg2.l19.m1.2.2.1.1.1.2.cmml" xref="alg2.l19.m1.2.2.1.1.1.2">𝑞</ci><ci id="alg2.l19.m1.2.2.1.1.1.3.cmml" xref="alg2.l19.m1.2.2.1.1.1.3">′</ci></apply><apply id="alg2.l19.m1.3.3.2.2.2.cmml" xref="alg2.l19.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg2.l19.m1.3.3.2.2.2.1.cmml" xref="alg2.l19.m1.3.3.2.2.2">superscript</csymbol><ci id="alg2.l19.m1.3.3.2.2.2.2.cmml" xref="alg2.l19.m1.3.3.2.2.2.2">𝑋</ci><ci id="alg2.l19.m1.3.3.2.2.2.3.cmml" xref="alg2.l19.m1.3.3.2.2.2.3">′</ci></apply><ci id="alg2.l19.m1.1.1.cmml" xref="alg2.l19.m1.1.1">𝐾</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l19.m1.3c">TopKDotProduct(q^{\prime},X^{\prime},K)</annotation><annotation encoding="application/x-llamapun" id="alg2.l19.m1.3d">italic_T italic_o italic_p italic_K italic_D italic_o italic_t italic_P italic_r italic_o italic_d italic_u italic_c italic_t ( italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_K )</annotation></semantics></math><span class="ltx_text" id="alg2.l19.5" style="font-size:90%;">
</span>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">Here, we describe two heuristics to retrieve the candidate item set:</p>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.1.m1.1b"><mi id="S3.SS2.SSS0.Px1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.1.m1.1c"><ci id="S3.SS2.SSS0.Px1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.1.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.1.m1.1e">italic_K</annotation></semantics></math> per embedding.</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.7">Given a query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.1.m1.1d">italic_q</annotation></semantics></math> and a set of items <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.1a"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.2.m2.1d">italic_X</annotation></semantics></math>, for each embedding set <math alttext="p" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p1.3.m3.1a"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.3.m3.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.3.m3.1d">italic_p</annotation></semantics></math>, retrieve top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.4.m4.1d">italic_K</annotation></semantics></math> items <math alttext="X_{K,p}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.5.m5.2"><semantics id="S3.SS2.SSS0.Px1.p1.5.m5.2a"><msub id="S3.SS2.SSS0.Px1.p1.5.m5.2.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.3.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.3.2.cmml">X</mi><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2.4" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.cmml">K</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2.4.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2.2.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.5.m5.2b"><apply id="S3.SS2.SSS0.Px1.p1.5.m5.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.3.2">𝑋</ci><list id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2.4"><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.1">𝐾</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.2.2.2.2">𝑝</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.5.m5.2c">X_{K,p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.5.m5.2d">italic_X start_POSTSUBSCRIPT italic_K , italic_p end_POSTSUBSCRIPT</annotation></semantics></math> based on dot product (<math alttext="\langle f_{p}(q),g_{p}(x)\rangle" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.6.m6.4"><semantics id="S3.SS2.SSS0.Px1.p1.6.m6.4a"><mrow id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.cmml"><mo id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.cmml">⟨</mo><mrow id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2.2.cmml">f</mi><mi id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2.3.cmml">p</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.3.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.cmml"><mo id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml">q</mi><mo id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.4" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.cmml">,</mo><mrow id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.cmml"><msub id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2.2.cmml">g</mi><mi id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2.3.cmml">p</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.1" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.3.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.cmml"><mo id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p1.6.m6.2.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2.cmml">x</mi><mo id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.5" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.6.m6.4b"><list id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2"><apply id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1"><times id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.1"></times><apply id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2.2">𝑓</ci><ci id="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.3.3.1.1.2.3">𝑝</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1">𝑞</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2"><times id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.1"></times><apply id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2.2">𝑔</ci><ci id="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.4.4.2.2.2.3">𝑝</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.6.m6.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.2.2">𝑥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.6.m6.4c">\langle f_{p}(q),g_{p}(x)\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.6.m6.4d">⟨ italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ⟩</annotation></semantics></math>). Return the union across <math alttext="P" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.7.m7.1"><semantics id="S3.SS2.SSS0.Px1.p1.7.m7.1a"><mi id="S3.SS2.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.7.m7.1b"><ci id="S3.SS2.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.7.m7.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.7.m7.1d">italic_P</annotation></semantics></math> queries.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.2">The top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p2.1.m1.1a"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.1.m1.1b"><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.1.m1.1d">italic_K</annotation></semantics></math> per embedding heuristic returns the union of the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p2.2.m2.1a"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.2.m2.1b"><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.2.m2.1d">italic_K</annotation></semantics></math> items for each embedding by dot product. We analyze the gap of this heuristic as follows:</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmtheorem2.1.1.1">Theorem 2</span></span><span class="ltx_text ltx_font_bold" id="Thmtheorem2.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmtheorem2.p1">
<p class="ltx_p" id="Thmtheorem2.p1.9"><span class="ltx_text ltx_font_bold ltx_font_italic" id="Thmtheorem2.p1.9.9">Upper bound of the gap of top <math alttext="K" class="ltx_Math" display="inline" id="Thmtheorem2.p1.1.1.m1.1"><semantics id="Thmtheorem2.p1.1.1.m1.1a"><mi id="Thmtheorem2.p1.1.1.m1.1.1" mathvariant="normal" xref="Thmtheorem2.p1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.1.1.m1.1b"><ci id="Thmtheorem2.p1.1.1.m1.1.1.cmml" xref="Thmtheorem2.p1.1.1.m1.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.1.1.m1.1d">italic_K</annotation></semantics></math> per embedding:<span class="ltx_text ltx_font_medium" id="Thmtheorem2.p1.9.9.8"> Let <math alttext="X_{K,p}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.2.2.1.m1.2"><semantics id="Thmtheorem2.p1.2.2.1.m1.2a"><msub id="Thmtheorem2.p1.2.2.1.m1.2.3" xref="Thmtheorem2.p1.2.2.1.m1.2.3.cmml"><mi id="Thmtheorem2.p1.2.2.1.m1.2.3.2" mathvariant="normal" xref="Thmtheorem2.p1.2.2.1.m1.2.3.2.cmml">X</mi><mrow id="Thmtheorem2.p1.2.2.1.m1.2.2.2.4" xref="Thmtheorem2.p1.2.2.1.m1.2.2.2.3.cmml"><mi id="Thmtheorem2.p1.2.2.1.m1.1.1.1.1" mathvariant="normal" xref="Thmtheorem2.p1.2.2.1.m1.1.1.1.1.cmml">K</mi><mo id="Thmtheorem2.p1.2.2.1.m1.2.2.2.4.1" xref="Thmtheorem2.p1.2.2.1.m1.2.2.2.3.cmml">,</mo><mi id="Thmtheorem2.p1.2.2.1.m1.2.2.2.2" mathvariant="normal" xref="Thmtheorem2.p1.2.2.1.m1.2.2.2.2.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.2.2.1.m1.2b"><apply id="Thmtheorem2.p1.2.2.1.m1.2.3.cmml" xref="Thmtheorem2.p1.2.2.1.m1.2.3"><csymbol cd="ambiguous" id="Thmtheorem2.p1.2.2.1.m1.2.3.1.cmml" xref="Thmtheorem2.p1.2.2.1.m1.2.3">subscript</csymbol><ci id="Thmtheorem2.p1.2.2.1.m1.2.3.2.cmml" xref="Thmtheorem2.p1.2.2.1.m1.2.3.2">X</ci><list id="Thmtheorem2.p1.2.2.1.m1.2.2.2.3.cmml" xref="Thmtheorem2.p1.2.2.1.m1.2.2.2.4"><ci id="Thmtheorem2.p1.2.2.1.m1.1.1.1.1.cmml" xref="Thmtheorem2.p1.2.2.1.m1.1.1.1.1">K</ci><ci id="Thmtheorem2.p1.2.2.1.m1.2.2.2.2.cmml" xref="Thmtheorem2.p1.2.2.1.m1.2.2.2.2">p</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.2.2.1.m1.2c">X_{K,p}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.2.2.1.m1.2d">italic_X start_POSTSUBSCRIPT italic_K , italic_p end_POSTSUBSCRIPT</annotation></semantics></math> be the top <math alttext="K" class="ltx_Math" display="inline" id="Thmtheorem2.p1.3.3.2.m2.1"><semantics id="Thmtheorem2.p1.3.3.2.m2.1a"><mi id="Thmtheorem2.p1.3.3.2.m2.1.1" mathvariant="normal" xref="Thmtheorem2.p1.3.3.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.3.3.2.m2.1b"><ci id="Thmtheorem2.p1.3.3.2.m2.1.1.cmml" xref="Thmtheorem2.p1.3.3.2.m2.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.3.3.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.3.3.2.m2.1d">italic_K</annotation></semantics></math> items of the embedding set <math alttext="p" class="ltx_Math" display="inline" id="Thmtheorem2.p1.4.4.3.m3.1"><semantics id="Thmtheorem2.p1.4.4.3.m3.1a"><mi id="Thmtheorem2.p1.4.4.3.m3.1.1" mathvariant="normal" xref="Thmtheorem2.p1.4.4.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.4.4.3.m3.1b"><ci id="Thmtheorem2.p1.4.4.3.m3.1.1.cmml" xref="Thmtheorem2.p1.4.4.3.m3.1.1">p</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.4.4.3.m3.1c">p</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.4.4.3.m3.1d">italic_p</annotation></semantics></math> and <math alttext="S=\max\{\phi(q,x),x\in X_{K+1,p}\}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.5.5.4.m4.7"><semantics id="Thmtheorem2.p1.5.5.4.m4.7a"><mrow id="Thmtheorem2.p1.5.5.4.m4.7.7" xref="Thmtheorem2.p1.5.5.4.m4.7.7.cmml"><mi id="Thmtheorem2.p1.5.5.4.m4.7.7.4" mathvariant="normal" xref="Thmtheorem2.p1.5.5.4.m4.7.7.4.cmml">S</mi><mo id="Thmtheorem2.p1.5.5.4.m4.7.7.3" xref="Thmtheorem2.p1.5.5.4.m4.7.7.3.cmml">=</mo><mrow id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.3.cmml"><mi id="Thmtheorem2.p1.5.5.4.m4.5.5" xref="Thmtheorem2.p1.5.5.4.m4.5.5.cmml">max</mi><mo id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2a" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.3.cmml">⁡</mo><mrow id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.3.cmml"><mo id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.3" stretchy="false" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.3.cmml">{</mo><mrow id="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1" xref="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.cmml"><mi id="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.2" mathvariant="normal" xref="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.2.cmml">ϕ</mi><mo id="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.1" xref="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.1.cmml">⁢</mo><mrow id="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.3.2" xref="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.3.1.cmml"><mo id="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.3.2.1" stretchy="false" xref="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.3.1.cmml">(</mo><mi id="Thmtheorem2.p1.5.5.4.m4.3.3" mathvariant="normal" xref="Thmtheorem2.p1.5.5.4.m4.3.3.cmml">q</mi><mo id="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.3.2.2" xref="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.3.1.cmml">,</mo><mi id="Thmtheorem2.p1.5.5.4.m4.4.4" mathvariant="normal" xref="Thmtheorem2.p1.5.5.4.m4.4.4.cmml">x</mi><mo id="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.3.2.3" stretchy="false" xref="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.4" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.3.cmml">,</mo><mrow id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.cmml"><mi id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.2" mathvariant="normal" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.2.cmml">x</mi><mo id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.1" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.1.cmml">∈</mo><msub id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.3" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.3.cmml"><mi id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.3.2" mathvariant="normal" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.3.2.cmml">X</mi><mrow id="Thmtheorem2.p1.5.5.4.m4.2.2.2.2" xref="Thmtheorem2.p1.5.5.4.m4.2.2.2.3.cmml"><mrow id="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1" xref="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.cmml"><mi id="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.2" mathvariant="normal" xref="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.2.cmml">K</mi><mo id="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.1" xref="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.1.cmml">+</mo><mn id="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.3" xref="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.2" xref="Thmtheorem2.p1.5.5.4.m4.2.2.2.3.cmml">,</mo><mi id="Thmtheorem2.p1.5.5.4.m4.1.1.1.1" mathvariant="normal" xref="Thmtheorem2.p1.5.5.4.m4.1.1.1.1.cmml">p</mi></mrow></msub></mrow><mo id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.5" stretchy="false" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.3.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.5.5.4.m4.7b"><apply id="Thmtheorem2.p1.5.5.4.m4.7.7.cmml" xref="Thmtheorem2.p1.5.5.4.m4.7.7"><eq id="Thmtheorem2.p1.5.5.4.m4.7.7.3.cmml" xref="Thmtheorem2.p1.5.5.4.m4.7.7.3"></eq><ci id="Thmtheorem2.p1.5.5.4.m4.7.7.4.cmml" xref="Thmtheorem2.p1.5.5.4.m4.7.7.4">S</ci><apply id="Thmtheorem2.p1.5.5.4.m4.7.7.2.3.cmml" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.2"><max id="Thmtheorem2.p1.5.5.4.m4.5.5.cmml" xref="Thmtheorem2.p1.5.5.4.m4.5.5"></max><apply id="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.cmml" xref="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1"><times id="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.1.cmml" xref="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.1"></times><ci id="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.2.cmml" xref="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.2">ϕ</ci><interval closure="open" id="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.3.1.cmml" xref="Thmtheorem2.p1.5.5.4.m4.6.6.1.1.1.1.3.2"><ci id="Thmtheorem2.p1.5.5.4.m4.3.3.cmml" xref="Thmtheorem2.p1.5.5.4.m4.3.3">q</ci><ci id="Thmtheorem2.p1.5.5.4.m4.4.4.cmml" xref="Thmtheorem2.p1.5.5.4.m4.4.4">x</ci></interval></apply><apply id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.cmml" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2"><in id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.1.cmml" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.1"></in><ci id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.2.cmml" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.2">x</ci><apply id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.3.cmml" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.3"><csymbol cd="ambiguous" id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.3.1.cmml" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.3">subscript</csymbol><ci id="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.3.2.cmml" xref="Thmtheorem2.p1.5.5.4.m4.7.7.2.2.2.2.3.2">X</ci><list id="Thmtheorem2.p1.5.5.4.m4.2.2.2.3.cmml" xref="Thmtheorem2.p1.5.5.4.m4.2.2.2.2"><apply id="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.cmml" xref="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1"><plus id="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.1.cmml" xref="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.1"></plus><ci id="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.2.cmml" xref="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.2">K</ci><cn id="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.3.cmml" type="integer" xref="Thmtheorem2.p1.5.5.4.m4.2.2.2.2.1.3">1</cn></apply><ci id="Thmtheorem2.p1.5.5.4.m4.1.1.1.1.cmml" xref="Thmtheorem2.p1.5.5.4.m4.1.1.1.1">p</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.5.5.4.m4.7c">S=\max\{\phi(q,x),x\in X_{K+1,p}\}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.5.5.4.m4.7d">italic_S = roman_max { italic_ϕ ( italic_q , italic_x ) , italic_x ∈ italic_X start_POSTSUBSCRIPT italic_K + 1 , italic_p end_POSTSUBSCRIPT }</annotation></semantics></math>. Let <math alttext="S_{min}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.6.6.5.m5.1"><semantics id="Thmtheorem2.p1.6.6.5.m5.1a"><msub id="Thmtheorem2.p1.6.6.5.m5.1.1" xref="Thmtheorem2.p1.6.6.5.m5.1.1.cmml"><mi id="Thmtheorem2.p1.6.6.5.m5.1.1.2" mathvariant="normal" xref="Thmtheorem2.p1.6.6.5.m5.1.1.2.cmml">S</mi><mrow id="Thmtheorem2.p1.6.6.5.m5.1.1.3" xref="Thmtheorem2.p1.6.6.5.m5.1.1.3.cmml"><mi id="Thmtheorem2.p1.6.6.5.m5.1.1.3.2" mathvariant="normal" xref="Thmtheorem2.p1.6.6.5.m5.1.1.3.2.cmml">m</mi><mo id="Thmtheorem2.p1.6.6.5.m5.1.1.3.1" xref="Thmtheorem2.p1.6.6.5.m5.1.1.3.1.cmml">⁢</mo><mi id="Thmtheorem2.p1.6.6.5.m5.1.1.3.3" mathvariant="normal" xref="Thmtheorem2.p1.6.6.5.m5.1.1.3.3.cmml">i</mi><mo id="Thmtheorem2.p1.6.6.5.m5.1.1.3.1a" xref="Thmtheorem2.p1.6.6.5.m5.1.1.3.1.cmml">⁢</mo><mi id="Thmtheorem2.p1.6.6.5.m5.1.1.3.4" mathvariant="normal" xref="Thmtheorem2.p1.6.6.5.m5.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.6.6.5.m5.1b"><apply id="Thmtheorem2.p1.6.6.5.m5.1.1.cmml" xref="Thmtheorem2.p1.6.6.5.m5.1.1"><csymbol cd="ambiguous" id="Thmtheorem2.p1.6.6.5.m5.1.1.1.cmml" xref="Thmtheorem2.p1.6.6.5.m5.1.1">subscript</csymbol><ci id="Thmtheorem2.p1.6.6.5.m5.1.1.2.cmml" xref="Thmtheorem2.p1.6.6.5.m5.1.1.2">S</ci><apply id="Thmtheorem2.p1.6.6.5.m5.1.1.3.cmml" xref="Thmtheorem2.p1.6.6.5.m5.1.1.3"><times id="Thmtheorem2.p1.6.6.5.m5.1.1.3.1.cmml" xref="Thmtheorem2.p1.6.6.5.m5.1.1.3.1"></times><ci id="Thmtheorem2.p1.6.6.5.m5.1.1.3.2.cmml" xref="Thmtheorem2.p1.6.6.5.m5.1.1.3.2">m</ci><ci id="Thmtheorem2.p1.6.6.5.m5.1.1.3.3.cmml" xref="Thmtheorem2.p1.6.6.5.m5.1.1.3.3">i</ci><ci id="Thmtheorem2.p1.6.6.5.m5.1.1.3.4.cmml" xref="Thmtheorem2.p1.6.6.5.m5.1.1.3.4">n</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.6.6.5.m5.1c">S_{min}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.6.6.5.m5.1d">italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> be the top <math alttext="K^{th}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.7.7.6.m6.1"><semantics id="Thmtheorem2.p1.7.7.6.m6.1a"><msup id="Thmtheorem2.p1.7.7.6.m6.1.1" xref="Thmtheorem2.p1.7.7.6.m6.1.1.cmml"><mi id="Thmtheorem2.p1.7.7.6.m6.1.1.2" mathvariant="normal" xref="Thmtheorem2.p1.7.7.6.m6.1.1.2.cmml">K</mi><mrow id="Thmtheorem2.p1.7.7.6.m6.1.1.3" xref="Thmtheorem2.p1.7.7.6.m6.1.1.3.cmml"><mi id="Thmtheorem2.p1.7.7.6.m6.1.1.3.2" mathvariant="normal" xref="Thmtheorem2.p1.7.7.6.m6.1.1.3.2.cmml">t</mi><mo id="Thmtheorem2.p1.7.7.6.m6.1.1.3.1" xref="Thmtheorem2.p1.7.7.6.m6.1.1.3.1.cmml">⁢</mo><mi id="Thmtheorem2.p1.7.7.6.m6.1.1.3.3" mathvariant="normal" xref="Thmtheorem2.p1.7.7.6.m6.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.7.7.6.m6.1b"><apply id="Thmtheorem2.p1.7.7.6.m6.1.1.cmml" xref="Thmtheorem2.p1.7.7.6.m6.1.1"><csymbol cd="ambiguous" id="Thmtheorem2.p1.7.7.6.m6.1.1.1.cmml" xref="Thmtheorem2.p1.7.7.6.m6.1.1">superscript</csymbol><ci id="Thmtheorem2.p1.7.7.6.m6.1.1.2.cmml" xref="Thmtheorem2.p1.7.7.6.m6.1.1.2">K</ci><apply id="Thmtheorem2.p1.7.7.6.m6.1.1.3.cmml" xref="Thmtheorem2.p1.7.7.6.m6.1.1.3"><times id="Thmtheorem2.p1.7.7.6.m6.1.1.3.1.cmml" xref="Thmtheorem2.p1.7.7.6.m6.1.1.3.1"></times><ci id="Thmtheorem2.p1.7.7.6.m6.1.1.3.2.cmml" xref="Thmtheorem2.p1.7.7.6.m6.1.1.3.2">t</ci><ci id="Thmtheorem2.p1.7.7.6.m6.1.1.3.3.cmml" xref="Thmtheorem2.p1.7.7.6.m6.1.1.3.3">h</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.7.7.6.m6.1c">K^{th}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.7.7.6.m6.1d">italic_K start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> MoL score of the items in <math alttext="\cup_{p}X_{K,p}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.8.8.7.m7.2"><semantics id="Thmtheorem2.p1.8.8.7.m7.2a"><mrow id="Thmtheorem2.p1.8.8.7.m7.2.3" xref="Thmtheorem2.p1.8.8.7.m7.2.3.cmml"><msub id="Thmtheorem2.p1.8.8.7.m7.2.3.1" xref="Thmtheorem2.p1.8.8.7.m7.2.3.1.cmml"><mo id="Thmtheorem2.p1.8.8.7.m7.2.3.1.2" xref="Thmtheorem2.p1.8.8.7.m7.2.3.1.2.cmml">∪</mo><mi id="Thmtheorem2.p1.8.8.7.m7.2.3.1.3" mathvariant="normal" xref="Thmtheorem2.p1.8.8.7.m7.2.3.1.3.cmml">p</mi></msub><msub id="Thmtheorem2.p1.8.8.7.m7.2.3.2" xref="Thmtheorem2.p1.8.8.7.m7.2.3.2.cmml"><mi id="Thmtheorem2.p1.8.8.7.m7.2.3.2.2" mathvariant="normal" xref="Thmtheorem2.p1.8.8.7.m7.2.3.2.2.cmml">X</mi><mrow id="Thmtheorem2.p1.8.8.7.m7.2.2.2.4" xref="Thmtheorem2.p1.8.8.7.m7.2.2.2.3.cmml"><mi id="Thmtheorem2.p1.8.8.7.m7.1.1.1.1" mathvariant="normal" xref="Thmtheorem2.p1.8.8.7.m7.1.1.1.1.cmml">K</mi><mo id="Thmtheorem2.p1.8.8.7.m7.2.2.2.4.1" xref="Thmtheorem2.p1.8.8.7.m7.2.2.2.3.cmml">,</mo><mi id="Thmtheorem2.p1.8.8.7.m7.2.2.2.2" mathvariant="normal" xref="Thmtheorem2.p1.8.8.7.m7.2.2.2.2.cmml">p</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.8.8.7.m7.2b"><apply id="Thmtheorem2.p1.8.8.7.m7.2.3.cmml" xref="Thmtheorem2.p1.8.8.7.m7.2.3"><apply id="Thmtheorem2.p1.8.8.7.m7.2.3.1.cmml" xref="Thmtheorem2.p1.8.8.7.m7.2.3.1"><csymbol cd="ambiguous" id="Thmtheorem2.p1.8.8.7.m7.2.3.1.1.cmml" xref="Thmtheorem2.p1.8.8.7.m7.2.3.1">subscript</csymbol><union id="Thmtheorem2.p1.8.8.7.m7.2.3.1.2.cmml" xref="Thmtheorem2.p1.8.8.7.m7.2.3.1.2"></union><ci id="Thmtheorem2.p1.8.8.7.m7.2.3.1.3.cmml" xref="Thmtheorem2.p1.8.8.7.m7.2.3.1.3">p</ci></apply><apply id="Thmtheorem2.p1.8.8.7.m7.2.3.2.cmml" xref="Thmtheorem2.p1.8.8.7.m7.2.3.2"><csymbol cd="ambiguous" id="Thmtheorem2.p1.8.8.7.m7.2.3.2.1.cmml" xref="Thmtheorem2.p1.8.8.7.m7.2.3.2">subscript</csymbol><ci id="Thmtheorem2.p1.8.8.7.m7.2.3.2.2.cmml" xref="Thmtheorem2.p1.8.8.7.m7.2.3.2.2">X</ci><list id="Thmtheorem2.p1.8.8.7.m7.2.2.2.3.cmml" xref="Thmtheorem2.p1.8.8.7.m7.2.2.2.4"><ci id="Thmtheorem2.p1.8.8.7.m7.1.1.1.1.cmml" xref="Thmtheorem2.p1.8.8.7.m7.1.1.1.1">K</ci><ci id="Thmtheorem2.p1.8.8.7.m7.2.2.2.2.cmml" xref="Thmtheorem2.p1.8.8.7.m7.2.2.2.2">p</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.8.8.7.m7.2c">\cup_{p}X_{K,p}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.8.8.7.m7.2d">∪ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_K , italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, then the gap of <math alttext="S_{\Delta}\leq S^{\prime}-S_{min}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.9.9.8.m8.1"><semantics id="Thmtheorem2.p1.9.9.8.m8.1a"><mrow id="Thmtheorem2.p1.9.9.8.m8.1.1" xref="Thmtheorem2.p1.9.9.8.m8.1.1.cmml"><msub id="Thmtheorem2.p1.9.9.8.m8.1.1.2" xref="Thmtheorem2.p1.9.9.8.m8.1.1.2.cmml"><mi id="Thmtheorem2.p1.9.9.8.m8.1.1.2.2" mathvariant="normal" xref="Thmtheorem2.p1.9.9.8.m8.1.1.2.2.cmml">S</mi><mi id="Thmtheorem2.p1.9.9.8.m8.1.1.2.3" mathvariant="normal" xref="Thmtheorem2.p1.9.9.8.m8.1.1.2.3.cmml">Δ</mi></msub><mo id="Thmtheorem2.p1.9.9.8.m8.1.1.1" xref="Thmtheorem2.p1.9.9.8.m8.1.1.1.cmml">≤</mo><mrow id="Thmtheorem2.p1.9.9.8.m8.1.1.3" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.cmml"><msup id="Thmtheorem2.p1.9.9.8.m8.1.1.3.2" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.2.cmml"><mi id="Thmtheorem2.p1.9.9.8.m8.1.1.3.2.2" mathvariant="normal" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.2.2.cmml">S</mi><mo id="Thmtheorem2.p1.9.9.8.m8.1.1.3.2.3" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.2.3.cmml">′</mo></msup><mo id="Thmtheorem2.p1.9.9.8.m8.1.1.3.1" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.1.cmml">−</mo><msub id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.cmml"><mi id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.2" mathvariant="normal" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.2.cmml">S</mi><mrow id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.cmml"><mi id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.2" mathvariant="normal" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.2.cmml">m</mi><mo id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.1" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.1.cmml">⁢</mo><mi id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.3" mathvariant="normal" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.3.cmml">i</mi><mo id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.1a" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.1.cmml">⁢</mo><mi id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.4" mathvariant="normal" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.4.cmml">n</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem2.p1.9.9.8.m8.1b"><apply id="Thmtheorem2.p1.9.9.8.m8.1.1.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1"><leq id="Thmtheorem2.p1.9.9.8.m8.1.1.1.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.1"></leq><apply id="Thmtheorem2.p1.9.9.8.m8.1.1.2.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.2"><csymbol cd="ambiguous" id="Thmtheorem2.p1.9.9.8.m8.1.1.2.1.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.2">subscript</csymbol><ci id="Thmtheorem2.p1.9.9.8.m8.1.1.2.2.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.2.2">S</ci><ci id="Thmtheorem2.p1.9.9.8.m8.1.1.2.3.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.2.3">Δ</ci></apply><apply id="Thmtheorem2.p1.9.9.8.m8.1.1.3.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3"><minus id="Thmtheorem2.p1.9.9.8.m8.1.1.3.1.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.1"></minus><apply id="Thmtheorem2.p1.9.9.8.m8.1.1.3.2.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="Thmtheorem2.p1.9.9.8.m8.1.1.3.2.1.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.2">superscript</csymbol><ci id="Thmtheorem2.p1.9.9.8.m8.1.1.3.2.2.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.2.2">S</ci><ci id="Thmtheorem2.p1.9.9.8.m8.1.1.3.2.3.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.2.3">′</ci></apply><apply id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3"><csymbol cd="ambiguous" id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.1.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3">subscript</csymbol><ci id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.2.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.2">S</ci><apply id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3"><times id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.1.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.1"></times><ci id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.2.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.2">m</ci><ci id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.3.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.3">i</ci><ci id="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.4.cmml" xref="Thmtheorem2.p1.9.9.8.m8.1.1.3.3.3.4">n</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem2.p1.9.9.8.m8.1c">S_{\Delta}\leq S^{\prime}-S_{min}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem2.p1.9.9.8.m8.1d">italic_S start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ≤ italic_S start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT - italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math>.</span></span></p>
</div>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p3">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p3.4"><span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px1.p3.4.1">Remark</span>
Note that there exists an <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px1.p3.4.2">MoL</span> such that <math alttext="S_{\Delta}=S-S_{min}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p3.1.m1.1a"><mrow id="S3.SS2.SSS0.Px1.p3.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.2.cmml">S</mi><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.3" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.3.cmml">Δ</mi></msub><mo id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.2.cmml">S</mi><mo id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.1.cmml">−</mo><msub id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.2.cmml">S</mi><mrow id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.2.cmml">m</mi><mo id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.3.cmml">i</mi><mo id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.1a" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.4" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.4.cmml">n</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1"><eq id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.2">𝑆</ci><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.3">Δ</ci></apply><apply id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3"><minus id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.1"></minus><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.2">𝑆</ci><apply id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.2">𝑆</ci><apply id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3"><times id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.1"></times><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.2">𝑚</ci><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.3">𝑖</ci><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.3.3.4">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.1.m1.1c">S_{\Delta}=S-S_{min}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.1.m1.1d">italic_S start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT = italic_S - italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math>, i.e., when <math alttext="\pi_{p}(q,x)=1" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.2.m2.2"><semantics id="S3.SS2.SSS0.Px1.p3.2.m2.2a"><mrow id="S3.SS2.SSS0.Px1.p3.2.m2.2.3" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.cmml"><msub id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2.2" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2.2.cmml">π</mi><mi id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2.3" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2.3.cmml">p</mi></msub><mo id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.1" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.3.2" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.3.1.cmml"><mo id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.3.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.cmml">q</mi><mo id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.3.2.2" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.3.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p3.2.m2.2.2" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.2.cmml">x</mi><mo id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.3.2.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.1" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.1.cmml">=</mo><mn id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.3" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.2.m2.2b"><apply id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3"><eq id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.1"></eq><apply id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2"><times id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.1"></times><apply id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2.2">𝜋</ci><ci id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.2.3">𝑝</ci></apply><interval closure="open" id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.2.3.2"><ci id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1">𝑞</ci><ci id="S3.SS2.SSS0.Px1.p3.2.m2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.2">𝑥</ci></interval></apply><cn id="S3.SS2.SSS0.Px1.p3.2.m2.2.3.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.2.m2.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.2.m2.2c">\pi_{p}(q,x)=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.2.m2.2d">italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q , italic_x ) = 1</annotation></semantics></math> for <math alttext="x_{p}=\operatorname*{arg\,max}_{x,p}\{\langle f_{p}(q),g_{p}(x)\rangle,x\in X_%
{K+1,p}\setminus X_{K,p}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.3.m3.11"><semantics id="S3.SS2.SSS0.Px1.p3.3.m3.11a"><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.11.11" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.cmml"><msub id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5.2.cmml">x</mi><mi id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5.3.cmml">p</mi></msub><mo id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.4" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.4.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.4.cmml"><msub id="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.2.cmml">arg</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.1" lspace="0.170em" xref="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.3.cmml">max</mi></mrow><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.2.4" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1.cmml">x</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.2.4.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.2.2.cmml">p</mi></mrow></msub><mo id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3a" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.4.cmml">⁡</mo><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.4.cmml"><mo id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.4.cmml">{</mo><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.3.cmml"><mo id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.3.cmml">⟨</mo><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2.2.cmml">f</mi><mi id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2.3.cmml">p</mi></msub><mo id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.7.7" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7.cmml">q</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.4" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.3.cmml">,</mo><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.cmml"><msub id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2.2.cmml">g</mi><mi id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2.3.cmml">p</mi></msub><mo id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.cmml"><mo id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.8.8" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8.cmml">x</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.5" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.3.cmml">⟩</mo></mrow><mo id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.4" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.4.cmml">,</mo><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.2.cmml">x</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.1.cmml">∈</mo><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.cmml"><msub id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.2.2.cmml">X</mi><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.2.cmml">K</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.1.cmml">+</mo><mn id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.1.cmml">p</mi></mrow></msub><mo id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.1.cmml">∖</mo><msub id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.3.2.cmml">X</mi><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.2.4" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.5.5.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.5.5.1.1.cmml">K</mi><mo id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.2.4.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.2.3.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.2.2.cmml">p</mi></mrow></msub></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.5" stretchy="false" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.4.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.3.m3.11b"><apply id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11"><eq id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.4.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.4"></eq><apply id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5.2">𝑥</ci><ci id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.5.3">𝑝</ci></apply><apply id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.4.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3"><apply id="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2"><times id="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.1"></times><ci id="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.2">arg</ci><ci id="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.9.9.1.1.1.2.3">max</ci></apply><list id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.2.4"><ci id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.1">𝑥</ci><ci id="S3.SS2.SSS0.Px1.p3.3.m3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.2.2.2.2">𝑝</ci></list></apply><list id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2"><apply id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1"><times id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.1"></times><apply id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2.2">𝑓</ci><ci id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.1.1.2.3">𝑝</ci></apply><ci id="S3.SS2.SSS0.Px1.p3.3.m3.7.7.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.7.7">𝑞</ci></apply><apply id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2"><times id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.1"></times><apply id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2.2">𝑔</ci><ci id="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.10.10.2.2.2.1.2.2.2.3">𝑝</ci></apply><ci id="S3.SS2.SSS0.Px1.p3.3.m3.8.8.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.8.8">𝑥</ci></apply></list><apply id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2"><in id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.1"></in><ci id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.2">𝑥</ci><apply id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3"><setdiff id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.1"></setdiff><apply id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.2.2">𝑋</ci><list id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2"><apply id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1"><plus id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.1"></plus><ci id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.2">𝐾</ci><cn id="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.3.m3.4.4.2.2.1.3">1</cn></apply><ci id="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.3.3.1.1">𝑝</ci></list></apply><apply id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.11.11.3.3.3.2.3.3.2">𝑋</ci><list id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.2.4"><ci id="S3.SS2.SSS0.Px1.p3.3.m3.5.5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.5.5.1.1">𝐾</ci><ci id="S3.SS2.SSS0.Px1.p3.3.m3.6.6.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.6.6.2.2">𝑝</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.3.m3.11c">x_{p}=\operatorname*{arg\,max}_{x,p}\{\langle f_{p}(q),g_{p}(x)\rangle,x\in X_%
{K+1,p}\setminus X_{K,p}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.3.m3.11d">italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_x , italic_p end_POSTSUBSCRIPT { ⟨ italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ⟩ , italic_x ∈ italic_X start_POSTSUBSCRIPT italic_K + 1 , italic_p end_POSTSUBSCRIPT ∖ italic_X start_POSTSUBSCRIPT italic_K , italic_p end_POSTSUBSCRIPT }</annotation></semantics></math>. Thus, the upper bound of <math alttext="S_{\Delta}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p3.4.m4.1a"><msub id="S3.SS2.SSS0.Px1.p3.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.cmml">S</mi><mi id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.3" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.3.cmml">Δ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.4.m4.1b"><apply id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2">𝑆</ci><ci id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.3">Δ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.4.m4.1c">S_{\Delta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.4.m4.1d">italic_S start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT</annotation></semantics></math> is tight.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.1.m1.1b"><mi id="S3.SS2.SSS0.Px2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.1.m1.1c"><ci id="S3.SS2.SSS0.Px2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.1.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.1.m1.1e">italic_K</annotation></semantics></math> average.</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.4">Given a query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.1.m1.1d">italic_q</annotation></semantics></math> and a set of items <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.2.m2.1d">italic_X</annotation></semantics></math>, return the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.3.m3.1d">italic_K</annotation></semantics></math> items with the highest average dot product <math alttext="\sum_{p}\langle f_{p}(q),g_{p}(x)\rangle/P" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.4.m4.4"><semantics id="S3.SS2.SSS0.Px2.p1.4.m4.4a"><mrow id="S3.SS2.SSS0.Px2.p1.4.m4.4.4" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.cmml"><msub id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3.cmml"><mo id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3.2.cmml">∑</mo><mi id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3.3" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3.3.cmml">p</mi></msub><mrow id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.cmml"><mrow id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.3.cmml"><mo id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.3" lspace="0em" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.3.cmml">⟨</mo><mrow id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.cmml"><msub id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2.2.cmml">f</mi><mi id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2.3" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2.3.cmml">p</mi></msub><mo id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml">q</mi><mo id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.4" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.3.cmml">,</mo><mrow id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.cmml"><msub id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2.2.cmml">g</mi><mi id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2.3.cmml">p</mi></msub><mo id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.3.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p1.4.m4.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.2.2.cmml">x</mi><mo id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.5" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.3.cmml">⟩</mo></mrow><mo id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3.cmml">/</mo><mi id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.4" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.4.cmml">P</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.4.m4.4b"><apply id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4"><apply id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3">subscript</csymbol><sum id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3.2"></sum><ci id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.3.3">𝑝</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2"><divide id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.3"></divide><list id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2"><apply id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1"><times id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.1"></times><apply id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2.2">𝑓</ci><ci id="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.3.3.1.1.1.1.2.3">𝑝</ci></apply><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1">𝑞</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2"><times id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.1"></times><apply id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2.2">𝑔</ci><ci id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.2.2.2.2.3">𝑝</ci></apply><ci id="S3.SS2.SSS0.Px2.p1.4.m4.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.2.2">𝑥</ci></apply></list><ci id="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.4.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.4.4.2.4">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.4.m4.4c">\sum_{p}\langle f_{p}(q),g_{p}(x)\rangle/P</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.4.m4.4d">∑ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ⟨ italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ⟩ / italic_P</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p2.3">Note that the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.1.m1.1d">italic_K</annotation></semantics></math> average heuristic returns the exact top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p2.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.2.m2.1d">italic_K</annotation></semantics></math> items when the gating weight distribution in <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px2.p2.3.1">MoL</span>, <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p2.3.m3.1a"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.3.m3.1b"><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.3.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.3.m3.1d">italic_π</annotation></semantics></math>, is uniform.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p3">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p3.4">This heuristic is interesting for two reasons. First, the items retrieved by this heuristic are likely to be the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p3.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p3.1.m1.1a"><mi id="S3.SS2.SSS0.Px2.p3.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p3.1.m1.1b"><ci id="S3.SS2.SSS0.Px2.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p3.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p3.1.m1.1d">italic_K</annotation></semantics></math> items of <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px2.p3.4.1">MoL</span> when the weight distribution is more balanced. This complements the heuristic that retrieves top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p3.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p3.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p3.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p3.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p3.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p3.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p3.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p3.2.m2.1d">italic_K</annotation></semantics></math> per embedding. Second, in the setup where the set of embedding pairs is constructed as the outer product of the embeddings of a query and those of an item (Equation <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S2.E2" title="In Mixture of Logits (MoL) ‣ 2 Expressiveness of Mixture of Logits ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">2</span></a>), the average dot product can be efficiently preprocessed and materialized for the items, and the computation of the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p3.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p3.3.m3.1a"><mi id="S3.SS2.SSS0.Px2.p3.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p3.3.m3.1b"><ci id="S3.SS2.SSS0.Px2.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p3.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p3.3.m3.1d">italic_K</annotation></semantics></math> average is then <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS0.Px2.p3.4.2">agnostic</em> to the number of embedding sets <math alttext="P=P_{q}\times P_{x}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p3.4.m4.1"><semantics id="S3.SS2.SSS0.Px2.p3.4.m4.1a"><mrow id="S3.SS2.SSS0.Px2.p3.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.2" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.2.cmml">P</mi><mo id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.1" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.cmml"><msub id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.2" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.2.cmml">P</mi><mi id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.3" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.3.cmml">q</mi></msub><mo id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.1.cmml">×</mo><msub id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.2" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.2.cmml">P</mi><mi id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.3" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.3.cmml">x</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p3.4.m4.1b"><apply id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1"><eq id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.1"></eq><ci id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.2">𝑃</ci><apply id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3"><times id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.1"></times><apply id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.2">𝑃</ci><ci id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.3">𝑞</ci></apply><apply id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.2">𝑃</ci><ci id="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p3.4.m4.1c">P=P_{q}\times P_{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p3.4.m4.1d">italic_P = italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT × italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p4">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p4.5">Formally, let <math alttext="P=P_{q}\cdot P_{x}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p4.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p4.1.m1.1a"><mrow id="S3.SS2.SSS0.Px2.p4.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.2.cmml">P</mi><mo id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.1" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.cmml"><msub id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2.cmml"><mi id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2.2" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2.2.cmml">P</mi><mi id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2.3" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2.3.cmml">q</mi></msub><mo id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.1.cmml">⋅</mo><msub id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3.2" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3.2.cmml">P</mi><mi id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3.3" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3.3.cmml">x</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1"><eq id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.1"></eq><ci id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.2">𝑃</ci><apply id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3"><ci id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.1">⋅</ci><apply id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2.2">𝑃</ci><ci id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.2.3">𝑞</ci></apply><apply id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3.2">𝑃</ci><ci id="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p4.1.m1.1.1.3.3.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.1.m1.1c">P=P_{q}\cdot P_{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p4.1.m1.1d">italic_P = italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⋅ italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> be the number of embedding pairs, where <math alttext="P_{q}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p4.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p4.2.m2.1a"><msub id="S3.SS2.SSS0.Px2.p4.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p4.2.m2.1.1.2" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.1.2.cmml">P</mi><mi id="S3.SS2.SSS0.Px2.p4.2.m2.1.1.3" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.2.m2.1b"><apply id="S3.SS2.SSS0.Px2.p4.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.1.2">𝑃</ci><ci id="S3.SS2.SSS0.Px2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p4.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.2.m2.1c">P_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p4.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> is the number of embeddings of a query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p4.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p4.3.m3.1a"><mi id="S3.SS2.SSS0.Px2.p4.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p4.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.3.m3.1b"><ci id="S3.SS2.SSS0.Px2.p4.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p4.3.m3.1d">italic_q</annotation></semantics></math> and <math alttext="P_{x}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p4.4.m4.1"><semantics id="S3.SS2.SSS0.Px2.p4.4.m4.1a"><msub id="S3.SS2.SSS0.Px2.p4.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p4.4.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p4.4.m4.1.1.2" xref="S3.SS2.SSS0.Px2.p4.4.m4.1.1.2.cmml">P</mi><mi id="S3.SS2.SSS0.Px2.p4.4.m4.1.1.3" xref="S3.SS2.SSS0.Px2.p4.4.m4.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.4.m4.1b"><apply id="S3.SS2.SSS0.Px2.p4.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p4.4.m4.1.1.2">𝑃</ci><ci id="S3.SS2.SSS0.Px2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p4.4.m4.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.4.m4.1c">P_{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p4.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> is that of an item <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p4.5.m5.1"><semantics id="S3.SS2.SSS0.Px2.p4.5.m5.1a"><mi id="S3.SS2.SSS0.Px2.p4.5.m5.1.1" xref="S3.SS2.SSS0.Px2.p4.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p4.5.m5.1b"><ci id="S3.SS2.SSS0.Px2.p4.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px2.p4.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p4.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p4.5.m5.1d">italic_x</annotation></semantics></math>. The average dot product can be computed as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{1}{P}\cdot\sum_{p=1}^{P}{\langle f_{p}(q),g_{p}(x)\rangle}=%
\frac{1}{P}\cdot\sum_{p_{q}=1}^{P_{q}}\sum_{p_{x}=1}^{P_{x}}{\langle f_{p_{q}}%
(q),g_{p_{x}}(x)\rangle}=\frac{1}{P}\cdot\left\langle\sum_{p_{q}=1}^{P_{q}}f_{%
p_{q}}(q),\sum_{p_{x}=1}^{P_{x}}g_{p_{x}}(x)\right\rangle" class="ltx_Math" display="inline" id="S3.E3.m1.12"><semantics id="S3.E3.m1.12a"><mrow id="S3.E3.m1.12.12" xref="S3.E3.m1.12.12.cmml"><mrow id="S3.E3.m1.8.8.2" xref="S3.E3.m1.8.8.2.cmml"><mstyle displaystyle="true" id="S3.E3.m1.8.8.2.4" xref="S3.E3.m1.8.8.2.4.cmml"><mfrac id="S3.E3.m1.8.8.2.4a" xref="S3.E3.m1.8.8.2.4.cmml"><mn id="S3.E3.m1.8.8.2.4.2" xref="S3.E3.m1.8.8.2.4.2.cmml">1</mn><mi id="S3.E3.m1.8.8.2.4.3" xref="S3.E3.m1.8.8.2.4.3.cmml">P</mi></mfrac></mstyle><mo id="S3.E3.m1.8.8.2.3" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.8.8.2.3.cmml">⋅</mo><mrow id="S3.E3.m1.8.8.2.2" xref="S3.E3.m1.8.8.2.2.cmml"><mstyle displaystyle="true" id="S3.E3.m1.8.8.2.2.3" xref="S3.E3.m1.8.8.2.2.3.cmml"><munderover id="S3.E3.m1.8.8.2.2.3a" xref="S3.E3.m1.8.8.2.2.3.cmml"><mo id="S3.E3.m1.8.8.2.2.3.2.2" movablelimits="false" xref="S3.E3.m1.8.8.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.8.8.2.2.3.2.3" xref="S3.E3.m1.8.8.2.2.3.2.3.cmml"><mi id="S3.E3.m1.8.8.2.2.3.2.3.2" xref="S3.E3.m1.8.8.2.2.3.2.3.2.cmml">p</mi><mo id="S3.E3.m1.8.8.2.2.3.2.3.1" xref="S3.E3.m1.8.8.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.8.8.2.2.3.2.3.3" xref="S3.E3.m1.8.8.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.8.8.2.2.3.3" xref="S3.E3.m1.8.8.2.2.3.3.cmml">P</mi></munderover></mstyle><mrow id="S3.E3.m1.8.8.2.2.2.2" xref="S3.E3.m1.8.8.2.2.2.3.cmml"><mo id="S3.E3.m1.8.8.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.8.8.2.2.2.3.cmml">⟨</mo><mrow id="S3.E3.m1.7.7.1.1.1.1.1" xref="S3.E3.m1.7.7.1.1.1.1.1.cmml"><msub id="S3.E3.m1.7.7.1.1.1.1.1.2" xref="S3.E3.m1.7.7.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.7.7.1.1.1.1.1.2.2" xref="S3.E3.m1.7.7.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E3.m1.7.7.1.1.1.1.1.2.3" xref="S3.E3.m1.7.7.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="S3.E3.m1.7.7.1.1.1.1.1.1" xref="S3.E3.m1.7.7.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.7.7.1.1.1.1.1.3.2" xref="S3.E3.m1.7.7.1.1.1.1.1.cmml"><mo id="S3.E3.m1.7.7.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E3.m1.7.7.1.1.1.1.1.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">q</mi><mo id="S3.E3.m1.7.7.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E3.m1.7.7.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.8.8.2.2.2.2.4" xref="S3.E3.m1.8.8.2.2.2.3.cmml">,</mo><mrow id="S3.E3.m1.8.8.2.2.2.2.2" xref="S3.E3.m1.8.8.2.2.2.2.2.cmml"><msub id="S3.E3.m1.8.8.2.2.2.2.2.2" xref="S3.E3.m1.8.8.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.8.8.2.2.2.2.2.2.2" xref="S3.E3.m1.8.8.2.2.2.2.2.2.2.cmml">g</mi><mi id="S3.E3.m1.8.8.2.2.2.2.2.2.3" xref="S3.E3.m1.8.8.2.2.2.2.2.2.3.cmml">p</mi></msub><mo id="S3.E3.m1.8.8.2.2.2.2.2.1" xref="S3.E3.m1.8.8.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.8.8.2.2.2.2.2.3.2" xref="S3.E3.m1.8.8.2.2.2.2.2.cmml"><mo id="S3.E3.m1.8.8.2.2.2.2.2.3.2.1" stretchy="false" xref="S3.E3.m1.8.8.2.2.2.2.2.cmml">(</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">x</mi><mo id="S3.E3.m1.8.8.2.2.2.2.2.3.2.2" stretchy="false" xref="S3.E3.m1.8.8.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.8.8.2.2.2.2.5" stretchy="false" xref="S3.E3.m1.8.8.2.2.2.3.cmml">⟩</mo></mrow></mrow></mrow><mo id="S3.E3.m1.12.12.8" xref="S3.E3.m1.12.12.8.cmml">=</mo><mrow id="S3.E3.m1.10.10.4" xref="S3.E3.m1.10.10.4.cmml"><mstyle displaystyle="true" id="S3.E3.m1.10.10.4.4" xref="S3.E3.m1.10.10.4.4.cmml"><mfrac id="S3.E3.m1.10.10.4.4a" xref="S3.E3.m1.10.10.4.4.cmml"><mn id="S3.E3.m1.10.10.4.4.2" xref="S3.E3.m1.10.10.4.4.2.cmml">1</mn><mi id="S3.E3.m1.10.10.4.4.3" xref="S3.E3.m1.10.10.4.4.3.cmml">P</mi></mfrac></mstyle><mo id="S3.E3.m1.10.10.4.3" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.10.10.4.3.cmml">⋅</mo><mrow id="S3.E3.m1.10.10.4.2" xref="S3.E3.m1.10.10.4.2.cmml"><mstyle displaystyle="true" id="S3.E3.m1.10.10.4.2.3" xref="S3.E3.m1.10.10.4.2.3.cmml"><munderover id="S3.E3.m1.10.10.4.2.3a" xref="S3.E3.m1.10.10.4.2.3.cmml"><mo id="S3.E3.m1.10.10.4.2.3.2.2" movablelimits="false" xref="S3.E3.m1.10.10.4.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.10.10.4.2.3.2.3" xref="S3.E3.m1.10.10.4.2.3.2.3.cmml"><msub id="S3.E3.m1.10.10.4.2.3.2.3.2" xref="S3.E3.m1.10.10.4.2.3.2.3.2.cmml"><mi id="S3.E3.m1.10.10.4.2.3.2.3.2.2" xref="S3.E3.m1.10.10.4.2.3.2.3.2.2.cmml">p</mi><mi id="S3.E3.m1.10.10.4.2.3.2.3.2.3" xref="S3.E3.m1.10.10.4.2.3.2.3.2.3.cmml">q</mi></msub><mo id="S3.E3.m1.10.10.4.2.3.2.3.1" xref="S3.E3.m1.10.10.4.2.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.10.10.4.2.3.2.3.3" xref="S3.E3.m1.10.10.4.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.E3.m1.10.10.4.2.3.3" xref="S3.E3.m1.10.10.4.2.3.3.cmml"><mi id="S3.E3.m1.10.10.4.2.3.3.2" xref="S3.E3.m1.10.10.4.2.3.3.2.cmml">P</mi><mi id="S3.E3.m1.10.10.4.2.3.3.3" xref="S3.E3.m1.10.10.4.2.3.3.3.cmml">q</mi></msub></munderover></mstyle><mrow id="S3.E3.m1.10.10.4.2.2" xref="S3.E3.m1.10.10.4.2.2.cmml"><mstyle displaystyle="true" id="S3.E3.m1.10.10.4.2.2.3" xref="S3.E3.m1.10.10.4.2.2.3.cmml"><munderover id="S3.E3.m1.10.10.4.2.2.3a" xref="S3.E3.m1.10.10.4.2.2.3.cmml"><mo id="S3.E3.m1.10.10.4.2.2.3.2.2" movablelimits="false" xref="S3.E3.m1.10.10.4.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.10.10.4.2.2.3.2.3" xref="S3.E3.m1.10.10.4.2.2.3.2.3.cmml"><msub id="S3.E3.m1.10.10.4.2.2.3.2.3.2" xref="S3.E3.m1.10.10.4.2.2.3.2.3.2.cmml"><mi id="S3.E3.m1.10.10.4.2.2.3.2.3.2.2" xref="S3.E3.m1.10.10.4.2.2.3.2.3.2.2.cmml">p</mi><mi id="S3.E3.m1.10.10.4.2.2.3.2.3.2.3" xref="S3.E3.m1.10.10.4.2.2.3.2.3.2.3.cmml">x</mi></msub><mo id="S3.E3.m1.10.10.4.2.2.3.2.3.1" xref="S3.E3.m1.10.10.4.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.10.10.4.2.2.3.2.3.3" xref="S3.E3.m1.10.10.4.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.E3.m1.10.10.4.2.2.3.3" xref="S3.E3.m1.10.10.4.2.2.3.3.cmml"><mi id="S3.E3.m1.10.10.4.2.2.3.3.2" xref="S3.E3.m1.10.10.4.2.2.3.3.2.cmml">P</mi><mi id="S3.E3.m1.10.10.4.2.2.3.3.3" xref="S3.E3.m1.10.10.4.2.2.3.3.3.cmml">x</mi></msub></munderover></mstyle><mrow id="S3.E3.m1.10.10.4.2.2.2.2" xref="S3.E3.m1.10.10.4.2.2.2.3.cmml"><mo id="S3.E3.m1.10.10.4.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.10.10.4.2.2.2.3.cmml">⟨</mo><mrow id="S3.E3.m1.9.9.3.1.1.1.1.1" xref="S3.E3.m1.9.9.3.1.1.1.1.1.cmml"><msub id="S3.E3.m1.9.9.3.1.1.1.1.1.2" xref="S3.E3.m1.9.9.3.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.9.9.3.1.1.1.1.1.2.2" xref="S3.E3.m1.9.9.3.1.1.1.1.1.2.2.cmml">f</mi><msub id="S3.E3.m1.9.9.3.1.1.1.1.1.2.3" xref="S3.E3.m1.9.9.3.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.9.9.3.1.1.1.1.1.2.3.2" xref="S3.E3.m1.9.9.3.1.1.1.1.1.2.3.2.cmml">p</mi><mi id="S3.E3.m1.9.9.3.1.1.1.1.1.2.3.3" xref="S3.E3.m1.9.9.3.1.1.1.1.1.2.3.3.cmml">q</mi></msub></msub><mo id="S3.E3.m1.9.9.3.1.1.1.1.1.1" xref="S3.E3.m1.9.9.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.9.9.3.1.1.1.1.1.3.2" xref="S3.E3.m1.9.9.3.1.1.1.1.1.cmml"><mo id="S3.E3.m1.9.9.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E3.m1.9.9.3.1.1.1.1.1.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">q</mi><mo id="S3.E3.m1.9.9.3.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E3.m1.9.9.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.10.10.4.2.2.2.2.4" xref="S3.E3.m1.10.10.4.2.2.2.3.cmml">,</mo><mrow id="S3.E3.m1.10.10.4.2.2.2.2.2" xref="S3.E3.m1.10.10.4.2.2.2.2.2.cmml"><msub id="S3.E3.m1.10.10.4.2.2.2.2.2.2" xref="S3.E3.m1.10.10.4.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.10.10.4.2.2.2.2.2.2.2" xref="S3.E3.m1.10.10.4.2.2.2.2.2.2.2.cmml">g</mi><msub id="S3.E3.m1.10.10.4.2.2.2.2.2.2.3" xref="S3.E3.m1.10.10.4.2.2.2.2.2.2.3.cmml"><mi id="S3.E3.m1.10.10.4.2.2.2.2.2.2.3.2" xref="S3.E3.m1.10.10.4.2.2.2.2.2.2.3.2.cmml">p</mi><mi id="S3.E3.m1.10.10.4.2.2.2.2.2.2.3.3" xref="S3.E3.m1.10.10.4.2.2.2.2.2.2.3.3.cmml">x</mi></msub></msub><mo id="S3.E3.m1.10.10.4.2.2.2.2.2.1" xref="S3.E3.m1.10.10.4.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.10.10.4.2.2.2.2.2.3.2" xref="S3.E3.m1.10.10.4.2.2.2.2.2.cmml"><mo id="S3.E3.m1.10.10.4.2.2.2.2.2.3.2.1" stretchy="false" xref="S3.E3.m1.10.10.4.2.2.2.2.2.cmml">(</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">x</mi><mo id="S3.E3.m1.10.10.4.2.2.2.2.2.3.2.2" stretchy="false" xref="S3.E3.m1.10.10.4.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.10.10.4.2.2.2.2.5" stretchy="false" xref="S3.E3.m1.10.10.4.2.2.2.3.cmml">⟩</mo></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.12.12.9" xref="S3.E3.m1.12.12.9.cmml">=</mo><mrow id="S3.E3.m1.12.12.6" xref="S3.E3.m1.12.12.6.cmml"><mstyle displaystyle="true" id="S3.E3.m1.12.12.6.4" xref="S3.E3.m1.12.12.6.4.cmml"><mfrac id="S3.E3.m1.12.12.6.4a" xref="S3.E3.m1.12.12.6.4.cmml"><mn id="S3.E3.m1.12.12.6.4.2" xref="S3.E3.m1.12.12.6.4.2.cmml">1</mn><mi id="S3.E3.m1.12.12.6.4.3" xref="S3.E3.m1.12.12.6.4.3.cmml">P</mi></mfrac></mstyle><mo id="S3.E3.m1.12.12.6.3" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.12.12.6.3.cmml">⋅</mo><mrow id="S3.E3.m1.12.12.6.2.2" xref="S3.E3.m1.12.12.6.2.3.cmml"><mo id="S3.E3.m1.12.12.6.2.2.3" xref="S3.E3.m1.12.12.6.2.3.cmml">⟨</mo><mrow id="S3.E3.m1.11.11.5.1.1.1" xref="S3.E3.m1.11.11.5.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E3.m1.11.11.5.1.1.1.1" xref="S3.E3.m1.11.11.5.1.1.1.1.cmml"><munderover id="S3.E3.m1.11.11.5.1.1.1.1a" xref="S3.E3.m1.11.11.5.1.1.1.1.cmml"><mo id="S3.E3.m1.11.11.5.1.1.1.1.2.2" movablelimits="false" xref="S3.E3.m1.11.11.5.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.11.11.5.1.1.1.1.2.3" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3.cmml"><msub id="S3.E3.m1.11.11.5.1.1.1.1.2.3.2" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3.2.cmml"><mi id="S3.E3.m1.11.11.5.1.1.1.1.2.3.2.2" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3.2.2.cmml">p</mi><mi id="S3.E3.m1.11.11.5.1.1.1.1.2.3.2.3" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3.2.3.cmml">q</mi></msub><mo id="S3.E3.m1.11.11.5.1.1.1.1.2.3.1" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.11.11.5.1.1.1.1.2.3.3" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E3.m1.11.11.5.1.1.1.1.3" xref="S3.E3.m1.11.11.5.1.1.1.1.3.cmml"><mi id="S3.E3.m1.11.11.5.1.1.1.1.3.2" xref="S3.E3.m1.11.11.5.1.1.1.1.3.2.cmml">P</mi><mi id="S3.E3.m1.11.11.5.1.1.1.1.3.3" xref="S3.E3.m1.11.11.5.1.1.1.1.3.3.cmml">q</mi></msub></munderover></mstyle><mrow id="S3.E3.m1.11.11.5.1.1.1.2" xref="S3.E3.m1.11.11.5.1.1.1.2.cmml"><msub id="S3.E3.m1.11.11.5.1.1.1.2.2" xref="S3.E3.m1.11.11.5.1.1.1.2.2.cmml"><mi id="S3.E3.m1.11.11.5.1.1.1.2.2.2" xref="S3.E3.m1.11.11.5.1.1.1.2.2.2.cmml">f</mi><msub id="S3.E3.m1.11.11.5.1.1.1.2.2.3" xref="S3.E3.m1.11.11.5.1.1.1.2.2.3.cmml"><mi id="S3.E3.m1.11.11.5.1.1.1.2.2.3.2" xref="S3.E3.m1.11.11.5.1.1.1.2.2.3.2.cmml">p</mi><mi id="S3.E3.m1.11.11.5.1.1.1.2.2.3.3" xref="S3.E3.m1.11.11.5.1.1.1.2.2.3.3.cmml">q</mi></msub></msub><mo id="S3.E3.m1.11.11.5.1.1.1.2.1" xref="S3.E3.m1.11.11.5.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.11.11.5.1.1.1.2.3.2" xref="S3.E3.m1.11.11.5.1.1.1.2.cmml"><mo id="S3.E3.m1.11.11.5.1.1.1.2.3.2.1" stretchy="false" xref="S3.E3.m1.11.11.5.1.1.1.2.cmml">(</mo><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">q</mi><mo id="S3.E3.m1.11.11.5.1.1.1.2.3.2.2" stretchy="false" xref="S3.E3.m1.11.11.5.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.12.12.6.2.2.4" xref="S3.E3.m1.12.12.6.2.3.cmml">,</mo><mrow id="S3.E3.m1.12.12.6.2.2.2" xref="S3.E3.m1.12.12.6.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E3.m1.12.12.6.2.2.2.1" xref="S3.E3.m1.12.12.6.2.2.2.1.cmml"><munderover id="S3.E3.m1.12.12.6.2.2.2.1a" xref="S3.E3.m1.12.12.6.2.2.2.1.cmml"><mo id="S3.E3.m1.12.12.6.2.2.2.1.2.2" movablelimits="false" xref="S3.E3.m1.12.12.6.2.2.2.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.12.12.6.2.2.2.1.2.3" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3.cmml"><msub id="S3.E3.m1.12.12.6.2.2.2.1.2.3.2" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3.2.cmml"><mi id="S3.E3.m1.12.12.6.2.2.2.1.2.3.2.2" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3.2.2.cmml">p</mi><mi id="S3.E3.m1.12.12.6.2.2.2.1.2.3.2.3" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3.2.3.cmml">x</mi></msub><mo id="S3.E3.m1.12.12.6.2.2.2.1.2.3.1" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.12.12.6.2.2.2.1.2.3.3" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E3.m1.12.12.6.2.2.2.1.3" xref="S3.E3.m1.12.12.6.2.2.2.1.3.cmml"><mi id="S3.E3.m1.12.12.6.2.2.2.1.3.2" xref="S3.E3.m1.12.12.6.2.2.2.1.3.2.cmml">P</mi><mi id="S3.E3.m1.12.12.6.2.2.2.1.3.3" xref="S3.E3.m1.12.12.6.2.2.2.1.3.3.cmml">x</mi></msub></munderover></mstyle><mrow id="S3.E3.m1.12.12.6.2.2.2.2" xref="S3.E3.m1.12.12.6.2.2.2.2.cmml"><msub id="S3.E3.m1.12.12.6.2.2.2.2.2" xref="S3.E3.m1.12.12.6.2.2.2.2.2.cmml"><mi id="S3.E3.m1.12.12.6.2.2.2.2.2.2" xref="S3.E3.m1.12.12.6.2.2.2.2.2.2.cmml">g</mi><msub id="S3.E3.m1.12.12.6.2.2.2.2.2.3" xref="S3.E3.m1.12.12.6.2.2.2.2.2.3.cmml"><mi id="S3.E3.m1.12.12.6.2.2.2.2.2.3.2" xref="S3.E3.m1.12.12.6.2.2.2.2.2.3.2.cmml">p</mi><mi id="S3.E3.m1.12.12.6.2.2.2.2.2.3.3" xref="S3.E3.m1.12.12.6.2.2.2.2.2.3.3.cmml">x</mi></msub></msub><mo id="S3.E3.m1.12.12.6.2.2.2.2.1" xref="S3.E3.m1.12.12.6.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.12.12.6.2.2.2.2.3.2" xref="S3.E3.m1.12.12.6.2.2.2.2.cmml"><mo id="S3.E3.m1.12.12.6.2.2.2.2.3.2.1" stretchy="false" xref="S3.E3.m1.12.12.6.2.2.2.2.cmml">(</mo><mi id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml">x</mi><mo id="S3.E3.m1.12.12.6.2.2.2.2.3.2.2" stretchy="false" xref="S3.E3.m1.12.12.6.2.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.12.12.6.2.2.5" xref="S3.E3.m1.12.12.6.2.3.cmml">⟩</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.12b"><apply id="S3.E3.m1.12.12.cmml" xref="S3.E3.m1.12.12"><and id="S3.E3.m1.12.12a.cmml" xref="S3.E3.m1.12.12"></and><apply id="S3.E3.m1.12.12b.cmml" xref="S3.E3.m1.12.12"><eq id="S3.E3.m1.12.12.8.cmml" xref="S3.E3.m1.12.12.8"></eq><apply id="S3.E3.m1.8.8.2.cmml" xref="S3.E3.m1.8.8.2"><ci id="S3.E3.m1.8.8.2.3.cmml" xref="S3.E3.m1.8.8.2.3">⋅</ci><apply id="S3.E3.m1.8.8.2.4.cmml" xref="S3.E3.m1.8.8.2.4"><divide id="S3.E3.m1.8.8.2.4.1.cmml" xref="S3.E3.m1.8.8.2.4"></divide><cn id="S3.E3.m1.8.8.2.4.2.cmml" type="integer" xref="S3.E3.m1.8.8.2.4.2">1</cn><ci id="S3.E3.m1.8.8.2.4.3.cmml" xref="S3.E3.m1.8.8.2.4.3">𝑃</ci></apply><apply id="S3.E3.m1.8.8.2.2.cmml" xref="S3.E3.m1.8.8.2.2"><apply id="S3.E3.m1.8.8.2.2.3.cmml" xref="S3.E3.m1.8.8.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.2.2.3.1.cmml" xref="S3.E3.m1.8.8.2.2.3">superscript</csymbol><apply id="S3.E3.m1.8.8.2.2.3.2.cmml" xref="S3.E3.m1.8.8.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.2.2.3.2.1.cmml" xref="S3.E3.m1.8.8.2.2.3">subscript</csymbol><sum id="S3.E3.m1.8.8.2.2.3.2.2.cmml" xref="S3.E3.m1.8.8.2.2.3.2.2"></sum><apply id="S3.E3.m1.8.8.2.2.3.2.3.cmml" xref="S3.E3.m1.8.8.2.2.3.2.3"><eq id="S3.E3.m1.8.8.2.2.3.2.3.1.cmml" xref="S3.E3.m1.8.8.2.2.3.2.3.1"></eq><ci id="S3.E3.m1.8.8.2.2.3.2.3.2.cmml" xref="S3.E3.m1.8.8.2.2.3.2.3.2">𝑝</ci><cn id="S3.E3.m1.8.8.2.2.3.2.3.3.cmml" type="integer" xref="S3.E3.m1.8.8.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.8.8.2.2.3.3.cmml" xref="S3.E3.m1.8.8.2.2.3.3">𝑃</ci></apply><list id="S3.E3.m1.8.8.2.2.2.3.cmml" xref="S3.E3.m1.8.8.2.2.2.2"><apply id="S3.E3.m1.7.7.1.1.1.1.1.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1"><times id="S3.E3.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1.1"></times><apply id="S3.E3.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E3.m1.7.7.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑞</ci></apply><apply id="S3.E3.m1.8.8.2.2.2.2.2.cmml" xref="S3.E3.m1.8.8.2.2.2.2.2"><times id="S3.E3.m1.8.8.2.2.2.2.2.1.cmml" xref="S3.E3.m1.8.8.2.2.2.2.2.1"></times><apply id="S3.E3.m1.8.8.2.2.2.2.2.2.cmml" xref="S3.E3.m1.8.8.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.8.8.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.8.8.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.8.8.2.2.2.2.2.2.2">𝑔</ci><ci id="S3.E3.m1.8.8.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.8.8.2.2.2.2.2.2.3">𝑝</ci></apply><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝑥</ci></apply></list></apply></apply><apply id="S3.E3.m1.10.10.4.cmml" xref="S3.E3.m1.10.10.4"><ci id="S3.E3.m1.10.10.4.3.cmml" xref="S3.E3.m1.10.10.4.3">⋅</ci><apply id="S3.E3.m1.10.10.4.4.cmml" xref="S3.E3.m1.10.10.4.4"><divide id="S3.E3.m1.10.10.4.4.1.cmml" xref="S3.E3.m1.10.10.4.4"></divide><cn id="S3.E3.m1.10.10.4.4.2.cmml" type="integer" xref="S3.E3.m1.10.10.4.4.2">1</cn><ci id="S3.E3.m1.10.10.4.4.3.cmml" xref="S3.E3.m1.10.10.4.4.3">𝑃</ci></apply><apply id="S3.E3.m1.10.10.4.2.cmml" xref="S3.E3.m1.10.10.4.2"><apply id="S3.E3.m1.10.10.4.2.3.cmml" xref="S3.E3.m1.10.10.4.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.4.2.3.1.cmml" xref="S3.E3.m1.10.10.4.2.3">superscript</csymbol><apply id="S3.E3.m1.10.10.4.2.3.2.cmml" xref="S3.E3.m1.10.10.4.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.4.2.3.2.1.cmml" xref="S3.E3.m1.10.10.4.2.3">subscript</csymbol><sum id="S3.E3.m1.10.10.4.2.3.2.2.cmml" xref="S3.E3.m1.10.10.4.2.3.2.2"></sum><apply id="S3.E3.m1.10.10.4.2.3.2.3.cmml" xref="S3.E3.m1.10.10.4.2.3.2.3"><eq id="S3.E3.m1.10.10.4.2.3.2.3.1.cmml" xref="S3.E3.m1.10.10.4.2.3.2.3.1"></eq><apply id="S3.E3.m1.10.10.4.2.3.2.3.2.cmml" xref="S3.E3.m1.10.10.4.2.3.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.4.2.3.2.3.2.1.cmml" xref="S3.E3.m1.10.10.4.2.3.2.3.2">subscript</csymbol><ci id="S3.E3.m1.10.10.4.2.3.2.3.2.2.cmml" xref="S3.E3.m1.10.10.4.2.3.2.3.2.2">𝑝</ci><ci id="S3.E3.m1.10.10.4.2.3.2.3.2.3.cmml" xref="S3.E3.m1.10.10.4.2.3.2.3.2.3">𝑞</ci></apply><cn id="S3.E3.m1.10.10.4.2.3.2.3.3.cmml" type="integer" xref="S3.E3.m1.10.10.4.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.10.10.4.2.3.3.cmml" xref="S3.E3.m1.10.10.4.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.4.2.3.3.1.cmml" xref="S3.E3.m1.10.10.4.2.3.3">subscript</csymbol><ci id="S3.E3.m1.10.10.4.2.3.3.2.cmml" xref="S3.E3.m1.10.10.4.2.3.3.2">𝑃</ci><ci id="S3.E3.m1.10.10.4.2.3.3.3.cmml" xref="S3.E3.m1.10.10.4.2.3.3.3">𝑞</ci></apply></apply><apply id="S3.E3.m1.10.10.4.2.2.cmml" xref="S3.E3.m1.10.10.4.2.2"><apply id="S3.E3.m1.10.10.4.2.2.3.cmml" xref="S3.E3.m1.10.10.4.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.4.2.2.3.1.cmml" xref="S3.E3.m1.10.10.4.2.2.3">superscript</csymbol><apply id="S3.E3.m1.10.10.4.2.2.3.2.cmml" xref="S3.E3.m1.10.10.4.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.4.2.2.3.2.1.cmml" xref="S3.E3.m1.10.10.4.2.2.3">subscript</csymbol><sum id="S3.E3.m1.10.10.4.2.2.3.2.2.cmml" xref="S3.E3.m1.10.10.4.2.2.3.2.2"></sum><apply id="S3.E3.m1.10.10.4.2.2.3.2.3.cmml" xref="S3.E3.m1.10.10.4.2.2.3.2.3"><eq id="S3.E3.m1.10.10.4.2.2.3.2.3.1.cmml" xref="S3.E3.m1.10.10.4.2.2.3.2.3.1"></eq><apply id="S3.E3.m1.10.10.4.2.2.3.2.3.2.cmml" xref="S3.E3.m1.10.10.4.2.2.3.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.4.2.2.3.2.3.2.1.cmml" xref="S3.E3.m1.10.10.4.2.2.3.2.3.2">subscript</csymbol><ci id="S3.E3.m1.10.10.4.2.2.3.2.3.2.2.cmml" xref="S3.E3.m1.10.10.4.2.2.3.2.3.2.2">𝑝</ci><ci id="S3.E3.m1.10.10.4.2.2.3.2.3.2.3.cmml" xref="S3.E3.m1.10.10.4.2.2.3.2.3.2.3">𝑥</ci></apply><cn id="S3.E3.m1.10.10.4.2.2.3.2.3.3.cmml" type="integer" xref="S3.E3.m1.10.10.4.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.10.10.4.2.2.3.3.cmml" xref="S3.E3.m1.10.10.4.2.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.4.2.2.3.3.1.cmml" xref="S3.E3.m1.10.10.4.2.2.3.3">subscript</csymbol><ci id="S3.E3.m1.10.10.4.2.2.3.3.2.cmml" xref="S3.E3.m1.10.10.4.2.2.3.3.2">𝑃</ci><ci id="S3.E3.m1.10.10.4.2.2.3.3.3.cmml" xref="S3.E3.m1.10.10.4.2.2.3.3.3">𝑥</ci></apply></apply><list id="S3.E3.m1.10.10.4.2.2.2.3.cmml" xref="S3.E3.m1.10.10.4.2.2.2.2"><apply id="S3.E3.m1.9.9.3.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.3.1.1.1.1.1"><times id="S3.E3.m1.9.9.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.3.1.1.1.1.1.1"></times><apply id="S3.E3.m1.9.9.3.1.1.1.1.1.2.cmml" xref="S3.E3.m1.9.9.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.3.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.9.9.3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.9.9.3.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.9.9.3.1.1.1.1.1.2.2">𝑓</ci><apply id="S3.E3.m1.9.9.3.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.9.9.3.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.3.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.9.9.3.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.9.9.3.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.9.9.3.1.1.1.1.1.2.3.2">𝑝</ci><ci id="S3.E3.m1.9.9.3.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.9.9.3.1.1.1.1.1.2.3.3">𝑞</ci></apply></apply><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑞</ci></apply><apply id="S3.E3.m1.10.10.4.2.2.2.2.2.cmml" xref="S3.E3.m1.10.10.4.2.2.2.2.2"><times id="S3.E3.m1.10.10.4.2.2.2.2.2.1.cmml" xref="S3.E3.m1.10.10.4.2.2.2.2.2.1"></times><apply id="S3.E3.m1.10.10.4.2.2.2.2.2.2.cmml" xref="S3.E3.m1.10.10.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.4.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.10.10.4.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.10.10.4.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.10.10.4.2.2.2.2.2.2.2">𝑔</ci><apply id="S3.E3.m1.10.10.4.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.10.10.4.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.4.2.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.10.10.4.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.10.10.4.2.2.2.2.2.2.3.2.cmml" xref="S3.E3.m1.10.10.4.2.2.2.2.2.2.3.2">𝑝</ci><ci id="S3.E3.m1.10.10.4.2.2.2.2.2.2.3.3.cmml" xref="S3.E3.m1.10.10.4.2.2.2.2.2.2.3.3">𝑥</ci></apply></apply><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝑥</ci></apply></list></apply></apply></apply></apply><apply id="S3.E3.m1.12.12c.cmml" xref="S3.E3.m1.12.12"><eq id="S3.E3.m1.12.12.9.cmml" xref="S3.E3.m1.12.12.9"></eq><share href="https://arxiv.org/html/2407.15462v2#S3.E3.m1.10.10.4.cmml" id="S3.E3.m1.12.12d.cmml" xref="S3.E3.m1.12.12"></share><apply id="S3.E3.m1.12.12.6.cmml" xref="S3.E3.m1.12.12.6"><ci id="S3.E3.m1.12.12.6.3.cmml" xref="S3.E3.m1.12.12.6.3">⋅</ci><apply id="S3.E3.m1.12.12.6.4.cmml" xref="S3.E3.m1.12.12.6.4"><divide id="S3.E3.m1.12.12.6.4.1.cmml" xref="S3.E3.m1.12.12.6.4"></divide><cn id="S3.E3.m1.12.12.6.4.2.cmml" type="integer" xref="S3.E3.m1.12.12.6.4.2">1</cn><ci id="S3.E3.m1.12.12.6.4.3.cmml" xref="S3.E3.m1.12.12.6.4.3">𝑃</ci></apply><list id="S3.E3.m1.12.12.6.2.3.cmml" xref="S3.E3.m1.12.12.6.2.2"><apply id="S3.E3.m1.11.11.5.1.1.1.cmml" xref="S3.E3.m1.11.11.5.1.1.1"><apply id="S3.E3.m1.11.11.5.1.1.1.1.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.5.1.1.1.1.1.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.11.11.5.1.1.1.1.2.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.5.1.1.1.1.2.1.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1">subscript</csymbol><sum id="S3.E3.m1.11.11.5.1.1.1.1.2.2.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1.2.2"></sum><apply id="S3.E3.m1.11.11.5.1.1.1.1.2.3.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3"><eq id="S3.E3.m1.11.11.5.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3.1"></eq><apply id="S3.E3.m1.11.11.5.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.5.1.1.1.1.2.3.2.1.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.E3.m1.11.11.5.1.1.1.1.2.3.2.2.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3.2.2">𝑝</ci><ci id="S3.E3.m1.11.11.5.1.1.1.1.2.3.2.3.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3.2.3">𝑞</ci></apply><cn id="S3.E3.m1.11.11.5.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.11.11.5.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.11.11.5.1.1.1.1.3.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.5.1.1.1.1.3.1.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.11.11.5.1.1.1.1.3.2.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1.3.2">𝑃</ci><ci id="S3.E3.m1.11.11.5.1.1.1.1.3.3.cmml" xref="S3.E3.m1.11.11.5.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S3.E3.m1.11.11.5.1.1.1.2.cmml" xref="S3.E3.m1.11.11.5.1.1.1.2"><times id="S3.E3.m1.11.11.5.1.1.1.2.1.cmml" xref="S3.E3.m1.11.11.5.1.1.1.2.1"></times><apply id="S3.E3.m1.11.11.5.1.1.1.2.2.cmml" xref="S3.E3.m1.11.11.5.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.5.1.1.1.2.2.1.cmml" xref="S3.E3.m1.11.11.5.1.1.1.2.2">subscript</csymbol><ci id="S3.E3.m1.11.11.5.1.1.1.2.2.2.cmml" xref="S3.E3.m1.11.11.5.1.1.1.2.2.2">𝑓</ci><apply id="S3.E3.m1.11.11.5.1.1.1.2.2.3.cmml" xref="S3.E3.m1.11.11.5.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.5.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.11.11.5.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E3.m1.11.11.5.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.11.11.5.1.1.1.2.2.3.2">𝑝</ci><ci id="S3.E3.m1.11.11.5.1.1.1.2.2.3.3.cmml" xref="S3.E3.m1.11.11.5.1.1.1.2.2.3.3">𝑞</ci></apply></apply><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">𝑞</ci></apply></apply><apply id="S3.E3.m1.12.12.6.2.2.2.cmml" xref="S3.E3.m1.12.12.6.2.2.2"><apply id="S3.E3.m1.12.12.6.2.2.2.1.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.6.2.2.2.1.1.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1">superscript</csymbol><apply id="S3.E3.m1.12.12.6.2.2.2.1.2.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.6.2.2.2.1.2.1.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1">subscript</csymbol><sum id="S3.E3.m1.12.12.6.2.2.2.1.2.2.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1.2.2"></sum><apply id="S3.E3.m1.12.12.6.2.2.2.1.2.3.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3"><eq id="S3.E3.m1.12.12.6.2.2.2.1.2.3.1.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3.1"></eq><apply id="S3.E3.m1.12.12.6.2.2.2.1.2.3.2.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.6.2.2.2.1.2.3.2.1.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3.2">subscript</csymbol><ci id="S3.E3.m1.12.12.6.2.2.2.1.2.3.2.2.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3.2.2">𝑝</ci><ci id="S3.E3.m1.12.12.6.2.2.2.1.2.3.2.3.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3.2.3">𝑥</ci></apply><cn id="S3.E3.m1.12.12.6.2.2.2.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.12.12.6.2.2.2.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.12.12.6.2.2.2.1.3.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.6.2.2.2.1.3.1.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1.3">subscript</csymbol><ci id="S3.E3.m1.12.12.6.2.2.2.1.3.2.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1.3.2">𝑃</ci><ci id="S3.E3.m1.12.12.6.2.2.2.1.3.3.cmml" xref="S3.E3.m1.12.12.6.2.2.2.1.3.3">𝑥</ci></apply></apply><apply id="S3.E3.m1.12.12.6.2.2.2.2.cmml" xref="S3.E3.m1.12.12.6.2.2.2.2"><times id="S3.E3.m1.12.12.6.2.2.2.2.1.cmml" xref="S3.E3.m1.12.12.6.2.2.2.2.1"></times><apply id="S3.E3.m1.12.12.6.2.2.2.2.2.cmml" xref="S3.E3.m1.12.12.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.6.2.2.2.2.2.1.cmml" xref="S3.E3.m1.12.12.6.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.12.12.6.2.2.2.2.2.2.cmml" xref="S3.E3.m1.12.12.6.2.2.2.2.2.2">𝑔</ci><apply id="S3.E3.m1.12.12.6.2.2.2.2.2.3.cmml" xref="S3.E3.m1.12.12.6.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.6.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.12.12.6.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.12.12.6.2.2.2.2.2.3.2.cmml" xref="S3.E3.m1.12.12.6.2.2.2.2.2.3.2">𝑝</ci><ci id="S3.E3.m1.12.12.6.2.2.2.2.2.3.3.cmml" xref="S3.E3.m1.12.12.6.2.2.2.2.2.3.3">𝑥</ci></apply></apply><ci id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6">𝑥</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.12c">\displaystyle\frac{1}{P}\cdot\sum_{p=1}^{P}{\langle f_{p}(q),g_{p}(x)\rangle}=%
\frac{1}{P}\cdot\sum_{p_{q}=1}^{P_{q}}\sum_{p_{x}=1}^{P_{x}}{\langle f_{p_{q}}%
(q),g_{p_{x}}(x)\rangle}=\frac{1}{P}\cdot\left\langle\sum_{p_{q}=1}^{P_{q}}f_{%
p_{q}}(q),\sum_{p_{x}=1}^{P_{x}}g_{p_{x}}(x)\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.12d">divide start_ARG 1 end_ARG start_ARG italic_P end_ARG ⋅ ∑ start_POSTSUBSCRIPT italic_p = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P end_POSTSUPERSCRIPT ⟨ italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ⟩ = divide start_ARG 1 end_ARG start_ARG italic_P end_ARG ⋅ ∑ start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ⟨ italic_f start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x ) ⟩ = divide start_ARG 1 end_ARG start_ARG italic_P end_ARG ⋅ ⟨ ∑ start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_q ) , ∑ start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_g start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x ) ⟩</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p5">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p5.2">Thus, we can preprocess the embeddings of the items and the query, so the number of embeddings accessed is <math alttext="1" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p5.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p5.1.m1.1a"><mn id="S3.SS2.SSS0.Px2.p5.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p5.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p5.1.m1.1b"><cn id="S3.SS2.SSS0.Px2.p5.1.m1.1.1.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p5.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p5.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p5.1.m1.1d">1</annotation></semantics></math> per item for a given query, regardless of the overall number of component-level embeddings used by <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px2.p5.2.1">MoL</span>, i.e., <math alttext="P" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p5.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p5.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p5.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p5.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p5.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p5.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p5.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p5.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p5.2.m2.1d">italic_P</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p6">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p6.2">Finally, we can combine the candidates retrieved from top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p6.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p6.1.m1.1a"><mi id="S3.SS2.SSS0.Px2.p6.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p6.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p6.1.m1.1b"><ci id="S3.SS2.SSS0.Px2.p6.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p6.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p6.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p6.1.m1.1d">italic_K</annotation></semantics></math> per embedding group and the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p6.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p6.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p6.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p6.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p6.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p6.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p6.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p6.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p6.2.m2.1d">italic_K</annotation></semantics></math> average as the following:</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Combined top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.1.m1.1"><semantics id="S3.SS2.SSS0.Px3.1.m1.1b"><mi id="S3.SS2.SSS0.Px3.1.m1.1.1" xref="S3.SS2.SSS0.Px3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.1.m1.1c"><ci id="S3.SS2.SSS0.Px3.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.1.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.1.m1.1e">italic_K</annotation></semantics></math>.</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px3.p1.7">Given a query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px3.p1.1.m1.1a"><mi id="S3.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.1.m1.1b"><ci id="S3.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.1.m1.1d">italic_q</annotation></semantics></math>, a set of items <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px3.p1.2.m2.1a"><mi id="S3.SS2.SSS0.Px3.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px3.p1.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.2.m2.1d">italic_X</annotation></semantics></math>, and <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px3.p1.3.m3.1a"><mi id="S3.SS2.SSS0.Px3.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px3.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.3.m3.1d">italic_K</annotation></semantics></math>, return the union of the items from the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px3.p1.4.m4.1a"><mi id="S3.SS2.SSS0.Px3.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px3.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.4.m4.1b"><ci id="S3.SS2.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.4.m4.1d">italic_K</annotation></semantics></math> per embedding group across the <math alttext="P" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.5.m5.1"><semantics id="S3.SS2.SSS0.Px3.p1.5.m5.1a"><mi id="S3.SS2.SSS0.Px3.p1.5.m5.1.1" xref="S3.SS2.SSS0.Px3.p1.5.m5.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.5.m5.1b"><ci id="S3.SS2.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.5.m5.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.5.m5.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.5.m5.1d">italic_P</annotation></semantics></math> groups and the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.6.m6.1"><semantics id="S3.SS2.SSS0.Px3.p1.6.m6.1a"><mi id="S3.SS2.SSS0.Px3.p1.6.m6.1.1" xref="S3.SS2.SSS0.Px3.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.6.m6.1b"><ci id="S3.SS2.SSS0.Px3.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.6.m6.1d">italic_K</annotation></semantics></math> items from the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.7.m7.1"><semantics id="S3.SS2.SSS0.Px3.p1.7.m7.1a"><mi id="S3.SS2.SSS0.Px3.p1.7.m7.1.1" xref="S3.SS2.SSS0.Px3.p1.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.7.m7.1b"><ci id="S3.SS2.SSS0.Px3.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.7.m7.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.7.m7.1d">italic_K</annotation></semantics></math> average.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="Thmtheorem3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmtheorem3.1.1.1">Theorem 3</span></span><span class="ltx_text ltx_font_bold" id="Thmtheorem3.2.2">.</span>
</h6>
<div class="ltx_para" id="Thmtheorem3.p1">
<p class="ltx_p" id="Thmtheorem3.p1.10"><span class="ltx_text ltx_font_bold ltx_font_italic" id="Thmtheorem3.p1.10.10">Upper bound of the gap of combined top <math alttext="K" class="ltx_Math" display="inline" id="Thmtheorem3.p1.1.1.m1.1"><semantics id="Thmtheorem3.p1.1.1.m1.1a"><mi id="Thmtheorem3.p1.1.1.m1.1.1" mathvariant="normal" xref="Thmtheorem3.p1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.1.1.m1.1b"><ci id="Thmtheorem3.p1.1.1.m1.1.1.cmml" xref="Thmtheorem3.p1.1.1.m1.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.1.1.m1.1d">italic_K</annotation></semantics></math>.<span class="ltx_text ltx_font_medium" id="Thmtheorem3.p1.10.10.9"> Let <math alttext="X_{K,p}" class="ltx_Math" display="inline" id="Thmtheorem3.p1.2.2.1.m1.2"><semantics id="Thmtheorem3.p1.2.2.1.m1.2a"><msub id="Thmtheorem3.p1.2.2.1.m1.2.3" xref="Thmtheorem3.p1.2.2.1.m1.2.3.cmml"><mi id="Thmtheorem3.p1.2.2.1.m1.2.3.2" mathvariant="normal" xref="Thmtheorem3.p1.2.2.1.m1.2.3.2.cmml">X</mi><mrow id="Thmtheorem3.p1.2.2.1.m1.2.2.2.4" xref="Thmtheorem3.p1.2.2.1.m1.2.2.2.3.cmml"><mi id="Thmtheorem3.p1.2.2.1.m1.1.1.1.1" mathvariant="normal" xref="Thmtheorem3.p1.2.2.1.m1.1.1.1.1.cmml">K</mi><mo id="Thmtheorem3.p1.2.2.1.m1.2.2.2.4.1" xref="Thmtheorem3.p1.2.2.1.m1.2.2.2.3.cmml">,</mo><mi id="Thmtheorem3.p1.2.2.1.m1.2.2.2.2" mathvariant="normal" xref="Thmtheorem3.p1.2.2.1.m1.2.2.2.2.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.2.2.1.m1.2b"><apply id="Thmtheorem3.p1.2.2.1.m1.2.3.cmml" xref="Thmtheorem3.p1.2.2.1.m1.2.3"><csymbol cd="ambiguous" id="Thmtheorem3.p1.2.2.1.m1.2.3.1.cmml" xref="Thmtheorem3.p1.2.2.1.m1.2.3">subscript</csymbol><ci id="Thmtheorem3.p1.2.2.1.m1.2.3.2.cmml" xref="Thmtheorem3.p1.2.2.1.m1.2.3.2">X</ci><list id="Thmtheorem3.p1.2.2.1.m1.2.2.2.3.cmml" xref="Thmtheorem3.p1.2.2.1.m1.2.2.2.4"><ci id="Thmtheorem3.p1.2.2.1.m1.1.1.1.1.cmml" xref="Thmtheorem3.p1.2.2.1.m1.1.1.1.1">K</ci><ci id="Thmtheorem3.p1.2.2.1.m1.2.2.2.2.cmml" xref="Thmtheorem3.p1.2.2.1.m1.2.2.2.2">p</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.2.2.1.m1.2c">X_{K,p}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.2.2.1.m1.2d">italic_X start_POSTSUBSCRIPT italic_K , italic_p end_POSTSUBSCRIPT</annotation></semantics></math> be the top <math alttext="K" class="ltx_Math" display="inline" id="Thmtheorem3.p1.3.3.2.m2.1"><semantics id="Thmtheorem3.p1.3.3.2.m2.1a"><mi id="Thmtheorem3.p1.3.3.2.m2.1.1" mathvariant="normal" xref="Thmtheorem3.p1.3.3.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.3.3.2.m2.1b"><ci id="Thmtheorem3.p1.3.3.2.m2.1.1.cmml" xref="Thmtheorem3.p1.3.3.2.m2.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.3.3.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.3.3.2.m2.1d">italic_K</annotation></semantics></math> items of the embedding set <math alttext="p" class="ltx_Math" display="inline" id="Thmtheorem3.p1.4.4.3.m3.1"><semantics id="Thmtheorem3.p1.4.4.3.m3.1a"><mi id="Thmtheorem3.p1.4.4.3.m3.1.1" mathvariant="normal" xref="Thmtheorem3.p1.4.4.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.4.4.3.m3.1b"><ci id="Thmtheorem3.p1.4.4.3.m3.1.1.cmml" xref="Thmtheorem3.p1.4.4.3.m3.1.1">p</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.4.4.3.m3.1c">p</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.4.4.3.m3.1d">italic_p</annotation></semantics></math> and <math alttext="S_{min}" class="ltx_Math" display="inline" id="Thmtheorem3.p1.5.5.4.m4.1"><semantics id="Thmtheorem3.p1.5.5.4.m4.1a"><msub id="Thmtheorem3.p1.5.5.4.m4.1.1" xref="Thmtheorem3.p1.5.5.4.m4.1.1.cmml"><mi id="Thmtheorem3.p1.5.5.4.m4.1.1.2" mathvariant="normal" xref="Thmtheorem3.p1.5.5.4.m4.1.1.2.cmml">S</mi><mrow id="Thmtheorem3.p1.5.5.4.m4.1.1.3" xref="Thmtheorem3.p1.5.5.4.m4.1.1.3.cmml"><mi id="Thmtheorem3.p1.5.5.4.m4.1.1.3.2" mathvariant="normal" xref="Thmtheorem3.p1.5.5.4.m4.1.1.3.2.cmml">m</mi><mo id="Thmtheorem3.p1.5.5.4.m4.1.1.3.1" xref="Thmtheorem3.p1.5.5.4.m4.1.1.3.1.cmml">⁢</mo><mi id="Thmtheorem3.p1.5.5.4.m4.1.1.3.3" mathvariant="normal" xref="Thmtheorem3.p1.5.5.4.m4.1.1.3.3.cmml">i</mi><mo id="Thmtheorem3.p1.5.5.4.m4.1.1.3.1a" xref="Thmtheorem3.p1.5.5.4.m4.1.1.3.1.cmml">⁢</mo><mi id="Thmtheorem3.p1.5.5.4.m4.1.1.3.4" mathvariant="normal" xref="Thmtheorem3.p1.5.5.4.m4.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.5.5.4.m4.1b"><apply id="Thmtheorem3.p1.5.5.4.m4.1.1.cmml" xref="Thmtheorem3.p1.5.5.4.m4.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p1.5.5.4.m4.1.1.1.cmml" xref="Thmtheorem3.p1.5.5.4.m4.1.1">subscript</csymbol><ci id="Thmtheorem3.p1.5.5.4.m4.1.1.2.cmml" xref="Thmtheorem3.p1.5.5.4.m4.1.1.2">S</ci><apply id="Thmtheorem3.p1.5.5.4.m4.1.1.3.cmml" xref="Thmtheorem3.p1.5.5.4.m4.1.1.3"><times id="Thmtheorem3.p1.5.5.4.m4.1.1.3.1.cmml" xref="Thmtheorem3.p1.5.5.4.m4.1.1.3.1"></times><ci id="Thmtheorem3.p1.5.5.4.m4.1.1.3.2.cmml" xref="Thmtheorem3.p1.5.5.4.m4.1.1.3.2">m</ci><ci id="Thmtheorem3.p1.5.5.4.m4.1.1.3.3.cmml" xref="Thmtheorem3.p1.5.5.4.m4.1.1.3.3">i</ci><ci id="Thmtheorem3.p1.5.5.4.m4.1.1.3.4.cmml" xref="Thmtheorem3.p1.5.5.4.m4.1.1.3.4">n</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.5.5.4.m4.1c">S_{min}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.5.5.4.m4.1d">italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> as defined in Theorem <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#Thmtheorem2" title="Theorem 2. ‣ Top 𝐾 per embedding. ‣ 3.2 Approximate algorithms ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">2</span></a>. Let <math alttext="X^{\prime}_{K}" class="ltx_Math" display="inline" id="Thmtheorem3.p1.6.6.5.m5.1"><semantics id="Thmtheorem3.p1.6.6.5.m5.1a"><msubsup id="Thmtheorem3.p1.6.6.5.m5.1.1" xref="Thmtheorem3.p1.6.6.5.m5.1.1.cmml"><mi id="Thmtheorem3.p1.6.6.5.m5.1.1.2.2" mathvariant="normal" xref="Thmtheorem3.p1.6.6.5.m5.1.1.2.2.cmml">X</mi><mi id="Thmtheorem3.p1.6.6.5.m5.1.1.3" mathvariant="normal" xref="Thmtheorem3.p1.6.6.5.m5.1.1.3.cmml">K</mi><mo id="Thmtheorem3.p1.6.6.5.m5.1.1.2.3" xref="Thmtheorem3.p1.6.6.5.m5.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.6.6.5.m5.1b"><apply id="Thmtheorem3.p1.6.6.5.m5.1.1.cmml" xref="Thmtheorem3.p1.6.6.5.m5.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p1.6.6.5.m5.1.1.1.cmml" xref="Thmtheorem3.p1.6.6.5.m5.1.1">subscript</csymbol><apply id="Thmtheorem3.p1.6.6.5.m5.1.1.2.cmml" xref="Thmtheorem3.p1.6.6.5.m5.1.1"><csymbol cd="ambiguous" id="Thmtheorem3.p1.6.6.5.m5.1.1.2.1.cmml" xref="Thmtheorem3.p1.6.6.5.m5.1.1">superscript</csymbol><ci id="Thmtheorem3.p1.6.6.5.m5.1.1.2.2.cmml" xref="Thmtheorem3.p1.6.6.5.m5.1.1.2.2">X</ci><ci id="Thmtheorem3.p1.6.6.5.m5.1.1.2.3.cmml" xref="Thmtheorem3.p1.6.6.5.m5.1.1.2.3">′</ci></apply><ci id="Thmtheorem3.p1.6.6.5.m5.1.1.3.cmml" xref="Thmtheorem3.p1.6.6.5.m5.1.1.3">K</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.6.6.5.m5.1c">X^{\prime}_{K}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.6.6.5.m5.1d">italic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> be the top <math alttext="K" class="ltx_Math" display="inline" id="Thmtheorem3.p1.7.7.6.m6.1"><semantics id="Thmtheorem3.p1.7.7.6.m6.1a"><mi id="Thmtheorem3.p1.7.7.6.m6.1.1" mathvariant="normal" xref="Thmtheorem3.p1.7.7.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.7.7.6.m6.1b"><ci id="Thmtheorem3.p1.7.7.6.m6.1.1.cmml" xref="Thmtheorem3.p1.7.7.6.m6.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.7.7.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.7.7.6.m6.1d">italic_K</annotation></semantics></math> items from top <math alttext="K" class="ltx_Math" display="inline" id="Thmtheorem3.p1.8.8.7.m7.1"><semantics id="Thmtheorem3.p1.8.8.7.m7.1a"><mi id="Thmtheorem3.p1.8.8.7.m7.1.1" mathvariant="normal" xref="Thmtheorem3.p1.8.8.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.8.8.7.m7.1b"><ci id="Thmtheorem3.p1.8.8.7.m7.1.1.cmml" xref="Thmtheorem3.p1.8.8.7.m7.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.8.8.7.m7.1c">K</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.8.8.7.m7.1d">italic_K</annotation></semantics></math> average. Let <math alttext="S^{\prime}=\max\{\phi(q,x),x\in X\setminus(\cup_{p}X_{K,p}\cup X^{\prime}_{K})\}" class="ltx_Math" display="inline" id="Thmtheorem3.p1.9.9.8.m8.7"><semantics id="Thmtheorem3.p1.9.9.8.m8.7a"><mrow id="Thmtheorem3.p1.9.9.8.m8.7.7" xref="Thmtheorem3.p1.9.9.8.m8.7.7.cmml"><msup id="Thmtheorem3.p1.9.9.8.m8.7.7.4" xref="Thmtheorem3.p1.9.9.8.m8.7.7.4.cmml"><mi id="Thmtheorem3.p1.9.9.8.m8.7.7.4.2" mathvariant="normal" xref="Thmtheorem3.p1.9.9.8.m8.7.7.4.2.cmml">S</mi><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.4.3" xref="Thmtheorem3.p1.9.9.8.m8.7.7.4.3.cmml">′</mo></msup><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.3" xref="Thmtheorem3.p1.9.9.8.m8.7.7.3.cmml">=</mo><mrow id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.3.cmml"><mi id="Thmtheorem3.p1.9.9.8.m8.5.5" xref="Thmtheorem3.p1.9.9.8.m8.5.5.cmml">max</mi><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2a" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.3.cmml">⁡</mo><mrow id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.3.cmml"><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.3" stretchy="false" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.3.cmml">{</mo><mrow id="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1" xref="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.cmml"><mi id="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.2" mathvariant="normal" xref="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.2.cmml">ϕ</mi><mo id="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.1" xref="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.1.cmml">⁢</mo><mrow id="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.3.2" xref="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.3.1.cmml"><mo id="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.3.2.1" stretchy="false" xref="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.3.1.cmml">(</mo><mi id="Thmtheorem3.p1.9.9.8.m8.3.3" mathvariant="normal" xref="Thmtheorem3.p1.9.9.8.m8.3.3.cmml">q</mi><mo id="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.3.2.2" xref="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.3.1.cmml">,</mo><mi id="Thmtheorem3.p1.9.9.8.m8.4.4" mathvariant="normal" xref="Thmtheorem3.p1.9.9.8.m8.4.4.cmml">x</mi><mo id="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.3.2.3" stretchy="false" xref="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.4" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.3.cmml">,</mo><mrow id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.cmml"><mi id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.3" mathvariant="normal" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.3.cmml">x</mi><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.2" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.2.cmml">∈</mo><mrow id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.cmml"><mi id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.3" mathvariant="normal" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.3.cmml">X</mi><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.2" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.2.cmml">∖</mo><mrow id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.cmml"><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.2" stretchy="false" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.cmml"><mrow id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.cmml"><msub id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1.cmml"><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1.2" lspace="0em" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1.2.cmml">∪</mo><mi id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1.3" mathvariant="normal" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1.3.cmml">p</mi></msub><msub id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.2" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.2.cmml"><mi id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.2.2" mathvariant="normal" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.2.2.cmml">X</mi><mrow id="Thmtheorem3.p1.9.9.8.m8.2.2.2.4" xref="Thmtheorem3.p1.9.9.8.m8.2.2.2.3.cmml"><mi id="Thmtheorem3.p1.9.9.8.m8.1.1.1.1" mathvariant="normal" xref="Thmtheorem3.p1.9.9.8.m8.1.1.1.1.cmml">K</mi><mo id="Thmtheorem3.p1.9.9.8.m8.2.2.2.4.1" xref="Thmtheorem3.p1.9.9.8.m8.2.2.2.3.cmml">,</mo><mi id="Thmtheorem3.p1.9.9.8.m8.2.2.2.2" mathvariant="normal" xref="Thmtheorem3.p1.9.9.8.m8.2.2.2.2.cmml">p</mi></mrow></msub></mrow><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.1" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.1.cmml">∪</mo><msubsup id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.cmml"><mi id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.2.2" mathvariant="normal" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.2.2.cmml">X</mi><mi id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.3" mathvariant="normal" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.3.cmml">K</mi><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.2.3" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.2.3.cmml">′</mo></msubsup></mrow><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.3" stretchy="false" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.5" stretchy="false" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.3.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.9.9.8.m8.7b"><apply id="Thmtheorem3.p1.9.9.8.m8.7.7.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7"><eq id="Thmtheorem3.p1.9.9.8.m8.7.7.3.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.3"></eq><apply id="Thmtheorem3.p1.9.9.8.m8.7.7.4.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.4"><csymbol cd="ambiguous" id="Thmtheorem3.p1.9.9.8.m8.7.7.4.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.4">superscript</csymbol><ci id="Thmtheorem3.p1.9.9.8.m8.7.7.4.2.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.4.2">S</ci><ci id="Thmtheorem3.p1.9.9.8.m8.7.7.4.3.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.4.3">′</ci></apply><apply id="Thmtheorem3.p1.9.9.8.m8.7.7.2.3.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2"><max id="Thmtheorem3.p1.9.9.8.m8.5.5.cmml" xref="Thmtheorem3.p1.9.9.8.m8.5.5"></max><apply id="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1"><times id="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.1"></times><ci id="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.2.cmml" xref="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.2">ϕ</ci><interval closure="open" id="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.3.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.6.6.1.1.1.1.3.2"><ci id="Thmtheorem3.p1.9.9.8.m8.3.3.cmml" xref="Thmtheorem3.p1.9.9.8.m8.3.3">q</ci><ci id="Thmtheorem3.p1.9.9.8.m8.4.4.cmml" xref="Thmtheorem3.p1.9.9.8.m8.4.4">x</ci></interval></apply><apply id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2"><in id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.2.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.2"></in><ci id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.3.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.3">x</ci><apply id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1"><setdiff id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.2.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.2"></setdiff><ci id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.3.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.3">X</ci><apply id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1"><union id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.1"></union><apply id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2"><apply id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1"><csymbol cd="ambiguous" id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1">subscript</csymbol><union id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1.2.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1.2"></union><ci id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1.3.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.1.3">p</ci></apply><apply id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.2.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.2.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.2.2.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.2.2.2">X</ci><list id="Thmtheorem3.p1.9.9.8.m8.2.2.2.3.cmml" xref="Thmtheorem3.p1.9.9.8.m8.2.2.2.4"><ci id="Thmtheorem3.p1.9.9.8.m8.1.1.1.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.1.1.1.1">K</ci><ci id="Thmtheorem3.p1.9.9.8.m8.2.2.2.2.cmml" xref="Thmtheorem3.p1.9.9.8.m8.2.2.2.2">p</ci></list></apply></apply><apply id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3">subscript</csymbol><apply id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.2.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.2.1.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3">superscript</csymbol><ci id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.2.2.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.2.2">X</ci><ci id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.2.3.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.2.3">′</ci></apply><ci id="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.3.cmml" xref="Thmtheorem3.p1.9.9.8.m8.7.7.2.2.2.2.1.1.1.1.3.3">K</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.9.9.8.m8.7c">S^{\prime}=\max\{\phi(q,x),x\in X\setminus(\cup_{p}X_{K,p}\cup X^{\prime}_{K})\}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.9.9.8.m8.7d">italic_S start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = roman_max { italic_ϕ ( italic_q , italic_x ) , italic_x ∈ italic_X ∖ ( ∪ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_K , italic_p end_POSTSUBSCRIPT ∪ italic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ) }</annotation></semantics></math>. Then the gap of <math alttext="S_{\Delta}\leq S^{\prime}-S_{min}" class="ltx_Math" display="inline" id="Thmtheorem3.p1.10.10.9.m9.1"><semantics id="Thmtheorem3.p1.10.10.9.m9.1a"><mrow id="Thmtheorem3.p1.10.10.9.m9.1.1" xref="Thmtheorem3.p1.10.10.9.m9.1.1.cmml"><msub id="Thmtheorem3.p1.10.10.9.m9.1.1.2" xref="Thmtheorem3.p1.10.10.9.m9.1.1.2.cmml"><mi id="Thmtheorem3.p1.10.10.9.m9.1.1.2.2" mathvariant="normal" xref="Thmtheorem3.p1.10.10.9.m9.1.1.2.2.cmml">S</mi><mi id="Thmtheorem3.p1.10.10.9.m9.1.1.2.3" mathvariant="normal" xref="Thmtheorem3.p1.10.10.9.m9.1.1.2.3.cmml">Δ</mi></msub><mo id="Thmtheorem3.p1.10.10.9.m9.1.1.1" xref="Thmtheorem3.p1.10.10.9.m9.1.1.1.cmml">≤</mo><mrow id="Thmtheorem3.p1.10.10.9.m9.1.1.3" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.cmml"><msup id="Thmtheorem3.p1.10.10.9.m9.1.1.3.2" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.2.cmml"><mi id="Thmtheorem3.p1.10.10.9.m9.1.1.3.2.2" mathvariant="normal" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.2.2.cmml">S</mi><mo id="Thmtheorem3.p1.10.10.9.m9.1.1.3.2.3" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.2.3.cmml">′</mo></msup><mo id="Thmtheorem3.p1.10.10.9.m9.1.1.3.1" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.1.cmml">−</mo><msub id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.cmml"><mi id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.2" mathvariant="normal" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.2.cmml">S</mi><mrow id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.cmml"><mi id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.2" mathvariant="normal" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.2.cmml">m</mi><mo id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.1" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.1.cmml">⁢</mo><mi id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.3" mathvariant="normal" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.3.cmml">i</mi><mo id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.1a" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.1.cmml">⁢</mo><mi id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.4" mathvariant="normal" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.4.cmml">n</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem3.p1.10.10.9.m9.1b"><apply id="Thmtheorem3.p1.10.10.9.m9.1.1.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1"><leq id="Thmtheorem3.p1.10.10.9.m9.1.1.1.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.1"></leq><apply id="Thmtheorem3.p1.10.10.9.m9.1.1.2.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.2"><csymbol cd="ambiguous" id="Thmtheorem3.p1.10.10.9.m9.1.1.2.1.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.2">subscript</csymbol><ci id="Thmtheorem3.p1.10.10.9.m9.1.1.2.2.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.2.2">S</ci><ci id="Thmtheorem3.p1.10.10.9.m9.1.1.2.3.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.2.3">Δ</ci></apply><apply id="Thmtheorem3.p1.10.10.9.m9.1.1.3.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3"><minus id="Thmtheorem3.p1.10.10.9.m9.1.1.3.1.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.1"></minus><apply id="Thmtheorem3.p1.10.10.9.m9.1.1.3.2.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="Thmtheorem3.p1.10.10.9.m9.1.1.3.2.1.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.2">superscript</csymbol><ci id="Thmtheorem3.p1.10.10.9.m9.1.1.3.2.2.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.2.2">S</ci><ci id="Thmtheorem3.p1.10.10.9.m9.1.1.3.2.3.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.2.3">′</ci></apply><apply id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3"><csymbol cd="ambiguous" id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.1.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3">subscript</csymbol><ci id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.2.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.2">S</ci><apply id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3"><times id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.1.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.1"></times><ci id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.2.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.2">m</ci><ci id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.3.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.3">i</ci><ci id="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.4.cmml" xref="Thmtheorem3.p1.10.10.9.m9.1.1.3.3.3.4">n</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem3.p1.10.10.9.m9.1c">S_{\Delta}\leq S^{\prime}-S_{min}</annotation><annotation encoding="application/x-llamapun" id="Thmtheorem3.p1.10.10.9.m9.1d">italic_S start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ≤ italic_S start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT - italic_S start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math>.</span></span></p>
</div>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px3.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px3.p2.6"><span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px3.p2.6.1">Remark</span> Similar to Theorem <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#Thmtheorem2" title="Theorem 2. ‣ Top 𝐾 per embedding. ‣ 3.2 Approximate algorithms ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">2</span></a>, the upper bound of the gap is tight. In practice, we can configure the <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px3.p2.1.m1.1a"><mi id="S3.SS2.SSS0.Px3.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px3.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p2.1.m1.1b"><ci id="S3.SS2.SSS0.Px3.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p2.1.m1.1d">italic_K</annotation></semantics></math> to be different for the two heuristics, i.e., <math alttext="K_{1}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px3.p2.2.m2.1a"><msub id="S3.SS2.SSS0.Px3.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.cmml">K</mi><mn id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.3" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p2.2.m2.1b"><apply id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2">𝐾</ci><cn id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p2.2.m2.1c">K_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p2.2.m2.1d">italic_K start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="K_{2}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p2.3.m3.1"><semantics id="S3.SS2.SSS0.Px3.p2.3.m3.1a"><msub id="S3.SS2.SSS0.Px3.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px3.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px3.p2.3.m3.1.1.2" xref="S3.SS2.SSS0.Px3.p2.3.m3.1.1.2.cmml">K</mi><mn id="S3.SS2.SSS0.Px3.p2.3.m3.1.1.3" xref="S3.SS2.SSS0.Px3.p2.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p2.3.m3.1b"><apply id="S3.SS2.SSS0.Px3.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px3.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px3.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px3.p2.3.m3.1.1.2">𝐾</ci><cn id="S3.SS2.SSS0.Px3.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px3.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p2.3.m3.1c">K_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p2.3.m3.1d">italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. For example, when the weight distribution <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p2.4.m4.1"><semantics id="S3.SS2.SSS0.Px3.p2.4.m4.1a"><mi id="S3.SS2.SSS0.Px3.p2.4.m4.1.1" xref="S3.SS2.SSS0.Px3.p2.4.m4.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p2.4.m4.1b"><ci id="S3.SS2.SSS0.Px3.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.4.m4.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p2.4.m4.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p2.4.m4.1d">italic_π</annotation></semantics></math> is more balanced, <math alttext="K_{2}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p2.5.m5.1"><semantics id="S3.SS2.SSS0.Px3.p2.5.m5.1a"><msub id="S3.SS2.SSS0.Px3.p2.5.m5.1.1" xref="S3.SS2.SSS0.Px3.p2.5.m5.1.1.cmml"><mi id="S3.SS2.SSS0.Px3.p2.5.m5.1.1.2" xref="S3.SS2.SSS0.Px3.p2.5.m5.1.1.2.cmml">K</mi><mn id="S3.SS2.SSS0.Px3.p2.5.m5.1.1.3" xref="S3.SS2.SSS0.Px3.p2.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p2.5.m5.1b"><apply id="S3.SS2.SSS0.Px3.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px3.p2.5.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px3.p2.5.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px3.p2.5.m5.1.1.2">𝐾</ci><cn id="S3.SS2.SSS0.Px3.p2.5.m5.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px3.p2.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p2.5.m5.1c">K_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p2.5.m5.1d">italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> can be configured to be larger as the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p2.6.m6.1"><semantics id="S3.SS2.SSS0.Px3.p2.6.m6.1a"><mi id="S3.SS2.SSS0.Px3.p2.6.m6.1.1" xref="S3.SS2.SSS0.Px3.p2.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p2.6.m6.1b"><ci id="S3.SS2.SSS0.Px3.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p2.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p2.6.m6.1d">italic_K</annotation></semantics></math> average approach approximates <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px3.p2.6.2">MoL</span> well while being more computationally efficient.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Evaluation</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we evaluate the performance of the <span class="ltx_text ltx_font_italic" id="S4.p1.1.1">MoL</span> based learned similarity and the efficiency of our retrieval algorithms discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S3" title="3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Setup</h3>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Workloads.</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.2">We consider a classical retrieval task (next-item prediction) in recommendation systems <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite>.
We employ three widely used datasets, the 1M and 20M subsets of MovieLens <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib13" title="">13</a>]</cite>, and the largest Books subset of Amazon Reviews <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib29" title="">29</a>]</cite>. We utilize sequential user encoders, as they have been shown to achieve state-of-the-art results on these datasets <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite>. In the next-item prediction setting in sequential recommendations, the query <math alttext="q" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.1.m1.1d">italic_q</annotation></semantics></math> corresponds to the user representation at a particular time step, which is then mapped to <math alttext="P_{q}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.1a"><msub id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">P</mi><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2">𝑃</ci><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.1c">P_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> embeddings using an multi-layer perceptron (MLP) when using the MoL learned similarity, consistent with prior work. We discuss detailed hyperparameter settings in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#A1" title="Appendix A Experiment Setups ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">A</span></a>. Table <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.T2" title="Table 2 ‣ Workloads. ‣ 4.1 Setup ‣ 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">2</span></a> shows the statistics of these three workloads.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T2.5.5.6"><span class="ltx_text" id="S4.T2.5.5.6.1" style="font-size:90%;">Workload</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T2.1.1.1"><span class="ltx_text" id="S4.T2.1.1.1.1" style="font-size:90%;"><math alttext="|Q|" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.1.m1.1.2.2" xref="S4.T2.1.1.1.1.m1.1.2.1.cmml"><mo id="S4.T2.1.1.1.1.m1.1.2.2.1" stretchy="false" xref="S4.T2.1.1.1.1.m1.1.2.1.1.cmml">|</mo><mi id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">Q</mi><mo id="S4.T2.1.1.1.1.m1.1.2.2.2" stretchy="false" xref="S4.T2.1.1.1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.2.1.cmml" xref="S4.T2.1.1.1.1.m1.1.2.2"><abs id="S4.T2.1.1.1.1.m1.1.2.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.2.2.1"></abs><ci id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">|Q|</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.1.m1.1d">| italic_Q |</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T2.2.2.2"><span class="ltx_text" id="S4.T2.2.2.2.1" style="font-size:90%;"><math alttext="|X|" class="ltx_Math" display="inline" id="S4.T2.2.2.2.1.m1.1"><semantics id="S4.T2.2.2.2.1.m1.1a"><mrow id="S4.T2.2.2.2.1.m1.1.2.2" xref="S4.T2.2.2.2.1.m1.1.2.1.cmml"><mo id="S4.T2.2.2.2.1.m1.1.2.2.1" stretchy="false" xref="S4.T2.2.2.2.1.m1.1.2.1.1.cmml">|</mo><mi id="S4.T2.2.2.2.1.m1.1.1" xref="S4.T2.2.2.2.1.m1.1.1.cmml">X</mi><mo id="S4.T2.2.2.2.1.m1.1.2.2.2" stretchy="false" xref="S4.T2.2.2.2.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.1.m1.1b"><apply id="S4.T2.2.2.2.1.m1.1.2.1.cmml" xref="S4.T2.2.2.2.1.m1.1.2.2"><abs id="S4.T2.2.2.2.1.m1.1.2.1.1.cmml" xref="S4.T2.2.2.2.1.m1.1.2.2.1"></abs><ci id="S4.T2.2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.1.m1.1c">|X|</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.1.m1.1d">| italic_X |</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T2.3.3.3"><span class="ltx_text" id="S4.T2.3.3.3.1" style="font-size:90%;"><math alttext="|P_{q}|" class="ltx_Math" display="inline" id="S4.T2.3.3.3.1.m1.1"><semantics id="S4.T2.3.3.3.1.m1.1a"><mrow id="S4.T2.3.3.3.1.m1.1.1.1" xref="S4.T2.3.3.3.1.m1.1.1.2.cmml"><mo id="S4.T2.3.3.3.1.m1.1.1.1.2" stretchy="false" xref="S4.T2.3.3.3.1.m1.1.1.2.1.cmml">|</mo><msub id="S4.T2.3.3.3.1.m1.1.1.1.1" xref="S4.T2.3.3.3.1.m1.1.1.1.1.cmml"><mi id="S4.T2.3.3.3.1.m1.1.1.1.1.2" xref="S4.T2.3.3.3.1.m1.1.1.1.1.2.cmml">P</mi><mi id="S4.T2.3.3.3.1.m1.1.1.1.1.3" xref="S4.T2.3.3.3.1.m1.1.1.1.1.3.cmml">q</mi></msub><mo id="S4.T2.3.3.3.1.m1.1.1.1.3" stretchy="false" xref="S4.T2.3.3.3.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.1.m1.1b"><apply id="S4.T2.3.3.3.1.m1.1.1.2.cmml" xref="S4.T2.3.3.3.1.m1.1.1.1"><abs id="S4.T2.3.3.3.1.m1.1.1.2.1.cmml" xref="S4.T2.3.3.3.1.m1.1.1.1.2"></abs><apply id="S4.T2.3.3.3.1.m1.1.1.1.1.cmml" xref="S4.T2.3.3.3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.T2.3.3.3.1.m1.1.1.1.1.1.cmml" xref="S4.T2.3.3.3.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.T2.3.3.3.1.m1.1.1.1.1.2.cmml" xref="S4.T2.3.3.3.1.m1.1.1.1.1.2">𝑃</ci><ci id="S4.T2.3.3.3.1.m1.1.1.1.1.3.cmml" xref="S4.T2.3.3.3.1.m1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.1.m1.1c">|P_{q}|</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.3.1.m1.1d">| italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT |</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T2.4.4.4"><span class="ltx_text" id="S4.T2.4.4.4.1" style="font-size:90%;"><math alttext="|P_{x}|" class="ltx_Math" display="inline" id="S4.T2.4.4.4.1.m1.1"><semantics id="S4.T2.4.4.4.1.m1.1a"><mrow id="S4.T2.4.4.4.1.m1.1.1.1" xref="S4.T2.4.4.4.1.m1.1.1.2.cmml"><mo id="S4.T2.4.4.4.1.m1.1.1.1.2" stretchy="false" xref="S4.T2.4.4.4.1.m1.1.1.2.1.cmml">|</mo><msub id="S4.T2.4.4.4.1.m1.1.1.1.1" xref="S4.T2.4.4.4.1.m1.1.1.1.1.cmml"><mi id="S4.T2.4.4.4.1.m1.1.1.1.1.2" xref="S4.T2.4.4.4.1.m1.1.1.1.1.2.cmml">P</mi><mi id="S4.T2.4.4.4.1.m1.1.1.1.1.3" xref="S4.T2.4.4.4.1.m1.1.1.1.1.3.cmml">x</mi></msub><mo id="S4.T2.4.4.4.1.m1.1.1.1.3" stretchy="false" xref="S4.T2.4.4.4.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.1.m1.1b"><apply id="S4.T2.4.4.4.1.m1.1.1.2.cmml" xref="S4.T2.4.4.4.1.m1.1.1.1"><abs id="S4.T2.4.4.4.1.m1.1.1.2.1.cmml" xref="S4.T2.4.4.4.1.m1.1.1.1.2"></abs><apply id="S4.T2.4.4.4.1.m1.1.1.1.1.cmml" xref="S4.T2.4.4.4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.T2.4.4.4.1.m1.1.1.1.1.1.cmml" xref="S4.T2.4.4.4.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.T2.4.4.4.1.m1.1.1.1.1.2.cmml" xref="S4.T2.4.4.4.1.m1.1.1.1.1.2">𝑃</ci><ci id="S4.T2.4.4.4.1.m1.1.1.1.1.3.cmml" xref="S4.T2.4.4.4.1.m1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.1.m1.1c">|P_{x}|</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.4.1.m1.1d">| italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT |</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T2.5.5.5"><math alttext="d_{P}" class="ltx_Math" display="inline" id="S4.T2.5.5.5.m1.1"><semantics id="S4.T2.5.5.5.m1.1a"><msub id="S4.T2.5.5.5.m1.1.1" xref="S4.T2.5.5.5.m1.1.1.cmml"><mi id="S4.T2.5.5.5.m1.1.1.2" mathsize="90%" xref="S4.T2.5.5.5.m1.1.1.2.cmml">d</mi><mi id="S4.T2.5.5.5.m1.1.1.3" mathsize="90%" xref="S4.T2.5.5.5.m1.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.m1.1b"><apply id="S4.T2.5.5.5.m1.1.1.cmml" xref="S4.T2.5.5.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.5.5.5.m1.1.1.1.cmml" xref="S4.T2.5.5.5.m1.1.1">subscript</csymbol><ci id="S4.T2.5.5.5.m1.1.1.2.cmml" xref="S4.T2.5.5.5.m1.1.1.2">𝑑</ci><ci id="S4.T2.5.5.5.m1.1.1.3.cmml" xref="S4.T2.5.5.5.m1.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.m1.1c">d_{P}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.5.m1.1d">italic_d start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.5.6.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.5.6.1.1"><span class="ltx_text ltx_font_italic" id="S4.T2.5.6.1.1.1" style="font-size:90%;">ML-1M</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.5.6.1.2"><span class="ltx_text" id="S4.T2.5.6.1.2.1" style="font-size:90%;">6,040</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.5.6.1.3"><span class="ltx_text" id="S4.T2.5.6.1.3.1" style="font-size:90%;">3,649</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.5.6.1.4"><span class="ltx_text" id="S4.T2.5.6.1.4.1" style="font-size:90%;">8</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.5.6.1.5"><span class="ltx_text" id="S4.T2.5.6.1.5.1" style="font-size:90%;">4</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.5.6.1.6"><span class="ltx_text" id="S4.T2.5.6.1.6.1" style="font-size:90%;">64</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.7.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.5.7.2.1"><span class="ltx_text ltx_font_italic" id="S4.T2.5.7.2.1.1" style="font-size:90%;">ML-20M</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.5.7.2.2"><span class="ltx_text" id="S4.T2.5.7.2.2.1" style="font-size:90%;">138,493</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.5.7.2.3"><span class="ltx_text" id="S4.T2.5.7.2.3.1" style="font-size:90%;">24,186</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.5.7.2.4"><span class="ltx_text" id="S4.T2.5.7.2.4.1" style="font-size:90%;">8</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.5.7.2.5"><span class="ltx_text" id="S4.T2.5.7.2.5.1" style="font-size:90%;">4</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.5.7.2.6"><span class="ltx_text" id="S4.T2.5.7.2.6.1" style="font-size:90%;">128</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.8.3">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T2.5.8.3.1"><span class="ltx_text ltx_font_italic" id="S4.T2.5.8.3.1.1" style="font-size:90%;">Books</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T2.5.8.3.2"><span class="ltx_text" id="S4.T2.5.8.3.2.1" style="font-size:90%;">694,897</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T2.5.8.3.3"><span class="ltx_text" id="S4.T2.5.8.3.3.1" style="font-size:90%;">674,044</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T2.5.8.3.4"><span class="ltx_text" id="S4.T2.5.8.3.4.1" style="font-size:90%;">8</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T2.5.8.3.5"><span class="ltx_text" id="S4.T2.5.8.3.5.1" style="font-size:90%;">8</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.5.8.3.6"><span class="ltx_text" id="S4.T2.5.8.3.6.1" style="font-size:90%;">32</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>Workload statistics.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Model.</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.1">We implemented MoL on top of two popular sequential architectures, SASRec <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib20" title="">20</a>]</cite> and HSTU <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib43" title="">43</a>]</cite>, with cosine similarity as the default similarity function (SASRec / HSTU rows in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.T3" title="Table 3 ‣ Model. ‣ 4.1 Setup ‣ 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">3</span></a>). The models are are implemented in PyTorch and trained with 2x NVIDIA RTX 6000 Ada GPUs.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.2.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S4.T3.2.1.1.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T3.2.1.1.2.1" style="font-size:90%;">Method</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T3.2.1.1.3.1" style="font-size:90%;">HR@1</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T3.2.1.1.4.1" style="font-size:90%;">HR@10</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T3.2.1.1.5.1" style="font-size:90%;">HR@50</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.1.1.6"><span class="ltx_text ltx_font_bold" id="S4.T3.2.1.1.6.1" style="font-size:90%;">HR@200</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.1.1.7"><span class="ltx_text ltx_font_bold" id="S4.T3.2.1.1.7.1" style="font-size:90%;">MRR</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.2.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T3.2.2.1.1" rowspan="4"><span class="ltx_text ltx_font_italic" id="S4.T3.2.2.1.1.1" style="font-size:90%;">ML-1M</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.2.1.2"><span class="ltx_text" id="S4.T3.2.2.1.2.1" style="font-size:90%;">SASRec</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.2.1.3"><span class="ltx_text" id="S4.T3.2.2.1.3.1" style="font-size:90%;">.0610</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.2.1.4"><span class="ltx_text" id="S4.T3.2.2.1.4.1" style="font-size:90%;">.2818</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.2.1.5"><span class="ltx_text" id="S4.T3.2.2.1.5.1" style="font-size:90%;">.5470</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.2.1.6"><span class="ltx_text" id="S4.T3.2.2.1.6.1" style="font-size:90%;">.7540</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.2.1.7"><span class="ltx_text" id="S4.T3.2.2.1.7.1" style="font-size:90%;">.1352</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.3.2">
<td class="ltx_td ltx_align_left" id="S4.T3.2.3.2.1"><span class="ltx_text" id="S4.T3.2.3.2.1.1" style="font-size:90%;">SASRec + MoL</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.3.2.2"><span class="ltx_text" id="S4.T3.2.3.2.2.1" style="font-size:90%;">.0710</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.3.2.3"><span class="ltx_text" id="S4.T3.2.3.2.3.1" style="font-size:90%;">.3034</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.3.2.4"><span class="ltx_text" id="S4.T3.2.3.2.4.1" style="font-size:90%;">.5655</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.3.2.5"><span class="ltx_text" id="S4.T3.2.3.2.5.1" style="font-size:90%;">.7680</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.3.2.6"><span class="ltx_text" id="S4.T3.2.3.2.6.1" style="font-size:90%;">.1448</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.4.3">
<td class="ltx_td ltx_align_left" id="S4.T3.2.4.3.1"><span class="ltx_text" id="S4.T3.2.4.3.1.1" style="font-size:90%;">HSTU</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.4.3.2"><span class="ltx_text" id="S4.T3.2.4.3.2.1" style="font-size:90%;">.0750</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.4.3.3"><span class="ltx_text" id="S4.T3.2.4.3.3.1" style="font-size:90%;">.3332</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.4.3.4"><span class="ltx_text" id="S4.T3.2.4.3.4.1" style="font-size:90%;">.5956</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.4.3.5"><span class="ltx_text" id="S4.T3.2.4.3.5.1" style="font-size:90%;">.7824</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.4.3.6"><span class="ltx_text" id="S4.T3.2.4.3.6.1" style="font-size:90%;">.1579</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.5.4">
<td class="ltx_td ltx_align_left" id="S4.T3.2.5.4.1"><span class="ltx_text" id="S4.T3.2.5.4.1.1" style="font-size:90%;">HSTU + MoL</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.5.4.2"><span class="ltx_text ltx_font_bold" id="S4.T3.2.5.4.2.1" style="font-size:90%;">.0837</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.5.4.3"><span class="ltx_text ltx_font_bold" id="S4.T3.2.5.4.3.1" style="font-size:90%;">.3460</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.5.4.4"><span class="ltx_text ltx_font_bold" id="S4.T3.2.5.4.4.1" style="font-size:90%;">.6048</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.5.4.5"><span class="ltx_text ltx_font_bold" id="S4.T3.2.5.4.5.1" style="font-size:90%;">.7874</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.5.4.6"><span class="ltx_text ltx_font_bold" id="S4.T3.2.5.4.6.1" style="font-size:90%;">.1673</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T3.2.6.5.1" rowspan="4"><span class="ltx_text ltx_font_italic" id="S4.T3.2.6.5.1.1" style="font-size:90%;">ML-20M</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.6.5.2"><span class="ltx_text" id="S4.T3.2.6.5.2.1" style="font-size:90%;">SASRec</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.6.5.3"><span class="ltx_text" id="S4.T3.2.6.5.3.1" style="font-size:90%;">.0653</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.6.5.4"><span class="ltx_text" id="S4.T3.2.6.5.4.1" style="font-size:90%;">.2883</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.6.5.5"><span class="ltx_text" id="S4.T3.2.6.5.5.1" style="font-size:90%;">.5484</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.6.5.6"><span class="ltx_text" id="S4.T3.2.6.5.6.1" style="font-size:90%;">.7658</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.6.5.7"><span class="ltx_text" id="S4.T3.2.6.5.7.1" style="font-size:90%;">.1375</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.7.6">
<td class="ltx_td ltx_align_left" id="S4.T3.2.7.6.1"><span class="ltx_text" id="S4.T3.2.7.6.1.1" style="font-size:90%;">SASRec + MoL</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.7.6.2"><span class="ltx_text" id="S4.T3.2.7.6.2.1" style="font-size:90%;">.0790</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.7.6.3"><span class="ltx_text" id="S4.T3.2.7.6.3.1" style="font-size:90%;">.3124</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.7.6.4"><span class="ltx_text" id="S4.T3.2.7.6.4.1" style="font-size:90%;">.5685</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.7.6.5"><span class="ltx_text" id="S4.T3.2.7.6.5.1" style="font-size:90%;">.7784</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.7.6.6"><span class="ltx_text" id="S4.T3.2.7.6.6.1" style="font-size:90%;">.1551</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.8.7">
<td class="ltx_td ltx_align_left" id="S4.T3.2.8.7.1"><span class="ltx_text" id="S4.T3.2.8.7.1.1" style="font-size:90%;">HSTU</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.8.7.2"><span class="ltx_text" id="S4.T3.2.8.7.2.1" style="font-size:90%;">.0962</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.8.7.3"><span class="ltx_text" id="S4.T3.2.8.7.3.1" style="font-size:90%;">.3557</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.8.7.4"><span class="ltx_text" id="S4.T3.2.8.7.4.1" style="font-size:90%;">.6146</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.8.7.5"><span class="ltx_text" id="S4.T3.2.8.7.5.1" style="font-size:90%;">.8080</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.8.7.6"><span class="ltx_text" id="S4.T3.2.8.7.6.1" style="font-size:90%;">.1800</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.9.8">
<td class="ltx_td ltx_align_left" id="S4.T3.2.9.8.1"><span class="ltx_text" id="S4.T3.2.9.8.1.1" style="font-size:90%;">HSTU + MoL</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.9.8.2"><span class="ltx_text ltx_font_bold" id="S4.T3.2.9.8.2.1" style="font-size:90%;">.1008</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.9.8.3"><span class="ltx_text ltx_font_bold" id="S4.T3.2.9.8.3.1" style="font-size:90%;">.3697</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.9.8.4"><span class="ltx_text ltx_font_bold" id="S4.T3.2.9.8.4.1" style="font-size:90%;">.6244</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.9.8.5"><span class="ltx_text ltx_font_bold" id="S4.T3.2.9.8.5.1" style="font-size:90%;">.8124</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.9.8.6"><span class="ltx_text ltx_font_bold" id="S4.T3.2.9.8.6.1" style="font-size:90%;">.1880</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T3.2.10.9.1" rowspan="4"><span class="ltx_text ltx_font_italic" id="S4.T3.2.10.9.1.1" style="font-size:90%;">Books</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.10.9.2"><span class="ltx_text" id="S4.T3.2.10.9.2.1" style="font-size:90%;">SASRec</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.10.9.3"><span class="ltx_text" id="S4.T3.2.10.9.3.1" style="font-size:90%;">.0058</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.10.9.4"><span class="ltx_text" id="S4.T3.2.10.9.4.1" style="font-size:90%;">.0306</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.10.9.5"><span class="ltx_text" id="S4.T3.2.10.9.5.1" style="font-size:90%;">.0754</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.10.9.6"><span class="ltx_text" id="S4.T3.2.10.9.6.1" style="font-size:90%;">.1431</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.2.10.9.7"><span class="ltx_text" id="S4.T3.2.10.9.7.1" style="font-size:90%;">.0153</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.11.10">
<td class="ltx_td ltx_align_left" id="S4.T3.2.11.10.1"><span class="ltx_text" id="S4.T3.2.11.10.1.1" style="font-size:90%;">SASRec + MoL</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.11.10.2"><span class="ltx_text" id="S4.T3.2.11.10.2.1" style="font-size:90%;">.0083</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.11.10.3"><span class="ltx_text" id="S4.T3.2.11.10.3.1" style="font-size:90%;">.0402</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.11.10.4"><span class="ltx_text" id="S4.T3.2.11.10.4.1" style="font-size:90%;">.0970</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.11.10.5"><span class="ltx_text" id="S4.T3.2.11.10.5.1" style="font-size:90%;">.1813</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.11.10.6"><span class="ltx_text" id="S4.T3.2.11.10.6.1" style="font-size:90%;">.0203</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.12.11">
<td class="ltx_td ltx_align_left" id="S4.T3.2.12.11.1"><span class="ltx_text" id="S4.T3.2.12.11.1.1" style="font-size:90%;">HSTU</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.12.11.2"><span class="ltx_text" id="S4.T3.2.12.11.2.1" style="font-size:90%;">.0101</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.12.11.3"><span class="ltx_text" id="S4.T3.2.12.11.3.1" style="font-size:90%;">.0469</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.12.11.4"><span class="ltx_text" id="S4.T3.2.12.11.4.1" style="font-size:90%;">.1066</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.12.11.5"><span class="ltx_text" id="S4.T3.2.12.11.5.1" style="font-size:90%;">.1876</span></td>
<td class="ltx_td ltx_align_left" id="S4.T3.2.12.11.6"><span class="ltx_text" id="S4.T3.2.12.11.6.1" style="font-size:90%;">.0233</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.13.12">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.2.13.12.1"><span class="ltx_text" id="S4.T3.2.13.12.1.1" style="font-size:90%;">HSTU + MoL</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.2.13.12.2"><span class="ltx_text ltx_font_bold" id="S4.T3.2.13.12.2.1" style="font-size:90%;">.0150</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.2.13.12.3"><span class="ltx_text ltx_font_bold" id="S4.T3.2.13.12.3.1" style="font-size:90%;">.0613</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.2.13.12.4"><span class="ltx_text ltx_font_bold" id="S4.T3.2.13.12.4.1" style="font-size:90%;">.1292</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.2.13.12.5"><span class="ltx_text ltx_font_bold" id="S4.T3.2.13.12.5.1" style="font-size:90%;">.2167</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.2.13.12.6"><span class="ltx_text ltx_font_bold" id="S4.T3.2.13.12.6.1" style="font-size:90%;">.0315</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Evaluation of recommendation retrieval performance, utilizing the next-item prediction task.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Metrics.</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.2">We use Recall (Hit Rate) as the main metric. It’s worth noting that HSTU + MoL sets new state-of-the-art results on MovieLens and Amazon Reviews (Table <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.T3" title="Table 3 ‣ Model. ‣ 4.1 Setup ‣ 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">3</span></a>). Mixture-of-Logits (+ MoL rows) also consistently outperform dot products by an average of 24.2% in HR@1, 14.3% in HR@10, and 16.3% in MRR across the six scenarios, validating that learned similarities, in particular MoL, are not only theoretically expressive but also practically learnable. We evaluate our proposed retrieval algorithms relative to the best performing rows, “HSTU + MoL”, which exhaustively evaluates <math alttext="\phi(q,x)" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.1.m1.2"><semantics id="S4.SS1.SSS0.Px3.p1.1.m1.2a"><mrow id="S4.SS1.SSS0.Px3.p1.1.m1.2.3" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.3.cmml"><mi id="S4.SS1.SSS0.Px3.p1.1.m1.2.3.2" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.3.2.cmml">ϕ</mi><mo id="S4.SS1.SSS0.Px3.p1.1.m1.2.3.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px3.p1.1.m1.2.3.3.2" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.3.3.1.cmml"><mo id="S4.SS1.SSS0.Px3.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml">q</mi><mo id="S4.SS1.SSS0.Px3.p1.1.m1.2.3.3.2.2" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS1.SSS0.Px3.p1.1.m1.2.2" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.2.cmml">x</mi><mo id="S4.SS1.SSS0.Px3.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.1.m1.2b"><apply id="S4.SS1.SSS0.Px3.p1.1.m1.2.3.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.3"><times id="S4.SS1.SSS0.Px3.p1.1.m1.2.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.3.1"></times><ci id="S4.SS1.SSS0.Px3.p1.1.m1.2.3.2.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.3.2">italic-ϕ</ci><interval closure="open" id="S4.SS1.SSS0.Px3.p1.1.m1.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.3.3.2"><ci id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1">𝑞</ci><ci id="S4.SS1.SSS0.Px3.p1.1.m1.2.2.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.1.m1.2c">\phi(q,x)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.1.m1.2d">italic_ϕ ( italic_q , italic_x )</annotation></semantics></math> over all <math alttext="x" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px3.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px3.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px3.p1.2.m2.1d">italic_x</annotation></semantics></math>s and corresponds to <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px3.p1.2.1">BruteForce</span> rows in the next section.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Top <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.1.m1.1"><semantics id="S4.SS2.1.m1.1b"><mi id="S4.SS2.1.m1.1.1" xref="S4.SS2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.1.m1.1c"><ci id="S4.SS2.1.m1.1.1.cmml" xref="S4.SS2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.1.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.1.m1.1e">italic_K</annotation></semantics></math> retrieval performance</h3>
<figure class="ltx_table" id="S4.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.33.33">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.33.33.34.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S4.T4.33.33.34.1.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T4.33.33.34.1.2"><span class="ltx_text ltx_font_bold" id="S4.T4.33.33.34.1.2.1" style="font-size:90%;">Method</span></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T4.33.33.34.1.3"><span class="ltx_text ltx_font_bold" id="S4.T4.33.33.34.1.3.1" style="font-size:90%;">HR@1</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T4.33.33.34.1.4"><span class="ltx_text ltx_font_bold" id="S4.T4.33.33.34.1.4.1" style="font-size:90%;">HR@5</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T4.33.33.34.1.5"><span class="ltx_text ltx_font_bold" id="S4.T4.33.33.34.1.5.1" style="font-size:90%;">HR@10</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T4.33.33.34.1.6"><span class="ltx_text ltx_font_bold" id="S4.T4.33.33.34.1.6.1" style="font-size:90%;">HR@50</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T4.33.33.34.1.7"><span class="ltx_text ltx_font_bold" id="S4.T4.33.33.34.1.7.1" style="font-size:90%;">HR@100</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T4.33.33.34.1.8"><span class="ltx_text ltx_font_bold" id="S4.T4.33.33.34.1.8.1" style="font-size:90%;">Latency / ms</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T4.1.1.1.2" rowspan="10"><span class="ltx_text ltx_font_italic" id="S4.T4.1.1.1.2.1" style="font-size:90%;">ML-1M</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T4.1.1.1.3"><span class="ltx_text ltx_font_italic" id="S4.T4.1.1.1.3.1" style="font-size:90%;">BruteForce</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.1.1.1.4"><span class="ltx_text" id="S4.T4.1.1.1.4.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.1.1.1.5"><span class="ltx_text" id="S4.T4.1.1.1.5.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.1.1.1.6"><span class="ltx_text" id="S4.T4.1.1.1.6.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.1.1.1.7"><span class="ltx_text" id="S4.T4.1.1.1.7.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.1.1.1.8"><span class="ltx_text" id="S4.T4.1.1.1.8.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.1.1.1.1">
<span class="ltx_text" id="S4.T4.1.1.1.1.1" style="font-size:90%;">.64</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.1.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.1.m1.1a"><mo id="S4.T4.1.1.1.1.m1.1.1" mathsize="90%" xref="S4.T4.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.1.1.1.1.2" style="font-size:90%;">.03</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.2.2.2.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.2.2.2.2.1" style="font-size:90%;">TopKPerEmbd</span><span class="ltx_text" id="S4.T4.2.2.2.2.2" style="font-size:90%;">5</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.2.2.2.3"><span class="ltx_text" id="S4.T4.2.2.2.3.1" style="font-size:90%;">.838</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.2.2.2.4"><span class="ltx_text" id="S4.T4.2.2.2.4.1" style="font-size:90%;">.768</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.2.2.2.5"><span class="ltx_text" id="S4.T4.2.2.2.5.1" style="font-size:90%;">.681</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.2.2.2.6"><span class="ltx_text" id="S4.T4.2.2.2.6.1" style="font-size:90%;">.499</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.2.2.2.7"><span class="ltx_text" id="S4.T4.2.2.2.7.1" style="font-size:90%;">.437</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.2.2.2.1">
<span class="ltx_text" id="S4.T4.2.2.2.1.1" style="font-size:90%;">.95</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.2.2.2.1.m1.1"><semantics id="S4.T4.2.2.2.1.m1.1a"><mo id="S4.T4.2.2.2.1.m1.1.1" mathsize="90%" xref="S4.T4.2.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.1.m1.1b"><csymbol cd="latexml" id="S4.T4.2.2.2.1.m1.1.1.cmml" xref="S4.T4.2.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.2.2.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.2.2.2.1.2" style="font-size:90%;">.03</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.3.3.3.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.3.3.3.2.1" style="font-size:90%;">TopKPerEmbd</span><span class="ltx_text" id="S4.T4.3.3.3.2.2" style="font-size:90%;">10</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.3.3.3.3"><span class="ltx_text" id="S4.T4.3.3.3.3.1" style="font-size:90%;">.932</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.3.3.3.4"><span class="ltx_text" id="S4.T4.3.3.3.4.1" style="font-size:90%;">.905</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.3.3.3.5"><span class="ltx_text" id="S4.T4.3.3.3.5.1" style="font-size:90%;">.842</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.3.3.3.6"><span class="ltx_text" id="S4.T4.3.3.3.6.1" style="font-size:90%;">.678</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.3.3.3.7"><span class="ltx_text" id="S4.T4.3.3.3.7.1" style="font-size:90%;">.618</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.3.3.3.1">
<span class="ltx_text" id="S4.T4.3.3.3.1.1" style="font-size:90%;">.94</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.3.3.3.1.m1.1"><semantics id="S4.T4.3.3.3.1.m1.1a"><mo id="S4.T4.3.3.3.1.m1.1.1" mathsize="90%" xref="S4.T4.3.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.1.m1.1b"><csymbol cd="latexml" id="S4.T4.3.3.3.1.m1.1.1.cmml" xref="S4.T4.3.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.3.3.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.3.3.3.1.2" style="font-size:90%;">.05</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.4.4.4.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.4.4.4.2.1" style="font-size:90%;">TopKPerEmbd</span><span class="ltx_text" id="S4.T4.4.4.4.2.2" style="font-size:90%;">50</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.4.4.4.3"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.4.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.4.4.4.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.4.4.1" style="font-size:90%;">.997</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.4.4.4.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.4.4.5.1" style="font-size:90%;">.999</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.4.4.4.6"><span class="ltx_text" id="S4.T4.4.4.4.6.1" style="font-size:90%;">.977</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.4.4.4.7"><span class="ltx_text" id="S4.T4.4.4.4.7.1" style="font-size:90%;">.954</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.4.4.4.1">
<span class="ltx_text" id="S4.T4.4.4.4.1.1" style="font-size:90%;">.95</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.4.4.4.1.m1.1"><semantics id="S4.T4.4.4.4.1.m1.1a"><mo id="S4.T4.4.4.4.1.m1.1.1" mathsize="90%" xref="S4.T4.4.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.4.1.m1.1b"><csymbol cd="latexml" id="S4.T4.4.4.4.1.m1.1.1.cmml" xref="S4.T4.4.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.4.4.4.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.4.4.4.1.2" style="font-size:90%;">.05</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.5.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.5.5.5.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.5.5.5.2.1" style="font-size:90%;">TopKPerEmbd</span><span class="ltx_text" id="S4.T4.5.5.5.2.2" style="font-size:90%;">100</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.5.5.5.3"><span class="ltx_text ltx_font_bold" id="S4.T4.5.5.5.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.5.5.5.4"><span class="ltx_text ltx_font_bold" id="S4.T4.5.5.5.4.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.5.5.5.5"><span class="ltx_text ltx_font_bold" id="S4.T4.5.5.5.5.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.5.5.5.6"><span class="ltx_text ltx_font_bold" id="S4.T4.5.5.5.6.1" style="font-size:90%;">.995</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.5.5.5.7"><span class="ltx_text ltx_font_bold" id="S4.T4.5.5.5.7.1" style="font-size:90%;">.990</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.5.5.5.1">
<span class="ltx_text" id="S4.T4.5.5.5.1.1" style="font-size:90%;">1.24</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.5.5.5.1.m1.1"><semantics id="S4.T4.5.5.5.1.m1.1a"><mo id="S4.T4.5.5.5.1.m1.1.1" mathsize="90%" xref="S4.T4.5.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.5.1.m1.1b"><csymbol cd="latexml" id="S4.T4.5.5.5.1.m1.1.1.cmml" xref="S4.T4.5.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.5.5.5.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.5.5.5.1.2" style="font-size:90%;">.04</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.6.6.6.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.6.6.6.2.1" style="font-size:90%;">TopKAvg</span><span class="ltx_text" id="S4.T4.6.6.6.2.2" style="font-size:90%;">200</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.6.6.6.3"><span class="ltx_text" id="S4.T4.6.6.6.3.1" style="font-size:90%;">.980</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.6.6.6.4"><span class="ltx_text" id="S4.T4.6.6.6.4.1" style="font-size:90%;">.970</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.6.6.6.5"><span class="ltx_text" id="S4.T4.6.6.6.5.1" style="font-size:90%;">.967</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.6.6.6.6"><span class="ltx_text" id="S4.T4.6.6.6.6.1" style="font-size:90%;">.958</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.6.6.6.7"><span class="ltx_text" id="S4.T4.6.6.6.7.1" style="font-size:90%;">.948</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.6.6.6.1">
<span class="ltx_text" id="S4.T4.6.6.6.1.1" style="font-size:90%;">.74</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.6.6.6.1.m1.1"><semantics id="S4.T4.6.6.6.1.m1.1a"><mo id="S4.T4.6.6.6.1.m1.1.1" mathsize="90%" xref="S4.T4.6.6.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.6.6.6.1.m1.1b"><csymbol cd="latexml" id="S4.T4.6.6.6.1.m1.1.1.cmml" xref="S4.T4.6.6.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.6.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.6.6.6.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.6.6.6.1.2" style="font-size:90%;">.06</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.7.7.7.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.7.7.7.2.1" style="font-size:90%;">TopKAvg</span><span class="ltx_text" id="S4.T4.7.7.7.2.2" style="font-size:90%;">500</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.7.7.7.3"><span class="ltx_text ltx_font_bold" id="S4.T4.7.7.7.3.1" style="font-size:90%;">.992</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.7.7.7.4"><span class="ltx_text ltx_font_bold" id="S4.T4.7.7.7.4.1" style="font-size:90%;">.986</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.7.7.7.5"><span class="ltx_text ltx_font_bold" id="S4.T4.7.7.7.5.1" style="font-size:90%;">.989</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.7.7.7.6"><span class="ltx_text ltx_font_bold" id="S4.T4.7.7.7.6.1" style="font-size:90%;">.990</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.7.7.7.7"><span class="ltx_text ltx_font_bold" id="S4.T4.7.7.7.7.1" style="font-size:90%;">.990</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.7.7.7.1">
<span class="ltx_text" id="S4.T4.7.7.7.1.1" style="font-size:90%;">.71</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.7.7.7.1.m1.1"><semantics id="S4.T4.7.7.7.1.m1.1a"><mo id="S4.T4.7.7.7.1.m1.1.1" mathsize="90%" xref="S4.T4.7.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.7.7.7.1.m1.1b"><csymbol cd="latexml" id="S4.T4.7.7.7.1.m1.1.1.cmml" xref="S4.T4.7.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.7.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.7.7.7.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.7.7.7.1.2" style="font-size:90%;">.04</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.8.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.8.8.8.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.8.8.8.2.1" style="font-size:90%;">TopKAvg</span><span class="ltx_text" id="S4.T4.8.8.8.2.2" style="font-size:90%;">1000</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.8.8.8.3"><span class="ltx_text ltx_font_bold" id="S4.T4.8.8.8.3.1" style="font-size:90%;">.996</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.8.8.8.4"><span class="ltx_text ltx_font_bold" id="S4.T4.8.8.8.4.1" style="font-size:90%;">.994</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.8.8.8.5"><span class="ltx_text ltx_font_bold" id="S4.T4.8.8.8.5.1" style="font-size:90%;">.998</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.8.8.8.6"><span class="ltx_text ltx_font_bold" id="S4.T4.8.8.8.6.1" style="font-size:90%;">.997</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.8.8.8.7"><span class="ltx_text ltx_font_bold" id="S4.T4.8.8.8.7.1" style="font-size:90%;">.999</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.8.8.8.1">
<span class="ltx_text" id="S4.T4.8.8.8.1.1" style="font-size:90%;">.72</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.8.8.8.1.m1.1"><semantics id="S4.T4.8.8.8.1.m1.1a"><mo id="S4.T4.8.8.8.1.m1.1.1" mathsize="90%" xref="S4.T4.8.8.8.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.8.8.8.1.m1.1b"><csymbol cd="latexml" id="S4.T4.8.8.8.1.m1.1.1.cmml" xref="S4.T4.8.8.8.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.8.8.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.8.8.8.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.8.8.8.1.2" style="font-size:90%;">.03</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.9.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.9.9.9.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.9.9.9.2.1" style="font-size:90%;">CombTopK</span><span class="ltx_text" id="S4.T4.9.9.9.2.2" style="font-size:90%;">5_200</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.9.9.9.3"><span class="ltx_text ltx_font_bold" id="S4.T4.9.9.9.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.9.9.9.4"><span class="ltx_text ltx_font_bold" id="S4.T4.9.9.9.4.1" style="font-size:90%;">.997</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.9.9.9.5"><span class="ltx_text ltx_font_bold" id="S4.T4.9.9.9.5.1" style="font-size:90%;">.988</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.9.9.9.6"><span class="ltx_text" id="S4.T4.9.9.9.6.1" style="font-size:90%;">.975</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.9.9.9.7"><span class="ltx_text" id="S4.T4.9.9.9.7.1" style="font-size:90%;">.960</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.9.9.9.1">
<span class="ltx_text" id="S4.T4.9.9.9.1.1" style="font-size:90%;">1.09</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.9.9.9.1.m1.1"><semantics id="S4.T4.9.9.9.1.m1.1a"><mo id="S4.T4.9.9.9.1.m1.1.1" mathsize="90%" xref="S4.T4.9.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.9.9.9.1.m1.1b"><csymbol cd="latexml" id="S4.T4.9.9.9.1.m1.1.1.cmml" xref="S4.T4.9.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.9.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.9.9.9.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.9.9.9.1.2" style="font-size:90%;">.08</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.10.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.10.10.10.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.10.10.10.2.1" style="font-size:90%;">CombTopK</span><span class="ltx_text" id="S4.T4.10.10.10.2.2" style="font-size:90%;">50_500</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.10.10.10.3"><span class="ltx_text ltx_font_bold" id="S4.T4.10.10.10.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.10.10.10.4"><span class="ltx_text ltx_font_bold" id="S4.T4.10.10.10.4.1" style="font-size:90%;">.999</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.10.10.10.5"><span class="ltx_text ltx_font_bold" id="S4.T4.10.10.10.5.1" style="font-size:90%;">.999</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.10.10.10.6"><span class="ltx_text ltx_font_bold" id="S4.T4.10.10.10.6.1" style="font-size:90%;">.998</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.10.10.10.7"><span class="ltx_text ltx_font_bold" id="S4.T4.10.10.10.7.1" style="font-size:90%;">.997</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.10.10.10.1">
<span class="ltx_text" id="S4.T4.10.10.10.1.1" style="font-size:90%;">1.13</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.10.10.10.1.m1.1"><semantics id="S4.T4.10.10.10.1.m1.1a"><mo id="S4.T4.10.10.10.1.m1.1.1" mathsize="90%" xref="S4.T4.10.10.10.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.10.10.10.1.m1.1b"><csymbol cd="latexml" id="S4.T4.10.10.10.1.m1.1.1.cmml" xref="S4.T4.10.10.10.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.10.10.10.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.10.10.10.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.10.10.10.1.2" style="font-size:90%;">.04</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T4.11.11.11.2" rowspan="10"><span class="ltx_text ltx_font_italic" id="S4.T4.11.11.11.2.1" style="font-size:90%;">ML-20M</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T4.11.11.11.3"><span class="ltx_text ltx_font_italic" id="S4.T4.11.11.11.3.1" style="font-size:90%;">BruteForce</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.11.11.11.4"><span class="ltx_text" id="S4.T4.11.11.11.4.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.11.11.11.5"><span class="ltx_text" id="S4.T4.11.11.11.5.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.11.11.11.6"><span class="ltx_text" id="S4.T4.11.11.11.6.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.11.11.11.7"><span class="ltx_text" id="S4.T4.11.11.11.7.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.11.11.11.8"><span class="ltx_text" id="S4.T4.11.11.11.8.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.11.11.11.1">
<span class="ltx_text" id="S4.T4.11.11.11.1.1" style="font-size:90%;">3.08</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.11.11.11.1.m1.1"><semantics id="S4.T4.11.11.11.1.m1.1a"><mo id="S4.T4.11.11.11.1.m1.1.1" mathsize="90%" xref="S4.T4.11.11.11.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.11.11.11.1.m1.1b"><csymbol cd="latexml" id="S4.T4.11.11.11.1.m1.1.1.cmml" xref="S4.T4.11.11.11.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.11.11.11.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.11.11.11.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.11.11.11.1.2" style="font-size:90%;">.02</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.12.12.12.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.12.12.12.2.1" style="font-size:90%;">TopKPerEmbd</span><span class="ltx_text" id="S4.T4.12.12.12.2.2" style="font-size:90%;">5</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.12.12.12.3"><span class="ltx_text" id="S4.T4.12.12.12.3.1" style="font-size:90%;">.755</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.12.12.12.4"><span class="ltx_text" id="S4.T4.12.12.12.4.1" style="font-size:90%;">.702</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.12.12.12.5"><span class="ltx_text" id="S4.T4.12.12.12.5.1" style="font-size:90%;">.645</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.12.12.12.6"><span class="ltx_text" id="S4.T4.12.12.12.6.1" style="font-size:90%;">.467</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.12.12.12.7"><span class="ltx_text" id="S4.T4.12.12.12.7.1" style="font-size:90%;">.402</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.12.12.12.1">
<span class="ltx_text" id="S4.T4.12.12.12.1.1" style="font-size:90%;">1.19</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.12.12.12.1.m1.1"><semantics id="S4.T4.12.12.12.1.m1.1a"><mo id="S4.T4.12.12.12.1.m1.1.1" mathsize="90%" xref="S4.T4.12.12.12.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.12.12.12.1.m1.1b"><csymbol cd="latexml" id="S4.T4.12.12.12.1.m1.1.1.cmml" xref="S4.T4.12.12.12.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.12.12.12.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.12.12.12.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.12.12.12.1.2" style="font-size:90%;">.05</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.13.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.13.13.13.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.13.13.13.2.1" style="font-size:90%;">TopKPerEmbd</span><span class="ltx_text" id="S4.T4.13.13.13.2.2" style="font-size:90%;">10</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.13.13.13.3"><span class="ltx_text" id="S4.T4.13.13.13.3.1" style="font-size:90%;">.946</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.13.13.13.4"><span class="ltx_text" id="S4.T4.13.13.13.4.1" style="font-size:90%;">.876</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.13.13.13.5"><span class="ltx_text" id="S4.T4.13.13.13.5.1" style="font-size:90%;">.817</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.13.13.13.6"><span class="ltx_text" id="S4.T4.13.13.13.6.1" style="font-size:90%;">.645</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.13.13.13.7"><span class="ltx_text" id="S4.T4.13.13.13.7.1" style="font-size:90%;">.564</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.13.13.13.1">
<span class="ltx_text" id="S4.T4.13.13.13.1.1" style="font-size:90%;">1.17</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.13.13.13.1.m1.1"><semantics id="S4.T4.13.13.13.1.m1.1a"><mo id="S4.T4.13.13.13.1.m1.1.1" mathsize="90%" xref="S4.T4.13.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.13.13.13.1.m1.1b"><csymbol cd="latexml" id="S4.T4.13.13.13.1.m1.1.1.cmml" xref="S4.T4.13.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.13.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.13.13.13.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.13.13.13.1.2" style="font-size:90%;">.05</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.14.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.14.14.14.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.14.14.14.2.1" style="font-size:90%;">TopKPerEmbd</span><span class="ltx_text" id="S4.T4.14.14.14.2.2" style="font-size:90%;">50</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.14.14.14.3"><span class="ltx_text ltx_font_bold" id="S4.T4.14.14.14.3.1" style="font-size:90%;">.993</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.14.14.14.4"><span class="ltx_text ltx_font_bold" id="S4.T4.14.14.14.4.1" style="font-size:90%;">.986</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.14.14.14.5"><span class="ltx_text" id="S4.T4.14.14.14.5.1" style="font-size:90%;">.977</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.14.14.14.6"><span class="ltx_text" id="S4.T4.14.14.14.6.1" style="font-size:90%;">.931</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.14.14.14.7"><span class="ltx_text" id="S4.T4.14.14.14.7.1" style="font-size:90%;">.900</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.14.14.14.1">
<span class="ltx_text" id="S4.T4.14.14.14.1.1" style="font-size:90%;">1.55</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.14.14.14.1.m1.1"><semantics id="S4.T4.14.14.14.1.m1.1a"><mo id="S4.T4.14.14.14.1.m1.1.1" mathsize="90%" xref="S4.T4.14.14.14.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.14.14.14.1.m1.1b"><csymbol cd="latexml" id="S4.T4.14.14.14.1.m1.1.1.cmml" xref="S4.T4.14.14.14.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.14.14.14.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.14.14.14.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.14.14.14.1.2" style="font-size:90%;">.03</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.15.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.15.15.15.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.15.15.15.2.1" style="font-size:90%;">TopKPerEmbd</span><span class="ltx_text" id="S4.T4.15.15.15.2.2" style="font-size:90%;">100</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.15.15.15.3"><span class="ltx_text ltx_font_bold" id="S4.T4.15.15.15.3.1" style="font-size:90%;">.998</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.15.15.15.4"><span class="ltx_text ltx_font_bold" id="S4.T4.15.15.15.4.1" style="font-size:90%;">.997</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.15.15.15.5"><span class="ltx_text ltx_font_bold" id="S4.T4.15.15.15.5.1" style="font-size:90%;">.994</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.15.15.15.6"><span class="ltx_text" id="S4.T4.15.15.15.6.1" style="font-size:90%;">.979</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.15.15.15.7"><span class="ltx_text" id="S4.T4.15.15.15.7.1" style="font-size:90%;">.966</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.15.15.15.1">
<span class="ltx_text" id="S4.T4.15.15.15.1.1" style="font-size:90%;">2.26</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.15.15.15.1.m1.1"><semantics id="S4.T4.15.15.15.1.m1.1a"><mo id="S4.T4.15.15.15.1.m1.1.1" mathsize="90%" xref="S4.T4.15.15.15.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.15.15.15.1.m1.1b"><csymbol cd="latexml" id="S4.T4.15.15.15.1.m1.1.1.cmml" xref="S4.T4.15.15.15.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.15.15.15.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.15.15.15.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.15.15.15.1.2" style="font-size:90%;">.03</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.16.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.16.16.16.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.16.16.16.2.1" style="font-size:90%;">TopKAvg</span><span class="ltx_text" id="S4.T4.16.16.16.2.2" style="font-size:90%;">200</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.16.16.16.3"><span class="ltx_text ltx_font_bold" id="S4.T4.16.16.16.3.1" style="font-size:90%;">.992</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.16.16.16.4"><span class="ltx_text ltx_font_bold" id="S4.T4.16.16.16.4.1" style="font-size:90%;">.992</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.16.16.16.5"><span class="ltx_text ltx_font_bold" id="S4.T4.16.16.16.5.1" style="font-size:90%;">.992</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.16.16.16.6"><span class="ltx_text" id="S4.T4.16.16.16.6.1" style="font-size:90%;">.980</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.16.16.16.7"><span class="ltx_text" id="S4.T4.16.16.16.7.1" style="font-size:90%;">.958</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.16.16.16.1">
<span class="ltx_text" id="S4.T4.16.16.16.1.1" style="font-size:90%;">.76</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.16.16.16.1.m1.1"><semantics id="S4.T4.16.16.16.1.m1.1a"><mo id="S4.T4.16.16.16.1.m1.1.1" mathsize="90%" xref="S4.T4.16.16.16.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.16.16.16.1.m1.1b"><csymbol cd="latexml" id="S4.T4.16.16.16.1.m1.1.1.cmml" xref="S4.T4.16.16.16.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.16.16.16.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.16.16.16.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.16.16.16.1.2" style="font-size:90%;">.04</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.17.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.17.17.17.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.17.17.17.2.1" style="font-size:90%;">TopKAvg</span><span class="ltx_text" id="S4.T4.17.17.17.2.2" style="font-size:90%;">500</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.17.17.17.3"><span class="ltx_text ltx_font_bold" id="S4.T4.17.17.17.3.1" style="font-size:90%;">.992</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.17.17.17.4"><span class="ltx_text ltx_font_bold" id="S4.T4.17.17.17.4.1" style="font-size:90%;">.993</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.17.17.17.5"><span class="ltx_text ltx_font_bold" id="S4.T4.17.17.17.5.1" style="font-size:90%;">.995</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.17.17.17.6"><span class="ltx_text ltx_font_bold" id="S4.T4.17.17.17.6.1" style="font-size:90%;">.995</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.17.17.17.7"><span class="ltx_text ltx_font_bold" id="S4.T4.17.17.17.7.1" style="font-size:90%;">.993</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.17.17.17.1">
<span class="ltx_text" id="S4.T4.17.17.17.1.1" style="font-size:90%;">.77</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.17.17.17.1.m1.1"><semantics id="S4.T4.17.17.17.1.m1.1a"><mo id="S4.T4.17.17.17.1.m1.1.1" mathsize="90%" xref="S4.T4.17.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.17.17.17.1.m1.1b"><csymbol cd="latexml" id="S4.T4.17.17.17.1.m1.1.1.cmml" xref="S4.T4.17.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.17.17.17.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.17.17.17.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.17.17.17.1.2" style="font-size:90%;">.04</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.18.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.18.18.18.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.18.18.18.2.1" style="font-size:90%;">TopKAvg</span><span class="ltx_text" id="S4.T4.18.18.18.2.2" style="font-size:90%;">1000</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.18.18.18.3"><span class="ltx_text ltx_font_bold" id="S4.T4.18.18.18.3.1" style="font-size:90%;">.992</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.18.18.18.4"><span class="ltx_text ltx_font_bold" id="S4.T4.18.18.18.4.1" style="font-size:90%;">.994</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.18.18.18.5"><span class="ltx_text ltx_font_bold" id="S4.T4.18.18.18.5.1" style="font-size:90%;">.996</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.18.18.18.6"><span class="ltx_text ltx_font_bold" id="S4.T4.18.18.18.6.1" style="font-size:90%;">.998</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.18.18.18.7"><span class="ltx_text ltx_font_bold" id="S4.T4.18.18.18.7.1" style="font-size:90%;">.997</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.18.18.18.1">
<span class="ltx_text" id="S4.T4.18.18.18.1.1" style="font-size:90%;">.75</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.18.18.18.1.m1.1"><semantics id="S4.T4.18.18.18.1.m1.1a"><mo id="S4.T4.18.18.18.1.m1.1.1" mathsize="90%" xref="S4.T4.18.18.18.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.18.18.18.1.m1.1b"><csymbol cd="latexml" id="S4.T4.18.18.18.1.m1.1.1.cmml" xref="S4.T4.18.18.18.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.18.18.18.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.18.18.18.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.18.18.18.1.2" style="font-size:90%;">.03</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.19.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.19.19.19.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.19.19.19.2.1" style="font-size:90%;">CombTopK</span><span class="ltx_text" id="S4.T4.19.19.19.2.2" style="font-size:90%;">5_200</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.19.19.19.3"><span class="ltx_text ltx_font_bold" id="S4.T4.19.19.19.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.19.19.19.4"><span class="ltx_text ltx_font_bold" id="S4.T4.19.19.19.4.1" style="font-size:90%;">.998</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.19.19.19.5"><span class="ltx_text ltx_font_bold" id="S4.T4.19.19.19.5.1" style="font-size:90%;">.998</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.19.19.19.6"><span class="ltx_text" id="S4.T4.19.19.19.6.1" style="font-size:90%;">.983</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.19.19.19.7"><span class="ltx_text" id="S4.T4.19.19.19.7.1" style="font-size:90%;">.962</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.19.19.19.1">
<span class="ltx_text" id="S4.T4.19.19.19.1.1" style="font-size:90%;">1.32</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.19.19.19.1.m1.1"><semantics id="S4.T4.19.19.19.1.m1.1a"><mo id="S4.T4.19.19.19.1.m1.1.1" mathsize="90%" xref="S4.T4.19.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.19.19.19.1.m1.1b"><csymbol cd="latexml" id="S4.T4.19.19.19.1.m1.1.1.cmml" xref="S4.T4.19.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.19.19.19.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.19.19.19.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.19.19.19.1.2" style="font-size:90%;">.06</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.20.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.20.20.20.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.20.20.20.2.1" style="font-size:90%;">CombTopK</span><span class="ltx_text" id="S4.T4.20.20.20.2.2" style="font-size:90%;">50_500</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.20.20.20.3"><span class="ltx_text ltx_font_bold" id="S4.T4.20.20.20.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.20.20.20.4"><span class="ltx_text ltx_font_bold" id="S4.T4.20.20.20.4.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.20.20.20.5"><span class="ltx_text ltx_font_bold" id="S4.T4.20.20.20.5.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.20.20.20.6"><span class="ltx_text ltx_font_bold" id="S4.T4.20.20.20.6.1" style="font-size:90%;">.999</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.20.20.20.7"><span class="ltx_text ltx_font_bold" id="S4.T4.20.20.20.7.1" style="font-size:90%;">.996</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.20.20.20.1">
<span class="ltx_text" id="S4.T4.20.20.20.1.1" style="font-size:90%;">1.85</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.20.20.20.1.m1.1"><semantics id="S4.T4.20.20.20.1.m1.1a"><mo id="S4.T4.20.20.20.1.m1.1.1" mathsize="90%" xref="S4.T4.20.20.20.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.20.20.20.1.m1.1b"><csymbol cd="latexml" id="S4.T4.20.20.20.1.m1.1.1.cmml" xref="S4.T4.20.20.20.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.20.20.20.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.20.20.20.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.20.20.20.1.2" style="font-size:90%;">.03</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.21.21.21">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T4.21.21.21.2" rowspan="13"><span class="ltx_text ltx_font_italic" id="S4.T4.21.21.21.2.1" style="font-size:90%;">Books</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T4.21.21.21.3"><span class="ltx_text ltx_font_italic" id="S4.T4.21.21.21.3.1" style="font-size:90%;">BruteForce</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.21.21.21.4"><span class="ltx_text" id="S4.T4.21.21.21.4.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.21.21.21.5"><span class="ltx_text" id="S4.T4.21.21.21.5.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.21.21.21.6"><span class="ltx_text" id="S4.T4.21.21.21.6.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.21.21.21.7"><span class="ltx_text" id="S4.T4.21.21.21.7.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.21.21.21.8"><span class="ltx_text" id="S4.T4.21.21.21.8.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.21.21.21.1">
<span class="ltx_text" id="S4.T4.21.21.21.1.1" style="font-size:90%;">149.02</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.21.21.21.1.m1.1"><semantics id="S4.T4.21.21.21.1.m1.1a"><mo id="S4.T4.21.21.21.1.m1.1.1" mathsize="90%" xref="S4.T4.21.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.21.21.21.1.m1.1b"><csymbol cd="latexml" id="S4.T4.21.21.21.1.m1.1.1.cmml" xref="S4.T4.21.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.21.21.21.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.21.21.21.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.21.21.21.1.2" style="font-size:90%;">.49</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.22.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.22.22.22.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.22.22.22.2.1" style="font-size:90%;">TopKPerEmbd</span><span class="ltx_text" id="S4.T4.22.22.22.2.2" style="font-size:90%;">5</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.22.22.22.3"><span class="ltx_text" id="S4.T4.22.22.22.3.1" style="font-size:90%;">.907</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.22.22.22.4"><span class="ltx_text" id="S4.T4.22.22.22.4.1" style="font-size:90%;">.915</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.22.22.22.5"><span class="ltx_text" id="S4.T4.22.22.22.5.1" style="font-size:90%;">.809</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.22.22.22.6"><span class="ltx_text" id="S4.T4.22.22.22.6.1" style="font-size:90%;">.509</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.22.22.22.7"><span class="ltx_text" id="S4.T4.22.22.22.7.1" style="font-size:90%;">.396</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.22.22.22.1">
<span class="ltx_text" id="S4.T4.22.22.22.1.1" style="font-size:90%;">20.17</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.22.22.22.1.m1.1"><semantics id="S4.T4.22.22.22.1.m1.1a"><mo id="S4.T4.22.22.22.1.m1.1.1" mathsize="90%" xref="S4.T4.22.22.22.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.22.22.22.1.m1.1b"><csymbol cd="latexml" id="S4.T4.22.22.22.1.m1.1.1.cmml" xref="S4.T4.22.22.22.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.22.22.22.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.22.22.22.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.22.22.22.1.2" style="font-size:90%;">.06</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.23.23.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.23.23.23.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.23.23.23.2.1" style="font-size:90%;">TopKPerEmbd</span><span class="ltx_text" id="S4.T4.23.23.23.2.2" style="font-size:90%;">10</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.23.23.23.3"><span class="ltx_text" id="S4.T4.23.23.23.3.1" style="font-size:90%;">.936</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.23.23.23.4"><span class="ltx_text ltx_font_bold" id="S4.T4.23.23.23.4.1" style="font-size:90%;">.986</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.23.23.23.5"><span class="ltx_text" id="S4.T4.23.23.23.5.1" style="font-size:90%;">.914</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.23.23.23.6"><span class="ltx_text" id="S4.T4.23.23.23.6.1" style="font-size:90%;">.698</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.23.23.23.7"><span class="ltx_text" id="S4.T4.23.23.23.7.1" style="font-size:90%;">.561</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.23.23.23.1">
<span class="ltx_text" id="S4.T4.23.23.23.1.1" style="font-size:90%;">20.33</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.23.23.23.1.m1.1"><semantics id="S4.T4.23.23.23.1.m1.1a"><mo id="S4.T4.23.23.23.1.m1.1.1" mathsize="90%" xref="S4.T4.23.23.23.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.23.23.23.1.m1.1b"><csymbol cd="latexml" id="S4.T4.23.23.23.1.m1.1.1.cmml" xref="S4.T4.23.23.23.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.23.23.23.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.23.23.23.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.23.23.23.1.2" style="font-size:90%;">.06</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.24.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.24.24.24.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.24.24.24.2.1" style="font-size:90%;">TopKPerEmbd</span><span class="ltx_text" id="S4.T4.24.24.24.2.2" style="font-size:90%;">50</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.24.24.24.3"><span class="ltx_text ltx_font_bold" id="S4.T4.24.24.24.3.1" style="font-size:90%;">.993</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.24.24.24.4"><span class="ltx_text ltx_font_bold" id="S4.T4.24.24.24.4.1" style="font-size:90%;">.992</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.24.24.24.5"><span class="ltx_text ltx_font_bold" id="S4.T4.24.24.24.5.1" style="font-size:90%;">.994</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.24.24.24.6"><span class="ltx_text" id="S4.T4.24.24.24.6.1" style="font-size:90%;">.956</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.24.24.24.7"><span class="ltx_text" id="S4.T4.24.24.24.7.1" style="font-size:90%;">.902</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.24.24.24.1">
<span class="ltx_text" id="S4.T4.24.24.24.1.1" style="font-size:90%;">21.09</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.24.24.24.1.m1.1"><semantics id="S4.T4.24.24.24.1.m1.1a"><mo id="S4.T4.24.24.24.1.m1.1.1" mathsize="90%" xref="S4.T4.24.24.24.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.24.24.24.1.m1.1b"><csymbol cd="latexml" id="S4.T4.24.24.24.1.m1.1.1.cmml" xref="S4.T4.24.24.24.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.24.24.24.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.24.24.24.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.24.24.24.1.2" style="font-size:90%;">.04</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.25.25.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.25.25.25.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.25.25.25.2.1" style="font-size:90%;">TopKPerEmbd</span><span class="ltx_text" id="S4.T4.25.25.25.2.2" style="font-size:90%;">100</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.25.25.25.3"><span class="ltx_text ltx_font_bold" id="S4.T4.25.25.25.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.25.25.25.4"><span class="ltx_text ltx_font_bold" id="S4.T4.25.25.25.4.1" style="font-size:90%;">.995</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.25.25.25.5"><span class="ltx_text ltx_font_bold" id="S4.T4.25.25.25.5.1" style="font-size:90%;">.996</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.25.25.25.6"><span class="ltx_text ltx_font_bold" id="S4.T4.25.25.25.6.1" style="font-size:90%;">.985</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.25.25.25.7"><span class="ltx_text" id="S4.T4.25.25.25.7.1" style="font-size:90%;">.959</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.25.25.25.1">
<span class="ltx_text" id="S4.T4.25.25.25.1.1" style="font-size:90%;">22.53</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.25.25.25.1.m1.1"><semantics id="S4.T4.25.25.25.1.m1.1a"><mo id="S4.T4.25.25.25.1.m1.1.1" mathsize="90%" xref="S4.T4.25.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.25.25.25.1.m1.1b"><csymbol cd="latexml" id="S4.T4.25.25.25.1.m1.1.1.cmml" xref="S4.T4.25.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.25.25.25.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.25.25.25.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.25.25.25.1.2" style="font-size:90%;">.06</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.26.26.26">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.26.26.26.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.26.26.26.2.1" style="font-size:90%;">TopKAvg</span><span class="ltx_text" id="S4.T4.26.26.26.2.2" style="font-size:90%;">200</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.26.26.26.3"><span class="ltx_text ltx_font_bold" id="S4.T4.26.26.26.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.26.26.26.4"><span class="ltx_text" id="S4.T4.26.26.26.4.1" style="font-size:90%;">.978</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.26.26.26.5"><span class="ltx_text" id="S4.T4.26.26.26.5.1" style="font-size:90%;">.948</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.26.26.26.6"><span class="ltx_text" id="S4.T4.26.26.26.6.1" style="font-size:90%;">.845</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.26.26.26.7"><span class="ltx_text" id="S4.T4.26.26.26.7.1" style="font-size:90%;">.767</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.26.26.26.1">
<span class="ltx_text" id="S4.T4.26.26.26.1.1" style="font-size:90%;">.68</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.26.26.26.1.m1.1"><semantics id="S4.T4.26.26.26.1.m1.1a"><mo id="S4.T4.26.26.26.1.m1.1.1" mathsize="90%" xref="S4.T4.26.26.26.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.26.26.26.1.m1.1b"><csymbol cd="latexml" id="S4.T4.26.26.26.1.m1.1.1.cmml" xref="S4.T4.26.26.26.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.26.26.26.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.26.26.26.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.26.26.26.1.2" style="font-size:90%;">.03</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.27.27.27">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.27.27.27.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.27.27.27.2.1" style="font-size:90%;">TopKAvg</span><span class="ltx_text" id="S4.T4.27.27.27.2.2" style="font-size:90%;">500</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.27.27.27.3"><span class="ltx_text ltx_font_bold" id="S4.T4.27.27.27.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.27.27.27.4"><span class="ltx_text ltx_font_bold" id="S4.T4.27.27.27.4.1" style="font-size:90%;">.992</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.27.27.27.5"><span class="ltx_text ltx_font_bold" id="S4.T4.27.27.27.5.1" style="font-size:90%;">.996</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.27.27.27.6"><span class="ltx_text" id="S4.T4.27.27.27.6.1" style="font-size:90%;">.919</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.27.27.27.7"><span class="ltx_text" id="S4.T4.27.27.27.7.1" style="font-size:90%;">.875</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.27.27.27.1">
<span class="ltx_text" id="S4.T4.27.27.27.1.1" style="font-size:90%;">.68</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.27.27.27.1.m1.1"><semantics id="S4.T4.27.27.27.1.m1.1a"><mo id="S4.T4.27.27.27.1.m1.1.1" mathsize="90%" xref="S4.T4.27.27.27.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.27.27.27.1.m1.1b"><csymbol cd="latexml" id="S4.T4.27.27.27.1.m1.1.1.cmml" xref="S4.T4.27.27.27.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.27.27.27.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.27.27.27.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.27.27.27.1.2" style="font-size:90%;">.03</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.28.28.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.28.28.28.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.28.28.28.2.1" style="font-size:90%;">TopKAvg</span><span class="ltx_text" id="S4.T4.28.28.28.2.2" style="font-size:90%;">1000</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.28.28.28.3"><span class="ltx_text ltx_font_bold" id="S4.T4.28.28.28.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.28.28.28.4"><span class="ltx_text ltx_font_bold" id="S4.T4.28.28.28.4.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.28.28.28.5"><span class="ltx_text ltx_font_bold" id="S4.T4.28.28.28.5.1" style="font-size:90%;">.996</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.28.28.28.6"><span class="ltx_text" id="S4.T4.28.28.28.6.1" style="font-size:90%;">.963</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.28.28.28.7"><span class="ltx_text" id="S4.T4.28.28.28.7.1" style="font-size:90%;">.939</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.28.28.28.1">
<span class="ltx_text" id="S4.T4.28.28.28.1.1" style="font-size:90%;">.84</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.28.28.28.1.m1.1"><semantics id="S4.T4.28.28.28.1.m1.1a"><mo id="S4.T4.28.28.28.1.m1.1.1" mathsize="90%" xref="S4.T4.28.28.28.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.28.28.28.1.m1.1b"><csymbol cd="latexml" id="S4.T4.28.28.28.1.m1.1.1.cmml" xref="S4.T4.28.28.28.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.28.28.28.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.28.28.28.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.28.28.28.1.2" style="font-size:90%;">.01</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.29.29.29">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.29.29.29.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.29.29.29.2.1" style="font-size:90%;">TopKAvg</span><span class="ltx_text" id="S4.T4.29.29.29.2.2" style="font-size:90%;">2000</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.29.29.29.3"><span class="ltx_text ltx_font_bold" id="S4.T4.29.29.29.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.29.29.29.4"><span class="ltx_text ltx_font_bold" id="S4.T4.29.29.29.4.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.29.29.29.5"><span class="ltx_text ltx_font_bold" id="S4.T4.29.29.29.5.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.29.29.29.6"><span class="ltx_text" id="S4.T4.29.29.29.6.1" style="font-size:90%;">.980</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.29.29.29.7"><span class="ltx_text" id="S4.T4.29.29.29.7.1" style="font-size:90%;">.968</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.29.29.29.1">
<span class="ltx_text" id="S4.T4.29.29.29.1.1" style="font-size:90%;">1.04</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.29.29.29.1.m1.1"><semantics id="S4.T4.29.29.29.1.m1.1a"><mo id="S4.T4.29.29.29.1.m1.1.1" mathsize="90%" xref="S4.T4.29.29.29.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.29.29.29.1.m1.1b"><csymbol cd="latexml" id="S4.T4.29.29.29.1.m1.1.1.cmml" xref="S4.T4.29.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.29.29.29.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.29.29.29.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.29.29.29.1.2" style="font-size:90%;">.02</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.30.30.30">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.30.30.30.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.30.30.30.2.1" style="font-size:90%;">TopKAvg</span><span class="ltx_text" id="S4.T4.30.30.30.2.2" style="font-size:90%;">4000</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.30.30.30.3"><span class="ltx_text ltx_font_bold" id="S4.T4.30.30.30.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.30.30.30.4"><span class="ltx_text ltx_font_bold" id="S4.T4.30.30.30.4.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.30.30.30.5"><span class="ltx_text ltx_font_bold" id="S4.T4.30.30.30.5.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.30.30.30.6"><span class="ltx_text ltx_font_bold" id="S4.T4.30.30.30.6.1" style="font-size:90%;">.996</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.30.30.30.7"><span class="ltx_text ltx_font_bold" id="S4.T4.30.30.30.7.1" style="font-size:90%;">.987</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.30.30.30.1">
<span class="ltx_text" id="S4.T4.30.30.30.1.1" style="font-size:90%;">1.64</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.30.30.30.1.m1.1"><semantics id="S4.T4.30.30.30.1.m1.1a"><mo id="S4.T4.30.30.30.1.m1.1.1" mathsize="90%" xref="S4.T4.30.30.30.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.30.30.30.1.m1.1b"><csymbol cd="latexml" id="S4.T4.30.30.30.1.m1.1.1.cmml" xref="S4.T4.30.30.30.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.30.30.30.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.30.30.30.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.30.30.30.1.2" style="font-size:90%;">.04</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.31.31.31">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.31.31.31.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.31.31.31.2.1" style="font-size:90%;">CombTopK</span><span class="ltx_text" id="S4.T4.31.31.31.2.2" style="font-size:90%;">5_200</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.31.31.31.3"><span class="ltx_text" id="S4.T4.31.31.31.3.1" style="font-size:90%;">.979</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.31.31.31.4"><span class="ltx_text" id="S4.T4.31.31.31.4.1" style="font-size:90%;">.984</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.31.31.31.5"><span class="ltx_text" id="S4.T4.31.31.31.5.1" style="font-size:90%;">.981</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.31.31.31.6"><span class="ltx_text" id="S4.T4.31.31.31.6.1" style="font-size:90%;">.892</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.31.31.31.7"><span class="ltx_text" id="S4.T4.31.31.31.7.1" style="font-size:90%;">.818</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.31.31.31.1">
<span class="ltx_text" id="S4.T4.31.31.31.1.1" style="font-size:90%;">20.29</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.31.31.31.1.m1.1"><semantics id="S4.T4.31.31.31.1.m1.1a"><mo id="S4.T4.31.31.31.1.m1.1.1" mathsize="90%" xref="S4.T4.31.31.31.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.31.31.31.1.m1.1b"><csymbol cd="latexml" id="S4.T4.31.31.31.1.m1.1.1.cmml" xref="S4.T4.31.31.31.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.31.31.31.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.31.31.31.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.31.31.31.1.2" style="font-size:90%;">.05</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.32.32.32">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.32.32.32.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.32.32.32.2.1" style="font-size:90%;">CombTopK</span><span class="ltx_text" id="S4.T4.32.32.32.2.2" style="font-size:90%;">50_500</span>
</th>
<td class="ltx_td ltx_align_left" id="S4.T4.32.32.32.3"><span class="ltx_text ltx_font_bold" id="S4.T4.32.32.32.3.1" style="font-size:90%;">.993</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.32.32.32.4"><span class="ltx_text ltx_font_bold" id="S4.T4.32.32.32.4.1" style="font-size:90%;">.989</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.32.32.32.5"><span class="ltx_text ltx_font_bold" id="S4.T4.32.32.32.5.1" style="font-size:90%;">.994</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.32.32.32.6"><span class="ltx_text" id="S4.T4.32.32.32.6.1" style="font-size:90%;">.975</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.32.32.32.7"><span class="ltx_text" id="S4.T4.32.32.32.7.1" style="font-size:90%;">.961</span></td>
<td class="ltx_td ltx_align_left" id="S4.T4.32.32.32.1">
<span class="ltx_text" id="S4.T4.32.32.32.1.1" style="font-size:90%;">21.57</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.32.32.32.1.m1.1"><semantics id="S4.T4.32.32.32.1.m1.1a"><mo id="S4.T4.32.32.32.1.m1.1.1" mathsize="90%" xref="S4.T4.32.32.32.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.32.32.32.1.m1.1b"><csymbol cd="latexml" id="S4.T4.32.32.32.1.m1.1.1.cmml" xref="S4.T4.32.32.32.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.32.32.32.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.32.32.32.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.32.32.32.1.2" style="font-size:90%;">.06</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.33.33.33">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T4.33.33.33.2">
<span class="ltx_text ltx_font_italic" id="S4.T4.33.33.33.2.1" style="font-size:90%;">CombTopK</span><span class="ltx_text" id="S4.T4.33.33.33.2.2" style="font-size:90%;">100_1000</span>
</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T4.33.33.33.3"><span class="ltx_text ltx_font_bold" id="S4.T4.33.33.33.3.1" style="font-size:90%;">1.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T4.33.33.33.4"><span class="ltx_text ltx_font_bold" id="S4.T4.33.33.33.4.1" style="font-size:90%;">.997</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T4.33.33.33.5"><span class="ltx_text ltx_font_bold" id="S4.T4.33.33.33.5.1" style="font-size:90%;">.996</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T4.33.33.33.6"><span class="ltx_text ltx_font_bold" id="S4.T4.33.33.33.6.1" style="font-size:90%;">.993</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T4.33.33.33.7"><span class="ltx_text ltx_font_bold" id="S4.T4.33.33.33.7.1" style="font-size:90%;">.992</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T4.33.33.33.1">
<span class="ltx_text" id="S4.T4.33.33.33.1.1" style="font-size:90%;">23.00</span><math alttext="\pm" class="ltx_Math" display="inline" id="S4.T4.33.33.33.1.m1.1"><semantics id="S4.T4.33.33.33.1.m1.1a"><mo id="S4.T4.33.33.33.1.m1.1.1" mathsize="90%" xref="S4.T4.33.33.33.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.33.33.33.1.m1.1b"><csymbol cd="latexml" id="S4.T4.33.33.33.1.m1.1.1.cmml" xref="S4.T4.33.33.33.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.33.33.33.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S4.T4.33.33.33.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S4.T4.33.33.33.1.2" style="font-size:90%;">.08</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4: </span>Evaluation of top <math alttext="K" class="ltx_Math" display="inline" id="S4.T4.36.36.m1.1"><semantics id="S4.T4.36.36.m1.1b"><mi id="S4.T4.36.36.m1.1.1" xref="S4.T4.36.36.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T4.36.36.m1.1c"><ci id="S4.T4.36.36.m1.1.1.cmml" xref="S4.T4.36.36.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.36.36.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S4.T4.36.36.m1.1e">italic_K</annotation></semantics></math> retrieval performance, with hit rate (HR) normalized by the brute-force top <math alttext="K" class="ltx_Math" display="inline" id="S4.T4.37.37.m2.1"><semantics id="S4.T4.37.37.m2.1b"><mi id="S4.T4.37.37.m2.1.1" xref="S4.T4.37.37.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T4.37.37.m2.1c"><ci id="S4.T4.37.37.m2.1.1.cmml" xref="S4.T4.37.37.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.37.37.m2.1d">K</annotation><annotation encoding="application/x-llamapun" id="S4.T4.37.37.m2.1e">italic_K</annotation></semantics></math> method and latency with standard deviation measured over the evaluation of retrieval for a batch of queries (where the batch size is 32). (Relative) hit rate higher than .99 is marked in <span class="ltx_text ltx_font_bold" id="S4.T4.45.1">bold</span>.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We evaluate the following methods on their top <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_K</annotation></semantics></math> retrieval performance:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.3">Brute-force top <math alttext="K" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><mi id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><ci id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">italic_K</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S4.I1.i1.p1.3.1">BruteForce</span>): Evaluate the <span class="ltx_text ltx_font_italic" id="S4.I1.i1.p1.3.2">MoL</span> scores for all items and return the top <math alttext="K" class="ltx_Math" display="inline" id="S4.I1.i1.p1.2.m2.1"><semantics id="S4.I1.i1.p1.2.m2.1a"><mi id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><ci id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.2.m2.1d">italic_K</annotation></semantics></math> items. This is the ground truth in our top <math alttext="K" class="ltx_Math" display="inline" id="S4.I1.i1.p1.3.m3.1"><semantics id="S4.I1.i1.p1.3.m3.1a"><mi id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><ci id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.3.m3.1d">italic_K</annotation></semantics></math> evaluation <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We omit the baseline with the two-pass exact algorithm (Section <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S3.SS1" title="3.1 Exact algorithm ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">3.1</span></a>) because the range-based item retrieval can still be expensive when the range threshold is loose. Empirically, the brute-force top <math alttext="K" class="ltx_Math" display="inline" id="footnote1.m1.1"><semantics id="footnote1.m1.1b"><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.1e">italic_K</annotation></semantics></math> is more efficient on our datasets. We leave the efficient implementation of the two-pass exact algorithm as future work.</span></span></span>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.4">Per embedding top <math alttext="K" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.1"><semantics id="S4.I1.i2.p1.1.m1.1a"><mi id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><ci id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.1d">italic_K</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S4.I1.i2.p1.4.1">TopKPerEmbd</span>(<math alttext="N" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m2.1"><semantics id="S4.I1.i2.p1.2.m2.1a"><mi id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><ci id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m2.1d">italic_N</annotation></semantics></math>)): This algorithm is described in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S3.SS2" title="3.2 Approximate algorithms ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">3.2</span></a>. <math alttext="N" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m3.1"><semantics id="S4.I1.i2.p1.3.m3.1a"><mi id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><ci id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.3.m3.1d">italic_N</annotation></semantics></math> is the number of candidate items retrieved from each embedding set, where <math alttext="N\times P\geq K" class="ltx_Math" display="inline" id="S4.I1.i2.p1.4.m4.1"><semantics id="S4.I1.i2.p1.4.m4.1a"><mrow id="S4.I1.i2.p1.4.m4.1.1" xref="S4.I1.i2.p1.4.m4.1.1.cmml"><mrow id="S4.I1.i2.p1.4.m4.1.1.2" xref="S4.I1.i2.p1.4.m4.1.1.2.cmml"><mi id="S4.I1.i2.p1.4.m4.1.1.2.2" xref="S4.I1.i2.p1.4.m4.1.1.2.2.cmml">N</mi><mo id="S4.I1.i2.p1.4.m4.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.I1.i2.p1.4.m4.1.1.2.1.cmml">×</mo><mi id="S4.I1.i2.p1.4.m4.1.1.2.3" xref="S4.I1.i2.p1.4.m4.1.1.2.3.cmml">P</mi></mrow><mo id="S4.I1.i2.p1.4.m4.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.cmml">≥</mo><mi id="S4.I1.i2.p1.4.m4.1.1.3" xref="S4.I1.i2.p1.4.m4.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.1b"><apply id="S4.I1.i2.p1.4.m4.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1"><geq id="S4.I1.i2.p1.4.m4.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1"></geq><apply id="S4.I1.i2.p1.4.m4.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1.2"><times id="S4.I1.i2.p1.4.m4.1.1.2.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.2.1"></times><ci id="S4.I1.i2.p1.4.m4.1.1.2.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1.2.2">𝑁</ci><ci id="S4.I1.i2.p1.4.m4.1.1.2.3.cmml" xref="S4.I1.i2.p1.4.m4.1.1.2.3">𝑃</ci></apply><ci id="S4.I1.i2.p1.4.m4.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.1c">N\times P\geq K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.4.m4.1d">italic_N × italic_P ≥ italic_K</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.4">Average top <math alttext="K" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.m1.1"><semantics id="S4.I1.i3.p1.1.m1.1a"><mi id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><ci id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.1.m1.1d">italic_K</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S4.I1.i3.p1.4.1">TopKAvg</span>(<math alttext="N" class="ltx_Math" display="inline" id="S4.I1.i3.p1.2.m2.1"><semantics id="S4.I1.i3.p1.2.m2.1a"><mi id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.m2.1b"><ci id="S4.I1.i3.p1.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.2.m2.1d">italic_N</annotation></semantics></math>)): This algorithm is described in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S3.SS2" title="3.2 Approximate algorithms ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">3.2</span></a>. <math alttext="N" class="ltx_Math" display="inline" id="S4.I1.i3.p1.3.m3.1"><semantics id="S4.I1.i3.p1.3.m3.1a"><mi id="S4.I1.i3.p1.3.m3.1.1" xref="S4.I1.i3.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.3.m3.1b"><ci id="S4.I1.i3.p1.3.m3.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.3.m3.1d">italic_N</annotation></semantics></math> is the number of the candidate items retrieved by average dot products, where <math alttext="N\geq K" class="ltx_Math" display="inline" id="S4.I1.i3.p1.4.m4.1"><semantics id="S4.I1.i3.p1.4.m4.1a"><mrow id="S4.I1.i3.p1.4.m4.1.1" xref="S4.I1.i3.p1.4.m4.1.1.cmml"><mi id="S4.I1.i3.p1.4.m4.1.1.2" xref="S4.I1.i3.p1.4.m4.1.1.2.cmml">N</mi><mo id="S4.I1.i3.p1.4.m4.1.1.1" xref="S4.I1.i3.p1.4.m4.1.1.1.cmml">≥</mo><mi id="S4.I1.i3.p1.4.m4.1.1.3" xref="S4.I1.i3.p1.4.m4.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.4.m4.1b"><apply id="S4.I1.i3.p1.4.m4.1.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1"><geq id="S4.I1.i3.p1.4.m4.1.1.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1.1"></geq><ci id="S4.I1.i3.p1.4.m4.1.1.2.cmml" xref="S4.I1.i3.p1.4.m4.1.1.2">𝑁</ci><ci id="S4.I1.i3.p1.4.m4.1.1.3.cmml" xref="S4.I1.i3.p1.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.4.m4.1c">N\geq K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.4.m4.1d">italic_N ≥ italic_K</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.10">Combined top <math alttext="K" class="ltx_Math" display="inline" id="S4.I1.i4.p1.1.m1.1"><semantics id="S4.I1.i4.p1.1.m1.1a"><mi id="S4.I1.i4.p1.1.m1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.1.m1.1b"><ci id="S4.I1.i4.p1.1.m1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.1.m1.1d">italic_K</annotation></semantics></math> from per embedding top <math alttext="K" class="ltx_Math" display="inline" id="S4.I1.i4.p1.2.m2.1"><semantics id="S4.I1.i4.p1.2.m2.1a"><mi id="S4.I1.i4.p1.2.m2.1.1" xref="S4.I1.i4.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.2.m2.1b"><ci id="S4.I1.i4.p1.2.m2.1.1.cmml" xref="S4.I1.i4.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.2.m2.1d">italic_K</annotation></semantics></math> and average top <math alttext="K" class="ltx_Math" display="inline" id="S4.I1.i4.p1.3.m3.1"><semantics id="S4.I1.i4.p1.3.m3.1a"><mi id="S4.I1.i4.p1.3.m3.1.1" xref="S4.I1.i4.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.3.m3.1b"><ci id="S4.I1.i4.p1.3.m3.1.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.3.m3.1d">italic_K</annotation></semantics></math> (<span class="ltx_text ltx_font_italic" id="S4.I1.i4.p1.4.1">CombTopK<math alttext="N_{1}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.4.1.m1.1"><semantics id="S4.I1.i4.p1.4.1.m1.1a"><msub id="S4.I1.i4.p1.4.1.m1.1.1" xref="S4.I1.i4.p1.4.1.m1.1.1.cmml"><mi id="S4.I1.i4.p1.4.1.m1.1.1.2" xref="S4.I1.i4.p1.4.1.m1.1.1.2.cmml">N</mi><mn id="S4.I1.i4.p1.4.1.m1.1.1.3" xref="S4.I1.i4.p1.4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.4.1.m1.1b"><apply id="S4.I1.i4.p1.4.1.m1.1.1.cmml" xref="S4.I1.i4.p1.4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.4.1.m1.1.1.1.cmml" xref="S4.I1.i4.p1.4.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.4.1.m1.1.1.2.cmml" xref="S4.I1.i4.p1.4.1.m1.1.1.2">𝑁</ci><cn id="S4.I1.i4.p1.4.1.m1.1.1.3.cmml" type="integer" xref="S4.I1.i4.p1.4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.4.1.m1.1c">N_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.4.1.m1.1d">italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></span>_<math alttext="N_{2}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.5.m4.1"><semantics id="S4.I1.i4.p1.5.m4.1a"><msub id="S4.I1.i4.p1.5.m4.1.1" xref="S4.I1.i4.p1.5.m4.1.1.cmml"><mi id="S4.I1.i4.p1.5.m4.1.1.2" xref="S4.I1.i4.p1.5.m4.1.1.2.cmml">N</mi><mn id="S4.I1.i4.p1.5.m4.1.1.3" xref="S4.I1.i4.p1.5.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.5.m4.1b"><apply id="S4.I1.i4.p1.5.m4.1.1.cmml" xref="S4.I1.i4.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.5.m4.1.1.1.cmml" xref="S4.I1.i4.p1.5.m4.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.5.m4.1.1.2.cmml" xref="S4.I1.i4.p1.5.m4.1.1.2">𝑁</ci><cn id="S4.I1.i4.p1.5.m4.1.1.3.cmml" type="integer" xref="S4.I1.i4.p1.5.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.5.m4.1c">N_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.5.m4.1d">italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>): This is described in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S3.SS2" title="3.2 Approximate algorithms ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">3.2</span></a>. <math alttext="N_{1}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.6.m5.1"><semantics id="S4.I1.i4.p1.6.m5.1a"><msub id="S4.I1.i4.p1.6.m5.1.1" xref="S4.I1.i4.p1.6.m5.1.1.cmml"><mi id="S4.I1.i4.p1.6.m5.1.1.2" xref="S4.I1.i4.p1.6.m5.1.1.2.cmml">N</mi><mn id="S4.I1.i4.p1.6.m5.1.1.3" xref="S4.I1.i4.p1.6.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.6.m5.1b"><apply id="S4.I1.i4.p1.6.m5.1.1.cmml" xref="S4.I1.i4.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.6.m5.1.1.1.cmml" xref="S4.I1.i4.p1.6.m5.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.6.m5.1.1.2.cmml" xref="S4.I1.i4.p1.6.m5.1.1.2">𝑁</ci><cn id="S4.I1.i4.p1.6.m5.1.1.3.cmml" type="integer" xref="S4.I1.i4.p1.6.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.6.m5.1c">N_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.6.m5.1d">italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> is the number of candidate items retrieved from per embedding top <math alttext="K" class="ltx_Math" display="inline" id="S4.I1.i4.p1.7.m6.1"><semantics id="S4.I1.i4.p1.7.m6.1a"><mi id="S4.I1.i4.p1.7.m6.1.1" xref="S4.I1.i4.p1.7.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.7.m6.1b"><ci id="S4.I1.i4.p1.7.m6.1.1.cmml" xref="S4.I1.i4.p1.7.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.7.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.7.m6.1d">italic_K</annotation></semantics></math> and <math alttext="N_{2}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.8.m7.1"><semantics id="S4.I1.i4.p1.8.m7.1a"><msub id="S4.I1.i4.p1.8.m7.1.1" xref="S4.I1.i4.p1.8.m7.1.1.cmml"><mi id="S4.I1.i4.p1.8.m7.1.1.2" xref="S4.I1.i4.p1.8.m7.1.1.2.cmml">N</mi><mn id="S4.I1.i4.p1.8.m7.1.1.3" xref="S4.I1.i4.p1.8.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.8.m7.1b"><apply id="S4.I1.i4.p1.8.m7.1.1.cmml" xref="S4.I1.i4.p1.8.m7.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.8.m7.1.1.1.cmml" xref="S4.I1.i4.p1.8.m7.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.8.m7.1.1.2.cmml" xref="S4.I1.i4.p1.8.m7.1.1.2">𝑁</ci><cn id="S4.I1.i4.p1.8.m7.1.1.3.cmml" type="integer" xref="S4.I1.i4.p1.8.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.8.m7.1c">N_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.8.m7.1d">italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is the number of candidate items retrieved from average top <math alttext="K" class="ltx_Math" display="inline" id="S4.I1.i4.p1.9.m8.1"><semantics id="S4.I1.i4.p1.9.m8.1a"><mi id="S4.I1.i4.p1.9.m8.1.1" xref="S4.I1.i4.p1.9.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.9.m8.1b"><ci id="S4.I1.i4.p1.9.m8.1.1.cmml" xref="S4.I1.i4.p1.9.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.9.m8.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.9.m8.1d">italic_K</annotation></semantics></math>, where <math alttext="N_{1}\times P+N_{2}\geq K" class="ltx_Math" display="inline" id="S4.I1.i4.p1.10.m9.1"><semantics id="S4.I1.i4.p1.10.m9.1a"><mrow id="S4.I1.i4.p1.10.m9.1.1" xref="S4.I1.i4.p1.10.m9.1.1.cmml"><mrow id="S4.I1.i4.p1.10.m9.1.1.2" xref="S4.I1.i4.p1.10.m9.1.1.2.cmml"><mrow id="S4.I1.i4.p1.10.m9.1.1.2.2" xref="S4.I1.i4.p1.10.m9.1.1.2.2.cmml"><msub id="S4.I1.i4.p1.10.m9.1.1.2.2.2" xref="S4.I1.i4.p1.10.m9.1.1.2.2.2.cmml"><mi id="S4.I1.i4.p1.10.m9.1.1.2.2.2.2" xref="S4.I1.i4.p1.10.m9.1.1.2.2.2.2.cmml">N</mi><mn id="S4.I1.i4.p1.10.m9.1.1.2.2.2.3" xref="S4.I1.i4.p1.10.m9.1.1.2.2.2.3.cmml">1</mn></msub><mo id="S4.I1.i4.p1.10.m9.1.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.I1.i4.p1.10.m9.1.1.2.2.1.cmml">×</mo><mi id="S4.I1.i4.p1.10.m9.1.1.2.2.3" xref="S4.I1.i4.p1.10.m9.1.1.2.2.3.cmml">P</mi></mrow><mo id="S4.I1.i4.p1.10.m9.1.1.2.1" xref="S4.I1.i4.p1.10.m9.1.1.2.1.cmml">+</mo><msub id="S4.I1.i4.p1.10.m9.1.1.2.3" xref="S4.I1.i4.p1.10.m9.1.1.2.3.cmml"><mi id="S4.I1.i4.p1.10.m9.1.1.2.3.2" xref="S4.I1.i4.p1.10.m9.1.1.2.3.2.cmml">N</mi><mn id="S4.I1.i4.p1.10.m9.1.1.2.3.3" xref="S4.I1.i4.p1.10.m9.1.1.2.3.3.cmml">2</mn></msub></mrow><mo id="S4.I1.i4.p1.10.m9.1.1.1" xref="S4.I1.i4.p1.10.m9.1.1.1.cmml">≥</mo><mi id="S4.I1.i4.p1.10.m9.1.1.3" xref="S4.I1.i4.p1.10.m9.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.10.m9.1b"><apply id="S4.I1.i4.p1.10.m9.1.1.cmml" xref="S4.I1.i4.p1.10.m9.1.1"><geq id="S4.I1.i4.p1.10.m9.1.1.1.cmml" xref="S4.I1.i4.p1.10.m9.1.1.1"></geq><apply id="S4.I1.i4.p1.10.m9.1.1.2.cmml" xref="S4.I1.i4.p1.10.m9.1.1.2"><plus id="S4.I1.i4.p1.10.m9.1.1.2.1.cmml" xref="S4.I1.i4.p1.10.m9.1.1.2.1"></plus><apply id="S4.I1.i4.p1.10.m9.1.1.2.2.cmml" xref="S4.I1.i4.p1.10.m9.1.1.2.2"><times id="S4.I1.i4.p1.10.m9.1.1.2.2.1.cmml" xref="S4.I1.i4.p1.10.m9.1.1.2.2.1"></times><apply id="S4.I1.i4.p1.10.m9.1.1.2.2.2.cmml" xref="S4.I1.i4.p1.10.m9.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.I1.i4.p1.10.m9.1.1.2.2.2.1.cmml" xref="S4.I1.i4.p1.10.m9.1.1.2.2.2">subscript</csymbol><ci id="S4.I1.i4.p1.10.m9.1.1.2.2.2.2.cmml" xref="S4.I1.i4.p1.10.m9.1.1.2.2.2.2">𝑁</ci><cn id="S4.I1.i4.p1.10.m9.1.1.2.2.2.3.cmml" type="integer" xref="S4.I1.i4.p1.10.m9.1.1.2.2.2.3">1</cn></apply><ci id="S4.I1.i4.p1.10.m9.1.1.2.2.3.cmml" xref="S4.I1.i4.p1.10.m9.1.1.2.2.3">𝑃</ci></apply><apply id="S4.I1.i4.p1.10.m9.1.1.2.3.cmml" xref="S4.I1.i4.p1.10.m9.1.1.2.3"><csymbol cd="ambiguous" id="S4.I1.i4.p1.10.m9.1.1.2.3.1.cmml" xref="S4.I1.i4.p1.10.m9.1.1.2.3">subscript</csymbol><ci id="S4.I1.i4.p1.10.m9.1.1.2.3.2.cmml" xref="S4.I1.i4.p1.10.m9.1.1.2.3.2">𝑁</ci><cn id="S4.I1.i4.p1.10.m9.1.1.2.3.3.cmml" type="integer" xref="S4.I1.i4.p1.10.m9.1.1.2.3.3">2</cn></apply></apply><ci id="S4.I1.i4.p1.10.m9.1.1.3.cmml" xref="S4.I1.i4.p1.10.m9.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.10.m9.1c">N_{1}\times P+N_{2}\geq K</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.10.m9.1d">italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × italic_P + italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ≥ italic_K</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.2">Table <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.T4" title="Table 4 ‣ 4.2 Top 𝐾 retrieval performance ‣ 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">4</span></a> shows the hit rate (HR) and latency of all the methods. The hit rate is normalized by the ground truth, i.e., the hit rate achieved with brute-force top <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_K</annotation></semantics></math>. We measure latency by evaluating a batch of retrieval queries, in order to achieve high accelerator utilization; this is consistent with prior work on GPU/TPU-based retrieval algorithms <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite>. We set batch size to <math alttext="32" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mn id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><cn id="S4.SS2.p2.2.m2.1.1.cmml" type="integer" xref="S4.SS2.p2.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">32</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">32</annotation></semantics></math> for <span class="ltx_text ltx_font_italic" id="S4.SS2.p2.2.1">ML-1M</span>, <span class="ltx_text ltx_font_italic" id="S4.SS2.p2.2.2">ML-20M</span>, and <span class="ltx_text ltx_font_italic" id="S4.SS2.p2.2.3">Books</span>. We perform evaluation on a single NVIDIA RTX 6000 Ada GPU. We report latency averaged over 20 warm runs.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.3">We observe that our approximate heuristics achieve high HR with oversampling. For example, <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.1">TopKAvg</span>500 is <math alttext="&gt;.99" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml"></mi><mo id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">.99</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><gt id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">absent</csymbol><cn id="S4.SS2.p3.1.m1.1.1.3.cmml" type="float" xref="S4.SS2.p3.1.m1.1.1.3">.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">&gt;.99</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">&gt; .99</annotation></semantics></math> in relative HR across the board for <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.2">ML-1M</span> and <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.3">ML-20M</span>, and <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.4">TopKAvg</span>4000 is <math alttext="&gt;.99" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml"></mi><mo id="S4.SS2.p3.2.m2.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">.99</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><gt id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1"></gt><csymbol cd="latexml" id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">absent</csymbol><cn id="S4.SS2.p3.2.m2.1.1.3.cmml" type="float" xref="S4.SS2.p3.2.m2.1.1.3">.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">&gt;.99</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">&gt; .99</annotation></semantics></math> in relative HR across the board for <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.5">Books</span>. In addition, the combined top <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">italic_K</annotation></semantics></math> algorithm can outperform both <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.6">TopKPerEmbd</span> and <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.7">TopKAvg</span> of the corresponding configurations, sometimes significantly, e.g., <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.8">CombTopK</span>5_200 vs. <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.9">TopKPerEmbd</span>5 and <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.10">TopKAvg</span>200 on <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.11">Books</span>. This indicates that the set of candidate items retrieved by each individual approximate algorithm indeed complements each other when the weight distributions vary in <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.12">MoL</span>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.6">In terms of efficiency, we observe that our approximate heuristics are significantly lower in latency than the exact baseline, especially as the number of items in the dataset becomes large. For example, compared to <span class="ltx_text ltx_font_italic" id="S4.SS2.p4.6.1">BruteForce</span>, <span class="ltx_text ltx_font_italic" id="S4.SS2.p4.6.2">TopKAvg</span> achieves <math alttext="&gt;.99" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mrow id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml"></mi><mo id="S4.SS2.p4.1.m1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">.99</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><gt id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">absent</csymbol><cn id="S4.SS2.p4.1.m1.1.1.3.cmml" type="float" xref="S4.SS2.p4.1.m1.1.1.3">.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">&gt;.99</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">&gt; .99</annotation></semantics></math> relative HR@100 with a speedup of <math alttext="4\times" class="ltx_math_unparsed" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1b"><mn id="S4.SS2.p4.2.m2.1.1">4</mn><mo id="S4.SS2.p4.2.m2.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">4\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">4 ×</annotation></semantics></math> and <math alttext="91\times" class="ltx_math_unparsed" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mrow id="S4.SS2.p4.3.m3.1b"><mn id="S4.SS2.p4.3.m3.1.1">91</mn><mo id="S4.SS2.p4.3.m3.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">91\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">91 ×</annotation></semantics></math> in latency for <span class="ltx_text ltx_font_italic" id="S4.SS2.p4.6.3">ML-20M</span> and <span class="ltx_text ltx_font_italic" id="S4.SS2.p4.6.4">Books</span>, respectively. While the latency of the retrieval grows with the size of the dataset in the brute-force baseline, it grows much slower with the approximate methods. For example, the latency of retrieval increases by <math alttext="4.8\times" class="ltx_math_unparsed" display="inline" id="S4.SS2.p4.4.m4.1"><semantics id="S4.SS2.p4.4.m4.1a"><mrow id="S4.SS2.p4.4.m4.1b"><mn id="S4.SS2.p4.4.m4.1.1">4.8</mn><mo id="S4.SS2.p4.4.m4.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">4.8\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.4.m4.1d">4.8 ×</annotation></semantics></math> from <span class="ltx_text ltx_font_italic" id="S4.SS2.p4.6.5">ML-1M</span> to <span class="ltx_text ltx_font_italic" id="S4.SS2.p4.6.6">ML-20M</span> in <span class="ltx_text ltx_font_italic" id="S4.SS2.p4.6.7">BruteForce</span>, while the growth rate is <math alttext="1.8\times" class="ltx_math_unparsed" display="inline" id="S4.SS2.p4.5.m5.1"><semantics id="S4.SS2.p4.5.m5.1a"><mrow id="S4.SS2.p4.5.m5.1b"><mn id="S4.SS2.p4.5.m5.1.1">1.8</mn><mo id="S4.SS2.p4.5.m5.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">1.8\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.5.m5.1d">1.8 ×</annotation></semantics></math> and <math alttext="1.1\times" class="ltx_math_unparsed" display="inline" id="S4.SS2.p4.6.m6.1"><semantics id="S4.SS2.p4.6.m6.1a"><mrow id="S4.SS2.p4.6.m6.1b"><mn id="S4.SS2.p4.6.m6.1.1">1.1</mn><mo id="S4.SS2.p4.6.m6.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">1.1\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.6.m6.1d">1.1 ×</annotation></semantics></math> for <span class="ltx_text ltx_font_italic" id="S4.SS2.p4.6.8">TopKPerEmbd</span>100 and <span class="ltx_text ltx_font_italic" id="S4.SS2.p4.6.9">TopKAvg</span>1000 respectively. Thus, we expect that the speedup of the approximate methods to become even more prominent as the size of the dataset further increases.</p>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.3">We also notice that <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.1">TopKAvg</span> tends to be more efficient than <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.2">TopKPerEmbd</span> with comparable HR, e.g., <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.3">TopKAvg</span>2000 vs. <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.4">TopKPerEmbd</span>100 on <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.5">Books</span> with <math alttext="22\times" class="ltx_math_unparsed" display="inline" id="S4.SS2.p5.1.m1.1"><semantics id="S4.SS2.p5.1.m1.1a"><mrow id="S4.SS2.p5.1.m1.1b"><mn id="S4.SS2.p5.1.m1.1.1">22</mn><mo id="S4.SS2.p5.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">22\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.1d">22 ×</annotation></semantics></math> speedup in latency. We believe that this is mainly due to two reasons. First, when the HR is comparable, the maximal number of candidate items from <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.6">TopKPerEmbd</span> is larger than that of <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.7">TopKAvg</span>. Second, compared to <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.8">TopKPerEmbd</span>, the computation of <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.9">TopKAvg</span> is agnostic to the number of embedding sets because of the materialization optimization described in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S3.SS2" title="3.2 Approximate algorithms ‣ 3 Retrieval Algorithms ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">3.2</span></a>. Interestingly, we also see that the combined top <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1"><semantics id="S4.SS2.p5.2.m2.1a"><mi id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><ci id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.2.m2.1d">italic_K</annotation></semantics></math> is more efficient than the summation of the latency of its individual components, e.g., <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.10">CombTopK</span>5_200 is <math alttext="1.5\times" class="ltx_math_unparsed" display="inline" id="S4.SS2.p5.3.m3.1"><semantics id="S4.SS2.p5.3.m3.1a"><mrow id="S4.SS2.p5.3.m3.1b"><mn id="S4.SS2.p5.3.m3.1.1">1.5</mn><mo id="S4.SS2.p5.3.m3.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">1.5\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.3.m3.1d">1.5 ×</annotation></semantics></math> faster than the sum of the latency from <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.11">TopKPerEmbd</span>5 and <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.12">TopKAvg</span>200 on <span class="ltx_text ltx_font_italic" id="S4.SS2.p5.3.13">ML-20M</span>. This is because our implementation reduces the overhead of the combined method by consolidating some shared processing of the two components.</p>
</div>
<div class="ltx_para" id="S4.SS2.p6">
<p class="ltx_p" id="S4.SS2.p6.1">Overall, empirically <span class="ltx_text ltx_font_italic" id="S4.SS2.p6.1.1">TopKAvg</span> strikes a good balance between high HR and low latency, and the combined top <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p6.1.m1.1"><semantics id="S4.SS2.p6.1.m1.1a"><mi id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><ci id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p6.1.m1.1d">italic_K</annotation></semantics></math> can be used if the target HR is extremely stringent.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related work</h2>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Similarity Functions in Retrieval.</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px1.p1.1">Most information retrieval models in recommendations and natural language processing follow a classical two-stage paradigm <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib5" title="">5</a>]</cite>, where up to billions of items <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite> are first filtered down to hundreds in the <span class="ltx_text ltx_font_italic" id="S5.SS0.SSS0.Px1.p1.1.1">retrieval</span> stage, followed by the <span class="ltx_text ltx_font_italic" id="S5.SS0.SSS0.Px1.p1.1.2">ranking</span> stage that produces the final top 1-10 candidates. Earlier work on large-scale neural retrieval models primarily utilize dual-encoder (dense retrieval, etc.) setups, with dot products as the similarity function <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib21" title="">21</a>]</cite>. Researchers quickly realized that dot products limited retrieval stage’s performance, and explored various learned similarity-based approaches. Prominent variants include maximum similarity based on multiple embeddings <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib34" title="">34</a>]</cite>, specialized neural networks, often based on Hadamard products <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite>, and representing item ids as token sequences (“learned index structures”), either implicitly defined during tree traversal <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib46" title="">46</a>]</cite> or explicitly in the “generative retrieval” setups <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib36" title="">36</a>]</cite>. It has been shown, however, that learned neural distances often fail to outperform dot products, e.g., Hadamard MLPs in recommendations <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib33" title="">33</a>]</cite> and DSI in NLP <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib36" title="">36</a>]</cite>. Learned index structures further introduce stability and latency challenges as both NLP and recommendation systems need to support billion-scale realtime updated set of items <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite>. Despite these challenges, significant gains (17% gains at Hit Rate@100 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite> to 24% gains at Hit Rate@400 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite>) with learned similarities have been reported in recent years; these can be attributed to careful construction of learned similarity functions <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite>, implicit diversification done as part of beam search <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib36" title="">36</a>]</cite>, explicit representation of side-information using special neural architectures <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite>, and hardware-aware similarity function and inference algorithm design on GPUs <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Efficient Nearest Neighbor Search (NNS).</h4>
<div class="ltx_para" id="S5.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px2.p1.1">Nearest neighbor search has been a popular topic of research due to their critical role in large-scale retrieval and vector databases. Most studies focus on the dot product case, also known as Maximum Inner Product Search (MIPS). Various techniques were proposed and analyzed, including tree structures <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib32" title="">32</a>]</cite>, locality sensitive hashing <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib35" title="">35</a>]</cite>, production quantization <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib11" title="">11</a>]</cite>, data partitioning <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib44" title="">44</a>]</cite>,
graph-based methods <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib17" title="">17</a>]</cite>, and so on. The general case for NNS utilizing learned similarities remains less studied; for learned index structures, techniques to construct trees have been proposed to ensure beam search result in globally optimal top-<math alttext="K" class="ltx_Math" display="inline" id="S5.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S5.SS0.SSS0.Px2.p1.1.m1.1a"><mi id="S5.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.1.m1.1b"><ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS0.SSS0.Px2.p1.1.m1.1d">italic_K</annotation></semantics></math> results <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib46" title="">46</a>]</cite>. Algorithms based on implicit <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib31" title="">31</a>]</cite> or explicit graphs <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib39" title="">39</a>]</cite> have been proposed to obtain a tractable candidate set in multi-stage retrieval setups; however, such approaches’ performance can degrade when the similarity function is not a metric, and constructing appropriate graph indices for non-metric similarity functions can remain challenging even for the inner product case <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib30" title="">30</a>]</cite>. Due to GPUs and other accelerators having orders of magnitude higher arithmetic intensity vs CPUs, traditional quantization techniques <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib11" title="">11</a>]</cite> no longer fully utilize GPUs; accelerator-specific nearest neighbor algorithms that benefit from increased compute have been proposed and analyzed in recent work <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.3">We have analyzed techniques for efficient retrieval with learned similarities in this work. We begin by showing Mixture-of-Logits (<span class="ltx_text ltx_font_italic" id="S6.p1.3.1">MoL</span>) is a universal approximator of learned similarity functions, and further empirically learnable – <span class="ltx_text ltx_font_italic" id="S6.p1.3.2">MoL</span> consistently outperforms dot products in HR across 6 scenarios by an average of 24.2% in HR@1 and 14.3% in HR@10, setting new state-of-the-art on recommendation datasets. We next propose both exact and approximate algorithms to enable efficient retrieval using learned similarity functions, and show their correctness and bounds. Across all datasets evaluated, we demonstrate that our approximate top <math alttext="K" class="ltx_Math" display="inline" id="S6.p1.1.m1.1"><semantics id="S6.p1.1.m1.1a"><mi id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><ci id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S6.p1.1.m1.1d">italic_K</annotation></semantics></math> algorithms can reach <math alttext=".99" class="ltx_Math" display="inline" id="S6.p1.2.m2.1"><semantics id="S6.p1.2.m2.1a"><mn id="S6.p1.2.m2.1.1" xref="S6.p1.2.m2.1.1.cmml">.99</mn><annotation-xml encoding="MathML-Content" id="S6.p1.2.m2.1b"><cn id="S6.p1.2.m2.1.1.cmml" type="float" xref="S6.p1.2.m2.1.1">.99</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.2.m2.1c">.99</annotation><annotation encoding="application/x-llamapun" id="S6.p1.2.m2.1d">.99</annotation></semantics></math> of Hit Rate relative to exact algorithms, while achieving up to <math alttext="91\times" class="ltx_math_unparsed" display="inline" id="S6.p1.3.m3.1"><semantics id="S6.p1.3.m3.1a"><mrow id="S6.p1.3.m3.1b"><mn id="S6.p1.3.m3.1.1">91</mn><mo id="S6.p1.3.m3.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S6.p1.3.m3.1c">91\times</annotation><annotation encoding="application/x-llamapun" id="S6.p1.3.m3.1d">91 ×</annotation></semantics></math> reduction in end-to-end latency and with minimal indexing overheads. We expect the speedups to be further amplified with larger-scale datasets and GPU kernel optimizations. Given MoL’s empirical impressive performance gains of 20%-30% across Hit Rate@50-400 over hundreds of millions to billions of items <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite>, our work concludes both theoretical and practical justifications for migrating vector databases away from dense retrieval and MIPS to Retriev<span class="ltx_text ltx_framed ltx_framed_underline" id="S6.p1.3.3">a</span>l w<span class="ltx_text ltx_framed ltx_framed_underline" id="S6.p1.3.4">i</span>th Learned Similarities (RAILS) on GPUs.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Limitations</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.7">While we have performed evaluations on top of one of the largest recommendation datasets publicly available with 674,044 items, we expect potentially different algorithmic behaviors as we scale our approximate top-<math alttext="K" class="ltx_Math" display="inline" id="Sx1.p1.1.m1.1"><semantics id="Sx1.p1.1.m1.1a"><mi id="Sx1.p1.1.m1.1.1" xref="Sx1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx1.p1.1.m1.1b"><ci id="Sx1.p1.1.m1.1.1.cmml" xref="Sx1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="Sx1.p1.1.m1.1d">italic_K</annotation></semantics></math> algorithms to handle hundreds to millions to billions of items. Additional low-level GPU kernel optimizations, one of which being an efficient grouped top-<math alttext="K" class="ltx_Math" display="inline" id="Sx1.p1.2.m2.1"><semantics id="Sx1.p1.2.m2.1a"><mi id="Sx1.p1.2.m2.1.1" xref="Sx1.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx1.p1.2.m2.1b"><ci id="Sx1.p1.2.m2.1.1.cmml" xref="Sx1.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="Sx1.p1.2.m2.1d">italic_K</annotation></semantics></math> query kernel that fetches top-<math alttext="K" class="ltx_Math" display="inline" id="Sx1.p1.3.m3.1"><semantics id="Sx1.p1.3.m3.1a"><mi id="Sx1.p1.3.m3.1.1" xref="Sx1.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx1.p1.3.m3.1b"><ci id="Sx1.p1.3.m3.1.1.cmml" xref="Sx1.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="Sx1.p1.3.m3.1d">italic_K</annotation></semantics></math> for multiple query embeddings (e.g., <math alttext="f_{1}(q),\ldots,f_{P_{q}}(q)" class="ltx_Math" display="inline" id="Sx1.p1.4.m4.5"><semantics id="Sx1.p1.4.m4.5a"><mrow id="Sx1.p1.4.m4.5.5.2" xref="Sx1.p1.4.m4.5.5.3.cmml"><mrow id="Sx1.p1.4.m4.4.4.1.1" xref="Sx1.p1.4.m4.4.4.1.1.cmml"><msub id="Sx1.p1.4.m4.4.4.1.1.2" xref="Sx1.p1.4.m4.4.4.1.1.2.cmml"><mi id="Sx1.p1.4.m4.4.4.1.1.2.2" xref="Sx1.p1.4.m4.4.4.1.1.2.2.cmml">f</mi><mn id="Sx1.p1.4.m4.4.4.1.1.2.3" xref="Sx1.p1.4.m4.4.4.1.1.2.3.cmml">1</mn></msub><mo id="Sx1.p1.4.m4.4.4.1.1.1" xref="Sx1.p1.4.m4.4.4.1.1.1.cmml">⁢</mo><mrow id="Sx1.p1.4.m4.4.4.1.1.3.2" xref="Sx1.p1.4.m4.4.4.1.1.cmml"><mo id="Sx1.p1.4.m4.4.4.1.1.3.2.1" stretchy="false" xref="Sx1.p1.4.m4.4.4.1.1.cmml">(</mo><mi id="Sx1.p1.4.m4.1.1" xref="Sx1.p1.4.m4.1.1.cmml">q</mi><mo id="Sx1.p1.4.m4.4.4.1.1.3.2.2" stretchy="false" xref="Sx1.p1.4.m4.4.4.1.1.cmml">)</mo></mrow></mrow><mo id="Sx1.p1.4.m4.5.5.2.3" xref="Sx1.p1.4.m4.5.5.3.cmml">,</mo><mi id="Sx1.p1.4.m4.3.3" mathvariant="normal" xref="Sx1.p1.4.m4.3.3.cmml">…</mi><mo id="Sx1.p1.4.m4.5.5.2.4" xref="Sx1.p1.4.m4.5.5.3.cmml">,</mo><mrow id="Sx1.p1.4.m4.5.5.2.2" xref="Sx1.p1.4.m4.5.5.2.2.cmml"><msub id="Sx1.p1.4.m4.5.5.2.2.2" xref="Sx1.p1.4.m4.5.5.2.2.2.cmml"><mi id="Sx1.p1.4.m4.5.5.2.2.2.2" xref="Sx1.p1.4.m4.5.5.2.2.2.2.cmml">f</mi><msub id="Sx1.p1.4.m4.5.5.2.2.2.3" xref="Sx1.p1.4.m4.5.5.2.2.2.3.cmml"><mi id="Sx1.p1.4.m4.5.5.2.2.2.3.2" xref="Sx1.p1.4.m4.5.5.2.2.2.3.2.cmml">P</mi><mi id="Sx1.p1.4.m4.5.5.2.2.2.3.3" xref="Sx1.p1.4.m4.5.5.2.2.2.3.3.cmml">q</mi></msub></msub><mo id="Sx1.p1.4.m4.5.5.2.2.1" xref="Sx1.p1.4.m4.5.5.2.2.1.cmml">⁢</mo><mrow id="Sx1.p1.4.m4.5.5.2.2.3.2" xref="Sx1.p1.4.m4.5.5.2.2.cmml"><mo id="Sx1.p1.4.m4.5.5.2.2.3.2.1" stretchy="false" xref="Sx1.p1.4.m4.5.5.2.2.cmml">(</mo><mi id="Sx1.p1.4.m4.2.2" xref="Sx1.p1.4.m4.2.2.cmml">q</mi><mo id="Sx1.p1.4.m4.5.5.2.2.3.2.2" stretchy="false" xref="Sx1.p1.4.m4.5.5.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx1.p1.4.m4.5b"><list id="Sx1.p1.4.m4.5.5.3.cmml" xref="Sx1.p1.4.m4.5.5.2"><apply id="Sx1.p1.4.m4.4.4.1.1.cmml" xref="Sx1.p1.4.m4.4.4.1.1"><times id="Sx1.p1.4.m4.4.4.1.1.1.cmml" xref="Sx1.p1.4.m4.4.4.1.1.1"></times><apply id="Sx1.p1.4.m4.4.4.1.1.2.cmml" xref="Sx1.p1.4.m4.4.4.1.1.2"><csymbol cd="ambiguous" id="Sx1.p1.4.m4.4.4.1.1.2.1.cmml" xref="Sx1.p1.4.m4.4.4.1.1.2">subscript</csymbol><ci id="Sx1.p1.4.m4.4.4.1.1.2.2.cmml" xref="Sx1.p1.4.m4.4.4.1.1.2.2">𝑓</ci><cn id="Sx1.p1.4.m4.4.4.1.1.2.3.cmml" type="integer" xref="Sx1.p1.4.m4.4.4.1.1.2.3">1</cn></apply><ci id="Sx1.p1.4.m4.1.1.cmml" xref="Sx1.p1.4.m4.1.1">𝑞</ci></apply><ci id="Sx1.p1.4.m4.3.3.cmml" xref="Sx1.p1.4.m4.3.3">…</ci><apply id="Sx1.p1.4.m4.5.5.2.2.cmml" xref="Sx1.p1.4.m4.5.5.2.2"><times id="Sx1.p1.4.m4.5.5.2.2.1.cmml" xref="Sx1.p1.4.m4.5.5.2.2.1"></times><apply id="Sx1.p1.4.m4.5.5.2.2.2.cmml" xref="Sx1.p1.4.m4.5.5.2.2.2"><csymbol cd="ambiguous" id="Sx1.p1.4.m4.5.5.2.2.2.1.cmml" xref="Sx1.p1.4.m4.5.5.2.2.2">subscript</csymbol><ci id="Sx1.p1.4.m4.5.5.2.2.2.2.cmml" xref="Sx1.p1.4.m4.5.5.2.2.2.2">𝑓</ci><apply id="Sx1.p1.4.m4.5.5.2.2.2.3.cmml" xref="Sx1.p1.4.m4.5.5.2.2.2.3"><csymbol cd="ambiguous" id="Sx1.p1.4.m4.5.5.2.2.2.3.1.cmml" xref="Sx1.p1.4.m4.5.5.2.2.2.3">subscript</csymbol><ci id="Sx1.p1.4.m4.5.5.2.2.2.3.2.cmml" xref="Sx1.p1.4.m4.5.5.2.2.2.3.2">𝑃</ci><ci id="Sx1.p1.4.m4.5.5.2.2.2.3.3.cmml" xref="Sx1.p1.4.m4.5.5.2.2.2.3.3">𝑞</ci></apply></apply><ci id="Sx1.p1.4.m4.2.2.cmml" xref="Sx1.p1.4.m4.2.2">𝑞</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.4.m4.5c">f_{1}(q),\ldots,f_{P_{q}}(q)</annotation><annotation encoding="application/x-llamapun" id="Sx1.p1.4.m4.5d">italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_q ) , … , italic_f start_POSTSUBSCRIPT italic_P start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math>), could also change the relative efficiency of approximate methods we discussed, in particular <span class="ltx_text ltx_font_italic" id="Sx1.p1.7.2">TopKAvg</span>(<math alttext="N" class="ltx_Math" display="inline" id="Sx1.p1.5.m5.1"><semantics id="Sx1.p1.5.m5.1a"><mi id="Sx1.p1.5.m5.1.1" xref="Sx1.p1.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="Sx1.p1.5.m5.1b"><ci id="Sx1.p1.5.m5.1.1.cmml" xref="Sx1.p1.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="Sx1.p1.5.m5.1d">italic_N</annotation></semantics></math>) and <span class="ltx_text ltx_font_italic" id="Sx1.p1.6.1">CombTopK<math alttext="N_{1}" class="ltx_Math" display="inline" id="Sx1.p1.6.1.m1.1"><semantics id="Sx1.p1.6.1.m1.1a"><msub id="Sx1.p1.6.1.m1.1.1" xref="Sx1.p1.6.1.m1.1.1.cmml"><mi id="Sx1.p1.6.1.m1.1.1.2" xref="Sx1.p1.6.1.m1.1.1.2.cmml">N</mi><mn id="Sx1.p1.6.1.m1.1.1.3" xref="Sx1.p1.6.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx1.p1.6.1.m1.1b"><apply id="Sx1.p1.6.1.m1.1.1.cmml" xref="Sx1.p1.6.1.m1.1.1"><csymbol cd="ambiguous" id="Sx1.p1.6.1.m1.1.1.1.cmml" xref="Sx1.p1.6.1.m1.1.1">subscript</csymbol><ci id="Sx1.p1.6.1.m1.1.1.2.cmml" xref="Sx1.p1.6.1.m1.1.1.2">𝑁</ci><cn id="Sx1.p1.6.1.m1.1.1.3.cmml" type="integer" xref="Sx1.p1.6.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.6.1.m1.1c">N_{1}</annotation><annotation encoding="application/x-llamapun" id="Sx1.p1.6.1.m1.1d">italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></span>_<math alttext="N_{2}" class="ltx_Math" display="inline" id="Sx1.p1.7.m6.1"><semantics id="Sx1.p1.7.m6.1a"><msub id="Sx1.p1.7.m6.1.1" xref="Sx1.p1.7.m6.1.1.cmml"><mi id="Sx1.p1.7.m6.1.1.2" xref="Sx1.p1.7.m6.1.1.2.cmml">N</mi><mn id="Sx1.p1.7.m6.1.1.3" xref="Sx1.p1.7.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="Sx1.p1.7.m6.1b"><apply id="Sx1.p1.7.m6.1.1.cmml" xref="Sx1.p1.7.m6.1.1"><csymbol cd="ambiguous" id="Sx1.p1.7.m6.1.1.1.cmml" xref="Sx1.p1.7.m6.1.1">subscript</csymbol><ci id="Sx1.p1.7.m6.1.1.2.cmml" xref="Sx1.p1.7.m6.1.1.2">𝑁</ci><cn id="Sx1.p1.7.m6.1.1.3.cmml" type="integer" xref="Sx1.p1.7.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p1.7.m6.1c">N_{2}</annotation><annotation encoding="application/x-llamapun" id="Sx1.p1.7.m6.1d">italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. We also leave more efficient implementations of the two-pass exact algorithm as future work.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Jon Louis Bentley.

</span>
<span class="ltx_bibblock">Multidimensional binary search trees used for associative searching.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Commun. ACM</span>, 18(9):509–517, sep 1975.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Sebastian Borgeaud, Arthur Mensch, Jordan Hoffmann, Trevor Cai, Eliza Rutherford, Katie Millican, George van den Driessche, Jean-Baptiste Lespiau, Bogdan Damoc, Aidan Clark, Diego de Las Casas, Aurelia Guy, Jacob Menick, Roman Ring, Tom Hennigan, Saffron Huang, Loren Maggiore, Chris Jones, Albin Cassirer, Andy Brock, Michela Paganini, Geoffrey Irving, Oriol Vinyals, Simon Osindero, Karen Simonyan, Jack W. Rae, Erich Elsen, and Laurent Sifre.

</span>
<span class="ltx_bibblock">Improving language models by retrieving from trillions of tokens.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri, Stefanie Jegelka, Le Song, Csaba Szepesvári, Gang Niu, and Sivan Sabato, editors, <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">International Conference on Machine Learning, ICML 2022, 17-23 July 2022, Baltimore, Maryland, USA</span>, volume 162 of <span class="ltx_text ltx_font_italic" id="bib.bib2.2.2">Proceedings of Machine Learning Research</span>, pages 2206–2240. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Fedor Borisyuk, Qingquan Song, Mingzhou Zhou, Ganesh Parameswaran, Madhu Arun, Siva Popuri, Tugrul Bingol, Zhuotao Pei, Kuang-Hsuan Lee, Lu Zheng, Qizhan Shao, Ali Naqvi, Sen Zhou, and Aman Gupta.

</span>
<span class="ltx_bibblock">Linr: Model based neural retrieval on gpus at linkedin, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Felix Chern, Blake Hechtman, Andy Davis, Ruiqi Guo, David Majnemer, and Sanjiv Kumar.

</span>
<span class="ltx_bibblock">TPU-KNN: K nearest neighbor search at peak FLOP/s.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">Advances in Neural Information Processing Systems</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Paul Covington, Jay Adams, and Emre Sargin.

</span>
<span class="ltx_bibblock">Deep neural networks for youtube recommendations.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 10th ACM Conference on Recommender Systems</span>, RecSys ’16, page 191–198, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Chantat Eksombatchai, Pranav Jindal, Jerry Zitao Liu, Yuchen Liu, Rahul Sharma, Charles Sugnet, Mark Ulrich, and Jure Leskovec.

</span>
<span class="ltx_bibblock">Pixie: A system for recommending 3+ billion items to 200+ million users in real-time.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 2018 World Wide Web Conference</span>, WWW ’18, page 1775–1784, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Stefan Elfwing, Eiji Uchibe, and Kenji Doya.

</span>
<span class="ltx_bibblock">Sigmoid-weighted linear units for neural network function approximation in reinforcement learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">CoRR</span>, abs/1702.03118, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Weihao Gao, Xiangjun Fan, Chong Wang, Jiankai Sun, Kai Jia, Wenzi Xiao, Ruofan Ding, Xingyan Bin, Hui Yang, and Xiaobing Liu.

</span>
<span class="ltx_bibblock">Learning an end-to-end structure for retrieval in large-scale recommendations.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 30th ACM International Conference on Information and Knowledge Management</span>, CIKM ’21, page 524–533, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Daniel Gillick, Alessandro Presta, and Gaurav Singh Tomar.

</span>
<span class="ltx_bibblock">End-to-end retrieval in continuous space, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Aristides Gionis, Piotr Indyk, and Rajeev Motwani.

</span>
<span class="ltx_bibblock">Similarity search in high dimensions via hashing.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Proceedings of the 25th International Conference on Very Large Data Bases</span>, VLDB ’99, page 518–529, San Francisco, CA, USA, 1999. Morgan Kaufmann Publishers Inc.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Ruiqi Guo, Sanjiv Kumar, Krzysztof Choromanski, and David Simcha.

</span>
<span class="ltx_bibblock">Quantization based fast inner product search.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">Proceedings of the 19th International Conference on Artificial Intelligence and Statistics, AISTATS 2016</span>, volume 51, pages 482–490, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Ruiqi Guo, Philip Sun, Erik Lindgren, Quan Geng, David Simcha, Felix Chern, and Sanjiv Kumar.

</span>
<span class="ltx_bibblock">Accelerating large-scale inference with anisotropic vector quantization.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 37th International Conference on Machine Learning</span>, ICML’20. JMLR.org, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
F. Maxwell Harper and Joseph A. Konstan.

</span>
<span class="ltx_bibblock">The movielens datasets: History and context.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">ACM Trans. Interact. Intell. Syst.</span>, 5(4), dec 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Xiangnan He, Lizi Liao, Hanwang Zhang, Liqiang Nie, Xia Hu, and Tat-Seng Chua.

</span>
<span class="ltx_bibblock">Neural collaborative filtering.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 26th International Conference on World Wide Web</span>, WWW ’17, page 173–182, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk.

</span>
<span class="ltx_bibblock">Session-based recommendations with recurrent neural networks.

</span>
<span class="ltx_bibblock">In Yoshua Bengio and Yann LeCun, editors, <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">4th International Conference on Learning Representations, ICLR 2016, San Juan, Puerto Rico, May 2-4, 2016, Conference Track Proceedings</span>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Kalina Jasinska, Krzysztof Dembczynski, Robert Busa-Fekete, Karlson Pfannschmidt, Timo Klerx, and Eyke Hullermeier.

</span>
<span class="ltx_bibblock">Extreme f-measure maximization using sparse probability estimates.

</span>
<span class="ltx_bibblock">In Maria Florina Balcan and Kilian Q. Weinberger, editors, <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">Proceedings of The 33rd International Conference on Machine Learning</span>, volume 48 of <span class="ltx_text ltx_font_italic" id="bib.bib16.2.2">Proceedings of Machine Learning Research</span>, pages 1435–1444, New York, New York, USA, 20–22 Jun 2016. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Suhas Jayaram Subramanya, Fnu Devvrit, Harsha Vardhan Simhadri, Ravishankar Krishnawamy, and Rohan Kadekodi.

</span>
<span class="ltx_bibblock">Diskann: Fast accurate billion-point nearest neighbor search on a single node.

</span>
<span class="ltx_bibblock">In H. Wallach, H. Larochelle, A. Beygelzimer, F. d'Alché-Buc, E. Fox, and R. Garnett, editors, <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">Advances in Neural Information Processing Systems</span>, volume 32. Curran Associates, Inc., 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Herve Jegou, Matthijs Douze, and Cordelia Schmid.

</span>
<span class="ltx_bibblock">Product quantization for nearest neighbor search.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">IEEE Trans. Pattern Anal. Mach. Intell.</span>, 33(1):117–128, jan 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
J. Johnson, M. Douze, and H. Jegou.

</span>
<span class="ltx_bibblock">Billion-scale similarity search with gpus.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">IEEE Transactions on Big Data</span>, 7(03):535–547, Jul 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian McAuley.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">2018 International Conference on Data Mining (ICDM)</span>, pages 197–206, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Vladimir Karpukhin, Barlas Oguz, Sewon Min, Patrick Lewis, Ledell Wu, Sergey Edunov, Danqi Chen, and Wen-tau Yih.

</span>
<span class="ltx_bibblock">Dense passage retrieval for open-domain question answering.

</span>
<span class="ltx_bibblock">In Bonnie Webber, Trevor Cohn, Yulan He, and Yang Liu, editors, <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing (EMNLP)</span>, pages 6769–6781, Online, November 2020. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Omar Khattab and Matei Zaharia.

</span>
<span class="ltx_bibblock">Colbert: Efficient and effective passage search via contextualized late interaction over bert.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval</span>, SIGIR ’20, page 39–48, New York, NY, USA, 2020. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Anton Klenitskiy and Alexey Vasilev.

</span>
<span class="ltx_bibblock">Turning dross into gold loss: is bert4rec really better than sasrec?

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">Proceedings of the 17th ACM Conference on Recommender Systems</span>, RecSys ’23, page 1120–1125, New York, NY, USA, 2023. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Yehuda Koren, Robert Bell, and Chris Volinsky.

</span>
<span class="ltx_bibblock">Matrix factorization techniques for recommender systems.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">Computer</span>, 42(8):30–37, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim Rocktäschel, Sebastian Riedel, and Douwe Kiela.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for knowledge-intensive nlp tasks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">Proceedings of the 34th International Conference on Neural Information Processing Systems</span>, NIPS ’20, Red Hook, NY, USA, 2020. Curran Associates Inc.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Chao Li, Zhiyuan Liu, Mengmeng Wu, Yuchi Xu, Huan Zhao, Pipei Huang, Guoliang Kang, Qiwei Chen, Wei Li, and Dik Lun Lee.

</span>
<span class="ltx_bibblock">Multi-interest network with dynamic routing for recommendation at tmall.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 28th ACM International Conference on Information and Knowledge Management</span>, CIKM ’19, page 2615–2623, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Chen Li, E. Chang, H. Garcia-Molina, and G. Wiederhold.

</span>
<span class="ltx_bibblock">Clustering for approximate similarity search in high-dimensional spaces.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">IEEE Transactions on Knowledge and Data Engineering</span>, 14(4):792–808, 2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Yu A. Malkov and D. A. Yashunin.

</span>
<span class="ltx_bibblock">Efficient and robust approximate nearest neighbor search using hierarchical navigable small world graphs.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">IEEE Trans. Pattern Anal. Mach. Intell.</span>, 42(4):824–836, apr 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Julian McAuley, Christopher Targett, Qinfeng Shi, and Anton van den Hengel.

</span>
<span class="ltx_bibblock">Image-based recommendations on styles and substitutes.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">Proceedings of the 38th International ACM SIGIR Conference on Research and Development in Information Retrieval</span>, SIGIR ’15, page 43–52, New York, NY, USA, 2015. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Stanislav Morozov and Artem Babenko.

</span>
<span class="ltx_bibblock">Non-metric similarity graphs for maximum inner product search.

</span>
<span class="ltx_bibblock">In S. Bengio, H. Wallach, H. Larochelle, K. Grauman, N. Cesa-Bianchi, and R. Garnett, editors, <span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">Advances in Neural Information Processing Systems</span>, volume 31. Curran Associates, Inc., 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Hiroyuki Ootomo, Akira Naruse, Corey Nolet, Ray Wang, Tamas Feher, and Yong Wang.

</span>
<span class="ltx_bibblock">Cagra: Highly parallel graph construction and approximate nearest neighbor search for gpus, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Parikshit Ram and Alexander G. Gray.

</span>
<span class="ltx_bibblock">Maximum inner-product search using cone trees.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 18th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</span>, KDD ’12, page 931–939, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Steffen Rendle, Walid Krichene, Li Zhang, and John Anderson.

</span>
<span class="ltx_bibblock">Neural collaborative filtering vs. matrix factorization revisited.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">Fourteenth ACM Conference on Recommender Systems (RecSys’20)</span>, page 240–248, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Keshav Santhanam, Omar Khattab, Jon Saad-Falcon, Christopher Potts, and Matei Zaharia.

</span>
<span class="ltx_bibblock">ColBERTv2: Effective and efficient retrieval via lightweight late interaction.

</span>
<span class="ltx_bibblock">In Marine Carpuat, Marie-Catherine de Marneffe, and Ivan Vladimir Meza Ruiz, editors, <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">Proceedings of the 2022 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</span>, pages 3715–3734, Seattle, United States, July 2022. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Anshumali Shrivastava and Ping Li.

</span>
<span class="ltx_bibblock">Asymmetric lsh (alsh) for sublinear time maximum inner product search (mips).

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">Advances in Neural Information Processing Systems</span>, volume 27, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Weiwei Sun, Lingyong Yan, Zheng Chen, Shuaiqiang Wang, Haichao Zhu, Pengjie Ren, Zhumin Chen, Dawei Yin, Maarten Rijke, and Zhaochun Ren.

</span>
<span class="ltx_bibblock">Learning to tokenize for generative retrieval.

</span>
<span class="ltx_bibblock">In A. Oh, T. Naumann, A. Globerson, K. Saenko, M. Hardt, and S. Levine, editors, <span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">Advances in Neural Information Processing Systems</span>, volume 36, pages 46345–46361. Curran Associates, Inc., 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Shulong Tan, Zhixin Zhou, Zhaozhuo Xu, and Ping Li.

</span>
<span class="ltx_bibblock">Fast item ranking under neural network based measures.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">Proceedings of the 13th International Conference on Web Search and Data Mining</span>, WSDM ’20, page 591–599, New York, NY, USA, 2020. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Yi Tay, Vinh Q. Tran, Mostafa Dehghani, Jianmo Ni, Dara Bahri, Harsh Mehta, Zhen Qin, Kai Hui, Zhe Zhao, Jai Gupta, Tal Schuster, William W. Cohen, and Donald Metzler.

</span>
<span class="ltx_bibblock">Transformer memory as a differentiable search index.

</span>
<span class="ltx_bibblock">In Alice H. Oh, Alekh Agarwal, Danielle Belgrave, and Kyunghyun Cho, editors, <span class="ltx_text ltx_font_italic" id="bib.bib38.1.1">Advances in Neural Information Processing Systems</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Yiwei Wang, Bryan Hooi, Yozen Liu, Tong Zhao, Zhichun Guo, and Neil Shah.

</span>
<span class="ltx_bibblock">Flashlight: Scalable link prediction with effective decoders.

</span>
<span class="ltx_bibblock">In Bastian Rieck and Razvan Pascanu, editors, <span class="ltx_text ltx_font_italic" id="bib.bib39.1.1">Proceedings of the First Learning on Graphs Conference</span>, volume 198 of <span class="ltx_text ltx_font_italic" id="bib.bib39.2.2">Proceedings of Machine Learning Research</span>, pages 14:1–14:17. PMLR, 09–12 Dec 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Yujing Wang, Yingyan Hou, Haonan Wang, Ziming Miao, Shibin Wu, Qi Chen, Yuqing Xia, Chengmin Chi, Guoshuai Zhao, Zheng Liu, Xing Xie, Hao Sun, Weiwei Deng, Qi Zhang, and Mao Yang.

</span>
<span class="ltx_bibblock">A neural corpus indexer for document retrieval.

</span>
<span class="ltx_bibblock">In S. Koyejo, S. Mohamed, A. Agarwal, D. Belgrave, K. Cho, and A. Oh, editors, <span class="ltx_text ltx_font_italic" id="bib.bib40.1.1">Advances in Neural Information Processing Systems</span>, volume 35, pages 25600–25614. Curran Associates, Inc., 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Zhilin Yang, Zihang Dai, Ruslan Salakhutdinov, and William W. Cohen.

</span>
<span class="ltx_bibblock">Breaking the softmax bottleneck: A high-rank RNN language model.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">International Conference on Learning Representations (ICLR’18)</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Jiaqi Zhai, Zhaojie Gong, Yueming Wang, Xiao Sun, Zheng Yan, Fu Li, and Xing Liu.

</span>
<span class="ltx_bibblock">Revisiting neural retrieval on accelerators.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</span>, KDD ’23, page 5520–5531, New York, NY, USA, 2023. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Jiaqi Zhai, Lucy Liao, Xing Liu, Yueming Wang, Rui Li, Xuan Cao, Leon Gao, Zhaojie Gong, Fangda Gu, Jiayuan He, Yinghai Lu, and Yu Shi.

</span>
<span class="ltx_bibblock">Actions speak louder than words: Trillion-parameter sequential transducers for generative recommendations.

</span>
<span class="ltx_bibblock">In Ruslan Salakhutdinov, Zico Kolter, Katherine Heller, Adrian Weller, Nuria Oliver, Jonathan Scarlett, and Felix Berkenkamp, editors, <span class="ltx_text ltx_font_italic" id="bib.bib43.1.1">Proceedings of the 41st International Conference on Machine Learning</span>, volume 235 of <span class="ltx_text ltx_font_italic" id="bib.bib43.2.2">Proceedings of Machine Learning Research</span>, pages 58484–58509. PMLR, 21–27 Jul 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Jiaqi Zhai, Yin Lou, and Johannes Gehrke.

</span>
<span class="ltx_bibblock">Atlas: A probabilistic algorithm for high dimensional similarity search.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">Proceedings of the 2011 ACM SIGMOD International Conference on Management of Data</span>, SIGMOD ’11, page 997–1008, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Han Zhu, Xiang Li, Pengye Zhang, Guozheng Li, Jie He, Han Li, and Kun Gai.

</span>
<span class="ltx_bibblock">Learning tree-based deep model for recommender systems.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</span>, KDD ’18, page 1079–1088, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Jingwei Zhuo, Ziru Xu, Wei Dai, Han Zhu, Han Li, Jian Xu, and Kun Gai.

</span>
<span class="ltx_bibblock">Learning optimal tree models under beam search.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib46.1.1">Proceedings of the 37th International Conference on Machine Learning</span>, ICML’20. JMLR.org, 2020.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Experiment Setups</h2>
<section class="ltx_paragraph" id="A1.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Reproducibility.</h4>
<div class="ltx_para" id="A1.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A1.SS0.SSS0.Px1.p1.1">Our code is publicly available online, and detailed implementations and hyperparameter settings for reproducing our experiment results can be found at the following url: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/bailuding/rails" title="">https://github.com/bailuding/rails</a>. We discuss key settings below.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Parameterization of low-rank (“component-level”) embeddings, <math alttext="f_{p}(q)" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px2.1.m1.1"><semantics id="A1.SS0.SSS0.Px2.1.m1.1b"><mrow id="A1.SS0.SSS0.Px2.1.m1.1.2" xref="A1.SS0.SSS0.Px2.1.m1.1.2.cmml"><msub id="A1.SS0.SSS0.Px2.1.m1.1.2.2" xref="A1.SS0.SSS0.Px2.1.m1.1.2.2.cmml"><mi id="A1.SS0.SSS0.Px2.1.m1.1.2.2.2" xref="A1.SS0.SSS0.Px2.1.m1.1.2.2.2.cmml">f</mi><mi id="A1.SS0.SSS0.Px2.1.m1.1.2.2.3" xref="A1.SS0.SSS0.Px2.1.m1.1.2.2.3.cmml">p</mi></msub><mo id="A1.SS0.SSS0.Px2.1.m1.1.2.1" xref="A1.SS0.SSS0.Px2.1.m1.1.2.1.cmml">⁢</mo><mrow id="A1.SS0.SSS0.Px2.1.m1.1.2.3.2" xref="A1.SS0.SSS0.Px2.1.m1.1.2.cmml"><mo id="A1.SS0.SSS0.Px2.1.m1.1.2.3.2.1" stretchy="false" xref="A1.SS0.SSS0.Px2.1.m1.1.2.cmml">(</mo><mi id="A1.SS0.SSS0.Px2.1.m1.1.1" xref="A1.SS0.SSS0.Px2.1.m1.1.1.cmml">q</mi><mo id="A1.SS0.SSS0.Px2.1.m1.1.2.3.2.2" stretchy="false" xref="A1.SS0.SSS0.Px2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px2.1.m1.1c"><apply id="A1.SS0.SSS0.Px2.1.m1.1.2.cmml" xref="A1.SS0.SSS0.Px2.1.m1.1.2"><times id="A1.SS0.SSS0.Px2.1.m1.1.2.1.cmml" xref="A1.SS0.SSS0.Px2.1.m1.1.2.1"></times><apply id="A1.SS0.SSS0.Px2.1.m1.1.2.2.cmml" xref="A1.SS0.SSS0.Px2.1.m1.1.2.2"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px2.1.m1.1.2.2.1.cmml" xref="A1.SS0.SSS0.Px2.1.m1.1.2.2">subscript</csymbol><ci id="A1.SS0.SSS0.Px2.1.m1.1.2.2.2.cmml" xref="A1.SS0.SSS0.Px2.1.m1.1.2.2.2">𝑓</ci><ci id="A1.SS0.SSS0.Px2.1.m1.1.2.2.3.cmml" xref="A1.SS0.SSS0.Px2.1.m1.1.2.2.3">𝑝</ci></apply><ci id="A1.SS0.SSS0.Px2.1.m1.1.1.cmml" xref="A1.SS0.SSS0.Px2.1.m1.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px2.1.m1.1d">f_{p}(q)</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px2.1.m1.1e">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math> and <math alttext="g_{p}(x)" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px2.2.m2.1"><semantics id="A1.SS0.SSS0.Px2.2.m2.1b"><mrow id="A1.SS0.SSS0.Px2.2.m2.1.2" xref="A1.SS0.SSS0.Px2.2.m2.1.2.cmml"><msub id="A1.SS0.SSS0.Px2.2.m2.1.2.2" xref="A1.SS0.SSS0.Px2.2.m2.1.2.2.cmml"><mi id="A1.SS0.SSS0.Px2.2.m2.1.2.2.2" xref="A1.SS0.SSS0.Px2.2.m2.1.2.2.2.cmml">g</mi><mi id="A1.SS0.SSS0.Px2.2.m2.1.2.2.3" xref="A1.SS0.SSS0.Px2.2.m2.1.2.2.3.cmml">p</mi></msub><mo id="A1.SS0.SSS0.Px2.2.m2.1.2.1" xref="A1.SS0.SSS0.Px2.2.m2.1.2.1.cmml">⁢</mo><mrow id="A1.SS0.SSS0.Px2.2.m2.1.2.3.2" xref="A1.SS0.SSS0.Px2.2.m2.1.2.cmml"><mo id="A1.SS0.SSS0.Px2.2.m2.1.2.3.2.1" stretchy="false" xref="A1.SS0.SSS0.Px2.2.m2.1.2.cmml">(</mo><mi id="A1.SS0.SSS0.Px2.2.m2.1.1" xref="A1.SS0.SSS0.Px2.2.m2.1.1.cmml">x</mi><mo id="A1.SS0.SSS0.Px2.2.m2.1.2.3.2.2" stretchy="false" xref="A1.SS0.SSS0.Px2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px2.2.m2.1c"><apply id="A1.SS0.SSS0.Px2.2.m2.1.2.cmml" xref="A1.SS0.SSS0.Px2.2.m2.1.2"><times id="A1.SS0.SSS0.Px2.2.m2.1.2.1.cmml" xref="A1.SS0.SSS0.Px2.2.m2.1.2.1"></times><apply id="A1.SS0.SSS0.Px2.2.m2.1.2.2.cmml" xref="A1.SS0.SSS0.Px2.2.m2.1.2.2"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px2.2.m2.1.2.2.1.cmml" xref="A1.SS0.SSS0.Px2.2.m2.1.2.2">subscript</csymbol><ci id="A1.SS0.SSS0.Px2.2.m2.1.2.2.2.cmml" xref="A1.SS0.SSS0.Px2.2.m2.1.2.2.2">𝑔</ci><ci id="A1.SS0.SSS0.Px2.2.m2.1.2.2.3.cmml" xref="A1.SS0.SSS0.Px2.2.m2.1.2.2.3">𝑝</ci></apply><ci id="A1.SS0.SSS0.Px2.2.m2.1.1.cmml" xref="A1.SS0.SSS0.Px2.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px2.2.m2.1d">g_{p}(x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px2.2.m2.1e">italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math>s for <math alttext="1\leq p\leq P" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px2.3.m3.1"><semantics id="A1.SS0.SSS0.Px2.3.m3.1b"><mrow id="A1.SS0.SSS0.Px2.3.m3.1.1" xref="A1.SS0.SSS0.Px2.3.m3.1.1.cmml"><mn id="A1.SS0.SSS0.Px2.3.m3.1.1.2" xref="A1.SS0.SSS0.Px2.3.m3.1.1.2.cmml">1</mn><mo id="A1.SS0.SSS0.Px2.3.m3.1.1.3" xref="A1.SS0.SSS0.Px2.3.m3.1.1.3.cmml">≤</mo><mi id="A1.SS0.SSS0.Px2.3.m3.1.1.4" xref="A1.SS0.SSS0.Px2.3.m3.1.1.4.cmml">p</mi><mo id="A1.SS0.SSS0.Px2.3.m3.1.1.5" xref="A1.SS0.SSS0.Px2.3.m3.1.1.5.cmml">≤</mo><mi id="A1.SS0.SSS0.Px2.3.m3.1.1.6" xref="A1.SS0.SSS0.Px2.3.m3.1.1.6.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px2.3.m3.1c"><apply id="A1.SS0.SSS0.Px2.3.m3.1.1.cmml" xref="A1.SS0.SSS0.Px2.3.m3.1.1"><and id="A1.SS0.SSS0.Px2.3.m3.1.1a.cmml" xref="A1.SS0.SSS0.Px2.3.m3.1.1"></and><apply id="A1.SS0.SSS0.Px2.3.m3.1.1b.cmml" xref="A1.SS0.SSS0.Px2.3.m3.1.1"><leq id="A1.SS0.SSS0.Px2.3.m3.1.1.3.cmml" xref="A1.SS0.SSS0.Px2.3.m3.1.1.3"></leq><cn id="A1.SS0.SSS0.Px2.3.m3.1.1.2.cmml" type="integer" xref="A1.SS0.SSS0.Px2.3.m3.1.1.2">1</cn><ci id="A1.SS0.SSS0.Px2.3.m3.1.1.4.cmml" xref="A1.SS0.SSS0.Px2.3.m3.1.1.4">𝑝</ci></apply><apply id="A1.SS0.SSS0.Px2.3.m3.1.1c.cmml" xref="A1.SS0.SSS0.Px2.3.m3.1.1"><leq id="A1.SS0.SSS0.Px2.3.m3.1.1.5.cmml" xref="A1.SS0.SSS0.Px2.3.m3.1.1.5"></leq><share href="https://arxiv.org/html/2407.15462v2#A1.SS0.SSS0.Px2.3.m3.1.1.4.cmml" id="A1.SS0.SSS0.Px2.3.m3.1.1d.cmml" xref="A1.SS0.SSS0.Px2.3.m3.1.1"></share><ci id="A1.SS0.SSS0.Px2.3.m3.1.1.6.cmml" xref="A1.SS0.SSS0.Px2.3.m3.1.1.6">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px2.3.m3.1d">1\leq p\leq P</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px2.3.m3.1e">1 ≤ italic_p ≤ italic_P</annotation></semantics></math>.</h4>
<div class="ltx_para" id="A1.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A1.SS0.SSS0.Px2.p1.4">We note that embedding parameterization was not explicitly discussed in the original Mixture-of-Logits paper <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite>. A specific implementation utilizing cluster id information has been proposed and discussed in a follow up work <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite>, where in the context of large-scale recommendation systems, the authors suggested cluster information based on interests of cohorts of members and topics of posts by themselves can lead to 10% recall gain at <math alttext="K=400" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="A1.SS0.SSS0.Px2.p1.1.m1.1a"><mrow id="A1.SS0.SSS0.Px2.p1.1.m1.1.1" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.2" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml">K</mi><mo id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1"><eq id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1"></eq><ci id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.2">𝐾</ci><cn id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml" type="integer" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px2.p1.1.m1.1c">K=400</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px2.p1.1.m1.1d">italic_K = 400</annotation></semantics></math>. However, we cannot easily access similar information in the publicly available MovieLens and Amazon Reviews datasets. We therefore follow implementation provided by the authors <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite> and additionally optionally utilizes a User ID keyed one-hot embedding as one query-side low-rank (“component-level”) embeddings <math alttext="f_{p}(q)" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="A1.SS0.SSS0.Px2.p1.2.m2.1a"><mrow id="A1.SS0.SSS0.Px2.p1.2.m2.1.2" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.cmml"><msub id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2.cmml"><mi id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2.2" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2.2.cmml">f</mi><mi id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2.3" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2.3.cmml">p</mi></msub><mo id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.1" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.3.2" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.cmml"><mo id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.3.2.1" stretchy="false" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.cmml">(</mo><mi id="A1.SS0.SSS0.Px2.p1.2.m2.1.1" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">q</mi><mo id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.3.2.2" stretchy="false" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.cmml" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2"><times id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.1.cmml" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.1"></times><apply id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2.cmml" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2.1.cmml" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2">subscript</csymbol><ci id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2.2.cmml" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2.2">𝑓</ci><ci id="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2.3.cmml" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.2.2.3">𝑝</ci></apply><ci id="A1.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="A1.SS0.SSS0.Px2.p1.2.m2.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px2.p1.2.m2.1c">f_{p}(q)</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px2.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math>, which is a widely used technique in recommendation systems <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib24" title="">24</a>]</cite>. All other <math alttext="f_{p}(q)" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="A1.SS0.SSS0.Px2.p1.3.m3.1a"><mrow id="A1.SS0.SSS0.Px2.p1.3.m3.1.2" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.cmml"><msub id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2.cmml"><mi id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2.2" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2.2.cmml">f</mi><mi id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2.3" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2.3.cmml">p</mi></msub><mo id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.1" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.3.2" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.cmml"><mo id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.3.2.1" stretchy="false" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.cmml">(</mo><mi id="A1.SS0.SSS0.Px2.p1.3.m3.1.1" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.1.cmml">q</mi><mo id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.3.2.2" stretchy="false" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.cmml" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2"><times id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.1.cmml" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.1"></times><apply id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2.cmml" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2.1.cmml" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2">subscript</csymbol><ci id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2.2.cmml" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2.2">𝑓</ci><ci id="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2.3.cmml" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.2.2.3">𝑝</ci></apply><ci id="A1.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="A1.SS0.SSS0.Px2.p1.3.m3.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px2.p1.3.m3.1c">f_{p}(q)</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px2.p1.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math>s and <math alttext="g_{p}(x)" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px2.p1.4.m4.1"><semantics id="A1.SS0.SSS0.Px2.p1.4.m4.1a"><mrow id="A1.SS0.SSS0.Px2.p1.4.m4.1.2" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.cmml"><msub id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2.cmml"><mi id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2.2" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2.2.cmml">g</mi><mi id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2.3" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2.3.cmml">p</mi></msub><mo id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.1" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.3.2" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.cmml"><mo id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.3.2.1" stretchy="false" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.cmml">(</mo><mi id="A1.SS0.SSS0.Px2.p1.4.m4.1.1" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.1.cmml">x</mi><mo id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.3.2.2" stretchy="false" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px2.p1.4.m4.1b"><apply id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.cmml" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2"><times id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.1.cmml" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.1"></times><apply id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2.cmml" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2.1.cmml" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2">subscript</csymbol><ci id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2.2.cmml" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2.2">𝑔</ci><ci id="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2.3.cmml" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.2.2.3">𝑝</ci></apply><ci id="A1.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="A1.SS0.SSS0.Px2.p1.4.m4.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px2.p1.4.m4.1c">g_{p}(x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px2.p1.4.m4.1d">italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math>s are obtained by applying an MLP on top of query-side/item-side representations in standard sequential recommendation setups <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib20" title="">20</a>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Parameterization of <math alttext="\pi_{p}(q,x)" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.1.m1.2"><semantics id="A1.SS0.SSS0.Px3.1.m1.2b"><mrow id="A1.SS0.SSS0.Px3.1.m1.2.3" xref="A1.SS0.SSS0.Px3.1.m1.2.3.cmml"><msub id="A1.SS0.SSS0.Px3.1.m1.2.3.2" xref="A1.SS0.SSS0.Px3.1.m1.2.3.2.cmml"><mi id="A1.SS0.SSS0.Px3.1.m1.2.3.2.2" xref="A1.SS0.SSS0.Px3.1.m1.2.3.2.2.cmml">π</mi><mi id="A1.SS0.SSS0.Px3.1.m1.2.3.2.3" xref="A1.SS0.SSS0.Px3.1.m1.2.3.2.3.cmml">p</mi></msub><mo id="A1.SS0.SSS0.Px3.1.m1.2.3.1" xref="A1.SS0.SSS0.Px3.1.m1.2.3.1.cmml">⁢</mo><mrow id="A1.SS0.SSS0.Px3.1.m1.2.3.3.2" xref="A1.SS0.SSS0.Px3.1.m1.2.3.3.1.cmml"><mo id="A1.SS0.SSS0.Px3.1.m1.2.3.3.2.1" stretchy="false" xref="A1.SS0.SSS0.Px3.1.m1.2.3.3.1.cmml">(</mo><mi id="A1.SS0.SSS0.Px3.1.m1.1.1" xref="A1.SS0.SSS0.Px3.1.m1.1.1.cmml">q</mi><mo id="A1.SS0.SSS0.Px3.1.m1.2.3.3.2.2" xref="A1.SS0.SSS0.Px3.1.m1.2.3.3.1.cmml">,</mo><mi id="A1.SS0.SSS0.Px3.1.m1.2.2" xref="A1.SS0.SSS0.Px3.1.m1.2.2.cmml">x</mi><mo id="A1.SS0.SSS0.Px3.1.m1.2.3.3.2.3" stretchy="false" xref="A1.SS0.SSS0.Px3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.1.m1.2c"><apply id="A1.SS0.SSS0.Px3.1.m1.2.3.cmml" xref="A1.SS0.SSS0.Px3.1.m1.2.3"><times id="A1.SS0.SSS0.Px3.1.m1.2.3.1.cmml" xref="A1.SS0.SSS0.Px3.1.m1.2.3.1"></times><apply id="A1.SS0.SSS0.Px3.1.m1.2.3.2.cmml" xref="A1.SS0.SSS0.Px3.1.m1.2.3.2"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px3.1.m1.2.3.2.1.cmml" xref="A1.SS0.SSS0.Px3.1.m1.2.3.2">subscript</csymbol><ci id="A1.SS0.SSS0.Px3.1.m1.2.3.2.2.cmml" xref="A1.SS0.SSS0.Px3.1.m1.2.3.2.2">𝜋</ci><ci id="A1.SS0.SSS0.Px3.1.m1.2.3.2.3.cmml" xref="A1.SS0.SSS0.Px3.1.m1.2.3.2.3">𝑝</ci></apply><interval closure="open" id="A1.SS0.SSS0.Px3.1.m1.2.3.3.1.cmml" xref="A1.SS0.SSS0.Px3.1.m1.2.3.3.2"><ci id="A1.SS0.SSS0.Px3.1.m1.1.1.cmml" xref="A1.SS0.SSS0.Px3.1.m1.1.1">𝑞</ci><ci id="A1.SS0.SSS0.Px3.1.m1.2.2.cmml" xref="A1.SS0.SSS0.Px3.1.m1.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.1.m1.2d">\pi_{p}(q,x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.1.m1.2e">italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q , italic_x )</annotation></semantics></math> matrices.</h4>
<div class="ltx_para" id="A1.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="A1.SS0.SSS0.Px3.p1.3">We follow the implementation provided by the authors <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite>, which parameterizes <math alttext="\pi_{p}(q,x)" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.1.m1.2"><semantics id="A1.SS0.SSS0.Px3.p1.1.m1.2a"><mrow id="A1.SS0.SSS0.Px3.p1.1.m1.2.3" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.cmml"><msub id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.cmml"><mi id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.2" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.2.cmml">π</mi><mi id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.3" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.3.cmml">p</mi></msub><mo id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.1" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.2" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.1.cmml"><mo id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.2.1" stretchy="false" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="A1.SS0.SSS0.Px3.p1.1.m1.1.1" xref="A1.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">q</mi><mo id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.2.2" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="A1.SS0.SSS0.Px3.p1.1.m1.2.2" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.2.cmml">x</mi><mo id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.2.3" stretchy="false" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.1.m1.2b"><apply id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3"><times id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.1.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.1"></times><apply id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.1.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2">subscript</csymbol><ci id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.2.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.2">𝜋</ci><ci id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.3.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.3">𝑝</ci></apply><interval closure="open" id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.1.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.2"><ci id="A1.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.1.1">𝑞</ci><ci id="A1.SS0.SSS0.Px3.p1.1.m1.2.2.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.1.m1.2c">\pi_{p}(q,x)</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.1.m1.2d">italic_π start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q , italic_x )</annotation></semantics></math> as a two-layer multi-layer perceptron (MLP) with SiLU <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib7" title="">7</a>]</cite> non-linearity. The inputs to this MLP consist of user-side features, item-side features, and the <math alttext="P" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.2.m2.1"><semantics id="A1.SS0.SSS0.Px3.p1.2.m2.1a"><mi id="A1.SS0.SSS0.Px3.p1.2.m2.1.1" xref="A1.SS0.SSS0.Px3.p1.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.2.m2.1b"><ci id="A1.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.2.m2.1d">italic_P</annotation></semantics></math> dot products <math alttext="\langle f_{p}(q),g_{p}(x)\rangle" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px3.p1.3.m3.4"><semantics id="A1.SS0.SSS0.Px3.p1.3.m3.4a"><mrow id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.3.cmml"><mo id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.3" stretchy="false" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.3.cmml">⟨</mo><mrow id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.cmml"><msub id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2.cmml"><mi id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2.2" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2.2.cmml">f</mi><mi id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2.3" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2.3.cmml">p</mi></msub><mo id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.1" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.1.cmml">⁢</mo><mrow id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.3.2" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.cmml"><mo id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.3.2.1" stretchy="false" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.cmml">(</mo><mi id="A1.SS0.SSS0.Px3.p1.3.m3.1.1" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1.cmml">q</mi><mo id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.3.2.2" stretchy="false" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.4" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.3.cmml">,</mo><mrow id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.cmml"><msub id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2.cmml"><mi id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2.2" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2.2.cmml">g</mi><mi id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2.3" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2.3.cmml">p</mi></msub><mo id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.1" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.1.cmml">⁢</mo><mrow id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.3.2" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.cmml"><mo id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.3.2.1" stretchy="false" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.cmml">(</mo><mi id="A1.SS0.SSS0.Px3.p1.3.m3.2.2" xref="A1.SS0.SSS0.Px3.p1.3.m3.2.2.cmml">x</mi><mo id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.3.2.2" stretchy="false" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.cmml">)</mo></mrow></mrow><mo id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.5" stretchy="false" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.3.m3.4b"><list id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.3.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2"><apply id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1"><times id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.1"></times><apply id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2.1.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2">subscript</csymbol><ci id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2.2.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2.2">𝑓</ci><ci id="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2.3.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.3.3.1.1.2.3">𝑝</ci></apply><ci id="A1.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.1.1">𝑞</ci></apply><apply id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2"><times id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.1.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.1"></times><apply id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2.1.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2">subscript</csymbol><ci id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2.2.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2.2">𝑔</ci><ci id="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2.3.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.4.4.2.2.2.3">𝑝</ci></apply><ci id="A1.SS0.SSS0.Px3.p1.3.m3.2.2.cmml" xref="A1.SS0.SSS0.Px3.p1.3.m3.2.2">𝑥</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.3.m3.4c">\langle f_{p}(q),g_{p}(x)\rangle</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px3.p1.3.m3.4d">⟨ italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_q ) , italic_g start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_x ) ⟩</annotation></semantics></math>s between the learned low-rank embeddings.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Hyperparameter settings.</h4>
<div class="ltx_para" id="A1.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="A1.SS0.SSS0.Px4.p1.7">We use an identical number of sampled negatives for dot product baselines (cosine similarity, “SASRec”, “HSTU” rows in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.T3" title="Table 3 ‣ Model. ‣ 4.1 Setup ‣ 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">3</span></a>) and Mixture-of-logits (“SASRec + MoL”, “HSTU + MoL” rows in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.T3" title="Table 3 ‣ Model. ‣ 4.1 Setup ‣ 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">3</span></a>) to ensure a fair comparison, which is <math alttext="128" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px4.p1.1.m1.1"><semantics id="A1.SS0.SSS0.Px4.p1.1.m1.1a"><mn id="A1.SS0.SSS0.Px4.p1.1.m1.1.1" xref="A1.SS0.SSS0.Px4.p1.1.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px4.p1.1.m1.1b"><cn id="A1.SS0.SSS0.Px4.p1.1.m1.1.1.cmml" type="integer" xref="A1.SS0.SSS0.Px4.p1.1.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px4.p1.1.m1.1c">128</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px4.p1.1.m1.1d">128</annotation></semantics></math> for ML-1M and ML-20M and <math alttext="512" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px4.p1.2.m2.1"><semantics id="A1.SS0.SSS0.Px4.p1.2.m2.1a"><mn id="A1.SS0.SSS0.Px4.p1.2.m2.1.1" xref="A1.SS0.SSS0.Px4.p1.2.m2.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px4.p1.2.m2.1b"><cn id="A1.SS0.SSS0.Px4.p1.2.m2.1.1.cmml" type="integer" xref="A1.SS0.SSS0.Px4.p1.2.m2.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px4.p1.2.m2.1c">512</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px4.p1.2.m2.1d">512</annotation></semantics></math> for Amazon Books following prior work. For “+ MoL” rows, we additionally grid searched <math alttext="|P_{x}|" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px4.p1.3.m3.1"><semantics id="A1.SS0.SSS0.Px4.p1.3.m3.1a"><mrow id="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1" xref="A1.SS0.SSS0.Px4.p1.3.m3.1.1.2.cmml"><mo id="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.2" stretchy="false" xref="A1.SS0.SSS0.Px4.p1.3.m3.1.1.2.1.cmml">|</mo><msub id="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1" xref="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1.cmml"><mi id="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1.2" xref="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1.2.cmml">P</mi><mi id="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1.3" xref="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1.3.cmml">x</mi></msub><mo id="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.3" stretchy="false" xref="A1.SS0.SSS0.Px4.p1.3.m3.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px4.p1.3.m3.1b"><apply id="A1.SS0.SSS0.Px4.p1.3.m3.1.1.2.cmml" xref="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1"><abs id="A1.SS0.SSS0.Px4.p1.3.m3.1.1.2.1.cmml" xref="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.2"></abs><apply id="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1.cmml" xref="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1.1.cmml" xref="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1.2.cmml" xref="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1.2">𝑃</ci><ci id="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1.3.cmml" xref="A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px4.p1.3.m3.1c">|P_{x}|</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px4.p1.3.m3.1d">| italic_P start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT |</annotation></semantics></math> in <math alttext="\{2,4,8,16\}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px4.p1.4.m4.4"><semantics id="A1.SS0.SSS0.Px4.p1.4.m4.4a"><mrow id="A1.SS0.SSS0.Px4.p1.4.m4.4.5.2" xref="A1.SS0.SSS0.Px4.p1.4.m4.4.5.1.cmml"><mo id="A1.SS0.SSS0.Px4.p1.4.m4.4.5.2.1" stretchy="false" xref="A1.SS0.SSS0.Px4.p1.4.m4.4.5.1.cmml">{</mo><mn id="A1.SS0.SSS0.Px4.p1.4.m4.1.1" xref="A1.SS0.SSS0.Px4.p1.4.m4.1.1.cmml">2</mn><mo id="A1.SS0.SSS0.Px4.p1.4.m4.4.5.2.2" xref="A1.SS0.SSS0.Px4.p1.4.m4.4.5.1.cmml">,</mo><mn id="A1.SS0.SSS0.Px4.p1.4.m4.2.2" xref="A1.SS0.SSS0.Px4.p1.4.m4.2.2.cmml">4</mn><mo id="A1.SS0.SSS0.Px4.p1.4.m4.4.5.2.3" xref="A1.SS0.SSS0.Px4.p1.4.m4.4.5.1.cmml">,</mo><mn id="A1.SS0.SSS0.Px4.p1.4.m4.3.3" xref="A1.SS0.SSS0.Px4.p1.4.m4.3.3.cmml">8</mn><mo id="A1.SS0.SSS0.Px4.p1.4.m4.4.5.2.4" xref="A1.SS0.SSS0.Px4.p1.4.m4.4.5.1.cmml">,</mo><mn id="A1.SS0.SSS0.Px4.p1.4.m4.4.4" xref="A1.SS0.SSS0.Px4.p1.4.m4.4.4.cmml">16</mn><mo id="A1.SS0.SSS0.Px4.p1.4.m4.4.5.2.5" stretchy="false" xref="A1.SS0.SSS0.Px4.p1.4.m4.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px4.p1.4.m4.4b"><set id="A1.SS0.SSS0.Px4.p1.4.m4.4.5.1.cmml" xref="A1.SS0.SSS0.Px4.p1.4.m4.4.5.2"><cn id="A1.SS0.SSS0.Px4.p1.4.m4.1.1.cmml" type="integer" xref="A1.SS0.SSS0.Px4.p1.4.m4.1.1">2</cn><cn id="A1.SS0.SSS0.Px4.p1.4.m4.2.2.cmml" type="integer" xref="A1.SS0.SSS0.Px4.p1.4.m4.2.2">4</cn><cn id="A1.SS0.SSS0.Px4.p1.4.m4.3.3.cmml" type="integer" xref="A1.SS0.SSS0.Px4.p1.4.m4.3.3">8</cn><cn id="A1.SS0.SSS0.Px4.p1.4.m4.4.4.cmml" type="integer" xref="A1.SS0.SSS0.Px4.p1.4.m4.4.4">16</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px4.p1.4.m4.4c">\{2,4,8,16\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px4.p1.4.m4.4d">{ 2 , 4 , 8 , 16 }</annotation></semantics></math>, <math alttext="d_{P}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px4.p1.5.m5.1"><semantics id="A1.SS0.SSS0.Px4.p1.5.m5.1a"><msub id="A1.SS0.SSS0.Px4.p1.5.m5.1.1" xref="A1.SS0.SSS0.Px4.p1.5.m5.1.1.cmml"><mi id="A1.SS0.SSS0.Px4.p1.5.m5.1.1.2" xref="A1.SS0.SSS0.Px4.p1.5.m5.1.1.2.cmml">d</mi><mi id="A1.SS0.SSS0.Px4.p1.5.m5.1.1.3" xref="A1.SS0.SSS0.Px4.p1.5.m5.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px4.p1.5.m5.1b"><apply id="A1.SS0.SSS0.Px4.p1.5.m5.1.1.cmml" xref="A1.SS0.SSS0.Px4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS0.SSS0.Px4.p1.5.m5.1.1.1.cmml" xref="A1.SS0.SSS0.Px4.p1.5.m5.1.1">subscript</csymbol><ci id="A1.SS0.SSS0.Px4.p1.5.m5.1.1.2.cmml" xref="A1.SS0.SSS0.Px4.p1.5.m5.1.1.2">𝑑</ci><ci id="A1.SS0.SSS0.Px4.p1.5.m5.1.1.3.cmml" xref="A1.SS0.SSS0.Px4.p1.5.m5.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px4.p1.5.m5.1c">d_{P}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px4.p1.5.m5.1d">italic_d start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="\{32,64,128\}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px4.p1.6.m6.3"><semantics id="A1.SS0.SSS0.Px4.p1.6.m6.3a"><mrow id="A1.SS0.SSS0.Px4.p1.6.m6.3.4.2" xref="A1.SS0.SSS0.Px4.p1.6.m6.3.4.1.cmml"><mo id="A1.SS0.SSS0.Px4.p1.6.m6.3.4.2.1" stretchy="false" xref="A1.SS0.SSS0.Px4.p1.6.m6.3.4.1.cmml">{</mo><mn id="A1.SS0.SSS0.Px4.p1.6.m6.1.1" xref="A1.SS0.SSS0.Px4.p1.6.m6.1.1.cmml">32</mn><mo id="A1.SS0.SSS0.Px4.p1.6.m6.3.4.2.2" xref="A1.SS0.SSS0.Px4.p1.6.m6.3.4.1.cmml">,</mo><mn id="A1.SS0.SSS0.Px4.p1.6.m6.2.2" xref="A1.SS0.SSS0.Px4.p1.6.m6.2.2.cmml">64</mn><mo id="A1.SS0.SSS0.Px4.p1.6.m6.3.4.2.3" xref="A1.SS0.SSS0.Px4.p1.6.m6.3.4.1.cmml">,</mo><mn id="A1.SS0.SSS0.Px4.p1.6.m6.3.3" xref="A1.SS0.SSS0.Px4.p1.6.m6.3.3.cmml">128</mn><mo id="A1.SS0.SSS0.Px4.p1.6.m6.3.4.2.4" stretchy="false" xref="A1.SS0.SSS0.Px4.p1.6.m6.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px4.p1.6.m6.3b"><set id="A1.SS0.SSS0.Px4.p1.6.m6.3.4.1.cmml" xref="A1.SS0.SSS0.Px4.p1.6.m6.3.4.2"><cn id="A1.SS0.SSS0.Px4.p1.6.m6.1.1.cmml" type="integer" xref="A1.SS0.SSS0.Px4.p1.6.m6.1.1">32</cn><cn id="A1.SS0.SSS0.Px4.p1.6.m6.2.2.cmml" type="integer" xref="A1.SS0.SSS0.Px4.p1.6.m6.2.2">64</cn><cn id="A1.SS0.SSS0.Px4.p1.6.m6.3.3.cmml" type="integer" xref="A1.SS0.SSS0.Px4.p1.6.m6.3.3">128</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px4.p1.6.m6.3c">\{32,64,128\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px4.p1.6.m6.3d">{ 32 , 64 , 128 }</annotation></semantics></math>), whether to enable user-id based learned embeddings, and the dropout rate to apply to user-id based embeddings in <math alttext="\{0.2,0.5,0.8\}" class="ltx_Math" display="inline" id="A1.SS0.SSS0.Px4.p1.7.m7.3"><semantics id="A1.SS0.SSS0.Px4.p1.7.m7.3a"><mrow id="A1.SS0.SSS0.Px4.p1.7.m7.3.4.2" xref="A1.SS0.SSS0.Px4.p1.7.m7.3.4.1.cmml"><mo id="A1.SS0.SSS0.Px4.p1.7.m7.3.4.2.1" stretchy="false" xref="A1.SS0.SSS0.Px4.p1.7.m7.3.4.1.cmml">{</mo><mn id="A1.SS0.SSS0.Px4.p1.7.m7.1.1" xref="A1.SS0.SSS0.Px4.p1.7.m7.1.1.cmml">0.2</mn><mo id="A1.SS0.SSS0.Px4.p1.7.m7.3.4.2.2" xref="A1.SS0.SSS0.Px4.p1.7.m7.3.4.1.cmml">,</mo><mn id="A1.SS0.SSS0.Px4.p1.7.m7.2.2" xref="A1.SS0.SSS0.Px4.p1.7.m7.2.2.cmml">0.5</mn><mo id="A1.SS0.SSS0.Px4.p1.7.m7.3.4.2.3" xref="A1.SS0.SSS0.Px4.p1.7.m7.3.4.1.cmml">,</mo><mn id="A1.SS0.SSS0.Px4.p1.7.m7.3.3" xref="A1.SS0.SSS0.Px4.p1.7.m7.3.3.cmml">0.8</mn><mo id="A1.SS0.SSS0.Px4.p1.7.m7.3.4.2.4" stretchy="false" xref="A1.SS0.SSS0.Px4.p1.7.m7.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px4.p1.7.m7.3b"><set id="A1.SS0.SSS0.Px4.p1.7.m7.3.4.1.cmml" xref="A1.SS0.SSS0.Px4.p1.7.m7.3.4.2"><cn id="A1.SS0.SSS0.Px4.p1.7.m7.1.1.cmml" type="float" xref="A1.SS0.SSS0.Px4.p1.7.m7.1.1">0.2</cn><cn id="A1.SS0.SSS0.Px4.p1.7.m7.2.2.cmml" type="float" xref="A1.SS0.SSS0.Px4.p1.7.m7.2.2">0.5</cn><cn id="A1.SS0.SSS0.Px4.p1.7.m7.3.3.cmml" type="float" xref="A1.SS0.SSS0.Px4.p1.7.m7.3.3">0.8</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px4.p1.7.m7.3c">\{0.2,0.5,0.8\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS0.SSS0.Px4.p1.7.m7.3d">{ 0.2 , 0.5 , 0.8 }</annotation></semantics></math> for the smaller MovieLens datasets. Due to resource constraints, we followed initial hyperparameters provided by the authors <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>]</cite> for all other parameters.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Efficiency</h3>
<figure class="ltx_table" id="A1.T5">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T5.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T5.2.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="A1.T5.2.1.1.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T5.2.1.1.2"><span class="ltx_text ltx_font_bold" id="A1.T5.2.1.1.2.1" style="font-size:90%;">Method</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T5.2.1.1.3"><span class="ltx_text ltx_font_bold" id="A1.T5.2.1.1.3.1" style="font-size:90%;">HR@10</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T5.2.1.1.4"><span class="ltx_text ltx_font_bold" id="A1.T5.2.1.1.4.1" style="font-size:90%;">HR@50</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T5.2.1.1.5"><span class="ltx_text ltx_font_bold" id="A1.T5.2.1.1.5.1" style="font-size:90%;">MRR</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T5.2.1.1.6"><span class="ltx_text" id="A1.T5.2.1.1.6.1" style="font-size:90%;">Time/Epoch</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T5.2.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A1.T5.2.2.1.1" rowspan="4"><span class="ltx_text ltx_font_italic" id="A1.T5.2.2.1.1.1" style="font-size:90%;">ML-1M</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.2.1.2"><span class="ltx_text" id="A1.T5.2.2.1.2.1" style="font-size:90%;">SASRec</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.2.1.3"><span class="ltx_text" id="A1.T5.2.2.1.3.1" style="font-size:90%;">.2818</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.2.1.4"><span class="ltx_text" id="A1.T5.2.2.1.4.1" style="font-size:90%;">.5470</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.2.1.5"><span class="ltx_text" id="A1.T5.2.2.1.5.1" style="font-size:90%;">.1352</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.2.1.6"><span class="ltx_text" id="A1.T5.2.2.1.6.1" style="font-size:90%;">37s</span></td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.3.2">
<td class="ltx_td ltx_align_left" id="A1.T5.2.3.2.1"><span class="ltx_text" id="A1.T5.2.3.2.1.1" style="font-size:90%;">SASRec + MoL</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.3.2.2"><span class="ltx_text" id="A1.T5.2.3.2.2.1" style="font-size:90%;">.3034 (+7.7%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.3.2.3"><span class="ltx_text" id="A1.T5.2.3.2.3.1" style="font-size:90%;">.5655 (+3.4%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.3.2.4"><span class="ltx_text" id="A1.T5.2.3.2.4.1" style="font-size:90%;">.1448 (+7.1%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.3.2.5"><span class="ltx_text" id="A1.T5.2.3.2.5.1" style="font-size:90%;">44s (+18.9%)</span></td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.4.3">
<td class="ltx_td ltx_align_left" id="A1.T5.2.4.3.1"><span class="ltx_text" id="A1.T5.2.4.3.1.1" style="font-size:90%;">HSTU</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.4.3.2"><span class="ltx_text" id="A1.T5.2.4.3.2.1" style="font-size:90%;">.3332</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.4.3.3"><span class="ltx_text" id="A1.T5.2.4.3.3.1" style="font-size:90%;">.5956</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.4.3.4"><span class="ltx_text" id="A1.T5.2.4.3.4.1" style="font-size:90%;">.1579</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.4.3.5"><span class="ltx_text" id="A1.T5.2.4.3.5.1" style="font-size:90%;">41s</span></td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.5.4">
<td class="ltx_td ltx_align_left" id="A1.T5.2.5.4.1"><span class="ltx_text" id="A1.T5.2.5.4.1.1" style="font-size:90%;">HSTU + MoL</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.5.4.2"><span class="ltx_text ltx_font_bold" id="A1.T5.2.5.4.2.1" style="font-size:90%;">.3460 (+3.8%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.5.4.3"><span class="ltx_text ltx_font_bold" id="A1.T5.2.5.4.3.1" style="font-size:90%;">.6048 (+1.5%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.5.4.4"><span class="ltx_text ltx_font_bold" id="A1.T5.2.5.4.4.1" style="font-size:90%;">.1673 (+6.0%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.5.4.5"><span class="ltx_text" id="A1.T5.2.5.4.5.1" style="font-size:90%;">46s (+12.2%)</span></td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A1.T5.2.6.5.1" rowspan="4"><span class="ltx_text ltx_font_italic" id="A1.T5.2.6.5.1.1" style="font-size:90%;">ML-20M</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.6.5.2"><span class="ltx_text" id="A1.T5.2.6.5.2.1" style="font-size:90%;">SASRec</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.6.5.3"><span class="ltx_text" id="A1.T5.2.6.5.3.1" style="font-size:90%;">.2883</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.6.5.4"><span class="ltx_text" id="A1.T5.2.6.5.4.1" style="font-size:90%;">.5484</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.6.5.5"><span class="ltx_text" id="A1.T5.2.6.5.5.1" style="font-size:90%;">.1375</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.6.5.6"><span class="ltx_text" id="A1.T5.2.6.5.6.1" style="font-size:90%;">197s</span></td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.7.6">
<td class="ltx_td ltx_align_left" id="A1.T5.2.7.6.1"><span class="ltx_text" id="A1.T5.2.7.6.1.1" style="font-size:90%;">SASRec + MoL</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.7.6.2"><span class="ltx_text" id="A1.T5.2.7.6.2.1" style="font-size:90%;">.3124 (+8.4%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.7.6.3"><span class="ltx_text" id="A1.T5.2.7.6.3.1" style="font-size:90%;">.5685 (+3.7%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.7.6.4"><span class="ltx_text" id="A1.T5.2.7.6.4.1" style="font-size:90%;">.1551 (+12.8%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.7.6.5"><span class="ltx_text" id="A1.T5.2.7.6.5.1" style="font-size:90%;">449s (+127.9%)</span></td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.8.7">
<td class="ltx_td ltx_align_left" id="A1.T5.2.8.7.1"><span class="ltx_text" id="A1.T5.2.8.7.1.1" style="font-size:90%;">HSTU</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.8.7.2"><span class="ltx_text" id="A1.T5.2.8.7.2.1" style="font-size:90%;">.3557</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.8.7.3"><span class="ltx_text" id="A1.T5.2.8.7.3.1" style="font-size:90%;">.6146</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.8.7.4"><span class="ltx_text" id="A1.T5.2.8.7.4.1" style="font-size:90%;">.1800</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.8.7.5"><span class="ltx_text" id="A1.T5.2.8.7.5.1" style="font-size:90%;">526s</span></td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.9.8">
<td class="ltx_td ltx_align_left" id="A1.T5.2.9.8.1"><span class="ltx_text" id="A1.T5.2.9.8.1.1" style="font-size:90%;">HSTU + MoL</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.9.8.2"><span class="ltx_text ltx_font_bold" id="A1.T5.2.9.8.2.1" style="font-size:90%;">.3697 (+3.9%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.9.8.3"><span class="ltx_text ltx_font_bold" id="A1.T5.2.9.8.3.1" style="font-size:90%;">.6244 (+1.6%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.9.8.4"><span class="ltx_text ltx_font_bold" id="A1.T5.2.9.8.4.1" style="font-size:90%;">.1880 (+4.4%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.9.8.5"><span class="ltx_text" id="A1.T5.2.9.8.5.1" style="font-size:90%;">773s (+47.0%)</span></td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A1.T5.2.10.9.1" rowspan="4"><span class="ltx_text ltx_font_italic" id="A1.T5.2.10.9.1.1" style="font-size:90%;">Books</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.10.9.2"><span class="ltx_text" id="A1.T5.2.10.9.2.1" style="font-size:90%;">SASRec</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.10.9.3"><span class="ltx_text" id="A1.T5.2.10.9.3.1" style="font-size:90%;">.0306</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.10.9.4"><span class="ltx_text" id="A1.T5.2.10.9.4.1" style="font-size:90%;">.0754</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.10.9.5"><span class="ltx_text" id="A1.T5.2.10.9.5.1" style="font-size:90%;">.0153</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.10.9.6"><span class="ltx_text" id="A1.T5.2.10.9.6.1" style="font-size:90%;">506s</span></td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.11.10">
<td class="ltx_td ltx_align_left" id="A1.T5.2.11.10.1"><span class="ltx_text" id="A1.T5.2.11.10.1.1" style="font-size:90%;">SASRec + MoL</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.11.10.2"><span class="ltx_text" id="A1.T5.2.11.10.2.1" style="font-size:90%;">.0402 (+31.4%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.11.10.3"><span class="ltx_text" id="A1.T5.2.11.10.3.1" style="font-size:90%;">.0970 (+28.6%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.11.10.4"><span class="ltx_text" id="A1.T5.2.11.10.4.1" style="font-size:90%;">.0203 (+32.7%)</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.11.10.5"><span class="ltx_text" id="A1.T5.2.11.10.5.1" style="font-size:90%;">964s (+90.5%)</span></td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.12.11">
<td class="ltx_td ltx_align_left" id="A1.T5.2.12.11.1"><span class="ltx_text" id="A1.T5.2.12.11.1.1" style="font-size:90%;">HSTU</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.12.11.2"><span class="ltx_text" id="A1.T5.2.12.11.2.1" style="font-size:90%;">.0469</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.12.11.3"><span class="ltx_text" id="A1.T5.2.12.11.3.1" style="font-size:90%;">.1066</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.12.11.4"><span class="ltx_text" id="A1.T5.2.12.11.4.1" style="font-size:90%;">.0233</span></td>
<td class="ltx_td ltx_align_left" id="A1.T5.2.12.11.5"><span class="ltx_text" id="A1.T5.2.12.11.5.1" style="font-size:90%;">1883s</span></td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.13.12">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T5.2.13.12.1"><span class="ltx_text" id="A1.T5.2.13.12.1.1" style="font-size:90%;">HSTU + MoL</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T5.2.13.12.2"><span class="ltx_text ltx_font_bold" id="A1.T5.2.13.12.2.1" style="font-size:90%;">.0613 (+30.7%)</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T5.2.13.12.3"><span class="ltx_text ltx_font_bold" id="A1.T5.2.13.12.3.1" style="font-size:90%;">.1292 (+21.2%)</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T5.2.13.12.4"><span class="ltx_text ltx_font_bold" id="A1.T5.2.13.12.4.1" style="font-size:90%;">.0315 (+35.2%)</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T5.2.13.12.5"><span class="ltx_text" id="A1.T5.2.13.12.5.1" style="font-size:90%;">2236s (+18.7%)</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 5: </span>Evaluation of recommendation retrieval performance, utilizing the next-item prediction task. Note that these results are identical to those reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.T3" title="Table 3 ‣ Model. ‣ 4.1 Setup ‣ 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">3</span></a> but with relative gains (MoL vs dot product) and training cost changes illustrated under different sequential encoder backbones.</figcaption>
</figure>
<section class="ltx_paragraph" id="A1.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Training efficiency.</h4>
<div class="ltx_para" id="A1.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="A1.SS1.SSS0.Px1.p1.1">We measure the training efficiency of the setups in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4" title="4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">4</span></a> over one epoch of data, utilizing a single RTX 6000 Ada GPU and with a constant batch size of 128 for ML-1M and ML-20M, and 64 for Amazon Books in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#A1.T5" title="Table 5 ‣ A.1 Efficiency ‣ Appendix A Experiment Setups ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">5</span></a>. Consistent with prior findings <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite>, MoL’s model quality increases do not generally come with a large increase in training time, thanks to MoL’s higher arithmetic intensity on GPUs, with an average increase of 53% across the six scenarios. To contextualize this 1.53x training cost, prior work on sequential recommenders, such as self-supervised bidirectional models, came with a 5.9x training time increase on ML-20M and 4.5x training time increase on Amazon Reviews (BERT4Rec vs SASRec rows) <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib23" title="">23</a>]</cite>. We expect additional GPU kernel-level optimizations, such as kernel fusions, to further improve efficiency of the “+ MoL” rows.</p>
</div>
</section>
<section class="ltx_paragraph" id="A1.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Inference efficiency.</h4>
<div class="ltx_para" id="A1.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="A1.SS1.SSS0.Px2.p1.1">Given the number of items (3K, 24K, and 674K) in these datasets, as discussed in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#S4.T2" title="Table 2 ‣ Workloads. ‣ 4.1 Setup ‣ 4 Evaluation ‣ Efficient Retrieval with Learned Similarities"><span class="ltx_text ltx_ref_tag">2</span></a>, these public benchmark datasets are not good candidates for measuring inference latency. We note that prior work have reported batched inference latency between 5ms and 20ms on datasets with hundreds of millions to billions of items <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.15462v2#bib.bib3" title="">3</a>]</cite>, which is inline with optimized MIPS baselines.</p>
</div>
</section>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Aug 14 00:56:58 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
