<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Prompt Tuning as User Inherent Profile Inference Machine</title>
<!--Generated on Tue Aug 13 02:21:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Causal Inferences; Recommender Systems; Large Language Models; User Profile Modeling" lang="en" name="keywords"/>
<base href="/html/2408.06577v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S1" title="In Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2" title="In Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Framework</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.SS1" title="In 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Preliminary and Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.SS2" title="In 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Framework Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.SS3" title="In 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>UserIP Inference Module</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.SS4" title="In 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>UserIP Quantization Module</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.SS5" title="In 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5 </span>UserIP Feature Bank and Downstream Recommender model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.SS6" title="In 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.6 </span>Optimization Process</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3" title="In Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS1" title="In 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS2" title="In 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS3" title="In 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS4" title="In 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS5" title="In 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Overall Performance Comparison (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS6" title="In 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>Transferability Study (RQ2)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS7" title="In 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.7 </span>Hyper-parameter &amp; Ablation Studies (RQ3)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS8" title="In 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.8 </span>Case Study (RQ4)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS8.SSS1" title="In 3.8. Case Study (RQ4) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.8.1 </span>Case Study on Explainability</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS8.SSS2" title="In 3.8. Case Study (RQ4) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.8.2 </span>Case Study on Textual Noise</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS9" title="In 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.9 </span>Industrial Application Study (RQ5)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S4" title="In Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S5" title="In Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#A1" title="In Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#A1.SS1" title="In Appendix A Appendix ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Theoretical Analysis</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\pdfcolInitStack</span>
<p class="ltx_p" id="p1.2">tcb@breakable</p>
</div>
<h1 class="ltx_title ltx_title_document">Prompt Tuning as User Inherent Profile Inference Machine</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yusheng Lu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Tongji University</span><span class="ltx_text ltx_affiliation_state" id="id2.2.id2">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.4.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_state" id="id5.5.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id6.6.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:luyusheng@tongji.edu.cn">luyusheng@tongji.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhaocheng Du
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_state" id="id8.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhaochengdu@huawei.com">zhaochengdu@huawei.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiangyang Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_state" id="id11.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lixiangyang34@huawei.com">lixiangyang34@huawei.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiangyu Zhao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_state" id="id14.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:xianzhao@cityu.edu.hk">xianzhao@cityu.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Weiwen Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_state" id="id17.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id18.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:liuweiwen8@huawei.com">liuweiwen8@huawei.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yichao Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id19.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_state" id="id20.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id21.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wangyichao5@huawei.com">wangyichao5@huawei.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Huifeng Guo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id22.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_state" id="id23.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id24.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:huifeng.guo@huawei.com">huifeng.guo@huawei.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ruiming Tang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id25.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_state" id="id26.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id27.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:tangruiming@huawei.com">tangruiming@huawei.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhenhua Dong
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id28.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_state" id="id29.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id30.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:dongzhenhua@huawei.com">dongzhenhua@huawei.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yongrui Duan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id31.1.id1">Tongji University</span><span class="ltx_text ltx_affiliation_state" id="id32.2.id2">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id33.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yrduan@tongji.edu.cn">yrduan@tongji.edu.cn</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id34.id1">Large Language Models (LLMs) have exhibited significant promise in recommender systems by empowering user profiles with their extensive world knowledge and superior reasoning capabilities.
However, LLMs face challenges like unstable instruction compliance, modality gaps, and high inference latency, leading to textual noise and limiting their effectiveness in recommender systems.
To address these challenges, we propose UserIP-Tuning, which uses prompt-tuning to infer user profiles. It integrates the causal relationship between user profiles and behavior sequences into LLMs‘ prompts. And employs expectation maximization to infer the embedded latent profile, minimizing textual noise by fixing the prompt template.
Furthermore, A profile quantization codebook bridges the modality gap by categorizing profile embeddings into collaborative IDs, which are pre-stored for online deployment. This improves time efficiency and reduces memory usage.
Experiments on four public datasets show that UserIP-Tuning outperforms state-of-the-art recommendation algorithms. Additional tests and case studies confirm its effectiveness, robustness, and transferability.</p>
</div>
<div class="ltx_keywords">Causal Inferences; Recommender Systems; Large Language Models; User Profile Modeling
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings
of Make sure to enter the correct conference title from your rights confirmation emai (Conference acronym ’XX).;  printacmref=true</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="632" id="S1.F1.g1" src="x1.png" width="706"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Example of inferring user latent profiles with LLMs based on observable behaviors. Blue lines indicate informative profiles, while white lines represent noise in the recommender task.</figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommender systems suggest items based on users’ historical records and preferences <cite class="ltx_cite ltx_citemacro_citep">(Luo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib22" title="">2023</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib17" title="">2023b</a>; Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib9" title="">2023</a>; Luo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib22" title="">2023</a>)</cite>, helping manage information overload and boosting platform performance. However, these systems often lack users’ latent profiles—user’s underlying motivations behind behaviors—due to privacy concerns or these profiles’ abstract nature <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib44" title="">2022</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib36" title="">2020</a>)</cite>. For instance, family backgrounds and career information are frequently missing or hard to quantify. For example, a survey <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib44" title="">2022</a>)</cite> illustrated that only 40% of Facebook users disclose career details. Without these profiles, recommendation features cannot fully represent users. And inferring latent profiles accurately could significantly improve recommendation precision.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">With the superior reasoning capabilities and extensive world knowledge <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib29" title="">2023a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib30" title="">b</a>; Izacard et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib11" title="">2023</a>; De Santis et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib6" title="">2024</a>)</cite>, Large Language Models (LLMs) offer a promising solution for inferring user latent profiles based on observable behaviors.
For example, by analyzing user-purchased luxury items (Fig.<a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">1</span></a>
), LLMs can infer quantifiable latent profiles like ”career success” and ”social status,” which can be used as user feature to improve recommendation system performance.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Significant efforts have been made to enhance recommender systems using LLMs’s reasoning capability. <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib44" title="">2022</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib39" title="">2022</a>; Min et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib23" title="">2022</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib34" title="">2023</a>)</cite>. For instance, KAR <cite class="ltx_cite ltx_citemacro_citep">(Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib37" title="">2023</a>)</cite> strategically designs prompts to activate LLMs’ profile inference abilities. The inferred text is then embedded using BERT <cite class="ltx_cite ltx_citemacro_citep">(Kenton and Toutanova, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib13" title="">2019</a>)</cite> and deployed online. Similarly, LFM <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib34" title="">2023</a>)</cite> employs LLMs to generate text-based user profiles from interaction histories, which subsequently inform the context for LLM-based recommendation tasks.
However, these methods encounter nonnegligible theoretical and practical challenges:</p>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="559" id="S1.F2.g1" src="x2.png" width="706"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Users’ latent profile and observed behavior.</figcaption>
</figure>
<div class="ltx_para" id="S1.p4">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1)</span>
<div class="ltx_para" id="S1.I1.ix1.p1">
<p class="ltx_p" id="S1.I1.ix1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.ix1.p1.1.1">Twisted Causality:</span> LLMs are autoregressive where prior words are causes of subsequent ones <cite class="ltx_cite ltx_citemacro_citep">(Lester et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib14" title="">2021</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib39" title="">2022</a>)</cite>. Since Recommendation tasks traditionally view user profiles as causes of interactions (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S1.F2" title="Figure 2 ‣ 1. Introduction ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">2</span></a>). When translated to autoregressive sequence, latent profiles should precede and influence interactions. However, existing methods reverse this.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2)</span>
<div class="ltx_para" id="S1.I1.ix2.p1">
<p class="ltx_p" id="S1.I1.ix2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.ix2.p1.1.1">Textual Noise:</span> LLM’s instable instruct following issue <cite class="ltx_cite ltx_citemacro_citep">(Taori et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib28" title="">2023</a>; Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib30" title="">2023b</a>; Dubois et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib7" title="">2024</a>)</cite> and its Chain-of-Thought (CoT) reasoning <cite class="ltx_cite ltx_citemacro_citep">(Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib35" title="">2022</a>)</cite> often fill inferred latent profile with textual noise <cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib3" title="">2023</a>; Tan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib27" title="">2023</a>)</cite>, (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">1</span></a>). Positioning targeted profiles within a tunable prompt could help focus and refine the inferred profile information.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.ix3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3)</span>
<div class="ltx_para" id="S1.I1.ix3.p1">
<p class="ltx_p" id="S1.I1.ix3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.ix3.p1.1.1">Modality Gap:</span> The complex syntax and semantics embedded in language model outputs are often too intricate for recommendation systems to effectively learn, potentially impairing performance <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib42" title="">2023</a>; Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib2" title="">2023</a>)</cite>. Designing modules to filter and extract useful collaborative signals from these embeddings is essential.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.ix4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4)</span>
<div class="ltx_para" id="S1.I1.ix4.p1">
<p class="ltx_p" id="S1.I1.ix4.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.ix4.p1.1.1">Reasoning Inefficiency:</span> Billion parameters’ LLMs challenge the low-latency requirements of online recommender systems. Large text embeddings increase the computational load too. Exploring the conversion of these embeddings into simpler, sparse features like ”gender” or ”race” could help.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S1.p4.1">Motivated by the outlined challenges and inspired by recent advancements in soft-prompt tuning techniques <cite class="ltx_cite ltx_citemacro_citep">(Lester et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib14" title="">2021</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib15" title="">2023d</a>)</cite>, we propose the <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">User</span> <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">I</span>nherent <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">P</span>rofile inference with prompt <span class="ltx_text ltx_font_bold" id="S1.p4.1.4">Tuning</span> (UserIP-Tuning) framework. This framework is lightweight, controllable, and easily integrated with any recommendation model. It consists of three key sub-modules: UserIP inference, UserIP quantization, and a pre-stored UserIP feature bank.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To address the first two challenges, the UserIP inference module treats user latent profiles as trainable soft tokens within a prompt template. This prompt is designed to elicit accurate user behavior sequences from LLMs. The soft tokens are inferred using the Expectation Maximization (EM) algorithm, which maximizes the likelihood of these sequences based on a frozen LLM’s distribution.
For the remaining two challenges, the UserIP quantization module converts trained soft tokens into sparse feature IDs using a trainable codebook. These IDs, which share similar semantic information, function like traditional sparse features and are stored in a latent feature bank for online deployment. Experiments on four datasets confirm the effectiveness of the UserIP-Tuning framework. The main contributions are summarized as follows:
</p>
</div>
<div class="ltx_para" id="S1.p6">
<ul class="ltx_itemize" id="S1.I2">
<li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i1.p1">
<p class="ltx_p" id="S1.I2.i1.p1.1">UserIP-inference module is the first LLM soft-prompt-based user profile inference algorithm that can improve profile inference’s causality and avoid textual noises.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i2.p1">
<p class="ltx_p" id="S1.I2.i2.p1.1">The proposed UserIP-tuning framework is efficient and model-agnostic. It can improve recommendation models’ performance with guaranteed inference efficiency.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i3.p1">
<p class="ltx_p" id="S1.I2.i3.p1.1">Extensive experiments are conducted on both public and industrial datasets to validate the advantages of UserIP-Tuning’s effectiveness, efficiency, generalizability, and explainability.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Framework</h2>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="277" id="S2.F3.g1" src="x3.png" width="813"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Overview of the UserIP-Tuning framework. Here, two user latent profiles are illustrated: hobby, income background. UserIP-Tuning consists of a UserIP inference module, a UserIP quantization module and a pre-stored UserIP feature bank.</figcaption>
</figure>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">This section presents the technical details of the UserIP-Tuning framework. First, the problem setting and preliminary are described.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Preliminary and Setup</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.3">Learning a recommendation model can be viewed as learning a mapping function <math alttext="f" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_f</annotation></semantics></math> that maps a set of descriptive feature sets <math alttext="E" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_E</annotation></semantics></math> to the recommendation target <math alttext="y^{rec}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><msup id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">y</mi><mrow id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml"><mi id="S2.SS1.p1.3.m3.1.1.3.2" xref="S2.SS1.p1.3.m3.1.1.3.2.cmml">r</mi><mo id="S2.SS1.p1.3.m3.1.1.3.1" xref="S2.SS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.3.m3.1.1.3.3" xref="S2.SS1.p1.3.m3.1.1.3.3.cmml">e</mi><mo id="S2.SS1.p1.3.m3.1.1.3.1a" xref="S2.SS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.3.m3.1.1.3.4" xref="S2.SS1.p1.3.m3.1.1.3.4.cmml">c</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝑦</ci><apply id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3"><times id="S2.SS1.p1.3.m3.1.1.3.1.cmml" xref="S2.SS1.p1.3.m3.1.1.3.1"></times><ci id="S2.SS1.p1.3.m3.1.1.3.2.cmml" xref="S2.SS1.p1.3.m3.1.1.3.2">𝑟</ci><ci id="S2.SS1.p1.3.m3.1.1.3.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3.3">𝑒</ci><ci id="S2.SS1.p1.3.m3.1.1.3.4.cmml" xref="S2.SS1.p1.3.m3.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">y^{rec}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT</annotation></semantics></math> as shown in the formula below:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small y^{rec}=f(E)" class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.2" xref="S2.E1.m1.1.2.cmml"><msup id="S2.E1.m1.1.2.2" xref="S2.E1.m1.1.2.2.cmml"><mi id="S2.E1.m1.1.2.2.2" mathsize="90%" xref="S2.E1.m1.1.2.2.2.cmml">y</mi><mrow id="S2.E1.m1.1.2.2.3" xref="S2.E1.m1.1.2.2.3.cmml"><mi id="S2.E1.m1.1.2.2.3.2" mathsize="90%" xref="S2.E1.m1.1.2.2.3.2.cmml">r</mi><mo id="S2.E1.m1.1.2.2.3.1" xref="S2.E1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.1.2.2.3.3" mathsize="90%" xref="S2.E1.m1.1.2.2.3.3.cmml">e</mi><mo id="S2.E1.m1.1.2.2.3.1a" xref="S2.E1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.1.2.2.3.4" mathsize="90%" xref="S2.E1.m1.1.2.2.3.4.cmml">c</mi></mrow></msup><mo id="S2.E1.m1.1.2.1" mathsize="90%" xref="S2.E1.m1.1.2.1.cmml">=</mo><mrow id="S2.E1.m1.1.2.3" xref="S2.E1.m1.1.2.3.cmml"><mi id="S2.E1.m1.1.2.3.2" mathsize="90%" xref="S2.E1.m1.1.2.3.2.cmml">f</mi><mo id="S2.E1.m1.1.2.3.1" xref="S2.E1.m1.1.2.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.1.2.3.3.2" xref="S2.E1.m1.1.2.3.cmml"><mo id="S2.E1.m1.1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="S2.E1.m1.1.2.3.cmml">(</mo><mi id="S2.E1.m1.1.1" mathsize="90%" xref="S2.E1.m1.1.1.cmml">E</mi><mo id="S2.E1.m1.1.2.3.3.2.2" maxsize="90%" minsize="90%" xref="S2.E1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.2.cmml" xref="S2.E1.m1.1.2"><eq id="S2.E1.m1.1.2.1.cmml" xref="S2.E1.m1.1.2.1"></eq><apply id="S2.E1.m1.1.2.2.cmml" xref="S2.E1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.2.2.1.cmml" xref="S2.E1.m1.1.2.2">superscript</csymbol><ci id="S2.E1.m1.1.2.2.2.cmml" xref="S2.E1.m1.1.2.2.2">𝑦</ci><apply id="S2.E1.m1.1.2.2.3.cmml" xref="S2.E1.m1.1.2.2.3"><times id="S2.E1.m1.1.2.2.3.1.cmml" xref="S2.E1.m1.1.2.2.3.1"></times><ci id="S2.E1.m1.1.2.2.3.2.cmml" xref="S2.E1.m1.1.2.2.3.2">𝑟</ci><ci id="S2.E1.m1.1.2.2.3.3.cmml" xref="S2.E1.m1.1.2.2.3.3">𝑒</ci><ci id="S2.E1.m1.1.2.2.3.4.cmml" xref="S2.E1.m1.1.2.2.3.4">𝑐</ci></apply></apply><apply id="S2.E1.m1.1.2.3.cmml" xref="S2.E1.m1.1.2.3"><times id="S2.E1.m1.1.2.3.1.cmml" xref="S2.E1.m1.1.2.3.1"></times><ci id="S2.E1.m1.1.2.3.2.cmml" xref="S2.E1.m1.1.2.3.2">𝑓</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\small y^{rec}=f(E)</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT = italic_f ( italic_E )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.6">Typically, the descriptive feature set <math alttext="E" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m1.1"><semantics id="S2.SS1.p1.4.m1.1a"><mi id="S2.SS1.p1.4.m1.1.1" xref="S2.SS1.p1.4.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m1.1b"><ci id="S2.SS1.p1.4.m1.1.1.cmml" xref="S2.SS1.p1.4.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m1.1d">italic_E</annotation></semantics></math>, including observable features like gender or age (<math alttext="E_{obs}" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m2.1"><semantics id="S2.SS1.p1.5.m2.1a"><msub id="S2.SS1.p1.5.m2.1.1" xref="S2.SS1.p1.5.m2.1.1.cmml"><mi id="S2.SS1.p1.5.m2.1.1.2" xref="S2.SS1.p1.5.m2.1.1.2.cmml">E</mi><mrow id="S2.SS1.p1.5.m2.1.1.3" xref="S2.SS1.p1.5.m2.1.1.3.cmml"><mi id="S2.SS1.p1.5.m2.1.1.3.2" xref="S2.SS1.p1.5.m2.1.1.3.2.cmml">o</mi><mo id="S2.SS1.p1.5.m2.1.1.3.1" xref="S2.SS1.p1.5.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.5.m2.1.1.3.3" xref="S2.SS1.p1.5.m2.1.1.3.3.cmml">b</mi><mo id="S2.SS1.p1.5.m2.1.1.3.1a" xref="S2.SS1.p1.5.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.5.m2.1.1.3.4" xref="S2.SS1.p1.5.m2.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m2.1b"><apply id="S2.SS1.p1.5.m2.1.1.cmml" xref="S2.SS1.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m2.1.1.1.cmml" xref="S2.SS1.p1.5.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m2.1.1.2.cmml" xref="S2.SS1.p1.5.m2.1.1.2">𝐸</ci><apply id="S2.SS1.p1.5.m2.1.1.3.cmml" xref="S2.SS1.p1.5.m2.1.1.3"><times id="S2.SS1.p1.5.m2.1.1.3.1.cmml" xref="S2.SS1.p1.5.m2.1.1.3.1"></times><ci id="S2.SS1.p1.5.m2.1.1.3.2.cmml" xref="S2.SS1.p1.5.m2.1.1.3.2">𝑜</ci><ci id="S2.SS1.p1.5.m2.1.1.3.3.cmml" xref="S2.SS1.p1.5.m2.1.1.3.3">𝑏</ci><ci id="S2.SS1.p1.5.m2.1.1.3.4.cmml" xref="S2.SS1.p1.5.m2.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m2.1c">E_{obs}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m2.1d">italic_E start_POSTSUBSCRIPT italic_o italic_b italic_s end_POSTSUBSCRIPT</annotation></semantics></math>), is derived from log system information. However, unobservable user latent profiles (<math alttext="E_{latent}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m3.1"><semantics id="S2.SS1.p1.6.m3.1a"><msub id="S2.SS1.p1.6.m3.1.1" xref="S2.SS1.p1.6.m3.1.1.cmml"><mi id="S2.SS1.p1.6.m3.1.1.2" xref="S2.SS1.p1.6.m3.1.1.2.cmml">E</mi><mrow id="S2.SS1.p1.6.m3.1.1.3" xref="S2.SS1.p1.6.m3.1.1.3.cmml"><mi id="S2.SS1.p1.6.m3.1.1.3.2" xref="S2.SS1.p1.6.m3.1.1.3.2.cmml">l</mi><mo id="S2.SS1.p1.6.m3.1.1.3.1" xref="S2.SS1.p1.6.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.6.m3.1.1.3.3" xref="S2.SS1.p1.6.m3.1.1.3.3.cmml">a</mi><mo id="S2.SS1.p1.6.m3.1.1.3.1a" xref="S2.SS1.p1.6.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.6.m3.1.1.3.4" xref="S2.SS1.p1.6.m3.1.1.3.4.cmml">t</mi><mo id="S2.SS1.p1.6.m3.1.1.3.1b" xref="S2.SS1.p1.6.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.6.m3.1.1.3.5" xref="S2.SS1.p1.6.m3.1.1.3.5.cmml">e</mi><mo id="S2.SS1.p1.6.m3.1.1.3.1c" xref="S2.SS1.p1.6.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.6.m3.1.1.3.6" xref="S2.SS1.p1.6.m3.1.1.3.6.cmml">n</mi><mo id="S2.SS1.p1.6.m3.1.1.3.1d" xref="S2.SS1.p1.6.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.6.m3.1.1.3.7" xref="S2.SS1.p1.6.m3.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m3.1b"><apply id="S2.SS1.p1.6.m3.1.1.cmml" xref="S2.SS1.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m3.1.1.1.cmml" xref="S2.SS1.p1.6.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m3.1.1.2.cmml" xref="S2.SS1.p1.6.m3.1.1.2">𝐸</ci><apply id="S2.SS1.p1.6.m3.1.1.3.cmml" xref="S2.SS1.p1.6.m3.1.1.3"><times id="S2.SS1.p1.6.m3.1.1.3.1.cmml" xref="S2.SS1.p1.6.m3.1.1.3.1"></times><ci id="S2.SS1.p1.6.m3.1.1.3.2.cmml" xref="S2.SS1.p1.6.m3.1.1.3.2">𝑙</ci><ci id="S2.SS1.p1.6.m3.1.1.3.3.cmml" xref="S2.SS1.p1.6.m3.1.1.3.3">𝑎</ci><ci id="S2.SS1.p1.6.m3.1.1.3.4.cmml" xref="S2.SS1.p1.6.m3.1.1.3.4">𝑡</ci><ci id="S2.SS1.p1.6.m3.1.1.3.5.cmml" xref="S2.SS1.p1.6.m3.1.1.3.5">𝑒</ci><ci id="S2.SS1.p1.6.m3.1.1.3.6.cmml" xref="S2.SS1.p1.6.m3.1.1.3.6">𝑛</ci><ci id="S2.SS1.p1.6.m3.1.1.3.7.cmml" xref="S2.SS1.p1.6.m3.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m3.1c">E_{latent}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m3.1d">italic_E start_POSTSUBSCRIPT italic_l italic_a italic_t italic_e italic_n italic_t end_POSTSUBSCRIPT</annotation></semantics></math>), such as family background or personal characteristics, are often missing due to privacy concerns or their abstract nature.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.4">Same as <math alttext="E_{obs}" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><msub id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml">E</mi><mrow id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml"><mi id="S2.SS1.p2.1.m1.1.1.3.2" xref="S2.SS1.p2.1.m1.1.1.3.2.cmml">o</mi><mo id="S2.SS1.p2.1.m1.1.1.3.1" xref="S2.SS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.1.m1.1.1.3.3" xref="S2.SS1.p2.1.m1.1.1.3.3.cmml">b</mi><mo id="S2.SS1.p2.1.m1.1.1.3.1a" xref="S2.SS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.1.m1.1.1.3.4" xref="S2.SS1.p2.1.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2">𝐸</ci><apply id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3"><times id="S2.SS1.p2.1.m1.1.1.3.1.cmml" xref="S2.SS1.p2.1.m1.1.1.3.1"></times><ci id="S2.SS1.p2.1.m1.1.1.3.2.cmml" xref="S2.SS1.p2.1.m1.1.1.3.2">𝑜</ci><ci id="S2.SS1.p2.1.m1.1.1.3.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3.3">𝑏</ci><ci id="S2.SS1.p2.1.m1.1.1.3.4.cmml" xref="S2.SS1.p2.1.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">E_{obs}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_E start_POSTSUBSCRIPT italic_o italic_b italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="E_{latent}" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><msub id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.1.1.2" xref="S2.SS1.p2.2.m2.1.1.2.cmml">E</mi><mrow id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3.cmml"><mi id="S2.SS1.p2.2.m2.1.1.3.2" xref="S2.SS1.p2.2.m2.1.1.3.2.cmml">l</mi><mo id="S2.SS1.p2.2.m2.1.1.3.1" xref="S2.SS1.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.2.m2.1.1.3.3" xref="S2.SS1.p2.2.m2.1.1.3.3.cmml">a</mi><mo id="S2.SS1.p2.2.m2.1.1.3.1a" xref="S2.SS1.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.2.m2.1.1.3.4" xref="S2.SS1.p2.2.m2.1.1.3.4.cmml">t</mi><mo id="S2.SS1.p2.2.m2.1.1.3.1b" xref="S2.SS1.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.2.m2.1.1.3.5" xref="S2.SS1.p2.2.m2.1.1.3.5.cmml">e</mi><mo id="S2.SS1.p2.2.m2.1.1.3.1c" xref="S2.SS1.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.2.m2.1.1.3.6" xref="S2.SS1.p2.2.m2.1.1.3.6.cmml">n</mi><mo id="S2.SS1.p2.2.m2.1.1.3.1d" xref="S2.SS1.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.2.m2.1.1.3.7" xref="S2.SS1.p2.2.m2.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2">𝐸</ci><apply id="S2.SS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3"><times id="S2.SS1.p2.2.m2.1.1.3.1.cmml" xref="S2.SS1.p2.2.m2.1.1.3.1"></times><ci id="S2.SS1.p2.2.m2.1.1.3.2.cmml" xref="S2.SS1.p2.2.m2.1.1.3.2">𝑙</ci><ci id="S2.SS1.p2.2.m2.1.1.3.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3.3">𝑎</ci><ci id="S2.SS1.p2.2.m2.1.1.3.4.cmml" xref="S2.SS1.p2.2.m2.1.1.3.4">𝑡</ci><ci id="S2.SS1.p2.2.m2.1.1.3.5.cmml" xref="S2.SS1.p2.2.m2.1.1.3.5">𝑒</ci><ci id="S2.SS1.p2.2.m2.1.1.3.6.cmml" xref="S2.SS1.p2.2.m2.1.1.3.6">𝑛</ci><ci id="S2.SS1.p2.2.m2.1.1.3.7.cmml" xref="S2.SS1.p2.2.m2.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">E_{latent}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_E start_POSTSUBSCRIPT italic_l italic_a italic_t italic_e italic_n italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the cause of user behaviors. The causal relationship is demonstrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S1.F2" title="Figure 2 ‣ 1. Introduction ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">2</span></a>. A wealthy family (latent profile) is generally more willing to buy luxury items while a music lover (latent profile) may collect many instruments. Mathematically, we represent <math alttext="E_{latent}" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><msub id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml"><mi id="S2.SS1.p2.3.m3.1.1.2" xref="S2.SS1.p2.3.m3.1.1.2.cmml">E</mi><mrow id="S2.SS1.p2.3.m3.1.1.3" xref="S2.SS1.p2.3.m3.1.1.3.cmml"><mi id="S2.SS1.p2.3.m3.1.1.3.2" xref="S2.SS1.p2.3.m3.1.1.3.2.cmml">l</mi><mo id="S2.SS1.p2.3.m3.1.1.3.1" xref="S2.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.3.m3.1.1.3.3" xref="S2.SS1.p2.3.m3.1.1.3.3.cmml">a</mi><mo id="S2.SS1.p2.3.m3.1.1.3.1a" xref="S2.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.3.m3.1.1.3.4" xref="S2.SS1.p2.3.m3.1.1.3.4.cmml">t</mi><mo id="S2.SS1.p2.3.m3.1.1.3.1b" xref="S2.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.3.m3.1.1.3.5" xref="S2.SS1.p2.3.m3.1.1.3.5.cmml">e</mi><mo id="S2.SS1.p2.3.m3.1.1.3.1c" xref="S2.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.3.m3.1.1.3.6" xref="S2.SS1.p2.3.m3.1.1.3.6.cmml">n</mi><mo id="S2.SS1.p2.3.m3.1.1.3.1d" xref="S2.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.3.m3.1.1.3.7" xref="S2.SS1.p2.3.m3.1.1.3.7.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.2">𝐸</ci><apply id="S2.SS1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3"><times id="S2.SS1.p2.3.m3.1.1.3.1.cmml" xref="S2.SS1.p2.3.m3.1.1.3.1"></times><ci id="S2.SS1.p2.3.m3.1.1.3.2.cmml" xref="S2.SS1.p2.3.m3.1.1.3.2">𝑙</ci><ci id="S2.SS1.p2.3.m3.1.1.3.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3.3">𝑎</ci><ci id="S2.SS1.p2.3.m3.1.1.3.4.cmml" xref="S2.SS1.p2.3.m3.1.1.3.4">𝑡</ci><ci id="S2.SS1.p2.3.m3.1.1.3.5.cmml" xref="S2.SS1.p2.3.m3.1.1.3.5">𝑒</ci><ci id="S2.SS1.p2.3.m3.1.1.3.6.cmml" xref="S2.SS1.p2.3.m3.1.1.3.6">𝑛</ci><ci id="S2.SS1.p2.3.m3.1.1.3.7.cmml" xref="S2.SS1.p2.3.m3.1.1.3.7">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">E_{latent}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_E start_POSTSUBSCRIPT italic_l italic_a italic_t italic_e italic_n italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as a set of trainable soft tokens <math alttext="{\theta^{1},\theta^{2},...,\theta^{M}}" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.4"><semantics id="S2.SS1.p2.4.m4.4a"><mrow id="S2.SS1.p2.4.m4.4.4.3" xref="S2.SS1.p2.4.m4.4.4.4.cmml"><msup id="S2.SS1.p2.4.m4.2.2.1.1" xref="S2.SS1.p2.4.m4.2.2.1.1.cmml"><mi id="S2.SS1.p2.4.m4.2.2.1.1.2" xref="S2.SS1.p2.4.m4.2.2.1.1.2.cmml">θ</mi><mn id="S2.SS1.p2.4.m4.2.2.1.1.3" xref="S2.SS1.p2.4.m4.2.2.1.1.3.cmml">1</mn></msup><mo id="S2.SS1.p2.4.m4.4.4.3.4" xref="S2.SS1.p2.4.m4.4.4.4.cmml">,</mo><msup id="S2.SS1.p2.4.m4.3.3.2.2" xref="S2.SS1.p2.4.m4.3.3.2.2.cmml"><mi id="S2.SS1.p2.4.m4.3.3.2.2.2" xref="S2.SS1.p2.4.m4.3.3.2.2.2.cmml">θ</mi><mn id="S2.SS1.p2.4.m4.3.3.2.2.3" xref="S2.SS1.p2.4.m4.3.3.2.2.3.cmml">2</mn></msup><mo id="S2.SS1.p2.4.m4.4.4.3.5" xref="S2.SS1.p2.4.m4.4.4.4.cmml">,</mo><mi id="S2.SS1.p2.4.m4.1.1" mathvariant="normal" xref="S2.SS1.p2.4.m4.1.1.cmml">…</mi><mo id="S2.SS1.p2.4.m4.4.4.3.6" xref="S2.SS1.p2.4.m4.4.4.4.cmml">,</mo><msup id="S2.SS1.p2.4.m4.4.4.3.3" xref="S2.SS1.p2.4.m4.4.4.3.3.cmml"><mi id="S2.SS1.p2.4.m4.4.4.3.3.2" xref="S2.SS1.p2.4.m4.4.4.3.3.2.cmml">θ</mi><mi id="S2.SS1.p2.4.m4.4.4.3.3.3" xref="S2.SS1.p2.4.m4.4.4.3.3.3.cmml">M</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.4b"><list id="S2.SS1.p2.4.m4.4.4.4.cmml" xref="S2.SS1.p2.4.m4.4.4.3"><apply id="S2.SS1.p2.4.m4.2.2.1.1.cmml" xref="S2.SS1.p2.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.2.2.1.1.1.cmml" xref="S2.SS1.p2.4.m4.2.2.1.1">superscript</csymbol><ci id="S2.SS1.p2.4.m4.2.2.1.1.2.cmml" xref="S2.SS1.p2.4.m4.2.2.1.1.2">𝜃</ci><cn id="S2.SS1.p2.4.m4.2.2.1.1.3.cmml" type="integer" xref="S2.SS1.p2.4.m4.2.2.1.1.3">1</cn></apply><apply id="S2.SS1.p2.4.m4.3.3.2.2.cmml" xref="S2.SS1.p2.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.3.3.2.2.1.cmml" xref="S2.SS1.p2.4.m4.3.3.2.2">superscript</csymbol><ci id="S2.SS1.p2.4.m4.3.3.2.2.2.cmml" xref="S2.SS1.p2.4.m4.3.3.2.2.2">𝜃</ci><cn id="S2.SS1.p2.4.m4.3.3.2.2.3.cmml" type="integer" xref="S2.SS1.p2.4.m4.3.3.2.2.3">2</cn></apply><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">…</ci><apply id="S2.SS1.p2.4.m4.4.4.3.3.cmml" xref="S2.SS1.p2.4.m4.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.4.4.3.3.1.cmml" xref="S2.SS1.p2.4.m4.4.4.3.3">superscript</csymbol><ci id="S2.SS1.p2.4.m4.4.4.3.3.2.cmml" xref="S2.SS1.p2.4.m4.4.4.3.3.2">𝜃</ci><ci id="S2.SS1.p2.4.m4.4.4.3.3.3.cmml" xref="S2.SS1.p2.4.m4.4.4.3.3.3">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.4c">{\theta^{1},\theta^{2},...,\theta^{M}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.4d">italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> where each token represents a unique latent profile variable. Then this problem becomes an inference problem of finding the best latent variable set to maximize the likelihood of observed user behavior,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small E_{latent}=argmax_{\theta}P_{\phi}(y^{rec}|\theta^{1},\theta^{2},...,%
\theta^{M})" class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml"><msub id="S2.E2.m1.2.2.3" xref="S2.E2.m1.2.2.3.cmml"><mi id="S2.E2.m1.2.2.3.2" mathsize="90%" xref="S2.E2.m1.2.2.3.2.cmml">E</mi><mrow id="S2.E2.m1.2.2.3.3" xref="S2.E2.m1.2.2.3.3.cmml"><mi id="S2.E2.m1.2.2.3.3.2" mathsize="90%" xref="S2.E2.m1.2.2.3.3.2.cmml">l</mi><mo id="S2.E2.m1.2.2.3.3.1" xref="S2.E2.m1.2.2.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.3.3.3" mathsize="90%" xref="S2.E2.m1.2.2.3.3.3.cmml">a</mi><mo id="S2.E2.m1.2.2.3.3.1a" xref="S2.E2.m1.2.2.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.3.3.4" mathsize="90%" xref="S2.E2.m1.2.2.3.3.4.cmml">t</mi><mo id="S2.E2.m1.2.2.3.3.1b" xref="S2.E2.m1.2.2.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.3.3.5" mathsize="90%" xref="S2.E2.m1.2.2.3.3.5.cmml">e</mi><mo id="S2.E2.m1.2.2.3.3.1c" xref="S2.E2.m1.2.2.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.3.3.6" mathsize="90%" xref="S2.E2.m1.2.2.3.3.6.cmml">n</mi><mo id="S2.E2.m1.2.2.3.3.1d" xref="S2.E2.m1.2.2.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.3.3.7" mathsize="90%" xref="S2.E2.m1.2.2.3.3.7.cmml">t</mi></mrow></msub><mo id="S2.E2.m1.2.2.2" mathsize="90%" xref="S2.E2.m1.2.2.2.cmml">=</mo><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.cmml"><mi id="S2.E2.m1.2.2.1.3" mathsize="90%" xref="S2.E2.m1.2.2.1.3.cmml">a</mi><mo id="S2.E2.m1.2.2.1.2" xref="S2.E2.m1.2.2.1.2.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.4" mathsize="90%" xref="S2.E2.m1.2.2.1.4.cmml">r</mi><mo id="S2.E2.m1.2.2.1.2a" xref="S2.E2.m1.2.2.1.2.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.5" mathsize="90%" xref="S2.E2.m1.2.2.1.5.cmml">g</mi><mo id="S2.E2.m1.2.2.1.2b" xref="S2.E2.m1.2.2.1.2.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.6" mathsize="90%" xref="S2.E2.m1.2.2.1.6.cmml">m</mi><mo id="S2.E2.m1.2.2.1.2c" xref="S2.E2.m1.2.2.1.2.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.7" mathsize="90%" xref="S2.E2.m1.2.2.1.7.cmml">a</mi><mo id="S2.E2.m1.2.2.1.2d" xref="S2.E2.m1.2.2.1.2.cmml">⁢</mo><msub id="S2.E2.m1.2.2.1.8" xref="S2.E2.m1.2.2.1.8.cmml"><mi id="S2.E2.m1.2.2.1.8.2" mathsize="90%" xref="S2.E2.m1.2.2.1.8.2.cmml">x</mi><mi id="S2.E2.m1.2.2.1.8.3" mathsize="90%" xref="S2.E2.m1.2.2.1.8.3.cmml">θ</mi></msub><mo id="S2.E2.m1.2.2.1.2e" xref="S2.E2.m1.2.2.1.2.cmml">⁢</mo><msub id="S2.E2.m1.2.2.1.9" xref="S2.E2.m1.2.2.1.9.cmml"><mi id="S2.E2.m1.2.2.1.9.2" mathsize="90%" xref="S2.E2.m1.2.2.1.9.2.cmml">P</mi><mi id="S2.E2.m1.2.2.1.9.3" mathsize="90%" xref="S2.E2.m1.2.2.1.9.3.cmml">ϕ</mi></msub><mo id="S2.E2.m1.2.2.1.2f" xref="S2.E2.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.cmml"><msup id="S2.E2.m1.2.2.1.1.1.1.5" xref="S2.E2.m1.2.2.1.1.1.1.5.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.5.2" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.5.2.cmml">y</mi><mrow id="S2.E2.m1.2.2.1.1.1.1.5.3" xref="S2.E2.m1.2.2.1.1.1.1.5.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.5.3.2" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.5.3.2.cmml">r</mi><mo id="S2.E2.m1.2.2.1.1.1.1.5.3.1" xref="S2.E2.m1.2.2.1.1.1.1.5.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.1.1.5.3.3" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.5.3.3.cmml">e</mi><mo id="S2.E2.m1.2.2.1.1.1.1.5.3.1a" xref="S2.E2.m1.2.2.1.1.1.1.5.3.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.1.1.1.1.5.3.4" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.5.3.4.cmml">c</mi></mrow></msup><mo fence="false" id="S2.E2.m1.2.2.1.1.1.1.4" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.4.cmml">|</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.3.3" xref="S2.E2.m1.2.2.1.1.1.1.3.4.cmml"><msup id="S2.E2.m1.2.2.1.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.2" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml">θ</mi><mn id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.E2.m1.2.2.1.1.1.1.3.3.4" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.3.4.cmml">,</mo><msup id="S2.E2.m1.2.2.1.1.1.1.2.2.2" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.2.2.2.2" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2.2.cmml">θ</mi><mn id="S2.E2.m1.2.2.1.1.1.1.2.2.2.3" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2.3.cmml">2</mn></msup><mo id="S2.E2.m1.2.2.1.1.1.1.3.3.5" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.3.4.cmml">,</mo><mi id="S2.E2.m1.1.1" mathsize="90%" mathvariant="normal" xref="S2.E2.m1.1.1.cmml">…</mi><mo id="S2.E2.m1.2.2.1.1.1.1.3.3.6" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.3.4.cmml">,</mo><msup id="S2.E2.m1.2.2.1.1.1.1.3.3.3" xref="S2.E2.m1.2.2.1.1.1.1.3.3.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.3.3.3.2" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.3.3.3.2.cmml">θ</mi><mi id="S2.E2.m1.2.2.1.1.1.1.3.3.3.3" mathsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.3.3.3.3.cmml">M</mi></msup></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.E2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2"><eq id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"></eq><apply id="S2.E2.m1.2.2.3.cmml" xref="S2.E2.m1.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.3.1.cmml" xref="S2.E2.m1.2.2.3">subscript</csymbol><ci id="S2.E2.m1.2.2.3.2.cmml" xref="S2.E2.m1.2.2.3.2">𝐸</ci><apply id="S2.E2.m1.2.2.3.3.cmml" xref="S2.E2.m1.2.2.3.3"><times id="S2.E2.m1.2.2.3.3.1.cmml" xref="S2.E2.m1.2.2.3.3.1"></times><ci id="S2.E2.m1.2.2.3.3.2.cmml" xref="S2.E2.m1.2.2.3.3.2">𝑙</ci><ci id="S2.E2.m1.2.2.3.3.3.cmml" xref="S2.E2.m1.2.2.3.3.3">𝑎</ci><ci id="S2.E2.m1.2.2.3.3.4.cmml" xref="S2.E2.m1.2.2.3.3.4">𝑡</ci><ci id="S2.E2.m1.2.2.3.3.5.cmml" xref="S2.E2.m1.2.2.3.3.5">𝑒</ci><ci id="S2.E2.m1.2.2.3.3.6.cmml" xref="S2.E2.m1.2.2.3.3.6">𝑛</ci><ci id="S2.E2.m1.2.2.3.3.7.cmml" xref="S2.E2.m1.2.2.3.3.7">𝑡</ci></apply></apply><apply id="S2.E2.m1.2.2.1.cmml" xref="S2.E2.m1.2.2.1"><times id="S2.E2.m1.2.2.1.2.cmml" xref="S2.E2.m1.2.2.1.2"></times><ci id="S2.E2.m1.2.2.1.3.cmml" xref="S2.E2.m1.2.2.1.3">𝑎</ci><ci id="S2.E2.m1.2.2.1.4.cmml" xref="S2.E2.m1.2.2.1.4">𝑟</ci><ci id="S2.E2.m1.2.2.1.5.cmml" xref="S2.E2.m1.2.2.1.5">𝑔</ci><ci id="S2.E2.m1.2.2.1.6.cmml" xref="S2.E2.m1.2.2.1.6">𝑚</ci><ci id="S2.E2.m1.2.2.1.7.cmml" xref="S2.E2.m1.2.2.1.7">𝑎</ci><apply id="S2.E2.m1.2.2.1.8.cmml" xref="S2.E2.m1.2.2.1.8"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.8.1.cmml" xref="S2.E2.m1.2.2.1.8">subscript</csymbol><ci id="S2.E2.m1.2.2.1.8.2.cmml" xref="S2.E2.m1.2.2.1.8.2">𝑥</ci><ci id="S2.E2.m1.2.2.1.8.3.cmml" xref="S2.E2.m1.2.2.1.8.3">𝜃</ci></apply><apply id="S2.E2.m1.2.2.1.9.cmml" xref="S2.E2.m1.2.2.1.9"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.9.1.cmml" xref="S2.E2.m1.2.2.1.9">subscript</csymbol><ci id="S2.E2.m1.2.2.1.9.2.cmml" xref="S2.E2.m1.2.2.1.9.2">𝑃</ci><ci id="S2.E2.m1.2.2.1.9.3.cmml" xref="S2.E2.m1.2.2.1.9.3">italic-ϕ</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.2.2.1.1.1.1.4.cmml" xref="S2.E2.m1.2.2.1.1.1.1.4">conditional</csymbol><apply id="S2.E2.m1.2.2.1.1.1.1.5.cmml" xref="S2.E2.m1.2.2.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.5.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.5">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.5.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.5.2">𝑦</ci><apply id="S2.E2.m1.2.2.1.1.1.1.5.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.5.3"><times id="S2.E2.m1.2.2.1.1.1.1.5.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.5.3.1"></times><ci id="S2.E2.m1.2.2.1.1.1.1.5.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.5.3.2">𝑟</ci><ci id="S2.E2.m1.2.2.1.1.1.1.5.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.5.3.3">𝑒</ci><ci id="S2.E2.m1.2.2.1.1.1.1.5.3.4.cmml" xref="S2.E2.m1.2.2.1.1.1.1.5.3.4">𝑐</ci></apply></apply><list id="S2.E2.m1.2.2.1.1.1.1.3.4.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3.3"><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.2">𝜃</ci><cn id="S2.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.E2.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2.2">𝜃</ci><cn id="S2.E2.m1.2.2.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">…</ci><apply id="S2.E2.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.3.3.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3.3.3">superscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.3.3.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3.3.3.2">𝜃</ci><ci id="S2.E2.m1.2.2.1.1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3.3.3.3">𝑀</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">\small E_{latent}=argmax_{\theta}P_{\phi}(y^{rec}|\theta^{1},\theta^{2},...,%
\theta^{M})</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">italic_E start_POSTSUBSCRIPT italic_l italic_a italic_t italic_e italic_n italic_t end_POSTSUBSCRIPT = italic_a italic_r italic_g italic_m italic_a italic_x start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_P start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT | italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.8">In this formula, <math alttext="P_{\phi}" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m1.1"><semantics id="S2.SS1.p2.5.m1.1a"><msub id="S2.SS1.p2.5.m1.1.1" xref="S2.SS1.p2.5.m1.1.1.cmml"><mi id="S2.SS1.p2.5.m1.1.1.2" xref="S2.SS1.p2.5.m1.1.1.2.cmml">P</mi><mi id="S2.SS1.p2.5.m1.1.1.3" xref="S2.SS1.p2.5.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m1.1b"><apply id="S2.SS1.p2.5.m1.1.1.cmml" xref="S2.SS1.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m1.1.1.1.cmml" xref="S2.SS1.p2.5.m1.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m1.1.1.2.cmml" xref="S2.SS1.p2.5.m1.1.1.2">𝑃</ci><ci id="S2.SS1.p2.5.m1.1.1.3.cmml" xref="S2.SS1.p2.5.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m1.1c">P_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m1.1d">italic_P start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> is a function that maps the user’s latent profiles to the probability of the observed user behaviors. Unfortunately, there is no such off-the-shelf <math alttext="P_{\phi}" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m2.1"><semantics id="S2.SS1.p2.6.m2.1a"><msub id="S2.SS1.p2.6.m2.1.1" xref="S2.SS1.p2.6.m2.1.1.cmml"><mi id="S2.SS1.p2.6.m2.1.1.2" xref="S2.SS1.p2.6.m2.1.1.2.cmml">P</mi><mi id="S2.SS1.p2.6.m2.1.1.3" xref="S2.SS1.p2.6.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m2.1b"><apply id="S2.SS1.p2.6.m2.1.1.cmml" xref="S2.SS1.p2.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m2.1.1.1.cmml" xref="S2.SS1.p2.6.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.6.m2.1.1.2.cmml" xref="S2.SS1.p2.6.m2.1.1.2">𝑃</ci><ci id="S2.SS1.p2.6.m2.1.1.3.cmml" xref="S2.SS1.p2.6.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m2.1c">P_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m2.1d">italic_P start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>
existed in the recommendation area without exactly seen <math alttext="\theta^{1},\theta^{2},...,\theta^{M}" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m3.4"><semantics id="S2.SS1.p2.7.m3.4a"><mrow id="S2.SS1.p2.7.m3.4.4.3" xref="S2.SS1.p2.7.m3.4.4.4.cmml"><msup id="S2.SS1.p2.7.m3.2.2.1.1" xref="S2.SS1.p2.7.m3.2.2.1.1.cmml"><mi id="S2.SS1.p2.7.m3.2.2.1.1.2" xref="S2.SS1.p2.7.m3.2.2.1.1.2.cmml">θ</mi><mn id="S2.SS1.p2.7.m3.2.2.1.1.3" xref="S2.SS1.p2.7.m3.2.2.1.1.3.cmml">1</mn></msup><mo id="S2.SS1.p2.7.m3.4.4.3.4" xref="S2.SS1.p2.7.m3.4.4.4.cmml">,</mo><msup id="S2.SS1.p2.7.m3.3.3.2.2" xref="S2.SS1.p2.7.m3.3.3.2.2.cmml"><mi id="S2.SS1.p2.7.m3.3.3.2.2.2" xref="S2.SS1.p2.7.m3.3.3.2.2.2.cmml">θ</mi><mn id="S2.SS1.p2.7.m3.3.3.2.2.3" xref="S2.SS1.p2.7.m3.3.3.2.2.3.cmml">2</mn></msup><mo id="S2.SS1.p2.7.m3.4.4.3.5" xref="S2.SS1.p2.7.m3.4.4.4.cmml">,</mo><mi id="S2.SS1.p2.7.m3.1.1" mathvariant="normal" xref="S2.SS1.p2.7.m3.1.1.cmml">…</mi><mo id="S2.SS1.p2.7.m3.4.4.3.6" xref="S2.SS1.p2.7.m3.4.4.4.cmml">,</mo><msup id="S2.SS1.p2.7.m3.4.4.3.3" xref="S2.SS1.p2.7.m3.4.4.3.3.cmml"><mi id="S2.SS1.p2.7.m3.4.4.3.3.2" xref="S2.SS1.p2.7.m3.4.4.3.3.2.cmml">θ</mi><mi id="S2.SS1.p2.7.m3.4.4.3.3.3" xref="S2.SS1.p2.7.m3.4.4.3.3.3.cmml">M</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m3.4b"><list id="S2.SS1.p2.7.m3.4.4.4.cmml" xref="S2.SS1.p2.7.m3.4.4.3"><apply id="S2.SS1.p2.7.m3.2.2.1.1.cmml" xref="S2.SS1.p2.7.m3.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m3.2.2.1.1.1.cmml" xref="S2.SS1.p2.7.m3.2.2.1.1">superscript</csymbol><ci id="S2.SS1.p2.7.m3.2.2.1.1.2.cmml" xref="S2.SS1.p2.7.m3.2.2.1.1.2">𝜃</ci><cn id="S2.SS1.p2.7.m3.2.2.1.1.3.cmml" type="integer" xref="S2.SS1.p2.7.m3.2.2.1.1.3">1</cn></apply><apply id="S2.SS1.p2.7.m3.3.3.2.2.cmml" xref="S2.SS1.p2.7.m3.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m3.3.3.2.2.1.cmml" xref="S2.SS1.p2.7.m3.3.3.2.2">superscript</csymbol><ci id="S2.SS1.p2.7.m3.3.3.2.2.2.cmml" xref="S2.SS1.p2.7.m3.3.3.2.2.2">𝜃</ci><cn id="S2.SS1.p2.7.m3.3.3.2.2.3.cmml" type="integer" xref="S2.SS1.p2.7.m3.3.3.2.2.3">2</cn></apply><ci id="S2.SS1.p2.7.m3.1.1.cmml" xref="S2.SS1.p2.7.m3.1.1">…</ci><apply id="S2.SS1.p2.7.m3.4.4.3.3.cmml" xref="S2.SS1.p2.7.m3.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m3.4.4.3.3.1.cmml" xref="S2.SS1.p2.7.m3.4.4.3.3">superscript</csymbol><ci id="S2.SS1.p2.7.m3.4.4.3.3.2.cmml" xref="S2.SS1.p2.7.m3.4.4.3.3.2">𝜃</ci><ci id="S2.SS1.p2.7.m3.4.4.3.3.3.cmml" xref="S2.SS1.p2.7.m3.4.4.3.3.3">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m3.4c">\theta^{1},\theta^{2},...,\theta^{M}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m3.4d">italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>. However, LLMs can serve as a surrogate model for <math alttext="P_{\phi}" class="ltx_Math" display="inline" id="S2.SS1.p2.8.m4.1"><semantics id="S2.SS1.p2.8.m4.1a"><msub id="S2.SS1.p2.8.m4.1.1" xref="S2.SS1.p2.8.m4.1.1.cmml"><mi id="S2.SS1.p2.8.m4.1.1.2" xref="S2.SS1.p2.8.m4.1.1.2.cmml">P</mi><mi id="S2.SS1.p2.8.m4.1.1.3" xref="S2.SS1.p2.8.m4.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m4.1b"><apply id="S2.SS1.p2.8.m4.1.1.cmml" xref="S2.SS1.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m4.1.1.1.cmml" xref="S2.SS1.p2.8.m4.1.1">subscript</csymbol><ci id="S2.SS1.p2.8.m4.1.1.2.cmml" xref="S2.SS1.p2.8.m4.1.1.2">𝑃</ci><ci id="S2.SS1.p2.8.m4.1.1.3.cmml" xref="S2.SS1.p2.8.m4.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m4.1c">P_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.8.m4.1d">italic_P start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> because of its rich world knowledge and outstanding reasoning capability. We design the UserIP-Tuning framework to perform this latent profile inference task in the semantic space while addressing four challenges mentioned in the introduction simultaneously.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Framework Overview</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">The process of UserIP-Tuning is illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.F3" title="Figure 3 ‣ 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">3</span></a>. It consists of a UserIP inference module, a UserIP quantization module, and a pre-stored UserIP feature bank. The inference module treats users’ latent profiles as soft prompts and infers them by maximizing the likelihood of ground truth user interaction sequence. Then these latent profiles are hashed into discrete collaborative IDs by a trainable quantization module supervised by recommendation loss. Finally, these IDs are stored in the offline feature bank for downstream recommendation tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>UserIP Inference Module</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">To address the twisted causal relationship and the textual noise issues mentioned in the introduction section, We design the UserIP Inference module. This module models the latent profile inference problem described in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S1.F2" title="Figure 2 ‣ 1. Introduction ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">2</span></a> in the LLMs’ semantic space with task-specific soft prompt and causal mask.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.2">Firstly, the probability graph demonstrated in the Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S1.F2" title="Figure 2 ‣ 1. Introduction ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">2</span></a> is reorganized to adapt to the LLMs’ autoregressive structure as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.F4" title="Figure 4 ‣ 2.3. UserIP Inference Module ‣ 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">4</span></a> (Up), where the left part is treated as the prompt and the right part is treated as the ground-truth output. To reduce the textual noise, only tokens (<math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><mi id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><ci id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">italic_θ</annotation></semantics></math>) next to target latent profiles’ names (<math alttext="x" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1"><semantics id="S2.SS3.p2.2.m2.1a"><mi id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><ci id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">italic_x</annotation></semantics></math>) are treated as soft prompts. Furthermore, these soft prompts can only be influenced by their respective latent profiles’ names.</p>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.3">A text prompt is then designed to satisfy the above causal relationship and consists of three components. (1) Context tokens <math alttext="x" class="ltx_Math" display="inline" id="S2.SS3.p3.1.m1.1"><semantics id="S2.SS3.p3.1.m1.1a"><mi id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><ci id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.1d">italic_x</annotation></semantics></math> to indicate the latent profiles we are interested in, (2) soft latent profile tokens <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS3.p3.2.m2.1"><semantics id="S2.SS3.p3.2.m2.1a"><mi id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><ci id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m2.1d">italic_θ</annotation></semantics></math> that can be tuned to maximize the likelihood of user interaction behaviors, and (3) a specific task description <math alttext="D_{task}" class="ltx_Math" display="inline" id="S2.SS3.p3.3.m3.1"><semantics id="S2.SS3.p3.3.m3.1a"><msub id="S2.SS3.p3.3.m3.1.1" xref="S2.SS3.p3.3.m3.1.1.cmml"><mi id="S2.SS3.p3.3.m3.1.1.2" xref="S2.SS3.p3.3.m3.1.1.2.cmml">D</mi><mrow id="S2.SS3.p3.3.m3.1.1.3" xref="S2.SS3.p3.3.m3.1.1.3.cmml"><mi id="S2.SS3.p3.3.m3.1.1.3.2" xref="S2.SS3.p3.3.m3.1.1.3.2.cmml">t</mi><mo id="S2.SS3.p3.3.m3.1.1.3.1" xref="S2.SS3.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p3.3.m3.1.1.3.3" xref="S2.SS3.p3.3.m3.1.1.3.3.cmml">a</mi><mo id="S2.SS3.p3.3.m3.1.1.3.1a" xref="S2.SS3.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p3.3.m3.1.1.3.4" xref="S2.SS3.p3.3.m3.1.1.3.4.cmml">s</mi><mo id="S2.SS3.p3.3.m3.1.1.3.1b" xref="S2.SS3.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p3.3.m3.1.1.3.5" xref="S2.SS3.p3.3.m3.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><apply id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m3.1.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p3.3.m3.1.1.2.cmml" xref="S2.SS3.p3.3.m3.1.1.2">𝐷</ci><apply id="S2.SS3.p3.3.m3.1.1.3.cmml" xref="S2.SS3.p3.3.m3.1.1.3"><times id="S2.SS3.p3.3.m3.1.1.3.1.cmml" xref="S2.SS3.p3.3.m3.1.1.3.1"></times><ci id="S2.SS3.p3.3.m3.1.1.3.2.cmml" xref="S2.SS3.p3.3.m3.1.1.3.2">𝑡</ci><ci id="S2.SS3.p3.3.m3.1.1.3.3.cmml" xref="S2.SS3.p3.3.m3.1.1.3.3">𝑎</ci><ci id="S2.SS3.p3.3.m3.1.1.3.4.cmml" xref="S2.SS3.p3.3.m3.1.1.3.4">𝑠</ci><ci id="S2.SS3.p3.3.m3.1.1.3.5.cmml" xref="S2.SS3.p3.3.m3.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">D_{task}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.3.m3.1d">italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT</annotation></semantics></math> such as user click history prediction or review prediction for a target item. The template of the prompt is presented in the formula:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small[L_{M}^{{}^{\prime}},D_{task}]=[x^{1},\theta^{1},x^{2},\theta^{2},...,x^%
{M},\theta^{M},D_{task}]" class="ltx_Math" display="block" id="S2.E3.m1.10"><semantics id="S2.E3.m1.10a"><mrow id="S2.E3.m1.10.10" xref="S2.E3.m1.10.10.cmml"><mrow id="S2.E3.m1.3.3.2.2" xref="S2.E3.m1.3.3.2.3.cmml"><mo id="S2.E3.m1.3.3.2.2.3" maxsize="90%" minsize="90%" xref="S2.E3.m1.3.3.2.3.cmml">[</mo><msubsup id="S2.E3.m1.2.2.1.1.1" xref="S2.E3.m1.2.2.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.2.2" mathsize="90%" xref="S2.E3.m1.2.2.1.1.1.2.2.cmml">L</mi><mi id="S2.E3.m1.2.2.1.1.1.2.3" mathsize="90%" xref="S2.E3.m1.2.2.1.1.1.2.3.cmml">M</mi><msup id="S2.E3.m1.2.2.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.3a" xref="S2.E3.m1.2.2.1.1.1.3.cmml"></mi><mo id="S2.E3.m1.2.2.1.1.1.3.1" mathsize="90%" xref="S2.E3.m1.2.2.1.1.1.3.1.cmml">′</mo></msup></msubsup><mo id="S2.E3.m1.3.3.2.2.4" mathsize="90%" xref="S2.E3.m1.3.3.2.3.cmml">,</mo><msub id="S2.E3.m1.3.3.2.2.2" xref="S2.E3.m1.3.3.2.2.2.cmml"><mi id="S2.E3.m1.3.3.2.2.2.2" mathsize="90%" xref="S2.E3.m1.3.3.2.2.2.2.cmml">D</mi><mrow id="S2.E3.m1.3.3.2.2.2.3" xref="S2.E3.m1.3.3.2.2.2.3.cmml"><mi id="S2.E3.m1.3.3.2.2.2.3.2" mathsize="90%" xref="S2.E3.m1.3.3.2.2.2.3.2.cmml">t</mi><mo id="S2.E3.m1.3.3.2.2.2.3.1" xref="S2.E3.m1.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S2.E3.m1.3.3.2.2.2.3.3" mathsize="90%" xref="S2.E3.m1.3.3.2.2.2.3.3.cmml">a</mi><mo id="S2.E3.m1.3.3.2.2.2.3.1a" xref="S2.E3.m1.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S2.E3.m1.3.3.2.2.2.3.4" mathsize="90%" xref="S2.E3.m1.3.3.2.2.2.3.4.cmml">s</mi><mo id="S2.E3.m1.3.3.2.2.2.3.1b" xref="S2.E3.m1.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S2.E3.m1.3.3.2.2.2.3.5" mathsize="90%" xref="S2.E3.m1.3.3.2.2.2.3.5.cmml">k</mi></mrow></msub><mo id="S2.E3.m1.3.3.2.2.5" maxsize="90%" minsize="90%" xref="S2.E3.m1.3.3.2.3.cmml">]</mo></mrow><mo id="S2.E3.m1.10.10.10" mathsize="90%" xref="S2.E3.m1.10.10.10.cmml">=</mo><mrow id="S2.E3.m1.10.10.9.7" xref="S2.E3.m1.10.10.9.8.cmml"><mo id="S2.E3.m1.10.10.9.7.8" maxsize="90%" minsize="90%" xref="S2.E3.m1.10.10.9.8.cmml">[</mo><msup id="S2.E3.m1.4.4.3.1.1" xref="S2.E3.m1.4.4.3.1.1.cmml"><mi id="S2.E3.m1.4.4.3.1.1.2" mathsize="90%" xref="S2.E3.m1.4.4.3.1.1.2.cmml">x</mi><mn id="S2.E3.m1.4.4.3.1.1.3" mathsize="90%" xref="S2.E3.m1.4.4.3.1.1.3.cmml">1</mn></msup><mo id="S2.E3.m1.10.10.9.7.9" mathsize="90%" xref="S2.E3.m1.10.10.9.8.cmml">,</mo><msup id="S2.E3.m1.5.5.4.2.2" xref="S2.E3.m1.5.5.4.2.2.cmml"><mi id="S2.E3.m1.5.5.4.2.2.2" mathsize="90%" xref="S2.E3.m1.5.5.4.2.2.2.cmml">θ</mi><mn id="S2.E3.m1.5.5.4.2.2.3" mathsize="90%" xref="S2.E3.m1.5.5.4.2.2.3.cmml">1</mn></msup><mo id="S2.E3.m1.10.10.9.7.10" mathsize="90%" xref="S2.E3.m1.10.10.9.8.cmml">,</mo><msup id="S2.E3.m1.6.6.5.3.3" xref="S2.E3.m1.6.6.5.3.3.cmml"><mi id="S2.E3.m1.6.6.5.3.3.2" mathsize="90%" xref="S2.E3.m1.6.6.5.3.3.2.cmml">x</mi><mn id="S2.E3.m1.6.6.5.3.3.3" mathsize="90%" xref="S2.E3.m1.6.6.5.3.3.3.cmml">2</mn></msup><mo id="S2.E3.m1.10.10.9.7.11" mathsize="90%" xref="S2.E3.m1.10.10.9.8.cmml">,</mo><msup id="S2.E3.m1.7.7.6.4.4" xref="S2.E3.m1.7.7.6.4.4.cmml"><mi id="S2.E3.m1.7.7.6.4.4.2" mathsize="90%" xref="S2.E3.m1.7.7.6.4.4.2.cmml">θ</mi><mn id="S2.E3.m1.7.7.6.4.4.3" mathsize="90%" xref="S2.E3.m1.7.7.6.4.4.3.cmml">2</mn></msup><mo id="S2.E3.m1.10.10.9.7.12" mathsize="90%" xref="S2.E3.m1.10.10.9.8.cmml">,</mo><mi id="S2.E3.m1.1.1" mathsize="90%" mathvariant="normal" xref="S2.E3.m1.1.1.cmml">…</mi><mo id="S2.E3.m1.10.10.9.7.13" mathsize="90%" xref="S2.E3.m1.10.10.9.8.cmml">,</mo><msup id="S2.E3.m1.8.8.7.5.5" xref="S2.E3.m1.8.8.7.5.5.cmml"><mi id="S2.E3.m1.8.8.7.5.5.2" mathsize="90%" xref="S2.E3.m1.8.8.7.5.5.2.cmml">x</mi><mi id="S2.E3.m1.8.8.7.5.5.3" mathsize="90%" xref="S2.E3.m1.8.8.7.5.5.3.cmml">M</mi></msup><mo id="S2.E3.m1.10.10.9.7.14" mathsize="90%" xref="S2.E3.m1.10.10.9.8.cmml">,</mo><msup id="S2.E3.m1.9.9.8.6.6" xref="S2.E3.m1.9.9.8.6.6.cmml"><mi id="S2.E3.m1.9.9.8.6.6.2" mathsize="90%" xref="S2.E3.m1.9.9.8.6.6.2.cmml">θ</mi><mi id="S2.E3.m1.9.9.8.6.6.3" mathsize="90%" xref="S2.E3.m1.9.9.8.6.6.3.cmml">M</mi></msup><mo id="S2.E3.m1.10.10.9.7.15" mathsize="90%" xref="S2.E3.m1.10.10.9.8.cmml">,</mo><msub id="S2.E3.m1.10.10.9.7.7" xref="S2.E3.m1.10.10.9.7.7.cmml"><mi id="S2.E3.m1.10.10.9.7.7.2" mathsize="90%" xref="S2.E3.m1.10.10.9.7.7.2.cmml">D</mi><mrow id="S2.E3.m1.10.10.9.7.7.3" xref="S2.E3.m1.10.10.9.7.7.3.cmml"><mi id="S2.E3.m1.10.10.9.7.7.3.2" mathsize="90%" xref="S2.E3.m1.10.10.9.7.7.3.2.cmml">t</mi><mo id="S2.E3.m1.10.10.9.7.7.3.1" xref="S2.E3.m1.10.10.9.7.7.3.1.cmml">⁢</mo><mi id="S2.E3.m1.10.10.9.7.7.3.3" mathsize="90%" xref="S2.E3.m1.10.10.9.7.7.3.3.cmml">a</mi><mo id="S2.E3.m1.10.10.9.7.7.3.1a" xref="S2.E3.m1.10.10.9.7.7.3.1.cmml">⁢</mo><mi id="S2.E3.m1.10.10.9.7.7.3.4" mathsize="90%" xref="S2.E3.m1.10.10.9.7.7.3.4.cmml">s</mi><mo id="S2.E3.m1.10.10.9.7.7.3.1b" xref="S2.E3.m1.10.10.9.7.7.3.1.cmml">⁢</mo><mi id="S2.E3.m1.10.10.9.7.7.3.5" mathsize="90%" xref="S2.E3.m1.10.10.9.7.7.3.5.cmml">k</mi></mrow></msub><mo id="S2.E3.m1.10.10.9.7.16" maxsize="90%" minsize="90%" xref="S2.E3.m1.10.10.9.8.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.10b"><apply id="S2.E3.m1.10.10.cmml" xref="S2.E3.m1.10.10"><eq id="S2.E3.m1.10.10.10.cmml" xref="S2.E3.m1.10.10.10"></eq><interval closure="closed" id="S2.E3.m1.3.3.2.3.cmml" xref="S2.E3.m1.3.3.2.2"><apply id="S2.E3.m1.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1">superscript</csymbol><apply id="S2.E3.m1.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2.2">𝐿</ci><ci id="S2.E3.m1.2.2.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.2.3">𝑀</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.3"><ci id="S2.E3.m1.2.2.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.3.1">′</ci></apply></apply><apply id="S2.E3.m1.3.3.2.2.2.cmml" xref="S2.E3.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.2.2.2.1.cmml" xref="S2.E3.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.E3.m1.3.3.2.2.2.2.cmml" xref="S2.E3.m1.3.3.2.2.2.2">𝐷</ci><apply id="S2.E3.m1.3.3.2.2.2.3.cmml" xref="S2.E3.m1.3.3.2.2.2.3"><times id="S2.E3.m1.3.3.2.2.2.3.1.cmml" xref="S2.E3.m1.3.3.2.2.2.3.1"></times><ci id="S2.E3.m1.3.3.2.2.2.3.2.cmml" xref="S2.E3.m1.3.3.2.2.2.3.2">𝑡</ci><ci id="S2.E3.m1.3.3.2.2.2.3.3.cmml" xref="S2.E3.m1.3.3.2.2.2.3.3">𝑎</ci><ci id="S2.E3.m1.3.3.2.2.2.3.4.cmml" xref="S2.E3.m1.3.3.2.2.2.3.4">𝑠</ci><ci id="S2.E3.m1.3.3.2.2.2.3.5.cmml" xref="S2.E3.m1.3.3.2.2.2.3.5">𝑘</ci></apply></apply></interval><list id="S2.E3.m1.10.10.9.8.cmml" xref="S2.E3.m1.10.10.9.7"><apply id="S2.E3.m1.4.4.3.1.1.cmml" xref="S2.E3.m1.4.4.3.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.3.1.1.1.cmml" xref="S2.E3.m1.4.4.3.1.1">superscript</csymbol><ci id="S2.E3.m1.4.4.3.1.1.2.cmml" xref="S2.E3.m1.4.4.3.1.1.2">𝑥</ci><cn id="S2.E3.m1.4.4.3.1.1.3.cmml" type="integer" xref="S2.E3.m1.4.4.3.1.1.3">1</cn></apply><apply id="S2.E3.m1.5.5.4.2.2.cmml" xref="S2.E3.m1.5.5.4.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.4.2.2.1.cmml" xref="S2.E3.m1.5.5.4.2.2">superscript</csymbol><ci id="S2.E3.m1.5.5.4.2.2.2.cmml" xref="S2.E3.m1.5.5.4.2.2.2">𝜃</ci><cn id="S2.E3.m1.5.5.4.2.2.3.cmml" type="integer" xref="S2.E3.m1.5.5.4.2.2.3">1</cn></apply><apply id="S2.E3.m1.6.6.5.3.3.cmml" xref="S2.E3.m1.6.6.5.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.5.3.3.1.cmml" xref="S2.E3.m1.6.6.5.3.3">superscript</csymbol><ci id="S2.E3.m1.6.6.5.3.3.2.cmml" xref="S2.E3.m1.6.6.5.3.3.2">𝑥</ci><cn id="S2.E3.m1.6.6.5.3.3.3.cmml" type="integer" xref="S2.E3.m1.6.6.5.3.3.3">2</cn></apply><apply id="S2.E3.m1.7.7.6.4.4.cmml" xref="S2.E3.m1.7.7.6.4.4"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.6.4.4.1.cmml" xref="S2.E3.m1.7.7.6.4.4">superscript</csymbol><ci id="S2.E3.m1.7.7.6.4.4.2.cmml" xref="S2.E3.m1.7.7.6.4.4.2">𝜃</ci><cn id="S2.E3.m1.7.7.6.4.4.3.cmml" type="integer" xref="S2.E3.m1.7.7.6.4.4.3">2</cn></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">…</ci><apply id="S2.E3.m1.8.8.7.5.5.cmml" xref="S2.E3.m1.8.8.7.5.5"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.7.5.5.1.cmml" xref="S2.E3.m1.8.8.7.5.5">superscript</csymbol><ci id="S2.E3.m1.8.8.7.5.5.2.cmml" xref="S2.E3.m1.8.8.7.5.5.2">𝑥</ci><ci id="S2.E3.m1.8.8.7.5.5.3.cmml" xref="S2.E3.m1.8.8.7.5.5.3">𝑀</ci></apply><apply id="S2.E3.m1.9.9.8.6.6.cmml" xref="S2.E3.m1.9.9.8.6.6"><csymbol cd="ambiguous" id="S2.E3.m1.9.9.8.6.6.1.cmml" xref="S2.E3.m1.9.9.8.6.6">superscript</csymbol><ci id="S2.E3.m1.9.9.8.6.6.2.cmml" xref="S2.E3.m1.9.9.8.6.6.2">𝜃</ci><ci id="S2.E3.m1.9.9.8.6.6.3.cmml" xref="S2.E3.m1.9.9.8.6.6.3">𝑀</ci></apply><apply id="S2.E3.m1.10.10.9.7.7.cmml" xref="S2.E3.m1.10.10.9.7.7"><csymbol cd="ambiguous" id="S2.E3.m1.10.10.9.7.7.1.cmml" xref="S2.E3.m1.10.10.9.7.7">subscript</csymbol><ci id="S2.E3.m1.10.10.9.7.7.2.cmml" xref="S2.E3.m1.10.10.9.7.7.2">𝐷</ci><apply id="S2.E3.m1.10.10.9.7.7.3.cmml" xref="S2.E3.m1.10.10.9.7.7.3"><times id="S2.E3.m1.10.10.9.7.7.3.1.cmml" xref="S2.E3.m1.10.10.9.7.7.3.1"></times><ci id="S2.E3.m1.10.10.9.7.7.3.2.cmml" xref="S2.E3.m1.10.10.9.7.7.3.2">𝑡</ci><ci id="S2.E3.m1.10.10.9.7.7.3.3.cmml" xref="S2.E3.m1.10.10.9.7.7.3.3">𝑎</ci><ci id="S2.E3.m1.10.10.9.7.7.3.4.cmml" xref="S2.E3.m1.10.10.9.7.7.3.4">𝑠</ci><ci id="S2.E3.m1.10.10.9.7.7.3.5.cmml" xref="S2.E3.m1.10.10.9.7.7.3.5">𝑘</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.10c">\small[L_{M}^{{}^{\prime}},D_{task}]=[x^{1},\theta^{1},x^{2},\theta^{2},...,x^%
{M},\theta^{M},D_{task}]</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.10d">[ italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT ] = [ italic_x start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_x start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p3.8">where <math alttext="L_{M}^{{}^{\prime}}" class="ltx_Math" display="inline" id="S2.SS3.p3.4.m1.1"><semantics id="S2.SS3.p3.4.m1.1a"><msubsup id="S2.SS3.p3.4.m1.1.1" xref="S2.SS3.p3.4.m1.1.1.cmml"><mi id="S2.SS3.p3.4.m1.1.1.2.2" xref="S2.SS3.p3.4.m1.1.1.2.2.cmml">L</mi><mi id="S2.SS3.p3.4.m1.1.1.2.3" xref="S2.SS3.p3.4.m1.1.1.2.3.cmml">M</mi><msup id="S2.SS3.p3.4.m1.1.1.3" xref="S2.SS3.p3.4.m1.1.1.3.cmml"><mi id="S2.SS3.p3.4.m1.1.1.3a" xref="S2.SS3.p3.4.m1.1.1.3.cmml"></mi><mo id="S2.SS3.p3.4.m1.1.1.3.1" xref="S2.SS3.p3.4.m1.1.1.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m1.1b"><apply id="S2.SS3.p3.4.m1.1.1.cmml" xref="S2.SS3.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m1.1.1.1.cmml" xref="S2.SS3.p3.4.m1.1.1">superscript</csymbol><apply id="S2.SS3.p3.4.m1.1.1.2.cmml" xref="S2.SS3.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m1.1.1.2.1.cmml" xref="S2.SS3.p3.4.m1.1.1">subscript</csymbol><ci id="S2.SS3.p3.4.m1.1.1.2.2.cmml" xref="S2.SS3.p3.4.m1.1.1.2.2">𝐿</ci><ci id="S2.SS3.p3.4.m1.1.1.2.3.cmml" xref="S2.SS3.p3.4.m1.1.1.2.3">𝑀</ci></apply><apply id="S2.SS3.p3.4.m1.1.1.3.cmml" xref="S2.SS3.p3.4.m1.1.1.3"><ci id="S2.SS3.p3.4.m1.1.1.3.1.cmml" xref="S2.SS3.p3.4.m1.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m1.1c">L_{M}^{{}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.4.m1.1d">italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> generally denotes the concatenated latent profile name <math alttext="x" class="ltx_Math" display="inline" id="S2.SS3.p3.5.m2.1"><semantics id="S2.SS3.p3.5.m2.1a"><mi id="S2.SS3.p3.5.m2.1.1" xref="S2.SS3.p3.5.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.5.m2.1b"><ci id="S2.SS3.p3.5.m2.1.1.cmml" xref="S2.SS3.p3.5.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.5.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.5.m2.1d">italic_x</annotation></semantics></math> and soft latent profile tokens <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS3.p3.6.m3.1"><semantics id="S2.SS3.p3.6.m3.1a"><mi id="S2.SS3.p3.6.m3.1.1" xref="S2.SS3.p3.6.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.6.m3.1b"><ci id="S2.SS3.p3.6.m3.1.1.cmml" xref="S2.SS3.p3.6.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.6.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.6.m3.1d">italic_θ</annotation></semantics></math>. For instance, Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.F3" title="Figure 3 ‣ 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">3</span></a> and the following prompt template illustrate the prompt where <math alttext="x_{1}" class="ltx_Math" display="inline" id="S2.SS3.p3.7.m4.1"><semantics id="S2.SS3.p3.7.m4.1a"><msub id="S2.SS3.p3.7.m4.1.1" xref="S2.SS3.p3.7.m4.1.1.cmml"><mi id="S2.SS3.p3.7.m4.1.1.2" xref="S2.SS3.p3.7.m4.1.1.2.cmml">x</mi><mn id="S2.SS3.p3.7.m4.1.1.3" xref="S2.SS3.p3.7.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.7.m4.1b"><apply id="S2.SS3.p3.7.m4.1.1.cmml" xref="S2.SS3.p3.7.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.7.m4.1.1.1.cmml" xref="S2.SS3.p3.7.m4.1.1">subscript</csymbol><ci id="S2.SS3.p3.7.m4.1.1.2.cmml" xref="S2.SS3.p3.7.m4.1.1.2">𝑥</ci><cn id="S2.SS3.p3.7.m4.1.1.3.cmml" type="integer" xref="S2.SS3.p3.7.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.7.m4.1c">x_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.7.m4.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> is “This user’s hobby is” and <math alttext="x_{2}" class="ltx_Math" display="inline" id="S2.SS3.p3.8.m5.1"><semantics id="S2.SS3.p3.8.m5.1a"><msub id="S2.SS3.p3.8.m5.1.1" xref="S2.SS3.p3.8.m5.1.1.cmml"><mi id="S2.SS3.p3.8.m5.1.1.2" xref="S2.SS3.p3.8.m5.1.1.2.cmml">x</mi><mn id="S2.SS3.p3.8.m5.1.1.3" xref="S2.SS3.p3.8.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.8.m5.1b"><apply id="S2.SS3.p3.8.m5.1.1.cmml" xref="S2.SS3.p3.8.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.8.m5.1.1.1.cmml" xref="S2.SS3.p3.8.m5.1.1">subscript</csymbol><ci id="S2.SS3.p3.8.m5.1.1.2.cmml" xref="S2.SS3.p3.8.m5.1.1.2">𝑥</ci><cn id="S2.SS3.p3.8.m5.1.1.3.cmml" type="integer" xref="S2.SS3.p3.8.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.8.m5.1c">x_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.8.m5.1d">italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is “his background is”. By putting each profile name in front of its corresponding latent profile token, LLMs are forced to infer latent profiles more controllably because LLMs are trained to consider language context in NLP tasks.</p>
</div>
<figure class="ltx_figure" id="S2.SS3.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_landscape" height="189" id="S2.SS3.1.g1" src="x4.png" width="821"/>
</figure>
<div class="ltx_para" id="S2.SS3.p4">
<p class="ltx_p" id="S2.SS3.p4.2">Additionally, to assure soft prompts can only be influenced by their respective latent profiles’ names, specific causal masks are used for model training as illustrated in the Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.F4" title="Figure 4 ‣ 2.3. UserIP Inference Module ‣ 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">4</span></a> (down). With this causal mask, the latent profiles variable <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="S2.SS3.p4.1.m1.1"><semantics id="S2.SS3.p4.1.m1.1a"><msub id="S2.SS3.p4.1.m1.1.1" xref="S2.SS3.p4.1.m1.1.1.cmml"><mi id="S2.SS3.p4.1.m1.1.1.2" xref="S2.SS3.p4.1.m1.1.1.2.cmml">θ</mi><mn id="S2.SS3.p4.1.m1.1.1.3" xref="S2.SS3.p4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.1.m1.1b"><apply id="S2.SS3.p4.1.m1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p4.1.m1.1.1.2.cmml" xref="S2.SS3.p4.1.m1.1.1.2">𝜃</ci><cn id="S2.SS3.p4.1.m1.1.1.3.cmml" type="integer" xref="S2.SS3.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.1.m1.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.1.m1.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\theta_{2}" class="ltx_Math" display="inline" id="S2.SS3.p4.2.m2.1"><semantics id="S2.SS3.p4.2.m2.1a"><msub id="S2.SS3.p4.2.m2.1.1" xref="S2.SS3.p4.2.m2.1.1.cmml"><mi id="S2.SS3.p4.2.m2.1.1.2" xref="S2.SS3.p4.2.m2.1.1.2.cmml">θ</mi><mn id="S2.SS3.p4.2.m2.1.1.3" xref="S2.SS3.p4.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.2.m2.1b"><apply id="S2.SS3.p4.2.m2.1.1.cmml" xref="S2.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.2.m2.1.1.1.cmml" xref="S2.SS3.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p4.2.m2.1.1.2.cmml" xref="S2.SS3.p4.2.m2.1.1.2">𝜃</ci><cn id="S2.SS3.p4.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.p4.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.2.m2.1c">\theta_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.2.m2.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> can only attend to their respective profile names and interactions, and are blind to other irrelevant words.</p>
</div>
<div class="ltx_para" id="S2.SS3.p5">
<p class="ltx_p" id="S2.SS3.p5.2">Conditioned on the prompt and causal mask mentioned above, LLMs will generate the probability distribution of the user interaction sequence.
Then we compute the likelihood of our ground-truth user interaction sequence under this distribution. By maximizing the likelihood with the gradient descent algorithm, the soft token embedding of <math alttext="m" class="ltx_Math" display="inline" id="S2.SS3.p5.1.m1.1"><semantics id="S2.SS3.p5.1.m1.1a"><mi id="S2.SS3.p5.1.m1.1.1" xref="S2.SS3.p5.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.1.m1.1b"><ci id="S2.SS3.p5.1.m1.1.1.cmml" xref="S2.SS3.p5.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p5.1.m1.1d">italic_m</annotation></semantics></math>-th user latent profile <math alttext="\theta^{m}" class="ltx_Math" display="inline" id="S2.SS3.p5.2.m2.1"><semantics id="S2.SS3.p5.2.m2.1a"><msup id="S2.SS3.p5.2.m2.1.1" xref="S2.SS3.p5.2.m2.1.1.cmml"><mi id="S2.SS3.p5.2.m2.1.1.2" xref="S2.SS3.p5.2.m2.1.1.2.cmml">θ</mi><mi id="S2.SS3.p5.2.m2.1.1.3" xref="S2.SS3.p5.2.m2.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.2.m2.1b"><apply id="S2.SS3.p5.2.m2.1.1.cmml" xref="S2.SS3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p5.2.m2.1.1.1.cmml" xref="S2.SS3.p5.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.p5.2.m2.1.1.2.cmml" xref="S2.SS3.p5.2.m2.1.1.2">𝜃</ci><ci id="S2.SS3.p5.2.m2.1.1.3.cmml" xref="S2.SS3.p5.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.2.m2.1c">\theta^{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p5.2.m2.1d">italic_θ start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> is backward inferred while freezing the remnant LLMs parameters. Each inferred embedding represents one type of the corresponding profile such as the high income in income background profile, which is important for capturing user preferences.</p>
</div>
<div class="ltx_para" id="S2.SS3.p6">
<p class="ltx_p" id="S2.SS3.p6.5">LLMs aim to predict the user <math alttext="u" class="ltx_Math" display="inline" id="S2.SS3.p6.1.m1.1"><semantics id="S2.SS3.p6.1.m1.1a"><mi id="S2.SS3.p6.1.m1.1.1" xref="S2.SS3.p6.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p6.1.m1.1b"><ci id="S2.SS3.p6.1.m1.1.1.cmml" xref="S2.SS3.p6.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p6.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p6.1.m1.1d">italic_u</annotation></semantics></math>’s interaction history while updating the latent profile variables <math alttext="\theta^{m}" class="ltx_Math" display="inline" id="S2.SS3.p6.2.m2.1"><semantics id="S2.SS3.p6.2.m2.1a"><msup id="S2.SS3.p6.2.m2.1.1" xref="S2.SS3.p6.2.m2.1.1.cmml"><mi id="S2.SS3.p6.2.m2.1.1.2" xref="S2.SS3.p6.2.m2.1.1.2.cmml">θ</mi><mi id="S2.SS3.p6.2.m2.1.1.3" xref="S2.SS3.p6.2.m2.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p6.2.m2.1b"><apply id="S2.SS3.p6.2.m2.1.1.cmml" xref="S2.SS3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p6.2.m2.1.1.1.cmml" xref="S2.SS3.p6.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.p6.2.m2.1.1.2.cmml" xref="S2.SS3.p6.2.m2.1.1.2">𝜃</ci><ci id="S2.SS3.p6.2.m2.1.1.3.cmml" xref="S2.SS3.p6.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p6.2.m2.1c">\theta^{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p6.2.m2.1d">italic_θ start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>. We build the language modeling losses (Cross-Entropy losses) leveraging the ground-truth user interaction history <math alttext="y^{rec}" class="ltx_Math" display="inline" id="S2.SS3.p6.3.m3.1"><semantics id="S2.SS3.p6.3.m3.1a"><msup id="S2.SS3.p6.3.m3.1.1" xref="S2.SS3.p6.3.m3.1.1.cmml"><mi id="S2.SS3.p6.3.m3.1.1.2" xref="S2.SS3.p6.3.m3.1.1.2.cmml">y</mi><mrow id="S2.SS3.p6.3.m3.1.1.3" xref="S2.SS3.p6.3.m3.1.1.3.cmml"><mi id="S2.SS3.p6.3.m3.1.1.3.2" xref="S2.SS3.p6.3.m3.1.1.3.2.cmml">r</mi><mo id="S2.SS3.p6.3.m3.1.1.3.1" xref="S2.SS3.p6.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p6.3.m3.1.1.3.3" xref="S2.SS3.p6.3.m3.1.1.3.3.cmml">e</mi><mo id="S2.SS3.p6.3.m3.1.1.3.1a" xref="S2.SS3.p6.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p6.3.m3.1.1.3.4" xref="S2.SS3.p6.3.m3.1.1.3.4.cmml">c</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p6.3.m3.1b"><apply id="S2.SS3.p6.3.m3.1.1.cmml" xref="S2.SS3.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p6.3.m3.1.1.1.cmml" xref="S2.SS3.p6.3.m3.1.1">superscript</csymbol><ci id="S2.SS3.p6.3.m3.1.1.2.cmml" xref="S2.SS3.p6.3.m3.1.1.2">𝑦</ci><apply id="S2.SS3.p6.3.m3.1.1.3.cmml" xref="S2.SS3.p6.3.m3.1.1.3"><times id="S2.SS3.p6.3.m3.1.1.3.1.cmml" xref="S2.SS3.p6.3.m3.1.1.3.1"></times><ci id="S2.SS3.p6.3.m3.1.1.3.2.cmml" xref="S2.SS3.p6.3.m3.1.1.3.2">𝑟</ci><ci id="S2.SS3.p6.3.m3.1.1.3.3.cmml" xref="S2.SS3.p6.3.m3.1.1.3.3">𝑒</ci><ci id="S2.SS3.p6.3.m3.1.1.3.4.cmml" xref="S2.SS3.p6.3.m3.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p6.3.m3.1c">y^{rec}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p6.3.m3.1d">italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT</annotation></semantics></math> and the generated result <math alttext="\hat{y}^{rec}" class="ltx_Math" display="inline" id="S2.SS3.p6.4.m4.1"><semantics id="S2.SS3.p6.4.m4.1a"><msup id="S2.SS3.p6.4.m4.1.1" xref="S2.SS3.p6.4.m4.1.1.cmml"><mover accent="true" id="S2.SS3.p6.4.m4.1.1.2" xref="S2.SS3.p6.4.m4.1.1.2.cmml"><mi id="S2.SS3.p6.4.m4.1.1.2.2" xref="S2.SS3.p6.4.m4.1.1.2.2.cmml">y</mi><mo id="S2.SS3.p6.4.m4.1.1.2.1" xref="S2.SS3.p6.4.m4.1.1.2.1.cmml">^</mo></mover><mrow id="S2.SS3.p6.4.m4.1.1.3" xref="S2.SS3.p6.4.m4.1.1.3.cmml"><mi id="S2.SS3.p6.4.m4.1.1.3.2" xref="S2.SS3.p6.4.m4.1.1.3.2.cmml">r</mi><mo id="S2.SS3.p6.4.m4.1.1.3.1" xref="S2.SS3.p6.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p6.4.m4.1.1.3.3" xref="S2.SS3.p6.4.m4.1.1.3.3.cmml">e</mi><mo id="S2.SS3.p6.4.m4.1.1.3.1a" xref="S2.SS3.p6.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.p6.4.m4.1.1.3.4" xref="S2.SS3.p6.4.m4.1.1.3.4.cmml">c</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p6.4.m4.1b"><apply id="S2.SS3.p6.4.m4.1.1.cmml" xref="S2.SS3.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p6.4.m4.1.1.1.cmml" xref="S2.SS3.p6.4.m4.1.1">superscript</csymbol><apply id="S2.SS3.p6.4.m4.1.1.2.cmml" xref="S2.SS3.p6.4.m4.1.1.2"><ci id="S2.SS3.p6.4.m4.1.1.2.1.cmml" xref="S2.SS3.p6.4.m4.1.1.2.1">^</ci><ci id="S2.SS3.p6.4.m4.1.1.2.2.cmml" xref="S2.SS3.p6.4.m4.1.1.2.2">𝑦</ci></apply><apply id="S2.SS3.p6.4.m4.1.1.3.cmml" xref="S2.SS3.p6.4.m4.1.1.3"><times id="S2.SS3.p6.4.m4.1.1.3.1.cmml" xref="S2.SS3.p6.4.m4.1.1.3.1"></times><ci id="S2.SS3.p6.4.m4.1.1.3.2.cmml" xref="S2.SS3.p6.4.m4.1.1.3.2">𝑟</ci><ci id="S2.SS3.p6.4.m4.1.1.3.3.cmml" xref="S2.SS3.p6.4.m4.1.1.3.3">𝑒</ci><ci id="S2.SS3.p6.4.m4.1.1.3.4.cmml" xref="S2.SS3.p6.4.m4.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p6.4.m4.1c">\hat{y}^{rec}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p6.4.m4.1d">over^ start_ARG italic_y end_ARG start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>. Specifically, after inferring multiple latent profile variables, the fine-tuning objective is to minimize <math alttext="\mathcal{L}(\theta)=\mathbb{E}_{u}[\ell_{u}(x^{1},x^{2},...,x^{M},y^{rec},%
\theta^{1},\theta^{2},...,\theta^{M})]" class="ltx_Math" display="inline" id="S2.SS3.p6.5.m5.4"><semantics id="S2.SS3.p6.5.m5.4a"><mrow id="S2.SS3.p6.5.m5.4.4" xref="S2.SS3.p6.5.m5.4.4.cmml"><mrow id="S2.SS3.p6.5.m5.4.4.3" xref="S2.SS3.p6.5.m5.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p6.5.m5.4.4.3.2" xref="S2.SS3.p6.5.m5.4.4.3.2.cmml">ℒ</mi><mo id="S2.SS3.p6.5.m5.4.4.3.1" xref="S2.SS3.p6.5.m5.4.4.3.1.cmml">⁢</mo><mrow id="S2.SS3.p6.5.m5.4.4.3.3.2" xref="S2.SS3.p6.5.m5.4.4.3.cmml"><mo id="S2.SS3.p6.5.m5.4.4.3.3.2.1" stretchy="false" xref="S2.SS3.p6.5.m5.4.4.3.cmml">(</mo><mi id="S2.SS3.p6.5.m5.1.1" xref="S2.SS3.p6.5.m5.1.1.cmml">θ</mi><mo id="S2.SS3.p6.5.m5.4.4.3.3.2.2" stretchy="false" xref="S2.SS3.p6.5.m5.4.4.3.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p6.5.m5.4.4.2" xref="S2.SS3.p6.5.m5.4.4.2.cmml">=</mo><mrow id="S2.SS3.p6.5.m5.4.4.1" xref="S2.SS3.p6.5.m5.4.4.1.cmml"><msub id="S2.SS3.p6.5.m5.4.4.1.3" xref="S2.SS3.p6.5.m5.4.4.1.3.cmml"><mi id="S2.SS3.p6.5.m5.4.4.1.3.2" xref="S2.SS3.p6.5.m5.4.4.1.3.2.cmml">𝔼</mi><mi id="S2.SS3.p6.5.m5.4.4.1.3.3" xref="S2.SS3.p6.5.m5.4.4.1.3.3.cmml">u</mi></msub><mo id="S2.SS3.p6.5.m5.4.4.1.2" xref="S2.SS3.p6.5.m5.4.4.1.2.cmml">⁢</mo><mrow id="S2.SS3.p6.5.m5.4.4.1.1.1" xref="S2.SS3.p6.5.m5.4.4.1.1.2.cmml"><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.2" stretchy="false" xref="S2.SS3.p6.5.m5.4.4.1.1.2.1.cmml">[</mo><mrow id="S2.SS3.p6.5.m5.4.4.1.1.1.1" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.cmml"><msub id="S2.SS3.p6.5.m5.4.4.1.1.1.1.9" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.9.cmml"><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.9.2" mathvariant="normal" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.9.2.cmml">ℓ</mi><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.9.3" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.9.3.cmml">u</mi></msub><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.8" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.8.cmml">⁢</mo><mrow id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.8.cmml"><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.8" stretchy="false" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.8.cmml">(</mo><msup id="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1.cmml"><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1.2" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1.2.cmml">x</mi><mn id="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1.3" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.9" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.8.cmml">,</mo><msup id="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2.cmml"><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2.2" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2.2.cmml">x</mi><mn id="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2.3" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2.3.cmml">2</mn></msup><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.10" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.8.cmml">,</mo><mi id="S2.SS3.p6.5.m5.2.2" mathvariant="normal" xref="S2.SS3.p6.5.m5.2.2.cmml">…</mi><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.11" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.8.cmml">,</mo><msup id="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3.cmml"><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3.2" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3.3" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3.3.cmml">M</mi></msup><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.12" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.8.cmml">,</mo><msup id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.cmml"><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.2" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.2.cmml">y</mi><mrow id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.cmml"><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.2" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.2.cmml">r</mi><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.1" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.1.cmml">⁢</mo><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.3" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.3.cmml">e</mi><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.1a" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.1.cmml">⁢</mo><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.4" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.4.cmml">c</mi></mrow></msup><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.13" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.8.cmml">,</mo><msup id="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5.cmml"><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5.2" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5.2.cmml">θ</mi><mn id="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5.3" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5.3.cmml">1</mn></msup><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.14" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.8.cmml">,</mo><msup id="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6.cmml"><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6.2" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6.2.cmml">θ</mi><mn id="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6.3" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6.3.cmml">2</mn></msup><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.15" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.8.cmml">,</mo><mi id="S2.SS3.p6.5.m5.3.3" mathvariant="normal" xref="S2.SS3.p6.5.m5.3.3.cmml">…</mi><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.16" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.8.cmml">,</mo><msup id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7.cmml"><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7.2" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7.2.cmml">θ</mi><mi id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7.3" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7.3.cmml">M</mi></msup><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.17" stretchy="false" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.8.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p6.5.m5.4.4.1.1.1.3" stretchy="false" xref="S2.SS3.p6.5.m5.4.4.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p6.5.m5.4b"><apply id="S2.SS3.p6.5.m5.4.4.cmml" xref="S2.SS3.p6.5.m5.4.4"><eq id="S2.SS3.p6.5.m5.4.4.2.cmml" xref="S2.SS3.p6.5.m5.4.4.2"></eq><apply id="S2.SS3.p6.5.m5.4.4.3.cmml" xref="S2.SS3.p6.5.m5.4.4.3"><times id="S2.SS3.p6.5.m5.4.4.3.1.cmml" xref="S2.SS3.p6.5.m5.4.4.3.1"></times><ci id="S2.SS3.p6.5.m5.4.4.3.2.cmml" xref="S2.SS3.p6.5.m5.4.4.3.2">ℒ</ci><ci id="S2.SS3.p6.5.m5.1.1.cmml" xref="S2.SS3.p6.5.m5.1.1">𝜃</ci></apply><apply id="S2.SS3.p6.5.m5.4.4.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1"><times id="S2.SS3.p6.5.m5.4.4.1.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.2"></times><apply id="S2.SS3.p6.5.m5.4.4.1.3.cmml" xref="S2.SS3.p6.5.m5.4.4.1.3"><csymbol cd="ambiguous" id="S2.SS3.p6.5.m5.4.4.1.3.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.3">subscript</csymbol><ci id="S2.SS3.p6.5.m5.4.4.1.3.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.3.2">𝔼</ci><ci id="S2.SS3.p6.5.m5.4.4.1.3.3.cmml" xref="S2.SS3.p6.5.m5.4.4.1.3.3">𝑢</ci></apply><apply id="S2.SS3.p6.5.m5.4.4.1.1.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1"><csymbol cd="latexml" id="S2.SS3.p6.5.m5.4.4.1.1.2.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS3.p6.5.m5.4.4.1.1.1.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1"><times id="S2.SS3.p6.5.m5.4.4.1.1.1.1.8.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.8"></times><apply id="S2.SS3.p6.5.m5.4.4.1.1.1.1.9.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.9"><csymbol cd="ambiguous" id="S2.SS3.p6.5.m5.4.4.1.1.1.1.9.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.9">subscript</csymbol><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.9.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.9.2">ℓ</ci><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.9.3.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.9.3">𝑢</ci></apply><vector id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.8.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7"><apply id="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1.2">𝑥</ci><cn id="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2.2">𝑥</ci><cn id="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S2.SS3.p6.5.m5.2.2.cmml" xref="S2.SS3.p6.5.m5.2.2">…</ci><apply id="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3">superscript</csymbol><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3.3.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.3.3.3.3">𝑀</ci></apply><apply id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4">superscript</csymbol><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.2">𝑦</ci><apply id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3"><times id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.1"></times><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.2">𝑟</ci><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.3.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.3">𝑒</ci><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.4.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.4.4.4.3.4">𝑐</ci></apply></apply><apply id="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5"><csymbol cd="ambiguous" id="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5">superscript</csymbol><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5.2">𝜃</ci><cn id="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5.3.cmml" type="integer" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.5.5.5.3">1</cn></apply><apply id="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6"><csymbol cd="ambiguous" id="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6">superscript</csymbol><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6.2">𝜃</ci><cn id="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6.3.cmml" type="integer" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.6.6.6.3">2</cn></apply><ci id="S2.SS3.p6.5.m5.3.3.cmml" xref="S2.SS3.p6.5.m5.3.3">…</ci><apply id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7"><csymbol cd="ambiguous" id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7.1.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7">superscript</csymbol><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7.2.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7.2">𝜃</ci><ci id="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7.3.cmml" xref="S2.SS3.p6.5.m5.4.4.1.1.1.1.7.7.7.3">𝑀</ci></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p6.5.m5.4c">\mathcal{L}(\theta)=\mathbb{E}_{u}[\ell_{u}(x^{1},x^{2},...,x^{M},y^{rec},%
\theta^{1},\theta^{2},...,\theta^{M})]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p6.5.m5.4d">caligraphic_L ( italic_θ ) = blackboard_E start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT [ roman_ℓ start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_x start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT ) ]</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E4">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E4X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\ell^{llm}_{u}(x^{1},x^{2},...,x^{M},y^{rec},\theta^{1},\theta^{2%
},...,\theta^{M})" class="ltx_Math" display="inline" id="S2.E4X.2.1.1.m1.9"><semantics id="S2.E4X.2.1.1.m1.9a"><mrow id="S2.E4X.2.1.1.m1.9.9" xref="S2.E4X.2.1.1.m1.9.9.cmml"><msubsup id="S2.E4X.2.1.1.m1.9.9.9" xref="S2.E4X.2.1.1.m1.9.9.9.cmml"><mi id="S2.E4X.2.1.1.m1.9.9.9.2.2" mathsize="90%" mathvariant="normal" xref="S2.E4X.2.1.1.m1.9.9.9.2.2.cmml">ℓ</mi><mi id="S2.E4X.2.1.1.m1.9.9.9.3" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.9.3.cmml">u</mi><mrow id="S2.E4X.2.1.1.m1.9.9.9.2.3" xref="S2.E4X.2.1.1.m1.9.9.9.2.3.cmml"><mi id="S2.E4X.2.1.1.m1.9.9.9.2.3.2" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.9.2.3.2.cmml">l</mi><mo id="S2.E4X.2.1.1.m1.9.9.9.2.3.1" xref="S2.E4X.2.1.1.m1.9.9.9.2.3.1.cmml">⁢</mo><mi id="S2.E4X.2.1.1.m1.9.9.9.2.3.3" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.9.2.3.3.cmml">l</mi><mo id="S2.E4X.2.1.1.m1.9.9.9.2.3.1a" xref="S2.E4X.2.1.1.m1.9.9.9.2.3.1.cmml">⁢</mo><mi id="S2.E4X.2.1.1.m1.9.9.9.2.3.4" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.9.2.3.4.cmml">m</mi></mrow></msubsup><mo id="S2.E4X.2.1.1.m1.9.9.8" xref="S2.E4X.2.1.1.m1.9.9.8.cmml">⁢</mo><mrow id="S2.E4X.2.1.1.m1.9.9.7.7" xref="S2.E4X.2.1.1.m1.9.9.7.8.cmml"><mo id="S2.E4X.2.1.1.m1.9.9.7.7.8" maxsize="90%" minsize="90%" xref="S2.E4X.2.1.1.m1.9.9.7.8.cmml">(</mo><msup id="S2.E4X.2.1.1.m1.3.3.1.1.1" xref="S2.E4X.2.1.1.m1.3.3.1.1.1.cmml"><mi id="S2.E4X.2.1.1.m1.3.3.1.1.1.2" mathsize="90%" xref="S2.E4X.2.1.1.m1.3.3.1.1.1.2.cmml">x</mi><mn id="S2.E4X.2.1.1.m1.3.3.1.1.1.3" mathsize="90%" xref="S2.E4X.2.1.1.m1.3.3.1.1.1.3.cmml">1</mn></msup><mo id="S2.E4X.2.1.1.m1.9.9.7.7.9" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.7.8.cmml">,</mo><msup id="S2.E4X.2.1.1.m1.4.4.2.2.2" xref="S2.E4X.2.1.1.m1.4.4.2.2.2.cmml"><mi id="S2.E4X.2.1.1.m1.4.4.2.2.2.2" mathsize="90%" xref="S2.E4X.2.1.1.m1.4.4.2.2.2.2.cmml">x</mi><mn id="S2.E4X.2.1.1.m1.4.4.2.2.2.3" mathsize="90%" xref="S2.E4X.2.1.1.m1.4.4.2.2.2.3.cmml">2</mn></msup><mo id="S2.E4X.2.1.1.m1.9.9.7.7.10" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.7.8.cmml">,</mo><mi id="S2.E4X.2.1.1.m1.1.1" mathsize="90%" mathvariant="normal" xref="S2.E4X.2.1.1.m1.1.1.cmml">…</mi><mo id="S2.E4X.2.1.1.m1.9.9.7.7.11" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.7.8.cmml">,</mo><msup id="S2.E4X.2.1.1.m1.5.5.3.3.3" xref="S2.E4X.2.1.1.m1.5.5.3.3.3.cmml"><mi id="S2.E4X.2.1.1.m1.5.5.3.3.3.2" mathsize="90%" xref="S2.E4X.2.1.1.m1.5.5.3.3.3.2.cmml">x</mi><mi id="S2.E4X.2.1.1.m1.5.5.3.3.3.3" mathsize="90%" xref="S2.E4X.2.1.1.m1.5.5.3.3.3.3.cmml">M</mi></msup><mo id="S2.E4X.2.1.1.m1.9.9.7.7.12" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.7.8.cmml">,</mo><msup id="S2.E4X.2.1.1.m1.6.6.4.4.4" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.cmml"><mi id="S2.E4X.2.1.1.m1.6.6.4.4.4.2" mathsize="90%" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.2.cmml">y</mi><mrow id="S2.E4X.2.1.1.m1.6.6.4.4.4.3" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.3.cmml"><mi id="S2.E4X.2.1.1.m1.6.6.4.4.4.3.2" mathsize="90%" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.3.2.cmml">r</mi><mo id="S2.E4X.2.1.1.m1.6.6.4.4.4.3.1" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.3.1.cmml">⁢</mo><mi id="S2.E4X.2.1.1.m1.6.6.4.4.4.3.3" mathsize="90%" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.3.3.cmml">e</mi><mo id="S2.E4X.2.1.1.m1.6.6.4.4.4.3.1a" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.3.1.cmml">⁢</mo><mi id="S2.E4X.2.1.1.m1.6.6.4.4.4.3.4" mathsize="90%" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.3.4.cmml">c</mi></mrow></msup><mo id="S2.E4X.2.1.1.m1.9.9.7.7.13" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.7.8.cmml">,</mo><msup id="S2.E4X.2.1.1.m1.7.7.5.5.5" xref="S2.E4X.2.1.1.m1.7.7.5.5.5.cmml"><mi id="S2.E4X.2.1.1.m1.7.7.5.5.5.2" mathsize="90%" xref="S2.E4X.2.1.1.m1.7.7.5.5.5.2.cmml">θ</mi><mn id="S2.E4X.2.1.1.m1.7.7.5.5.5.3" mathsize="90%" xref="S2.E4X.2.1.1.m1.7.7.5.5.5.3.cmml">1</mn></msup><mo id="S2.E4X.2.1.1.m1.9.9.7.7.14" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.7.8.cmml">,</mo><msup id="S2.E4X.2.1.1.m1.8.8.6.6.6" xref="S2.E4X.2.1.1.m1.8.8.6.6.6.cmml"><mi id="S2.E4X.2.1.1.m1.8.8.6.6.6.2" mathsize="90%" xref="S2.E4X.2.1.1.m1.8.8.6.6.6.2.cmml">θ</mi><mn id="S2.E4X.2.1.1.m1.8.8.6.6.6.3" mathsize="90%" xref="S2.E4X.2.1.1.m1.8.8.6.6.6.3.cmml">2</mn></msup><mo id="S2.E4X.2.1.1.m1.9.9.7.7.15" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.7.8.cmml">,</mo><mi id="S2.E4X.2.1.1.m1.2.2" mathsize="90%" mathvariant="normal" xref="S2.E4X.2.1.1.m1.2.2.cmml">…</mi><mo id="S2.E4X.2.1.1.m1.9.9.7.7.16" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.7.8.cmml">,</mo><msup id="S2.E4X.2.1.1.m1.9.9.7.7.7" xref="S2.E4X.2.1.1.m1.9.9.7.7.7.cmml"><mi id="S2.E4X.2.1.1.m1.9.9.7.7.7.2" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.7.7.7.2.cmml">θ</mi><mi id="S2.E4X.2.1.1.m1.9.9.7.7.7.3" mathsize="90%" xref="S2.E4X.2.1.1.m1.9.9.7.7.7.3.cmml">M</mi></msup><mo id="S2.E4X.2.1.1.m1.9.9.7.7.17" maxsize="90%" minsize="90%" xref="S2.E4X.2.1.1.m1.9.9.7.8.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4X.2.1.1.m1.9b"><apply id="S2.E4X.2.1.1.m1.9.9.cmml" xref="S2.E4X.2.1.1.m1.9.9"><times id="S2.E4X.2.1.1.m1.9.9.8.cmml" xref="S2.E4X.2.1.1.m1.9.9.8"></times><apply id="S2.E4X.2.1.1.m1.9.9.9.cmml" xref="S2.E4X.2.1.1.m1.9.9.9"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.9.9.9.1.cmml" xref="S2.E4X.2.1.1.m1.9.9.9">subscript</csymbol><apply id="S2.E4X.2.1.1.m1.9.9.9.2.cmml" xref="S2.E4X.2.1.1.m1.9.9.9"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.9.9.9.2.1.cmml" xref="S2.E4X.2.1.1.m1.9.9.9">superscript</csymbol><ci id="S2.E4X.2.1.1.m1.9.9.9.2.2.cmml" xref="S2.E4X.2.1.1.m1.9.9.9.2.2">ℓ</ci><apply id="S2.E4X.2.1.1.m1.9.9.9.2.3.cmml" xref="S2.E4X.2.1.1.m1.9.9.9.2.3"><times id="S2.E4X.2.1.1.m1.9.9.9.2.3.1.cmml" xref="S2.E4X.2.1.1.m1.9.9.9.2.3.1"></times><ci id="S2.E4X.2.1.1.m1.9.9.9.2.3.2.cmml" xref="S2.E4X.2.1.1.m1.9.9.9.2.3.2">𝑙</ci><ci id="S2.E4X.2.1.1.m1.9.9.9.2.3.3.cmml" xref="S2.E4X.2.1.1.m1.9.9.9.2.3.3">𝑙</ci><ci id="S2.E4X.2.1.1.m1.9.9.9.2.3.4.cmml" xref="S2.E4X.2.1.1.m1.9.9.9.2.3.4">𝑚</ci></apply></apply><ci id="S2.E4X.2.1.1.m1.9.9.9.3.cmml" xref="S2.E4X.2.1.1.m1.9.9.9.3">𝑢</ci></apply><vector id="S2.E4X.2.1.1.m1.9.9.7.8.cmml" xref="S2.E4X.2.1.1.m1.9.9.7.7"><apply id="S2.E4X.2.1.1.m1.3.3.1.1.1.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.1">superscript</csymbol><ci id="S2.E4X.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.1.2">𝑥</ci><cn id="S2.E4X.2.1.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S2.E4X.2.1.1.m1.3.3.1.1.1.3">1</cn></apply><apply id="S2.E4X.2.1.1.m1.4.4.2.2.2.cmml" xref="S2.E4X.2.1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.4.4.2.2.2.1.cmml" xref="S2.E4X.2.1.1.m1.4.4.2.2.2">superscript</csymbol><ci id="S2.E4X.2.1.1.m1.4.4.2.2.2.2.cmml" xref="S2.E4X.2.1.1.m1.4.4.2.2.2.2">𝑥</ci><cn id="S2.E4X.2.1.1.m1.4.4.2.2.2.3.cmml" type="integer" xref="S2.E4X.2.1.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="S2.E4X.2.1.1.m1.1.1.cmml" xref="S2.E4X.2.1.1.m1.1.1">…</ci><apply id="S2.E4X.2.1.1.m1.5.5.3.3.3.cmml" xref="S2.E4X.2.1.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.5.5.3.3.3.1.cmml" xref="S2.E4X.2.1.1.m1.5.5.3.3.3">superscript</csymbol><ci id="S2.E4X.2.1.1.m1.5.5.3.3.3.2.cmml" xref="S2.E4X.2.1.1.m1.5.5.3.3.3.2">𝑥</ci><ci id="S2.E4X.2.1.1.m1.5.5.3.3.3.3.cmml" xref="S2.E4X.2.1.1.m1.5.5.3.3.3.3">𝑀</ci></apply><apply id="S2.E4X.2.1.1.m1.6.6.4.4.4.cmml" xref="S2.E4X.2.1.1.m1.6.6.4.4.4"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.6.6.4.4.4.1.cmml" xref="S2.E4X.2.1.1.m1.6.6.4.4.4">superscript</csymbol><ci id="S2.E4X.2.1.1.m1.6.6.4.4.4.2.cmml" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.2">𝑦</ci><apply id="S2.E4X.2.1.1.m1.6.6.4.4.4.3.cmml" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.3"><times id="S2.E4X.2.1.1.m1.6.6.4.4.4.3.1.cmml" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.3.1"></times><ci id="S2.E4X.2.1.1.m1.6.6.4.4.4.3.2.cmml" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.3.2">𝑟</ci><ci id="S2.E4X.2.1.1.m1.6.6.4.4.4.3.3.cmml" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.3.3">𝑒</ci><ci id="S2.E4X.2.1.1.m1.6.6.4.4.4.3.4.cmml" xref="S2.E4X.2.1.1.m1.6.6.4.4.4.3.4">𝑐</ci></apply></apply><apply id="S2.E4X.2.1.1.m1.7.7.5.5.5.cmml" xref="S2.E4X.2.1.1.m1.7.7.5.5.5"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.7.7.5.5.5.1.cmml" xref="S2.E4X.2.1.1.m1.7.7.5.5.5">superscript</csymbol><ci id="S2.E4X.2.1.1.m1.7.7.5.5.5.2.cmml" xref="S2.E4X.2.1.1.m1.7.7.5.5.5.2">𝜃</ci><cn id="S2.E4X.2.1.1.m1.7.7.5.5.5.3.cmml" type="integer" xref="S2.E4X.2.1.1.m1.7.7.5.5.5.3">1</cn></apply><apply id="S2.E4X.2.1.1.m1.8.8.6.6.6.cmml" xref="S2.E4X.2.1.1.m1.8.8.6.6.6"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.8.8.6.6.6.1.cmml" xref="S2.E4X.2.1.1.m1.8.8.6.6.6">superscript</csymbol><ci id="S2.E4X.2.1.1.m1.8.8.6.6.6.2.cmml" xref="S2.E4X.2.1.1.m1.8.8.6.6.6.2">𝜃</ci><cn id="S2.E4X.2.1.1.m1.8.8.6.6.6.3.cmml" type="integer" xref="S2.E4X.2.1.1.m1.8.8.6.6.6.3">2</cn></apply><ci id="S2.E4X.2.1.1.m1.2.2.cmml" xref="S2.E4X.2.1.1.m1.2.2">…</ci><apply id="S2.E4X.2.1.1.m1.9.9.7.7.7.cmml" xref="S2.E4X.2.1.1.m1.9.9.7.7.7"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.9.9.7.7.7.1.cmml" xref="S2.E4X.2.1.1.m1.9.9.7.7.7">superscript</csymbol><ci id="S2.E4X.2.1.1.m1.9.9.7.7.7.2.cmml" xref="S2.E4X.2.1.1.m1.9.9.7.7.7.2">𝜃</ci><ci id="S2.E4X.2.1.1.m1.9.9.7.7.7.3.cmml" xref="S2.E4X.2.1.1.m1.9.9.7.7.7.3">𝑀</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4X.2.1.1.m1.9c">\displaystyle\ell^{llm}_{u}(x^{1},x^{2},...,x^{M},y^{rec},\theta^{1},\theta^{2%
},...,\theta^{M})</annotation><annotation encoding="application/x-llamapun" id="S2.E4X.2.1.1.m1.9d">roman_ℓ start_POSTSUPERSCRIPT italic_l italic_l italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_x start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E4Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-logP_{LLM}(y^{rec}|x^{1},x^{2},...,x^{M},\theta^{1},\theta^{2},%
...,\theta^{M})" class="ltx_Math" display="inline" id="S2.E4Xa.2.1.1.m1.3"><semantics id="S2.E4Xa.2.1.1.m1.3a"><mrow id="S2.E4Xa.2.1.1.m1.3.3" xref="S2.E4Xa.2.1.1.m1.3.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3.3" xref="S2.E4Xa.2.1.1.m1.3.3.3.cmml"></mi><mo id="S2.E4Xa.2.1.1.m1.3.3.2" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.2.cmml">=</mo><mrow id="S2.E4Xa.2.1.1.m1.3.3.1" xref="S2.E4Xa.2.1.1.m1.3.3.1.cmml"><mo id="S2.E4Xa.2.1.1.m1.3.3.1a" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.cmml">−</mo><mrow id="S2.E4Xa.2.1.1.m1.3.3.1.1" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.3" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.3.cmml">l</mi><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.2" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.2.cmml">⁢</mo><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.4" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.4.cmml">o</mi><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.2a" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.2.cmml">⁢</mo><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.5" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.5.cmml">g</mi><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.2b" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.2.cmml">⁢</mo><msub id="S2.E4Xa.2.1.1.m1.3.3.1.1.6" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.2" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.2.cmml">P</mi><mrow id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.2" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.2.cmml">L</mi><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.1" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.1.cmml">⁢</mo><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.3" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.3.cmml">L</mi><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.1a" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.1.cmml">⁢</mo><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.4" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.4.cmml">M</mi></mrow></msub><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.2c" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml"><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml"><msup id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.2" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.2.cmml">y</mi><mrow id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.2" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.2.cmml">r</mi><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.1" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.1.cmml">⁢</mo><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.3" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.3.cmml">e</mi><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.1a" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.1.cmml">⁢</mo><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.4" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.4.cmml">c</mi></mrow></msup><mo fence="false" id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.7" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.7.cmml">|</mo><mrow id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.7.cmml"><msup id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">x</mi><mn id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.7" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.7.cmml">,</mo><msup id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.cmml">x</mi><mn id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.3" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.3.cmml">2</mn></msup><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.8" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.7.cmml">,</mo><mi id="S2.E4Xa.2.1.1.m1.1.1" mathsize="90%" mathvariant="normal" xref="S2.E4Xa.2.1.1.m1.1.1.cmml">…</mi><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.9" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.7.cmml">,</mo><msup id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3.2" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3.3" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3.3.cmml">M</mi></msup><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.10" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.7.cmml">,</mo><msup id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4.2" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4.2.cmml">θ</mi><mn id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4.3" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4.3.cmml">1</mn></msup><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.11" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.7.cmml">,</mo><msup id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5.2" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5.2.cmml">θ</mi><mn id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5.3" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5.3.cmml">2</mn></msup><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.12" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.7.cmml">,</mo><mi id="S2.E4Xa.2.1.1.m1.2.2" mathsize="90%" mathvariant="normal" xref="S2.E4Xa.2.1.1.m1.2.2.cmml">…</mi><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.13" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.7.cmml">,</mo><msup id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6.cmml"><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6.2" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6.2.cmml">θ</mi><mi id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6.3" mathsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6.3.cmml">M</mi></msup></mrow></mrow><mo id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4Xa.2.1.1.m1.3b"><apply id="S2.E4Xa.2.1.1.m1.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.3.3"><eq id="S2.E4Xa.2.1.1.m1.3.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.2"></eq><csymbol cd="latexml" id="S2.E4Xa.2.1.1.m1.3.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.3">absent</csymbol><apply id="S2.E4Xa.2.1.1.m1.3.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1"><minus id="S2.E4Xa.2.1.1.m1.3.3.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1"></minus><apply id="S2.E4Xa.2.1.1.m1.3.3.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1"><times id="S2.E4Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.2"></times><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.3.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.3">𝑙</ci><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.4.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.4">𝑜</ci><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.5.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.5">𝑔</ci><apply id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6">subscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.2">𝑃</ci><apply id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3"><times id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.1"></times><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.2">𝐿</ci><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.3">𝐿</ci><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.4.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.6.3.4">𝑀</ci></apply></apply><apply id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.7.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.7">conditional</csymbol><apply id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8">superscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.2">𝑦</ci><apply id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3"><times id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.1"></times><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.2">𝑟</ci><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.3">𝑒</ci><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.4.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.8.3.4">𝑐</ci></apply></apply><list id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.7.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6"><apply id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2">𝑥</ci><cn id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2">𝑥</ci><cn id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S2.E4Xa.2.1.1.m1.1.1.cmml" xref="S2.E4Xa.2.1.1.m1.1.1">…</ci><apply id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.3.3.3.3">𝑀</ci></apply><apply id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4">superscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4.2">𝜃</ci><cn id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4.3.cmml" type="integer" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.4.4.4.3">1</cn></apply><apply id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5">superscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5.2">𝜃</ci><cn id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5.3.cmml" type="integer" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.5.5.5.3">2</cn></apply><ci id="S2.E4Xa.2.1.1.m1.2.2.cmml" xref="S2.E4Xa.2.1.1.m1.2.2">…</ci><apply id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6"><csymbol cd="ambiguous" id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6.1.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6">superscript</csymbol><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6.2.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6.2">𝜃</ci><ci id="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6.3.cmml" xref="S2.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.6.6.6.3">𝑀</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4Xa.2.1.1.m1.3c">\displaystyle=-logP_{LLM}(y^{rec}|x^{1},x^{2},...,x^{M},\theta^{1},\theta^{2},%
...,\theta^{M})</annotation><annotation encoding="application/x-llamapun" id="S2.E4Xa.2.1.1.m1.3d">= - italic_l italic_o italic_g italic_P start_POSTSUBSCRIPT italic_L italic_L italic_M end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT | italic_x start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_x start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.p7">
<p class="ltx_p" id="S2.SS3.p7.2">To theoretically prove the effectiveness of our framework, we first suppose the LLMs’ pre-trained data distribution <math alttext="P_{\phi}" class="ltx_Math" display="inline" id="S2.SS3.p7.1.m1.1"><semantics id="S2.SS3.p7.1.m1.1a"><msub id="S2.SS3.p7.1.m1.1.1" xref="S2.SS3.p7.1.m1.1.1.cmml"><mi id="S2.SS3.p7.1.m1.1.1.2" xref="S2.SS3.p7.1.m1.1.1.2.cmml">P</mi><mi id="S2.SS3.p7.1.m1.1.1.3" xref="S2.SS3.p7.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.1.m1.1b"><apply id="S2.SS3.p7.1.m1.1.1.cmml" xref="S2.SS3.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p7.1.m1.1.1.1.cmml" xref="S2.SS3.p7.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p7.1.m1.1.1.2.cmml" xref="S2.SS3.p7.1.m1.1.1.2">𝑃</ci><ci id="S2.SS3.p7.1.m1.1.1.3.cmml" xref="S2.SS3.p7.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.1.m1.1c">P_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> properly approximates the ground-truth data distribution <math alttext="P" class="ltx_Math" display="inline" id="S2.SS3.p7.2.m2.1"><semantics id="S2.SS3.p7.2.m2.1a"><mi id="S2.SS3.p7.2.m2.1.1" xref="S2.SS3.p7.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.2.m2.1b"><ci id="S2.SS3.p7.2.m2.1.1.cmml" xref="S2.SS3.p7.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.2.m2.1d">italic_P</annotation></semantics></math>.</p>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="S2.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Assumption 2.1.</h6>
<div class="ltx_para" id="S2.Thmtheorem1.p1">
<p class="ltx_p" id="S2.Thmtheorem1.p1.17"><span class="ltx_text ltx_font_italic" id="S2.Thmtheorem1.p1.17.17">Assume <math alttext="P_{\phi}(x)=P(x)" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.1.1.m1.2"><semantics id="S2.Thmtheorem1.p1.1.1.m1.2a"><mrow id="S2.Thmtheorem1.p1.1.1.m1.2.3" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.cmml"><mrow id="S2.Thmtheorem1.p1.1.1.m1.2.3.2" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.cmml"><msub id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2.cmml"><mi id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2.2" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2.2.cmml">P</mi><mi id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2.3" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2.3.cmml">ϕ</mi></msub><mo id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.1" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.1.cmml">⁢</mo><mrow id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.3.2" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.cmml"><mo id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.3.2.1" stretchy="false" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.cmml">(</mo><mi id="S2.Thmtheorem1.p1.1.1.m1.1.1" xref="S2.Thmtheorem1.p1.1.1.m1.1.1.cmml">x</mi><mo id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.3.2.2" stretchy="false" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="S2.Thmtheorem1.p1.1.1.m1.2.3.1" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.1.cmml">=</mo><mrow id="S2.Thmtheorem1.p1.1.1.m1.2.3.3" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.3.cmml"><mi id="S2.Thmtheorem1.p1.1.1.m1.2.3.3.2" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.3.2.cmml">P</mi><mo id="S2.Thmtheorem1.p1.1.1.m1.2.3.3.1" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S2.Thmtheorem1.p1.1.1.m1.2.3.3.3.2" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.3.cmml"><mo id="S2.Thmtheorem1.p1.1.1.m1.2.3.3.3.2.1" stretchy="false" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.3.cmml">(</mo><mi id="S2.Thmtheorem1.p1.1.1.m1.2.2" xref="S2.Thmtheorem1.p1.1.1.m1.2.2.cmml">x</mi><mo id="S2.Thmtheorem1.p1.1.1.m1.2.3.3.3.2.2" stretchy="false" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.1.1.m1.2b"><apply id="S2.Thmtheorem1.p1.1.1.m1.2.3.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.3"><eq id="S2.Thmtheorem1.p1.1.1.m1.2.3.1.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.1"></eq><apply id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2"><times id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.1.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.1"></times><apply id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2.1.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2">subscript</csymbol><ci id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2.2.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2.2">𝑃</ci><ci id="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2.3.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.2.2.3">italic-ϕ</ci></apply><ci id="S2.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.1.1">𝑥</ci></apply><apply id="S2.Thmtheorem1.p1.1.1.m1.2.3.3.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.3"><times id="S2.Thmtheorem1.p1.1.1.m1.2.3.3.1.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.3.1"></times><ci id="S2.Thmtheorem1.p1.1.1.m1.2.3.3.2.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.3.3.2">𝑃</ci><ci id="S2.Thmtheorem1.p1.1.1.m1.2.2.cmml" xref="S2.Thmtheorem1.p1.1.1.m1.2.2">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.1.1.m1.2c">P_{\phi}(x)=P(x)</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.1.1.m1.2d">italic_P start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x ) = italic_P ( italic_x )</annotation></semantics></math>,
and <math alttext="P_{\phi}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.2.2.m2.1"><semantics id="S2.Thmtheorem1.p1.2.2.m2.1a"><msub id="S2.Thmtheorem1.p1.2.2.m2.1.1" xref="S2.Thmtheorem1.p1.2.2.m2.1.1.cmml"><mi id="S2.Thmtheorem1.p1.2.2.m2.1.1.2" xref="S2.Thmtheorem1.p1.2.2.m2.1.1.2.cmml">P</mi><mi id="S2.Thmtheorem1.p1.2.2.m2.1.1.3" xref="S2.Thmtheorem1.p1.2.2.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.2.2.m2.1b"><apply id="S2.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S2.Thmtheorem1.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.2.2.m2.1.1.1.cmml" xref="S2.Thmtheorem1.p1.2.2.m2.1.1">subscript</csymbol><ci id="S2.Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="S2.Thmtheorem1.p1.2.2.m2.1.1.2">𝑃</ci><ci id="S2.Thmtheorem1.p1.2.2.m2.1.1.3.cmml" xref="S2.Thmtheorem1.p1.2.2.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.2.2.m2.1c">P_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.2.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>(<math alttext="y^{rec}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.3.3.m3.1"><semantics id="S2.Thmtheorem1.p1.3.3.m3.1a"><msup id="S2.Thmtheorem1.p1.3.3.m3.1.1" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.cmml"><mi id="S2.Thmtheorem1.p1.3.3.m3.1.1.2" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.2.cmml">y</mi><mrow id="S2.Thmtheorem1.p1.3.3.m3.1.1.3" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3.cmml"><mi id="S2.Thmtheorem1.p1.3.3.m3.1.1.3.2" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3.2.cmml">r</mi><mo id="S2.Thmtheorem1.p1.3.3.m3.1.1.3.1" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem1.p1.3.3.m3.1.1.3.3" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3.3.cmml">e</mi><mo id="S2.Thmtheorem1.p1.3.3.m3.1.1.3.1a" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem1.p1.3.3.m3.1.1.3.4" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3.4.cmml">c</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.3.3.m3.1b"><apply id="S2.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S2.Thmtheorem1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="S2.Thmtheorem1.p1.3.3.m3.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.2">𝑦</ci><apply id="S2.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3"><times id="S2.Thmtheorem1.p1.3.3.m3.1.1.3.1.cmml" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3.1"></times><ci id="S2.Thmtheorem1.p1.3.3.m3.1.1.3.2.cmml" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3.2">𝑟</ci><ci id="S2.Thmtheorem1.p1.3.3.m3.1.1.3.3.cmml" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3.3">𝑒</ci><ci id="S2.Thmtheorem1.p1.3.3.m3.1.1.3.4.cmml" xref="S2.Thmtheorem1.p1.3.3.m3.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.3.3.m3.1c">y^{rec}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.3.3.m3.1d">italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>—<math alttext="x^{1}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.4.4.m4.1"><semantics id="S2.Thmtheorem1.p1.4.4.m4.1a"><msup id="S2.Thmtheorem1.p1.4.4.m4.1.1" xref="S2.Thmtheorem1.p1.4.4.m4.1.1.cmml"><mi id="S2.Thmtheorem1.p1.4.4.m4.1.1.2" xref="S2.Thmtheorem1.p1.4.4.m4.1.1.2.cmml">x</mi><mn id="S2.Thmtheorem1.p1.4.4.m4.1.1.3" xref="S2.Thmtheorem1.p1.4.4.m4.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.4.4.m4.1b"><apply id="S2.Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="S2.Thmtheorem1.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.4.4.m4.1.1.1.cmml" xref="S2.Thmtheorem1.p1.4.4.m4.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.4.4.m4.1.1.2.cmml" xref="S2.Thmtheorem1.p1.4.4.m4.1.1.2">𝑥</ci><cn id="S2.Thmtheorem1.p1.4.4.m4.1.1.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.4.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.4.4.m4.1c">x^{1}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.4.4.m4.1d">italic_x start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="x^{2}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.5.5.m5.1"><semantics id="S2.Thmtheorem1.p1.5.5.m5.1a"><msup id="S2.Thmtheorem1.p1.5.5.m5.1.1" xref="S2.Thmtheorem1.p1.5.5.m5.1.1.cmml"><mi id="S2.Thmtheorem1.p1.5.5.m5.1.1.2" xref="S2.Thmtheorem1.p1.5.5.m5.1.1.2.cmml">x</mi><mn id="S2.Thmtheorem1.p1.5.5.m5.1.1.3" xref="S2.Thmtheorem1.p1.5.5.m5.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.5.5.m5.1b"><apply id="S2.Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="S2.Thmtheorem1.p1.5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.5.5.m5.1.1.1.cmml" xref="S2.Thmtheorem1.p1.5.5.m5.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.5.5.m5.1.1.2.cmml" xref="S2.Thmtheorem1.p1.5.5.m5.1.1.2">𝑥</ci><cn id="S2.Thmtheorem1.p1.5.5.m5.1.1.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.5.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.5.5.m5.1c">x^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.5.5.m5.1d">italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, …, <math alttext="x^{M}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.6.6.m6.1"><semantics id="S2.Thmtheorem1.p1.6.6.m6.1a"><msup id="S2.Thmtheorem1.p1.6.6.m6.1.1" xref="S2.Thmtheorem1.p1.6.6.m6.1.1.cmml"><mi id="S2.Thmtheorem1.p1.6.6.m6.1.1.2" xref="S2.Thmtheorem1.p1.6.6.m6.1.1.2.cmml">x</mi><mi id="S2.Thmtheorem1.p1.6.6.m6.1.1.3" xref="S2.Thmtheorem1.p1.6.6.m6.1.1.3.cmml">M</mi></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.6.6.m6.1b"><apply id="S2.Thmtheorem1.p1.6.6.m6.1.1.cmml" xref="S2.Thmtheorem1.p1.6.6.m6.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.6.6.m6.1.1.1.cmml" xref="S2.Thmtheorem1.p1.6.6.m6.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.6.6.m6.1.1.2.cmml" xref="S2.Thmtheorem1.p1.6.6.m6.1.1.2">𝑥</ci><ci id="S2.Thmtheorem1.p1.6.6.m6.1.1.3.cmml" xref="S2.Thmtheorem1.p1.6.6.m6.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.6.6.m6.1c">x^{M}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.6.6.m6.1d">italic_x start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\theta^{1}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.7.7.m7.1"><semantics id="S2.Thmtheorem1.p1.7.7.m7.1a"><msup id="S2.Thmtheorem1.p1.7.7.m7.1.1" xref="S2.Thmtheorem1.p1.7.7.m7.1.1.cmml"><mi id="S2.Thmtheorem1.p1.7.7.m7.1.1.2" xref="S2.Thmtheorem1.p1.7.7.m7.1.1.2.cmml">θ</mi><mn id="S2.Thmtheorem1.p1.7.7.m7.1.1.3" xref="S2.Thmtheorem1.p1.7.7.m7.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.7.7.m7.1b"><apply id="S2.Thmtheorem1.p1.7.7.m7.1.1.cmml" xref="S2.Thmtheorem1.p1.7.7.m7.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.7.7.m7.1.1.1.cmml" xref="S2.Thmtheorem1.p1.7.7.m7.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.7.7.m7.1.1.2.cmml" xref="S2.Thmtheorem1.p1.7.7.m7.1.1.2">𝜃</ci><cn id="S2.Thmtheorem1.p1.7.7.m7.1.1.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.7.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.7.7.m7.1c">\theta^{1}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.7.7.m7.1d">italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\theta^{2}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.8.8.m8.1"><semantics id="S2.Thmtheorem1.p1.8.8.m8.1a"><msup id="S2.Thmtheorem1.p1.8.8.m8.1.1" xref="S2.Thmtheorem1.p1.8.8.m8.1.1.cmml"><mi id="S2.Thmtheorem1.p1.8.8.m8.1.1.2" xref="S2.Thmtheorem1.p1.8.8.m8.1.1.2.cmml">θ</mi><mn id="S2.Thmtheorem1.p1.8.8.m8.1.1.3" xref="S2.Thmtheorem1.p1.8.8.m8.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.8.8.m8.1b"><apply id="S2.Thmtheorem1.p1.8.8.m8.1.1.cmml" xref="S2.Thmtheorem1.p1.8.8.m8.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.8.8.m8.1.1.1.cmml" xref="S2.Thmtheorem1.p1.8.8.m8.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.8.8.m8.1.1.2.cmml" xref="S2.Thmtheorem1.p1.8.8.m8.1.1.2">𝜃</ci><cn id="S2.Thmtheorem1.p1.8.8.m8.1.1.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.8.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.8.8.m8.1c">\theta^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.8.8.m8.1d">italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, …, <math alttext="\theta^{M}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.9.9.m9.1"><semantics id="S2.Thmtheorem1.p1.9.9.m9.1a"><msup id="S2.Thmtheorem1.p1.9.9.m9.1.1" xref="S2.Thmtheorem1.p1.9.9.m9.1.1.cmml"><mi id="S2.Thmtheorem1.p1.9.9.m9.1.1.2" xref="S2.Thmtheorem1.p1.9.9.m9.1.1.2.cmml">θ</mi><mi id="S2.Thmtheorem1.p1.9.9.m9.1.1.3" xref="S2.Thmtheorem1.p1.9.9.m9.1.1.3.cmml">M</mi></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.9.9.m9.1b"><apply id="S2.Thmtheorem1.p1.9.9.m9.1.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.9.9.m9.1.1.1.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.9.9.m9.1.1.2.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.1.1.2">𝜃</ci><ci id="S2.Thmtheorem1.p1.9.9.m9.1.1.3.cmml" xref="S2.Thmtheorem1.p1.9.9.m9.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.9.9.m9.1c">\theta^{M}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.9.9.m9.1d">italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> )
<math alttext="\propto" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.10.10.m10.1"><semantics id="S2.Thmtheorem1.p1.10.10.m10.1a"><mo id="S2.Thmtheorem1.p1.10.10.m10.1.1" xref="S2.Thmtheorem1.p1.10.10.m10.1.1.cmml">∝</mo><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.10.10.m10.1b"><csymbol cd="latexml" id="S2.Thmtheorem1.p1.10.10.m10.1.1.cmml" xref="S2.Thmtheorem1.p1.10.10.m10.1.1">proportional-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.10.10.m10.1c">\propto</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.10.10.m10.1d">∝</annotation></semantics></math> <math alttext="P(y^{rec}|x^{1},x^{2},...,x^{M},\theta^{1},\theta^{2},...,\theta^{M})" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.11.11.m11.3"><semantics id="S2.Thmtheorem1.p1.11.11.m11.3a"><mrow id="S2.Thmtheorem1.p1.11.11.m11.3.3" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.3" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.3.cmml">P</mi><mo id="S2.Thmtheorem1.p1.11.11.m11.3.3.2" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.2.cmml">⁢</mo><mrow id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.cmml"><mo id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.2" stretchy="false" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.cmml">(</mo><mrow id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.cmml"><msup id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.2" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.2.cmml">y</mi><mrow id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.2" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.2.cmml">r</mi><mo id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.1" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.3" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.3.cmml">e</mi><mo id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.1a" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.4" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.4.cmml">c</mi></mrow></msup><mo fence="false" id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.7" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.7.cmml">|</mo><mrow id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.7.cmml"><msup id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1.2" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1.2.cmml">x</mi><mn id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1.3" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.7" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.7.cmml">,</mo><msup id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2.2" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2.2.cmml">x</mi><mn id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2.3" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2.3.cmml">2</mn></msup><mo id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.8" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.7.cmml">,</mo><mi id="S2.Thmtheorem1.p1.11.11.m11.1.1" mathvariant="normal" xref="S2.Thmtheorem1.p1.11.11.m11.1.1.cmml">…</mi><mo id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.9" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.7.cmml">,</mo><msup id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3.2" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3.2.cmml">x</mi><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3.3" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3.3.cmml">M</mi></msup><mo id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.10" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.7.cmml">,</mo><msup id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4.2" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4.2.cmml">θ</mi><mn id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4.3" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4.3.cmml">1</mn></msup><mo id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.11" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.7.cmml">,</mo><msup id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5.2" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5.2.cmml">θ</mi><mn id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5.3" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5.3.cmml">2</mn></msup><mo id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.12" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.7.cmml">,</mo><mi id="S2.Thmtheorem1.p1.11.11.m11.2.2" mathvariant="normal" xref="S2.Thmtheorem1.p1.11.11.m11.2.2.cmml">…</mi><mo id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.13" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.7.cmml">,</mo><msup id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6.cmml"><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6.2" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6.2.cmml">θ</mi><mi id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6.3" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6.3.cmml">M</mi></msup></mrow></mrow><mo id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.3" stretchy="false" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.11.11.m11.3b"><apply id="S2.Thmtheorem1.p1.11.11.m11.3.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3"><times id="S2.Thmtheorem1.p1.11.11.m11.3.3.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.2"></times><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.3">𝑃</ci><apply id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1"><csymbol cd="latexml" id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.7.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.7">conditional</csymbol><apply id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8">superscript</csymbol><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.2">𝑦</ci><apply id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3"><times id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.1"></times><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.2">𝑟</ci><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.3">𝑒</ci><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.4.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.8.3.4">𝑐</ci></apply></apply><list id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.7.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6"><apply id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1.2">𝑥</ci><cn id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2">superscript</csymbol><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2.2">𝑥</ci><cn id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.2.2.2.3">2</cn></apply><ci id="S2.Thmtheorem1.p1.11.11.m11.1.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.1.1">…</ci><apply id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3">superscript</csymbol><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3.2">𝑥</ci><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.3.3.3.3">𝑀</ci></apply><apply id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4">superscript</csymbol><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4.2">𝜃</ci><cn id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.4.4.4.3">1</cn></apply><apply id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5">superscript</csymbol><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5.2">𝜃</ci><cn id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.5.5.5.3">2</cn></apply><ci id="S2.Thmtheorem1.p1.11.11.m11.2.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.2.2">…</ci><apply id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6.1.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6">superscript</csymbol><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6.2.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6.2">𝜃</ci><ci id="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6.3.cmml" xref="S2.Thmtheorem1.p1.11.11.m11.3.3.1.1.1.6.6.6.3">𝑀</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.11.11.m11.3c">P(y^{rec}|x^{1},x^{2},...,x^{M},\theta^{1},\theta^{2},...,\theta^{M})</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.11.11.m11.3d">italic_P ( italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT | italic_x start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_x start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT )</annotation></semantics></math> for the relationship <math alttext="x^{1},x^{2},...,x^{M}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.12.12.m12.4"><semantics id="S2.Thmtheorem1.p1.12.12.m12.4a"><mrow id="S2.Thmtheorem1.p1.12.12.m12.4.4.3" xref="S2.Thmtheorem1.p1.12.12.m12.4.4.4.cmml"><msup id="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1" xref="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1.cmml"><mi id="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1.2" xref="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1.2.cmml">x</mi><mn id="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1.3" xref="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1.3.cmml">1</mn></msup><mo id="S2.Thmtheorem1.p1.12.12.m12.4.4.3.4" xref="S2.Thmtheorem1.p1.12.12.m12.4.4.4.cmml">,</mo><msup id="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2" xref="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2.cmml"><mi id="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2.2" xref="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2.2.cmml">x</mi><mn id="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2.3" xref="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2.3.cmml">2</mn></msup><mo id="S2.Thmtheorem1.p1.12.12.m12.4.4.3.5" xref="S2.Thmtheorem1.p1.12.12.m12.4.4.4.cmml">,</mo><mi id="S2.Thmtheorem1.p1.12.12.m12.1.1" mathvariant="normal" xref="S2.Thmtheorem1.p1.12.12.m12.1.1.cmml">…</mi><mo id="S2.Thmtheorem1.p1.12.12.m12.4.4.3.6" xref="S2.Thmtheorem1.p1.12.12.m12.4.4.4.cmml">,</mo><msup id="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3" xref="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3.cmml"><mi id="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3.2" xref="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3.2.cmml">x</mi><mi id="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3.3" xref="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3.3.cmml">M</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.12.12.m12.4b"><list id="S2.Thmtheorem1.p1.12.12.m12.4.4.4.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.4.4.3"><apply id="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1.1.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1.2.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1.2">𝑥</ci><cn id="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.12.12.m12.2.2.1.1.3">1</cn></apply><apply id="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2.1.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2">superscript</csymbol><ci id="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2.2.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2.2">𝑥</ci><cn id="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.12.12.m12.3.3.2.2.3">2</cn></apply><ci id="S2.Thmtheorem1.p1.12.12.m12.1.1.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.1.1">…</ci><apply id="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3.1.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3">superscript</csymbol><ci id="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3.2.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3.2">𝑥</ci><ci id="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3.3.cmml" xref="S2.Thmtheorem1.p1.12.12.m12.4.4.3.3.3">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.12.12.m12.4c">x^{1},x^{2},...,x^{M}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.12.12.m12.4d">italic_x start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_x start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> <math alttext="\to" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.13.13.m13.1"><semantics id="S2.Thmtheorem1.p1.13.13.m13.1a"><mo id="S2.Thmtheorem1.p1.13.13.m13.1.1" stretchy="false" xref="S2.Thmtheorem1.p1.13.13.m13.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.13.13.m13.1b"><ci id="S2.Thmtheorem1.p1.13.13.m13.1.1.cmml" xref="S2.Thmtheorem1.p1.13.13.m13.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.13.13.m13.1c">\to</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.13.13.m13.1d">→</annotation></semantics></math> <math alttext="y^{rec}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.14.14.m14.1"><semantics id="S2.Thmtheorem1.p1.14.14.m14.1a"><msup id="S2.Thmtheorem1.p1.14.14.m14.1.1" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.cmml"><mi id="S2.Thmtheorem1.p1.14.14.m14.1.1.2" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.2.cmml">y</mi><mrow id="S2.Thmtheorem1.p1.14.14.m14.1.1.3" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.3.cmml"><mi id="S2.Thmtheorem1.p1.14.14.m14.1.1.3.2" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.3.2.cmml">r</mi><mo id="S2.Thmtheorem1.p1.14.14.m14.1.1.3.1" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem1.p1.14.14.m14.1.1.3.3" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.3.3.cmml">e</mi><mo id="S2.Thmtheorem1.p1.14.14.m14.1.1.3.1a" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem1.p1.14.14.m14.1.1.3.4" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.3.4.cmml">c</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.14.14.m14.1b"><apply id="S2.Thmtheorem1.p1.14.14.m14.1.1.cmml" xref="S2.Thmtheorem1.p1.14.14.m14.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.14.14.m14.1.1.1.cmml" xref="S2.Thmtheorem1.p1.14.14.m14.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.14.14.m14.1.1.2.cmml" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.2">𝑦</ci><apply id="S2.Thmtheorem1.p1.14.14.m14.1.1.3.cmml" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.3"><times id="S2.Thmtheorem1.p1.14.14.m14.1.1.3.1.cmml" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.3.1"></times><ci id="S2.Thmtheorem1.p1.14.14.m14.1.1.3.2.cmml" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.3.2">𝑟</ci><ci id="S2.Thmtheorem1.p1.14.14.m14.1.1.3.3.cmml" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.3.3">𝑒</ci><ci id="S2.Thmtheorem1.p1.14.14.m14.1.1.3.4.cmml" xref="S2.Thmtheorem1.p1.14.14.m14.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.14.14.m14.1c">y^{rec}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.14.14.m14.1d">italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT</annotation></semantics></math> <math alttext="\leftarrow" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.15.15.m15.1"><semantics id="S2.Thmtheorem1.p1.15.15.m15.1a"><mo id="S2.Thmtheorem1.p1.15.15.m15.1.1" stretchy="false" xref="S2.Thmtheorem1.p1.15.15.m15.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.15.15.m15.1b"><ci id="S2.Thmtheorem1.p1.15.15.m15.1.1.cmml" xref="S2.Thmtheorem1.p1.15.15.m15.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.15.15.m15.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.15.15.m15.1d">←</annotation></semantics></math> <math alttext="\theta^{1},\theta^{2},...,\theta^{M}" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.16.16.m16.4"><semantics id="S2.Thmtheorem1.p1.16.16.m16.4a"><mrow id="S2.Thmtheorem1.p1.16.16.m16.4.4.3" xref="S2.Thmtheorem1.p1.16.16.m16.4.4.4.cmml"><msup id="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1" xref="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1.cmml"><mi id="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1.2" xref="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1.2.cmml">θ</mi><mn id="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1.3" xref="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1.3.cmml">1</mn></msup><mo id="S2.Thmtheorem1.p1.16.16.m16.4.4.3.4" xref="S2.Thmtheorem1.p1.16.16.m16.4.4.4.cmml">,</mo><msup id="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2" xref="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2.cmml"><mi id="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2.2" xref="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2.2.cmml">θ</mi><mn id="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2.3" xref="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2.3.cmml">2</mn></msup><mo id="S2.Thmtheorem1.p1.16.16.m16.4.4.3.5" xref="S2.Thmtheorem1.p1.16.16.m16.4.4.4.cmml">,</mo><mi id="S2.Thmtheorem1.p1.16.16.m16.1.1" mathvariant="normal" xref="S2.Thmtheorem1.p1.16.16.m16.1.1.cmml">…</mi><mo id="S2.Thmtheorem1.p1.16.16.m16.4.4.3.6" xref="S2.Thmtheorem1.p1.16.16.m16.4.4.4.cmml">,</mo><msup id="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3" xref="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3.cmml"><mi id="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3.2" xref="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3.2.cmml">θ</mi><mi id="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3.3" xref="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3.3.cmml">M</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.16.16.m16.4b"><list id="S2.Thmtheorem1.p1.16.16.m16.4.4.4.cmml" xref="S2.Thmtheorem1.p1.16.16.m16.4.4.3"><apply id="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1.cmml" xref="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1.1.cmml" xref="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1">superscript</csymbol><ci id="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1.2.cmml" xref="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1.2">𝜃</ci><cn id="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.16.16.m16.2.2.1.1.3">1</cn></apply><apply id="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2.cmml" xref="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2.1.cmml" xref="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2">superscript</csymbol><ci id="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2.2.cmml" xref="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2.2">𝜃</ci><cn id="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2.3.cmml" type="integer" xref="S2.Thmtheorem1.p1.16.16.m16.3.3.2.2.3">2</cn></apply><ci id="S2.Thmtheorem1.p1.16.16.m16.1.1.cmml" xref="S2.Thmtheorem1.p1.16.16.m16.1.1">…</ci><apply id="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3.cmml" xref="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3"><csymbol cd="ambiguous" id="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3.1.cmml" xref="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3">superscript</csymbol><ci id="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3.2.cmml" xref="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3.2">𝜃</ci><ci id="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3.3.cmml" xref="S2.Thmtheorem1.p1.16.16.m16.4.4.3.3.3">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.16.16.m16.4c">\theta^{1},\theta^{2},...,\theta^{M}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.16.16.m16.4d">italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>, where the user latent profile variable <math alttext="\theta" class="ltx_Math" display="inline" id="S2.Thmtheorem1.p1.17.17.m17.1"><semantics id="S2.Thmtheorem1.p1.17.17.m17.1a"><mi id="S2.Thmtheorem1.p1.17.17.m17.1.1" xref="S2.Thmtheorem1.p1.17.17.m17.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem1.p1.17.17.m17.1b"><ci id="S2.Thmtheorem1.p1.17.17.m17.1.1.cmml" xref="S2.Thmtheorem1.p1.17.17.m17.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem1.p1.17.17.m17.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem1.p1.17.17.m17.1d">italic_θ</annotation></semantics></math> is i.i.d.</span></p>
</div>
</div>
<div class="ltx_para" id="S2.SS3.p8">
<p class="ltx_p" id="S2.SS3.p8.1">This assumption is common in existing LLMs literature, which shows LLMs identify the true distribution of language. Furthermore, the following proposition is obtained,</p>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="S2.Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Proposition 2.2.</h6>
<div class="ltx_para" id="S2.Thmtheorem2.p1">
<p class="ltx_p" id="S2.Thmtheorem2.p1.11"><span class="ltx_text ltx_font_italic" id="S2.Thmtheorem2.p1.11.11">As the number of user latent profile categories <math alttext="M" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.1.1.m1.1"><semantics id="S2.Thmtheorem2.p1.1.1.m1.1a"><mi id="S2.Thmtheorem2.p1.1.1.m1.1.1" xref="S2.Thmtheorem2.p1.1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.1.1.m1.1b"><ci id="S2.Thmtheorem2.p1.1.1.m1.1.1.cmml" xref="S2.Thmtheorem2.p1.1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.1.1.m1.1d">italic_M</annotation></semantics></math> increases, the predictor <math alttext="arg\max_{y^{rec}\in\mathcal{Y}}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.2.2.m2.1"><semantics id="S2.Thmtheorem2.p1.2.2.m2.1a"><mrow id="S2.Thmtheorem2.p1.2.2.m2.1.1" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.cmml"><mi id="S2.Thmtheorem2.p1.2.2.m2.1.1.2" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.2.cmml">a</mi><mo id="S2.Thmtheorem2.p1.2.2.m2.1.1.1" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.Thmtheorem2.p1.2.2.m2.1.1.3" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.3.cmml">r</mi><mo id="S2.Thmtheorem2.p1.2.2.m2.1.1.1a" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.Thmtheorem2.p1.2.2.m2.1.1.4" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.4.cmml">g</mi><mo id="S2.Thmtheorem2.p1.2.2.m2.1.1.1b" lspace="0.167em" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.1.cmml">⁢</mo><msub id="S2.Thmtheorem2.p1.2.2.m2.1.1.5" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.cmml"><mi id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.2" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.2.cmml">max</mi><mrow id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.cmml"><msup id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.cmml"><mi id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.2" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.2.cmml">y</mi><mrow id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.cmml"><mi id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.2" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.2.cmml">r</mi><mo id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.1" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.3" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.3.cmml">e</mi><mo id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.1a" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.4" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.4.cmml">c</mi></mrow></msup><mo id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.1" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.3" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.3.cmml">𝒴</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.2.2.m2.1b"><apply id="S2.Thmtheorem2.p1.2.2.m2.1.1.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1"><times id="S2.Thmtheorem2.p1.2.2.m2.1.1.1.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.1"></times><ci id="S2.Thmtheorem2.p1.2.2.m2.1.1.2.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.2">𝑎</ci><ci id="S2.Thmtheorem2.p1.2.2.m2.1.1.3.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.3">𝑟</ci><ci id="S2.Thmtheorem2.p1.2.2.m2.1.1.4.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.4">𝑔</ci><apply id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.1.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5">subscript</csymbol><max id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.2.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.2"></max><apply id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3"><in id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.1.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.1"></in><apply id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.1.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2">superscript</csymbol><ci id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.2.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.2">𝑦</ci><apply id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3"><times id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.1.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.1"></times><ci id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.2.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.2">𝑟</ci><ci id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.3.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.3">𝑒</ci><ci id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.4.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.2.3.4">𝑐</ci></apply></apply><ci id="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.3.cmml" xref="S2.Thmtheorem2.p1.2.2.m2.1.1.5.3.3">𝒴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.2.2.m2.1c">arg\max_{y^{rec}\in\mathcal{Y}}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.2.2.m2.1d">italic_a italic_r italic_g roman_max start_POSTSUBSCRIPT italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT ∈ caligraphic_Y end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="P_{\phi}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.3.3.m3.1"><semantics id="S2.Thmtheorem2.p1.3.3.m3.1a"><msub id="S2.Thmtheorem2.p1.3.3.m3.1.1" xref="S2.Thmtheorem2.p1.3.3.m3.1.1.cmml"><mi id="S2.Thmtheorem2.p1.3.3.m3.1.1.2" xref="S2.Thmtheorem2.p1.3.3.m3.1.1.2.cmml">P</mi><mi id="S2.Thmtheorem2.p1.3.3.m3.1.1.3" xref="S2.Thmtheorem2.p1.3.3.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.3.3.m3.1b"><apply id="S2.Thmtheorem2.p1.3.3.m3.1.1.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.3.3.m3.1.1.1.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.1.1">subscript</csymbol><ci id="S2.Thmtheorem2.p1.3.3.m3.1.1.2.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.1.1.2">𝑃</ci><ci id="S2.Thmtheorem2.p1.3.3.m3.1.1.3.cmml" xref="S2.Thmtheorem2.p1.3.3.m3.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.3.3.m3.1c">P_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.3.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>(<math alttext="y^{rec}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.4.4.m4.1"><semantics id="S2.Thmtheorem2.p1.4.4.m4.1a"><msup id="S2.Thmtheorem2.p1.4.4.m4.1.1" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.cmml"><mi id="S2.Thmtheorem2.p1.4.4.m4.1.1.2" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.2.cmml">y</mi><mrow id="S2.Thmtheorem2.p1.4.4.m4.1.1.3" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3.cmml"><mi id="S2.Thmtheorem2.p1.4.4.m4.1.1.3.2" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3.2.cmml">r</mi><mo id="S2.Thmtheorem2.p1.4.4.m4.1.1.3.1" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem2.p1.4.4.m4.1.1.3.3" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3.3.cmml">e</mi><mo id="S2.Thmtheorem2.p1.4.4.m4.1.1.3.1a" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem2.p1.4.4.m4.1.1.3.4" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3.4.cmml">c</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.4.4.m4.1b"><apply id="S2.Thmtheorem2.p1.4.4.m4.1.1.cmml" xref="S2.Thmtheorem2.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.4.4.m4.1.1.1.cmml" xref="S2.Thmtheorem2.p1.4.4.m4.1.1">superscript</csymbol><ci id="S2.Thmtheorem2.p1.4.4.m4.1.1.2.cmml" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.2">𝑦</ci><apply id="S2.Thmtheorem2.p1.4.4.m4.1.1.3.cmml" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3"><times id="S2.Thmtheorem2.p1.4.4.m4.1.1.3.1.cmml" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3.1"></times><ci id="S2.Thmtheorem2.p1.4.4.m4.1.1.3.2.cmml" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3.2">𝑟</ci><ci id="S2.Thmtheorem2.p1.4.4.m4.1.1.3.3.cmml" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3.3">𝑒</ci><ci id="S2.Thmtheorem2.p1.4.4.m4.1.1.3.4.cmml" xref="S2.Thmtheorem2.p1.4.4.m4.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.4.4.m4.1c">y^{rec}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.4.4.m4.1d">italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>—<math alttext="x^{1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.5.5.m5.1"><semantics id="S2.Thmtheorem2.p1.5.5.m5.1a"><msup id="S2.Thmtheorem2.p1.5.5.m5.1.1" xref="S2.Thmtheorem2.p1.5.5.m5.1.1.cmml"><mi id="S2.Thmtheorem2.p1.5.5.m5.1.1.2" xref="S2.Thmtheorem2.p1.5.5.m5.1.1.2.cmml">x</mi><mn id="S2.Thmtheorem2.p1.5.5.m5.1.1.3" xref="S2.Thmtheorem2.p1.5.5.m5.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.5.5.m5.1b"><apply id="S2.Thmtheorem2.p1.5.5.m5.1.1.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.5.5.m5.1.1.1.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.1.1">superscript</csymbol><ci id="S2.Thmtheorem2.p1.5.5.m5.1.1.2.cmml" xref="S2.Thmtheorem2.p1.5.5.m5.1.1.2">𝑥</ci><cn id="S2.Thmtheorem2.p1.5.5.m5.1.1.3.cmml" type="integer" xref="S2.Thmtheorem2.p1.5.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.5.5.m5.1c">x^{1}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.5.5.m5.1d">italic_x start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="x^{2}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.6.6.m6.1"><semantics id="S2.Thmtheorem2.p1.6.6.m6.1a"><msup id="S2.Thmtheorem2.p1.6.6.m6.1.1" xref="S2.Thmtheorem2.p1.6.6.m6.1.1.cmml"><mi id="S2.Thmtheorem2.p1.6.6.m6.1.1.2" xref="S2.Thmtheorem2.p1.6.6.m6.1.1.2.cmml">x</mi><mn id="S2.Thmtheorem2.p1.6.6.m6.1.1.3" xref="S2.Thmtheorem2.p1.6.6.m6.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.6.6.m6.1b"><apply id="S2.Thmtheorem2.p1.6.6.m6.1.1.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.6.6.m6.1.1.1.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.1.1">superscript</csymbol><ci id="S2.Thmtheorem2.p1.6.6.m6.1.1.2.cmml" xref="S2.Thmtheorem2.p1.6.6.m6.1.1.2">𝑥</ci><cn id="S2.Thmtheorem2.p1.6.6.m6.1.1.3.cmml" type="integer" xref="S2.Thmtheorem2.p1.6.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.6.6.m6.1c">x^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.6.6.m6.1d">italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, …, <math alttext="x^{M}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.7.7.m7.1"><semantics id="S2.Thmtheorem2.p1.7.7.m7.1a"><msup id="S2.Thmtheorem2.p1.7.7.m7.1.1" xref="S2.Thmtheorem2.p1.7.7.m7.1.1.cmml"><mi id="S2.Thmtheorem2.p1.7.7.m7.1.1.2" xref="S2.Thmtheorem2.p1.7.7.m7.1.1.2.cmml">x</mi><mi id="S2.Thmtheorem2.p1.7.7.m7.1.1.3" xref="S2.Thmtheorem2.p1.7.7.m7.1.1.3.cmml">M</mi></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.7.7.m7.1b"><apply id="S2.Thmtheorem2.p1.7.7.m7.1.1.cmml" xref="S2.Thmtheorem2.p1.7.7.m7.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.7.7.m7.1.1.1.cmml" xref="S2.Thmtheorem2.p1.7.7.m7.1.1">superscript</csymbol><ci id="S2.Thmtheorem2.p1.7.7.m7.1.1.2.cmml" xref="S2.Thmtheorem2.p1.7.7.m7.1.1.2">𝑥</ci><ci id="S2.Thmtheorem2.p1.7.7.m7.1.1.3.cmml" xref="S2.Thmtheorem2.p1.7.7.m7.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.7.7.m7.1c">x^{M}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.7.7.m7.1d">italic_x start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\theta^{1}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.8.8.m8.1"><semantics id="S2.Thmtheorem2.p1.8.8.m8.1a"><msup id="S2.Thmtheorem2.p1.8.8.m8.1.1" xref="S2.Thmtheorem2.p1.8.8.m8.1.1.cmml"><mi id="S2.Thmtheorem2.p1.8.8.m8.1.1.2" xref="S2.Thmtheorem2.p1.8.8.m8.1.1.2.cmml">θ</mi><mn id="S2.Thmtheorem2.p1.8.8.m8.1.1.3" xref="S2.Thmtheorem2.p1.8.8.m8.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.8.8.m8.1b"><apply id="S2.Thmtheorem2.p1.8.8.m8.1.1.cmml" xref="S2.Thmtheorem2.p1.8.8.m8.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.8.8.m8.1.1.1.cmml" xref="S2.Thmtheorem2.p1.8.8.m8.1.1">superscript</csymbol><ci id="S2.Thmtheorem2.p1.8.8.m8.1.1.2.cmml" xref="S2.Thmtheorem2.p1.8.8.m8.1.1.2">𝜃</ci><cn id="S2.Thmtheorem2.p1.8.8.m8.1.1.3.cmml" type="integer" xref="S2.Thmtheorem2.p1.8.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.8.8.m8.1c">\theta^{1}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.8.8.m8.1d">italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\theta^{2}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.9.9.m9.1"><semantics id="S2.Thmtheorem2.p1.9.9.m9.1a"><msup id="S2.Thmtheorem2.p1.9.9.m9.1.1" xref="S2.Thmtheorem2.p1.9.9.m9.1.1.cmml"><mi id="S2.Thmtheorem2.p1.9.9.m9.1.1.2" xref="S2.Thmtheorem2.p1.9.9.m9.1.1.2.cmml">θ</mi><mn id="S2.Thmtheorem2.p1.9.9.m9.1.1.3" xref="S2.Thmtheorem2.p1.9.9.m9.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.9.9.m9.1b"><apply id="S2.Thmtheorem2.p1.9.9.m9.1.1.cmml" xref="S2.Thmtheorem2.p1.9.9.m9.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.9.9.m9.1.1.1.cmml" xref="S2.Thmtheorem2.p1.9.9.m9.1.1">superscript</csymbol><ci id="S2.Thmtheorem2.p1.9.9.m9.1.1.2.cmml" xref="S2.Thmtheorem2.p1.9.9.m9.1.1.2">𝜃</ci><cn id="S2.Thmtheorem2.p1.9.9.m9.1.1.3.cmml" type="integer" xref="S2.Thmtheorem2.p1.9.9.m9.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.9.9.m9.1c">\theta^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.9.9.m9.1d">italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, …, <math alttext="\theta^{M}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.10.10.m10.1"><semantics id="S2.Thmtheorem2.p1.10.10.m10.1a"><msup id="S2.Thmtheorem2.p1.10.10.m10.1.1" xref="S2.Thmtheorem2.p1.10.10.m10.1.1.cmml"><mi id="S2.Thmtheorem2.p1.10.10.m10.1.1.2" xref="S2.Thmtheorem2.p1.10.10.m10.1.1.2.cmml">θ</mi><mi id="S2.Thmtheorem2.p1.10.10.m10.1.1.3" xref="S2.Thmtheorem2.p1.10.10.m10.1.1.3.cmml">M</mi></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.10.10.m10.1b"><apply id="S2.Thmtheorem2.p1.10.10.m10.1.1.cmml" xref="S2.Thmtheorem2.p1.10.10.m10.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.10.10.m10.1.1.1.cmml" xref="S2.Thmtheorem2.p1.10.10.m10.1.1">superscript</csymbol><ci id="S2.Thmtheorem2.p1.10.10.m10.1.1.2.cmml" xref="S2.Thmtheorem2.p1.10.10.m10.1.1.2">𝜃</ci><ci id="S2.Thmtheorem2.p1.10.10.m10.1.1.3.cmml" xref="S2.Thmtheorem2.p1.10.10.m10.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.10.10.m10.1c">\theta^{M}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.10.10.m10.1d">italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> ) is the optimal predictor, and the generated interaction history <math alttext="y^{rec}" class="ltx_Math" display="inline" id="S2.Thmtheorem2.p1.11.11.m11.1"><semantics id="S2.Thmtheorem2.p1.11.11.m11.1a"><msup id="S2.Thmtheorem2.p1.11.11.m11.1.1" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.cmml"><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.2" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.2.cmml">y</mi><mrow id="S2.Thmtheorem2.p1.11.11.m11.1.1.3" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3.cmml"><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.3.2" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3.2.cmml">r</mi><mo id="S2.Thmtheorem2.p1.11.11.m11.1.1.3.1" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.3.3" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3.3.cmml">e</mi><mo id="S2.Thmtheorem2.p1.11.11.m11.1.1.3.1a" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S2.Thmtheorem2.p1.11.11.m11.1.1.3.4" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3.4.cmml">c</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.Thmtheorem2.p1.11.11.m11.1b"><apply id="S2.Thmtheorem2.p1.11.11.m11.1.1.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1"><csymbol cd="ambiguous" id="S2.Thmtheorem2.p1.11.11.m11.1.1.1.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1">superscript</csymbol><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.2.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.2">𝑦</ci><apply id="S2.Thmtheorem2.p1.11.11.m11.1.1.3.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3"><times id="S2.Thmtheorem2.p1.11.11.m11.1.1.3.1.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3.1"></times><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.3.2.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3.2">𝑟</ci><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.3.3.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3.3">𝑒</ci><ci id="S2.Thmtheorem2.p1.11.11.m11.1.1.3.4.cmml" xref="S2.Thmtheorem2.p1.11.11.m11.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Thmtheorem2.p1.11.11.m11.1c">y^{rec}</annotation><annotation encoding="application/x-llamapun" id="S2.Thmtheorem2.p1.11.11.m11.1d">italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT</annotation></semantics></math> is closer to the ground-truth interaction history, and the inferred user latent profile variable is more accurate and benefits recommendation task.
<span class="ltx_text ltx_font_bold" id="S2.Thmtheorem2.p1.11.11.1">Proof.</span> See the Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#A1.SS1" title="A.1. Theoretical Analysis ‣ Appendix A Appendix ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">A.1</span></a></span></p>
</div>
</div>
<div class="ltx_para" id="S2.SS3.p9">
<p class="ltx_p" id="S2.SS3.p9.1">From the proposition, as the user latent profile categories grow, the inferred user latent profile variable is selected as a satisfactory consequence of inference.</p>
</div>
<div class="ltx_para" id="S2.SS3.p10">
<p class="ltx_p" id="S2.SS3.p10.1">Then, the learned latent profile variables are input into the UserIP quantization module to eliminate the out-of-range noises.
</p>
</div>
<figure class="ltx_figure" id="S2.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="619" id="S2.F4.g1" src="x5.png" width="580"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Causal relationship (Upper) between missing user profiles and behaviors. The curve means the causal direction. Note that latent profiles are independent of each other. Causal mask (Below) in UserIP Inference Module. The blue (gray) square denotes that column <math alttext="j" class="ltx_Math" display="inline" id="S2.F4.3.m1.1"><semantics id="S2.F4.3.m1.1b"><mi id="S2.F4.3.m1.1.1" xref="S2.F4.3.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.F4.3.m1.1c"><ci id="S2.F4.3.m1.1.1.cmml" xref="S2.F4.3.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.3.m1.1d">j</annotation><annotation encoding="application/x-llamapun" id="S2.F4.3.m1.1e">italic_j</annotation></semantics></math> will (not) attend to row <math alttext="i" class="ltx_Math" display="inline" id="S2.F4.4.m2.1"><semantics id="S2.F4.4.m2.1b"><mi id="S2.F4.4.m2.1.1" xref="S2.F4.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.F4.4.m2.1c"><ci id="S2.F4.4.m2.1.1.cmml" xref="S2.F4.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.4.m2.1d">i</annotation><annotation encoding="application/x-llamapun" id="S2.F4.4.m2.1e">italic_i</annotation></semantics></math>.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4. </span>UserIP Quantization Module</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">One problem of latent profile embeddings inferred in the previous section is they are within the LLMs’ semantics space. These embeddings contain rich semantic information for NLP tasks but may be too detailed for recommendation tasks. Because the latter task only needs the collaborative signal to train a profile representation. Besides, the embedding dimension of LLMs is too huge for recommendation tasks to perform efficient online reasoning.</p>
</div>
<div class="ltx_para" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.4">To bridge the modality gaps between the NLP tasks and recommendation tasks and further improve model efficiency. The UserIP quantization module is designed to extract light collaborative IDs from latent profile embeddings.
We assign one collaborative quantization codebook <math alttext="\mathcal{C}^{m}" class="ltx_Math" display="inline" id="S2.SS4.p2.1.m1.1"><semantics id="S2.SS4.p2.1.m1.1a"><msup id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p2.1.m1.1.1.2" xref="S2.SS4.p2.1.m1.1.1.2.cmml">𝒞</mi><mi id="S2.SS4.p2.1.m1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.1b"><apply id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1">superscript</csymbol><ci id="S2.SS4.p2.1.m1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.2">𝒞</ci><ci id="S2.SS4.p2.1.m1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.1c">\mathcal{C}^{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.1.m1.1d">caligraphic_C start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> for each inferred latent profile. And for each codebook, we set the code size as <math alttext="K" class="ltx_Math" display="inline" id="S2.SS4.p2.2.m2.1"><semantics id="S2.SS4.p2.2.m2.1a"><mi id="S2.SS4.p2.2.m2.1.1" xref="S2.SS4.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.2.m2.1b"><ci id="S2.SS4.p2.2.m2.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.2.m2.1d">italic_K</annotation></semantics></math>. Embedding for <math alttext="k^{th}" class="ltx_Math" display="inline" id="S2.SS4.p2.3.m3.1"><semantics id="S2.SS4.p2.3.m3.1a"><msup id="S2.SS4.p2.3.m3.1.1" xref="S2.SS4.p2.3.m3.1.1.cmml"><mi id="S2.SS4.p2.3.m3.1.1.2" xref="S2.SS4.p2.3.m3.1.1.2.cmml">k</mi><mrow id="S2.SS4.p2.3.m3.1.1.3" xref="S2.SS4.p2.3.m3.1.1.3.cmml"><mi id="S2.SS4.p2.3.m3.1.1.3.2" xref="S2.SS4.p2.3.m3.1.1.3.2.cmml">t</mi><mo id="S2.SS4.p2.3.m3.1.1.3.1" xref="S2.SS4.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS4.p2.3.m3.1.1.3.3" xref="S2.SS4.p2.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.3.m3.1b"><apply id="S2.SS4.p2.3.m3.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.3.m3.1.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1">superscript</csymbol><ci id="S2.SS4.p2.3.m3.1.1.2.cmml" xref="S2.SS4.p2.3.m3.1.1.2">𝑘</ci><apply id="S2.SS4.p2.3.m3.1.1.3.cmml" xref="S2.SS4.p2.3.m3.1.1.3"><times id="S2.SS4.p2.3.m3.1.1.3.1.cmml" xref="S2.SS4.p2.3.m3.1.1.3.1"></times><ci id="S2.SS4.p2.3.m3.1.1.3.2.cmml" xref="S2.SS4.p2.3.m3.1.1.3.2">𝑡</ci><ci id="S2.SS4.p2.3.m3.1.1.3.3.cmml" xref="S2.SS4.p2.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.3.m3.1c">k^{th}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.3.m3.1d">italic_k start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> code is represented as <math alttext="\{\boldsymbol{v}^{m}_{k}\}" class="ltx_Math" display="inline" id="S2.SS4.p2.4.m4.1"><semantics id="S2.SS4.p2.4.m4.1a"><mrow id="S2.SS4.p2.4.m4.1.1.1" xref="S2.SS4.p2.4.m4.1.1.2.cmml"><mo id="S2.SS4.p2.4.m4.1.1.1.2" stretchy="false" xref="S2.SS4.p2.4.m4.1.1.2.cmml">{</mo><msubsup id="S2.SS4.p2.4.m4.1.1.1.1" xref="S2.SS4.p2.4.m4.1.1.1.1.cmml"><mi id="S2.SS4.p2.4.m4.1.1.1.1.2.2" xref="S2.SS4.p2.4.m4.1.1.1.1.2.2.cmml">𝒗</mi><mi id="S2.SS4.p2.4.m4.1.1.1.1.3" xref="S2.SS4.p2.4.m4.1.1.1.1.3.cmml">k</mi><mi id="S2.SS4.p2.4.m4.1.1.1.1.2.3" xref="S2.SS4.p2.4.m4.1.1.1.1.2.3.cmml">m</mi></msubsup><mo id="S2.SS4.p2.4.m4.1.1.1.3" stretchy="false" xref="S2.SS4.p2.4.m4.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.4.m4.1b"><set id="S2.SS4.p2.4.m4.1.1.2.cmml" xref="S2.SS4.p2.4.m4.1.1.1"><apply id="S2.SS4.p2.4.m4.1.1.1.1.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.4.m4.1.1.1.1.1.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1">subscript</csymbol><apply id="S2.SS4.p2.4.m4.1.1.1.1.2.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.4.m4.1.1.1.1.2.1.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1">superscript</csymbol><ci id="S2.SS4.p2.4.m4.1.1.1.1.2.2.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1.2.2">𝒗</ci><ci id="S2.SS4.p2.4.m4.1.1.1.1.2.3.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1.2.3">𝑚</ci></apply><ci id="S2.SS4.p2.4.m4.1.1.1.1.3.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.4.m4.1c">\{\boldsymbol{v}^{m}_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.4.m4.1d">{ bold_italic_v start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS4.p3">
<p class="ltx_p" id="S2.SS4.p3.1">The codebook learning process differs from the vanilla CV/NLP model <cite class="ltx_cite ltx_citemacro_citep">(van den Oord et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib31" title="">2017</a>; Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib25" title="">2023</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib43" title="">2023</a>)</cite>, where only semantic distance is used as the supervision for quantization. In UserIP, the embedding is used in online recommendations where modeling collaboration is the key objective. Thus UserIP’s embedding similarity should also based on the collaborative signal (E.g. see the Beer &amp; Diapers case, even if they differ in semantic space, they are close in the collaborative space).</p>
</div>
<div class="ltx_para" id="S2.SS4.p4">
<p class="ltx_p" id="S2.SS4.p4.8">To integreted the collaborative objective, we designed the following loss function (formula <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.E5" title="In 2.4. UserIP Quantization Module ‣ 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">5</span></a>). The first term of the loss function drag the codebook close to the latent profile space. <math alttext="sg[\cdot]" class="ltx_Math" display="inline" id="S2.SS4.p4.1.m1.1"><semantics id="S2.SS4.p4.1.m1.1a"><mrow id="S2.SS4.p4.1.m1.1.2" xref="S2.SS4.p4.1.m1.1.2.cmml"><mi id="S2.SS4.p4.1.m1.1.2.2" xref="S2.SS4.p4.1.m1.1.2.2.cmml">s</mi><mo id="S2.SS4.p4.1.m1.1.2.1" xref="S2.SS4.p4.1.m1.1.2.1.cmml">⁢</mo><mi id="S2.SS4.p4.1.m1.1.2.3" xref="S2.SS4.p4.1.m1.1.2.3.cmml">g</mi><mo id="S2.SS4.p4.1.m1.1.2.1a" xref="S2.SS4.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS4.p4.1.m1.1.2.4.2" xref="S2.SS4.p4.1.m1.1.2.4.1.cmml"><mo id="S2.SS4.p4.1.m1.1.2.4.2.1" stretchy="false" xref="S2.SS4.p4.1.m1.1.2.4.1.1.cmml">[</mo><mo id="S2.SS4.p4.1.m1.1.1" lspace="0em" rspace="0em" xref="S2.SS4.p4.1.m1.1.1.cmml">⋅</mo><mo id="S2.SS4.p4.1.m1.1.2.4.2.2" stretchy="false" xref="S2.SS4.p4.1.m1.1.2.4.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.1.m1.1b"><apply id="S2.SS4.p4.1.m1.1.2.cmml" xref="S2.SS4.p4.1.m1.1.2"><times id="S2.SS4.p4.1.m1.1.2.1.cmml" xref="S2.SS4.p4.1.m1.1.2.1"></times><ci id="S2.SS4.p4.1.m1.1.2.2.cmml" xref="S2.SS4.p4.1.m1.1.2.2">𝑠</ci><ci id="S2.SS4.p4.1.m1.1.2.3.cmml" xref="S2.SS4.p4.1.m1.1.2.3">𝑔</ci><apply id="S2.SS4.p4.1.m1.1.2.4.1.cmml" xref="S2.SS4.p4.1.m1.1.2.4.2"><csymbol cd="latexml" id="S2.SS4.p4.1.m1.1.2.4.1.1.cmml" xref="S2.SS4.p4.1.m1.1.2.4.2.1">delimited-[]</csymbol><ci id="S2.SS4.p4.1.m1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.1.m1.1c">sg[\cdot]</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.1.m1.1d">italic_s italic_g [ ⋅ ]</annotation></semantics></math> denotes the stop-gradient operator and <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS4.p4.2.m2.1"><semantics id="S2.SS4.p4.2.m2.1a"><mi id="S2.SS4.p4.2.m2.1.1" xref="S2.SS4.p4.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.2.m2.1b"><ci id="S2.SS4.p4.2.m2.1.1.cmml" xref="S2.SS4.p4.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.2.m2.1d">italic_β</annotation></semantics></math> is loss weight parameters. The first part minimizes
the distance between the cluster centroid vectors <math alttext="v_{k}^{m}" class="ltx_Math" display="inline" id="S2.SS4.p4.3.m3.1"><semantics id="S2.SS4.p4.3.m3.1a"><msubsup id="S2.SS4.p4.3.m3.1.1" xref="S2.SS4.p4.3.m3.1.1.cmml"><mi id="S2.SS4.p4.3.m3.1.1.2.2" xref="S2.SS4.p4.3.m3.1.1.2.2.cmml">v</mi><mi id="S2.SS4.p4.3.m3.1.1.2.3" xref="S2.SS4.p4.3.m3.1.1.2.3.cmml">k</mi><mi id="S2.SS4.p4.3.m3.1.1.3" xref="S2.SS4.p4.3.m3.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.3.m3.1b"><apply id="S2.SS4.p4.3.m3.1.1.cmml" xref="S2.SS4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.3.m3.1.1.1.cmml" xref="S2.SS4.p4.3.m3.1.1">superscript</csymbol><apply id="S2.SS4.p4.3.m3.1.1.2.cmml" xref="S2.SS4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.3.m3.1.1.2.1.cmml" xref="S2.SS4.p4.3.m3.1.1">subscript</csymbol><ci id="S2.SS4.p4.3.m3.1.1.2.2.cmml" xref="S2.SS4.p4.3.m3.1.1.2.2">𝑣</ci><ci id="S2.SS4.p4.3.m3.1.1.2.3.cmml" xref="S2.SS4.p4.3.m3.1.1.2.3">𝑘</ci></apply><ci id="S2.SS4.p4.3.m3.1.1.3.cmml" xref="S2.SS4.p4.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.3.m3.1c">v_{k}^{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and the latent profiles variables <math alttext="\theta^{m}" class="ltx_Math" display="inline" id="S2.SS4.p4.4.m4.1"><semantics id="S2.SS4.p4.4.m4.1a"><msup id="S2.SS4.p4.4.m4.1.1" xref="S2.SS4.p4.4.m4.1.1.cmml"><mi id="S2.SS4.p4.4.m4.1.1.2" xref="S2.SS4.p4.4.m4.1.1.2.cmml">θ</mi><mi id="S2.SS4.p4.4.m4.1.1.3" xref="S2.SS4.p4.4.m4.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.4.m4.1b"><apply id="S2.SS4.p4.4.m4.1.1.cmml" xref="S2.SS4.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.4.m4.1.1.1.cmml" xref="S2.SS4.p4.4.m4.1.1">superscript</csymbol><ci id="S2.SS4.p4.4.m4.1.1.2.cmml" xref="S2.SS4.p4.4.m4.1.1.2">𝜃</ci><ci id="S2.SS4.p4.4.m4.1.1.3.cmml" xref="S2.SS4.p4.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.4.m4.1c">\theta^{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.4.m4.1d">italic_θ start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>. And the second part constrains the profile embedding’s updating speed.
The second term trains the latent profile embeddings with a surrogate recommendation model loss. <math alttext="v_{c_{m}}^{m}" class="ltx_Math" display="inline" id="S2.SS4.p4.5.m5.1"><semantics id="S2.SS4.p4.5.m5.1a"><msubsup id="S2.SS4.p4.5.m5.1.1" xref="S2.SS4.p4.5.m5.1.1.cmml"><mi id="S2.SS4.p4.5.m5.1.1.2.2" xref="S2.SS4.p4.5.m5.1.1.2.2.cmml">v</mi><msub id="S2.SS4.p4.5.m5.1.1.2.3" xref="S2.SS4.p4.5.m5.1.1.2.3.cmml"><mi id="S2.SS4.p4.5.m5.1.1.2.3.2" xref="S2.SS4.p4.5.m5.1.1.2.3.2.cmml">c</mi><mi id="S2.SS4.p4.5.m5.1.1.2.3.3" xref="S2.SS4.p4.5.m5.1.1.2.3.3.cmml">m</mi></msub><mi id="S2.SS4.p4.5.m5.1.1.3" xref="S2.SS4.p4.5.m5.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.5.m5.1b"><apply id="S2.SS4.p4.5.m5.1.1.cmml" xref="S2.SS4.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.5.m5.1.1.1.cmml" xref="S2.SS4.p4.5.m5.1.1">superscript</csymbol><apply id="S2.SS4.p4.5.m5.1.1.2.cmml" xref="S2.SS4.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.5.m5.1.1.2.1.cmml" xref="S2.SS4.p4.5.m5.1.1">subscript</csymbol><ci id="S2.SS4.p4.5.m5.1.1.2.2.cmml" xref="S2.SS4.p4.5.m5.1.1.2.2">𝑣</ci><apply id="S2.SS4.p4.5.m5.1.1.2.3.cmml" xref="S2.SS4.p4.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS4.p4.5.m5.1.1.2.3.1.cmml" xref="S2.SS4.p4.5.m5.1.1.2.3">subscript</csymbol><ci id="S2.SS4.p4.5.m5.1.1.2.3.2.cmml" xref="S2.SS4.p4.5.m5.1.1.2.3.2">𝑐</ci><ci id="S2.SS4.p4.5.m5.1.1.2.3.3.cmml" xref="S2.SS4.p4.5.m5.1.1.2.3.3">𝑚</ci></apply></apply><ci id="S2.SS4.p4.5.m5.1.1.3.cmml" xref="S2.SS4.p4.5.m5.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.5.m5.1c">v_{c_{m}}^{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.5.m5.1d">italic_v start_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the selected codebook embedding (formula <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.E6" title="In 2.4. UserIP Quantization Module ‣ 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">6</span></a>), <math alttext="i" class="ltx_Math" display="inline" id="S2.SS4.p4.6.m6.1"><semantics id="S2.SS4.p4.6.m6.1a"><mi id="S2.SS4.p4.6.m6.1.1" xref="S2.SS4.p4.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.6.m6.1b"><ci id="S2.SS4.p4.6.m6.1.1.cmml" xref="S2.SS4.p4.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.6.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.6.m6.1d">italic_i</annotation></semantics></math> stands for item embedding and <math alttext="E_{obs}" class="ltx_Math" display="inline" id="S2.SS4.p4.7.m7.1"><semantics id="S2.SS4.p4.7.m7.1a"><msub id="S2.SS4.p4.7.m7.1.1" xref="S2.SS4.p4.7.m7.1.1.cmml"><mi id="S2.SS4.p4.7.m7.1.1.2" xref="S2.SS4.p4.7.m7.1.1.2.cmml">E</mi><mrow id="S2.SS4.p4.7.m7.1.1.3" xref="S2.SS4.p4.7.m7.1.1.3.cmml"><mi id="S2.SS4.p4.7.m7.1.1.3.2" xref="S2.SS4.p4.7.m7.1.1.3.2.cmml">o</mi><mo id="S2.SS4.p4.7.m7.1.1.3.1" xref="S2.SS4.p4.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S2.SS4.p4.7.m7.1.1.3.3" xref="S2.SS4.p4.7.m7.1.1.3.3.cmml">b</mi><mo id="S2.SS4.p4.7.m7.1.1.3.1a" xref="S2.SS4.p4.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S2.SS4.p4.7.m7.1.1.3.4" xref="S2.SS4.p4.7.m7.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.7.m7.1b"><apply id="S2.SS4.p4.7.m7.1.1.cmml" xref="S2.SS4.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.7.m7.1.1.1.cmml" xref="S2.SS4.p4.7.m7.1.1">subscript</csymbol><ci id="S2.SS4.p4.7.m7.1.1.2.cmml" xref="S2.SS4.p4.7.m7.1.1.2">𝐸</ci><apply id="S2.SS4.p4.7.m7.1.1.3.cmml" xref="S2.SS4.p4.7.m7.1.1.3"><times id="S2.SS4.p4.7.m7.1.1.3.1.cmml" xref="S2.SS4.p4.7.m7.1.1.3.1"></times><ci id="S2.SS4.p4.7.m7.1.1.3.2.cmml" xref="S2.SS4.p4.7.m7.1.1.3.2">𝑜</ci><ci id="S2.SS4.p4.7.m7.1.1.3.3.cmml" xref="S2.SS4.p4.7.m7.1.1.3.3">𝑏</ci><ci id="S2.SS4.p4.7.m7.1.1.3.4.cmml" xref="S2.SS4.p4.7.m7.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.7.m7.1c">E_{obs}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.7.m7.1d">italic_E start_POSTSUBSCRIPT italic_o italic_b italic_s end_POSTSUBSCRIPT</annotation></semantics></math> stands for other user profiles. It directly uses codebook embeddings as the input of recommendation tasks and uses the recommendation loss update latent profile embedding (together with <math alttext="l^{llm}" class="ltx_Math" display="inline" id="S2.SS4.p4.8.m8.1"><semantics id="S2.SS4.p4.8.m8.1a"><msup id="S2.SS4.p4.8.m8.1.1" xref="S2.SS4.p4.8.m8.1.1.cmml"><mi id="S2.SS4.p4.8.m8.1.1.2" xref="S2.SS4.p4.8.m8.1.1.2.cmml">l</mi><mrow id="S2.SS4.p4.8.m8.1.1.3" xref="S2.SS4.p4.8.m8.1.1.3.cmml"><mi id="S2.SS4.p4.8.m8.1.1.3.2" xref="S2.SS4.p4.8.m8.1.1.3.2.cmml">l</mi><mo id="S2.SS4.p4.8.m8.1.1.3.1" xref="S2.SS4.p4.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S2.SS4.p4.8.m8.1.1.3.3" xref="S2.SS4.p4.8.m8.1.1.3.3.cmml">l</mi><mo id="S2.SS4.p4.8.m8.1.1.3.1a" xref="S2.SS4.p4.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S2.SS4.p4.8.m8.1.1.3.4" xref="S2.SS4.p4.8.m8.1.1.3.4.cmml">m</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.8.m8.1b"><apply id="S2.SS4.p4.8.m8.1.1.cmml" xref="S2.SS4.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.8.m8.1.1.1.cmml" xref="S2.SS4.p4.8.m8.1.1">superscript</csymbol><ci id="S2.SS4.p4.8.m8.1.1.2.cmml" xref="S2.SS4.p4.8.m8.1.1.2">𝑙</ci><apply id="S2.SS4.p4.8.m8.1.1.3.cmml" xref="S2.SS4.p4.8.m8.1.1.3"><times id="S2.SS4.p4.8.m8.1.1.3.1.cmml" xref="S2.SS4.p4.8.m8.1.1.3.1"></times><ci id="S2.SS4.p4.8.m8.1.1.3.2.cmml" xref="S2.SS4.p4.8.m8.1.1.3.2">𝑙</ci><ci id="S2.SS4.p4.8.m8.1.1.3.3.cmml" xref="S2.SS4.p4.8.m8.1.1.3.3">𝑙</ci><ci id="S2.SS4.p4.8.m8.1.1.3.4.cmml" xref="S2.SS4.p4.8.m8.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.8.m8.1c">l^{llm}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.8.m8.1d">italic_l start_POSTSUPERSCRIPT italic_l italic_l italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>) by straight-through gradient estimation.</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E5">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E5X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\ell^{vec}_{u}=" class="ltx_Math" display="inline" id="S2.E5X.2.1.1.m1.1"><semantics id="S2.E5X.2.1.1.m1.1a"><mrow id="S2.E5X.2.1.1.m1.1.1" xref="S2.E5X.2.1.1.m1.1.1.cmml"><msubsup id="S2.E5X.2.1.1.m1.1.1.2" xref="S2.E5X.2.1.1.m1.1.1.2.cmml"><mi id="S2.E5X.2.1.1.m1.1.1.2.2.2" mathsize="90%" mathvariant="normal" xref="S2.E5X.2.1.1.m1.1.1.2.2.2.cmml">ℓ</mi><mi id="S2.E5X.2.1.1.m1.1.1.2.3" mathsize="90%" xref="S2.E5X.2.1.1.m1.1.1.2.3.cmml">u</mi><mrow id="S2.E5X.2.1.1.m1.1.1.2.2.3" xref="S2.E5X.2.1.1.m1.1.1.2.2.3.cmml"><mi id="S2.E5X.2.1.1.m1.1.1.2.2.3.2" mathsize="90%" xref="S2.E5X.2.1.1.m1.1.1.2.2.3.2.cmml">v</mi><mo id="S2.E5X.2.1.1.m1.1.1.2.2.3.1" xref="S2.E5X.2.1.1.m1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.E5X.2.1.1.m1.1.1.2.2.3.3" mathsize="90%" xref="S2.E5X.2.1.1.m1.1.1.2.2.3.3.cmml">e</mi><mo id="S2.E5X.2.1.1.m1.1.1.2.2.3.1a" xref="S2.E5X.2.1.1.m1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.E5X.2.1.1.m1.1.1.2.2.3.4" mathsize="90%" xref="S2.E5X.2.1.1.m1.1.1.2.2.3.4.cmml">c</mi></mrow></msubsup><mo id="S2.E5X.2.1.1.m1.1.1.1" mathsize="90%" xref="S2.E5X.2.1.1.m1.1.1.1.cmml">=</mo><mi id="S2.E5X.2.1.1.m1.1.1.3" xref="S2.E5X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S2.E5X.2.1.1.m1.1b"><apply id="S2.E5X.2.1.1.m1.1.1.cmml" xref="S2.E5X.2.1.1.m1.1.1"><eq id="S2.E5X.2.1.1.m1.1.1.1.cmml" xref="S2.E5X.2.1.1.m1.1.1.1"></eq><apply id="S2.E5X.2.1.1.m1.1.1.2.cmml" xref="S2.E5X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E5X.2.1.1.m1.1.1.2.1.cmml" xref="S2.E5X.2.1.1.m1.1.1.2">subscript</csymbol><apply id="S2.E5X.2.1.1.m1.1.1.2.2.cmml" xref="S2.E5X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E5X.2.1.1.m1.1.1.2.2.1.cmml" xref="S2.E5X.2.1.1.m1.1.1.2">superscript</csymbol><ci id="S2.E5X.2.1.1.m1.1.1.2.2.2.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.2.2">ℓ</ci><apply id="S2.E5X.2.1.1.m1.1.1.2.2.3.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.2.3"><times id="S2.E5X.2.1.1.m1.1.1.2.2.3.1.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.2.3.1"></times><ci id="S2.E5X.2.1.1.m1.1.1.2.2.3.2.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.2.3.2">𝑣</ci><ci id="S2.E5X.2.1.1.m1.1.1.2.2.3.3.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.2.3.3">𝑒</ci><ci id="S2.E5X.2.1.1.m1.1.1.2.2.3.4.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.2.3.4">𝑐</ci></apply></apply><ci id="S2.E5X.2.1.1.m1.1.1.2.3.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.3">𝑢</ci></apply><csymbol cd="latexml" id="S2.E5X.2.1.1.m1.1.1.3.cmml" xref="S2.E5X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5X.2.1.1.m1.1c">\displaystyle\ell^{vec}_{u}=</annotation><annotation encoding="application/x-llamapun" id="S2.E5X.2.1.1.m1.1d">roman_ℓ start_POSTSUPERSCRIPT italic_v italic_e italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum_{m=1}^{M}[\left\|sg[\theta^{m}]-v_{k}^{m}\right\|^{2}_{2}+%
\beta\left\|\theta^{m}-sg[v_{k}^{m}]\right\|^{2}_{2}]" class="ltx_Math" display="inline" id="S2.E5X.3.2.2.m1.1"><semantics id="S2.E5X.3.2.2.m1.1a"><mrow id="S2.E5X.3.2.2.m1.1.1" xref="S2.E5X.3.2.2.m1.1.1.cmml"><mstyle displaystyle="true" id="S2.E5X.3.2.2.m1.1.1.2" xref="S2.E5X.3.2.2.m1.1.1.2.cmml"><munderover id="S2.E5X.3.2.2.m1.1.1.2a" xref="S2.E5X.3.2.2.m1.1.1.2.cmml"><mo id="S2.E5X.3.2.2.m1.1.1.2.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S2.E5X.3.2.2.m1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E5X.3.2.2.m1.1.1.2.2.3" xref="S2.E5X.3.2.2.m1.1.1.2.2.3.cmml"><mi id="S2.E5X.3.2.2.m1.1.1.2.2.3.2" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.2.2.3.2.cmml">m</mi><mo id="S2.E5X.3.2.2.m1.1.1.2.2.3.1" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E5X.3.2.2.m1.1.1.2.2.3.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E5X.3.2.2.m1.1.1.2.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.2.3.cmml">M</mi></munderover></mstyle><mrow id="S2.E5X.3.2.2.m1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.2.cmml"><mo id="S2.E5X.3.2.2.m1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E5X.3.2.2.m1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.cmml"><msubsup id="S2.E5X.3.2.2.m1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.4" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">g</mi><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2a" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><msup id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></msup><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><msubsup id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">v</mi><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">m</mi></msubsup></mrow><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.cmml">2</mn><mn id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.3.cmml">+</mo><mrow id="S2.E5X.3.2.2.m1.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.cmml"><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.3.cmml">β</mi><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.2" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.2.cmml">⁢</mo><msubsup id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.cmml"><mrow id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2.cmml"><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.cmml"><msup id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3.cmml"><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3.2" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3.2.cmml">θ</mi><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3.3.cmml">m</mi></msup><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.2" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.2.cmml">−</mo><mrow id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml">s</mi><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.4" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml">g</mi><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.2a" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.1.cmml">[</mo><msubsup id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mi id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></msubsup><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.3" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.3.cmml">2</mn><mn id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.3" mathsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S2.E5X.3.2.2.m1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.E5X.3.2.2.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5X.3.2.2.m1.1b"><apply id="S2.E5X.3.2.2.m1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1"><apply id="S2.E5X.3.2.2.m1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.2.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.2">superscript</csymbol><apply id="S2.E5X.3.2.2.m1.1.1.2.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.2.2.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.2">subscript</csymbol><sum id="S2.E5X.3.2.2.m1.1.1.2.2.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.2.2.2"></sum><apply id="S2.E5X.3.2.2.m1.1.1.2.2.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.2.2.3"><eq id="S2.E5X.3.2.2.m1.1.1.2.2.3.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.2.2.3.1"></eq><ci id="S2.E5X.3.2.2.m1.1.1.2.2.3.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.2.2.3.2">𝑚</ci><cn id="S2.E5X.3.2.2.m1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E5X.3.2.2.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E5X.3.2.2.m1.1.1.2.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.2.3">𝑀</ci></apply><apply id="S2.E5X.3.2.2.m1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E5X.3.2.2.m1.1.1.1.2.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1"><plus id="S2.E5X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.3"></plus><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"><minus id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.4">𝑔</ci><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑣</ci><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply><cn id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.1.3">2</cn></apply><cn id="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.1.3">2</cn></apply><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2"><times id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.2"></times><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.3">𝛽</ci><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1">subscript</csymbol><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1">superscript</csymbol><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="latexml" id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.2">norm</csymbol><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1"><minus id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.2"></minus><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3.2">𝜃</ci><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.3.3">𝑚</ci></apply><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1"><times id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.2"></times><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.3">𝑠</ci><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.4">𝑔</ci><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply></apply><cn id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.3.cmml" type="integer" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.1.3">2</cn></apply><cn id="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.3.cmml" type="integer" xref="S2.E5X.3.2.2.m1.1.1.1.1.1.2.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5X.3.2.2.m1.1c">\displaystyle\sum_{m=1}^{M}[\left\|sg[\theta^{m}]-v_{k}^{m}\right\|^{2}_{2}+%
\beta\left\|\theta^{m}-sg[v_{k}^{m}]\right\|^{2}_{2}]</annotation><annotation encoding="application/x-llamapun" id="S2.E5X.3.2.2.m1.1d">∑ start_POSTSUBSCRIPT italic_m = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT [ ∥ italic_s italic_g [ italic_θ start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ] - italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_β ∥ italic_θ start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT - italic_s italic_g [ italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ] ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E5Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+BCE(\hat{y}^{rec},Rec^{s}(v_{c_{1}}^{1},...v_{c_{m}}^{m},E_{obs}%
,i_{u}))" class="ltx_Math" display="inline" id="S2.E5Xa.2.1.1.m1.2"><semantics id="S2.E5Xa.2.1.1.m1.2a"><mrow id="S2.E5Xa.2.1.1.m1.2.2" xref="S2.E5Xa.2.1.1.m1.2.2.cmml"><mo id="S2.E5Xa.2.1.1.m1.2.2a" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.cmml">+</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.2" xref="S2.E5Xa.2.1.1.m1.2.2.2.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.2.4" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.4.cmml">B</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.2.3" xref="S2.E5Xa.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mi id="S2.E5Xa.2.1.1.m1.2.2.2.5" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.5.cmml">C</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.2.3a" xref="S2.E5Xa.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mi id="S2.E5Xa.2.1.1.m1.2.2.2.6" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.6.cmml">E</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.2.3b" xref="S2.E5Xa.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.2.2.2" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.3.cmml"><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.3" maxsize="90%" minsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.3.cmml">(</mo><msup id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.1" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.2" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.2.cmml">r</mi><mo id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.1" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.3.cmml">e</mi><mo id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.1a" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.4" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.4.cmml">c</mi></mrow></msup><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.4" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.3.cmml">,</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.6" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.6.cmml">R</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.5" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.5.cmml">⁢</mo><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.7" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.7.cmml">e</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.5a" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.5.cmml">⁢</mo><msup id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8.2" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8.2.cmml">c</mi><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8.3" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8.3.cmml">s</mi></msup><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.5b" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.5.cmml">⁢</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.5.cmml"><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.5" maxsize="90%" minsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.5.cmml">(</mo><msubsup id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.2" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.2.cmml">v</mi><msub id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3.2" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3.2.cmml">c</mi><mn id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3.3" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3.3.cmml">1</mn></msub><mn id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.3" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.6" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.5.cmml">,</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.2" mathsize="90%" mathvariant="normal" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.2.cmml">…</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.1" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.1.cmml">⁢</mo><msubsup id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.2" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.2.cmml">v</mi><msub id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3.2" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3.2.cmml">c</mi><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3.3" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3.3.cmml">m</mi></msub><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.3" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.3.cmml">m</mi></msubsup></mrow><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.7" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.5.cmml">,</mo><msub id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.2" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.2.cmml">E</mi><mrow id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.2" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.2.cmml">o</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.1" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.3" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.3.cmml">b</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.1a" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.4" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.4.cmml">s</mi></mrow></msub><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.8" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.5.cmml">,</mo><msub id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4.2" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4.2.cmml">i</mi><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4.3" mathsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4.3.cmml">u</mi></msub><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.9" maxsize="90%" minsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.5.cmml">)</mo></mrow></mrow><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.5" maxsize="90%" minsize="90%" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5Xa.2.1.1.m1.2b"><apply id="S2.E5Xa.2.1.1.m1.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2"><plus id="S2.E5Xa.2.1.1.m1.2.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2"></plus><apply id="S2.E5Xa.2.1.1.m1.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2"><times id="S2.E5Xa.2.1.1.m1.2.2.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.3"></times><ci id="S2.E5Xa.2.1.1.m1.2.2.2.4.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.4">𝐵</ci><ci id="S2.E5Xa.2.1.1.m1.2.2.2.5.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.5">𝐶</ci><ci id="S2.E5Xa.2.1.1.m1.2.2.2.6.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.6">𝐸</ci><interval closure="open" id="S2.E5Xa.2.1.1.m1.2.2.2.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2"><apply id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2"><ci id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3"><times id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.1"></times><ci id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.4.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.4">𝑐</ci></apply></apply><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2"><times id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.5.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.5"></times><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.6.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.6">𝑅</ci><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.7.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.7">𝑒</ci><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8">superscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8.2">𝑐</ci><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.8.3">𝑠</ci></apply><vector id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.5.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4"><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1">superscript</csymbol><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.2">𝑣</ci><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3">subscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3.2">𝑐</ci><cn id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.3.3">1</cn></apply></apply><cn id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.cmml" type="integer" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.1.1.1.3">1</cn></apply><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2"><times id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.1"></times><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.2">…</ci><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3">superscript</csymbol><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.2">𝑣</ci><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3">subscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3.2">𝑐</ci><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.2.3.3">𝑚</ci></apply></apply><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.2.2.2.3.3">𝑚</ci></apply></apply><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3">subscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.2">𝐸</ci><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3"><times id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.1"></times><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.2">𝑜</ci><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.3">𝑏</ci><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.4.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.3.3.3.3.4">𝑠</ci></apply></apply><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4">subscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4.2">𝑖</ci><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.2.2.4.4.4.3">𝑢</ci></apply></vector></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xa.2.1.1.m1.2c">\displaystyle+BCE(\hat{y}^{rec},Rec^{s}(v_{c_{1}}^{1},...v_{c_{m}}^{m},E_{obs}%
,i_{u}))</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xa.2.1.1.m1.2d">+ italic_B italic_C italic_E ( over^ start_ARG italic_y end_ARG start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT , italic_R italic_e italic_c start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ( italic_v start_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … italic_v start_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT , italic_E start_POSTSUBSCRIPT italic_o italic_b italic_s end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS4.p4.10">After training, a user’s latent profile ID is inferred by finding the index of the codebook embedding closest to the latent profile inferred from the previous section.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small c_{m}=arg\min_{k}\left\|\theta^{m}-v_{k}^{m}\right\|^{2}_{2}" class="ltx_Math" display="block" id="S2.E6.m1.1"><semantics id="S2.E6.m1.1a"><mrow id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml"><msub id="S2.E6.m1.1.1.3" xref="S2.E6.m1.1.1.3.cmml"><mi id="S2.E6.m1.1.1.3.2" mathsize="90%" xref="S2.E6.m1.1.1.3.2.cmml">c</mi><mi id="S2.E6.m1.1.1.3.3" mathsize="90%" xref="S2.E6.m1.1.1.3.3.cmml">m</mi></msub><mo id="S2.E6.m1.1.1.2" mathsize="90%" xref="S2.E6.m1.1.1.2.cmml">=</mo><mrow id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.cmml"><mi id="S2.E6.m1.1.1.1.3" mathsize="90%" xref="S2.E6.m1.1.1.1.3.cmml">a</mi><mo id="S2.E6.m1.1.1.1.2" xref="S2.E6.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E6.m1.1.1.1.4" mathsize="90%" xref="S2.E6.m1.1.1.1.4.cmml">r</mi><mo id="S2.E6.m1.1.1.1.2a" xref="S2.E6.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E6.m1.1.1.1.5" mathsize="90%" xref="S2.E6.m1.1.1.1.5.cmml">g</mi><mo id="S2.E6.m1.1.1.1.2b" lspace="0.167em" xref="S2.E6.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E6.m1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><munder id="S2.E6.m1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.2.cmml"><mi id="S2.E6.m1.1.1.1.1.2.2" mathsize="90%" xref="S2.E6.m1.1.1.1.1.2.2.cmml">min</mi><mi id="S2.E6.m1.1.1.1.1.2.3" mathsize="90%" xref="S2.E6.m1.1.1.1.1.2.3.cmml">k</mi></munder><mo id="S2.E6.m1.1.1.1.1a" xref="S2.E6.m1.1.1.1.1.cmml">⁡</mo><msubsup id="S2.E6.m1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.cmml"><mrow id="S2.E6.m1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E6.m1.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E6.m1.1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S2.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">m</mi></msup><mo id="S2.E6.m1.1.1.1.1.1.1.1.1.1.1" mathsize="90%" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2" mathsize="90%" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">v</mi><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3" mathsize="90%" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">m</mi></msubsup></mrow><mo id="S2.E6.m1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E6.m1.1.1.1.1.1.3" mathsize="90%" xref="S2.E6.m1.1.1.1.1.1.3.cmml">2</mn><mn id="S2.E6.m1.1.1.1.1.1.1.3" mathsize="90%" xref="S2.E6.m1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1"><eq id="S2.E6.m1.1.1.2.cmml" xref="S2.E6.m1.1.1.2"></eq><apply id="S2.E6.m1.1.1.3.cmml" xref="S2.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.3.1.cmml" xref="S2.E6.m1.1.1.3">subscript</csymbol><ci id="S2.E6.m1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.3.2">𝑐</ci><ci id="S2.E6.m1.1.1.3.3.cmml" xref="S2.E6.m1.1.1.3.3">𝑚</ci></apply><apply id="S2.E6.m1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"><times id="S2.E6.m1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.2"></times><ci id="S2.E6.m1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.3">𝑎</ci><ci id="S2.E6.m1.1.1.1.4.cmml" xref="S2.E6.m1.1.1.1.4">𝑟</ci><ci id="S2.E6.m1.1.1.1.5.cmml" xref="S2.E6.m1.1.1.1.5">𝑔</ci><apply id="S2.E6.m1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1"><apply id="S2.E6.m1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.1.1.1.1.2">subscript</csymbol><min id="S2.E6.m1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.1.1.1.1.2.2"></min><ci id="S2.E6.m1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S2.E6.m1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1">subscript</csymbol><apply id="S2.E6.m1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1">superscript</csymbol><apply id="S2.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1"><minus id="S2.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.3">𝑚</ci></apply><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝑣</ci><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply><cn id="S2.E6.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E6.m1.1.1.1.1.1.1.3">2</cn></apply><cn id="S2.E6.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E6.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\small c_{m}=arg\min_{k}\left\|\theta^{m}-v_{k}^{m}\right\|^{2}_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.1d">italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = italic_a italic_r italic_g roman_min start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ italic_θ start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT - italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p4.9">The total loss for latent profile training is defined as follows, where <math alttext="\alpha" class="ltx_Math" display="inline" id="S2.SS4.p4.9.m1.1"><semantics id="S2.SS4.p4.9.m1.1a"><mi id="S2.SS4.p4.9.m1.1.1" xref="S2.SS4.p4.9.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.9.m1.1b"><ci id="S2.SS4.p4.9.m1.1.1.cmml" xref="S2.SS4.p4.9.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.9.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.9.m1.1d">italic_α</annotation></semantics></math> is the loss weights.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathcal{L}=\ell^{llm}+\alpha*\ell^{vec}" class="ltx_Math" display="block" id="S2.E7.m1.1"><semantics id="S2.E7.m1.1a"><mrow id="S2.E7.m1.1.1" xref="S2.E7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.1.1.2" mathsize="90%" xref="S2.E7.m1.1.1.2.cmml">ℒ</mi><mo id="S2.E7.m1.1.1.1" mathsize="90%" xref="S2.E7.m1.1.1.1.cmml">=</mo><mrow id="S2.E7.m1.1.1.3" xref="S2.E7.m1.1.1.3.cmml"><msup id="S2.E7.m1.1.1.3.2" xref="S2.E7.m1.1.1.3.2.cmml"><mi id="S2.E7.m1.1.1.3.2.2" mathsize="90%" mathvariant="normal" xref="S2.E7.m1.1.1.3.2.2.cmml">ℓ</mi><mrow id="S2.E7.m1.1.1.3.2.3" xref="S2.E7.m1.1.1.3.2.3.cmml"><mi id="S2.E7.m1.1.1.3.2.3.2" mathsize="90%" xref="S2.E7.m1.1.1.3.2.3.2.cmml">l</mi><mo id="S2.E7.m1.1.1.3.2.3.1" xref="S2.E7.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E7.m1.1.1.3.2.3.3" mathsize="90%" xref="S2.E7.m1.1.1.3.2.3.3.cmml">l</mi><mo id="S2.E7.m1.1.1.3.2.3.1a" xref="S2.E7.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E7.m1.1.1.3.2.3.4" mathsize="90%" xref="S2.E7.m1.1.1.3.2.3.4.cmml">m</mi></mrow></msup><mo id="S2.E7.m1.1.1.3.1" mathsize="90%" xref="S2.E7.m1.1.1.3.1.cmml">+</mo><mrow id="S2.E7.m1.1.1.3.3" xref="S2.E7.m1.1.1.3.3.cmml"><mi id="S2.E7.m1.1.1.3.3.2" mathsize="90%" xref="S2.E7.m1.1.1.3.3.2.cmml">α</mi><mo id="S2.E7.m1.1.1.3.3.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S2.E7.m1.1.1.3.3.1.cmml">∗</mo><msup id="S2.E7.m1.1.1.3.3.3" xref="S2.E7.m1.1.1.3.3.3.cmml"><mi id="S2.E7.m1.1.1.3.3.3.2" mathsize="90%" mathvariant="normal" xref="S2.E7.m1.1.1.3.3.3.2.cmml">ℓ</mi><mrow id="S2.E7.m1.1.1.3.3.3.3" xref="S2.E7.m1.1.1.3.3.3.3.cmml"><mi id="S2.E7.m1.1.1.3.3.3.3.2" mathsize="90%" xref="S2.E7.m1.1.1.3.3.3.3.2.cmml">v</mi><mo id="S2.E7.m1.1.1.3.3.3.3.1" xref="S2.E7.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E7.m1.1.1.3.3.3.3.3" mathsize="90%" xref="S2.E7.m1.1.1.3.3.3.3.3.cmml">e</mi><mo id="S2.E7.m1.1.1.3.3.3.3.1a" xref="S2.E7.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E7.m1.1.1.3.3.3.3.4" mathsize="90%" xref="S2.E7.m1.1.1.3.3.3.3.4.cmml">c</mi></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.1b"><apply id="S2.E7.m1.1.1.cmml" xref="S2.E7.m1.1.1"><eq id="S2.E7.m1.1.1.1.cmml" xref="S2.E7.m1.1.1.1"></eq><ci id="S2.E7.m1.1.1.2.cmml" xref="S2.E7.m1.1.1.2">ℒ</ci><apply id="S2.E7.m1.1.1.3.cmml" xref="S2.E7.m1.1.1.3"><plus id="S2.E7.m1.1.1.3.1.cmml" xref="S2.E7.m1.1.1.3.1"></plus><apply id="S2.E7.m1.1.1.3.2.cmml" xref="S2.E7.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.3.2.1.cmml" xref="S2.E7.m1.1.1.3.2">superscript</csymbol><ci id="S2.E7.m1.1.1.3.2.2.cmml" xref="S2.E7.m1.1.1.3.2.2">ℓ</ci><apply id="S2.E7.m1.1.1.3.2.3.cmml" xref="S2.E7.m1.1.1.3.2.3"><times id="S2.E7.m1.1.1.3.2.3.1.cmml" xref="S2.E7.m1.1.1.3.2.3.1"></times><ci id="S2.E7.m1.1.1.3.2.3.2.cmml" xref="S2.E7.m1.1.1.3.2.3.2">𝑙</ci><ci id="S2.E7.m1.1.1.3.2.3.3.cmml" xref="S2.E7.m1.1.1.3.2.3.3">𝑙</ci><ci id="S2.E7.m1.1.1.3.2.3.4.cmml" xref="S2.E7.m1.1.1.3.2.3.4">𝑚</ci></apply></apply><apply id="S2.E7.m1.1.1.3.3.cmml" xref="S2.E7.m1.1.1.3.3"><times id="S2.E7.m1.1.1.3.3.1.cmml" xref="S2.E7.m1.1.1.3.3.1"></times><ci id="S2.E7.m1.1.1.3.3.2.cmml" xref="S2.E7.m1.1.1.3.3.2">𝛼</ci><apply id="S2.E7.m1.1.1.3.3.3.cmml" xref="S2.E7.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.3.3.3.1.cmml" xref="S2.E7.m1.1.1.3.3.3">superscript</csymbol><ci id="S2.E7.m1.1.1.3.3.3.2.cmml" xref="S2.E7.m1.1.1.3.3.3.2">ℓ</ci><apply id="S2.E7.m1.1.1.3.3.3.3.cmml" xref="S2.E7.m1.1.1.3.3.3.3"><times id="S2.E7.m1.1.1.3.3.3.3.1.cmml" xref="S2.E7.m1.1.1.3.3.3.3.1"></times><ci id="S2.E7.m1.1.1.3.3.3.3.2.cmml" xref="S2.E7.m1.1.1.3.3.3.3.2">𝑣</ci><ci id="S2.E7.m1.1.1.3.3.3.3.3.cmml" xref="S2.E7.m1.1.1.3.3.3.3.3">𝑒</ci><ci id="S2.E7.m1.1.1.3.3.3.3.4.cmml" xref="S2.E7.m1.1.1.3.3.3.3.4">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.1c">\small\mathcal{L}=\ell^{llm}+\alpha*\ell^{vec}</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.1d">caligraphic_L = roman_ℓ start_POSTSUPERSCRIPT italic_l italic_l italic_m end_POSTSUPERSCRIPT + italic_α ∗ roman_ℓ start_POSTSUPERSCRIPT italic_v italic_e italic_c end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5. </span>UserIP Feature Bank and Downstream Recommender model</h3>
<div class="ltx_para" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.3">Training large text embeddings and soft tokens significantly increases the computational load and causes reasoning inefficiency for the online recommender.
To solve the reasoning inefficiency problem, after training UserIP-Tuning, a feature bank will be used to store the latent profile indices <math alttext="c_{1}" class="ltx_Math" display="inline" id="S2.SS5.p1.1.m1.1"><semantics id="S2.SS5.p1.1.m1.1a"><msub id="S2.SS5.p1.1.m1.1.1" xref="S2.SS5.p1.1.m1.1.1.cmml"><mi id="S2.SS5.p1.1.m1.1.1.2" xref="S2.SS5.p1.1.m1.1.1.2.cmml">c</mi><mn id="S2.SS5.p1.1.m1.1.1.3" xref="S2.SS5.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.1.m1.1b"><apply id="S2.SS5.p1.1.m1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.1.m1.1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS5.p1.1.m1.1.1.2.cmml" xref="S2.SS5.p1.1.m1.1.1.2">𝑐</ci><cn id="S2.SS5.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS5.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.1.m1.1c">c_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.1.m1.1d">italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, …, <math alttext="c_{M}" class="ltx_Math" display="inline" id="S2.SS5.p1.2.m2.1"><semantics id="S2.SS5.p1.2.m2.1a"><msub id="S2.SS5.p1.2.m2.1.1" xref="S2.SS5.p1.2.m2.1.1.cmml"><mi id="S2.SS5.p1.2.m2.1.1.2" xref="S2.SS5.p1.2.m2.1.1.2.cmml">c</mi><mi id="S2.SS5.p1.2.m2.1.1.3" xref="S2.SS5.p1.2.m2.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.2.m2.1b"><apply id="S2.SS5.p1.2.m2.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.2.m2.1.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS5.p1.2.m2.1.1.2.cmml" xref="S2.SS5.p1.2.m2.1.1.2">𝑐</ci><ci id="S2.SS5.p1.2.m2.1.1.3.cmml" xref="S2.SS5.p1.2.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.2.m2.1c">c_{M}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.2.m2.1d">italic_c start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> of each user. During the online inference stage, the downstream recommender model can directly search users’ latent profile indices in the pre-stored feature bank and add to users’ feature field without re-training UserIP-Tuning: <math alttext="Recommender[u,i,c_{1},c_{2},...,c_{M}]" class="ltx_Math" display="inline" id="S2.SS5.p1.3.m3.6"><semantics id="S2.SS5.p1.3.m3.6a"><mrow id="S2.SS5.p1.3.m3.6.6" xref="S2.SS5.p1.3.m3.6.6.cmml"><mi id="S2.SS5.p1.3.m3.6.6.5" xref="S2.SS5.p1.3.m3.6.6.5.cmml">R</mi><mo id="S2.SS5.p1.3.m3.6.6.4" xref="S2.SS5.p1.3.m3.6.6.4.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.6.6.6" xref="S2.SS5.p1.3.m3.6.6.6.cmml">e</mi><mo id="S2.SS5.p1.3.m3.6.6.4a" xref="S2.SS5.p1.3.m3.6.6.4.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.6.6.7" xref="S2.SS5.p1.3.m3.6.6.7.cmml">c</mi><mo id="S2.SS5.p1.3.m3.6.6.4b" xref="S2.SS5.p1.3.m3.6.6.4.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.6.6.8" xref="S2.SS5.p1.3.m3.6.6.8.cmml">o</mi><mo id="S2.SS5.p1.3.m3.6.6.4c" xref="S2.SS5.p1.3.m3.6.6.4.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.6.6.9" xref="S2.SS5.p1.3.m3.6.6.9.cmml">m</mi><mo id="S2.SS5.p1.3.m3.6.6.4d" xref="S2.SS5.p1.3.m3.6.6.4.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.6.6.10" xref="S2.SS5.p1.3.m3.6.6.10.cmml">m</mi><mo id="S2.SS5.p1.3.m3.6.6.4e" xref="S2.SS5.p1.3.m3.6.6.4.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.6.6.11" xref="S2.SS5.p1.3.m3.6.6.11.cmml">e</mi><mo id="S2.SS5.p1.3.m3.6.6.4f" xref="S2.SS5.p1.3.m3.6.6.4.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.6.6.12" xref="S2.SS5.p1.3.m3.6.6.12.cmml">n</mi><mo id="S2.SS5.p1.3.m3.6.6.4g" xref="S2.SS5.p1.3.m3.6.6.4.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.6.6.13" xref="S2.SS5.p1.3.m3.6.6.13.cmml">d</mi><mo id="S2.SS5.p1.3.m3.6.6.4h" xref="S2.SS5.p1.3.m3.6.6.4.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.6.6.14" xref="S2.SS5.p1.3.m3.6.6.14.cmml">e</mi><mo id="S2.SS5.p1.3.m3.6.6.4i" xref="S2.SS5.p1.3.m3.6.6.4.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.6.6.15" xref="S2.SS5.p1.3.m3.6.6.15.cmml">r</mi><mo id="S2.SS5.p1.3.m3.6.6.4j" xref="S2.SS5.p1.3.m3.6.6.4.cmml">⁢</mo><mrow id="S2.SS5.p1.3.m3.6.6.3.3" xref="S2.SS5.p1.3.m3.6.6.3.4.cmml"><mo id="S2.SS5.p1.3.m3.6.6.3.3.4" stretchy="false" xref="S2.SS5.p1.3.m3.6.6.3.4.cmml">[</mo><mi id="S2.SS5.p1.3.m3.1.1" xref="S2.SS5.p1.3.m3.1.1.cmml">u</mi><mo id="S2.SS5.p1.3.m3.6.6.3.3.5" xref="S2.SS5.p1.3.m3.6.6.3.4.cmml">,</mo><mi id="S2.SS5.p1.3.m3.2.2" xref="S2.SS5.p1.3.m3.2.2.cmml">i</mi><mo id="S2.SS5.p1.3.m3.6.6.3.3.6" xref="S2.SS5.p1.3.m3.6.6.3.4.cmml">,</mo><msub id="S2.SS5.p1.3.m3.4.4.1.1.1" xref="S2.SS5.p1.3.m3.4.4.1.1.1.cmml"><mi id="S2.SS5.p1.3.m3.4.4.1.1.1.2" xref="S2.SS5.p1.3.m3.4.4.1.1.1.2.cmml">c</mi><mn id="S2.SS5.p1.3.m3.4.4.1.1.1.3" xref="S2.SS5.p1.3.m3.4.4.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS5.p1.3.m3.6.6.3.3.7" xref="S2.SS5.p1.3.m3.6.6.3.4.cmml">,</mo><msub id="S2.SS5.p1.3.m3.5.5.2.2.2" xref="S2.SS5.p1.3.m3.5.5.2.2.2.cmml"><mi id="S2.SS5.p1.3.m3.5.5.2.2.2.2" xref="S2.SS5.p1.3.m3.5.5.2.2.2.2.cmml">c</mi><mn id="S2.SS5.p1.3.m3.5.5.2.2.2.3" xref="S2.SS5.p1.3.m3.5.5.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS5.p1.3.m3.6.6.3.3.8" xref="S2.SS5.p1.3.m3.6.6.3.4.cmml">,</mo><mi id="S2.SS5.p1.3.m3.3.3" mathvariant="normal" xref="S2.SS5.p1.3.m3.3.3.cmml">…</mi><mo id="S2.SS5.p1.3.m3.6.6.3.3.9" xref="S2.SS5.p1.3.m3.6.6.3.4.cmml">,</mo><msub id="S2.SS5.p1.3.m3.6.6.3.3.3" xref="S2.SS5.p1.3.m3.6.6.3.3.3.cmml"><mi id="S2.SS5.p1.3.m3.6.6.3.3.3.2" xref="S2.SS5.p1.3.m3.6.6.3.3.3.2.cmml">c</mi><mi id="S2.SS5.p1.3.m3.6.6.3.3.3.3" xref="S2.SS5.p1.3.m3.6.6.3.3.3.3.cmml">M</mi></msub><mo id="S2.SS5.p1.3.m3.6.6.3.3.10" stretchy="false" xref="S2.SS5.p1.3.m3.6.6.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.3.m3.6b"><apply id="S2.SS5.p1.3.m3.6.6.cmml" xref="S2.SS5.p1.3.m3.6.6"><times id="S2.SS5.p1.3.m3.6.6.4.cmml" xref="S2.SS5.p1.3.m3.6.6.4"></times><ci id="S2.SS5.p1.3.m3.6.6.5.cmml" xref="S2.SS5.p1.3.m3.6.6.5">𝑅</ci><ci id="S2.SS5.p1.3.m3.6.6.6.cmml" xref="S2.SS5.p1.3.m3.6.6.6">𝑒</ci><ci id="S2.SS5.p1.3.m3.6.6.7.cmml" xref="S2.SS5.p1.3.m3.6.6.7">𝑐</ci><ci id="S2.SS5.p1.3.m3.6.6.8.cmml" xref="S2.SS5.p1.3.m3.6.6.8">𝑜</ci><ci id="S2.SS5.p1.3.m3.6.6.9.cmml" xref="S2.SS5.p1.3.m3.6.6.9">𝑚</ci><ci id="S2.SS5.p1.3.m3.6.6.10.cmml" xref="S2.SS5.p1.3.m3.6.6.10">𝑚</ci><ci id="S2.SS5.p1.3.m3.6.6.11.cmml" xref="S2.SS5.p1.3.m3.6.6.11">𝑒</ci><ci id="S2.SS5.p1.3.m3.6.6.12.cmml" xref="S2.SS5.p1.3.m3.6.6.12">𝑛</ci><ci id="S2.SS5.p1.3.m3.6.6.13.cmml" xref="S2.SS5.p1.3.m3.6.6.13">𝑑</ci><ci id="S2.SS5.p1.3.m3.6.6.14.cmml" xref="S2.SS5.p1.3.m3.6.6.14">𝑒</ci><ci id="S2.SS5.p1.3.m3.6.6.15.cmml" xref="S2.SS5.p1.3.m3.6.6.15">𝑟</ci><list id="S2.SS5.p1.3.m3.6.6.3.4.cmml" xref="S2.SS5.p1.3.m3.6.6.3.3"><ci id="S2.SS5.p1.3.m3.1.1.cmml" xref="S2.SS5.p1.3.m3.1.1">𝑢</ci><ci id="S2.SS5.p1.3.m3.2.2.cmml" xref="S2.SS5.p1.3.m3.2.2">𝑖</ci><apply id="S2.SS5.p1.3.m3.4.4.1.1.1.cmml" xref="S2.SS5.p1.3.m3.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.4.4.1.1.1.1.cmml" xref="S2.SS5.p1.3.m3.4.4.1.1.1">subscript</csymbol><ci id="S2.SS5.p1.3.m3.4.4.1.1.1.2.cmml" xref="S2.SS5.p1.3.m3.4.4.1.1.1.2">𝑐</ci><cn id="S2.SS5.p1.3.m3.4.4.1.1.1.3.cmml" type="integer" xref="S2.SS5.p1.3.m3.4.4.1.1.1.3">1</cn></apply><apply id="S2.SS5.p1.3.m3.5.5.2.2.2.cmml" xref="S2.SS5.p1.3.m3.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.5.5.2.2.2.1.cmml" xref="S2.SS5.p1.3.m3.5.5.2.2.2">subscript</csymbol><ci id="S2.SS5.p1.3.m3.5.5.2.2.2.2.cmml" xref="S2.SS5.p1.3.m3.5.5.2.2.2.2">𝑐</ci><cn id="S2.SS5.p1.3.m3.5.5.2.2.2.3.cmml" type="integer" xref="S2.SS5.p1.3.m3.5.5.2.2.2.3">2</cn></apply><ci id="S2.SS5.p1.3.m3.3.3.cmml" xref="S2.SS5.p1.3.m3.3.3">…</ci><apply id="S2.SS5.p1.3.m3.6.6.3.3.3.cmml" xref="S2.SS5.p1.3.m3.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.6.6.3.3.3.1.cmml" xref="S2.SS5.p1.3.m3.6.6.3.3.3">subscript</csymbol><ci id="S2.SS5.p1.3.m3.6.6.3.3.3.2.cmml" xref="S2.SS5.p1.3.m3.6.6.3.3.3.2">𝑐</ci><ci id="S2.SS5.p1.3.m3.6.6.3.3.3.3.cmml" xref="S2.SS5.p1.3.m3.6.6.3.3.3.3">𝑀</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.3.m3.6c">Recommender[u,i,c_{1},c_{2},...,c_{M}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.3.m3.6d">italic_R italic_e italic_c italic_o italic_m italic_m italic_e italic_n italic_d italic_e italic_r [ italic_u , italic_i , italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ]</annotation></semantics></math>. This reduces training time significantly increases online reasoning efficiency, and achieves low latency.</p>
</div>
<div class="ltx_para" id="S2.SS5.p2">
<p class="ltx_p" id="S2.SS5.p2.1">To strengthen feature field information, the users’ latent profiles indices are added into the traditional recommender such as DCN <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib32" title="">2017</a>)</cite>, DeepFM <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib8" title="">2017</a>)</cite> to augment user modelling features and improve collaborative signals, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.F3" title="Figure 3 ‣ 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">3</span></a>. The recommender DCN <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib32" title="">2017</a>)</cite> is used in this module to output the recommendation prediction outcomes <math alttext="\hat{y}^{rec}" class="ltx_Math" display="inline" id="S2.SS5.p2.1.m1.1"><semantics id="S2.SS5.p2.1.m1.1a"><msup id="S2.SS5.p2.1.m1.1.1" xref="S2.SS5.p2.1.m1.1.1.cmml"><mover accent="true" id="S2.SS5.p2.1.m1.1.1.2" xref="S2.SS5.p2.1.m1.1.1.2.cmml"><mi id="S2.SS5.p2.1.m1.1.1.2.2" xref="S2.SS5.p2.1.m1.1.1.2.2.cmml">y</mi><mo id="S2.SS5.p2.1.m1.1.1.2.1" xref="S2.SS5.p2.1.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.SS5.p2.1.m1.1.1.3" xref="S2.SS5.p2.1.m1.1.1.3.cmml"><mi id="S2.SS5.p2.1.m1.1.1.3.2" xref="S2.SS5.p2.1.m1.1.1.3.2.cmml">r</mi><mo id="S2.SS5.p2.1.m1.1.1.3.1" xref="S2.SS5.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.1.m1.1.1.3.3" xref="S2.SS5.p2.1.m1.1.1.3.3.cmml">e</mi><mo id="S2.SS5.p2.1.m1.1.1.3.1a" xref="S2.SS5.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.1.m1.1.1.3.4" xref="S2.SS5.p2.1.m1.1.1.3.4.cmml">c</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.1.m1.1b"><apply id="S2.SS5.p2.1.m1.1.1.cmml" xref="S2.SS5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.1.m1.1.1.1.cmml" xref="S2.SS5.p2.1.m1.1.1">superscript</csymbol><apply id="S2.SS5.p2.1.m1.1.1.2.cmml" xref="S2.SS5.p2.1.m1.1.1.2"><ci id="S2.SS5.p2.1.m1.1.1.2.1.cmml" xref="S2.SS5.p2.1.m1.1.1.2.1">^</ci><ci id="S2.SS5.p2.1.m1.1.1.2.2.cmml" xref="S2.SS5.p2.1.m1.1.1.2.2">𝑦</ci></apply><apply id="S2.SS5.p2.1.m1.1.1.3.cmml" xref="S2.SS5.p2.1.m1.1.1.3"><times id="S2.SS5.p2.1.m1.1.1.3.1.cmml" xref="S2.SS5.p2.1.m1.1.1.3.1"></times><ci id="S2.SS5.p2.1.m1.1.1.3.2.cmml" xref="S2.SS5.p2.1.m1.1.1.3.2">𝑟</ci><ci id="S2.SS5.p2.1.m1.1.1.3.3.cmml" xref="S2.SS5.p2.1.m1.1.1.3.3">𝑒</ci><ci id="S2.SS5.p2.1.m1.1.1.3.4.cmml" xref="S2.SS5.p2.1.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.1.m1.1c">\hat{y}^{rec}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.1.m1.1d">over^ start_ARG italic_y end_ARG start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>. Here, for a given user-item pair, the user’s latent profiles indices are concatenated to user-id and item-id as the input feature fields in recommender, and the single target loss function is defined as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\hat{y}^{rec}=Rec[i,c_{1},c_{2},...,c_{M},E_{obs}]" class="ltx_Math" display="block" id="S2.E8.m1.6"><semantics id="S2.E8.m1.6a"><mrow id="S2.E8.m1.6.6" xref="S2.E8.m1.6.6.cmml"><msup id="S2.E8.m1.6.6.6" xref="S2.E8.m1.6.6.6.cmml"><mover accent="true" id="S2.E8.m1.6.6.6.2" xref="S2.E8.m1.6.6.6.2.cmml"><mi id="S2.E8.m1.6.6.6.2.2" mathsize="90%" xref="S2.E8.m1.6.6.6.2.2.cmml">y</mi><mo id="S2.E8.m1.6.6.6.2.1" mathsize="90%" xref="S2.E8.m1.6.6.6.2.1.cmml">^</mo></mover><mrow id="S2.E8.m1.6.6.6.3" xref="S2.E8.m1.6.6.6.3.cmml"><mi id="S2.E8.m1.6.6.6.3.2" mathsize="90%" xref="S2.E8.m1.6.6.6.3.2.cmml">r</mi><mo id="S2.E8.m1.6.6.6.3.1" xref="S2.E8.m1.6.6.6.3.1.cmml">⁢</mo><mi id="S2.E8.m1.6.6.6.3.3" mathsize="90%" xref="S2.E8.m1.6.6.6.3.3.cmml">e</mi><mo id="S2.E8.m1.6.6.6.3.1a" xref="S2.E8.m1.6.6.6.3.1.cmml">⁢</mo><mi id="S2.E8.m1.6.6.6.3.4" mathsize="90%" xref="S2.E8.m1.6.6.6.3.4.cmml">c</mi></mrow></msup><mo id="S2.E8.m1.6.6.5" mathsize="90%" xref="S2.E8.m1.6.6.5.cmml">=</mo><mrow id="S2.E8.m1.6.6.4" xref="S2.E8.m1.6.6.4.cmml"><mi id="S2.E8.m1.6.6.4.6" mathsize="90%" xref="S2.E8.m1.6.6.4.6.cmml">R</mi><mo id="S2.E8.m1.6.6.4.5" xref="S2.E8.m1.6.6.4.5.cmml">⁢</mo><mi id="S2.E8.m1.6.6.4.7" mathsize="90%" xref="S2.E8.m1.6.6.4.7.cmml">e</mi><mo id="S2.E8.m1.6.6.4.5a" xref="S2.E8.m1.6.6.4.5.cmml">⁢</mo><mi id="S2.E8.m1.6.6.4.8" mathsize="90%" xref="S2.E8.m1.6.6.4.8.cmml">c</mi><mo id="S2.E8.m1.6.6.4.5b" xref="S2.E8.m1.6.6.4.5.cmml">⁢</mo><mrow id="S2.E8.m1.6.6.4.4.4" xref="S2.E8.m1.6.6.4.4.5.cmml"><mo id="S2.E8.m1.6.6.4.4.4.5" maxsize="90%" minsize="90%" xref="S2.E8.m1.6.6.4.4.5.cmml">[</mo><mi id="S2.E8.m1.1.1" mathsize="90%" xref="S2.E8.m1.1.1.cmml">i</mi><mo id="S2.E8.m1.6.6.4.4.4.6" mathsize="90%" xref="S2.E8.m1.6.6.4.4.5.cmml">,</mo><msub id="S2.E8.m1.3.3.1.1.1.1" xref="S2.E8.m1.3.3.1.1.1.1.cmml"><mi id="S2.E8.m1.3.3.1.1.1.1.2" mathsize="90%" xref="S2.E8.m1.3.3.1.1.1.1.2.cmml">c</mi><mn id="S2.E8.m1.3.3.1.1.1.1.3" mathsize="90%" xref="S2.E8.m1.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E8.m1.6.6.4.4.4.7" mathsize="90%" xref="S2.E8.m1.6.6.4.4.5.cmml">,</mo><msub id="S2.E8.m1.4.4.2.2.2.2" xref="S2.E8.m1.4.4.2.2.2.2.cmml"><mi id="S2.E8.m1.4.4.2.2.2.2.2" mathsize="90%" xref="S2.E8.m1.4.4.2.2.2.2.2.cmml">c</mi><mn id="S2.E8.m1.4.4.2.2.2.2.3" mathsize="90%" xref="S2.E8.m1.4.4.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.E8.m1.6.6.4.4.4.8" mathsize="90%" xref="S2.E8.m1.6.6.4.4.5.cmml">,</mo><mi id="S2.E8.m1.2.2" mathsize="90%" mathvariant="normal" xref="S2.E8.m1.2.2.cmml">…</mi><mo id="S2.E8.m1.6.6.4.4.4.9" mathsize="90%" xref="S2.E8.m1.6.6.4.4.5.cmml">,</mo><msub id="S2.E8.m1.5.5.3.3.3.3" xref="S2.E8.m1.5.5.3.3.3.3.cmml"><mi id="S2.E8.m1.5.5.3.3.3.3.2" mathsize="90%" xref="S2.E8.m1.5.5.3.3.3.3.2.cmml">c</mi><mi id="S2.E8.m1.5.5.3.3.3.3.3" mathsize="90%" xref="S2.E8.m1.5.5.3.3.3.3.3.cmml">M</mi></msub><mo id="S2.E8.m1.6.6.4.4.4.10" mathsize="90%" xref="S2.E8.m1.6.6.4.4.5.cmml">,</mo><msub id="S2.E8.m1.6.6.4.4.4.4" xref="S2.E8.m1.6.6.4.4.4.4.cmml"><mi id="S2.E8.m1.6.6.4.4.4.4.2" mathsize="90%" xref="S2.E8.m1.6.6.4.4.4.4.2.cmml">E</mi><mrow id="S2.E8.m1.6.6.4.4.4.4.3" xref="S2.E8.m1.6.6.4.4.4.4.3.cmml"><mi id="S2.E8.m1.6.6.4.4.4.4.3.2" mathsize="90%" xref="S2.E8.m1.6.6.4.4.4.4.3.2.cmml">o</mi><mo id="S2.E8.m1.6.6.4.4.4.4.3.1" xref="S2.E8.m1.6.6.4.4.4.4.3.1.cmml">⁢</mo><mi id="S2.E8.m1.6.6.4.4.4.4.3.3" mathsize="90%" xref="S2.E8.m1.6.6.4.4.4.4.3.3.cmml">b</mi><mo id="S2.E8.m1.6.6.4.4.4.4.3.1a" xref="S2.E8.m1.6.6.4.4.4.4.3.1.cmml">⁢</mo><mi id="S2.E8.m1.6.6.4.4.4.4.3.4" mathsize="90%" xref="S2.E8.m1.6.6.4.4.4.4.3.4.cmml">s</mi></mrow></msub><mo id="S2.E8.m1.6.6.4.4.4.11" maxsize="90%" minsize="90%" xref="S2.E8.m1.6.6.4.4.5.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.6b"><apply id="S2.E8.m1.6.6.cmml" xref="S2.E8.m1.6.6"><eq id="S2.E8.m1.6.6.5.cmml" xref="S2.E8.m1.6.6.5"></eq><apply id="S2.E8.m1.6.6.6.cmml" xref="S2.E8.m1.6.6.6"><csymbol cd="ambiguous" id="S2.E8.m1.6.6.6.1.cmml" xref="S2.E8.m1.6.6.6">superscript</csymbol><apply id="S2.E8.m1.6.6.6.2.cmml" xref="S2.E8.m1.6.6.6.2"><ci id="S2.E8.m1.6.6.6.2.1.cmml" xref="S2.E8.m1.6.6.6.2.1">^</ci><ci id="S2.E8.m1.6.6.6.2.2.cmml" xref="S2.E8.m1.6.6.6.2.2">𝑦</ci></apply><apply id="S2.E8.m1.6.6.6.3.cmml" xref="S2.E8.m1.6.6.6.3"><times id="S2.E8.m1.6.6.6.3.1.cmml" xref="S2.E8.m1.6.6.6.3.1"></times><ci id="S2.E8.m1.6.6.6.3.2.cmml" xref="S2.E8.m1.6.6.6.3.2">𝑟</ci><ci id="S2.E8.m1.6.6.6.3.3.cmml" xref="S2.E8.m1.6.6.6.3.3">𝑒</ci><ci id="S2.E8.m1.6.6.6.3.4.cmml" xref="S2.E8.m1.6.6.6.3.4">𝑐</ci></apply></apply><apply id="S2.E8.m1.6.6.4.cmml" xref="S2.E8.m1.6.6.4"><times id="S2.E8.m1.6.6.4.5.cmml" xref="S2.E8.m1.6.6.4.5"></times><ci id="S2.E8.m1.6.6.4.6.cmml" xref="S2.E8.m1.6.6.4.6">𝑅</ci><ci id="S2.E8.m1.6.6.4.7.cmml" xref="S2.E8.m1.6.6.4.7">𝑒</ci><ci id="S2.E8.m1.6.6.4.8.cmml" xref="S2.E8.m1.6.6.4.8">𝑐</ci><list id="S2.E8.m1.6.6.4.4.5.cmml" xref="S2.E8.m1.6.6.4.4.4"><ci id="S2.E8.m1.1.1.cmml" xref="S2.E8.m1.1.1">𝑖</ci><apply id="S2.E8.m1.3.3.1.1.1.1.cmml" xref="S2.E8.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.1.1.1.cmml" xref="S2.E8.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.1.1.2.cmml" xref="S2.E8.m1.3.3.1.1.1.1.2">𝑐</ci><cn id="S2.E8.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="S2.E8.m1.3.3.1.1.1.1.3">1</cn></apply><apply id="S2.E8.m1.4.4.2.2.2.2.cmml" xref="S2.E8.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.2.2.2.2.1.cmml" xref="S2.E8.m1.4.4.2.2.2.2">subscript</csymbol><ci id="S2.E8.m1.4.4.2.2.2.2.2.cmml" xref="S2.E8.m1.4.4.2.2.2.2.2">𝑐</ci><cn id="S2.E8.m1.4.4.2.2.2.2.3.cmml" type="integer" xref="S2.E8.m1.4.4.2.2.2.2.3">2</cn></apply><ci id="S2.E8.m1.2.2.cmml" xref="S2.E8.m1.2.2">…</ci><apply id="S2.E8.m1.5.5.3.3.3.3.cmml" xref="S2.E8.m1.5.5.3.3.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.5.5.3.3.3.3.1.cmml" xref="S2.E8.m1.5.5.3.3.3.3">subscript</csymbol><ci id="S2.E8.m1.5.5.3.3.3.3.2.cmml" xref="S2.E8.m1.5.5.3.3.3.3.2">𝑐</ci><ci id="S2.E8.m1.5.5.3.3.3.3.3.cmml" xref="S2.E8.m1.5.5.3.3.3.3.3">𝑀</ci></apply><apply id="S2.E8.m1.6.6.4.4.4.4.cmml" xref="S2.E8.m1.6.6.4.4.4.4"><csymbol cd="ambiguous" id="S2.E8.m1.6.6.4.4.4.4.1.cmml" xref="S2.E8.m1.6.6.4.4.4.4">subscript</csymbol><ci id="S2.E8.m1.6.6.4.4.4.4.2.cmml" xref="S2.E8.m1.6.6.4.4.4.4.2">𝐸</ci><apply id="S2.E8.m1.6.6.4.4.4.4.3.cmml" xref="S2.E8.m1.6.6.4.4.4.4.3"><times id="S2.E8.m1.6.6.4.4.4.4.3.1.cmml" xref="S2.E8.m1.6.6.4.4.4.4.3.1"></times><ci id="S2.E8.m1.6.6.4.4.4.4.3.2.cmml" xref="S2.E8.m1.6.6.4.4.4.4.3.2">𝑜</ci><ci id="S2.E8.m1.6.6.4.4.4.4.3.3.cmml" xref="S2.E8.m1.6.6.4.4.4.4.3.3">𝑏</ci><ci id="S2.E8.m1.6.6.4.4.4.4.3.4.cmml" xref="S2.E8.m1.6.6.4.4.4.4.3.4">𝑠</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.6c">\small\hat{y}^{rec}=Rec[i,c_{1},c_{2},...,c_{M},E_{obs}]</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.6d">over^ start_ARG italic_y end_ARG start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT = italic_R italic_e italic_c [ italic_i , italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT italic_o italic_b italic_s end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\ell^{rec}_{u,i}=-\sum_{n=1}^{N}y^{rec}_{n}log(\hat{y}^{rec}_{n})" class="ltx_Math" display="block" id="S2.E9.m1.3"><semantics id="S2.E9.m1.3a"><mrow id="S2.E9.m1.3.3" xref="S2.E9.m1.3.3.cmml"><msubsup id="S2.E9.m1.3.3.3" xref="S2.E9.m1.3.3.3.cmml"><mi id="S2.E9.m1.3.3.3.2.2" mathsize="90%" mathvariant="normal" xref="S2.E9.m1.3.3.3.2.2.cmml">ℓ</mi><mrow id="S2.E9.m1.2.2.2.4" xref="S2.E9.m1.2.2.2.3.cmml"><mi id="S2.E9.m1.1.1.1.1" mathsize="90%" xref="S2.E9.m1.1.1.1.1.cmml">u</mi><mo id="S2.E9.m1.2.2.2.4.1" mathsize="90%" xref="S2.E9.m1.2.2.2.3.cmml">,</mo><mi id="S2.E9.m1.2.2.2.2" mathsize="90%" xref="S2.E9.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S2.E9.m1.3.3.3.2.3" xref="S2.E9.m1.3.3.3.2.3.cmml"><mi id="S2.E9.m1.3.3.3.2.3.2" mathsize="90%" xref="S2.E9.m1.3.3.3.2.3.2.cmml">r</mi><mo id="S2.E9.m1.3.3.3.2.3.1" xref="S2.E9.m1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.E9.m1.3.3.3.2.3.3" mathsize="90%" xref="S2.E9.m1.3.3.3.2.3.3.cmml">e</mi><mo id="S2.E9.m1.3.3.3.2.3.1a" xref="S2.E9.m1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S2.E9.m1.3.3.3.2.3.4" mathsize="90%" xref="S2.E9.m1.3.3.3.2.3.4.cmml">c</mi></mrow></msubsup><mo id="S2.E9.m1.3.3.2" mathsize="90%" xref="S2.E9.m1.3.3.2.cmml">=</mo><mrow id="S2.E9.m1.3.3.1" xref="S2.E9.m1.3.3.1.cmml"><mo id="S2.E9.m1.3.3.1a" mathsize="90%" xref="S2.E9.m1.3.3.1.cmml">−</mo><mrow id="S2.E9.m1.3.3.1.1" xref="S2.E9.m1.3.3.1.1.cmml"><munderover id="S2.E9.m1.3.3.1.1.2" xref="S2.E9.m1.3.3.1.1.2.cmml"><mo id="S2.E9.m1.3.3.1.1.2.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S2.E9.m1.3.3.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E9.m1.3.3.1.1.2.2.3" xref="S2.E9.m1.3.3.1.1.2.2.3.cmml"><mi id="S2.E9.m1.3.3.1.1.2.2.3.2" mathsize="90%" xref="S2.E9.m1.3.3.1.1.2.2.3.2.cmml">n</mi><mo id="S2.E9.m1.3.3.1.1.2.2.3.1" mathsize="90%" xref="S2.E9.m1.3.3.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E9.m1.3.3.1.1.2.2.3.3" mathsize="90%" xref="S2.E9.m1.3.3.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E9.m1.3.3.1.1.2.3" mathsize="90%" xref="S2.E9.m1.3.3.1.1.2.3.cmml">N</mi></munderover><mrow id="S2.E9.m1.3.3.1.1.1" xref="S2.E9.m1.3.3.1.1.1.cmml"><msubsup id="S2.E9.m1.3.3.1.1.1.3" xref="S2.E9.m1.3.3.1.1.1.3.cmml"><mi id="S2.E9.m1.3.3.1.1.1.3.2.2" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.3.2.2.cmml">y</mi><mi id="S2.E9.m1.3.3.1.1.1.3.3" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.3.3.cmml">n</mi><mrow id="S2.E9.m1.3.3.1.1.1.3.2.3" xref="S2.E9.m1.3.3.1.1.1.3.2.3.cmml"><mi id="S2.E9.m1.3.3.1.1.1.3.2.3.2" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.3.2.3.2.cmml">r</mi><mo id="S2.E9.m1.3.3.1.1.1.3.2.3.1" xref="S2.E9.m1.3.3.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E9.m1.3.3.1.1.1.3.2.3.3" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.3.2.3.3.cmml">e</mi><mo id="S2.E9.m1.3.3.1.1.1.3.2.3.1a" xref="S2.E9.m1.3.3.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E9.m1.3.3.1.1.1.3.2.3.4" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.3.2.3.4.cmml">c</mi></mrow></msubsup><mo id="S2.E9.m1.3.3.1.1.1.2" xref="S2.E9.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="S2.E9.m1.3.3.1.1.1.4" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.4.cmml">l</mi><mo id="S2.E9.m1.3.3.1.1.1.2a" xref="S2.E9.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="S2.E9.m1.3.3.1.1.1.5" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.5.cmml">o</mi><mo id="S2.E9.m1.3.3.1.1.1.2b" xref="S2.E9.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="S2.E9.m1.3.3.1.1.1.6" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.6.cmml">g</mi><mo id="S2.E9.m1.3.3.1.1.1.2c" xref="S2.E9.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E9.m1.3.3.1.1.1.1.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E9.m1.3.3.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.E9.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E9.m1.3.3.1.1.1.1.1.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E9.m1.3.3.1.1.1.1.1.1.2.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.2.2.2" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.2.2.cmml">y</mi><mo id="S2.E9.m1.3.3.1.1.1.1.1.1.2.2.1" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.3" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.1.1.1.3.cmml">n</mi><mrow id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.2" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">r</mi><mo id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.3" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">e</mi><mo id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.1a" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.4" mathsize="90%" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.4.cmml">c</mi></mrow></msubsup><mo id="S2.E9.m1.3.3.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.E9.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.3b"><apply id="S2.E9.m1.3.3.cmml" xref="S2.E9.m1.3.3"><eq id="S2.E9.m1.3.3.2.cmml" xref="S2.E9.m1.3.3.2"></eq><apply id="S2.E9.m1.3.3.3.cmml" xref="S2.E9.m1.3.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.3.1.cmml" xref="S2.E9.m1.3.3.3">subscript</csymbol><apply id="S2.E9.m1.3.3.3.2.cmml" xref="S2.E9.m1.3.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.3.2.1.cmml" xref="S2.E9.m1.3.3.3">superscript</csymbol><ci id="S2.E9.m1.3.3.3.2.2.cmml" xref="S2.E9.m1.3.3.3.2.2">ℓ</ci><apply id="S2.E9.m1.3.3.3.2.3.cmml" xref="S2.E9.m1.3.3.3.2.3"><times id="S2.E9.m1.3.3.3.2.3.1.cmml" xref="S2.E9.m1.3.3.3.2.3.1"></times><ci id="S2.E9.m1.3.3.3.2.3.2.cmml" xref="S2.E9.m1.3.3.3.2.3.2">𝑟</ci><ci id="S2.E9.m1.3.3.3.2.3.3.cmml" xref="S2.E9.m1.3.3.3.2.3.3">𝑒</ci><ci id="S2.E9.m1.3.3.3.2.3.4.cmml" xref="S2.E9.m1.3.3.3.2.3.4">𝑐</ci></apply></apply><list id="S2.E9.m1.2.2.2.3.cmml" xref="S2.E9.m1.2.2.2.4"><ci id="S2.E9.m1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1">𝑢</ci><ci id="S2.E9.m1.2.2.2.2.cmml" xref="S2.E9.m1.2.2.2.2">𝑖</ci></list></apply><apply id="S2.E9.m1.3.3.1.cmml" xref="S2.E9.m1.3.3.1"><minus id="S2.E9.m1.3.3.1.2.cmml" xref="S2.E9.m1.3.3.1"></minus><apply id="S2.E9.m1.3.3.1.1.cmml" xref="S2.E9.m1.3.3.1.1"><apply id="S2.E9.m1.3.3.1.1.2.cmml" xref="S2.E9.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.1.1.2.1.cmml" xref="S2.E9.m1.3.3.1.1.2">superscript</csymbol><apply id="S2.E9.m1.3.3.1.1.2.2.cmml" xref="S2.E9.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.1.1.2.2.1.cmml" xref="S2.E9.m1.3.3.1.1.2">subscript</csymbol><sum id="S2.E9.m1.3.3.1.1.2.2.2.cmml" xref="S2.E9.m1.3.3.1.1.2.2.2"></sum><apply id="S2.E9.m1.3.3.1.1.2.2.3.cmml" xref="S2.E9.m1.3.3.1.1.2.2.3"><eq id="S2.E9.m1.3.3.1.1.2.2.3.1.cmml" xref="S2.E9.m1.3.3.1.1.2.2.3.1"></eq><ci id="S2.E9.m1.3.3.1.1.2.2.3.2.cmml" xref="S2.E9.m1.3.3.1.1.2.2.3.2">𝑛</ci><cn id="S2.E9.m1.3.3.1.1.2.2.3.3.cmml" type="integer" xref="S2.E9.m1.3.3.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E9.m1.3.3.1.1.2.3.cmml" xref="S2.E9.m1.3.3.1.1.2.3">𝑁</ci></apply><apply id="S2.E9.m1.3.3.1.1.1.cmml" xref="S2.E9.m1.3.3.1.1.1"><times id="S2.E9.m1.3.3.1.1.1.2.cmml" xref="S2.E9.m1.3.3.1.1.1.2"></times><apply id="S2.E9.m1.3.3.1.1.1.3.cmml" xref="S2.E9.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.1.1.1.3.1.cmml" xref="S2.E9.m1.3.3.1.1.1.3">subscript</csymbol><apply id="S2.E9.m1.3.3.1.1.1.3.2.cmml" xref="S2.E9.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.1.1.1.3.2.1.cmml" xref="S2.E9.m1.3.3.1.1.1.3">superscript</csymbol><ci id="S2.E9.m1.3.3.1.1.1.3.2.2.cmml" xref="S2.E9.m1.3.3.1.1.1.3.2.2">𝑦</ci><apply id="S2.E9.m1.3.3.1.1.1.3.2.3.cmml" xref="S2.E9.m1.3.3.1.1.1.3.2.3"><times id="S2.E9.m1.3.3.1.1.1.3.2.3.1.cmml" xref="S2.E9.m1.3.3.1.1.1.3.2.3.1"></times><ci id="S2.E9.m1.3.3.1.1.1.3.2.3.2.cmml" xref="S2.E9.m1.3.3.1.1.1.3.2.3.2">𝑟</ci><ci id="S2.E9.m1.3.3.1.1.1.3.2.3.3.cmml" xref="S2.E9.m1.3.3.1.1.1.3.2.3.3">𝑒</ci><ci id="S2.E9.m1.3.3.1.1.1.3.2.3.4.cmml" xref="S2.E9.m1.3.3.1.1.1.3.2.3.4">𝑐</ci></apply></apply><ci id="S2.E9.m1.3.3.1.1.1.3.3.cmml" xref="S2.E9.m1.3.3.1.1.1.3.3">𝑛</ci></apply><ci id="S2.E9.m1.3.3.1.1.1.4.cmml" xref="S2.E9.m1.3.3.1.1.1.4">𝑙</ci><ci id="S2.E9.m1.3.3.1.1.1.5.cmml" xref="S2.E9.m1.3.3.1.1.1.5">𝑜</ci><ci id="S2.E9.m1.3.3.1.1.1.6.cmml" xref="S2.E9.m1.3.3.1.1.1.6">𝑔</ci><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1">subscript</csymbol><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.2"><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.2.1">^</ci><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.2.2">𝑦</ci></apply><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3"><times id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.1"></times><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.4.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.4">𝑐</ci></apply></apply><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.3c">\small\ell^{rec}_{u,i}=-\sum_{n=1}^{N}y^{rec}_{n}log(\hat{y}^{rec}_{n})</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.3d">roman_ℓ start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT italic_l italic_o italic_g ( over^ start_ARG italic_y end_ARG start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.p2.11">where <math alttext="Rec[\cdot]" class="ltx_Math" display="inline" id="S2.SS5.p2.2.m1.1"><semantics id="S2.SS5.p2.2.m1.1a"><mrow id="S2.SS5.p2.2.m1.1.2" xref="S2.SS5.p2.2.m1.1.2.cmml"><mi id="S2.SS5.p2.2.m1.1.2.2" xref="S2.SS5.p2.2.m1.1.2.2.cmml">R</mi><mo id="S2.SS5.p2.2.m1.1.2.1" xref="S2.SS5.p2.2.m1.1.2.1.cmml">⁢</mo><mi id="S2.SS5.p2.2.m1.1.2.3" xref="S2.SS5.p2.2.m1.1.2.3.cmml">e</mi><mo id="S2.SS5.p2.2.m1.1.2.1a" xref="S2.SS5.p2.2.m1.1.2.1.cmml">⁢</mo><mi id="S2.SS5.p2.2.m1.1.2.4" xref="S2.SS5.p2.2.m1.1.2.4.cmml">c</mi><mo id="S2.SS5.p2.2.m1.1.2.1b" xref="S2.SS5.p2.2.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS5.p2.2.m1.1.2.5.2" xref="S2.SS5.p2.2.m1.1.2.5.1.cmml"><mo id="S2.SS5.p2.2.m1.1.2.5.2.1" stretchy="false" xref="S2.SS5.p2.2.m1.1.2.5.1.1.cmml">[</mo><mo id="S2.SS5.p2.2.m1.1.1" lspace="0em" rspace="0em" xref="S2.SS5.p2.2.m1.1.1.cmml">⋅</mo><mo id="S2.SS5.p2.2.m1.1.2.5.2.2" stretchy="false" xref="S2.SS5.p2.2.m1.1.2.5.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.2.m1.1b"><apply id="S2.SS5.p2.2.m1.1.2.cmml" xref="S2.SS5.p2.2.m1.1.2"><times id="S2.SS5.p2.2.m1.1.2.1.cmml" xref="S2.SS5.p2.2.m1.1.2.1"></times><ci id="S2.SS5.p2.2.m1.1.2.2.cmml" xref="S2.SS5.p2.2.m1.1.2.2">𝑅</ci><ci id="S2.SS5.p2.2.m1.1.2.3.cmml" xref="S2.SS5.p2.2.m1.1.2.3">𝑒</ci><ci id="S2.SS5.p2.2.m1.1.2.4.cmml" xref="S2.SS5.p2.2.m1.1.2.4">𝑐</ci><apply id="S2.SS5.p2.2.m1.1.2.5.1.cmml" xref="S2.SS5.p2.2.m1.1.2.5.2"><csymbol cd="latexml" id="S2.SS5.p2.2.m1.1.2.5.1.1.cmml" xref="S2.SS5.p2.2.m1.1.2.5.2.1">delimited-[]</csymbol><ci id="S2.SS5.p2.2.m1.1.1.cmml" xref="S2.SS5.p2.2.m1.1.1">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.2.m1.1c">Rec[\cdot]</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.2.m1.1d">italic_R italic_e italic_c [ ⋅ ]</annotation></semantics></math> represent a traditional recommendation model, and <math alttext="y^{rec}_{i}" class="ltx_Math" display="inline" id="S2.SS5.p2.3.m2.1"><semantics id="S2.SS5.p2.3.m2.1a"><msubsup id="S2.SS5.p2.3.m2.1.1" xref="S2.SS5.p2.3.m2.1.1.cmml"><mi id="S2.SS5.p2.3.m2.1.1.2.2" xref="S2.SS5.p2.3.m2.1.1.2.2.cmml">y</mi><mi id="S2.SS5.p2.3.m2.1.1.3" xref="S2.SS5.p2.3.m2.1.1.3.cmml">i</mi><mrow id="S2.SS5.p2.3.m2.1.1.2.3" xref="S2.SS5.p2.3.m2.1.1.2.3.cmml"><mi id="S2.SS5.p2.3.m2.1.1.2.3.2" xref="S2.SS5.p2.3.m2.1.1.2.3.2.cmml">r</mi><mo id="S2.SS5.p2.3.m2.1.1.2.3.1" xref="S2.SS5.p2.3.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.3.m2.1.1.2.3.3" xref="S2.SS5.p2.3.m2.1.1.2.3.3.cmml">e</mi><mo id="S2.SS5.p2.3.m2.1.1.2.3.1a" xref="S2.SS5.p2.3.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.3.m2.1.1.2.3.4" xref="S2.SS5.p2.3.m2.1.1.2.3.4.cmml">c</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.3.m2.1b"><apply id="S2.SS5.p2.3.m2.1.1.cmml" xref="S2.SS5.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.3.m2.1.1.1.cmml" xref="S2.SS5.p2.3.m2.1.1">subscript</csymbol><apply id="S2.SS5.p2.3.m2.1.1.2.cmml" xref="S2.SS5.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.3.m2.1.1.2.1.cmml" xref="S2.SS5.p2.3.m2.1.1">superscript</csymbol><ci id="S2.SS5.p2.3.m2.1.1.2.2.cmml" xref="S2.SS5.p2.3.m2.1.1.2.2">𝑦</ci><apply id="S2.SS5.p2.3.m2.1.1.2.3.cmml" xref="S2.SS5.p2.3.m2.1.1.2.3"><times id="S2.SS5.p2.3.m2.1.1.2.3.1.cmml" xref="S2.SS5.p2.3.m2.1.1.2.3.1"></times><ci id="S2.SS5.p2.3.m2.1.1.2.3.2.cmml" xref="S2.SS5.p2.3.m2.1.1.2.3.2">𝑟</ci><ci id="S2.SS5.p2.3.m2.1.1.2.3.3.cmml" xref="S2.SS5.p2.3.m2.1.1.2.3.3">𝑒</ci><ci id="S2.SS5.p2.3.m2.1.1.2.3.4.cmml" xref="S2.SS5.p2.3.m2.1.1.2.3.4">𝑐</ci></apply></apply><ci id="S2.SS5.p2.3.m2.1.1.3.cmml" xref="S2.SS5.p2.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.3.m2.1c">y^{rec}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.3.m2.1d">italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes the ground-truth binary label about whether user <math alttext="u" class="ltx_Math" display="inline" id="S2.SS5.p2.4.m3.1"><semantics id="S2.SS5.p2.4.m3.1a"><mi id="S2.SS5.p2.4.m3.1.1" xref="S2.SS5.p2.4.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.4.m3.1b"><ci id="S2.SS5.p2.4.m3.1.1.cmml" xref="S2.SS5.p2.4.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.4.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.4.m3.1d">italic_u</annotation></semantics></math> interacts with item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS5.p2.5.m4.1"><semantics id="S2.SS5.p2.5.m4.1a"><mi id="S2.SS5.p2.5.m4.1.1" xref="S2.SS5.p2.5.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.5.m4.1b"><ci id="S2.SS5.p2.5.m4.1.1.cmml" xref="S2.SS5.p2.5.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.5.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.5.m4.1d">italic_i</annotation></semantics></math>, and <math alttext="\hat{y}^{rec}_{i}" class="ltx_Math" display="inline" id="S2.SS5.p2.6.m5.1"><semantics id="S2.SS5.p2.6.m5.1a"><msubsup id="S2.SS5.p2.6.m5.1.1" xref="S2.SS5.p2.6.m5.1.1.cmml"><mover accent="true" id="S2.SS5.p2.6.m5.1.1.2.2" xref="S2.SS5.p2.6.m5.1.1.2.2.cmml"><mi id="S2.SS5.p2.6.m5.1.1.2.2.2" xref="S2.SS5.p2.6.m5.1.1.2.2.2.cmml">y</mi><mo id="S2.SS5.p2.6.m5.1.1.2.2.1" xref="S2.SS5.p2.6.m5.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.SS5.p2.6.m5.1.1.3" xref="S2.SS5.p2.6.m5.1.1.3.cmml">i</mi><mrow id="S2.SS5.p2.6.m5.1.1.2.3" xref="S2.SS5.p2.6.m5.1.1.2.3.cmml"><mi id="S2.SS5.p2.6.m5.1.1.2.3.2" xref="S2.SS5.p2.6.m5.1.1.2.3.2.cmml">r</mi><mo id="S2.SS5.p2.6.m5.1.1.2.3.1" xref="S2.SS5.p2.6.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.6.m5.1.1.2.3.3" xref="S2.SS5.p2.6.m5.1.1.2.3.3.cmml">e</mi><mo id="S2.SS5.p2.6.m5.1.1.2.3.1a" xref="S2.SS5.p2.6.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.6.m5.1.1.2.3.4" xref="S2.SS5.p2.6.m5.1.1.2.3.4.cmml">c</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.6.m5.1b"><apply id="S2.SS5.p2.6.m5.1.1.cmml" xref="S2.SS5.p2.6.m5.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.6.m5.1.1.1.cmml" xref="S2.SS5.p2.6.m5.1.1">subscript</csymbol><apply id="S2.SS5.p2.6.m5.1.1.2.cmml" xref="S2.SS5.p2.6.m5.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.6.m5.1.1.2.1.cmml" xref="S2.SS5.p2.6.m5.1.1">superscript</csymbol><apply id="S2.SS5.p2.6.m5.1.1.2.2.cmml" xref="S2.SS5.p2.6.m5.1.1.2.2"><ci id="S2.SS5.p2.6.m5.1.1.2.2.1.cmml" xref="S2.SS5.p2.6.m5.1.1.2.2.1">^</ci><ci id="S2.SS5.p2.6.m5.1.1.2.2.2.cmml" xref="S2.SS5.p2.6.m5.1.1.2.2.2">𝑦</ci></apply><apply id="S2.SS5.p2.6.m5.1.1.2.3.cmml" xref="S2.SS5.p2.6.m5.1.1.2.3"><times id="S2.SS5.p2.6.m5.1.1.2.3.1.cmml" xref="S2.SS5.p2.6.m5.1.1.2.3.1"></times><ci id="S2.SS5.p2.6.m5.1.1.2.3.2.cmml" xref="S2.SS5.p2.6.m5.1.1.2.3.2">𝑟</ci><ci id="S2.SS5.p2.6.m5.1.1.2.3.3.cmml" xref="S2.SS5.p2.6.m5.1.1.2.3.3">𝑒</ci><ci id="S2.SS5.p2.6.m5.1.1.2.3.4.cmml" xref="S2.SS5.p2.6.m5.1.1.2.3.4">𝑐</ci></apply></apply><ci id="S2.SS5.p2.6.m5.1.1.3.cmml" xref="S2.SS5.p2.6.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.6.m5.1c">\hat{y}^{rec}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.6.m5.1d">over^ start_ARG italic_y end_ARG start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the interaction prediction probability from UserIP-Tuning, and <math alttext="N" class="ltx_Math" display="inline" id="S2.SS5.p2.7.m6.1"><semantics id="S2.SS5.p2.7.m6.1a"><mi id="S2.SS5.p2.7.m6.1.1" xref="S2.SS5.p2.7.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.7.m6.1b"><ci id="S2.SS5.p2.7.m6.1.1.cmml" xref="S2.SS5.p2.7.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.7.m6.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.7.m6.1d">italic_N</annotation></semantics></math> is the number of user-item samples. It is noticeable that <math alttext="y^{rec}_{i}" class="ltx_Math" display="inline" id="S2.SS5.p2.8.m7.1"><semantics id="S2.SS5.p2.8.m7.1a"><msubsup id="S2.SS5.p2.8.m7.1.1" xref="S2.SS5.p2.8.m7.1.1.cmml"><mi id="S2.SS5.p2.8.m7.1.1.2.2" xref="S2.SS5.p2.8.m7.1.1.2.2.cmml">y</mi><mi id="S2.SS5.p2.8.m7.1.1.3" xref="S2.SS5.p2.8.m7.1.1.3.cmml">i</mi><mrow id="S2.SS5.p2.8.m7.1.1.2.3" xref="S2.SS5.p2.8.m7.1.1.2.3.cmml"><mi id="S2.SS5.p2.8.m7.1.1.2.3.2" xref="S2.SS5.p2.8.m7.1.1.2.3.2.cmml">r</mi><mo id="S2.SS5.p2.8.m7.1.1.2.3.1" xref="S2.SS5.p2.8.m7.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.8.m7.1.1.2.3.3" xref="S2.SS5.p2.8.m7.1.1.2.3.3.cmml">e</mi><mo id="S2.SS5.p2.8.m7.1.1.2.3.1a" xref="S2.SS5.p2.8.m7.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.8.m7.1.1.2.3.4" xref="S2.SS5.p2.8.m7.1.1.2.3.4.cmml">c</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.8.m7.1b"><apply id="S2.SS5.p2.8.m7.1.1.cmml" xref="S2.SS5.p2.8.m7.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.8.m7.1.1.1.cmml" xref="S2.SS5.p2.8.m7.1.1">subscript</csymbol><apply id="S2.SS5.p2.8.m7.1.1.2.cmml" xref="S2.SS5.p2.8.m7.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.8.m7.1.1.2.1.cmml" xref="S2.SS5.p2.8.m7.1.1">superscript</csymbol><ci id="S2.SS5.p2.8.m7.1.1.2.2.cmml" xref="S2.SS5.p2.8.m7.1.1.2.2">𝑦</ci><apply id="S2.SS5.p2.8.m7.1.1.2.3.cmml" xref="S2.SS5.p2.8.m7.1.1.2.3"><times id="S2.SS5.p2.8.m7.1.1.2.3.1.cmml" xref="S2.SS5.p2.8.m7.1.1.2.3.1"></times><ci id="S2.SS5.p2.8.m7.1.1.2.3.2.cmml" xref="S2.SS5.p2.8.m7.1.1.2.3.2">𝑟</ci><ci id="S2.SS5.p2.8.m7.1.1.2.3.3.cmml" xref="S2.SS5.p2.8.m7.1.1.2.3.3">𝑒</ci><ci id="S2.SS5.p2.8.m7.1.1.2.3.4.cmml" xref="S2.SS5.p2.8.m7.1.1.2.3.4">𝑐</ci></apply></apply><ci id="S2.SS5.p2.8.m7.1.1.3.cmml" xref="S2.SS5.p2.8.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.8.m7.1c">y^{rec}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.8.m7.1d">italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is determined by the user review rating score: <math alttext="y^{rec}_{i}" class="ltx_Math" display="inline" id="S2.SS5.p2.9.m8.1"><semantics id="S2.SS5.p2.9.m8.1a"><msubsup id="S2.SS5.p2.9.m8.1.1" xref="S2.SS5.p2.9.m8.1.1.cmml"><mi id="S2.SS5.p2.9.m8.1.1.2.2" xref="S2.SS5.p2.9.m8.1.1.2.2.cmml">y</mi><mi id="S2.SS5.p2.9.m8.1.1.3" xref="S2.SS5.p2.9.m8.1.1.3.cmml">i</mi><mrow id="S2.SS5.p2.9.m8.1.1.2.3" xref="S2.SS5.p2.9.m8.1.1.2.3.cmml"><mi id="S2.SS5.p2.9.m8.1.1.2.3.2" xref="S2.SS5.p2.9.m8.1.1.2.3.2.cmml">r</mi><mo id="S2.SS5.p2.9.m8.1.1.2.3.1" xref="S2.SS5.p2.9.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.9.m8.1.1.2.3.3" xref="S2.SS5.p2.9.m8.1.1.2.3.3.cmml">e</mi><mo id="S2.SS5.p2.9.m8.1.1.2.3.1a" xref="S2.SS5.p2.9.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.9.m8.1.1.2.3.4" xref="S2.SS5.p2.9.m8.1.1.2.3.4.cmml">c</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.9.m8.1b"><apply id="S2.SS5.p2.9.m8.1.1.cmml" xref="S2.SS5.p2.9.m8.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.9.m8.1.1.1.cmml" xref="S2.SS5.p2.9.m8.1.1">subscript</csymbol><apply id="S2.SS5.p2.9.m8.1.1.2.cmml" xref="S2.SS5.p2.9.m8.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.9.m8.1.1.2.1.cmml" xref="S2.SS5.p2.9.m8.1.1">superscript</csymbol><ci id="S2.SS5.p2.9.m8.1.1.2.2.cmml" xref="S2.SS5.p2.9.m8.1.1.2.2">𝑦</ci><apply id="S2.SS5.p2.9.m8.1.1.2.3.cmml" xref="S2.SS5.p2.9.m8.1.1.2.3"><times id="S2.SS5.p2.9.m8.1.1.2.3.1.cmml" xref="S2.SS5.p2.9.m8.1.1.2.3.1"></times><ci id="S2.SS5.p2.9.m8.1.1.2.3.2.cmml" xref="S2.SS5.p2.9.m8.1.1.2.3.2">𝑟</ci><ci id="S2.SS5.p2.9.m8.1.1.2.3.3.cmml" xref="S2.SS5.p2.9.m8.1.1.2.3.3">𝑒</ci><ci id="S2.SS5.p2.9.m8.1.1.2.3.4.cmml" xref="S2.SS5.p2.9.m8.1.1.2.3.4">𝑐</ci></apply></apply><ci id="S2.SS5.p2.9.m8.1.1.3.cmml" xref="S2.SS5.p2.9.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.9.m8.1c">y^{rec}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.9.m8.1d">italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> equals to 1 when the review score for item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS5.p2.10.m9.1"><semantics id="S2.SS5.p2.10.m9.1a"><mi id="S2.SS5.p2.10.m9.1.1" xref="S2.SS5.p2.10.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.10.m9.1b"><ci id="S2.SS5.p2.10.m9.1.1.cmml" xref="S2.SS5.p2.10.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.10.m9.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.10.m9.1d">italic_i</annotation></semantics></math> is greater than 3, otherwise <math alttext="y^{rec}_{i}" class="ltx_Math" display="inline" id="S2.SS5.p2.11.m10.1"><semantics id="S2.SS5.p2.11.m10.1a"><msubsup id="S2.SS5.p2.11.m10.1.1" xref="S2.SS5.p2.11.m10.1.1.cmml"><mi id="S2.SS5.p2.11.m10.1.1.2.2" xref="S2.SS5.p2.11.m10.1.1.2.2.cmml">y</mi><mi id="S2.SS5.p2.11.m10.1.1.3" xref="S2.SS5.p2.11.m10.1.1.3.cmml">i</mi><mrow id="S2.SS5.p2.11.m10.1.1.2.3" xref="S2.SS5.p2.11.m10.1.1.2.3.cmml"><mi id="S2.SS5.p2.11.m10.1.1.2.3.2" xref="S2.SS5.p2.11.m10.1.1.2.3.2.cmml">r</mi><mo id="S2.SS5.p2.11.m10.1.1.2.3.1" xref="S2.SS5.p2.11.m10.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.11.m10.1.1.2.3.3" xref="S2.SS5.p2.11.m10.1.1.2.3.3.cmml">e</mi><mo id="S2.SS5.p2.11.m10.1.1.2.3.1a" xref="S2.SS5.p2.11.m10.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.11.m10.1.1.2.3.4" xref="S2.SS5.p2.11.m10.1.1.2.3.4.cmml">c</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.11.m10.1b"><apply id="S2.SS5.p2.11.m10.1.1.cmml" xref="S2.SS5.p2.11.m10.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.11.m10.1.1.1.cmml" xref="S2.SS5.p2.11.m10.1.1">subscript</csymbol><apply id="S2.SS5.p2.11.m10.1.1.2.cmml" xref="S2.SS5.p2.11.m10.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.11.m10.1.1.2.1.cmml" xref="S2.SS5.p2.11.m10.1.1">superscript</csymbol><ci id="S2.SS5.p2.11.m10.1.1.2.2.cmml" xref="S2.SS5.p2.11.m10.1.1.2.2">𝑦</ci><apply id="S2.SS5.p2.11.m10.1.1.2.3.cmml" xref="S2.SS5.p2.11.m10.1.1.2.3"><times id="S2.SS5.p2.11.m10.1.1.2.3.1.cmml" xref="S2.SS5.p2.11.m10.1.1.2.3.1"></times><ci id="S2.SS5.p2.11.m10.1.1.2.3.2.cmml" xref="S2.SS5.p2.11.m10.1.1.2.3.2">𝑟</ci><ci id="S2.SS5.p2.11.m10.1.1.2.3.3.cmml" xref="S2.SS5.p2.11.m10.1.1.2.3.3">𝑒</ci><ci id="S2.SS5.p2.11.m10.1.1.2.3.4.cmml" xref="S2.SS5.p2.11.m10.1.1.2.3.4">𝑐</ci></apply></apply><ci id="S2.SS5.p2.11.m10.1.1.3.cmml" xref="S2.SS5.p2.11.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.11.m10.1c">y^{rec}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.11.m10.1d">italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is 0.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.9.1.1">Algorithm 1</span> </span>  An Algorithm for UserIP-Tuning.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_align_left ltx_figure_panel" id="alg1.7"><span class="ltx_text ltx_font_bold" id="alg1.7.1">Input</span>: Samples in dataset <math alttext="\mathcal{D}=\{(x_{1},x_{2},...,x_{M},D_{task},y^{rec})\}_{u,i}" class="ltx_Math" display="inline" id="alg1.1.m1.4"><semantics id="alg1.1.m1.4a"><mrow id="alg1.1.m1.4.4" xref="alg1.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.1.m1.4.4.3" xref="alg1.1.m1.4.4.3.cmml">𝒟</mi><mo id="alg1.1.m1.4.4.2" xref="alg1.1.m1.4.4.2.cmml">=</mo><msub id="alg1.1.m1.4.4.1" xref="alg1.1.m1.4.4.1.cmml"><mrow id="alg1.1.m1.4.4.1.1.1" xref="alg1.1.m1.4.4.1.1.2.cmml"><mo id="alg1.1.m1.4.4.1.1.1.2" stretchy="false" xref="alg1.1.m1.4.4.1.1.2.cmml">{</mo><mrow id="alg1.1.m1.4.4.1.1.1.1.5" xref="alg1.1.m1.4.4.1.1.1.1.6.cmml"><mo id="alg1.1.m1.4.4.1.1.1.1.5.6" stretchy="false" xref="alg1.1.m1.4.4.1.1.1.1.6.cmml">(</mo><msub id="alg1.1.m1.4.4.1.1.1.1.1.1" xref="alg1.1.m1.4.4.1.1.1.1.1.1.cmml"><mi id="alg1.1.m1.4.4.1.1.1.1.1.1.2" xref="alg1.1.m1.4.4.1.1.1.1.1.1.2.cmml">x</mi><mn id="alg1.1.m1.4.4.1.1.1.1.1.1.3" xref="alg1.1.m1.4.4.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.1.m1.4.4.1.1.1.1.5.7" xref="alg1.1.m1.4.4.1.1.1.1.6.cmml">,</mo><msub id="alg1.1.m1.4.4.1.1.1.1.2.2" xref="alg1.1.m1.4.4.1.1.1.1.2.2.cmml"><mi id="alg1.1.m1.4.4.1.1.1.1.2.2.2" xref="alg1.1.m1.4.4.1.1.1.1.2.2.2.cmml">x</mi><mn id="alg1.1.m1.4.4.1.1.1.1.2.2.3" xref="alg1.1.m1.4.4.1.1.1.1.2.2.3.cmml">2</mn></msub><mo id="alg1.1.m1.4.4.1.1.1.1.5.8" xref="alg1.1.m1.4.4.1.1.1.1.6.cmml">,</mo><mi id="alg1.1.m1.3.3" mathvariant="normal" xref="alg1.1.m1.3.3.cmml">…</mi><mo id="alg1.1.m1.4.4.1.1.1.1.5.9" xref="alg1.1.m1.4.4.1.1.1.1.6.cmml">,</mo><msub id="alg1.1.m1.4.4.1.1.1.1.3.3" xref="alg1.1.m1.4.4.1.1.1.1.3.3.cmml"><mi id="alg1.1.m1.4.4.1.1.1.1.3.3.2" xref="alg1.1.m1.4.4.1.1.1.1.3.3.2.cmml">x</mi><mi id="alg1.1.m1.4.4.1.1.1.1.3.3.3" xref="alg1.1.m1.4.4.1.1.1.1.3.3.3.cmml">M</mi></msub><mo id="alg1.1.m1.4.4.1.1.1.1.5.10" xref="alg1.1.m1.4.4.1.1.1.1.6.cmml">,</mo><msub id="alg1.1.m1.4.4.1.1.1.1.4.4" xref="alg1.1.m1.4.4.1.1.1.1.4.4.cmml"><mi id="alg1.1.m1.4.4.1.1.1.1.4.4.2" xref="alg1.1.m1.4.4.1.1.1.1.4.4.2.cmml">D</mi><mrow id="alg1.1.m1.4.4.1.1.1.1.4.4.3" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.cmml"><mi id="alg1.1.m1.4.4.1.1.1.1.4.4.3.2" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.2.cmml">t</mi><mo id="alg1.1.m1.4.4.1.1.1.1.4.4.3.1" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.1.cmml">⁢</mo><mi id="alg1.1.m1.4.4.1.1.1.1.4.4.3.3" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.3.cmml">a</mi><mo id="alg1.1.m1.4.4.1.1.1.1.4.4.3.1a" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.1.cmml">⁢</mo><mi id="alg1.1.m1.4.4.1.1.1.1.4.4.3.4" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.4.cmml">s</mi><mo id="alg1.1.m1.4.4.1.1.1.1.4.4.3.1b" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.1.cmml">⁢</mo><mi id="alg1.1.m1.4.4.1.1.1.1.4.4.3.5" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.5.cmml">k</mi></mrow></msub><mo id="alg1.1.m1.4.4.1.1.1.1.5.11" xref="alg1.1.m1.4.4.1.1.1.1.6.cmml">,</mo><msup id="alg1.1.m1.4.4.1.1.1.1.5.5" xref="alg1.1.m1.4.4.1.1.1.1.5.5.cmml"><mi id="alg1.1.m1.4.4.1.1.1.1.5.5.2" xref="alg1.1.m1.4.4.1.1.1.1.5.5.2.cmml">y</mi><mrow id="alg1.1.m1.4.4.1.1.1.1.5.5.3" xref="alg1.1.m1.4.4.1.1.1.1.5.5.3.cmml"><mi id="alg1.1.m1.4.4.1.1.1.1.5.5.3.2" xref="alg1.1.m1.4.4.1.1.1.1.5.5.3.2.cmml">r</mi><mo id="alg1.1.m1.4.4.1.1.1.1.5.5.3.1" xref="alg1.1.m1.4.4.1.1.1.1.5.5.3.1.cmml">⁢</mo><mi id="alg1.1.m1.4.4.1.1.1.1.5.5.3.3" xref="alg1.1.m1.4.4.1.1.1.1.5.5.3.3.cmml">e</mi><mo id="alg1.1.m1.4.4.1.1.1.1.5.5.3.1a" xref="alg1.1.m1.4.4.1.1.1.1.5.5.3.1.cmml">⁢</mo><mi id="alg1.1.m1.4.4.1.1.1.1.5.5.3.4" xref="alg1.1.m1.4.4.1.1.1.1.5.5.3.4.cmml">c</mi></mrow></msup><mo id="alg1.1.m1.4.4.1.1.1.1.5.12" stretchy="false" xref="alg1.1.m1.4.4.1.1.1.1.6.cmml">)</mo></mrow><mo id="alg1.1.m1.4.4.1.1.1.3" stretchy="false" xref="alg1.1.m1.4.4.1.1.2.cmml">}</mo></mrow><mrow id="alg1.1.m1.2.2.2.4" xref="alg1.1.m1.2.2.2.3.cmml"><mi id="alg1.1.m1.1.1.1.1" xref="alg1.1.m1.1.1.1.1.cmml">u</mi><mo id="alg1.1.m1.2.2.2.4.1" xref="alg1.1.m1.2.2.2.3.cmml">,</mo><mi id="alg1.1.m1.2.2.2.2" xref="alg1.1.m1.2.2.2.2.cmml">i</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.m1.4b"><apply id="alg1.1.m1.4.4.cmml" xref="alg1.1.m1.4.4"><eq id="alg1.1.m1.4.4.2.cmml" xref="alg1.1.m1.4.4.2"></eq><ci id="alg1.1.m1.4.4.3.cmml" xref="alg1.1.m1.4.4.3">𝒟</ci><apply id="alg1.1.m1.4.4.1.cmml" xref="alg1.1.m1.4.4.1"><csymbol cd="ambiguous" id="alg1.1.m1.4.4.1.2.cmml" xref="alg1.1.m1.4.4.1">subscript</csymbol><set id="alg1.1.m1.4.4.1.1.2.cmml" xref="alg1.1.m1.4.4.1.1.1"><vector id="alg1.1.m1.4.4.1.1.1.1.6.cmml" xref="alg1.1.m1.4.4.1.1.1.1.5"><apply id="alg1.1.m1.4.4.1.1.1.1.1.1.cmml" xref="alg1.1.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="alg1.1.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="alg1.1.m1.4.4.1.1.1.1.1.1.2">𝑥</ci><cn id="alg1.1.m1.4.4.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.1.m1.4.4.1.1.1.1.1.1.3">1</cn></apply><apply id="alg1.1.m1.4.4.1.1.1.1.2.2.cmml" xref="alg1.1.m1.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.1.m1.4.4.1.1.1.1.2.2.1.cmml" xref="alg1.1.m1.4.4.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.1.m1.4.4.1.1.1.1.2.2.2.cmml" xref="alg1.1.m1.4.4.1.1.1.1.2.2.2">𝑥</ci><cn id="alg1.1.m1.4.4.1.1.1.1.2.2.3.cmml" type="integer" xref="alg1.1.m1.4.4.1.1.1.1.2.2.3">2</cn></apply><ci id="alg1.1.m1.3.3.cmml" xref="alg1.1.m1.3.3">…</ci><apply id="alg1.1.m1.4.4.1.1.1.1.3.3.cmml" xref="alg1.1.m1.4.4.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.1.m1.4.4.1.1.1.1.3.3.1.cmml" xref="alg1.1.m1.4.4.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.1.m1.4.4.1.1.1.1.3.3.2.cmml" xref="alg1.1.m1.4.4.1.1.1.1.3.3.2">𝑥</ci><ci id="alg1.1.m1.4.4.1.1.1.1.3.3.3.cmml" xref="alg1.1.m1.4.4.1.1.1.1.3.3.3">𝑀</ci></apply><apply id="alg1.1.m1.4.4.1.1.1.1.4.4.cmml" xref="alg1.1.m1.4.4.1.1.1.1.4.4"><csymbol cd="ambiguous" id="alg1.1.m1.4.4.1.1.1.1.4.4.1.cmml" xref="alg1.1.m1.4.4.1.1.1.1.4.4">subscript</csymbol><ci id="alg1.1.m1.4.4.1.1.1.1.4.4.2.cmml" xref="alg1.1.m1.4.4.1.1.1.1.4.4.2">𝐷</ci><apply id="alg1.1.m1.4.4.1.1.1.1.4.4.3.cmml" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3"><times id="alg1.1.m1.4.4.1.1.1.1.4.4.3.1.cmml" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.1"></times><ci id="alg1.1.m1.4.4.1.1.1.1.4.4.3.2.cmml" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.2">𝑡</ci><ci id="alg1.1.m1.4.4.1.1.1.1.4.4.3.3.cmml" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.3">𝑎</ci><ci id="alg1.1.m1.4.4.1.1.1.1.4.4.3.4.cmml" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.4">𝑠</ci><ci id="alg1.1.m1.4.4.1.1.1.1.4.4.3.5.cmml" xref="alg1.1.m1.4.4.1.1.1.1.4.4.3.5">𝑘</ci></apply></apply><apply id="alg1.1.m1.4.4.1.1.1.1.5.5.cmml" xref="alg1.1.m1.4.4.1.1.1.1.5.5"><csymbol cd="ambiguous" id="alg1.1.m1.4.4.1.1.1.1.5.5.1.cmml" xref="alg1.1.m1.4.4.1.1.1.1.5.5">superscript</csymbol><ci id="alg1.1.m1.4.4.1.1.1.1.5.5.2.cmml" xref="alg1.1.m1.4.4.1.1.1.1.5.5.2">𝑦</ci><apply id="alg1.1.m1.4.4.1.1.1.1.5.5.3.cmml" xref="alg1.1.m1.4.4.1.1.1.1.5.5.3"><times id="alg1.1.m1.4.4.1.1.1.1.5.5.3.1.cmml" xref="alg1.1.m1.4.4.1.1.1.1.5.5.3.1"></times><ci id="alg1.1.m1.4.4.1.1.1.1.5.5.3.2.cmml" xref="alg1.1.m1.4.4.1.1.1.1.5.5.3.2">𝑟</ci><ci id="alg1.1.m1.4.4.1.1.1.1.5.5.3.3.cmml" xref="alg1.1.m1.4.4.1.1.1.1.5.5.3.3">𝑒</ci><ci id="alg1.1.m1.4.4.1.1.1.1.5.5.3.4.cmml" xref="alg1.1.m1.4.4.1.1.1.1.5.5.3.4">𝑐</ci></apply></apply></vector></set><list id="alg1.1.m1.2.2.2.3.cmml" xref="alg1.1.m1.2.2.2.4"><ci id="alg1.1.m1.1.1.1.1.cmml" xref="alg1.1.m1.1.1.1.1">𝑢</ci><ci id="alg1.1.m1.2.2.2.2.cmml" xref="alg1.1.m1.2.2.2.2">𝑖</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.4c">\mathcal{D}=\{(x_{1},x_{2},...,x_{M},D_{task},y^{rec})\}_{u,i}</annotation><annotation encoding="application/x-llamapun" id="alg1.1.m1.4d">caligraphic_D = { ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT , italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT ) } start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for different user-item pairs <math alttext="(u,i)" class="ltx_Math" display="inline" id="alg1.2.m2.2"><semantics id="alg1.2.m2.2a"><mrow id="alg1.2.m2.2.3.2" xref="alg1.2.m2.2.3.1.cmml"><mo id="alg1.2.m2.2.3.2.1" stretchy="false" xref="alg1.2.m2.2.3.1.cmml">(</mo><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">u</mi><mo id="alg1.2.m2.2.3.2.2" xref="alg1.2.m2.2.3.1.cmml">,</mo><mi id="alg1.2.m2.2.2" xref="alg1.2.m2.2.2.cmml">i</mi><mo id="alg1.2.m2.2.3.2.3" stretchy="false" xref="alg1.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.m2.2b"><interval closure="open" id="alg1.2.m2.2.3.1.cmml" xref="alg1.2.m2.2.3.2"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝑢</ci><ci id="alg1.2.m2.2.2.cmml" xref="alg1.2.m2.2.2">𝑖</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.2c">(u,i)</annotation><annotation encoding="application/x-llamapun" id="alg1.2.m2.2d">( italic_u , italic_i )</annotation></semantics></math>, LLMs Llama2, user profiles tokens <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="alg1.3.m3.1"><semantics id="alg1.3.m3.1a"><msub id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml"><mi id="alg1.3.m3.1.1.2" xref="alg1.3.m3.1.1.2.cmml">θ</mi><mn id="alg1.3.m3.1.1.3" xref="alg1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><apply id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.3.m3.1.1.1.cmml" xref="alg1.3.m3.1.1">subscript</csymbol><ci id="alg1.3.m3.1.1.2.cmml" xref="alg1.3.m3.1.1.2">𝜃</ci><cn id="alg1.3.m3.1.1.3.cmml" type="integer" xref="alg1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="alg1.3.m3.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\theta^{2}" class="ltx_Math" display="inline" id="alg1.4.m4.1"><semantics id="alg1.4.m4.1a"><msup id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml"><mi id="alg1.4.m4.1.1.2" xref="alg1.4.m4.1.1.2.cmml">θ</mi><mn id="alg1.4.m4.1.1.3" xref="alg1.4.m4.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><apply id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1"><csymbol cd="ambiguous" id="alg1.4.m4.1.1.1.cmml" xref="alg1.4.m4.1.1">superscript</csymbol><ci id="alg1.4.m4.1.1.2.cmml" xref="alg1.4.m4.1.1.2">𝜃</ci><cn id="alg1.4.m4.1.1.3.cmml" type="integer" xref="alg1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">\theta^{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.4.m4.1d">italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, …, <math alttext="\theta^{M}" class="ltx_Math" display="inline" id="alg1.5.m5.1"><semantics id="alg1.5.m5.1a"><msup id="alg1.5.m5.1.1" xref="alg1.5.m5.1.1.cmml"><mi id="alg1.5.m5.1.1.2" xref="alg1.5.m5.1.1.2.cmml">θ</mi><mi id="alg1.5.m5.1.1.3" xref="alg1.5.m5.1.1.3.cmml">M</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><apply id="alg1.5.m5.1.1.cmml" xref="alg1.5.m5.1.1"><csymbol cd="ambiguous" id="alg1.5.m5.1.1.1.cmml" xref="alg1.5.m5.1.1">superscript</csymbol><ci id="alg1.5.m5.1.1.2.cmml" xref="alg1.5.m5.1.1.2">𝜃</ci><ci id="alg1.5.m5.1.1.3.cmml" xref="alg1.5.m5.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">\theta^{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.5.m5.1d">italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>, codebook sizes for profiles <math alttext="k_{1},k_{2},...,k_{M}" class="ltx_Math" display="inline" id="alg1.6.m6.4"><semantics id="alg1.6.m6.4a"><mrow id="alg1.6.m6.4.4.3" xref="alg1.6.m6.4.4.4.cmml"><msub id="alg1.6.m6.2.2.1.1" xref="alg1.6.m6.2.2.1.1.cmml"><mi id="alg1.6.m6.2.2.1.1.2" xref="alg1.6.m6.2.2.1.1.2.cmml">k</mi><mn id="alg1.6.m6.2.2.1.1.3" xref="alg1.6.m6.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.6.m6.4.4.3.4" xref="alg1.6.m6.4.4.4.cmml">,</mo><msub id="alg1.6.m6.3.3.2.2" xref="alg1.6.m6.3.3.2.2.cmml"><mi id="alg1.6.m6.3.3.2.2.2" xref="alg1.6.m6.3.3.2.2.2.cmml">k</mi><mn id="alg1.6.m6.3.3.2.2.3" xref="alg1.6.m6.3.3.2.2.3.cmml">2</mn></msub><mo id="alg1.6.m6.4.4.3.5" xref="alg1.6.m6.4.4.4.cmml">,</mo><mi id="alg1.6.m6.1.1" mathvariant="normal" xref="alg1.6.m6.1.1.cmml">…</mi><mo id="alg1.6.m6.4.4.3.6" xref="alg1.6.m6.4.4.4.cmml">,</mo><msub id="alg1.6.m6.4.4.3.3" xref="alg1.6.m6.4.4.3.3.cmml"><mi id="alg1.6.m6.4.4.3.3.2" xref="alg1.6.m6.4.4.3.3.2.cmml">k</mi><mi id="alg1.6.m6.4.4.3.3.3" xref="alg1.6.m6.4.4.3.3.3.cmml">M</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.6.m6.4b"><list id="alg1.6.m6.4.4.4.cmml" xref="alg1.6.m6.4.4.3"><apply id="alg1.6.m6.2.2.1.1.cmml" xref="alg1.6.m6.2.2.1.1"><csymbol cd="ambiguous" id="alg1.6.m6.2.2.1.1.1.cmml" xref="alg1.6.m6.2.2.1.1">subscript</csymbol><ci id="alg1.6.m6.2.2.1.1.2.cmml" xref="alg1.6.m6.2.2.1.1.2">𝑘</ci><cn id="alg1.6.m6.2.2.1.1.3.cmml" type="integer" xref="alg1.6.m6.2.2.1.1.3">1</cn></apply><apply id="alg1.6.m6.3.3.2.2.cmml" xref="alg1.6.m6.3.3.2.2"><csymbol cd="ambiguous" id="alg1.6.m6.3.3.2.2.1.cmml" xref="alg1.6.m6.3.3.2.2">subscript</csymbol><ci id="alg1.6.m6.3.3.2.2.2.cmml" xref="alg1.6.m6.3.3.2.2.2">𝑘</ci><cn id="alg1.6.m6.3.3.2.2.3.cmml" type="integer" xref="alg1.6.m6.3.3.2.2.3">2</cn></apply><ci id="alg1.6.m6.1.1.cmml" xref="alg1.6.m6.1.1">…</ci><apply id="alg1.6.m6.4.4.3.3.cmml" xref="alg1.6.m6.4.4.3.3"><csymbol cd="ambiguous" id="alg1.6.m6.4.4.3.3.1.cmml" xref="alg1.6.m6.4.4.3.3">subscript</csymbol><ci id="alg1.6.m6.4.4.3.3.2.cmml" xref="alg1.6.m6.4.4.3.3.2">𝑘</ci><ci id="alg1.6.m6.4.4.3.3.3.cmml" xref="alg1.6.m6.4.4.3.3.3">𝑀</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m6.4c">k_{1},k_{2},...,k_{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.6.m6.4d">italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_k start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math>. Freeze all parameters in Llama2 except <math alttext="\theta^{m}" class="ltx_Math" display="inline" id="alg1.7.m7.1"><semantics id="alg1.7.m7.1a"><msup id="alg1.7.m7.1.1" xref="alg1.7.m7.1.1.cmml"><mi id="alg1.7.m7.1.1.2" xref="alg1.7.m7.1.1.2.cmml">θ</mi><mi id="alg1.7.m7.1.1.3" xref="alg1.7.m7.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.7.m7.1b"><apply id="alg1.7.m7.1.1.cmml" xref="alg1.7.m7.1.1"><csymbol cd="ambiguous" id="alg1.7.m7.1.1.1.cmml" xref="alg1.7.m7.1.1">superscript</csymbol><ci id="alg1.7.m7.1.1.2.cmml" xref="alg1.7.m7.1.1.2">𝜃</ci><ci id="alg1.7.m7.1.1.3.cmml" xref="alg1.7.m7.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m7.1c">\theta^{m}</annotation><annotation encoding="application/x-llamapun" id="alg1.7.m7.1d">italic_θ start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="alg1.7.2">Output</span>: Fine-tuned user latent profiles embedding, user profiles indices, quantization codebooks. 
<br class="ltx_break"/></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_listing ltx_align_left ltx_figure_panel ltx_listing" id="alg1.10">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l1.2">while</span> not converged <span class="ltx_text ltx_font_bold" id="alg1.l1.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>     Sample a random batch <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">caligraphic_B</annotation></semantics></math> in <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">caligraphic_D</annotation></semantics></math> and initialize gradients <math alttext="g_{1}\leftarrow 0" class="ltx_Math" display="inline" id="alg1.l2.m3.1"><semantics id="alg1.l2.m3.1a"><mrow id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><msub id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml"><mi id="alg1.l2.m3.1.1.2.2" xref="alg1.l2.m3.1.1.2.2.cmml">g</mi><mn id="alg1.l2.m3.1.1.2.3" xref="alg1.l2.m3.1.1.2.3.cmml">1</mn></msub><mo id="alg1.l2.m3.1.1.1" stretchy="false" xref="alg1.l2.m3.1.1.1.cmml">←</mo><mn id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><ci id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1.1">←</ci><apply id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.2.1.cmml" xref="alg1.l2.m3.1.1.2">subscript</csymbol><ci id="alg1.l2.m3.1.1.2.2.cmml" xref="alg1.l2.m3.1.1.2.2">𝑔</ci><cn id="alg1.l2.m3.1.1.2.3.cmml" type="integer" xref="alg1.l2.m3.1.1.2.3">1</cn></apply><cn id="alg1.l2.m3.1.1.3.cmml" type="integer" xref="alg1.l2.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">g_{1}\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m3.1d">italic_g start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ← 0</annotation></semantics></math> and <math alttext="g_{2}\leftarrow 0" class="ltx_Math" display="inline" id="alg1.l2.m4.1"><semantics id="alg1.l2.m4.1a"><mrow id="alg1.l2.m4.1.1" xref="alg1.l2.m4.1.1.cmml"><msub id="alg1.l2.m4.1.1.2" xref="alg1.l2.m4.1.1.2.cmml"><mi id="alg1.l2.m4.1.1.2.2" xref="alg1.l2.m4.1.1.2.2.cmml">g</mi><mn id="alg1.l2.m4.1.1.2.3" xref="alg1.l2.m4.1.1.2.3.cmml">2</mn></msub><mo id="alg1.l2.m4.1.1.1" stretchy="false" xref="alg1.l2.m4.1.1.1.cmml">←</mo><mn id="alg1.l2.m4.1.1.3" xref="alg1.l2.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m4.1b"><apply id="alg1.l2.m4.1.1.cmml" xref="alg1.l2.m4.1.1"><ci id="alg1.l2.m4.1.1.1.cmml" xref="alg1.l2.m4.1.1.1">←</ci><apply id="alg1.l2.m4.1.1.2.cmml" xref="alg1.l2.m4.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m4.1.1.2.1.cmml" xref="alg1.l2.m4.1.1.2">subscript</csymbol><ci id="alg1.l2.m4.1.1.2.2.cmml" xref="alg1.l2.m4.1.1.2.2">𝑔</ci><cn id="alg1.l2.m4.1.1.2.3.cmml" type="integer" xref="alg1.l2.m4.1.1.2.3">2</cn></apply><cn id="alg1.l2.m4.1.1.3.cmml" type="integer" xref="alg1.l2.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m4.1c">g_{2}\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m4.1d">italic_g start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ← 0</annotation></semantics></math>, and VQ cluster centroids <math alttext="\boldsymbol{v}^{m}_{k}" class="ltx_Math" display="inline" id="alg1.l2.m5.1"><semantics id="alg1.l2.m5.1a"><msubsup id="alg1.l2.m5.1.1" xref="alg1.l2.m5.1.1.cmml"><mi id="alg1.l2.m5.1.1.2.2" xref="alg1.l2.m5.1.1.2.2.cmml">𝒗</mi><mi id="alg1.l2.m5.1.1.3" xref="alg1.l2.m5.1.1.3.cmml">k</mi><mi id="alg1.l2.m5.1.1.2.3" xref="alg1.l2.m5.1.1.2.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l2.m5.1b"><apply id="alg1.l2.m5.1.1.cmml" xref="alg1.l2.m5.1.1"><csymbol cd="ambiguous" id="alg1.l2.m5.1.1.1.cmml" xref="alg1.l2.m5.1.1">subscript</csymbol><apply id="alg1.l2.m5.1.1.2.cmml" xref="alg1.l2.m5.1.1"><csymbol cd="ambiguous" id="alg1.l2.m5.1.1.2.1.cmml" xref="alg1.l2.m5.1.1">superscript</csymbol><ci id="alg1.l2.m5.1.1.2.2.cmml" xref="alg1.l2.m5.1.1.2.2">𝒗</ci><ci id="alg1.l2.m5.1.1.2.3.cmml" xref="alg1.l2.m5.1.1.2.3">𝑚</ci></apply><ci id="alg1.l2.m5.1.1.3.cmml" xref="alg1.l2.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m5.1c">\boldsymbol{v}^{m}_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m5.1d">bold_italic_v start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l3.2">for</span> each data point <math alttext="(x_{1},x_{2},...,x_{M},D_{task_{i}},y^{rec})" class="ltx_Math" display="inline" id="alg1.l3.m1.6"><semantics id="alg1.l3.m1.6a"><mrow id="alg1.l3.m1.6.6.5" xref="alg1.l3.m1.6.6.6.cmml"><mo id="alg1.l3.m1.6.6.5.6" stretchy="false" xref="alg1.l3.m1.6.6.6.cmml">(</mo><msub id="alg1.l3.m1.2.2.1.1" xref="alg1.l3.m1.2.2.1.1.cmml"><mi id="alg1.l3.m1.2.2.1.1.2" xref="alg1.l3.m1.2.2.1.1.2.cmml">x</mi><mn id="alg1.l3.m1.2.2.1.1.3" xref="alg1.l3.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.l3.m1.6.6.5.7" xref="alg1.l3.m1.6.6.6.cmml">,</mo><msub id="alg1.l3.m1.3.3.2.2" xref="alg1.l3.m1.3.3.2.2.cmml"><mi id="alg1.l3.m1.3.3.2.2.2" xref="alg1.l3.m1.3.3.2.2.2.cmml">x</mi><mn id="alg1.l3.m1.3.3.2.2.3" xref="alg1.l3.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="alg1.l3.m1.6.6.5.8" xref="alg1.l3.m1.6.6.6.cmml">,</mo><mi id="alg1.l3.m1.1.1" mathvariant="normal" xref="alg1.l3.m1.1.1.cmml">…</mi><mo id="alg1.l3.m1.6.6.5.9" xref="alg1.l3.m1.6.6.6.cmml">,</mo><msub id="alg1.l3.m1.4.4.3.3" xref="alg1.l3.m1.4.4.3.3.cmml"><mi id="alg1.l3.m1.4.4.3.3.2" xref="alg1.l3.m1.4.4.3.3.2.cmml">x</mi><mi id="alg1.l3.m1.4.4.3.3.3" xref="alg1.l3.m1.4.4.3.3.3.cmml">M</mi></msub><mo id="alg1.l3.m1.6.6.5.10" xref="alg1.l3.m1.6.6.6.cmml">,</mo><msub id="alg1.l3.m1.5.5.4.4" xref="alg1.l3.m1.5.5.4.4.cmml"><mi id="alg1.l3.m1.5.5.4.4.2" xref="alg1.l3.m1.5.5.4.4.2.cmml">D</mi><mrow id="alg1.l3.m1.5.5.4.4.3" xref="alg1.l3.m1.5.5.4.4.3.cmml"><mi id="alg1.l3.m1.5.5.4.4.3.2" xref="alg1.l3.m1.5.5.4.4.3.2.cmml">t</mi><mo id="alg1.l3.m1.5.5.4.4.3.1" xref="alg1.l3.m1.5.5.4.4.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.5.5.4.4.3.3" xref="alg1.l3.m1.5.5.4.4.3.3.cmml">a</mi><mo id="alg1.l3.m1.5.5.4.4.3.1a" xref="alg1.l3.m1.5.5.4.4.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.5.5.4.4.3.4" xref="alg1.l3.m1.5.5.4.4.3.4.cmml">s</mi><mo id="alg1.l3.m1.5.5.4.4.3.1b" xref="alg1.l3.m1.5.5.4.4.3.1.cmml">⁢</mo><msub id="alg1.l3.m1.5.5.4.4.3.5" xref="alg1.l3.m1.5.5.4.4.3.5.cmml"><mi id="alg1.l3.m1.5.5.4.4.3.5.2" xref="alg1.l3.m1.5.5.4.4.3.5.2.cmml">k</mi><mi id="alg1.l3.m1.5.5.4.4.3.5.3" xref="alg1.l3.m1.5.5.4.4.3.5.3.cmml">i</mi></msub></mrow></msub><mo id="alg1.l3.m1.6.6.5.11" xref="alg1.l3.m1.6.6.6.cmml">,</mo><msup id="alg1.l3.m1.6.6.5.5" xref="alg1.l3.m1.6.6.5.5.cmml"><mi id="alg1.l3.m1.6.6.5.5.2" xref="alg1.l3.m1.6.6.5.5.2.cmml">y</mi><mrow id="alg1.l3.m1.6.6.5.5.3" xref="alg1.l3.m1.6.6.5.5.3.cmml"><mi id="alg1.l3.m1.6.6.5.5.3.2" xref="alg1.l3.m1.6.6.5.5.3.2.cmml">r</mi><mo id="alg1.l3.m1.6.6.5.5.3.1" xref="alg1.l3.m1.6.6.5.5.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.6.6.5.5.3.3" xref="alg1.l3.m1.6.6.5.5.3.3.cmml">e</mi><mo id="alg1.l3.m1.6.6.5.5.3.1a" xref="alg1.l3.m1.6.6.5.5.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.6.6.5.5.3.4" xref="alg1.l3.m1.6.6.5.5.3.4.cmml">c</mi></mrow></msup><mo id="alg1.l3.m1.6.6.5.12" stretchy="false" xref="alg1.l3.m1.6.6.6.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.6b"><vector id="alg1.l3.m1.6.6.6.cmml" xref="alg1.l3.m1.6.6.5"><apply id="alg1.l3.m1.2.2.1.1.cmml" xref="alg1.l3.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l3.m1.2.2.1.1.2.cmml" xref="alg1.l3.m1.2.2.1.1.2">𝑥</ci><cn id="alg1.l3.m1.2.2.1.1.3.cmml" type="integer" xref="alg1.l3.m1.2.2.1.1.3">1</cn></apply><apply id="alg1.l3.m1.3.3.2.2.cmml" xref="alg1.l3.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.3.3.2.2.1.cmml" xref="alg1.l3.m1.3.3.2.2">subscript</csymbol><ci id="alg1.l3.m1.3.3.2.2.2.cmml" xref="alg1.l3.m1.3.3.2.2.2">𝑥</ci><cn id="alg1.l3.m1.3.3.2.2.3.cmml" type="integer" xref="alg1.l3.m1.3.3.2.2.3">2</cn></apply><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">…</ci><apply id="alg1.l3.m1.4.4.3.3.cmml" xref="alg1.l3.m1.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.4.4.3.3.1.cmml" xref="alg1.l3.m1.4.4.3.3">subscript</csymbol><ci id="alg1.l3.m1.4.4.3.3.2.cmml" xref="alg1.l3.m1.4.4.3.3.2">𝑥</ci><ci id="alg1.l3.m1.4.4.3.3.3.cmml" xref="alg1.l3.m1.4.4.3.3.3">𝑀</ci></apply><apply id="alg1.l3.m1.5.5.4.4.cmml" xref="alg1.l3.m1.5.5.4.4"><csymbol cd="ambiguous" id="alg1.l3.m1.5.5.4.4.1.cmml" xref="alg1.l3.m1.5.5.4.4">subscript</csymbol><ci id="alg1.l3.m1.5.5.4.4.2.cmml" xref="alg1.l3.m1.5.5.4.4.2">𝐷</ci><apply id="alg1.l3.m1.5.5.4.4.3.cmml" xref="alg1.l3.m1.5.5.4.4.3"><times id="alg1.l3.m1.5.5.4.4.3.1.cmml" xref="alg1.l3.m1.5.5.4.4.3.1"></times><ci id="alg1.l3.m1.5.5.4.4.3.2.cmml" xref="alg1.l3.m1.5.5.4.4.3.2">𝑡</ci><ci id="alg1.l3.m1.5.5.4.4.3.3.cmml" xref="alg1.l3.m1.5.5.4.4.3.3">𝑎</ci><ci id="alg1.l3.m1.5.5.4.4.3.4.cmml" xref="alg1.l3.m1.5.5.4.4.3.4">𝑠</ci><apply id="alg1.l3.m1.5.5.4.4.3.5.cmml" xref="alg1.l3.m1.5.5.4.4.3.5"><csymbol cd="ambiguous" id="alg1.l3.m1.5.5.4.4.3.5.1.cmml" xref="alg1.l3.m1.5.5.4.4.3.5">subscript</csymbol><ci id="alg1.l3.m1.5.5.4.4.3.5.2.cmml" xref="alg1.l3.m1.5.5.4.4.3.5.2">𝑘</ci><ci id="alg1.l3.m1.5.5.4.4.3.5.3.cmml" xref="alg1.l3.m1.5.5.4.4.3.5.3">𝑖</ci></apply></apply></apply><apply id="alg1.l3.m1.6.6.5.5.cmml" xref="alg1.l3.m1.6.6.5.5"><csymbol cd="ambiguous" id="alg1.l3.m1.6.6.5.5.1.cmml" xref="alg1.l3.m1.6.6.5.5">superscript</csymbol><ci id="alg1.l3.m1.6.6.5.5.2.cmml" xref="alg1.l3.m1.6.6.5.5.2">𝑦</ci><apply id="alg1.l3.m1.6.6.5.5.3.cmml" xref="alg1.l3.m1.6.6.5.5.3"><times id="alg1.l3.m1.6.6.5.5.3.1.cmml" xref="alg1.l3.m1.6.6.5.5.3.1"></times><ci id="alg1.l3.m1.6.6.5.5.3.2.cmml" xref="alg1.l3.m1.6.6.5.5.3.2">𝑟</ci><ci id="alg1.l3.m1.6.6.5.5.3.3.cmml" xref="alg1.l3.m1.6.6.5.5.3.3">𝑒</ci><ci id="alg1.l3.m1.6.6.5.5.3.4.cmml" xref="alg1.l3.m1.6.6.5.5.3.4">𝑐</ci></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.6c">(x_{1},x_{2},...,x_{M},D_{task_{i}},y^{rec})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.6d">( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT )</annotation></semantics></math> in <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">caligraphic_B</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l3.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>        Update gradient <math alttext="g_{1}=g_{1}+\frac{\partial\ell^{llm}_{u,i}(x^{1},x^{2},...,x^{M},y^{rec}\theta%
^{1},\theta^{2},...,\theta^{M})}{\partial\textit{E}_{latent}}" class="ltx_Math" display="inline" id="alg1.l4.m1.10"><semantics id="alg1.l4.m1.10a"><mrow id="alg1.l4.m1.10.11" xref="alg1.l4.m1.10.11.cmml"><msub id="alg1.l4.m1.10.11.2" xref="alg1.l4.m1.10.11.2.cmml"><mi id="alg1.l4.m1.10.11.2.2" xref="alg1.l4.m1.10.11.2.2.cmml">g</mi><mn id="alg1.l4.m1.10.11.2.3" xref="alg1.l4.m1.10.11.2.3.cmml">1</mn></msub><mo id="alg1.l4.m1.10.11.1" xref="alg1.l4.m1.10.11.1.cmml">=</mo><mrow id="alg1.l4.m1.10.11.3" xref="alg1.l4.m1.10.11.3.cmml"><msub id="alg1.l4.m1.10.11.3.2" xref="alg1.l4.m1.10.11.3.2.cmml"><mi id="alg1.l4.m1.10.11.3.2.2" xref="alg1.l4.m1.10.11.3.2.2.cmml">g</mi><mn id="alg1.l4.m1.10.11.3.2.3" xref="alg1.l4.m1.10.11.3.2.3.cmml">1</mn></msub><mo id="alg1.l4.m1.10.11.3.1" xref="alg1.l4.m1.10.11.3.1.cmml">+</mo><mfrac id="alg1.l4.m1.10.10" xref="alg1.l4.m1.10.10.cmml"><mrow id="alg1.l4.m1.10.10.10" xref="alg1.l4.m1.10.10.10.cmml"><mo id="alg1.l4.m1.10.10.10.11" rspace="0em" xref="alg1.l4.m1.10.10.10.11.cmml">∂</mo><mrow id="alg1.l4.m1.10.10.10.10" xref="alg1.l4.m1.10.10.10.10.cmml"><msubsup id="alg1.l4.m1.10.10.10.10.8" xref="alg1.l4.m1.10.10.10.10.8.cmml"><mi id="alg1.l4.m1.10.10.10.10.8.2.2" mathvariant="normal" xref="alg1.l4.m1.10.10.10.10.8.2.2.cmml">ℓ</mi><mrow id="alg1.l4.m1.2.2.2.2.2.4" xref="alg1.l4.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.cmml">u</mi><mo id="alg1.l4.m1.2.2.2.2.2.4.1" xref="alg1.l4.m1.2.2.2.2.2.3.cmml">,</mo><mi id="alg1.l4.m1.2.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.2.2.cmml">i</mi></mrow><mrow id="alg1.l4.m1.10.10.10.10.8.2.3" xref="alg1.l4.m1.10.10.10.10.8.2.3.cmml"><mi id="alg1.l4.m1.10.10.10.10.8.2.3.2" xref="alg1.l4.m1.10.10.10.10.8.2.3.2.cmml">l</mi><mo id="alg1.l4.m1.10.10.10.10.8.2.3.1" xref="alg1.l4.m1.10.10.10.10.8.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.10.10.10.10.8.2.3.3" xref="alg1.l4.m1.10.10.10.10.8.2.3.3.cmml">l</mi><mo id="alg1.l4.m1.10.10.10.10.8.2.3.1a" xref="alg1.l4.m1.10.10.10.10.8.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.10.10.10.10.8.2.3.4" xref="alg1.l4.m1.10.10.10.10.8.2.3.4.cmml">m</mi></mrow></msubsup><mo id="alg1.l4.m1.10.10.10.10.7" xref="alg1.l4.m1.10.10.10.10.7.cmml">⁢</mo><mrow id="alg1.l4.m1.10.10.10.10.6.6" xref="alg1.l4.m1.10.10.10.10.6.7.cmml"><mo id="alg1.l4.m1.10.10.10.10.6.6.7" stretchy="false" xref="alg1.l4.m1.10.10.10.10.6.7.cmml">(</mo><msup id="alg1.l4.m1.5.5.5.5.1.1.1" xref="alg1.l4.m1.5.5.5.5.1.1.1.cmml"><mi id="alg1.l4.m1.5.5.5.5.1.1.1.2" xref="alg1.l4.m1.5.5.5.5.1.1.1.2.cmml">x</mi><mn id="alg1.l4.m1.5.5.5.5.1.1.1.3" xref="alg1.l4.m1.5.5.5.5.1.1.1.3.cmml">1</mn></msup><mo id="alg1.l4.m1.10.10.10.10.6.6.8" xref="alg1.l4.m1.10.10.10.10.6.7.cmml">,</mo><msup id="alg1.l4.m1.6.6.6.6.2.2.2" xref="alg1.l4.m1.6.6.6.6.2.2.2.cmml"><mi id="alg1.l4.m1.6.6.6.6.2.2.2.2" xref="alg1.l4.m1.6.6.6.6.2.2.2.2.cmml">x</mi><mn id="alg1.l4.m1.6.6.6.6.2.2.2.3" xref="alg1.l4.m1.6.6.6.6.2.2.2.3.cmml">2</mn></msup><mo id="alg1.l4.m1.10.10.10.10.6.6.9" xref="alg1.l4.m1.10.10.10.10.6.7.cmml">,</mo><mi id="alg1.l4.m1.3.3.3.3" mathvariant="normal" xref="alg1.l4.m1.3.3.3.3.cmml">…</mi><mo id="alg1.l4.m1.10.10.10.10.6.6.10" xref="alg1.l4.m1.10.10.10.10.6.7.cmml">,</mo><msup id="alg1.l4.m1.7.7.7.7.3.3.3" xref="alg1.l4.m1.7.7.7.7.3.3.3.cmml"><mi id="alg1.l4.m1.7.7.7.7.3.3.3.2" xref="alg1.l4.m1.7.7.7.7.3.3.3.2.cmml">x</mi><mi id="alg1.l4.m1.7.7.7.7.3.3.3.3" xref="alg1.l4.m1.7.7.7.7.3.3.3.3.cmml">M</mi></msup><mo id="alg1.l4.m1.10.10.10.10.6.6.11" xref="alg1.l4.m1.10.10.10.10.6.7.cmml">,</mo><mrow id="alg1.l4.m1.8.8.8.8.4.4.4" xref="alg1.l4.m1.8.8.8.8.4.4.4.cmml"><msup id="alg1.l4.m1.8.8.8.8.4.4.4.2" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.cmml"><mi id="alg1.l4.m1.8.8.8.8.4.4.4.2.2" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.2.cmml">y</mi><mrow id="alg1.l4.m1.8.8.8.8.4.4.4.2.3" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.3.cmml"><mi id="alg1.l4.m1.8.8.8.8.4.4.4.2.3.2" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.3.2.cmml">r</mi><mo id="alg1.l4.m1.8.8.8.8.4.4.4.2.3.1" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.8.8.8.8.4.4.4.2.3.3" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.3.3.cmml">e</mi><mo id="alg1.l4.m1.8.8.8.8.4.4.4.2.3.1a" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.8.8.8.8.4.4.4.2.3.4" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.3.4.cmml">c</mi></mrow></msup><mo id="alg1.l4.m1.8.8.8.8.4.4.4.1" xref="alg1.l4.m1.8.8.8.8.4.4.4.1.cmml">⁢</mo><msup id="alg1.l4.m1.8.8.8.8.4.4.4.3" xref="alg1.l4.m1.8.8.8.8.4.4.4.3.cmml"><mi id="alg1.l4.m1.8.8.8.8.4.4.4.3.2" xref="alg1.l4.m1.8.8.8.8.4.4.4.3.2.cmml">θ</mi><mn id="alg1.l4.m1.8.8.8.8.4.4.4.3.3" xref="alg1.l4.m1.8.8.8.8.4.4.4.3.3.cmml">1</mn></msup></mrow><mo id="alg1.l4.m1.10.10.10.10.6.6.12" xref="alg1.l4.m1.10.10.10.10.6.7.cmml">,</mo><msup id="alg1.l4.m1.9.9.9.9.5.5.5" xref="alg1.l4.m1.9.9.9.9.5.5.5.cmml"><mi id="alg1.l4.m1.9.9.9.9.5.5.5.2" xref="alg1.l4.m1.9.9.9.9.5.5.5.2.cmml">θ</mi><mn id="alg1.l4.m1.9.9.9.9.5.5.5.3" xref="alg1.l4.m1.9.9.9.9.5.5.5.3.cmml">2</mn></msup><mo id="alg1.l4.m1.10.10.10.10.6.6.13" xref="alg1.l4.m1.10.10.10.10.6.7.cmml">,</mo><mi id="alg1.l4.m1.4.4.4.4" mathvariant="normal" xref="alg1.l4.m1.4.4.4.4.cmml">…</mi><mo id="alg1.l4.m1.10.10.10.10.6.6.14" xref="alg1.l4.m1.10.10.10.10.6.7.cmml">,</mo><msup id="alg1.l4.m1.10.10.10.10.6.6.6" xref="alg1.l4.m1.10.10.10.10.6.6.6.cmml"><mi id="alg1.l4.m1.10.10.10.10.6.6.6.2" xref="alg1.l4.m1.10.10.10.10.6.6.6.2.cmml">θ</mi><mi id="alg1.l4.m1.10.10.10.10.6.6.6.3" xref="alg1.l4.m1.10.10.10.10.6.6.6.3.cmml">M</mi></msup><mo id="alg1.l4.m1.10.10.10.10.6.6.15" stretchy="false" xref="alg1.l4.m1.10.10.10.10.6.7.cmml">)</mo></mrow></mrow></mrow><mrow id="alg1.l4.m1.10.10.12" xref="alg1.l4.m1.10.10.12.cmml"><mo id="alg1.l4.m1.10.10.12.1" rspace="0em" xref="alg1.l4.m1.10.10.12.1.cmml">∂</mo><msub id="alg1.l4.m1.10.10.12.2" xref="alg1.l4.m1.10.10.12.2.cmml"><mtext class="ltx_mathvariant_italic" id="alg1.l4.m1.10.10.12.2.2" xref="alg1.l4.m1.10.10.12.2.2a.cmml">E</mtext><mrow id="alg1.l4.m1.10.10.12.2.3" xref="alg1.l4.m1.10.10.12.2.3.cmml"><mi id="alg1.l4.m1.10.10.12.2.3.2" xref="alg1.l4.m1.10.10.12.2.3.2.cmml">l</mi><mo id="alg1.l4.m1.10.10.12.2.3.1" xref="alg1.l4.m1.10.10.12.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.10.10.12.2.3.3" xref="alg1.l4.m1.10.10.12.2.3.3.cmml">a</mi><mo id="alg1.l4.m1.10.10.12.2.3.1a" xref="alg1.l4.m1.10.10.12.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.10.10.12.2.3.4" xref="alg1.l4.m1.10.10.12.2.3.4.cmml">t</mi><mo id="alg1.l4.m1.10.10.12.2.3.1b" xref="alg1.l4.m1.10.10.12.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.10.10.12.2.3.5" xref="alg1.l4.m1.10.10.12.2.3.5.cmml">e</mi><mo id="alg1.l4.m1.10.10.12.2.3.1c" xref="alg1.l4.m1.10.10.12.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.10.10.12.2.3.6" xref="alg1.l4.m1.10.10.12.2.3.6.cmml">n</mi><mo id="alg1.l4.m1.10.10.12.2.3.1d" xref="alg1.l4.m1.10.10.12.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.10.10.12.2.3.7" xref="alg1.l4.m1.10.10.12.2.3.7.cmml">t</mi></mrow></msub></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.10b"><apply id="alg1.l4.m1.10.11.cmml" xref="alg1.l4.m1.10.11"><eq id="alg1.l4.m1.10.11.1.cmml" xref="alg1.l4.m1.10.11.1"></eq><apply id="alg1.l4.m1.10.11.2.cmml" xref="alg1.l4.m1.10.11.2"><csymbol cd="ambiguous" id="alg1.l4.m1.10.11.2.1.cmml" xref="alg1.l4.m1.10.11.2">subscript</csymbol><ci id="alg1.l4.m1.10.11.2.2.cmml" xref="alg1.l4.m1.10.11.2.2">𝑔</ci><cn id="alg1.l4.m1.10.11.2.3.cmml" type="integer" xref="alg1.l4.m1.10.11.2.3">1</cn></apply><apply id="alg1.l4.m1.10.11.3.cmml" xref="alg1.l4.m1.10.11.3"><plus id="alg1.l4.m1.10.11.3.1.cmml" xref="alg1.l4.m1.10.11.3.1"></plus><apply id="alg1.l4.m1.10.11.3.2.cmml" xref="alg1.l4.m1.10.11.3.2"><csymbol cd="ambiguous" id="alg1.l4.m1.10.11.3.2.1.cmml" xref="alg1.l4.m1.10.11.3.2">subscript</csymbol><ci id="alg1.l4.m1.10.11.3.2.2.cmml" xref="alg1.l4.m1.10.11.3.2.2">𝑔</ci><cn id="alg1.l4.m1.10.11.3.2.3.cmml" type="integer" xref="alg1.l4.m1.10.11.3.2.3">1</cn></apply><apply id="alg1.l4.m1.10.10.cmml" xref="alg1.l4.m1.10.10"><divide id="alg1.l4.m1.10.10.11.cmml" xref="alg1.l4.m1.10.10"></divide><apply id="alg1.l4.m1.10.10.10.cmml" xref="alg1.l4.m1.10.10.10"><partialdiff id="alg1.l4.m1.10.10.10.11.cmml" xref="alg1.l4.m1.10.10.10.11"></partialdiff><apply id="alg1.l4.m1.10.10.10.10.cmml" xref="alg1.l4.m1.10.10.10.10"><times id="alg1.l4.m1.10.10.10.10.7.cmml" xref="alg1.l4.m1.10.10.10.10.7"></times><apply id="alg1.l4.m1.10.10.10.10.8.cmml" xref="alg1.l4.m1.10.10.10.10.8"><csymbol cd="ambiguous" id="alg1.l4.m1.10.10.10.10.8.1.cmml" xref="alg1.l4.m1.10.10.10.10.8">subscript</csymbol><apply id="alg1.l4.m1.10.10.10.10.8.2.cmml" xref="alg1.l4.m1.10.10.10.10.8"><csymbol cd="ambiguous" id="alg1.l4.m1.10.10.10.10.8.2.1.cmml" xref="alg1.l4.m1.10.10.10.10.8">superscript</csymbol><ci id="alg1.l4.m1.10.10.10.10.8.2.2.cmml" xref="alg1.l4.m1.10.10.10.10.8.2.2">ℓ</ci><apply id="alg1.l4.m1.10.10.10.10.8.2.3.cmml" xref="alg1.l4.m1.10.10.10.10.8.2.3"><times id="alg1.l4.m1.10.10.10.10.8.2.3.1.cmml" xref="alg1.l4.m1.10.10.10.10.8.2.3.1"></times><ci id="alg1.l4.m1.10.10.10.10.8.2.3.2.cmml" xref="alg1.l4.m1.10.10.10.10.8.2.3.2">𝑙</ci><ci id="alg1.l4.m1.10.10.10.10.8.2.3.3.cmml" xref="alg1.l4.m1.10.10.10.10.8.2.3.3">𝑙</ci><ci id="alg1.l4.m1.10.10.10.10.8.2.3.4.cmml" xref="alg1.l4.m1.10.10.10.10.8.2.3.4">𝑚</ci></apply></apply><list id="alg1.l4.m1.2.2.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.2.2.4"><ci id="alg1.l4.m1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1">𝑢</ci><ci id="alg1.l4.m1.2.2.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2.2.2">𝑖</ci></list></apply><vector id="alg1.l4.m1.10.10.10.10.6.7.cmml" xref="alg1.l4.m1.10.10.10.10.6.6"><apply id="alg1.l4.m1.5.5.5.5.1.1.1.cmml" xref="alg1.l4.m1.5.5.5.5.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.5.5.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.5.5.1.1.1">superscript</csymbol><ci id="alg1.l4.m1.5.5.5.5.1.1.1.2.cmml" xref="alg1.l4.m1.5.5.5.5.1.1.1.2">𝑥</ci><cn id="alg1.l4.m1.5.5.5.5.1.1.1.3.cmml" type="integer" xref="alg1.l4.m1.5.5.5.5.1.1.1.3">1</cn></apply><apply id="alg1.l4.m1.6.6.6.6.2.2.2.cmml" xref="alg1.l4.m1.6.6.6.6.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.6.6.2.2.2.1.cmml" xref="alg1.l4.m1.6.6.6.6.2.2.2">superscript</csymbol><ci id="alg1.l4.m1.6.6.6.6.2.2.2.2.cmml" xref="alg1.l4.m1.6.6.6.6.2.2.2.2">𝑥</ci><cn id="alg1.l4.m1.6.6.6.6.2.2.2.3.cmml" type="integer" xref="alg1.l4.m1.6.6.6.6.2.2.2.3">2</cn></apply><ci id="alg1.l4.m1.3.3.3.3.cmml" xref="alg1.l4.m1.3.3.3.3">…</ci><apply id="alg1.l4.m1.7.7.7.7.3.3.3.cmml" xref="alg1.l4.m1.7.7.7.7.3.3.3"><csymbol cd="ambiguous" id="alg1.l4.m1.7.7.7.7.3.3.3.1.cmml" xref="alg1.l4.m1.7.7.7.7.3.3.3">superscript</csymbol><ci id="alg1.l4.m1.7.7.7.7.3.3.3.2.cmml" xref="alg1.l4.m1.7.7.7.7.3.3.3.2">𝑥</ci><ci id="alg1.l4.m1.7.7.7.7.3.3.3.3.cmml" xref="alg1.l4.m1.7.7.7.7.3.3.3.3">𝑀</ci></apply><apply id="alg1.l4.m1.8.8.8.8.4.4.4.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4"><times id="alg1.l4.m1.8.8.8.8.4.4.4.1.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4.1"></times><apply id="alg1.l4.m1.8.8.8.8.4.4.4.2.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4.2"><csymbol cd="ambiguous" id="alg1.l4.m1.8.8.8.8.4.4.4.2.1.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4.2">superscript</csymbol><ci id="alg1.l4.m1.8.8.8.8.4.4.4.2.2.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.2">𝑦</ci><apply id="alg1.l4.m1.8.8.8.8.4.4.4.2.3.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.3"><times id="alg1.l4.m1.8.8.8.8.4.4.4.2.3.1.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.3.1"></times><ci id="alg1.l4.m1.8.8.8.8.4.4.4.2.3.2.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.3.2">𝑟</ci><ci id="alg1.l4.m1.8.8.8.8.4.4.4.2.3.3.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.3.3">𝑒</ci><ci id="alg1.l4.m1.8.8.8.8.4.4.4.2.3.4.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4.2.3.4">𝑐</ci></apply></apply><apply id="alg1.l4.m1.8.8.8.8.4.4.4.3.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4.3"><csymbol cd="ambiguous" id="alg1.l4.m1.8.8.8.8.4.4.4.3.1.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4.3">superscript</csymbol><ci id="alg1.l4.m1.8.8.8.8.4.4.4.3.2.cmml" xref="alg1.l4.m1.8.8.8.8.4.4.4.3.2">𝜃</ci><cn id="alg1.l4.m1.8.8.8.8.4.4.4.3.3.cmml" type="integer" xref="alg1.l4.m1.8.8.8.8.4.4.4.3.3">1</cn></apply></apply><apply id="alg1.l4.m1.9.9.9.9.5.5.5.cmml" xref="alg1.l4.m1.9.9.9.9.5.5.5"><csymbol cd="ambiguous" id="alg1.l4.m1.9.9.9.9.5.5.5.1.cmml" xref="alg1.l4.m1.9.9.9.9.5.5.5">superscript</csymbol><ci id="alg1.l4.m1.9.9.9.9.5.5.5.2.cmml" xref="alg1.l4.m1.9.9.9.9.5.5.5.2">𝜃</ci><cn id="alg1.l4.m1.9.9.9.9.5.5.5.3.cmml" type="integer" xref="alg1.l4.m1.9.9.9.9.5.5.5.3">2</cn></apply><ci id="alg1.l4.m1.4.4.4.4.cmml" xref="alg1.l4.m1.4.4.4.4">…</ci><apply id="alg1.l4.m1.10.10.10.10.6.6.6.cmml" xref="alg1.l4.m1.10.10.10.10.6.6.6"><csymbol cd="ambiguous" id="alg1.l4.m1.10.10.10.10.6.6.6.1.cmml" xref="alg1.l4.m1.10.10.10.10.6.6.6">superscript</csymbol><ci id="alg1.l4.m1.10.10.10.10.6.6.6.2.cmml" xref="alg1.l4.m1.10.10.10.10.6.6.6.2">𝜃</ci><ci id="alg1.l4.m1.10.10.10.10.6.6.6.3.cmml" xref="alg1.l4.m1.10.10.10.10.6.6.6.3">𝑀</ci></apply></vector></apply></apply><apply id="alg1.l4.m1.10.10.12.cmml" xref="alg1.l4.m1.10.10.12"><partialdiff id="alg1.l4.m1.10.10.12.1.cmml" xref="alg1.l4.m1.10.10.12.1"></partialdiff><apply id="alg1.l4.m1.10.10.12.2.cmml" xref="alg1.l4.m1.10.10.12.2"><csymbol cd="ambiguous" id="alg1.l4.m1.10.10.12.2.1.cmml" xref="alg1.l4.m1.10.10.12.2">subscript</csymbol><ci id="alg1.l4.m1.10.10.12.2.2a.cmml" xref="alg1.l4.m1.10.10.12.2.2"><mtext class="ltx_mathvariant_italic" id="alg1.l4.m1.10.10.12.2.2.cmml" mathsize="70%" xref="alg1.l4.m1.10.10.12.2.2">E</mtext></ci><apply id="alg1.l4.m1.10.10.12.2.3.cmml" xref="alg1.l4.m1.10.10.12.2.3"><times id="alg1.l4.m1.10.10.12.2.3.1.cmml" xref="alg1.l4.m1.10.10.12.2.3.1"></times><ci id="alg1.l4.m1.10.10.12.2.3.2.cmml" xref="alg1.l4.m1.10.10.12.2.3.2">𝑙</ci><ci id="alg1.l4.m1.10.10.12.2.3.3.cmml" xref="alg1.l4.m1.10.10.12.2.3.3">𝑎</ci><ci id="alg1.l4.m1.10.10.12.2.3.4.cmml" xref="alg1.l4.m1.10.10.12.2.3.4">𝑡</ci><ci id="alg1.l4.m1.10.10.12.2.3.5.cmml" xref="alg1.l4.m1.10.10.12.2.3.5">𝑒</ci><ci id="alg1.l4.m1.10.10.12.2.3.6.cmml" xref="alg1.l4.m1.10.10.12.2.3.6">𝑛</ci><ci id="alg1.l4.m1.10.10.12.2.3.7.cmml" xref="alg1.l4.m1.10.10.12.2.3.7">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.10c">g_{1}=g_{1}+\frac{\partial\ell^{llm}_{u,i}(x^{1},x^{2},...,x^{M},y^{rec}\theta%
^{1},\theta^{2},...,\theta^{M})}{\partial\textit{E}_{latent}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.10d">italic_g start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_g start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + divide start_ARG ∂ roman_ℓ start_POSTSUPERSCRIPT italic_l italic_l italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_x start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT italic_r italic_e italic_c end_POSTSUPERSCRIPT italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT ) end_ARG start_ARG ∂ E start_POSTSUBSCRIPT italic_l italic_a italic_t italic_e italic_n italic_t end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> based on Eq. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.E4" title="In 2.3. UserIP Inference Module ‣ 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">4</span></a>.

</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>        Calculate the nearest neighbor indices for profiles <math alttext="c_{1}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">c</mi><mn id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑐</ci><cn id="alg1.l5.m1.1.1.3.cmml" type="integer" xref="alg1.l5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">c_{1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, …, <math alttext="c_{M}" class="ltx_Math" display="inline" id="alg1.l5.m2.1"><semantics id="alg1.l5.m2.1a"><msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">c</mi><mi id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝑐</ci><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">c_{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">italic_c start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> via Eq. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.E6" title="In 2.4. UserIP Quantization Module ‣ 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">6</span></a> and update gradient <math alttext="g_{2}=g_{2}+\frac{\partial\ell^{vec}_{u,i}(\textit{E}_{latent},v_{k}^{m})}{%
\partial\boldsymbol{v}^{m}_{k}}" class="ltx_Math" display="inline" id="alg1.l5.m3.4"><semantics id="alg1.l5.m3.4a"><mrow id="alg1.l5.m3.4.5" xref="alg1.l5.m3.4.5.cmml"><msub id="alg1.l5.m3.4.5.2" xref="alg1.l5.m3.4.5.2.cmml"><mi id="alg1.l5.m3.4.5.2.2" xref="alg1.l5.m3.4.5.2.2.cmml">g</mi><mn id="alg1.l5.m3.4.5.2.3" xref="alg1.l5.m3.4.5.2.3.cmml">2</mn></msub><mo id="alg1.l5.m3.4.5.1" xref="alg1.l5.m3.4.5.1.cmml">=</mo><mrow id="alg1.l5.m3.4.5.3" xref="alg1.l5.m3.4.5.3.cmml"><msub id="alg1.l5.m3.4.5.3.2" xref="alg1.l5.m3.4.5.3.2.cmml"><mi id="alg1.l5.m3.4.5.3.2.2" xref="alg1.l5.m3.4.5.3.2.2.cmml">g</mi><mn id="alg1.l5.m3.4.5.3.2.3" xref="alg1.l5.m3.4.5.3.2.3.cmml">2</mn></msub><mo id="alg1.l5.m3.4.5.3.1" xref="alg1.l5.m3.4.5.3.1.cmml">+</mo><mfrac id="alg1.l5.m3.4.4" xref="alg1.l5.m3.4.4.cmml"><mrow id="alg1.l5.m3.4.4.4" xref="alg1.l5.m3.4.4.4.cmml"><mo id="alg1.l5.m3.4.4.4.5" rspace="0em" xref="alg1.l5.m3.4.4.4.5.cmml">∂</mo><mrow id="alg1.l5.m3.4.4.4.4" xref="alg1.l5.m3.4.4.4.4.cmml"><msubsup id="alg1.l5.m3.4.4.4.4.4" xref="alg1.l5.m3.4.4.4.4.4.cmml"><mi id="alg1.l5.m3.4.4.4.4.4.2.2" mathvariant="normal" xref="alg1.l5.m3.4.4.4.4.4.2.2.cmml">ℓ</mi><mrow id="alg1.l5.m3.2.2.2.2.2.4" xref="alg1.l5.m3.2.2.2.2.2.3.cmml"><mi id="alg1.l5.m3.1.1.1.1.1.1" xref="alg1.l5.m3.1.1.1.1.1.1.cmml">u</mi><mo id="alg1.l5.m3.2.2.2.2.2.4.1" xref="alg1.l5.m3.2.2.2.2.2.3.cmml">,</mo><mi id="alg1.l5.m3.2.2.2.2.2.2" xref="alg1.l5.m3.2.2.2.2.2.2.cmml">i</mi></mrow><mrow id="alg1.l5.m3.4.4.4.4.4.2.3" xref="alg1.l5.m3.4.4.4.4.4.2.3.cmml"><mi id="alg1.l5.m3.4.4.4.4.4.2.3.2" xref="alg1.l5.m3.4.4.4.4.4.2.3.2.cmml">v</mi><mo id="alg1.l5.m3.4.4.4.4.4.2.3.1" xref="alg1.l5.m3.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="alg1.l5.m3.4.4.4.4.4.2.3.3" xref="alg1.l5.m3.4.4.4.4.4.2.3.3.cmml">e</mi><mo id="alg1.l5.m3.4.4.4.4.4.2.3.1a" xref="alg1.l5.m3.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="alg1.l5.m3.4.4.4.4.4.2.3.4" xref="alg1.l5.m3.4.4.4.4.4.2.3.4.cmml">c</mi></mrow></msubsup><mo id="alg1.l5.m3.4.4.4.4.3" xref="alg1.l5.m3.4.4.4.4.3.cmml">⁢</mo><mrow id="alg1.l5.m3.4.4.4.4.2.2" xref="alg1.l5.m3.4.4.4.4.2.3.cmml"><mo id="alg1.l5.m3.4.4.4.4.2.2.3" stretchy="false" xref="alg1.l5.m3.4.4.4.4.2.3.cmml">(</mo><msub id="alg1.l5.m3.3.3.3.3.1.1.1" xref="alg1.l5.m3.3.3.3.3.1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="alg1.l5.m3.3.3.3.3.1.1.1.2" xref="alg1.l5.m3.3.3.3.3.1.1.1.2a.cmml">E</mtext><mrow id="alg1.l5.m3.3.3.3.3.1.1.1.3" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.cmml"><mi id="alg1.l5.m3.3.3.3.3.1.1.1.3.2" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.2.cmml">l</mi><mo id="alg1.l5.m3.3.3.3.3.1.1.1.3.1" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m3.3.3.3.3.1.1.1.3.3" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.3.cmml">a</mi><mo id="alg1.l5.m3.3.3.3.3.1.1.1.3.1a" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m3.3.3.3.3.1.1.1.3.4" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.4.cmml">t</mi><mo id="alg1.l5.m3.3.3.3.3.1.1.1.3.1b" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m3.3.3.3.3.1.1.1.3.5" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.5.cmml">e</mi><mo id="alg1.l5.m3.3.3.3.3.1.1.1.3.1c" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m3.3.3.3.3.1.1.1.3.6" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.6.cmml">n</mi><mo id="alg1.l5.m3.3.3.3.3.1.1.1.3.1d" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m3.3.3.3.3.1.1.1.3.7" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l5.m3.4.4.4.4.2.2.4" xref="alg1.l5.m3.4.4.4.4.2.3.cmml">,</mo><msubsup id="alg1.l5.m3.4.4.4.4.2.2.2" xref="alg1.l5.m3.4.4.4.4.2.2.2.cmml"><mi id="alg1.l5.m3.4.4.4.4.2.2.2.2.2" xref="alg1.l5.m3.4.4.4.4.2.2.2.2.2.cmml">v</mi><mi id="alg1.l5.m3.4.4.4.4.2.2.2.2.3" xref="alg1.l5.m3.4.4.4.4.2.2.2.2.3.cmml">k</mi><mi id="alg1.l5.m3.4.4.4.4.2.2.2.3" xref="alg1.l5.m3.4.4.4.4.2.2.2.3.cmml">m</mi></msubsup><mo id="alg1.l5.m3.4.4.4.4.2.2.5" stretchy="false" xref="alg1.l5.m3.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><mrow id="alg1.l5.m3.4.4.6" xref="alg1.l5.m3.4.4.6.cmml"><mo id="alg1.l5.m3.4.4.6.1" rspace="0em" xref="alg1.l5.m3.4.4.6.1.cmml">∂</mo><msubsup id="alg1.l5.m3.4.4.6.2" xref="alg1.l5.m3.4.4.6.2.cmml"><mi id="alg1.l5.m3.4.4.6.2.2.2" xref="alg1.l5.m3.4.4.6.2.2.2.cmml">𝒗</mi><mi id="alg1.l5.m3.4.4.6.2.3" xref="alg1.l5.m3.4.4.6.2.3.cmml">k</mi><mi id="alg1.l5.m3.4.4.6.2.2.3" xref="alg1.l5.m3.4.4.6.2.2.3.cmml">m</mi></msubsup></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.4b"><apply id="alg1.l5.m3.4.5.cmml" xref="alg1.l5.m3.4.5"><eq id="alg1.l5.m3.4.5.1.cmml" xref="alg1.l5.m3.4.5.1"></eq><apply id="alg1.l5.m3.4.5.2.cmml" xref="alg1.l5.m3.4.5.2"><csymbol cd="ambiguous" id="alg1.l5.m3.4.5.2.1.cmml" xref="alg1.l5.m3.4.5.2">subscript</csymbol><ci id="alg1.l5.m3.4.5.2.2.cmml" xref="alg1.l5.m3.4.5.2.2">𝑔</ci><cn id="alg1.l5.m3.4.5.2.3.cmml" type="integer" xref="alg1.l5.m3.4.5.2.3">2</cn></apply><apply id="alg1.l5.m3.4.5.3.cmml" xref="alg1.l5.m3.4.5.3"><plus id="alg1.l5.m3.4.5.3.1.cmml" xref="alg1.l5.m3.4.5.3.1"></plus><apply id="alg1.l5.m3.4.5.3.2.cmml" xref="alg1.l5.m3.4.5.3.2"><csymbol cd="ambiguous" id="alg1.l5.m3.4.5.3.2.1.cmml" xref="alg1.l5.m3.4.5.3.2">subscript</csymbol><ci id="alg1.l5.m3.4.5.3.2.2.cmml" xref="alg1.l5.m3.4.5.3.2.2">𝑔</ci><cn id="alg1.l5.m3.4.5.3.2.3.cmml" type="integer" xref="alg1.l5.m3.4.5.3.2.3">2</cn></apply><apply id="alg1.l5.m3.4.4.cmml" xref="alg1.l5.m3.4.4"><divide id="alg1.l5.m3.4.4.5.cmml" xref="alg1.l5.m3.4.4"></divide><apply id="alg1.l5.m3.4.4.4.cmml" xref="alg1.l5.m3.4.4.4"><partialdiff id="alg1.l5.m3.4.4.4.5.cmml" xref="alg1.l5.m3.4.4.4.5"></partialdiff><apply id="alg1.l5.m3.4.4.4.4.cmml" xref="alg1.l5.m3.4.4.4.4"><times id="alg1.l5.m3.4.4.4.4.3.cmml" xref="alg1.l5.m3.4.4.4.4.3"></times><apply id="alg1.l5.m3.4.4.4.4.4.cmml" xref="alg1.l5.m3.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l5.m3.4.4.4.4.4.1.cmml" xref="alg1.l5.m3.4.4.4.4.4">subscript</csymbol><apply id="alg1.l5.m3.4.4.4.4.4.2.cmml" xref="alg1.l5.m3.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l5.m3.4.4.4.4.4.2.1.cmml" xref="alg1.l5.m3.4.4.4.4.4">superscript</csymbol><ci id="alg1.l5.m3.4.4.4.4.4.2.2.cmml" xref="alg1.l5.m3.4.4.4.4.4.2.2">ℓ</ci><apply id="alg1.l5.m3.4.4.4.4.4.2.3.cmml" xref="alg1.l5.m3.4.4.4.4.4.2.3"><times id="alg1.l5.m3.4.4.4.4.4.2.3.1.cmml" xref="alg1.l5.m3.4.4.4.4.4.2.3.1"></times><ci id="alg1.l5.m3.4.4.4.4.4.2.3.2.cmml" xref="alg1.l5.m3.4.4.4.4.4.2.3.2">𝑣</ci><ci id="alg1.l5.m3.4.4.4.4.4.2.3.3.cmml" xref="alg1.l5.m3.4.4.4.4.4.2.3.3">𝑒</ci><ci id="alg1.l5.m3.4.4.4.4.4.2.3.4.cmml" xref="alg1.l5.m3.4.4.4.4.4.2.3.4">𝑐</ci></apply></apply><list id="alg1.l5.m3.2.2.2.2.2.3.cmml" xref="alg1.l5.m3.2.2.2.2.2.4"><ci id="alg1.l5.m3.1.1.1.1.1.1.cmml" xref="alg1.l5.m3.1.1.1.1.1.1">𝑢</ci><ci id="alg1.l5.m3.2.2.2.2.2.2.cmml" xref="alg1.l5.m3.2.2.2.2.2.2">𝑖</ci></list></apply><interval closure="open" id="alg1.l5.m3.4.4.4.4.2.3.cmml" xref="alg1.l5.m3.4.4.4.4.2.2"><apply id="alg1.l5.m3.3.3.3.3.1.1.1.cmml" xref="alg1.l5.m3.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m3.3.3.3.3.1.1.1.1.cmml" xref="alg1.l5.m3.3.3.3.3.1.1.1">subscript</csymbol><ci id="alg1.l5.m3.3.3.3.3.1.1.1.2a.cmml" xref="alg1.l5.m3.3.3.3.3.1.1.1.2"><mtext class="ltx_mathvariant_italic" id="alg1.l5.m3.3.3.3.3.1.1.1.2.cmml" mathsize="70%" xref="alg1.l5.m3.3.3.3.3.1.1.1.2">E</mtext></ci><apply id="alg1.l5.m3.3.3.3.3.1.1.1.3.cmml" xref="alg1.l5.m3.3.3.3.3.1.1.1.3"><times id="alg1.l5.m3.3.3.3.3.1.1.1.3.1.cmml" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.1"></times><ci id="alg1.l5.m3.3.3.3.3.1.1.1.3.2.cmml" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.2">𝑙</ci><ci id="alg1.l5.m3.3.3.3.3.1.1.1.3.3.cmml" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.3">𝑎</ci><ci id="alg1.l5.m3.3.3.3.3.1.1.1.3.4.cmml" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.4">𝑡</ci><ci id="alg1.l5.m3.3.3.3.3.1.1.1.3.5.cmml" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.5">𝑒</ci><ci id="alg1.l5.m3.3.3.3.3.1.1.1.3.6.cmml" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.6">𝑛</ci><ci id="alg1.l5.m3.3.3.3.3.1.1.1.3.7.cmml" xref="alg1.l5.m3.3.3.3.3.1.1.1.3.7">𝑡</ci></apply></apply><apply id="alg1.l5.m3.4.4.4.4.2.2.2.cmml" xref="alg1.l5.m3.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m3.4.4.4.4.2.2.2.1.cmml" xref="alg1.l5.m3.4.4.4.4.2.2.2">superscript</csymbol><apply id="alg1.l5.m3.4.4.4.4.2.2.2.2.cmml" xref="alg1.l5.m3.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m3.4.4.4.4.2.2.2.2.1.cmml" xref="alg1.l5.m3.4.4.4.4.2.2.2">subscript</csymbol><ci id="alg1.l5.m3.4.4.4.4.2.2.2.2.2.cmml" xref="alg1.l5.m3.4.4.4.4.2.2.2.2.2">𝑣</ci><ci id="alg1.l5.m3.4.4.4.4.2.2.2.2.3.cmml" xref="alg1.l5.m3.4.4.4.4.2.2.2.2.3">𝑘</ci></apply><ci id="alg1.l5.m3.4.4.4.4.2.2.2.3.cmml" xref="alg1.l5.m3.4.4.4.4.2.2.2.3">𝑚</ci></apply></interval></apply></apply><apply id="alg1.l5.m3.4.4.6.cmml" xref="alg1.l5.m3.4.4.6"><partialdiff id="alg1.l5.m3.4.4.6.1.cmml" xref="alg1.l5.m3.4.4.6.1"></partialdiff><apply id="alg1.l5.m3.4.4.6.2.cmml" xref="alg1.l5.m3.4.4.6.2"><csymbol cd="ambiguous" id="alg1.l5.m3.4.4.6.2.1.cmml" xref="alg1.l5.m3.4.4.6.2">subscript</csymbol><apply id="alg1.l5.m3.4.4.6.2.2.cmml" xref="alg1.l5.m3.4.4.6.2"><csymbol cd="ambiguous" id="alg1.l5.m3.4.4.6.2.2.1.cmml" xref="alg1.l5.m3.4.4.6.2">superscript</csymbol><ci id="alg1.l5.m3.4.4.6.2.2.2.cmml" xref="alg1.l5.m3.4.4.6.2.2.2">𝒗</ci><ci id="alg1.l5.m3.4.4.6.2.2.3.cmml" xref="alg1.l5.m3.4.4.6.2.2.3">𝑚</ci></apply><ci id="alg1.l5.m3.4.4.6.2.3.cmml" xref="alg1.l5.m3.4.4.6.2.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.4c">g_{2}=g_{2}+\frac{\partial\ell^{vec}_{u,i}(\textit{E}_{latent},v_{k}^{m})}{%
\partial\boldsymbol{v}^{m}_{k}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m3.4d">italic_g start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_g start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + divide start_ARG ∂ roman_ℓ start_POSTSUPERSCRIPT italic_v italic_e italic_c end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT ( E start_POSTSUBSCRIPT italic_l italic_a italic_t italic_e italic_n italic_t end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ) end_ARG start_ARG ∂ bold_italic_v start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> based on Eq. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S2.E5" title="In 2.4. UserIP Quantization Module ‣ 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">5</span></a>.

</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>        Update the latent variables <math alttext="\textit{E}_{latent}=\textit{E}_{latent}-\alpha(g_{1}+g_{2})" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msub id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mtext class="ltx_mathvariant_italic" id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2a.cmml">E</mtext><mrow id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml"><mi id="alg1.l6.m1.1.1.3.3.2" xref="alg1.l6.m1.1.1.3.3.2.cmml">l</mi><mo id="alg1.l6.m1.1.1.3.3.1" xref="alg1.l6.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.3.3.3" xref="alg1.l6.m1.1.1.3.3.3.cmml">a</mi><mo id="alg1.l6.m1.1.1.3.3.1a" xref="alg1.l6.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.3.3.4" xref="alg1.l6.m1.1.1.3.3.4.cmml">t</mi><mo id="alg1.l6.m1.1.1.3.3.1b" xref="alg1.l6.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.3.3.5" xref="alg1.l6.m1.1.1.3.3.5.cmml">e</mi><mo id="alg1.l6.m1.1.1.3.3.1c" xref="alg1.l6.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.3.3.6" xref="alg1.l6.m1.1.1.3.3.6.cmml">n</mi><mo id="alg1.l6.m1.1.1.3.3.1d" xref="alg1.l6.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.3.3.7" xref="alg1.l6.m1.1.1.3.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">=</mo><mrow id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml"><msub id="alg1.l6.m1.1.1.1.3" xref="alg1.l6.m1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_italic" id="alg1.l6.m1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.3.2a.cmml">E</mtext><mrow id="alg1.l6.m1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.3.3.cmml"><mi id="alg1.l6.m1.1.1.1.3.3.2" xref="alg1.l6.m1.1.1.1.3.3.2.cmml">l</mi><mo id="alg1.l6.m1.1.1.1.3.3.1" xref="alg1.l6.m1.1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.1.3.3.3" xref="alg1.l6.m1.1.1.1.3.3.3.cmml">a</mi><mo id="alg1.l6.m1.1.1.1.3.3.1a" xref="alg1.l6.m1.1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.1.3.3.4" xref="alg1.l6.m1.1.1.1.3.3.4.cmml">t</mi><mo id="alg1.l6.m1.1.1.1.3.3.1b" xref="alg1.l6.m1.1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.1.3.3.5" xref="alg1.l6.m1.1.1.1.3.3.5.cmml">e</mi><mo id="alg1.l6.m1.1.1.1.3.3.1c" xref="alg1.l6.m1.1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.1.3.3.6" xref="alg1.l6.m1.1.1.1.3.3.6.cmml">n</mi><mo id="alg1.l6.m1.1.1.1.3.3.1d" xref="alg1.l6.m1.1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.1.1.3.3.7" xref="alg1.l6.m1.1.1.1.3.3.7.cmml">t</mi></mrow></msub><mo id="alg1.l6.m1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.3.cmml">α</mi><mo id="alg1.l6.m1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l6.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l6.m1.1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.2.cmml">g</mi><mn id="alg1.l6.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="alg1.l6.m1.1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="alg1.l6.m1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.3.2.cmml">g</mi><mn id="alg1.l6.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="alg1.l6.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><eq id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"></eq><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2a.cmml" xref="alg1.l6.m1.1.1.3.2"><mtext class="ltx_mathvariant_italic" id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">E</mtext></ci><apply id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3"><times id="alg1.l6.m1.1.1.3.3.1.cmml" xref="alg1.l6.m1.1.1.3.3.1"></times><ci id="alg1.l6.m1.1.1.3.3.2.cmml" xref="alg1.l6.m1.1.1.3.3.2">𝑙</ci><ci id="alg1.l6.m1.1.1.3.3.3.cmml" xref="alg1.l6.m1.1.1.3.3.3">𝑎</ci><ci id="alg1.l6.m1.1.1.3.3.4.cmml" xref="alg1.l6.m1.1.1.3.3.4">𝑡</ci><ci id="alg1.l6.m1.1.1.3.3.5.cmml" xref="alg1.l6.m1.1.1.3.3.5">𝑒</ci><ci id="alg1.l6.m1.1.1.3.3.6.cmml" xref="alg1.l6.m1.1.1.3.3.6">𝑛</ci><ci id="alg1.l6.m1.1.1.3.3.7.cmml" xref="alg1.l6.m1.1.1.3.3.7">𝑡</ci></apply></apply><apply id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"><minus id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.2"></minus><apply id="alg1.l6.m1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.3.2a.cmml" xref="alg1.l6.m1.1.1.1.3.2"><mtext class="ltx_mathvariant_italic" id="alg1.l6.m1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.3.2">E</mtext></ci><apply id="alg1.l6.m1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.3.3"><times id="alg1.l6.m1.1.1.1.3.3.1.cmml" xref="alg1.l6.m1.1.1.1.3.3.1"></times><ci id="alg1.l6.m1.1.1.1.3.3.2.cmml" xref="alg1.l6.m1.1.1.1.3.3.2">𝑙</ci><ci id="alg1.l6.m1.1.1.1.3.3.3.cmml" xref="alg1.l6.m1.1.1.1.3.3.3">𝑎</ci><ci id="alg1.l6.m1.1.1.1.3.3.4.cmml" xref="alg1.l6.m1.1.1.1.3.3.4">𝑡</ci><ci id="alg1.l6.m1.1.1.1.3.3.5.cmml" xref="alg1.l6.m1.1.1.1.3.3.5">𝑒</ci><ci id="alg1.l6.m1.1.1.1.3.3.6.cmml" xref="alg1.l6.m1.1.1.1.3.3.6">𝑛</ci><ci id="alg1.l6.m1.1.1.1.3.3.7.cmml" xref="alg1.l6.m1.1.1.1.3.3.7">𝑡</ci></apply></apply><apply id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1"><times id="alg1.l6.m1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.2"></times><ci id="alg1.l6.m1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.3">𝛼</ci><apply id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><plus id="alg1.l6.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1"></plus><apply id="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.2">𝑔</ci><cn id="alg1.l6.m1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.3.2">𝑔</ci><cn id="alg1.l6.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l6.m1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\textit{E}_{latent}=\textit{E}_{latent}-\alpha(g_{1}+g_{2})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">E start_POSTSUBSCRIPT italic_l italic_a italic_t italic_e italic_n italic_t end_POSTSUBSCRIPT = E start_POSTSUBSCRIPT italic_l italic_a italic_t italic_e italic_n italic_t end_POSTSUBSCRIPT - italic_α ( italic_g start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_g start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>        Update the quantization codebook <math alttext="\boldsymbol{v}^{m}_{k}=\boldsymbol{v}^{m}_{k}-\alpha g_{2}" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msubsup id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2.2" xref="alg1.l7.m1.1.1.2.2.2.cmml">𝒗</mi><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">k</mi><mi id="alg1.l7.m1.1.1.2.2.3" xref="alg1.l7.m1.1.1.2.2.3.cmml">m</mi></msubsup><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">=</mo><mrow id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><msubsup id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml"><mi id="alg1.l7.m1.1.1.3.2.2.2" xref="alg1.l7.m1.1.1.3.2.2.2.cmml">𝒗</mi><mi id="alg1.l7.m1.1.1.3.2.3" xref="alg1.l7.m1.1.1.3.2.3.cmml">k</mi><mi id="alg1.l7.m1.1.1.3.2.2.3" xref="alg1.l7.m1.1.1.3.2.2.3.cmml">m</mi></msubsup><mo id="alg1.l7.m1.1.1.3.1" xref="alg1.l7.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml"><mi id="alg1.l7.m1.1.1.3.3.2" xref="alg1.l7.m1.1.1.3.3.2.cmml">α</mi><mo id="alg1.l7.m1.1.1.3.3.1" xref="alg1.l7.m1.1.1.3.3.1.cmml">⁢</mo><msub id="alg1.l7.m1.1.1.3.3.3" xref="alg1.l7.m1.1.1.3.3.3.cmml"><mi id="alg1.l7.m1.1.1.3.3.3.2" xref="alg1.l7.m1.1.1.3.3.3.2.cmml">g</mi><mn id="alg1.l7.m1.1.1.3.3.3.3" xref="alg1.l7.m1.1.1.3.3.3.3.cmml">2</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><eq id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></eq><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><apply id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.2.1.cmml" xref="alg1.l7.m1.1.1.2">superscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.2.cmml" xref="alg1.l7.m1.1.1.2.2.2">𝒗</ci><ci id="alg1.l7.m1.1.1.2.2.3.cmml" xref="alg1.l7.m1.1.1.2.2.3">𝑚</ci></apply><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><minus id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3.1"></minus><apply id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.2.1.cmml" xref="alg1.l7.m1.1.1.3.2">subscript</csymbol><apply id="alg1.l7.m1.1.1.3.2.2.cmml" xref="alg1.l7.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.2.2.1.cmml" xref="alg1.l7.m1.1.1.3.2">superscript</csymbol><ci id="alg1.l7.m1.1.1.3.2.2.2.cmml" xref="alg1.l7.m1.1.1.3.2.2.2">𝒗</ci><ci id="alg1.l7.m1.1.1.3.2.2.3.cmml" xref="alg1.l7.m1.1.1.3.2.2.3">𝑚</ci></apply><ci id="alg1.l7.m1.1.1.3.2.3.cmml" xref="alg1.l7.m1.1.1.3.2.3">𝑘</ci></apply><apply id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3"><times id="alg1.l7.m1.1.1.3.3.1.cmml" xref="alg1.l7.m1.1.1.3.3.1"></times><ci id="alg1.l7.m1.1.1.3.3.2.cmml" xref="alg1.l7.m1.1.1.3.3.2">𝛼</ci><apply id="alg1.l7.m1.1.1.3.3.3.cmml" xref="alg1.l7.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.3.3.1.cmml" xref="alg1.l7.m1.1.1.3.3.3">subscript</csymbol><ci id="alg1.l7.m1.1.1.3.3.3.2.cmml" xref="alg1.l7.m1.1.1.3.3.3.2">𝑔</ci><cn id="alg1.l7.m1.1.1.3.3.3.3.cmml" type="integer" xref="alg1.l7.m1.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\boldsymbol{v}^{m}_{k}=\boldsymbol{v}^{m}_{k}-\alpha g_{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">bold_italic_v start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = bold_italic_v start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - italic_α italic_g start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l8.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l8.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l9.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l9.3">while</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l10.2">return</span>  Latent profile indices for downstream recommender.

</div>
</div>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.6. </span>Optimization Process</h3>
<div class="ltx_para" id="S2.SS6.p1">
<p class="ltx_p" id="S2.SS6.p1.3">The optimization process is formulated in the Algorithm  <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#alg1" title="Algorithm 1 ‣ 2.5. UserIP Feature Bank and Downstream Recommender model ‣ 2. Framework ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">1</span></a>. Specifically, in each iteration, randomly sample a mini-batch examples of user-item interaction records and profile names (line 1-2); then, for each data point, update the gradient of profile embedding based on language loss <math alttext="\ell^{llm}" class="ltx_Math" display="inline" id="S2.SS6.p1.1.m1.1"><semantics id="S2.SS6.p1.1.m1.1a"><msup id="S2.SS6.p1.1.m1.1.1" xref="S2.SS6.p1.1.m1.1.1.cmml"><mi id="S2.SS6.p1.1.m1.1.1.2" mathvariant="normal" xref="S2.SS6.p1.1.m1.1.1.2.cmml">ℓ</mi><mrow id="S2.SS6.p1.1.m1.1.1.3" xref="S2.SS6.p1.1.m1.1.1.3.cmml"><mi id="S2.SS6.p1.1.m1.1.1.3.2" xref="S2.SS6.p1.1.m1.1.1.3.2.cmml">l</mi><mo id="S2.SS6.p1.1.m1.1.1.3.1" xref="S2.SS6.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS6.p1.1.m1.1.1.3.3" xref="S2.SS6.p1.1.m1.1.1.3.3.cmml">l</mi><mo id="S2.SS6.p1.1.m1.1.1.3.1a" xref="S2.SS6.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS6.p1.1.m1.1.1.3.4" xref="S2.SS6.p1.1.m1.1.1.3.4.cmml">m</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.1.m1.1b"><apply id="S2.SS6.p1.1.m1.1.1.cmml" xref="S2.SS6.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS6.p1.1.m1.1.1.1.cmml" xref="S2.SS6.p1.1.m1.1.1">superscript</csymbol><ci id="S2.SS6.p1.1.m1.1.1.2.cmml" xref="S2.SS6.p1.1.m1.1.1.2">ℓ</ci><apply id="S2.SS6.p1.1.m1.1.1.3.cmml" xref="S2.SS6.p1.1.m1.1.1.3"><times id="S2.SS6.p1.1.m1.1.1.3.1.cmml" xref="S2.SS6.p1.1.m1.1.1.3.1"></times><ci id="S2.SS6.p1.1.m1.1.1.3.2.cmml" xref="S2.SS6.p1.1.m1.1.1.3.2">𝑙</ci><ci id="S2.SS6.p1.1.m1.1.1.3.3.cmml" xref="S2.SS6.p1.1.m1.1.1.3.3">𝑙</ci><ci id="S2.SS6.p1.1.m1.1.1.3.4.cmml" xref="S2.SS6.p1.1.m1.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.1.m1.1c">\ell^{llm}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.1.m1.1d">roman_ℓ start_POSTSUPERSCRIPT italic_l italic_l italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> (line 3-4); next, calculate the nearest indices <math alttext="c_{m}" class="ltx_Math" display="inline" id="S2.SS6.p1.2.m2.1"><semantics id="S2.SS6.p1.2.m2.1a"><msub id="S2.SS6.p1.2.m2.1.1" xref="S2.SS6.p1.2.m2.1.1.cmml"><mi id="S2.SS6.p1.2.m2.1.1.2" xref="S2.SS6.p1.2.m2.1.1.2.cmml">c</mi><mi id="S2.SS6.p1.2.m2.1.1.3" xref="S2.SS6.p1.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.2.m2.1b"><apply id="S2.SS6.p1.2.m2.1.1.cmml" xref="S2.SS6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS6.p1.2.m2.1.1.1.cmml" xref="S2.SS6.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS6.p1.2.m2.1.1.2.cmml" xref="S2.SS6.p1.2.m2.1.1.2">𝑐</ci><ci id="S2.SS6.p1.2.m2.1.1.3.cmml" xref="S2.SS6.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.2.m2.1c">c_{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.2.m2.1d">italic_c start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> for each inferred profile embedding and update the gradient of the codebook and accumulate profile embedding gradient based on quantization loss <math alttext="\ell^{vec}" class="ltx_Math" display="inline" id="S2.SS6.p1.3.m3.1"><semantics id="S2.SS6.p1.3.m3.1a"><msup id="S2.SS6.p1.3.m3.1.1" xref="S2.SS6.p1.3.m3.1.1.cmml"><mi id="S2.SS6.p1.3.m3.1.1.2" mathvariant="normal" xref="S2.SS6.p1.3.m3.1.1.2.cmml">ℓ</mi><mrow id="S2.SS6.p1.3.m3.1.1.3" xref="S2.SS6.p1.3.m3.1.1.3.cmml"><mi id="S2.SS6.p1.3.m3.1.1.3.2" xref="S2.SS6.p1.3.m3.1.1.3.2.cmml">v</mi><mo id="S2.SS6.p1.3.m3.1.1.3.1" xref="S2.SS6.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS6.p1.3.m3.1.1.3.3" xref="S2.SS6.p1.3.m3.1.1.3.3.cmml">e</mi><mo id="S2.SS6.p1.3.m3.1.1.3.1a" xref="S2.SS6.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS6.p1.3.m3.1.1.3.4" xref="S2.SS6.p1.3.m3.1.1.3.4.cmml">c</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.3.m3.1b"><apply id="S2.SS6.p1.3.m3.1.1.cmml" xref="S2.SS6.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS6.p1.3.m3.1.1.1.cmml" xref="S2.SS6.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS6.p1.3.m3.1.1.2.cmml" xref="S2.SS6.p1.3.m3.1.1.2">ℓ</ci><apply id="S2.SS6.p1.3.m3.1.1.3.cmml" xref="S2.SS6.p1.3.m3.1.1.3"><times id="S2.SS6.p1.3.m3.1.1.3.1.cmml" xref="S2.SS6.p1.3.m3.1.1.3.1"></times><ci id="S2.SS6.p1.3.m3.1.1.3.2.cmml" xref="S2.SS6.p1.3.m3.1.1.3.2">𝑣</ci><ci id="S2.SS6.p1.3.m3.1.1.3.3.cmml" xref="S2.SS6.p1.3.m3.1.1.3.3">𝑒</ci><ci id="S2.SS6.p1.3.m3.1.1.3.4.cmml" xref="S2.SS6.p1.3.m3.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.3.m3.1c">\ell^{vec}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.3.m3.1d">roman_ℓ start_POSTSUPERSCRIPT italic_v italic_e italic_c end_POSTSUPERSCRIPT</annotation></semantics></math> (line 5); finally, update the profile embedding and codebook (line 6-7).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Experiment</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, extensive experiments are carried out using various datasets to examine the effectiveness of UserIP-Tuning. We first compare UserIP-Tuning with the advanced benchmarks, then conduct model component, hyper-parameter. The following research questions are solved:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1">RQ1: How is the performance of UserIP-Tuning compared with advanced baselines in recommendation tasks?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1">RQ2: How is the performance of UserIP-Tuning with different recommenders in the downstream recommender systems?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1">RQ3: Does the number of codebook size in vector quantization for different profiles affect UserIP-Tuning’s performance? How does quantization module influence the UserIP-Tuning?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.1">RQ4: Are the latent profiles variables from UserIP-Tuning explainable and controllable in practice?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i5.p1">
<p class="ltx_p" id="S3.I1.i5.p1.1">RQ5: How is the performance of UserIP-Tuning on industrial application scenario? How efficient is UserIP-Tuning on inference?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Datasets</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Our model is evaluated on four real-world open datasets, including Amazon Clothing Shoes and Jewelry, Movies and TV, Video Games, and Yelp. For simplicity, we use Clothing, Movies, and Games to denote the first three dataset. Below introduce the general information about the datasets in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.T1" title="Table 1 ‣ 3.1. Datasets ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1. </span>Statistics of the datasets.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.2.1.1"><span class="ltx_text" id="S3.T1.1.2.1.1.1" style="font-size:90%;">Data</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.2.1.2"><span class="ltx_text" id="S3.T1.1.2.1.2.1" style="font-size:90%;">Clothing</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.2.1.3"><span class="ltx_text" id="S3.T1.1.2.1.3.1" style="font-size:90%;">Movies</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.2.1.4"><span class="ltx_text" id="S3.T1.1.2.1.4.1" style="font-size:90%;">Games</span></th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.2.1.5"><span class="ltx_text" id="S3.T1.1.2.1.5.1" style="font-size:90%;">Yelp</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.3.1.1"><span class="ltx_text" id="S3.T1.1.3.1.1.1" style="font-size:90%;"># Interactions</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.3.1.2"><span class="ltx_text" id="S3.T1.1.3.1.2.1" style="font-size:90%;">179,223</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.3.1.3"><span class="ltx_text" id="S3.T1.1.3.1.3.1" style="font-size:90%;">441,783</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.3.1.4"><span class="ltx_text" id="S3.T1.1.3.1.4.1" style="font-size:90%;">19,927</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S3.T1.1.3.1.5"><span class="ltx_text" id="S3.T1.1.3.1.5.1" style="font-size:90%;">1,293,247</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4.2">
<td class="ltx_td ltx_align_center" id="S3.T1.1.4.2.1"><span class="ltx_text" id="S3.T1.1.4.2.1.1" style="font-size:90%;"># Users</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.4.2.2"><span class="ltx_text" id="S3.T1.1.4.2.2.1" style="font-size:90%;">38,764</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.4.2.3"><span class="ltx_text" id="S3.T1.1.4.2.3.1" style="font-size:90%;">7,506</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.4.2.4"><span class="ltx_text" id="S3.T1.1.4.2.4.1" style="font-size:90%;">2,490</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.1.4.2.5"><span class="ltx_text" id="S3.T1.1.4.2.5.1" style="font-size:90%;">27,147</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.5.3">
<td class="ltx_td ltx_align_center" id="S3.T1.1.5.3.1"><span class="ltx_text" id="S3.T1.1.5.3.1.1" style="font-size:90%;"># Items</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.5.3.2"><span class="ltx_text" id="S3.T1.1.5.3.2.1" style="font-size:90%;">22,919</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.5.3.3"><span class="ltx_text" id="S3.T1.1.5.3.3.1" style="font-size:90%;">7,360</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.5.3.4"><span class="ltx_text" id="S3.T1.1.5.3.4.1" style="font-size:90%;">8,912</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.1.5.3.5"><span class="ltx_text" id="S3.T1.1.5.3.5.1" style="font-size:90%;">20,266</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.1">
<span class="ltx_text" id="S3.T1.1.1.1.1" style="font-size:90%;"># Sparsity(</span><math alttext="\%" class="ltx_Math" display="inline" id="S3.T1.1.1.1.m1.1"><semantics id="S3.T1.1.1.1.m1.1a"><mo id="S3.T1.1.1.1.m1.1.1" mathsize="90%" xref="S3.T1.1.1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.m1.1d">%</annotation></semantics></math><span class="ltx_text" id="S3.T1.1.1.1.2" style="font-size:90%;">)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.2"><span class="ltx_text" id="S3.T1.1.1.2.1" style="font-size:90%;">99.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.3"><span class="ltx_text" id="S3.T1.1.1.3.1" style="font-size:90%;">99.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.4"><span class="ltx_text" id="S3.T1.1.1.4.1" style="font-size:90%;">99.91</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S3.T1.1.1.5"><span class="ltx_text" id="S3.T1.1.1.5.1" style="font-size:90%;">99.76</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">Amazon Clothing, Movies, and Games<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote1.1.1.1">1</span></span><span class="ltx_text ltx_font_medium" id="footnote1.5">https://cseweb.ucsd.edu/ jmcauley/datasets/amazon/links.html</span></span></span></span></span>: This is a real-world product review dataset and contains various subset categories. We use Clothing, Movies, and Games sub-datasets, which record users’ reviews and ratings in the scale of 1 to 5. Each user in datasets is associated with hobby, and background information, i.e., users’ favorite clothing brand, movie, game categories preferences and consumption level on items.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.1.1">Yelp<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote2.1.1.1">2</span></span><span class="ltx_text ltx_font_medium" id="footnote2.5">https://www.yelp.com/dataset/documentation/main</span></span></span></span></span>: This is a restaurant review dataset, which records restaurant attributes and users’ reviews and 5-star ratings on restaurants. Each user has hobby and background information, i.e., users’ restaurant category preferences, and consumption level on restaurants.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2. </span>Performance comparison of different baseline methods.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_align_center ltx_figure_panel" id="S3.T2.4"><span class="ltx_text" id="S3.T2.4.1" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T2.4.1.1">
<span class="ltx_tbody">
<span class="ltx_tr" id="S3.T2.4.1.1.1.1">
<span class="ltx_td ltx_align_center ltx_border_tt ltx_rowspan ltx_rowspan_2" id="S3.T2.4.1.1.1.1.1"><span class="ltx_text" id="S3.T2.4.1.1.1.1.1.1">Types</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_rowspan ltx_rowspan_2" id="S3.T2.4.1.1.1.1.2"><span class="ltx_text" id="S3.T2.4.1.1.1.1.2.1">Methods</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="S3.T2.4.1.1.1.1.3">Clothing</span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="S3.T2.4.1.1.1.1.4">Movies</span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="S3.T2.4.1.1.1.1.5">Games</span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="S3.T2.4.1.1.1.1.6">Yelp</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.2.2">
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.2.2.1">AUC</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.2.2.2">Logloss</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.2.2.3">AUC</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.2.2.4">Logloss</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.2.2.5">AUC</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.2.2.6">Logloss</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.2.2.7">AUC</span>
<span class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S3.T2.4.1.1.2.2.8">Logloss</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.3.3">
<span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_2" id="S3.T2.4.1.1.3.3.1"><span class="ltx_text" id="S3.T2.4.1.1.3.3.1.1">Shallow models</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.3.3.2">FFM</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.3.3.3">0.5588</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.3.3.4">0.6212</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.3.3.5">0.7998</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.3.3.6">0.5090</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.3.3.7">0.6946</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.3.3.8">0.8347</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.3.3.9">0.6931</span>
<span class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S3.T2.4.1.1.3.3.10">0.6903</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.4.4">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.4.4.1">AFM</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.4.4.2">0.5524</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.4.4.3">0.6181</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.4.4.4">0.7876</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.4.4.5">0.5656</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.4.4.6">0.6627</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.4.4.7">1.0342</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.4.4.8">0.6955</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.4.4.9">0.6836</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.5.5">
<span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_9" id="S3.T2.4.1.1.5.5.1"><span class="ltx_text" id="S3.T2.4.1.1.5.5.1.1">Deep models</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.5.5.2">FiBiNet</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.5.5.3">0.5952</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.5.5.4">0.6198</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.5.5.5">0.8111</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.5.5.6">0.4659</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.5.5.7">0.6862</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.5.5.8">0.8823</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.5.5.9">0.7243</span>
<span class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S3.T2.4.1.1.5.5.10">0.5621</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.6.6">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.6.6.1">DIFM</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.6.6.2">0.5935</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.6.6.3">0.5758</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.6.6.4">0.8054</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.6.6.5">0.4694</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.6.6.6">0.6897</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.6.6.7">0.9285</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.6.6.8">0.7174</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.6.6.9">0.5666</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.7.7">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.7.7.1">AFN</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.7.7.2">0.5945</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.7.7.3">0.5835</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.7.7.4">0.8050</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.7.7.5">0.4796</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.7.7.6">0.7022</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.7.7.7">0.8052</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.7.7.8">0.7169</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.7.7.9">0.6008</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.8.8">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.8.8.1">DeepFM</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.8.8.2">0.6015</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.8.8.3">0.5965</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.8.8.4">0.8061</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.8.8.5">0.4729</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.8.8.6">0.7221</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.8.8.7">0.8659</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.8.8.8">0.7017</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.8.8.9">0.6028</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.9.9">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.9.9.1">AutoInt</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.9.9.2">0.6023</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.9.9.3">0.6023</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.9.9.4">0.8072</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.9.9.5">0.4842</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.9.9.6">0.7257</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.9.9.7">0.8205</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.9.9.8">0.7194</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.9.9.9">0.6122</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.10.10">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.10.10.1">ONN</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.10.10.2">0.6094</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.10.10.3">0.5903</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.10.10.4">0.8121</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.10.10.5">0.4598</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.10.10.6">0.7223</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.10.10.7">0.8658</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.10.10.8">0.7253</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.10.10.9">0.5598</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.11.11">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.11.11.1">PNN</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.11.11.2">0.6088</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.11.11.3">0.5874</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.11.11.4">0.8154</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.11.11.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.4.1.1.11.11.5.1">0.4570</span></span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.11.11.6">0.7178</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.11.11.7">0.7874</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.11.11.8">0.7287</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.11.11.9">0.5574</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.12.12">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.12.12.1">DCNv2</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.12.12.2">0.6148</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.12.12.3">0.5848</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.12.12.4">0.8134</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.12.12.5">0.4643</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.12.12.6">0.7263</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.12.12.7">0.7991</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.12.12.8">0.7237</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.12.12.9">0.5704</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.13.13">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.13.13.1">DCN</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.13.13.2">0.6214</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.13.13.3">0.5322</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.13.13.4">0.8167</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.13.13.5">0.4582</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.13.13.6">0.7317</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.13.13.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.4.1.1.13.13.7.1">0.7744</span></span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.13.13.8">0.7259</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.13.13.9">0.5590</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.14.14">
<span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_5" id="S3.T2.4.1.1.14.14.1"><span class="ltx_text" id="S3.T2.4.1.1.14.14.1.1">LLMs-based models</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.14.14.2">KAR</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.14.14.3">0.6003</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.14.14.4">0.5925</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.14.14.5">0.8058</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.14.14.6">0.4885</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.14.14.7">0.7136</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.14.14.8">0.8679</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.1.1.14.14.9">0.7146</span>
<span class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S3.T2.4.1.1.14.14.10">0.5849</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.15.15">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.15.15.1">PEPLER</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.15.15.2">0.6101</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.15.15.3">0.5726</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.15.15.4">0.8095</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.15.15.5">0.4726</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.15.15.6">0.7188</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.15.15.7">0.8347</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.15.15.8">0.7227</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.15.15.9">0.5784</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.16.16">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.16.16.1">ReLLa</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.16.16.2">0.6214</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.16.16.3">0.5320</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.16.16.4">0.8099</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.16.16.5">0.4721</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.16.16.6">0.7322</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.16.16.7">0.7814</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.16.16.8">0.7290</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.16.16.9">0.5587</span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.17.17">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.17.17.1">UserIP-Tuning-gpt2</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.17.17.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.4.1.1.17.17.2.1">0.6234</span></span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.17.17.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.4.1.1.17.17.3.1">0.5319</span></span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.17.17.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.4.1.1.17.17.4.1">0.8179</span></span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.17.17.5">0.4571</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.17.17.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.4.1.1.17.17.6.1">0.7329</span></span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.17.17.7">0.7801</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.17.17.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.4.1.1.17.17.8.1">0.7311</span></span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.17.17.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.4.1.1.17.17.9.1">0.5562</span></span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.18.18">
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.18.18.1">UserIP-Tuning-Llama2</span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.18.18.2"><span class="ltx_text ltx_font_bold" id="S3.T2.4.1.1.18.18.2.1">0.6269*</span></span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.18.18.3"><span class="ltx_text ltx_font_bold" id="S3.T2.4.1.1.18.18.3.1">0.5126*</span></span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.18.18.4"><span class="ltx_text ltx_font_bold" id="S3.T2.4.1.1.18.18.4.1">0.8184*</span></span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.18.18.5"><span class="ltx_text ltx_font_bold" id="S3.T2.4.1.1.18.18.5.1">0.4566*</span></span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.18.18.6"><span class="ltx_text ltx_font_bold" id="S3.T2.4.1.1.18.18.6.1">0.7393*</span></span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.18.18.7"><span class="ltx_text ltx_font_bold" id="S3.T2.4.1.1.18.18.7.1">0.7285*</span></span>
<span class="ltx_td ltx_align_center" id="S3.T2.4.1.1.18.18.8"><span class="ltx_text ltx_font_bold" id="S3.T2.4.1.1.18.18.8.1">0.7314*</span></span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.1.1.18.18.9"><span class="ltx_text ltx_font_bold" id="S3.T2.4.1.1.18.18.9.1">0.5558*</span></span></span>
<span class="ltx_tr" id="S3.T2.4.1.1.19.19">
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_colspan ltx_colspan_2" id="S3.T2.4.1.1.19.19.1">Rela. Improv.</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.4.1.1.19.19.2">4.5548%</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.4.1.1.19.19.3">3.8199%</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.4.1.1.19.19.4">0.5336%</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.4.1.1.19.19.5">0.3482%</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.4.1.1.19.19.6">3.2755%</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.4.1.1.19.19.7">6.2992%</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.4.1.1.19.19.8">1.1937%</span>
<span class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.4.1.1.19.19.9">0.2879%</span></span>
</span>
</span></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S3.T2.1"><span class="ltx_text" id="S3.T2.1.1" style="font-size:90%;">The symbol * denotes the significance level with <math alttext="p\leq 0.05" class="ltx_Math" display="inline" id="S3.T2.1.1.m1.1"><semantics id="S3.T2.1.1.m1.1a"><mrow id="S3.T2.1.1.m1.1.1" xref="S3.T2.1.1.m1.1.1.cmml"><mi id="S3.T2.1.1.m1.1.1.2" xref="S3.T2.1.1.m1.1.1.2.cmml">p</mi><mo id="S3.T2.1.1.m1.1.1.1" xref="S3.T2.1.1.m1.1.1.1.cmml">≤</mo><mn id="S3.T2.1.1.m1.1.1.3" xref="S3.T2.1.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.m1.1b"><apply id="S3.T2.1.1.m1.1.1.cmml" xref="S3.T2.1.1.m1.1.1"><leq id="S3.T2.1.1.m1.1.1.1.cmml" xref="S3.T2.1.1.m1.1.1.1"></leq><ci id="S3.T2.1.1.m1.1.1.2.cmml" xref="S3.T2.1.1.m1.1.1.2">𝑝</ci><cn id="S3.T2.1.1.m1.1.1.3.cmml" type="float" xref="S3.T2.1.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.m1.1c">p\leq 0.05</annotation><annotation encoding="application/x-llamapun" id="S3.T2.1.1.m1.1d">italic_p ≤ 0.05</annotation></semantics></math>. <span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1">Bold</span> font indicates the best-performing method.</span></p>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Evaluation Metrics</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.2">To verify UserIP-Tuning’s recommendation effectiveness, we conduct <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.2.1">binary classification</span> (i.e., click-through rate prediction) on the four datasets.
The classification experiments are evaluated by AUC and Logloss, where slightly higher AUC or lower Logloss (e.g., 0.001) can represent significant improvement for our model performance <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib8" title="">2017</a>)</cite>. In addition, we filter the cold-start users and items with less than four interactions and transform the review scores into binary labels using a threshold of 3. Review scores greater than 3 are labeled as “positive” (<math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_y</annotation></semantics></math> = 1), while the rest are labeled as “negative” (<math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_y</annotation></semantics></math> = 0). Furthermore, following <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib16" title="">2023a</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citep">(Yan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib40" title="">2014</a>)</cite>, the relative improvements of UserIP-Tuning’s AUC and Logloss compared with best baseline’s are calculated as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E10">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E10X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle Rela.Improv.ofAUC=(\frac{AUC(model)-0.5}{AUC(baseline)-0.5}-1)" class="ltx_Math" display="inline" id="S3.E10X.2.1.1.m1.5"><semantics id="S3.E10X.2.1.1.m1.5a"><mrow id="S3.E10X.2.1.1.m1.5.5.3" xref="S3.E10X.2.1.1.m1.5.5.4.cmml"><mrow id="S3.E10X.2.1.1.m1.3.3.1.1" xref="S3.E10X.2.1.1.m1.3.3.1.1.cmml"><mi id="S3.E10X.2.1.1.m1.3.3.1.1.2" mathsize="90%" xref="S3.E10X.2.1.1.m1.3.3.1.1.2.cmml">R</mi><mo id="S3.E10X.2.1.1.m1.3.3.1.1.1" xref="S3.E10X.2.1.1.m1.3.3.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.3.3.1.1.3" mathsize="90%" xref="S3.E10X.2.1.1.m1.3.3.1.1.3.cmml">e</mi><mo id="S3.E10X.2.1.1.m1.3.3.1.1.1a" xref="S3.E10X.2.1.1.m1.3.3.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.3.3.1.1.4" mathsize="90%" xref="S3.E10X.2.1.1.m1.3.3.1.1.4.cmml">l</mi><mo id="S3.E10X.2.1.1.m1.3.3.1.1.1b" xref="S3.E10X.2.1.1.m1.3.3.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.3.3.1.1.5" mathsize="90%" xref="S3.E10X.2.1.1.m1.3.3.1.1.5.cmml">a</mi></mrow><mo id="S3.E10X.2.1.1.m1.5.5.3.4" lspace="0em" mathsize="90%" rspace="0.167em" xref="S3.E10X.2.1.1.m1.5.5.4a.cmml">.</mo><mrow id="S3.E10X.2.1.1.m1.4.4.2.2" xref="S3.E10X.2.1.1.m1.4.4.2.2.cmml"><mi id="S3.E10X.2.1.1.m1.4.4.2.2.2" mathsize="90%" xref="S3.E10X.2.1.1.m1.4.4.2.2.2.cmml">I</mi><mo id="S3.E10X.2.1.1.m1.4.4.2.2.1" xref="S3.E10X.2.1.1.m1.4.4.2.2.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.4.4.2.2.3" mathsize="90%" xref="S3.E10X.2.1.1.m1.4.4.2.2.3.cmml">m</mi><mo id="S3.E10X.2.1.1.m1.4.4.2.2.1a" xref="S3.E10X.2.1.1.m1.4.4.2.2.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.4.4.2.2.4" mathsize="90%" xref="S3.E10X.2.1.1.m1.4.4.2.2.4.cmml">p</mi><mo id="S3.E10X.2.1.1.m1.4.4.2.2.1b" xref="S3.E10X.2.1.1.m1.4.4.2.2.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.4.4.2.2.5" mathsize="90%" xref="S3.E10X.2.1.1.m1.4.4.2.2.5.cmml">r</mi><mo id="S3.E10X.2.1.1.m1.4.4.2.2.1c" xref="S3.E10X.2.1.1.m1.4.4.2.2.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.4.4.2.2.6" mathsize="90%" xref="S3.E10X.2.1.1.m1.4.4.2.2.6.cmml">o</mi><mo id="S3.E10X.2.1.1.m1.4.4.2.2.1d" xref="S3.E10X.2.1.1.m1.4.4.2.2.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.4.4.2.2.7" mathsize="90%" xref="S3.E10X.2.1.1.m1.4.4.2.2.7.cmml">v</mi></mrow><mo id="S3.E10X.2.1.1.m1.5.5.3.5" lspace="0em" mathsize="90%" rspace="0.167em" xref="S3.E10X.2.1.1.m1.5.5.4a.cmml">.</mo><mrow id="S3.E10X.2.1.1.m1.5.5.3.3" xref="S3.E10X.2.1.1.m1.5.5.3.3.cmml"><mrow id="S3.E10X.2.1.1.m1.5.5.3.3.3" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.cmml"><mi id="S3.E10X.2.1.1.m1.5.5.3.3.3.2" mathsize="90%" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.2.cmml">o</mi><mo id="S3.E10X.2.1.1.m1.5.5.3.3.3.1" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.5.5.3.3.3.3" mathsize="90%" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.3.cmml">f</mi><mo id="S3.E10X.2.1.1.m1.5.5.3.3.3.1a" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.5.5.3.3.3.4" mathsize="90%" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.4.cmml">A</mi><mo id="S3.E10X.2.1.1.m1.5.5.3.3.3.1b" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.5.5.3.3.3.5" mathsize="90%" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.5.cmml">U</mi><mo id="S3.E10X.2.1.1.m1.5.5.3.3.3.1c" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.5.5.3.3.3.6" mathsize="90%" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.6.cmml">C</mi></mrow><mo id="S3.E10X.2.1.1.m1.5.5.3.3.2" mathsize="90%" xref="S3.E10X.2.1.1.m1.5.5.3.3.2.cmml">=</mo><mrow id="S3.E10X.2.1.1.m1.5.5.3.3.1.1" xref="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.cmml"><mo id="S3.E10X.2.1.1.m1.5.5.3.3.1.1.2" maxsize="90%" minsize="90%" xref="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.cmml">(</mo><mrow id="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1" xref="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E10X.2.1.1.m1.2.2" xref="S3.E10X.2.1.1.m1.2.2.cmml"><mfrac id="S3.E10X.2.1.1.m1.2.2a" xref="S3.E10X.2.1.1.m1.2.2.cmml"><mrow id="S3.E10X.2.1.1.m1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.cmml"><mrow id="S3.E10X.2.1.1.m1.1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.3" mathsize="90%" xref="S3.E10X.2.1.1.m1.1.1.1.1.3.cmml">A</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.1.1.1.1.4" mathsize="90%" xref="S3.E10X.2.1.1.m1.1.1.1.1.4.cmml">U</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2a" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.1.1.1.1.5" mathsize="90%" xref="S3.E10X.2.1.1.m1.1.1.1.1.5.cmml">C</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2b" xref="S3.E10X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">m</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">o</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1a" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.4" mathsize="90%" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.4.cmml">d</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1b" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.5" mathsize="90%" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.5.cmml">e</mi><mo id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1c" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.6" mathsize="90%" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.6.cmml">l</mi></mrow><mo id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10X.2.1.1.m1.1.1.1.2" mathsize="90%" xref="S3.E10X.2.1.1.m1.1.1.1.2.cmml">−</mo><mn id="S3.E10X.2.1.1.m1.1.1.1.3" mathsize="90%" xref="S3.E10X.2.1.1.m1.1.1.1.3.cmml">0.5</mn></mrow><mrow id="S3.E10X.2.1.1.m1.2.2.2" xref="S3.E10X.2.1.1.m1.2.2.2.cmml"><mrow id="S3.E10X.2.1.1.m1.2.2.2.1" xref="S3.E10X.2.1.1.m1.2.2.2.1.cmml"><mi id="S3.E10X.2.1.1.m1.2.2.2.1.3" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.3.cmml">A</mi><mo id="S3.E10X.2.1.1.m1.2.2.2.1.2" xref="S3.E10X.2.1.1.m1.2.2.2.1.2.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.2.2.2.1.4" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.4.cmml">U</mi><mo id="S3.E10X.2.1.1.m1.2.2.2.1.2a" xref="S3.E10X.2.1.1.m1.2.2.2.1.2.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.2.2.2.1.5" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.5.cmml">C</mi><mo id="S3.E10X.2.1.1.m1.2.2.2.1.2b" xref="S3.E10X.2.1.1.m1.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E10X.2.1.1.m1.2.2.2.1.1.1" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.cmml"><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.2" maxsize="90%" minsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.cmml"><mi id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.2" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.2.cmml">b</mi><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.3" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.3.cmml">a</mi><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1a" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.4" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.4.cmml">s</mi><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1b" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.5" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.5.cmml">e</mi><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1c" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.6" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.6.cmml">l</mi><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1d" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.7" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.7.cmml">i</mi><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1e" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.8" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.8.cmml">n</mi><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1f" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.9" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.9.cmml">e</mi></mrow><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3" maxsize="90%" minsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10X.2.1.1.m1.2.2.2.2" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.2.cmml">−</mo><mn id="S3.E10X.2.1.1.m1.2.2.2.3" mathsize="90%" xref="S3.E10X.2.1.1.m1.2.2.2.3.cmml">0.5</mn></mrow></mfrac></mstyle><mo id="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.1" mathsize="90%" xref="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.1.cmml">−</mo><mn id="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.2" mathsize="90%" xref="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.2.cmml">1</mn></mrow><mo id="S3.E10X.2.1.1.m1.5.5.3.3.1.1.3" maxsize="90%" minsize="90%" xref="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10X.2.1.1.m1.5b"><apply id="S3.E10X.2.1.1.m1.5.5.4.cmml" xref="S3.E10X.2.1.1.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.5.5.4a.cmml" xref="S3.E10X.2.1.1.m1.5.5.3.4">formulae-sequence</csymbol><apply id="S3.E10X.2.1.1.m1.3.3.1.1.cmml" xref="S3.E10X.2.1.1.m1.3.3.1.1"><times id="S3.E10X.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.3.3.1.1.1"></times><ci id="S3.E10X.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.3.3.1.1.2">𝑅</ci><ci id="S3.E10X.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.3.3.1.1.3">𝑒</ci><ci id="S3.E10X.2.1.1.m1.3.3.1.1.4.cmml" xref="S3.E10X.2.1.1.m1.3.3.1.1.4">𝑙</ci><ci id="S3.E10X.2.1.1.m1.3.3.1.1.5.cmml" xref="S3.E10X.2.1.1.m1.3.3.1.1.5">𝑎</ci></apply><apply id="S3.E10X.2.1.1.m1.4.4.2.2.cmml" xref="S3.E10X.2.1.1.m1.4.4.2.2"><times id="S3.E10X.2.1.1.m1.4.4.2.2.1.cmml" xref="S3.E10X.2.1.1.m1.4.4.2.2.1"></times><ci id="S3.E10X.2.1.1.m1.4.4.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.4.4.2.2.2">𝐼</ci><ci id="S3.E10X.2.1.1.m1.4.4.2.2.3.cmml" xref="S3.E10X.2.1.1.m1.4.4.2.2.3">𝑚</ci><ci id="S3.E10X.2.1.1.m1.4.4.2.2.4.cmml" xref="S3.E10X.2.1.1.m1.4.4.2.2.4">𝑝</ci><ci id="S3.E10X.2.1.1.m1.4.4.2.2.5.cmml" xref="S3.E10X.2.1.1.m1.4.4.2.2.5">𝑟</ci><ci id="S3.E10X.2.1.1.m1.4.4.2.2.6.cmml" xref="S3.E10X.2.1.1.m1.4.4.2.2.6">𝑜</ci><ci id="S3.E10X.2.1.1.m1.4.4.2.2.7.cmml" xref="S3.E10X.2.1.1.m1.4.4.2.2.7">𝑣</ci></apply><apply id="S3.E10X.2.1.1.m1.5.5.3.3.cmml" xref="S3.E10X.2.1.1.m1.5.5.3.3"><eq id="S3.E10X.2.1.1.m1.5.5.3.3.2.cmml" xref="S3.E10X.2.1.1.m1.5.5.3.3.2"></eq><apply id="S3.E10X.2.1.1.m1.5.5.3.3.3.cmml" xref="S3.E10X.2.1.1.m1.5.5.3.3.3"><times id="S3.E10X.2.1.1.m1.5.5.3.3.3.1.cmml" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.1"></times><ci id="S3.E10X.2.1.1.m1.5.5.3.3.3.2.cmml" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.2">𝑜</ci><ci id="S3.E10X.2.1.1.m1.5.5.3.3.3.3.cmml" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.3">𝑓</ci><ci id="S3.E10X.2.1.1.m1.5.5.3.3.3.4.cmml" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.4">𝐴</ci><ci id="S3.E10X.2.1.1.m1.5.5.3.3.3.5.cmml" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.5">𝑈</ci><ci id="S3.E10X.2.1.1.m1.5.5.3.3.3.6.cmml" xref="S3.E10X.2.1.1.m1.5.5.3.3.3.6">𝐶</ci></apply><apply id="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.5.5.3.3.1.1"><minus id="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.1"></minus><apply id="S3.E10X.2.1.1.m1.2.2.cmml" xref="S3.E10X.2.1.1.m1.2.2"><divide id="S3.E10X.2.1.1.m1.2.2.3.cmml" xref="S3.E10X.2.1.1.m1.2.2"></divide><apply id="S3.E10X.2.1.1.m1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1"><minus id="S3.E10X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.2"></minus><apply id="S3.E10X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1"><times id="S3.E10X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.2"></times><ci id="S3.E10X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.3">𝐴</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.4.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.4">𝑈</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.5.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.5">𝐶</ci><apply id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1"><times id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.1"></times><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.2">𝑚</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.3">𝑜</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.4">𝑑</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.5.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.5">𝑒</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.6.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.1.1.6">𝑙</ci></apply></apply><cn id="S3.E10X.2.1.1.m1.1.1.1.3.cmml" type="float" xref="S3.E10X.2.1.1.m1.1.1.1.3">0.5</cn></apply><apply id="S3.E10X.2.1.1.m1.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.2.2.2"><minus id="S3.E10X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.2"></minus><apply id="S3.E10X.2.1.1.m1.2.2.2.1.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1"><times id="S3.E10X.2.1.1.m1.2.2.2.1.2.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.2"></times><ci id="S3.E10X.2.1.1.m1.2.2.2.1.3.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.3">𝐴</ci><ci id="S3.E10X.2.1.1.m1.2.2.2.1.4.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.4">𝑈</ci><ci id="S3.E10X.2.1.1.m1.2.2.2.1.5.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.5">𝐶</ci><apply id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1"><times id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1"></times><ci id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.2">𝑏</ci><ci id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.3">𝑎</ci><ci id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.4.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.4">𝑠</ci><ci id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.5.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.5">𝑒</ci><ci id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.6.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.6">𝑙</ci><ci id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.7.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.7">𝑖</ci><ci id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.8.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.8">𝑛</ci><ci id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.9.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.9">𝑒</ci></apply></apply><cn id="S3.E10X.2.1.1.m1.2.2.2.3.cmml" type="float" xref="S3.E10X.2.1.1.m1.2.2.2.3">0.5</cn></apply></apply><cn id="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.2.cmml" type="integer" xref="S3.E10X.2.1.1.m1.5.5.3.3.1.1.1.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10X.2.1.1.m1.5c">\displaystyle Rela.Improv.ofAUC=(\frac{AUC(model)-0.5}{AUC(baseline)-0.5}-1)</annotation><annotation encoding="application/x-llamapun" id="S3.E10X.2.1.1.m1.5d">italic_R italic_e italic_l italic_a . italic_I italic_m italic_p italic_r italic_o italic_v . italic_o italic_f italic_A italic_U italic_C = ( divide start_ARG italic_A italic_U italic_C ( italic_m italic_o italic_d italic_e italic_l ) - 0.5 end_ARG start_ARG italic_A italic_U italic_C ( italic_b italic_a italic_s italic_e italic_l italic_i italic_n italic_e ) - 0.5 end_ARG - 1 )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E11">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E11X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle Rela.Improv.ofLogloss=\frac{Logloss(baseline)-Logloss(model)}{%
Logloss(model)}" class="ltx_Math" display="inline" id="S3.E11X.2.1.1.m1.6"><semantics id="S3.E11X.2.1.1.m1.6a"><mrow id="S3.E11X.2.1.1.m1.6.6.3" xref="S3.E11X.2.1.1.m1.6.6.4.cmml"><mrow id="S3.E11X.2.1.1.m1.4.4.1.1" xref="S3.E11X.2.1.1.m1.4.4.1.1.cmml"><mi id="S3.E11X.2.1.1.m1.4.4.1.1.2" mathsize="90%" xref="S3.E11X.2.1.1.m1.4.4.1.1.2.cmml">R</mi><mo id="S3.E11X.2.1.1.m1.4.4.1.1.1" xref="S3.E11X.2.1.1.m1.4.4.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.4.4.1.1.3" mathsize="90%" xref="S3.E11X.2.1.1.m1.4.4.1.1.3.cmml">e</mi><mo id="S3.E11X.2.1.1.m1.4.4.1.1.1a" xref="S3.E11X.2.1.1.m1.4.4.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.4.4.1.1.4" mathsize="90%" xref="S3.E11X.2.1.1.m1.4.4.1.1.4.cmml">l</mi><mo id="S3.E11X.2.1.1.m1.4.4.1.1.1b" xref="S3.E11X.2.1.1.m1.4.4.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.4.4.1.1.5" mathsize="90%" xref="S3.E11X.2.1.1.m1.4.4.1.1.5.cmml">a</mi></mrow><mo id="S3.E11X.2.1.1.m1.6.6.3.4" lspace="0em" mathsize="90%" rspace="0.167em" xref="S3.E11X.2.1.1.m1.6.6.4a.cmml">.</mo><mrow id="S3.E11X.2.1.1.m1.5.5.2.2" xref="S3.E11X.2.1.1.m1.5.5.2.2.cmml"><mi id="S3.E11X.2.1.1.m1.5.5.2.2.2" mathsize="90%" xref="S3.E11X.2.1.1.m1.5.5.2.2.2.cmml">I</mi><mo id="S3.E11X.2.1.1.m1.5.5.2.2.1" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.5.5.2.2.3" mathsize="90%" xref="S3.E11X.2.1.1.m1.5.5.2.2.3.cmml">m</mi><mo id="S3.E11X.2.1.1.m1.5.5.2.2.1a" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.5.5.2.2.4" mathsize="90%" xref="S3.E11X.2.1.1.m1.5.5.2.2.4.cmml">p</mi><mo id="S3.E11X.2.1.1.m1.5.5.2.2.1b" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.5.5.2.2.5" mathsize="90%" xref="S3.E11X.2.1.1.m1.5.5.2.2.5.cmml">r</mi><mo id="S3.E11X.2.1.1.m1.5.5.2.2.1c" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.5.5.2.2.6" mathsize="90%" xref="S3.E11X.2.1.1.m1.5.5.2.2.6.cmml">o</mi><mo id="S3.E11X.2.1.1.m1.5.5.2.2.1d" xref="S3.E11X.2.1.1.m1.5.5.2.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.5.5.2.2.7" mathsize="90%" xref="S3.E11X.2.1.1.m1.5.5.2.2.7.cmml">v</mi></mrow><mo id="S3.E11X.2.1.1.m1.6.6.3.5" lspace="0em" mathsize="90%" rspace="0.167em" xref="S3.E11X.2.1.1.m1.6.6.4a.cmml">.</mo><mrow id="S3.E11X.2.1.1.m1.6.6.3.3" xref="S3.E11X.2.1.1.m1.6.6.3.3.cmml"><mrow id="S3.E11X.2.1.1.m1.6.6.3.3.2" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.cmml"><mi id="S3.E11X.2.1.1.m1.6.6.3.3.2.2" mathsize="90%" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.2.cmml">o</mi><mo id="S3.E11X.2.1.1.m1.6.6.3.3.2.1" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.6.6.3.3.2.3" mathsize="90%" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.3.cmml">f</mi><mo id="S3.E11X.2.1.1.m1.6.6.3.3.2.1a" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.6.6.3.3.2.4" mathsize="90%" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.4.cmml">L</mi><mo id="S3.E11X.2.1.1.m1.6.6.3.3.2.1b" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.6.6.3.3.2.5" mathsize="90%" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.5.cmml">o</mi><mo id="S3.E11X.2.1.1.m1.6.6.3.3.2.1c" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.6.6.3.3.2.6" mathsize="90%" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.6.cmml">g</mi><mo id="S3.E11X.2.1.1.m1.6.6.3.3.2.1d" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.6.6.3.3.2.7" mathsize="90%" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.7.cmml">l</mi><mo id="S3.E11X.2.1.1.m1.6.6.3.3.2.1e" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.6.6.3.3.2.8" mathsize="90%" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.8.cmml">o</mi><mo id="S3.E11X.2.1.1.m1.6.6.3.3.2.1f" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.6.6.3.3.2.9" mathsize="90%" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.9.cmml">s</mi><mo id="S3.E11X.2.1.1.m1.6.6.3.3.2.1g" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.6.6.3.3.2.10" mathsize="90%" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.10.cmml">s</mi></mrow><mo id="S3.E11X.2.1.1.m1.6.6.3.3.1" mathsize="90%" xref="S3.E11X.2.1.1.m1.6.6.3.3.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E11X.2.1.1.m1.3.3" xref="S3.E11X.2.1.1.m1.3.3.cmml"><mfrac id="S3.E11X.2.1.1.m1.3.3a" xref="S3.E11X.2.1.1.m1.3.3.cmml"><mrow id="S3.E11X.2.1.1.m1.2.2.2" xref="S3.E11X.2.1.1.m1.2.2.2.cmml"><mrow id="S3.E11X.2.1.1.m1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.cmml">L</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.4" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.4.cmml">o</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2a" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.5" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.5.cmml">g</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2b" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.6" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.6.cmml">l</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2c" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.7" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.7.cmml">o</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2d" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.8" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.8.cmml">s</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2e" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.9" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.9.cmml">s</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2f" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">b</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">a</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1a" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.4" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.4.cmml">s</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1b" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.5" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.5.cmml">e</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1c" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.6" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.6.cmml">l</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1d" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.7" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.7.cmml">i</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1e" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.8" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.8.cmml">n</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1f" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.9" mathsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.9.cmml">e</mi></mrow><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11X.2.1.1.m1.2.2.2.3" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.3.cmml">−</mo><mrow id="S3.E11X.2.1.1.m1.2.2.2.2" xref="S3.E11X.2.1.1.m1.2.2.2.2.cmml"><mi id="S3.E11X.2.1.1.m1.2.2.2.2.3" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.3.cmml">L</mi><mo id="S3.E11X.2.1.1.m1.2.2.2.2.2" xref="S3.E11X.2.1.1.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.2.2.2.2.4" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.4.cmml">o</mi><mo id="S3.E11X.2.1.1.m1.2.2.2.2.2a" xref="S3.E11X.2.1.1.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.2.2.2.2.5" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.5.cmml">g</mi><mo id="S3.E11X.2.1.1.m1.2.2.2.2.2b" xref="S3.E11X.2.1.1.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.2.2.2.2.6" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.6.cmml">l</mi><mo id="S3.E11X.2.1.1.m1.2.2.2.2.2c" xref="S3.E11X.2.1.1.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.2.2.2.2.7" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.7.cmml">o</mi><mo id="S3.E11X.2.1.1.m1.2.2.2.2.2d" xref="S3.E11X.2.1.1.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.2.2.2.2.8" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.8.cmml">s</mi><mo id="S3.E11X.2.1.1.m1.2.2.2.2.2e" xref="S3.E11X.2.1.1.m1.2.2.2.2.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.2.2.2.2.9" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.9.cmml">s</mi><mo id="S3.E11X.2.1.1.m1.2.2.2.2.2f" xref="S3.E11X.2.1.1.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E11X.2.1.1.m1.2.2.2.2.1.1" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.cmml"><mo id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.2" maxsize="90%" minsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.cmml"><mi id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.2" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.2.cmml">m</mi><mo id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.1" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.3" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.3.cmml">o</mi><mo id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.1a" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.4" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.4.cmml">d</mi><mo id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.1b" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.5" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.5.cmml">e</mi><mo id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.1c" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.6" mathsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.6.cmml">l</mi></mrow><mo id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.3" maxsize="90%" minsize="90%" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.E11X.2.1.1.m1.3.3.3" xref="S3.E11X.2.1.1.m1.3.3.3.cmml"><mi id="S3.E11X.2.1.1.m1.3.3.3.3" mathsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.3.cmml">L</mi><mo id="S3.E11X.2.1.1.m1.3.3.3.2" xref="S3.E11X.2.1.1.m1.3.3.3.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.3.3.3.4" mathsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.4.cmml">o</mi><mo id="S3.E11X.2.1.1.m1.3.3.3.2a" xref="S3.E11X.2.1.1.m1.3.3.3.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.3.3.3.5" mathsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.5.cmml">g</mi><mo id="S3.E11X.2.1.1.m1.3.3.3.2b" xref="S3.E11X.2.1.1.m1.3.3.3.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.3.3.3.6" mathsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.6.cmml">l</mi><mo id="S3.E11X.2.1.1.m1.3.3.3.2c" xref="S3.E11X.2.1.1.m1.3.3.3.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.3.3.3.7" mathsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.7.cmml">o</mi><mo id="S3.E11X.2.1.1.m1.3.3.3.2d" xref="S3.E11X.2.1.1.m1.3.3.3.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.3.3.3.8" mathsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.8.cmml">s</mi><mo id="S3.E11X.2.1.1.m1.3.3.3.2e" xref="S3.E11X.2.1.1.m1.3.3.3.2.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.3.3.3.9" mathsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.9.cmml">s</mi><mo id="S3.E11X.2.1.1.m1.3.3.3.2f" xref="S3.E11X.2.1.1.m1.3.3.3.2.cmml">⁢</mo><mrow id="S3.E11X.2.1.1.m1.3.3.3.1.1" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.cmml"><mo id="S3.E11X.2.1.1.m1.3.3.3.1.1.2" maxsize="90%" minsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.E11X.2.1.1.m1.3.3.3.1.1.1" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.cmml"><mi id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.2" mathsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.2.cmml">m</mi><mo id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.1" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.3" mathsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.3.cmml">o</mi><mo id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.1a" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.4" mathsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.4.cmml">d</mi><mo id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.1b" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.5" mathsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.5.cmml">e</mi><mo id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.1c" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.1.cmml">⁢</mo><mi id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.6" mathsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.6.cmml">l</mi></mrow><mo id="S3.E11X.2.1.1.m1.3.3.3.1.1.3" maxsize="90%" minsize="90%" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11X.2.1.1.m1.6b"><apply id="S3.E11X.2.1.1.m1.6.6.4.cmml" xref="S3.E11X.2.1.1.m1.6.6.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.6.6.4a.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.4">formulae-sequence</csymbol><apply id="S3.E11X.2.1.1.m1.4.4.1.1.cmml" xref="S3.E11X.2.1.1.m1.4.4.1.1"><times id="S3.E11X.2.1.1.m1.4.4.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.4.4.1.1.1"></times><ci id="S3.E11X.2.1.1.m1.4.4.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.4.4.1.1.2">𝑅</ci><ci id="S3.E11X.2.1.1.m1.4.4.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.4.4.1.1.3">𝑒</ci><ci id="S3.E11X.2.1.1.m1.4.4.1.1.4.cmml" xref="S3.E11X.2.1.1.m1.4.4.1.1.4">𝑙</ci><ci id="S3.E11X.2.1.1.m1.4.4.1.1.5.cmml" xref="S3.E11X.2.1.1.m1.4.4.1.1.5">𝑎</ci></apply><apply id="S3.E11X.2.1.1.m1.5.5.2.2.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2"><times id="S3.E11X.2.1.1.m1.5.5.2.2.1.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.1"></times><ci id="S3.E11X.2.1.1.m1.5.5.2.2.2.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.2">𝐼</ci><ci id="S3.E11X.2.1.1.m1.5.5.2.2.3.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.3">𝑚</ci><ci id="S3.E11X.2.1.1.m1.5.5.2.2.4.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.4">𝑝</ci><ci id="S3.E11X.2.1.1.m1.5.5.2.2.5.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.5">𝑟</ci><ci id="S3.E11X.2.1.1.m1.5.5.2.2.6.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.6">𝑜</ci><ci id="S3.E11X.2.1.1.m1.5.5.2.2.7.cmml" xref="S3.E11X.2.1.1.m1.5.5.2.2.7">𝑣</ci></apply><apply id="S3.E11X.2.1.1.m1.6.6.3.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3"><eq id="S3.E11X.2.1.1.m1.6.6.3.3.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3.1"></eq><apply id="S3.E11X.2.1.1.m1.6.6.3.3.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3.2"><times id="S3.E11X.2.1.1.m1.6.6.3.3.2.1.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.1"></times><ci id="S3.E11X.2.1.1.m1.6.6.3.3.2.2.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.2">𝑜</ci><ci id="S3.E11X.2.1.1.m1.6.6.3.3.2.3.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.3">𝑓</ci><ci id="S3.E11X.2.1.1.m1.6.6.3.3.2.4.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.4">𝐿</ci><ci id="S3.E11X.2.1.1.m1.6.6.3.3.2.5.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.5">𝑜</ci><ci id="S3.E11X.2.1.1.m1.6.6.3.3.2.6.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.6">𝑔</ci><ci id="S3.E11X.2.1.1.m1.6.6.3.3.2.7.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.7">𝑙</ci><ci id="S3.E11X.2.1.1.m1.6.6.3.3.2.8.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.8">𝑜</ci><ci id="S3.E11X.2.1.1.m1.6.6.3.3.2.9.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.9">𝑠</ci><ci id="S3.E11X.2.1.1.m1.6.6.3.3.2.10.cmml" xref="S3.E11X.2.1.1.m1.6.6.3.3.2.10">𝑠</ci></apply><apply id="S3.E11X.2.1.1.m1.3.3.cmml" xref="S3.E11X.2.1.1.m1.3.3"><divide id="S3.E11X.2.1.1.m1.3.3.4.cmml" xref="S3.E11X.2.1.1.m1.3.3"></divide><apply id="S3.E11X.2.1.1.m1.2.2.2.cmml" xref="S3.E11X.2.1.1.m1.2.2.2"><minus id="S3.E11X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.3"></minus><apply id="S3.E11X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1"><times id="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2"></times><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3">𝐿</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.4.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.4">𝑜</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.5.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.5">𝑔</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.6.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.6">𝑙</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.7.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.7">𝑜</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.8.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.8">𝑠</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.9.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.9">𝑠</ci><apply id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1"><times id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.1"></times><ci id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.2">𝑏</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.3">𝑎</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.4">𝑠</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.5.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.5">𝑒</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.6.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.6">𝑙</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.7.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.7">𝑖</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.8.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.8">𝑛</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.9.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.1.1.9">𝑒</ci></apply></apply><apply id="S3.E11X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2"><times id="S3.E11X.2.1.1.m1.2.2.2.2.2.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.2"></times><ci id="S3.E11X.2.1.1.m1.2.2.2.2.3.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.3">𝐿</ci><ci id="S3.E11X.2.1.1.m1.2.2.2.2.4.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.4">𝑜</ci><ci id="S3.E11X.2.1.1.m1.2.2.2.2.5.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.5">𝑔</ci><ci id="S3.E11X.2.1.1.m1.2.2.2.2.6.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.6">𝑙</ci><ci id="S3.E11X.2.1.1.m1.2.2.2.2.7.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.7">𝑜</ci><ci id="S3.E11X.2.1.1.m1.2.2.2.2.8.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.8">𝑠</ci><ci id="S3.E11X.2.1.1.m1.2.2.2.2.9.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.9">𝑠</ci><apply id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1"><times id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.1"></times><ci id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.2">𝑚</ci><ci id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.3">𝑜</ci><ci id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.4.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.4">𝑑</ci><ci id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.5.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.5">𝑒</ci><ci id="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.6.cmml" xref="S3.E11X.2.1.1.m1.2.2.2.2.1.1.1.6">𝑙</ci></apply></apply></apply><apply id="S3.E11X.2.1.1.m1.3.3.3.cmml" xref="S3.E11X.2.1.1.m1.3.3.3"><times id="S3.E11X.2.1.1.m1.3.3.3.2.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.2"></times><ci id="S3.E11X.2.1.1.m1.3.3.3.3.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.3">𝐿</ci><ci id="S3.E11X.2.1.1.m1.3.3.3.4.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.4">𝑜</ci><ci id="S3.E11X.2.1.1.m1.3.3.3.5.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.5">𝑔</ci><ci id="S3.E11X.2.1.1.m1.3.3.3.6.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.6">𝑙</ci><ci id="S3.E11X.2.1.1.m1.3.3.3.7.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.7">𝑜</ci><ci id="S3.E11X.2.1.1.m1.3.3.3.8.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.8">𝑠</ci><ci id="S3.E11X.2.1.1.m1.3.3.3.9.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.9">𝑠</ci><apply id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.1.1"><times id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.1"></times><ci id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.2">𝑚</ci><ci id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.3">𝑜</ci><ci id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.4.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.4">𝑑</ci><ci id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.5.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.5">𝑒</ci><ci id="S3.E11X.2.1.1.m1.3.3.3.1.1.1.6.cmml" xref="S3.E11X.2.1.1.m1.3.3.3.1.1.1.6">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11X.2.1.1.m1.6c">\displaystyle Rela.Improv.ofLogloss=\frac{Logloss(baseline)-Logloss(model)}{%
Logloss(model)}</annotation><annotation encoding="application/x-llamapun" id="S3.E11X.2.1.1.m1.6d">italic_R italic_e italic_l italic_a . italic_I italic_m italic_p italic_r italic_o italic_v . italic_o italic_f italic_L italic_o italic_g italic_l italic_o italic_s italic_s = divide start_ARG italic_L italic_o italic_g italic_l italic_o italic_s italic_s ( italic_b italic_a italic_s italic_e italic_l italic_i italic_n italic_e ) - italic_L italic_o italic_g italic_l italic_o italic_s italic_s ( italic_m italic_o italic_d italic_e italic_l ) end_ARG start_ARG italic_L italic_o italic_g italic_l italic_o italic_s italic_s ( italic_m italic_o italic_d italic_e italic_l ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Baselines</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">This subsection introduces the baselines methods for recommendation task. UserIP-Tuning’s model performance is compared with three types of recommendation baselines: shallow algorithms, advanced deep learning algorithms, LLMs-based recommendation methods. First, shallow algorithms mainly are second and high order feature interaction and attention methods including FFM <cite class="ltx_cite ltx_citemacro_citep">(Juan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib12" title="">2016</a>)</cite>, AFM <cite class="ltx_cite ltx_citemacro_citep">(Xiao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib38" title="">2017</a>)</cite>. The advanced deep learning algorithms are based on deep cross features and factorization machine networks consisting of FiBiNet <cite class="ltx_cite ltx_citemacro_citep">(Huang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib10" title="">2019</a>)</cite>, DIFM <cite class="ltx_cite ltx_citemacro_citep">(Lu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib21" title="">2021</a>)</cite>, AFN <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib5" title="">2020</a>)</cite>, DeepFM <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib8" title="">2017</a>)</cite>, AutoInt <cite class="ltx_cite ltx_citemacro_citep">(Song et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib26" title="">2019</a>)</cite>, ONN <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib41" title="">2020</a>)</cite>, PNN <cite class="ltx_cite ltx_citemacro_citep">(Qu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib24" title="">2016</a>)</cite>, DCN <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib32" title="">2017</a>)</cite>, DCNv2 <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib33" title="">2021</a>)</cite>. We also compare our model with LLMs-based methods such as KAR <cite class="ltx_cite ltx_citemacro_citep">(Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib37" title="">2023</a>)</cite>, PEPLER <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib15" title="">2023d</a>)</cite>, and ReLLa <cite class="ltx_cite ltx_citemacro_citep">(Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib20" title="">2024</a>)</cite>, the factual and reasoning knowledge augmented recommendation methods.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Implementation Details</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.3">We select Llama2-7B from Huggingface<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://huggingface.co/meta-llama/Llama-2-7b-hf</span></span></span> as the LLMs backbone in UserIP-Tuning. We implement all the compared methods using Python 3.9 and PyTorch 2.1.0. Following previous work <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib15" title="">2023d</a>; Liao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib19" title="">2023</a>)</cite>, the training, validation, and test sets are divided into 8:1:1 in experiments. The benchmarks hyper-parameters are set by default to obtain their optimal performance and the Adam optimizer is used. The embeddings size in Llama2-7B is 4096 and batch size is 8. We optimize UserIP-Tuning with AdamW and set batch size to 128. During training, we freeze the LLMs weights. The learning rate is set to 0.001 and latent profile embedding size is 4096. Moreover, the number of hobby codebook is set to 4 and the number of background codebook is 3. In downstream recommender DCN, the number of network layer is 3, and embedding dimension is 8, and the dropout rate is 0.2, and MLP embedding dimensions are (16,16) and we use item ID and user ID as the obvious feature fields. The loss weights are <math alttext="\beta_{m}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">β</mi><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝛽</ci><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\beta_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_β start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>=0.001, <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><mi id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">italic_β</annotation></semantics></math>=0.001, and <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">italic_γ</annotation></semantics></math>=0.001. We use one NVIDIA H800 80GB GPU.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5. </span>Overall Performance Comparison (RQ1)</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">To answer RQ1, UserIP-Tuning is compared with other advanced recommendation algorithms. The overall performance is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.T2" title="Table 2 ‣ 3.1. Datasets ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">2</span></a> where the best results are in bold, and the second best results are underlined.</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.1">From the table, we can observe that:
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS5.p2.1.1">1)</span> The proposed method UserIP-Tuning prominently surpasses all the baseline methods. The relative improvement values of AUC over the best benchmark method are about 4.55%, 0.53%, 3.28%, and 1.19% respectively on Clothing, Movies, Games, and Yelp. The relative improvement values of Logloss over the best baseline are about 3.82%, 0.35%, 6.30%, and 0.29% respectively on Clothing, Movies, Games, and Yelp. UserIP-Tuning’s model performance demonstrates the inferred user latent profiles variables capture user profiling. The performance relative improvement of AUC are basically greater than of Logloss, which means UserIP-Tuning strengthen the recommendation precision and capture user preferences.
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS5.p2.1.2">2)</span> The shallow conventional benchmarks, FFM, AFM, achieve the worst predictive results on four real-world datasets. Their predictions are based on the user-id and item-id features during the training stage. This evaluation results illustrate that leveraging shallow feature interactions could corrupt the recommendation efficiency.
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS5.p2.1.3">3)</span> The deep learning baselines such as PNN, DCN, perform better than the conventional algorithms because they capture more diversity and collaborative information. Nevertheless, the advanced deep learning methods are still worse than UserIP-Tuning, since UserIP-Tuning integrates user profiles variables and collaborative indices signals, effectively enhancing its ability to capture user preferences and interaction information.
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS5.p2.1.4">4)</span> The LLMs-based methods, KAR, PEPLER, Rella, achieve higher results than most deep learning baselines since they exploits the reasoning knowledge on user preferences and the factual knowledge on items. But, UserIP-Tuning can learn the inherent profile of users and capture users’ preferences, thus, UserIP-Tuning is superior.</p>
</div>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3. </span>User hobby and background latent profile retrieval</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T3.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.3.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T3.3.1.1.1" rowspan="2"><span class="ltx_text" id="S3.T3.3.1.1.1.1" style="font-size:90%;">Model component</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T3.3.1.1.2"><span class="ltx_text" id="S3.T3.3.1.1.2.1" style="font-size:90%;">Clothing</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T3.3.1.1.3"><span class="ltx_text" id="S3.T3.3.1.1.3.1" style="font-size:90%;">Movies</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.2.2.1"><span class="ltx_text" id="S3.T3.3.2.2.1.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.2.2.2"><span class="ltx_text" id="S3.T3.3.2.2.2.1" style="font-size:90%;">Logloss</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.2.2.3"><span class="ltx_text" id="S3.T3.3.2.2.3.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.2.2.4"><span class="ltx_text" id="S3.T3.3.2.2.4.1" style="font-size:90%;">Logloss</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.3.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.3.3.1"><span class="ltx_text" id="S3.T3.3.3.3.1.1" style="font-size:90%;">UserIP-Tuning w.o. VQ</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.3.3.2"><span class="ltx_text" id="S3.T3.3.3.3.2.1" style="font-size:90%;">0.6201</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.3.3.3"><span class="ltx_text" id="S3.T3.3.3.3.3.1" style="font-size:90%;">0.5577</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.3.3.4"><span class="ltx_text" id="S3.T3.3.3.3.4.1" style="font-size:90%;">0.7966</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.3.3.5"><span class="ltx_text" id="S3.T3.3.3.3.5.1" style="font-size:90%;">0.4636</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.4.4">
<td class="ltx_td ltx_align_center" id="S3.T3.3.4.4.1"><span class="ltx_text" id="S3.T3.3.4.4.1.1" style="font-size:90%;">UserIP-Tuning</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.4.4.2"><span class="ltx_text ltx_font_bold" id="S3.T3.3.4.4.2.1" style="font-size:90%;">0.6269</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.4.4.3"><span class="ltx_text ltx_font_bold" id="S3.T3.3.4.4.3.1" style="font-size:90%;">0.5126</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.4.4.4"><span class="ltx_text ltx_font_bold" id="S3.T3.3.4.4.4.1" style="font-size:90%;">0.8184</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.4.4.5"><span class="ltx_text ltx_font_bold" id="S3.T3.3.4.4.5.1" style="font-size:90%;">0.4566</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.5.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.5.5.1" rowspan="2"><span class="ltx_text" id="S3.T3.3.5.5.1.1" style="font-size:90%;">Model component</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S3.T3.3.5.5.2"><span class="ltx_text" id="S3.T3.3.5.5.2.1" style="font-size:90%;">Games</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S3.T3.3.5.5.3"><span class="ltx_text" id="S3.T3.3.5.5.3.1" style="font-size:90%;">Yelp</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.6.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.6.6.1"><span class="ltx_text" id="S3.T3.3.6.6.1.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.6.6.2"><span class="ltx_text" id="S3.T3.3.6.6.2.1" style="font-size:90%;">Logloss</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.6.6.3"><span class="ltx_text" id="S3.T3.3.6.6.3.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.6.6.4"><span class="ltx_text" id="S3.T3.3.6.6.4.1" style="font-size:90%;">Logloss</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.7.7">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.7.7.1"><span class="ltx_text" id="S3.T3.3.7.7.1.1" style="font-size:90%;">UserIP-Tuning w.o. VQ</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.7.7.2"><span class="ltx_text" id="S3.T3.3.7.7.2.1" style="font-size:90%;">0.7340</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.7.7.3"><span class="ltx_text" id="S3.T3.3.7.7.3.1" style="font-size:90%;">0.8429</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.7.7.4"><span class="ltx_text" id="S3.T3.3.7.7.4.1" style="font-size:90%;">0.7277</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.7.7.5"><span class="ltx_text" id="S3.T3.3.7.7.5.1" style="font-size:90%;">0.5511</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.8.8">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.8.8.1"><span class="ltx_text" id="S3.T3.3.8.8.1.1" style="font-size:90%;">UserIP-Tuning</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.8.8.2"><span class="ltx_text ltx_font_bold" id="S3.T3.3.8.8.2.1" style="font-size:90%;">0.7393</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.8.8.3"><span class="ltx_text ltx_font_bold" id="S3.T3.3.8.8.3.1" style="font-size:90%;">0.7285</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.8.8.4"><span class="ltx_text ltx_font_bold" id="S3.T3.3.8.8.4.1" style="font-size:90%;">0.7314</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.3.8.8.5"><span class="ltx_text ltx_font_bold" id="S3.T3.3.8.8.5.1" style="font-size:90%;">0.5558</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S3.T4">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4. </span>Transferability Study from DCN to other recommendation model.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T4.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.3.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.3.1.1.1" rowspan="2"><span class="ltx_text" id="S3.T4.3.1.1.1.1" style="font-size:90%;">Functionaliy</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T4.3.1.1.2" rowspan="2"><span class="ltx_text" id="S3.T4.3.1.1.2.1" style="font-size:90%;">Models</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T4.3.1.1.3"><span class="ltx_text" id="S3.T4.3.1.1.3.1" style="font-size:90%;">Clothing</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T4.3.1.1.4"><span class="ltx_text" id="S3.T4.3.1.1.4.1" style="font-size:90%;">Movies</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T4.3.1.1.5"><span class="ltx_text" id="S3.T4.3.1.1.5.1" style="font-size:90%;">Games</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T4.3.1.1.6"><span class="ltx_text" id="S3.T4.3.1.1.6.1" style="font-size:90%;">Yelp</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.2.2.1"><span class="ltx_text" id="S3.T4.3.2.2.1.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.2.2.2"><span class="ltx_text" id="S3.T4.3.2.2.2.1" style="font-size:90%;">Logloss</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.2.2.3"><span class="ltx_text" id="S3.T4.3.2.2.3.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.2.2.4"><span class="ltx_text" id="S3.T4.3.2.2.4.1" style="font-size:90%;">Logloss</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.2.2.5"><span class="ltx_text" id="S3.T4.3.2.2.5.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.2.2.6"><span class="ltx_text" id="S3.T4.3.2.2.6.1" style="font-size:90%;">Logloss</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.2.2.7"><span class="ltx_text" id="S3.T4.3.2.2.7.1" style="font-size:90%;">AUC</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.2.2.8"><span class="ltx_text" id="S3.T4.3.2.2.8.1" style="font-size:90%;">Logloss</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.3.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.3.1"><span class="ltx_text" id="S3.T4.3.3.3.1.1" style="font-size:90%;">Training Surrogate</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.3.2"><span class="ltx_text" id="S3.T4.3.3.3.2.1" style="font-size:90%;">UserIP-DCN</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.3.3"><span class="ltx_text" id="S3.T4.3.3.3.3.1" style="font-size:90%;">0.6269</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.3.4"><span class="ltx_text" id="S3.T4.3.3.3.4.1" style="font-size:90%;">0.5126</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.3.5"><span class="ltx_text" id="S3.T4.3.3.3.5.1" style="font-size:90%;">0.8184</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.3.6"><span class="ltx_text" id="S3.T4.3.3.3.6.1" style="font-size:90%;">0.4566</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.3.7"><span class="ltx_text" id="S3.T4.3.3.3.7.1" style="font-size:90%;">0.7393</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.3.8"><span class="ltx_text" id="S3.T4.3.3.3.8.1" style="font-size:90%;">0.7285</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.3.9"><span class="ltx_text" id="S3.T4.3.3.3.9.1" style="font-size:90%;">0.7314</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.3.10"><span class="ltx_text" id="S3.T4.3.3.3.10.1" style="font-size:90%;">0.5558</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.4.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.4.4.1" rowspan="2"><span class="ltx_text" id="S3.T4.3.4.4.1.1" style="font-size:90%;">Transfer to PNN</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.4.4.2"><span class="ltx_text" id="S3.T4.3.4.4.2.1" style="font-size:90%;">PNN</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.4.4.3"><span class="ltx_text" id="S3.T4.3.4.4.3.1" style="font-size:90%;">0.6088</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.4.4.4"><span class="ltx_text" id="S3.T4.3.4.4.4.1" style="font-size:90%;">0.5874</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.4.4.5"><span class="ltx_text" id="S3.T4.3.4.4.5.1" style="font-size:90%;">0.8154</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.4.4.6"><span class="ltx_text" id="S3.T4.3.4.4.6.1" style="font-size:90%;">0.4570</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.4.4.7"><span class="ltx_text" id="S3.T4.3.4.4.7.1" style="font-size:90%;">0.7178</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.4.4.8"><span class="ltx_text" id="S3.T4.3.4.4.8.1" style="font-size:90%;">0.7874</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.4.4.9"><span class="ltx_text" id="S3.T4.3.4.4.9.1" style="font-size:90%;">0.7287</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.4.4.10"><span class="ltx_text" id="S3.T4.3.4.4.10.1" style="font-size:90%;">0.5574</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.5.5">
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.5.1"><span class="ltx_text" id="S3.T4.3.5.5.1.1" style="font-size:90%;">UserIP-PNN</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.5.2"><span class="ltx_text ltx_font_bold" id="S3.T4.3.5.5.2.1" style="font-size:90%;">0.6137</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.5.3"><span class="ltx_text ltx_font_bold" id="S3.T4.3.5.5.3.1" style="font-size:90%;">0.5383</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.5.4"><span class="ltx_text ltx_font_bold" id="S3.T4.3.5.5.4.1" style="font-size:90%;">0.8159</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.5.5"><span class="ltx_text ltx_font_bold" id="S3.T4.3.5.5.5.1" style="font-size:90%;">0.4566</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.5.6"><span class="ltx_text ltx_font_bold" id="S3.T4.3.5.5.6.1" style="font-size:90%;">0.7208</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.5.7"><span class="ltx_text ltx_font_bold" id="S3.T4.3.5.5.7.1" style="font-size:90%;">0.8076</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.5.8"><span class="ltx_text ltx_font_bold" id="S3.T4.3.5.5.8.1" style="font-size:90%;">0.7284</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.5.5.9"><span class="ltx_text ltx_font_bold" id="S3.T4.3.5.5.9.1" style="font-size:90%;">0.5578</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.6.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.6.6.1" rowspan="2"><span class="ltx_text" id="S3.T4.3.6.6.1.1" style="font-size:90%;">Transfer to ONN</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.6.6.2"><span class="ltx_text" id="S3.T4.3.6.6.2.1" style="font-size:90%;">ONN</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.6.6.3"><span class="ltx_text" id="S3.T4.3.6.6.3.1" style="font-size:90%;">0.6094</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.6.6.4"><span class="ltx_text" id="S3.T4.3.6.6.4.1" style="font-size:90%;">0.5903</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.6.6.5"><span class="ltx_text" id="S3.T4.3.6.6.5.1" style="font-size:90%;">0.8121</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.6.6.6"><span class="ltx_text" id="S3.T4.3.6.6.6.1" style="font-size:90%;">0.4598</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.6.6.7"><span class="ltx_text" id="S3.T4.3.6.6.7.1" style="font-size:90%;">0.7223</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.6.6.8"><span class="ltx_text" id="S3.T4.3.6.6.8.1" style="font-size:90%;">0.8658</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.6.6.9"><span class="ltx_text" id="S3.T4.3.6.6.9.1" style="font-size:90%;">0.7253</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.6.6.10"><span class="ltx_text" id="S3.T4.3.6.6.10.1" style="font-size:90%;">0.5598</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.7.7">
<td class="ltx_td ltx_align_center" id="S3.T4.3.7.7.1"><span class="ltx_text" id="S3.T4.3.7.7.1.1" style="font-size:90%;">UserIP-ONN</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.7.7.2"><span class="ltx_text ltx_font_bold" id="S3.T4.3.7.7.2.1" style="font-size:90%;">0.6140</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.7.7.3"><span class="ltx_text ltx_font_bold" id="S3.T4.3.7.7.3.1" style="font-size:90%;">0.5021</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.7.7.4"><span class="ltx_text ltx_font_bold" id="S3.T4.3.7.7.4.1" style="font-size:90%;">0.8098</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.7.7.5"><span class="ltx_text ltx_font_bold" id="S3.T4.3.7.7.5.1" style="font-size:90%;">0.4626</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.7.7.6"><span class="ltx_text ltx_font_bold" id="S3.T4.3.7.7.6.1" style="font-size:90%;">0.7289</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.7.7.7"><span class="ltx_text ltx_font_bold" id="S3.T4.3.7.7.7.1" style="font-size:90%;">0.8395</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.7.7.8"><span class="ltx_text ltx_font_bold" id="S3.T4.3.7.7.8.1" style="font-size:90%;">0.7246</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.3.7.7.9"><span class="ltx_text ltx_font_bold" id="S3.T4.3.7.7.9.1" style="font-size:90%;">0.5613</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.8.8">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T4.3.8.8.1" rowspan="2"><span class="ltx_text" id="S3.T4.3.8.8.1.1" style="font-size:90%;">Transfer to DCNv2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.8.8.2"><span class="ltx_text" id="S3.T4.3.8.8.2.1" style="font-size:90%;">DCNv2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.8.8.3"><span class="ltx_text" id="S3.T4.3.8.8.3.1" style="font-size:90%;">0.6148</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.8.8.4"><span class="ltx_text" id="S3.T4.3.8.8.4.1" style="font-size:90%;">0.5848</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.8.8.5"><span class="ltx_text" id="S3.T4.3.8.8.5.1" style="font-size:90%;">0.8134</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.8.8.6"><span class="ltx_text" id="S3.T4.3.8.8.6.1" style="font-size:90%;">0.4643</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.8.8.7"><span class="ltx_text" id="S3.T4.3.8.8.7.1" style="font-size:90%;">0.7263</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.8.8.8"><span class="ltx_text" id="S3.T4.3.8.8.8.1" style="font-size:90%;">0.7991</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.8.8.9"><span class="ltx_text" id="S3.T4.3.8.8.9.1" style="font-size:90%;">0.7237</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.8.8.10"><span class="ltx_text" id="S3.T4.3.8.8.10.1" style="font-size:90%;">0.5704</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.3.9.9">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.9.9.1"><span class="ltx_text" id="S3.T4.3.9.9.1.1" style="font-size:90%;">UserIP-DCNv2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.9.9.2"><span class="ltx_text ltx_font_bold" id="S3.T4.3.9.9.2.1" style="font-size:90%;">0.6263</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.9.9.3"><span class="ltx_text ltx_font_bold" id="S3.T4.3.9.9.3.1" style="font-size:90%;">0.5125</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.9.9.4"><span class="ltx_text ltx_font_bold" id="S3.T4.3.9.9.4.1" style="font-size:90%;">0.8180</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.9.9.5"><span class="ltx_text ltx_font_bold" id="S3.T4.3.9.9.5.1" style="font-size:90%;">0.4544</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.9.9.6"><span class="ltx_text ltx_font_bold" id="S3.T4.3.9.9.6.1" style="font-size:90%;">0.7324</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.9.9.7"><span class="ltx_text ltx_font_bold" id="S3.T4.3.9.9.7.1" style="font-size:90%;">0.8625</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.9.9.8"><span class="ltx_text ltx_font_bold" id="S3.T4.3.9.9.8.1" style="font-size:90%;">0.7308</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.3.9.9.9"><span class="ltx_text ltx_font_bold" id="S3.T4.3.9.9.9.1" style="font-size:90%;">0.5569</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6. </span>Transferability Study (RQ2)</h3>
<div class="ltx_para" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.2">This part investigates the transferability of UserIP-Tuning. Specifically, we study whether the user profiles indices trained with UserIP-Tuning can be applied to other downstream models <math alttext="Recommender" class="ltx_Math" display="inline" id="S3.SS6.p1.1.m1.1"><semantics id="S3.SS6.p1.1.m1.1a"><mrow id="S3.SS6.p1.1.m1.1.1" xref="S3.SS6.p1.1.m1.1.1.cmml"><mi id="S3.SS6.p1.1.m1.1.1.2" xref="S3.SS6.p1.1.m1.1.1.2.cmml">R</mi><mo id="S3.SS6.p1.1.m1.1.1.1" xref="S3.SS6.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS6.p1.1.m1.1.1.3" xref="S3.SS6.p1.1.m1.1.1.3.cmml">e</mi><mo id="S3.SS6.p1.1.m1.1.1.1a" xref="S3.SS6.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS6.p1.1.m1.1.1.4" xref="S3.SS6.p1.1.m1.1.1.4.cmml">c</mi><mo id="S3.SS6.p1.1.m1.1.1.1b" xref="S3.SS6.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS6.p1.1.m1.1.1.5" xref="S3.SS6.p1.1.m1.1.1.5.cmml">o</mi><mo id="S3.SS6.p1.1.m1.1.1.1c" xref="S3.SS6.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS6.p1.1.m1.1.1.6" xref="S3.SS6.p1.1.m1.1.1.6.cmml">m</mi><mo id="S3.SS6.p1.1.m1.1.1.1d" xref="S3.SS6.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS6.p1.1.m1.1.1.7" xref="S3.SS6.p1.1.m1.1.1.7.cmml">m</mi><mo id="S3.SS6.p1.1.m1.1.1.1e" xref="S3.SS6.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS6.p1.1.m1.1.1.8" xref="S3.SS6.p1.1.m1.1.1.8.cmml">e</mi><mo id="S3.SS6.p1.1.m1.1.1.1f" xref="S3.SS6.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS6.p1.1.m1.1.1.9" xref="S3.SS6.p1.1.m1.1.1.9.cmml">n</mi><mo id="S3.SS6.p1.1.m1.1.1.1g" xref="S3.SS6.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS6.p1.1.m1.1.1.10" xref="S3.SS6.p1.1.m1.1.1.10.cmml">d</mi><mo id="S3.SS6.p1.1.m1.1.1.1h" xref="S3.SS6.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS6.p1.1.m1.1.1.11" xref="S3.SS6.p1.1.m1.1.1.11.cmml">e</mi><mo id="S3.SS6.p1.1.m1.1.1.1i" xref="S3.SS6.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS6.p1.1.m1.1.1.12" xref="S3.SS6.p1.1.m1.1.1.12.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.1.m1.1b"><apply id="S3.SS6.p1.1.m1.1.1.cmml" xref="S3.SS6.p1.1.m1.1.1"><times id="S3.SS6.p1.1.m1.1.1.1.cmml" xref="S3.SS6.p1.1.m1.1.1.1"></times><ci id="S3.SS6.p1.1.m1.1.1.2.cmml" xref="S3.SS6.p1.1.m1.1.1.2">𝑅</ci><ci id="S3.SS6.p1.1.m1.1.1.3.cmml" xref="S3.SS6.p1.1.m1.1.1.3">𝑒</ci><ci id="S3.SS6.p1.1.m1.1.1.4.cmml" xref="S3.SS6.p1.1.m1.1.1.4">𝑐</ci><ci id="S3.SS6.p1.1.m1.1.1.5.cmml" xref="S3.SS6.p1.1.m1.1.1.5">𝑜</ci><ci id="S3.SS6.p1.1.m1.1.1.6.cmml" xref="S3.SS6.p1.1.m1.1.1.6">𝑚</ci><ci id="S3.SS6.p1.1.m1.1.1.7.cmml" xref="S3.SS6.p1.1.m1.1.1.7">𝑚</ci><ci id="S3.SS6.p1.1.m1.1.1.8.cmml" xref="S3.SS6.p1.1.m1.1.1.8">𝑒</ci><ci id="S3.SS6.p1.1.m1.1.1.9.cmml" xref="S3.SS6.p1.1.m1.1.1.9">𝑛</ci><ci id="S3.SS6.p1.1.m1.1.1.10.cmml" xref="S3.SS6.p1.1.m1.1.1.10">𝑑</ci><ci id="S3.SS6.p1.1.m1.1.1.11.cmml" xref="S3.SS6.p1.1.m1.1.1.11">𝑒</ci><ci id="S3.SS6.p1.1.m1.1.1.12.cmml" xref="S3.SS6.p1.1.m1.1.1.12">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.1.m1.1c">Recommender</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.1.m1.1d">italic_R italic_e italic_c italic_o italic_m italic_m italic_e italic_n italic_d italic_e italic_r</annotation></semantics></math>[<math alttext="\cdot" class="ltx_Math" display="inline" id="S3.SS6.p1.2.m2.1"><semantics id="S3.SS6.p1.2.m2.1a"><mo id="S3.SS6.p1.2.m2.1.1" xref="S3.SS6.p1.2.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.2.m2.1b"><ci id="S3.SS6.p1.2.m2.1.1.cmml" xref="S3.SS6.p1.2.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.2.m2.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.2.m2.1d">⋅</annotation></semantics></math>] and further examine the generalization transferability of our model.</p>
</div>
<div class="ltx_para" id="S3.SS6.p2">
<p class="ltx_p" id="S3.SS6.p2.1">The user profiles indices in UserIP-Tuning is leveraged to train the recommenders such as PNN <cite class="ltx_cite ltx_citemacro_citep">(Qu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib24" title="">2016</a>)</cite>, ONN <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib41" title="">2020</a>)</cite>, and DCNv2 <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib33" title="">2021</a>)</cite> and conduct experiments on four datasets. The results are demonstrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.T4" title="Table 4 ‣ 3.5. Overall Performance Comparison (RQ1) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">4</span></a>, where “UserIP-Tuning-PNN” represents the corresponding indices features in UserIP-Tuning are added to “PNN” recommender, similarly, the performance of “UserIP-Tuning-ONN” and “UserIP-Tuning-DCNv2” is evaluated. From the table, we see that UserIP-Tuning with PNN ( ONN or DCNv2) performs superior to the original recommender PNN (ONN or DCNv2). This phenomenon indicates that the user latent profiles variables and corresponding indices can strengthen multiple recommenders’ performance. Furthermore, UserIP-Tuning’s generalization transferability is validated across different downstream recommenders.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.7. </span>Hyper-parameter &amp; Ablation Studies (RQ3)</h3>
<div class="ltx_para" id="S3.SS7.p1">
<p class="ltx_p" id="S3.SS7.p1.1">In this subsection, to examine important hyper-parameter of UserIP-Tuning, we systematically change the profile codebook size <math alttext="K_{m}" class="ltx_Math" display="inline" id="S3.SS7.p1.1.m1.1"><semantics id="S3.SS7.p1.1.m1.1a"><msub id="S3.SS7.p1.1.m1.1.1" xref="S3.SS7.p1.1.m1.1.1.cmml"><mi id="S3.SS7.p1.1.m1.1.1.2" xref="S3.SS7.p1.1.m1.1.1.2.cmml">K</mi><mi id="S3.SS7.p1.1.m1.1.1.3" xref="S3.SS7.p1.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS7.p1.1.m1.1b"><apply id="S3.SS7.p1.1.m1.1.1.cmml" xref="S3.SS7.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS7.p1.1.m1.1.1.1.cmml" xref="S3.SS7.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS7.p1.1.m1.1.1.2.cmml" xref="S3.SS7.p1.1.m1.1.1.2">𝐾</ci><ci id="S3.SS7.p1.1.m1.1.1.3.cmml" xref="S3.SS7.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p1.1.m1.1c">K_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p1.1.m1.1d">italic_K start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> in the VQ module on four datasets.</p>
</div>
<div class="ltx_para" id="S3.SS7.p2">
<p class="ltx_p" id="S3.SS7.p2.1">The results demonstrate that the model performance is worse as the profile codebook size becomes larger. As illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.F5" title="Figure 5 ‣ 3.7. Hyper-parameter &amp; Ablation Studies (RQ3) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">5</span></a>, the AUC decreases and the Logloss increases with the expansion of the hobby profile codebook size. User profile indices that are divided into excessively redundant clusters become scattered and fail to capture accurate user profiles features.</p>
</div>
<figure class="ltx_figure" id="S3.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="232" id="S3.F5.sf1.g1" src="x6.png" width="407"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf1.2.1.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="S3.F5.sf1.3.2" style="font-size:80%;">Model performance on Clothing</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="232" id="S3.F5.sf2.g1" src="x7.png" width="407"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf2.2.1.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="S3.F5.sf2.3.2" style="font-size:80%;">Model performance on Movies</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="232" id="S3.F5.sf3.g1" src="x8.png" width="407"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf3.2.1.1" style="font-size:80%;">(c)</span> </span><span class="ltx_text" id="S3.F5.sf3.3.2" style="font-size:80%;">Model performance on Games</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="232" id="S3.F5.sf4.g1" src="x9.png" width="407"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf4.2.1.1" style="font-size:80%;">(d)</span> </span><span class="ltx_text" id="S3.F5.sf4.3.2" style="font-size:80%;">Model performance on Yelp</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>The different VQ codebook sizes for hobby profile hyper-parameter on four datasets. </figcaption>
</figure>
<div class="ltx_para" id="S3.SS7.p3">
<p class="ltx_p" id="S3.SS7.p3.4">Moreover, we vary the user background profile codebook size <math alttext="K_{2}" class="ltx_Math" display="inline" id="S3.SS7.p3.1.m1.1"><semantics id="S3.SS7.p3.1.m1.1a"><msub id="S3.SS7.p3.1.m1.1.1" xref="S3.SS7.p3.1.m1.1.1.cmml"><mi id="S3.SS7.p3.1.m1.1.1.2" xref="S3.SS7.p3.1.m1.1.1.2.cmml">K</mi><mn id="S3.SS7.p3.1.m1.1.1.3" xref="S3.SS7.p3.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS7.p3.1.m1.1b"><apply id="S3.SS7.p3.1.m1.1.1.cmml" xref="S3.SS7.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS7.p3.1.m1.1.1.1.cmml" xref="S3.SS7.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS7.p3.1.m1.1.1.2.cmml" xref="S3.SS7.p3.1.m1.1.1.2">𝐾</ci><cn id="S3.SS7.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.SS7.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p3.1.m1.1c">K_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p3.1.m1.1d">italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> from 3 to 81, and the experimental results are depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.F6" title="Figure 6 ‣ 3.7. Hyper-parameter &amp; Ablation Studies (RQ3) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">6</span></a>. Notably, when <math alttext="K_{2}" class="ltx_Math" display="inline" id="S3.SS7.p3.2.m2.1"><semantics id="S3.SS7.p3.2.m2.1a"><msub id="S3.SS7.p3.2.m2.1.1" xref="S3.SS7.p3.2.m2.1.1.cmml"><mi id="S3.SS7.p3.2.m2.1.1.2" xref="S3.SS7.p3.2.m2.1.1.2.cmml">K</mi><mn id="S3.SS7.p3.2.m2.1.1.3" xref="S3.SS7.p3.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS7.p3.2.m2.1b"><apply id="S3.SS7.p3.2.m2.1.1.cmml" xref="S3.SS7.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS7.p3.2.m2.1.1.1.cmml" xref="S3.SS7.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS7.p3.2.m2.1.1.2.cmml" xref="S3.SS7.p3.2.m2.1.1.2">𝐾</ci><cn id="S3.SS7.p3.2.m2.1.1.3.cmml" type="integer" xref="S3.SS7.p3.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p3.2.m2.1c">K_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p3.2.m2.1d">italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> equals 3, the AUC reaches 73.931% and the Logloss decreases to 0.72851. These findings suggest that UserIP-Tuning achieves superior performance when <math alttext="K_{2}" class="ltx_Math" display="inline" id="S3.SS7.p3.3.m3.1"><semantics id="S3.SS7.p3.3.m3.1a"><msub id="S3.SS7.p3.3.m3.1.1" xref="S3.SS7.p3.3.m3.1.1.cmml"><mi id="S3.SS7.p3.3.m3.1.1.2" xref="S3.SS7.p3.3.m3.1.1.2.cmml">K</mi><mn id="S3.SS7.p3.3.m3.1.1.3" xref="S3.SS7.p3.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS7.p3.3.m3.1b"><apply id="S3.SS7.p3.3.m3.1.1.cmml" xref="S3.SS7.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS7.p3.3.m3.1.1.1.cmml" xref="S3.SS7.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS7.p3.3.m3.1.1.2.cmml" xref="S3.SS7.p3.3.m3.1.1.2">𝐾</ci><cn id="S3.SS7.p3.3.m3.1.1.3.cmml" type="integer" xref="S3.SS7.p3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p3.3.m3.1c">K_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p3.3.m3.1d">italic_K start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is smaller. Having fewer index clusters proves beneficial for learning user profiling and improving recommendation accuracy. Furthermore, the effectiveness of the VQ module is verified, and Table <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.T3" title="Table 3 ‣ 3.5. Overall Performance Comparison (RQ1) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">3</span></a> demonstrates the results of ablation study. When the VQ module is removed from UserIP-Tuning, the latent profiles variables <math alttext="\textit{E}_{cep}(\theta^{m})" class="ltx_Math" display="inline" id="S3.SS7.p3.4.m4.1"><semantics id="S3.SS7.p3.4.m4.1a"><mrow id="S3.SS7.p3.4.m4.1.1" xref="S3.SS7.p3.4.m4.1.1.cmml"><msub id="S3.SS7.p3.4.m4.1.1.3" xref="S3.SS7.p3.4.m4.1.1.3.cmml"><mtext class="ltx_mathvariant_italic" id="S3.SS7.p3.4.m4.1.1.3.2" xref="S3.SS7.p3.4.m4.1.1.3.2a.cmml">E</mtext><mrow id="S3.SS7.p3.4.m4.1.1.3.3" xref="S3.SS7.p3.4.m4.1.1.3.3.cmml"><mi id="S3.SS7.p3.4.m4.1.1.3.3.2" xref="S3.SS7.p3.4.m4.1.1.3.3.2.cmml">c</mi><mo id="S3.SS7.p3.4.m4.1.1.3.3.1" xref="S3.SS7.p3.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS7.p3.4.m4.1.1.3.3.3" xref="S3.SS7.p3.4.m4.1.1.3.3.3.cmml">e</mi><mo id="S3.SS7.p3.4.m4.1.1.3.3.1a" xref="S3.SS7.p3.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS7.p3.4.m4.1.1.3.3.4" xref="S3.SS7.p3.4.m4.1.1.3.3.4.cmml">p</mi></mrow></msub><mo id="S3.SS7.p3.4.m4.1.1.2" xref="S3.SS7.p3.4.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS7.p3.4.m4.1.1.1.1" xref="S3.SS7.p3.4.m4.1.1.1.1.1.cmml"><mo id="S3.SS7.p3.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS7.p3.4.m4.1.1.1.1.1.cmml">(</mo><msup id="S3.SS7.p3.4.m4.1.1.1.1.1" xref="S3.SS7.p3.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS7.p3.4.m4.1.1.1.1.1.2" xref="S3.SS7.p3.4.m4.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.SS7.p3.4.m4.1.1.1.1.1.3" xref="S3.SS7.p3.4.m4.1.1.1.1.1.3.cmml">m</mi></msup><mo id="S3.SS7.p3.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS7.p3.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS7.p3.4.m4.1b"><apply id="S3.SS7.p3.4.m4.1.1.cmml" xref="S3.SS7.p3.4.m4.1.1"><times id="S3.SS7.p3.4.m4.1.1.2.cmml" xref="S3.SS7.p3.4.m4.1.1.2"></times><apply id="S3.SS7.p3.4.m4.1.1.3.cmml" xref="S3.SS7.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS7.p3.4.m4.1.1.3.1.cmml" xref="S3.SS7.p3.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS7.p3.4.m4.1.1.3.2a.cmml" xref="S3.SS7.p3.4.m4.1.1.3.2"><mtext class="ltx_mathvariant_italic" id="S3.SS7.p3.4.m4.1.1.3.2.cmml" xref="S3.SS7.p3.4.m4.1.1.3.2">E</mtext></ci><apply id="S3.SS7.p3.4.m4.1.1.3.3.cmml" xref="S3.SS7.p3.4.m4.1.1.3.3"><times id="S3.SS7.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS7.p3.4.m4.1.1.3.3.1"></times><ci id="S3.SS7.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS7.p3.4.m4.1.1.3.3.2">𝑐</ci><ci id="S3.SS7.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS7.p3.4.m4.1.1.3.3.3">𝑒</ci><ci id="S3.SS7.p3.4.m4.1.1.3.3.4.cmml" xref="S3.SS7.p3.4.m4.1.1.3.3.4">𝑝</ci></apply></apply><apply id="S3.SS7.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS7.p3.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS7.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS7.p3.4.m4.1.1.1.1">superscript</csymbol><ci id="S3.SS7.p3.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS7.p3.4.m4.1.1.1.1.1.2">𝜃</ci><ci id="S3.SS7.p3.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS7.p3.4.m4.1.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p3.4.m4.1c">\textit{E}_{cep}(\theta^{m})</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p3.4.m4.1d">E start_POSTSUBSCRIPT italic_c italic_e italic_p end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT )</annotation></semantics></math> feed into downstream recommendation models and the model performance is inferior to UserIP-Tuning.</p>
</div>
<figure class="ltx_figure" id="S3.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F6.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="238" id="S3.F6.1.g1" src="x10.png" width="406"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F6.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="240" id="S3.F6.2.g1" src="x11.png" width="406"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Background profile codebook size hyper-parameter on Amazon video games.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.8. </span>Case Study (RQ4)</h3>
<section class="ltx_subsubsection" id="S3.SS8.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.8.1. </span>Case Study on Explainability</h4>
<div class="ltx_para" id="S3.SS8.SSS1.p1">
<p class="ltx_p" id="S3.SS8.SSS1.p1.1">This subsection conducts the case study about users’ latent profiles variables. We randomly select a user’s latent profiles variables to retrieve the cluster words and corresponding embeddings in LLMs’ semantic space, which is concluded in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.T5" title="Table 5 ‣ 3.8.1. Case Study on Explainability ‣ 3.8. Case Study (RQ4) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure class="ltx_table" id="S3.T5">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 5. </span>User hobby and background latent profile retrieval</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T5.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T5.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T5.3.1.1.1"><span class="ltx_text" id="S3.T5.3.1.1.1.1" style="font-size:90%;">User-id</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.3.1.1.2"><span class="ltx_text" id="S3.T5.3.1.1.2.1" style="font-size:90%;">Hobby latent variable retrieval</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T5.3.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T5.3.2.1.1"><span class="ltx_text" id="S3.T5.3.2.1.1.1" style="font-size:90%;">255</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.3.2.1.2"><span class="ltx_text" id="S3.T5.3.2.1.2.1" style="font-size:90%;">[Gotham; Batman; Spectrum; Viper]</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.3.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T5.3.3.2.1"><span class="ltx_text" id="S3.T5.3.3.2.1.1" style="font-size:90%;">136</span></th>
<td class="ltx_td ltx_align_center" id="S3.T5.3.3.2.2"><span class="ltx_text" id="S3.T5.3.3.2.2.1" style="font-size:90%;">[Mortal, Magic, Gorge, expansions]</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.3.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T5.3.4.3.1"><span class="ltx_text" id="S3.T5.3.4.3.1.1" style="font-size:90%;">User-id</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.3.4.3.2"><span class="ltx_text" id="S3.T5.3.4.3.2.1" style="font-size:90%;">Background latent variable retrieval</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.3.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T5.3.5.4.1"><span class="ltx_text" id="S3.T5.3.5.4.1.1" style="font-size:90%;">255</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.3.5.4.2"><span class="ltx_text" id="S3.T5.3.5.4.2.1" style="font-size:90%;">[XBOX; LOL; WR; shoot]</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.3.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S3.T5.3.6.5.1"><span class="ltx_text" id="S3.T5.3.6.5.1.1" style="font-size:90%;">136</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.3.6.5.2"><span class="ltx_text" id="S3.T5.3.6.5.2.1" style="font-size:90%;">[Genesis, Homer, Zombie, AnyWay]</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S3.SS8.SSS1.p2">
<p class="ltx_p" id="S3.SS8.SSS1.p2.1">We can observe that this user “255” is fond of superhero video games such as “Batman”, “Spectrum” heroes and “Gotham” city. His background retrieval is related to mortal and magic game backgrounds. User “136” likes LOL: WR (League of Legends: Wild Rift) and shooting games. Moreover, his background retrieval words reveal that he uses home video game console made by Genesis game system, and plays Zombie or AnyWay adventure games. The phenomenon examines the corresponding inferred user profile is explainable and useful in practice. In Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS8" title="3.8. Case Study (RQ4) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">3.8</span></a>, case study about users’ latent profiles variables is conducted and shows our method solves the textual noise issue.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS8.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.8.2. </span>Case Study on Textual Noise</h4>
<div class="ltx_para" id="S3.SS8.SSS2.p1">
<p class="ltx_p" id="S3.SS8.SSS2.p1.1">We randomly select seven users on Amazon Video Games dataset to investigate the textual noise relationship between users’ hobby profile variables and the inference text. Before training UserIP-Tuning, we obtain the users’ hobby profile vectors that are randomly produced. The attention weight values are calculated between users’ hobby profile vectors and each token from the inferred sentence “The user likes Gotham stealth shooting action games”. We normalize these weights ranging from 0 to 1. In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.F7" title="Figure 7 ‣ 3.8.2. Case Study on Textual Noise ‣ 3.8. Case Study (RQ4) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">7</span></a> (a), we observe that the textual noise “The user” has more weight value.
In comparison, the inferred user profile has less weight value before training in the left figure since their soft embeddings are randomly initialized. The relationship between users’ hobby profile and the corresponding text (“Gotham”, “Stealth”, “Shooting”, “Action”) is unobvious. After training the soft prompt tuning, we see that the weight is increased a lot, depicted as dark blue in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.F7" title="Figure 7 ‣ 3.8.2. Case Study on Textual Noise ‣ 3.8. Case Study (RQ4) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">7</span></a> (b), indicating an augmented relationship. The weight of textual noise “The user” is obviously deduced after training, appearing as light blue.</p>
</div>
<div class="ltx_para" id="S3.SS8.SSS2.p2">
<p class="ltx_p" id="S3.SS8.SSS2.p2.1">Additionally, we examine the presence of textual noise in user background profiles. Similarly, we randomly select six users from the Amazon Video Games dataset and compute their attention weights between users’ hobby profile variables and the inference text. Prior to training UserIP-Tuning, the user’s background profile variable is randomly generated. The attention weights depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.F7" title="Figure 7 ‣ 3.8.2. Case Study on Textual Noise ‣ 3.8. Case Study (RQ4) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">7</span></a> (c) are predominantly concentrated on textual noise, particularly on phrases like “The spending level of this user is”. However, after training, the weights associated with textual noise diminish, while the weights corresponding to key information significantly increase, appearing as dark blue in the visualization. Consequently, the issue of textual noise is greatly mitigated.</p>
</div>
<figure class="ltx_figure" id="S3.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="309" id="S3.F7.sf1.g1" src="x12.png" width="373"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F7.sf1.2.1.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="S3.F7.sf1.3.2" style="font-size:80%;">The textual noise relationship for hobby profile before training</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="307" id="S3.F7.sf2.g1" src="x13.png" width="374"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F7.sf2.2.1.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="S3.F7.sf2.3.2" style="font-size:80%;">The textual noise relationship for hobby profile after training</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F7.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="309" id="S3.F7.sf3.g1" src="x14.png" width="373"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F7.sf3.2.1.1" style="font-size:80%;">(c)</span> </span><span class="ltx_text" id="S3.F7.sf3.3.2" style="font-size:80%;">The textual noise relationship for background profile before training</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F7.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="310" id="S3.F7.sf4.g1" src="x15.png" width="374"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F7.sf4.2.1.1" style="font-size:80%;">(d)</span> </span><span class="ltx_text" id="S3.F7.sf4.3.2" style="font-size:80%;">The textual noise relationship for background profile after training</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7. </span>The textual noise relationship between the users’ hobby and background profiles variables and the inference text on Games dataset. </figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS9">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.9. </span>Industrial Application Study (RQ5)</h3>
<div class="ltx_para" id="S3.SS9.p1">
<p class="ltx_p" id="S3.SS9.p1.1">In the subsection, we examine the model performance and inference time of UserIP-Tuning on a large-scale industrial dataset collected from Huawei platform. This dataset records seven days user behavior data, including the user interaction behavior (e.g., list of items clicked by the user), item original attribute (e.g., item title), and contextual features (e.g., time), etc.</p>
</div>
<figure class="ltx_table" id="S3.T6">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 6. </span>The inference time on Huawei platform</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T6.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T6.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T6.3.1.1.1"><span class="ltx_text" id="S3.T6.3.1.1.1.1" style="font-size:90%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T6.3.1.1.2"><span class="ltx_text" id="S3.T6.3.1.1.2.1" style="font-size:90%;">Inference time (s)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T6.3.1.1.3"><span class="ltx_text" id="S3.T6.3.1.1.3.1" style="font-size:90%;">AUC</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T6.3.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.3.2.1.1"><span class="ltx_text" id="S3.T6.3.2.1.1.1" style="font-size:90%;">DCN</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.3.2.1.2"><span class="ltx_text" id="S3.T6.3.2.1.2.1" style="font-size:90%;">0.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.3.2.1.3"><span class="ltx_text" id="S3.T6.3.2.1.3.1" style="font-size:90%;">0.76394</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.3.3.2">
<td class="ltx_td ltx_align_center" id="S3.T6.3.3.2.1"><span class="ltx_text" id="S3.T6.3.3.2.1.1" style="font-size:90%;">KAR + DCN</span></td>
<td class="ltx_td ltx_align_center" id="S3.T6.3.3.2.2"><span class="ltx_text" id="S3.T6.3.3.2.2.1" style="font-size:90%;">4.78</span></td>
<td class="ltx_td ltx_align_center" id="S3.T6.3.3.2.3"><span class="ltx_text" id="S3.T6.3.3.2.3.1" style="font-size:90%;">0.78663</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.3.4.3">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.3.4.3.1"><span class="ltx_text" id="S3.T6.3.4.3.1.1" style="font-size:90%;">UserIP-Tuning + DCN</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.3.4.3.2"><span class="ltx_text" id="S3.T6.3.4.3.2.1" style="font-size:90%;">1.21</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T6.3.4.3.3"><span class="ltx_text" id="S3.T6.3.4.3.3.1" style="font-size:90%;">0.79972</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S3.SS9.p2">
<p class="ltx_p" id="S3.SS9.p2.1">We conclude the offline experimental results for inference time on Huawei in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.T6" title="Table 6 ‣ 3.9. Industrial Application Study (RQ5) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">6</span></a> . From Table <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.T6" title="Table 6 ‣ 3.9. Industrial Application Study (RQ5) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">6</span></a>, our model, DCN + UserIP-Tuning, achieves 1.21 s/10000 instances, which is 0.28 seconds larger than DCN’s inference time. The baseline KAR’s inference time is much larger than DCN’s, up to 4.78 seconds, which is almost 4 times over UserIP-Tuning’s.
Hence, it is efficient in reasoning capabilities and recommendation performance in industrial scenarios.
In Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#S3.SS9" title="3.9. Industrial Application Study (RQ5) ‣ 3. Experiment ‣ Prompt Tuning as User Inherent Profile Inference Machine"><span class="ltx_text ltx_ref_tag">3.9</span></a>, we examine the model performance of UserIP-Tuning on Huawei, which demonstrates the reasoning efficiency.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Related Works</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">This section briefly introduces the previous studies about LLMs-based user profile inference for recommender systems. In recent years, the LLMs achieves remarkable in-context learning capability. Existing works focus on using LLMs to implicitly infer the task-related user profile information.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">In the field of in-context learning, <cite class="ltx_cite ltx_citemacro_citet">Xie et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib39" title="">2022</a>)</cite> firstly design a latent document-level user profile variable through the pretrained LLMs to predict coherent next tokens. The LLMs implicitly perform inference while the pretraining data distribution and task-specific data distribution are hidden Markov models.
<cite class="ltx_cite ltx_citemacro_citet">Min et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib23" title="">2022</a>)</cite> devise a new few-shot learning method where LLMs are meta-trained and conditional on training examples to recover related tasks and infer predictions.
<cite class="ltx_cite ltx_citemacro_citet">Wang et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib34" title="">2023</a>)</cite> propose an algorithm in LLMs for estimating latent user profile and selecting optimal demonstrations from training data. The researchers construct the Bayes optimal classifier to infer the task-related topic.
<cite class="ltx_cite ltx_citemacro_citet">Chan et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib4" title="">2022</a>)</cite> investigate a skewed Zipfian data distribution with high burstiness in LLMs to infer the emergent in-context learning behaviour.
<cite class="ltx_cite ltx_citemacro_citet">Li et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib18" title="">2023c</a>)</cite> prove LLMs can apply near-optimal algorithms on traditional linear regression tasks with i.i.d. dynamic data.
To the best of our knowledge, we are the first to investigate the LLMs inference for deep recommender systems.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We propose a novel LLMs based latent profile inference model, UserIP-Tuning, to augment recommendation performance and the training efficiency by finding user latent profile variables and lightweight indices.
The causal relationship between latent profile and interaction history is considered and a novel UserIP quantization module is designed to categorize user latent profile embedding and output users’ nearest profile indices, which extract useful collaborative signals from these embeddings.
The proposed method addresses the LLMs-based recommendation collaborative problem and eliminates the textual noises and out-of-range results.
Importantly, the training and reasoning capabilities of UserIP-Tuning are improved significantly.
We empirically verify the effectiveness of UserIP-Tuning on four real-life datasets.
In the future, we will explore more industrial applications.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bao et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Keqin Bao, Jizhi Zhang, Yang Zhang, Wenjie Wang, Fuli Feng, and Xiangnan He. 2023.

</span>
<span class="ltx_bibblock">TALLRec: An Effective and Efficient Tuning Framework to Align Large Language Model with Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Proceedings of the 17th ACM Conference on Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib2.4.2">(RecSys ’23)</em>. New York, NY, USA, 1007–1014.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3604915.3608857" title="">https://doi.org/10.1145/3604915.3608857</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al<span class="ltx_text" id="bib.bib3.3.3.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yuzhe Cai, Shaoguang Mao, Wenshan Wu, Zehua Wang, Yaobo Liang, Tao Ge, Chenfei Wu, Wang You, Ting Song, Yan Xia, et al<span class="ltx_text" id="bib.bib3.4.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Low-code llm: Visual programming over llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.5.1">arXiv preprint arXiv:2304.08103</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chan et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Stephanie Chan, Adam Santoro, Andrew Lampinen, Jane Wang, Aaditya Singh, Pierre Richemond, James McClelland, and Felix Hill. 2022.

</span>
<span class="ltx_bibblock">Data distributional properties drive emergent in-context learning in transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Advances in Neural Information Processing Systems</em> 35 (2022), 18878–18891.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Weiyu Cheng, Yanyan Shen, and Linpeng Huang. 2020.

</span>
<span class="ltx_bibblock">Adaptive factorization network: Learning adaptive-order feature interactions. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 34. 3609–3616.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">De Santis et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Enrico De Santis, Alessio Martino, and Antonello Rizzi. 2024.

</span>
<span class="ltx_bibblock">Human versus Machine Intelligence: Assessing Natural Language Generation Models through Complex Systems Theory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">IEEE Transactions on Pattern Analysis and Machine Intelligence</em> (2024), 1–18.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/TPAMI.2024.3358168" title="">https://doi.org/10.1109/TPAMI.2024.3358168</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubois et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yann Dubois, Chen Xuechen Li, Rohan Taori, Tianyi Zhang, Ishaan Gulrajani, Jimmy Ba, Carlos Guestrin, Percy S Liang, and Tatsunori B Hashimoto. 2024.

</span>
<span class="ltx_bibblock">Alpacafarm: A simulation framework for methods that learn from human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Advances in Neural Information Processing Systems</em> 36 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Huifeng Guo, Ruiming Tang, Yunming Ye, Zhenguo Li, and Xiuqiang He. 2017.

</span>
<span class="ltx_bibblock">DeepFM: A Factorization-Machine Based Neural Network for CTR Prediction <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">(IJCAI’17)</em>. AAAI Press, 1725–1731.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yupeng Hou, Junjie Zhang, Zihan Lin, Hongyu Lu, Ruobing Xie, Julian McAuley, and Wayne Xin Zhao. 2023.

</span>
<span class="ltx_bibblock">Large language models are zero-shot rankers for recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">arXiv preprint arXiv:2305.08845</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Tongwen Huang, Zhiqi Zhang, and Junlin Zhang. 2019.

</span>
<span class="ltx_bibblock">FiBiNET: combining feature importance and bilinear feature interaction for click-through rate prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Proceedings of the 13th ACM Conference on Recommender Systems</em>. 169–177.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Gautier Izacard, Patrick Lewis, Maria Lomeli, Lucas Hosseini, Fabio Petroni, Timo Schick, Jane Dwivedi-Yu, Armand Joulin, Sebastian Riedel, and Edouard Grave. 2023.

</span>
<span class="ltx_bibblock">Atlas: Few-shot Learning with Retrieval Augmented Language Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Journal of Machine Learning Research</em> 24, 251 (2023), 1–43.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://jmlr.org/papers/v24/23-0037.html" title="">http://jmlr.org/papers/v24/23-0037.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Juan et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Yuchin Juan, Yong Zhuang, Wei-Sheng Chin, and Chih-Jen Lin. 2016.

</span>
<span class="ltx_bibblock">Field-aware Factorization Machines for CTR Prediction <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">(RecSys ’16)</em>. New York, NY, USA, 43–50.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2959100.2959134" title="">https://doi.org/10.1145/2959100.2959134</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kenton and Toutanova (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin Ming-Wei Chang Kenton and Lee Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock">BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of NAACL-HLT</em>. 4171–4186.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lester et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Brian Lester, Rami Al-Rfou, and Noah Constant. 2021.

</span>
<span class="ltx_bibblock">The Power of Scale for Parameter-Efficient Prompt Tuning. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>. 3045–3059.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2023d)</span>
<span class="ltx_bibblock">
Lei Li, Yongfeng Zhang, and Li Chen. 2023d.

</span>
<span class="ltx_bibblock">Personalized Prompt Learning for Explainable Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">ACM Transactions on Information Systems</em> 41, 4, Article 103 (mar 2023), 26 pages.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3580488" title="">https://doi.org/10.1145/3580488</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Xiangyang Li, Bo Chen, Lu Hou, and Ruiming Tang. 2023a.

</span>
<span class="ltx_bibblock">CTRL: Connect Tabular and Language Model for CTR Prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">arXiv preprint arXiv:2306.02841</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Xinhang Li, Chong Chen, Xiangyu Zhao, Yong Zhang, and Chunxiao Xing. 2023b.

</span>
<span class="ltx_bibblock">E4SRec: An Elegant Effective Efficient Extensible Solution of Large Language Models for Sequential Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">arXiv preprint arXiv:2312.02443</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2023c)</span>
<span class="ltx_bibblock">
Yingcong Li, M Emrullah Ildiz, Dimitris Papailiopoulos, and Samet Oymak. 2023c.

</span>
<span class="ltx_bibblock">Transformers as algorithms: Generalization and implicit model selection in in-context learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">arXiv preprint arXiv:2301.07067</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liao et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jiayi Liao, Sihang Li, Zhengyi Yang, Jiancan Wu, Yancheng Yuan, Xiang Wang, and Xiangnan He. 2023.

</span>
<span class="ltx_bibblock">LLaRA: Aligning Large Language Models with Sequential Recommenders.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">arXiv preprint arXiv:2312.02445</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jianghao Lin, Rong Shan, Chenxu Zhu, Kounianhua Du, Bo Chen, Shigang Quan, Ruiming Tang, Yong Yu, and Weinan Zhang. 2024.

</span>
<span class="ltx_bibblock">ReLLa: Retrieval-enhanced Large Language Models for Lifelong Sequential Behavior Comprehension in Recommendation.

</span>
<span class="ltx_bibblock">(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Wantong Lu, Yantao Yu, Yongzhe Chang, Zhen Wang, Chenhui Li, and Bo Yuan. 2021.

</span>
<span class="ltx_bibblock">A dual input-aware factorization machine for CTR prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the twenty-ninth international conference on international joint conferences on artificial intelligence</em>. 3139–3145.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Sichun Luo, Bowei He, Haohan Zhao, Yinya Huang, Aojun Zhou, Zongpeng Li, Yuanzhang Xiao, Mingjie Zhan, and Linqi Song. 2023.

</span>
<span class="ltx_bibblock">RecRanker: Instruction Tuning Large Language Model as Ranker for Top-k Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">arXiv preprint arXiv:2312.16018</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Min et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Sewon Min, Mike Lewis, Luke Zettlemoyer, and Hannaneh Hajishirzi. 2022.

</span>
<span class="ltx_bibblock">MetaICL: Learning to Learn In Context. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of the 2022 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</em>, Marine Carpuat, Marie-Catherine de Marneffe, and Ivan Vladimir Meza Ruiz (Eds.). Association for Computational Linguistics, Seattle, United States, 2791–2809.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/2022.naacl-main.201" title="">https://doi.org/10.18653/v1/2022.naacl-main.201</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qu et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Yanru Qu, Han Cai, Kan Ren, Weinan Zhang, Yong Yu, Ying Wen, and Jun Wang. 2016.

</span>
<span class="ltx_bibblock">Product-based neural networks for user response prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">2016 IEEE 16th international conference on data mining (ICDM)</em>. IEEE, 1149–1154.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajput et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shashank Rajput, Nikhil Mehta, Anima Singh, Raghunandan H. Keshavan, Trung Vu, Lukasz Heldt, Lichan Hong, Yi Tay, Vinh Q. Tran, Jonah Samost, Maciej Kula, Ed H. Chi, and Maheswaran Sathiamoorthy. 2023.

</span>
<span class="ltx_bibblock">Recommender Systems with Generative Retrieval.

</span>
<span class="ltx_bibblock">(2023).

</span>
<span class="ltx_bibblock">arXiv:2305.05065 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Weiping Song, Chence Shi, Zhiping Xiao, Zhijian Duan, Yewen Xu, Ming Zhang, and Jian Tang. 2019.

</span>
<span class="ltx_bibblock">Autoint: Automatic feature interaction learning via self-attentive neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>. 1161–1170.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yiming Tan, Dehai Min, Yu Li, Wenbo Li, Nan Hu, Yongrui Chen, and Guilin Qi. 2023.

</span>
<span class="ltx_bibblock">Evaluation of ChatGPT as a question answering system for answering complex questions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">arXiv preprint arXiv:2303.07992</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taori et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Rohan Taori, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos Guestrin, Percy Liang, and Tatsunori B Hashimoto. 2023.

</span>
<span class="ltx_bibblock">Stanford alpaca: an instruction-following llama model (2023).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">URL https://github. com/tatsu-lab/stanford_alpaca</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al<span class="ltx_text" id="bib.bib29.3.3.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al<span class="ltx_text" id="bib.bib29.4.1">.</span> 2023a.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.5.1">arXiv preprint arXiv:2302.13971</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al<span class="ltx_text" id="bib.bib30.3.3.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al<span class="ltx_text" id="bib.bib30.4.1">.</span> 2023b.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.5.1">arXiv preprint arXiv:2307.09288</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van den Oord et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Aaron van den Oord, Oriol Vinyals, and Koray Kavukcuoglu. 2017.

</span>
<span class="ltx_bibblock">Neural discrete representation learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Proceedings of the 31st International Conference on Neural Information Processing Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib31.4.2">(NIPS’17)</em>. Red Hook, NY, USA, 6309–6318.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ruoxi Wang, Bin Fu, Gang Fu, and Mingliang Wang. 2017.

</span>
<span class="ltx_bibblock">Deep &amp; Cross Network for Ad Click Predictions. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Proceedings of the ADKDD’17</em> <em class="ltx_emph ltx_font_italic" id="bib.bib32.4.2">(ADKDD’17)</em>. New York, NY, USA, Article 12, 7 pages.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3124749.3124754" title="">https://doi.org/10.1145/3124749.3124754</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Ruoxi Wang, Rakesh Shivanna, Derek Cheng, Sagar Jain, Dong Lin, Lichan Hong, and Ed Chi. 2021.

</span>
<span class="ltx_bibblock">Dcn v2: Improved deep &amp; cross network and practical lessons for web-scale learning to rank systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Proceedings of the web conference 2021</em>. 1785–1797.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xinyi Wang, Wanrong Zhu, and William Yang Wang. 2023.

</span>
<span class="ltx_bibblock">Large language models are implicitly topic models: Explaining and finding good demonstrations for in-context learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">arXiv preprint arXiv:2301.11916</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span class="ltx_text" id="bib.bib35.3.3.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Fei Xia, Ed Chi, Quoc V Le, Denny Zhou, et al<span class="ltx_text" id="bib.bib35.4.1">.</span> 2022.

</span>
<span class="ltx_bibblock">Chain-of-thought prompting elicits reasoning in large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.5.1">Advances in neural information processing systems</em> 35 (2022), 24824–24837.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Le Wu, Yonghui Yang, Kun Zhang, Richang Hong, Yanjie Fu, and Meng Wang. 2020.

</span>
<span class="ltx_bibblock">Joint item recommendation and attribute inference: An adaptive graph convolutional network approach. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval</em>. 679–688.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xi et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yunjia Xi, Weiwen Liu, Jianghao Lin, Jieming Zhu, Bo Chen, Ruiming Tang, Weinan Zhang, Rui Zhang, and Yong Yu. 2023.

</span>
<span class="ltx_bibblock">Towards Open-World Recommendation with Knowledge Augmentation from Large Language Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">arXiv preprint arXiv:2306.10933</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Jun Xiao, Hao Ye, Xiangnan He, Hanwang Zhang, Fei Wu, and Tat-Seng Chua. 2017.

</span>
<span class="ltx_bibblock">Attentional factorization machines: learning the weight of feature interactions via attention networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">Proceedings of the 26th International Joint Conference on Artificial Intelligence</em> <em class="ltx_emph ltx_font_italic" id="bib.bib38.4.2">(IJCAI’17)</em>. 3119–3125.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Sang Michael Xie, Aditi Raghunathan, Percy Liang, and Tengyu Ma. 2022.

</span>
<span class="ltx_bibblock">An Explanation of In-context Learning as Implicit Bayesian Inference. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">International Conference on Learning Representations</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Ling Yan, Wu-Jun Li, Gui-Rong Xue, and Dingyi Han. 2014.

</span>
<span class="ltx_bibblock">Coupled group lasso for web-scale ctr prediction in display advertising. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">International conference on machine learning</em>. PMLR, 802–810.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yi Yang, Baile Xu, Shaofeng Shen, Furao Shen, and Jian Zhao. 2020.

</span>
<span class="ltx_bibblock">Operation-aware neural networks for user response prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Neural Networks</em> 121 (2020), 161–168.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yang Zhang, Fuli Feng, Jizhi Zhang, Keqin Bao, Qifan Wang, and Xiangnan He. 2023.

</span>
<span class="ltx_bibblock">CoLLM: Integrating Collaborative Embeddings into Large Language Models for Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">arXiv preprint arXiv:2310.19488</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Bowen Zheng, Yupeng Hou, Hongyu Lu, Yu Chen, Wayne Xin Zhao, and Ji-Rong Wen. 2023.

</span>
<span class="ltx_bibblock">Adapting large language models by integrating collaborative semantics for recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">arXiv preprint arXiv:2311.09049</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yadong Zhou, Zhihao Ding, Xiaoming Liu, Chao Shen, Lingling Tong, and Xiaohong Guan. 2022.

</span>
<span class="ltx_bibblock">Infer-AVAE: An attribute inference model based on adversarial variational autoencoder.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">Neurocomputing</em> 483 (2022), 105–115.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In this section, we detail the theoretical analysis about Bayesian LLMs for concept latent variables.</p>
</div>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1. </span>Theoretical Analysis</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.7">We first suppose that the LLMs pre-trained data distribution <math alttext="P_{LLM}" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.1"><semantics id="A1.SS1.p1.1.m1.1a"><msub id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml"><mi id="A1.SS1.p1.1.m1.1.1.2" xref="A1.SS1.p1.1.m1.1.1.2.cmml">P</mi><mrow id="A1.SS1.p1.1.m1.1.1.3" xref="A1.SS1.p1.1.m1.1.1.3.cmml"><mi id="A1.SS1.p1.1.m1.1.1.3.2" xref="A1.SS1.p1.1.m1.1.1.3.2.cmml">L</mi><mo id="A1.SS1.p1.1.m1.1.1.3.1" xref="A1.SS1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS1.p1.1.m1.1.1.3.3" xref="A1.SS1.p1.1.m1.1.1.3.3.cmml">L</mi><mo id="A1.SS1.p1.1.m1.1.1.3.1a" xref="A1.SS1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS1.p1.1.m1.1.1.3.4" xref="A1.SS1.p1.1.m1.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><apply id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.1.m1.1.1.2">𝑃</ci><apply id="A1.SS1.p1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3"><times id="A1.SS1.p1.1.m1.1.1.3.1.cmml" xref="A1.SS1.p1.1.m1.1.1.3.1"></times><ci id="A1.SS1.p1.1.m1.1.1.3.2.cmml" xref="A1.SS1.p1.1.m1.1.1.3.2">𝐿</ci><ci id="A1.SS1.p1.1.m1.1.1.3.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3.3">𝐿</ci><ci id="A1.SS1.p1.1.m1.1.1.3.4.cmml" xref="A1.SS1.p1.1.m1.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">P_{LLM}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_L italic_L italic_M end_POSTSUBSCRIPT</annotation></semantics></math> properly approximates the assumed data distribution <math alttext="P" class="ltx_Math" display="inline" id="A1.SS1.p1.2.m2.1"><semantics id="A1.SS1.p1.2.m2.1a"><mi id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><ci id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.2.m2.1d">italic_P</annotation></semantics></math>.
After we add the concept tokens, the prompt becomes a sequence of user information <math alttext="x" class="ltx_Math" display="inline" id="A1.SS1.p1.3.m3.1"><semantics id="A1.SS1.p1.3.m3.1a"><mi id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><ci id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.3.m3.1d">italic_x</annotation></semantics></math>, concept tokens <math alttext="\theta" class="ltx_Math" display="inline" id="A1.SS1.p1.4.m4.1"><semantics id="A1.SS1.p1.4.m4.1a"><mi id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><ci id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.4.m4.1d">italic_θ</annotation></semantics></math> and task description <math alttext="D_{task}" class="ltx_Math" display="inline" id="A1.SS1.p1.5.m5.1"><semantics id="A1.SS1.p1.5.m5.1a"><msub id="A1.SS1.p1.5.m5.1.1" xref="A1.SS1.p1.5.m5.1.1.cmml"><mi id="A1.SS1.p1.5.m5.1.1.2" xref="A1.SS1.p1.5.m5.1.1.2.cmml">D</mi><mrow id="A1.SS1.p1.5.m5.1.1.3" xref="A1.SS1.p1.5.m5.1.1.3.cmml"><mi id="A1.SS1.p1.5.m5.1.1.3.2" xref="A1.SS1.p1.5.m5.1.1.3.2.cmml">t</mi><mo id="A1.SS1.p1.5.m5.1.1.3.1" xref="A1.SS1.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="A1.SS1.p1.5.m5.1.1.3.3" xref="A1.SS1.p1.5.m5.1.1.3.3.cmml">a</mi><mo id="A1.SS1.p1.5.m5.1.1.3.1a" xref="A1.SS1.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="A1.SS1.p1.5.m5.1.1.3.4" xref="A1.SS1.p1.5.m5.1.1.3.4.cmml">s</mi><mo id="A1.SS1.p1.5.m5.1.1.3.1b" xref="A1.SS1.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="A1.SS1.p1.5.m5.1.1.3.5" xref="A1.SS1.p1.5.m5.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m5.1b"><apply id="A1.SS1.p1.5.m5.1.1.cmml" xref="A1.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.5.m5.1.1.1.cmml" xref="A1.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="A1.SS1.p1.5.m5.1.1.2.cmml" xref="A1.SS1.p1.5.m5.1.1.2">𝐷</ci><apply id="A1.SS1.p1.5.m5.1.1.3.cmml" xref="A1.SS1.p1.5.m5.1.1.3"><times id="A1.SS1.p1.5.m5.1.1.3.1.cmml" xref="A1.SS1.p1.5.m5.1.1.3.1"></times><ci id="A1.SS1.p1.5.m5.1.1.3.2.cmml" xref="A1.SS1.p1.5.m5.1.1.3.2">𝑡</ci><ci id="A1.SS1.p1.5.m5.1.1.3.3.cmml" xref="A1.SS1.p1.5.m5.1.1.3.3">𝑎</ci><ci id="A1.SS1.p1.5.m5.1.1.3.4.cmml" xref="A1.SS1.p1.5.m5.1.1.3.4">𝑠</ci><ci id="A1.SS1.p1.5.m5.1.1.3.5.cmml" xref="A1.SS1.p1.5.m5.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m5.1c">D_{task}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.5.m5.1d">italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. Specifically, we concatenate the concept token <math alttext="\theta" class="ltx_Math" display="inline" id="A1.SS1.p1.6.m6.1"><semantics id="A1.SS1.p1.6.m6.1a"><mi id="A1.SS1.p1.6.m6.1.1" xref="A1.SS1.p1.6.m6.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.m6.1b"><ci id="A1.SS1.p1.6.m6.1.1.cmml" xref="A1.SS1.p1.6.m6.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.m6.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.6.m6.1d">italic_θ</annotation></semantics></math> after user information <math alttext="x" class="ltx_Math" display="inline" id="A1.SS1.p1.7.m7.1"><semantics id="A1.SS1.p1.7.m7.1a"><mi id="A1.SS1.p1.7.m7.1.1" xref="A1.SS1.p1.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.7.m7.1b"><ci id="A1.SS1.p1.7.m7.1.1.cmml" xref="A1.SS1.p1.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.7.m7.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.7.m7.1d">italic_x</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[L_{M}^{{}^{\prime}},D_{task}]=[x^{1},\theta^{1},o^{del},x^{2},\theta^{2},o^{%
del},...,x^{M},\theta^{M},o^{del},D_{task}]" class="ltx_Math" display="block" id="A1.Ex1.m1.13"><semantics id="A1.Ex1.m1.13a"><mrow id="A1.Ex1.m1.13.13" xref="A1.Ex1.m1.13.13.cmml"><mrow id="A1.Ex1.m1.3.3.2.2" xref="A1.Ex1.m1.3.3.2.3.cmml"><mo id="A1.Ex1.m1.3.3.2.2.3" stretchy="false" xref="A1.Ex1.m1.3.3.2.3.cmml">[</mo><msubsup id="A1.Ex1.m1.2.2.1.1.1" xref="A1.Ex1.m1.2.2.1.1.1.cmml"><mi id="A1.Ex1.m1.2.2.1.1.1.2.2" xref="A1.Ex1.m1.2.2.1.1.1.2.2.cmml">L</mi><mi id="A1.Ex1.m1.2.2.1.1.1.2.3" xref="A1.Ex1.m1.2.2.1.1.1.2.3.cmml">M</mi><msup id="A1.Ex1.m1.2.2.1.1.1.3" xref="A1.Ex1.m1.2.2.1.1.1.3.cmml"><mi id="A1.Ex1.m1.2.2.1.1.1.3a" xref="A1.Ex1.m1.2.2.1.1.1.3.cmml"></mi><mo id="A1.Ex1.m1.2.2.1.1.1.3.1" xref="A1.Ex1.m1.2.2.1.1.1.3.1.cmml">′</mo></msup></msubsup><mo id="A1.Ex1.m1.3.3.2.2.4" xref="A1.Ex1.m1.3.3.2.3.cmml">,</mo><msub id="A1.Ex1.m1.3.3.2.2.2" xref="A1.Ex1.m1.3.3.2.2.2.cmml"><mi id="A1.Ex1.m1.3.3.2.2.2.2" xref="A1.Ex1.m1.3.3.2.2.2.2.cmml">D</mi><mrow id="A1.Ex1.m1.3.3.2.2.2.3" xref="A1.Ex1.m1.3.3.2.2.2.3.cmml"><mi id="A1.Ex1.m1.3.3.2.2.2.3.2" xref="A1.Ex1.m1.3.3.2.2.2.3.2.cmml">t</mi><mo id="A1.Ex1.m1.3.3.2.2.2.3.1" xref="A1.Ex1.m1.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.3.3.2.2.2.3.3" xref="A1.Ex1.m1.3.3.2.2.2.3.3.cmml">a</mi><mo id="A1.Ex1.m1.3.3.2.2.2.3.1a" xref="A1.Ex1.m1.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.3.3.2.2.2.3.4" xref="A1.Ex1.m1.3.3.2.2.2.3.4.cmml">s</mi><mo id="A1.Ex1.m1.3.3.2.2.2.3.1b" xref="A1.Ex1.m1.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.3.3.2.2.2.3.5" xref="A1.Ex1.m1.3.3.2.2.2.3.5.cmml">k</mi></mrow></msub><mo id="A1.Ex1.m1.3.3.2.2.5" stretchy="false" xref="A1.Ex1.m1.3.3.2.3.cmml">]</mo></mrow><mo id="A1.Ex1.m1.13.13.13" xref="A1.Ex1.m1.13.13.13.cmml">=</mo><mrow id="A1.Ex1.m1.13.13.12.10" xref="A1.Ex1.m1.13.13.12.11.cmml"><mo id="A1.Ex1.m1.13.13.12.10.11" stretchy="false" xref="A1.Ex1.m1.13.13.12.11.cmml">[</mo><msup id="A1.Ex1.m1.4.4.3.1.1" xref="A1.Ex1.m1.4.4.3.1.1.cmml"><mi id="A1.Ex1.m1.4.4.3.1.1.2" xref="A1.Ex1.m1.4.4.3.1.1.2.cmml">x</mi><mn id="A1.Ex1.m1.4.4.3.1.1.3" xref="A1.Ex1.m1.4.4.3.1.1.3.cmml">1</mn></msup><mo id="A1.Ex1.m1.13.13.12.10.12" xref="A1.Ex1.m1.13.13.12.11.cmml">,</mo><msup id="A1.Ex1.m1.5.5.4.2.2" xref="A1.Ex1.m1.5.5.4.2.2.cmml"><mi id="A1.Ex1.m1.5.5.4.2.2.2" xref="A1.Ex1.m1.5.5.4.2.2.2.cmml">θ</mi><mn id="A1.Ex1.m1.5.5.4.2.2.3" xref="A1.Ex1.m1.5.5.4.2.2.3.cmml">1</mn></msup><mo id="A1.Ex1.m1.13.13.12.10.13" xref="A1.Ex1.m1.13.13.12.11.cmml">,</mo><msup id="A1.Ex1.m1.6.6.5.3.3" xref="A1.Ex1.m1.6.6.5.3.3.cmml"><mi id="A1.Ex1.m1.6.6.5.3.3.2" xref="A1.Ex1.m1.6.6.5.3.3.2.cmml">o</mi><mrow id="A1.Ex1.m1.6.6.5.3.3.3" xref="A1.Ex1.m1.6.6.5.3.3.3.cmml"><mi id="A1.Ex1.m1.6.6.5.3.3.3.2" xref="A1.Ex1.m1.6.6.5.3.3.3.2.cmml">d</mi><mo id="A1.Ex1.m1.6.6.5.3.3.3.1" xref="A1.Ex1.m1.6.6.5.3.3.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.6.6.5.3.3.3.3" xref="A1.Ex1.m1.6.6.5.3.3.3.3.cmml">e</mi><mo id="A1.Ex1.m1.6.6.5.3.3.3.1a" xref="A1.Ex1.m1.6.6.5.3.3.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.6.6.5.3.3.3.4" xref="A1.Ex1.m1.6.6.5.3.3.3.4.cmml">l</mi></mrow></msup><mo id="A1.Ex1.m1.13.13.12.10.14" xref="A1.Ex1.m1.13.13.12.11.cmml">,</mo><msup id="A1.Ex1.m1.7.7.6.4.4" xref="A1.Ex1.m1.7.7.6.4.4.cmml"><mi id="A1.Ex1.m1.7.7.6.4.4.2" xref="A1.Ex1.m1.7.7.6.4.4.2.cmml">x</mi><mn id="A1.Ex1.m1.7.7.6.4.4.3" xref="A1.Ex1.m1.7.7.6.4.4.3.cmml">2</mn></msup><mo id="A1.Ex1.m1.13.13.12.10.15" xref="A1.Ex1.m1.13.13.12.11.cmml">,</mo><msup id="A1.Ex1.m1.8.8.7.5.5" xref="A1.Ex1.m1.8.8.7.5.5.cmml"><mi id="A1.Ex1.m1.8.8.7.5.5.2" xref="A1.Ex1.m1.8.8.7.5.5.2.cmml">θ</mi><mn id="A1.Ex1.m1.8.8.7.5.5.3" xref="A1.Ex1.m1.8.8.7.5.5.3.cmml">2</mn></msup><mo id="A1.Ex1.m1.13.13.12.10.16" xref="A1.Ex1.m1.13.13.12.11.cmml">,</mo><msup id="A1.Ex1.m1.9.9.8.6.6" xref="A1.Ex1.m1.9.9.8.6.6.cmml"><mi id="A1.Ex1.m1.9.9.8.6.6.2" xref="A1.Ex1.m1.9.9.8.6.6.2.cmml">o</mi><mrow id="A1.Ex1.m1.9.9.8.6.6.3" xref="A1.Ex1.m1.9.9.8.6.6.3.cmml"><mi id="A1.Ex1.m1.9.9.8.6.6.3.2" xref="A1.Ex1.m1.9.9.8.6.6.3.2.cmml">d</mi><mo id="A1.Ex1.m1.9.9.8.6.6.3.1" xref="A1.Ex1.m1.9.9.8.6.6.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.9.9.8.6.6.3.3" xref="A1.Ex1.m1.9.9.8.6.6.3.3.cmml">e</mi><mo id="A1.Ex1.m1.9.9.8.6.6.3.1a" xref="A1.Ex1.m1.9.9.8.6.6.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.9.9.8.6.6.3.4" xref="A1.Ex1.m1.9.9.8.6.6.3.4.cmml">l</mi></mrow></msup><mo id="A1.Ex1.m1.13.13.12.10.17" xref="A1.Ex1.m1.13.13.12.11.cmml">,</mo><mi id="A1.Ex1.m1.1.1" mathvariant="normal" xref="A1.Ex1.m1.1.1.cmml">…</mi><mo id="A1.Ex1.m1.13.13.12.10.18" xref="A1.Ex1.m1.13.13.12.11.cmml">,</mo><msup id="A1.Ex1.m1.10.10.9.7.7" xref="A1.Ex1.m1.10.10.9.7.7.cmml"><mi id="A1.Ex1.m1.10.10.9.7.7.2" xref="A1.Ex1.m1.10.10.9.7.7.2.cmml">x</mi><mi id="A1.Ex1.m1.10.10.9.7.7.3" xref="A1.Ex1.m1.10.10.9.7.7.3.cmml">M</mi></msup><mo id="A1.Ex1.m1.13.13.12.10.19" xref="A1.Ex1.m1.13.13.12.11.cmml">,</mo><msup id="A1.Ex1.m1.11.11.10.8.8" xref="A1.Ex1.m1.11.11.10.8.8.cmml"><mi id="A1.Ex1.m1.11.11.10.8.8.2" xref="A1.Ex1.m1.11.11.10.8.8.2.cmml">θ</mi><mi id="A1.Ex1.m1.11.11.10.8.8.3" xref="A1.Ex1.m1.11.11.10.8.8.3.cmml">M</mi></msup><mo id="A1.Ex1.m1.13.13.12.10.20" xref="A1.Ex1.m1.13.13.12.11.cmml">,</mo><msup id="A1.Ex1.m1.12.12.11.9.9" xref="A1.Ex1.m1.12.12.11.9.9.cmml"><mi id="A1.Ex1.m1.12.12.11.9.9.2" xref="A1.Ex1.m1.12.12.11.9.9.2.cmml">o</mi><mrow id="A1.Ex1.m1.12.12.11.9.9.3" xref="A1.Ex1.m1.12.12.11.9.9.3.cmml"><mi id="A1.Ex1.m1.12.12.11.9.9.3.2" xref="A1.Ex1.m1.12.12.11.9.9.3.2.cmml">d</mi><mo id="A1.Ex1.m1.12.12.11.9.9.3.1" xref="A1.Ex1.m1.12.12.11.9.9.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.12.12.11.9.9.3.3" xref="A1.Ex1.m1.12.12.11.9.9.3.3.cmml">e</mi><mo id="A1.Ex1.m1.12.12.11.9.9.3.1a" xref="A1.Ex1.m1.12.12.11.9.9.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.12.12.11.9.9.3.4" xref="A1.Ex1.m1.12.12.11.9.9.3.4.cmml">l</mi></mrow></msup><mo id="A1.Ex1.m1.13.13.12.10.21" xref="A1.Ex1.m1.13.13.12.11.cmml">,</mo><msub id="A1.Ex1.m1.13.13.12.10.10" xref="A1.Ex1.m1.13.13.12.10.10.cmml"><mi id="A1.Ex1.m1.13.13.12.10.10.2" xref="A1.Ex1.m1.13.13.12.10.10.2.cmml">D</mi><mrow id="A1.Ex1.m1.13.13.12.10.10.3" xref="A1.Ex1.m1.13.13.12.10.10.3.cmml"><mi id="A1.Ex1.m1.13.13.12.10.10.3.2" xref="A1.Ex1.m1.13.13.12.10.10.3.2.cmml">t</mi><mo id="A1.Ex1.m1.13.13.12.10.10.3.1" xref="A1.Ex1.m1.13.13.12.10.10.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.13.13.12.10.10.3.3" xref="A1.Ex1.m1.13.13.12.10.10.3.3.cmml">a</mi><mo id="A1.Ex1.m1.13.13.12.10.10.3.1a" xref="A1.Ex1.m1.13.13.12.10.10.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.13.13.12.10.10.3.4" xref="A1.Ex1.m1.13.13.12.10.10.3.4.cmml">s</mi><mo id="A1.Ex1.m1.13.13.12.10.10.3.1b" xref="A1.Ex1.m1.13.13.12.10.10.3.1.cmml">⁢</mo><mi id="A1.Ex1.m1.13.13.12.10.10.3.5" xref="A1.Ex1.m1.13.13.12.10.10.3.5.cmml">k</mi></mrow></msub><mo id="A1.Ex1.m1.13.13.12.10.22" stretchy="false" xref="A1.Ex1.m1.13.13.12.11.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex1.m1.13b"><apply id="A1.Ex1.m1.13.13.cmml" xref="A1.Ex1.m1.13.13"><eq id="A1.Ex1.m1.13.13.13.cmml" xref="A1.Ex1.m1.13.13.13"></eq><interval closure="closed" id="A1.Ex1.m1.3.3.2.3.cmml" xref="A1.Ex1.m1.3.3.2.2"><apply id="A1.Ex1.m1.2.2.1.1.1.cmml" xref="A1.Ex1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.Ex1.m1.2.2.1.1.1.1.cmml" xref="A1.Ex1.m1.2.2.1.1.1">superscript</csymbol><apply id="A1.Ex1.m1.2.2.1.1.1.2.cmml" xref="A1.Ex1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.Ex1.m1.2.2.1.1.1.2.1.cmml" xref="A1.Ex1.m1.2.2.1.1.1">subscript</csymbol><ci id="A1.Ex1.m1.2.2.1.1.1.2.2.cmml" xref="A1.Ex1.m1.2.2.1.1.1.2.2">𝐿</ci><ci id="A1.Ex1.m1.2.2.1.1.1.2.3.cmml" xref="A1.Ex1.m1.2.2.1.1.1.2.3">𝑀</ci></apply><apply id="A1.Ex1.m1.2.2.1.1.1.3.cmml" xref="A1.Ex1.m1.2.2.1.1.1.3"><ci id="A1.Ex1.m1.2.2.1.1.1.3.1.cmml" xref="A1.Ex1.m1.2.2.1.1.1.3.1">′</ci></apply></apply><apply id="A1.Ex1.m1.3.3.2.2.2.cmml" xref="A1.Ex1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.3.3.2.2.2.1.cmml" xref="A1.Ex1.m1.3.3.2.2.2">subscript</csymbol><ci id="A1.Ex1.m1.3.3.2.2.2.2.cmml" xref="A1.Ex1.m1.3.3.2.2.2.2">𝐷</ci><apply id="A1.Ex1.m1.3.3.2.2.2.3.cmml" xref="A1.Ex1.m1.3.3.2.2.2.3"><times id="A1.Ex1.m1.3.3.2.2.2.3.1.cmml" xref="A1.Ex1.m1.3.3.2.2.2.3.1"></times><ci id="A1.Ex1.m1.3.3.2.2.2.3.2.cmml" xref="A1.Ex1.m1.3.3.2.2.2.3.2">𝑡</ci><ci id="A1.Ex1.m1.3.3.2.2.2.3.3.cmml" xref="A1.Ex1.m1.3.3.2.2.2.3.3">𝑎</ci><ci id="A1.Ex1.m1.3.3.2.2.2.3.4.cmml" xref="A1.Ex1.m1.3.3.2.2.2.3.4">𝑠</ci><ci id="A1.Ex1.m1.3.3.2.2.2.3.5.cmml" xref="A1.Ex1.m1.3.3.2.2.2.3.5">𝑘</ci></apply></apply></interval><list id="A1.Ex1.m1.13.13.12.11.cmml" xref="A1.Ex1.m1.13.13.12.10"><apply id="A1.Ex1.m1.4.4.3.1.1.cmml" xref="A1.Ex1.m1.4.4.3.1.1"><csymbol cd="ambiguous" id="A1.Ex1.m1.4.4.3.1.1.1.cmml" xref="A1.Ex1.m1.4.4.3.1.1">superscript</csymbol><ci id="A1.Ex1.m1.4.4.3.1.1.2.cmml" xref="A1.Ex1.m1.4.4.3.1.1.2">𝑥</ci><cn id="A1.Ex1.m1.4.4.3.1.1.3.cmml" type="integer" xref="A1.Ex1.m1.4.4.3.1.1.3">1</cn></apply><apply id="A1.Ex1.m1.5.5.4.2.2.cmml" xref="A1.Ex1.m1.5.5.4.2.2"><csymbol cd="ambiguous" id="A1.Ex1.m1.5.5.4.2.2.1.cmml" xref="A1.Ex1.m1.5.5.4.2.2">superscript</csymbol><ci id="A1.Ex1.m1.5.5.4.2.2.2.cmml" xref="A1.Ex1.m1.5.5.4.2.2.2">𝜃</ci><cn id="A1.Ex1.m1.5.5.4.2.2.3.cmml" type="integer" xref="A1.Ex1.m1.5.5.4.2.2.3">1</cn></apply><apply id="A1.Ex1.m1.6.6.5.3.3.cmml" xref="A1.Ex1.m1.6.6.5.3.3"><csymbol cd="ambiguous" id="A1.Ex1.m1.6.6.5.3.3.1.cmml" xref="A1.Ex1.m1.6.6.5.3.3">superscript</csymbol><ci id="A1.Ex1.m1.6.6.5.3.3.2.cmml" xref="A1.Ex1.m1.6.6.5.3.3.2">𝑜</ci><apply id="A1.Ex1.m1.6.6.5.3.3.3.cmml" xref="A1.Ex1.m1.6.6.5.3.3.3"><times id="A1.Ex1.m1.6.6.5.3.3.3.1.cmml" xref="A1.Ex1.m1.6.6.5.3.3.3.1"></times><ci id="A1.Ex1.m1.6.6.5.3.3.3.2.cmml" xref="A1.Ex1.m1.6.6.5.3.3.3.2">𝑑</ci><ci id="A1.Ex1.m1.6.6.5.3.3.3.3.cmml" xref="A1.Ex1.m1.6.6.5.3.3.3.3">𝑒</ci><ci id="A1.Ex1.m1.6.6.5.3.3.3.4.cmml" xref="A1.Ex1.m1.6.6.5.3.3.3.4">𝑙</ci></apply></apply><apply id="A1.Ex1.m1.7.7.6.4.4.cmml" xref="A1.Ex1.m1.7.7.6.4.4"><csymbol cd="ambiguous" id="A1.Ex1.m1.7.7.6.4.4.1.cmml" xref="A1.Ex1.m1.7.7.6.4.4">superscript</csymbol><ci id="A1.Ex1.m1.7.7.6.4.4.2.cmml" xref="A1.Ex1.m1.7.7.6.4.4.2">𝑥</ci><cn id="A1.Ex1.m1.7.7.6.4.4.3.cmml" type="integer" xref="A1.Ex1.m1.7.7.6.4.4.3">2</cn></apply><apply id="A1.Ex1.m1.8.8.7.5.5.cmml" xref="A1.Ex1.m1.8.8.7.5.5"><csymbol cd="ambiguous" id="A1.Ex1.m1.8.8.7.5.5.1.cmml" xref="A1.Ex1.m1.8.8.7.5.5">superscript</csymbol><ci id="A1.Ex1.m1.8.8.7.5.5.2.cmml" xref="A1.Ex1.m1.8.8.7.5.5.2">𝜃</ci><cn id="A1.Ex1.m1.8.8.7.5.5.3.cmml" type="integer" xref="A1.Ex1.m1.8.8.7.5.5.3">2</cn></apply><apply id="A1.Ex1.m1.9.9.8.6.6.cmml" xref="A1.Ex1.m1.9.9.8.6.6"><csymbol cd="ambiguous" id="A1.Ex1.m1.9.9.8.6.6.1.cmml" xref="A1.Ex1.m1.9.9.8.6.6">superscript</csymbol><ci id="A1.Ex1.m1.9.9.8.6.6.2.cmml" xref="A1.Ex1.m1.9.9.8.6.6.2">𝑜</ci><apply id="A1.Ex1.m1.9.9.8.6.6.3.cmml" xref="A1.Ex1.m1.9.9.8.6.6.3"><times id="A1.Ex1.m1.9.9.8.6.6.3.1.cmml" xref="A1.Ex1.m1.9.9.8.6.6.3.1"></times><ci id="A1.Ex1.m1.9.9.8.6.6.3.2.cmml" xref="A1.Ex1.m1.9.9.8.6.6.3.2">𝑑</ci><ci id="A1.Ex1.m1.9.9.8.6.6.3.3.cmml" xref="A1.Ex1.m1.9.9.8.6.6.3.3">𝑒</ci><ci id="A1.Ex1.m1.9.9.8.6.6.3.4.cmml" xref="A1.Ex1.m1.9.9.8.6.6.3.4">𝑙</ci></apply></apply><ci id="A1.Ex1.m1.1.1.cmml" xref="A1.Ex1.m1.1.1">…</ci><apply id="A1.Ex1.m1.10.10.9.7.7.cmml" xref="A1.Ex1.m1.10.10.9.7.7"><csymbol cd="ambiguous" id="A1.Ex1.m1.10.10.9.7.7.1.cmml" xref="A1.Ex1.m1.10.10.9.7.7">superscript</csymbol><ci id="A1.Ex1.m1.10.10.9.7.7.2.cmml" xref="A1.Ex1.m1.10.10.9.7.7.2">𝑥</ci><ci id="A1.Ex1.m1.10.10.9.7.7.3.cmml" xref="A1.Ex1.m1.10.10.9.7.7.3">𝑀</ci></apply><apply id="A1.Ex1.m1.11.11.10.8.8.cmml" xref="A1.Ex1.m1.11.11.10.8.8"><csymbol cd="ambiguous" id="A1.Ex1.m1.11.11.10.8.8.1.cmml" xref="A1.Ex1.m1.11.11.10.8.8">superscript</csymbol><ci id="A1.Ex1.m1.11.11.10.8.8.2.cmml" xref="A1.Ex1.m1.11.11.10.8.8.2">𝜃</ci><ci id="A1.Ex1.m1.11.11.10.8.8.3.cmml" xref="A1.Ex1.m1.11.11.10.8.8.3">𝑀</ci></apply><apply id="A1.Ex1.m1.12.12.11.9.9.cmml" xref="A1.Ex1.m1.12.12.11.9.9"><csymbol cd="ambiguous" id="A1.Ex1.m1.12.12.11.9.9.1.cmml" xref="A1.Ex1.m1.12.12.11.9.9">superscript</csymbol><ci id="A1.Ex1.m1.12.12.11.9.9.2.cmml" xref="A1.Ex1.m1.12.12.11.9.9.2">𝑜</ci><apply id="A1.Ex1.m1.12.12.11.9.9.3.cmml" xref="A1.Ex1.m1.12.12.11.9.9.3"><times id="A1.Ex1.m1.12.12.11.9.9.3.1.cmml" xref="A1.Ex1.m1.12.12.11.9.9.3.1"></times><ci id="A1.Ex1.m1.12.12.11.9.9.3.2.cmml" xref="A1.Ex1.m1.12.12.11.9.9.3.2">𝑑</ci><ci id="A1.Ex1.m1.12.12.11.9.9.3.3.cmml" xref="A1.Ex1.m1.12.12.11.9.9.3.3">𝑒</ci><ci id="A1.Ex1.m1.12.12.11.9.9.3.4.cmml" xref="A1.Ex1.m1.12.12.11.9.9.3.4">𝑙</ci></apply></apply><apply id="A1.Ex1.m1.13.13.12.10.10.cmml" xref="A1.Ex1.m1.13.13.12.10.10"><csymbol cd="ambiguous" id="A1.Ex1.m1.13.13.12.10.10.1.cmml" xref="A1.Ex1.m1.13.13.12.10.10">subscript</csymbol><ci id="A1.Ex1.m1.13.13.12.10.10.2.cmml" xref="A1.Ex1.m1.13.13.12.10.10.2">𝐷</ci><apply id="A1.Ex1.m1.13.13.12.10.10.3.cmml" xref="A1.Ex1.m1.13.13.12.10.10.3"><times id="A1.Ex1.m1.13.13.12.10.10.3.1.cmml" xref="A1.Ex1.m1.13.13.12.10.10.3.1"></times><ci id="A1.Ex1.m1.13.13.12.10.10.3.2.cmml" xref="A1.Ex1.m1.13.13.12.10.10.3.2">𝑡</ci><ci id="A1.Ex1.m1.13.13.12.10.10.3.3.cmml" xref="A1.Ex1.m1.13.13.12.10.10.3.3">𝑎</ci><ci id="A1.Ex1.m1.13.13.12.10.10.3.4.cmml" xref="A1.Ex1.m1.13.13.12.10.10.3.4">𝑠</ci><ci id="A1.Ex1.m1.13.13.12.10.10.3.5.cmml" xref="A1.Ex1.m1.13.13.12.10.10.3.5">𝑘</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex1.m1.13c">[L_{M}^{{}^{\prime}},D_{task}]=[x^{1},\theta^{1},o^{del},x^{2},\theta^{2},o^{%
del},...,x^{M},\theta^{M},o^{del},D_{task}]</annotation><annotation encoding="application/x-llamapun" id="A1.Ex1.m1.13d">[ italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT ] = [ italic_x start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_o start_POSTSUPERSCRIPT italic_d italic_e italic_l end_POSTSUPERSCRIPT , italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , italic_o start_POSTSUPERSCRIPT italic_d italic_e italic_l end_POSTSUPERSCRIPT , … , italic_x start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT , italic_o start_POSTSUPERSCRIPT italic_d italic_e italic_l end_POSTSUPERSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p1.9"><span class="ltx_text ltx_font_bold" id="A1.SS1.p1.9.1">Proposition 2.2.</span> As the number of concept categories <math alttext="M" class="ltx_Math" display="inline" id="A1.SS1.p1.8.m1.1"><semantics id="A1.SS1.p1.8.m1.1a"><mi id="A1.SS1.p1.8.m1.1.1" xref="A1.SS1.p1.8.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.8.m1.1b"><ci id="A1.SS1.p1.8.m1.1.1.cmml" xref="A1.SS1.p1.8.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.8.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.8.m1.1d">italic_M</annotation></semantics></math> increases, the predictor <math alttext="\arg\max_{y\in\mathcal{Y}}{P_{LLM}(Y|X^{1},X^{2},...,X^{M},\theta^{1},\theta^{%
2},...,\theta^{M})}" class="ltx_Math" display="inline" id="A1.SS1.p1.9.m2.3"><semantics id="A1.SS1.p1.9.m2.3a"><mrow id="A1.SS1.p1.9.m2.3.3" xref="A1.SS1.p1.9.m2.3.3.cmml"><mrow id="A1.SS1.p1.9.m2.3.3.3" xref="A1.SS1.p1.9.m2.3.3.3.cmml"><mi id="A1.SS1.p1.9.m2.3.3.3.1" xref="A1.SS1.p1.9.m2.3.3.3.1.cmml">arg</mi><mo id="A1.SS1.p1.9.m2.3.3.3a" lspace="0.167em" xref="A1.SS1.p1.9.m2.3.3.3.cmml">⁡</mo><mrow id="A1.SS1.p1.9.m2.3.3.3.2" xref="A1.SS1.p1.9.m2.3.3.3.2.cmml"><msub id="A1.SS1.p1.9.m2.3.3.3.2.1" xref="A1.SS1.p1.9.m2.3.3.3.2.1.cmml"><mi id="A1.SS1.p1.9.m2.3.3.3.2.1.2" xref="A1.SS1.p1.9.m2.3.3.3.2.1.2.cmml">max</mi><mrow id="A1.SS1.p1.9.m2.3.3.3.2.1.3" xref="A1.SS1.p1.9.m2.3.3.3.2.1.3.cmml"><mi id="A1.SS1.p1.9.m2.3.3.3.2.1.3.2" xref="A1.SS1.p1.9.m2.3.3.3.2.1.3.2.cmml">y</mi><mo id="A1.SS1.p1.9.m2.3.3.3.2.1.3.1" xref="A1.SS1.p1.9.m2.3.3.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p1.9.m2.3.3.3.2.1.3.3" xref="A1.SS1.p1.9.m2.3.3.3.2.1.3.3.cmml">𝒴</mi></mrow></msub><mo id="A1.SS1.p1.9.m2.3.3.3.2a" lspace="0.167em" xref="A1.SS1.p1.9.m2.3.3.3.2.cmml">⁡</mo><msub id="A1.SS1.p1.9.m2.3.3.3.2.2" xref="A1.SS1.p1.9.m2.3.3.3.2.2.cmml"><mi id="A1.SS1.p1.9.m2.3.3.3.2.2.2" xref="A1.SS1.p1.9.m2.3.3.3.2.2.2.cmml">P</mi><mrow id="A1.SS1.p1.9.m2.3.3.3.2.2.3" xref="A1.SS1.p1.9.m2.3.3.3.2.2.3.cmml"><mi id="A1.SS1.p1.9.m2.3.3.3.2.2.3.2" xref="A1.SS1.p1.9.m2.3.3.3.2.2.3.2.cmml">L</mi><mo id="A1.SS1.p1.9.m2.3.3.3.2.2.3.1" xref="A1.SS1.p1.9.m2.3.3.3.2.2.3.1.cmml">⁢</mo><mi id="A1.SS1.p1.9.m2.3.3.3.2.2.3.3" xref="A1.SS1.p1.9.m2.3.3.3.2.2.3.3.cmml">L</mi><mo id="A1.SS1.p1.9.m2.3.3.3.2.2.3.1a" xref="A1.SS1.p1.9.m2.3.3.3.2.2.3.1.cmml">⁢</mo><mi id="A1.SS1.p1.9.m2.3.3.3.2.2.3.4" xref="A1.SS1.p1.9.m2.3.3.3.2.2.3.4.cmml">M</mi></mrow></msub></mrow></mrow><mo id="A1.SS1.p1.9.m2.3.3.2" xref="A1.SS1.p1.9.m2.3.3.2.cmml">⁢</mo><mrow id="A1.SS1.p1.9.m2.3.3.1.1" xref="A1.SS1.p1.9.m2.3.3.1.1.1.cmml"><mo id="A1.SS1.p1.9.m2.3.3.1.1.2" stretchy="false" xref="A1.SS1.p1.9.m2.3.3.1.1.1.cmml">(</mo><mrow id="A1.SS1.p1.9.m2.3.3.1.1.1" xref="A1.SS1.p1.9.m2.3.3.1.1.1.cmml"><mi id="A1.SS1.p1.9.m2.3.3.1.1.1.8" xref="A1.SS1.p1.9.m2.3.3.1.1.1.8.cmml">Y</mi><mo fence="false" id="A1.SS1.p1.9.m2.3.3.1.1.1.7" xref="A1.SS1.p1.9.m2.3.3.1.1.1.7.cmml">|</mo><mrow id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.7.cmml"><msup id="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1" xref="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1.cmml"><mi id="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1.2" xref="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1.2.cmml">X</mi><mn id="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1.3" xref="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1.3.cmml">1</mn></msup><mo id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.7" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.7.cmml">,</mo><msup id="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2" xref="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2.cmml"><mi id="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2.2" xref="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2.2.cmml">X</mi><mn id="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2.3" xref="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2.3.cmml">2</mn></msup><mo id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.8" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.7.cmml">,</mo><mi id="A1.SS1.p1.9.m2.1.1" mathvariant="normal" xref="A1.SS1.p1.9.m2.1.1.cmml">…</mi><mo id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.9" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.7.cmml">,</mo><msup id="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3" xref="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3.cmml"><mi id="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3.2" xref="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3.2.cmml">X</mi><mi id="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3.3" xref="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3.3.cmml">M</mi></msup><mo id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.10" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.7.cmml">,</mo><msup id="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4" xref="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4.cmml"><mi id="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4.2" xref="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4.2.cmml">θ</mi><mn id="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4.3" xref="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4.3.cmml">1</mn></msup><mo id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.11" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.7.cmml">,</mo><msup id="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5" xref="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5.cmml"><mi id="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5.2" xref="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5.2.cmml">θ</mi><mn id="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5.3" xref="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5.3.cmml">2</mn></msup><mo id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.12" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.7.cmml">,</mo><mi id="A1.SS1.p1.9.m2.2.2" mathvariant="normal" xref="A1.SS1.p1.9.m2.2.2.cmml">…</mi><mo id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.13" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.7.cmml">,</mo><msup id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6.cmml"><mi id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6.2" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6.2.cmml">θ</mi><mi id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6.3" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6.3.cmml">M</mi></msup></mrow></mrow><mo id="A1.SS1.p1.9.m2.3.3.1.1.3" stretchy="false" xref="A1.SS1.p1.9.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.9.m2.3b"><apply id="A1.SS1.p1.9.m2.3.3.cmml" xref="A1.SS1.p1.9.m2.3.3"><times id="A1.SS1.p1.9.m2.3.3.2.cmml" xref="A1.SS1.p1.9.m2.3.3.2"></times><apply id="A1.SS1.p1.9.m2.3.3.3.cmml" xref="A1.SS1.p1.9.m2.3.3.3"><arg id="A1.SS1.p1.9.m2.3.3.3.1.cmml" xref="A1.SS1.p1.9.m2.3.3.3.1"></arg><apply id="A1.SS1.p1.9.m2.3.3.3.2.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2"><apply id="A1.SS1.p1.9.m2.3.3.3.2.1.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.1"><csymbol cd="ambiguous" id="A1.SS1.p1.9.m2.3.3.3.2.1.1.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.1">subscript</csymbol><max id="A1.SS1.p1.9.m2.3.3.3.2.1.2.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.1.2"></max><apply id="A1.SS1.p1.9.m2.3.3.3.2.1.3.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.1.3"><in id="A1.SS1.p1.9.m2.3.3.3.2.1.3.1.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.1.3.1"></in><ci id="A1.SS1.p1.9.m2.3.3.3.2.1.3.2.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.1.3.2">𝑦</ci><ci id="A1.SS1.p1.9.m2.3.3.3.2.1.3.3.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.1.3.3">𝒴</ci></apply></apply><apply id="A1.SS1.p1.9.m2.3.3.3.2.2.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.9.m2.3.3.3.2.2.1.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.2">subscript</csymbol><ci id="A1.SS1.p1.9.m2.3.3.3.2.2.2.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.2.2">𝑃</ci><apply id="A1.SS1.p1.9.m2.3.3.3.2.2.3.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.2.3"><times id="A1.SS1.p1.9.m2.3.3.3.2.2.3.1.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.2.3.1"></times><ci id="A1.SS1.p1.9.m2.3.3.3.2.2.3.2.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.2.3.2">𝐿</ci><ci id="A1.SS1.p1.9.m2.3.3.3.2.2.3.3.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.2.3.3">𝐿</ci><ci id="A1.SS1.p1.9.m2.3.3.3.2.2.3.4.cmml" xref="A1.SS1.p1.9.m2.3.3.3.2.2.3.4">𝑀</ci></apply></apply></apply></apply><apply id="A1.SS1.p1.9.m2.3.3.1.1.1.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1"><csymbol cd="latexml" id="A1.SS1.p1.9.m2.3.3.1.1.1.7.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.7">conditional</csymbol><ci id="A1.SS1.p1.9.m2.3.3.1.1.1.8.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.8">𝑌</ci><list id="A1.SS1.p1.9.m2.3.3.1.1.1.6.7.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.6"><apply id="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1.2">𝑋</ci><cn id="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.SS1.p1.9.m2.3.3.1.1.1.1.1.1.3">1</cn></apply><apply id="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2.1.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2">superscript</csymbol><ci id="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2.2.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2.2">𝑋</ci><cn id="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2.3.cmml" type="integer" xref="A1.SS1.p1.9.m2.3.3.1.1.1.2.2.2.3">2</cn></apply><ci id="A1.SS1.p1.9.m2.1.1.cmml" xref="A1.SS1.p1.9.m2.1.1">…</ci><apply id="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3.1.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3">superscript</csymbol><ci id="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3.2.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3.2">𝑋</ci><ci id="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3.3.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.3.3.3.3">𝑀</ci></apply><apply id="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4"><csymbol cd="ambiguous" id="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4.1.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4">superscript</csymbol><ci id="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4.2.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4.2">𝜃</ci><cn id="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4.3.cmml" type="integer" xref="A1.SS1.p1.9.m2.3.3.1.1.1.4.4.4.3">1</cn></apply><apply id="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5"><csymbol cd="ambiguous" id="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5.1.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5">superscript</csymbol><ci id="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5.2.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5.2">𝜃</ci><cn id="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5.3.cmml" type="integer" xref="A1.SS1.p1.9.m2.3.3.1.1.1.5.5.5.3">2</cn></apply><ci id="A1.SS1.p1.9.m2.2.2.cmml" xref="A1.SS1.p1.9.m2.2.2">…</ci><apply id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6"><csymbol cd="ambiguous" id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6.1.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6">superscript</csymbol><ci id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6.2.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6.2">𝜃</ci><ci id="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6.3.cmml" xref="A1.SS1.p1.9.m2.3.3.1.1.1.6.6.6.3">𝑀</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.9.m2.3c">\arg\max_{y\in\mathcal{Y}}{P_{LLM}(Y|X^{1},X^{2},...,X^{M},\theta^{1},\theta^{%
2},...,\theta^{M})}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.9.m2.3d">roman_arg roman_max start_POSTSUBSCRIPT italic_y ∈ caligraphic_Y end_POSTSUBSCRIPT italic_P start_POSTSUBSCRIPT italic_L italic_L italic_M end_POSTSUBSCRIPT ( italic_Y | italic_X start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_X start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_X start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_θ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT )</annotation></semantics></math> is the Bayesian optimal predictor.</p>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<table class="ltx_equationgroup ltx_eqn_table" id="A1.Ex2">
<tbody id="A1.Ex2X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_italic" id="A1.Ex2X.2.1.1.1">Proof.</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex2Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle P(Y=y|L_{M},D_{task})" class="ltx_Math" display="inline" id="A1.Ex2Xa.2.1.1.m1.1"><semantics id="A1.Ex2Xa.2.1.1.m1.1a"><mrow id="A1.Ex2Xa.2.1.1.m1.1.1" xref="A1.Ex2Xa.2.1.1.m1.1.1.cmml"><mi id="A1.Ex2Xa.2.1.1.m1.1.1.3" xref="A1.Ex2Xa.2.1.1.m1.1.1.3.cmml">P</mi><mo id="A1.Ex2Xa.2.1.1.m1.1.1.2" xref="A1.Ex2Xa.2.1.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex2Xa.2.1.1.m1.1.1.1.1" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.cmml"><mo id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.2" stretchy="false" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.cmml"><mi id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.4" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.4.cmml">Y</mi><mo id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.3" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.3.cmml">=</mo><mrow id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.cmml"><mi id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.4" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.4.cmml">y</mi><mo fence="false" id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.3" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.3.cmml">|</mo><mrow id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.3.cmml"><msub id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">L</mi><mi id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></msub><mo id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.3" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.2" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.2.cmml">D</mi><mrow id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.2" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.2.cmml">t</mi><mo id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.1" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.3" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.3.cmml">a</mi><mo id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.1a" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.4" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.4.cmml">s</mi><mo id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.1b" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.5" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.5.cmml">k</mi></mrow></msub></mrow></mrow></mrow><mo id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.3" stretchy="false" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2Xa.2.1.1.m1.1b"><apply id="A1.Ex2Xa.2.1.1.m1.1.1.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1"><times id="A1.Ex2Xa.2.1.1.m1.1.1.2.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.2"></times><ci id="A1.Ex2Xa.2.1.1.m1.1.1.3.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.3">𝑃</ci><apply id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1"><eq id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.3"></eq><ci id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.4.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.4">𝑌</ci><apply id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2"><csymbol cd="latexml" id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.3.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.3">conditional</csymbol><ci id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.4.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.4">𝑦</ci><list id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2"><apply id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">𝐿</ci><ci id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.2">𝐷</ci><apply id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3"><times id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.2">𝑡</ci><ci id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.3">𝑎</ci><ci id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.4.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.4">𝑠</ci><ci id="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.5.cmml" xref="A1.Ex2Xa.2.1.1.m1.1.1.1.1.1.2.2.2.2.3.5">𝑘</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2Xa.2.1.1.m1.1c">\displaystyle P(Y=y|L_{M},D_{task})</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2Xa.2.1.1.m1.1d">italic_P ( italic_Y = italic_y | italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex2Xb"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int_{\Theta}P(Y=y|L_{M},D_{task},\theta)P(\theta|L_{M},D_{task}%
)d\theta" class="ltx_Math" display="inline" id="A1.Ex2Xb.2.1.1.m1.3"><semantics id="A1.Ex2Xb.2.1.1.m1.3a"><mrow id="A1.Ex2Xb.2.1.1.m1.3.3" xref="A1.Ex2Xb.2.1.1.m1.3.3.cmml"><mi id="A1.Ex2Xb.2.1.1.m1.3.3.4" xref="A1.Ex2Xb.2.1.1.m1.3.3.4.cmml"></mi><mo id="A1.Ex2Xb.2.1.1.m1.3.3.3" xref="A1.Ex2Xb.2.1.1.m1.3.3.3.cmml">=</mo><mrow id="A1.Ex2Xb.2.1.1.m1.3.3.2" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.cmml"><mstyle displaystyle="true" id="A1.Ex2Xb.2.1.1.m1.3.3.2.3" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.3.cmml"><msub id="A1.Ex2Xb.2.1.1.m1.3.3.2.3a" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.3.cmml"><mo id="A1.Ex2Xb.2.1.1.m1.3.3.2.3.2" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.3.2.cmml">∫</mo><mi id="A1.Ex2Xb.2.1.1.m1.3.3.2.3.3" mathvariant="normal" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.3.3.cmml">Θ</mi></msub></mstyle><mrow id="A1.Ex2Xb.2.1.1.m1.3.3.2.2" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.cmml"><mi id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.4" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.4.cmml">P</mi><mo id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.3" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.3.cmml">⁢</mo><mrow id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.cmml"><mo id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.2" stretchy="false" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.4" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.4.cmml">Y</mi><mo id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.3" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.3.cmml">=</mo><mrow id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.cmml"><mi id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.4" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.4.cmml">y</mi><mo fence="false" id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.3" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.3.cmml">|</mo><mrow id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.3.cmml"><msub id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">L</mi><mi id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></msub><mo id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.3" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.2" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml">D</mi><mrow id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.2" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.2.cmml">t</mi><mo id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.1" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.3" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.3.cmml">a</mi><mo id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.1a" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.4" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.4.cmml">s</mi><mo id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.1b" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.5" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.5.cmml">k</mi></mrow></msub><mo id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.4" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="A1.Ex2Xb.2.1.1.m1.1.1" xref="A1.Ex2Xb.2.1.1.m1.1.1.cmml">θ</mi></mrow></mrow></mrow><mo id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.3" stretchy="false" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.3a" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.3.cmml">⁢</mo><mi id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.5" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.5.cmml">P</mi><mo id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.3b" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.3.cmml">⁢</mo><mrow id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.cmml"><mo id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.2" stretchy="false" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.cmml">(</mo><mrow id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.cmml"><mi id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.4" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.4.cmml">θ</mi><mo fence="false" id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.3" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.3.cmml">|</mo><mrow id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.3.cmml"><msub id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1.cmml"><mi id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1.2" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1.2.cmml">L</mi><mi id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1.3" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1.3.cmml">M</mi></msub><mo id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.3" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.3.cmml">,</mo><msub id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.cmml"><mi id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.2" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.2.cmml">D</mi><mrow id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.cmml"><mi id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.2" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.2.cmml">t</mi><mo id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.1" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.3" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.3.cmml">a</mi><mo id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.1a" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.4" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.4.cmml">s</mi><mo id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.1b" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.5" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.5.cmml">k</mi></mrow></msub></mrow></mrow><mo id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.3" stretchy="false" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.cmml">)</mo></mrow><mo id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.3c" lspace="0em" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.3.cmml">⁢</mo><mrow id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.6" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.6.cmml"><mo id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.6.1" rspace="0em" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.6.1.cmml">𝑑</mo><mi id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.6.2" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.6.2.cmml">θ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2Xb.2.1.1.m1.3b"><apply id="A1.Ex2Xb.2.1.1.m1.3.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3"><eq id="A1.Ex2Xb.2.1.1.m1.3.3.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.3"></eq><csymbol cd="latexml" id="A1.Ex2Xb.2.1.1.m1.3.3.4.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.4">absent</csymbol><apply id="A1.Ex2Xb.2.1.1.m1.3.3.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2"><apply id="A1.Ex2Xb.2.1.1.m1.3.3.2.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.3"><csymbol cd="ambiguous" id="A1.Ex2Xb.2.1.1.m1.3.3.2.3.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.3">subscript</csymbol><int id="A1.Ex2Xb.2.1.1.m1.3.3.2.3.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.3.2"></int><ci id="A1.Ex2Xb.2.1.1.m1.3.3.2.3.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.3.3">Θ</ci></apply><apply id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2"><times id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.3"></times><ci id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.4.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.4">𝑃</ci><apply id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1"><eq id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.3"></eq><ci id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.4.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.4">𝑌</ci><apply id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2"><csymbol cd="latexml" id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.3">conditional</csymbol><ci id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.4.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.4">𝑦</ci><list id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2"><apply id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝐿</ci><ci id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.2">𝐷</ci><apply id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3"><times id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.2">𝑡</ci><ci id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.3">𝑎</ci><ci id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.4.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.4">𝑠</ci><ci id="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.5.cmml" xref="A1.Ex2Xb.2.1.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.5">𝑘</ci></apply></apply><ci id="A1.Ex2Xb.2.1.1.m1.1.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.1.1">𝜃</ci></list></apply></apply><ci id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.5.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.5">𝑃</ci><apply id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1"><csymbol cd="latexml" id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.3">conditional</csymbol><ci id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.4.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.4">𝜃</ci><list id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2"><apply id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1.2">𝐿</ci><ci id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.1.1.1.3">𝑀</ci></apply><apply id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2">subscript</csymbol><ci id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.2">𝐷</ci><apply id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3"><times id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.1"></times><ci id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.2">𝑡</ci><ci id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.3.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.3">𝑎</ci><ci id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.4.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.4">𝑠</ci><ci id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.5.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.2.1.1.2.2.2.3.5">𝑘</ci></apply></apply></list></apply><apply id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.6.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.6"><csymbol cd="latexml" id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.6.1.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.6.1">differential-d</csymbol><ci id="A1.Ex2Xb.2.1.1.m1.3.3.2.2.6.2.cmml" xref="A1.Ex2Xb.2.1.1.m1.3.3.2.2.6.2">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2Xb.2.1.1.m1.3c">\displaystyle=\int_{\Theta}P(Y=y|L_{M},D_{task},\theta)P(\theta|L_{M},D_{task}%
)d\theta</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2Xb.2.1.1.m1.3d">= ∫ start_POSTSUBSCRIPT roman_Θ end_POSTSUBSCRIPT italic_P ( italic_Y = italic_y | italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT , italic_θ ) italic_P ( italic_θ | italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT ) italic_d italic_θ</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex2Xc"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\propto\int_{\Theta}P(Y=y|L_{M},D_{task},\theta)P(L_{M},D_{task}|%
\theta)P(\theta)d\theta" class="ltx_Math" display="inline" id="A1.Ex2Xc.2.1.1.m1.5"><semantics id="A1.Ex2Xc.2.1.1.m1.5a"><mrow id="A1.Ex2Xc.2.1.1.m1.5.5" xref="A1.Ex2Xc.2.1.1.m1.5.5.cmml"><mi id="A1.Ex2Xc.2.1.1.m1.5.5.5" xref="A1.Ex2Xc.2.1.1.m1.5.5.5.cmml"></mi><mo id="A1.Ex2Xc.2.1.1.m1.5.5.4" xref="A1.Ex2Xc.2.1.1.m1.5.5.4.cmml">∝</mo><mrow id="A1.Ex2Xc.2.1.1.m1.5.5.3" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.cmml"><mstyle displaystyle="true" id="A1.Ex2Xc.2.1.1.m1.5.5.3.4" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.4.cmml"><msub id="A1.Ex2Xc.2.1.1.m1.5.5.3.4a" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.4.cmml"><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.4.2" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.4.2.cmml">∫</mo><mi id="A1.Ex2Xc.2.1.1.m1.5.5.3.4.3" mathvariant="normal" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.4.3.cmml">Θ</mi></msub></mstyle><mrow id="A1.Ex2Xc.2.1.1.m1.5.5.3.3" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.cmml"><mi id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.5" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.5.cmml">P</mi><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4.cmml">⁢</mo><mrow id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.cmml"><mo id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.2" stretchy="false" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.cmml"><mi id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.4" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.4.cmml">Y</mi><mo id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.3" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.3.cmml">=</mo><mrow id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.cmml"><mi id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.4" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.4.cmml">y</mi><mo fence="false" id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.3" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.3.cmml">|</mo><mrow id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.cmml"><msub id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">L</mi><mi id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></msub><mo id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.3" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.2" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.2.cmml">D</mi><mrow id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.2" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.2.cmml">t</mi><mo id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.1" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.3" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.3.cmml">a</mi><mo id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.1a" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.4" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.4.cmml">s</mi><mo id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.1b" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.5" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.5.cmml">k</mi></mrow></msub><mo id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.4" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="A1.Ex2Xc.2.1.1.m1.1.1" xref="A1.Ex2Xc.2.1.1.m1.1.1.cmml">θ</mi></mrow></mrow></mrow><mo id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.3" stretchy="false" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4a" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4.cmml">⁢</mo><mi id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.6" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.6.cmml">P</mi><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4b" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4.cmml">⁢</mo><mrow id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.3.cmml"><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.3" stretchy="false" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.3.cmml">(</mo><msub id="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1" xref="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1.cmml"><mi id="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1.2" xref="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1.2.cmml">L</mi><mi id="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1.3" xref="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1.3.cmml">M</mi></msub><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.4" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.3.cmml">,</mo><mrow id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.cmml"><msub id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.cmml"><mi id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.2" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.2.cmml">D</mi><mrow id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.cmml"><mi id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.2" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.2.cmml">t</mi><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.1" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.3" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.3.cmml">a</mi><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.1a" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.4" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.4.cmml">s</mi><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.1b" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.5" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.5.cmml">k</mi></mrow></msub><mo fence="false" id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.1" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.1.cmml">|</mo><mi id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.3" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.3.cmml">θ</mi></mrow><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.5" stretchy="false" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.3.cmml">)</mo></mrow><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4c" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4.cmml">⁢</mo><mi id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.7" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.7.cmml">P</mi><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4d" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4.cmml">⁢</mo><mrow id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.8.2" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.cmml"><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.8.2.1" stretchy="false" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.cmml">(</mo><mi id="A1.Ex2Xc.2.1.1.m1.2.2" xref="A1.Ex2Xc.2.1.1.m1.2.2.cmml">θ</mi><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.8.2.2" stretchy="false" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.cmml">)</mo></mrow><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4e" lspace="0em" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4.cmml">⁢</mo><mrow id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.9" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.9.cmml"><mo id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.9.1" rspace="0em" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.9.1.cmml">𝑑</mo><mi id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.9.2" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.9.2.cmml">θ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2Xc.2.1.1.m1.5b"><apply id="A1.Ex2Xc.2.1.1.m1.5.5.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5"><csymbol cd="latexml" id="A1.Ex2Xc.2.1.1.m1.5.5.4.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.4">proportional-to</csymbol><csymbol cd="latexml" id="A1.Ex2Xc.2.1.1.m1.5.5.5.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.5">absent</csymbol><apply id="A1.Ex2Xc.2.1.1.m1.5.5.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3"><apply id="A1.Ex2Xc.2.1.1.m1.5.5.3.4.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.4"><csymbol cd="ambiguous" id="A1.Ex2Xc.2.1.1.m1.5.5.3.4.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.4">subscript</csymbol><int id="A1.Ex2Xc.2.1.1.m1.5.5.3.4.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.4.2"></int><ci id="A1.Ex2Xc.2.1.1.m1.5.5.3.4.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.4.3">Θ</ci></apply><apply id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3"><times id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.4"></times><ci id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.5.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.5">𝑃</ci><apply id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1"><eq id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.3"></eq><ci id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.4.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.4">𝑌</ci><apply id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="latexml" id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.3">conditional</csymbol><ci id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.4.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.4">𝑦</ci><list id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2"><apply id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝐿</ci><ci id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.2">𝐷</ci><apply id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3"><times id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.2">𝑡</ci><ci id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.3">𝑎</ci><ci id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.4.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.4">𝑠</ci><ci id="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.5.cmml" xref="A1.Ex2Xc.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.3.5">𝑘</ci></apply></apply><ci id="A1.Ex2Xc.2.1.1.m1.1.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.1.1">𝜃</ci></list></apply></apply><ci id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.6.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.6">𝑃</ci><interval closure="open" id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2"><apply id="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1">subscript</csymbol><ci id="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1.2">𝐿</ci><ci id="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.4.4.2.2.2.1.1.3">𝑀</ci></apply><apply id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2"><csymbol cd="latexml" id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.1">conditional</csymbol><apply id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2">subscript</csymbol><ci id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.2">𝐷</ci><apply id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3"><times id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.1"></times><ci id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.2">𝑡</ci><ci id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.3">𝑎</ci><ci id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.4.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.4">𝑠</ci><ci id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.5.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.2.3.5">𝑘</ci></apply></apply><ci id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.3.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.3.2.2.3">𝜃</ci></apply></interval><ci id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.7.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.7">𝑃</ci><ci id="A1.Ex2Xc.2.1.1.m1.2.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.2.2">𝜃</ci><apply id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.9.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.9"><csymbol cd="latexml" id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.9.1.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.9.1">differential-d</csymbol><ci id="A1.Ex2Xc.2.1.1.m1.5.5.3.3.9.2.cmml" xref="A1.Ex2Xc.2.1.1.m1.5.5.3.3.9.2">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2Xc.2.1.1.m1.5c">\displaystyle\propto\int_{\Theta}P(Y=y|L_{M},D_{task},\theta)P(L_{M},D_{task}|%
\theta)P(\theta)d\theta</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2Xc.2.1.1.m1.5d">∝ ∫ start_POSTSUBSCRIPT roman_Θ end_POSTSUBSCRIPT italic_P ( italic_Y = italic_y | italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT , italic_θ ) italic_P ( italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT | italic_θ ) italic_P ( italic_θ ) italic_d italic_θ</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex2Xd"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{(Bayesian rule, cancel the constant }\frac{1}{P(L_{M},D_{%
task})}\text{) }" class="ltx_Math" display="inline" id="A1.Ex2Xd.2.1.1.m1.2"><semantics id="A1.Ex2Xd.2.1.1.m1.2a"><mrow id="A1.Ex2Xd.2.1.1.m1.2.3" xref="A1.Ex2Xd.2.1.1.m1.2.3.cmml"><mtext id="A1.Ex2Xd.2.1.1.m1.2.3.2" xref="A1.Ex2Xd.2.1.1.m1.2.3.2a.cmml">(Bayesian rule, cancel the constant </mtext><mo id="A1.Ex2Xd.2.1.1.m1.2.3.1" xref="A1.Ex2Xd.2.1.1.m1.2.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="A1.Ex2Xd.2.1.1.m1.2.2" xref="A1.Ex2Xd.2.1.1.m1.2.2.cmml"><mfrac id="A1.Ex2Xd.2.1.1.m1.2.2a" xref="A1.Ex2Xd.2.1.1.m1.2.2.cmml"><mn id="A1.Ex2Xd.2.1.1.m1.2.2.4" xref="A1.Ex2Xd.2.1.1.m1.2.2.4.cmml">1</mn><mrow id="A1.Ex2Xd.2.1.1.m1.2.2.2" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.cmml"><mi id="A1.Ex2Xd.2.1.1.m1.2.2.2.4" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.4.cmml">P</mi><mo id="A1.Ex2Xd.2.1.1.m1.2.2.2.3" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.3.cmml"><mo id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.3" stretchy="false" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.3.cmml">(</mo><msub id="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1" xref="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1.2" xref="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1.2.cmml">L</mi><mi id="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1.3" xref="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1.3.cmml">M</mi></msub><mo id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.4" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.3.cmml">,</mo><msub id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.cmml"><mi id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.2" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.2.cmml">D</mi><mrow id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.cmml"><mi id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.2" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.1" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.3" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.3.cmml">a</mi><mo id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.1a" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.4" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.4.cmml">s</mi><mo id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.1b" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.5" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.5.cmml">k</mi></mrow></msub><mo id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.5" stretchy="false" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="A1.Ex2Xd.2.1.1.m1.2.3.1a" xref="A1.Ex2Xd.2.1.1.m1.2.3.1.cmml">⁢</mo><mtext id="A1.Ex2Xd.2.1.1.m1.2.3.3" xref="A1.Ex2Xd.2.1.1.m1.2.3.3a.cmml">)</mtext></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2Xd.2.1.1.m1.2b"><apply id="A1.Ex2Xd.2.1.1.m1.2.3.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.3"><times id="A1.Ex2Xd.2.1.1.m1.2.3.1.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.3.1"></times><ci id="A1.Ex2Xd.2.1.1.m1.2.3.2a.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.3.2"><mtext id="A1.Ex2Xd.2.1.1.m1.2.3.2.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.3.2">(Bayesian rule, cancel the constant </mtext></ci><apply id="A1.Ex2Xd.2.1.1.m1.2.2.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2"><divide id="A1.Ex2Xd.2.1.1.m1.2.2.3.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2"></divide><cn id="A1.Ex2Xd.2.1.1.m1.2.2.4.cmml" type="integer" xref="A1.Ex2Xd.2.1.1.m1.2.2.4">1</cn><apply id="A1.Ex2Xd.2.1.1.m1.2.2.2.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2"><times id="A1.Ex2Xd.2.1.1.m1.2.2.2.3.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.3"></times><ci id="A1.Ex2Xd.2.1.1.m1.2.2.2.4.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.4">𝑃</ci><interval closure="open" id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.3.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2"><apply id="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1.2">𝐿</ci><ci id="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex2Xd.2.1.1.m1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.1.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.2">𝐷</ci><apply id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3"><times id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.1.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.1"></times><ci id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.2.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.2">𝑡</ci><ci id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.3.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.3">𝑎</ci><ci id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.4.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.4">𝑠</ci><ci id="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.5.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.2.2.2.2.2.3.5">𝑘</ci></apply></apply></interval></apply></apply><ci id="A1.Ex2Xd.2.1.1.m1.2.3.3a.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.3.3"><mtext id="A1.Ex2Xd.2.1.1.m1.2.3.3.cmml" xref="A1.Ex2Xd.2.1.1.m1.2.3.3">)</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2Xd.2.1.1.m1.2c">\displaystyle\text{(Bayesian rule, cancel the constant }\frac{1}{P(L_{M},D_{%
task})}\text{) }</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2Xd.2.1.1.m1.2d">(Bayesian rule, cancel the constant divide start_ARG 1 end_ARG start_ARG italic_P ( italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT ) end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex2Xe"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\propto\int_{\Theta}P(Y=y|L_{M},D_{task},\theta)\frac{P(L_{M},D_{%
task}|\theta)}{P(L_{M},D_{task}|\theta^{*})}P(\theta)d\theta" class="ltx_Math" display="inline" id="A1.Ex2Xe.2.1.1.m1.7"><semantics id="A1.Ex2Xe.2.1.1.m1.7a"><mrow id="A1.Ex2Xe.2.1.1.m1.7.7" xref="A1.Ex2Xe.2.1.1.m1.7.7.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.7.7.3" xref="A1.Ex2Xe.2.1.1.m1.7.7.3.cmml"></mi><mo id="A1.Ex2Xe.2.1.1.m1.7.7.2" xref="A1.Ex2Xe.2.1.1.m1.7.7.2.cmml">∝</mo><mrow id="A1.Ex2Xe.2.1.1.m1.7.7.1" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.cmml"><mstyle displaystyle="true" id="A1.Ex2Xe.2.1.1.m1.7.7.1.2" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.2.cmml"><msub id="A1.Ex2Xe.2.1.1.m1.7.7.1.2a" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.2.cmml"><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.2.2" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.2.2.cmml">∫</mo><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.2.3" mathvariant="normal" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.2.3.cmml">Θ</mi></msub></mstyle><mrow id="A1.Ex2Xe.2.1.1.m1.7.7.1.1" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.3" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.3.cmml">P</mi><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.2" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.cmml"><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.2" stretchy="false" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.4" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.4.cmml">Y</mi><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.3" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.3.cmml">=</mo><mrow id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.4" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.4.cmml">y</mi><mo fence="false" id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.3" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.3.cmml">|</mo><mrow id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.3.cmml"><msub id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">L</mi><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></msub><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.3" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.2" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.2.cmml">D</mi><mrow id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.2" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.2.cmml">t</mi><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.1" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.3" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.3.cmml">a</mi><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.1a" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.4" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.4.cmml">s</mi><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.1b" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.5" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.5.cmml">k</mi></mrow></msub><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.4" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="A1.Ex2Xe.2.1.1.m1.5.5" xref="A1.Ex2Xe.2.1.1.m1.5.5.cmml">θ</mi></mrow></mrow></mrow><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.3" stretchy="false" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.2a" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.2.cmml">⁢</mo><mstyle displaystyle="true" id="A1.Ex2Xe.2.1.1.m1.4.4" xref="A1.Ex2Xe.2.1.1.m1.4.4.cmml"><mfrac id="A1.Ex2Xe.2.1.1.m1.4.4a" xref="A1.Ex2Xe.2.1.1.m1.4.4.cmml"><mrow id="A1.Ex2Xe.2.1.1.m1.2.2.2" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.2.2.2.4" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.4.cmml">P</mi><mo id="A1.Ex2Xe.2.1.1.m1.2.2.2.3" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.3.cmml"><mo id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.3" stretchy="false" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.3.cmml">(</mo><msub id="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1" xref="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1.2" xref="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1.2.cmml">L</mi><mi id="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1.3" xref="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1.3.cmml">M</mi></msub><mo id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.4" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.3.cmml">,</mo><mrow id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.cmml"><msub id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.2" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.2.cmml">D</mi><mrow id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.2" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.1" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.3" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.3.cmml">a</mi><mo id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.1a" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.4" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.4.cmml">s</mi><mo id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.1b" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.5" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.5.cmml">k</mi></mrow></msub><mo fence="false" id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.1" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.1.cmml">|</mo><mi id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.3" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.3.cmml">θ</mi></mrow><mo id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.5" stretchy="false" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="A1.Ex2Xe.2.1.1.m1.4.4.4" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.4.4.4.4" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.4.cmml">P</mi><mo id="A1.Ex2Xe.2.1.1.m1.4.4.4.3" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.3.cmml">⁢</mo><mrow id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.3.cmml"><mo id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.3" stretchy="false" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.3.cmml">(</mo><msub id="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1" xref="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1.2" xref="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1.2.cmml">L</mi><mi id="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1.3" xref="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1.3.cmml">M</mi></msub><mo id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.4" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.3.cmml">,</mo><mrow id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.cmml"><msub id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.2" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.2.cmml">D</mi><mrow id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.2" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.2.cmml">t</mi><mo id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.1" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.3" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.3.cmml">a</mi><mo id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.1a" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.4" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.4.cmml">s</mi><mo id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.1b" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.5" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.5.cmml">k</mi></mrow></msub><mo fence="false" id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.1" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.1.cmml">|</mo><msup id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3.cmml"><mi id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3.2" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3.2.cmml">θ</mi><mo id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3.3" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3.3.cmml">∗</mo></msup></mrow><mo id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.5" stretchy="false" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.3.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.2b" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.2.cmml">⁢</mo><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.4" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.4.cmml">P</mi><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.2c" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.5.2" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.cmml"><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.5.2.1" stretchy="false" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.cmml">(</mo><mi id="A1.Ex2Xe.2.1.1.m1.6.6" xref="A1.Ex2Xe.2.1.1.m1.6.6.cmml">θ</mi><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.5.2.2" stretchy="false" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.cmml">)</mo></mrow><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.2d" lspace="0em" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.6" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.6.cmml"><mo id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.6.1" rspace="0em" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.6.1.cmml">𝑑</mo><mi id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.6.2" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.6.2.cmml">θ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2Xe.2.1.1.m1.7b"><apply id="A1.Ex2Xe.2.1.1.m1.7.7.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7"><csymbol cd="latexml" id="A1.Ex2Xe.2.1.1.m1.7.7.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.2">proportional-to</csymbol><csymbol cd="latexml" id="A1.Ex2Xe.2.1.1.m1.7.7.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.3">absent</csymbol><apply id="A1.Ex2Xe.2.1.1.m1.7.7.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1"><apply id="A1.Ex2Xe.2.1.1.m1.7.7.1.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.2"><csymbol cd="ambiguous" id="A1.Ex2Xe.2.1.1.m1.7.7.1.2.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.2">subscript</csymbol><int id="A1.Ex2Xe.2.1.1.m1.7.7.1.2.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.2.2"></int><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.2.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.2.3">Θ</ci></apply><apply id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1"><times id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.2"></times><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.3">𝑃</ci><apply id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1"><eq id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.3"></eq><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.4.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.4">𝑌</ci><apply id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2"><csymbol cd="latexml" id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.3">conditional</csymbol><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.4.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.4">𝑦</ci><list id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2"><apply id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.2">𝐿</ci><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.2">𝐷</ci><apply id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3"><times id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.2">𝑡</ci><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.3">𝑎</ci><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.4.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.4">𝑠</ci><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.5.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.1.1.1.2.2.2.2.3.5">𝑘</ci></apply></apply><ci id="A1.Ex2Xe.2.1.1.m1.5.5.cmml" xref="A1.Ex2Xe.2.1.1.m1.5.5">𝜃</ci></list></apply></apply><apply id="A1.Ex2Xe.2.1.1.m1.4.4.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4"><divide id="A1.Ex2Xe.2.1.1.m1.4.4.5.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4"></divide><apply id="A1.Ex2Xe.2.1.1.m1.2.2.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2"><times id="A1.Ex2Xe.2.1.1.m1.2.2.2.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.3"></times><ci id="A1.Ex2Xe.2.1.1.m1.2.2.2.4.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.4">𝑃</ci><interval closure="open" id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2"><apply id="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1.2">𝐿</ci><ci id="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2"><csymbol cd="latexml" id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.1">conditional</csymbol><apply id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.2">𝐷</ci><apply id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3"><times id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.1"></times><ci id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.2">𝑡</ci><ci id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.3">𝑎</ci><ci id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.4.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.4">𝑠</ci><ci id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.5.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.2.3.5">𝑘</ci></apply></apply><ci id="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.2.2.2.2.2.2.3">𝜃</ci></apply></interval></apply><apply id="A1.Ex2Xe.2.1.1.m1.4.4.4.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4"><times id="A1.Ex2Xe.2.1.1.m1.4.4.4.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.3"></times><ci id="A1.Ex2Xe.2.1.1.m1.4.4.4.4.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.4">𝑃</ci><interval closure="open" id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2"><apply id="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1">subscript</csymbol><ci id="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1.2">𝐿</ci><ci id="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.3.3.3.1.1.1.3">𝑀</ci></apply><apply id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2"><csymbol cd="latexml" id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.1">conditional</csymbol><apply id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2">subscript</csymbol><ci id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.2">𝐷</ci><apply id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3"><times id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.1"></times><ci id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.2">𝑡</ci><ci id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.3">𝑎</ci><ci id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.4.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.4">𝑠</ci><ci id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.5.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.2.3.5">𝑘</ci></apply></apply><apply id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3">superscript</csymbol><ci id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3.2">𝜃</ci><times id="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3.3.cmml" xref="A1.Ex2Xe.2.1.1.m1.4.4.4.2.2.2.3.3"></times></apply></apply></interval></apply></apply><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.4.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.4">𝑃</ci><ci id="A1.Ex2Xe.2.1.1.m1.6.6.cmml" xref="A1.Ex2Xe.2.1.1.m1.6.6">𝜃</ci><apply id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.6.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.6"><csymbol cd="latexml" id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.6.1.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.6.1">differential-d</csymbol><ci id="A1.Ex2Xe.2.1.1.m1.7.7.1.1.6.2.cmml" xref="A1.Ex2Xe.2.1.1.m1.7.7.1.1.6.2">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2Xe.2.1.1.m1.7c">\displaystyle\propto\int_{\Theta}P(Y=y|L_{M},D_{task},\theta)\frac{P(L_{M},D_{%
task}|\theta)}{P(L_{M},D_{task}|\theta^{*})}P(\theta)d\theta</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2Xe.2.1.1.m1.7d">∝ ∫ start_POSTSUBSCRIPT roman_Θ end_POSTSUBSCRIPT italic_P ( italic_Y = italic_y | italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT , italic_θ ) divide start_ARG italic_P ( italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT | italic_θ ) end_ARG start_ARG italic_P ( italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT | italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) end_ARG italic_P ( italic_θ ) italic_d italic_θ</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex2Xf"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{(Law of total prob,Markov property,divide by a constant }P(%
L_{M},D_{task}|\theta^{*})\text{) }" class="ltx_Math" display="inline" id="A1.Ex2Xf.2.1.1.m1.2"><semantics id="A1.Ex2Xf.2.1.1.m1.2a"><mrow id="A1.Ex2Xf.2.1.1.m1.2.2" xref="A1.Ex2Xf.2.1.1.m1.2.2.cmml"><mtext id="A1.Ex2Xf.2.1.1.m1.2.2.4" xref="A1.Ex2Xf.2.1.1.m1.2.2.4a.cmml">(Law of total prob,Markov property,divide by a constant </mtext><mo id="A1.Ex2Xf.2.1.1.m1.2.2.3" xref="A1.Ex2Xf.2.1.1.m1.2.2.3.cmml">⁢</mo><mi id="A1.Ex2Xf.2.1.1.m1.2.2.5" xref="A1.Ex2Xf.2.1.1.m1.2.2.5.cmml">P</mi><mo id="A1.Ex2Xf.2.1.1.m1.2.2.3a" xref="A1.Ex2Xf.2.1.1.m1.2.2.3.cmml">⁢</mo><mrow id="A1.Ex2Xf.2.1.1.m1.2.2.2.2" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.3.cmml"><mo id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.3" stretchy="false" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.3.cmml">(</mo><msub id="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1" xref="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1.cmml"><mi id="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1.2" xref="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1.2.cmml">L</mi><mi id="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1.3" xref="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1.3.cmml">M</mi></msub><mo id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.4" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.3.cmml">,</mo><mrow id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.cmml"><msub id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.cmml"><mi id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.2" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.2.cmml">D</mi><mrow id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.cmml"><mi id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.2" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.1" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.3" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.3.cmml">a</mi><mo id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.1a" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.4" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.4.cmml">s</mi><mo id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.1b" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.5" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.5.cmml">k</mi></mrow></msub><mo fence="false" id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.1" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.1.cmml">|</mo><msup id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3.cmml"><mi id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3.2" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3.2.cmml">θ</mi><mo id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3.3" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3.3.cmml">∗</mo></msup></mrow><mo id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.5" stretchy="false" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.3.cmml">)</mo></mrow><mo id="A1.Ex2Xf.2.1.1.m1.2.2.3b" xref="A1.Ex2Xf.2.1.1.m1.2.2.3.cmml">⁢</mo><mtext id="A1.Ex2Xf.2.1.1.m1.2.2.6" xref="A1.Ex2Xf.2.1.1.m1.2.2.6a.cmml">)</mtext></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2Xf.2.1.1.m1.2b"><apply id="A1.Ex2Xf.2.1.1.m1.2.2.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2"><times id="A1.Ex2Xf.2.1.1.m1.2.2.3.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.3"></times><ci id="A1.Ex2Xf.2.1.1.m1.2.2.4a.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.4"><mtext id="A1.Ex2Xf.2.1.1.m1.2.2.4.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.4">(Law of total prob,Markov property,divide by a constant </mtext></ci><ci id="A1.Ex2Xf.2.1.1.m1.2.2.5.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.5">𝑃</ci><interval closure="open" id="A1.Ex2Xf.2.1.1.m1.2.2.2.3.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2"><apply id="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1.cmml" xref="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1.2.cmml" xref="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1.2">𝐿</ci><ci id="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1.3.cmml" xref="A1.Ex2Xf.2.1.1.m1.1.1.1.1.1.3">𝑀</ci></apply><apply id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2"><csymbol cd="latexml" id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.1.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.1">conditional</csymbol><apply id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.1.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.2">𝐷</ci><apply id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3"><times id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.1.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.1"></times><ci id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.2.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.2">𝑡</ci><ci id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.3.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.3">𝑎</ci><ci id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.4.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.4">𝑠</ci><ci id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.5.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.2.3.5">𝑘</ci></apply></apply><apply id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3.1.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3">superscript</csymbol><ci id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3.2.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3.2">𝜃</ci><times id="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3.3.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.2.2.2.3.3"></times></apply></apply></interval><ci id="A1.Ex2Xf.2.1.1.m1.2.2.6a.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.6"><mtext id="A1.Ex2Xf.2.1.1.m1.2.2.6.cmml" xref="A1.Ex2Xf.2.1.1.m1.2.2.6">)</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2Xf.2.1.1.m1.2c">\displaystyle\text{(Law of total prob,Markov property,divide by a constant }P(%
L_{M},D_{task}|\theta^{*})\text{) }</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2Xf.2.1.1.m1.2d">(Law of total prob,Markov property,divide by a constant italic_P ( italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT | italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex2Xg"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int_{\Theta}P(Y=y|L_{M},D_{task},\theta)exp(M\cdot r_{M}(\theta%
))P(\theta)d\theta" class="ltx_Math" display="inline" id="A1.Ex2Xg.2.1.1.m1.5"><semantics id="A1.Ex2Xg.2.1.1.m1.5a"><mrow id="A1.Ex2Xg.2.1.1.m1.5.5" xref="A1.Ex2Xg.2.1.1.m1.5.5.cmml"><mi id="A1.Ex2Xg.2.1.1.m1.5.5.4" xref="A1.Ex2Xg.2.1.1.m1.5.5.4.cmml"></mi><mo id="A1.Ex2Xg.2.1.1.m1.5.5.3" xref="A1.Ex2Xg.2.1.1.m1.5.5.3.cmml">=</mo><mrow id="A1.Ex2Xg.2.1.1.m1.5.5.2" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.cmml"><mstyle displaystyle="true" id="A1.Ex2Xg.2.1.1.m1.5.5.2.3" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.3.cmml"><msub id="A1.Ex2Xg.2.1.1.m1.5.5.2.3a" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.3.cmml"><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.3.2" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.3.2.cmml">∫</mo><mi id="A1.Ex2Xg.2.1.1.m1.5.5.2.3.3" mathvariant="normal" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.3.3.cmml">Θ</mi></msub></mstyle><mrow id="A1.Ex2Xg.2.1.1.m1.5.5.2.2" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.cmml"><mi id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.4" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.4.cmml">P</mi><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3.cmml">⁢</mo><mrow id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.cmml"><mo id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.2" stretchy="false" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.cmml"><mi id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.4" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.4.cmml">Y</mi><mo id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.3" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.3.cmml">=</mo><mrow id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.cmml"><mi id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.4" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.4.cmml">y</mi><mo fence="false" id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.3" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.3.cmml">|</mo><mrow id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.3.cmml"><msub id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">L</mi><mi id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></msub><mo id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.3" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.2" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.2.cmml">D</mi><mrow id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.2" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.2.cmml">t</mi><mo id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.1" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.3" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.3.cmml">a</mi><mo id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.1a" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.4" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.4.cmml">s</mi><mo id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.1b" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.5" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.5.cmml">k</mi></mrow></msub><mo id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.4" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="A1.Ex2Xg.2.1.1.m1.1.1" xref="A1.Ex2Xg.2.1.1.m1.1.1.cmml">θ</mi></mrow></mrow></mrow><mo id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.3" stretchy="false" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3a" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3.cmml">⁢</mo><mi id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.5" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.5.cmml">e</mi><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3b" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3.cmml">⁢</mo><mi id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.6" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.6.cmml">x</mi><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3c" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3.cmml">⁢</mo><mi id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.7" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.7.cmml">p</mi><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3d" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3.cmml">⁢</mo><mrow id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.cmml"><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.2" stretchy="false" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.cmml">(</mo><mrow id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.cmml"><mrow id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.cmml"><mi id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.2" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.2.cmml">M</mi><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.1.cmml">⋅</mo><msub id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3.cmml"><mi id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3.2" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3.2.cmml">r</mi><mi id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3.3" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3.3.cmml">M</mi></msub></mrow><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.1" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.1.cmml">⁢</mo><mrow id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.3.2" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.cmml"><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.3.2.1" stretchy="false" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.cmml">(</mo><mi id="A1.Ex2Xg.2.1.1.m1.2.2" xref="A1.Ex2Xg.2.1.1.m1.2.2.cmml">θ</mi><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.3.2.2" stretchy="false" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.3" stretchy="false" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.cmml">)</mo></mrow><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3e" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3.cmml">⁢</mo><mi id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.8" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.8.cmml">P</mi><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3f" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3.cmml">⁢</mo><mrow id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.9.2" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.cmml"><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.9.2.1" stretchy="false" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.cmml">(</mo><mi id="A1.Ex2Xg.2.1.1.m1.3.3" xref="A1.Ex2Xg.2.1.1.m1.3.3.cmml">θ</mi><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.9.2.2" stretchy="false" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.cmml">)</mo></mrow><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3g" lspace="0em" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3.cmml">⁢</mo><mrow id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.10" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.10.cmml"><mo id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.10.1" rspace="0em" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.10.1.cmml">𝑑</mo><mi id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.10.2" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.10.2.cmml">θ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex2Xg.2.1.1.m1.5b"><apply id="A1.Ex2Xg.2.1.1.m1.5.5.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5"><eq id="A1.Ex2Xg.2.1.1.m1.5.5.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.3"></eq><csymbol cd="latexml" id="A1.Ex2Xg.2.1.1.m1.5.5.4.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.4">absent</csymbol><apply id="A1.Ex2Xg.2.1.1.m1.5.5.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2"><apply id="A1.Ex2Xg.2.1.1.m1.5.5.2.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.3"><csymbol cd="ambiguous" id="A1.Ex2Xg.2.1.1.m1.5.5.2.3.1.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.3">subscript</csymbol><int id="A1.Ex2Xg.2.1.1.m1.5.5.2.3.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.3.2"></int><ci id="A1.Ex2Xg.2.1.1.m1.5.5.2.3.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.3.3">Θ</ci></apply><apply id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2"><times id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.3"></times><ci id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.4.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.4">𝑃</ci><apply id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1"><eq id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.3"></eq><ci id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.4.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.4">𝑌</ci><apply id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2"><csymbol cd="latexml" id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.3">conditional</csymbol><ci id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.4.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.4">𝑦</ci><list id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2"><apply id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝐿</ci><ci id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.2">𝐷</ci><apply id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3"><times id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.2">𝑡</ci><ci id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.3">𝑎</ci><ci id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.4.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.4">𝑠</ci><ci id="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.5.cmml" xref="A1.Ex2Xg.2.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.3.5">𝑘</ci></apply></apply><ci id="A1.Ex2Xg.2.1.1.m1.1.1.cmml" xref="A1.Ex2Xg.2.1.1.m1.1.1">𝜃</ci></list></apply></apply><ci id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.5.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.5">𝑒</ci><ci id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.6.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.6">𝑥</ci><ci id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.7.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.7">𝑝</ci><apply id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1"><times id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.1.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.1"></times><apply id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2"><ci id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.1.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.1">⋅</ci><ci id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.2">𝑀</ci><apply id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3.1.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3">subscript</csymbol><ci id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3.2">𝑟</ci><ci id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.2.1.1.2.3.3">𝑀</ci></apply></apply><ci id="A1.Ex2Xg.2.1.1.m1.2.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.2.2">𝜃</ci></apply><ci id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.8.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.8">𝑃</ci><ci id="A1.Ex2Xg.2.1.1.m1.3.3.cmml" xref="A1.Ex2Xg.2.1.1.m1.3.3">𝜃</ci><apply id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.10.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.10"><csymbol cd="latexml" id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.10.1.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.10.1">differential-d</csymbol><ci id="A1.Ex2Xg.2.1.1.m1.5.5.2.2.10.2.cmml" xref="A1.Ex2Xg.2.1.1.m1.5.5.2.2.10.2">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex2Xg.2.1.1.m1.5c">\displaystyle=\int_{\Theta}P(Y=y|L_{M},D_{task},\theta)exp(M\cdot r_{M}(\theta%
))P(\theta)d\theta</annotation><annotation encoding="application/x-llamapun" id="A1.Ex2Xg.2.1.1.m1.5d">= ∫ start_POSTSUBSCRIPT roman_Θ end_POSTSUBSCRIPT italic_P ( italic_Y = italic_y | italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT , italic_θ ) italic_e italic_x italic_p ( italic_M ⋅ italic_r start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_θ ) ) italic_P ( italic_θ ) italic_d italic_θ</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.p2.6">where <math alttext="r_{M}(\theta)=\frac{1}{M}log(\frac{P(L_{M},D_{task}|\theta)}{P(L_{M},D_{task}|%
\theta^{*})})" class="ltx_Math" display="inline" id="A1.SS1.p2.1.m1.5"><semantics id="A1.SS1.p2.1.m1.5a"><mrow id="A1.SS1.p2.1.m1.5.6" xref="A1.SS1.p2.1.m1.5.6.cmml"><mrow id="A1.SS1.p2.1.m1.5.6.2" xref="A1.SS1.p2.1.m1.5.6.2.cmml"><msub id="A1.SS1.p2.1.m1.5.6.2.2" xref="A1.SS1.p2.1.m1.5.6.2.2.cmml"><mi id="A1.SS1.p2.1.m1.5.6.2.2.2" xref="A1.SS1.p2.1.m1.5.6.2.2.2.cmml">r</mi><mi id="A1.SS1.p2.1.m1.5.6.2.2.3" xref="A1.SS1.p2.1.m1.5.6.2.2.3.cmml">M</mi></msub><mo id="A1.SS1.p2.1.m1.5.6.2.1" xref="A1.SS1.p2.1.m1.5.6.2.1.cmml">⁢</mo><mrow id="A1.SS1.p2.1.m1.5.6.2.3.2" xref="A1.SS1.p2.1.m1.5.6.2.cmml"><mo id="A1.SS1.p2.1.m1.5.6.2.3.2.1" stretchy="false" xref="A1.SS1.p2.1.m1.5.6.2.cmml">(</mo><mi id="A1.SS1.p2.1.m1.5.5" xref="A1.SS1.p2.1.m1.5.5.cmml">θ</mi><mo id="A1.SS1.p2.1.m1.5.6.2.3.2.2" stretchy="false" xref="A1.SS1.p2.1.m1.5.6.2.cmml">)</mo></mrow></mrow><mo id="A1.SS1.p2.1.m1.5.6.1" xref="A1.SS1.p2.1.m1.5.6.1.cmml">=</mo><mrow id="A1.SS1.p2.1.m1.5.6.3" xref="A1.SS1.p2.1.m1.5.6.3.cmml"><mfrac id="A1.SS1.p2.1.m1.5.6.3.2" xref="A1.SS1.p2.1.m1.5.6.3.2.cmml"><mn id="A1.SS1.p2.1.m1.5.6.3.2.2" xref="A1.SS1.p2.1.m1.5.6.3.2.2.cmml">1</mn><mi id="A1.SS1.p2.1.m1.5.6.3.2.3" xref="A1.SS1.p2.1.m1.5.6.3.2.3.cmml">M</mi></mfrac><mo id="A1.SS1.p2.1.m1.5.6.3.1" xref="A1.SS1.p2.1.m1.5.6.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.1.m1.5.6.3.3" xref="A1.SS1.p2.1.m1.5.6.3.3.cmml">l</mi><mo id="A1.SS1.p2.1.m1.5.6.3.1a" xref="A1.SS1.p2.1.m1.5.6.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.1.m1.5.6.3.4" xref="A1.SS1.p2.1.m1.5.6.3.4.cmml">o</mi><mo id="A1.SS1.p2.1.m1.5.6.3.1b" xref="A1.SS1.p2.1.m1.5.6.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.1.m1.5.6.3.5" xref="A1.SS1.p2.1.m1.5.6.3.5.cmml">g</mi><mo id="A1.SS1.p2.1.m1.5.6.3.1c" xref="A1.SS1.p2.1.m1.5.6.3.1.cmml">⁢</mo><mrow id="A1.SS1.p2.1.m1.5.6.3.6.2" xref="A1.SS1.p2.1.m1.4.4.cmml"><mo id="A1.SS1.p2.1.m1.5.6.3.6.2.1" stretchy="false" xref="A1.SS1.p2.1.m1.4.4.cmml">(</mo><mfrac id="A1.SS1.p2.1.m1.4.4" xref="A1.SS1.p2.1.m1.4.4.cmml"><mrow id="A1.SS1.p2.1.m1.2.2.2" xref="A1.SS1.p2.1.m1.2.2.2.cmml"><mi id="A1.SS1.p2.1.m1.2.2.2.4" xref="A1.SS1.p2.1.m1.2.2.2.4.cmml">P</mi><mo id="A1.SS1.p2.1.m1.2.2.2.3" xref="A1.SS1.p2.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.SS1.p2.1.m1.2.2.2.2.2" xref="A1.SS1.p2.1.m1.2.2.2.2.3.cmml"><mo id="A1.SS1.p2.1.m1.2.2.2.2.2.3" stretchy="false" xref="A1.SS1.p2.1.m1.2.2.2.2.3.cmml">(</mo><msub id="A1.SS1.p2.1.m1.1.1.1.1.1.1" xref="A1.SS1.p2.1.m1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.p2.1.m1.1.1.1.1.1.1.2" xref="A1.SS1.p2.1.m1.1.1.1.1.1.1.2.cmml">L</mi><mi id="A1.SS1.p2.1.m1.1.1.1.1.1.1.3" xref="A1.SS1.p2.1.m1.1.1.1.1.1.1.3.cmml">M</mi></msub><mo id="A1.SS1.p2.1.m1.2.2.2.2.2.4" xref="A1.SS1.p2.1.m1.2.2.2.2.3.cmml">,</mo><mrow id="A1.SS1.p2.1.m1.2.2.2.2.2.2" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.cmml"><msub id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.cmml"><mi id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.2" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.2.cmml">D</mi><mrow id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.cmml"><mi id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.2" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.1" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.3" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.3.cmml">a</mi><mo id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.1a" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.4" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.4.cmml">s</mi><mo id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.1b" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.5" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.5.cmml">k</mi></mrow></msub><mo fence="false" id="A1.SS1.p2.1.m1.2.2.2.2.2.2.1" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.1.cmml">|</mo><mi id="A1.SS1.p2.1.m1.2.2.2.2.2.2.3" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.3.cmml">θ</mi></mrow><mo id="A1.SS1.p2.1.m1.2.2.2.2.2.5" stretchy="false" xref="A1.SS1.p2.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="A1.SS1.p2.1.m1.4.4.4" xref="A1.SS1.p2.1.m1.4.4.4.cmml"><mi id="A1.SS1.p2.1.m1.4.4.4.4" xref="A1.SS1.p2.1.m1.4.4.4.4.cmml">P</mi><mo id="A1.SS1.p2.1.m1.4.4.4.3" xref="A1.SS1.p2.1.m1.4.4.4.3.cmml">⁢</mo><mrow id="A1.SS1.p2.1.m1.4.4.4.2.2" xref="A1.SS1.p2.1.m1.4.4.4.2.3.cmml"><mo id="A1.SS1.p2.1.m1.4.4.4.2.2.3" stretchy="false" xref="A1.SS1.p2.1.m1.4.4.4.2.3.cmml">(</mo><msub id="A1.SS1.p2.1.m1.3.3.3.1.1.1" xref="A1.SS1.p2.1.m1.3.3.3.1.1.1.cmml"><mi id="A1.SS1.p2.1.m1.3.3.3.1.1.1.2" xref="A1.SS1.p2.1.m1.3.3.3.1.1.1.2.cmml">L</mi><mi id="A1.SS1.p2.1.m1.3.3.3.1.1.1.3" xref="A1.SS1.p2.1.m1.3.3.3.1.1.1.3.cmml">M</mi></msub><mo id="A1.SS1.p2.1.m1.4.4.4.2.2.4" xref="A1.SS1.p2.1.m1.4.4.4.2.3.cmml">,</mo><mrow id="A1.SS1.p2.1.m1.4.4.4.2.2.2" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.cmml"><msub id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.cmml"><mi id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.2" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.2.cmml">D</mi><mrow id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.cmml"><mi id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.2" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.2.cmml">t</mi><mo id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.1" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.3" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.3.cmml">a</mi><mo id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.1a" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.4" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.4.cmml">s</mi><mo id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.1b" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.5" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.5.cmml">k</mi></mrow></msub><mo fence="false" id="A1.SS1.p2.1.m1.4.4.4.2.2.2.1" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.1.cmml">|</mo><msup id="A1.SS1.p2.1.m1.4.4.4.2.2.2.3" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.3.cmml"><mi id="A1.SS1.p2.1.m1.4.4.4.2.2.2.3.2" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.3.2.cmml">θ</mi><mo id="A1.SS1.p2.1.m1.4.4.4.2.2.2.3.3" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.3.3.cmml">∗</mo></msup></mrow><mo id="A1.SS1.p2.1.m1.4.4.4.2.2.5" stretchy="false" xref="A1.SS1.p2.1.m1.4.4.4.2.3.cmml">)</mo></mrow></mrow></mfrac><mo id="A1.SS1.p2.1.m1.5.6.3.6.2.2" stretchy="false" xref="A1.SS1.p2.1.m1.4.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.5b"><apply id="A1.SS1.p2.1.m1.5.6.cmml" xref="A1.SS1.p2.1.m1.5.6"><eq id="A1.SS1.p2.1.m1.5.6.1.cmml" xref="A1.SS1.p2.1.m1.5.6.1"></eq><apply id="A1.SS1.p2.1.m1.5.6.2.cmml" xref="A1.SS1.p2.1.m1.5.6.2"><times id="A1.SS1.p2.1.m1.5.6.2.1.cmml" xref="A1.SS1.p2.1.m1.5.6.2.1"></times><apply id="A1.SS1.p2.1.m1.5.6.2.2.cmml" xref="A1.SS1.p2.1.m1.5.6.2.2"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.5.6.2.2.1.cmml" xref="A1.SS1.p2.1.m1.5.6.2.2">subscript</csymbol><ci id="A1.SS1.p2.1.m1.5.6.2.2.2.cmml" xref="A1.SS1.p2.1.m1.5.6.2.2.2">𝑟</ci><ci id="A1.SS1.p2.1.m1.5.6.2.2.3.cmml" xref="A1.SS1.p2.1.m1.5.6.2.2.3">𝑀</ci></apply><ci id="A1.SS1.p2.1.m1.5.5.cmml" xref="A1.SS1.p2.1.m1.5.5">𝜃</ci></apply><apply id="A1.SS1.p2.1.m1.5.6.3.cmml" xref="A1.SS1.p2.1.m1.5.6.3"><times id="A1.SS1.p2.1.m1.5.6.3.1.cmml" xref="A1.SS1.p2.1.m1.5.6.3.1"></times><apply id="A1.SS1.p2.1.m1.5.6.3.2.cmml" xref="A1.SS1.p2.1.m1.5.6.3.2"><divide id="A1.SS1.p2.1.m1.5.6.3.2.1.cmml" xref="A1.SS1.p2.1.m1.5.6.3.2"></divide><cn id="A1.SS1.p2.1.m1.5.6.3.2.2.cmml" type="integer" xref="A1.SS1.p2.1.m1.5.6.3.2.2">1</cn><ci id="A1.SS1.p2.1.m1.5.6.3.2.3.cmml" xref="A1.SS1.p2.1.m1.5.6.3.2.3">𝑀</ci></apply><ci id="A1.SS1.p2.1.m1.5.6.3.3.cmml" xref="A1.SS1.p2.1.m1.5.6.3.3">𝑙</ci><ci id="A1.SS1.p2.1.m1.5.6.3.4.cmml" xref="A1.SS1.p2.1.m1.5.6.3.4">𝑜</ci><ci id="A1.SS1.p2.1.m1.5.6.3.5.cmml" xref="A1.SS1.p2.1.m1.5.6.3.5">𝑔</ci><apply id="A1.SS1.p2.1.m1.4.4.cmml" xref="A1.SS1.p2.1.m1.5.6.3.6.2"><divide id="A1.SS1.p2.1.m1.4.4.5.cmml" xref="A1.SS1.p2.1.m1.5.6.3.6.2"></divide><apply id="A1.SS1.p2.1.m1.2.2.2.cmml" xref="A1.SS1.p2.1.m1.2.2.2"><times id="A1.SS1.p2.1.m1.2.2.2.3.cmml" xref="A1.SS1.p2.1.m1.2.2.2.3"></times><ci id="A1.SS1.p2.1.m1.2.2.2.4.cmml" xref="A1.SS1.p2.1.m1.2.2.2.4">𝑃</ci><interval closure="open" id="A1.SS1.p2.1.m1.2.2.2.2.3.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2"><apply id="A1.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p2.1.m1.1.1.1.1.1.1.2">𝐿</ci><ci id="A1.SS1.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.p2.1.m1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="A1.SS1.p2.1.m1.2.2.2.2.2.2.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2"><csymbol cd="latexml" id="A1.SS1.p2.1.m1.2.2.2.2.2.2.1.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.1">conditional</csymbol><apply id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.1.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.2.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.2">𝐷</ci><apply id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3"><times id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.1.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.1"></times><ci id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.2.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.2">𝑡</ci><ci id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.3.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.3">𝑎</ci><ci id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.4.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.4">𝑠</ci><ci id="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.5.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.2.3.5">𝑘</ci></apply></apply><ci id="A1.SS1.p2.1.m1.2.2.2.2.2.2.3.cmml" xref="A1.SS1.p2.1.m1.2.2.2.2.2.2.3">𝜃</ci></apply></interval></apply><apply id="A1.SS1.p2.1.m1.4.4.4.cmml" xref="A1.SS1.p2.1.m1.4.4.4"><times id="A1.SS1.p2.1.m1.4.4.4.3.cmml" xref="A1.SS1.p2.1.m1.4.4.4.3"></times><ci id="A1.SS1.p2.1.m1.4.4.4.4.cmml" xref="A1.SS1.p2.1.m1.4.4.4.4">𝑃</ci><interval closure="open" id="A1.SS1.p2.1.m1.4.4.4.2.3.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2"><apply id="A1.SS1.p2.1.m1.3.3.3.1.1.1.cmml" xref="A1.SS1.p2.1.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.3.3.3.1.1.1.1.cmml" xref="A1.SS1.p2.1.m1.3.3.3.1.1.1">subscript</csymbol><ci id="A1.SS1.p2.1.m1.3.3.3.1.1.1.2.cmml" xref="A1.SS1.p2.1.m1.3.3.3.1.1.1.2">𝐿</ci><ci id="A1.SS1.p2.1.m1.3.3.3.1.1.1.3.cmml" xref="A1.SS1.p2.1.m1.3.3.3.1.1.1.3">𝑀</ci></apply><apply id="A1.SS1.p2.1.m1.4.4.4.2.2.2.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2"><csymbol cd="latexml" id="A1.SS1.p2.1.m1.4.4.4.2.2.2.1.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.1">conditional</csymbol><apply id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.1.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2">subscript</csymbol><ci id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.2.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.2">𝐷</ci><apply id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3"><times id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.1.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.1"></times><ci id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.2.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.2">𝑡</ci><ci id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.3.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.3">𝑎</ci><ci id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.4.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.4">𝑠</ci><ci id="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.5.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.2.3.5">𝑘</ci></apply></apply><apply id="A1.SS1.p2.1.m1.4.4.4.2.2.2.3.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.3"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.4.4.4.2.2.2.3.1.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.3">superscript</csymbol><ci id="A1.SS1.p2.1.m1.4.4.4.2.2.2.3.2.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.3.2">𝜃</ci><times id="A1.SS1.p2.1.m1.4.4.4.2.2.2.3.3.cmml" xref="A1.SS1.p2.1.m1.4.4.4.2.2.2.3.3"></times></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.5c">r_{M}(\theta)=\frac{1}{M}log(\frac{P(L_{M},D_{task}|\theta)}{P(L_{M},D_{task}|%
\theta^{*})})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.1.m1.5d">italic_r start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_θ ) = divide start_ARG 1 end_ARG start_ARG italic_M end_ARG italic_l italic_o italic_g ( divide start_ARG italic_P ( italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT | italic_θ ) end_ARG start_ARG italic_P ( italic_L start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_t italic_a italic_s italic_k end_POSTSUBSCRIPT | italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) end_ARG )</annotation></semantics></math>. Following  <cite class="ltx_cite ltx_citemacro_citep">(Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.06577v1#bib.bib39" title="">2022</a>)</cite>, <math alttext="exp(M\cdot r_{M}(\theta))\to 0" class="ltx_Math" display="inline" id="A1.SS1.p2.2.m2.2"><semantics id="A1.SS1.p2.2.m2.2a"><mrow id="A1.SS1.p2.2.m2.2.2" xref="A1.SS1.p2.2.m2.2.2.cmml"><mrow id="A1.SS1.p2.2.m2.2.2.1" xref="A1.SS1.p2.2.m2.2.2.1.cmml"><mi id="A1.SS1.p2.2.m2.2.2.1.3" xref="A1.SS1.p2.2.m2.2.2.1.3.cmml">e</mi><mo id="A1.SS1.p2.2.m2.2.2.1.2" xref="A1.SS1.p2.2.m2.2.2.1.2.cmml">⁢</mo><mi id="A1.SS1.p2.2.m2.2.2.1.4" xref="A1.SS1.p2.2.m2.2.2.1.4.cmml">x</mi><mo id="A1.SS1.p2.2.m2.2.2.1.2a" xref="A1.SS1.p2.2.m2.2.2.1.2.cmml">⁢</mo><mi id="A1.SS1.p2.2.m2.2.2.1.5" xref="A1.SS1.p2.2.m2.2.2.1.5.cmml">p</mi><mo id="A1.SS1.p2.2.m2.2.2.1.2b" xref="A1.SS1.p2.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="A1.SS1.p2.2.m2.2.2.1.1.1" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.cmml"><mo id="A1.SS1.p2.2.m2.2.2.1.1.1.2" stretchy="false" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.p2.2.m2.2.2.1.1.1.1" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.cmml"><mrow id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.cmml"><mi id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.2" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.2.cmml">M</mi><mo id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.1.cmml">⋅</mo><msub id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3.cmml"><mi id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3.2" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3.2.cmml">r</mi><mi id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3.3" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3.3.cmml">M</mi></msub></mrow><mo id="A1.SS1.p2.2.m2.2.2.1.1.1.1.1" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="A1.SS1.p2.2.m2.2.2.1.1.1.1.3.2" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.cmml"><mo id="A1.SS1.p2.2.m2.2.2.1.1.1.1.3.2.1" stretchy="false" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.cmml">(</mo><mi id="A1.SS1.p2.2.m2.1.1" xref="A1.SS1.p2.2.m2.1.1.cmml">θ</mi><mo id="A1.SS1.p2.2.m2.2.2.1.1.1.1.3.2.2" stretchy="false" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS1.p2.2.m2.2.2.1.1.1.3" stretchy="false" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS1.p2.2.m2.2.2.2" stretchy="false" xref="A1.SS1.p2.2.m2.2.2.2.cmml">→</mo><mn id="A1.SS1.p2.2.m2.2.2.3" xref="A1.SS1.p2.2.m2.2.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.2.m2.2b"><apply id="A1.SS1.p2.2.m2.2.2.cmml" xref="A1.SS1.p2.2.m2.2.2"><ci id="A1.SS1.p2.2.m2.2.2.2.cmml" xref="A1.SS1.p2.2.m2.2.2.2">→</ci><apply id="A1.SS1.p2.2.m2.2.2.1.cmml" xref="A1.SS1.p2.2.m2.2.2.1"><times id="A1.SS1.p2.2.m2.2.2.1.2.cmml" xref="A1.SS1.p2.2.m2.2.2.1.2"></times><ci id="A1.SS1.p2.2.m2.2.2.1.3.cmml" xref="A1.SS1.p2.2.m2.2.2.1.3">𝑒</ci><ci id="A1.SS1.p2.2.m2.2.2.1.4.cmml" xref="A1.SS1.p2.2.m2.2.2.1.4">𝑥</ci><ci id="A1.SS1.p2.2.m2.2.2.1.5.cmml" xref="A1.SS1.p2.2.m2.2.2.1.5">𝑝</ci><apply id="A1.SS1.p2.2.m2.2.2.1.1.1.1.cmml" xref="A1.SS1.p2.2.m2.2.2.1.1.1"><times id="A1.SS1.p2.2.m2.2.2.1.1.1.1.1.cmml" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.1"></times><apply id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.cmml" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2"><ci id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.1.cmml" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.1">⋅</ci><ci id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.2.cmml" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.2">𝑀</ci><apply id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3.cmml" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3.1.cmml" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3.2.cmml" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3.2">𝑟</ci><ci id="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3.3.cmml" xref="A1.SS1.p2.2.m2.2.2.1.1.1.1.2.3.3">𝑀</ci></apply></apply><ci id="A1.SS1.p2.2.m2.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1">𝜃</ci></apply></apply><cn id="A1.SS1.p2.2.m2.2.2.3.cmml" type="integer" xref="A1.SS1.p2.2.m2.2.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.2.m2.2c">exp(M\cdot r_{M}(\theta))\to 0</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.2.m2.2d">italic_e italic_x italic_p ( italic_M ⋅ italic_r start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_θ ) ) → 0</annotation></semantics></math> for all concepts <math alttext="\theta" class="ltx_Math" display="inline" id="A1.SS1.p2.3.m3.1"><semantics id="A1.SS1.p2.3.m3.1a"><mi id="A1.SS1.p2.3.m3.1.1" xref="A1.SS1.p2.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.3.m3.1b"><ci id="A1.SS1.p2.3.m3.1.1.cmml" xref="A1.SS1.p2.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.3.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.3.m3.1d">italic_θ</annotation></semantics></math> except the optimal prompt concept <math alttext="\theta^{*}" class="ltx_Math" display="inline" id="A1.SS1.p2.4.m4.1"><semantics id="A1.SS1.p2.4.m4.1a"><msup id="A1.SS1.p2.4.m4.1.1" xref="A1.SS1.p2.4.m4.1.1.cmml"><mi id="A1.SS1.p2.4.m4.1.1.2" xref="A1.SS1.p2.4.m4.1.1.2.cmml">θ</mi><mo id="A1.SS1.p2.4.m4.1.1.3" xref="A1.SS1.p2.4.m4.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.4.m4.1b"><apply id="A1.SS1.p2.4.m4.1.1.cmml" xref="A1.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.4.m4.1.1.1.cmml" xref="A1.SS1.p2.4.m4.1.1">superscript</csymbol><ci id="A1.SS1.p2.4.m4.1.1.2.cmml" xref="A1.SS1.p2.4.m4.1.1.2">𝜃</ci><times id="A1.SS1.p2.4.m4.1.1.3.cmml" xref="A1.SS1.p2.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.4.m4.1c">\theta^{*}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.4.m4.1d">italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, where<math alttext="exp(M\cdot r_{M}(\theta^{*}))=1" class="ltx_Math" display="inline" id="A1.SS1.p2.5.m5.1"><semantics id="A1.SS1.p2.5.m5.1a"><mrow id="A1.SS1.p2.5.m5.1.1" xref="A1.SS1.p2.5.m5.1.1.cmml"><mrow id="A1.SS1.p2.5.m5.1.1.1" xref="A1.SS1.p2.5.m5.1.1.1.cmml"><mi id="A1.SS1.p2.5.m5.1.1.1.3" xref="A1.SS1.p2.5.m5.1.1.1.3.cmml">e</mi><mo id="A1.SS1.p2.5.m5.1.1.1.2" xref="A1.SS1.p2.5.m5.1.1.1.2.cmml">⁢</mo><mi id="A1.SS1.p2.5.m5.1.1.1.4" xref="A1.SS1.p2.5.m5.1.1.1.4.cmml">x</mi><mo id="A1.SS1.p2.5.m5.1.1.1.2a" xref="A1.SS1.p2.5.m5.1.1.1.2.cmml">⁢</mo><mi id="A1.SS1.p2.5.m5.1.1.1.5" xref="A1.SS1.p2.5.m5.1.1.1.5.cmml">p</mi><mo id="A1.SS1.p2.5.m5.1.1.1.2b" xref="A1.SS1.p2.5.m5.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.p2.5.m5.1.1.1.1.1" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.cmml"><mo id="A1.SS1.p2.5.m5.1.1.1.1.1.2" stretchy="false" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.p2.5.m5.1.1.1.1.1.1" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.cmml"><mrow id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.cmml"><mi id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.2" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.2.cmml">M</mi><mo id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.1.cmml">⋅</mo><msub id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3.cmml"><mi id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3.2" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3.2.cmml">r</mi><mi id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3.3" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3.3.cmml">M</mi></msub></mrow><mo id="A1.SS1.p2.5.m5.1.1.1.1.1.1.2" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.2" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mo id="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.3" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS1.p2.5.m5.1.1.1.1.1.3" stretchy="false" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS1.p2.5.m5.1.1.2" xref="A1.SS1.p2.5.m5.1.1.2.cmml">=</mo><mn id="A1.SS1.p2.5.m5.1.1.3" xref="A1.SS1.p2.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.5.m5.1b"><apply id="A1.SS1.p2.5.m5.1.1.cmml" xref="A1.SS1.p2.5.m5.1.1"><eq id="A1.SS1.p2.5.m5.1.1.2.cmml" xref="A1.SS1.p2.5.m5.1.1.2"></eq><apply id="A1.SS1.p2.5.m5.1.1.1.cmml" xref="A1.SS1.p2.5.m5.1.1.1"><times id="A1.SS1.p2.5.m5.1.1.1.2.cmml" xref="A1.SS1.p2.5.m5.1.1.1.2"></times><ci id="A1.SS1.p2.5.m5.1.1.1.3.cmml" xref="A1.SS1.p2.5.m5.1.1.1.3">𝑒</ci><ci id="A1.SS1.p2.5.m5.1.1.1.4.cmml" xref="A1.SS1.p2.5.m5.1.1.1.4">𝑥</ci><ci id="A1.SS1.p2.5.m5.1.1.1.5.cmml" xref="A1.SS1.p2.5.m5.1.1.1.5">𝑝</ci><apply id="A1.SS1.p2.5.m5.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1"><times id="A1.SS1.p2.5.m5.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.2"></times><apply id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3"><ci id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.1.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.1">⋅</ci><ci id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.2.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.2">𝑀</ci><apply id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3.1.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3.2.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3.2">𝑟</ci><ci id="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3.3.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.3.3.3">𝑀</ci></apply></apply><apply id="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.2">𝜃</ci><times id="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.3"></times></apply></apply></apply><cn id="A1.SS1.p2.5.m5.1.1.3.cmml" type="integer" xref="A1.SS1.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.5.m5.1c">exp(M\cdot r_{M}(\theta^{*}))=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.5.m5.1d">italic_e italic_x italic_p ( italic_M ⋅ italic_r start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) ) = 1</annotation></semantics></math>. Hence, the only nonzero possibility in the integral is when <math alttext="\theta=\theta^{*}" class="ltx_Math" display="inline" id="A1.SS1.p2.6.m6.1"><semantics id="A1.SS1.p2.6.m6.1a"><mrow id="A1.SS1.p2.6.m6.1.1" xref="A1.SS1.p2.6.m6.1.1.cmml"><mi id="A1.SS1.p2.6.m6.1.1.2" xref="A1.SS1.p2.6.m6.1.1.2.cmml">θ</mi><mo id="A1.SS1.p2.6.m6.1.1.1" xref="A1.SS1.p2.6.m6.1.1.1.cmml">=</mo><msup id="A1.SS1.p2.6.m6.1.1.3" xref="A1.SS1.p2.6.m6.1.1.3.cmml"><mi id="A1.SS1.p2.6.m6.1.1.3.2" xref="A1.SS1.p2.6.m6.1.1.3.2.cmml">θ</mi><mo id="A1.SS1.p2.6.m6.1.1.3.3" xref="A1.SS1.p2.6.m6.1.1.3.3.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.6.m6.1b"><apply id="A1.SS1.p2.6.m6.1.1.cmml" xref="A1.SS1.p2.6.m6.1.1"><eq id="A1.SS1.p2.6.m6.1.1.1.cmml" xref="A1.SS1.p2.6.m6.1.1.1"></eq><ci id="A1.SS1.p2.6.m6.1.1.2.cmml" xref="A1.SS1.p2.6.m6.1.1.2">𝜃</ci><apply id="A1.SS1.p2.6.m6.1.1.3.cmml" xref="A1.SS1.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m6.1.1.3.1.cmml" xref="A1.SS1.p2.6.m6.1.1.3">superscript</csymbol><ci id="A1.SS1.p2.6.m6.1.1.3.2.cmml" xref="A1.SS1.p2.6.m6.1.1.3.2">𝜃</ci><times id="A1.SS1.p2.6.m6.1.1.3.3.cmml" xref="A1.SS1.p2.6.m6.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.6.m6.1c">\theta=\theta^{*}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.6.m6.1d">italic_θ = italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, and thus the prompt concept is “selected” as a consequence of Bayesian inference.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Aug 13 02:21:40 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
