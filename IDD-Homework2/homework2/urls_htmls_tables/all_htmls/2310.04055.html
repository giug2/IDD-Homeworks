<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2310.04055] Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning</title><meta property="og:description" content="Federated Learning (FL) systems are vulnerable to adversarial attacks, where malicious clients submit poisoned models to prevent the global model from converging or plant backdoors to induce the global model to misclas…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2310.04055">

<!--Generated on Wed Feb 28 02:24:09 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Machine Learning,  ICML">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Kick Bad Guys Out! Zero-Knowledge-Proof-Based 
<br class="ltx_break">Anomaly Detection in Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shanshan Han
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wenxuan Wu
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Baturalp Buyukates
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Weizhao Jin
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qifan Zhang
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuhang Yao
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Salman Avestimehr
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chaoyang He
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated Learning (FL) systems are vulnerable to adversarial attacks, where malicious clients submit poisoned models to prevent the global model from converging or plant backdoors to induce the global model to misclassify some samples.
Current defense methods fall short in real-world FL systems, as they either rely on impractical prior knowledge or introduce accuracy loss even when no attack happens. Also, these methods do not offer a protocol for verifying the execution, leaving participants doubtful about the correct execution of the mechanism.
To address these issues, we propose a novel anomaly detection strategy designed for real-world FL systems. Our approach activates the defense only upon occurrence of attacks, and removes malicious models accurately, without affecting the benign ones.
Additionally, our approach incorporates zero-knowledge proofs to ensure the integrity of
defense mechanisms. Experimental results demonstrate the effectiveness of our approach in enhancing the security of FL systems against adversarial attacks.</p>
</div>
<div class="ltx_keywords">Machine Learning, ICML
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib43" title="" class="ltx_ref">2017a</a>)</cite> enables clients to collaboratively train machine learning models without sharing their local data with other parties. Due to its privacy-preserving nature, FL has attracted considerable attention across various domains in real-world applications <cite class="ltx_cite ltx_citemacro_citep">(Hard et al., <a href="#bib.bib30" title="" class="ltx_ref">2018</a>; Chen et al., <a href="#bib.bib13" title="" class="ltx_ref">2019</a>; Ramaswamy et al., <a href="#bib.bib49" title="" class="ltx_ref">2019</a>; Leroy et al., <a href="#bib.bib39" title="" class="ltx_ref">2019</a>; Byrd &amp; Polychroniadou, <a href="#bib.bib8" title="" class="ltx_ref">2020</a>; Chowdhury et al., <a href="#bib.bib15" title="" class="ltx_ref">2022</a>)</cite>.
However, even though FL does not require clients to share their raw data with other parties, its collaborative nature inadvertently introduces privacy and security vulnerabilities <cite class="ltx_cite ltx_citemacro_citep">(Cao &amp; Gong, <a href="#bib.bib10" title="" class="ltx_ref">2022</a>; Bhagoji et al., <a href="#bib.bib5" title="" class="ltx_ref">2019</a>; Lam et al., <a href="#bib.bib37" title="" class="ltx_ref">2021</a>; Jin et al., <a href="#bib.bib33" title="" class="ltx_ref">2021</a>; Tomsett et al., <a href="#bib.bib56" title="" class="ltx_ref">2019</a>; Chen et al., <a href="#bib.bib14" title="" class="ltx_ref">2017</a>; Tolpegin et al., <a href="#bib.bib55" title="" class="ltx_ref">2020</a>; Kariyappa et al., <a href="#bib.bib35" title="" class="ltx_ref">2022</a>; Zhang et al., <a href="#bib.bib65" title="" class="ltx_ref">2022c</a>)</cite>.
Malicious clients in FL systems can harm training by
submitting corrupted model updates to disrupt the global model from converging <cite class="ltx_cite ltx_citemacro_citep">(Fang et al., <a href="#bib.bib19" title="" class="ltx_ref">2020</a>; Chen et al., <a href="#bib.bib14" title="" class="ltx_ref">2017</a>)</cite>, or planting backdoors to induce the global model to perform poorly on certain data instances <cite class="ltx_cite ltx_citemacro_citep">(Bagdasaryan et al., <a href="#bib.bib3" title="" class="ltx_ref">2020b</a>, <a href="#bib.bib2" title="" class="ltx_ref">a</a>; Wang et al., <a href="#bib.bib57" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2310.04055/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="452" height="60" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">Overview of the anomaly detection mechanism.</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Existing literature on defensive mechanisms in FL includes <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>; Yang et al., <a href="#bib.bib61" title="" class="ltx_ref">2019</a>; Fung et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>; Pillutla et al., <a href="#bib.bib47" title="" class="ltx_ref">2022</a>; He et al., <a href="#bib.bib32" title="" class="ltx_ref">2022</a>; Cao et al., <a href="#bib.bib12" title="" class="ltx_ref">2022</a>; Karimireddy et al., <a href="#bib.bib34" title="" class="ltx_ref">2020</a>; Sun et al., <a href="#bib.bib53" title="" class="ltx_ref">2019</a>; Fu et al., <a href="#bib.bib23" title="" class="ltx_ref">2019</a>; Ozdayi et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>; Sun et al., <a href="#bib.bib52" title="" class="ltx_ref">2021</a>)</cite>, etc.
However, the inherent limitations of these approaches make them unsuitable for real-world FL systems. Some strategies require prior knowledge about the number of malicious clients within the FL system <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite>, while in practice an adversary would not announce their malicious intentions before attacking; other strategies mitigate impacts of potential malicious client submissions by methods that inevitably alter the aggregation results, such as re-weighting the local models <cite class="ltx_cite ltx_citemacro_citep">(Fung et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>, modifying the aggregation function <cite class="ltx_cite ltx_citemacro_citep">(Pillutla et al., <a href="#bib.bib47" title="" class="ltx_ref">2022</a>)</cite>, and removing local models that tend to be poisoned <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite>.
However, in real-world FL systems, attacks happen infrequently. While introducing defenses can mitigate the impact of potential malicious clients, the defense gain outweighs the loss as most real-world training cases are benign and these defenses largely compromise the model quality for all benign cases.
Moreover, existing defensive mechanisms are deployed at the FL server without any verification for the execution. This means clients cannot verify if the defensive mechanism has been executed honestly and correctly but are forced to trust the server’s reliability.
Thus, a successful anomaly detection approach should simultaneously satisfy the following aspects: <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">i</span>) <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">detectability</span>: it should be able to detect the occurrence of attacks and exclusively handle the cases when attacks happen;
<span id="S1.p2.1.3" class="ltx_text ltx_font_italic">ii</span>) <span id="S1.p2.1.4" class="ltx_text ltx_font_italic">identifiability</span>: if an attack is detected, the strategy should further identify the malicious client models and mitigate (or eliminate) their adversarial impacts without harming the benign ones; and <span id="S1.p2.1.5" class="ltx_text ltx_font_italic">iii</span>) <span id="S1.p2.1.6" class="ltx_text ltx_font_italic">verifiability</span>: the defensive mechanism should be integrated with a verification system to ensure its integrity and honest execution.</p>
</div>
<figure id="S1.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S1.T1.2.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S1.T1.3.2" class="ltx_text" style="font-size:90%;">Comparison of our method with state-of-the-arts. </span></figcaption>
<br class="ltx_break">
<table id="S1.T1.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S1.T1.4.1.1" class="ltx_tr">
<th id="S1.T1.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S1.T1.4.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Attribute/Method</span></th>
<th id="S1.T1.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S1.T1.4.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Krum</span></th>
<th id="S1.T1.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S1.T1.4.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">RFA</span></th>
<th id="S1.T1.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S1.T1.4.1.1.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Foolsgold</span></th>
<th id="S1.T1.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S1.T1.4.1.1.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Ours</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S1.T1.4.2.1" class="ltx_tr">
<td id="S1.T1.4.2.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S1.T1.4.2.1.1.1" class="ltx_text" style="font-size:70%;">Detect the presence of attacks</span></td>
<td id="S1.T1.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.4.2.1.2.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.4.2.1.3.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.2.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.4.2.1.4.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.2.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.4.2.1.5.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
</tr>
<tr id="S1.T1.4.3.2" class="ltx_tr">
<td id="S1.T1.4.3.2.1" class="ltx_td ltx_align_left"><span id="S1.T1.4.3.2.1.1" class="ltx_text" style="font-size:70%;">Enable removal of malicious models</span></td>
<td id="S1.T1.4.3.2.2" class="ltx_td ltx_align_center"><span id="S1.T1.4.3.2.2.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
<td id="S1.T1.4.3.2.3" class="ltx_td ltx_align_center"><span id="S1.T1.4.3.2.3.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.3.2.4" class="ltx_td ltx_align_center"><span id="S1.T1.4.3.2.4.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.3.2.5" class="ltx_td ltx_align_center"><span id="S1.T1.4.3.2.5.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
</tr>
<tr id="S1.T1.4.4.3" class="ltx_tr">
<td id="S1.T1.4.4.3.1" class="ltx_td ltx_align_left"><span id="S1.T1.4.4.3.1.1" class="ltx_text" style="font-size:70%;">Free from impractical knowledge</span></td>
<td id="S1.T1.4.4.3.2" class="ltx_td ltx_align_center"><span id="S1.T1.4.4.3.2.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.4.3.3" class="ltx_td ltx_align_center"><span id="S1.T1.4.4.3.3.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
<td id="S1.T1.4.4.3.4" class="ltx_td ltx_align_center"><span id="S1.T1.4.4.3.4.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
<td id="S1.T1.4.4.3.5" class="ltx_td ltx_align_center"><span id="S1.T1.4.4.3.5.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
</tr>
<tr id="S1.T1.4.5.4" class="ltx_tr">
<td id="S1.T1.4.5.4.1" class="ltx_td ltx_align_left"><span id="S1.T1.4.5.4.1.1" class="ltx_text" style="font-size:70%;">Free from reweighting</span></td>
<td id="S1.T1.4.5.4.2" class="ltx_td ltx_align_center"><span id="S1.T1.4.5.4.2.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
<td id="S1.T1.4.5.4.3" class="ltx_td ltx_align_center"><span id="S1.T1.4.5.4.3.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
<td id="S1.T1.4.5.4.4" class="ltx_td ltx_align_center"><span id="S1.T1.4.5.4.4.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.5.4.5" class="ltx_td ltx_align_center"><span id="S1.T1.4.5.4.5.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
</tr>
<tr id="S1.T1.4.6.5" class="ltx_tr">
<td id="S1.T1.4.6.5.1" class="ltx_td ltx_align_left"><span id="S1.T1.4.6.5.1.1" class="ltx_text" style="font-size:70%;">Free from modifying aggregation</span></td>
<td id="S1.T1.4.6.5.2" class="ltx_td ltx_align_center"><span id="S1.T1.4.6.5.2.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
<td id="S1.T1.4.6.5.3" class="ltx_td ltx_align_center"><span id="S1.T1.4.6.5.3.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.6.5.4" class="ltx_td ltx_align_center"><span id="S1.T1.4.6.5.4.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
<td id="S1.T1.4.6.5.5" class="ltx_td ltx_align_center"><span id="S1.T1.4.6.5.5.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
</tr>
<tr id="S1.T1.4.7.6" class="ltx_tr">
<td id="S1.T1.4.7.6.1" class="ltx_td ltx_align_left"><span id="S1.T1.4.7.6.1.1" class="ltx_text" style="font-size:70%;">Free from harming benign models</span></td>
<td id="S1.T1.4.7.6.2" class="ltx_td ltx_align_center"><span id="S1.T1.4.7.6.2.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.7.6.3" class="ltx_td ltx_align_center"><span id="S1.T1.4.7.6.3.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.7.6.4" class="ltx_td ltx_align_center"><span id="S1.T1.4.7.6.4.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.7.6.5" class="ltx_td ltx_align_center"><span id="S1.T1.4.7.6.5.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
</tr>
<tr id="S1.T1.4.8.7" class="ltx_tr">
<td id="S1.T1.4.8.7.1" class="ltx_td ltx_align_left"><span id="S1.T1.4.8.7.1.1" class="ltx_text" style="font-size:70%;">Decent results in non-attack cases</span></td>
<td id="S1.T1.4.8.7.2" class="ltx_td ltx_align_center"><span id="S1.T1.4.8.7.2.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.8.7.3" class="ltx_td ltx_align_center"><span id="S1.T1.4.8.7.3.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.8.7.4" class="ltx_td ltx_align_center"><span id="S1.T1.4.8.7.4.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.8.7.5" class="ltx_td ltx_align_center"><span id="S1.T1.4.8.7.5.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
</tr>
<tr id="S1.T1.4.9.8" class="ltx_tr">
<td id="S1.T1.4.9.8.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S1.T1.4.9.8.1.1" class="ltx_text" style="font-size:70%;">Verification for correct execution</span></td>
<td id="S1.T1.4.9.8.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S1.T1.4.9.8.2.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.9.8.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S1.T1.4.9.8.3.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.9.8.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S1.T1.4.9.8.4.1" class="ltx_text" style="font-size:70%;color:#B30000;">✗</span></td>
<td id="S1.T1.4.9.8.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S1.T1.4.9.8.5.1" class="ltx_text" style="font-size:70%;color:#00B300;">✓</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we propose a two-stage defensive mechanism for anomaly detection that filters out malicious client models in each FL training round while addressing challenges faced by real-world FL systems.
Our approach first detects whether any attacks have occurred in the current FL iteration based on a <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">cross-round detection</span>. In case of occurrence of attacks, it performs a <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">cross-client detection</span>
that evaluates the <span id="S1.p3.1.3" class="ltx_text ltx_font_italic">degree of evilness</span> of each local model and filters out the malicious local models based on the intuition of <span id="S1.p3.1.4" class="ltx_text ltx_font_italic">Three-Sigma Rule</span> <cite class="ltx_cite ltx_citemacro_citep">(Pukelsheim, <a href="#bib.bib48" title="" class="ltx_ref">1994</a>)</cite>.
Our mechanism integrates a robust verification protocol that utilizes Zero-Knowledge Proof (ZKP) <cite class="ltx_cite ltx_citemacro_citep">(Goldwasser et al., <a href="#bib.bib26" title="" class="ltx_ref">1989</a>)</cite> to guarantee the integrity and honest execution of our defensive mechanism at the FL server. We compare our approach with the state-of-the-art approaches, including Krum <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite>, RFA <cite class="ltx_cite ltx_citemacro_citep">(Pillutla et al., <a href="#bib.bib47" title="" class="ltx_ref">2022</a>)</cite>, and Foolsgold <cite class="ltx_cite ltx_citemacro_citep">(Fung et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite> in <a href="#S1.T1" title="In 1 Introduction ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>, and overview our mechanism in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
Our contributions are summarized as follows:</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text ltx_font_bold ltx_font_italic">i<span id="S1.p4.1.1.1" class="ltx_text ltx_font_upright">) Detection of occurrence of attacks (§<a href="#S3.SS1" title="3.1 Cross-Round Detection ‣ 3 Two-Stage Anomaly Detection ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>).</span></span> We develop a cross-round check to
identify the presence of attacks to activate the defense only when warranted, which can avoid altering aggregation results in attack-free scenarios.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p"><span id="S1.p5.1.1" class="ltx_text ltx_font_bold ltx_font_italic">ii<span id="S1.p5.1.1.1" class="ltx_text ltx_font_upright">) Elimination of malicious submissions (§<a href="#S3.SS2" title="3.2 Cross-Client Anomaly Detection ‣ 3 Two-Stage Anomaly Detection ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>).</span></span> Upon the occurrence of attacks, our approach further eliminates malicious client models in the current FL training round without harming the benign local models.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p"><span id="S1.p6.1.1" class="ltx_text ltx_font_bold ltx_font_italic">iii<span id="S1.p6.1.1.1" class="ltx_text ltx_font_upright">) Rigorous verification protocol (§<a href="#S4" title="4 Verifiable Anomaly Detection Using ZKP ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).</span></span> To cultivate trust in the FL system among those benign FL clients,
our approach utilizes Zero-Knowledge Proof to guarantee that the FL server has executed the defensive mechanism correctly.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p"><span id="S1.p7.1.1" class="ltx_text ltx_font_bold ltx_font_italic">iv<span id="S1.p7.1.1.1" class="ltx_text ltx_font_upright">) Effective in real-world systems.</span></span> Our method is free from any unrealistic prior information and can detect and eliminate impact of malicious client models without harming the benign ones, thus is applicable and effective in real-world FL systems where attacks happen rarely.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Problem Setting</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Adversary Model</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">We consider an FL system with an honest client majority and an adversary that compromises a subset of clients. The malicious clients may conduct attacks to achieve <span id="S2.SS1.p1.1.1" class="ltx_text ltx_font_italic">some adversarial goals</span>, including:
<span id="S2.SS1.p1.1.2" class="ltx_text ltx_font_italic">i</span>) planting a backdoor such that the global model will misclassify a specific set of samples while minimally impacting the overall model performance (backdoor attacks <cite class="ltx_cite ltx_citemacro_citep">(Bagdasaryan et al., <a href="#bib.bib3" title="" class="ltx_ref">2020b</a>; Wang et al., <a href="#bib.bib57" title="" class="ltx_ref">2020</a>)</cite>); <span id="S2.SS1.p1.1.3" class="ltx_text ltx_font_italic">ii</span>) altering local models to prevent the global model from converging (Byzantine attacks <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib14" title="" class="ltx_ref">2017</a>; Fang et al., <a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite>); and <span id="S2.SS1.p1.1.4" class="ltx_text ltx_font_italic">iii</span>) cheating the FL server by randomly submitting contrived models without actual training (free riders <cite class="ltx_cite ltx_citemacro_citep">(Wang, <a href="#bib.bib58" title="" class="ltx_ref">2022</a>)</cite>).</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Preliminaries</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p"><span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_bold">Federated Learning. </span>
Federated learning <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib43" title="" class="ltx_ref">2017a</a>)</cite> enables training models across decentralized devices without centralizing the local data. This technique is particularly beneficial when dealing with sensitive information, as it allows data to remain on its original device.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.3" class="ltx_p"><span id="S2.SS2.p2.3.1" class="ltx_text ltx_font_bold">Krum.</span> Krum <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite> is a well-known distance-based anomaly detection method in distributed learning. In each FL training round, the server selects one local model that deviates less from the majority based on their pairwise distances. Such a local model is the most likely to be benign and thus is accepted as the global model of the current round. An optimization of Krum is <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">m</annotation></semantics></math>-Krum <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite> that selects <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">m</annotation></semantics></math> local models, instead of one, when aggregating local models. Algorithms for Krum and <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">m</annotation></semantics></math>-Krum are shown in Algorithm <a href="#alg3" title="Algorithm 3 ‣ A.1 Algorithm for Krum and 𝑚-Krum ‣ Appendix A Appendix ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> in Appendix <a href="#A1.SS1" title="A.1 Algorithm for Krum and 𝑚-Krum ‣ Appendix A Appendix ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a>.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.1" class="ltx_p"><span id="S2.SS2.p3.1.1" class="ltx_text ltx_font_bold">Three-Sigma Rule.</span> Three-sigma Rule <cite class="ltx_cite ltx_citemacro_citep">(Pukelsheim, <a href="#bib.bib48" title="" class="ltx_ref">1994</a>)</cite> is an empirical rule and has been utilized in anomaly detection in data management <cite class="ltx_cite ltx_citemacro_citep">(Han et al., <a href="#bib.bib29" title="" class="ltx_ref">2019</a>)</cite>. It states that almost all of the population lies within three standard deviations of the mean in normal distributions, where the percentage of values within one, two, and three standard deviations of the mean are 68%, 95%, and 99.7%, respectively. This rule can be widely applied in real-world applications, as normal distributions are consistent with real-world data distributions <cite class="ltx_cite ltx_citemacro_citep">(Lyon, <a href="#bib.bib42" title="" class="ltx_ref">2014</a>)</cite>. Moreover, when the data are not normally distributed, we can transform the distribution to a normal distribution <cite class="ltx_cite ltx_citemacro_citep">(Aoki, <a href="#bib.bib1" title="" class="ltx_ref">1950</a>; Osborne, <a href="#bib.bib45" title="" class="ltx_ref">2010</a>; Sakia, <a href="#bib.bib50" title="" class="ltx_ref">1992</a>; Weisberg, <a href="#bib.bib59" title="" class="ltx_ref">2001</a>)</cite>.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para ltx_noindent">
<p id="S2.SS2.p4.1" class="ltx_p"><span id="S2.SS2.p4.1.1" class="ltx_text ltx_font_bold">Zero-Knowledge Proof (ZKP).</span> ZKP <cite class="ltx_cite ltx_citemacro_citep">(Goldwasser et al., <a href="#bib.bib26" title="" class="ltx_ref">1989</a>)</cite> is a proof system that allows a <span id="S2.SS2.p4.1.2" class="ltx_text ltx_font_italic">prover</span> to convince a <span id="S2.SS2.p4.1.3" class="ltx_text ltx_font_italic">verifier</span> that a function on the prover’s secret input (witness) is computed correctly. ZKP ensures three properties, including: <span id="S2.SS2.p4.1.4" class="ltx_text ltx_font_italic">i</span>) <span id="S2.SS2.p4.1.5" class="ltx_text ltx_font_italic">correctness</span> that if the prover is honest, then the proof they produce should check out (integrity property); <span id="S2.SS2.p4.1.6" class="ltx_text ltx_font_italic">ii</span>) <span id="S2.SS2.p4.1.7" class="ltx_text ltx_font_italic">soundness</span> that ensures that a cheating prover will not convince the verifier with overwhelming probability, and <span id="S2.SS2.p4.1.8" class="ltx_text ltx_font_italic">iii</span>) <span id="S2.SS2.p4.1.9" class="ltx_text ltx_font_italic">zero-knowledge</span> that guarantees the prover’s witness will be not learned by the verifier (privacy). Due to these properties, ZKP has been widely used in machine learning and blockchain applications <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a href="#bib.bib38" title="" class="ltx_ref">2020</a>; Feng et al., <a href="#bib.bib20" title="" class="ltx_ref">2021</a>; Liu et al., <a href="#bib.bib41" title="" class="ltx_ref">2021</a>; Sasson et al., <a href="#bib.bib51" title="" class="ltx_ref">2014</a>)</cite>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Two-Stage Anomaly Detection</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Our anomaly detection method is executed at the FL server, after the server collects the local models from clients in each FL round.
The method has two stages, <span id="S3.p1.1.1" class="ltx_text ltx_font_italic">i</span>.<span id="S3.p1.1.2" class="ltx_text ltx_font_italic">e</span>., <span id="S3.p1.1.3" class="ltx_text ltx_font_italic">i</span>) a cross-round check that utilizes some cache, called “<span id="S3.p1.1.4" class="ltx_text ltx_font_italic">reference models</span>”, to detect whether potential attacks have happened in the current FL round, and <span id="S3.p1.1.5" class="ltx_text ltx_font_italic">ii</span>) a cross-client detection, triggered by the identification of attacks in the previous stage, that assesses the “<span id="S3.p1.1.6" class="ltx_text ltx_font_italic">degree of evilness</span>” in each client model and removes those that are identified as malicious.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Cross-Round Detection</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p"><span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_bold">Intuitive Idea. </span>
To identify the presence of attacks, the FL server computes similarities between the local models of the current FL iteration and some “golden truth” models that renewed at the end of each FL iteration, <span id="S3.SS1.p1.1.2" class="ltx_text ltx_font_italic">i</span>.<span id="S3.SS1.p1.1.3" class="ltx_text ltx_font_italic">e</span>., the cached “reference models”.</p>
</div>
<div id="S3.Thmtheorem1" class="ltx_theorem ltx_theorem_theorem">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="S3.Thmtheorem1.1.1.1" class="ltx_text ltx_font_bold">Theorem 3.1</span></span><span id="S3.Thmtheorem1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="S3.Thmtheorem1.p1" class="ltx_para">
<p id="S3.Thmtheorem1.p1.10" class="ltx_p"><span id="S3.Thmtheorem1.p1.10.10" class="ltx_text ltx_font_italic">Denote the local model of client <math id="S3.Thmtheorem1.p1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{C}_{i}" display="inline"><semantics id="S3.Thmtheorem1.p1.1.1.m1.1a"><msub id="S3.Thmtheorem1.p1.1.1.m1.1.1" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.1.1.m1.1.1.2" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.2.cmml">𝒞</mi><mi id="S3.Thmtheorem1.p1.1.1.m1.1.1.3" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.1.1.m1.1b"><apply id="S3.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.1.1.m1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.2">𝒞</ci><ci id="S3.Thmtheorem1.p1.1.1.m1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.1.1.m1.1c">\mathcal{C}_{i}</annotation></semantics></math> to be <math id="S3.Thmtheorem1.p1.2.2.m2.1" class="ltx_Math" alttext="\mathbf{w}_{i}" display="inline"><semantics id="S3.Thmtheorem1.p1.2.2.m2.1a"><msub id="S3.Thmtheorem1.p1.2.2.m2.1.1" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml"><mi id="S3.Thmtheorem1.p1.2.2.m2.1.1.2" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.2.cmml">𝐰</mi><mi id="S3.Thmtheorem1.p1.2.2.m2.1.1.3" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.2.2.m2.1b"><apply id="S3.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.2.2.m2.1.1.1.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.2">𝐰</ci><ci id="S3.Thmtheorem1.p1.2.2.m2.1.1.3.cmml" xref="S3.Thmtheorem1.p1.2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.2.2.m2.1c">\mathbf{w}_{i}</annotation></semantics></math>, the reference model of <math id="S3.Thmtheorem1.p1.3.3.m3.1" class="ltx_Math" alttext="\mathbf{w}_{i}" display="inline"><semantics id="S3.Thmtheorem1.p1.3.3.m3.1a"><msub id="S3.Thmtheorem1.p1.3.3.m3.1.1" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.cmml"><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.2" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2.cmml">𝐰</mi><mi id="S3.Thmtheorem1.p1.3.3.m3.1.1.3" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.3.3.m3.1b"><apply id="S3.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.2">𝐰</ci><ci id="S3.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="S3.Thmtheorem1.p1.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.3.3.m3.1c">\mathbf{w}_{i}</annotation></semantics></math> to be <math id="S3.Thmtheorem1.p1.4.4.m4.1" class="ltx_Math" alttext="\mathbf{w}_{r}" display="inline"><semantics id="S3.Thmtheorem1.p1.4.4.m4.1a"><msub id="S3.Thmtheorem1.p1.4.4.m4.1.1" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.cmml"><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.2" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.2.cmml">𝐰</mi><mi id="S3.Thmtheorem1.p1.4.4.m4.1.1.3" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.4.4.m4.1b"><apply id="S3.Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.4.m4.1.1.1.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.2.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.2">𝐰</ci><ci id="S3.Thmtheorem1.p1.4.4.m4.1.1.3.cmml" xref="S3.Thmtheorem1.p1.4.4.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.4.4.m4.1c">\mathbf{w}_{r}</annotation></semantics></math>, and the similarity between <math id="S3.Thmtheorem1.p1.5.5.m5.1" class="ltx_Math" alttext="\mathbf{w}_{i}" display="inline"><semantics id="S3.Thmtheorem1.p1.5.5.m5.1a"><msub id="S3.Thmtheorem1.p1.5.5.m5.1.1" xref="S3.Thmtheorem1.p1.5.5.m5.1.1.cmml"><mi id="S3.Thmtheorem1.p1.5.5.m5.1.1.2" xref="S3.Thmtheorem1.p1.5.5.m5.1.1.2.cmml">𝐰</mi><mi id="S3.Thmtheorem1.p1.5.5.m5.1.1.3" xref="S3.Thmtheorem1.p1.5.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.5.5.m5.1b"><apply id="S3.Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="S3.Thmtheorem1.p1.5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.5.5.m5.1.1.1.cmml" xref="S3.Thmtheorem1.p1.5.5.m5.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.5.5.m5.1.1.2.cmml" xref="S3.Thmtheorem1.p1.5.5.m5.1.1.2">𝐰</ci><ci id="S3.Thmtheorem1.p1.5.5.m5.1.1.3.cmml" xref="S3.Thmtheorem1.p1.5.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.5.5.m5.1c">\mathbf{w}_{i}</annotation></semantics></math> and <math id="S3.Thmtheorem1.p1.6.6.m6.1" class="ltx_Math" alttext="\mathbf{w}_{r}" display="inline"><semantics id="S3.Thmtheorem1.p1.6.6.m6.1a"><msub id="S3.Thmtheorem1.p1.6.6.m6.1.1" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.cmml"><mi id="S3.Thmtheorem1.p1.6.6.m6.1.1.2" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.2.cmml">𝐰</mi><mi id="S3.Thmtheorem1.p1.6.6.m6.1.1.3" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.6.6.m6.1b"><apply id="S3.Thmtheorem1.p1.6.6.m6.1.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.6.6.m6.1.1.1.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.6.6.m6.1.1.2.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.2">𝐰</ci><ci id="S3.Thmtheorem1.p1.6.6.m6.1.1.3.cmml" xref="S3.Thmtheorem1.p1.6.6.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.6.6.m6.1c">\mathbf{w}_{r}</annotation></semantics></math> to be <math id="S3.Thmtheorem1.p1.7.7.m7.2" class="ltx_Math" alttext="S_{c}(\mathbf{w}_{i},\mathbf{w}_{r})" display="inline"><semantics id="S3.Thmtheorem1.p1.7.7.m7.2a"><mrow id="S3.Thmtheorem1.p1.7.7.m7.2.2" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.cmml"><msub id="S3.Thmtheorem1.p1.7.7.m7.2.2.4" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.4.cmml"><mi id="S3.Thmtheorem1.p1.7.7.m7.2.2.4.2" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.4.2.cmml">S</mi><mi id="S3.Thmtheorem1.p1.7.7.m7.2.2.4.3" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.4.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.Thmtheorem1.p1.7.7.m7.2.2.3" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.3.cmml">​</mo><mrow id="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.2.3.cmml"><mo stretchy="false" id="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.3" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.2.3.cmml">(</mo><msub id="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1.2" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1.3" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.4" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.2.3.cmml">,</mo><msub id="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2.cmml"><mi id="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2.2" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2.2.cmml">𝐰</mi><mi id="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2.3" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2.3.cmml">r</mi></msub><mo stretchy="false" id="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.5" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.7.7.m7.2b"><apply id="S3.Thmtheorem1.p1.7.7.m7.2.2.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.2.2"><times id="S3.Thmtheorem1.p1.7.7.m7.2.2.3.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.3"></times><apply id="S3.Thmtheorem1.p1.7.7.m7.2.2.4.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.4"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.7.7.m7.2.2.4.1.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.4">subscript</csymbol><ci id="S3.Thmtheorem1.p1.7.7.m7.2.2.4.2.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.4.2">𝑆</ci><ci id="S3.Thmtheorem1.p1.7.7.m7.2.2.4.3.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.4.3">𝑐</ci></apply><interval closure="open" id="S3.Thmtheorem1.p1.7.7.m7.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2"><apply id="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1.2">𝐰</ci><ci id="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2.1.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2">subscript</csymbol><ci id="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2.2">𝐰</ci><ci id="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.7.7.m7.2.2.2.2.2.3">𝑟</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.7.7.m7.2c">S_{c}(\mathbf{w}_{i},\mathbf{w}_{r})</annotation></semantics></math>. There exists <math id="S3.Thmtheorem1.p1.8.8.m8.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.Thmtheorem1.p1.8.8.m8.1a"><mi id="S3.Thmtheorem1.p1.8.8.m8.1.1" xref="S3.Thmtheorem1.p1.8.8.m8.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.8.8.m8.1b"><ci id="S3.Thmtheorem1.p1.8.8.m8.1.1.cmml" xref="S3.Thmtheorem1.p1.8.8.m8.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.8.8.m8.1c">\gamma</annotation></semantics></math>, where <math id="S3.Thmtheorem1.p1.9.9.m9.2" class="ltx_Math" alttext="S_{c}(\mathbf{w}_{i},\mathbf{w}_{r})&lt;\gamma" display="inline"><semantics id="S3.Thmtheorem1.p1.9.9.m9.2a"><mrow id="S3.Thmtheorem1.p1.9.9.m9.2.2" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.cmml"><mrow id="S3.Thmtheorem1.p1.9.9.m9.2.2.2" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.cmml"><msub id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4.cmml"><mi id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4.2" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4.2.cmml">S</mi><mi id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4.3" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.3" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.3.cmml">​</mo><mrow id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.3" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.3.cmml">(</mo><msub id="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1" xref="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1.2" xref="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1.3" xref="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.4" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.3.cmml">,</mo><msub id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2.cmml"><mi id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2.2" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2.2.cmml">𝐰</mi><mi id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2.3" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2.3.cmml">r</mi></msub><mo stretchy="false" id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.5" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Thmtheorem1.p1.9.9.m9.2.2.3" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.3.cmml">&lt;</mo><mi id="S3.Thmtheorem1.p1.9.9.m9.2.2.4" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.4.cmml">γ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.9.9.m9.2b"><apply id="S3.Thmtheorem1.p1.9.9.m9.2.2.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2"><lt id="S3.Thmtheorem1.p1.9.9.m9.2.2.3.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.3"></lt><apply id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2"><times id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.3"></times><apply id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4.1.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4">subscript</csymbol><ci id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4.2.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4.2">𝑆</ci><ci id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4.3.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.4.3">𝑐</ci></apply><interval closure="open" id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2"><apply id="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1.2">𝐰</ci><ci id="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2.1.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2">subscript</csymbol><ci id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2.2">𝐰</ci><ci id="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.2.2.2.2.3">𝑟</ci></apply></interval></apply><ci id="S3.Thmtheorem1.p1.9.9.m9.2.2.4.cmml" xref="S3.Thmtheorem1.p1.9.9.m9.2.2.4">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.9.9.m9.2c">S_{c}(\mathbf{w}_{i},\mathbf{w}_{r})&lt;\gamma</annotation></semantics></math> indicates high possibilities of the presence of attacks on client <math id="S3.Thmtheorem1.p1.10.10.m10.1" class="ltx_Math" alttext="\mathcal{C}_{i}" display="inline"><semantics id="S3.Thmtheorem1.p1.10.10.m10.1a"><msub id="S3.Thmtheorem1.p1.10.10.m10.1.1" xref="S3.Thmtheorem1.p1.10.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem1.p1.10.10.m10.1.1.2" xref="S3.Thmtheorem1.p1.10.10.m10.1.1.2.cmml">𝒞</mi><mi id="S3.Thmtheorem1.p1.10.10.m10.1.1.3" xref="S3.Thmtheorem1.p1.10.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.10.10.m10.1b"><apply id="S3.Thmtheorem1.p1.10.10.m10.1.1.cmml" xref="S3.Thmtheorem1.p1.10.10.m10.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.10.10.m10.1.1.1.cmml" xref="S3.Thmtheorem1.p1.10.10.m10.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.10.10.m10.1.1.2.cmml" xref="S3.Thmtheorem1.p1.10.10.m10.1.1.2">𝒞</ci><ci id="S3.Thmtheorem1.p1.10.10.m10.1.1.3.cmml" xref="S3.Thmtheorem1.p1.10.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.10.10.m10.1c">\mathcal{C}_{i}</annotation></semantics></math> in the current FL round.</span></p>
</div>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2310.04055/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="183" height="72" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.3.2" class="ltx_text" style="font-size:90%;">Cosine similarities.</span></figcaption>
</figure>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg1.22.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Cross-Round Detection</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.4" class="ltx_p ltx_figure_panel"><span id="alg1.4.4" class="ltx_text ltx_font_bold" style="font-size:90%;">Inputs:<span id="alg1.4.4.4" class="ltx_text ltx_font_medium">
<math id="alg1.1.1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg1.1.1.1.m1.1a"><mi id="alg1.1.1.1.m1.1.1" xref="alg1.1.1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg1.1.1.1.m1.1b"><ci id="alg1.1.1.1.m1.1.1.cmml" xref="alg1.1.1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.1.m1.1c">\tau</annotation></semantics></math>: training round id, <span id="alg1.4.4.4.1" class="ltx_text ltx_font_italic">e</span>.<span id="alg1.4.4.4.2" class="ltx_text ltx_font_italic">g</span>., <math id="alg1.2.2.2.m2.4" class="ltx_Math" alttext="\tau=0,1,2,\ldots" display="inline"><semantics id="alg1.2.2.2.m2.4a"><mrow id="alg1.2.2.2.m2.4.5" xref="alg1.2.2.2.m2.4.5.cmml"><mi id="alg1.2.2.2.m2.4.5.2" xref="alg1.2.2.2.m2.4.5.2.cmml">τ</mi><mo id="alg1.2.2.2.m2.4.5.1" xref="alg1.2.2.2.m2.4.5.1.cmml">=</mo><mrow id="alg1.2.2.2.m2.4.5.3.2" xref="alg1.2.2.2.m2.4.5.3.1.cmml"><mn id="alg1.2.2.2.m2.1.1" xref="alg1.2.2.2.m2.1.1.cmml">0</mn><mo id="alg1.2.2.2.m2.4.5.3.2.1" xref="alg1.2.2.2.m2.4.5.3.1.cmml">,</mo><mn id="alg1.2.2.2.m2.2.2" xref="alg1.2.2.2.m2.2.2.cmml">1</mn><mo id="alg1.2.2.2.m2.4.5.3.2.2" xref="alg1.2.2.2.m2.4.5.3.1.cmml">,</mo><mn id="alg1.2.2.2.m2.3.3" xref="alg1.2.2.2.m2.3.3.cmml">2</mn><mo id="alg1.2.2.2.m2.4.5.3.2.3" xref="alg1.2.2.2.m2.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.2.2.2.m2.4.4" xref="alg1.2.2.2.m2.4.4.cmml">…</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.2.2.m2.4b"><apply id="alg1.2.2.2.m2.4.5.cmml" xref="alg1.2.2.2.m2.4.5"><eq id="alg1.2.2.2.m2.4.5.1.cmml" xref="alg1.2.2.2.m2.4.5.1"></eq><ci id="alg1.2.2.2.m2.4.5.2.cmml" xref="alg1.2.2.2.m2.4.5.2">𝜏</ci><list id="alg1.2.2.2.m2.4.5.3.1.cmml" xref="alg1.2.2.2.m2.4.5.3.2"><cn type="integer" id="alg1.2.2.2.m2.1.1.cmml" xref="alg1.2.2.2.m2.1.1">0</cn><cn type="integer" id="alg1.2.2.2.m2.2.2.cmml" xref="alg1.2.2.2.m2.2.2">1</cn><cn type="integer" id="alg1.2.2.2.m2.3.3.cmml" xref="alg1.2.2.2.m2.3.3">2</cn><ci id="alg1.2.2.2.m2.4.4.cmml" xref="alg1.2.2.2.m2.4.4">…</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.2.m2.4c">\tau=0,1,2,\ldots</annotation></semantics></math>;
<math id="alg1.3.3.3.m3.1" class="ltx_Math" alttext="\mathcal{W}^{(\tau)}" display="inline"><semantics id="alg1.3.3.3.m3.1a"><msup id="alg1.3.3.3.m3.1.2" xref="alg1.3.3.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.3.3.3.m3.1.2.2" xref="alg1.3.3.3.m3.1.2.2.cmml">𝒲</mi><mrow id="alg1.3.3.3.m3.1.1.1.3" xref="alg1.3.3.3.m3.1.2.cmml"><mo stretchy="false" id="alg1.3.3.3.m3.1.1.1.3.1" xref="alg1.3.3.3.m3.1.2.cmml">(</mo><mi id="alg1.3.3.3.m3.1.1.1.1" xref="alg1.3.3.3.m3.1.1.1.1.cmml">τ</mi><mo stretchy="false" id="alg1.3.3.3.m3.1.1.1.3.2" xref="alg1.3.3.3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.3.3.3.m3.1b"><apply id="alg1.3.3.3.m3.1.2.cmml" xref="alg1.3.3.3.m3.1.2"><csymbol cd="ambiguous" id="alg1.3.3.3.m3.1.2.1.cmml" xref="alg1.3.3.3.m3.1.2">superscript</csymbol><ci id="alg1.3.3.3.m3.1.2.2.cmml" xref="alg1.3.3.3.m3.1.2.2">𝒲</ci><ci id="alg1.3.3.3.m3.1.1.1.1.cmml" xref="alg1.3.3.3.m3.1.1.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.3.m3.1c">\mathcal{W}^{(\tau)}</annotation></semantics></math>: client submissions of the current FL round; <math id="alg1.4.4.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="alg1.4.4.4.m4.1a"><mi id="alg1.4.4.4.m4.1.1" xref="alg1.4.4.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="alg1.4.4.4.m4.1b"><ci id="alg1.4.4.4.m4.1.1.cmml" xref="alg1.4.4.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.4.m4.1c">\gamma</annotation></semantics></math>: upper bound of similarities for malicious client models.</span></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.5" class="ltx_p ltx_figure_panel"><span id="alg1.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">function <math id="alg1.5.1.m1.4" class="ltx_Math" alttext="\boldsymbol{\mathit{cross}\_\mathit{round}\_\mathit{check}(\mathcal{W}^{(\tau)},\tau,\gamma)}" display="inline"><semantics id="alg1.5.1.m1.4a"><mrow id="alg1.5.1.m1.4.4" xref="alg1.5.1.m1.4.4.cmml"><mi id="alg1.5.1.m1.4.4.3" xref="alg1.5.1.m1.4.4.3.cmml">𝑐𝑟𝑜𝑠𝑠</mi><mo lspace="0em" rspace="0em" id="alg1.5.1.m1.4.4.2" xref="alg1.5.1.m1.4.4.2.cmml">​</mo><mi class="ltx_mathvariant_bold" mathvariant="bold" id="alg1.5.1.m1.4.4.4" xref="alg1.5.1.m1.4.4.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.5.1.m1.4.4.2a" xref="alg1.5.1.m1.4.4.2.cmml">​</mo><mi id="alg1.5.1.m1.4.4.5" xref="alg1.5.1.m1.4.4.5.cmml">𝑟𝑜𝑢𝑛𝑑</mi><mo lspace="0em" rspace="0em" id="alg1.5.1.m1.4.4.2b" xref="alg1.5.1.m1.4.4.2.cmml">​</mo><mi class="ltx_mathvariant_bold" mathvariant="bold" id="alg1.5.1.m1.4.4.6" xref="alg1.5.1.m1.4.4.6.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.5.1.m1.4.4.2c" xref="alg1.5.1.m1.4.4.2.cmml">​</mo><mi id="alg1.5.1.m1.4.4.7" xref="alg1.5.1.m1.4.4.7.cmml">𝑐ℎ𝑒𝑐𝑘</mi><mo lspace="0em" rspace="0em" id="alg1.5.1.m1.4.4.2d" xref="alg1.5.1.m1.4.4.2.cmml">​</mo><mrow id="alg1.5.1.m1.4.4.1.1" xref="alg1.5.1.m1.4.4.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg1.5.1.m1.4.4.1.1.2" xref="alg1.5.1.m1.4.4.1.2.cmml">(</mo><msup id="alg1.5.1.m1.4.4.1.1.1" xref="alg1.5.1.m1.4.4.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.5.1.m1.4.4.1.1.1.2" xref="alg1.5.1.m1.4.4.1.1.1.2.cmml">𝒲</mi><mrow id="alg1.5.1.m1.1.1.1.3" xref="alg1.5.1.m1.4.4.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg1.5.1.m1.1.1.1.3.1" xref="alg1.5.1.m1.4.4.1.1.1.cmml">(</mo><mi id="alg1.5.1.m1.1.1.1.1" xref="alg1.5.1.m1.1.1.1.1.cmml">τ</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg1.5.1.m1.1.1.1.3.2" xref="alg1.5.1.m1.4.4.1.1.1.cmml">)</mo></mrow></msup><mo class="ltx_mathvariant_bold" mathvariant="bold" id="alg1.5.1.m1.4.4.1.1.3" xref="alg1.5.1.m1.4.4.1.2.cmml">,</mo><mi id="alg1.5.1.m1.2.2" xref="alg1.5.1.m1.2.2.cmml">τ</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="alg1.5.1.m1.4.4.1.1.4" xref="alg1.5.1.m1.4.4.1.2.cmml">,</mo><mi id="alg1.5.1.m1.3.3" xref="alg1.5.1.m1.3.3.cmml">γ</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg1.5.1.m1.4.4.1.1.5" xref="alg1.5.1.m1.4.4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.5.1.m1.4b"><apply id="alg1.5.1.m1.4.4.cmml" xref="alg1.5.1.m1.4.4"><times id="alg1.5.1.m1.4.4.2.cmml" xref="alg1.5.1.m1.4.4.2"></times><ci id="alg1.5.1.m1.4.4.3.cmml" xref="alg1.5.1.m1.4.4.3">𝑐𝑟𝑜𝑠𝑠</ci><ci id="alg1.5.1.m1.4.4.4.cmml" xref="alg1.5.1.m1.4.4.4">bold-_</ci><ci id="alg1.5.1.m1.4.4.5.cmml" xref="alg1.5.1.m1.4.4.5">𝑟𝑜𝑢𝑛𝑑</ci><ci id="alg1.5.1.m1.4.4.6.cmml" xref="alg1.5.1.m1.4.4.6">bold-_</ci><ci id="alg1.5.1.m1.4.4.7.cmml" xref="alg1.5.1.m1.4.4.7">𝑐ℎ𝑒𝑐𝑘</ci><vector id="alg1.5.1.m1.4.4.1.2.cmml" xref="alg1.5.1.m1.4.4.1.1"><apply id="alg1.5.1.m1.4.4.1.1.1.cmml" xref="alg1.5.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.5.1.m1.4.4.1.1.1.1.cmml" xref="alg1.5.1.m1.4.4.1.1.1">superscript</csymbol><ci id="alg1.5.1.m1.4.4.1.1.1.2.cmml" xref="alg1.5.1.m1.4.4.1.1.1.2">𝒲</ci><ci id="alg1.5.1.m1.1.1.1.1.cmml" xref="alg1.5.1.m1.1.1.1.1">𝜏</ci></apply><ci id="alg1.5.1.m1.2.2.cmml" xref="alg1.5.1.m1.2.2">𝜏</ci><ci id="alg1.5.1.m1.3.3.cmml" xref="alg1.5.1.m1.3.3">𝛾</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.1.m1.4c">\boldsymbol{\mathit{cross}\_\mathit{round}\_\mathit{check}(\mathcal{W}^{(\tau)},\tau,\gamma)}</annotation></semantics></math><span id="alg1.5.1.1" class="ltx_text ltx_font_medium">
</span>begin</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="alg1.23" class="ltx_block ltx_figure_panel">
<div id="alg1.7" class="ltx_listingline">
<span id="alg1.7.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.7.3" class="ltx_text" style="font-size:90%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.7.4.1.1" class="ltx_text" style="font-size:90%;">1</span></span><span id="alg1.7.5" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.7.6" class="ltx_text ltx_font_bold" style="font-size:90%;">if</span><span id="alg1.7.7" class="ltx_text" style="font-size:90%;"> </span><em id="alg1.6.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="alg1.6.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg1.6.1.m1.1a"><mi id="alg1.6.1.m1.1.1" xref="alg1.6.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg1.6.1.m1.1b"><ci id="alg1.6.1.m1.1.1.cmml" xref="alg1.6.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.1.m1.1c">\tau</annotation></semantics></math>=0</em><span id="alg1.7.8" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.7.9" class="ltx_text ltx_font_bold" style="font-size:90%;">then</span><span id="alg1.7.10" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.7.11" class="ltx_text ltx_font_bold" style="font-size:90%;">return</span><span id="alg1.7.12" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.7.m1.1" class="ltx_Math" alttext="\mathit{True}" display="inline"><semantics id="alg1.7.m1.1a"><mi mathsize="90%" id="alg1.7.m1.1.1" xref="alg1.7.m1.1.1.cmml">𝑇𝑟𝑢𝑒</mi><annotation-xml encoding="MathML-Content" id="alg1.7.m1.1b"><ci id="alg1.7.m1.1.1.cmml" xref="alg1.7.m1.1.1">𝑇𝑟𝑢𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m1.1c">\mathit{True}</annotation></semantics></math><span id="alg1.7.13" class="ltx_text" style="font-size:90%;">;</span>
</div>
<div id="alg1.10" class="ltx_listingline">
<span id="alg1.10.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.10.3" class="ltx_text" style="font-size:90%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.10.4.1.1" class="ltx_text" style="font-size:90%;">4</span></span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.10.5.1.1" class="ltx_text" style="font-size:90%;">3</span></span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.10.6.1.1" class="ltx_text" style="font-size:90%;">2</span></span><span id="alg1.10.7" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.10.8" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.8.m1.1" class="ltx_Math" alttext="\mathcal{W}^{\tau-1}\leftarrow\mathit{get}\_\mathit{cached}\_\mathit{client}\_\mathit{models}()" display="inline"><semantics id="alg1.8.m1.1a"><mrow id="alg1.8.m1.1.1" xref="alg1.8.m1.1.1.cmml"><msup id="alg1.8.m1.1.1.2" xref="alg1.8.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.8.m1.1.1.2.2" xref="alg1.8.m1.1.1.2.2.cmml">𝒲</mi><mrow id="alg1.8.m1.1.1.2.3" xref="alg1.8.m1.1.1.2.3.cmml"><mi mathsize="90%" id="alg1.8.m1.1.1.2.3.2" xref="alg1.8.m1.1.1.2.3.2.cmml">τ</mi><mo mathsize="90%" id="alg1.8.m1.1.1.2.3.1" xref="alg1.8.m1.1.1.2.3.1.cmml">−</mo><mn mathsize="90%" id="alg1.8.m1.1.1.2.3.3" xref="alg1.8.m1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo mathsize="90%" stretchy="false" id="alg1.8.m1.1.1.1" xref="alg1.8.m1.1.1.1.cmml">←</mo><mrow id="alg1.8.m1.1.1.3" xref="alg1.8.m1.1.1.3.cmml"><mi mathsize="90%" id="alg1.8.m1.1.1.3.2" xref="alg1.8.m1.1.1.3.2.cmml">𝑔𝑒𝑡</mi><mo lspace="0em" rspace="0em" id="alg1.8.m1.1.1.3.1" xref="alg1.8.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg1.8.m1.1.1.3.3" xref="alg1.8.m1.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.8.m1.1.1.3.1a" xref="alg1.8.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="alg1.8.m1.1.1.3.4" xref="alg1.8.m1.1.1.3.4.cmml">𝑐𝑎𝑐ℎ𝑒𝑑</mi><mo lspace="0em" rspace="0em" id="alg1.8.m1.1.1.3.1b" xref="alg1.8.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg1.8.m1.1.1.3.5" xref="alg1.8.m1.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.8.m1.1.1.3.1c" xref="alg1.8.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="alg1.8.m1.1.1.3.6" xref="alg1.8.m1.1.1.3.6.cmml">𝑐𝑙𝑖𝑒𝑛𝑡</mi><mo lspace="0em" rspace="0em" id="alg1.8.m1.1.1.3.1d" xref="alg1.8.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg1.8.m1.1.1.3.7" xref="alg1.8.m1.1.1.3.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.8.m1.1.1.3.1e" xref="alg1.8.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="alg1.8.m1.1.1.3.8" xref="alg1.8.m1.1.1.3.8.cmml">𝑚𝑜𝑑𝑒𝑙𝑠</mi><mo lspace="0em" rspace="0em" id="alg1.8.m1.1.1.3.1f" xref="alg1.8.m1.1.1.3.1.cmml">​</mo><mrow id="alg1.8.m1.1.1.3.9.2" xref="alg1.8.m1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.8.m1.1.1.3.9.2.1" xref="alg1.8.m1.1.1.3.9.1.cmml">(</mo><mo maxsize="90%" minsize="90%" id="alg1.8.m1.1.1.3.9.2.2" xref="alg1.8.m1.1.1.3.9.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.8.m1.1b"><apply id="alg1.8.m1.1.1.cmml" xref="alg1.8.m1.1.1"><ci id="alg1.8.m1.1.1.1.cmml" xref="alg1.8.m1.1.1.1">←</ci><apply id="alg1.8.m1.1.1.2.cmml" xref="alg1.8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.8.m1.1.1.2.1.cmml" xref="alg1.8.m1.1.1.2">superscript</csymbol><ci id="alg1.8.m1.1.1.2.2.cmml" xref="alg1.8.m1.1.1.2.2">𝒲</ci><apply id="alg1.8.m1.1.1.2.3.cmml" xref="alg1.8.m1.1.1.2.3"><minus id="alg1.8.m1.1.1.2.3.1.cmml" xref="alg1.8.m1.1.1.2.3.1"></minus><ci id="alg1.8.m1.1.1.2.3.2.cmml" xref="alg1.8.m1.1.1.2.3.2">𝜏</ci><cn type="integer" id="alg1.8.m1.1.1.2.3.3.cmml" xref="alg1.8.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.8.m1.1.1.3.cmml" xref="alg1.8.m1.1.1.3"><times id="alg1.8.m1.1.1.3.1.cmml" xref="alg1.8.m1.1.1.3.1"></times><ci id="alg1.8.m1.1.1.3.2.cmml" xref="alg1.8.m1.1.1.3.2">𝑔𝑒𝑡</ci><ci id="alg1.8.m1.1.1.3.3.cmml" xref="alg1.8.m1.1.1.3.3">_</ci><ci id="alg1.8.m1.1.1.3.4.cmml" xref="alg1.8.m1.1.1.3.4">𝑐𝑎𝑐ℎ𝑒𝑑</ci><ci id="alg1.8.m1.1.1.3.5.cmml" xref="alg1.8.m1.1.1.3.5">_</ci><ci id="alg1.8.m1.1.1.3.6.cmml" xref="alg1.8.m1.1.1.3.6">𝑐𝑙𝑖𝑒𝑛𝑡</ci><ci id="alg1.8.m1.1.1.3.7.cmml" xref="alg1.8.m1.1.1.3.7">_</ci><ci id="alg1.8.m1.1.1.3.8.cmml" xref="alg1.8.m1.1.1.3.8">𝑚𝑜𝑑𝑒𝑙𝑠</ci><list id="alg1.8.m1.1.1.3.9.1.cmml" xref="alg1.8.m1.1.1.3.9.2.1"></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m1.1c">\mathcal{W}^{\tau-1}\leftarrow\mathit{get}\_\mathit{cached}\_\mathit{client}\_\mathit{models}()</annotation></semantics></math><span id="alg1.10.9" class="ltx_text" style="font-size:90%;">

</span><span id="alg1.10.10" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.9.m2.1" class="ltx_Math" alttext="\mathbf{w}_{g}^{\tau-1}\leftarrow\mathit{get}\_\mathit{global}\_\mathit{model}\_\mathit{of}\_\mathit{last}\_\mathit{round}()" display="inline"><semantics id="alg1.9.m2.1a"><mrow id="alg1.9.m2.1.1" xref="alg1.9.m2.1.1.cmml"><msubsup id="alg1.9.m2.1.1.2" xref="alg1.9.m2.1.1.2.cmml"><mi mathsize="90%" id="alg1.9.m2.1.1.2.2.2" xref="alg1.9.m2.1.1.2.2.2.cmml">𝐰</mi><mi mathsize="90%" id="alg1.9.m2.1.1.2.2.3" xref="alg1.9.m2.1.1.2.2.3.cmml">g</mi><mrow id="alg1.9.m2.1.1.2.3" xref="alg1.9.m2.1.1.2.3.cmml"><mi mathsize="90%" id="alg1.9.m2.1.1.2.3.2" xref="alg1.9.m2.1.1.2.3.2.cmml">τ</mi><mo mathsize="90%" id="alg1.9.m2.1.1.2.3.1" xref="alg1.9.m2.1.1.2.3.1.cmml">−</mo><mn mathsize="90%" id="alg1.9.m2.1.1.2.3.3" xref="alg1.9.m2.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo mathsize="90%" stretchy="false" id="alg1.9.m2.1.1.1" xref="alg1.9.m2.1.1.1.cmml">←</mo><mrow id="alg1.9.m2.1.1.3" xref="alg1.9.m2.1.1.3.cmml"><mi mathsize="90%" id="alg1.9.m2.1.1.3.2" xref="alg1.9.m2.1.1.3.2.cmml">𝑔𝑒𝑡</mi><mo lspace="0em" rspace="0em" id="alg1.9.m2.1.1.3.1" xref="alg1.9.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg1.9.m2.1.1.3.3" xref="alg1.9.m2.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.9.m2.1.1.3.1a" xref="alg1.9.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="alg1.9.m2.1.1.3.4" xref="alg1.9.m2.1.1.3.4.cmml">𝑔𝑙𝑜𝑏𝑎𝑙</mi><mo lspace="0em" rspace="0em" id="alg1.9.m2.1.1.3.1b" xref="alg1.9.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg1.9.m2.1.1.3.5" xref="alg1.9.m2.1.1.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.9.m2.1.1.3.1c" xref="alg1.9.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="alg1.9.m2.1.1.3.6" xref="alg1.9.m2.1.1.3.6.cmml">𝑚𝑜𝑑𝑒𝑙</mi><mo lspace="0em" rspace="0em" id="alg1.9.m2.1.1.3.1d" xref="alg1.9.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg1.9.m2.1.1.3.7" xref="alg1.9.m2.1.1.3.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.9.m2.1.1.3.1e" xref="alg1.9.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="alg1.9.m2.1.1.3.8" xref="alg1.9.m2.1.1.3.8.cmml">𝑜𝑓</mi><mo lspace="0em" rspace="0em" id="alg1.9.m2.1.1.3.1f" xref="alg1.9.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg1.9.m2.1.1.3.9" xref="alg1.9.m2.1.1.3.9.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.9.m2.1.1.3.1g" xref="alg1.9.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="alg1.9.m2.1.1.3.10" xref="alg1.9.m2.1.1.3.10.cmml">𝑙𝑎𝑠𝑡</mi><mo lspace="0em" rspace="0em" id="alg1.9.m2.1.1.3.1h" xref="alg1.9.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg1.9.m2.1.1.3.11" xref="alg1.9.m2.1.1.3.11.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.9.m2.1.1.3.1i" xref="alg1.9.m2.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="alg1.9.m2.1.1.3.12" xref="alg1.9.m2.1.1.3.12.cmml">𝑟𝑜𝑢𝑛𝑑</mi><mo lspace="0em" rspace="0em" id="alg1.9.m2.1.1.3.1j" xref="alg1.9.m2.1.1.3.1.cmml">​</mo><mrow id="alg1.9.m2.1.1.3.13.2" xref="alg1.9.m2.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.9.m2.1.1.3.13.2.1" xref="alg1.9.m2.1.1.3.13.1.cmml">(</mo><mo maxsize="90%" minsize="90%" id="alg1.9.m2.1.1.3.13.2.2" xref="alg1.9.m2.1.1.3.13.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.m2.1b"><apply id="alg1.9.m2.1.1.cmml" xref="alg1.9.m2.1.1"><ci id="alg1.9.m2.1.1.1.cmml" xref="alg1.9.m2.1.1.1">←</ci><apply id="alg1.9.m2.1.1.2.cmml" xref="alg1.9.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.9.m2.1.1.2.1.cmml" xref="alg1.9.m2.1.1.2">superscript</csymbol><apply id="alg1.9.m2.1.1.2.2.cmml" xref="alg1.9.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.9.m2.1.1.2.2.1.cmml" xref="alg1.9.m2.1.1.2">subscript</csymbol><ci id="alg1.9.m2.1.1.2.2.2.cmml" xref="alg1.9.m2.1.1.2.2.2">𝐰</ci><ci id="alg1.9.m2.1.1.2.2.3.cmml" xref="alg1.9.m2.1.1.2.2.3">𝑔</ci></apply><apply id="alg1.9.m2.1.1.2.3.cmml" xref="alg1.9.m2.1.1.2.3"><minus id="alg1.9.m2.1.1.2.3.1.cmml" xref="alg1.9.m2.1.1.2.3.1"></minus><ci id="alg1.9.m2.1.1.2.3.2.cmml" xref="alg1.9.m2.1.1.2.3.2">𝜏</ci><cn type="integer" id="alg1.9.m2.1.1.2.3.3.cmml" xref="alg1.9.m2.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.9.m2.1.1.3.cmml" xref="alg1.9.m2.1.1.3"><times id="alg1.9.m2.1.1.3.1.cmml" xref="alg1.9.m2.1.1.3.1"></times><ci id="alg1.9.m2.1.1.3.2.cmml" xref="alg1.9.m2.1.1.3.2">𝑔𝑒𝑡</ci><ci id="alg1.9.m2.1.1.3.3.cmml" xref="alg1.9.m2.1.1.3.3">_</ci><ci id="alg1.9.m2.1.1.3.4.cmml" xref="alg1.9.m2.1.1.3.4">𝑔𝑙𝑜𝑏𝑎𝑙</ci><ci id="alg1.9.m2.1.1.3.5.cmml" xref="alg1.9.m2.1.1.3.5">_</ci><ci id="alg1.9.m2.1.1.3.6.cmml" xref="alg1.9.m2.1.1.3.6">𝑚𝑜𝑑𝑒𝑙</ci><ci id="alg1.9.m2.1.1.3.7.cmml" xref="alg1.9.m2.1.1.3.7">_</ci><ci id="alg1.9.m2.1.1.3.8.cmml" xref="alg1.9.m2.1.1.3.8">𝑜𝑓</ci><ci id="alg1.9.m2.1.1.3.9.cmml" xref="alg1.9.m2.1.1.3.9">_</ci><ci id="alg1.9.m2.1.1.3.10.cmml" xref="alg1.9.m2.1.1.3.10">𝑙𝑎𝑠𝑡</ci><ci id="alg1.9.m2.1.1.3.11.cmml" xref="alg1.9.m2.1.1.3.11">_</ci><ci id="alg1.9.m2.1.1.3.12.cmml" xref="alg1.9.m2.1.1.3.12">𝑟𝑜𝑢𝑛𝑑</ci><list id="alg1.9.m2.1.1.3.13.1.cmml" xref="alg1.9.m2.1.1.3.13.2.1"></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m2.1c">\mathbf{w}_{g}^{\tau-1}\leftarrow\mathit{get}\_\mathit{global}\_\mathit{model}\_\mathit{of}\_\mathit{last}\_\mathit{round}()</annotation></semantics></math><span id="alg1.10.11" class="ltx_text" style="font-size:90%;">

</span><span id="alg1.10.12" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.10.13" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.10.14" class="ltx_text" style="font-size:90%;"> </span><em id="alg1.10.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="alg1.10.1.m1.1" class="ltx_Math" alttext="\mathbf{w}_{i}^{(\tau)}\in\mathcal{W}^{\tau}" display="inline"><semantics id="alg1.10.1.m1.1a"><mrow id="alg1.10.1.m1.1.2" xref="alg1.10.1.m1.1.2.cmml"><msubsup id="alg1.10.1.m1.1.2.2" xref="alg1.10.1.m1.1.2.2.cmml"><mi id="alg1.10.1.m1.1.2.2.2.2" xref="alg1.10.1.m1.1.2.2.2.2.cmml">𝐰</mi><mi id="alg1.10.1.m1.1.2.2.2.3" xref="alg1.10.1.m1.1.2.2.2.3.cmml">i</mi><mrow id="alg1.10.1.m1.1.1.1.3" xref="alg1.10.1.m1.1.2.2.cmml"><mo stretchy="false" id="alg1.10.1.m1.1.1.1.3.1" xref="alg1.10.1.m1.1.2.2.cmml">(</mo><mi id="alg1.10.1.m1.1.1.1.1" xref="alg1.10.1.m1.1.1.1.1.cmml">τ</mi><mo stretchy="false" id="alg1.10.1.m1.1.1.1.3.2" xref="alg1.10.1.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.10.1.m1.1.2.1" xref="alg1.10.1.m1.1.2.1.cmml">∈</mo><msup id="alg1.10.1.m1.1.2.3" xref="alg1.10.1.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.10.1.m1.1.2.3.2" xref="alg1.10.1.m1.1.2.3.2.cmml">𝒲</mi><mi id="alg1.10.1.m1.1.2.3.3" xref="alg1.10.1.m1.1.2.3.3.cmml">τ</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.10.1.m1.1b"><apply id="alg1.10.1.m1.1.2.cmml" xref="alg1.10.1.m1.1.2"><in id="alg1.10.1.m1.1.2.1.cmml" xref="alg1.10.1.m1.1.2.1"></in><apply id="alg1.10.1.m1.1.2.2.cmml" xref="alg1.10.1.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.10.1.m1.1.2.2.1.cmml" xref="alg1.10.1.m1.1.2.2">superscript</csymbol><apply id="alg1.10.1.m1.1.2.2.2.cmml" xref="alg1.10.1.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.10.1.m1.1.2.2.2.1.cmml" xref="alg1.10.1.m1.1.2.2">subscript</csymbol><ci id="alg1.10.1.m1.1.2.2.2.2.cmml" xref="alg1.10.1.m1.1.2.2.2.2">𝐰</ci><ci id="alg1.10.1.m1.1.2.2.2.3.cmml" xref="alg1.10.1.m1.1.2.2.2.3">𝑖</ci></apply><ci id="alg1.10.1.m1.1.1.1.1.cmml" xref="alg1.10.1.m1.1.1.1.1">𝜏</ci></apply><apply id="alg1.10.1.m1.1.2.3.cmml" xref="alg1.10.1.m1.1.2.3"><csymbol cd="ambiguous" id="alg1.10.1.m1.1.2.3.1.cmml" xref="alg1.10.1.m1.1.2.3">superscript</csymbol><ci id="alg1.10.1.m1.1.2.3.2.cmml" xref="alg1.10.1.m1.1.2.3.2">𝒲</ci><ci id="alg1.10.1.m1.1.2.3.3.cmml" xref="alg1.10.1.m1.1.2.3.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.1.m1.1c">\mathbf{w}_{i}^{(\tau)}\in\mathcal{W}^{\tau}</annotation></semantics></math></em><span id="alg1.10.15" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.10.16" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="alg1.24" class="ltx_block ltx_figure_panel">
<div id="alg1.14" class="ltx_listingline">
<span id="alg1.14.3" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.14.4" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.14.5" class="ltx_text" style="font-size:90%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.14.6.1.1" class="ltx_text" style="font-size:90%;">7</span></span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.14.7.1.1" class="ltx_text" style="font-size:90%;">6</span></span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.14.8.1.1" class="ltx_text" style="font-size:90%;">5</span></span><span id="alg1.14.9" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.11.m1.4" class="ltx_Math" alttext="S_{c}(\mathbf{w}_{i}^{\tau-1},\mathbf{w}_{i}^{\tau})\leftarrow\mathit{get}\_\mathit{similarity}(\mathbf{w}_{i}^{\tau-1},\mathbf{w}_{i}^{\tau})" display="inline"><semantics id="alg1.11.m1.4a"><mrow id="alg1.11.m1.4.4" xref="alg1.11.m1.4.4.cmml"><mrow id="alg1.11.m1.2.2.2" xref="alg1.11.m1.2.2.2.cmml"><msub id="alg1.11.m1.2.2.2.4" xref="alg1.11.m1.2.2.2.4.cmml"><mi mathsize="90%" id="alg1.11.m1.2.2.2.4.2" xref="alg1.11.m1.2.2.2.4.2.cmml">S</mi><mi mathsize="90%" id="alg1.11.m1.2.2.2.4.3" xref="alg1.11.m1.2.2.2.4.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="alg1.11.m1.2.2.2.3" xref="alg1.11.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.11.m1.2.2.2.2.2" xref="alg1.11.m1.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.11.m1.2.2.2.2.2.3" xref="alg1.11.m1.2.2.2.2.3.cmml">(</mo><msubsup id="alg1.11.m1.1.1.1.1.1.1" xref="alg1.11.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.11.m1.1.1.1.1.1.1.2.2" xref="alg1.11.m1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi mathsize="90%" id="alg1.11.m1.1.1.1.1.1.1.2.3" xref="alg1.11.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="alg1.11.m1.1.1.1.1.1.1.3" xref="alg1.11.m1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="alg1.11.m1.1.1.1.1.1.1.3.2" xref="alg1.11.m1.1.1.1.1.1.1.3.2.cmml">τ</mi><mo mathsize="90%" id="alg1.11.m1.1.1.1.1.1.1.3.1" xref="alg1.11.m1.1.1.1.1.1.1.3.1.cmml">−</mo><mn mathsize="90%" id="alg1.11.m1.1.1.1.1.1.1.3.3" xref="alg1.11.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo mathsize="90%" id="alg1.11.m1.2.2.2.2.2.4" xref="alg1.11.m1.2.2.2.2.3.cmml">,</mo><msubsup id="alg1.11.m1.2.2.2.2.2.2" xref="alg1.11.m1.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.11.m1.2.2.2.2.2.2.2.2" xref="alg1.11.m1.2.2.2.2.2.2.2.2.cmml">𝐰</mi><mi mathsize="90%" id="alg1.11.m1.2.2.2.2.2.2.2.3" xref="alg1.11.m1.2.2.2.2.2.2.2.3.cmml">i</mi><mi mathsize="90%" id="alg1.11.m1.2.2.2.2.2.2.3" xref="alg1.11.m1.2.2.2.2.2.2.3.cmml">τ</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.11.m1.2.2.2.2.2.5" xref="alg1.11.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo mathsize="90%" stretchy="false" id="alg1.11.m1.4.4.5" xref="alg1.11.m1.4.4.5.cmml">←</mo><mrow id="alg1.11.m1.4.4.4" xref="alg1.11.m1.4.4.4.cmml"><mi mathsize="90%" id="alg1.11.m1.4.4.4.4" xref="alg1.11.m1.4.4.4.4.cmml">𝑔𝑒𝑡</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.4.4.4.3" xref="alg1.11.m1.4.4.4.3.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg1.11.m1.4.4.4.5" xref="alg1.11.m1.4.4.4.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.4.4.4.3a" xref="alg1.11.m1.4.4.4.3.cmml">​</mo><mi mathsize="90%" id="alg1.11.m1.4.4.4.6" xref="alg1.11.m1.4.4.4.6.cmml">𝑠𝑖𝑚𝑖𝑙𝑎𝑟𝑖𝑡𝑦</mi><mo lspace="0em" rspace="0em" id="alg1.11.m1.4.4.4.3b" xref="alg1.11.m1.4.4.4.3.cmml">​</mo><mrow id="alg1.11.m1.4.4.4.2.2" xref="alg1.11.m1.4.4.4.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.11.m1.4.4.4.2.2.3" xref="alg1.11.m1.4.4.4.2.3.cmml">(</mo><msubsup id="alg1.11.m1.3.3.3.1.1.1" xref="alg1.11.m1.3.3.3.1.1.1.cmml"><mi mathsize="90%" id="alg1.11.m1.3.3.3.1.1.1.2.2" xref="alg1.11.m1.3.3.3.1.1.1.2.2.cmml">𝐰</mi><mi mathsize="90%" id="alg1.11.m1.3.3.3.1.1.1.2.3" xref="alg1.11.m1.3.3.3.1.1.1.2.3.cmml">i</mi><mrow id="alg1.11.m1.3.3.3.1.1.1.3" xref="alg1.11.m1.3.3.3.1.1.1.3.cmml"><mi mathsize="90%" id="alg1.11.m1.3.3.3.1.1.1.3.2" xref="alg1.11.m1.3.3.3.1.1.1.3.2.cmml">τ</mi><mo mathsize="90%" id="alg1.11.m1.3.3.3.1.1.1.3.1" xref="alg1.11.m1.3.3.3.1.1.1.3.1.cmml">−</mo><mn mathsize="90%" id="alg1.11.m1.3.3.3.1.1.1.3.3" xref="alg1.11.m1.3.3.3.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo mathsize="90%" id="alg1.11.m1.4.4.4.2.2.4" xref="alg1.11.m1.4.4.4.2.3.cmml">,</mo><msubsup id="alg1.11.m1.4.4.4.2.2.2" xref="alg1.11.m1.4.4.4.2.2.2.cmml"><mi mathsize="90%" id="alg1.11.m1.4.4.4.2.2.2.2.2" xref="alg1.11.m1.4.4.4.2.2.2.2.2.cmml">𝐰</mi><mi mathsize="90%" id="alg1.11.m1.4.4.4.2.2.2.2.3" xref="alg1.11.m1.4.4.4.2.2.2.2.3.cmml">i</mi><mi mathsize="90%" id="alg1.11.m1.4.4.4.2.2.2.3" xref="alg1.11.m1.4.4.4.2.2.2.3.cmml">τ</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.11.m1.4.4.4.2.2.5" xref="alg1.11.m1.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.11.m1.4b"><apply id="alg1.11.m1.4.4.cmml" xref="alg1.11.m1.4.4"><ci id="alg1.11.m1.4.4.5.cmml" xref="alg1.11.m1.4.4.5">←</ci><apply id="alg1.11.m1.2.2.2.cmml" xref="alg1.11.m1.2.2.2"><times id="alg1.11.m1.2.2.2.3.cmml" xref="alg1.11.m1.2.2.2.3"></times><apply id="alg1.11.m1.2.2.2.4.cmml" xref="alg1.11.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.11.m1.2.2.2.4.1.cmml" xref="alg1.11.m1.2.2.2.4">subscript</csymbol><ci id="alg1.11.m1.2.2.2.4.2.cmml" xref="alg1.11.m1.2.2.2.4.2">𝑆</ci><ci id="alg1.11.m1.2.2.2.4.3.cmml" xref="alg1.11.m1.2.2.2.4.3">𝑐</ci></apply><interval closure="open" id="alg1.11.m1.2.2.2.2.3.cmml" xref="alg1.11.m1.2.2.2.2.2"><apply id="alg1.11.m1.1.1.1.1.1.1.cmml" xref="alg1.11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.11.m1.1.1.1.1.1.1.1.cmml" xref="alg1.11.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.11.m1.1.1.1.1.1.1.2.cmml" xref="alg1.11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.11.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.11.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.11.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.11.m1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="alg1.11.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.11.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.11.m1.1.1.1.1.1.1.3.cmml" xref="alg1.11.m1.1.1.1.1.1.1.3"><minus id="alg1.11.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.11.m1.1.1.1.1.1.1.3.1"></minus><ci id="alg1.11.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.11.m1.1.1.1.1.1.1.3.2">𝜏</ci><cn type="integer" id="alg1.11.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.11.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.11.m1.2.2.2.2.2.2.cmml" xref="alg1.11.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.11.m1.2.2.2.2.2.2.1.cmml" xref="alg1.11.m1.2.2.2.2.2.2">superscript</csymbol><apply id="alg1.11.m1.2.2.2.2.2.2.2.cmml" xref="alg1.11.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.11.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.11.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.11.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.11.m1.2.2.2.2.2.2.2.2">𝐰</ci><ci id="alg1.11.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.11.m1.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="alg1.11.m1.2.2.2.2.2.2.3.cmml" xref="alg1.11.m1.2.2.2.2.2.2.3">𝜏</ci></apply></interval></apply><apply id="alg1.11.m1.4.4.4.cmml" xref="alg1.11.m1.4.4.4"><times id="alg1.11.m1.4.4.4.3.cmml" xref="alg1.11.m1.4.4.4.3"></times><ci id="alg1.11.m1.4.4.4.4.cmml" xref="alg1.11.m1.4.4.4.4">𝑔𝑒𝑡</ci><ci id="alg1.11.m1.4.4.4.5.cmml" xref="alg1.11.m1.4.4.4.5">_</ci><ci id="alg1.11.m1.4.4.4.6.cmml" xref="alg1.11.m1.4.4.4.6">𝑠𝑖𝑚𝑖𝑙𝑎𝑟𝑖𝑡𝑦</ci><interval closure="open" id="alg1.11.m1.4.4.4.2.3.cmml" xref="alg1.11.m1.4.4.4.2.2"><apply id="alg1.11.m1.3.3.3.1.1.1.cmml" xref="alg1.11.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.11.m1.3.3.3.1.1.1.1.cmml" xref="alg1.11.m1.3.3.3.1.1.1">superscript</csymbol><apply id="alg1.11.m1.3.3.3.1.1.1.2.cmml" xref="alg1.11.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.11.m1.3.3.3.1.1.1.2.1.cmml" xref="alg1.11.m1.3.3.3.1.1.1">subscript</csymbol><ci id="alg1.11.m1.3.3.3.1.1.1.2.2.cmml" xref="alg1.11.m1.3.3.3.1.1.1.2.2">𝐰</ci><ci id="alg1.11.m1.3.3.3.1.1.1.2.3.cmml" xref="alg1.11.m1.3.3.3.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.11.m1.3.3.3.1.1.1.3.cmml" xref="alg1.11.m1.3.3.3.1.1.1.3"><minus id="alg1.11.m1.3.3.3.1.1.1.3.1.cmml" xref="alg1.11.m1.3.3.3.1.1.1.3.1"></minus><ci id="alg1.11.m1.3.3.3.1.1.1.3.2.cmml" xref="alg1.11.m1.3.3.3.1.1.1.3.2">𝜏</ci><cn type="integer" id="alg1.11.m1.3.3.3.1.1.1.3.3.cmml" xref="alg1.11.m1.3.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.11.m1.4.4.4.2.2.2.cmml" xref="alg1.11.m1.4.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.11.m1.4.4.4.2.2.2.1.cmml" xref="alg1.11.m1.4.4.4.2.2.2">superscript</csymbol><apply id="alg1.11.m1.4.4.4.2.2.2.2.cmml" xref="alg1.11.m1.4.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.11.m1.4.4.4.2.2.2.2.1.cmml" xref="alg1.11.m1.4.4.4.2.2.2">subscript</csymbol><ci id="alg1.11.m1.4.4.4.2.2.2.2.2.cmml" xref="alg1.11.m1.4.4.4.2.2.2.2.2">𝐰</ci><ci id="alg1.11.m1.4.4.4.2.2.2.2.3.cmml" xref="alg1.11.m1.4.4.4.2.2.2.2.3">𝑖</ci></apply><ci id="alg1.11.m1.4.4.4.2.2.2.3.cmml" xref="alg1.11.m1.4.4.4.2.2.2.3">𝜏</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.m1.4c">S_{c}(\mathbf{w}_{i}^{\tau-1},\mathbf{w}_{i}^{\tau})\leftarrow\mathit{get}\_\mathit{similarity}(\mathbf{w}_{i}^{\tau-1},\mathbf{w}_{i}^{\tau})</annotation></semantics></math><span id="alg1.14.10" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.12.m2.4" class="ltx_Math" alttext="S_{c}(\mathbf{w}_{g}^{\tau-1},\mathbf{w}_{i}^{\tau})\leftarrow\mathit{get}\_\mathit{similarity}(\mathbf{w}_{g}^{\tau-1},\mathbf{w}_{i}^{\tau})" display="inline"><semantics id="alg1.12.m2.4a"><mrow id="alg1.12.m2.4.4" xref="alg1.12.m2.4.4.cmml"><mrow id="alg1.12.m2.2.2.2" xref="alg1.12.m2.2.2.2.cmml"><msub id="alg1.12.m2.2.2.2.4" xref="alg1.12.m2.2.2.2.4.cmml"><mi mathsize="90%" id="alg1.12.m2.2.2.2.4.2" xref="alg1.12.m2.2.2.2.4.2.cmml">S</mi><mi mathsize="90%" id="alg1.12.m2.2.2.2.4.3" xref="alg1.12.m2.2.2.2.4.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="alg1.12.m2.2.2.2.3" xref="alg1.12.m2.2.2.2.3.cmml">​</mo><mrow id="alg1.12.m2.2.2.2.2.2" xref="alg1.12.m2.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.12.m2.2.2.2.2.2.3" xref="alg1.12.m2.2.2.2.2.3.cmml">(</mo><msubsup id="alg1.12.m2.1.1.1.1.1.1" xref="alg1.12.m2.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.12.m2.1.1.1.1.1.1.2.2" xref="alg1.12.m2.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi mathsize="90%" id="alg1.12.m2.1.1.1.1.1.1.2.3" xref="alg1.12.m2.1.1.1.1.1.1.2.3.cmml">g</mi><mrow id="alg1.12.m2.1.1.1.1.1.1.3" xref="alg1.12.m2.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="alg1.12.m2.1.1.1.1.1.1.3.2" xref="alg1.12.m2.1.1.1.1.1.1.3.2.cmml">τ</mi><mo mathsize="90%" id="alg1.12.m2.1.1.1.1.1.1.3.1" xref="alg1.12.m2.1.1.1.1.1.1.3.1.cmml">−</mo><mn mathsize="90%" id="alg1.12.m2.1.1.1.1.1.1.3.3" xref="alg1.12.m2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo mathsize="90%" id="alg1.12.m2.2.2.2.2.2.4" xref="alg1.12.m2.2.2.2.2.3.cmml">,</mo><msubsup id="alg1.12.m2.2.2.2.2.2.2" xref="alg1.12.m2.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.12.m2.2.2.2.2.2.2.2.2" xref="alg1.12.m2.2.2.2.2.2.2.2.2.cmml">𝐰</mi><mi mathsize="90%" id="alg1.12.m2.2.2.2.2.2.2.2.3" xref="alg1.12.m2.2.2.2.2.2.2.2.3.cmml">i</mi><mi mathsize="90%" id="alg1.12.m2.2.2.2.2.2.2.3" xref="alg1.12.m2.2.2.2.2.2.2.3.cmml">τ</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.12.m2.2.2.2.2.2.5" xref="alg1.12.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo mathsize="90%" stretchy="false" id="alg1.12.m2.4.4.5" xref="alg1.12.m2.4.4.5.cmml">←</mo><mrow id="alg1.12.m2.4.4.4" xref="alg1.12.m2.4.4.4.cmml"><mi mathsize="90%" id="alg1.12.m2.4.4.4.4" xref="alg1.12.m2.4.4.4.4.cmml">𝑔𝑒𝑡</mi><mo lspace="0em" rspace="0em" id="alg1.12.m2.4.4.4.3" xref="alg1.12.m2.4.4.4.3.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg1.12.m2.4.4.4.5" xref="alg1.12.m2.4.4.4.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg1.12.m2.4.4.4.3a" xref="alg1.12.m2.4.4.4.3.cmml">​</mo><mi mathsize="90%" id="alg1.12.m2.4.4.4.6" xref="alg1.12.m2.4.4.4.6.cmml">𝑠𝑖𝑚𝑖𝑙𝑎𝑟𝑖𝑡𝑦</mi><mo lspace="0em" rspace="0em" id="alg1.12.m2.4.4.4.3b" xref="alg1.12.m2.4.4.4.3.cmml">​</mo><mrow id="alg1.12.m2.4.4.4.2.2" xref="alg1.12.m2.4.4.4.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.12.m2.4.4.4.2.2.3" xref="alg1.12.m2.4.4.4.2.3.cmml">(</mo><msubsup id="alg1.12.m2.3.3.3.1.1.1" xref="alg1.12.m2.3.3.3.1.1.1.cmml"><mi mathsize="90%" id="alg1.12.m2.3.3.3.1.1.1.2.2" xref="alg1.12.m2.3.3.3.1.1.1.2.2.cmml">𝐰</mi><mi mathsize="90%" id="alg1.12.m2.3.3.3.1.1.1.2.3" xref="alg1.12.m2.3.3.3.1.1.1.2.3.cmml">g</mi><mrow id="alg1.12.m2.3.3.3.1.1.1.3" xref="alg1.12.m2.3.3.3.1.1.1.3.cmml"><mi mathsize="90%" id="alg1.12.m2.3.3.3.1.1.1.3.2" xref="alg1.12.m2.3.3.3.1.1.1.3.2.cmml">τ</mi><mo mathsize="90%" id="alg1.12.m2.3.3.3.1.1.1.3.1" xref="alg1.12.m2.3.3.3.1.1.1.3.1.cmml">−</mo><mn mathsize="90%" id="alg1.12.m2.3.3.3.1.1.1.3.3" xref="alg1.12.m2.3.3.3.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo mathsize="90%" id="alg1.12.m2.4.4.4.2.2.4" xref="alg1.12.m2.4.4.4.2.3.cmml">,</mo><msubsup id="alg1.12.m2.4.4.4.2.2.2" xref="alg1.12.m2.4.4.4.2.2.2.cmml"><mi mathsize="90%" id="alg1.12.m2.4.4.4.2.2.2.2.2" xref="alg1.12.m2.4.4.4.2.2.2.2.2.cmml">𝐰</mi><mi mathsize="90%" id="alg1.12.m2.4.4.4.2.2.2.2.3" xref="alg1.12.m2.4.4.4.2.2.2.2.3.cmml">i</mi><mi mathsize="90%" id="alg1.12.m2.4.4.4.2.2.2.3" xref="alg1.12.m2.4.4.4.2.2.2.3.cmml">τ</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.12.m2.4.4.4.2.2.5" xref="alg1.12.m2.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.12.m2.4b"><apply id="alg1.12.m2.4.4.cmml" xref="alg1.12.m2.4.4"><ci id="alg1.12.m2.4.4.5.cmml" xref="alg1.12.m2.4.4.5">←</ci><apply id="alg1.12.m2.2.2.2.cmml" xref="alg1.12.m2.2.2.2"><times id="alg1.12.m2.2.2.2.3.cmml" xref="alg1.12.m2.2.2.2.3"></times><apply id="alg1.12.m2.2.2.2.4.cmml" xref="alg1.12.m2.2.2.2.4"><csymbol cd="ambiguous" id="alg1.12.m2.2.2.2.4.1.cmml" xref="alg1.12.m2.2.2.2.4">subscript</csymbol><ci id="alg1.12.m2.2.2.2.4.2.cmml" xref="alg1.12.m2.2.2.2.4.2">𝑆</ci><ci id="alg1.12.m2.2.2.2.4.3.cmml" xref="alg1.12.m2.2.2.2.4.3">𝑐</ci></apply><interval closure="open" id="alg1.12.m2.2.2.2.2.3.cmml" xref="alg1.12.m2.2.2.2.2.2"><apply id="alg1.12.m2.1.1.1.1.1.1.cmml" xref="alg1.12.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.12.m2.1.1.1.1.1.1.1.cmml" xref="alg1.12.m2.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.12.m2.1.1.1.1.1.1.2.cmml" xref="alg1.12.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.12.m2.1.1.1.1.1.1.2.1.cmml" xref="alg1.12.m2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.12.m2.1.1.1.1.1.1.2.2.cmml" xref="alg1.12.m2.1.1.1.1.1.1.2.2">𝐰</ci><ci id="alg1.12.m2.1.1.1.1.1.1.2.3.cmml" xref="alg1.12.m2.1.1.1.1.1.1.2.3">𝑔</ci></apply><apply id="alg1.12.m2.1.1.1.1.1.1.3.cmml" xref="alg1.12.m2.1.1.1.1.1.1.3"><minus id="alg1.12.m2.1.1.1.1.1.1.3.1.cmml" xref="alg1.12.m2.1.1.1.1.1.1.3.1"></minus><ci id="alg1.12.m2.1.1.1.1.1.1.3.2.cmml" xref="alg1.12.m2.1.1.1.1.1.1.3.2">𝜏</ci><cn type="integer" id="alg1.12.m2.1.1.1.1.1.1.3.3.cmml" xref="alg1.12.m2.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.12.m2.2.2.2.2.2.2.cmml" xref="alg1.12.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.12.m2.2.2.2.2.2.2.1.cmml" xref="alg1.12.m2.2.2.2.2.2.2">superscript</csymbol><apply id="alg1.12.m2.2.2.2.2.2.2.2.cmml" xref="alg1.12.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.12.m2.2.2.2.2.2.2.2.1.cmml" xref="alg1.12.m2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.12.m2.2.2.2.2.2.2.2.2.cmml" xref="alg1.12.m2.2.2.2.2.2.2.2.2">𝐰</ci><ci id="alg1.12.m2.2.2.2.2.2.2.2.3.cmml" xref="alg1.12.m2.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="alg1.12.m2.2.2.2.2.2.2.3.cmml" xref="alg1.12.m2.2.2.2.2.2.2.3">𝜏</ci></apply></interval></apply><apply id="alg1.12.m2.4.4.4.cmml" xref="alg1.12.m2.4.4.4"><times id="alg1.12.m2.4.4.4.3.cmml" xref="alg1.12.m2.4.4.4.3"></times><ci id="alg1.12.m2.4.4.4.4.cmml" xref="alg1.12.m2.4.4.4.4">𝑔𝑒𝑡</ci><ci id="alg1.12.m2.4.4.4.5.cmml" xref="alg1.12.m2.4.4.4.5">_</ci><ci id="alg1.12.m2.4.4.4.6.cmml" xref="alg1.12.m2.4.4.4.6">𝑠𝑖𝑚𝑖𝑙𝑎𝑟𝑖𝑡𝑦</ci><interval closure="open" id="alg1.12.m2.4.4.4.2.3.cmml" xref="alg1.12.m2.4.4.4.2.2"><apply id="alg1.12.m2.3.3.3.1.1.1.cmml" xref="alg1.12.m2.3.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.12.m2.3.3.3.1.1.1.1.cmml" xref="alg1.12.m2.3.3.3.1.1.1">superscript</csymbol><apply id="alg1.12.m2.3.3.3.1.1.1.2.cmml" xref="alg1.12.m2.3.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.12.m2.3.3.3.1.1.1.2.1.cmml" xref="alg1.12.m2.3.3.3.1.1.1">subscript</csymbol><ci id="alg1.12.m2.3.3.3.1.1.1.2.2.cmml" xref="alg1.12.m2.3.3.3.1.1.1.2.2">𝐰</ci><ci id="alg1.12.m2.3.3.3.1.1.1.2.3.cmml" xref="alg1.12.m2.3.3.3.1.1.1.2.3">𝑔</ci></apply><apply id="alg1.12.m2.3.3.3.1.1.1.3.cmml" xref="alg1.12.m2.3.3.3.1.1.1.3"><minus id="alg1.12.m2.3.3.3.1.1.1.3.1.cmml" xref="alg1.12.m2.3.3.3.1.1.1.3.1"></minus><ci id="alg1.12.m2.3.3.3.1.1.1.3.2.cmml" xref="alg1.12.m2.3.3.3.1.1.1.3.2">𝜏</ci><cn type="integer" id="alg1.12.m2.3.3.3.1.1.1.3.3.cmml" xref="alg1.12.m2.3.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.12.m2.4.4.4.2.2.2.cmml" xref="alg1.12.m2.4.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.12.m2.4.4.4.2.2.2.1.cmml" xref="alg1.12.m2.4.4.4.2.2.2">superscript</csymbol><apply id="alg1.12.m2.4.4.4.2.2.2.2.cmml" xref="alg1.12.m2.4.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.12.m2.4.4.4.2.2.2.2.1.cmml" xref="alg1.12.m2.4.4.4.2.2.2">subscript</csymbol><ci id="alg1.12.m2.4.4.4.2.2.2.2.2.cmml" xref="alg1.12.m2.4.4.4.2.2.2.2.2">𝐰</ci><ci id="alg1.12.m2.4.4.4.2.2.2.2.3.cmml" xref="alg1.12.m2.4.4.4.2.2.2.2.3">𝑖</ci></apply><ci id="alg1.12.m2.4.4.4.2.2.2.3.cmml" xref="alg1.12.m2.4.4.4.2.2.2.3">𝜏</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.m2.4c">S_{c}(\mathbf{w}_{g}^{\tau-1},\mathbf{w}_{i}^{\tau})\leftarrow\mathit{get}\_\mathit{similarity}(\mathbf{w}_{g}^{\tau-1},\mathbf{w}_{i}^{\tau})</annotation></semantics></math><span id="alg1.14.11" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.14.12" class="ltx_text ltx_font_bold" style="font-size:90%;">if</span><span id="alg1.14.13" class="ltx_text" style="font-size:90%;"> </span><em id="alg1.14.2" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="alg1.13.1.m1.2" class="ltx_Math" alttext="S_{c}(\mathbf{w}_{g}^{\tau-1},\mathbf{w}_{i}^{\tau})&lt;\gamma" display="inline"><semantics id="alg1.13.1.m1.2a"><mrow id="alg1.13.1.m1.2.2" xref="alg1.13.1.m1.2.2.cmml"><mrow id="alg1.13.1.m1.2.2.2" xref="alg1.13.1.m1.2.2.2.cmml"><msub id="alg1.13.1.m1.2.2.2.4" xref="alg1.13.1.m1.2.2.2.4.cmml"><mi id="alg1.13.1.m1.2.2.2.4.2" xref="alg1.13.1.m1.2.2.2.4.2.cmml">S</mi><mi id="alg1.13.1.m1.2.2.2.4.3" xref="alg1.13.1.m1.2.2.2.4.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="alg1.13.1.m1.2.2.2.3" xref="alg1.13.1.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.13.1.m1.2.2.2.2.2" xref="alg1.13.1.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.13.1.m1.2.2.2.2.2.3" xref="alg1.13.1.m1.2.2.2.2.3.cmml">(</mo><msubsup id="alg1.13.1.m1.1.1.1.1.1.1" xref="alg1.13.1.m1.1.1.1.1.1.1.cmml"><mi id="alg1.13.1.m1.1.1.1.1.1.1.2.2" xref="alg1.13.1.m1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="alg1.13.1.m1.1.1.1.1.1.1.2.3" xref="alg1.13.1.m1.1.1.1.1.1.1.2.3.cmml">g</mi><mrow id="alg1.13.1.m1.1.1.1.1.1.1.3" xref="alg1.13.1.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.13.1.m1.1.1.1.1.1.1.3.2" xref="alg1.13.1.m1.1.1.1.1.1.1.3.2.cmml">τ</mi><mo id="alg1.13.1.m1.1.1.1.1.1.1.3.1" xref="alg1.13.1.m1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg1.13.1.m1.1.1.1.1.1.1.3.3" xref="alg1.13.1.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.13.1.m1.2.2.2.2.2.4" xref="alg1.13.1.m1.2.2.2.2.3.cmml">,</mo><msubsup id="alg1.13.1.m1.2.2.2.2.2.2" xref="alg1.13.1.m1.2.2.2.2.2.2.cmml"><mi id="alg1.13.1.m1.2.2.2.2.2.2.2.2" xref="alg1.13.1.m1.2.2.2.2.2.2.2.2.cmml">𝐰</mi><mi id="alg1.13.1.m1.2.2.2.2.2.2.2.3" xref="alg1.13.1.m1.2.2.2.2.2.2.2.3.cmml">i</mi><mi id="alg1.13.1.m1.2.2.2.2.2.2.3" xref="alg1.13.1.m1.2.2.2.2.2.2.3.cmml">τ</mi></msubsup><mo stretchy="false" id="alg1.13.1.m1.2.2.2.2.2.5" xref="alg1.13.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.13.1.m1.2.2.3" xref="alg1.13.1.m1.2.2.3.cmml">&lt;</mo><mi id="alg1.13.1.m1.2.2.4" xref="alg1.13.1.m1.2.2.4.cmml">γ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.13.1.m1.2b"><apply id="alg1.13.1.m1.2.2.cmml" xref="alg1.13.1.m1.2.2"><lt id="alg1.13.1.m1.2.2.3.cmml" xref="alg1.13.1.m1.2.2.3"></lt><apply id="alg1.13.1.m1.2.2.2.cmml" xref="alg1.13.1.m1.2.2.2"><times id="alg1.13.1.m1.2.2.2.3.cmml" xref="alg1.13.1.m1.2.2.2.3"></times><apply id="alg1.13.1.m1.2.2.2.4.cmml" xref="alg1.13.1.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.13.1.m1.2.2.2.4.1.cmml" xref="alg1.13.1.m1.2.2.2.4">subscript</csymbol><ci id="alg1.13.1.m1.2.2.2.4.2.cmml" xref="alg1.13.1.m1.2.2.2.4.2">𝑆</ci><ci id="alg1.13.1.m1.2.2.2.4.3.cmml" xref="alg1.13.1.m1.2.2.2.4.3">𝑐</ci></apply><interval closure="open" id="alg1.13.1.m1.2.2.2.2.3.cmml" xref="alg1.13.1.m1.2.2.2.2.2"><apply id="alg1.13.1.m1.1.1.1.1.1.1.cmml" xref="alg1.13.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.13.1.m1.1.1.1.1.1.1.1.cmml" xref="alg1.13.1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.13.1.m1.1.1.1.1.1.1.2.cmml" xref="alg1.13.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.13.1.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.13.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.13.1.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.13.1.m1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="alg1.13.1.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.13.1.m1.1.1.1.1.1.1.2.3">𝑔</ci></apply><apply id="alg1.13.1.m1.1.1.1.1.1.1.3.cmml" xref="alg1.13.1.m1.1.1.1.1.1.1.3"><minus id="alg1.13.1.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.13.1.m1.1.1.1.1.1.1.3.1"></minus><ci id="alg1.13.1.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.13.1.m1.1.1.1.1.1.1.3.2">𝜏</ci><cn type="integer" id="alg1.13.1.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.13.1.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.13.1.m1.2.2.2.2.2.2.cmml" xref="alg1.13.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.13.1.m1.2.2.2.2.2.2.1.cmml" xref="alg1.13.1.m1.2.2.2.2.2.2">superscript</csymbol><apply id="alg1.13.1.m1.2.2.2.2.2.2.2.cmml" xref="alg1.13.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.13.1.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.13.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.13.1.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.13.1.m1.2.2.2.2.2.2.2.2">𝐰</ci><ci id="alg1.13.1.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.13.1.m1.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="alg1.13.1.m1.2.2.2.2.2.2.3.cmml" xref="alg1.13.1.m1.2.2.2.2.2.2.3">𝜏</ci></apply></interval></apply><ci id="alg1.13.1.m1.2.2.4.cmml" xref="alg1.13.1.m1.2.2.4">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.1.m1.2c">S_{c}(\mathbf{w}_{g}^{\tau-1},\mathbf{w}_{i}^{\tau})&lt;\gamma</annotation></semantics></math> or <math id="alg1.14.2.m2.2" class="ltx_Math" alttext="S_{c}(\mathbf{w}_{i}^{\tau-1},\mathbf{w}_{i}^{\tau})&lt;\gamma" display="inline"><semantics id="alg1.14.2.m2.2a"><mrow id="alg1.14.2.m2.2.2" xref="alg1.14.2.m2.2.2.cmml"><mrow id="alg1.14.2.m2.2.2.2" xref="alg1.14.2.m2.2.2.2.cmml"><msub id="alg1.14.2.m2.2.2.2.4" xref="alg1.14.2.m2.2.2.2.4.cmml"><mi id="alg1.14.2.m2.2.2.2.4.2" xref="alg1.14.2.m2.2.2.2.4.2.cmml">S</mi><mi id="alg1.14.2.m2.2.2.2.4.3" xref="alg1.14.2.m2.2.2.2.4.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="alg1.14.2.m2.2.2.2.3" xref="alg1.14.2.m2.2.2.2.3.cmml">​</mo><mrow id="alg1.14.2.m2.2.2.2.2.2" xref="alg1.14.2.m2.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.14.2.m2.2.2.2.2.2.3" xref="alg1.14.2.m2.2.2.2.2.3.cmml">(</mo><msubsup id="alg1.14.2.m2.1.1.1.1.1.1" xref="alg1.14.2.m2.1.1.1.1.1.1.cmml"><mi id="alg1.14.2.m2.1.1.1.1.1.1.2.2" xref="alg1.14.2.m2.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="alg1.14.2.m2.1.1.1.1.1.1.2.3" xref="alg1.14.2.m2.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="alg1.14.2.m2.1.1.1.1.1.1.3" xref="alg1.14.2.m2.1.1.1.1.1.1.3.cmml"><mi id="alg1.14.2.m2.1.1.1.1.1.1.3.2" xref="alg1.14.2.m2.1.1.1.1.1.1.3.2.cmml">τ</mi><mo id="alg1.14.2.m2.1.1.1.1.1.1.3.1" xref="alg1.14.2.m2.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg1.14.2.m2.1.1.1.1.1.1.3.3" xref="alg1.14.2.m2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.14.2.m2.2.2.2.2.2.4" xref="alg1.14.2.m2.2.2.2.2.3.cmml">,</mo><msubsup id="alg1.14.2.m2.2.2.2.2.2.2" xref="alg1.14.2.m2.2.2.2.2.2.2.cmml"><mi id="alg1.14.2.m2.2.2.2.2.2.2.2.2" xref="alg1.14.2.m2.2.2.2.2.2.2.2.2.cmml">𝐰</mi><mi id="alg1.14.2.m2.2.2.2.2.2.2.2.3" xref="alg1.14.2.m2.2.2.2.2.2.2.2.3.cmml">i</mi><mi id="alg1.14.2.m2.2.2.2.2.2.2.3" xref="alg1.14.2.m2.2.2.2.2.2.2.3.cmml">τ</mi></msubsup><mo stretchy="false" id="alg1.14.2.m2.2.2.2.2.2.5" xref="alg1.14.2.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.14.2.m2.2.2.3" xref="alg1.14.2.m2.2.2.3.cmml">&lt;</mo><mi id="alg1.14.2.m2.2.2.4" xref="alg1.14.2.m2.2.2.4.cmml">γ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.14.2.m2.2b"><apply id="alg1.14.2.m2.2.2.cmml" xref="alg1.14.2.m2.2.2"><lt id="alg1.14.2.m2.2.2.3.cmml" xref="alg1.14.2.m2.2.2.3"></lt><apply id="alg1.14.2.m2.2.2.2.cmml" xref="alg1.14.2.m2.2.2.2"><times id="alg1.14.2.m2.2.2.2.3.cmml" xref="alg1.14.2.m2.2.2.2.3"></times><apply id="alg1.14.2.m2.2.2.2.4.cmml" xref="alg1.14.2.m2.2.2.2.4"><csymbol cd="ambiguous" id="alg1.14.2.m2.2.2.2.4.1.cmml" xref="alg1.14.2.m2.2.2.2.4">subscript</csymbol><ci id="alg1.14.2.m2.2.2.2.4.2.cmml" xref="alg1.14.2.m2.2.2.2.4.2">𝑆</ci><ci id="alg1.14.2.m2.2.2.2.4.3.cmml" xref="alg1.14.2.m2.2.2.2.4.3">𝑐</ci></apply><interval closure="open" id="alg1.14.2.m2.2.2.2.2.3.cmml" xref="alg1.14.2.m2.2.2.2.2.2"><apply id="alg1.14.2.m2.1.1.1.1.1.1.cmml" xref="alg1.14.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.14.2.m2.1.1.1.1.1.1.1.cmml" xref="alg1.14.2.m2.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.14.2.m2.1.1.1.1.1.1.2.cmml" xref="alg1.14.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.14.2.m2.1.1.1.1.1.1.2.1.cmml" xref="alg1.14.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.14.2.m2.1.1.1.1.1.1.2.2.cmml" xref="alg1.14.2.m2.1.1.1.1.1.1.2.2">𝐰</ci><ci id="alg1.14.2.m2.1.1.1.1.1.1.2.3.cmml" xref="alg1.14.2.m2.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.14.2.m2.1.1.1.1.1.1.3.cmml" xref="alg1.14.2.m2.1.1.1.1.1.1.3"><minus id="alg1.14.2.m2.1.1.1.1.1.1.3.1.cmml" xref="alg1.14.2.m2.1.1.1.1.1.1.3.1"></minus><ci id="alg1.14.2.m2.1.1.1.1.1.1.3.2.cmml" xref="alg1.14.2.m2.1.1.1.1.1.1.3.2">𝜏</ci><cn type="integer" id="alg1.14.2.m2.1.1.1.1.1.1.3.3.cmml" xref="alg1.14.2.m2.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.14.2.m2.2.2.2.2.2.2.cmml" xref="alg1.14.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.14.2.m2.2.2.2.2.2.2.1.cmml" xref="alg1.14.2.m2.2.2.2.2.2.2">superscript</csymbol><apply id="alg1.14.2.m2.2.2.2.2.2.2.2.cmml" xref="alg1.14.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.14.2.m2.2.2.2.2.2.2.2.1.cmml" xref="alg1.14.2.m2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.14.2.m2.2.2.2.2.2.2.2.2.cmml" xref="alg1.14.2.m2.2.2.2.2.2.2.2.2">𝐰</ci><ci id="alg1.14.2.m2.2.2.2.2.2.2.2.3.cmml" xref="alg1.14.2.m2.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="alg1.14.2.m2.2.2.2.2.2.2.3.cmml" xref="alg1.14.2.m2.2.2.2.2.2.2.3">𝜏</ci></apply></interval></apply><ci id="alg1.14.2.m2.2.2.4.cmml" xref="alg1.14.2.m2.2.2.4">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.2.m2.2c">S_{c}(\mathbf{w}_{i}^{\tau-1},\mathbf{w}_{i}^{\tau})&lt;\gamma</annotation></semantics></math> </em><span id="alg1.14.14" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.14.15" class="ltx_text ltx_font_bold" style="font-size:90%;">then</span>
</div>
<div id="alg1.16" class="ltx_listingline">
<span id="alg1.16.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.16.2" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.16.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.16.4" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.16.5" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.16.6" class="ltx_text ltx_font_bold" style="font-size:90%;">return</span><span id="alg1.16.7" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.15.m1.1" class="ltx_Math" alttext="\mathit{True}" display="inline"><semantics id="alg1.15.m1.1a"><mi mathsize="90%" id="alg1.15.m1.1.1" xref="alg1.15.m1.1.1.cmml">𝑇𝑟𝑢𝑒</mi><annotation-xml encoding="MathML-Content" id="alg1.15.m1.1b"><ci id="alg1.15.m1.1.1.cmml" xref="alg1.15.m1.1.1">𝑇𝑟𝑢𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.m1.1c">\mathit{True}</annotation></semantics></math><span id="alg1.16.8" class="ltx_text" style="font-size:90%;">  </span><math id="alg1.16.m2.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.16.m2.1a"><mo mathsize="90%" id="alg1.16.m2.1.1" xref="alg1.16.m2.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.16.m2.1b"><ci id="alg1.16.m2.1.1.cmml" xref="alg1.16.m2.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.m2.1c">\triangleright</annotation></semantics></math><span id="alg1.16.9" class="ltx_text" style="font-size:90%;"> Attacks may occur.
</span>
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="alg1.25" class="ltx_block ltx_figure_panel">
<div id="alg1.25.1" class="ltx_listingline">
<span id="alg1.25.1.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.25.1.2" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.25.1.3" class="ltx_text" style="font-size:90%;">   </span>
</div>
<div id="alg1.18" class="ltx_listingline">
<span id="alg1.18.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.18.2" class="ltx_text" style="font-size:90%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.18.3.1.1" class="ltx_text" style="font-size:90%;">8</span></span><span id="alg1.18.4" class="ltx_text" style="font-size:90%;">


</span><span id="alg1.18.5" class="ltx_text ltx_font_bold" style="font-size:90%;">return</span><span id="alg1.18.6" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.17.m1.1" class="ltx_Math" alttext="\mathit{False}" display="inline"><semantics id="alg1.17.m1.1a"><mi mathsize="90%" id="alg1.17.m1.1.1" xref="alg1.17.m1.1.1.cmml">𝐹𝑎𝑙𝑠𝑒</mi><annotation-xml encoding="MathML-Content" id="alg1.17.m1.1b"><ci id="alg1.17.m1.1.1.cmml" xref="alg1.17.m1.1.1">𝐹𝑎𝑙𝑠𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.m1.1c">\mathit{False}</annotation></semantics></math><span id="alg1.18.7" class="ltx_text" style="font-size:90%;">  </span><math id="alg1.18.m2.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.18.m2.1a"><mo mathsize="90%" id="alg1.18.m2.1.1" xref="alg1.18.m2.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.18.m2.1b"><ci id="alg1.18.m2.1.1.cmml" xref="alg1.18.m2.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.m2.1c">\triangleright</annotation></semantics></math><span id="alg1.18.8" class="ltx_text" style="font-size:90%;"> Attack does not occur.
</span>
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="alg1.26" class="ltx_listingline ltx_figure_panel">
</div>
</div>
</div>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.3" class="ltx_p">We present the intuitive idea of <a href="#S3.Thmtheorem1" title="Theorem 3.1. ‣ 3.1 Cross-Round Detection ‣ 3 Two-Stage Anomaly Detection ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Theorem</span> <span class="ltx_text ltx_ref_tag">3.1</span></a> in <a href="#S3.F2" title="In 3.1 Cross-Round Detection ‣ 3 Two-Stage Anomaly Detection ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a>. Inspired by the state-of-art <cite class="ltx_cite ltx_citemacro_citep">(Fung et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>, we utilize the cosine score to compute similarities. For each local model <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{w}_{i}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝐰</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathbf{w}_{i}</annotation></semantics></math>, and its reference model <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{w}_{r}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝐰</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathbf{w}_{r}</annotation></semantics></math>, the cosine similarity is computed as
<math id="S3.SS1.p2.3.m3.4" class="ltx_Math" alttext="S_{c}(\mathbf{w}_{i},\mathbf{w}_{r})=\frac{\mathbf{w}_{i}\cdot\mathbf{w}_{r}}{||\mathbf{w}_{i}||\cdot||\mathbf{w}_{r}||}" display="inline"><semantics id="S3.SS1.p2.3.m3.4a"><mrow id="S3.SS1.p2.3.m3.4.4" xref="S3.SS1.p2.3.m3.4.4.cmml"><mrow id="S3.SS1.p2.3.m3.4.4.2" xref="S3.SS1.p2.3.m3.4.4.2.cmml"><msub id="S3.SS1.p2.3.m3.4.4.2.4" xref="S3.SS1.p2.3.m3.4.4.2.4.cmml"><mi id="S3.SS1.p2.3.m3.4.4.2.4.2" xref="S3.SS1.p2.3.m3.4.4.2.4.2.cmml">S</mi><mi id="S3.SS1.p2.3.m3.4.4.2.4.3" xref="S3.SS1.p2.3.m3.4.4.2.4.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.3.m3.4.4.2.3" xref="S3.SS1.p2.3.m3.4.4.2.3.cmml">​</mo><mrow id="S3.SS1.p2.3.m3.4.4.2.2.2" xref="S3.SS1.p2.3.m3.4.4.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.4.4.2.2.2.3" xref="S3.SS1.p2.3.m3.4.4.2.2.3.cmml">(</mo><msub id="S3.SS1.p2.3.m3.3.3.1.1.1.1" xref="S3.SS1.p2.3.m3.3.3.1.1.1.1.cmml"><mi id="S3.SS1.p2.3.m3.3.3.1.1.1.1.2" xref="S3.SS1.p2.3.m3.3.3.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p2.3.m3.3.3.1.1.1.1.3" xref="S3.SS1.p2.3.m3.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p2.3.m3.4.4.2.2.2.4" xref="S3.SS1.p2.3.m3.4.4.2.2.3.cmml">,</mo><msub id="S3.SS1.p2.3.m3.4.4.2.2.2.2" xref="S3.SS1.p2.3.m3.4.4.2.2.2.2.cmml"><mi id="S3.SS1.p2.3.m3.4.4.2.2.2.2.2" xref="S3.SS1.p2.3.m3.4.4.2.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS1.p2.3.m3.4.4.2.2.2.2.3" xref="S3.SS1.p2.3.m3.4.4.2.2.2.2.3.cmml">r</mi></msub><mo stretchy="false" id="S3.SS1.p2.3.m3.4.4.2.2.2.5" xref="S3.SS1.p2.3.m3.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.3.m3.4.4.3" xref="S3.SS1.p2.3.m3.4.4.3.cmml">=</mo><mfrac id="S3.SS1.p2.3.m3.2.2" xref="S3.SS1.p2.3.m3.2.2.cmml"><mrow id="S3.SS1.p2.3.m3.2.2.4" xref="S3.SS1.p2.3.m3.2.2.4.cmml"><msub id="S3.SS1.p2.3.m3.2.2.4.2" xref="S3.SS1.p2.3.m3.2.2.4.2.cmml"><mi id="S3.SS1.p2.3.m3.2.2.4.2.2" xref="S3.SS1.p2.3.m3.2.2.4.2.2.cmml">𝐰</mi><mi id="S3.SS1.p2.3.m3.2.2.4.2.3" xref="S3.SS1.p2.3.m3.2.2.4.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.3.m3.2.2.4.1" xref="S3.SS1.p2.3.m3.2.2.4.1.cmml">⋅</mo><msub id="S3.SS1.p2.3.m3.2.2.4.3" xref="S3.SS1.p2.3.m3.2.2.4.3.cmml"><mi id="S3.SS1.p2.3.m3.2.2.4.3.2" xref="S3.SS1.p2.3.m3.2.2.4.3.2.cmml">𝐰</mi><mi id="S3.SS1.p2.3.m3.2.2.4.3.3" xref="S3.SS1.p2.3.m3.2.2.4.3.3.cmml">r</mi></msub></mrow><mrow id="S3.SS1.p2.3.m3.2.2.2" xref="S3.SS1.p2.3.m3.2.2.2.cmml"><mrow id="S3.SS1.p2.3.m3.1.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.2.cmml"><mo maxsize="142%" minsize="142%" id="S3.SS1.p2.3.m3.1.1.1.1.1.2" xref="S3.SS1.p2.3.m3.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.SS1.p2.3.m3.1.1.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.1.1.1.1.2" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p2.3.m3.1.1.1.1.1.1.3" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="142%" minsize="142%" rspace="0.055em" id="S3.SS1.p2.3.m3.1.1.1.1.1.3" xref="S3.SS1.p2.3.m3.1.1.1.1.2.1.cmml">‖</mo></mrow><mo rspace="0.222em" id="S3.SS1.p2.3.m3.2.2.2.3" xref="S3.SS1.p2.3.m3.2.2.2.3.cmml">⋅</mo><mrow id="S3.SS1.p2.3.m3.2.2.2.2.1" xref="S3.SS1.p2.3.m3.2.2.2.2.2.cmml"><mo maxsize="142%" minsize="142%" id="S3.SS1.p2.3.m3.2.2.2.2.1.2" xref="S3.SS1.p2.3.m3.2.2.2.2.2.1.cmml">‖</mo><msub id="S3.SS1.p2.3.m3.2.2.2.2.1.1" xref="S3.SS1.p2.3.m3.2.2.2.2.1.1.cmml"><mi id="S3.SS1.p2.3.m3.2.2.2.2.1.1.2" xref="S3.SS1.p2.3.m3.2.2.2.2.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p2.3.m3.2.2.2.2.1.1.3" xref="S3.SS1.p2.3.m3.2.2.2.2.1.1.3.cmml">r</mi></msub><mo maxsize="142%" minsize="142%" id="S3.SS1.p2.3.m3.2.2.2.2.1.3" xref="S3.SS1.p2.3.m3.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.4b"><apply id="S3.SS1.p2.3.m3.4.4.cmml" xref="S3.SS1.p2.3.m3.4.4"><eq id="S3.SS1.p2.3.m3.4.4.3.cmml" xref="S3.SS1.p2.3.m3.4.4.3"></eq><apply id="S3.SS1.p2.3.m3.4.4.2.cmml" xref="S3.SS1.p2.3.m3.4.4.2"><times id="S3.SS1.p2.3.m3.4.4.2.3.cmml" xref="S3.SS1.p2.3.m3.4.4.2.3"></times><apply id="S3.SS1.p2.3.m3.4.4.2.4.cmml" xref="S3.SS1.p2.3.m3.4.4.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.4.4.2.4.1.cmml" xref="S3.SS1.p2.3.m3.4.4.2.4">subscript</csymbol><ci id="S3.SS1.p2.3.m3.4.4.2.4.2.cmml" xref="S3.SS1.p2.3.m3.4.4.2.4.2">𝑆</ci><ci id="S3.SS1.p2.3.m3.4.4.2.4.3.cmml" xref="S3.SS1.p2.3.m3.4.4.2.4.3">𝑐</ci></apply><interval closure="open" id="S3.SS1.p2.3.m3.4.4.2.2.3.cmml" xref="S3.SS1.p2.3.m3.4.4.2.2.2"><apply id="S3.SS1.p2.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.3.3.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.3.3.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.3.3.1.1.1.1.2">𝐰</ci><ci id="S3.SS1.p2.3.m3.3.3.1.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.3.3.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p2.3.m3.4.4.2.2.2.2.cmml" xref="S3.SS1.p2.3.m3.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.4.4.2.2.2.2.1.cmml" xref="S3.SS1.p2.3.m3.4.4.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.4.4.2.2.2.2.2.cmml" xref="S3.SS1.p2.3.m3.4.4.2.2.2.2.2">𝐰</ci><ci id="S3.SS1.p2.3.m3.4.4.2.2.2.2.3.cmml" xref="S3.SS1.p2.3.m3.4.4.2.2.2.2.3">𝑟</ci></apply></interval></apply><apply id="S3.SS1.p2.3.m3.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2"><divide id="S3.SS1.p2.3.m3.2.2.3.cmml" xref="S3.SS1.p2.3.m3.2.2"></divide><apply id="S3.SS1.p2.3.m3.2.2.4.cmml" xref="S3.SS1.p2.3.m3.2.2.4"><ci id="S3.SS1.p2.3.m3.2.2.4.1.cmml" xref="S3.SS1.p2.3.m3.2.2.4.1">⋅</ci><apply id="S3.SS1.p2.3.m3.2.2.4.2.cmml" xref="S3.SS1.p2.3.m3.2.2.4.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.4.2.1.cmml" xref="S3.SS1.p2.3.m3.2.2.4.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.2.2.4.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2.4.2.2">𝐰</ci><ci id="S3.SS1.p2.3.m3.2.2.4.2.3.cmml" xref="S3.SS1.p2.3.m3.2.2.4.2.3">𝑖</ci></apply><apply id="S3.SS1.p2.3.m3.2.2.4.3.cmml" xref="S3.SS1.p2.3.m3.2.2.4.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.4.3.1.cmml" xref="S3.SS1.p2.3.m3.2.2.4.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.2.2.4.3.2.cmml" xref="S3.SS1.p2.3.m3.2.2.4.3.2">𝐰</ci><ci id="S3.SS1.p2.3.m3.2.2.4.3.3.cmml" xref="S3.SS1.p2.3.m3.2.2.4.3.3">𝑟</ci></apply></apply><apply id="S3.SS1.p2.3.m3.2.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2.2"><ci id="S3.SS1.p2.3.m3.2.2.2.3.cmml" xref="S3.SS1.p2.3.m3.2.2.2.3">⋅</ci><apply id="S3.SS1.p2.3.m3.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.3.m3.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.2">norm</csymbol><apply id="S3.SS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.2">𝐰</ci><ci id="S3.SS1.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS1.p2.3.m3.2.2.2.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2.2.2.1"><csymbol cd="latexml" id="S3.SS1.p2.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.3.m3.2.2.2.2.1.2">norm</csymbol><apply id="S3.SS1.p2.3.m3.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.2.2.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.2.2.2.2.1.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.2.2.1.1.2">𝐰</ci><ci id="S3.SS1.p2.3.m3.2.2.2.2.1.1.3.cmml" xref="S3.SS1.p2.3.m3.2.2.2.2.1.1.3">𝑟</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.4c">S_{c}(\mathbf{w}_{i},\mathbf{w}_{r})=\frac{\mathbf{w}_{i}\cdot\mathbf{w}_{r}}{||\mathbf{w}_{i}||\cdot||\mathbf{w}_{r}||}</annotation></semantics></math>.
We expect the cosine similarity of each local model and its reference model to be high, as a higher cosine similarity indicates the local model to be “closer” to the “golden truth” reference model, and thus is more
likely to be benign. On the contrary, lower cosine similarities indicate attacks have a higher possibility of occurrence on that client in the current FL training round, as the malicious clients may submit arbitrary or tampered local models through some attacks <cite class="ltx_cite ltx_citemacro_citep">(Bagdasaryan et al., <a href="#bib.bib3" title="" class="ltx_ref">2020b</a>; Wang et al., <a href="#bib.bib57" title="" class="ltx_ref">2020</a>; Chen et al., <a href="#bib.bib14" title="" class="ltx_ref">2017</a>; Fang et al., <a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite>, making the local model to diverge from the reference model.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">We select reference models based on the characteristics of the attacks that are widely considered in both literature and real-world systems, <span id="S3.SS1.p3.1.1" class="ltx_text ltx_font_italic">i</span>.<span id="S3.SS1.p3.1.2" class="ltx_text ltx_font_italic">e</span>., Byzantine attacks <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib14" title="" class="ltx_ref">2017</a>; Fang et al., <a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite> and backdoor attacks <cite class="ltx_cite ltx_citemacro_citep">(Bagdasaryan et al., <a href="#bib.bib3" title="" class="ltx_ref">2020b</a>; Wang et al., <a href="#bib.bib57" title="" class="ltx_ref">2020</a>)</cite>. For each local model in the current FL training round, we utilize two types of models as the reference models, including <span id="S3.SS1.p3.1.3" class="ltx_text ltx_font_italic">i</span>) the global model computed in the last FL training round that helps detect if the current local model diverges much from the global model and thus might potentially prevent the global model from converging, and <span id="S3.SS1.p3.1.4" class="ltx_text ltx_font_italic">ii</span>) the local model of the same client from the last FL training round to detect whether the local models submitted by the same client differ much, which can be an indicator for the client to be benign for the last round but turn “evil” for the current round. Note that in the cross-round detection stage, our algorithm does not remove local models that are detected as “potentially malicious”; instead, it marks such local models as “potentially malicious” and decides whether to remove them in the latter stage of the proposed approach.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p">We present the cross-round detection algorithm in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.1 Cross-Round Detection ‣ 3 Two-Stage Anomaly Detection ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Detailed steps are as follows.</p>
</div>
<div id="S3.SS1.p5" class="ltx_para ltx_noindent">
<p id="S3.SS1.p5.1" class="ltx_p"><span id="S3.SS1.p5.1.1" class="ltx_text ltx_font_bold">Step 1: Initialization. </span>The server loads the reference models, including the global model from the last FL round, as well as the cached local models that are deemed as “benign” from the previous FL round.
</p>
</div>
<div id="S3.SS1.p6" class="ltx_para ltx_noindent">
<p id="S3.SS1.p6.12" class="ltx_p"><span id="S3.SS1.p6.12.1" class="ltx_text ltx_font_bold">Step 2: Detect potential attacks. </span>For each FL round <math id="S3.SS1.p6.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p6.1.m1.1a"><mi id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><ci id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">\tau</annotation></semantics></math>, we suppose the global model of the last FL round to be <math id="S3.SS1.p6.2.m2.1" class="ltx_Math" alttext="\mathbf{w}_{g}^{\tau-1}" display="inline"><semantics id="S3.SS1.p6.2.m2.1a"><msubsup id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml"><mi id="S3.SS1.p6.2.m2.1.1.2.2" xref="S3.SS1.p6.2.m2.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.p6.2.m2.1.1.2.3" xref="S3.SS1.p6.2.m2.1.1.2.3.cmml">g</mi><mrow id="S3.SS1.p6.2.m2.1.1.3" xref="S3.SS1.p6.2.m2.1.1.3.cmml"><mi id="S3.SS1.p6.2.m2.1.1.3.2" xref="S3.SS1.p6.2.m2.1.1.3.2.cmml">τ</mi><mo id="S3.SS1.p6.2.m2.1.1.3.1" xref="S3.SS1.p6.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p6.2.m2.1.1.3.3" xref="S3.SS1.p6.2.m2.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><apply id="S3.SS1.p6.2.m2.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1">superscript</csymbol><apply id="S3.SS1.p6.2.m2.1.1.2.cmml" xref="S3.SS1.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.1.2.1.cmml" xref="S3.SS1.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p6.2.m2.1.1.2.2.cmml" xref="S3.SS1.p6.2.m2.1.1.2.2">𝐰</ci><ci id="S3.SS1.p6.2.m2.1.1.2.3.cmml" xref="S3.SS1.p6.2.m2.1.1.2.3">𝑔</ci></apply><apply id="S3.SS1.p6.2.m2.1.1.3.cmml" xref="S3.SS1.p6.2.m2.1.1.3"><minus id="S3.SS1.p6.2.m2.1.1.3.1.cmml" xref="S3.SS1.p6.2.m2.1.1.3.1"></minus><ci id="S3.SS1.p6.2.m2.1.1.3.2.cmml" xref="S3.SS1.p6.2.m2.1.1.3.2">𝜏</ci><cn type="integer" id="S3.SS1.p6.2.m2.1.1.3.3.cmml" xref="S3.SS1.p6.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">\mathbf{w}_{g}^{\tau-1}</annotation></semantics></math>;
for each local model <math id="S3.SS1.p6.3.m3.1" class="ltx_Math" alttext="\mathbf{w}_{i}^{\tau}" display="inline"><semantics id="S3.SS1.p6.3.m3.1a"><msubsup id="S3.SS1.p6.3.m3.1.1" xref="S3.SS1.p6.3.m3.1.1.cmml"><mi id="S3.SS1.p6.3.m3.1.1.2.2" xref="S3.SS1.p6.3.m3.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.p6.3.m3.1.1.2.3" xref="S3.SS1.p6.3.m3.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p6.3.m3.1.1.3" xref="S3.SS1.p6.3.m3.1.1.3.cmml">τ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.3.m3.1b"><apply id="S3.SS1.p6.3.m3.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.1.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1">superscript</csymbol><apply id="S3.SS1.p6.3.m3.1.1.2.cmml" xref="S3.SS1.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.1.1.2.1.cmml" xref="S3.SS1.p6.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p6.3.m3.1.1.2.2.cmml" xref="S3.SS1.p6.3.m3.1.1.2.2">𝐰</ci><ci id="S3.SS1.p6.3.m3.1.1.2.3.cmml" xref="S3.SS1.p6.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p6.3.m3.1.1.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.3.m3.1c">\mathbf{w}_{i}^{\tau}</annotation></semantics></math> submitted by client <math id="S3.SS1.p6.4.m4.1" class="ltx_Math" alttext="\mathcal{C}_{i}" display="inline"><semantics id="S3.SS1.p6.4.m4.1a"><msub id="S3.SS1.p6.4.m4.1.1" xref="S3.SS1.p6.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.4.m4.1.1.2" xref="S3.SS1.p6.4.m4.1.1.2.cmml">𝒞</mi><mi id="S3.SS1.p6.4.m4.1.1.3" xref="S3.SS1.p6.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.4.m4.1b"><apply id="S3.SS1.p6.4.m4.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.4.m4.1.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p6.4.m4.1.1.2.cmml" xref="S3.SS1.p6.4.m4.1.1.2">𝒞</ci><ci id="S3.SS1.p6.4.m4.1.1.3.cmml" xref="S3.SS1.p6.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.4.m4.1c">\mathcal{C}_{i}</annotation></semantics></math> in the current round <math id="S3.SS1.p6.5.m5.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p6.5.m5.1a"><mi id="S3.SS1.p6.5.m5.1.1" xref="S3.SS1.p6.5.m5.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.5.m5.1b"><ci id="S3.SS1.p6.5.m5.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.5.m5.1c">\tau</annotation></semantics></math>, we suppose the cached local model from the same client <math id="S3.SS1.p6.6.m6.1" class="ltx_Math" alttext="\mathcal{C}_{i}" display="inline"><semantics id="S3.SS1.p6.6.m6.1a"><msub id="S3.SS1.p6.6.m6.1.1" xref="S3.SS1.p6.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.6.m6.1.1.2" xref="S3.SS1.p6.6.m6.1.1.2.cmml">𝒞</mi><mi id="S3.SS1.p6.6.m6.1.1.3" xref="S3.SS1.p6.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.6.m6.1b"><apply id="S3.SS1.p6.6.m6.1.1.cmml" xref="S3.SS1.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.6.m6.1.1.1.cmml" xref="S3.SS1.p6.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p6.6.m6.1.1.2.cmml" xref="S3.SS1.p6.6.m6.1.1.2">𝒞</ci><ci id="S3.SS1.p6.6.m6.1.1.3.cmml" xref="S3.SS1.p6.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.6.m6.1c">\mathcal{C}_{i}</annotation></semantics></math> in the last round to be <math id="S3.SS1.p6.7.m7.1" class="ltx_Math" alttext="\mathbf{w}_{i}^{\tau-1}" display="inline"><semantics id="S3.SS1.p6.7.m7.1a"><msubsup id="S3.SS1.p6.7.m7.1.1" xref="S3.SS1.p6.7.m7.1.1.cmml"><mi id="S3.SS1.p6.7.m7.1.1.2.2" xref="S3.SS1.p6.7.m7.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.p6.7.m7.1.1.2.3" xref="S3.SS1.p6.7.m7.1.1.2.3.cmml">i</mi><mrow id="S3.SS1.p6.7.m7.1.1.3" xref="S3.SS1.p6.7.m7.1.1.3.cmml"><mi id="S3.SS1.p6.7.m7.1.1.3.2" xref="S3.SS1.p6.7.m7.1.1.3.2.cmml">τ</mi><mo id="S3.SS1.p6.7.m7.1.1.3.1" xref="S3.SS1.p6.7.m7.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p6.7.m7.1.1.3.3" xref="S3.SS1.p6.7.m7.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.7.m7.1b"><apply id="S3.SS1.p6.7.m7.1.1.cmml" xref="S3.SS1.p6.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.7.m7.1.1.1.cmml" xref="S3.SS1.p6.7.m7.1.1">superscript</csymbol><apply id="S3.SS1.p6.7.m7.1.1.2.cmml" xref="S3.SS1.p6.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.7.m7.1.1.2.1.cmml" xref="S3.SS1.p6.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p6.7.m7.1.1.2.2.cmml" xref="S3.SS1.p6.7.m7.1.1.2.2">𝐰</ci><ci id="S3.SS1.p6.7.m7.1.1.2.3.cmml" xref="S3.SS1.p6.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p6.7.m7.1.1.3.cmml" xref="S3.SS1.p6.7.m7.1.1.3"><minus id="S3.SS1.p6.7.m7.1.1.3.1.cmml" xref="S3.SS1.p6.7.m7.1.1.3.1"></minus><ci id="S3.SS1.p6.7.m7.1.1.3.2.cmml" xref="S3.SS1.p6.7.m7.1.1.3.2">𝜏</ci><cn type="integer" id="S3.SS1.p6.7.m7.1.1.3.3.cmml" xref="S3.SS1.p6.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.7.m7.1c">\mathbf{w}_{i}^{\tau-1}</annotation></semantics></math>. The algorithm computes similarities <math id="S3.SS1.p6.8.m8.2" class="ltx_Math" alttext="S_{c}(\mathbf{w}_{i}^{\tau},\mathbf{w}_{g}^{\tau-1})" display="inline"><semantics id="S3.SS1.p6.8.m8.2a"><mrow id="S3.SS1.p6.8.m8.2.2" xref="S3.SS1.p6.8.m8.2.2.cmml"><msub id="S3.SS1.p6.8.m8.2.2.4" xref="S3.SS1.p6.8.m8.2.2.4.cmml"><mi id="S3.SS1.p6.8.m8.2.2.4.2" xref="S3.SS1.p6.8.m8.2.2.4.2.cmml">S</mi><mi id="S3.SS1.p6.8.m8.2.2.4.3" xref="S3.SS1.p6.8.m8.2.2.4.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p6.8.m8.2.2.3" xref="S3.SS1.p6.8.m8.2.2.3.cmml">​</mo><mrow id="S3.SS1.p6.8.m8.2.2.2.2" xref="S3.SS1.p6.8.m8.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p6.8.m8.2.2.2.2.3" xref="S3.SS1.p6.8.m8.2.2.2.3.cmml">(</mo><msubsup id="S3.SS1.p6.8.m8.1.1.1.1.1" xref="S3.SS1.p6.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS1.p6.8.m8.1.1.1.1.1.2.2" xref="S3.SS1.p6.8.m8.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.p6.8.m8.1.1.1.1.1.2.3" xref="S3.SS1.p6.8.m8.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p6.8.m8.1.1.1.1.1.3" xref="S3.SS1.p6.8.m8.1.1.1.1.1.3.cmml">τ</mi></msubsup><mo id="S3.SS1.p6.8.m8.2.2.2.2.4" xref="S3.SS1.p6.8.m8.2.2.2.3.cmml">,</mo><msubsup id="S3.SS1.p6.8.m8.2.2.2.2.2" xref="S3.SS1.p6.8.m8.2.2.2.2.2.cmml"><mi id="S3.SS1.p6.8.m8.2.2.2.2.2.2.2" xref="S3.SS1.p6.8.m8.2.2.2.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS1.p6.8.m8.2.2.2.2.2.2.3" xref="S3.SS1.p6.8.m8.2.2.2.2.2.2.3.cmml">g</mi><mrow id="S3.SS1.p6.8.m8.2.2.2.2.2.3" xref="S3.SS1.p6.8.m8.2.2.2.2.2.3.cmml"><mi id="S3.SS1.p6.8.m8.2.2.2.2.2.3.2" xref="S3.SS1.p6.8.m8.2.2.2.2.2.3.2.cmml">τ</mi><mo id="S3.SS1.p6.8.m8.2.2.2.2.2.3.1" xref="S3.SS1.p6.8.m8.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.SS1.p6.8.m8.2.2.2.2.2.3.3" xref="S3.SS1.p6.8.m8.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="S3.SS1.p6.8.m8.2.2.2.2.5" xref="S3.SS1.p6.8.m8.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.8.m8.2b"><apply id="S3.SS1.p6.8.m8.2.2.cmml" xref="S3.SS1.p6.8.m8.2.2"><times id="S3.SS1.p6.8.m8.2.2.3.cmml" xref="S3.SS1.p6.8.m8.2.2.3"></times><apply id="S3.SS1.p6.8.m8.2.2.4.cmml" xref="S3.SS1.p6.8.m8.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p6.8.m8.2.2.4.1.cmml" xref="S3.SS1.p6.8.m8.2.2.4">subscript</csymbol><ci id="S3.SS1.p6.8.m8.2.2.4.2.cmml" xref="S3.SS1.p6.8.m8.2.2.4.2">𝑆</ci><ci id="S3.SS1.p6.8.m8.2.2.4.3.cmml" xref="S3.SS1.p6.8.m8.2.2.4.3">𝑐</ci></apply><interval closure="open" id="S3.SS1.p6.8.m8.2.2.2.3.cmml" xref="S3.SS1.p6.8.m8.2.2.2.2"><apply id="S3.SS1.p6.8.m8.1.1.1.1.1.cmml" xref="S3.SS1.p6.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS1.p6.8.m8.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p6.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS1.p6.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.8.m8.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p6.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p6.8.m8.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p6.8.m8.1.1.1.1.1.2.2">𝐰</ci><ci id="S3.SS1.p6.8.m8.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p6.8.m8.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p6.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS1.p6.8.m8.1.1.1.1.1.3">𝜏</ci></apply><apply id="S3.SS1.p6.8.m8.2.2.2.2.2.cmml" xref="S3.SS1.p6.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.8.m8.2.2.2.2.2.1.cmml" xref="S3.SS1.p6.8.m8.2.2.2.2.2">superscript</csymbol><apply id="S3.SS1.p6.8.m8.2.2.2.2.2.2.cmml" xref="S3.SS1.p6.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.8.m8.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p6.8.m8.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p6.8.m8.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p6.8.m8.2.2.2.2.2.2.2">𝐰</ci><ci id="S3.SS1.p6.8.m8.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p6.8.m8.2.2.2.2.2.2.3">𝑔</ci></apply><apply id="S3.SS1.p6.8.m8.2.2.2.2.2.3.cmml" xref="S3.SS1.p6.8.m8.2.2.2.2.2.3"><minus id="S3.SS1.p6.8.m8.2.2.2.2.2.3.1.cmml" xref="S3.SS1.p6.8.m8.2.2.2.2.2.3.1"></minus><ci id="S3.SS1.p6.8.m8.2.2.2.2.2.3.2.cmml" xref="S3.SS1.p6.8.m8.2.2.2.2.2.3.2">𝜏</ci><cn type="integer" id="S3.SS1.p6.8.m8.2.2.2.2.2.3.3.cmml" xref="S3.SS1.p6.8.m8.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.8.m8.2c">S_{c}(\mathbf{w}_{i}^{\tau},\mathbf{w}_{g}^{\tau-1})</annotation></semantics></math> and <math id="S3.SS1.p6.9.m9.2" class="ltx_Math" alttext="S_{c}(\mathbf{w}_{i}^{\tau},\mathbf{w}_{i}^{\tau-1})" display="inline"><semantics id="S3.SS1.p6.9.m9.2a"><mrow id="S3.SS1.p6.9.m9.2.2" xref="S3.SS1.p6.9.m9.2.2.cmml"><msub id="S3.SS1.p6.9.m9.2.2.4" xref="S3.SS1.p6.9.m9.2.2.4.cmml"><mi id="S3.SS1.p6.9.m9.2.2.4.2" xref="S3.SS1.p6.9.m9.2.2.4.2.cmml">S</mi><mi id="S3.SS1.p6.9.m9.2.2.4.3" xref="S3.SS1.p6.9.m9.2.2.4.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p6.9.m9.2.2.3" xref="S3.SS1.p6.9.m9.2.2.3.cmml">​</mo><mrow id="S3.SS1.p6.9.m9.2.2.2.2" xref="S3.SS1.p6.9.m9.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p6.9.m9.2.2.2.2.3" xref="S3.SS1.p6.9.m9.2.2.2.3.cmml">(</mo><msubsup id="S3.SS1.p6.9.m9.1.1.1.1.1" xref="S3.SS1.p6.9.m9.1.1.1.1.1.cmml"><mi id="S3.SS1.p6.9.m9.1.1.1.1.1.2.2" xref="S3.SS1.p6.9.m9.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.p6.9.m9.1.1.1.1.1.2.3" xref="S3.SS1.p6.9.m9.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p6.9.m9.1.1.1.1.1.3" xref="S3.SS1.p6.9.m9.1.1.1.1.1.3.cmml">τ</mi></msubsup><mo id="S3.SS1.p6.9.m9.2.2.2.2.4" xref="S3.SS1.p6.9.m9.2.2.2.3.cmml">,</mo><msubsup id="S3.SS1.p6.9.m9.2.2.2.2.2" xref="S3.SS1.p6.9.m9.2.2.2.2.2.cmml"><mi id="S3.SS1.p6.9.m9.2.2.2.2.2.2.2" xref="S3.SS1.p6.9.m9.2.2.2.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS1.p6.9.m9.2.2.2.2.2.2.3" xref="S3.SS1.p6.9.m9.2.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.SS1.p6.9.m9.2.2.2.2.2.3" xref="S3.SS1.p6.9.m9.2.2.2.2.2.3.cmml"><mi id="S3.SS1.p6.9.m9.2.2.2.2.2.3.2" xref="S3.SS1.p6.9.m9.2.2.2.2.2.3.2.cmml">τ</mi><mo id="S3.SS1.p6.9.m9.2.2.2.2.2.3.1" xref="S3.SS1.p6.9.m9.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.SS1.p6.9.m9.2.2.2.2.2.3.3" xref="S3.SS1.p6.9.m9.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="S3.SS1.p6.9.m9.2.2.2.2.5" xref="S3.SS1.p6.9.m9.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.9.m9.2b"><apply id="S3.SS1.p6.9.m9.2.2.cmml" xref="S3.SS1.p6.9.m9.2.2"><times id="S3.SS1.p6.9.m9.2.2.3.cmml" xref="S3.SS1.p6.9.m9.2.2.3"></times><apply id="S3.SS1.p6.9.m9.2.2.4.cmml" xref="S3.SS1.p6.9.m9.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p6.9.m9.2.2.4.1.cmml" xref="S3.SS1.p6.9.m9.2.2.4">subscript</csymbol><ci id="S3.SS1.p6.9.m9.2.2.4.2.cmml" xref="S3.SS1.p6.9.m9.2.2.4.2">𝑆</ci><ci id="S3.SS1.p6.9.m9.2.2.4.3.cmml" xref="S3.SS1.p6.9.m9.2.2.4.3">𝑐</ci></apply><interval closure="open" id="S3.SS1.p6.9.m9.2.2.2.3.cmml" xref="S3.SS1.p6.9.m9.2.2.2.2"><apply id="S3.SS1.p6.9.m9.1.1.1.1.1.cmml" xref="S3.SS1.p6.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS1.p6.9.m9.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p6.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS1.p6.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.9.m9.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p6.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p6.9.m9.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p6.9.m9.1.1.1.1.1.2.2">𝐰</ci><ci id="S3.SS1.p6.9.m9.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p6.9.m9.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p6.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS1.p6.9.m9.1.1.1.1.1.3">𝜏</ci></apply><apply id="S3.SS1.p6.9.m9.2.2.2.2.2.cmml" xref="S3.SS1.p6.9.m9.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.9.m9.2.2.2.2.2.1.cmml" xref="S3.SS1.p6.9.m9.2.2.2.2.2">superscript</csymbol><apply id="S3.SS1.p6.9.m9.2.2.2.2.2.2.cmml" xref="S3.SS1.p6.9.m9.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.9.m9.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p6.9.m9.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p6.9.m9.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p6.9.m9.2.2.2.2.2.2.2">𝐰</ci><ci id="S3.SS1.p6.9.m9.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p6.9.m9.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS1.p6.9.m9.2.2.2.2.2.3.cmml" xref="S3.SS1.p6.9.m9.2.2.2.2.2.3"><minus id="S3.SS1.p6.9.m9.2.2.2.2.2.3.1.cmml" xref="S3.SS1.p6.9.m9.2.2.2.2.2.3.1"></minus><ci id="S3.SS1.p6.9.m9.2.2.2.2.2.3.2.cmml" xref="S3.SS1.p6.9.m9.2.2.2.2.2.3.2">𝜏</ci><cn type="integer" id="S3.SS1.p6.9.m9.2.2.2.2.2.3.3.cmml" xref="S3.SS1.p6.9.m9.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.9.m9.2c">S_{c}(\mathbf{w}_{i}^{\tau},\mathbf{w}_{i}^{\tau-1})</annotation></semantics></math>, and utilizes the scores, as well as a threshold, denoted as <math id="S3.SS1.p6.10.m10.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS1.p6.10.m10.1a"><mi id="S3.SS1.p6.10.m10.1.1" xref="S3.SS1.p6.10.m10.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.10.m10.1b"><ci id="S3.SS1.p6.10.m10.1.1.cmml" xref="S3.SS1.p6.10.m10.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.10.m10.1c">\gamma</annotation></semantics></math> (<math id="S3.SS1.p6.11.m11.1" class="ltx_Math" alttext="-1&lt;\gamma&lt;1" display="inline"><semantics id="S3.SS1.p6.11.m11.1a"><mrow id="S3.SS1.p6.11.m11.1.1" xref="S3.SS1.p6.11.m11.1.1.cmml"><mrow id="S3.SS1.p6.11.m11.1.1.2" xref="S3.SS1.p6.11.m11.1.1.2.cmml"><mo id="S3.SS1.p6.11.m11.1.1.2a" xref="S3.SS1.p6.11.m11.1.1.2.cmml">−</mo><mn id="S3.SS1.p6.11.m11.1.1.2.2" xref="S3.SS1.p6.11.m11.1.1.2.2.cmml">1</mn></mrow><mo id="S3.SS1.p6.11.m11.1.1.3" xref="S3.SS1.p6.11.m11.1.1.3.cmml">&lt;</mo><mi id="S3.SS1.p6.11.m11.1.1.4" xref="S3.SS1.p6.11.m11.1.1.4.cmml">γ</mi><mo id="S3.SS1.p6.11.m11.1.1.5" xref="S3.SS1.p6.11.m11.1.1.5.cmml">&lt;</mo><mn id="S3.SS1.p6.11.m11.1.1.6" xref="S3.SS1.p6.11.m11.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.11.m11.1b"><apply id="S3.SS1.p6.11.m11.1.1.cmml" xref="S3.SS1.p6.11.m11.1.1"><and id="S3.SS1.p6.11.m11.1.1a.cmml" xref="S3.SS1.p6.11.m11.1.1"></and><apply id="S3.SS1.p6.11.m11.1.1b.cmml" xref="S3.SS1.p6.11.m11.1.1"><lt id="S3.SS1.p6.11.m11.1.1.3.cmml" xref="S3.SS1.p6.11.m11.1.1.3"></lt><apply id="S3.SS1.p6.11.m11.1.1.2.cmml" xref="S3.SS1.p6.11.m11.1.1.2"><minus id="S3.SS1.p6.11.m11.1.1.2.1.cmml" xref="S3.SS1.p6.11.m11.1.1.2"></minus><cn type="integer" id="S3.SS1.p6.11.m11.1.1.2.2.cmml" xref="S3.SS1.p6.11.m11.1.1.2.2">1</cn></apply><ci id="S3.SS1.p6.11.m11.1.1.4.cmml" xref="S3.SS1.p6.11.m11.1.1.4">𝛾</ci></apply><apply id="S3.SS1.p6.11.m11.1.1c.cmml" xref="S3.SS1.p6.11.m11.1.1"><lt id="S3.SS1.p6.11.m11.1.1.5.cmml" xref="S3.SS1.p6.11.m11.1.1.5"></lt><share href="#S3.SS1.p6.11.m11.1.1.4.cmml" id="S3.SS1.p6.11.m11.1.1d.cmml" xref="S3.SS1.p6.11.m11.1.1"></share><cn type="integer" id="S3.SS1.p6.11.m11.1.1.6.cmml" xref="S3.SS1.p6.11.m11.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.11.m11.1c">-1&lt;\gamma&lt;1</annotation></semantics></math>), to detect whether potential attacks have happened in the current FL training round. Any similarity score that is lower than <math id="S3.SS1.p6.12.m12.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS1.p6.12.m12.1a"><mi id="S3.SS1.p6.12.m12.1.1" xref="S3.SS1.p6.12.m12.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.12.m12.1b"><ci id="S3.SS1.p6.12.m12.1.1.cmml" xref="S3.SS1.p6.12.m12.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.12.m12.1c">\gamma</annotation></semantics></math> indicates that a potential attack has happened in the current round.</p>
</div>
<div id="S3.SS1.p7" class="ltx_para ltx_noindent">
<p id="S3.SS1.p7.1" class="ltx_p"><span id="S3.SS1.p7.1.1" class="ltx_text ltx_font_bold">Step 3: Return an indicator of potential attacks. </span>
If any client models are detected as “potentially malicious”, the algorithm outputs an indicator to show that attacks might have happened in the current FL round, and the algorithm then enters the next stage to further inspect and remove malicious client models.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Cross-Client Anomaly Detection </h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">The cross-client detection computes a score for each local model to evaluate its “<span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_italic">degree of evilness</span>”, and utilizes the Three-Sigma Rule to filter out those local models with higher degree of evilness, <span id="S3.SS2.p1.1.2" class="ltx_text ltx_font_italic">i</span>.<span id="S3.SS2.p1.1.3" class="ltx_text ltx_font_italic">e</span>., the malicious models.
The Three-Sigma Rule is pivotal for two reasons: <span id="S3.SS2.p1.1.4" class="ltx_text ltx_font_italic">i</span>) in case the client datasets are i.i.d., parameters of the local models follow a normal distribution <cite class="ltx_cite ltx_citemacro_citep">(Baruch et al., <a href="#bib.bib4" title="" class="ltx_ref">2019</a>; Chen et al., <a href="#bib.bib14" title="" class="ltx_ref">2017</a>; Yin et al., <a href="#bib.bib62" title="" class="ltx_ref">2018</a>)</cite>; and <span id="S3.SS2.p1.1.5" class="ltx_text ltx_font_italic">ii</span>) even when client datasets are non-i.i.d., according to the Central Limit Theorem, the local models tend toward a normal distribution.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.7" class="ltx_p">Let <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathcal{L}</annotation></semantics></math> be the “degree of evilness” scores for client models in the current FL round, where higher scores indicate higher chances to be evil. Suppose <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\mathcal{L}</annotation></semantics></math> follows normal distribution <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{N}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">𝒩</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝒩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\mathcal{N}</annotation></semantics></math>(<math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">\mu</annotation></semantics></math>, <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\sigma</annotation></semantics></math>), where <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><mi id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\mu</annotation></semantics></math> is mean and <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><mi id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">\sigma</annotation></semantics></math> is standard deviation. We have the following definition.</p>
</div>
<div id="S3.Thmtheorem2" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="S3.Thmtheorem2.1.1.1" class="ltx_text ltx_font_bold">Definition 3.2</span></span><span id="S3.Thmtheorem2.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="S3.Thmtheorem2.p1" class="ltx_para">
<p id="S3.Thmtheorem2.p1.2" class="ltx_p">A local model is identified as malicious if its “degree of evilness” score exceeds <math id="S3.Thmtheorem2.p1.1.m1.1" class="ltx_Math" alttext="\mu+\lambda\sigma" display="inline"><semantics id="S3.Thmtheorem2.p1.1.m1.1a"><mrow id="S3.Thmtheorem2.p1.1.m1.1.1" xref="S3.Thmtheorem2.p1.1.m1.1.1.cmml"><mi id="S3.Thmtheorem2.p1.1.m1.1.1.2" xref="S3.Thmtheorem2.p1.1.m1.1.1.2.cmml">μ</mi><mo id="S3.Thmtheorem2.p1.1.m1.1.1.1" xref="S3.Thmtheorem2.p1.1.m1.1.1.1.cmml">+</mo><mrow id="S3.Thmtheorem2.p1.1.m1.1.1.3" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.cmml"><mi id="S3.Thmtheorem2.p1.1.m1.1.1.3.2" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.Thmtheorem2.p1.1.m1.1.1.3.1" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.Thmtheorem2.p1.1.m1.1.1.3.3" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.3.cmml">σ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.1.m1.1b"><apply id="S3.Thmtheorem2.p1.1.m1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1"><plus id="S3.Thmtheorem2.p1.1.m1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.1"></plus><ci id="S3.Thmtheorem2.p1.1.m1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.2">𝜇</ci><apply id="S3.Thmtheorem2.p1.1.m1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.3"><times id="S3.Thmtheorem2.p1.1.m1.1.1.3.1.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.1"></times><ci id="S3.Thmtheorem2.p1.1.m1.1.1.3.2.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.2">𝜆</ci><ci id="S3.Thmtheorem2.p1.1.m1.1.1.3.3.cmml" xref="S3.Thmtheorem2.p1.1.m1.1.1.3.3">𝜎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.1.m1.1c">\mu+\lambda\sigma</annotation></semantics></math> (<math id="S3.Thmtheorem2.p1.2.m2.1" class="ltx_Math" alttext="\lambda&gt;0" display="inline"><semantics id="S3.Thmtheorem2.p1.2.m2.1a"><mrow id="S3.Thmtheorem2.p1.2.m2.1.1" xref="S3.Thmtheorem2.p1.2.m2.1.1.cmml"><mi id="S3.Thmtheorem2.p1.2.m2.1.1.2" xref="S3.Thmtheorem2.p1.2.m2.1.1.2.cmml">λ</mi><mo id="S3.Thmtheorem2.p1.2.m2.1.1.1" xref="S3.Thmtheorem2.p1.2.m2.1.1.1.cmml">&gt;</mo><mn id="S3.Thmtheorem2.p1.2.m2.1.1.3" xref="S3.Thmtheorem2.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.2.m2.1b"><apply id="S3.Thmtheorem2.p1.2.m2.1.1.cmml" xref="S3.Thmtheorem2.p1.2.m2.1.1"><gt id="S3.Thmtheorem2.p1.2.m2.1.1.1.cmml" xref="S3.Thmtheorem2.p1.2.m2.1.1.1"></gt><ci id="S3.Thmtheorem2.p1.2.m2.1.1.2.cmml" xref="S3.Thmtheorem2.p1.2.m2.1.1.2">𝜆</ci><cn type="integer" id="S3.Thmtheorem2.p1.2.m2.1.1.3.cmml" xref="S3.Thmtheorem2.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.2.m2.1c">\lambda&gt;0</annotation></semantics></math>).</p>
</div>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg2.29.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Cross-Client Detection Algorithm.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.5" class="ltx_p ltx_figure_panel"><span id="alg2.5.5" class="ltx_text ltx_font_bold" style="font-size:90%;">Inputs:<span id="alg2.5.5.5" class="ltx_text ltx_font_medium">
<math id="alg2.1.1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg2.1.1.1.m1.1a"><mi id="alg2.1.1.1.m1.1.1" xref="alg2.1.1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg2.1.1.1.m1.1b"><ci id="alg2.1.1.1.m1.1.1.cmml" xref="alg2.1.1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.1.1.m1.1c">\tau</annotation></semantics></math>: training round id, <span id="alg2.5.5.5.1" class="ltx_text ltx_font_italic">e</span>.<span id="alg2.5.5.5.2" class="ltx_text ltx_font_italic">g</span>., <math id="alg2.2.2.2.m2.4" class="ltx_Math" alttext="\tau=0,1,2,\ldots" display="inline"><semantics id="alg2.2.2.2.m2.4a"><mrow id="alg2.2.2.2.m2.4.5" xref="alg2.2.2.2.m2.4.5.cmml"><mi id="alg2.2.2.2.m2.4.5.2" xref="alg2.2.2.2.m2.4.5.2.cmml">τ</mi><mo id="alg2.2.2.2.m2.4.5.1" xref="alg2.2.2.2.m2.4.5.1.cmml">=</mo><mrow id="alg2.2.2.2.m2.4.5.3.2" xref="alg2.2.2.2.m2.4.5.3.1.cmml"><mn id="alg2.2.2.2.m2.1.1" xref="alg2.2.2.2.m2.1.1.cmml">0</mn><mo id="alg2.2.2.2.m2.4.5.3.2.1" xref="alg2.2.2.2.m2.4.5.3.1.cmml">,</mo><mn id="alg2.2.2.2.m2.2.2" xref="alg2.2.2.2.m2.2.2.cmml">1</mn><mo id="alg2.2.2.2.m2.4.5.3.2.2" xref="alg2.2.2.2.m2.4.5.3.1.cmml">,</mo><mn id="alg2.2.2.2.m2.3.3" xref="alg2.2.2.2.m2.3.3.cmml">2</mn><mo id="alg2.2.2.2.m2.4.5.3.2.3" xref="alg2.2.2.2.m2.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.2.2.2.m2.4.4" xref="alg2.2.2.2.m2.4.4.cmml">…</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.2.2.2.m2.4b"><apply id="alg2.2.2.2.m2.4.5.cmml" xref="alg2.2.2.2.m2.4.5"><eq id="alg2.2.2.2.m2.4.5.1.cmml" xref="alg2.2.2.2.m2.4.5.1"></eq><ci id="alg2.2.2.2.m2.4.5.2.cmml" xref="alg2.2.2.2.m2.4.5.2">𝜏</ci><list id="alg2.2.2.2.m2.4.5.3.1.cmml" xref="alg2.2.2.2.m2.4.5.3.2"><cn type="integer" id="alg2.2.2.2.m2.1.1.cmml" xref="alg2.2.2.2.m2.1.1">0</cn><cn type="integer" id="alg2.2.2.2.m2.2.2.cmml" xref="alg2.2.2.2.m2.2.2">1</cn><cn type="integer" id="alg2.2.2.2.m2.3.3.cmml" xref="alg2.2.2.2.m2.3.3">2</cn><ci id="alg2.2.2.2.m2.4.4.cmml" xref="alg2.2.2.2.m2.4.4">…</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.2.2.m2.4c">\tau=0,1,2,\ldots</annotation></semantics></math>;
<math id="alg2.3.3.3.m3.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="alg2.3.3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.3.3.3.m3.1.1" xref="alg2.3.3.3.m3.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="alg2.3.3.3.m3.1b"><ci id="alg2.3.3.3.m3.1.1.cmml" xref="alg2.3.3.3.m3.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.3.3.m3.1c">\mathcal{W}</annotation></semantics></math>: client submissions of a training round; <math id="alg2.4.4.4.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg2.4.4.4.m4.1a"><mi id="alg2.4.4.4.m4.1.1" xref="alg2.4.4.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg2.4.4.4.m4.1b"><ci id="alg2.4.4.4.m4.1.1.cmml" xref="alg2.4.4.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.4.4.m4.1c">m</annotation></semantics></math>: <math id="alg2.5.5.5.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg2.5.5.5.m5.1a"><mi id="alg2.5.5.5.m5.1.1" xref="alg2.5.5.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg2.5.5.5.m5.1b"><ci id="alg2.5.5.5.m5.1.1.cmml" xref="alg2.5.5.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.5.5.m5.1c">m</annotation></semantics></math>-Krum parameter.</span></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.6" class="ltx_p ltx_figure_panel"><span id="alg2.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">function <math id="alg2.6.1.m1.2" class="ltx_Math" alttext="\boldsymbol{\mathit{Cross}\_\mathit{Client}\_\mathit{Detection}(\mathcal{W},\tau)}" display="inline"><semantics id="alg2.6.1.m1.2a"><mrow id="alg2.6.1.m1.2.3" xref="alg2.6.1.m1.2.3.cmml"><mi id="alg2.6.1.m1.2.3.2" xref="alg2.6.1.m1.2.3.2.cmml">𝐶𝑟𝑜𝑠𝑠</mi><mo lspace="0em" rspace="0em" id="alg2.6.1.m1.2.3.1" xref="alg2.6.1.m1.2.3.1.cmml">​</mo><mi class="ltx_mathvariant_bold" mathvariant="bold" id="alg2.6.1.m1.2.3.3" xref="alg2.6.1.m1.2.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.6.1.m1.2.3.1a" xref="alg2.6.1.m1.2.3.1.cmml">​</mo><mi id="alg2.6.1.m1.2.3.4" xref="alg2.6.1.m1.2.3.4.cmml">𝐶𝑙𝑖𝑒𝑛𝑡</mi><mo lspace="0em" rspace="0em" id="alg2.6.1.m1.2.3.1b" xref="alg2.6.1.m1.2.3.1.cmml">​</mo><mi class="ltx_mathvariant_bold" mathvariant="bold" id="alg2.6.1.m1.2.3.5" xref="alg2.6.1.m1.2.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.6.1.m1.2.3.1c" xref="alg2.6.1.m1.2.3.1.cmml">​</mo><mi id="alg2.6.1.m1.2.3.6" xref="alg2.6.1.m1.2.3.6.cmml">𝐷𝑒𝑡𝑒𝑐𝑡𝑖𝑜𝑛</mi><mo lspace="0em" rspace="0em" id="alg2.6.1.m1.2.3.1d" xref="alg2.6.1.m1.2.3.1.cmml">​</mo><mrow id="alg2.6.1.m1.2.3.7.2" xref="alg2.6.1.m1.2.3.7.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg2.6.1.m1.2.3.7.2.1" xref="alg2.6.1.m1.2.3.7.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.6.1.m1.1.1" xref="alg2.6.1.m1.1.1.cmml">𝒲</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="alg2.6.1.m1.2.3.7.2.2" xref="alg2.6.1.m1.2.3.7.1.cmml">,</mo><mi id="alg2.6.1.m1.2.2" xref="alg2.6.1.m1.2.2.cmml">τ</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg2.6.1.m1.2.3.7.2.3" xref="alg2.6.1.m1.2.3.7.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.6.1.m1.2b"><apply id="alg2.6.1.m1.2.3.cmml" xref="alg2.6.1.m1.2.3"><times id="alg2.6.1.m1.2.3.1.cmml" xref="alg2.6.1.m1.2.3.1"></times><ci id="alg2.6.1.m1.2.3.2.cmml" xref="alg2.6.1.m1.2.3.2">𝐶𝑟𝑜𝑠𝑠</ci><ci id="alg2.6.1.m1.2.3.3.cmml" xref="alg2.6.1.m1.2.3.3">bold-_</ci><ci id="alg2.6.1.m1.2.3.4.cmml" xref="alg2.6.1.m1.2.3.4">𝐶𝑙𝑖𝑒𝑛𝑡</ci><ci id="alg2.6.1.m1.2.3.5.cmml" xref="alg2.6.1.m1.2.3.5">bold-_</ci><ci id="alg2.6.1.m1.2.3.6.cmml" xref="alg2.6.1.m1.2.3.6">𝐷𝑒𝑡𝑒𝑐𝑡𝑖𝑜𝑛</ci><interval closure="open" id="alg2.6.1.m1.2.3.7.1.cmml" xref="alg2.6.1.m1.2.3.7.2"><ci id="alg2.6.1.m1.1.1.cmml" xref="alg2.6.1.m1.1.1">𝒲</ci><ci id="alg2.6.1.m1.2.2.cmml" xref="alg2.6.1.m1.2.2">𝜏</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.1.m1.2c">\boldsymbol{\mathit{Cross}\_\mathit{Client}\_\mathit{Detection}(\mathcal{W},\tau)}</annotation></semantics></math><span id="alg2.6.1.1" class="ltx_text ltx_font_medium">
</span>begin</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="alg2.30" class="ltx_block ltx_figure_panel">
<div id="alg2.7" class="ltx_listingline">
<span id="alg2.7.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg2.7.3" class="ltx_text" style="font-size:90%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="alg2.7.4.1.1" class="ltx_text" style="font-size:90%;">9</span></span><span id="alg2.7.5" class="ltx_text" style="font-size:90%;">
</span><span id="alg2.7.6" class="ltx_text ltx_font_bold" style="font-size:90%;">if</span><span id="alg2.7.7" class="ltx_text" style="font-size:90%;"> </span><em id="alg2.7.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="alg2.7.1.m1.1" class="ltx_Math" alttext="\tau=0" display="inline"><semantics id="alg2.7.1.m1.1a"><mrow id="alg2.7.1.m1.1.1" xref="alg2.7.1.m1.1.1.cmml"><mi id="alg2.7.1.m1.1.1.2" xref="alg2.7.1.m1.1.1.2.cmml">τ</mi><mo id="alg2.7.1.m1.1.1.1" xref="alg2.7.1.m1.1.1.1.cmml">=</mo><mn id="alg2.7.1.m1.1.1.3" xref="alg2.7.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.7.1.m1.1b"><apply id="alg2.7.1.m1.1.1.cmml" xref="alg2.7.1.m1.1.1"><eq id="alg2.7.1.m1.1.1.1.cmml" xref="alg2.7.1.m1.1.1.1"></eq><ci id="alg2.7.1.m1.1.1.2.cmml" xref="alg2.7.1.m1.1.1.2">𝜏</ci><cn type="integer" id="alg2.7.1.m1.1.1.3.cmml" xref="alg2.7.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.1.m1.1c">\tau=0</annotation></semantics></math></em><span id="alg2.7.8" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.7.9" class="ltx_text ltx_font_bold" style="font-size:90%;">then</span>
</div>
<div id="alg2.10" class="ltx_listingline">
<span id="alg2.10.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg2.10.2" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg2.10.3" class="ltx_text" style="font-size:90%;">   </span><span id="alg2.10.4" class="ltx_text" style="font-size:90%;">
</span><math id="alg2.8.m1.1" class="ltx_Math" alttext="m\leftarrow|\mathcal{W}|/2" display="inline"><semantics id="alg2.8.m1.1a"><mrow id="alg2.8.m1.1.2" xref="alg2.8.m1.1.2.cmml"><mi mathsize="90%" id="alg2.8.m1.1.2.2" xref="alg2.8.m1.1.2.2.cmml">m</mi><mo mathsize="90%" stretchy="false" id="alg2.8.m1.1.2.1" xref="alg2.8.m1.1.2.1.cmml">←</mo><mrow id="alg2.8.m1.1.2.3" xref="alg2.8.m1.1.2.3.cmml"><mrow id="alg2.8.m1.1.2.3.2.2" xref="alg2.8.m1.1.2.3.2.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.8.m1.1.2.3.2.2.1" xref="alg2.8.m1.1.2.3.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.8.m1.1.1" xref="alg2.8.m1.1.1.cmml">𝒲</mi><mo maxsize="90%" minsize="90%" id="alg2.8.m1.1.2.3.2.2.2" xref="alg2.8.m1.1.2.3.2.1.1.cmml">|</mo></mrow><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="alg2.8.m1.1.2.3.1" xref="alg2.8.m1.1.2.3.1.cmml">/</mo><mn mathsize="90%" id="alg2.8.m1.1.2.3.3" xref="alg2.8.m1.1.2.3.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.8.m1.1b"><apply id="alg2.8.m1.1.2.cmml" xref="alg2.8.m1.1.2"><ci id="alg2.8.m1.1.2.1.cmml" xref="alg2.8.m1.1.2.1">←</ci><ci id="alg2.8.m1.1.2.2.cmml" xref="alg2.8.m1.1.2.2">𝑚</ci><apply id="alg2.8.m1.1.2.3.cmml" xref="alg2.8.m1.1.2.3"><divide id="alg2.8.m1.1.2.3.1.cmml" xref="alg2.8.m1.1.2.3.1"></divide><apply id="alg2.8.m1.1.2.3.2.1.cmml" xref="alg2.8.m1.1.2.3.2.2"><abs id="alg2.8.m1.1.2.3.2.1.1.cmml" xref="alg2.8.m1.1.2.3.2.2.1"></abs><ci id="alg2.8.m1.1.1.cmml" xref="alg2.8.m1.1.1">𝒲</ci></apply><cn type="integer" id="alg2.8.m1.1.2.3.3.cmml" xref="alg2.8.m1.1.2.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.m1.1c">m\leftarrow|\mathcal{W}|/2</annotation></semantics></math><span id="alg2.10.5" class="ltx_text" style="font-size:90%;">, </span><math id="alg2.9.m2.1" class="ltx_Math" alttext="f\leftarrow|\mathcal{W}|/2" display="inline"><semantics id="alg2.9.m2.1a"><mrow id="alg2.9.m2.1.2" xref="alg2.9.m2.1.2.cmml"><mi mathsize="90%" id="alg2.9.m2.1.2.2" xref="alg2.9.m2.1.2.2.cmml">f</mi><mo mathsize="90%" stretchy="false" id="alg2.9.m2.1.2.1" xref="alg2.9.m2.1.2.1.cmml">←</mo><mrow id="alg2.9.m2.1.2.3" xref="alg2.9.m2.1.2.3.cmml"><mrow id="alg2.9.m2.1.2.3.2.2" xref="alg2.9.m2.1.2.3.2.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.9.m2.1.2.3.2.2.1" xref="alg2.9.m2.1.2.3.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.9.m2.1.1" xref="alg2.9.m2.1.1.cmml">𝒲</mi><mo maxsize="90%" minsize="90%" id="alg2.9.m2.1.2.3.2.2.2" xref="alg2.9.m2.1.2.3.2.1.1.cmml">|</mo></mrow><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="alg2.9.m2.1.2.3.1" xref="alg2.9.m2.1.2.3.1.cmml">/</mo><mn mathsize="90%" id="alg2.9.m2.1.2.3.3" xref="alg2.9.m2.1.2.3.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.9.m2.1b"><apply id="alg2.9.m2.1.2.cmml" xref="alg2.9.m2.1.2"><ci id="alg2.9.m2.1.2.1.cmml" xref="alg2.9.m2.1.2.1">←</ci><ci id="alg2.9.m2.1.2.2.cmml" xref="alg2.9.m2.1.2.2">𝑓</ci><apply id="alg2.9.m2.1.2.3.cmml" xref="alg2.9.m2.1.2.3"><divide id="alg2.9.m2.1.2.3.1.cmml" xref="alg2.9.m2.1.2.3.1"></divide><apply id="alg2.9.m2.1.2.3.2.1.cmml" xref="alg2.9.m2.1.2.3.2.2"><abs id="alg2.9.m2.1.2.3.2.1.1.cmml" xref="alg2.9.m2.1.2.3.2.2.1"></abs><ci id="alg2.9.m2.1.1.cmml" xref="alg2.9.m2.1.1">𝒲</ci></apply><cn type="integer" id="alg2.9.m2.1.2.3.3.cmml" xref="alg2.9.m2.1.2.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.m2.1c">f\leftarrow|\mathcal{W}|/2</annotation></semantics></math><span id="alg2.10.6" class="ltx_text" style="font-size:90%;">,
</span><math id="alg2.10.m3.3" class="ltx_Math" alttext="\textbf{w}_{\text{avg}}\leftarrow{\mathit{Krum}\_\mathit{and}\_m\_\mathit{Krum}(\mathcal{W},m,f)}" display="inline"><semantics id="alg2.10.m3.3a"><mrow id="alg2.10.m3.3.4" xref="alg2.10.m3.3.4.cmml"><msub id="alg2.10.m3.3.4.2" xref="alg2.10.m3.3.4.2.cmml"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="alg2.10.m3.3.4.2.2" xref="alg2.10.m3.3.4.2.2a.cmml">w</mtext><mtext mathsize="90%" id="alg2.10.m3.3.4.2.3" xref="alg2.10.m3.3.4.2.3a.cmml">avg</mtext></msub><mo mathsize="90%" stretchy="false" id="alg2.10.m3.3.4.1" xref="alg2.10.m3.3.4.1.cmml">←</mo><mrow id="alg2.10.m3.3.4.3" xref="alg2.10.m3.3.4.3.cmml"><mi mathsize="90%" id="alg2.10.m3.3.4.3.2" xref="alg2.10.m3.3.4.3.2.cmml">𝐾𝑟𝑢𝑚</mi><mo lspace="0em" rspace="0em" id="alg2.10.m3.3.4.3.1" xref="alg2.10.m3.3.4.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg2.10.m3.3.4.3.3" xref="alg2.10.m3.3.4.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.10.m3.3.4.3.1a" xref="alg2.10.m3.3.4.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.10.m3.3.4.3.4" xref="alg2.10.m3.3.4.3.4.cmml">𝑎𝑛𝑑</mi><mo lspace="0em" rspace="0em" id="alg2.10.m3.3.4.3.1b" xref="alg2.10.m3.3.4.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg2.10.m3.3.4.3.5" xref="alg2.10.m3.3.4.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.10.m3.3.4.3.1c" xref="alg2.10.m3.3.4.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.10.m3.3.4.3.6" xref="alg2.10.m3.3.4.3.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.10.m3.3.4.3.1d" xref="alg2.10.m3.3.4.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg2.10.m3.3.4.3.7" xref="alg2.10.m3.3.4.3.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.10.m3.3.4.3.1e" xref="alg2.10.m3.3.4.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.10.m3.3.4.3.8" xref="alg2.10.m3.3.4.3.8.cmml">𝐾𝑟𝑢𝑚</mi><mo lspace="0em" rspace="0em" id="alg2.10.m3.3.4.3.1f" xref="alg2.10.m3.3.4.3.1.cmml">​</mo><mrow id="alg2.10.m3.3.4.3.9.2" xref="alg2.10.m3.3.4.3.9.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.10.m3.3.4.3.9.2.1" xref="alg2.10.m3.3.4.3.9.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.10.m3.1.1" xref="alg2.10.m3.1.1.cmml">𝒲</mi><mo mathsize="90%" id="alg2.10.m3.3.4.3.9.2.2" xref="alg2.10.m3.3.4.3.9.1.cmml">,</mo><mi mathsize="90%" id="alg2.10.m3.2.2" xref="alg2.10.m3.2.2.cmml">m</mi><mo mathsize="90%" id="alg2.10.m3.3.4.3.9.2.3" xref="alg2.10.m3.3.4.3.9.1.cmml">,</mo><mi mathsize="90%" id="alg2.10.m3.3.3" xref="alg2.10.m3.3.3.cmml">f</mi><mo maxsize="90%" minsize="90%" id="alg2.10.m3.3.4.3.9.2.4" xref="alg2.10.m3.3.4.3.9.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.10.m3.3b"><apply id="alg2.10.m3.3.4.cmml" xref="alg2.10.m3.3.4"><ci id="alg2.10.m3.3.4.1.cmml" xref="alg2.10.m3.3.4.1">←</ci><apply id="alg2.10.m3.3.4.2.cmml" xref="alg2.10.m3.3.4.2"><csymbol cd="ambiguous" id="alg2.10.m3.3.4.2.1.cmml" xref="alg2.10.m3.3.4.2">subscript</csymbol><ci id="alg2.10.m3.3.4.2.2a.cmml" xref="alg2.10.m3.3.4.2.2"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="alg2.10.m3.3.4.2.2.cmml" xref="alg2.10.m3.3.4.2.2">w</mtext></ci><ci id="alg2.10.m3.3.4.2.3a.cmml" xref="alg2.10.m3.3.4.2.3"><mtext mathsize="63%" id="alg2.10.m3.3.4.2.3.cmml" xref="alg2.10.m3.3.4.2.3">avg</mtext></ci></apply><apply id="alg2.10.m3.3.4.3.cmml" xref="alg2.10.m3.3.4.3"><times id="alg2.10.m3.3.4.3.1.cmml" xref="alg2.10.m3.3.4.3.1"></times><ci id="alg2.10.m3.3.4.3.2.cmml" xref="alg2.10.m3.3.4.3.2">𝐾𝑟𝑢𝑚</ci><ci id="alg2.10.m3.3.4.3.3.cmml" xref="alg2.10.m3.3.4.3.3">_</ci><ci id="alg2.10.m3.3.4.3.4.cmml" xref="alg2.10.m3.3.4.3.4">𝑎𝑛𝑑</ci><ci id="alg2.10.m3.3.4.3.5.cmml" xref="alg2.10.m3.3.4.3.5">_</ci><ci id="alg2.10.m3.3.4.3.6.cmml" xref="alg2.10.m3.3.4.3.6">𝑚</ci><ci id="alg2.10.m3.3.4.3.7.cmml" xref="alg2.10.m3.3.4.3.7">_</ci><ci id="alg2.10.m3.3.4.3.8.cmml" xref="alg2.10.m3.3.4.3.8">𝐾𝑟𝑢𝑚</ci><vector id="alg2.10.m3.3.4.3.9.1.cmml" xref="alg2.10.m3.3.4.3.9.2"><ci id="alg2.10.m3.1.1.cmml" xref="alg2.10.m3.1.1">𝒲</ci><ci id="alg2.10.m3.2.2.cmml" xref="alg2.10.m3.2.2">𝑚</ci><ci id="alg2.10.m3.3.3.cmml" xref="alg2.10.m3.3.3">𝑓</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.m3.3c">\textbf{w}_{\text{avg}}\leftarrow{\mathit{Krum}\_\mathit{and}\_m\_\mathit{Krum}(\mathcal{W},m,f)}</annotation></semantics></math><span id="alg2.10.7" class="ltx_text" style="font-size:90%;">
</span>
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="alg2.31" class="ltx_block ltx_figure_panel">
<div id="alg2.18" class="ltx_listingline">
<span id="alg2.18.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg2.18.3" class="ltx_text" style="font-size:90%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="alg2.18.4.1.1" class="ltx_text" style="font-size:90%;">12</span></span><span class="ltx_tag ltx_tag_listingline"><span id="alg2.18.5.1.1" class="ltx_text" style="font-size:90%;">11</span></span><span class="ltx_tag ltx_tag_listingline"><span id="alg2.18.6.1.1" class="ltx_text" style="font-size:90%;">10</span></span><math id="alg2.11.m1.2" class="ltx_Math" alttext="\mathcal{L}\leftarrow\mathit{compute}\_\mathit{L2}\_\mathit{scores}(\mathcal{W},\textbf{w}_{\text{avg}})" display="inline"><semantics id="alg2.11.m1.2a"><mrow id="alg2.11.m1.2.2" xref="alg2.11.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.11.m1.2.2.3" xref="alg2.11.m1.2.2.3.cmml">ℒ</mi><mo mathsize="90%" stretchy="false" id="alg2.11.m1.2.2.2" xref="alg2.11.m1.2.2.2.cmml">←</mo><mrow id="alg2.11.m1.2.2.1" xref="alg2.11.m1.2.2.1.cmml"><mi mathsize="90%" id="alg2.11.m1.2.2.1.3" xref="alg2.11.m1.2.2.1.3.cmml">𝑐𝑜𝑚𝑝𝑢𝑡𝑒</mi><mo lspace="0em" rspace="0em" id="alg2.11.m1.2.2.1.2" xref="alg2.11.m1.2.2.1.2.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg2.11.m1.2.2.1.4" xref="alg2.11.m1.2.2.1.4.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.11.m1.2.2.1.2a" xref="alg2.11.m1.2.2.1.2.cmml">​</mo><mi class="ltx_mathvariant_italic" mathsize="90%" mathvariant="italic" id="alg2.11.m1.2.2.1.5" xref="alg2.11.m1.2.2.1.5.cmml">L2</mi><mo lspace="0em" rspace="0em" id="alg2.11.m1.2.2.1.2b" xref="alg2.11.m1.2.2.1.2.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg2.11.m1.2.2.1.6" xref="alg2.11.m1.2.2.1.6.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.11.m1.2.2.1.2c" xref="alg2.11.m1.2.2.1.2.cmml">​</mo><mi mathsize="90%" id="alg2.11.m1.2.2.1.7" xref="alg2.11.m1.2.2.1.7.cmml">𝑠𝑐𝑜𝑟𝑒𝑠</mi><mo lspace="0em" rspace="0em" id="alg2.11.m1.2.2.1.2d" xref="alg2.11.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.11.m1.2.2.1.1.1" xref="alg2.11.m1.2.2.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg2.11.m1.2.2.1.1.1.2" xref="alg2.11.m1.2.2.1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.11.m1.1.1" xref="alg2.11.m1.1.1.cmml">𝒲</mi><mo mathsize="90%" id="alg2.11.m1.2.2.1.1.1.3" xref="alg2.11.m1.2.2.1.1.2.cmml">,</mo><msub id="alg2.11.m1.2.2.1.1.1.1" xref="alg2.11.m1.2.2.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="alg2.11.m1.2.2.1.1.1.1.2" xref="alg2.11.m1.2.2.1.1.1.1.2a.cmml">w</mtext><mtext mathsize="90%" id="alg2.11.m1.2.2.1.1.1.1.3" xref="alg2.11.m1.2.2.1.1.1.1.3a.cmml">avg</mtext></msub><mo maxsize="90%" minsize="90%" id="alg2.11.m1.2.2.1.1.1.4" xref="alg2.11.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.11.m1.2b"><apply id="alg2.11.m1.2.2.cmml" xref="alg2.11.m1.2.2"><ci id="alg2.11.m1.2.2.2.cmml" xref="alg2.11.m1.2.2.2">←</ci><ci id="alg2.11.m1.2.2.3.cmml" xref="alg2.11.m1.2.2.3">ℒ</ci><apply id="alg2.11.m1.2.2.1.cmml" xref="alg2.11.m1.2.2.1"><times id="alg2.11.m1.2.2.1.2.cmml" xref="alg2.11.m1.2.2.1.2"></times><ci id="alg2.11.m1.2.2.1.3.cmml" xref="alg2.11.m1.2.2.1.3">𝑐𝑜𝑚𝑝𝑢𝑡𝑒</ci><ci id="alg2.11.m1.2.2.1.4.cmml" xref="alg2.11.m1.2.2.1.4">_</ci><ci id="alg2.11.m1.2.2.1.5.cmml" xref="alg2.11.m1.2.2.1.5">italic-L2</ci><ci id="alg2.11.m1.2.2.1.6.cmml" xref="alg2.11.m1.2.2.1.6">_</ci><ci id="alg2.11.m1.2.2.1.7.cmml" xref="alg2.11.m1.2.2.1.7">𝑠𝑐𝑜𝑟𝑒𝑠</ci><interval closure="open" id="alg2.11.m1.2.2.1.1.2.cmml" xref="alg2.11.m1.2.2.1.1.1"><ci id="alg2.11.m1.1.1.cmml" xref="alg2.11.m1.1.1">𝒲</ci><apply id="alg2.11.m1.2.2.1.1.1.1.cmml" xref="alg2.11.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.11.m1.2.2.1.1.1.1.1.cmml" xref="alg2.11.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.11.m1.2.2.1.1.1.1.2a.cmml" xref="alg2.11.m1.2.2.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="alg2.11.m1.2.2.1.1.1.1.2.cmml" xref="alg2.11.m1.2.2.1.1.1.1.2">w</mtext></ci><ci id="alg2.11.m1.2.2.1.1.1.1.3a.cmml" xref="alg2.11.m1.2.2.1.1.1.1.3"><mtext mathsize="63%" id="alg2.11.m1.2.2.1.1.1.1.3.cmml" xref="alg2.11.m1.2.2.1.1.1.1.3">avg</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.m1.2c">\mathcal{L}\leftarrow\mathit{compute}\_\mathit{L2}\_\mathit{scores}(\mathcal{W},\textbf{w}_{\text{avg}})</annotation></semantics></math><span id="alg2.18.7" class="ltx_text" style="font-size:90%;">
</span><math id="alg2.12.m2.1" class="ltx_Math" alttext="\mu\leftarrow\frac{\sum_{\ell\in\mathcal{L}}\ell}{|\mathcal{L}|}" display="inline"><semantics id="alg2.12.m2.1a"><mrow id="alg2.12.m2.1.2" xref="alg2.12.m2.1.2.cmml"><mi mathsize="90%" id="alg2.12.m2.1.2.2" xref="alg2.12.m2.1.2.2.cmml">μ</mi><mo mathsize="90%" stretchy="false" id="alg2.12.m2.1.2.1" xref="alg2.12.m2.1.2.1.cmml">←</mo><mfrac id="alg2.12.m2.1.1" xref="alg2.12.m2.1.1.cmml"><mrow id="alg2.12.m2.1.1.3" xref="alg2.12.m2.1.1.3.cmml"><mstyle displaystyle="false" id="alg2.12.m2.1.1.3.1" xref="alg2.12.m2.1.1.3.1.cmml"><msub id="alg2.12.m2.1.1.3.1a" xref="alg2.12.m2.1.1.3.1.cmml"><mo maxsize="63%" minsize="63%" stretchy="true" id="alg2.12.m2.1.1.3.1.2" xref="alg2.12.m2.1.1.3.1.2.cmml">∑</mo><mrow id="alg2.12.m2.1.1.3.1.3" xref="alg2.12.m2.1.1.3.1.3.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.12.m2.1.1.3.1.3.2" xref="alg2.12.m2.1.1.3.1.3.2.cmml">ℓ</mi><mo mathsize="90%" id="alg2.12.m2.1.1.3.1.3.1" xref="alg2.12.m2.1.1.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.12.m2.1.1.3.1.3.3" xref="alg2.12.m2.1.1.3.1.3.3.cmml">ℒ</mi></mrow></msub></mstyle><mi mathsize="90%" mathvariant="normal" id="alg2.12.m2.1.1.3.2" xref="alg2.12.m2.1.1.3.2.cmml">ℓ</mi></mrow><mrow id="alg2.12.m2.1.1.1.3" xref="alg2.12.m2.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg2.12.m2.1.1.1.3.1" xref="alg2.12.m2.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.12.m2.1.1.1.1" xref="alg2.12.m2.1.1.1.1.cmml">ℒ</mi><mo maxsize="90%" minsize="90%" id="alg2.12.m2.1.1.1.3.2" xref="alg2.12.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg2.12.m2.1b"><apply id="alg2.12.m2.1.2.cmml" xref="alg2.12.m2.1.2"><ci id="alg2.12.m2.1.2.1.cmml" xref="alg2.12.m2.1.2.1">←</ci><ci id="alg2.12.m2.1.2.2.cmml" xref="alg2.12.m2.1.2.2">𝜇</ci><apply id="alg2.12.m2.1.1.cmml" xref="alg2.12.m2.1.1"><divide id="alg2.12.m2.1.1.2.cmml" xref="alg2.12.m2.1.1"></divide><apply id="alg2.12.m2.1.1.3.cmml" xref="alg2.12.m2.1.1.3"><apply id="alg2.12.m2.1.1.3.1.cmml" xref="alg2.12.m2.1.1.3.1"><csymbol cd="ambiguous" id="alg2.12.m2.1.1.3.1.1.cmml" xref="alg2.12.m2.1.1.3.1">subscript</csymbol><sum id="alg2.12.m2.1.1.3.1.2.cmml" xref="alg2.12.m2.1.1.3.1.2"></sum><apply id="alg2.12.m2.1.1.3.1.3.cmml" xref="alg2.12.m2.1.1.3.1.3"><in id="alg2.12.m2.1.1.3.1.3.1.cmml" xref="alg2.12.m2.1.1.3.1.3.1"></in><ci id="alg2.12.m2.1.1.3.1.3.2.cmml" xref="alg2.12.m2.1.1.3.1.3.2">ℓ</ci><ci id="alg2.12.m2.1.1.3.1.3.3.cmml" xref="alg2.12.m2.1.1.3.1.3.3">ℒ</ci></apply></apply><ci id="alg2.12.m2.1.1.3.2.cmml" xref="alg2.12.m2.1.1.3.2">ℓ</ci></apply><apply id="alg2.12.m2.1.1.1.2.cmml" xref="alg2.12.m2.1.1.1.3"><abs id="alg2.12.m2.1.1.1.2.1.cmml" xref="alg2.12.m2.1.1.1.3.1"></abs><ci id="alg2.12.m2.1.1.1.1.cmml" xref="alg2.12.m2.1.1.1.1">ℒ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.m2.1c">\mu\leftarrow\frac{\sum_{\ell\in\mathcal{L}}\ell}{|\mathcal{L}|}</annotation></semantics></math><span id="alg2.18.8" class="ltx_text" style="font-size:90%;">, </span><math id="alg2.13.m3.2" class="ltx_Math" alttext="\sigma\leftarrow\sqrt{\frac{\sum_{\ell\in\mathcal{L}}(\ell-\mu)^{2}}{|\mathcal{L}|-1}}" display="inline"><semantics id="alg2.13.m3.2a"><mrow id="alg2.13.m3.2.3" xref="alg2.13.m3.2.3.cmml"><mi mathsize="90%" id="alg2.13.m3.2.3.2" xref="alg2.13.m3.2.3.2.cmml">σ</mi><mo mathsize="90%" stretchy="false" id="alg2.13.m3.2.3.1" xref="alg2.13.m3.2.3.1.cmml">←</mo><msqrt id="alg2.13.m3.2.2" xref="alg2.13.m3.2.2.cmml"><mfrac id="alg2.13.m3.2.2.2" xref="alg2.13.m3.2.2.2.cmml"><mrow id="alg2.13.m3.1.1.1.1.1" xref="alg2.13.m3.1.1.1.1.1.cmml"><mstyle displaystyle="false" id="alg2.13.m3.1.1.1.1.1.2" xref="alg2.13.m3.1.1.1.1.1.2.cmml"><msub id="alg2.13.m3.1.1.1.1.1.2a" xref="alg2.13.m3.1.1.1.1.1.2.cmml"><mo maxsize="63%" minsize="63%" stretchy="true" id="alg2.13.m3.1.1.1.1.1.2.2" xref="alg2.13.m3.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="alg2.13.m3.1.1.1.1.1.2.3" xref="alg2.13.m3.1.1.1.1.1.2.3.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.13.m3.1.1.1.1.1.2.3.2" xref="alg2.13.m3.1.1.1.1.1.2.3.2.cmml">ℓ</mi><mo mathsize="90%" id="alg2.13.m3.1.1.1.1.1.2.3.1" xref="alg2.13.m3.1.1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.13.m3.1.1.1.1.1.2.3.3" xref="alg2.13.m3.1.1.1.1.1.2.3.3.cmml">ℒ</mi></mrow></msub></mstyle><msup id="alg2.13.m3.1.1.1.1.1.1" xref="alg2.13.m3.1.1.1.1.1.1.cmml"><mrow id="alg2.13.m3.1.1.1.1.1.1.1.1" xref="alg2.13.m3.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.13.m3.1.1.1.1.1.1.1.1.2" xref="alg2.13.m3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.13.m3.1.1.1.1.1.1.1.1.1" xref="alg2.13.m3.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.13.m3.1.1.1.1.1.1.1.1.1.2" xref="alg2.13.m3.1.1.1.1.1.1.1.1.1.2.cmml">ℓ</mi><mo mathsize="90%" id="alg2.13.m3.1.1.1.1.1.1.1.1.1.1" xref="alg2.13.m3.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi mathsize="90%" id="alg2.13.m3.1.1.1.1.1.1.1.1.1.3" xref="alg2.13.m3.1.1.1.1.1.1.1.1.1.3.cmml">μ</mi></mrow><mo maxsize="90%" minsize="90%" id="alg2.13.m3.1.1.1.1.1.1.1.1.3" xref="alg2.13.m3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn mathsize="90%" id="alg2.13.m3.1.1.1.1.1.1.3" xref="alg2.13.m3.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mrow id="alg2.13.m3.2.2.2.2.2" xref="alg2.13.m3.2.2.2.2.2.cmml"><mrow id="alg2.13.m3.2.2.2.2.2.3.2" xref="alg2.13.m3.2.2.2.2.2.3.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.13.m3.2.2.2.2.2.3.2.1" xref="alg2.13.m3.2.2.2.2.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.13.m3.2.2.2.2.2.1" xref="alg2.13.m3.2.2.2.2.2.1.cmml">ℒ</mi><mo maxsize="90%" minsize="90%" id="alg2.13.m3.2.2.2.2.2.3.2.2" xref="alg2.13.m3.2.2.2.2.2.3.1.1.cmml">|</mo></mrow><mo mathsize="90%" id="alg2.13.m3.2.2.2.2.2.2" xref="alg2.13.m3.2.2.2.2.2.2.cmml">−</mo><mn mathsize="90%" id="alg2.13.m3.2.2.2.2.2.4" xref="alg2.13.m3.2.2.2.2.2.4.cmml">1</mn></mrow></mfrac></msqrt></mrow><annotation-xml encoding="MathML-Content" id="alg2.13.m3.2b"><apply id="alg2.13.m3.2.3.cmml" xref="alg2.13.m3.2.3"><ci id="alg2.13.m3.2.3.1.cmml" xref="alg2.13.m3.2.3.1">←</ci><ci id="alg2.13.m3.2.3.2.cmml" xref="alg2.13.m3.2.3.2">𝜎</ci><apply id="alg2.13.m3.2.2.cmml" xref="alg2.13.m3.2.2"><root id="alg2.13.m3.2.2a.cmml" xref="alg2.13.m3.2.2"></root><apply id="alg2.13.m3.2.2.2.cmml" xref="alg2.13.m3.2.2.2"><divide id="alg2.13.m3.2.2.2.3.cmml" xref="alg2.13.m3.2.2.2"></divide><apply id="alg2.13.m3.1.1.1.1.1.cmml" xref="alg2.13.m3.1.1.1.1.1"><apply id="alg2.13.m3.1.1.1.1.1.2.cmml" xref="alg2.13.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.13.m3.1.1.1.1.1.2.1.cmml" xref="alg2.13.m3.1.1.1.1.1.2">subscript</csymbol><sum id="alg2.13.m3.1.1.1.1.1.2.2.cmml" xref="alg2.13.m3.1.1.1.1.1.2.2"></sum><apply id="alg2.13.m3.1.1.1.1.1.2.3.cmml" xref="alg2.13.m3.1.1.1.1.1.2.3"><in id="alg2.13.m3.1.1.1.1.1.2.3.1.cmml" xref="alg2.13.m3.1.1.1.1.1.2.3.1"></in><ci id="alg2.13.m3.1.1.1.1.1.2.3.2.cmml" xref="alg2.13.m3.1.1.1.1.1.2.3.2">ℓ</ci><ci id="alg2.13.m3.1.1.1.1.1.2.3.3.cmml" xref="alg2.13.m3.1.1.1.1.1.2.3.3">ℒ</ci></apply></apply><apply id="alg2.13.m3.1.1.1.1.1.1.cmml" xref="alg2.13.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.13.m3.1.1.1.1.1.1.2.cmml" xref="alg2.13.m3.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.13.m3.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.13.m3.1.1.1.1.1.1.1.1"><minus id="alg2.13.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.13.m3.1.1.1.1.1.1.1.1.1.1"></minus><ci id="alg2.13.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.13.m3.1.1.1.1.1.1.1.1.1.2">ℓ</ci><ci id="alg2.13.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.13.m3.1.1.1.1.1.1.1.1.1.3">𝜇</ci></apply><cn type="integer" id="alg2.13.m3.1.1.1.1.1.1.3.cmml" xref="alg2.13.m3.1.1.1.1.1.1.3">2</cn></apply></apply><apply id="alg2.13.m3.2.2.2.2.2.cmml" xref="alg2.13.m3.2.2.2.2.2"><minus id="alg2.13.m3.2.2.2.2.2.2.cmml" xref="alg2.13.m3.2.2.2.2.2.2"></minus><apply id="alg2.13.m3.2.2.2.2.2.3.1.cmml" xref="alg2.13.m3.2.2.2.2.2.3.2"><abs id="alg2.13.m3.2.2.2.2.2.3.1.1.cmml" xref="alg2.13.m3.2.2.2.2.2.3.2.1"></abs><ci id="alg2.13.m3.2.2.2.2.2.1.cmml" xref="alg2.13.m3.2.2.2.2.2.1">ℒ</ci></apply><cn type="integer" id="alg2.13.m3.2.2.2.2.2.4.cmml" xref="alg2.13.m3.2.2.2.2.2.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.13.m3.2c">\sigma\leftarrow\sqrt{\frac{\sum_{\ell\in\mathcal{L}}(\ell-\mu)^{2}}{|\mathcal{L}|-1}}</annotation></semantics></math><span id="alg2.18.9" class="ltx_text" style="font-size:90%;">  </span><math id="alg2.14.m4.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.14.m4.1a"><mo mathsize="90%" id="alg2.14.m4.1.1" xref="alg2.14.m4.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.14.m4.1b"><ci id="alg2.14.m4.1.1.cmml" xref="alg2.14.m4.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.14.m4.1c">\triangleright</annotation></semantics></math><span id="alg2.18.10" class="ltx_text" style="font-size:90%;"> Compute </span><math id="alg2.15.m5.1" class="ltx_Math" alttext="\mathcal{N}" display="inline"><semantics id="alg2.15.m5.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.15.m5.1.1" xref="alg2.15.m5.1.1.cmml">𝒩</mi><annotation-xml encoding="MathML-Content" id="alg2.15.m5.1b"><ci id="alg2.15.m5.1.1.cmml" xref="alg2.15.m5.1.1">𝒩</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.15.m5.1c">\mathcal{N}</annotation></semantics></math><span id="alg2.18.11" class="ltx_text" style="font-size:90%;">(</span><math id="alg2.16.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="alg2.16.m6.1a"><mi mathsize="90%" id="alg2.16.m6.1.1" xref="alg2.16.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="alg2.16.m6.1b"><ci id="alg2.16.m6.1.1.cmml" xref="alg2.16.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.16.m6.1c">\mu</annotation></semantics></math><span id="alg2.18.12" class="ltx_text" style="font-size:90%;">, </span><math id="alg2.17.m7.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="alg2.17.m7.1a"><mi mathsize="90%" id="alg2.17.m7.1.1" xref="alg2.17.m7.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="alg2.17.m7.1b"><ci id="alg2.17.m7.1.1.cmml" xref="alg2.17.m7.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.17.m7.1c">\sigma</annotation></semantics></math><span id="alg2.18.13" class="ltx_text" style="font-size:90%;">)

</span><span id="alg2.18.14" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg2.18.15" class="ltx_text" style="font-size:90%;"> </span><em id="alg2.18.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"> 0 <math id="alg2.18.1.m1.1" class="ltx_Math" alttext="&lt;i&lt;|\mathcal{W}|" display="inline"><semantics id="alg2.18.1.m1.1a"><mrow id="alg2.18.1.m1.1.2" xref="alg2.18.1.m1.1.2.cmml"><mi id="alg2.18.1.m1.1.2.2" xref="alg2.18.1.m1.1.2.2.cmml"></mi><mo id="alg2.18.1.m1.1.2.3" xref="alg2.18.1.m1.1.2.3.cmml">&lt;</mo><mi id="alg2.18.1.m1.1.2.4" xref="alg2.18.1.m1.1.2.4.cmml">i</mi><mo id="alg2.18.1.m1.1.2.5" xref="alg2.18.1.m1.1.2.5.cmml">&lt;</mo><mrow id="alg2.18.1.m1.1.2.6.2" xref="alg2.18.1.m1.1.2.6.1.cmml"><mo stretchy="false" id="alg2.18.1.m1.1.2.6.2.1" xref="alg2.18.1.m1.1.2.6.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg2.18.1.m1.1.1" xref="alg2.18.1.m1.1.1.cmml">𝒲</mi><mo stretchy="false" id="alg2.18.1.m1.1.2.6.2.2" xref="alg2.18.1.m1.1.2.6.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.18.1.m1.1b"><apply id="alg2.18.1.m1.1.2.cmml" xref="alg2.18.1.m1.1.2"><and id="alg2.18.1.m1.1.2a.cmml" xref="alg2.18.1.m1.1.2"></and><apply id="alg2.18.1.m1.1.2b.cmml" xref="alg2.18.1.m1.1.2"><lt id="alg2.18.1.m1.1.2.3.cmml" xref="alg2.18.1.m1.1.2.3"></lt><csymbol cd="latexml" id="alg2.18.1.m1.1.2.2.cmml" xref="alg2.18.1.m1.1.2.2">absent</csymbol><ci id="alg2.18.1.m1.1.2.4.cmml" xref="alg2.18.1.m1.1.2.4">𝑖</ci></apply><apply id="alg2.18.1.m1.1.2c.cmml" xref="alg2.18.1.m1.1.2"><lt id="alg2.18.1.m1.1.2.5.cmml" xref="alg2.18.1.m1.1.2.5"></lt><share href="#alg2.18.1.m1.1.2.4.cmml" id="alg2.18.1.m1.1.2d.cmml" xref="alg2.18.1.m1.1.2"></share><apply id="alg2.18.1.m1.1.2.6.1.cmml" xref="alg2.18.1.m1.1.2.6.2"><abs id="alg2.18.1.m1.1.2.6.1.1.cmml" xref="alg2.18.1.m1.1.2.6.2.1"></abs><ci id="alg2.18.1.m1.1.1.cmml" xref="alg2.18.1.m1.1.1">𝒲</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.18.1.m1.1c">&lt;i&lt;|\mathcal{W}|</annotation></semantics></math></em><span id="alg2.18.16" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.18.17" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="alg2.21" class="ltx_listingline">
<span id="alg2.21.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg2.21.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg2.21.4" class="ltx_text" style="font-size:90%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="alg2.21.5.1.1" class="ltx_text" style="font-size:90%;">13</span></span><span id="alg2.21.6" class="ltx_text" style="font-size:90%;">
</span><span id="alg2.21.7" class="ltx_text ltx_font_bold" style="font-size:90%;">if</span><span id="alg2.21.8" class="ltx_text" style="font-size:90%;"> </span><em id="alg2.19.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="alg2.19.1.m1.1" class="ltx_Math" alttext="\mathcal{L}[i]&gt;\mu+\lambda\sigma" display="inline"><semantics id="alg2.19.1.m1.1a"><mrow id="alg2.19.1.m1.1.2" xref="alg2.19.1.m1.1.2.cmml"><mrow id="alg2.19.1.m1.1.2.2" xref="alg2.19.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.19.1.m1.1.2.2.2" xref="alg2.19.1.m1.1.2.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="alg2.19.1.m1.1.2.2.1" xref="alg2.19.1.m1.1.2.2.1.cmml">​</mo><mrow id="alg2.19.1.m1.1.2.2.3.2" xref="alg2.19.1.m1.1.2.2.3.1.cmml"><mo stretchy="false" id="alg2.19.1.m1.1.2.2.3.2.1" xref="alg2.19.1.m1.1.2.2.3.1.1.cmml">[</mo><mi id="alg2.19.1.m1.1.1" xref="alg2.19.1.m1.1.1.cmml">i</mi><mo stretchy="false" id="alg2.19.1.m1.1.2.2.3.2.2" xref="alg2.19.1.m1.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg2.19.1.m1.1.2.1" xref="alg2.19.1.m1.1.2.1.cmml">&gt;</mo><mrow id="alg2.19.1.m1.1.2.3" xref="alg2.19.1.m1.1.2.3.cmml"><mi id="alg2.19.1.m1.1.2.3.2" xref="alg2.19.1.m1.1.2.3.2.cmml">μ</mi><mo id="alg2.19.1.m1.1.2.3.1" xref="alg2.19.1.m1.1.2.3.1.cmml">+</mo><mrow id="alg2.19.1.m1.1.2.3.3" xref="alg2.19.1.m1.1.2.3.3.cmml"><mi id="alg2.19.1.m1.1.2.3.3.2" xref="alg2.19.1.m1.1.2.3.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="alg2.19.1.m1.1.2.3.3.1" xref="alg2.19.1.m1.1.2.3.3.1.cmml">​</mo><mi id="alg2.19.1.m1.1.2.3.3.3" xref="alg2.19.1.m1.1.2.3.3.3.cmml">σ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.19.1.m1.1b"><apply id="alg2.19.1.m1.1.2.cmml" xref="alg2.19.1.m1.1.2"><gt id="alg2.19.1.m1.1.2.1.cmml" xref="alg2.19.1.m1.1.2.1"></gt><apply id="alg2.19.1.m1.1.2.2.cmml" xref="alg2.19.1.m1.1.2.2"><times id="alg2.19.1.m1.1.2.2.1.cmml" xref="alg2.19.1.m1.1.2.2.1"></times><ci id="alg2.19.1.m1.1.2.2.2.cmml" xref="alg2.19.1.m1.1.2.2.2">ℒ</ci><apply id="alg2.19.1.m1.1.2.2.3.1.cmml" xref="alg2.19.1.m1.1.2.2.3.2"><csymbol cd="latexml" id="alg2.19.1.m1.1.2.2.3.1.1.cmml" xref="alg2.19.1.m1.1.2.2.3.2.1">delimited-[]</csymbol><ci id="alg2.19.1.m1.1.1.cmml" xref="alg2.19.1.m1.1.1">𝑖</ci></apply></apply><apply id="alg2.19.1.m1.1.2.3.cmml" xref="alg2.19.1.m1.1.2.3"><plus id="alg2.19.1.m1.1.2.3.1.cmml" xref="alg2.19.1.m1.1.2.3.1"></plus><ci id="alg2.19.1.m1.1.2.3.2.cmml" xref="alg2.19.1.m1.1.2.3.2">𝜇</ci><apply id="alg2.19.1.m1.1.2.3.3.cmml" xref="alg2.19.1.m1.1.2.3.3"><times id="alg2.19.1.m1.1.2.3.3.1.cmml" xref="alg2.19.1.m1.1.2.3.3.1"></times><ci id="alg2.19.1.m1.1.2.3.3.2.cmml" xref="alg2.19.1.m1.1.2.3.3.2">𝜆</ci><ci id="alg2.19.1.m1.1.2.3.3.3.cmml" xref="alg2.19.1.m1.1.2.3.3.3">𝜎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.19.1.m1.1c">\mathcal{L}[i]&gt;\mu+\lambda\sigma</annotation></semantics></math></em><span id="alg2.21.9" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.21.10" class="ltx_text ltx_font_bold" style="font-size:90%;">then</span><span id="alg2.21.11" class="ltx_text" style="font-size:90%;">  remove </span><math id="alg2.20.m1.1" class="ltx_Math" alttext="\mathbf{w}_{i}" display="inline"><semantics id="alg2.20.m1.1a"><msub id="alg2.20.m1.1.1" xref="alg2.20.m1.1.1.cmml"><mi mathsize="90%" id="alg2.20.m1.1.1.2" xref="alg2.20.m1.1.1.2.cmml">𝐰</mi><mi mathsize="90%" id="alg2.20.m1.1.1.3" xref="alg2.20.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.20.m1.1b"><apply id="alg2.20.m1.1.1.cmml" xref="alg2.20.m1.1.1"><csymbol cd="ambiguous" id="alg2.20.m1.1.1.1.cmml" xref="alg2.20.m1.1.1">subscript</csymbol><ci id="alg2.20.m1.1.1.2.cmml" xref="alg2.20.m1.1.1.2">𝐰</ci><ci id="alg2.20.m1.1.1.3.cmml" xref="alg2.20.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.20.m1.1c">\mathbf{w}_{i}</annotation></semantics></math><span id="alg2.21.12" class="ltx_text" style="font-size:90%;"> from </span><math id="alg2.21.m2.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="alg2.21.m2.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.21.m2.1.1" xref="alg2.21.m2.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="alg2.21.m2.1b"><ci id="alg2.21.m2.1.1.cmml" xref="alg2.21.m2.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.21.m2.1c">\mathcal{W}</annotation></semantics></math><span id="alg2.21.13" class="ltx_text" style="font-size:90%;">
;</span>
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="alg2.32" class="ltx_block ltx_figure_panel">
<div id="alg2.32.1" class="ltx_listingline">
<span id="alg2.32.1.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg2.32.1.2" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg2.32.1.3" class="ltx_text" style="font-size:90%;">   </span><span id="alg2.32.1.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.25" class="ltx_listingline">
<span id="alg2.25.1" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg2.25.2" class="ltx_text" style="font-size:90%;">   </span><span class="ltx_tag ltx_tag_listingline"><span id="alg2.25.3.1.1" class="ltx_text" style="font-size:90%;">15</span></span><span class="ltx_tag ltx_tag_listingline"><span id="alg2.25.4.1.1" class="ltx_text" style="font-size:90%;">14</span></span><span id="alg2.25.5" class="ltx_text" style="font-size:90%;">
</span><math id="alg2.22.m1.1" class="ltx_Math" alttext="\textbf{w}_{\text{avg}}\leftarrow\mathit{average}(\mathcal{W})" display="inline"><semantics id="alg2.22.m1.1a"><mrow id="alg2.22.m1.1.2" xref="alg2.22.m1.1.2.cmml"><msub id="alg2.22.m1.1.2.2" xref="alg2.22.m1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="alg2.22.m1.1.2.2.2" xref="alg2.22.m1.1.2.2.2a.cmml">w</mtext><mtext mathsize="90%" id="alg2.22.m1.1.2.2.3" xref="alg2.22.m1.1.2.2.3a.cmml">avg</mtext></msub><mo mathsize="90%" stretchy="false" id="alg2.22.m1.1.2.1" xref="alg2.22.m1.1.2.1.cmml">←</mo><mrow id="alg2.22.m1.1.2.3" xref="alg2.22.m1.1.2.3.cmml"><mi mathsize="90%" id="alg2.22.m1.1.2.3.2" xref="alg2.22.m1.1.2.3.2.cmml">𝑎𝑣𝑒𝑟𝑎𝑔𝑒</mi><mo lspace="0em" rspace="0em" id="alg2.22.m1.1.2.3.1" xref="alg2.22.m1.1.2.3.1.cmml">​</mo><mrow id="alg2.22.m1.1.2.3.3.2" xref="alg2.22.m1.1.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.22.m1.1.2.3.3.2.1" xref="alg2.22.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.22.m1.1.1" xref="alg2.22.m1.1.1.cmml">𝒲</mi><mo maxsize="90%" minsize="90%" id="alg2.22.m1.1.2.3.3.2.2" xref="alg2.22.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.22.m1.1b"><apply id="alg2.22.m1.1.2.cmml" xref="alg2.22.m1.1.2"><ci id="alg2.22.m1.1.2.1.cmml" xref="alg2.22.m1.1.2.1">←</ci><apply id="alg2.22.m1.1.2.2.cmml" xref="alg2.22.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.22.m1.1.2.2.1.cmml" xref="alg2.22.m1.1.2.2">subscript</csymbol><ci id="alg2.22.m1.1.2.2.2a.cmml" xref="alg2.22.m1.1.2.2.2"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="alg2.22.m1.1.2.2.2.cmml" xref="alg2.22.m1.1.2.2.2">w</mtext></ci><ci id="alg2.22.m1.1.2.2.3a.cmml" xref="alg2.22.m1.1.2.2.3"><mtext mathsize="63%" id="alg2.22.m1.1.2.2.3.cmml" xref="alg2.22.m1.1.2.2.3">avg</mtext></ci></apply><apply id="alg2.22.m1.1.2.3.cmml" xref="alg2.22.m1.1.2.3"><times id="alg2.22.m1.1.2.3.1.cmml" xref="alg2.22.m1.1.2.3.1"></times><ci id="alg2.22.m1.1.2.3.2.cmml" xref="alg2.22.m1.1.2.3.2">𝑎𝑣𝑒𝑟𝑎𝑔𝑒</ci><ci id="alg2.22.m1.1.1.cmml" xref="alg2.22.m1.1.1">𝒲</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.22.m1.1c">\textbf{w}_{\text{avg}}\leftarrow\mathit{average}(\mathcal{W})</annotation></semantics></math><span id="alg2.25.6" class="ltx_text" style="font-size:90%;">  </span><math id="alg2.23.m2.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.23.m2.1a"><mo mathsize="90%" id="alg2.23.m2.1.1" xref="alg2.23.m2.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.23.m2.1b"><ci id="alg2.23.m2.1.1.cmml" xref="alg2.23.m2.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.23.m2.1c">\triangleright</annotation></semantics></math><span id="alg2.25.7" class="ltx_text" style="font-size:90%;"> Cache </span><math id="alg2.24.m3.1" class="ltx_Math" alttext="\textbf{w}_{\text{avg}}" display="inline"><semantics id="alg2.24.m3.1a"><msub id="alg2.24.m3.1.1" xref="alg2.24.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="alg2.24.m3.1.1.2" xref="alg2.24.m3.1.1.2a.cmml">w</mtext><mtext mathsize="90%" id="alg2.24.m3.1.1.3" xref="alg2.24.m3.1.1.3a.cmml">avg</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.24.m3.1b"><apply id="alg2.24.m3.1.1.cmml" xref="alg2.24.m3.1.1"><csymbol cd="ambiguous" id="alg2.24.m3.1.1.1.cmml" xref="alg2.24.m3.1.1">subscript</csymbol><ci id="alg2.24.m3.1.1.2a.cmml" xref="alg2.24.m3.1.1.2"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="alg2.24.m3.1.1.2.cmml" xref="alg2.24.m3.1.1.2">w</mtext></ci><ci id="alg2.24.m3.1.1.3a.cmml" xref="alg2.24.m3.1.1.3"><mtext mathsize="63%" id="alg2.24.m3.1.1.3.cmml" xref="alg2.24.m3.1.1.3">avg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.24.m3.1c">\textbf{w}_{\text{avg}}</annotation></semantics></math><span id="alg2.25.8" class="ltx_text" style="font-size:90%;">

</span><span id="alg2.25.9" class="ltx_text ltx_font_bold" style="font-size:90%;">return</span><span id="alg2.25.10" class="ltx_text" style="font-size:90%;"> </span><math id="alg2.25.m4.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="alg2.25.m4.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.25.m4.1.1" xref="alg2.25.m4.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="alg2.25.m4.1b"><ci id="alg2.25.m4.1.1.cmml" xref="alg2.25.m4.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.25.m4.1c">\mathcal{W}</annotation></semantics></math><span id="alg2.25.11" class="ltx_text" style="font-size:90%;">
</span>
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="alg2.33" class="ltx_listingline ltx_figure_panel">
</div>
</div>
</div>
</figure>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">According to <a href="#S3.Thmtheorem2" title="Definition 3.2. ‣ 3.2 Cross-Client Anomaly Detection ‣ 3 Two-Stage Anomaly Detection ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Definition</span> <span class="ltx_text ltx_ref_tag">3.2</span></a>, local models with “degree of evilness” scores higher than the boundary are detected as “malicious models” and are excluded from aggregation. Note that we only take one side of the bounds of the Three-Sigma Rule, as we prefer lower “evilness” that indicates the local model is more likely to be benign, thus the models with “evilness” lower than <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mu+\lambda\sigma" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">μ</mi><mo id="S3.SS2.p3.1.m1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.cmml">+</mo><mrow id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.2" xref="S3.SS2.p3.1.m1.1.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.1.m1.1.1.3.1" xref="S3.SS2.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.1.m1.1.1.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.cmml">σ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><plus id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1"></plus><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝜇</ci><apply id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><times id="S3.SS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.1"></times><ci id="S3.SS2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2">𝜆</ci><ci id="S3.SS2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3">𝜎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\mu+\lambda\sigma</annotation></semantics></math> are not identified as outliers.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.11" class="ltx_p">The details are described in <a href="#alg2" title="In 3.2 Cross-Client Anomaly Detection ‣ 3 Two-Stage Anomaly Detection ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">2</span></a>. In this paper, we select <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><msub id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">L</mi><mn id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">L_{2}</annotation></semantics></math> distances as the “degree of evilness”. For each local model, its score is computed with the model and the averaged model of the last round, denoted as <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{w}_{\text{avg}}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">𝐰</mi><mtext id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3a.cmml">avg</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝐰</ci><ci id="S3.SS2.p4.2.m2.1.1.3a.cmml" xref="S3.SS2.p4.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">avg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">\mathbf{w}_{\text{avg}}</annotation></semantics></math>. We prefer the local model not to diverge much from the averaged model in the last round, thus such an averaged model can be regarded as a “golden truth”.
For each local model <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="\mathbf{w}_{i}" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><msub id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">𝐰</mi><mi id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">𝐰</ci><ci id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">\mathbf{w}_{i}</annotation></semantics></math> in the current round, its <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><msub id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml">L</mi><mn id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2">𝐿</ci><cn type="integer" id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">L_{2}</annotation></semantics></math> score, denoted as <math id="S3.SS2.p4.5.m5.1" class="ltx_Math" alttext="\mathcal{L}[i]" display="inline"><semantics id="S3.SS2.p4.5.m5.1a"><mrow id="S3.SS2.p4.5.m5.1.2" xref="S3.SS2.p4.5.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.5.m5.1.2.2" xref="S3.SS2.p4.5.m5.1.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.5.m5.1.2.1" xref="S3.SS2.p4.5.m5.1.2.1.cmml">​</mo><mrow id="S3.SS2.p4.5.m5.1.2.3.2" xref="S3.SS2.p4.5.m5.1.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p4.5.m5.1.2.3.2.1" xref="S3.SS2.p4.5.m5.1.2.3.1.1.cmml">[</mo><mi id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.p4.5.m5.1.2.3.2.2" xref="S3.SS2.p4.5.m5.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.2.cmml" xref="S3.SS2.p4.5.m5.1.2"><times id="S3.SS2.p4.5.m5.1.2.1.cmml" xref="S3.SS2.p4.5.m5.1.2.1"></times><ci id="S3.SS2.p4.5.m5.1.2.2.cmml" xref="S3.SS2.p4.5.m5.1.2.2">ℒ</ci><apply id="S3.SS2.p4.5.m5.1.2.3.1.cmml" xref="S3.SS2.p4.5.m5.1.2.3.2"><csymbol cd="latexml" id="S3.SS2.p4.5.m5.1.2.3.1.1.cmml" xref="S3.SS2.p4.5.m5.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">\mathcal{L}[i]</annotation></semantics></math>, is computed as <math id="S3.SS2.p4.6.m6.2" class="ltx_Math" alttext="\mathcal{L}[i]=||\mathbf{w}_{i}-\mathbf{w}_{\text{avg}}||" display="inline"><semantics id="S3.SS2.p4.6.m6.2a"><mrow id="S3.SS2.p4.6.m6.2.2" xref="S3.SS2.p4.6.m6.2.2.cmml"><mrow id="S3.SS2.p4.6.m6.2.2.3" xref="S3.SS2.p4.6.m6.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.6.m6.2.2.3.2" xref="S3.SS2.p4.6.m6.2.2.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.6.m6.2.2.3.1" xref="S3.SS2.p4.6.m6.2.2.3.1.cmml">​</mo><mrow id="S3.SS2.p4.6.m6.2.2.3.3.2" xref="S3.SS2.p4.6.m6.2.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p4.6.m6.2.2.3.3.2.1" xref="S3.SS2.p4.6.m6.2.2.3.3.1.1.cmml">[</mo><mi id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS2.p4.6.m6.2.2.3.3.2.2" xref="S3.SS2.p4.6.m6.2.2.3.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.SS2.p4.6.m6.2.2.2" xref="S3.SS2.p4.6.m6.2.2.2.cmml">=</mo><mrow id="S3.SS2.p4.6.m6.2.2.1.1" xref="S3.SS2.p4.6.m6.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p4.6.m6.2.2.1.1.2" xref="S3.SS2.p4.6.m6.2.2.1.2.1.cmml">‖</mo><mrow id="S3.SS2.p4.6.m6.2.2.1.1.1" xref="S3.SS2.p4.6.m6.2.2.1.1.1.cmml"><msub id="S3.SS2.p4.6.m6.2.2.1.1.1.2" xref="S3.SS2.p4.6.m6.2.2.1.1.1.2.cmml"><mi id="S3.SS2.p4.6.m6.2.2.1.1.1.2.2" xref="S3.SS2.p4.6.m6.2.2.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS2.p4.6.m6.2.2.1.1.1.2.3" xref="S3.SS2.p4.6.m6.2.2.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p4.6.m6.2.2.1.1.1.1" xref="S3.SS2.p4.6.m6.2.2.1.1.1.1.cmml">−</mo><msub id="S3.SS2.p4.6.m6.2.2.1.1.1.3" xref="S3.SS2.p4.6.m6.2.2.1.1.1.3.cmml"><mi id="S3.SS2.p4.6.m6.2.2.1.1.1.3.2" xref="S3.SS2.p4.6.m6.2.2.1.1.1.3.2.cmml">𝐰</mi><mtext id="S3.SS2.p4.6.m6.2.2.1.1.1.3.3" xref="S3.SS2.p4.6.m6.2.2.1.1.1.3.3a.cmml">avg</mtext></msub></mrow><mo stretchy="false" id="S3.SS2.p4.6.m6.2.2.1.1.3" xref="S3.SS2.p4.6.m6.2.2.1.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.2b"><apply id="S3.SS2.p4.6.m6.2.2.cmml" xref="S3.SS2.p4.6.m6.2.2"><eq id="S3.SS2.p4.6.m6.2.2.2.cmml" xref="S3.SS2.p4.6.m6.2.2.2"></eq><apply id="S3.SS2.p4.6.m6.2.2.3.cmml" xref="S3.SS2.p4.6.m6.2.2.3"><times id="S3.SS2.p4.6.m6.2.2.3.1.cmml" xref="S3.SS2.p4.6.m6.2.2.3.1"></times><ci id="S3.SS2.p4.6.m6.2.2.3.2.cmml" xref="S3.SS2.p4.6.m6.2.2.3.2">ℒ</ci><apply id="S3.SS2.p4.6.m6.2.2.3.3.1.cmml" xref="S3.SS2.p4.6.m6.2.2.3.3.2"><csymbol cd="latexml" id="S3.SS2.p4.6.m6.2.2.3.3.1.1.cmml" xref="S3.SS2.p4.6.m6.2.2.3.3.2.1">delimited-[]</csymbol><ci id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">𝑖</ci></apply></apply><apply id="S3.SS2.p4.6.m6.2.2.1.2.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1"><csymbol cd="latexml" id="S3.SS2.p4.6.m6.2.2.1.2.1.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1.2">norm</csymbol><apply id="S3.SS2.p4.6.m6.2.2.1.1.1.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1.1"><minus id="S3.SS2.p4.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1.1.1"></minus><apply id="S3.SS2.p4.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.6.m6.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1.1.2.2">𝐰</ci><ci id="S3.SS2.p4.6.m6.2.2.1.1.1.2.3.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p4.6.m6.2.2.1.1.1.3.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.2.2.1.1.1.3.1.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.6.m6.2.2.1.1.1.3.2.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1.1.3.2">𝐰</ci><ci id="S3.SS2.p4.6.m6.2.2.1.1.1.3.3a.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1.1.3.3"><mtext mathsize="70%" id="S3.SS2.p4.6.m6.2.2.1.1.1.3.3.cmml" xref="S3.SS2.p4.6.m6.2.2.1.1.1.3.3">avg</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.2c">\mathcal{L}[i]=||\mathbf{w}_{i}-\mathbf{w}_{\text{avg}}||</annotation></semantics></math>.
Considering that the first round does not have an average model for reference, to avoid involving any malicious models, instead of computing an averaged model using all local models, we utilize <math id="S3.SS2.p4.7.m7.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.p4.7.m7.1a"><mi id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><ci id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">m</annotation></semantics></math>-Krum 
<cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite> to compute an approximate average model.
It is ideal to involve maximum number of benign local models and avoid polluting the approximate averaged model from any malicious local model.
As the FL server does not know the number of potential malicious clients, we set <math id="S3.SS2.p4.8.m8.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS2.p4.8.m8.1a"><mi id="S3.SS2.p4.8.m8.1.1" xref="S3.SS2.p4.8.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m8.1b"><ci id="S3.SS2.p4.8.m8.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m8.1c">m</annotation></semantics></math> to <math id="S3.SS2.p4.9.m9.1" class="ltx_Math" alttext="|\mathcal{W}|/2" display="inline"><semantics id="S3.SS2.p4.9.m9.1a"><mrow id="S3.SS2.p4.9.m9.1.2" xref="S3.SS2.p4.9.m9.1.2.cmml"><mrow id="S3.SS2.p4.9.m9.1.2.2.2" xref="S3.SS2.p4.9.m9.1.2.2.1.cmml"><mo stretchy="false" id="S3.SS2.p4.9.m9.1.2.2.2.1" xref="S3.SS2.p4.9.m9.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.9.m9.1.1" xref="S3.SS2.p4.9.m9.1.1.cmml">𝒲</mi><mo stretchy="false" id="S3.SS2.p4.9.m9.1.2.2.2.2" xref="S3.SS2.p4.9.m9.1.2.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.p4.9.m9.1.2.1" xref="S3.SS2.p4.9.m9.1.2.1.cmml">/</mo><mn id="S3.SS2.p4.9.m9.1.2.3" xref="S3.SS2.p4.9.m9.1.2.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.9.m9.1b"><apply id="S3.SS2.p4.9.m9.1.2.cmml" xref="S3.SS2.p4.9.m9.1.2"><divide id="S3.SS2.p4.9.m9.1.2.1.cmml" xref="S3.SS2.p4.9.m9.1.2.1"></divide><apply id="S3.SS2.p4.9.m9.1.2.2.1.cmml" xref="S3.SS2.p4.9.m9.1.2.2.2"><abs id="S3.SS2.p4.9.m9.1.2.2.1.1.cmml" xref="S3.SS2.p4.9.m9.1.2.2.2.1"></abs><ci id="S3.SS2.p4.9.m9.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1">𝒲</ci></apply><cn type="integer" id="S3.SS2.p4.9.m9.1.2.3.cmml" xref="S3.SS2.p4.9.m9.1.2.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.9.m9.1c">|\mathcal{W}|/2</annotation></semantics></math> to compute an approximate average model based on the assumption that the number of malicious clients is less than <math id="S3.SS2.p4.10.m10.1" class="ltx_Math" alttext="|\mathcal{W}|/2" display="inline"><semantics id="S3.SS2.p4.10.m10.1a"><mrow id="S3.SS2.p4.10.m10.1.2" xref="S3.SS2.p4.10.m10.1.2.cmml"><mrow id="S3.SS2.p4.10.m10.1.2.2.2" xref="S3.SS2.p4.10.m10.1.2.2.1.cmml"><mo stretchy="false" id="S3.SS2.p4.10.m10.1.2.2.2.1" xref="S3.SS2.p4.10.m10.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.10.m10.1.1" xref="S3.SS2.p4.10.m10.1.1.cmml">𝒲</mi><mo stretchy="false" id="S3.SS2.p4.10.m10.1.2.2.2.2" xref="S3.SS2.p4.10.m10.1.2.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.p4.10.m10.1.2.1" xref="S3.SS2.p4.10.m10.1.2.1.cmml">/</mo><mn id="S3.SS2.p4.10.m10.1.2.3" xref="S3.SS2.p4.10.m10.1.2.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.10.m10.1b"><apply id="S3.SS2.p4.10.m10.1.2.cmml" xref="S3.SS2.p4.10.m10.1.2"><divide id="S3.SS2.p4.10.m10.1.2.1.cmml" xref="S3.SS2.p4.10.m10.1.2.1"></divide><apply id="S3.SS2.p4.10.m10.1.2.2.1.cmml" xref="S3.SS2.p4.10.m10.1.2.2.2"><abs id="S3.SS2.p4.10.m10.1.2.2.1.1.cmml" xref="S3.SS2.p4.10.m10.1.2.2.2.1"></abs><ci id="S3.SS2.p4.10.m10.1.1.cmml" xref="S3.SS2.p4.10.m10.1.1">𝒲</ci></apply><cn type="integer" id="S3.SS2.p4.10.m10.1.2.3.cmml" xref="S3.SS2.p4.10.m10.1.2.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.10.m10.1c">|\mathcal{W}|/2</annotation></semantics></math>, where <math id="S3.SS2.p4.11.m11.1" class="ltx_Math" alttext="|\mathcal{W}|" display="inline"><semantics id="S3.SS2.p4.11.m11.1a"><mrow id="S3.SS2.p4.11.m11.1.2.2" xref="S3.SS2.p4.11.m11.1.2.1.cmml"><mo stretchy="false" id="S3.SS2.p4.11.m11.1.2.2.1" xref="S3.SS2.p4.11.m11.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.11.m11.1.1" xref="S3.SS2.p4.11.m11.1.1.cmml">𝒲</mi><mo stretchy="false" id="S3.SS2.p4.11.m11.1.2.2.2" xref="S3.SS2.p4.11.m11.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.11.m11.1b"><apply id="S3.SS2.p4.11.m11.1.2.1.cmml" xref="S3.SS2.p4.11.m11.1.2.2"><abs id="S3.SS2.p4.11.m11.1.2.1.1.cmml" xref="S3.SS2.p4.11.m11.1.2.2.1"></abs><ci id="S3.SS2.p4.11.m11.1.1.cmml" xref="S3.SS2.p4.11.m11.1.1">𝒲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.11.m11.1c">|\mathcal{W}|</annotation></semantics></math> is the number of clients in each FL round.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2310.04055/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="424" height="96" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.3.2" class="ltx_text" style="font-size:90%;">ZKP circuits for the anomaly detection mechanism</span></figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Optimizations for Reference Models</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">So far the FL server renews and stores entire client models and global models as reference models for the next FL round at the end of each FL round.
However, this approach encounters pragmatic challenges in real-world deployments due to reasons as follows. <span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_italic">i</span>) <span id="S3.SS3.p1.1.2" class="ltx_text ltx_font_italic">Storage Constraints: </span> real-world FL systems often have complex execution environments and restricted storage, which necessitates the algorithm to be optimized for storage and computation efficiency; <span id="S3.SS3.p1.1.3" class="ltx_text ltx_font_italic">ii</span>) <span id="S3.SS3.p1.1.4" class="ltx_text ltx_font_italic">Computational Overhead: </span>incorporating ZKP for validation after each FL iteration (which will be discussed in §<a href="#S4" title="4 Verifiable Anomaly Detection Using ZKP ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) is computationally intensive <cite class="ltx_cite ltx_citemacro_citep">(Goldreich &amp; Krawczyk, <a href="#bib.bib25" title="" class="ltx_ref">1996</a>)</cite>. Utilizing the entire collection of client/global models for computation will increase resource consumption significantly and prolong the verification time in each FL round. Meanwhile, the FL system must await the completion of this verification process before continuing the subsequent operations, which detrimentally impacts the experience of the FL clients.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.2" class="ltx_p">In light of these constraints, we propose using only a segmental model instead of the entire model for reference. The selection of the segmental model follows the following criteria: <span id="S3.SS3.p2.2.1" class="ltx_text ltx_font_italic">i</span>)
the selected fragment should sufficiently represent the full model while minimizing the fragment size, ideally using just one layer of the original reference model. <span id="S3.SS3.p2.2.2" class="ltx_text ltx_font_italic">ii</span>)
the selection mechanism must be applicable to general cases in real-world systems and independent of specific data distributions or model structures.
Note that such a layer is not required to contain the maximal information compared with other layers of the same reference model, but should be more “informative” than the majority of the other layers.
We follow the terminology in <cite class="ltx_cite ltx_citemacro_citep">(Fung et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite> and name such layer as “<span id="S3.SS3.p2.2.3" class="ltx_text ltx_font_italic">importance layer</span>”.
Intuitively, we select the second-to-the-last layer as the importance layer, as it is close to the output layer and thus can retain substantial information.
This method can reduce complexity effectively, especially for ZKP computation. As an example, the second-to-last layer of CNN contains only <math id="S3.SS3.p2.1.m1.2" class="ltx_Math" alttext="7,936" display="inline"><semantics id="S3.SS3.p2.1.m1.2a"><mrow id="S3.SS3.p2.1.m1.2.3.2" xref="S3.SS3.p2.1.m1.2.3.1.cmml"><mn id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">7</mn><mo id="S3.SS3.p2.1.m1.2.3.2.1" xref="S3.SS3.p2.1.m1.2.3.1.cmml">,</mo><mn id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml">936</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.2b"><list id="S3.SS3.p2.1.m1.2.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.2"><cn type="integer" id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">7</cn><cn type="integer" id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2">936</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.2c">7,936</annotation></semantics></math> parameters, compared with <math id="S3.SS3.p2.2.m2.3" class="ltx_Math" alttext="1,199,882" display="inline"><semantics id="S3.SS3.p2.2.m2.3a"><mrow id="S3.SS3.p2.2.m2.3.4.2" xref="S3.SS3.p2.2.m2.3.4.1.cmml"><mn id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">1</mn><mo id="S3.SS3.p2.2.m2.3.4.2.1" xref="S3.SS3.p2.2.m2.3.4.1.cmml">,</mo><mn id="S3.SS3.p2.2.m2.2.2" xref="S3.SS3.p2.2.m2.2.2.cmml">199</mn><mo id="S3.SS3.p2.2.m2.3.4.2.2" xref="S3.SS3.p2.2.m2.3.4.1.cmml">,</mo><mn id="S3.SS3.p2.2.m2.3.3" xref="S3.SS3.p2.2.m2.3.3.cmml">882</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.3b"><list id="S3.SS3.p2.2.m2.3.4.1.cmml" xref="S3.SS3.p2.2.m2.3.4.2"><cn type="integer" id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">1</cn><cn type="integer" id="S3.SS3.p2.2.m2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2">199</cn><cn type="integer" id="S3.SS3.p2.2.m2.3.3.cmml" xref="S3.SS3.p2.2.m2.3.3">882</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.3c">1,199,882</annotation></semantics></math> of the entire model.
The selection of the importance layer will be experimentally validated in <span id="S3.SS3.p2.2.4" class="ltx_text ltx_font_bold">Exp 1</span> in §<a href="#S5" title="5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Verifiable Anomaly Detection Using ZKP</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The ZKP-based verification procedure guarantees trust in the FL system for the benign clients, as the benign clients, while agreeing with removing malicious ones, are skeptical about the removal as that may change the aggregation results. To verify the correct execution of the anomaly detection mechanism at the server,
we utilize zkSNARKs <cite class="ltx_cite ltx_citemacro_citep">(Bitansky et al., <a href="#bib.bib6" title="" class="ltx_ref">2012</a>)</cite> that offers constant proof size and constant verification time regardless of the size of computation. Such property is crucial for applications where the verifier’s (<span id="S4.p1.1.1" class="ltx_text ltx_font_italic">i</span>.<span id="S4.p1.1.2" class="ltx_text ltx_font_italic">e</span>., FL client) resources are limited, <span id="S4.p1.1.3" class="ltx_text ltx_font_italic">e</span>.<span id="S4.p1.1.4" class="ltx_text ltx_font_italic">g</span>., real-world FL systems.
We design ZKP circuits as in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2 Cross-Client Anomaly Detection ‣ 3 Two-Stage Anomaly Detection ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
Details of implementations are in Appendix §<a href="#A2" title="Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>. In what follows, the prover is the FL server, whereas the verifiers are the FL clients.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.1" class="ltx_p"><span id="S4.p2.1.1" class="ltx_text ltx_font_bold">ZKP-compatible Language. </span>
The first challenge of applying ZKP protocols is to convert the computations into a ZKP-compatible language. ZKP protocols model computations as arithmetic circuits with addition and multiplication gates over a prime field. However, our computations for our approach are over real numbers. The second challenge is that some computations such as square root are nonlinear, making it difficult to wire them as a circuit. To address these issues, we implement a class of operations that map real numbers to fixed-point numbers. To build our ZKP scheme, we use Circom library <cite class="ltx_cite ltx_citemacro_citep">(Contributors, <a href="#bib.bib16" title="" class="ltx_ref">2022</a>)</cite>, which compiles the description of an arithmetic circuit in a front-end language similar to C++ to back-end ZKP protocol.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.2" class="ltx_p"><span id="S4.p3.2.1" class="ltx_text ltx_font_bold">ZKP for Anomaly Detection. </span>
Most of the computations in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.1 Cross-Round Detection ‣ 3 Two-Stage Anomaly Detection ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and Algorithm <a href="#alg2" title="Algorithm 2 ‣ 3.2 Cross-Client Anomaly Detection ‣ 3 Two-Stage Anomaly Detection ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> are linear and can be compiled into an arithmetic circuit easily, <span id="S4.p3.2.2" class="ltx_text ltx_font_italic">e</span>.<span id="S4.p3.2.3" class="ltx_text ltx_font_italic">g</span>., computing cosine similarity between two matrices of size <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="n\times n" display="inline"><semantics id="S4.p3.1.m1.1a"><mrow id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mi id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S4.p3.1.m1.1.1.1" xref="S4.p3.1.m1.1.1.1.cmml">×</mo><mi id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><times id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1.1"></times><ci id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2">𝑛</ci><ci id="S4.p3.1.m1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">n\times n</annotation></semantics></math> requires a circuit with <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="O(n^{2})" display="inline"><semantics id="S4.p3.2.m2.1a"><mrow id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><mi id="S4.p3.2.m2.1.1.3" xref="S4.p3.2.m2.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml">​</mo><mrow id="S4.p3.2.m2.1.1.1.1" xref="S4.p3.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p3.2.m2.1.1.1.1.2" xref="S4.p3.2.m2.1.1.1.1.1.cmml">(</mo><msup id="S4.p3.2.m2.1.1.1.1.1" xref="S4.p3.2.m2.1.1.1.1.1.cmml"><mi id="S4.p3.2.m2.1.1.1.1.1.2" xref="S4.p3.2.m2.1.1.1.1.1.2.cmml">n</mi><mn id="S4.p3.2.m2.1.1.1.1.1.3" xref="S4.p3.2.m2.1.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S4.p3.2.m2.1.1.1.1.3" xref="S4.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><times id="S4.p3.2.m2.1.1.2.cmml" xref="S4.p3.2.m2.1.1.2"></times><ci id="S4.p3.2.m2.1.1.3.cmml" xref="S4.p3.2.m2.1.1.3">𝑂</ci><apply id="S4.p3.2.m2.1.1.1.1.1.cmml" xref="S4.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.p3.2.m2.1.1.1.1.1.1.cmml" xref="S4.p3.2.m2.1.1.1.1">superscript</csymbol><ci id="S4.p3.2.m2.1.1.1.1.1.2.cmml" xref="S4.p3.2.m2.1.1.1.1.1.2">𝑛</ci><cn type="integer" id="S4.p3.2.m2.1.1.1.1.1.3.cmml" xref="S4.p3.2.m2.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">O(n^{2})</annotation></semantics></math> multiplication gates and one division. While it is difficult to directly compute division on a circuit, it can be easily verified with the prover providing the pre-computed quotient and remainder beforehand. We can utilize this idea and apply Freivalds’ algorithm <cite class="ltx_cite ltx_citemacro_citep">(Freivalds, <a href="#bib.bib22" title="" class="ltx_ref">1977</a>)</cite> to verify matrix multiplications.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.18" class="ltx_p">Matrix multiplication constitutes the basis of the verification schemes used for anomaly detection. Naively verifying a matrix multiplication <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="AB=C" display="inline"><semantics id="S4.p4.1.m1.1a"><mrow id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml"><mrow id="S4.p4.1.m1.1.1.2" xref="S4.p4.1.m1.1.1.2.cmml"><mi id="S4.p4.1.m1.1.1.2.2" xref="S4.p4.1.m1.1.1.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.p4.1.m1.1.1.2.1" xref="S4.p4.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.p4.1.m1.1.1.2.3" xref="S4.p4.1.m1.1.1.2.3.cmml">B</mi></mrow><mo id="S4.p4.1.m1.1.1.1" xref="S4.p4.1.m1.1.1.1.cmml">=</mo><mi id="S4.p4.1.m1.1.1.3" xref="S4.p4.1.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1"><eq id="S4.p4.1.m1.1.1.1.cmml" xref="S4.p4.1.m1.1.1.1"></eq><apply id="S4.p4.1.m1.1.1.2.cmml" xref="S4.p4.1.m1.1.1.2"><times id="S4.p4.1.m1.1.1.2.1.cmml" xref="S4.p4.1.m1.1.1.2.1"></times><ci id="S4.p4.1.m1.1.1.2.2.cmml" xref="S4.p4.1.m1.1.1.2.2">𝐴</ci><ci id="S4.p4.1.m1.1.1.2.3.cmml" xref="S4.p4.1.m1.1.1.2.3">𝐵</ci></apply><ci id="S4.p4.1.m1.1.1.3.cmml" xref="S4.p4.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">AB=C</annotation></semantics></math> where <math id="S4.p4.2.m2.3" class="ltx_Math" alttext="A,B,C" display="inline"><semantics id="S4.p4.2.m2.3a"><mrow id="S4.p4.2.m2.3.4.2" xref="S4.p4.2.m2.3.4.1.cmml"><mi id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml">A</mi><mo id="S4.p4.2.m2.3.4.2.1" xref="S4.p4.2.m2.3.4.1.cmml">,</mo><mi id="S4.p4.2.m2.2.2" xref="S4.p4.2.m2.2.2.cmml">B</mi><mo id="S4.p4.2.m2.3.4.2.2" xref="S4.p4.2.m2.3.4.1.cmml">,</mo><mi id="S4.p4.2.m2.3.3" xref="S4.p4.2.m2.3.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.3b"><list id="S4.p4.2.m2.3.4.1.cmml" xref="S4.p4.2.m2.3.4.2"><ci id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1">𝐴</ci><ci id="S4.p4.2.m2.2.2.cmml" xref="S4.p4.2.m2.2.2">𝐵</ci><ci id="S4.p4.2.m2.3.3.cmml" xref="S4.p4.2.m2.3.3">𝐶</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.3c">A,B,C</annotation></semantics></math> are of size <math id="S4.p4.3.m3.1" class="ltx_Math" alttext="n\times n" display="inline"><semantics id="S4.p4.3.m3.1a"><mrow id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml"><mi id="S4.p4.3.m3.1.1.2" xref="S4.p4.3.m3.1.1.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S4.p4.3.m3.1.1.1" xref="S4.p4.3.m3.1.1.1.cmml">×</mo><mi id="S4.p4.3.m3.1.1.3" xref="S4.p4.3.m3.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><apply id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1"><times id="S4.p4.3.m3.1.1.1.cmml" xref="S4.p4.3.m3.1.1.1"></times><ci id="S4.p4.3.m3.1.1.2.cmml" xref="S4.p4.3.m3.1.1.2">𝑛</ci><ci id="S4.p4.3.m3.1.1.3.cmml" xref="S4.p4.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">n\times n</annotation></semantics></math> requires proving the computation step by step, which requires <math id="S4.p4.4.m4.1" class="ltx_Math" alttext="O(n^{3})" display="inline"><semantics id="S4.p4.4.m4.1a"><mrow id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml"><mi id="S4.p4.4.m4.1.1.3" xref="S4.p4.4.m4.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S4.p4.4.m4.1.1.2" xref="S4.p4.4.m4.1.1.2.cmml">​</mo><mrow id="S4.p4.4.m4.1.1.1.1" xref="S4.p4.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p4.4.m4.1.1.1.1.2" xref="S4.p4.4.m4.1.1.1.1.1.cmml">(</mo><msup id="S4.p4.4.m4.1.1.1.1.1" xref="S4.p4.4.m4.1.1.1.1.1.cmml"><mi id="S4.p4.4.m4.1.1.1.1.1.2" xref="S4.p4.4.m4.1.1.1.1.1.2.cmml">n</mi><mn id="S4.p4.4.m4.1.1.1.1.1.3" xref="S4.p4.4.m4.1.1.1.1.1.3.cmml">3</mn></msup><mo stretchy="false" id="S4.p4.4.m4.1.1.1.1.3" xref="S4.p4.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><apply id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1"><times id="S4.p4.4.m4.1.1.2.cmml" xref="S4.p4.4.m4.1.1.2"></times><ci id="S4.p4.4.m4.1.1.3.cmml" xref="S4.p4.4.m4.1.1.3">𝑂</ci><apply id="S4.p4.4.m4.1.1.1.1.1.cmml" xref="S4.p4.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.p4.4.m4.1.1.1.1.1.1.cmml" xref="S4.p4.4.m4.1.1.1.1">superscript</csymbol><ci id="S4.p4.4.m4.1.1.1.1.1.2.cmml" xref="S4.p4.4.m4.1.1.1.1.1.2">𝑛</ci><cn type="integer" id="S4.p4.4.m4.1.1.1.1.1.3.cmml" xref="S4.p4.4.m4.1.1.1.1.1.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">O(n^{3})</annotation></semantics></math> multiplication gates. With Freivalds’ algorithm, the prover first computes the result off-circuit and commits to it. Then, the verifier generates a random vector <math id="S4.p4.5.m5.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S4.p4.5.m5.1a"><mi id="S4.p4.5.m5.1.1" xref="S4.p4.5.m5.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.p4.5.m5.1b"><ci id="S4.p4.5.m5.1.1.cmml" xref="S4.p4.5.m5.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m5.1c">v</annotation></semantics></math> of length <math id="S4.p4.6.m6.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.p4.6.m6.1a"><mi id="S4.p4.6.m6.1.1" xref="S4.p4.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.p4.6.m6.1b"><ci id="S4.p4.6.m6.1.1.cmml" xref="S4.p4.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.m6.1c">n</annotation></semantics></math>, and checks <math id="S4.p4.7.m7.1" class="ltx_Math" alttext="A(Bv)\stackrel{{\scriptstyle?}}{{=}}Cv" display="inline"><semantics id="S4.p4.7.m7.1a"><mrow id="S4.p4.7.m7.1.1" xref="S4.p4.7.m7.1.1.cmml"><mrow id="S4.p4.7.m7.1.1.1" xref="S4.p4.7.m7.1.1.1.cmml"><mi id="S4.p4.7.m7.1.1.1.3" xref="S4.p4.7.m7.1.1.1.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.p4.7.m7.1.1.1.2" xref="S4.p4.7.m7.1.1.1.2.cmml">​</mo><mrow id="S4.p4.7.m7.1.1.1.1.1" xref="S4.p4.7.m7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p4.7.m7.1.1.1.1.1.2" xref="S4.p4.7.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p4.7.m7.1.1.1.1.1.1" xref="S4.p4.7.m7.1.1.1.1.1.1.cmml"><mi id="S4.p4.7.m7.1.1.1.1.1.1.2" xref="S4.p4.7.m7.1.1.1.1.1.1.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S4.p4.7.m7.1.1.1.1.1.1.1" xref="S4.p4.7.m7.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.p4.7.m7.1.1.1.1.1.1.3" xref="S4.p4.7.m7.1.1.1.1.1.1.3.cmml">v</mi></mrow><mo stretchy="false" id="S4.p4.7.m7.1.1.1.1.1.3" xref="S4.p4.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mover id="S4.p4.7.m7.1.1.2" xref="S4.p4.7.m7.1.1.2.cmml"><mo id="S4.p4.7.m7.1.1.2.2" xref="S4.p4.7.m7.1.1.2.2.cmml">=</mo><mi mathvariant="normal" id="S4.p4.7.m7.1.1.2.3" xref="S4.p4.7.m7.1.1.2.3.cmml">?</mi></mover><mrow id="S4.p4.7.m7.1.1.3" xref="S4.p4.7.m7.1.1.3.cmml"><mi id="S4.p4.7.m7.1.1.3.2" xref="S4.p4.7.m7.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.p4.7.m7.1.1.3.1" xref="S4.p4.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.p4.7.m7.1.1.3.3" xref="S4.p4.7.m7.1.1.3.3.cmml">v</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.7.m7.1b"><apply id="S4.p4.7.m7.1.1.cmml" xref="S4.p4.7.m7.1.1"><apply id="S4.p4.7.m7.1.1.2.cmml" xref="S4.p4.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.p4.7.m7.1.1.2.1.cmml" xref="S4.p4.7.m7.1.1.2">superscript</csymbol><eq id="S4.p4.7.m7.1.1.2.2.cmml" xref="S4.p4.7.m7.1.1.2.2"></eq><ci id="S4.p4.7.m7.1.1.2.3.cmml" xref="S4.p4.7.m7.1.1.2.3">?</ci></apply><apply id="S4.p4.7.m7.1.1.1.cmml" xref="S4.p4.7.m7.1.1.1"><times id="S4.p4.7.m7.1.1.1.2.cmml" xref="S4.p4.7.m7.1.1.1.2"></times><ci id="S4.p4.7.m7.1.1.1.3.cmml" xref="S4.p4.7.m7.1.1.1.3">𝐴</ci><apply id="S4.p4.7.m7.1.1.1.1.1.1.cmml" xref="S4.p4.7.m7.1.1.1.1.1"><times id="S4.p4.7.m7.1.1.1.1.1.1.1.cmml" xref="S4.p4.7.m7.1.1.1.1.1.1.1"></times><ci id="S4.p4.7.m7.1.1.1.1.1.1.2.cmml" xref="S4.p4.7.m7.1.1.1.1.1.1.2">𝐵</ci><ci id="S4.p4.7.m7.1.1.1.1.1.1.3.cmml" xref="S4.p4.7.m7.1.1.1.1.1.1.3">𝑣</ci></apply></apply><apply id="S4.p4.7.m7.1.1.3.cmml" xref="S4.p4.7.m7.1.1.3"><times id="S4.p4.7.m7.1.1.3.1.cmml" xref="S4.p4.7.m7.1.1.3.1"></times><ci id="S4.p4.7.m7.1.1.3.2.cmml" xref="S4.p4.7.m7.1.1.3.2">𝐶</ci><ci id="S4.p4.7.m7.1.1.3.3.cmml" xref="S4.p4.7.m7.1.1.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.7.m7.1c">A(Bv)\stackrel{{\scriptstyle?}}{{=}}Cv</annotation></semantics></math>. This approach reduces the size of the circuit to <math id="S4.p4.8.m8.1" class="ltx_Math" alttext="O(n^{2})" display="inline"><semantics id="S4.p4.8.m8.1a"><mrow id="S4.p4.8.m8.1.1" xref="S4.p4.8.m8.1.1.cmml"><mi id="S4.p4.8.m8.1.1.3" xref="S4.p4.8.m8.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S4.p4.8.m8.1.1.2" xref="S4.p4.8.m8.1.1.2.cmml">​</mo><mrow id="S4.p4.8.m8.1.1.1.1" xref="S4.p4.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p4.8.m8.1.1.1.1.2" xref="S4.p4.8.m8.1.1.1.1.1.cmml">(</mo><msup id="S4.p4.8.m8.1.1.1.1.1" xref="S4.p4.8.m8.1.1.1.1.1.cmml"><mi id="S4.p4.8.m8.1.1.1.1.1.2" xref="S4.p4.8.m8.1.1.1.1.1.2.cmml">n</mi><mn id="S4.p4.8.m8.1.1.1.1.1.3" xref="S4.p4.8.m8.1.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S4.p4.8.m8.1.1.1.1.3" xref="S4.p4.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.8.m8.1b"><apply id="S4.p4.8.m8.1.1.cmml" xref="S4.p4.8.m8.1.1"><times id="S4.p4.8.m8.1.1.2.cmml" xref="S4.p4.8.m8.1.1.2"></times><ci id="S4.p4.8.m8.1.1.3.cmml" xref="S4.p4.8.m8.1.1.3">𝑂</ci><apply id="S4.p4.8.m8.1.1.1.1.1.cmml" xref="S4.p4.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S4.p4.8.m8.1.1.1.1.1.1.cmml" xref="S4.p4.8.m8.1.1.1.1">superscript</csymbol><ci id="S4.p4.8.m8.1.1.1.1.1.2.cmml" xref="S4.p4.8.m8.1.1.1.1.1.2">𝑛</ci><cn type="integer" id="S4.p4.8.m8.1.1.1.1.1.3.cmml" xref="S4.p4.8.m8.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.8.m8.1c">O(n^{2})</annotation></semantics></math>.
We exploit this idea to design an efficient protocol for square root for Algorithm <a href="#alg2" title="Algorithm 2 ‣ 3.2 Cross-Client Anomaly Detection ‣ 3 Two-Stage Anomaly Detection ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. To verify that <math id="S4.p4.9.m9.1" class="ltx_Math" alttext="x=\sqrt{y}" display="inline"><semantics id="S4.p4.9.m9.1a"><mrow id="S4.p4.9.m9.1.1" xref="S4.p4.9.m9.1.1.cmml"><mi id="S4.p4.9.m9.1.1.2" xref="S4.p4.9.m9.1.1.2.cmml">x</mi><mo id="S4.p4.9.m9.1.1.1" xref="S4.p4.9.m9.1.1.1.cmml">=</mo><msqrt id="S4.p4.9.m9.1.1.3" xref="S4.p4.9.m9.1.1.3.cmml"><mi id="S4.p4.9.m9.1.1.3.2" xref="S4.p4.9.m9.1.1.3.2.cmml">y</mi></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.9.m9.1b"><apply id="S4.p4.9.m9.1.1.cmml" xref="S4.p4.9.m9.1.1"><eq id="S4.p4.9.m9.1.1.1.cmml" xref="S4.p4.9.m9.1.1.1"></eq><ci id="S4.p4.9.m9.1.1.2.cmml" xref="S4.p4.9.m9.1.1.2">𝑥</ci><apply id="S4.p4.9.m9.1.1.3.cmml" xref="S4.p4.9.m9.1.1.3"><root id="S4.p4.9.m9.1.1.3a.cmml" xref="S4.p4.9.m9.1.1.3"></root><ci id="S4.p4.9.m9.1.1.3.2.cmml" xref="S4.p4.9.m9.1.1.3.2">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.9.m9.1c">x=\sqrt{y}</annotation></semantics></math> is computed correctly, we ask the prover to provide the answer <math id="S4.p4.10.m10.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.p4.10.m10.1a"><mi id="S4.p4.10.m10.1.1" xref="S4.p4.10.m10.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.p4.10.m10.1b"><ci id="S4.p4.10.m10.1.1.cmml" xref="S4.p4.10.m10.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.10.m10.1c">x</annotation></semantics></math> as witness and then we check in the ZKP that <math id="S4.p4.11.m11.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.p4.11.m11.1a"><mi id="S4.p4.11.m11.1.1" xref="S4.p4.11.m11.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.p4.11.m11.1b"><ci id="S4.p4.11.m11.1.1.cmml" xref="S4.p4.11.m11.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.11.m11.1c">x</annotation></semantics></math> is indeed the square root of <math id="S4.p4.12.m12.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S4.p4.12.m12.1a"><mi id="S4.p4.12.m12.1.1" xref="S4.p4.12.m12.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.p4.12.m12.1b"><ci id="S4.p4.12.m12.1.1.cmml" xref="S4.p4.12.m12.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.12.m12.1c">y</annotation></semantics></math>. Note that we cannot check <math id="S4.p4.13.m13.1" class="ltx_Math" alttext="x^{2}" display="inline"><semantics id="S4.p4.13.m13.1a"><msup id="S4.p4.13.m13.1.1" xref="S4.p4.13.m13.1.1.cmml"><mi id="S4.p4.13.m13.1.1.2" xref="S4.p4.13.m13.1.1.2.cmml">x</mi><mn id="S4.p4.13.m13.1.1.3" xref="S4.p4.13.m13.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S4.p4.13.m13.1b"><apply id="S4.p4.13.m13.1.1.cmml" xref="S4.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S4.p4.13.m13.1.1.1.cmml" xref="S4.p4.13.m13.1.1">superscript</csymbol><ci id="S4.p4.13.m13.1.1.2.cmml" xref="S4.p4.13.m13.1.1.2">𝑥</ci><cn type="integer" id="S4.p4.13.m13.1.1.3.cmml" xref="S4.p4.13.m13.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.13.m13.1c">x^{2}</annotation></semantics></math> is equal to <math id="S4.p4.14.m14.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S4.p4.14.m14.1a"><mi id="S4.p4.14.m14.1.1" xref="S4.p4.14.m14.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.p4.14.m14.1b"><ci id="S4.p4.14.m14.1.1.cmml" xref="S4.p4.14.m14.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.14.m14.1c">y</annotation></semantics></math> because zkSNARK works over the prime field and the square root of an input number might not exist. Therefore, we check if <math id="S4.p4.15.m15.1" class="ltx_Math" alttext="x^{2}" display="inline"><semantics id="S4.p4.15.m15.1a"><msup id="S4.p4.15.m15.1.1" xref="S4.p4.15.m15.1.1.cmml"><mi id="S4.p4.15.m15.1.1.2" xref="S4.p4.15.m15.1.1.2.cmml">x</mi><mn id="S4.p4.15.m15.1.1.3" xref="S4.p4.15.m15.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S4.p4.15.m15.1b"><apply id="S4.p4.15.m15.1.1.cmml" xref="S4.p4.15.m15.1.1"><csymbol cd="ambiguous" id="S4.p4.15.m15.1.1.1.cmml" xref="S4.p4.15.m15.1.1">superscript</csymbol><ci id="S4.p4.15.m15.1.1.2.cmml" xref="S4.p4.15.m15.1.1.2">𝑥</ci><cn type="integer" id="S4.p4.15.m15.1.1.3.cmml" xref="S4.p4.15.m15.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.15.m15.1c">x^{2}</annotation></semantics></math> is close to <math id="S4.p4.16.m16.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S4.p4.16.m16.1a"><mi id="S4.p4.16.m16.1.1" xref="S4.p4.16.m16.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.p4.16.m16.1b"><ci id="S4.p4.16.m16.1.1.cmml" xref="S4.p4.16.m16.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.16.m16.1c">y</annotation></semantics></math> by checking that <math id="S4.p4.17.m17.1" class="ltx_Math" alttext="x^{2}\leq y" display="inline"><semantics id="S4.p4.17.m17.1a"><mrow id="S4.p4.17.m17.1.1" xref="S4.p4.17.m17.1.1.cmml"><msup id="S4.p4.17.m17.1.1.2" xref="S4.p4.17.m17.1.1.2.cmml"><mi id="S4.p4.17.m17.1.1.2.2" xref="S4.p4.17.m17.1.1.2.2.cmml">x</mi><mn id="S4.p4.17.m17.1.1.2.3" xref="S4.p4.17.m17.1.1.2.3.cmml">2</mn></msup><mo id="S4.p4.17.m17.1.1.1" xref="S4.p4.17.m17.1.1.1.cmml">≤</mo><mi id="S4.p4.17.m17.1.1.3" xref="S4.p4.17.m17.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.17.m17.1b"><apply id="S4.p4.17.m17.1.1.cmml" xref="S4.p4.17.m17.1.1"><leq id="S4.p4.17.m17.1.1.1.cmml" xref="S4.p4.17.m17.1.1.1"></leq><apply id="S4.p4.17.m17.1.1.2.cmml" xref="S4.p4.17.m17.1.1.2"><csymbol cd="ambiguous" id="S4.p4.17.m17.1.1.2.1.cmml" xref="S4.p4.17.m17.1.1.2">superscript</csymbol><ci id="S4.p4.17.m17.1.1.2.2.cmml" xref="S4.p4.17.m17.1.1.2.2">𝑥</ci><cn type="integer" id="S4.p4.17.m17.1.1.2.3.cmml" xref="S4.p4.17.m17.1.1.2.3">2</cn></apply><ci id="S4.p4.17.m17.1.1.3.cmml" xref="S4.p4.17.m17.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.17.m17.1c">x^{2}\leq y</annotation></semantics></math> and <math id="S4.p4.18.m18.1" class="ltx_Math" alttext="(x+1)^{2}\geq y" display="inline"><semantics id="S4.p4.18.m18.1a"><mrow id="S4.p4.18.m18.1.1" xref="S4.p4.18.m18.1.1.cmml"><msup id="S4.p4.18.m18.1.1.1" xref="S4.p4.18.m18.1.1.1.cmml"><mrow id="S4.p4.18.m18.1.1.1.1.1" xref="S4.p4.18.m18.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p4.18.m18.1.1.1.1.1.2" xref="S4.p4.18.m18.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p4.18.m18.1.1.1.1.1.1" xref="S4.p4.18.m18.1.1.1.1.1.1.cmml"><mi id="S4.p4.18.m18.1.1.1.1.1.1.2" xref="S4.p4.18.m18.1.1.1.1.1.1.2.cmml">x</mi><mo id="S4.p4.18.m18.1.1.1.1.1.1.1" xref="S4.p4.18.m18.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.p4.18.m18.1.1.1.1.1.1.3" xref="S4.p4.18.m18.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.p4.18.m18.1.1.1.1.1.3" xref="S4.p4.18.m18.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.p4.18.m18.1.1.1.3" xref="S4.p4.18.m18.1.1.1.3.cmml">2</mn></msup><mo id="S4.p4.18.m18.1.1.2" xref="S4.p4.18.m18.1.1.2.cmml">≥</mo><mi id="S4.p4.18.m18.1.1.3" xref="S4.p4.18.m18.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.18.m18.1b"><apply id="S4.p4.18.m18.1.1.cmml" xref="S4.p4.18.m18.1.1"><geq id="S4.p4.18.m18.1.1.2.cmml" xref="S4.p4.18.m18.1.1.2"></geq><apply id="S4.p4.18.m18.1.1.1.cmml" xref="S4.p4.18.m18.1.1.1"><csymbol cd="ambiguous" id="S4.p4.18.m18.1.1.1.2.cmml" xref="S4.p4.18.m18.1.1.1">superscript</csymbol><apply id="S4.p4.18.m18.1.1.1.1.1.1.cmml" xref="S4.p4.18.m18.1.1.1.1.1"><plus id="S4.p4.18.m18.1.1.1.1.1.1.1.cmml" xref="S4.p4.18.m18.1.1.1.1.1.1.1"></plus><ci id="S4.p4.18.m18.1.1.1.1.1.1.2.cmml" xref="S4.p4.18.m18.1.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="S4.p4.18.m18.1.1.1.1.1.1.3.cmml" xref="S4.p4.18.m18.1.1.1.1.1.1.3">1</cn></apply><cn type="integer" id="S4.p4.18.m18.1.1.1.3.cmml" xref="S4.p4.18.m18.1.1.1.3">2</cn></apply><ci id="S4.p4.18.m18.1.1.3.cmml" xref="S4.p4.18.m18.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.18.m18.1c">(x+1)^{2}\geq y</annotation></semantics></math>. This approach reduces the computation of square root to 2 multiplication and 2 comparison.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Evaluations</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p"><span id="S5.p1.1.1" class="ltx_text ltx_font_bold">Experimental Setting.</span> A summary of datasets and models for evaluations can be found in Table <a href="#S5.T2" title="Table 2 ‣ 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. By default, we employ CNN and the non-i.i.d. FEMNIST dataset (partition parameter <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S5.p1.1.m1.1a"><mrow id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">α</mi><mo id="S5.p1.1.m1.1.1.1" xref="S5.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><eq id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1.1"></eq><ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">\alpha=0.5</annotation></semantics></math>), as the non-i.i.d. setting closely captures real-world scenarios. We utilize FedAVG in our experiments.
By default, we use 10 clients for FL training, corresponding to real-world FL applications where the number of clients is typically less than 10, especially in ToB scenarios. We also increase the number of clients to 20 in the real-world experiment, where we utilize edge devices from the Theta network <cite class="ltx_cite ltx_citemacro_citep">(Theta Network., <a href="#bib.bib54" title="" class="ltx_ref">2023</a>)</cite> (<span id="S5.p1.1.2" class="ltx_text ltx_font_bold">Exp 7</span>).
Evaluations for anomaly detection are conducted on a server with 8 NVIDIA A100-SXM4-80GB GPUs, and evaluations for ZKP are conducted on Amazon AWS with an m5a.4xlarge instance with 16 CPU cores and 32 GB memory. We implement the ZKP system in Circom <cite class="ltx_cite ltx_citemacro_citep">(Contributors, <a href="#bib.bib16" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S5.T2.3.2" class="ltx_text" style="font-size:90%;">Models and datasets.</span></figcaption>
<br class="ltx_break">
<table id="S5.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.4.1.1" class="ltx_tr">
<th id="S5.T2.4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T2.4.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Dataset</span></th>
<th id="S5.T2.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T2.4.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Model</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.4.2.1" class="ltx_tr">
<td id="S5.T2.4.2.1.1" class="ltx_td ltx_align_center ltx_border_t">
<span id="S5.T2.4.2.1.1.1" class="ltx_text" style="font-size:70%;">FEMNIST </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T2.4.2.1.1.2.1" class="ltx_text" style="font-size:70%;">(</span>Caldas et al.<span id="S5.T2.4.2.1.1.3.2.1.1" class="ltx_text" style="font-size:70%;">, </span><a href="#bib.bib9" title="" class="ltx_ref">2018</a><span id="S5.T2.4.2.1.1.4.3" class="ltx_text" style="font-size:70%;">)</span></cite>
</td>
<td id="S5.T2.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="S5.T2.4.2.1.2.1" class="ltx_text" style="font-size:70%;">CNN </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T2.4.2.1.2.2.1" class="ltx_text" style="font-size:70%;">(</span>McMahan et al.<span id="S5.T2.4.2.1.2.3.2.1.1" class="ltx_text" style="font-size:70%;">, </span><a href="#bib.bib43" title="" class="ltx_ref">2017a</a><span id="S5.T2.4.2.1.2.4.3" class="ltx_text" style="font-size:70%;">)</span></cite>
</td>
</tr>
<tr id="S5.T2.4.3.2" class="ltx_tr">
<td id="S5.T2.4.3.2.1" class="ltx_td ltx_align_center">
<span id="S5.T2.4.3.2.1.1" class="ltx_text" style="font-size:70%;">Cifar10 </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T2.4.3.2.1.2.1" class="ltx_text" style="font-size:70%;">(</span>Krizhevsky et al.<span id="S5.T2.4.3.2.1.3.2.1.1" class="ltx_text" style="font-size:70%;">, </span><a href="#bib.bib36" title="" class="ltx_ref">2009</a><span id="S5.T2.4.3.2.1.4.3" class="ltx_text" style="font-size:70%;">)</span></cite>
</td>
<td id="S5.T2.4.3.2.2" class="ltx_td ltx_align_center">
<span id="S5.T2.4.3.2.2.1" class="ltx_text" style="font-size:70%;">ResNet20 </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T2.4.3.2.2.2.1" class="ltx_text" style="font-size:70%;">(</span>He et al.<span id="S5.T2.4.3.2.2.3.2.1.1" class="ltx_text" style="font-size:70%;">, </span><a href="#bib.bib31" title="" class="ltx_ref">2016</a><span id="S5.T2.4.3.2.2.4.3" class="ltx_text" style="font-size:70%;">)</span></cite>
</td>
</tr>
<tr id="S5.T2.4.4.3" class="ltx_tr">
<td id="S5.T2.4.4.3.1" class="ltx_td ltx_align_center">
<span id="S5.T2.4.4.3.1.1" class="ltx_text" style="font-size:70%;">Cifar100 </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T2.4.4.3.1.2.1" class="ltx_text" style="font-size:70%;">(</span>Krizhevsky et al.<span id="S5.T2.4.4.3.1.3.2.1.1" class="ltx_text" style="font-size:70%;">, </span><a href="#bib.bib36" title="" class="ltx_ref">2009</a><span id="S5.T2.4.4.3.1.4.3" class="ltx_text" style="font-size:70%;">)</span></cite>
</td>
<td id="S5.T2.4.4.3.2" class="ltx_td ltx_align_center">
<span id="S5.T2.4.4.3.2.1" class="ltx_text" style="font-size:70%;">ResNet56 </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T2.4.4.3.2.2.1" class="ltx_text" style="font-size:70%;">(</span>He et al.<span id="S5.T2.4.4.3.2.3.2.1.1" class="ltx_text" style="font-size:70%;">, </span><a href="#bib.bib31" title="" class="ltx_ref">2016</a><span id="S5.T2.4.4.3.2.4.3" class="ltx_text" style="font-size:70%;">)</span></cite>
</td>
</tr>
<tr id="S5.T2.4.5.4" class="ltx_tr">
<td id="S5.T2.4.5.4.1" class="ltx_td ltx_align_center">
<span id="S5.T2.4.5.4.1.1" class="ltx_text" style="font-size:70%;">Shakespeare </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T2.4.5.4.1.2.1" class="ltx_text" style="font-size:70%;">(</span>McMahan et al.<span id="S5.T2.4.5.4.1.3.2.1.1" class="ltx_text" style="font-size:70%;">, </span><a href="#bib.bib44" title="" class="ltx_ref">2017b</a><span id="S5.T2.4.5.4.1.4.3" class="ltx_text" style="font-size:70%;">)</span></cite>
</td>
<td id="S5.T2.4.5.4.2" class="ltx_td ltx_align_center">
<span id="S5.T2.4.5.4.2.1" class="ltx_text" style="font-size:70%;">RNN </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T2.4.5.4.2.2.1" class="ltx_text" style="font-size:70%;">(</span>McMahan et al.<span id="S5.T2.4.5.4.2.3.2.1.1" class="ltx_text" style="font-size:70%;">, </span><a href="#bib.bib43" title="" class="ltx_ref">2017a</a><span id="S5.T2.4.5.4.2.4.3" class="ltx_text" style="font-size:70%;">)</span></cite>
</td>
</tr>
<tr id="S5.T2.4.6.5" class="ltx_tr">
<td id="S5.T2.4.6.5.1" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.4.6.5.1.1" class="ltx_text" style="font-size:70%;">MNIST </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T2.4.6.5.1.2.1" class="ltx_text" style="font-size:70%;">(</span>Deng<span id="S5.T2.4.6.5.1.3.2.1.1" class="ltx_text" style="font-size:70%;">, </span><a href="#bib.bib18" title="" class="ltx_ref">2012</a><span id="S5.T2.4.6.5.1.4.3" class="ltx_text" style="font-size:70%;">)</span></cite>
</td>
<td id="S5.T2.4.6.5.2" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.4.6.5.2.1" class="ltx_text" style="font-size:70%;">LR </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T2.4.6.5.2.2.1" class="ltx_text" style="font-size:70%;">(</span>Cox<span id="S5.T2.4.6.5.2.3.2.1.1" class="ltx_text" style="font-size:70%;">, </span><a href="#bib.bib17" title="" class="ltx_ref">1958</a><span id="S5.T2.4.6.5.2.4.3" class="ltx_text" style="font-size:70%;">)</span></cite>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.3" class="ltx_p"><span id="S5.p2.3.1" class="ltx_text ltx_font_bold">Selection of attacks and defenses. </span>We follow a basic rule when selecting the attacks and defenses, <span id="S5.p2.3.2" class="ltx_text ltx_font_italic">i</span>.<span id="S5.p2.3.3" class="ltx_text ltx_font_italic">e</span>., they have to be practical in real-world systems. The mechanisms have to be easy to apply without requiring unpractical prior knowledge or access control over the entire system.
Based on this rule, we employ two attacks that are widely considered in literature, including a <span id="S5.p2.3.4" class="ltx_text ltx_font_italic">Byzantine attack</span> that randomly modifies the local submissions <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib14" title="" class="ltx_ref">2017</a>; Fang et al., <a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite>, and a <span id="S5.p2.3.5" class="ltx_text ltx_font_italic">backdoor attack</span>, <span id="S5.p2.3.6" class="ltx_text ltx_font_italic">i</span>.<span id="S5.p2.3.7" class="ltx_text ltx_font_italic">e</span>. the model replacement attack <cite class="ltx_cite ltx_citemacro_citep">(Bagdasaryan et al., <a href="#bib.bib3" title="" class="ltx_ref">2020b</a>)</cite>. We utilize three baseline defense mechanisms that can be effective in real systems: <math id="S5.p2.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.p2.1.m1.1a"><mi id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><ci id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">m</annotation></semantics></math>-Krum <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite>, Foolsgold <cite class="ltx_cite ltx_citemacro_citep">(Fung et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>, and RFA <cite class="ltx_cite ltx_citemacro_citep">(Pillutla et al., <a href="#bib.bib47" title="" class="ltx_ref">2022</a>)</cite>. For <math id="S5.p2.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.p2.2.m2.1a"><mi id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b"><ci id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">m</annotation></semantics></math>-Krum, we set <math id="S5.p2.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.p2.3.m3.1a"><mi id="S5.p2.3.m3.1.1" xref="S5.p2.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.p2.3.m3.1b"><ci id="S5.p2.3.m3.1.1.cmml" xref="S5.p2.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.3.m3.1c">m</annotation></semantics></math> to 5, which means 5 out of 10 submitted local models participate in aggregation in each FL training round.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.13" class="ltx_p"><span id="S5.p3.13.1" class="ltx_text ltx_font_bold">Evaluation Metrics. </span>By default, the results are evaluated with the accuracy of the global model.
We evaluate the effectiveness of cross-round check using <span id="S5.p3.13.2" class="ltx_text ltx_font_italic">cross-round detection success rate</span>, defined by the proportion of iterations where the algorithm correctly detects cases with or without an attack relative to the number of total FL iterations. A 100% cross-round success rate indicates that all FL rounds that potential attacks might have happened are detected, and none of the benign cases are identified as “attacks” by mistake. We evaluate the quality of cross-client detection using modified Positive Predictive Values (PPV) <cite class="ltx_cite ltx_citemacro_citep">(Fletcher, <a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite>, the proportions of positive results in statistics and diagnostic tests that are true positive results. Let us denote the number of true positive and the false positive results to be <math id="S5.p3.1.m1.1" class="ltx_Math" alttext="N_{\mathit{TP}}" display="inline"><semantics id="S5.p3.1.m1.1a"><msub id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml"><mi id="S5.p3.1.m1.1.1.2" xref="S5.p3.1.m1.1.1.2.cmml">N</mi><mi id="S5.p3.1.m1.1.1.3" xref="S5.p3.1.m1.1.1.3.cmml">𝑇𝑃</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><apply id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p3.1.m1.1.1.1.cmml" xref="S5.p3.1.m1.1.1">subscript</csymbol><ci id="S5.p3.1.m1.1.1.2.cmml" xref="S5.p3.1.m1.1.1.2">𝑁</ci><ci id="S5.p3.1.m1.1.1.3.cmml" xref="S5.p3.1.m1.1.1.3">𝑇𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">N_{\mathit{TP}}</annotation></semantics></math> and <math id="S5.p3.2.m2.1" class="ltx_Math" alttext="N_{\mathit{FP}}" display="inline"><semantics id="S5.p3.2.m2.1a"><msub id="S5.p3.2.m2.1.1" xref="S5.p3.2.m2.1.1.cmml"><mi id="S5.p3.2.m2.1.1.2" xref="S5.p3.2.m2.1.1.2.cmml">N</mi><mi id="S5.p3.2.m2.1.1.3" xref="S5.p3.2.m2.1.1.3.cmml">𝐹𝑃</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p3.2.m2.1b"><apply id="S5.p3.2.m2.1.1.cmml" xref="S5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p3.2.m2.1.1.1.cmml" xref="S5.p3.2.m2.1.1">subscript</csymbol><ci id="S5.p3.2.m2.1.1.2.cmml" xref="S5.p3.2.m2.1.1.2">𝑁</ci><ci id="S5.p3.2.m2.1.1.3.cmml" xref="S5.p3.2.m2.1.1.3">𝐹𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.2.m2.1c">N_{\mathit{FP}}</annotation></semantics></math>, respectively, then <math id="S5.p3.3.m3.1" class="ltx_Math" alttext="\mathit{PPV}=\frac{N_{\mathit{TP}}}{N_{\mathit{TP}}+N_{\mathit{FP}}}" display="inline"><semantics id="S5.p3.3.m3.1a"><mrow id="S5.p3.3.m3.1.1" xref="S5.p3.3.m3.1.1.cmml"><mi id="S5.p3.3.m3.1.1.2" xref="S5.p3.3.m3.1.1.2.cmml">𝑃𝑃𝑉</mi><mo id="S5.p3.3.m3.1.1.1" xref="S5.p3.3.m3.1.1.1.cmml">=</mo><mfrac id="S5.p3.3.m3.1.1.3" xref="S5.p3.3.m3.1.1.3.cmml"><msub id="S5.p3.3.m3.1.1.3.2" xref="S5.p3.3.m3.1.1.3.2.cmml"><mi id="S5.p3.3.m3.1.1.3.2.2" xref="S5.p3.3.m3.1.1.3.2.2.cmml">N</mi><mi id="S5.p3.3.m3.1.1.3.2.3" xref="S5.p3.3.m3.1.1.3.2.3.cmml">𝑇𝑃</mi></msub><mrow id="S5.p3.3.m3.1.1.3.3" xref="S5.p3.3.m3.1.1.3.3.cmml"><msub id="S5.p3.3.m3.1.1.3.3.2" xref="S5.p3.3.m3.1.1.3.3.2.cmml"><mi id="S5.p3.3.m3.1.1.3.3.2.2" xref="S5.p3.3.m3.1.1.3.3.2.2.cmml">N</mi><mi id="S5.p3.3.m3.1.1.3.3.2.3" xref="S5.p3.3.m3.1.1.3.3.2.3.cmml">𝑇𝑃</mi></msub><mo id="S5.p3.3.m3.1.1.3.3.1" xref="S5.p3.3.m3.1.1.3.3.1.cmml">+</mo><msub id="S5.p3.3.m3.1.1.3.3.3" xref="S5.p3.3.m3.1.1.3.3.3.cmml"><mi id="S5.p3.3.m3.1.1.3.3.3.2" xref="S5.p3.3.m3.1.1.3.3.3.2.cmml">N</mi><mi id="S5.p3.3.m3.1.1.3.3.3.3" xref="S5.p3.3.m3.1.1.3.3.3.3.cmml">𝐹𝑃</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.3.m3.1b"><apply id="S5.p3.3.m3.1.1.cmml" xref="S5.p3.3.m3.1.1"><eq id="S5.p3.3.m3.1.1.1.cmml" xref="S5.p3.3.m3.1.1.1"></eq><ci id="S5.p3.3.m3.1.1.2.cmml" xref="S5.p3.3.m3.1.1.2">𝑃𝑃𝑉</ci><apply id="S5.p3.3.m3.1.1.3.cmml" xref="S5.p3.3.m3.1.1.3"><divide id="S5.p3.3.m3.1.1.3.1.cmml" xref="S5.p3.3.m3.1.1.3"></divide><apply id="S5.p3.3.m3.1.1.3.2.cmml" xref="S5.p3.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S5.p3.3.m3.1.1.3.2.1.cmml" xref="S5.p3.3.m3.1.1.3.2">subscript</csymbol><ci id="S5.p3.3.m3.1.1.3.2.2.cmml" xref="S5.p3.3.m3.1.1.3.2.2">𝑁</ci><ci id="S5.p3.3.m3.1.1.3.2.3.cmml" xref="S5.p3.3.m3.1.1.3.2.3">𝑇𝑃</ci></apply><apply id="S5.p3.3.m3.1.1.3.3.cmml" xref="S5.p3.3.m3.1.1.3.3"><plus id="S5.p3.3.m3.1.1.3.3.1.cmml" xref="S5.p3.3.m3.1.1.3.3.1"></plus><apply id="S5.p3.3.m3.1.1.3.3.2.cmml" xref="S5.p3.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S5.p3.3.m3.1.1.3.3.2.1.cmml" xref="S5.p3.3.m3.1.1.3.3.2">subscript</csymbol><ci id="S5.p3.3.m3.1.1.3.3.2.2.cmml" xref="S5.p3.3.m3.1.1.3.3.2.2">𝑁</ci><ci id="S5.p3.3.m3.1.1.3.3.2.3.cmml" xref="S5.p3.3.m3.1.1.3.3.2.3">𝑇𝑃</ci></apply><apply id="S5.p3.3.m3.1.1.3.3.3.cmml" xref="S5.p3.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S5.p3.3.m3.1.1.3.3.3.1.cmml" xref="S5.p3.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S5.p3.3.m3.1.1.3.3.3.2.cmml" xref="S5.p3.3.m3.1.1.3.3.3.2">𝑁</ci><ci id="S5.p3.3.m3.1.1.3.3.3.3.cmml" xref="S5.p3.3.m3.1.1.3.3.3.3">𝐹𝑃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.3.m3.1c">\mathit{PPV}=\frac{N_{\mathit{TP}}}{N_{\mathit{TP}}+N_{\mathit{FP}}}</annotation></semantics></math>. In the context of anomaly detection in FL,
client submissions that are detected as “malicious” and are actually malicious are defined as <span id="S5.p3.13.3" class="ltx_text ltx_font_italic">True</span> <span id="S5.p3.13.4" class="ltx_text ltx_font_italic">Positive</span>, <span id="S5.p3.13.5" class="ltx_text ltx_font_italic">i</span>.<span id="S5.p3.13.6" class="ltx_text ltx_font_italic">e</span>., <math id="S5.p3.4.m4.1" class="ltx_Math" alttext="N_{\mathit{TP}}" display="inline"><semantics id="S5.p3.4.m4.1a"><msub id="S5.p3.4.m4.1.1" xref="S5.p3.4.m4.1.1.cmml"><mi id="S5.p3.4.m4.1.1.2" xref="S5.p3.4.m4.1.1.2.cmml">N</mi><mi id="S5.p3.4.m4.1.1.3" xref="S5.p3.4.m4.1.1.3.cmml">𝑇𝑃</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p3.4.m4.1b"><apply id="S5.p3.4.m4.1.1.cmml" xref="S5.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S5.p3.4.m4.1.1.1.cmml" xref="S5.p3.4.m4.1.1">subscript</csymbol><ci id="S5.p3.4.m4.1.1.2.cmml" xref="S5.p3.4.m4.1.1.2">𝑁</ci><ci id="S5.p3.4.m4.1.1.3.cmml" xref="S5.p3.4.m4.1.1.3">𝑇𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.4.m4.1c">N_{\mathit{TP}}</annotation></semantics></math>, while client submissions that are detected as “malicious” even though they are benign are defined as <span id="S5.p3.13.7" class="ltx_text ltx_font_italic">False</span> <span id="S5.p3.13.8" class="ltx_text ltx_font_italic">Positive</span>, <span id="S5.p3.13.9" class="ltx_text ltx_font_italic">i</span>.<span id="S5.p3.13.10" class="ltx_text ltx_font_italic">e</span>., <math id="S5.p3.5.m5.1" class="ltx_Math" alttext="N_{\mathit{FP}}" display="inline"><semantics id="S5.p3.5.m5.1a"><msub id="S5.p3.5.m5.1.1" xref="S5.p3.5.m5.1.1.cmml"><mi id="S5.p3.5.m5.1.1.2" xref="S5.p3.5.m5.1.1.2.cmml">N</mi><mi id="S5.p3.5.m5.1.1.3" xref="S5.p3.5.m5.1.1.3.cmml">𝐹𝑃</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p3.5.m5.1b"><apply id="S5.p3.5.m5.1.1.cmml" xref="S5.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S5.p3.5.m5.1.1.1.cmml" xref="S5.p3.5.m5.1.1">subscript</csymbol><ci id="S5.p3.5.m5.1.1.2.cmml" xref="S5.p3.5.m5.1.1.2">𝑁</ci><ci id="S5.p3.5.m5.1.1.3.cmml" xref="S5.p3.5.m5.1.1.3">𝐹𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.5.m5.1c">N_{\mathit{FP}}</annotation></semantics></math>.
Since we would like the PPV to reveal the relation between <math id="S5.p3.6.m6.1" class="ltx_Math" alttext="N_{\mathit{TP}}" display="inline"><semantics id="S5.p3.6.m6.1a"><msub id="S5.p3.6.m6.1.1" xref="S5.p3.6.m6.1.1.cmml"><mi id="S5.p3.6.m6.1.1.2" xref="S5.p3.6.m6.1.1.2.cmml">N</mi><mi id="S5.p3.6.m6.1.1.3" xref="S5.p3.6.m6.1.1.3.cmml">𝑇𝑃</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p3.6.m6.1b"><apply id="S5.p3.6.m6.1.1.cmml" xref="S5.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S5.p3.6.m6.1.1.1.cmml" xref="S5.p3.6.m6.1.1">subscript</csymbol><ci id="S5.p3.6.m6.1.1.2.cmml" xref="S5.p3.6.m6.1.1.2">𝑁</ci><ci id="S5.p3.6.m6.1.1.3.cmml" xref="S5.p3.6.m6.1.1.3">𝑇𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.6.m6.1c">N_{\mathit{TP}}</annotation></semantics></math> and the total number of malicious local models across all FL iterations, we introduce the total number of malicious local models across all FL iterations, denoted as <math id="S5.p3.7.m7.1" class="ltx_Math" alttext="N_{\mathit{total}}" display="inline"><semantics id="S5.p3.7.m7.1a"><msub id="S5.p3.7.m7.1.1" xref="S5.p3.7.m7.1.1.cmml"><mi id="S5.p3.7.m7.1.1.2" xref="S5.p3.7.m7.1.1.2.cmml">N</mi><mi id="S5.p3.7.m7.1.1.3" xref="S5.p3.7.m7.1.1.3.cmml">𝑡𝑜𝑡𝑎𝑙</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p3.7.m7.1b"><apply id="S5.p3.7.m7.1.1.cmml" xref="S5.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S5.p3.7.m7.1.1.1.cmml" xref="S5.p3.7.m7.1.1">subscript</csymbol><ci id="S5.p3.7.m7.1.1.2.cmml" xref="S5.p3.7.m7.1.1.2">𝑁</ci><ci id="S5.p3.7.m7.1.1.3.cmml" xref="S5.p3.7.m7.1.1.3">𝑡𝑜𝑡𝑎𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.7.m7.1c">N_{\mathit{total}}</annotation></semantics></math>, to PVV, and compute
a modified PPV as <math id="S5.p3.8.m8.1" class="ltx_Math" alttext="\mathit{PPV}=\frac{N_{\mathit{TP}}}{N_{\mathit{TP}}+N_{\mathit{FP}}+N_{\mathit{total}}}" display="inline"><semantics id="S5.p3.8.m8.1a"><mrow id="S5.p3.8.m8.1.1" xref="S5.p3.8.m8.1.1.cmml"><mi id="S5.p3.8.m8.1.1.2" xref="S5.p3.8.m8.1.1.2.cmml">𝑃𝑃𝑉</mi><mo id="S5.p3.8.m8.1.1.1" xref="S5.p3.8.m8.1.1.1.cmml">=</mo><mfrac id="S5.p3.8.m8.1.1.3" xref="S5.p3.8.m8.1.1.3.cmml"><msub id="S5.p3.8.m8.1.1.3.2" xref="S5.p3.8.m8.1.1.3.2.cmml"><mi id="S5.p3.8.m8.1.1.3.2.2" xref="S5.p3.8.m8.1.1.3.2.2.cmml">N</mi><mi id="S5.p3.8.m8.1.1.3.2.3" xref="S5.p3.8.m8.1.1.3.2.3.cmml">𝑇𝑃</mi></msub><mrow id="S5.p3.8.m8.1.1.3.3" xref="S5.p3.8.m8.1.1.3.3.cmml"><msub id="S5.p3.8.m8.1.1.3.3.2" xref="S5.p3.8.m8.1.1.3.3.2.cmml"><mi id="S5.p3.8.m8.1.1.3.3.2.2" xref="S5.p3.8.m8.1.1.3.3.2.2.cmml">N</mi><mi id="S5.p3.8.m8.1.1.3.3.2.3" xref="S5.p3.8.m8.1.1.3.3.2.3.cmml">𝑇𝑃</mi></msub><mo id="S5.p3.8.m8.1.1.3.3.1" xref="S5.p3.8.m8.1.1.3.3.1.cmml">+</mo><msub id="S5.p3.8.m8.1.1.3.3.3" xref="S5.p3.8.m8.1.1.3.3.3.cmml"><mi id="S5.p3.8.m8.1.1.3.3.3.2" xref="S5.p3.8.m8.1.1.3.3.3.2.cmml">N</mi><mi id="S5.p3.8.m8.1.1.3.3.3.3" xref="S5.p3.8.m8.1.1.3.3.3.3.cmml">𝐹𝑃</mi></msub><mo id="S5.p3.8.m8.1.1.3.3.1a" xref="S5.p3.8.m8.1.1.3.3.1.cmml">+</mo><msub id="S5.p3.8.m8.1.1.3.3.4" xref="S5.p3.8.m8.1.1.3.3.4.cmml"><mi id="S5.p3.8.m8.1.1.3.3.4.2" xref="S5.p3.8.m8.1.1.3.3.4.2.cmml">N</mi><mi id="S5.p3.8.m8.1.1.3.3.4.3" xref="S5.p3.8.m8.1.1.3.3.4.3.cmml">𝑡𝑜𝑡𝑎𝑙</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.8.m8.1b"><apply id="S5.p3.8.m8.1.1.cmml" xref="S5.p3.8.m8.1.1"><eq id="S5.p3.8.m8.1.1.1.cmml" xref="S5.p3.8.m8.1.1.1"></eq><ci id="S5.p3.8.m8.1.1.2.cmml" xref="S5.p3.8.m8.1.1.2">𝑃𝑃𝑉</ci><apply id="S5.p3.8.m8.1.1.3.cmml" xref="S5.p3.8.m8.1.1.3"><divide id="S5.p3.8.m8.1.1.3.1.cmml" xref="S5.p3.8.m8.1.1.3"></divide><apply id="S5.p3.8.m8.1.1.3.2.cmml" xref="S5.p3.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="S5.p3.8.m8.1.1.3.2.1.cmml" xref="S5.p3.8.m8.1.1.3.2">subscript</csymbol><ci id="S5.p3.8.m8.1.1.3.2.2.cmml" xref="S5.p3.8.m8.1.1.3.2.2">𝑁</ci><ci id="S5.p3.8.m8.1.1.3.2.3.cmml" xref="S5.p3.8.m8.1.1.3.2.3">𝑇𝑃</ci></apply><apply id="S5.p3.8.m8.1.1.3.3.cmml" xref="S5.p3.8.m8.1.1.3.3"><plus id="S5.p3.8.m8.1.1.3.3.1.cmml" xref="S5.p3.8.m8.1.1.3.3.1"></plus><apply id="S5.p3.8.m8.1.1.3.3.2.cmml" xref="S5.p3.8.m8.1.1.3.3.2"><csymbol cd="ambiguous" id="S5.p3.8.m8.1.1.3.3.2.1.cmml" xref="S5.p3.8.m8.1.1.3.3.2">subscript</csymbol><ci id="S5.p3.8.m8.1.1.3.3.2.2.cmml" xref="S5.p3.8.m8.1.1.3.3.2.2">𝑁</ci><ci id="S5.p3.8.m8.1.1.3.3.2.3.cmml" xref="S5.p3.8.m8.1.1.3.3.2.3">𝑇𝑃</ci></apply><apply id="S5.p3.8.m8.1.1.3.3.3.cmml" xref="S5.p3.8.m8.1.1.3.3.3"><csymbol cd="ambiguous" id="S5.p3.8.m8.1.1.3.3.3.1.cmml" xref="S5.p3.8.m8.1.1.3.3.3">subscript</csymbol><ci id="S5.p3.8.m8.1.1.3.3.3.2.cmml" xref="S5.p3.8.m8.1.1.3.3.3.2">𝑁</ci><ci id="S5.p3.8.m8.1.1.3.3.3.3.cmml" xref="S5.p3.8.m8.1.1.3.3.3.3">𝐹𝑃</ci></apply><apply id="S5.p3.8.m8.1.1.3.3.4.cmml" xref="S5.p3.8.m8.1.1.3.3.4"><csymbol cd="ambiguous" id="S5.p3.8.m8.1.1.3.3.4.1.cmml" xref="S5.p3.8.m8.1.1.3.3.4">subscript</csymbol><ci id="S5.p3.8.m8.1.1.3.3.4.2.cmml" xref="S5.p3.8.m8.1.1.3.3.4.2">𝑁</ci><ci id="S5.p3.8.m8.1.1.3.3.4.3.cmml" xref="S5.p3.8.m8.1.1.3.3.4.3">𝑡𝑜𝑡𝑎𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.8.m8.1c">\mathit{PPV}=\frac{N_{\mathit{TP}}}{N_{\mathit{TP}}+N_{\mathit{FP}}+N_{\mathit{total}}}</annotation></semantics></math>,
where <math id="S5.p3.9.m9.1" class="ltx_Math" alttext="0\leq\mathit{PPV}\leq\frac{1}{2}" display="inline"><semantics id="S5.p3.9.m9.1a"><mrow id="S5.p3.9.m9.1.1" xref="S5.p3.9.m9.1.1.cmml"><mn id="S5.p3.9.m9.1.1.2" xref="S5.p3.9.m9.1.1.2.cmml">0</mn><mo id="S5.p3.9.m9.1.1.3" xref="S5.p3.9.m9.1.1.3.cmml">≤</mo><mi id="S5.p3.9.m9.1.1.4" xref="S5.p3.9.m9.1.1.4.cmml">𝑃𝑃𝑉</mi><mo id="S5.p3.9.m9.1.1.5" xref="S5.p3.9.m9.1.1.5.cmml">≤</mo><mfrac id="S5.p3.9.m9.1.1.6" xref="S5.p3.9.m9.1.1.6.cmml"><mn id="S5.p3.9.m9.1.1.6.2" xref="S5.p3.9.m9.1.1.6.2.cmml">1</mn><mn id="S5.p3.9.m9.1.1.6.3" xref="S5.p3.9.m9.1.1.6.3.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.9.m9.1b"><apply id="S5.p3.9.m9.1.1.cmml" xref="S5.p3.9.m9.1.1"><and id="S5.p3.9.m9.1.1a.cmml" xref="S5.p3.9.m9.1.1"></and><apply id="S5.p3.9.m9.1.1b.cmml" xref="S5.p3.9.m9.1.1"><leq id="S5.p3.9.m9.1.1.3.cmml" xref="S5.p3.9.m9.1.1.3"></leq><cn type="integer" id="S5.p3.9.m9.1.1.2.cmml" xref="S5.p3.9.m9.1.1.2">0</cn><ci id="S5.p3.9.m9.1.1.4.cmml" xref="S5.p3.9.m9.1.1.4">𝑃𝑃𝑉</ci></apply><apply id="S5.p3.9.m9.1.1c.cmml" xref="S5.p3.9.m9.1.1"><leq id="S5.p3.9.m9.1.1.5.cmml" xref="S5.p3.9.m9.1.1.5"></leq><share href="#S5.p3.9.m9.1.1.4.cmml" id="S5.p3.9.m9.1.1d.cmml" xref="S5.p3.9.m9.1.1"></share><apply id="S5.p3.9.m9.1.1.6.cmml" xref="S5.p3.9.m9.1.1.6"><divide id="S5.p3.9.m9.1.1.6.1.cmml" xref="S5.p3.9.m9.1.1.6"></divide><cn type="integer" id="S5.p3.9.m9.1.1.6.2.cmml" xref="S5.p3.9.m9.1.1.6.2">1</cn><cn type="integer" id="S5.p3.9.m9.1.1.6.3.cmml" xref="S5.p3.9.m9.1.1.6.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.9.m9.1c">0\leq\mathit{PPV}\leq\frac{1}{2}</annotation></semantics></math>. In ideal cases, <math id="S5.p3.10.m10.1" class="ltx_Math" alttext="\mathit{PPV}" display="inline"><semantics id="S5.p3.10.m10.1a"><mi id="S5.p3.10.m10.1.1" xref="S5.p3.10.m10.1.1.cmml">𝑃𝑃𝑉</mi><annotation-xml encoding="MathML-Content" id="S5.p3.10.m10.1b"><ci id="S5.p3.10.m10.1.1.cmml" xref="S5.p3.10.m10.1.1">𝑃𝑃𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.10.m10.1c">\mathit{PPV}</annotation></semantics></math> is <math id="S5.p3.11.m11.1" class="ltx_Math" alttext="\frac{1}{2}" display="inline"><semantics id="S5.p3.11.m11.1a"><mfrac id="S5.p3.11.m11.1.1" xref="S5.p3.11.m11.1.1.cmml"><mn id="S5.p3.11.m11.1.1.2" xref="S5.p3.11.m11.1.1.2.cmml">1</mn><mn id="S5.p3.11.m11.1.1.3" xref="S5.p3.11.m11.1.1.3.cmml">2</mn></mfrac><annotation-xml encoding="MathML-Content" id="S5.p3.11.m11.1b"><apply id="S5.p3.11.m11.1.1.cmml" xref="S5.p3.11.m11.1.1"><divide id="S5.p3.11.m11.1.1.1.cmml" xref="S5.p3.11.m11.1.1"></divide><cn type="integer" id="S5.p3.11.m11.1.1.2.cmml" xref="S5.p3.11.m11.1.1.2">1</cn><cn type="integer" id="S5.p3.11.m11.1.1.3.cmml" xref="S5.p3.11.m11.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.11.m11.1c">\frac{1}{2}</annotation></semantics></math>, where all malicious local models are detected, <span id="S5.p3.13.11" class="ltx_text ltx_font_italic">i</span>.<span id="S5.p3.13.12" class="ltx_text ltx_font_italic">e</span>., <math id="S5.p3.12.m12.1" class="ltx_Math" alttext="N_{\mathit{FP}}=0" display="inline"><semantics id="S5.p3.12.m12.1a"><mrow id="S5.p3.12.m12.1.1" xref="S5.p3.12.m12.1.1.cmml"><msub id="S5.p3.12.m12.1.1.2" xref="S5.p3.12.m12.1.1.2.cmml"><mi id="S5.p3.12.m12.1.1.2.2" xref="S5.p3.12.m12.1.1.2.2.cmml">N</mi><mi id="S5.p3.12.m12.1.1.2.3" xref="S5.p3.12.m12.1.1.2.3.cmml">𝐹𝑃</mi></msub><mo id="S5.p3.12.m12.1.1.1" xref="S5.p3.12.m12.1.1.1.cmml">=</mo><mn id="S5.p3.12.m12.1.1.3" xref="S5.p3.12.m12.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.12.m12.1b"><apply id="S5.p3.12.m12.1.1.cmml" xref="S5.p3.12.m12.1.1"><eq id="S5.p3.12.m12.1.1.1.cmml" xref="S5.p3.12.m12.1.1.1"></eq><apply id="S5.p3.12.m12.1.1.2.cmml" xref="S5.p3.12.m12.1.1.2"><csymbol cd="ambiguous" id="S5.p3.12.m12.1.1.2.1.cmml" xref="S5.p3.12.m12.1.1.2">subscript</csymbol><ci id="S5.p3.12.m12.1.1.2.2.cmml" xref="S5.p3.12.m12.1.1.2.2">𝑁</ci><ci id="S5.p3.12.m12.1.1.2.3.cmml" xref="S5.p3.12.m12.1.1.2.3">𝐹𝑃</ci></apply><cn type="integer" id="S5.p3.12.m12.1.1.3.cmml" xref="S5.p3.12.m12.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.12.m12.1c">N_{\mathit{FP}}=0</annotation></semantics></math> and <math id="S5.p3.13.m13.1" class="ltx_Math" alttext="N_{\mathit{TP}}=N_{\mathit{total}}" display="inline"><semantics id="S5.p3.13.m13.1a"><mrow id="S5.p3.13.m13.1.1" xref="S5.p3.13.m13.1.1.cmml"><msub id="S5.p3.13.m13.1.1.2" xref="S5.p3.13.m13.1.1.2.cmml"><mi id="S5.p3.13.m13.1.1.2.2" xref="S5.p3.13.m13.1.1.2.2.cmml">N</mi><mi id="S5.p3.13.m13.1.1.2.3" xref="S5.p3.13.m13.1.1.2.3.cmml">𝑇𝑃</mi></msub><mo id="S5.p3.13.m13.1.1.1" xref="S5.p3.13.m13.1.1.1.cmml">=</mo><msub id="S5.p3.13.m13.1.1.3" xref="S5.p3.13.m13.1.1.3.cmml"><mi id="S5.p3.13.m13.1.1.3.2" xref="S5.p3.13.m13.1.1.3.2.cmml">N</mi><mi id="S5.p3.13.m13.1.1.3.3" xref="S5.p3.13.m13.1.1.3.3.cmml">𝑡𝑜𝑡𝑎𝑙</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.13.m13.1b"><apply id="S5.p3.13.m13.1.1.cmml" xref="S5.p3.13.m13.1.1"><eq id="S5.p3.13.m13.1.1.1.cmml" xref="S5.p3.13.m13.1.1.1"></eq><apply id="S5.p3.13.m13.1.1.2.cmml" xref="S5.p3.13.m13.1.1.2"><csymbol cd="ambiguous" id="S5.p3.13.m13.1.1.2.1.cmml" xref="S5.p3.13.m13.1.1.2">subscript</csymbol><ci id="S5.p3.13.m13.1.1.2.2.cmml" xref="S5.p3.13.m13.1.1.2.2">𝑁</ci><ci id="S5.p3.13.m13.1.1.2.3.cmml" xref="S5.p3.13.m13.1.1.2.3">𝑇𝑃</ci></apply><apply id="S5.p3.13.m13.1.1.3.cmml" xref="S5.p3.13.m13.1.1.3"><csymbol cd="ambiguous" id="S5.p3.13.m13.1.1.3.1.cmml" xref="S5.p3.13.m13.1.1.3">subscript</csymbol><ci id="S5.p3.13.m13.1.1.3.2.cmml" xref="S5.p3.13.m13.1.1.3.2">𝑁</ci><ci id="S5.p3.13.m13.1.1.3.3.cmml" xref="S5.p3.13.m13.1.1.3.3">𝑡𝑜𝑡𝑎𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.13.m13.1c">N_{\mathit{TP}}=N_{\mathit{total}}</annotation></semantics></math>. The proof is in Appendix <a href="#A1.SS2" title="A.2 Proof of the range of 𝑃𝑃𝑉 ‣ Appendix A Appendix ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a>.</p>
</div>
<div id="S5.p4" class="ltx_para ltx_noindent">
<p id="S5.p4.1" class="ltx_p"><span id="S5.p4.1.1" class="ltx_text ltx_font_bold">Exp 1: Selection of importance layer.</span> We utilize the norm of gradients to evaluate the “sensitivity” of each layer. A layer with a norm higher than most of the other layers indicates higher sensitivity compared with most of the other layers, thus can be utilized to represent the whole model. We evaluate the sensitivity of layers of CNN, RNN, and ResNet56. The results for RNN are in Figure <a href="#S5.F7" title="Figure 7 ‣ 5.1 Cross-Round Check Evaluations ‣ 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, and the results for ResNet56 and CNN are deferred to Figure <a href="#A2.F11" title="Figure 11 ‣ B.2 Supplementary Experiments for Importance Layer ‣ Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> and Figure <a href="#A2.F10" title="Figure 10 ‣ B.2 Supplementary Experiments for Importance Layer ‣ Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> in Appendix §<a href="#A2.SS2" title="B.2 Supplementary Experiments for Importance Layer ‣ Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.2</span></a>, respectively. The results show the sensitivity of the second-to-the-last layer is always higher than most of the other layers, which includes adequate information of the whole model, thus can be selected as the importance layer.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Cross-Round Check Evaluations </h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">To assess the efficiency of the cross-round check in detecting attacks, we set the attack probability to 40% for each FL iteration, where 10 out of the 10 clients are malicious when the attack happens. Ideally, the cross-round check should confirm the absence or presence of an attack accurately.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.4" class="ltx_p"><span id="S5.SS1.p2.4.1" class="ltx_text ltx_font_bold">Exp 2: Impact of the similarity threshold.</span>
We evaluate the impact of the cosine similarity threshold <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">\gamma</annotation></semantics></math> in the cross-round check by setting <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mi id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><ci id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">\gamma</annotation></semantics></math> to 0.5, 0.6, 0.7, 0.8, and 0.9. According to Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.1 Cross-Round Detection ‣ 3 Two-Stage Anomaly Detection ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, a cosine score lower than <math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><mi id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><ci id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">\gamma</annotation></semantics></math> shows lower similarities between the local models and their reference models, indicating the potential occurrence of an attack. As in Figure <a href="#S5.F7" title="Figure 7 ‣ 5.1 Cross-Round Check Evaluations ‣ 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, the cross-round detection success rate is close to 100% in the case of the Byzantine attack. Further, when the cosine similarity threshold <math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><mi id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><ci id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">\gamma</annotation></semantics></math> is set to 0.5, the performance is good in all cases, with at least 93% cross-round detection success rate.</p>
</div>
<figure id="S5.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F7.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:104.1pt;"><img src="/html/2310.04055/assets/figures/rnn_sensitivity.png" id="S5.F7.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="464" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.1.1.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F7.1.2.2" class="ltx_text" style="font-size:90%;">RNN layer sensitivity. </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F7.4" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:104.1pt;"><img src="/html/2310.04055/assets/x4.png" id="S5.F7.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="352" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.4.3.2.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S5.F7.4.2.1" class="ltx_text" style="font-size:90%;">Varying <math id="S5.F7.4.2.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.F7.4.2.1.m1.1b"><mi id="S5.F7.4.2.1.m1.1.1" xref="S5.F7.4.2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.F7.4.2.1.m1.1c"><ci id="S5.F7.4.2.1.m1.1.1.cmml" xref="S5.F7.4.2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.4.2.1.m1.1d">\gamma</annotation></semantics></math>.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F7.5" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:104.1pt;"><img src="/html/2310.04055/assets/figures/vary_dev_num.png" id="S5.F7.5.g1" class="ltx_graphics ltx_img_landscape" width="598" height="464" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.5.1.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S5.F7.5.2.2" class="ltx_text" style="font-size:90%;">Varying # deviations. </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S5.F7.6" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:104.1pt;"><img src="/html/2310.04055/assets/figures/malicious_num_exp.png" id="S5.F7.6.g1" class="ltx_graphics ltx_img_landscape" width="598" height="464" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.6.1.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S5.F7.6.2.2" class="ltx_text" style="font-size:90%;"># malicious clients.</span></figcaption>
</figure>
</div>
</div>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Cross-Client Detection Evaluations </h3>

<figure id="S5.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F8.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.04055/assets/figures/byzantine_random_various_defenses.png" id="S5.F8.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="464" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F8.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F8.sf1.3.2" class="ltx_text" style="font-size:90%;">Byzantine attack.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F8.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.04055/assets/figures/model_replacement_various_defenses.png" id="S5.F8.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="464" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F8.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F8.sf2.3.2" class="ltx_text" style="font-size:90%;">Model replacement attack.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F8.2.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="S5.F8.3.2" class="ltx_text" style="font-size:90%;">Comparisons between defenses</span></figcaption>
</figure>
<figure id="S5.F9" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F9.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.04055/assets/figures/resnet20_exp.png" id="S5.F9.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="464" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F9.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F9.sf1.3.2" class="ltx_text" style="font-size:90%;">ResNet20 &amp; Cifar10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F9.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.04055/assets/figures/resnet56_exp.png" id="S5.F9.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="464" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F9.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F9.sf2.3.2" class="ltx_text" style="font-size:90%;">ResNet56 &amp; Cifar100</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F9.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.04055/assets/figures/nlp_exp.png" id="S5.F9.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="457" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F9.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S5.F9.sf3.3.2" class="ltx_text" style="font-size:90%;">RNN &amp; Shakespeare</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F9.2.1.1" class="ltx_text" style="font-size:90%;">Figure 9</span>: </span><span id="S5.F9.3.2" class="ltx_text" style="font-size:90%;">Evaluations on different tasks against Byzantine attack</span></figcaption>
</figure>
<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.p1.8" class="ltx_p"><span id="S5.SS2.p1.8.1" class="ltx_text ltx_font_bold">Exp 3: Selection of the number of deviations.</span>
We utilize <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathit{PPV}" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">𝑃𝑃𝑉</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝑃𝑃𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\mathit{PPV}</annotation></semantics></math> to evaluate the impact of the number of deviations, <span id="S5.SS2.p1.8.2" class="ltx_text ltx_font_italic">i</span>.<span id="S5.SS2.p1.8.3" class="ltx_text ltx_font_italic">e</span>., the parameter <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><mi id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><ci id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\lambda</annotation></semantics></math> in the anomaly bound <math id="S5.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mu+\lambda\sigma" display="inline"><semantics id="S5.SS2.p1.3.m3.1a"><mrow id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml"><mi id="S5.SS2.p1.3.m3.1.1.2" xref="S5.SS2.p1.3.m3.1.1.2.cmml">μ</mi><mo id="S5.SS2.p1.3.m3.1.1.1" xref="S5.SS2.p1.3.m3.1.1.1.cmml">+</mo><mrow id="S5.SS2.p1.3.m3.1.1.3" xref="S5.SS2.p1.3.m3.1.1.3.cmml"><mi id="S5.SS2.p1.3.m3.1.1.3.2" xref="S5.SS2.p1.3.m3.1.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p1.3.m3.1.1.3.1" xref="S5.SS2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p1.3.m3.1.1.3.3" xref="S5.SS2.p1.3.m3.1.1.3.3.cmml">σ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><apply id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1"><plus id="S5.SS2.p1.3.m3.1.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1.1"></plus><ci id="S5.SS2.p1.3.m3.1.1.2.cmml" xref="S5.SS2.p1.3.m3.1.1.2">𝜇</ci><apply id="S5.SS2.p1.3.m3.1.1.3.cmml" xref="S5.SS2.p1.3.m3.1.1.3"><times id="S5.SS2.p1.3.m3.1.1.3.1.cmml" xref="S5.SS2.p1.3.m3.1.1.3.1"></times><ci id="S5.SS2.p1.3.m3.1.1.3.2.cmml" xref="S5.SS2.p1.3.m3.1.1.3.2">𝜆</ci><ci id="S5.SS2.p1.3.m3.1.1.3.3.cmml" xref="S5.SS2.p1.3.m3.1.1.3.3">𝜎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">\mu+\lambda\sigma</annotation></semantics></math>. To evaluate a challenging case where a large portion of the clients are malicious, we set 4 out of 10 clients to be malicious in each FL training round. Given the number of FL iterations to be 100, the total number of malicious submissions <math id="S5.SS2.p1.4.m4.1" class="ltx_Math" alttext="N_{\mathit{total}}" display="inline"><semantics id="S5.SS2.p1.4.m4.1a"><msub id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml"><mi id="S5.SS2.p1.4.m4.1.1.2" xref="S5.SS2.p1.4.m4.1.1.2.cmml">N</mi><mi id="S5.SS2.p1.4.m4.1.1.3" xref="S5.SS2.p1.4.m4.1.1.3.cmml">𝑡𝑜𝑡𝑎𝑙</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><apply id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS2.p1.4.m4.1.1.2.cmml" xref="S5.SS2.p1.4.m4.1.1.2">𝑁</ci><ci id="S5.SS2.p1.4.m4.1.1.3.cmml" xref="S5.SS2.p1.4.m4.1.1.3">𝑡𝑜𝑡𝑎𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">N_{\mathit{total}}</annotation></semantics></math> is 400.
We set the number of deviations <math id="S5.SS2.p1.5.m5.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p1.5.m5.1a"><mi id="S5.SS2.p1.5.m5.1.1" xref="S5.SS2.p1.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m5.1b"><ci id="S5.SS2.p1.5.m5.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m5.1c">\lambda</annotation></semantics></math> to be 0.5, 1, 1.5, 2, 2.5, and 3. We evaluate our approach on three tasks, as follows: <span id="S5.SS2.p1.8.4" class="ltx_text ltx_font_italic">i</span>) CNN+FEMNIST, <span id="S5.SS2.p1.8.5" class="ltx_text ltx_font_italic">ii</span>) ResNet-56+Cifar100, and <span id="S5.SS2.p1.8.6" class="ltx_text ltx_font_italic">iii</span>) RNN + Shakespeare. The results, as shown in Figure <a href="#S5.F7" title="Figure 7 ‣ 5.1 Cross-Round Check Evaluations ‣ 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, indicate that when <math id="S5.SS2.p1.6.m6.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p1.6.m6.1a"><mi id="S5.SS2.p1.6.m6.1.1" xref="S5.SS2.p1.6.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.6.m6.1b"><ci id="S5.SS2.p1.6.m6.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.6.m6.1c">\lambda</annotation></semantics></math> is 0.5, the results are the best, especially for the random Byzantine attack for all three tasks, where the <math id="S5.SS2.p1.7.m7.1" class="ltx_Math" alttext="\mathit{PPV}" display="inline"><semantics id="S5.SS2.p1.7.m7.1a"><mi id="S5.SS2.p1.7.m7.1.1" xref="S5.SS2.p1.7.m7.1.1.cmml">𝑃𝑃𝑉</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.7.m7.1b"><ci id="S5.SS2.p1.7.m7.1.1.cmml" xref="S5.SS2.p1.7.m7.1.1">𝑃𝑃𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.7.m7.1c">\mathit{PPV}</annotation></semantics></math> being exactly 1/2, indicating all malicious submissions are detected.
In subsequent experiments, unless specified otherwise, we set <math id="S5.SS2.p1.8.m8.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p1.8.m8.1a"><mi id="S5.SS2.p1.8.m8.1.1" xref="S5.SS2.p1.8.m8.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.8.m8.1b"><ci id="S5.SS2.p1.8.m8.1.1.cmml" xref="S5.SS2.p1.8.m8.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.8.m8.1c">\lambda</annotation></semantics></math> to 0.5.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.p2.1" class="ltx_p"><span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">Exp 4: Varying the number of malicious clients.</span>
This experiment evaluates the impact of varying number of malicious clients on test accuracy. We set the percentage of malicious clients to be 20% and 40%, and include a baseline case where all clients are benign. As shown in Figure <a href="#S5.F7" title="Figure 7 ‣ 5.1 Cross-Round Check Evaluations ‣ 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>,
the test accuracy remains relatively consistent across different cases, as in each FL training round, our approach filters out the local models that tend to be malicious to minimize the negative impact of malicious client models on aggregation.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para ltx_noindent">
<p id="S5.SS2.p3.2" class="ltx_p"><span id="S5.SS2.p3.2.1" class="ltx_text ltx_font_bold">Exp 5: Comparisons with defenses against attacks. </span>
We evaluate the effect of our approach compared with various defenses, including Foolsgold <cite class="ltx_cite ltx_citemacro_citep">(Fung et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>, <math id="S5.SS2.p3.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS2.p3.1.m1.1a"><mi id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><ci id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">m</annotation></semantics></math>-Krum (<math id="S5.SS2.p3.2.m2.1" class="ltx_Math" alttext="m=5" display="inline"><semantics id="S5.SS2.p3.2.m2.1a"><mrow id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml"><mi id="S5.SS2.p3.2.m2.1.1.2" xref="S5.SS2.p3.2.m2.1.1.2.cmml">m</mi><mo id="S5.SS2.p3.2.m2.1.1.1" xref="S5.SS2.p3.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.p3.2.m2.1.1.3" xref="S5.SS2.p3.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><apply id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1"><eq id="S5.SS2.p3.2.m2.1.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1.1"></eq><ci id="S5.SS2.p3.2.m2.1.1.2.cmml" xref="S5.SS2.p3.2.m2.1.1.2">𝑚</ci><cn type="integer" id="S5.SS2.p3.2.m2.1.1.3.cmml" xref="S5.SS2.p3.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">m=5</annotation></semantics></math>) <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite>, and RFA <cite class="ltx_cite ltx_citemacro_citep">(Pillutla et al., <a href="#bib.bib47" title="" class="ltx_ref">2022</a>)</cite> under ongoing attacks. We include a “benign” baseline scenario with no activated attack or defense. The results for the random-Byzantine attack (Figure <a href="#S5.F8.sf1" title="Figure 8(a) ‣ Figure 8 ‣ 5.2 Cross-Client Detection Evaluations ‣ 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8(a)</span></a>) and model replacement backdoor attack (Figure <a href="#S5.F8.sf2" title="Figure 8(b) ‣ Figure 8 ‣ 5.2 Cross-Client Detection Evaluations ‣ 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8(b)</span></a>) demonstrate that our approach effectively mitigates the negative impact of the attacks and significantly outperforms the other defenses, with the test accuracy much closer to the benign case.
</p>
</div>
<div id="S5.SS2.p4" class="ltx_para ltx_noindent">
<p id="S5.SS2.p4.1" class="ltx_p"><span id="S5.SS2.p4.1.1" class="ltx_text ltx_font_bold">Exp 6: Evaluations on different tasks. </span>
We evaluate the defenses against the random mode of the Byzantine attack with different models and datasets described in <a href="#S5.T2" title="In 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">2</span></a>. The results in Figures <a href="#S5.F9.sf1" title="Figure 9(a) ‣ Figure 9 ‣ 5.2 Cross-Client Detection Evaluations ‣ 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9(a)</span></a>, <a href="#S5.F9.sf2" title="Figure 9(b) ‣ Figure 9 ‣ 5.2 Cross-Client Detection Evaluations ‣ 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9(b)</span></a>, and <a href="#S5.F9.sf3" title="Figure 9(c) ‣ Figure 9 ‣ 5.2 Cross-Client Detection Evaluations ‣ 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9(c)</span></a> show that while the baseline defense mechanisms can mitigate the impact of attacks in most cases, some defenses may fail in some tasks, <span id="S5.SS2.p4.1.2" class="ltx_text ltx_font_italic">e</span>.<span id="S5.SS2.p4.1.3" class="ltx_text ltx_font_italic">g</span>., <math id="S5.SS2.p4.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS2.p4.1.m1.1a"><mi id="S5.SS2.p4.1.m1.1.1" xref="S5.SS2.p4.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.1.m1.1b"><ci id="S5.SS2.p4.1.m1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.1.m1.1c">m</annotation></semantics></math>-Krum fails in RNN in Figure <a href="#S5.F9.sf3" title="Figure 9(c) ‣ Figure 9 ‣ 5.2 Cross-Client Detection Evaluations ‣ 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9(c)</span></a>. This is because those methods either select a fixed number of local models or re-weight the local models in aggregation, which potentially eliminates some local models that are important to the aggregation, leading to an unchanged test accuracy in later FL iterations. In contrast, our approach outperforms those baseline defense methods by effectively filtering out local models that are detected as malicious models, with a test accuracy close to the benign scenarios.</p>
</div>
<div id="S5.SS2.p5" class="ltx_para ltx_noindent">
<p id="S5.SS2.p5.1" class="ltx_p"><span id="S5.SS2.p5.1.1" class="ltx_text ltx_font_bold">Exp 7: Increased # of clients and evaluations in a real-world system.</span>
We utilize edge devices from the Theta network <cite class="ltx_cite ltx_citemacro_citep">(Theta Network., <a href="#bib.bib54" title="" class="ltx_ref">2023</a>)</cite> to validate the scalability of our approach to real-world applications. We deploy 20 client edge devices, and set 5 of them as malicious for each FL training round. The FL client package is integrated into Theta’s edge nodes, which periodically fetch data from the Theta back-end. We utilize the Byzantine attack of random mode. Considering the challenges posed by real-world environments, such as devices equipped solely with CPUs (lacking GPUs), potential device connectivity issues, network latency, and limited storage on edge devices (for instance, some mobile devices might have less than 500MB of available storage), we choose a simple task by employing the MNIST dataset for a logistic regression task. The information of the Theta devices is shown in  <a href="#A2.F12" title="In B.3 Supplementary Results for Real-world Systems ‣ Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">12</span></a> in Appendix §<a href="#A2.SS3" title="B.3 Supplementary Results for Real-world Systems ‣ Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.3</span></a>.
The training process is shown in Figure <a href="#A2.F13" title="Figure 13 ‣ B.3 Supplementary Results for Real-world Systems ‣ Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a> in Appendix §<a href="#A2.SS3" title="B.3 Supplementary Results for Real-world Systems ‣ Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.3</span></a> , and the total training time is 221 seconds. We also include the CPU utilization and network traffic during training, which are shown in Figure <a href="#A2.F15" title="Figure 15 ‣ B.3 Supplementary Results for Real-world Systems ‣ Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a> and Figure <a href="#A2.F15" title="Figure 15 ‣ B.3 Supplementary Results for Real-world Systems ‣ Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a> in Appendix §<a href="#A2.SS3" title="B.3 Supplementary Results for Real-world Systems ‣ Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.3</span></a> , respectively.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>ZKP Performance</h3>

<figure id="S5.T3" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S5.T3.2.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S5.T3.3.2" class="ltx_text" style="font-size:90%;">Cost of ZKP in various models (Transposed).</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S5.T3.4" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.4.1.1" class="ltx_tr">
<th id="S5.T3.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="S5.T3.4.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">Model</span></th>
<td id="S5.T3.4.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T3.4.1.1.2.1" class="ltx_text" style="font-size:80%;">CNN</span></td>
<td id="S5.T3.4.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T3.4.1.1.3.1" class="ltx_text" style="font-size:80%;">RNN</span></td>
<td id="S5.T3.4.1.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T3.4.1.1.4.1" class="ltx_text" style="font-size:80%;">ResNet-56</span></td>
</tr>
<tr id="S5.T3.4.2.2" class="ltx_tr">
<th id="S5.T3.4.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S5.T3.4.2.2.1.1" class="ltx_text" style="font-size:80%;">Stage 1 CS</span></th>
<td id="S5.T3.4.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.4.2.2.2.1" class="ltx_text" style="font-size:80%;">476,160</span></td>
<td id="S5.T3.4.2.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.4.2.2.3.1" class="ltx_text" style="font-size:80%;">1,382,400</span></td>
<td id="S5.T3.4.2.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.4.2.2.4.1" class="ltx_text" style="font-size:80%;">1,536,000</span></td>
</tr>
<tr id="S5.T3.4.3.3" class="ltx_tr">
<th id="S5.T3.4.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T3.4.3.3.1.1" class="ltx_text" style="font-size:80%;">Stage 2 CS</span></th>
<td id="S5.T3.4.3.3.2" class="ltx_td ltx_align_center"><span id="S5.T3.4.3.3.2.1" class="ltx_text" style="font-size:80%;">795,941</span></td>
<td id="S5.T3.4.3.3.3" class="ltx_td ltx_align_center"><span id="S5.T3.4.3.3.3.1" class="ltx_text" style="font-size:80%;">2,306,341</span></td>
<td id="S5.T3.4.3.3.4" class="ltx_td ltx_align_center"><span id="S5.T3.4.3.3.4.1" class="ltx_text" style="font-size:80%;">2,562,340</span></td>
</tr>
<tr id="S5.T3.4.4.4" class="ltx_tr">
<th id="S5.T3.4.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T3.4.4.4.1.1" class="ltx_text" style="font-size:80%;">Proving (s)</span></th>
<td id="S5.T3.4.4.4.2" class="ltx_td ltx_align_center">
<span id="S5.T3.4.4.4.2.1" class="ltx_text" style="font-size:80%;">33 </span><span id="S5.T3.4.4.4.2.2" class="ltx_text" style="font-size:70%;">(12 + 21)</span>
</td>
<td id="S5.T3.4.4.4.3" class="ltx_td ltx_align_center">
<span id="S5.T3.4.4.4.3.1" class="ltx_text" style="font-size:80%;">96 </span><span id="S5.T3.4.4.4.3.2" class="ltx_text" style="font-size:70%;">(34 + 62)</span>
</td>
<td id="S5.T3.4.4.4.4" class="ltx_td ltx_align_center">
<span id="S5.T3.4.4.4.4.1" class="ltx_text" style="font-size:80%;">100 </span><span id="S5.T3.4.4.4.4.2" class="ltx_text" style="font-size:70%;">(37 + 63)</span>
</td>
</tr>
<tr id="S5.T3.4.5.5" class="ltx_tr">
<th id="S5.T3.4.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S5.T3.4.5.5.1.1" class="ltx_text" style="font-size:80%;">Verification (ms)</span></th>
<td id="S5.T3.4.5.5.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.4.5.5.2.1" class="ltx_text" style="font-size:80%;">3</span></td>
<td id="S5.T3.4.5.5.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.4.5.5.3.1" class="ltx_text" style="font-size:80%;">3</span></td>
<td id="S5.T3.4.5.5.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.4.5.5.4.1" class="ltx_text" style="font-size:80%;">3</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul id="S5.I1" class="ltx_itemize ltx_centering ltx_figure_panel">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text" style="font-size:90%;">Note: CS stands for Circuit Size; Bracketed times denote duration for Stage 1 (Cross-Round Detection) and Stage 2 (Cross-Client Detection).</span></p>
</div>
</li>
</ul>
</div>
</div>
</figure>
<div id="S5.SS3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.p1.1" class="ltx_p"><span id="S5.SS3.p1.1.1" class="ltx_text ltx_font_bold">Exp 8: Evaluations of ZKP verification. </span> We implement a prover’s module which contains JavaScript code to generate witness for the ZKP, as well as to perform fixed-point quantization.
Specifically, we only pull out parameters from the second-to-last layer of each model, <span id="S5.SS3.p1.1.2" class="ltx_text ltx_font_italic">i</span>.<span id="S5.SS3.p1.1.3" class="ltx_text ltx_font_italic">e</span>., the importance layer, as our weights to reduce complexity. We report the results in Table <a href="#S5.T3" title="Table 3 ‣ 5.3 ZKP Performance ‣ 5 Evaluations ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related Works</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p"><span id="S6.p1.1.1" class="ltx_text ltx_font_bold">Detection of attacks.</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib64" title="" class="ltx_ref">2022b</a>)</cite> employs <math id="S6.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S6.p1.1.m1.1a"><mi id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><ci id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">k</annotation></semantics></math>-means to partition local models into clusters that correspond to “benign” or “malicious”. While this approach can efficiently detect attacks, it requires some pre-training rounds and relies much on historical client models, thus might not be as effective when there is limited information on past client models. For example, their implementation <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib63" title="" class="ltx_ref">2022a</a>)</cite> sets the starting round to detect attacks to different training rounds, <span id="S6.p1.1.2" class="ltx_text ltx_font_italic">e</span>.<span id="S6.p1.1.3" class="ltx_text ltx_font_italic">g</span>., 50 when the datasets are MNIST and FEMNIST, and 20 when the dataset is CIFAR10. While this approach is novel, it is not suitable for real FL systems, as attacks may happen in earlier rounds as well.</p>
</div>
<div id="S6.p2" class="ltx_para ltx_noindent">
<p id="S6.p2.1" class="ltx_p"><span id="S6.p2.1.1" class="ltx_text ltx_font_bold">Defense mechanisms in FL.</span> Robust learning and the mitigation of adversarial behaviors in FL has been extensively explored <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>; Yang et al., <a href="#bib.bib61" title="" class="ltx_ref">2019</a>; Fung et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>; Pillutla et al., <a href="#bib.bib47" title="" class="ltx_ref">2022</a>; He et al., <a href="#bib.bib32" title="" class="ltx_ref">2022</a>; Karimireddy et al., <a href="#bib.bib34" title="" class="ltx_ref">2020</a>; Sun et al., <a href="#bib.bib53" title="" class="ltx_ref">2019</a>; Fu et al., <a href="#bib.bib23" title="" class="ltx_ref">2019</a>; Ozdayi et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>; Sun et al., <a href="#bib.bib52" title="" class="ltx_ref">2021</a>; Yin et al., <a href="#bib.bib62" title="" class="ltx_ref">2018</a>; Chen et al., <a href="#bib.bib14" title="" class="ltx_ref">2017</a>; Guerraoui et al., <a href="#bib.bib28" title="" class="ltx_ref">2018</a>; Xie et al., <a href="#bib.bib60" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib40" title="" class="ltx_ref">2020</a>; Cao et al., <a href="#bib.bib11" title="" class="ltx_ref">2020</a>)</cite>.
Some approaches keep several local models that are more likely to be benign in each FL iteration, <span id="S6.p2.1.2" class="ltx_text ltx_font_italic">e</span>.<span id="S6.p2.1.3" class="ltx_text ltx_font_italic">g</span>., <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>; Guerraoui et al., <a href="#bib.bib28" title="" class="ltx_ref">2018</a>; Yin et al., <a href="#bib.bib62" title="" class="ltx_ref">2018</a>)</cite>, and <cite class="ltx_cite ltx_citemacro_citep">(Xie et al., <a href="#bib.bib60" title="" class="ltx_ref">2020</a>)</cite>. For each FL round, instead of using all client submissions for aggregation, such approaches keep local models that are the most likely to be benign to represent the other local models.
Such approaches are effective, but they keep fewer local models than the real number of benign local models to ensure that all Byzantine local models are filtered out, causing misrepresentation of some benign local models in aggregation. This completely wastes the computation resources of the benign clients that are not being selected and thus, changes the aggregation results as some benign local models do not participate in aggregation.
Some approaches re-weight or modify local models to mitigate the impacts of potential malicious submissions <cite class="ltx_cite ltx_citemacro_citep">(Fung et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>; Karimireddy et al., <a href="#bib.bib34" title="" class="ltx_ref">2020</a>; Sun et al., <a href="#bib.bib53" title="" class="ltx_ref">2019</a>; Fu et al., <a href="#bib.bib23" title="" class="ltx_ref">2019</a>; Ozdayi et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>; Sun et al., <a href="#bib.bib52" title="" class="ltx_ref">2021</a>)</cite>,
while other approaches alter the aggregation function or directly modify the aggregation results <cite class="ltx_cite ltx_citemacro_citep">(Pillutla et al., <a href="#bib.bib47" title="" class="ltx_ref">2022</a>; Karimireddy et al., <a href="#bib.bib34" title="" class="ltx_ref">2020</a>; Yin et al., <a href="#bib.bib62" title="" class="ltx_ref">2018</a>; Chen et al., <a href="#bib.bib14" title="" class="ltx_ref">2017</a>)</cite>.
While these defense mechanisms can be effective against attacks, they might inadvertently degrade the quality of outcomes due to the unintentional alteration of aggregation results even when no attacks are present. This is especially problematic given the infrequency of attacks in real-world FL scenarios.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">We present a cutting-edge anomaly detection approach specifically designed for real-world FL systems. Our approach utilizes an early cross-round check that activates subsequent anomaly detection exclusively in the presence of attacks. When attacks happen, our approach removes malicious client models efficiently, ensuring that the local models submitted by benign clients remain unaffected. Further, by leveraging ZKPs, clients get to verify the integrity of the anomaly detection and removal performed by the server.
The practical design and the inherent efficiency of our approach make it well-suited for real-world FL systems. Our plans for future works include extending our approach to asynchronous FL and vertical FL scenarios.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aoki (1950)</span>
<span class="ltx_bibblock">
Aoki, T.

</span>
<span class="ltx_bibblock">On the stability of the linear transformation in banach spaces.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Journal of the Mathematical Society of Japan</em>, 2(1-2):64–66, 1950.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bagdasaryan et al. (2020a)</span>
<span class="ltx_bibblock">
Bagdasaryan, E., Veit, A., Hua, Y., Estrin, D., and Shmatikov, V.

</span>
<span class="ltx_bibblock">How to backdoor federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">AISTATS</em>, 2020a.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bagdasaryan et al. (2020b)</span>
<span class="ltx_bibblock">
Bagdasaryan, E., Veit, A., Hua, Y., Estrin, D., and Shmatikov, V.

</span>
<span class="ltx_bibblock">How to backdoor federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and
Statistics</em>, pp.  2938–2948. PMLR, 2020b.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Baruch et al. (2019)</span>
<span class="ltx_bibblock">
Baruch, G., Baruch, M., and Goldberg, Y.

</span>
<span class="ltx_bibblock">A little is enough: Circumventing defenses for distributed learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 32, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhagoji et al. (2019)</span>
<span class="ltx_bibblock">
Bhagoji, A. N., Chakraborty, S., Mittal, P., and Calo, S.

</span>
<span class="ltx_bibblock">Analyzing federated learning through an adversarial lens.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 634–643. PMLR, 2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bitansky et al. (2012)</span>
<span class="ltx_bibblock">
Bitansky, N., Canetti, R., Chiesa, A., and Tromer, E.

</span>
<span class="ltx_bibblock">From extractable collision resistance to succinct non-interactive
arguments of knowledge, and back again.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 3rd Innovations in Theoretical Computer
Science Conference</em>, pp.  326–349, 2012.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blanchard et al. (2017)</span>
<span class="ltx_bibblock">
Blanchard, P., El Mhamdi, E. M., Guerraoui, R., and Stainer, J.

</span>
<span class="ltx_bibblock">Machine learning with adversaries: Byzantine tolerant gradient
descent.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2017.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Byrd &amp; Polychroniadou (2020)</span>
<span class="ltx_bibblock">
Byrd, D. and Polychroniadou, A.

</span>
<span class="ltx_bibblock">Differentially private secure multi-party computation for federated
learning in financial applications.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the First ACM International Conference on AI
in Finance</em>, pp.  1–9, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldas et al. (2018)</span>
<span class="ltx_bibblock">
Caldas, S., Duddu, S. M. K., Wu, P., Li, T., Konečnỳ, J., McMahan,
H. B., Smith, V., and Talwalkar, A.

</span>
<span class="ltx_bibblock">Leaf: A benchmark for federated settings.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.01097</em>, 2018.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao &amp; Gong (2022)</span>
<span class="ltx_bibblock">
Cao, X. and Gong, N. Z.

</span>
<span class="ltx_bibblock">Mpaf: Model poisoning attacks to federated learning based on fake
clients.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  3396–3404, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al. (2020)</span>
<span class="ltx_bibblock">
Cao, X., Fang, M., Liu, J., and Gong, N. Z.

</span>
<span class="ltx_bibblock">Fltrust: Byzantine-robust federated learning via trust bootstrapping.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2012.13995</em>, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al. (2022)</span>
<span class="ltx_bibblock">
Cao, X., Zhang, Z., Jia, J., and Gong, N. Z.

</span>
<span class="ltx_bibblock">Flcert: Provably secure federated learning against poisoning attacks.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Information Forensics and Security</em>,
17:3691–3705, 2022.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2019)</span>
<span class="ltx_bibblock">
Chen, M., Mathews, R., Ouyang, T., and Beaufays, F.

</span>
<span class="ltx_bibblock">Federated learning of out-of-vocabulary words.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1903.10635</em>, 2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2017)</span>
<span class="ltx_bibblock">
Chen, Y., Su, L., and Xu, J.

</span>
<span class="ltx_bibblock">Distributed statistical machine learning in adversarial settings:
Byzantine gradient descent.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">ACM on Measurement and Analysis of Computing Systems</em>,
1(2):1–25, 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chowdhury et al. (2022)</span>
<span class="ltx_bibblock">
Chowdhury, A., Kassem, H., Padoy, N., Umeton, R., and Karargyris, A.

</span>
<span class="ltx_bibblock">A review of medical federated learning: Applications in oncology and
cancer research.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Brainlesion: Glioma, Multiple Sclerosis, Stroke and
Traumatic Brain Injuries: 7th International Workshop, BrainLes 2021, Held in
Conjunction with MICCAI 2021, Virtual Event, September 27, 2021, Revised
Selected Papers, Part I</em>, pp.  3–24. Springer, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Contributors (2022)</span>
<span class="ltx_bibblock">
Contributors, C.

</span>
<span class="ltx_bibblock">Circom zkSNARK ecosystem, 2022.

</span>
<span class="ltx_bibblock">https://github.com/iden3/circom.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cox (1958)</span>
<span class="ltx_bibblock">
Cox, D. R.

</span>
<span class="ltx_bibblock">The regression analysis of binary sequences.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Journal of the Royal Statistical Society: Series B
(Methodological)</em>, 20(2):215–232, 1958.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng (2012)</span>
<span class="ltx_bibblock">
Deng, L.

</span>
<span class="ltx_bibblock">The mnist database of handwritten digit images for machine learning
research.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>, 29(6):141–142, 2012.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang et al. (2020)</span>
<span class="ltx_bibblock">
Fang, M., Cao, X., Jia, J., and Gong, N.

</span>
<span class="ltx_bibblock">Local model poisoning attacks to Byzantine-robust federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">USENIX Security</em>, 2020.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al. (2021)</span>
<span class="ltx_bibblock">
Feng, B., Qin, L., Zhang, Z., Ding, Y., and Chu, S.

</span>
<span class="ltx_bibblock">ZEN: An optimizing compiler for verifiable, zero-knowledge neural
network inferences.

</span>
<span class="ltx_bibblock">2021.

</span>
<span class="ltx_bibblock">Cryptology ePrint Archive.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fletcher (2019)</span>
<span class="ltx_bibblock">
Fletcher, G. S.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Clinical epidemiology: the essentials</em>.

</span>
<span class="ltx_bibblock">Lippincott Williams &amp; Wilkins, 2019.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Freivalds (1977)</span>
<span class="ltx_bibblock">
Freivalds, R.

</span>
<span class="ltx_bibblock">Probabilistic machines can use less running time.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">IFIP Congress</em>, 1977.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al. (2019)</span>
<span class="ltx_bibblock">
Fu, S., Xie, C., Li, B., and Chen, Q.

</span>
<span class="ltx_bibblock">Attack-resistant federated learning with residual-based reweighting.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.11464</em>, 2019.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fung et al. (2020)</span>
<span class="ltx_bibblock">
Fung, C., Yoon, C. J., and Beschastnikh, I.

</span>
<span class="ltx_bibblock">The limitations of federated learning in sybil settings.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">RAID</em>, pp.  301–316, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goldreich &amp; Krawczyk (1996)</span>
<span class="ltx_bibblock">
Goldreich, O. and Krawczyk, H.

</span>
<span class="ltx_bibblock">On the composition of zero-knowledge proof systems.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">SIAM Journal on Computing</em>, 25(1):169–192,
1996.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goldwasser et al. (1989)</span>
<span class="ltx_bibblock">
Goldwasser, S., Micali, S., and Rackoff, C.

</span>
<span class="ltx_bibblock">The knowledge complexity of interactive proof systems.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">SIAM Jour. on Comp.</em>, 18(1):186–208, 1989.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Groth (2016)</span>
<span class="ltx_bibblock">
Groth, J.

</span>
<span class="ltx_bibblock">On the size of pairing-based non-interactive arguments.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Eurocrypt</em>, 2016.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guerraoui et al. (2018)</span>
<span class="ltx_bibblock">
Guerraoui, R., Rouault, S., et al.

</span>
<span class="ltx_bibblock">The hidden vulnerability of distributed learning in byzantium.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 3521–3530. PMLR, 2018.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2019)</span>
<span class="ltx_bibblock">
Han, S., Wang, H., Wan, J., and Li, J.

</span>
<span class="ltx_bibblock">An iterative scheme for leverage-based approximate aggregation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">IEEE ICDE</em>, 2019.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hard et al. (2018)</span>
<span class="ltx_bibblock">
Hard, A., Rao, K., Mathews, R., Ramaswamy, S., Beaufays, F., Augenstein, S.,
Eichner, H., Kiddon, C., and Ramage, D.

</span>
<span class="ltx_bibblock">Federated learning for mobile keyboard prediction.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1811.03604</em>, 2018.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., and Sun, J.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pp.  770–778, 2016.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2022)</span>
<span class="ltx_bibblock">
He, L., Karimireddy, S. P., and Jaggi, M.

</span>
<span class="ltx_bibblock">Byzantine-robust decentralized learning via self-centered clipping.

</span>
<span class="ltx_bibblock">2022.

</span>
<span class="ltx_bibblock">Available on arXiv:2202.01545.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al. (2021)</span>
<span class="ltx_bibblock">
Jin, X., Chen, P.-Y., Hsu, C.-Y., Yu, C.-M., and Chen, T.

</span>
<span class="ltx_bibblock">Cafe: Catastrophic data leakage in vertical federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
34:994–1006, 2021.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Karimireddy, S. P., He, L., and Jaggi, M.

</span>
<span class="ltx_bibblock">Byzantine-robust learning on heterogeneous datasets via bucketing.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.09365</em>, 2020.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kariyappa et al. (2022)</span>
<span class="ltx_bibblock">
Kariyappa, S., Guo, C., Maeng, K., Xiong, W., Suh, G. E., Qureshi, M. K., and
Lee, H.-H. S.

</span>
<span class="ltx_bibblock">Cocktail party attack: Breaking aggregation-based privacy in
federated learning using independent component analysis.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://api.semanticscholar.org/CorpusID:252211968" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:252211968</a>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A., Hinton, G., et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lam et al. (2021)</span>
<span class="ltx_bibblock">
Lam, M., Wei, G.-Y., Brooks, D., Reddi, V. a., and Mitzenmacher, M.

</span>
<span class="ltx_bibblock">Gradient disaggregation: Breaking privacy in federated learning by
reconstructing the user participant matrix.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 5959–5968. PMLR, 2021.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2020)</span>
<span class="ltx_bibblock">
Lee, S., Ko, H., Kim, J., and Oh, H.

</span>
<span class="ltx_bibblock">vCNN: Verifiable convolutional neural network based on zk-snarks.

</span>
<span class="ltx_bibblock">2020.

</span>
<span class="ltx_bibblock">Cryptology ePrint Archive.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leroy et al. (2019)</span>
<span class="ltx_bibblock">
Leroy, D., Coucke, A., Lavril, T., Gisselbrecht, T., and Dureau, J.

</span>
<span class="ltx_bibblock">Federated learning for keyword spotting.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">IEEE International Conference on Acoustics, Speech and
Signal Processing (ICASSP)</em>, pp.  6341–6345, 2019.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, S., Cheng, Y., Wang, W., Liu, Y., and Chen, T.

</span>
<span class="ltx_bibblock">Learning to detect malicious clients for robust federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.00211</em>, 2020.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Liu, T., Xie, X., and Zhang, Y.

</span>
<span class="ltx_bibblock">ZkCNN: Zero knowledge proofs for convolutional neural network
predictions and accuracy.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">ACM CCS</em>, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lyon (2014)</span>
<span class="ltx_bibblock">
Lyon, A.

</span>
<span class="ltx_bibblock">Why are normal distributions normal?

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">The British Journal for the Philosophy of Science</em>, 65(3):621–649, 2014.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017a)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282.
PMLR, 2017a.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017b)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282.
PMLR, 2017b.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Osborne (2010)</span>
<span class="ltx_bibblock">
Osborne, J.

</span>
<span class="ltx_bibblock">Improving your data transformations: Applying the Box-Cox
transformation.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Practical Assessment, Research, and Evaluation</em>, 15(1):12, 2010.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ozdayi et al. (2021)</span>
<span class="ltx_bibblock">
Ozdayi, M. S., Kantarcioglu, M., and Gel, Y. R.

</span>
<span class="ltx_bibblock">Defending against backdoors in federated learning with robust
learning rate.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 35, pp.  9268–9276, 2021.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pillutla et al. (2022)</span>
<span class="ltx_bibblock">
Pillutla, K., Kakade, S. M., and Harchaoui, Z.

</span>
<span class="ltx_bibblock">Robust aggregation for federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Signal Processing</em>, 70:1142–1154, 2022.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pukelsheim (1994)</span>
<span class="ltx_bibblock">
Pukelsheim, F.

</span>
<span class="ltx_bibblock">The three sigma rule.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">The American Statistician</em>, 48(2):88–91,
1994.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramaswamy et al. (2019)</span>
<span class="ltx_bibblock">
Ramaswamy, S., Mathews, R., Rao, K., and Beaufays, F.

</span>
<span class="ltx_bibblock">Federated learning for emoji prediction in a mobile keyboard.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1906.04329</em>, 2019.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sakia (1992)</span>
<span class="ltx_bibblock">
Sakia, R. M.

</span>
<span class="ltx_bibblock">The Box-Cox transformation technique: A review.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Journal of the Royal Statistical Society: Series D</em>,
41(2):169–178, 1992.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sasson et al. (2014)</span>
<span class="ltx_bibblock">
Sasson, E. B., Chiesa, A., Garman, C., Green, M., Miers, I., Tromer, E., and
Virza, M.

</span>
<span class="ltx_bibblock">Zerocash: Decentralized anonymous payments from bitcoin.

</span>
<span class="ltx_bibblock">In <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">IEEE S&amp;P</em>, 2014.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2021)</span>
<span class="ltx_bibblock">
Sun, J., Li, A., DiValentin, L., Hassanzadeh, A., Chen, Y., and Li, H.

</span>
<span class="ltx_bibblock">Fl-wbc: Enhancing robustness against model poisoning attacks in
federated learning from a client perspective.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
34:12613–12624, 2021.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2019)</span>
<span class="ltx_bibblock">
Sun, Z., Kairouz, P., Suresh, A. T., and McMahan, H. B.

</span>
<span class="ltx_bibblock">Can you really backdoor federated learning?

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1911.07963</em>, 2019.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Theta Network. (2023)</span>
<span class="ltx_bibblock">
Theta Network.

</span>
<span class="ltx_bibblock">Theta network website.

</span>
<span class="ltx_bibblock">https://thetatoken.org/, 2023.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tolpegin et al. (2020)</span>
<span class="ltx_bibblock">
Tolpegin, V., Truex, S., Gursoy, M. E., and Liu, L.

</span>
<span class="ltx_bibblock">Data poisoning attacks against federated learning systems.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">European Symposium on Research in Computer Security</em>, pp. 480–501. Springer, 2020.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tomsett et al. (2019)</span>
<span class="ltx_bibblock">
Tomsett, R., Chan, K., and Chakraborty, S.

</span>
<span class="ltx_bibblock">Model poisoning attacks against distributed machine learning systems.

</span>
<span class="ltx_bibblock">In <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Machine Learning for
Multi-Domain Operations Applications</em>, volume 11006, pp.  481–489. SPIE,
2019.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Wang, H., Sreenivasan, K., Rajput, S., Vishwakarma, H., Agarwal, S., Sohn, J.,
Lee, K., and Papailiopoulos, D.

</span>
<span class="ltx_bibblock">Attack of the tails: Yes, you really can backdoor federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2020.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang (2022)</span>
<span class="ltx_bibblock">
Wang, J.

</span>
<span class="ltx_bibblock">Pass: Parameters audit-based secure and fair federated learning
scheme against free rider.

</span>
<span class="ltx_bibblock"><em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2207.07292</em>, 2022.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weisberg (2001)</span>
<span class="ltx_bibblock">
Weisberg, S.

</span>
<span class="ltx_bibblock">Yeo-Johnson power transformations.

</span>
<span class="ltx_bibblock">2001.

</span>
<span class="ltx_bibblock">Available at https://www.stat.umn.edu/arc/yjpower.pdf.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2020)</span>
<span class="ltx_bibblock">
Xie, C., Koyejo, O., and Gupta, I.

</span>
<span class="ltx_bibblock">SLSGD: Secure and Efficient Distributed On-device Machine Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">Joint European Conference on Machine Learning and Knowledge
Discovery in Databases</em>, pp.  213–228. Springer, 2020.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2019)</span>
<span class="ltx_bibblock">
Yang, H., Zhang, X., Fang, M., and Liu, J.

</span>
<span class="ltx_bibblock">Byzantine-resilient stochastic gradient descent for distributed
learning: A Lipschitz-inspired coordinate-wise median approach.

</span>
<span class="ltx_bibblock">In <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">IEEE CDC</em>, 2019.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2018)</span>
<span class="ltx_bibblock">
Yin, D., Chen, Y., Ramchandran, K., and Bartlett, P.

</span>
<span class="ltx_bibblock">Byzantine-robust distributed learning: Towards optimal statistical
rates.

</span>
<span class="ltx_bibblock">In <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 5650–5659. PMLR, 2018.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022a)</span>
<span class="ltx_bibblock">
Zhang, Z., Cao, X., Jia, J., and Gong, N. Z.

</span>
<span class="ltx_bibblock">Implementation of fldetector.

</span>
<span class="ltx_bibblock">https://github.com/zaixizhang/FLDetector, 2022a.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022b)</span>
<span class="ltx_bibblock">
Zhang, Z., Cao, X., Jia, J., and Gong, N. Z.

</span>
<span class="ltx_bibblock">Fldetector: Defending federated learning against model poisoning
attacks via detecting malicious clients.

</span>
<span class="ltx_bibblock">In <em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 28th ACM SIGKDD Conference on Knowledge
Discovery and Data Mining</em>, pp.  2545–2555, 2022b.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022c)</span>
<span class="ltx_bibblock">
Zhang, Z., Panda, A., Song, L., Yang, Y., Mahoney, M. W., Gonzalez, J.,
Ramchandran, K., and Mittal, P.

</span>
<span class="ltx_bibblock">Neurotoxin: Durable backdoors in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>,
2022c.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://api.semanticscholar.org/CorpusID:249889464" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:249889464</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Algorithm for Krum and <math id="A1.SS1.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="A1.SS1.1.m1.1b"><mi id="A1.SS1.1.m1.1.1" xref="A1.SS1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.1.m1.1c"><ci id="A1.SS1.1.m1.1.1.cmml" xref="A1.SS1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.m1.1d">m</annotation></semantics></math>-Krum</h3>

<figure id="alg3" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg3.39.1.1" class="ltx_text ltx_font_bold">Algorithm 3</span> </span> Krum and <math id="alg3.2.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg3.2.m1.1b"><mi id="alg3.2.m1.1.1" xref="alg3.2.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg3.2.m1.1c"><ci id="alg3.2.m1.1.1.cmml" xref="alg3.2.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.2.m1.1d">m</annotation></semantics></math>-Krum.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg3.10" class="ltx_p ltx_figure_panel"><span id="alg3.10.1" class="ltx_text ltx_font_bold">Inputs:</span>
<math id="alg3.3.m1.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="alg3.3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.3.m1.1.1" xref="alg3.3.m1.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="alg3.3.m1.1b"><ci id="alg3.3.m1.1.1.cmml" xref="alg3.3.m1.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.3.m1.1c">\mathcal{W}</annotation></semantics></math>: client submissions of a training round; <math id="alg3.4.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg3.4.m2.1a"><mi id="alg3.4.m2.1.1" xref="alg3.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.4.m2.1b"><ci id="alg3.4.m2.1.1.cmml" xref="alg3.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.4.m2.1c">i</annotation></semantics></math>: the client id for which we compute a Krum score <math id="alg3.5.m3.1" class="ltx_Math" alttext="S_{K}(\mathbf{w}_{i})" display="inline"><semantics id="alg3.5.m3.1a"><mrow id="alg3.5.m3.1.1" xref="alg3.5.m3.1.1.cmml"><msub id="alg3.5.m3.1.1.3" xref="alg3.5.m3.1.1.3.cmml"><mi id="alg3.5.m3.1.1.3.2" xref="alg3.5.m3.1.1.3.2.cmml">S</mi><mi id="alg3.5.m3.1.1.3.3" xref="alg3.5.m3.1.1.3.3.cmml">K</mi></msub><mo lspace="0em" rspace="0em" id="alg3.5.m3.1.1.2" xref="alg3.5.m3.1.1.2.cmml">​</mo><mrow id="alg3.5.m3.1.1.1.1" xref="alg3.5.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.5.m3.1.1.1.1.2" xref="alg3.5.m3.1.1.1.1.1.cmml">(</mo><msub id="alg3.5.m3.1.1.1.1.1" xref="alg3.5.m3.1.1.1.1.1.cmml"><mi id="alg3.5.m3.1.1.1.1.1.2" xref="alg3.5.m3.1.1.1.1.1.2.cmml">𝐰</mi><mi id="alg3.5.m3.1.1.1.1.1.3" xref="alg3.5.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg3.5.m3.1.1.1.1.3" xref="alg3.5.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.5.m3.1b"><apply id="alg3.5.m3.1.1.cmml" xref="alg3.5.m3.1.1"><times id="alg3.5.m3.1.1.2.cmml" xref="alg3.5.m3.1.1.2"></times><apply id="alg3.5.m3.1.1.3.cmml" xref="alg3.5.m3.1.1.3"><csymbol cd="ambiguous" id="alg3.5.m3.1.1.3.1.cmml" xref="alg3.5.m3.1.1.3">subscript</csymbol><ci id="alg3.5.m3.1.1.3.2.cmml" xref="alg3.5.m3.1.1.3.2">𝑆</ci><ci id="alg3.5.m3.1.1.3.3.cmml" xref="alg3.5.m3.1.1.3.3">𝐾</ci></apply><apply id="alg3.5.m3.1.1.1.1.1.cmml" xref="alg3.5.m3.1.1.1.1"><csymbol cd="ambiguous" id="alg3.5.m3.1.1.1.1.1.1.cmml" xref="alg3.5.m3.1.1.1.1">subscript</csymbol><ci id="alg3.5.m3.1.1.1.1.1.2.cmml" xref="alg3.5.m3.1.1.1.1.1.2">𝐰</ci><ci id="alg3.5.m3.1.1.1.1.1.3.cmml" xref="alg3.5.m3.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.5.m3.1c">S_{K}(\mathbf{w}_{i})</annotation></semantics></math>; <math id="alg3.6.m4.1" class="ltx_Math" alttext="f" display="inline"><semantics id="alg3.6.m4.1a"><mi id="alg3.6.m4.1.1" xref="alg3.6.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="alg3.6.m4.1b"><ci id="alg3.6.m4.1.1.cmml" xref="alg3.6.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.6.m4.1c">f</annotation></semantics></math>: the number of malicious clients in each FL iteration; <math id="alg3.7.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg3.7.m5.1a"><mi id="alg3.7.m5.1.1" xref="alg3.7.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg3.7.m5.1b"><ci id="alg3.7.m5.1.1.cmml" xref="alg3.7.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.7.m5.1c">m</annotation></semantics></math>: the number of “neighbor” client models that participate in computing the Krum score <math id="alg3.8.m6.1" class="ltx_Math" alttext="S_{k}(\mathbf{w}_{i})" display="inline"><semantics id="alg3.8.m6.1a"><mrow id="alg3.8.m6.1.1" xref="alg3.8.m6.1.1.cmml"><msub id="alg3.8.m6.1.1.3" xref="alg3.8.m6.1.1.3.cmml"><mi id="alg3.8.m6.1.1.3.2" xref="alg3.8.m6.1.1.3.2.cmml">S</mi><mi id="alg3.8.m6.1.1.3.3" xref="alg3.8.m6.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="alg3.8.m6.1.1.2" xref="alg3.8.m6.1.1.2.cmml">​</mo><mrow id="alg3.8.m6.1.1.1.1" xref="alg3.8.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.8.m6.1.1.1.1.2" xref="alg3.8.m6.1.1.1.1.1.cmml">(</mo><msub id="alg3.8.m6.1.1.1.1.1" xref="alg3.8.m6.1.1.1.1.1.cmml"><mi id="alg3.8.m6.1.1.1.1.1.2" xref="alg3.8.m6.1.1.1.1.1.2.cmml">𝐰</mi><mi id="alg3.8.m6.1.1.1.1.1.3" xref="alg3.8.m6.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg3.8.m6.1.1.1.1.3" xref="alg3.8.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.8.m6.1b"><apply id="alg3.8.m6.1.1.cmml" xref="alg3.8.m6.1.1"><times id="alg3.8.m6.1.1.2.cmml" xref="alg3.8.m6.1.1.2"></times><apply id="alg3.8.m6.1.1.3.cmml" xref="alg3.8.m6.1.1.3"><csymbol cd="ambiguous" id="alg3.8.m6.1.1.3.1.cmml" xref="alg3.8.m6.1.1.3">subscript</csymbol><ci id="alg3.8.m6.1.1.3.2.cmml" xref="alg3.8.m6.1.1.3.2">𝑆</ci><ci id="alg3.8.m6.1.1.3.3.cmml" xref="alg3.8.m6.1.1.3.3">𝑘</ci></apply><apply id="alg3.8.m6.1.1.1.1.1.cmml" xref="alg3.8.m6.1.1.1.1"><csymbol cd="ambiguous" id="alg3.8.m6.1.1.1.1.1.1.cmml" xref="alg3.8.m6.1.1.1.1">subscript</csymbol><ci id="alg3.8.m6.1.1.1.1.1.2.cmml" xref="alg3.8.m6.1.1.1.1.1.2">𝐰</ci><ci id="alg3.8.m6.1.1.1.1.1.3.cmml" xref="alg3.8.m6.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.8.m6.1c">S_{k}(\mathbf{w}_{i})</annotation></semantics></math> of each client model <math id="alg3.9.m7.1" class="ltx_Math" alttext="\mathbf{w}_{i}" display="inline"><semantics id="alg3.9.m7.1a"><msub id="alg3.9.m7.1.1" xref="alg3.9.m7.1.1.cmml"><mi id="alg3.9.m7.1.1.2" xref="alg3.9.m7.1.1.2.cmml">𝐰</mi><mi id="alg3.9.m7.1.1.3" xref="alg3.9.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.9.m7.1b"><apply id="alg3.9.m7.1.1.cmml" xref="alg3.9.m7.1.1"><csymbol cd="ambiguous" id="alg3.9.m7.1.1.1.cmml" xref="alg3.9.m7.1.1">subscript</csymbol><ci id="alg3.9.m7.1.1.2.cmml" xref="alg3.9.m7.1.1.2">𝐰</ci><ci id="alg3.9.m7.1.1.3.cmml" xref="alg3.9.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.9.m7.1c">\mathbf{w}_{i}</annotation></semantics></math>; <math id="alg3.10.m8.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg3.10.m8.1a"><mi id="alg3.10.m8.1.1" xref="alg3.10.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg3.10.m8.1b"><ci id="alg3.10.m8.1.1.cmml" xref="alg3.10.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.10.m8.1c">m</annotation></semantics></math> is 1 by default in Krum.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg3.11" class="ltx_p ltx_figure_panel"><span id="alg3.11.1" class="ltx_text ltx_font_bold">function <math id="alg3.11.1.m1.3" class="ltx_Math" alttext="\boldsymbol{\mathit{Krum}\_\mathit{and}\_m\_\mathit{Krum}(\mathcal{W},m,f)}" display="inline"><semantics id="alg3.11.1.m1.3a"><mrow id="alg3.11.1.m1.3.4" xref="alg3.11.1.m1.3.4.cmml"><mi id="alg3.11.1.m1.3.4.2" xref="alg3.11.1.m1.3.4.2.cmml">𝐾𝑟𝑢𝑚</mi><mo lspace="0em" rspace="0em" id="alg3.11.1.m1.3.4.1" xref="alg3.11.1.m1.3.4.1.cmml">​</mo><mi class="ltx_mathvariant_bold" mathvariant="bold" id="alg3.11.1.m1.3.4.3" xref="alg3.11.1.m1.3.4.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg3.11.1.m1.3.4.1a" xref="alg3.11.1.m1.3.4.1.cmml">​</mo><mi id="alg3.11.1.m1.3.4.4" xref="alg3.11.1.m1.3.4.4.cmml">𝑎𝑛𝑑</mi><mo lspace="0em" rspace="0em" id="alg3.11.1.m1.3.4.1b" xref="alg3.11.1.m1.3.4.1.cmml">​</mo><mi class="ltx_mathvariant_bold" mathvariant="bold" id="alg3.11.1.m1.3.4.5" xref="alg3.11.1.m1.3.4.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg3.11.1.m1.3.4.1c" xref="alg3.11.1.m1.3.4.1.cmml">​</mo><mi id="alg3.11.1.m1.3.4.6" xref="alg3.11.1.m1.3.4.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg3.11.1.m1.3.4.1d" xref="alg3.11.1.m1.3.4.1.cmml">​</mo><mi class="ltx_mathvariant_bold" mathvariant="bold" id="alg3.11.1.m1.3.4.7" xref="alg3.11.1.m1.3.4.7.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg3.11.1.m1.3.4.1e" xref="alg3.11.1.m1.3.4.1.cmml">​</mo><mi id="alg3.11.1.m1.3.4.8" xref="alg3.11.1.m1.3.4.8.cmml">𝐾𝑟𝑢𝑚</mi><mo lspace="0em" rspace="0em" id="alg3.11.1.m1.3.4.1f" xref="alg3.11.1.m1.3.4.1.cmml">​</mo><mrow id="alg3.11.1.m1.3.4.9.2" xref="alg3.11.1.m1.3.4.9.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg3.11.1.m1.3.4.9.2.1" xref="alg3.11.1.m1.3.4.9.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg3.11.1.m1.1.1" xref="alg3.11.1.m1.1.1.cmml">𝒲</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="alg3.11.1.m1.3.4.9.2.2" xref="alg3.11.1.m1.3.4.9.1.cmml">,</mo><mi id="alg3.11.1.m1.2.2" xref="alg3.11.1.m1.2.2.cmml">m</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="alg3.11.1.m1.3.4.9.2.3" xref="alg3.11.1.m1.3.4.9.1.cmml">,</mo><mi id="alg3.11.1.m1.3.3" xref="alg3.11.1.m1.3.3.cmml">f</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg3.11.1.m1.3.4.9.2.4" xref="alg3.11.1.m1.3.4.9.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.11.1.m1.3b"><apply id="alg3.11.1.m1.3.4.cmml" xref="alg3.11.1.m1.3.4"><times id="alg3.11.1.m1.3.4.1.cmml" xref="alg3.11.1.m1.3.4.1"></times><ci id="alg3.11.1.m1.3.4.2.cmml" xref="alg3.11.1.m1.3.4.2">𝐾𝑟𝑢𝑚</ci><ci id="alg3.11.1.m1.3.4.3.cmml" xref="alg3.11.1.m1.3.4.3">bold-_</ci><ci id="alg3.11.1.m1.3.4.4.cmml" xref="alg3.11.1.m1.3.4.4">𝑎𝑛𝑑</ci><ci id="alg3.11.1.m1.3.4.5.cmml" xref="alg3.11.1.m1.3.4.5">bold-_</ci><ci id="alg3.11.1.m1.3.4.6.cmml" xref="alg3.11.1.m1.3.4.6">𝑚</ci><ci id="alg3.11.1.m1.3.4.7.cmml" xref="alg3.11.1.m1.3.4.7">bold-_</ci><ci id="alg3.11.1.m1.3.4.8.cmml" xref="alg3.11.1.m1.3.4.8">𝐾𝑟𝑢𝑚</ci><vector id="alg3.11.1.m1.3.4.9.1.cmml" xref="alg3.11.1.m1.3.4.9.2"><ci id="alg3.11.1.m1.1.1.cmml" xref="alg3.11.1.m1.1.1">𝒲</ci><ci id="alg3.11.1.m1.2.2.cmml" xref="alg3.11.1.m1.2.2">𝑚</ci><ci id="alg3.11.1.m1.3.3.cmml" xref="alg3.11.1.m1.3.3">𝑓</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.11.1.m1.3c">\boldsymbol{\mathit{Krum}\_\mathit{and}\_m\_\mathit{Krum}(\mathcal{W},m,f)}</annotation></semantics></math></span>
<span id="alg3.11.2" class="ltx_text ltx_font_bold">begin</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="alg3.40" class="ltx_block ltx_figure_panel">
<div id="alg3.13" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_tag ltx_tag_listingline">18</span><span class="ltx_tag ltx_tag_listingline">17</span>
<math id="alg3.12.m1.1" class="ltx_Math" alttext="S_{k}\leftarrow[]" display="inline"><semantics id="alg3.12.m1.1a"><mrow id="alg3.12.m1.1.1" xref="alg3.12.m1.1.1.cmml"><msub id="alg3.12.m1.1.1.2" xref="alg3.12.m1.1.1.2.cmml"><mi id="alg3.12.m1.1.1.2.2" xref="alg3.12.m1.1.1.2.2.cmml">S</mi><mi id="alg3.12.m1.1.1.2.3" xref="alg3.12.m1.1.1.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg3.12.m1.1.1.1" xref="alg3.12.m1.1.1.1.cmml">←</mo><mrow id="alg3.12.m1.1.1.3.2" xref="alg3.12.m1.1.1.cmml"><mo stretchy="false" id="alg3.12.m1.1.1.3.2.1" xref="alg3.12.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="alg3.12.m1.1.1.3.2.2" xref="alg3.12.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.12.m1.1b"><apply id="alg3.12.m1.1.1.cmml" xref="alg3.12.m1.1.1"><ci id="alg3.12.m1.1.1.1.cmml" xref="alg3.12.m1.1.1.1">←</ci><apply id="alg3.12.m1.1.1.2.cmml" xref="alg3.12.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.12.m1.1.1.2.1.cmml" xref="alg3.12.m1.1.1.2">subscript</csymbol><ci id="alg3.12.m1.1.1.2.2.cmml" xref="alg3.12.m1.1.1.2.2">𝑆</ci><ci id="alg3.12.m1.1.1.2.3.cmml" xref="alg3.12.m1.1.1.2.3">𝑘</ci></apply><list id="alg3.12.m1.1.1.3.1.cmml" xref="alg3.12.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.12.m1.1c">S_{k}\leftarrow[]</annotation></semantics></math>
<span id="alg3.13.2" class="ltx_text ltx_font_bold">for</span> <em id="alg3.13.1" class="ltx_emph ltx_font_italic"><math id="alg3.13.1.m1.1" class="ltx_Math" alttext="\mathbf{w}_{j}\in\mathcal{W}" display="inline"><semantics id="alg3.13.1.m1.1a"><mrow id="alg3.13.1.m1.1.1" xref="alg3.13.1.m1.1.1.cmml"><msub id="alg3.13.1.m1.1.1.2" xref="alg3.13.1.m1.1.1.2.cmml"><mi id="alg3.13.1.m1.1.1.2.2" xref="alg3.13.1.m1.1.1.2.2.cmml">𝐰</mi><mi id="alg3.13.1.m1.1.1.2.3" xref="alg3.13.1.m1.1.1.2.3.cmml">j</mi></msub><mo id="alg3.13.1.m1.1.1.1" xref="alg3.13.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg3.13.1.m1.1.1.3" xref="alg3.13.1.m1.1.1.3.cmml">𝒲</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.13.1.m1.1b"><apply id="alg3.13.1.m1.1.1.cmml" xref="alg3.13.1.m1.1.1"><in id="alg3.13.1.m1.1.1.1.cmml" xref="alg3.13.1.m1.1.1.1"></in><apply id="alg3.13.1.m1.1.1.2.cmml" xref="alg3.13.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.13.1.m1.1.1.2.1.cmml" xref="alg3.13.1.m1.1.1.2">subscript</csymbol><ci id="alg3.13.1.m1.1.1.2.2.cmml" xref="alg3.13.1.m1.1.1.2.2">𝐰</ci><ci id="alg3.13.1.m1.1.1.2.3.cmml" xref="alg3.13.1.m1.1.1.2.3">𝑗</ci></apply><ci id="alg3.13.1.m1.1.1.3.cmml" xref="alg3.13.1.m1.1.1.3">𝒲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.13.1.m1.1c">\mathbf{w}_{j}\in\mathcal{W}</annotation></semantics></math></em> <span id="alg3.13.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg3.14" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_tag ltx_tag_listingline">19</span>
<math id="alg3.14.m1.5" class="ltx_Math" alttext="S_{k}(\mathbf{w}_{i})\leftarrow\mathit{compute}\_\mathit{krum}\_\mathit{score}(\mathcal{W},i,m,f)" display="inline"><semantics id="alg3.14.m1.5a"><mrow id="alg3.14.m1.5.5" xref="alg3.14.m1.5.5.cmml"><mrow id="alg3.14.m1.5.5.1" xref="alg3.14.m1.5.5.1.cmml"><msub id="alg3.14.m1.5.5.1.3" xref="alg3.14.m1.5.5.1.3.cmml"><mi id="alg3.14.m1.5.5.1.3.2" xref="alg3.14.m1.5.5.1.3.2.cmml">S</mi><mi id="alg3.14.m1.5.5.1.3.3" xref="alg3.14.m1.5.5.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="alg3.14.m1.5.5.1.2" xref="alg3.14.m1.5.5.1.2.cmml">​</mo><mrow id="alg3.14.m1.5.5.1.1.1" xref="alg3.14.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="alg3.14.m1.5.5.1.1.1.2" xref="alg3.14.m1.5.5.1.1.1.1.cmml">(</mo><msub id="alg3.14.m1.5.5.1.1.1.1" xref="alg3.14.m1.5.5.1.1.1.1.cmml"><mi id="alg3.14.m1.5.5.1.1.1.1.2" xref="alg3.14.m1.5.5.1.1.1.1.2.cmml">𝐰</mi><mi id="alg3.14.m1.5.5.1.1.1.1.3" xref="alg3.14.m1.5.5.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg3.14.m1.5.5.1.1.1.3" xref="alg3.14.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg3.14.m1.5.5.2" xref="alg3.14.m1.5.5.2.cmml">←</mo><mrow id="alg3.14.m1.5.5.3" xref="alg3.14.m1.5.5.3.cmml"><mi id="alg3.14.m1.5.5.3.2" xref="alg3.14.m1.5.5.3.2.cmml">𝑐𝑜𝑚𝑝𝑢𝑡𝑒</mi><mo lspace="0em" rspace="0em" id="alg3.14.m1.5.5.3.1" xref="alg3.14.m1.5.5.3.1.cmml">​</mo><mi mathvariant="normal" id="alg3.14.m1.5.5.3.3" xref="alg3.14.m1.5.5.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg3.14.m1.5.5.3.1a" xref="alg3.14.m1.5.5.3.1.cmml">​</mo><mi id="alg3.14.m1.5.5.3.4" xref="alg3.14.m1.5.5.3.4.cmml">𝑘𝑟𝑢𝑚</mi><mo lspace="0em" rspace="0em" id="alg3.14.m1.5.5.3.1b" xref="alg3.14.m1.5.5.3.1.cmml">​</mo><mi mathvariant="normal" id="alg3.14.m1.5.5.3.5" xref="alg3.14.m1.5.5.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg3.14.m1.5.5.3.1c" xref="alg3.14.m1.5.5.3.1.cmml">​</mo><mi id="alg3.14.m1.5.5.3.6" xref="alg3.14.m1.5.5.3.6.cmml">𝑠𝑐𝑜𝑟𝑒</mi><mo lspace="0em" rspace="0em" id="alg3.14.m1.5.5.3.1d" xref="alg3.14.m1.5.5.3.1.cmml">​</mo><mrow id="alg3.14.m1.5.5.3.7.2" xref="alg3.14.m1.5.5.3.7.1.cmml"><mo stretchy="false" id="alg3.14.m1.5.5.3.7.2.1" xref="alg3.14.m1.5.5.3.7.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg3.14.m1.1.1" xref="alg3.14.m1.1.1.cmml">𝒲</mi><mo id="alg3.14.m1.5.5.3.7.2.2" xref="alg3.14.m1.5.5.3.7.1.cmml">,</mo><mi id="alg3.14.m1.2.2" xref="alg3.14.m1.2.2.cmml">i</mi><mo id="alg3.14.m1.5.5.3.7.2.3" xref="alg3.14.m1.5.5.3.7.1.cmml">,</mo><mi id="alg3.14.m1.3.3" xref="alg3.14.m1.3.3.cmml">m</mi><mo id="alg3.14.m1.5.5.3.7.2.4" xref="alg3.14.m1.5.5.3.7.1.cmml">,</mo><mi id="alg3.14.m1.4.4" xref="alg3.14.m1.4.4.cmml">f</mi><mo stretchy="false" id="alg3.14.m1.5.5.3.7.2.5" xref="alg3.14.m1.5.5.3.7.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.14.m1.5b"><apply id="alg3.14.m1.5.5.cmml" xref="alg3.14.m1.5.5"><ci id="alg3.14.m1.5.5.2.cmml" xref="alg3.14.m1.5.5.2">←</ci><apply id="alg3.14.m1.5.5.1.cmml" xref="alg3.14.m1.5.5.1"><times id="alg3.14.m1.5.5.1.2.cmml" xref="alg3.14.m1.5.5.1.2"></times><apply id="alg3.14.m1.5.5.1.3.cmml" xref="alg3.14.m1.5.5.1.3"><csymbol cd="ambiguous" id="alg3.14.m1.5.5.1.3.1.cmml" xref="alg3.14.m1.5.5.1.3">subscript</csymbol><ci id="alg3.14.m1.5.5.1.3.2.cmml" xref="alg3.14.m1.5.5.1.3.2">𝑆</ci><ci id="alg3.14.m1.5.5.1.3.3.cmml" xref="alg3.14.m1.5.5.1.3.3">𝑘</ci></apply><apply id="alg3.14.m1.5.5.1.1.1.1.cmml" xref="alg3.14.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="alg3.14.m1.5.5.1.1.1.1.1.cmml" xref="alg3.14.m1.5.5.1.1.1">subscript</csymbol><ci id="alg3.14.m1.5.5.1.1.1.1.2.cmml" xref="alg3.14.m1.5.5.1.1.1.1.2">𝐰</ci><ci id="alg3.14.m1.5.5.1.1.1.1.3.cmml" xref="alg3.14.m1.5.5.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg3.14.m1.5.5.3.cmml" xref="alg3.14.m1.5.5.3"><times id="alg3.14.m1.5.5.3.1.cmml" xref="alg3.14.m1.5.5.3.1"></times><ci id="alg3.14.m1.5.5.3.2.cmml" xref="alg3.14.m1.5.5.3.2">𝑐𝑜𝑚𝑝𝑢𝑡𝑒</ci><ci id="alg3.14.m1.5.5.3.3.cmml" xref="alg3.14.m1.5.5.3.3">_</ci><ci id="alg3.14.m1.5.5.3.4.cmml" xref="alg3.14.m1.5.5.3.4">𝑘𝑟𝑢𝑚</ci><ci id="alg3.14.m1.5.5.3.5.cmml" xref="alg3.14.m1.5.5.3.5">_</ci><ci id="alg3.14.m1.5.5.3.6.cmml" xref="alg3.14.m1.5.5.3.6">𝑠𝑐𝑜𝑟𝑒</ci><vector id="alg3.14.m1.5.5.3.7.1.cmml" xref="alg3.14.m1.5.5.3.7.2"><ci id="alg3.14.m1.1.1.cmml" xref="alg3.14.m1.1.1">𝒲</ci><ci id="alg3.14.m1.2.2.cmml" xref="alg3.14.m1.2.2">𝑖</ci><ci id="alg3.14.m1.3.3.cmml" xref="alg3.14.m1.3.3">𝑚</ci><ci id="alg3.14.m1.4.4.cmml" xref="alg3.14.m1.4.4">𝑓</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.14.m1.5c">S_{k}(\mathbf{w}_{i})\leftarrow\mathit{compute}\_\mathit{krum}\_\mathit{score}(\mathcal{W},i,m,f)</annotation></semantics></math> 

</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="alg3.41" class="ltx_block ltx_figure_panel">
<div id="alg3.18" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_tag ltx_tag_listingline">21</span><span class="ltx_tag ltx_tag_listingline">20</span><math id="alg3.15.m1.2" class="ltx_Math" alttext="\mathit{filter}(\mathcal{W},S_{k})" display="inline"><semantics id="alg3.15.m1.2a"><mrow id="alg3.15.m1.2.2" xref="alg3.15.m1.2.2.cmml"><mi id="alg3.15.m1.2.2.3" xref="alg3.15.m1.2.2.3.cmml">𝑓𝑖𝑙𝑡𝑒𝑟</mi><mo lspace="0em" rspace="0em" id="alg3.15.m1.2.2.2" xref="alg3.15.m1.2.2.2.cmml">​</mo><mrow id="alg3.15.m1.2.2.1.1" xref="alg3.15.m1.2.2.1.2.cmml"><mo stretchy="false" id="alg3.15.m1.2.2.1.1.2" xref="alg3.15.m1.2.2.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg3.15.m1.1.1" xref="alg3.15.m1.1.1.cmml">𝒲</mi><mo id="alg3.15.m1.2.2.1.1.3" xref="alg3.15.m1.2.2.1.2.cmml">,</mo><msub id="alg3.15.m1.2.2.1.1.1" xref="alg3.15.m1.2.2.1.1.1.cmml"><mi id="alg3.15.m1.2.2.1.1.1.2" xref="alg3.15.m1.2.2.1.1.1.2.cmml">S</mi><mi id="alg3.15.m1.2.2.1.1.1.3" xref="alg3.15.m1.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="alg3.15.m1.2.2.1.1.4" xref="alg3.15.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.15.m1.2b"><apply id="alg3.15.m1.2.2.cmml" xref="alg3.15.m1.2.2"><times id="alg3.15.m1.2.2.2.cmml" xref="alg3.15.m1.2.2.2"></times><ci id="alg3.15.m1.2.2.3.cmml" xref="alg3.15.m1.2.2.3">𝑓𝑖𝑙𝑡𝑒𝑟</ci><interval closure="open" id="alg3.15.m1.2.2.1.2.cmml" xref="alg3.15.m1.2.2.1.1"><ci id="alg3.15.m1.1.1.cmml" xref="alg3.15.m1.1.1">𝒲</ci><apply id="alg3.15.m1.2.2.1.1.1.cmml" xref="alg3.15.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg3.15.m1.2.2.1.1.1.1.cmml" xref="alg3.15.m1.2.2.1.1.1">subscript</csymbol><ci id="alg3.15.m1.2.2.1.1.1.2.cmml" xref="alg3.15.m1.2.2.1.1.1.2">𝑆</ci><ci id="alg3.15.m1.2.2.1.1.1.3.cmml" xref="alg3.15.m1.2.2.1.1.1.3">𝑘</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.15.m1.2c">\mathit{filter}(\mathcal{W},S_{k})</annotation></semantics></math>  <math id="alg3.16.m2.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.16.m2.1a"><mo id="alg3.16.m2.1.1" xref="alg3.16.m2.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.16.m2.1b"><ci id="alg3.16.m2.1.1.cmml" xref="alg3.16.m2.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.16.m2.1c">\triangleright</annotation></semantics></math> Keep local models with the <math id="alg3.17.m3.1" class="ltx_Math" alttext="L/2" display="inline"><semantics id="alg3.17.m3.1a"><mrow id="alg3.17.m3.1.1" xref="alg3.17.m3.1.1.cmml"><mi id="alg3.17.m3.1.1.2" xref="alg3.17.m3.1.1.2.cmml">L</mi><mo id="alg3.17.m3.1.1.1" xref="alg3.17.m3.1.1.1.cmml">/</mo><mn id="alg3.17.m3.1.1.3" xref="alg3.17.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.17.m3.1b"><apply id="alg3.17.m3.1.1.cmml" xref="alg3.17.m3.1.1"><divide id="alg3.17.m3.1.1.1.cmml" xref="alg3.17.m3.1.1.1"></divide><ci id="alg3.17.m3.1.1.2.cmml" xref="alg3.17.m3.1.1.2">𝐿</ci><cn type="integer" id="alg3.17.m3.1.1.3.cmml" xref="alg3.17.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.17.m3.1c">L/2</annotation></semantics></math> lowest Krum scores

<span id="alg3.18.1" class="ltx_text ltx_font_bold">return</span> <math id="alg3.18.m4.1" class="ltx_Math" alttext="\mathit{average}(\mathcal{W})" display="inline"><semantics id="alg3.18.m4.1a"><mrow id="alg3.18.m4.1.2" xref="alg3.18.m4.1.2.cmml"><mi id="alg3.18.m4.1.2.2" xref="alg3.18.m4.1.2.2.cmml">𝑎𝑣𝑒𝑟𝑎𝑔𝑒</mi><mo lspace="0em" rspace="0em" id="alg3.18.m4.1.2.1" xref="alg3.18.m4.1.2.1.cmml">​</mo><mrow id="alg3.18.m4.1.2.3.2" xref="alg3.18.m4.1.2.cmml"><mo stretchy="false" id="alg3.18.m4.1.2.3.2.1" xref="alg3.18.m4.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg3.18.m4.1.1" xref="alg3.18.m4.1.1.cmml">𝒲</mi><mo stretchy="false" id="alg3.18.m4.1.2.3.2.2" xref="alg3.18.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.18.m4.1b"><apply id="alg3.18.m4.1.2.cmml" xref="alg3.18.m4.1.2"><times id="alg3.18.m4.1.2.1.cmml" xref="alg3.18.m4.1.2.1"></times><ci id="alg3.18.m4.1.2.2.cmml" xref="alg3.18.m4.1.2.2">𝑎𝑣𝑒𝑟𝑎𝑔𝑒</ci><ci id="alg3.18.m4.1.1.cmml" xref="alg3.18.m4.1.1">𝒲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.18.m4.1c">\mathit{average}(\mathcal{W})</annotation></semantics></math> 
</div>
<div id="alg3.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span><span id="alg3.19.1" class="ltx_text ltx_font_bold">function <math id="alg3.19.1.m1.4" class="ltx_Math" alttext="\boldsymbol{\mathit{compute}\_\mathit{krum}\_\mathit{score}(\mathcal{W},i,m,f)}" display="inline"><semantics id="alg3.19.1.m1.4a"><mrow id="alg3.19.1.m1.4.5" xref="alg3.19.1.m1.4.5.cmml"><mi id="alg3.19.1.m1.4.5.2" xref="alg3.19.1.m1.4.5.2.cmml">𝑐𝑜𝑚𝑝𝑢𝑡𝑒</mi><mo lspace="0em" rspace="0em" id="alg3.19.1.m1.4.5.1" xref="alg3.19.1.m1.4.5.1.cmml">​</mo><mi class="ltx_mathvariant_bold" mathvariant="bold" id="alg3.19.1.m1.4.5.3" xref="alg3.19.1.m1.4.5.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg3.19.1.m1.4.5.1a" xref="alg3.19.1.m1.4.5.1.cmml">​</mo><mi id="alg3.19.1.m1.4.5.4" xref="alg3.19.1.m1.4.5.4.cmml">𝑘𝑟𝑢𝑚</mi><mo lspace="0em" rspace="0em" id="alg3.19.1.m1.4.5.1b" xref="alg3.19.1.m1.4.5.1.cmml">​</mo><mi class="ltx_mathvariant_bold" mathvariant="bold" id="alg3.19.1.m1.4.5.5" xref="alg3.19.1.m1.4.5.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg3.19.1.m1.4.5.1c" xref="alg3.19.1.m1.4.5.1.cmml">​</mo><mi id="alg3.19.1.m1.4.5.6" xref="alg3.19.1.m1.4.5.6.cmml">𝑠𝑐𝑜𝑟𝑒</mi><mo lspace="0em" rspace="0em" id="alg3.19.1.m1.4.5.1d" xref="alg3.19.1.m1.4.5.1.cmml">​</mo><mrow id="alg3.19.1.m1.4.5.7.2" xref="alg3.19.1.m1.4.5.7.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg3.19.1.m1.4.5.7.2.1" xref="alg3.19.1.m1.4.5.7.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg3.19.1.m1.1.1" xref="alg3.19.1.m1.1.1.cmml">𝒲</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="alg3.19.1.m1.4.5.7.2.2" xref="alg3.19.1.m1.4.5.7.1.cmml">,</mo><mi id="alg3.19.1.m1.2.2" xref="alg3.19.1.m1.2.2.cmml">i</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="alg3.19.1.m1.4.5.7.2.3" xref="alg3.19.1.m1.4.5.7.1.cmml">,</mo><mi id="alg3.19.1.m1.3.3" xref="alg3.19.1.m1.3.3.cmml">m</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="alg3.19.1.m1.4.5.7.2.4" xref="alg3.19.1.m1.4.5.7.1.cmml">,</mo><mi id="alg3.19.1.m1.4.4" xref="alg3.19.1.m1.4.4.cmml">f</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="alg3.19.1.m1.4.5.7.2.5" xref="alg3.19.1.m1.4.5.7.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.19.1.m1.4b"><apply id="alg3.19.1.m1.4.5.cmml" xref="alg3.19.1.m1.4.5"><times id="alg3.19.1.m1.4.5.1.cmml" xref="alg3.19.1.m1.4.5.1"></times><ci id="alg3.19.1.m1.4.5.2.cmml" xref="alg3.19.1.m1.4.5.2">𝑐𝑜𝑚𝑝𝑢𝑡𝑒</ci><ci id="alg3.19.1.m1.4.5.3.cmml" xref="alg3.19.1.m1.4.5.3">bold-_</ci><ci id="alg3.19.1.m1.4.5.4.cmml" xref="alg3.19.1.m1.4.5.4">𝑘𝑟𝑢𝑚</ci><ci id="alg3.19.1.m1.4.5.5.cmml" xref="alg3.19.1.m1.4.5.5">bold-_</ci><ci id="alg3.19.1.m1.4.5.6.cmml" xref="alg3.19.1.m1.4.5.6">𝑠𝑐𝑜𝑟𝑒</ci><vector id="alg3.19.1.m1.4.5.7.1.cmml" xref="alg3.19.1.m1.4.5.7.2"><ci id="alg3.19.1.m1.1.1.cmml" xref="alg3.19.1.m1.1.1">𝒲</ci><ci id="alg3.19.1.m1.2.2.cmml" xref="alg3.19.1.m1.2.2">𝑖</ci><ci id="alg3.19.1.m1.3.3.cmml" xref="alg3.19.1.m1.3.3">𝑚</ci><ci id="alg3.19.1.m1.4.4.cmml" xref="alg3.19.1.m1.4.4">𝑓</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.19.1.m1.4c">\boldsymbol{\mathit{compute}\_\mathit{krum}\_\mathit{score}(\mathcal{W},i,m,f)}</annotation></semantics></math></span>
<span id="alg3.19.2" class="ltx_text ltx_font_bold">begin</span>
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="alg3.42" class="ltx_block ltx_figure_panel">
<div id="alg3.26" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_tag ltx_tag_listingline">25</span><span class="ltx_tag ltx_tag_listingline">24</span><span class="ltx_tag ltx_tag_listingline">23</span>
<math id="alg3.20.m1.1" class="ltx_Math" alttext="d\leftarrow[]" display="inline"><semantics id="alg3.20.m1.1a"><mrow id="alg3.20.m1.1.1" xref="alg3.20.m1.1.1.cmml"><mi id="alg3.20.m1.1.1.2" xref="alg3.20.m1.1.1.2.cmml">d</mi><mo stretchy="false" id="alg3.20.m1.1.1.1" xref="alg3.20.m1.1.1.1.cmml">←</mo><mrow id="alg3.20.m1.1.1.3.2" xref="alg3.20.m1.1.1.cmml"><mo stretchy="false" id="alg3.20.m1.1.1.3.2.1" xref="alg3.20.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="alg3.20.m1.1.1.3.2.2" xref="alg3.20.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.20.m1.1b"><apply id="alg3.20.m1.1.1.cmml" xref="alg3.20.m1.1.1"><ci id="alg3.20.m1.1.1.1.cmml" xref="alg3.20.m1.1.1.1">←</ci><ci id="alg3.20.m1.1.1.2.cmml" xref="alg3.20.m1.1.1.2">𝑑</ci><list id="alg3.20.m1.1.1.3.1.cmml" xref="alg3.20.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.20.m1.1c">d\leftarrow[]</annotation></semantics></math>  <math id="alg3.21.m2.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.21.m2.1a"><mo id="alg3.21.m2.1.1" xref="alg3.21.m2.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.21.m2.1b"><ci id="alg3.21.m2.1.1.cmml" xref="alg3.21.m2.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.21.m2.1c">\triangleright</annotation></semantics></math> Square distances of <math id="alg3.22.m3.1" class="ltx_Math" alttext="\mathbf{w}_{i}" display="inline"><semantics id="alg3.22.m3.1a"><msub id="alg3.22.m3.1.1" xref="alg3.22.m3.1.1.cmml"><mi id="alg3.22.m3.1.1.2" xref="alg3.22.m3.1.1.2.cmml">𝐰</mi><mi id="alg3.22.m3.1.1.3" xref="alg3.22.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.22.m3.1b"><apply id="alg3.22.m3.1.1.cmml" xref="alg3.22.m3.1.1"><csymbol cd="ambiguous" id="alg3.22.m3.1.1.1.cmml" xref="alg3.22.m3.1.1">subscript</csymbol><ci id="alg3.22.m3.1.1.2.cmml" xref="alg3.22.m3.1.1.2">𝐰</ci><ci id="alg3.22.m3.1.1.3.cmml" xref="alg3.22.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.22.m3.1c">\mathbf{w}_{i}</annotation></semantics></math> to other local models.
<math id="alg3.23.m4.1" class="ltx_Math" alttext="L\leftarrow|\mathcal{W}|" display="inline"><semantics id="alg3.23.m4.1a"><mrow id="alg3.23.m4.1.2" xref="alg3.23.m4.1.2.cmml"><mi id="alg3.23.m4.1.2.2" xref="alg3.23.m4.1.2.2.cmml">L</mi><mo stretchy="false" id="alg3.23.m4.1.2.1" xref="alg3.23.m4.1.2.1.cmml">←</mo><mrow id="alg3.23.m4.1.2.3.2" xref="alg3.23.m4.1.2.3.1.cmml"><mo stretchy="false" id="alg3.23.m4.1.2.3.2.1" xref="alg3.23.m4.1.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg3.23.m4.1.1" xref="alg3.23.m4.1.1.cmml">𝒲</mi><mo stretchy="false" id="alg3.23.m4.1.2.3.2.2" xref="alg3.23.m4.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.23.m4.1b"><apply id="alg3.23.m4.1.2.cmml" xref="alg3.23.m4.1.2"><ci id="alg3.23.m4.1.2.1.cmml" xref="alg3.23.m4.1.2.1">←</ci><ci id="alg3.23.m4.1.2.2.cmml" xref="alg3.23.m4.1.2.2">𝐿</ci><apply id="alg3.23.m4.1.2.3.1.cmml" xref="alg3.23.m4.1.2.3.2"><abs id="alg3.23.m4.1.2.3.1.1.cmml" xref="alg3.23.m4.1.2.3.2.1"></abs><ci id="alg3.23.m4.1.1.cmml" xref="alg3.23.m4.1.1">𝒲</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.23.m4.1c">L\leftarrow|\mathcal{W}|</annotation></semantics></math>  <math id="alg3.24.m5.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.24.m5.1a"><mo id="alg3.24.m5.1.1" xref="alg3.24.m5.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.24.m5.1b"><ci id="alg3.24.m5.1.1.cmml" xref="alg3.24.m5.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.24.m5.1c">\triangleright</annotation></semantics></math>  <math id="alg3.25.m6.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg3.25.m6.1a"><mi id="alg3.25.m6.1.1" xref="alg3.25.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg3.25.m6.1b"><ci id="alg3.25.m6.1.1.cmml" xref="alg3.25.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.25.m6.1c">L</annotation></semantics></math>: the number of clients in each FL round.
<span id="alg3.26.2" class="ltx_text ltx_font_bold">for</span> <em id="alg3.26.1" class="ltx_emph ltx_font_italic"><math id="alg3.26.1.m1.1" class="ltx_Math" alttext="\mathbf{w}_{j}\in\mathcal{W}" display="inline"><semantics id="alg3.26.1.m1.1a"><mrow id="alg3.26.1.m1.1.1" xref="alg3.26.1.m1.1.1.cmml"><msub id="alg3.26.1.m1.1.1.2" xref="alg3.26.1.m1.1.1.2.cmml"><mi id="alg3.26.1.m1.1.1.2.2" xref="alg3.26.1.m1.1.1.2.2.cmml">𝐰</mi><mi id="alg3.26.1.m1.1.1.2.3" xref="alg3.26.1.m1.1.1.2.3.cmml">j</mi></msub><mo id="alg3.26.1.m1.1.1.1" xref="alg3.26.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg3.26.1.m1.1.1.3" xref="alg3.26.1.m1.1.1.3.cmml">𝒲</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.26.1.m1.1b"><apply id="alg3.26.1.m1.1.1.cmml" xref="alg3.26.1.m1.1.1"><in id="alg3.26.1.m1.1.1.1.cmml" xref="alg3.26.1.m1.1.1.1"></in><apply id="alg3.26.1.m1.1.1.2.cmml" xref="alg3.26.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.26.1.m1.1.1.2.1.cmml" xref="alg3.26.1.m1.1.1.2">subscript</csymbol><ci id="alg3.26.1.m1.1.1.2.2.cmml" xref="alg3.26.1.m1.1.1.2.2">𝐰</ci><ci id="alg3.26.1.m1.1.1.2.3.cmml" xref="alg3.26.1.m1.1.1.2.3">𝑗</ci></apply><ci id="alg3.26.1.m1.1.1.3.cmml" xref="alg3.26.1.m1.1.1.3">𝒲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.26.1.m1.1c">\mathbf{w}_{j}\in\mathcal{W}</annotation></semantics></math></em> <span id="alg3.26.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="alg3.27" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_tag ltx_tag_listingline">26</span>
<span id="alg3.27.2" class="ltx_text ltx_font_bold">if</span> <em id="alg3.27.1" class="ltx_emph ltx_font_italic"><math id="alg3.27.1.m1.1" class="ltx_Math" alttext="i\neq j" display="inline"><semantics id="alg3.27.1.m1.1a"><mrow id="alg3.27.1.m1.1.1" xref="alg3.27.1.m1.1.1.cmml"><mi id="alg3.27.1.m1.1.1.2" xref="alg3.27.1.m1.1.1.2.cmml">i</mi><mo id="alg3.27.1.m1.1.1.1" xref="alg3.27.1.m1.1.1.1.cmml">≠</mo><mi id="alg3.27.1.m1.1.1.3" xref="alg3.27.1.m1.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.27.1.m1.1b"><apply id="alg3.27.1.m1.1.1.cmml" xref="alg3.27.1.m1.1.1"><neq id="alg3.27.1.m1.1.1.1.cmml" xref="alg3.27.1.m1.1.1.1"></neq><ci id="alg3.27.1.m1.1.1.2.cmml" xref="alg3.27.1.m1.1.1.2">𝑖</ci><ci id="alg3.27.1.m1.1.1.3.cmml" xref="alg3.27.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.27.1.m1.1c">i\neq j</annotation></semantics></math></em> <span id="alg3.27.3" class="ltx_text ltx_font_bold">then</span>
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="alg3.43" class="ltx_block ltx_figure_panel">
<div id="alg3.30" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="alg3.28.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="alg3.28.m1.1a"><mi id="alg3.28.m1.1.1" xref="alg3.28.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="alg3.28.m1.1b"><ci id="alg3.28.m1.1.1.cmml" xref="alg3.28.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.28.m1.1c">d</annotation></semantics></math>.<math id="alg3.29.m2.1" class="ltx_Math" alttext="\mathit{append}" display="inline"><semantics id="alg3.29.m2.1a"><mi id="alg3.29.m2.1.1" xref="alg3.29.m2.1.1.cmml">𝑎𝑝𝑝𝑒𝑛𝑑</mi><annotation-xml encoding="MathML-Content" id="alg3.29.m2.1b"><ci id="alg3.29.m2.1.1.cmml" xref="alg3.29.m2.1.1">𝑎𝑝𝑝𝑒𝑛𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.29.m2.1c">\mathit{append}</annotation></semantics></math>(<math id="alg3.30.m3.1" class="ltx_Math" alttext="||\mathbf{w}_{i}-\mathbf{w}_{j}||^{2}" display="inline"><semantics id="alg3.30.m3.1a"><msup id="alg3.30.m3.1.1" xref="alg3.30.m3.1.1.cmml"><mrow id="alg3.30.m3.1.1.1.1" xref="alg3.30.m3.1.1.1.2.cmml"><mo stretchy="false" id="alg3.30.m3.1.1.1.1.2" xref="alg3.30.m3.1.1.1.2.1.cmml">‖</mo><mrow id="alg3.30.m3.1.1.1.1.1" xref="alg3.30.m3.1.1.1.1.1.cmml"><msub id="alg3.30.m3.1.1.1.1.1.2" xref="alg3.30.m3.1.1.1.1.1.2.cmml"><mi id="alg3.30.m3.1.1.1.1.1.2.2" xref="alg3.30.m3.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="alg3.30.m3.1.1.1.1.1.2.3" xref="alg3.30.m3.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="alg3.30.m3.1.1.1.1.1.1" xref="alg3.30.m3.1.1.1.1.1.1.cmml">−</mo><msub id="alg3.30.m3.1.1.1.1.1.3" xref="alg3.30.m3.1.1.1.1.1.3.cmml"><mi id="alg3.30.m3.1.1.1.1.1.3.2" xref="alg3.30.m3.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="alg3.30.m3.1.1.1.1.1.3.3" xref="alg3.30.m3.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="alg3.30.m3.1.1.1.1.3" xref="alg3.30.m3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="alg3.30.m3.1.1.3" xref="alg3.30.m3.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="alg3.30.m3.1b"><apply id="alg3.30.m3.1.1.cmml" xref="alg3.30.m3.1.1"><csymbol cd="ambiguous" id="alg3.30.m3.1.1.2.cmml" xref="alg3.30.m3.1.1">superscript</csymbol><apply id="alg3.30.m3.1.1.1.2.cmml" xref="alg3.30.m3.1.1.1.1"><csymbol cd="latexml" id="alg3.30.m3.1.1.1.2.1.cmml" xref="alg3.30.m3.1.1.1.1.2">norm</csymbol><apply id="alg3.30.m3.1.1.1.1.1.cmml" xref="alg3.30.m3.1.1.1.1.1"><minus id="alg3.30.m3.1.1.1.1.1.1.cmml" xref="alg3.30.m3.1.1.1.1.1.1"></minus><apply id="alg3.30.m3.1.1.1.1.1.2.cmml" xref="alg3.30.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg3.30.m3.1.1.1.1.1.2.1.cmml" xref="alg3.30.m3.1.1.1.1.1.2">subscript</csymbol><ci id="alg3.30.m3.1.1.1.1.1.2.2.cmml" xref="alg3.30.m3.1.1.1.1.1.2.2">𝐰</ci><ci id="alg3.30.m3.1.1.1.1.1.2.3.cmml" xref="alg3.30.m3.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="alg3.30.m3.1.1.1.1.1.3.cmml" xref="alg3.30.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.30.m3.1.1.1.1.1.3.1.cmml" xref="alg3.30.m3.1.1.1.1.1.3">subscript</csymbol><ci id="alg3.30.m3.1.1.1.1.1.3.2.cmml" xref="alg3.30.m3.1.1.1.1.1.3.2">𝐰</ci><ci id="alg3.30.m3.1.1.1.1.1.3.3.cmml" xref="alg3.30.m3.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><cn type="integer" id="alg3.30.m3.1.1.3.cmml" xref="alg3.30.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.30.m3.1c">||\mathbf{w}_{i}-\mathbf{w}_{j}||^{2}</annotation></semantics></math>)
</div>
<div id="alg3.43.1" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="alg3.44" class="ltx_block ltx_figure_panel">
<div id="alg3.37" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_tag ltx_tag_listingline">29</span><span class="ltx_tag ltx_tag_listingline">28</span><span class="ltx_tag ltx_tag_listingline">27</span><math id="alg3.31.m1.1" class="ltx_Math" alttext="\mathit{sort}(d)" display="inline"><semantics id="alg3.31.m1.1a"><mrow id="alg3.31.m1.1.2" xref="alg3.31.m1.1.2.cmml"><mi id="alg3.31.m1.1.2.2" xref="alg3.31.m1.1.2.2.cmml">𝑠𝑜𝑟𝑡</mi><mo lspace="0em" rspace="0em" id="alg3.31.m1.1.2.1" xref="alg3.31.m1.1.2.1.cmml">​</mo><mrow id="alg3.31.m1.1.2.3.2" xref="alg3.31.m1.1.2.cmml"><mo stretchy="false" id="alg3.31.m1.1.2.3.2.1" xref="alg3.31.m1.1.2.cmml">(</mo><mi id="alg3.31.m1.1.1" xref="alg3.31.m1.1.1.cmml">d</mi><mo stretchy="false" id="alg3.31.m1.1.2.3.2.2" xref="alg3.31.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.31.m1.1b"><apply id="alg3.31.m1.1.2.cmml" xref="alg3.31.m1.1.2"><times id="alg3.31.m1.1.2.1.cmml" xref="alg3.31.m1.1.2.1"></times><ci id="alg3.31.m1.1.2.2.cmml" xref="alg3.31.m1.1.2.2">𝑠𝑜𝑟𝑡</ci><ci id="alg3.31.m1.1.1.cmml" xref="alg3.31.m1.1.1">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.31.m1.1c">\mathit{sort}(d)</annotation></semantics></math>  <math id="alg3.32.m2.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.32.m2.1a"><mo id="alg3.32.m2.1.1" xref="alg3.32.m2.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.32.m2.1b"><ci id="alg3.32.m2.1.1.cmml" xref="alg3.32.m2.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.32.m2.1c">\triangleright</annotation></semantics></math> In ascending order 
<math id="alg3.33.m3.1" class="ltx_Math" alttext="S_{k}(\mathbf{w}_{i})\leftarrow\sum_{k=0}^{L-f-3}d" display="inline"><semantics id="alg3.33.m3.1a"><mrow id="alg3.33.m3.1.1" xref="alg3.33.m3.1.1.cmml"><mrow id="alg3.33.m3.1.1.1" xref="alg3.33.m3.1.1.1.cmml"><msub id="alg3.33.m3.1.1.1.3" xref="alg3.33.m3.1.1.1.3.cmml"><mi id="alg3.33.m3.1.1.1.3.2" xref="alg3.33.m3.1.1.1.3.2.cmml">S</mi><mi id="alg3.33.m3.1.1.1.3.3" xref="alg3.33.m3.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="alg3.33.m3.1.1.1.2" xref="alg3.33.m3.1.1.1.2.cmml">​</mo><mrow id="alg3.33.m3.1.1.1.1.1" xref="alg3.33.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.33.m3.1.1.1.1.1.2" xref="alg3.33.m3.1.1.1.1.1.1.cmml">(</mo><msub id="alg3.33.m3.1.1.1.1.1.1" xref="alg3.33.m3.1.1.1.1.1.1.cmml"><mi id="alg3.33.m3.1.1.1.1.1.1.2" xref="alg3.33.m3.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="alg3.33.m3.1.1.1.1.1.1.3" xref="alg3.33.m3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg3.33.m3.1.1.1.1.1.3" xref="alg3.33.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" stretchy="false" id="alg3.33.m3.1.1.2" xref="alg3.33.m3.1.1.2.cmml">←</mo><mrow id="alg3.33.m3.1.1.3" xref="alg3.33.m3.1.1.3.cmml"><msubsup id="alg3.33.m3.1.1.3.1" xref="alg3.33.m3.1.1.3.1.cmml"><mo id="alg3.33.m3.1.1.3.1.2.2" xref="alg3.33.m3.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg3.33.m3.1.1.3.1.2.3" xref="alg3.33.m3.1.1.3.1.2.3.cmml"><mi id="alg3.33.m3.1.1.3.1.2.3.2" xref="alg3.33.m3.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg3.33.m3.1.1.3.1.2.3.1" xref="alg3.33.m3.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg3.33.m3.1.1.3.1.2.3.3" xref="alg3.33.m3.1.1.3.1.2.3.3.cmml">0</mn></mrow><mrow id="alg3.33.m3.1.1.3.1.3" xref="alg3.33.m3.1.1.3.1.3.cmml"><mi id="alg3.33.m3.1.1.3.1.3.2" xref="alg3.33.m3.1.1.3.1.3.2.cmml">L</mi><mo id="alg3.33.m3.1.1.3.1.3.1" xref="alg3.33.m3.1.1.3.1.3.1.cmml">−</mo><mi id="alg3.33.m3.1.1.3.1.3.3" xref="alg3.33.m3.1.1.3.1.3.3.cmml">f</mi><mo id="alg3.33.m3.1.1.3.1.3.1a" xref="alg3.33.m3.1.1.3.1.3.1.cmml">−</mo><mn id="alg3.33.m3.1.1.3.1.3.4" xref="alg3.33.m3.1.1.3.1.3.4.cmml">3</mn></mrow></msubsup><mi id="alg3.33.m3.1.1.3.2" xref="alg3.33.m3.1.1.3.2.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.33.m3.1b"><apply id="alg3.33.m3.1.1.cmml" xref="alg3.33.m3.1.1"><ci id="alg3.33.m3.1.1.2.cmml" xref="alg3.33.m3.1.1.2">←</ci><apply id="alg3.33.m3.1.1.1.cmml" xref="alg3.33.m3.1.1.1"><times id="alg3.33.m3.1.1.1.2.cmml" xref="alg3.33.m3.1.1.1.2"></times><apply id="alg3.33.m3.1.1.1.3.cmml" xref="alg3.33.m3.1.1.1.3"><csymbol cd="ambiguous" id="alg3.33.m3.1.1.1.3.1.cmml" xref="alg3.33.m3.1.1.1.3">subscript</csymbol><ci id="alg3.33.m3.1.1.1.3.2.cmml" xref="alg3.33.m3.1.1.1.3.2">𝑆</ci><ci id="alg3.33.m3.1.1.1.3.3.cmml" xref="alg3.33.m3.1.1.1.3.3">𝑘</ci></apply><apply id="alg3.33.m3.1.1.1.1.1.1.cmml" xref="alg3.33.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.33.m3.1.1.1.1.1.1.1.cmml" xref="alg3.33.m3.1.1.1.1.1">subscript</csymbol><ci id="alg3.33.m3.1.1.1.1.1.1.2.cmml" xref="alg3.33.m3.1.1.1.1.1.1.2">𝐰</ci><ci id="alg3.33.m3.1.1.1.1.1.1.3.cmml" xref="alg3.33.m3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg3.33.m3.1.1.3.cmml" xref="alg3.33.m3.1.1.3"><apply id="alg3.33.m3.1.1.3.1.cmml" xref="alg3.33.m3.1.1.3.1"><csymbol cd="ambiguous" id="alg3.33.m3.1.1.3.1.1.cmml" xref="alg3.33.m3.1.1.3.1">superscript</csymbol><apply id="alg3.33.m3.1.1.3.1.2.cmml" xref="alg3.33.m3.1.1.3.1"><csymbol cd="ambiguous" id="alg3.33.m3.1.1.3.1.2.1.cmml" xref="alg3.33.m3.1.1.3.1">subscript</csymbol><sum id="alg3.33.m3.1.1.3.1.2.2.cmml" xref="alg3.33.m3.1.1.3.1.2.2"></sum><apply id="alg3.33.m3.1.1.3.1.2.3.cmml" xref="alg3.33.m3.1.1.3.1.2.3"><eq id="alg3.33.m3.1.1.3.1.2.3.1.cmml" xref="alg3.33.m3.1.1.3.1.2.3.1"></eq><ci id="alg3.33.m3.1.1.3.1.2.3.2.cmml" xref="alg3.33.m3.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg3.33.m3.1.1.3.1.2.3.3.cmml" xref="alg3.33.m3.1.1.3.1.2.3.3">0</cn></apply></apply><apply id="alg3.33.m3.1.1.3.1.3.cmml" xref="alg3.33.m3.1.1.3.1.3"><minus id="alg3.33.m3.1.1.3.1.3.1.cmml" xref="alg3.33.m3.1.1.3.1.3.1"></minus><ci id="alg3.33.m3.1.1.3.1.3.2.cmml" xref="alg3.33.m3.1.1.3.1.3.2">𝐿</ci><ci id="alg3.33.m3.1.1.3.1.3.3.cmml" xref="alg3.33.m3.1.1.3.1.3.3">𝑓</ci><cn type="integer" id="alg3.33.m3.1.1.3.1.3.4.cmml" xref="alg3.33.m3.1.1.3.1.3.4">3</cn></apply></apply><ci id="alg3.33.m3.1.1.3.2.cmml" xref="alg3.33.m3.1.1.3.2">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.33.m3.1c">S_{k}(\mathbf{w}_{i})\leftarrow\sum_{k=0}^{L-f-3}d</annotation></semantics></math>  <math id="alg3.34.m4.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg3.34.m4.1a"><mo id="alg3.34.m4.1.1" xref="alg3.34.m4.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg3.34.m4.1b"><ci id="alg3.34.m4.1.1.cmml" xref="alg3.34.m4.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.34.m4.1c">\triangleright</annotation></semantics></math> Use the smallest <math id="alg3.35.m5.1" class="ltx_Math" alttext="L-f-2" display="inline"><semantics id="alg3.35.m5.1a"><mrow id="alg3.35.m5.1.1" xref="alg3.35.m5.1.1.cmml"><mi id="alg3.35.m5.1.1.2" xref="alg3.35.m5.1.1.2.cmml">L</mi><mo id="alg3.35.m5.1.1.1" xref="alg3.35.m5.1.1.1.cmml">−</mo><mi id="alg3.35.m5.1.1.3" xref="alg3.35.m5.1.1.3.cmml">f</mi><mo id="alg3.35.m5.1.1.1a" xref="alg3.35.m5.1.1.1.cmml">−</mo><mn id="alg3.35.m5.1.1.4" xref="alg3.35.m5.1.1.4.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.35.m5.1b"><apply id="alg3.35.m5.1.1.cmml" xref="alg3.35.m5.1.1"><minus id="alg3.35.m5.1.1.1.cmml" xref="alg3.35.m5.1.1.1"></minus><ci id="alg3.35.m5.1.1.2.cmml" xref="alg3.35.m5.1.1.2">𝐿</ci><ci id="alg3.35.m5.1.1.3.cmml" xref="alg3.35.m5.1.1.3">𝑓</ci><cn type="integer" id="alg3.35.m5.1.1.4.cmml" xref="alg3.35.m5.1.1.4">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.35.m5.1c">L-f-2</annotation></semantics></math> scores to compute <math id="alg3.36.m6.1" class="ltx_Math" alttext="S_{k}(\mathbf{w}_{i})" display="inline"><semantics id="alg3.36.m6.1a"><mrow id="alg3.36.m6.1.1" xref="alg3.36.m6.1.1.cmml"><msub id="alg3.36.m6.1.1.3" xref="alg3.36.m6.1.1.3.cmml"><mi id="alg3.36.m6.1.1.3.2" xref="alg3.36.m6.1.1.3.2.cmml">S</mi><mi id="alg3.36.m6.1.1.3.3" xref="alg3.36.m6.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="alg3.36.m6.1.1.2" xref="alg3.36.m6.1.1.2.cmml">​</mo><mrow id="alg3.36.m6.1.1.1.1" xref="alg3.36.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.36.m6.1.1.1.1.2" xref="alg3.36.m6.1.1.1.1.1.cmml">(</mo><msub id="alg3.36.m6.1.1.1.1.1" xref="alg3.36.m6.1.1.1.1.1.cmml"><mi id="alg3.36.m6.1.1.1.1.1.2" xref="alg3.36.m6.1.1.1.1.1.2.cmml">𝐰</mi><mi id="alg3.36.m6.1.1.1.1.1.3" xref="alg3.36.m6.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg3.36.m6.1.1.1.1.3" xref="alg3.36.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.36.m6.1b"><apply id="alg3.36.m6.1.1.cmml" xref="alg3.36.m6.1.1"><times id="alg3.36.m6.1.1.2.cmml" xref="alg3.36.m6.1.1.2"></times><apply id="alg3.36.m6.1.1.3.cmml" xref="alg3.36.m6.1.1.3"><csymbol cd="ambiguous" id="alg3.36.m6.1.1.3.1.cmml" xref="alg3.36.m6.1.1.3">subscript</csymbol><ci id="alg3.36.m6.1.1.3.2.cmml" xref="alg3.36.m6.1.1.3.2">𝑆</ci><ci id="alg3.36.m6.1.1.3.3.cmml" xref="alg3.36.m6.1.1.3.3">𝑘</ci></apply><apply id="alg3.36.m6.1.1.1.1.1.cmml" xref="alg3.36.m6.1.1.1.1"><csymbol cd="ambiguous" id="alg3.36.m6.1.1.1.1.1.1.cmml" xref="alg3.36.m6.1.1.1.1">subscript</csymbol><ci id="alg3.36.m6.1.1.1.1.1.2.cmml" xref="alg3.36.m6.1.1.1.1.1.2">𝐰</ci><ci id="alg3.36.m6.1.1.1.1.1.3.cmml" xref="alg3.36.m6.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.36.m6.1c">S_{k}(\mathbf{w}_{i})</annotation></semantics></math>
<span id="alg3.37.1" class="ltx_text ltx_font_bold">return</span> <math id="alg3.37.m7.1" class="ltx_Math" alttext="S_{k}(\mathbf{w}_{i})" display="inline"><semantics id="alg3.37.m7.1a"><mrow id="alg3.37.m7.1.1" xref="alg3.37.m7.1.1.cmml"><msub id="alg3.37.m7.1.1.3" xref="alg3.37.m7.1.1.3.cmml"><mi id="alg3.37.m7.1.1.3.2" xref="alg3.37.m7.1.1.3.2.cmml">S</mi><mi id="alg3.37.m7.1.1.3.3" xref="alg3.37.m7.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="alg3.37.m7.1.1.2" xref="alg3.37.m7.1.1.2.cmml">​</mo><mrow id="alg3.37.m7.1.1.1.1" xref="alg3.37.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.37.m7.1.1.1.1.2" xref="alg3.37.m7.1.1.1.1.1.cmml">(</mo><msub id="alg3.37.m7.1.1.1.1.1" xref="alg3.37.m7.1.1.1.1.1.cmml"><mi id="alg3.37.m7.1.1.1.1.1.2" xref="alg3.37.m7.1.1.1.1.1.2.cmml">𝐰</mi><mi id="alg3.37.m7.1.1.1.1.1.3" xref="alg3.37.m7.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg3.37.m7.1.1.1.1.3" xref="alg3.37.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.37.m7.1b"><apply id="alg3.37.m7.1.1.cmml" xref="alg3.37.m7.1.1"><times id="alg3.37.m7.1.1.2.cmml" xref="alg3.37.m7.1.1.2"></times><apply id="alg3.37.m7.1.1.3.cmml" xref="alg3.37.m7.1.1.3"><csymbol cd="ambiguous" id="alg3.37.m7.1.1.3.1.cmml" xref="alg3.37.m7.1.1.3">subscript</csymbol><ci id="alg3.37.m7.1.1.3.2.cmml" xref="alg3.37.m7.1.1.3.2">𝑆</ci><ci id="alg3.37.m7.1.1.3.3.cmml" xref="alg3.37.m7.1.1.3.3">𝑘</ci></apply><apply id="alg3.37.m7.1.1.1.1.1.cmml" xref="alg3.37.m7.1.1.1.1"><csymbol cd="ambiguous" id="alg3.37.m7.1.1.1.1.1.1.cmml" xref="alg3.37.m7.1.1.1.1">subscript</csymbol><ci id="alg3.37.m7.1.1.1.1.1.2.cmml" xref="alg3.37.m7.1.1.1.1.1.2">𝐰</ci><ci id="alg3.37.m7.1.1.1.1.1.3.cmml" xref="alg3.37.m7.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.37.m7.1c">S_{k}(\mathbf{w}_{i})</annotation></semantics></math>

</div>
<div id="alg3.44.1" class="ltx_listingline">
</div>
</div>
</div>
</div>
</figure>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Proof of the range of <math id="A1.SS2.1.m1.1" class="ltx_Math" alttext="\mathit{PPV}" display="inline"><semantics id="A1.SS2.1.m1.1b"><mi id="A1.SS2.1.m1.1.1" xref="A1.SS2.1.m1.1.1.cmml">𝑃𝑃𝑉</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.1.m1.1c"><ci id="A1.SS2.1.m1.1.1.cmml" xref="A1.SS2.1.m1.1.1">𝑃𝑃𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.1.m1.1d">\mathit{PPV}</annotation></semantics></math>
</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.2" class="ltx_p">Below we prove the upper bound of <math id="A1.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathit{PPV}" display="inline"><semantics id="A1.SS2.p1.1.m1.1a"><mi id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml">𝑃𝑃𝑉</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><ci id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">𝑃𝑃𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">\mathit{PPV}</annotation></semantics></math> to be <math id="A1.SS2.p1.2.m2.1" class="ltx_Math" alttext="\frac{1}{2}" display="inline"><semantics id="A1.SS2.p1.2.m2.1a"><mfrac id="A1.SS2.p1.2.m2.1.1" xref="A1.SS2.p1.2.m2.1.1.cmml"><mn id="A1.SS2.p1.2.m2.1.1.2" xref="A1.SS2.p1.2.m2.1.1.2.cmml">1</mn><mn id="A1.SS2.p1.2.m2.1.1.3" xref="A1.SS2.p1.2.m2.1.1.3.cmml">2</mn></mfrac><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.1b"><apply id="A1.SS2.p1.2.m2.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1"><divide id="A1.SS2.p1.2.m2.1.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1"></divide><cn type="integer" id="A1.SS2.p1.2.m2.1.1.2.cmml" xref="A1.SS2.p1.2.m2.1.1.2">1</cn><cn type="integer" id="A1.SS2.p1.2.m2.1.1.3.cmml" xref="A1.SS2.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.1c">\frac{1}{2}</annotation></semantics></math>.</p>
</div>
<div id="A1.SS2.2" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="A1.SS2.2.p1" class="ltx_para">
<p id="A1.SS2.2.p1.6" class="ltx_p"><math id="A1.SS2.2.p1.1.m1.1" class="ltx_Math" alttext="\mathit{PPV}=\frac{N_{\mathit{TP}}}{N_{\mathit{TP}}+N_{\mathit{FP}}+N_{\mathit{total}}}" display="inline"><semantics id="A1.SS2.2.p1.1.m1.1a"><mrow id="A1.SS2.2.p1.1.m1.1.1" xref="A1.SS2.2.p1.1.m1.1.1.cmml"><mi id="A1.SS2.2.p1.1.m1.1.1.2" xref="A1.SS2.2.p1.1.m1.1.1.2.cmml">𝑃𝑃𝑉</mi><mo id="A1.SS2.2.p1.1.m1.1.1.1" xref="A1.SS2.2.p1.1.m1.1.1.1.cmml">=</mo><mfrac id="A1.SS2.2.p1.1.m1.1.1.3" xref="A1.SS2.2.p1.1.m1.1.1.3.cmml"><msub id="A1.SS2.2.p1.1.m1.1.1.3.2" xref="A1.SS2.2.p1.1.m1.1.1.3.2.cmml"><mi id="A1.SS2.2.p1.1.m1.1.1.3.2.2" xref="A1.SS2.2.p1.1.m1.1.1.3.2.2.cmml">N</mi><mi id="A1.SS2.2.p1.1.m1.1.1.3.2.3" xref="A1.SS2.2.p1.1.m1.1.1.3.2.3.cmml">𝑇𝑃</mi></msub><mrow id="A1.SS2.2.p1.1.m1.1.1.3.3" xref="A1.SS2.2.p1.1.m1.1.1.3.3.cmml"><msub id="A1.SS2.2.p1.1.m1.1.1.3.3.2" xref="A1.SS2.2.p1.1.m1.1.1.3.3.2.cmml"><mi id="A1.SS2.2.p1.1.m1.1.1.3.3.2.2" xref="A1.SS2.2.p1.1.m1.1.1.3.3.2.2.cmml">N</mi><mi id="A1.SS2.2.p1.1.m1.1.1.3.3.2.3" xref="A1.SS2.2.p1.1.m1.1.1.3.3.2.3.cmml">𝑇𝑃</mi></msub><mo id="A1.SS2.2.p1.1.m1.1.1.3.3.1" xref="A1.SS2.2.p1.1.m1.1.1.3.3.1.cmml">+</mo><msub id="A1.SS2.2.p1.1.m1.1.1.3.3.3" xref="A1.SS2.2.p1.1.m1.1.1.3.3.3.cmml"><mi id="A1.SS2.2.p1.1.m1.1.1.3.3.3.2" xref="A1.SS2.2.p1.1.m1.1.1.3.3.3.2.cmml">N</mi><mi id="A1.SS2.2.p1.1.m1.1.1.3.3.3.3" xref="A1.SS2.2.p1.1.m1.1.1.3.3.3.3.cmml">𝐹𝑃</mi></msub><mo id="A1.SS2.2.p1.1.m1.1.1.3.3.1a" xref="A1.SS2.2.p1.1.m1.1.1.3.3.1.cmml">+</mo><msub id="A1.SS2.2.p1.1.m1.1.1.3.3.4" xref="A1.SS2.2.p1.1.m1.1.1.3.3.4.cmml"><mi id="A1.SS2.2.p1.1.m1.1.1.3.3.4.2" xref="A1.SS2.2.p1.1.m1.1.1.3.3.4.2.cmml">N</mi><mi id="A1.SS2.2.p1.1.m1.1.1.3.3.4.3" xref="A1.SS2.2.p1.1.m1.1.1.3.3.4.3.cmml">𝑡𝑜𝑡𝑎𝑙</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.2.p1.1.m1.1b"><apply id="A1.SS2.2.p1.1.m1.1.1.cmml" xref="A1.SS2.2.p1.1.m1.1.1"><eq id="A1.SS2.2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.2.p1.1.m1.1.1.1"></eq><ci id="A1.SS2.2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.2.p1.1.m1.1.1.2">𝑃𝑃𝑉</ci><apply id="A1.SS2.2.p1.1.m1.1.1.3.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3"><divide id="A1.SS2.2.p1.1.m1.1.1.3.1.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3"></divide><apply id="A1.SS2.2.p1.1.m1.1.1.3.2.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS2.2.p1.1.m1.1.1.3.2.1.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="A1.SS2.2.p1.1.m1.1.1.3.2.2.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.2.2">𝑁</ci><ci id="A1.SS2.2.p1.1.m1.1.1.3.2.3.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.2.3">𝑇𝑃</ci></apply><apply id="A1.SS2.2.p1.1.m1.1.1.3.3.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3"><plus id="A1.SS2.2.p1.1.m1.1.1.3.3.1.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.1"></plus><apply id="A1.SS2.2.p1.1.m1.1.1.3.3.2.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.SS2.2.p1.1.m1.1.1.3.3.2.1.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.2">subscript</csymbol><ci id="A1.SS2.2.p1.1.m1.1.1.3.3.2.2.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.2.2">𝑁</ci><ci id="A1.SS2.2.p1.1.m1.1.1.3.3.2.3.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.2.3">𝑇𝑃</ci></apply><apply id="A1.SS2.2.p1.1.m1.1.1.3.3.3.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.SS2.2.p1.1.m1.1.1.3.3.3.1.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="A1.SS2.2.p1.1.m1.1.1.3.3.3.2.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.3.2">𝑁</ci><ci id="A1.SS2.2.p1.1.m1.1.1.3.3.3.3.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.3.3">𝐹𝑃</ci></apply><apply id="A1.SS2.2.p1.1.m1.1.1.3.3.4.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="A1.SS2.2.p1.1.m1.1.1.3.3.4.1.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.4">subscript</csymbol><ci id="A1.SS2.2.p1.1.m1.1.1.3.3.4.2.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.4.2">𝑁</ci><ci id="A1.SS2.2.p1.1.m1.1.1.3.3.4.3.cmml" xref="A1.SS2.2.p1.1.m1.1.1.3.3.4.3">𝑡𝑜𝑡𝑎𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.2.p1.1.m1.1c">\mathit{PPV}=\frac{N_{\mathit{TP}}}{N_{\mathit{TP}}+N_{\mathit{FP}}+N_{\mathit{total}}}</annotation></semantics></math>, then <math id="A1.SS2.2.p1.2.m2.1" class="ltx_Math" alttext="\frac{1}{PPV}=1+\frac{N_{\mathit{FP}}}{N_{\mathit{TP}}}+\frac{N_{\mathit{total}}}{N_{\mathit{TP}}}" display="inline"><semantics id="A1.SS2.2.p1.2.m2.1a"><mrow id="A1.SS2.2.p1.2.m2.1.1" xref="A1.SS2.2.p1.2.m2.1.1.cmml"><mfrac id="A1.SS2.2.p1.2.m2.1.1.2" xref="A1.SS2.2.p1.2.m2.1.1.2.cmml"><mn id="A1.SS2.2.p1.2.m2.1.1.2.2" xref="A1.SS2.2.p1.2.m2.1.1.2.2.cmml">1</mn><mrow id="A1.SS2.2.p1.2.m2.1.1.2.3" xref="A1.SS2.2.p1.2.m2.1.1.2.3.cmml"><mi id="A1.SS2.2.p1.2.m2.1.1.2.3.2" xref="A1.SS2.2.p1.2.m2.1.1.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.SS2.2.p1.2.m2.1.1.2.3.1" xref="A1.SS2.2.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="A1.SS2.2.p1.2.m2.1.1.2.3.3" xref="A1.SS2.2.p1.2.m2.1.1.2.3.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.SS2.2.p1.2.m2.1.1.2.3.1a" xref="A1.SS2.2.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="A1.SS2.2.p1.2.m2.1.1.2.3.4" xref="A1.SS2.2.p1.2.m2.1.1.2.3.4.cmml">V</mi></mrow></mfrac><mo id="A1.SS2.2.p1.2.m2.1.1.1" xref="A1.SS2.2.p1.2.m2.1.1.1.cmml">=</mo><mrow id="A1.SS2.2.p1.2.m2.1.1.3" xref="A1.SS2.2.p1.2.m2.1.1.3.cmml"><mn id="A1.SS2.2.p1.2.m2.1.1.3.2" xref="A1.SS2.2.p1.2.m2.1.1.3.2.cmml">1</mn><mo id="A1.SS2.2.p1.2.m2.1.1.3.1" xref="A1.SS2.2.p1.2.m2.1.1.3.1.cmml">+</mo><mfrac id="A1.SS2.2.p1.2.m2.1.1.3.3" xref="A1.SS2.2.p1.2.m2.1.1.3.3.cmml"><msub id="A1.SS2.2.p1.2.m2.1.1.3.3.2" xref="A1.SS2.2.p1.2.m2.1.1.3.3.2.cmml"><mi id="A1.SS2.2.p1.2.m2.1.1.3.3.2.2" xref="A1.SS2.2.p1.2.m2.1.1.3.3.2.2.cmml">N</mi><mi id="A1.SS2.2.p1.2.m2.1.1.3.3.2.3" xref="A1.SS2.2.p1.2.m2.1.1.3.3.2.3.cmml">𝐹𝑃</mi></msub><msub id="A1.SS2.2.p1.2.m2.1.1.3.3.3" xref="A1.SS2.2.p1.2.m2.1.1.3.3.3.cmml"><mi id="A1.SS2.2.p1.2.m2.1.1.3.3.3.2" xref="A1.SS2.2.p1.2.m2.1.1.3.3.3.2.cmml">N</mi><mi id="A1.SS2.2.p1.2.m2.1.1.3.3.3.3" xref="A1.SS2.2.p1.2.m2.1.1.3.3.3.3.cmml">𝑇𝑃</mi></msub></mfrac><mo id="A1.SS2.2.p1.2.m2.1.1.3.1a" xref="A1.SS2.2.p1.2.m2.1.1.3.1.cmml">+</mo><mfrac id="A1.SS2.2.p1.2.m2.1.1.3.4" xref="A1.SS2.2.p1.2.m2.1.1.3.4.cmml"><msub id="A1.SS2.2.p1.2.m2.1.1.3.4.2" xref="A1.SS2.2.p1.2.m2.1.1.3.4.2.cmml"><mi id="A1.SS2.2.p1.2.m2.1.1.3.4.2.2" xref="A1.SS2.2.p1.2.m2.1.1.3.4.2.2.cmml">N</mi><mi id="A1.SS2.2.p1.2.m2.1.1.3.4.2.3" xref="A1.SS2.2.p1.2.m2.1.1.3.4.2.3.cmml">𝑡𝑜𝑡𝑎𝑙</mi></msub><msub id="A1.SS2.2.p1.2.m2.1.1.3.4.3" xref="A1.SS2.2.p1.2.m2.1.1.3.4.3.cmml"><mi id="A1.SS2.2.p1.2.m2.1.1.3.4.3.2" xref="A1.SS2.2.p1.2.m2.1.1.3.4.3.2.cmml">N</mi><mi id="A1.SS2.2.p1.2.m2.1.1.3.4.3.3" xref="A1.SS2.2.p1.2.m2.1.1.3.4.3.3.cmml">𝑇𝑃</mi></msub></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.2.p1.2.m2.1b"><apply id="A1.SS2.2.p1.2.m2.1.1.cmml" xref="A1.SS2.2.p1.2.m2.1.1"><eq id="A1.SS2.2.p1.2.m2.1.1.1.cmml" xref="A1.SS2.2.p1.2.m2.1.1.1"></eq><apply id="A1.SS2.2.p1.2.m2.1.1.2.cmml" xref="A1.SS2.2.p1.2.m2.1.1.2"><divide id="A1.SS2.2.p1.2.m2.1.1.2.1.cmml" xref="A1.SS2.2.p1.2.m2.1.1.2"></divide><cn type="integer" id="A1.SS2.2.p1.2.m2.1.1.2.2.cmml" xref="A1.SS2.2.p1.2.m2.1.1.2.2">1</cn><apply id="A1.SS2.2.p1.2.m2.1.1.2.3.cmml" xref="A1.SS2.2.p1.2.m2.1.1.2.3"><times id="A1.SS2.2.p1.2.m2.1.1.2.3.1.cmml" xref="A1.SS2.2.p1.2.m2.1.1.2.3.1"></times><ci id="A1.SS2.2.p1.2.m2.1.1.2.3.2.cmml" xref="A1.SS2.2.p1.2.m2.1.1.2.3.2">𝑃</ci><ci id="A1.SS2.2.p1.2.m2.1.1.2.3.3.cmml" xref="A1.SS2.2.p1.2.m2.1.1.2.3.3">𝑃</ci><ci id="A1.SS2.2.p1.2.m2.1.1.2.3.4.cmml" xref="A1.SS2.2.p1.2.m2.1.1.2.3.4">𝑉</ci></apply></apply><apply id="A1.SS2.2.p1.2.m2.1.1.3.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3"><plus id="A1.SS2.2.p1.2.m2.1.1.3.1.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.1"></plus><cn type="integer" id="A1.SS2.2.p1.2.m2.1.1.3.2.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.2">1</cn><apply id="A1.SS2.2.p1.2.m2.1.1.3.3.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.3"><divide id="A1.SS2.2.p1.2.m2.1.1.3.3.1.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.3"></divide><apply id="A1.SS2.2.p1.2.m2.1.1.3.3.2.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.SS2.2.p1.2.m2.1.1.3.3.2.1.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.3.2">subscript</csymbol><ci id="A1.SS2.2.p1.2.m2.1.1.3.3.2.2.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.3.2.2">𝑁</ci><ci id="A1.SS2.2.p1.2.m2.1.1.3.3.2.3.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.3.2.3">𝐹𝑃</ci></apply><apply id="A1.SS2.2.p1.2.m2.1.1.3.3.3.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.SS2.2.p1.2.m2.1.1.3.3.3.1.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.3.3">subscript</csymbol><ci id="A1.SS2.2.p1.2.m2.1.1.3.3.3.2.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.3.3.2">𝑁</ci><ci id="A1.SS2.2.p1.2.m2.1.1.3.3.3.3.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.3.3.3">𝑇𝑃</ci></apply></apply><apply id="A1.SS2.2.p1.2.m2.1.1.3.4.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.4"><divide id="A1.SS2.2.p1.2.m2.1.1.3.4.1.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.4"></divide><apply id="A1.SS2.2.p1.2.m2.1.1.3.4.2.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.4.2"><csymbol cd="ambiguous" id="A1.SS2.2.p1.2.m2.1.1.3.4.2.1.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.4.2">subscript</csymbol><ci id="A1.SS2.2.p1.2.m2.1.1.3.4.2.2.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.4.2.2">𝑁</ci><ci id="A1.SS2.2.p1.2.m2.1.1.3.4.2.3.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.4.2.3">𝑡𝑜𝑡𝑎𝑙</ci></apply><apply id="A1.SS2.2.p1.2.m2.1.1.3.4.3.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.4.3"><csymbol cd="ambiguous" id="A1.SS2.2.p1.2.m2.1.1.3.4.3.1.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.4.3">subscript</csymbol><ci id="A1.SS2.2.p1.2.m2.1.1.3.4.3.2.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.4.3.2">𝑁</ci><ci id="A1.SS2.2.p1.2.m2.1.1.3.4.3.3.cmml" xref="A1.SS2.2.p1.2.m2.1.1.3.4.3.3">𝑇𝑃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.2.p1.2.m2.1c">\frac{1}{PPV}=1+\frac{N_{\mathit{FP}}}{N_{\mathit{TP}}}+\frac{N_{\mathit{total}}}{N_{\mathit{TP}}}</annotation></semantics></math>. As <math id="A1.SS2.2.p1.3.m3.1" class="ltx_Math" alttext="\frac{N_{\mathit{FP}}}{N_{\mathit{TP}}}\geq 0" display="inline"><semantics id="A1.SS2.2.p1.3.m3.1a"><mrow id="A1.SS2.2.p1.3.m3.1.1" xref="A1.SS2.2.p1.3.m3.1.1.cmml"><mfrac id="A1.SS2.2.p1.3.m3.1.1.2" xref="A1.SS2.2.p1.3.m3.1.1.2.cmml"><msub id="A1.SS2.2.p1.3.m3.1.1.2.2" xref="A1.SS2.2.p1.3.m3.1.1.2.2.cmml"><mi id="A1.SS2.2.p1.3.m3.1.1.2.2.2" xref="A1.SS2.2.p1.3.m3.1.1.2.2.2.cmml">N</mi><mi id="A1.SS2.2.p1.3.m3.1.1.2.2.3" xref="A1.SS2.2.p1.3.m3.1.1.2.2.3.cmml">𝐹𝑃</mi></msub><msub id="A1.SS2.2.p1.3.m3.1.1.2.3" xref="A1.SS2.2.p1.3.m3.1.1.2.3.cmml"><mi id="A1.SS2.2.p1.3.m3.1.1.2.3.2" xref="A1.SS2.2.p1.3.m3.1.1.2.3.2.cmml">N</mi><mi id="A1.SS2.2.p1.3.m3.1.1.2.3.3" xref="A1.SS2.2.p1.3.m3.1.1.2.3.3.cmml">𝑇𝑃</mi></msub></mfrac><mo id="A1.SS2.2.p1.3.m3.1.1.1" xref="A1.SS2.2.p1.3.m3.1.1.1.cmml">≥</mo><mn id="A1.SS2.2.p1.3.m3.1.1.3" xref="A1.SS2.2.p1.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.2.p1.3.m3.1b"><apply id="A1.SS2.2.p1.3.m3.1.1.cmml" xref="A1.SS2.2.p1.3.m3.1.1"><geq id="A1.SS2.2.p1.3.m3.1.1.1.cmml" xref="A1.SS2.2.p1.3.m3.1.1.1"></geq><apply id="A1.SS2.2.p1.3.m3.1.1.2.cmml" xref="A1.SS2.2.p1.3.m3.1.1.2"><divide id="A1.SS2.2.p1.3.m3.1.1.2.1.cmml" xref="A1.SS2.2.p1.3.m3.1.1.2"></divide><apply id="A1.SS2.2.p1.3.m3.1.1.2.2.cmml" xref="A1.SS2.2.p1.3.m3.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.2.p1.3.m3.1.1.2.2.1.cmml" xref="A1.SS2.2.p1.3.m3.1.1.2.2">subscript</csymbol><ci id="A1.SS2.2.p1.3.m3.1.1.2.2.2.cmml" xref="A1.SS2.2.p1.3.m3.1.1.2.2.2">𝑁</ci><ci id="A1.SS2.2.p1.3.m3.1.1.2.2.3.cmml" xref="A1.SS2.2.p1.3.m3.1.1.2.2.3">𝐹𝑃</ci></apply><apply id="A1.SS2.2.p1.3.m3.1.1.2.3.cmml" xref="A1.SS2.2.p1.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="A1.SS2.2.p1.3.m3.1.1.2.3.1.cmml" xref="A1.SS2.2.p1.3.m3.1.1.2.3">subscript</csymbol><ci id="A1.SS2.2.p1.3.m3.1.1.2.3.2.cmml" xref="A1.SS2.2.p1.3.m3.1.1.2.3.2">𝑁</ci><ci id="A1.SS2.2.p1.3.m3.1.1.2.3.3.cmml" xref="A1.SS2.2.p1.3.m3.1.1.2.3.3">𝑇𝑃</ci></apply></apply><cn type="integer" id="A1.SS2.2.p1.3.m3.1.1.3.cmml" xref="A1.SS2.2.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.2.p1.3.m3.1c">\frac{N_{\mathit{FP}}}{N_{\mathit{TP}}}\geq 0</annotation></semantics></math> and <math id="A1.SS2.2.p1.4.m4.1" class="ltx_Math" alttext="\frac{N_{\mathit{total}}}{N_{\mathit{TP}}}\geq 1" display="inline"><semantics id="A1.SS2.2.p1.4.m4.1a"><mrow id="A1.SS2.2.p1.4.m4.1.1" xref="A1.SS2.2.p1.4.m4.1.1.cmml"><mfrac id="A1.SS2.2.p1.4.m4.1.1.2" xref="A1.SS2.2.p1.4.m4.1.1.2.cmml"><msub id="A1.SS2.2.p1.4.m4.1.1.2.2" xref="A1.SS2.2.p1.4.m4.1.1.2.2.cmml"><mi id="A1.SS2.2.p1.4.m4.1.1.2.2.2" xref="A1.SS2.2.p1.4.m4.1.1.2.2.2.cmml">N</mi><mi id="A1.SS2.2.p1.4.m4.1.1.2.2.3" xref="A1.SS2.2.p1.4.m4.1.1.2.2.3.cmml">𝑡𝑜𝑡𝑎𝑙</mi></msub><msub id="A1.SS2.2.p1.4.m4.1.1.2.3" xref="A1.SS2.2.p1.4.m4.1.1.2.3.cmml"><mi id="A1.SS2.2.p1.4.m4.1.1.2.3.2" xref="A1.SS2.2.p1.4.m4.1.1.2.3.2.cmml">N</mi><mi id="A1.SS2.2.p1.4.m4.1.1.2.3.3" xref="A1.SS2.2.p1.4.m4.1.1.2.3.3.cmml">𝑇𝑃</mi></msub></mfrac><mo id="A1.SS2.2.p1.4.m4.1.1.1" xref="A1.SS2.2.p1.4.m4.1.1.1.cmml">≥</mo><mn id="A1.SS2.2.p1.4.m4.1.1.3" xref="A1.SS2.2.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.2.p1.4.m4.1b"><apply id="A1.SS2.2.p1.4.m4.1.1.cmml" xref="A1.SS2.2.p1.4.m4.1.1"><geq id="A1.SS2.2.p1.4.m4.1.1.1.cmml" xref="A1.SS2.2.p1.4.m4.1.1.1"></geq><apply id="A1.SS2.2.p1.4.m4.1.1.2.cmml" xref="A1.SS2.2.p1.4.m4.1.1.2"><divide id="A1.SS2.2.p1.4.m4.1.1.2.1.cmml" xref="A1.SS2.2.p1.4.m4.1.1.2"></divide><apply id="A1.SS2.2.p1.4.m4.1.1.2.2.cmml" xref="A1.SS2.2.p1.4.m4.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.2.p1.4.m4.1.1.2.2.1.cmml" xref="A1.SS2.2.p1.4.m4.1.1.2.2">subscript</csymbol><ci id="A1.SS2.2.p1.4.m4.1.1.2.2.2.cmml" xref="A1.SS2.2.p1.4.m4.1.1.2.2.2">𝑁</ci><ci id="A1.SS2.2.p1.4.m4.1.1.2.2.3.cmml" xref="A1.SS2.2.p1.4.m4.1.1.2.2.3">𝑡𝑜𝑡𝑎𝑙</ci></apply><apply id="A1.SS2.2.p1.4.m4.1.1.2.3.cmml" xref="A1.SS2.2.p1.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="A1.SS2.2.p1.4.m4.1.1.2.3.1.cmml" xref="A1.SS2.2.p1.4.m4.1.1.2.3">subscript</csymbol><ci id="A1.SS2.2.p1.4.m4.1.1.2.3.2.cmml" xref="A1.SS2.2.p1.4.m4.1.1.2.3.2">𝑁</ci><ci id="A1.SS2.2.p1.4.m4.1.1.2.3.3.cmml" xref="A1.SS2.2.p1.4.m4.1.1.2.3.3">𝑇𝑃</ci></apply></apply><cn type="integer" id="A1.SS2.2.p1.4.m4.1.1.3.cmml" xref="A1.SS2.2.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.2.p1.4.m4.1c">\frac{N_{\mathit{total}}}{N_{\mathit{TP}}}\geq 1</annotation></semantics></math>, we have <math id="A1.SS2.2.p1.5.m5.1" class="ltx_Math" alttext="\frac{1}{\mathit{PPV}}\geq 2" display="inline"><semantics id="A1.SS2.2.p1.5.m5.1a"><mrow id="A1.SS2.2.p1.5.m5.1.1" xref="A1.SS2.2.p1.5.m5.1.1.cmml"><mfrac id="A1.SS2.2.p1.5.m5.1.1.2" xref="A1.SS2.2.p1.5.m5.1.1.2.cmml"><mn id="A1.SS2.2.p1.5.m5.1.1.2.2" xref="A1.SS2.2.p1.5.m5.1.1.2.2.cmml">1</mn><mi id="A1.SS2.2.p1.5.m5.1.1.2.3" xref="A1.SS2.2.p1.5.m5.1.1.2.3.cmml">𝑃𝑃𝑉</mi></mfrac><mo id="A1.SS2.2.p1.5.m5.1.1.1" xref="A1.SS2.2.p1.5.m5.1.1.1.cmml">≥</mo><mn id="A1.SS2.2.p1.5.m5.1.1.3" xref="A1.SS2.2.p1.5.m5.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.2.p1.5.m5.1b"><apply id="A1.SS2.2.p1.5.m5.1.1.cmml" xref="A1.SS2.2.p1.5.m5.1.1"><geq id="A1.SS2.2.p1.5.m5.1.1.1.cmml" xref="A1.SS2.2.p1.5.m5.1.1.1"></geq><apply id="A1.SS2.2.p1.5.m5.1.1.2.cmml" xref="A1.SS2.2.p1.5.m5.1.1.2"><divide id="A1.SS2.2.p1.5.m5.1.1.2.1.cmml" xref="A1.SS2.2.p1.5.m5.1.1.2"></divide><cn type="integer" id="A1.SS2.2.p1.5.m5.1.1.2.2.cmml" xref="A1.SS2.2.p1.5.m5.1.1.2.2">1</cn><ci id="A1.SS2.2.p1.5.m5.1.1.2.3.cmml" xref="A1.SS2.2.p1.5.m5.1.1.2.3">𝑃𝑃𝑉</ci></apply><cn type="integer" id="A1.SS2.2.p1.5.m5.1.1.3.cmml" xref="A1.SS2.2.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.2.p1.5.m5.1c">\frac{1}{\mathit{PPV}}\geq 2</annotation></semantics></math>, thus <math id="A1.SS2.2.p1.6.m6.1" class="ltx_Math" alttext="\mathit{PPV}\leq\frac{1}{2}" display="inline"><semantics id="A1.SS2.2.p1.6.m6.1a"><mrow id="A1.SS2.2.p1.6.m6.1.1" xref="A1.SS2.2.p1.6.m6.1.1.cmml"><mi id="A1.SS2.2.p1.6.m6.1.1.2" xref="A1.SS2.2.p1.6.m6.1.1.2.cmml">𝑃𝑃𝑉</mi><mo id="A1.SS2.2.p1.6.m6.1.1.1" xref="A1.SS2.2.p1.6.m6.1.1.1.cmml">≤</mo><mfrac id="A1.SS2.2.p1.6.m6.1.1.3" xref="A1.SS2.2.p1.6.m6.1.1.3.cmml"><mn id="A1.SS2.2.p1.6.m6.1.1.3.2" xref="A1.SS2.2.p1.6.m6.1.1.3.2.cmml">1</mn><mn id="A1.SS2.2.p1.6.m6.1.1.3.3" xref="A1.SS2.2.p1.6.m6.1.1.3.3.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.2.p1.6.m6.1b"><apply id="A1.SS2.2.p1.6.m6.1.1.cmml" xref="A1.SS2.2.p1.6.m6.1.1"><leq id="A1.SS2.2.p1.6.m6.1.1.1.cmml" xref="A1.SS2.2.p1.6.m6.1.1.1"></leq><ci id="A1.SS2.2.p1.6.m6.1.1.2.cmml" xref="A1.SS2.2.p1.6.m6.1.1.2">𝑃𝑃𝑉</ci><apply id="A1.SS2.2.p1.6.m6.1.1.3.cmml" xref="A1.SS2.2.p1.6.m6.1.1.3"><divide id="A1.SS2.2.p1.6.m6.1.1.3.1.cmml" xref="A1.SS2.2.p1.6.m6.1.1.3"></divide><cn type="integer" id="A1.SS2.2.p1.6.m6.1.1.3.2.cmml" xref="A1.SS2.2.p1.6.m6.1.1.3.2">1</cn><cn type="integer" id="A1.SS2.2.p1.6.m6.1.1.3.3.cmml" xref="A1.SS2.2.p1.6.m6.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.2.p1.6.m6.1c">\mathit{PPV}\leq\frac{1}{2}</annotation></semantics></math>.
∎</p>
</div>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>ZKP Implementation</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Choice of the ZKP system</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.1" class="ltx_p">In our implementation, we use the Groth16 <cite class="ltx_cite ltx_citemacro_citep">(Groth, <a href="#bib.bib27" title="" class="ltx_ref">2016</a>)</cite> zkSNARK scheme implemented in the Circom library <cite class="ltx_cite ltx_citemacro_citep">(Contributors, <a href="#bib.bib16" title="" class="ltx_ref">2022</a>)</cite> for all the computations described above. We chose this ZKP scheme because its construction ensures constant proof size (128 bytes) and constant verification time. Because of this, Groth16 is popular for blockchain applications due to small on-chain computation. There are other ZKP schemes based on different constructions that can achieve faster prover time  <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib41" title="" class="ltx_ref">2021</a>)</cite>, but their proof size is too big and verification time is not constant, which is a problem if the verifier lacks computational power. The construction of a ZKP scheme that is efficient for both the prover and verifier is still an open research direction.</p>
</div>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Supplementary Experiments for Importance Layer</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.1" class="ltx_p">The results for CNN amd ResNet56 are shown in <a href="#A2.F10" title="In B.2 Supplementary Experiments for Importance Layer ‣ Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">10</span></a> and <a href="#A2.F11" title="In B.2 Supplementary Experiments for Importance Layer ‣ Appendix B ZKP Implementation ‣ Kick Bad Guys Out! Zero-Knowledge-Proof-Based Anomaly Detection in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">11</span></a>, respectively.</p>
</div>
<figure id="A2.F10" class="ltx_figure"><img src="/html/2310.04055/assets/figures/cnn_sensitivity.png" id="A2.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="190" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F10.2.1.1" class="ltx_text" style="font-size:90%;">Figure 10</span>: </span><span id="A2.F10.3.2" class="ltx_text" style="font-size:90%;">CNN layer sensitivity. </span></figcaption>
</figure>
<figure id="A2.F11" class="ltx_figure"><img src="/html/2310.04055/assets/figures/resnet56_sensitivity.png" id="A2.F11.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="187" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F11.2.1.1" class="ltx_text" style="font-size:90%;">Figure 11</span>: </span><span id="A2.F11.3.2" class="ltx_text" style="font-size:90%;">ResNet56 layer sensitivity. </span></figcaption>
</figure>
</section>
<section id="A2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Supplementary Results for Real-world Systems</h3>

<figure id="A2.F12" class="ltx_figure"><img src="/html/2310.04055/assets/figures/device_info.png" id="A2.F12.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="550" height="344" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F12.2.1.1" class="ltx_text" style="font-size:90%;">Figure 12</span>: </span><span id="A2.F12.3.2" class="ltx_text" style="font-size:90%;">Theta edge devices.
</span></figcaption>
</figure>
<figure id="A2.F13" class="ltx_figure"><img src="/html/2310.04055/assets/figures/real_world_app_training.png" id="A2.F13.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="550" height="202" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F13.2.1.1" class="ltx_text" style="font-size:90%;">Figure 13</span>: </span><span id="A2.F13.3.2" class="ltx_text" style="font-size:90%;">Real-world application on Theta network. Yellow: aggregation server waiting time; pink: aggregation time; green: client training time; blue: client communication time.
</span></figcaption>
</figure>
<figure id="A2.F15" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A2.F15.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:216.8pt;"><img src="/html/2310.04055/assets/figures/cpu_utilization.png" id="A2.F15.1.g1" class="ltx_graphics ltx_img_landscape" width="393" height="201" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F15.1.1.1.1" class="ltx_text" style="font-size:90%;">Figure 14</span>: </span><span id="A2.F15.1.2.2" class="ltx_text" style="font-size:90%;">CPU utilization.
</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A2.F15.2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:216.8pt;"><img src="/html/2310.04055/assets/figures/network_traffics.png" id="A2.F15.2.g1" class="ltx_graphics ltx_img_landscape" width="393" height="173" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F15.2.1.1.1" class="ltx_text" style="font-size:90%;">Figure 15</span>: </span><span id="A2.F15.2.2.2" class="ltx_text" style="font-size:90%;">Network traffic.
</span></figcaption>
</figure>
</div>
</div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="A2.SS3.p1" class="ltx_para">
<p id="A2.SS3.p1.1" class="ltx_p"></p>
</div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2310.04054" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2310.04055" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2310.04055">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2310.04055" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2310.04056" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 02:24:09 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
