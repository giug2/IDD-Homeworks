<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2409.00263] AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning</title><meta property="og:description" content="All-Weather Image Restoration (AWIR) under adverse weather conditions is a challenging task due to the presence of different types of degradations. Prior research in this domain relies on extensive training data but la…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2409.00263">

<!--Generated on Sat Oct  5 23:39:56 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span id="id1.id1" class="ltx_text ltx_font_italic">AWRaCLe</span>: All-Weather Image Restoration using Visual In-Context Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Sudarshan Rajagopalan,
Vishal M. Patel

</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">All-Weather Image Restoration (AWIR) under adverse weather conditions is a challenging task due to the presence of different types of degradations. Prior research in this domain relies on extensive training data but lacks the utilization of additional contextual information for restoration guidance. Consequently, the performance of existing methods is limited by the degradation cues that are learnt from individual training samples. Recent advancements in visual in-context learning have introduced generalist models that are capable of addressing multiple computer vision tasks simultaneously by using the information present in the provided context as a prior. In this paper, we propose <span id="id2.id1.1" class="ltx_text ltx_font_bold ltx_font_italic">A<span id="id2.id1.1.1" class="ltx_text ltx_font_medium">ll-</span>W<span id="id2.id1.1.2" class="ltx_text ltx_font_medium">eather Image </span>R<span id="id2.id1.1.3" class="ltx_text ltx_font_medium">estor</span>a<span id="id2.id1.1.4" class="ltx_text ltx_font_medium">tion using Visual In-</span>C<span id="id2.id1.1.5" class="ltx_text ltx_font_medium">ontext </span>Le<span id="id2.id1.1.6" class="ltx_text ltx_font_medium">arning</span></span> (AWRaCLe), a novel approach for AWIR that innovatively utilizes degradation-specific visual context information to steer the image restoration process. To achieve this, AWRaCLe incorporates Degradation Context Extraction (DCE) and Context Fusion (CF) to seamlessly integrate degradation-specific features from the context into an image restoration network. The proposed DCE and CF blocks leverage CLIP features and incorporate attention mechanisms to adeptly learn and fuse contextual information. These blocks are specifically designed for visual in-context learning under all-weather conditions and are crucial for effective context utilization. Through extensive experiments, we demonstrate the effectiveness of AWRaCLe for all-weather restoration and show that our method advances the state-of-the-art in AWIR.</p>
</div>
<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup>Project Page: <span class="ltx_ref ltx_nolink ltx_url ltx_ref_self" style="color:#0000FF;">https://sudraj2002.github.io/awraclepage/</span></span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Unfavorable weather conditions, such as rain, snow and haze, significantly degrade the performance of computer vision systems impacting applications such as autonomous navigation, surveillance, and aerial imaging. Thus, there is a need for frameworks that mitigate weather-induced corruptions while preserving the underlying image semantics. Initial attempts at this problem <cite class="ltx_cite ltx_citemacro_citep">(He, Sun, and Tang <a href="#bib.bib15" title="" class="ltx_ref">2009</a>; Roth and Black <a href="#bib.bib32" title="" class="ltx_ref">2005</a>; Kang, Lin, and Fu <a href="#bib.bib17" title="" class="ltx_ref">2012</a>)</cite> worked by modelling the physics of the degradations, and estimated physics-based parameters to obtain the restored image. These methods were not effective due to the varying degradation characteristics that occur in real-life scenarios. To overcome these limitations, many deep learning-based methods such as <cite class="ltx_cite ltx_citemacro_citep">(Zhang, Sindagi, and Patel <a href="#bib.bib49" title="" class="ltx_ref">2020</a>; Zhang and Patel <a href="#bib.bib48" title="" class="ltx_ref">2018</a>; Wu et al. <a href="#bib.bib42" title="" class="ltx_ref">2021</a>; Song et al. <a href="#bib.bib34" title="" class="ltx_ref">2023</a>)</cite> for dehazing, <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a href="#bib.bib50" title="" class="ltx_ref">2021</a>; Chen et al. <a href="#bib.bib10" title="" class="ltx_ref">2020</a>; Liu et al. <a href="#bib.bib23" title="" class="ltx_ref">2018</a>)</cite> for desnowing, and <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib37" title="" class="ltx_ref">2019</a>; Wei et al. <a href="#bib.bib41" title="" class="ltx_ref">2019</a>; Quan et al. <a href="#bib.bib30" title="" class="ltx_ref">2021</a>)</cite> for deraining have been proposed. However, these methods are specific to a single degradation. For handling multiple degradations, Uformer <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib40" title="" class="ltx_ref">2022</a>)</cite>, Restormer <cite class="ltx_cite ltx_citemacro_citep">(Zamir et al. <a href="#bib.bib46" title="" class="ltx_ref">2022</a>)</cite>, MPRNet <cite class="ltx_cite ltx_citemacro_citep">(Zamir et al. <a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite> and SwinIR <cite class="ltx_cite ltx_citemacro_citep">(Liang et al. <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite> were proposed. These approaches can be trained to remove any one type of degradation at a time. Using them for a different degradation involves either re-training or fine-tuning the networks, rendering them impractical to use in real-life settings.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<table id="S1.F1.20" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S1.F1.5.5" class="ltx_tr">
<th id="S1.F1.5.5.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:1.0pt;padding-right:1.0pt;" rowspan="2">
<span id="S1.F1.5.5.6.1" class="ltx_inline-block ltx_parbox ltx_align_top" style="width:5.7pt;">
<span id="S1.F1.5.5.6.1.1" class="ltx_p">
<span id="S1.F1.5.5.6.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:56.6pt;vertical-align:-24.9pt;"><span class="ltx_transformed_inner" style="width:56.6pt;transform:translate(-24.86pt,0pt) rotate(-90deg) ;">
<span id="S1.F1.5.5.6.1.1.1.1" class="ltx_p">Context Pair</span>
</span></span></span>
</span>
</th>
<td id="S1.F1.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/sotscontinp.png" id="S1.F1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/inpsnowcont.png" id="S1.F1.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/inpcontrain.png" id="S1.F1.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.4.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/csdcontinp.png" id="S1.F1.4.4.4.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.5.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/contsnowsnow_csd.png" id="S1.F1.5.5.5.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
</tr>
<tr id="S1.F1.10.10" class="ltx_tr">
<td id="S1.F1.6.6.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/sotscontgt.png" id="S1.F1.6.6.1.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.7.7.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/gtcontsnow.png" id="S1.F1.7.7.2.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.8.8.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/gtcontrain.png" id="S1.F1.8.8.3.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.9.9.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/csdcontgt.png" id="S1.F1.9.9.4.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.10.10.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/contsnowgt_csd.png" id="S1.F1.10.10.5.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
</tr>
<tr id="S1.F1.15.15" class="ltx_tr">
<th id="S1.F1.15.15.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:1.0pt;padding-right:1.0pt;"> 
<div id="S1.F1.15.15.6.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.8pt;height:26.9pt;vertical-align:-11.0pt;"><span class="ltx_transformed_inner" style="width:27.0pt;transform:translate(-9.1pt,2.92pt) rotate(-90deg) ;">
<p id="S1.F1.15.15.6.1.1" class="ltx_p">Query</p>
</span></div>
</th>
<td id="S1.F1.11.11.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/inpsots.png" id="S1.F1.11.11.1.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.12.12.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/inputsnow.png" id="S1.F1.12.12.2.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.13.13.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/inprain.png" id="S1.F1.13.13.3.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.14.14.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/inputcsd.png" id="S1.F1.14.14.4.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.15.15.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/inputcsd.png" id="S1.F1.15.15.5.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
</tr>
<tr id="S1.F1.20.20" class="ltx_tr">
<th id="S1.F1.20.20.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:1.0pt;padding-right:1.0pt;"> 
<div id="S1.F1.20.20.6.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.8pt;height:32.3pt;vertical-align:-13.7pt;"><span class="ltx_transformed_inner" style="width:32.2pt;transform:translate(-11.72pt,2.92pt) rotate(-90deg) ;">
<p id="S1.F1.20.20.6.1.1" class="ltx_p">Output</p>
</span></div>
</th>
<td id="S1.F1.16.16.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/outsots.png" id="S1.F1.16.16.1.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.17.17.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/ourssnow.png" id="S1.F1.17.17.2.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.18.18.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/outrain.png" id="S1.F1.18.18.3.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.19.19.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/csdout_desnow.png" id="S1.F1.19.19.4.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
<td id="S1.F1.20.20.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/AnonymousSubmission/fig1_final/csdout_dehaze.png" id="S1.F1.20.20.5.g1" class="ltx_graphics ltx_img_landscape" width="122" height="61" alt="Refer to caption"></td>
</tr>
<tr id="S1.F1.20.21.1" class="ltx_tr">
<td id="S1.F1.20.21.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r" style="padding-left:1.0pt;padding-right:1.0pt;"></td>
<td id="S1.F1.20.21.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">(a) Dehaze</td>
<td id="S1.F1.20.21.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">(b) Desnow</td>
<td id="S1.F1.20.21.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">(c) Derain</td>
<td id="S1.F1.20.21.1.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">(d) Selective Dehaze</td>
<td id="S1.F1.20.21.1.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">(e) Selective Desnow</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration of AWRaCLe: Our visual in-context learning approach for all-weather image restoration. The first two rows are the context pair. The third row is the query image that needs to be restored and the fourth row is our output. (d) and (e) show results for selective removal of haze and snow, respectively, from an image containing their mixture.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To address the above issues, there has been focus on developing All-Weather Image Restoration (AWIR) networks in which a single model is trained to restore multiple degradations. Popular works for tackling this problem include All-in-one <cite class="ltx_cite ltx_citemacro_citep">(Li, Tan, and Cheong <a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite>, Transweather <cite class="ltx_cite ltx_citemacro_citep">(Valanarasu, Yasarla, and Patel <a href="#bib.bib35" title="" class="ltx_ref">2022</a>)</cite>, AirNet <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib18" title="" class="ltx_ref">2022</a>)</cite>, FAIG <cite class="ltx_cite ltx_citemacro_citep">(Park, Lee, and Chun <a href="#bib.bib26" title="" class="ltx_ref">2023</a>)</cite>, WeatherDiff <cite class="ltx_cite ltx_citemacro_citep">(Özdenizci and Legenstein <a href="#bib.bib25" title="" class="ltx_ref">2023</a>)</cite>, TSMC <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib11" title="" class="ltx_ref">2022b</a>)</cite>, PromptIR <cite class="ltx_cite ltx_citemacro_citep">(Potlapalli et al. <a href="#bib.bib29" title="" class="ltx_ref">2024</a>)</cite> and DiffUIR <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al. <a href="#bib.bib54" title="" class="ltx_ref">2024</a>)</cite>.
These methods attempt to learn degradation-specific representations from individual images during the training phase. However, they lack guidance that can provide additional information about the various degradations present in images. This limits their ability to effectively learn features unique to different degradations, ultimately impeding their performance for AWIR.
Thus, there is a need for a framework capable of learning robust degradation-specific features that can facilitate effective restoration. This is quite a challenging task and proves to be difficult without supplementary knowledge about the nature of the corruption. A couple of works <cite class="ltx_cite ltx_citemacro_citep">(Yan et al. <a href="#bib.bib44" title="" class="ltx_ref">2023</a>; Bai et al. <a href="#bib.bib4" title="" class="ltx_ref">2023</a>)</cite> have explored text-based guidance for all-weather restoration. However, text descriptions can only convey high-level semantic information about the degradation and fail to describe important aspects of the corruption such as its visual characteristics. We conjecture that feeding images as degradation-context to an image restoration network can overcome some of the above limitations as it will enable the network to aggregate visual information about different types of weather conditions. We accomplish this with the help of <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">visual in-context learning</em>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In-context learning, as demonstrated by large language models, is very well-studied in Natural Language Processing (NLP). In comparison, visual in-context learning is an emerging area.
Providing visual context has been explored by <cite class="ltx_cite ltx_citemacro_citep">(Bar et al. <a href="#bib.bib5" title="" class="ltx_ref">2022</a>)</cite>, Painter <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib38" title="" class="ltx_ref">2023a</a>)</cite> and SegGPT <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib39" title="" class="ltx_ref">2023b</a>)</cite>. They propose elegant solutions that involve unifying the output space of a network to solve multiple computer vision tasks based on visual context. The core idea of these frameworks is the usage of masked image modelling to extract context information from the unmasked regions of an image (as detailed in Painter) and subsequently employing in-painting for the desired prediction. Although Painter was trained for image restoration tasks using visual in-context learning, we show that it fails to use contextual information effectively for restoration tasks, thereby significantly hindering its performance. We believe this is due to two primary reasons. Firstly, the extraction of context information relies solely on the masked image modelling framework, which lacks constraints to ensure retrieval of degradation characteristics from the context images.
Secondly, the context information is provided only at the input of the encoder network in the form of unmasked tokens. Consequently, there is a risk of the context information being suppressed after the initial layers of the network and even becoming negligible at the decoder.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">We propose AWRaCLe, a methodology for all-weather (rain, snow and haze) image restoration which elegantly leverages visual in-context learning. Our method aims to restore a query image by utilizing additional context (that we call context pair), which comprises of a degraded image and its corresponding clean version (see Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). The context requires paired images since without scene consistency, it is challenging to extract degradation-specific information (DSI) which will in-turn hamper restoration performance. In order to facilitate the restoration process, the degradation type in the context pair should align with the type of degradation present in the query image. During test time, the context pair for a degradation can be chosen from the respective training set, thus requiring only the knowledge of the type of degradation.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We devise Degradation Context Extraction (DCE) blocks that leverage features from CLIP’s <cite class="ltx_cite ltx_citemacro_citep">(Radford et al. <a href="#bib.bib31" title="" class="ltx_ref">2021</a>)</cite> image encoder and employ self-attention mechanisms to extract relevant DSI, such as the type and visual characteristics of the degradation, from the given context pair. Additionally, we introduce Context Fusion (CF) blocks designed to integrate the extracted context from the DCE blocks with the feature maps of an image restoration network. Specifically, we use the Restormer <cite class="ltx_cite ltx_citemacro_citep">(Zamir et al. <a href="#bib.bib46" title="" class="ltx_ref">2022</a>)</cite> network for this purpose. The fusion process involves multi-head cross attention at each spatial level of the decoder, ensuring the propagation of context information throughout the restoration network, thus enhancing the performance. Representative results on haze, snow and rain removal are given in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> to demonstrate the efficacy of our method. Interestingly, AWRaCLe can harness DSI from the context pair to perform selective degradation removal. For instance in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>d and e, a query image corrupted by both haze and snow is presented as input. In Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>d, the context pair is given as haze and AWRaCLe returned an output that contained only snow. Similarly, in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>e, the context pair is given as snow resulting in an output that contained only haze. This reaffirms the ability of AWRaCLe in utilising degradation-context effectively. We have performed extensive experiments to demonstrate the effectiveness of AWRaCLe and show that our method achieves state-of-the-art performance for the AWIR task.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">In summary, our main contributions are as follows:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a novel approach called AWRaCLe that employs visual in-context learning for AWIR. To the best of our knowledge, this is the first work which effectively utilizes visual degradation context for AWIR.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose novel Degradation Context Extraction blocks and Context Fusion blocks which extract and fuse relevant degradation information from the provided visual context. Our method ensures that the extracted context is injected suitably at different stages of the restoration network to enable context information flow.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Through comprehensive experiments, we show that AWRaCLe achieves state-of-the-art all-weather restoration performance on multiple benchmark datasets.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this section, we discuss relevant works on adverse weather restoration and in-context learning.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Adverse weather restoration</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Several methods have been proposed for single weather restoration such as  <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib37" title="" class="ltx_ref">2019</a>; Wei et al. <a href="#bib.bib41" title="" class="ltx_ref">2019</a>)</cite> for deraining, <cite class="ltx_cite ltx_citemacro_citep">(Zhang, Sindagi, and Patel <a href="#bib.bib49" title="" class="ltx_ref">2020</a>; Zhang and Patel <a href="#bib.bib48" title="" class="ltx_ref">2018</a>)</cite> for dehazing and  <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a href="#bib.bib50" title="" class="ltx_ref">2021</a>; Chen et al. <a href="#bib.bib10" title="" class="ltx_ref">2020</a>)</cite> for desnowing. Recently, methods such as Restormer <cite class="ltx_cite ltx_citemacro_citep">(Zamir et al. <a href="#bib.bib46" title="" class="ltx_ref">2022</a>)</cite> and MPRNet <cite class="ltx_cite ltx_citemacro_citep">(Zamir et al. <a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite> have tackled multiple degradations. However, the above methods require retraining or fine-tuning for each degradation. To overcome this limitation, AWIR methods have been actively explored. All-in-one <cite class="ltx_cite ltx_citemacro_citep">(Li, Tan, and Cheong <a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite> used neural architecture search to find the best-suited encoder for each degradation from a set of encoders. Transweather <cite class="ltx_cite ltx_citemacro_citep">(Valanarasu, Yasarla, and Patel <a href="#bib.bib35" title="" class="ltx_ref">2022</a>)</cite> employed a unified network with a single encoder for multi-weather restoration. Airnet <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib18" title="" class="ltx_ref">2022</a>)</cite> used Momentum Contrast (MoCo) <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite> for improved degradation representations while TSMC <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib11" title="" class="ltx_ref">2022b</a>)</cite> proposed two-stage knowledge learning with multi-contrastive regularization for a similar objective. Recently, WeatherDiff <cite class="ltx_cite ltx_citemacro_citep">(Özdenizci and Legenstein <a href="#bib.bib25" title="" class="ltx_ref">2023</a>)</cite> proposed a patch-based denoising diffusion model for adverse weather removal and WGWS <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al. <a href="#bib.bib55" title="" class="ltx_ref">2023</a>)</cite> extracted weather-general and weather-specific features for restoration. PromptIR <cite class="ltx_cite ltx_citemacro_citep">(Potlapalli et al. <a href="#bib.bib29" title="" class="ltx_ref">2024</a>)</cite> utilized learnable prompt embeddings for AWIR while DiffUIR <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al. <a href="#bib.bib54" title="" class="ltx_ref">2024</a>)</cite> proposed selective hourglass mapping. Although several AWIR methods have been proposed, they do not utilize contextual guidance which limits their performance.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2409.00263/assets/x1.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="469" height="242" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Block diagram of the proposed visual in-context learning approach for AWIR. CLIP features are extracted from <math id="S2.F2.6.m1.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S2.F2.6.m1.1b"><msub id="S2.F2.6.m1.1.1" xref="S2.F2.6.m1.1.1.cmml"><mi id="S2.F2.6.m1.1.1.2" xref="S2.F2.6.m1.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S2.F2.6.m1.1.1.3" xref="S2.F2.6.m1.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.6.m1.1c"><apply id="S2.F2.6.m1.1.1.cmml" xref="S2.F2.6.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.6.m1.1.1.1.cmml" xref="S2.F2.6.m1.1.1">subscript</csymbol><ci id="S2.F2.6.m1.1.1.2.cmml" xref="S2.F2.6.m1.1.1.2">𝐼</ci><ci id="S2.F2.6.m1.1.1.3a.cmml" xref="S2.F2.6.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S2.F2.6.m1.1.1.3.cmml" xref="S2.F2.6.m1.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.6.m1.1d">I_{\texttt{d}}</annotation></semantics></math> and <math id="S2.F2.7.m2.1" class="ltx_Math" alttext="I_{\texttt{c}}" display="inline"><semantics id="S2.F2.7.m2.1b"><msub id="S2.F2.7.m2.1.1" xref="S2.F2.7.m2.1.1.cmml"><mi id="S2.F2.7.m2.1.1.2" xref="S2.F2.7.m2.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S2.F2.7.m2.1.1.3" xref="S2.F2.7.m2.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.7.m2.1c"><apply id="S2.F2.7.m2.1.1.cmml" xref="S2.F2.7.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.7.m2.1.1.1.cmml" xref="S2.F2.7.m2.1.1">subscript</csymbol><ci id="S2.F2.7.m2.1.1.2.cmml" xref="S2.F2.7.m2.1.1.2">𝐼</ci><ci id="S2.F2.7.m2.1.1.3a.cmml" xref="S2.F2.7.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S2.F2.7.m2.1.1.3.cmml" xref="S2.F2.7.m2.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.7.m2.1d">I_{\texttt{c}}</annotation></semantics></math> which are subsequently fed to DCE blocks at different decoder levels, <math id="S2.F2.8.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.F2.8.m3.1b"><mi id="S2.F2.8.m3.1.1" xref="S2.F2.8.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.F2.8.m3.1c"><ci id="S2.F2.8.m3.1.1.cmml" xref="S2.F2.8.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.m3.1d">l</annotation></semantics></math>. CF blocks then fuse the degradation information obtained from the DCE blocks with decoder features, <math id="S2.F2.9.m4.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="S2.F2.9.m4.1b"><msup id="S2.F2.9.m4.1.1" xref="S2.F2.9.m4.1.1.cmml"><mi id="S2.F2.9.m4.1.1.2" xref="S2.F2.9.m4.1.1.2.cmml">F</mi><mi id="S2.F2.9.m4.1.1.3" xref="S2.F2.9.m4.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S2.F2.9.m4.1c"><apply id="S2.F2.9.m4.1.1.cmml" xref="S2.F2.9.m4.1.1"><csymbol cd="ambiguous" id="S2.F2.9.m4.1.1.1.cmml" xref="S2.F2.9.m4.1.1">superscript</csymbol><ci id="S2.F2.9.m4.1.1.2.cmml" xref="S2.F2.9.m4.1.1.2">𝐹</ci><ci id="S2.F2.9.m4.1.1.3.cmml" xref="S2.F2.9.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.9.m4.1d">F^{l}</annotation></semantics></math>, from the query image <math id="S2.F2.10.m5.1" class="ltx_Math" alttext="I_{\texttt{q}}" display="inline"><semantics id="S2.F2.10.m5.1b"><msub id="S2.F2.10.m5.1.1" xref="S2.F2.10.m5.1.1.cmml"><mi id="S2.F2.10.m5.1.1.2" xref="S2.F2.10.m5.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S2.F2.10.m5.1.1.3" xref="S2.F2.10.m5.1.1.3a.cmml">q</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.10.m5.1c"><apply id="S2.F2.10.m5.1.1.cmml" xref="S2.F2.10.m5.1.1"><csymbol cd="ambiguous" id="S2.F2.10.m5.1.1.1.cmml" xref="S2.F2.10.m5.1.1">subscript</csymbol><ci id="S2.F2.10.m5.1.1.2.cmml" xref="S2.F2.10.m5.1.1.2">𝐼</ci><ci id="S2.F2.10.m5.1.1.3a.cmml" xref="S2.F2.10.m5.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S2.F2.10.m5.1.1.3.cmml" xref="S2.F2.10.m5.1.1.3">q</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.10.m5.1d">I_{\texttt{q}}</annotation></semantics></math>. Finally, the restored image is generated.</figcaption>
</figure>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>In-context Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Transformers have a generalized modeling capability through the use of tokens. Leveraging this, DETR <cite class="ltx_cite ltx_citemacro_citep">(Carion et al. <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite> used transformer heads for object detection. Pix2Seq <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite> discretized the output space of object detection. Unified-IO <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite> and Pix2Seqv2 <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib9" title="" class="ltx_ref">2022a</a>)</cite> extended this approach to multiple vision tasks (generalist models) using task prompts. These methods use a discrete output space, which is unsuitable for continuous space of image data, making it challenging to enable visual in-context learning.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Recent advancements in in-context learning have significantly improved the zero-shot performance of large language models. GPT-3 <cite class="ltx_cite ltx_citemacro_citep">(Brown et al. <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite> demonstrated this using text completion with prompts as context while Flamingo <cite class="ltx_cite ltx_citemacro_citep">(Alayrac et al. <a href="#bib.bib2" title="" class="ltx_ref">2022</a>)</cite> used language guidance for various image and video tasks. Visual in-context learning is an emerging area which is gaining increasing attention. VPI <cite class="ltx_cite ltx_citemacro_citep">(Bar et al. <a href="#bib.bib5" title="" class="ltx_ref">2022</a>)</cite> proposed an image-based continuous output space for visual in-context segmentation. Directly using visual context for tackling multiple computer vision tasks is challenging due to the non-unified output space. To address this, Painter <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib38" title="" class="ltx_ref">2023a</a>)</cite> extended VPI for diverse computer vision tasks by unifying their output spaces. However, these approaches rely heavily on masked-image modeling to learn context (see Painter), which is ineffective for image restoration because there is no dedicated module to capture degradation-specific information. Additionally, context information provided at the network’s input may not propagate to deeper layers.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Methodology</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.2" class="ltx_p">In this section, we explain in detail our proposed approach, AWRaCLe, for performing AWIR (deraining, desnowing and dehazing) using visual in-context learning. A high-level schematic of AWRaCLe is shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.1 Adverse weather restoration ‣ 2 Related Works ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. The main idea of our approach involves extracting relevant degradation-context such as the type and visual characteristics of degradations from a given image-ground truth pair to effectively restore a query image with the same type of degradation. Toward this aim, we propose Degradation Context Extraction (DCE) and Context Fusion (CF) blocks that learn context information and fuse it with an image restoration network to facilitate the restoration process. Specifically, we integrate our DCE and CF blocks with a slightly modified version of the Restormer network (see supplementary for details). The DCE and CF blocks are added at each decoder level of Restormer for propagation of context information (multi-level fusion). The decoder levels are represented by <math id="S3.p1.1.m1.3" class="ltx_Math" alttext="l=0,1,2" display="inline"><semantics id="S3.p1.1.m1.3a"><mrow id="S3.p1.1.m1.3.4" xref="S3.p1.1.m1.3.4.cmml"><mi id="S3.p1.1.m1.3.4.2" xref="S3.p1.1.m1.3.4.2.cmml">l</mi><mo id="S3.p1.1.m1.3.4.1" xref="S3.p1.1.m1.3.4.1.cmml">=</mo><mrow id="S3.p1.1.m1.3.4.3.2" xref="S3.p1.1.m1.3.4.3.1.cmml"><mn id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">0</mn><mo id="S3.p1.1.m1.3.4.3.2.1" xref="S3.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S3.p1.1.m1.2.2" xref="S3.p1.1.m1.2.2.cmml">1</mn><mo id="S3.p1.1.m1.3.4.3.2.2" xref="S3.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S3.p1.1.m1.3.3" xref="S3.p1.1.m1.3.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.3b"><apply id="S3.p1.1.m1.3.4.cmml" xref="S3.p1.1.m1.3.4"><eq id="S3.p1.1.m1.3.4.1.cmml" xref="S3.p1.1.m1.3.4.1"></eq><ci id="S3.p1.1.m1.3.4.2.cmml" xref="S3.p1.1.m1.3.4.2">𝑙</ci><list id="S3.p1.1.m1.3.4.3.1.cmml" xref="S3.p1.1.m1.3.4.3.2"><cn type="integer" id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">0</cn><cn type="integer" id="S3.p1.1.m1.2.2.cmml" xref="S3.p1.1.m1.2.2">1</cn><cn type="integer" id="S3.p1.1.m1.3.3.cmml" xref="S3.p1.1.m1.3.3">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.3c">l=0,1,2</annotation></semantics></math> and <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S3.p1.2.m2.1a"><mn id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><cn type="integer" id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">3</annotation></semantics></math> in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.1 Adverse weather restoration ‣ 2 Related Works ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. AWRaCLe overcomes the limitations of Painter which solely relies on masked image modelling to extract context information. Also, they provide context information only at the input, thus lacking any mechanism to ensure its flow throughout the network.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.9" class="ltx_p"><span id="S3.p2.9.1" class="ltx_text ltx_font_bold">Terminology.</span> For ease of understanding, we define a few terms. We refer to the context-pair as <math id="S3.p2.1.m1.2" class="ltx_Math" alttext="\mathcal{C}=\{I_{\texttt{d}},I_{\texttt{c}}\}" display="inline"><semantics id="S3.p2.1.m1.2a"><mrow id="S3.p2.1.m1.2.2" xref="S3.p2.1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.2.2.4" xref="S3.p2.1.m1.2.2.4.cmml">𝒞</mi><mo id="S3.p2.1.m1.2.2.3" xref="S3.p2.1.m1.2.2.3.cmml">=</mo><mrow id="S3.p2.1.m1.2.2.2.2" xref="S3.p2.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.p2.1.m1.2.2.2.2.3" xref="S3.p2.1.m1.2.2.2.3.cmml">{</mo><msub id="S3.p2.1.m1.1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.p2.1.m1.1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.1.1.3a.cmml">d</mtext></msub><mo id="S3.p2.1.m1.2.2.2.2.4" xref="S3.p2.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.p2.1.m1.2.2.2.2.2" xref="S3.p2.1.m1.2.2.2.2.2.cmml"><mi id="S3.p2.1.m1.2.2.2.2.2.2" xref="S3.p2.1.m1.2.2.2.2.2.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.p2.1.m1.2.2.2.2.2.3" xref="S3.p2.1.m1.2.2.2.2.2.3a.cmml">c</mtext></msub><mo stretchy="false" id="S3.p2.1.m1.2.2.2.2.5" xref="S3.p2.1.m1.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.2b"><apply id="S3.p2.1.m1.2.2.cmml" xref="S3.p2.1.m1.2.2"><eq id="S3.p2.1.m1.2.2.3.cmml" xref="S3.p2.1.m1.2.2.3"></eq><ci id="S3.p2.1.m1.2.2.4.cmml" xref="S3.p2.1.m1.2.2.4">𝒞</ci><set id="S3.p2.1.m1.2.2.2.3.cmml" xref="S3.p2.1.m1.2.2.2.2"><apply id="S3.p2.1.m1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2">𝐼</ci><ci id="S3.p2.1.m1.1.1.1.1.1.3a.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3">d</mtext></ci></apply><apply id="S3.p2.1.m1.2.2.2.2.2.cmml" xref="S3.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.2.2.2.1.cmml" xref="S3.p2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.p2.1.m1.2.2.2.2.2.2">𝐼</ci><ci id="S3.p2.1.m1.2.2.2.2.2.3a.cmml" xref="S3.p2.1.m1.2.2.2.2.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.p2.1.m1.2.2.2.2.2.3.cmml" xref="S3.p2.1.m1.2.2.2.2.2.3">c</mtext></ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.2c">\mathcal{C}=\{I_{\texttt{d}},I_{\texttt{c}}\}</annotation></semantics></math> where <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.p2.2.m2.1a"><msub id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝐼</ci><ci id="S3.p2.2.m2.1.1.3a.cmml" xref="S3.p2.2.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">I_{\texttt{d}}</annotation></semantics></math> is the degraded image and <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="I_{\texttt{c}}" display="inline"><semantics id="S3.p2.3.m3.1a"><msub id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝐼</ci><ci id="S3.p2.3.m3.1.1.3a.cmml" xref="S3.p2.3.m3.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">I_{\texttt{c}}</annotation></semantics></math> is its corresponding clean image. <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="I_{\texttt{q}}" display="inline"><semantics id="S3.p2.4.m4.1a"><msub id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3a.cmml">q</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝐼</ci><ci id="S3.p2.4.m4.1.1.3a.cmml" xref="S3.p2.4.m4.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">q</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">I_{\texttt{q}}</annotation></semantics></math> is the degraded query image which needs to be restored given <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.p2.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">\mathcal{C}</annotation></semantics></math>. Note that <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="I_{\texttt{q}}" display="inline"><semantics id="S3.p2.6.m6.1a"><msub id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3a.cmml">q</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2">𝐼</ci><ci id="S3.p2.6.m6.1.1.3a.cmml" xref="S3.p2.6.m6.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">q</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">I_{\texttt{q}}</annotation></semantics></math> and <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.p2.7.m7.1a"><msub id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">𝐼</ci><ci id="S3.p2.7.m7.1.1.3a.cmml" xref="S3.p2.7.m7.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">I_{\texttt{d}}</annotation></semantics></math> are affected by the same type of degradation. Additionally, <math id="S3.p2.8.m8.3" class="ltx_Math" alttext="I_{\texttt{d}},I_{\texttt{c}},I_{\texttt{q}}\in\mathbb{R}^{H\times W\times 3}" display="inline"><semantics id="S3.p2.8.m8.3a"><mrow id="S3.p2.8.m8.3.3" xref="S3.p2.8.m8.3.3.cmml"><mrow id="S3.p2.8.m8.3.3.3.3" xref="S3.p2.8.m8.3.3.3.4.cmml"><msub id="S3.p2.8.m8.1.1.1.1.1" xref="S3.p2.8.m8.1.1.1.1.1.cmml"><mi id="S3.p2.8.m8.1.1.1.1.1.2" xref="S3.p2.8.m8.1.1.1.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.p2.8.m8.1.1.1.1.1.3" xref="S3.p2.8.m8.1.1.1.1.1.3a.cmml">d</mtext></msub><mo id="S3.p2.8.m8.3.3.3.3.4" xref="S3.p2.8.m8.3.3.3.4.cmml">,</mo><msub id="S3.p2.8.m8.2.2.2.2.2" xref="S3.p2.8.m8.2.2.2.2.2.cmml"><mi id="S3.p2.8.m8.2.2.2.2.2.2" xref="S3.p2.8.m8.2.2.2.2.2.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.p2.8.m8.2.2.2.2.2.3" xref="S3.p2.8.m8.2.2.2.2.2.3a.cmml">c</mtext></msub><mo id="S3.p2.8.m8.3.3.3.3.5" xref="S3.p2.8.m8.3.3.3.4.cmml">,</mo><msub id="S3.p2.8.m8.3.3.3.3.3" xref="S3.p2.8.m8.3.3.3.3.3.cmml"><mi id="S3.p2.8.m8.3.3.3.3.3.2" xref="S3.p2.8.m8.3.3.3.3.3.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.p2.8.m8.3.3.3.3.3.3" xref="S3.p2.8.m8.3.3.3.3.3.3a.cmml">q</mtext></msub></mrow><mo id="S3.p2.8.m8.3.3.4" xref="S3.p2.8.m8.3.3.4.cmml">∈</mo><msup id="S3.p2.8.m8.3.3.5" xref="S3.p2.8.m8.3.3.5.cmml"><mi id="S3.p2.8.m8.3.3.5.2" xref="S3.p2.8.m8.3.3.5.2.cmml">ℝ</mi><mrow id="S3.p2.8.m8.3.3.5.3" xref="S3.p2.8.m8.3.3.5.3.cmml"><mi id="S3.p2.8.m8.3.3.5.3.2" xref="S3.p2.8.m8.3.3.5.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p2.8.m8.3.3.5.3.1" xref="S3.p2.8.m8.3.3.5.3.1.cmml">×</mo><mi id="S3.p2.8.m8.3.3.5.3.3" xref="S3.p2.8.m8.3.3.5.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p2.8.m8.3.3.5.3.1a" xref="S3.p2.8.m8.3.3.5.3.1.cmml">×</mo><mn id="S3.p2.8.m8.3.3.5.3.4" xref="S3.p2.8.m8.3.3.5.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.3b"><apply id="S3.p2.8.m8.3.3.cmml" xref="S3.p2.8.m8.3.3"><in id="S3.p2.8.m8.3.3.4.cmml" xref="S3.p2.8.m8.3.3.4"></in><list id="S3.p2.8.m8.3.3.3.4.cmml" xref="S3.p2.8.m8.3.3.3.3"><apply id="S3.p2.8.m8.1.1.1.1.1.cmml" xref="S3.p2.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.1.1.1.1.cmml" xref="S3.p2.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.8.m8.1.1.1.1.1.2.cmml" xref="S3.p2.8.m8.1.1.1.1.1.2">𝐼</ci><ci id="S3.p2.8.m8.1.1.1.1.1.3a.cmml" xref="S3.p2.8.m8.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.p2.8.m8.1.1.1.1.1.3.cmml" xref="S3.p2.8.m8.1.1.1.1.1.3">d</mtext></ci></apply><apply id="S3.p2.8.m8.2.2.2.2.2.cmml" xref="S3.p2.8.m8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.8.m8.2.2.2.2.2.1.cmml" xref="S3.p2.8.m8.2.2.2.2.2">subscript</csymbol><ci id="S3.p2.8.m8.2.2.2.2.2.2.cmml" xref="S3.p2.8.m8.2.2.2.2.2.2">𝐼</ci><ci id="S3.p2.8.m8.2.2.2.2.2.3a.cmml" xref="S3.p2.8.m8.2.2.2.2.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.p2.8.m8.2.2.2.2.2.3.cmml" xref="S3.p2.8.m8.2.2.2.2.2.3">c</mtext></ci></apply><apply id="S3.p2.8.m8.3.3.3.3.3.cmml" xref="S3.p2.8.m8.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.p2.8.m8.3.3.3.3.3.1.cmml" xref="S3.p2.8.m8.3.3.3.3.3">subscript</csymbol><ci id="S3.p2.8.m8.3.3.3.3.3.2.cmml" xref="S3.p2.8.m8.3.3.3.3.3.2">𝐼</ci><ci id="S3.p2.8.m8.3.3.3.3.3.3a.cmml" xref="S3.p2.8.m8.3.3.3.3.3.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.p2.8.m8.3.3.3.3.3.3.cmml" xref="S3.p2.8.m8.3.3.3.3.3.3">q</mtext></ci></apply></list><apply id="S3.p2.8.m8.3.3.5.cmml" xref="S3.p2.8.m8.3.3.5"><csymbol cd="ambiguous" id="S3.p2.8.m8.3.3.5.1.cmml" xref="S3.p2.8.m8.3.3.5">superscript</csymbol><ci id="S3.p2.8.m8.3.3.5.2.cmml" xref="S3.p2.8.m8.3.3.5.2">ℝ</ci><apply id="S3.p2.8.m8.3.3.5.3.cmml" xref="S3.p2.8.m8.3.3.5.3"><times id="S3.p2.8.m8.3.3.5.3.1.cmml" xref="S3.p2.8.m8.3.3.5.3.1"></times><ci id="S3.p2.8.m8.3.3.5.3.2.cmml" xref="S3.p2.8.m8.3.3.5.3.2">𝐻</ci><ci id="S3.p2.8.m8.3.3.5.3.3.cmml" xref="S3.p2.8.m8.3.3.5.3.3">𝑊</ci><cn type="integer" id="S3.p2.8.m8.3.3.5.3.4.cmml" xref="S3.p2.8.m8.3.3.5.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.3c">I_{\texttt{d}},I_{\texttt{c}},I_{\texttt{q}}\in\mathbb{R}^{H\times W\times 3}</annotation></semantics></math> where <math id="S3.p2.9.m9.2" class="ltx_Math" alttext="H,W" display="inline"><semantics id="S3.p2.9.m9.2a"><mrow id="S3.p2.9.m9.2.3.2" xref="S3.p2.9.m9.2.3.1.cmml"><mi id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml">H</mi><mo id="S3.p2.9.m9.2.3.2.1" xref="S3.p2.9.m9.2.3.1.cmml">,</mo><mi id="S3.p2.9.m9.2.2" xref="S3.p2.9.m9.2.2.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.2b"><list id="S3.p2.9.m9.2.3.1.cmml" xref="S3.p2.9.m9.2.3.2"><ci id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1">𝐻</ci><ci id="S3.p2.9.m9.2.2.cmml" xref="S3.p2.9.m9.2.2">𝑊</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.2c">H,W</annotation></semantics></math> indicate the spatial resolution of the images.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Degradation Context Extraction</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.8" class="ltx_p">The objective of the DCE blocks is to extract degradation-specific context such as the type and visual characteristics from <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{C}</annotation></semantics></math>. It is crucial for the underlying scene content in <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝐼</ci><ci id="S3.SS1.p1.2.m2.1.1.3a.cmml" xref="S3.SS1.p1.2.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">I_{\texttt{d}}</annotation></semantics></math> and <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="I_{\texttt{c}}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝐼</ci><ci id="S3.SS1.p1.3.m3.1.1.3a.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">I_{\texttt{c}}</annotation></semantics></math> to be identical so that the only distinction between them is the degradation (we call this paired context). This condition facilitates the process of extracting degradation-specific information (DSI) from <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝐼</ci><ci id="S3.SS1.p1.4.m4.1.1.3a.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">I_{\texttt{d}}</annotation></semantics></math> and <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="I_{\texttt{c}}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝐼</ci><ci id="S3.SS1.p1.5.m5.1.1.3a.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">I_{\texttt{c}}</annotation></semantics></math>. In the ablations, we show that using un-paired context (<math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝐼</ci><ci id="S3.SS1.p1.6.m6.1.1.3a.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">I_{\texttt{d}}</annotation></semantics></math> and <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="I_{\texttt{c}}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><msub id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝐼</ci><ci id="S3.SS1.p1.7.m7.1.1.3a.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">I_{\texttt{c}}</annotation></semantics></math> are from different scenes) leads to inferior performance. Furthermore, it is important to note the considerable difficulty in extracting degradation-context solely from <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝐼</ci><ci id="S3.SS1.p1.8.m8.1.1.3a.cmml" xref="S3.SS1.p1.8.m8.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">I_{\texttt{d}}</annotation></semantics></math>. This challenge arises since it is not straightforward to disentangle the scene content from the degradation.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.5" class="ltx_p">We now elaborate the aforementioned process of extracting degradation-context from <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathcal{C}</annotation></semantics></math>. Vision-Language models (VLMs) such as CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al. <a href="#bib.bib31" title="" class="ltx_ref">2021</a>)</cite> have demonstrated the capability to learn high quality image embeddings that can be used to solve a myriad of downstream computer vision tasks <cite class="ltx_cite ltx_citemacro_citep">(Gu et al. <a href="#bib.bib13" title="" class="ltx_ref">2021</a>; Zhang et al. <a href="#bib.bib53" title="" class="ltx_ref">2022</a>, <a href="#bib.bib52" title="" class="ltx_ref">2018</a>; Shen et al. <a href="#bib.bib33" title="" class="ltx_ref">2021</a>)</cite>.
Motivated by this, we obtain representations <math id="S3.SS1.p2.2.m2.2" class="ltx_Math" alttext="E_{\texttt{d}},E_{\texttt{c}}" display="inline"><semantics id="S3.SS1.p2.2.m2.2a"><mrow id="S3.SS1.p2.2.m2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.3.cmml"><msub id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.2.cmml">E</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p2.2.m2.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.3a.cmml">d</mtext></msub><mo id="S3.SS1.p2.2.m2.2.2.2.3" xref="S3.SS1.p2.2.m2.2.2.3.cmml">,</mo><msub id="S3.SS1.p2.2.m2.2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.2.2.cmml"><mi id="S3.SS1.p2.2.m2.2.2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.2.2.2.cmml">E</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p2.2.m2.2.2.2.2.3" xref="S3.SS1.p2.2.m2.2.2.2.2.3a.cmml">c</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.2b"><list id="S3.SS1.p2.2.m2.2.2.3.cmml" xref="S3.SS1.p2.2.m2.2.2.2"><apply id="S3.SS1.p2.2.m2.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.2">𝐸</ci><ci id="S3.SS1.p2.2.m2.1.1.1.1.3a.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.3">d</mtext></ci></apply><apply id="S3.SS1.p2.2.m2.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.2.2.2.2.1.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.2">𝐸</ci><ci id="S3.SS1.p2.2.m2.2.2.2.2.3a.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p2.2.m2.2.2.2.2.3.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.3">c</mtext></ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.2c">E_{\texttt{d}},E_{\texttt{c}}</annotation></semantics></math> for the context pair <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mathcal{C}</annotation></semantics></math> from the final transformer block of CLIP’s image encoder (denoted by <math id="S3.SS1.p2.4.m4.1" class="ltx_math_unparsed" alttext="\texttt{CLIP}(.)" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1b"><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p2.4.m4.1.1">CLIP</mtext><mrow id="S3.SS1.p2.4.m4.1.2"><mo stretchy="false" id="S3.SS1.p2.4.m4.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S3.SS1.p2.4.m4.1.2.2">.</mo><mo stretchy="false" id="S3.SS1.p2.4.m4.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\texttt{CLIP}(.)</annotation></semantics></math>). The obtained features are then fed to the DCE blocks that are present at each decoder level <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">l</annotation></semantics></math> of the network. The above feature extraction step using CLIP is given as follows.</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.32" class="ltx_Math" alttext="\begin{split}E_{\texttt{d}}=\texttt{CLIP}(I_{\texttt{d}}),E_{\texttt{c}}=\texttt{CLIP}(I_{\texttt{c}}),\{E_{\texttt{d}},E_{\texttt{c}}\}\in\mathbb{R}^{L\times D}\end{split}" display="block"><semantics id="S3.E1.m1.32a"><mtable displaystyle="true" id="S3.E1.m1.32.32.4"><mtr id="S3.E1.m1.32.32.4a"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.32.32.4b"><mrow id="S3.E1.m1.32.32.4.30.30.30.30"><mrow id="S3.E1.m1.31.31.3.29.29.29.29.1"><msub id="S3.E1.m1.31.31.3.29.29.29.29.1.2"><mi id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">E</mi><mtext class="ltx_mathvariant_monospace" id="S3.E1.m1.2.2.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.2.1a.cmml">d</mtext></msub><mo id="S3.E1.m1.3.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E1.m1.31.31.3.29.29.29.29.1.1"><mtext class="ltx_mathvariant_monospace" id="S3.E1.m1.4.4.4.4.4.4" xref="S3.E1.m1.4.4.4.4.4.4a.cmml">CLIP</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.31.31.3.29.29.29.29.1.1.2" xref="S3.E1.m1.30.30.2.3.cmml">​</mo><mrow id="S3.E1.m1.31.31.3.29.29.29.29.1.1.1.1"><mo stretchy="false" id="S3.E1.m1.5.5.5.5.5.5" xref="S3.E1.m1.30.30.2.3.cmml">(</mo><msub id="S3.E1.m1.31.31.3.29.29.29.29.1.1.1.1.1"><mi id="S3.E1.m1.6.6.6.6.6.6" xref="S3.E1.m1.6.6.6.6.6.6.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.E1.m1.7.7.7.7.7.7.1" xref="S3.E1.m1.7.7.7.7.7.7.1a.cmml">d</mtext></msub><mo stretchy="false" id="S3.E1.m1.8.8.8.8.8.8" xref="S3.E1.m1.30.30.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.9.9.9.9.9.9" xref="S3.E1.m1.30.30.2.3.cmml">,</mo><mrow id="S3.E1.m1.32.32.4.30.30.30.30.2"><mrow id="S3.E1.m1.32.32.4.30.30.30.30.2.1.1"><msub id="S3.E1.m1.32.32.4.30.30.30.30.2.1.1.2"><mi id="S3.E1.m1.10.10.10.10.10.10" xref="S3.E1.m1.10.10.10.10.10.10.cmml">E</mi><mtext class="ltx_mathvariant_monospace" id="S3.E1.m1.11.11.11.11.11.11.1" xref="S3.E1.m1.11.11.11.11.11.11.1a.cmml">c</mtext></msub><mo id="S3.E1.m1.12.12.12.12.12.12" xref="S3.E1.m1.12.12.12.12.12.12.cmml">=</mo><mrow id="S3.E1.m1.32.32.4.30.30.30.30.2.1.1.1"><mtext class="ltx_mathvariant_monospace" id="S3.E1.m1.13.13.13.13.13.13" xref="S3.E1.m1.13.13.13.13.13.13a.cmml">CLIP</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.32.32.4.30.30.30.30.2.1.1.1.2" xref="S3.E1.m1.30.30.2.3.cmml">​</mo><mrow id="S3.E1.m1.32.32.4.30.30.30.30.2.1.1.1.1.1"><mo stretchy="false" id="S3.E1.m1.14.14.14.14.14.14" xref="S3.E1.m1.30.30.2.3.cmml">(</mo><msub id="S3.E1.m1.32.32.4.30.30.30.30.2.1.1.1.1.1.1"><mi id="S3.E1.m1.15.15.15.15.15.15" xref="S3.E1.m1.15.15.15.15.15.15.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.E1.m1.16.16.16.16.16.16.1" xref="S3.E1.m1.16.16.16.16.16.16.1a.cmml">c</mtext></msub><mo stretchy="false" id="S3.E1.m1.17.17.17.17.17.17" xref="S3.E1.m1.30.30.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.18.18.18.18.18.18" xref="S3.E1.m1.30.30.2.3.cmml">,</mo><mrow id="S3.E1.m1.32.32.4.30.30.30.30.2.2.2"><mrow id="S3.E1.m1.32.32.4.30.30.30.30.2.2.2.2.2"><mo stretchy="false" id="S3.E1.m1.19.19.19.19.19.19" xref="S3.E1.m1.30.30.2.3.cmml">{</mo><msub id="S3.E1.m1.32.32.4.30.30.30.30.2.2.2.1.1.1"><mi id="S3.E1.m1.20.20.20.20.20.20" xref="S3.E1.m1.20.20.20.20.20.20.cmml">E</mi><mtext class="ltx_mathvariant_monospace" id="S3.E1.m1.21.21.21.21.21.21.1" xref="S3.E1.m1.21.21.21.21.21.21.1a.cmml">d</mtext></msub><mo id="S3.E1.m1.22.22.22.22.22.22" xref="S3.E1.m1.30.30.2.3.cmml">,</mo><msub id="S3.E1.m1.32.32.4.30.30.30.30.2.2.2.2.2.2"><mi id="S3.E1.m1.23.23.23.23.23.23" xref="S3.E1.m1.23.23.23.23.23.23.cmml">E</mi><mtext class="ltx_mathvariant_monospace" id="S3.E1.m1.24.24.24.24.24.24.1" xref="S3.E1.m1.24.24.24.24.24.24.1a.cmml">c</mtext></msub><mo stretchy="false" id="S3.E1.m1.25.25.25.25.25.25" xref="S3.E1.m1.30.30.2.3.cmml">}</mo></mrow><mo id="S3.E1.m1.26.26.26.26.26.26" xref="S3.E1.m1.26.26.26.26.26.26.cmml">∈</mo><msup id="S3.E1.m1.32.32.4.30.30.30.30.2.2.2.3"><mi id="S3.E1.m1.27.27.27.27.27.27" xref="S3.E1.m1.27.27.27.27.27.27.cmml">ℝ</mi><mrow id="S3.E1.m1.28.28.28.28.28.28.1" xref="S3.E1.m1.28.28.28.28.28.28.1.cmml"><mi id="S3.E1.m1.28.28.28.28.28.28.1.2" xref="S3.E1.m1.28.28.28.28.28.28.1.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.28.28.28.28.28.28.1.1" xref="S3.E1.m1.28.28.28.28.28.28.1.1.cmml">×</mo><mi id="S3.E1.m1.28.28.28.28.28.28.1.3" xref="S3.E1.m1.28.28.28.28.28.28.1.3.cmml">D</mi></mrow></msup></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.32b"><apply id="S3.E1.m1.30.30.2.3.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.30.30.2.3a.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2">formulae-sequence</csymbol><apply id="S3.E1.m1.29.29.1.1.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><eq id="S3.E1.m1.3.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3"></eq><apply id="S3.E1.m1.29.29.1.1.1.3.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.29.29.1.1.1.3.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">𝐸</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1a.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1">d</mtext></ci></apply><apply id="S3.E1.m1.29.29.1.1.1.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><times id="S3.E1.m1.29.29.1.1.1.1.2.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"></times><ci id="S3.E1.m1.4.4.4.4.4.4a.cmml" xref="S3.E1.m1.4.4.4.4.4.4"><mtext class="ltx_mathvariant_monospace" id="S3.E1.m1.4.4.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4.4.4">CLIP</mtext></ci><apply id="S3.E1.m1.29.29.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.29.29.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2">subscript</csymbol><ci id="S3.E1.m1.6.6.6.6.6.6.cmml" xref="S3.E1.m1.6.6.6.6.6.6">𝐼</ci><ci id="S3.E1.m1.7.7.7.7.7.7.1a.cmml" xref="S3.E1.m1.7.7.7.7.7.7.1"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E1.m1.7.7.7.7.7.7.1.cmml" xref="S3.E1.m1.7.7.7.7.7.7.1">d</mtext></ci></apply></apply></apply><apply id="S3.E1.m1.30.30.2.2.2.3.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.30.30.2.2.2.3a.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2">formulae-sequence</csymbol><apply id="S3.E1.m1.30.30.2.2.2.1.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><eq id="S3.E1.m1.12.12.12.12.12.12.cmml" xref="S3.E1.m1.12.12.12.12.12.12"></eq><apply id="S3.E1.m1.30.30.2.2.2.1.1.3.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.30.30.2.2.2.1.1.3.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2">subscript</csymbol><ci id="S3.E1.m1.10.10.10.10.10.10.cmml" xref="S3.E1.m1.10.10.10.10.10.10">𝐸</ci><ci id="S3.E1.m1.11.11.11.11.11.11.1a.cmml" xref="S3.E1.m1.11.11.11.11.11.11.1"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E1.m1.11.11.11.11.11.11.1.cmml" xref="S3.E1.m1.11.11.11.11.11.11.1">c</mtext></ci></apply><apply id="S3.E1.m1.30.30.2.2.2.1.1.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><times id="S3.E1.m1.30.30.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"></times><ci id="S3.E1.m1.13.13.13.13.13.13a.cmml" xref="S3.E1.m1.13.13.13.13.13.13"><mtext class="ltx_mathvariant_monospace" id="S3.E1.m1.13.13.13.13.13.13.cmml" xref="S3.E1.m1.13.13.13.13.13.13">CLIP</mtext></ci><apply id="S3.E1.m1.30.30.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.30.30.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2">subscript</csymbol><ci id="S3.E1.m1.15.15.15.15.15.15.cmml" xref="S3.E1.m1.15.15.15.15.15.15">𝐼</ci><ci id="S3.E1.m1.16.16.16.16.16.16.1a.cmml" xref="S3.E1.m1.16.16.16.16.16.16.1"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E1.m1.16.16.16.16.16.16.1.cmml" xref="S3.E1.m1.16.16.16.16.16.16.1">c</mtext></ci></apply></apply></apply><apply id="S3.E1.m1.30.30.2.2.2.2.2.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><in id="S3.E1.m1.26.26.26.26.26.26.cmml" xref="S3.E1.m1.26.26.26.26.26.26"></in><set id="S3.E1.m1.30.30.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><apply id="S3.E1.m1.30.30.2.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.30.30.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2">subscript</csymbol><ci id="S3.E1.m1.20.20.20.20.20.20.cmml" xref="S3.E1.m1.20.20.20.20.20.20">𝐸</ci><ci id="S3.E1.m1.21.21.21.21.21.21.1a.cmml" xref="S3.E1.m1.21.21.21.21.21.21.1"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E1.m1.21.21.21.21.21.21.1.cmml" xref="S3.E1.m1.21.21.21.21.21.21.1">d</mtext></ci></apply><apply id="S3.E1.m1.30.30.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.30.30.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2">subscript</csymbol><ci id="S3.E1.m1.23.23.23.23.23.23.cmml" xref="S3.E1.m1.23.23.23.23.23.23">𝐸</ci><ci id="S3.E1.m1.24.24.24.24.24.24.1a.cmml" xref="S3.E1.m1.24.24.24.24.24.24.1"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E1.m1.24.24.24.24.24.24.1.cmml" xref="S3.E1.m1.24.24.24.24.24.24.1">c</mtext></ci></apply></set><apply id="S3.E1.m1.30.30.2.2.2.2.2.4.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.30.30.2.2.2.2.2.4.1.cmml" xref="S3.E1.m1.31.31.3.29.29.29.29.1.1.2">superscript</csymbol><ci id="S3.E1.m1.27.27.27.27.27.27.cmml" xref="S3.E1.m1.27.27.27.27.27.27">ℝ</ci><apply id="S3.E1.m1.28.28.28.28.28.28.1.cmml" xref="S3.E1.m1.28.28.28.28.28.28.1"><times id="S3.E1.m1.28.28.28.28.28.28.1.1.cmml" xref="S3.E1.m1.28.28.28.28.28.28.1.1"></times><ci id="S3.E1.m1.28.28.28.28.28.28.1.2.cmml" xref="S3.E1.m1.28.28.28.28.28.28.1.2">𝐿</ci><ci id="S3.E1.m1.28.28.28.28.28.28.1.3.cmml" xref="S3.E1.m1.28.28.28.28.28.28.1.3">𝐷</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.32c">\begin{split}E_{\texttt{d}}=\texttt{CLIP}(I_{\texttt{d}}),E_{\texttt{c}}=\texttt{CLIP}(I_{\texttt{c}}),\{E_{\texttt{d}},E_{\texttt{c}}\}\in\mathbb{R}^{L\times D}\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.15" class="ltx_p"><math id="S3.SS1.p2.6.m1.1" class="ltx_Math" alttext="E_{\texttt{d}}" display="inline"><semantics id="S3.SS1.p2.6.m1.1a"><msub id="S3.SS1.p2.6.m1.1.1" xref="S3.SS1.p2.6.m1.1.1.cmml"><mi id="S3.SS1.p2.6.m1.1.1.2" xref="S3.SS1.p2.6.m1.1.1.2.cmml">E</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p2.6.m1.1.1.3" xref="S3.SS1.p2.6.m1.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m1.1b"><apply id="S3.SS1.p2.6.m1.1.1.cmml" xref="S3.SS1.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m1.1.1.1.cmml" xref="S3.SS1.p2.6.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m1.1.1.2.cmml" xref="S3.SS1.p2.6.m1.1.1.2">𝐸</ci><ci id="S3.SS1.p2.6.m1.1.1.3a.cmml" xref="S3.SS1.p2.6.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p2.6.m1.1.1.3.cmml" xref="S3.SS1.p2.6.m1.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m1.1c">E_{\texttt{d}}</annotation></semantics></math> and <math id="S3.SS1.p2.7.m2.1" class="ltx_Math" alttext="E_{\texttt{c}}" display="inline"><semantics id="S3.SS1.p2.7.m2.1a"><msub id="S3.SS1.p2.7.m2.1.1" xref="S3.SS1.p2.7.m2.1.1.cmml"><mi id="S3.SS1.p2.7.m2.1.1.2" xref="S3.SS1.p2.7.m2.1.1.2.cmml">E</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p2.7.m2.1.1.3" xref="S3.SS1.p2.7.m2.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m2.1b"><apply id="S3.SS1.p2.7.m2.1.1.cmml" xref="S3.SS1.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m2.1.1.1.cmml" xref="S3.SS1.p2.7.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m2.1.1.2.cmml" xref="S3.SS1.p2.7.m2.1.1.2">𝐸</ci><ci id="S3.SS1.p2.7.m2.1.1.3a.cmml" xref="S3.SS1.p2.7.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p2.7.m2.1.1.3.cmml" xref="S3.SS1.p2.7.m2.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m2.1c">E_{\texttt{c}}</annotation></semantics></math> are then concatenated to obtain <math id="S3.SS1.p2.8.m3.1" class="ltx_Math" alttext="E_{\mathcal{C}}\in\mathbb{R}^{2L\times D}" display="inline"><semantics id="S3.SS1.p2.8.m3.1a"><mrow id="S3.SS1.p2.8.m3.1.1" xref="S3.SS1.p2.8.m3.1.1.cmml"><msub id="S3.SS1.p2.8.m3.1.1.2" xref="S3.SS1.p2.8.m3.1.1.2.cmml"><mi id="S3.SS1.p2.8.m3.1.1.2.2" xref="S3.SS1.p2.8.m3.1.1.2.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.8.m3.1.1.2.3" xref="S3.SS1.p2.8.m3.1.1.2.3.cmml">𝒞</mi></msub><mo id="S3.SS1.p2.8.m3.1.1.1" xref="S3.SS1.p2.8.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.8.m3.1.1.3" xref="S3.SS1.p2.8.m3.1.1.3.cmml"><mi id="S3.SS1.p2.8.m3.1.1.3.2" xref="S3.SS1.p2.8.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.8.m3.1.1.3.3" xref="S3.SS1.p2.8.m3.1.1.3.3.cmml"><mrow id="S3.SS1.p2.8.m3.1.1.3.3.2" xref="S3.SS1.p2.8.m3.1.1.3.3.2.cmml"><mn id="S3.SS1.p2.8.m3.1.1.3.3.2.2" xref="S3.SS1.p2.8.m3.1.1.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS1.p2.8.m3.1.1.3.3.2.1" xref="S3.SS1.p2.8.m3.1.1.3.3.2.1.cmml">​</mo><mi id="S3.SS1.p2.8.m3.1.1.3.3.2.3" xref="S3.SS1.p2.8.m3.1.1.3.3.2.3.cmml">L</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.8.m3.1.1.3.3.1" xref="S3.SS1.p2.8.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.8.m3.1.1.3.3.3" xref="S3.SS1.p2.8.m3.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m3.1b"><apply id="S3.SS1.p2.8.m3.1.1.cmml" xref="S3.SS1.p2.8.m3.1.1"><in id="S3.SS1.p2.8.m3.1.1.1.cmml" xref="S3.SS1.p2.8.m3.1.1.1"></in><apply id="S3.SS1.p2.8.m3.1.1.2.cmml" xref="S3.SS1.p2.8.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m3.1.1.2.1.cmml" xref="S3.SS1.p2.8.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.8.m3.1.1.2.2.cmml" xref="S3.SS1.p2.8.m3.1.1.2.2">𝐸</ci><ci id="S3.SS1.p2.8.m3.1.1.2.3.cmml" xref="S3.SS1.p2.8.m3.1.1.2.3">𝒞</ci></apply><apply id="S3.SS1.p2.8.m3.1.1.3.cmml" xref="S3.SS1.p2.8.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m3.1.1.3.1.cmml" xref="S3.SS1.p2.8.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.8.m3.1.1.3.2.cmml" xref="S3.SS1.p2.8.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.8.m3.1.1.3.3.cmml" xref="S3.SS1.p2.8.m3.1.1.3.3"><times id="S3.SS1.p2.8.m3.1.1.3.3.1.cmml" xref="S3.SS1.p2.8.m3.1.1.3.3.1"></times><apply id="S3.SS1.p2.8.m3.1.1.3.3.2.cmml" xref="S3.SS1.p2.8.m3.1.1.3.3.2"><times id="S3.SS1.p2.8.m3.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.8.m3.1.1.3.3.2.1"></times><cn type="integer" id="S3.SS1.p2.8.m3.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.8.m3.1.1.3.3.2.2">2</cn><ci id="S3.SS1.p2.8.m3.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.8.m3.1.1.3.3.2.3">𝐿</ci></apply><ci id="S3.SS1.p2.8.m3.1.1.3.3.3.cmml" xref="S3.SS1.p2.8.m3.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m3.1c">E_{\mathcal{C}}\in\mathbb{R}^{2L\times D}</annotation></semantics></math> as the overall CLIP representation for <math id="S3.SS1.p2.9.m4.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S3.SS1.p2.9.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.9.m4.1.1" xref="S3.SS1.p2.9.m4.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m4.1b"><ci id="S3.SS1.p2.9.m4.1.1.cmml" xref="S3.SS1.p2.9.m4.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m4.1c">\mathcal{C}</annotation></semantics></math>. Here, <math id="S3.SS1.p2.10.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS1.p2.10.m5.1a"><mi id="S3.SS1.p2.10.m5.1.1" xref="S3.SS1.p2.10.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m5.1b"><ci id="S3.SS1.p2.10.m5.1.1.cmml" xref="S3.SS1.p2.10.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m5.1c">L</annotation></semantics></math> represents the number of tokens and <math id="S3.SS1.p2.11.m6.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS1.p2.11.m6.1a"><mi id="S3.SS1.p2.11.m6.1.1" xref="S3.SS1.p2.11.m6.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m6.1b"><ci id="S3.SS1.p2.11.m6.1.1.cmml" xref="S3.SS1.p2.11.m6.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m6.1c">D</annotation></semantics></math> is the embedding dimension. Within a DCE block at level <math id="S3.SS1.p2.12.m7.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p2.12.m7.1a"><mi id="S3.SS1.p2.12.m7.1.1" xref="S3.SS1.p2.12.m7.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m7.1b"><ci id="S3.SS1.p2.12.m7.1.1.cmml" xref="S3.SS1.p2.12.m7.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m7.1c">l</annotation></semantics></math>, <math id="S3.SS1.p2.13.m8.1" class="ltx_Math" alttext="E_{\mathcal{C}}" display="inline"><semantics id="S3.SS1.p2.13.m8.1a"><msub id="S3.SS1.p2.13.m8.1.1" xref="S3.SS1.p2.13.m8.1.1.cmml"><mi id="S3.SS1.p2.13.m8.1.1.2" xref="S3.SS1.p2.13.m8.1.1.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.13.m8.1.1.3" xref="S3.SS1.p2.13.m8.1.1.3.cmml">𝒞</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m8.1b"><apply id="S3.SS1.p2.13.m8.1.1.cmml" xref="S3.SS1.p2.13.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m8.1.1.1.cmml" xref="S3.SS1.p2.13.m8.1.1">subscript</csymbol><ci id="S3.SS1.p2.13.m8.1.1.2.cmml" xref="S3.SS1.p2.13.m8.1.1.2">𝐸</ci><ci id="S3.SS1.p2.13.m8.1.1.3.cmml" xref="S3.SS1.p2.13.m8.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m8.1c">E_{\mathcal{C}}</annotation></semantics></math> is initially projected to a lower dimension to reduce computational complexity for forthcoming attention operations. This is followed by GELU <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks and Gimpel <a href="#bib.bib16" title="" class="ltx_ref">2016</a>)</cite> activation function as non-linearity. The result of these operations is <math id="S3.SS1.p2.14.m9.1" class="ltx_Math" alttext="P_{\mathcal{C}}^{l}\in\mathbb{R}^{2L\times C^{l}}" display="inline"><semantics id="S3.SS1.p2.14.m9.1a"><mrow id="S3.SS1.p2.14.m9.1.1" xref="S3.SS1.p2.14.m9.1.1.cmml"><msubsup id="S3.SS1.p2.14.m9.1.1.2" xref="S3.SS1.p2.14.m9.1.1.2.cmml"><mi id="S3.SS1.p2.14.m9.1.1.2.2.2" xref="S3.SS1.p2.14.m9.1.1.2.2.2.cmml">P</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.14.m9.1.1.2.2.3" xref="S3.SS1.p2.14.m9.1.1.2.2.3.cmml">𝒞</mi><mi id="S3.SS1.p2.14.m9.1.1.2.3" xref="S3.SS1.p2.14.m9.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.SS1.p2.14.m9.1.1.1" xref="S3.SS1.p2.14.m9.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.14.m9.1.1.3" xref="S3.SS1.p2.14.m9.1.1.3.cmml"><mi id="S3.SS1.p2.14.m9.1.1.3.2" xref="S3.SS1.p2.14.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.14.m9.1.1.3.3" xref="S3.SS1.p2.14.m9.1.1.3.3.cmml"><mrow id="S3.SS1.p2.14.m9.1.1.3.3.2" xref="S3.SS1.p2.14.m9.1.1.3.3.2.cmml"><mn id="S3.SS1.p2.14.m9.1.1.3.3.2.2" xref="S3.SS1.p2.14.m9.1.1.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS1.p2.14.m9.1.1.3.3.2.1" xref="S3.SS1.p2.14.m9.1.1.3.3.2.1.cmml">​</mo><mi id="S3.SS1.p2.14.m9.1.1.3.3.2.3" xref="S3.SS1.p2.14.m9.1.1.3.3.2.3.cmml">L</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.14.m9.1.1.3.3.1" xref="S3.SS1.p2.14.m9.1.1.3.3.1.cmml">×</mo><msup id="S3.SS1.p2.14.m9.1.1.3.3.3" xref="S3.SS1.p2.14.m9.1.1.3.3.3.cmml"><mi id="S3.SS1.p2.14.m9.1.1.3.3.3.2" xref="S3.SS1.p2.14.m9.1.1.3.3.3.2.cmml">C</mi><mi id="S3.SS1.p2.14.m9.1.1.3.3.3.3" xref="S3.SS1.p2.14.m9.1.1.3.3.3.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m9.1b"><apply id="S3.SS1.p2.14.m9.1.1.cmml" xref="S3.SS1.p2.14.m9.1.1"><in id="S3.SS1.p2.14.m9.1.1.1.cmml" xref="S3.SS1.p2.14.m9.1.1.1"></in><apply id="S3.SS1.p2.14.m9.1.1.2.cmml" xref="S3.SS1.p2.14.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m9.1.1.2.1.cmml" xref="S3.SS1.p2.14.m9.1.1.2">superscript</csymbol><apply id="S3.SS1.p2.14.m9.1.1.2.2.cmml" xref="S3.SS1.p2.14.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m9.1.1.2.2.1.cmml" xref="S3.SS1.p2.14.m9.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.14.m9.1.1.2.2.2.cmml" xref="S3.SS1.p2.14.m9.1.1.2.2.2">𝑃</ci><ci id="S3.SS1.p2.14.m9.1.1.2.2.3.cmml" xref="S3.SS1.p2.14.m9.1.1.2.2.3">𝒞</ci></apply><ci id="S3.SS1.p2.14.m9.1.1.2.3.cmml" xref="S3.SS1.p2.14.m9.1.1.2.3">𝑙</ci></apply><apply id="S3.SS1.p2.14.m9.1.1.3.cmml" xref="S3.SS1.p2.14.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m9.1.1.3.1.cmml" xref="S3.SS1.p2.14.m9.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.14.m9.1.1.3.2.cmml" xref="S3.SS1.p2.14.m9.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.14.m9.1.1.3.3.cmml" xref="S3.SS1.p2.14.m9.1.1.3.3"><times id="S3.SS1.p2.14.m9.1.1.3.3.1.cmml" xref="S3.SS1.p2.14.m9.1.1.3.3.1"></times><apply id="S3.SS1.p2.14.m9.1.1.3.3.2.cmml" xref="S3.SS1.p2.14.m9.1.1.3.3.2"><times id="S3.SS1.p2.14.m9.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.14.m9.1.1.3.3.2.1"></times><cn type="integer" id="S3.SS1.p2.14.m9.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.14.m9.1.1.3.3.2.2">2</cn><ci id="S3.SS1.p2.14.m9.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.14.m9.1.1.3.3.2.3">𝐿</ci></apply><apply id="S3.SS1.p2.14.m9.1.1.3.3.3.cmml" xref="S3.SS1.p2.14.m9.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.14.m9.1.1.3.3.3.1.cmml" xref="S3.SS1.p2.14.m9.1.1.3.3.3">superscript</csymbol><ci id="S3.SS1.p2.14.m9.1.1.3.3.3.2.cmml" xref="S3.SS1.p2.14.m9.1.1.3.3.3.2">𝐶</ci><ci id="S3.SS1.p2.14.m9.1.1.3.3.3.3.cmml" xref="S3.SS1.p2.14.m9.1.1.3.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m9.1c">P_{\mathcal{C}}^{l}\in\mathbb{R}^{2L\times C^{l}}</annotation></semantics></math>, where <math id="S3.SS1.p2.15.m10.1" class="ltx_Math" alttext="C^{l}" display="inline"><semantics id="S3.SS1.p2.15.m10.1a"><msup id="S3.SS1.p2.15.m10.1.1" xref="S3.SS1.p2.15.m10.1.1.cmml"><mi id="S3.SS1.p2.15.m10.1.1.2" xref="S3.SS1.p2.15.m10.1.1.2.cmml">C</mi><mi id="S3.SS1.p2.15.m10.1.1.3" xref="S3.SS1.p2.15.m10.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m10.1b"><apply id="S3.SS1.p2.15.m10.1.1.cmml" xref="S3.SS1.p2.15.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.15.m10.1.1.1.cmml" xref="S3.SS1.p2.15.m10.1.1">superscript</csymbol><ci id="S3.SS1.p2.15.m10.1.1.2.cmml" xref="S3.SS1.p2.15.m10.1.1.2">𝐶</ci><ci id="S3.SS1.p2.15.m10.1.1.3.cmml" xref="S3.SS1.p2.15.m10.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m10.1c">C^{l}</annotation></semantics></math> is the projection dimension, and these steps are summarised as below.</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="P_{\mathcal{C}}^{l}=\texttt{GELU}(\texttt{Proj}(E_{\mathcal{C}})),P_{\mathcal{C}}^{l}\in\mathbb{R}^{2L\times C^{l}}" display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.3.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><msubsup id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.3.2.2.cmml">P</mi><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.3.2.3.cmml">𝒞</mi><mi id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.cmml">l</mi></msubsup><mo id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3a.cmml">GELU</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3a.cmml">Proj</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">E</mi><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝒞</mi></msub><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.3a.cmml">,</mo><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml"><msubsup id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.cmml">P</mi><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.3.cmml">𝒞</mi><mi id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.3.cmml">l</mi></msubsup><mo id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.1.cmml">∈</mo><msup id="S3.E2.m1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml"><mi id="S3.E2.m1.2.2.2.2.3.2" xref="S3.E2.m1.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="S3.E2.m1.2.2.2.2.3.3" xref="S3.E2.m1.2.2.2.2.3.3.cmml"><mrow id="S3.E2.m1.2.2.2.2.3.3.2" xref="S3.E2.m1.2.2.2.2.3.3.2.cmml"><mn id="S3.E2.m1.2.2.2.2.3.3.2.2" xref="S3.E2.m1.2.2.2.2.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.3.3.2.1" xref="S3.E2.m1.2.2.2.2.3.3.2.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.3.3.2.3" xref="S3.E2.m1.2.2.2.2.3.3.2.3.cmml">L</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.2.2.2.2.3.3.1" xref="S3.E2.m1.2.2.2.2.3.3.1.cmml">×</mo><msup id="S3.E2.m1.2.2.2.2.3.3.3" xref="S3.E2.m1.2.2.2.2.3.3.3.cmml"><mi id="S3.E2.m1.2.2.2.2.3.3.3.2" xref="S3.E2.m1.2.2.2.2.3.3.3.2.cmml">C</mi><mi id="S3.E2.m1.2.2.2.2.3.3.3.3" xref="S3.E2.m1.2.2.2.2.3.3.3.3.cmml">l</mi></msup></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.3a.cmml" xref="S3.E2.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"></eq><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.2">𝑃</ci><ci id="S3.E2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3">𝒞</ci></apply><ci id="S3.E2.m1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.1.1.3a.cmml" xref="S3.E2.m1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">GELU</mtext></ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3">Proj</mtext></ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝐸</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝒞</ci></apply></apply></apply></apply><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><in id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1"></in><apply id="S3.E2.m1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2">superscript</csymbol><apply id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2">𝑃</ci><ci id="S3.E2.m1.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.3">𝒞</ci></apply><ci id="S3.E2.m1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3">𝑙</ci></apply><apply id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.2.2.3">superscript</csymbol><ci id="S3.E2.m1.2.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.2.2.3.2">ℝ</ci><apply id="S3.E2.m1.2.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.2.2.3.3"><times id="S3.E2.m1.2.2.2.2.3.3.1.cmml" xref="S3.E2.m1.2.2.2.2.3.3.1"></times><apply id="S3.E2.m1.2.2.2.2.3.3.2.cmml" xref="S3.E2.m1.2.2.2.2.3.3.2"><times id="S3.E2.m1.2.2.2.2.3.3.2.1.cmml" xref="S3.E2.m1.2.2.2.2.3.3.2.1"></times><cn type="integer" id="S3.E2.m1.2.2.2.2.3.3.2.2.cmml" xref="S3.E2.m1.2.2.2.2.3.3.2.2">2</cn><ci id="S3.E2.m1.2.2.2.2.3.3.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3.3.2.3">𝐿</ci></apply><apply id="S3.E2.m1.2.2.2.2.3.3.3.cmml" xref="S3.E2.m1.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.3.3.3.1.cmml" xref="S3.E2.m1.2.2.2.2.3.3.3">superscript</csymbol><ci id="S3.E2.m1.2.2.2.2.3.3.3.2.cmml" xref="S3.E2.m1.2.2.2.2.3.3.3.2">𝐶</ci><ci id="S3.E2.m1.2.2.2.2.3.3.3.3.cmml" xref="S3.E2.m1.2.2.2.2.3.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">P_{\mathcal{C}}^{l}=\texttt{GELU}(\texttt{Proj}(E_{\mathcal{C}})),P_{\mathcal{C}}^{l}\in\mathbb{R}^{2L\times C^{l}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.20" class="ltx_p">The projected feature, <math id="S3.SS1.p2.16.m1.1" class="ltx_Math" alttext="P_{\mathcal{C}}^{l}" display="inline"><semantics id="S3.SS1.p2.16.m1.1a"><msubsup id="S3.SS1.p2.16.m1.1.1" xref="S3.SS1.p2.16.m1.1.1.cmml"><mi id="S3.SS1.p2.16.m1.1.1.2.2" xref="S3.SS1.p2.16.m1.1.1.2.2.cmml">P</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.16.m1.1.1.2.3" xref="S3.SS1.p2.16.m1.1.1.2.3.cmml">𝒞</mi><mi id="S3.SS1.p2.16.m1.1.1.3" xref="S3.SS1.p2.16.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.16.m1.1b"><apply id="S3.SS1.p2.16.m1.1.1.cmml" xref="S3.SS1.p2.16.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.16.m1.1.1.1.cmml" xref="S3.SS1.p2.16.m1.1.1">superscript</csymbol><apply id="S3.SS1.p2.16.m1.1.1.2.cmml" xref="S3.SS1.p2.16.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.16.m1.1.1.2.1.cmml" xref="S3.SS1.p2.16.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.16.m1.1.1.2.2.cmml" xref="S3.SS1.p2.16.m1.1.1.2.2">𝑃</ci><ci id="S3.SS1.p2.16.m1.1.1.2.3.cmml" xref="S3.SS1.p2.16.m1.1.1.2.3">𝒞</ci></apply><ci id="S3.SS1.p2.16.m1.1.1.3.cmml" xref="S3.SS1.p2.16.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.16.m1.1c">P_{\mathcal{C}}^{l}</annotation></semantics></math>, is normalized using layer normalization (<span id="S3.SS1.p2.20.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">LN</span>) <cite class="ltx_cite ltx_citemacro_citep">(Ba, Kiros, and Hinton <a href="#bib.bib3" title="" class="ltx_ref">2016</a>)</cite>. Subsequently, Multi-Head Self-Attention (<math id="S3.SS1.p2.18.m3.1" class="ltx_math_unparsed" alttext="\texttt{MHSA}(.)" display="inline"><semantics id="S3.SS1.p2.18.m3.1a"><mrow id="S3.SS1.p2.18.m3.1b"><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p2.18.m3.1.1">MHSA</mtext><mrow id="S3.SS1.p2.18.m3.1.2"><mo stretchy="false" id="S3.SS1.p2.18.m3.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S3.SS1.p2.18.m3.1.2.2">.</mo><mo stretchy="false" id="S3.SS1.p2.18.m3.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p2.18.m3.1c">\texttt{MHSA}(.)</annotation></semantics></math>) <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al. <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite> is employed to capture DSI, <math id="S3.SS1.p2.19.m4.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS1.p2.19.m4.1a"><msubsup id="S3.SS1.p2.19.m4.1.1" xref="S3.SS1.p2.19.m4.1.1.cmml"><mi id="S3.SS1.p2.19.m4.1.1.2.2" xref="S3.SS1.p2.19.m4.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p2.19.m4.1.1.2.3" xref="S3.SS1.p2.19.m4.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS1.p2.19.m4.1.1.3" xref="S3.SS1.p2.19.m4.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.19.m4.1b"><apply id="S3.SS1.p2.19.m4.1.1.cmml" xref="S3.SS1.p2.19.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.19.m4.1.1.1.cmml" xref="S3.SS1.p2.19.m4.1.1">superscript</csymbol><apply id="S3.SS1.p2.19.m4.1.1.2.cmml" xref="S3.SS1.p2.19.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.19.m4.1.1.2.1.cmml" xref="S3.SS1.p2.19.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.19.m4.1.1.2.2.cmml" xref="S3.SS1.p2.19.m4.1.1.2.2">𝑂</ci><ci id="S3.SS1.p2.19.m4.1.1.2.3a.cmml" xref="S3.SS1.p2.19.m4.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p2.19.m4.1.1.2.3.cmml" xref="S3.SS1.p2.19.m4.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS1.p2.19.m4.1.1.3.cmml" xref="S3.SS1.p2.19.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.19.m4.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math>, from <math id="S3.SS1.p2.20.m5.1" class="ltx_Math" alttext="P_{\mathcal{C}}^{l}" display="inline"><semantics id="S3.SS1.p2.20.m5.1a"><msubsup id="S3.SS1.p2.20.m5.1.1" xref="S3.SS1.p2.20.m5.1.1.cmml"><mi id="S3.SS1.p2.20.m5.1.1.2.2" xref="S3.SS1.p2.20.m5.1.1.2.2.cmml">P</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.20.m5.1.1.2.3" xref="S3.SS1.p2.20.m5.1.1.2.3.cmml">𝒞</mi><mi id="S3.SS1.p2.20.m5.1.1.3" xref="S3.SS1.p2.20.m5.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.20.m5.1b"><apply id="S3.SS1.p2.20.m5.1.1.cmml" xref="S3.SS1.p2.20.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.20.m5.1.1.1.cmml" xref="S3.SS1.p2.20.m5.1.1">superscript</csymbol><apply id="S3.SS1.p2.20.m5.1.1.2.cmml" xref="S3.SS1.p2.20.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.20.m5.1.1.2.1.cmml" xref="S3.SS1.p2.20.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.20.m5.1.1.2.2.cmml" xref="S3.SS1.p2.20.m5.1.1.2.2">𝑃</ci><ci id="S3.SS1.p2.20.m5.1.1.2.3.cmml" xref="S3.SS1.p2.20.m5.1.1.2.3">𝒞</ci></apply><ci id="S3.SS1.p2.20.m5.1.1.3.cmml" xref="S3.SS1.p2.20.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.20.m5.1c">P_{\mathcal{C}}^{l}</annotation></semantics></math>. This step can be summarized as</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}=\texttt{MHSA}(\texttt{LN}(P_{\mathcal{C}}^{l})),O_{\texttt{DCE}}^{l}\in\mathbb{R}^{2L\times C^{l}}." display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1"><mrow id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.3.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><msubsup id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.E3.m1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3a.cmml">DCE</mtext><mi id="S3.E3.m1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.3.cmml">l</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E3.m1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.3a.cmml">MHSA</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">P</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">𝒞</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E3.m1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.2.2.cmml"><msubsup id="S3.E3.m1.1.1.1.1.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.E3.m1.1.1.1.1.2.2.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3a.cmml">DCE</mtext><mi id="S3.E3.m1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.3.cmml">l</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.2.2.1" xref="S3.E3.m1.1.1.1.1.2.2.1.cmml">∈</mo><msup id="S3.E3.m1.1.1.1.1.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.3.2" xref="S3.E3.m1.1.1.1.1.2.2.3.2.cmml">ℝ</mi><mrow id="S3.E3.m1.1.1.1.1.2.2.3.3" xref="S3.E3.m1.1.1.1.1.2.2.3.3.cmml"><mrow id="S3.E3.m1.1.1.1.1.2.2.3.3.2" xref="S3.E3.m1.1.1.1.1.2.2.3.3.2.cmml"><mn id="S3.E3.m1.1.1.1.1.2.2.3.3.2.2" xref="S3.E3.m1.1.1.1.1.2.2.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.2.2.3.3.2.1" xref="S3.E3.m1.1.1.1.1.2.2.3.3.2.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.1.2.2.3.3.2.3" xref="S3.E3.m1.1.1.1.1.2.2.3.3.2.3.cmml">L</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.1.1.1.1.2.2.3.3.1" xref="S3.E3.m1.1.1.1.1.2.2.3.3.1.cmml">×</mo><msup id="S3.E3.m1.1.1.1.1.2.2.3.3.3" xref="S3.E3.m1.1.1.1.1.2.2.3.3.3.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.3.3.3.2" xref="S3.E3.m1.1.1.1.1.2.2.3.3.3.2.cmml">C</mi><mi id="S3.E3.m1.1.1.1.1.2.2.3.3.3.3" xref="S3.E3.m1.1.1.1.1.2.2.3.3.3.3.cmml">l</mi></msup></mrow></msup></mrow></mrow><mo lspace="0em" id="S3.E3.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"></eq><apply id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2">𝑂</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.3a.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E3.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3">DCE</mtext></ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3">MHSA</mtext></ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3">LN</mtext></ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑃</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝒞</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2"><in id="S3.E3.m1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1"></in><apply id="S3.E3.m1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.2">𝑂</ci><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.3a.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E3.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2.3">DCE</mtext></ci></apply><ci id="S3.E3.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.3">𝑙</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2">ℝ</ci><apply id="S3.E3.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.3"><times id="S3.E3.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.3.1"></times><apply id="S3.E3.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.3.2"><times id="S3.E3.m1.1.1.1.1.2.2.3.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.3.2.1"></times><cn type="integer" id="S3.E3.m1.1.1.1.1.2.2.3.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.3.2.2">2</cn><ci id="S3.E3.m1.1.1.1.1.2.2.3.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.3.2.3">𝐿</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.3.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.3.3">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.3.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.3.3.2">𝐶</ci><ci id="S3.E3.m1.1.1.1.1.2.2.3.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">O_{\texttt{DCE}}^{l}=\texttt{MHSA}(\texttt{LN}(P_{\mathcal{C}}^{l})),O_{\texttt{DCE}}^{l}\in\mathbb{R}^{2L\times C^{l}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.23" class="ltx_p">Since the scene is consistent in both <math id="S3.SS1.p2.21.m1.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.SS1.p2.21.m1.1a"><msub id="S3.SS1.p2.21.m1.1.1" xref="S3.SS1.p2.21.m1.1.1.cmml"><mi id="S3.SS1.p2.21.m1.1.1.2" xref="S3.SS1.p2.21.m1.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p2.21.m1.1.1.3" xref="S3.SS1.p2.21.m1.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.21.m1.1b"><apply id="S3.SS1.p2.21.m1.1.1.cmml" xref="S3.SS1.p2.21.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.21.m1.1.1.1.cmml" xref="S3.SS1.p2.21.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.21.m1.1.1.2.cmml" xref="S3.SS1.p2.21.m1.1.1.2">𝐼</ci><ci id="S3.SS1.p2.21.m1.1.1.3a.cmml" xref="S3.SS1.p2.21.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p2.21.m1.1.1.3.cmml" xref="S3.SS1.p2.21.m1.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.21.m1.1c">I_{\texttt{d}}</annotation></semantics></math> and <math id="S3.SS1.p2.22.m2.1" class="ltx_Math" alttext="I_{\texttt{c}}" display="inline"><semantics id="S3.SS1.p2.22.m2.1a"><msub id="S3.SS1.p2.22.m2.1.1" xref="S3.SS1.p2.22.m2.1.1.cmml"><mi id="S3.SS1.p2.22.m2.1.1.2" xref="S3.SS1.p2.22.m2.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p2.22.m2.1.1.3" xref="S3.SS1.p2.22.m2.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.22.m2.1b"><apply id="S3.SS1.p2.22.m2.1.1.cmml" xref="S3.SS1.p2.22.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.22.m2.1.1.1.cmml" xref="S3.SS1.p2.22.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.22.m2.1.1.2.cmml" xref="S3.SS1.p2.22.m2.1.1.2">𝐼</ci><ci id="S3.SS1.p2.22.m2.1.1.3a.cmml" xref="S3.SS1.p2.22.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p2.22.m2.1.1.3.cmml" xref="S3.SS1.p2.22.m2.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.22.m2.1c">I_{\texttt{c}}</annotation></semantics></math>, the primary distinction between them is the degradation which is adeptly discerned through MHSA. This enables extraction of the necessary degradation-context from <math id="S3.SS1.p2.23.m3.1" class="ltx_Math" alttext="{\mathcal{C}}" display="inline"><semantics id="S3.SS1.p2.23.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.23.m3.1.1" xref="S3.SS1.p2.23.m3.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.23.m3.1b"><ci id="S3.SS1.p2.23.m3.1.1.cmml" xref="S3.SS1.p2.23.m3.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.23.m3.1c">{\mathcal{C}}</annotation></semantics></math> for judiciously guiding the network towards the objective of all-weather restoration. Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.1 Adverse weather restoration ‣ 2 Related Works ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows a detailed schematic of the DCE block, highlighting the above steps. Additional details about the MHSA module are given in the supplementary document.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.13" class="ltx_p">To visualize the extracted degradation-specifc information, we overlay the output of the DCE block (<math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msubsup id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2.2" xref="S3.SS1.p3.1.m1.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.1.m1.1.1.2.3" xref="S3.SS1.p3.1.m1.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">superscript</csymbol><apply id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2.2">𝑂</ci><ci id="S3.SS1.p3.1.m1.1.1.2.3a.cmml" xref="S3.SS1.p3.1.m1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.1.m1.1.1.2.3.cmml" xref="S3.SS1.p3.1.m1.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math>) for a clean-hazy and a clean-snowy context pair, respectively. This is illustrated in Fig. <a href="#S3.F3.sf1" title="In Figure 3 ‣ 3.1 Degradation Context Extraction ‣ 3 Proposed Methodology ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(a)</span></a> where activations are overlayed on the degraded image (<math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝐼</ci><ci id="S3.SS1.p3.2.m2.1.1.3a.cmml" xref="S3.SS1.p3.2.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">I_{\texttt{d}}</annotation></semantics></math>) and its corresponding clean image (<math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="I_{\texttt{c}}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><msub id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">𝐼</ci><ci id="S3.SS1.p3.3.m3.1.1.3a.cmml" xref="S3.SS1.p3.3.m3.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">I_{\texttt{c}}</annotation></semantics></math>). <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="A_{\texttt{d}}\in\mathbb{R}^{L\times C^{l}}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mrow id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><msub id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2.2" xref="S3.SS1.p3.4.m4.1.1.2.2.cmml">A</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.4.m4.1.1.2.3" xref="S3.SS1.p3.4.m4.1.1.2.3a.cmml">d</mtext></msub><mo id="S3.SS1.p3.4.m4.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.2" xref="S3.SS1.p3.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.4.m4.1.1.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.3.2" xref="S3.SS1.p3.4.m4.1.1.3.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.4.m4.1.1.3.3.1" xref="S3.SS1.p3.4.m4.1.1.3.3.1.cmml">×</mo><msup id="S3.SS1.p3.4.m4.1.1.3.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.3.3.2" xref="S3.SS1.p3.4.m4.1.1.3.3.3.2.cmml">C</mi><mi id="S3.SS1.p3.4.m4.1.1.3.3.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.3.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><in id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1"></in><apply id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.2.1.cmml" xref="S3.SS1.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2.2">𝐴</ci><ci id="S3.SS1.p3.4.m4.1.1.2.3a.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.4.m4.1.1.2.3.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3">d</mtext></ci></apply><apply id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS1.p3.4.m4.1.1.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3"><times id="S3.SS1.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.1"></times><ci id="S3.SS1.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.2">𝐿</ci><apply id="S3.SS1.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.3">superscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.3.2">𝐶</ci><ci id="S3.SS1.p3.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">A_{\texttt{d}}\in\mathbb{R}^{L\times C^{l}}</annotation></semantics></math> and <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="A_{\texttt{c}}\in\mathbb{R}^{L\times C^{l}}" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mrow id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml"><msub id="S3.SS1.p3.5.m5.1.1.2" xref="S3.SS1.p3.5.m5.1.1.2.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2.2" xref="S3.SS1.p3.5.m5.1.1.2.2.cmml">A</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.5.m5.1.1.2.3" xref="S3.SS1.p3.5.m5.1.1.2.3a.cmml">c</mtext></msub><mo id="S3.SS1.p3.5.m5.1.1.1" xref="S3.SS1.p3.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.5.m5.1.1.3" xref="S3.SS1.p3.5.m5.1.1.3.cmml"><mi id="S3.SS1.p3.5.m5.1.1.3.2" xref="S3.SS1.p3.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.5.m5.1.1.3.3" xref="S3.SS1.p3.5.m5.1.1.3.3.cmml"><mi id="S3.SS1.p3.5.m5.1.1.3.3.2" xref="S3.SS1.p3.5.m5.1.1.3.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.5.m5.1.1.3.3.1" xref="S3.SS1.p3.5.m5.1.1.3.3.1.cmml">×</mo><msup id="S3.SS1.p3.5.m5.1.1.3.3.3" xref="S3.SS1.p3.5.m5.1.1.3.3.3.cmml"><mi id="S3.SS1.p3.5.m5.1.1.3.3.3.2" xref="S3.SS1.p3.5.m5.1.1.3.3.3.2.cmml">C</mi><mi id="S3.SS1.p3.5.m5.1.1.3.3.3.3" xref="S3.SS1.p3.5.m5.1.1.3.3.3.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1"><in id="S3.SS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1.1"></in><apply id="S3.SS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.2.1.cmml" xref="S3.SS1.p3.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.2.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2.2">𝐴</ci><ci id="S3.SS1.p3.5.m5.1.1.2.3a.cmml" xref="S3.SS1.p3.5.m5.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.5.m5.1.1.2.3.cmml" xref="S3.SS1.p3.5.m5.1.1.2.3">c</mtext></ci></apply><apply id="S3.SS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.3.1.cmml" xref="S3.SS1.p3.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.3.2.cmml" xref="S3.SS1.p3.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS1.p3.5.m5.1.1.3.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3"><times id="S3.SS1.p3.5.m5.1.1.3.3.1.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.1"></times><ci id="S3.SS1.p3.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.2">𝐿</ci><apply id="S3.SS1.p3.5.m5.1.1.3.3.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.3.3.3.1.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.3">superscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.3.3.3.2.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.3.2">𝐶</ci><ci id="S3.SS1.p3.5.m5.1.1.3.3.3.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">A_{\texttt{c}}\in\mathbb{R}^{L\times C^{l}}</annotation></semantics></math> represent the DCE block activations obtained by splitting <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><msubsup id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml"><mi id="S3.SS1.p3.6.m6.1.1.2.2" xref="S3.SS1.p3.6.m6.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.6.m6.1.1.2.3" xref="S3.SS1.p3.6.m6.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS1.p3.6.m6.1.1.3" xref="S3.SS1.p3.6.m6.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">superscript</csymbol><apply id="S3.SS1.p3.6.m6.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.2.1.cmml" xref="S3.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p3.6.m6.1.1.2.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2.2">𝑂</ci><ci id="S3.SS1.p3.6.m6.1.1.2.3a.cmml" xref="S3.SS1.p3.6.m6.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.6.m6.1.1.2.3.cmml" xref="S3.SS1.p3.6.m6.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS1.p3.6.m6.1.1.3.cmml" xref="S3.SS1.p3.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math> for <math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><msub id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml"><mi id="S3.SS1.p3.7.m7.1.1.2" xref="S3.SS1.p3.7.m7.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.7.m7.1.1.3" xref="S3.SS1.p3.7.m7.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2">𝐼</ci><ci id="S3.SS1.p3.7.m7.1.1.3a.cmml" xref="S3.SS1.p3.7.m7.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.7.m7.1.1.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">I_{\texttt{d}}</annotation></semantics></math> and <math id="S3.SS1.p3.8.m8.1" class="ltx_Math" alttext="I_{\texttt{c}}" display="inline"><semantics id="S3.SS1.p3.8.m8.1a"><msub id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml"><mi id="S3.SS1.p3.8.m8.1.1.2" xref="S3.SS1.p3.8.m8.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.8.m8.1.1.3" xref="S3.SS1.p3.8.m8.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><apply id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p3.8.m8.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1.2">𝐼</ci><ci id="S3.SS1.p3.8.m8.1.1.3a.cmml" xref="S3.SS1.p3.8.m8.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.8.m8.1.1.3.cmml" xref="S3.SS1.p3.8.m8.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">I_{\texttt{c}}</annotation></semantics></math>, respectively. The figure shows that the DCE block captures DSI such as the spatially-varying characteristics of haze and sparseness of snow. Furthermore, to discern this information, the DCE block uses the clean image (<math id="S3.SS1.p3.9.m9.1" class="ltx_Math" alttext="I_{\texttt{c}}" display="inline"><semantics id="S3.SS1.p3.9.m9.1a"><msub id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml"><mi id="S3.SS1.p3.9.m9.1.1.2" xref="S3.SS1.p3.9.m9.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.9.m9.1.1.3" xref="S3.SS1.p3.9.m9.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><apply id="S3.SS1.p3.9.m9.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m9.1.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p3.9.m9.1.1.2.cmml" xref="S3.SS1.p3.9.m9.1.1.2">𝐼</ci><ci id="S3.SS1.p3.9.m9.1.1.3a.cmml" xref="S3.SS1.p3.9.m9.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.9.m9.1.1.3.cmml" xref="S3.SS1.p3.9.m9.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">I_{\texttt{c}}</annotation></semantics></math>) to identify and focus on degraded regions in <math id="S3.SS1.p3.10.m10.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.SS1.p3.10.m10.1a"><msub id="S3.SS1.p3.10.m10.1.1" xref="S3.SS1.p3.10.m10.1.1.cmml"><mi id="S3.SS1.p3.10.m10.1.1.2" xref="S3.SS1.p3.10.m10.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.10.m10.1.1.3" xref="S3.SS1.p3.10.m10.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m10.1b"><apply id="S3.SS1.p3.10.m10.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.10.m10.1.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p3.10.m10.1.1.2.cmml" xref="S3.SS1.p3.10.m10.1.1.2">𝐼</ci><ci id="S3.SS1.p3.10.m10.1.1.3a.cmml" xref="S3.SS1.p3.10.m10.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.10.m10.1.1.3.cmml" xref="S3.SS1.p3.10.m10.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m10.1c">I_{\texttt{d}}</annotation></semantics></math>, evident from attention at similar locations in both <math id="S3.SS1.p3.11.m11.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.SS1.p3.11.m11.1a"><msub id="S3.SS1.p3.11.m11.1.1" xref="S3.SS1.p3.11.m11.1.1.cmml"><mi id="S3.SS1.p3.11.m11.1.1.2" xref="S3.SS1.p3.11.m11.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.11.m11.1.1.3" xref="S3.SS1.p3.11.m11.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m11.1b"><apply id="S3.SS1.p3.11.m11.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.11.m11.1.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p3.11.m11.1.1.2.cmml" xref="S3.SS1.p3.11.m11.1.1.2">𝐼</ci><ci id="S3.SS1.p3.11.m11.1.1.3a.cmml" xref="S3.SS1.p3.11.m11.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.11.m11.1.1.3.cmml" xref="S3.SS1.p3.11.m11.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m11.1c">I_{\texttt{d}}</annotation></semantics></math> and <math id="S3.SS1.p3.12.m12.1" class="ltx_Math" alttext="I_{\texttt{c}}" display="inline"><semantics id="S3.SS1.p3.12.m12.1a"><msub id="S3.SS1.p3.12.m12.1.1" xref="S3.SS1.p3.12.m12.1.1.cmml"><mi id="S3.SS1.p3.12.m12.1.1.2" xref="S3.SS1.p3.12.m12.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.12.m12.1.1.3" xref="S3.SS1.p3.12.m12.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.12.m12.1b"><apply id="S3.SS1.p3.12.m12.1.1.cmml" xref="S3.SS1.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m12.1.1.1.cmml" xref="S3.SS1.p3.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p3.12.m12.1.1.2.cmml" xref="S3.SS1.p3.12.m12.1.1.2">𝐼</ci><ci id="S3.SS1.p3.12.m12.1.1.3a.cmml" xref="S3.SS1.p3.12.m12.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.12.m12.1.1.3.cmml" xref="S3.SS1.p3.12.m12.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.12.m12.1c">I_{\texttt{c}}</annotation></semantics></math>. Additionally, Fig. <a href="#S3.F3.sf2" title="In Figure 3 ‣ 3.1 Degradation Context Extraction ‣ 3 Proposed Methodology ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(b)</span></a> provides a t-SNE plot of the DCE block output (<math id="S3.SS1.p3.13.m13.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS1.p3.13.m13.1a"><msubsup id="S3.SS1.p3.13.m13.1.1" xref="S3.SS1.p3.13.m13.1.1.cmml"><mi id="S3.SS1.p3.13.m13.1.1.2.2" xref="S3.SS1.p3.13.m13.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS1.p3.13.m13.1.1.2.3" xref="S3.SS1.p3.13.m13.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS1.p3.13.m13.1.1.3" xref="S3.SS1.p3.13.m13.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.13.m13.1b"><apply id="S3.SS1.p3.13.m13.1.1.cmml" xref="S3.SS1.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.13.m13.1.1.1.cmml" xref="S3.SS1.p3.13.m13.1.1">superscript</csymbol><apply id="S3.SS1.p3.13.m13.1.1.2.cmml" xref="S3.SS1.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.13.m13.1.1.2.1.cmml" xref="S3.SS1.p3.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p3.13.m13.1.1.2.2.cmml" xref="S3.SS1.p3.13.m13.1.1.2.2">𝑂</ci><ci id="S3.SS1.p3.13.m13.1.1.2.3a.cmml" xref="S3.SS1.p3.13.m13.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS1.p3.13.m13.1.1.2.3.cmml" xref="S3.SS1.p3.13.m13.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS1.p3.13.m13.1.1.3.cmml" xref="S3.SS1.p3.13.m13.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.13.m13.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math>), showing that DSI is clustered closely for the same type of degradation but is separated for different degradations.</p>
</div>
<figure id="S3.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<table id="S3.F3.sf1.12" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.F3.sf1.4.4" class="ltx_tr">
<td id="S3.F3.sf1.4.4.5" class="ltx_td ltx_nopad_l ltx_nopad_r" style="padding-left:1.0pt;padding-right:1.0pt;"></td>
<th id="S3.F3.sf1.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;"><math id="S3.F3.sf1.1.1.1.m1.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.F3.sf1.1.1.1.m1.1a"><msub id="S3.F3.sf1.1.1.1.m1.1.1" xref="S3.F3.sf1.1.1.1.m1.1.1.cmml"><mi id="S3.F3.sf1.1.1.1.m1.1.1.2" xref="S3.F3.sf1.1.1.1.m1.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.F3.sf1.1.1.1.m1.1.1.3" xref="S3.F3.sf1.1.1.1.m1.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.1.1.1.m1.1b"><apply id="S3.F3.sf1.1.1.1.m1.1.1.cmml" xref="S3.F3.sf1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F3.sf1.1.1.1.m1.1.1.1.cmml" xref="S3.F3.sf1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.F3.sf1.1.1.1.m1.1.1.2.cmml" xref="S3.F3.sf1.1.1.1.m1.1.1.2">𝐼</ci><ci id="S3.F3.sf1.1.1.1.m1.1.1.3a.cmml" xref="S3.F3.sf1.1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F3.sf1.1.1.1.m1.1.1.3.cmml" xref="S3.F3.sf1.1.1.1.m1.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.1.1.1.m1.1c">I_{\texttt{d}}</annotation></semantics></math></th>
<th id="S3.F3.sf1.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;"><math id="S3.F3.sf1.2.2.2.m1.1" class="ltx_Math" alttext="I_{\texttt{c}}" display="inline"><semantics id="S3.F3.sf1.2.2.2.m1.1a"><msub id="S3.F3.sf1.2.2.2.m1.1.1" xref="S3.F3.sf1.2.2.2.m1.1.1.cmml"><mi id="S3.F3.sf1.2.2.2.m1.1.1.2" xref="S3.F3.sf1.2.2.2.m1.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.F3.sf1.2.2.2.m1.1.1.3" xref="S3.F3.sf1.2.2.2.m1.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.2.2.2.m1.1b"><apply id="S3.F3.sf1.2.2.2.m1.1.1.cmml" xref="S3.F3.sf1.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.F3.sf1.2.2.2.m1.1.1.1.cmml" xref="S3.F3.sf1.2.2.2.m1.1.1">subscript</csymbol><ci id="S3.F3.sf1.2.2.2.m1.1.1.2.cmml" xref="S3.F3.sf1.2.2.2.m1.1.1.2">𝐼</ci><ci id="S3.F3.sf1.2.2.2.m1.1.1.3a.cmml" xref="S3.F3.sf1.2.2.2.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F3.sf1.2.2.2.m1.1.1.3.cmml" xref="S3.F3.sf1.2.2.2.m1.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.2.2.2.m1.1c">I_{\texttt{c}}</annotation></semantics></math></th>
<th id="S3.F3.sf1.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;"><math id="S3.F3.sf1.3.3.3.m1.1" class="ltx_Math" alttext="I_{\texttt{d}}+A_{\texttt{d}}" display="inline"><semantics id="S3.F3.sf1.3.3.3.m1.1a"><mrow id="S3.F3.sf1.3.3.3.m1.1.1" xref="S3.F3.sf1.3.3.3.m1.1.1.cmml"><msub id="S3.F3.sf1.3.3.3.m1.1.1.2" xref="S3.F3.sf1.3.3.3.m1.1.1.2.cmml"><mi id="S3.F3.sf1.3.3.3.m1.1.1.2.2" xref="S3.F3.sf1.3.3.3.m1.1.1.2.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.F3.sf1.3.3.3.m1.1.1.2.3" xref="S3.F3.sf1.3.3.3.m1.1.1.2.3a.cmml">d</mtext></msub><mo id="S3.F3.sf1.3.3.3.m1.1.1.1" xref="S3.F3.sf1.3.3.3.m1.1.1.1.cmml">+</mo><msub id="S3.F3.sf1.3.3.3.m1.1.1.3" xref="S3.F3.sf1.3.3.3.m1.1.1.3.cmml"><mi id="S3.F3.sf1.3.3.3.m1.1.1.3.2" xref="S3.F3.sf1.3.3.3.m1.1.1.3.2.cmml">A</mi><mtext class="ltx_mathvariant_monospace" id="S3.F3.sf1.3.3.3.m1.1.1.3.3" xref="S3.F3.sf1.3.3.3.m1.1.1.3.3a.cmml">d</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.3.3.3.m1.1b"><apply id="S3.F3.sf1.3.3.3.m1.1.1.cmml" xref="S3.F3.sf1.3.3.3.m1.1.1"><plus id="S3.F3.sf1.3.3.3.m1.1.1.1.cmml" xref="S3.F3.sf1.3.3.3.m1.1.1.1"></plus><apply id="S3.F3.sf1.3.3.3.m1.1.1.2.cmml" xref="S3.F3.sf1.3.3.3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.F3.sf1.3.3.3.m1.1.1.2.1.cmml" xref="S3.F3.sf1.3.3.3.m1.1.1.2">subscript</csymbol><ci id="S3.F3.sf1.3.3.3.m1.1.1.2.2.cmml" xref="S3.F3.sf1.3.3.3.m1.1.1.2.2">𝐼</ci><ci id="S3.F3.sf1.3.3.3.m1.1.1.2.3a.cmml" xref="S3.F3.sf1.3.3.3.m1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F3.sf1.3.3.3.m1.1.1.2.3.cmml" xref="S3.F3.sf1.3.3.3.m1.1.1.2.3">d</mtext></ci></apply><apply id="S3.F3.sf1.3.3.3.m1.1.1.3.cmml" xref="S3.F3.sf1.3.3.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F3.sf1.3.3.3.m1.1.1.3.1.cmml" xref="S3.F3.sf1.3.3.3.m1.1.1.3">subscript</csymbol><ci id="S3.F3.sf1.3.3.3.m1.1.1.3.2.cmml" xref="S3.F3.sf1.3.3.3.m1.1.1.3.2">𝐴</ci><ci id="S3.F3.sf1.3.3.3.m1.1.1.3.3a.cmml" xref="S3.F3.sf1.3.3.3.m1.1.1.3.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F3.sf1.3.3.3.m1.1.1.3.3.cmml" xref="S3.F3.sf1.3.3.3.m1.1.1.3.3">d</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.3.3.3.m1.1c">I_{\texttt{d}}+A_{\texttt{d}}</annotation></semantics></math></th>
<th id="S3.F3.sf1.4.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;"><math id="S3.F3.sf1.4.4.4.m1.1" class="ltx_Math" alttext="I_{\texttt{c}}+A_{\texttt{c}}" display="inline"><semantics id="S3.F3.sf1.4.4.4.m1.1a"><mrow id="S3.F3.sf1.4.4.4.m1.1.1" xref="S3.F3.sf1.4.4.4.m1.1.1.cmml"><msub id="S3.F3.sf1.4.4.4.m1.1.1.2" xref="S3.F3.sf1.4.4.4.m1.1.1.2.cmml"><mi id="S3.F3.sf1.4.4.4.m1.1.1.2.2" xref="S3.F3.sf1.4.4.4.m1.1.1.2.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.F3.sf1.4.4.4.m1.1.1.2.3" xref="S3.F3.sf1.4.4.4.m1.1.1.2.3a.cmml">c</mtext></msub><mo id="S3.F3.sf1.4.4.4.m1.1.1.1" xref="S3.F3.sf1.4.4.4.m1.1.1.1.cmml">+</mo><msub id="S3.F3.sf1.4.4.4.m1.1.1.3" xref="S3.F3.sf1.4.4.4.m1.1.1.3.cmml"><mi id="S3.F3.sf1.4.4.4.m1.1.1.3.2" xref="S3.F3.sf1.4.4.4.m1.1.1.3.2.cmml">A</mi><mtext class="ltx_mathvariant_monospace" id="S3.F3.sf1.4.4.4.m1.1.1.3.3" xref="S3.F3.sf1.4.4.4.m1.1.1.3.3a.cmml">c</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.4.4.4.m1.1b"><apply id="S3.F3.sf1.4.4.4.m1.1.1.cmml" xref="S3.F3.sf1.4.4.4.m1.1.1"><plus id="S3.F3.sf1.4.4.4.m1.1.1.1.cmml" xref="S3.F3.sf1.4.4.4.m1.1.1.1"></plus><apply id="S3.F3.sf1.4.4.4.m1.1.1.2.cmml" xref="S3.F3.sf1.4.4.4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.F3.sf1.4.4.4.m1.1.1.2.1.cmml" xref="S3.F3.sf1.4.4.4.m1.1.1.2">subscript</csymbol><ci id="S3.F3.sf1.4.4.4.m1.1.1.2.2.cmml" xref="S3.F3.sf1.4.4.4.m1.1.1.2.2">𝐼</ci><ci id="S3.F3.sf1.4.4.4.m1.1.1.2.3a.cmml" xref="S3.F3.sf1.4.4.4.m1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F3.sf1.4.4.4.m1.1.1.2.3.cmml" xref="S3.F3.sf1.4.4.4.m1.1.1.2.3">c</mtext></ci></apply><apply id="S3.F3.sf1.4.4.4.m1.1.1.3.cmml" xref="S3.F3.sf1.4.4.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F3.sf1.4.4.4.m1.1.1.3.1.cmml" xref="S3.F3.sf1.4.4.4.m1.1.1.3">subscript</csymbol><ci id="S3.F3.sf1.4.4.4.m1.1.1.3.2.cmml" xref="S3.F3.sf1.4.4.4.m1.1.1.3.2">𝐴</ci><ci id="S3.F3.sf1.4.4.4.m1.1.1.3.3a.cmml" xref="S3.F3.sf1.4.4.4.m1.1.1.3.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F3.sf1.4.4.4.m1.1.1.3.3.cmml" xref="S3.F3.sf1.4.4.4.m1.1.1.3.3">c</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.4.4.4.m1.1c">I_{\texttt{c}}+A_{\texttt{c}}</annotation></semantics></math></th>
</tr>
<tr id="S3.F3.sf1.8.8" class="ltx_tr">
<th id="S3.F3.sf1.8.8.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:1.0pt;padding-right:1.0pt;">
<div id="S3.F3.sf1.8.8.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:21.4pt;vertical-align:6.8pt;"><span class="ltx_transformed_inner" style="width:21.4pt;transform:translate(-7.28pt,-14.11pt) rotate(-90deg) ;">
<p id="S3.F3.sf1.8.8.5.1.1" class="ltx_p">Haze</p>
</span></div>
</th>
<td id="S3.F3.sf1.5.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/figures/feature_vis/dce_final/haze_con_degr.jpg" id="S3.F3.sf1.5.5.1.g1" class="ltx_graphics ltx_img_landscape" width="136" height="44" alt="Refer to caption"></td>
<td id="S3.F3.sf1.6.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/figures/feature_vis/dce_final/haze_con_clean.jpg" id="S3.F3.sf1.6.6.2.g1" class="ltx_graphics ltx_img_landscape" width="136" height="44" alt="Refer to caption"></td>
<td id="S3.F3.sf1.7.7.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/figures/feature_vis/dce_final/3dce_37degrad.jpg" id="S3.F3.sf1.7.7.3.g1" class="ltx_graphics ltx_img_landscape" width="136" height="44" alt="Refer to caption"></td>
<td id="S3.F3.sf1.8.8.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/figures/feature_vis/dce_final/3dce_37clean.jpg" id="S3.F3.sf1.8.8.4.g1" class="ltx_graphics ltx_img_landscape" width="136" height="44" alt="Refer to caption"></td>
</tr>
<tr id="S3.F3.sf1.12.12" class="ltx_tr">
<th id="S3.F3.sf1.12.12.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:1.0pt;padding-right:1.0pt;">
<div id="S3.F3.sf1.12.12.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:23.1pt;vertical-align:6.8pt;"><span class="ltx_transformed_inner" style="width:23.1pt;transform:translate(-8.11pt,-14.94pt) rotate(-90deg) ;">
<p id="S3.F3.sf1.12.12.5.1.1" class="ltx_p">Snow</p>
</span></div>
</th>
<td id="S3.F3.sf1.9.9.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/figures/feature_vis/dce_final/snow_con_degr2_new.jpg" id="S3.F3.sf1.9.9.1.g1" class="ltx_graphics ltx_img_landscape" width="136" height="44" alt="Refer to caption"></td>
<td id="S3.F3.sf1.10.10.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/figures/feature_vis/dce_final/snow_con_clean2.jpg" id="S3.F3.sf1.10.10.2.g1" class="ltx_graphics ltx_img_landscape" width="136" height="44" alt="Refer to caption"></td>
<td id="S3.F3.sf1.11.11.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/figures/feature_vis/dce_final/3dce_89degrad.jpg" id="S3.F3.sf1.11.11.3.g1" class="ltx_graphics ltx_img_landscape" width="136" height="44" alt="Refer to caption"></td>
<td id="S3.F3.sf1.12.12.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/figures/feature_vis/dce_final/3dce_clean.jpg" id="S3.F3.sf1.12.12.4.g1" class="ltx_graphics ltx_img_landscape" width="136" height="44" alt="Refer to caption"></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>DCE block activations <math id="S3.F3.sf1.18.m1.1" class="ltx_Math" alttext="A_{\texttt{d}}" display="inline"><semantics id="S3.F3.sf1.18.m1.1b"><msub id="S3.F3.sf1.18.m1.1.1" xref="S3.F3.sf1.18.m1.1.1.cmml"><mi id="S3.F3.sf1.18.m1.1.1.2" xref="S3.F3.sf1.18.m1.1.1.2.cmml">A</mi><mtext class="ltx_mathvariant_monospace" id="S3.F3.sf1.18.m1.1.1.3" xref="S3.F3.sf1.18.m1.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.18.m1.1c"><apply id="S3.F3.sf1.18.m1.1.1.cmml" xref="S3.F3.sf1.18.m1.1.1"><csymbol cd="ambiguous" id="S3.F3.sf1.18.m1.1.1.1.cmml" xref="S3.F3.sf1.18.m1.1.1">subscript</csymbol><ci id="S3.F3.sf1.18.m1.1.1.2.cmml" xref="S3.F3.sf1.18.m1.1.1.2">𝐴</ci><ci id="S3.F3.sf1.18.m1.1.1.3a.cmml" xref="S3.F3.sf1.18.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F3.sf1.18.m1.1.1.3.cmml" xref="S3.F3.sf1.18.m1.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.18.m1.1d">A_{\texttt{d}}</annotation></semantics></math> and <math id="S3.F3.sf1.19.m2.1" class="ltx_Math" alttext="A_{\texttt{c}}" display="inline"><semantics id="S3.F3.sf1.19.m2.1b"><msub id="S3.F3.sf1.19.m2.1.1" xref="S3.F3.sf1.19.m2.1.1.cmml"><mi id="S3.F3.sf1.19.m2.1.1.2" xref="S3.F3.sf1.19.m2.1.1.2.cmml">A</mi><mtext class="ltx_mathvariant_monospace" id="S3.F3.sf1.19.m2.1.1.3" xref="S3.F3.sf1.19.m2.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.19.m2.1c"><apply id="S3.F3.sf1.19.m2.1.1.cmml" xref="S3.F3.sf1.19.m2.1.1"><csymbol cd="ambiguous" id="S3.F3.sf1.19.m2.1.1.1.cmml" xref="S3.F3.sf1.19.m2.1.1">subscript</csymbol><ci id="S3.F3.sf1.19.m2.1.1.2.cmml" xref="S3.F3.sf1.19.m2.1.1.2">𝐴</ci><ci id="S3.F3.sf1.19.m2.1.1.3a.cmml" xref="S3.F3.sf1.19.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F3.sf1.19.m2.1.1.3.cmml" xref="S3.F3.sf1.19.m2.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.19.m2.1d">A_{\texttt{c}}</annotation></semantics></math> overlayed (<math id="S3.F3.sf1.20.m3.1" class="ltx_Math" alttext="+" display="inline"><semantics id="S3.F3.sf1.20.m3.1b"><mo id="S3.F3.sf1.20.m3.1.1" xref="S3.F3.sf1.20.m3.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.20.m3.1c"><plus id="S3.F3.sf1.20.m3.1.1.cmml" xref="S3.F3.sf1.20.m3.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.20.m3.1d">+</annotation></semantics></math>) on <math id="S3.F3.sf1.21.m4.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S3.F3.sf1.21.m4.1b"><msub id="S3.F3.sf1.21.m4.1.1" xref="S3.F3.sf1.21.m4.1.1.cmml"><mi id="S3.F3.sf1.21.m4.1.1.2" xref="S3.F3.sf1.21.m4.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.F3.sf1.21.m4.1.1.3" xref="S3.F3.sf1.21.m4.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.21.m4.1c"><apply id="S3.F3.sf1.21.m4.1.1.cmml" xref="S3.F3.sf1.21.m4.1.1"><csymbol cd="ambiguous" id="S3.F3.sf1.21.m4.1.1.1.cmml" xref="S3.F3.sf1.21.m4.1.1">subscript</csymbol><ci id="S3.F3.sf1.21.m4.1.1.2.cmml" xref="S3.F3.sf1.21.m4.1.1.2">𝐼</ci><ci id="S3.F3.sf1.21.m4.1.1.3a.cmml" xref="S3.F3.sf1.21.m4.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F3.sf1.21.m4.1.1.3.cmml" xref="S3.F3.sf1.21.m4.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.21.m4.1d">I_{\texttt{d}}</annotation></semantics></math> and <math id="S3.F3.sf1.22.m5.1" class="ltx_Math" alttext="I_{\texttt{c}}" display="inline"><semantics id="S3.F3.sf1.22.m5.1b"><msub id="S3.F3.sf1.22.m5.1.1" xref="S3.F3.sf1.22.m5.1.1.cmml"><mi id="S3.F3.sf1.22.m5.1.1.2" xref="S3.F3.sf1.22.m5.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.F3.sf1.22.m5.1.1.3" xref="S3.F3.sf1.22.m5.1.1.3a.cmml">c</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.22.m5.1c"><apply id="S3.F3.sf1.22.m5.1.1.cmml" xref="S3.F3.sf1.22.m5.1.1"><csymbol cd="ambiguous" id="S3.F3.sf1.22.m5.1.1.1.cmml" xref="S3.F3.sf1.22.m5.1.1">subscript</csymbol><ci id="S3.F3.sf1.22.m5.1.1.2.cmml" xref="S3.F3.sf1.22.m5.1.1.2">𝐼</ci><ci id="S3.F3.sf1.22.m5.1.1.3a.cmml" xref="S3.F3.sf1.22.m5.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F3.sf1.22.m5.1.1.3.cmml" xref="S3.F3.sf1.22.m5.1.1.3">c</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.22.m5.1d">I_{\texttt{c}}</annotation></semantics></math>, respectively, of the context pair. Yellow-High, Blue-Low</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<p id="S3.F3.sf2.1" class="ltx_p ltx_align_center"><span id="S3.F3.sf2.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;"><img src="/html/2409.00263/assets/x2.png" id="S3.F3.sf2.1.1.g1" class="ltx_graphics ltx_img_landscape" width="207" height="36" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>t-SNE plot of DCE block outputs (<math id="S3.F3.sf2.3.m1.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.F3.sf2.3.m1.1b"><msubsup id="S3.F3.sf2.3.m1.1.1" xref="S3.F3.sf2.3.m1.1.1.cmml"><mi id="S3.F3.sf2.3.m1.1.1.2.2" xref="S3.F3.sf2.3.m1.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.F3.sf2.3.m1.1.1.2.3" xref="S3.F3.sf2.3.m1.1.1.2.3a.cmml">DCE</mtext><mi id="S3.F3.sf2.3.m1.1.1.3" xref="S3.F3.sf2.3.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.F3.sf2.3.m1.1c"><apply id="S3.F3.sf2.3.m1.1.1.cmml" xref="S3.F3.sf2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.F3.sf2.3.m1.1.1.1.cmml" xref="S3.F3.sf2.3.m1.1.1">superscript</csymbol><apply id="S3.F3.sf2.3.m1.1.1.2.cmml" xref="S3.F3.sf2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.F3.sf2.3.m1.1.1.2.1.cmml" xref="S3.F3.sf2.3.m1.1.1">subscript</csymbol><ci id="S3.F3.sf2.3.m1.1.1.2.2.cmml" xref="S3.F3.sf2.3.m1.1.1.2.2">𝑂</ci><ci id="S3.F3.sf2.3.m1.1.1.2.3a.cmml" xref="S3.F3.sf2.3.m1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F3.sf2.3.m1.1.1.2.3.cmml" xref="S3.F3.sf2.3.m1.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.F3.sf2.3.m1.1.1.3.cmml" xref="S3.F3.sf2.3.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf2.3.m1.1d">O_{\texttt{DCE}}^{l}</annotation></semantics></math>) for hazy, rainy and snowy context pairs.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Analysis of DCE block outputs.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Context Fusion</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.13" class="ltx_p">At each level <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">l</annotation></semantics></math>, the obtained degradation-context, <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msubsup id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p1.2.m2.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">𝑂</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3a.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math>, needs to be fused with the corresponding decoder features, <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="F^{l}\in\mathbb{R}^{K^{l}\times H^{l}\times W^{l}}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><msup id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">F</mi><mi id="S3.SS2.p1.3.m3.1.1.2.3" xref="S3.SS2.p1.3.m3.1.1.2.3.cmml">l</mi></msup><mo id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3.2" xref="S3.SS2.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.3.m3.1.1.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.cmml"><msup id="S3.SS2.p1.3.m3.1.1.3.3.2" xref="S3.SS2.p1.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3.3.2.2" xref="S3.SS2.p1.3.m3.1.1.3.3.2.2.cmml">K</mi><mi id="S3.SS2.p1.3.m3.1.1.3.3.2.3" xref="S3.SS2.p1.3.m3.1.1.3.3.2.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.3.m3.1.1.3.3.1" xref="S3.SS2.p1.3.m3.1.1.3.3.1.cmml">×</mo><msup id="S3.SS2.p1.3.m3.1.1.3.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3.3.3.2" xref="S3.SS2.p1.3.m3.1.1.3.3.3.2.cmml">H</mi><mi id="S3.SS2.p1.3.m3.1.1.3.3.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.3.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.3.m3.1.1.3.3.1a" xref="S3.SS2.p1.3.m3.1.1.3.3.1.cmml">×</mo><msup id="S3.SS2.p1.3.m3.1.1.3.3.4" xref="S3.SS2.p1.3.m3.1.1.3.3.4.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3.3.4.2" xref="S3.SS2.p1.3.m3.1.1.3.3.4.2.cmml">W</mi><mi id="S3.SS2.p1.3.m3.1.1.3.3.4.3" xref="S3.SS2.p1.3.m3.1.1.3.3.4.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><in id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></in><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">𝐹</ci><ci id="S3.SS2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3">𝑙</ci></apply><apply id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3"><times id="S3.SS2.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.1"></times><apply id="S3.SS2.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.2">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.2.2">𝐾</ci><ci id="S3.SS2.p1.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.2.3">𝑙</ci></apply><apply id="S3.SS2.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.3">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.3.2">𝐻</ci><ci id="S3.SS2.p1.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.3.3">𝑙</ci></apply><apply id="S3.SS2.p1.3.m3.1.1.3.3.4.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.3.3.4.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.4">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.3.3.4.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.4.2">𝑊</ci><ci id="S3.SS2.p1.3.m3.1.1.3.3.4.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.4.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">F^{l}\in\mathbb{R}^{K^{l}\times H^{l}\times W^{l}}</annotation></semantics></math>, from Restormer. Here <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="H^{l}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msup id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">H</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝐻</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">H^{l}</annotation></semantics></math> and <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="W^{l}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><msup id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">W</mi><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝑊</ci><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">W^{l}</annotation></semantics></math> are the spatial resolution of the feature map, and <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="K^{l}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msup id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">K</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝐾</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">K^{l}</annotation></semantics></math> is channel dimension. Fusion is achieved with the help of the Context Fusion (CF) blocks that utilize Multi-Head Cross Attention (<span id="S3.SS2.p1.13.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">MHCA(.)</span>) <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al. <a href="#bib.bib36" title="" class="ltx_ref">2017</a>)</cite> to integrate information from <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><msubsup id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1.2.2" xref="S3.SS2.p1.8.m8.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p1.8.m8.1.1.2.3" xref="S3.SS2.p1.8.m8.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">superscript</csymbol><apply id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.2.1.cmml" xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2.2">𝑂</ci><ci id="S3.SS2.p1.8.m8.1.1.2.3a.cmml" xref="S3.SS2.p1.8.m8.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p1.8.m8.1.1.2.3.cmml" xref="S3.SS2.p1.8.m8.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math> and <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><msup id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><mi id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml">F</mi><mi id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">superscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2">𝐹</ci><ci id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">F^{l}</annotation></semantics></math>. The cross-attention mechanism is a key ingredient in the CF module as we want <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><msup id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><mi id="S3.SS2.p1.10.m10.1.1.2" xref="S3.SS2.p1.10.m10.1.1.2.cmml">F</mi><mi id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">superscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2">𝐹</ci><ci id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">F^{l}</annotation></semantics></math> to be enhanced by the degradation information contained in <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><msubsup id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml"><mi id="S3.SS2.p1.11.m11.1.1.2.2" xref="S3.SS2.p1.11.m11.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p1.11.m11.1.1.2.3" xref="S3.SS2.p1.11.m11.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p1.11.m11.1.1.3" xref="S3.SS2.p1.11.m11.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><apply id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">superscript</csymbol><apply id="S3.SS2.p1.11.m11.1.1.2.cmml" xref="S3.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.2.1.cmml" xref="S3.SS2.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.p1.11.m11.1.1.2.2.cmml" xref="S3.SS2.p1.11.m11.1.1.2.2">𝑂</ci><ci id="S3.SS2.p1.11.m11.1.1.2.3a.cmml" xref="S3.SS2.p1.11.m11.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p1.11.m11.1.1.2.3.cmml" xref="S3.SS2.p1.11.m11.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p1.11.m11.1.1.3.cmml" xref="S3.SS2.p1.11.m11.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math>. We achieve this by treating <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><msup id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml"><mi id="S3.SS2.p1.12.m12.1.1.2" xref="S3.SS2.p1.12.m12.1.1.2.cmml">F</mi><mi id="S3.SS2.p1.12.m12.1.1.3" xref="S3.SS2.p1.12.m12.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><apply id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">superscript</csymbol><ci id="S3.SS2.p1.12.m12.1.1.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2">𝐹</ci><ci id="S3.SS2.p1.12.m12.1.1.3.cmml" xref="S3.SS2.p1.12.m12.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">F^{l}</annotation></semantics></math> as the query and matching it with the key and value computed from <math id="S3.SS2.p1.13.m13.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p1.13.m13.1a"><msubsup id="S3.SS2.p1.13.m13.1.1" xref="S3.SS2.p1.13.m13.1.1.cmml"><mi id="S3.SS2.p1.13.m13.1.1.2.2" xref="S3.SS2.p1.13.m13.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p1.13.m13.1.1.2.3" xref="S3.SS2.p1.13.m13.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p1.13.m13.1.1.3" xref="S3.SS2.p1.13.m13.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m13.1b"><apply id="S3.SS2.p1.13.m13.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m13.1.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1">superscript</csymbol><apply id="S3.SS2.p1.13.m13.1.1.2.cmml" xref="S3.SS2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m13.1.1.2.1.cmml" xref="S3.SS2.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS2.p1.13.m13.1.1.2.2.cmml" xref="S3.SS2.p1.13.m13.1.1.2.2">𝑂</ci><ci id="S3.SS2.p1.13.m13.1.1.2.3a.cmml" xref="S3.SS2.p1.13.m13.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p1.13.m13.1.1.2.3.cmml" xref="S3.SS2.p1.13.m13.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p1.13.m13.1.1.3.cmml" xref="S3.SS2.p1.13.m13.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m13.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.4" class="ltx_p">The CF module which is illustrated in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.1 Adverse weather restoration ‣ 2 Related Works ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> is next described in detail. Prior to MHCA, <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msup id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">F</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐹</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">F^{l}</annotation></semantics></math> is projected to the same channel dimension (<math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="C^{l}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msup id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">C</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐶</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">C^{l}</annotation></semantics></math>) as <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msubsup id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2.2" xref="S3.SS2.p2.3.m3.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.3.m3.1.1.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.3.m3.1.1.2.3a.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.3.m3.1.1.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math> using <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="1\times 1" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mn id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.4.m4.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.cmml">×</mo><mn id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><times id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"></times><cn type="integer" id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">1</cn><cn type="integer" id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">1\times 1</annotation></semantics></math> convolution as</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj}}=\texttt{GELU}(\texttt{Conv}_{1\times 1}(F^{l})),F^{l}_{\texttt{Proj}}\in\mathbb{R}^{C^{l}\times H^{l}\times W^{l}}," display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1"><mrow id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.3.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><msubsup id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.3.2.2" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.E4.m1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.3.3a.cmml">Proj</mtext><mi id="S3.E4.m1.1.1.1.1.1.1.3.2.3" xref="S3.E4.m1.1.1.1.1.1.1.3.2.3.cmml">l</mi></msubsup><mo id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3a.cmml">GELU</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2a.cmml">Conv</mtext><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">×</mo><mn id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">F</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E4.m1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.2.cmml"><msubsup id="S3.E4.m1.1.1.1.1.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.E4.m1.1.1.1.1.2.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.2.3a.cmml">Proj</mtext><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.2.2.3.cmml">l</mi></msubsup><mo id="S3.E4.m1.1.1.1.1.2.2.1" xref="S3.E4.m1.1.1.1.1.2.2.1.cmml">∈</mo><msup id="S3.E4.m1.1.1.1.1.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.3.2" xref="S3.E4.m1.1.1.1.1.2.2.3.2.cmml">ℝ</mi><mrow id="S3.E4.m1.1.1.1.1.2.2.3.3" xref="S3.E4.m1.1.1.1.1.2.2.3.3.cmml"><msup id="S3.E4.m1.1.1.1.1.2.2.3.3.2" xref="S3.E4.m1.1.1.1.1.2.2.3.3.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.3.3.2.2" xref="S3.E4.m1.1.1.1.1.2.2.3.3.2.2.cmml">C</mi><mi id="S3.E4.m1.1.1.1.1.2.2.3.3.2.3" xref="S3.E4.m1.1.1.1.1.2.2.3.3.2.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.1.1.1.1.2.2.3.3.1" xref="S3.E4.m1.1.1.1.1.2.2.3.3.1.cmml">×</mo><msup id="S3.E4.m1.1.1.1.1.2.2.3.3.3" xref="S3.E4.m1.1.1.1.1.2.2.3.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.3.3.3.2" xref="S3.E4.m1.1.1.1.1.2.2.3.3.3.2.cmml">H</mi><mi id="S3.E4.m1.1.1.1.1.2.2.3.3.3.3" xref="S3.E4.m1.1.1.1.1.2.2.3.3.3.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.1.1.1.1.2.2.3.3.1a" xref="S3.E4.m1.1.1.1.1.2.2.3.3.1.cmml">×</mo><msup id="S3.E4.m1.1.1.1.1.2.2.3.3.4" xref="S3.E4.m1.1.1.1.1.2.2.3.3.4.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.3.3.4.2" xref="S3.E4.m1.1.1.1.1.2.2.3.3.4.2.cmml">W</mi><mi id="S3.E4.m1.1.1.1.1.2.2.3.3.4.3" xref="S3.E4.m1.1.1.1.1.2.2.3.3.4.3.cmml">l</mi></msup></mrow></msup></mrow></mrow><mo id="S3.E4.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3a.cmml" xref="S3.E4.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2"></eq><apply id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2">𝐹</ci><ci id="S3.E4.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S3.E4.m1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E4.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.3">Proj</mtext></ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2"></times><ci id="S3.E4.m1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3">GELU</mtext></ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2">Conv</mtext></ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3"><times id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.1"></times><cn type="integer" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">1</cn><cn type="integer" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐹</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply><apply id="S3.E4.m1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2"><in id="S3.E4.m1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1"></in><apply id="S3.E4.m1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E4.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2">𝐹</ci><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.3">𝑙</ci></apply><ci id="S3.E4.m1.1.1.1.1.2.2.2.3a.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E4.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.3">Proj</mtext></ci></apply><apply id="S3.E4.m1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.2">ℝ</ci><apply id="S3.E4.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3"><times id="S3.E4.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.1"></times><apply id="S3.E4.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.3.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.2">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.3.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.2.2">𝐶</ci><ci id="S3.E4.m1.1.1.1.1.2.2.3.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.2.3">𝑙</ci></apply><apply id="S3.E4.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.3.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.3">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.3.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.3.2">𝐻</ci><ci id="S3.E4.m1.1.1.1.1.2.2.3.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.3.3">𝑙</ci></apply><apply id="S3.E4.m1.1.1.1.1.2.2.3.3.4.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.4"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.3.3.4.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.4">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.3.3.4.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.4.2">𝑊</ci><ci id="S3.E4.m1.1.1.1.1.2.2.3.3.4.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3.3.4.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">F^{l}_{\texttt{Proj}}=\texttt{GELU}(\texttt{Conv}_{1\times 1}(F^{l})),F^{l}_{\texttt{Proj}}\in\mathbb{R}^{C^{l}\times H^{l}\times W^{l}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.22" class="ltx_p">where we have used the <span id="S3.SS2.p2.22.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">GELU</span> activation function as non-linearity. We observe that <math id="S3.SS2.p2.6.m2.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj}}" display="inline"><semantics id="S3.SS2.p2.6.m2.1a"><msubsup id="S3.SS2.p2.6.m2.1.1" xref="S3.SS2.p2.6.m2.1.1.cmml"><mi id="S3.SS2.p2.6.m2.1.1.2.2" xref="S3.SS2.p2.6.m2.1.1.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.6.m2.1.1.3" xref="S3.SS2.p2.6.m2.1.1.3a.cmml">Proj</mtext><mi id="S3.SS2.p2.6.m2.1.1.2.3" xref="S3.SS2.p2.6.m2.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m2.1b"><apply id="S3.SS2.p2.6.m2.1.1.cmml" xref="S3.SS2.p2.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m2.1.1.1.cmml" xref="S3.SS2.p2.6.m2.1.1">subscript</csymbol><apply id="S3.SS2.p2.6.m2.1.1.2.cmml" xref="S3.SS2.p2.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m2.1.1.2.1.cmml" xref="S3.SS2.p2.6.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.6.m2.1.1.2.2.cmml" xref="S3.SS2.p2.6.m2.1.1.2.2">𝐹</ci><ci id="S3.SS2.p2.6.m2.1.1.2.3.cmml" xref="S3.SS2.p2.6.m2.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.6.m2.1.1.3a.cmml" xref="S3.SS2.p2.6.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.6.m2.1.1.3.cmml" xref="S3.SS2.p2.6.m2.1.1.3">Proj</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m2.1c">F^{l}_{\texttt{Proj}}</annotation></semantics></math> and <math id="S3.SS2.p2.7.m3.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p2.7.m3.1a"><msubsup id="S3.SS2.p2.7.m3.1.1" xref="S3.SS2.p2.7.m3.1.1.cmml"><mi id="S3.SS2.p2.7.m3.1.1.2.2" xref="S3.SS2.p2.7.m3.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.7.m3.1.1.2.3" xref="S3.SS2.p2.7.m3.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p2.7.m3.1.1.3" xref="S3.SS2.p2.7.m3.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m3.1b"><apply id="S3.SS2.p2.7.m3.1.1.cmml" xref="S3.SS2.p2.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m3.1.1.1.cmml" xref="S3.SS2.p2.7.m3.1.1">superscript</csymbol><apply id="S3.SS2.p2.7.m3.1.1.2.cmml" xref="S3.SS2.p2.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m3.1.1.2.1.cmml" xref="S3.SS2.p2.7.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m3.1.1.2.2.cmml" xref="S3.SS2.p2.7.m3.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.7.m3.1.1.2.3a.cmml" xref="S3.SS2.p2.7.m3.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.7.m3.1.1.2.3.cmml" xref="S3.SS2.p2.7.m3.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p2.7.m3.1.1.3.cmml" xref="S3.SS2.p2.7.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m3.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math> have a mismatch in the number of dimensions (<math id="S3.SS2.p2.8.m4.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p2.8.m4.1a"><msubsup id="S3.SS2.p2.8.m4.1.1" xref="S3.SS2.p2.8.m4.1.1.cmml"><mi id="S3.SS2.p2.8.m4.1.1.2.2" xref="S3.SS2.p2.8.m4.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.8.m4.1.1.2.3" xref="S3.SS2.p2.8.m4.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p2.8.m4.1.1.3" xref="S3.SS2.p2.8.m4.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m4.1b"><apply id="S3.SS2.p2.8.m4.1.1.cmml" xref="S3.SS2.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m4.1.1.1.cmml" xref="S3.SS2.p2.8.m4.1.1">superscript</csymbol><apply id="S3.SS2.p2.8.m4.1.1.2.cmml" xref="S3.SS2.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m4.1.1.2.1.cmml" xref="S3.SS2.p2.8.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m4.1.1.2.2.cmml" xref="S3.SS2.p2.8.m4.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.8.m4.1.1.2.3a.cmml" xref="S3.SS2.p2.8.m4.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.8.m4.1.1.2.3.cmml" xref="S3.SS2.p2.8.m4.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p2.8.m4.1.1.3.cmml" xref="S3.SS2.p2.8.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m4.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math> is <math id="S3.SS2.p2.9.m5.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S3.SS2.p2.9.m5.1a"><mn id="S3.SS2.p2.9.m5.1.1" xref="S3.SS2.p2.9.m5.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m5.1b"><cn type="integer" id="S3.SS2.p2.9.m5.1.1.cmml" xref="S3.SS2.p2.9.m5.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m5.1c">2</annotation></semantics></math>-D but <math id="S3.SS2.p2.10.m6.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj}}" display="inline"><semantics id="S3.SS2.p2.10.m6.1a"><msubsup id="S3.SS2.p2.10.m6.1.1" xref="S3.SS2.p2.10.m6.1.1.cmml"><mi id="S3.SS2.p2.10.m6.1.1.2.2" xref="S3.SS2.p2.10.m6.1.1.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.10.m6.1.1.3" xref="S3.SS2.p2.10.m6.1.1.3a.cmml">Proj</mtext><mi id="S3.SS2.p2.10.m6.1.1.2.3" xref="S3.SS2.p2.10.m6.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m6.1b"><apply id="S3.SS2.p2.10.m6.1.1.cmml" xref="S3.SS2.p2.10.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m6.1.1.1.cmml" xref="S3.SS2.p2.10.m6.1.1">subscript</csymbol><apply id="S3.SS2.p2.10.m6.1.1.2.cmml" xref="S3.SS2.p2.10.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m6.1.1.2.1.cmml" xref="S3.SS2.p2.10.m6.1.1">superscript</csymbol><ci id="S3.SS2.p2.10.m6.1.1.2.2.cmml" xref="S3.SS2.p2.10.m6.1.1.2.2">𝐹</ci><ci id="S3.SS2.p2.10.m6.1.1.2.3.cmml" xref="S3.SS2.p2.10.m6.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.10.m6.1.1.3a.cmml" xref="S3.SS2.p2.10.m6.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.10.m6.1.1.3.cmml" xref="S3.SS2.p2.10.m6.1.1.3">Proj</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m6.1c">F^{l}_{\texttt{Proj}}</annotation></semantics></math> is <math id="S3.SS2.p2.11.m7.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S3.SS2.p2.11.m7.1a"><mn id="S3.SS2.p2.11.m7.1.1" xref="S3.SS2.p2.11.m7.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m7.1b"><cn type="integer" id="S3.SS2.p2.11.m7.1.1.cmml" xref="S3.SS2.p2.11.m7.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m7.1c">3</annotation></semantics></math>-D), which precludes the use of standard MHCA operation. One plausible approach involves the use of reshaping operations followed by interpolation to transform <math id="S3.SS2.p2.12.m8.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p2.12.m8.1a"><msubsup id="S3.SS2.p2.12.m8.1.1" xref="S3.SS2.p2.12.m8.1.1.cmml"><mi id="S3.SS2.p2.12.m8.1.1.2.2" xref="S3.SS2.p2.12.m8.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.12.m8.1.1.2.3" xref="S3.SS2.p2.12.m8.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p2.12.m8.1.1.3" xref="S3.SS2.p2.12.m8.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m8.1b"><apply id="S3.SS2.p2.12.m8.1.1.cmml" xref="S3.SS2.p2.12.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m8.1.1.1.cmml" xref="S3.SS2.p2.12.m8.1.1">superscript</csymbol><apply id="S3.SS2.p2.12.m8.1.1.2.cmml" xref="S3.SS2.p2.12.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m8.1.1.2.1.cmml" xref="S3.SS2.p2.12.m8.1.1">subscript</csymbol><ci id="S3.SS2.p2.12.m8.1.1.2.2.cmml" xref="S3.SS2.p2.12.m8.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.12.m8.1.1.2.3a.cmml" xref="S3.SS2.p2.12.m8.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.12.m8.1.1.2.3.cmml" xref="S3.SS2.p2.12.m8.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p2.12.m8.1.1.3.cmml" xref="S3.SS2.p2.12.m8.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m8.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math> into the same dimension as <math id="S3.SS2.p2.13.m9.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj}}" display="inline"><semantics id="S3.SS2.p2.13.m9.1a"><msubsup id="S3.SS2.p2.13.m9.1.1" xref="S3.SS2.p2.13.m9.1.1.cmml"><mi id="S3.SS2.p2.13.m9.1.1.2.2" xref="S3.SS2.p2.13.m9.1.1.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.13.m9.1.1.3" xref="S3.SS2.p2.13.m9.1.1.3a.cmml">Proj</mtext><mi id="S3.SS2.p2.13.m9.1.1.2.3" xref="S3.SS2.p2.13.m9.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m9.1b"><apply id="S3.SS2.p2.13.m9.1.1.cmml" xref="S3.SS2.p2.13.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m9.1.1.1.cmml" xref="S3.SS2.p2.13.m9.1.1">subscript</csymbol><apply id="S3.SS2.p2.13.m9.1.1.2.cmml" xref="S3.SS2.p2.13.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m9.1.1.2.1.cmml" xref="S3.SS2.p2.13.m9.1.1">superscript</csymbol><ci id="S3.SS2.p2.13.m9.1.1.2.2.cmml" xref="S3.SS2.p2.13.m9.1.1.2.2">𝐹</ci><ci id="S3.SS2.p2.13.m9.1.1.2.3.cmml" xref="S3.SS2.p2.13.m9.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.13.m9.1.1.3a.cmml" xref="S3.SS2.p2.13.m9.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.13.m9.1.1.3.cmml" xref="S3.SS2.p2.13.m9.1.1.3">Proj</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m9.1c">F^{l}_{\texttt{Proj}}</annotation></semantics></math>. However, interpolation causes redundancy in the degradation-context thereby hindering the performance of cross-attention. To circumvent this problem, we reshape (denoted as <span id="S3.SS2.p2.22.2" class="ltx_text ltx_markedasmath ltx_font_typewriter">RH(.)</span>)
<math id="S3.SS2.p2.15.m11.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj}}" display="inline"><semantics id="S3.SS2.p2.15.m11.1a"><msubsup id="S3.SS2.p2.15.m11.1.1" xref="S3.SS2.p2.15.m11.1.1.cmml"><mi id="S3.SS2.p2.15.m11.1.1.2.2" xref="S3.SS2.p2.15.m11.1.1.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.15.m11.1.1.3" xref="S3.SS2.p2.15.m11.1.1.3a.cmml">Proj</mtext><mi id="S3.SS2.p2.15.m11.1.1.2.3" xref="S3.SS2.p2.15.m11.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.15.m11.1b"><apply id="S3.SS2.p2.15.m11.1.1.cmml" xref="S3.SS2.p2.15.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.15.m11.1.1.1.cmml" xref="S3.SS2.p2.15.m11.1.1">subscript</csymbol><apply id="S3.SS2.p2.15.m11.1.1.2.cmml" xref="S3.SS2.p2.15.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.15.m11.1.1.2.1.cmml" xref="S3.SS2.p2.15.m11.1.1">superscript</csymbol><ci id="S3.SS2.p2.15.m11.1.1.2.2.cmml" xref="S3.SS2.p2.15.m11.1.1.2.2">𝐹</ci><ci id="S3.SS2.p2.15.m11.1.1.2.3.cmml" xref="S3.SS2.p2.15.m11.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.15.m11.1.1.3a.cmml" xref="S3.SS2.p2.15.m11.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.15.m11.1.1.3.cmml" xref="S3.SS2.p2.15.m11.1.1.3">Proj</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.15.m11.1c">F^{l}_{\texttt{Proj}}</annotation></semantics></math> to obtain <math id="S3.SS2.p2.16.m12.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj\_rs}}\in\mathbb{R}^{H^{l}\cdot W^{l}\times C^{l}}" display="inline"><semantics id="S3.SS2.p2.16.m12.1a"><mrow id="S3.SS2.p2.16.m12.1.1" xref="S3.SS2.p2.16.m12.1.1.cmml"><msubsup id="S3.SS2.p2.16.m12.1.1.2" xref="S3.SS2.p2.16.m12.1.1.2.cmml"><mi id="S3.SS2.p2.16.m12.1.1.2.2.2" xref="S3.SS2.p2.16.m12.1.1.2.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.16.m12.1.1.2.3" xref="S3.SS2.p2.16.m12.1.1.2.3a.cmml">Proj_rs</mtext><mi id="S3.SS2.p2.16.m12.1.1.2.2.3" xref="S3.SS2.p2.16.m12.1.1.2.2.3.cmml">l</mi></msubsup><mo id="S3.SS2.p2.16.m12.1.1.1" xref="S3.SS2.p2.16.m12.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.16.m12.1.1.3" xref="S3.SS2.p2.16.m12.1.1.3.cmml"><mi id="S3.SS2.p2.16.m12.1.1.3.2" xref="S3.SS2.p2.16.m12.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.16.m12.1.1.3.3" xref="S3.SS2.p2.16.m12.1.1.3.3.cmml"><mrow id="S3.SS2.p2.16.m12.1.1.3.3.2" xref="S3.SS2.p2.16.m12.1.1.3.3.2.cmml"><msup id="S3.SS2.p2.16.m12.1.1.3.3.2.2" xref="S3.SS2.p2.16.m12.1.1.3.3.2.2.cmml"><mi id="S3.SS2.p2.16.m12.1.1.3.3.2.2.2" xref="S3.SS2.p2.16.m12.1.1.3.3.2.2.2.cmml">H</mi><mi id="S3.SS2.p2.16.m12.1.1.3.3.2.2.3" xref="S3.SS2.p2.16.m12.1.1.3.3.2.2.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.16.m12.1.1.3.3.2.1" xref="S3.SS2.p2.16.m12.1.1.3.3.2.1.cmml">⋅</mo><msup id="S3.SS2.p2.16.m12.1.1.3.3.2.3" xref="S3.SS2.p2.16.m12.1.1.3.3.2.3.cmml"><mi id="S3.SS2.p2.16.m12.1.1.3.3.2.3.2" xref="S3.SS2.p2.16.m12.1.1.3.3.2.3.2.cmml">W</mi><mi id="S3.SS2.p2.16.m12.1.1.3.3.2.3.3" xref="S3.SS2.p2.16.m12.1.1.3.3.2.3.3.cmml">l</mi></msup></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.16.m12.1.1.3.3.1" xref="S3.SS2.p2.16.m12.1.1.3.3.1.cmml">×</mo><msup id="S3.SS2.p2.16.m12.1.1.3.3.3" xref="S3.SS2.p2.16.m12.1.1.3.3.3.cmml"><mi id="S3.SS2.p2.16.m12.1.1.3.3.3.2" xref="S3.SS2.p2.16.m12.1.1.3.3.3.2.cmml">C</mi><mi id="S3.SS2.p2.16.m12.1.1.3.3.3.3" xref="S3.SS2.p2.16.m12.1.1.3.3.3.3.cmml">l</mi></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.16.m12.1b"><apply id="S3.SS2.p2.16.m12.1.1.cmml" xref="S3.SS2.p2.16.m12.1.1"><in id="S3.SS2.p2.16.m12.1.1.1.cmml" xref="S3.SS2.p2.16.m12.1.1.1"></in><apply id="S3.SS2.p2.16.m12.1.1.2.cmml" xref="S3.SS2.p2.16.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.16.m12.1.1.2.1.cmml" xref="S3.SS2.p2.16.m12.1.1.2">subscript</csymbol><apply id="S3.SS2.p2.16.m12.1.1.2.2.cmml" xref="S3.SS2.p2.16.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.16.m12.1.1.2.2.1.cmml" xref="S3.SS2.p2.16.m12.1.1.2">superscript</csymbol><ci id="S3.SS2.p2.16.m12.1.1.2.2.2.cmml" xref="S3.SS2.p2.16.m12.1.1.2.2.2">𝐹</ci><ci id="S3.SS2.p2.16.m12.1.1.2.2.3.cmml" xref="S3.SS2.p2.16.m12.1.1.2.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.16.m12.1.1.2.3a.cmml" xref="S3.SS2.p2.16.m12.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.16.m12.1.1.2.3.cmml" xref="S3.SS2.p2.16.m12.1.1.2.3">Proj_rs</mtext></ci></apply><apply id="S3.SS2.p2.16.m12.1.1.3.cmml" xref="S3.SS2.p2.16.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.16.m12.1.1.3.1.cmml" xref="S3.SS2.p2.16.m12.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.16.m12.1.1.3.2.cmml" xref="S3.SS2.p2.16.m12.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.16.m12.1.1.3.3.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3"><times id="S3.SS2.p2.16.m12.1.1.3.3.1.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.1"></times><apply id="S3.SS2.p2.16.m12.1.1.3.3.2.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.2"><ci id="S3.SS2.p2.16.m12.1.1.3.3.2.1.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.2.1">⋅</ci><apply id="S3.SS2.p2.16.m12.1.1.3.3.2.2.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.16.m12.1.1.3.3.2.2.1.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.2.2">superscript</csymbol><ci id="S3.SS2.p2.16.m12.1.1.3.3.2.2.2.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.2.2.2">𝐻</ci><ci id="S3.SS2.p2.16.m12.1.1.3.3.2.2.3.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.2.2.3">𝑙</ci></apply><apply id="S3.SS2.p2.16.m12.1.1.3.3.2.3.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.16.m12.1.1.3.3.2.3.1.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.2.3">superscript</csymbol><ci id="S3.SS2.p2.16.m12.1.1.3.3.2.3.2.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.2.3.2">𝑊</ci><ci id="S3.SS2.p2.16.m12.1.1.3.3.2.3.3.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.2.3.3">𝑙</ci></apply></apply><apply id="S3.SS2.p2.16.m12.1.1.3.3.3.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.16.m12.1.1.3.3.3.1.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.3">superscript</csymbol><ci id="S3.SS2.p2.16.m12.1.1.3.3.3.2.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.3.2">𝐶</ci><ci id="S3.SS2.p2.16.m12.1.1.3.3.3.3.cmml" xref="S3.SS2.p2.16.m12.1.1.3.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.16.m12.1c">F^{l}_{\texttt{Proj\_rs}}\in\mathbb{R}^{H^{l}\cdot W^{l}\times C^{l}}</annotation></semantics></math> which has the same channel dimensions, <math id="S3.SS2.p2.17.m13.1" class="ltx_Math" alttext="C^{l}" display="inline"><semantics id="S3.SS2.p2.17.m13.1a"><msup id="S3.SS2.p2.17.m13.1.1" xref="S3.SS2.p2.17.m13.1.1.cmml"><mi id="S3.SS2.p2.17.m13.1.1.2" xref="S3.SS2.p2.17.m13.1.1.2.cmml">C</mi><mi id="S3.SS2.p2.17.m13.1.1.3" xref="S3.SS2.p2.17.m13.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.17.m13.1b"><apply id="S3.SS2.p2.17.m13.1.1.cmml" xref="S3.SS2.p2.17.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.17.m13.1.1.1.cmml" xref="S3.SS2.p2.17.m13.1.1">superscript</csymbol><ci id="S3.SS2.p2.17.m13.1.1.2.cmml" xref="S3.SS2.p2.17.m13.1.1.2">𝐶</ci><ci id="S3.SS2.p2.17.m13.1.1.3.cmml" xref="S3.SS2.p2.17.m13.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.17.m13.1c">C^{l}</annotation></semantics></math>, as <math id="S3.SS2.p2.18.m14.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p2.18.m14.1a"><msubsup id="S3.SS2.p2.18.m14.1.1" xref="S3.SS2.p2.18.m14.1.1.cmml"><mi id="S3.SS2.p2.18.m14.1.1.2.2" xref="S3.SS2.p2.18.m14.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.18.m14.1.1.2.3" xref="S3.SS2.p2.18.m14.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p2.18.m14.1.1.3" xref="S3.SS2.p2.18.m14.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.18.m14.1b"><apply id="S3.SS2.p2.18.m14.1.1.cmml" xref="S3.SS2.p2.18.m14.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.18.m14.1.1.1.cmml" xref="S3.SS2.p2.18.m14.1.1">superscript</csymbol><apply id="S3.SS2.p2.18.m14.1.1.2.cmml" xref="S3.SS2.p2.18.m14.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.18.m14.1.1.2.1.cmml" xref="S3.SS2.p2.18.m14.1.1">subscript</csymbol><ci id="S3.SS2.p2.18.m14.1.1.2.2.cmml" xref="S3.SS2.p2.18.m14.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.18.m14.1.1.2.3a.cmml" xref="S3.SS2.p2.18.m14.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.18.m14.1.1.2.3.cmml" xref="S3.SS2.p2.18.m14.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p2.18.m14.1.1.3.cmml" xref="S3.SS2.p2.18.m14.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.18.m14.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math>. Notice that no interpolation operations are required as the number of dimensions are now consistent between <math id="S3.SS2.p2.19.m15.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p2.19.m15.1a"><msubsup id="S3.SS2.p2.19.m15.1.1" xref="S3.SS2.p2.19.m15.1.1.cmml"><mi id="S3.SS2.p2.19.m15.1.1.2.2" xref="S3.SS2.p2.19.m15.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.19.m15.1.1.2.3" xref="S3.SS2.p2.19.m15.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p2.19.m15.1.1.3" xref="S3.SS2.p2.19.m15.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.19.m15.1b"><apply id="S3.SS2.p2.19.m15.1.1.cmml" xref="S3.SS2.p2.19.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.19.m15.1.1.1.cmml" xref="S3.SS2.p2.19.m15.1.1">superscript</csymbol><apply id="S3.SS2.p2.19.m15.1.1.2.cmml" xref="S3.SS2.p2.19.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.19.m15.1.1.2.1.cmml" xref="S3.SS2.p2.19.m15.1.1">subscript</csymbol><ci id="S3.SS2.p2.19.m15.1.1.2.2.cmml" xref="S3.SS2.p2.19.m15.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.19.m15.1.1.2.3a.cmml" xref="S3.SS2.p2.19.m15.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.19.m15.1.1.2.3.cmml" xref="S3.SS2.p2.19.m15.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p2.19.m15.1.1.3.cmml" xref="S3.SS2.p2.19.m15.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.19.m15.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math> and <math id="S3.SS2.p2.20.m16.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj\_rs}}" display="inline"><semantics id="S3.SS2.p2.20.m16.1a"><msubsup id="S3.SS2.p2.20.m16.1.1" xref="S3.SS2.p2.20.m16.1.1.cmml"><mi id="S3.SS2.p2.20.m16.1.1.2.2" xref="S3.SS2.p2.20.m16.1.1.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.20.m16.1.1.3" xref="S3.SS2.p2.20.m16.1.1.3a.cmml">Proj_rs</mtext><mi id="S3.SS2.p2.20.m16.1.1.2.3" xref="S3.SS2.p2.20.m16.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.20.m16.1b"><apply id="S3.SS2.p2.20.m16.1.1.cmml" xref="S3.SS2.p2.20.m16.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.20.m16.1.1.1.cmml" xref="S3.SS2.p2.20.m16.1.1">subscript</csymbol><apply id="S3.SS2.p2.20.m16.1.1.2.cmml" xref="S3.SS2.p2.20.m16.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.20.m16.1.1.2.1.cmml" xref="S3.SS2.p2.20.m16.1.1">superscript</csymbol><ci id="S3.SS2.p2.20.m16.1.1.2.2.cmml" xref="S3.SS2.p2.20.m16.1.1.2.2">𝐹</ci><ci id="S3.SS2.p2.20.m16.1.1.2.3.cmml" xref="S3.SS2.p2.20.m16.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.20.m16.1.1.3a.cmml" xref="S3.SS2.p2.20.m16.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.20.m16.1.1.3.cmml" xref="S3.SS2.p2.20.m16.1.1.3">Proj_rs</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.20.m16.1c">F^{l}_{\texttt{Proj\_rs}}</annotation></semantics></math>. Subsequently, layer normalization is applied to both <math id="S3.SS2.p2.21.m17.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p2.21.m17.1a"><msubsup id="S3.SS2.p2.21.m17.1.1" xref="S3.SS2.p2.21.m17.1.1.cmml"><mi id="S3.SS2.p2.21.m17.1.1.2.2" xref="S3.SS2.p2.21.m17.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.21.m17.1.1.2.3" xref="S3.SS2.p2.21.m17.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p2.21.m17.1.1.3" xref="S3.SS2.p2.21.m17.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.21.m17.1b"><apply id="S3.SS2.p2.21.m17.1.1.cmml" xref="S3.SS2.p2.21.m17.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.21.m17.1.1.1.cmml" xref="S3.SS2.p2.21.m17.1.1">superscript</csymbol><apply id="S3.SS2.p2.21.m17.1.1.2.cmml" xref="S3.SS2.p2.21.m17.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.21.m17.1.1.2.1.cmml" xref="S3.SS2.p2.21.m17.1.1">subscript</csymbol><ci id="S3.SS2.p2.21.m17.1.1.2.2.cmml" xref="S3.SS2.p2.21.m17.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.21.m17.1.1.2.3a.cmml" xref="S3.SS2.p2.21.m17.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.21.m17.1.1.2.3.cmml" xref="S3.SS2.p2.21.m17.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p2.21.m17.1.1.3.cmml" xref="S3.SS2.p2.21.m17.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.21.m17.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math> and <math id="S3.SS2.p2.22.m18.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj\_rs}}" display="inline"><semantics id="S3.SS2.p2.22.m18.1a"><msubsup id="S3.SS2.p2.22.m18.1.1" xref="S3.SS2.p2.22.m18.1.1.cmml"><mi id="S3.SS2.p2.22.m18.1.1.2.2" xref="S3.SS2.p2.22.m18.1.1.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.22.m18.1.1.3" xref="S3.SS2.p2.22.m18.1.1.3a.cmml">Proj_rs</mtext><mi id="S3.SS2.p2.22.m18.1.1.2.3" xref="S3.SS2.p2.22.m18.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.22.m18.1b"><apply id="S3.SS2.p2.22.m18.1.1.cmml" xref="S3.SS2.p2.22.m18.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.22.m18.1.1.1.cmml" xref="S3.SS2.p2.22.m18.1.1">subscript</csymbol><apply id="S3.SS2.p2.22.m18.1.1.2.cmml" xref="S3.SS2.p2.22.m18.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.22.m18.1.1.2.1.cmml" xref="S3.SS2.p2.22.m18.1.1">superscript</csymbol><ci id="S3.SS2.p2.22.m18.1.1.2.2.cmml" xref="S3.SS2.p2.22.m18.1.1.2.2">𝐹</ci><ci id="S3.SS2.p2.22.m18.1.1.2.3.cmml" xref="S3.SS2.p2.22.m18.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.22.m18.1.1.3a.cmml" xref="S3.SS2.p2.22.m18.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.22.m18.1.1.3.cmml" xref="S3.SS2.p2.22.m18.1.1.3">Proj_rs</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.22.m18.1c">F^{l}_{\texttt{Proj\_rs}}</annotation></semantics></math>. The above steps can be summarised as</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj\_rs}}=\texttt{LN}(\texttt{RH}(F^{l}_{\texttt{Proj}})),O_{\texttt{DCE}}^{l}=\texttt{LN}(O_{\texttt{DCE}}^{l})." display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1"><mrow id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.3.cmml"><mrow id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><msubsup id="S3.E5.m1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.1.1.3.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.E5.m1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.3.3a.cmml">Proj_rs</mtext><mi id="S3.E5.m1.1.1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.1.1.3.2.3.cmml">l</mi></msubsup><mo id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E5.m1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3a.cmml">RH</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">Proj</mtext><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E5.m1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.2.2.cmml"><msubsup id="S3.E5.m1.1.1.1.1.2.2.3" xref="S3.E5.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.2.2.3.2.2" xref="S3.E5.m1.1.1.1.1.2.2.3.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.E5.m1.1.1.1.1.2.2.3.2.3" xref="S3.E5.m1.1.1.1.1.2.2.3.2.3a.cmml">DCE</mtext><mi id="S3.E5.m1.1.1.1.1.2.2.3.3" xref="S3.E5.m1.1.1.1.1.2.2.3.3.cmml">l</mi></msubsup><mo id="S3.E5.m1.1.1.1.1.2.2.2" xref="S3.E5.m1.1.1.1.1.2.2.2.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.2.2.1" xref="S3.E5.m1.1.1.1.1.2.2.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E5.m1.1.1.1.1.2.2.1.3" xref="S3.E5.m1.1.1.1.1.2.2.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.2.2.1.2" xref="S3.E5.m1.1.1.1.1.2.2.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.2.2.1.1.1" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.2.2.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.1.1.1.1.2.2.1.1.1.1" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.2.3a.cmml">DCE</mtext><mi id="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.E5.m1.1.1.1.1.2.2.1.1.1.3" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3a.cmml" xref="S3.E5.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2"></eq><apply id="S3.E5.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2.2">𝐹</ci><ci id="S3.E5.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S3.E5.m1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3">Proj_rs</mtext></ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E5.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3">LN</mtext></ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3">RH</mtext></ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐹</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">Proj</mtext></ci></apply></apply></apply></apply><apply id="S3.E5.m1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2"><eq id="S3.E5.m1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2"></eq><apply id="S3.E5.m1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3.2.2">𝑂</ci><ci id="S3.E5.m1.1.1.1.1.2.2.3.2.3a.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E5.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3.2.3">DCE</mtext></ci></apply><ci id="S3.E5.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3.3">𝑙</ci></apply><apply id="S3.E5.m1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.1"><times id="S3.E5.m1.1.1.1.1.2.2.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.1.2"></times><ci id="S3.E5.m1.1.1.1.1.2.2.1.3a.cmml" xref="S3.E5.m1.1.1.1.1.2.2.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E5.m1.1.1.1.1.2.2.1.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.1.3">LN</mtext></ci><apply id="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.2.2">𝑂</ci><ci id="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.2.3a.cmml" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">F^{l}_{\texttt{Proj\_rs}}=\texttt{LN}(\texttt{RH}(F^{l}_{\texttt{Proj}})),O_{\texttt{DCE}}^{l}=\texttt{LN}(O_{\texttt{DCE}}^{l}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.28" class="ltx_p">Next, we employ cross-attention to integrate relevant degradation-specific
information into <math id="S3.SS2.p2.23.m1.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj\_rs}}" display="inline"><semantics id="S3.SS2.p2.23.m1.1a"><msubsup id="S3.SS2.p2.23.m1.1.1" xref="S3.SS2.p2.23.m1.1.1.cmml"><mi id="S3.SS2.p2.23.m1.1.1.2.2" xref="S3.SS2.p2.23.m1.1.1.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.23.m1.1.1.3" xref="S3.SS2.p2.23.m1.1.1.3a.cmml">Proj_rs</mtext><mi id="S3.SS2.p2.23.m1.1.1.2.3" xref="S3.SS2.p2.23.m1.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.23.m1.1b"><apply id="S3.SS2.p2.23.m1.1.1.cmml" xref="S3.SS2.p2.23.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.23.m1.1.1.1.cmml" xref="S3.SS2.p2.23.m1.1.1">subscript</csymbol><apply id="S3.SS2.p2.23.m1.1.1.2.cmml" xref="S3.SS2.p2.23.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.23.m1.1.1.2.1.cmml" xref="S3.SS2.p2.23.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.23.m1.1.1.2.2.cmml" xref="S3.SS2.p2.23.m1.1.1.2.2">𝐹</ci><ci id="S3.SS2.p2.23.m1.1.1.2.3.cmml" xref="S3.SS2.p2.23.m1.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.23.m1.1.1.3a.cmml" xref="S3.SS2.p2.23.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.23.m1.1.1.3.cmml" xref="S3.SS2.p2.23.m1.1.1.3">Proj_rs</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.23.m1.1c">F^{l}_{\texttt{Proj\_rs}}</annotation></semantics></math> and this is achieved using MHCA. For this purpose, we use <math id="S3.SS2.p2.24.m2.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj\_rs}}" display="inline"><semantics id="S3.SS2.p2.24.m2.1a"><msubsup id="S3.SS2.p2.24.m2.1.1" xref="S3.SS2.p2.24.m2.1.1.cmml"><mi id="S3.SS2.p2.24.m2.1.1.2.2" xref="S3.SS2.p2.24.m2.1.1.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.24.m2.1.1.3" xref="S3.SS2.p2.24.m2.1.1.3a.cmml">Proj_rs</mtext><mi id="S3.SS2.p2.24.m2.1.1.2.3" xref="S3.SS2.p2.24.m2.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.24.m2.1b"><apply id="S3.SS2.p2.24.m2.1.1.cmml" xref="S3.SS2.p2.24.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.24.m2.1.1.1.cmml" xref="S3.SS2.p2.24.m2.1.1">subscript</csymbol><apply id="S3.SS2.p2.24.m2.1.1.2.cmml" xref="S3.SS2.p2.24.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.24.m2.1.1.2.1.cmml" xref="S3.SS2.p2.24.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.24.m2.1.1.2.2.cmml" xref="S3.SS2.p2.24.m2.1.1.2.2">𝐹</ci><ci id="S3.SS2.p2.24.m2.1.1.2.3.cmml" xref="S3.SS2.p2.24.m2.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.24.m2.1.1.3a.cmml" xref="S3.SS2.p2.24.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.24.m2.1.1.3.cmml" xref="S3.SS2.p2.24.m2.1.1.3">Proj_rs</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.24.m2.1c">F^{l}_{\texttt{Proj\_rs}}</annotation></semantics></math> to calculate the query (<span id="S3.SS2.p2.28.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">Q</span>) and <math id="S3.SS2.p2.26.m4.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p2.26.m4.1a"><msubsup id="S3.SS2.p2.26.m4.1.1" xref="S3.SS2.p2.26.m4.1.1.cmml"><mi id="S3.SS2.p2.26.m4.1.1.2.2" xref="S3.SS2.p2.26.m4.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.26.m4.1.1.2.3" xref="S3.SS2.p2.26.m4.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p2.26.m4.1.1.3" xref="S3.SS2.p2.26.m4.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.26.m4.1b"><apply id="S3.SS2.p2.26.m4.1.1.cmml" xref="S3.SS2.p2.26.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.26.m4.1.1.1.cmml" xref="S3.SS2.p2.26.m4.1.1">superscript</csymbol><apply id="S3.SS2.p2.26.m4.1.1.2.cmml" xref="S3.SS2.p2.26.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.26.m4.1.1.2.1.cmml" xref="S3.SS2.p2.26.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.26.m4.1.1.2.2.cmml" xref="S3.SS2.p2.26.m4.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.26.m4.1.1.2.3a.cmml" xref="S3.SS2.p2.26.m4.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.26.m4.1.1.2.3.cmml" xref="S3.SS2.p2.26.m4.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p2.26.m4.1.1.3.cmml" xref="S3.SS2.p2.26.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.26.m4.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math> for computing the key (<span id="S3.SS2.p2.28.2" class="ltx_text ltx_markedasmath ltx_font_typewriter">K</span>) and value (<span id="S3.SS2.p2.28.3" class="ltx_text ltx_markedasmath ltx_font_typewriter">V</span>) as follows</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.3" class="ltx_Math" alttext="F^{l}_{\texttt{Proj\_rs}}\xrightarrow{}\texttt{Q},O_{\texttt{DCE}}^{l}\xrightarrow{}\texttt{K},\texttt{V}," display="block"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.1"><mrow id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.3.cmml"><mrow id="S3.E6.m1.3.3.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.cmml"><msubsup id="S3.E6.m1.3.3.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.2.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.E6.m1.3.3.1.1.1.1.2.3" xref="S3.E6.m1.3.3.1.1.1.1.2.3a.cmml">Proj_rs</mtext><mi id="S3.E6.m1.3.3.1.1.1.1.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.2.2.3.cmml">l</mi></msubsup><mover accent="true" id="S3.E6.m1.3.3.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.2.cmml">→</mo><mi id="S3.E6.m1.3.3.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.cmml"></mi></mover><mtext class="ltx_mathvariant_monospace" id="S3.E6.m1.3.3.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.3a.cmml">Q</mtext></mrow><mo id="S3.E6.m1.3.3.1.1.2.3" xref="S3.E6.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E6.m1.3.3.1.1.2.2" xref="S3.E6.m1.3.3.1.1.2.2.cmml"><msubsup id="S3.E6.m1.3.3.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.E6.m1.3.3.1.1.2.2.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3a.cmml">DCE</mtext><mi id="S3.E6.m1.3.3.1.1.2.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.2.3.cmml">l</mi></msubsup><mover accent="true" id="S3.E6.m1.3.3.1.1.2.2.1" xref="S3.E6.m1.3.3.1.1.2.2.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.2.2.1.2" xref="S3.E6.m1.3.3.1.1.2.2.1.2.cmml">→</mo><mi id="S3.E6.m1.3.3.1.1.2.2.1.1" xref="S3.E6.m1.3.3.1.1.2.2.1.1.cmml"></mi></mover><mrow id="S3.E6.m1.3.3.1.1.2.2.3.2" xref="S3.E6.m1.3.3.1.1.2.2.3.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1a.cmml">K</mtext><mo id="S3.E6.m1.3.3.1.1.2.2.3.2.1" xref="S3.E6.m1.3.3.1.1.2.2.3.1.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2a.cmml">V</mtext></mrow></mrow></mrow><mo id="S3.E6.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.3a.cmml" xref="S3.E6.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1"><apply id="S3.E6.m1.3.3.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1">absent</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.2">→</ci></apply><apply id="S3.E6.m1.3.3.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2">subscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2">superscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2.2.2">𝐹</ci><ci id="S3.E6.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2.2.3">𝑙</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.2.3a.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E6.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2.3">Proj_rs</mtext></ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.3a.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E6.m1.3.3.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3">Q</mtext></ci></apply><apply id="S3.E6.m1.3.3.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2"><apply id="S3.E6.m1.3.3.1.1.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1"><csymbol cd="latexml" id="S3.E6.m1.3.3.1.1.2.2.1.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1">absent</csymbol><ci id="S3.E6.m1.3.3.1.1.2.2.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.2">→</ci></apply><apply id="S3.E6.m1.3.3.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.2">𝑂</ci><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.3a.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E6.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3">DCE</mtext></ci></apply><ci id="S3.E6.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.3">𝑙</ci></apply><list id="S3.E6.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.3.2"><ci id="S3.E6.m1.1.1a.cmml" xref="S3.E6.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">K</mtext></ci><ci id="S3.E6.m1.2.2a.cmml" xref="S3.E6.m1.2.2"><mtext class="ltx_mathvariant_monospace" id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">V</mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">F^{l}_{\texttt{Proj\_rs}}\xrightarrow{}\texttt{Q},O_{\texttt{DCE}}^{l}\xrightarrow{}\texttt{K},\texttt{V},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.4" class="ltx_Math" alttext="O_{\texttt{MHCA}}^{l}=\texttt{MHCA}(\texttt{Q},\texttt{K},\texttt{V}),O_{\texttt{MHCA}}^{l}\in\mathbb{R}^{H^{l}\cdot W^{l}\times C^{l}}." display="block"><semantics id="S3.E7.m1.4a"><mrow id="S3.E7.m1.4.4.1"><mrow id="S3.E7.m1.4.4.1.1.2" xref="S3.E7.m1.4.4.1.1.3.cmml"><mrow id="S3.E7.m1.4.4.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.cmml"><msubsup id="S3.E7.m1.4.4.1.1.1.1.2" xref="S3.E7.m1.4.4.1.1.1.1.2.cmml"><mi id="S3.E7.m1.4.4.1.1.1.1.2.2.2" xref="S3.E7.m1.4.4.1.1.1.1.2.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.4.4.1.1.1.1.2.2.3" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3a.cmml">MHCA</mtext><mi id="S3.E7.m1.4.4.1.1.1.1.2.3" xref="S3.E7.m1.4.4.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.E7.m1.4.4.1.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.4.4.1.1.1.1.3" xref="S3.E7.m1.4.4.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.4.4.1.1.1.1.3.2" xref="S3.E7.m1.4.4.1.1.1.1.3.2a.cmml">MHCA</mtext><mo lspace="0em" rspace="0em" id="S3.E7.m1.4.4.1.1.1.1.3.1" xref="S3.E7.m1.4.4.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E7.m1.4.4.1.1.1.1.3.3.2" xref="S3.E7.m1.4.4.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E7.m1.4.4.1.1.1.1.3.3.2.1" xref="S3.E7.m1.4.4.1.1.1.1.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1a.cmml">Q</mtext><mo id="S3.E7.m1.4.4.1.1.1.1.3.3.2.2" xref="S3.E7.m1.4.4.1.1.1.1.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2a.cmml">K</mtext><mo id="S3.E7.m1.4.4.1.1.1.1.3.3.2.3" xref="S3.E7.m1.4.4.1.1.1.1.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3a.cmml">V</mtext><mo stretchy="false" id="S3.E7.m1.4.4.1.1.1.1.3.3.2.4" xref="S3.E7.m1.4.4.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.4.4.1.1.2.3" xref="S3.E7.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S3.E7.m1.4.4.1.1.2.2" xref="S3.E7.m1.4.4.1.1.2.2.cmml"><msubsup id="S3.E7.m1.4.4.1.1.2.2.2" xref="S3.E7.m1.4.4.1.1.2.2.2.cmml"><mi id="S3.E7.m1.4.4.1.1.2.2.2.2.2" xref="S3.E7.m1.4.4.1.1.2.2.2.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.4.4.1.1.2.2.2.2.3" xref="S3.E7.m1.4.4.1.1.2.2.2.2.3a.cmml">MHCA</mtext><mi id="S3.E7.m1.4.4.1.1.2.2.2.3" xref="S3.E7.m1.4.4.1.1.2.2.2.3.cmml">l</mi></msubsup><mo id="S3.E7.m1.4.4.1.1.2.2.1" xref="S3.E7.m1.4.4.1.1.2.2.1.cmml">∈</mo><msup id="S3.E7.m1.4.4.1.1.2.2.3" xref="S3.E7.m1.4.4.1.1.2.2.3.cmml"><mi id="S3.E7.m1.4.4.1.1.2.2.3.2" xref="S3.E7.m1.4.4.1.1.2.2.3.2.cmml">ℝ</mi><mrow id="S3.E7.m1.4.4.1.1.2.2.3.3" xref="S3.E7.m1.4.4.1.1.2.2.3.3.cmml"><mrow id="S3.E7.m1.4.4.1.1.2.2.3.3.2" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.cmml"><msup id="S3.E7.m1.4.4.1.1.2.2.3.3.2.2" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.2.cmml"><mi id="S3.E7.m1.4.4.1.1.2.2.3.3.2.2.2" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.2.2.cmml">H</mi><mi id="S3.E7.m1.4.4.1.1.2.2.3.3.2.2.3" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.2.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E7.m1.4.4.1.1.2.2.3.3.2.1" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.1.cmml">⋅</mo><msup id="S3.E7.m1.4.4.1.1.2.2.3.3.2.3" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.3.cmml"><mi id="S3.E7.m1.4.4.1.1.2.2.3.3.2.3.2" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.3.2.cmml">W</mi><mi id="S3.E7.m1.4.4.1.1.2.2.3.3.2.3.3" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.3.3.cmml">l</mi></msup></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.E7.m1.4.4.1.1.2.2.3.3.1" xref="S3.E7.m1.4.4.1.1.2.2.3.3.1.cmml">×</mo><msup id="S3.E7.m1.4.4.1.1.2.2.3.3.3" xref="S3.E7.m1.4.4.1.1.2.2.3.3.3.cmml"><mi id="S3.E7.m1.4.4.1.1.2.2.3.3.3.2" xref="S3.E7.m1.4.4.1.1.2.2.3.3.3.2.cmml">C</mi><mi id="S3.E7.m1.4.4.1.1.2.2.3.3.3.3" xref="S3.E7.m1.4.4.1.1.2.2.3.3.3.3.cmml">l</mi></msup></mrow></msup></mrow></mrow><mo lspace="0em" id="S3.E7.m1.4.4.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.4b"><apply id="S3.E7.m1.4.4.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.3a.cmml" xref="S3.E7.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.4.4.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1"><eq id="S3.E7.m1.4.4.1.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1"></eq><apply id="S3.E7.m1.4.4.1.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.2.2">𝑂</ci><ci id="S3.E7.m1.4.4.1.1.1.1.2.2.3a.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E7.m1.4.4.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3">MHCA</mtext></ci></apply><ci id="S3.E7.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.3">𝑙</ci></apply><apply id="S3.E7.m1.4.4.1.1.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.3"><times id="S3.E7.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.3.1"></times><ci id="S3.E7.m1.4.4.1.1.1.1.3.2a.cmml" xref="S3.E7.m1.4.4.1.1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.3.2">MHCA</mtext></ci><vector id="S3.E7.m1.4.4.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.3.3.2"><ci id="S3.E7.m1.1.1a.cmml" xref="S3.E7.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">Q</mtext></ci><ci id="S3.E7.m1.2.2a.cmml" xref="S3.E7.m1.2.2"><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">K</mtext></ci><ci id="S3.E7.m1.3.3a.cmml" xref="S3.E7.m1.3.3"><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3">V</mtext></ci></vector></apply></apply><apply id="S3.E7.m1.4.4.1.1.2.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2"><in id="S3.E7.m1.4.4.1.1.2.2.1.cmml" xref="S3.E7.m1.4.4.1.1.2.2.1"></in><apply id="S3.E7.m1.4.4.1.1.2.2.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.2.2.2.1.cmml" xref="S3.E7.m1.4.4.1.1.2.2.2">superscript</csymbol><apply id="S3.E7.m1.4.4.1.1.2.2.2.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S3.E7.m1.4.4.1.1.2.2.2">subscript</csymbol><ci id="S3.E7.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2.2.2.2">𝑂</ci><ci id="S3.E7.m1.4.4.1.1.2.2.2.2.3a.cmml" xref="S3.E7.m1.4.4.1.1.2.2.2.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E7.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S3.E7.m1.4.4.1.1.2.2.2.2.3">MHCA</mtext></ci></apply><ci id="S3.E7.m1.4.4.1.1.2.2.2.3.cmml" xref="S3.E7.m1.4.4.1.1.2.2.2.3">𝑙</ci></apply><apply id="S3.E7.m1.4.4.1.1.2.2.3.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.2.2.3.1.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3">superscript</csymbol><ci id="S3.E7.m1.4.4.1.1.2.2.3.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.2">ℝ</ci><apply id="S3.E7.m1.4.4.1.1.2.2.3.3.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3"><times id="S3.E7.m1.4.4.1.1.2.2.3.3.1.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.1"></times><apply id="S3.E7.m1.4.4.1.1.2.2.3.3.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2"><ci id="S3.E7.m1.4.4.1.1.2.2.3.3.2.1.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.1">⋅</ci><apply id="S3.E7.m1.4.4.1.1.2.2.3.3.2.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.2.2.3.3.2.2.1.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.2">superscript</csymbol><ci id="S3.E7.m1.4.4.1.1.2.2.3.3.2.2.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.2.2">𝐻</ci><ci id="S3.E7.m1.4.4.1.1.2.2.3.3.2.2.3.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.2.3">𝑙</ci></apply><apply id="S3.E7.m1.4.4.1.1.2.2.3.3.2.3.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.2.2.3.3.2.3.1.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.3">superscript</csymbol><ci id="S3.E7.m1.4.4.1.1.2.2.3.3.2.3.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.3.2">𝑊</ci><ci id="S3.E7.m1.4.4.1.1.2.2.3.3.2.3.3.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.2.3.3">𝑙</ci></apply></apply><apply id="S3.E7.m1.4.4.1.1.2.2.3.3.3.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.2.2.3.3.3.1.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.3">superscript</csymbol><ci id="S3.E7.m1.4.4.1.1.2.2.3.3.3.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.3.2">𝐶</ci><ci id="S3.E7.m1.4.4.1.1.2.2.3.3.3.3.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.4c">O_{\texttt{MHCA}}^{l}=\texttt{MHCA}(\texttt{Q},\texttt{K},\texttt{V}),O_{\texttt{MHCA}}^{l}\in\mathbb{R}^{H^{l}\cdot W^{l}\times C^{l}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.30" class="ltx_p">We select <math id="S3.SS2.p2.29.m1.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj\_rs}}" display="inline"><semantics id="S3.SS2.p2.29.m1.1a"><msubsup id="S3.SS2.p2.29.m1.1.1" xref="S3.SS2.p2.29.m1.1.1.cmml"><mi id="S3.SS2.p2.29.m1.1.1.2.2" xref="S3.SS2.p2.29.m1.1.1.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.29.m1.1.1.3" xref="S3.SS2.p2.29.m1.1.1.3a.cmml">Proj_rs</mtext><mi id="S3.SS2.p2.29.m1.1.1.2.3" xref="S3.SS2.p2.29.m1.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.29.m1.1b"><apply id="S3.SS2.p2.29.m1.1.1.cmml" xref="S3.SS2.p2.29.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.29.m1.1.1.1.cmml" xref="S3.SS2.p2.29.m1.1.1">subscript</csymbol><apply id="S3.SS2.p2.29.m1.1.1.2.cmml" xref="S3.SS2.p2.29.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.29.m1.1.1.2.1.cmml" xref="S3.SS2.p2.29.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.29.m1.1.1.2.2.cmml" xref="S3.SS2.p2.29.m1.1.1.2.2">𝐹</ci><ci id="S3.SS2.p2.29.m1.1.1.2.3.cmml" xref="S3.SS2.p2.29.m1.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.29.m1.1.1.3a.cmml" xref="S3.SS2.p2.29.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.29.m1.1.1.3.cmml" xref="S3.SS2.p2.29.m1.1.1.3">Proj_rs</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.29.m1.1c">F^{l}_{\texttt{Proj\_rs}}</annotation></semantics></math> as the query since we are looking to match the relevant DSI from <math id="S3.SS2.p2.30.m2.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p2.30.m2.1a"><msubsup id="S3.SS2.p2.30.m2.1.1" xref="S3.SS2.p2.30.m2.1.1.cmml"><mi id="S3.SS2.p2.30.m2.1.1.2.2" xref="S3.SS2.p2.30.m2.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.30.m2.1.1.2.3" xref="S3.SS2.p2.30.m2.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p2.30.m2.1.1.3" xref="S3.SS2.p2.30.m2.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.30.m2.1b"><apply id="S3.SS2.p2.30.m2.1.1.cmml" xref="S3.SS2.p2.30.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.30.m2.1.1.1.cmml" xref="S3.SS2.p2.30.m2.1.1">superscript</csymbol><apply id="S3.SS2.p2.30.m2.1.1.2.cmml" xref="S3.SS2.p2.30.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.30.m2.1.1.2.1.cmml" xref="S3.SS2.p2.30.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.30.m2.1.1.2.2.cmml" xref="S3.SS2.p2.30.m2.1.1.2.2">𝑂</ci><ci id="S3.SS2.p2.30.m2.1.1.2.3a.cmml" xref="S3.SS2.p2.30.m2.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p2.30.m2.1.1.2.3.cmml" xref="S3.SS2.p2.30.m2.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p2.30.m2.1.1.3.cmml" xref="S3.SS2.p2.30.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.30.m2.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math> (key) to enhance the feature maps with the extracted context information.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.4" class="ltx_p">The output of MHCA, is then reshaped back to <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mathbb{R}^{C^{l}\times H^{l}\times W^{l}}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msup id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml"><msup id="S3.SS2.p3.1.m1.1.1.3.2" xref="S3.SS2.p3.1.m1.1.1.3.2.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.2.2" xref="S3.SS2.p3.1.m1.1.1.3.2.2.cmml">C</mi><mi id="S3.SS2.p3.1.m1.1.1.3.2.3" xref="S3.SS2.p3.1.m1.1.1.3.2.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.1.m1.1.1.3.1" xref="S3.SS2.p3.1.m1.1.1.3.1.cmml">×</mo><msup id="S3.SS2.p3.1.m1.1.1.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.3.2" xref="S3.SS2.p3.1.m1.1.1.3.3.2.cmml">H</mi><mi id="S3.SS2.p3.1.m1.1.1.3.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.1.m1.1.1.3.1a" xref="S3.SS2.p3.1.m1.1.1.3.1.cmml">×</mo><msup id="S3.SS2.p3.1.m1.1.1.3.4" xref="S3.SS2.p3.1.m1.1.1.3.4.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.4.2" xref="S3.SS2.p3.1.m1.1.1.3.4.2.cmml">W</mi><mi id="S3.SS2.p3.1.m1.1.1.3.4.3" xref="S3.SS2.p3.1.m1.1.1.3.4.3.cmml">l</mi></msup></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">ℝ</ci><apply id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><times id="S3.SS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.1"></times><apply id="S3.SS2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2.2">𝐶</ci><ci id="S3.SS2.p3.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2.3">𝑙</ci></apply><apply id="S3.SS2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS2.p3.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3.3">𝑙</ci></apply><apply id="S3.SS2.p3.1.m1.1.1.3.4.cmml" xref="S3.SS2.p3.1.m1.1.1.3.4"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.3.4.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.4">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.3.4.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.4.2">𝑊</ci><ci id="S3.SS2.p3.1.m1.1.1.3.4.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.4.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\mathbb{R}^{C^{l}\times H^{l}\times W^{l}}</annotation></semantics></math> and is projected using <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mn id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.2.m2.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.cmml">×</mo><mn id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><times id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1"></times><cn type="integer" id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">3</cn><cn type="integer" id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">3\times 3</annotation></semantics></math> convolution (<math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\texttt{Conv}_{3\times 3}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2a.cmml">Conv</mtext><mrow id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml"><mn id="S3.SS2.p3.3.m3.1.1.3.2" xref="S3.SS2.p3.3.m3.1.1.3.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.3.m3.1.1.3.1" xref="S3.SS2.p3.3.m3.1.1.3.1.cmml">×</mo><mn id="S3.SS2.p3.3.m3.1.1.3.3" xref="S3.SS2.p3.3.m3.1.1.3.3.cmml">3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2a.cmml" xref="S3.SS2.p3.3.m3.1.1.2"><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">Conv</mtext></ci><apply id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3"><times id="S3.SS2.p3.3.m3.1.1.3.1.cmml" xref="S3.SS2.p3.3.m3.1.1.3.1"></times><cn type="integer" id="S3.SS2.p3.3.m3.1.1.3.2.cmml" xref="S3.SS2.p3.3.m3.1.1.3.2">3</cn><cn type="integer" id="S3.SS2.p3.3.m3.1.1.3.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\texttt{Conv}_{3\times 3}</annotation></semantics></math>). Again, GELU activation is applied to obtain the output of the CF block, <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="O_{\texttt{CF}}^{l}" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><msubsup id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2.2" xref="S3.SS2.p3.4.m4.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.4.m4.1.1.2.3" xref="S3.SS2.p3.4.m4.1.1.2.3a.cmml">CF</mtext><mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2">𝑂</ci><ci id="S3.SS2.p3.4.m4.1.1.2.3a.cmml" xref="S3.SS2.p3.4.m4.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p3.4.m4.1.1.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.2.3">CF</mtext></ci></apply><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">O_{\texttt{CF}}^{l}</annotation></semantics></math> (see Eqn. <a href="#S3.E8" title="In 3.2 Context Fusion ‣ 3 Proposed Methodology ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>). More details about the workings of MHCA are provided in the supplementary document.</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="O_{\texttt{CF}}^{l}=\texttt{GELU}(\texttt{Conv}_{3\times 3}(\texttt{RH}(O_{\texttt{MHCA}}^{l}))),O_{\texttt{CF}}^{l}\in\mathbb{R}^{C^{l}\times H^{l}\times W^{l}}." display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1"><mrow id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.3.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><msubsup id="S3.E8.m1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.1.1.3.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.E8.m1.1.1.1.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.1.1.3.2.3a.cmml">CF</mtext><mi id="S3.E8.m1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.3.3.cmml">l</mi></msubsup><mo id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E8.m1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3a.cmml">GELU</mtext><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.2a.cmml">Conv</mtext><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">×</mo><mn id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">3</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">RH</mtext><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml">MHCA</mtext><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E8.m1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.2.2.cmml"><msubsup id="S3.E8.m1.1.1.1.1.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.E8.m1.1.1.1.1.2.2.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3a.cmml">CF</mtext><mi id="S3.E8.m1.1.1.1.1.2.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.2.3.cmml">l</mi></msubsup><mo id="S3.E8.m1.1.1.1.1.2.2.1" xref="S3.E8.m1.1.1.1.1.2.2.1.cmml">∈</mo><msup id="S3.E8.m1.1.1.1.1.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.3.2" xref="S3.E8.m1.1.1.1.1.2.2.3.2.cmml">ℝ</mi><mrow id="S3.E8.m1.1.1.1.1.2.2.3.3" xref="S3.E8.m1.1.1.1.1.2.2.3.3.cmml"><msup id="S3.E8.m1.1.1.1.1.2.2.3.3.2" xref="S3.E8.m1.1.1.1.1.2.2.3.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.3.3.2.2" xref="S3.E8.m1.1.1.1.1.2.2.3.3.2.2.cmml">C</mi><mi id="S3.E8.m1.1.1.1.1.2.2.3.3.2.3" xref="S3.E8.m1.1.1.1.1.2.2.3.3.2.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E8.m1.1.1.1.1.2.2.3.3.1" xref="S3.E8.m1.1.1.1.1.2.2.3.3.1.cmml">×</mo><msup id="S3.E8.m1.1.1.1.1.2.2.3.3.3" xref="S3.E8.m1.1.1.1.1.2.2.3.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.3.3.3.2" xref="S3.E8.m1.1.1.1.1.2.2.3.3.3.2.cmml">H</mi><mi id="S3.E8.m1.1.1.1.1.2.2.3.3.3.3" xref="S3.E8.m1.1.1.1.1.2.2.3.3.3.3.cmml">l</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E8.m1.1.1.1.1.2.2.3.3.1a" xref="S3.E8.m1.1.1.1.1.2.2.3.3.1.cmml">×</mo><msup id="S3.E8.m1.1.1.1.1.2.2.3.3.4" xref="S3.E8.m1.1.1.1.1.2.2.3.3.4.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.3.3.4.2" xref="S3.E8.m1.1.1.1.1.2.2.3.3.4.2.cmml">W</mi><mi id="S3.E8.m1.1.1.1.1.2.2.3.3.4.3" xref="S3.E8.m1.1.1.1.1.2.2.3.3.4.3.cmml">l</mi></msup></mrow></msup></mrow></mrow><mo lspace="0em" id="S3.E8.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3a.cmml" xref="S3.E8.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2"></eq><apply id="S3.E8.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2.2">𝑂</ci><ci id="S3.E8.m1.1.1.1.1.1.1.3.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E8.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2.3">CF</mtext></ci></apply><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.2"></times><ci id="S3.E8.m1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E8.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3">GELU</mtext></ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.2">Conv</mtext></ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3"><times id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.1"></times><cn type="integer" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">3</cn><cn type="integer" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">3</cn></apply></apply><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">RH</mtext></ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑂</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">MHCA</mtext></ci></apply><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply></apply><apply id="S3.E8.m1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2"><in id="S3.E8.m1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1"></in><apply id="S3.E8.m1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.2">𝑂</ci><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E8.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3">CF</mtext></ci></apply><ci id="S3.E8.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3">𝑙</ci></apply><apply id="S3.E8.m1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.2">ℝ</ci><apply id="S3.E8.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3"><times id="S3.E8.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.1"></times><apply id="S3.E8.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.3.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.2">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.3.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.2.2">𝐶</ci><ci id="S3.E8.m1.1.1.1.1.2.2.3.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.2.3">𝑙</ci></apply><apply id="S3.E8.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.3.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.3">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.3.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.3.2">𝐻</ci><ci id="S3.E8.m1.1.1.1.1.2.2.3.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.3.3">𝑙</ci></apply><apply id="S3.E8.m1.1.1.1.1.2.2.3.3.4.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.4"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.3.3.4.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.4">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.3.3.4.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.4.2">𝑊</ci><ci id="S3.E8.m1.1.1.1.1.2.2.3.3.4.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3.3.4.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">O_{\texttt{CF}}^{l}=\texttt{GELU}(\texttt{Conv}_{3\times 3}(\texttt{RH}(O_{\texttt{MHCA}}^{l}))),O_{\texttt{CF}}^{l}\in\mathbb{R}^{C^{l}\times H^{l}\times W^{l}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.12" class="ltx_p">Finally, <math id="S3.SS2.p3.5.m1.1" class="ltx_Math" alttext="O_{\texttt{CF}}^{l}" display="inline"><semantics id="S3.SS2.p3.5.m1.1a"><msubsup id="S3.SS2.p3.5.m1.1.1" xref="S3.SS2.p3.5.m1.1.1.cmml"><mi id="S3.SS2.p3.5.m1.1.1.2.2" xref="S3.SS2.p3.5.m1.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.5.m1.1.1.2.3" xref="S3.SS2.p3.5.m1.1.1.2.3a.cmml">CF</mtext><mi id="S3.SS2.p3.5.m1.1.1.3" xref="S3.SS2.p3.5.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m1.1b"><apply id="S3.SS2.p3.5.m1.1.1.cmml" xref="S3.SS2.p3.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m1.1.1.1.cmml" xref="S3.SS2.p3.5.m1.1.1">superscript</csymbol><apply id="S3.SS2.p3.5.m1.1.1.2.cmml" xref="S3.SS2.p3.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m1.1.1.2.1.cmml" xref="S3.SS2.p3.5.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m1.1.1.2.2.cmml" xref="S3.SS2.p3.5.m1.1.1.2.2">𝑂</ci><ci id="S3.SS2.p3.5.m1.1.1.2.3a.cmml" xref="S3.SS2.p3.5.m1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p3.5.m1.1.1.2.3.cmml" xref="S3.SS2.p3.5.m1.1.1.2.3">CF</mtext></ci></apply><ci id="S3.SS2.p3.5.m1.1.1.3.cmml" xref="S3.SS2.p3.5.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m1.1c">O_{\texttt{CF}}^{l}</annotation></semantics></math> is concatenated with <math id="S3.SS2.p3.6.m2.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="S3.SS2.p3.6.m2.1a"><msup id="S3.SS2.p3.6.m2.1.1" xref="S3.SS2.p3.6.m2.1.1.cmml"><mi id="S3.SS2.p3.6.m2.1.1.2" xref="S3.SS2.p3.6.m2.1.1.2.cmml">F</mi><mi id="S3.SS2.p3.6.m2.1.1.3" xref="S3.SS2.p3.6.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m2.1b"><apply id="S3.SS2.p3.6.m2.1.1.cmml" xref="S3.SS2.p3.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m2.1.1.1.cmml" xref="S3.SS2.p3.6.m2.1.1">superscript</csymbol><ci id="S3.SS2.p3.6.m2.1.1.2.cmml" xref="S3.SS2.p3.6.m2.1.1.2">𝐹</ci><ci id="S3.SS2.p3.6.m2.1.1.3.cmml" xref="S3.SS2.p3.6.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m2.1c">F^{l}</annotation></semantics></math> and propagated to the next decoder level. Fig. <a href="#S3.F4" title="Figure 4 ‣ 3.2 Context Fusion ‣ 3 Proposed Methodology ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> captures the activations from the network for a rainy image (<math id="S3.SS2.p3.7.m3.1" class="ltx_Math" alttext="I_{\texttt{q}}" display="inline"><semantics id="S3.SS2.p3.7.m3.1a"><msub id="S3.SS2.p3.7.m3.1.1" xref="S3.SS2.p3.7.m3.1.1.cmml"><mi id="S3.SS2.p3.7.m3.1.1.2" xref="S3.SS2.p3.7.m3.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.7.m3.1.1.3" xref="S3.SS2.p3.7.m3.1.1.3a.cmml">q</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m3.1b"><apply id="S3.SS2.p3.7.m3.1.1.cmml" xref="S3.SS2.p3.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m3.1.1.1.cmml" xref="S3.SS2.p3.7.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m3.1.1.2.cmml" xref="S3.SS2.p3.7.m3.1.1.2">𝐼</ci><ci id="S3.SS2.p3.7.m3.1.1.3a.cmml" xref="S3.SS2.p3.7.m3.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p3.7.m3.1.1.3.cmml" xref="S3.SS2.p3.7.m3.1.1.3">q</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m3.1c">I_{\texttt{q}}</annotation></semantics></math>) prior to CF (<math id="S3.SS2.p3.8.m4.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj}}" display="inline"><semantics id="S3.SS2.p3.8.m4.1a"><msubsup id="S3.SS2.p3.8.m4.1.1" xref="S3.SS2.p3.8.m4.1.1.cmml"><mi id="S3.SS2.p3.8.m4.1.1.2.2" xref="S3.SS2.p3.8.m4.1.1.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.8.m4.1.1.3" xref="S3.SS2.p3.8.m4.1.1.3a.cmml">Proj</mtext><mi id="S3.SS2.p3.8.m4.1.1.2.3" xref="S3.SS2.p3.8.m4.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m4.1b"><apply id="S3.SS2.p3.8.m4.1.1.cmml" xref="S3.SS2.p3.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m4.1.1.1.cmml" xref="S3.SS2.p3.8.m4.1.1">subscript</csymbol><apply id="S3.SS2.p3.8.m4.1.1.2.cmml" xref="S3.SS2.p3.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m4.1.1.2.1.cmml" xref="S3.SS2.p3.8.m4.1.1">superscript</csymbol><ci id="S3.SS2.p3.8.m4.1.1.2.2.cmml" xref="S3.SS2.p3.8.m4.1.1.2.2">𝐹</ci><ci id="S3.SS2.p3.8.m4.1.1.2.3.cmml" xref="S3.SS2.p3.8.m4.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p3.8.m4.1.1.3a.cmml" xref="S3.SS2.p3.8.m4.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p3.8.m4.1.1.3.cmml" xref="S3.SS2.p3.8.m4.1.1.3">Proj</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m4.1c">F^{l}_{\texttt{Proj}}</annotation></semantics></math>) and after CF (<math id="S3.SS2.p3.9.m5.1" class="ltx_Math" alttext="O_{\texttt{CF}}^{l}" display="inline"><semantics id="S3.SS2.p3.9.m5.1a"><msubsup id="S3.SS2.p3.9.m5.1.1" xref="S3.SS2.p3.9.m5.1.1.cmml"><mi id="S3.SS2.p3.9.m5.1.1.2.2" xref="S3.SS2.p3.9.m5.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.9.m5.1.1.2.3" xref="S3.SS2.p3.9.m5.1.1.2.3a.cmml">CF</mtext><mi id="S3.SS2.p3.9.m5.1.1.3" xref="S3.SS2.p3.9.m5.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m5.1b"><apply id="S3.SS2.p3.9.m5.1.1.cmml" xref="S3.SS2.p3.9.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m5.1.1.1.cmml" xref="S3.SS2.p3.9.m5.1.1">superscript</csymbol><apply id="S3.SS2.p3.9.m5.1.1.2.cmml" xref="S3.SS2.p3.9.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m5.1.1.2.1.cmml" xref="S3.SS2.p3.9.m5.1.1">subscript</csymbol><ci id="S3.SS2.p3.9.m5.1.1.2.2.cmml" xref="S3.SS2.p3.9.m5.1.1.2.2">𝑂</ci><ci id="S3.SS2.p3.9.m5.1.1.2.3a.cmml" xref="S3.SS2.p3.9.m5.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p3.9.m5.1.1.2.3.cmml" xref="S3.SS2.p3.9.m5.1.1.2.3">CF</mtext></ci></apply><ci id="S3.SS2.p3.9.m5.1.1.3.cmml" xref="S3.SS2.p3.9.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m5.1c">O_{\texttt{CF}}^{l}</annotation></semantics></math>). Observe that prior to CF, not much attention is paid to degraded regions (rain streaks). However, after CF, the attention increases significantly on the rain streaks of <math id="S3.SS2.p3.10.m6.1" class="ltx_Math" alttext="I_{\texttt{q}}" display="inline"><semantics id="S3.SS2.p3.10.m6.1a"><msub id="S3.SS2.p3.10.m6.1.1" xref="S3.SS2.p3.10.m6.1.1.cmml"><mi id="S3.SS2.p3.10.m6.1.1.2" xref="S3.SS2.p3.10.m6.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.10.m6.1.1.3" xref="S3.SS2.p3.10.m6.1.1.3a.cmml">q</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m6.1b"><apply id="S3.SS2.p3.10.m6.1.1.cmml" xref="S3.SS2.p3.10.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m6.1.1.1.cmml" xref="S3.SS2.p3.10.m6.1.1">subscript</csymbol><ci id="S3.SS2.p3.10.m6.1.1.2.cmml" xref="S3.SS2.p3.10.m6.1.1.2">𝐼</ci><ci id="S3.SS2.p3.10.m6.1.1.3a.cmml" xref="S3.SS2.p3.10.m6.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p3.10.m6.1.1.3.cmml" xref="S3.SS2.p3.10.m6.1.1.3">q</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m6.1c">I_{\texttt{q}}</annotation></semantics></math>. Thus, the CF block effectively fuses the DSI (<math id="S3.SS2.p3.11.m7.1" class="ltx_Math" alttext="O_{\texttt{DCE}}^{l}" display="inline"><semantics id="S3.SS2.p3.11.m7.1a"><msubsup id="S3.SS2.p3.11.m7.1.1" xref="S3.SS2.p3.11.m7.1.1.cmml"><mi id="S3.SS2.p3.11.m7.1.1.2.2" xref="S3.SS2.p3.11.m7.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.11.m7.1.1.2.3" xref="S3.SS2.p3.11.m7.1.1.2.3a.cmml">DCE</mtext><mi id="S3.SS2.p3.11.m7.1.1.3" xref="S3.SS2.p3.11.m7.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m7.1b"><apply id="S3.SS2.p3.11.m7.1.1.cmml" xref="S3.SS2.p3.11.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m7.1.1.1.cmml" xref="S3.SS2.p3.11.m7.1.1">superscript</csymbol><apply id="S3.SS2.p3.11.m7.1.1.2.cmml" xref="S3.SS2.p3.11.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m7.1.1.2.1.cmml" xref="S3.SS2.p3.11.m7.1.1">subscript</csymbol><ci id="S3.SS2.p3.11.m7.1.1.2.2.cmml" xref="S3.SS2.p3.11.m7.1.1.2.2">𝑂</ci><ci id="S3.SS2.p3.11.m7.1.1.2.3a.cmml" xref="S3.SS2.p3.11.m7.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.SS2.p3.11.m7.1.1.2.3.cmml" xref="S3.SS2.p3.11.m7.1.1.2.3">DCE</mtext></ci></apply><ci id="S3.SS2.p3.11.m7.1.1.3.cmml" xref="S3.SS2.p3.11.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m7.1c">O_{\texttt{DCE}}^{l}</annotation></semantics></math>) into the features of the restoration network (<math id="S3.SS2.p3.12.m8.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="S3.SS2.p3.12.m8.1a"><msup id="S3.SS2.p3.12.m8.1.1" xref="S3.SS2.p3.12.m8.1.1.cmml"><mi id="S3.SS2.p3.12.m8.1.1.2" xref="S3.SS2.p3.12.m8.1.1.2.cmml">F</mi><mi id="S3.SS2.p3.12.m8.1.1.3" xref="S3.SS2.p3.12.m8.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m8.1b"><apply id="S3.SS2.p3.12.m8.1.1.cmml" xref="S3.SS2.p3.12.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.12.m8.1.1.1.cmml" xref="S3.SS2.p3.12.m8.1.1">superscript</csymbol><ci id="S3.SS2.p3.12.m8.1.1.2.cmml" xref="S3.SS2.p3.12.m8.1.1.2">𝐹</ci><ci id="S3.SS2.p3.12.m8.1.1.3.cmml" xref="S3.SS2.p3.12.m8.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m8.1c">F^{l}</annotation></semantics></math>).</p>
</div>
<figure id="S3.F4" class="ltx_figure">
<table id="S3.F4.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.F4.3.3" class="ltx_tr">
<th id="S3.F4.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;"><math id="S3.F4.1.1.1.m1.1" class="ltx_Math" alttext="I_{\texttt{q}}" display="inline"><semantics id="S3.F4.1.1.1.m1.1a"><msub id="S3.F4.1.1.1.m1.1.1" xref="S3.F4.1.1.1.m1.1.1.cmml"><mi id="S3.F4.1.1.1.m1.1.1.2" xref="S3.F4.1.1.1.m1.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S3.F4.1.1.1.m1.1.1.3" xref="S3.F4.1.1.1.m1.1.1.3a.cmml">q</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.F4.1.1.1.m1.1b"><apply id="S3.F4.1.1.1.m1.1.1.cmml" xref="S3.F4.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F4.1.1.1.m1.1.1.1.cmml" xref="S3.F4.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.F4.1.1.1.m1.1.1.2.cmml" xref="S3.F4.1.1.1.m1.1.1.2">𝐼</ci><ci id="S3.F4.1.1.1.m1.1.1.3a.cmml" xref="S3.F4.1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F4.1.1.1.m1.1.1.3.cmml" xref="S3.F4.1.1.1.m1.1.1.3">q</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.1.1.1.m1.1c">I_{\texttt{q}}</annotation></semantics></math></th>
<th id="S3.F4.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;">Before CF (<math id="S3.F4.2.2.2.m1.1" class="ltx_Math" alttext="F^{l}_{\texttt{Proj}}" display="inline"><semantics id="S3.F4.2.2.2.m1.1a"><msubsup id="S3.F4.2.2.2.m1.1.1" xref="S3.F4.2.2.2.m1.1.1.cmml"><mi id="S3.F4.2.2.2.m1.1.1.2.2" xref="S3.F4.2.2.2.m1.1.1.2.2.cmml">F</mi><mtext class="ltx_mathvariant_monospace" id="S3.F4.2.2.2.m1.1.1.3" xref="S3.F4.2.2.2.m1.1.1.3a.cmml">Proj</mtext><mi id="S3.F4.2.2.2.m1.1.1.2.3" xref="S3.F4.2.2.2.m1.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.F4.2.2.2.m1.1b"><apply id="S3.F4.2.2.2.m1.1.1.cmml" xref="S3.F4.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.F4.2.2.2.m1.1.1.1.cmml" xref="S3.F4.2.2.2.m1.1.1">subscript</csymbol><apply id="S3.F4.2.2.2.m1.1.1.2.cmml" xref="S3.F4.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.F4.2.2.2.m1.1.1.2.1.cmml" xref="S3.F4.2.2.2.m1.1.1">superscript</csymbol><ci id="S3.F4.2.2.2.m1.1.1.2.2.cmml" xref="S3.F4.2.2.2.m1.1.1.2.2">𝐹</ci><ci id="S3.F4.2.2.2.m1.1.1.2.3.cmml" xref="S3.F4.2.2.2.m1.1.1.2.3">𝑙</ci></apply><ci id="S3.F4.2.2.2.m1.1.1.3a.cmml" xref="S3.F4.2.2.2.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F4.2.2.2.m1.1.1.3.cmml" xref="S3.F4.2.2.2.m1.1.1.3">Proj</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.2.2.2.m1.1c">F^{l}_{\texttt{Proj}}</annotation></semantics></math>)</th>
<th id="S3.F4.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;">After CF (<math id="S3.F4.3.3.3.m1.1" class="ltx_Math" alttext="O_{\texttt{CF}}^{l}" display="inline"><semantics id="S3.F4.3.3.3.m1.1a"><msubsup id="S3.F4.3.3.3.m1.1.1" xref="S3.F4.3.3.3.m1.1.1.cmml"><mi id="S3.F4.3.3.3.m1.1.1.2.2" xref="S3.F4.3.3.3.m1.1.1.2.2.cmml">O</mi><mtext class="ltx_mathvariant_monospace" id="S3.F4.3.3.3.m1.1.1.2.3" xref="S3.F4.3.3.3.m1.1.1.2.3a.cmml">CF</mtext><mi id="S3.F4.3.3.3.m1.1.1.3" xref="S3.F4.3.3.3.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.F4.3.3.3.m1.1b"><apply id="S3.F4.3.3.3.m1.1.1.cmml" xref="S3.F4.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S3.F4.3.3.3.m1.1.1.1.cmml" xref="S3.F4.3.3.3.m1.1.1">superscript</csymbol><apply id="S3.F4.3.3.3.m1.1.1.2.cmml" xref="S3.F4.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S3.F4.3.3.3.m1.1.1.2.1.cmml" xref="S3.F4.3.3.3.m1.1.1">subscript</csymbol><ci id="S3.F4.3.3.3.m1.1.1.2.2.cmml" xref="S3.F4.3.3.3.m1.1.1.2.2">𝑂</ci><ci id="S3.F4.3.3.3.m1.1.1.2.3a.cmml" xref="S3.F4.3.3.3.m1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.F4.3.3.3.m1.1.1.2.3.cmml" xref="S3.F4.3.3.3.m1.1.1.2.3">CF</mtext></ci></apply><ci id="S3.F4.3.3.3.m1.1.1.3.cmml" xref="S3.F4.3.3.3.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.3.3.3.m1.1c">O_{\texttt{CF}}^{l}</annotation></semantics></math>)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.F4.6.6" class="ltx_tr">
<td id="S3.F4.4.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/figures/feature_vis/images/50_rainl.png" id="S3.F4.4.4.1.g1" class="ltx_graphics ltx_img_landscape" width="162" height="47" alt="Refer to caption"></td>
<td id="S3.F4.5.5.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/figures/feature_vis/paired/1inp_8.jpg" id="S3.F4.5.5.2.g1" class="ltx_graphics ltx_img_landscape" width="162" height="47" alt="Refer to caption"></td>
<td id="S3.F4.6.6.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/figures/feature_vis/paired/1_8.jpg" id="S3.F4.6.6.3.g1" class="ltx_graphics ltx_img_landscape" width="162" height="47" alt="Refer to caption"></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Comparison of activations of the restoration network prior to CF and after CF. Yellow-High, Blue-Low.</figcaption>
</figure>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.2" class="ltx_p">The process of degradation-context extraction and context fusion is repeated at each level, <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">l</annotation></semantics></math>, of the decoder. This multi-scale fusion at each decoder level <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">l</annotation></semantics></math>, ensures that the context information is retained through the entire decoder, thereby enhancing the quality of image reconstruction.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Quantitative comparisons of AWRaCLe with SOTA on the test sets described in Sec. <a href="#S4.SS2" title="4.2 Datasets ‣ 4 Experimental Results ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>. The values indicated are placeholders for PSNR/SSIM. Degradation type (S-Snow, R-Rain, H-Haze) is indicated within brackets. The best result is in bold, and second best is underlined.</figcaption>
<table id="S3.T1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.1.1.1.1.1" class="ltx_p" style="width:68.3pt;"><span id="S3.T1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Datasets</span></span>
</span>
</th>
<th id="S3.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;" colspan="8"><span id="S3.T1.1.1.1.2.1" class="ltx_text ltx_font_bold">Methods</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.2.1" class="ltx_tr">
<td id="S3.T1.1.2.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.2.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.2.1.1.1.1" class="ltx_p" style="width:68.3pt;"></span>
</span>
</td>
<td id="S3.T1.1.2.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.2.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.2.1.2.1.1" class="ltx_p" style="width:51.2pt;">WeatherDiff
<br class="ltx_break ltx_centering">(TPAMI’23)</span>
</span>
</td>
<td id="S3.T1.1.2.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.2.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.2.1.3.1.1" class="ltx_p" style="width:45.5pt;">WGWS
<br class="ltx_break ltx_centering">(CVPR’23)</span>
</span>
</td>
<td id="S3.T1.1.2.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.2.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.2.1.4.1.1" class="ltx_p" style="width:45.5pt;">TSMC
<br class="ltx_break ltx_centering">(CVPR’22)</span>
</span>
</td>
<td id="S3.T1.1.2.1.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.2.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.2.1.5.1.1" class="ltx_p" style="width:45.5pt;">AirNet
<br class="ltx_break ltx_centering">(CVPR’22)</span>
</span>
</td>
<td id="S3.T1.1.2.1.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.2.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.2.1.6.1.1" class="ltx_p" style="width:48.4pt;">PromptIR
<br class="ltx_break ltx_centering">(NeurIPS’23)</span>
</span>
</td>
<td id="S3.T1.1.2.1.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.2.1.7.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.2.1.7.1.1" class="ltx_p" style="width:48.4pt;">Painter
<br class="ltx_break ltx_centering">(CVPR’23)</span>
</span>
</td>
<td id="S3.T1.1.2.1.8" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.2.1.8.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.2.1.8.1.1" class="ltx_p" style="width:48.4pt;">DiffUIR
<br class="ltx_break ltx_centering">(CVPR’24)</span>
</span>
</td>
<td id="S3.T1.1.2.1.9" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.2.1.9.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.2.1.9.1.1" class="ltx_p" style="width:45.5pt;">AWRaCLe</span>
</span>
</td>
</tr>
<tr id="S3.T1.1.3.2" class="ltx_tr">
<td id="S3.T1.1.3.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.3.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.3.2.1.1.1" class="ltx_p" style="width:68.3pt;">SOTS Outdoor (H)</span>
</span>
</td>
<td id="S3.T1.1.3.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.3.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.3.2.2.1.1" class="ltx_p" style="width:51.2pt;">28.00/0.966</span>
</span>
</td>
<td id="S3.T1.1.3.2.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.3.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.3.2.3.1.1" class="ltx_p" style="width:45.5pt;">30.49/0.976</span>
</span>
</td>
<td id="S3.T1.1.3.2.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.3.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.3.2.4.1.1" class="ltx_p" style="width:45.5pt;">27.88/0.920</span>
</span>
</td>
<td id="S3.T1.1.3.2.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.3.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.3.2.5.1.1" class="ltx_p" style="width:45.5pt;">27.6/0.963</span>
</span>
</td>
<td id="S3.T1.1.3.2.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.3.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.3.2.6.1.1" class="ltx_p" style="width:48.4pt;">30.46/0.977</span>
</span>
</td>
<td id="S3.T1.1.3.2.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.3.2.7.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.3.2.7.1.1" class="ltx_p" style="width:48.4pt;">28.00/0.945</span>
</span>
</td>
<td id="S3.T1.1.3.2.8" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.3.2.8.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.3.2.8.1.1" class="ltx_p" style="width:48.4pt;"><span id="S3.T1.1.3.2.8.1.1.1" class="ltx_text ltx_framed ltx_framed_underline">30.97</span>/<span id="S3.T1.1.3.2.8.1.1.2" class="ltx_text ltx_align_center ltx_framed ltx_framed_underline">0.977</span></span>
</span>
</td>
<td id="S3.T1.1.3.2.9" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.3.2.9.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.3.2.9.1.1" class="ltx_p" style="width:45.5pt;"><span id="S3.T1.1.3.2.9.1.1.1" class="ltx_text ltx_font_bold">31.65</span>/<span id="S3.T1.1.3.2.9.1.1.2" class="ltx_text ltx_font_bold ltx_align_center">0.981</span></span>
</span>
</td>
</tr>
<tr id="S3.T1.1.4.3" class="ltx_tr">
<td id="S3.T1.1.4.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.4.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.4.3.1.1.1" class="ltx_p" style="width:68.3pt;">Rain100H (R)</span>
</span>
</td>
<td id="S3.T1.1.4.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.4.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.4.3.2.1.1" class="ltx_p" style="width:51.2pt;">25.84/<span id="S3.T1.1.4.3.2.1.1.1" class="ltx_text ltx_align_center ltx_framed ltx_framed_underline">0.824</span></span>
</span>
</td>
<td id="S3.T1.1.4.3.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.4.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.4.3.3.1.1" class="ltx_p" style="width:45.5pt;">13.91/0.410</span>
</span>
</td>
<td id="S3.T1.1.4.3.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.4.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.4.3.4.1.1" class="ltx_p" style="width:45.5pt;">26.48/0.822</span>
</span>
</td>
<td id="S3.T1.1.4.3.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.4.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.4.3.5.1.1" class="ltx_p" style="width:45.5pt;">22.96/0.692</span>
</span>
</td>
<td id="S3.T1.1.4.3.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.4.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.4.3.6.1.1" class="ltx_p" style="width:48.4pt;">26.32/0.821</span>
</span>
</td>
<td id="S3.T1.1.4.3.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.4.3.7.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.4.3.7.1.1" class="ltx_p" style="width:48.4pt;">22.50/0.792</span>
</span>
</td>
<td id="S3.T1.1.4.3.8" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.4.3.8.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.4.3.8.1.1" class="ltx_p" style="width:48.4pt;"><span id="S3.T1.1.4.3.8.1.1.1" class="ltx_text ltx_framed ltx_framed_underline">26.49</span>/0.788</span>
</span>
</td>
<td id="S3.T1.1.4.3.9" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.4.3.9.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.4.3.9.1.1" class="ltx_p" style="width:45.5pt;"><span id="S3.T1.1.4.3.9.1.1.1" class="ltx_text ltx_font_bold">27.20</span>/<span id="S3.T1.1.4.3.9.1.1.2" class="ltx_text ltx_font_bold ltx_align_center">0.840</span></span>
</span>
</td>
</tr>
<tr id="S3.T1.1.5.4" class="ltx_tr">
<td id="S3.T1.1.5.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.5.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.5.4.1.1.1" class="ltx_p" style="width:68.3pt;">Rain100L (R)</span>
</span>
</td>
<td id="S3.T1.1.5.4.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.5.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.5.4.2.1.1" class="ltx_p" style="width:51.2pt;">27.39/0.895</span>
</span>
</td>
<td id="S3.T1.1.5.4.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.5.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.5.4.3.1.1" class="ltx_p" style="width:45.5pt;">27.2/0.86</span>
</span>
</td>
<td id="S3.T1.1.5.4.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.5.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.5.4.4.1.1" class="ltx_p" style="width:45.5pt;">29.88/0.920</span>
</span>
</td>
<td id="S3.T1.1.5.4.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.5.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.5.4.5.1.1" class="ltx_p" style="width:45.5pt;">23.97/0.805</span>
</span>
</td>
<td id="S3.T1.1.5.4.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.5.4.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.5.4.6.1.1" class="ltx_p" style="width:48.4pt;">28.87/0.888</span>
</span>
</td>
<td id="S3.T1.1.5.4.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.5.4.7.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.5.4.7.1.1" class="ltx_p" style="width:48.4pt;">23.19/0.900</span>
</span>
</td>
<td id="S3.T1.1.5.4.8" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.5.4.8.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.5.4.8.1.1" class="ltx_p" style="width:48.4pt;"><span id="S3.T1.1.5.4.8.1.1.1" class="ltx_text ltx_framed ltx_framed_underline">31.83</span>/<span id="S3.T1.1.5.4.8.1.1.2" class="ltx_text ltx_align_center ltx_framed ltx_framed_underline">0.932</span></span>
</span>
</td>
<td id="S3.T1.1.5.4.9" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.5.4.9.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.5.4.9.1.1" class="ltx_p" style="width:45.5pt;"><span id="S3.T1.1.5.4.9.1.1.1" class="ltx_text ltx_font_bold">35.71</span>/<span id="S3.T1.1.5.4.9.1.1.2" class="ltx_text ltx_font_bold ltx_align_center">0.966</span></span>
</span>
</td>
</tr>
<tr id="S3.T1.1.6.5" class="ltx_tr">
<td id="S3.T1.1.6.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.6.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.6.5.1.1.1" class="ltx_p" style="width:68.3pt;">Snow100k (S)</span>
</span>
</td>
<td id="S3.T1.1.6.5.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.6.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.6.5.2.1.1" class="ltx_p" style="width:51.2pt;">31.33/0.910</span>
</span>
</td>
<td id="S3.T1.1.6.5.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.6.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.6.5.3.1.1" class="ltx_p" style="width:45.5pt;">32.58/0.921</span>
</span>
</td>
<td id="S3.T1.1.6.5.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.6.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.6.5.4.1.1" class="ltx_p" style="width:45.5pt;">32.28/0.916</span>
</span>
</td>
<td id="S3.T1.1.6.5.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.6.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.6.5.5.1.1" class="ltx_p" style="width:45.5pt;">29.22/0.884</span>
</span>
</td>
<td id="S3.T1.1.6.5.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.6.5.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.6.5.6.1.1" class="ltx_p" style="width:48.4pt;"><span id="S3.T1.1.6.5.6.1.1.1" class="ltx_text ltx_framed ltx_framed_underline">33.39</span>/<span id="S3.T1.1.6.5.6.1.1.2" class="ltx_text ltx_align_center ltx_framed ltx_framed_underline">0.932</span></span>
</span>
</td>
<td id="S3.T1.1.6.5.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.6.5.7.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.6.5.7.1.1" class="ltx_p" style="width:48.4pt;">27.87/0.871</span>
</span>
</td>
<td id="S3.T1.1.6.5.8" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.6.5.8.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.6.5.8.1.1" class="ltx_p" style="width:48.4pt;">31.77/0.915</span>
</span>
</td>
<td id="S3.T1.1.6.5.9" class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.6.5.9.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.6.5.9.1.1" class="ltx_p" style="width:45.5pt;"><span id="S3.T1.1.6.5.9.1.1.1" class="ltx_text ltx_font_bold">33.48</span>/<span id="S3.T1.1.6.5.9.1.1.2" class="ltx_text ltx_font_bold ltx_align_center">0.934</span></span>
</span>
</td>
</tr>
<tr id="S3.T1.1.7.6" class="ltx_tr">
<td id="S3.T1.1.7.6.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.7.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.7.6.1.1.1" class="ltx_p" style="width:68.3pt;">Average</span>
</span>
</td>
<td id="S3.T1.1.7.6.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.7.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.7.6.2.1.1" class="ltx_p" style="width:51.2pt;">28.14/0.898</span>
</span>
</td>
<td id="S3.T1.1.7.6.3" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.7.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.7.6.3.1.1" class="ltx_p" style="width:45.5pt;">26.04/0.791</span>
</span>
</td>
<td id="S3.T1.1.7.6.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.7.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.7.6.4.1.1" class="ltx_p" style="width:45.5pt;">29.13/0.894</span>
</span>
</td>
<td id="S3.T1.1.7.6.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.7.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.7.6.5.1.1" class="ltx_p" style="width:45.5pt;">25.93/0.836</span>
</span>
</td>
<td id="S3.T1.1.7.6.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.7.6.6.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.7.6.6.1.1" class="ltx_p" style="width:48.4pt;">29.76/<span id="S3.T1.1.7.6.6.1.1.1" class="ltx_text ltx_align_center ltx_framed ltx_framed_underline">0.904</span></span>
</span>
</td>
<td id="S3.T1.1.7.6.7" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.7.6.7.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.7.6.7.1.1" class="ltx_p" style="width:48.4pt;">26.36/0.877</span>
</span>
</td>
<td id="S3.T1.1.7.6.8" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.7.6.8.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.7.6.8.1.1" class="ltx_p" style="width:48.4pt;"><span id="S3.T1.1.7.6.8.1.1.1" class="ltx_text ltx_framed ltx_framed_underline">30.26</span>/0.903</span>
</span>
</td>
<td id="S3.T1.1.7.6.9" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S3.T1.1.7.6.9.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.7.6.9.1.1" class="ltx_p" style="width:45.5pt;"><span id="S3.T1.1.7.6.9.1.1.1" class="ltx_text ltx_font_bold">32.01</span>/<span id="S3.T1.1.7.6.9.1.1.2" class="ltx_text ltx_font_bold ltx_align_center">0.930</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Results</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we explain our implementation, datasets used, results and ablation studies.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Implementation Details</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.11" class="ltx_p">Our method is trained using the AdamW optimizer with a cosine annealing Learning Rate (LR) scheduler. We train for a total of <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><cn type="integer" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">100</annotation></semantics></math> epochs on <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><cn type="integer" id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">8</annotation></semantics></math> RTX A5000 GPUs with a batch size of <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="32" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mn id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><cn type="integer" id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">32</annotation></semantics></math>, initial LR<math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="=2\times 10^{-4}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml"></mi><mo id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml"><mn id="S4.SS1.p1.4.m4.1.1.3.2" xref="S4.SS1.p1.4.m4.1.1.3.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.4.m4.1.1.3.1" xref="S4.SS1.p1.4.m4.1.1.3.1.cmml">×</mo><msup id="S4.SS1.p1.4.m4.1.1.3.3" xref="S4.SS1.p1.4.m4.1.1.3.3.cmml"><mn id="S4.SS1.p1.4.m4.1.1.3.3.2" xref="S4.SS1.p1.4.m4.1.1.3.3.2.cmml">10</mn><mrow id="S4.SS1.p1.4.m4.1.1.3.3.3" xref="S4.SS1.p1.4.m4.1.1.3.3.3.cmml"><mo id="S4.SS1.p1.4.m4.1.1.3.3.3a" xref="S4.SS1.p1.4.m4.1.1.3.3.3.cmml">−</mo><mn id="S4.SS1.p1.4.m4.1.1.3.3.3.2" xref="S4.SS1.p1.4.m4.1.1.3.3.3.2.cmml">4</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><eq id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"></eq><csymbol cd="latexml" id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">absent</csymbol><apply id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3"><times id="S4.SS1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.3.1"></times><cn type="integer" id="S4.SS1.p1.4.m4.1.1.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.3.2">2</cn><apply id="S4.SS1.p1.4.m4.1.1.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3">superscript</csymbol><cn type="integer" id="S4.SS1.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.2">10</cn><apply id="S4.SS1.p1.4.m4.1.1.3.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.3"><minus id="S4.SS1.p1.4.m4.1.1.3.3.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.3"></minus><cn type="integer" id="S4.SS1.p1.4.m4.1.1.3.3.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.3.2">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">=2\times 10^{-4}</annotation></semantics></math>, weight decay<math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="=0.01" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml"></mi><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><eq id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"></eq><csymbol cd="latexml" id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">absent</csymbol><cn type="float" id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">=0.01</annotation></semantics></math>, <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mrow id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><msub id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml"><mi id="S4.SS1.p1.6.m6.1.1.2.2" xref="S4.SS1.p1.6.m6.1.1.2.2.cmml">β</mi><mn id="S4.SS1.p1.6.m6.1.1.2.3" xref="S4.SS1.p1.6.m6.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS1.p1.6.m6.1.1.1" xref="S4.SS1.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><eq id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1"></eq><apply id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.2.1.cmml" xref="S4.SS1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.6.m6.1.1.2.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2.2">𝛽</ci><cn type="integer" id="S4.SS1.p1.6.m6.1.1.2.3.cmml" xref="S4.SS1.p1.6.m6.1.1.2.3">1</cn></apply><cn type="float" id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">\beta_{1}=0.9</annotation></semantics></math>, <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="\beta_{2}=0.999" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mrow id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><msub id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2.2" xref="S4.SS1.p1.7.m7.1.1.2.2.cmml">β</mi><mn id="S4.SS1.p1.7.m7.1.1.2.3" xref="S4.SS1.p1.7.m7.1.1.2.3.cmml">2</mn></msub><mo id="S4.SS1.p1.7.m7.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><eq id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1"></eq><apply id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.2.1.cmml" xref="S4.SS1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.2.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2.2">𝛽</ci><cn type="integer" id="S4.SS1.p1.7.m7.1.1.2.3.cmml" xref="S4.SS1.p1.7.m7.1.1.2.3">2</cn></apply><cn type="float" id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">\beta_{2}=0.999</annotation></semantics></math> and warm-up for <math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="15" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mn id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><cn type="integer" id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">15</annotation></semantics></math> epochs. We use random crop size of <math id="S4.SS1.p1.9.m9.1" class="ltx_Math" alttext="128\times 128" display="inline"><semantics id="S4.SS1.p1.9.m9.1a"><mrow id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml"><mn id="S4.SS1.p1.9.m9.1.1.2" xref="S4.SS1.p1.9.m9.1.1.2.cmml">128</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.9.m9.1.1.1" xref="S4.SS1.p1.9.m9.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.9.m9.1.1.3" xref="S4.SS1.p1.9.m9.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><apply id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1"><times id="S4.SS1.p1.9.m9.1.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1.1"></times><cn type="integer" id="S4.SS1.p1.9.m9.1.1.2.cmml" xref="S4.SS1.p1.9.m9.1.1.2">128</cn><cn type="integer" id="S4.SS1.p1.9.m9.1.1.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">128\times 128</annotation></semantics></math> pixels, and random flipping as data augmentations. The loss function used is the <math id="S4.SS1.p1.10.m10.1" class="ltx_Math" alttext="L_{1}" display="inline"><semantics id="S4.SS1.p1.10.m10.1a"><msub id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml"><mi id="S4.SS1.p1.10.m10.1.1.2" xref="S4.SS1.p1.10.m10.1.1.2.cmml">L</mi><mn id="S4.SS1.p1.10.m10.1.1.3" xref="S4.SS1.p1.10.m10.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><apply id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.p1.10.m10.1.1.2.cmml" xref="S4.SS1.p1.10.m10.1.1.2">𝐿</ci><cn type="integer" id="S4.SS1.p1.10.m10.1.1.3.cmml" xref="S4.SS1.p1.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">L_{1}</annotation></semantics></math> loss. For extracting CLIP features, no augmentations are used and the images in the context pair are resized to <math id="S4.SS1.p1.11.m11.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="S4.SS1.p1.11.m11.1a"><mrow id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml"><mn id="S4.SS1.p1.11.m11.1.1.2" xref="S4.SS1.p1.11.m11.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.11.m11.1.1.1" xref="S4.SS1.p1.11.m11.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.11.m11.1.1.3" xref="S4.SS1.p1.11.m11.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><apply id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1"><times id="S4.SS1.p1.11.m11.1.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1.1"></times><cn type="integer" id="S4.SS1.p1.11.m11.1.1.2.cmml" xref="S4.SS1.p1.11.m11.1.1.2">224</cn><cn type="integer" id="S4.SS1.p1.11.m11.1.1.3.cmml" xref="S4.SS1.p1.11.m11.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">224\times 224</annotation></semantics></math>. Our implementation utilized PyTorch <cite class="ltx_cite ltx_citemacro_citep">(Paszke et al. <a href="#bib.bib27" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Datasets</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.9" class="ltx_p"><span id="S4.SS2.p1.9.1" class="ltx_text ltx_font_bold">Training.</span> We use the Snow100k <cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a href="#bib.bib23" title="" class="ltx_ref">2018</a>)</cite>, synthetic rain <cite class="ltx_cite ltx_citemacro_citep">(Zamir et al. <a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite> datasets (SRD) and RESIDE <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite> to train our method for all-weather restoration. The training split of Snow100k contains <math id="S4.SS2.p1.1.m1.2" class="ltx_Math" alttext="50,000" display="inline"><semantics id="S4.SS2.p1.1.m1.2a"><mrow id="S4.SS2.p1.1.m1.2.3.2" xref="S4.SS2.p1.1.m1.2.3.1.cmml"><mn id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">50</mn><mo id="S4.SS2.p1.1.m1.2.3.2.1" xref="S4.SS2.p1.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS2.p1.1.m1.2.2" xref="S4.SS2.p1.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.2b"><list id="S4.SS2.p1.1.m1.2.3.1.cmml" xref="S4.SS2.p1.1.m1.2.3.2"><cn type="integer" id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">50</cn><cn type="integer" id="S4.SS2.p1.1.m1.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.2c">50,000</annotation></semantics></math> synthetic snow images along with the corresponding clean images. For deraining, we use the training split of SRD containing <math id="S4.SS2.p1.2.m2.2" class="ltx_Math" alttext="13,711" display="inline"><semantics id="S4.SS2.p1.2.m2.2a"><mrow id="S4.SS2.p1.2.m2.2.3.2" xref="S4.SS2.p1.2.m2.2.3.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">13</mn><mo id="S4.SS2.p1.2.m2.2.3.2.1" xref="S4.SS2.p1.2.m2.2.3.1.cmml">,</mo><mn id="S4.SS2.p1.2.m2.2.2" xref="S4.SS2.p1.2.m2.2.2.cmml">711</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.2b"><list id="S4.SS2.p1.2.m2.2.3.1.cmml" xref="S4.SS2.p1.2.m2.2.3.2"><cn type="integer" id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">13</cn><cn type="integer" id="S4.SS2.p1.2.m2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2">711</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.2c">13,711</annotation></semantics></math> clean-synthetic rainy image pairs. For dehazing, we use the Outdoor Training Set (OTS) of RESIDE which consists of <math id="S4.SS2.p1.3.m3.2" class="ltx_Math" alttext="72,135" display="inline"><semantics id="S4.SS2.p1.3.m3.2a"><mrow id="S4.SS2.p1.3.m3.2.3.2" xref="S4.SS2.p1.3.m3.2.3.1.cmml"><mn id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">72</mn><mo id="S4.SS2.p1.3.m3.2.3.2.1" xref="S4.SS2.p1.3.m3.2.3.1.cmml">,</mo><mn id="S4.SS2.p1.3.m3.2.2" xref="S4.SS2.p1.3.m3.2.2.cmml">135</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.2b"><list id="S4.SS2.p1.3.m3.2.3.1.cmml" xref="S4.SS2.p1.3.m3.2.3.2"><cn type="integer" id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">72</cn><cn type="integer" id="S4.SS2.p1.3.m3.2.2.cmml" xref="S4.SS2.p1.3.m3.2.2">135</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.2c">72,135</annotation></semantics></math> clean-synthetic hazy image pairs for training. We then split the training sets into two categories, each respectively consisting of heavy and light corruptions for better context extraction during training. More details about the splitting strategy can be found in the supplementary. In summary, we obtain <math id="S4.SS2.p1.4.m4.2" class="ltx_Math" alttext="12,077" display="inline"><semantics id="S4.SS2.p1.4.m4.2a"><mrow id="S4.SS2.p1.4.m4.2.3.2" xref="S4.SS2.p1.4.m4.2.3.1.cmml"><mn id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">12</mn><mo id="S4.SS2.p1.4.m4.2.3.2.1" xref="S4.SS2.p1.4.m4.2.3.1.cmml">,</mo><mn id="S4.SS2.p1.4.m4.2.2" xref="S4.SS2.p1.4.m4.2.2.cmml">077</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.2b"><list id="S4.SS2.p1.4.m4.2.3.1.cmml" xref="S4.SS2.p1.4.m4.2.3.2"><cn type="integer" id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">12</cn><cn type="integer" id="S4.SS2.p1.4.m4.2.2.cmml" xref="S4.SS2.p1.4.m4.2.2">077</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.2c">12,077</annotation></semantics></math> light rain images, <math id="S4.SS2.p1.5.m5.2" class="ltx_Math" alttext="1,634" display="inline"><semantics id="S4.SS2.p1.5.m5.2a"><mrow id="S4.SS2.p1.5.m5.2.3.2" xref="S4.SS2.p1.5.m5.2.3.1.cmml"><mn id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">1</mn><mo id="S4.SS2.p1.5.m5.2.3.2.1" xref="S4.SS2.p1.5.m5.2.3.1.cmml">,</mo><mn id="S4.SS2.p1.5.m5.2.2" xref="S4.SS2.p1.5.m5.2.2.cmml">634</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.2b"><list id="S4.SS2.p1.5.m5.2.3.1.cmml" xref="S4.SS2.p1.5.m5.2.3.2"><cn type="integer" id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">1</cn><cn type="integer" id="S4.SS2.p1.5.m5.2.2.cmml" xref="S4.SS2.p1.5.m5.2.2">634</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.2c">1,634</annotation></semantics></math> heavy rain images, <math id="S4.SS2.p1.6.m6.2" class="ltx_Math" alttext="38,921" display="inline"><semantics id="S4.SS2.p1.6.m6.2a"><mrow id="S4.SS2.p1.6.m6.2.3.2" xref="S4.SS2.p1.6.m6.2.3.1.cmml"><mn id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">38</mn><mo id="S4.SS2.p1.6.m6.2.3.2.1" xref="S4.SS2.p1.6.m6.2.3.1.cmml">,</mo><mn id="S4.SS2.p1.6.m6.2.2" xref="S4.SS2.p1.6.m6.2.2.cmml">921</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.2b"><list id="S4.SS2.p1.6.m6.2.3.1.cmml" xref="S4.SS2.p1.6.m6.2.3.2"><cn type="integer" id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">38</cn><cn type="integer" id="S4.SS2.p1.6.m6.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2">921</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.2c">38,921</annotation></semantics></math> light haze images, <math id="S4.SS2.p1.7.m7.2" class="ltx_Math" alttext="33,214" display="inline"><semantics id="S4.SS2.p1.7.m7.2a"><mrow id="S4.SS2.p1.7.m7.2.3.2" xref="S4.SS2.p1.7.m7.2.3.1.cmml"><mn id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">33</mn><mo id="S4.SS2.p1.7.m7.2.3.2.1" xref="S4.SS2.p1.7.m7.2.3.1.cmml">,</mo><mn id="S4.SS2.p1.7.m7.2.2" xref="S4.SS2.p1.7.m7.2.2.cmml">214</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.2b"><list id="S4.SS2.p1.7.m7.2.3.1.cmml" xref="S4.SS2.p1.7.m7.2.3.2"><cn type="integer" id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">33</cn><cn type="integer" id="S4.SS2.p1.7.m7.2.2.cmml" xref="S4.SS2.p1.7.m7.2.2">214</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.2c">33,214</annotation></semantics></math> heavy haze images, <math id="S4.SS2.p1.8.m8.2" class="ltx_Math" alttext="37,122" display="inline"><semantics id="S4.SS2.p1.8.m8.2a"><mrow id="S4.SS2.p1.8.m8.2.3.2" xref="S4.SS2.p1.8.m8.2.3.1.cmml"><mn id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">37</mn><mo id="S4.SS2.p1.8.m8.2.3.2.1" xref="S4.SS2.p1.8.m8.2.3.1.cmml">,</mo><mn id="S4.SS2.p1.8.m8.2.2" xref="S4.SS2.p1.8.m8.2.2.cmml">122</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.2b"><list id="S4.SS2.p1.8.m8.2.3.1.cmml" xref="S4.SS2.p1.8.m8.2.3.2"><cn type="integer" id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">37</cn><cn type="integer" id="S4.SS2.p1.8.m8.2.2.cmml" xref="S4.SS2.p1.8.m8.2.2">122</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.2c">37,122</annotation></semantics></math> light snow images and <math id="S4.SS2.p1.9.m9.2" class="ltx_Math" alttext="12,878" display="inline"><semantics id="S4.SS2.p1.9.m9.2a"><mrow id="S4.SS2.p1.9.m9.2.3.2" xref="S4.SS2.p1.9.m9.2.3.1.cmml"><mn id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">12</mn><mo id="S4.SS2.p1.9.m9.2.3.2.1" xref="S4.SS2.p1.9.m9.2.3.1.cmml">,</mo><mn id="S4.SS2.p1.9.m9.2.2" xref="S4.SS2.p1.9.m9.2.2.cmml">878</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.2b"><list id="S4.SS2.p1.9.m9.2.3.1.cmml" xref="S4.SS2.p1.9.m9.2.3.2"><cn type="integer" id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">12</cn><cn type="integer" id="S4.SS2.p1.9.m9.2.2.cmml" xref="S4.SS2.p1.9.m9.2.2">878</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.2c">12,878</annotation></semantics></math> heavy snow images for training.
<br class="ltx_break"></p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.3" class="ltx_p"><span id="S4.SS2.p2.3.1" class="ltx_text ltx_font_bold">Evaluation. </span>We evaluate all the methods for desnowing, deraining and dehazing. For desnowing, we use the test split of Snow100k dataset containing <math id="S4.SS2.p2.1.m1.2" class="ltx_Math" alttext="50,000" display="inline"><semantics id="S4.SS2.p2.1.m1.2a"><mrow id="S4.SS2.p2.1.m1.2.3.2" xref="S4.SS2.p2.1.m1.2.3.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">50</mn><mo id="S4.SS2.p2.1.m1.2.3.2.1" xref="S4.SS2.p2.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS2.p2.1.m1.2.2" xref="S4.SS2.p2.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.2b"><list id="S4.SS2.p2.1.m1.2.3.1.cmml" xref="S4.SS2.p2.1.m1.2.3.2"><cn type="integer" id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">50</cn><cn type="integer" id="S4.SS2.p2.1.m1.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.2c">50,000</annotation></semantics></math> paired images. For deraining, we evaluate the methods on Rain100H <cite class="ltx_cite ltx_citemacro_citep">(Yang et al. <a href="#bib.bib45" title="" class="ltx_ref">2017</a>)</cite> for heavy rain and Rain100L <cite class="ltx_cite ltx_citemacro_citep">(Yang et al. <a href="#bib.bib45" title="" class="ltx_ref">2017</a>)</cite> for light rain, each consisting of <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mn id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><cn type="integer" id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">100</annotation></semantics></math> paired images. For dehazing, we use RESIDE’s Synthetic Objective Testing Set (SOTS) outdoor containing <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="500" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mn id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><cn type="integer" id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">500</annotation></semantics></math> paired images.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Comparisons</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We evaluate and compare the performance of AWRaCLe with seven recent AWIR approaches on the test sets described in Sec. <a href="#S4.SS2" title="4.2 Datasets ‣ 4 Experimental Results ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>. The methods we use for comparison are WeatherDiff <cite class="ltx_cite ltx_citemacro_citep">(Özdenizci and Legenstein <a href="#bib.bib25" title="" class="ltx_ref">2023</a>)</cite>, WGWS <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al. <a href="#bib.bib55" title="" class="ltx_ref">2023</a>)</cite>, TSMC <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib11" title="" class="ltx_ref">2022b</a>)</cite>, AirNet <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib18" title="" class="ltx_ref">2022</a>)</cite>, PromptIR <cite class="ltx_cite ltx_citemacro_citep">(Potlapalli et al. <a href="#bib.bib29" title="" class="ltx_ref">2024</a>)</cite> and DiffUIR <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al. <a href="#bib.bib54" title="" class="ltx_ref">2024</a>)</cite>. Additionally, we also compare with Painter <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib38" title="" class="ltx_ref">2023a</a>)</cite> and show that AWRaCLe uses context much more effectively. DiffUIR is a very recent SOTA method published in CVPR 2024. For a fair comparison, WeatherDiff, WGWS, TSMC, AirNet, PromptIR, DiffUIR and Painter are retrained on the training sets mentioned in Sec. <a href="#S4.SS2" title="4.2 Datasets ‣ 4 Experimental Results ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>.
Some recent approaches such as <cite class="ltx_cite ltx_citemacro_citep">(Patil et al. <a href="#bib.bib28" title="" class="ltx_ref">2023</a>; Zhang et al. <a href="#bib.bib51" title="" class="ltx_ref">2024</a>; Xu et al. <a href="#bib.bib43" title="" class="ltx_ref">2024</a>; Ai et al. <a href="#bib.bib1" title="" class="ltx_ref">2024</a>)</cite> have no training code, and each method is trained on different datasets. Although the authors of <cite class="ltx_cite ltx_citemacro_citep">(Lin et al. <a href="#bib.bib22" title="" class="ltx_ref">2024</a>)</cite> have released training scripts, they have not provided adequate instructions for their use. Hence, we are unable to compare with these methods. We also do not compare with methods for single weather removal as our method is proposed specifically to deal with multiple degradations.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">Quantitative and Qualitative results.</span>
We discuss the performance of all the methods on the test sets described in Sec. <a href="#S4.SS2" title="4.2 Datasets ‣ 4 Experimental Results ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>. Table <a href="#S3.T1" title="Table 1 ‣ 3.2 Context Fusion ‣ 3 Proposed Methodology ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> contains the Peak Signal to Noise Ratio (PSNR) and Structural Similarity (SSIM) values for each method on these test sets. To evaluate AWRaCLe and Painter, we choose the context pair for each test set randomly from their respective training sets, i.e., for every test image, the context pair is chosen randomly. We resort to random selection for fairness.
Moreover, the context pair is chosen from the training set, thus, requiring only the knowledge of the type of degradation during inference. From Table <a href="#S3.T1" title="Table 1 ‣ 3.2 Context Fusion ‣ 3 Proposed Methodology ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we observe that AWRaCLe achieves excellent overall metrics. Our approach yields highest PSNR and SSIM values across all datasets. Importantly, AWRaCLe offers consistently high performance across all restoration tasks whereas competing methods perform well for some tasks but poorly for others. We also significantly outperform the in-context learning approach, Painter, highlighting the effectiveness of our in-context learning strategy. In Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.3 Comparisons ‣ 4 Experimental Results ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we show qualitative results for visual inspection and compare with the top-performing approaches TSMC, PromptIR and DiffUIR. It can be observed that AWRaCLe is able to handle the corruptions more effectively than the others. Additional qualitative results can be found in the supplementary along with results of AWRaCLe on real images and a discussion of the limitations of our method.</p>
</div>
<figure id="S4.F5" class="ltx_figure">
<table id="S4.F5.24" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.F5.24.25.1" class="ltx_tr">
<td id="S4.F5.24.25.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r" style="padding-left:1.0pt;padding-right:1.0pt;"></td>
<th id="S4.F5.24.25.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;">Input</th>
<th id="S4.F5.24.25.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;">TSMC</th>
<th id="S4.F5.24.25.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;">PromptIR</th>
<th id="S4.F5.24.25.1.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;">DiffUIR</th>
<th id="S4.F5.24.25.1.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;">AWRaCLe</th>
<th id="S4.F5.24.25.1.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column" style="padding-left:1.0pt;padding-right:1.0pt;">GT</th>
</tr>
<tr id="S4.F5.6.6" class="ltx_tr">
<th id="S4.F5.6.6.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:1.0pt;padding-right:1.0pt;">
<div id="S4.F5.6.6.7.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:26.1pt;vertical-align:-9.6pt;"><span class="ltx_transformed_inner" style="width:26.1pt;transform:translate(-9.64pt,0pt) rotate(-90deg) ;">
<p id="S4.F5.6.6.7.1.1" class="ltx_p">SOTS</p>
</span></div>
</th>
<td id="S4.F5.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/sots/input/1893_0.9_0.2.jpg.jpg.jpg.png" id="S4.F5.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/sots/tsmc/1893_0.9_0.2.jpg.jpg.jpg.png" id="S4.F5.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/sots/promptir/1893_0.9_0.2.jpg.jpg.jpg.png" id="S4.F5.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.4.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/sots/diffuir/1893_0.9_0.2.jpg.jpg.jpg.png" id="S4.F5.4.4.4.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.5.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/sots/ours_png/1893_0.9_0.2.jpg.jpg.jpg.png" id="S4.F5.5.5.5.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.6.6.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/sots/GT/1893_0.9_0.2.jpg.jpg.jpg.png" id="S4.F5.6.6.6.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
</tr>
<tr id="S4.F5.12.12" class="ltx_tr">
<th id="S4.F5.12.12.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:1.0pt;padding-right:1.0pt;">
<div id="S4.F5.12.12.7.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:43.2pt;vertical-align:-18.2pt;"><span class="ltx_transformed_inner" style="width:43.2pt;transform:translate(-18.18pt,0pt) rotate(-90deg) ;">
<p id="S4.F5.12.12.7.1.1" class="ltx_p">Rain100H</p>
</span></div>
</th>
<td id="S4.F5.7.7.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/rain100h/input/81.png.png" id="S4.F5.7.7.1.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.8.8.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/rain100h/tsmc/81.png.png" id="S4.F5.8.8.2.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.9.9.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/rain100h/promptir/81.png.png" id="S4.F5.9.9.3.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.10.10.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/rain100h/diffuir/81.png.png" id="S4.F5.10.10.4.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.11.11.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/rain100h/ours_png/81.png.png" id="S4.F5.11.11.5.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.12.12.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/rain100h/GT/81.png.png" id="S4.F5.12.12.6.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
</tr>
<tr id="S4.F5.18.18" class="ltx_tr">
<th id="S4.F5.18.18.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:1.0pt;padding-right:1.0pt;">
<div id="S4.F5.18.18.7.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:42pt;vertical-align:-17.6pt;"><span class="ltx_transformed_inner" style="width:41.9pt;transform:translate(-17.56pt,0pt) rotate(-90deg) ;">
<p id="S4.F5.18.18.7.1.1" class="ltx_p">Rain100L</p>
</span></div>
</th>
<td id="S4.F5.13.13.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/rain100l/input/5.png.png" id="S4.F5.13.13.1.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.14.14.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/rain100l/tsmc/5.png.png" id="S4.F5.14.14.2.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.15.15.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/rain100l/promptir/5.png.png" id="S4.F5.15.15.3.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.16.16.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/rain100l/diffuir/5.png.png" id="S4.F5.16.16.4.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.17.17.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/rain100l/ours_png/5.png.png" id="S4.F5.17.17.5.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.18.18.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/rain100l/GT/5.png.png" id="S4.F5.18.18.6.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
</tr>
<tr id="S4.F5.24.24" class="ltx_tr">
<th id="S4.F5.24.24.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row" style="padding-left:1.0pt;padding-right:1.0pt;">
<div id="S4.F5.24.24.7.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:43.3pt;vertical-align:-18.2pt;"><span class="ltx_transformed_inner" style="width:43.3pt;transform:translate(-18.19pt,0pt) rotate(-90deg) ;">
<p id="S4.F5.24.24.7.1.1" class="ltx_p">Snow100k</p>
</span></div>
</th>
<td id="S4.F5.19.19.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/snow100/input/school_night_08018.jpg.jpg.jpg.png" id="S4.F5.19.19.1.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.20.20.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/snow100/tsmc/school_night_08018.jpg.jpg.jpg.png" id="S4.F5.20.20.2.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.21.21.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/snow100/promptir/school_night_08018.jpg.jpg.jpg.png" id="S4.F5.21.21.3.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.22.22.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/snow100/diffuir/school_night_08018.jpg.jpg.jpg.png" id="S4.F5.22.22.4.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.23.23.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/snow100/ours_png/school_night_08018.jpg.jpg.jpg.png" id="S4.F5.23.23.5.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
<td id="S4.F5.24.24.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><img src="/html/2409.00263/assets/with_patch/snow100/GT/school_night_08018.jpg.jpg.jpg.png" id="S4.F5.24.24.6.g1" class="ltx_graphics ltx_img_landscape" width="90" height="54" alt="Refer to caption"></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Qualitative comparisons of AWRaCLe with top performing approaches (TSMC, PromptIR and DiffUIR) on SOTS, Rain100L, Rain100H and Snow100k datasets. Zoomed-in patches are provided for examining fine details.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Ablation Studies</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we first demonstrate the effect of the context pair provided to AWRaCLe and Painter. We show that AWRaCLe uses degradation-specific information (DSI) from the context pair to guide restoration while Painter fails to use any DSI from the context. We then show the importance of the various components of AWRaCLe.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Effect of Context Pairs</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.7" class="ltx_p">We first analyze the performance of our method and the in-context learning method, Painter, for correct and incorrect context on the Rain100L dataset. As shown in Table <a href="#S3.T1" title="Table 1 ‣ 3.2 Context Fusion ‣ 3 Proposed Methodology ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, when provided with correct context, AWRaCLe has a much higher PSNR (dB)/SSIM of <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="35.71/0.966" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mn id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">35.71</mn><mo id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">/</mo><mn id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">0.966</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><divide id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"></divide><cn type="float" id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">35.71</cn><cn type="float" id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3">0.966</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">35.71/0.966</annotation></semantics></math> compared to Painter (<math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="23.19/0.900" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mn id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">23.19</mn><mo id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">/</mo><mn id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">0.900</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><divide id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1"></divide><cn type="float" id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">23.19</cn><cn type="float" id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3">0.900</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">23.19/0.900</annotation></semantics></math>). Next, we provided incorrect context, i.e., the degradation in the query image <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="I_{\texttt{q}}" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><msub id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mi id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S5.SS1.p1.3.m3.1.1.3" xref="S5.SS1.p1.3.m3.1.1.3a.cmml">q</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">𝐼</ci><ci id="S5.SS1.p1.3.m3.1.1.3a.cmml" xref="S5.SS1.p1.3.m3.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S5.SS1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3">q</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">I_{\texttt{q}}</annotation></semantics></math> does not match the degradation present in <math id="S5.SS1.p1.4.m4.1" class="ltx_Math" alttext="I_{\texttt{d}}" display="inline"><semantics id="S5.SS1.p1.4.m4.1a"><msub id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml"><mi id="S5.SS1.p1.4.m4.1.1.2" xref="S5.SS1.p1.4.m4.1.1.2.cmml">I</mi><mtext class="ltx_mathvariant_monospace" id="S5.SS1.p1.4.m4.1.1.3" xref="S5.SS1.p1.4.m4.1.1.3a.cmml">d</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><apply id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.4.m4.1.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS1.p1.4.m4.1.1.2.cmml" xref="S5.SS1.p1.4.m4.1.1.2">𝐼</ci><ci id="S5.SS1.p1.4.m4.1.1.3a.cmml" xref="S5.SS1.p1.4.m4.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S5.SS1.p1.4.m4.1.1.3.cmml" xref="S5.SS1.p1.4.m4.1.1.3">d</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">I_{\texttt{d}}</annotation></semantics></math> of the context pair. Providing incorrect context to AWRaCLe yields a PSNR (dB)/SSIM of <math id="S5.SS1.p1.5.m5.1" class="ltx_Math" alttext="25.93/0.826" display="inline"><semantics id="S5.SS1.p1.5.m5.1a"><mrow id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml"><mn id="S5.SS1.p1.5.m5.1.1.2" xref="S5.SS1.p1.5.m5.1.1.2.cmml">25.93</mn><mo id="S5.SS1.p1.5.m5.1.1.1" xref="S5.SS1.p1.5.m5.1.1.1.cmml">/</mo><mn id="S5.SS1.p1.5.m5.1.1.3" xref="S5.SS1.p1.5.m5.1.1.3.cmml">0.826</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><apply id="S5.SS1.p1.5.m5.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1"><divide id="S5.SS1.p1.5.m5.1.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1.1"></divide><cn type="float" id="S5.SS1.p1.5.m5.1.1.2.cmml" xref="S5.SS1.p1.5.m5.1.1.2">25.93</cn><cn type="float" id="S5.SS1.p1.5.m5.1.1.3.cmml" xref="S5.SS1.p1.5.m5.1.1.3">0.826</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">25.93/0.826</annotation></semantics></math> which is a <math id="S5.SS1.p1.6.m6.1" class="ltx_Math" alttext="\sim 10" display="inline"><semantics id="S5.SS1.p1.6.m6.1a"><mrow id="S5.SS1.p1.6.m6.1.1" xref="S5.SS1.p1.6.m6.1.1.cmml"><mi id="S5.SS1.p1.6.m6.1.1.2" xref="S5.SS1.p1.6.m6.1.1.2.cmml"></mi><mo id="S5.SS1.p1.6.m6.1.1.1" xref="S5.SS1.p1.6.m6.1.1.1.cmml">∼</mo><mn id="S5.SS1.p1.6.m6.1.1.3" xref="S5.SS1.p1.6.m6.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m6.1b"><apply id="S5.SS1.p1.6.m6.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1"><csymbol cd="latexml" id="S5.SS1.p1.6.m6.1.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S5.SS1.p1.6.m6.1.1.2.cmml" xref="S5.SS1.p1.6.m6.1.1.2">absent</csymbol><cn type="integer" id="S5.SS1.p1.6.m6.1.1.3.cmml" xref="S5.SS1.p1.6.m6.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m6.1c">\sim 10</annotation></semantics></math> dB drop in performance with respect to correct context. However, Painter’s values with incorrect context (<math id="S5.SS1.p1.7.m7.1" class="ltx_Math" alttext="23.15/0.900" display="inline"><semantics id="S5.SS1.p1.7.m7.1a"><mrow id="S5.SS1.p1.7.m7.1.1" xref="S5.SS1.p1.7.m7.1.1.cmml"><mn id="S5.SS1.p1.7.m7.1.1.2" xref="S5.SS1.p1.7.m7.1.1.2.cmml">23.15</mn><mo id="S5.SS1.p1.7.m7.1.1.1" xref="S5.SS1.p1.7.m7.1.1.1.cmml">/</mo><mn id="S5.SS1.p1.7.m7.1.1.3" xref="S5.SS1.p1.7.m7.1.1.3.cmml">0.900</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.7.m7.1b"><apply id="S5.SS1.p1.7.m7.1.1.cmml" xref="S5.SS1.p1.7.m7.1.1"><divide id="S5.SS1.p1.7.m7.1.1.1.cmml" xref="S5.SS1.p1.7.m7.1.1.1"></divide><cn type="float" id="S5.SS1.p1.7.m7.1.1.2.cmml" xref="S5.SS1.p1.7.m7.1.1.2">23.15</cn><cn type="float" id="S5.SS1.p1.7.m7.1.1.3.cmml" xref="S5.SS1.p1.7.m7.1.1.3">0.900</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.7.m7.1c">23.15/0.900</annotation></semantics></math>) are nearly unchanged from its performance with correct context, which indicates that it lacks utilization of the context for image restoration. Qualitative results for this experiment are in the supplementary.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.4" class="ltx_p">Next, we analyze the impact of specific context pairs on the performance of AWRaCLe. In Table <a href="#S5.T2" title="Table 2 ‣ 5.1 Effect of Context Pairs ‣ 5 Ablation Studies ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we report mean (<math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">\mu</annotation></semantics></math>) <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mo id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><csymbol cd="latexml" id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">\pm</annotation></semantics></math> standard deviation (<math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><mi id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><ci id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">\sigma</annotation></semantics></math>) of PSNR (row2) and SSIM (row3) obtained by randomly selecting <math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><mn id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><cn type="integer" id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">10</annotation></semantics></math> paired context images for each of deraining, dehazing and desnowing, and fixing each of these context pairs over the entire test set. This is different from the testing strategy used in our experiments, where the context pair is randomly chosen for each image of the test sets. The table shows that AWRaCLe is quite robust to different context pairs from the same degradation.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Effect of fixing a specific context pair for the test sets for different degradations.</figcaption>
<table id="S5.T2.12" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.12.13.1" class="ltx_tr">
<td id="S5.T2.12.13.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_l ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">SOTS</td>
<td id="S5.T2.12.13.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">Rain100L</td>
<td id="S5.T2.12.13.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">Rain100H</td>
<td id="S5.T2.12.13.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">Snow100k</td>
</tr>
<tr id="S5.T2.4.4" class="ltx_tr">
<td id="S5.T2.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_l ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">31.61 <math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mo id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\pm</annotation></semantics></math> 0.18</td>
<td id="S5.T2.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">35.71 <math id="S5.T2.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.2.2.2.m1.1a"><mo id="S5.T2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><csymbol cd="latexml" id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">\pm</annotation></semantics></math> 0.004</td>
<td id="S5.T2.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">27.20 <math id="S5.T2.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.3.3.3.m1.1a"><mo id="S5.T2.3.3.3.m1.1.1" xref="S5.T2.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.m1.1b"><csymbol cd="latexml" id="S5.T2.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.m1.1c">\pm</annotation></semantics></math> 0.02</td>
<td id="S5.T2.4.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">33.48 <math id="S5.T2.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.4.4.4.m1.1a"><mo id="S5.T2.4.4.4.m1.1.1" xref="S5.T2.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.m1.1b"><csymbol cd="latexml" id="S5.T2.4.4.4.m1.1.1.cmml" xref="S5.T2.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.m1.1c">\pm</annotation></semantics></math> 0.01</td>
</tr>
<tr id="S5.T2.12.12" class="ltx_tr">
<td id="S5.T2.6.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">0.981 <math id="S5.T2.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.5.5.1.m1.1a"><mo id="S5.T2.5.5.1.m1.1.1" xref="S5.T2.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.1.m1.1b"><csymbol cd="latexml" id="S5.T2.5.5.1.m1.1.1.cmml" xref="S5.T2.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.1.m1.1c">\pm</annotation></semantics></math> <math id="S5.T2.6.6.2.m2.1" class="ltx_Math" alttext="2e^{-4}" display="inline"><semantics id="S5.T2.6.6.2.m2.1a"><mrow id="S5.T2.6.6.2.m2.1.1" xref="S5.T2.6.6.2.m2.1.1.cmml"><mn id="S5.T2.6.6.2.m2.1.1.2" xref="S5.T2.6.6.2.m2.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S5.T2.6.6.2.m2.1.1.1" xref="S5.T2.6.6.2.m2.1.1.1.cmml">​</mo><msup id="S5.T2.6.6.2.m2.1.1.3" xref="S5.T2.6.6.2.m2.1.1.3.cmml"><mi id="S5.T2.6.6.2.m2.1.1.3.2" xref="S5.T2.6.6.2.m2.1.1.3.2.cmml">e</mi><mrow id="S5.T2.6.6.2.m2.1.1.3.3" xref="S5.T2.6.6.2.m2.1.1.3.3.cmml"><mo id="S5.T2.6.6.2.m2.1.1.3.3a" xref="S5.T2.6.6.2.m2.1.1.3.3.cmml">−</mo><mn id="S5.T2.6.6.2.m2.1.1.3.3.2" xref="S5.T2.6.6.2.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.2.m2.1b"><apply id="S5.T2.6.6.2.m2.1.1.cmml" xref="S5.T2.6.6.2.m2.1.1"><times id="S5.T2.6.6.2.m2.1.1.1.cmml" xref="S5.T2.6.6.2.m2.1.1.1"></times><cn type="integer" id="S5.T2.6.6.2.m2.1.1.2.cmml" xref="S5.T2.6.6.2.m2.1.1.2">2</cn><apply id="S5.T2.6.6.2.m2.1.1.3.cmml" xref="S5.T2.6.6.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.T2.6.6.2.m2.1.1.3.1.cmml" xref="S5.T2.6.6.2.m2.1.1.3">superscript</csymbol><ci id="S5.T2.6.6.2.m2.1.1.3.2.cmml" xref="S5.T2.6.6.2.m2.1.1.3.2">𝑒</ci><apply id="S5.T2.6.6.2.m2.1.1.3.3.cmml" xref="S5.T2.6.6.2.m2.1.1.3.3"><minus id="S5.T2.6.6.2.m2.1.1.3.3.1.cmml" xref="S5.T2.6.6.2.m2.1.1.3.3"></minus><cn type="integer" id="S5.T2.6.6.2.m2.1.1.3.3.2.cmml" xref="S5.T2.6.6.2.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.2.m2.1c">2e^{-4}</annotation></semantics></math>
</td>
<td id="S5.T2.8.8.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">0.966 <math id="S5.T2.7.7.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.7.7.3.m1.1a"><mo id="S5.T2.7.7.3.m1.1.1" xref="S5.T2.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.3.m1.1b"><csymbol cd="latexml" id="S5.T2.7.7.3.m1.1.1.cmml" xref="S5.T2.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.3.m1.1c">\pm</annotation></semantics></math> <math id="S5.T2.8.8.4.m2.1" class="ltx_Math" alttext="1e^{-4}" display="inline"><semantics id="S5.T2.8.8.4.m2.1a"><mrow id="S5.T2.8.8.4.m2.1.1" xref="S5.T2.8.8.4.m2.1.1.cmml"><mn id="S5.T2.8.8.4.m2.1.1.2" xref="S5.T2.8.8.4.m2.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.T2.8.8.4.m2.1.1.1" xref="S5.T2.8.8.4.m2.1.1.1.cmml">​</mo><msup id="S5.T2.8.8.4.m2.1.1.3" xref="S5.T2.8.8.4.m2.1.1.3.cmml"><mi id="S5.T2.8.8.4.m2.1.1.3.2" xref="S5.T2.8.8.4.m2.1.1.3.2.cmml">e</mi><mrow id="S5.T2.8.8.4.m2.1.1.3.3" xref="S5.T2.8.8.4.m2.1.1.3.3.cmml"><mo id="S5.T2.8.8.4.m2.1.1.3.3a" xref="S5.T2.8.8.4.m2.1.1.3.3.cmml">−</mo><mn id="S5.T2.8.8.4.m2.1.1.3.3.2" xref="S5.T2.8.8.4.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.4.m2.1b"><apply id="S5.T2.8.8.4.m2.1.1.cmml" xref="S5.T2.8.8.4.m2.1.1"><times id="S5.T2.8.8.4.m2.1.1.1.cmml" xref="S5.T2.8.8.4.m2.1.1.1"></times><cn type="integer" id="S5.T2.8.8.4.m2.1.1.2.cmml" xref="S5.T2.8.8.4.m2.1.1.2">1</cn><apply id="S5.T2.8.8.4.m2.1.1.3.cmml" xref="S5.T2.8.8.4.m2.1.1.3"><csymbol cd="ambiguous" id="S5.T2.8.8.4.m2.1.1.3.1.cmml" xref="S5.T2.8.8.4.m2.1.1.3">superscript</csymbol><ci id="S5.T2.8.8.4.m2.1.1.3.2.cmml" xref="S5.T2.8.8.4.m2.1.1.3.2">𝑒</ci><apply id="S5.T2.8.8.4.m2.1.1.3.3.cmml" xref="S5.T2.8.8.4.m2.1.1.3.3"><minus id="S5.T2.8.8.4.m2.1.1.3.3.1.cmml" xref="S5.T2.8.8.4.m2.1.1.3.3"></minus><cn type="integer" id="S5.T2.8.8.4.m2.1.1.3.3.2.cmml" xref="S5.T2.8.8.4.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.4.m2.1c">1e^{-4}</annotation></semantics></math>
</td>
<td id="S5.T2.10.10.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">0.840 <math id="S5.T2.9.9.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.9.9.5.m1.1a"><mo id="S5.T2.9.9.5.m1.1.1" xref="S5.T2.9.9.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.5.m1.1b"><csymbol cd="latexml" id="S5.T2.9.9.5.m1.1.1.cmml" xref="S5.T2.9.9.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.5.m1.1c">\pm</annotation></semantics></math> <math id="S5.T2.10.10.6.m2.1" class="ltx_Math" alttext="3e^{-4}" display="inline"><semantics id="S5.T2.10.10.6.m2.1a"><mrow id="S5.T2.10.10.6.m2.1.1" xref="S5.T2.10.10.6.m2.1.1.cmml"><mn id="S5.T2.10.10.6.m2.1.1.2" xref="S5.T2.10.10.6.m2.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S5.T2.10.10.6.m2.1.1.1" xref="S5.T2.10.10.6.m2.1.1.1.cmml">​</mo><msup id="S5.T2.10.10.6.m2.1.1.3" xref="S5.T2.10.10.6.m2.1.1.3.cmml"><mi id="S5.T2.10.10.6.m2.1.1.3.2" xref="S5.T2.10.10.6.m2.1.1.3.2.cmml">e</mi><mrow id="S5.T2.10.10.6.m2.1.1.3.3" xref="S5.T2.10.10.6.m2.1.1.3.3.cmml"><mo id="S5.T2.10.10.6.m2.1.1.3.3a" xref="S5.T2.10.10.6.m2.1.1.3.3.cmml">−</mo><mn id="S5.T2.10.10.6.m2.1.1.3.3.2" xref="S5.T2.10.10.6.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.6.m2.1b"><apply id="S5.T2.10.10.6.m2.1.1.cmml" xref="S5.T2.10.10.6.m2.1.1"><times id="S5.T2.10.10.6.m2.1.1.1.cmml" xref="S5.T2.10.10.6.m2.1.1.1"></times><cn type="integer" id="S5.T2.10.10.6.m2.1.1.2.cmml" xref="S5.T2.10.10.6.m2.1.1.2">3</cn><apply id="S5.T2.10.10.6.m2.1.1.3.cmml" xref="S5.T2.10.10.6.m2.1.1.3"><csymbol cd="ambiguous" id="S5.T2.10.10.6.m2.1.1.3.1.cmml" xref="S5.T2.10.10.6.m2.1.1.3">superscript</csymbol><ci id="S5.T2.10.10.6.m2.1.1.3.2.cmml" xref="S5.T2.10.10.6.m2.1.1.3.2">𝑒</ci><apply id="S5.T2.10.10.6.m2.1.1.3.3.cmml" xref="S5.T2.10.10.6.m2.1.1.3.3"><minus id="S5.T2.10.10.6.m2.1.1.3.3.1.cmml" xref="S5.T2.10.10.6.m2.1.1.3.3"></minus><cn type="integer" id="S5.T2.10.10.6.m2.1.1.3.3.2.cmml" xref="S5.T2.10.10.6.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.6.m2.1c">3e^{-4}</annotation></semantics></math>
</td>
<td id="S5.T2.12.12.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">0.934 <math id="S5.T2.11.11.7.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.11.11.7.m1.1a"><mo id="S5.T2.11.11.7.m1.1.1" xref="S5.T2.11.11.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.7.m1.1b"><csymbol cd="latexml" id="S5.T2.11.11.7.m1.1.1.cmml" xref="S5.T2.11.11.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.7.m1.1c">\pm</annotation></semantics></math> <math id="S5.T2.12.12.8.m2.1" class="ltx_Math" alttext="3e^{-4}" display="inline"><semantics id="S5.T2.12.12.8.m2.1a"><mrow id="S5.T2.12.12.8.m2.1.1" xref="S5.T2.12.12.8.m2.1.1.cmml"><mn id="S5.T2.12.12.8.m2.1.1.2" xref="S5.T2.12.12.8.m2.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S5.T2.12.12.8.m2.1.1.1" xref="S5.T2.12.12.8.m2.1.1.1.cmml">​</mo><msup id="S5.T2.12.12.8.m2.1.1.3" xref="S5.T2.12.12.8.m2.1.1.3.cmml"><mi id="S5.T2.12.12.8.m2.1.1.3.2" xref="S5.T2.12.12.8.m2.1.1.3.2.cmml">e</mi><mrow id="S5.T2.12.12.8.m2.1.1.3.3" xref="S5.T2.12.12.8.m2.1.1.3.3.cmml"><mo id="S5.T2.12.12.8.m2.1.1.3.3a" xref="S5.T2.12.12.8.m2.1.1.3.3.cmml">−</mo><mn id="S5.T2.12.12.8.m2.1.1.3.3.2" xref="S5.T2.12.12.8.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.12.12.8.m2.1b"><apply id="S5.T2.12.12.8.m2.1.1.cmml" xref="S5.T2.12.12.8.m2.1.1"><times id="S5.T2.12.12.8.m2.1.1.1.cmml" xref="S5.T2.12.12.8.m2.1.1.1"></times><cn type="integer" id="S5.T2.12.12.8.m2.1.1.2.cmml" xref="S5.T2.12.12.8.m2.1.1.2">3</cn><apply id="S5.T2.12.12.8.m2.1.1.3.cmml" xref="S5.T2.12.12.8.m2.1.1.3"><csymbol cd="ambiguous" id="S5.T2.12.12.8.m2.1.1.3.1.cmml" xref="S5.T2.12.12.8.m2.1.1.3">superscript</csymbol><ci id="S5.T2.12.12.8.m2.1.1.3.2.cmml" xref="S5.T2.12.12.8.m2.1.1.3.2">𝑒</ci><apply id="S5.T2.12.12.8.m2.1.1.3.3.cmml" xref="S5.T2.12.12.8.m2.1.1.3.3"><minus id="S5.T2.12.12.8.m2.1.1.3.3.1.cmml" xref="S5.T2.12.12.8.m2.1.1.3.3"></minus><cn type="integer" id="S5.T2.12.12.8.m2.1.1.3.3.2.cmml" xref="S5.T2.12.12.8.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.12.8.m2.1c">3e^{-4}</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Quantitative comparisons of different ablations conducted on AWRaCLe. All ablation settings are tested on the SOTS dataset. The best result is in bold.</figcaption>
<table id="S5.T3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.1.1.1" class="ltx_tr">
<th id="S5.T3.1.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.1.1.1.1.1" class="ltx_p" style="width:42.7pt;">Context</span>
</span>
</th>
<th id="S5.T3.1.1.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.1.1.2.1.1" class="ltx_p" style="width:22.8pt;">DCE</span>
</span>
</th>
<th id="S5.T3.1.1.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.1.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.1.1.3.1.1" class="ltx_p" style="width:22.8pt;">CF</span>
</span>
</th>
<th id="S5.T3.1.1.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.1.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.1.1.4.1.1" class="ltx_p" style="width:34.1pt;">MLF</span>
</span>
</th>
<th id="S5.T3.1.1.1.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.1.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.1.1.5.1.1" class="ltx_p" style="width:56.9pt;">PSNR/SSIM</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.1.2.1" class="ltx_tr">
<td id="S5.T3.1.2.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.2.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.2.1.1.1.1" class="ltx_p" style="width:42.7pt;">-</span>
</span>
</td>
<td id="S5.T3.1.2.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.2.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.2.1.2.1.1" class="ltx_p" style="width:22.8pt;">-</span>
</span>
</td>
<td id="S5.T3.1.2.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.2.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.2.1.3.1.1" class="ltx_p" style="width:22.8pt;">-</span>
</span>
</td>
<td id="S5.T3.1.2.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.2.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.2.1.4.1.1" class="ltx_p" style="width:34.1pt;">-</span>
</span>
</td>
<td id="S5.T3.1.2.1.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.2.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.2.1.5.1.1" class="ltx_p" style="width:56.9pt;">29.53/0.972</span>
</span>
</td>
</tr>
<tr id="S5.T3.1.3.2" class="ltx_tr">
<td id="S5.T3.1.3.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.3.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.3.2.1.1.1" class="ltx_p" style="width:42.7pt;">Paired</span>
</span>
</td>
<td id="S5.T3.1.3.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.3.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.3.2.2.1.1" class="ltx_p" style="width:22.8pt;">-</span>
</span>
</td>
<td id="S5.T3.1.3.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.3.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.3.2.3.1.1" class="ltx_p" style="width:22.8pt;">✓</span>
</span>
</td>
<td id="S5.T3.1.3.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.3.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.3.2.4.1.1" class="ltx_p" style="width:34.1pt;">✓</span>
</span>
</td>
<td id="S5.T3.1.3.2.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.3.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.3.2.5.1.1" class="ltx_p" style="width:56.9pt;">30.53/0.978</span>
</span>
</td>
</tr>
<tr id="S5.T3.1.4.3" class="ltx_tr">
<td id="S5.T3.1.4.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.4.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.4.3.1.1.1" class="ltx_p" style="width:42.7pt;">Paired</span>
</span>
</td>
<td id="S5.T3.1.4.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.4.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.4.3.2.1.1" class="ltx_p" style="width:22.8pt;">✓</span>
</span>
</td>
<td id="S5.T3.1.4.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.4.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.4.3.3.1.1" class="ltx_p" style="width:22.8pt;">-</span>
</span>
</td>
<td id="S5.T3.1.4.3.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.4.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.4.3.4.1.1" class="ltx_p" style="width:34.1pt;">✓</span>
</span>
</td>
<td id="S5.T3.1.4.3.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.4.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.4.3.5.1.1" class="ltx_p" style="width:56.9pt;">31.16/0.979</span>
</span>
</td>
</tr>
<tr id="S5.T3.1.5.4" class="ltx_tr">
<td id="S5.T3.1.5.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.5.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.5.4.1.1.1" class="ltx_p" style="width:42.7pt;">Paired</span>
</span>
</td>
<td id="S5.T3.1.5.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.5.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.5.4.2.1.1" class="ltx_p" style="width:22.8pt;">✓</span>
</span>
</td>
<td id="S5.T3.1.5.4.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.5.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.5.4.3.1.1" class="ltx_p" style="width:22.8pt;">✓</span>
</span>
</td>
<td id="S5.T3.1.5.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.5.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.5.4.4.1.1" class="ltx_p" style="width:34.1pt;">-</span>
</span>
</td>
<td id="S5.T3.1.5.4.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.5.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.5.4.5.1.1" class="ltx_p" style="width:56.9pt;">30.12/0.977</span>
</span>
</td>
</tr>
<tr id="S5.T3.1.6.5" class="ltx_tr">
<td id="S5.T3.1.6.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_l ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.6.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.6.5.1.1.1" class="ltx_p" style="width:42.7pt;">Unpaired</span>
</span>
</td>
<td id="S5.T3.1.6.5.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.6.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.6.5.2.1.1" class="ltx_p" style="width:22.8pt;">✓</span>
</span>
</td>
<td id="S5.T3.1.6.5.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.6.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.6.5.3.1.1" class="ltx_p" style="width:22.8pt;">✓</span>
</span>
</td>
<td id="S5.T3.1.6.5.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.6.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.6.5.4.1.1" class="ltx_p" style="width:34.1pt;">✓</span>
</span>
</td>
<td id="S5.T3.1.6.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.6.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.6.5.5.1.1" class="ltx_p" style="width:56.9pt;">29.84/0.974</span>
</span>
</td>
</tr>
<tr id="S5.T3.1.7.6" class="ltx_tr">
<td id="S5.T3.1.7.6.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.7.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.7.6.1.1.1" class="ltx_p" style="width:42.7pt;">Paired</span>
</span>
</td>
<td id="S5.T3.1.7.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.7.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.7.6.2.1.1" class="ltx_p" style="width:22.8pt;">✓</span>
</span>
</td>
<td id="S5.T3.1.7.6.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.7.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.7.6.3.1.1" class="ltx_p" style="width:22.8pt;">✓</span>
</span>
</td>
<td id="S5.T3.1.7.6.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.7.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.7.6.4.1.1" class="ltx_p" style="width:34.1pt;">✓</span>
</span>
</td>
<td id="S5.T3.1.7.6.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">
<span id="S5.T3.1.7.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.1.7.6.5.1.1" class="ltx_p" style="width:56.9pt;"><span id="S5.T3.1.7.6.5.1.1.1" class="ltx_text ltx_font_bold">31.65</span>/<span id="S5.T3.1.7.6.5.1.1.2" class="ltx_text ltx_font_bold ltx_align_center">0.981</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Effect of Individual Components</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.2" class="ltx_p">In this section, we show the importance of the various components of AWRaCLe.
Table <a href="#S5.T3" title="Table 3 ‣ 5.1 Effect of Context Pairs ‣ 5 Ablation Studies ‣ AWRaCLe: All-Weather Image Restoration using Visual In-Context Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows quantitative results for each of our ablations on the SOTS dataset. In the table, “Context” refers to training with either paired or unpaired context, “DCE” indicates if the DCE block is used, “CF” indicates usage of CF block and “MLF” refers to the incorporation of multi-level fusion. A “✓” in a column means that component is used, while a “-” means it is not used. Note that it is not possible to remove the DCE and CF blocks in their entirety. Thus, when the DCE block is removed, we remove the <span id="S5.SS2.p1.2.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">MHSA(.)</span> operation, and when the CF block is removed, we replace the <span id="S5.SS2.p1.2.2" class="ltx_text ltx_markedasmath ltx_font_typewriter">MHCA(.)</span> operation with interpolation and element-wise multiplication with decoder features.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">The table shows that our proposed method, AWRaCLe (last row), demonstrates the best performance. Training with only the baseline (row 1) results in a significant drop in restoration performance. Without the DCE block (row2), there is an improvement in the model’s performance over the baseline. Omitting the CF blocks (row3) yields some performance gain but it is still quite inferior to our proposed method. The absence of MLF (row4) also leads to a drop in performance. Finally, training with unpaired context (row5) yields inferior results compared to training with paired context. Thus, these ablations highlight the importance of the components of AWRaCLe.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We proposed a novel approach called AWRaCLe for all-weather image restoration that leverages visual in-context learning. We showed that suitably designed degradation context extraction and fusion blocks are central to the performance of our method. Additionally, we presented multi-level fusion of context information which is key to achieving good restoration performance. AWRaCLe advances the state-of-the-art in AWIR on standard datasets for the tasks of deraining, desnowing and dehazing.
We believe that our method will be an important enabler for solving the complex AWIR task in its generality.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Acknowledgment</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">This research is based upon work supported by the Office of the Director of National Intelligence
(ODNI), Intelligence Advanced Research Projects Activity (IARPA), via IARPA R&amp;D Contract
No. 140D0423C0076. The views and conclusions contained herein are those of the authors and
should not be interpreted as necessarily representing the official policies or endorsements, either
expressed or implied, of the ODNI, IARPA, or the U.S. Government. The U.S. Government is
authorized to reproduce and distribute reprints for Governmental purposes notwithstanding any
copyright annotation thereon.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ai et al. (2024)</span>
<span class="ltx_bibblock">
Ai, Y.; Huang, H.; Zhou, X.; Wang, J.; and He, R. 2024.

</span>
<span class="ltx_bibblock">Multimodal Prompt Perceiver: Empower Adaptiveness Generalizability and Fidelity for All-in-One Image Restoration.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 25432–25444.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alayrac et al. (2022)</span>
<span class="ltx_bibblock">
Alayrac, J.-B.; Donahue, J.; Luc, P.; Miech, A.; Barr, I.; Hasson, Y.; Lenc, K.; Mensch, A.; Millican, K.; Reynolds, M.; et al. 2022.

</span>
<span class="ltx_bibblock">Flamingo: a visual language model for few-shot learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35: 23716–23736.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ba, Kiros, and Hinton (2016)</span>
<span class="ltx_bibblock">
Ba, J. L.; Kiros, J. R.; and Hinton, G. E. 2016.

</span>
<span class="ltx_bibblock">Layer normalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1607.06450</em>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2023)</span>
<span class="ltx_bibblock">
Bai, Y.; Wang, C.; Xie, S.; Dong, C.; Yuan, C.; and Wang, Z. 2023.

</span>
<span class="ltx_bibblock">TextIR: A Simple Framework for Text-based Editable Image Restoration.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.14736</em>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bar et al. (2022)</span>
<span class="ltx_bibblock">
Bar, A.; Gandelsman, Y.; Darrell, T.; Globerson, A.; and Efros, A. 2022.

</span>
<span class="ltx_bibblock">Visual prompting via image inpainting.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35: 25005–25017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020)</span>
<span class="ltx_bibblock">
Brown, T. B.; Mann, B.; Ryder, N.; Subbiah, M.; Kaplan, J.; Dhariwal, P.; Neelakantan, A.; Shyam, P.; Sastry, G.; Askell, A.; Agarwal, S.; Herbert-Voss, A.; Krueger, G.; Henighan, T.; Child, R.; Ramesh, A.; Ziegler, D. M.; Wu, J.; Winter, C.; Hesse, C.; Chen, M.; Sigler, E.; Litwin, M.; Gray, S.; Chess, B.; Clark, J.; Berner, C.; McCandlish, S.; Radford, A.; Sutskever, I.; and Amodei, D. 2020.

</span>
<span class="ltx_bibblock">Language Models Are Few-Shot Learners.

</span>
<span class="ltx_bibblock">Red Hook, NY, USA: Curran Associates Inc.

</span>
<span class="ltx_bibblock">ISBN 9781713829546.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carion et al. (2020)</span>
<span class="ltx_bibblock">
Carion, N.; Massa, F.; Synnaeve, G.; Usunier, N.; Kirillov, A.; and Zagoruyko, S. 2020.

</span>
<span class="ltx_bibblock">End-to-end object detection with transformers.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">European conference on computer vision</em>, 213–229. Springer.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2021)</span>
<span class="ltx_bibblock">
Chen, T.; Saxena, S.; Li, L.; Fleet, D. J.; and Hinton, G. 2021.

</span>
<span class="ltx_bibblock">Pix2seq: A language modeling framework for object detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.10852</em>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2022a)</span>
<span class="ltx_bibblock">
Chen, T.; Saxena, S.; Li, L.; Lin, T.-Y.; Fleet, D. J.; and Hinton, G. E. 2022a.

</span>
<span class="ltx_bibblock">A unified sequence interface for vision tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35: 31333–31346.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020)</span>
<span class="ltx_bibblock">
Chen, W.-T.; Fang, H.-Y.; Ding, J.-J.; Tsai, C.-C.; and Kuo, S.-Y. 2020.

</span>
<span class="ltx_bibblock">JSTASR: Joint Size and Transparency-Aware Snow Removal Algorithm Based on Modified Partial Convolution and Veiling Effect Removal.

</span>
<span class="ltx_bibblock">Berlin, Heidelberg: Springer-Verlag.

</span>
<span class="ltx_bibblock">ISBN 978-3-030-58588-4.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2022b)</span>
<span class="ltx_bibblock">
Chen, W.-T.; Huang, Z.-K.; Tsai, C.-C.; Yang, H.-H.; Ding, J.-J.; and Kuo, S.-Y. 2022b.

</span>
<span class="ltx_bibblock">Learning Multiple Adverse Weather Removal via Two-stage Knowledge Learning and Multi-contrastive Regularization: Toward a Unified Model.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2020)</span>
<span class="ltx_bibblock">
Dosovitskiy, A.; Beyer, L.; Kolesnikov, A.; Weissenborn, D.; Zhai, X.; Unterthiner, T.; Dehghani, M.; Minderer, M.; Heigold, G.; Gelly, S.; et al. 2020.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at scale.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.11929</em>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2021)</span>
<span class="ltx_bibblock">
Gu, X.; Lin, T.-Y.; Kuo, W.; and Cui, Y. 2021.

</span>
<span class="ltx_bibblock">Open-vocabulary object detection via vision and language knowledge distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2104.13921</em>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2020)</span>
<span class="ltx_bibblock">
He, K.; Fan, H.; Wu, Y.; Xie, S.; and Girshick, R. 2020.

</span>
<span class="ltx_bibblock">Momentum Contrast for Unsupervised Visual Representation Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">2020 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 9726–9735.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He, Sun, and Tang (2009)</span>
<span class="ltx_bibblock">
He, K.; Sun, J.; and Tang, X. 2009.

</span>
<span class="ltx_bibblock">Single image haze removal using dark channel prior.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">2009 IEEE Conference on Computer Vision and Pattern Recognition</em>, 1956–1963.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks and Gimpel (2016)</span>
<span class="ltx_bibblock">
Hendrycks, D.; and Gimpel, K. 2016.

</span>
<span class="ltx_bibblock">Gaussian error linear units (gelus).

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1606.08415</em>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang, Lin, and Fu (2012)</span>
<span class="ltx_bibblock">
Kang, L.-W.; Lin, C.-W.; and Fu, Y.-H. 2012.

</span>
<span class="ltx_bibblock">Automatic Single-Image-Based Rain Streaks Removal via Image Decomposition.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Image Processing</em>, 21(4): 1742–1755.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Li, B.; Liu, X.; Hu, P.; Wu, Z.; Lv, J.; and Peng, X. 2022.

</span>
<span class="ltx_bibblock">All-In-One Image Restoration for Unknown Corruption.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">2022 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 17431–17441.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019)</span>
<span class="ltx_bibblock">
Li, B.; Ren, W.; Fu, D.; Tao, D.; Feng, D.; Zeng, W.; and Wang, Z. 2019.

</span>
<span class="ltx_bibblock">Benchmarking Single-Image Dehazing and Beyond.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Image Processing</em>, 28(1): 492–505.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li, Tan, and Cheong (2020)</span>
<span class="ltx_bibblock">
Li, R.; Tan, R. T.; and Cheong, L.-F. 2020.

</span>
<span class="ltx_bibblock">All in One Bad Weather Removal Using Architectural Search.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">2020 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 3172–3182.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. (2021)</span>
<span class="ltx_bibblock">
Liang, J.; Cao, J.; Sun, G.; Zhang, K.; Van Gool, L.; and Timofte, R. 2021.

</span>
<span class="ltx_bibblock">SwinIR: Image Restoration Using Swin Transformer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">2021 IEEE/CVF International Conference on Computer Vision Workshops (ICCVW)</em>, 1833–1844.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2024)</span>
<span class="ltx_bibblock">
Lin, J.; Zhang, Z.; Wei, Y.; Ren, D.; Jiang, D.; Tian, Q.; and Zuo, W. 2024.

</span>
<span class="ltx_bibblock">Improving image restoration through removing degradations in textual representations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2866–2878.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2018)</span>
<span class="ltx_bibblock">
Liu, Y.-F.; Jaw, D.-W.; Huang, S.-C.; and Hwang, J.-N. 2018.

</span>
<span class="ltx_bibblock">DesnowNet: Context-Aware Deep Network for Snow Removal.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Image Processing</em>, 27(6): 3064–3073.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2022)</span>
<span class="ltx_bibblock">
Lu, J.; Clark, C.; Zellers, R.; Mottaghi, R.; and Kembhavi, A. 2022.

</span>
<span class="ltx_bibblock">Unified-io: A unified model for vision, language, and multi-modal tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.08916</em>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Özdenizci and Legenstein (2023)</span>
<span class="ltx_bibblock">
Özdenizci, O.; and Legenstein, R. 2023.

</span>
<span class="ltx_bibblock">Restoring vision in adverse weather conditions with patch-based denoising diffusion models.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 1–12.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park, Lee, and Chun (2023)</span>
<span class="ltx_bibblock">
Park, D.; Lee, B.; and Chun, S. 2023.

</span>
<span class="ltx_bibblock">All-in-One Image Restoration for Unknown Degradations Using Adaptive Discriminative Filters for Specific Degradations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">2023 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 5815–5824.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. (2019)</span>
<span class="ltx_bibblock">
Paszke, A.; Gross, S.; Massa, F.; Lerer, A.; Bradbury, J.; Chanan, G.; Killeen, T.; Lin, Z.; Gimelshein, N.; Antiga, L.; et al. 2019.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep learning library.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 32.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Patil et al. (2023)</span>
<span class="ltx_bibblock">
Patil, P. W.; Gupta, S.; Rana, S.; Venkatesh, S.; and Murala, S. 2023.

</span>
<span class="ltx_bibblock">Multi-weather Image Restoration via Domain Translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV)</em>, 21696–21705.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Potlapalli et al. (2024)</span>
<span class="ltx_bibblock">
Potlapalli, V.; Zamir, S. W.; Khan, S. H.; and Shahbaz Khan, F. 2024.

</span>
<span class="ltx_bibblock">PromptIR: Prompting for All-in-One Image Restoration.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quan et al. (2021)</span>
<span class="ltx_bibblock">
Quan, R.; Yu, X.; Liang, Y.; and Yang, Y. 2021.

</span>
<span class="ltx_bibblock">Removing Raindrops and Rain Streaks in One Go.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">2021 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 9143–9152.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2021)</span>
<span class="ltx_bibblock">
Radford, A.; Kim, J. W.; Hallacy, C.; Ramesh, A.; Goh, G.; Agarwal, S.; Sastry, G.; Askell, A.; Mishkin, P.; Clark, J.; et al. 2021.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, 8748–8763. PMLR.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roth and Black (2005)</span>
<span class="ltx_bibblock">
Roth, S.; and Black, M. 2005.

</span>
<span class="ltx_bibblock">Fields of Experts: a framework for learning image priors.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">2005 IEEE Computer Society Conference on Computer Vision and Pattern Recognition (CVPR’05)</em>, volume 2, 860–867 vol. 2.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. (2021)</span>
<span class="ltx_bibblock">
Shen, S.; Li, L. H.; Tan, H.; Bansal, M.; Rohrbach, A.; Chang, K.-W.; Yao, Z.; and Keutzer, K. 2021.

</span>
<span class="ltx_bibblock">How much can clip benefit vision-and-language tasks?

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2107.06383</em>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2023)</span>
<span class="ltx_bibblock">
Song, Y.; He, Z.; Qian, H.; and Du, X. 2023.

</span>
<span class="ltx_bibblock">Vision Transformers for Single Image Dehazing.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Image Processing</em>, 32: 1927–1941.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Valanarasu, Yasarla, and Patel (2022)</span>
<span class="ltx_bibblock">
Valanarasu, J. J.; Yasarla, R.; and Patel, V. M. 2022.

</span>
<span class="ltx_bibblock">TransWeather: Transformer-based Restoration of Images Degraded by Adverse Weather Conditions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">2022 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2343–2353.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Vaswani, A.; Shazeer, N.; Parmar, N.; Uszkoreit, J.; Jones, L.; Gomez, A. N.; Kaiser, Ł.; and Polosukhin, I. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Wang, T.; Yang, X.; Xu, K.; Chen, S.; Zhang, Q.; and Lau, R. W. 2019.

</span>
<span class="ltx_bibblock">Spatial Attentive Single-Image Deraining With a High Quality Real Rain Dataset.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">2019 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 12262–12271.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023a)</span>
<span class="ltx_bibblock">
Wang, X.; Wang, W.; Cao, Y.; Shen, C.; and Huang, T. 2023a.

</span>
<span class="ltx_bibblock">Images speak in images: A generalist painter for in-context visual learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 6830–6839.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023b)</span>
<span class="ltx_bibblock">
Wang, X.; Zhang, X.; Cao, Y.; Wang, W.; Shen, C.; and Huang, T. 2023b.

</span>
<span class="ltx_bibblock">SegGPT: Towards Segmenting Everything in Context.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 1130–1140.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2022)</span>
<span class="ltx_bibblock">
Wang, Z.; Cun, X.; Bao, J.; Zhou, W.; Liu, J.; and Li, H. 2022.

</span>
<span class="ltx_bibblock">Uformer: A General U-Shaped Transformer for Image Restoration.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">2022 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 17662–17672.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2019)</span>
<span class="ltx_bibblock">
Wei, W.; Meng, D.; Zhao, Q.; Xu, Z.; and Wu, Y. 2019.

</span>
<span class="ltx_bibblock">Semi-Supervised Transfer Learning for Image Rain Removal.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">2019 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 3872–3881.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2021)</span>
<span class="ltx_bibblock">
Wu, H.; Qu, Y.; Lin, S.; Zhou, J.; Qiao, R.; Zhang, Z.; Xie, Y.; and Ma, L. 2021.

</span>
<span class="ltx_bibblock">Contrastive Learning for Compact Single Image Dehazing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">2021 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 10546–10555.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2024)</span>
<span class="ltx_bibblock">
Xu, X.; Kong, S.; Hu, T.; Liu, Z.; and Bao, H. 2024.

</span>
<span class="ltx_bibblock">Boosting Image Restoration via Priors from Pre-trained Models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2900–2909.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al. (2023)</span>
<span class="ltx_bibblock">
Yan, Q.; Jiang, A.; Chen, K.; Peng, L.; Yi, Q.; and Zhang, C. 2023.

</span>
<span class="ltx_bibblock">Textual Prompt Guided Image Restoration.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2312.06162</em>.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2017)</span>
<span class="ltx_bibblock">
Yang, W.; Tan, R. T.; Feng, J.; Liu, J.; Guo, Z.; and Yan, S. 2017.

</span>
<span class="ltx_bibblock">Deep Joint Rain Detection and Removal from a Single Image.

</span>
<span class="ltx_bibblock">In <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">2017 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 1685–1694.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zamir et al. (2022)</span>
<span class="ltx_bibblock">
Zamir, S. W.; Arora, A.; Khan, S.; Hayat, M.; Khan, F. S.; and Yang, M.-H. 2022.

</span>
<span class="ltx_bibblock">Restormer: Efficient Transformer for High-Resolution Image Restoration.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zamir et al. (2021)</span>
<span class="ltx_bibblock">
Zamir, S. W.; Arora, A.; Khan, S.; Hayat, M.; Khan, F. S.; Yang, M.-H.; and Shao, L. 2021.

</span>
<span class="ltx_bibblock">Multi-Stage Progressive Image Restoration.

</span>
<span class="ltx_bibblock">In <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Patel (2018)</span>
<span class="ltx_bibblock">
Zhang, H.; and Patel, V. M. 2018.

</span>
<span class="ltx_bibblock">Densely Connected Pyramid Dehazing Network.

</span>
<span class="ltx_bibblock">In <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">2018 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 3194–3203.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang, Sindagi, and Patel (2020)</span>
<span class="ltx_bibblock">
Zhang, H.; Sindagi, V.; and Patel, V. M. 2020.

</span>
<span class="ltx_bibblock">Joint Transmission Map Estimation and Dehazing Using Deep Networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Circuits and Systems for Video Technology</em>, 30(7): 1975–1986.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2021)</span>
<span class="ltx_bibblock">
Zhang, K.; Li, R.; Yu, Y.; Luo, W.; and Li, C. 2021.

</span>
<span class="ltx_bibblock">Deep Dense Multi-Scale Network for Snow Removal Using Semantic and Depth Priors.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Image Processing</em>, 30: 7419–7431.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Zhang, Q.; Liu, X.; Li, W.; Chen, H.; Liu, J.; Hu, J.; Xiong, Z.; Yuan, C.; and Wang, Y. 2024.

</span>
<span class="ltx_bibblock">Distilling Semantic Priors from SAM to Efficient Image Restoration Models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 25409–25419.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2018)</span>
<span class="ltx_bibblock">
Zhang, R.; Isola, P.; Efros, A. A.; Shechtman, E.; and Wang, O. 2018.

</span>
<span class="ltx_bibblock">The unreasonable effectiveness of deep features as a perceptual metric.

</span>
<span class="ltx_bibblock">In <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, 586–595.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Zhang, R.; Zhang, W.; Fang, R.; Gao, P.; Li, K.; Dai, J.; Qiao, Y.; and Li, H. 2022.

</span>
<span class="ltx_bibblock">Tip-adapter: Training-free adaption of clip for few-shot classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">European Conference on Computer Vision</em>, 493–510. Springer.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2024)</span>
<span class="ltx_bibblock">
Zheng, D.; Wu, X.-M.; Yang, S.; Zhang, J.; Hu, J.-F.; and Zheng, W.-s. 2024.

</span>
<span class="ltx_bibblock">Selective Hourglass Mapping for Universal Image Restoration Based on Diffusion Model.

</span>
<span class="ltx_bibblock">In <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2023)</span>
<span class="ltx_bibblock">
Zhu, Y.; Wang, T.; Fu, X.; Yang, X.; Guo, X.; Dai, J.; Qiao, Y.; and Hu, X. 2023.

</span>
<span class="ltx_bibblock">Learning Weather-General and Weather-Specific Features for Image Restoration Under Multiple Adverse Weather Conditions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">2023 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 21747–21758.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2409.00262" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2409.00263" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2409.00263">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2409.00263" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2409.00265" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Oct  5 23:39:56 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
