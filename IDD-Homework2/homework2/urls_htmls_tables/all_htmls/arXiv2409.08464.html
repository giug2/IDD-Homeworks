<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation</title>
<!--Generated on Fri Sep 13 01:29:45 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.08464v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S1" title="In VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S2" title="In VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S2.SS1" title="In 2 Related Works ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Image Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S2.SS2" title="In 2 Related Works ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Vision Transformer for Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S2.SS3" title="In 2 Related Works ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Token Pruning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S3" title="In VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Task-oriented Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4" title="In VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Vision-Language Guided Patch Pruning</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4.SS1" title="In 4 Vision-Language Guided Patch Pruning ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Preliminary: Segmentation Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4.SS2" title="In 4 Vision-Language Guided Patch Pruning ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Token Pruning Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4.SS3" title="In 4 Vision-Language Guided Patch Pruning ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Prune Decoder Design and Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4.SS4" title="In 4 Vision-Language Guided Patch Pruning ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Pruned Tokens Reactivation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5" title="In VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.SS1" title="In 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Dataset and Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.SS2" title="In 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Vision Language Fintuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.SS3" title="In 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>VLTP Framework Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.SS4" title="In 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Exploration of Pruning Rate and Position</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.SS5" title="In 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Ablation Study and Final Results</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S6" title="In VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hanning Chen<sup class="ltx_sup" id="id14.14.id1"><span class="ltx_text ltx_font_italic" id="id14.14.id1.1">1</span></sup>  Yang Ni<sup class="ltx_sup" id="id15.15.id2"><span class="ltx_text ltx_font_italic" id="id15.15.id2.1">1</span></sup>  Wenjun Huang<sup class="ltx_sup" id="id16.16.id3"><span class="ltx_text ltx_font_italic" id="id16.16.id3.1">1</span></sup>  Yezi Liu<sup class="ltx_sup" id="id17.17.id4"><span class="ltx_text ltx_font_italic" id="id17.17.id4.1">1</span></sup>  SungHeon Jeong<sup class="ltx_sup" id="id18.18.id5"><span class="ltx_text ltx_font_italic" id="id18.18.id5.1">1</span></sup>
<br class="ltx_break"/> Fei Wen<sup class="ltx_sup" id="id19.19.id6"><span class="ltx_text ltx_font_italic" id="id19.19.id6.1">2</span></sup>  Nathaniel Bastian<sup class="ltx_sup" id="id20.20.id7"><span class="ltx_text ltx_font_italic" id="id20.20.id7.1">3</span></sup>  Hugo Latapie<sup class="ltx_sup" id="id21.21.id8"><span class="ltx_text ltx_font_italic" id="id21.21.id8.1">4</span></sup>  Mohsen Imani<sup class="ltx_sup" id="id22.22.id9"><span class="ltx_text ltx_font_italic" id="id22.22.id9.1">1</span></sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id23.23.id10">1</sup> University of California, Irvine, CA, USA 
<br class="ltx_break"/><sup class="ltx_sup" id="id24.24.id11">2</sup> Texas A&amp;M University, College Station, TX, USA 
<br class="ltx_break"/><sup class="ltx_sup" id="id25.25.id12">3</sup> United States Military Academy, West Point, USA 
<br class="ltx_break"/><sup class="ltx_sup" id="id26.26.id13">4</sup> Cisco, San Jose, CA, USA 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id27.27.id14" style="font-size:90%;">{hanningc, m.imani}@uci.edu</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id28.id1">Vision Transformers (ViTs) have emerged as the backbone of many segmentation models, consistently achieving state-of-the-art (SOTA) performance. However, their success comes at a significant computational cost. Image token pruning is one of the most effective strategies to address this complexity.
However, previous approaches fall short when applied to more complex task-oriented segmentation (TOS), where the class of each image patch is not predefined but dependent on the specific input task.
This work introduces the <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="id28.id1.1">V</span>ision <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="id28.id1.2">L</span>anguage Guided <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="id28.id1.3">T</span>oken <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="id28.id1.4">P</span>runing (VLTP), a novel token pruning mechanism that can accelerate ViT-based segmentation models, particularly for TOS guided by multi-modal large language model (MLLM).
We argue that ViT does not need to process every image token through all of its layers—–only the tokens related to reasoning tasks are necessary.
We design a new pruning decoder to take both image tokens and vision-language guidance as input to predict the relevance of each image token to the task. Only image tokens with high relevance are passed to deeper layers of the ViT. Experiments show that the VLTP framework reduces the computational costs of ViT by approximately 25% without performance degradation and by around 40% with only a 1% performance drop.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">ViTs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib9" title="">9</a>]</cite> and multi-head self-attention (MHSA) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib45" title="">45</a>]</cite> have significantly advanced the development of computer vision, where ViTs have been widely used as backbone models for various tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib21" title="">21</a>]</cite>, including image classification <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib4" title="">4</a>]</cite> and segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib22" title="">22</a>]</cite>.
Compared to previous convolutional neural networks (CNN) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib54" title="">54</a>]</cite>, ViT-based models excel in global reasoning through pairwise token attention. However, the success of ViT models comes with a significant computational overhead, which limits their deployment in resource-constrained environments, such as edge computing. This challenge is especially pronounced in segmentation tasks.
Since segmentation requires detailed pixel-wise predictions, they often use high-resolution images, further increasing the number of image patches and leading to a quadratic increase in computation.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="239" id="S1.F1.g1" src="x1.png" width="415"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">(a) Semantic segmentation example. (b) TOS example. (c) For the same image, the segmentation mask and corresponding image patches change when the input task changes.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To improve the efficiency of ViT models, several techniques have been proposed <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib5" title="">5</a>]</cite>.
Among the most notable methods is image token pruning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib44" title="">44</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib31" title="">31</a>]</cite>, which effectively accelerates model inference. These approaches aim to reduce the number of image tokens involved in ViT layers such as the MHSA computation, thus significantly decreasing the computational load due to the inherent quadratic complexity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib45" title="">45</a>]</cite>. For example, the DToP method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib44" title="">44</a>]</cite> aims to predict the semantic class of image tokens in the early layers of ViT, and those with high confidence can be omitted from computations in deeper ViT layers. Alternatively, CTS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib31" title="">31</a>]</cite> aims to combine image tokens that share the same semantic class, thereby reducing the total token count. As illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S1.F1" title="In 1 Introduction ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>(a), these techniques work well for traditional segmentation tasks. However, they are less effective for more complex vision language tasks such as task-oriented segmentation (<span class="ltx_text ltx_font_bold" id="S1.p2.1.1">TOS</span>) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib38" title="">38</a>]</cite>, where the class of each pixel varies depending on the specified task.
As seen in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S1.F1" title="In 1 Introduction ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>(b), TOS involves finding an item’s mask based on the query task. As the task changes, so does the ground truth mask, meaning that each pixel’s class also changes, as shown in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S1.F1" title="In 1 Introduction ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>(c). Directly applying previous methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib44" title="">44</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib31" title="">31</a>]</cite> would lead to a significant loss of visual information and thus low-quality masks during the reasoning stage, because these methods focus on the relevance of image patches to static semantic class, without considering a specific task. A further drawback of earlier approaches is their incompatibility with the latest trending MLLMs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib28" title="">28</a>]</cite> since their pruning strategies did not account for external reasoning guidance. Recently, numerous frameworks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib56" title="">56</a>]</cite> have been proposed to guide vision models in performing vision language tasks using MLLM, such as Referring Expression Segmentation (RES) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib53" title="">53</a>]</cite>. The strong reasoning capability of MLLM makes it promising for solving TOS tasks. Therefore, it is necessary to develop a new token pruning mechanism to accelerate ViT-based segmentation models, especially for TOS tasks guided by MLLM.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this research, we present VLTP (<span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S1.p3.1.1">V</span>ision-<span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S1.p3.1.2">L</span>anguage Guided <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S1.p3.1.3">T</span>oken <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S1.p3.1.4">P</span>runing), a new ViT token pruning technique for TOS. The core concept of VLTP is that <span class="ltx_text ltx_font_bold" id="S1.p3.1.5">only tokens relevant to reasoning tasks should be processed by all ViT layers</span>. We design a novel prune decoder and insert it at multiple selected layers of ViT to provide flexible multi-stage pruning. The prune decoder predicts the relevance of image tokens to the reasoning tasks, leveraging the guidance from MLLM. Based on the relevance predictions from the prune decoder, VLTP retains only the image tokens with high relation scores and forwards them to the following layers of ViT. By removing unrelated tokens that participated in ViT computation, we effectively accelerate the ViT model while preserving its high reasoning efficacy. To mitigate mispredictions by the prune decoder (e.g., due to pruning in the early stages of ViT), image tokens dropped are reactivated in the next pruning stage for re-evaluation of token relevance as well as in the mask generation. The contributions of the work are summarized as follows:</p>
</div>
<div class="ltx_para" id="S1.p4">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a token pruning strategy aimed at TOS with ViT-based models. By leveraging guidance from MLLM, our approach removes image tokens with low task relevance from later computation, thereby forcing the model to concentrate on important image tokens pertinent to the task.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">To the best of our knowledge, this is the first ViT token pruning method that takes MLLM guidance into consideration. Unlike previous works that focus on traditional vision-only tasks (such as image classification and segmentation), this work is also the first to investigate ViT pruning in vision-language reasoning tasks.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Experiments on visual reasoning tasks show that VLTP reduces the computational costs of ViT by approximately 25% without any performance degradation and by around 40% with only a 1% performance drop.
Guided by MLLM, our VLTP-integrated segmentation model outperforms the SOTA methods, achieving a +2.5% improvement in mIoU.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Image Segmentation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Image segmentation is the process of dividing an image into distinct regions or segments, each representing different objects or areas of interest. Traditional segmentation tasks include instance segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib47" title="">47</a>]</cite> and semantic segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib35" title="">35</a>]</cite>. Instance segmentation identifies and separates individual objects in an image, assigning a unique label to each object instance. Semantic segmentation, on the other hand, classifies every pixel, partitioning the image into meaningful regions based on visual characteristics. These traditional segmentation tasks are typically image-based, where pixels are categorized into predefined classes, as shown in  <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S1.F1" title="In 1 Introduction ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>(a).
More recently, segmentation tasks that incorporate both image and text inputs have emerged, such as RES <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib32" title="">32</a>]</cite> and affordance detection <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib8" title="">8</a>]</cite>. These tasks involve identifying object masks using a specified text query. Building on these approaches, more complex task-driven <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib40" title="">40</a>]</cite> and intention-driven <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib38" title="">38</a>]</cite> segmentation tasks have been introduced, focusing on locating appropriate items to accomplish a given task (or intention, which is a more abstract task). An example of Task-Oriented Segmentation (TOS) is shown in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S1.F1" title="In 1 Introduction ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>(b). These novel TOS tasks require models to perform not only visual recognition and scene comprehension but also engage in logical reasoning.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Vision Transformer for Segmentation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">ViT has become a popular backbone network for segmentation tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib58" title="">58</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib42" title="">42</a>]</cite>. Compared to CNN-based segmentation models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib18" title="">18</a>]</cite>, the global attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib45" title="">45</a>]</cite> enables ViTs to better understand complex scenes and achieve higher segmentation accuracy, in scenarios with intricate object relationships. The ViT-backbone also facilitates the integration of text embedding information, allowing the model to leverage additional semantic context for more accurate and complex segmentation task <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib22" title="">22</a>]</cite>. However, the computational cost of ViT limits its deployment, particularly in high-resolution image segmentation tasks. The need for deeper networks and numerous image tokens makes model compression essential for practical applications.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Token Pruning</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Token pruning has been shown to be an effective mechanism for accelerating ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib39" title="">39</a>]</cite>. The key idea behind token pruning is the sparsification of image tokens. Since ViT’s attention computation latency and memory requirements are quadratic to the sequence length of the image tokens <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib20" title="">20</a>]</cite>, reducing the number of tokens involved in computation has proven to be an effective method for accelerating ViT. Existing ViT token pruning techniques have been successful in image classification <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib36" title="">36</a>]</cite> and traditional image segmentation tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib44" title="">44</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib31" title="">31</a>]</cite>, but they are difficult to apply in TOS tasks. Previous ViT token pruning methods rely on estimating the semantic class of tokens and either dropping easily predictable tokens or merging tokens that share the same semantic class. However, as shown in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S1.F1" title="In 1 Introduction ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>(c), which illustrates the challenge in TOS tasks, the label of pixel changes with the task. That is, the importance of pixels is ambiguous without extra information. Therefore, a new pruning mechanism is needed that considers both image visual information and task-based reasoning, enabling the acceleration of the ViT while ensuring the model generates high-quality masks.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Task-oriented Segmentation</h2>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="210" id="S3.F2.g1" src="x2.png" width="415"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.3.2" style="font-size:90%;">Multi-model LLM (MLLM) guide segmentation model for TOS.</span></figcaption>
</figure>
<figure class="ltx_table" id="S3.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.2" style="width:216.8pt;height:164.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-1.9pt,1.4pt) scale(0.982892153899088,0.982892153899088) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="3" id="S3.T1.2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.2.1.1.1.1.1">(a) Comparison with Previous Works</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.2.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.2.1.2.2.1">Previous works</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" colspan="2" id="S3.T1.2.1.2.2.2">
<table class="ltx_tabular ltx_align_middle" id="S3.T1.2.1.2.2.2.1">
<tr class="ltx_tr" id="S3.T1.2.1.2.2.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.2.1.2.2.2.1.1.1">1. MLLM quantization, Pruning, and KG distillation.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.2.1.2.2.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.2.1.2.2.2.1.2.1">2. ViT pruning without LLM guidance.</td>
</tr>
</table>
</th>
</tr>
<tr class="ltx_tr" id="S3.T1.2.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.2.1.3.3.1">This work</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" colspan="2" id="S3.T1.2.1.3.3.2">ViT pruning under LLM guidance.</th>
</tr>
<tr class="ltx_tr" id="S3.T1.2.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="3" id="S3.T1.2.1.4.4.1"><span class="ltx_text ltx_font_bold" id="S3.T1.2.1.4.4.1.1">(b) Latency Breakdown (single image and single text)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.2.1.5.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.2.1.5.1.1" rowspan="2"><span class="ltx_text" id="S3.T1.2.1.5.1.1.1">MLLM (LLaVA 7B)</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S3.T1.2.1.5.1.2">Segment Anything (SAM)</td>
</tr>
<tr class="ltx_tr" id="S3.T1.2.1.6.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.2.1.6.2.1">ViT-H</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.1.6.2.2">Mask Decoder</td>
</tr>
<tr class="ltx_tr" id="S3.T1.2.1.7.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.2.1.7.3.1">71.0 ms</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.2.1.7.3.2">97.7 ms</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.1.7.3.3">8.9 ms</td>
</tr>
<tr class="ltx_tr" id="S3.T1.2.1.8.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S3.T1.2.1.8.4.1">40%</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S3.T1.2.1.8.4.2">55%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T1.2.1.8.4.3">5%</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.3.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S3.T1.4.2" style="font-size:90%;">(a) Comparison with previous works. (b) MLLM guide segmentation model latency breakdown. We conudct the benchmark using an RTX A6000 GPU with the RIO dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib38" title="">38</a>]</cite>.</span></figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.3"><span class="ltx_text ltx_font_bold" id="S3.p1.3.1">Problem Definition:</span> The TOS task is formulated as follows: with an input image <math alttext="X_{img}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><msub id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">X</mi><mrow id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml"><mi id="S3.p1.1.m1.1.1.3.2" xref="S3.p1.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.p1.1.m1.1.1.3.1" xref="S3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.p1.1.m1.1.1.3.3" xref="S3.p1.1.m1.1.1.3.3.cmml">m</mi><mo id="S3.p1.1.m1.1.1.3.1a" xref="S3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.p1.1.m1.1.1.3.4" xref="S3.p1.1.m1.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝑋</ci><apply id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3"><times id="S3.p1.1.m1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.3.1"></times><ci id="S3.p1.1.m1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S3.p1.1.m1.1.1.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3">𝑚</ci><ci id="S3.p1.1.m1.1.1.3.4.cmml" xref="S3.p1.1.m1.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">X_{img}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_X start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT</annotation></semantics></math> and a task <math alttext="X_{txt}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><msub id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">X</mi><mrow id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml"><mi id="S3.p1.2.m2.1.1.3.2" xref="S3.p1.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.p1.2.m2.1.1.3.1" xref="S3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.p1.2.m2.1.1.3.3" xref="S3.p1.2.m2.1.1.3.3.cmml">x</mi><mo id="S3.p1.2.m2.1.1.3.1a" xref="S3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.p1.2.m2.1.1.3.4" xref="S3.p1.2.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝑋</ci><apply id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3"><times id="S3.p1.2.m2.1.1.3.1.cmml" xref="S3.p1.2.m2.1.1.3.1"></times><ci id="S3.p1.2.m2.1.1.3.2.cmml" xref="S3.p1.2.m2.1.1.3.2">𝑡</ci><ci id="S3.p1.2.m2.1.1.3.3.cmml" xref="S3.p1.2.m2.1.1.3.3">𝑥</ci><ci id="S3.p1.2.m2.1.1.3.4.cmml" xref="S3.p1.2.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">X_{txt}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_X start_POSTSUBSCRIPT italic_t italic_x italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, we need to find the segmentation mask <math alttext="X_{res}" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><msub id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mi id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">X</mi><mrow id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml"><mi id="S3.p1.3.m3.1.1.3.2" xref="S3.p1.3.m3.1.1.3.2.cmml">r</mi><mo id="S3.p1.3.m3.1.1.3.1" xref="S3.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.p1.3.m3.1.1.3.3" xref="S3.p1.3.m3.1.1.3.3.cmml">e</mi><mo id="S3.p1.3.m3.1.1.3.1a" xref="S3.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.p1.3.m3.1.1.3.4" xref="S3.p1.3.m3.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2">𝑋</ci><apply id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3"><times id="S3.p1.3.m3.1.1.3.1.cmml" xref="S3.p1.3.m3.1.1.3.1"></times><ci id="S3.p1.3.m3.1.1.3.2.cmml" xref="S3.p1.3.m3.1.1.3.2">𝑟</ci><ci id="S3.p1.3.m3.1.1.3.3.cmml" xref="S3.p1.3.m3.1.1.3.3">𝑒</ci><ci id="S3.p1.3.m3.1.1.3.4.cmml" xref="S3.p1.3.m3.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">X_{res}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_X start_POSTSUBSCRIPT italic_r italic_e italic_s end_POSTSUBSCRIPT</annotation></semantics></math> for all suitable affordances.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="X_{res}=\mathbf{F}(X_{img},X_{txt})" class="ltx_Math" display="block" id="S3.E1.m1.2"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><msub id="S3.E1.m1.2.2.4" xref="S3.E1.m1.2.2.4.cmml"><mi id="S3.E1.m1.2.2.4.2" xref="S3.E1.m1.2.2.4.2.cmml">X</mi><mrow id="S3.E1.m1.2.2.4.3" xref="S3.E1.m1.2.2.4.3.cmml"><mi id="S3.E1.m1.2.2.4.3.2" xref="S3.E1.m1.2.2.4.3.2.cmml">r</mi><mo id="S3.E1.m1.2.2.4.3.1" xref="S3.E1.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.4.3.3" xref="S3.E1.m1.2.2.4.3.3.cmml">e</mi><mo id="S3.E1.m1.2.2.4.3.1a" xref="S3.E1.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.4.3.4" xref="S3.E1.m1.2.2.4.3.4.cmml">s</mi></mrow></msub><mo id="S3.E1.m1.2.2.3" xref="S3.E1.m1.2.2.3.cmml">=</mo><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.4.cmml">𝐅</mi><mo id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.3.cmml"><mo id="S3.E1.m1.2.2.2.2.2.3" stretchy="false" xref="S3.E1.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">X</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.cmml">m</mi><mo id="S3.E1.m1.1.1.1.1.1.1.3.1a" xref="S3.E1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.1.1.1.1.3.4" xref="S3.E1.m1.1.1.1.1.1.1.3.4.cmml">g</mi></mrow></msub><mo id="S3.E1.m1.2.2.2.2.2.4" xref="S3.E1.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.cmml">X</mi><mrow id="S3.E1.m1.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.3.2" xref="S3.E1.m1.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E1.m1.2.2.2.2.2.2.3.1" xref="S3.E1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.2.2.2.2.3.3" xref="S3.E1.m1.2.2.2.2.2.2.3.3.cmml">x</mi><mo id="S3.E1.m1.2.2.2.2.2.2.3.1a" xref="S3.E1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.2.2.2.2.3.4" xref="S3.E1.m1.2.2.2.2.2.2.3.4.cmml">t</mi></mrow></msub><mo id="S3.E1.m1.2.2.2.2.2.5" stretchy="false" xref="S3.E1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><eq id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2.3"></eq><apply id="S3.E1.m1.2.2.4.cmml" xref="S3.E1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.4.1.cmml" xref="S3.E1.m1.2.2.4">subscript</csymbol><ci id="S3.E1.m1.2.2.4.2.cmml" xref="S3.E1.m1.2.2.4.2">𝑋</ci><apply id="S3.E1.m1.2.2.4.3.cmml" xref="S3.E1.m1.2.2.4.3"><times id="S3.E1.m1.2.2.4.3.1.cmml" xref="S3.E1.m1.2.2.4.3.1"></times><ci id="S3.E1.m1.2.2.4.3.2.cmml" xref="S3.E1.m1.2.2.4.3.2">𝑟</ci><ci id="S3.E1.m1.2.2.4.3.3.cmml" xref="S3.E1.m1.2.2.4.3.3">𝑒</ci><ci id="S3.E1.m1.2.2.4.3.4.cmml" xref="S3.E1.m1.2.2.4.3.4">𝑠</ci></apply></apply><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><times id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3"></times><ci id="S3.E1.m1.2.2.2.4.cmml" xref="S3.E1.m1.2.2.2.4">𝐅</ci><interval closure="open" id="S3.E1.m1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">𝑋</ci><apply id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><times id="S3.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3">𝑚</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.4">𝑔</ci></apply></apply><apply id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2">𝑋</ci><apply id="S3.E1.m1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3"><times id="S3.E1.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3.1"></times><ci id="S3.E1.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3.2">𝑡</ci><ci id="S3.E1.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3.3">𝑥</ci><ci id="S3.E1.m1.2.2.2.2.2.2.3.4.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3.4">𝑡</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">X_{res}=\mathbf{F}(X_{img},X_{txt})</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.2d">italic_X start_POSTSUBSCRIPT italic_r italic_e italic_s end_POSTSUBSCRIPT = bold_F ( italic_X start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT italic_t italic_x italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p1.5">Here <span class="ltx_text ltx_font_bold" id="S3.p1.5.1">F</span> refers to the model to solve the task. As shown in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S3.F2" title="In 3 Task-oriented Segmentation ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, to solve the task “<span class="ltx_text ltx_font_italic" id="S3.p1.5.2">You can ride the
thing to your destination</span>”, we need to find the mask of the object “<span class="ltx_text ltx_font_italic" id="S3.p1.5.3">bus</span>”. In this paper, we propose to leverage a nature paradigm to solve this task. We first query an MLLM, such as LLaVA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib28" title="">28</a>]</cite>, to perform reasoning over the image based on the task and generate a special token <math alttext="\langle" class="ltx_Math" display="inline" id="S3.p1.4.m1.1"><semantics id="S3.p1.4.m1.1a"><mo id="S3.p1.4.m1.1.1" stretchy="false" xref="S3.p1.4.m1.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="S3.p1.4.m1.1b"><ci id="S3.p1.4.m1.1.1.cmml" xref="S3.p1.4.m1.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m1.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m1.1d">⟨</annotation></semantics></math><span class="ltx_text" id="S3.p1.5.4">SEG</span><math alttext="\rangle" class="ltx_Math" display="inline" id="S3.p1.5.m2.1"><semantics id="S3.p1.5.m2.1a"><mo id="S3.p1.5.m2.1.1" stretchy="false" xref="S3.p1.5.m2.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="S3.p1.5.m2.1b"><ci id="S3.p1.5.m2.1.1.cmml" xref="S3.p1.5.m2.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m2.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m2.1d">⟩</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\langle SEG\rangle=\mathbf{F}_{LLM}(X_{img},X_{txt})" class="ltx_Math" display="block" id="S3.E2.m1.3"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.1.1.1.2.1.cmml">⟨</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">S</mi><mo id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">E</mi><mo id="S3.E2.m1.1.1.1.1.1.1a" xref="S3.E2.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.1.4.cmml">G</mi></mrow><mo id="S3.E2.m1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.1.1.1.2.1.cmml">⟩</mo></mrow><mo id="S3.E2.m1.3.3.4" xref="S3.E2.m1.3.3.4.cmml">=</mo><mrow id="S3.E2.m1.3.3.3" xref="S3.E2.m1.3.3.3.cmml"><msub id="S3.E2.m1.3.3.3.4" xref="S3.E2.m1.3.3.3.4.cmml"><mi id="S3.E2.m1.3.3.3.4.2" xref="S3.E2.m1.3.3.3.4.2.cmml">𝐅</mi><mrow id="S3.E2.m1.3.3.3.4.3" xref="S3.E2.m1.3.3.3.4.3.cmml"><mi id="S3.E2.m1.3.3.3.4.3.2" xref="S3.E2.m1.3.3.3.4.3.2.cmml">L</mi><mo id="S3.E2.m1.3.3.3.4.3.1" xref="S3.E2.m1.3.3.3.4.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.3.4.3.3" xref="S3.E2.m1.3.3.3.4.3.3.cmml">L</mi><mo id="S3.E2.m1.3.3.3.4.3.1a" xref="S3.E2.m1.3.3.3.4.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.3.4.3.4" xref="S3.E2.m1.3.3.3.4.3.4.cmml">M</mi></mrow></msub><mo id="S3.E2.m1.3.3.3.3" xref="S3.E2.m1.3.3.3.3.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.3.2.2" xref="S3.E2.m1.3.3.3.2.3.cmml"><mo id="S3.E2.m1.3.3.3.2.2.3" stretchy="false" xref="S3.E2.m1.3.3.3.2.3.cmml">(</mo><msub id="S3.E2.m1.2.2.2.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.1.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.2.cmml">X</mi><mrow id="S3.E2.m1.2.2.2.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.2.1.1.1.3.2" xref="S3.E2.m1.2.2.2.1.1.1.3.2.cmml">i</mi><mo id="S3.E2.m1.2.2.2.1.1.1.3.1" xref="S3.E2.m1.2.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.2.1.1.1.3.3" xref="S3.E2.m1.2.2.2.1.1.1.3.3.cmml">m</mi><mo id="S3.E2.m1.2.2.2.1.1.1.3.1a" xref="S3.E2.m1.2.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.2.1.1.1.3.4" xref="S3.E2.m1.2.2.2.1.1.1.3.4.cmml">g</mi></mrow></msub><mo id="S3.E2.m1.3.3.3.2.2.4" xref="S3.E2.m1.3.3.3.2.3.cmml">,</mo><msub id="S3.E2.m1.3.3.3.2.2.2" xref="S3.E2.m1.3.3.3.2.2.2.cmml"><mi id="S3.E2.m1.3.3.3.2.2.2.2" xref="S3.E2.m1.3.3.3.2.2.2.2.cmml">X</mi><mrow id="S3.E2.m1.3.3.3.2.2.2.3" xref="S3.E2.m1.3.3.3.2.2.2.3.cmml"><mi id="S3.E2.m1.3.3.3.2.2.2.3.2" xref="S3.E2.m1.3.3.3.2.2.2.3.2.cmml">t</mi><mo id="S3.E2.m1.3.3.3.2.2.2.3.1" xref="S3.E2.m1.3.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.3.2.2.2.3.3" xref="S3.E2.m1.3.3.3.2.2.2.3.3.cmml">x</mi><mo id="S3.E2.m1.3.3.3.2.2.2.3.1a" xref="S3.E2.m1.3.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.3.2.2.2.3.4" xref="S3.E2.m1.3.3.3.2.2.2.3.4.cmml">t</mi></mrow></msub><mo id="S3.E2.m1.3.3.3.2.2.5" stretchy="false" xref="S3.E2.m1.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3"><eq id="S3.E2.m1.3.3.4.cmml" xref="S3.E2.m1.3.3.4"></eq><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"></times><ci id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2">𝑆</ci><ci id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">𝐸</ci><ci id="S3.E2.m1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.1.4">𝐺</ci></apply></apply><apply id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3.3"><times id="S3.E2.m1.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3"></times><apply id="S3.E2.m1.3.3.3.4.cmml" xref="S3.E2.m1.3.3.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.4.1.cmml" xref="S3.E2.m1.3.3.3.4">subscript</csymbol><ci id="S3.E2.m1.3.3.3.4.2.cmml" xref="S3.E2.m1.3.3.3.4.2">𝐅</ci><apply id="S3.E2.m1.3.3.3.4.3.cmml" xref="S3.E2.m1.3.3.3.4.3"><times id="S3.E2.m1.3.3.3.4.3.1.cmml" xref="S3.E2.m1.3.3.3.4.3.1"></times><ci id="S3.E2.m1.3.3.3.4.3.2.cmml" xref="S3.E2.m1.3.3.3.4.3.2">𝐿</ci><ci id="S3.E2.m1.3.3.3.4.3.3.cmml" xref="S3.E2.m1.3.3.3.4.3.3">𝐿</ci><ci id="S3.E2.m1.3.3.3.4.3.4.cmml" xref="S3.E2.m1.3.3.3.4.3.4">𝑀</ci></apply></apply><interval closure="open" id="S3.E2.m1.3.3.3.2.3.cmml" xref="S3.E2.m1.3.3.3.2.2"><apply id="S3.E2.m1.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.2">𝑋</ci><apply id="S3.E2.m1.2.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.3"><times id="S3.E2.m1.2.2.2.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.3.1"></times><ci id="S3.E2.m1.2.2.2.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.3.2">𝑖</ci><ci id="S3.E2.m1.2.2.2.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.3.3">𝑚</ci><ci id="S3.E2.m1.2.2.2.1.1.1.3.4.cmml" xref="S3.E2.m1.2.2.2.1.1.1.3.4">𝑔</ci></apply></apply><apply id="S3.E2.m1.3.3.3.2.2.2.cmml" xref="S3.E2.m1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.2.2.2.1.cmml" xref="S3.E2.m1.3.3.3.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.3.2.2.2.2.cmml" xref="S3.E2.m1.3.3.3.2.2.2.2">𝑋</ci><apply id="S3.E2.m1.3.3.3.2.2.2.3.cmml" xref="S3.E2.m1.3.3.3.2.2.2.3"><times id="S3.E2.m1.3.3.3.2.2.2.3.1.cmml" xref="S3.E2.m1.3.3.3.2.2.2.3.1"></times><ci id="S3.E2.m1.3.3.3.2.2.2.3.2.cmml" xref="S3.E2.m1.3.3.3.2.2.2.3.2">𝑡</ci><ci id="S3.E2.m1.3.3.3.2.2.2.3.3.cmml" xref="S3.E2.m1.3.3.3.2.2.2.3.3">𝑥</ci><ci id="S3.E2.m1.3.3.3.2.2.2.3.4.cmml" xref="S3.E2.m1.3.3.3.2.2.2.3.4">𝑡</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\langle SEG\rangle=\mathbf{F}_{LLM}(X_{img},X_{txt})</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.3d">⟨ italic_S italic_E italic_G ⟩ = bold_F start_POSTSUBSCRIPT italic_L italic_L italic_M end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT italic_t italic_x italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p1.7">Next, the special token is treated as a pointer to guide the segmentation model (such as Segment Anything (SAM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib22" title="">22</a>]</cite>) to find the mask.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="X_{res}=\mathbf{F}_{seg}(X_{img},\langle SEG\rangle)" class="ltx_Math" display="block" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><msub id="S3.E3.m1.2.2.4" xref="S3.E3.m1.2.2.4.cmml"><mi id="S3.E3.m1.2.2.4.2" xref="S3.E3.m1.2.2.4.2.cmml">X</mi><mrow id="S3.E3.m1.2.2.4.3" xref="S3.E3.m1.2.2.4.3.cmml"><mi id="S3.E3.m1.2.2.4.3.2" xref="S3.E3.m1.2.2.4.3.2.cmml">r</mi><mo id="S3.E3.m1.2.2.4.3.1" xref="S3.E3.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.4.3.3" xref="S3.E3.m1.2.2.4.3.3.cmml">e</mi><mo id="S3.E3.m1.2.2.4.3.1a" xref="S3.E3.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.4.3.4" xref="S3.E3.m1.2.2.4.3.4.cmml">s</mi></mrow></msub><mo id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.2.3.cmml">=</mo><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><msub id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.4.cmml"><mi id="S3.E3.m1.2.2.2.4.2" xref="S3.E3.m1.2.2.2.4.2.cmml">𝐅</mi><mrow id="S3.E3.m1.2.2.2.4.3" xref="S3.E3.m1.2.2.2.4.3.cmml"><mi id="S3.E3.m1.2.2.2.4.3.2" xref="S3.E3.m1.2.2.2.4.3.2.cmml">s</mi><mo id="S3.E3.m1.2.2.2.4.3.1" xref="S3.E3.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.2.4.3.3" xref="S3.E3.m1.2.2.2.4.3.3.cmml">e</mi><mo id="S3.E3.m1.2.2.2.4.3.1a" xref="S3.E3.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.2.4.3.4" xref="S3.E3.m1.2.2.2.4.3.4.cmml">g</mi></mrow></msub><mo id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.3.cmml"><mo id="S3.E3.m1.2.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml">X</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E3.m1.1.1.1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.3.cmml">m</mi><mo id="S3.E3.m1.1.1.1.1.1.1.3.1a" xref="S3.E3.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.1.1.1.1.3.4" xref="S3.E3.m1.1.1.1.1.1.1.3.4.cmml">g</mi></mrow></msub><mo id="S3.E3.m1.2.2.2.2.2.4" xref="S3.E3.m1.2.2.2.2.3.cmml">,</mo><mrow id="S3.E3.m1.2.2.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.2.2.cmml"><mo id="S3.E3.m1.2.2.2.2.2.2.1.2" stretchy="false" xref="S3.E3.m1.2.2.2.2.2.2.2.1.cmml">⟨</mo><mrow id="S3.E3.m1.2.2.2.2.2.2.1.1" xref="S3.E3.m1.2.2.2.2.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.1.1.2" xref="S3.E3.m1.2.2.2.2.2.2.1.1.2.cmml">S</mi><mo id="S3.E3.m1.2.2.2.2.2.2.1.1.1" xref="S3.E3.m1.2.2.2.2.2.2.1.1.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.2.2.2.2.1.1.3" xref="S3.E3.m1.2.2.2.2.2.2.1.1.3.cmml">E</mi><mo id="S3.E3.m1.2.2.2.2.2.2.1.1.1a" xref="S3.E3.m1.2.2.2.2.2.2.1.1.1.cmml">⁢</mo><mi id="S3.E3.m1.2.2.2.2.2.2.1.1.4" xref="S3.E3.m1.2.2.2.2.2.2.1.1.4.cmml">G</mi></mrow><mo id="S3.E3.m1.2.2.2.2.2.2.1.3" stretchy="false" xref="S3.E3.m1.2.2.2.2.2.2.2.1.cmml">⟩</mo></mrow><mo id="S3.E3.m1.2.2.2.2.2.5" stretchy="false" xref="S3.E3.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><eq id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2.3"></eq><apply id="S3.E3.m1.2.2.4.cmml" xref="S3.E3.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.4.1.cmml" xref="S3.E3.m1.2.2.4">subscript</csymbol><ci id="S3.E3.m1.2.2.4.2.cmml" xref="S3.E3.m1.2.2.4.2">𝑋</ci><apply id="S3.E3.m1.2.2.4.3.cmml" xref="S3.E3.m1.2.2.4.3"><times id="S3.E3.m1.2.2.4.3.1.cmml" xref="S3.E3.m1.2.2.4.3.1"></times><ci id="S3.E3.m1.2.2.4.3.2.cmml" xref="S3.E3.m1.2.2.4.3.2">𝑟</ci><ci id="S3.E3.m1.2.2.4.3.3.cmml" xref="S3.E3.m1.2.2.4.3.3">𝑒</ci><ci id="S3.E3.m1.2.2.4.3.4.cmml" xref="S3.E3.m1.2.2.4.3.4">𝑠</ci></apply></apply><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><times id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3"></times><apply id="S3.E3.m1.2.2.2.4.cmml" xref="S3.E3.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.4.1.cmml" xref="S3.E3.m1.2.2.2.4">subscript</csymbol><ci id="S3.E3.m1.2.2.2.4.2.cmml" xref="S3.E3.m1.2.2.2.4.2">𝐅</ci><apply id="S3.E3.m1.2.2.2.4.3.cmml" xref="S3.E3.m1.2.2.2.4.3"><times id="S3.E3.m1.2.2.2.4.3.1.cmml" xref="S3.E3.m1.2.2.2.4.3.1"></times><ci id="S3.E3.m1.2.2.2.4.3.2.cmml" xref="S3.E3.m1.2.2.2.4.3.2">𝑠</ci><ci id="S3.E3.m1.2.2.2.4.3.3.cmml" xref="S3.E3.m1.2.2.2.4.3.3">𝑒</ci><ci id="S3.E3.m1.2.2.2.4.3.4.cmml" xref="S3.E3.m1.2.2.2.4.3.4">𝑔</ci></apply></apply><interval closure="open" id="S3.E3.m1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2"><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">𝑋</ci><apply id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><times id="S3.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3">𝑚</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.4">𝑔</ci></apply></apply><apply id="S3.E3.m1.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.2">delimited-⟨⟩</csymbol><apply id="S3.E3.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.1"><times id="S3.E3.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.1.1"></times><ci id="S3.E3.m1.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.1.2">𝑆</ci><ci id="S3.E3.m1.2.2.2.2.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.1.3">𝐸</ci><ci id="S3.E3.m1.2.2.2.2.2.2.1.1.4.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.1.4">𝐺</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">X_{res}=\mathbf{F}_{seg}(X_{img},\langle SEG\rangle)</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">italic_X start_POSTSUBSCRIPT italic_r italic_e italic_s end_POSTSUBSCRIPT = bold_F start_POSTSUBSCRIPT italic_s italic_e italic_g end_POSTSUBSCRIPT ( italic_X start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT , ⟨ italic_S italic_E italic_G ⟩ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p1.6">, where <span class="ltx_text ltx_font_bold" id="S3.p1.6.1">F<sub class="ltx_sub" id="S3.p1.6.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S3.p1.6.1.1.1">seg</span></sub></span> is the segmentation model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.1"><span class="ltx_text ltx_font_bold" id="S3.p2.1.1">Comparison to Earlier TOS Solutions:</span> In addressing reasoning-intensive task-oriented object detection and segmentation tasks (e.g., COCO-Tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib40" title="">40</a>]</cite> and RIO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib38" title="">38</a>]</cite> datasets), two main types of solutions exist: single-stage and two-stage frameworks. Single-stage frameworks, such as MDETR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib19" title="">19</a>]</cite> and Polyformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib29" title="">29</a>]</cite>, directly combine image features and text features and perform end-to-end training of the entire system. The drawback of single-stage frameworks is their lack of logical reasoning capabilities. Consequently, recent works like CoTDet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib43" title="">43</a>]</cite> and TaskCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib6" title="">6</a>]</cite> introduce two-stage frameworks that combine the reasoning abilities of LLMs with the object detection and segmentation capabilities of vision models. However, these frameworks require LLMs to explicitly generate task-dependent feature words and rationale. Sometimes the LLM provides only a vague indicator, such as a special token embedding, rather than a clear rationale. In contrast to these previous works, our two-step framework seamlessly integrates the robust reasoning abilities of MLLMs with the superior segmentation quality of vision foundation models.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.2"><span class="ltx_text ltx_font_bold" id="S3.p3.2.1">Nevertheless, a key challenge remains: the computational expense of two-stage framework is extremely high.</span> Previous research <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib51" title="">51</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib59" title="">59</a>]</cite> has primarily focused on MLLM’s compression and pruning, largely overlooking the segmentation model, as depicted in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S3.T1" title="In 3 Task-oriented Segmentation ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a>.(a). The segmentation model, as shown in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S3.T1" title="In 3 Task-oriented Segmentation ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a>(b), requires even more computational resources than MLLM. Following this, we will explore ways to enhance the efficiency of the segmentation model under the guidance of MLLM’s instruction token <math alttext="\langle" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><mo id="S3.p3.1.m1.1.1" stretchy="false" xref="S3.p3.1.m1.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">⟨</annotation></semantics></math><span class="ltx_text" id="S3.p3.2.2">SEG</span><math alttext="\rangle" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><mo id="S3.p3.2.m2.1.1" stretchy="false" xref="S3.p3.2.m2.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">⟩</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Vision-Language Guided Patch Pruning</h2>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="488" id="S4.F3.g1" src="x3.png" width="856"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.3.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.4.2" style="font-size:90%;">The illustration of vision-language guided token pruning (<span class="ltx_text ltx_font_bold" id="S4.F3.4.2.1">VLTP</span>) framework. (a) ViT architecture with prune decoder. (b) Prune decoder model architecture. In this illustration, we consider an image with only 9 patch tokens.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">As illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S3.T1" title="In 3 Task-oriented Segmentation ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a>(b), the ViT’s computation latency constitutes more than 90% of the total latency of the entire segmentation model. Thus, enhancing the ViT’s efficiency is essential for optimizing the segmentation model’s performance. This work introduces a vision-language guided token pruning method, which accelerates ViT when handling TOS. We detail the mechanism in the following sections.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Preliminary: Segmentation Model</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.5">Refer to <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S3.F2" title="In 3 Task-oriented Segmentation ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, a segmentation model <math alttext="\textbf{F}_{seg}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2a.cmml">F</mtext><mrow id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml"><mi id="S4.SS1.p1.1.m1.1.1.3.2" xref="S4.SS1.p1.1.m1.1.1.3.2.cmml">s</mi><mo id="S4.SS1.p1.1.m1.1.1.3.1" xref="S4.SS1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.1.m1.1.1.3.3" xref="S4.SS1.p1.1.m1.1.1.3.3.cmml">e</mi><mo id="S4.SS1.p1.1.m1.1.1.3.1a" xref="S4.SS1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.1.m1.1.1.3.4" xref="S4.SS1.p1.1.m1.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2a.cmml" xref="S4.SS1.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">F</mtext></ci><apply id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3"><times id="S4.SS1.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.3.1"></times><ci id="S4.SS1.p1.1.m1.1.1.3.2.cmml" xref="S4.SS1.p1.1.m1.1.1.3.2">𝑠</ci><ci id="S4.SS1.p1.1.m1.1.1.3.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S4.SS1.p1.1.m1.1.1.3.4.cmml" xref="S4.SS1.p1.1.m1.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\textbf{F}_{seg}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">F start_POSTSUBSCRIPT italic_s italic_e italic_g end_POSTSUBSCRIPT</annotation></semantics></math> typically consists of two components: a vision backbone <math alttext="\textbf{F}_{enc}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2a.cmml">F</mtext><mrow id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3.2" xref="S4.SS1.p1.2.m2.1.1.3.2.cmml">e</mi><mo id="S4.SS1.p1.2.m2.1.1.3.1" xref="S4.SS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.1.1.3.3" xref="S4.SS1.p1.2.m2.1.1.3.3.cmml">n</mi><mo id="S4.SS1.p1.2.m2.1.1.3.1a" xref="S4.SS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.1.1.3.4" xref="S4.SS1.p1.2.m2.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2a.cmml" xref="S4.SS1.p1.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">F</mtext></ci><apply id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3"><times id="S4.SS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3.1"></times><ci id="S4.SS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.2">𝑒</ci><ci id="S4.SS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3">𝑛</ci><ci id="S4.SS1.p1.2.m2.1.1.3.4.cmml" xref="S4.SS1.p1.2.m2.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\textbf{F}_{enc}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">F start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and a mask decoder <math alttext="\textbf{F}_{dec}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2a.cmml">F</mtext><mrow id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml"><mi id="S4.SS1.p1.3.m3.1.1.3.2" xref="S4.SS1.p1.3.m3.1.1.3.2.cmml">d</mi><mo id="S4.SS1.p1.3.m3.1.1.3.1" xref="S4.SS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.1.1.3.3" xref="S4.SS1.p1.3.m3.1.1.3.3.cmml">e</mi><mo id="S4.SS1.p1.3.m3.1.1.3.1a" xref="S4.SS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.1.1.3.4" xref="S4.SS1.p1.3.m3.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2a.cmml" xref="S4.SS1.p1.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">F</mtext></ci><apply id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3"><times id="S4.SS1.p1.3.m3.1.1.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3.1"></times><ci id="S4.SS1.p1.3.m3.1.1.3.2.cmml" xref="S4.SS1.p1.3.m3.1.1.3.2">𝑑</ci><ci id="S4.SS1.p1.3.m3.1.1.3.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3">𝑒</ci><ci id="S4.SS1.p1.3.m3.1.1.3.4.cmml" xref="S4.SS1.p1.3.m3.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\textbf{F}_{dec}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">F start_POSTSUBSCRIPT italic_d italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math>. We illustrate this with SAM. The vision backbone in SAM is a ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib12" title="">12</a>]</cite>. The ViT extracts features from the input image and passes the feature map to the mask decoder. The mask decoder then predicts the target mask based on the feature map and prompt embeddings. Within our system, the prompt embedding is represented by the <math alttext="\langle" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mo id="S4.SS1.p1.4.m4.1.1" stretchy="false" xref="S4.SS1.p1.4.m4.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">⟨</annotation></semantics></math><span class="ltx_text" id="S4.SS1.p1.5.1">SEG</span><math alttext="\rangle" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mo id="S4.SS1.p1.5.m5.1.1" stretchy="false" xref="S4.SS1.p1.5.m5.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">⟩</annotation></semantics></math> token embedding from MLLM, which serves as an ambiguous indicator towards the intended affordance to solve the task.
As depicted in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S3.T1" title="In 3 Task-oriented Segmentation ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a>(b), given the large latency of vision backbone, the segmentation model will benefit significantly from our proposed VLTP.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.6">A ViT splits an image (<math alttext="X_{img}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><msub id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">X</mi><mrow id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml"><mi id="S4.SS1.p2.1.m1.1.1.3.2" xref="S4.SS1.p2.1.m1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p2.1.m1.1.1.3.1" xref="S4.SS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.1.m1.1.1.3.3" xref="S4.SS1.p2.1.m1.1.1.3.3.cmml">m</mi><mo id="S4.SS1.p2.1.m1.1.1.3.1a" xref="S4.SS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.1.m1.1.1.3.4" xref="S4.SS1.p2.1.m1.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝑋</ci><apply id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3"><times id="S4.SS1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3.1"></times><ci id="S4.SS1.p2.1.m1.1.1.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.3.2">𝑖</ci><ci id="S4.SS1.p2.1.m1.1.1.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3">𝑚</ci><ci id="S4.SS1.p2.1.m1.1.1.3.4.cmml" xref="S4.SS1.p2.1.m1.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">X_{img}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_X start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\in" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mo id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><in id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\in</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">∈</annotation></semantics></math> <math alttext="R^{3\times H\times W}" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><msup id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">R</mi><mrow id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml"><mn id="S4.SS1.p2.3.m3.1.1.3.2" xref="S4.SS1.p2.3.m3.1.1.3.2.cmml">3</mn><mo id="S4.SS1.p2.3.m3.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.3.m3.1.1.3.1.cmml">×</mo><mi id="S4.SS1.p2.3.m3.1.1.3.3" xref="S4.SS1.p2.3.m3.1.1.3.3.cmml">H</mi><mo id="S4.SS1.p2.3.m3.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.3.m3.1.1.3.1.cmml">×</mo><mi id="S4.SS1.p2.3.m3.1.1.3.4" xref="S4.SS1.p2.3.m3.1.1.3.4.cmml">W</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝑅</ci><apply id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3"><times id="S4.SS1.p2.3.m3.1.1.3.1.cmml" xref="S4.SS1.p2.3.m3.1.1.3.1"></times><cn id="S4.SS1.p2.3.m3.1.1.3.2.cmml" type="integer" xref="S4.SS1.p2.3.m3.1.1.3.2">3</cn><ci id="S4.SS1.p2.3.m3.1.1.3.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3.3">𝐻</ci><ci id="S4.SS1.p2.3.m3.1.1.3.4.cmml" xref="S4.SS1.p2.3.m3.1.1.3.4">𝑊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">R^{3\times H\times W}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">italic_R start_POSTSUPERSCRIPT 3 × italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math>) into different patches via patch embedding layer. Suppose the embedding dimension is <math alttext="C" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">italic_C</annotation></semantics></math>, the patch size is <math alttext="P" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><mi id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">P</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">italic_P</annotation></semantics></math>, and the image token sequence length is <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m6.1"><semantics id="S4.SS1.p2.6.m6.1a"><mi id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><ci id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m6.1d">italic_N</annotation></semantics></math>, we have:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="N=\frac{H\times W}{P^{2}}" class="ltx_Math" display="block" id="S4.E4.m1.1"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml"><mi id="S4.E4.m1.1.1.2" xref="S4.E4.m1.1.1.2.cmml">N</mi><mo id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.cmml">=</mo><mfrac id="S4.E4.m1.1.1.3" xref="S4.E4.m1.1.1.3.cmml"><mrow id="S4.E4.m1.1.1.3.2" xref="S4.E4.m1.1.1.3.2.cmml"><mi id="S4.E4.m1.1.1.3.2.2" xref="S4.E4.m1.1.1.3.2.2.cmml">H</mi><mo id="S4.E4.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E4.m1.1.1.3.2.1.cmml">×</mo><mi id="S4.E4.m1.1.1.3.2.3" xref="S4.E4.m1.1.1.3.2.3.cmml">W</mi></mrow><msup id="S4.E4.m1.1.1.3.3" xref="S4.E4.m1.1.1.3.3.cmml"><mi id="S4.E4.m1.1.1.3.3.2" xref="S4.E4.m1.1.1.3.3.2.cmml">P</mi><mn id="S4.E4.m1.1.1.3.3.3" xref="S4.E4.m1.1.1.3.3.3.cmml">2</mn></msup></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"><eq id="S4.E4.m1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"></eq><ci id="S4.E4.m1.1.1.2.cmml" xref="S4.E4.m1.1.1.2">𝑁</ci><apply id="S4.E4.m1.1.1.3.cmml" xref="S4.E4.m1.1.1.3"><divide id="S4.E4.m1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.3"></divide><apply id="S4.E4.m1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.3.2"><times id="S4.E4.m1.1.1.3.2.1.cmml" xref="S4.E4.m1.1.1.3.2.1"></times><ci id="S4.E4.m1.1.1.3.2.2.cmml" xref="S4.E4.m1.1.1.3.2.2">𝐻</ci><ci id="S4.E4.m1.1.1.3.2.3.cmml" xref="S4.E4.m1.1.1.3.2.3">𝑊</ci></apply><apply id="S4.E4.m1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.3.3.1.cmml" xref="S4.E4.m1.1.1.3.3">superscript</csymbol><ci id="S4.E4.m1.1.1.3.3.2.cmml" xref="S4.E4.m1.1.1.3.3.2">𝑃</ci><cn id="S4.E4.m1.1.1.3.3.3.cmml" type="integer" xref="S4.E4.m1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">N=\frac{H\times W}{P^{2}}</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.1d">italic_N = divide start_ARG italic_H × italic_W end_ARG start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.9">ViTs are position-agnostic, so we add positional encoding to represent the spatial information of the image token. The resulting image token sequence is denoted as <math alttext="T_{img}^{0}\in R^{N\times C}" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m1.1"><semantics id="S4.SS1.p2.7.m1.1a"><mrow id="S4.SS1.p2.7.m1.1.1" xref="S4.SS1.p2.7.m1.1.1.cmml"><msubsup id="S4.SS1.p2.7.m1.1.1.2" xref="S4.SS1.p2.7.m1.1.1.2.cmml"><mi id="S4.SS1.p2.7.m1.1.1.2.2.2" xref="S4.SS1.p2.7.m1.1.1.2.2.2.cmml">T</mi><mrow id="S4.SS1.p2.7.m1.1.1.2.2.3" xref="S4.SS1.p2.7.m1.1.1.2.2.3.cmml"><mi id="S4.SS1.p2.7.m1.1.1.2.2.3.2" xref="S4.SS1.p2.7.m1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.SS1.p2.7.m1.1.1.2.2.3.1" xref="S4.SS1.p2.7.m1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.7.m1.1.1.2.2.3.3" xref="S4.SS1.p2.7.m1.1.1.2.2.3.3.cmml">m</mi><mo id="S4.SS1.p2.7.m1.1.1.2.2.3.1a" xref="S4.SS1.p2.7.m1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.7.m1.1.1.2.2.3.4" xref="S4.SS1.p2.7.m1.1.1.2.2.3.4.cmml">g</mi></mrow><mn id="S4.SS1.p2.7.m1.1.1.2.3" xref="S4.SS1.p2.7.m1.1.1.2.3.cmml">0</mn></msubsup><mo id="S4.SS1.p2.7.m1.1.1.1" xref="S4.SS1.p2.7.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p2.7.m1.1.1.3" xref="S4.SS1.p2.7.m1.1.1.3.cmml"><mi id="S4.SS1.p2.7.m1.1.1.3.2" xref="S4.SS1.p2.7.m1.1.1.3.2.cmml">R</mi><mrow id="S4.SS1.p2.7.m1.1.1.3.3" xref="S4.SS1.p2.7.m1.1.1.3.3.cmml"><mi id="S4.SS1.p2.7.m1.1.1.3.3.2" xref="S4.SS1.p2.7.m1.1.1.3.3.2.cmml">N</mi><mo id="S4.SS1.p2.7.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.7.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.7.m1.1.1.3.3.3" xref="S4.SS1.p2.7.m1.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m1.1b"><apply id="S4.SS1.p2.7.m1.1.1.cmml" xref="S4.SS1.p2.7.m1.1.1"><in id="S4.SS1.p2.7.m1.1.1.1.cmml" xref="S4.SS1.p2.7.m1.1.1.1"></in><apply id="S4.SS1.p2.7.m1.1.1.2.cmml" xref="S4.SS1.p2.7.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m1.1.1.2.1.cmml" xref="S4.SS1.p2.7.m1.1.1.2">superscript</csymbol><apply id="S4.SS1.p2.7.m1.1.1.2.2.cmml" xref="S4.SS1.p2.7.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m1.1.1.2.2.1.cmml" xref="S4.SS1.p2.7.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.7.m1.1.1.2.2.2.cmml" xref="S4.SS1.p2.7.m1.1.1.2.2.2">𝑇</ci><apply id="S4.SS1.p2.7.m1.1.1.2.2.3.cmml" xref="S4.SS1.p2.7.m1.1.1.2.2.3"><times id="S4.SS1.p2.7.m1.1.1.2.2.3.1.cmml" xref="S4.SS1.p2.7.m1.1.1.2.2.3.1"></times><ci id="S4.SS1.p2.7.m1.1.1.2.2.3.2.cmml" xref="S4.SS1.p2.7.m1.1.1.2.2.3.2">𝑖</ci><ci id="S4.SS1.p2.7.m1.1.1.2.2.3.3.cmml" xref="S4.SS1.p2.7.m1.1.1.2.2.3.3">𝑚</ci><ci id="S4.SS1.p2.7.m1.1.1.2.2.3.4.cmml" xref="S4.SS1.p2.7.m1.1.1.2.2.3.4">𝑔</ci></apply></apply><cn id="S4.SS1.p2.7.m1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p2.7.m1.1.1.2.3">0</cn></apply><apply id="S4.SS1.p2.7.m1.1.1.3.cmml" xref="S4.SS1.p2.7.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m1.1.1.3.1.cmml" xref="S4.SS1.p2.7.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.7.m1.1.1.3.2.cmml" xref="S4.SS1.p2.7.m1.1.1.3.2">𝑅</ci><apply id="S4.SS1.p2.7.m1.1.1.3.3.cmml" xref="S4.SS1.p2.7.m1.1.1.3.3"><times id="S4.SS1.p2.7.m1.1.1.3.3.1.cmml" xref="S4.SS1.p2.7.m1.1.1.3.3.1"></times><ci id="S4.SS1.p2.7.m1.1.1.3.3.2.cmml" xref="S4.SS1.p2.7.m1.1.1.3.3.2">𝑁</ci><ci id="S4.SS1.p2.7.m1.1.1.3.3.3.cmml" xref="S4.SS1.p2.7.m1.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m1.1c">T_{img}^{0}\in R^{N\times C}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m1.1d">italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT ∈ italic_R start_POSTSUPERSCRIPT italic_N × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>. We then pass the image token sequence into multiple repeated layers. Every ViT layer contains an MHSA, a feed-forward network (FFN), a layer normalization (LN) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib1" title="">1</a>]</cite>, and a residual connection <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib13" title="">13</a>]</cite>. The layers are indexed by <math alttext="l\in\{1,2,...,L\}" class="ltx_Math" display="inline" id="S4.SS1.p2.8.m2.4"><semantics id="S4.SS1.p2.8.m2.4a"><mrow id="S4.SS1.p2.8.m2.4.5" xref="S4.SS1.p2.8.m2.4.5.cmml"><mi id="S4.SS1.p2.8.m2.4.5.2" xref="S4.SS1.p2.8.m2.4.5.2.cmml">l</mi><mo id="S4.SS1.p2.8.m2.4.5.1" xref="S4.SS1.p2.8.m2.4.5.1.cmml">∈</mo><mrow id="S4.SS1.p2.8.m2.4.5.3.2" xref="S4.SS1.p2.8.m2.4.5.3.1.cmml"><mo id="S4.SS1.p2.8.m2.4.5.3.2.1" stretchy="false" xref="S4.SS1.p2.8.m2.4.5.3.1.cmml">{</mo><mn id="S4.SS1.p2.8.m2.1.1" xref="S4.SS1.p2.8.m2.1.1.cmml">1</mn><mo id="S4.SS1.p2.8.m2.4.5.3.2.2" xref="S4.SS1.p2.8.m2.4.5.3.1.cmml">,</mo><mn id="S4.SS1.p2.8.m2.2.2" xref="S4.SS1.p2.8.m2.2.2.cmml">2</mn><mo id="S4.SS1.p2.8.m2.4.5.3.2.3" xref="S4.SS1.p2.8.m2.4.5.3.1.cmml">,</mo><mi id="S4.SS1.p2.8.m2.3.3" mathvariant="normal" xref="S4.SS1.p2.8.m2.3.3.cmml">…</mi><mo id="S4.SS1.p2.8.m2.4.5.3.2.4" xref="S4.SS1.p2.8.m2.4.5.3.1.cmml">,</mo><mi id="S4.SS1.p2.8.m2.4.4" xref="S4.SS1.p2.8.m2.4.4.cmml">L</mi><mo id="S4.SS1.p2.8.m2.4.5.3.2.5" stretchy="false" xref="S4.SS1.p2.8.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m2.4b"><apply id="S4.SS1.p2.8.m2.4.5.cmml" xref="S4.SS1.p2.8.m2.4.5"><in id="S4.SS1.p2.8.m2.4.5.1.cmml" xref="S4.SS1.p2.8.m2.4.5.1"></in><ci id="S4.SS1.p2.8.m2.4.5.2.cmml" xref="S4.SS1.p2.8.m2.4.5.2">𝑙</ci><set id="S4.SS1.p2.8.m2.4.5.3.1.cmml" xref="S4.SS1.p2.8.m2.4.5.3.2"><cn id="S4.SS1.p2.8.m2.1.1.cmml" type="integer" xref="S4.SS1.p2.8.m2.1.1">1</cn><cn id="S4.SS1.p2.8.m2.2.2.cmml" type="integer" xref="S4.SS1.p2.8.m2.2.2">2</cn><ci id="S4.SS1.p2.8.m2.3.3.cmml" xref="S4.SS1.p2.8.m2.3.3">…</ci><ci id="S4.SS1.p2.8.m2.4.4.cmml" xref="S4.SS1.p2.8.m2.4.4">𝐿</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m2.4c">l\in\{1,2,...,L\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.8.m2.4d">italic_l ∈ { 1 , 2 , … , italic_L }</annotation></semantics></math>, and the output of each layer is marked as <math alttext="T_{img}^{l}" class="ltx_Math" display="inline" id="S4.SS1.p2.9.m3.1"><semantics id="S4.SS1.p2.9.m3.1a"><msubsup id="S4.SS1.p2.9.m3.1.1" xref="S4.SS1.p2.9.m3.1.1.cmml"><mi id="S4.SS1.p2.9.m3.1.1.2.2" xref="S4.SS1.p2.9.m3.1.1.2.2.cmml">T</mi><mrow id="S4.SS1.p2.9.m3.1.1.2.3" xref="S4.SS1.p2.9.m3.1.1.2.3.cmml"><mi id="S4.SS1.p2.9.m3.1.1.2.3.2" xref="S4.SS1.p2.9.m3.1.1.2.3.2.cmml">i</mi><mo id="S4.SS1.p2.9.m3.1.1.2.3.1" xref="S4.SS1.p2.9.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.9.m3.1.1.2.3.3" xref="S4.SS1.p2.9.m3.1.1.2.3.3.cmml">m</mi><mo id="S4.SS1.p2.9.m3.1.1.2.3.1a" xref="S4.SS1.p2.9.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.9.m3.1.1.2.3.4" xref="S4.SS1.p2.9.m3.1.1.2.3.4.cmml">g</mi></mrow><mi id="S4.SS1.p2.9.m3.1.1.3" xref="S4.SS1.p2.9.m3.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m3.1b"><apply id="S4.SS1.p2.9.m3.1.1.cmml" xref="S4.SS1.p2.9.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m3.1.1.1.cmml" xref="S4.SS1.p2.9.m3.1.1">superscript</csymbol><apply id="S4.SS1.p2.9.m3.1.1.2.cmml" xref="S4.SS1.p2.9.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m3.1.1.2.1.cmml" xref="S4.SS1.p2.9.m3.1.1">subscript</csymbol><ci id="S4.SS1.p2.9.m3.1.1.2.2.cmml" xref="S4.SS1.p2.9.m3.1.1.2.2">𝑇</ci><apply id="S4.SS1.p2.9.m3.1.1.2.3.cmml" xref="S4.SS1.p2.9.m3.1.1.2.3"><times id="S4.SS1.p2.9.m3.1.1.2.3.1.cmml" xref="S4.SS1.p2.9.m3.1.1.2.3.1"></times><ci id="S4.SS1.p2.9.m3.1.1.2.3.2.cmml" xref="S4.SS1.p2.9.m3.1.1.2.3.2">𝑖</ci><ci id="S4.SS1.p2.9.m3.1.1.2.3.3.cmml" xref="S4.SS1.p2.9.m3.1.1.2.3.3">𝑚</ci><ci id="S4.SS1.p2.9.m3.1.1.2.3.4.cmml" xref="S4.SS1.p2.9.m3.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S4.SS1.p2.9.m3.1.1.3.cmml" xref="S4.SS1.p2.9.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m3.1c">T_{img}^{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.9.m3.1d">italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E5">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E5X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle T_{img}^{l^{\prime}}=MHSA(LN(T_{img}^{l-1}))+T_{img}^{l-1}" class="ltx_Math" display="inline" id="S4.E5X.2.1.1.m1.1"><semantics id="S4.E5X.2.1.1.m1.1a"><mrow id="S4.E5X.2.1.1.m1.1.1" xref="S4.E5X.2.1.1.m1.1.1.cmml"><msubsup id="S4.E5X.2.1.1.m1.1.1.3" xref="S4.E5X.2.1.1.m1.1.1.3.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.3.2.2" xref="S4.E5X.2.1.1.m1.1.1.3.2.2.cmml">T</mi><mrow id="S4.E5X.2.1.1.m1.1.1.3.2.3" xref="S4.E5X.2.1.1.m1.1.1.3.2.3.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.3.2.3.2" xref="S4.E5X.2.1.1.m1.1.1.3.2.3.2.cmml">i</mi><mo id="S4.E5X.2.1.1.m1.1.1.3.2.3.1" xref="S4.E5X.2.1.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E5X.2.1.1.m1.1.1.3.2.3.3" xref="S4.E5X.2.1.1.m1.1.1.3.2.3.3.cmml">m</mi><mo id="S4.E5X.2.1.1.m1.1.1.3.2.3.1a" xref="S4.E5X.2.1.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E5X.2.1.1.m1.1.1.3.2.3.4" xref="S4.E5X.2.1.1.m1.1.1.3.2.3.4.cmml">g</mi></mrow><msup id="S4.E5X.2.1.1.m1.1.1.3.3" xref="S4.E5X.2.1.1.m1.1.1.3.3.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.3.3.2" xref="S4.E5X.2.1.1.m1.1.1.3.3.2.cmml">l</mi><mo id="S4.E5X.2.1.1.m1.1.1.3.3.3" xref="S4.E5X.2.1.1.m1.1.1.3.3.3.cmml">′</mo></msup></msubsup><mo id="S4.E5X.2.1.1.m1.1.1.2" xref="S4.E5X.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S4.E5X.2.1.1.m1.1.1.1" xref="S4.E5X.2.1.1.m1.1.1.1.cmml"><mrow id="S4.E5X.2.1.1.m1.1.1.1.1" xref="S4.E5X.2.1.1.m1.1.1.1.1.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.1.1.3" xref="S4.E5X.2.1.1.m1.1.1.1.1.3.cmml">M</mi><mo id="S4.E5X.2.1.1.m1.1.1.1.1.2" xref="S4.E5X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E5X.2.1.1.m1.1.1.1.1.4" xref="S4.E5X.2.1.1.m1.1.1.1.1.4.cmml">H</mi><mo id="S4.E5X.2.1.1.m1.1.1.1.1.2a" xref="S4.E5X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E5X.2.1.1.m1.1.1.1.1.5" xref="S4.E5X.2.1.1.m1.1.1.1.1.5.cmml">S</mi><mo id="S4.E5X.2.1.1.m1.1.1.1.1.2b" xref="S4.E5X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E5X.2.1.1.m1.1.1.1.1.6" xref="S4.E5X.2.1.1.m1.1.1.1.1.6.cmml">A</mi><mo id="S4.E5X.2.1.1.m1.1.1.1.1.2c" xref="S4.E5X.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5X.2.1.1.m1.1.1.1.1.1.1" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">L</mi><mo id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.4" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.4.cmml">N</mi><mo id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.2a" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">T</mi><mrow id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">m</mi><mo id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1a" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.4" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.4.cmml">g</mi></mrow><mrow id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5X.2.1.1.m1.1.1.1.2" xref="S4.E5X.2.1.1.m1.1.1.1.2.cmml">+</mo><msubsup id="S4.E5X.2.1.1.m1.1.1.1.3" xref="S4.E5X.2.1.1.m1.1.1.1.3.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.1.3.2.2" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.2.cmml">T</mi><mrow id="S4.E5X.2.1.1.m1.1.1.1.3.2.3" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.3.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.1.3.2.3.2" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.3.2.cmml">i</mi><mo id="S4.E5X.2.1.1.m1.1.1.1.3.2.3.1" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E5X.2.1.1.m1.1.1.1.3.2.3.3" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.3.3.cmml">m</mi><mo id="S4.E5X.2.1.1.m1.1.1.1.3.2.3.1a" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E5X.2.1.1.m1.1.1.1.3.2.3.4" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.3.4.cmml">g</mi></mrow><mrow id="S4.E5X.2.1.1.m1.1.1.1.3.3" xref="S4.E5X.2.1.1.m1.1.1.1.3.3.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.1.3.3.2" xref="S4.E5X.2.1.1.m1.1.1.1.3.3.2.cmml">l</mi><mo id="S4.E5X.2.1.1.m1.1.1.1.3.3.1" xref="S4.E5X.2.1.1.m1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.E5X.2.1.1.m1.1.1.1.3.3.3" xref="S4.E5X.2.1.1.m1.1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5X.2.1.1.m1.1b"><apply id="S4.E5X.2.1.1.m1.1.1.cmml" xref="S4.E5X.2.1.1.m1.1.1"><eq id="S4.E5X.2.1.1.m1.1.1.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.2"></eq><apply id="S4.E5X.2.1.1.m1.1.1.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.1.1.3.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.3">superscript</csymbol><apply id="S4.E5X.2.1.1.m1.1.1.3.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.1.1.3.2.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.E5X.2.1.1.m1.1.1.3.2.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.3.2.2">𝑇</ci><apply id="S4.E5X.2.1.1.m1.1.1.3.2.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.3.2.3"><times id="S4.E5X.2.1.1.m1.1.1.3.2.3.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.3.2.3.1"></times><ci id="S4.E5X.2.1.1.m1.1.1.3.2.3.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.3.2.3.2">𝑖</ci><ci id="S4.E5X.2.1.1.m1.1.1.3.2.3.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.3.2.3.3">𝑚</ci><ci id="S4.E5X.2.1.1.m1.1.1.3.2.3.4.cmml" xref="S4.E5X.2.1.1.m1.1.1.3.2.3.4">𝑔</ci></apply></apply><apply id="S4.E5X.2.1.1.m1.1.1.3.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.1.1.3.3.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.3.3">superscript</csymbol><ci id="S4.E5X.2.1.1.m1.1.1.3.3.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.3.3.2">𝑙</ci><ci id="S4.E5X.2.1.1.m1.1.1.3.3.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.3.3.3">′</ci></apply></apply><apply id="S4.E5X.2.1.1.m1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1"><plus id="S4.E5X.2.1.1.m1.1.1.1.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.2"></plus><apply id="S4.E5X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1"><times id="S4.E5X.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.2"></times><ci id="S4.E5X.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.3">𝑀</ci><ci id="S4.E5X.2.1.1.m1.1.1.1.1.4.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.4">𝐻</ci><ci id="S4.E5X.2.1.1.m1.1.1.1.1.5.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.5">𝑆</ci><ci id="S4.E5X.2.1.1.m1.1.1.1.1.6.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.6">𝐴</ci><apply id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1"><times id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.2"></times><ci id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.3">𝐿</ci><ci id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.4.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.4">𝑁</ci><apply id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑇</ci><apply id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑚</ci><ci id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.4">𝑔</ci></apply></apply><apply id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"><minus id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><cn id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S4.E5X.2.1.1.m1.1.1.1.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.1.1.1.3.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3">superscript</csymbol><apply id="S4.E5X.2.1.1.m1.1.1.1.3.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.1.1.1.3.2.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3">subscript</csymbol><ci id="S4.E5X.2.1.1.m1.1.1.1.3.2.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.2">𝑇</ci><apply id="S4.E5X.2.1.1.m1.1.1.1.3.2.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.3"><times id="S4.E5X.2.1.1.m1.1.1.1.3.2.3.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.3.1"></times><ci id="S4.E5X.2.1.1.m1.1.1.1.3.2.3.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.3.2">𝑖</ci><ci id="S4.E5X.2.1.1.m1.1.1.1.3.2.3.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.3.3">𝑚</ci><ci id="S4.E5X.2.1.1.m1.1.1.1.3.2.3.4.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3.2.3.4">𝑔</ci></apply></apply><apply id="S4.E5X.2.1.1.m1.1.1.1.3.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3.3"><minus id="S4.E5X.2.1.1.m1.1.1.1.3.3.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3.3.1"></minus><ci id="S4.E5X.2.1.1.m1.1.1.1.3.3.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.3.3.2">𝑙</ci><cn id="S4.E5X.2.1.1.m1.1.1.1.3.3.3.cmml" type="integer" xref="S4.E5X.2.1.1.m1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5X.2.1.1.m1.1c">\displaystyle T_{img}^{l^{\prime}}=MHSA(LN(T_{img}^{l-1}))+T_{img}^{l-1}</annotation><annotation encoding="application/x-llamapun" id="S4.E5X.2.1.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT = italic_M italic_H italic_S italic_A ( italic_L italic_N ( italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT ) ) + italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E5Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle T_{img}^{l}=FFN(LN(T_{img}^{l^{\prime}}))+T_{img}^{l^{\prime}}" class="ltx_Math" display="inline" id="S4.E5Xa.2.1.1.m1.1"><semantics id="S4.E5Xa.2.1.1.m1.1a"><mrow id="S4.E5Xa.2.1.1.m1.1.1" xref="S4.E5Xa.2.1.1.m1.1.1.cmml"><msubsup id="S4.E5Xa.2.1.1.m1.1.1.3" xref="S4.E5Xa.2.1.1.m1.1.1.3.cmml"><mi id="S4.E5Xa.2.1.1.m1.1.1.3.2.2" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.2.cmml">T</mi><mrow id="S4.E5Xa.2.1.1.m1.1.1.3.2.3" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.3.cmml"><mi id="S4.E5Xa.2.1.1.m1.1.1.3.2.3.2" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.3.2.cmml">i</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.3.2.3.1" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E5Xa.2.1.1.m1.1.1.3.2.3.3" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.3.3.cmml">m</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.3.2.3.1a" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E5Xa.2.1.1.m1.1.1.3.2.3.4" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.3.4.cmml">g</mi></mrow><mi id="S4.E5Xa.2.1.1.m1.1.1.3.3" xref="S4.E5Xa.2.1.1.m1.1.1.3.3.cmml">l</mi></msubsup><mo id="S4.E5Xa.2.1.1.m1.1.1.2" xref="S4.E5Xa.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S4.E5Xa.2.1.1.m1.1.1.1" xref="S4.E5Xa.2.1.1.m1.1.1.1.cmml"><mrow id="S4.E5Xa.2.1.1.m1.1.1.1.1" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.cmml"><mi id="S4.E5Xa.2.1.1.m1.1.1.1.1.3" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.3.cmml">F</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.1.1.2" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E5Xa.2.1.1.m1.1.1.1.1.4" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.4.cmml">F</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.1.1.2a" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E5Xa.2.1.1.m1.1.1.1.1.5" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.5.cmml">N</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.1.1.2b" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml">L</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.4" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.4.cmml">N</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2a" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">T</mi><mrow id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">m</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1a" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.4" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.4.cmml">g</mi></mrow><msup id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></msubsup><mo id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5Xa.2.1.1.m1.1.1.1.2" xref="S4.E5Xa.2.1.1.m1.1.1.1.2.cmml">+</mo><msubsup id="S4.E5Xa.2.1.1.m1.1.1.1.3" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.cmml"><mi id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.2" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.2.cmml">T</mi><mrow id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.cmml"><mi id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.2" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.2.cmml">i</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.1" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.3" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.3.cmml">m</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.1a" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.4" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.4.cmml">g</mi></mrow><msup id="S4.E5Xa.2.1.1.m1.1.1.1.3.3" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.3.cmml"><mi id="S4.E5Xa.2.1.1.m1.1.1.1.3.3.2" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.3.2.cmml">l</mi><mo id="S4.E5Xa.2.1.1.m1.1.1.1.3.3.3" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.3.3.cmml">′</mo></msup></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5Xa.2.1.1.m1.1b"><apply id="S4.E5Xa.2.1.1.m1.1.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1"><eq id="S4.E5Xa.2.1.1.m1.1.1.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.2"></eq><apply id="S4.E5Xa.2.1.1.m1.1.1.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E5Xa.2.1.1.m1.1.1.3.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.3">superscript</csymbol><apply id="S4.E5Xa.2.1.1.m1.1.1.3.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E5Xa.2.1.1.m1.1.1.3.2.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.E5Xa.2.1.1.m1.1.1.3.2.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.2">𝑇</ci><apply id="S4.E5Xa.2.1.1.m1.1.1.3.2.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.3"><times id="S4.E5Xa.2.1.1.m1.1.1.3.2.3.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.3.1"></times><ci id="S4.E5Xa.2.1.1.m1.1.1.3.2.3.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.3.2">𝑖</ci><ci id="S4.E5Xa.2.1.1.m1.1.1.3.2.3.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.3.3">𝑚</ci><ci id="S4.E5Xa.2.1.1.m1.1.1.3.2.3.4.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.3.2.3.4">𝑔</ci></apply></apply><ci id="S4.E5Xa.2.1.1.m1.1.1.3.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.3.3">𝑙</ci></apply><apply id="S4.E5Xa.2.1.1.m1.1.1.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1"><plus id="S4.E5Xa.2.1.1.m1.1.1.1.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.2"></plus><apply id="S4.E5Xa.2.1.1.m1.1.1.1.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1"><times id="S4.E5Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.2"></times><ci id="S4.E5Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.3">𝐹</ci><ci id="S4.E5Xa.2.1.1.m1.1.1.1.1.4.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.4">𝐹</ci><ci id="S4.E5Xa.2.1.1.m1.1.1.1.1.5.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.5">𝑁</ci><apply id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1"><times id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2"></times><ci id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.3">𝐿</ci><ci id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.4.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.4">𝑁</ci><apply id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑇</ci><apply id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑚</ci><ci id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2.3.4">𝑔</ci></apply></apply><apply id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><ci id="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3.3">′</ci></apply></apply></apply></apply><apply id="S4.E5Xa.2.1.1.m1.1.1.1.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5Xa.2.1.1.m1.1.1.1.3.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3">superscript</csymbol><apply id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3">subscript</csymbol><ci id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.2">𝑇</ci><apply id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3"><times id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.1"></times><ci id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.2">𝑖</ci><ci id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.3">𝑚</ci><ci id="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.4.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.2.3.4">𝑔</ci></apply></apply><apply id="S4.E5Xa.2.1.1.m1.1.1.1.3.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E5Xa.2.1.1.m1.1.1.1.3.3.1.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.3">superscript</csymbol><ci id="S4.E5Xa.2.1.1.m1.1.1.1.3.3.2.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.3.2">𝑙</ci><ci id="S4.E5Xa.2.1.1.m1.1.1.1.3.3.3.cmml" xref="S4.E5Xa.2.1.1.m1.1.1.1.3.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5Xa.2.1.1.m1.1c">\displaystyle T_{img}^{l}=FFN(LN(T_{img}^{l^{\prime}}))+T_{img}^{l^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S4.E5Xa.2.1.1.m1.1d">italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = italic_F italic_F italic_N ( italic_L italic_N ( italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) ) + italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">Given that the computation in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4.E5" title="In 4.1 Preliminary: Segmentation Model ‣ 4 Vision-Language Guided Patch Pruning ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">5</span></a> must be executed by <math alttext="L" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><mi id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><ci id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">italic_L</annotation></semantics></math> times, the computational burden of ViT is exceptionally high, especially when generating high-quality masks. The ViT model is particularly computation-intensive in terms of layer depth and embedding dimension. For example, SAM’s ViT-H model comprises 32 layers with an embedding dimension of 1280. Traditional methods to enhance the ViT’s efficiency include quantization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib26" title="">26</a>]</cite>, knowledge distillation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib57" title="">57</a>]</cite>, and model weight pruning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib50" title="">50</a>]</cite>. Nonetheless, in this work, we present a novel orthogonal approach: <span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">Not all image tokens need to traverse all ViT layers; we can eliminate the irrelevant tokens midway.</span></p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Token Pruning Mechanism</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.9">To keep the image tokens that are relevant to reasoning tasks, we insert <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.9.3">prune decoder</span> between different ViT layers. <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4.F3" title="In 4 Vision-Language Guided Patch Pruning ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a>(a) presents the ViT model with prune decoder <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1">F<sub class="ltx_sub" id="S4.SS2.p1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.SS2.p1.1.1.1.1">prune</span></sub></span>. Here we divide the segmentation model’s ViT into <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m1.1"><semantics id="S4.SS2.p1.2.m1.1a"><mi id="S4.SS2.p1.2.m1.1.1" xref="S4.SS2.p1.2.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m1.1b"><ci id="S4.SS2.p1.2.m1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m1.1d">italic_M</annotation></semantics></math> pruning stages and put the prune decoder at the end of each stage. Each stage will have <math alttext="l_{m}" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m2.1"><semantics id="S4.SS2.p1.3.m2.1a"><msub id="S4.SS2.p1.3.m2.1.1" xref="S4.SS2.p1.3.m2.1.1.cmml"><mi id="S4.SS2.p1.3.m2.1.1.2" xref="S4.SS2.p1.3.m2.1.1.2.cmml">l</mi><mi id="S4.SS2.p1.3.m2.1.1.3" xref="S4.SS2.p1.3.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m2.1b"><apply id="S4.SS2.p1.3.m2.1.1.cmml" xref="S4.SS2.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.1.1.1.cmml" xref="S4.SS2.p1.3.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.3.m2.1.1.2.cmml" xref="S4.SS2.p1.3.m2.1.1.2">𝑙</ci><ci id="S4.SS2.p1.3.m2.1.1.3.cmml" xref="S4.SS2.p1.3.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m2.1c">l_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m2.1d">italic_l start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> ViT layers. <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.4.2">F<sub class="ltx_sub" id="S4.SS2.p1.4.2.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.SS2.p1.4.2.1.1">prune</span></sub></span> takes the image tokens <math alttext="T_{img}^{l_{m}}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m3.1"><semantics id="S4.SS2.p1.5.m3.1a"><msubsup id="S4.SS2.p1.5.m3.1.1" xref="S4.SS2.p1.5.m3.1.1.cmml"><mi id="S4.SS2.p1.5.m3.1.1.2.2" xref="S4.SS2.p1.5.m3.1.1.2.2.cmml">T</mi><mrow id="S4.SS2.p1.5.m3.1.1.2.3" xref="S4.SS2.p1.5.m3.1.1.2.3.cmml"><mi id="S4.SS2.p1.5.m3.1.1.2.3.2" xref="S4.SS2.p1.5.m3.1.1.2.3.2.cmml">i</mi><mo id="S4.SS2.p1.5.m3.1.1.2.3.1" xref="S4.SS2.p1.5.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.5.m3.1.1.2.3.3" xref="S4.SS2.p1.5.m3.1.1.2.3.3.cmml">m</mi><mo id="S4.SS2.p1.5.m3.1.1.2.3.1a" xref="S4.SS2.p1.5.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.5.m3.1.1.2.3.4" xref="S4.SS2.p1.5.m3.1.1.2.3.4.cmml">g</mi></mrow><msub id="S4.SS2.p1.5.m3.1.1.3" xref="S4.SS2.p1.5.m3.1.1.3.cmml"><mi id="S4.SS2.p1.5.m3.1.1.3.2" xref="S4.SS2.p1.5.m3.1.1.3.2.cmml">l</mi><mi id="S4.SS2.p1.5.m3.1.1.3.3" xref="S4.SS2.p1.5.m3.1.1.3.3.cmml">m</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m3.1b"><apply id="S4.SS2.p1.5.m3.1.1.cmml" xref="S4.SS2.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m3.1.1.1.cmml" xref="S4.SS2.p1.5.m3.1.1">superscript</csymbol><apply id="S4.SS2.p1.5.m3.1.1.2.cmml" xref="S4.SS2.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m3.1.1.2.1.cmml" xref="S4.SS2.p1.5.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.5.m3.1.1.2.2.cmml" xref="S4.SS2.p1.5.m3.1.1.2.2">𝑇</ci><apply id="S4.SS2.p1.5.m3.1.1.2.3.cmml" xref="S4.SS2.p1.5.m3.1.1.2.3"><times id="S4.SS2.p1.5.m3.1.1.2.3.1.cmml" xref="S4.SS2.p1.5.m3.1.1.2.3.1"></times><ci id="S4.SS2.p1.5.m3.1.1.2.3.2.cmml" xref="S4.SS2.p1.5.m3.1.1.2.3.2">𝑖</ci><ci id="S4.SS2.p1.5.m3.1.1.2.3.3.cmml" xref="S4.SS2.p1.5.m3.1.1.2.3.3">𝑚</ci><ci id="S4.SS2.p1.5.m3.1.1.2.3.4.cmml" xref="S4.SS2.p1.5.m3.1.1.2.3.4">𝑔</ci></apply></apply><apply id="S4.SS2.p1.5.m3.1.1.3.cmml" xref="S4.SS2.p1.5.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m3.1.1.3.1.cmml" xref="S4.SS2.p1.5.m3.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.5.m3.1.1.3.2.cmml" xref="S4.SS2.p1.5.m3.1.1.3.2">𝑙</ci><ci id="S4.SS2.p1.5.m3.1.1.3.3.cmml" xref="S4.SS2.p1.5.m3.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m3.1c">T_{img}^{l_{m}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m3.1d">italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> from the output of the <math alttext="l_{m}" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m4.1"><semantics id="S4.SS2.p1.6.m4.1a"><msub id="S4.SS2.p1.6.m4.1.1" xref="S4.SS2.p1.6.m4.1.1.cmml"><mi id="S4.SS2.p1.6.m4.1.1.2" xref="S4.SS2.p1.6.m4.1.1.2.cmml">l</mi><mi id="S4.SS2.p1.6.m4.1.1.3" xref="S4.SS2.p1.6.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m4.1b"><apply id="S4.SS2.p1.6.m4.1.1.cmml" xref="S4.SS2.p1.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m4.1.1.1.cmml" xref="S4.SS2.p1.6.m4.1.1">subscript</csymbol><ci id="S4.SS2.p1.6.m4.1.1.2.cmml" xref="S4.SS2.p1.6.m4.1.1.2">𝑙</ci><ci id="S4.SS2.p1.6.m4.1.1.3.cmml" xref="S4.SS2.p1.6.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m4.1c">l_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m4.1d">italic_l start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> ViT layers and the <math alttext="\langle" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m5.1"><semantics id="S4.SS2.p1.7.m5.1a"><mo id="S4.SS2.p1.7.m5.1.1" stretchy="false" xref="S4.SS2.p1.7.m5.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m5.1b"><ci id="S4.SS2.p1.7.m5.1.1.cmml" xref="S4.SS2.p1.7.m5.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m5.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m5.1d">⟨</annotation></semantics></math><span class="ltx_text" id="S4.SS2.p1.9.4">SEG</span><math alttext="\rangle" class="ltx_Math" display="inline" id="S4.SS2.p1.8.m6.1"><semantics id="S4.SS2.p1.8.m6.1a"><mo id="S4.SS2.p1.8.m6.1.1" stretchy="false" xref="S4.SS2.p1.8.m6.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m6.1b"><ci id="S4.SS2.p1.8.m6.1.1.cmml" xref="S4.SS2.p1.8.m6.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m6.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.8.m6.1d">⟩</annotation></semantics></math> token <math alttext="T_{seg}" class="ltx_Math" display="inline" id="S4.SS2.p1.9.m7.1"><semantics id="S4.SS2.p1.9.m7.1a"><msub id="S4.SS2.p1.9.m7.1.1" xref="S4.SS2.p1.9.m7.1.1.cmml"><mi id="S4.SS2.p1.9.m7.1.1.2" xref="S4.SS2.p1.9.m7.1.1.2.cmml">T</mi><mrow id="S4.SS2.p1.9.m7.1.1.3" xref="S4.SS2.p1.9.m7.1.1.3.cmml"><mi id="S4.SS2.p1.9.m7.1.1.3.2" xref="S4.SS2.p1.9.m7.1.1.3.2.cmml">s</mi><mo id="S4.SS2.p1.9.m7.1.1.3.1" xref="S4.SS2.p1.9.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.9.m7.1.1.3.3" xref="S4.SS2.p1.9.m7.1.1.3.3.cmml">e</mi><mo id="S4.SS2.p1.9.m7.1.1.3.1a" xref="S4.SS2.p1.9.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.9.m7.1.1.3.4" xref="S4.SS2.p1.9.m7.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m7.1b"><apply id="S4.SS2.p1.9.m7.1.1.cmml" xref="S4.SS2.p1.9.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m7.1.1.1.cmml" xref="S4.SS2.p1.9.m7.1.1">subscript</csymbol><ci id="S4.SS2.p1.9.m7.1.1.2.cmml" xref="S4.SS2.p1.9.m7.1.1.2">𝑇</ci><apply id="S4.SS2.p1.9.m7.1.1.3.cmml" xref="S4.SS2.p1.9.m7.1.1.3"><times id="S4.SS2.p1.9.m7.1.1.3.1.cmml" xref="S4.SS2.p1.9.m7.1.1.3.1"></times><ci id="S4.SS2.p1.9.m7.1.1.3.2.cmml" xref="S4.SS2.p1.9.m7.1.1.3.2">𝑠</ci><ci id="S4.SS2.p1.9.m7.1.1.3.3.cmml" xref="S4.SS2.p1.9.m7.1.1.3.3">𝑒</ci><ci id="S4.SS2.p1.9.m7.1.1.3.4.cmml" xref="S4.SS2.p1.9.m7.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m7.1c">T_{seg}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.9.m7.1d">italic_T start_POSTSUBSCRIPT italic_s italic_e italic_g end_POSTSUBSCRIPT</annotation></semantics></math> from the output of MLLM.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P_{m}=\mathbf{F}_{prune}(T_{img}^{l_{m}},T_{seg})" class="ltx_Math" display="block" id="S4.E6.m1.2"><semantics id="S4.E6.m1.2a"><mrow id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml"><msub id="S4.E6.m1.2.2.4" xref="S4.E6.m1.2.2.4.cmml"><mi id="S4.E6.m1.2.2.4.2" xref="S4.E6.m1.2.2.4.2.cmml">P</mi><mi id="S4.E6.m1.2.2.4.3" xref="S4.E6.m1.2.2.4.3.cmml">m</mi></msub><mo id="S4.E6.m1.2.2.3" xref="S4.E6.m1.2.2.3.cmml">=</mo><mrow id="S4.E6.m1.2.2.2" xref="S4.E6.m1.2.2.2.cmml"><msub id="S4.E6.m1.2.2.2.4" xref="S4.E6.m1.2.2.2.4.cmml"><mi id="S4.E6.m1.2.2.2.4.2" xref="S4.E6.m1.2.2.2.4.2.cmml">𝐅</mi><mrow id="S4.E6.m1.2.2.2.4.3" xref="S4.E6.m1.2.2.2.4.3.cmml"><mi id="S4.E6.m1.2.2.2.4.3.2" xref="S4.E6.m1.2.2.2.4.3.2.cmml">p</mi><mo id="S4.E6.m1.2.2.2.4.3.1" xref="S4.E6.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.4.3.3" xref="S4.E6.m1.2.2.2.4.3.3.cmml">r</mi><mo id="S4.E6.m1.2.2.2.4.3.1a" xref="S4.E6.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.4.3.4" xref="S4.E6.m1.2.2.2.4.3.4.cmml">u</mi><mo id="S4.E6.m1.2.2.2.4.3.1b" xref="S4.E6.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.4.3.5" xref="S4.E6.m1.2.2.2.4.3.5.cmml">n</mi><mo id="S4.E6.m1.2.2.2.4.3.1c" xref="S4.E6.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.4.3.6" xref="S4.E6.m1.2.2.2.4.3.6.cmml">e</mi></mrow></msub><mo id="S4.E6.m1.2.2.2.3" xref="S4.E6.m1.2.2.2.3.cmml">⁢</mo><mrow id="S4.E6.m1.2.2.2.2.2" xref="S4.E6.m1.2.2.2.2.3.cmml"><mo id="S4.E6.m1.2.2.2.2.2.3" stretchy="false" xref="S4.E6.m1.2.2.2.2.3.cmml">(</mo><msubsup id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.1.1.1.1.1.1.2.2.cmml">T</mi><mrow id="S4.E6.m1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.2.3.2" xref="S4.E6.m1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S4.E6.m1.1.1.1.1.1.1.2.3.1" xref="S4.E6.m1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.1.1.1.1.2.3.3" xref="S4.E6.m1.1.1.1.1.1.1.2.3.3.cmml">m</mi><mo id="S4.E6.m1.1.1.1.1.1.1.2.3.1a" xref="S4.E6.m1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.1.1.1.1.2.3.4" xref="S4.E6.m1.1.1.1.1.1.1.2.3.4.cmml">g</mi></mrow><msub id="S4.E6.m1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.1.3.2.cmml">l</mi><mi id="S4.E6.m1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.1.3.3.cmml">m</mi></msub></msubsup><mo id="S4.E6.m1.2.2.2.2.2.4" xref="S4.E6.m1.2.2.2.2.3.cmml">,</mo><msub id="S4.E6.m1.2.2.2.2.2.2" xref="S4.E6.m1.2.2.2.2.2.2.cmml"><mi id="S4.E6.m1.2.2.2.2.2.2.2" xref="S4.E6.m1.2.2.2.2.2.2.2.cmml">T</mi><mrow id="S4.E6.m1.2.2.2.2.2.2.3" xref="S4.E6.m1.2.2.2.2.2.2.3.cmml"><mi id="S4.E6.m1.2.2.2.2.2.2.3.2" xref="S4.E6.m1.2.2.2.2.2.2.3.2.cmml">s</mi><mo id="S4.E6.m1.2.2.2.2.2.2.3.1" xref="S4.E6.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.2.2.2.3.3" xref="S4.E6.m1.2.2.2.2.2.2.3.3.cmml">e</mi><mo id="S4.E6.m1.2.2.2.2.2.2.3.1a" xref="S4.E6.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.2.2.2.3.4" xref="S4.E6.m1.2.2.2.2.2.2.3.4.cmml">g</mi></mrow></msub><mo id="S4.E6.m1.2.2.2.2.2.5" stretchy="false" xref="S4.E6.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.2b"><apply id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2"><eq id="S4.E6.m1.2.2.3.cmml" xref="S4.E6.m1.2.2.3"></eq><apply id="S4.E6.m1.2.2.4.cmml" xref="S4.E6.m1.2.2.4"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.4.1.cmml" xref="S4.E6.m1.2.2.4">subscript</csymbol><ci id="S4.E6.m1.2.2.4.2.cmml" xref="S4.E6.m1.2.2.4.2">𝑃</ci><ci id="S4.E6.m1.2.2.4.3.cmml" xref="S4.E6.m1.2.2.4.3">𝑚</ci></apply><apply id="S4.E6.m1.2.2.2.cmml" xref="S4.E6.m1.2.2.2"><times id="S4.E6.m1.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.3"></times><apply id="S4.E6.m1.2.2.2.4.cmml" xref="S4.E6.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.4.1.cmml" xref="S4.E6.m1.2.2.2.4">subscript</csymbol><ci id="S4.E6.m1.2.2.2.4.2.cmml" xref="S4.E6.m1.2.2.2.4.2">𝐅</ci><apply id="S4.E6.m1.2.2.2.4.3.cmml" xref="S4.E6.m1.2.2.2.4.3"><times id="S4.E6.m1.2.2.2.4.3.1.cmml" xref="S4.E6.m1.2.2.2.4.3.1"></times><ci id="S4.E6.m1.2.2.2.4.3.2.cmml" xref="S4.E6.m1.2.2.2.4.3.2">𝑝</ci><ci id="S4.E6.m1.2.2.2.4.3.3.cmml" xref="S4.E6.m1.2.2.2.4.3.3">𝑟</ci><ci id="S4.E6.m1.2.2.2.4.3.4.cmml" xref="S4.E6.m1.2.2.2.4.3.4">𝑢</ci><ci id="S4.E6.m1.2.2.2.4.3.5.cmml" xref="S4.E6.m1.2.2.2.4.3.5">𝑛</ci><ci id="S4.E6.m1.2.2.2.4.3.6.cmml" xref="S4.E6.m1.2.2.2.4.3.6">𝑒</ci></apply></apply><interval closure="open" id="S4.E6.m1.2.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2.2"><apply id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.2">𝑇</ci><apply id="S4.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3"><times id="S4.E6.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E6.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S4.E6.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3.3">𝑚</ci><ci id="S4.E6.m1.1.1.1.1.1.1.2.3.4.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2.3.4">𝑔</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.2">𝑙</ci><ci id="S4.E6.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S4.E6.m1.2.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E6.m1.2.2.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2">𝑇</ci><apply id="S4.E6.m1.2.2.2.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2.2.2.3"><times id="S4.E6.m1.2.2.2.2.2.2.3.1.cmml" xref="S4.E6.m1.2.2.2.2.2.2.3.1"></times><ci id="S4.E6.m1.2.2.2.2.2.2.3.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2.3.2">𝑠</ci><ci id="S4.E6.m1.2.2.2.2.2.2.3.3.cmml" xref="S4.E6.m1.2.2.2.2.2.2.3.3">𝑒</ci><ci id="S4.E6.m1.2.2.2.2.2.2.3.4.cmml" xref="S4.E6.m1.2.2.2.2.2.2.3.4">𝑔</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.2c">P_{m}=\mathbf{F}_{prune}(T_{img}^{l_{m}},T_{seg})</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.2d">italic_P start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = bold_F start_POSTSUBSCRIPT italic_p italic_r italic_u italic_n italic_e end_POSTSUBSCRIPT ( italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_T start_POSTSUBSCRIPT italic_s italic_e italic_g end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p1.17">The <math alttext="P_{mn}" class="ltx_Math" display="inline" id="S4.SS2.p1.10.m1.1"><semantics id="S4.SS2.p1.10.m1.1a"><msub id="S4.SS2.p1.10.m1.1.1" xref="S4.SS2.p1.10.m1.1.1.cmml"><mi id="S4.SS2.p1.10.m1.1.1.2" xref="S4.SS2.p1.10.m1.1.1.2.cmml">P</mi><mrow id="S4.SS2.p1.10.m1.1.1.3" xref="S4.SS2.p1.10.m1.1.1.3.cmml"><mi id="S4.SS2.p1.10.m1.1.1.3.2" xref="S4.SS2.p1.10.m1.1.1.3.2.cmml">m</mi><mo id="S4.SS2.p1.10.m1.1.1.3.1" xref="S4.SS2.p1.10.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.10.m1.1.1.3.3" xref="S4.SS2.p1.10.m1.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m1.1b"><apply id="S4.SS2.p1.10.m1.1.1.cmml" xref="S4.SS2.p1.10.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m1.1.1.1.cmml" xref="S4.SS2.p1.10.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.10.m1.1.1.2.cmml" xref="S4.SS2.p1.10.m1.1.1.2">𝑃</ci><apply id="S4.SS2.p1.10.m1.1.1.3.cmml" xref="S4.SS2.p1.10.m1.1.1.3"><times id="S4.SS2.p1.10.m1.1.1.3.1.cmml" xref="S4.SS2.p1.10.m1.1.1.3.1"></times><ci id="S4.SS2.p1.10.m1.1.1.3.2.cmml" xref="S4.SS2.p1.10.m1.1.1.3.2">𝑚</ci><ci id="S4.SS2.p1.10.m1.1.1.3.3.cmml" xref="S4.SS2.p1.10.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m1.1c">P_{mn}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.10.m1.1d">italic_P start_POSTSUBSCRIPT italic_m italic_n end_POSTSUBSCRIPT</annotation></semantics></math> (<math alttext="n\in\{1,2,..,N\}" class="ltx_math_unparsed" display="inline" id="S4.SS2.p1.11.m2.2"><semantics id="S4.SS2.p1.11.m2.2a"><mrow id="S4.SS2.p1.11.m2.2b"><mi id="S4.SS2.p1.11.m2.2.3">n</mi><mo id="S4.SS2.p1.11.m2.2.4">∈</mo><mrow id="S4.SS2.p1.11.m2.2.5"><mo id="S4.SS2.p1.11.m2.2.5.1" stretchy="false">{</mo><mn id="S4.SS2.p1.11.m2.1.1">1</mn><mo id="S4.SS2.p1.11.m2.2.5.2">,</mo><mn id="S4.SS2.p1.11.m2.2.2">2</mn><mo id="S4.SS2.p1.11.m2.2.5.3">,</mo><mo id="S4.SS2.p1.11.m2.2.5.4" lspace="0em" rspace="0.0835em">.</mo><mo id="S4.SS2.p1.11.m2.2.5.5" lspace="0.0835em" rspace="0.167em">.</mo><mo id="S4.SS2.p1.11.m2.2.5.6">,</mo><mi id="S4.SS2.p1.11.m2.2.5.7">N</mi><mo id="S4.SS2.p1.11.m2.2.5.8" stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m2.2c">n\in\{1,2,..,N\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.11.m2.2d">italic_n ∈ { 1 , 2 , . . , italic_N }</annotation></semantics></math>) is the relative score between <math alttext="n^{\text{th}}" class="ltx_Math" display="inline" id="S4.SS2.p1.12.m3.1"><semantics id="S4.SS2.p1.12.m3.1a"><msup id="S4.SS2.p1.12.m3.1.1" xref="S4.SS2.p1.12.m3.1.1.cmml"><mi id="S4.SS2.p1.12.m3.1.1.2" xref="S4.SS2.p1.12.m3.1.1.2.cmml">n</mi><mtext id="S4.SS2.p1.12.m3.1.1.3" xref="S4.SS2.p1.12.m3.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m3.1b"><apply id="S4.SS2.p1.12.m3.1.1.cmml" xref="S4.SS2.p1.12.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.12.m3.1.1.1.cmml" xref="S4.SS2.p1.12.m3.1.1">superscript</csymbol><ci id="S4.SS2.p1.12.m3.1.1.2.cmml" xref="S4.SS2.p1.12.m3.1.1.2">𝑛</ci><ci id="S4.SS2.p1.12.m3.1.1.3a.cmml" xref="S4.SS2.p1.12.m3.1.1.3"><mtext id="S4.SS2.p1.12.m3.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.12.m3.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m3.1c">n^{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.12.m3.1d">italic_n start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT</annotation></semantics></math> image token <math alttext="T_{img}^{l_{m}}[n]" class="ltx_Math" display="inline" id="S4.SS2.p1.13.m4.1"><semantics id="S4.SS2.p1.13.m4.1a"><mrow id="S4.SS2.p1.13.m4.1.2" xref="S4.SS2.p1.13.m4.1.2.cmml"><msubsup id="S4.SS2.p1.13.m4.1.2.2" xref="S4.SS2.p1.13.m4.1.2.2.cmml"><mi id="S4.SS2.p1.13.m4.1.2.2.2.2" xref="S4.SS2.p1.13.m4.1.2.2.2.2.cmml">T</mi><mrow id="S4.SS2.p1.13.m4.1.2.2.2.3" xref="S4.SS2.p1.13.m4.1.2.2.2.3.cmml"><mi id="S4.SS2.p1.13.m4.1.2.2.2.3.2" xref="S4.SS2.p1.13.m4.1.2.2.2.3.2.cmml">i</mi><mo id="S4.SS2.p1.13.m4.1.2.2.2.3.1" xref="S4.SS2.p1.13.m4.1.2.2.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.13.m4.1.2.2.2.3.3" xref="S4.SS2.p1.13.m4.1.2.2.2.3.3.cmml">m</mi><mo id="S4.SS2.p1.13.m4.1.2.2.2.3.1a" xref="S4.SS2.p1.13.m4.1.2.2.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.13.m4.1.2.2.2.3.4" xref="S4.SS2.p1.13.m4.1.2.2.2.3.4.cmml">g</mi></mrow><msub id="S4.SS2.p1.13.m4.1.2.2.3" xref="S4.SS2.p1.13.m4.1.2.2.3.cmml"><mi id="S4.SS2.p1.13.m4.1.2.2.3.2" xref="S4.SS2.p1.13.m4.1.2.2.3.2.cmml">l</mi><mi id="S4.SS2.p1.13.m4.1.2.2.3.3" xref="S4.SS2.p1.13.m4.1.2.2.3.3.cmml">m</mi></msub></msubsup><mo id="S4.SS2.p1.13.m4.1.2.1" xref="S4.SS2.p1.13.m4.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p1.13.m4.1.2.3.2" xref="S4.SS2.p1.13.m4.1.2.3.1.cmml"><mo id="S4.SS2.p1.13.m4.1.2.3.2.1" stretchy="false" xref="S4.SS2.p1.13.m4.1.2.3.1.1.cmml">[</mo><mi id="S4.SS2.p1.13.m4.1.1" xref="S4.SS2.p1.13.m4.1.1.cmml">n</mi><mo id="S4.SS2.p1.13.m4.1.2.3.2.2" stretchy="false" xref="S4.SS2.p1.13.m4.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m4.1b"><apply id="S4.SS2.p1.13.m4.1.2.cmml" xref="S4.SS2.p1.13.m4.1.2"><times id="S4.SS2.p1.13.m4.1.2.1.cmml" xref="S4.SS2.p1.13.m4.1.2.1"></times><apply id="S4.SS2.p1.13.m4.1.2.2.cmml" xref="S4.SS2.p1.13.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.13.m4.1.2.2.1.cmml" xref="S4.SS2.p1.13.m4.1.2.2">superscript</csymbol><apply id="S4.SS2.p1.13.m4.1.2.2.2.cmml" xref="S4.SS2.p1.13.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.13.m4.1.2.2.2.1.cmml" xref="S4.SS2.p1.13.m4.1.2.2">subscript</csymbol><ci id="S4.SS2.p1.13.m4.1.2.2.2.2.cmml" xref="S4.SS2.p1.13.m4.1.2.2.2.2">𝑇</ci><apply id="S4.SS2.p1.13.m4.1.2.2.2.3.cmml" xref="S4.SS2.p1.13.m4.1.2.2.2.3"><times id="S4.SS2.p1.13.m4.1.2.2.2.3.1.cmml" xref="S4.SS2.p1.13.m4.1.2.2.2.3.1"></times><ci id="S4.SS2.p1.13.m4.1.2.2.2.3.2.cmml" xref="S4.SS2.p1.13.m4.1.2.2.2.3.2">𝑖</ci><ci id="S4.SS2.p1.13.m4.1.2.2.2.3.3.cmml" xref="S4.SS2.p1.13.m4.1.2.2.2.3.3">𝑚</ci><ci id="S4.SS2.p1.13.m4.1.2.2.2.3.4.cmml" xref="S4.SS2.p1.13.m4.1.2.2.2.3.4">𝑔</ci></apply></apply><apply id="S4.SS2.p1.13.m4.1.2.2.3.cmml" xref="S4.SS2.p1.13.m4.1.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.13.m4.1.2.2.3.1.cmml" xref="S4.SS2.p1.13.m4.1.2.2.3">subscript</csymbol><ci id="S4.SS2.p1.13.m4.1.2.2.3.2.cmml" xref="S4.SS2.p1.13.m4.1.2.2.3.2">𝑙</ci><ci id="S4.SS2.p1.13.m4.1.2.2.3.3.cmml" xref="S4.SS2.p1.13.m4.1.2.2.3.3">𝑚</ci></apply></apply><apply id="S4.SS2.p1.13.m4.1.2.3.1.cmml" xref="S4.SS2.p1.13.m4.1.2.3.2"><csymbol cd="latexml" id="S4.SS2.p1.13.m4.1.2.3.1.1.cmml" xref="S4.SS2.p1.13.m4.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS2.p1.13.m4.1.1.cmml" xref="S4.SS2.p1.13.m4.1.1">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.13.m4.1c">T_{img}^{l_{m}}[n]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.13.m4.1d">italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT [ italic_n ]</annotation></semantics></math> to the reasoning task. As shown in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4.F3" title="In 4 Vision-Language Guided Patch Pruning ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>(a), after generating the relative score of each image token, we pass the image tokens with top <math alttext="(1-r_{m})\times N" class="ltx_Math" display="inline" id="S4.SS2.p1.14.m5.1"><semantics id="S4.SS2.p1.14.m5.1a"><mrow id="S4.SS2.p1.14.m5.1.1" xref="S4.SS2.p1.14.m5.1.1.cmml"><mrow id="S4.SS2.p1.14.m5.1.1.1.1" xref="S4.SS2.p1.14.m5.1.1.1.1.1.cmml"><mo id="S4.SS2.p1.14.m5.1.1.1.1.2" stretchy="false" xref="S4.SS2.p1.14.m5.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.14.m5.1.1.1.1.1" xref="S4.SS2.p1.14.m5.1.1.1.1.1.cmml"><mn id="S4.SS2.p1.14.m5.1.1.1.1.1.2" xref="S4.SS2.p1.14.m5.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS2.p1.14.m5.1.1.1.1.1.1" xref="S4.SS2.p1.14.m5.1.1.1.1.1.1.cmml">−</mo><msub id="S4.SS2.p1.14.m5.1.1.1.1.1.3" xref="S4.SS2.p1.14.m5.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p1.14.m5.1.1.1.1.1.3.2" xref="S4.SS2.p1.14.m5.1.1.1.1.1.3.2.cmml">r</mi><mi id="S4.SS2.p1.14.m5.1.1.1.1.1.3.3" xref="S4.SS2.p1.14.m5.1.1.1.1.1.3.3.cmml">m</mi></msub></mrow><mo id="S4.SS2.p1.14.m5.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.SS2.p1.14.m5.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.p1.14.m5.1.1.2" rspace="0.222em" xref="S4.SS2.p1.14.m5.1.1.2.cmml">×</mo><mi id="S4.SS2.p1.14.m5.1.1.3" xref="S4.SS2.p1.14.m5.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.14.m5.1b"><apply id="S4.SS2.p1.14.m5.1.1.cmml" xref="S4.SS2.p1.14.m5.1.1"><times id="S4.SS2.p1.14.m5.1.1.2.cmml" xref="S4.SS2.p1.14.m5.1.1.2"></times><apply id="S4.SS2.p1.14.m5.1.1.1.1.1.cmml" xref="S4.SS2.p1.14.m5.1.1.1.1"><minus id="S4.SS2.p1.14.m5.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.14.m5.1.1.1.1.1.1"></minus><cn id="S4.SS2.p1.14.m5.1.1.1.1.1.2.cmml" type="integer" xref="S4.SS2.p1.14.m5.1.1.1.1.1.2">1</cn><apply id="S4.SS2.p1.14.m5.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.14.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.14.m5.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.14.m5.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.14.m5.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.14.m5.1.1.1.1.1.3.2">𝑟</ci><ci id="S4.SS2.p1.14.m5.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.14.m5.1.1.1.1.1.3.3">𝑚</ci></apply></apply><ci id="S4.SS2.p1.14.m5.1.1.3.cmml" xref="S4.SS2.p1.14.m5.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.14.m5.1c">(1-r_{m})\times N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.14.m5.1d">( 1 - italic_r start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) × italic_N</annotation></semantics></math> relative score to the next ViT layer while freezing the lowest <math alttext="r_{m}\times N" class="ltx_Math" display="inline" id="S4.SS2.p1.15.m6.1"><semantics id="S4.SS2.p1.15.m6.1a"><mrow id="S4.SS2.p1.15.m6.1.1" xref="S4.SS2.p1.15.m6.1.1.cmml"><msub id="S4.SS2.p1.15.m6.1.1.2" xref="S4.SS2.p1.15.m6.1.1.2.cmml"><mi id="S4.SS2.p1.15.m6.1.1.2.2" xref="S4.SS2.p1.15.m6.1.1.2.2.cmml">r</mi><mi id="S4.SS2.p1.15.m6.1.1.2.3" xref="S4.SS2.p1.15.m6.1.1.2.3.cmml">m</mi></msub><mo id="S4.SS2.p1.15.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.15.m6.1.1.1.cmml">×</mo><mi id="S4.SS2.p1.15.m6.1.1.3" xref="S4.SS2.p1.15.m6.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.15.m6.1b"><apply id="S4.SS2.p1.15.m6.1.1.cmml" xref="S4.SS2.p1.15.m6.1.1"><times id="S4.SS2.p1.15.m6.1.1.1.cmml" xref="S4.SS2.p1.15.m6.1.1.1"></times><apply id="S4.SS2.p1.15.m6.1.1.2.cmml" xref="S4.SS2.p1.15.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.15.m6.1.1.2.1.cmml" xref="S4.SS2.p1.15.m6.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.15.m6.1.1.2.2.cmml" xref="S4.SS2.p1.15.m6.1.1.2.2">𝑟</ci><ci id="S4.SS2.p1.15.m6.1.1.2.3.cmml" xref="S4.SS2.p1.15.m6.1.1.2.3">𝑚</ci></apply><ci id="S4.SS2.p1.15.m6.1.1.3.cmml" xref="S4.SS2.p1.15.m6.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.15.m6.1c">r_{m}\times N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.15.m6.1d">italic_r start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT × italic_N</annotation></semantics></math> tokens. Here “freeze” means the rest <math alttext="r_{m}\times N" class="ltx_Math" display="inline" id="S4.SS2.p1.16.m7.1"><semantics id="S4.SS2.p1.16.m7.1a"><mrow id="S4.SS2.p1.16.m7.1.1" xref="S4.SS2.p1.16.m7.1.1.cmml"><msub id="S4.SS2.p1.16.m7.1.1.2" xref="S4.SS2.p1.16.m7.1.1.2.cmml"><mi id="S4.SS2.p1.16.m7.1.1.2.2" xref="S4.SS2.p1.16.m7.1.1.2.2.cmml">r</mi><mi id="S4.SS2.p1.16.m7.1.1.2.3" xref="S4.SS2.p1.16.m7.1.1.2.3.cmml">m</mi></msub><mo id="S4.SS2.p1.16.m7.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.16.m7.1.1.1.cmml">×</mo><mi id="S4.SS2.p1.16.m7.1.1.3" xref="S4.SS2.p1.16.m7.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.16.m7.1b"><apply id="S4.SS2.p1.16.m7.1.1.cmml" xref="S4.SS2.p1.16.m7.1.1"><times id="S4.SS2.p1.16.m7.1.1.1.cmml" xref="S4.SS2.p1.16.m7.1.1.1"></times><apply id="S4.SS2.p1.16.m7.1.1.2.cmml" xref="S4.SS2.p1.16.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.16.m7.1.1.2.1.cmml" xref="S4.SS2.p1.16.m7.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.16.m7.1.1.2.2.cmml" xref="S4.SS2.p1.16.m7.1.1.2.2">𝑟</ci><ci id="S4.SS2.p1.16.m7.1.1.2.3.cmml" xref="S4.SS2.p1.16.m7.1.1.2.3">𝑚</ci></apply><ci id="S4.SS2.p1.16.m7.1.1.3.cmml" xref="S4.SS2.p1.16.m7.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.16.m7.1c">r_{m}\times N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.16.m7.1d">italic_r start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT × italic_N</annotation></semantics></math> do not participate in the self-attention (<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4.E5" title="In 4.1 Preliminary: Segmentation Model ‣ 4 Vision-Language Guided Patch Pruning ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">5</span></a>) until the next pruning stage. Therefore, after pruning, only <math alttext="1-r_{m}" class="ltx_Math" display="inline" id="S4.SS2.p1.17.m8.1"><semantics id="S4.SS2.p1.17.m8.1a"><mrow id="S4.SS2.p1.17.m8.1.1" xref="S4.SS2.p1.17.m8.1.1.cmml"><mn id="S4.SS2.p1.17.m8.1.1.2" xref="S4.SS2.p1.17.m8.1.1.2.cmml">1</mn><mo id="S4.SS2.p1.17.m8.1.1.1" xref="S4.SS2.p1.17.m8.1.1.1.cmml">−</mo><msub id="S4.SS2.p1.17.m8.1.1.3" xref="S4.SS2.p1.17.m8.1.1.3.cmml"><mi id="S4.SS2.p1.17.m8.1.1.3.2" xref="S4.SS2.p1.17.m8.1.1.3.2.cmml">r</mi><mi id="S4.SS2.p1.17.m8.1.1.3.3" xref="S4.SS2.p1.17.m8.1.1.3.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.17.m8.1b"><apply id="S4.SS2.p1.17.m8.1.1.cmml" xref="S4.SS2.p1.17.m8.1.1"><minus id="S4.SS2.p1.17.m8.1.1.1.cmml" xref="S4.SS2.p1.17.m8.1.1.1"></minus><cn id="S4.SS2.p1.17.m8.1.1.2.cmml" type="integer" xref="S4.SS2.p1.17.m8.1.1.2">1</cn><apply id="S4.SS2.p1.17.m8.1.1.3.cmml" xref="S4.SS2.p1.17.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.17.m8.1.1.3.1.cmml" xref="S4.SS2.p1.17.m8.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.17.m8.1.1.3.2.cmml" xref="S4.SS2.p1.17.m8.1.1.3.2">𝑟</ci><ci id="S4.SS2.p1.17.m8.1.1.3.3.cmml" xref="S4.SS2.p1.17.m8.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.17.m8.1c">1-r_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.17.m8.1d">1 - italic_r start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> image tokens participate in the computation which significantly reduces the computation of ViT. In <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4.SS4" title="4.4 Pruned Tokens Reactivation ‣ 4 Vision-Language Guided Patch Pruning ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.4</span></a>, we discuss how we reuse those frozen image tokens to improve the pruning accuracy.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Prune Decoder Design and Training</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.13"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4.F3" title="In 4 Vision-Language Guided Patch Pruning ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a>(b) presents the model architecture of <math alttext="\textbf{F}_{prune}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2a.cmml">F</mtext><mrow id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml"><mi id="S4.SS3.p1.1.m1.1.1.3.2" xref="S4.SS3.p1.1.m1.1.1.3.2.cmml">p</mi><mo id="S4.SS3.p1.1.m1.1.1.3.1" xref="S4.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.1.m1.1.1.3.3" xref="S4.SS3.p1.1.m1.1.1.3.3.cmml">r</mi><mo id="S4.SS3.p1.1.m1.1.1.3.1a" xref="S4.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.1.m1.1.1.3.4" xref="S4.SS3.p1.1.m1.1.1.3.4.cmml">u</mi><mo id="S4.SS3.p1.1.m1.1.1.3.1b" xref="S4.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.1.m1.1.1.3.5" xref="S4.SS3.p1.1.m1.1.1.3.5.cmml">n</mi><mo id="S4.SS3.p1.1.m1.1.1.3.1c" xref="S4.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.1.m1.1.1.3.6" xref="S4.SS3.p1.1.m1.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2a.cmml" xref="S4.SS3.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">F</mtext></ci><apply id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3"><times id="S4.SS3.p1.1.m1.1.1.3.1.cmml" xref="S4.SS3.p1.1.m1.1.1.3.1"></times><ci id="S4.SS3.p1.1.m1.1.1.3.2.cmml" xref="S4.SS3.p1.1.m1.1.1.3.2">𝑝</ci><ci id="S4.SS3.p1.1.m1.1.1.3.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3">𝑟</ci><ci id="S4.SS3.p1.1.m1.1.1.3.4.cmml" xref="S4.SS3.p1.1.m1.1.1.3.4">𝑢</ci><ci id="S4.SS3.p1.1.m1.1.1.3.5.cmml" xref="S4.SS3.p1.1.m1.1.1.3.5">𝑛</ci><ci id="S4.SS3.p1.1.m1.1.1.3.6.cmml" xref="S4.SS3.p1.1.m1.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\textbf{F}_{prune}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">F start_POSTSUBSCRIPT italic_p italic_r italic_u italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math>. Considering that the embedding dimension of image tokens (1280 for ViT-H) is generally higher than the <math alttext="\langle" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mo id="S4.SS3.p1.2.m2.1.1" stretchy="false" xref="S4.SS3.p1.2.m2.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">⟨</annotation></semantics></math><span class="ltx_text" id="S4.SS3.p1.13.1">SEG</span><math alttext="\rangle" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mo id="S4.SS3.p1.3.m3.1.1" stretchy="false" xref="S4.SS3.p1.3.m3.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">⟩</annotation></semantics></math> embedding dimension (256 for LLaVa), we first use a neck convolution layer to reduce the image token embedding from <math alttext="D" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1"><semantics id="S4.SS3.p1.4.m4.1a"><mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.1d">italic_D</annotation></semantics></math> to <math alttext="d" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m5.1"><semantics id="S4.SS3.p1.5.m5.1a"><mi id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><ci id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.5.m5.1d">italic_d</annotation></semantics></math>, where <math alttext="D" class="ltx_Math" display="inline" id="S4.SS3.p1.6.m6.1"><semantics id="S4.SS3.p1.6.m6.1a"><mi id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><ci id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.6.m6.1d">italic_D</annotation></semantics></math> is the ViT image token embedding dimension and <math alttext="d" class="ltx_Math" display="inline" id="S4.SS3.p1.7.m7.1"><semantics id="S4.SS3.p1.7.m7.1a"><mi id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.1b"><ci id="S4.SS3.p1.7.m7.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.7.m7.1d">italic_d</annotation></semantics></math> is the <math alttext="\langle" class="ltx_Math" display="inline" id="S4.SS3.p1.8.m8.1"><semantics id="S4.SS3.p1.8.m8.1a"><mo id="S4.SS3.p1.8.m8.1.1" stretchy="false" xref="S4.SS3.p1.8.m8.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m8.1b"><ci id="S4.SS3.p1.8.m8.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m8.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.8.m8.1d">⟨</annotation></semantics></math><span class="ltx_text" id="S4.SS3.p1.13.2">SEG</span><math alttext="\rangle" class="ltx_Math" display="inline" id="S4.SS3.p1.9.m9.1"><semantics id="S4.SS3.p1.9.m9.1a"><mo id="S4.SS3.p1.9.m9.1.1" stretchy="false" xref="S4.SS3.p1.9.m9.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m9.1b"><ci id="S4.SS3.p1.9.m9.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m9.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.9.m9.1d">⟩</annotation></semantics></math> embedding dimension. We then concatenate the <math alttext="\langle" class="ltx_Math" display="inline" id="S4.SS3.p1.10.m10.1"><semantics id="S4.SS3.p1.10.m10.1a"><mo id="S4.SS3.p1.10.m10.1.1" stretchy="false" xref="S4.SS3.p1.10.m10.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m10.1b"><ci id="S4.SS3.p1.10.m10.1.1.cmml" xref="S4.SS3.p1.10.m10.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m10.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.10.m10.1d">⟨</annotation></semantics></math><span class="ltx_text" id="S4.SS3.p1.13.3">SEG</span><math alttext="\rangle" class="ltx_Math" display="inline" id="S4.SS3.p1.11.m11.1"><semantics id="S4.SS3.p1.11.m11.1a"><mo id="S4.SS3.p1.11.m11.1.1" stretchy="false" xref="S4.SS3.p1.11.m11.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m11.1b"><ci id="S4.SS3.p1.11.m11.1.1.cmml" xref="S4.SS3.p1.11.m11.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.11.m11.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.11.m11.1d">⟩</annotation></semantics></math> embedding vector <math alttext="T_{seg}" class="ltx_Math" display="inline" id="S4.SS3.p1.12.m12.1"><semantics id="S4.SS3.p1.12.m12.1a"><msub id="S4.SS3.p1.12.m12.1.1" xref="S4.SS3.p1.12.m12.1.1.cmml"><mi id="S4.SS3.p1.12.m12.1.1.2" xref="S4.SS3.p1.12.m12.1.1.2.cmml">T</mi><mrow id="S4.SS3.p1.12.m12.1.1.3" xref="S4.SS3.p1.12.m12.1.1.3.cmml"><mi id="S4.SS3.p1.12.m12.1.1.3.2" xref="S4.SS3.p1.12.m12.1.1.3.2.cmml">s</mi><mo id="S4.SS3.p1.12.m12.1.1.3.1" xref="S4.SS3.p1.12.m12.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.12.m12.1.1.3.3" xref="S4.SS3.p1.12.m12.1.1.3.3.cmml">e</mi><mo id="S4.SS3.p1.12.m12.1.1.3.1a" xref="S4.SS3.p1.12.m12.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.12.m12.1.1.3.4" xref="S4.SS3.p1.12.m12.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.12.m12.1b"><apply id="S4.SS3.p1.12.m12.1.1.cmml" xref="S4.SS3.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m12.1.1.1.cmml" xref="S4.SS3.p1.12.m12.1.1">subscript</csymbol><ci id="S4.SS3.p1.12.m12.1.1.2.cmml" xref="S4.SS3.p1.12.m12.1.1.2">𝑇</ci><apply id="S4.SS3.p1.12.m12.1.1.3.cmml" xref="S4.SS3.p1.12.m12.1.1.3"><times id="S4.SS3.p1.12.m12.1.1.3.1.cmml" xref="S4.SS3.p1.12.m12.1.1.3.1"></times><ci id="S4.SS3.p1.12.m12.1.1.3.2.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2">𝑠</ci><ci id="S4.SS3.p1.12.m12.1.1.3.3.cmml" xref="S4.SS3.p1.12.m12.1.1.3.3">𝑒</ci><ci id="S4.SS3.p1.12.m12.1.1.3.4.cmml" xref="S4.SS3.p1.12.m12.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.12.m12.1c">T_{seg}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.12.m12.1d">italic_T start_POSTSUBSCRIPT italic_s italic_e italic_g end_POSTSUBSCRIPT</annotation></semantics></math> with a trainable query token embedding <math alttext="T_{q}" class="ltx_Math" display="inline" id="S4.SS3.p1.13.m13.1"><semantics id="S4.SS3.p1.13.m13.1a"><msub id="S4.SS3.p1.13.m13.1.1" xref="S4.SS3.p1.13.m13.1.1.cmml"><mi id="S4.SS3.p1.13.m13.1.1.2" xref="S4.SS3.p1.13.m13.1.1.2.cmml">T</mi><mi id="S4.SS3.p1.13.m13.1.1.3" xref="S4.SS3.p1.13.m13.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.13.m13.1b"><apply id="S4.SS3.p1.13.m13.1.1.cmml" xref="S4.SS3.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.13.m13.1.1.1.cmml" xref="S4.SS3.p1.13.m13.1.1">subscript</csymbol><ci id="S4.SS3.p1.13.m13.1.1.2.cmml" xref="S4.SS3.p1.13.m13.1.1.2">𝑇</ci><ci id="S4.SS3.p1.13.m13.1.1.3.cmml" xref="S4.SS3.p1.13.m13.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.13.m13.1c">T_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.13.m13.1d">italic_T start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and perform self-attention of the concatenated vector.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="T_{cat}=FFN(MHSA(T_{q}|T_{seg}))" class="ltx_Math" display="block" id="S4.E7.m1.1"><semantics id="S4.E7.m1.1a"><mrow id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml"><msub id="S4.E7.m1.1.1.3" xref="S4.E7.m1.1.1.3.cmml"><mi id="S4.E7.m1.1.1.3.2" xref="S4.E7.m1.1.1.3.2.cmml">T</mi><mrow id="S4.E7.m1.1.1.3.3" xref="S4.E7.m1.1.1.3.3.cmml"><mi id="S4.E7.m1.1.1.3.3.2" xref="S4.E7.m1.1.1.3.3.2.cmml">c</mi><mo id="S4.E7.m1.1.1.3.3.1" xref="S4.E7.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.1.1.3.3.3" xref="S4.E7.m1.1.1.3.3.3.cmml">a</mi><mo id="S4.E7.m1.1.1.3.3.1a" xref="S4.E7.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.1.1.3.3.4" xref="S4.E7.m1.1.1.3.3.4.cmml">t</mi></mrow></msub><mo id="S4.E7.m1.1.1.2" xref="S4.E7.m1.1.1.2.cmml">=</mo><mrow id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.3" xref="S4.E7.m1.1.1.1.3.cmml">F</mi><mo id="S4.E7.m1.1.1.1.2" xref="S4.E7.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.E7.m1.1.1.1.4" xref="S4.E7.m1.1.1.1.4.cmml">F</mi><mo id="S4.E7.m1.1.1.1.2a" xref="S4.E7.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.E7.m1.1.1.1.5" xref="S4.E7.m1.1.1.1.5.cmml">N</mi><mo id="S4.E7.m1.1.1.1.2b" xref="S4.E7.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.3.cmml">M</mi><mo id="S4.E7.m1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E7.m1.1.1.1.1.1.1.4" xref="S4.E7.m1.1.1.1.1.1.1.4.cmml">H</mi><mo id="S4.E7.m1.1.1.1.1.1.1.2a" xref="S4.E7.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E7.m1.1.1.1.1.1.1.5" xref="S4.E7.m1.1.1.1.1.1.1.5.cmml">S</mi><mo id="S4.E7.m1.1.1.1.1.1.1.2b" xref="S4.E7.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E7.m1.1.1.1.1.1.1.6" xref="S4.E7.m1.1.1.1.1.1.1.6.cmml">A</mi><mo id="S4.E7.m1.1.1.1.1.1.1.2c" xref="S4.E7.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">T</mi><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">q</mi></msub><mo fence="false" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">T</mi><mrow id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">e</mi><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">g</mi></mrow></msub></mrow><mo id="S4.E7.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.1b"><apply id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1"><eq id="S4.E7.m1.1.1.2.cmml" xref="S4.E7.m1.1.1.2"></eq><apply id="S4.E7.m1.1.1.3.cmml" xref="S4.E7.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.3.2">𝑇</ci><apply id="S4.E7.m1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.3.3"><times id="S4.E7.m1.1.1.3.3.1.cmml" xref="S4.E7.m1.1.1.3.3.1"></times><ci id="S4.E7.m1.1.1.3.3.2.cmml" xref="S4.E7.m1.1.1.3.3.2">𝑐</ci><ci id="S4.E7.m1.1.1.3.3.3.cmml" xref="S4.E7.m1.1.1.3.3.3">𝑎</ci><ci id="S4.E7.m1.1.1.3.3.4.cmml" xref="S4.E7.m1.1.1.3.3.4">𝑡</ci></apply></apply><apply id="S4.E7.m1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><times id="S4.E7.m1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.2"></times><ci id="S4.E7.m1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.3">𝐹</ci><ci id="S4.E7.m1.1.1.1.4.cmml" xref="S4.E7.m1.1.1.1.4">𝐹</ci><ci id="S4.E7.m1.1.1.1.5.cmml" xref="S4.E7.m1.1.1.1.5">𝑁</ci><apply id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"><times id="S4.E7.m1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.2"></times><ci id="S4.E7.m1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3">𝑀</ci><ci id="S4.E7.m1.1.1.1.1.1.1.4.cmml" xref="S4.E7.m1.1.1.1.1.1.1.4">𝐻</ci><ci id="S4.E7.m1.1.1.1.1.1.1.5.cmml" xref="S4.E7.m1.1.1.1.1.1.1.5">𝑆</ci><ci id="S4.E7.m1.1.1.1.1.1.1.6.cmml" xref="S4.E7.m1.1.1.1.1.1.1.6">𝐴</ci><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2">𝑇</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.3">𝑞</ci></apply><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.2">𝑇</ci><apply id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3"><times id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑒</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.3.4">𝑔</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.1c">T_{cat}=FFN(MHSA(T_{q}|T_{seg}))</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.1d">italic_T start_POSTSUBSCRIPT italic_c italic_a italic_t end_POSTSUBSCRIPT = italic_F italic_F italic_N ( italic_M italic_H italic_S italic_A ( italic_T start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT | italic_T start_POSTSUBSCRIPT italic_s italic_e italic_g end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p1.21">The shape of <math alttext="T_{cat}" class="ltx_Math" display="inline" id="S4.SS3.p1.14.m1.1"><semantics id="S4.SS3.p1.14.m1.1a"><msub id="S4.SS3.p1.14.m1.1.1" xref="S4.SS3.p1.14.m1.1.1.cmml"><mi id="S4.SS3.p1.14.m1.1.1.2" xref="S4.SS3.p1.14.m1.1.1.2.cmml">T</mi><mrow id="S4.SS3.p1.14.m1.1.1.3" xref="S4.SS3.p1.14.m1.1.1.3.cmml"><mi id="S4.SS3.p1.14.m1.1.1.3.2" xref="S4.SS3.p1.14.m1.1.1.3.2.cmml">c</mi><mo id="S4.SS3.p1.14.m1.1.1.3.1" xref="S4.SS3.p1.14.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.14.m1.1.1.3.3" xref="S4.SS3.p1.14.m1.1.1.3.3.cmml">a</mi><mo id="S4.SS3.p1.14.m1.1.1.3.1a" xref="S4.SS3.p1.14.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.14.m1.1.1.3.4" xref="S4.SS3.p1.14.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.14.m1.1b"><apply id="S4.SS3.p1.14.m1.1.1.cmml" xref="S4.SS3.p1.14.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.14.m1.1.1.1.cmml" xref="S4.SS3.p1.14.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.14.m1.1.1.2.cmml" xref="S4.SS3.p1.14.m1.1.1.2">𝑇</ci><apply id="S4.SS3.p1.14.m1.1.1.3.cmml" xref="S4.SS3.p1.14.m1.1.1.3"><times id="S4.SS3.p1.14.m1.1.1.3.1.cmml" xref="S4.SS3.p1.14.m1.1.1.3.1"></times><ci id="S4.SS3.p1.14.m1.1.1.3.2.cmml" xref="S4.SS3.p1.14.m1.1.1.3.2">𝑐</ci><ci id="S4.SS3.p1.14.m1.1.1.3.3.cmml" xref="S4.SS3.p1.14.m1.1.1.3.3">𝑎</ci><ci id="S4.SS3.p1.14.m1.1.1.3.4.cmml" xref="S4.SS3.p1.14.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.14.m1.1c">T_{cat}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.14.m1.1d">italic_T start_POSTSUBSCRIPT italic_c italic_a italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is <math alttext="2\times d" class="ltx_Math" display="inline" id="S4.SS3.p1.15.m2.1"><semantics id="S4.SS3.p1.15.m2.1a"><mrow id="S4.SS3.p1.15.m2.1.1" xref="S4.SS3.p1.15.m2.1.1.cmml"><mn id="S4.SS3.p1.15.m2.1.1.2" xref="S4.SS3.p1.15.m2.1.1.2.cmml">2</mn><mo id="S4.SS3.p1.15.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.15.m2.1.1.1.cmml">×</mo><mi id="S4.SS3.p1.15.m2.1.1.3" xref="S4.SS3.p1.15.m2.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.15.m2.1b"><apply id="S4.SS3.p1.15.m2.1.1.cmml" xref="S4.SS3.p1.15.m2.1.1"><times id="S4.SS3.p1.15.m2.1.1.1.cmml" xref="S4.SS3.p1.15.m2.1.1.1"></times><cn id="S4.SS3.p1.15.m2.1.1.2.cmml" type="integer" xref="S4.SS3.p1.15.m2.1.1.2">2</cn><ci id="S4.SS3.p1.15.m2.1.1.3.cmml" xref="S4.SS3.p1.15.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.15.m2.1c">2\times d</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.15.m2.1d">2 × italic_d</annotation></semantics></math>, where <math alttext="T_{cat}[0]" class="ltx_Math" display="inline" id="S4.SS3.p1.16.m3.1"><semantics id="S4.SS3.p1.16.m3.1a"><mrow id="S4.SS3.p1.16.m3.1.2" xref="S4.SS3.p1.16.m3.1.2.cmml"><msub id="S4.SS3.p1.16.m3.1.2.2" xref="S4.SS3.p1.16.m3.1.2.2.cmml"><mi id="S4.SS3.p1.16.m3.1.2.2.2" xref="S4.SS3.p1.16.m3.1.2.2.2.cmml">T</mi><mrow id="S4.SS3.p1.16.m3.1.2.2.3" xref="S4.SS3.p1.16.m3.1.2.2.3.cmml"><mi id="S4.SS3.p1.16.m3.1.2.2.3.2" xref="S4.SS3.p1.16.m3.1.2.2.3.2.cmml">c</mi><mo id="S4.SS3.p1.16.m3.1.2.2.3.1" xref="S4.SS3.p1.16.m3.1.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.16.m3.1.2.2.3.3" xref="S4.SS3.p1.16.m3.1.2.2.3.3.cmml">a</mi><mo id="S4.SS3.p1.16.m3.1.2.2.3.1a" xref="S4.SS3.p1.16.m3.1.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.16.m3.1.2.2.3.4" xref="S4.SS3.p1.16.m3.1.2.2.3.4.cmml">t</mi></mrow></msub><mo id="S4.SS3.p1.16.m3.1.2.1" xref="S4.SS3.p1.16.m3.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.p1.16.m3.1.2.3.2" xref="S4.SS3.p1.16.m3.1.2.3.1.cmml"><mo id="S4.SS3.p1.16.m3.1.2.3.2.1" stretchy="false" xref="S4.SS3.p1.16.m3.1.2.3.1.1.cmml">[</mo><mn id="S4.SS3.p1.16.m3.1.1" xref="S4.SS3.p1.16.m3.1.1.cmml">0</mn><mo id="S4.SS3.p1.16.m3.1.2.3.2.2" stretchy="false" xref="S4.SS3.p1.16.m3.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.16.m3.1b"><apply id="S4.SS3.p1.16.m3.1.2.cmml" xref="S4.SS3.p1.16.m3.1.2"><times id="S4.SS3.p1.16.m3.1.2.1.cmml" xref="S4.SS3.p1.16.m3.1.2.1"></times><apply id="S4.SS3.p1.16.m3.1.2.2.cmml" xref="S4.SS3.p1.16.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.16.m3.1.2.2.1.cmml" xref="S4.SS3.p1.16.m3.1.2.2">subscript</csymbol><ci id="S4.SS3.p1.16.m3.1.2.2.2.cmml" xref="S4.SS3.p1.16.m3.1.2.2.2">𝑇</ci><apply id="S4.SS3.p1.16.m3.1.2.2.3.cmml" xref="S4.SS3.p1.16.m3.1.2.2.3"><times id="S4.SS3.p1.16.m3.1.2.2.3.1.cmml" xref="S4.SS3.p1.16.m3.1.2.2.3.1"></times><ci id="S4.SS3.p1.16.m3.1.2.2.3.2.cmml" xref="S4.SS3.p1.16.m3.1.2.2.3.2">𝑐</ci><ci id="S4.SS3.p1.16.m3.1.2.2.3.3.cmml" xref="S4.SS3.p1.16.m3.1.2.2.3.3">𝑎</ci><ci id="S4.SS3.p1.16.m3.1.2.2.3.4.cmml" xref="S4.SS3.p1.16.m3.1.2.2.3.4">𝑡</ci></apply></apply><apply id="S4.SS3.p1.16.m3.1.2.3.1.cmml" xref="S4.SS3.p1.16.m3.1.2.3.2"><csymbol cd="latexml" id="S4.SS3.p1.16.m3.1.2.3.1.1.cmml" xref="S4.SS3.p1.16.m3.1.2.3.2.1">delimited-[]</csymbol><cn id="S4.SS3.p1.16.m3.1.1.cmml" type="integer" xref="S4.SS3.p1.16.m3.1.1">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.16.m3.1c">T_{cat}[0]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.16.m3.1d">italic_T start_POSTSUBSCRIPT italic_c italic_a italic_t end_POSTSUBSCRIPT [ 0 ]</annotation></semantics></math> is the query token embedding and <math alttext="T_{cat}[1]" class="ltx_Math" display="inline" id="S4.SS3.p1.17.m4.1"><semantics id="S4.SS3.p1.17.m4.1a"><mrow id="S4.SS3.p1.17.m4.1.2" xref="S4.SS3.p1.17.m4.1.2.cmml"><msub id="S4.SS3.p1.17.m4.1.2.2" xref="S4.SS3.p1.17.m4.1.2.2.cmml"><mi id="S4.SS3.p1.17.m4.1.2.2.2" xref="S4.SS3.p1.17.m4.1.2.2.2.cmml">T</mi><mrow id="S4.SS3.p1.17.m4.1.2.2.3" xref="S4.SS3.p1.17.m4.1.2.2.3.cmml"><mi id="S4.SS3.p1.17.m4.1.2.2.3.2" xref="S4.SS3.p1.17.m4.1.2.2.3.2.cmml">c</mi><mo id="S4.SS3.p1.17.m4.1.2.2.3.1" xref="S4.SS3.p1.17.m4.1.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.17.m4.1.2.2.3.3" xref="S4.SS3.p1.17.m4.1.2.2.3.3.cmml">a</mi><mo id="S4.SS3.p1.17.m4.1.2.2.3.1a" xref="S4.SS3.p1.17.m4.1.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.17.m4.1.2.2.3.4" xref="S4.SS3.p1.17.m4.1.2.2.3.4.cmml">t</mi></mrow></msub><mo id="S4.SS3.p1.17.m4.1.2.1" xref="S4.SS3.p1.17.m4.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.p1.17.m4.1.2.3.2" xref="S4.SS3.p1.17.m4.1.2.3.1.cmml"><mo id="S4.SS3.p1.17.m4.1.2.3.2.1" stretchy="false" xref="S4.SS3.p1.17.m4.1.2.3.1.1.cmml">[</mo><mn id="S4.SS3.p1.17.m4.1.1" xref="S4.SS3.p1.17.m4.1.1.cmml">1</mn><mo id="S4.SS3.p1.17.m4.1.2.3.2.2" stretchy="false" xref="S4.SS3.p1.17.m4.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.17.m4.1b"><apply id="S4.SS3.p1.17.m4.1.2.cmml" xref="S4.SS3.p1.17.m4.1.2"><times id="S4.SS3.p1.17.m4.1.2.1.cmml" xref="S4.SS3.p1.17.m4.1.2.1"></times><apply id="S4.SS3.p1.17.m4.1.2.2.cmml" xref="S4.SS3.p1.17.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.17.m4.1.2.2.1.cmml" xref="S4.SS3.p1.17.m4.1.2.2">subscript</csymbol><ci id="S4.SS3.p1.17.m4.1.2.2.2.cmml" xref="S4.SS3.p1.17.m4.1.2.2.2">𝑇</ci><apply id="S4.SS3.p1.17.m4.1.2.2.3.cmml" xref="S4.SS3.p1.17.m4.1.2.2.3"><times id="S4.SS3.p1.17.m4.1.2.2.3.1.cmml" xref="S4.SS3.p1.17.m4.1.2.2.3.1"></times><ci id="S4.SS3.p1.17.m4.1.2.2.3.2.cmml" xref="S4.SS3.p1.17.m4.1.2.2.3.2">𝑐</ci><ci id="S4.SS3.p1.17.m4.1.2.2.3.3.cmml" xref="S4.SS3.p1.17.m4.1.2.2.3.3">𝑎</ci><ci id="S4.SS3.p1.17.m4.1.2.2.3.4.cmml" xref="S4.SS3.p1.17.m4.1.2.2.3.4">𝑡</ci></apply></apply><apply id="S4.SS3.p1.17.m4.1.2.3.1.cmml" xref="S4.SS3.p1.17.m4.1.2.3.2"><csymbol cd="latexml" id="S4.SS3.p1.17.m4.1.2.3.1.1.cmml" xref="S4.SS3.p1.17.m4.1.2.3.2.1">delimited-[]</csymbol><cn id="S4.SS3.p1.17.m4.1.1.cmml" type="integer" xref="S4.SS3.p1.17.m4.1.1">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.17.m4.1c">T_{cat}[1]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.17.m4.1d">italic_T start_POSTSUBSCRIPT italic_c italic_a italic_t end_POSTSUBSCRIPT [ 1 ]</annotation></semantics></math> is <math alttext="\langle" class="ltx_Math" display="inline" id="S4.SS3.p1.18.m5.1"><semantics id="S4.SS3.p1.18.m5.1a"><mo id="S4.SS3.p1.18.m5.1.1" stretchy="false" xref="S4.SS3.p1.18.m5.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.18.m5.1b"><ci id="S4.SS3.p1.18.m5.1.1.cmml" xref="S4.SS3.p1.18.m5.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.18.m5.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.18.m5.1d">⟨</annotation></semantics></math><span class="ltx_text" id="S4.SS3.p1.21.1">SEG</span><math alttext="\rangle" class="ltx_Math" display="inline" id="S4.SS3.p1.19.m6.1"><semantics id="S4.SS3.p1.19.m6.1a"><mo id="S4.SS3.p1.19.m6.1.1" stretchy="false" xref="S4.SS3.p1.19.m6.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.19.m6.1b"><ci id="S4.SS3.p1.19.m6.1.1.cmml" xref="S4.SS3.p1.19.m6.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.19.m6.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.19.m6.1d">⟩</annotation></semantics></math> embedding. We then perform two-way cross attention between <math alttext="T_{cat}" class="ltx_Math" display="inline" id="S4.SS3.p1.20.m7.1"><semantics id="S4.SS3.p1.20.m7.1a"><msub id="S4.SS3.p1.20.m7.1.1" xref="S4.SS3.p1.20.m7.1.1.cmml"><mi id="S4.SS3.p1.20.m7.1.1.2" xref="S4.SS3.p1.20.m7.1.1.2.cmml">T</mi><mrow id="S4.SS3.p1.20.m7.1.1.3" xref="S4.SS3.p1.20.m7.1.1.3.cmml"><mi id="S4.SS3.p1.20.m7.1.1.3.2" xref="S4.SS3.p1.20.m7.1.1.3.2.cmml">c</mi><mo id="S4.SS3.p1.20.m7.1.1.3.1" xref="S4.SS3.p1.20.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.20.m7.1.1.3.3" xref="S4.SS3.p1.20.m7.1.1.3.3.cmml">a</mi><mo id="S4.SS3.p1.20.m7.1.1.3.1a" xref="S4.SS3.p1.20.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.20.m7.1.1.3.4" xref="S4.SS3.p1.20.m7.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.20.m7.1b"><apply id="S4.SS3.p1.20.m7.1.1.cmml" xref="S4.SS3.p1.20.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.20.m7.1.1.1.cmml" xref="S4.SS3.p1.20.m7.1.1">subscript</csymbol><ci id="S4.SS3.p1.20.m7.1.1.2.cmml" xref="S4.SS3.p1.20.m7.1.1.2">𝑇</ci><apply id="S4.SS3.p1.20.m7.1.1.3.cmml" xref="S4.SS3.p1.20.m7.1.1.3"><times id="S4.SS3.p1.20.m7.1.1.3.1.cmml" xref="S4.SS3.p1.20.m7.1.1.3.1"></times><ci id="S4.SS3.p1.20.m7.1.1.3.2.cmml" xref="S4.SS3.p1.20.m7.1.1.3.2">𝑐</ci><ci id="S4.SS3.p1.20.m7.1.1.3.3.cmml" xref="S4.SS3.p1.20.m7.1.1.3.3">𝑎</ci><ci id="S4.SS3.p1.20.m7.1.1.3.4.cmml" xref="S4.SS3.p1.20.m7.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.20.m7.1c">T_{cat}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.20.m7.1d">italic_T start_POSTSUBSCRIPT italic_c italic_a italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="T_{img}" class="ltx_Math" display="inline" id="S4.SS3.p1.21.m8.1"><semantics id="S4.SS3.p1.21.m8.1a"><msub id="S4.SS3.p1.21.m8.1.1" xref="S4.SS3.p1.21.m8.1.1.cmml"><mi id="S4.SS3.p1.21.m8.1.1.2" xref="S4.SS3.p1.21.m8.1.1.2.cmml">T</mi><mrow id="S4.SS3.p1.21.m8.1.1.3" xref="S4.SS3.p1.21.m8.1.1.3.cmml"><mi id="S4.SS3.p1.21.m8.1.1.3.2" xref="S4.SS3.p1.21.m8.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p1.21.m8.1.1.3.1" xref="S4.SS3.p1.21.m8.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.21.m8.1.1.3.3" xref="S4.SS3.p1.21.m8.1.1.3.3.cmml">m</mi><mo id="S4.SS3.p1.21.m8.1.1.3.1a" xref="S4.SS3.p1.21.m8.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.21.m8.1.1.3.4" xref="S4.SS3.p1.21.m8.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.21.m8.1b"><apply id="S4.SS3.p1.21.m8.1.1.cmml" xref="S4.SS3.p1.21.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.21.m8.1.1.1.cmml" xref="S4.SS3.p1.21.m8.1.1">subscript</csymbol><ci id="S4.SS3.p1.21.m8.1.1.2.cmml" xref="S4.SS3.p1.21.m8.1.1.2">𝑇</ci><apply id="S4.SS3.p1.21.m8.1.1.3.cmml" xref="S4.SS3.p1.21.m8.1.1.3"><times id="S4.SS3.p1.21.m8.1.1.3.1.cmml" xref="S4.SS3.p1.21.m8.1.1.3.1"></times><ci id="S4.SS3.p1.21.m8.1.1.3.2.cmml" xref="S4.SS3.p1.21.m8.1.1.3.2">𝑖</ci><ci id="S4.SS3.p1.21.m8.1.1.3.3.cmml" xref="S4.SS3.p1.21.m8.1.1.3.3">𝑚</ci><ci id="S4.SS3.p1.21.m8.1.1.3.4.cmml" xref="S4.SS3.p1.21.m8.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.21.m8.1c">T_{img}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.21.m8.1d">italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="T_{cat}^{\prime}=FFN(MHSA(tgt=T_{cat},src=T_{img}))" class="ltx_Math" display="block" id="S4.E8.m1.1"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><msubsup id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.3.2.2" xref="S4.E8.m1.1.1.3.2.2.cmml">T</mi><mrow id="S4.E8.m1.1.1.3.2.3" xref="S4.E8.m1.1.1.3.2.3.cmml"><mi id="S4.E8.m1.1.1.3.2.3.2" xref="S4.E8.m1.1.1.3.2.3.2.cmml">c</mi><mo id="S4.E8.m1.1.1.3.2.3.1" xref="S4.E8.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.1.1.3.2.3.3" xref="S4.E8.m1.1.1.3.2.3.3.cmml">a</mi><mo id="S4.E8.m1.1.1.3.2.3.1a" xref="S4.E8.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.1.1.3.2.3.4" xref="S4.E8.m1.1.1.3.2.3.4.cmml">t</mi></mrow><mo id="S4.E8.m1.1.1.3.3" xref="S4.E8.m1.1.1.3.3.cmml">′</mo></msubsup><mo id="S4.E8.m1.1.1.2" xref="S4.E8.m1.1.1.2.cmml">=</mo><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.3" xref="S4.E8.m1.1.1.1.3.cmml">F</mi><mo id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.4" xref="S4.E8.m1.1.1.1.4.cmml">F</mi><mo id="S4.E8.m1.1.1.1.2a" xref="S4.E8.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.5" xref="S4.E8.m1.1.1.1.5.cmml">N</mi><mo id="S4.E8.m1.1.1.1.2b" xref="S4.E8.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.3.cmml">M</mi><mo id="S4.E8.m1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.1.4" xref="S4.E8.m1.1.1.1.1.1.1.4.cmml">H</mi><mo id="S4.E8.m1.1.1.1.1.1.1.2a" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.1.5" xref="S4.E8.m1.1.1.1.1.1.1.5.cmml">S</mi><mo id="S4.E8.m1.1.1.1.1.1.1.2b" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.1.6" xref="S4.E8.m1.1.1.1.1.1.1.6.cmml">A</mi><mo id="S4.E8.m1.1.1.1.1.1.1.2c" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">g</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.1a" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.4.cmml">t</mi></mrow><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><msub id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">T</mi><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">c</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">a</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.3a.cmml">,</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">s</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">r</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.1a" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.cmml">c</mi></mrow><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">=</mo><msub id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">T</mi><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.cmml">i</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.3.cmml">m</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.1a" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.1.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.4" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.4.cmml">g</mi></mrow></msub></mrow></mrow><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><eq id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1.2"></eq><apply id="S4.E8.m1.1.1.3.cmml" xref="S4.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.3">superscript</csymbol><apply id="S4.E8.m1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.3.2.2">𝑇</ci><apply id="S4.E8.m1.1.1.3.2.3.cmml" xref="S4.E8.m1.1.1.3.2.3"><times id="S4.E8.m1.1.1.3.2.3.1.cmml" xref="S4.E8.m1.1.1.3.2.3.1"></times><ci id="S4.E8.m1.1.1.3.2.3.2.cmml" xref="S4.E8.m1.1.1.3.2.3.2">𝑐</ci><ci id="S4.E8.m1.1.1.3.2.3.3.cmml" xref="S4.E8.m1.1.1.3.2.3.3">𝑎</ci><ci id="S4.E8.m1.1.1.3.2.3.4.cmml" xref="S4.E8.m1.1.1.3.2.3.4">𝑡</ci></apply></apply><ci id="S4.E8.m1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.3.3">′</ci></apply><apply id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><times id="S4.E8.m1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.2"></times><ci id="S4.E8.m1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.3">𝐹</ci><ci id="S4.E8.m1.1.1.1.4.cmml" xref="S4.E8.m1.1.1.1.4">𝐹</ci><ci id="S4.E8.m1.1.1.1.5.cmml" xref="S4.E8.m1.1.1.1.5">𝑁</ci><apply id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><times id="S4.E8.m1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2"></times><ci id="S4.E8.m1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3">𝑀</ci><ci id="S4.E8.m1.1.1.1.1.1.1.4.cmml" xref="S4.E8.m1.1.1.1.1.1.1.4">𝐻</ci><ci id="S4.E8.m1.1.1.1.1.1.1.5.cmml" xref="S4.E8.m1.1.1.1.1.1.1.5">𝑆</ci><ci id="S4.E8.m1.1.1.1.1.1.1.6.cmml" xref="S4.E8.m1.1.1.1.1.1.1.6">𝐴</ci><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1"><eq id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.1"></eq><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2"><times id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.1"></times><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑡</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑔</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.2.4">𝑡</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑇</ci><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><times id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑐</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2"><eq id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.1"></eq><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2"><times id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.1"></times><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑠</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑟</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.4.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.4">𝑐</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑇</ci><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3"><times id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.1"></times><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.2">𝑖</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.3">𝑚</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.4.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.4">𝑔</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">T_{cat}^{\prime}=FFN(MHSA(tgt=T_{cat},src=T_{img}))</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.1d">italic_T start_POSTSUBSCRIPT italic_c italic_a italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_F italic_F italic_N ( italic_M italic_H italic_S italic_A ( italic_t italic_g italic_t = italic_T start_POSTSUBSCRIPT italic_c italic_a italic_t end_POSTSUBSCRIPT , italic_s italic_r italic_c = italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="T_{img}^{\prime}=MHSA(tgt=T_{img},src=T_{cat}^{\prime})" class="ltx_Math" display="block" id="S4.E9.m1.1"><semantics id="S4.E9.m1.1a"><mrow id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml"><msubsup id="S4.E9.m1.1.1.3" xref="S4.E9.m1.1.1.3.cmml"><mi id="S4.E9.m1.1.1.3.2.2" xref="S4.E9.m1.1.1.3.2.2.cmml">T</mi><mrow id="S4.E9.m1.1.1.3.2.3" xref="S4.E9.m1.1.1.3.2.3.cmml"><mi id="S4.E9.m1.1.1.3.2.3.2" xref="S4.E9.m1.1.1.3.2.3.2.cmml">i</mi><mo id="S4.E9.m1.1.1.3.2.3.1" xref="S4.E9.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.3.2.3.3" xref="S4.E9.m1.1.1.3.2.3.3.cmml">m</mi><mo id="S4.E9.m1.1.1.3.2.3.1a" xref="S4.E9.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.3.2.3.4" xref="S4.E9.m1.1.1.3.2.3.4.cmml">g</mi></mrow><mo id="S4.E9.m1.1.1.3.3" xref="S4.E9.m1.1.1.3.3.cmml">′</mo></msubsup><mo id="S4.E9.m1.1.1.2" xref="S4.E9.m1.1.1.2.cmml">=</mo><mrow id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.3" xref="S4.E9.m1.1.1.1.3.cmml">M</mi><mo id="S4.E9.m1.1.1.1.2" xref="S4.E9.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.4" xref="S4.E9.m1.1.1.1.4.cmml">H</mi><mo id="S4.E9.m1.1.1.1.2a" xref="S4.E9.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.5" xref="S4.E9.m1.1.1.1.5.cmml">S</mi><mo id="S4.E9.m1.1.1.1.2b" xref="S4.E9.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.6" xref="S4.E9.m1.1.1.1.6.cmml">A</mi><mo id="S4.E9.m1.1.1.1.2c" xref="S4.E9.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.cmml"><mo id="S4.E9.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.3.cmml"><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.cmml">t</mi><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.2.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.3.cmml">g</mi><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.2.1a" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.2.4" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.4.cmml">t</mi></mrow><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml">=</mo><msub id="S4.E9.m1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml">T</mi><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">m</mi><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.1a" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.4" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.4.cmml">g</mi></mrow></msub></mrow><mo id="S4.E9.m1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.1.1.3a.cmml">,</mo><mrow id="S4.E9.m1.1.1.1.1.1.1.2.2" xref="S4.E9.m1.1.1.1.1.1.1.2.2.cmml"><mrow id="S4.E9.m1.1.1.1.1.1.1.2.2.2" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.2.2.2.2" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2.2.cmml">s</mi><mo id="S4.E9.m1.1.1.1.1.1.1.2.2.2.1" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.1.1.2.2.2.3" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2.3.cmml">r</mi><mo id="S4.E9.m1.1.1.1.1.1.1.2.2.2.1a" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.1.1.2.2.2.4" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2.4.cmml">c</mi></mrow><mo id="S4.E9.m1.1.1.1.1.1.1.2.2.1" xref="S4.E9.m1.1.1.1.1.1.1.2.2.1.cmml">=</mo><msubsup id="S4.E9.m1.1.1.1.1.1.1.2.2.3" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.2" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.2.cmml">T</mi><mrow id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.2" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.2.cmml">c</mi><mo id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.1" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.3" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.3.cmml">a</mi><mo id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.1a" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.4" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.4.cmml">t</mi></mrow><mo id="S4.E9.m1.1.1.1.1.1.1.2.2.3.3" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.3.cmml">′</mo></msubsup></mrow></mrow><mo id="S4.E9.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1"><eq id="S4.E9.m1.1.1.2.cmml" xref="S4.E9.m1.1.1.2"></eq><apply id="S4.E9.m1.1.1.3.cmml" xref="S4.E9.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.3">superscript</csymbol><apply id="S4.E9.m1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.3.2.1.cmml" xref="S4.E9.m1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.1.1.3.2.2.cmml" xref="S4.E9.m1.1.1.3.2.2">𝑇</ci><apply id="S4.E9.m1.1.1.3.2.3.cmml" xref="S4.E9.m1.1.1.3.2.3"><times id="S4.E9.m1.1.1.3.2.3.1.cmml" xref="S4.E9.m1.1.1.3.2.3.1"></times><ci id="S4.E9.m1.1.1.3.2.3.2.cmml" xref="S4.E9.m1.1.1.3.2.3.2">𝑖</ci><ci id="S4.E9.m1.1.1.3.2.3.3.cmml" xref="S4.E9.m1.1.1.3.2.3.3">𝑚</ci><ci id="S4.E9.m1.1.1.3.2.3.4.cmml" xref="S4.E9.m1.1.1.3.2.3.4">𝑔</ci></apply></apply><ci id="S4.E9.m1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.3.3">′</ci></apply><apply id="S4.E9.m1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"><times id="S4.E9.m1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.2"></times><ci id="S4.E9.m1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.3">𝑀</ci><ci id="S4.E9.m1.1.1.1.4.cmml" xref="S4.E9.m1.1.1.1.4">𝐻</ci><ci id="S4.E9.m1.1.1.1.5.cmml" xref="S4.E9.m1.1.1.1.5">𝑆</ci><ci id="S4.E9.m1.1.1.1.6.cmml" xref="S4.E9.m1.1.1.1.6">𝐴</ci><apply id="S4.E9.m1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.3a.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1"><eq id="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1"></eq><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2"><times id="S4.E9.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.1"></times><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2">𝑡</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.3">𝑔</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.4">𝑡</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.2">𝑇</ci><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3"><times id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.3">𝑚</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.3.4">𝑔</ci></apply></apply></apply><apply id="S4.E9.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2"><eq id="S4.E9.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.1"></eq><apply id="S4.E9.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2"><times id="S4.E9.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2.1"></times><ci id="S4.E9.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2.2">𝑠</ci><ci id="S4.E9.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2.3">𝑟</ci><ci id="S4.E9.m1.1.1.1.1.1.1.2.2.2.4.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2.4">𝑐</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.2">𝑇</ci><apply id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3"><times id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.1"></times><ci id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.2">𝑐</ci><ci id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.3">𝑎</ci><ci id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.4.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.3.4">𝑡</ci></apply></apply><ci id="S4.E9.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">T_{img}^{\prime}=MHSA(tgt=T_{img},src=T_{cat}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.1d">italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_M italic_H italic_S italic_A ( italic_t italic_g italic_t = italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT , italic_s italic_r italic_c = italic_T start_POSTSUBSCRIPT italic_c italic_a italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p1.26">The self-attention of <math alttext="T_{q}|T_{seg}" class="ltx_Math" display="inline" id="S4.SS3.p1.22.m1.1"><semantics id="S4.SS3.p1.22.m1.1a"><mrow id="S4.SS3.p1.22.m1.1.1" xref="S4.SS3.p1.22.m1.1.1.cmml"><msub id="S4.SS3.p1.22.m1.1.1.2" xref="S4.SS3.p1.22.m1.1.1.2.cmml"><mi id="S4.SS3.p1.22.m1.1.1.2.2" xref="S4.SS3.p1.22.m1.1.1.2.2.cmml">T</mi><mi id="S4.SS3.p1.22.m1.1.1.2.3" xref="S4.SS3.p1.22.m1.1.1.2.3.cmml">q</mi></msub><mo fence="false" id="S4.SS3.p1.22.m1.1.1.1" xref="S4.SS3.p1.22.m1.1.1.1.cmml">|</mo><msub id="S4.SS3.p1.22.m1.1.1.3" xref="S4.SS3.p1.22.m1.1.1.3.cmml"><mi id="S4.SS3.p1.22.m1.1.1.3.2" xref="S4.SS3.p1.22.m1.1.1.3.2.cmml">T</mi><mrow id="S4.SS3.p1.22.m1.1.1.3.3" xref="S4.SS3.p1.22.m1.1.1.3.3.cmml"><mi id="S4.SS3.p1.22.m1.1.1.3.3.2" xref="S4.SS3.p1.22.m1.1.1.3.3.2.cmml">s</mi><mo id="S4.SS3.p1.22.m1.1.1.3.3.1" xref="S4.SS3.p1.22.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.22.m1.1.1.3.3.3" xref="S4.SS3.p1.22.m1.1.1.3.3.3.cmml">e</mi><mo id="S4.SS3.p1.22.m1.1.1.3.3.1a" xref="S4.SS3.p1.22.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.22.m1.1.1.3.3.4" xref="S4.SS3.p1.22.m1.1.1.3.3.4.cmml">g</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.22.m1.1b"><apply id="S4.SS3.p1.22.m1.1.1.cmml" xref="S4.SS3.p1.22.m1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.22.m1.1.1.1.cmml" xref="S4.SS3.p1.22.m1.1.1.1">conditional</csymbol><apply id="S4.SS3.p1.22.m1.1.1.2.cmml" xref="S4.SS3.p1.22.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.22.m1.1.1.2.1.cmml" xref="S4.SS3.p1.22.m1.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.22.m1.1.1.2.2.cmml" xref="S4.SS3.p1.22.m1.1.1.2.2">𝑇</ci><ci id="S4.SS3.p1.22.m1.1.1.2.3.cmml" xref="S4.SS3.p1.22.m1.1.1.2.3">𝑞</ci></apply><apply id="S4.SS3.p1.22.m1.1.1.3.cmml" xref="S4.SS3.p1.22.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.22.m1.1.1.3.1.cmml" xref="S4.SS3.p1.22.m1.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.22.m1.1.1.3.2.cmml" xref="S4.SS3.p1.22.m1.1.1.3.2">𝑇</ci><apply id="S4.SS3.p1.22.m1.1.1.3.3.cmml" xref="S4.SS3.p1.22.m1.1.1.3.3"><times id="S4.SS3.p1.22.m1.1.1.3.3.1.cmml" xref="S4.SS3.p1.22.m1.1.1.3.3.1"></times><ci id="S4.SS3.p1.22.m1.1.1.3.3.2.cmml" xref="S4.SS3.p1.22.m1.1.1.3.3.2">𝑠</ci><ci id="S4.SS3.p1.22.m1.1.1.3.3.3.cmml" xref="S4.SS3.p1.22.m1.1.1.3.3.3">𝑒</ci><ci id="S4.SS3.p1.22.m1.1.1.3.3.4.cmml" xref="S4.SS3.p1.22.m1.1.1.3.3.4">𝑔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.22.m1.1c">T_{q}|T_{seg}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.22.m1.1d">italic_T start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT | italic_T start_POSTSUBSCRIPT italic_s italic_e italic_g end_POSTSUBSCRIPT</annotation></semantics></math> and cross attention between <math alttext="T_{cat}" class="ltx_Math" display="inline" id="S4.SS3.p1.23.m2.1"><semantics id="S4.SS3.p1.23.m2.1a"><msub id="S4.SS3.p1.23.m2.1.1" xref="S4.SS3.p1.23.m2.1.1.cmml"><mi id="S4.SS3.p1.23.m2.1.1.2" xref="S4.SS3.p1.23.m2.1.1.2.cmml">T</mi><mrow id="S4.SS3.p1.23.m2.1.1.3" xref="S4.SS3.p1.23.m2.1.1.3.cmml"><mi id="S4.SS3.p1.23.m2.1.1.3.2" xref="S4.SS3.p1.23.m2.1.1.3.2.cmml">c</mi><mo id="S4.SS3.p1.23.m2.1.1.3.1" xref="S4.SS3.p1.23.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.23.m2.1.1.3.3" xref="S4.SS3.p1.23.m2.1.1.3.3.cmml">a</mi><mo id="S4.SS3.p1.23.m2.1.1.3.1a" xref="S4.SS3.p1.23.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.23.m2.1.1.3.4" xref="S4.SS3.p1.23.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.23.m2.1b"><apply id="S4.SS3.p1.23.m2.1.1.cmml" xref="S4.SS3.p1.23.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.23.m2.1.1.1.cmml" xref="S4.SS3.p1.23.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.23.m2.1.1.2.cmml" xref="S4.SS3.p1.23.m2.1.1.2">𝑇</ci><apply id="S4.SS3.p1.23.m2.1.1.3.cmml" xref="S4.SS3.p1.23.m2.1.1.3"><times id="S4.SS3.p1.23.m2.1.1.3.1.cmml" xref="S4.SS3.p1.23.m2.1.1.3.1"></times><ci id="S4.SS3.p1.23.m2.1.1.3.2.cmml" xref="S4.SS3.p1.23.m2.1.1.3.2">𝑐</ci><ci id="S4.SS3.p1.23.m2.1.1.3.3.cmml" xref="S4.SS3.p1.23.m2.1.1.3.3">𝑎</ci><ci id="S4.SS3.p1.23.m2.1.1.3.4.cmml" xref="S4.SS3.p1.23.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.23.m2.1c">T_{cat}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.23.m2.1d">italic_T start_POSTSUBSCRIPT italic_c italic_a italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="T_{img}" class="ltx_Math" display="inline" id="S4.SS3.p1.24.m3.1"><semantics id="S4.SS3.p1.24.m3.1a"><msub id="S4.SS3.p1.24.m3.1.1" xref="S4.SS3.p1.24.m3.1.1.cmml"><mi id="S4.SS3.p1.24.m3.1.1.2" xref="S4.SS3.p1.24.m3.1.1.2.cmml">T</mi><mrow id="S4.SS3.p1.24.m3.1.1.3" xref="S4.SS3.p1.24.m3.1.1.3.cmml"><mi id="S4.SS3.p1.24.m3.1.1.3.2" xref="S4.SS3.p1.24.m3.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p1.24.m3.1.1.3.1" xref="S4.SS3.p1.24.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.24.m3.1.1.3.3" xref="S4.SS3.p1.24.m3.1.1.3.3.cmml">m</mi><mo id="S4.SS3.p1.24.m3.1.1.3.1a" xref="S4.SS3.p1.24.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.24.m3.1.1.3.4" xref="S4.SS3.p1.24.m3.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.24.m3.1b"><apply id="S4.SS3.p1.24.m3.1.1.cmml" xref="S4.SS3.p1.24.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.24.m3.1.1.1.cmml" xref="S4.SS3.p1.24.m3.1.1">subscript</csymbol><ci id="S4.SS3.p1.24.m3.1.1.2.cmml" xref="S4.SS3.p1.24.m3.1.1.2">𝑇</ci><apply id="S4.SS3.p1.24.m3.1.1.3.cmml" xref="S4.SS3.p1.24.m3.1.1.3"><times id="S4.SS3.p1.24.m3.1.1.3.1.cmml" xref="S4.SS3.p1.24.m3.1.1.3.1"></times><ci id="S4.SS3.p1.24.m3.1.1.3.2.cmml" xref="S4.SS3.p1.24.m3.1.1.3.2">𝑖</ci><ci id="S4.SS3.p1.24.m3.1.1.3.3.cmml" xref="S4.SS3.p1.24.m3.1.1.3.3">𝑚</ci><ci id="S4.SS3.p1.24.m3.1.1.3.4.cmml" xref="S4.SS3.p1.24.m3.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.24.m3.1c">T_{img}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.24.m3.1d">italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT</annotation></semantics></math> make the query token understand the relation between the image patch tokens and reasoning task. In the end, we perform inner-product between query embedding (<math alttext="T_{q}=T_{cat}^{\prime}[0]" class="ltx_Math" display="inline" id="S4.SS3.p1.25.m4.1"><semantics id="S4.SS3.p1.25.m4.1a"><mrow id="S4.SS3.p1.25.m4.1.2" xref="S4.SS3.p1.25.m4.1.2.cmml"><msub id="S4.SS3.p1.25.m4.1.2.2" xref="S4.SS3.p1.25.m4.1.2.2.cmml"><mi id="S4.SS3.p1.25.m4.1.2.2.2" xref="S4.SS3.p1.25.m4.1.2.2.2.cmml">T</mi><mi id="S4.SS3.p1.25.m4.1.2.2.3" xref="S4.SS3.p1.25.m4.1.2.2.3.cmml">q</mi></msub><mo id="S4.SS3.p1.25.m4.1.2.1" xref="S4.SS3.p1.25.m4.1.2.1.cmml">=</mo><mrow id="S4.SS3.p1.25.m4.1.2.3" xref="S4.SS3.p1.25.m4.1.2.3.cmml"><msubsup id="S4.SS3.p1.25.m4.1.2.3.2" xref="S4.SS3.p1.25.m4.1.2.3.2.cmml"><mi id="S4.SS3.p1.25.m4.1.2.3.2.2.2" xref="S4.SS3.p1.25.m4.1.2.3.2.2.2.cmml">T</mi><mrow id="S4.SS3.p1.25.m4.1.2.3.2.2.3" xref="S4.SS3.p1.25.m4.1.2.3.2.2.3.cmml"><mi id="S4.SS3.p1.25.m4.1.2.3.2.2.3.2" xref="S4.SS3.p1.25.m4.1.2.3.2.2.3.2.cmml">c</mi><mo id="S4.SS3.p1.25.m4.1.2.3.2.2.3.1" xref="S4.SS3.p1.25.m4.1.2.3.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.25.m4.1.2.3.2.2.3.3" xref="S4.SS3.p1.25.m4.1.2.3.2.2.3.3.cmml">a</mi><mo id="S4.SS3.p1.25.m4.1.2.3.2.2.3.1a" xref="S4.SS3.p1.25.m4.1.2.3.2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.25.m4.1.2.3.2.2.3.4" xref="S4.SS3.p1.25.m4.1.2.3.2.2.3.4.cmml">t</mi></mrow><mo id="S4.SS3.p1.25.m4.1.2.3.2.3" xref="S4.SS3.p1.25.m4.1.2.3.2.3.cmml">′</mo></msubsup><mo id="S4.SS3.p1.25.m4.1.2.3.1" xref="S4.SS3.p1.25.m4.1.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p1.25.m4.1.2.3.3.2" xref="S4.SS3.p1.25.m4.1.2.3.3.1.cmml"><mo id="S4.SS3.p1.25.m4.1.2.3.3.2.1" stretchy="false" xref="S4.SS3.p1.25.m4.1.2.3.3.1.1.cmml">[</mo><mn id="S4.SS3.p1.25.m4.1.1" xref="S4.SS3.p1.25.m4.1.1.cmml">0</mn><mo id="S4.SS3.p1.25.m4.1.2.3.3.2.2" stretchy="false" xref="S4.SS3.p1.25.m4.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.25.m4.1b"><apply id="S4.SS3.p1.25.m4.1.2.cmml" xref="S4.SS3.p1.25.m4.1.2"><eq id="S4.SS3.p1.25.m4.1.2.1.cmml" xref="S4.SS3.p1.25.m4.1.2.1"></eq><apply id="S4.SS3.p1.25.m4.1.2.2.cmml" xref="S4.SS3.p1.25.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.25.m4.1.2.2.1.cmml" xref="S4.SS3.p1.25.m4.1.2.2">subscript</csymbol><ci id="S4.SS3.p1.25.m4.1.2.2.2.cmml" xref="S4.SS3.p1.25.m4.1.2.2.2">𝑇</ci><ci id="S4.SS3.p1.25.m4.1.2.2.3.cmml" xref="S4.SS3.p1.25.m4.1.2.2.3">𝑞</ci></apply><apply id="S4.SS3.p1.25.m4.1.2.3.cmml" xref="S4.SS3.p1.25.m4.1.2.3"><times id="S4.SS3.p1.25.m4.1.2.3.1.cmml" xref="S4.SS3.p1.25.m4.1.2.3.1"></times><apply id="S4.SS3.p1.25.m4.1.2.3.2.cmml" xref="S4.SS3.p1.25.m4.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.25.m4.1.2.3.2.1.cmml" xref="S4.SS3.p1.25.m4.1.2.3.2">superscript</csymbol><apply id="S4.SS3.p1.25.m4.1.2.3.2.2.cmml" xref="S4.SS3.p1.25.m4.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.25.m4.1.2.3.2.2.1.cmml" xref="S4.SS3.p1.25.m4.1.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.25.m4.1.2.3.2.2.2.cmml" xref="S4.SS3.p1.25.m4.1.2.3.2.2.2">𝑇</ci><apply id="S4.SS3.p1.25.m4.1.2.3.2.2.3.cmml" xref="S4.SS3.p1.25.m4.1.2.3.2.2.3"><times id="S4.SS3.p1.25.m4.1.2.3.2.2.3.1.cmml" xref="S4.SS3.p1.25.m4.1.2.3.2.2.3.1"></times><ci id="S4.SS3.p1.25.m4.1.2.3.2.2.3.2.cmml" xref="S4.SS3.p1.25.m4.1.2.3.2.2.3.2">𝑐</ci><ci id="S4.SS3.p1.25.m4.1.2.3.2.2.3.3.cmml" xref="S4.SS3.p1.25.m4.1.2.3.2.2.3.3">𝑎</ci><ci id="S4.SS3.p1.25.m4.1.2.3.2.2.3.4.cmml" xref="S4.SS3.p1.25.m4.1.2.3.2.2.3.4">𝑡</ci></apply></apply><ci id="S4.SS3.p1.25.m4.1.2.3.2.3.cmml" xref="S4.SS3.p1.25.m4.1.2.3.2.3">′</ci></apply><apply id="S4.SS3.p1.25.m4.1.2.3.3.1.cmml" xref="S4.SS3.p1.25.m4.1.2.3.3.2"><csymbol cd="latexml" id="S4.SS3.p1.25.m4.1.2.3.3.1.1.cmml" xref="S4.SS3.p1.25.m4.1.2.3.3.2.1">delimited-[]</csymbol><cn id="S4.SS3.p1.25.m4.1.1.cmml" type="integer" xref="S4.SS3.p1.25.m4.1.1">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.25.m4.1c">T_{q}=T_{cat}^{\prime}[0]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.25.m4.1d">italic_T start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = italic_T start_POSTSUBSCRIPT italic_c italic_a italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT [ 0 ]</annotation></semantics></math>) and image tokens (<math alttext="T_{img}^{\prime}" class="ltx_Math" display="inline" id="S4.SS3.p1.26.m5.1"><semantics id="S4.SS3.p1.26.m5.1a"><msubsup id="S4.SS3.p1.26.m5.1.1" xref="S4.SS3.p1.26.m5.1.1.cmml"><mi id="S4.SS3.p1.26.m5.1.1.2.2" xref="S4.SS3.p1.26.m5.1.1.2.2.cmml">T</mi><mrow id="S4.SS3.p1.26.m5.1.1.2.3" xref="S4.SS3.p1.26.m5.1.1.2.3.cmml"><mi id="S4.SS3.p1.26.m5.1.1.2.3.2" xref="S4.SS3.p1.26.m5.1.1.2.3.2.cmml">i</mi><mo id="S4.SS3.p1.26.m5.1.1.2.3.1" xref="S4.SS3.p1.26.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.26.m5.1.1.2.3.3" xref="S4.SS3.p1.26.m5.1.1.2.3.3.cmml">m</mi><mo id="S4.SS3.p1.26.m5.1.1.2.3.1a" xref="S4.SS3.p1.26.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.26.m5.1.1.2.3.4" xref="S4.SS3.p1.26.m5.1.1.2.3.4.cmml">g</mi></mrow><mo id="S4.SS3.p1.26.m5.1.1.3" xref="S4.SS3.p1.26.m5.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.26.m5.1b"><apply id="S4.SS3.p1.26.m5.1.1.cmml" xref="S4.SS3.p1.26.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.26.m5.1.1.1.cmml" xref="S4.SS3.p1.26.m5.1.1">superscript</csymbol><apply id="S4.SS3.p1.26.m5.1.1.2.cmml" xref="S4.SS3.p1.26.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.26.m5.1.1.2.1.cmml" xref="S4.SS3.p1.26.m5.1.1">subscript</csymbol><ci id="S4.SS3.p1.26.m5.1.1.2.2.cmml" xref="S4.SS3.p1.26.m5.1.1.2.2">𝑇</ci><apply id="S4.SS3.p1.26.m5.1.1.2.3.cmml" xref="S4.SS3.p1.26.m5.1.1.2.3"><times id="S4.SS3.p1.26.m5.1.1.2.3.1.cmml" xref="S4.SS3.p1.26.m5.1.1.2.3.1"></times><ci id="S4.SS3.p1.26.m5.1.1.2.3.2.cmml" xref="S4.SS3.p1.26.m5.1.1.2.3.2">𝑖</ci><ci id="S4.SS3.p1.26.m5.1.1.2.3.3.cmml" xref="S4.SS3.p1.26.m5.1.1.2.3.3">𝑚</ci><ci id="S4.SS3.p1.26.m5.1.1.2.3.4.cmml" xref="S4.SS3.p1.26.m5.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S4.SS3.p1.26.m5.1.1.3.cmml" xref="S4.SS3.p1.26.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.26.m5.1c">T_{img}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.26.m5.1d">italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>) to get the final image patch relation score:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P_{s}=T_{img}^{\prime}\times T_{cat}^{{}^{\prime}\text{T}}[0]" class="ltx_Math" display="block" id="S4.E10.m1.1"><semantics id="S4.E10.m1.1a"><mrow id="S4.E10.m1.1.2" xref="S4.E10.m1.1.2.cmml"><msub id="S4.E10.m1.1.2.2" xref="S4.E10.m1.1.2.2.cmml"><mi id="S4.E10.m1.1.2.2.2" xref="S4.E10.m1.1.2.2.2.cmml">P</mi><mi id="S4.E10.m1.1.2.2.3" xref="S4.E10.m1.1.2.2.3.cmml">s</mi></msub><mo id="S4.E10.m1.1.2.1" xref="S4.E10.m1.1.2.1.cmml">=</mo><mrow id="S4.E10.m1.1.2.3" xref="S4.E10.m1.1.2.3.cmml"><mrow id="S4.E10.m1.1.2.3.2" xref="S4.E10.m1.1.2.3.2.cmml"><msubsup id="S4.E10.m1.1.2.3.2.2" xref="S4.E10.m1.1.2.3.2.2.cmml"><mi id="S4.E10.m1.1.2.3.2.2.2.2" xref="S4.E10.m1.1.2.3.2.2.2.2.cmml">T</mi><mrow id="S4.E10.m1.1.2.3.2.2.2.3" xref="S4.E10.m1.1.2.3.2.2.2.3.cmml"><mi id="S4.E10.m1.1.2.3.2.2.2.3.2" xref="S4.E10.m1.1.2.3.2.2.2.3.2.cmml">i</mi><mo id="S4.E10.m1.1.2.3.2.2.2.3.1" xref="S4.E10.m1.1.2.3.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E10.m1.1.2.3.2.2.2.3.3" xref="S4.E10.m1.1.2.3.2.2.2.3.3.cmml">m</mi><mo id="S4.E10.m1.1.2.3.2.2.2.3.1a" xref="S4.E10.m1.1.2.3.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E10.m1.1.2.3.2.2.2.3.4" xref="S4.E10.m1.1.2.3.2.2.2.3.4.cmml">g</mi></mrow><mo id="S4.E10.m1.1.2.3.2.2.3" xref="S4.E10.m1.1.2.3.2.2.3.cmml">′</mo></msubsup><mo id="S4.E10.m1.1.2.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E10.m1.1.2.3.2.1.cmml">×</mo><msubsup id="S4.E10.m1.1.2.3.2.3" xref="S4.E10.m1.1.2.3.2.3.cmml"><mi id="S4.E10.m1.1.2.3.2.3.2.2" xref="S4.E10.m1.1.2.3.2.3.2.2.cmml">T</mi><mrow id="S4.E10.m1.1.2.3.2.3.2.3" xref="S4.E10.m1.1.2.3.2.3.2.3.cmml"><mi id="S4.E10.m1.1.2.3.2.3.2.3.2" xref="S4.E10.m1.1.2.3.2.3.2.3.2.cmml">c</mi><mo id="S4.E10.m1.1.2.3.2.3.2.3.1" xref="S4.E10.m1.1.2.3.2.3.2.3.1.cmml">⁢</mo><mi id="S4.E10.m1.1.2.3.2.3.2.3.3" xref="S4.E10.m1.1.2.3.2.3.2.3.3.cmml">a</mi><mo id="S4.E10.m1.1.2.3.2.3.2.3.1a" xref="S4.E10.m1.1.2.3.2.3.2.3.1.cmml">⁢</mo><mi id="S4.E10.m1.1.2.3.2.3.2.3.4" xref="S4.E10.m1.1.2.3.2.3.2.3.4.cmml">t</mi></mrow><mmultiscripts id="S4.E10.m1.1.2.3.2.3.3" xref="S4.E10.m1.1.2.3.2.3.3.cmml"><mtext id="S4.E10.m1.1.2.3.2.3.3.2" xref="S4.E10.m1.1.2.3.2.3.3.2a.cmml">T</mtext><mprescripts id="S4.E10.m1.1.2.3.2.3.3a" xref="S4.E10.m1.1.2.3.2.3.3.cmml"></mprescripts><mrow id="S4.E10.m1.1.2.3.2.3.3b" xref="S4.E10.m1.1.2.3.2.3.3.cmml"></mrow><mo id="S4.E10.m1.1.2.3.2.3.3.3" xref="S4.E10.m1.1.2.3.2.3.3.3.cmml">′</mo></mmultiscripts></msubsup></mrow><mo id="S4.E10.m1.1.2.3.1" xref="S4.E10.m1.1.2.3.1.cmml">⁢</mo><mrow id="S4.E10.m1.1.2.3.3.2" xref="S4.E10.m1.1.2.3.3.1.cmml"><mo id="S4.E10.m1.1.2.3.3.2.1" stretchy="false" xref="S4.E10.m1.1.2.3.3.1.1.cmml">[</mo><mn id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml">0</mn><mo id="S4.E10.m1.1.2.3.3.2.2" stretchy="false" xref="S4.E10.m1.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.1b"><apply id="S4.E10.m1.1.2.cmml" xref="S4.E10.m1.1.2"><eq id="S4.E10.m1.1.2.1.cmml" xref="S4.E10.m1.1.2.1"></eq><apply id="S4.E10.m1.1.2.2.cmml" xref="S4.E10.m1.1.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.2.2.1.cmml" xref="S4.E10.m1.1.2.2">subscript</csymbol><ci id="S4.E10.m1.1.2.2.2.cmml" xref="S4.E10.m1.1.2.2.2">𝑃</ci><ci id="S4.E10.m1.1.2.2.3.cmml" xref="S4.E10.m1.1.2.2.3">𝑠</ci></apply><apply id="S4.E10.m1.1.2.3.cmml" xref="S4.E10.m1.1.2.3"><times id="S4.E10.m1.1.2.3.1.cmml" xref="S4.E10.m1.1.2.3.1"></times><apply id="S4.E10.m1.1.2.3.2.cmml" xref="S4.E10.m1.1.2.3.2"><times id="S4.E10.m1.1.2.3.2.1.cmml" xref="S4.E10.m1.1.2.3.2.1"></times><apply id="S4.E10.m1.1.2.3.2.2.cmml" xref="S4.E10.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.2.3.2.2.1.cmml" xref="S4.E10.m1.1.2.3.2.2">superscript</csymbol><apply id="S4.E10.m1.1.2.3.2.2.2.cmml" xref="S4.E10.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.2.3.2.2.2.1.cmml" xref="S4.E10.m1.1.2.3.2.2">subscript</csymbol><ci id="S4.E10.m1.1.2.3.2.2.2.2.cmml" xref="S4.E10.m1.1.2.3.2.2.2.2">𝑇</ci><apply id="S4.E10.m1.1.2.3.2.2.2.3.cmml" xref="S4.E10.m1.1.2.3.2.2.2.3"><times id="S4.E10.m1.1.2.3.2.2.2.3.1.cmml" xref="S4.E10.m1.1.2.3.2.2.2.3.1"></times><ci id="S4.E10.m1.1.2.3.2.2.2.3.2.cmml" xref="S4.E10.m1.1.2.3.2.2.2.3.2">𝑖</ci><ci id="S4.E10.m1.1.2.3.2.2.2.3.3.cmml" xref="S4.E10.m1.1.2.3.2.2.2.3.3">𝑚</ci><ci id="S4.E10.m1.1.2.3.2.2.2.3.4.cmml" xref="S4.E10.m1.1.2.3.2.2.2.3.4">𝑔</ci></apply></apply><ci id="S4.E10.m1.1.2.3.2.2.3.cmml" xref="S4.E10.m1.1.2.3.2.2.3">′</ci></apply><apply id="S4.E10.m1.1.2.3.2.3.cmml" xref="S4.E10.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.2.3.2.3.1.cmml" xref="S4.E10.m1.1.2.3.2.3">superscript</csymbol><apply id="S4.E10.m1.1.2.3.2.3.2.cmml" xref="S4.E10.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.2.3.2.3.2.1.cmml" xref="S4.E10.m1.1.2.3.2.3">subscript</csymbol><ci id="S4.E10.m1.1.2.3.2.3.2.2.cmml" xref="S4.E10.m1.1.2.3.2.3.2.2">𝑇</ci><apply id="S4.E10.m1.1.2.3.2.3.2.3.cmml" xref="S4.E10.m1.1.2.3.2.3.2.3"><times id="S4.E10.m1.1.2.3.2.3.2.3.1.cmml" xref="S4.E10.m1.1.2.3.2.3.2.3.1"></times><ci id="S4.E10.m1.1.2.3.2.3.2.3.2.cmml" xref="S4.E10.m1.1.2.3.2.3.2.3.2">𝑐</ci><ci id="S4.E10.m1.1.2.3.2.3.2.3.3.cmml" xref="S4.E10.m1.1.2.3.2.3.2.3.3">𝑎</ci><ci id="S4.E10.m1.1.2.3.2.3.2.3.4.cmml" xref="S4.E10.m1.1.2.3.2.3.2.3.4">𝑡</ci></apply></apply><apply id="S4.E10.m1.1.2.3.2.3.3.cmml" xref="S4.E10.m1.1.2.3.2.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.2.3.2.3.3.1.cmml" xref="S4.E10.m1.1.2.3.2.3.3">superscript</csymbol><ci id="S4.E10.m1.1.2.3.2.3.3.2a.cmml" xref="S4.E10.m1.1.2.3.2.3.3.2"><mtext id="S4.E10.m1.1.2.3.2.3.3.2.cmml" mathsize="70%" xref="S4.E10.m1.1.2.3.2.3.3.2">T</mtext></ci><ci id="S4.E10.m1.1.2.3.2.3.3.3.cmml" xref="S4.E10.m1.1.2.3.2.3.3.3">′</ci></apply></apply></apply><apply id="S4.E10.m1.1.2.3.3.1.cmml" xref="S4.E10.m1.1.2.3.3.2"><csymbol cd="latexml" id="S4.E10.m1.1.2.3.3.1.1.cmml" xref="S4.E10.m1.1.2.3.3.2.1">delimited-[]</csymbol><cn id="S4.E10.m1.1.1.cmml" type="integer" xref="S4.E10.m1.1.1">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.1c">P_{s}=T_{img}^{\prime}\times T_{cat}^{{}^{\prime}\text{T}}[0]</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.1d">italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = italic_T start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT × italic_T start_POSTSUBSCRIPT italic_c italic_a italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT T end_POSTSUPERSCRIPT [ 0 ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p1.28">Suppose the pruning rate is <math alttext="r_{m}" class="ltx_Math" display="inline" id="S4.SS3.p1.27.m1.1"><semantics id="S4.SS3.p1.27.m1.1a"><msub id="S4.SS3.p1.27.m1.1.1" xref="S4.SS3.p1.27.m1.1.1.cmml"><mi id="S4.SS3.p1.27.m1.1.1.2" xref="S4.SS3.p1.27.m1.1.1.2.cmml">r</mi><mi id="S4.SS3.p1.27.m1.1.1.3" xref="S4.SS3.p1.27.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.27.m1.1b"><apply id="S4.SS3.p1.27.m1.1.1.cmml" xref="S4.SS3.p1.27.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.27.m1.1.1.1.cmml" xref="S4.SS3.p1.27.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.27.m1.1.1.2.cmml" xref="S4.SS3.p1.27.m1.1.1.2">𝑟</ci><ci id="S4.SS3.p1.27.m1.1.1.3.cmml" xref="S4.SS3.p1.27.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.27.m1.1c">r_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.27.m1.1d">italic_r start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, we get the pruning mask <math alttext="P_{mask}" class="ltx_Math" display="inline" id="S4.SS3.p1.28.m2.1"><semantics id="S4.SS3.p1.28.m2.1a"><msub id="S4.SS3.p1.28.m2.1.1" xref="S4.SS3.p1.28.m2.1.1.cmml"><mi id="S4.SS3.p1.28.m2.1.1.2" xref="S4.SS3.p1.28.m2.1.1.2.cmml">P</mi><mrow id="S4.SS3.p1.28.m2.1.1.3" xref="S4.SS3.p1.28.m2.1.1.3.cmml"><mi id="S4.SS3.p1.28.m2.1.1.3.2" xref="S4.SS3.p1.28.m2.1.1.3.2.cmml">m</mi><mo id="S4.SS3.p1.28.m2.1.1.3.1" xref="S4.SS3.p1.28.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.28.m2.1.1.3.3" xref="S4.SS3.p1.28.m2.1.1.3.3.cmml">a</mi><mo id="S4.SS3.p1.28.m2.1.1.3.1a" xref="S4.SS3.p1.28.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.28.m2.1.1.3.4" xref="S4.SS3.p1.28.m2.1.1.3.4.cmml">s</mi><mo id="S4.SS3.p1.28.m2.1.1.3.1b" xref="S4.SS3.p1.28.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.28.m2.1.1.3.5" xref="S4.SS3.p1.28.m2.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.28.m2.1b"><apply id="S4.SS3.p1.28.m2.1.1.cmml" xref="S4.SS3.p1.28.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.28.m2.1.1.1.cmml" xref="S4.SS3.p1.28.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.28.m2.1.1.2.cmml" xref="S4.SS3.p1.28.m2.1.1.2">𝑃</ci><apply id="S4.SS3.p1.28.m2.1.1.3.cmml" xref="S4.SS3.p1.28.m2.1.1.3"><times id="S4.SS3.p1.28.m2.1.1.3.1.cmml" xref="S4.SS3.p1.28.m2.1.1.3.1"></times><ci id="S4.SS3.p1.28.m2.1.1.3.2.cmml" xref="S4.SS3.p1.28.m2.1.1.3.2">𝑚</ci><ci id="S4.SS3.p1.28.m2.1.1.3.3.cmml" xref="S4.SS3.p1.28.m2.1.1.3.3">𝑎</ci><ci id="S4.SS3.p1.28.m2.1.1.3.4.cmml" xref="S4.SS3.p1.28.m2.1.1.3.4">𝑠</ci><ci id="S4.SS3.p1.28.m2.1.1.3.5.cmml" xref="S4.SS3.p1.28.m2.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.28.m2.1c">P_{mask}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.28.m2.1d">italic_P start_POSTSUBSCRIPT italic_m italic_a italic_s italic_k end_POSTSUBSCRIPT</annotation></semantics></math> based on each image patch tokens’ score</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P_{mask}[i]=\begin{cases}1&amp;\text{if }P_{s}[i]\geq\text{Top}_{r_{m}(P_{s})}\\
0&amp;\text{otherwise}\end{cases}" class="ltx_Math" display="block" id="S4.E11.m1.5"><semantics id="S4.E11.m1.5a"><mrow id="S4.E11.m1.5.6" xref="S4.E11.m1.5.6.cmml"><mrow id="S4.E11.m1.5.6.2" xref="S4.E11.m1.5.6.2.cmml"><msub id="S4.E11.m1.5.6.2.2" xref="S4.E11.m1.5.6.2.2.cmml"><mi id="S4.E11.m1.5.6.2.2.2" xref="S4.E11.m1.5.6.2.2.2.cmml">P</mi><mrow id="S4.E11.m1.5.6.2.2.3" xref="S4.E11.m1.5.6.2.2.3.cmml"><mi id="S4.E11.m1.5.6.2.2.3.2" xref="S4.E11.m1.5.6.2.2.3.2.cmml">m</mi><mo id="S4.E11.m1.5.6.2.2.3.1" xref="S4.E11.m1.5.6.2.2.3.1.cmml">⁢</mo><mi id="S4.E11.m1.5.6.2.2.3.3" xref="S4.E11.m1.5.6.2.2.3.3.cmml">a</mi><mo id="S4.E11.m1.5.6.2.2.3.1a" xref="S4.E11.m1.5.6.2.2.3.1.cmml">⁢</mo><mi id="S4.E11.m1.5.6.2.2.3.4" xref="S4.E11.m1.5.6.2.2.3.4.cmml">s</mi><mo id="S4.E11.m1.5.6.2.2.3.1b" xref="S4.E11.m1.5.6.2.2.3.1.cmml">⁢</mo><mi id="S4.E11.m1.5.6.2.2.3.5" xref="S4.E11.m1.5.6.2.2.3.5.cmml">k</mi></mrow></msub><mo id="S4.E11.m1.5.6.2.1" xref="S4.E11.m1.5.6.2.1.cmml">⁢</mo><mrow id="S4.E11.m1.5.6.2.3.2" xref="S4.E11.m1.5.6.2.3.1.cmml"><mo id="S4.E11.m1.5.6.2.3.2.1" stretchy="false" xref="S4.E11.m1.5.6.2.3.1.1.cmml">[</mo><mi id="S4.E11.m1.5.5" xref="S4.E11.m1.5.5.cmml">i</mi><mo id="S4.E11.m1.5.6.2.3.2.2" stretchy="false" xref="S4.E11.m1.5.6.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E11.m1.5.6.1" xref="S4.E11.m1.5.6.1.cmml">=</mo><mrow id="S4.E11.m1.4.4" xref="S4.E11.m1.5.6.3.1.cmml"><mo id="S4.E11.m1.4.4.5" xref="S4.E11.m1.5.6.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E11.m1.4.4.4" rowspacing="0pt" xref="S4.E11.m1.5.6.3.1.cmml"><mtr id="S4.E11.m1.4.4.4a" xref="S4.E11.m1.5.6.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E11.m1.4.4.4b" xref="S4.E11.m1.5.6.3.1.cmml"><mn id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E11.m1.4.4.4c" xref="S4.E11.m1.5.6.3.1.cmml"><mrow id="S4.E11.m1.2.2.2.2.2.1" xref="S4.E11.m1.2.2.2.2.2.1.cmml"><mrow id="S4.E11.m1.2.2.2.2.2.1.4" xref="S4.E11.m1.2.2.2.2.2.1.4.cmml"><mtext id="S4.E11.m1.2.2.2.2.2.1.4.2" xref="S4.E11.m1.2.2.2.2.2.1.4.2a.cmml">if </mtext><mo id="S4.E11.m1.2.2.2.2.2.1.4.1" xref="S4.E11.m1.2.2.2.2.2.1.4.1.cmml">⁢</mo><msub id="S4.E11.m1.2.2.2.2.2.1.4.3" xref="S4.E11.m1.2.2.2.2.2.1.4.3.cmml"><mi id="S4.E11.m1.2.2.2.2.2.1.4.3.2" xref="S4.E11.m1.2.2.2.2.2.1.4.3.2.cmml">P</mi><mi id="S4.E11.m1.2.2.2.2.2.1.4.3.3" xref="S4.E11.m1.2.2.2.2.2.1.4.3.3.cmml">s</mi></msub><mo id="S4.E11.m1.2.2.2.2.2.1.4.1a" xref="S4.E11.m1.2.2.2.2.2.1.4.1.cmml">⁢</mo><mrow id="S4.E11.m1.2.2.2.2.2.1.4.4.2" xref="S4.E11.m1.2.2.2.2.2.1.4.4.1.cmml"><mo id="S4.E11.m1.2.2.2.2.2.1.4.4.2.1" stretchy="false" xref="S4.E11.m1.2.2.2.2.2.1.4.4.1.1.cmml">[</mo><mi id="S4.E11.m1.2.2.2.2.2.1.2" xref="S4.E11.m1.2.2.2.2.2.1.2.cmml">i</mi><mo id="S4.E11.m1.2.2.2.2.2.1.4.4.2.2" stretchy="false" xref="S4.E11.m1.2.2.2.2.2.1.4.4.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E11.m1.2.2.2.2.2.1.3" xref="S4.E11.m1.2.2.2.2.2.1.3.cmml">≥</mo><msub id="S4.E11.m1.2.2.2.2.2.1.5" xref="S4.E11.m1.2.2.2.2.2.1.5.cmml"><mtext id="S4.E11.m1.2.2.2.2.2.1.5.2" xref="S4.E11.m1.2.2.2.2.2.1.5.2a.cmml">Top</mtext><mrow id="S4.E11.m1.2.2.2.2.2.1.1.1" xref="S4.E11.m1.2.2.2.2.2.1.1.1.cmml"><msub id="S4.E11.m1.2.2.2.2.2.1.1.1.3" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E11.m1.2.2.2.2.2.1.1.1.3.2" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3.2.cmml">r</mi><mi id="S4.E11.m1.2.2.2.2.2.1.1.1.3.3" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3.3.cmml">m</mi></msub><mo id="S4.E11.m1.2.2.2.2.2.1.1.1.2" xref="S4.E11.m1.2.2.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.2.2.2.2.2.1.1.1.1.1" xref="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1" xref="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.2" xref="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.2.cmml">P</mi><mi id="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.3" xref="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow></mtd></mtr><mtr id="S4.E11.m1.4.4.4d" xref="S4.E11.m1.5.6.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E11.m1.4.4.4e" xref="S4.E11.m1.5.6.3.1.cmml"><mn id="S4.E11.m1.3.3.3.3.1.1" xref="S4.E11.m1.3.3.3.3.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E11.m1.4.4.4f" xref="S4.E11.m1.5.6.3.1.cmml"><mtext id="S4.E11.m1.4.4.4.4.2.1" xref="S4.E11.m1.4.4.4.4.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.5b"><apply id="S4.E11.m1.5.6.cmml" xref="S4.E11.m1.5.6"><eq id="S4.E11.m1.5.6.1.cmml" xref="S4.E11.m1.5.6.1"></eq><apply id="S4.E11.m1.5.6.2.cmml" xref="S4.E11.m1.5.6.2"><times id="S4.E11.m1.5.6.2.1.cmml" xref="S4.E11.m1.5.6.2.1"></times><apply id="S4.E11.m1.5.6.2.2.cmml" xref="S4.E11.m1.5.6.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.6.2.2.1.cmml" xref="S4.E11.m1.5.6.2.2">subscript</csymbol><ci id="S4.E11.m1.5.6.2.2.2.cmml" xref="S4.E11.m1.5.6.2.2.2">𝑃</ci><apply id="S4.E11.m1.5.6.2.2.3.cmml" xref="S4.E11.m1.5.6.2.2.3"><times id="S4.E11.m1.5.6.2.2.3.1.cmml" xref="S4.E11.m1.5.6.2.2.3.1"></times><ci id="S4.E11.m1.5.6.2.2.3.2.cmml" xref="S4.E11.m1.5.6.2.2.3.2">𝑚</ci><ci id="S4.E11.m1.5.6.2.2.3.3.cmml" xref="S4.E11.m1.5.6.2.2.3.3">𝑎</ci><ci id="S4.E11.m1.5.6.2.2.3.4.cmml" xref="S4.E11.m1.5.6.2.2.3.4">𝑠</ci><ci id="S4.E11.m1.5.6.2.2.3.5.cmml" xref="S4.E11.m1.5.6.2.2.3.5">𝑘</ci></apply></apply><apply id="S4.E11.m1.5.6.2.3.1.cmml" xref="S4.E11.m1.5.6.2.3.2"><csymbol cd="latexml" id="S4.E11.m1.5.6.2.3.1.1.cmml" xref="S4.E11.m1.5.6.2.3.2.1">delimited-[]</csymbol><ci id="S4.E11.m1.5.5.cmml" xref="S4.E11.m1.5.5">𝑖</ci></apply></apply><apply id="S4.E11.m1.5.6.3.1.cmml" xref="S4.E11.m1.4.4"><csymbol cd="latexml" id="S4.E11.m1.5.6.3.1.1.cmml" xref="S4.E11.m1.4.4.5">cases</csymbol><cn id="S4.E11.m1.1.1.1.1.1.1.cmml" type="integer" xref="S4.E11.m1.1.1.1.1.1.1">1</cn><apply id="S4.E11.m1.2.2.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1"><geq id="S4.E11.m1.2.2.2.2.2.1.3.cmml" xref="S4.E11.m1.2.2.2.2.2.1.3"></geq><apply id="S4.E11.m1.2.2.2.2.2.1.4.cmml" xref="S4.E11.m1.2.2.2.2.2.1.4"><times id="S4.E11.m1.2.2.2.2.2.1.4.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.4.1"></times><ci id="S4.E11.m1.2.2.2.2.2.1.4.2a.cmml" xref="S4.E11.m1.2.2.2.2.2.1.4.2"><mtext id="S4.E11.m1.2.2.2.2.2.1.4.2.cmml" xref="S4.E11.m1.2.2.2.2.2.1.4.2">if </mtext></ci><apply id="S4.E11.m1.2.2.2.2.2.1.4.3.cmml" xref="S4.E11.m1.2.2.2.2.2.1.4.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.2.1.4.3.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.4.3">subscript</csymbol><ci id="S4.E11.m1.2.2.2.2.2.1.4.3.2.cmml" xref="S4.E11.m1.2.2.2.2.2.1.4.3.2">𝑃</ci><ci id="S4.E11.m1.2.2.2.2.2.1.4.3.3.cmml" xref="S4.E11.m1.2.2.2.2.2.1.4.3.3">𝑠</ci></apply><apply id="S4.E11.m1.2.2.2.2.2.1.4.4.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.4.4.2"><csymbol cd="latexml" id="S4.E11.m1.2.2.2.2.2.1.4.4.1.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.4.4.2.1">delimited-[]</csymbol><ci id="S4.E11.m1.2.2.2.2.2.1.2.cmml" xref="S4.E11.m1.2.2.2.2.2.1.2">𝑖</ci></apply></apply><apply id="S4.E11.m1.2.2.2.2.2.1.5.cmml" xref="S4.E11.m1.2.2.2.2.2.1.5"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.2.1.5.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.5">subscript</csymbol><ci id="S4.E11.m1.2.2.2.2.2.1.5.2a.cmml" xref="S4.E11.m1.2.2.2.2.2.1.5.2"><mtext id="S4.E11.m1.2.2.2.2.2.1.5.2.cmml" xref="S4.E11.m1.2.2.2.2.2.1.5.2">Top</mtext></ci><apply id="S4.E11.m1.2.2.2.2.2.1.1.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1"><times id="S4.E11.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.2"></times><apply id="S4.E11.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3.2">𝑟</ci><ci id="S4.E11.m1.2.2.2.2.2.1.1.1.3.3.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.3.3">𝑚</ci></apply><apply id="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.2">𝑃</ci><ci id="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.2.2.2.2.2.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply><cn id="S4.E11.m1.3.3.3.3.1.1.cmml" type="integer" xref="S4.E11.m1.3.3.3.3.1.1">0</cn><ci id="S4.E11.m1.4.4.4.4.2.1a.cmml" xref="S4.E11.m1.4.4.4.4.2.1"><mtext id="S4.E11.m1.4.4.4.4.2.1.cmml" xref="S4.E11.m1.4.4.4.4.2.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.5c">P_{mask}[i]=\begin{cases}1&amp;\text{if }P_{s}[i]\geq\text{Top}_{r_{m}(P_{s})}\\
0&amp;\text{otherwise}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.5d">italic_P start_POSTSUBSCRIPT italic_m italic_a italic_s italic_k end_POSTSUBSCRIPT [ italic_i ] = { start_ROW start_CELL 1 end_CELL start_CELL if italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT [ italic_i ] ≥ Top start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ( italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL otherwise end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p1.33">Here we use the Top<math alttext="{}_{r_{m}(P_{s})}" class="ltx_Math" display="inline" id="S4.SS3.p1.29.m1.1"><semantics id="S4.SS3.p1.29.m1.1a"><msub id="S4.SS3.p1.29.m1.1.1" xref="S4.SS3.p1.29.m1.1.1.cmml"><mi id="S4.SS3.p1.29.m1.1.1a" xref="S4.SS3.p1.29.m1.1.1.cmml"></mi><mrow id="S4.SS3.p1.29.m1.1.1.1" xref="S4.SS3.p1.29.m1.1.1.1.cmml"><msub id="S4.SS3.p1.29.m1.1.1.1.3" xref="S4.SS3.p1.29.m1.1.1.1.3.cmml"><mi id="S4.SS3.p1.29.m1.1.1.1.3.2" xref="S4.SS3.p1.29.m1.1.1.1.3.2.cmml">r</mi><mi id="S4.SS3.p1.29.m1.1.1.1.3.3" xref="S4.SS3.p1.29.m1.1.1.1.3.3.cmml">m</mi></msub><mo id="S4.SS3.p1.29.m1.1.1.1.2" xref="S4.SS3.p1.29.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p1.29.m1.1.1.1.1.1" xref="S4.SS3.p1.29.m1.1.1.1.1.1.1.cmml"><mo id="S4.SS3.p1.29.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.29.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS3.p1.29.m1.1.1.1.1.1.1" xref="S4.SS3.p1.29.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.29.m1.1.1.1.1.1.1.2" xref="S4.SS3.p1.29.m1.1.1.1.1.1.1.2.cmml">P</mi><mi id="S4.SS3.p1.29.m1.1.1.1.1.1.1.3" xref="S4.SS3.p1.29.m1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S4.SS3.p1.29.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p1.29.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.29.m1.1b"><apply id="S4.SS3.p1.29.m1.1.1.cmml" xref="S4.SS3.p1.29.m1.1.1"><apply id="S4.SS3.p1.29.m1.1.1.1.cmml" xref="S4.SS3.p1.29.m1.1.1.1"><times id="S4.SS3.p1.29.m1.1.1.1.2.cmml" xref="S4.SS3.p1.29.m1.1.1.1.2"></times><apply id="S4.SS3.p1.29.m1.1.1.1.3.cmml" xref="S4.SS3.p1.29.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.29.m1.1.1.1.3.1.cmml" xref="S4.SS3.p1.29.m1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.29.m1.1.1.1.3.2.cmml" xref="S4.SS3.p1.29.m1.1.1.1.3.2">𝑟</ci><ci id="S4.SS3.p1.29.m1.1.1.1.3.3.cmml" xref="S4.SS3.p1.29.m1.1.1.1.3.3">𝑚</ci></apply><apply id="S4.SS3.p1.29.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.29.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.29.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.29.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.29.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.29.m1.1.1.1.1.1.1.2">𝑃</ci><ci id="S4.SS3.p1.29.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.29.m1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.29.m1.1c">{}_{r_{m}(P_{s})}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.29.m1.1d">start_FLOATSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ( italic_P start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) end_FLOATSUBSCRIPT</annotation></semantics></math> as the threshold value, which is the <math alttext="(r_{m}\times N)^{\text{th}}" class="ltx_Math" display="inline" id="S4.SS3.p1.30.m2.1"><semantics id="S4.SS3.p1.30.m2.1a"><msup id="S4.SS3.p1.30.m2.1.1" xref="S4.SS3.p1.30.m2.1.1.cmml"><mrow id="S4.SS3.p1.30.m2.1.1.1.1" xref="S4.SS3.p1.30.m2.1.1.1.1.1.cmml"><mo id="S4.SS3.p1.30.m2.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.30.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.30.m2.1.1.1.1.1" xref="S4.SS3.p1.30.m2.1.1.1.1.1.cmml"><msub id="S4.SS3.p1.30.m2.1.1.1.1.1.2" xref="S4.SS3.p1.30.m2.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p1.30.m2.1.1.1.1.1.2.2" xref="S4.SS3.p1.30.m2.1.1.1.1.1.2.2.cmml">r</mi><mi id="S4.SS3.p1.30.m2.1.1.1.1.1.2.3" xref="S4.SS3.p1.30.m2.1.1.1.1.1.2.3.cmml">m</mi></msub><mo id="S4.SS3.p1.30.m2.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.30.m2.1.1.1.1.1.1.cmml">×</mo><mi id="S4.SS3.p1.30.m2.1.1.1.1.1.3" xref="S4.SS3.p1.30.m2.1.1.1.1.1.3.cmml">N</mi></mrow><mo id="S4.SS3.p1.30.m2.1.1.1.1.3" stretchy="false" xref="S4.SS3.p1.30.m2.1.1.1.1.1.cmml">)</mo></mrow><mtext id="S4.SS3.p1.30.m2.1.1.3" xref="S4.SS3.p1.30.m2.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.30.m2.1b"><apply id="S4.SS3.p1.30.m2.1.1.cmml" xref="S4.SS3.p1.30.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.30.m2.1.1.2.cmml" xref="S4.SS3.p1.30.m2.1.1">superscript</csymbol><apply id="S4.SS3.p1.30.m2.1.1.1.1.1.cmml" xref="S4.SS3.p1.30.m2.1.1.1.1"><times id="S4.SS3.p1.30.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.30.m2.1.1.1.1.1.1"></times><apply id="S4.SS3.p1.30.m2.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.30.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.30.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.30.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.30.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.30.m2.1.1.1.1.1.2.2">𝑟</ci><ci id="S4.SS3.p1.30.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.30.m2.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="S4.SS3.p1.30.m2.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.30.m2.1.1.1.1.1.3">𝑁</ci></apply><ci id="S4.SS3.p1.30.m2.1.1.3a.cmml" xref="S4.SS3.p1.30.m2.1.1.3"><mtext id="S4.SS3.p1.30.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS3.p1.30.m2.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.30.m2.1c">(r_{m}\times N)^{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.30.m2.1d">( italic_r start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT × italic_N ) start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT</annotation></semantics></math> highest score in <math alttext="P" class="ltx_Math" display="inline" id="S4.SS3.p1.31.m3.1"><semantics id="S4.SS3.p1.31.m3.1a"><mi id="S4.SS3.p1.31.m3.1.1" xref="S4.SS3.p1.31.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.31.m3.1b"><ci id="S4.SS3.p1.31.m3.1.1.cmml" xref="S4.SS3.p1.31.m3.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.31.m3.1c">P</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.31.m3.1d">italic_P</annotation></semantics></math>. As a result, roughly <math alttext="(1-r_{m})\times N" class="ltx_Math" display="inline" id="S4.SS3.p1.32.m4.1"><semantics id="S4.SS3.p1.32.m4.1a"><mrow id="S4.SS3.p1.32.m4.1.1" xref="S4.SS3.p1.32.m4.1.1.cmml"><mrow id="S4.SS3.p1.32.m4.1.1.1.1" xref="S4.SS3.p1.32.m4.1.1.1.1.1.cmml"><mo id="S4.SS3.p1.32.m4.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.32.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.32.m4.1.1.1.1.1" xref="S4.SS3.p1.32.m4.1.1.1.1.1.cmml"><mn id="S4.SS3.p1.32.m4.1.1.1.1.1.2" xref="S4.SS3.p1.32.m4.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS3.p1.32.m4.1.1.1.1.1.1" xref="S4.SS3.p1.32.m4.1.1.1.1.1.1.cmml">−</mo><msub id="S4.SS3.p1.32.m4.1.1.1.1.1.3" xref="S4.SS3.p1.32.m4.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p1.32.m4.1.1.1.1.1.3.2" xref="S4.SS3.p1.32.m4.1.1.1.1.1.3.2.cmml">r</mi><mi id="S4.SS3.p1.32.m4.1.1.1.1.1.3.3" xref="S4.SS3.p1.32.m4.1.1.1.1.1.3.3.cmml">m</mi></msub></mrow><mo id="S4.SS3.p1.32.m4.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.SS3.p1.32.m4.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS3.p1.32.m4.1.1.2" rspace="0.222em" xref="S4.SS3.p1.32.m4.1.1.2.cmml">×</mo><mi id="S4.SS3.p1.32.m4.1.1.3" xref="S4.SS3.p1.32.m4.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.32.m4.1b"><apply id="S4.SS3.p1.32.m4.1.1.cmml" xref="S4.SS3.p1.32.m4.1.1"><times id="S4.SS3.p1.32.m4.1.1.2.cmml" xref="S4.SS3.p1.32.m4.1.1.2"></times><apply id="S4.SS3.p1.32.m4.1.1.1.1.1.cmml" xref="S4.SS3.p1.32.m4.1.1.1.1"><minus id="S4.SS3.p1.32.m4.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.32.m4.1.1.1.1.1.1"></minus><cn id="S4.SS3.p1.32.m4.1.1.1.1.1.2.cmml" type="integer" xref="S4.SS3.p1.32.m4.1.1.1.1.1.2">1</cn><apply id="S4.SS3.p1.32.m4.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.32.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.32.m4.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p1.32.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.32.m4.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p1.32.m4.1.1.1.1.1.3.2">𝑟</ci><ci id="S4.SS3.p1.32.m4.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p1.32.m4.1.1.1.1.1.3.3">𝑚</ci></apply></apply><ci id="S4.SS3.p1.32.m4.1.1.3.cmml" xref="S4.SS3.p1.32.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.32.m4.1c">(1-r_{m})\times N</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.32.m4.1d">( 1 - italic_r start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) × italic_N</annotation></semantics></math> of the image tokens will be retained. During the training stage, we use the Sigmoid function <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib10" title="">10</a>]</cite> to smooth out <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4.E11" title="In 4.3 Prune Decoder Design and Training ‣ 4 Vision-Language Guided Patch Pruning ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">11</span></a>.
To train the prune decoder, we freeze both MLLM and ViT and only train the prune decoder and mask decoder with the training loss <math alttext="L" class="ltx_Math" display="inline" id="S4.SS3.p1.33.m5.1"><semantics id="S4.SS3.p1.33.m5.1a"><mi id="S4.SS3.p1.33.m5.1.1" xref="S4.SS3.p1.33.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.33.m5.1b"><ci id="S4.SS3.p1.33.m5.1.1.cmml" xref="S4.SS3.p1.33.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.33.m5.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.33.m5.1d">italic_L</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}L=&amp;\,\underbrace{CE(X_{res},X_{gt})+DICE(X_{res},X_{gt})}_{L_{X}}%
\\
&amp;+\underbrace{CE(P_{mask},P_{gt})+DICE(P_{mask},P_{gt})}_{L_{P}}\end{split}" class="ltx_Math" display="block" id="S4.E12.m1.7"><semantics id="S4.E12.m1.7a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E12.m1.7.7" rowspacing="0pt" xref="S4.E12.m1.7.8.1.cmml"><mtr id="S4.E12.m1.7.7a" xref="S4.E12.m1.7.8.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S4.E12.m1.7.7b" xref="S4.E12.m1.7.8.1.cmml"><mrow id="S4.E12.m1.2.2.2.2.2" xref="S4.E12.m1.7.8.1.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.cmml">L</mi><mo id="S4.E12.m1.2.2.2.2.2.2" xref="S4.E12.m1.2.2.2.2.2.2.cmml">=</mo><mi id="S4.E12.m1.2.2.2.2.2.3" xref="S4.E12.m1.7.8.1.cmml"></mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m1.7.7c" xref="S4.E12.m1.7.8.1.cmml"><munder id="S4.E12.m1.4.4.4.4.2" xref="S4.E12.m1.7.8.1.cmml"><munder accentunder="true" id="S4.E12.m1.3.3.3.3.1.1" xref="S4.E12.m1.3.3.3.3.1.1.cmml"><mrow id="S4.E12.m1.3.3.3.3.1.1.4" xref="S4.E12.m1.3.3.3.3.1.1.4.cmml"><mrow id="S4.E12.m1.3.3.3.3.1.1.2.2" xref="S4.E12.m1.3.3.3.3.1.1.2.2.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.4" xref="S4.E12.m1.3.3.3.3.1.1.2.2.4.cmml">C</mi><mo id="S4.E12.m1.3.3.3.3.1.1.2.2.3" xref="S4.E12.m1.3.3.3.3.1.1.2.2.3.cmml">⁢</mo><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.5" xref="S4.E12.m1.3.3.3.3.1.1.2.2.5.cmml">E</mi><mo id="S4.E12.m1.3.3.3.3.1.1.2.2.3a" xref="S4.E12.m1.3.3.3.3.1.1.2.2.3.cmml">⁢</mo><mrow id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.3.cmml"><mo id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.3" stretchy="false" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.3.cmml">(</mo><msub id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml">X</mi><mrow id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.2" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.2.cmml">r</mi><mo id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.3" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.3.cmml">e</mi><mo id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1a" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.4" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.4.cmml">s</mi></mrow></msub><mo id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.4" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.3.cmml">,</mo><msub id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.2" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.2.cmml">X</mi><mrow id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.2" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.2.cmml">g</mi><mo id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.1" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.3" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.3.cmml">t</mi></mrow></msub><mo id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.5" stretchy="false" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.3.3.3.3.1.1.4.5" xref="S4.E12.m1.3.3.3.3.1.1.4.5.cmml">+</mo><mrow id="S4.E12.m1.3.3.3.3.1.1.4.4" xref="S4.E12.m1.3.3.3.3.1.1.4.4.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.4.4.4" xref="S4.E12.m1.3.3.3.3.1.1.4.4.4.cmml">D</mi><mo id="S4.E12.m1.3.3.3.3.1.1.4.4.3" xref="S4.E12.m1.3.3.3.3.1.1.4.4.3.cmml">⁢</mo><mi id="S4.E12.m1.3.3.3.3.1.1.4.4.5" xref="S4.E12.m1.3.3.3.3.1.1.4.4.5.cmml">I</mi><mo id="S4.E12.m1.3.3.3.3.1.1.4.4.3a" xref="S4.E12.m1.3.3.3.3.1.1.4.4.3.cmml">⁢</mo><mi id="S4.E12.m1.3.3.3.3.1.1.4.4.6" xref="S4.E12.m1.3.3.3.3.1.1.4.4.6.cmml">C</mi><mo id="S4.E12.m1.3.3.3.3.1.1.4.4.3b" xref="S4.E12.m1.3.3.3.3.1.1.4.4.3.cmml">⁢</mo><mi id="S4.E12.m1.3.3.3.3.1.1.4.4.7" xref="S4.E12.m1.3.3.3.3.1.1.4.4.7.cmml">E</mi><mo id="S4.E12.m1.3.3.3.3.1.1.4.4.3c" xref="S4.E12.m1.3.3.3.3.1.1.4.4.3.cmml">⁢</mo><mrow id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.3.cmml"><mo id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.3" stretchy="false" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.3.cmml">(</mo><msub id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.2" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.2.cmml">X</mi><mrow id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.2" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.2.cmml">r</mi><mo id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.1" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.3" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.3.cmml">e</mi><mo id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.1a" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.4" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.4.cmml">s</mi></mrow></msub><mo id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.4" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.3.cmml">,</mo><msub id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.2" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.2.cmml">X</mi><mrow id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.2" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.2.cmml">g</mi><mo id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.1" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.3" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.3.cmml">t</mi></mrow></msub><mo id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.5" stretchy="false" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E12.m1.3.3.3.3.1.1.5" xref="S4.E12.m1.3.3.3.3.1.1.5.cmml">⏟</mo></munder><msub id="S4.E12.m1.4.4.4.4.2.2.1" xref="S4.E12.m1.4.4.4.4.2.2.1.cmml"><mi id="S4.E12.m1.4.4.4.4.2.2.1.2" xref="S4.E12.m1.4.4.4.4.2.2.1.2.cmml">L</mi><mi id="S4.E12.m1.4.4.4.4.2.2.1.3" xref="S4.E12.m1.4.4.4.4.2.2.1.3.cmml">X</mi></msub></munder></mtd></mtr><mtr id="S4.E12.m1.7.7d" xref="S4.E12.m1.7.8.1.cmml"><mtd id="S4.E12.m1.7.7e" xref="S4.E12.m1.7.8.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m1.7.7f" xref="S4.E12.m1.7.8.1.cmml"><mrow id="S4.E12.m1.7.7.7.3.3" xref="S4.E12.m1.7.8.1.cmml"><mo id="S4.E12.m1.7.7.7.3.3a" xref="S4.E12.m1.7.8.1.cmml">+</mo><munder id="S4.E12.m1.7.7.7.3.3.4" xref="S4.E12.m1.7.8.1.cmml"><munder accentunder="true" id="S4.E12.m1.6.6.6.2.2.2" xref="S4.E12.m1.6.6.6.2.2.2.cmml"><mrow id="S4.E12.m1.6.6.6.2.2.2.4" xref="S4.E12.m1.6.6.6.2.2.2.4.cmml"><mrow id="S4.E12.m1.6.6.6.2.2.2.2.2" xref="S4.E12.m1.6.6.6.2.2.2.2.2.cmml"><mi id="S4.E12.m1.6.6.6.2.2.2.2.2.4" xref="S4.E12.m1.6.6.6.2.2.2.2.2.4.cmml">C</mi><mo id="S4.E12.m1.6.6.6.2.2.2.2.2.3" xref="S4.E12.m1.6.6.6.2.2.2.2.2.3.cmml">⁢</mo><mi id="S4.E12.m1.6.6.6.2.2.2.2.2.5" xref="S4.E12.m1.6.6.6.2.2.2.2.2.5.cmml">E</mi><mo id="S4.E12.m1.6.6.6.2.2.2.2.2.3a" xref="S4.E12.m1.6.6.6.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.3.cmml"><mo id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.3" stretchy="false" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.3.cmml">(</mo><msub id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.cmml"><mi id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.2" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.2.cmml">P</mi><mrow id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.cmml"><mi id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.2" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.2.cmml">m</mi><mo id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.1" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.3" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.3.cmml">a</mi><mo id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.1a" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.4" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.4.cmml">s</mi><mo id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.1b" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.5" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.5.cmml">k</mi></mrow></msub><mo id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.4" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.3.cmml">,</mo><msub id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.cmml"><mi id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.2" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.2.cmml">P</mi><mrow id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.cmml"><mi id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.2" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.2.cmml">g</mi><mo id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.1" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.3" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.3.cmml">t</mi></mrow></msub><mo id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.5" stretchy="false" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.6.6.6.2.2.2.4.5" xref="S4.E12.m1.6.6.6.2.2.2.4.5.cmml">+</mo><mrow id="S4.E12.m1.6.6.6.2.2.2.4.4" xref="S4.E12.m1.6.6.6.2.2.2.4.4.cmml"><mi id="S4.E12.m1.6.6.6.2.2.2.4.4.4" xref="S4.E12.m1.6.6.6.2.2.2.4.4.4.cmml">D</mi><mo id="S4.E12.m1.6.6.6.2.2.2.4.4.3" xref="S4.E12.m1.6.6.6.2.2.2.4.4.3.cmml">⁢</mo><mi id="S4.E12.m1.6.6.6.2.2.2.4.4.5" xref="S4.E12.m1.6.6.6.2.2.2.4.4.5.cmml">I</mi><mo id="S4.E12.m1.6.6.6.2.2.2.4.4.3a" xref="S4.E12.m1.6.6.6.2.2.2.4.4.3.cmml">⁢</mo><mi id="S4.E12.m1.6.6.6.2.2.2.4.4.6" xref="S4.E12.m1.6.6.6.2.2.2.4.4.6.cmml">C</mi><mo id="S4.E12.m1.6.6.6.2.2.2.4.4.3b" xref="S4.E12.m1.6.6.6.2.2.2.4.4.3.cmml">⁢</mo><mi id="S4.E12.m1.6.6.6.2.2.2.4.4.7" xref="S4.E12.m1.6.6.6.2.2.2.4.4.7.cmml">E</mi><mo id="S4.E12.m1.6.6.6.2.2.2.4.4.3c" xref="S4.E12.m1.6.6.6.2.2.2.4.4.3.cmml">⁢</mo><mrow id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.3.cmml"><mo id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.3" stretchy="false" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.3.cmml">(</mo><msub id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.cmml"><mi id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.2" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.2.cmml">P</mi><mrow id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.cmml"><mi id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.2" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.2.cmml">m</mi><mo id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.1" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.3" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.3.cmml">a</mi><mo id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.1a" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.4" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.4.cmml">s</mi><mo id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.1b" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.5" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.5.cmml">k</mi></mrow></msub><mo id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.4" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.3.cmml">,</mo><msub id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.cmml"><mi id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.2" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.2.cmml">P</mi><mrow id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.cmml"><mi id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.2" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.2.cmml">g</mi><mo id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.1" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.3" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.3.cmml">t</mi></mrow></msub><mo id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.5" stretchy="false" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E12.m1.6.6.6.2.2.2.5" xref="S4.E12.m1.6.6.6.2.2.2.5.cmml">⏟</mo></munder><msub id="S4.E12.m1.7.7.7.3.3.3.1" xref="S4.E12.m1.7.7.7.3.3.3.1.cmml"><mi id="S4.E12.m1.7.7.7.3.3.3.1.2" xref="S4.E12.m1.7.7.7.3.3.3.1.2.cmml">L</mi><mi id="S4.E12.m1.7.7.7.3.3.3.1.3" xref="S4.E12.m1.7.7.7.3.3.3.1.3.cmml">P</mi></msub></munder></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E12.m1.7b"><apply id="S4.E12.m1.7.8.1.cmml" xref="S4.E12.m1.7.7"><eq id="S4.E12.m1.2.2.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2.2.2"></eq><ci id="S4.E12.m1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1">𝐿</ci><apply id="S4.E12.m1.7.8.1.3.cmml" xref="S4.E12.m1.7.7"><plus id="S4.E12.m1.5.5.5.1.1.1.cmml" xref="S4.E12.m1.7.7"></plus><apply id="S4.E12.m1.7.8.1.3.2.cmml" xref="S4.E12.m1.7.7"><csymbol cd="ambiguous" id="S4.E12.m1.7.8.1.3.2.1.cmml" xref="S4.E12.m1.7.7">subscript</csymbol><apply id="S4.E12.m1.3.3.3.3.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1"><ci id="S4.E12.m1.3.3.3.3.1.1.5.cmml" xref="S4.E12.m1.3.3.3.3.1.1.5">⏟</ci><apply id="S4.E12.m1.3.3.3.3.1.1.4.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4"><plus id="S4.E12.m1.3.3.3.3.1.1.4.5.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.5"></plus><apply id="S4.E12.m1.3.3.3.3.1.1.2.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2"><times id="S4.E12.m1.3.3.3.3.1.1.2.2.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.3"></times><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.4.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.4">𝐶</ci><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.5.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.5">𝐸</ci><interval closure="open" id="S4.E12.m1.3.3.3.3.1.1.2.2.2.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2"><apply id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2">𝑋</ci><apply id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3"><times id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.4">𝑠</ci></apply></apply><apply id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2">subscript</csymbol><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.2">𝑋</ci><apply id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3"><times id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.1"></times><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.2">𝑔</ci><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.2.2.3.3">𝑡</ci></apply></apply></interval></apply><apply id="S4.E12.m1.3.3.3.3.1.1.4.4.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4"><times id="S4.E12.m1.3.3.3.3.1.1.4.4.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.3"></times><ci id="S4.E12.m1.3.3.3.3.1.1.4.4.4.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.4">𝐷</ci><ci id="S4.E12.m1.3.3.3.3.1.1.4.4.5.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.5">𝐼</ci><ci id="S4.E12.m1.3.3.3.3.1.1.4.4.6.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.6">𝐶</ci><ci id="S4.E12.m1.3.3.3.3.1.1.4.4.7.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.7">𝐸</ci><interval closure="open" id="S4.E12.m1.3.3.3.3.1.1.4.4.2.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2"><apply id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1">subscript</csymbol><ci id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.2">𝑋</ci><apply id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3"><times id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.1"></times><ci id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.2">𝑟</ci><ci id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.3">𝑒</ci><ci id="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.4.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3.3.1.1.1.3.4">𝑠</ci></apply></apply><apply id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2">subscript</csymbol><ci id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.2">𝑋</ci><apply id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3"><times id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.1"></times><ci id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.2">𝑔</ci><ci id="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.4.4.2.2.2.3.3">𝑡</ci></apply></apply></interval></apply></apply></apply><apply id="S4.E12.m1.4.4.4.4.2.2.1.cmml" xref="S4.E12.m1.4.4.4.4.2.2.1"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.4.4.2.2.1.1.cmml" xref="S4.E12.m1.4.4.4.4.2.2.1">subscript</csymbol><ci id="S4.E12.m1.4.4.4.4.2.2.1.2.cmml" xref="S4.E12.m1.4.4.4.4.2.2.1.2">𝐿</ci><ci id="S4.E12.m1.4.4.4.4.2.2.1.3.cmml" xref="S4.E12.m1.4.4.4.4.2.2.1.3">𝑋</ci></apply></apply><apply id="S4.E12.m1.7.8.1.3.3.cmml" xref="S4.E12.m1.7.7"><csymbol cd="ambiguous" id="S4.E12.m1.7.8.1.3.3.1.cmml" xref="S4.E12.m1.7.7">subscript</csymbol><apply id="S4.E12.m1.6.6.6.2.2.2.cmml" xref="S4.E12.m1.6.6.6.2.2.2"><ci id="S4.E12.m1.6.6.6.2.2.2.5.cmml" xref="S4.E12.m1.6.6.6.2.2.2.5">⏟</ci><apply id="S4.E12.m1.6.6.6.2.2.2.4.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4"><plus id="S4.E12.m1.6.6.6.2.2.2.4.5.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.5"></plus><apply id="S4.E12.m1.6.6.6.2.2.2.2.2.cmml" xref="S4.E12.m1.6.6.6.2.2.2.2.2"><times id="S4.E12.m1.6.6.6.2.2.2.2.2.3.cmml" xref="S4.E12.m1.6.6.6.2.2.2.2.2.3"></times><ci id="S4.E12.m1.6.6.6.2.2.2.2.2.4.cmml" xref="S4.E12.m1.6.6.6.2.2.2.2.2.4">𝐶</ci><ci id="S4.E12.m1.6.6.6.2.2.2.2.2.5.cmml" xref="S4.E12.m1.6.6.6.2.2.2.2.2.5">𝐸</ci><interval closure="open" id="S4.E12.m1.6.6.6.2.2.2.2.2.2.3.cmml" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2"><apply id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.cmml" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.2">𝑃</ci><apply id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3"><times id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.1"></times><ci id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.2">𝑚</ci><ci id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.3">𝑎</ci><ci id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.4.cmml" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.4">𝑠</ci><ci id="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.5.cmml" xref="S4.E12.m1.6.6.6.2.2.2.1.1.1.1.1.3.5">𝑘</ci></apply></apply><apply id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.cmml" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.2">𝑃</ci><apply id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3"><times id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.1.cmml" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.1"></times><ci id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.2.cmml" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.2">𝑔</ci><ci id="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.3.cmml" xref="S4.E12.m1.6.6.6.2.2.2.2.2.2.2.2.3.3">𝑡</ci></apply></apply></interval></apply><apply id="S4.E12.m1.6.6.6.2.2.2.4.4.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4"><times id="S4.E12.m1.6.6.6.2.2.2.4.4.3.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.3"></times><ci id="S4.E12.m1.6.6.6.2.2.2.4.4.4.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.4">𝐷</ci><ci id="S4.E12.m1.6.6.6.2.2.2.4.4.5.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.5">𝐼</ci><ci id="S4.E12.m1.6.6.6.2.2.2.4.4.6.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.6">𝐶</ci><ci id="S4.E12.m1.6.6.6.2.2.2.4.4.7.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.7">𝐸</ci><interval closure="open" id="S4.E12.m1.6.6.6.2.2.2.4.4.2.3.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2"><apply id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.cmml" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.1.cmml" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1">subscript</csymbol><ci id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.2.cmml" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.2">𝑃</ci><apply id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.cmml" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3"><times id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.1.cmml" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.1"></times><ci id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.2.cmml" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.2">𝑚</ci><ci id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.3.cmml" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.3">𝑎</ci><ci id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.4.cmml" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.4">𝑠</ci><ci id="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.5.cmml" xref="S4.E12.m1.6.6.6.2.2.2.3.3.1.1.1.3.5">𝑘</ci></apply></apply><apply id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.1.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2">subscript</csymbol><ci id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.2.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.2">𝑃</ci><apply id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3"><times id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.1.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.1"></times><ci id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.2.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.2">𝑔</ci><ci id="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.3.cmml" xref="S4.E12.m1.6.6.6.2.2.2.4.4.2.2.2.3.3">𝑡</ci></apply></apply></interval></apply></apply></apply><apply id="S4.E12.m1.7.7.7.3.3.3.1.cmml" xref="S4.E12.m1.7.7.7.3.3.3.1"><csymbol cd="ambiguous" id="S4.E12.m1.7.7.7.3.3.3.1.1.cmml" xref="S4.E12.m1.7.7.7.3.3.3.1">subscript</csymbol><ci id="S4.E12.m1.7.7.7.3.3.3.1.2.cmml" xref="S4.E12.m1.7.7.7.3.3.3.1.2">𝐿</ci><ci id="S4.E12.m1.7.7.7.3.3.3.1.3.cmml" xref="S4.E12.m1.7.7.7.3.3.3.1.3">𝑃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.7c">\begin{split}L=&amp;\,\underbrace{CE(X_{res},X_{gt})+DICE(X_{res},X_{gt})}_{L_{X}}%
\\
&amp;+\underbrace{CE(P_{mask},P_{gt})+DICE(P_{mask},P_{gt})}_{L_{P}}\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.7d">start_ROW start_CELL italic_L = end_CELL start_CELL under⏟ start_ARG italic_C italic_E ( italic_X start_POSTSUBSCRIPT italic_r italic_e italic_s end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT ) + italic_D italic_I italic_C italic_E ( italic_X start_POSTSUBSCRIPT italic_r italic_e italic_s end_POSTSUBSCRIPT , italic_X start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT ) end_ARG start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL + under⏟ start_ARG italic_C italic_E ( italic_P start_POSTSUBSCRIPT italic_m italic_a italic_s italic_k end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT ) + italic_D italic_I italic_C italic_E ( italic_P start_POSTSUBSCRIPT italic_m italic_a italic_s italic_k end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT ) end_ARG start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p1.38">Here <math alttext="CE(\cdot,\cdot)" class="ltx_Math" display="inline" id="S4.SS3.p1.34.m1.2"><semantics id="S4.SS3.p1.34.m1.2a"><mrow id="S4.SS3.p1.34.m1.2.3" xref="S4.SS3.p1.34.m1.2.3.cmml"><mi id="S4.SS3.p1.34.m1.2.3.2" xref="S4.SS3.p1.34.m1.2.3.2.cmml">C</mi><mo id="S4.SS3.p1.34.m1.2.3.1" xref="S4.SS3.p1.34.m1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.34.m1.2.3.3" xref="S4.SS3.p1.34.m1.2.3.3.cmml">E</mi><mo id="S4.SS3.p1.34.m1.2.3.1a" xref="S4.SS3.p1.34.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p1.34.m1.2.3.4.2" xref="S4.SS3.p1.34.m1.2.3.4.1.cmml"><mo id="S4.SS3.p1.34.m1.2.3.4.2.1" stretchy="false" xref="S4.SS3.p1.34.m1.2.3.4.1.cmml">(</mo><mo id="S4.SS3.p1.34.m1.1.1" lspace="0em" rspace="0em" xref="S4.SS3.p1.34.m1.1.1.cmml">⋅</mo><mo id="S4.SS3.p1.34.m1.2.3.4.2.2" rspace="0em" xref="S4.SS3.p1.34.m1.2.3.4.1.cmml">,</mo><mo id="S4.SS3.p1.34.m1.2.2" lspace="0em" rspace="0em" xref="S4.SS3.p1.34.m1.2.2.cmml">⋅</mo><mo id="S4.SS3.p1.34.m1.2.3.4.2.3" stretchy="false" xref="S4.SS3.p1.34.m1.2.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.34.m1.2b"><apply id="S4.SS3.p1.34.m1.2.3.cmml" xref="S4.SS3.p1.34.m1.2.3"><times id="S4.SS3.p1.34.m1.2.3.1.cmml" xref="S4.SS3.p1.34.m1.2.3.1"></times><ci id="S4.SS3.p1.34.m1.2.3.2.cmml" xref="S4.SS3.p1.34.m1.2.3.2">𝐶</ci><ci id="S4.SS3.p1.34.m1.2.3.3.cmml" xref="S4.SS3.p1.34.m1.2.3.3">𝐸</ci><interval closure="open" id="S4.SS3.p1.34.m1.2.3.4.1.cmml" xref="S4.SS3.p1.34.m1.2.3.4.2"><ci id="S4.SS3.p1.34.m1.1.1.cmml" xref="S4.SS3.p1.34.m1.1.1">⋅</ci><ci id="S4.SS3.p1.34.m1.2.2.cmml" xref="S4.SS3.p1.34.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.34.m1.2c">CE(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.34.m1.2d">italic_C italic_E ( ⋅ , ⋅ )</annotation></semantics></math> and <math alttext="DICE(\cdot,\cdot)" class="ltx_Math" display="inline" id="S4.SS3.p1.35.m2.2"><semantics id="S4.SS3.p1.35.m2.2a"><mrow id="S4.SS3.p1.35.m2.2.3" xref="S4.SS3.p1.35.m2.2.3.cmml"><mi id="S4.SS3.p1.35.m2.2.3.2" xref="S4.SS3.p1.35.m2.2.3.2.cmml">D</mi><mo id="S4.SS3.p1.35.m2.2.3.1" xref="S4.SS3.p1.35.m2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.35.m2.2.3.3" xref="S4.SS3.p1.35.m2.2.3.3.cmml">I</mi><mo id="S4.SS3.p1.35.m2.2.3.1a" xref="S4.SS3.p1.35.m2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.35.m2.2.3.4" xref="S4.SS3.p1.35.m2.2.3.4.cmml">C</mi><mo id="S4.SS3.p1.35.m2.2.3.1b" xref="S4.SS3.p1.35.m2.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.35.m2.2.3.5" xref="S4.SS3.p1.35.m2.2.3.5.cmml">E</mi><mo id="S4.SS3.p1.35.m2.2.3.1c" xref="S4.SS3.p1.35.m2.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p1.35.m2.2.3.6.2" xref="S4.SS3.p1.35.m2.2.3.6.1.cmml"><mo id="S4.SS3.p1.35.m2.2.3.6.2.1" stretchy="false" xref="S4.SS3.p1.35.m2.2.3.6.1.cmml">(</mo><mo id="S4.SS3.p1.35.m2.1.1" lspace="0em" rspace="0em" xref="S4.SS3.p1.35.m2.1.1.cmml">⋅</mo><mo id="S4.SS3.p1.35.m2.2.3.6.2.2" rspace="0em" xref="S4.SS3.p1.35.m2.2.3.6.1.cmml">,</mo><mo id="S4.SS3.p1.35.m2.2.2" lspace="0em" rspace="0em" xref="S4.SS3.p1.35.m2.2.2.cmml">⋅</mo><mo id="S4.SS3.p1.35.m2.2.3.6.2.3" stretchy="false" xref="S4.SS3.p1.35.m2.2.3.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.35.m2.2b"><apply id="S4.SS3.p1.35.m2.2.3.cmml" xref="S4.SS3.p1.35.m2.2.3"><times id="S4.SS3.p1.35.m2.2.3.1.cmml" xref="S4.SS3.p1.35.m2.2.3.1"></times><ci id="S4.SS3.p1.35.m2.2.3.2.cmml" xref="S4.SS3.p1.35.m2.2.3.2">𝐷</ci><ci id="S4.SS3.p1.35.m2.2.3.3.cmml" xref="S4.SS3.p1.35.m2.2.3.3">𝐼</ci><ci id="S4.SS3.p1.35.m2.2.3.4.cmml" xref="S4.SS3.p1.35.m2.2.3.4">𝐶</ci><ci id="S4.SS3.p1.35.m2.2.3.5.cmml" xref="S4.SS3.p1.35.m2.2.3.5">𝐸</ci><interval closure="open" id="S4.SS3.p1.35.m2.2.3.6.1.cmml" xref="S4.SS3.p1.35.m2.2.3.6.2"><ci id="S4.SS3.p1.35.m2.1.1.cmml" xref="S4.SS3.p1.35.m2.1.1">⋅</ci><ci id="S4.SS3.p1.35.m2.2.2.cmml" xref="S4.SS3.p1.35.m2.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.35.m2.2c">DICE(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.35.m2.2d">italic_D italic_I italic_C italic_E ( ⋅ , ⋅ )</annotation></semantics></math> represent the cross entropy loss and dice loss functions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib17" title="">17</a>]</cite> respectively. The training loss includes two parts: final reasoning segmentation mask loss <math alttext="L_{X}" class="ltx_Math" display="inline" id="S4.SS3.p1.36.m3.1"><semantics id="S4.SS3.p1.36.m3.1a"><msub id="S4.SS3.p1.36.m3.1.1" xref="S4.SS3.p1.36.m3.1.1.cmml"><mi id="S4.SS3.p1.36.m3.1.1.2" xref="S4.SS3.p1.36.m3.1.1.2.cmml">L</mi><mi id="S4.SS3.p1.36.m3.1.1.3" xref="S4.SS3.p1.36.m3.1.1.3.cmml">X</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.36.m3.1b"><apply id="S4.SS3.p1.36.m3.1.1.cmml" xref="S4.SS3.p1.36.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.36.m3.1.1.1.cmml" xref="S4.SS3.p1.36.m3.1.1">subscript</csymbol><ci id="S4.SS3.p1.36.m3.1.1.2.cmml" xref="S4.SS3.p1.36.m3.1.1.2">𝐿</ci><ci id="S4.SS3.p1.36.m3.1.1.3.cmml" xref="S4.SS3.p1.36.m3.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.36.m3.1c">L_{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.36.m3.1d">italic_L start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT</annotation></semantics></math> and pruning mask loss <math alttext="L_{P}" class="ltx_Math" display="inline" id="S4.SS3.p1.37.m4.1"><semantics id="S4.SS3.p1.37.m4.1a"><msub id="S4.SS3.p1.37.m4.1.1" xref="S4.SS3.p1.37.m4.1.1.cmml"><mi id="S4.SS3.p1.37.m4.1.1.2" xref="S4.SS3.p1.37.m4.1.1.2.cmml">L</mi><mi id="S4.SS3.p1.37.m4.1.1.3" xref="S4.SS3.p1.37.m4.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.37.m4.1b"><apply id="S4.SS3.p1.37.m4.1.1.cmml" xref="S4.SS3.p1.37.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.37.m4.1.1.1.cmml" xref="S4.SS3.p1.37.m4.1.1">subscript</csymbol><ci id="S4.SS3.p1.37.m4.1.1.2.cmml" xref="S4.SS3.p1.37.m4.1.1.2">𝐿</ci><ci id="S4.SS3.p1.37.m4.1.1.3.cmml" xref="S4.SS3.p1.37.m4.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.37.m4.1c">L_{P}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.37.m4.1d">italic_L start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT</annotation></semantics></math>. For the <math alttext="L_{X}" class="ltx_Math" display="inline" id="S4.SS3.p1.38.m5.1"><semantics id="S4.SS3.p1.38.m5.1a"><msub id="S4.SS3.p1.38.m5.1.1" xref="S4.SS3.p1.38.m5.1.1.cmml"><mi id="S4.SS3.p1.38.m5.1.1.2" xref="S4.SS3.p1.38.m5.1.1.2.cmml">L</mi><mi id="S4.SS3.p1.38.m5.1.1.3" xref="S4.SS3.p1.38.m5.1.1.3.cmml">X</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.38.m5.1b"><apply id="S4.SS3.p1.38.m5.1.1.cmml" xref="S4.SS3.p1.38.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.38.m5.1.1.1.cmml" xref="S4.SS3.p1.38.m5.1.1">subscript</csymbol><ci id="S4.SS3.p1.38.m5.1.1.2.cmml" xref="S4.SS3.p1.38.m5.1.1.2">𝐿</ci><ci id="S4.SS3.p1.38.m5.1.1.3.cmml" xref="S4.SS3.p1.38.m5.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.38.m5.1c">L_{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.38.m5.1d">italic_L start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT</annotation></semantics></math>, we follow previous work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib22" title="">22</a>]</cite>. We set the ground truth of pruning masks as:</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx1">
<tbody id="S4.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle P_{gt}\left(\text{idx}\right)=\begin{cases}1&amp;\text{if }\max(X_{%
gt}^{patch}(i,j))&gt;0\\
0&amp;\text{otherwise}\end{cases}," class="ltx_Math" display="inline" id="S4.E13.m1.6"><semantics id="S4.E13.m1.6a"><mrow id="S4.E13.m1.6.6.1" xref="S4.E13.m1.6.6.1.1.cmml"><mrow id="S4.E13.m1.6.6.1.1" xref="S4.E13.m1.6.6.1.1.cmml"><mrow id="S4.E13.m1.6.6.1.1.2" xref="S4.E13.m1.6.6.1.1.2.cmml"><msub id="S4.E13.m1.6.6.1.1.2.2" xref="S4.E13.m1.6.6.1.1.2.2.cmml"><mi id="S4.E13.m1.6.6.1.1.2.2.2" xref="S4.E13.m1.6.6.1.1.2.2.2.cmml">P</mi><mrow id="S4.E13.m1.6.6.1.1.2.2.3" xref="S4.E13.m1.6.6.1.1.2.2.3.cmml"><mi id="S4.E13.m1.6.6.1.1.2.2.3.2" xref="S4.E13.m1.6.6.1.1.2.2.3.2.cmml">g</mi><mo id="S4.E13.m1.6.6.1.1.2.2.3.1" xref="S4.E13.m1.6.6.1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.6.6.1.1.2.2.3.3" xref="S4.E13.m1.6.6.1.1.2.2.3.3.cmml">t</mi></mrow></msub><mo id="S4.E13.m1.6.6.1.1.2.1" xref="S4.E13.m1.6.6.1.1.2.1.cmml">⁢</mo><mrow id="S4.E13.m1.6.6.1.1.2.3.2" xref="S4.E13.m1.5.5a.cmml"><mo id="S4.E13.m1.6.6.1.1.2.3.2.1" xref="S4.E13.m1.5.5a.cmml">(</mo><mtext id="S4.E13.m1.5.5" xref="S4.E13.m1.5.5.cmml">idx</mtext><mo id="S4.E13.m1.6.6.1.1.2.3.2.2" xref="S4.E13.m1.5.5a.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.6.6.1.1.1" xref="S4.E13.m1.6.6.1.1.1.cmml">=</mo><mrow id="S4.E13.m1.4.4a" xref="S4.E13.m1.6.6.1.1.3.1.cmml"><mo id="S4.E13.m1.4.4a.5" xref="S4.E13.m1.6.6.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="S4.E13.m1.4.4.4a" rowspacing="0pt" xref="S4.E13.m1.6.6.1.1.3.1.cmml"><mtr id="S4.E13.m1.4.4.4aa" xref="S4.E13.m1.6.6.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E13.m1.4.4.4ab" xref="S4.E13.m1.6.6.1.1.3.1.cmml"><mn id="S4.E13.m1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E13.m1.4.4.4ac" xref="S4.E13.m1.6.6.1.1.3.1.cmml"><mrow id="S4.E13.m1.2.2.2.2.2.1" xref="S4.E13.m1.2.2.2.2.2.1.cmml"><mrow id="S4.E13.m1.2.2.2.2.2.1.4" xref="S4.E13.m1.2.2.2.2.2.1.4.cmml"><mtext id="S4.E13.m1.2.2.2.2.2.1.4.3" xref="S4.E13.m1.2.2.2.2.2.1.4.3a.cmml">if </mtext><mo id="S4.E13.m1.2.2.2.2.2.1.4.2" lspace="0.167em" xref="S4.E13.m1.2.2.2.2.2.1.4.2.cmml">⁢</mo><mrow id="S4.E13.m1.2.2.2.2.2.1.4.1.1" xref="S4.E13.m1.2.2.2.2.2.1.4.1.2.cmml"><mi id="S4.E13.m1.2.2.2.2.2.1.3" xref="S4.E13.m1.2.2.2.2.2.1.3.cmml">max</mi><mo id="S4.E13.m1.2.2.2.2.2.1.4.1.1a" xref="S4.E13.m1.2.2.2.2.2.1.4.1.2.cmml">⁡</mo><mrow id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1" xref="S4.E13.m1.2.2.2.2.2.1.4.1.2.cmml"><mo id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.2" stretchy="false" xref="S4.E13.m1.2.2.2.2.2.1.4.1.2.cmml">(</mo><mrow id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.cmml"><msubsup id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.cmml"><mi id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.2" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.2.cmml">X</mi><mrow id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.cmml"><mi id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.2" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.2.cmml">g</mi><mo id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.1" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.3" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.3.cmml">t</mi></mrow><mrow id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.cmml"><mi id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.2" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.2.cmml">p</mi><mo id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.1" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.3" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.3.cmml">a</mi><mo id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.1a" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.4" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.4.cmml">t</mi><mo id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.1b" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.5" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.5.cmml">c</mi><mo id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.1c" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.6" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.6.cmml">h</mi></mrow></msubsup><mo id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.1" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.3.2" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.3.1.cmml"><mo id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.3.2.1" stretchy="false" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.3.1.cmml">(</mo><mi id="S4.E13.m1.2.2.2.2.2.1.1" xref="S4.E13.m1.2.2.2.2.2.1.1.cmml">i</mi><mo id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.3.2.2" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.3.1.cmml">,</mo><mi id="S4.E13.m1.2.2.2.2.2.1.2" xref="S4.E13.m1.2.2.2.2.2.1.2.cmml">j</mi><mo id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.3.2.3" stretchy="false" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.3" stretchy="false" xref="S4.E13.m1.2.2.2.2.2.1.4.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E13.m1.2.2.2.2.2.1.5" xref="S4.E13.m1.2.2.2.2.2.1.5.cmml">&gt;</mo><mn id="S4.E13.m1.2.2.2.2.2.1.6" xref="S4.E13.m1.2.2.2.2.2.1.6.cmml">0</mn></mrow></mtd></mtr><mtr id="S4.E13.m1.4.4.4ad" xref="S4.E13.m1.6.6.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E13.m1.4.4.4ae" xref="S4.E13.m1.6.6.1.1.3.1.cmml"><mn id="S4.E13.m1.3.3.3.3.1.1" xref="S4.E13.m1.3.3.3.3.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E13.m1.4.4.4af" xref="S4.E13.m1.6.6.1.1.3.1.cmml"><mtext id="S4.E13.m1.4.4.4.4.2.1" xref="S4.E13.m1.4.4.4.4.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><mo id="S4.E13.m1.6.6.1.2" xref="S4.E13.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.6b"><apply id="S4.E13.m1.6.6.1.1.cmml" xref="S4.E13.m1.6.6.1"><eq id="S4.E13.m1.6.6.1.1.1.cmml" xref="S4.E13.m1.6.6.1.1.1"></eq><apply id="S4.E13.m1.6.6.1.1.2.cmml" xref="S4.E13.m1.6.6.1.1.2"><times id="S4.E13.m1.6.6.1.1.2.1.cmml" xref="S4.E13.m1.6.6.1.1.2.1"></times><apply id="S4.E13.m1.6.6.1.1.2.2.cmml" xref="S4.E13.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.6.6.1.1.2.2.1.cmml" xref="S4.E13.m1.6.6.1.1.2.2">subscript</csymbol><ci id="S4.E13.m1.6.6.1.1.2.2.2.cmml" xref="S4.E13.m1.6.6.1.1.2.2.2">𝑃</ci><apply id="S4.E13.m1.6.6.1.1.2.2.3.cmml" xref="S4.E13.m1.6.6.1.1.2.2.3"><times id="S4.E13.m1.6.6.1.1.2.2.3.1.cmml" xref="S4.E13.m1.6.6.1.1.2.2.3.1"></times><ci id="S4.E13.m1.6.6.1.1.2.2.3.2.cmml" xref="S4.E13.m1.6.6.1.1.2.2.3.2">𝑔</ci><ci id="S4.E13.m1.6.6.1.1.2.2.3.3.cmml" xref="S4.E13.m1.6.6.1.1.2.2.3.3">𝑡</ci></apply></apply><ci id="S4.E13.m1.5.5a.cmml" xref="S4.E13.m1.6.6.1.1.2.3.2"><mtext id="S4.E13.m1.5.5.cmml" xref="S4.E13.m1.5.5">idx</mtext></ci></apply><apply id="S4.E13.m1.6.6.1.1.3.1.cmml" xref="S4.E13.m1.4.4a"><csymbol cd="latexml" id="S4.E13.m1.6.6.1.1.3.1.1.cmml" xref="S4.E13.m1.4.4a.5">cases</csymbol><cn id="S4.E13.m1.1.1.1.1.1.1.cmml" type="integer" xref="S4.E13.m1.1.1.1.1.1.1">1</cn><apply id="S4.E13.m1.2.2.2.2.2.1.cmml" xref="S4.E13.m1.2.2.2.2.2.1"><gt id="S4.E13.m1.2.2.2.2.2.1.5.cmml" xref="S4.E13.m1.2.2.2.2.2.1.5"></gt><apply id="S4.E13.m1.2.2.2.2.2.1.4.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4"><times id="S4.E13.m1.2.2.2.2.2.1.4.2.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.2"></times><ci id="S4.E13.m1.2.2.2.2.2.1.4.3a.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.3"><mtext id="S4.E13.m1.2.2.2.2.2.1.4.3.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.3">if </mtext></ci><apply id="S4.E13.m1.2.2.2.2.2.1.4.1.2.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1"><max id="S4.E13.m1.2.2.2.2.2.1.3.cmml" xref="S4.E13.m1.2.2.2.2.2.1.3"></max><apply id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1"><times id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.1.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.1"></times><apply id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.1.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2">superscript</csymbol><apply id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.1.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2">subscript</csymbol><ci id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.2">𝑋</ci><apply id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3"><times id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.1.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.1"></times><ci id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.2.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.2">𝑔</ci><ci id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.3.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.2.3.3">𝑡</ci></apply></apply><apply id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3"><times id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.1.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.1"></times><ci id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.2.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.2">𝑝</ci><ci id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.3.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.3">𝑎</ci><ci id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.4.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.4">𝑡</ci><ci id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.5.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.5">𝑐</ci><ci id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.6.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.2.3.6">ℎ</ci></apply></apply><interval closure="open" id="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.3.1.cmml" xref="S4.E13.m1.2.2.2.2.2.1.4.1.1.1.1.3.2"><ci id="S4.E13.m1.2.2.2.2.2.1.1.cmml" xref="S4.E13.m1.2.2.2.2.2.1.1">𝑖</ci><ci id="S4.E13.m1.2.2.2.2.2.1.2.cmml" xref="S4.E13.m1.2.2.2.2.2.1.2">𝑗</ci></interval></apply></apply></apply><cn id="S4.E13.m1.2.2.2.2.2.1.6.cmml" type="integer" xref="S4.E13.m1.2.2.2.2.2.1.6">0</cn></apply><cn id="S4.E13.m1.3.3.3.3.1.1.cmml" type="integer" xref="S4.E13.m1.3.3.3.3.1.1">0</cn><ci id="S4.E13.m1.4.4.4.4.2.1a.cmml" xref="S4.E13.m1.4.4.4.4.2.1"><mtext id="S4.E13.m1.4.4.4.4.2.1.cmml" xref="S4.E13.m1.4.4.4.4.2.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.6c">\displaystyle P_{gt}\left(\text{idx}\right)=\begin{cases}1&amp;\text{if }\max(X_{%
gt}^{patch}(i,j))&gt;0\\
0&amp;\text{otherwise}\end{cases},</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.6d">italic_P start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT ( idx ) = { start_ROW start_CELL 1 end_CELL start_CELL if roman_max ( italic_X start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p italic_a italic_t italic_c italic_h end_POSTSUPERSCRIPT ( italic_i , italic_j ) ) &gt; 0 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL otherwise end_CELL end_ROW ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
<tbody id="S4.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{where }\text{idx}=i\times\left(\frac{W}{P}\right)+j\quad%
\text{and}\quad\text{idx}\in[1,N]" class="ltx_Math" display="inline" id="S4.E14.m1.6"><semantics id="S4.E14.m1.6a"><mrow id="S4.E14.m1.6.6.2" xref="S4.E14.m1.6.6.3.cmml"><mrow id="S4.E14.m1.5.5.1.1" xref="S4.E14.m1.5.5.1.1.cmml"><mrow id="S4.E14.m1.5.5.1.1.3" xref="S4.E14.m1.5.5.1.1.3c.cmml"><mtext id="S4.E14.m1.5.5.1.1.3a" xref="S4.E14.m1.5.5.1.1.3c.cmml">where </mtext><mtext id="S4.E14.m1.5.5.1.1.3b" xref="S4.E14.m1.5.5.1.1.3c.cmml">idx</mtext></mrow><mo id="S4.E14.m1.5.5.1.1.2" xref="S4.E14.m1.5.5.1.1.2.cmml">=</mo><mrow id="S4.E14.m1.5.5.1.1.1.1" xref="S4.E14.m1.5.5.1.1.1.2.cmml"><mrow id="S4.E14.m1.5.5.1.1.1.1.1" xref="S4.E14.m1.5.5.1.1.1.1.1.cmml"><mrow id="S4.E14.m1.5.5.1.1.1.1.1.2" xref="S4.E14.m1.5.5.1.1.1.1.1.2.cmml"><mi id="S4.E14.m1.5.5.1.1.1.1.1.2.2" xref="S4.E14.m1.5.5.1.1.1.1.1.2.2.cmml">i</mi><mo id="S4.E14.m1.5.5.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E14.m1.5.5.1.1.1.1.1.2.1.cmml">×</mo><mrow id="S4.E14.m1.5.5.1.1.1.1.1.2.3.2" xref="S4.E14.m1.1.1.cmml"><mo id="S4.E14.m1.5.5.1.1.1.1.1.2.3.2.1" xref="S4.E14.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S4.E14.m1.1.1" xref="S4.E14.m1.1.1.cmml"><mfrac id="S4.E14.m1.1.1a" xref="S4.E14.m1.1.1.cmml"><mi id="S4.E14.m1.1.1.2" xref="S4.E14.m1.1.1.2.cmml">W</mi><mi id="S4.E14.m1.1.1.3" xref="S4.E14.m1.1.1.3.cmml">P</mi></mfrac></mstyle><mo id="S4.E14.m1.5.5.1.1.1.1.1.2.3.2.2" xref="S4.E14.m1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.5.5.1.1.1.1.1.1" xref="S4.E14.m1.5.5.1.1.1.1.1.1.cmml">+</mo><mi id="S4.E14.m1.5.5.1.1.1.1.1.3" xref="S4.E14.m1.5.5.1.1.1.1.1.3.cmml">j</mi></mrow><mspace id="S4.E14.m1.5.5.1.1.1.1.2" width="1em" xref="S4.E14.m1.5.5.1.1.1.2.cmml"></mspace><mtext id="S4.E14.m1.4.4" xref="S4.E14.m1.4.4a.cmml">and</mtext></mrow></mrow><mspace id="S4.E14.m1.6.6.2.3" width="1em" xref="S4.E14.m1.6.6.3a.cmml"></mspace><mrow id="S4.E14.m1.6.6.2.2" xref="S4.E14.m1.6.6.2.2.cmml"><mtext id="S4.E14.m1.6.6.2.2.2" xref="S4.E14.m1.6.6.2.2.2a.cmml">idx</mtext><mo id="S4.E14.m1.6.6.2.2.1" xref="S4.E14.m1.6.6.2.2.1.cmml">∈</mo><mrow id="S4.E14.m1.6.6.2.2.3.2" xref="S4.E14.m1.6.6.2.2.3.1.cmml"><mo id="S4.E14.m1.6.6.2.2.3.2.1" stretchy="false" xref="S4.E14.m1.6.6.2.2.3.1.cmml">[</mo><mn id="S4.E14.m1.2.2" xref="S4.E14.m1.2.2.cmml">1</mn><mo id="S4.E14.m1.6.6.2.2.3.2.2" xref="S4.E14.m1.6.6.2.2.3.1.cmml">,</mo><mi id="S4.E14.m1.3.3" xref="S4.E14.m1.3.3.cmml">N</mi><mo id="S4.E14.m1.6.6.2.2.3.2.3" stretchy="false" xref="S4.E14.m1.6.6.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.6b"><apply id="S4.E14.m1.6.6.3.cmml" xref="S4.E14.m1.6.6.2"><csymbol cd="ambiguous" id="S4.E14.m1.6.6.3a.cmml" xref="S4.E14.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S4.E14.m1.5.5.1.1.cmml" xref="S4.E14.m1.5.5.1.1"><eq id="S4.E14.m1.5.5.1.1.2.cmml" xref="S4.E14.m1.5.5.1.1.2"></eq><ci id="S4.E14.m1.5.5.1.1.3c.cmml" xref="S4.E14.m1.5.5.1.1.3"><mrow id="S4.E14.m1.5.5.1.1.3.cmml" xref="S4.E14.m1.5.5.1.1.3"><mtext id="S4.E14.m1.5.5.1.1.3a.cmml" xref="S4.E14.m1.5.5.1.1.3">where </mtext><mtext id="S4.E14.m1.5.5.1.1.3b.cmml" xref="S4.E14.m1.5.5.1.1.3">idx</mtext></mrow></ci><list id="S4.E14.m1.5.5.1.1.1.2.cmml" xref="S4.E14.m1.5.5.1.1.1.1"><apply id="S4.E14.m1.5.5.1.1.1.1.1.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1"><plus id="S4.E14.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.1"></plus><apply id="S4.E14.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.2"><times id="S4.E14.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.2.1"></times><ci id="S4.E14.m1.5.5.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.2.2">𝑖</ci><apply id="S4.E14.m1.1.1.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.2.3.2"><divide id="S4.E14.m1.1.1.1.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.2.3.2"></divide><ci id="S4.E14.m1.1.1.2.cmml" xref="S4.E14.m1.1.1.2">𝑊</ci><ci id="S4.E14.m1.1.1.3.cmml" xref="S4.E14.m1.1.1.3">𝑃</ci></apply></apply><ci id="S4.E14.m1.5.5.1.1.1.1.1.3.cmml" xref="S4.E14.m1.5.5.1.1.1.1.1.3">𝑗</ci></apply><ci id="S4.E14.m1.4.4a.cmml" xref="S4.E14.m1.4.4"><mtext id="S4.E14.m1.4.4.cmml" xref="S4.E14.m1.4.4">and</mtext></ci></list></apply><apply id="S4.E14.m1.6.6.2.2.cmml" xref="S4.E14.m1.6.6.2.2"><in id="S4.E14.m1.6.6.2.2.1.cmml" xref="S4.E14.m1.6.6.2.2.1"></in><ci id="S4.E14.m1.6.6.2.2.2a.cmml" xref="S4.E14.m1.6.6.2.2.2"><mtext id="S4.E14.m1.6.6.2.2.2.cmml" xref="S4.E14.m1.6.6.2.2.2">idx</mtext></ci><interval closure="closed" id="S4.E14.m1.6.6.2.2.3.1.cmml" xref="S4.E14.m1.6.6.2.2.3.2"><cn id="S4.E14.m1.2.2.cmml" type="integer" xref="S4.E14.m1.2.2">1</cn><ci id="S4.E14.m1.3.3.cmml" xref="S4.E14.m1.3.3">𝑁</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.6c">\displaystyle\text{where }\text{idx}=i\times\left(\frac{W}{P}\right)+j\quad%
\text{and}\quad\text{idx}\in[1,N]</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.6d">where roman_idx = italic_i × ( divide start_ARG italic_W end_ARG start_ARG italic_P end_ARG ) + italic_j and idx ∈ [ 1 , italic_N ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.5">Here the <math alttext="(i,j)" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.2"><semantics id="S4.SS3.p3.1.m1.2a"><mrow id="S4.SS3.p3.1.m1.2.3.2" xref="S4.SS3.p3.1.m1.2.3.1.cmml"><mo id="S4.SS3.p3.1.m1.2.3.2.1" stretchy="false" xref="S4.SS3.p3.1.m1.2.3.1.cmml">(</mo><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">i</mi><mo id="S4.SS3.p3.1.m1.2.3.2.2" xref="S4.SS3.p3.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS3.p3.1.m1.2.2" xref="S4.SS3.p3.1.m1.2.2.cmml">j</mi><mo id="S4.SS3.p3.1.m1.2.3.2.3" stretchy="false" xref="S4.SS3.p3.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.2b"><interval closure="open" id="S4.SS3.p3.1.m1.2.3.1.cmml" xref="S4.SS3.p3.1.m1.2.3.2"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝑖</ci><ci id="S4.SS3.p3.1.m1.2.2.cmml" xref="S4.SS3.p3.1.m1.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.2c">(i,j)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.2d">( italic_i , italic_j )</annotation></semantics></math> is the patch index of the original ground truth mask <math alttext="X_{gt}" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><msub id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">X</mi><mrow id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.3.2" xref="S4.SS3.p3.2.m2.1.1.3.2.cmml">g</mi><mo id="S4.SS3.p3.2.m2.1.1.3.1" xref="S4.SS3.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.2.m2.1.1.3.3" xref="S4.SS3.p3.2.m2.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">𝑋</ci><apply id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3"><times id="S4.SS3.p3.2.m2.1.1.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3.1"></times><ci id="S4.SS3.p3.2.m2.1.1.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2">𝑔</ci><ci id="S4.SS3.p3.2.m2.1.1.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">X_{gt}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">italic_X start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The ground truth pruning mask label <math alttext="P_{gt}" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.1"><semantics id="S4.SS3.p3.3.m3.1a"><msub id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml"><mi id="S4.SS3.p3.3.m3.1.1.2" xref="S4.SS3.p3.3.m3.1.1.2.cmml">P</mi><mrow id="S4.SS3.p3.3.m3.1.1.3" xref="S4.SS3.p3.3.m3.1.1.3.cmml"><mi id="S4.SS3.p3.3.m3.1.1.3.2" xref="S4.SS3.p3.3.m3.1.1.3.2.cmml">g</mi><mo id="S4.SS3.p3.3.m3.1.1.3.1" xref="S4.SS3.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.3.m3.1.1.3.3" xref="S4.SS3.p3.3.m3.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p3.3.m3.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.2">𝑃</ci><apply id="S4.SS3.p3.3.m3.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3"><times id="S4.SS3.p3.3.m3.1.1.3.1.cmml" xref="S4.SS3.p3.3.m3.1.1.3.1"></times><ci id="S4.SS3.p3.3.m3.1.1.3.2.cmml" xref="S4.SS3.p3.3.m3.1.1.3.2">𝑔</ci><ci id="S4.SS3.p3.3.m3.1.1.3.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">P_{gt}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at a specific index is assigned a value of <math alttext="1" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m4.1"><semantics id="S4.SS3.p3.4.m4.1a"><mn id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><cn id="S4.SS3.p3.4.m4.1.1.cmml" type="integer" xref="S4.SS3.p3.4.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.4.m4.1d">1</annotation></semantics></math> if the corresponding patch within the final mask includes at least one positive pixel; if not, it is assigned a value of <math alttext="0" class="ltx_Math" display="inline" id="S4.SS3.p3.5.m5.1"><semantics id="S4.SS3.p3.5.m5.1a"><mn id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><cn id="S4.SS3.p3.5.m5.1.1.cmml" type="integer" xref="S4.SS3.p3.5.m5.1.1">0</cn></annotation-xml></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Pruned Tokens Reactivation</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.3">As illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S4.F3" title="In 4 Vision-Language Guided Patch Pruning ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, we reactivate the pruned image tokens in two scenarios. Firstly, the pruned tokens from stage <math alttext="m" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">italic_m</annotation></semantics></math> will be reactivated at stage <math alttext="m+1" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><mrow id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">m</mi><mo id="S4.SS4.p1.2.m2.1.1.1" xref="S4.SS4.p1.2.m2.1.1.1.cmml">+</mo><mn id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><plus id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1.1"></plus><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝑚</ci><cn id="S4.SS4.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS4.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">m+1</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">italic_m + 1</annotation></semantics></math>. This process aids the prune decoder in re-selecting image tokens that are most pertinent to reasoning tasks, thereby correcting any misdrops from earlier stages. Secondly, following the completion of all ViT layers, we will merge the pruned image tokens with the remaining tokens pertinent to reasoning tasks, and feed the combined tokens (with shape <math alttext="N\times D" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><mrow id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml">N</mi><mo id="S4.SS4.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS4.p1.3.m3.1.1.1.cmml">×</mo><mi id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><times id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1.1"></times><ci id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2">𝑁</ci><ci id="S4.SS4.p1.3.m3.1.1.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">N\times D</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">italic_N × italic_D</annotation></semantics></math>) into the mask decoder. This approach enhances the mask decoder’s ability to reconstruct the final segmentation mask.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Dataset and Metrics</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">To verify the extensive applicability of VLTP for TOS tasks, we perform experiments on two datasets: RIO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib38" title="">38</a>]</cite> and COCO-Tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib40" title="">40</a>]</cite>. Both of these datasets are derived from MS COCO 2014 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib27" title="">27</a>]</cite>. Specifically, RIO encompasses over 100 different tasks, and the entire dataset is categorized into two groups based on difficulty: <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.1">common</span> and <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.2">uncommon</span>. The COCO-Tasks dataset comprises 14 distinct tasks. Following the common convention, we utilize the mean intersection over union (mIoU) to assess the segmentation accuracy and the number of floating-point operations in giga (GFLOPs) to measure the model computational intensity. We perform all experiments using three NVIDIA RTX A6000 GPUs.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Vision Language Fintuning</h3>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.2.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S5.T2.3.2" style="font-size:90%;">Comparison with previous works on RIO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib38" title="">38</a>]</cite> dataset.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.4" style="width:198.7pt;height:101.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-59.4pt,30.3pt) scale(0.625847004337437,0.625847004337437) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T2.4.1.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T2.4.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.4.1.1.1.2">Common</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.4.1.1.1.3">Uncommon</th>
</tr>
<tr class="ltx_tr" id="S5.T2.4.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.4.1.2.2.1">mIoU (%)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.4.1.2.2.2">mIoU (%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.4.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S5.T2.4.1.3.1.1">MDETR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib19" title="">19</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.4.1.3.1.2">44.14</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.4.1.3.1.3">22.03</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.4.1.4.2.1">TOIST <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib25" title="">25</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S5.T2.4.1.4.2.2">45.07</td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.1.4.2.3">19.41</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.4.1.5.3.1">Polyformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib29" title="">29</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S5.T2.4.1.5.3.2">48.75</td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.1.5.3.3">26.77</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.4.1.6.4.1">GROUNDHOG <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib56" title="">56</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S5.T2.4.1.6.4.2">57.9</td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.1.6.4.3">33.9</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.4.1.7.5.1">SAM ViT-H</th>
<td class="ltx_td ltx_align_center" id="S5.T2.4.1.7.5.2"><span class="ltx_text ltx_font_bold" id="S5.T2.4.1.7.5.2.1">60.4</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.1.7.5.3"><span class="ltx_text ltx_font_bold" id="S5.T2.4.1.7.5.3.1">37.2</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.1.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.4.1.8.6.1">SAM ViT-L</th>
<td class="ltx_td ltx_align_center" id="S5.T2.4.1.8.6.2">55.7</td>
<td class="ltx_td ltx_align_center" id="S5.T2.4.1.8.6.3">32.4</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.1.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T2.4.1.9.7.1">SAM ViT-B</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.4.1.9.7.2">50.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.4.1.9.7.3">27.9</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.5.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S5.T3.6.2" style="font-size:90%;">Comparison of training scheme. All results are reported based on RIO common dataset. ♠ represents the extra finetune epochs.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T3.3" style="width:223.6pt;height:69.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-33.9pt,10.5pt) scale(0.767462540678908,0.767462540678908) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T3.3.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.3.3.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.3.3.4.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.3.3.4.1.2">GFLOPs</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T3.3.3.4.1.3">mIoU (%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.3.3.5.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T3.3.3.5.1.1">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.3.5.1.2">2976</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.3.5.1.3">60.4</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.3.6.2">
<td class="ltx_td ltx_align_left" id="S5.T3.3.3.6.2.1">+VLTP@Direct (♠0)</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.3.6.2.2">2227</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.3.6.2.3">39.5</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.1.1">
<td class="ltx_td ltx_align_left" id="S5.T3.1.1.1.1">+VLTP@Finetune (<math alttext="F_{prune}" class="ltx_Math" display="inline" id="S5.T3.1.1.1.1.m1.1"><semantics id="S5.T3.1.1.1.1.m1.1a"><msub id="S5.T3.1.1.1.1.m1.1.1" xref="S5.T3.1.1.1.1.m1.1.1.cmml"><mi id="S5.T3.1.1.1.1.m1.1.1.2" xref="S5.T3.1.1.1.1.m1.1.1.2.cmml">F</mi><mrow id="S5.T3.1.1.1.1.m1.1.1.3" xref="S5.T3.1.1.1.1.m1.1.1.3.cmml"><mi id="S5.T3.1.1.1.1.m1.1.1.3.2" xref="S5.T3.1.1.1.1.m1.1.1.3.2.cmml">p</mi><mo id="S5.T3.1.1.1.1.m1.1.1.3.1" xref="S5.T3.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.T3.1.1.1.1.m1.1.1.3.3" xref="S5.T3.1.1.1.1.m1.1.1.3.3.cmml">r</mi><mo id="S5.T3.1.1.1.1.m1.1.1.3.1a" xref="S5.T3.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.T3.1.1.1.1.m1.1.1.3.4" xref="S5.T3.1.1.1.1.m1.1.1.3.4.cmml">u</mi><mo id="S5.T3.1.1.1.1.m1.1.1.3.1b" xref="S5.T3.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.T3.1.1.1.1.m1.1.1.3.5" xref="S5.T3.1.1.1.1.m1.1.1.3.5.cmml">n</mi><mo id="S5.T3.1.1.1.1.m1.1.1.3.1c" xref="S5.T3.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.T3.1.1.1.1.m1.1.1.3.6" xref="S5.T3.1.1.1.1.m1.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.1.m1.1b"><apply id="S5.T3.1.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.1.1.1.1.m1.1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S5.T3.1.1.1.1.m1.1.1.2.cmml" xref="S5.T3.1.1.1.1.m1.1.1.2">𝐹</ci><apply id="S5.T3.1.1.1.1.m1.1.1.3.cmml" xref="S5.T3.1.1.1.1.m1.1.1.3"><times id="S5.T3.1.1.1.1.m1.1.1.3.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1.3.1"></times><ci id="S5.T3.1.1.1.1.m1.1.1.3.2.cmml" xref="S5.T3.1.1.1.1.m1.1.1.3.2">𝑝</ci><ci id="S5.T3.1.1.1.1.m1.1.1.3.3.cmml" xref="S5.T3.1.1.1.1.m1.1.1.3.3">𝑟</ci><ci id="S5.T3.1.1.1.1.m1.1.1.3.4.cmml" xref="S5.T3.1.1.1.1.m1.1.1.3.4">𝑢</ci><ci id="S5.T3.1.1.1.1.m1.1.1.3.5.cmml" xref="S5.T3.1.1.1.1.m1.1.1.3.5">𝑛</ci><ci id="S5.T3.1.1.1.1.m1.1.1.3.6.cmml" xref="S5.T3.1.1.1.1.m1.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.1.m1.1c">F_{prune}</annotation><annotation encoding="application/x-llamapun" id="S5.T3.1.1.1.1.m1.1d">italic_F start_POSTSUBSCRIPT italic_p italic_r italic_u italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math>) (♠5)</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.1.1.2">2227</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.1.1.3">50.3</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.3.3">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.3.3.3.2">+VLTP@Finetune (<math alttext="F_{dec}" class="ltx_Math" display="inline" id="S5.T3.2.2.2.1.m1.1"><semantics id="S5.T3.2.2.2.1.m1.1a"><msub id="S5.T3.2.2.2.1.m1.1.1" xref="S5.T3.2.2.2.1.m1.1.1.cmml"><mi id="S5.T3.2.2.2.1.m1.1.1.2" xref="S5.T3.2.2.2.1.m1.1.1.2.cmml">F</mi><mrow id="S5.T3.2.2.2.1.m1.1.1.3" xref="S5.T3.2.2.2.1.m1.1.1.3.cmml"><mi id="S5.T3.2.2.2.1.m1.1.1.3.2" xref="S5.T3.2.2.2.1.m1.1.1.3.2.cmml">d</mi><mo id="S5.T3.2.2.2.1.m1.1.1.3.1" xref="S5.T3.2.2.2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.T3.2.2.2.1.m1.1.1.3.3" xref="S5.T3.2.2.2.1.m1.1.1.3.3.cmml">e</mi><mo id="S5.T3.2.2.2.1.m1.1.1.3.1a" xref="S5.T3.2.2.2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.T3.2.2.2.1.m1.1.1.3.4" xref="S5.T3.2.2.2.1.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.1.m1.1b"><apply id="S5.T3.2.2.2.1.m1.1.1.cmml" xref="S5.T3.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.2.2.2.1.m1.1.1.1.cmml" xref="S5.T3.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S5.T3.2.2.2.1.m1.1.1.2.cmml" xref="S5.T3.2.2.2.1.m1.1.1.2">𝐹</ci><apply id="S5.T3.2.2.2.1.m1.1.1.3.cmml" xref="S5.T3.2.2.2.1.m1.1.1.3"><times id="S5.T3.2.2.2.1.m1.1.1.3.1.cmml" xref="S5.T3.2.2.2.1.m1.1.1.3.1"></times><ci id="S5.T3.2.2.2.1.m1.1.1.3.2.cmml" xref="S5.T3.2.2.2.1.m1.1.1.3.2">𝑑</ci><ci id="S5.T3.2.2.2.1.m1.1.1.3.3.cmml" xref="S5.T3.2.2.2.1.m1.1.1.3.3">𝑒</ci><ci id="S5.T3.2.2.2.1.m1.1.1.3.4.cmml" xref="S5.T3.2.2.2.1.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.1.m1.1c">F_{dec}</annotation><annotation encoding="application/x-llamapun" id="S5.T3.2.2.2.1.m1.1d">italic_F start_POSTSUBSCRIPT italic_d italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math> + <math alttext="F_{prune}" class="ltx_Math" display="inline" id="S5.T3.3.3.3.2.m2.1"><semantics id="S5.T3.3.3.3.2.m2.1a"><msub id="S5.T3.3.3.3.2.m2.1.1" xref="S5.T3.3.3.3.2.m2.1.1.cmml"><mi id="S5.T3.3.3.3.2.m2.1.1.2" xref="S5.T3.3.3.3.2.m2.1.1.2.cmml">F</mi><mrow id="S5.T3.3.3.3.2.m2.1.1.3" xref="S5.T3.3.3.3.2.m2.1.1.3.cmml"><mi id="S5.T3.3.3.3.2.m2.1.1.3.2" xref="S5.T3.3.3.3.2.m2.1.1.3.2.cmml">p</mi><mo id="S5.T3.3.3.3.2.m2.1.1.3.1" xref="S5.T3.3.3.3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.T3.3.3.3.2.m2.1.1.3.3" xref="S5.T3.3.3.3.2.m2.1.1.3.3.cmml">r</mi><mo id="S5.T3.3.3.3.2.m2.1.1.3.1a" xref="S5.T3.3.3.3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.T3.3.3.3.2.m2.1.1.3.4" xref="S5.T3.3.3.3.2.m2.1.1.3.4.cmml">u</mi><mo id="S5.T3.3.3.3.2.m2.1.1.3.1b" xref="S5.T3.3.3.3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.T3.3.3.3.2.m2.1.1.3.5" xref="S5.T3.3.3.3.2.m2.1.1.3.5.cmml">n</mi><mo id="S5.T3.3.3.3.2.m2.1.1.3.1c" xref="S5.T3.3.3.3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.T3.3.3.3.2.m2.1.1.3.6" xref="S5.T3.3.3.3.2.m2.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.2.m2.1b"><apply id="S5.T3.3.3.3.2.m2.1.1.cmml" xref="S5.T3.3.3.3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.T3.3.3.3.2.m2.1.1.1.cmml" xref="S5.T3.3.3.3.2.m2.1.1">subscript</csymbol><ci id="S5.T3.3.3.3.2.m2.1.1.2.cmml" xref="S5.T3.3.3.3.2.m2.1.1.2">𝐹</ci><apply id="S5.T3.3.3.3.2.m2.1.1.3.cmml" xref="S5.T3.3.3.3.2.m2.1.1.3"><times id="S5.T3.3.3.3.2.m2.1.1.3.1.cmml" xref="S5.T3.3.3.3.2.m2.1.1.3.1"></times><ci id="S5.T3.3.3.3.2.m2.1.1.3.2.cmml" xref="S5.T3.3.3.3.2.m2.1.1.3.2">𝑝</ci><ci id="S5.T3.3.3.3.2.m2.1.1.3.3.cmml" xref="S5.T3.3.3.3.2.m2.1.1.3.3">𝑟</ci><ci id="S5.T3.3.3.3.2.m2.1.1.3.4.cmml" xref="S5.T3.3.3.3.2.m2.1.1.3.4">𝑢</ci><ci id="S5.T3.3.3.3.2.m2.1.1.3.5.cmml" xref="S5.T3.3.3.3.2.m2.1.1.3.5">𝑛</ci><ci id="S5.T3.3.3.3.2.m2.1.1.3.6.cmml" xref="S5.T3.3.3.3.2.m2.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.2.m2.1c">F_{prune}</annotation><annotation encoding="application/x-llamapun" id="S5.T3.3.3.3.2.m2.1d">italic_F start_POSTSUBSCRIPT italic_p italic_r italic_u italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math>) (♠9)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.3.3.3">2227</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.3.3.4"><span class="ltx_text ltx_font_bold" id="S5.T3.3.3.3.4.1">60.1</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.2">We selected LLaVA 7B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib28" title="">28</a>]</cite> to serve as MLLM. LLaVA processes both textual tasks and images as inputs to produce reasoning guidance <math alttext="\langle" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mo id="S5.SS2.p1.1.m1.1.1" stretchy="false" xref="S5.SS2.p1.1.m1.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">⟨</annotation></semantics></math><span class="ltx_text" id="S5.SS2.p1.2.1">SEG</span><math alttext="\rangle" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><mo id="S5.SS2.p1.2.m2.1.1" stretchy="false" xref="S5.SS2.p1.2.m2.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><ci id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">⟩</annotation></semantics></math>. For the segmentation model, we opted for SAM, a well-known foundation model that enables prompt-guided segmentation. Following previous research <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib37" title="">37</a>]</cite>, we perform end-to-end visual instruction fine-tuning on the entire system. For the LLaVA module, we utilize LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib14" title="">14</a>]</cite> for efficient fine-tuning, while for the SAM module, we freeze the ViT backbone and only train the mask decoder. <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.T2" title="In 5.2 Vision Language Fintuning ‣ 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">2</span></a> shows the reasoning segmentation accuracy of the entire system on the RIO dataset, along with a comparison to earlier studies. Compared to the SOTA method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib56" title="">56</a>]</cite>, guided by MLLM, the SAM with the ViT-H backbone model, exceeds it by 2.5% on RIO common parts and 3.3% on RIO uncommon parts. This result highlights the importance of integrating MLLM with the segmentation model in visual reasoning tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>VLTP Framework Setup</h3>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T4.2.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S5.T4.3.2" style="font-size:90%;">Pruning ratio exploration for SAM ViT-H. Here we assume the pruning position is at layer 16 and layer 24 and both layer’s pruning ratio is the same. All results are reported based on RIO common dataset.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T4.4" style="width:372.6pt;height:79.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-24.9pt,5.3pt) scale(0.88222400920174,0.88222400920174) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T4.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T4.4.1.1.1.1">Pruning Rate (%)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.4.1.1.1.2">50</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.4.1.1.1.3">70</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.4.1.1.1.4">70</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.4.1.1.1.5">80</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.4.1.1.1.6">80</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.4.1.1.1.7">90</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.4.1.1.1.8">90</th>
</tr>
<tr class="ltx_tr" id="S5.T4.4.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S5.T4.4.1.2.2.1">Training scheme</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T4.4.1.2.2.2">-</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T4.4.1.2.2.3">zero shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T4.4.1.2.2.4">finetune</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T4.4.1.2.2.5">zero shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T4.4.1.2.2.6">finetune</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T4.4.1.2.2.7">zero shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T4.4.1.2.2.8">finetune</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.4.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T4.4.1.3.1.1">GFLOPs</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.4.1.3.1.2">2227</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.4.1.3.1.3">1930</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.4.1.3.1.4"><span class="ltx_text ltx_font_bold" id="S5.T4.4.1.3.1.4.1">1930</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.4.1.3.1.5">1782</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.4.1.3.1.6"><span class="ltx_text ltx_font_bold" id="S5.T4.4.1.3.1.6.1">1782</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.4.1.3.1.7">1636</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.4.1.3.1.8">1636</td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.4.1.4.2.1">Common (%)</th>
<td class="ltx_td ltx_align_center" id="S5.T4.4.1.4.2.2">60.1</td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.1.4.2.3">57.1</td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.1.4.2.4"><span class="ltx_text ltx_font_bold" id="S5.T4.4.1.4.2.4.1">59.6</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.1.4.2.5">52.1</td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.1.4.2.6"><span class="ltx_text ltx_font_bold" id="S5.T4.4.1.4.2.6.1">59.4</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.1.4.2.7">39.76</td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.1.4.2.8">51.3</td>
</tr>
<tr class="ltx_tr" id="S5.T4.4.1.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T4.4.1.5.3.1">Uncommon (%)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.1.5.3.2">37.5</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.1.5.3.3">35</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.1.5.3.4"><span class="ltx_text ltx_font_bold" id="S5.T4.4.1.5.3.4.1">37.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.1.5.3.5">32.2</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.1.5.3.6"><span class="ltx_text ltx_font_bold" id="S5.T4.4.1.5.3.6.1">37.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.1.5.3.7">19.01</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.4.1.5.3.8">28.4</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="372" id="S5.F4.g1" src="x4.png" width="381"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S5.F4.3.2" style="font-size:90%;">Visualization of VLTP image patch pruning for SAM ViT-H at layers 16 and 24. Three distinct pruning rates (0.5, 0.7, and 0.8) are illustrated alongside the ground truth (GT) task-related image patches.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.2">To enhance the computational efficiency of SAM ViT, we integrate the prune decoder at different ViT layers. For SAM ViT-H, there are a total of 32 layers, with every 8 layers containing 7 layers of window attention and 1 layer of global attention. To more effectively model the relational importance between image tokens and reasoning <math alttext="\langle" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><mo id="S5.SS3.p1.1.m1.1.1" stretchy="false" xref="S5.SS3.p1.1.m1.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><ci id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">⟨</annotation></semantics></math><span class="ltx_text" id="S5.SS3.p1.2.1">SEG</span><math alttext="\rangle" class="ltx_Math" display="inline" id="S5.SS3.p1.2.m2.1"><semantics id="S5.SS3.p1.2.m2.1a"><mo id="S5.SS3.p1.2.m2.1.1" stretchy="false" xref="S5.SS3.p1.2.m2.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><ci id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">⟩</annotation></semantics></math>, we insert the prune decoder after the global attention layer. Consequently, for SAM ViT-H, we place the prune decoder at layers 8, 16, and 24. It’s important to note that the prune decoder only involves query embedding self-attention and two-way query embedding-to-image patch embedding cross-attention. <span class="ltx_text ltx_font_bold" id="S5.SS3.p1.2.2">Thus, its computation is merely 6 GFLOPs, significantly less than the computation of ViT-H, which exceeds 2900 GFLOPs.</span> Another crucial point is that there is only a single prune decoder model within the entire VLTP framework. However, due to the reactivation mechanism, the same prune decoder may be called at multiple layers.</p>
</div>
<figure class="ltx_table" id="S5.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T5.2.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="S5.T5.3.2" style="font-size:90%;">Investigation of SAM ViT-H pruning locations. The table presents the maximum accuracy and the most efficient outcome (measured in GFLOPs) for each pruning position combination. All outcomes are derived from the RIO common dataset. Each invocation of the prune decoder adds an additional 6 GFLOPs.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T5.4" style="width:175.6pt;height:142.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-33.9pt,27.6pt) scale(0.721171342359196,0.721171342359196) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T5.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.4.1.1.1.1">Position</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.4.1.1.1.2">Pruning Rate</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.4.1.1.1.3">GFLOPS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.4.1.1.1.4">mIoU (%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T5.4.1.2.1.1">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T5.4.1.2.1.2">{0}</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T5.4.1.2.1.3">2976</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T5.4.1.2.1.4">60.4</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.3.2.1">{8}</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.3.2.2">{20}</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.3.2.3">2529</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.3.2.4">59.8 (-0.6)</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.1.4.3">
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.4.3.1">{8}</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.4.3.2">{40}</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.4.3.3">2083</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.4.3.4">53.1 (-7.3)</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.5.4.1">{8, 16}</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.5.4.2">{20, 40}</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.5.4.3">2232</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.5.4.4">58.8 (-1.6)</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.1.6.5">
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.6.5.1">{8, 16}</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.6.5.2">{20, 60}</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.6.5.3">1783</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.6.5.4">53.7 (-6.7)</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.1.7.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.7.6.1">{16, 24}</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.7.6.2">{50, 50}</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.7.6.3">2227</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.7.6.4">60.1 (-0.3)</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.1.8.7">
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.8.7.1">{16, 24}</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.8.7.2">{80, 80}</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.8.7.3">1782</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.8.7.4">58.9 (-1.2)</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.1.9.8">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.9.8.1">{8, 16, 24}</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.9.8.2">{20, 40, 40}</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.9.8.3">2232</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.4.1.9.8.4">58.9 (-1.5)</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.1.10.9">
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.10.9.1">{8, 16, 24}</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.10.9.2">{20, 40, 60}</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.10.9.3">1853</td>
<td class="ltx_td ltx_align_center" id="S5.T5.4.1.10.9.4">53 (-7.4)</td>
</tr>
<tr class="ltx_tr" id="S5.T5.4.1.11.10">
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.4.1.11.10.1">{8, 16, 24}</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.4.1.11.10.2">{50, 50, 50}</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.4.1.11.10.3">1860</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.4.1.11.10.4">53.3 (-7.1)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.2"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.T3" title="In 5.2 Vision Language Fintuning ‣ 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">3</span></a> demonstrates the impact of different training strategies on final pruning outcomes. We assume a pruning rate of 50%, inserting the prune decoder at layers 16 and 24. This implies that starting from layer 16, only 50% of image tokens will be involved in the SAM ViT computation. The results indicate that when both <math alttext="F_{prune}" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><msub id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mi id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">F</mi><mrow id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml"><mi id="S5.SS3.p2.1.m1.1.1.3.2" xref="S5.SS3.p2.1.m1.1.1.3.2.cmml">p</mi><mo id="S5.SS3.p2.1.m1.1.1.3.1" xref="S5.SS3.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p2.1.m1.1.1.3.3" xref="S5.SS3.p2.1.m1.1.1.3.3.cmml">r</mi><mo id="S5.SS3.p2.1.m1.1.1.3.1a" xref="S5.SS3.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p2.1.m1.1.1.3.4" xref="S5.SS3.p2.1.m1.1.1.3.4.cmml">u</mi><mo id="S5.SS3.p2.1.m1.1.1.3.1b" xref="S5.SS3.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p2.1.m1.1.1.3.5" xref="S5.SS3.p2.1.m1.1.1.3.5.cmml">n</mi><mo id="S5.SS3.p2.1.m1.1.1.3.1c" xref="S5.SS3.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p2.1.m1.1.1.3.6" xref="S5.SS3.p2.1.m1.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2">𝐹</ci><apply id="S5.SS3.p2.1.m1.1.1.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3"><times id="S5.SS3.p2.1.m1.1.1.3.1.cmml" xref="S5.SS3.p2.1.m1.1.1.3.1"></times><ci id="S5.SS3.p2.1.m1.1.1.3.2.cmml" xref="S5.SS3.p2.1.m1.1.1.3.2">𝑝</ci><ci id="S5.SS3.p2.1.m1.1.1.3.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3.3">𝑟</ci><ci id="S5.SS3.p2.1.m1.1.1.3.4.cmml" xref="S5.SS3.p2.1.m1.1.1.3.4">𝑢</ci><ci id="S5.SS3.p2.1.m1.1.1.3.5.cmml" xref="S5.SS3.p2.1.m1.1.1.3.5">𝑛</ci><ci id="S5.SS3.p2.1.m1.1.1.3.6.cmml" xref="S5.SS3.p2.1.m1.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">F_{prune}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">italic_F start_POSTSUBSCRIPT italic_p italic_r italic_u italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="F_{dec}" class="ltx_Math" display="inline" id="S5.SS3.p2.2.m2.1"><semantics id="S5.SS3.p2.2.m2.1a"><msub id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mi id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">F</mi><mrow id="S5.SS3.p2.2.m2.1.1.3" xref="S5.SS3.p2.2.m2.1.1.3.cmml"><mi id="S5.SS3.p2.2.m2.1.1.3.2" xref="S5.SS3.p2.2.m2.1.1.3.2.cmml">d</mi><mo id="S5.SS3.p2.2.m2.1.1.3.1" xref="S5.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p2.2.m2.1.1.3.3" xref="S5.SS3.p2.2.m2.1.1.3.3.cmml">e</mi><mo id="S5.SS3.p2.2.m2.1.1.3.1a" xref="S5.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p2.2.m2.1.1.3.4" xref="S5.SS3.p2.2.m2.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">𝐹</ci><apply id="S5.SS3.p2.2.m2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3"><times id="S5.SS3.p2.2.m2.1.1.3.1.cmml" xref="S5.SS3.p2.2.m2.1.1.3.1"></times><ci id="S5.SS3.p2.2.m2.1.1.3.2.cmml" xref="S5.SS3.p2.2.m2.1.1.3.2">𝑑</ci><ci id="S5.SS3.p2.2.m2.1.1.3.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3.3">𝑒</ci><ci id="S5.SS3.p2.2.m2.1.1.3.4.cmml" xref="S5.SS3.p2.2.m2.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">F_{dec}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.2.m2.1d">italic_F start_POSTSUBSCRIPT italic_d italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math> are fine-tuned simultaneously, VLTP reduces the SAM ViT’s computation from 2976 GFLOPs to 2227 GFLOPs, yielding approximately a 25% reduction in GFLOPs with only a 0.3% drop in mIoU. Consequently, in the subsequent sections, both the prune decoder and mask decoder will be fine-tuned to achieve optimal pruning results.</p>
</div>
<figure class="ltx_table" id="S5.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T6.2.1.1" style="font-size:90%;">Table 6</span>: </span><span class="ltx_text" id="S5.T6.3.2" style="font-size:90%;">Ablation study for effect’s of pruned tokens reevaluation. Here the model is SAM ViT-H and dataset is RIO common. Each invo-
cation of the prune decoder adds an additional 6 GFLOPs.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T6.4" style="width:175.6pt;height:94.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-28.9pt,15.6pt) scale(0.752054680481633,0.752054680481633) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T6.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T6.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.4.1.1.1.1">Position</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.4.1.1.1.2">Pruning Rate</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.4.1.1.1.3">GFLOPS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T6.4.1.1.1.4">mIoU (%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T6.4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T6.4.1.2.1.1">{16}</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T6.4.1.2.1.2">{50}</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T6.4.1.2.1.3">2221</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T6.4.1.2.1.4">59.8</td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.1.3.2">
<td class="ltx_td ltx_align_center" id="S5.T6.4.1.3.2.1">{16, 24}</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.1.3.2.2">{50, 50}</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.1.3.2.3">2227</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.1.3.2.4">60.1 (+0.3)</td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.1.4.3.1">{16}</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.1.4.3.2">{70}</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.1.4.3.3">1923</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.1.4.3.4">58.2</td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.1.5.4">
<td class="ltx_td ltx_align_center" id="S5.T6.4.1.5.4.1">{16, 24}</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.1.5.4.2">{70, 70}</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.1.5.4.3">1930</td>
<td class="ltx_td ltx_align_center" id="S5.T6.4.1.5.4.4">59.6 (+1.4)</td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.1.6.5.1">{16}</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.1.6.5.2">{80}</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.1.6.5.3">1775</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.4.1.6.5.4">56.8</td>
</tr>
<tr class="ltx_tr" id="S5.T6.4.1.7.6">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.1.7.6.1">{16, 24}</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.1.7.6.2">{80, 80}</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.1.7.6.3">1782</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T6.4.1.7.6.4">59.4 (+2.6)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T7.2.1.1" style="font-size:90%;">Table 7</span>: </span><span class="ltx_text" id="S5.T7.3.2" style="font-size:90%;">A comparison of various pruning techniques. Each method is applied on SAM ViT-H. Random 50% indicates randomly dropping 50% of image tokens starting from layer 16.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T7.4" style="width:175.6pt;height:68.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-74.1pt,28.8pt) scale(0.542423231133515,0.542423231133515) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T7.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T7.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T7.4.1.1.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T7.4.1.1.1.2">VLM support</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T7.4.1.1.1.3">GFLOPs</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T7.4.1.1.1.4">mIoU</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T7.4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T7.4.1.2.1.1">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T7.4.1.2.1.2">No</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T7.4.1.2.1.3">2976</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T7.4.1.2.1.4">60.4 (-0)</td>
</tr>
<tr class="ltx_tr" id="S5.T7.4.1.3.2">
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.3.2.1">Random 50%</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.3.2.2">No</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.3.2.3">2297</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.3.2.4">38.2 (-22.2)</td>
</tr>
<tr class="ltx_tr" id="S5.T7.4.1.4.3">
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.4.3.1">CTS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib31" title="">31</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.4.3.2">No</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.4.3.3">2232</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.4.3.4">35.7 (-24.7)</td>
</tr>
<tr class="ltx_tr" id="S5.T7.4.1.5.4">
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.5.4.1">DToP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib44" title="">44</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.5.4.2">No</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.5.4.3">1892</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.5.4.4">36.3 (-24.1)</td>
</tr>
<tr class="ltx_tr" id="S5.T7.4.1.6.5">
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.6.5.1">SViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib30" title="">30</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.6.5.2">No</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.6.5.3">1935</td>
<td class="ltx_td ltx_align_center" id="S5.T7.4.1.6.5.4">33.5 (-26.9)</td>
</tr>
<tr class="ltx_tr" id="S5.T7.4.1.7.6">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T7.4.1.7.6.1"><span class="ltx_text ltx_font_bold" id="S5.T7.4.1.7.6.1.1">VLTP (this work)</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T7.4.1.7.6.2"><span class="ltx_text ltx_font_bold" id="S5.T7.4.1.7.6.2.1">Yes</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T7.4.1.7.6.3"><span class="ltx_text ltx_font_bold" id="S5.T7.4.1.7.6.3.1">1782</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T7.4.1.7.6.4"><span class="ltx_text ltx_font_bold" id="S5.T7.4.1.7.6.4.1">59.4 (-1.0)</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T8.2.1.1" style="font-size:90%;">Table 8</span>: </span><span class="ltx_text" id="S5.T8.3.2" style="font-size:90%;">Main results on two different TOS benchmarks.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T8.4" style="width:397.5pt;height:122.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-34.5pt,10.6pt) scale(0.852186412027801,0.852186412027801) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T8.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T8.4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T8.4.1.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T8.4.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T8.4.1.1.1.2" rowspan="2"><span class="ltx_text" id="S5.T8.4.1.1.1.2.1">pruning rate</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T8.4.1.1.1.3">RIO common</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T8.4.1.1.1.4">RIO uncommon</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T8.4.1.1.1.5">COCO-Tasks</th>
</tr>
<tr class="ltx_tr" id="S5.T8.4.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T8.4.1.2.2.1">mIoU(%)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T8.4.1.2.2.2">GFLOPs</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T8.4.1.2.2.3">mIoU(%)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T8.4.1.2.2.4">GFLOPs</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T8.4.1.2.2.5">mIoU(%)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T8.4.1.2.2.6">GFLOPs</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T8.4.1.3.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T8.4.1.3.1.1">SAM ViT-H</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T8.4.1.3.1.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T8.4.1.3.1.3">60.4</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T8.4.1.3.1.4">2976</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T8.4.1.3.1.5">37.2</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T8.4.1.3.1.6">2976</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T8.4.1.3.1.7">44.6</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T8.4.1.3.1.8">2976</td>
</tr>
<tr class="ltx_tr" id="S5.T8.4.1.4.2">
<td class="ltx_td ltx_align_left" id="S5.T8.4.1.4.2.1">VLTP@Finetune</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.4.2.2">0.5</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.4.2.3">60.1</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.4.2.4">2227</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.4.2.5">37.5</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.4.2.6">2224</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.4.2.7">44.2</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.4.2.8">2219</td>
</tr>
<tr class="ltx_tr" id="S5.T8.4.1.5.3">
<td class="ltx_td ltx_align_left" id="S5.T8.4.1.5.3.1">VLTP@Finetune</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.5.3.2">0.8</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.5.3.3">59.4</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.5.3.4">1782</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.5.3.5">37.6</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.5.3.6">1774</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.5.3.7">43.2</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.5.3.8">1771</td>
</tr>
<tr class="ltx_tr" id="S5.T8.4.1.6.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T8.4.1.6.4.1">SAM ViT-L</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.4.1.6.4.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.4.1.6.4.3">55.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.4.1.6.4.4">1491</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.4.1.6.4.5">32.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.4.1.6.4.6">1491</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.4.1.6.4.7">40.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.4.1.6.4.8">1491</td>
</tr>
<tr class="ltx_tr" id="S5.T8.4.1.7.5">
<td class="ltx_td ltx_align_left" id="S5.T8.4.1.7.5.1">VLTP@Finetune</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.7.5.2">0.5</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.7.5.3">55.1</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.7.5.4">1118</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.7.5.5">32.1</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.7.5.6">1121</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.7.5.7">39.6</td>
<td class="ltx_td ltx_align_center" id="S5.T8.4.1.7.5.8">1127</td>
</tr>
<tr class="ltx_tr" id="S5.T8.4.1.8.6">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T8.4.1.8.6.1">VLTP@Finetune</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T8.4.1.8.6.2">0.8</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T8.4.1.8.6.3">54.3</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T8.4.1.8.6.4">895</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T8.4.1.8.6.5">31.4</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T8.4.1.8.6.6">901</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T8.4.1.8.6.7">38.7</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T8.4.1.8.6.8">905</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Exploration of Pruning Rate and Position</h3>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="338" id="S5.F5.g1" src="x5.png" width="380"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.2.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S5.F5.3.2" style="font-size:90%;">Visualization of VLTP image patch pruning for SAM ViT-H at layers 8, 16, and 24 along with the ground truth (GT). The pruning rate is 0.7.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S5.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="281" id="S5.F6.g1" src="x6.png" width="951"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.2.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S5.F6.3.2" style="font-size:90%;">Visualized results. The segmentation results are predicted on RIO (left) and COCO-Tasks (right). The model is SAM ViT-H under the guidance of LLaVA 7B with VLTP@Finetune. We set the pruning position at layers 16 and 24 with the pruning rate as 50%.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.T4" title="In 5.3 VLTP Framework Setup ‣ 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">4</span></a> illustrates the effects of pruning as the pruning rate <math alttext="r_{m}" class="ltx_Math" display="inline" id="S5.SS4.p1.1.m1.1"><semantics id="S5.SS4.p1.1.m1.1a"><msub id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mi id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml">r</mi><mi id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2">𝑟</ci><ci id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">r_{m}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.1.m1.1d">italic_r start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> increases. In this study, we set the pruning positions of SAM ViT at layers 16 and 24. Instead of finetuning the pruning and mask decoders from scratch, we base our experiments on a pre-trained model with a 50% pruning rate, as depicted in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.T3" title="In 5.2 Vision Language Fintuning ‣ 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a>. Initially, we increase the pruning rate without any finetuning, and the results in <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.T4" title="In 5.3 VLTP Framework Setup ‣ 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">4</span></a> indicate an accuracy drop. Consequently, we subsequently finetune both the prune decoder and mask decoder together after adjusting the pruning rate. The experiment demonstrates that VLTP achieves approximately 35% GFLOPs with just a 0.8% mIoU reduction at a 70% pruning rate, and around 40% GFLOPs with only a 1% mIoU reduction at an 80% pruning rate, compared to the original SAM ViT-H. Additionally, we display the image patch-dropping visual results in  <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.F4" title="In 5.3 VLTP Framework Setup ‣ 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>. Under MLLM guidance, VLTP retains the most essential image patches while freezing irrelevant ones, in comparison to the ground truth.</p>
</div>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">In <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.T5" title="In 5.3 VLTP Framework Setup ‣ 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">5</span></a>, we illustrate the influence of different pruning positions on the ultimate pruning accuracy. The findings suggest that initiating pruning from layer 8 leads to a greater accuracy reduction compared to starting from layer 16, assuming the same level of ViT computation reduction. We attribute this to inadequate image feature extraction. Image patches that aren’t directly pertinent to reasoning tasks still contribute to the final mask generation. Consequently, removing these patches at an earlier layer can negatively impact the final mask generation.  <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.F5" title="In 5.4 Exploration of Pruning Rate and Position ‣ 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5</span></a> visualizes the patch dropping at various layer positions.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Ablation Study and Final Results</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.T6" title="In 5.3 VLTP Framework Setup ‣ 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">6</span></a> illustrates the impact of reevaluating pruned image tokens. We compare the final reasoning segmentation accuracy between pruning only at layer 16 and pruning at both layer 16 and layer 24. Reassessing token relevance at layer 24 enhances the accuracy of the final reasoning. This is due to the prune decoder potentially making incorrect predictions about the relevance of image tokens to the reasoning task at earlier stages. Hence, it is crucial to reassess the importance of these tokens at deeper ViT layers.</p>
</div>
<div class="ltx_para" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.1">In <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.T7" title="In 5.3 VLTP Framework Setup ‣ 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">7</span></a>, we compare various pruning methods for task-oriented reasoning tasks. Although prior research <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib44" title="">44</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib30" title="">30</a>]</cite> has shown effectiveness in pruning ViTs for traditional semantic or instance segmentation tasks, these methods are not suitable for TOS as they lack vision-language guidance. For instance, the policy network in CTS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib31" title="">31</a>]</cite> is unable to accurately predict whether four image tokens belong to the same semantic class because each token’s class can change depending on the reasoning task. Consequently, the pruning networks proposed in DToP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib44" title="">44</a>]</cite> and SViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#bib.bib30" title="">30</a>]</cite> are also ineffective as they do not incorporate reasoning guidance. VLTP addresses these limitations by integrating both ViT image tokens and MLLM reasoning guidance, thus achieving superior performance.</p>
</div>
<div class="ltx_para" id="S5.SS5.p3">
<p class="ltx_p" id="S5.SS5.p3.1">In <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.T8" title="In 5.3 VLTP Framework Setup ‣ 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">8</span></a>, we provide a summary of the results when applying VLTP to SAM ViT-H and SAM ViT-L for the RIO common, RIO uncommon, and COCO-Tasks datasets. VLTP effectively maintains task-relevant image tokens while significantly reducing SAM ViT’s computational costs. On average, VLTP reduces SAM ViT’s computation by 40% with only a 1% loss in mIoU. <a class="ltx_ref" href="https://arxiv.org/html/2409.08464v1#S5.F6" title="In 5.4 Exploration of Pruning Rate and Position ‣ 5 Experiments ‣ VLTP: Vision-Language Guided Token Pruning for Task-Oriented Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">6</span></a> showcases our framework’s segmentation visualized results on the RIO and COCO-Task datasets.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this work, we present a technique for vision language-guided token pruning in ViTs dedicated to TOS. Recognizing that not every image token needs to be processed by all layers of the ViT, we introduce a novel prune decoder to estimate the relevance of each image patch token to the reasoning task. After evaluation, we retain those image tokens with high relevance to the task and skip the rest. To mitigate incorrect predictions in the initial ViT layers, we also propose a reactivation mechanism that reassesses the relevance of all image tokens to the task. Comprehensive experimental results indicate that our method enhances model efficiency by significantly reducing the computational load of ViTs while producing state-of-the-art segmentation results.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This work was supported in part by the DARPA Young Faculty Award, the National Science Foundation (NSF) under Grants #2127780, #2319198, #2321840, #2312517, and #2235472, the Semiconductor Research Corporation (SRC), the Office of Naval Research through the Young Investigator Program Award, and Grants #N00014-21-1-2225 and N00014-22-1-2067. Additionally, support was provided by the Air Force Office of Scientific Research under Award #FA9550-22-1-0253, along with generous gifts from Xilinx and Cisco.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.1.1" style="font-size:90%;">
JL Ba.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.2.1" style="font-size:90%;">Layer normalization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib1.3.1" style="font-size:90%;">arXiv preprint arXiv:1607.06450</span><span class="ltx_text" id="bib.bib1.4.2" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.1.1" style="font-size:90%;">
Daniel Bolya, Chong Zhou, Fanyi Xiao, and Yong Jae Lee.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.2.1" style="font-size:90%;">Yolact: Real-time instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib2.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF international conference on computer vision</span><span class="ltx_text" id="bib.bib2.5.3" style="font-size:90%;">, pages 9157–9166, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.1.1" style="font-size:90%;">
Holger Caesar, Jasper Uijlings, and Vittorio Ferrari.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.2.1" style="font-size:90%;">Coco-stuff: Thing and stuff classes in context.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib3.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib3.5.3" style="font-size:90%;">, pages 1209–1218, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.1.1" style="font-size:90%;">
Mathilde Caron, Hugo Touvron, Ishan Misra, Hervé Jégou, Julien Mairal, Piotr Bojanowski, and Armand Joulin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.2.1" style="font-size:90%;">Emerging properties in self-supervised vision transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib4.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF international conference on computer vision</span><span class="ltx_text" id="bib.bib4.5.3" style="font-size:90%;">, pages 9650–9660, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.1.1" style="font-size:90%;">
Feiyang Chen, Ziqian Luo, Lisang Zhou, Xueting Pan, and Ying Jiang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.2.1" style="font-size:90%;">Comprehensive survey of model compression and speed up for vision transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.3.1" style="font-size:90%;">arXiv preprint arXiv:2404.10407</span><span class="ltx_text" id="bib.bib5.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.1.1" style="font-size:90%;">
Hanning Chen, Wenjun Huang, Yang Ni, Sanggeon Yun, Fei Wen, Hugo Latapie, and Mohsen Imani.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.2.1" style="font-size:90%;">Taskclip: Extend large vision-language model for task oriented object detection.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib6.3.1" style="font-size:90%;">arXiv preprint arXiv:2403.08108</span><span class="ltx_text" id="bib.bib6.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.1.1" style="font-size:90%;">
Bowen Cheng, Alex Schwing, and Alexander Kirillov.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.2.1" style="font-size:90%;">Per-pixel classification is not all you need for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib7.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib7.4.2" style="font-size:90%;">, 34:17864–17875, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.1.1" style="font-size:90%;">
Claudia Cuttano, Gabriele Rosi, Gabriele Trivigno, and Giuseppe Averta.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.2.1" style="font-size:90%;">What does clip know about peeling a banana?
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib8.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib8.5.3" style="font-size:90%;">, pages 2238–2247, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.1.1" style="font-size:90%;">
Alexey DOSOVITSKIY.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.2.1" style="font-size:90%;">An image is worth 16x16 words: Transformers for image recognition at scale.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib9.3.1" style="font-size:90%;">arXiv preprint arXiv:2010.11929</span><span class="ltx_text" id="bib.bib9.4.2" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.1.1" style="font-size:90%;">
Jun Han and Claudio Moraga.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.2.1" style="font-size:90%;">The influence of the sigmoid function parameters on the speed of backpropagation learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib10.4.2" style="font-size:90%;">International workshop on artificial neural networks</span><span class="ltx_text" id="bib.bib10.5.3" style="font-size:90%;">, pages 195–201. Springer, 1995.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.1.1" style="font-size:90%;">
Junjie He, Pengyu Li, Yifeng Geng, and Xuansong Xie.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.2.1" style="font-size:90%;">Fastinst: A simple query-based model for real-time instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib11.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib11.5.3" style="font-size:90%;">, pages 23663–23672, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.1.1" style="font-size:90%;">
Kaiming He, Xinlei Chen, Saining Xie, Yanghao Li, Piotr Dollár, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.2.1" style="font-size:90%;">Masked autoencoders are scalable vision learners.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib12.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib12.5.3" style="font-size:90%;">, pages 16000–16009, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.1.1" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.2.1" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib13.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib13.5.3" style="font-size:90%;">, pages 770–778, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.1.1" style="font-size:90%;">
Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.2.1" style="font-size:90%;">Lora: Low-rank adaptation of large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.3.1" style="font-size:90%;">arXiv preprint arXiv:2106.09685</span><span class="ltx_text" id="bib.bib14.4.2" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.1.1" style="font-size:90%;">
Wenjun Huang, Yang Ni, Arghavan Rezvani, SungHeon Jeong, Hanning Chen, Yezi Liu, Fei Wen, and Mohsen Imani.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.2.1" style="font-size:90%;">Recoverable anonymization for pose estimation: A privacy-enhancing approach.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.3.1" style="font-size:90%;">arXiv preprint arXiv:2409.02715</span><span class="ltx_text" id="bib.bib15.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.1.1" style="font-size:90%;">
Wenjun Huang, Arghavan Rezvani, Hanning Chen, Yang Ni, Sanggeon Yun, Sungheon Jeong, Guangyi Zhang, and Mohsen Imani.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.2.1" style="font-size:90%;">Intelligent sensing framework: Near-sensor machine learning for efficient data transmission.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.3.1" style="font-size:90%;">IEEE Sensors Journal</span><span class="ltx_text" id="bib.bib16.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.1.1" style="font-size:90%;">
Shruti Jadon.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.2.1" style="font-size:90%;">A survey of loss functions for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib17.4.2" style="font-size:90%;">2020 IEEE conference on computational intelligence in bioinformatics and computational biology (CIBCB)</span><span class="ltx_text" id="bib.bib17.5.3" style="font-size:90%;">, pages 1–7. IEEE, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.1.1" style="font-size:90%;">
Du Jiang, Gongfa Li, Chong Tan, Li Huang, Ying Sun, and Jianyi Kong.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.2.1" style="font-size:90%;">Semantic segmentation for multiscale target based on object recognition using the improved faster-rcnn model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib18.3.1" style="font-size:90%;">Future Generation Computer Systems</span><span class="ltx_text" id="bib.bib18.4.2" style="font-size:90%;">, 123:94–104, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.1.1" style="font-size:90%;">
Aishwarya Kamath, Mannat Singh, Yann LeCun, Gabriel Synnaeve, Ishan Misra, and Nicolas Carion.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.2.1" style="font-size:90%;">Mdetr-modulated detection for end-to-end multi-modal understanding.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib19.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF international conference on computer vision</span><span class="ltx_text" id="bib.bib19.5.3" style="font-size:90%;">, pages 1780–1790, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.1.1" style="font-size:90%;">
Angelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and François Fleuret.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.2.1" style="font-size:90%;">Transformers are rnns: Fast autoregressive transformers with linear attention.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib20.4.2" style="font-size:90%;">International conference on machine learning</span><span class="ltx_text" id="bib.bib20.5.3" style="font-size:90%;">, pages 5156–5165. PMLR, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.1.1" style="font-size:90%;">
Salman Khan, Muzammal Naseer, Munawar Hayat, Syed Waqas Zamir, Fahad Shahbaz Khan, and Mubarak Shah.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.2.1" style="font-size:90%;">Transformers in vision: A survey.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.3.1" style="font-size:90%;">ACM computing surveys (CSUR)</span><span class="ltx_text" id="bib.bib21.4.2" style="font-size:90%;">, 54(10s):1–41, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.1.1" style="font-size:90%;">
Alexander Kirillov, Eric Mintun, Nikhila Ravi, Hanzi Mao, Chloe Rolland, Laura Gustafson, Tete Xiao, Spencer Whitehead, Alexander C Berg, Wan-Yen Lo, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.2.1" style="font-size:90%;">Segment anything.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib22.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib22.5.3" style="font-size:90%;">, pages 4015–4026, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.1.1" style="font-size:90%;">
Zhenglun Kong, Peiyan Dong, Xiaolong Ma, Xin Meng, Wei Niu, Mengshu Sun, Xuan Shen, Geng Yuan, Bin Ren, Hao Tang, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.2.1" style="font-size:90%;">Spvit: Enabling faster vision transformers via latency-aware soft token pruning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib23.4.2" style="font-size:90%;">European conference on computer vision</span><span class="ltx_text" id="bib.bib23.5.3" style="font-size:90%;">, pages 620–640. Springer, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.1.1" style="font-size:90%;">
Xin Lai, Zhuotao Tian, Yukang Chen, Yanwei Li, Yuhui Yuan, Shu Liu, and Jiaya Jia.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.2.1" style="font-size:90%;">Lisa: Reasoning segmentation via large language model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib24.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib24.5.3" style="font-size:90%;">, pages 9579–9589, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.1.1" style="font-size:90%;">
Pengfei Li, Beiwen Tian, Yongliang Shi, Xiaoxue Chen, Hao Zhao, Guyue Zhou, and Ya-Qin Zhang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.2.1" style="font-size:90%;">Toist: Task oriented instance segmentation transformer with noun-pronoun distillation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib25.3.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib25.4.2" style="font-size:90%;">, 35:17597–17611, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.1.1" style="font-size:90%;">
Zhikai Li and Qingyi Gu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.2.1" style="font-size:90%;">I-vit: Integer-only quantization for efficient vision transformer inference.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib26.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib26.5.3" style="font-size:90%;">, pages 17065–17075, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.1.1" style="font-size:90%;">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva Ramanan, Piotr Dollár, and C Lawrence Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.2.1" style="font-size:90%;">Microsoft coco: Common objects in context.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib27.4.2" style="font-size:90%;">Computer Vision–ECCV 2014: 13th European Conference, Zurich, Switzerland, September 6-12, 2014, Proceedings, Part V 13</span><span class="ltx_text" id="bib.bib27.5.3" style="font-size:90%;">, pages 740–755. Springer, 2014.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.1.1" style="font-size:90%;">
Haotian Liu, Chunyuan Li, Qingyang Wu, and Yong Jae Lee.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.2.1" style="font-size:90%;">Visual instruction tuning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib28.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib28.4.2" style="font-size:90%;">, 36, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.1.1" style="font-size:90%;">
Jiang Liu, Hui Ding, Zhaowei Cai, Yuting Zhang, Ravi Kumar Satzoda, Vijay Mahadevan, and R Manmatha.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.2.1" style="font-size:90%;">Polyformer: Referring image segmentation as sequential polygon generation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib29.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib29.5.3" style="font-size:90%;">, pages 18653–18663, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.1.1" style="font-size:90%;">
Yifei Liu, Mathias Gehrig, Nico Messikommer, Marco Cannici, and Davide Scaramuzza.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.2.1" style="font-size:90%;">Revisiting token pruning for object detection and instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib30.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision</span><span class="ltx_text" id="bib.bib30.5.3" style="font-size:90%;">, pages 2658–2668, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.1.1" style="font-size:90%;">
Chenyang Lu, Daan de Geus, and Gijs Dubbelman.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.2.1" style="font-size:90%;">Content-aware token sharing for efficient semantic segmentation with vision transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib31.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib31.5.3" style="font-size:90%;">, pages 23631–23640, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.1.1" style="font-size:90%;">
Jiasen Lu, Vedanuj Goswami, Marcus Rohrbach, Devi Parikh, and Stefan Lee.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.2.1" style="font-size:90%;">12-in-1: Multi-task vision and language representation learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib32.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib32.5.3" style="font-size:90%;">, pages 10437–10446, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.1.1" style="font-size:90%;">
Chuofan Ma, Yi Jiang, Jiannan Wu, Zehuan Yuan, and Xiaojuan Qi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.2.1" style="font-size:90%;">Groma: Localized visual tokenization for grounding multimodal large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib33.3.1" style="font-size:90%;">arXiv preprint arXiv:2404.13013</span><span class="ltx_text" id="bib.bib33.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.1.1" style="font-size:90%;">
Tanvir Mahmud, Burhaneddin Yaman, Chun-Hao Liu, and Diana Marculescu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.2.1" style="font-size:90%;">Papr: Training-free one-step patch pruning with lightweight convnets for faster inference.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib34.3.1" style="font-size:90%;">arXiv preprint arXiv:2403.16020</span><span class="ltx_text" id="bib.bib34.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.1.1" style="font-size:90%;">
Roozbeh Mottaghi, Xianjie Chen, Xiaobai Liu, Nam-Gyu Cho, Seong-Whan Lee, Sanja Fidler, Raquel Urtasun, and Alan Yuille.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.2.1" style="font-size:90%;">The role of context for object detection and semantic segmentation in the wild.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib35.4.2" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib35.5.3" style="font-size:90%;">, pages 891–898, 2014.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.2.1" style="font-size:90%;">
Bowen Pan, Rameswar Panda, Yifan Jiang, Zhangyang Wang, Rogerio Feris, and Aude Oliva.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.3.1" style="font-size:90%;">Ia-red</span><sup class="ltx_sup" id="bib.bib36.4.2"><span class="ltx_text" id="bib.bib36.4.2.1" style="font-size:90%;">2</span></sup><span class="ltx_text" id="bib.bib36.5.3" style="font-size:90%;">: Interpretability-aware redundancy reduction for vision transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib36.6.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib36.7.2" style="font-size:90%;">, 34:24898–24911, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.1.1" style="font-size:90%;">
Shengyi Qian, Weifeng Chen, Min Bai, Xiong Zhou, Zhuowen Tu, and Li Erran Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.2.1" style="font-size:90%;">Affordancellm: Grounding affordance from vision language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib37.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib37.5.3" style="font-size:90%;">, pages 7587–7597, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.1.1" style="font-size:90%;">
Mengxue Qu, Yu Wu, Wu Liu, Xiaodan Liang, Jingkuan Song, Yao Zhao, and Yunchao Wei.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.2.1" style="font-size:90%;">Rio: A benchmark for reasoning intention-oriented objects in open environments.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib38.3.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib38.4.2" style="font-size:90%;">, 36, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.1.1" style="font-size:90%;">
Yongming Rao, Wenliang Zhao, Benlin Liu, Jiwen Lu, Jie Zhou, and Cho-Jui Hsieh.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.2.1" style="font-size:90%;">Dynamicvit: Efficient vision transformers with dynamic token sparsification.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib39.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib39.4.2" style="font-size:90%;">, 34:13937–13949, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.1.1" style="font-size:90%;">
Johann Sawatzky, Yaser Souri, Christian Grund, and Jurgen Gall.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.2.1" style="font-size:90%;">What object should i use?-task driven object detection.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib40.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span class="ltx_text" id="bib.bib40.5.3" style="font-size:90%;">, pages 7605–7614, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.1.1" style="font-size:90%;">
Yuzhang Shang, Mu Cai, Bingxin Xu, Yong Jae Lee, and Yan Yan.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.2.1" style="font-size:90%;">Llava-prumerge: Adaptive token reduction for efficient large multimodal models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib41.3.1" style="font-size:90%;">arXiv preprint arXiv:2403.15388</span><span class="ltx_text" id="bib.bib41.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.1.1" style="font-size:90%;">
Robin Strudel, Ricardo Garcia, Ivan Laptev, and Cordelia Schmid.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.2.1" style="font-size:90%;">Segmenter: Transformer for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib42.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF international conference on computer vision</span><span class="ltx_text" id="bib.bib42.5.3" style="font-size:90%;">, pages 7262–7272, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.1.1" style="font-size:90%;">
Jiajin Tang, Ge Zheng, Jingyi Yu, and Sibei Yang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.2.1" style="font-size:90%;">Cotdet: Affordance knowledge prompting for task driven object detection.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib43.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib43.5.3" style="font-size:90%;">, pages 3068–3078, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.1.1" style="font-size:90%;">
Quan Tang, Bowen Zhang, Jiajun Liu, Fagui Liu, and Yifan Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.2.1" style="font-size:90%;">Dynamic token pruning in plain vision transformers for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib44.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</span><span class="ltx_text" id="bib.bib44.5.3" style="font-size:90%;">, pages 777–786, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.1.1" style="font-size:90%;">
A Vaswani.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.2.1" style="font-size:90%;">Attention is all you need.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib45.3.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib45.4.2" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.1.1" style="font-size:90%;">
Xudong Wang, Rohit Girdhar, Stella X Yu, and Ishan Misra.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.2.1" style="font-size:90%;">Cut and learn for unsupervised object detection and instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib46.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib46.5.3" style="font-size:90%;">, pages 3124–3134, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.1.1" style="font-size:90%;">
Yuqing Wang, Zhaoliang Xu, Xinlong Wang, Chunhua Shen, Baoshan Cheng, Hao Shen, and Huaxia Xia.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.2.1" style="font-size:90%;">End-to-end video instance segmentation with transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib47.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib47.5.3" style="font-size:90%;">, pages 8741–8750, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.1.1" style="font-size:90%;">
Enze Xie, Wenhai Wang, Zhiding Yu, Anima Anandkumar, Jose M Alvarez, and Ping Luo.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.2.1" style="font-size:90%;">Segformer: Simple and efficient design for semantic segmentation with transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib48.3.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib48.4.2" style="font-size:90%;">, 34:12077–12090, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.1.1" style="font-size:90%;">
Cilin Yan, Haochen Wang, Shilin Yan, Xiaolong Jiang, Yao Hu, Guoliang Kang, Weidi Xie, and Efstratios Gavves.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.2.1" style="font-size:90%;">Visa: Reasoning video object segmentation via large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib49.3.1" style="font-size:90%;">arXiv preprint arXiv:2407.11325</span><span class="ltx_text" id="bib.bib49.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.1.1" style="font-size:90%;">
Huanrui Yang, Hongxu Yin, Maying Shen, Pavlo Molchanov, Hai Li, and Jan Kautz.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.2.1" style="font-size:90%;">Global vision transformer pruning with hessian-aware saliency.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib50.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib50.5.3" style="font-size:90%;">, pages 18547–18557, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.1.1" style="font-size:90%;">
Xubing Ye, Yukang Gan, Xiaoke Huang, Yixiao Ge, Ying Shan, and Yansong Tang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.2.1" style="font-size:90%;">Voco-llama: Towards vision compression with large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib51.3.1" style="font-size:90%;">arXiv preprint arXiv:2406.12275</span><span class="ltx_text" id="bib.bib51.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.1.1" style="font-size:90%;">
Hongxu Yin, Arash Vahdat, Jose M Alvarez, Arun Mallya, Jan Kautz, and Pavlo Molchanov.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.2.1" style="font-size:90%;">A-vit: Adaptive tokens for efficient vision transformer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib52.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib52.5.3" style="font-size:90%;">, pages 10809–10818, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.1.1" style="font-size:90%;">
Licheng Yu, Patrick Poirson, Shan Yang, Alexander C Berg, and Tamara L Berg.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.2.1" style="font-size:90%;">Modeling context in referring expressions.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib53.4.2" style="font-size:90%;">Computer Vision–ECCV 2016: 14th European Conference, Amsterdam, The Netherlands, October 11-14, 2016, Proceedings, Part II 14</span><span class="ltx_text" id="bib.bib53.5.3" style="font-size:90%;">, pages 69–85. Springer, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.1.1" style="font-size:90%;">
Guangyi Zhang and Wenjun Huang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.2.1" style="font-size:90%;">Advancing circuit transient response macromodeling: From conventional neural networks to siamese-lstm.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib54.3.1" style="font-size:90%;">IEEE Transactions on Circuits and Systems I: Regular Papers</span><span class="ltx_text" id="bib.bib54.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.1.1" style="font-size:90%;">
Haotian Zhang, Pengchuan Zhang, Xiaowei Hu, Yen-Chun Chen, Liunian Li, Xiyang Dai, Lijuan Wang, Lu Yuan, Jenq-Neng Hwang, and Jianfeng Gao.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.2.1" style="font-size:90%;">Glipv2: Unifying localization and vision-language understanding.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib55.3.1" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib55.4.2" style="font-size:90%;">, 35:36067–36080, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.1.1" style="font-size:90%;">
Yichi Zhang, Ziqiao Ma, Xiaofeng Gao, Suhaila Shakiah, Qiaozi Gao, and Joyce Chai.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.2.1" style="font-size:90%;">Groundhog: Grounding large language models to holistic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib56.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib56.5.3" style="font-size:90%;">, pages 14227–14238, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.1.1" style="font-size:90%;">
Zhuoyang Zhang, Han Cai, and Song Han.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.2.1" style="font-size:90%;">Efficientvit-sam: Accelerated segment anything model without performance loss.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib57.3.1" style="font-size:90%;">arXiv preprint arXiv:2402.05008</span><span class="ltx_text" id="bib.bib57.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib58.1.1" style="font-size:90%;">
Sixiao Zheng, Jiachen Lu, Hengshuang Zhao, Xiatian Zhu, Zekun Luo, Yabiao Wang, Yanwei Fu, Jianfeng Feng, Tao Xiang, Philip HS Torr, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib58.2.1" style="font-size:90%;">Rethinking semantic segmentation from a sequence-to-sequence perspective with transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib58.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib58.4.2" style="font-size:90%;">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span><span class="ltx_text" id="bib.bib58.5.3" style="font-size:90%;">, pages 6881–6890, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib59.1.1" style="font-size:90%;">
Baichuan Zhou, Ying Hu, Xi Weng, Junlong Jia, Jie Luo, Xien Liu, Ji Wu, and Lei Huang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib59.2.1" style="font-size:90%;">Tinyllava: A framework of small-scale large multimodal models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib59.3.1" style="font-size:90%;">arXiv preprint arXiv:2402.14289</span><span class="ltx_text" id="bib.bib59.4.2" style="font-size:90%;">, 2024.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Sep 13 01:29:45 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
