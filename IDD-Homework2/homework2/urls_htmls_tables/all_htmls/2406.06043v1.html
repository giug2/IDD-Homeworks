<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Modeling User Retention through Generative Flow Networks</title>
<!--Generated on Mon Jun 10 07:11:00 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Recommender Systems,  Generative Flow Networks,  Retention Optimization" lang="en" name="keywords"/>
<base href="/html/2406.06043v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S1" title="In Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S2" title="In Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S2.SS1" title="In 2. Preliminaries ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Generative Flow Networks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S2.SS2" title="In 2. Preliminaries ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Problem Definition</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3" title="In Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>THE PROPOSED Framework</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.SS1" title="In 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>User State Encoding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.SS2" title="In 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Recommendation Policy as Forward Flow</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.SS3" title="In 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Retention Flow Estimation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.SS4" title="In 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Refined Detailed Balance Learning with Reward Integration</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.SS4.SSS1" title="In 3.4. Refined Detailed Balance Learning with Reward Integration ‣ 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.1 </span>Reward Design:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.SS4.SSS2" title="In 3.4. Refined Detailed Balance Learning with Reward Integration ‣ 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.2 </span>Integrated Flow Matching</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.SS4.SSS3" title="In 3.4. Refined Detailed Balance Learning with Reward Integration ‣ 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.3 </span>Integrated Detail Balance Objective</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4" title="In Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.SS1" title="In 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.SS2" title="In 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Simulated User Environment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.SS3" title="In 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.SS4" title="In 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.SS5" title="In 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Overall Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.SS6" title="In 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.SS7" title="In 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.7 </span>Parameter Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.SS8" title="In 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.8 </span>Live Experiment</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S5" title="In Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S5.SS1" title="In 5. Related Work ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span><span class="ltx_text ltx_font_bold">Reinforcement Learning Based RSs</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S5.SS2" title="In 5. Related Work ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Retention Optimization for RSs</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S6" title="In Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#A1" title="In Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>IMPLEMENTATION DETAILS</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#A2" title="In Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>ALGORITHM</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#A3" title="In Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>HYPER-PARAMETER SELECTION</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#A4" title="In Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Probablistic Flow in Continuous Space</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Modeling User Retention through Generative Flow Networks</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ziru Liu<sup class="ltx_sup" id="id1.1.id1">†</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id2.2.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id3.3.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id4.4.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:ziruliu2-c@my.cityu.edu.hk">ziruliu2-c@my.cityu.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shuchang Liu<sup class="ltx_sup" id="id5.1.id1">†</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id6.2.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id7.3.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id8.4.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:liushuchang@kuaishou.com">liushuchang@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Bin Yang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id10.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id11.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yangbin11@kuaishou.com">yangbin11@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhenghai Xue
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id12.1.id1">Nanyang Technology University</span><span class="ltx_text ltx_affiliation_city" id="id13.2.id2">Singapore</span><span class="ltx_text ltx_affiliation_country" id="id14.3.id3">Singapore</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhenghai001@e.ntu.edu.sg">zhenghai001@e.ntu.edu.sg</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qingpeng Cai
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id15.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id16.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id17.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:caiqingpeng@kuaishou.com">caiqingpeng@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiangyu Zhao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id18.1.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id19.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id20.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:xianzhao@cityu.edu.hk">xianzhao@cityu.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zijian Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id21.1.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id22.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id23.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zijian.zhang@my.cityu.edu.hk">zijian.zhang@my.cityu.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lantao Hu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id24.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id25.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id26.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:hulantao@kuaishou.com">hulantao@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Han Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id27.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id28.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id29.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lihan08@kuaishou.com">lihan08@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Peng Jiang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id30.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id31.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id32.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jiangpeng@kuaishou.com">jiangpeng@kuaishou.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id33.id1">Recommender systems aim to fulfill the user’s daily demands.
While most existing research focuses on maximizing the user’s engagement with the system, it has recently been pointed out that how frequently the users come back for the service also reflects the quality and stability of recommendations.
However, optimizing this user retention behavior is non-trivial and poses several challenges including the intractable leave-and-return user activities, the sparse and delayed signal, and the uncertain relations between users’ retention and their immediate feedback towards each item in the recommendation list.
In this work, we regard the retention signal as an overall estimation of the user’s end-of-session satisfaction and propose to estimate this signal through a probabilistic flow.
This flow-based modeling technique can back-propagate the retention reward towards each recommended item in the user session, and we show that the flow combined with traditional learning-to-rank objectives eventually optimizes a non-discounted cumulative reward for both immediate user feedback and user retention.
We verify the effectiveness of our method through both offline empirical studies on two public datasets and online A/B tests in an industrial platform. The source code is accessible to facilitate replication <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Applied-Machine-Learning-Lab/GFN4Retention" title="">https://github.com/Applied-Machine-Learning-Lab/GFN4Retention</a></span></span></span>.</p>
</div>
<div class="ltx_keywords">Recommender Systems, Generative Flow Networks, Retention Optimization
</div>
<div class="ltx_acknowledgements">†Co-first authors. * Corresponding authors.
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining; August 25–29, 2024; Barcelona, Spain</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (KDD ’24), August 25–29, 2024, Barcelona, Spain</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3637528.3671531</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0490-1/24/08</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In the era of information abundance, recommender systems have become essential tools that guide users to content that resonates with their personal preferences  <cite class="ltx_cite ltx_citemacro_citep">(Aceto et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib2" title="">2020</a>)</cite>.
Traditional metrics used to evaluate these systems — such as clicks, likes, and ratings — are adept at capturing user preferences for each recommended item <cite class="ltx_cite ltx_citemacro_citep">(Das et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib18" title="">2007</a>; Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib59" title="">2019</a>)</cite> and are formulated as targets to guide the optimization of the recommender systems.
Despite their effectiveness, they essentially estimate the user’s immediate feedback of items and are incapable of providing a comprehensive assessment of users’ long-term engagement  <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib49" title="">2017</a>; Yi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib53" title="">2014</a>)</cite>.
For example,
when the system finds that items with compelling features (e.g. addictive content) can maximize the click rate, it may decide to continuously recommend such items.
However, these features may initially be appealing but quickly lose the user’s fondness.
This discrepancy suggests a gap between the user’s immediate interest in an item and the sustainable interest  <cite class="ltx_cite ltx_citemacro_citep">(Viljanen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib47" title="">2016</a>)</cite> of the system.
As a resolution, long-term metrics are adopted to offer deeper insights into users’ overall satisfaction.
One typical example is the user retention signal that describes the user’s return-to-app behavior.
This metric is one of the most critical performance estimators for many online services since it closely correlates with the pivotal business indicator, i.e. Daily Active Users (DAU) <cite class="ltx_cite ltx_citemacro_citep">(Zou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib65" title="">2019</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In practice, modeling and optimizing user retention is a challenging task because of its between-session nature.
Specifically, the retention behavior does not happen until the user leaves the current session and returns at the beginning of the next session.
And it has no clear relation to any single recommendation step in previous interactions.
Furthermore, the user’s activity between the two consecutive sessions is assumed unobservable for the service, introducing extra uncertainty.
To circumvent these challenges, evidence has found promising results using reinforcement learning (RL) to optimize the cumulative reward for the entire user interaction sequence <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib15" title="">2021a</a>; Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib7" title="">2023a</a>)</cite> as a surrogate.
Intuitively, the user returns to the platform because the system’s overall impression is sufficiently positive and attractive, which can be partially measured by the sum of (positive feedback related) rewards in the session.
RL-based recommendation solutions solve the optimization of this cumulative reward by formulating the user interaction sequence as a Markov Decision Process (MDP) and learning a policy that considers the long-term impact of each recommendation action <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib62" title="">2011</a>; Afsar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib3" title="">2021</a>)</cite>.
This allows them to dynamically tailor recommendations at each point of user interaction, adapting to the evolving preferences and optimizing the cumulative reward of the whole session.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Yet, the relation between the session-level cumulative reward and user retention is still unclear, so the authors in <cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib7" title="">2023a</a>)</cite> further show that the RL-based method may directly integrate the cross-session retention signal into the long-term value estimation.
Though effective, this method is not designed to investigate the influence of each interaction on the retention signal (denoted as “retention attribution”) and it also indirectly optimizes the retention with cumulative immediate rewards as a surrogate.
Besides, all RL-based solutions may suffer from the exploration and exploitation trade-off <cite class="ltx_cite ltx_citemacro_citep">(Ciosek et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib17" title="">2019</a>)</cite> that limits their performance on unstable metrics.
This instability is particularly pronounced in scenarios where user retention dynamics are complex, uncertain, and rapidly evolving.
In general, we want to have a stable exploratory solution that can simultaneously optimize user retention and immediate rewards.
</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Inspired by the recent development of Generative Flow Networks (GFNs)<cite class="ltx_cite ltx_citemacro_citep">(Bengio et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib4" title="">2021</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib55" title="">2023</a>; Pan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib37" title="">2023a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib38" title="">b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib40" title="">c</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib39" title="">2022</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib55" title="">2023</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib54" title="">2024</a>; Lau et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib29" title="">2024</a>)</cite>, we propose an alternative approach <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">GFN4Retention</span> that considers the session-level recommendation as a generation task where the retention signal is directly modeled by the trajectory generation probability.
Similar to the general GFN formulation, a probabilistic generation process will finally construct a user session (trajectory) where the target retention reward is matched only by the end of the process.
Specifically, each recommendation step is considered as a conditional forward probabilistic flow to the next user state and each user state is associated with a flow estimator that represents the generation probability of reaching this state.
During optimization, the end-of-session terminal state directly matches the generation probability with the retention reward.
For non-terminal states, a flow matching learning objective that incorporates an additional backward probabilistic flow is used to back-propagate the retention reward towards every step in the sequence.
This would implicitly model each recommendation action’s retention attribution.
As discussed in <cite class="ltx_cite ltx_citemacro_citep">(Bengio et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib5" title="">2023</a>)</cite>, GFNs have demonstrated remarkable strength in generating diverse objects of high quality, which naturally solves the aforementioned exploration challenge of RL.
Nevertheless, incorporating GFNs in the recommendation task with retention optimization also brings new challenges.
In its design, GFNs may find it difficult to track the nuanced changes in user engagement of each recommendation step, since it originally assumes the absence of intermediate rewards.
As a countermeasure, we derive an integrated reward system that can balance the immediate reward and the retention attribution in each recommendation step.
The final reward of GFN4Retention derives a refined detailed balance loss that matches the session-level generation probability with the product of the retention reward and the non-discounted cumulative reward of immediate feedback.
Secondly, the recommendation space is combinatorially large and the list-wise recommendation is generated and represented by a point in the continuous vector space <cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib7" title="">2023a</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib34" title="">2023b</a>; Xue et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib51" title="">2022</a>)</cite> in practice. We show that the flow matching property still holds in this continuous space and illustrate how to design each flow estimation component accordingly.
To this end, we summarize our key contributions in this paper as follows:
</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We emphasize the importance of retention optimization in real-world RS applications and introduce GFN4Retention learning framework designed for enhancing user retention while maintaining good exploration.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Our proposed solution innovatively derived an integrated reward design with a refined detailed balance objective that can control the trade-off between the immediate reward and the retention attribution in each recommendation step. Besides, we also propose to optimize the flow-matching objectives in the continuous action space to accommodate the large recommendation space of the item list.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We validate the superiority of GFN4Retention through extensive experiments compared with state-of-the-art RL-based recommendation models on both offline and live experiments, and discuss the behaviors of each component with ablation study and parameter analysis.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Preliminaries</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">This section provides an overview of Generative Flow Networks and delves into the specific problem in our study: the session-wise recommendation for retention and immediate reward optimization.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="331" id="S2.F1.g1" src="x1.png" width="623"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Overview of GFN4Retention Framework</figcaption>
</figure>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Generative Flow Networks</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.6">In recent years, Generative Flow Networks (GFNs) have emerged as an innovative force in generative modeling, introducing a methodology for learning and sampling within complex distributions.
The core of GFNs’ design is its ability to develop a generation policy that directs the probabilistic flow across a state space towards terminal states <cite class="ltx_cite ltx_citemacro_citep">(Bengio et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib4" title="">2021</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib5" title="">2023</a>)</cite>.
Specifically, the general formulation considers a generation trajectory <math alttext="\mathbf{S}=\left\{s_{1}\rightarrow s_{2}\rightarrow\cdots\rightarrow s_{T}\right\}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">𝐒</mi><mo id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">=</mo><mrow id="S2.SS1.p1.1.m1.1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.2.cmml"><mo id="S2.SS1.p1.1.m1.1.1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p1.1.m1.1.1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.1.1.cmml"><msub id="S2.SS1.p1.1.m1.1.1.1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.1.m1.1.1.1.1.1.2.2" xref="S2.SS1.p1.1.m1.1.1.1.1.1.2.2.cmml">s</mi><mn id="S2.SS1.p1.1.m1.1.1.1.1.1.2.3" xref="S2.SS1.p1.1.m1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.SS1.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.1.m1.1.1.1.1.1.3.cmml">→</mo><msub id="S2.SS1.p1.1.m1.1.1.1.1.1.4" xref="S2.SS1.p1.1.m1.1.1.1.1.1.4.cmml"><mi id="S2.SS1.p1.1.m1.1.1.1.1.1.4.2" xref="S2.SS1.p1.1.m1.1.1.1.1.1.4.2.cmml">s</mi><mn id="S2.SS1.p1.1.m1.1.1.1.1.1.4.3" xref="S2.SS1.p1.1.m1.1.1.1.1.1.4.3.cmml">2</mn></msub><mo id="S2.SS1.p1.1.m1.1.1.1.1.1.5" stretchy="false" xref="S2.SS1.p1.1.m1.1.1.1.1.1.5.cmml">→</mo><mi id="S2.SS1.p1.1.m1.1.1.1.1.1.6" mathvariant="normal" xref="S2.SS1.p1.1.m1.1.1.1.1.1.6.cmml">⋯</mi><mo id="S2.SS1.p1.1.m1.1.1.1.1.1.7" stretchy="false" xref="S2.SS1.p1.1.m1.1.1.1.1.1.7.cmml">→</mo><msub id="S2.SS1.p1.1.m1.1.1.1.1.1.8" xref="S2.SS1.p1.1.m1.1.1.1.1.1.8.cmml"><mi id="S2.SS1.p1.1.m1.1.1.1.1.1.8.2" xref="S2.SS1.p1.1.m1.1.1.1.1.1.8.2.cmml">s</mi><mi id="S2.SS1.p1.1.m1.1.1.1.1.1.8.3" xref="S2.SS1.p1.1.m1.1.1.1.1.1.8.3.cmml">T</mi></msub></mrow><mo id="S2.SS1.p1.1.m1.1.1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><eq id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2"></eq><ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">𝐒</ci><set id="S2.SS1.p1.1.m1.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1"><apply id="S2.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1"><and id="S2.SS1.p1.1.m1.1.1.1.1.1a.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1"></and><apply id="S2.SS1.p1.1.m1.1.1.1.1.1b.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1"><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.3">→</ci><apply id="S2.SS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.2.2">𝑠</ci><cn id="S2.SS1.p1.1.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.1.1.1.1.1.2.3">1</cn></apply><apply id="S2.SS1.p1.1.m1.1.1.1.1.1.4.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.1.1.4.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.4.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.4.2">𝑠</ci><cn id="S2.SS1.p1.1.m1.1.1.1.1.1.4.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.1.1.1.1.1.4.3">2</cn></apply></apply><apply id="S2.SS1.p1.1.m1.1.1.1.1.1c.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1"><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.5.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.5">→</ci><share href="https://arxiv.org/html/2406.06043v1#S2.SS1.p1.1.m1.1.1.1.1.1.4.cmml" id="S2.SS1.p1.1.m1.1.1.1.1.1d.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1"></share><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.6.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.6">⋯</ci></apply><apply id="S2.SS1.p1.1.m1.1.1.1.1.1e.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1"><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.7.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.7">→</ci><share href="https://arxiv.org/html/2406.06043v1#S2.SS1.p1.1.m1.1.1.1.1.1.6.cmml" id="S2.SS1.p1.1.m1.1.1.1.1.1f.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1"></share><apply id="S2.SS1.p1.1.m1.1.1.1.1.1.8.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.8"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.1.1.8.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.8">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.8.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.8.2">𝑠</ci><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.8.3.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.8.3">𝑇</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathbf{S}=\left\{s_{1}\rightarrow s_{2}\rightarrow\cdots\rightarrow s_{T}\right\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">bold_S = { italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT → italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT → ⋯ → italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT }</annotation></semantics></math> and assumes a forward probabilistic policy <math alttext="P_{F}(s_{t+1}|s_{t})" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mrow id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><msub id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.3.2" xref="S2.SS1.p1.2.m2.1.1.3.2.cmml">P</mi><mi id="S2.SS1.p1.2.m2.1.1.3.3" xref="S2.SS1.p1.2.m2.1.1.3.3.cmml">F</mi></msub><mo id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.2.m2.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.2.m2.1.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.cmml"><msub id="S2.SS1.p1.2.m2.1.1.1.1.1.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.2.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml">s</mi><mrow id="S2.SS1.p1.2.m2.1.1.1.1.1.2.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S2.SS1.p1.2.m2.1.1.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S2.SS1.p1.2.m2.1.1.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.3.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3.2.cmml">s</mi><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.3.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.SS1.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><times id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2"></times><apply id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.3.2">𝑃</ci><ci id="S2.SS1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3.3">𝐹</ci></apply><apply id="S2.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.2">𝑠</ci><apply id="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.3"><plus id="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.1"></plus><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3.2">𝑠</ci><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">P_{F}(s_{t+1}|s_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> that determines each action during the generation process.
Here <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">s</mi><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝑠</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represents the state at step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_t</annotation></semantics></math>, and <math alttext="T" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_T</annotation></semantics></math> is the terminal step of the trajectory.
The goal of GFNs is to align the generation probability <math alttext="P(\mathbf{S})" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><mrow id="S2.SS1.p1.6.m6.1.2" xref="S2.SS1.p1.6.m6.1.2.cmml"><mi id="S2.SS1.p1.6.m6.1.2.2" xref="S2.SS1.p1.6.m6.1.2.2.cmml">P</mi><mo id="S2.SS1.p1.6.m6.1.2.1" xref="S2.SS1.p1.6.m6.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p1.6.m6.1.2.3.2" xref="S2.SS1.p1.6.m6.1.2.cmml"><mo id="S2.SS1.p1.6.m6.1.2.3.2.1" stretchy="false" xref="S2.SS1.p1.6.m6.1.2.cmml">(</mo><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">𝐒</mi><mo id="S2.SS1.p1.6.m6.1.2.3.2.2" stretchy="false" xref="S2.SS1.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.2.cmml" xref="S2.SS1.p1.6.m6.1.2"><times id="S2.SS1.p1.6.m6.1.2.1.cmml" xref="S2.SS1.p1.6.m6.1.2.1"></times><ci id="S2.SS1.p1.6.m6.1.2.2.cmml" xref="S2.SS1.p1.6.m6.1.2.2">𝑃</ci><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝐒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">P(\mathbf{S})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_P ( bold_S )</annotation></semantics></math> of each trajectory with the observed reward by the end:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P(\mathbf{S})\propto R(s_{T})" class="ltx_Math" display="block" id="S2.E1.m1.2"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><mrow id="S2.E1.m1.2.2.3" xref="S2.E1.m1.2.2.3.cmml"><mi id="S2.E1.m1.2.2.3.2" xref="S2.E1.m1.2.2.3.2.cmml">P</mi><mo id="S2.E1.m1.2.2.3.1" xref="S2.E1.m1.2.2.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.3.3.2" xref="S2.E1.m1.2.2.3.cmml"><mo id="S2.E1.m1.2.2.3.3.2.1" stretchy="false" xref="S2.E1.m1.2.2.3.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝐒</mi><mo id="S2.E1.m1.2.2.3.3.2.2" stretchy="false" xref="S2.E1.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml">∝</mo><mrow id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.cmml"><mi id="S2.E1.m1.2.2.1.3" xref="S2.E1.m1.2.2.1.3.cmml">R</mi><mo id="S2.E1.m1.2.2.1.2" xref="S2.E1.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.cmml"><mo id="S2.E1.m1.2.2.1.1.1.2" stretchy="false" xref="S2.E1.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S2.E1.m1.2.2.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.2.cmml">s</mi><mi id="S2.E1.m1.2.2.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.3.cmml">T</mi></msub><mo id="S2.E1.m1.2.2.1.1.1.3" stretchy="false" xref="S2.E1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><csymbol cd="latexml" id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2">proportional-to</csymbol><apply id="S2.E1.m1.2.2.3.cmml" xref="S2.E1.m1.2.2.3"><times id="S2.E1.m1.2.2.3.1.cmml" xref="S2.E1.m1.2.2.3.1"></times><ci id="S2.E1.m1.2.2.3.2.cmml" xref="S2.E1.m1.2.2.3.2">𝑃</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝐒</ci></apply><apply id="S2.E1.m1.2.2.1.cmml" xref="S2.E1.m1.2.2.1"><times id="S2.E1.m1.2.2.1.2.cmml" xref="S2.E1.m1.2.2.1.2"></times><ci id="S2.E1.m1.2.2.1.3.cmml" xref="S2.E1.m1.2.2.1.3">𝑅</ci><apply id="S2.E1.m1.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.2">𝑠</ci><ci id="S2.E1.m1.2.2.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">P(\mathbf{S})\propto R(s_{T})</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.2d">italic_P ( bold_S ) ∝ italic_R ( italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.7">which is essentially an energy-based method since the model simultaneously serves as the generator and evaluator.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.2">During optimization, the GFN framework introduces a flow estimator <math alttext="\mathcal{F}(s_{t})" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml">ℱ</mi><mo id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p2.1.m1.1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS1.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p2.1.m1.1.1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.1.1.1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.SS1.p2.1.m1.1.1.1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS1.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><times id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2"></times><ci id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3">ℱ</ci><apply id="S2.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="S2.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\mathcal{F}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> that assesses the likelihood of traversing through a specific state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><msub id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.1.1.2" xref="S2.SS1.p2.2.m2.1.1.2.cmml">s</mi><mi id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2">𝑠</ci><ci id="S2.SS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The learning process of flow in GFNs is meticulously calibrated to align with the target distribution, ensuring equilibrium between the sums of incoming and outgoing flows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{F}\left(s_{t}\right)P_{F}\left(s_{t+1}\mid s_{t}\right)\approx%
\mathcal{F}\left(s_{t+1}\right)P_{B}\left(s_{t}\mid s_{t+1}\right)" class="ltx_Math" display="block" id="S2.E2.m1.4"><semantics id="S2.E2.m1.4a"><mrow id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml"><mrow id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.4.cmml">ℱ</mi><mo id="S2.E2.m1.2.2.2.3" xref="S2.E2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E2.m1.2.2.2.3a" xref="S2.E2.m1.2.2.2.3.cmml">⁢</mo><msub id="S2.E2.m1.2.2.2.5" xref="S2.E2.m1.2.2.2.5.cmml"><mi id="S2.E2.m1.2.2.2.5.2" xref="S2.E2.m1.2.2.2.5.2.cmml">P</mi><mi id="S2.E2.m1.2.2.2.5.3" xref="S2.E2.m1.2.2.2.5.3.cmml">F</mi></msub><mo id="S2.E2.m1.2.2.2.3b" xref="S2.E2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.2.2.1" xref="S2.E2.m1.2.2.2.2.1.1.cmml"><mo id="S2.E2.m1.2.2.2.2.1.2" xref="S2.E2.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.2.2.1.1" xref="S2.E2.m1.2.2.2.2.1.1.cmml"><msub id="S2.E2.m1.2.2.2.2.1.1.2" xref="S2.E2.m1.2.2.2.2.1.1.2.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.2.2" xref="S2.E2.m1.2.2.2.2.1.1.2.2.cmml">s</mi><mrow id="S2.E2.m1.2.2.2.2.1.1.2.3" xref="S2.E2.m1.2.2.2.2.1.1.2.3.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.2.3.2" xref="S2.E2.m1.2.2.2.2.1.1.2.3.2.cmml">t</mi><mo id="S2.E2.m1.2.2.2.2.1.1.2.3.1" xref="S2.E2.m1.2.2.2.2.1.1.2.3.1.cmml">+</mo><mn id="S2.E2.m1.2.2.2.2.1.1.2.3.3" xref="S2.E2.m1.2.2.2.2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E2.m1.2.2.2.2.1.1.1" xref="S2.E2.m1.2.2.2.2.1.1.1.cmml">∣</mo><msub id="S2.E2.m1.2.2.2.2.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.3.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.3.2" xref="S2.E2.m1.2.2.2.2.1.1.3.2.cmml">s</mi><mi id="S2.E2.m1.2.2.2.2.1.1.3.3" xref="S2.E2.m1.2.2.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E2.m1.2.2.2.2.1.3" xref="S2.E2.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.4.4.5" xref="S2.E2.m1.4.4.5.cmml">≈</mo><mrow id="S2.E2.m1.4.4.4" xref="S2.E2.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.4.4.4.4" xref="S2.E2.m1.4.4.4.4.cmml">ℱ</mi><mo id="S2.E2.m1.4.4.4.3" xref="S2.E2.m1.4.4.4.3.cmml">⁢</mo><mrow id="S2.E2.m1.3.3.3.1.1" xref="S2.E2.m1.3.3.3.1.1.1.cmml"><mo id="S2.E2.m1.3.3.3.1.1.2" xref="S2.E2.m1.3.3.3.1.1.1.cmml">(</mo><msub id="S2.E2.m1.3.3.3.1.1.1" xref="S2.E2.m1.3.3.3.1.1.1.cmml"><mi id="S2.E2.m1.3.3.3.1.1.1.2" xref="S2.E2.m1.3.3.3.1.1.1.2.cmml">s</mi><mrow id="S2.E2.m1.3.3.3.1.1.1.3" xref="S2.E2.m1.3.3.3.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.3.1.1.1.3.2" xref="S2.E2.m1.3.3.3.1.1.1.3.2.cmml">t</mi><mo id="S2.E2.m1.3.3.3.1.1.1.3.1" xref="S2.E2.m1.3.3.3.1.1.1.3.1.cmml">+</mo><mn id="S2.E2.m1.3.3.3.1.1.1.3.3" xref="S2.E2.m1.3.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S2.E2.m1.3.3.3.1.1.3" xref="S2.E2.m1.3.3.3.1.1.1.cmml">)</mo></mrow><mo id="S2.E2.m1.4.4.4.3a" xref="S2.E2.m1.4.4.4.3.cmml">⁢</mo><msub id="S2.E2.m1.4.4.4.5" xref="S2.E2.m1.4.4.4.5.cmml"><mi id="S2.E2.m1.4.4.4.5.2" xref="S2.E2.m1.4.4.4.5.2.cmml">P</mi><mi id="S2.E2.m1.4.4.4.5.3" xref="S2.E2.m1.4.4.4.5.3.cmml">B</mi></msub><mo id="S2.E2.m1.4.4.4.3b" xref="S2.E2.m1.4.4.4.3.cmml">⁢</mo><mrow id="S2.E2.m1.4.4.4.2.1" xref="S2.E2.m1.4.4.4.2.1.1.cmml"><mo id="S2.E2.m1.4.4.4.2.1.2" xref="S2.E2.m1.4.4.4.2.1.1.cmml">(</mo><mrow id="S2.E2.m1.4.4.4.2.1.1" xref="S2.E2.m1.4.4.4.2.1.1.cmml"><msub id="S2.E2.m1.4.4.4.2.1.1.2" xref="S2.E2.m1.4.4.4.2.1.1.2.cmml"><mi id="S2.E2.m1.4.4.4.2.1.1.2.2" xref="S2.E2.m1.4.4.4.2.1.1.2.2.cmml">s</mi><mi id="S2.E2.m1.4.4.4.2.1.1.2.3" xref="S2.E2.m1.4.4.4.2.1.1.2.3.cmml">t</mi></msub><mo id="S2.E2.m1.4.4.4.2.1.1.1" xref="S2.E2.m1.4.4.4.2.1.1.1.cmml">∣</mo><msub id="S2.E2.m1.4.4.4.2.1.1.3" xref="S2.E2.m1.4.4.4.2.1.1.3.cmml"><mi id="S2.E2.m1.4.4.4.2.1.1.3.2" xref="S2.E2.m1.4.4.4.2.1.1.3.2.cmml">s</mi><mrow id="S2.E2.m1.4.4.4.2.1.1.3.3" xref="S2.E2.m1.4.4.4.2.1.1.3.3.cmml"><mi id="S2.E2.m1.4.4.4.2.1.1.3.3.2" xref="S2.E2.m1.4.4.4.2.1.1.3.3.2.cmml">t</mi><mo id="S2.E2.m1.4.4.4.2.1.1.3.3.1" xref="S2.E2.m1.4.4.4.2.1.1.3.3.1.cmml">+</mo><mn id="S2.E2.m1.4.4.4.2.1.1.3.3.3" xref="S2.E2.m1.4.4.4.2.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.E2.m1.4.4.4.2.1.3" xref="S2.E2.m1.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.4b"><apply id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4"><approx id="S2.E2.m1.4.4.5.cmml" xref="S2.E2.m1.4.4.5"></approx><apply id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"><times id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.3"></times><ci id="S2.E2.m1.2.2.2.4.cmml" xref="S2.E2.m1.2.2.2.4">ℱ</ci><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E2.m1.2.2.2.5.cmml" xref="S2.E2.m1.2.2.2.5"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.5.1.cmml" xref="S2.E2.m1.2.2.2.5">subscript</csymbol><ci id="S2.E2.m1.2.2.2.5.2.cmml" xref="S2.E2.m1.2.2.2.5.2">𝑃</ci><ci id="S2.E2.m1.2.2.2.5.3.cmml" xref="S2.E2.m1.2.2.2.5.3">𝐹</ci></apply><apply id="S2.E2.m1.2.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1"><csymbol cd="latexml" id="S2.E2.m1.2.2.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1">conditional</csymbol><apply id="S2.E2.m1.2.2.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.2.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.2.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.2">𝑠</ci><apply id="S2.E2.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.3"><plus id="S2.E2.m1.2.2.2.2.1.1.2.3.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.3.1"></plus><ci id="S2.E2.m1.2.2.2.2.1.1.2.3.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.3.2">𝑡</ci><cn id="S2.E2.m1.2.2.2.2.1.1.2.3.3.cmml" type="integer" xref="S2.E2.m1.2.2.2.2.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.2.2.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.2">𝑠</ci><ci id="S2.E2.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S2.E2.m1.4.4.4.cmml" xref="S2.E2.m1.4.4.4"><times id="S2.E2.m1.4.4.4.3.cmml" xref="S2.E2.m1.4.4.4.3"></times><ci id="S2.E2.m1.4.4.4.4.cmml" xref="S2.E2.m1.4.4.4.4">ℱ</ci><apply id="S2.E2.m1.3.3.3.1.1.1.cmml" xref="S2.E2.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.3.1.1.1.1.cmml" xref="S2.E2.m1.3.3.3.1.1">subscript</csymbol><ci id="S2.E2.m1.3.3.3.1.1.1.2.cmml" xref="S2.E2.m1.3.3.3.1.1.1.2">𝑠</ci><apply id="S2.E2.m1.3.3.3.1.1.1.3.cmml" xref="S2.E2.m1.3.3.3.1.1.1.3"><plus id="S2.E2.m1.3.3.3.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.3.1.1.1.3.1"></plus><ci id="S2.E2.m1.3.3.3.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.3.1.1.1.3.2">𝑡</ci><cn id="S2.E2.m1.3.3.3.1.1.1.3.3.cmml" type="integer" xref="S2.E2.m1.3.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="S2.E2.m1.4.4.4.5.cmml" xref="S2.E2.m1.4.4.4.5"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.5.1.cmml" xref="S2.E2.m1.4.4.4.5">subscript</csymbol><ci id="S2.E2.m1.4.4.4.5.2.cmml" xref="S2.E2.m1.4.4.4.5.2">𝑃</ci><ci id="S2.E2.m1.4.4.4.5.3.cmml" xref="S2.E2.m1.4.4.4.5.3">𝐵</ci></apply><apply id="S2.E2.m1.4.4.4.2.1.1.cmml" xref="S2.E2.m1.4.4.4.2.1"><csymbol cd="latexml" id="S2.E2.m1.4.4.4.2.1.1.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1">conditional</csymbol><apply id="S2.E2.m1.4.4.4.2.1.1.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.2.1.1.2.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.2">subscript</csymbol><ci id="S2.E2.m1.4.4.4.2.1.1.2.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.2.2">𝑠</ci><ci id="S2.E2.m1.4.4.4.2.1.1.2.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.2.3">𝑡</ci></apply><apply id="S2.E2.m1.4.4.4.2.1.1.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.2.1.1.3.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.3">subscript</csymbol><ci id="S2.E2.m1.4.4.4.2.1.1.3.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.3.2">𝑠</ci><apply id="S2.E2.m1.4.4.4.2.1.1.3.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.3.3"><plus id="S2.E2.m1.4.4.4.2.1.1.3.3.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.3.3.1"></plus><ci id="S2.E2.m1.4.4.4.2.1.1.3.3.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.3.3.2">𝑡</ci><cn id="S2.E2.m1.4.4.4.2.1.1.3.3.3.cmml" type="integer" xref="S2.E2.m1.4.4.4.2.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.4c">\mathcal{F}\left(s_{t}\right)P_{F}\left(s_{t+1}\mid s_{t}\right)\approx%
\mathcal{F}\left(s_{t+1}\right)P_{B}\left(s_{t}\mid s_{t+1}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.4d">caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ≈ caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.8">where <math alttext="P_{F}\left(s_{t+1}\mid s_{t}\right)" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m1.1"><semantics id="S2.SS1.p2.3.m1.1a"><mrow id="S2.SS1.p2.3.m1.1.1" xref="S2.SS1.p2.3.m1.1.1.cmml"><msub id="S2.SS1.p2.3.m1.1.1.3" xref="S2.SS1.p2.3.m1.1.1.3.cmml"><mi id="S2.SS1.p2.3.m1.1.1.3.2" xref="S2.SS1.p2.3.m1.1.1.3.2.cmml">P</mi><mi id="S2.SS1.p2.3.m1.1.1.3.3" xref="S2.SS1.p2.3.m1.1.1.3.3.cmml">F</mi></msub><mo id="S2.SS1.p2.3.m1.1.1.2" xref="S2.SS1.p2.3.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p2.3.m1.1.1.1.1" xref="S2.SS1.p2.3.m1.1.1.1.1.1.cmml"><mo id="S2.SS1.p2.3.m1.1.1.1.1.2" xref="S2.SS1.p2.3.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.3.m1.1.1.1.1.1" xref="S2.SS1.p2.3.m1.1.1.1.1.1.cmml"><msub id="S2.SS1.p2.3.m1.1.1.1.1.1.2" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p2.3.m1.1.1.1.1.1.2.2" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2.2.cmml">s</mi><mrow id="S2.SS1.p2.3.m1.1.1.1.1.1.2.3" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.cmml"><mi id="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.2" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.1" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.3" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS1.p2.3.m1.1.1.1.1.1.1" xref="S2.SS1.p2.3.m1.1.1.1.1.1.1.cmml">∣</mo><msub id="S2.SS1.p2.3.m1.1.1.1.1.1.3" xref="S2.SS1.p2.3.m1.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p2.3.m1.1.1.1.1.1.3.2" xref="S2.SS1.p2.3.m1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S2.SS1.p2.3.m1.1.1.1.1.1.3.3" xref="S2.SS1.p2.3.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.SS1.p2.3.m1.1.1.1.1.3" xref="S2.SS1.p2.3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m1.1b"><apply id="S2.SS1.p2.3.m1.1.1.cmml" xref="S2.SS1.p2.3.m1.1.1"><times id="S2.SS1.p2.3.m1.1.1.2.cmml" xref="S2.SS1.p2.3.m1.1.1.2"></times><apply id="S2.SS1.p2.3.m1.1.1.3.cmml" xref="S2.SS1.p2.3.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m1.1.1.3.1.cmml" xref="S2.SS1.p2.3.m1.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.3.m1.1.1.3.2.cmml" xref="S2.SS1.p2.3.m1.1.1.3.2">𝑃</ci><ci id="S2.SS1.p2.3.m1.1.1.3.3.cmml" xref="S2.SS1.p2.3.m1.1.1.3.3">𝐹</ci></apply><apply id="S2.SS1.p2.3.m1.1.1.1.1.1.cmml" xref="S2.SS1.p2.3.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p2.3.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.3.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p2.3.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p2.3.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2.2">𝑠</ci><apply id="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2.3"><plus id="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.1"></plus><ci id="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S2.SS1.p2.3.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.SS1.p2.3.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.3.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p2.3.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.3.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p2.3.m1.1.1.1.1.1.3.2">𝑠</ci><ci id="S2.SS1.p2.3.m1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p2.3.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m1.1c">P_{F}\left(s_{t+1}\mid s_{t}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m1.1d">italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is the forward probability from <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m2.1"><semantics id="S2.SS1.p2.4.m2.1a"><msub id="S2.SS1.p2.4.m2.1.1" xref="S2.SS1.p2.4.m2.1.1.cmml"><mi id="S2.SS1.p2.4.m2.1.1.2" xref="S2.SS1.p2.4.m2.1.1.2.cmml">s</mi><mi id="S2.SS1.p2.4.m2.1.1.3" xref="S2.SS1.p2.4.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m2.1b"><apply id="S2.SS1.p2.4.m2.1.1.cmml" xref="S2.SS1.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m2.1.1.1.cmml" xref="S2.SS1.p2.4.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.4.m2.1.1.2.cmml" xref="S2.SS1.p2.4.m2.1.1.2">𝑠</ci><ci id="S2.SS1.p2.4.m2.1.1.3.cmml" xref="S2.SS1.p2.4.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m2.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m2.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m3.1"><semantics id="S2.SS1.p2.5.m3.1a"><msub id="S2.SS1.p2.5.m3.1.1" xref="S2.SS1.p2.5.m3.1.1.cmml"><mi id="S2.SS1.p2.5.m3.1.1.2" xref="S2.SS1.p2.5.m3.1.1.2.cmml">s</mi><mrow id="S2.SS1.p2.5.m3.1.1.3" xref="S2.SS1.p2.5.m3.1.1.3.cmml"><mi id="S2.SS1.p2.5.m3.1.1.3.2" xref="S2.SS1.p2.5.m3.1.1.3.2.cmml">t</mi><mo id="S2.SS1.p2.5.m3.1.1.3.1" xref="S2.SS1.p2.5.m3.1.1.3.1.cmml">+</mo><mn id="S2.SS1.p2.5.m3.1.1.3.3" xref="S2.SS1.p2.5.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m3.1b"><apply id="S2.SS1.p2.5.m3.1.1.cmml" xref="S2.SS1.p2.5.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m3.1.1.1.cmml" xref="S2.SS1.p2.5.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m3.1.1.2.cmml" xref="S2.SS1.p2.5.m3.1.1.2">𝑠</ci><apply id="S2.SS1.p2.5.m3.1.1.3.cmml" xref="S2.SS1.p2.5.m3.1.1.3"><plus id="S2.SS1.p2.5.m3.1.1.3.1.cmml" xref="S2.SS1.p2.5.m3.1.1.3.1"></plus><ci id="S2.SS1.p2.5.m3.1.1.3.2.cmml" xref="S2.SS1.p2.5.m3.1.1.3.2">𝑡</ci><cn id="S2.SS1.p2.5.m3.1.1.3.3.cmml" type="integer" xref="S2.SS1.p2.5.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m3.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m3.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="P_{B}\left(s_{t}\mid s_{t+1}\right)" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m4.1"><semantics id="S2.SS1.p2.6.m4.1a"><mrow id="S2.SS1.p2.6.m4.1.1" xref="S2.SS1.p2.6.m4.1.1.cmml"><msub id="S2.SS1.p2.6.m4.1.1.3" xref="S2.SS1.p2.6.m4.1.1.3.cmml"><mi id="S2.SS1.p2.6.m4.1.1.3.2" xref="S2.SS1.p2.6.m4.1.1.3.2.cmml">P</mi><mi id="S2.SS1.p2.6.m4.1.1.3.3" xref="S2.SS1.p2.6.m4.1.1.3.3.cmml">B</mi></msub><mo id="S2.SS1.p2.6.m4.1.1.2" xref="S2.SS1.p2.6.m4.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p2.6.m4.1.1.1.1" xref="S2.SS1.p2.6.m4.1.1.1.1.1.cmml"><mo id="S2.SS1.p2.6.m4.1.1.1.1.2" xref="S2.SS1.p2.6.m4.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.6.m4.1.1.1.1.1" xref="S2.SS1.p2.6.m4.1.1.1.1.1.cmml"><msub id="S2.SS1.p2.6.m4.1.1.1.1.1.2" xref="S2.SS1.p2.6.m4.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p2.6.m4.1.1.1.1.1.2.2" xref="S2.SS1.p2.6.m4.1.1.1.1.1.2.2.cmml">s</mi><mi id="S2.SS1.p2.6.m4.1.1.1.1.1.2.3" xref="S2.SS1.p2.6.m4.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S2.SS1.p2.6.m4.1.1.1.1.1.1" xref="S2.SS1.p2.6.m4.1.1.1.1.1.1.cmml">∣</mo><msub id="S2.SS1.p2.6.m4.1.1.1.1.1.3" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p2.6.m4.1.1.1.1.1.3.2" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3.2.cmml">s</mi><mrow id="S2.SS1.p2.6.m4.1.1.1.1.1.3.3" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.cmml"><mi id="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.2" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.1" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.3" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.SS1.p2.6.m4.1.1.1.1.3" xref="S2.SS1.p2.6.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m4.1b"><apply id="S2.SS1.p2.6.m4.1.1.cmml" xref="S2.SS1.p2.6.m4.1.1"><times id="S2.SS1.p2.6.m4.1.1.2.cmml" xref="S2.SS1.p2.6.m4.1.1.2"></times><apply id="S2.SS1.p2.6.m4.1.1.3.cmml" xref="S2.SS1.p2.6.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m4.1.1.3.1.cmml" xref="S2.SS1.p2.6.m4.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.6.m4.1.1.3.2.cmml" xref="S2.SS1.p2.6.m4.1.1.3.2">𝑃</ci><ci id="S2.SS1.p2.6.m4.1.1.3.3.cmml" xref="S2.SS1.p2.6.m4.1.1.3.3">𝐵</ci></apply><apply id="S2.SS1.p2.6.m4.1.1.1.1.1.cmml" xref="S2.SS1.p2.6.m4.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p2.6.m4.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.6.m4.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p2.6.m4.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.6.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m4.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.6.m4.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p2.6.m4.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p2.6.m4.1.1.1.1.1.2.2">𝑠</ci><ci id="S2.SS1.p2.6.m4.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p2.6.m4.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS1.p2.6.m4.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m4.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.6.m4.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3.2">𝑠</ci><apply id="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3.3"><plus id="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.1.cmml" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.1"></plus><ci id="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.2.cmml" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.SS1.p2.6.m4.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m4.1c">P_{B}\left(s_{t}\mid s_{t+1}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m4.1d">italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math> is the corresponding backward probability that models the likelihood of the source state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m5.1"><semantics id="S2.SS1.p2.7.m5.1a"><msub id="S2.SS1.p2.7.m5.1.1" xref="S2.SS1.p2.7.m5.1.1.cmml"><mi id="S2.SS1.p2.7.m5.1.1.2" xref="S2.SS1.p2.7.m5.1.1.2.cmml">s</mi><mi id="S2.SS1.p2.7.m5.1.1.3" xref="S2.SS1.p2.7.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m5.1b"><apply id="S2.SS1.p2.7.m5.1.1.cmml" xref="S2.SS1.p2.7.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m5.1.1.1.cmml" xref="S2.SS1.p2.7.m5.1.1">subscript</csymbol><ci id="S2.SS1.p2.7.m5.1.1.2.cmml" xref="S2.SS1.p2.7.m5.1.1.2">𝑠</ci><ci id="S2.SS1.p2.7.m5.1.1.3.cmml" xref="S2.SS1.p2.7.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m5.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m5.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> given the outcome state <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S2.SS1.p2.8.m6.1"><semantics id="S2.SS1.p2.8.m6.1a"><msub id="S2.SS1.p2.8.m6.1.1" xref="S2.SS1.p2.8.m6.1.1.cmml"><mi id="S2.SS1.p2.8.m6.1.1.2" xref="S2.SS1.p2.8.m6.1.1.2.cmml">s</mi><mrow id="S2.SS1.p2.8.m6.1.1.3" xref="S2.SS1.p2.8.m6.1.1.3.cmml"><mi id="S2.SS1.p2.8.m6.1.1.3.2" xref="S2.SS1.p2.8.m6.1.1.3.2.cmml">t</mi><mo id="S2.SS1.p2.8.m6.1.1.3.1" xref="S2.SS1.p2.8.m6.1.1.3.1.cmml">+</mo><mn id="S2.SS1.p2.8.m6.1.1.3.3" xref="S2.SS1.p2.8.m6.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m6.1b"><apply id="S2.SS1.p2.8.m6.1.1.cmml" xref="S2.SS1.p2.8.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m6.1.1.1.cmml" xref="S2.SS1.p2.8.m6.1.1">subscript</csymbol><ci id="S2.SS1.p2.8.m6.1.1.2.cmml" xref="S2.SS1.p2.8.m6.1.1.2">𝑠</ci><apply id="S2.SS1.p2.8.m6.1.1.3.cmml" xref="S2.SS1.p2.8.m6.1.1.3"><plus id="S2.SS1.p2.8.m6.1.1.3.1.cmml" xref="S2.SS1.p2.8.m6.1.1.3.1"></plus><ci id="S2.SS1.p2.8.m6.1.1.3.2.cmml" xref="S2.SS1.p2.8.m6.1.1.3.2">𝑡</ci><cn id="S2.SS1.p2.8.m6.1.1.3.3.cmml" type="integer" xref="S2.SS1.p2.8.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m6.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.8.m6.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">The foundational work on GFNs has led to the development of an optimized variant for this objective: the Detailed Balance (DB) loss  <cite class="ltx_cite ltx_citemacro_citep">(Bengio et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib5" title="">2023</a>)</cite> that minimizes the difference between the forward view and backward view of each step-wise joint probability <math alttext="P(s_{t},s_{t+1})" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.2"><semantics id="S2.SS1.p3.1.m1.2a"><mrow id="S2.SS1.p3.1.m1.2.2" xref="S2.SS1.p3.1.m1.2.2.cmml"><mi id="S2.SS1.p3.1.m1.2.2.4" xref="S2.SS1.p3.1.m1.2.2.4.cmml">P</mi><mo id="S2.SS1.p3.1.m1.2.2.3" xref="S2.SS1.p3.1.m1.2.2.3.cmml">⁢</mo><mrow id="S2.SS1.p3.1.m1.2.2.2.2" xref="S2.SS1.p3.1.m1.2.2.2.3.cmml"><mo id="S2.SS1.p3.1.m1.2.2.2.2.3" stretchy="false" xref="S2.SS1.p3.1.m1.2.2.2.3.cmml">(</mo><msub id="S2.SS1.p3.1.m1.1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.SS1.p3.1.m1.1.1.1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS1.p3.1.m1.2.2.2.2.4" xref="S2.SS1.p3.1.m1.2.2.2.3.cmml">,</mo><msub id="S2.SS1.p3.1.m1.2.2.2.2.2" xref="S2.SS1.p3.1.m1.2.2.2.2.2.cmml"><mi id="S2.SS1.p3.1.m1.2.2.2.2.2.2" xref="S2.SS1.p3.1.m1.2.2.2.2.2.2.cmml">s</mi><mrow id="S2.SS1.p3.1.m1.2.2.2.2.2.3" xref="S2.SS1.p3.1.m1.2.2.2.2.2.3.cmml"><mi id="S2.SS1.p3.1.m1.2.2.2.2.2.3.2" xref="S2.SS1.p3.1.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="S2.SS1.p3.1.m1.2.2.2.2.2.3.1" xref="S2.SS1.p3.1.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="S2.SS1.p3.1.m1.2.2.2.2.2.3.3" xref="S2.SS1.p3.1.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS1.p3.1.m1.2.2.2.2.5" stretchy="false" xref="S2.SS1.p3.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.2b"><apply id="S2.SS1.p3.1.m1.2.2.cmml" xref="S2.SS1.p3.1.m1.2.2"><times id="S2.SS1.p3.1.m1.2.2.3.cmml" xref="S2.SS1.p3.1.m1.2.2.3"></times><ci id="S2.SS1.p3.1.m1.2.2.4.cmml" xref="S2.SS1.p3.1.m1.2.2.4">𝑃</ci><interval closure="open" id="S2.SS1.p3.1.m1.2.2.2.3.cmml" xref="S2.SS1.p3.1.m1.2.2.2.2"><apply id="S2.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="S2.SS1.p3.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS1.p3.1.m1.2.2.2.2.2.cmml" xref="S2.SS1.p3.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.2.2.2.2.2.1.cmml" xref="S2.SS1.p3.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p3.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS1.p3.1.m1.2.2.2.2.2.2">𝑠</ci><apply id="S2.SS1.p3.1.m1.2.2.2.2.2.3.cmml" xref="S2.SS1.p3.1.m1.2.2.2.2.2.3"><plus id="S2.SS1.p3.1.m1.2.2.2.2.2.3.1.cmml" xref="S2.SS1.p3.1.m1.2.2.2.2.2.3.1"></plus><ci id="S2.SS1.p3.1.m1.2.2.2.2.2.3.2.cmml" xref="S2.SS1.p3.1.m1.2.2.2.2.2.3.2">𝑡</ci><cn id="S2.SS1.p3.1.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S2.SS1.p3.1.m1.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.2c">P(s_{t},s_{t+1})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.2d">italic_P ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math>. Then the objective follows the flow matching property in the generation process which minimizes the Detailed Balance (DB) loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min\mathcal{L}_{\mathrm{DB}}\left(s_{t},s_{t+1}\right)=\left(\log\frac{%
\mathcal{F}\left(s_{t}\right)P_{F}\left(s_{t+1}\mid s_{t}\right)}{\mathcal{F}%
\left(s_{t+1}\right)P_{B}\left(s_{t}\mid s_{t+1}\right)}\right)^{2}" class="ltx_Math" display="block" id="S2.E3.m1.7"><semantics id="S2.E3.m1.7a"><mrow id="S2.E3.m1.7.7" xref="S2.E3.m1.7.7.cmml"><mrow id="S2.E3.m1.6.6.2" xref="S2.E3.m1.6.6.2.cmml"><mrow id="S2.E3.m1.6.6.2.4" xref="S2.E3.m1.6.6.2.4.cmml"><mi id="S2.E3.m1.6.6.2.4.1" xref="S2.E3.m1.6.6.2.4.1.cmml">min</mi><mo id="S2.E3.m1.6.6.2.4a" lspace="0.167em" xref="S2.E3.m1.6.6.2.4.cmml">⁡</mo><msub id="S2.E3.m1.6.6.2.4.2" xref="S2.E3.m1.6.6.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.6.6.2.4.2.2" xref="S2.E3.m1.6.6.2.4.2.2.cmml">ℒ</mi><mi id="S2.E3.m1.6.6.2.4.2.3" xref="S2.E3.m1.6.6.2.4.2.3.cmml">DB</mi></msub></mrow><mo id="S2.E3.m1.6.6.2.3" xref="S2.E3.m1.6.6.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.6.6.2.2.2" xref="S2.E3.m1.6.6.2.2.3.cmml"><mo id="S2.E3.m1.6.6.2.2.2.3" xref="S2.E3.m1.6.6.2.2.3.cmml">(</mo><msub id="S2.E3.m1.5.5.1.1.1.1" xref="S2.E3.m1.5.5.1.1.1.1.cmml"><mi id="S2.E3.m1.5.5.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.1.1.2.cmml">s</mi><mi id="S2.E3.m1.5.5.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E3.m1.6.6.2.2.2.4" xref="S2.E3.m1.6.6.2.2.3.cmml">,</mo><msub id="S2.E3.m1.6.6.2.2.2.2" xref="S2.E3.m1.6.6.2.2.2.2.cmml"><mi id="S2.E3.m1.6.6.2.2.2.2.2" xref="S2.E3.m1.6.6.2.2.2.2.2.cmml">s</mi><mrow id="S2.E3.m1.6.6.2.2.2.2.3" xref="S2.E3.m1.6.6.2.2.2.2.3.cmml"><mi id="S2.E3.m1.6.6.2.2.2.2.3.2" xref="S2.E3.m1.6.6.2.2.2.2.3.2.cmml">t</mi><mo id="S2.E3.m1.6.6.2.2.2.2.3.1" xref="S2.E3.m1.6.6.2.2.2.2.3.1.cmml">+</mo><mn id="S2.E3.m1.6.6.2.2.2.2.3.3" xref="S2.E3.m1.6.6.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E3.m1.6.6.2.2.2.5" xref="S2.E3.m1.6.6.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.7.7.4" xref="S2.E3.m1.7.7.4.cmml">=</mo><msup id="S2.E3.m1.7.7.3" xref="S2.E3.m1.7.7.3.cmml"><mrow id="S2.E3.m1.7.7.3.1.1" xref="S2.E3.m1.7.7.3.1.1.1.cmml"><mo id="S2.E3.m1.7.7.3.1.1.2" xref="S2.E3.m1.7.7.3.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.7.7.3.1.1.1" xref="S2.E3.m1.7.7.3.1.1.1.cmml"><mi id="S2.E3.m1.7.7.3.1.1.1.1" xref="S2.E3.m1.7.7.3.1.1.1.1.cmml">log</mi><mo id="S2.E3.m1.7.7.3.1.1.1a" lspace="0.167em" xref="S2.E3.m1.7.7.3.1.1.1.cmml">⁡</mo><mfrac id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml"><mrow id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.2.4" xref="S2.E3.m1.2.2.2.4.cmml">ℱ</mi><mo id="S2.E3.m1.2.2.2.3" xref="S2.E3.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E3.m1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.2.2.2.3a" xref="S2.E3.m1.2.2.2.3.cmml">⁢</mo><msub id="S2.E3.m1.2.2.2.5" xref="S2.E3.m1.2.2.2.5.cmml"><mi id="S2.E3.m1.2.2.2.5.2" xref="S2.E3.m1.2.2.2.5.2.cmml">P</mi><mi id="S2.E3.m1.2.2.2.5.3" xref="S2.E3.m1.2.2.2.5.3.cmml">F</mi></msub><mo id="S2.E3.m1.2.2.2.3b" xref="S2.E3.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.2.2.1" xref="S2.E3.m1.2.2.2.2.1.1.cmml"><mo id="S2.E3.m1.2.2.2.2.1.2" xref="S2.E3.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.2.2.1.1" xref="S2.E3.m1.2.2.2.2.1.1.cmml"><msub id="S2.E3.m1.2.2.2.2.1.1.2" xref="S2.E3.m1.2.2.2.2.1.1.2.cmml"><mi id="S2.E3.m1.2.2.2.2.1.1.2.2" xref="S2.E3.m1.2.2.2.2.1.1.2.2.cmml">s</mi><mrow id="S2.E3.m1.2.2.2.2.1.1.2.3" xref="S2.E3.m1.2.2.2.2.1.1.2.3.cmml"><mi id="S2.E3.m1.2.2.2.2.1.1.2.3.2" xref="S2.E3.m1.2.2.2.2.1.1.2.3.2.cmml">t</mi><mo id="S2.E3.m1.2.2.2.2.1.1.2.3.1" xref="S2.E3.m1.2.2.2.2.1.1.2.3.1.cmml">+</mo><mn id="S2.E3.m1.2.2.2.2.1.1.2.3.3" xref="S2.E3.m1.2.2.2.2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E3.m1.2.2.2.2.1.1.1" xref="S2.E3.m1.2.2.2.2.1.1.1.cmml">∣</mo><msub id="S2.E3.m1.2.2.2.2.1.1.3" xref="S2.E3.m1.2.2.2.2.1.1.3.cmml"><mi id="S2.E3.m1.2.2.2.2.1.1.3.2" xref="S2.E3.m1.2.2.2.2.1.1.3.2.cmml">s</mi><mi id="S2.E3.m1.2.2.2.2.1.1.3.3" xref="S2.E3.m1.2.2.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E3.m1.2.2.2.2.1.3" xref="S2.E3.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E3.m1.4.4.4" xref="S2.E3.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.4.4.4.4" xref="S2.E3.m1.4.4.4.4.cmml">ℱ</mi><mo id="S2.E3.m1.4.4.4.3" xref="S2.E3.m1.4.4.4.3.cmml">⁢</mo><mrow id="S2.E3.m1.3.3.3.1.1" xref="S2.E3.m1.3.3.3.1.1.1.cmml"><mo id="S2.E3.m1.3.3.3.1.1.2" xref="S2.E3.m1.3.3.3.1.1.1.cmml">(</mo><msub id="S2.E3.m1.3.3.3.1.1.1" xref="S2.E3.m1.3.3.3.1.1.1.cmml"><mi id="S2.E3.m1.3.3.3.1.1.1.2" xref="S2.E3.m1.3.3.3.1.1.1.2.cmml">s</mi><mrow id="S2.E3.m1.3.3.3.1.1.1.3" xref="S2.E3.m1.3.3.3.1.1.1.3.cmml"><mi id="S2.E3.m1.3.3.3.1.1.1.3.2" xref="S2.E3.m1.3.3.3.1.1.1.3.2.cmml">t</mi><mo id="S2.E3.m1.3.3.3.1.1.1.3.1" xref="S2.E3.m1.3.3.3.1.1.1.3.1.cmml">+</mo><mn id="S2.E3.m1.3.3.3.1.1.1.3.3" xref="S2.E3.m1.3.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S2.E3.m1.3.3.3.1.1.3" xref="S2.E3.m1.3.3.3.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.4.4.4.3a" xref="S2.E3.m1.4.4.4.3.cmml">⁢</mo><msub id="S2.E3.m1.4.4.4.5" xref="S2.E3.m1.4.4.4.5.cmml"><mi id="S2.E3.m1.4.4.4.5.2" xref="S2.E3.m1.4.4.4.5.2.cmml">P</mi><mi id="S2.E3.m1.4.4.4.5.3" xref="S2.E3.m1.4.4.4.5.3.cmml">B</mi></msub><mo id="S2.E3.m1.4.4.4.3b" xref="S2.E3.m1.4.4.4.3.cmml">⁢</mo><mrow id="S2.E3.m1.4.4.4.2.1" xref="S2.E3.m1.4.4.4.2.1.1.cmml"><mo id="S2.E3.m1.4.4.4.2.1.2" xref="S2.E3.m1.4.4.4.2.1.1.cmml">(</mo><mrow id="S2.E3.m1.4.4.4.2.1.1" xref="S2.E3.m1.4.4.4.2.1.1.cmml"><msub id="S2.E3.m1.4.4.4.2.1.1.2" xref="S2.E3.m1.4.4.4.2.1.1.2.cmml"><mi id="S2.E3.m1.4.4.4.2.1.1.2.2" xref="S2.E3.m1.4.4.4.2.1.1.2.2.cmml">s</mi><mi id="S2.E3.m1.4.4.4.2.1.1.2.3" xref="S2.E3.m1.4.4.4.2.1.1.2.3.cmml">t</mi></msub><mo id="S2.E3.m1.4.4.4.2.1.1.1" xref="S2.E3.m1.4.4.4.2.1.1.1.cmml">∣</mo><msub id="S2.E3.m1.4.4.4.2.1.1.3" xref="S2.E3.m1.4.4.4.2.1.1.3.cmml"><mi id="S2.E3.m1.4.4.4.2.1.1.3.2" xref="S2.E3.m1.4.4.4.2.1.1.3.2.cmml">s</mi><mrow id="S2.E3.m1.4.4.4.2.1.1.3.3" xref="S2.E3.m1.4.4.4.2.1.1.3.3.cmml"><mi id="S2.E3.m1.4.4.4.2.1.1.3.3.2" xref="S2.E3.m1.4.4.4.2.1.1.3.3.2.cmml">t</mi><mo id="S2.E3.m1.4.4.4.2.1.1.3.3.1" xref="S2.E3.m1.4.4.4.2.1.1.3.3.1.cmml">+</mo><mn id="S2.E3.m1.4.4.4.2.1.1.3.3.3" xref="S2.E3.m1.4.4.4.2.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.E3.m1.4.4.4.2.1.3" xref="S2.E3.m1.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S2.E3.m1.7.7.3.1.1.3" xref="S2.E3.m1.7.7.3.1.1.1.cmml">)</mo></mrow><mn id="S2.E3.m1.7.7.3.3" xref="S2.E3.m1.7.7.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.7b"><apply id="S2.E3.m1.7.7.cmml" xref="S2.E3.m1.7.7"><eq id="S2.E3.m1.7.7.4.cmml" xref="S2.E3.m1.7.7.4"></eq><apply id="S2.E3.m1.6.6.2.cmml" xref="S2.E3.m1.6.6.2"><times id="S2.E3.m1.6.6.2.3.cmml" xref="S2.E3.m1.6.6.2.3"></times><apply id="S2.E3.m1.6.6.2.4.cmml" xref="S2.E3.m1.6.6.2.4"><min id="S2.E3.m1.6.6.2.4.1.cmml" xref="S2.E3.m1.6.6.2.4.1"></min><apply id="S2.E3.m1.6.6.2.4.2.cmml" xref="S2.E3.m1.6.6.2.4.2"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.2.4.2.1.cmml" xref="S2.E3.m1.6.6.2.4.2">subscript</csymbol><ci id="S2.E3.m1.6.6.2.4.2.2.cmml" xref="S2.E3.m1.6.6.2.4.2.2">ℒ</ci><ci id="S2.E3.m1.6.6.2.4.2.3.cmml" xref="S2.E3.m1.6.6.2.4.2.3">DB</ci></apply></apply><interval closure="open" id="S2.E3.m1.6.6.2.2.3.cmml" xref="S2.E3.m1.6.6.2.2.2"><apply id="S2.E3.m1.5.5.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.2">𝑠</ci><ci id="S2.E3.m1.5.5.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E3.m1.6.6.2.2.2.2.cmml" xref="S2.E3.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.2.2.2.2.1.cmml" xref="S2.E3.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S2.E3.m1.6.6.2.2.2.2.2.cmml" xref="S2.E3.m1.6.6.2.2.2.2.2">𝑠</ci><apply id="S2.E3.m1.6.6.2.2.2.2.3.cmml" xref="S2.E3.m1.6.6.2.2.2.2.3"><plus id="S2.E3.m1.6.6.2.2.2.2.3.1.cmml" xref="S2.E3.m1.6.6.2.2.2.2.3.1"></plus><ci id="S2.E3.m1.6.6.2.2.2.2.3.2.cmml" xref="S2.E3.m1.6.6.2.2.2.2.3.2">𝑡</ci><cn id="S2.E3.m1.6.6.2.2.2.2.3.3.cmml" type="integer" xref="S2.E3.m1.6.6.2.2.2.2.3.3">1</cn></apply></apply></interval></apply><apply id="S2.E3.m1.7.7.3.cmml" xref="S2.E3.m1.7.7.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.3.2.cmml" xref="S2.E3.m1.7.7.3">superscript</csymbol><apply id="S2.E3.m1.7.7.3.1.1.1.cmml" xref="S2.E3.m1.7.7.3.1.1"><log id="S2.E3.m1.7.7.3.1.1.1.1.cmml" xref="S2.E3.m1.7.7.3.1.1.1.1"></log><apply id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4"><divide id="S2.E3.m1.4.4.5.cmml" xref="S2.E3.m1.4.4"></divide><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><times id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.3"></times><ci id="S2.E3.m1.2.2.2.4.cmml" xref="S2.E3.m1.2.2.2.4">ℱ</ci><apply id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E3.m1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E3.m1.2.2.2.5.cmml" xref="S2.E3.m1.2.2.2.5"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.5.1.cmml" xref="S2.E3.m1.2.2.2.5">subscript</csymbol><ci id="S2.E3.m1.2.2.2.5.2.cmml" xref="S2.E3.m1.2.2.2.5.2">𝑃</ci><ci id="S2.E3.m1.2.2.2.5.3.cmml" xref="S2.E3.m1.2.2.2.5.3">𝐹</ci></apply><apply id="S2.E3.m1.2.2.2.2.1.1.cmml" xref="S2.E3.m1.2.2.2.2.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1">conditional</csymbol><apply id="S2.E3.m1.2.2.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.1.1.2.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S2.E3.m1.2.2.2.2.1.1.2.2.cmml" xref="S2.E3.m1.2.2.2.2.1.1.2.2">𝑠</ci><apply id="S2.E3.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.E3.m1.2.2.2.2.1.1.2.3"><plus id="S2.E3.m1.2.2.2.2.1.1.2.3.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1.2.3.1"></plus><ci id="S2.E3.m1.2.2.2.2.1.1.2.3.2.cmml" xref="S2.E3.m1.2.2.2.2.1.1.2.3.2">𝑡</ci><cn id="S2.E3.m1.2.2.2.2.1.1.2.3.3.cmml" type="integer" xref="S2.E3.m1.2.2.2.2.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E3.m1.2.2.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.E3.m1.2.2.2.2.1.1.3.2">𝑠</ci><ci id="S2.E3.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.E3.m1.2.2.2.2.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S2.E3.m1.4.4.4.cmml" xref="S2.E3.m1.4.4.4"><times id="S2.E3.m1.4.4.4.3.cmml" xref="S2.E3.m1.4.4.4.3"></times><ci id="S2.E3.m1.4.4.4.4.cmml" xref="S2.E3.m1.4.4.4.4">ℱ</ci><apply id="S2.E3.m1.3.3.3.1.1.1.cmml" xref="S2.E3.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.3.1.1.1.1.cmml" xref="S2.E3.m1.3.3.3.1.1">subscript</csymbol><ci id="S2.E3.m1.3.3.3.1.1.1.2.cmml" xref="S2.E3.m1.3.3.3.1.1.1.2">𝑠</ci><apply id="S2.E3.m1.3.3.3.1.1.1.3.cmml" xref="S2.E3.m1.3.3.3.1.1.1.3"><plus id="S2.E3.m1.3.3.3.1.1.1.3.1.cmml" xref="S2.E3.m1.3.3.3.1.1.1.3.1"></plus><ci id="S2.E3.m1.3.3.3.1.1.1.3.2.cmml" xref="S2.E3.m1.3.3.3.1.1.1.3.2">𝑡</ci><cn id="S2.E3.m1.3.3.3.1.1.1.3.3.cmml" type="integer" xref="S2.E3.m1.3.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="S2.E3.m1.4.4.4.5.cmml" xref="S2.E3.m1.4.4.4.5"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.5.1.cmml" xref="S2.E3.m1.4.4.4.5">subscript</csymbol><ci id="S2.E3.m1.4.4.4.5.2.cmml" xref="S2.E3.m1.4.4.4.5.2">𝑃</ci><ci id="S2.E3.m1.4.4.4.5.3.cmml" xref="S2.E3.m1.4.4.4.5.3">𝐵</ci></apply><apply id="S2.E3.m1.4.4.4.2.1.1.cmml" xref="S2.E3.m1.4.4.4.2.1"><csymbol cd="latexml" id="S2.E3.m1.4.4.4.2.1.1.1.cmml" xref="S2.E3.m1.4.4.4.2.1.1.1">conditional</csymbol><apply id="S2.E3.m1.4.4.4.2.1.1.2.cmml" xref="S2.E3.m1.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.2.1.1.2.1.cmml" xref="S2.E3.m1.4.4.4.2.1.1.2">subscript</csymbol><ci id="S2.E3.m1.4.4.4.2.1.1.2.2.cmml" xref="S2.E3.m1.4.4.4.2.1.1.2.2">𝑠</ci><ci id="S2.E3.m1.4.4.4.2.1.1.2.3.cmml" xref="S2.E3.m1.4.4.4.2.1.1.2.3">𝑡</ci></apply><apply id="S2.E3.m1.4.4.4.2.1.1.3.cmml" xref="S2.E3.m1.4.4.4.2.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.2.1.1.3.1.cmml" xref="S2.E3.m1.4.4.4.2.1.1.3">subscript</csymbol><ci id="S2.E3.m1.4.4.4.2.1.1.3.2.cmml" xref="S2.E3.m1.4.4.4.2.1.1.3.2">𝑠</ci><apply id="S2.E3.m1.4.4.4.2.1.1.3.3.cmml" xref="S2.E3.m1.4.4.4.2.1.1.3.3"><plus id="S2.E3.m1.4.4.4.2.1.1.3.3.1.cmml" xref="S2.E3.m1.4.4.4.2.1.1.3.3.1"></plus><ci id="S2.E3.m1.4.4.4.2.1.1.3.3.2.cmml" xref="S2.E3.m1.4.4.4.2.1.1.3.3.2">𝑡</ci><cn id="S2.E3.m1.4.4.4.2.1.1.3.3.3.cmml" type="integer" xref="S2.E3.m1.4.4.4.2.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply><cn id="S2.E3.m1.7.7.3.3.cmml" type="integer" xref="S2.E3.m1.7.7.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.7c">\min\mathcal{L}_{\mathrm{DB}}\left(s_{t},s_{t+1}\right)=\left(\log\frac{%
\mathcal{F}\left(s_{t}\right)P_{F}\left(s_{t+1}\mid s_{t}\right)}{\mathcal{F}%
\left(s_{t+1}\right)P_{B}\left(s_{t}\mid s_{t+1}\right)}\right)^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.7d">roman_min caligraphic_L start_POSTSUBSCRIPT roman_DB end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) = ( roman_log divide start_ARG caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG start_ARG caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p3.2">By minimizing the DB loss, it strives to achieve a flow representation that is highly indicative of the target distribution.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Problem Definition</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.11">In our research, we focus on the problem of session-wise recommendation, which aims to iteratively suggest items to users and maximize both retention and immediate feedback of a user session. The session-wise recommendation for a short video application scenario is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S2.F2" title="Figure 2 ‣ 2.2. Problem Definition ‣ 2. Preliminaries ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">2</span></a>.
Formally, we consider a set of users <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">caligraphic_U</annotation></semantics></math> and a set of items <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">caligraphic_C</annotation></semantics></math>.
For each session, at any given step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_t</annotation></semantics></math>, we may receive a recommendation request from user <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1"><semantics id="S2.SS2.p1.4.m4.1a"><mrow id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml">u</mi><mo id="S2.SS2.p1.4.m4.1.1.1" xref="S2.SS2.p1.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><in id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1"></in><ci id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2">𝑢</ci><ci id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">italic_u ∈ caligraphic_U</annotation></semantics></math>, which consists of a user feature set <math alttext="\textbf{A}_{u}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><msub id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2a.cmml">A</mtext><mi id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.2a.cmml" xref="S2.SS2.p1.5.m5.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2">A</mtext></ci><ci id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">\textbf{A}_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">A start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, the user’s interaction history <math alttext="\textbf{H}_{u,t}" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m6.2"><semantics id="S2.SS2.p1.6.m6.2a"><msub id="S2.SS2.p1.6.m6.2.3" xref="S2.SS2.p1.6.m6.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p1.6.m6.2.3.2" xref="S2.SS2.p1.6.m6.2.3.2a.cmml">H</mtext><mrow id="S2.SS2.p1.6.m6.2.2.2.4" xref="S2.SS2.p1.6.m6.2.2.2.3.cmml"><mi id="S2.SS2.p1.6.m6.1.1.1.1" xref="S2.SS2.p1.6.m6.1.1.1.1.cmml">u</mi><mo id="S2.SS2.p1.6.m6.2.2.2.4.1" xref="S2.SS2.p1.6.m6.2.2.2.3.cmml">,</mo><mi id="S2.SS2.p1.6.m6.2.2.2.2" xref="S2.SS2.p1.6.m6.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.2b"><apply id="S2.SS2.p1.6.m6.2.3.cmml" xref="S2.SS2.p1.6.m6.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.2.3.1.cmml" xref="S2.SS2.p1.6.m6.2.3">subscript</csymbol><ci id="S2.SS2.p1.6.m6.2.3.2a.cmml" xref="S2.SS2.p1.6.m6.2.3.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p1.6.m6.2.3.2.cmml" xref="S2.SS2.p1.6.m6.2.3.2">H</mtext></ci><list id="S2.SS2.p1.6.m6.2.2.2.3.cmml" xref="S2.SS2.p1.6.m6.2.2.2.4"><ci id="S2.SS2.p1.6.m6.1.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1">𝑢</ci><ci id="S2.SS2.p1.6.m6.2.2.2.2.cmml" xref="S2.SS2.p1.6.m6.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.2c">\textbf{H}_{u,t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m6.2d">H start_POSTSUBSCRIPT italic_u , italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
In recommender systems, the user request provides the necessary context information to encode the current user <span class="ltx_text ltx_font_bold" id="S2.SS2.p1.11.1">state</span> <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m7.1"><semantics id="S2.SS2.p1.7.m7.1a"><msub id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml"><mi id="S2.SS2.p1.7.m7.1.1.2" xref="S2.SS2.p1.7.m7.1.1.2.cmml">s</mi><mi id="S2.SS2.p1.7.m7.1.1.3" xref="S2.SS2.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><apply id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS2.p1.7.m7.1.1.2.cmml" xref="S2.SS2.p1.7.m7.1.1.2">𝑠</ci><ci id="S2.SS2.p1.7.m7.1.1.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m7.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
Given the user request and the encoded state, the recommendation policy generates an <span class="ltx_text ltx_font_bold" id="S2.SS2.p1.11.2">action</span> <math alttext="a_{t}" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m8.1"><semantics id="S2.SS2.p1.8.m8.1a"><msub id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml"><mi id="S2.SS2.p1.8.m8.1.1.2" xref="S2.SS2.p1.8.m8.1.1.2.cmml">a</mi><mi id="S2.SS2.p1.8.m8.1.1.3" xref="S2.SS2.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><apply id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.1.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS2.p1.8.m8.1.1.2.cmml" xref="S2.SS2.p1.8.m8.1.1.2">𝑎</ci><ci id="S2.SS2.p1.8.m8.1.1.3.cmml" xref="S2.SS2.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m8.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> that corresponds to a list of items selected from <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S2.SS2.p1.9.m9.1"><semantics id="S2.SS2.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b"><ci id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.9.m9.1d">caligraphic_C</annotation></semantics></math>.
Then the user provides feedback of <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S2.SS2.p1.10.m10.1"><semantics id="S2.SS2.p1.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b"><ci id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.10.m10.1d">caligraphic_B</annotation></semantics></math> behavior types (e.g. clicks, likes, and comments) for these items which is used to calculate an <span class="ltx_text ltx_font_bold" id="S2.SS2.p1.11.3">immediate reward</span> <math alttext="r_{t}" class="ltx_Math" display="inline" id="S2.SS2.p1.11.m11.1"><semantics id="S2.SS2.p1.11.m11.1a"><msub id="S2.SS2.p1.11.m11.1.1" xref="S2.SS2.p1.11.m11.1.1.cmml"><mi id="S2.SS2.p1.11.m11.1.1.2" xref="S2.SS2.p1.11.m11.1.1.2.cmml">r</mi><mi id="S2.SS2.p1.11.m11.1.1.3" xref="S2.SS2.p1.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m11.1b"><apply id="S2.SS2.p1.11.m11.1.1.cmml" xref="S2.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.11.m11.1.1.1.cmml" xref="S2.SS2.p1.11.m11.1.1">subscript</csymbol><ci id="S2.SS2.p1.11.m11.1.1.2.cmml" xref="S2.SS2.p1.11.m11.1.1.2">𝑟</ci><ci id="S2.SS2.p1.11.m11.1.1.3.cmml" xref="S2.SS2.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m11.1c">r_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.11.m11.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{t}=\sum_{b\in\mathcal{B}}\omega_{b}\cdot y_{t,b}" class="ltx_Math" display="block" id="S2.E4.m1.2"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.3" xref="S2.E4.m1.2.3.cmml"><msub id="S2.E4.m1.2.3.2" xref="S2.E4.m1.2.3.2.cmml"><mi id="S2.E4.m1.2.3.2.2" xref="S2.E4.m1.2.3.2.2.cmml">r</mi><mi id="S2.E4.m1.2.3.2.3" xref="S2.E4.m1.2.3.2.3.cmml">t</mi></msub><mo id="S2.E4.m1.2.3.1" rspace="0.111em" xref="S2.E4.m1.2.3.1.cmml">=</mo><mrow id="S2.E4.m1.2.3.3" xref="S2.E4.m1.2.3.3.cmml"><munder id="S2.E4.m1.2.3.3.1" xref="S2.E4.m1.2.3.3.1.cmml"><mo id="S2.E4.m1.2.3.3.1.2" movablelimits="false" xref="S2.E4.m1.2.3.3.1.2.cmml">∑</mo><mrow id="S2.E4.m1.2.3.3.1.3" xref="S2.E4.m1.2.3.3.1.3.cmml"><mi id="S2.E4.m1.2.3.3.1.3.2" xref="S2.E4.m1.2.3.3.1.3.2.cmml">b</mi><mo id="S2.E4.m1.2.3.3.1.3.1" xref="S2.E4.m1.2.3.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.2.3.3.1.3.3" xref="S2.E4.m1.2.3.3.1.3.3.cmml">ℬ</mi></mrow></munder><mrow id="S2.E4.m1.2.3.3.2" xref="S2.E4.m1.2.3.3.2.cmml"><msub id="S2.E4.m1.2.3.3.2.2" xref="S2.E4.m1.2.3.3.2.2.cmml"><mi id="S2.E4.m1.2.3.3.2.2.2" xref="S2.E4.m1.2.3.3.2.2.2.cmml">ω</mi><mi id="S2.E4.m1.2.3.3.2.2.3" xref="S2.E4.m1.2.3.3.2.2.3.cmml">b</mi></msub><mo id="S2.E4.m1.2.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.E4.m1.2.3.3.2.1.cmml">⋅</mo><msub id="S2.E4.m1.2.3.3.2.3" xref="S2.E4.m1.2.3.3.2.3.cmml"><mi id="S2.E4.m1.2.3.3.2.3.2" xref="S2.E4.m1.2.3.3.2.3.2.cmml">y</mi><mrow id="S2.E4.m1.2.2.2.4" xref="S2.E4.m1.2.2.2.3.cmml"><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">t</mi><mo id="S2.E4.m1.2.2.2.4.1" xref="S2.E4.m1.2.2.2.3.cmml">,</mo><mi id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.2.cmml">b</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.3.cmml" xref="S2.E4.m1.2.3"><eq id="S2.E4.m1.2.3.1.cmml" xref="S2.E4.m1.2.3.1"></eq><apply id="S2.E4.m1.2.3.2.cmml" xref="S2.E4.m1.2.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.3.2.1.cmml" xref="S2.E4.m1.2.3.2">subscript</csymbol><ci id="S2.E4.m1.2.3.2.2.cmml" xref="S2.E4.m1.2.3.2.2">𝑟</ci><ci id="S2.E4.m1.2.3.2.3.cmml" xref="S2.E4.m1.2.3.2.3">𝑡</ci></apply><apply id="S2.E4.m1.2.3.3.cmml" xref="S2.E4.m1.2.3.3"><apply id="S2.E4.m1.2.3.3.1.cmml" xref="S2.E4.m1.2.3.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.3.3.1.1.cmml" xref="S2.E4.m1.2.3.3.1">subscript</csymbol><sum id="S2.E4.m1.2.3.3.1.2.cmml" xref="S2.E4.m1.2.3.3.1.2"></sum><apply id="S2.E4.m1.2.3.3.1.3.cmml" xref="S2.E4.m1.2.3.3.1.3"><in id="S2.E4.m1.2.3.3.1.3.1.cmml" xref="S2.E4.m1.2.3.3.1.3.1"></in><ci id="S2.E4.m1.2.3.3.1.3.2.cmml" xref="S2.E4.m1.2.3.3.1.3.2">𝑏</ci><ci id="S2.E4.m1.2.3.3.1.3.3.cmml" xref="S2.E4.m1.2.3.3.1.3.3">ℬ</ci></apply></apply><apply id="S2.E4.m1.2.3.3.2.cmml" xref="S2.E4.m1.2.3.3.2"><ci id="S2.E4.m1.2.3.3.2.1.cmml" xref="S2.E4.m1.2.3.3.2.1">⋅</ci><apply id="S2.E4.m1.2.3.3.2.2.cmml" xref="S2.E4.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.3.3.2.2.1.cmml" xref="S2.E4.m1.2.3.3.2.2">subscript</csymbol><ci id="S2.E4.m1.2.3.3.2.2.2.cmml" xref="S2.E4.m1.2.3.3.2.2.2">𝜔</ci><ci id="S2.E4.m1.2.3.3.2.2.3.cmml" xref="S2.E4.m1.2.3.3.2.2.3">𝑏</ci></apply><apply id="S2.E4.m1.2.3.3.2.3.cmml" xref="S2.E4.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.3.3.2.3.1.cmml" xref="S2.E4.m1.2.3.3.2.3">subscript</csymbol><ci id="S2.E4.m1.2.3.3.2.3.2.cmml" xref="S2.E4.m1.2.3.3.2.3.2">𝑦</ci><list id="S2.E4.m1.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.4"><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝑡</ci><ci id="S2.E4.m1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2">𝑏</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">r_{t}=\sum_{b\in\mathcal{B}}\omega_{b}\cdot y_{t,b}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.2d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_b ∈ caligraphic_B end_POSTSUBSCRIPT italic_ω start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ⋅ italic_y start_POSTSUBSCRIPT italic_t , italic_b end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.21">where <math alttext="y_{t,b}" class="ltx_Math" display="inline" id="S2.SS2.p1.12.m1.2"><semantics id="S2.SS2.p1.12.m1.2a"><msub id="S2.SS2.p1.12.m1.2.3" xref="S2.SS2.p1.12.m1.2.3.cmml"><mi id="S2.SS2.p1.12.m1.2.3.2" xref="S2.SS2.p1.12.m1.2.3.2.cmml">y</mi><mrow id="S2.SS2.p1.12.m1.2.2.2.4" xref="S2.SS2.p1.12.m1.2.2.2.3.cmml"><mi id="S2.SS2.p1.12.m1.1.1.1.1" xref="S2.SS2.p1.12.m1.1.1.1.1.cmml">t</mi><mo id="S2.SS2.p1.12.m1.2.2.2.4.1" xref="S2.SS2.p1.12.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS2.p1.12.m1.2.2.2.2" xref="S2.SS2.p1.12.m1.2.2.2.2.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m1.2b"><apply id="S2.SS2.p1.12.m1.2.3.cmml" xref="S2.SS2.p1.12.m1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m1.2.3.1.cmml" xref="S2.SS2.p1.12.m1.2.3">subscript</csymbol><ci id="S2.SS2.p1.12.m1.2.3.2.cmml" xref="S2.SS2.p1.12.m1.2.3.2">𝑦</ci><list id="S2.SS2.p1.12.m1.2.2.2.3.cmml" xref="S2.SS2.p1.12.m1.2.2.2.4"><ci id="S2.SS2.p1.12.m1.1.1.1.1.cmml" xref="S2.SS2.p1.12.m1.1.1.1.1">𝑡</ci><ci id="S2.SS2.p1.12.m1.2.2.2.2.cmml" xref="S2.SS2.p1.12.m1.2.2.2.2">𝑏</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m1.2c">y_{t,b}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.12.m1.2d">italic_y start_POSTSUBSCRIPT italic_t , italic_b end_POSTSUBSCRIPT</annotation></semantics></math> represents the user’s feedback in behavior <math alttext="b" class="ltx_Math" display="inline" id="S2.SS2.p1.13.m2.1"><semantics id="S2.SS2.p1.13.m2.1a"><mi id="S2.SS2.p1.13.m2.1.1" xref="S2.SS2.p1.13.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m2.1b"><ci id="S2.SS2.p1.13.m2.1.1.cmml" xref="S2.SS2.p1.13.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.m2.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.13.m2.1d">italic_b</annotation></semantics></math> at step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS2.p1.14.m3.1"><semantics id="S2.SS2.p1.14.m3.1a"><mi id="S2.SS2.p1.14.m3.1.1" xref="S2.SS2.p1.14.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.m3.1b"><ci id="S2.SS2.p1.14.m3.1.1.cmml" xref="S2.SS2.p1.14.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.14.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.14.m3.1d">italic_t</annotation></semantics></math>, and <math alttext="\omega_{b}" class="ltx_Math" display="inline" id="S2.SS2.p1.15.m4.1"><semantics id="S2.SS2.p1.15.m4.1a"><msub id="S2.SS2.p1.15.m4.1.1" xref="S2.SS2.p1.15.m4.1.1.cmml"><mi id="S2.SS2.p1.15.m4.1.1.2" xref="S2.SS2.p1.15.m4.1.1.2.cmml">ω</mi><mi id="S2.SS2.p1.15.m4.1.1.3" xref="S2.SS2.p1.15.m4.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.15.m4.1b"><apply id="S2.SS2.p1.15.m4.1.1.cmml" xref="S2.SS2.p1.15.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.15.m4.1.1.1.cmml" xref="S2.SS2.p1.15.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.15.m4.1.1.2.cmml" xref="S2.SS2.p1.15.m4.1.1.2">𝜔</ci><ci id="S2.SS2.p1.15.m4.1.1.3.cmml" xref="S2.SS2.p1.15.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.15.m4.1c">\omega_{b}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.15.m4.1d">italic_ω start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> is the weight for behavior <math alttext="b" class="ltx_Math" display="inline" id="S2.SS2.p1.16.m5.1"><semantics id="S2.SS2.p1.16.m5.1a"><mi id="S2.SS2.p1.16.m5.1.1" xref="S2.SS2.p1.16.m5.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.16.m5.1b"><ci id="S2.SS2.p1.16.m5.1.1.cmml" xref="S2.SS2.p1.16.m5.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.16.m5.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.16.m5.1d">italic_b</annotation></semantics></math>.
By the end of the session (i.e. at <math alttext="s_{T}" class="ltx_Math" display="inline" id="S2.SS2.p1.17.m6.1"><semantics id="S2.SS2.p1.17.m6.1a"><msub id="S2.SS2.p1.17.m6.1.1" xref="S2.SS2.p1.17.m6.1.1.cmml"><mi id="S2.SS2.p1.17.m6.1.1.2" xref="S2.SS2.p1.17.m6.1.1.2.cmml">s</mi><mi id="S2.SS2.p1.17.m6.1.1.3" xref="S2.SS2.p1.17.m6.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.17.m6.1b"><apply id="S2.SS2.p1.17.m6.1.1.cmml" xref="S2.SS2.p1.17.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.17.m6.1.1.1.cmml" xref="S2.SS2.p1.17.m6.1.1">subscript</csymbol><ci id="S2.SS2.p1.17.m6.1.1.2.cmml" xref="S2.SS2.p1.17.m6.1.1.2">𝑠</ci><ci id="S2.SS2.p1.17.m6.1.1.3.cmml" xref="S2.SS2.p1.17.m6.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.17.m6.1c">s_{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.17.m6.1d">italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>), we also observe the <span class="ltx_text ltx_font_bold" id="S2.SS2.p1.21.1">user retention reward</span> <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S2.SS2.p1.18.m7.1"><semantics id="S2.SS2.p1.18.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.18.m7.1.1" xref="S2.SS2.p1.18.m7.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.18.m7.1b"><ci id="S2.SS2.p1.18.m7.1.1.cmml" xref="S2.SS2.p1.18.m7.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.18.m7.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.18.m7.1d">caligraphic_R</annotation></semantics></math> defined as the user return frequency which is the core metric in this work.
We organize each sample as the tuple <math alttext="(\mathbf{S},a_{1},\dots,a_{T},r_{1},\dots,r_{T},\mathcal{R})" class="ltx_Math" display="inline" id="S2.SS2.p1.19.m8.8"><semantics id="S2.SS2.p1.19.m8.8a"><mrow id="S2.SS2.p1.19.m8.8.8.4" xref="S2.SS2.p1.19.m8.8.8.5.cmml"><mo id="S2.SS2.p1.19.m8.8.8.4.5" stretchy="false" xref="S2.SS2.p1.19.m8.8.8.5.cmml">(</mo><mi id="S2.SS2.p1.19.m8.1.1" xref="S2.SS2.p1.19.m8.1.1.cmml">𝐒</mi><mo id="S2.SS2.p1.19.m8.8.8.4.6" xref="S2.SS2.p1.19.m8.8.8.5.cmml">,</mo><msub id="S2.SS2.p1.19.m8.5.5.1.1" xref="S2.SS2.p1.19.m8.5.5.1.1.cmml"><mi id="S2.SS2.p1.19.m8.5.5.1.1.2" xref="S2.SS2.p1.19.m8.5.5.1.1.2.cmml">a</mi><mn id="S2.SS2.p1.19.m8.5.5.1.1.3" xref="S2.SS2.p1.19.m8.5.5.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.19.m8.8.8.4.7" xref="S2.SS2.p1.19.m8.8.8.5.cmml">,</mo><mi id="S2.SS2.p1.19.m8.2.2" mathvariant="normal" xref="S2.SS2.p1.19.m8.2.2.cmml">…</mi><mo id="S2.SS2.p1.19.m8.8.8.4.8" xref="S2.SS2.p1.19.m8.8.8.5.cmml">,</mo><msub id="S2.SS2.p1.19.m8.6.6.2.2" xref="S2.SS2.p1.19.m8.6.6.2.2.cmml"><mi id="S2.SS2.p1.19.m8.6.6.2.2.2" xref="S2.SS2.p1.19.m8.6.6.2.2.2.cmml">a</mi><mi id="S2.SS2.p1.19.m8.6.6.2.2.3" xref="S2.SS2.p1.19.m8.6.6.2.2.3.cmml">T</mi></msub><mo id="S2.SS2.p1.19.m8.8.8.4.9" xref="S2.SS2.p1.19.m8.8.8.5.cmml">,</mo><msub id="S2.SS2.p1.19.m8.7.7.3.3" xref="S2.SS2.p1.19.m8.7.7.3.3.cmml"><mi id="S2.SS2.p1.19.m8.7.7.3.3.2" xref="S2.SS2.p1.19.m8.7.7.3.3.2.cmml">r</mi><mn id="S2.SS2.p1.19.m8.7.7.3.3.3" xref="S2.SS2.p1.19.m8.7.7.3.3.3.cmml">1</mn></msub><mo id="S2.SS2.p1.19.m8.8.8.4.10" xref="S2.SS2.p1.19.m8.8.8.5.cmml">,</mo><mi id="S2.SS2.p1.19.m8.3.3" mathvariant="normal" xref="S2.SS2.p1.19.m8.3.3.cmml">…</mi><mo id="S2.SS2.p1.19.m8.8.8.4.11" xref="S2.SS2.p1.19.m8.8.8.5.cmml">,</mo><msub id="S2.SS2.p1.19.m8.8.8.4.4" xref="S2.SS2.p1.19.m8.8.8.4.4.cmml"><mi id="S2.SS2.p1.19.m8.8.8.4.4.2" xref="S2.SS2.p1.19.m8.8.8.4.4.2.cmml">r</mi><mi id="S2.SS2.p1.19.m8.8.8.4.4.3" xref="S2.SS2.p1.19.m8.8.8.4.4.3.cmml">T</mi></msub><mo id="S2.SS2.p1.19.m8.8.8.4.12" xref="S2.SS2.p1.19.m8.8.8.5.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.19.m8.4.4" xref="S2.SS2.p1.19.m8.4.4.cmml">ℛ</mi><mo id="S2.SS2.p1.19.m8.8.8.4.13" stretchy="false" xref="S2.SS2.p1.19.m8.8.8.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.19.m8.8b"><vector id="S2.SS2.p1.19.m8.8.8.5.cmml" xref="S2.SS2.p1.19.m8.8.8.4"><ci id="S2.SS2.p1.19.m8.1.1.cmml" xref="S2.SS2.p1.19.m8.1.1">𝐒</ci><apply id="S2.SS2.p1.19.m8.5.5.1.1.cmml" xref="S2.SS2.p1.19.m8.5.5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m8.5.5.1.1.1.cmml" xref="S2.SS2.p1.19.m8.5.5.1.1">subscript</csymbol><ci id="S2.SS2.p1.19.m8.5.5.1.1.2.cmml" xref="S2.SS2.p1.19.m8.5.5.1.1.2">𝑎</ci><cn id="S2.SS2.p1.19.m8.5.5.1.1.3.cmml" type="integer" xref="S2.SS2.p1.19.m8.5.5.1.1.3">1</cn></apply><ci id="S2.SS2.p1.19.m8.2.2.cmml" xref="S2.SS2.p1.19.m8.2.2">…</ci><apply id="S2.SS2.p1.19.m8.6.6.2.2.cmml" xref="S2.SS2.p1.19.m8.6.6.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m8.6.6.2.2.1.cmml" xref="S2.SS2.p1.19.m8.6.6.2.2">subscript</csymbol><ci id="S2.SS2.p1.19.m8.6.6.2.2.2.cmml" xref="S2.SS2.p1.19.m8.6.6.2.2.2">𝑎</ci><ci id="S2.SS2.p1.19.m8.6.6.2.2.3.cmml" xref="S2.SS2.p1.19.m8.6.6.2.2.3">𝑇</ci></apply><apply id="S2.SS2.p1.19.m8.7.7.3.3.cmml" xref="S2.SS2.p1.19.m8.7.7.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m8.7.7.3.3.1.cmml" xref="S2.SS2.p1.19.m8.7.7.3.3">subscript</csymbol><ci id="S2.SS2.p1.19.m8.7.7.3.3.2.cmml" xref="S2.SS2.p1.19.m8.7.7.3.3.2">𝑟</ci><cn id="S2.SS2.p1.19.m8.7.7.3.3.3.cmml" type="integer" xref="S2.SS2.p1.19.m8.7.7.3.3.3">1</cn></apply><ci id="S2.SS2.p1.19.m8.3.3.cmml" xref="S2.SS2.p1.19.m8.3.3">…</ci><apply id="S2.SS2.p1.19.m8.8.8.4.4.cmml" xref="S2.SS2.p1.19.m8.8.8.4.4"><csymbol cd="ambiguous" id="S2.SS2.p1.19.m8.8.8.4.4.1.cmml" xref="S2.SS2.p1.19.m8.8.8.4.4">subscript</csymbol><ci id="S2.SS2.p1.19.m8.8.8.4.4.2.cmml" xref="S2.SS2.p1.19.m8.8.8.4.4.2">𝑟</ci><ci id="S2.SS2.p1.19.m8.8.8.4.4.3.cmml" xref="S2.SS2.p1.19.m8.8.8.4.4.3">𝑇</ci></apply><ci id="S2.SS2.p1.19.m8.4.4.cmml" xref="S2.SS2.p1.19.m8.4.4">ℛ</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.19.m8.8c">(\mathbf{S},a_{1},\dots,a_{T},r_{1},\dots,r_{T},\mathcal{R})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.19.m8.8d">( bold_S , italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_r start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , caligraphic_R )</annotation></semantics></math> that consists of the observed states (i.e. user requests), actions, immediate rewards, and the retention reward of a session.
And we set two <span class="ltx_text ltx_font_bold" id="S2.SS2.p1.21.2">goals</span> in our problem setting:
1) find a valid reward design <math alttext="R(\mathbf{S})=f(r_{1},\dots,r_{T},\mathcal{R})" class="ltx_Math" display="inline" id="S2.SS2.p1.20.m9.5"><semantics id="S2.SS2.p1.20.m9.5a"><mrow id="S2.SS2.p1.20.m9.5.5" xref="S2.SS2.p1.20.m9.5.5.cmml"><mrow id="S2.SS2.p1.20.m9.5.5.4" xref="S2.SS2.p1.20.m9.5.5.4.cmml"><mi id="S2.SS2.p1.20.m9.5.5.4.2" xref="S2.SS2.p1.20.m9.5.5.4.2.cmml">R</mi><mo id="S2.SS2.p1.20.m9.5.5.4.1" xref="S2.SS2.p1.20.m9.5.5.4.1.cmml">⁢</mo><mrow id="S2.SS2.p1.20.m9.5.5.4.3.2" xref="S2.SS2.p1.20.m9.5.5.4.cmml"><mo id="S2.SS2.p1.20.m9.5.5.4.3.2.1" stretchy="false" xref="S2.SS2.p1.20.m9.5.5.4.cmml">(</mo><mi id="S2.SS2.p1.20.m9.1.1" xref="S2.SS2.p1.20.m9.1.1.cmml">𝐒</mi><mo id="S2.SS2.p1.20.m9.5.5.4.3.2.2" stretchy="false" xref="S2.SS2.p1.20.m9.5.5.4.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.20.m9.5.5.3" xref="S2.SS2.p1.20.m9.5.5.3.cmml">=</mo><mrow id="S2.SS2.p1.20.m9.5.5.2" xref="S2.SS2.p1.20.m9.5.5.2.cmml"><mi id="S2.SS2.p1.20.m9.5.5.2.4" xref="S2.SS2.p1.20.m9.5.5.2.4.cmml">f</mi><mo id="S2.SS2.p1.20.m9.5.5.2.3" xref="S2.SS2.p1.20.m9.5.5.2.3.cmml">⁢</mo><mrow id="S2.SS2.p1.20.m9.5.5.2.2.2" xref="S2.SS2.p1.20.m9.5.5.2.2.3.cmml"><mo id="S2.SS2.p1.20.m9.5.5.2.2.2.3" stretchy="false" xref="S2.SS2.p1.20.m9.5.5.2.2.3.cmml">(</mo><msub id="S2.SS2.p1.20.m9.4.4.1.1.1.1" xref="S2.SS2.p1.20.m9.4.4.1.1.1.1.cmml"><mi id="S2.SS2.p1.20.m9.4.4.1.1.1.1.2" xref="S2.SS2.p1.20.m9.4.4.1.1.1.1.2.cmml">r</mi><mn id="S2.SS2.p1.20.m9.4.4.1.1.1.1.3" xref="S2.SS2.p1.20.m9.4.4.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.20.m9.5.5.2.2.2.4" xref="S2.SS2.p1.20.m9.5.5.2.2.3.cmml">,</mo><mi id="S2.SS2.p1.20.m9.2.2" mathvariant="normal" xref="S2.SS2.p1.20.m9.2.2.cmml">…</mi><mo id="S2.SS2.p1.20.m9.5.5.2.2.2.5" xref="S2.SS2.p1.20.m9.5.5.2.2.3.cmml">,</mo><msub id="S2.SS2.p1.20.m9.5.5.2.2.2.2" xref="S2.SS2.p1.20.m9.5.5.2.2.2.2.cmml"><mi id="S2.SS2.p1.20.m9.5.5.2.2.2.2.2" xref="S2.SS2.p1.20.m9.5.5.2.2.2.2.2.cmml">r</mi><mi id="S2.SS2.p1.20.m9.5.5.2.2.2.2.3" xref="S2.SS2.p1.20.m9.5.5.2.2.2.2.3.cmml">T</mi></msub><mo id="S2.SS2.p1.20.m9.5.5.2.2.2.6" xref="S2.SS2.p1.20.m9.5.5.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.20.m9.3.3" xref="S2.SS2.p1.20.m9.3.3.cmml">ℛ</mi><mo id="S2.SS2.p1.20.m9.5.5.2.2.2.7" stretchy="false" xref="S2.SS2.p1.20.m9.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.20.m9.5b"><apply id="S2.SS2.p1.20.m9.5.5.cmml" xref="S2.SS2.p1.20.m9.5.5"><eq id="S2.SS2.p1.20.m9.5.5.3.cmml" xref="S2.SS2.p1.20.m9.5.5.3"></eq><apply id="S2.SS2.p1.20.m9.5.5.4.cmml" xref="S2.SS2.p1.20.m9.5.5.4"><times id="S2.SS2.p1.20.m9.5.5.4.1.cmml" xref="S2.SS2.p1.20.m9.5.5.4.1"></times><ci id="S2.SS2.p1.20.m9.5.5.4.2.cmml" xref="S2.SS2.p1.20.m9.5.5.4.2">𝑅</ci><ci id="S2.SS2.p1.20.m9.1.1.cmml" xref="S2.SS2.p1.20.m9.1.1">𝐒</ci></apply><apply id="S2.SS2.p1.20.m9.5.5.2.cmml" xref="S2.SS2.p1.20.m9.5.5.2"><times id="S2.SS2.p1.20.m9.5.5.2.3.cmml" xref="S2.SS2.p1.20.m9.5.5.2.3"></times><ci id="S2.SS2.p1.20.m9.5.5.2.4.cmml" xref="S2.SS2.p1.20.m9.5.5.2.4">𝑓</ci><vector id="S2.SS2.p1.20.m9.5.5.2.2.3.cmml" xref="S2.SS2.p1.20.m9.5.5.2.2.2"><apply id="S2.SS2.p1.20.m9.4.4.1.1.1.1.cmml" xref="S2.SS2.p1.20.m9.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m9.4.4.1.1.1.1.1.cmml" xref="S2.SS2.p1.20.m9.4.4.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.20.m9.4.4.1.1.1.1.2.cmml" xref="S2.SS2.p1.20.m9.4.4.1.1.1.1.2">𝑟</ci><cn id="S2.SS2.p1.20.m9.4.4.1.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.20.m9.4.4.1.1.1.1.3">1</cn></apply><ci id="S2.SS2.p1.20.m9.2.2.cmml" xref="S2.SS2.p1.20.m9.2.2">…</ci><apply id="S2.SS2.p1.20.m9.5.5.2.2.2.2.cmml" xref="S2.SS2.p1.20.m9.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m9.5.5.2.2.2.2.1.cmml" xref="S2.SS2.p1.20.m9.5.5.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.20.m9.5.5.2.2.2.2.2.cmml" xref="S2.SS2.p1.20.m9.5.5.2.2.2.2.2">𝑟</ci><ci id="S2.SS2.p1.20.m9.5.5.2.2.2.2.3.cmml" xref="S2.SS2.p1.20.m9.5.5.2.2.2.2.3">𝑇</ci></apply><ci id="S2.SS2.p1.20.m9.3.3.cmml" xref="S2.SS2.p1.20.m9.3.3">ℛ</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.20.m9.5c">R(\mathbf{S})=f(r_{1},\dots,r_{T},\mathcal{R})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.20.m9.5d">italic_R ( bold_S ) = italic_f ( italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_r start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , caligraphic_R )</annotation></semantics></math> that combines the retention reward and the cumulative immediate rewards, and helps boost the overall recommendation performance;
2) learn a recommendation policy that explores and achieves a better combined reward of <math alttext="R(\mathbf{S})" class="ltx_Math" display="inline" id="S2.SS2.p1.21.m10.1"><semantics id="S2.SS2.p1.21.m10.1a"><mrow id="S2.SS2.p1.21.m10.1.2" xref="S2.SS2.p1.21.m10.1.2.cmml"><mi id="S2.SS2.p1.21.m10.1.2.2" xref="S2.SS2.p1.21.m10.1.2.2.cmml">R</mi><mo id="S2.SS2.p1.21.m10.1.2.1" xref="S2.SS2.p1.21.m10.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p1.21.m10.1.2.3.2" xref="S2.SS2.p1.21.m10.1.2.cmml"><mo id="S2.SS2.p1.21.m10.1.2.3.2.1" stretchy="false" xref="S2.SS2.p1.21.m10.1.2.cmml">(</mo><mi id="S2.SS2.p1.21.m10.1.1" xref="S2.SS2.p1.21.m10.1.1.cmml">𝐒</mi><mo id="S2.SS2.p1.21.m10.1.2.3.2.2" stretchy="false" xref="S2.SS2.p1.21.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.21.m10.1b"><apply id="S2.SS2.p1.21.m10.1.2.cmml" xref="S2.SS2.p1.21.m10.1.2"><times id="S2.SS2.p1.21.m10.1.2.1.cmml" xref="S2.SS2.p1.21.m10.1.2.1"></times><ci id="S2.SS2.p1.21.m10.1.2.2.cmml" xref="S2.SS2.p1.21.m10.1.2.2">𝑅</ci><ci id="S2.SS2.p1.21.m10.1.1.cmml" xref="S2.SS2.p1.21.m10.1.1">𝐒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.21.m10.1c">R(\mathbf{S})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.21.m10.1d">italic_R ( bold_S )</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="316" id="S2.F2.g1" src="x2.png" width="814"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Session-wise Recommendation Example</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>THE PROPOSED Framework</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we present our GFN4Retention framework.
As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S2.F1" title="Figure 1 ‣ 2. Preliminaries ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">1</span></a>, the main framework includes a feature extraction module that encodes user request context into the user state, a flow estimation module that models the generative flow of user sessions, and a modified detailed balance learning objective with integrated reward design.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="367" id="S3.F3.g1" src="x3.png" width="814"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Framework of User State Encoder</figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>User State Encoding</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.8">While real-world online platforms heavily depend on navigating the intricate user dynamics as well as their static features, the challenge of retention optimization in this scenario is not only the identification of diverse user patterns but also the agility to adjust to rapid changes in these patterns. In our design, upon receiving a recommendation request from a user <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">u</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑢</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_u ∈ caligraphic_U</annotation></semantics></math>, we consider two major types of input including the user’s feature set <math alttext="\mathbf{A}_{u}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">𝐀</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝐀</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathbf{A}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">bold_A start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and the interaction history <math alttext="\mathbf{H}_{u,t}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.2"><semantics id="S3.SS1.p1.3.m3.2a"><msub id="S3.SS1.p1.3.m3.2.3" xref="S3.SS1.p1.3.m3.2.3.cmml"><mi id="S3.SS1.p1.3.m3.2.3.2" xref="S3.SS1.p1.3.m3.2.3.2.cmml">𝐇</mi><mrow id="S3.SS1.p1.3.m3.2.2.2.4" xref="S3.SS1.p1.3.m3.2.2.2.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.cmml">u</mi><mo id="S3.SS1.p1.3.m3.2.2.2.4.1" xref="S3.SS1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.3.m3.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.2b"><apply id="S3.SS1.p1.3.m3.2.3.cmml" xref="S3.SS1.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.3.1.cmml" xref="S3.SS1.p1.3.m3.2.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.3.2.cmml" xref="S3.SS1.p1.3.m3.2.3.2">𝐇</ci><list id="S3.SS1.p1.3.m3.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.2.4"><ci id="S3.SS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1">𝑢</ci><ci id="S3.SS1.p1.3.m3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.2c">\mathbf{H}_{u,t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.2d">bold_H start_POSTSUBSCRIPT italic_u , italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
To better employ the dynamics in the user history and find patterns in the items’ mutual influences, we first process the history <math alttext="\mathbf{H}_{u,t}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.2"><semantics id="S3.SS1.p1.4.m4.2a"><msub id="S3.SS1.p1.4.m4.2.3" xref="S3.SS1.p1.4.m4.2.3.cmml"><mi id="S3.SS1.p1.4.m4.2.3.2" xref="S3.SS1.p1.4.m4.2.3.2.cmml">𝐇</mi><mrow id="S3.SS1.p1.4.m4.2.2.2.4" xref="S3.SS1.p1.4.m4.2.2.2.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.cmml">u</mi><mo id="S3.SS1.p1.4.m4.2.2.2.4.1" xref="S3.SS1.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.4.m4.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.2b"><apply id="S3.SS1.p1.4.m4.2.3.cmml" xref="S3.SS1.p1.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.3.1.cmml" xref="S3.SS1.p1.4.m4.2.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.3.2.cmml" xref="S3.SS1.p1.4.m4.2.3.2">𝐇</ci><list id="S3.SS1.p1.4.m4.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2.4"><ci id="S3.SS1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1">𝑢</ci><ci id="S3.SS1.p1.4.m4.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.2c">\mathbf{H}_{u,t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.2d">bold_H start_POSTSUBSCRIPT italic_u , italic_t end_POSTSUBSCRIPT</annotation></semantics></math> with a transformer, and the last output embedding is considered as the history encoding.
Then, a user feature embedding generated from <math alttext="\mathbf{A}_{u}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">𝐀</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝐀</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathbf{A}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">bold_A start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is concatenated with the history encoding and further processed by a neural network to generate an embedding <math alttext="\mathbf{e}_{u}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">𝐞</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝐞</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathbf{e}_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">bold_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> that forms the first part of the user state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><msub id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">s</mi><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑠</ci><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
In practice, we found that merely using a transformer to encode user history may over-amplify the most recent history and may ignore the feature-level interactions.
As a result, we include a DNN-based context-detecting module that encodes all the contexts in the user requests and outputs an addition embedding <math alttext="\psi_{u}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">ψ</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝜓</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\psi_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_ψ start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> that forms the second part of the user state.
The detailed framework of the feature encoder and context-detecting module is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.F3" title="Figure 3 ‣ 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">3</span></a>, which details Part (a) of Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S2.F1" title="Figure 1 ‣ 2. Preliminaries ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Recommendation Policy as Forward Flow</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.8">During inference, with the encoded user state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">s</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑠</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, we can generate the action for the recommendation.
As widely adopted in many recommender systems, the service has to recommend a list of items for each user request to meet the latency requirement of users’ frequent browsing behaviors.
This means that it is impractical to directly consider the enormous item set <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">caligraphic_C</annotation></semantics></math> as the action space.
Alternatively, we choose to consider a vector space for each action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">a</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑎</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, this vector can represent the output item list through a deterministic top-K selection module <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib34" title="">2023b</a>)</cite>.
In our design, the policy network (i.e. the forward flow estimator) will first output the statistics of the Gaussian distribution <math alttext="\mu,\sigma=\phi_{\mathrm{fw}}(s_{t})" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.3"><semantics id="S3.SS2.p1.4.m4.3a"><mrow id="S3.SS2.p1.4.m4.3.3" xref="S3.SS2.p1.4.m4.3.3.cmml"><mrow id="S3.SS2.p1.4.m4.3.3.3.2" xref="S3.SS2.p1.4.m4.3.3.3.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">μ</mi><mo id="S3.SS2.p1.4.m4.3.3.3.2.1" xref="S3.SS2.p1.4.m4.3.3.3.1.cmml">,</mo><mi id="S3.SS2.p1.4.m4.2.2" xref="S3.SS2.p1.4.m4.2.2.cmml">σ</mi></mrow><mo id="S3.SS2.p1.4.m4.3.3.2" xref="S3.SS2.p1.4.m4.3.3.2.cmml">=</mo><mrow id="S3.SS2.p1.4.m4.3.3.1" xref="S3.SS2.p1.4.m4.3.3.1.cmml"><msub id="S3.SS2.p1.4.m4.3.3.1.3" xref="S3.SS2.p1.4.m4.3.3.1.3.cmml"><mi id="S3.SS2.p1.4.m4.3.3.1.3.2" xref="S3.SS2.p1.4.m4.3.3.1.3.2.cmml">ϕ</mi><mi id="S3.SS2.p1.4.m4.3.3.1.3.3" xref="S3.SS2.p1.4.m4.3.3.1.3.3.cmml">fw</mi></msub><mo id="S3.SS2.p1.4.m4.3.3.1.2" xref="S3.SS2.p1.4.m4.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.4.m4.3.3.1.1.1" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.cmml"><mo id="S3.SS2.p1.4.m4.3.3.1.1.1.2" stretchy="false" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.4.m4.3.3.1.1.1.1" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.cmml"><mi id="S3.SS2.p1.4.m4.3.3.1.1.1.1.2" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.2.cmml">s</mi><mi id="S3.SS2.p1.4.m4.3.3.1.1.1.1.3" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.p1.4.m4.3.3.1.1.1.3" stretchy="false" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.3b"><apply id="S3.SS2.p1.4.m4.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3"><eq id="S3.SS2.p1.4.m4.3.3.2.cmml" xref="S3.SS2.p1.4.m4.3.3.2"></eq><list id="S3.SS2.p1.4.m4.3.3.3.1.cmml" xref="S3.SS2.p1.4.m4.3.3.3.2"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝜇</ci><ci id="S3.SS2.p1.4.m4.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2">𝜎</ci></list><apply id="S3.SS2.p1.4.m4.3.3.1.cmml" xref="S3.SS2.p1.4.m4.3.3.1"><times id="S3.SS2.p1.4.m4.3.3.1.2.cmml" xref="S3.SS2.p1.4.m4.3.3.1.2"></times><apply id="S3.SS2.p1.4.m4.3.3.1.3.cmml" xref="S3.SS2.p1.4.m4.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.1.3.1.cmml" xref="S3.SS2.p1.4.m4.3.3.1.3">subscript</csymbol><ci id="S3.SS2.p1.4.m4.3.3.1.3.2.cmml" xref="S3.SS2.p1.4.m4.3.3.1.3.2">italic-ϕ</ci><ci id="S3.SS2.p1.4.m4.3.3.1.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3.1.3.3">fw</ci></apply><apply id="S3.SS2.p1.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.3.3.1.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.2">𝑠</ci><ci id="S3.SS2.p1.4.m4.3.3.1.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.3.3.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.3c">\mu,\sigma=\phi_{\mathrm{fw}}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.3d">italic_μ , italic_σ = italic_ϕ start_POSTSUBSCRIPT roman_fw end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> and then sample the action vector as <math alttext="a_{t}\sim\mathcal{N}(\mu,\sigma)" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.2"><semantics id="S3.SS2.p1.5.m5.2a"><mrow id="S3.SS2.p1.5.m5.2.3" xref="S3.SS2.p1.5.m5.2.3.cmml"><msub id="S3.SS2.p1.5.m5.2.3.2" xref="S3.SS2.p1.5.m5.2.3.2.cmml"><mi id="S3.SS2.p1.5.m5.2.3.2.2" xref="S3.SS2.p1.5.m5.2.3.2.2.cmml">a</mi><mi id="S3.SS2.p1.5.m5.2.3.2.3" xref="S3.SS2.p1.5.m5.2.3.2.3.cmml">t</mi></msub><mo id="S3.SS2.p1.5.m5.2.3.1" xref="S3.SS2.p1.5.m5.2.3.1.cmml">∼</mo><mrow id="S3.SS2.p1.5.m5.2.3.3" xref="S3.SS2.p1.5.m5.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.2.3.3.2" xref="S3.SS2.p1.5.m5.2.3.3.2.cmml">𝒩</mi><mo id="S3.SS2.p1.5.m5.2.3.3.1" xref="S3.SS2.p1.5.m5.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.5.m5.2.3.3.3.2" xref="S3.SS2.p1.5.m5.2.3.3.3.1.cmml"><mo id="S3.SS2.p1.5.m5.2.3.3.3.2.1" stretchy="false" xref="S3.SS2.p1.5.m5.2.3.3.3.1.cmml">(</mo><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">μ</mi><mo id="S3.SS2.p1.5.m5.2.3.3.3.2.2" xref="S3.SS2.p1.5.m5.2.3.3.3.1.cmml">,</mo><mi id="S3.SS2.p1.5.m5.2.2" xref="S3.SS2.p1.5.m5.2.2.cmml">σ</mi><mo id="S3.SS2.p1.5.m5.2.3.3.3.2.3" stretchy="false" xref="S3.SS2.p1.5.m5.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.2b"><apply id="S3.SS2.p1.5.m5.2.3.cmml" xref="S3.SS2.p1.5.m5.2.3"><csymbol cd="latexml" id="S3.SS2.p1.5.m5.2.3.1.cmml" xref="S3.SS2.p1.5.m5.2.3.1">similar-to</csymbol><apply id="S3.SS2.p1.5.m5.2.3.2.cmml" xref="S3.SS2.p1.5.m5.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.2.3.2.1.cmml" xref="S3.SS2.p1.5.m5.2.3.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.2.3.2.2.cmml" xref="S3.SS2.p1.5.m5.2.3.2.2">𝑎</ci><ci id="S3.SS2.p1.5.m5.2.3.2.3.cmml" xref="S3.SS2.p1.5.m5.2.3.2.3">𝑡</ci></apply><apply id="S3.SS2.p1.5.m5.2.3.3.cmml" xref="S3.SS2.p1.5.m5.2.3.3"><times id="S3.SS2.p1.5.m5.2.3.3.1.cmml" xref="S3.SS2.p1.5.m5.2.3.3.1"></times><ci id="S3.SS2.p1.5.m5.2.3.3.2.cmml" xref="S3.SS2.p1.5.m5.2.3.3.2">𝒩</ci><interval closure="open" id="S3.SS2.p1.5.m5.2.3.3.3.1.cmml" xref="S3.SS2.p1.5.m5.2.3.3.3.2"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝜇</ci><ci id="S3.SS2.p1.5.m5.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2">𝜎</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.2c">a_{t}\sim\mathcal{N}(\mu,\sigma)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.2d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ caligraphic_N ( italic_μ , italic_σ )</annotation></semantics></math>.
Note that this setting is mathematically different from the original design of GFNs where a small discrete action space is adopted.
Fortunately, the flow matching property in the continuous vector space still holds (explained in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#A4" title="Appendix D Probablistic Flow in Continuous Space ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">D</span></a>) and we can safely apply the flow estimation and the detailed balance optimization as we will present in the following sections.
During training, the recommendation policy is regarded as the forward flow function <math alttext="P_{F}(s_{t+1}|s_{t})" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mrow id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><msub id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.3.2" xref="S3.SS2.p1.6.m6.1.1.3.2.cmml">P</mi><mi id="S3.SS2.p1.6.m6.1.1.3.3" xref="S3.SS2.p1.6.m6.1.1.3.3.cmml">F</mi></msub><mo id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.6.m6.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.6.m6.1.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.cmml"><msub id="S3.SS2.p1.6.m6.1.1.1.1.1.2" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.6.m6.1.1.1.1.1.2.2" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.2.cmml">s</mi><mrow id="S3.SS2.p1.6.m6.1.1.1.1.1.2.3" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.2" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.3" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.SS2.p1.6.m6.1.1.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.p1.6.m6.1.1.1.1.1.3" xref="S3.SS2.p1.6.m6.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.1.1.1.3.2" xref="S3.SS2.p1.6.m6.1.1.1.1.1.3.2.cmml">s</mi><mi id="S3.SS2.p1.6.m6.1.1.1.1.1.3.3" xref="S3.SS2.p1.6.m6.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS2.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><times id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2"></times><apply id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.3.2">𝑃</ci><ci id="S3.SS2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3">𝐹</ci></apply><apply id="S3.SS2.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS2.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.2">𝑠</ci><apply id="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.3"><plus id="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.1"></plus><ci id="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS2.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.SS2.p1.6.m6.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">P_{F}(s_{t+1}|s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> which assumes that the output action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">a</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝑎</ci><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> determines the next state <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><msub id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml">s</mi><mrow id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml"><mi id="S3.SS2.p1.8.m8.1.1.3.2" xref="S3.SS2.p1.8.m8.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p1.8.m8.1.1.3.1" xref="S3.SS2.p1.8.m8.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p1.8.m8.1.1.3.3" xref="S3.SS2.p1.8.m8.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2">𝑠</ci><apply id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3"><plus id="S3.SS2.p1.8.m8.1.1.3.1.cmml" xref="S3.SS2.p1.8.m8.1.1.3.1"></plus><ci id="S3.SS2.p1.8.m8.1.1.3.2.cmml" xref="S3.SS2.p1.8.m8.1.1.3.2">𝑡</ci><cn id="S3.SS2.p1.8.m8.1.1.3.3.cmml" type="integer" xref="S3.SS2.p1.8.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Retention Flow Estimation</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.10">Following the general design of GFNs, we include a flow estimator <math alttext="\mathcal{F}(s_{t})" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">ℱ</mi><mo id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.1.m1.1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS3.p1.1.m1.1.1.1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><times id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2"></times><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">ℱ</ci><apply id="S3.SS3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathcal{F}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> of states and a backward flow function <math alttext="P_{B}(s_{t}|s_{t+1})" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><msub id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.3.2" xref="S3.SS3.p1.2.m2.1.1.3.2.cmml">P</mi><mi id="S3.SS3.p1.2.m2.1.1.3.3" xref="S3.SS3.p1.2.m2.1.1.3.3.cmml">B</mi></msub><mo id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.2.m2.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.2.m2.1.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml"><msub id="S3.SS3.p1.2.m2.1.1.1.1.1.2" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p1.2.m2.1.1.1.1.1.2.2" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2.2.cmml">s</mi><mi id="S3.SS3.p1.2.m2.1.1.1.1.1.2.3" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.SS3.p1.2.m2.1.1.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS3.p1.2.m2.1.1.1.1.1.3" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.1.1.1.3.2" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.2.cmml">s</mi><mrow id="S3.SS3.p1.2.m2.1.1.1.1.1.3.3" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.2" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.1" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.3" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.SS3.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><times id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2"></times><apply id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.3.2">𝑃</ci><ci id="S3.SS3.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3.3">𝐵</ci></apply><apply id="S3.SS3.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2.2">𝑠</ci><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.2">𝑠</ci><apply id="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.3"><plus id="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.1"></plus><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">P_{B}(s_{t}|s_{t+1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math> that estimates the posterior.
In the session-level viewpoint, each observed session <math alttext="\mathbf{S}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\mathbf{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">bold_S</annotation></semantics></math> is a probabilistic trajectory generated by the recommendation policy.
Each state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">s</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑠</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> may diverge into different future states according to the sampling process in <math alttext="P_{F}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><msub id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">P</mi><mi id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">𝑃</ci><ci id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">P_{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math>, and it may be reachable from various previous states.
Intuitively, the state flow estimator <math alttext="\mathcal{F}(s_{t})" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><mrow id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml">ℱ</mi><mo id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.6.m6.1.1.1.1" xref="S3.SS3.p1.6.m6.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.6.m6.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.6.m6.1.1.1.1.1" xref="S3.SS3.p1.6.m6.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.6.m6.1.1.1.1.1.2" xref="S3.SS3.p1.6.m6.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS3.p1.6.m6.1.1.1.1.1.3" xref="S3.SS3.p1.6.m6.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><times id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2"></times><ci id="S3.SS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3">ℱ</ci><apply id="S3.SS3.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS3.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\mathcal{F}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> represents how likely a state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.1"><semantics id="S3.SS3.p1.7.m7.1a"><msub id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2" xref="S3.SS3.p1.7.m7.1.1.2.cmml">s</mi><mi id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2">𝑠</ci><ci id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is reached.
The backward function <math alttext="P_{B}(s_{t}|s_{t+1})=\phi_{\mathrm{bw}}(s_{t},a_{t},s_{t+1})" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.4"><semantics id="S3.SS3.p1.8.m8.4a"><mrow id="S3.SS3.p1.8.m8.4.4" xref="S3.SS3.p1.8.m8.4.4.cmml"><mrow id="S3.SS3.p1.8.m8.1.1.1" xref="S3.SS3.p1.8.m8.1.1.1.cmml"><msub id="S3.SS3.p1.8.m8.1.1.1.3" xref="S3.SS3.p1.8.m8.1.1.1.3.cmml"><mi id="S3.SS3.p1.8.m8.1.1.1.3.2" xref="S3.SS3.p1.8.m8.1.1.1.3.2.cmml">P</mi><mi id="S3.SS3.p1.8.m8.1.1.1.3.3" xref="S3.SS3.p1.8.m8.1.1.1.3.3.cmml">B</mi></msub><mo id="S3.SS3.p1.8.m8.1.1.1.2" xref="S3.SS3.p1.8.m8.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.8.m8.1.1.1.1.1" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.8.m8.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.8.m8.1.1.1.1.1.1" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.cmml"><msub id="S3.SS3.p1.8.m8.1.1.1.1.1.1.2" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.2" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.2.cmml">s</mi><mi id="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.3" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.SS3.p1.8.m8.1.1.1.1.1.1.1" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.2" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.2.cmml">s</mi><mrow id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.2" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.1" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.3" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.SS3.p1.8.m8.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.8.m8.4.4.5" xref="S3.SS3.p1.8.m8.4.4.5.cmml">=</mo><mrow id="S3.SS3.p1.8.m8.4.4.4" xref="S3.SS3.p1.8.m8.4.4.4.cmml"><msub id="S3.SS3.p1.8.m8.4.4.4.5" xref="S3.SS3.p1.8.m8.4.4.4.5.cmml"><mi id="S3.SS3.p1.8.m8.4.4.4.5.2" xref="S3.SS3.p1.8.m8.4.4.4.5.2.cmml">ϕ</mi><mi id="S3.SS3.p1.8.m8.4.4.4.5.3" xref="S3.SS3.p1.8.m8.4.4.4.5.3.cmml">bw</mi></msub><mo id="S3.SS3.p1.8.m8.4.4.4.4" xref="S3.SS3.p1.8.m8.4.4.4.4.cmml">⁢</mo><mrow id="S3.SS3.p1.8.m8.4.4.4.3.3" xref="S3.SS3.p1.8.m8.4.4.4.3.4.cmml"><mo id="S3.SS3.p1.8.m8.4.4.4.3.3.4" stretchy="false" xref="S3.SS3.p1.8.m8.4.4.4.3.4.cmml">(</mo><msub id="S3.SS3.p1.8.m8.2.2.2.1.1.1" xref="S3.SS3.p1.8.m8.2.2.2.1.1.1.cmml"><mi id="S3.SS3.p1.8.m8.2.2.2.1.1.1.2" xref="S3.SS3.p1.8.m8.2.2.2.1.1.1.2.cmml">s</mi><mi id="S3.SS3.p1.8.m8.2.2.2.1.1.1.3" xref="S3.SS3.p1.8.m8.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.p1.8.m8.4.4.4.3.3.5" xref="S3.SS3.p1.8.m8.4.4.4.3.4.cmml">,</mo><msub id="S3.SS3.p1.8.m8.3.3.3.2.2.2" xref="S3.SS3.p1.8.m8.3.3.3.2.2.2.cmml"><mi id="S3.SS3.p1.8.m8.3.3.3.2.2.2.2" xref="S3.SS3.p1.8.m8.3.3.3.2.2.2.2.cmml">a</mi><mi id="S3.SS3.p1.8.m8.3.3.3.2.2.2.3" xref="S3.SS3.p1.8.m8.3.3.3.2.2.2.3.cmml">t</mi></msub><mo id="S3.SS3.p1.8.m8.4.4.4.3.3.6" xref="S3.SS3.p1.8.m8.4.4.4.3.4.cmml">,</mo><msub id="S3.SS3.p1.8.m8.4.4.4.3.3.3" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3.cmml"><mi id="S3.SS3.p1.8.m8.4.4.4.3.3.3.2" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3.2.cmml">s</mi><mrow id="S3.SS3.p1.8.m8.4.4.4.3.3.3.3" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.cmml"><mi id="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.2" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.2.cmml">t</mi><mo id="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.1" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.1.cmml">+</mo><mn id="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.3" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p1.8.m8.4.4.4.3.3.7" stretchy="false" xref="S3.SS3.p1.8.m8.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.4b"><apply id="S3.SS3.p1.8.m8.4.4.cmml" xref="S3.SS3.p1.8.m8.4.4"><eq id="S3.SS3.p1.8.m8.4.4.5.cmml" xref="S3.SS3.p1.8.m8.4.4.5"></eq><apply id="S3.SS3.p1.8.m8.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1"><times id="S3.SS3.p1.8.m8.1.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.1.2"></times><apply id="S3.SS3.p1.8.m8.1.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.1.3.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.1.3.2.cmml" xref="S3.SS3.p1.8.m8.1.1.1.3.2">𝑃</ci><ci id="S3.SS3.p1.8.m8.1.1.1.3.3.cmml" xref="S3.SS3.p1.8.m8.1.1.1.3.3">𝐵</ci></apply><apply id="S3.SS3.p1.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.2">𝑠</ci><ci id="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.2">𝑠</ci><apply id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3"><plus id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.1"></plus><ci id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.p1.8.m8.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.SS3.p1.8.m8.4.4.4.cmml" xref="S3.SS3.p1.8.m8.4.4.4"><times id="S3.SS3.p1.8.m8.4.4.4.4.cmml" xref="S3.SS3.p1.8.m8.4.4.4.4"></times><apply id="S3.SS3.p1.8.m8.4.4.4.5.cmml" xref="S3.SS3.p1.8.m8.4.4.4.5"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.4.4.4.5.1.cmml" xref="S3.SS3.p1.8.m8.4.4.4.5">subscript</csymbol><ci id="S3.SS3.p1.8.m8.4.4.4.5.2.cmml" xref="S3.SS3.p1.8.m8.4.4.4.5.2">italic-ϕ</ci><ci id="S3.SS3.p1.8.m8.4.4.4.5.3.cmml" xref="S3.SS3.p1.8.m8.4.4.4.5.3">bw</ci></apply><vector id="S3.SS3.p1.8.m8.4.4.4.3.4.cmml" xref="S3.SS3.p1.8.m8.4.4.4.3.3"><apply id="S3.SS3.p1.8.m8.2.2.2.1.1.1.cmml" xref="S3.SS3.p1.8.m8.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.2.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.8.m8.2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.8.m8.2.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.8.m8.2.2.2.1.1.1.2">𝑠</ci><ci id="S3.SS3.p1.8.m8.2.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.8.m8.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="S3.SS3.p1.8.m8.3.3.3.2.2.2.cmml" xref="S3.SS3.p1.8.m8.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.3.3.3.2.2.2.1.cmml" xref="S3.SS3.p1.8.m8.3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.8.m8.3.3.3.2.2.2.2.cmml" xref="S3.SS3.p1.8.m8.3.3.3.2.2.2.2">𝑎</ci><ci id="S3.SS3.p1.8.m8.3.3.3.2.2.2.3.cmml" xref="S3.SS3.p1.8.m8.3.3.3.2.2.2.3">𝑡</ci></apply><apply id="S3.SS3.p1.8.m8.4.4.4.3.3.3.cmml" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.4.4.4.3.3.3.1.cmml" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.8.m8.4.4.4.3.3.3.2.cmml" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3.2">𝑠</ci><apply id="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.cmml" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3.3"><plus id="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.1.cmml" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.1"></plus><ci id="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.2.cmml" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.2">𝑡</ci><cn id="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.3.cmml" type="integer" xref="S3.SS3.p1.8.m8.4.4.4.3.3.3.3.3">1</cn></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.4c">P_{B}(s_{t}|s_{t+1})=\phi_{\mathrm{bw}}(s_{t},a_{t},s_{t+1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m8.4d">italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) = italic_ϕ start_POSTSUBSCRIPT roman_bw end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math> takes the current state-action and the next state as input and estimates how likely the next state is generated by the current state.
To guarantee the property <math alttext="\mathcal{F}(s_{t})\geq 0" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m9.1"><semantics id="S3.SS3.p1.9.m9.1a"><mrow id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml"><mrow id="S3.SS3.p1.9.m9.1.1.1" xref="S3.SS3.p1.9.m9.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.9.m9.1.1.1.3" xref="S3.SS3.p1.9.m9.1.1.1.3.cmml">ℱ</mi><mo id="S3.SS3.p1.9.m9.1.1.1.2" xref="S3.SS3.p1.9.m9.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.9.m9.1.1.1.1.1" xref="S3.SS3.p1.9.m9.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.9.m9.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.9.m9.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.9.m9.1.1.1.1.1.1" xref="S3.SS3.p1.9.m9.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.9.m9.1.1.1.1.1.1.2" xref="S3.SS3.p1.9.m9.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS3.p1.9.m9.1.1.1.1.1.1.3" xref="S3.SS3.p1.9.m9.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.p1.9.m9.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.9.m9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.9.m9.1.1.2" xref="S3.SS3.p1.9.m9.1.1.2.cmml">≥</mo><mn id="S3.SS3.p1.9.m9.1.1.3" xref="S3.SS3.p1.9.m9.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><apply id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1"><geq id="S3.SS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2"></geq><apply id="S3.SS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1.1"><times id="S3.SS3.p1.9.m9.1.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.1.2"></times><ci id="S3.SS3.p1.9.m9.1.1.1.3.cmml" xref="S3.SS3.p1.9.m9.1.1.1.3">ℱ</ci><apply id="S3.SS3.p1.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.9.m9.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS3.p1.9.m9.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.9.m9.1.1.1.1.1.1.3">𝑡</ci></apply></apply><cn id="S3.SS3.p1.9.m9.1.1.3.cmml" type="integer" xref="S3.SS3.p1.9.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">\mathcal{F}(s_{t})\geq 0</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m9.1d">caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ≥ 0</annotation></semantics></math> and <math alttext="P_{B}(\cdot)\geq 0" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m10.1"><semantics id="S3.SS3.p1.10.m10.1a"><mrow id="S3.SS3.p1.10.m10.1.2" xref="S3.SS3.p1.10.m10.1.2.cmml"><mrow id="S3.SS3.p1.10.m10.1.2.2" xref="S3.SS3.p1.10.m10.1.2.2.cmml"><msub id="S3.SS3.p1.10.m10.1.2.2.2" xref="S3.SS3.p1.10.m10.1.2.2.2.cmml"><mi id="S3.SS3.p1.10.m10.1.2.2.2.2" xref="S3.SS3.p1.10.m10.1.2.2.2.2.cmml">P</mi><mi id="S3.SS3.p1.10.m10.1.2.2.2.3" xref="S3.SS3.p1.10.m10.1.2.2.2.3.cmml">B</mi></msub><mo id="S3.SS3.p1.10.m10.1.2.2.1" xref="S3.SS3.p1.10.m10.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS3.p1.10.m10.1.2.2.3.2" xref="S3.SS3.p1.10.m10.1.2.2.cmml"><mo id="S3.SS3.p1.10.m10.1.2.2.3.2.1" stretchy="false" xref="S3.SS3.p1.10.m10.1.2.2.cmml">(</mo><mo id="S3.SS3.p1.10.m10.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p1.10.m10.1.1.cmml">⋅</mo><mo id="S3.SS3.p1.10.m10.1.2.2.3.2.2" stretchy="false" xref="S3.SS3.p1.10.m10.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.10.m10.1.2.1" xref="S3.SS3.p1.10.m10.1.2.1.cmml">≥</mo><mn id="S3.SS3.p1.10.m10.1.2.3" xref="S3.SS3.p1.10.m10.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b"><apply id="S3.SS3.p1.10.m10.1.2.cmml" xref="S3.SS3.p1.10.m10.1.2"><geq id="S3.SS3.p1.10.m10.1.2.1.cmml" xref="S3.SS3.p1.10.m10.1.2.1"></geq><apply id="S3.SS3.p1.10.m10.1.2.2.cmml" xref="S3.SS3.p1.10.m10.1.2.2"><times id="S3.SS3.p1.10.m10.1.2.2.1.cmml" xref="S3.SS3.p1.10.m10.1.2.2.1"></times><apply id="S3.SS3.p1.10.m10.1.2.2.2.cmml" xref="S3.SS3.p1.10.m10.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.1.2.2.2.1.cmml" xref="S3.SS3.p1.10.m10.1.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.10.m10.1.2.2.2.2.cmml" xref="S3.SS3.p1.10.m10.1.2.2.2.2">𝑃</ci><ci id="S3.SS3.p1.10.m10.1.2.2.2.3.cmml" xref="S3.SS3.p1.10.m10.1.2.2.2.3">𝐵</ci></apply><ci id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1">⋅</ci></apply><cn id="S3.SS3.p1.10.m10.1.2.3.cmml" type="integer" xref="S3.SS3.p1.10.m10.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">P_{B}(\cdot)\geq 0</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.10.m10.1d">italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( ⋅ ) ≥ 0</annotation></semantics></math>, we use sigmoid activation for the network output.
Then, we can match the trajectory generation likelihood with the observed retention reward and use the flow matching objective (i.e. Eq(<a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S2.E3" title="In 2.1. Generative Flow Networks ‣ 2. Preliminaries ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">3</span></a>)) to back-propagate this end-of-session retention signal towards each intermediate step:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathrm{DB}}=\begin{cases}\left(\log\frac{\mathcal{F}_{R}(s_{t})%
\cdot P_{F}\left(s_{t+1}\mid s_{t}\right)}{\mathcal{F}_{R}(s_{t+1})P_{B}\left(%
s_{t}\mid s_{t+1}\right)}\right)^{2}&amp;1\leq t\leq T-1\\
\\
\left(\log\frac{\mathcal{F}_{R}(s_{t})}{\mathcal{R}}\right)^{2}&amp;t=T\end{cases}" class="ltx_Math" display="block" id="S3.E5.m1.4"><semantics id="S3.E5.m1.4a"><mrow id="S3.E5.m1.4.5" xref="S3.E5.m1.4.5.cmml"><msub id="S3.E5.m1.4.5.2" xref="S3.E5.m1.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.5.2.2" xref="S3.E5.m1.4.5.2.2.cmml">ℒ</mi><mi id="S3.E5.m1.4.5.2.3" xref="S3.E5.m1.4.5.2.3.cmml">DB</mi></msub><mo id="S3.E5.m1.4.5.1" xref="S3.E5.m1.4.5.1.cmml">=</mo><mrow id="S3.E5.m1.4.4" xref="S3.E5.m1.4.5.3.1.cmml"><mo id="S3.E5.m1.4.4.5" xref="S3.E5.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E5.m1.4.4.4" rowspacing="0pt" xref="S3.E5.m1.4.5.3.1.cmml"><mtr id="S3.E5.m1.4.4.4a" xref="S3.E5.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.4.4.4b" xref="S3.E5.m1.4.5.3.1.cmml"><msup id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1.1.1.5.1" xref="S3.E5.m1.1.1.1.1.1.1.5.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.5.1.2" xref="S3.E5.m1.1.1.1.1.1.1.5.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.5.1.1" xref="S3.E5.m1.1.1.1.1.1.1.5.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.5.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.5.1.1.1.cmml">log</mi><mo id="S3.E5.m1.1.1.1.1.1.1.5.1.1a" lspace="0.167em" xref="S3.E5.m1.1.1.1.1.1.1.5.1.1.cmml">⁡</mo><mstyle displaystyle="false" id="S3.E5.m1.1.1.1.1.1.1.4" xref="S3.E5.m1.1.1.1.1.1.1.4.cmml"><mfrac id="S3.E5.m1.1.1.1.1.1.1.4a" xref="S3.E5.m1.1.1.1.1.1.1.4.cmml"><mrow id="S3.E5.m1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.cmml"><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">R</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">P</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">F</mi></msub></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.1.1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.2.cmml">s</mi><mrow id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.2.cmml">t</mi><mo id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.1" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.1.cmml">+</mo><mn id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.3" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">∣</mo><msub id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3.2.cmml">s</mi><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.3" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E5.m1.1.1.1.1.1.1.4.4" xref="S3.E5.m1.1.1.1.1.1.1.4.4.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.4.4.4" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.1.1.4.4.4.2" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.2.cmml">ℱ</mi><mi id="S3.E5.m1.1.1.1.1.1.1.4.4.4.3" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.3.cmml">R</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.3" xref="S3.E5.m1.1.1.1.1.1.1.4.4.3.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.2.cmml">s</mi><mrow id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.2.cmml">t</mi><mo id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.1.cmml">+</mo><mn id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.cmml">)</mo></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.3a" xref="S3.E5.m1.1.1.1.1.1.1.4.4.3.cmml">⁢</mo><msub id="S3.E5.m1.1.1.1.1.1.1.4.4.5" xref="S3.E5.m1.1.1.1.1.1.1.4.4.5.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.4.4.5.2" xref="S3.E5.m1.1.1.1.1.1.1.4.4.5.2.cmml">P</mi><mi id="S3.E5.m1.1.1.1.1.1.1.4.4.5.3" xref="S3.E5.m1.1.1.1.1.1.1.4.4.5.3.cmml">B</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.3b" xref="S3.E5.m1.1.1.1.1.1.1.4.4.3.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.2" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2.2.cmml">s</mi><mi id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2.3.cmml">t</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.1.cmml">∣</mo><msub id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.2.cmml">s</mi><mrow id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.2" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.2.cmml">t</mi><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.1" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.1.cmml">+</mo><mn id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.3" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.3" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.5.1.3" xref="S3.E5.m1.1.1.1.1.1.1.5.1.1.cmml">)</mo></mrow><mn id="S3.E5.m1.1.1.1.1.1.1.7" xref="S3.E5.m1.1.1.1.1.1.1.7.cmml">2</mn></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.4.4.4c" xref="S3.E5.m1.4.5.3.1.cmml"><mrow id="S3.E5.m1.2.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.1.cmml"><mn id="S3.E5.m1.2.2.2.2.2.1.2" xref="S3.E5.m1.2.2.2.2.2.1.2.cmml">1</mn><mo id="S3.E5.m1.2.2.2.2.2.1.3" xref="S3.E5.m1.2.2.2.2.2.1.3.cmml">≤</mo><mi id="S3.E5.m1.2.2.2.2.2.1.4" xref="S3.E5.m1.2.2.2.2.2.1.4.cmml">t</mi><mo id="S3.E5.m1.2.2.2.2.2.1.5" xref="S3.E5.m1.2.2.2.2.2.1.5.cmml">≤</mo><mrow id="S3.E5.m1.2.2.2.2.2.1.6" xref="S3.E5.m1.2.2.2.2.2.1.6.cmml"><mi id="S3.E5.m1.2.2.2.2.2.1.6.2" xref="S3.E5.m1.2.2.2.2.2.1.6.2.cmml">T</mi><mo id="S3.E5.m1.2.2.2.2.2.1.6.1" xref="S3.E5.m1.2.2.2.2.2.1.6.1.cmml">−</mo><mn id="S3.E5.m1.2.2.2.2.2.1.6.3" xref="S3.E5.m1.2.2.2.2.2.1.6.3.cmml">1</mn></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.4.4.4d" xref="S3.E5.m1.4.5.3.1.cmml"><mtd id="S3.E5.m1.4.4.4e" xref="S3.E5.m1.4.5.3.1.1.cmml"></mtd><mtd id="S3.E5.m1.4.4.4f" xref="S3.E5.m1.4.5.3.1.1.cmml"></mtd></mtr><mtr id="S3.E5.m1.4.4.4g" xref="S3.E5.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.4.4.4h" xref="S3.E5.m1.4.5.3.1.cmml"><msup id="S3.E5.m1.3.3.3.3.1.1" xref="S3.E5.m1.3.3.3.3.1.1.cmml"><mrow id="S3.E5.m1.3.3.3.3.1.1.2.1" xref="S3.E5.m1.3.3.3.3.1.1.2.1.1.cmml"><mo id="S3.E5.m1.3.3.3.3.1.1.2.1.2" xref="S3.E5.m1.3.3.3.3.1.1.2.1.1.cmml">(</mo><mrow id="S3.E5.m1.3.3.3.3.1.1.2.1.1" xref="S3.E5.m1.3.3.3.3.1.1.2.1.1.cmml"><mi id="S3.E5.m1.3.3.3.3.1.1.2.1.1.1" xref="S3.E5.m1.3.3.3.3.1.1.2.1.1.1.cmml">log</mi><mo id="S3.E5.m1.3.3.3.3.1.1.2.1.1a" lspace="0.167em" xref="S3.E5.m1.3.3.3.3.1.1.2.1.1.cmml">⁡</mo><mstyle displaystyle="false" id="S3.E5.m1.3.3.3.3.1.1.1" xref="S3.E5.m1.3.3.3.3.1.1.1.cmml"><mfrac id="S3.E5.m1.3.3.3.3.1.1.1a" xref="S3.E5.m1.3.3.3.3.1.1.1.cmml"><mrow id="S3.E5.m1.3.3.3.3.1.1.1.1" xref="S3.E5.m1.3.3.3.3.1.1.1.1.cmml"><msub id="S3.E5.m1.3.3.3.3.1.1.1.1.3" xref="S3.E5.m1.3.3.3.3.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.3.3.1.1.1.1.3.2" xref="S3.E5.m1.3.3.3.3.1.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E5.m1.3.3.3.3.1.1.1.1.3.3" xref="S3.E5.m1.3.3.3.3.1.1.1.1.3.3.cmml">R</mi></msub><mo id="S3.E5.m1.3.3.3.3.1.1.1.1.2" xref="S3.E5.m1.3.3.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.3.3.1.1.1.1.1.1" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.3.3.1.1.1.3" xref="S3.E5.m1.3.3.3.3.1.1.1.3.cmml">ℛ</mi></mfrac></mstyle></mrow><mo id="S3.E5.m1.3.3.3.3.1.1.2.1.3" xref="S3.E5.m1.3.3.3.3.1.1.2.1.1.cmml">)</mo></mrow><mn id="S3.E5.m1.3.3.3.3.1.1.4" xref="S3.E5.m1.3.3.3.3.1.1.4.cmml">2</mn></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.4.4.4i" xref="S3.E5.m1.4.5.3.1.cmml"><mrow id="S3.E5.m1.4.4.4.4.2.1" xref="S3.E5.m1.4.4.4.4.2.1.cmml"><mi id="S3.E5.m1.4.4.4.4.2.1.2" xref="S3.E5.m1.4.4.4.4.2.1.2.cmml">t</mi><mo id="S3.E5.m1.4.4.4.4.2.1.1" xref="S3.E5.m1.4.4.4.4.2.1.1.cmml">=</mo><mi id="S3.E5.m1.4.4.4.4.2.1.3" xref="S3.E5.m1.4.4.4.4.2.1.3.cmml">T</mi></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.4b"><apply id="S3.E5.m1.4.5.cmml" xref="S3.E5.m1.4.5"><eq id="S3.E5.m1.4.5.1.cmml" xref="S3.E5.m1.4.5.1"></eq><apply id="S3.E5.m1.4.5.2.cmml" xref="S3.E5.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.5.2.1.cmml" xref="S3.E5.m1.4.5.2">subscript</csymbol><ci id="S3.E5.m1.4.5.2.2.cmml" xref="S3.E5.m1.4.5.2.2">ℒ</ci><ci id="S3.E5.m1.4.5.2.3.cmml" xref="S3.E5.m1.4.5.2.3">DB</ci></apply><apply id="S3.E5.m1.4.5.3.1.cmml" xref="S3.E5.m1.4.4"><csymbol cd="latexml" id="S3.E5.m1.4.5.3.1.1.cmml" xref="S3.E5.m1.4.4.5">cases</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.6.cmml" xref="S3.E5.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.5.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.5.1"><log id="S3.E5.m1.1.1.1.1.1.1.5.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.5.1.1.1"></log><apply id="S3.E5.m1.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4"><divide id="S3.E5.m1.1.1.1.1.1.1.4.5.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4"></divide><apply id="S3.E5.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2"><times id="S3.E5.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.3"></times><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1"><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.2">ℱ</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑅</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.2">𝑃</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.3">𝐹</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.1">conditional</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.2">𝑠</ci><apply id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3"><plus id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.1"></plus><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.2">𝑡</ci><cn id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.3.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3.2">𝑠</ci><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.4.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4"><times id="S3.E5.m1.1.1.1.1.1.1.4.4.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.3"></times><apply id="S3.E5.m1.1.1.1.1.1.1.4.4.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.4.4.4.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.4.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.2">ℱ</ci><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.4.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.4.3">𝑅</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.2">𝑠</ci><apply id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3"><plus id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.1"></plus><ci id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.2">𝑡</ci><cn id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.3.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.4.4.5.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.5"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.4.4.5.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.5">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.5.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.5.2">𝑃</ci><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.5.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.5.3">𝐵</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.1">conditional</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2.2">𝑠</ci><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.2.3">𝑡</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.2">𝑠</ci><apply id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3"><plus id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.1"></plus><ci id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.2">𝑡</ci><cn id="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.3.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.1.1.4.4.2.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply><cn id="S3.E5.m1.1.1.1.1.1.1.7.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.1.1.7">2</cn></apply><apply id="S3.E5.m1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1"><and id="S3.E5.m1.2.2.2.2.2.1a.cmml" xref="S3.E5.m1.2.2.2.2.2.1"></and><apply id="S3.E5.m1.2.2.2.2.2.1b.cmml" xref="S3.E5.m1.2.2.2.2.2.1"><leq id="S3.E5.m1.2.2.2.2.2.1.3.cmml" xref="S3.E5.m1.2.2.2.2.2.1.3"></leq><cn id="S3.E5.m1.2.2.2.2.2.1.2.cmml" type="integer" xref="S3.E5.m1.2.2.2.2.2.1.2">1</cn><ci id="S3.E5.m1.2.2.2.2.2.1.4.cmml" xref="S3.E5.m1.2.2.2.2.2.1.4">𝑡</ci></apply><apply id="S3.E5.m1.2.2.2.2.2.1c.cmml" xref="S3.E5.m1.2.2.2.2.2.1"><leq id="S3.E5.m1.2.2.2.2.2.1.5.cmml" xref="S3.E5.m1.2.2.2.2.2.1.5"></leq><share href="https://arxiv.org/html/2406.06043v1#S3.E5.m1.2.2.2.2.2.1.4.cmml" id="S3.E5.m1.2.2.2.2.2.1d.cmml" xref="S3.E5.m1.2.2.2.2.2.1"></share><apply id="S3.E5.m1.2.2.2.2.2.1.6.cmml" xref="S3.E5.m1.2.2.2.2.2.1.6"><minus id="S3.E5.m1.2.2.2.2.2.1.6.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1.6.1"></minus><ci id="S3.E5.m1.2.2.2.2.2.1.6.2.cmml" xref="S3.E5.m1.2.2.2.2.2.1.6.2">𝑇</ci><cn id="S3.E5.m1.2.2.2.2.2.1.6.3.cmml" type="integer" xref="S3.E5.m1.2.2.2.2.2.1.6.3">1</cn></apply></apply></apply><ci id="S3.E5.m1.4.5.3.1.4a.cmml" xref="S3.E5.m1.4.4"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.4.5.3.1.4.cmml" xref="S3.E5.m1.4.4.5">otherwise</mtext></ci><ci id="S3.E5.m1.4.5.3.1.5a.cmml" xref="S3.E5.m1.4.4"><mtext class="ltx_mathvariant_italic" id="S3.E5.m1.4.5.3.1.5.cmml" xref="S3.E5.m1.4.4.5">otherwise</mtext></ci><apply id="S3.E5.m1.3.3.3.3.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.1.1.3.cmml" xref="S3.E5.m1.3.3.3.3.1.1">superscript</csymbol><apply id="S3.E5.m1.3.3.3.3.1.1.2.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.2.1"><log id="S3.E5.m1.3.3.3.3.1.1.2.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.2.1.1.1"></log><apply id="S3.E5.m1.3.3.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1"><divide id="S3.E5.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1"></divide><apply id="S3.E5.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1"><times id="S3.E5.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.2"></times><apply id="S3.E5.m1.3.3.3.3.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.1.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.1.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.3.2">ℱ</ci><ci id="S3.E5.m1.3.3.3.3.1.1.1.1.3.3.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.3.3">𝑅</ci></apply><apply id="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="S3.E5.m1.3.3.3.3.1.1.1.3.cmml" xref="S3.E5.m1.3.3.3.3.1.1.1.3">ℛ</ci></apply></apply><cn id="S3.E5.m1.3.3.3.3.1.1.4.cmml" type="integer" xref="S3.E5.m1.3.3.3.3.1.1.4">2</cn></apply><apply id="S3.E5.m1.4.4.4.4.2.1.cmml" xref="S3.E5.m1.4.4.4.4.2.1"><eq id="S3.E5.m1.4.4.4.4.2.1.1.cmml" xref="S3.E5.m1.4.4.4.4.2.1.1"></eq><ci id="S3.E5.m1.4.4.4.4.2.1.2.cmml" xref="S3.E5.m1.4.4.4.4.2.1.2">𝑡</ci><ci id="S3.E5.m1.4.4.4.4.2.1.3.cmml" xref="S3.E5.m1.4.4.4.4.2.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.4c">\mathcal{L}_{\mathrm{DB}}=\begin{cases}\left(\log\frac{\mathcal{F}_{R}(s_{t})%
\cdot P_{F}\left(s_{t+1}\mid s_{t}\right)}{\mathcal{F}_{R}(s_{t+1})P_{B}\left(%
s_{t}\mid s_{t+1}\right)}\right)^{2}&amp;1\leq t\leq T-1\\
\\
\left(\log\frac{\mathcal{F}_{R}(s_{t})}{\mathcal{R}}\right)^{2}&amp;t=T\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.4d">caligraphic_L start_POSTSUBSCRIPT roman_DB end_POSTSUBSCRIPT = { start_ROW start_CELL ( roman_log divide start_ARG caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ⋅ italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG start_ARG caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_CELL start_CELL 1 ≤ italic_t ≤ italic_T - 1 end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL end_CELL end_ROW start_ROW start_CELL ( roman_log divide start_ARG caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG start_ARG caligraphic_R end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_CELL start_CELL italic_t = italic_T end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.14">where the forward function <math alttext="P_{F}(s_{t+1}|s_{t})" class="ltx_Math" display="inline" id="S3.SS3.p1.11.m1.1"><semantics id="S3.SS3.p1.11.m1.1a"><mrow id="S3.SS3.p1.11.m1.1.1" xref="S3.SS3.p1.11.m1.1.1.cmml"><msub id="S3.SS3.p1.11.m1.1.1.3" xref="S3.SS3.p1.11.m1.1.1.3.cmml"><mi id="S3.SS3.p1.11.m1.1.1.3.2" xref="S3.SS3.p1.11.m1.1.1.3.2.cmml">P</mi><mi id="S3.SS3.p1.11.m1.1.1.3.3" xref="S3.SS3.p1.11.m1.1.1.3.3.cmml">F</mi></msub><mo id="S3.SS3.p1.11.m1.1.1.2" xref="S3.SS3.p1.11.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.11.m1.1.1.1.1" xref="S3.SS3.p1.11.m1.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.11.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.11.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.11.m1.1.1.1.1.1" xref="S3.SS3.p1.11.m1.1.1.1.1.1.cmml"><msub id="S3.SS3.p1.11.m1.1.1.1.1.1.2" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p1.11.m1.1.1.1.1.1.2.2" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2.2.cmml">s</mi><mrow id="S3.SS3.p1.11.m1.1.1.1.1.1.2.3" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.2" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.1" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.3" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.SS3.p1.11.m1.1.1.1.1.1.1" xref="S3.SS3.p1.11.m1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS3.p1.11.m1.1.1.1.1.1.3" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.11.m1.1.1.1.1.1.3.2" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S3.SS3.p1.11.m1.1.1.1.1.1.3.3" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS3.p1.11.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.11.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m1.1b"><apply id="S3.SS3.p1.11.m1.1.1.cmml" xref="S3.SS3.p1.11.m1.1.1"><times id="S3.SS3.p1.11.m1.1.1.2.cmml" xref="S3.SS3.p1.11.m1.1.1.2"></times><apply id="S3.SS3.p1.11.m1.1.1.3.cmml" xref="S3.SS3.p1.11.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m1.1.1.3.1.cmml" xref="S3.SS3.p1.11.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.11.m1.1.1.3.2.cmml" xref="S3.SS3.p1.11.m1.1.1.3.2">𝑃</ci><ci id="S3.SS3.p1.11.m1.1.1.3.3.cmml" xref="S3.SS3.p1.11.m1.1.1.3.3">𝐹</ci></apply><apply id="S3.SS3.p1.11.m1.1.1.1.1.1.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p1.11.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p1.11.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.11.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2.2">𝑠</ci><apply id="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2.3"><plus id="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.1"></plus><ci id="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS3.p1.11.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.11.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.SS3.p1.11.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m1.1c">P_{F}(s_{t+1}|s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.11.m1.1d">italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> depends on the recommendation policy <math alttext="\phi_{\mathrm{fw}}" class="ltx_Math" display="inline" id="S3.SS3.p1.12.m2.1"><semantics id="S3.SS3.p1.12.m2.1a"><msub id="S3.SS3.p1.12.m2.1.1" xref="S3.SS3.p1.12.m2.1.1.cmml"><mi id="S3.SS3.p1.12.m2.1.1.2" xref="S3.SS3.p1.12.m2.1.1.2.cmml">ϕ</mi><mi id="S3.SS3.p1.12.m2.1.1.3" xref="S3.SS3.p1.12.m2.1.1.3.cmml">fw</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m2.1b"><apply id="S3.SS3.p1.12.m2.1.1.cmml" xref="S3.SS3.p1.12.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.12.m2.1.1.1.cmml" xref="S3.SS3.p1.12.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.12.m2.1.1.2.cmml" xref="S3.SS3.p1.12.m2.1.1.2">italic-ϕ</ci><ci id="S3.SS3.p1.12.m2.1.1.3.cmml" xref="S3.SS3.p1.12.m2.1.1.3">fw</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m2.1c">\phi_{\mathrm{fw}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.12.m2.1d">italic_ϕ start_POSTSUBSCRIPT roman_fw end_POSTSUBSCRIPT</annotation></semantics></math> as described in the previous section and we use <math alttext="\mathcal{F}_{R}(s_{t})" class="ltx_Math" display="inline" id="S3.SS3.p1.13.m3.1"><semantics id="S3.SS3.p1.13.m3.1a"><mrow id="S3.SS3.p1.13.m3.1.1" xref="S3.SS3.p1.13.m3.1.1.cmml"><msub id="S3.SS3.p1.13.m3.1.1.3" xref="S3.SS3.p1.13.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.13.m3.1.1.3.2" xref="S3.SS3.p1.13.m3.1.1.3.2.cmml">ℱ</mi><mi id="S3.SS3.p1.13.m3.1.1.3.3" xref="S3.SS3.p1.13.m3.1.1.3.3.cmml">R</mi></msub><mo id="S3.SS3.p1.13.m3.1.1.2" xref="S3.SS3.p1.13.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.13.m3.1.1.1.1" xref="S3.SS3.p1.13.m3.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.13.m3.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.13.m3.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.13.m3.1.1.1.1.1" xref="S3.SS3.p1.13.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.13.m3.1.1.1.1.1.2" xref="S3.SS3.p1.13.m3.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS3.p1.13.m3.1.1.1.1.1.3" xref="S3.SS3.p1.13.m3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS3.p1.13.m3.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.13.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m3.1b"><apply id="S3.SS3.p1.13.m3.1.1.cmml" xref="S3.SS3.p1.13.m3.1.1"><times id="S3.SS3.p1.13.m3.1.1.2.cmml" xref="S3.SS3.p1.13.m3.1.1.2"></times><apply id="S3.SS3.p1.13.m3.1.1.3.cmml" xref="S3.SS3.p1.13.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m3.1.1.3.1.cmml" xref="S3.SS3.p1.13.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.13.m3.1.1.3.2.cmml" xref="S3.SS3.p1.13.m3.1.1.3.2">ℱ</ci><ci id="S3.SS3.p1.13.m3.1.1.3.3.cmml" xref="S3.SS3.p1.13.m3.1.1.3.3">𝑅</ci></apply><apply id="S3.SS3.p1.13.m3.1.1.1.1.1.cmml" xref="S3.SS3.p1.13.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.13.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.13.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.13.m3.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS3.p1.13.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.13.m3.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m3.1c">\mathcal{F}_{R}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.13.m3.1d">caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> to represents that the flow estimator in this framework only considers the retention reward.
As proven by <cite class="ltx_cite ltx_citemacro_citep">(Bengio et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib5" title="">2023</a>)</cite>, this design ensures the learning goal <math alttext="P(\mathbf{S})\propto\mathcal{F}_{R}(s_{T})\approx\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS3.p1.14.m4.2"><semantics id="S3.SS3.p1.14.m4.2a"><mrow id="S3.SS3.p1.14.m4.2.2" xref="S3.SS3.p1.14.m4.2.2.cmml"><mrow id="S3.SS3.p1.14.m4.2.2.3" xref="S3.SS3.p1.14.m4.2.2.3.cmml"><mi id="S3.SS3.p1.14.m4.2.2.3.2" xref="S3.SS3.p1.14.m4.2.2.3.2.cmml">P</mi><mo id="S3.SS3.p1.14.m4.2.2.3.1" xref="S3.SS3.p1.14.m4.2.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p1.14.m4.2.2.3.3.2" xref="S3.SS3.p1.14.m4.2.2.3.cmml"><mo id="S3.SS3.p1.14.m4.2.2.3.3.2.1" stretchy="false" xref="S3.SS3.p1.14.m4.2.2.3.cmml">(</mo><mi id="S3.SS3.p1.14.m4.1.1" xref="S3.SS3.p1.14.m4.1.1.cmml">𝐒</mi><mo id="S3.SS3.p1.14.m4.2.2.3.3.2.2" stretchy="false" xref="S3.SS3.p1.14.m4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.14.m4.2.2.4" xref="S3.SS3.p1.14.m4.2.2.4.cmml">∝</mo><mrow id="S3.SS3.p1.14.m4.2.2.1" xref="S3.SS3.p1.14.m4.2.2.1.cmml"><msub id="S3.SS3.p1.14.m4.2.2.1.3" xref="S3.SS3.p1.14.m4.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.14.m4.2.2.1.3.2" xref="S3.SS3.p1.14.m4.2.2.1.3.2.cmml">ℱ</mi><mi id="S3.SS3.p1.14.m4.2.2.1.3.3" xref="S3.SS3.p1.14.m4.2.2.1.3.3.cmml">R</mi></msub><mo id="S3.SS3.p1.14.m4.2.2.1.2" xref="S3.SS3.p1.14.m4.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.14.m4.2.2.1.1.1" xref="S3.SS3.p1.14.m4.2.2.1.1.1.1.cmml"><mo id="S3.SS3.p1.14.m4.2.2.1.1.1.2" stretchy="false" xref="S3.SS3.p1.14.m4.2.2.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.14.m4.2.2.1.1.1.1" xref="S3.SS3.p1.14.m4.2.2.1.1.1.1.cmml"><mi id="S3.SS3.p1.14.m4.2.2.1.1.1.1.2" xref="S3.SS3.p1.14.m4.2.2.1.1.1.1.2.cmml">s</mi><mi id="S3.SS3.p1.14.m4.2.2.1.1.1.1.3" xref="S3.SS3.p1.14.m4.2.2.1.1.1.1.3.cmml">T</mi></msub><mo id="S3.SS3.p1.14.m4.2.2.1.1.1.3" stretchy="false" xref="S3.SS3.p1.14.m4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.14.m4.2.2.5" xref="S3.SS3.p1.14.m4.2.2.5.cmml">≈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.14.m4.2.2.6" xref="S3.SS3.p1.14.m4.2.2.6.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m4.2b"><apply id="S3.SS3.p1.14.m4.2.2.cmml" xref="S3.SS3.p1.14.m4.2.2"><and id="S3.SS3.p1.14.m4.2.2a.cmml" xref="S3.SS3.p1.14.m4.2.2"></and><apply id="S3.SS3.p1.14.m4.2.2b.cmml" xref="S3.SS3.p1.14.m4.2.2"><csymbol cd="latexml" id="S3.SS3.p1.14.m4.2.2.4.cmml" xref="S3.SS3.p1.14.m4.2.2.4">proportional-to</csymbol><apply id="S3.SS3.p1.14.m4.2.2.3.cmml" xref="S3.SS3.p1.14.m4.2.2.3"><times id="S3.SS3.p1.14.m4.2.2.3.1.cmml" xref="S3.SS3.p1.14.m4.2.2.3.1"></times><ci id="S3.SS3.p1.14.m4.2.2.3.2.cmml" xref="S3.SS3.p1.14.m4.2.2.3.2">𝑃</ci><ci id="S3.SS3.p1.14.m4.1.1.cmml" xref="S3.SS3.p1.14.m4.1.1">𝐒</ci></apply><apply id="S3.SS3.p1.14.m4.2.2.1.cmml" xref="S3.SS3.p1.14.m4.2.2.1"><times id="S3.SS3.p1.14.m4.2.2.1.2.cmml" xref="S3.SS3.p1.14.m4.2.2.1.2"></times><apply id="S3.SS3.p1.14.m4.2.2.1.3.cmml" xref="S3.SS3.p1.14.m4.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m4.2.2.1.3.1.cmml" xref="S3.SS3.p1.14.m4.2.2.1.3">subscript</csymbol><ci id="S3.SS3.p1.14.m4.2.2.1.3.2.cmml" xref="S3.SS3.p1.14.m4.2.2.1.3.2">ℱ</ci><ci id="S3.SS3.p1.14.m4.2.2.1.3.3.cmml" xref="S3.SS3.p1.14.m4.2.2.1.3.3">𝑅</ci></apply><apply id="S3.SS3.p1.14.m4.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.14.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m4.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.14.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.14.m4.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p1.14.m4.2.2.1.1.1.1.2">𝑠</ci><ci id="S3.SS3.p1.14.m4.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p1.14.m4.2.2.1.1.1.1.3">𝑇</ci></apply></apply></apply><apply id="S3.SS3.p1.14.m4.2.2c.cmml" xref="S3.SS3.p1.14.m4.2.2"><approx id="S3.SS3.p1.14.m4.2.2.5.cmml" xref="S3.SS3.p1.14.m4.2.2.5"></approx><share href="https://arxiv.org/html/2406.06043v1#S3.SS3.p1.14.m4.2.2.1.cmml" id="S3.SS3.p1.14.m4.2.2d.cmml" xref="S3.SS3.p1.14.m4.2.2"></share><ci id="S3.SS3.p1.14.m4.2.2.6.cmml" xref="S3.SS3.p1.14.m4.2.2.6">ℛ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m4.2c">P(\mathbf{S})\propto\mathcal{F}_{R}(s_{T})\approx\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.14.m4.2d">italic_P ( bold_S ) ∝ caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) ≈ caligraphic_R</annotation></semantics></math>.
During the learning process, the generation may initially be random and generate low retention reward, but the exploration effect of the policy would gradually discover samples with higher retention and the actions in those sessions will receive higher generation possibility.
Eventually, this flow estimation learning framework helps the generation policy provide more diversity while maintaining high quality.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Refined Detailed Balance Learning with Reward Integration</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Merely optimizing the retention as in the previous section only models the long-term preferences of users.
In contrast, the immediate rewards in each intermediate step of the session provide valuable nuanced information that may be ignored by the long-term retention reward.
For example, a session that consists of a relevant item and an irrelevant item may still receive a good retention reward since the user may return as long as there is relevant information.
However, we should not consider the two items as equal and the user’s feedback on each of the items may help us differentiate them.
Intuitively, we consider the retention reward and immediate rewards as complementary views of user preferences.
In this section, we illustrate how to integrate these two rewards in the generative flow estimation and derive a refined DB learning process.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.1. </span>Reward Design:</h4>
<div class="ltx_para" id="S3.SS4.SSS1.p1">
<p class="ltx_p" id="S3.SS4.SSS1.p1.3">To accommodate the flow estimation framework and guarantee the correctness of the detailed balance objective, we propose a reward integration through the product:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R(\textbf{S})=\mathcal{R}\cdot e^{\alpha\cdot\sum_{t=1}^{T-1}r_{t}}" class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.2" xref="S3.E6.m1.1.2.cmml"><mrow id="S3.E6.m1.1.2.2" xref="S3.E6.m1.1.2.2.cmml"><mi id="S3.E6.m1.1.2.2.2" xref="S3.E6.m1.1.2.2.2.cmml">R</mi><mo id="S3.E6.m1.1.2.2.1" xref="S3.E6.m1.1.2.2.1.cmml">⁢</mo><mrow id="S3.E6.m1.1.2.2.3.2" xref="S3.E6.m1.1.1a.cmml"><mo id="S3.E6.m1.1.2.2.3.2.1" stretchy="false" xref="S3.E6.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">S</mtext><mo id="S3.E6.m1.1.2.2.3.2.2" stretchy="false" xref="S3.E6.m1.1.1a.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.1.2.1" xref="S3.E6.m1.1.2.1.cmml">=</mo><mrow id="S3.E6.m1.1.2.3" xref="S3.E6.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.2.3.2" xref="S3.E6.m1.1.2.3.2.cmml">ℛ</mi><mo id="S3.E6.m1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.1.2.3.1.cmml">⋅</mo><msup id="S3.E6.m1.1.2.3.3" xref="S3.E6.m1.1.2.3.3.cmml"><mi id="S3.E6.m1.1.2.3.3.2" xref="S3.E6.m1.1.2.3.3.2.cmml">e</mi><mrow id="S3.E6.m1.1.2.3.3.3" xref="S3.E6.m1.1.2.3.3.3.cmml"><mi id="S3.E6.m1.1.2.3.3.3.2" xref="S3.E6.m1.1.2.3.3.3.2.cmml">α</mi><mo id="S3.E6.m1.1.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E6.m1.1.2.3.3.3.1.cmml">⋅</mo><mrow id="S3.E6.m1.1.2.3.3.3.3" xref="S3.E6.m1.1.2.3.3.3.3.cmml"><mstyle displaystyle="false" id="S3.E6.m1.1.2.3.3.3.3.1" xref="S3.E6.m1.1.2.3.3.3.3.1.cmml"><msubsup id="S3.E6.m1.1.2.3.3.3.3.1a" xref="S3.E6.m1.1.2.3.3.3.3.1.cmml"><mo id="S3.E6.m1.1.2.3.3.3.3.1.2.2" xref="S3.E6.m1.1.2.3.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E6.m1.1.2.3.3.3.3.1.2.3" xref="S3.E6.m1.1.2.3.3.3.3.1.2.3.cmml"><mi id="S3.E6.m1.1.2.3.3.3.3.1.2.3.2" xref="S3.E6.m1.1.2.3.3.3.3.1.2.3.2.cmml">t</mi><mo id="S3.E6.m1.1.2.3.3.3.3.1.2.3.1" xref="S3.E6.m1.1.2.3.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E6.m1.1.2.3.3.3.3.1.2.3.3" xref="S3.E6.m1.1.2.3.3.3.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E6.m1.1.2.3.3.3.3.1.3" xref="S3.E6.m1.1.2.3.3.3.3.1.3.cmml"><mi id="S3.E6.m1.1.2.3.3.3.3.1.3.2" xref="S3.E6.m1.1.2.3.3.3.3.1.3.2.cmml">T</mi><mo id="S3.E6.m1.1.2.3.3.3.3.1.3.1" xref="S3.E6.m1.1.2.3.3.3.3.1.3.1.cmml">−</mo><mn id="S3.E6.m1.1.2.3.3.3.3.1.3.3" xref="S3.E6.m1.1.2.3.3.3.3.1.3.3.cmml">1</mn></mrow></msubsup></mstyle><msub id="S3.E6.m1.1.2.3.3.3.3.2" xref="S3.E6.m1.1.2.3.3.3.3.2.cmml"><mi id="S3.E6.m1.1.2.3.3.3.3.2.2" xref="S3.E6.m1.1.2.3.3.3.3.2.2.cmml">r</mi><mi id="S3.E6.m1.1.2.3.3.3.3.2.3" xref="S3.E6.m1.1.2.3.3.3.3.2.3.cmml">t</mi></msub></mrow></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.2.cmml" xref="S3.E6.m1.1.2"><eq id="S3.E6.m1.1.2.1.cmml" xref="S3.E6.m1.1.2.1"></eq><apply id="S3.E6.m1.1.2.2.cmml" xref="S3.E6.m1.1.2.2"><times id="S3.E6.m1.1.2.2.1.cmml" xref="S3.E6.m1.1.2.2.1"></times><ci id="S3.E6.m1.1.2.2.2.cmml" xref="S3.E6.m1.1.2.2.2">𝑅</ci><ci id="S3.E6.m1.1.1a.cmml" xref="S3.E6.m1.1.2.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">S</mtext></ci></apply><apply id="S3.E6.m1.1.2.3.cmml" xref="S3.E6.m1.1.2.3"><ci id="S3.E6.m1.1.2.3.1.cmml" xref="S3.E6.m1.1.2.3.1">⋅</ci><ci id="S3.E6.m1.1.2.3.2.cmml" xref="S3.E6.m1.1.2.3.2">ℛ</ci><apply id="S3.E6.m1.1.2.3.3.cmml" xref="S3.E6.m1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.2.3.3.1.cmml" xref="S3.E6.m1.1.2.3.3">superscript</csymbol><ci id="S3.E6.m1.1.2.3.3.2.cmml" xref="S3.E6.m1.1.2.3.3.2">𝑒</ci><apply id="S3.E6.m1.1.2.3.3.3.cmml" xref="S3.E6.m1.1.2.3.3.3"><ci id="S3.E6.m1.1.2.3.3.3.1.cmml" xref="S3.E6.m1.1.2.3.3.3.1">⋅</ci><ci id="S3.E6.m1.1.2.3.3.3.2.cmml" xref="S3.E6.m1.1.2.3.3.3.2">𝛼</ci><apply id="S3.E6.m1.1.2.3.3.3.3.cmml" xref="S3.E6.m1.1.2.3.3.3.3"><apply id="S3.E6.m1.1.2.3.3.3.3.1.cmml" xref="S3.E6.m1.1.2.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.2.3.3.3.3.1.1.cmml" xref="S3.E6.m1.1.2.3.3.3.3.1">superscript</csymbol><apply id="S3.E6.m1.1.2.3.3.3.3.1.2.cmml" xref="S3.E6.m1.1.2.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.2.3.3.3.3.1.2.1.cmml" xref="S3.E6.m1.1.2.3.3.3.3.1">subscript</csymbol><sum id="S3.E6.m1.1.2.3.3.3.3.1.2.2.cmml" xref="S3.E6.m1.1.2.3.3.3.3.1.2.2"></sum><apply id="S3.E6.m1.1.2.3.3.3.3.1.2.3.cmml" xref="S3.E6.m1.1.2.3.3.3.3.1.2.3"><eq id="S3.E6.m1.1.2.3.3.3.3.1.2.3.1.cmml" xref="S3.E6.m1.1.2.3.3.3.3.1.2.3.1"></eq><ci id="S3.E6.m1.1.2.3.3.3.3.1.2.3.2.cmml" xref="S3.E6.m1.1.2.3.3.3.3.1.2.3.2">𝑡</ci><cn id="S3.E6.m1.1.2.3.3.3.3.1.2.3.3.cmml" type="integer" xref="S3.E6.m1.1.2.3.3.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.1.2.3.3.3.3.1.3.cmml" xref="S3.E6.m1.1.2.3.3.3.3.1.3"><minus id="S3.E6.m1.1.2.3.3.3.3.1.3.1.cmml" xref="S3.E6.m1.1.2.3.3.3.3.1.3.1"></minus><ci id="S3.E6.m1.1.2.3.3.3.3.1.3.2.cmml" xref="S3.E6.m1.1.2.3.3.3.3.1.3.2">𝑇</ci><cn id="S3.E6.m1.1.2.3.3.3.3.1.3.3.cmml" type="integer" xref="S3.E6.m1.1.2.3.3.3.3.1.3.3">1</cn></apply></apply><apply id="S3.E6.m1.1.2.3.3.3.3.2.cmml" xref="S3.E6.m1.1.2.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.2.3.3.3.3.2.1.cmml" xref="S3.E6.m1.1.2.3.3.3.3.2">subscript</csymbol><ci id="S3.E6.m1.1.2.3.3.3.3.2.2.cmml" xref="S3.E6.m1.1.2.3.3.3.3.2.2">𝑟</ci><ci id="S3.E6.m1.1.2.3.3.3.3.2.3.cmml" xref="S3.E6.m1.1.2.3.3.3.3.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">R(\textbf{S})=\mathcal{R}\cdot e^{\alpha\cdot\sum_{t=1}^{T-1}r_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">italic_R ( S ) = caligraphic_R ⋅ italic_e start_POSTSUPERSCRIPT italic_α ⋅ ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T - 1 end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS1.p1.2">where <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.1.m1.1"><semantics id="S3.SS4.SSS1.p1.1.m1.1a"><mi id="S3.SS4.SSS1.p1.1.m1.1.1" xref="S3.SS4.SSS1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.1.m1.1b"><ci id="S3.SS4.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.1.m1.1d">italic_α</annotation></semantics></math> is the parameter to balance the importance of user immediate rewards and we will conduct further analysis for this term in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.SS7" title="4.7. Parameter Analysis ‣ 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">4.7</span></a> to illustrate the relations.
The cumulative reward <math alttext="e^{\sum_{t=1}^{T-1}r_{t}}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.2.m2.1"><semantics id="S3.SS4.SSS1.p1.2.m2.1a"><msup id="S3.SS4.SSS1.p1.2.m2.1.1" xref="S3.SS4.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.1.1.2" xref="S3.SS4.SSS1.p1.2.m2.1.1.2.cmml">e</mi><mrow id="S3.SS4.SSS1.p1.2.m2.1.1.3" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.cmml"><mstyle displaystyle="false" id="S3.SS4.SSS1.p1.2.m2.1.1.3.1" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.cmml"><msubsup id="S3.SS4.SSS1.p1.2.m2.1.1.3.1a" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.cmml"><mo id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.2" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.2" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.2.cmml">t</mi><mo id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.1" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.3" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.2" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.2.cmml">T</mi><mo id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.1" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.1.cmml">−</mo><mn id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.3" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.3.cmml">1</mn></mrow></msubsup></mstyle><msub id="S3.SS4.SSS1.p1.2.m2.1.1.3.2" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.2.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.1.1.3.2.2" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.2.2.cmml">r</mi><mi id="S3.SS4.SSS1.p1.2.m2.1.1.3.2.3" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.2.3.cmml">t</mi></msub></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.2.m2.1b"><apply id="S3.SS4.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.2">𝑒</ci><apply id="S3.SS4.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3"><apply id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1">superscript</csymbol><apply id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1">subscript</csymbol><sum id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.2"></sum><apply id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3"><eq id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.1"></eq><ci id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.2">𝑡</ci><cn id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3"><minus id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.1"></minus><ci id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.2">𝑇</ci><cn id="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.1.3.3">1</cn></apply></apply><apply id="S3.SS4.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.1.1.3.2.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.2">subscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.1.1.3.2.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.2.2">𝑟</ci><ci id="S3.SS4.SSS1.p1.2.m2.1.1.3.2.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1.3.2.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.2.m2.1c">e^{\sum_{t=1}^{T-1}r_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.2.m2.1d">italic_e start_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T - 1 end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is non-discounted and takes the exponential form as in analogy in supervised learning (i.e. binary cross-entropy) and RL-based solutions (i.e. TD3) where each step aims to learn the log scale policy output with the immediate reward.
As we will illustrate in the following sections, this design derives a flow matching objective with a simple immediate reward augmentation. The flow estimation process is detailed in Part (b) of Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S2.F1" title="Figure 1 ‣ 2. Preliminaries ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.2. </span>Integrated Flow Matching</h4>
<div class="ltx_para" id="S3.SS4.SSS2.p1">
<p class="ltx_p" id="S3.SS4.SSS2.p1.1">Following the aforementioned reward integration, we propose to decompose the flow estimator of a given state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.1.m1.1"><semantics id="S3.SS4.SSS2.p1.1.m1.1a"><msub id="S3.SS4.SSS2.p1.1.m1.1.1" xref="S3.SS4.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS4.SSS2.p1.1.m1.1.1.2" xref="S3.SS4.SSS2.p1.1.m1.1.1.2.cmml">s</mi><mi id="S3.SS4.SSS2.p1.1.m1.1.1.3" xref="S3.SS4.SSS2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.1.m1.1b"><apply id="S3.SS4.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS4.SSS2.p1.1.m1.1.1.2">𝑠</ci><ci id="S3.SS4.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS4.SSS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.1.m1.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> into two corresponding components:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{F}(s_{t})=\mathcal{F}_{R}(s_{t})\cdot(\mathcal{F}_{I}(s_{t}))^{\alpha}" class="ltx_Math" display="block" id="S3.E7.m1.3"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.1.1.1.3.cmml">ℱ</mi><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E7.m1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.4" xref="S3.E7.m1.3.3.4.cmml">=</mo><mrow id="S3.E7.m1.3.3.3" xref="S3.E7.m1.3.3.3.cmml"><mrow id="S3.E7.m1.2.2.2.1" xref="S3.E7.m1.2.2.2.1.cmml"><msub id="S3.E7.m1.2.2.2.1.3" xref="S3.E7.m1.2.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.2.1.3.2" xref="S3.E7.m1.2.2.2.1.3.2.cmml">ℱ</mi><mi id="S3.E7.m1.2.2.2.1.3.3" xref="S3.E7.m1.2.2.2.1.3.3.cmml">R</mi></msub><mo id="S3.E7.m1.2.2.2.1.2" xref="S3.E7.m1.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.2.1.1.1" xref="S3.E7.m1.2.2.2.1.1.1.1.cmml"><mo id="S3.E7.m1.2.2.2.1.1.1.2" stretchy="false" xref="S3.E7.m1.2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.2.2.2.1.1.1.1" xref="S3.E7.m1.2.2.2.1.1.1.1.cmml"><mi id="S3.E7.m1.2.2.2.1.1.1.1.2" xref="S3.E7.m1.2.2.2.1.1.1.1.2.cmml">s</mi><mi id="S3.E7.m1.2.2.2.1.1.1.1.3" xref="S3.E7.m1.2.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E7.m1.2.2.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E7.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.3.3" rspace="0.222em" xref="S3.E7.m1.3.3.3.3.cmml">⋅</mo><msup id="S3.E7.m1.3.3.3.2" xref="S3.E7.m1.3.3.3.2.cmml"><mrow id="S3.E7.m1.3.3.3.2.1.1" xref="S3.E7.m1.3.3.3.2.1.1.1.cmml"><mo id="S3.E7.m1.3.3.3.2.1.1.2" stretchy="false" xref="S3.E7.m1.3.3.3.2.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.3.3.3.2.1.1.1" xref="S3.E7.m1.3.3.3.2.1.1.1.cmml"><msub id="S3.E7.m1.3.3.3.2.1.1.1.3" xref="S3.E7.m1.3.3.3.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.3.2.1.1.1.3.2" xref="S3.E7.m1.3.3.3.2.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E7.m1.3.3.3.2.1.1.1.3.3" xref="S3.E7.m1.3.3.3.2.1.1.1.3.3.cmml">I</mi></msub><mo id="S3.E7.m1.3.3.3.2.1.1.1.2" xref="S3.E7.m1.3.3.3.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.3.2.1.1.1.1.1" xref="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.3.3.3.2.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.3.3.3.2.1.1.1.1.1.1" xref="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E7.m1.3.3.3.2.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.3.2.1.1.3" stretchy="false" xref="S3.E7.m1.3.3.3.2.1.1.1.cmml">)</mo></mrow><mi id="S3.E7.m1.3.3.3.2.3" xref="S3.E7.m1.3.3.3.2.3.cmml">α</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3"><eq id="S3.E7.m1.3.3.4.cmml" xref="S3.E7.m1.3.3.4"></eq><apply id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><times id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.3">ℱ</ci><apply id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E7.m1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E7.m1.3.3.3.cmml" xref="S3.E7.m1.3.3.3"><ci id="S3.E7.m1.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3">⋅</ci><apply id="S3.E7.m1.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.1"><times id="S3.E7.m1.2.2.2.1.2.cmml" xref="S3.E7.m1.2.2.2.1.2"></times><apply id="S3.E7.m1.2.2.2.1.3.cmml" xref="S3.E7.m1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.1.3.1.cmml" xref="S3.E7.m1.2.2.2.1.3">subscript</csymbol><ci id="S3.E7.m1.2.2.2.1.3.2.cmml" xref="S3.E7.m1.2.2.2.1.3.2">ℱ</ci><ci id="S3.E7.m1.2.2.2.1.3.3.cmml" xref="S3.E7.m1.2.2.2.1.3.3">𝑅</ci></apply><apply id="S3.E7.m1.2.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.2">𝑠</ci><ci id="S3.E7.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.2.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E7.m1.3.3.3.2.cmml" xref="S3.E7.m1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.2.2.cmml" xref="S3.E7.m1.3.3.3.2">superscript</csymbol><apply id="S3.E7.m1.3.3.3.2.1.1.1.cmml" xref="S3.E7.m1.3.3.3.2.1.1"><times id="S3.E7.m1.3.3.3.2.1.1.1.2.cmml" xref="S3.E7.m1.3.3.3.2.1.1.1.2"></times><apply id="S3.E7.m1.3.3.3.2.1.1.1.3.cmml" xref="S3.E7.m1.3.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.2.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.3.2.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.3.2.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.3.2.1.1.1.3.2">ℱ</ci><ci id="S3.E7.m1.3.3.3.2.1.1.1.3.3.cmml" xref="S3.E7.m1.3.3.3.2.1.1.1.3.3">𝐼</ci></apply><apply id="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.3.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.3.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.3.2.1.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="S3.E7.m1.3.3.3.2.3.cmml" xref="S3.E7.m1.3.3.3.2.3">𝛼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\mathcal{F}(s_{t})=\mathcal{F}_{R}(s_{t})\cdot(\mathcal{F}_{I}(s_{t}))^{\alpha}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.3d">caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ⋅ ( caligraphic_F start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT italic_α end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS2.p1.4">where <math alttext="\mathcal{F}_{R}(s_{t})" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.2.m1.1"><semantics id="S3.SS4.SSS2.p1.2.m1.1a"><mrow id="S3.SS4.SSS2.p1.2.m1.1.1" xref="S3.SS4.SSS2.p1.2.m1.1.1.cmml"><msub id="S3.SS4.SSS2.p1.2.m1.1.1.3" xref="S3.SS4.SSS2.p1.2.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p1.2.m1.1.1.3.2" xref="S3.SS4.SSS2.p1.2.m1.1.1.3.2.cmml">ℱ</mi><mi id="S3.SS4.SSS2.p1.2.m1.1.1.3.3" xref="S3.SS4.SSS2.p1.2.m1.1.1.3.3.cmml">R</mi></msub><mo id="S3.SS4.SSS2.p1.2.m1.1.1.2" xref="S3.SS4.SSS2.p1.2.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS2.p1.2.m1.1.1.1.1" xref="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS2.p1.2.m1.1.1.1.1.2" stretchy="false" xref="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1" xref="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.2" xref="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.3" xref="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.SSS2.p1.2.m1.1.1.1.1.3" stretchy="false" xref="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.2.m1.1b"><apply id="S3.SS4.SSS2.p1.2.m1.1.1.cmml" xref="S3.SS4.SSS2.p1.2.m1.1.1"><times id="S3.SS4.SSS2.p1.2.m1.1.1.2.cmml" xref="S3.SS4.SSS2.p1.2.m1.1.1.2"></times><apply id="S3.SS4.SSS2.p1.2.m1.1.1.3.cmml" xref="S3.SS4.SSS2.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.2.m1.1.1.3.1.cmml" xref="S3.SS4.SSS2.p1.2.m1.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS2.p1.2.m1.1.1.3.2.cmml" xref="S3.SS4.SSS2.p1.2.m1.1.1.3.2">ℱ</ci><ci id="S3.SS4.SSS2.p1.2.m1.1.1.3.3.cmml" xref="S3.SS4.SSS2.p1.2.m1.1.1.3.3">𝑅</ci></apply><apply id="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.2.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS2.p1.2.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.2.m1.1c">\mathcal{F}_{R}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.2.m1.1d">caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> matches the flow of retention reward and <math alttext="\mathcal{F}_{I}(s_{t})" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.3.m2.1"><semantics id="S3.SS4.SSS2.p1.3.m2.1a"><mrow id="S3.SS4.SSS2.p1.3.m2.1.1" xref="S3.SS4.SSS2.p1.3.m2.1.1.cmml"><msub id="S3.SS4.SSS2.p1.3.m2.1.1.3" xref="S3.SS4.SSS2.p1.3.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p1.3.m2.1.1.3.2" xref="S3.SS4.SSS2.p1.3.m2.1.1.3.2.cmml">ℱ</mi><mi id="S3.SS4.SSS2.p1.3.m2.1.1.3.3" xref="S3.SS4.SSS2.p1.3.m2.1.1.3.3.cmml">I</mi></msub><mo id="S3.SS4.SSS2.p1.3.m2.1.1.2" xref="S3.SS4.SSS2.p1.3.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS2.p1.3.m2.1.1.1.1" xref="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS2.p1.3.m2.1.1.1.1.2" stretchy="false" xref="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1" xref="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.2" xref="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.3" xref="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.SSS2.p1.3.m2.1.1.1.1.3" stretchy="false" xref="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.3.m2.1b"><apply id="S3.SS4.SSS2.p1.3.m2.1.1.cmml" xref="S3.SS4.SSS2.p1.3.m2.1.1"><times id="S3.SS4.SSS2.p1.3.m2.1.1.2.cmml" xref="S3.SS4.SSS2.p1.3.m2.1.1.2"></times><apply id="S3.SS4.SSS2.p1.3.m2.1.1.3.cmml" xref="S3.SS4.SSS2.p1.3.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.3.m2.1.1.3.1.cmml" xref="S3.SS4.SSS2.p1.3.m2.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS2.p1.3.m2.1.1.3.2.cmml" xref="S3.SS4.SSS2.p1.3.m2.1.1.3.2">ℱ</ci><ci id="S3.SS4.SSS2.p1.3.m2.1.1.3.3.cmml" xref="S3.SS4.SSS2.p1.3.m2.1.1.3.3">𝐼</ci></apply><apply id="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.3.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.3.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS2.p1.3.m2.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.3.m2.1c">\mathcal{F}_{I}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.3.m2.1d">caligraphic_F start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> matches the accumulated immediate rewards before step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.4.m3.1"><semantics id="S3.SS4.SSS2.p1.4.m3.1a"><mi id="S3.SS4.SSS2.p1.4.m3.1.1" xref="S3.SS4.SSS2.p1.4.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.4.m3.1b"><ci id="S3.SS4.SSS2.p1.4.m3.1.1.cmml" xref="S3.SS4.SSS2.p1.4.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.4.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.4.m3.1d">italic_t</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{F}_{I}(s_{t})=e^{\sum_{j=1}^{t-1}r_{j}}" class="ltx_Math" display="block" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.3" xref="S3.E8.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E8.m1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.3.3.cmml">I</mi></msub><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E8.m1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E8.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">=</mo><msup id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.3.2" xref="S3.E8.m1.1.1.3.2.cmml">e</mi><mrow id="S3.E8.m1.1.1.3.3" xref="S3.E8.m1.1.1.3.3.cmml"><mstyle displaystyle="false" id="S3.E8.m1.1.1.3.3.1" xref="S3.E8.m1.1.1.3.3.1.cmml"><msubsup id="S3.E8.m1.1.1.3.3.1a" xref="S3.E8.m1.1.1.3.3.1.cmml"><mo id="S3.E8.m1.1.1.3.3.1.2.2" xref="S3.E8.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.1.1.3.3.1.2.3" xref="S3.E8.m1.1.1.3.3.1.2.3.cmml"><mi id="S3.E8.m1.1.1.3.3.1.2.3.2" xref="S3.E8.m1.1.1.3.3.1.2.3.2.cmml">j</mi><mo id="S3.E8.m1.1.1.3.3.1.2.3.1" xref="S3.E8.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.1.1.3.3.1.2.3.3" xref="S3.E8.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E8.m1.1.1.3.3.1.3" xref="S3.E8.m1.1.1.3.3.1.3.cmml"><mi id="S3.E8.m1.1.1.3.3.1.3.2" xref="S3.E8.m1.1.1.3.3.1.3.2.cmml">t</mi><mo id="S3.E8.m1.1.1.3.3.1.3.1" xref="S3.E8.m1.1.1.3.3.1.3.1.cmml">−</mo><mn id="S3.E8.m1.1.1.3.3.1.3.3" xref="S3.E8.m1.1.1.3.3.1.3.3.cmml">1</mn></mrow></msubsup></mstyle><msub id="S3.E8.m1.1.1.3.3.2" xref="S3.E8.m1.1.1.3.3.2.cmml"><mi id="S3.E8.m1.1.1.3.3.2.2" xref="S3.E8.m1.1.1.3.3.2.2.cmml">r</mi><mi id="S3.E8.m1.1.1.3.3.2.3" xref="S3.E8.m1.1.1.3.3.2.3.cmml">j</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><eq id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"></eq><apply id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><times id="S3.E8.m1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.2"></times><apply id="S3.E8.m1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.3.2">ℱ</ci><ci id="S3.E8.m1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.3.3">𝐼</ci></apply><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E8.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.3">superscript</csymbol><ci id="S3.E8.m1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.3.2">𝑒</ci><apply id="S3.E8.m1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.3.3"><apply id="S3.E8.m1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.3.1.1.cmml" xref="S3.E8.m1.1.1.3.3.1">superscript</csymbol><apply id="S3.E8.m1.1.1.3.3.1.2.cmml" xref="S3.E8.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.3.1.2.1.cmml" xref="S3.E8.m1.1.1.3.3.1">subscript</csymbol><sum id="S3.E8.m1.1.1.3.3.1.2.2.cmml" xref="S3.E8.m1.1.1.3.3.1.2.2"></sum><apply id="S3.E8.m1.1.1.3.3.1.2.3.cmml" xref="S3.E8.m1.1.1.3.3.1.2.3"><eq id="S3.E8.m1.1.1.3.3.1.2.3.1.cmml" xref="S3.E8.m1.1.1.3.3.1.2.3.1"></eq><ci id="S3.E8.m1.1.1.3.3.1.2.3.2.cmml" xref="S3.E8.m1.1.1.3.3.1.2.3.2">𝑗</ci><cn id="S3.E8.m1.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S3.E8.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E8.m1.1.1.3.3.1.3.cmml" xref="S3.E8.m1.1.1.3.3.1.3"><minus id="S3.E8.m1.1.1.3.3.1.3.1.cmml" xref="S3.E8.m1.1.1.3.3.1.3.1"></minus><ci id="S3.E8.m1.1.1.3.3.1.3.2.cmml" xref="S3.E8.m1.1.1.3.3.1.3.2">𝑡</ci><cn id="S3.E8.m1.1.1.3.3.1.3.3.cmml" type="integer" xref="S3.E8.m1.1.1.3.3.1.3.3">1</cn></apply></apply><apply id="S3.E8.m1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.3.2.1.cmml" xref="S3.E8.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.3.3.2.2.cmml" xref="S3.E8.m1.1.1.3.3.2.2">𝑟</ci><ci id="S3.E8.m1.1.1.3.3.2.3.cmml" xref="S3.E8.m1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\mathcal{F}_{I}(s_{t})=e^{\sum_{j=1}^{t-1}r_{j}}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">caligraphic_F start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = italic_e start_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS2.p1.8">Different from <math alttext="\mathcal{F}_{R}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.5.m1.1"><semantics id="S3.SS4.SSS2.p1.5.m1.1a"><msub id="S3.SS4.SSS2.p1.5.m1.1.1" xref="S3.SS4.SSS2.p1.5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p1.5.m1.1.1.2" xref="S3.SS4.SSS2.p1.5.m1.1.1.2.cmml">ℱ</mi><mi id="S3.SS4.SSS2.p1.5.m1.1.1.3" xref="S3.SS4.SSS2.p1.5.m1.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.5.m1.1b"><apply id="S3.SS4.SSS2.p1.5.m1.1.1.cmml" xref="S3.SS4.SSS2.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.5.m1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.5.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p1.5.m1.1.1.2.cmml" xref="S3.SS4.SSS2.p1.5.m1.1.1.2">ℱ</ci><ci id="S3.SS4.SSS2.p1.5.m1.1.1.3.cmml" xref="S3.SS4.SSS2.p1.5.m1.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.5.m1.1c">\mathcal{F}_{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.5.m1.1d">caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT</annotation></semantics></math> that needs to be optimized along with the GFN modules, <math alttext="\mathcal{F}_{I}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.6.m2.1"><semantics id="S3.SS4.SSS2.p1.6.m2.1a"><msub id="S3.SS4.SSS2.p1.6.m2.1.1" xref="S3.SS4.SSS2.p1.6.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p1.6.m2.1.1.2" xref="S3.SS4.SSS2.p1.6.m2.1.1.2.cmml">ℱ</mi><mi id="S3.SS4.SSS2.p1.6.m2.1.1.3" xref="S3.SS4.SSS2.p1.6.m2.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.6.m2.1b"><apply id="S3.SS4.SSS2.p1.6.m2.1.1.cmml" xref="S3.SS4.SSS2.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.6.m2.1.1.1.cmml" xref="S3.SS4.SSS2.p1.6.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p1.6.m2.1.1.2.cmml" xref="S3.SS4.SSS2.p1.6.m2.1.1.2">ℱ</ci><ci id="S3.SS4.SSS2.p1.6.m2.1.1.3.cmml" xref="S3.SS4.SSS2.p1.6.m2.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.6.m2.1c">\mathcal{F}_{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.6.m2.1d">caligraphic_F start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> is a non-parametric function that only depends on the observed immediate reward.
Specifically for the terminal state, we have <math alttext="\mathcal{F}_{R}(s_{T})=\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.7.m3.1"><semantics id="S3.SS4.SSS2.p1.7.m3.1a"><mrow id="S3.SS4.SSS2.p1.7.m3.1.1" xref="S3.SS4.SSS2.p1.7.m3.1.1.cmml"><mrow id="S3.SS4.SSS2.p1.7.m3.1.1.1" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.cmml"><msub id="S3.SS4.SSS2.p1.7.m3.1.1.1.3" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p1.7.m3.1.1.1.3.2" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.SS4.SSS2.p1.7.m3.1.1.1.3.3" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.3.3.cmml">R</mi></msub><mo id="S3.SS4.SSS2.p1.7.m3.1.1.1.2" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.2" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.3" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.3.cmml">T</mi></msub><mo id="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.SSS2.p1.7.m3.1.1.2" xref="S3.SS4.SSS2.p1.7.m3.1.1.2.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p1.7.m3.1.1.3" xref="S3.SS4.SSS2.p1.7.m3.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.7.m3.1b"><apply id="S3.SS4.SSS2.p1.7.m3.1.1.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1"><eq id="S3.SS4.SSS2.p1.7.m3.1.1.2.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1.2"></eq><apply id="S3.SS4.SSS2.p1.7.m3.1.1.1.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1.1"><times id="S3.SS4.SSS2.p1.7.m3.1.1.1.2.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.2"></times><apply id="S3.SS4.SSS2.p1.7.m3.1.1.1.3.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.7.m3.1.1.1.3.1.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS2.p1.7.m3.1.1.1.3.2.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.3.2">ℱ</ci><ci id="S3.SS4.SSS2.p1.7.m3.1.1.1.3.3.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.3.3">𝑅</ci></apply><apply id="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1.1.1.1.1.3">𝑇</ci></apply></apply><ci id="S3.SS4.SSS2.p1.7.m3.1.1.3.cmml" xref="S3.SS4.SSS2.p1.7.m3.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.7.m3.1c">\mathcal{F}_{R}(s_{T})=\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.7.m3.1d">caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) = caligraphic_R</annotation></semantics></math> and <math alttext="\mathcal{F}_{I}(s_{t})=e^{\sum_{j=1}^{T-1}r_{j}}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p1.8.m4.1"><semantics id="S3.SS4.SSS2.p1.8.m4.1a"><mrow id="S3.SS4.SSS2.p1.8.m4.1.1" xref="S3.SS4.SSS2.p1.8.m4.1.1.cmml"><mrow id="S3.SS4.SSS2.p1.8.m4.1.1.1" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.cmml"><msub id="S3.SS4.SSS2.p1.8.m4.1.1.1.3" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p1.8.m4.1.1.1.3.2" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.SS4.SSS2.p1.8.m4.1.1.1.3.3" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.3.3.cmml">I</mi></msub><mo id="S3.SS4.SSS2.p1.8.m4.1.1.1.2" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.2" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.3" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.SSS2.p1.8.m4.1.1.2" xref="S3.SS4.SSS2.p1.8.m4.1.1.2.cmml">=</mo><msup id="S3.SS4.SSS2.p1.8.m4.1.1.3" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.cmml"><mi id="S3.SS4.SSS2.p1.8.m4.1.1.3.2" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.2.cmml">e</mi><mrow id="S3.SS4.SSS2.p1.8.m4.1.1.3.3" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.cmml"><mstyle displaystyle="false" id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.cmml"><msubsup id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1a" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.cmml"><mo id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.2" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.cmml"><mi id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.2" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.2.cmml">j</mi><mo id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.1" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.3" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.cmml"><mi id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.2" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.2.cmml">T</mi><mo id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.1" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.1.cmml">−</mo><mn id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.3" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.3.cmml">1</mn></mrow></msubsup></mstyle><msub id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2.cmml"><mi id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2.2" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2.2.cmml">r</mi><mi id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2.3" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2.3.cmml">j</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p1.8.m4.1b"><apply id="S3.SS4.SSS2.p1.8.m4.1.1.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1"><eq id="S3.SS4.SSS2.p1.8.m4.1.1.2.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.2"></eq><apply id="S3.SS4.SSS2.p1.8.m4.1.1.1.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.1"><times id="S3.SS4.SSS2.p1.8.m4.1.1.1.2.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.2"></times><apply id="S3.SS4.SSS2.p1.8.m4.1.1.1.3.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.8.m4.1.1.1.3.1.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS2.p1.8.m4.1.1.1.3.2.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.3.2">ℱ</ci><ci id="S3.SS4.SSS2.p1.8.m4.1.1.1.3.3.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.3.3">𝐼</ci></apply><apply id="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.SS4.SSS2.p1.8.m4.1.1.3.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.8.m4.1.1.3.1.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3">superscript</csymbol><ci id="S3.SS4.SSS2.p1.8.m4.1.1.3.2.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.2">𝑒</ci><apply id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3"><apply id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.1.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1">superscript</csymbol><apply id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.1.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1">subscript</csymbol><sum id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.2.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.2"></sum><apply id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3"><eq id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.1.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.1"></eq><ci id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.2.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.2">𝑗</ci><cn id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3"><minus id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.1.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.1"></minus><ci id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.2.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.2">𝑇</ci><cn id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.3.cmml" type="integer" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.1.3.3">1</cn></apply></apply><apply id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2.1.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2">subscript</csymbol><ci id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2.2.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2.2">𝑟</ci><ci id="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2.3.cmml" xref="S3.SS4.SSS2.p1.8.m4.1.1.3.3.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p1.8.m4.1c">\mathcal{F}_{I}(s_{t})=e^{\sum_{j=1}^{T-1}r_{j}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p1.8.m4.1d">caligraphic_F start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = italic_e start_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T - 1 end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
Then, based on the flow matching objective, we can back-propagate the integrated reward towards intermediate steps:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{F}(s_{t})\cdot P_{F}\left(s_{t+1}|s_{t}\right)=\mathcal{F}(s_{t+1})%
\cdot P_{B}\left(s_{t}|s_{t+1}\right)" class="ltx_Math" display="block" id="S3.E9.m1.4"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.4" xref="S3.E9.m1.4.4.cmml"><mrow id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.2.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.3.cmml">ℱ</mi><mo id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E9.m1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E9.m1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.1.1.1.1.2" rspace="0.222em" xref="S3.E9.m1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.3.2.cmml">P</mi><mi id="S3.E9.m1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.3.3.cmml">F</mi></msub></mrow><mo id="S3.E9.m1.2.2.2.3" xref="S3.E9.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E9.m1.2.2.2.2.1" xref="S3.E9.m1.2.2.2.2.1.1.cmml"><mo id="S3.E9.m1.2.2.2.2.1.2" xref="S3.E9.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E9.m1.2.2.2.2.1.1" xref="S3.E9.m1.2.2.2.2.1.1.cmml"><msub id="S3.E9.m1.2.2.2.2.1.1.2" xref="S3.E9.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.E9.m1.2.2.2.2.1.1.2.2" xref="S3.E9.m1.2.2.2.2.1.1.2.2.cmml">s</mi><mrow id="S3.E9.m1.2.2.2.2.1.1.2.3" xref="S3.E9.m1.2.2.2.2.1.1.2.3.cmml"><mi id="S3.E9.m1.2.2.2.2.1.1.2.3.2" xref="S3.E9.m1.2.2.2.2.1.1.2.3.2.cmml">t</mi><mo id="S3.E9.m1.2.2.2.2.1.1.2.3.1" xref="S3.E9.m1.2.2.2.2.1.1.2.3.1.cmml">+</mo><mn id="S3.E9.m1.2.2.2.2.1.1.2.3.3" xref="S3.E9.m1.2.2.2.2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.E9.m1.2.2.2.2.1.1.1" xref="S3.E9.m1.2.2.2.2.1.1.1.cmml">|</mo><msub id="S3.E9.m1.2.2.2.2.1.1.3" xref="S3.E9.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E9.m1.2.2.2.2.1.1.3.2" xref="S3.E9.m1.2.2.2.2.1.1.3.2.cmml">s</mi><mi id="S3.E9.m1.2.2.2.2.1.1.3.3" xref="S3.E9.m1.2.2.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E9.m1.2.2.2.2.1.3" xref="S3.E9.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.4.4.5" xref="S3.E9.m1.4.4.5.cmml">=</mo><mrow id="S3.E9.m1.4.4.4" xref="S3.E9.m1.4.4.4.cmml"><mrow id="S3.E9.m1.3.3.3.1" xref="S3.E9.m1.3.3.3.1.cmml"><mrow id="S3.E9.m1.3.3.3.1.1" xref="S3.E9.m1.3.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.3.3.3.1.1.3" xref="S3.E9.m1.3.3.3.1.1.3.cmml">ℱ</mi><mo id="S3.E9.m1.3.3.3.1.1.2" xref="S3.E9.m1.3.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.3.3.3.1.1.1.1" xref="S3.E9.m1.3.3.3.1.1.1.1.1.cmml"><mo id="S3.E9.m1.3.3.3.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.3.3.3.1.1.1.1.1.cmml">(</mo><msub id="S3.E9.m1.3.3.3.1.1.1.1.1" xref="S3.E9.m1.3.3.3.1.1.1.1.1.cmml"><mi id="S3.E9.m1.3.3.3.1.1.1.1.1.2" xref="S3.E9.m1.3.3.3.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E9.m1.3.3.3.1.1.1.1.1.3" xref="S3.E9.m1.3.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.3.3.3.1.1.1.1.1.3.2" xref="S3.E9.m1.3.3.3.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E9.m1.3.3.3.1.1.1.1.1.3.1" xref="S3.E9.m1.3.3.3.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E9.m1.3.3.3.1.1.1.1.1.3.3" xref="S3.E9.m1.3.3.3.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E9.m1.3.3.3.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E9.m1.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.3.3.3.1.2" rspace="0.222em" xref="S3.E9.m1.3.3.3.1.2.cmml">⋅</mo><msub id="S3.E9.m1.3.3.3.1.3" xref="S3.E9.m1.3.3.3.1.3.cmml"><mi id="S3.E9.m1.3.3.3.1.3.2" xref="S3.E9.m1.3.3.3.1.3.2.cmml">P</mi><mi id="S3.E9.m1.3.3.3.1.3.3" xref="S3.E9.m1.3.3.3.1.3.3.cmml">B</mi></msub></mrow><mo id="S3.E9.m1.4.4.4.3" xref="S3.E9.m1.4.4.4.3.cmml">⁢</mo><mrow id="S3.E9.m1.4.4.4.2.1" xref="S3.E9.m1.4.4.4.2.1.1.cmml"><mo id="S3.E9.m1.4.4.4.2.1.2" xref="S3.E9.m1.4.4.4.2.1.1.cmml">(</mo><mrow id="S3.E9.m1.4.4.4.2.1.1" xref="S3.E9.m1.4.4.4.2.1.1.cmml"><msub id="S3.E9.m1.4.4.4.2.1.1.2" xref="S3.E9.m1.4.4.4.2.1.1.2.cmml"><mi id="S3.E9.m1.4.4.4.2.1.1.2.2" xref="S3.E9.m1.4.4.4.2.1.1.2.2.cmml">s</mi><mi id="S3.E9.m1.4.4.4.2.1.1.2.3" xref="S3.E9.m1.4.4.4.2.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E9.m1.4.4.4.2.1.1.1" xref="S3.E9.m1.4.4.4.2.1.1.1.cmml">|</mo><msub id="S3.E9.m1.4.4.4.2.1.1.3" xref="S3.E9.m1.4.4.4.2.1.1.3.cmml"><mi id="S3.E9.m1.4.4.4.2.1.1.3.2" xref="S3.E9.m1.4.4.4.2.1.1.3.2.cmml">s</mi><mrow id="S3.E9.m1.4.4.4.2.1.1.3.3" xref="S3.E9.m1.4.4.4.2.1.1.3.3.cmml"><mi id="S3.E9.m1.4.4.4.2.1.1.3.3.2" xref="S3.E9.m1.4.4.4.2.1.1.3.3.2.cmml">t</mi><mo id="S3.E9.m1.4.4.4.2.1.1.3.3.1" xref="S3.E9.m1.4.4.4.2.1.1.3.3.1.cmml">+</mo><mn id="S3.E9.m1.4.4.4.2.1.1.3.3.3" xref="S3.E9.m1.4.4.4.2.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E9.m1.4.4.4.2.1.3" xref="S3.E9.m1.4.4.4.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.4.cmml" xref="S3.E9.m1.4.4"><eq id="S3.E9.m1.4.4.5.cmml" xref="S3.E9.m1.4.4.5"></eq><apply id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2.2"><times id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.3"></times><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1"><ci id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2">⋅</ci><apply id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2"></times><ci id="S3.E9.m1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3">ℱ</ci><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2">𝑃</ci><ci id="S3.E9.m1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3">𝐹</ci></apply></apply><apply id="S3.E9.m1.2.2.2.2.1.1.cmml" xref="S3.E9.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E9.m1.2.2.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1">conditional</csymbol><apply id="S3.E9.m1.2.2.2.2.1.1.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E9.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2.2">𝑠</ci><apply id="S3.E9.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2.3"><plus id="S3.E9.m1.2.2.2.2.1.1.2.3.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2.3.1"></plus><ci id="S3.E9.m1.2.2.2.2.1.1.2.3.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2.3.2">𝑡</ci><cn id="S3.E9.m1.2.2.2.2.1.1.2.3.3.cmml" type="integer" xref="S3.E9.m1.2.2.2.2.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E9.m1.2.2.2.2.1.1.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E9.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.2">𝑠</ci><ci id="S3.E9.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E9.m1.4.4.4.cmml" xref="S3.E9.m1.4.4.4"><times id="S3.E9.m1.4.4.4.3.cmml" xref="S3.E9.m1.4.4.4.3"></times><apply id="S3.E9.m1.3.3.3.1.cmml" xref="S3.E9.m1.3.3.3.1"><ci id="S3.E9.m1.3.3.3.1.2.cmml" xref="S3.E9.m1.3.3.3.1.2">⋅</ci><apply id="S3.E9.m1.3.3.3.1.1.cmml" xref="S3.E9.m1.3.3.3.1.1"><times id="S3.E9.m1.3.3.3.1.1.2.cmml" xref="S3.E9.m1.3.3.3.1.1.2"></times><ci id="S3.E9.m1.3.3.3.1.1.3.cmml" xref="S3.E9.m1.3.3.3.1.1.3">ℱ</ci><apply id="S3.E9.m1.3.3.3.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.3.1.1.1.1.1.2">𝑠</ci><apply id="S3.E9.m1.3.3.3.1.1.1.1.1.3.cmml" xref="S3.E9.m1.3.3.3.1.1.1.1.1.3"><plus id="S3.E9.m1.3.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.3.3.3.1.1.1.1.1.3.1"></plus><ci id="S3.E9.m1.3.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.3.3.3.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E9.m1.3.3.3.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E9.m1.3.3.3.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S3.E9.m1.3.3.3.1.3.cmml" xref="S3.E9.m1.3.3.3.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.3.1.3.1.cmml" xref="S3.E9.m1.3.3.3.1.3">subscript</csymbol><ci id="S3.E9.m1.3.3.3.1.3.2.cmml" xref="S3.E9.m1.3.3.3.1.3.2">𝑃</ci><ci id="S3.E9.m1.3.3.3.1.3.3.cmml" xref="S3.E9.m1.3.3.3.1.3.3">𝐵</ci></apply></apply><apply id="S3.E9.m1.4.4.4.2.1.1.cmml" xref="S3.E9.m1.4.4.4.2.1"><csymbol cd="latexml" id="S3.E9.m1.4.4.4.2.1.1.1.cmml" xref="S3.E9.m1.4.4.4.2.1.1.1">conditional</csymbol><apply id="S3.E9.m1.4.4.4.2.1.1.2.cmml" xref="S3.E9.m1.4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.4.2.1.1.2.1.cmml" xref="S3.E9.m1.4.4.4.2.1.1.2">subscript</csymbol><ci id="S3.E9.m1.4.4.4.2.1.1.2.2.cmml" xref="S3.E9.m1.4.4.4.2.1.1.2.2">𝑠</ci><ci id="S3.E9.m1.4.4.4.2.1.1.2.3.cmml" xref="S3.E9.m1.4.4.4.2.1.1.2.3">𝑡</ci></apply><apply id="S3.E9.m1.4.4.4.2.1.1.3.cmml" xref="S3.E9.m1.4.4.4.2.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.4.2.1.1.3.1.cmml" xref="S3.E9.m1.4.4.4.2.1.1.3">subscript</csymbol><ci id="S3.E9.m1.4.4.4.2.1.1.3.2.cmml" xref="S3.E9.m1.4.4.4.2.1.1.3.2">𝑠</ci><apply id="S3.E9.m1.4.4.4.2.1.1.3.3.cmml" xref="S3.E9.m1.4.4.4.2.1.1.3.3"><plus id="S3.E9.m1.4.4.4.2.1.1.3.3.1.cmml" xref="S3.E9.m1.4.4.4.2.1.1.3.3.1"></plus><ci id="S3.E9.m1.4.4.4.2.1.1.3.3.2.cmml" xref="S3.E9.m1.4.4.4.2.1.1.3.3.2">𝑡</ci><cn id="S3.E9.m1.4.4.4.2.1.1.3.3.3.cmml" type="integer" xref="S3.E9.m1.4.4.4.2.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">\mathcal{F}(s_{t})\cdot P_{F}\left(s_{t+1}|s_{t}\right)=\mathcal{F}(s_{t+1})%
\cdot P_{B}\left(s_{t}|s_{t+1}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.4d">caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ⋅ italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ⋅ italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.p2">
<p class="ltx_p" id="S3.SS4.SSS2.p2.1">Combining Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.E7" title="In 3.4.2. Integrated Flow Matching ‣ 3.4. Refined Detailed Balance Learning with Reward Integration ‣ 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">7</span></a>), Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.E8" title="In 3.4.2. Integrated Flow Matching ‣ 3.4. Refined Detailed Balance Learning with Reward Integration ‣ 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">8</span></a>), and Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.E9" title="In 3.4.2. Integrated Flow Matching ‣ 3.4. Refined Detailed Balance Learning with Reward Integration ‣ 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">9</span></a>) together, we may derive the following simplified relation:</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.p3">
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E10">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E10X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{F}_{R}(s_{t})(\mathcal{F}_{I}(s_{t}))^{\alpha}P_{F}\left%
(a_{t}\mid s_{t}\right)" class="ltx_Math" display="inline" id="S3.E10X.2.1.1.m1.3"><semantics id="S3.E10X.2.1.1.m1.3a"><mrow id="S3.E10X.2.1.1.m1.3.3" xref="S3.E10X.2.1.1.m1.3.3.cmml"><msub id="S3.E10X.2.1.1.m1.3.3.5" xref="S3.E10X.2.1.1.m1.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10X.2.1.1.m1.3.3.5.2" xref="S3.E10X.2.1.1.m1.3.3.5.2.cmml">ℱ</mi><mi id="S3.E10X.2.1.1.m1.3.3.5.3" xref="S3.E10X.2.1.1.m1.3.3.5.3.cmml">R</mi></msub><mo id="S3.E10X.2.1.1.m1.3.3.4" xref="S3.E10X.2.1.1.m1.3.3.4.cmml">⁢</mo><mrow id="S3.E10X.2.1.1.m1.1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.cmml"><mo id="S3.E10X.2.1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10X.2.1.1.m1.1.1.1.1.1" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.2" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E10X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E10X.2.1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E10X.2.1.1.m1.3.3.4a" xref="S3.E10X.2.1.1.m1.3.3.4.cmml">⁢</mo><msup id="S3.E10X.2.1.1.m1.2.2.2" xref="S3.E10X.2.1.1.m1.2.2.2.cmml"><mrow id="S3.E10X.2.1.1.m1.2.2.2.1.1" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.cmml"><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.2" stretchy="false" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E10X.2.1.1.m1.2.2.2.1.1.1" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.cmml"><msub id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3.2" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3.3" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3.3.cmml">I</mi></msub><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.2" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.2" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.3" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10X.2.1.1.m1.2.2.2.1.1.3" stretchy="false" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.E10X.2.1.1.m1.2.2.2.3" xref="S3.E10X.2.1.1.m1.2.2.2.3.cmml">α</mi></msup><mo id="S3.E10X.2.1.1.m1.3.3.4b" xref="S3.E10X.2.1.1.m1.3.3.4.cmml">⁢</mo><msub id="S3.E10X.2.1.1.m1.3.3.6" xref="S3.E10X.2.1.1.m1.3.3.6.cmml"><mi id="S3.E10X.2.1.1.m1.3.3.6.2" xref="S3.E10X.2.1.1.m1.3.3.6.2.cmml">P</mi><mi id="S3.E10X.2.1.1.m1.3.3.6.3" xref="S3.E10X.2.1.1.m1.3.3.6.3.cmml">F</mi></msub><mo id="S3.E10X.2.1.1.m1.3.3.4c" xref="S3.E10X.2.1.1.m1.3.3.4.cmml">⁢</mo><mrow id="S3.E10X.2.1.1.m1.3.3.3.1" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.cmml"><mo id="S3.E10X.2.1.1.m1.3.3.3.1.2" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.cmml">(</mo><mrow id="S3.E10X.2.1.1.m1.3.3.3.1.1" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.cmml"><msub id="S3.E10X.2.1.1.m1.3.3.3.1.1.2" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.2.cmml"><mi id="S3.E10X.2.1.1.m1.3.3.3.1.1.2.2" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.2.2.cmml">a</mi><mi id="S3.E10X.2.1.1.m1.3.3.3.1.1.2.3" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.2.3.cmml">t</mi></msub><mo id="S3.E10X.2.1.1.m1.3.3.3.1.1.1" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.1.cmml">∣</mo><msub id="S3.E10X.2.1.1.m1.3.3.3.1.1.3" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.3.cmml"><mi id="S3.E10X.2.1.1.m1.3.3.3.1.1.3.2" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.3.2.cmml">s</mi><mi id="S3.E10X.2.1.1.m1.3.3.3.1.1.3.3" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E10X.2.1.1.m1.3.3.3.1.3" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10X.2.1.1.m1.3b"><apply id="S3.E10X.2.1.1.m1.3.3.cmml" xref="S3.E10X.2.1.1.m1.3.3"><times id="S3.E10X.2.1.1.m1.3.3.4.cmml" xref="S3.E10X.2.1.1.m1.3.3.4"></times><apply id="S3.E10X.2.1.1.m1.3.3.5.cmml" xref="S3.E10X.2.1.1.m1.3.3.5"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.3.3.5.1.cmml" xref="S3.E10X.2.1.1.m1.3.3.5">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.3.3.5.2.cmml" xref="S3.E10X.2.1.1.m1.3.3.5.2">ℱ</ci><ci id="S3.E10X.2.1.1.m1.3.3.5.3.cmml" xref="S3.E10X.2.1.1.m1.3.3.5.3">𝑅</ci></apply><apply id="S3.E10X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E10X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E10X.2.1.1.m1.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.2.2.2">superscript</csymbol><apply id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1"><times id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.2"></times><apply id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3.1.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3.2.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3.2">ℱ</ci><ci id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3.3.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.3.3">𝐼</ci></apply><apply id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.1.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="S3.E10X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E10X.2.1.1.m1.2.2.2.3">𝛼</ci></apply><apply id="S3.E10X.2.1.1.m1.3.3.6.cmml" xref="S3.E10X.2.1.1.m1.3.3.6"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.3.3.6.1.cmml" xref="S3.E10X.2.1.1.m1.3.3.6">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.3.3.6.2.cmml" xref="S3.E10X.2.1.1.m1.3.3.6.2">𝑃</ci><ci id="S3.E10X.2.1.1.m1.3.3.6.3.cmml" xref="S3.E10X.2.1.1.m1.3.3.6.3">𝐹</ci></apply><apply id="S3.E10X.2.1.1.m1.3.3.3.1.1.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.1"><csymbol cd="latexml" id="S3.E10X.2.1.1.m1.3.3.3.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.1">conditional</csymbol><apply id="S3.E10X.2.1.1.m1.3.3.3.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.3.3.3.1.1.2.1.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.2">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.3.3.3.1.1.2.2.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.2.2">𝑎</ci><ci id="S3.E10X.2.1.1.m1.3.3.3.1.1.2.3.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.2.3">𝑡</ci></apply><apply id="S3.E10X.2.1.1.m1.3.3.3.1.1.3.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E10X.2.1.1.m1.3.3.3.1.1.3.1.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.3">subscript</csymbol><ci id="S3.E10X.2.1.1.m1.3.3.3.1.1.3.2.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.3.2">𝑠</ci><ci id="S3.E10X.2.1.1.m1.3.3.3.1.1.3.3.cmml" xref="S3.E10X.2.1.1.m1.3.3.3.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10X.2.1.1.m1.3c">\displaystyle\mathcal{F}_{R}(s_{t})(\mathcal{F}_{I}(s_{t}))^{\alpha}P_{F}\left%
(a_{t}\mid s_{t}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E10X.2.1.1.m1.3d">caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ( caligraphic_F start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT italic_α end_POSTSUPERSCRIPT italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{F}_{R}(s_{t+1})(\mathcal{F}_{I}(s_{t+1}))^{\alpha}P_{B}%
\left(s_{t}|s_{t+1}\right)" class="ltx_Math" display="inline" id="S3.E10X.3.2.2.m1.3"><semantics id="S3.E10X.3.2.2.m1.3a"><mrow id="S3.E10X.3.2.2.m1.3.3" xref="S3.E10X.3.2.2.m1.3.3.cmml"><mi id="S3.E10X.3.2.2.m1.3.3.5" xref="S3.E10X.3.2.2.m1.3.3.5.cmml"></mi><mo id="S3.E10X.3.2.2.m1.3.3.4" xref="S3.E10X.3.2.2.m1.3.3.4.cmml">=</mo><mrow id="S3.E10X.3.2.2.m1.3.3.3" xref="S3.E10X.3.2.2.m1.3.3.3.cmml"><msub id="S3.E10X.3.2.2.m1.3.3.3.5" xref="S3.E10X.3.2.2.m1.3.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10X.3.2.2.m1.3.3.3.5.2" xref="S3.E10X.3.2.2.m1.3.3.3.5.2.cmml">ℱ</mi><mi id="S3.E10X.3.2.2.m1.3.3.3.5.3" xref="S3.E10X.3.2.2.m1.3.3.3.5.3.cmml">R</mi></msub><mo id="S3.E10X.3.2.2.m1.3.3.3.4" xref="S3.E10X.3.2.2.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.E10X.3.2.2.m1.1.1.1.1.1" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.cmml"><mo id="S3.E10X.3.2.2.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.1" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E10X.3.2.2.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E10X.3.2.2.m1.3.3.3.4a" xref="S3.E10X.3.2.2.m1.3.3.3.4.cmml">⁢</mo><msup id="S3.E10X.3.2.2.m1.2.2.2.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.cmml"><mrow id="S3.E10X.3.2.2.m1.2.2.2.2.1.1" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.cmml"><mo id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.2" stretchy="false" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.cmml"><msub id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.3.cmml">I</mi></msub><mo id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.1" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.3" stretchy="false" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.E10X.3.2.2.m1.2.2.2.2.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.3.cmml">α</mi></msup><mo id="S3.E10X.3.2.2.m1.3.3.3.4b" xref="S3.E10X.3.2.2.m1.3.3.3.4.cmml">⁢</mo><msub id="S3.E10X.3.2.2.m1.3.3.3.6" xref="S3.E10X.3.2.2.m1.3.3.3.6.cmml"><mi id="S3.E10X.3.2.2.m1.3.3.3.6.2" xref="S3.E10X.3.2.2.m1.3.3.3.6.2.cmml">P</mi><mi id="S3.E10X.3.2.2.m1.3.3.3.6.3" xref="S3.E10X.3.2.2.m1.3.3.3.6.3.cmml">B</mi></msub><mo id="S3.E10X.3.2.2.m1.3.3.3.4c" xref="S3.E10X.3.2.2.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.E10X.3.2.2.m1.3.3.3.3.1" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.cmml"><mo id="S3.E10X.3.2.2.m1.3.3.3.3.1.2" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S3.E10X.3.2.2.m1.3.3.3.3.1.1" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.cmml"><msub id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2.cmml"><mi id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2.2" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2.2.cmml">s</mi><mi id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2.3" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.1" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.1.cmml">|</mo><msub id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.cmml"><mi id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.2" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.2.cmml">s</mi><mrow id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.cmml"><mi id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.2" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.2.cmml">t</mi><mo id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.1" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.1.cmml">+</mo><mn id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.3" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E10X.3.2.2.m1.3.3.3.3.1.3" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10X.3.2.2.m1.3b"><apply id="S3.E10X.3.2.2.m1.3.3.cmml" xref="S3.E10X.3.2.2.m1.3.3"><eq id="S3.E10X.3.2.2.m1.3.3.4.cmml" xref="S3.E10X.3.2.2.m1.3.3.4"></eq><csymbol cd="latexml" id="S3.E10X.3.2.2.m1.3.3.5.cmml" xref="S3.E10X.3.2.2.m1.3.3.5">absent</csymbol><apply id="S3.E10X.3.2.2.m1.3.3.3.cmml" xref="S3.E10X.3.2.2.m1.3.3.3"><times id="S3.E10X.3.2.2.m1.3.3.3.4.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.4"></times><apply id="S3.E10X.3.2.2.m1.3.3.3.5.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.5"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.3.3.3.5.1.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.5">subscript</csymbol><ci id="S3.E10X.3.2.2.m1.3.3.3.5.2.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.5.2">ℱ</ci><ci id="S3.E10X.3.2.2.m1.3.3.3.5.3.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.5.3">𝑅</ci></apply><apply id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2">𝑠</ci><apply id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3"><plus id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.1"></plus><ci id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E10X.3.2.2.m1.2.2.2.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.2.2.2.2.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2">superscript</csymbol><apply id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1"><times id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.2"></times><apply id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.2">ℱ</ci><ci id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.3">𝐼</ci></apply><apply id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.2">𝑠</ci><apply id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3"><plus id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.1"></plus><ci id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><ci id="S3.E10X.3.2.2.m1.2.2.2.2.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.3">𝛼</ci></apply><apply id="S3.E10X.3.2.2.m1.3.3.3.6.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.6"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.3.3.3.6.1.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.6">subscript</csymbol><ci id="S3.E10X.3.2.2.m1.3.3.3.6.2.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.6.2">𝑃</ci><ci id="S3.E10X.3.2.2.m1.3.3.3.6.3.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.6.3">𝐵</ci></apply><apply id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.3.1"><csymbol cd="latexml" id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.1.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.1">conditional</csymbol><apply id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2.1.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2">subscript</csymbol><ci id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2.2.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2.2">𝑠</ci><ci id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2.3.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.2.3">𝑡</ci></apply><apply id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.1.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.2.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.2">𝑠</ci><apply id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3"><plus id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.1.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.1"></plus><ci id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.2.cmml" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.2">𝑡</ci><cn id="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.3.cmml" type="integer" xref="S3.E10X.3.2.2.m1.3.3.3.3.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10X.3.2.2.m1.3c">\displaystyle=\mathcal{F}_{R}(s_{t+1})(\mathcal{F}_{I}(s_{t+1}))^{\alpha}P_{B}%
\left(s_{t}|s_{t+1}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E10X.3.2.2.m1.3d">= caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ( caligraphic_F start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT italic_α end_POSTSUPERSCRIPT italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E10Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle(e^{\sum_{j=1}^{t-1}r_{j}})^{\alpha}\cdot\mathcal{F}_{R}(s_{t})P_%
{F}\left(s_{t+1}\mid s_{t}\right)" class="ltx_Math" display="inline" id="S3.E10Xa.2.1.1.m1.3"><semantics id="S3.E10Xa.2.1.1.m1.3a"><mrow id="S3.E10Xa.2.1.1.m1.3.3" xref="S3.E10Xa.2.1.1.m1.3.3.cmml"><mrow id="S3.E10Xa.2.1.1.m1.1.1.1" xref="S3.E10Xa.2.1.1.m1.1.1.1.cmml"><msup id="S3.E10Xa.2.1.1.m1.1.1.1.1" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">e</mi><mrow id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="false" id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml"><msubsup id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1a" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.2" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.2" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.2.cmml">j</mi><mo id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.1" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.3" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.cmml"><mi id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.2" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.2.cmml">t</mi><mo id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.1" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.1.cmml">−</mo><mn id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.3" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.3.cmml">1</mn></mrow></msubsup></mstyle><msub id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.cmml">r</mi><mi id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.3" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.cmml">j</mi></msub></mrow></msup><mo id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E10Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.3.cmml">α</mi></msup><mo id="S3.E10Xa.2.1.1.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.E10Xa.2.1.1.m1.1.1.1.2.cmml">⋅</mo><msub id="S3.E10Xa.2.1.1.m1.1.1.1.3" xref="S3.E10Xa.2.1.1.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10Xa.2.1.1.m1.1.1.1.3.2" xref="S3.E10Xa.2.1.1.m1.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E10Xa.2.1.1.m1.1.1.1.3.3" xref="S3.E10Xa.2.1.1.m1.1.1.1.3.3.cmml">R</mi></msub></mrow><mo id="S3.E10Xa.2.1.1.m1.3.3.4" xref="S3.E10Xa.2.1.1.m1.3.3.4.cmml">⁢</mo><mrow id="S3.E10Xa.2.1.1.m1.2.2.2.1" xref="S3.E10Xa.2.1.1.m1.2.2.2.1.1.cmml"><mo id="S3.E10Xa.2.1.1.m1.2.2.2.1.2" stretchy="false" xref="S3.E10Xa.2.1.1.m1.2.2.2.1.1.cmml">(</mo><msub id="S3.E10Xa.2.1.1.m1.2.2.2.1.1" xref="S3.E10Xa.2.1.1.m1.2.2.2.1.1.cmml"><mi id="S3.E10Xa.2.1.1.m1.2.2.2.1.1.2" xref="S3.E10Xa.2.1.1.m1.2.2.2.1.1.2.cmml">s</mi><mi id="S3.E10Xa.2.1.1.m1.2.2.2.1.1.3" xref="S3.E10Xa.2.1.1.m1.2.2.2.1.1.3.cmml">t</mi></msub><mo id="S3.E10Xa.2.1.1.m1.2.2.2.1.3" stretchy="false" xref="S3.E10Xa.2.1.1.m1.2.2.2.1.1.cmml">)</mo></mrow><mo id="S3.E10Xa.2.1.1.m1.3.3.4a" xref="S3.E10Xa.2.1.1.m1.3.3.4.cmml">⁢</mo><msub id="S3.E10Xa.2.1.1.m1.3.3.5" xref="S3.E10Xa.2.1.1.m1.3.3.5.cmml"><mi id="S3.E10Xa.2.1.1.m1.3.3.5.2" xref="S3.E10Xa.2.1.1.m1.3.3.5.2.cmml">P</mi><mi id="S3.E10Xa.2.1.1.m1.3.3.5.3" xref="S3.E10Xa.2.1.1.m1.3.3.5.3.cmml">F</mi></msub><mo id="S3.E10Xa.2.1.1.m1.3.3.4b" xref="S3.E10Xa.2.1.1.m1.3.3.4.cmml">⁢</mo><mrow id="S3.E10Xa.2.1.1.m1.3.3.3.1" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.cmml"><mo id="S3.E10Xa.2.1.1.m1.3.3.3.1.2" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.cmml">(</mo><mrow id="S3.E10Xa.2.1.1.m1.3.3.3.1.1" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.cmml"><msub id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.cmml"><mi id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.2" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.2.cmml">s</mi><mrow id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.cmml"><mi id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.2" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.2.cmml">t</mi><mo id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.1" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.1.cmml">+</mo><mn id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.3" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.1" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.1.cmml">∣</mo><msub id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3.cmml"><mi id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3.2" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3.2.cmml">s</mi><mi id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3.3" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E10Xa.2.1.1.m1.3.3.3.1.3" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10Xa.2.1.1.m1.3b"><apply id="S3.E10Xa.2.1.1.m1.3.3.cmml" xref="S3.E10Xa.2.1.1.m1.3.3"><times id="S3.E10Xa.2.1.1.m1.3.3.4.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.4"></times><apply id="S3.E10Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1"><ci id="S3.E10Xa.2.1.1.m1.1.1.1.2.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.2">⋅</ci><apply id="S3.E10Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.2">𝑒</ci><apply id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3"><apply id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3"><eq id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.2">𝑗</ci><cn id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3"><minus id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.1.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.1"></minus><ci id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.2.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.2">𝑡</ci><cn id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.3.cmml" type="integer" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.3.3">1</cn></apply></apply><apply id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.2">𝑟</ci><ci id="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.3">𝑗</ci></apply></apply></apply><ci id="S3.E10Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.1.3">𝛼</ci></apply><apply id="S3.E10Xa.2.1.1.m1.1.1.1.3.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.1.1.1.3.1.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.3">subscript</csymbol><ci id="S3.E10Xa.2.1.1.m1.1.1.1.3.2.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.3.2">ℱ</ci><ci id="S3.E10Xa.2.1.1.m1.1.1.1.3.3.cmml" xref="S3.E10Xa.2.1.1.m1.1.1.1.3.3">𝑅</ci></apply></apply><apply id="S3.E10Xa.2.1.1.m1.2.2.2.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.2.2.2.1.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.2.1">subscript</csymbol><ci id="S3.E10Xa.2.1.1.m1.2.2.2.1.1.2.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.2.1.1.2">𝑠</ci><ci id="S3.E10Xa.2.1.1.m1.2.2.2.1.1.3.cmml" xref="S3.E10Xa.2.1.1.m1.2.2.2.1.1.3">𝑡</ci></apply><apply id="S3.E10Xa.2.1.1.m1.3.3.5.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.5"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.3.3.5.1.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.5">subscript</csymbol><ci id="S3.E10Xa.2.1.1.m1.3.3.5.2.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.5.2">𝑃</ci><ci id="S3.E10Xa.2.1.1.m1.3.3.5.3.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.5.3">𝐹</ci></apply><apply id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.3.1"><csymbol cd="latexml" id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.1.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.1">conditional</csymbol><apply id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.1.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2">subscript</csymbol><ci id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.2.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.2">𝑠</ci><apply id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3"><plus id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.1.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.1"></plus><ci id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.2.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.2">𝑡</ci><cn id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.3.cmml" type="integer" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3.1.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3">subscript</csymbol><ci id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3.2.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3.2">𝑠</ci><ci id="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3.3.cmml" xref="S3.E10Xa.2.1.1.m1.3.3.3.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10Xa.2.1.1.m1.3c">\displaystyle(e^{\sum_{j=1}^{t-1}r_{j}})^{\alpha}\cdot\mathcal{F}_{R}(s_{t})P_%
{F}\left(s_{t+1}\mid s_{t}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E10Xa.2.1.1.m1.3d">( italic_e start_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_α end_POSTSUPERSCRIPT ⋅ caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(e^{\sum_{j=1}^{t}r_{j}})^{\alpha}\cdot\mathcal{F}_{R}(s_{t+1})P%
_{B}\left(s_{t}|s_{t+1}\right)" class="ltx_Math" display="inline" id="S3.E10Xa.3.2.2.m1.3"><semantics id="S3.E10Xa.3.2.2.m1.3a"><mrow id="S3.E10Xa.3.2.2.m1.3.3" xref="S3.E10Xa.3.2.2.m1.3.3.cmml"><mi id="S3.E10Xa.3.2.2.m1.3.3.5" xref="S3.E10Xa.3.2.2.m1.3.3.5.cmml"></mi><mo id="S3.E10Xa.3.2.2.m1.3.3.4" xref="S3.E10Xa.3.2.2.m1.3.3.4.cmml">=</mo><mrow id="S3.E10Xa.3.2.2.m1.3.3.3" xref="S3.E10Xa.3.2.2.m1.3.3.3.cmml"><mrow id="S3.E10Xa.3.2.2.m1.1.1.1.1" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.cmml"><msup id="S3.E10Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.cmml"><mrow id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">e</mi><mrow id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="false" id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml"><msubsup id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1a" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.2" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.2" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.2.cmml">j</mi><mo id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.1" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.3" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.3" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.3.cmml">t</mi></msubsup></mstyle><msub id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">r</mi><mi id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">j</mi></msub></mrow></msup><mo id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.3" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.3.cmml">α</mi></msup><mo id="S3.E10Xa.3.2.2.m1.1.1.1.1.2" rspace="0.222em" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E10Xa.3.2.2.m1.1.1.1.1.3" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10Xa.3.2.2.m1.1.1.1.1.3.2" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E10Xa.3.2.2.m1.1.1.1.1.3.3" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.3.3.cmml">R</mi></msub></mrow><mo id="S3.E10Xa.3.2.2.m1.3.3.3.4" xref="S3.E10Xa.3.2.2.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.E10Xa.3.2.2.m1.2.2.2.2.1" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.cmml"><mo id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.cmml">(</mo><msub id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.cmml"><mi id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.2" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.2.cmml">s</mi><mrow id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.2" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.2.cmml">t</mi><mo id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.1" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.1.cmml">+</mo><mn id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.3" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.cmml">)</mo></mrow><mo id="S3.E10Xa.3.2.2.m1.3.3.3.4a" xref="S3.E10Xa.3.2.2.m1.3.3.3.4.cmml">⁢</mo><msub id="S3.E10Xa.3.2.2.m1.3.3.3.5" xref="S3.E10Xa.3.2.2.m1.3.3.3.5.cmml"><mi id="S3.E10Xa.3.2.2.m1.3.3.3.5.2" xref="S3.E10Xa.3.2.2.m1.3.3.3.5.2.cmml">P</mi><mi id="S3.E10Xa.3.2.2.m1.3.3.3.5.3" xref="S3.E10Xa.3.2.2.m1.3.3.3.5.3.cmml">B</mi></msub><mo id="S3.E10Xa.3.2.2.m1.3.3.3.4b" xref="S3.E10Xa.3.2.2.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.E10Xa.3.2.2.m1.3.3.3.3.1" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.cmml"><mo id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.2" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.cmml"><msub id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2.cmml"><mi id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2.2" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2.2.cmml">s</mi><mi id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2.3" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.1" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.1.cmml">|</mo><msub id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.cmml"><mi id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.2" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.2.cmml">s</mi><mrow id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.cmml"><mi id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.2" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.2.cmml">t</mi><mo id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.1" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.1.cmml">+</mo><mn id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.3" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.3" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10Xa.3.2.2.m1.3b"><apply id="S3.E10Xa.3.2.2.m1.3.3.cmml" xref="S3.E10Xa.3.2.2.m1.3.3"><eq id="S3.E10Xa.3.2.2.m1.3.3.4.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.4"></eq><csymbol cd="latexml" id="S3.E10Xa.3.2.2.m1.3.3.5.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.5">absent</csymbol><apply id="S3.E10Xa.3.2.2.m1.3.3.3.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3"><times id="S3.E10Xa.3.2.2.m1.3.3.3.4.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.4"></times><apply id="S3.E10Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1"><ci id="S3.E10Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.2">⋅</ci><apply id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2">𝑒</ci><apply id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3"><apply id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3"><eq id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.2">𝑗</ci><cn id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.3">𝑡</ci></apply><apply id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.2">𝑟</ci><ci id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.3">𝑗</ci></apply></apply></apply><ci id="S3.E10Xa.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.1.3">𝛼</ci></apply><apply id="S3.E10Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10Xa.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10Xa.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.3.2">ℱ</ci><ci id="S3.E10Xa.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E10Xa.3.2.2.m1.1.1.1.1.3.3">𝑅</ci></apply></apply><apply id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.cmml" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.2.cmml" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.2">𝑠</ci><apply id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.cmml" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3"><plus id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.1"></plus><ci id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.2">𝑡</ci><cn id="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.3.cmml" type="integer" xref="S3.E10Xa.3.2.2.m1.2.2.2.2.1.1.3.3">1</cn></apply></apply><apply id="S3.E10Xa.3.2.2.m1.3.3.3.5.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.5"><csymbol cd="ambiguous" id="S3.E10Xa.3.2.2.m1.3.3.3.5.1.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.5">subscript</csymbol><ci id="S3.E10Xa.3.2.2.m1.3.3.3.5.2.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.5.2">𝑃</ci><ci id="S3.E10Xa.3.2.2.m1.3.3.3.5.3.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.5.3">𝐵</ci></apply><apply id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1"><csymbol cd="latexml" id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.1.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.1">conditional</csymbol><apply id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2.1.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2">subscript</csymbol><ci id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2.2.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2.2">𝑠</ci><ci id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2.3.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.2.3">𝑡</ci></apply><apply id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.1.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.2.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.2">𝑠</ci><apply id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3"><plus id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.1.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.1"></plus><ci id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.2.cmml" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.2">𝑡</ci><cn id="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.3.cmml" type="integer" xref="S3.E10Xa.3.2.2.m1.3.3.3.3.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10Xa.3.2.2.m1.3c">\displaystyle=(e^{\sum_{j=1}^{t}r_{j}})^{\alpha}\cdot\mathcal{F}_{R}(s_{t+1})P%
_{B}\left(s_{t}|s_{t+1}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E10Xa.3.2.2.m1.3d">= ( italic_e start_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_α end_POSTSUPERSCRIPT ⋅ caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E10Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{F}_{R}(s_{t})P_{F}\left(s_{t+}|s_{t}\right)" class="ltx_Math" display="inline" id="S3.E10Xb.2.1.1.m1.2"><semantics id="S3.E10Xb.2.1.1.m1.2a"><mrow id="S3.E10Xb.2.1.1.m1.2.2" xref="S3.E10Xb.2.1.1.m1.2.2.cmml"><msub id="S3.E10Xb.2.1.1.m1.2.2.4" xref="S3.E10Xb.2.1.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10Xb.2.1.1.m1.2.2.4.2" xref="S3.E10Xb.2.1.1.m1.2.2.4.2.cmml">ℱ</mi><mi id="S3.E10Xb.2.1.1.m1.2.2.4.3" xref="S3.E10Xb.2.1.1.m1.2.2.4.3.cmml">R</mi></msub><mo id="S3.E10Xb.2.1.1.m1.2.2.3" xref="S3.E10Xb.2.1.1.m1.2.2.3.cmml">⁢</mo><mrow id="S3.E10Xb.2.1.1.m1.1.1.1.1" xref="S3.E10Xb.2.1.1.m1.1.1.1.1.1.cmml"><mo id="S3.E10Xb.2.1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.E10Xb.2.1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10Xb.2.1.1.m1.1.1.1.1.1" xref="S3.E10Xb.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E10Xb.2.1.1.m1.1.1.1.1.1.2" xref="S3.E10Xb.2.1.1.m1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E10Xb.2.1.1.m1.1.1.1.1.1.3" xref="S3.E10Xb.2.1.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E10Xb.2.1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.E10Xb.2.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E10Xb.2.1.1.m1.2.2.3a" xref="S3.E10Xb.2.1.1.m1.2.2.3.cmml">⁢</mo><msub id="S3.E10Xb.2.1.1.m1.2.2.5" xref="S3.E10Xb.2.1.1.m1.2.2.5.cmml"><mi id="S3.E10Xb.2.1.1.m1.2.2.5.2" xref="S3.E10Xb.2.1.1.m1.2.2.5.2.cmml">P</mi><mi id="S3.E10Xb.2.1.1.m1.2.2.5.3" xref="S3.E10Xb.2.1.1.m1.2.2.5.3.cmml">F</mi></msub><mo id="S3.E10Xb.2.1.1.m1.2.2.3b" xref="S3.E10Xb.2.1.1.m1.2.2.3.cmml">⁢</mo><mrow id="S3.E10Xb.2.1.1.m1.2.2.2.1" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.cmml"><mo id="S3.E10Xb.2.1.1.m1.2.2.2.1.2" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.cmml">(</mo><mrow id="S3.E10Xb.2.1.1.m1.2.2.2.1.1" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.cmml"><msub id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.cmml"><mi id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.2" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.2.cmml">s</mi><mrow id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3.cmml"><mi id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3.2" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3.2.cmml">t</mi><mo id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3.3" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3.3.cmml">+</mo></mrow></msub><mo fence="false" id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.1" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.1.cmml">|</mo><msub id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3.cmml"><mi id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3.2" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3.2.cmml">s</mi><mi id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3.3" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E10Xb.2.1.1.m1.2.2.2.1.3" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10Xb.2.1.1.m1.2b"><apply id="S3.E10Xb.2.1.1.m1.2.2.cmml" xref="S3.E10Xb.2.1.1.m1.2.2"><times id="S3.E10Xb.2.1.1.m1.2.2.3.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.3"></times><apply id="S3.E10Xb.2.1.1.m1.2.2.4.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E10Xb.2.1.1.m1.2.2.4.1.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.4">subscript</csymbol><ci id="S3.E10Xb.2.1.1.m1.2.2.4.2.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.4.2">ℱ</ci><ci id="S3.E10Xb.2.1.1.m1.2.2.4.3.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.4.3">𝑅</ci></apply><apply id="S3.E10Xb.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E10Xb.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10Xb.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E10Xb.2.1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.E10Xb.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E10Xb.2.1.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E10Xb.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E10Xb.2.1.1.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E10Xb.2.1.1.m1.2.2.5.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.5"><csymbol cd="ambiguous" id="S3.E10Xb.2.1.1.m1.2.2.5.1.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.5">subscript</csymbol><ci id="S3.E10Xb.2.1.1.m1.2.2.5.2.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.5.2">𝑃</ci><ci id="S3.E10Xb.2.1.1.m1.2.2.5.3.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.5.3">𝐹</ci></apply><apply id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1"><csymbol cd="latexml" id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.1.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.1">conditional</csymbol><apply id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.1.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.2.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.2">𝑠</ci><apply id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3"><csymbol cd="latexml" id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3.1.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3">limit-from</csymbol><ci id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3.2.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3.2">𝑡</ci><plus id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3.3.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.2.3.3"></plus></apply></apply><apply id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3.1.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3.2.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3.2">𝑠</ci><ci id="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3.3.cmml" xref="S3.E10Xb.2.1.1.m1.2.2.2.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10Xb.2.1.1.m1.2c">\displaystyle\mathcal{F}_{R}(s_{t})P_{F}\left(s_{t+}|s_{t}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E10Xb.2.1.1.m1.2d">caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=e^{\alpha r_{t}}\cdot\mathcal{F}_{R}(s_{t+1})P_{B}\left(s_{t}|s_%
{t+1}\right)" class="ltx_Math" display="inline" id="S3.E10Xb.3.2.2.m1.2"><semantics id="S3.E10Xb.3.2.2.m1.2a"><mrow id="S3.E10Xb.3.2.2.m1.2.2" xref="S3.E10Xb.3.2.2.m1.2.2.cmml"><mi id="S3.E10Xb.3.2.2.m1.2.2.4" xref="S3.E10Xb.3.2.2.m1.2.2.4.cmml"></mi><mo id="S3.E10Xb.3.2.2.m1.2.2.3" xref="S3.E10Xb.3.2.2.m1.2.2.3.cmml">=</mo><mrow id="S3.E10Xb.3.2.2.m1.2.2.2" xref="S3.E10Xb.3.2.2.m1.2.2.2.cmml"><mrow id="S3.E10Xb.3.2.2.m1.2.2.2.4" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.cmml"><msup id="S3.E10Xb.3.2.2.m1.2.2.2.4.2" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.cmml"><mi id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.2" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.2.cmml">e</mi><mrow id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.cmml"><mi id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.2" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.2.cmml">α</mi><mo id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.1" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.1.cmml">⁢</mo><msub id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3.cmml"><mi id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3.2" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3.2.cmml">r</mi><mi id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3.3" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3.3.cmml">t</mi></msub></mrow></msup><mo id="S3.E10Xb.3.2.2.m1.2.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.1.cmml">⋅</mo><msub id="S3.E10Xb.3.2.2.m1.2.2.2.4.3" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10Xb.3.2.2.m1.2.2.2.4.3.2" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.3.2.cmml">ℱ</mi><mi id="S3.E10Xb.3.2.2.m1.2.2.2.4.3.3" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.3.3.cmml">R</mi></msub></mrow><mo id="S3.E10Xb.3.2.2.m1.2.2.2.3" xref="S3.E10Xb.3.2.2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E10Xb.3.2.2.m1.1.1.1.1.1" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.cmml"><mo id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.1" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E10Xb.3.2.2.m1.2.2.2.3a" xref="S3.E10Xb.3.2.2.m1.2.2.2.3.cmml">⁢</mo><msub id="S3.E10Xb.3.2.2.m1.2.2.2.5" xref="S3.E10Xb.3.2.2.m1.2.2.2.5.cmml"><mi id="S3.E10Xb.3.2.2.m1.2.2.2.5.2" xref="S3.E10Xb.3.2.2.m1.2.2.2.5.2.cmml">P</mi><mi id="S3.E10Xb.3.2.2.m1.2.2.2.5.3" xref="S3.E10Xb.3.2.2.m1.2.2.2.5.3.cmml">B</mi></msub><mo id="S3.E10Xb.3.2.2.m1.2.2.2.3b" xref="S3.E10Xb.3.2.2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E10Xb.3.2.2.m1.2.2.2.2.1" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.cmml"><mo id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.2" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.cmml"><msub id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2.2" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2.2.cmml">s</mi><mi id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2.3" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.1" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.1.cmml">|</mo><msub id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.2" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.2.cmml">s</mi><mrow id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.cmml"><mi id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.2" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.2.cmml">t</mi><mo id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.1" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.1.cmml">+</mo><mn id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.3" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.3" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10Xb.3.2.2.m1.2b"><apply id="S3.E10Xb.3.2.2.m1.2.2.cmml" xref="S3.E10Xb.3.2.2.m1.2.2"><eq id="S3.E10Xb.3.2.2.m1.2.2.3.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.3"></eq><csymbol cd="latexml" id="S3.E10Xb.3.2.2.m1.2.2.4.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.4">absent</csymbol><apply id="S3.E10Xb.3.2.2.m1.2.2.2.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2"><times id="S3.E10Xb.3.2.2.m1.2.2.2.3.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.3"></times><apply id="S3.E10Xb.3.2.2.m1.2.2.2.4.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4"><ci id="S3.E10Xb.3.2.2.m1.2.2.2.4.1.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.1">⋅</ci><apply id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2"><csymbol cd="ambiguous" id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.1.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2">superscript</csymbol><ci id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.2.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.2">𝑒</ci><apply id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3"><times id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.1.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.1"></times><ci id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.2.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.2">𝛼</ci><apply id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3"><csymbol cd="ambiguous" id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3.1.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3">subscript</csymbol><ci id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3.2.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3.2">𝑟</ci><ci id="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3.3.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E10Xb.3.2.2.m1.2.2.2.4.3.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="S3.E10Xb.3.2.2.m1.2.2.2.4.3.1.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.3">subscript</csymbol><ci id="S3.E10Xb.3.2.2.m1.2.2.2.4.3.2.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.3.2">ℱ</ci><ci id="S3.E10Xb.3.2.2.m1.2.2.2.4.3.3.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.4.3.3">𝑅</ci></apply></apply><apply id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.2">𝑠</ci><apply id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3"><plus id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.1"></plus><ci id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E10Xb.3.2.2.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E10Xb.3.2.2.m1.2.2.2.5.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E10Xb.3.2.2.m1.2.2.2.5.1.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.5">subscript</csymbol><ci id="S3.E10Xb.3.2.2.m1.2.2.2.5.2.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.5.2">𝑃</ci><ci id="S3.E10Xb.3.2.2.m1.2.2.2.5.3.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.5.3">𝐵</ci></apply><apply id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.1">conditional</csymbol><apply id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2.2">𝑠</ci><ci id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.2.3">𝑡</ci></apply><apply id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.2">𝑠</ci><apply id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3"><plus id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.1.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.1"></plus><ci id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.2.cmml" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.2">𝑡</ci><cn id="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.3.cmml" type="integer" xref="S3.E10Xb.3.2.2.m1.2.2.2.2.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10Xb.3.2.2.m1.2c">\displaystyle=e^{\alpha r_{t}}\cdot\mathcal{F}_{R}(s_{t+1})P_{B}\left(s_{t}|s_%
{t+1}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E10Xb.3.2.2.m1.2d">= italic_e start_POSTSUPERSCRIPT italic_α italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ⋅ caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS2.p3.1">The Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.E10" title="In 3.4.2. Integrated Flow Matching ‣ 3.4. Refined Detailed Balance Learning with Reward Integration ‣ 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">10</span></a>) suggests that within the realm of accurate model predictions, an increased action probability in <math alttext="P_{F}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p3.1.m1.1"><semantics id="S3.SS4.SSS2.p3.1.m1.1a"><msub id="S3.SS4.SSS2.p3.1.m1.1.1" xref="S3.SS4.SSS2.p3.1.m1.1.1.cmml"><mi id="S3.SS4.SSS2.p3.1.m1.1.1.2" xref="S3.SS4.SSS2.p3.1.m1.1.1.2.cmml">P</mi><mi id="S3.SS4.SSS2.p3.1.m1.1.1.3" xref="S3.SS4.SSS2.p3.1.m1.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p3.1.m1.1b"><apply id="S3.SS4.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS4.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS4.SSS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p3.1.m1.1.1.2.cmml" xref="S3.SS4.SSS2.p3.1.m1.1.1.2">𝑃</ci><ci id="S3.SS4.SSS2.p3.1.m1.1.1.3.cmml" xref="S3.SS4.SSS2.p3.1.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p3.1.m1.1c">P_{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p3.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math> correlates with either an enhanced immediate reward or a higher potential flow for future retention rewards.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS4.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.3. </span>Integrated Detail Balance Objective</h4>
<div class="ltx_para" id="S3.SS4.SSS3.p1">
<p class="ltx_p" id="S3.SS4.SSS3.p1.6">Following the flow matching in Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.E10" title="In 3.4.2. Integrated Flow Matching ‣ 3.4. Refined Detailed Balance Learning with Reward Integration ‣ 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">10</span></a>), we derive the log-scale detailed balance learning objective as the following:
<span class="ltx_text" id="S3.SS4.SSS3.p1.6.1" style="font-size:90%;"></span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathrm{DB}}=\begin{cases}\left(\log\mathcal{F}_{R}(s_{t})+\log P%
_{F}\left(s_{t+1}|s_{t}\right)-\log\mathcal{F}_{R}(s_{t+1})\right.\\
\quad\left.-\log P_{B}\left(s_{t}|s_{t+1}\right)-\alpha\cdot r_{t}\right)^{2}&amp;%
1\leq t\leq T-1\\
\\
\left(\log\mathcal{F}_{R}(s_{t})-\log\mathcal{R}\right)^{2}&amp;t=T\end{cases}" class="ltx_math_unparsed" display="block" id="S3.E11.m1.5"><semantics id="S3.E11.m1.5a"><mrow id="S3.E11.m1.5.6"><msub id="S3.E11.m1.5.6.2"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.5.6.2.2" mathsize="90%">ℒ</mi><mi id="S3.E11.m1.5.6.2.3" mathsize="90%">DB</mi></msub><mo id="S3.E11.m1.5.6.1" mathsize="90%">=</mo><mrow id="S3.E11.m1.5.5"><mo id="S3.E11.m1.5.5.6">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E11.m1.5.5.5" rowspacing="0pt"><mtr id="S3.E11.m1.5.5.5a"><mtd class="ltx_align_left" columnalign="left" id="S3.E11.m1.5.5.5b"><mrow id="S3.E11.m1.1.1.1.1.1.1"><mo id="S3.E11.m1.1.1.1.1.1.1.1">(</mo><mi id="S3.E11.m1.1.1.1.1.1.1.2" mathsize="90%">log</mi><msub id="S3.E11.m1.1.1.1.1.1.1.3"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.1.1.1.1.1.1.3.2" mathsize="90%">ℱ</mi><mi id="S3.E11.m1.1.1.1.1.1.1.3.3" mathsize="90%">R</mi></msub><mrow id="S3.E11.m1.1.1.1.1.1.1.4"><mo id="S3.E11.m1.1.1.1.1.1.1.4.1" maxsize="90%" minsize="90%">(</mo><msub id="S3.E11.m1.1.1.1.1.1.1.4.2"><mi id="S3.E11.m1.1.1.1.1.1.1.4.2.2" mathsize="90%">s</mi><mi id="S3.E11.m1.1.1.1.1.1.1.4.2.3" mathsize="90%">t</mi></msub><mo id="S3.E11.m1.1.1.1.1.1.1.4.3" maxsize="90%" minsize="90%">)</mo></mrow><mo id="S3.E11.m1.1.1.1.1.1.1.5" mathsize="90%">+</mo><mi id="S3.E11.m1.1.1.1.1.1.1.6" mathsize="90%">log</mi><msub id="S3.E11.m1.1.1.1.1.1.1.7"><mi id="S3.E11.m1.1.1.1.1.1.1.7.2" mathsize="90%">P</mi><mi id="S3.E11.m1.1.1.1.1.1.1.7.3" mathsize="90%">F</mi></msub><mrow id="S3.E11.m1.1.1.1.1.1.1.8"><mo id="S3.E11.m1.1.1.1.1.1.1.8.1">(</mo><msub id="S3.E11.m1.1.1.1.1.1.1.8.2"><mi id="S3.E11.m1.1.1.1.1.1.1.8.2.2" mathsize="90%">s</mi><mrow id="S3.E11.m1.1.1.1.1.1.1.8.2.3"><mi id="S3.E11.m1.1.1.1.1.1.1.8.2.3.2" mathsize="90%">t</mi><mo id="S3.E11.m1.1.1.1.1.1.1.8.2.3.1" mathsize="90%">+</mo><mn id="S3.E11.m1.1.1.1.1.1.1.8.2.3.3" mathsize="90%">1</mn></mrow></msub><mo fence="false" id="S3.E11.m1.1.1.1.1.1.1.8.3" maxsize="90%" minsize="90%" rspace="0.167em">|</mo><msub id="S3.E11.m1.1.1.1.1.1.1.8.4"><mi id="S3.E11.m1.1.1.1.1.1.1.8.4.2" mathsize="90%">s</mi><mi id="S3.E11.m1.1.1.1.1.1.1.8.4.3" mathsize="90%">t</mi></msub><mo id="S3.E11.m1.1.1.1.1.1.1.8.5">)</mo></mrow><mo id="S3.E11.m1.1.1.1.1.1.1.9" mathsize="90%">−</mo><mi id="S3.E11.m1.1.1.1.1.1.1.10" mathsize="90%">log</mi><msub id="S3.E11.m1.1.1.1.1.1.1.11"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.1.1.1.1.1.1.11.2" mathsize="90%">ℱ</mi><mi id="S3.E11.m1.1.1.1.1.1.1.11.3" mathsize="90%">R</mi></msub><mrow id="S3.E11.m1.1.1.1.1.1.1.12"><mo id="S3.E11.m1.1.1.1.1.1.1.12.1" maxsize="90%" minsize="90%">(</mo><msub id="S3.E11.m1.1.1.1.1.1.1.12.2"><mi id="S3.E11.m1.1.1.1.1.1.1.12.2.2" mathsize="90%">s</mi><mrow id="S3.E11.m1.1.1.1.1.1.1.12.2.3"><mi id="S3.E11.m1.1.1.1.1.1.1.12.2.3.2" mathsize="90%">t</mi><mo id="S3.E11.m1.1.1.1.1.1.1.12.2.3.1" mathsize="90%">+</mo><mn id="S3.E11.m1.1.1.1.1.1.1.12.2.3.3" mathsize="90%">1</mn></mrow></msub><mo id="S3.E11.m1.1.1.1.1.1.1.12.3" maxsize="90%" minsize="90%">)</mo></mrow></mrow></mtd><mtd id="S3.E11.m1.5.5.5c"></mtd></mtr><mtr id="S3.E11.m1.5.5.5d"><mtd class="ltx_align_left" columnalign="left" id="S3.E11.m1.5.5.5e"><mrow id="S3.E11.m1.2.2.2.2.1.1"><mo id="S3.E11.m1.2.2.2.2.1.1.1" mathsize="90%">−</mo><mi id="S3.E11.m1.2.2.2.2.1.1.2" mathsize="90%">log</mi><msub id="S3.E11.m1.2.2.2.2.1.1.3"><mi id="S3.E11.m1.2.2.2.2.1.1.3.2" mathsize="90%">P</mi><mi id="S3.E11.m1.2.2.2.2.1.1.3.3" mathsize="90%">B</mi></msub><mrow id="S3.E11.m1.2.2.2.2.1.1.4"><mo id="S3.E11.m1.2.2.2.2.1.1.4.1">(</mo><msub id="S3.E11.m1.2.2.2.2.1.1.4.2"><mi id="S3.E11.m1.2.2.2.2.1.1.4.2.2" mathsize="90%">s</mi><mi id="S3.E11.m1.2.2.2.2.1.1.4.2.3" mathsize="90%">t</mi></msub><mo fence="false" id="S3.E11.m1.2.2.2.2.1.1.4.3" maxsize="90%" minsize="90%" rspace="0.167em">|</mo><msub id="S3.E11.m1.2.2.2.2.1.1.4.4"><mi id="S3.E11.m1.2.2.2.2.1.1.4.4.2" mathsize="90%">s</mi><mrow id="S3.E11.m1.2.2.2.2.1.1.4.4.3"><mi id="S3.E11.m1.2.2.2.2.1.1.4.4.3.2" mathsize="90%">t</mi><mo id="S3.E11.m1.2.2.2.2.1.1.4.4.3.1" mathsize="90%">+</mo><mn id="S3.E11.m1.2.2.2.2.1.1.4.4.3.3" mathsize="90%">1</mn></mrow></msub><mo id="S3.E11.m1.2.2.2.2.1.1.4.5">)</mo></mrow><mo id="S3.E11.m1.2.2.2.2.1.1.5" mathsize="90%">−</mo><mi id="S3.E11.m1.2.2.2.2.1.1.6" mathsize="90%">α</mi><mo id="S3.E11.m1.2.2.2.2.1.1.7" lspace="0.222em" mathsize="90%" rspace="0.222em">⋅</mo><msub id="S3.E11.m1.2.2.2.2.1.1.8"><mi id="S3.E11.m1.2.2.2.2.1.1.8.2" mathsize="90%">r</mi><mi id="S3.E11.m1.2.2.2.2.1.1.8.3" mathsize="90%">t</mi></msub><mo id="S3.E11.m1.2.2.2.2.1.1.9">)</mo><msup id="S3.E11.m1.2.2.2.2.1.1.10"><mi id="S3.E11.m1.2.2.2.2.1.1.10a"></mi><mn id="S3.E11.m1.2.2.2.2.1.1.10.1" mathsize="90%">2</mn></msup></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E11.m1.5.5.5f"><mrow id="S3.E11.m1.3.3.3.3.2.1"><mn id="S3.E11.m1.3.3.3.3.2.1.2" mathsize="90%">1</mn><mo id="S3.E11.m1.3.3.3.3.2.1.3" mathsize="90%">≤</mo><mi id="S3.E11.m1.3.3.3.3.2.1.4" mathsize="90%">t</mi><mo id="S3.E11.m1.3.3.3.3.2.1.5" mathsize="90%">≤</mo><mrow id="S3.E11.m1.3.3.3.3.2.1.6"><mi id="S3.E11.m1.3.3.3.3.2.1.6.2" mathsize="90%">T</mi><mo id="S3.E11.m1.3.3.3.3.2.1.6.1" mathsize="90%">−</mo><mn id="S3.E11.m1.3.3.3.3.2.1.6.3" mathsize="90%">1</mn></mrow></mrow></mtd></mtr><mtr id="S3.E11.m1.5.5.5g"><mtd id="S3.E11.m1.5.5.5h"></mtd><mtd id="S3.E11.m1.5.5.5i"></mtd></mtr><mtr id="S3.E11.m1.5.5.5j"><mtd class="ltx_align_left" columnalign="left" id="S3.E11.m1.5.5.5k"><msup id="S3.E11.m1.4.4.4.4.1.1"><mrow id="S3.E11.m1.4.4.4.4.1.1.1.1"><mo id="S3.E11.m1.4.4.4.4.1.1.1.1.2">(</mo><mrow id="S3.E11.m1.4.4.4.4.1.1.1.1.1"><mrow id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1"><mrow id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.3"><mi id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.3.1" mathsize="90%">log</mi><mo id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.3a" lspace="0.167em">⁡</mo><msub id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.3.2"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.3.2.2" mathsize="90%">ℱ</mi><mi id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.3.2.3" mathsize="90%">R</mi></msub></mrow><mo id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.2">⁢</mo><mrow id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.1.1"><mo id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%">(</mo><msub id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.1.1.1"><mi id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.2" mathsize="90%">s</mi><mi id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.3" mathsize="90%">t</mi></msub><mo id="S3.E11.m1.4.4.4.4.1.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%">)</mo></mrow></mrow><mo id="S3.E11.m1.4.4.4.4.1.1.1.1.1.2" mathsize="90%">−</mo><mrow id="S3.E11.m1.4.4.4.4.1.1.1.1.1.3"><mi id="S3.E11.m1.4.4.4.4.1.1.1.1.1.3.1" mathsize="90%">log</mi><mo id="S3.E11.m1.4.4.4.4.1.1.1.1.1.3a" lspace="0.167em">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.4.4.4.4.1.1.1.1.1.3.2" mathsize="90%">ℛ</mi></mrow></mrow><mo id="S3.E11.m1.4.4.4.4.1.1.1.1.3">)</mo></mrow><mn id="S3.E11.m1.4.4.4.4.1.1.3" mathsize="90%">2</mn></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E11.m1.5.5.5l"><mrow id="S3.E11.m1.5.5.5.5.2.1"><mi id="S3.E11.m1.5.5.5.5.2.1.2" mathsize="90%">t</mi><mo id="S3.E11.m1.5.5.5.5.2.1.1" mathsize="90%">=</mo><mi id="S3.E11.m1.5.5.5.5.2.1.3" mathsize="90%">T</mi></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="S3.E11.m1.5b">\mathcal{L}_{\mathrm{DB}}=\begin{cases}\left(\log\mathcal{F}_{R}(s_{t})+\log P%
_{F}\left(s_{t+1}|s_{t}\right)-\log\mathcal{F}_{R}(s_{t+1})\right.\\
\quad\left.-\log P_{B}\left(s_{t}|s_{t+1}\right)-\alpha\cdot r_{t}\right)^{2}&amp;%
1\leq t\leq T-1\\
\\
\left(\log\mathcal{F}_{R}(s_{t})-\log\mathcal{R}\right)^{2}&amp;t=T\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.5c">caligraphic_L start_POSTSUBSCRIPT roman_DB end_POSTSUBSCRIPT = { start_ROW start_CELL ( roman_log caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + roman_log italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - roman_log caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) end_CELL start_CELL end_CELL end_ROW start_ROW start_CELL - roman_log italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) - italic_α ⋅ italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_CELL start_CELL 1 ≤ italic_t ≤ italic_T - 1 end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL end_CELL end_ROW start_ROW start_CELL ( roman_log caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - roman_log caligraphic_R ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_CELL start_CELL italic_t = italic_T end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS3.p1.5">where each step’s immediate reward <math alttext="r_{t}" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p1.1.m1.1"><semantics id="S3.SS4.SSS3.p1.1.m1.1a"><msub id="S3.SS4.SSS3.p1.1.m1.1.1" xref="S3.SS4.SSS3.p1.1.m1.1.1.cmml"><mi id="S3.SS4.SSS3.p1.1.m1.1.1.2" xref="S3.SS4.SSS3.p1.1.m1.1.1.2.cmml">r</mi><mi id="S3.SS4.SSS3.p1.1.m1.1.1.3" xref="S3.SS4.SSS3.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p1.1.m1.1b"><apply id="S3.SS4.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS4.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS4.SSS3.p1.1.m1.1.1.2">𝑟</ci><ci id="S3.SS4.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS4.SSS3.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p1.1.m1.1c">r_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p1.1.m1.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> appears and only appears in the corresponding step-wise DB loss, and the terminal state at <math alttext="t=T" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p1.2.m2.1"><semantics id="S3.SS4.SSS3.p1.2.m2.1a"><mrow id="S3.SS4.SSS3.p1.2.m2.1.1" xref="S3.SS4.SSS3.p1.2.m2.1.1.cmml"><mi id="S3.SS4.SSS3.p1.2.m2.1.1.2" xref="S3.SS4.SSS3.p1.2.m2.1.1.2.cmml">t</mi><mo id="S3.SS4.SSS3.p1.2.m2.1.1.1" xref="S3.SS4.SSS3.p1.2.m2.1.1.1.cmml">=</mo><mi id="S3.SS4.SSS3.p1.2.m2.1.1.3" xref="S3.SS4.SSS3.p1.2.m2.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p1.2.m2.1b"><apply id="S3.SS4.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS3.p1.2.m2.1.1"><eq id="S3.SS4.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS4.SSS3.p1.2.m2.1.1.1"></eq><ci id="S3.SS4.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS4.SSS3.p1.2.m2.1.1.2">𝑡</ci><ci id="S3.SS4.SSS3.p1.2.m2.1.1.3.cmml" xref="S3.SS4.SSS3.p1.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p1.2.m2.1c">t=T</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p1.2.m2.1d">italic_t = italic_T</annotation></semantics></math> does not observe an immediate reward and only matches the retention flow. This learning objective is further illustrated in Part (c) of Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S2.F1" title="Figure 1 ‣ 2. Preliminaries ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">1</span></a>.
Systematically, our design of flow <math alttext="\mathcal{F}_{I}" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p1.3.m3.1"><semantics id="S3.SS4.SSS3.p1.3.m3.1a"><msub id="S3.SS4.SSS3.p1.3.m3.1.1" xref="S3.SS4.SSS3.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS3.p1.3.m3.1.1.2" xref="S3.SS4.SSS3.p1.3.m3.1.1.2.cmml">ℱ</mi><mi id="S3.SS4.SSS3.p1.3.m3.1.1.3" xref="S3.SS4.SSS3.p1.3.m3.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p1.3.m3.1b"><apply id="S3.SS4.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.3.m3.1.1.1.cmml" xref="S3.SS4.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.SSS3.p1.3.m3.1.1.2.cmml" xref="S3.SS4.SSS3.p1.3.m3.1.1.2">ℱ</ci><ci id="S3.SS4.SSS3.p1.3.m3.1.1.3.cmml" xref="S3.SS4.SSS3.p1.3.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p1.3.m3.1c">\mathcal{F}_{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p1.3.m3.1d">caligraphic_F start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> for immediate rewards is non-parametric and can naturally integrate into the DB objective with a simple extra term.
In contrast, the retention reward requires the learning of <math alttext="\mathcal{F}_{R}" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p1.4.m4.1"><semantics id="S3.SS4.SSS3.p1.4.m4.1a"><msub id="S3.SS4.SSS3.p1.4.m4.1.1" xref="S3.SS4.SSS3.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS3.p1.4.m4.1.1.2" xref="S3.SS4.SSS3.p1.4.m4.1.1.2.cmml">ℱ</mi><mi id="S3.SS4.SSS3.p1.4.m4.1.1.3" xref="S3.SS4.SSS3.p1.4.m4.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p1.4.m4.1b"><apply id="S3.SS4.SSS3.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.4.m4.1.1.1.cmml" xref="S3.SS4.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.SSS3.p1.4.m4.1.1.2.cmml" xref="S3.SS4.SSS3.p1.4.m4.1.1.2">ℱ</ci><ci id="S3.SS4.SSS3.p1.4.m4.1.1.3.cmml" xref="S3.SS4.SSS3.p1.4.m4.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p1.4.m4.1c">\mathcal{F}_{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p1.4.m4.1d">caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT</annotation></semantics></math> and the flow back-propagation with flow matching implicitly achieves the ‘retention attribution’.
The overall learning framework optimizes towards the integrated goal of <math alttext="P(\mathbf{S})\propto\mathcal{F}(s_{T})=\mathcal{F}_{R}(s_{T})(\mathcal{F}_{I}(%
s_{T}))^{\alpha}" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p1.5.m5.4"><semantics id="S3.SS4.SSS3.p1.5.m5.4a"><mrow id="S3.SS4.SSS3.p1.5.m5.4.4" xref="S3.SS4.SSS3.p1.5.m5.4.4.cmml"><mrow id="S3.SS4.SSS3.p1.5.m5.4.4.5" xref="S3.SS4.SSS3.p1.5.m5.4.4.5.cmml"><mi id="S3.SS4.SSS3.p1.5.m5.4.4.5.2" xref="S3.SS4.SSS3.p1.5.m5.4.4.5.2.cmml">P</mi><mo id="S3.SS4.SSS3.p1.5.m5.4.4.5.1" xref="S3.SS4.SSS3.p1.5.m5.4.4.5.1.cmml">⁢</mo><mrow id="S3.SS4.SSS3.p1.5.m5.4.4.5.3.2" xref="S3.SS4.SSS3.p1.5.m5.4.4.5.cmml"><mo id="S3.SS4.SSS3.p1.5.m5.4.4.5.3.2.1" stretchy="false" xref="S3.SS4.SSS3.p1.5.m5.4.4.5.cmml">(</mo><mi id="S3.SS4.SSS3.p1.5.m5.1.1" xref="S3.SS4.SSS3.p1.5.m5.1.1.cmml">𝐒</mi><mo id="S3.SS4.SSS3.p1.5.m5.4.4.5.3.2.2" stretchy="false" xref="S3.SS4.SSS3.p1.5.m5.4.4.5.cmml">)</mo></mrow></mrow><mo id="S3.SS4.SSS3.p1.5.m5.4.4.6" xref="S3.SS4.SSS3.p1.5.m5.4.4.6.cmml">∝</mo><mrow id="S3.SS4.SSS3.p1.5.m5.2.2.1" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS3.p1.5.m5.2.2.1.3" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.3.cmml">ℱ</mi><mo id="S3.SS4.SSS3.p1.5.m5.2.2.1.2" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.cmml"><mo id="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.2" stretchy="false" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.cmml"><mi id="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.2" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.2.cmml">s</mi><mi id="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.3" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.3.cmml">T</mi></msub><mo id="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.3" stretchy="false" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.SSS3.p1.5.m5.4.4.7" xref="S3.SS4.SSS3.p1.5.m5.4.4.7.cmml">=</mo><mrow id="S3.SS4.SSS3.p1.5.m5.4.4.3" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.cmml"><msub id="S3.SS4.SSS3.p1.5.m5.4.4.3.4" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS3.p1.5.m5.4.4.3.4.2" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.4.2.cmml">ℱ</mi><mi id="S3.SS4.SSS3.p1.5.m5.4.4.3.4.3" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.4.3.cmml">R</mi></msub><mo id="S3.SS4.SSS3.p1.5.m5.4.4.3.3" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.3.cmml">⁢</mo><mrow id="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1" xref="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.cmml"><mo id="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.2" stretchy="false" xref="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1" xref="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.cmml"><mi id="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.2" xref="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.2.cmml">s</mi><mi id="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.3" xref="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.3.cmml">T</mi></msub><mo id="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.3" stretchy="false" xref="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.cmml">)</mo></mrow><mo id="S3.SS4.SSS3.p1.5.m5.4.4.3.3a" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.3.cmml">⁢</mo><msup id="S3.SS4.SSS3.p1.5.m5.4.4.3.2" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.cmml"><mrow id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.cmml"><mo id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.2" stretchy="false" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.cmml">(</mo><mrow id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.cmml"><msub id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3.2" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3.3" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3.3.cmml">I</mi></msub><mo id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.2" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.2" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.3" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.3.cmml">T</mi></msub><mo id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.3" stretchy="false" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.cmml">)</mo></mrow><mi id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.3" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.3.cmml">α</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p1.5.m5.4b"><apply id="S3.SS4.SSS3.p1.5.m5.4.4.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4"><and id="S3.SS4.SSS3.p1.5.m5.4.4a.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4"></and><apply id="S3.SS4.SSS3.p1.5.m5.4.4b.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4"><csymbol cd="latexml" id="S3.SS4.SSS3.p1.5.m5.4.4.6.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.6">proportional-to</csymbol><apply id="S3.SS4.SSS3.p1.5.m5.4.4.5.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.5"><times id="S3.SS4.SSS3.p1.5.m5.4.4.5.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.5.1"></times><ci id="S3.SS4.SSS3.p1.5.m5.4.4.5.2.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.5.2">𝑃</ci><ci id="S3.SS4.SSS3.p1.5.m5.1.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.1.1">𝐒</ci></apply><apply id="S3.SS4.SSS3.p1.5.m5.2.2.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.2.2.1"><times id="S3.SS4.SSS3.p1.5.m5.2.2.1.2.cmml" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.2"></times><ci id="S3.SS4.SSS3.p1.5.m5.2.2.1.3.cmml" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.3">ℱ</ci><apply id="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.2.cmml" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.2">𝑠</ci><ci id="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.3.cmml" xref="S3.SS4.SSS3.p1.5.m5.2.2.1.1.1.1.3">𝑇</ci></apply></apply></apply><apply id="S3.SS4.SSS3.p1.5.m5.4.4c.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4"><eq id="S3.SS4.SSS3.p1.5.m5.4.4.7.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.7"></eq><share href="https://arxiv.org/html/2406.06043v1#S3.SS4.SSS3.p1.5.m5.2.2.1.cmml" id="S3.SS4.SSS3.p1.5.m5.4.4d.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4"></share><apply id="S3.SS4.SSS3.p1.5.m5.4.4.3.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3"><times id="S3.SS4.SSS3.p1.5.m5.4.4.3.3.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.3"></times><apply id="S3.SS4.SSS3.p1.5.m5.4.4.3.4.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.4"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.5.m5.4.4.3.4.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.4">subscript</csymbol><ci id="S3.SS4.SSS3.p1.5.m5.4.4.3.4.2.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.4.2">ℱ</ci><ci id="S3.SS4.SSS3.p1.5.m5.4.4.3.4.3.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.4.3">𝑅</ci></apply><apply id="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1">subscript</csymbol><ci id="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.2.cmml" xref="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.2">𝑠</ci><ci id="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.3.cmml" xref="S3.SS4.SSS3.p1.5.m5.3.3.2.1.1.1.3">𝑇</ci></apply><apply id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.2.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2">superscript</csymbol><apply id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1"><times id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.2.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.2"></times><apply id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3.2.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3.2">ℱ</ci><ci id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3.3.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.3.3">𝐼</ci></apply><apply id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.1.1.1.1.1.1.3">𝑇</ci></apply></apply><ci id="S3.SS4.SSS3.p1.5.m5.4.4.3.2.3.cmml" xref="S3.SS4.SSS3.p1.5.m5.4.4.3.2.3">𝛼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p1.5.m5.4c">P(\mathbf{S})\propto\mathcal{F}(s_{T})=\mathcal{F}_{R}(s_{T})(\mathcal{F}_{I}(%
s_{T}))^{\alpha}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p1.5.m5.4d">italic_P ( bold_S ) ∝ caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) = caligraphic_F start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) ( caligraphic_F start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT italic_α end_POSTSUPERSCRIPT</annotation></semantics></math>.
In general, we regard retention and immediate rewards as two complementary aspects of the user’s impression of the recommendation policy. In our solution, immediate rewards provide direct guidance in each step, while the retention flow guides the policy with step-wise attribution.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS3.p2">
<p class="ltx_p" id="S3.SS4.SSS3.p2.5">Besides, the values of forward probability <math alttext="P_{F}(\cdot)" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p2.1.m1.1"><semantics id="S3.SS4.SSS3.p2.1.m1.1a"><mrow id="S3.SS4.SSS3.p2.1.m1.1.2" xref="S3.SS4.SSS3.p2.1.m1.1.2.cmml"><msub id="S3.SS4.SSS3.p2.1.m1.1.2.2" xref="S3.SS4.SSS3.p2.1.m1.1.2.2.cmml"><mi id="S3.SS4.SSS3.p2.1.m1.1.2.2.2" xref="S3.SS4.SSS3.p2.1.m1.1.2.2.2.cmml">P</mi><mi id="S3.SS4.SSS3.p2.1.m1.1.2.2.3" xref="S3.SS4.SSS3.p2.1.m1.1.2.2.3.cmml">F</mi></msub><mo id="S3.SS4.SSS3.p2.1.m1.1.2.1" xref="S3.SS4.SSS3.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS4.SSS3.p2.1.m1.1.2.3.2" xref="S3.SS4.SSS3.p2.1.m1.1.2.cmml"><mo id="S3.SS4.SSS3.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS4.SSS3.p2.1.m1.1.2.cmml">(</mo><mo id="S3.SS4.SSS3.p2.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS4.SSS3.p2.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS4.SSS3.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS4.SSS3.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p2.1.m1.1b"><apply id="S3.SS4.SSS3.p2.1.m1.1.2.cmml" xref="S3.SS4.SSS3.p2.1.m1.1.2"><times id="S3.SS4.SSS3.p2.1.m1.1.2.1.cmml" xref="S3.SS4.SSS3.p2.1.m1.1.2.1"></times><apply id="S3.SS4.SSS3.p2.1.m1.1.2.2.cmml" xref="S3.SS4.SSS3.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p2.1.m1.1.2.2.1.cmml" xref="S3.SS4.SSS3.p2.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS4.SSS3.p2.1.m1.1.2.2.2.cmml" xref="S3.SS4.SSS3.p2.1.m1.1.2.2.2">𝑃</ci><ci id="S3.SS4.SSS3.p2.1.m1.1.2.2.3.cmml" xref="S3.SS4.SSS3.p2.1.m1.1.2.2.3">𝐹</ci></apply><ci id="S3.SS4.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS4.SSS3.p2.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p2.1.m1.1c">P_{F}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p2.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> may approach zero deviating significantly from the valid region of the flow estimator in the log scale.
This discrepancy can introduce high variance that may influence the stability of the gradient computation.
Therefore we include a bias <math alttext="\beta_{F}" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p2.2.m2.1"><semantics id="S3.SS4.SSS3.p2.2.m2.1a"><msub id="S3.SS4.SSS3.p2.2.m2.1.1" xref="S3.SS4.SSS3.p2.2.m2.1.1.cmml"><mi id="S3.SS4.SSS3.p2.2.m2.1.1.2" xref="S3.SS4.SSS3.p2.2.m2.1.1.2.cmml">β</mi><mi id="S3.SS4.SSS3.p2.2.m2.1.1.3" xref="S3.SS4.SSS3.p2.2.m2.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p2.2.m2.1b"><apply id="S3.SS4.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS4.SSS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p2.2.m2.1.1.1.cmml" xref="S3.SS4.SSS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS3.p2.2.m2.1.1.2.cmml" xref="S3.SS4.SSS3.p2.2.m2.1.1.2">𝛽</ci><ci id="S3.SS4.SSS3.p2.2.m2.1.1.3.cmml" xref="S3.SS4.SSS3.p2.2.m2.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p2.2.m2.1c">\beta_{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p2.2.m2.1d">italic_β start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math> as the hyperparameter and the corresponding log scale estimation becomes <math alttext="\log(P_{F}(\cdot)+\beta_{f})" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p2.3.m3.3"><semantics id="S3.SS4.SSS3.p2.3.m3.3a"><mrow id="S3.SS4.SSS3.p2.3.m3.3.3.1" xref="S3.SS4.SSS3.p2.3.m3.3.3.2.cmml"><mi id="S3.SS4.SSS3.p2.3.m3.2.2" xref="S3.SS4.SSS3.p2.3.m3.2.2.cmml">log</mi><mo id="S3.SS4.SSS3.p2.3.m3.3.3.1a" xref="S3.SS4.SSS3.p2.3.m3.3.3.2.cmml">⁡</mo><mrow id="S3.SS4.SSS3.p2.3.m3.3.3.1.1" xref="S3.SS4.SSS3.p2.3.m3.3.3.2.cmml"><mo id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.2" stretchy="false" xref="S3.SS4.SSS3.p2.3.m3.3.3.2.cmml">(</mo><mrow id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.cmml"><mrow id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.cmml"><msub id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2.cmml"><mi id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2.2" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2.2.cmml">P</mi><mi id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2.3" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2.3.cmml">F</mi></msub><mo id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.1" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.3.2" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.cmml"><mo id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.3.2.1" stretchy="false" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.cmml">(</mo><mo id="S3.SS4.SSS3.p2.3.m3.1.1" lspace="0em" rspace="0em" xref="S3.SS4.SSS3.p2.3.m3.1.1.cmml">⋅</mo><mo id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.3.2.2" stretchy="false" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.1" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.1.cmml">+</mo><msub id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3.cmml"><mi id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3.2" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3.2.cmml">β</mi><mi id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3.3" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3.3.cmml">f</mi></msub></mrow><mo id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.3" stretchy="false" xref="S3.SS4.SSS3.p2.3.m3.3.3.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p2.3.m3.3b"><apply id="S3.SS4.SSS3.p2.3.m3.3.3.2.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1"><log id="S3.SS4.SSS3.p2.3.m3.2.2.cmml" xref="S3.SS4.SSS3.p2.3.m3.2.2"></log><apply id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1"><plus id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.1"></plus><apply id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2"><times id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.1.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.1"></times><apply id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2.1.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2">subscript</csymbol><ci id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2.2">𝑃</ci><ci id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2.3.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.2.2.3">𝐹</ci></apply><ci id="S3.SS4.SSS3.p2.3.m3.1.1.cmml" xref="S3.SS4.SSS3.p2.3.m3.1.1">⋅</ci></apply><apply id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3.1.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3.2.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3.2">𝛽</ci><ci id="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3.3.cmml" xref="S3.SS4.SSS3.p2.3.m3.3.3.1.1.1.3.3">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p2.3.m3.3c">\log(P_{F}(\cdot)+\beta_{f})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p2.3.m3.3d">roman_log ( italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( ⋅ ) + italic_β start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT )</annotation></semantics></math>.
Similarly, we also include <math alttext="\beta_{B}" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p2.4.m4.1"><semantics id="S3.SS4.SSS3.p2.4.m4.1a"><msub id="S3.SS4.SSS3.p2.4.m4.1.1" xref="S3.SS4.SSS3.p2.4.m4.1.1.cmml"><mi id="S3.SS4.SSS3.p2.4.m4.1.1.2" xref="S3.SS4.SSS3.p2.4.m4.1.1.2.cmml">β</mi><mi id="S3.SS4.SSS3.p2.4.m4.1.1.3" xref="S3.SS4.SSS3.p2.4.m4.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p2.4.m4.1b"><apply id="S3.SS4.SSS3.p2.4.m4.1.1.cmml" xref="S3.SS4.SSS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p2.4.m4.1.1.1.cmml" xref="S3.SS4.SSS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.SSS3.p2.4.m4.1.1.2.cmml" xref="S3.SS4.SSS3.p2.4.m4.1.1.2">𝛽</ci><ci id="S3.SS4.SSS3.p2.4.m4.1.1.3.cmml" xref="S3.SS4.SSS3.p2.4.m4.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p2.4.m4.1c">\beta_{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p2.4.m4.1d">italic_β start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math> to stabilize the backward function learning and <math alttext="\beta_{r}" class="ltx_Math" display="inline" id="S3.SS4.SSS3.p2.5.m5.1"><semantics id="S3.SS4.SSS3.p2.5.m5.1a"><msub id="S3.SS4.SSS3.p2.5.m5.1.1" xref="S3.SS4.SSS3.p2.5.m5.1.1.cmml"><mi id="S3.SS4.SSS3.p2.5.m5.1.1.2" xref="S3.SS4.SSS3.p2.5.m5.1.1.2.cmml">β</mi><mi id="S3.SS4.SSS3.p2.5.m5.1.1.3" xref="S3.SS4.SSS3.p2.5.m5.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS3.p2.5.m5.1b"><apply id="S3.SS4.SSS3.p2.5.m5.1.1.cmml" xref="S3.SS4.SSS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS3.p2.5.m5.1.1.1.cmml" xref="S3.SS4.SSS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.SSS3.p2.5.m5.1.1.2.cmml" xref="S3.SS4.SSS3.p2.5.m5.1.1.2">𝛽</ci><ci id="S3.SS4.SSS3.p2.5.m5.1.1.3.cmml" xref="S3.SS4.SSS3.p2.5.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS3.p2.5.m5.1c">\beta_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS3.p2.5.m5.1d">italic_β start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> to reduce the reward variance.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiment</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we present a comprehensive performance evaluation of the GFN4Retention framework through experiments on a simulated user environment for two real-world datasets. Additionally, we extend our evaluation to include online A/B testing conducted on a commercial platform to validate GFN4Retention’s effectiveness in a live environment. The implementation details are provided in the Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#A1" title="Appendix A IMPLEMENTATION DETAILS ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Dataset</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We carried out our experiment using two real-world datasets.</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">Kuairand-Pure</span> <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://kuairand.com/</span></span></span> is an unbiased sequential recommendation dataset characterized by random video exposures.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">MovieLens-1M</span> <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://grouplens.org/datasets/movielens/1m/</span></span></span>, a widely-used benchmark for RSs, boasts a more extensive scale but with a sparser distribution.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">The KuaiRand dataset comprises 12 feedback signals, out of which we focus on six positive feedback signals: ‘click’, ‘view time’, ‘like’, ‘comment’, ‘follow’, and ‘forward’. We also consider two negative feedback signals: ‘hate’ and ‘leave’, due to their relevance. Feedback signals that occur less frequently are not included in our study to maintain analytical clarity. Additionally, we extend our analysis to the ML-1m dataset, a widely recognized benchmark in the field of Recommender Systems, which contains ratings from 6,014 users for 3,417 movies. For the ML-1m dataset, we classify movies rated above 3 as positive instances (indicative of a ‘like’) and the others as negative instances (indicative of a ‘hate’), thus enabling a nuanced understanding of user preferences. The statistics of datasets are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.T1" title="Table 1 ‣ 4.1. Dataset ‣ 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1. </span>Datasets Statistics</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.1"><span class="ltx_text" id="S4.T1.3.1.1.1.1" style="font-size:90%;">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.2"><span class="ltx_text" id="S4.T1.3.1.1.2.1" style="font-size:90%;"># Users</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.3"><span class="ltx_text" id="S4.T1.3.1.1.3.1" style="font-size:90%;"># Items</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.4"><span class="ltx_text" id="S4.T1.3.1.1.4.1" style="font-size:90%;"># Interactions</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.5"><span class="ltx_text" id="S4.T1.3.1.1.5.1" style="font-size:90%;"># Density</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.3.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.1.1"><span class="ltx_text" id="S4.T1.3.2.1.1.1" style="font-size:90%;">Kuairand-Pure</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.1.2"><span class="ltx_text" id="S4.T1.3.2.1.2.1" style="font-size:90%;">27,285</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.1.3"><span class="ltx_text" id="S4.T1.3.2.1.3.1" style="font-size:90%;">7,551</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.1.4"><span class="ltx_text" id="S4.T1.3.2.1.4.1" style="font-size:90%;">1,436,609</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.1.5"><span class="ltx_text" id="S4.T1.3.2.1.5.1" style="font-size:90%;">0.70%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.2">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.3.3.2.1"><span class="ltx_text" id="S4.T1.3.3.2.1.1" style="font-size:90%;">MovieLens-1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.3.3.2.2"><span class="ltx_text" id="S4.T1.3.3.2.2.1" style="font-size:90%;">6,400</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.3.3.2.3"><span class="ltx_text" id="S4.T1.3.3.2.3.1" style="font-size:90%;">3,706</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.3.3.2.4"><span class="ltx_text" id="S4.T1.3.3.2.4.1" style="font-size:90%;">1,000,208</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.3.3.2.5"><span class="ltx_text" id="S4.T1.3.3.2.5.1" style="font-size:90%;">4.22%</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Simulated User Environment</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We have chosen the KuaiSim retention simulator <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib57" title="">2023a</a>)</cite> for our study, which is designed to emulate long-term user behavior on short video recommendation platforms. KuaiSim features two key components: a leave module, responsible for predicting the likelihood of a user exiting a session and thereby ending an episode; and a return module, which estimates the daily probability of a user’s return to the platform, expressed as a multinomial distribution.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span>Overall Performance on two datasets for different models.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S4.T2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_tt" id="S4.T2.2.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T2.2.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.2.1.1.2" rowspan="2"><span class="ltx_text" id="S4.T2.2.1.1.2.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="6" id="S4.T2.2.1.1.3">Model</th>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.2.2.2.1">TD3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.2.2.2.2">SAC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.2.2.2.3">DIN</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.2.2.2.4">CEM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.2.2.2.5">RLUR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T2.2.2.2.6">GFN4Retention</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.2.3.1.1" rowspan="4"><span class="ltx_text" id="S4.T2.2.3.1.1.1">Kuairend-Pure</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.3.1.2">Return Time</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.3.1.3">2.382</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.3.1.4">2.373</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.3.1.5">1.947</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.3.1.6">1.889</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.3.1.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.2.3.1.7.1">1.786</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.2.3.1.8"><span class="ltx_text ltx_font_bold" id="S4.T2.2.3.1.8.1">1.496*</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.4.2.1">Retention</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.4.2.2">0.151</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.4.2.3">0.150</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.4.2.4">0.154</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.4.2.5">0.156</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.4.2.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.2.4.2.6.1">0.159</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.2.4.2.7"><span class="ltx_text ltx_font_bold" id="S4.T2.2.4.2.7.1">0.163*</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.5.3.1">Click Rate</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.5.3.2">0.800</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.5.3.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.2.5.3.3.1">0.801</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.5.3.4">0.773</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.5.3.5">0.762</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.5.3.6">0.789</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.2.5.3.7"><span class="ltx_text ltx_font_bold" id="S4.T2.2.5.3.7.1">0.805</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.6.4.1">Long View Rate</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.2">0.791</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.3"><span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S4.T2.2.6.4.3.1">0.795</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.4">0.764</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.5">0.757</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.6">0.778</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.2.6.4.7">0.794</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.7.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T2.2.7.5.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.7.5.2">Like Rate</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.7.5.3">0.852</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.7.5.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.2.7.5.4.1">0.857</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.7.5.5">0.812</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.7.5.6">0.804</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.7.5.7">0.831</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.2.7.5.8"><span class="ltx_text ltx_font_bold" id="S4.T2.2.7.5.8.1">0.862</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.2.8.6.1" rowspan="4"><span class="ltx_text" id="S4.T2.2.8.6.1.1">ML-1M</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.8.6.2">Return Time</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.8.6.3">2.258</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.8.6.4">2.246</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.8.6.5">1.893</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.8.6.6">1.814</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.8.6.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.2.8.6.7.1">1.723</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.2.8.6.8"><span class="ltx_text ltx_font_bold" id="S4.T2.2.8.6.8.1">1.479*</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.9.7.1">Retention</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.9.7.2">0.141</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.9.7.3">0.142</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.9.7.4">0.153</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.9.7.5">0.158</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.9.7.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.2.9.7.6.1">0.160</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.2.9.7.7"><span class="ltx_text ltx_font_bold" id="S4.T2.2.9.7.7.1">0.165*</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.10.8.1">Click Rate</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.10.8.2">0.461</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.10.8.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.2.10.8.3.1">0.468</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.10.8.4">0.454</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.10.8.5">0.448</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.10.8.6">0.459</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.2.10.8.7"><span class="ltx_text ltx_font_bold" id="S4.T2.2.10.8.7.1">0.473</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.11.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.2.11.9.1">Long View Rate</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.11.9.2">0.459</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.11.9.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.2.11.9.3.1">0.463</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.11.9.4">0.455</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.11.9.5">0.453</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.11.9.6">0.457</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.2.11.9.7"><span class="ltx_text ltx_font_bold" id="S4.T2.2.11.9.7.1">0.464</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.12.10">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb ltx_border_l ltx_border_r" id="S4.T2.2.12.10.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T2.2.12.10.2">Like Rate</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.12.10.3">0.568</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.12.10.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.2.12.10.4.1">0.571</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.12.10.5">0.541</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.12.10.6">0.524</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.12.10.7">0.561</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.2.12.10.8"><span class="ltx_text ltx_font_bold" id="S4.T2.2.12.10.8.1">0.574</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.T2.1">“<span class="ltx_text ltx_font_bold" id="S4.T2.1.1" style="font-size:144%;">*</span>”: the statistically significant improvements (<em class="ltx_emph ltx_font_italic" id="S4.T2.1.2">i.e.,</em> two-sided t-test with <math alttext="p&lt;0.05" class="ltx_Math" display="inline" id="S4.T2.1.m1.1"><semantics id="S4.T2.1.m1.1a"><mrow id="S4.T2.1.m1.1.1" xref="S4.T2.1.m1.1.1.cmml"><mi id="S4.T2.1.m1.1.1.2" xref="S4.T2.1.m1.1.1.2.cmml">p</mi><mo id="S4.T2.1.m1.1.1.1" xref="S4.T2.1.m1.1.1.1.cmml">&lt;</mo><mn id="S4.T2.1.m1.1.1.3" xref="S4.T2.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.m1.1b"><apply id="S4.T2.1.m1.1.1.cmml" xref="S4.T2.1.m1.1.1"><lt id="S4.T2.1.m1.1.1.1.cmml" xref="S4.T2.1.m1.1.1.1"></lt><ci id="S4.T2.1.m1.1.1.2.cmml" xref="S4.T2.1.m1.1.1.2">𝑝</ci><cn id="S4.T2.1.m1.1.1.3.cmml" type="float" xref="S4.T2.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.m1.1c">p&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.m1.1d">italic_p &lt; 0.05</annotation></semantics></math>) over the best baseline.

<br class="ltx_break"/><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.3">Underline</span>: the best baseline model. <span class="ltx_text ltx_font_bold" id="S4.T2.1.4">Bold</span>: the best performance among all models.</p>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Baselines</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Our model is benchmarked against a diverse array of baselines, including several classic reinforcement learning methods and models specially designed for retention optimization:</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">CEM</span> <cite class="ltx_cite ltx_citemacro_citep">(Deng, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib20" title="">2006</a>)</cite>: Often employed as a surrogate in recommendation tasks, this method is known for its effectiveness and simplicity in various RL scenarios.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">DIN</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib64" title="">2018</a>)</cite>: This network uniquely features a local activation unit, enabling dynamic learning of user interest representations from historical behaviors.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i3.p1.1.1">TD3</span> <cite class="ltx_cite ltx_citemacro_citep">(Fujimoto et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib23" title="">2018</a>)</cite>: Building on the foundation of DDPG, TD3 enhances performance through techniques like clipped double-Q learning, delayed policy updates, and target policy smoothing.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i4.p1">
<p class="ltx_p" id="S4.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i4.p1.1.1">SAC</span> <cite class="ltx_cite ltx_citemacro_citep">(Haarnoja et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib25" title="">2018</a>)</cite>: An advanced off-policy RL algorithm adopts strategies including clipped double-Q learning for improved stability.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i5.p1">
<p class="ltx_p" id="S4.I2.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i5.p1.1.1">RLUR</span> <cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib7" title="">2023a</a>)</cite>: Specifically designed for enhancing long-term user engagement, this RL-based algorithm focuses on strategies that cater to sustained user interactions.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Evaluation Metrics</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">We assess the efficacy of GFN4Retention using metrics that focus on both immediate user interactions and long-term retention:</p>
<ul class="ltx_itemize" id="S4.I3">
<li class="ltx_item" id="S4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i1.p1">
<p class="ltx_p" id="S4.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i1.p1.1.1">Return Time:</span> Measuring the average duration between consecutive sessions, serving as a direct indicator of user retention.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i2.p1">
<p class="ltx_p" id="S4.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i2.p1.1.1">Retention:</span> Capturing the average value of user retention reward as defined in Subsection <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S2.SS2" title="2.2. Problem Definition ‣ 2. Preliminaries ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">2.2</span></a>, reflecting long-term engagement.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i3.p1">
<p class="ltx_p" id="S4.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i3.p1.1.1">Click Rate:</span> Calculating the rate of clicks per session, indicating immediate user engagement with the content.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i4.p1">
<p class="ltx_p" id="S4.I3.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i4.p1.1.1">Long View Rate:</span> Determining the likelihood of a session’s view time exceeding 50%, showcasing deeper content engagement.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i5.p1">
<p class="ltx_p" id="S4.I3.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i5.p1.1.1">Like Rate:</span> Assessing the rates of likes per session, further indicating user preference and satisfaction.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS4.p1.2">For a robust evaluation, we derive our final results by averaging the outcomes of the last 1000 episodes during the training phase.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Overall Performance</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">To assess the effectiveness of our proposed GFN4Retention model, we conducted a comparative analysis of its overall performance against five baseline models on two datasets. The results are detailed in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.T2" title="Table 2 ‣ 4.2. Simulated User Environment ‣ 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">2</span></a>. Additionally, we present the training curves of GFN4Retention alongside selected baselines focusing on the return day metric in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.F4" title="Figure 4 ‣ 4.5. Overall Performance ‣ 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">4</span></a>. From these observations, we note that:</p>
<ul class="ltx_itemize" id="S4.I4">
<li class="ltx_item" id="S4.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i1.p1">
<p class="ltx_p" id="S4.I4.i1.p1.1">The TD3 model registers the weakest performance in terms of retention metrics. It exhibits higher ‘return time’ across both datasets, suggesting increased intervals between user sessions and, hence, lower retention rates. This model does not excel in any metric, likely due to its inadequate adaptation to shifts in the environment distribution and a policy weakly linked to specific user behavior patterns, resulting in suboptimal performance.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i2.p1">
<p class="ltx_p" id="S4.I4.i2.p1.1">Among all the baseline models, the RLUR model stands out in retention metrics and shows commendable results in optimizing immediate user feedback. This algorithm’s design, which acknowledges the inherent biases of sequential recommendation tasks, adeptly captures user retention dynamics. Despite its strengths, the RLUR suffers from training volatility and requires more iterations to reach convergence.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i3.p1">
<p class="ltx_p" id="S4.I4.i3.p1.1">The SAC model emerges as the most proficient baseline in optimizing immediate user feedback. It boasts competitive performance across all metrics and leads in Long View Rate for the Kuairend-Pure dataset. Its approach to balancing expected returns with policy entropy enables effective modeling of user engagement.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i4.p1">
<p class="ltx_p" id="S4.I4.i4.p1.1">Our GFN4Retention model surpasses all other models, including the best baseline models, on several crucial metrics. It achieves the lowest ‘return time’, indicating more frequent user engagement, and secures the highest scores in Retention and Like Rate, with statistically significant improvements. By integrating immediate feedback with the final retention signal in a meticulously structured manner, GFN4Retention boosts user retention while preserving the quality of immediate user feedback. The model’s consistency and robustness are further evidenced by the most stable training curves among all baselines.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1">In summary, the GFN4Retention model demonstrates superior performance by effectively balancing immediate engagement with user retention, as indicated by its leading scores in critical metrics and significant improvements over the baseline models.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="406" id="S4.F4.g1" src="x4.png" width="813"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Training Curve for Return Day Metric.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6. </span>Ablation Study</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">To rigorously assess the contribution of individual modules within our proposed GFN4Retention model, we conducted an ablation study focusing on the context-detection module and the reward design. This study involves evaluating variations of the full model with the omission of particular settings to quantify their respective impacts. We describe the variant models as follows:</p>
</div>
<div class="ltx_para" id="S4.SS6.p2">
<ul class="ltx_itemize" id="S4.I5">
<li class="ltx_item" id="S4.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i1.p1">
<p class="ltx_p" id="S4.I5.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I5.i1.p1.1.1">NCD (No Context Detection):</span> This model functions without the context-detection module, yet retains all other components, providing insight into the significance of context awareness in the user state encoder.</p>
</div>
</li>
<li class="ltx_item" id="S4.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i2.p1">
<p class="ltx_p" id="S4.I5.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I5.i2.p1.1.1">NIF (No Immediate Feedback):</span> In this variation, the reward structure is simplified to include only the retention reward, thereby isolating the effect of immediate feedback signals.</p>
</div>
</li>
<li class="ltx_item" id="S4.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i3.p1">
<p class="ltx_p" id="S4.I5.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I5.i3.p1.1.1">SIF (Simplified Immediate Feedback):</span> Here, we utilize a simplified immediate feedback reward approach, wherein session-wise accumulated rewards are considered solely at the terminal state, revealing the value of step-by-step reward accumulation.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS6.p3">
<p class="ltx_p" id="S4.SS6.p3.1">The results of the ablation study on the GFN4Retention model, employing the Kuairand-Pure dataset, are depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.F5" title="Figure 5 ‣ 4.6. Ablation Study ‣ 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">5</span></a>. This investigation yields several critical insights:</p>
</div>
<div class="ltx_para" id="S4.SS6.p4">
<ul class="ltx_itemize" id="S4.I6">
<li class="ltx_item" id="S4.I6.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I6.i1.p1">
<p class="ltx_p" id="S4.I6.i1.p1.1">The NCD variant demonstrates commendable performance in immediate feedback metrics such as ‘click rate’ and ‘like rate’. However, it exhibits an approximate 6.7% increase in ‘return time’ relative to the comprehensive GFN4Retention model. This outcome can be principally ascribed to the absence of the context-detection module, which is pivotal in adaptively discerning user preferences that are integral to retention. These findings emphatically highlight the significance of the context-detection module within the model’s architecture.</p>
</div>
</li>
<li class="ltx_item" id="S4.I6.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I6.i2.p1">
<p class="ltx_p" id="S4.I6.i2.p1.1">In contrast to the complete GFN4Retention model, the NIF variant shows a marked 45% reduction in ‘click rate’ and a 5% reduction in ‘like rate’. The lack of immediate feedback signals during the modeling process likely precipitates this decline. Additionally, there is a 4.7% increase in ‘return time’ compared to the GFN4Retention model, suggesting that only focusing on retention rewards is insufficient for capturing user preferences.</p>
</div>
</li>
<li class="ltx_item" id="S4.I6.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I6.i3.p1">
<p class="ltx_p" id="S4.I6.i3.p1.1">The SIF variant, which incorporates immediate feedback signals into the terminal session reward, outperforms the NIF variant, registering gains in both short-term engagement metrics and user retention. This enhancement underscores the criticality of maintaining an equilibrium between immediate and sustained user engagement.</p>
</div>
</li>
<li class="ltx_item" id="S4.I6.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I6.i4.p1">
<p class="ltx_p" id="S4.I6.i4.p1.1">The SIF variant exhibits a 40% decrease in ‘click rate’ and a 4% decrease in ‘like rate’, along with a 4% increase in ‘return time’, compared to the GFN4Retention model. These comparative metrics clearly demonstrate that our innovative reward structure, coupled with a refined detailed balance objective, significantly bolsters the model’s proficiency in enhancing both immediate feedback and long-term user retention.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="270" id="S4.F5.1.g1" src="x5.png" width="270"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="270" id="S4.F5.2.g1" src="x6.png" width="270"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F5.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="270" id="S4.F5.3.g1" src="x7.png" width="270"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>Ablation Study Results.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7. </span>Parameter Analysis</h3>
<div class="ltx_para" id="S4.SS7.p1">
<p class="ltx_p" id="S4.SS7.p1.2">To calibrate the significance of immediate user rewards within our model, we introduce the parameter <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS7.p1.1.m1.1"><semantics id="S4.SS7.p1.1.m1.1a"><mi id="S4.SS7.p1.1.m1.1.1" xref="S4.SS7.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.1.m1.1b"><ci id="S4.SS7.p1.1.m1.1.1.cmml" xref="S4.SS7.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.1.m1.1d">italic_α</annotation></semantics></math> as part of the session-wise reward formulation, as delineated in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S3.E6" title="In 3.4.1. Reward Design: ‣ 3.4. Refined Detailed Balance Learning with Reward Integration ‣ 3. THE PROPOSED Framework ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">6</span></a>). This subsection is devoted to analyzing the impact of this balance parameter on model performance, particularly how the integration of immediate feedback signals affects outcomes. We assess the model’s performance across a range of <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS7.p1.2.m2.1"><semantics id="S4.SS7.p1.2.m2.1a"><mi id="S4.SS7.p1.2.m2.1.1" xref="S4.SS7.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.2.m2.1b"><ci id="S4.SS7.p1.2.m2.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p1.2.m2.1d">italic_α</annotation></semantics></math> values set at [0.5,0.7,0.9,1.0,1.1,1.3,1.5] with a focus on the ‘return time’ and ‘click rate’ metrics, the results of which are presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.F6" title="Figure 6 ‣ 4.7. Parameter Analysis ‣ 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">6</span></a>. The following patterns emerge from the analysis:</p>
</div>
<div class="ltx_para" id="S4.SS7.p2">
<ul class="ltx_itemize" id="S4.I7">
<li class="ltx_item" id="S4.I7.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I7.i1.p1">
<p class="ltx_p" id="S4.I7.i1.p1.1">When <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.I7.i1.p1.1.m1.1"><semantics id="S4.I7.i1.p1.1.m1.1a"><mi id="S4.I7.i1.p1.1.m1.1.1" xref="S4.I7.i1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.I7.i1.p1.1.m1.1b"><ci id="S4.I7.i1.p1.1.m1.1.1.cmml" xref="S4.I7.i1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I7.i1.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.I7.i1.p1.1.m1.1d">italic_α</annotation></semantics></math> is reduced from 1.0 to 0.5, diminishing the weight of immediate user rewards, there is a marked decline in the ‘click rate’. This drop indicates that with less optimization towards immediate feedback, user engagement correspondingly decreases. Intriguingly, the ‘return time’ metric also exhibits a significant increase, suggesting that the model’s reduced focus on user engagement might adversely affect its capacity to capture user retention dynamics.</p>
</div>
</li>
<li class="ltx_item" id="S4.I7.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I7.i2.p1">
<p class="ltx_p" id="S4.I7.i2.p1.2">Conversely, as <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.I7.i2.p1.1.m1.1"><semantics id="S4.I7.i2.p1.1.m1.1a"><mi id="S4.I7.i2.p1.1.m1.1.1" xref="S4.I7.i2.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.I7.i2.p1.1.m1.1b"><ci id="S4.I7.i2.p1.1.m1.1.1.cmml" xref="S4.I7.i2.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I7.i2.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.I7.i2.p1.1.m1.1d">italic_α</annotation></semantics></math> is incremented from 1.0 to 1.5, thereby increasing the emphasis on immediate rewards, there is a slight decrease in ‘click rate’, particularly by 2% when <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.I7.i2.p1.2.m2.1"><semantics id="S4.I7.i2.p1.2.m2.1a"><mi id="S4.I7.i2.p1.2.m2.1.1" xref="S4.I7.i2.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.I7.i2.p1.2.m2.1b"><ci id="S4.I7.i2.p1.2.m2.1.1.cmml" xref="S4.I7.i2.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I7.i2.p1.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.I7.i2.p1.2.m2.1d">italic_α</annotation></semantics></math> reaches 1.5. This nuanced decline implies that an overly concentrated focus on immediate rewards could slightly detract from optimizing for engagement. Moreover, the heightened attention to immediate rewards seems to influence the retention optimization process, as evidenced by an increased ‘return time’.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS7.p2.1">These observations underscore the delicate balance required in tuning the <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS7.p2.1.m1.1"><semantics id="S4.SS7.p2.1.m1.1a"><mi id="S4.SS7.p2.1.m1.1.1" xref="S4.SS7.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS7.p2.1.m1.1b"><ci id="S4.SS7.p2.1.m1.1.1.cmml" xref="S4.SS7.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS7.p2.1.m1.1d">italic_α</annotation></semantics></math> parameter to harmonize the dual objectives of optimizing the retention signal, thereby affirming the intricacies involved in reward structure design within our model.</p>
</div>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="305" id="S4.F6.1.g1" src="x8.png" width="373"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="305" id="S4.F6.2.g1" src="x9.png" width="373"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Balance Parameter Analysis.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="545" id="S4.F7.g1" src="x10.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7. </span>Deployment of GFN4Retention in live experiments.
The bottom plot gives the detail of the two ranking stages where <math alttext="\otimes" class="ltx_Math" display="inline" id="S4.F7.3.m1.1"><semantics id="S4.F7.3.m1.1b"><mo id="S4.F7.3.m1.1.1" xref="S4.F7.3.m1.1.1.cmml">⊗</mo><annotation-xml encoding="MathML-Content" id="S4.F7.3.m1.1c"><csymbol cd="latexml" id="S4.F7.3.m1.1.1.cmml" xref="S4.F7.3.m1.1.1">tensor-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.3.m1.1d">\otimes</annotation><annotation encoding="application/x-llamapun" id="S4.F7.3.m1.1e">⊗</annotation></semantics></math> represents the ensemble function that takes item scores from multiple ranking models as input and <math alttext="a_{t}" class="ltx_Math" display="inline" id="S4.F7.4.m2.1"><semantics id="S4.F7.4.m2.1b"><msub id="S4.F7.4.m2.1.1" xref="S4.F7.4.m2.1.1.cmml"><mi id="S4.F7.4.m2.1.1.2" xref="S4.F7.4.m2.1.1.2.cmml">a</mi><mi id="S4.F7.4.m2.1.1.3" xref="S4.F7.4.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F7.4.m2.1c"><apply id="S4.F7.4.m2.1.1.cmml" xref="S4.F7.4.m2.1.1"><csymbol cd="ambiguous" id="S4.F7.4.m2.1.1.1.cmml" xref="S4.F7.4.m2.1.1">subscript</csymbol><ci id="S4.F7.4.m2.1.1.2.cmml" xref="S4.F7.4.m2.1.1.2">𝑎</ci><ci id="S4.F7.4.m2.1.1.3.cmml" xref="S4.F7.4.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.4.m2.1d">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.F7.4.m2.1e">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as weights of the scores.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.8. </span>Live Experiment</h3>
<div class="ltx_para" id="S4.SS8.p1">
<p class="ltx_p" id="S4.SS8.p1.1">We conduct the live evaluation of our GFN4Retention solution through an A/B test on a real-world industrial video recommendation platform.
The system serves billions of user requests every day and the daily candidate pool is around several million.
The overall recommender system consists of a relevant candidate retrieval stage and three rank-and-filter stages that gradually scale down the number of selected items before it is ready for exposure.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.F7" title="Figure 7 ‣ 4.7. Parameter Analysis ‣ 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">7</span></a>, we deploy GFN4Retention in the ranking score ensemble modules of two of the ranking stages (i.e. the first ranking stage and the second-ranking stage) with separately learned policy models.
The output action corresponds to the weights that fuse the ranking scores from multiple score prediction models.
The baseline in the first ranking stage linearly combines the input ranking scores with empirically fixed parameters, while the baseline in the second ranking stage adopts an RL-based solution that automatically searches the action space.
For each experiment, we holdout 10% of the total online traffic for the GFN4Retention solution and 20% of the total online traffic for the baseline.
For the retention signal, we use the reciprocal return time gap as the retention reward of a user session and the normalized watch time as an immediate reward.
Correspondingly, the evaluation consists of the next-day user return frequency and the average watch time which are evaluated on daily basis. Both metrics are better if larger.
We summarize the results in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#S4.T3" title="Table 3 ‣ 4.8. Live Experiment ‣ 4. Experiment ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">3</span></a> which proves that the GFN4Retention method can significantly improve the user’s retention and the corresponding immediate reward.
When focusing on the target user group with relatively lower activity in the system, the improvement in retention is more significant.
Note that we have applied the proposed method in the two major ranking scenarios in the system, indicating its generalization ability and scalability in different stages.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering" style="color:#FF0000;"><span class="ltx_tag ltx_tag_table">Table 3. </span>Online A/B Test Performance.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S4.T3.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.2.2">
<th class="ltx_td ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T3.2.2.3"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T3.1.1.1">
<math alttext="1^{\mathrm{st}}" class="ltx_Math" display="inline" id="S4.T3.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.m1.1a"><msup id="S4.T3.1.1.1.m1.1.1" xref="S4.T3.1.1.1.m1.1.1.cmml"><mn id="S4.T3.1.1.1.m1.1.1.2" mathcolor="#FF0000" xref="S4.T3.1.1.1.m1.1.1.2.cmml">1</mn><mi id="S4.T3.1.1.1.m1.1.1.3" mathcolor="#FF0000" xref="S4.T3.1.1.1.m1.1.1.3.cmml">st</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.m1.1b"><apply id="S4.T3.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.1.1.1.m1.1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1">superscript</csymbol><cn id="S4.T3.1.1.1.m1.1.1.2.cmml" type="integer" xref="S4.T3.1.1.1.m1.1.1.2">1</cn><ci id="S4.T3.1.1.1.m1.1.1.3.cmml" xref="S4.T3.1.1.1.m1.1.1.3">st</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.m1.1c">1^{\mathrm{st}}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.m1.1d">1 start_POSTSUPERSCRIPT roman_st end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="S4.T3.1.1.1.1" style="color:#FF0000;"> Stage</span>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.2.2.2">
<math alttext="2^{\mathrm{nd}}" class="ltx_Math" display="inline" id="S4.T3.2.2.2.m1.1"><semantics id="S4.T3.2.2.2.m1.1a"><msup id="S4.T3.2.2.2.m1.1.1" xref="S4.T3.2.2.2.m1.1.1.cmml"><mn id="S4.T3.2.2.2.m1.1.1.2" mathcolor="#FF0000" xref="S4.T3.2.2.2.m1.1.1.2.cmml">2</mn><mi id="S4.T3.2.2.2.m1.1.1.3" mathcolor="#FF0000" xref="S4.T3.2.2.2.m1.1.1.3.cmml">nd</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.m1.1b"><apply id="S4.T3.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.2.2.2.m1.1.1.1.cmml" xref="S4.T3.2.2.2.m1.1.1">superscript</csymbol><cn id="S4.T3.2.2.2.m1.1.1.2.cmml" type="integer" xref="S4.T3.2.2.2.m1.1.1.2">2</cn><ci id="S4.T3.2.2.2.m1.1.1.3.cmml" xref="S4.T3.2.2.2.m1.1.1.3">nd</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.m1.1c">2^{\mathrm{nd}}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.2.m1.1d">2 start_POSTSUPERSCRIPT roman_nd end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="S4.T3.2.2.2.1" style="color:#FF0000;"> Stage</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.2.3.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.2.3.1.1"><span class="ltx_text" id="S4.T3.2.3.1.1.1" style="color:#FF0000;">overall next-day retention</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.2.3.1.2"><span class="ltx_text" id="S4.T3.2.3.1.2.1" style="color:#FF0000;">+0.015%*</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.3.1.3"><span class="ltx_text" id="S4.T3.2.3.1.3.1" style="color:#FF0000;">+0.002%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.4.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.2.4.2.1"><span class="ltx_text" id="S4.T3.2.4.2.1.1" style="color:#FF0000;">target users’ next-day retention</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.2.4.2.2"><span class="ltx_text" id="S4.T3.2.4.2.2.1" style="color:#FF0000;">+0.069%*</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.4.2.3"><span class="ltx_text" id="S4.T3.2.4.2.3.1" style="color:#FF0000;">+0.056%*</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.5.3">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.2.5.3.1"><span class="ltx_text" id="S4.T3.2.5.3.1.1" style="color:#FF0000;">watch_time</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.2.5.3.2"><span class="ltx_text" id="S4.T3.2.5.3.2.1" style="color:#FF0000;">+0.558%*</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.2.5.3.3"><span class="ltx_text" id="S4.T3.2.5.3.3.1" style="color:#FF0000;">+0.224%*</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.T3.5"><span class="ltx_text" id="S4.T3.5.1" style="color:#FF0000;">“</span><span class="ltx_text ltx_font_bold" id="S4.T3.5.2" style="font-size:144%;color:#FF0000;">*</span><span class="ltx_text" id="S4.T3.5.3" style="color:#FF0000;">”: the statistically significant improvements over the baseline.</span></p>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Related Work</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we briefly discuss existing research related to RL-based recommender systems and retention optimization.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span><span class="ltx_text ltx_font_bold" id="S5.SS1.1.1">Reinforcement Learning Based RSs</span>
</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">The application of Reinforcement Learning (RL) for recommendations is justified by the underlying Markov Decision Process framework, which is fundamental to the RL paradigm <cite class="ltx_cite ltx_citemacro_citep">(Sutton and Barto, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib44" title="">2018</a>; Afsar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib3" title="">2021</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib48" title="">2022</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib56" title="">2022</a>; Shani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib42" title="">2005</a>)</cite>. RL’s primary benefit in this context is its focus on maximizing the expected cumulative reward from user interactions over time, rather than just enhancing immediate recommendations. In environments with limited recommendation options, methods that utilize tabular approaches  <cite class="ltx_cite ltx_citemacro_citep">(Mahmood and Ricci, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib35" title="">2007</a>; Moling et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib36" title="">2012</a>)</cite> or value function estimation  <cite class="ltx_cite ltx_citemacro_citep">(Taghipour et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib46" title="">2007</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib63" title="">2018</a>; Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib61" title="">2018</a>; Ie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib26" title="">2019a</a>)</cite> have been employed to assess the long-term implications of recommendations. Conversely, in situations characterized by vast action spaces, policy gradient  <cite class="ltx_cite ltx_citemacro_citep">(Sun and Zhang, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib43" title="">2018</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib14" title="">2019a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib12" title="">b</a>)</cite>, and actor-critic methodologies  <cite class="ltx_cite ltx_citemacro_citep">(Sutton et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib45" title="">1999</a>; Peters and Schaal, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib41" title="">2008</a>; Bhatnagar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib6" title="">2007</a>; Degris et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib19" title="">2012</a>; Dulac-Arnold et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib22" title="">2015</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib31" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib32" title="">2020</a>; Xin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib50" title="">2020</a>; Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib60" title="">2020</a>; Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib8" title="">2023b</a>)</cite> are preferred for their ability to steer the recommendation policy toward higher-quality outcomes. The complexity of optimizing for multiple metrics is addressed in the literature on multi-objective optimization, highlighting the varying behavioral patterns among users <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib16" title="">2021b</a>; Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib8" title="">2023b</a>)</cite>. To bridge the discrepancy between real-world user interactions and offline assessments, user simulators have become a pivotal tool for researchers <cite class="ltx_cite ltx_citemacro_citep">(Ie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib27" title="">2019b</a>; Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib59" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib57" title="">2023a</a>)</cite>. Our methodology extends this direction by performing offline training in simulated cross-session environments for user retention optimization.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">In parallel, Generative Flow Networks (GFNs) have surfaced as a groundbreaking approach <cite class="ltx_cite ltx_citemacro_citep">(Bengio et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib4" title="">2021</a>)</cite>, drawing parallels with RL but pushing the boundaries in terms of generating diverse, high-quality samples from intricate distributions. Notably, GFNs have demonstrated their efficacy in tackling list-wise recommendation challenges <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib33" title="">2023a</a>)</cite>, showcasing their utility in recommendation systems.
Our research leverages GFNs with novel flow-matching formulations and tailored objective functions to refine user retention optimization.
We notice that the generative process of GFN may remind readers about the diffusion-based methods which have also been studied in sequential recommendations <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib30" title="">2023</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib52" title="">2024</a>)</cite>.
However, they are not designed for sparse and delayed return signal modeling since they require precise and abundant representations for unsupervised learning. Intuitively, we believe our GFN-based solution fits better to this problem since it is an energy-based model that can predict the delayed retention signal while following the iterative recommendation process.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Retention Optimization for RSs</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Shifting away from the traditional focus on immediate feedback, the research community has started delving into strategies for enhancing users’ long-term satisfaction <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib49" title="">2017</a>; Cai and Chen, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib9" title="">2020</a>; Carvalho and Macedo, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib10" title="">2013</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib13" title="">2019c</a>)</cite>. Along this direction, several studies have investigated methods to boost long-term user engagement by analyzing metrics like dwell time <cite class="ltx_cite ltx_citemacro_citep">(Kapoor et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib28" title="">2014</a>; Chandar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib11" title="">2022</a>; Zou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib65" title="">2019</a>)</cite>. However, the domain of user retention-oriented optimization remains relatively underexplored. Notably, a few pioneering efforts have aimed to predict user retention through innovative perspective <cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib7" title="">2023a</a>; Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib58" title="">2023b</a>; Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib21" title="">2023</a>; Gwalani, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib24" title="">2022</a>)</cite>. , such as the rationale contrastive multi-instance learning approach, designed to elucidate the factors influencing user retention and thereby augment its interpretability <cite class="ltx_cite ltx_citemacro_citep">(Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib21" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">A notable advancement includes leveraging decision transformer-based models to tackle user retention challenges, and ingeniously reframing the reinforcement learning (RL) problem as an autoregression issue <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib58" title="">2023b</a>)</cite>. Furthermore, some researchers argue that user retention—viewed as feedback accumulated over multiple interactions with the system—presents a complex challenge in attributing retention rewards to individual items or sequences <cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#bib.bib7" title="">2023a</a>)</cite>. They propose conceptualizing this issue using reinforcement learning to minimize the cumulative time intervals across sessions. Our work builds upon these insights into retention optimization, uniquely considering the integration of immediate feedback within the modeling framework to better capture the nuances of user retention dynamics. Moreover, our approach has demonstrated efficacy across both offline datasets and large-scale online platforms.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this work, we delve into optimizing user retention within recommender systems, a critical aspect for fostering sustained user engagement. Recognizing the intricate nature of long-term user interactions, we conceptualize the retention signal as a holistic measure of user satisfaction at the session’s conclusion. Our approach models this comprehensive estimation through a generative flow, ingeniously back-propagating the retention reward to each user’s immediate feedback within a session. By employing a simplified flow matching technique alongside a novel DB loss function, our model optimizes long-term retention while also integrating immediate feedback signals. The efficacy of our methodology is rigorously validated through extensive offline empirical evaluations on publicly available datasets and real-world online A/B testing on a commercial platform, demonstrating its practical applicability and effectiveness in enhancing user retention.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">ACKNOWLEDGEMENTS</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This research was partially supported by Kuaishou, Research Impact Fund (No.R1015-23), APRC - CityU New Research Initiatives (No.9610565, Start-up Grant for New Faculty of CityU), CityU - HKIDS Early Career Research Grant (No.9360163), Hong Kong ITC Innovation and Technology Fund Midstream Research Programme for Universities Project (No.ITS/034/22MS), Hong Kong Environmental and Conservation Fund (No.88/2022), and SIRG - CityU Strategic Interdisciplinary Research Grant (No.7020046, No.7020074).</p>
</div>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>IMPLEMENTATION DETAILS</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In our study, we implement a cross-session environment setup using the KuaiSim Simulator to assess our models. Here are the detailed configurations for each dataset:</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p2">
<p class="ltx_p" id="A1.p2.1"><span class="ltx_text ltx_font_bold" id="A1.p2.1.1">For the Kuairand-Pure Dataset:</span></p>
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i1.p1">
<p class="ltx_p" id="A1.I1.i1.p1.1">We utilize a CrossSessionBuffer of size 100,000.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i2.p1">
<p class="ltx_p" id="A1.I1.i2.p1.1">The policy model is configured with a Transformer architecture, featuring 4 attention heads and an embedding size of 32.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i3.p1">
<p class="ltx_p" id="A1.I1.i3.p1.1">Learning rates are set to 0.00002 for the flow estimator and 0.0001 for both the forward and backward estimators.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i4.p1">
<p class="ltx_p" id="A1.I1.i4.p1.1">All estimators share an embedding hidden dimension of 128.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i5.p1">
<p class="ltx_p" id="A1.I1.i5.p1.1">Optimization is conducted using the Adam optimizer, with a batch size of 128.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i6.p1">
<p class="ltx_p" id="A1.I1.i6.p1.1">A default balance parameter <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.I1.i6.p1.1.m1.1"><semantics id="A1.I1.i6.p1.1.m1.1a"><mi id="A1.I1.i6.p1.1.m1.1.1" xref="A1.I1.i6.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i6.p1.1.m1.1b"><ci id="A1.I1.i6.p1.1.m1.1.1.cmml" xref="A1.I1.i6.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i6.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i6.p1.1.m1.1d">italic_α</annotation></semantics></math> of 1 is applied.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i7.p1">
<p class="ltx_p" id="A1.I1.i7.p1.3">Smooth offset values are set at 1.0 for both forward <math alttext="\beta_{F}" class="ltx_Math" display="inline" id="A1.I1.i7.p1.1.m1.1"><semantics id="A1.I1.i7.p1.1.m1.1a"><msub id="A1.I1.i7.p1.1.m1.1.1" xref="A1.I1.i7.p1.1.m1.1.1.cmml"><mi id="A1.I1.i7.p1.1.m1.1.1.2" xref="A1.I1.i7.p1.1.m1.1.1.2.cmml">β</mi><mi id="A1.I1.i7.p1.1.m1.1.1.3" xref="A1.I1.i7.p1.1.m1.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i7.p1.1.m1.1b"><apply id="A1.I1.i7.p1.1.m1.1.1.cmml" xref="A1.I1.i7.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I1.i7.p1.1.m1.1.1.1.cmml" xref="A1.I1.i7.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I1.i7.p1.1.m1.1.1.2.cmml" xref="A1.I1.i7.p1.1.m1.1.1.2">𝛽</ci><ci id="A1.I1.i7.p1.1.m1.1.1.3.cmml" xref="A1.I1.i7.p1.1.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i7.p1.1.m1.1c">\beta_{F}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i7.p1.1.m1.1d">italic_β start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math> and backward <math alttext="\beta_{B}" class="ltx_Math" display="inline" id="A1.I1.i7.p1.2.m2.1"><semantics id="A1.I1.i7.p1.2.m2.1a"><msub id="A1.I1.i7.p1.2.m2.1.1" xref="A1.I1.i7.p1.2.m2.1.1.cmml"><mi id="A1.I1.i7.p1.2.m2.1.1.2" xref="A1.I1.i7.p1.2.m2.1.1.2.cmml">β</mi><mi id="A1.I1.i7.p1.2.m2.1.1.3" xref="A1.I1.i7.p1.2.m2.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i7.p1.2.m2.1b"><apply id="A1.I1.i7.p1.2.m2.1.1.cmml" xref="A1.I1.i7.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.I1.i7.p1.2.m2.1.1.1.cmml" xref="A1.I1.i7.p1.2.m2.1.1">subscript</csymbol><ci id="A1.I1.i7.p1.2.m2.1.1.2.cmml" xref="A1.I1.i7.p1.2.m2.1.1.2">𝛽</ci><ci id="A1.I1.i7.p1.2.m2.1.1.3.cmml" xref="A1.I1.i7.p1.2.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i7.p1.2.m2.1c">\beta_{B}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i7.p1.2.m2.1d">italic_β start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math> probabilities, with a reward smooth offset <math alttext="\beta_{r}" class="ltx_Math" display="inline" id="A1.I1.i7.p1.3.m3.1"><semantics id="A1.I1.i7.p1.3.m3.1a"><msub id="A1.I1.i7.p1.3.m3.1.1" xref="A1.I1.i7.p1.3.m3.1.1.cmml"><mi id="A1.I1.i7.p1.3.m3.1.1.2" xref="A1.I1.i7.p1.3.m3.1.1.2.cmml">β</mi><mi id="A1.I1.i7.p1.3.m3.1.1.3" xref="A1.I1.i7.p1.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i7.p1.3.m3.1b"><apply id="A1.I1.i7.p1.3.m3.1.1.cmml" xref="A1.I1.i7.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.I1.i7.p1.3.m3.1.1.1.cmml" xref="A1.I1.i7.p1.3.m3.1.1">subscript</csymbol><ci id="A1.I1.i7.p1.3.m3.1.1.2.cmml" xref="A1.I1.i7.p1.3.m3.1.1.2">𝛽</ci><ci id="A1.I1.i7.p1.3.m3.1.1.3.cmml" xref="A1.I1.i7.p1.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i7.p1.3.m3.1c">\beta_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i7.p1.3.m3.1d">italic_β start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> of 0.6.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A1.p3">
<p class="ltx_p" id="A1.p3.1"><span class="ltx_text ltx_font_bold" id="A1.p3.1.1">For the MovieLens-1M Dataset:</span></p>
<ul class="ltx_itemize" id="A1.I2">
<li class="ltx_item" id="A1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i1.p1">
<p class="ltx_p" id="A1.I2.i1.p1.1">We utilize a CrossSessionBuffer of size 10,000.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i2.p1">
<p class="ltx_p" id="A1.I2.i2.p1.1">The policy model is configured with a Transformer architecture, featuring 4 attention heads and an embedding size of 32.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i3.p1">
<p class="ltx_p" id="A1.I2.i3.p1.1">Learning rates are set to 0.0003 for the flow estimator and 0.001 for both the forward and backward estimators.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i4.p1">
<p class="ltx_p" id="A1.I2.i4.p1.1">All estimators share an embedding hidden dimension of 64.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i5.p1">
<p class="ltx_p" id="A1.I2.i5.p1.1">Optimization is conducted using the Adam optimizer, with a batch size of 32.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i6.p1">
<p class="ltx_p" id="A1.I2.i6.p1.1">A default balance parameter <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.I2.i6.p1.1.m1.1"><semantics id="A1.I2.i6.p1.1.m1.1a"><mi id="A1.I2.i6.p1.1.m1.1.1" xref="A1.I2.i6.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.I2.i6.p1.1.m1.1b"><ci id="A1.I2.i6.p1.1.m1.1.1.cmml" xref="A1.I2.i6.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i6.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i6.p1.1.m1.1d">italic_α</annotation></semantics></math> of 1 is applied.</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i7.p1">
<p class="ltx_p" id="A1.I2.i7.p1.3">Smooth offset values are set at 0.8 for both forward <math alttext="\beta_{F}" class="ltx_Math" display="inline" id="A1.I2.i7.p1.1.m1.1"><semantics id="A1.I2.i7.p1.1.m1.1a"><msub id="A1.I2.i7.p1.1.m1.1.1" xref="A1.I2.i7.p1.1.m1.1.1.cmml"><mi id="A1.I2.i7.p1.1.m1.1.1.2" xref="A1.I2.i7.p1.1.m1.1.1.2.cmml">β</mi><mi id="A1.I2.i7.p1.1.m1.1.1.3" xref="A1.I2.i7.p1.1.m1.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I2.i7.p1.1.m1.1b"><apply id="A1.I2.i7.p1.1.m1.1.1.cmml" xref="A1.I2.i7.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I2.i7.p1.1.m1.1.1.1.cmml" xref="A1.I2.i7.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I2.i7.p1.1.m1.1.1.2.cmml" xref="A1.I2.i7.p1.1.m1.1.1.2">𝛽</ci><ci id="A1.I2.i7.p1.1.m1.1.1.3.cmml" xref="A1.I2.i7.p1.1.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i7.p1.1.m1.1c">\beta_{F}</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i7.p1.1.m1.1d">italic_β start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math> and backward <math alttext="\beta_{B}" class="ltx_Math" display="inline" id="A1.I2.i7.p1.2.m2.1"><semantics id="A1.I2.i7.p1.2.m2.1a"><msub id="A1.I2.i7.p1.2.m2.1.1" xref="A1.I2.i7.p1.2.m2.1.1.cmml"><mi id="A1.I2.i7.p1.2.m2.1.1.2" xref="A1.I2.i7.p1.2.m2.1.1.2.cmml">β</mi><mi id="A1.I2.i7.p1.2.m2.1.1.3" xref="A1.I2.i7.p1.2.m2.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I2.i7.p1.2.m2.1b"><apply id="A1.I2.i7.p1.2.m2.1.1.cmml" xref="A1.I2.i7.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.I2.i7.p1.2.m2.1.1.1.cmml" xref="A1.I2.i7.p1.2.m2.1.1">subscript</csymbol><ci id="A1.I2.i7.p1.2.m2.1.1.2.cmml" xref="A1.I2.i7.p1.2.m2.1.1.2">𝛽</ci><ci id="A1.I2.i7.p1.2.m2.1.1.3.cmml" xref="A1.I2.i7.p1.2.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i7.p1.2.m2.1c">\beta_{B}</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i7.p1.2.m2.1d">italic_β start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math> probabilities, with a reward smooth offset <math alttext="\beta_{r}" class="ltx_Math" display="inline" id="A1.I2.i7.p1.3.m3.1"><semantics id="A1.I2.i7.p1.3.m3.1a"><msub id="A1.I2.i7.p1.3.m3.1.1" xref="A1.I2.i7.p1.3.m3.1.1.cmml"><mi id="A1.I2.i7.p1.3.m3.1.1.2" xref="A1.I2.i7.p1.3.m3.1.1.2.cmml">β</mi><mi id="A1.I2.i7.p1.3.m3.1.1.3" xref="A1.I2.i7.p1.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I2.i7.p1.3.m3.1b"><apply id="A1.I2.i7.p1.3.m3.1.1.cmml" xref="A1.I2.i7.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.I2.i7.p1.3.m3.1.1.1.cmml" xref="A1.I2.i7.p1.3.m3.1.1">subscript</csymbol><ci id="A1.I2.i7.p1.3.m3.1.1.2.cmml" xref="A1.I2.i7.p1.3.m3.1.1.2">𝛽</ci><ci id="A1.I2.i7.p1.3.m3.1.1.3.cmml" xref="A1.I2.i7.p1.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.i7.p1.3.m3.1c">\beta_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.I2.i7.p1.3.m3.1d">italic_β start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> of 0.6.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A1.p4">
<p class="ltx_p" id="A1.p4.1">Both datasets undergo 100,000 training steps to ensure comprehensive model evaluation.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>ALGORITHM</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">In this section, we elucidate the optimization algorithm underpinning our model, presented through explanatory pseudo-code. As delineated in Algorithm 1, the training procedure for GFN4Retention is methodically straightforward, adhering to a clearly defined sequence of operations that ensure the model’s convergence to the desired objectives. This structured approach facilitates ease of replication and verification of the results reported herein.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Training Process for GFN4Retention</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l1.2"># Apply current policy in running episodes:</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l2.2">procedure</span> ONLINE INFERENCE

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>  Initialize replay buffer <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">caligraphic_B</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l4.2">while</span> True, in each running episode do <span class="ltx_text ltx_font_bold" id="alg1.l4.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>     Observe user request <math alttext="\textbf{S}_{u,0}" class="ltx_Math" display="inline" id="alg1.l5.m1.2"><semantics id="alg1.l5.m1.2a"><msub id="alg1.l5.m1.2.3" xref="alg1.l5.m1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l5.m1.2.3.2" xref="alg1.l5.m1.2.3.2a.cmml">S</mtext><mrow id="alg1.l5.m1.2.2.2.4" xref="alg1.l5.m1.2.2.2.3.cmml"><mi id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml">u</mi><mo id="alg1.l5.m1.2.2.2.4.1" xref="alg1.l5.m1.2.2.2.3.cmml">,</mo><mn id="alg1.l5.m1.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.3.cmml" xref="alg1.l5.m1.2.3"><csymbol cd="ambiguous" id="alg1.l5.m1.2.3.1.cmml" xref="alg1.l5.m1.2.3">subscript</csymbol><ci id="alg1.l5.m1.2.3.2a.cmml" xref="alg1.l5.m1.2.3.2"><mtext class="ltx_mathvariant_bold" id="alg1.l5.m1.2.3.2.cmml" xref="alg1.l5.m1.2.3.2">S</mtext></ci><list id="alg1.l5.m1.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.4"><ci id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">𝑢</ci><cn id="alg1.l5.m1.2.2.2.2.cmml" type="integer" xref="alg1.l5.m1.2.2.2.2">0</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">\textbf{S}_{u,0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.2d">S start_POSTSUBSCRIPT italic_u , 0 end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>     Initial the item sequence <math alttext="s^{0}\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msup id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">s</mi><mn id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">0</mn></msup><mo id="alg1.l6.m1.1.1.1" stretchy="false" xref="alg1.l6.m1.1.1.1.cmml">←</mo><mi id="alg1.l6.m1.1.1.3" mathvariant="normal" xref="alg1.l6.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">superscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">𝑠</ci><cn id="alg1.l6.m1.1.1.2.3.cmml" type="integer" xref="alg1.l6.m1.1.1.2.3">0</cn></apply><emptyset id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">s^{0}\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_s start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT ← ∅</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l7.2">for</span> <math alttext="t\in\{1,\ldots,T\}" class="ltx_Math" display="inline" id="alg1.l7.m1.3"><semantics id="alg1.l7.m1.3a"><mrow id="alg1.l7.m1.3.4" xref="alg1.l7.m1.3.4.cmml"><mi id="alg1.l7.m1.3.4.2" xref="alg1.l7.m1.3.4.2.cmml">t</mi><mo id="alg1.l7.m1.3.4.1" xref="alg1.l7.m1.3.4.1.cmml">∈</mo><mrow id="alg1.l7.m1.3.4.3.2" xref="alg1.l7.m1.3.4.3.1.cmml"><mo id="alg1.l7.m1.3.4.3.2.1" stretchy="false" xref="alg1.l7.m1.3.4.3.1.cmml">{</mo><mn id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">1</mn><mo id="alg1.l7.m1.3.4.3.2.2" xref="alg1.l7.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l7.m1.2.2" mathvariant="normal" xref="alg1.l7.m1.2.2.cmml">…</mi><mo id="alg1.l7.m1.3.4.3.2.3" xref="alg1.l7.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml">T</mi><mo id="alg1.l7.m1.3.4.3.2.4" stretchy="false" xref="alg1.l7.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.3b"><apply id="alg1.l7.m1.3.4.cmml" xref="alg1.l7.m1.3.4"><in id="alg1.l7.m1.3.4.1.cmml" xref="alg1.l7.m1.3.4.1"></in><ci id="alg1.l7.m1.3.4.2.cmml" xref="alg1.l7.m1.3.4.2">𝑡</ci><set id="alg1.l7.m1.3.4.3.1.cmml" xref="alg1.l7.m1.3.4.3.2"><cn id="alg1.l7.m1.1.1.cmml" type="integer" xref="alg1.l7.m1.1.1">1</cn><ci id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">…</ci><ci id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.3c">t\in\{1,\ldots,T\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.3d">italic_t ∈ { 1 , … , italic_T }</annotation></semantics></math> do <span class="ltx_text ltx_font_bold" id="alg1.l7.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>        Sample item list <math alttext="a_{t}\sim P(\cdot|u,s^{t-1})" class="ltx_math_unparsed" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1b"><msub id="alg1.l8.m1.1.1"><mi id="alg1.l8.m1.1.1.2">a</mi><mi id="alg1.l8.m1.1.1.3">t</mi></msub><mo id="alg1.l8.m1.1.2">∼</mo><mi id="alg1.l8.m1.1.3">P</mi><mrow id="alg1.l8.m1.1.4"><mo id="alg1.l8.m1.1.4.1" stretchy="false">(</mo><mo id="alg1.l8.m1.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="alg1.l8.m1.1.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="alg1.l8.m1.1.4.4">u</mi><mo id="alg1.l8.m1.1.4.5">,</mo><msup id="alg1.l8.m1.1.4.6"><mi id="alg1.l8.m1.1.4.6.2">s</mi><mrow id="alg1.l8.m1.1.4.6.3"><mi id="alg1.l8.m1.1.4.6.3.2">t</mi><mo id="alg1.l8.m1.1.4.6.3.1">−</mo><mn id="alg1.l8.m1.1.4.6.3.3">1</mn></mrow></msup><mo id="alg1.l8.m1.1.4.7" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">a_{t}\sim P(\cdot|u,s^{t-1})</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ italic_P ( ⋅ | italic_u , italic_s start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT )</annotation></semantics></math> with current policy.

</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l9.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l9.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>     Obtain user responses <span class="ltx_text ltx_markedasmath ltx_font_bold" id="alg1.l10.2">y</span> from online environment and calculate the retention reward <math alttext="\mathcal{R}(u,s)" class="ltx_Math" display="inline" id="alg1.l10.m2.2"><semantics id="alg1.l10.m2.2a"><mrow id="alg1.l10.m2.2.3" xref="alg1.l10.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m2.2.3.2" xref="alg1.l10.m2.2.3.2.cmml">ℛ</mi><mo id="alg1.l10.m2.2.3.1" xref="alg1.l10.m2.2.3.1.cmml">⁢</mo><mrow id="alg1.l10.m2.2.3.3.2" xref="alg1.l10.m2.2.3.3.1.cmml"><mo id="alg1.l10.m2.2.3.3.2.1" stretchy="false" xref="alg1.l10.m2.2.3.3.1.cmml">(</mo><mi id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">u</mi><mo id="alg1.l10.m2.2.3.3.2.2" xref="alg1.l10.m2.2.3.3.1.cmml">,</mo><mi id="alg1.l10.m2.2.2" xref="alg1.l10.m2.2.2.cmml">s</mi><mo id="alg1.l10.m2.2.3.3.2.3" stretchy="false" xref="alg1.l10.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.2b"><apply id="alg1.l10.m2.2.3.cmml" xref="alg1.l10.m2.2.3"><times id="alg1.l10.m2.2.3.1.cmml" xref="alg1.l10.m2.2.3.1"></times><ci id="alg1.l10.m2.2.3.2.cmml" xref="alg1.l10.m2.2.3.2">ℛ</ci><interval closure="open" id="alg1.l10.m2.2.3.3.1.cmml" xref="alg1.l10.m2.2.3.3.2"><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">𝑢</ci><ci id="alg1.l10.m2.2.2.cmml" xref="alg1.l10.m2.2.2">𝑠</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.2c">\mathcal{R}(u,s)</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m2.2d">caligraphic_R ( italic_u , italic_s )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span>     <math alttext="(u,s,\mathcal{R}(u,s),\textbf{y})\rightarrow\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l11.m1.6"><semantics id="alg1.l11.m1.6a"><mrow id="alg1.l11.m1.6.6" xref="alg1.l11.m1.6.6.cmml"><mrow id="alg1.l11.m1.6.6.1.1" xref="alg1.l11.m1.6.6.1.2.cmml"><mo id="alg1.l11.m1.6.6.1.1.2" stretchy="false" xref="alg1.l11.m1.6.6.1.2.cmml">(</mo><mi id="alg1.l11.m1.3.3" xref="alg1.l11.m1.3.3.cmml">u</mi><mo id="alg1.l11.m1.6.6.1.1.3" xref="alg1.l11.m1.6.6.1.2.cmml">,</mo><mi id="alg1.l11.m1.4.4" xref="alg1.l11.m1.4.4.cmml">s</mi><mo id="alg1.l11.m1.6.6.1.1.4" xref="alg1.l11.m1.6.6.1.2.cmml">,</mo><mrow id="alg1.l11.m1.6.6.1.1.1" xref="alg1.l11.m1.6.6.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.6.6.1.1.1.2" xref="alg1.l11.m1.6.6.1.1.1.2.cmml">ℛ</mi><mo id="alg1.l11.m1.6.6.1.1.1.1" xref="alg1.l11.m1.6.6.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l11.m1.6.6.1.1.1.3.2" xref="alg1.l11.m1.6.6.1.1.1.3.1.cmml"><mo id="alg1.l11.m1.6.6.1.1.1.3.2.1" stretchy="false" xref="alg1.l11.m1.6.6.1.1.1.3.1.cmml">(</mo><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">u</mi><mo id="alg1.l11.m1.6.6.1.1.1.3.2.2" xref="alg1.l11.m1.6.6.1.1.1.3.1.cmml">,</mo><mi id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml">s</mi><mo id="alg1.l11.m1.6.6.1.1.1.3.2.3" stretchy="false" xref="alg1.l11.m1.6.6.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="alg1.l11.m1.6.6.1.1.5" xref="alg1.l11.m1.6.6.1.2.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="alg1.l11.m1.5.5" xref="alg1.l11.m1.5.5a.cmml">y</mtext><mo id="alg1.l11.m1.6.6.1.1.6" stretchy="false" xref="alg1.l11.m1.6.6.1.2.cmml">)</mo></mrow><mo id="alg1.l11.m1.6.6.2" stretchy="false" xref="alg1.l11.m1.6.6.2.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.6.6.3" xref="alg1.l11.m1.6.6.3.cmml">ℬ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.6b"><apply id="alg1.l11.m1.6.6.cmml" xref="alg1.l11.m1.6.6"><ci id="alg1.l11.m1.6.6.2.cmml" xref="alg1.l11.m1.6.6.2">→</ci><vector id="alg1.l11.m1.6.6.1.2.cmml" xref="alg1.l11.m1.6.6.1.1"><ci id="alg1.l11.m1.3.3.cmml" xref="alg1.l11.m1.3.3">𝑢</ci><ci id="alg1.l11.m1.4.4.cmml" xref="alg1.l11.m1.4.4">𝑠</ci><apply id="alg1.l11.m1.6.6.1.1.1.cmml" xref="alg1.l11.m1.6.6.1.1.1"><times id="alg1.l11.m1.6.6.1.1.1.1.cmml" xref="alg1.l11.m1.6.6.1.1.1.1"></times><ci id="alg1.l11.m1.6.6.1.1.1.2.cmml" xref="alg1.l11.m1.6.6.1.1.1.2">ℛ</ci><interval closure="open" id="alg1.l11.m1.6.6.1.1.1.3.1.cmml" xref="alg1.l11.m1.6.6.1.1.1.3.2"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑢</ci><ci id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2">𝑠</ci></interval></apply><ci id="alg1.l11.m1.5.5a.cmml" xref="alg1.l11.m1.5.5"><mtext class="ltx_mathvariant_bold" id="alg1.l11.m1.5.5.cmml" xref="alg1.l11.m1.5.5">y</mtext></ci></vector><ci id="alg1.l11.m1.6.6.3.cmml" xref="alg1.l11.m1.6.6.3">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.6c">(u,s,\mathcal{R}(u,s),\textbf{y})\rightarrow\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.6d">( italic_u , italic_s , caligraphic_R ( italic_u , italic_s ) , y ) → caligraphic_B</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l12.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l12.3">while</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l13.2">end procedure</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l14.2"># Simultaneous training on the buffer:</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l15.2">procedure</span> TRAINING

</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span>  Initialize all trainable parameters in the policy (e.g., <math alttext="\phi" class="ltx_Math" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><mi id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><ci id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">italic_ϕ</annotation></semantics></math>, <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="alg1.l16.m2.1"><semantics id="alg1.l16.m2.1a"><msub id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml"><mi id="alg1.l16.m2.1.1.2" xref="alg1.l16.m2.1.1.2.cmml">θ</mi><mn id="alg1.l16.m2.1.1.3" xref="alg1.l16.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><apply id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m2.1.1.1.cmml" xref="alg1.l16.m2.1.1">subscript</csymbol><ci id="alg1.l16.m2.1.1.2.cmml" xref="alg1.l16.m2.1.1.2">𝜃</ci><cn id="alg1.l16.m2.1.1.3.cmml" type="integer" xref="alg1.l16.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m2.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\theta_{2}" class="ltx_Math" display="inline" id="alg1.l16.m3.1"><semantics id="alg1.l16.m3.1a"><msub id="alg1.l16.m3.1.1" xref="alg1.l16.m3.1.1.cmml"><mi id="alg1.l16.m3.1.1.2" xref="alg1.l16.m3.1.1.2.cmml">θ</mi><mn id="alg1.l16.m3.1.1.3" xref="alg1.l16.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m3.1b"><apply id="alg1.l16.m3.1.1.cmml" xref="alg1.l16.m3.1.1"><csymbol cd="ambiguous" id="alg1.l16.m3.1.1.1.cmml" xref="alg1.l16.m3.1.1">subscript</csymbol><ci id="alg1.l16.m3.1.1.2.cmml" xref="alg1.l16.m3.1.1.2">𝜃</ci><cn id="alg1.l16.m3.1.1.3.cmml" type="integer" xref="alg1.l16.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m3.1c">\theta_{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m3.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>) in GFN4Retention)

</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">17:</span></span>  Wait until <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l17.m1.1"><semantics id="alg1.l17.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><ci id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.1d">caligraphic_B</annotation></semantics></math> has stored minimum amount of data points.

</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l18.2">while</span> Not Converged, in each iteration do <span class="ltx_text ltx_font_bold" id="alg1.l18.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">19:</span></span>     Obtain mini-batch sample <math alttext="(u,s,R_{l}(u,s),\textbf{y})\rightarrow\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l19.m1.6"><semantics id="alg1.l19.m1.6a"><mrow id="alg1.l19.m1.6.6" xref="alg1.l19.m1.6.6.cmml"><mrow id="alg1.l19.m1.6.6.1.1" xref="alg1.l19.m1.6.6.1.2.cmml"><mo id="alg1.l19.m1.6.6.1.1.2" stretchy="false" xref="alg1.l19.m1.6.6.1.2.cmml">(</mo><mi id="alg1.l19.m1.3.3" xref="alg1.l19.m1.3.3.cmml">u</mi><mo id="alg1.l19.m1.6.6.1.1.3" xref="alg1.l19.m1.6.6.1.2.cmml">,</mo><mi id="alg1.l19.m1.4.4" xref="alg1.l19.m1.4.4.cmml">s</mi><mo id="alg1.l19.m1.6.6.1.1.4" xref="alg1.l19.m1.6.6.1.2.cmml">,</mo><mrow id="alg1.l19.m1.6.6.1.1.1" xref="alg1.l19.m1.6.6.1.1.1.cmml"><msub id="alg1.l19.m1.6.6.1.1.1.2" xref="alg1.l19.m1.6.6.1.1.1.2.cmml"><mi id="alg1.l19.m1.6.6.1.1.1.2.2" xref="alg1.l19.m1.6.6.1.1.1.2.2.cmml">R</mi><mi id="alg1.l19.m1.6.6.1.1.1.2.3" xref="alg1.l19.m1.6.6.1.1.1.2.3.cmml">l</mi></msub><mo id="alg1.l19.m1.6.6.1.1.1.1" xref="alg1.l19.m1.6.6.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l19.m1.6.6.1.1.1.3.2" xref="alg1.l19.m1.6.6.1.1.1.3.1.cmml"><mo id="alg1.l19.m1.6.6.1.1.1.3.2.1" stretchy="false" xref="alg1.l19.m1.6.6.1.1.1.3.1.cmml">(</mo><mi id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">u</mi><mo id="alg1.l19.m1.6.6.1.1.1.3.2.2" xref="alg1.l19.m1.6.6.1.1.1.3.1.cmml">,</mo><mi id="alg1.l19.m1.2.2" xref="alg1.l19.m1.2.2.cmml">s</mi><mo id="alg1.l19.m1.6.6.1.1.1.3.2.3" stretchy="false" xref="alg1.l19.m1.6.6.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="alg1.l19.m1.6.6.1.1.5" xref="alg1.l19.m1.6.6.1.2.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="alg1.l19.m1.5.5" xref="alg1.l19.m1.5.5a.cmml">y</mtext><mo id="alg1.l19.m1.6.6.1.1.6" stretchy="false" xref="alg1.l19.m1.6.6.1.2.cmml">)</mo></mrow><mo id="alg1.l19.m1.6.6.2" stretchy="false" xref="alg1.l19.m1.6.6.2.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l19.m1.6.6.3" xref="alg1.l19.m1.6.6.3.cmml">ℬ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.6b"><apply id="alg1.l19.m1.6.6.cmml" xref="alg1.l19.m1.6.6"><ci id="alg1.l19.m1.6.6.2.cmml" xref="alg1.l19.m1.6.6.2">→</ci><vector id="alg1.l19.m1.6.6.1.2.cmml" xref="alg1.l19.m1.6.6.1.1"><ci id="alg1.l19.m1.3.3.cmml" xref="alg1.l19.m1.3.3">𝑢</ci><ci id="alg1.l19.m1.4.4.cmml" xref="alg1.l19.m1.4.4">𝑠</ci><apply id="alg1.l19.m1.6.6.1.1.1.cmml" xref="alg1.l19.m1.6.6.1.1.1"><times id="alg1.l19.m1.6.6.1.1.1.1.cmml" xref="alg1.l19.m1.6.6.1.1.1.1"></times><apply id="alg1.l19.m1.6.6.1.1.1.2.cmml" xref="alg1.l19.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l19.m1.6.6.1.1.1.2.1.cmml" xref="alg1.l19.m1.6.6.1.1.1.2">subscript</csymbol><ci id="alg1.l19.m1.6.6.1.1.1.2.2.cmml" xref="alg1.l19.m1.6.6.1.1.1.2.2">𝑅</ci><ci id="alg1.l19.m1.6.6.1.1.1.2.3.cmml" xref="alg1.l19.m1.6.6.1.1.1.2.3">𝑙</ci></apply><interval closure="open" id="alg1.l19.m1.6.6.1.1.1.3.1.cmml" xref="alg1.l19.m1.6.6.1.1.1.3.2"><ci id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">𝑢</ci><ci id="alg1.l19.m1.2.2.cmml" xref="alg1.l19.m1.2.2">𝑠</ci></interval></apply><ci id="alg1.l19.m1.5.5a.cmml" xref="alg1.l19.m1.5.5"><mtext class="ltx_mathvariant_bold" id="alg1.l19.m1.5.5.cmml" xref="alg1.l19.m1.5.5">y</mtext></ci></vector><ci id="alg1.l19.m1.6.6.3.cmml" xref="alg1.l19.m1.6.6.3">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.6c">(u,s,R_{l}(u,s),\textbf{y})\rightarrow\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.6d">( italic_u , italic_s , italic_R start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ( italic_u , italic_s ) , y ) → caligraphic_B</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l20.1.1.1" style="font-size:80%;">20:</span></span>     Calculate flow estimator <math alttext="\mathcal{F}(s^{t};\phi)" class="ltx_Math" display="inline" id="alg1.l20.m1.2"><semantics id="alg1.l20.m1.2a"><mrow id="alg1.l20.m1.2.2" xref="alg1.l20.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l20.m1.2.2.3" xref="alg1.l20.m1.2.2.3.cmml">ℱ</mi><mo id="alg1.l20.m1.2.2.2" xref="alg1.l20.m1.2.2.2.cmml">⁢</mo><mrow id="alg1.l20.m1.2.2.1.1" xref="alg1.l20.m1.2.2.1.2.cmml"><mo id="alg1.l20.m1.2.2.1.1.2" stretchy="false" xref="alg1.l20.m1.2.2.1.2.cmml">(</mo><msup id="alg1.l20.m1.2.2.1.1.1" xref="alg1.l20.m1.2.2.1.1.1.cmml"><mi id="alg1.l20.m1.2.2.1.1.1.2" xref="alg1.l20.m1.2.2.1.1.1.2.cmml">s</mi><mi id="alg1.l20.m1.2.2.1.1.1.3" xref="alg1.l20.m1.2.2.1.1.1.3.cmml">t</mi></msup><mo id="alg1.l20.m1.2.2.1.1.3" xref="alg1.l20.m1.2.2.1.2.cmml">;</mo><mi id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml">ϕ</mi><mo id="alg1.l20.m1.2.2.1.1.4" stretchy="false" xref="alg1.l20.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.2b"><apply id="alg1.l20.m1.2.2.cmml" xref="alg1.l20.m1.2.2"><times id="alg1.l20.m1.2.2.2.cmml" xref="alg1.l20.m1.2.2.2"></times><ci id="alg1.l20.m1.2.2.3.cmml" xref="alg1.l20.m1.2.2.3">ℱ</ci><list id="alg1.l20.m1.2.2.1.2.cmml" xref="alg1.l20.m1.2.2.1.1"><apply id="alg1.l20.m1.2.2.1.1.1.cmml" xref="alg1.l20.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m1.2.2.1.1.1.1.cmml" xref="alg1.l20.m1.2.2.1.1.1">superscript</csymbol><ci id="alg1.l20.m1.2.2.1.1.1.2.cmml" xref="alg1.l20.m1.2.2.1.1.1.2">𝑠</ci><ci id="alg1.l20.m1.2.2.1.1.1.3.cmml" xref="alg1.l20.m1.2.2.1.1.1.3">𝑡</ci></apply><ci id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1">italic-ϕ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.2c">\mathcal{F}(s^{t};\phi)</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m1.2d">caligraphic_F ( italic_s start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ; italic_ϕ )</annotation></semantics></math>, forward estimator <math alttext="P_{F}(a_{t}|u,s^{t-1};\theta_{1})" class="ltx_Math" display="inline" id="alg1.l20.m2.2"><semantics id="alg1.l20.m2.2a"><mrow id="alg1.l20.m2.2.2" xref="alg1.l20.m2.2.2.cmml"><msub id="alg1.l20.m2.2.2.3" xref="alg1.l20.m2.2.2.3.cmml"><mi id="alg1.l20.m2.2.2.3.2" xref="alg1.l20.m2.2.2.3.2.cmml">P</mi><mi id="alg1.l20.m2.2.2.3.3" xref="alg1.l20.m2.2.2.3.3.cmml">F</mi></msub><mo id="alg1.l20.m2.2.2.2" xref="alg1.l20.m2.2.2.2.cmml">⁢</mo><mrow id="alg1.l20.m2.2.2.1.1" xref="alg1.l20.m2.2.2.1.1.1.cmml"><mo id="alg1.l20.m2.2.2.1.1.2" stretchy="false" xref="alg1.l20.m2.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l20.m2.2.2.1.1.1" xref="alg1.l20.m2.2.2.1.1.1.cmml"><msub id="alg1.l20.m2.2.2.1.1.1.4" xref="alg1.l20.m2.2.2.1.1.1.4.cmml"><mi id="alg1.l20.m2.2.2.1.1.1.4.2" xref="alg1.l20.m2.2.2.1.1.1.4.2.cmml">a</mi><mi id="alg1.l20.m2.2.2.1.1.1.4.3" xref="alg1.l20.m2.2.2.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="alg1.l20.m2.2.2.1.1.1.3" xref="alg1.l20.m2.2.2.1.1.1.3.cmml">|</mo><mrow id="alg1.l20.m2.2.2.1.1.1.2.2" xref="alg1.l20.m2.2.2.1.1.1.2.3.cmml"><mi id="alg1.l20.m2.1.1" xref="alg1.l20.m2.1.1.cmml">u</mi><mo id="alg1.l20.m2.2.2.1.1.1.2.2.3" xref="alg1.l20.m2.2.2.1.1.1.2.3.cmml">,</mo><msup id="alg1.l20.m2.2.2.1.1.1.1.1.1" xref="alg1.l20.m2.2.2.1.1.1.1.1.1.cmml"><mi id="alg1.l20.m2.2.2.1.1.1.1.1.1.2" xref="alg1.l20.m2.2.2.1.1.1.1.1.1.2.cmml">s</mi><mrow id="alg1.l20.m2.2.2.1.1.1.1.1.1.3" xref="alg1.l20.m2.2.2.1.1.1.1.1.1.3.cmml"><mi id="alg1.l20.m2.2.2.1.1.1.1.1.1.3.2" xref="alg1.l20.m2.2.2.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l20.m2.2.2.1.1.1.1.1.1.3.1" xref="alg1.l20.m2.2.2.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg1.l20.m2.2.2.1.1.1.1.1.1.3.3" xref="alg1.l20.m2.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="alg1.l20.m2.2.2.1.1.1.2.2.4" xref="alg1.l20.m2.2.2.1.1.1.2.3.cmml">;</mo><msub id="alg1.l20.m2.2.2.1.1.1.2.2.2" xref="alg1.l20.m2.2.2.1.1.1.2.2.2.cmml"><mi id="alg1.l20.m2.2.2.1.1.1.2.2.2.2" xref="alg1.l20.m2.2.2.1.1.1.2.2.2.2.cmml">θ</mi><mn id="alg1.l20.m2.2.2.1.1.1.2.2.2.3" xref="alg1.l20.m2.2.2.1.1.1.2.2.2.3.cmml">1</mn></msub></mrow></mrow><mo id="alg1.l20.m2.2.2.1.1.3" stretchy="false" xref="alg1.l20.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m2.2b"><apply id="alg1.l20.m2.2.2.cmml" xref="alg1.l20.m2.2.2"><times id="alg1.l20.m2.2.2.2.cmml" xref="alg1.l20.m2.2.2.2"></times><apply id="alg1.l20.m2.2.2.3.cmml" xref="alg1.l20.m2.2.2.3"><csymbol cd="ambiguous" id="alg1.l20.m2.2.2.3.1.cmml" xref="alg1.l20.m2.2.2.3">subscript</csymbol><ci id="alg1.l20.m2.2.2.3.2.cmml" xref="alg1.l20.m2.2.2.3.2">𝑃</ci><ci id="alg1.l20.m2.2.2.3.3.cmml" xref="alg1.l20.m2.2.2.3.3">𝐹</ci></apply><apply id="alg1.l20.m2.2.2.1.1.1.cmml" xref="alg1.l20.m2.2.2.1.1"><csymbol cd="latexml" id="alg1.l20.m2.2.2.1.1.1.3.cmml" xref="alg1.l20.m2.2.2.1.1.1.3">conditional</csymbol><apply id="alg1.l20.m2.2.2.1.1.1.4.cmml" xref="alg1.l20.m2.2.2.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l20.m2.2.2.1.1.1.4.1.cmml" xref="alg1.l20.m2.2.2.1.1.1.4">subscript</csymbol><ci id="alg1.l20.m2.2.2.1.1.1.4.2.cmml" xref="alg1.l20.m2.2.2.1.1.1.4.2">𝑎</ci><ci id="alg1.l20.m2.2.2.1.1.1.4.3.cmml" xref="alg1.l20.m2.2.2.1.1.1.4.3">𝑡</ci></apply><list id="alg1.l20.m2.2.2.1.1.1.2.3.cmml" xref="alg1.l20.m2.2.2.1.1.1.2.2"><ci id="alg1.l20.m2.1.1.cmml" xref="alg1.l20.m2.1.1">𝑢</ci><apply id="alg1.l20.m2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l20.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m2.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l20.m2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l20.m2.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l20.m2.2.2.1.1.1.1.1.1.2">𝑠</ci><apply id="alg1.l20.m2.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l20.m2.2.2.1.1.1.1.1.1.3"><minus id="alg1.l20.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="alg1.l20.m2.2.2.1.1.1.1.1.1.3.1"></minus><ci id="alg1.l20.m2.2.2.1.1.1.1.1.1.3.2.cmml" xref="alg1.l20.m2.2.2.1.1.1.1.1.1.3.2">𝑡</ci><cn id="alg1.l20.m2.2.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l20.m2.2.2.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l20.m2.2.2.1.1.1.2.2.2.cmml" xref="alg1.l20.m2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l20.m2.2.2.1.1.1.2.2.2.1.cmml" xref="alg1.l20.m2.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l20.m2.2.2.1.1.1.2.2.2.2.cmml" xref="alg1.l20.m2.2.2.1.1.1.2.2.2.2">𝜃</ci><cn id="alg1.l20.m2.2.2.1.1.1.2.2.2.3.cmml" type="integer" xref="alg1.l20.m2.2.2.1.1.1.2.2.2.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m2.2c">P_{F}(a_{t}|u,s^{t-1};\theta_{1})</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m2.2d">italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_u , italic_s start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT ; italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math> and backward estimator <math alttext="P_{B}(s_{t-1}|u,s^{t};\theta_{2})" class="ltx_Math" display="inline" id="alg1.l20.m3.2"><semantics id="alg1.l20.m3.2a"><mrow id="alg1.l20.m3.2.2" xref="alg1.l20.m3.2.2.cmml"><msub id="alg1.l20.m3.2.2.3" xref="alg1.l20.m3.2.2.3.cmml"><mi id="alg1.l20.m3.2.2.3.2" xref="alg1.l20.m3.2.2.3.2.cmml">P</mi><mi id="alg1.l20.m3.2.2.3.3" xref="alg1.l20.m3.2.2.3.3.cmml">B</mi></msub><mo id="alg1.l20.m3.2.2.2" xref="alg1.l20.m3.2.2.2.cmml">⁢</mo><mrow id="alg1.l20.m3.2.2.1.1" xref="alg1.l20.m3.2.2.1.1.1.cmml"><mo id="alg1.l20.m3.2.2.1.1.2" stretchy="false" xref="alg1.l20.m3.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l20.m3.2.2.1.1.1" xref="alg1.l20.m3.2.2.1.1.1.cmml"><msub id="alg1.l20.m3.2.2.1.1.1.4" xref="alg1.l20.m3.2.2.1.1.1.4.cmml"><mi id="alg1.l20.m3.2.2.1.1.1.4.2" xref="alg1.l20.m3.2.2.1.1.1.4.2.cmml">s</mi><mrow id="alg1.l20.m3.2.2.1.1.1.4.3" xref="alg1.l20.m3.2.2.1.1.1.4.3.cmml"><mi id="alg1.l20.m3.2.2.1.1.1.4.3.2" xref="alg1.l20.m3.2.2.1.1.1.4.3.2.cmml">t</mi><mo id="alg1.l20.m3.2.2.1.1.1.4.3.1" xref="alg1.l20.m3.2.2.1.1.1.4.3.1.cmml">−</mo><mn id="alg1.l20.m3.2.2.1.1.1.4.3.3" xref="alg1.l20.m3.2.2.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="alg1.l20.m3.2.2.1.1.1.3" xref="alg1.l20.m3.2.2.1.1.1.3.cmml">|</mo><mrow id="alg1.l20.m3.2.2.1.1.1.2.2" xref="alg1.l20.m3.2.2.1.1.1.2.3.cmml"><mi id="alg1.l20.m3.1.1" xref="alg1.l20.m3.1.1.cmml">u</mi><mo id="alg1.l20.m3.2.2.1.1.1.2.2.3" xref="alg1.l20.m3.2.2.1.1.1.2.3.cmml">,</mo><msup id="alg1.l20.m3.2.2.1.1.1.1.1.1" xref="alg1.l20.m3.2.2.1.1.1.1.1.1.cmml"><mi id="alg1.l20.m3.2.2.1.1.1.1.1.1.2" xref="alg1.l20.m3.2.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="alg1.l20.m3.2.2.1.1.1.1.1.1.3" xref="alg1.l20.m3.2.2.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="alg1.l20.m3.2.2.1.1.1.2.2.4" xref="alg1.l20.m3.2.2.1.1.1.2.3.cmml">;</mo><msub id="alg1.l20.m3.2.2.1.1.1.2.2.2" xref="alg1.l20.m3.2.2.1.1.1.2.2.2.cmml"><mi id="alg1.l20.m3.2.2.1.1.1.2.2.2.2" xref="alg1.l20.m3.2.2.1.1.1.2.2.2.2.cmml">θ</mi><mn id="alg1.l20.m3.2.2.1.1.1.2.2.2.3" xref="alg1.l20.m3.2.2.1.1.1.2.2.2.3.cmml">2</mn></msub></mrow></mrow><mo id="alg1.l20.m3.2.2.1.1.3" stretchy="false" xref="alg1.l20.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m3.2b"><apply id="alg1.l20.m3.2.2.cmml" xref="alg1.l20.m3.2.2"><times id="alg1.l20.m3.2.2.2.cmml" xref="alg1.l20.m3.2.2.2"></times><apply id="alg1.l20.m3.2.2.3.cmml" xref="alg1.l20.m3.2.2.3"><csymbol cd="ambiguous" id="alg1.l20.m3.2.2.3.1.cmml" xref="alg1.l20.m3.2.2.3">subscript</csymbol><ci id="alg1.l20.m3.2.2.3.2.cmml" xref="alg1.l20.m3.2.2.3.2">𝑃</ci><ci id="alg1.l20.m3.2.2.3.3.cmml" xref="alg1.l20.m3.2.2.3.3">𝐵</ci></apply><apply id="alg1.l20.m3.2.2.1.1.1.cmml" xref="alg1.l20.m3.2.2.1.1"><csymbol cd="latexml" id="alg1.l20.m3.2.2.1.1.1.3.cmml" xref="alg1.l20.m3.2.2.1.1.1.3">conditional</csymbol><apply id="alg1.l20.m3.2.2.1.1.1.4.cmml" xref="alg1.l20.m3.2.2.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l20.m3.2.2.1.1.1.4.1.cmml" xref="alg1.l20.m3.2.2.1.1.1.4">subscript</csymbol><ci id="alg1.l20.m3.2.2.1.1.1.4.2.cmml" xref="alg1.l20.m3.2.2.1.1.1.4.2">𝑠</ci><apply id="alg1.l20.m3.2.2.1.1.1.4.3.cmml" xref="alg1.l20.m3.2.2.1.1.1.4.3"><minus id="alg1.l20.m3.2.2.1.1.1.4.3.1.cmml" xref="alg1.l20.m3.2.2.1.1.1.4.3.1"></minus><ci id="alg1.l20.m3.2.2.1.1.1.4.3.2.cmml" xref="alg1.l20.m3.2.2.1.1.1.4.3.2">𝑡</ci><cn id="alg1.l20.m3.2.2.1.1.1.4.3.3.cmml" type="integer" xref="alg1.l20.m3.2.2.1.1.1.4.3.3">1</cn></apply></apply><list id="alg1.l20.m3.2.2.1.1.1.2.3.cmml" xref="alg1.l20.m3.2.2.1.1.1.2.2"><ci id="alg1.l20.m3.1.1.cmml" xref="alg1.l20.m3.1.1">𝑢</ci><apply id="alg1.l20.m3.2.2.1.1.1.1.1.1.cmml" xref="alg1.l20.m3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m3.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l20.m3.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l20.m3.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l20.m3.2.2.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l20.m3.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l20.m3.2.2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l20.m3.2.2.1.1.1.2.2.2.cmml" xref="alg1.l20.m3.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l20.m3.2.2.1.1.1.2.2.2.1.cmml" xref="alg1.l20.m3.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l20.m3.2.2.1.1.1.2.2.2.2.cmml" xref="alg1.l20.m3.2.2.1.1.1.2.2.2.2">𝜃</ci><cn id="alg1.l20.m3.2.2.1.1.1.2.2.2.3.cmml" type="integer" xref="alg1.l20.m3.2.2.1.1.1.2.2.2.3">2</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m3.2c">P_{B}(s_{t-1}|u,s^{t};\theta_{2})</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m3.2d">italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | italic_u , italic_s start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ; italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math> for each generation step <math alttext="t" class="ltx_Math" display="inline" id="alg1.l20.m4.1"><semantics id="alg1.l20.m4.1a"><mi id="alg1.l20.m4.1.1" xref="alg1.l20.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l20.m4.1b"><ci id="alg1.l20.m4.1.1.cmml" xref="alg1.l20.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m4.1d">italic_t</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l21.1.1.1" style="font-size:80%;">21:</span></span>     Update the policy through one step of gradient descent using Adam on the DB loss function <math alttext="\mathcal{L}_{DB}" class="ltx_Math" display="inline" id="alg1.l21.m1.1"><semantics id="alg1.l21.m1.1a"><msub id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml">ℒ</mi><mrow id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml"><mi id="alg1.l21.m1.1.1.3.2" xref="alg1.l21.m1.1.1.3.2.cmml">D</mi><mo id="alg1.l21.m1.1.1.3.1" xref="alg1.l21.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l21.m1.1.1.3.3" xref="alg1.l21.m1.1.1.3.3.cmml">B</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1">subscript</csymbol><ci id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">ℒ</ci><apply id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3"><times id="alg1.l21.m1.1.1.3.1.cmml" xref="alg1.l21.m1.1.1.3.1"></times><ci id="alg1.l21.m1.1.1.3.2.cmml" xref="alg1.l21.m1.1.1.3.2">𝐷</ci><ci id="alg1.l21.m1.1.1.3.3.cmml" xref="alg1.l21.m1.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">\mathcal{L}_{DB}</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_D italic_B end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l22.1.1.1" style="font-size:80%;">22:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l22.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l22.3">while</span>
</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l23.1.1.1" style="font-size:80%;">23:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l23.2">end procedure</span>
</div>
</div>
</figure>
<figure class="ltx_table" id="A2.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4. </span>Hyperparameter Settings and Choices</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A2.T4.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T4.6.7.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A2.T4.6.7.1.1">Dataset</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A2.T4.6.7.1.2">Hyper-parameter</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A2.T4.6.7.1.3">Tuning Range</td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt" id="A2.T4.6.7.1.4">Our Choice</td>
</tr>
<tr class="ltx_tr" id="A2.T4.6.8.2">
<td class="ltx_td ltx_border_r ltx_border_t" id="A2.T4.6.8.2.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A2.T4.6.8.2.2">Number of heads</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A2.T4.6.8.2.3">[2, 4, 6, 8]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="A2.T4.6.8.2.4">4</td>
</tr>
<tr class="ltx_tr" id="A2.T4.6.9.3">
<td class="ltx_td ltx_border_r" id="A2.T4.6.9.3.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.9.3.2">Embedding size</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.9.3.3">[8, 16, 32, 64, 128]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A2.T4.6.9.3.4">32</td>
</tr>
<tr class="ltx_tr" id="A2.T4.6.10.4">
<td class="ltx_td ltx_border_r" id="A2.T4.6.10.4.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.10.4.2">LR for flow estimator</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.10.4.3">[0.00001, 0.00002, 0.0001, 0.0002]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A2.T4.6.10.4.4">0.00002</td>
</tr>
<tr class="ltx_tr" id="A2.T4.6.11.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.11.5.1">KuaiRand-Pure</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.11.5.2">LR for forward estimator</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.11.5.3">[0.00005, 0.0001, 0.0002, 0.001]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A2.T4.6.11.5.4">0.0001</td>
</tr>
<tr class="ltx_tr" id="A2.T4.6.12.6">
<td class="ltx_td ltx_border_r" id="A2.T4.6.12.6.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.12.6.2">Batch size</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.12.6.3">[32, 64, 128, 256]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A2.T4.6.12.6.4">128</td>
</tr>
<tr class="ltx_tr" id="A2.T4.1.1">
<td class="ltx_td ltx_border_r" id="A2.T4.1.1.2"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.1.1.1">Forward offset <math alttext="\beta_{F}" class="ltx_Math" display="inline" id="A2.T4.1.1.1.m1.1"><semantics id="A2.T4.1.1.1.m1.1a"><msub id="A2.T4.1.1.1.m1.1.1" xref="A2.T4.1.1.1.m1.1.1.cmml"><mi id="A2.T4.1.1.1.m1.1.1.2" xref="A2.T4.1.1.1.m1.1.1.2.cmml">β</mi><mi id="A2.T4.1.1.1.m1.1.1.3" xref="A2.T4.1.1.1.m1.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T4.1.1.1.m1.1b"><apply id="A2.T4.1.1.1.m1.1.1.cmml" xref="A2.T4.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T4.1.1.1.m1.1.1.1.cmml" xref="A2.T4.1.1.1.m1.1.1">subscript</csymbol><ci id="A2.T4.1.1.1.m1.1.1.2.cmml" xref="A2.T4.1.1.1.m1.1.1.2">𝛽</ci><ci id="A2.T4.1.1.1.m1.1.1.3.cmml" xref="A2.T4.1.1.1.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.1.1.1.m1.1c">\beta_{F}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.1.1.1.m1.1d">italic_β start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.1.1.3">[0.2, 0.4, 0.6, 0.8, 1.0, 1.2]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A2.T4.1.1.4">1</td>
</tr>
<tr class="ltx_tr" id="A2.T4.2.2">
<td class="ltx_td ltx_border_r" id="A2.T4.2.2.2"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.2.2.1">Backward offset <math alttext="\beta_{B}" class="ltx_Math" display="inline" id="A2.T4.2.2.1.m1.1"><semantics id="A2.T4.2.2.1.m1.1a"><msub id="A2.T4.2.2.1.m1.1.1" xref="A2.T4.2.2.1.m1.1.1.cmml"><mi id="A2.T4.2.2.1.m1.1.1.2" xref="A2.T4.2.2.1.m1.1.1.2.cmml">β</mi><mi id="A2.T4.2.2.1.m1.1.1.3" xref="A2.T4.2.2.1.m1.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T4.2.2.1.m1.1b"><apply id="A2.T4.2.2.1.m1.1.1.cmml" xref="A2.T4.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T4.2.2.1.m1.1.1.1.cmml" xref="A2.T4.2.2.1.m1.1.1">subscript</csymbol><ci id="A2.T4.2.2.1.m1.1.1.2.cmml" xref="A2.T4.2.2.1.m1.1.1.2">𝛽</ci><ci id="A2.T4.2.2.1.m1.1.1.3.cmml" xref="A2.T4.2.2.1.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.2.2.1.m1.1c">\beta_{B}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.2.2.1.m1.1d">italic_β start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.2.2.3">[0.2, 0.4, 0.6, 0.8, 1.0, 1.2]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A2.T4.2.2.4">1</td>
</tr>
<tr class="ltx_tr" id="A2.T4.3.3">
<td class="ltx_td ltx_border_r" id="A2.T4.3.3.2"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.3.3.1">Reward offset <math alttext="\beta_{r}" class="ltx_Math" display="inline" id="A2.T4.3.3.1.m1.1"><semantics id="A2.T4.3.3.1.m1.1a"><msub id="A2.T4.3.3.1.m1.1.1" xref="A2.T4.3.3.1.m1.1.1.cmml"><mi id="A2.T4.3.3.1.m1.1.1.2" xref="A2.T4.3.3.1.m1.1.1.2.cmml">β</mi><mi id="A2.T4.3.3.1.m1.1.1.3" xref="A2.T4.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T4.3.3.1.m1.1b"><apply id="A2.T4.3.3.1.m1.1.1.cmml" xref="A2.T4.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T4.3.3.1.m1.1.1.1.cmml" xref="A2.T4.3.3.1.m1.1.1">subscript</csymbol><ci id="A2.T4.3.3.1.m1.1.1.2.cmml" xref="A2.T4.3.3.1.m1.1.1.2">𝛽</ci><ci id="A2.T4.3.3.1.m1.1.1.3.cmml" xref="A2.T4.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.3.3.1.m1.1c">\beta_{r}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.3.3.1.m1.1d">italic_β start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.3.3.3">[0.2, 0.4, 0.6, 0.8, 1.0, 1.2]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A2.T4.3.3.4">0.5</td>
</tr>
<tr class="ltx_tr" id="A2.T4.6.13.7">
<td class="ltx_td ltx_border_r ltx_border_t" id="A2.T4.6.13.7.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A2.T4.6.13.7.2">LR for flow estimator</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A2.T4.6.13.7.3">[0.0001, 0.0002, 0.0003, 0.001]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="A2.T4.6.13.7.4">0.0003</td>
</tr>
<tr class="ltx_tr" id="A2.T4.6.14.8">
<td class="ltx_td ltx_border_r" id="A2.T4.6.14.8.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.14.8.2">LR for forward estimator</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.14.8.3">[0.0001, 0.0002, 0.001, 0.002]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A2.T4.6.14.8.4">0.001</td>
</tr>
<tr class="ltx_tr" id="A2.T4.6.15.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.15.9.1">MovieLens-1M</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.15.9.2">Batch size</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.6.15.9.3">[32,64,128,256]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A2.T4.6.15.9.4">64</td>
</tr>
<tr class="ltx_tr" id="A2.T4.4.4">
<td class="ltx_td ltx_border_r" id="A2.T4.4.4.2"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.4.4.1">Forward offset <math alttext="\beta_{F}" class="ltx_Math" display="inline" id="A2.T4.4.4.1.m1.1"><semantics id="A2.T4.4.4.1.m1.1a"><msub id="A2.T4.4.4.1.m1.1.1" xref="A2.T4.4.4.1.m1.1.1.cmml"><mi id="A2.T4.4.4.1.m1.1.1.2" xref="A2.T4.4.4.1.m1.1.1.2.cmml">β</mi><mi id="A2.T4.4.4.1.m1.1.1.3" xref="A2.T4.4.4.1.m1.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T4.4.4.1.m1.1b"><apply id="A2.T4.4.4.1.m1.1.1.cmml" xref="A2.T4.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T4.4.4.1.m1.1.1.1.cmml" xref="A2.T4.4.4.1.m1.1.1">subscript</csymbol><ci id="A2.T4.4.4.1.m1.1.1.2.cmml" xref="A2.T4.4.4.1.m1.1.1.2">𝛽</ci><ci id="A2.T4.4.4.1.m1.1.1.3.cmml" xref="A2.T4.4.4.1.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.4.4.1.m1.1c">\beta_{F}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.4.4.1.m1.1d">italic_β start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.4.4.3">[0.2, 0.4, 0.6, 0.8, 1.0, 1.2]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A2.T4.4.4.4">0.8</td>
</tr>
<tr class="ltx_tr" id="A2.T4.5.5">
<td class="ltx_td ltx_border_r" id="A2.T4.5.5.2"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.5.5.1">Backward offset <math alttext="\beta_{B}" class="ltx_Math" display="inline" id="A2.T4.5.5.1.m1.1"><semantics id="A2.T4.5.5.1.m1.1a"><msub id="A2.T4.5.5.1.m1.1.1" xref="A2.T4.5.5.1.m1.1.1.cmml"><mi id="A2.T4.5.5.1.m1.1.1.2" xref="A2.T4.5.5.1.m1.1.1.2.cmml">β</mi><mi id="A2.T4.5.5.1.m1.1.1.3" xref="A2.T4.5.5.1.m1.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T4.5.5.1.m1.1b"><apply id="A2.T4.5.5.1.m1.1.1.cmml" xref="A2.T4.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T4.5.5.1.m1.1.1.1.cmml" xref="A2.T4.5.5.1.m1.1.1">subscript</csymbol><ci id="A2.T4.5.5.1.m1.1.1.2.cmml" xref="A2.T4.5.5.1.m1.1.1.2">𝛽</ci><ci id="A2.T4.5.5.1.m1.1.1.3.cmml" xref="A2.T4.5.5.1.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.5.5.1.m1.1c">\beta_{B}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.5.5.1.m1.1d">italic_β start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T4.5.5.3">[0.2, 0.4, 0.6, 0.8, 1.0, 1.2]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A2.T4.5.5.4">0.8</td>
</tr>
<tr class="ltx_tr" id="A2.T4.6.6">
<td class="ltx_td ltx_border_bb ltx_border_r" id="A2.T4.6.6.2"></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="A2.T4.6.6.1">Reward offset <math alttext="\beta_{r}" class="ltx_Math" display="inline" id="A2.T4.6.6.1.m1.1"><semantics id="A2.T4.6.6.1.m1.1a"><msub id="A2.T4.6.6.1.m1.1.1" xref="A2.T4.6.6.1.m1.1.1.cmml"><mi id="A2.T4.6.6.1.m1.1.1.2" xref="A2.T4.6.6.1.m1.1.1.2.cmml">β</mi><mi id="A2.T4.6.6.1.m1.1.1.3" xref="A2.T4.6.6.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T4.6.6.1.m1.1b"><apply id="A2.T4.6.6.1.m1.1.1.cmml" xref="A2.T4.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T4.6.6.1.m1.1.1.1.cmml" xref="A2.T4.6.6.1.m1.1.1">subscript</csymbol><ci id="A2.T4.6.6.1.m1.1.1.2.cmml" xref="A2.T4.6.6.1.m1.1.1.2">𝛽</ci><ci id="A2.T4.6.6.1.m1.1.1.3.cmml" xref="A2.T4.6.6.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T4.6.6.1.m1.1c">\beta_{r}</annotation><annotation encoding="application/x-llamapun" id="A2.T4.6.6.1.m1.1d">italic_β start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="A2.T4.6.6.3">[0.2, 0.4, 0.6, 0.8, 1.0, 1.2]</td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" id="A2.T4.6.6.4">0.5</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>HYPER-PARAMETER SELECTION</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">In our study, we meticulously tuned the hyperparameters of the GFN4Retention model to reinforce the reliability of our experimental outcomes. The summarized performance metrics, spanning two datasets, are documented for detailed examination in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.06043v1#A2.T4" title="Table 4 ‣ Appendix B ALGORITHM ‣ Modeling User Retention through Generative Flow Networks"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Probablistic Flow in Continuous Space</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.7">For a given state, the flow estimator <math alttext="\mathcal{F}(s_{t})" class="ltx_Math" display="inline" id="A4.p1.1.m1.1"><semantics id="A4.p1.1.m1.1a"><mrow id="A4.p1.1.m1.1.1" xref="A4.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.1.m1.1.1.3" xref="A4.p1.1.m1.1.1.3.cmml">ℱ</mi><mo id="A4.p1.1.m1.1.1.2" xref="A4.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="A4.p1.1.m1.1.1.1.1" xref="A4.p1.1.m1.1.1.1.1.1.cmml"><mo id="A4.p1.1.m1.1.1.1.1.2" stretchy="false" xref="A4.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="A4.p1.1.m1.1.1.1.1.1" xref="A4.p1.1.m1.1.1.1.1.1.cmml"><mi id="A4.p1.1.m1.1.1.1.1.1.2" xref="A4.p1.1.m1.1.1.1.1.1.2.cmml">s</mi><mi id="A4.p1.1.m1.1.1.1.1.1.3" xref="A4.p1.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A4.p1.1.m1.1.1.1.1.3" stretchy="false" xref="A4.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.1.m1.1b"><apply id="A4.p1.1.m1.1.1.cmml" xref="A4.p1.1.m1.1.1"><times id="A4.p1.1.m1.1.1.2.cmml" xref="A4.p1.1.m1.1.1.2"></times><ci id="A4.p1.1.m1.1.1.3.cmml" xref="A4.p1.1.m1.1.1.3">ℱ</ci><apply id="A4.p1.1.m1.1.1.1.1.1.cmml" xref="A4.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A4.p1.1.m1.1.1.1.1.1.1.cmml" xref="A4.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="A4.p1.1.m1.1.1.1.1.1.2.cmml" xref="A4.p1.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="A4.p1.1.m1.1.1.1.1.1.3.cmml" xref="A4.p1.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.1.m1.1c">\mathcal{F}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="A4.p1.1.m1.1d">caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> represents the generation likelihood of reaching that particular state.
Without loss of generality, assume each sample consists of the transition information between the current state <math alttext="s_{t}=x_{1}" class="ltx_Math" display="inline" id="A4.p1.2.m2.1"><semantics id="A4.p1.2.m2.1a"><mrow id="A4.p1.2.m2.1.1" xref="A4.p1.2.m2.1.1.cmml"><msub id="A4.p1.2.m2.1.1.2" xref="A4.p1.2.m2.1.1.2.cmml"><mi id="A4.p1.2.m2.1.1.2.2" xref="A4.p1.2.m2.1.1.2.2.cmml">s</mi><mi id="A4.p1.2.m2.1.1.2.3" xref="A4.p1.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="A4.p1.2.m2.1.1.1" xref="A4.p1.2.m2.1.1.1.cmml">=</mo><msub id="A4.p1.2.m2.1.1.3" xref="A4.p1.2.m2.1.1.3.cmml"><mi id="A4.p1.2.m2.1.1.3.2" xref="A4.p1.2.m2.1.1.3.2.cmml">x</mi><mn id="A4.p1.2.m2.1.1.3.3" xref="A4.p1.2.m2.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.2.m2.1b"><apply id="A4.p1.2.m2.1.1.cmml" xref="A4.p1.2.m2.1.1"><eq id="A4.p1.2.m2.1.1.1.cmml" xref="A4.p1.2.m2.1.1.1"></eq><apply id="A4.p1.2.m2.1.1.2.cmml" xref="A4.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A4.p1.2.m2.1.1.2.1.cmml" xref="A4.p1.2.m2.1.1.2">subscript</csymbol><ci id="A4.p1.2.m2.1.1.2.2.cmml" xref="A4.p1.2.m2.1.1.2.2">𝑠</ci><ci id="A4.p1.2.m2.1.1.2.3.cmml" xref="A4.p1.2.m2.1.1.2.3">𝑡</ci></apply><apply id="A4.p1.2.m2.1.1.3.cmml" xref="A4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A4.p1.2.m2.1.1.3.1.cmml" xref="A4.p1.2.m2.1.1.3">subscript</csymbol><ci id="A4.p1.2.m2.1.1.3.2.cmml" xref="A4.p1.2.m2.1.1.3.2">𝑥</ci><cn id="A4.p1.2.m2.1.1.3.3.cmml" type="integer" xref="A4.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.2.m2.1c">s_{t}=x_{1}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and the next state <math alttext="s_{t+1}=y" class="ltx_Math" display="inline" id="A4.p1.3.m3.1"><semantics id="A4.p1.3.m3.1a"><mrow id="A4.p1.3.m3.1.1" xref="A4.p1.3.m3.1.1.cmml"><msub id="A4.p1.3.m3.1.1.2" xref="A4.p1.3.m3.1.1.2.cmml"><mi id="A4.p1.3.m3.1.1.2.2" xref="A4.p1.3.m3.1.1.2.2.cmml">s</mi><mrow id="A4.p1.3.m3.1.1.2.3" xref="A4.p1.3.m3.1.1.2.3.cmml"><mi id="A4.p1.3.m3.1.1.2.3.2" xref="A4.p1.3.m3.1.1.2.3.2.cmml">t</mi><mo id="A4.p1.3.m3.1.1.2.3.1" xref="A4.p1.3.m3.1.1.2.3.1.cmml">+</mo><mn id="A4.p1.3.m3.1.1.2.3.3" xref="A4.p1.3.m3.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="A4.p1.3.m3.1.1.1" xref="A4.p1.3.m3.1.1.1.cmml">=</mo><mi id="A4.p1.3.m3.1.1.3" xref="A4.p1.3.m3.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.3.m3.1b"><apply id="A4.p1.3.m3.1.1.cmml" xref="A4.p1.3.m3.1.1"><eq id="A4.p1.3.m3.1.1.1.cmml" xref="A4.p1.3.m3.1.1.1"></eq><apply id="A4.p1.3.m3.1.1.2.cmml" xref="A4.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A4.p1.3.m3.1.1.2.1.cmml" xref="A4.p1.3.m3.1.1.2">subscript</csymbol><ci id="A4.p1.3.m3.1.1.2.2.cmml" xref="A4.p1.3.m3.1.1.2.2">𝑠</ci><apply id="A4.p1.3.m3.1.1.2.3.cmml" xref="A4.p1.3.m3.1.1.2.3"><plus id="A4.p1.3.m3.1.1.2.3.1.cmml" xref="A4.p1.3.m3.1.1.2.3.1"></plus><ci id="A4.p1.3.m3.1.1.2.3.2.cmml" xref="A4.p1.3.m3.1.1.2.3.2">𝑡</ci><cn id="A4.p1.3.m3.1.1.2.3.3.cmml" type="integer" xref="A4.p1.3.m3.1.1.2.3.3">1</cn></apply></apply><ci id="A4.p1.3.m3.1.1.3.cmml" xref="A4.p1.3.m3.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.3.m3.1c">s_{t+1}=y</annotation><annotation encoding="application/x-llamapun" id="A4.p1.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = italic_y</annotation></semantics></math>.
The sampled action is denoted as <math alttext="a_{t}=z" class="ltx_Math" display="inline" id="A4.p1.4.m4.1"><semantics id="A4.p1.4.m4.1a"><mrow id="A4.p1.4.m4.1.1" xref="A4.p1.4.m4.1.1.cmml"><msub id="A4.p1.4.m4.1.1.2" xref="A4.p1.4.m4.1.1.2.cmml"><mi id="A4.p1.4.m4.1.1.2.2" xref="A4.p1.4.m4.1.1.2.2.cmml">a</mi><mi id="A4.p1.4.m4.1.1.2.3" xref="A4.p1.4.m4.1.1.2.3.cmml">t</mi></msub><mo id="A4.p1.4.m4.1.1.1" xref="A4.p1.4.m4.1.1.1.cmml">=</mo><mi id="A4.p1.4.m4.1.1.3" xref="A4.p1.4.m4.1.1.3.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.4.m4.1b"><apply id="A4.p1.4.m4.1.1.cmml" xref="A4.p1.4.m4.1.1"><eq id="A4.p1.4.m4.1.1.1.cmml" xref="A4.p1.4.m4.1.1.1"></eq><apply id="A4.p1.4.m4.1.1.2.cmml" xref="A4.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="A4.p1.4.m4.1.1.2.1.cmml" xref="A4.p1.4.m4.1.1.2">subscript</csymbol><ci id="A4.p1.4.m4.1.1.2.2.cmml" xref="A4.p1.4.m4.1.1.2.2">𝑎</ci><ci id="A4.p1.4.m4.1.1.2.3.cmml" xref="A4.p1.4.m4.1.1.2.3">𝑡</ci></apply><ci id="A4.p1.4.m4.1.1.3.cmml" xref="A4.p1.4.m4.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.4.m4.1c">a_{t}=z</annotation><annotation encoding="application/x-llamapun" id="A4.p1.4.m4.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_z</annotation></semantics></math>.
Our forward function is associated with a Gaussian actor <math alttext="\mu,\sigma=\phi_{\mathrm{fw}}" class="ltx_Math" display="inline" id="A4.p1.5.m5.2"><semantics id="A4.p1.5.m5.2a"><mrow id="A4.p1.5.m5.2.3" xref="A4.p1.5.m5.2.3.cmml"><mrow id="A4.p1.5.m5.2.3.2.2" xref="A4.p1.5.m5.2.3.2.1.cmml"><mi id="A4.p1.5.m5.1.1" xref="A4.p1.5.m5.1.1.cmml">μ</mi><mo id="A4.p1.5.m5.2.3.2.2.1" xref="A4.p1.5.m5.2.3.2.1.cmml">,</mo><mi id="A4.p1.5.m5.2.2" xref="A4.p1.5.m5.2.2.cmml">σ</mi></mrow><mo id="A4.p1.5.m5.2.3.1" xref="A4.p1.5.m5.2.3.1.cmml">=</mo><msub id="A4.p1.5.m5.2.3.3" xref="A4.p1.5.m5.2.3.3.cmml"><mi id="A4.p1.5.m5.2.3.3.2" xref="A4.p1.5.m5.2.3.3.2.cmml">ϕ</mi><mi id="A4.p1.5.m5.2.3.3.3" xref="A4.p1.5.m5.2.3.3.3.cmml">fw</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.5.m5.2b"><apply id="A4.p1.5.m5.2.3.cmml" xref="A4.p1.5.m5.2.3"><eq id="A4.p1.5.m5.2.3.1.cmml" xref="A4.p1.5.m5.2.3.1"></eq><list id="A4.p1.5.m5.2.3.2.1.cmml" xref="A4.p1.5.m5.2.3.2.2"><ci id="A4.p1.5.m5.1.1.cmml" xref="A4.p1.5.m5.1.1">𝜇</ci><ci id="A4.p1.5.m5.2.2.cmml" xref="A4.p1.5.m5.2.2">𝜎</ci></list><apply id="A4.p1.5.m5.2.3.3.cmml" xref="A4.p1.5.m5.2.3.3"><csymbol cd="ambiguous" id="A4.p1.5.m5.2.3.3.1.cmml" xref="A4.p1.5.m5.2.3.3">subscript</csymbol><ci id="A4.p1.5.m5.2.3.3.2.cmml" xref="A4.p1.5.m5.2.3.3.2">italic-ϕ</ci><ci id="A4.p1.5.m5.2.3.3.3.cmml" xref="A4.p1.5.m5.2.3.3.3">fw</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.5.m5.2c">\mu,\sigma=\phi_{\mathrm{fw}}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.5.m5.2d">italic_μ , italic_σ = italic_ϕ start_POSTSUBSCRIPT roman_fw end_POSTSUBSCRIPT</annotation></semantics></math> where corresponding action distribution follows <math alttext="a_{t}\sim\mathcal{N}(\mu,\sigma)\mathcal{F}(s_{t}=x_{1})" class="ltx_Math" display="inline" id="A4.p1.6.m6.3"><semantics id="A4.p1.6.m6.3a"><mrow id="A4.p1.6.m6.3.3" xref="A4.p1.6.m6.3.3.cmml"><msub id="A4.p1.6.m6.3.3.3" xref="A4.p1.6.m6.3.3.3.cmml"><mi id="A4.p1.6.m6.3.3.3.2" xref="A4.p1.6.m6.3.3.3.2.cmml">a</mi><mi id="A4.p1.6.m6.3.3.3.3" xref="A4.p1.6.m6.3.3.3.3.cmml">t</mi></msub><mo id="A4.p1.6.m6.3.3.2" xref="A4.p1.6.m6.3.3.2.cmml">∼</mo><mrow id="A4.p1.6.m6.3.3.1" xref="A4.p1.6.m6.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.p1.6.m6.3.3.1.3" xref="A4.p1.6.m6.3.3.1.3.cmml">𝒩</mi><mo id="A4.p1.6.m6.3.3.1.2" xref="A4.p1.6.m6.3.3.1.2.cmml">⁢</mo><mrow id="A4.p1.6.m6.3.3.1.4.2" xref="A4.p1.6.m6.3.3.1.4.1.cmml"><mo id="A4.p1.6.m6.3.3.1.4.2.1" stretchy="false" xref="A4.p1.6.m6.3.3.1.4.1.cmml">(</mo><mi id="A4.p1.6.m6.1.1" xref="A4.p1.6.m6.1.1.cmml">μ</mi><mo id="A4.p1.6.m6.3.3.1.4.2.2" xref="A4.p1.6.m6.3.3.1.4.1.cmml">,</mo><mi id="A4.p1.6.m6.2.2" xref="A4.p1.6.m6.2.2.cmml">σ</mi><mo id="A4.p1.6.m6.3.3.1.4.2.3" stretchy="false" xref="A4.p1.6.m6.3.3.1.4.1.cmml">)</mo></mrow><mo id="A4.p1.6.m6.3.3.1.2a" xref="A4.p1.6.m6.3.3.1.2.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.p1.6.m6.3.3.1.5" xref="A4.p1.6.m6.3.3.1.5.cmml">ℱ</mi><mo id="A4.p1.6.m6.3.3.1.2b" xref="A4.p1.6.m6.3.3.1.2.cmml">⁢</mo><mrow id="A4.p1.6.m6.3.3.1.1.1" xref="A4.p1.6.m6.3.3.1.1.1.1.cmml"><mo id="A4.p1.6.m6.3.3.1.1.1.2" stretchy="false" xref="A4.p1.6.m6.3.3.1.1.1.1.cmml">(</mo><mrow id="A4.p1.6.m6.3.3.1.1.1.1" xref="A4.p1.6.m6.3.3.1.1.1.1.cmml"><msub id="A4.p1.6.m6.3.3.1.1.1.1.2" xref="A4.p1.6.m6.3.3.1.1.1.1.2.cmml"><mi id="A4.p1.6.m6.3.3.1.1.1.1.2.2" xref="A4.p1.6.m6.3.3.1.1.1.1.2.2.cmml">s</mi><mi id="A4.p1.6.m6.3.3.1.1.1.1.2.3" xref="A4.p1.6.m6.3.3.1.1.1.1.2.3.cmml">t</mi></msub><mo id="A4.p1.6.m6.3.3.1.1.1.1.1" xref="A4.p1.6.m6.3.3.1.1.1.1.1.cmml">=</mo><msub id="A4.p1.6.m6.3.3.1.1.1.1.3" xref="A4.p1.6.m6.3.3.1.1.1.1.3.cmml"><mi id="A4.p1.6.m6.3.3.1.1.1.1.3.2" xref="A4.p1.6.m6.3.3.1.1.1.1.3.2.cmml">x</mi><mn id="A4.p1.6.m6.3.3.1.1.1.1.3.3" xref="A4.p1.6.m6.3.3.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="A4.p1.6.m6.3.3.1.1.1.3" stretchy="false" xref="A4.p1.6.m6.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.6.m6.3b"><apply id="A4.p1.6.m6.3.3.cmml" xref="A4.p1.6.m6.3.3"><csymbol cd="latexml" id="A4.p1.6.m6.3.3.2.cmml" xref="A4.p1.6.m6.3.3.2">similar-to</csymbol><apply id="A4.p1.6.m6.3.3.3.cmml" xref="A4.p1.6.m6.3.3.3"><csymbol cd="ambiguous" id="A4.p1.6.m6.3.3.3.1.cmml" xref="A4.p1.6.m6.3.3.3">subscript</csymbol><ci id="A4.p1.6.m6.3.3.3.2.cmml" xref="A4.p1.6.m6.3.3.3.2">𝑎</ci><ci id="A4.p1.6.m6.3.3.3.3.cmml" xref="A4.p1.6.m6.3.3.3.3">𝑡</ci></apply><apply id="A4.p1.6.m6.3.3.1.cmml" xref="A4.p1.6.m6.3.3.1"><times id="A4.p1.6.m6.3.3.1.2.cmml" xref="A4.p1.6.m6.3.3.1.2"></times><ci id="A4.p1.6.m6.3.3.1.3.cmml" xref="A4.p1.6.m6.3.3.1.3">𝒩</ci><interval closure="open" id="A4.p1.6.m6.3.3.1.4.1.cmml" xref="A4.p1.6.m6.3.3.1.4.2"><ci id="A4.p1.6.m6.1.1.cmml" xref="A4.p1.6.m6.1.1">𝜇</ci><ci id="A4.p1.6.m6.2.2.cmml" xref="A4.p1.6.m6.2.2">𝜎</ci></interval><ci id="A4.p1.6.m6.3.3.1.5.cmml" xref="A4.p1.6.m6.3.3.1.5">ℱ</ci><apply id="A4.p1.6.m6.3.3.1.1.1.1.cmml" xref="A4.p1.6.m6.3.3.1.1.1"><eq id="A4.p1.6.m6.3.3.1.1.1.1.1.cmml" xref="A4.p1.6.m6.3.3.1.1.1.1.1"></eq><apply id="A4.p1.6.m6.3.3.1.1.1.1.2.cmml" xref="A4.p1.6.m6.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.p1.6.m6.3.3.1.1.1.1.2.1.cmml" xref="A4.p1.6.m6.3.3.1.1.1.1.2">subscript</csymbol><ci id="A4.p1.6.m6.3.3.1.1.1.1.2.2.cmml" xref="A4.p1.6.m6.3.3.1.1.1.1.2.2">𝑠</ci><ci id="A4.p1.6.m6.3.3.1.1.1.1.2.3.cmml" xref="A4.p1.6.m6.3.3.1.1.1.1.2.3">𝑡</ci></apply><apply id="A4.p1.6.m6.3.3.1.1.1.1.3.cmml" xref="A4.p1.6.m6.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.p1.6.m6.3.3.1.1.1.1.3.1.cmml" xref="A4.p1.6.m6.3.3.1.1.1.1.3">subscript</csymbol><ci id="A4.p1.6.m6.3.3.1.1.1.1.3.2.cmml" xref="A4.p1.6.m6.3.3.1.1.1.1.3.2">𝑥</ci><cn id="A4.p1.6.m6.3.3.1.1.1.1.3.3.cmml" type="integer" xref="A4.p1.6.m6.3.3.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.6.m6.3c">a_{t}\sim\mathcal{N}(\mu,\sigma)\mathcal{F}(s_{t}=x_{1})</annotation><annotation encoding="application/x-llamapun" id="A4.p1.6.m6.3d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ caligraphic_N ( italic_μ , italic_σ ) caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math>.
Then the forward function for the observed transition is <math alttext="P_{F}(s_{t+1}|s_{t})=P(a_{t}=z)" class="ltx_Math" display="inline" id="A4.p1.7.m7.2"><semantics id="A4.p1.7.m7.2a"><mrow id="A4.p1.7.m7.2.2" xref="A4.p1.7.m7.2.2.cmml"><mrow id="A4.p1.7.m7.1.1.1" xref="A4.p1.7.m7.1.1.1.cmml"><msub id="A4.p1.7.m7.1.1.1.3" xref="A4.p1.7.m7.1.1.1.3.cmml"><mi id="A4.p1.7.m7.1.1.1.3.2" xref="A4.p1.7.m7.1.1.1.3.2.cmml">P</mi><mi id="A4.p1.7.m7.1.1.1.3.3" xref="A4.p1.7.m7.1.1.1.3.3.cmml">F</mi></msub><mo id="A4.p1.7.m7.1.1.1.2" xref="A4.p1.7.m7.1.1.1.2.cmml">⁢</mo><mrow id="A4.p1.7.m7.1.1.1.1.1" xref="A4.p1.7.m7.1.1.1.1.1.1.cmml"><mo id="A4.p1.7.m7.1.1.1.1.1.2" stretchy="false" xref="A4.p1.7.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.p1.7.m7.1.1.1.1.1.1" xref="A4.p1.7.m7.1.1.1.1.1.1.cmml"><msub id="A4.p1.7.m7.1.1.1.1.1.1.2" xref="A4.p1.7.m7.1.1.1.1.1.1.2.cmml"><mi id="A4.p1.7.m7.1.1.1.1.1.1.2.2" xref="A4.p1.7.m7.1.1.1.1.1.1.2.2.cmml">s</mi><mrow id="A4.p1.7.m7.1.1.1.1.1.1.2.3" xref="A4.p1.7.m7.1.1.1.1.1.1.2.3.cmml"><mi id="A4.p1.7.m7.1.1.1.1.1.1.2.3.2" xref="A4.p1.7.m7.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A4.p1.7.m7.1.1.1.1.1.1.2.3.1" xref="A4.p1.7.m7.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="A4.p1.7.m7.1.1.1.1.1.1.2.3.3" xref="A4.p1.7.m7.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A4.p1.7.m7.1.1.1.1.1.1.1" xref="A4.p1.7.m7.1.1.1.1.1.1.1.cmml">|</mo><msub id="A4.p1.7.m7.1.1.1.1.1.1.3" xref="A4.p1.7.m7.1.1.1.1.1.1.3.cmml"><mi id="A4.p1.7.m7.1.1.1.1.1.1.3.2" xref="A4.p1.7.m7.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="A4.p1.7.m7.1.1.1.1.1.1.3.3" xref="A4.p1.7.m7.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A4.p1.7.m7.1.1.1.1.1.3" stretchy="false" xref="A4.p1.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.p1.7.m7.2.2.3" xref="A4.p1.7.m7.2.2.3.cmml">=</mo><mrow id="A4.p1.7.m7.2.2.2" xref="A4.p1.7.m7.2.2.2.cmml"><mi id="A4.p1.7.m7.2.2.2.3" xref="A4.p1.7.m7.2.2.2.3.cmml">P</mi><mo id="A4.p1.7.m7.2.2.2.2" xref="A4.p1.7.m7.2.2.2.2.cmml">⁢</mo><mrow id="A4.p1.7.m7.2.2.2.1.1" xref="A4.p1.7.m7.2.2.2.1.1.1.cmml"><mo id="A4.p1.7.m7.2.2.2.1.1.2" stretchy="false" xref="A4.p1.7.m7.2.2.2.1.1.1.cmml">(</mo><mrow id="A4.p1.7.m7.2.2.2.1.1.1" xref="A4.p1.7.m7.2.2.2.1.1.1.cmml"><msub id="A4.p1.7.m7.2.2.2.1.1.1.2" xref="A4.p1.7.m7.2.2.2.1.1.1.2.cmml"><mi id="A4.p1.7.m7.2.2.2.1.1.1.2.2" xref="A4.p1.7.m7.2.2.2.1.1.1.2.2.cmml">a</mi><mi id="A4.p1.7.m7.2.2.2.1.1.1.2.3" xref="A4.p1.7.m7.2.2.2.1.1.1.2.3.cmml">t</mi></msub><mo id="A4.p1.7.m7.2.2.2.1.1.1.1" xref="A4.p1.7.m7.2.2.2.1.1.1.1.cmml">=</mo><mi id="A4.p1.7.m7.2.2.2.1.1.1.3" xref="A4.p1.7.m7.2.2.2.1.1.1.3.cmml">z</mi></mrow><mo id="A4.p1.7.m7.2.2.2.1.1.3" stretchy="false" xref="A4.p1.7.m7.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.7.m7.2b"><apply id="A4.p1.7.m7.2.2.cmml" xref="A4.p1.7.m7.2.2"><eq id="A4.p1.7.m7.2.2.3.cmml" xref="A4.p1.7.m7.2.2.3"></eq><apply id="A4.p1.7.m7.1.1.1.cmml" xref="A4.p1.7.m7.1.1.1"><times id="A4.p1.7.m7.1.1.1.2.cmml" xref="A4.p1.7.m7.1.1.1.2"></times><apply id="A4.p1.7.m7.1.1.1.3.cmml" xref="A4.p1.7.m7.1.1.1.3"><csymbol cd="ambiguous" id="A4.p1.7.m7.1.1.1.3.1.cmml" xref="A4.p1.7.m7.1.1.1.3">subscript</csymbol><ci id="A4.p1.7.m7.1.1.1.3.2.cmml" xref="A4.p1.7.m7.1.1.1.3.2">𝑃</ci><ci id="A4.p1.7.m7.1.1.1.3.3.cmml" xref="A4.p1.7.m7.1.1.1.3.3">𝐹</ci></apply><apply id="A4.p1.7.m7.1.1.1.1.1.1.cmml" xref="A4.p1.7.m7.1.1.1.1.1"><csymbol cd="latexml" id="A4.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.1">conditional</csymbol><apply id="A4.p1.7.m7.1.1.1.1.1.1.2.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.p1.7.m7.1.1.1.1.1.1.2.1.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.p1.7.m7.1.1.1.1.1.1.2.2.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.2.2">𝑠</ci><apply id="A4.p1.7.m7.1.1.1.1.1.1.2.3.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.2.3"><plus id="A4.p1.7.m7.1.1.1.1.1.1.2.3.1.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.2.3.1"></plus><ci id="A4.p1.7.m7.1.1.1.1.1.1.2.3.2.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A4.p1.7.m7.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A4.p1.7.m7.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A4.p1.7.m7.1.1.1.1.1.1.3.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.p1.7.m7.1.1.1.1.1.1.3.1.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.p1.7.m7.1.1.1.1.1.1.3.2.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.3.2">𝑠</ci><ci id="A4.p1.7.m7.1.1.1.1.1.1.3.3.cmml" xref="A4.p1.7.m7.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="A4.p1.7.m7.2.2.2.cmml" xref="A4.p1.7.m7.2.2.2"><times id="A4.p1.7.m7.2.2.2.2.cmml" xref="A4.p1.7.m7.2.2.2.2"></times><ci id="A4.p1.7.m7.2.2.2.3.cmml" xref="A4.p1.7.m7.2.2.2.3">𝑃</ci><apply id="A4.p1.7.m7.2.2.2.1.1.1.cmml" xref="A4.p1.7.m7.2.2.2.1.1"><eq id="A4.p1.7.m7.2.2.2.1.1.1.1.cmml" xref="A4.p1.7.m7.2.2.2.1.1.1.1"></eq><apply id="A4.p1.7.m7.2.2.2.1.1.1.2.cmml" xref="A4.p1.7.m7.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A4.p1.7.m7.2.2.2.1.1.1.2.1.cmml" xref="A4.p1.7.m7.2.2.2.1.1.1.2">subscript</csymbol><ci id="A4.p1.7.m7.2.2.2.1.1.1.2.2.cmml" xref="A4.p1.7.m7.2.2.2.1.1.1.2.2">𝑎</ci><ci id="A4.p1.7.m7.2.2.2.1.1.1.2.3.cmml" xref="A4.p1.7.m7.2.2.2.1.1.1.2.3">𝑡</ci></apply><ci id="A4.p1.7.m7.2.2.2.1.1.1.3.cmml" xref="A4.p1.7.m7.2.2.2.1.1.1.3">𝑧</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.7.m7.2c">P_{F}(s_{t+1}|s_{t})=P(a_{t}=z)</annotation><annotation encoding="application/x-llamapun" id="A4.p1.7.m7.2d">italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = italic_P ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_z )</annotation></semantics></math>
The flow matching property holds at this observed point with the joint likelihood</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A4.E12">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A4.E12X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle P_{F}(s_{t+1}=y|s_{t}=x_{1})\mathcal{F}(s_{t}=x_{1})" class="ltx_Math" display="inline" id="A4.E12X.2.1.1.m1.2"><semantics id="A4.E12X.2.1.1.m1.2a"><mrow id="A4.E12X.2.1.1.m1.2.2" xref="A4.E12X.2.1.1.m1.2.2.cmml"><msub id="A4.E12X.2.1.1.m1.2.2.4" xref="A4.E12X.2.1.1.m1.2.2.4.cmml"><mi id="A4.E12X.2.1.1.m1.2.2.4.2" xref="A4.E12X.2.1.1.m1.2.2.4.2.cmml">P</mi><mi id="A4.E12X.2.1.1.m1.2.2.4.3" xref="A4.E12X.2.1.1.m1.2.2.4.3.cmml">F</mi></msub><mo id="A4.E12X.2.1.1.m1.2.2.3" xref="A4.E12X.2.1.1.m1.2.2.3.cmml">⁢</mo><mrow id="A4.E12X.2.1.1.m1.1.1.1.1" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.cmml"><mo id="A4.E12X.2.1.1.m1.1.1.1.1.2" stretchy="false" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A4.E12X.2.1.1.m1.1.1.1.1.1" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.cmml"><msub id="A4.E12X.2.1.1.m1.1.1.1.1.1.2" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2.cmml"><mi id="A4.E12X.2.1.1.m1.1.1.1.1.1.2.2" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2.2.cmml">s</mi><mrow id="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.cmml"><mi id="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.2" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.1" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.3" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="A4.E12X.2.1.1.m1.1.1.1.1.1.3" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.3.cmml">=</mo><mrow id="A4.E12X.2.1.1.m1.1.1.1.1.1.4" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4.cmml"><mi id="A4.E12X.2.1.1.m1.1.1.1.1.1.4.2" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4.2.cmml">y</mi><mo fence="false" id="A4.E12X.2.1.1.m1.1.1.1.1.1.4.1" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4.1.cmml">|</mo><msub id="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3.cmml"><mi id="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3.2" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3.2.cmml">s</mi><mi id="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3.3" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3.3.cmml">t</mi></msub></mrow><mo id="A4.E12X.2.1.1.m1.1.1.1.1.1.5" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.5.cmml">=</mo><msub id="A4.E12X.2.1.1.m1.1.1.1.1.1.6" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.6.cmml"><mi id="A4.E12X.2.1.1.m1.1.1.1.1.1.6.2" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.6.2.cmml">x</mi><mn id="A4.E12X.2.1.1.m1.1.1.1.1.1.6.3" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.6.3.cmml">1</mn></msub></mrow><mo id="A4.E12X.2.1.1.m1.1.1.1.1.3" stretchy="false" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A4.E12X.2.1.1.m1.2.2.3a" xref="A4.E12X.2.1.1.m1.2.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.E12X.2.1.1.m1.2.2.5" xref="A4.E12X.2.1.1.m1.2.2.5.cmml">ℱ</mi><mo id="A4.E12X.2.1.1.m1.2.2.3b" xref="A4.E12X.2.1.1.m1.2.2.3.cmml">⁢</mo><mrow id="A4.E12X.2.1.1.m1.2.2.2.1" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.cmml"><mo id="A4.E12X.2.1.1.m1.2.2.2.1.2" stretchy="false" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.cmml">(</mo><mrow id="A4.E12X.2.1.1.m1.2.2.2.1.1" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.cmml"><msub id="A4.E12X.2.1.1.m1.2.2.2.1.1.2" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.2.cmml"><mi id="A4.E12X.2.1.1.m1.2.2.2.1.1.2.2" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.2.2.cmml">s</mi><mi id="A4.E12X.2.1.1.m1.2.2.2.1.1.2.3" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.2.3.cmml">t</mi></msub><mo id="A4.E12X.2.1.1.m1.2.2.2.1.1.1" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.1.cmml">=</mo><msub id="A4.E12X.2.1.1.m1.2.2.2.1.1.3" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.3.cmml"><mi id="A4.E12X.2.1.1.m1.2.2.2.1.1.3.2" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.3.2.cmml">x</mi><mn id="A4.E12X.2.1.1.m1.2.2.2.1.1.3.3" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="A4.E12X.2.1.1.m1.2.2.2.1.3" stretchy="false" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.E12X.2.1.1.m1.2b"><apply id="A4.E12X.2.1.1.m1.2.2.cmml" xref="A4.E12X.2.1.1.m1.2.2"><times id="A4.E12X.2.1.1.m1.2.2.3.cmml" xref="A4.E12X.2.1.1.m1.2.2.3"></times><apply id="A4.E12X.2.1.1.m1.2.2.4.cmml" xref="A4.E12X.2.1.1.m1.2.2.4"><csymbol cd="ambiguous" id="A4.E12X.2.1.1.m1.2.2.4.1.cmml" xref="A4.E12X.2.1.1.m1.2.2.4">subscript</csymbol><ci id="A4.E12X.2.1.1.m1.2.2.4.2.cmml" xref="A4.E12X.2.1.1.m1.2.2.4.2">𝑃</ci><ci id="A4.E12X.2.1.1.m1.2.2.4.3.cmml" xref="A4.E12X.2.1.1.m1.2.2.4.3">𝐹</ci></apply><apply id="A4.E12X.2.1.1.m1.1.1.1.1.1.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1"><and id="A4.E12X.2.1.1.m1.1.1.1.1.1a.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1"></and><apply id="A4.E12X.2.1.1.m1.1.1.1.1.1b.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1"><eq id="A4.E12X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.3"></eq><apply id="A4.E12X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E12X.2.1.1.m1.1.1.1.1.1.2.1.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.E12X.2.1.1.m1.1.1.1.1.1.2.2.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2.2">𝑠</ci><apply id="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3"><plus id="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.1"></plus><ci id="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A4.E12X.2.1.1.m1.1.1.1.1.1.4.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4"><csymbol cd="latexml" id="A4.E12X.2.1.1.m1.1.1.1.1.1.4.1.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4.1">conditional</csymbol><ci id="A4.E12X.2.1.1.m1.1.1.1.1.1.4.2.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4.2">𝑦</ci><apply id="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3.1.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3">subscript</csymbol><ci id="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3.2.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3.2">𝑠</ci><ci id="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3.3.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.4.3.3">𝑡</ci></apply></apply></apply><apply id="A4.E12X.2.1.1.m1.1.1.1.1.1c.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1"><eq id="A4.E12X.2.1.1.m1.1.1.1.1.1.5.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2406.06043v1#A4.E12X.2.1.1.m1.1.1.1.1.1.4.cmml" id="A4.E12X.2.1.1.m1.1.1.1.1.1d.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1"></share><apply id="A4.E12X.2.1.1.m1.1.1.1.1.1.6.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="A4.E12X.2.1.1.m1.1.1.1.1.1.6.1.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.6">subscript</csymbol><ci id="A4.E12X.2.1.1.m1.1.1.1.1.1.6.2.cmml" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.6.2">𝑥</ci><cn id="A4.E12X.2.1.1.m1.1.1.1.1.1.6.3.cmml" type="integer" xref="A4.E12X.2.1.1.m1.1.1.1.1.1.6.3">1</cn></apply></apply></apply><ci id="A4.E12X.2.1.1.m1.2.2.5.cmml" xref="A4.E12X.2.1.1.m1.2.2.5">ℱ</ci><apply id="A4.E12X.2.1.1.m1.2.2.2.1.1.cmml" xref="A4.E12X.2.1.1.m1.2.2.2.1"><eq id="A4.E12X.2.1.1.m1.2.2.2.1.1.1.cmml" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.1"></eq><apply id="A4.E12X.2.1.1.m1.2.2.2.1.1.2.cmml" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A4.E12X.2.1.1.m1.2.2.2.1.1.2.1.cmml" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.2">subscript</csymbol><ci id="A4.E12X.2.1.1.m1.2.2.2.1.1.2.2.cmml" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.2.2">𝑠</ci><ci id="A4.E12X.2.1.1.m1.2.2.2.1.1.2.3.cmml" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.2.3">𝑡</ci></apply><apply id="A4.E12X.2.1.1.m1.2.2.2.1.1.3.cmml" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A4.E12X.2.1.1.m1.2.2.2.1.1.3.1.cmml" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.3">subscript</csymbol><ci id="A4.E12X.2.1.1.m1.2.2.2.1.1.3.2.cmml" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.3.2">𝑥</ci><cn id="A4.E12X.2.1.1.m1.2.2.2.1.1.3.3.cmml" type="integer" xref="A4.E12X.2.1.1.m1.2.2.2.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E12X.2.1.1.m1.2c">\displaystyle P_{F}(s_{t+1}=y|s_{t}=x_{1})\mathcal{F}(s_{t}=x_{1})</annotation><annotation encoding="application/x-llamapun" id="A4.E12X.2.1.1.m1.2d">italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = italic_y | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A4.E12Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="A4.E12Xa.2.1.1.m1.1"><semantics id="A4.E12Xa.2.1.1.m1.1a"><mo id="A4.E12Xa.2.1.1.m1.1.1" xref="A4.E12Xa.2.1.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="A4.E12Xa.2.1.1.m1.1b"><eq id="A4.E12Xa.2.1.1.m1.1.1.cmml" xref="A4.E12Xa.2.1.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="A4.E12Xa.2.1.1.m1.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="A4.E12Xa.2.1.1.m1.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle P(s_{t}=x_{1},s_{t+1}=y)" class="ltx_Math" display="inline" id="A4.E12Xa.3.2.2.m1.1"><semantics id="A4.E12Xa.3.2.2.m1.1a"><mrow id="A4.E12Xa.3.2.2.m1.1.1" xref="A4.E12Xa.3.2.2.m1.1.1.cmml"><mi id="A4.E12Xa.3.2.2.m1.1.1.3" xref="A4.E12Xa.3.2.2.m1.1.1.3.cmml">P</mi><mo id="A4.E12Xa.3.2.2.m1.1.1.2" xref="A4.E12Xa.3.2.2.m1.1.1.2.cmml">⁢</mo><mrow id="A4.E12Xa.3.2.2.m1.1.1.1.1" xref="A4.E12Xa.3.2.2.m1.1.1.cmml"><mo id="A4.E12Xa.3.2.2.m1.1.1.1.1.2" stretchy="false" xref="A4.E12Xa.3.2.2.m1.1.1.cmml">(</mo><mrow id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.3.cmml"><mrow id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml"><msub id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"><mi id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml">s</mi><mi id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2.3" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">=</mo><msub id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3.3" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.3" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.3a.cmml">,</mo><mrow id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.cmml"><msub id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.cmml"><mi id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.cmml">s</mi><mrow id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.cmml"><mi id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.2" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.1" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.1.cmml">+</mo><mn id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.3" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.1" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.1.cmml">=</mo><mi id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.3" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml">y</mi></mrow></mrow><mo id="A4.E12Xa.3.2.2.m1.1.1.1.1.3" stretchy="false" xref="A4.E12Xa.3.2.2.m1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.E12Xa.3.2.2.m1.1b"><apply id="A4.E12Xa.3.2.2.m1.1.1.cmml" xref="A4.E12Xa.3.2.2.m1.1.1"><times id="A4.E12Xa.3.2.2.m1.1.1.2.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.2"></times><ci id="A4.E12Xa.3.2.2.m1.1.1.3.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.3">𝑃</ci><apply id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.3.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.3a.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1"><eq id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.1"></eq><apply id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2.2">𝑠</ci><ci id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3.2">𝑥</ci><cn id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2"><eq id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.1.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.1"></eq><apply id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.1.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.2">𝑠</ci><apply id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3"><plus id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.1.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.1"></plus><ci id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.2.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.2">𝑡</ci><cn id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.3.cmml" xref="A4.E12Xa.3.2.2.m1.1.1.1.1.1.2.2.3">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E12Xa.3.2.2.m1.1c">\displaystyle P(s_{t}=x_{1},s_{t+1}=y)</annotation><annotation encoding="application/x-llamapun" id="A4.E12Xa.3.2.2.m1.1d">italic_P ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = italic_y )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A4.E12Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="A4.E12Xb.2.1.1.m1.1"><semantics id="A4.E12Xb.2.1.1.m1.1a"><mo id="A4.E12Xb.2.1.1.m1.1.1" xref="A4.E12Xb.2.1.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="A4.E12Xb.2.1.1.m1.1b"><eq id="A4.E12Xb.2.1.1.m1.1.1.cmml" xref="A4.E12Xb.2.1.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="A4.E12Xb.2.1.1.m1.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="A4.E12Xb.2.1.1.m1.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle P_{B}(s_{t}=x_{1}|s_{t+1}=y)\mathcal{F}(s_{t+1}=y)" class="ltx_Math" display="inline" id="A4.E12Xb.3.2.2.m1.2"><semantics id="A4.E12Xb.3.2.2.m1.2a"><mrow id="A4.E12Xb.3.2.2.m1.2.2" xref="A4.E12Xb.3.2.2.m1.2.2.cmml"><msub id="A4.E12Xb.3.2.2.m1.2.2.4" xref="A4.E12Xb.3.2.2.m1.2.2.4.cmml"><mi id="A4.E12Xb.3.2.2.m1.2.2.4.2" xref="A4.E12Xb.3.2.2.m1.2.2.4.2.cmml">P</mi><mi id="A4.E12Xb.3.2.2.m1.2.2.4.3" xref="A4.E12Xb.3.2.2.m1.2.2.4.3.cmml">B</mi></msub><mo id="A4.E12Xb.3.2.2.m1.2.2.3" xref="A4.E12Xb.3.2.2.m1.2.2.3.cmml">⁢</mo><mrow id="A4.E12Xb.3.2.2.m1.1.1.1.1" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.cmml"><mo id="A4.E12Xb.3.2.2.m1.1.1.1.1.2" stretchy="false" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="A4.E12Xb.3.2.2.m1.1.1.1.1.1" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.cmml"><msub id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2.cmml"><mi id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2.2" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2.2.cmml">s</mi><mi id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2.3" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.3" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.3.cmml">=</mo><mrow id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.cmml"><msub id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2.cmml"><mi id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2.2" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2.2.cmml">x</mi><mn id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2.3" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2.3.cmml">1</mn></msub><mo fence="false" id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.1" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.1.cmml">|</mo><msub id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.cmml"><mi id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.2" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.2.cmml">s</mi><mrow id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.cmml"><mi id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.2" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.2.cmml">t</mi><mo id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.1" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.1.cmml">+</mo><mn id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.3" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.5" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.5.cmml">=</mo><mi id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.6" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.6.cmml">y</mi></mrow><mo id="A4.E12Xb.3.2.2.m1.1.1.1.1.3" stretchy="false" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A4.E12Xb.3.2.2.m1.2.2.3a" xref="A4.E12Xb.3.2.2.m1.2.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.E12Xb.3.2.2.m1.2.2.5" xref="A4.E12Xb.3.2.2.m1.2.2.5.cmml">ℱ</mi><mo id="A4.E12Xb.3.2.2.m1.2.2.3b" xref="A4.E12Xb.3.2.2.m1.2.2.3.cmml">⁢</mo><mrow id="A4.E12Xb.3.2.2.m1.2.2.2.1" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.cmml"><mo id="A4.E12Xb.3.2.2.m1.2.2.2.1.2" stretchy="false" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.cmml">(</mo><mrow id="A4.E12Xb.3.2.2.m1.2.2.2.1.1" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.cmml"><msub id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.cmml"><mi id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.2" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.2.cmml">s</mi><mrow id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.cmml"><mi id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.2" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.2.cmml">t</mi><mo id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.1" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.1.cmml">+</mo><mn id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.3" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.1" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.1.cmml">=</mo><mi id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.3" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.3.cmml">y</mi></mrow><mo id="A4.E12Xb.3.2.2.m1.2.2.2.1.3" stretchy="false" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.E12Xb.3.2.2.m1.2b"><apply id="A4.E12Xb.3.2.2.m1.2.2.cmml" xref="A4.E12Xb.3.2.2.m1.2.2"><times id="A4.E12Xb.3.2.2.m1.2.2.3.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.3"></times><apply id="A4.E12Xb.3.2.2.m1.2.2.4.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.4"><csymbol cd="ambiguous" id="A4.E12Xb.3.2.2.m1.2.2.4.1.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.4">subscript</csymbol><ci id="A4.E12Xb.3.2.2.m1.2.2.4.2.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.4.2">𝑃</ci><ci id="A4.E12Xb.3.2.2.m1.2.2.4.3.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.4.3">𝐵</ci></apply><apply id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1"><and id="A4.E12Xb.3.2.2.m1.1.1.1.1.1a.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1"></and><apply id="A4.E12Xb.3.2.2.m1.1.1.1.1.1b.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1"><eq id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.3.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.3"></eq><apply id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2.1.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2.2">𝑠</ci><ci id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2.3.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4"><csymbol cd="latexml" id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.1.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.1">conditional</csymbol><apply id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2.1.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2">subscript</csymbol><ci id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2.2.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2.2">𝑥</ci><cn id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2.3.cmml" type="integer" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.2.3">1</cn></apply><apply id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.1.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3">subscript</csymbol><ci id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.2.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.2">𝑠</ci><apply id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3"><plus id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.1.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.1"></plus><ci id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.2.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.2">𝑡</ci><cn id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.3.cmml" type="integer" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.3.3.3">1</cn></apply></apply></apply></apply><apply id="A4.E12Xb.3.2.2.m1.1.1.1.1.1c.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1"><eq id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.5.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2406.06043v1#A4.E12Xb.3.2.2.m1.1.1.1.1.1.4.cmml" id="A4.E12Xb.3.2.2.m1.1.1.1.1.1d.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1"></share><ci id="A4.E12Xb.3.2.2.m1.1.1.1.1.1.6.cmml" xref="A4.E12Xb.3.2.2.m1.1.1.1.1.1.6">𝑦</ci></apply></apply><ci id="A4.E12Xb.3.2.2.m1.2.2.5.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.5">ℱ</ci><apply id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.2.1"><eq id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.1.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.1"></eq><apply id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.1.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2">subscript</csymbol><ci id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.2.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.2">𝑠</ci><apply id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3"><plus id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.1.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.1"></plus><ci id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.2.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.2">𝑡</ci><cn id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.3.cmml" type="integer" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.2.3.3">1</cn></apply></apply><ci id="A4.E12Xb.3.2.2.m1.2.2.2.1.1.3.cmml" xref="A4.E12Xb.3.2.2.m1.2.2.2.1.1.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E12Xb.3.2.2.m1.2c">\displaystyle P_{B}(s_{t}=x_{1}|s_{t+1}=y)\mathcal{F}(s_{t+1}=y)</annotation><annotation encoding="application/x-llamapun" id="A4.E12Xb.3.2.2.m1.2d">italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = italic_y ) caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = italic_y )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="A4.p1.10">Additionally, the flow of the next state essentially expresses the expected reachability in the generation process:</p>
<table class="ltx_equation ltx_eqn_table" id="A4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{F}(s_{t+1})=\int_{s_{t}}P_{F}(s_{t+1}|s_{t})\mathcal{F}(s_{t})" class="ltx_Math" display="block" id="A4.E13.m1.3"><semantics id="A4.E13.m1.3a"><mrow id="A4.E13.m1.3.3" xref="A4.E13.m1.3.3.cmml"><mrow id="A4.E13.m1.1.1.1" xref="A4.E13.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.E13.m1.1.1.1.3" xref="A4.E13.m1.1.1.1.3.cmml">ℱ</mi><mo id="A4.E13.m1.1.1.1.2" xref="A4.E13.m1.1.1.1.2.cmml">⁢</mo><mrow id="A4.E13.m1.1.1.1.1.1" xref="A4.E13.m1.1.1.1.1.1.1.cmml"><mo id="A4.E13.m1.1.1.1.1.1.2" stretchy="false" xref="A4.E13.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A4.E13.m1.1.1.1.1.1.1" xref="A4.E13.m1.1.1.1.1.1.1.cmml"><mi id="A4.E13.m1.1.1.1.1.1.1.2" xref="A4.E13.m1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="A4.E13.m1.1.1.1.1.1.1.3" xref="A4.E13.m1.1.1.1.1.1.1.3.cmml"><mi id="A4.E13.m1.1.1.1.1.1.1.3.2" xref="A4.E13.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="A4.E13.m1.1.1.1.1.1.1.3.1" xref="A4.E13.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="A4.E13.m1.1.1.1.1.1.1.3.3" xref="A4.E13.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A4.E13.m1.1.1.1.1.1.3" stretchy="false" xref="A4.E13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.E13.m1.3.3.4" rspace="0.111em" xref="A4.E13.m1.3.3.4.cmml">=</mo><mrow id="A4.E13.m1.3.3.3" xref="A4.E13.m1.3.3.3.cmml"><msub id="A4.E13.m1.3.3.3.3" xref="A4.E13.m1.3.3.3.3.cmml"><mo id="A4.E13.m1.3.3.3.3.2" xref="A4.E13.m1.3.3.3.3.2.cmml">∫</mo><msub id="A4.E13.m1.3.3.3.3.3" xref="A4.E13.m1.3.3.3.3.3.cmml"><mi id="A4.E13.m1.3.3.3.3.3.2" xref="A4.E13.m1.3.3.3.3.3.2.cmml">s</mi><mi id="A4.E13.m1.3.3.3.3.3.3" xref="A4.E13.m1.3.3.3.3.3.3.cmml">t</mi></msub></msub><mrow id="A4.E13.m1.3.3.3.2" xref="A4.E13.m1.3.3.3.2.cmml"><msub id="A4.E13.m1.3.3.3.2.4" xref="A4.E13.m1.3.3.3.2.4.cmml"><mi id="A4.E13.m1.3.3.3.2.4.2" xref="A4.E13.m1.3.3.3.2.4.2.cmml">P</mi><mi id="A4.E13.m1.3.3.3.2.4.3" xref="A4.E13.m1.3.3.3.2.4.3.cmml">F</mi></msub><mo id="A4.E13.m1.3.3.3.2.3" xref="A4.E13.m1.3.3.3.2.3.cmml">⁢</mo><mrow id="A4.E13.m1.2.2.2.1.1.1" xref="A4.E13.m1.2.2.2.1.1.1.1.cmml"><mo id="A4.E13.m1.2.2.2.1.1.1.2" stretchy="false" xref="A4.E13.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="A4.E13.m1.2.2.2.1.1.1.1" xref="A4.E13.m1.2.2.2.1.1.1.1.cmml"><msub id="A4.E13.m1.2.2.2.1.1.1.1.2" xref="A4.E13.m1.2.2.2.1.1.1.1.2.cmml"><mi id="A4.E13.m1.2.2.2.1.1.1.1.2.2" xref="A4.E13.m1.2.2.2.1.1.1.1.2.2.cmml">s</mi><mrow id="A4.E13.m1.2.2.2.1.1.1.1.2.3" xref="A4.E13.m1.2.2.2.1.1.1.1.2.3.cmml"><mi id="A4.E13.m1.2.2.2.1.1.1.1.2.3.2" xref="A4.E13.m1.2.2.2.1.1.1.1.2.3.2.cmml">t</mi><mo id="A4.E13.m1.2.2.2.1.1.1.1.2.3.1" xref="A4.E13.m1.2.2.2.1.1.1.1.2.3.1.cmml">+</mo><mn id="A4.E13.m1.2.2.2.1.1.1.1.2.3.3" xref="A4.E13.m1.2.2.2.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A4.E13.m1.2.2.2.1.1.1.1.1" xref="A4.E13.m1.2.2.2.1.1.1.1.1.cmml">|</mo><msub id="A4.E13.m1.2.2.2.1.1.1.1.3" xref="A4.E13.m1.2.2.2.1.1.1.1.3.cmml"><mi id="A4.E13.m1.2.2.2.1.1.1.1.3.2" xref="A4.E13.m1.2.2.2.1.1.1.1.3.2.cmml">s</mi><mi id="A4.E13.m1.2.2.2.1.1.1.1.3.3" xref="A4.E13.m1.2.2.2.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="A4.E13.m1.2.2.2.1.1.1.3" stretchy="false" xref="A4.E13.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="A4.E13.m1.3.3.3.2.3a" xref="A4.E13.m1.3.3.3.2.3.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="A4.E13.m1.3.3.3.2.5" xref="A4.E13.m1.3.3.3.2.5.cmml">ℱ</mi><mo id="A4.E13.m1.3.3.3.2.3b" xref="A4.E13.m1.3.3.3.2.3.cmml">⁢</mo><mrow id="A4.E13.m1.3.3.3.2.2.1" xref="A4.E13.m1.3.3.3.2.2.1.1.cmml"><mo id="A4.E13.m1.3.3.3.2.2.1.2" stretchy="false" xref="A4.E13.m1.3.3.3.2.2.1.1.cmml">(</mo><msub id="A4.E13.m1.3.3.3.2.2.1.1" xref="A4.E13.m1.3.3.3.2.2.1.1.cmml"><mi id="A4.E13.m1.3.3.3.2.2.1.1.2" xref="A4.E13.m1.3.3.3.2.2.1.1.2.cmml">s</mi><mi id="A4.E13.m1.3.3.3.2.2.1.1.3" xref="A4.E13.m1.3.3.3.2.2.1.1.3.cmml">t</mi></msub><mo id="A4.E13.m1.3.3.3.2.2.1.3" stretchy="false" xref="A4.E13.m1.3.3.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.E13.m1.3b"><apply id="A4.E13.m1.3.3.cmml" xref="A4.E13.m1.3.3"><eq id="A4.E13.m1.3.3.4.cmml" xref="A4.E13.m1.3.3.4"></eq><apply id="A4.E13.m1.1.1.1.cmml" xref="A4.E13.m1.1.1.1"><times id="A4.E13.m1.1.1.1.2.cmml" xref="A4.E13.m1.1.1.1.2"></times><ci id="A4.E13.m1.1.1.1.3.cmml" xref="A4.E13.m1.1.1.1.3">ℱ</ci><apply id="A4.E13.m1.1.1.1.1.1.1.cmml" xref="A4.E13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E13.m1.1.1.1.1.1.1.1.cmml" xref="A4.E13.m1.1.1.1.1.1">subscript</csymbol><ci id="A4.E13.m1.1.1.1.1.1.1.2.cmml" xref="A4.E13.m1.1.1.1.1.1.1.2">𝑠</ci><apply id="A4.E13.m1.1.1.1.1.1.1.3.cmml" xref="A4.E13.m1.1.1.1.1.1.1.3"><plus id="A4.E13.m1.1.1.1.1.1.1.3.1.cmml" xref="A4.E13.m1.1.1.1.1.1.1.3.1"></plus><ci id="A4.E13.m1.1.1.1.1.1.1.3.2.cmml" xref="A4.E13.m1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="A4.E13.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A4.E13.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="A4.E13.m1.3.3.3.cmml" xref="A4.E13.m1.3.3.3"><apply id="A4.E13.m1.3.3.3.3.cmml" xref="A4.E13.m1.3.3.3.3"><csymbol cd="ambiguous" id="A4.E13.m1.3.3.3.3.1.cmml" xref="A4.E13.m1.3.3.3.3">subscript</csymbol><int id="A4.E13.m1.3.3.3.3.2.cmml" xref="A4.E13.m1.3.3.3.3.2"></int><apply id="A4.E13.m1.3.3.3.3.3.cmml" xref="A4.E13.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="A4.E13.m1.3.3.3.3.3.1.cmml" xref="A4.E13.m1.3.3.3.3.3">subscript</csymbol><ci id="A4.E13.m1.3.3.3.3.3.2.cmml" xref="A4.E13.m1.3.3.3.3.3.2">𝑠</ci><ci id="A4.E13.m1.3.3.3.3.3.3.cmml" xref="A4.E13.m1.3.3.3.3.3.3">𝑡</ci></apply></apply><apply id="A4.E13.m1.3.3.3.2.cmml" xref="A4.E13.m1.3.3.3.2"><times id="A4.E13.m1.3.3.3.2.3.cmml" xref="A4.E13.m1.3.3.3.2.3"></times><apply id="A4.E13.m1.3.3.3.2.4.cmml" xref="A4.E13.m1.3.3.3.2.4"><csymbol cd="ambiguous" id="A4.E13.m1.3.3.3.2.4.1.cmml" xref="A4.E13.m1.3.3.3.2.4">subscript</csymbol><ci id="A4.E13.m1.3.3.3.2.4.2.cmml" xref="A4.E13.m1.3.3.3.2.4.2">𝑃</ci><ci id="A4.E13.m1.3.3.3.2.4.3.cmml" xref="A4.E13.m1.3.3.3.2.4.3">𝐹</ci></apply><apply id="A4.E13.m1.2.2.2.1.1.1.1.cmml" xref="A4.E13.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="A4.E13.m1.2.2.2.1.1.1.1.1.cmml" xref="A4.E13.m1.2.2.2.1.1.1.1.1">conditional</csymbol><apply id="A4.E13.m1.2.2.2.1.1.1.1.2.cmml" xref="A4.E13.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E13.m1.2.2.2.1.1.1.1.2.1.cmml" xref="A4.E13.m1.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="A4.E13.m1.2.2.2.1.1.1.1.2.2.cmml" xref="A4.E13.m1.2.2.2.1.1.1.1.2.2">𝑠</ci><apply id="A4.E13.m1.2.2.2.1.1.1.1.2.3.cmml" xref="A4.E13.m1.2.2.2.1.1.1.1.2.3"><plus id="A4.E13.m1.2.2.2.1.1.1.1.2.3.1.cmml" xref="A4.E13.m1.2.2.2.1.1.1.1.2.3.1"></plus><ci id="A4.E13.m1.2.2.2.1.1.1.1.2.3.2.cmml" xref="A4.E13.m1.2.2.2.1.1.1.1.2.3.2">𝑡</ci><cn id="A4.E13.m1.2.2.2.1.1.1.1.2.3.3.cmml" type="integer" xref="A4.E13.m1.2.2.2.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A4.E13.m1.2.2.2.1.1.1.1.3.cmml" xref="A4.E13.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E13.m1.2.2.2.1.1.1.1.3.1.cmml" xref="A4.E13.m1.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="A4.E13.m1.2.2.2.1.1.1.1.3.2.cmml" xref="A4.E13.m1.2.2.2.1.1.1.1.3.2">𝑠</ci><ci id="A4.E13.m1.2.2.2.1.1.1.1.3.3.cmml" xref="A4.E13.m1.2.2.2.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="A4.E13.m1.3.3.3.2.5.cmml" xref="A4.E13.m1.3.3.3.2.5">ℱ</ci><apply id="A4.E13.m1.3.3.3.2.2.1.1.cmml" xref="A4.E13.m1.3.3.3.2.2.1"><csymbol cd="ambiguous" id="A4.E13.m1.3.3.3.2.2.1.1.1.cmml" xref="A4.E13.m1.3.3.3.2.2.1">subscript</csymbol><ci id="A4.E13.m1.3.3.3.2.2.1.1.2.cmml" xref="A4.E13.m1.3.3.3.2.2.1.1.2">𝑠</ci><ci id="A4.E13.m1.3.3.3.2.2.1.1.3.cmml" xref="A4.E13.m1.3.3.3.2.2.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E13.m1.3c">\mathcal{F}(s_{t+1})=\int_{s_{t}}P_{F}(s_{t+1}|s_{t})\mathcal{F}(s_{t})</annotation><annotation encoding="application/x-llamapun" id="A4.E13.m1.3d">caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) = ∫ start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_P start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) caligraphic_F ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A4.p1.9">which addresses the infinite number of previous states for the given next state.
Note that different from the forward policy that follows the Gaussian distribution, the distribution of state flow <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="A4.p1.8.m1.1"><semantics id="A4.p1.8.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A4.p1.8.m1.1.1" xref="A4.p1.8.m1.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="A4.p1.8.m1.1b"><ci id="A4.p1.8.m1.1.1.cmml" xref="A4.p1.8.m1.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.8.m1.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.8.m1.1d">caligraphic_F</annotation></semantics></math> and the backward flow <math alttext="P_{B}" class="ltx_Math" display="inline" id="A4.p1.9.m2.1"><semantics id="A4.p1.9.m2.1a"><msub id="A4.p1.9.m2.1.1" xref="A4.p1.9.m2.1.1.cmml"><mi id="A4.p1.9.m2.1.1.2" xref="A4.p1.9.m2.1.1.2.cmml">P</mi><mi id="A4.p1.9.m2.1.1.3" xref="A4.p1.9.m2.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="A4.p1.9.m2.1b"><apply id="A4.p1.9.m2.1.1.cmml" xref="A4.p1.9.m2.1.1"><csymbol cd="ambiguous" id="A4.p1.9.m2.1.1.1.cmml" xref="A4.p1.9.m2.1.1">subscript</csymbol><ci id="A4.p1.9.m2.1.1.2.cmml" xref="A4.p1.9.m2.1.1.2">𝑃</ci><ci id="A4.p1.9.m2.1.1.3.cmml" xref="A4.p1.9.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.9.m2.1c">P_{B}</annotation><annotation encoding="application/x-llamapun" id="A4.p1.9.m2.1d">italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math> could be complicated.
So we use neural networks to approximate these likelihoods in our design.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aceto et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Giuseppe Aceto, Valerio Persico, and Antonio Pescapé. 2020.

</span>
<span class="ltx_bibblock">Industry 4.0 and health: Internet of things, big data, and cloud computing for healthcare 4.0.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Journal of Industrial Information Integration</em> 18 (2020), 100129.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Afsar et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
M Mehdi Afsar, Trafford Crump, and Behrouz Far. 2021.

</span>
<span class="ltx_bibblock">Reinforcement learning based recommender systems: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">ACM Computing Surveys (CSUR)</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bengio et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Emmanuel Bengio, Moksh Jain, Maksym Korablyov, Doina Precup, and Yoshua Bengio. 2021.

</span>
<span class="ltx_bibblock">Flow network based generative models for non-iterative diverse candidate generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Advances in Neural Information Processing Systems</em> 34 (2021), 27381–27394.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bengio et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yoshua Bengio, Salem Lahlou, Tristan Deleu, Edward J Hu, Mo Tiwari, and Emmanuel Bengio. 2023.

</span>
<span class="ltx_bibblock">Gflownet foundations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Journal of Machine Learning Research</em> 24, 210 (2023), 1–55.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhatnagar et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2007)</span>
<span class="ltx_bibblock">
Shalabh Bhatnagar, Mohammad Ghavamzadeh, Mark Lee, and Richard S Sutton. 2007.

</span>
<span class="ltx_bibblock">Incremental natural actor-critic algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">Advances in neural information processing systems</em> 20 (2007).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Qingpeng Cai, Shuchang Liu, Xueliang Wang, Tianyou Zuo, Wentao Xie, Bin Yang, Dong Zheng, Peng Jiang, and Kun Gai. 2023a.

</span>
<span class="ltx_bibblock">Reinforcing User Retention in a Billion Scale Short Video Recommender System. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Companion Proceedings of the ACM Web Conference 2023</em>. 421–426.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Qingpeng Cai, Zhenghai Xue, Chi Zhang, Wanqi Xue, Shuchang Liu, Ruohan Zhan, Xueliang Wang, Tianyou Zuo, Wentao Xie, Dong Zheng, et al<span class="ltx_text" id="bib.bib8.3.1">.</span> 2023b.

</span>
<span class="ltx_bibblock">Two-Stage Constrained Actor-Critic for Short Video Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.4.1">Proceedings of the ACM Web Conference 2023</em>. 865–875.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai and Chen (2020)</span>
<span class="ltx_bibblock">
Wanling Cai and Li Chen. 2020.

</span>
<span class="ltx_bibblock">Predicting user intents and satisfaction with dialogue-based conversational recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 28th ACM Conference on User Modeling, Adaptation and Personalization</em>. 33–42.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carvalho and Macedo (2013)</span>
<span class="ltx_bibblock">
Lucas Augusto Montalvão Costa Carvalho and Hendrik Teixeira Macedo. 2013.

</span>
<span class="ltx_bibblock">Users’ satisfaction in recommendation systems for groups: an approach based on noncooperative games. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the 22nd International Conference on World Wide Web</em>. 951–958.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chandar et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Praveen Chandar, Brian St. Thomas, Lucas Maystre, Vijay Pappu, Roberto Sanchis-Ojeda, Tiffany Wu, Ben Carterette, Mounia Lalmas, and Tony Jebara. 2022.

</span>
<span class="ltx_bibblock">Using survival models to estimate user engagement in online experiments. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of the ACM Web Conference 2022</em>. 3186–3195.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2019b)</span>
<span class="ltx_bibblock">
Haokun Chen, Xinyi Dai, Han Cai, Weinan Zhang, Xuejian Wang, Ruiming Tang, Yuzhou Zhang, and Yong Yu. 2019b.

</span>
<span class="ltx_bibblock">Large-scale interactive recommendation with tree-structured policy gradient. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 33. 3312–3320.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2019c)</span>
<span class="ltx_bibblock">
Li Chen, Yonghua Yang, Ningxia Wang, Keping Yang, and Quan Yuan. 2019c.

</span>
<span class="ltx_bibblock">How serendipity improves user satisfaction with recommendations? a large-scale user evaluation. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">The world wide web conference</em>. 240–250.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2019a)</span>
<span class="ltx_bibblock">
Minmin Chen, Alex Beutel, Paul Covington, Sagar Jain, Francois Belletti, and Ed H Chi. 2019a.

</span>
<span class="ltx_bibblock">Top-k off-policy correction for a REINFORCE recommender system. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of the Twelfth ACM International Conference on Web Search and Data Mining</em>. 456–464.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2021a)</span>
<span class="ltx_bibblock">
Xiaocong Chen, Lina Yao, Julian McAuley, Guanglin Zhou, and Xianzhi Wang. 2021a.

</span>
<span class="ltx_bibblock">A survey of deep reinforcement learning in recommender systems: A systematic review and future directions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">arXiv preprint arXiv:2109.03540</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2021b)</span>
<span class="ltx_bibblock">
Xiaocong Chen, Lina Yao, Aixin Sun, Xianzhi Wang, Xiwei Xu, and Liming Zhu. 2021b.

</span>
<span class="ltx_bibblock">Generative inverse deep reinforcement learning for online recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 30th ACM International Conference on Information &amp; Knowledge Management</em>. 201–210.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ciosek et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Kamil Ciosek, Quan Vuong, Robert Loftin, and Katja Hofmann. 2019.

</span>
<span class="ltx_bibblock">Better exploration with optimistic actor critic.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Advances in Neural Information Processing Systems</em> 32 (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Das et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2007)</span>
<span class="ltx_bibblock">
Abhinandan S Das, Mayur Datar, Ashutosh Garg, and Shyam Rajaram. 2007.

</span>
<span class="ltx_bibblock">Google news personalization: scalable online collaborative filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Proceedings of the 16th international conference on World Wide Web</em>. 271–280.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Degris et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Thomas Degris, Patrick M Pilarski, and Richard S Sutton. 2012.

</span>
<span class="ltx_bibblock">Model-free reinforcement learning with continuous action in practice. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">2012 American Control Conference (ACC)</em>. IEEE, 2177–2182.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng (2006)</span>
<span class="ltx_bibblock">
Lih-Yuan Deng. 2006.

</span>
<span class="ltx_bibblock">The cross-entropy method: a unified approach to combinatorial optimization, Monte-Carlo simulation, and machine learning.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Rui Ding, Ruobing Xie, Xiaobo Hao, Xiaochun Yang, Kaikai Ge, Xu Zhang, Jie Zhou, and Leyu Lin. 2023.

</span>
<span class="ltx_bibblock">Interpretable User Retention Modeling in Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the 17th ACM Conference on Recommender Systems</em>. 702–708.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dulac-Arnold et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Gabriel Dulac-Arnold, Richard Evans, Hado van Hasselt, Peter Sunehag, Timothy Lillicrap, Jonathan Hunt, Timothy Mann, Theophane Weber, Thomas Degris, and Ben Coppin. 2015.

</span>
<span class="ltx_bibblock">Deep reinforcement learning in large discrete action spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">arXiv preprint arXiv:1512.07679</em> (2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fujimoto et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Scott Fujimoto, Herke Hoof, and David Meger. 2018.

</span>
<span class="ltx_bibblock">Addressing function approximation error in actor-critic methods. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">International conference on machine learning</em>. PMLR, 1587–1596.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gwalani (2022)</span>
<span class="ltx_bibblock">
Harsha Gwalani. 2022.

</span>
<span class="ltx_bibblock">Studying Long-Term User Behaviour Using Dynamic Time Warping for Customer Retention. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the Fifteenth ACM International Conference on Web Search and Data Mining</em>. 1643–1643.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haarnoja et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Tuomas Haarnoja, Aurick Zhou, Pieter Abbeel, and Sergey Levine. 2018.

</span>
<span class="ltx_bibblock">Soft actor-critic: Off-policy maximum entropy deep reinforcement learning with a stochastic actor. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">International conference on machine learning</em>. PMLR, 1861–1870.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ie et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2019a)</span>
<span class="ltx_bibblock">
Eugene Ie, Vihan Jain, Jing Wang, Sanmit Narvekar, Ritesh Agarwal, Rui Wu, Heng-Tze Cheng, Tushar Chandra, and Craig Boutilier. 2019a.

</span>
<span class="ltx_bibblock">SlateQ: A tractable decomposition for reinforcement learning with recommendation sets.

</span>
<span class="ltx_bibblock">(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ie et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2019b)</span>
<span class="ltx_bibblock">
Eugene Ie, Chih wei Hsu, Martin Mladenov, Vihan Jain, Sanmit Narvekar, Jing Wang, Rui Wu, and Craig Boutilier. 2019b.

</span>
<span class="ltx_bibblock">RecSim: A Configurable Simulation Platform for Recommender Systems.

</span>
<span class="ltx_bibblock">(2019).

</span>
<span class="ltx_bibblock">arXiv:1909.04847 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kapoor et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Komal Kapoor, Mingxuan Sun, Jaideep Srivastava, and Tao Ye. 2014.

</span>
<span class="ltx_bibblock">A hazard based approach to user return time prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Proceedings of the 20th ACM SIGKDD international conference on Knowledge discovery and data mining</em>. 1719–1728.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lau et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Elaine Lau, Stephen Zhewen Lu, Ling Pan, Doina Precup, and Emmanuel Bengio. 2024.

</span>
<span class="ltx_bibblock">QGFN: Controllable Greediness with Action Values.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">arXiv preprint arXiv:2402.05234</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zihao Li, Aixin Sun, and Chenliang Li. 2023.

</span>
<span class="ltx_bibblock">DiffuRec: A Diffusion Model for Sequential Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">ACM Trans. Inf. Syst.</em> 42, 3, Article 66 (dec 2023), 28 pages.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3631116" title="">https://doi.org/10.1145/3631116</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Feng Liu, Ruiming Tang, Xutao Li, Weinan Zhang, Yunming Ye, Haokun Chen, Huifeng Guo, and Yuzhou Zhang. 2018.

</span>
<span class="ltx_bibblock">Deep reinforcement learning based recommendation with explicit user-item interactions modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">arXiv preprint arXiv:1810.12027</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Feng Liu, Ruiming Tang, Xutao Li, Weinan Zhang, Yunming Ye, Haokun Chen, Huifeng Guo, Yuzhou Zhang, and Xiuqiang He. 2020.

</span>
<span class="ltx_bibblock">State representation modeling for deep reinforcement learning based recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Knowledge-Based Systems</em> 205 (2020), 106170.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Shuchang Liu, Qingpeng Cai, Zhankui He, Bowen Sun, Julian McAuley, Dong Zheng, Peng Jiang, and Kun Gai. 2023a.

</span>
<span class="ltx_bibblock">Generative flow network for listwise recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 1524–1534.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Shuchang Liu, Qingpeng Cai, Bowen Sun, Yuhao Wang, Ji Jiang, Dong Zheng, Peng Jiang, Kun Gai, Xiangyu Zhao, and Yongfeng Zhang. 2023b.

</span>
<span class="ltx_bibblock">Exploration and Regularization of the Latent Action Space in Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of the ACM Web Conference 2023</em>. 833–844.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mahmood and Ricci (2007)</span>
<span class="ltx_bibblock">
Tariq Mahmood and Francesco Ricci. 2007.

</span>
<span class="ltx_bibblock">Learning and adaptivity in interactive recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the ninth international conference on Electronic commerce</em>. 75–84.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moling et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Omar Moling, Linas Baltrunas, and Francesco Ricci. 2012.

</span>
<span class="ltx_bibblock">Optimal radio channel recommendations with explicit and implicit feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proceedings of the sixth ACM conference on Recommender systems</em>. 75–82.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Ling Pan, Moksh Jain, Kanika Madan, and Yoshua Bengio. 2023a.

</span>
<span class="ltx_bibblock">Pre-Training and Fine-Tuning Generative Flow Networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">arXiv preprint arXiv:2310.03419</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Ling Pan, Nikolay Malkin, Dinghuai Zhang, and Yoshua Bengio. 2023b.

</span>
<span class="ltx_bibblock">Better training of gflownets with local credit and incomplete trajectories. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">International Conference on Machine Learning</em>. PMLR, 26878–26890.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Ling Pan, Dinghuai Zhang, Aaron Courville, Longbo Huang, and Yoshua Bengio. 2022.

</span>
<span class="ltx_bibblock">Generative augmented flow networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">arXiv preprint arXiv:2210.03308</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2023c)</span>
<span class="ltx_bibblock">
Ling Pan, Dinghuai Zhang, Moksh Jain, Longbo Huang, and Yoshua Bengio. 2023c.

</span>
<span class="ltx_bibblock">Stochastic generative flow networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Uncertainty in Artificial Intelligence</em>. PMLR, 1628–1638.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peters and Schaal (2008)</span>
<span class="ltx_bibblock">
Jan Peters and Stefan Schaal. 2008.

</span>
<span class="ltx_bibblock">Natural actor-critic.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Neurocomputing</em> 71, 7-9 (2008), 1180–1190.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shani et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2005)</span>
<span class="ltx_bibblock">
Guy Shani, David Heckerman, Ronen I Brafman, and Craig Boutilier. 2005.

</span>
<span class="ltx_bibblock">An MDP-based recommender system.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">Journal of Machine Learning Research</em> 6, 9 (2005).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun and Zhang (2018)</span>
<span class="ltx_bibblock">
Yueming Sun and Yi Zhang. 2018.

</span>
<span class="ltx_bibblock">Conversational recommender system. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">The 41st international acm sigir conference on research &amp; development in information retrieval</em>. 235–244.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutton and Barto (2018)</span>
<span class="ltx_bibblock">
Richard S Sutton and Andrew G Barto. 2018.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Reinforcement learning: An introduction</em>.

</span>
<span class="ltx_bibblock">MIT press.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutton et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (1999)</span>
<span class="ltx_bibblock">
Richard S Sutton, David McAllester, Satinder Singh, and Yishay Mansour. 1999.

</span>
<span class="ltx_bibblock">Policy gradient methods for reinforcement learning with function approximation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">Advances in neural information processing systems</em> 12 (1999).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taghipour et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2007)</span>
<span class="ltx_bibblock">
Nima Taghipour, Ahmad Kardan, and Saeed Shiry Ghidary. 2007.

</span>
<span class="ltx_bibblock">Usage-based web recommendations: a reinforcement learning approach. In <em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">Proceedings of the 2007 ACM conference on Recommender systems</em>. 113–120.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Viljanen et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Markus Viljanen, Antti Airola, Tapio Pahikkala, and Jukka Heikkonen. 2016.

</span>
<span class="ltx_bibblock">Modelling user retention in mobile games. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">2016 IEEE Conference on Computational Intelligence and Games (CIG)</em>. IEEE, 1–8.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yuyan Wang, Mohit Sharma, Can Xu, Sriraj Badam, Qian Sun, Lee Richardson, Lisa Chung, Ed H Chi, and Minmin Chen. 2022.

</span>
<span class="ltx_bibblock">Surrogate for Long-Term User Experience in Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 4100–4109.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Qingyun Wu, Hongning Wang, Liangjie Hong, and Yue Shi. 2017.

</span>
<span class="ltx_bibblock">Returning is believing: Optimizing long-term user engagement in recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">Proceedings of the 2017 ACM on Conference on Information and Knowledge Management</em>. 1927–1936.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xin et al<span class="ltx_text" id="bib.bib50.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xin Xin, Alexandros Karatzoglou, Ioannis Arapakis, and Joemon M Jose. 2020.

</span>
<span class="ltx_bibblock">Self-supervised reinforcement learning for recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib50.3.1">Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval</em>. 931–940.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xue et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Wanqi Xue, Qingpeng Cai, Ruohan Zhan, Dong Zheng, Peng Jiang, Kun Gai, and Bo An. 2022.

</span>
<span class="ltx_bibblock">ResAct: Reinforcing long-term engagement in sequential recommendation with residual actor.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.3.1">arXiv preprint arXiv:2206.02620</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib52.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zhengyi Yang, Jiancan Wu, Zhicai Wang, Xiang Wang, Yancheng Yuan, and Xiangnan He. 2024.

</span>
<span class="ltx_bibblock">Generate What You Prefer: Reshaping Sequential Recommendation via Guided Diffusion.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.3.1">Advances in Neural Information Processing Systems</em> 36 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yi et al<span class="ltx_text" id="bib.bib53.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Xing Yi, Liangjie Hong, Erheng Zhong, Nanthan Nan Liu, and Suju Rajan. 2014.

</span>
<span class="ltx_bibblock">Beyond clicks: dwell time for personalization. In <em class="ltx_emph ltx_font_italic" id="bib.bib53.3.1">Proceedings of the 8th ACM Conference on Recommender systems</em>. 113–120.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib54.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Dinghuai Zhang, Hanjun Dai, Nikolay Malkin, Aaron C Courville, Yoshua Bengio, and Ling Pan. 2024.

</span>
<span class="ltx_bibblock">Let the flows tell: Solving graph combinatorial problems with GFlowNets.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.3.1">Advances in Neural Information Processing Systems</em> 36 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib55.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Dinghuai Zhang, Ling Pan, Ricky TQ Chen, Aaron Courville, and Yoshua Bengio. 2023.

</span>
<span class="ltx_bibblock">Distributional gflownets with quantile flows.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib55.3.1">arXiv preprint arXiv:2302.05793</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib56.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Qihua Zhang, Junning Liu, Yuzhuo Dai, Yiyan Qi, Yifan Yuan, Kunlun Zheng, Fan Huang, and Xianfeng Tan. 2022.

</span>
<span class="ltx_bibblock">Multi-Task Fusion via Reinforcement Learning for Long-Term User Satisfaction in Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib56.3.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 4510–4520.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib57.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Kesen Zhao, Shuchang Liu, Qingpeng Cai, Xiangyu Zhao, Ziru Liu, Dong Zheng, Peng Jiang, and Kun Gai. 2023a.

</span>
<span class="ltx_bibblock">KuaiSim: A comprehensive simulator for recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.3.1">Advances in Neural Information Processing Systems</em> 36 (2023), 44880–44897.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib58.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Kesen Zhao, Lixin Zou, Xiangyu Zhao, Maolin Wang, and Dawei Yin. 2023b.

</span>
<span class="ltx_bibblock">User Retention-oriented Recommendation with Decision Transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib58.3.1">Proceedings of the ACM Web Conference 2023</em>. 1141–1149.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib59.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Xiangyu Zhao, Long Xia, Jiliang Tang, and Dawei Yin. 2019.

</span>
<span class="ltx_bibblock">” Deep reinforcement learning for search, recommendation, and online advertising: a survey” by Xiangyu Zhao, Long Xia, Jiliang Tang, and Dawei Yin with Martin Vesely as coordinator.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.3.1">ACM sigweb newsletter</em> Spring (2019), 1–15.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib60.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiangyu Zhao, Long Xia, Lixin Zou, Hui Liu, Dawei Yin, and Jiliang Tang. 2020.

</span>
<span class="ltx_bibblock">Whole-chain recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib60.3.1">Proceedings of the 29th ACM international conference on information &amp; knowledge management</em>. 1883–1891.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib61.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Xiangyu Zhao, Liang Zhang, Zhuoye Ding, Long Xia, Jiliang Tang, and Dawei Yin. 2018.

</span>
<span class="ltx_bibblock">Recommendations with negative feedback via pairwise deep reinforcement learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib61.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>. 1040–1048.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib62.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Yufan Zhao, Donglin Zeng, Mark A Socinski, and Michael R Kosorok. 2011.

</span>
<span class="ltx_bibblock">Reinforcement learning strategies for clinical trials in nonsmall cell lung cancer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib62.3.1">Biometrics</em> 67, 4 (2011), 1422–1433.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib63.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guanjie Zheng, Fuzheng Zhang, Zihan Zheng, Yang Xiang, Nicholas Jing Yuan, Xing Xie, and Zhenhui Li. 2018.

</span>
<span class="ltx_bibblock">DRN: A deep reinforcement learning framework for news recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib63.3.1">Proceedings of the 2018 world wide web conference</em>. 167–176.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib64.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guorui Zhou, Xiaoqiang Zhu, Chenru Song, Ying Fan, Han Zhu, Xiao Ma, Yanghui Yan, Junqi Jin, Han Li, and Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Deep interest network for click-through rate prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib64.3.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 1059–1068.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zou et al<span class="ltx_text" id="bib.bib65.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Lixin Zou, Long Xia, Zhuoye Ding, Jiaxing Song, Weidong Liu, and Dawei Yin. 2019.

</span>
<span class="ltx_bibblock">Reinforcement learning to optimize long-term user engagement in recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib65.3.1">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>. 2810–2818.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Jun 10 07:11:00 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
