<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2203.14666] Federated Learning with Position-Aware Neurons</title><meta property="og:description" content="Federated Learning (FL) fuses collaborative models from local nodes without centralizing users’ data. The permutation invariance property of neural networks and the non-i.i.d. data across clients make the locally updat…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning with Position-Aware Neurons">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning with Position-Aware Neurons">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2203.14666">

<!--Generated on Thu Feb 29 03:34:17 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Learning with Position-Aware Neurons</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Xin-Chun Li<sup id="id10.10.id1" class="ltx_sup"><span id="id10.10.id1.1" class="ltx_text ltx_font_italic">1</span></sup>, Yi-Chu Xu<sup id="id11.11.id2" class="ltx_sup"><span id="id11.11.id2.1" class="ltx_text ltx_font_italic">1</span></sup>, Shaoming Song<sup id="id12.12.id3" class="ltx_sup"><span id="id12.12.id3.1" class="ltx_text ltx_font_italic">2</span></sup>, Bingshuai Li<sup id="id13.13.id4" class="ltx_sup"><span id="id13.13.id4.1" class="ltx_text ltx_font_italic">2</span></sup>, Yinchuan Li<sup id="id14.14.id5" class="ltx_sup"><span id="id14.14.id5.1" class="ltx_text ltx_font_italic">2</span></sup>, 
<br class="ltx_break">Yunfeng Shao<sup id="id15.15.id6" class="ltx_sup"><span id="id15.15.id6.1" class="ltx_text ltx_font_italic">2</span></sup>, De-Chuan Zhan<sup id="id16.16.id7" class="ltx_sup"><span id="id16.16.id7.1" class="ltx_text ltx_font_italic">1</span></sup> 
<br class="ltx_break"><sup id="id17.17.id8" class="ltx_sup"><span id="id17.17.id8.1" class="ltx_text ltx_font_italic">1</span></sup>State Key Laboratory for Novel Software Technology, Nanjing University 
<br class="ltx_break"><sup id="id18.18.id9" class="ltx_sup"><span id="id18.18.id9.1" class="ltx_text ltx_font_italic">2</span></sup>Huawei Noah’s Ark Lab
<br class="ltx_break"><span id="id19.19.id10" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{lixc, xuyc}@lamda.nju.edu.cn, zhandc@nju.edu.cn
</span> 
<br class="ltx_break"><span id="id20.20.id11" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{shaoming.song, libingshuai, liyinchuan, shaoyunfeng}@huawei.com
</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id21.id1" class="ltx_p">Federated Learning (FL) fuses collaborative models from local nodes without centralizing users’ data. The permutation invariance property of neural networks and the non-i.i.d. data across clients make the locally updated parameters imprecisely aligned, disabling the coordinate-based parameter averaging. Traditional neurons do not explicitly consider position information. Hence, we propose Position-Aware Neurons (PANs) as an alternative, fusing position-related values (i.e., position encodings) into neuron outputs. PANs couple themselves to their positions and minimize the possibility of dislocation, even updating on heterogeneous data. We turn on/off PANs to disable/enable the permutation invariance property of neural networks. PANs are tightly coupled with positions when applied to FL, making parameters across clients pre-aligned and facilitating coordinate-based parameter averaging. PANs are algorithm-agnostic and could universally improve existing FL algorithms. Furthermore, “FL with PANs” is simple to implement and computationally friendly.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> generates a global model via collaborating with isolated clients for privacy protection and efficient distributed training, generally following the parameter server architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Clients update models on their devices using private data, and the server periodically averages these models for multiple communication rounds <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. The whole process does not transmit users’ data and meets the basic privacy requirements.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2203.14666/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="280" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.4.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.5.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Left<span id="S1.F1.5.2.1" class="ltx_text ltx_font_medium">: Position-Aware Neurons (PANs). We fuse equal/varied position encodings to neurons’ outputs, PANs are turned off/on, and the shuffled networks make the same/different predictions, i.e., the permutation invariance property is enabled/disabled. </span>Right<span id="S1.F1.5.2.2" class="ltx_text ltx_font_medium">: applying PANs to FL. Neurons are coupled with their positions for pre-alignment.</span></span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Represented by FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, many FL algorithms aggregate local parameters via a simple coordinate-based averaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> These algorithms have two kinds of drawbacks. First, as traditional neurons are unaware of their positions, neural networks have the permutation invariance property, implying that hidden neurons could be dislocated during training without affecting the local performances. Second, the samples across clients are non-independent and identically distributed (non-i.i.d.) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, which could exacerbate the permutation of neural networks during local training, making local models misaligned and leading to weight divergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>. These reasons degrade the performance of coordinate-based parameter averaging.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Recently, a series of works utilize various matching techniques to align neurons, such as Bayesian nonparametric learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> and optimal transport <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. First, these methods are too complex to implement. Second, they solve the misalignment problem after finishing local updates and hence belong to post-processing strategies that need additional computation budgets. Fed<sup id="S1.p3.1.1" class="ltx_sup">2</sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> pioneers a novel aspect via designing feature-oriented model structures following a pre-aligned manner. However, it has to carefully customize the network architecture and only stays at the group level of pre-alignment. By contrast, we explore a more straightforward and general technique to pre-align neurons during local training procedures.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our work mainly focuses on solving the non-i.i.d. challenge in FL, more specifically, seeking solutions via limiting the permutation invariance property of neural networks. We first summarize the above analysis: <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">the permutation invariance property of neural networks leads to neuron misalignment across local models. The more heterogeneous the data, the more serious the misalignment is</span>. Hence, our motivation is intuitive: <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">could we design a switch to control the permutation invariance property of neuron networks?</span> We propose <span id="S1.p4.1.3" class="ltx_text ltx_font_bold">Position-Aware Neurons (PANs)</span> as the solution, which couple neurons with their positions. Specifically, for each neuron (channel for ConvNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>), we add or multiply a position-related value (i.e., position encoding) to its output. We introduce a hyper-parameter to turn on/off the PANs, and correspondingly, to disable/enable the permutation invariance property of neural networks. PANs bind neurons in their positions, implicitly pre-aligning neurons across clients even faced with non-i.i.d. data. From another aspect, PANs could keep some consistent ingredients in the forward and backward pass across local models, which could reduce the weight divergence. Overall, appropriate PANs facilitate the coordinate-based parameter averaging in FL. Replacing traditional neurons with PANs is simple to implement and computationally friendly, which is universal to various FL algorithms. Contributions can be briefed as: <span id="S1.p4.1.4" class="ltx_text ltx_font_italic">(1) proposing PANs to disable/enable the permutation invariance property of deep networks; (2) applying PANs to FL, which binds neurons in positions and pre-aligns parameters for better coordinate-wise parameter averaging.</span></p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">FL with Non-I.I.D. Data:</span> Existing works solve the non-i.i.d. data problem in FL from various aspects. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> points out the weight divergence phenomenon in FL and use shared data to decrease the divergence. FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> takes a proximal term during local training as regularization. FedOpt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> considers updating the global model via momentum or adaptive optimizers (e.g., Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, Yogi <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>) instead of simple parameter averaging. Scaffold <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> introduces control variates to rectify the local update directions and mitigates the influences of client drift. MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> utilizes model contrastive learning to reduce the distance between local and global models. Some other works utilize similar techniques including dynamic regularization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, ensemble distillation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, etc. We take several representative FL algorithms and use PANs to improve them.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">FL with Permutation Invariance Property:</span> The permutation invariance of neuron networks could lead to neuron misalignment. PFNM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> matches local nodes’ parameters via Beta-Bernoulli process <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> and Indian Buffet Process <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, formulating an optimal assignment problem and solving it via Hungarian algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. SPAHM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> applies the same procedure to aggregate Gaussian topic models, hidden Markov models, and so on. FedMA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> points out PFNM does not apply to large-scale networks and proposes a layer-wise matching method. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> utilizes optimal transport <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> to fuse models with different initializations. These methods are all post-processing ones that need additional computation costs. Fed<sup id="S2.p2.1.2" class="ltx_sup">2</sup> is recently proposed to align features during local training via separating features into different groups. However, it needs to carefully design the architectures. Differently, we take a more fine-grained alignment of neurons rather than network groups, and we will show our method is more general.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Position Encoding:</span> Position encoding is popular in sequence learning architectures, e.g., ConvS2S <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, etc. These architectures take position encodings to consider the order information. Relative position encoding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> is more applicable to sequences with various lengths. Some other studies are devoted to interpreting what position encodings learn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>. Another interesting work is applying position encodings instead of zero-padding to GAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> as spatial inductive bias. Differently, we resort to position encodings to bind neurons in their positions in FL. Furthermore, these works only consider position encodings at the input layer, while we couple them with neurons.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Position-Aware Neurons</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we investigate the permutation invariance of neural networks and introduce PANs to control it.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Permutation Invariance Property</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.28" class="ltx_p">Assume an MLP network has <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="L+1" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">L</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">+</mo><mn id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><plus id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></plus><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">L+1</annotation></semantics></math> layers (containing input and output layer), and each layer contains <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="J_{l}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">J</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝐽</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">J_{l}</annotation></semantics></math> neurons, where <math id="S3.SS1.p1.3.m3.4" class="ltx_Math" alttext="l\in\{0,1,\cdots,L\}" display="inline"><semantics id="S3.SS1.p1.3.m3.4a"><mrow id="S3.SS1.p1.3.m3.4.5" xref="S3.SS1.p1.3.m3.4.5.cmml"><mi id="S3.SS1.p1.3.m3.4.5.2" xref="S3.SS1.p1.3.m3.4.5.2.cmml">l</mi><mo id="S3.SS1.p1.3.m3.4.5.1" xref="S3.SS1.p1.3.m3.4.5.1.cmml">∈</mo><mrow id="S3.SS1.p1.3.m3.4.5.3.2" xref="S3.SS1.p1.3.m3.4.5.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.4.5.3.2.1" xref="S3.SS1.p1.3.m3.4.5.3.1.cmml">{</mo><mn id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">0</mn><mo id="S3.SS1.p1.3.m3.4.5.3.2.2" xref="S3.SS1.p1.3.m3.4.5.3.1.cmml">,</mo><mn id="S3.SS1.p1.3.m3.2.2" xref="S3.SS1.p1.3.m3.2.2.cmml">1</mn><mo id="S3.SS1.p1.3.m3.4.5.3.2.3" xref="S3.SS1.p1.3.m3.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.3.m3.3.3" xref="S3.SS1.p1.3.m3.3.3.cmml">⋯</mi><mo id="S3.SS1.p1.3.m3.4.5.3.2.4" xref="S3.SS1.p1.3.m3.4.5.3.1.cmml">,</mo><mi id="S3.SS1.p1.3.m3.4.4" xref="S3.SS1.p1.3.m3.4.4.cmml">L</mi><mo stretchy="false" id="S3.SS1.p1.3.m3.4.5.3.2.5" xref="S3.SS1.p1.3.m3.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.4b"><apply id="S3.SS1.p1.3.m3.4.5.cmml" xref="S3.SS1.p1.3.m3.4.5"><in id="S3.SS1.p1.3.m3.4.5.1.cmml" xref="S3.SS1.p1.3.m3.4.5.1"></in><ci id="S3.SS1.p1.3.m3.4.5.2.cmml" xref="S3.SS1.p1.3.m3.4.5.2">𝑙</ci><set id="S3.SS1.p1.3.m3.4.5.3.1.cmml" xref="S3.SS1.p1.3.m3.4.5.3.2"><cn type="integer" id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">0</cn><cn type="integer" id="S3.SS1.p1.3.m3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2">1</cn><ci id="S3.SS1.p1.3.m3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3">⋯</ci><ci id="S3.SS1.p1.3.m3.4.4.cmml" xref="S3.SS1.p1.3.m3.4.4">𝐿</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.4c">l\in\{0,1,\cdots,L\}</annotation></semantics></math> is the layer index. <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="J_{0}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">J</mi><mn id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝐽</ci><cn type="integer" id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">J_{0}</annotation></semantics></math> and <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="J_{L}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">J</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝐽</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">J_{L}</annotation></semantics></math> are input and output dimensions. We denote the parameters of each layer as the weight matrix <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="W_{l}\in\mathcal{R}^{J_{l}\times J_{l-1}}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><msub id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2.2" xref="S3.SS1.p1.6.m6.1.1.2.2.cmml">W</mi><mi id="S3.SS1.p1.6.m6.1.1.2.3" xref="S3.SS1.p1.6.m6.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">ℛ</mi><mrow id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml"><msub id="S3.SS1.p1.6.m6.1.1.3.3.2" xref="S3.SS1.p1.6.m6.1.1.3.3.2.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.3.2.2" xref="S3.SS1.p1.6.m6.1.1.3.3.2.2.cmml">J</mi><mi id="S3.SS1.p1.6.m6.1.1.3.3.2.3" xref="S3.SS1.p1.6.m6.1.1.3.3.2.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.6.m6.1.1.3.3.1" xref="S3.SS1.p1.6.m6.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p1.6.m6.1.1.3.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.3.3.2" xref="S3.SS1.p1.6.m6.1.1.3.3.3.2.cmml">J</mi><mrow id="S3.SS1.p1.6.m6.1.1.3.3.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.3.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.3.3.3.2" xref="S3.SS1.p1.6.m6.1.1.3.3.3.3.2.cmml">l</mi><mo id="S3.SS1.p1.6.m6.1.1.3.3.3.3.1" xref="S3.SS1.p1.6.m6.1.1.3.3.3.3.1.cmml">−</mo><mn id="S3.SS1.p1.6.m6.1.1.3.3.3.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.3.3.3.cmml">1</mn></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><in id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></in><apply id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2.2">𝑊</ci><ci id="S3.SS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.2.3">𝑙</ci></apply><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">ℛ</ci><apply id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3"><times id="S3.SS1.p1.6.m6.1.1.3.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.1"></times><apply id="S3.SS1.p1.6.m6.1.1.3.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.3.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.3.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.2.2">𝐽</ci><ci id="S3.SS1.p1.6.m6.1.1.3.3.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.2.3">𝑙</ci></apply><apply id="S3.SS1.p1.6.m6.1.1.3.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.3.2">𝐽</ci><apply id="S3.SS1.p1.6.m6.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.3.3"><minus id="S3.SS1.p1.6.m6.1.1.3.3.3.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.3.3.1"></minus><ci id="S3.SS1.p1.6.m6.1.1.3.3.3.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.3.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p1.6.m6.1.1.3.3.3.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">W_{l}\in\mathcal{R}^{J_{l}\times J_{l-1}}</annotation></semantics></math> and the bias vector <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="b_{l}\in\mathcal{R}^{J_{l}}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><msub id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2.2" xref="S3.SS1.p1.7.m7.1.1.2.2.cmml">b</mi><mi id="S3.SS1.p1.7.m7.1.1.2.3" xref="S3.SS1.p1.7.m7.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS1.p1.7.m7.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">ℛ</mi><msub id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.3.2" xref="S3.SS1.p1.7.m7.1.1.3.3.2.cmml">J</mi><mi id="S3.SS1.p1.7.m7.1.1.3.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.3.cmml">l</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><in id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1"></in><apply id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2.2">𝑏</ci><ci id="S3.SS1.p1.7.m7.1.1.2.3.cmml" xref="S3.SS1.p1.7.m7.1.1.2.3">𝑙</ci></apply><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">ℛ</ci><apply id="S3.SS1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.3.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.3.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3.2">𝐽</ci><ci id="S3.SS1.p1.7.m7.1.1.3.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">b_{l}\in\mathcal{R}^{J_{l}}</annotation></semantics></math>, <math id="S3.SS1.p1.8.m8.4" class="ltx_Math" alttext="l\in\{1,2,\cdots,L\}" display="inline"><semantics id="S3.SS1.p1.8.m8.4a"><mrow id="S3.SS1.p1.8.m8.4.5" xref="S3.SS1.p1.8.m8.4.5.cmml"><mi id="S3.SS1.p1.8.m8.4.5.2" xref="S3.SS1.p1.8.m8.4.5.2.cmml">l</mi><mo id="S3.SS1.p1.8.m8.4.5.1" xref="S3.SS1.p1.8.m8.4.5.1.cmml">∈</mo><mrow id="S3.SS1.p1.8.m8.4.5.3.2" xref="S3.SS1.p1.8.m8.4.5.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.8.m8.4.5.3.2.1" xref="S3.SS1.p1.8.m8.4.5.3.1.cmml">{</mo><mn id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">1</mn><mo id="S3.SS1.p1.8.m8.4.5.3.2.2" xref="S3.SS1.p1.8.m8.4.5.3.1.cmml">,</mo><mn id="S3.SS1.p1.8.m8.2.2" xref="S3.SS1.p1.8.m8.2.2.cmml">2</mn><mo id="S3.SS1.p1.8.m8.4.5.3.2.3" xref="S3.SS1.p1.8.m8.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.8.m8.3.3" xref="S3.SS1.p1.8.m8.3.3.cmml">⋯</mi><mo id="S3.SS1.p1.8.m8.4.5.3.2.4" xref="S3.SS1.p1.8.m8.4.5.3.1.cmml">,</mo><mi id="S3.SS1.p1.8.m8.4.4" xref="S3.SS1.p1.8.m8.4.4.cmml">L</mi><mo stretchy="false" id="S3.SS1.p1.8.m8.4.5.3.2.5" xref="S3.SS1.p1.8.m8.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.4b"><apply id="S3.SS1.p1.8.m8.4.5.cmml" xref="S3.SS1.p1.8.m8.4.5"><in id="S3.SS1.p1.8.m8.4.5.1.cmml" xref="S3.SS1.p1.8.m8.4.5.1"></in><ci id="S3.SS1.p1.8.m8.4.5.2.cmml" xref="S3.SS1.p1.8.m8.4.5.2">𝑙</ci><set id="S3.SS1.p1.8.m8.4.5.3.1.cmml" xref="S3.SS1.p1.8.m8.4.5.3.2"><cn type="integer" id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">1</cn><cn type="integer" id="S3.SS1.p1.8.m8.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2">2</cn><ci id="S3.SS1.p1.8.m8.3.3.cmml" xref="S3.SS1.p1.8.m8.3.3">⋯</ci><ci id="S3.SS1.p1.8.m8.4.4.cmml" xref="S3.SS1.p1.8.m8.4.4">𝐿</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.4c">l\in\{1,2,\cdots,L\}</annotation></semantics></math>. The input layer does not have parameters. We use <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="h_{l}\in\mathcal{R}^{J_{l}}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><msub id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2.2" xref="S3.SS1.p1.9.m9.1.1.2.2.cmml">h</mi><mi id="S3.SS1.p1.9.m9.1.1.2.3" xref="S3.SS1.p1.9.m9.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS1.p1.9.m9.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1.3.2" xref="S3.SS1.p1.9.m9.1.1.3.2.cmml">ℛ</mi><msub id="S3.SS1.p1.9.m9.1.1.3.3" xref="S3.SS1.p1.9.m9.1.1.3.3.cmml"><mi id="S3.SS1.p1.9.m9.1.1.3.3.2" xref="S3.SS1.p1.9.m9.1.1.3.3.2.cmml">J</mi><mi id="S3.SS1.p1.9.m9.1.1.3.3.3" xref="S3.SS1.p1.9.m9.1.1.3.3.3.cmml">l</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><in id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1"></in><apply id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2.2">ℎ</ci><ci id="S3.SS1.p1.9.m9.1.1.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.2.3">𝑙</ci></apply><apply id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2">ℛ</ci><apply id="S3.SS1.p1.9.m9.1.1.3.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.3.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.3.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.3.2">𝐽</ci><ci id="S3.SS1.p1.9.m9.1.1.3.3.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">h_{l}\in\mathcal{R}^{J_{l}}</annotation></semantics></math> as the activations of the <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">l</annotation></semantics></math>th layer. We have <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="h_{l}=f_{l}(W_{l}h_{l-1}+b_{l})" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mrow id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><msub id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.3.2" xref="S3.SS1.p1.11.m11.1.1.3.2.cmml">h</mi><mi id="S3.SS1.p1.11.m11.1.1.3.3" xref="S3.SS1.p1.11.m11.1.1.3.3.cmml">l</mi></msub><mo id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.11.m11.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.cmml"><msub id="S3.SS1.p1.11.m11.1.1.1.3" xref="S3.SS1.p1.11.m11.1.1.1.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.1.3.2" xref="S3.SS1.p1.11.m11.1.1.1.3.2.cmml">f</mi><mi id="S3.SS1.p1.11.m11.1.1.1.3.3" xref="S3.SS1.p1.11.m11.1.1.1.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.m11.1.1.1.2" xref="S3.SS1.p1.11.m11.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.11.m11.1.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.11.m11.1.1.1.1.1.2" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.11.m11.1.1.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.cmml"><mrow id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.cmml"><msub id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.1" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.2" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.2.cmml">h</mi><mrow id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.2" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.2.cmml">l</mi><mo id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.1" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.1.cmml">−</mo><mn id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.3" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.SS1.p1.11.m11.1.1.1.1.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.SS1.p1.11.m11.1.1.1.1.1.1.3" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.11.m11.1.1.1.1.1.1.3.2" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.SS1.p1.11.m11.1.1.1.1.1.1.3.3" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo stretchy="false" id="S3.SS1.p1.11.m11.1.1.1.1.1.3" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><eq id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2"></eq><apply id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.3.2">ℎ</ci><ci id="S3.SS1.p1.11.m11.1.1.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3.3">𝑙</ci></apply><apply id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1"><times id="S3.SS1.p1.11.m11.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.2"></times><apply id="S3.SS1.p1.11.m11.1.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.1.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.3.2">𝑓</ci><ci id="S3.SS1.p1.11.m11.1.1.1.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.1.3.3">𝑙</ci></apply><apply id="S3.SS1.p1.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1"><plus id="S3.SS1.p1.11.m11.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.1"></plus><apply id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2"><times id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.1"></times><apply id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.2.3">𝑙</ci></apply><apply id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.2">ℎ</ci><apply id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3"><minus id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.1"></minus><ci id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.SS1.p1.11.m11.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.SS1.p1.11.m11.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.11.m11.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">h_{l}=f_{l}(W_{l}h_{l-1}+b_{l})</annotation></semantics></math>, where <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="f_{l}(\cdot)" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><mrow id="S3.SS1.p1.12.m12.1.2" xref="S3.SS1.p1.12.m12.1.2.cmml"><msub id="S3.SS1.p1.12.m12.1.2.2" xref="S3.SS1.p1.12.m12.1.2.2.cmml"><mi id="S3.SS1.p1.12.m12.1.2.2.2" xref="S3.SS1.p1.12.m12.1.2.2.2.cmml">f</mi><mi id="S3.SS1.p1.12.m12.1.2.2.3" xref="S3.SS1.p1.12.m12.1.2.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.12.m12.1.2.1" xref="S3.SS1.p1.12.m12.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.12.m12.1.2.3.2" xref="S3.SS1.p1.12.m12.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.12.m12.1.2.3.2.1" xref="S3.SS1.p1.12.m12.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.12.m12.1.2.3.2.2" xref="S3.SS1.p1.12.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.2.cmml" xref="S3.SS1.p1.12.m12.1.2"><times id="S3.SS1.p1.12.m12.1.2.1.cmml" xref="S3.SS1.p1.12.m12.1.2.1"></times><apply id="S3.SS1.p1.12.m12.1.2.2.cmml" xref="S3.SS1.p1.12.m12.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.2.2.1.cmml" xref="S3.SS1.p1.12.m12.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.2.2.2.cmml" xref="S3.SS1.p1.12.m12.1.2.2.2">𝑓</ci><ci id="S3.SS1.p1.12.m12.1.2.2.3.cmml" xref="S3.SS1.p1.12.m12.1.2.2.3">𝑙</ci></apply><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">f_{l}(\cdot)</annotation></semantics></math> is the element-wise activation function, e.g., ReLU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. <math id="S3.SS1.p1.13.m13.1" class="ltx_Math" alttext="f_{L}(x)=x" display="inline"><semantics id="S3.SS1.p1.13.m13.1a"><mrow id="S3.SS1.p1.13.m13.1.2" xref="S3.SS1.p1.13.m13.1.2.cmml"><mrow id="S3.SS1.p1.13.m13.1.2.2" xref="S3.SS1.p1.13.m13.1.2.2.cmml"><msub id="S3.SS1.p1.13.m13.1.2.2.2" xref="S3.SS1.p1.13.m13.1.2.2.2.cmml"><mi id="S3.SS1.p1.13.m13.1.2.2.2.2" xref="S3.SS1.p1.13.m13.1.2.2.2.2.cmml">f</mi><mi id="S3.SS1.p1.13.m13.1.2.2.2.3" xref="S3.SS1.p1.13.m13.1.2.2.2.3.cmml">L</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.13.m13.1.2.2.1" xref="S3.SS1.p1.13.m13.1.2.2.1.cmml">​</mo><mrow id="S3.SS1.p1.13.m13.1.2.2.3.2" xref="S3.SS1.p1.13.m13.1.2.2.cmml"><mo stretchy="false" id="S3.SS1.p1.13.m13.1.2.2.3.2.1" xref="S3.SS1.p1.13.m13.1.2.2.cmml">(</mo><mi id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.p1.13.m13.1.2.2.3.2.2" xref="S3.SS1.p1.13.m13.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.13.m13.1.2.1" xref="S3.SS1.p1.13.m13.1.2.1.cmml">=</mo><mi id="S3.SS1.p1.13.m13.1.2.3" xref="S3.SS1.p1.13.m13.1.2.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.2.cmml" xref="S3.SS1.p1.13.m13.1.2"><eq id="S3.SS1.p1.13.m13.1.2.1.cmml" xref="S3.SS1.p1.13.m13.1.2.1"></eq><apply id="S3.SS1.p1.13.m13.1.2.2.cmml" xref="S3.SS1.p1.13.m13.1.2.2"><times id="S3.SS1.p1.13.m13.1.2.2.1.cmml" xref="S3.SS1.p1.13.m13.1.2.2.1"></times><apply id="S3.SS1.p1.13.m13.1.2.2.2.cmml" xref="S3.SS1.p1.13.m13.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.2.2.2.1.cmml" xref="S3.SS1.p1.13.m13.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.2.2.2.2.cmml" xref="S3.SS1.p1.13.m13.1.2.2.2.2">𝑓</ci><ci id="S3.SS1.p1.13.m13.1.2.2.2.3.cmml" xref="S3.SS1.p1.13.m13.1.2.2.2.3">𝐿</ci></apply><ci id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">𝑥</ci></apply><ci id="S3.SS1.p1.13.m13.1.2.3.cmml" xref="S3.SS1.p1.13.m13.1.2.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">f_{L}(x)=x</annotation></semantics></math> denotes no activation function in the output layer. Sometimes, we use <math id="S3.SS1.p1.14.m14.1" class="ltx_Math" alttext="y=v^{T}f(Wx+b)" display="inline"><semantics id="S3.SS1.p1.14.m14.1a"><mrow id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml">y</mi><mo id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.14.m14.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.cmml"><msup id="S3.SS1.p1.14.m14.1.1.1.3" xref="S3.SS1.p1.14.m14.1.1.1.3.cmml"><mi id="S3.SS1.p1.14.m14.1.1.1.3.2" xref="S3.SS1.p1.14.m14.1.1.1.3.2.cmml">v</mi><mi id="S3.SS1.p1.14.m14.1.1.1.3.3" xref="S3.SS1.p1.14.m14.1.1.1.3.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m14.1.1.1.2" xref="S3.SS1.p1.14.m14.1.1.1.2.cmml">​</mo><mi id="S3.SS1.p1.14.m14.1.1.1.4" xref="S3.SS1.p1.14.m14.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m14.1.1.1.2a" xref="S3.SS1.p1.14.m14.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.14.m14.1.1.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.14.m14.1.1.1.1.1.2" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.14.m14.1.1.1.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.cmml"><mrow id="S3.SS1.p1.14.m14.1.1.1.1.1.1.2" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.1" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.3.cmml">x</mi></mrow><mo id="S3.SS1.p1.14.m14.1.1.1.1.1.1.1" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.SS1.p1.14.m14.1.1.1.1.1.1.3" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo stretchy="false" id="S3.SS1.p1.14.m14.1.1.1.1.1.3" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><eq id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2"></eq><ci id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3">𝑦</ci><apply id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1"><times id="S3.SS1.p1.14.m14.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.2"></times><apply id="S3.SS1.p1.14.m14.1.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.3.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.1.3.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.3.2">𝑣</ci><ci id="S3.SS1.p1.14.m14.1.1.1.3.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.3.3">𝑇</ci></apply><ci id="S3.SS1.p1.14.m14.1.1.1.4.cmml" xref="S3.SS1.p1.14.m14.1.1.1.4">𝑓</ci><apply id="S3.SS1.p1.14.m14.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1"><plus id="S3.SS1.p1.14.m14.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.1"></plus><apply id="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.2"><times id="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.1"></times><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.2">𝑊</ci><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.2.3">𝑥</ci></apply><ci id="S3.SS1.p1.14.m14.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.1.1.1.1.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">y=v^{T}f(Wx+b)</annotation></semantics></math> to represent a network with only one hidden layer and the output dimension is one (called as MLP0), where <math id="S3.SS1.p1.15.m15.1" class="ltx_Math" alttext="x\in\mathcal{R}^{J_{0}}" display="inline"><semantics id="S3.SS1.p1.15.m15.1a"><mrow id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml"><mi id="S3.SS1.p1.15.m15.1.1.2" xref="S3.SS1.p1.15.m15.1.1.2.cmml">x</mi><mo id="S3.SS1.p1.15.m15.1.1.1" xref="S3.SS1.p1.15.m15.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.15.m15.1.1.3" xref="S3.SS1.p1.15.m15.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.15.m15.1.1.3.2" xref="S3.SS1.p1.15.m15.1.1.3.2.cmml">ℛ</mi><msub id="S3.SS1.p1.15.m15.1.1.3.3" xref="S3.SS1.p1.15.m15.1.1.3.3.cmml"><mi id="S3.SS1.p1.15.m15.1.1.3.3.2" xref="S3.SS1.p1.15.m15.1.1.3.3.2.cmml">J</mi><mn id="S3.SS1.p1.15.m15.1.1.3.3.3" xref="S3.SS1.p1.15.m15.1.1.3.3.3.cmml">0</mn></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1"><in id="S3.SS1.p1.15.m15.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1.1"></in><ci id="S3.SS1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.2">𝑥</ci><apply id="S3.SS1.p1.15.m15.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.3.1.cmml" xref="S3.SS1.p1.15.m15.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.3.2.cmml" xref="S3.SS1.p1.15.m15.1.1.3.2">ℛ</ci><apply id="S3.SS1.p1.15.m15.1.1.3.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.3.3.1.cmml" xref="S3.SS1.p1.15.m15.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.3.3.2.cmml" xref="S3.SS1.p1.15.m15.1.1.3.3.2">𝐽</ci><cn type="integer" id="S3.SS1.p1.15.m15.1.1.3.3.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">x\in\mathcal{R}^{J_{0}}</annotation></semantics></math>, <math id="S3.SS1.p1.16.m16.1" class="ltx_Math" alttext="W\in\mathcal{R}^{J\times J_{0}}" display="inline"><semantics id="S3.SS1.p1.16.m16.1a"><mrow id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml"><mi id="S3.SS1.p1.16.m16.1.1.2" xref="S3.SS1.p1.16.m16.1.1.2.cmml">W</mi><mo id="S3.SS1.p1.16.m16.1.1.1" xref="S3.SS1.p1.16.m16.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.16.m16.1.1.3" xref="S3.SS1.p1.16.m16.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.16.m16.1.1.3.2" xref="S3.SS1.p1.16.m16.1.1.3.2.cmml">ℛ</mi><mrow id="S3.SS1.p1.16.m16.1.1.3.3" xref="S3.SS1.p1.16.m16.1.1.3.3.cmml"><mi id="S3.SS1.p1.16.m16.1.1.3.3.2" xref="S3.SS1.p1.16.m16.1.1.3.3.2.cmml">J</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.16.m16.1.1.3.3.1" xref="S3.SS1.p1.16.m16.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p1.16.m16.1.1.3.3.3" xref="S3.SS1.p1.16.m16.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.16.m16.1.1.3.3.3.2" xref="S3.SS1.p1.16.m16.1.1.3.3.3.2.cmml">J</mi><mn id="S3.SS1.p1.16.m16.1.1.3.3.3.3" xref="S3.SS1.p1.16.m16.1.1.3.3.3.3.cmml">0</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><apply id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1"><in id="S3.SS1.p1.16.m16.1.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1.1"></in><ci id="S3.SS1.p1.16.m16.1.1.2.cmml" xref="S3.SS1.p1.16.m16.1.1.2">𝑊</ci><apply id="S3.SS1.p1.16.m16.1.1.3.cmml" xref="S3.SS1.p1.16.m16.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.1.1.3.1.cmml" xref="S3.SS1.p1.16.m16.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.16.m16.1.1.3.2.cmml" xref="S3.SS1.p1.16.m16.1.1.3.2">ℛ</ci><apply id="S3.SS1.p1.16.m16.1.1.3.3.cmml" xref="S3.SS1.p1.16.m16.1.1.3.3"><times id="S3.SS1.p1.16.m16.1.1.3.3.1.cmml" xref="S3.SS1.p1.16.m16.1.1.3.3.1"></times><ci id="S3.SS1.p1.16.m16.1.1.3.3.2.cmml" xref="S3.SS1.p1.16.m16.1.1.3.3.2">𝐽</ci><apply id="S3.SS1.p1.16.m16.1.1.3.3.3.cmml" xref="S3.SS1.p1.16.m16.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.16.m16.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.16.m16.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.16.m16.1.1.3.3.3.2">𝐽</ci><cn type="integer" id="S3.SS1.p1.16.m16.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.16.m16.1.1.3.3.3.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">W\in\mathcal{R}^{J\times J_{0}}</annotation></semantics></math>, <math id="S3.SS1.p1.17.m17.1" class="ltx_Math" alttext="b\in\mathcal{R}^{J}" display="inline"><semantics id="S3.SS1.p1.17.m17.1a"><mrow id="S3.SS1.p1.17.m17.1.1" xref="S3.SS1.p1.17.m17.1.1.cmml"><mi id="S3.SS1.p1.17.m17.1.1.2" xref="S3.SS1.p1.17.m17.1.1.2.cmml">b</mi><mo id="S3.SS1.p1.17.m17.1.1.1" xref="S3.SS1.p1.17.m17.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.17.m17.1.1.3" xref="S3.SS1.p1.17.m17.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.17.m17.1.1.3.2" xref="S3.SS1.p1.17.m17.1.1.3.2.cmml">ℛ</mi><mi id="S3.SS1.p1.17.m17.1.1.3.3" xref="S3.SS1.p1.17.m17.1.1.3.3.cmml">J</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m17.1b"><apply id="S3.SS1.p1.17.m17.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1"><in id="S3.SS1.p1.17.m17.1.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1.1"></in><ci id="S3.SS1.p1.17.m17.1.1.2.cmml" xref="S3.SS1.p1.17.m17.1.1.2">𝑏</ci><apply id="S3.SS1.p1.17.m17.1.1.3.cmml" xref="S3.SS1.p1.17.m17.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m17.1.1.3.1.cmml" xref="S3.SS1.p1.17.m17.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.17.m17.1.1.3.2.cmml" xref="S3.SS1.p1.17.m17.1.1.3.2">ℛ</ci><ci id="S3.SS1.p1.17.m17.1.1.3.3.cmml" xref="S3.SS1.p1.17.m17.1.1.3.3">𝐽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m17.1c">b\in\mathcal{R}^{J}</annotation></semantics></math>, <math id="S3.SS1.p1.18.m18.1" class="ltx_Math" alttext="v\in\mathcal{R}^{J}" display="inline"><semantics id="S3.SS1.p1.18.m18.1a"><mrow id="S3.SS1.p1.18.m18.1.1" xref="S3.SS1.p1.18.m18.1.1.cmml"><mi id="S3.SS1.p1.18.m18.1.1.2" xref="S3.SS1.p1.18.m18.1.1.2.cmml">v</mi><mo id="S3.SS1.p1.18.m18.1.1.1" xref="S3.SS1.p1.18.m18.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.18.m18.1.1.3" xref="S3.SS1.p1.18.m18.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.18.m18.1.1.3.2" xref="S3.SS1.p1.18.m18.1.1.3.2.cmml">ℛ</mi><mi id="S3.SS1.p1.18.m18.1.1.3.3" xref="S3.SS1.p1.18.m18.1.1.3.3.cmml">J</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m18.1b"><apply id="S3.SS1.p1.18.m18.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1"><in id="S3.SS1.p1.18.m18.1.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1.1"></in><ci id="S3.SS1.p1.18.m18.1.1.2.cmml" xref="S3.SS1.p1.18.m18.1.1.2">𝑣</ci><apply id="S3.SS1.p1.18.m18.1.1.3.cmml" xref="S3.SS1.p1.18.m18.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.1.1.3.1.cmml" xref="S3.SS1.p1.18.m18.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.18.m18.1.1.3.2.cmml" xref="S3.SS1.p1.18.m18.1.1.3.2">ℛ</ci><ci id="S3.SS1.p1.18.m18.1.1.3.3.cmml" xref="S3.SS1.p1.18.m18.1.1.3.3">𝐽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m18.1c">v\in\mathcal{R}^{J}</annotation></semantics></math>. We use <math id="S3.SS1.p1.19.m19.2" class="ltx_Math" alttext="\Pi\in\{0,1\}^{J\times J}" display="inline"><semantics id="S3.SS1.p1.19.m19.2a"><mrow id="S3.SS1.p1.19.m19.2.3" xref="S3.SS1.p1.19.m19.2.3.cmml"><mi mathvariant="normal" id="S3.SS1.p1.19.m19.2.3.2" xref="S3.SS1.p1.19.m19.2.3.2.cmml">Π</mi><mo id="S3.SS1.p1.19.m19.2.3.1" xref="S3.SS1.p1.19.m19.2.3.1.cmml">∈</mo><msup id="S3.SS1.p1.19.m19.2.3.3" xref="S3.SS1.p1.19.m19.2.3.3.cmml"><mrow id="S3.SS1.p1.19.m19.2.3.3.2.2" xref="S3.SS1.p1.19.m19.2.3.3.2.1.cmml"><mo stretchy="false" id="S3.SS1.p1.19.m19.2.3.3.2.2.1" xref="S3.SS1.p1.19.m19.2.3.3.2.1.cmml">{</mo><mn id="S3.SS1.p1.19.m19.1.1" xref="S3.SS1.p1.19.m19.1.1.cmml">0</mn><mo id="S3.SS1.p1.19.m19.2.3.3.2.2.2" xref="S3.SS1.p1.19.m19.2.3.3.2.1.cmml">,</mo><mn id="S3.SS1.p1.19.m19.2.2" xref="S3.SS1.p1.19.m19.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS1.p1.19.m19.2.3.3.2.2.3" xref="S3.SS1.p1.19.m19.2.3.3.2.1.cmml">}</mo></mrow><mrow id="S3.SS1.p1.19.m19.2.3.3.3" xref="S3.SS1.p1.19.m19.2.3.3.3.cmml"><mi id="S3.SS1.p1.19.m19.2.3.3.3.2" xref="S3.SS1.p1.19.m19.2.3.3.3.2.cmml">J</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.19.m19.2.3.3.3.1" xref="S3.SS1.p1.19.m19.2.3.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.19.m19.2.3.3.3.3" xref="S3.SS1.p1.19.m19.2.3.3.3.3.cmml">J</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m19.2b"><apply id="S3.SS1.p1.19.m19.2.3.cmml" xref="S3.SS1.p1.19.m19.2.3"><in id="S3.SS1.p1.19.m19.2.3.1.cmml" xref="S3.SS1.p1.19.m19.2.3.1"></in><ci id="S3.SS1.p1.19.m19.2.3.2.cmml" xref="S3.SS1.p1.19.m19.2.3.2">Π</ci><apply id="S3.SS1.p1.19.m19.2.3.3.cmml" xref="S3.SS1.p1.19.m19.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.19.m19.2.3.3.1.cmml" xref="S3.SS1.p1.19.m19.2.3.3">superscript</csymbol><set id="S3.SS1.p1.19.m19.2.3.3.2.1.cmml" xref="S3.SS1.p1.19.m19.2.3.3.2.2"><cn type="integer" id="S3.SS1.p1.19.m19.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1">0</cn><cn type="integer" id="S3.SS1.p1.19.m19.2.2.cmml" xref="S3.SS1.p1.19.m19.2.2">1</cn></set><apply id="S3.SS1.p1.19.m19.2.3.3.3.cmml" xref="S3.SS1.p1.19.m19.2.3.3.3"><times id="S3.SS1.p1.19.m19.2.3.3.3.1.cmml" xref="S3.SS1.p1.19.m19.2.3.3.3.1"></times><ci id="S3.SS1.p1.19.m19.2.3.3.3.2.cmml" xref="S3.SS1.p1.19.m19.2.3.3.3.2">𝐽</ci><ci id="S3.SS1.p1.19.m19.2.3.3.3.3.cmml" xref="S3.SS1.p1.19.m19.2.3.3.3.3">𝐽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m19.2c">\Pi\in\{0,1\}^{J\times J}</annotation></semantics></math> as a permutation matrix that satisfies <math id="S3.SS1.p1.20.m20.2" class="ltx_Math" alttext="\sum_{j}\Pi_{\cdot,j}=1" display="inline"><semantics id="S3.SS1.p1.20.m20.2a"><mrow id="S3.SS1.p1.20.m20.2.3" xref="S3.SS1.p1.20.m20.2.3.cmml"><mrow id="S3.SS1.p1.20.m20.2.3.2" xref="S3.SS1.p1.20.m20.2.3.2.cmml"><msub id="S3.SS1.p1.20.m20.2.3.2.1" xref="S3.SS1.p1.20.m20.2.3.2.1.cmml"><mo id="S3.SS1.p1.20.m20.2.3.2.1.2" xref="S3.SS1.p1.20.m20.2.3.2.1.2.cmml">∑</mo><mi id="S3.SS1.p1.20.m20.2.3.2.1.3" xref="S3.SS1.p1.20.m20.2.3.2.1.3.cmml">j</mi></msub><msub id="S3.SS1.p1.20.m20.2.3.2.2" xref="S3.SS1.p1.20.m20.2.3.2.2.cmml"><mi mathvariant="normal" id="S3.SS1.p1.20.m20.2.3.2.2.2" xref="S3.SS1.p1.20.m20.2.3.2.2.2.cmml">Π</mi><mrow id="S3.SS1.p1.20.m20.2.2.2.4" xref="S3.SS1.p1.20.m20.2.2.2.3.cmml"><mo rspace="0em" id="S3.SS1.p1.20.m20.1.1.1.1" xref="S3.SS1.p1.20.m20.1.1.1.1.cmml">⋅</mo><mo id="S3.SS1.p1.20.m20.2.2.2.4.1" xref="S3.SS1.p1.20.m20.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.20.m20.2.2.2.2" xref="S3.SS1.p1.20.m20.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.SS1.p1.20.m20.2.3.1" xref="S3.SS1.p1.20.m20.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.20.m20.2.3.3" xref="S3.SS1.p1.20.m20.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m20.2b"><apply id="S3.SS1.p1.20.m20.2.3.cmml" xref="S3.SS1.p1.20.m20.2.3"><eq id="S3.SS1.p1.20.m20.2.3.1.cmml" xref="S3.SS1.p1.20.m20.2.3.1"></eq><apply id="S3.SS1.p1.20.m20.2.3.2.cmml" xref="S3.SS1.p1.20.m20.2.3.2"><apply id="S3.SS1.p1.20.m20.2.3.2.1.cmml" xref="S3.SS1.p1.20.m20.2.3.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.20.m20.2.3.2.1.1.cmml" xref="S3.SS1.p1.20.m20.2.3.2.1">subscript</csymbol><sum id="S3.SS1.p1.20.m20.2.3.2.1.2.cmml" xref="S3.SS1.p1.20.m20.2.3.2.1.2"></sum><ci id="S3.SS1.p1.20.m20.2.3.2.1.3.cmml" xref="S3.SS1.p1.20.m20.2.3.2.1.3">𝑗</ci></apply><apply id="S3.SS1.p1.20.m20.2.3.2.2.cmml" xref="S3.SS1.p1.20.m20.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.20.m20.2.3.2.2.1.cmml" xref="S3.SS1.p1.20.m20.2.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.20.m20.2.3.2.2.2.cmml" xref="S3.SS1.p1.20.m20.2.3.2.2.2">Π</ci><list id="S3.SS1.p1.20.m20.2.2.2.3.cmml" xref="S3.SS1.p1.20.m20.2.2.2.4"><ci id="S3.SS1.p1.20.m20.1.1.1.1.cmml" xref="S3.SS1.p1.20.m20.1.1.1.1">⋅</ci><ci id="S3.SS1.p1.20.m20.2.2.2.2.cmml" xref="S3.SS1.p1.20.m20.2.2.2.2">𝑗</ci></list></apply></apply><cn type="integer" id="S3.SS1.p1.20.m20.2.3.3.cmml" xref="S3.SS1.p1.20.m20.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.20.m20.2c">\sum_{j}\Pi_{\cdot,j}=1</annotation></semantics></math> and <math id="S3.SS1.p1.21.m21.2" class="ltx_Math" alttext="\sum_{j}\Pi_{j,\cdot}=1" display="inline"><semantics id="S3.SS1.p1.21.m21.2a"><mrow id="S3.SS1.p1.21.m21.2.3" xref="S3.SS1.p1.21.m21.2.3.cmml"><mrow id="S3.SS1.p1.21.m21.2.3.2" xref="S3.SS1.p1.21.m21.2.3.2.cmml"><msub id="S3.SS1.p1.21.m21.2.3.2.1" xref="S3.SS1.p1.21.m21.2.3.2.1.cmml"><mo id="S3.SS1.p1.21.m21.2.3.2.1.2" xref="S3.SS1.p1.21.m21.2.3.2.1.2.cmml">∑</mo><mi id="S3.SS1.p1.21.m21.2.3.2.1.3" xref="S3.SS1.p1.21.m21.2.3.2.1.3.cmml">j</mi></msub><msub id="S3.SS1.p1.21.m21.2.3.2.2" xref="S3.SS1.p1.21.m21.2.3.2.2.cmml"><mi mathvariant="normal" id="S3.SS1.p1.21.m21.2.3.2.2.2" xref="S3.SS1.p1.21.m21.2.3.2.2.2.cmml">Π</mi><mrow id="S3.SS1.p1.21.m21.2.2.2.4" xref="S3.SS1.p1.21.m21.2.2.2.3.cmml"><mi id="S3.SS1.p1.21.m21.1.1.1.1" xref="S3.SS1.p1.21.m21.1.1.1.1.cmml">j</mi><mo rspace="0em" id="S3.SS1.p1.21.m21.2.2.2.4.1" xref="S3.SS1.p1.21.m21.2.2.2.3.cmml">,</mo><mo lspace="0em" id="S3.SS1.p1.21.m21.2.2.2.2" xref="S3.SS1.p1.21.m21.2.2.2.2.cmml">⋅</mo></mrow></msub></mrow><mo id="S3.SS1.p1.21.m21.2.3.1" xref="S3.SS1.p1.21.m21.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.21.m21.2.3.3" xref="S3.SS1.p1.21.m21.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.21.m21.2b"><apply id="S3.SS1.p1.21.m21.2.3.cmml" xref="S3.SS1.p1.21.m21.2.3"><eq id="S3.SS1.p1.21.m21.2.3.1.cmml" xref="S3.SS1.p1.21.m21.2.3.1"></eq><apply id="S3.SS1.p1.21.m21.2.3.2.cmml" xref="S3.SS1.p1.21.m21.2.3.2"><apply id="S3.SS1.p1.21.m21.2.3.2.1.cmml" xref="S3.SS1.p1.21.m21.2.3.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.21.m21.2.3.2.1.1.cmml" xref="S3.SS1.p1.21.m21.2.3.2.1">subscript</csymbol><sum id="S3.SS1.p1.21.m21.2.3.2.1.2.cmml" xref="S3.SS1.p1.21.m21.2.3.2.1.2"></sum><ci id="S3.SS1.p1.21.m21.2.3.2.1.3.cmml" xref="S3.SS1.p1.21.m21.2.3.2.1.3">𝑗</ci></apply><apply id="S3.SS1.p1.21.m21.2.3.2.2.cmml" xref="S3.SS1.p1.21.m21.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.21.m21.2.3.2.2.1.cmml" xref="S3.SS1.p1.21.m21.2.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.21.m21.2.3.2.2.2.cmml" xref="S3.SS1.p1.21.m21.2.3.2.2.2">Π</ci><list id="S3.SS1.p1.21.m21.2.2.2.3.cmml" xref="S3.SS1.p1.21.m21.2.2.2.4"><ci id="S3.SS1.p1.21.m21.1.1.1.1.cmml" xref="S3.SS1.p1.21.m21.1.1.1.1">𝑗</ci><ci id="S3.SS1.p1.21.m21.2.2.2.2.cmml" xref="S3.SS1.p1.21.m21.2.2.2.2">⋅</ci></list></apply></apply><cn type="integer" id="S3.SS1.p1.21.m21.2.3.3.cmml" xref="S3.SS1.p1.21.m21.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.21.m21.2c">\sum_{j}\Pi_{j,\cdot}=1</annotation></semantics></math>. Easily, we have some properties: <math id="S3.SS1.p1.22.m22.1" class="ltx_Math" alttext="\Pi^{T}\Pi=I" display="inline"><semantics id="S3.SS1.p1.22.m22.1a"><mrow id="S3.SS1.p1.22.m22.1.1" xref="S3.SS1.p1.22.m22.1.1.cmml"><mrow id="S3.SS1.p1.22.m22.1.1.2" xref="S3.SS1.p1.22.m22.1.1.2.cmml"><msup id="S3.SS1.p1.22.m22.1.1.2.2" xref="S3.SS1.p1.22.m22.1.1.2.2.cmml"><mi mathvariant="normal" id="S3.SS1.p1.22.m22.1.1.2.2.2" xref="S3.SS1.p1.22.m22.1.1.2.2.2.cmml">Π</mi><mi id="S3.SS1.p1.22.m22.1.1.2.2.3" xref="S3.SS1.p1.22.m22.1.1.2.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p1.22.m22.1.1.2.1" xref="S3.SS1.p1.22.m22.1.1.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS1.p1.22.m22.1.1.2.3" xref="S3.SS1.p1.22.m22.1.1.2.3.cmml">Π</mi></mrow><mo id="S3.SS1.p1.22.m22.1.1.1" xref="S3.SS1.p1.22.m22.1.1.1.cmml">=</mo><mi id="S3.SS1.p1.22.m22.1.1.3" xref="S3.SS1.p1.22.m22.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.22.m22.1b"><apply id="S3.SS1.p1.22.m22.1.1.cmml" xref="S3.SS1.p1.22.m22.1.1"><eq id="S3.SS1.p1.22.m22.1.1.1.cmml" xref="S3.SS1.p1.22.m22.1.1.1"></eq><apply id="S3.SS1.p1.22.m22.1.1.2.cmml" xref="S3.SS1.p1.22.m22.1.1.2"><times id="S3.SS1.p1.22.m22.1.1.2.1.cmml" xref="S3.SS1.p1.22.m22.1.1.2.1"></times><apply id="S3.SS1.p1.22.m22.1.1.2.2.cmml" xref="S3.SS1.p1.22.m22.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.22.m22.1.1.2.2.1.cmml" xref="S3.SS1.p1.22.m22.1.1.2.2">superscript</csymbol><ci id="S3.SS1.p1.22.m22.1.1.2.2.2.cmml" xref="S3.SS1.p1.22.m22.1.1.2.2.2">Π</ci><ci id="S3.SS1.p1.22.m22.1.1.2.2.3.cmml" xref="S3.SS1.p1.22.m22.1.1.2.2.3">𝑇</ci></apply><ci id="S3.SS1.p1.22.m22.1.1.2.3.cmml" xref="S3.SS1.p1.22.m22.1.1.2.3">Π</ci></apply><ci id="S3.SS1.p1.22.m22.1.1.3.cmml" xref="S3.SS1.p1.22.m22.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.22.m22.1c">\Pi^{T}\Pi=I</annotation></semantics></math>, <math id="S3.SS1.p1.23.m23.1" class="ltx_Math" alttext="\Pi a+\Pi b=\Pi(a+b)" display="inline"><semantics id="S3.SS1.p1.23.m23.1a"><mrow id="S3.SS1.p1.23.m23.1.1" xref="S3.SS1.p1.23.m23.1.1.cmml"><mrow id="S3.SS1.p1.23.m23.1.1.3" xref="S3.SS1.p1.23.m23.1.1.3.cmml"><mrow id="S3.SS1.p1.23.m23.1.1.3.2" xref="S3.SS1.p1.23.m23.1.1.3.2.cmml"><mi mathvariant="normal" id="S3.SS1.p1.23.m23.1.1.3.2.2" xref="S3.SS1.p1.23.m23.1.1.3.2.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.23.m23.1.1.3.2.1" xref="S3.SS1.p1.23.m23.1.1.3.2.1.cmml">​</mo><mi id="S3.SS1.p1.23.m23.1.1.3.2.3" xref="S3.SS1.p1.23.m23.1.1.3.2.3.cmml">a</mi></mrow><mo id="S3.SS1.p1.23.m23.1.1.3.1" xref="S3.SS1.p1.23.m23.1.1.3.1.cmml">+</mo><mrow id="S3.SS1.p1.23.m23.1.1.3.3" xref="S3.SS1.p1.23.m23.1.1.3.3.cmml"><mi mathvariant="normal" id="S3.SS1.p1.23.m23.1.1.3.3.2" xref="S3.SS1.p1.23.m23.1.1.3.3.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.23.m23.1.1.3.3.1" xref="S3.SS1.p1.23.m23.1.1.3.3.1.cmml">​</mo><mi id="S3.SS1.p1.23.m23.1.1.3.3.3" xref="S3.SS1.p1.23.m23.1.1.3.3.3.cmml">b</mi></mrow></mrow><mo id="S3.SS1.p1.23.m23.1.1.2" xref="S3.SS1.p1.23.m23.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.23.m23.1.1.1" xref="S3.SS1.p1.23.m23.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p1.23.m23.1.1.1.3" xref="S3.SS1.p1.23.m23.1.1.1.3.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.23.m23.1.1.1.2" xref="S3.SS1.p1.23.m23.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.23.m23.1.1.1.1.1" xref="S3.SS1.p1.23.m23.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.23.m23.1.1.1.1.1.2" xref="S3.SS1.p1.23.m23.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.23.m23.1.1.1.1.1.1" xref="S3.SS1.p1.23.m23.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.23.m23.1.1.1.1.1.1.2" xref="S3.SS1.p1.23.m23.1.1.1.1.1.1.2.cmml">a</mi><mo id="S3.SS1.p1.23.m23.1.1.1.1.1.1.1" xref="S3.SS1.p1.23.m23.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.SS1.p1.23.m23.1.1.1.1.1.1.3" xref="S3.SS1.p1.23.m23.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo stretchy="false" id="S3.SS1.p1.23.m23.1.1.1.1.1.3" xref="S3.SS1.p1.23.m23.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.23.m23.1b"><apply id="S3.SS1.p1.23.m23.1.1.cmml" xref="S3.SS1.p1.23.m23.1.1"><eq id="S3.SS1.p1.23.m23.1.1.2.cmml" xref="S3.SS1.p1.23.m23.1.1.2"></eq><apply id="S3.SS1.p1.23.m23.1.1.3.cmml" xref="S3.SS1.p1.23.m23.1.1.3"><plus id="S3.SS1.p1.23.m23.1.1.3.1.cmml" xref="S3.SS1.p1.23.m23.1.1.3.1"></plus><apply id="S3.SS1.p1.23.m23.1.1.3.2.cmml" xref="S3.SS1.p1.23.m23.1.1.3.2"><times id="S3.SS1.p1.23.m23.1.1.3.2.1.cmml" xref="S3.SS1.p1.23.m23.1.1.3.2.1"></times><ci id="S3.SS1.p1.23.m23.1.1.3.2.2.cmml" xref="S3.SS1.p1.23.m23.1.1.3.2.2">Π</ci><ci id="S3.SS1.p1.23.m23.1.1.3.2.3.cmml" xref="S3.SS1.p1.23.m23.1.1.3.2.3">𝑎</ci></apply><apply id="S3.SS1.p1.23.m23.1.1.3.3.cmml" xref="S3.SS1.p1.23.m23.1.1.3.3"><times id="S3.SS1.p1.23.m23.1.1.3.3.1.cmml" xref="S3.SS1.p1.23.m23.1.1.3.3.1"></times><ci id="S3.SS1.p1.23.m23.1.1.3.3.2.cmml" xref="S3.SS1.p1.23.m23.1.1.3.3.2">Π</ci><ci id="S3.SS1.p1.23.m23.1.1.3.3.3.cmml" xref="S3.SS1.p1.23.m23.1.1.3.3.3">𝑏</ci></apply></apply><apply id="S3.SS1.p1.23.m23.1.1.1.cmml" xref="S3.SS1.p1.23.m23.1.1.1"><times id="S3.SS1.p1.23.m23.1.1.1.2.cmml" xref="S3.SS1.p1.23.m23.1.1.1.2"></times><ci id="S3.SS1.p1.23.m23.1.1.1.3.cmml" xref="S3.SS1.p1.23.m23.1.1.1.3">Π</ci><apply id="S3.SS1.p1.23.m23.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.23.m23.1.1.1.1.1"><plus id="S3.SS1.p1.23.m23.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.23.m23.1.1.1.1.1.1.1"></plus><ci id="S3.SS1.p1.23.m23.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.23.m23.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS1.p1.23.m23.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.23.m23.1.1.1.1.1.1.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.23.m23.1c">\Pi a+\Pi b=\Pi(a+b)</annotation></semantics></math>, <math id="S3.SS1.p1.24.m24.1" class="ltx_Math" alttext="\Pi a\odot\Pi b=\Pi(a\odot b)" display="inline"><semantics id="S3.SS1.p1.24.m24.1a"><mrow id="S3.SS1.p1.24.m24.1.1" xref="S3.SS1.p1.24.m24.1.1.cmml"><mrow id="S3.SS1.p1.24.m24.1.1.3" xref="S3.SS1.p1.24.m24.1.1.3.cmml"><mrow id="S3.SS1.p1.24.m24.1.1.3.2" xref="S3.SS1.p1.24.m24.1.1.3.2.cmml"><mrow id="S3.SS1.p1.24.m24.1.1.3.2.2" xref="S3.SS1.p1.24.m24.1.1.3.2.2.cmml"><mi mathvariant="normal" id="S3.SS1.p1.24.m24.1.1.3.2.2.2" xref="S3.SS1.p1.24.m24.1.1.3.2.2.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.24.m24.1.1.3.2.2.1" xref="S3.SS1.p1.24.m24.1.1.3.2.2.1.cmml">​</mo><mi id="S3.SS1.p1.24.m24.1.1.3.2.2.3" xref="S3.SS1.p1.24.m24.1.1.3.2.2.3.cmml">a</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.24.m24.1.1.3.2.1" xref="S3.SS1.p1.24.m24.1.1.3.2.1.cmml">⊙</mo><mi mathvariant="normal" id="S3.SS1.p1.24.m24.1.1.3.2.3" xref="S3.SS1.p1.24.m24.1.1.3.2.3.cmml">Π</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p1.24.m24.1.1.3.1" xref="S3.SS1.p1.24.m24.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.24.m24.1.1.3.3" xref="S3.SS1.p1.24.m24.1.1.3.3.cmml">b</mi></mrow><mo id="S3.SS1.p1.24.m24.1.1.2" xref="S3.SS1.p1.24.m24.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.24.m24.1.1.1" xref="S3.SS1.p1.24.m24.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p1.24.m24.1.1.1.3" xref="S3.SS1.p1.24.m24.1.1.1.3.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.24.m24.1.1.1.2" xref="S3.SS1.p1.24.m24.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.24.m24.1.1.1.1.1" xref="S3.SS1.p1.24.m24.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.24.m24.1.1.1.1.1.2" xref="S3.SS1.p1.24.m24.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.24.m24.1.1.1.1.1.1" xref="S3.SS1.p1.24.m24.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.24.m24.1.1.1.1.1.1.2" xref="S3.SS1.p1.24.m24.1.1.1.1.1.1.2.cmml">a</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.24.m24.1.1.1.1.1.1.1" xref="S3.SS1.p1.24.m24.1.1.1.1.1.1.1.cmml">⊙</mo><mi id="S3.SS1.p1.24.m24.1.1.1.1.1.1.3" xref="S3.SS1.p1.24.m24.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo stretchy="false" id="S3.SS1.p1.24.m24.1.1.1.1.1.3" xref="S3.SS1.p1.24.m24.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.24.m24.1b"><apply id="S3.SS1.p1.24.m24.1.1.cmml" xref="S3.SS1.p1.24.m24.1.1"><eq id="S3.SS1.p1.24.m24.1.1.2.cmml" xref="S3.SS1.p1.24.m24.1.1.2"></eq><apply id="S3.SS1.p1.24.m24.1.1.3.cmml" xref="S3.SS1.p1.24.m24.1.1.3"><times id="S3.SS1.p1.24.m24.1.1.3.1.cmml" xref="S3.SS1.p1.24.m24.1.1.3.1"></times><apply id="S3.SS1.p1.24.m24.1.1.3.2.cmml" xref="S3.SS1.p1.24.m24.1.1.3.2"><csymbol cd="latexml" id="S3.SS1.p1.24.m24.1.1.3.2.1.cmml" xref="S3.SS1.p1.24.m24.1.1.3.2.1">direct-product</csymbol><apply id="S3.SS1.p1.24.m24.1.1.3.2.2.cmml" xref="S3.SS1.p1.24.m24.1.1.3.2.2"><times id="S3.SS1.p1.24.m24.1.1.3.2.2.1.cmml" xref="S3.SS1.p1.24.m24.1.1.3.2.2.1"></times><ci id="S3.SS1.p1.24.m24.1.1.3.2.2.2.cmml" xref="S3.SS1.p1.24.m24.1.1.3.2.2.2">Π</ci><ci id="S3.SS1.p1.24.m24.1.1.3.2.2.3.cmml" xref="S3.SS1.p1.24.m24.1.1.3.2.2.3">𝑎</ci></apply><ci id="S3.SS1.p1.24.m24.1.1.3.2.3.cmml" xref="S3.SS1.p1.24.m24.1.1.3.2.3">Π</ci></apply><ci id="S3.SS1.p1.24.m24.1.1.3.3.cmml" xref="S3.SS1.p1.24.m24.1.1.3.3">𝑏</ci></apply><apply id="S3.SS1.p1.24.m24.1.1.1.cmml" xref="S3.SS1.p1.24.m24.1.1.1"><times id="S3.SS1.p1.24.m24.1.1.1.2.cmml" xref="S3.SS1.p1.24.m24.1.1.1.2"></times><ci id="S3.SS1.p1.24.m24.1.1.1.3.cmml" xref="S3.SS1.p1.24.m24.1.1.1.3">Π</ci><apply id="S3.SS1.p1.24.m24.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.24.m24.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.24.m24.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.24.m24.1.1.1.1.1.1.1">direct-product</csymbol><ci id="S3.SS1.p1.24.m24.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.24.m24.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS1.p1.24.m24.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.24.m24.1.1.1.1.1.1.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.24.m24.1c">\Pi a\odot\Pi b=\Pi(a\odot b)</annotation></semantics></math>, where <math id="S3.SS1.p1.25.m25.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS1.p1.25.m25.1a"><mi id="S3.SS1.p1.25.m25.1.1" xref="S3.SS1.p1.25.m25.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.25.m25.1b"><ci id="S3.SS1.p1.25.m25.1.1.cmml" xref="S3.SS1.p1.25.m25.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.25.m25.1c">I</annotation></semantics></math> is the identity matrix and <math id="S3.SS1.p1.26.m26.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS1.p1.26.m26.1a"><mo id="S3.SS1.p1.26.m26.1.1" xref="S3.SS1.p1.26.m26.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.26.m26.1b"><csymbol cd="latexml" id="S3.SS1.p1.26.m26.1.1.cmml" xref="S3.SS1.p1.26.m26.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.26.m26.1c">\odot</annotation></semantics></math> denotes Hadamard product. If <math id="S3.SS1.p1.27.m27.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S3.SS1.p1.27.m27.1a"><mrow id="S3.SS1.p1.27.m27.1.2" xref="S3.SS1.p1.27.m27.1.2.cmml"><mi id="S3.SS1.p1.27.m27.1.2.2" xref="S3.SS1.p1.27.m27.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.27.m27.1.2.1" xref="S3.SS1.p1.27.m27.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.27.m27.1.2.3.2" xref="S3.SS1.p1.27.m27.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.27.m27.1.2.3.2.1" xref="S3.SS1.p1.27.m27.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.27.m27.1.1" xref="S3.SS1.p1.27.m27.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.27.m27.1.2.3.2.2" xref="S3.SS1.p1.27.m27.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.27.m27.1b"><apply id="S3.SS1.p1.27.m27.1.2.cmml" xref="S3.SS1.p1.27.m27.1.2"><times id="S3.SS1.p1.27.m27.1.2.1.cmml" xref="S3.SS1.p1.27.m27.1.2.1"></times><ci id="S3.SS1.p1.27.m27.1.2.2.cmml" xref="S3.SS1.p1.27.m27.1.2.2">𝑓</ci><ci id="S3.SS1.p1.27.m27.1.1.cmml" xref="S3.SS1.p1.27.m27.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.27.m27.1c">f(\cdot)</annotation></semantics></math> is an element-wise function, <math id="S3.SS1.p1.28.m28.2" class="ltx_Math" alttext="f(\Pi x)=\Pi f(x)" display="inline"><semantics id="S3.SS1.p1.28.m28.2a"><mrow id="S3.SS1.p1.28.m28.2.2" xref="S3.SS1.p1.28.m28.2.2.cmml"><mrow id="S3.SS1.p1.28.m28.2.2.1" xref="S3.SS1.p1.28.m28.2.2.1.cmml"><mi id="S3.SS1.p1.28.m28.2.2.1.3" xref="S3.SS1.p1.28.m28.2.2.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.28.m28.2.2.1.2" xref="S3.SS1.p1.28.m28.2.2.1.2.cmml">​</mo><mrow id="S3.SS1.p1.28.m28.2.2.1.1.1" xref="S3.SS1.p1.28.m28.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.28.m28.2.2.1.1.1.2" xref="S3.SS1.p1.28.m28.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.28.m28.2.2.1.1.1.1" xref="S3.SS1.p1.28.m28.2.2.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p1.28.m28.2.2.1.1.1.1.2" xref="S3.SS1.p1.28.m28.2.2.1.1.1.1.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.28.m28.2.2.1.1.1.1.1" xref="S3.SS1.p1.28.m28.2.2.1.1.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.28.m28.2.2.1.1.1.1.3" xref="S3.SS1.p1.28.m28.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.SS1.p1.28.m28.2.2.1.1.1.3" xref="S3.SS1.p1.28.m28.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.28.m28.2.2.2" xref="S3.SS1.p1.28.m28.2.2.2.cmml">=</mo><mrow id="S3.SS1.p1.28.m28.2.2.3" xref="S3.SS1.p1.28.m28.2.2.3.cmml"><mi mathvariant="normal" id="S3.SS1.p1.28.m28.2.2.3.2" xref="S3.SS1.p1.28.m28.2.2.3.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.28.m28.2.2.3.1" xref="S3.SS1.p1.28.m28.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.28.m28.2.2.3.3" xref="S3.SS1.p1.28.m28.2.2.3.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.28.m28.2.2.3.1a" xref="S3.SS1.p1.28.m28.2.2.3.1.cmml">​</mo><mrow id="S3.SS1.p1.28.m28.2.2.3.4.2" xref="S3.SS1.p1.28.m28.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.28.m28.2.2.3.4.2.1" xref="S3.SS1.p1.28.m28.2.2.3.cmml">(</mo><mi id="S3.SS1.p1.28.m28.1.1" xref="S3.SS1.p1.28.m28.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.p1.28.m28.2.2.3.4.2.2" xref="S3.SS1.p1.28.m28.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.28.m28.2b"><apply id="S3.SS1.p1.28.m28.2.2.cmml" xref="S3.SS1.p1.28.m28.2.2"><eq id="S3.SS1.p1.28.m28.2.2.2.cmml" xref="S3.SS1.p1.28.m28.2.2.2"></eq><apply id="S3.SS1.p1.28.m28.2.2.1.cmml" xref="S3.SS1.p1.28.m28.2.2.1"><times id="S3.SS1.p1.28.m28.2.2.1.2.cmml" xref="S3.SS1.p1.28.m28.2.2.1.2"></times><ci id="S3.SS1.p1.28.m28.2.2.1.3.cmml" xref="S3.SS1.p1.28.m28.2.2.1.3">𝑓</ci><apply id="S3.SS1.p1.28.m28.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.28.m28.2.2.1.1.1"><times id="S3.SS1.p1.28.m28.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.28.m28.2.2.1.1.1.1.1"></times><ci id="S3.SS1.p1.28.m28.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p1.28.m28.2.2.1.1.1.1.2">Π</ci><ci id="S3.SS1.p1.28.m28.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p1.28.m28.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.SS1.p1.28.m28.2.2.3.cmml" xref="S3.SS1.p1.28.m28.2.2.3"><times id="S3.SS1.p1.28.m28.2.2.3.1.cmml" xref="S3.SS1.p1.28.m28.2.2.3.1"></times><ci id="S3.SS1.p1.28.m28.2.2.3.2.cmml" xref="S3.SS1.p1.28.m28.2.2.3.2">Π</ci><ci id="S3.SS1.p1.28.m28.2.2.3.3.cmml" xref="S3.SS1.p1.28.m28.2.2.3.3">𝑓</ci><ci id="S3.SS1.p1.28.m28.1.1.cmml" xref="S3.SS1.p1.28.m28.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.28.m28.2c">f(\Pi x)=\Pi f(x)</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">For MLP0, we have <math id="S3.SS1.p2.1.m1.3" class="ltx_Math" alttext="y=(\Pi v)^{T}f(\Pi Wx+\Pi b)=v^{T}f(Wx+b)" display="inline"><semantics id="S3.SS1.p2.1.m1.3a"><mrow id="S3.SS1.p2.1.m1.3.3" xref="S3.SS1.p2.1.m1.3.3.cmml"><mi id="S3.SS1.p2.1.m1.3.3.5" xref="S3.SS1.p2.1.m1.3.3.5.cmml">y</mi><mo id="S3.SS1.p2.1.m1.3.3.6" xref="S3.SS1.p2.1.m1.3.3.6.cmml">=</mo><mrow id="S3.SS1.p2.1.m1.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.cmml"><msup id="S3.SS1.p2.1.m1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.cmml"><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3.cmml">v</mi></mrow><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS1.p2.1.m1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.2.2.2.3" xref="S3.SS1.p2.1.m1.2.2.2.3.cmml">​</mo><mi id="S3.SS1.p2.1.m1.2.2.2.4" xref="S3.SS1.p2.1.m1.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.2.2.2.3a" xref="S3.SS1.p2.1.m1.2.2.2.3.cmml">​</mo><mrow id="S3.SS1.p2.1.m1.2.2.2.2.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.2.2.2.2.1.2" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS1.p2.1.m1.2.2.2.2.1.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.cmml"><mrow id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.3" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.1a" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.4" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.4.cmml">x</mi></mrow><mo id="S3.SS1.p2.1.m1.2.2.2.2.1.1.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.1.cmml">+</mo><mrow id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.cmml"><mi mathvariant="normal" id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.2" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.cmml">b</mi></mrow></mrow><mo stretchy="false" id="S3.SS1.p2.1.m1.2.2.2.2.1.3" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.1.m1.3.3.7" xref="S3.SS1.p2.1.m1.3.3.7.cmml">=</mo><mrow id="S3.SS1.p2.1.m1.3.3.3" xref="S3.SS1.p2.1.m1.3.3.3.cmml"><msup id="S3.SS1.p2.1.m1.3.3.3.3" xref="S3.SS1.p2.1.m1.3.3.3.3.cmml"><mi id="S3.SS1.p2.1.m1.3.3.3.3.2" xref="S3.SS1.p2.1.m1.3.3.3.3.2.cmml">v</mi><mi id="S3.SS1.p2.1.m1.3.3.3.3.3" xref="S3.SS1.p2.1.m1.3.3.3.3.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.3.3.3.2" xref="S3.SS1.p2.1.m1.3.3.3.2.cmml">​</mo><mi id="S3.SS1.p2.1.m1.3.3.3.4" xref="S3.SS1.p2.1.m1.3.3.3.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.3.3.3.2a" xref="S3.SS1.p2.1.m1.3.3.3.2.cmml">​</mo><mrow id="S3.SS1.p2.1.m1.3.3.3.1.1" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.3.3.3.1.1.2" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.1.m1.3.3.3.1.1.1" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.cmml"><mrow id="S3.SS1.p2.1.m1.3.3.3.1.1.1.2" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.2" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.1" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.3" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.3.cmml">x</mi></mrow><mo id="S3.SS1.p2.1.m1.3.3.3.1.1.1.1" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.1.cmml">+</mo><mi id="S3.SS1.p2.1.m1.3.3.3.1.1.1.3" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.3.cmml">b</mi></mrow><mo stretchy="false" id="S3.SS1.p2.1.m1.3.3.3.1.1.3" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.3b"><apply id="S3.SS1.p2.1.m1.3.3.cmml" xref="S3.SS1.p2.1.m1.3.3"><and id="S3.SS1.p2.1.m1.3.3a.cmml" xref="S3.SS1.p2.1.m1.3.3"></and><apply id="S3.SS1.p2.1.m1.3.3b.cmml" xref="S3.SS1.p2.1.m1.3.3"><eq id="S3.SS1.p2.1.m1.3.3.6.cmml" xref="S3.SS1.p2.1.m1.3.3.6"></eq><ci id="S3.SS1.p2.1.m1.3.3.5.cmml" xref="S3.SS1.p2.1.m1.3.3.5">𝑦</ci><apply id="S3.SS1.p2.1.m1.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2"><times id="S3.SS1.p2.1.m1.2.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.3"></times><apply id="S3.SS1.p2.1.m1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1"><times id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1"></times><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2">Π</ci><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3">𝑣</ci></apply><ci id="S3.SS1.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.3">𝑇</ci></apply><ci id="S3.SS1.p2.1.m1.2.2.2.4.cmml" xref="S3.SS1.p2.1.m1.2.2.2.4">𝑓</ci><apply id="S3.SS1.p2.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1"><plus id="S3.SS1.p2.1.m1.2.2.2.2.1.1.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.1"></plus><apply id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2"><times id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.1"></times><ci id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.2">Π</ci><ci id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.3">𝑊</ci><ci id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.4.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.4">𝑥</ci></apply><apply id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3"><times id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.1"></times><ci id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.2">Π</ci><ci id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3">𝑏</ci></apply></apply></apply></apply><apply id="S3.SS1.p2.1.m1.3.3c.cmml" xref="S3.SS1.p2.1.m1.3.3"><eq id="S3.SS1.p2.1.m1.3.3.7.cmml" xref="S3.SS1.p2.1.m1.3.3.7"></eq><share href="#S3.SS1.p2.1.m1.2.2.2.cmml" id="S3.SS1.p2.1.m1.3.3d.cmml" xref="S3.SS1.p2.1.m1.3.3"></share><apply id="S3.SS1.p2.1.m1.3.3.3.cmml" xref="S3.SS1.p2.1.m1.3.3.3"><times id="S3.SS1.p2.1.m1.3.3.3.2.cmml" xref="S3.SS1.p2.1.m1.3.3.3.2"></times><apply id="S3.SS1.p2.1.m1.3.3.3.3.cmml" xref="S3.SS1.p2.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.3.3.3.3.1.cmml" xref="S3.SS1.p2.1.m1.3.3.3.3">superscript</csymbol><ci id="S3.SS1.p2.1.m1.3.3.3.3.2.cmml" xref="S3.SS1.p2.1.m1.3.3.3.3.2">𝑣</ci><ci id="S3.SS1.p2.1.m1.3.3.3.3.3.cmml" xref="S3.SS1.p2.1.m1.3.3.3.3.3">𝑇</ci></apply><ci id="S3.SS1.p2.1.m1.3.3.3.4.cmml" xref="S3.SS1.p2.1.m1.3.3.3.4">𝑓</ci><apply id="S3.SS1.p2.1.m1.3.3.3.1.1.1.cmml" xref="S3.SS1.p2.1.m1.3.3.3.1.1"><plus id="S3.SS1.p2.1.m1.3.3.3.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.1"></plus><apply id="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.2"><times id="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.1"></times><ci id="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.2">𝑊</ci><ci id="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.2.3">𝑥</ci></apply><ci id="S3.SS1.p2.1.m1.3.3.3.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.3.3.3.1.1.1.3">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.3c">y=(\Pi v)^{T}f(\Pi Wx+\Pi b)=v^{T}f(Wx+b)</annotation></semantics></math>, implying that if we permute the parameters properly, the output of a certain neural network does not change, i.e., the <span id="S3.SS1.p2.1.1" class="ltx_text ltx_font_bold">permutation invariance property</span>. Extending it to MLP, the layer-wise permutation process is</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="h_{l}=f_{l}(\Pi_{l}W_{l}\Pi_{l-1}^{T}h_{l-1}+\Pi_{l}b_{l})," display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml">h</mi><mi id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml">l</mi></msub><mo id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E1.m1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi mathvariant="normal" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">Π</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1a" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.cmml"><mi mathvariant="normal" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.2.cmml">Π</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.2.cmml">l</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.1.cmml">−</mo><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1b" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.2.cmml">h</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.2.cmml">l</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.1.cmml">−</mo><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi mathvariant="normal" id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">Π</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">b</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">l</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></eq><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2">ℎ</ci><ci id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E1.m1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><plus id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2">Π</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.3">𝑙</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2">𝑊</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.3">𝑙</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.2">Π</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.1"></minus><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.2">𝑙</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.4.3">𝑇</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.2">ℎ</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.1"></minus><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.2">𝑙</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.5.3.3">1</cn></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.2">Π</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.2">𝑏</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">h_{l}=f_{l}(\Pi_{l}W_{l}\Pi_{l-1}^{T}h_{l-1}+\Pi_{l}b_{l}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.11" class="ltx_p">where <math id="S3.SS1.p2.2.m1.1" class="ltx_Math" alttext="\Pi_{0}=I" display="inline"><semantics id="S3.SS1.p2.2.m1.1a"><mrow id="S3.SS1.p2.2.m1.1.1" xref="S3.SS1.p2.2.m1.1.1.cmml"><msub id="S3.SS1.p2.2.m1.1.1.2" xref="S3.SS1.p2.2.m1.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS1.p2.2.m1.1.1.2.2" xref="S3.SS1.p2.2.m1.1.1.2.2.cmml">Π</mi><mn id="S3.SS1.p2.2.m1.1.1.2.3" xref="S3.SS1.p2.2.m1.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS1.p2.2.m1.1.1.1" xref="S3.SS1.p2.2.m1.1.1.1.cmml">=</mo><mi id="S3.SS1.p2.2.m1.1.1.3" xref="S3.SS1.p2.2.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m1.1b"><apply id="S3.SS1.p2.2.m1.1.1.cmml" xref="S3.SS1.p2.2.m1.1.1"><eq id="S3.SS1.p2.2.m1.1.1.1.cmml" xref="S3.SS1.p2.2.m1.1.1.1"></eq><apply id="S3.SS1.p2.2.m1.1.1.2.cmml" xref="S3.SS1.p2.2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m1.1.1.2.1.cmml" xref="S3.SS1.p2.2.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.2.m1.1.1.2.2.cmml" xref="S3.SS1.p2.2.m1.1.1.2.2">Π</ci><cn type="integer" id="S3.SS1.p2.2.m1.1.1.2.3.cmml" xref="S3.SS1.p2.2.m1.1.1.2.3">0</cn></apply><ci id="S3.SS1.p2.2.m1.1.1.3.cmml" xref="S3.SS1.p2.2.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m1.1c">\Pi_{0}=I</annotation></semantics></math> and <math id="S3.SS1.p2.3.m2.1" class="ltx_Math" alttext="\Pi_{L}=I" display="inline"><semantics id="S3.SS1.p2.3.m2.1a"><mrow id="S3.SS1.p2.3.m2.1.1" xref="S3.SS1.p2.3.m2.1.1.cmml"><msub id="S3.SS1.p2.3.m2.1.1.2" xref="S3.SS1.p2.3.m2.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS1.p2.3.m2.1.1.2.2" xref="S3.SS1.p2.3.m2.1.1.2.2.cmml">Π</mi><mi id="S3.SS1.p2.3.m2.1.1.2.3" xref="S3.SS1.p2.3.m2.1.1.2.3.cmml">L</mi></msub><mo id="S3.SS1.p2.3.m2.1.1.1" xref="S3.SS1.p2.3.m2.1.1.1.cmml">=</mo><mi id="S3.SS1.p2.3.m2.1.1.3" xref="S3.SS1.p2.3.m2.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m2.1b"><apply id="S3.SS1.p2.3.m2.1.1.cmml" xref="S3.SS1.p2.3.m2.1.1"><eq id="S3.SS1.p2.3.m2.1.1.1.cmml" xref="S3.SS1.p2.3.m2.1.1.1"></eq><apply id="S3.SS1.p2.3.m2.1.1.2.cmml" xref="S3.SS1.p2.3.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m2.1.1.2.1.cmml" xref="S3.SS1.p2.3.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.3.m2.1.1.2.2.cmml" xref="S3.SS1.p2.3.m2.1.1.2.2">Π</ci><ci id="S3.SS1.p2.3.m2.1.1.2.3.cmml" xref="S3.SS1.p2.3.m2.1.1.2.3">𝐿</ci></apply><ci id="S3.SS1.p2.3.m2.1.1.3.cmml" xref="S3.SS1.p2.3.m2.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m2.1c">\Pi_{L}=I</annotation></semantics></math>, meaning that the input and output layers are not shuffled.
For ConvNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, we take convolution kernels as basic units. The convolution parameters could be denoted as <math id="S3.SS1.p2.4.m3.1" class="ltx_Math" alttext="W_{l}\in\mathcal{R}^{C_{l}\times w_{l}\times h_{l}\times C_{l-1}}" display="inline"><semantics id="S3.SS1.p2.4.m3.1a"><mrow id="S3.SS1.p2.4.m3.1.1" xref="S3.SS1.p2.4.m3.1.1.cmml"><msub id="S3.SS1.p2.4.m3.1.1.2" xref="S3.SS1.p2.4.m3.1.1.2.cmml"><mi id="S3.SS1.p2.4.m3.1.1.2.2" xref="S3.SS1.p2.4.m3.1.1.2.2.cmml">W</mi><mi id="S3.SS1.p2.4.m3.1.1.2.3" xref="S3.SS1.p2.4.m3.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS1.p2.4.m3.1.1.1" xref="S3.SS1.p2.4.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.4.m3.1.1.3" xref="S3.SS1.p2.4.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m3.1.1.3.2" xref="S3.SS1.p2.4.m3.1.1.3.2.cmml">ℛ</mi><mrow id="S3.SS1.p2.4.m3.1.1.3.3" xref="S3.SS1.p2.4.m3.1.1.3.3.cmml"><msub id="S3.SS1.p2.4.m3.1.1.3.3.2" xref="S3.SS1.p2.4.m3.1.1.3.3.2.cmml"><mi id="S3.SS1.p2.4.m3.1.1.3.3.2.2" xref="S3.SS1.p2.4.m3.1.1.3.3.2.2.cmml">C</mi><mi id="S3.SS1.p2.4.m3.1.1.3.3.2.3" xref="S3.SS1.p2.4.m3.1.1.3.3.2.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.4.m3.1.1.3.3.1" xref="S3.SS1.p2.4.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p2.4.m3.1.1.3.3.3" xref="S3.SS1.p2.4.m3.1.1.3.3.3.cmml"><mi id="S3.SS1.p2.4.m3.1.1.3.3.3.2" xref="S3.SS1.p2.4.m3.1.1.3.3.3.2.cmml">w</mi><mi id="S3.SS1.p2.4.m3.1.1.3.3.3.3" xref="S3.SS1.p2.4.m3.1.1.3.3.3.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.4.m3.1.1.3.3.1a" xref="S3.SS1.p2.4.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p2.4.m3.1.1.3.3.4" xref="S3.SS1.p2.4.m3.1.1.3.3.4.cmml"><mi id="S3.SS1.p2.4.m3.1.1.3.3.4.2" xref="S3.SS1.p2.4.m3.1.1.3.3.4.2.cmml">h</mi><mi id="S3.SS1.p2.4.m3.1.1.3.3.4.3" xref="S3.SS1.p2.4.m3.1.1.3.3.4.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.4.m3.1.1.3.3.1b" xref="S3.SS1.p2.4.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p2.4.m3.1.1.3.3.5" xref="S3.SS1.p2.4.m3.1.1.3.3.5.cmml"><mi id="S3.SS1.p2.4.m3.1.1.3.3.5.2" xref="S3.SS1.p2.4.m3.1.1.3.3.5.2.cmml">C</mi><mrow id="S3.SS1.p2.4.m3.1.1.3.3.5.3" xref="S3.SS1.p2.4.m3.1.1.3.3.5.3.cmml"><mi id="S3.SS1.p2.4.m3.1.1.3.3.5.3.2" xref="S3.SS1.p2.4.m3.1.1.3.3.5.3.2.cmml">l</mi><mo id="S3.SS1.p2.4.m3.1.1.3.3.5.3.1" xref="S3.SS1.p2.4.m3.1.1.3.3.5.3.1.cmml">−</mo><mn id="S3.SS1.p2.4.m3.1.1.3.3.5.3.3" xref="S3.SS1.p2.4.m3.1.1.3.3.5.3.3.cmml">1</mn></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m3.1b"><apply id="S3.SS1.p2.4.m3.1.1.cmml" xref="S3.SS1.p2.4.m3.1.1"><in id="S3.SS1.p2.4.m3.1.1.1.cmml" xref="S3.SS1.p2.4.m3.1.1.1"></in><apply id="S3.SS1.p2.4.m3.1.1.2.cmml" xref="S3.SS1.p2.4.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m3.1.1.2.1.cmml" xref="S3.SS1.p2.4.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.4.m3.1.1.2.2.cmml" xref="S3.SS1.p2.4.m3.1.1.2.2">𝑊</ci><ci id="S3.SS1.p2.4.m3.1.1.2.3.cmml" xref="S3.SS1.p2.4.m3.1.1.2.3">𝑙</ci></apply><apply id="S3.SS1.p2.4.m3.1.1.3.cmml" xref="S3.SS1.p2.4.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m3.1.1.3.1.cmml" xref="S3.SS1.p2.4.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.4.m3.1.1.3.2.cmml" xref="S3.SS1.p2.4.m3.1.1.3.2">ℛ</ci><apply id="S3.SS1.p2.4.m3.1.1.3.3.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3"><times id="S3.SS1.p2.4.m3.1.1.3.3.1.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.1"></times><apply id="S3.SS1.p2.4.m3.1.1.3.3.2.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m3.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p2.4.m3.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.2.2">𝐶</ci><ci id="S3.SS1.p2.4.m3.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.2.3">𝑙</ci></apply><apply id="S3.SS1.p2.4.m3.1.1.3.3.3.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m3.1.1.3.3.3.1.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.4.m3.1.1.3.3.3.2.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.3.2">𝑤</ci><ci id="S3.SS1.p2.4.m3.1.1.3.3.3.3.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.3.3">𝑙</ci></apply><apply id="S3.SS1.p2.4.m3.1.1.3.3.4.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m3.1.1.3.3.4.1.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.4">subscript</csymbol><ci id="S3.SS1.p2.4.m3.1.1.3.3.4.2.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.4.2">ℎ</ci><ci id="S3.SS1.p2.4.m3.1.1.3.3.4.3.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.4.3">𝑙</ci></apply><apply id="S3.SS1.p2.4.m3.1.1.3.3.5.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.5"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m3.1.1.3.3.5.1.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.5">subscript</csymbol><ci id="S3.SS1.p2.4.m3.1.1.3.3.5.2.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.5.2">𝐶</ci><apply id="S3.SS1.p2.4.m3.1.1.3.3.5.3.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.5.3"><minus id="S3.SS1.p2.4.m3.1.1.3.3.5.3.1.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.5.3.1"></minus><ci id="S3.SS1.p2.4.m3.1.1.3.3.5.3.2.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.5.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.4.m3.1.1.3.3.5.3.3.cmml" xref="S3.SS1.p2.4.m3.1.1.3.3.5.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m3.1c">W_{l}\in\mathcal{R}^{C_{l}\times w_{l}\times h_{l}\times C_{l-1}}</annotation></semantics></math>, where the four dimensions denote the number of output/input channels (<math id="S3.SS1.p2.5.m4.1" class="ltx_Math" alttext="C_{l}" display="inline"><semantics id="S3.SS1.p2.5.m4.1a"><msub id="S3.SS1.p2.5.m4.1.1" xref="S3.SS1.p2.5.m4.1.1.cmml"><mi id="S3.SS1.p2.5.m4.1.1.2" xref="S3.SS1.p2.5.m4.1.1.2.cmml">C</mi><mi id="S3.SS1.p2.5.m4.1.1.3" xref="S3.SS1.p2.5.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m4.1b"><apply id="S3.SS1.p2.5.m4.1.1.cmml" xref="S3.SS1.p2.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m4.1.1.1.cmml" xref="S3.SS1.p2.5.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m4.1.1.2.cmml" xref="S3.SS1.p2.5.m4.1.1.2">𝐶</ci><ci id="S3.SS1.p2.5.m4.1.1.3.cmml" xref="S3.SS1.p2.5.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m4.1c">C_{l}</annotation></semantics></math>, <math id="S3.SS1.p2.6.m5.1" class="ltx_Math" alttext="C_{l-1}" display="inline"><semantics id="S3.SS1.p2.6.m5.1a"><msub id="S3.SS1.p2.6.m5.1.1" xref="S3.SS1.p2.6.m5.1.1.cmml"><mi id="S3.SS1.p2.6.m5.1.1.2" xref="S3.SS1.p2.6.m5.1.1.2.cmml">C</mi><mrow id="S3.SS1.p2.6.m5.1.1.3" xref="S3.SS1.p2.6.m5.1.1.3.cmml"><mi id="S3.SS1.p2.6.m5.1.1.3.2" xref="S3.SS1.p2.6.m5.1.1.3.2.cmml">l</mi><mo id="S3.SS1.p2.6.m5.1.1.3.1" xref="S3.SS1.p2.6.m5.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p2.6.m5.1.1.3.3" xref="S3.SS1.p2.6.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m5.1b"><apply id="S3.SS1.p2.6.m5.1.1.cmml" xref="S3.SS1.p2.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m5.1.1.1.cmml" xref="S3.SS1.p2.6.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m5.1.1.2.cmml" xref="S3.SS1.p2.6.m5.1.1.2">𝐶</ci><apply id="S3.SS1.p2.6.m5.1.1.3.cmml" xref="S3.SS1.p2.6.m5.1.1.3"><minus id="S3.SS1.p2.6.m5.1.1.3.1.cmml" xref="S3.SS1.p2.6.m5.1.1.3.1"></minus><ci id="S3.SS1.p2.6.m5.1.1.3.2.cmml" xref="S3.SS1.p2.6.m5.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.6.m5.1.1.3.3.cmml" xref="S3.SS1.p2.6.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m5.1c">C_{l-1}</annotation></semantics></math>) and the kernel size (<math id="S3.SS1.p2.7.m6.1" class="ltx_Math" alttext="w_{l}" display="inline"><semantics id="S3.SS1.p2.7.m6.1a"><msub id="S3.SS1.p2.7.m6.1.1" xref="S3.SS1.p2.7.m6.1.1.cmml"><mi id="S3.SS1.p2.7.m6.1.1.2" xref="S3.SS1.p2.7.m6.1.1.2.cmml">w</mi><mi id="S3.SS1.p2.7.m6.1.1.3" xref="S3.SS1.p2.7.m6.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m6.1b"><apply id="S3.SS1.p2.7.m6.1.1.cmml" xref="S3.SS1.p2.7.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m6.1.1.1.cmml" xref="S3.SS1.p2.7.m6.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m6.1.1.2.cmml" xref="S3.SS1.p2.7.m6.1.1.2">𝑤</ci><ci id="S3.SS1.p2.7.m6.1.1.3.cmml" xref="S3.SS1.p2.7.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m6.1c">w_{l}</annotation></semantics></math>, <math id="S3.SS1.p2.8.m7.1" class="ltx_Math" alttext="h_{l}" display="inline"><semantics id="S3.SS1.p2.8.m7.1a"><msub id="S3.SS1.p2.8.m7.1.1" xref="S3.SS1.p2.8.m7.1.1.cmml"><mi id="S3.SS1.p2.8.m7.1.1.2" xref="S3.SS1.p2.8.m7.1.1.2.cmml">h</mi><mi id="S3.SS1.p2.8.m7.1.1.3" xref="S3.SS1.p2.8.m7.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m7.1b"><apply id="S3.SS1.p2.8.m7.1.1.cmml" xref="S3.SS1.p2.8.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m7.1.1.1.cmml" xref="S3.SS1.p2.8.m7.1.1">subscript</csymbol><ci id="S3.SS1.p2.8.m7.1.1.2.cmml" xref="S3.SS1.p2.8.m7.1.1.2">ℎ</ci><ci id="S3.SS1.p2.8.m7.1.1.3.cmml" xref="S3.SS1.p2.8.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m7.1c">h_{l}</annotation></semantics></math>). The permutation could be similarly applied as <math id="S3.SS1.p2.9.m8.1" class="ltx_Math" alttext="\Pi_{l}W_{l}\Pi_{l-1}^{T}" display="inline"><semantics id="S3.SS1.p2.9.m8.1a"><mrow id="S3.SS1.p2.9.m8.1.1" xref="S3.SS1.p2.9.m8.1.1.cmml"><msub id="S3.SS1.p2.9.m8.1.1.2" xref="S3.SS1.p2.9.m8.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS1.p2.9.m8.1.1.2.2" xref="S3.SS1.p2.9.m8.1.1.2.2.cmml">Π</mi><mi id="S3.SS1.p2.9.m8.1.1.2.3" xref="S3.SS1.p2.9.m8.1.1.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.9.m8.1.1.1" xref="S3.SS1.p2.9.m8.1.1.1.cmml">​</mo><msub id="S3.SS1.p2.9.m8.1.1.3" xref="S3.SS1.p2.9.m8.1.1.3.cmml"><mi id="S3.SS1.p2.9.m8.1.1.3.2" xref="S3.SS1.p2.9.m8.1.1.3.2.cmml">W</mi><mi id="S3.SS1.p2.9.m8.1.1.3.3" xref="S3.SS1.p2.9.m8.1.1.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.9.m8.1.1.1a" xref="S3.SS1.p2.9.m8.1.1.1.cmml">​</mo><msubsup id="S3.SS1.p2.9.m8.1.1.4" xref="S3.SS1.p2.9.m8.1.1.4.cmml"><mi mathvariant="normal" id="S3.SS1.p2.9.m8.1.1.4.2.2" xref="S3.SS1.p2.9.m8.1.1.4.2.2.cmml">Π</mi><mrow id="S3.SS1.p2.9.m8.1.1.4.2.3" xref="S3.SS1.p2.9.m8.1.1.4.2.3.cmml"><mi id="S3.SS1.p2.9.m8.1.1.4.2.3.2" xref="S3.SS1.p2.9.m8.1.1.4.2.3.2.cmml">l</mi><mo id="S3.SS1.p2.9.m8.1.1.4.2.3.1" xref="S3.SS1.p2.9.m8.1.1.4.2.3.1.cmml">−</mo><mn id="S3.SS1.p2.9.m8.1.1.4.2.3.3" xref="S3.SS1.p2.9.m8.1.1.4.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.9.m8.1.1.4.3" xref="S3.SS1.p2.9.m8.1.1.4.3.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m8.1b"><apply id="S3.SS1.p2.9.m8.1.1.cmml" xref="S3.SS1.p2.9.m8.1.1"><times id="S3.SS1.p2.9.m8.1.1.1.cmml" xref="S3.SS1.p2.9.m8.1.1.1"></times><apply id="S3.SS1.p2.9.m8.1.1.2.cmml" xref="S3.SS1.p2.9.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m8.1.1.2.1.cmml" xref="S3.SS1.p2.9.m8.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.9.m8.1.1.2.2.cmml" xref="S3.SS1.p2.9.m8.1.1.2.2">Π</ci><ci id="S3.SS1.p2.9.m8.1.1.2.3.cmml" xref="S3.SS1.p2.9.m8.1.1.2.3">𝑙</ci></apply><apply id="S3.SS1.p2.9.m8.1.1.3.cmml" xref="S3.SS1.p2.9.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m8.1.1.3.1.cmml" xref="S3.SS1.p2.9.m8.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.9.m8.1.1.3.2.cmml" xref="S3.SS1.p2.9.m8.1.1.3.2">𝑊</ci><ci id="S3.SS1.p2.9.m8.1.1.3.3.cmml" xref="S3.SS1.p2.9.m8.1.1.3.3">𝑙</ci></apply><apply id="S3.SS1.p2.9.m8.1.1.4.cmml" xref="S3.SS1.p2.9.m8.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m8.1.1.4.1.cmml" xref="S3.SS1.p2.9.m8.1.1.4">superscript</csymbol><apply id="S3.SS1.p2.9.m8.1.1.4.2.cmml" xref="S3.SS1.p2.9.m8.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m8.1.1.4.2.1.cmml" xref="S3.SS1.p2.9.m8.1.1.4">subscript</csymbol><ci id="S3.SS1.p2.9.m8.1.1.4.2.2.cmml" xref="S3.SS1.p2.9.m8.1.1.4.2.2">Π</ci><apply id="S3.SS1.p2.9.m8.1.1.4.2.3.cmml" xref="S3.SS1.p2.9.m8.1.1.4.2.3"><minus id="S3.SS1.p2.9.m8.1.1.4.2.3.1.cmml" xref="S3.SS1.p2.9.m8.1.1.4.2.3.1"></minus><ci id="S3.SS1.p2.9.m8.1.1.4.2.3.2.cmml" xref="S3.SS1.p2.9.m8.1.1.4.2.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.9.m8.1.1.4.2.3.3.cmml" xref="S3.SS1.p2.9.m8.1.1.4.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.9.m8.1.1.4.3.cmml" xref="S3.SS1.p2.9.m8.1.1.4.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m8.1c">\Pi_{l}W_{l}\Pi_{l-1}^{T}</annotation></semantics></math>. For ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, we use <math id="S3.SS1.p2.10.m9.1" class="ltx_Math" alttext="h_{l}=f_{l}(\Pi_{l}W_{l}\Pi_{l-1}^{T}h_{l})+\Pi_{l}M_{l}\Pi_{l-1}^{T}h_{l}" display="inline"><semantics id="S3.SS1.p2.10.m9.1a"><mrow id="S3.SS1.p2.10.m9.1.1" xref="S3.SS1.p2.10.m9.1.1.cmml"><msub id="S3.SS1.p2.10.m9.1.1.3" xref="S3.SS1.p2.10.m9.1.1.3.cmml"><mi id="S3.SS1.p2.10.m9.1.1.3.2" xref="S3.SS1.p2.10.m9.1.1.3.2.cmml">h</mi><mi id="S3.SS1.p2.10.m9.1.1.3.3" xref="S3.SS1.p2.10.m9.1.1.3.3.cmml">l</mi></msub><mo id="S3.SS1.p2.10.m9.1.1.2" xref="S3.SS1.p2.10.m9.1.1.2.cmml">=</mo><mrow id="S3.SS1.p2.10.m9.1.1.1" xref="S3.SS1.p2.10.m9.1.1.1.cmml"><mrow id="S3.SS1.p2.10.m9.1.1.1.1" xref="S3.SS1.p2.10.m9.1.1.1.1.cmml"><msub id="S3.SS1.p2.10.m9.1.1.1.1.3" xref="S3.SS1.p2.10.m9.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.10.m9.1.1.1.1.3.2" xref="S3.SS1.p2.10.m9.1.1.1.1.3.2.cmml">f</mi><mi id="S3.SS1.p2.10.m9.1.1.1.1.3.3" xref="S3.SS1.p2.10.m9.1.1.1.1.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.10.m9.1.1.1.1.2" xref="S3.SS1.p2.10.m9.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p2.10.m9.1.1.1.1.1.1" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.2" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2.2.cmml">Π</mi><mi id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3.2" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.1a" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.cmml"><mi mathvariant="normal" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.2" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.2.cmml">Π</mi><mrow id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.cmml"><mi id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.2" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.2.cmml">l</mi><mo id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.1" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.1.cmml">−</mo><mn id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.3" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.3" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.1b" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5.cmml"><mi id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5.2" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5.2.cmml">h</mi><mi id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5.3" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5.3.cmml">l</mi></msub></mrow><mo stretchy="false" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.3" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.10.m9.1.1.1.2" xref="S3.SS1.p2.10.m9.1.1.1.2.cmml">+</mo><mrow id="S3.SS1.p2.10.m9.1.1.1.3" xref="S3.SS1.p2.10.m9.1.1.1.3.cmml"><msub id="S3.SS1.p2.10.m9.1.1.1.3.2" xref="S3.SS1.p2.10.m9.1.1.1.3.2.cmml"><mi mathvariant="normal" id="S3.SS1.p2.10.m9.1.1.1.3.2.2" xref="S3.SS1.p2.10.m9.1.1.1.3.2.2.cmml">Π</mi><mi id="S3.SS1.p2.10.m9.1.1.1.3.2.3" xref="S3.SS1.p2.10.m9.1.1.1.3.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.10.m9.1.1.1.3.1" xref="S3.SS1.p2.10.m9.1.1.1.3.1.cmml">​</mo><msub id="S3.SS1.p2.10.m9.1.1.1.3.3" xref="S3.SS1.p2.10.m9.1.1.1.3.3.cmml"><mi id="S3.SS1.p2.10.m9.1.1.1.3.3.2" xref="S3.SS1.p2.10.m9.1.1.1.3.3.2.cmml">M</mi><mi id="S3.SS1.p2.10.m9.1.1.1.3.3.3" xref="S3.SS1.p2.10.m9.1.1.1.3.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.10.m9.1.1.1.3.1a" xref="S3.SS1.p2.10.m9.1.1.1.3.1.cmml">​</mo><msubsup id="S3.SS1.p2.10.m9.1.1.1.3.4" xref="S3.SS1.p2.10.m9.1.1.1.3.4.cmml"><mi mathvariant="normal" id="S3.SS1.p2.10.m9.1.1.1.3.4.2.2" xref="S3.SS1.p2.10.m9.1.1.1.3.4.2.2.cmml">Π</mi><mrow id="S3.SS1.p2.10.m9.1.1.1.3.4.2.3" xref="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.cmml"><mi id="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.2" xref="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.2.cmml">l</mi><mo id="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.1" xref="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.1.cmml">−</mo><mn id="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.3" xref="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.10.m9.1.1.1.3.4.3" xref="S3.SS1.p2.10.m9.1.1.1.3.4.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS1.p2.10.m9.1.1.1.3.1b" xref="S3.SS1.p2.10.m9.1.1.1.3.1.cmml">​</mo><msub id="S3.SS1.p2.10.m9.1.1.1.3.5" xref="S3.SS1.p2.10.m9.1.1.1.3.5.cmml"><mi id="S3.SS1.p2.10.m9.1.1.1.3.5.2" xref="S3.SS1.p2.10.m9.1.1.1.3.5.2.cmml">h</mi><mi id="S3.SS1.p2.10.m9.1.1.1.3.5.3" xref="S3.SS1.p2.10.m9.1.1.1.3.5.3.cmml">l</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m9.1b"><apply id="S3.SS1.p2.10.m9.1.1.cmml" xref="S3.SS1.p2.10.m9.1.1"><eq id="S3.SS1.p2.10.m9.1.1.2.cmml" xref="S3.SS1.p2.10.m9.1.1.2"></eq><apply id="S3.SS1.p2.10.m9.1.1.3.cmml" xref="S3.SS1.p2.10.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m9.1.1.3.1.cmml" xref="S3.SS1.p2.10.m9.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.10.m9.1.1.3.2.cmml" xref="S3.SS1.p2.10.m9.1.1.3.2">ℎ</ci><ci id="S3.SS1.p2.10.m9.1.1.3.3.cmml" xref="S3.SS1.p2.10.m9.1.1.3.3">𝑙</ci></apply><apply id="S3.SS1.p2.10.m9.1.1.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1"><plus id="S3.SS1.p2.10.m9.1.1.1.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.2"></plus><apply id="S3.SS1.p2.10.m9.1.1.1.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1"><times id="S3.SS1.p2.10.m9.1.1.1.1.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.2"></times><apply id="S3.SS1.p2.10.m9.1.1.1.1.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m9.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.10.m9.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.3.2">𝑓</ci><ci id="S3.SS1.p2.10.m9.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1"><times id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.1"></times><apply id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2.2">Π</ci><ci id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3.2">𝑊</ci><ci id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4">superscript</csymbol><apply id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.2">Π</ci><apply id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3"><minus id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.1"></minus><ci id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.4.3">𝑇</ci></apply><apply id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5.2">ℎ</ci><ci id="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.1.1.1.1.5.3">𝑙</ci></apply></apply></apply><apply id="S3.SS1.p2.10.m9.1.1.1.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3"><times id="S3.SS1.p2.10.m9.1.1.1.3.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.1"></times><apply id="S3.SS1.p2.10.m9.1.1.1.3.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m9.1.1.1.3.2.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p2.10.m9.1.1.1.3.2.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.2.2">Π</ci><ci id="S3.SS1.p2.10.m9.1.1.1.3.2.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.2.3">𝑙</ci></apply><apply id="S3.SS1.p2.10.m9.1.1.1.3.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m9.1.1.1.3.3.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p2.10.m9.1.1.1.3.3.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.3.2">𝑀</ci><ci id="S3.SS1.p2.10.m9.1.1.1.3.3.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.3.3">𝑙</ci></apply><apply id="S3.SS1.p2.10.m9.1.1.1.3.4.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m9.1.1.1.3.4.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.4">superscript</csymbol><apply id="S3.SS1.p2.10.m9.1.1.1.3.4.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m9.1.1.1.3.4.2.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.4">subscript</csymbol><ci id="S3.SS1.p2.10.m9.1.1.1.3.4.2.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.4.2.2">Π</ci><apply id="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.4.2.3"><minus id="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.1"></minus><ci id="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.4.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.10.m9.1.1.1.3.4.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.4.3">𝑇</ci></apply><apply id="S3.SS1.p2.10.m9.1.1.1.3.5.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m9.1.1.1.3.5.1.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.5">subscript</csymbol><ci id="S3.SS1.p2.10.m9.1.1.1.3.5.2.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.5.2">ℎ</ci><ci id="S3.SS1.p2.10.m9.1.1.1.3.5.3.cmml" xref="S3.SS1.p2.10.m9.1.1.1.3.5.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m9.1c">h_{l}=f_{l}(\Pi_{l}W_{l}\Pi_{l-1}^{T}h_{l})+\Pi_{l}M_{l}\Pi_{l-1}^{T}h_{l}</annotation></semantics></math> to permute all parameters in a basic block including the shortcut (if shortcut is not used, <math id="S3.SS1.p2.11.m10.1" class="ltx_Math" alttext="M_{l}=I" display="inline"><semantics id="S3.SS1.p2.11.m10.1a"><mrow id="S3.SS1.p2.11.m10.1.1" xref="S3.SS1.p2.11.m10.1.1.cmml"><msub id="S3.SS1.p2.11.m10.1.1.2" xref="S3.SS1.p2.11.m10.1.1.2.cmml"><mi id="S3.SS1.p2.11.m10.1.1.2.2" xref="S3.SS1.p2.11.m10.1.1.2.2.cmml">M</mi><mi id="S3.SS1.p2.11.m10.1.1.2.3" xref="S3.SS1.p2.11.m10.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS1.p2.11.m10.1.1.1" xref="S3.SS1.p2.11.m10.1.1.1.cmml">=</mo><mi id="S3.SS1.p2.11.m10.1.1.3" xref="S3.SS1.p2.11.m10.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m10.1b"><apply id="S3.SS1.p2.11.m10.1.1.cmml" xref="S3.SS1.p2.11.m10.1.1"><eq id="S3.SS1.p2.11.m10.1.1.1.cmml" xref="S3.SS1.p2.11.m10.1.1.1"></eq><apply id="S3.SS1.p2.11.m10.1.1.2.cmml" xref="S3.SS1.p2.11.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m10.1.1.2.1.cmml" xref="S3.SS1.p2.11.m10.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.11.m10.1.1.2.2.cmml" xref="S3.SS1.p2.11.m10.1.1.2.2">𝑀</ci><ci id="S3.SS1.p2.11.m10.1.1.2.3.cmml" xref="S3.SS1.p2.11.m10.1.1.2.3">𝑙</ci></apply><ci id="S3.SS1.p2.11.m10.1.1.3.cmml" xref="S3.SS1.p2.11.m10.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m10.1c">M_{l}=I</annotation></semantics></math>).</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Position-Aware Neurons</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.27" class="ltx_p">The essential reason for the permutation invariance of neural networks is that neurons have nothing to do with their positions. Hence, an intuitive improvement is fusing position-related values (position encodings) to neurons. We propose <span id="S3.SS2.p1.27.1" class="ltx_text ltx_font_bold">Position-Aware Neurons (PANs)</span>, adding or multiplying position encodings to neurons’ outputs, i.e.,</p>
<table id="A6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{+}" display="inline"><semantics id="S3.E2.m1.1a"><msub id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mtext id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2a.cmml">PAN</mtext><mo id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">+</mo></msub><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.2a.cmml" xref="S3.E2.m1.1.1.2"><mtext id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">PAN</mtext></ci><plus id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle\text{PAN}_{+}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2.m2.1" class="ltx_Math" alttext="\displaystyle:~{}h_{l}=f_{l}(W_{l}h_{l-1}+b_{l}+\underline{e_{l}})," display="inline"><semantics id="S3.E2.m2.1a"><mrow id="S3.E2.m2.1.1.1" xref="S3.E2.m2.1.1.1.1.cmml"><mrow id="S3.E2.m2.1.1.1.1" xref="S3.E2.m2.1.1.1.1.cmml"><mi id="S3.E2.m2.1.1.1.1.3" xref="S3.E2.m2.1.1.1.1.3.cmml"></mi><mo lspace="0.278em" rspace="0.608em" id="S3.E2.m2.1.1.1.1.2" xref="S3.E2.m2.1.1.1.1.2.cmml">:</mo><mrow id="S3.E2.m2.1.1.1.1.1" xref="S3.E2.m2.1.1.1.1.1.cmml"><msub id="S3.E2.m2.1.1.1.1.1.3" xref="S3.E2.m2.1.1.1.1.1.3.cmml"><mi id="S3.E2.m2.1.1.1.1.1.3.2" xref="S3.E2.m2.1.1.1.1.1.3.2.cmml">h</mi><mi id="S3.E2.m2.1.1.1.1.1.3.3" xref="S3.E2.m2.1.1.1.1.1.3.3.cmml">l</mi></msub><mo id="S3.E2.m2.1.1.1.1.1.2" xref="S3.E2.m2.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E2.m2.1.1.1.1.1.1" xref="S3.E2.m2.1.1.1.1.1.1.cmml"><msub id="S3.E2.m2.1.1.1.1.1.1.3" xref="S3.E2.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m2.1.1.1.1.1.1.3.2" xref="S3.E2.m2.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E2.m2.1.1.1.1.1.1.3.3" xref="S3.E2.m2.1.1.1.1.1.1.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m2.1.1.1.1.1.1.2" xref="S3.E2.m2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m2.1.1.1.1.1.1.1.1" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m2.1.1.1.1.1.1.1.1.2" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m2.1.1.1.1.1.1.1.1.1" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.2.cmml">h</mi><mrow id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.2" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.2.cmml">l</mi><mo id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.1" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.1.cmml">−</mo><mn id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.3" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E2.m2.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E2.m2.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E2.m2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msub><mo id="S3.E2.m2.1.1.1.1.1.1.1.1.1.1a" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><munder accentunder="true" id="S3.E2.m2.1.1.1.1.1.1.1.1.1.4" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.cmml"><msub id="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2.2" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2.2.cmml">e</mi><mi id="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2.3" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2.3.cmml">l</mi></msub><mo id="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.1" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.1.cmml">¯</mo></munder></mrow><mo stretchy="false" id="S3.E2.m2.1.1.1.1.1.1.1.1.3" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m2.1.1.1.2" xref="S3.E2.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m2.1b"><apply id="S3.E2.m2.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1"><ci id="S3.E2.m2.1.1.1.1.2.cmml" xref="S3.E2.m2.1.1.1.1.2">:</ci><csymbol cd="latexml" id="S3.E2.m2.1.1.1.1.3.cmml" xref="S3.E2.m2.1.1.1.1.3">absent</csymbol><apply id="S3.E2.m2.1.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1.1.1"><eq id="S3.E2.m2.1.1.1.1.1.2.cmml" xref="S3.E2.m2.1.1.1.1.1.2"></eq><apply id="S3.E2.m2.1.1.1.1.1.3.cmml" xref="S3.E2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.1.3.1.cmml" xref="S3.E2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m2.1.1.1.1.1.3.2.cmml" xref="S3.E2.m2.1.1.1.1.1.3.2">ℎ</ci><ci id="S3.E2.m2.1.1.1.1.1.3.3.cmml" xref="S3.E2.m2.1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E2.m2.1.1.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1.1.1.1"><times id="S3.E2.m2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m2.1.1.1.1.1.1.2"></times><apply id="S3.E2.m2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m2.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E2.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m2.1.1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1"><plus id="S3.E2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2"><times id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.2.3">𝑙</ci></apply><apply id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.2">ℎ</ci><apply id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3"><minus id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.1"></minus><ci id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.2">𝑙</ci><cn type="integer" id="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.E2.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.4"><ci id="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.1">¯</ci><apply id="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2.2">𝑒</ci><ci id="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E2.m2.1.1.1.1.1.1.1.1.1.4.2.3">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.1c">\displaystyle:~{}h_{l}=f_{l}(W_{l}h_{l-1}+b_{l}+\underline{e_{l}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{\circ}" display="inline"><semantics id="S3.E3.m1.1a"><msub id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mtext id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2a.cmml">PAN</mtext><mo id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml">∘</mo></msub><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.2a.cmml" xref="S3.E3.m1.1.1.2"><mtext id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2">PAN</mtext></ci><compose id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle\text{PAN}_{\circ}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3.m2.1" class="ltx_Math" alttext="\displaystyle:~{}h_{l}=f_{l}((W_{l}h_{l-1}+b_{l})\odot\underline{e_{l}})," display="inline"><semantics id="S3.E3.m2.1a"><mrow id="S3.E3.m2.1.1.1" xref="S3.E3.m2.1.1.1.1.cmml"><mrow id="S3.E3.m2.1.1.1.1" xref="S3.E3.m2.1.1.1.1.cmml"><mi id="S3.E3.m2.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.3.cmml"></mi><mo lspace="0.278em" rspace="0.608em" id="S3.E3.m2.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.2.cmml">:</mo><mrow id="S3.E3.m2.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.cmml"><msub id="S3.E3.m2.1.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.1.3.cmml"><mi id="S3.E3.m2.1.1.1.1.1.3.2" xref="S3.E3.m2.1.1.1.1.1.3.2.cmml">h</mi><mi id="S3.E3.m2.1.1.1.1.1.3.3" xref="S3.E3.m2.1.1.1.1.1.3.3.cmml">l</mi></msub><mo id="S3.E3.m2.1.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E3.m2.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.cmml"><msub id="S3.E3.m2.1.1.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m2.1.1.1.1.1.1.3.2" xref="S3.E3.m2.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E3.m2.1.1.1.1.1.1.3.3" xref="S3.E3.m2.1.1.1.1.1.1.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m2.1.1.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m2.1.1.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m2.1.1.1.1.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m2.1.1.1.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">h</mi><mrow id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.2.cmml">l</mi><mo id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.1.cmml">−</mo><mn id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E3.m2.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.2.cmml">⊙</mo><munder accentunder="true" id="S3.E3.m2.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2.2.cmml">e</mi><mi id="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2.3.cmml">l</mi></msub><mo id="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.1.cmml">¯</mo></munder></mrow><mo stretchy="false" id="S3.E3.m2.1.1.1.1.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E3.m2.1.1.1.2" xref="S3.E3.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.1b"><apply id="S3.E3.m2.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1"><ci id="S3.E3.m2.1.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.1.2">:</ci><csymbol cd="latexml" id="S3.E3.m2.1.1.1.1.3.cmml" xref="S3.E3.m2.1.1.1.1.3">absent</csymbol><apply id="S3.E3.m2.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1.1"><eq id="S3.E3.m2.1.1.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.1.1.2"></eq><apply id="S3.E3.m2.1.1.1.1.1.3.cmml" xref="S3.E3.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m2.1.1.1.1.1.3.1.cmml" xref="S3.E3.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m2.1.1.1.1.1.3.2.cmml" xref="S3.E3.m2.1.1.1.1.1.3.2">ℎ</ci><ci id="S3.E3.m2.1.1.1.1.1.3.3.cmml" xref="S3.E3.m2.1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E3.m2.1.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1"><times id="S3.E3.m2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.2"></times><apply id="S3.E3.m2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E3.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1"><plus id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2"><times id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑙</ci></apply><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">ℎ</ci><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3"><minus id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.1"></minus><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.2">𝑙</ci><cn type="integer" id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.3"><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.1">¯</ci><apply id="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2.2">𝑒</ci><ci id="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m2.1.1.1.1.1.1.1.1.1.3.2.3">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.1c">\displaystyle:~{}h_{l}=f_{l}((W_{l}h_{l-1}+b_{l})\odot\underline{e_{l}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.4" class="ltx_p">where <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="e_{l}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">e</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑒</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">e_{l}</annotation></semantics></math> denotes position encodings that are only related to positions and not learnable. We use “<math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\text{PAN}_{+}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mtext id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2a.cmml">PAN</mtext><mo id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">+</mo></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2a.cmml" xref="S3.SS2.p1.2.m2.1.1.2"><mtext id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">PAN</mtext></ci><plus id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\text{PAN}_{+}</annotation></semantics></math>” and “<math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\text{PAN}_{\circ}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mtext id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2a.cmml">PAN</mtext><mo id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">∘</mo></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2a.cmml" xref="S3.SS2.p1.3.m3.1.1.2"><mtext id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">PAN</mtext></ci><compose id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\text{PAN}_{\circ}</annotation></semantics></math>” to represent additive and multiplicative PANs, respectively. We use sinusoidal functions to generate <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="e_{l}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">e</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑒</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">e_{l}</annotation></semantics></math> as commonly used in previous position encoding works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, i.e.,</p>
<table id="A6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{+}" display="inline"><semantics id="S3.E4.m1.1a"><msub id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mtext id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2a.cmml">PAN</mtext><mo id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml">+</mo></msub><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.2a.cmml" xref="S3.E4.m1.1.1.2"><mtext id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2">PAN</mtext></ci><plus id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\displaystyle\text{PAN}_{+}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4.m2.5" class="ltx_Math" alttext="\displaystyle:~{}e_{l,j}=A\sin\left(2\pi Tj/J\right)\in[-A,A]," display="inline"><semantics id="S3.E4.m2.5a"><mrow id="S3.E4.m2.5.5.1" xref="S3.E4.m2.5.5.1.1.cmml"><mrow id="S3.E4.m2.5.5.1.1" xref="S3.E4.m2.5.5.1.1.cmml"><mi id="S3.E4.m2.5.5.1.1.4" xref="S3.E4.m2.5.5.1.1.4.cmml"></mi><mo lspace="0.278em" rspace="0.608em" id="S3.E4.m2.5.5.1.1.3" xref="S3.E4.m2.5.5.1.1.3.cmml">:</mo><mrow id="S3.E4.m2.5.5.1.1.2" xref="S3.E4.m2.5.5.1.1.2.cmml"><msub id="S3.E4.m2.5.5.1.1.2.4" xref="S3.E4.m2.5.5.1.1.2.4.cmml"><mi id="S3.E4.m2.5.5.1.1.2.4.2" xref="S3.E4.m2.5.5.1.1.2.4.2.cmml">e</mi><mrow id="S3.E4.m2.2.2.2.4" xref="S3.E4.m2.2.2.2.3.cmml"><mi id="S3.E4.m2.1.1.1.1" xref="S3.E4.m2.1.1.1.1.cmml">l</mi><mo id="S3.E4.m2.2.2.2.4.1" xref="S3.E4.m2.2.2.2.3.cmml">,</mo><mi id="S3.E4.m2.2.2.2.2" xref="S3.E4.m2.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.E4.m2.5.5.1.1.2.5" xref="S3.E4.m2.5.5.1.1.2.5.cmml">=</mo><mrow id="S3.E4.m2.5.5.1.1.1.1" xref="S3.E4.m2.5.5.1.1.1.1.cmml"><mi id="S3.E4.m2.5.5.1.1.1.1.3" xref="S3.E4.m2.5.5.1.1.1.1.3.cmml">A</mi><mo lspace="0.167em" rspace="0em" id="S3.E4.m2.5.5.1.1.1.1.2" xref="S3.E4.m2.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m2.5.5.1.1.1.1.1.1" xref="S3.E4.m2.5.5.1.1.1.1.1.2.cmml"><mi id="S3.E4.m2.3.3" xref="S3.E4.m2.3.3.cmml">sin</mi><mo id="S3.E4.m2.5.5.1.1.1.1.1.1a" xref="S3.E4.m2.5.5.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E4.m2.5.5.1.1.1.1.1.1.1" xref="S3.E4.m2.5.5.1.1.1.1.1.2.cmml"><mo id="S3.E4.m2.5.5.1.1.1.1.1.1.1.2" xref="S3.E4.m2.5.5.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.cmml"><mn id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.1" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.1a" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.4" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.4.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.1b" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.5" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.5.cmml">j</mi></mrow><mo id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">/</mo><mi id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.3.cmml">J</mi></mrow><mo id="S3.E4.m2.5.5.1.1.1.1.1.1.1.3" xref="S3.E4.m2.5.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m2.5.5.1.1.2.6" xref="S3.E4.m2.5.5.1.1.2.6.cmml">∈</mo><mrow id="S3.E4.m2.5.5.1.1.2.2.1" xref="S3.E4.m2.5.5.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E4.m2.5.5.1.1.2.2.1.2" xref="S3.E4.m2.5.5.1.1.2.2.2.cmml">[</mo><mrow id="S3.E4.m2.5.5.1.1.2.2.1.1" xref="S3.E4.m2.5.5.1.1.2.2.1.1.cmml"><mo id="S3.E4.m2.5.5.1.1.2.2.1.1a" xref="S3.E4.m2.5.5.1.1.2.2.1.1.cmml">−</mo><mi id="S3.E4.m2.5.5.1.1.2.2.1.1.2" xref="S3.E4.m2.5.5.1.1.2.2.1.1.2.cmml">A</mi></mrow><mo id="S3.E4.m2.5.5.1.1.2.2.1.3" xref="S3.E4.m2.5.5.1.1.2.2.2.cmml">,</mo><mi id="S3.E4.m2.4.4" xref="S3.E4.m2.4.4.cmml">A</mi><mo stretchy="false" id="S3.E4.m2.5.5.1.1.2.2.1.4" xref="S3.E4.m2.5.5.1.1.2.2.2.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E4.m2.5.5.1.2" xref="S3.E4.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m2.5b"><apply id="S3.E4.m2.5.5.1.1.cmml" xref="S3.E4.m2.5.5.1"><ci id="S3.E4.m2.5.5.1.1.3.cmml" xref="S3.E4.m2.5.5.1.1.3">:</ci><csymbol cd="latexml" id="S3.E4.m2.5.5.1.1.4.cmml" xref="S3.E4.m2.5.5.1.1.4">absent</csymbol><apply id="S3.E4.m2.5.5.1.1.2.cmml" xref="S3.E4.m2.5.5.1.1.2"><and id="S3.E4.m2.5.5.1.1.2a.cmml" xref="S3.E4.m2.5.5.1.1.2"></and><apply id="S3.E4.m2.5.5.1.1.2b.cmml" xref="S3.E4.m2.5.5.1.1.2"><eq id="S3.E4.m2.5.5.1.1.2.5.cmml" xref="S3.E4.m2.5.5.1.1.2.5"></eq><apply id="S3.E4.m2.5.5.1.1.2.4.cmml" xref="S3.E4.m2.5.5.1.1.2.4"><csymbol cd="ambiguous" id="S3.E4.m2.5.5.1.1.2.4.1.cmml" xref="S3.E4.m2.5.5.1.1.2.4">subscript</csymbol><ci id="S3.E4.m2.5.5.1.1.2.4.2.cmml" xref="S3.E4.m2.5.5.1.1.2.4.2">𝑒</ci><list id="S3.E4.m2.2.2.2.3.cmml" xref="S3.E4.m2.2.2.2.4"><ci id="S3.E4.m2.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1">𝑙</ci><ci id="S3.E4.m2.2.2.2.2.cmml" xref="S3.E4.m2.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E4.m2.5.5.1.1.1.1.cmml" xref="S3.E4.m2.5.5.1.1.1.1"><times id="S3.E4.m2.5.5.1.1.1.1.2.cmml" xref="S3.E4.m2.5.5.1.1.1.1.2"></times><ci id="S3.E4.m2.5.5.1.1.1.1.3.cmml" xref="S3.E4.m2.5.5.1.1.1.1.3">𝐴</ci><apply id="S3.E4.m2.5.5.1.1.1.1.1.2.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1"><sin id="S3.E4.m2.3.3.cmml" xref="S3.E4.m2.3.3"></sin><apply id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1"><divide id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.1"></divide><apply id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2"><times id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.1"></times><cn type="integer" id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.2">2</cn><ci id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.3">𝜋</ci><ci id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.4">𝑇</ci><ci id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.5.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.2.5">𝑗</ci></apply><ci id="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m2.5.5.1.1.1.1.1.1.1.1.3">𝐽</ci></apply></apply></apply></apply><apply id="S3.E4.m2.5.5.1.1.2c.cmml" xref="S3.E4.m2.5.5.1.1.2"><in id="S3.E4.m2.5.5.1.1.2.6.cmml" xref="S3.E4.m2.5.5.1.1.2.6"></in><share href="#S3.E4.m2.5.5.1.1.1.1.cmml" id="S3.E4.m2.5.5.1.1.2d.cmml" xref="S3.E4.m2.5.5.1.1.2"></share><interval closure="closed" id="S3.E4.m2.5.5.1.1.2.2.2.cmml" xref="S3.E4.m2.5.5.1.1.2.2.1"><apply id="S3.E4.m2.5.5.1.1.2.2.1.1.cmml" xref="S3.E4.m2.5.5.1.1.2.2.1.1"><minus id="S3.E4.m2.5.5.1.1.2.2.1.1.1.cmml" xref="S3.E4.m2.5.5.1.1.2.2.1.1"></minus><ci id="S3.E4.m2.5.5.1.1.2.2.1.1.2.cmml" xref="S3.E4.m2.5.5.1.1.2.2.1.1.2">𝐴</ci></apply><ci id="S3.E4.m2.4.4.cmml" xref="S3.E4.m2.4.4">𝐴</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m2.5c">\displaystyle:~{}e_{l,j}=A\sin\left(2\pi Tj/J\right)\in[-A,A],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{\circ}" display="inline"><semantics id="S3.E5.m1.1a"><msub id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mtext id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2a.cmml">PAN</mtext><mo id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml">∘</mo></msub><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.2a.cmml" xref="S3.E5.m1.1.1.2"><mtext id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2">PAN</mtext></ci><compose id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle\text{PAN}_{\circ}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5.m2.4" class="ltx_Math" alttext="\displaystyle:~{}e_{l,j}=1+A\sin\left(2\pi Tj/J\right)\in[1-A,1+A]," display="inline"><semantics id="S3.E5.m2.4a"><mrow id="S3.E5.m2.4.4.1" xref="S3.E5.m2.4.4.1.1.cmml"><mrow id="S3.E5.m2.4.4.1.1" xref="S3.E5.m2.4.4.1.1.cmml"><mi id="S3.E5.m2.4.4.1.1.5" xref="S3.E5.m2.4.4.1.1.5.cmml"></mi><mo lspace="0.278em" rspace="0.608em" id="S3.E5.m2.4.4.1.1.4" xref="S3.E5.m2.4.4.1.1.4.cmml">:</mo><mrow id="S3.E5.m2.4.4.1.1.3" xref="S3.E5.m2.4.4.1.1.3.cmml"><msub id="S3.E5.m2.4.4.1.1.3.5" xref="S3.E5.m2.4.4.1.1.3.5.cmml"><mi id="S3.E5.m2.4.4.1.1.3.5.2" xref="S3.E5.m2.4.4.1.1.3.5.2.cmml">e</mi><mrow id="S3.E5.m2.2.2.2.4" xref="S3.E5.m2.2.2.2.3.cmml"><mi id="S3.E5.m2.1.1.1.1" xref="S3.E5.m2.1.1.1.1.cmml">l</mi><mo id="S3.E5.m2.2.2.2.4.1" xref="S3.E5.m2.2.2.2.3.cmml">,</mo><mi id="S3.E5.m2.2.2.2.2" xref="S3.E5.m2.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.E5.m2.4.4.1.1.3.6" xref="S3.E5.m2.4.4.1.1.3.6.cmml">=</mo><mrow id="S3.E5.m2.4.4.1.1.1.1" xref="S3.E5.m2.4.4.1.1.1.1.cmml"><mn id="S3.E5.m2.4.4.1.1.1.1.3" xref="S3.E5.m2.4.4.1.1.1.1.3.cmml">1</mn><mo id="S3.E5.m2.4.4.1.1.1.1.2" xref="S3.E5.m2.4.4.1.1.1.1.2.cmml">+</mo><mrow id="S3.E5.m2.4.4.1.1.1.1.1" xref="S3.E5.m2.4.4.1.1.1.1.1.cmml"><mi id="S3.E5.m2.4.4.1.1.1.1.1.3" xref="S3.E5.m2.4.4.1.1.1.1.1.3.cmml">A</mi><mo lspace="0.167em" rspace="0em" id="S3.E5.m2.4.4.1.1.1.1.1.2" xref="S3.E5.m2.4.4.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m2.4.4.1.1.1.1.1.1.1" xref="S3.E5.m2.4.4.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m2.3.3" xref="S3.E5.m2.3.3.cmml">sin</mi><mo id="S3.E5.m2.4.4.1.1.1.1.1.1.1a" xref="S3.E5.m2.4.4.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1" xref="S3.E5.m2.4.4.1.1.1.1.1.1.2.cmml"><mo id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E5.m2.4.4.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mn id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.1a" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.4.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.1b" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.5" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.5.cmml">j</mi></mrow><mo id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.1.cmml">/</mo><mi id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.3.cmml">J</mi></mrow><mo id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E5.m2.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m2.4.4.1.1.3.7" xref="S3.E5.m2.4.4.1.1.3.7.cmml">∈</mo><mrow id="S3.E5.m2.4.4.1.1.3.3.2" xref="S3.E5.m2.4.4.1.1.3.3.3.cmml"><mo stretchy="false" id="S3.E5.m2.4.4.1.1.3.3.2.3" xref="S3.E5.m2.4.4.1.1.3.3.3.cmml">[</mo><mrow id="S3.E5.m2.4.4.1.1.2.2.1.1" xref="S3.E5.m2.4.4.1.1.2.2.1.1.cmml"><mn id="S3.E5.m2.4.4.1.1.2.2.1.1.2" xref="S3.E5.m2.4.4.1.1.2.2.1.1.2.cmml">1</mn><mo id="S3.E5.m2.4.4.1.1.2.2.1.1.1" xref="S3.E5.m2.4.4.1.1.2.2.1.1.1.cmml">−</mo><mi id="S3.E5.m2.4.4.1.1.2.2.1.1.3" xref="S3.E5.m2.4.4.1.1.2.2.1.1.3.cmml">A</mi></mrow><mo id="S3.E5.m2.4.4.1.1.3.3.2.4" xref="S3.E5.m2.4.4.1.1.3.3.3.cmml">,</mo><mrow id="S3.E5.m2.4.4.1.1.3.3.2.2" xref="S3.E5.m2.4.4.1.1.3.3.2.2.cmml"><mn id="S3.E5.m2.4.4.1.1.3.3.2.2.2" xref="S3.E5.m2.4.4.1.1.3.3.2.2.2.cmml">1</mn><mo id="S3.E5.m2.4.4.1.1.3.3.2.2.1" xref="S3.E5.m2.4.4.1.1.3.3.2.2.1.cmml">+</mo><mi id="S3.E5.m2.4.4.1.1.3.3.2.2.3" xref="S3.E5.m2.4.4.1.1.3.3.2.2.3.cmml">A</mi></mrow><mo stretchy="false" id="S3.E5.m2.4.4.1.1.3.3.2.5" xref="S3.E5.m2.4.4.1.1.3.3.3.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E5.m2.4.4.1.2" xref="S3.E5.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m2.4b"><apply id="S3.E5.m2.4.4.1.1.cmml" xref="S3.E5.m2.4.4.1"><ci id="S3.E5.m2.4.4.1.1.4.cmml" xref="S3.E5.m2.4.4.1.1.4">:</ci><csymbol cd="latexml" id="S3.E5.m2.4.4.1.1.5.cmml" xref="S3.E5.m2.4.4.1.1.5">absent</csymbol><apply id="S3.E5.m2.4.4.1.1.3.cmml" xref="S3.E5.m2.4.4.1.1.3"><and id="S3.E5.m2.4.4.1.1.3a.cmml" xref="S3.E5.m2.4.4.1.1.3"></and><apply id="S3.E5.m2.4.4.1.1.3b.cmml" xref="S3.E5.m2.4.4.1.1.3"><eq id="S3.E5.m2.4.4.1.1.3.6.cmml" xref="S3.E5.m2.4.4.1.1.3.6"></eq><apply id="S3.E5.m2.4.4.1.1.3.5.cmml" xref="S3.E5.m2.4.4.1.1.3.5"><csymbol cd="ambiguous" id="S3.E5.m2.4.4.1.1.3.5.1.cmml" xref="S3.E5.m2.4.4.1.1.3.5">subscript</csymbol><ci id="S3.E5.m2.4.4.1.1.3.5.2.cmml" xref="S3.E5.m2.4.4.1.1.3.5.2">𝑒</ci><list id="S3.E5.m2.2.2.2.3.cmml" xref="S3.E5.m2.2.2.2.4"><ci id="S3.E5.m2.1.1.1.1.cmml" xref="S3.E5.m2.1.1.1.1">𝑙</ci><ci id="S3.E5.m2.2.2.2.2.cmml" xref="S3.E5.m2.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E5.m2.4.4.1.1.1.1.cmml" xref="S3.E5.m2.4.4.1.1.1.1"><plus id="S3.E5.m2.4.4.1.1.1.1.2.cmml" xref="S3.E5.m2.4.4.1.1.1.1.2"></plus><cn type="integer" id="S3.E5.m2.4.4.1.1.1.1.3.cmml" xref="S3.E5.m2.4.4.1.1.1.1.3">1</cn><apply id="S3.E5.m2.4.4.1.1.1.1.1.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1"><times id="S3.E5.m2.4.4.1.1.1.1.1.2.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1.2"></times><ci id="S3.E5.m2.4.4.1.1.1.1.1.3.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1.3">𝐴</ci><apply id="S3.E5.m2.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1"><sin id="S3.E5.m2.3.3.cmml" xref="S3.E5.m2.3.3"></sin><apply id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1"><divide id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.1"></divide><apply id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2"><times id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.1"></times><cn type="integer" id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.2">2</cn><ci id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.3">𝜋</ci><ci id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.4">𝑇</ci><ci id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.5.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.2.5">𝑗</ci></apply><ci id="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m2.4.4.1.1.1.1.1.1.1.1.1.3">𝐽</ci></apply></apply></apply></apply></apply><apply id="S3.E5.m2.4.4.1.1.3c.cmml" xref="S3.E5.m2.4.4.1.1.3"><in id="S3.E5.m2.4.4.1.1.3.7.cmml" xref="S3.E5.m2.4.4.1.1.3.7"></in><share href="#S3.E5.m2.4.4.1.1.1.1.cmml" id="S3.E5.m2.4.4.1.1.3d.cmml" xref="S3.E5.m2.4.4.1.1.3"></share><interval closure="closed" id="S3.E5.m2.4.4.1.1.3.3.3.cmml" xref="S3.E5.m2.4.4.1.1.3.3.2"><apply id="S3.E5.m2.4.4.1.1.2.2.1.1.cmml" xref="S3.E5.m2.4.4.1.1.2.2.1.1"><minus id="S3.E5.m2.4.4.1.1.2.2.1.1.1.cmml" xref="S3.E5.m2.4.4.1.1.2.2.1.1.1"></minus><cn type="integer" id="S3.E5.m2.4.4.1.1.2.2.1.1.2.cmml" xref="S3.E5.m2.4.4.1.1.2.2.1.1.2">1</cn><ci id="S3.E5.m2.4.4.1.1.2.2.1.1.3.cmml" xref="S3.E5.m2.4.4.1.1.2.2.1.1.3">𝐴</ci></apply><apply id="S3.E5.m2.4.4.1.1.3.3.2.2.cmml" xref="S3.E5.m2.4.4.1.1.3.3.2.2"><plus id="S3.E5.m2.4.4.1.1.3.3.2.2.1.cmml" xref="S3.E5.m2.4.4.1.1.3.3.2.2.1"></plus><cn type="integer" id="S3.E5.m2.4.4.1.1.3.3.2.2.2.cmml" xref="S3.E5.m2.4.4.1.1.3.3.2.2.2">1</cn><ci id="S3.E5.m2.4.4.1.1.3.3.2.2.3.cmml" xref="S3.E5.m2.4.4.1.1.3.3.2.2.3">𝐴</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m2.4c">\displaystyle:~{}e_{l,j}=1+A\sin\left(2\pi Tj/J\right)\in[1-A,1+A],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.12" class="ltx_p">where <math id="S3.SS2.p1.5.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p1.5.m1.1a"><mi id="S3.SS2.p1.5.m1.1.1" xref="S3.SS2.p1.5.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m1.1b"><ci id="S3.SS2.p1.5.m1.1.1.cmml" xref="S3.SS2.p1.5.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m1.1c">T</annotation></semantics></math> and <math id="S3.SS2.p1.6.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS2.p1.6.m2.1a"><mi id="S3.SS2.p1.6.m2.1.1" xref="S3.SS2.p1.6.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m2.1b"><ci id="S3.SS2.p1.6.m2.1.1.cmml" xref="S3.SS2.p1.6.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m2.1c">A</annotation></semantics></math> respectively denotes the period and amplitude of position encodings, and <math id="S3.SS2.p1.7.m3.4" class="ltx_Math" alttext="j\in\{0,1,\cdots,J-1\}" display="inline"><semantics id="S3.SS2.p1.7.m3.4a"><mrow id="S3.SS2.p1.7.m3.4.4" xref="S3.SS2.p1.7.m3.4.4.cmml"><mi id="S3.SS2.p1.7.m3.4.4.3" xref="S3.SS2.p1.7.m3.4.4.3.cmml">j</mi><mo id="S3.SS2.p1.7.m3.4.4.2" xref="S3.SS2.p1.7.m3.4.4.2.cmml">∈</mo><mrow id="S3.SS2.p1.7.m3.4.4.1.1" xref="S3.SS2.p1.7.m3.4.4.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.7.m3.4.4.1.1.2" xref="S3.SS2.p1.7.m3.4.4.1.2.cmml">{</mo><mn id="S3.SS2.p1.7.m3.1.1" xref="S3.SS2.p1.7.m3.1.1.cmml">0</mn><mo id="S3.SS2.p1.7.m3.4.4.1.1.3" xref="S3.SS2.p1.7.m3.4.4.1.2.cmml">,</mo><mn id="S3.SS2.p1.7.m3.2.2" xref="S3.SS2.p1.7.m3.2.2.cmml">1</mn><mo id="S3.SS2.p1.7.m3.4.4.1.1.4" xref="S3.SS2.p1.7.m3.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.7.m3.3.3" xref="S3.SS2.p1.7.m3.3.3.cmml">⋯</mi><mo id="S3.SS2.p1.7.m3.4.4.1.1.5" xref="S3.SS2.p1.7.m3.4.4.1.2.cmml">,</mo><mrow id="S3.SS2.p1.7.m3.4.4.1.1.1" xref="S3.SS2.p1.7.m3.4.4.1.1.1.cmml"><mi id="S3.SS2.p1.7.m3.4.4.1.1.1.2" xref="S3.SS2.p1.7.m3.4.4.1.1.1.2.cmml">J</mi><mo id="S3.SS2.p1.7.m3.4.4.1.1.1.1" xref="S3.SS2.p1.7.m3.4.4.1.1.1.1.cmml">−</mo><mn id="S3.SS2.p1.7.m3.4.4.1.1.1.3" xref="S3.SS2.p1.7.m3.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p1.7.m3.4.4.1.1.6" xref="S3.SS2.p1.7.m3.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m3.4b"><apply id="S3.SS2.p1.7.m3.4.4.cmml" xref="S3.SS2.p1.7.m3.4.4"><in id="S3.SS2.p1.7.m3.4.4.2.cmml" xref="S3.SS2.p1.7.m3.4.4.2"></in><ci id="S3.SS2.p1.7.m3.4.4.3.cmml" xref="S3.SS2.p1.7.m3.4.4.3">𝑗</ci><set id="S3.SS2.p1.7.m3.4.4.1.2.cmml" xref="S3.SS2.p1.7.m3.4.4.1.1"><cn type="integer" id="S3.SS2.p1.7.m3.1.1.cmml" xref="S3.SS2.p1.7.m3.1.1">0</cn><cn type="integer" id="S3.SS2.p1.7.m3.2.2.cmml" xref="S3.SS2.p1.7.m3.2.2">1</cn><ci id="S3.SS2.p1.7.m3.3.3.cmml" xref="S3.SS2.p1.7.m3.3.3">⋯</ci><apply id="S3.SS2.p1.7.m3.4.4.1.1.1.cmml" xref="S3.SS2.p1.7.m3.4.4.1.1.1"><minus id="S3.SS2.p1.7.m3.4.4.1.1.1.1.cmml" xref="S3.SS2.p1.7.m3.4.4.1.1.1.1"></minus><ci id="S3.SS2.p1.7.m3.4.4.1.1.1.2.cmml" xref="S3.SS2.p1.7.m3.4.4.1.1.1.2">𝐽</ci><cn type="integer" id="S3.SS2.p1.7.m3.4.4.1.1.1.3.cmml" xref="S3.SS2.p1.7.m3.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m3.4c">j\in\{0,1,\cdots,J-1\}</annotation></semantics></math> is the position index of a neuron. <span id="S3.SS2.p1.12.5" class="ltx_text ltx_font_italic">For ConvNet, we assign position encodings for each channel, and <math id="S3.SS2.p1.8.1.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS2.p1.8.1.m1.1a"><mi id="S3.SS2.p1.8.1.m1.1.1" xref="S3.SS2.p1.8.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.1.m1.1b"><ci id="S3.SS2.p1.8.1.m1.1.1.cmml" xref="S3.SS2.p1.8.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.1.m1.1c">j</annotation></semantics></math> is the channel index. Notably, if we take <math id="S3.SS2.p1.9.2.m2.1" class="ltx_Math" alttext="T\rightarrow 0" display="inline"><semantics id="S3.SS2.p1.9.2.m2.1a"><mrow id="S3.SS2.p1.9.2.m2.1.1" xref="S3.SS2.p1.9.2.m2.1.1.cmml"><mi id="S3.SS2.p1.9.2.m2.1.1.2" xref="S3.SS2.p1.9.2.m2.1.1.2.cmml">T</mi><mo stretchy="false" id="S3.SS2.p1.9.2.m2.1.1.1" xref="S3.SS2.p1.9.2.m2.1.1.1.cmml">→</mo><mn id="S3.SS2.p1.9.2.m2.1.1.3" xref="S3.SS2.p1.9.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.2.m2.1b"><apply id="S3.SS2.p1.9.2.m2.1.1.cmml" xref="S3.SS2.p1.9.2.m2.1.1"><ci id="S3.SS2.p1.9.2.m2.1.1.1.cmml" xref="S3.SS2.p1.9.2.m2.1.1.1">→</ci><ci id="S3.SS2.p1.9.2.m2.1.1.2.cmml" xref="S3.SS2.p1.9.2.m2.1.1.2">𝑇</ci><cn type="integer" id="S3.SS2.p1.9.2.m2.1.1.3.cmml" xref="S3.SS2.p1.9.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.2.m2.1c">T\rightarrow 0</annotation></semantics></math> or <math id="S3.SS2.p1.10.3.m3.1" class="ltx_Math" alttext="A=0" display="inline"><semantics id="S3.SS2.p1.10.3.m3.1a"><mrow id="S3.SS2.p1.10.3.m3.1.1" xref="S3.SS2.p1.10.3.m3.1.1.cmml"><mi id="S3.SS2.p1.10.3.m3.1.1.2" xref="S3.SS2.p1.10.3.m3.1.1.2.cmml">A</mi><mo id="S3.SS2.p1.10.3.m3.1.1.1" xref="S3.SS2.p1.10.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.10.3.m3.1.1.3" xref="S3.SS2.p1.10.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.3.m3.1b"><apply id="S3.SS2.p1.10.3.m3.1.1.cmml" xref="S3.SS2.p1.10.3.m3.1.1"><eq id="S3.SS2.p1.10.3.m3.1.1.1.cmml" xref="S3.SS2.p1.10.3.m3.1.1.1"></eq><ci id="S3.SS2.p1.10.3.m3.1.1.2.cmml" xref="S3.SS2.p1.10.3.m3.1.1.2">𝐴</ci><cn type="integer" id="S3.SS2.p1.10.3.m3.1.1.3.cmml" xref="S3.SS2.p1.10.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.3.m3.1c">A=0</annotation></semantics></math>, PANs degenerate into normal neurons. In practice, we only apply PANs to the hidden layers, while the input and output layers remain unchanged, i.e., <math id="S3.SS2.p1.11.4.m4.4" class="ltx_Math" alttext="l\in\{1,2,\cdots,L-1\}" display="inline"><semantics id="S3.SS2.p1.11.4.m4.4a"><mrow id="S3.SS2.p1.11.4.m4.4.4" xref="S3.SS2.p1.11.4.m4.4.4.cmml"><mi id="S3.SS2.p1.11.4.m4.4.4.3" xref="S3.SS2.p1.11.4.m4.4.4.3.cmml">l</mi><mo id="S3.SS2.p1.11.4.m4.4.4.2" xref="S3.SS2.p1.11.4.m4.4.4.2.cmml">∈</mo><mrow id="S3.SS2.p1.11.4.m4.4.4.1.1" xref="S3.SS2.p1.11.4.m4.4.4.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.11.4.m4.4.4.1.1.2" xref="S3.SS2.p1.11.4.m4.4.4.1.2.cmml">{</mo><mn id="S3.SS2.p1.11.4.m4.1.1" xref="S3.SS2.p1.11.4.m4.1.1.cmml">1</mn><mo id="S3.SS2.p1.11.4.m4.4.4.1.1.3" xref="S3.SS2.p1.11.4.m4.4.4.1.2.cmml">,</mo><mn id="S3.SS2.p1.11.4.m4.2.2" xref="S3.SS2.p1.11.4.m4.2.2.cmml">2</mn><mo id="S3.SS2.p1.11.4.m4.4.4.1.1.4" xref="S3.SS2.p1.11.4.m4.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.11.4.m4.3.3" xref="S3.SS2.p1.11.4.m4.3.3.cmml">⋯</mi><mo id="S3.SS2.p1.11.4.m4.4.4.1.1.5" xref="S3.SS2.p1.11.4.m4.4.4.1.2.cmml">,</mo><mrow id="S3.SS2.p1.11.4.m4.4.4.1.1.1" xref="S3.SS2.p1.11.4.m4.4.4.1.1.1.cmml"><mi id="S3.SS2.p1.11.4.m4.4.4.1.1.1.2" xref="S3.SS2.p1.11.4.m4.4.4.1.1.1.2.cmml">L</mi><mo id="S3.SS2.p1.11.4.m4.4.4.1.1.1.1" xref="S3.SS2.p1.11.4.m4.4.4.1.1.1.1.cmml">−</mo><mn id="S3.SS2.p1.11.4.m4.4.4.1.1.1.3" xref="S3.SS2.p1.11.4.m4.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p1.11.4.m4.4.4.1.1.6" xref="S3.SS2.p1.11.4.m4.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.4.m4.4b"><apply id="S3.SS2.p1.11.4.m4.4.4.cmml" xref="S3.SS2.p1.11.4.m4.4.4"><in id="S3.SS2.p1.11.4.m4.4.4.2.cmml" xref="S3.SS2.p1.11.4.m4.4.4.2"></in><ci id="S3.SS2.p1.11.4.m4.4.4.3.cmml" xref="S3.SS2.p1.11.4.m4.4.4.3">𝑙</ci><set id="S3.SS2.p1.11.4.m4.4.4.1.2.cmml" xref="S3.SS2.p1.11.4.m4.4.4.1.1"><cn type="integer" id="S3.SS2.p1.11.4.m4.1.1.cmml" xref="S3.SS2.p1.11.4.m4.1.1">1</cn><cn type="integer" id="S3.SS2.p1.11.4.m4.2.2.cmml" xref="S3.SS2.p1.11.4.m4.2.2">2</cn><ci id="S3.SS2.p1.11.4.m4.3.3.cmml" xref="S3.SS2.p1.11.4.m4.3.3">⋯</ci><apply id="S3.SS2.p1.11.4.m4.4.4.1.1.1.cmml" xref="S3.SS2.p1.11.4.m4.4.4.1.1.1"><minus id="S3.SS2.p1.11.4.m4.4.4.1.1.1.1.cmml" xref="S3.SS2.p1.11.4.m4.4.4.1.1.1.1"></minus><ci id="S3.SS2.p1.11.4.m4.4.4.1.1.1.2.cmml" xref="S3.SS2.p1.11.4.m4.4.4.1.1.1.2">𝐿</ci><cn type="integer" id="S3.SS2.p1.11.4.m4.4.4.1.1.1.3.cmml" xref="S3.SS2.p1.11.4.m4.4.4.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.4.m4.4c">l\in\{1,2,\cdots,L-1\}</annotation></semantics></math> for <math id="S3.SS2.p1.12.5.m5.1" class="ltx_Math" alttext="e_{l}" display="inline"><semantics id="S3.SS2.p1.12.5.m5.1a"><msub id="S3.SS2.p1.12.5.m5.1.1" xref="S3.SS2.p1.12.5.m5.1.1.cmml"><mi id="S3.SS2.p1.12.5.m5.1.1.2" xref="S3.SS2.p1.12.5.m5.1.1.2.cmml">e</mi><mi id="S3.SS2.p1.12.5.m5.1.1.3" xref="S3.SS2.p1.12.5.m5.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.5.m5.1b"><apply id="S3.SS2.p1.12.5.m5.1.1.cmml" xref="S3.SS2.p1.12.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.12.5.m5.1.1.1.cmml" xref="S3.SS2.p1.12.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.12.5.m5.1.1.2.cmml" xref="S3.SS2.p1.12.5.m5.1.1.2">𝑒</ci><ci id="S3.SS2.p1.12.5.m5.1.1.3.cmml" xref="S3.SS2.p1.12.5.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.5.m5.1c">e_{l}</annotation></semantics></math>.</span> With PANs, the permutation process in Eq. <a href="#S3.E1" title="Equation 1 ‣ 3.1 Permutation Invariance Property ‣ 3 Position-Aware Neurons ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> could be reformulated as</p>
<table id="A6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{+}" display="inline"><semantics id="S3.E6.m1.1a"><msub id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mtext id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2a.cmml">PAN</mtext><mo id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml">+</mo></msub><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.2a.cmml" xref="S3.E6.m1.1.1.2"><mtext id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2">PAN</mtext></ci><plus id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle\text{PAN}_{+}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6.m2.5" class="ltx_Math" alttext="\displaystyle:~{}h_{l,\text{sf}}=f_{l}(\Pi_{l}W_{l}\Pi_{l-1}^{T}h_{l-1,\text{sf}}+\Pi_{l}b_{l}+\underline{e_{l}})," display="inline"><semantics id="S3.E6.m2.5a"><mrow id="S3.E6.m2.5.5.1" xref="S3.E6.m2.5.5.1.1.cmml"><mrow id="S3.E6.m2.5.5.1.1" xref="S3.E6.m2.5.5.1.1.cmml"><mi id="S3.E6.m2.5.5.1.1.3" xref="S3.E6.m2.5.5.1.1.3.cmml"></mi><mo lspace="0.278em" rspace="0.608em" id="S3.E6.m2.5.5.1.1.2" xref="S3.E6.m2.5.5.1.1.2.cmml">:</mo><mrow id="S3.E6.m2.5.5.1.1.1" xref="S3.E6.m2.5.5.1.1.1.cmml"><msub id="S3.E6.m2.5.5.1.1.1.3" xref="S3.E6.m2.5.5.1.1.1.3.cmml"><mi id="S3.E6.m2.5.5.1.1.1.3.2" xref="S3.E6.m2.5.5.1.1.1.3.2.cmml">h</mi><mrow id="S3.E6.m2.2.2.2.4" xref="S3.E6.m2.2.2.2.3.cmml"><mi id="S3.E6.m2.1.1.1.1" xref="S3.E6.m2.1.1.1.1.cmml">l</mi><mo id="S3.E6.m2.2.2.2.4.1" xref="S3.E6.m2.2.2.2.3.cmml">,</mo><mtext id="S3.E6.m2.2.2.2.2" xref="S3.E6.m2.2.2.2.2a.cmml">sf</mtext></mrow></msub><mo id="S3.E6.m2.5.5.1.1.1.2" xref="S3.E6.m2.5.5.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m2.5.5.1.1.1.1" xref="S3.E6.m2.5.5.1.1.1.1.cmml"><msub id="S3.E6.m2.5.5.1.1.1.1.3" xref="S3.E6.m2.5.5.1.1.1.1.3.cmml"><mi id="S3.E6.m2.5.5.1.1.1.1.3.2" xref="S3.E6.m2.5.5.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E6.m2.5.5.1.1.1.1.3.3" xref="S3.E6.m2.5.5.1.1.1.1.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m2.5.5.1.1.1.1.2" xref="S3.E6.m2.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m2.5.5.1.1.1.1.1.1" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m2.5.5.1.1.1.1.1.1.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m2.5.5.1.1.1.1.1.1.1" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2.cmml"><mi mathvariant="normal" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2.2.cmml">Π</mi><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.1" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.1a" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.cmml"><mi mathvariant="normal" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.2.cmml">Π</mi><mrow id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.cmml"><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.2.cmml">l</mi><mo id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.1" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.1.cmml">−</mo><mn id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.1b" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.5" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.5.cmml"><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.5.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.5.2.cmml">h</mi><mrow id="S3.E6.m2.4.4.2.2" xref="S3.E6.m2.4.4.2.3.cmml"><mrow id="S3.E6.m2.4.4.2.2.1" xref="S3.E6.m2.4.4.2.2.1.cmml"><mi id="S3.E6.m2.4.4.2.2.1.2" xref="S3.E6.m2.4.4.2.2.1.2.cmml">l</mi><mo id="S3.E6.m2.4.4.2.2.1.1" xref="S3.E6.m2.4.4.2.2.1.1.cmml">−</mo><mn id="S3.E6.m2.4.4.2.2.1.3" xref="S3.E6.m2.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E6.m2.4.4.2.2.2" xref="S3.E6.m2.4.4.2.3.cmml">,</mo><mtext id="S3.E6.m2.3.3.1.1" xref="S3.E6.m2.3.3.1.1a.cmml">sf</mtext></mrow></msub></mrow><mo id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2.cmml"><mi mathvariant="normal" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2.2.cmml">Π</mi><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.1" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3.2.cmml">b</mi><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3.3.cmml">l</mi></msub></mrow><mo id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1a" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.cmml">+</mo><munder accentunder="true" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.cmml"><msub id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.2" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.2.cmml">e</mi><mi id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.3.cmml">l</mi></msub><mo id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.1" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.1.cmml">¯</mo></munder></mrow><mo stretchy="false" id="S3.E6.m2.5.5.1.1.1.1.1.1.3" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m2.5.5.1.2" xref="S3.E6.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m2.5b"><apply id="S3.E6.m2.5.5.1.1.cmml" xref="S3.E6.m2.5.5.1"><ci id="S3.E6.m2.5.5.1.1.2.cmml" xref="S3.E6.m2.5.5.1.1.2">:</ci><csymbol cd="latexml" id="S3.E6.m2.5.5.1.1.3.cmml" xref="S3.E6.m2.5.5.1.1.3">absent</csymbol><apply id="S3.E6.m2.5.5.1.1.1.cmml" xref="S3.E6.m2.5.5.1.1.1"><eq id="S3.E6.m2.5.5.1.1.1.2.cmml" xref="S3.E6.m2.5.5.1.1.1.2"></eq><apply id="S3.E6.m2.5.5.1.1.1.3.cmml" xref="S3.E6.m2.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.3.1.cmml" xref="S3.E6.m2.5.5.1.1.1.3">subscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.3.2.cmml" xref="S3.E6.m2.5.5.1.1.1.3.2">ℎ</ci><list id="S3.E6.m2.2.2.2.3.cmml" xref="S3.E6.m2.2.2.2.4"><ci id="S3.E6.m2.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1">𝑙</ci><ci id="S3.E6.m2.2.2.2.2a.cmml" xref="S3.E6.m2.2.2.2.2"><mtext mathsize="70%" id="S3.E6.m2.2.2.2.2.cmml" xref="S3.E6.m2.2.2.2.2">sf</mtext></ci></list></apply><apply id="S3.E6.m2.5.5.1.1.1.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1"><times id="S3.E6.m2.5.5.1.1.1.1.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.2"></times><apply id="S3.E6.m2.5.5.1.1.1.1.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.3.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.1.3.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.3.2">𝑓</ci><ci id="S3.E6.m2.5.5.1.1.1.1.3.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1"><plus id="S3.E6.m2.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.1"></plus><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2"><times id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2.2">Π</ci><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.2.3">𝑙</ci></apply><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3.2">𝑊</ci><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.3.3">𝑙</ci></apply><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4">superscript</csymbol><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.2">Π</ci><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3"><minus id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.1"></minus><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.2">𝑙</ci><cn type="integer" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.2.3.3">1</cn></apply></apply><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.4.3">𝑇</ci></apply><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.5.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.5.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.5">subscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.5.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.2.5.2">ℎ</ci><list id="S3.E6.m2.4.4.2.3.cmml" xref="S3.E6.m2.4.4.2.2"><apply id="S3.E6.m2.4.4.2.2.1.cmml" xref="S3.E6.m2.4.4.2.2.1"><minus id="S3.E6.m2.4.4.2.2.1.1.cmml" xref="S3.E6.m2.4.4.2.2.1.1"></minus><ci id="S3.E6.m2.4.4.2.2.1.2.cmml" xref="S3.E6.m2.4.4.2.2.1.2">𝑙</ci><cn type="integer" id="S3.E6.m2.4.4.2.2.1.3.cmml" xref="S3.E6.m2.4.4.2.2.1.3">1</cn></apply><ci id="S3.E6.m2.3.3.1.1a.cmml" xref="S3.E6.m2.3.3.1.1"><mtext mathsize="70%" id="S3.E6.m2.3.3.1.1.cmml" xref="S3.E6.m2.3.3.1.1">sf</mtext></ci></list></apply></apply><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3"><times id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2.2">Π</ci><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3.2">𝑏</ci><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.3.3.3">𝑙</ci></apply></apply><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4"><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.1">¯</ci><apply id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.2">𝑒</ci><ci id="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E6.m2.5.5.1.1.1.1.1.1.1.4.2.3">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m2.5c">\displaystyle:~{}h_{l,\text{sf}}=f_{l}(\Pi_{l}W_{l}\Pi_{l-1}^{T}h_{l-1,\text{sf}}+\Pi_{l}b_{l}+\underline{e_{l}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{\circ}" display="inline"><semantics id="S3.E7.m1.1a"><msub id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mtext id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2a.cmml">PAN</mtext><mo id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml">∘</mo></msub><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.2a.cmml" xref="S3.E7.m1.1.1.2"><mtext id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2">PAN</mtext></ci><compose id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle\text{PAN}_{\circ}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7.m2.5" class="ltx_Math" alttext="\displaystyle:~{}h_{l,\text{sf}}=f_{l}((\Pi_{l}W_{l}\Pi_{l-1}^{T}h_{l-1,\text{sf}}+\Pi_{l}b_{l})\odot\underline{e_{l}})," display="inline"><semantics id="S3.E7.m2.5a"><mrow id="S3.E7.m2.5.5.1" xref="S3.E7.m2.5.5.1.1.cmml"><mrow id="S3.E7.m2.5.5.1.1" xref="S3.E7.m2.5.5.1.1.cmml"><mi id="S3.E7.m2.5.5.1.1.3" xref="S3.E7.m2.5.5.1.1.3.cmml"></mi><mo lspace="0.278em" rspace="0.608em" id="S3.E7.m2.5.5.1.1.2" xref="S3.E7.m2.5.5.1.1.2.cmml">:</mo><mrow id="S3.E7.m2.5.5.1.1.1" xref="S3.E7.m2.5.5.1.1.1.cmml"><msub id="S3.E7.m2.5.5.1.1.1.3" xref="S3.E7.m2.5.5.1.1.1.3.cmml"><mi id="S3.E7.m2.5.5.1.1.1.3.2" xref="S3.E7.m2.5.5.1.1.1.3.2.cmml">h</mi><mrow id="S3.E7.m2.2.2.2.4" xref="S3.E7.m2.2.2.2.3.cmml"><mi id="S3.E7.m2.1.1.1.1" xref="S3.E7.m2.1.1.1.1.cmml">l</mi><mo id="S3.E7.m2.2.2.2.4.1" xref="S3.E7.m2.2.2.2.3.cmml">,</mo><mtext id="S3.E7.m2.2.2.2.2" xref="S3.E7.m2.2.2.2.2a.cmml">sf</mtext></mrow></msub><mo id="S3.E7.m2.5.5.1.1.1.2" xref="S3.E7.m2.5.5.1.1.1.2.cmml">=</mo><mrow id="S3.E7.m2.5.5.1.1.1.1" xref="S3.E7.m2.5.5.1.1.1.1.cmml"><msub id="S3.E7.m2.5.5.1.1.1.1.3" xref="S3.E7.m2.5.5.1.1.1.1.3.cmml"><mi id="S3.E7.m2.5.5.1.1.1.1.3.2" xref="S3.E7.m2.5.5.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E7.m2.5.5.1.1.1.1.3.3" xref="S3.E7.m2.5.5.1.1.1.1.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m2.5.5.1.1.1.1.2" xref="S3.E7.m2.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m2.5.5.1.1.1.1.1.1" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m2.5.5.1.1.1.1.1.1.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m2.5.5.1.1.1.1.1.1.1" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi mathvariant="normal" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">Π</mi><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1a" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.cmml"><mi mathvariant="normal" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.2.cmml">Π</mi><mrow id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.cmml"><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.2.cmml">l</mi><mo id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.1" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.1.cmml">−</mo><mn id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.3.cmml">1</mn></mrow><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1b" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.5" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.5.cmml"><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.5.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.5.2.cmml">h</mi><mrow id="S3.E7.m2.4.4.2.2" xref="S3.E7.m2.4.4.2.3.cmml"><mrow id="S3.E7.m2.4.4.2.2.1" xref="S3.E7.m2.4.4.2.2.1.cmml"><mi id="S3.E7.m2.4.4.2.2.1.2" xref="S3.E7.m2.4.4.2.2.1.2.cmml">l</mi><mo id="S3.E7.m2.4.4.2.2.1.1" xref="S3.E7.m2.4.4.2.2.1.1.cmml">−</mo><mn id="S3.E7.m2.4.4.2.2.1.3" xref="S3.E7.m2.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E7.m2.4.4.2.2.2" xref="S3.E7.m2.4.4.2.3.cmml">,</mo><mtext id="S3.E7.m2.3.3.1.1" xref="S3.E7.m2.3.3.1.1a.cmml">sf</mtext></mrow></msub></mrow><mo id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi mathvariant="normal" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">Π</mi><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">b</mi><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">l</mi></msub></mrow></mrow><mo rspace="0.055em" stretchy="false" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.2.cmml">⊙</mo><munder accentunder="true" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2.2" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2.2.cmml">e</mi><mi id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2.3.cmml">l</mi></msub><mo id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.1" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.1.cmml">¯</mo></munder></mrow><mo stretchy="false" id="S3.E7.m2.5.5.1.1.1.1.1.1.3" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m2.5.5.1.2" xref="S3.E7.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m2.5b"><apply id="S3.E7.m2.5.5.1.1.cmml" xref="S3.E7.m2.5.5.1"><ci id="S3.E7.m2.5.5.1.1.2.cmml" xref="S3.E7.m2.5.5.1.1.2">:</ci><csymbol cd="latexml" id="S3.E7.m2.5.5.1.1.3.cmml" xref="S3.E7.m2.5.5.1.1.3">absent</csymbol><apply id="S3.E7.m2.5.5.1.1.1.cmml" xref="S3.E7.m2.5.5.1.1.1"><eq id="S3.E7.m2.5.5.1.1.1.2.cmml" xref="S3.E7.m2.5.5.1.1.1.2"></eq><apply id="S3.E7.m2.5.5.1.1.1.3.cmml" xref="S3.E7.m2.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.3.1.cmml" xref="S3.E7.m2.5.5.1.1.1.3">subscript</csymbol><ci id="S3.E7.m2.5.5.1.1.1.3.2.cmml" xref="S3.E7.m2.5.5.1.1.1.3.2">ℎ</ci><list id="S3.E7.m2.2.2.2.3.cmml" xref="S3.E7.m2.2.2.2.4"><ci id="S3.E7.m2.1.1.1.1.cmml" xref="S3.E7.m2.1.1.1.1">𝑙</ci><ci id="S3.E7.m2.2.2.2.2a.cmml" xref="S3.E7.m2.2.2.2.2"><mtext mathsize="70%" id="S3.E7.m2.2.2.2.2.cmml" xref="S3.E7.m2.2.2.2.2">sf</mtext></ci></list></apply><apply id="S3.E7.m2.5.5.1.1.1.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1"><times id="S3.E7.m2.5.5.1.1.1.1.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.2"></times><apply id="S3.E7.m2.5.5.1.1.1.1.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.3.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m2.5.5.1.1.1.1.3.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.3.2">𝑓</ci><ci id="S3.E7.m2.5.5.1.1.1.1.3.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1"><plus id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2"><times id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.2">Π</ci><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑙</ci></apply><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑊</ci><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑙</ci></apply><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4">superscript</csymbol><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.2">Π</ci><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3"><minus id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.1"></minus><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.2">𝑙</ci><cn type="integer" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.2.3.3">1</cn></apply></apply><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.4.3">𝑇</ci></apply><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.5.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.5.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.5">subscript</csymbol><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.5.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.5.2">ℎ</ci><list id="S3.E7.m2.4.4.2.3.cmml" xref="S3.E7.m2.4.4.2.2"><apply id="S3.E7.m2.4.4.2.2.1.cmml" xref="S3.E7.m2.4.4.2.2.1"><minus id="S3.E7.m2.4.4.2.2.1.1.cmml" xref="S3.E7.m2.4.4.2.2.1.1"></minus><ci id="S3.E7.m2.4.4.2.2.1.2.cmml" xref="S3.E7.m2.4.4.2.2.1.2">𝑙</ci><cn type="integer" id="S3.E7.m2.4.4.2.2.1.3.cmml" xref="S3.E7.m2.4.4.2.2.1.3">1</cn></apply><ci id="S3.E7.m2.3.3.1.1a.cmml" xref="S3.E7.m2.3.3.1.1"><mtext mathsize="70%" id="S3.E7.m2.3.3.1.1.cmml" xref="S3.E7.m2.3.3.1.1">sf</mtext></ci></list></apply></apply><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2.2">Π</ci><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑏</ci><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑙</ci></apply></apply></apply><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3"><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.1">¯</ci><apply id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2.2">𝑒</ci><ci id="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m2.5.5.1.1.1.1.1.1.1.3.2.3">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m2.5c">\displaystyle:~{}h_{l,\text{sf}}=f_{l}((\Pi_{l}W_{l}\Pi_{l-1}^{T}h_{l-1,\text{sf}}+\Pi_{l}b_{l})\odot\underline{e_{l}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.13" class="ltx_p">where the subscript “<span id="S3.SS2.p1.13.1" class="ltx_text ltx_markedasmath">sf</span>” denotes “shuffled” (or permuted). To measure the output change after shuffling, we define the <span id="S3.SS2.p1.13.2" class="ltx_text ltx_font_italic">shuffle error</span> as:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.5" class="ltx_Math" alttext="\text{Err}(A,T,\{\Pi_{l}\}_{l=0}^{L})=\lVert h_{L,\text{sf}}-h_{L}\rVert/J_{L}," display="block"><semantics id="S3.E8.m1.5a"><mrow id="S3.E8.m1.5.5.1" xref="S3.E8.m1.5.5.1.1.cmml"><mrow id="S3.E8.m1.5.5.1.1" xref="S3.E8.m1.5.5.1.1.cmml"><mrow id="S3.E8.m1.5.5.1.1.1" xref="S3.E8.m1.5.5.1.1.1.cmml"><mtext id="S3.E8.m1.5.5.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.3a.cmml">Err</mtext><mo lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.5.5.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.1.2.cmml">(</mo><mi id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml">A</mi><mo id="S3.E8.m1.5.5.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.2.cmml">,</mo><mi id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml">T</mi><mo id="S3.E8.m1.5.5.1.1.1.1.1.4" xref="S3.E8.m1.5.5.1.1.1.1.2.cmml">,</mo><msubsup id="S3.E8.m1.5.5.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">Π</mi><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E8.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.3.cmml">0</mn></mrow><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3.cmml">L</mi></msubsup><mo stretchy="false" id="S3.E8.m1.5.5.1.1.1.1.1.5" xref="S3.E8.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.1389em" id="S3.E8.m1.5.5.1.1.3" xref="S3.E8.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E8.m1.5.5.1.1.2" xref="S3.E8.m1.5.5.1.1.2.cmml"><mrow id="S3.E8.m1.5.5.1.1.2.1.1" xref="S3.E8.m1.5.5.1.1.2.1.2.cmml"><mo fence="true" lspace="0.1389em" rspace="0em" id="S3.E8.m1.5.5.1.1.2.1.1.2" xref="S3.E8.m1.5.5.1.1.2.1.2.1.cmml">∥</mo><mrow id="S3.E8.m1.5.5.1.1.2.1.1.1" xref="S3.E8.m1.5.5.1.1.2.1.1.1.cmml"><msub id="S3.E8.m1.5.5.1.1.2.1.1.1.2" xref="S3.E8.m1.5.5.1.1.2.1.1.1.2.cmml"><mi id="S3.E8.m1.5.5.1.1.2.1.1.1.2.2" xref="S3.E8.m1.5.5.1.1.2.1.1.1.2.2.cmml">h</mi><mrow id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">L</mi><mo id="S3.E8.m1.2.2.2.4.1" xref="S3.E8.m1.2.2.2.3.cmml">,</mo><mtext id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2a.cmml">sf</mtext></mrow></msub><mo id="S3.E8.m1.5.5.1.1.2.1.1.1.1" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1.cmml">−</mo><msub id="S3.E8.m1.5.5.1.1.2.1.1.1.3" xref="S3.E8.m1.5.5.1.1.2.1.1.1.3.cmml"><mi id="S3.E8.m1.5.5.1.1.2.1.1.1.3.2" xref="S3.E8.m1.5.5.1.1.2.1.1.1.3.2.cmml">h</mi><mi id="S3.E8.m1.5.5.1.1.2.1.1.1.3.3" xref="S3.E8.m1.5.5.1.1.2.1.1.1.3.3.cmml">L</mi></msub></mrow><mo fence="true" lspace="0em" rspace="0em" id="S3.E8.m1.5.5.1.1.2.1.1.3" xref="S3.E8.m1.5.5.1.1.2.1.2.1.cmml">∥</mo></mrow><mo id="S3.E8.m1.5.5.1.1.2.2" xref="S3.E8.m1.5.5.1.1.2.2.cmml">/</mo><msub id="S3.E8.m1.5.5.1.1.2.3" xref="S3.E8.m1.5.5.1.1.2.3.cmml"><mi id="S3.E8.m1.5.5.1.1.2.3.2" xref="S3.E8.m1.5.5.1.1.2.3.2.cmml">J</mi><mi id="S3.E8.m1.5.5.1.1.2.3.3" xref="S3.E8.m1.5.5.1.1.2.3.3.cmml">L</mi></msub></mrow></mrow><mo id="S3.E8.m1.5.5.1.2" xref="S3.E8.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.5b"><apply id="S3.E8.m1.5.5.1.1.cmml" xref="S3.E8.m1.5.5.1"><eq id="S3.E8.m1.5.5.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.3"></eq><apply id="S3.E8.m1.5.5.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1"><times id="S3.E8.m1.5.5.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.2"></times><ci id="S3.E8.m1.5.5.1.1.1.3a.cmml" xref="S3.E8.m1.5.5.1.1.1.3"><mtext id="S3.E8.m1.5.5.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.3">Err</mtext></ci><vector id="S3.E8.m1.5.5.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1"><ci id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3">𝐴</ci><ci id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4">𝑇</ci><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1">subscript</csymbol><set id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1"><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2">Π</ci><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></set><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.3"><eq id="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.1"></eq><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.3.3">0</cn></apply></apply><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3">𝐿</ci></apply></vector></apply><apply id="S3.E8.m1.5.5.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2"><divide id="S3.E8.m1.5.5.1.1.2.2.cmml" xref="S3.E8.m1.5.5.1.1.2.2"></divide><apply id="S3.E8.m1.5.5.1.1.2.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1"><csymbol cd="latexml" id="S3.E8.m1.5.5.1.1.2.1.2.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.2">delimited-∥∥</csymbol><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1"><minus id="S3.E8.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.1"></minus><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.2.1.1.1.2.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.2.1.1.1.2.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.2.2">ℎ</ci><list id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.4"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝐿</ci><ci id="S3.E8.m1.2.2.2.2a.cmml" xref="S3.E8.m1.2.2.2.2"><mtext mathsize="70%" id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">sf</mtext></ci></list></apply><apply id="S3.E8.m1.5.5.1.1.2.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.2.1.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.2.1.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.3.2">ℎ</ci><ci id="S3.E8.m1.5.5.1.1.2.1.1.1.3.3.cmml" xref="S3.E8.m1.5.5.1.1.2.1.1.1.3.3">𝐿</ci></apply></apply></apply><apply id="S3.E8.m1.5.5.1.1.2.3.cmml" xref="S3.E8.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.2.3.1.cmml" xref="S3.E8.m1.5.5.1.1.2.3">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.2.3.2.cmml" xref="S3.E8.m1.5.5.1.1.2.3.2">𝐽</ci><ci id="S3.E8.m1.5.5.1.1.2.3.3.cmml" xref="S3.E8.m1.5.5.1.1.2.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.5c">\text{Err}(A,T,\{\Pi_{l}\}_{l=0}^{L})=\lVert h_{L,\text{sf}}-h_{L}\rVert/J_{L},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.14" class="ltx_p">and this error on MLP0 without considering bias (i.e., <math id="S3.SS2.p1.14.m1.1" class="ltx_Math" alttext="y=v^{T}f(Wx+e)" display="inline"><semantics id="S3.SS2.p1.14.m1.1a"><mrow id="S3.SS2.p1.14.m1.1.1" xref="S3.SS2.p1.14.m1.1.1.cmml"><mi id="S3.SS2.p1.14.m1.1.1.3" xref="S3.SS2.p1.14.m1.1.1.3.cmml">y</mi><mo id="S3.SS2.p1.14.m1.1.1.2" xref="S3.SS2.p1.14.m1.1.1.2.cmml">=</mo><mrow id="S3.SS2.p1.14.m1.1.1.1" xref="S3.SS2.p1.14.m1.1.1.1.cmml"><msup id="S3.SS2.p1.14.m1.1.1.1.3" xref="S3.SS2.p1.14.m1.1.1.1.3.cmml"><mi id="S3.SS2.p1.14.m1.1.1.1.3.2" xref="S3.SS2.p1.14.m1.1.1.1.3.2.cmml">v</mi><mi id="S3.SS2.p1.14.m1.1.1.1.3.3" xref="S3.SS2.p1.14.m1.1.1.1.3.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.14.m1.1.1.1.2" xref="S3.SS2.p1.14.m1.1.1.1.2.cmml">​</mo><mi id="S3.SS2.p1.14.m1.1.1.1.4" xref="S3.SS2.p1.14.m1.1.1.1.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.14.m1.1.1.1.2a" xref="S3.SS2.p1.14.m1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.14.m1.1.1.1.1.1" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.14.m1.1.1.1.1.1.2" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.14.m1.1.1.1.1.1.1" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.cmml"><mrow id="S3.SS2.p1.14.m1.1.1.1.1.1.1.2" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.1" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.3.cmml">x</mi></mrow><mo id="S3.SS2.p1.14.m1.1.1.1.1.1.1.1" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.SS2.p1.14.m1.1.1.1.1.1.1.3" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.3.cmml">e</mi></mrow><mo stretchy="false" id="S3.SS2.p1.14.m1.1.1.1.1.1.3" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m1.1b"><apply id="S3.SS2.p1.14.m1.1.1.cmml" xref="S3.SS2.p1.14.m1.1.1"><eq id="S3.SS2.p1.14.m1.1.1.2.cmml" xref="S3.SS2.p1.14.m1.1.1.2"></eq><ci id="S3.SS2.p1.14.m1.1.1.3.cmml" xref="S3.SS2.p1.14.m1.1.1.3">𝑦</ci><apply id="S3.SS2.p1.14.m1.1.1.1.cmml" xref="S3.SS2.p1.14.m1.1.1.1"><times id="S3.SS2.p1.14.m1.1.1.1.2.cmml" xref="S3.SS2.p1.14.m1.1.1.1.2"></times><apply id="S3.SS2.p1.14.m1.1.1.1.3.cmml" xref="S3.SS2.p1.14.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.14.m1.1.1.1.3.1.cmml" xref="S3.SS2.p1.14.m1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.14.m1.1.1.1.3.2.cmml" xref="S3.SS2.p1.14.m1.1.1.1.3.2">𝑣</ci><ci id="S3.SS2.p1.14.m1.1.1.1.3.3.cmml" xref="S3.SS2.p1.14.m1.1.1.1.3.3">𝑇</ci></apply><ci id="S3.SS2.p1.14.m1.1.1.1.4.cmml" xref="S3.SS2.p1.14.m1.1.1.1.4">𝑓</ci><apply id="S3.SS2.p1.14.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.14.m1.1.1.1.1.1"><plus id="S3.SS2.p1.14.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.1"></plus><apply id="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.2"><times id="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.1"></times><ci id="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.2.3">𝑥</ci></apply><ci id="S3.SS2.p1.14.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.14.m1.1.1.1.1.1.1.3">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m1.1c">y=v^{T}f(Wx+e)</annotation></semantics></math>) is</p>
<table id="A6.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{+}" display="inline"><semantics id="S3.Ex1.m1.1a"><msub id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mtext id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2a.cmml">PAN</mtext><mo id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml">+</mo></msub><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.2a.cmml" xref="S3.Ex1.m1.1.1.2"><mtext id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2">PAN</mtext></ci><plus id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle\text{PAN}_{+}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m2.3" class="ltx_Math" alttext="\displaystyle:~{}\text{Err}(A,T,\Pi)" display="inline"><semantics id="S3.Ex1.m2.3a"><mrow id="S3.Ex1.m2.3.4" xref="S3.Ex1.m2.3.4.cmml"><mi id="S3.Ex1.m2.3.4.2" xref="S3.Ex1.m2.3.4.2.cmml"></mi><mo lspace="0.278em" rspace="0.608em" id="S3.Ex1.m2.3.4.1" xref="S3.Ex1.m2.3.4.1.cmml">:</mo><mrow id="S3.Ex1.m2.3.4.3" xref="S3.Ex1.m2.3.4.3.cmml"><mtext id="S3.Ex1.m2.3.4.3.2" xref="S3.Ex1.m2.3.4.3.2a.cmml">Err</mtext><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.3.4.3.1" xref="S3.Ex1.m2.3.4.3.1.cmml">​</mo><mrow id="S3.Ex1.m2.3.4.3.3.2" xref="S3.Ex1.m2.3.4.3.3.1.cmml"><mo stretchy="false" id="S3.Ex1.m2.3.4.3.3.2.1" xref="S3.Ex1.m2.3.4.3.3.1.cmml">(</mo><mi id="S3.Ex1.m2.1.1" xref="S3.Ex1.m2.1.1.cmml">A</mi><mo id="S3.Ex1.m2.3.4.3.3.2.2" xref="S3.Ex1.m2.3.4.3.3.1.cmml">,</mo><mi id="S3.Ex1.m2.2.2" xref="S3.Ex1.m2.2.2.cmml">T</mi><mo id="S3.Ex1.m2.3.4.3.3.2.3" xref="S3.Ex1.m2.3.4.3.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.Ex1.m2.3.3" xref="S3.Ex1.m2.3.3.cmml">Π</mi><mo stretchy="false" id="S3.Ex1.m2.3.4.3.3.2.4" xref="S3.Ex1.m2.3.4.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.3b"><apply id="S3.Ex1.m2.3.4.cmml" xref="S3.Ex1.m2.3.4"><ci id="S3.Ex1.m2.3.4.1.cmml" xref="S3.Ex1.m2.3.4.1">:</ci><csymbol cd="latexml" id="S3.Ex1.m2.3.4.2.cmml" xref="S3.Ex1.m2.3.4.2">absent</csymbol><apply id="S3.Ex1.m2.3.4.3.cmml" xref="S3.Ex1.m2.3.4.3"><times id="S3.Ex1.m2.3.4.3.1.cmml" xref="S3.Ex1.m2.3.4.3.1"></times><ci id="S3.Ex1.m2.3.4.3.2a.cmml" xref="S3.Ex1.m2.3.4.3.2"><mtext id="S3.Ex1.m2.3.4.3.2.cmml" xref="S3.Ex1.m2.3.4.3.2">Err</mtext></ci><vector id="S3.Ex1.m2.3.4.3.3.1.cmml" xref="S3.Ex1.m2.3.4.3.3.2"><ci id="S3.Ex1.m2.1.1.cmml" xref="S3.Ex1.m2.1.1">𝐴</ci><ci id="S3.Ex1.m2.2.2.cmml" xref="S3.Ex1.m2.2.2">𝑇</ci><ci id="S3.Ex1.m2.3.3.cmml" xref="S3.Ex1.m2.3.3">Π</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.3c">\displaystyle:~{}\text{Err}(A,T,\Pi)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2.m1.1" class="ltx_Math" alttext="\displaystyle=\lvert y_{\text{sf}}-y\rvert" display="inline"><semantics id="S3.Ex2.m1.1a"><mrow id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml"><mi id="S3.Ex2.m1.1.1.3" xref="S3.Ex2.m1.1.1.3.cmml"></mi><mo id="S3.Ex2.m1.1.1.2" xref="S3.Ex2.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex2.m1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex2.m1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.2.1.cmml">|</mo><mrow id="S3.Ex2.m1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.cmml"><msub id="S3.Ex2.m1.1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.2.2" xref="S3.Ex2.m1.1.1.1.1.1.2.2.cmml">y</mi><mtext id="S3.Ex2.m1.1.1.1.1.1.2.3" xref="S3.Ex2.m1.1.1.1.1.1.2.3a.cmml">sf</mtext></msub><mo id="S3.Ex2.m1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.Ex2.m1.1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S3.Ex2.m1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><apply id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1"><eq id="S3.Ex2.m1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.Ex2.m1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.3">absent</csymbol><apply id="S3.Ex2.m1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1"><abs id="S3.Ex2.m1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.2"></abs><apply id="S3.Ex2.m1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1"><minus id="S3.Ex2.m1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1"></minus><apply id="S3.Ex2.m1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.Ex2.m1.1.1.1.1.1.2.3a.cmml" xref="S3.Ex2.m1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.Ex2.m1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.2.3">sf</mtext></ci></apply><ci id="S3.Ex2.m1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.3">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\displaystyle=\lvert y_{\text{sf}}-y\rvert</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex3.m1.1" class="ltx_Math" alttext="\displaystyle=\lvert(\Pi v)^{T}f(\Pi Wx+e)-v^{T}f(Wx+e)\rvert" display="inline"><semantics id="S3.Ex3.m1.1a"><mrow id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.3" xref="S3.Ex3.m1.1.1.3.cmml"></mi><mo id="S3.Ex3.m1.1.1.2" xref="S3.Ex3.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex3.m1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex3.m1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.2.1.cmml">|</mo><mrow id="S3.Ex3.m1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.cmml"><mrow id="S3.Ex3.m1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.2.cmml"><msup id="S3.Ex3.m1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">v</mi></mrow><mo stretchy="false" id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.1.1.1.1.1.2.3" xref="S3.Ex3.m1.1.1.1.1.1.2.3.cmml">​</mo><mi id="S3.Ex3.m1.1.1.1.1.1.2.4" xref="S3.Ex3.m1.1.1.1.1.1.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.1.1.1.1.1.2.3a" xref="S3.Ex3.m1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.2.2.1" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="S3.Ex3.m1.1.1.1.1.1.2.2.1.2" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.cmml"><mrow id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.cmml"><mi mathvariant="normal" id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.2" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.1" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.1.cmml">​</mo><mi id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.3" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.1a" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.1.cmml">​</mo><mi id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.4" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.4.cmml">x</mi></mrow><mo id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.1.cmml">+</mo><mi id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.3.cmml">e</mi></mrow><mo stretchy="false" id="S3.Ex3.m1.1.1.1.1.1.2.2.1.3" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.1.1.1.1.1.4" xref="S3.Ex3.m1.1.1.1.1.1.4.cmml">−</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.3.cmml"><msup id="S3.Ex3.m1.1.1.1.1.1.3.3" xref="S3.Ex3.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.3.3.2" xref="S3.Ex3.m1.1.1.1.1.1.3.3.2.cmml">v</mi><mi id="S3.Ex3.m1.1.1.1.1.1.3.3.3" xref="S3.Ex3.m1.1.1.1.1.1.3.3.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.1.1.1.1.1.3.2" xref="S3.Ex3.m1.1.1.1.1.1.3.2.cmml">​</mo><mi id="S3.Ex3.m1.1.1.1.1.1.3.4" xref="S3.Ex3.m1.1.1.1.1.1.3.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.1.1.1.1.1.3.2a" xref="S3.Ex3.m1.1.1.1.1.1.3.2.cmml">​</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.3.1.1" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S3.Ex3.m1.1.1.1.1.1.3.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.cmml"><mrow id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.2" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.1" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.1.cmml">​</mo><mi id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.3" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.3.cmml">x</mi></mrow><mo id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.1.cmml">+</mo><mi id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.3.cmml">e</mi></mrow><mo stretchy="false" id="S3.Ex3.m1.1.1.1.1.1.3.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex3.m1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><apply id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1"><eq id="S3.Ex3.m1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.Ex3.m1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.3">absent</csymbol><apply id="S3.Ex3.m1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1"><abs id="S3.Ex3.m1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.1.1.1.1.2"></abs><apply id="S3.Ex3.m1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1"><minus id="S3.Ex3.m1.1.1.1.1.1.4.cmml" xref="S3.Ex3.m1.1.1.1.1.1.4"></minus><apply id="S3.Ex3.m1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2"><times id="S3.Ex3.m1.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2.3"></times><apply id="S3.Ex3.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.2">Π</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.3">𝑣</ci></apply><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="S3.Ex3.m1.1.1.1.1.1.2.4.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2.4">𝑓</ci><apply id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1"><plus id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.1"></plus><apply id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2"><times id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.1"></times><ci id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.2">Π</ci><ci id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.3">𝑊</ci><ci id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.4.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.2.4">𝑥</ci></apply><ci id="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2.2.1.1.3">𝑒</ci></apply></apply><apply id="S3.Ex3.m1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3"><times id="S3.Ex3.m1.1.1.1.1.1.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.2"></times><apply id="S3.Ex3.m1.1.1.1.1.1.3.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S3.Ex3.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.3.3">𝑇</ci></apply><ci id="S3.Ex3.m1.1.1.1.1.1.3.4.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.4">𝑓</ci><apply id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1"><plus id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.1"></plus><apply id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2"><times id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.1"></times><ci id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.2">𝑊</ci><ci id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.2.3">𝑥</ci></apply><ci id="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.3.1.1.1.3">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\displaystyle=\lvert(\Pi v)^{T}f(\Pi Wx+e)-v^{T}f(Wx+e)\rvert</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex4.m1.1" class="ltx_Math" alttext="\displaystyle=\lvert(\Pi v)^{T}f(\Pi Wx+e)-(\Pi v)^{T}f(\Pi Wx+\Pi e)\rvert" display="inline"><semantics id="S3.Ex4.m1.1a"><mrow id="S3.Ex4.m1.1.1" xref="S3.Ex4.m1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.3" xref="S3.Ex4.m1.1.1.3.cmml"></mi><mo id="S3.Ex4.m1.1.1.2" xref="S3.Ex4.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex4.m1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.2.1.cmml">|</mo><mrow id="S3.Ex4.m1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.cmml"><mrow id="S3.Ex4.m1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.2.cmml"><msup id="S3.Ex4.m1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">v</mi></mrow><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.1.1.1.1.1.2.3" xref="S3.Ex4.m1.1.1.1.1.1.2.3.cmml">​</mo><mi id="S3.Ex4.m1.1.1.1.1.1.2.4" xref="S3.Ex4.m1.1.1.1.1.1.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.1.1.1.1.1.2.3a" xref="S3.Ex4.m1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.2.2.1" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.1.2.2.1.2" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.cmml"><mrow id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.cmml"><mi mathvariant="normal" id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.2" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.1" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.1.cmml">​</mo><mi id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.3" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.1a" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.1.cmml">​</mo><mi id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.4" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.4.cmml">x</mi></mrow><mo id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.1.cmml">+</mo><mi id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.3.cmml">e</mi></mrow><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.1.2.2.1.3" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex4.m1.1.1.1.1.1.5" xref="S3.Ex4.m1.1.1.1.1.1.5.cmml">−</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.4" xref="S3.Ex4.m1.1.1.1.1.1.4.cmml"><msup id="S3.Ex4.m1.1.1.1.1.1.3.1" xref="S3.Ex4.m1.1.1.1.1.1.3.1.cmml"><mrow id="S3.Ex4.m1.1.1.1.1.1.3.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.1.cmml">​</mo><mi id="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.3.cmml">v</mi></mrow><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.cmml">)</mo></mrow><mi id="S3.Ex4.m1.1.1.1.1.1.3.1.3" xref="S3.Ex4.m1.1.1.1.1.1.3.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.1.1.1.1.1.4.3" xref="S3.Ex4.m1.1.1.1.1.1.4.3.cmml">​</mo><mi id="S3.Ex4.m1.1.1.1.1.1.4.4" xref="S3.Ex4.m1.1.1.1.1.1.4.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.1.1.1.1.1.4.3a" xref="S3.Ex4.m1.1.1.1.1.1.4.3.cmml">​</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.4.2.1" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.cmml"><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.1.4.2.1.2" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.cmml"><mrow id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.cmml"><mi mathvariant="normal" id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.2" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.1" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.1.cmml">​</mo><mi id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.3" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.1a" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.1.cmml">​</mo><mi id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.4" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.4.cmml">x</mi></mrow><mo id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.1.cmml">+</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.cmml"><mi mathvariant="normal" id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.2" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.1" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.1.cmml">​</mo><mi id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.3" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.3.cmml">e</mi></mrow></mrow><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.1.4.2.1.3" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.1b"><apply id="S3.Ex4.m1.1.1.cmml" xref="S3.Ex4.m1.1.1"><eq id="S3.Ex4.m1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.Ex4.m1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.3">absent</csymbol><apply id="S3.Ex4.m1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1"><abs id="S3.Ex4.m1.1.1.1.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.2"></abs><apply id="S3.Ex4.m1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1"><minus id="S3.Ex4.m1.1.1.1.1.1.5.cmml" xref="S3.Ex4.m1.1.1.1.1.1.5"></minus><apply id="S3.Ex4.m1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.2"><times id="S3.Ex4.m1.1.1.1.1.1.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.2.3"></times><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2">Π</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3">𝑣</ci></apply><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="S3.Ex4.m1.1.1.1.1.1.2.4.cmml" xref="S3.Ex4.m1.1.1.1.1.1.2.4">𝑓</ci><apply id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1"><plus id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.1"></plus><apply id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2"><times id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.1"></times><ci id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.2">Π</ci><ci id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.3">𝑊</ci><ci id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.4.cmml" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.2.4">𝑥</ci></apply><ci id="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.2.2.1.1.3">𝑒</ci></apply></apply><apply id="S3.Ex4.m1.1.1.1.1.1.4.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4"><times id="S3.Ex4.m1.1.1.1.1.1.4.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.3"></times><apply id="S3.Ex4.m1.1.1.1.1.1.3.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.3.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.3.1.1.1"><times id="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.1"></times><ci id="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.2">Π</ci><ci id="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.3.1.1.1.1.3">𝑣</ci></apply><ci id="S3.Ex4.m1.1.1.1.1.1.3.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.3.1.3">𝑇</ci></apply><ci id="S3.Ex4.m1.1.1.1.1.1.4.4.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.4">𝑓</ci><apply id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1"><plus id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.1"></plus><apply id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2"><times id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.1"></times><ci id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.2">Π</ci><ci id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.3">𝑊</ci><ci id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.4.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.2.4">𝑥</ci></apply><apply id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3"><times id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.1"></times><ci id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.2">Π</ci><ci id="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.4.2.1.1.3.3">𝑒</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.1c">\displaystyle=\lvert(\Pi v)^{T}f(\Pi Wx+e)-(\Pi v)^{T}f(\Pi Wx+\Pi e)\rvert</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9.m1.1" class="ltx_Math" alttext="\displaystyle\approx\lvert(\Pi e-e)^{T}\frac{\partial{y_{\text{sf}}}}{\partial e}\rvert," display="inline"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml"></mi><mo id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml">≈</mo><mrow id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.cmml"><msup id="S3.E9.m1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">e</mi></mrow><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mstyle displaystyle="true" id="S3.E9.m1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.3.cmml"><mfrac id="S3.E9.m1.1.1.1.1.1.1.1.3a" xref="S3.E9.m1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2.cmml"><mo rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.3.2.1" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2.1.cmml">∂</mo><msub id="S3.E9.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.2.cmml">y</mi><mtext id="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.3" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.3a.cmml">sf</mtext></msub></mrow><mrow id="S3.E9.m1.1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.3.3.cmml"><mo rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.3.3.1" xref="S3.E9.m1.1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.3.3.2.cmml">e</mi></mrow></mfrac></mstyle></mrow><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><approx id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2"></approx><csymbol cd="latexml" id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3">absent</csymbol><apply id="S3.E9.m1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1"><abs id="S3.E9.m1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2"></abs><apply id="S3.E9.m1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.2"></times><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2"><times id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.1"></times><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">Π</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑒</ci></apply><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑒</ci></apply><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3"><divide id="S3.E9.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3"></divide><apply id="S3.E9.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2"><partialdiff id="S3.E9.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2.1"></partialdiff><apply id="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.2">𝑦</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.3a.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.3"><mtext mathsize="70%" id="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.2.2.3">sf</mtext></ci></apply></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.3"><partialdiff id="S3.E9.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="S3.E9.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.3.3.2">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\displaystyle\approx\lvert(\Pi e-e)^{T}\frac{\partial{y_{\text{sf}}}}{\partial e}\rvert,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.26" class="ltx_p">where we take <math id="S3.SS2.p1.15.m1.2" class="ltx_Math" alttext="y_{\text{sf}}=(\Pi v)^{T}f(\Pi Wx+e)" display="inline"><semantics id="S3.SS2.p1.15.m1.2a"><mrow id="S3.SS2.p1.15.m1.2.2" xref="S3.SS2.p1.15.m1.2.2.cmml"><msub id="S3.SS2.p1.15.m1.2.2.4" xref="S3.SS2.p1.15.m1.2.2.4.cmml"><mi id="S3.SS2.p1.15.m1.2.2.4.2" xref="S3.SS2.p1.15.m1.2.2.4.2.cmml">y</mi><mtext id="S3.SS2.p1.15.m1.2.2.4.3" xref="S3.SS2.p1.15.m1.2.2.4.3a.cmml">sf</mtext></msub><mo id="S3.SS2.p1.15.m1.2.2.3" xref="S3.SS2.p1.15.m1.2.2.3.cmml">=</mo><mrow id="S3.SS2.p1.15.m1.2.2.2" xref="S3.SS2.p1.15.m1.2.2.2.cmml"><msup id="S3.SS2.p1.15.m1.1.1.1.1" xref="S3.SS2.p1.15.m1.1.1.1.1.cmml"><mrow id="S3.SS2.p1.15.m1.1.1.1.1.1.1" xref="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.15.m1.1.1.1.1.1.1.2" xref="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.15.m1.1.1.1.1.1.1.1" xref="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.3.cmml">v</mi></mrow><mo stretchy="false" id="S3.SS2.p1.15.m1.1.1.1.1.1.1.3" xref="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS2.p1.15.m1.1.1.1.1.3" xref="S3.SS2.p1.15.m1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.15.m1.2.2.2.3" xref="S3.SS2.p1.15.m1.2.2.2.3.cmml">​</mo><mi id="S3.SS2.p1.15.m1.2.2.2.4" xref="S3.SS2.p1.15.m1.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.15.m1.2.2.2.3a" xref="S3.SS2.p1.15.m1.2.2.2.3.cmml">​</mo><mrow id="S3.SS2.p1.15.m1.2.2.2.2.1" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.15.m1.2.2.2.2.1.2" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS2.p1.15.m1.2.2.2.2.1.1" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.cmml"><mrow id="S3.SS2.p1.15.m1.2.2.2.2.1.1.2" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.2" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.1" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.3" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.1a" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.4" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.4.cmml">x</mi></mrow><mo id="S3.SS2.p1.15.m1.2.2.2.2.1.1.1" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.1.cmml">+</mo><mi id="S3.SS2.p1.15.m1.2.2.2.2.1.1.3" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.3.cmml">e</mi></mrow><mo stretchy="false" id="S3.SS2.p1.15.m1.2.2.2.2.1.3" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m1.2b"><apply id="S3.SS2.p1.15.m1.2.2.cmml" xref="S3.SS2.p1.15.m1.2.2"><eq id="S3.SS2.p1.15.m1.2.2.3.cmml" xref="S3.SS2.p1.15.m1.2.2.3"></eq><apply id="S3.SS2.p1.15.m1.2.2.4.cmml" xref="S3.SS2.p1.15.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m1.2.2.4.1.cmml" xref="S3.SS2.p1.15.m1.2.2.4">subscript</csymbol><ci id="S3.SS2.p1.15.m1.2.2.4.2.cmml" xref="S3.SS2.p1.15.m1.2.2.4.2">𝑦</ci><ci id="S3.SS2.p1.15.m1.2.2.4.3a.cmml" xref="S3.SS2.p1.15.m1.2.2.4.3"><mtext mathsize="70%" id="S3.SS2.p1.15.m1.2.2.4.3.cmml" xref="S3.SS2.p1.15.m1.2.2.4.3">sf</mtext></ci></apply><apply id="S3.SS2.p1.15.m1.2.2.2.cmml" xref="S3.SS2.p1.15.m1.2.2.2"><times id="S3.SS2.p1.15.m1.2.2.2.3.cmml" xref="S3.SS2.p1.15.m1.2.2.2.3"></times><apply id="S3.SS2.p1.15.m1.1.1.1.1.cmml" xref="S3.SS2.p1.15.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m1.1.1.1.1.2.cmml" xref="S3.SS2.p1.15.m1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.15.m1.1.1.1.1.1.1"><times id="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.1"></times><ci id="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.2">Π</ci><ci id="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.15.m1.1.1.1.1.1.1.1.3">𝑣</ci></apply><ci id="S3.SS2.p1.15.m1.1.1.1.1.3.cmml" xref="S3.SS2.p1.15.m1.1.1.1.1.3">𝑇</ci></apply><ci id="S3.SS2.p1.15.m1.2.2.2.4.cmml" xref="S3.SS2.p1.15.m1.2.2.2.4">𝑓</ci><apply id="S3.SS2.p1.15.m1.2.2.2.2.1.1.cmml" xref="S3.SS2.p1.15.m1.2.2.2.2.1"><plus id="S3.SS2.p1.15.m1.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.1"></plus><apply id="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.cmml" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.2"><times id="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.1"></times><ci id="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.2">Π</ci><ci id="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.3">𝑊</ci><ci id="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.4.cmml" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.2.4">𝑥</ci></apply><ci id="S3.SS2.p1.15.m1.2.2.2.2.1.1.3.cmml" xref="S3.SS2.p1.15.m1.2.2.2.2.1.1.3">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m1.2c">y_{\text{sf}}=(\Pi v)^{T}f(\Pi Wx+e)</annotation></semantics></math> as the function of <math id="S3.SS2.p1.16.m2.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS2.p1.16.m2.1a"><mi id="S3.SS2.p1.16.m2.1.1" xref="S3.SS2.p1.16.m2.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m2.1b"><ci id="S3.SS2.p1.16.m2.1.1.cmml" xref="S3.SS2.p1.16.m2.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m2.1c">e</annotation></semantics></math> and take Taylor expansion as an approximation. Obviously, shuffle error is closely related to the strength of permutation, i.e., <math id="S3.SS2.p1.17.m3.1" class="ltx_Math" alttext="\Pi-I" display="inline"><semantics id="S3.SS2.p1.17.m3.1a"><mrow id="S3.SS2.p1.17.m3.1.1" xref="S3.SS2.p1.17.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.17.m3.1.1.2" xref="S3.SS2.p1.17.m3.1.1.2.cmml">Π</mi><mo id="S3.SS2.p1.17.m3.1.1.1" xref="S3.SS2.p1.17.m3.1.1.1.cmml">−</mo><mi id="S3.SS2.p1.17.m3.1.1.3" xref="S3.SS2.p1.17.m3.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m3.1b"><apply id="S3.SS2.p1.17.m3.1.1.cmml" xref="S3.SS2.p1.17.m3.1.1"><minus id="S3.SS2.p1.17.m3.1.1.1.cmml" xref="S3.SS2.p1.17.m3.1.1.1"></minus><ci id="S3.SS2.p1.17.m3.1.1.2.cmml" xref="S3.SS2.p1.17.m3.1.1.2">Π</ci><ci id="S3.SS2.p1.17.m3.1.1.3.cmml" xref="S3.SS2.p1.17.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m3.1c">\Pi-I</annotation></semantics></math>. For example, if <math id="S3.SS2.p1.18.m4.1" class="ltx_Math" alttext="\Pi=I" display="inline"><semantics id="S3.SS2.p1.18.m4.1a"><mrow id="S3.SS2.p1.18.m4.1.1" xref="S3.SS2.p1.18.m4.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.18.m4.1.1.2" xref="S3.SS2.p1.18.m4.1.1.2.cmml">Π</mi><mo id="S3.SS2.p1.18.m4.1.1.1" xref="S3.SS2.p1.18.m4.1.1.1.cmml">=</mo><mi id="S3.SS2.p1.18.m4.1.1.3" xref="S3.SS2.p1.18.m4.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.18.m4.1b"><apply id="S3.SS2.p1.18.m4.1.1.cmml" xref="S3.SS2.p1.18.m4.1.1"><eq id="S3.SS2.p1.18.m4.1.1.1.cmml" xref="S3.SS2.p1.18.m4.1.1.1"></eq><ci id="S3.SS2.p1.18.m4.1.1.2.cmml" xref="S3.SS2.p1.18.m4.1.1.2">Π</ci><ci id="S3.SS2.p1.18.m4.1.1.3.cmml" xref="S3.SS2.p1.18.m4.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.18.m4.1c">\Pi=I</annotation></semantics></math>, the network is not shuffled and the outputs are kept unchanged. Then, if we take equal values as position encodings, i.e., <math id="S3.SS2.p1.19.m5.3" class="ltx_Math" alttext="e_{j}=e_{i},\forall i,j" display="inline"><semantics id="S3.SS2.p1.19.m5.3a"><mrow id="S3.SS2.p1.19.m5.3.3" xref="S3.SS2.p1.19.m5.3.3.cmml"><msub id="S3.SS2.p1.19.m5.3.3.4" xref="S3.SS2.p1.19.m5.3.3.4.cmml"><mi id="S3.SS2.p1.19.m5.3.3.4.2" xref="S3.SS2.p1.19.m5.3.3.4.2.cmml">e</mi><mi id="S3.SS2.p1.19.m5.3.3.4.3" xref="S3.SS2.p1.19.m5.3.3.4.3.cmml">j</mi></msub><mo id="S3.SS2.p1.19.m5.3.3.3" xref="S3.SS2.p1.19.m5.3.3.3.cmml">=</mo><mrow id="S3.SS2.p1.19.m5.3.3.2.2" xref="S3.SS2.p1.19.m5.3.3.2.3.cmml"><msub id="S3.SS2.p1.19.m5.2.2.1.1.1" xref="S3.SS2.p1.19.m5.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.19.m5.2.2.1.1.1.2" xref="S3.SS2.p1.19.m5.2.2.1.1.1.2.cmml">e</mi><mi id="S3.SS2.p1.19.m5.2.2.1.1.1.3" xref="S3.SS2.p1.19.m5.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p1.19.m5.3.3.2.2.3" xref="S3.SS2.p1.19.m5.3.3.2.3.cmml">,</mo><mrow id="S3.SS2.p1.19.m5.3.3.2.2.2" xref="S3.SS2.p1.19.m5.3.3.2.2.2.cmml"><mo rspace="0.167em" id="S3.SS2.p1.19.m5.3.3.2.2.2.1" xref="S3.SS2.p1.19.m5.3.3.2.2.2.1.cmml">∀</mo><mi id="S3.SS2.p1.19.m5.3.3.2.2.2.2" xref="S3.SS2.p1.19.m5.3.3.2.2.2.2.cmml">i</mi></mrow><mo id="S3.SS2.p1.19.m5.3.3.2.2.4" xref="S3.SS2.p1.19.m5.3.3.2.3.cmml">,</mo><mi id="S3.SS2.p1.19.m5.1.1" xref="S3.SS2.p1.19.m5.1.1.cmml">j</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.19.m5.3b"><apply id="S3.SS2.p1.19.m5.3.3.cmml" xref="S3.SS2.p1.19.m5.3.3"><eq id="S3.SS2.p1.19.m5.3.3.3.cmml" xref="S3.SS2.p1.19.m5.3.3.3"></eq><apply id="S3.SS2.p1.19.m5.3.3.4.cmml" xref="S3.SS2.p1.19.m5.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p1.19.m5.3.3.4.1.cmml" xref="S3.SS2.p1.19.m5.3.3.4">subscript</csymbol><ci id="S3.SS2.p1.19.m5.3.3.4.2.cmml" xref="S3.SS2.p1.19.m5.3.3.4.2">𝑒</ci><ci id="S3.SS2.p1.19.m5.3.3.4.3.cmml" xref="S3.SS2.p1.19.m5.3.3.4.3">𝑗</ci></apply><list id="S3.SS2.p1.19.m5.3.3.2.3.cmml" xref="S3.SS2.p1.19.m5.3.3.2.2"><apply id="S3.SS2.p1.19.m5.2.2.1.1.1.cmml" xref="S3.SS2.p1.19.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.19.m5.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.19.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.19.m5.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.19.m5.2.2.1.1.1.2">𝑒</ci><ci id="S3.SS2.p1.19.m5.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.19.m5.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p1.19.m5.3.3.2.2.2.cmml" xref="S3.SS2.p1.19.m5.3.3.2.2.2"><csymbol cd="latexml" id="S3.SS2.p1.19.m5.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.19.m5.3.3.2.2.2.1">for-all</csymbol><ci id="S3.SS2.p1.19.m5.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.19.m5.3.3.2.2.2.2">𝑖</ci></apply><ci id="S3.SS2.p1.19.m5.1.1.cmml" xref="S3.SS2.p1.19.m5.1.1">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.19.m5.3c">e_{j}=e_{i},\forall i,j</annotation></semantics></math>, the output also does not change because <math id="S3.SS2.p1.20.m6.1" class="ltx_Math" alttext="\Pi e=e" display="inline"><semantics id="S3.SS2.p1.20.m6.1a"><mrow id="S3.SS2.p1.20.m6.1.1" xref="S3.SS2.p1.20.m6.1.1.cmml"><mrow id="S3.SS2.p1.20.m6.1.1.2" xref="S3.SS2.p1.20.m6.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS2.p1.20.m6.1.1.2.2" xref="S3.SS2.p1.20.m6.1.1.2.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.20.m6.1.1.2.1" xref="S3.SS2.p1.20.m6.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p1.20.m6.1.1.2.3" xref="S3.SS2.p1.20.m6.1.1.2.3.cmml">e</mi></mrow><mo id="S3.SS2.p1.20.m6.1.1.1" xref="S3.SS2.p1.20.m6.1.1.1.cmml">=</mo><mi id="S3.SS2.p1.20.m6.1.1.3" xref="S3.SS2.p1.20.m6.1.1.3.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.20.m6.1b"><apply id="S3.SS2.p1.20.m6.1.1.cmml" xref="S3.SS2.p1.20.m6.1.1"><eq id="S3.SS2.p1.20.m6.1.1.1.cmml" xref="S3.SS2.p1.20.m6.1.1.1"></eq><apply id="S3.SS2.p1.20.m6.1.1.2.cmml" xref="S3.SS2.p1.20.m6.1.1.2"><times id="S3.SS2.p1.20.m6.1.1.2.1.cmml" xref="S3.SS2.p1.20.m6.1.1.2.1"></times><ci id="S3.SS2.p1.20.m6.1.1.2.2.cmml" xref="S3.SS2.p1.20.m6.1.1.2.2">Π</ci><ci id="S3.SS2.p1.20.m6.1.1.2.3.cmml" xref="S3.SS2.p1.20.m6.1.1.2.3">𝑒</ci></apply><ci id="S3.SS2.p1.20.m6.1.1.3.cmml" xref="S3.SS2.p1.20.m6.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.20.m6.1c">\Pi e=e</annotation></semantics></math>. This can be obtained via taking <math id="S3.SS2.p1.21.m7.1" class="ltx_Math" alttext="\alpha=0" display="inline"><semantics id="S3.SS2.p1.21.m7.1a"><mrow id="S3.SS2.p1.21.m7.1.1" xref="S3.SS2.p1.21.m7.1.1.cmml"><mi id="S3.SS2.p1.21.m7.1.1.2" xref="S3.SS2.p1.21.m7.1.1.2.cmml">α</mi><mo id="S3.SS2.p1.21.m7.1.1.1" xref="S3.SS2.p1.21.m7.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.21.m7.1.1.3" xref="S3.SS2.p1.21.m7.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.21.m7.1b"><apply id="S3.SS2.p1.21.m7.1.1.cmml" xref="S3.SS2.p1.21.m7.1.1"><eq id="S3.SS2.p1.21.m7.1.1.1.cmml" xref="S3.SS2.p1.21.m7.1.1.1"></eq><ci id="S3.SS2.p1.21.m7.1.1.2.cmml" xref="S3.SS2.p1.21.m7.1.1.2">𝛼</ci><cn type="integer" id="S3.SS2.p1.21.m7.1.1.3.cmml" xref="S3.SS2.p1.21.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.21.m7.1c">\alpha=0</annotation></semantics></math> or <math id="S3.SS2.p1.22.m8.1" class="ltx_Math" alttext="T\rightarrow 0" display="inline"><semantics id="S3.SS2.p1.22.m8.1a"><mrow id="S3.SS2.p1.22.m8.1.1" xref="S3.SS2.p1.22.m8.1.1.cmml"><mi id="S3.SS2.p1.22.m8.1.1.2" xref="S3.SS2.p1.22.m8.1.1.2.cmml">T</mi><mo stretchy="false" id="S3.SS2.p1.22.m8.1.1.1" xref="S3.SS2.p1.22.m8.1.1.1.cmml">→</mo><mn id="S3.SS2.p1.22.m8.1.1.3" xref="S3.SS2.p1.22.m8.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.22.m8.1b"><apply id="S3.SS2.p1.22.m8.1.1.cmml" xref="S3.SS2.p1.22.m8.1.1"><ci id="S3.SS2.p1.22.m8.1.1.1.cmml" xref="S3.SS2.p1.22.m8.1.1.1">→</ci><ci id="S3.SS2.p1.22.m8.1.1.2.cmml" xref="S3.SS2.p1.22.m8.1.1.2">𝑇</ci><cn type="integer" id="S3.SS2.p1.22.m8.1.1.3.cmml" xref="S3.SS2.p1.22.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.22.m8.1c">T\rightarrow 0</annotation></semantics></math>. If we take a larger <math id="S3.SS2.p1.23.m9.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p1.23.m9.1a"><mi id="S3.SS2.p1.23.m9.1.1" xref="S3.SS2.p1.23.m9.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.23.m9.1b"><ci id="S3.SS2.p1.23.m9.1.1.cmml" xref="S3.SS2.p1.23.m9.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.23.m9.1c">T</annotation></semantics></math> (e.g., 1) and larger <math id="S3.SS2.p1.24.m10.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p1.24.m10.1a"><mi id="S3.SS2.p1.24.m10.1.1" xref="S3.SS2.p1.24.m10.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.24.m10.1b"><ci id="S3.SS2.p1.24.m10.1.1.cmml" xref="S3.SS2.p1.24.m10.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.24.m10.1c">\alpha</annotation></semantics></math> (e.g., 0.05), <span id="S3.SS2.p1.26.1" class="ltx_text ltx_markedasmath">Err</span> is generally non-zero because <math id="S3.SS2.p1.26.m12.1" class="ltx_Math" alttext="\Pi e\neq e" display="inline"><semantics id="S3.SS2.p1.26.m12.1a"><mrow id="S3.SS2.p1.26.m12.1.1" xref="S3.SS2.p1.26.m12.1.1.cmml"><mrow id="S3.SS2.p1.26.m12.1.1.2" xref="S3.SS2.p1.26.m12.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS2.p1.26.m12.1.1.2.2" xref="S3.SS2.p1.26.m12.1.1.2.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.26.m12.1.1.2.1" xref="S3.SS2.p1.26.m12.1.1.2.1.cmml">​</mo><mi id="S3.SS2.p1.26.m12.1.1.2.3" xref="S3.SS2.p1.26.m12.1.1.2.3.cmml">e</mi></mrow><mo id="S3.SS2.p1.26.m12.1.1.1" xref="S3.SS2.p1.26.m12.1.1.1.cmml">≠</mo><mi id="S3.SS2.p1.26.m12.1.1.3" xref="S3.SS2.p1.26.m12.1.1.3.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.26.m12.1b"><apply id="S3.SS2.p1.26.m12.1.1.cmml" xref="S3.SS2.p1.26.m12.1.1"><neq id="S3.SS2.p1.26.m12.1.1.1.cmml" xref="S3.SS2.p1.26.m12.1.1.1"></neq><apply id="S3.SS2.p1.26.m12.1.1.2.cmml" xref="S3.SS2.p1.26.m12.1.1.2"><times id="S3.SS2.p1.26.m12.1.1.2.1.cmml" xref="S3.SS2.p1.26.m12.1.1.2.1"></times><ci id="S3.SS2.p1.26.m12.1.1.2.2.cmml" xref="S3.SS2.p1.26.m12.1.1.2.2">Π</ci><ci id="S3.SS2.p1.26.m12.1.1.2.3.cmml" xref="S3.SS2.p1.26.m12.1.1.2.3">𝑒</ci></apply><ci id="S3.SS2.p1.26.m12.1.1.3.cmml" xref="S3.SS2.p1.26.m12.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.26.m12.1c">\Pi e\neq e</annotation></semantics></math>. The error of multiplicative PANs is similar. <span id="S3.SS2.p1.26.2" class="ltx_text ltx_font_italic">We abstract PANs as a switch: if we take equal/varied position encodings, PANs are turned off/on, and hence the network keeps/loses the permutation invariance property (i.e., the same/different outputs after permutation)</span>. As illustrated at the left of Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the five neurons of a certain hidden layer are shuffled while the position encodings they are going to add/multiply are not shuffled, and the outputs will change with PANs turned on.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.4" class="ltx_p">Furthermore, are there any essential differences between additive and multiplicative PANs, and how much influence do they have on the shuffle error? In Eq. <a href="#S3.E9" title="Equation 9 ‣ 3.2 Position-Aware Neurons ‣ 3 Position-Aware Neurons ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, the shuffle error is partially determined by <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\partial{y_{\text{sf}}}/\partial{e}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mo rspace="0em" id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml">∂</mo><mrow id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml"><msub id="S3.SS2.p2.1.m1.1.1.2.2" xref="S3.SS2.p2.1.m1.1.1.2.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2.2.2" xref="S3.SS2.p2.1.m1.1.1.2.2.2.cmml">y</mi><mtext id="S3.SS2.p2.1.m1.1.1.2.2.3" xref="S3.SS2.p2.1.m1.1.1.2.2.3a.cmml">sf</mtext></msub><mo id="S3.SS2.p2.1.m1.1.1.2.1" xref="S3.SS2.p2.1.m1.1.1.2.1.cmml">/</mo><mrow id="S3.SS2.p2.1.m1.1.1.2.3" xref="S3.SS2.p2.1.m1.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.1.1.2.3.1" xref="S3.SS2.p2.1.m1.1.1.2.3.1.cmml">∂</mo><mi id="S3.SS2.p2.1.m1.1.1.2.3.2" xref="S3.SS2.p2.1.m1.1.1.2.3.2.cmml">e</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><partialdiff id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1"></partialdiff><apply id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2"><divide id="S3.SS2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.2.1"></divide><apply id="S3.SS2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.2.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2.2.2">𝑦</ci><ci id="S3.SS2.p2.1.m1.1.1.2.2.3a.cmml" xref="S3.SS2.p2.1.m1.1.1.2.2.3"><mtext mathsize="70%" id="S3.SS2.p2.1.m1.1.1.2.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.2.2.3">sf</mtext></ci></apply><apply id="S3.SS2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.2.3"><partialdiff id="S3.SS2.p2.1.m1.1.1.2.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.2.3.1"></partialdiff><ci id="S3.SS2.p2.1.m1.1.1.2.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2.3.2">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\partial{y_{\text{sf}}}/\partial{e}</annotation></semantics></math>, and we extent this gradient to MLP with multiple layers. We assume all layers have the same number of neurons (i.e., <math id="S3.SS2.p2.2.m2.2" class="ltx_Math" alttext="J_{l}=J,\forall l" display="inline"><semantics id="S3.SS2.p2.2.m2.2a"><mrow id="S3.SS2.p2.2.m2.2.2" xref="S3.SS2.p2.2.m2.2.2.cmml"><msub id="S3.SS2.p2.2.m2.2.2.3" xref="S3.SS2.p2.2.m2.2.2.3.cmml"><mi id="S3.SS2.p2.2.m2.2.2.3.2" xref="S3.SS2.p2.2.m2.2.2.3.2.cmml">J</mi><mi id="S3.SS2.p2.2.m2.2.2.3.3" xref="S3.SS2.p2.2.m2.2.2.3.3.cmml">l</mi></msub><mo id="S3.SS2.p2.2.m2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.cmml">=</mo><mrow id="S3.SS2.p2.2.m2.2.2.1.1" xref="S3.SS2.p2.2.m2.2.2.1.2.cmml"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">J</mi><mo id="S3.SS2.p2.2.m2.2.2.1.1.2" xref="S3.SS2.p2.2.m2.2.2.1.2.cmml">,</mo><mrow id="S3.SS2.p2.2.m2.2.2.1.1.1" xref="S3.SS2.p2.2.m2.2.2.1.1.1.cmml"><mo rspace="0.167em" id="S3.SS2.p2.2.m2.2.2.1.1.1.1" xref="S3.SS2.p2.2.m2.2.2.1.1.1.1.cmml">∀</mo><mi id="S3.SS2.p2.2.m2.2.2.1.1.1.2" xref="S3.SS2.p2.2.m2.2.2.1.1.1.2.cmml">l</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.2b"><apply id="S3.SS2.p2.2.m2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2"><eq id="S3.SS2.p2.2.m2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2"></eq><apply id="S3.SS2.p2.2.m2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.3.1.cmml" xref="S3.SS2.p2.2.m2.2.2.3">subscript</csymbol><ci id="S3.SS2.p2.2.m2.2.2.3.2.cmml" xref="S3.SS2.p2.2.m2.2.2.3.2">𝐽</ci><ci id="S3.SS2.p2.2.m2.2.2.3.3.cmml" xref="S3.SS2.p2.2.m2.2.2.3.3">𝑙</ci></apply><list id="S3.SS2.p2.2.m2.2.2.1.2.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝐽</ci><apply id="S3.SS2.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.1.1">for-all</csymbol><ci id="S3.SS2.p2.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.1.2">𝑙</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.2c">J_{l}=J,\forall l</annotation></semantics></math>) and take the same position encodings (i.e., <math id="S3.SS2.p2.3.m3.2" class="ltx_Math" alttext="e_{l}=e\in\mathcal{R}^{J},\forall l" display="inline"><semantics id="S3.SS2.p2.3.m3.2a"><mrow id="S3.SS2.p2.3.m3.2.2.2" xref="S3.SS2.p2.3.m3.2.2.3.cmml"><mrow id="S3.SS2.p2.3.m3.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.cmml"><msub id="S3.SS2.p2.3.m3.1.1.1.1.2" xref="S3.SS2.p2.3.m3.1.1.1.1.2.cmml"><mi id="S3.SS2.p2.3.m3.1.1.1.1.2.2" xref="S3.SS2.p2.3.m3.1.1.1.1.2.2.cmml">e</mi><mi id="S3.SS2.p2.3.m3.1.1.1.1.2.3" xref="S3.SS2.p2.3.m3.1.1.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS2.p2.3.m3.1.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.1.3.cmml">=</mo><mi id="S3.SS2.p2.3.m3.1.1.1.1.4" xref="S3.SS2.p2.3.m3.1.1.1.1.4.cmml">e</mi><mo id="S3.SS2.p2.3.m3.1.1.1.1.5" xref="S3.SS2.p2.3.m3.1.1.1.1.5.cmml">∈</mo><msup id="S3.SS2.p2.3.m3.1.1.1.1.6" xref="S3.SS2.p2.3.m3.1.1.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.3.m3.1.1.1.1.6.2" xref="S3.SS2.p2.3.m3.1.1.1.1.6.2.cmml">ℛ</mi><mi id="S3.SS2.p2.3.m3.1.1.1.1.6.3" xref="S3.SS2.p2.3.m3.1.1.1.1.6.3.cmml">J</mi></msup></mrow><mo id="S3.SS2.p2.3.m3.2.2.2.3" xref="S3.SS2.p2.3.m3.2.2.3a.cmml">,</mo><mrow id="S3.SS2.p2.3.m3.2.2.2.2" xref="S3.SS2.p2.3.m3.2.2.2.2.cmml"><mo rspace="0.167em" id="S3.SS2.p2.3.m3.2.2.2.2.1" xref="S3.SS2.p2.3.m3.2.2.2.2.1.cmml">∀</mo><mi id="S3.SS2.p2.3.m3.2.2.2.2.2" xref="S3.SS2.p2.3.m3.2.2.2.2.2.cmml">l</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.2b"><apply id="S3.SS2.p2.3.m3.2.2.3.cmml" xref="S3.SS2.p2.3.m3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.2.2.3a.cmml" xref="S3.SS2.p2.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS2.p2.3.m3.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1"><and id="S3.SS2.p2.3.m3.1.1.1.1a.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1"></and><apply id="S3.SS2.p2.3.m3.1.1.1.1b.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1"><eq id="S3.SS2.p2.3.m3.1.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.3"></eq><apply id="S3.SS2.p2.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.2.2">𝑒</ci><ci id="S3.SS2.p2.3.m3.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.3.m3.1.1.1.1.4.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.4">𝑒</ci></apply><apply id="S3.SS2.p2.3.m3.1.1.1.1c.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1"><in id="S3.SS2.p2.3.m3.1.1.1.1.5.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.5"></in><share href="#S3.SS2.p2.3.m3.1.1.1.1.4.cmml" id="S3.SS2.p2.3.m3.1.1.1.1d.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1"></share><apply id="S3.SS2.p2.3.m3.1.1.1.1.6.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.1.6.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.6">superscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.1.1.6.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.6.2">ℛ</ci><ci id="S3.SS2.p2.3.m3.1.1.1.1.6.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.6.3">𝐽</ci></apply></apply></apply><apply id="S3.SS2.p2.3.m3.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2"><csymbol cd="latexml" id="S3.SS2.p2.3.m3.2.2.2.2.1.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.1">for-all</csymbol><ci id="S3.SS2.p2.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2.2.2.2">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.2c">e_{l}=e\in\mathcal{R}^{J},\forall l</annotation></semantics></math>). We denote <math id="S3.SS2.p2.4.m4.4" class="ltx_Math" alttext="s_{l,\text{sf}}=\Pi_{l}W_{l}\Pi_{l-1}^{T}h_{l-1,\text{sf}}+\Pi_{l}b_{l}" display="inline"><semantics id="S3.SS2.p2.4.m4.4a"><mrow id="S3.SS2.p2.4.m4.4.5" xref="S3.SS2.p2.4.m4.4.5.cmml"><msub id="S3.SS2.p2.4.m4.4.5.2" xref="S3.SS2.p2.4.m4.4.5.2.cmml"><mi id="S3.SS2.p2.4.m4.4.5.2.2" xref="S3.SS2.p2.4.m4.4.5.2.2.cmml">s</mi><mrow id="S3.SS2.p2.4.m4.2.2.2.4" xref="S3.SS2.p2.4.m4.2.2.2.3.cmml"><mi id="S3.SS2.p2.4.m4.1.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.cmml">l</mi><mo id="S3.SS2.p2.4.m4.2.2.2.4.1" xref="S3.SS2.p2.4.m4.2.2.2.3.cmml">,</mo><mtext id="S3.SS2.p2.4.m4.2.2.2.2" xref="S3.SS2.p2.4.m4.2.2.2.2a.cmml">sf</mtext></mrow></msub><mo id="S3.SS2.p2.4.m4.4.5.1" xref="S3.SS2.p2.4.m4.4.5.1.cmml">=</mo><mrow id="S3.SS2.p2.4.m4.4.5.3" xref="S3.SS2.p2.4.m4.4.5.3.cmml"><mrow id="S3.SS2.p2.4.m4.4.5.3.2" xref="S3.SS2.p2.4.m4.4.5.3.2.cmml"><msub id="S3.SS2.p2.4.m4.4.5.3.2.2" xref="S3.SS2.p2.4.m4.4.5.3.2.2.cmml"><mi mathvariant="normal" id="S3.SS2.p2.4.m4.4.5.3.2.2.2" xref="S3.SS2.p2.4.m4.4.5.3.2.2.2.cmml">Π</mi><mi id="S3.SS2.p2.4.m4.4.5.3.2.2.3" xref="S3.SS2.p2.4.m4.4.5.3.2.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.4.m4.4.5.3.2.1" xref="S3.SS2.p2.4.m4.4.5.3.2.1.cmml">​</mo><msub id="S3.SS2.p2.4.m4.4.5.3.2.3" xref="S3.SS2.p2.4.m4.4.5.3.2.3.cmml"><mi id="S3.SS2.p2.4.m4.4.5.3.2.3.2" xref="S3.SS2.p2.4.m4.4.5.3.2.3.2.cmml">W</mi><mi id="S3.SS2.p2.4.m4.4.5.3.2.3.3" xref="S3.SS2.p2.4.m4.4.5.3.2.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.4.m4.4.5.3.2.1a" xref="S3.SS2.p2.4.m4.4.5.3.2.1.cmml">​</mo><msubsup id="S3.SS2.p2.4.m4.4.5.3.2.4" xref="S3.SS2.p2.4.m4.4.5.3.2.4.cmml"><mi mathvariant="normal" id="S3.SS2.p2.4.m4.4.5.3.2.4.2.2" xref="S3.SS2.p2.4.m4.4.5.3.2.4.2.2.cmml">Π</mi><mrow id="S3.SS2.p2.4.m4.4.5.3.2.4.2.3" xref="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.cmml"><mi id="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.2" xref="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.2.cmml">l</mi><mo id="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.1" xref="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.1.cmml">−</mo><mn id="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.3" xref="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p2.4.m4.4.5.3.2.4.3" xref="S3.SS2.p2.4.m4.4.5.3.2.4.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p2.4.m4.4.5.3.2.1b" xref="S3.SS2.p2.4.m4.4.5.3.2.1.cmml">​</mo><msub id="S3.SS2.p2.4.m4.4.5.3.2.5" xref="S3.SS2.p2.4.m4.4.5.3.2.5.cmml"><mi id="S3.SS2.p2.4.m4.4.5.3.2.5.2" xref="S3.SS2.p2.4.m4.4.5.3.2.5.2.cmml">h</mi><mrow id="S3.SS2.p2.4.m4.4.4.2.2" xref="S3.SS2.p2.4.m4.4.4.2.3.cmml"><mrow id="S3.SS2.p2.4.m4.4.4.2.2.1" xref="S3.SS2.p2.4.m4.4.4.2.2.1.cmml"><mi id="S3.SS2.p2.4.m4.4.4.2.2.1.2" xref="S3.SS2.p2.4.m4.4.4.2.2.1.2.cmml">l</mi><mo id="S3.SS2.p2.4.m4.4.4.2.2.1.1" xref="S3.SS2.p2.4.m4.4.4.2.2.1.1.cmml">−</mo><mn id="S3.SS2.p2.4.m4.4.4.2.2.1.3" xref="S3.SS2.p2.4.m4.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS2.p2.4.m4.4.4.2.2.2" xref="S3.SS2.p2.4.m4.4.4.2.3.cmml">,</mo><mtext id="S3.SS2.p2.4.m4.3.3.1.1" xref="S3.SS2.p2.4.m4.3.3.1.1a.cmml">sf</mtext></mrow></msub></mrow><mo id="S3.SS2.p2.4.m4.4.5.3.1" xref="S3.SS2.p2.4.m4.4.5.3.1.cmml">+</mo><mrow id="S3.SS2.p2.4.m4.4.5.3.3" xref="S3.SS2.p2.4.m4.4.5.3.3.cmml"><msub id="S3.SS2.p2.4.m4.4.5.3.3.2" xref="S3.SS2.p2.4.m4.4.5.3.3.2.cmml"><mi mathvariant="normal" id="S3.SS2.p2.4.m4.4.5.3.3.2.2" xref="S3.SS2.p2.4.m4.4.5.3.3.2.2.cmml">Π</mi><mi id="S3.SS2.p2.4.m4.4.5.3.3.2.3" xref="S3.SS2.p2.4.m4.4.5.3.3.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.4.m4.4.5.3.3.1" xref="S3.SS2.p2.4.m4.4.5.3.3.1.cmml">​</mo><msub id="S3.SS2.p2.4.m4.4.5.3.3.3" xref="S3.SS2.p2.4.m4.4.5.3.3.3.cmml"><mi id="S3.SS2.p2.4.m4.4.5.3.3.3.2" xref="S3.SS2.p2.4.m4.4.5.3.3.3.2.cmml">b</mi><mi id="S3.SS2.p2.4.m4.4.5.3.3.3.3" xref="S3.SS2.p2.4.m4.4.5.3.3.3.3.cmml">l</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.4b"><apply id="S3.SS2.p2.4.m4.4.5.cmml" xref="S3.SS2.p2.4.m4.4.5"><eq id="S3.SS2.p2.4.m4.4.5.1.cmml" xref="S3.SS2.p2.4.m4.4.5.1"></eq><apply id="S3.SS2.p2.4.m4.4.5.2.cmml" xref="S3.SS2.p2.4.m4.4.5.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.4.5.2.1.cmml" xref="S3.SS2.p2.4.m4.4.5.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.4.5.2.2.cmml" xref="S3.SS2.p2.4.m4.4.5.2.2">𝑠</ci><list id="S3.SS2.p2.4.m4.2.2.2.3.cmml" xref="S3.SS2.p2.4.m4.2.2.2.4"><ci id="S3.SS2.p2.4.m4.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1">𝑙</ci><ci id="S3.SS2.p2.4.m4.2.2.2.2a.cmml" xref="S3.SS2.p2.4.m4.2.2.2.2"><mtext mathsize="70%" id="S3.SS2.p2.4.m4.2.2.2.2.cmml" xref="S3.SS2.p2.4.m4.2.2.2.2">sf</mtext></ci></list></apply><apply id="S3.SS2.p2.4.m4.4.5.3.cmml" xref="S3.SS2.p2.4.m4.4.5.3"><plus id="S3.SS2.p2.4.m4.4.5.3.1.cmml" xref="S3.SS2.p2.4.m4.4.5.3.1"></plus><apply id="S3.SS2.p2.4.m4.4.5.3.2.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2"><times id="S3.SS2.p2.4.m4.4.5.3.2.1.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.1"></times><apply id="S3.SS2.p2.4.m4.4.5.3.2.2.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.4.5.3.2.2.1.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.4.5.3.2.2.2.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.2.2">Π</ci><ci id="S3.SS2.p2.4.m4.4.5.3.2.2.3.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.2.3">𝑙</ci></apply><apply id="S3.SS2.p2.4.m4.4.5.3.2.3.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.4.5.3.2.3.1.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.3">subscript</csymbol><ci id="S3.SS2.p2.4.m4.4.5.3.2.3.2.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.3.2">𝑊</ci><ci id="S3.SS2.p2.4.m4.4.5.3.2.3.3.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.3.3">𝑙</ci></apply><apply id="S3.SS2.p2.4.m4.4.5.3.2.4.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.4.5.3.2.4.1.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.4">superscript</csymbol><apply id="S3.SS2.p2.4.m4.4.5.3.2.4.2.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.4.5.3.2.4.2.1.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.4">subscript</csymbol><ci id="S3.SS2.p2.4.m4.4.5.3.2.4.2.2.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.4.2.2">Π</ci><apply id="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.4.2.3"><minus id="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.1.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.1"></minus><ci id="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.2.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.2">𝑙</ci><cn type="integer" id="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.3.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.4.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p2.4.m4.4.5.3.2.4.3.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.4.3">𝑇</ci></apply><apply id="S3.SS2.p2.4.m4.4.5.3.2.5.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.5"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.4.5.3.2.5.1.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.5">subscript</csymbol><ci id="S3.SS2.p2.4.m4.4.5.3.2.5.2.cmml" xref="S3.SS2.p2.4.m4.4.5.3.2.5.2">ℎ</ci><list id="S3.SS2.p2.4.m4.4.4.2.3.cmml" xref="S3.SS2.p2.4.m4.4.4.2.2"><apply id="S3.SS2.p2.4.m4.4.4.2.2.1.cmml" xref="S3.SS2.p2.4.m4.4.4.2.2.1"><minus id="S3.SS2.p2.4.m4.4.4.2.2.1.1.cmml" xref="S3.SS2.p2.4.m4.4.4.2.2.1.1"></minus><ci id="S3.SS2.p2.4.m4.4.4.2.2.1.2.cmml" xref="S3.SS2.p2.4.m4.4.4.2.2.1.2">𝑙</ci><cn type="integer" id="S3.SS2.p2.4.m4.4.4.2.2.1.3.cmml" xref="S3.SS2.p2.4.m4.4.4.2.2.1.3">1</cn></apply><ci id="S3.SS2.p2.4.m4.3.3.1.1a.cmml" xref="S3.SS2.p2.4.m4.3.3.1.1"><mtext mathsize="70%" id="S3.SS2.p2.4.m4.3.3.1.1.cmml" xref="S3.SS2.p2.4.m4.3.3.1.1">sf</mtext></ci></list></apply></apply><apply id="S3.SS2.p2.4.m4.4.5.3.3.cmml" xref="S3.SS2.p2.4.m4.4.5.3.3"><times id="S3.SS2.p2.4.m4.4.5.3.3.1.cmml" xref="S3.SS2.p2.4.m4.4.5.3.3.1"></times><apply id="S3.SS2.p2.4.m4.4.5.3.3.2.cmml" xref="S3.SS2.p2.4.m4.4.5.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.4.5.3.3.2.1.cmml" xref="S3.SS2.p2.4.m4.4.5.3.3.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.4.5.3.3.2.2.cmml" xref="S3.SS2.p2.4.m4.4.5.3.3.2.2">Π</ci><ci id="S3.SS2.p2.4.m4.4.5.3.3.2.3.cmml" xref="S3.SS2.p2.4.m4.4.5.3.3.2.3">𝑙</ci></apply><apply id="S3.SS2.p2.4.m4.4.5.3.3.3.cmml" xref="S3.SS2.p2.4.m4.4.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.4.5.3.3.3.1.cmml" xref="S3.SS2.p2.4.m4.4.5.3.3.3">subscript</csymbol><ci id="S3.SS2.p2.4.m4.4.5.3.3.3.2.cmml" xref="S3.SS2.p2.4.m4.4.5.3.3.3.2">𝑏</ci><ci id="S3.SS2.p2.4.m4.4.5.3.3.3.3.cmml" xref="S3.SS2.p2.4.m4.4.5.3.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.4c">s_{l,\text{sf}}=\Pi_{l}W_{l}\Pi_{l-1}^{T}h_{l-1,\text{sf}}+\Pi_{l}b_{l}</annotation></semantics></math> and obtain the recursive gradient expressions:</p>
<table id="A6.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{+}" display="inline"><semantics id="S3.E10.m1.1a"><msub id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><mtext id="S3.E10.m1.1.1.2" xref="S3.E10.m1.1.1.2a.cmml">PAN</mtext><mo id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml">+</mo></msub><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.2a.cmml" xref="S3.E10.m1.1.1.2"><mtext id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1.2">PAN</mtext></ci><plus id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\displaystyle\text{PAN}_{+}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E10.m2.9" class="ltx_Math" alttext="\displaystyle:\frac{\partial{h_{l,\text{sf}}}}{{\partial e}}=\text{D}(f_{l}^{\prime})\left(\frac{\partial{s_{l,\text{sf}}}}{\partial{h_{l-1,\text{sf}}}}\frac{\partial{h_{l-1,\text{sf}}}}{\partial{e}}+I\right)," display="inline"><semantics id="S3.E10.m2.9a"><mrow id="S3.E10.m2.9.9.1" xref="S3.E10.m2.9.9.1.1.cmml"><mrow id="S3.E10.m2.9.9.1.1" xref="S3.E10.m2.9.9.1.1.cmml"><mi id="S3.E10.m2.9.9.1.1.4" xref="S3.E10.m2.9.9.1.1.4.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S3.E10.m2.9.9.1.1.3" xref="S3.E10.m2.9.9.1.1.3.cmml">:</mo><mrow id="S3.E10.m2.9.9.1.1.2" xref="S3.E10.m2.9.9.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E10.m2.2.2" xref="S3.E10.m2.2.2.cmml"><mfrac id="S3.E10.m2.2.2a" xref="S3.E10.m2.2.2.cmml"><mrow id="S3.E10.m2.2.2.2" xref="S3.E10.m2.2.2.2.cmml"><mo rspace="0em" id="S3.E10.m2.2.2.2.3" xref="S3.E10.m2.2.2.2.3.cmml">∂</mo><msub id="S3.E10.m2.2.2.2.4" xref="S3.E10.m2.2.2.2.4.cmml"><mi id="S3.E10.m2.2.2.2.4.2" xref="S3.E10.m2.2.2.2.4.2.cmml">h</mi><mrow id="S3.E10.m2.2.2.2.2.2.4" xref="S3.E10.m2.2.2.2.2.2.3.cmml"><mi id="S3.E10.m2.1.1.1.1.1.1" xref="S3.E10.m2.1.1.1.1.1.1.cmml">l</mi><mo id="S3.E10.m2.2.2.2.2.2.4.1" xref="S3.E10.m2.2.2.2.2.2.3.cmml">,</mo><mtext id="S3.E10.m2.2.2.2.2.2.2" xref="S3.E10.m2.2.2.2.2.2.2a.cmml">sf</mtext></mrow></msub></mrow><mrow id="S3.E10.m2.2.2.4" xref="S3.E10.m2.2.2.4.cmml"><mo rspace="0em" id="S3.E10.m2.2.2.4.1" xref="S3.E10.m2.2.2.4.1.cmml">∂</mo><mi id="S3.E10.m2.2.2.4.2" xref="S3.E10.m2.2.2.4.2.cmml">e</mi></mrow></mfrac></mstyle><mo id="S3.E10.m2.9.9.1.1.2.3" xref="S3.E10.m2.9.9.1.1.2.3.cmml">=</mo><mrow id="S3.E10.m2.9.9.1.1.2.2" xref="S3.E10.m2.9.9.1.1.2.2.cmml"><mtext id="S3.E10.m2.9.9.1.1.2.2.4" xref="S3.E10.m2.9.9.1.1.2.2.4a.cmml">D</mtext><mo lspace="0em" rspace="0em" id="S3.E10.m2.9.9.1.1.2.2.3" xref="S3.E10.m2.9.9.1.1.2.2.3.cmml">​</mo><mrow id="S3.E10.m2.9.9.1.1.1.1.1.1" xref="S3.E10.m2.9.9.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m2.9.9.1.1.1.1.1.1.2" xref="S3.E10.m2.9.9.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E10.m2.9.9.1.1.1.1.1.1.1" xref="S3.E10.m2.9.9.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m2.9.9.1.1.1.1.1.1.1.2.2" xref="S3.E10.m2.9.9.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E10.m2.9.9.1.1.1.1.1.1.1.2.3" xref="S3.E10.m2.9.9.1.1.1.1.1.1.1.2.3.cmml">l</mi><mo id="S3.E10.m2.9.9.1.1.1.1.1.1.1.3" xref="S3.E10.m2.9.9.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.E10.m2.9.9.1.1.1.1.1.1.3" xref="S3.E10.m2.9.9.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E10.m2.9.9.1.1.2.2.3a" xref="S3.E10.m2.9.9.1.1.2.2.3.cmml">​</mo><mrow id="S3.E10.m2.9.9.1.1.2.2.2.1" xref="S3.E10.m2.9.9.1.1.2.2.2.1.1.cmml"><mo id="S3.E10.m2.9.9.1.1.2.2.2.1.2" xref="S3.E10.m2.9.9.1.1.2.2.2.1.1.cmml">(</mo><mrow id="S3.E10.m2.9.9.1.1.2.2.2.1.1" xref="S3.E10.m2.9.9.1.1.2.2.2.1.1.cmml"><mrow id="S3.E10.m2.9.9.1.1.2.2.2.1.1.2" xref="S3.E10.m2.9.9.1.1.2.2.2.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E10.m2.6.6" xref="S3.E10.m2.6.6.cmml"><mfrac id="S3.E10.m2.6.6a" xref="S3.E10.m2.6.6.cmml"><mrow id="S3.E10.m2.4.4.2" xref="S3.E10.m2.4.4.2.cmml"><mo rspace="0em" id="S3.E10.m2.4.4.2.3" xref="S3.E10.m2.4.4.2.3.cmml">∂</mo><msub id="S3.E10.m2.4.4.2.4" xref="S3.E10.m2.4.4.2.4.cmml"><mi id="S3.E10.m2.4.4.2.4.2" xref="S3.E10.m2.4.4.2.4.2.cmml">s</mi><mrow id="S3.E10.m2.4.4.2.2.2.4" xref="S3.E10.m2.4.4.2.2.2.3.cmml"><mi id="S3.E10.m2.3.3.1.1.1.1" xref="S3.E10.m2.3.3.1.1.1.1.cmml">l</mi><mo id="S3.E10.m2.4.4.2.2.2.4.1" xref="S3.E10.m2.4.4.2.2.2.3.cmml">,</mo><mtext id="S3.E10.m2.4.4.2.2.2.2" xref="S3.E10.m2.4.4.2.2.2.2a.cmml">sf</mtext></mrow></msub></mrow><mrow id="S3.E10.m2.6.6.4" xref="S3.E10.m2.6.6.4.cmml"><mo rspace="0em" id="S3.E10.m2.6.6.4.3" xref="S3.E10.m2.6.6.4.3.cmml">∂</mo><msub id="S3.E10.m2.6.6.4.4" xref="S3.E10.m2.6.6.4.4.cmml"><mi id="S3.E10.m2.6.6.4.4.2" xref="S3.E10.m2.6.6.4.4.2.cmml">h</mi><mrow id="S3.E10.m2.6.6.4.2.2.2" xref="S3.E10.m2.6.6.4.2.2.3.cmml"><mrow id="S3.E10.m2.6.6.4.2.2.2.1" xref="S3.E10.m2.6.6.4.2.2.2.1.cmml"><mi id="S3.E10.m2.6.6.4.2.2.2.1.2" xref="S3.E10.m2.6.6.4.2.2.2.1.2.cmml">l</mi><mo id="S3.E10.m2.6.6.4.2.2.2.1.1" xref="S3.E10.m2.6.6.4.2.2.2.1.1.cmml">−</mo><mn id="S3.E10.m2.6.6.4.2.2.2.1.3" xref="S3.E10.m2.6.6.4.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E10.m2.6.6.4.2.2.2.2" xref="S3.E10.m2.6.6.4.2.2.3.cmml">,</mo><mtext id="S3.E10.m2.5.5.3.1.1.1" xref="S3.E10.m2.5.5.3.1.1.1a.cmml">sf</mtext></mrow></msub></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E10.m2.9.9.1.1.2.2.2.1.1.2.1" xref="S3.E10.m2.9.9.1.1.2.2.2.1.1.2.1.cmml">​</mo><mstyle displaystyle="true" id="S3.E10.m2.8.8" xref="S3.E10.m2.8.8.cmml"><mfrac id="S3.E10.m2.8.8a" xref="S3.E10.m2.8.8.cmml"><mrow id="S3.E10.m2.8.8.2" xref="S3.E10.m2.8.8.2.cmml"><mo rspace="0em" id="S3.E10.m2.8.8.2.3" xref="S3.E10.m2.8.8.2.3.cmml">∂</mo><msub id="S3.E10.m2.8.8.2.4" xref="S3.E10.m2.8.8.2.4.cmml"><mi id="S3.E10.m2.8.8.2.4.2" xref="S3.E10.m2.8.8.2.4.2.cmml">h</mi><mrow id="S3.E10.m2.8.8.2.2.2.2" xref="S3.E10.m2.8.8.2.2.2.3.cmml"><mrow id="S3.E10.m2.8.8.2.2.2.2.1" xref="S3.E10.m2.8.8.2.2.2.2.1.cmml"><mi id="S3.E10.m2.8.8.2.2.2.2.1.2" xref="S3.E10.m2.8.8.2.2.2.2.1.2.cmml">l</mi><mo id="S3.E10.m2.8.8.2.2.2.2.1.1" xref="S3.E10.m2.8.8.2.2.2.2.1.1.cmml">−</mo><mn id="S3.E10.m2.8.8.2.2.2.2.1.3" xref="S3.E10.m2.8.8.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E10.m2.8.8.2.2.2.2.2" xref="S3.E10.m2.8.8.2.2.2.3.cmml">,</mo><mtext id="S3.E10.m2.7.7.1.1.1.1" xref="S3.E10.m2.7.7.1.1.1.1a.cmml">sf</mtext></mrow></msub></mrow><mrow id="S3.E10.m2.8.8.4" xref="S3.E10.m2.8.8.4.cmml"><mo rspace="0em" id="S3.E10.m2.8.8.4.1" xref="S3.E10.m2.8.8.4.1.cmml">∂</mo><mi id="S3.E10.m2.8.8.4.2" xref="S3.E10.m2.8.8.4.2.cmml">e</mi></mrow></mfrac></mstyle></mrow><mo id="S3.E10.m2.9.9.1.1.2.2.2.1.1.1" xref="S3.E10.m2.9.9.1.1.2.2.2.1.1.1.cmml">+</mo><mi id="S3.E10.m2.9.9.1.1.2.2.2.1.1.3" xref="S3.E10.m2.9.9.1.1.2.2.2.1.1.3.cmml">I</mi></mrow><mo id="S3.E10.m2.9.9.1.1.2.2.2.1.3" xref="S3.E10.m2.9.9.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E10.m2.9.9.1.2" xref="S3.E10.m2.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m2.9b"><apply id="S3.E10.m2.9.9.1.1.cmml" xref="S3.E10.m2.9.9.1"><ci id="S3.E10.m2.9.9.1.1.3.cmml" xref="S3.E10.m2.9.9.1.1.3">:</ci><csymbol cd="latexml" id="S3.E10.m2.9.9.1.1.4.cmml" xref="S3.E10.m2.9.9.1.1.4">absent</csymbol><apply id="S3.E10.m2.9.9.1.1.2.cmml" xref="S3.E10.m2.9.9.1.1.2"><eq id="S3.E10.m2.9.9.1.1.2.3.cmml" xref="S3.E10.m2.9.9.1.1.2.3"></eq><apply id="S3.E10.m2.2.2.cmml" xref="S3.E10.m2.2.2"><divide id="S3.E10.m2.2.2.3.cmml" xref="S3.E10.m2.2.2"></divide><apply id="S3.E10.m2.2.2.2.cmml" xref="S3.E10.m2.2.2.2"><partialdiff id="S3.E10.m2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.3"></partialdiff><apply id="S3.E10.m2.2.2.2.4.cmml" xref="S3.E10.m2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E10.m2.2.2.2.4.1.cmml" xref="S3.E10.m2.2.2.2.4">subscript</csymbol><ci id="S3.E10.m2.2.2.2.4.2.cmml" xref="S3.E10.m2.2.2.2.4.2">ℎ</ci><list id="S3.E10.m2.2.2.2.2.2.3.cmml" xref="S3.E10.m2.2.2.2.2.2.4"><ci id="S3.E10.m2.1.1.1.1.1.1.cmml" xref="S3.E10.m2.1.1.1.1.1.1">𝑙</ci><ci id="S3.E10.m2.2.2.2.2.2.2a.cmml" xref="S3.E10.m2.2.2.2.2.2.2"><mtext mathsize="70%" id="S3.E10.m2.2.2.2.2.2.2.cmml" xref="S3.E10.m2.2.2.2.2.2.2">sf</mtext></ci></list></apply></apply><apply id="S3.E10.m2.2.2.4.cmml" xref="S3.E10.m2.2.2.4"><partialdiff id="S3.E10.m2.2.2.4.1.cmml" xref="S3.E10.m2.2.2.4.1"></partialdiff><ci id="S3.E10.m2.2.2.4.2.cmml" xref="S3.E10.m2.2.2.4.2">𝑒</ci></apply></apply><apply id="S3.E10.m2.9.9.1.1.2.2.cmml" xref="S3.E10.m2.9.9.1.1.2.2"><times id="S3.E10.m2.9.9.1.1.2.2.3.cmml" xref="S3.E10.m2.9.9.1.1.2.2.3"></times><ci id="S3.E10.m2.9.9.1.1.2.2.4a.cmml" xref="S3.E10.m2.9.9.1.1.2.2.4"><mtext id="S3.E10.m2.9.9.1.1.2.2.4.cmml" xref="S3.E10.m2.9.9.1.1.2.2.4">D</mtext></ci><apply id="S3.E10.m2.9.9.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m2.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m2.9.9.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E10.m2.9.9.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m2.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m2.9.9.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m2.9.9.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m2.9.9.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m2.9.9.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E10.m2.9.9.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m2.9.9.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.E10.m2.9.9.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m2.9.9.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S3.E10.m2.9.9.1.1.2.2.2.1.1.cmml" xref="S3.E10.m2.9.9.1.1.2.2.2.1"><plus id="S3.E10.m2.9.9.1.1.2.2.2.1.1.1.cmml" xref="S3.E10.m2.9.9.1.1.2.2.2.1.1.1"></plus><apply id="S3.E10.m2.9.9.1.1.2.2.2.1.1.2.cmml" xref="S3.E10.m2.9.9.1.1.2.2.2.1.1.2"><times id="S3.E10.m2.9.9.1.1.2.2.2.1.1.2.1.cmml" xref="S3.E10.m2.9.9.1.1.2.2.2.1.1.2.1"></times><apply id="S3.E10.m2.6.6.cmml" xref="S3.E10.m2.6.6"><divide id="S3.E10.m2.6.6.5.cmml" xref="S3.E10.m2.6.6"></divide><apply id="S3.E10.m2.4.4.2.cmml" xref="S3.E10.m2.4.4.2"><partialdiff id="S3.E10.m2.4.4.2.3.cmml" xref="S3.E10.m2.4.4.2.3"></partialdiff><apply id="S3.E10.m2.4.4.2.4.cmml" xref="S3.E10.m2.4.4.2.4"><csymbol cd="ambiguous" id="S3.E10.m2.4.4.2.4.1.cmml" xref="S3.E10.m2.4.4.2.4">subscript</csymbol><ci id="S3.E10.m2.4.4.2.4.2.cmml" xref="S3.E10.m2.4.4.2.4.2">𝑠</ci><list id="S3.E10.m2.4.4.2.2.2.3.cmml" xref="S3.E10.m2.4.4.2.2.2.4"><ci id="S3.E10.m2.3.3.1.1.1.1.cmml" xref="S3.E10.m2.3.3.1.1.1.1">𝑙</ci><ci id="S3.E10.m2.4.4.2.2.2.2a.cmml" xref="S3.E10.m2.4.4.2.2.2.2"><mtext mathsize="70%" id="S3.E10.m2.4.4.2.2.2.2.cmml" xref="S3.E10.m2.4.4.2.2.2.2">sf</mtext></ci></list></apply></apply><apply id="S3.E10.m2.6.6.4.cmml" xref="S3.E10.m2.6.6.4"><partialdiff id="S3.E10.m2.6.6.4.3.cmml" xref="S3.E10.m2.6.6.4.3"></partialdiff><apply id="S3.E10.m2.6.6.4.4.cmml" xref="S3.E10.m2.6.6.4.4"><csymbol cd="ambiguous" id="S3.E10.m2.6.6.4.4.1.cmml" xref="S3.E10.m2.6.6.4.4">subscript</csymbol><ci id="S3.E10.m2.6.6.4.4.2.cmml" xref="S3.E10.m2.6.6.4.4.2">ℎ</ci><list id="S3.E10.m2.6.6.4.2.2.3.cmml" xref="S3.E10.m2.6.6.4.2.2.2"><apply id="S3.E10.m2.6.6.4.2.2.2.1.cmml" xref="S3.E10.m2.6.6.4.2.2.2.1"><minus id="S3.E10.m2.6.6.4.2.2.2.1.1.cmml" xref="S3.E10.m2.6.6.4.2.2.2.1.1"></minus><ci id="S3.E10.m2.6.6.4.2.2.2.1.2.cmml" xref="S3.E10.m2.6.6.4.2.2.2.1.2">𝑙</ci><cn type="integer" id="S3.E10.m2.6.6.4.2.2.2.1.3.cmml" xref="S3.E10.m2.6.6.4.2.2.2.1.3">1</cn></apply><ci id="S3.E10.m2.5.5.3.1.1.1a.cmml" xref="S3.E10.m2.5.5.3.1.1.1"><mtext mathsize="70%" id="S3.E10.m2.5.5.3.1.1.1.cmml" xref="S3.E10.m2.5.5.3.1.1.1">sf</mtext></ci></list></apply></apply></apply><apply id="S3.E10.m2.8.8.cmml" xref="S3.E10.m2.8.8"><divide id="S3.E10.m2.8.8.3.cmml" xref="S3.E10.m2.8.8"></divide><apply id="S3.E10.m2.8.8.2.cmml" xref="S3.E10.m2.8.8.2"><partialdiff id="S3.E10.m2.8.8.2.3.cmml" xref="S3.E10.m2.8.8.2.3"></partialdiff><apply id="S3.E10.m2.8.8.2.4.cmml" xref="S3.E10.m2.8.8.2.4"><csymbol cd="ambiguous" id="S3.E10.m2.8.8.2.4.1.cmml" xref="S3.E10.m2.8.8.2.4">subscript</csymbol><ci id="S3.E10.m2.8.8.2.4.2.cmml" xref="S3.E10.m2.8.8.2.4.2">ℎ</ci><list id="S3.E10.m2.8.8.2.2.2.3.cmml" xref="S3.E10.m2.8.8.2.2.2.2"><apply id="S3.E10.m2.8.8.2.2.2.2.1.cmml" xref="S3.E10.m2.8.8.2.2.2.2.1"><minus id="S3.E10.m2.8.8.2.2.2.2.1.1.cmml" xref="S3.E10.m2.8.8.2.2.2.2.1.1"></minus><ci id="S3.E10.m2.8.8.2.2.2.2.1.2.cmml" xref="S3.E10.m2.8.8.2.2.2.2.1.2">𝑙</ci><cn type="integer" id="S3.E10.m2.8.8.2.2.2.2.1.3.cmml" xref="S3.E10.m2.8.8.2.2.2.2.1.3">1</cn></apply><ci id="S3.E10.m2.7.7.1.1.1.1a.cmml" xref="S3.E10.m2.7.7.1.1.1.1"><mtext mathsize="70%" id="S3.E10.m2.7.7.1.1.1.1.cmml" xref="S3.E10.m2.7.7.1.1.1.1">sf</mtext></ci></list></apply></apply><apply id="S3.E10.m2.8.8.4.cmml" xref="S3.E10.m2.8.8.4"><partialdiff id="S3.E10.m2.8.8.4.1.cmml" xref="S3.E10.m2.8.8.4.1"></partialdiff><ci id="S3.E10.m2.8.8.4.2.cmml" xref="S3.E10.m2.8.8.4.2">𝑒</ci></apply></apply></apply><ci id="S3.E10.m2.9.9.1.1.2.2.2.1.1.3.cmml" xref="S3.E10.m2.9.9.1.1.2.2.2.1.1.3">𝐼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m2.9c">\displaystyle:\frac{\partial{h_{l,\text{sf}}}}{{\partial e}}=\text{D}(f_{l}^{\prime})\left(\frac{\partial{s_{l,\text{sf}}}}{\partial{h_{l-1,\text{sf}}}}\frac{\partial{h_{l-1,\text{sf}}}}{\partial{e}}+I\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S3.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex5.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{\circ}" display="inline"><semantics id="S3.Ex5.m1.1a"><msub id="S3.Ex5.m1.1.1" xref="S3.Ex5.m1.1.1.cmml"><mtext id="S3.Ex5.m1.1.1.2" xref="S3.Ex5.m1.1.1.2a.cmml">PAN</mtext><mo id="S3.Ex5.m1.1.1.3" xref="S3.Ex5.m1.1.1.3.cmml">∘</mo></msub><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.1b"><apply id="S3.Ex5.m1.1.1.cmml" xref="S3.Ex5.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.1.1.1.cmml" xref="S3.Ex5.m1.1.1">subscript</csymbol><ci id="S3.Ex5.m1.1.1.2a.cmml" xref="S3.Ex5.m1.1.1.2"><mtext id="S3.Ex5.m1.1.1.2.cmml" xref="S3.Ex5.m1.1.1.2">PAN</mtext></ci><compose id="S3.Ex5.m1.1.1.3.cmml" xref="S3.Ex5.m1.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.1c">\displaystyle\text{PAN}_{\circ}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex5.m2.9" class="ltx_math_unparsed" alttext="\displaystyle:\frac{\partial{h_{l,\text{sf}}}}{{\partial e}}=\text{D}(f_{l}^{\prime})\bigg{(}\frac{\partial{s_{l,\text{sf}}}}{\partial{h_{l-1,\text{sf}}}}\frac{\partial{h_{l-1,\text{sf}}}}{\partial{e}}\odot[e]^{J}" display="inline"><semantics id="S3.Ex5.m2.9a"><mrow id="S3.Ex5.m2.9b"><mo rspace="0.278em" id="S3.Ex5.m2.9.10">:</mo><mstyle displaystyle="true" id="S3.Ex5.m2.2.2"><mfrac id="S3.Ex5.m2.2.2a"><mrow id="S3.Ex5.m2.2.2.2"><mo rspace="0em" id="S3.Ex5.m2.2.2.2.3">∂</mo><msub id="S3.Ex5.m2.2.2.2.4"><mi id="S3.Ex5.m2.2.2.2.4.2">h</mi><mrow id="S3.Ex5.m2.2.2.2.2.2.4"><mi id="S3.Ex5.m2.1.1.1.1.1.1">l</mi><mo id="S3.Ex5.m2.2.2.2.2.2.4.1">,</mo><mtext id="S3.Ex5.m2.2.2.2.2.2.2">sf</mtext></mrow></msub></mrow><mrow id="S3.Ex5.m2.2.2.4"><mo rspace="0em" id="S3.Ex5.m2.2.2.4.1">∂</mo><mi id="S3.Ex5.m2.2.2.4.2">e</mi></mrow></mfrac></mstyle><mo id="S3.Ex5.m2.9.11">=</mo><mtext id="S3.Ex5.m2.9.12">D</mtext><mrow id="S3.Ex5.m2.9.13"><mo stretchy="false" id="S3.Ex5.m2.9.13.1">(</mo><msubsup id="S3.Ex5.m2.9.13.2"><mi id="S3.Ex5.m2.9.13.2.2.2">f</mi><mi id="S3.Ex5.m2.9.13.2.2.3">l</mi><mo id="S3.Ex5.m2.9.13.2.3">′</mo></msubsup><mo stretchy="false" id="S3.Ex5.m2.9.13.3">)</mo></mrow><mrow id="S3.Ex5.m2.9.14"><mo maxsize="210%" minsize="210%" id="S3.Ex5.m2.9.14.1">(</mo><mstyle displaystyle="true" id="S3.Ex5.m2.6.6"><mfrac id="S3.Ex5.m2.6.6a"><mrow id="S3.Ex5.m2.4.4.2"><mo rspace="0em" id="S3.Ex5.m2.4.4.2.3">∂</mo><msub id="S3.Ex5.m2.4.4.2.4"><mi id="S3.Ex5.m2.4.4.2.4.2">s</mi><mrow id="S3.Ex5.m2.4.4.2.2.2.4"><mi id="S3.Ex5.m2.3.3.1.1.1.1">l</mi><mo id="S3.Ex5.m2.4.4.2.2.2.4.1">,</mo><mtext id="S3.Ex5.m2.4.4.2.2.2.2">sf</mtext></mrow></msub></mrow><mrow id="S3.Ex5.m2.6.6.4"><mo rspace="0em" id="S3.Ex5.m2.6.6.4.3">∂</mo><msub id="S3.Ex5.m2.6.6.4.4"><mi id="S3.Ex5.m2.6.6.4.4.2">h</mi><mrow id="S3.Ex5.m2.6.6.4.2.2.2"><mrow id="S3.Ex5.m2.6.6.4.2.2.2.1"><mi id="S3.Ex5.m2.6.6.4.2.2.2.1.2">l</mi><mo id="S3.Ex5.m2.6.6.4.2.2.2.1.1">−</mo><mn id="S3.Ex5.m2.6.6.4.2.2.2.1.3">1</mn></mrow><mo id="S3.Ex5.m2.6.6.4.2.2.2.2">,</mo><mtext id="S3.Ex5.m2.5.5.3.1.1.1">sf</mtext></mrow></msub></mrow></mfrac></mstyle><mstyle displaystyle="true" id="S3.Ex5.m2.8.8"><mfrac id="S3.Ex5.m2.8.8a"><mrow id="S3.Ex5.m2.8.8.2"><mo rspace="0em" id="S3.Ex5.m2.8.8.2.3">∂</mo><msub id="S3.Ex5.m2.8.8.2.4"><mi id="S3.Ex5.m2.8.8.2.4.2">h</mi><mrow id="S3.Ex5.m2.8.8.2.2.2.2"><mrow id="S3.Ex5.m2.8.8.2.2.2.2.1"><mi id="S3.Ex5.m2.8.8.2.2.2.2.1.2">l</mi><mo id="S3.Ex5.m2.8.8.2.2.2.2.1.1">−</mo><mn id="S3.Ex5.m2.8.8.2.2.2.2.1.3">1</mn></mrow><mo id="S3.Ex5.m2.8.8.2.2.2.2.2">,</mo><mtext id="S3.Ex5.m2.7.7.1.1.1.1">sf</mtext></mrow></msub></mrow><mrow id="S3.Ex5.m2.8.8.4"><mo rspace="0em" id="S3.Ex5.m2.8.8.4.1">∂</mo><mi id="S3.Ex5.m2.8.8.4.2">e</mi></mrow></mfrac></mstyle><mo lspace="0.222em" rspace="0.222em" id="S3.Ex5.m2.9.14.2">⊙</mo><msup id="S3.Ex5.m2.9.14.3"><mrow id="S3.Ex5.m2.9.14.3.2"><mo stretchy="false" id="S3.Ex5.m2.9.14.3.2.1">[</mo><mi id="S3.Ex5.m2.9.9">e</mi><mo stretchy="false" id="S3.Ex5.m2.9.14.3.2.2">]</mo></mrow><mi id="S3.Ex5.m2.9.14.3.3">J</mi></msup></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex5.m2.9c">\displaystyle:\frac{\partial{h_{l,\text{sf}}}}{{\partial e}}=\text{D}(f_{l}^{\prime})\bigg{(}\frac{\partial{s_{l,\text{sf}}}}{\partial{h_{l-1,\text{sf}}}}\frac{\partial{h_{l-1,\text{sf}}}}{\partial{e}}\odot[e]^{J}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E11.m1.2" class="ltx_math_unparsed" alttext="\displaystyle~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}+\text{D}(s_{l,\text{sf}})\bigg{)}," display="inline"><semantics id="S3.E11.m1.2a"><mrow id="S3.E11.m1.2b"><mo id="S3.E11.m1.2.3">+</mo><mtext id="S3.E11.m1.2.4">D</mtext><mrow id="S3.E11.m1.2.5"><mo stretchy="false" id="S3.E11.m1.2.5.1">(</mo><msub id="S3.E11.m1.2.5.2"><mi id="S3.E11.m1.2.5.2.2">s</mi><mrow id="S3.E11.m1.2.2.2.4"><mi id="S3.E11.m1.1.1.1.1">l</mi><mo id="S3.E11.m1.2.2.2.4.1">,</mo><mtext id="S3.E11.m1.2.2.2.2">sf</mtext></mrow></msub><mo stretchy="false" id="S3.E11.m1.2.5.3">)</mo></mrow><mo maxsize="210%" minsize="210%" id="S3.E11.m1.2.6">)</mo><mo id="S3.E11.m1.2.7">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E11.m1.2c">\displaystyle~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}+\text{D}(s_{l,\text{sf}})\bigg{)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.15" class="ltx_p">where <math id="S3.SS2.p2.5.m1.1" class="ltx_Math" alttext="\text{D}(\cdot)" display="inline"><semantics id="S3.SS2.p2.5.m1.1a"><mrow id="S3.SS2.p2.5.m1.1.2" xref="S3.SS2.p2.5.m1.1.2.cmml"><mtext id="S3.SS2.p2.5.m1.1.2.2" xref="S3.SS2.p2.5.m1.1.2.2a.cmml">D</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m1.1.2.1" xref="S3.SS2.p2.5.m1.1.2.1.cmml">​</mo><mrow id="S3.SS2.p2.5.m1.1.2.3.2" xref="S3.SS2.p2.5.m1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.5.m1.1.2.3.2.1" xref="S3.SS2.p2.5.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m1.1.1" xref="S3.SS2.p2.5.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p2.5.m1.1.2.3.2.2" xref="S3.SS2.p2.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m1.1b"><apply id="S3.SS2.p2.5.m1.1.2.cmml" xref="S3.SS2.p2.5.m1.1.2"><times id="S3.SS2.p2.5.m1.1.2.1.cmml" xref="S3.SS2.p2.5.m1.1.2.1"></times><ci id="S3.SS2.p2.5.m1.1.2.2a.cmml" xref="S3.SS2.p2.5.m1.1.2.2"><mtext id="S3.SS2.p2.5.m1.1.2.2.cmml" xref="S3.SS2.p2.5.m1.1.2.2">D</mtext></ci><ci id="S3.SS2.p2.5.m1.1.1.cmml" xref="S3.SS2.p2.5.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m1.1c">\text{D}(\cdot)</annotation></semantics></math> transforms a vector to a diagonal matrix and <math id="S3.SS2.p2.6.m2.1" class="ltx_Math" alttext="[\cdot]^{J}" display="inline"><semantics id="S3.SS2.p2.6.m2.1a"><msup id="S3.SS2.p2.6.m2.1.2" xref="S3.SS2.p2.6.m2.1.2.cmml"><mrow id="S3.SS2.p2.6.m2.1.2.2.2" xref="S3.SS2.p2.6.m2.1.2.2.1.cmml"><mo stretchy="false" id="S3.SS2.p2.6.m2.1.2.2.2.1" xref="S3.SS2.p2.6.m2.1.2.2.1.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p2.6.m2.1.1" xref="S3.SS2.p2.6.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p2.6.m2.1.2.2.2.2" xref="S3.SS2.p2.6.m2.1.2.2.1.1.cmml">]</mo></mrow><mi id="S3.SS2.p2.6.m2.1.2.3" xref="S3.SS2.p2.6.m2.1.2.3.cmml">J</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m2.1b"><apply id="S3.SS2.p2.6.m2.1.2.cmml" xref="S3.SS2.p2.6.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m2.1.2.1.cmml" xref="S3.SS2.p2.6.m2.1.2">superscript</csymbol><apply id="S3.SS2.p2.6.m2.1.2.2.1.cmml" xref="S3.SS2.p2.6.m2.1.2.2.2"><csymbol cd="latexml" id="S3.SS2.p2.6.m2.1.2.2.1.1.cmml" xref="S3.SS2.p2.6.m2.1.2.2.2.1">delimited-[]</csymbol><ci id="S3.SS2.p2.6.m2.1.1.cmml" xref="S3.SS2.p2.6.m2.1.1">⋅</ci></apply><ci id="S3.SS2.p2.6.m2.1.2.3.cmml" xref="S3.SS2.p2.6.m2.1.2.3">𝐽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m2.1c">[\cdot]^{J}</annotation></semantics></math> repeats a vector <math id="S3.SS2.p2.7.m3.1" class="ltx_Math" alttext="J" display="inline"><semantics id="S3.SS2.p2.7.m3.1a"><mi id="S3.SS2.p2.7.m3.1.1" xref="S3.SS2.p2.7.m3.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m3.1b"><ci id="S3.SS2.p2.7.m3.1.1.cmml" xref="S3.SS2.p2.7.m3.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m3.1c">J</annotation></semantics></math> times to obtain a matrix. <math id="S3.SS2.p2.8.m4.1" class="ltx_Math" alttext="f_{l}^{\prime}" display="inline"><semantics id="S3.SS2.p2.8.m4.1a"><msubsup id="S3.SS2.p2.8.m4.1.1" xref="S3.SS2.p2.8.m4.1.1.cmml"><mi id="S3.SS2.p2.8.m4.1.1.2.2" xref="S3.SS2.p2.8.m4.1.1.2.2.cmml">f</mi><mi id="S3.SS2.p2.8.m4.1.1.2.3" xref="S3.SS2.p2.8.m4.1.1.2.3.cmml">l</mi><mo id="S3.SS2.p2.8.m4.1.1.3" xref="S3.SS2.p2.8.m4.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m4.1b"><apply id="S3.SS2.p2.8.m4.1.1.cmml" xref="S3.SS2.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m4.1.1.1.cmml" xref="S3.SS2.p2.8.m4.1.1">superscript</csymbol><apply id="S3.SS2.p2.8.m4.1.1.2.cmml" xref="S3.SS2.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m4.1.1.2.1.cmml" xref="S3.SS2.p2.8.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m4.1.1.2.2.cmml" xref="S3.SS2.p2.8.m4.1.1.2.2">𝑓</ci><ci id="S3.SS2.p2.8.m4.1.1.2.3.cmml" xref="S3.SS2.p2.8.m4.1.1.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.8.m4.1.1.3.cmml" xref="S3.SS2.p2.8.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m4.1c">f_{l}^{\prime}</annotation></semantics></math> denotes the gradient of activation functions, whose element is 0 or 1 in ReLU. If we expand Eq. <a href="#S3.E10" title="Equation 10 ‣ 3.2 Position-Aware Neurons ‣ 3 Position-Aware Neurons ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> and Eq. <a href="#S3.E11" title="Equation 11 ‣ 3.2 Position-Aware Neurons ‣ 3 Position-Aware Neurons ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> correspondingly, we will find that the gradient <math id="S3.SS2.p2.9.m5.2" class="ltx_Math" alttext="\frac{\partial{h_{L,\text{sf}}}}{\partial e}" display="inline"><semantics id="S3.SS2.p2.9.m5.2a"><mfrac id="S3.SS2.p2.9.m5.2.2" xref="S3.SS2.p2.9.m5.2.2.cmml"><mrow id="S3.SS2.p2.9.m5.2.2.2" xref="S3.SS2.p2.9.m5.2.2.2.cmml"><mo rspace="0em" id="S3.SS2.p2.9.m5.2.2.2.3" xref="S3.SS2.p2.9.m5.2.2.2.3.cmml">∂</mo><msub id="S3.SS2.p2.9.m5.2.2.2.4" xref="S3.SS2.p2.9.m5.2.2.2.4.cmml"><mi id="S3.SS2.p2.9.m5.2.2.2.4.2" xref="S3.SS2.p2.9.m5.2.2.2.4.2.cmml">h</mi><mrow id="S3.SS2.p2.9.m5.2.2.2.2.2.4" xref="S3.SS2.p2.9.m5.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p2.9.m5.1.1.1.1.1.1" xref="S3.SS2.p2.9.m5.1.1.1.1.1.1.cmml">L</mi><mo id="S3.SS2.p2.9.m5.2.2.2.2.2.4.1" xref="S3.SS2.p2.9.m5.2.2.2.2.2.3.cmml">,</mo><mtext id="S3.SS2.p2.9.m5.2.2.2.2.2.2" xref="S3.SS2.p2.9.m5.2.2.2.2.2.2a.cmml">sf</mtext></mrow></msub></mrow><mrow id="S3.SS2.p2.9.m5.2.2.4" xref="S3.SS2.p2.9.m5.2.2.4.cmml"><mo rspace="0em" id="S3.SS2.p2.9.m5.2.2.4.1" xref="S3.SS2.p2.9.m5.2.2.4.1.cmml">∂</mo><mi id="S3.SS2.p2.9.m5.2.2.4.2" xref="S3.SS2.p2.9.m5.2.2.4.2.cmml">e</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m5.2b"><apply id="S3.SS2.p2.9.m5.2.2.cmml" xref="S3.SS2.p2.9.m5.2.2"><divide id="S3.SS2.p2.9.m5.2.2.3.cmml" xref="S3.SS2.p2.9.m5.2.2"></divide><apply id="S3.SS2.p2.9.m5.2.2.2.cmml" xref="S3.SS2.p2.9.m5.2.2.2"><partialdiff id="S3.SS2.p2.9.m5.2.2.2.3.cmml" xref="S3.SS2.p2.9.m5.2.2.2.3"></partialdiff><apply id="S3.SS2.p2.9.m5.2.2.2.4.cmml" xref="S3.SS2.p2.9.m5.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m5.2.2.2.4.1.cmml" xref="S3.SS2.p2.9.m5.2.2.2.4">subscript</csymbol><ci id="S3.SS2.p2.9.m5.2.2.2.4.2.cmml" xref="S3.SS2.p2.9.m5.2.2.2.4.2">ℎ</ci><list id="S3.SS2.p2.9.m5.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.9.m5.2.2.2.2.2.4"><ci id="S3.SS2.p2.9.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.9.m5.1.1.1.1.1.1">𝐿</ci><ci id="S3.SS2.p2.9.m5.2.2.2.2.2.2a.cmml" xref="S3.SS2.p2.9.m5.2.2.2.2.2.2"><mtext mathsize="50%" id="S3.SS2.p2.9.m5.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.9.m5.2.2.2.2.2.2">sf</mtext></ci></list></apply></apply><apply id="S3.SS2.p2.9.m5.2.2.4.cmml" xref="S3.SS2.p2.9.m5.2.2.4"><partialdiff id="S3.SS2.p2.9.m5.2.2.4.1.cmml" xref="S3.SS2.p2.9.m5.2.2.4.1"></partialdiff><ci id="S3.SS2.p2.9.m5.2.2.4.2.cmml" xref="S3.SS2.p2.9.m5.2.2.4.2">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m5.2c">\frac{\partial{h_{L,\text{sf}}}}{\partial e}</annotation></semantics></math> of additive PANs does not explicitly rely on <math id="S3.SS2.p2.10.m6.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS2.p2.10.m6.1a"><mi id="S3.SS2.p2.10.m6.1.1" xref="S3.SS2.p2.10.m6.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m6.1b"><ci id="S3.SS2.p2.10.m6.1.1.cmml" xref="S3.SS2.p2.10.m6.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m6.1c">e</annotation></semantics></math>. However, for the multiplicative one, <math id="S3.SS2.p2.11.m7.2" class="ltx_Math" alttext="\frac{\partial{h_{l,\text{sf}}}}{{\partial e}}" display="inline"><semantics id="S3.SS2.p2.11.m7.2a"><mfrac id="S3.SS2.p2.11.m7.2.2" xref="S3.SS2.p2.11.m7.2.2.cmml"><mrow id="S3.SS2.p2.11.m7.2.2.2" xref="S3.SS2.p2.11.m7.2.2.2.cmml"><mo rspace="0em" id="S3.SS2.p2.11.m7.2.2.2.3" xref="S3.SS2.p2.11.m7.2.2.2.3.cmml">∂</mo><msub id="S3.SS2.p2.11.m7.2.2.2.4" xref="S3.SS2.p2.11.m7.2.2.2.4.cmml"><mi id="S3.SS2.p2.11.m7.2.2.2.4.2" xref="S3.SS2.p2.11.m7.2.2.2.4.2.cmml">h</mi><mrow id="S3.SS2.p2.11.m7.2.2.2.2.2.4" xref="S3.SS2.p2.11.m7.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p2.11.m7.1.1.1.1.1.1" xref="S3.SS2.p2.11.m7.1.1.1.1.1.1.cmml">l</mi><mo id="S3.SS2.p2.11.m7.2.2.2.2.2.4.1" xref="S3.SS2.p2.11.m7.2.2.2.2.2.3.cmml">,</mo><mtext id="S3.SS2.p2.11.m7.2.2.2.2.2.2" xref="S3.SS2.p2.11.m7.2.2.2.2.2.2a.cmml">sf</mtext></mrow></msub></mrow><mrow id="S3.SS2.p2.11.m7.2.2.4" xref="S3.SS2.p2.11.m7.2.2.4.cmml"><mo rspace="0em" id="S3.SS2.p2.11.m7.2.2.4.1" xref="S3.SS2.p2.11.m7.2.2.4.1.cmml">∂</mo><mi id="S3.SS2.p2.11.m7.2.2.4.2" xref="S3.SS2.p2.11.m7.2.2.4.2.cmml">e</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m7.2b"><apply id="S3.SS2.p2.11.m7.2.2.cmml" xref="S3.SS2.p2.11.m7.2.2"><divide id="S3.SS2.p2.11.m7.2.2.3.cmml" xref="S3.SS2.p2.11.m7.2.2"></divide><apply id="S3.SS2.p2.11.m7.2.2.2.cmml" xref="S3.SS2.p2.11.m7.2.2.2"><partialdiff id="S3.SS2.p2.11.m7.2.2.2.3.cmml" xref="S3.SS2.p2.11.m7.2.2.2.3"></partialdiff><apply id="S3.SS2.p2.11.m7.2.2.2.4.cmml" xref="S3.SS2.p2.11.m7.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m7.2.2.2.4.1.cmml" xref="S3.SS2.p2.11.m7.2.2.2.4">subscript</csymbol><ci id="S3.SS2.p2.11.m7.2.2.2.4.2.cmml" xref="S3.SS2.p2.11.m7.2.2.2.4.2">ℎ</ci><list id="S3.SS2.p2.11.m7.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.11.m7.2.2.2.2.2.4"><ci id="S3.SS2.p2.11.m7.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.11.m7.1.1.1.1.1.1">𝑙</ci><ci id="S3.SS2.p2.11.m7.2.2.2.2.2.2a.cmml" xref="S3.SS2.p2.11.m7.2.2.2.2.2.2"><mtext mathsize="50%" id="S3.SS2.p2.11.m7.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.11.m7.2.2.2.2.2.2">sf</mtext></ci></list></apply></apply><apply id="S3.SS2.p2.11.m7.2.2.4.cmml" xref="S3.SS2.p2.11.m7.2.2.4"><partialdiff id="S3.SS2.p2.11.m7.2.2.4.1.cmml" xref="S3.SS2.p2.11.m7.2.2.4.1"></partialdiff><ci id="S3.SS2.p2.11.m7.2.2.4.2.cmml" xref="S3.SS2.p2.11.m7.2.2.4.2">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m7.2c">\frac{\partial{h_{l,\text{sf}}}}{{\partial e}}</annotation></semantics></math> is relevant to <math id="S3.SS2.p2.12.m8.2" class="ltx_Math" alttext="\frac{\partial{h_{l-1,\text{sf}}}}{\partial{e}}" display="inline"><semantics id="S3.SS2.p2.12.m8.2a"><mfrac id="S3.SS2.p2.12.m8.2.2" xref="S3.SS2.p2.12.m8.2.2.cmml"><mrow id="S3.SS2.p2.12.m8.2.2.2" xref="S3.SS2.p2.12.m8.2.2.2.cmml"><mo rspace="0em" id="S3.SS2.p2.12.m8.2.2.2.3" xref="S3.SS2.p2.12.m8.2.2.2.3.cmml">∂</mo><msub id="S3.SS2.p2.12.m8.2.2.2.4" xref="S3.SS2.p2.12.m8.2.2.2.4.cmml"><mi id="S3.SS2.p2.12.m8.2.2.2.4.2" xref="S3.SS2.p2.12.m8.2.2.2.4.2.cmml">h</mi><mrow id="S3.SS2.p2.12.m8.2.2.2.2.2.2" xref="S3.SS2.p2.12.m8.2.2.2.2.2.3.cmml"><mrow id="S3.SS2.p2.12.m8.2.2.2.2.2.2.1" xref="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.cmml"><mi id="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.2" xref="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.2.cmml">l</mi><mo id="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.1" xref="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.1.cmml">−</mo><mn id="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.3" xref="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS2.p2.12.m8.2.2.2.2.2.2.2" xref="S3.SS2.p2.12.m8.2.2.2.2.2.3.cmml">,</mo><mtext id="S3.SS2.p2.12.m8.1.1.1.1.1.1" xref="S3.SS2.p2.12.m8.1.1.1.1.1.1a.cmml">sf</mtext></mrow></msub></mrow><mrow id="S3.SS2.p2.12.m8.2.2.4" xref="S3.SS2.p2.12.m8.2.2.4.cmml"><mo rspace="0em" id="S3.SS2.p2.12.m8.2.2.4.1" xref="S3.SS2.p2.12.m8.2.2.4.1.cmml">∂</mo><mi id="S3.SS2.p2.12.m8.2.2.4.2" xref="S3.SS2.p2.12.m8.2.2.4.2.cmml">e</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m8.2b"><apply id="S3.SS2.p2.12.m8.2.2.cmml" xref="S3.SS2.p2.12.m8.2.2"><divide id="S3.SS2.p2.12.m8.2.2.3.cmml" xref="S3.SS2.p2.12.m8.2.2"></divide><apply id="S3.SS2.p2.12.m8.2.2.2.cmml" xref="S3.SS2.p2.12.m8.2.2.2"><partialdiff id="S3.SS2.p2.12.m8.2.2.2.3.cmml" xref="S3.SS2.p2.12.m8.2.2.2.3"></partialdiff><apply id="S3.SS2.p2.12.m8.2.2.2.4.cmml" xref="S3.SS2.p2.12.m8.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m8.2.2.2.4.1.cmml" xref="S3.SS2.p2.12.m8.2.2.2.4">subscript</csymbol><ci id="S3.SS2.p2.12.m8.2.2.2.4.2.cmml" xref="S3.SS2.p2.12.m8.2.2.2.4.2">ℎ</ci><list id="S3.SS2.p2.12.m8.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.12.m8.2.2.2.2.2.2"><apply id="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.12.m8.2.2.2.2.2.2.1"><minus id="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.1.cmml" xref="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.1"></minus><ci id="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.2.cmml" xref="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.2">𝑙</ci><cn type="integer" id="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.3.cmml" xref="S3.SS2.p2.12.m8.2.2.2.2.2.2.1.3">1</cn></apply><ci id="S3.SS2.p2.12.m8.1.1.1.1.1.1a.cmml" xref="S3.SS2.p2.12.m8.1.1.1.1.1.1"><mtext mathsize="50%" id="S3.SS2.p2.12.m8.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.12.m8.1.1.1.1.1.1">sf</mtext></ci></list></apply></apply><apply id="S3.SS2.p2.12.m8.2.2.4.cmml" xref="S3.SS2.p2.12.m8.2.2.4"><partialdiff id="S3.SS2.p2.12.m8.2.2.4.1.cmml" xref="S3.SS2.p2.12.m8.2.2.4.1"></partialdiff><ci id="S3.SS2.p2.12.m8.2.2.4.2.cmml" xref="S3.SS2.p2.12.m8.2.2.4.2">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m8.2c">\frac{\partial{h_{l-1,\text{sf}}}}{\partial{e}}</annotation></semantics></math> and <math id="S3.SS2.p2.13.m9.1" class="ltx_Math" alttext="[e]^{J}" display="inline"><semantics id="S3.SS2.p2.13.m9.1a"><msup id="S3.SS2.p2.13.m9.1.2" xref="S3.SS2.p2.13.m9.1.2.cmml"><mrow id="S3.SS2.p2.13.m9.1.2.2.2" xref="S3.SS2.p2.13.m9.1.2.2.1.cmml"><mo stretchy="false" id="S3.SS2.p2.13.m9.1.2.2.2.1" xref="S3.SS2.p2.13.m9.1.2.2.1.1.cmml">[</mo><mi id="S3.SS2.p2.13.m9.1.1" xref="S3.SS2.p2.13.m9.1.1.cmml">e</mi><mo stretchy="false" id="S3.SS2.p2.13.m9.1.2.2.2.2" xref="S3.SS2.p2.13.m9.1.2.2.1.1.cmml">]</mo></mrow><mi id="S3.SS2.p2.13.m9.1.2.3" xref="S3.SS2.p2.13.m9.1.2.3.cmml">J</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m9.1b"><apply id="S3.SS2.p2.13.m9.1.2.cmml" xref="S3.SS2.p2.13.m9.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m9.1.2.1.cmml" xref="S3.SS2.p2.13.m9.1.2">superscript</csymbol><apply id="S3.SS2.p2.13.m9.1.2.2.1.cmml" xref="S3.SS2.p2.13.m9.1.2.2.2"><csymbol cd="latexml" id="S3.SS2.p2.13.m9.1.2.2.1.1.cmml" xref="S3.SS2.p2.13.m9.1.2.2.2.1">delimited-[]</csymbol><ci id="S3.SS2.p2.13.m9.1.1.cmml" xref="S3.SS2.p2.13.m9.1.1">𝑒</ci></apply><ci id="S3.SS2.p2.13.m9.1.2.3.cmml" xref="S3.SS2.p2.13.m9.1.2.3">𝐽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m9.1c">[e]^{J}</annotation></semantics></math>, which could lead to a polynomial term <math id="S3.SS2.p2.14.m10.1" class="ltx_Math" alttext="A^{L-1}" display="inline"><semantics id="S3.SS2.p2.14.m10.1a"><msup id="S3.SS2.p2.14.m10.1.1" xref="S3.SS2.p2.14.m10.1.1.cmml"><mi id="S3.SS2.p2.14.m10.1.1.2" xref="S3.SS2.p2.14.m10.1.1.2.cmml">A</mi><mrow id="S3.SS2.p2.14.m10.1.1.3" xref="S3.SS2.p2.14.m10.1.1.3.cmml"><mi id="S3.SS2.p2.14.m10.1.1.3.2" xref="S3.SS2.p2.14.m10.1.1.3.2.cmml">L</mi><mo id="S3.SS2.p2.14.m10.1.1.3.1" xref="S3.SS2.p2.14.m10.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p2.14.m10.1.1.3.3" xref="S3.SS2.p2.14.m10.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.m10.1b"><apply id="S3.SS2.p2.14.m10.1.1.cmml" xref="S3.SS2.p2.14.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.14.m10.1.1.1.cmml" xref="S3.SS2.p2.14.m10.1.1">superscript</csymbol><ci id="S3.SS2.p2.14.m10.1.1.2.cmml" xref="S3.SS2.p2.14.m10.1.1.2">𝐴</ci><apply id="S3.SS2.p2.14.m10.1.1.3.cmml" xref="S3.SS2.p2.14.m10.1.1.3"><minus id="S3.SS2.p2.14.m10.1.1.3.1.cmml" xref="S3.SS2.p2.14.m10.1.1.3.1"></minus><ci id="S3.SS2.p2.14.m10.1.1.3.2.cmml" xref="S3.SS2.p2.14.m10.1.1.3.2">𝐿</ci><cn type="integer" id="S3.SS2.p2.14.m10.1.1.3.3.cmml" xref="S3.SS2.p2.14.m10.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.m10.1c">A^{L-1}</annotation></semantics></math> (resulted from <math id="S3.SS2.p2.15.m11.2" class="ltx_Math" alttext="[e]^{J}\odot\cdots\odot[e]^{J}" display="inline"><semantics id="S3.SS2.p2.15.m11.2a"><mrow id="S3.SS2.p2.15.m11.2.3" xref="S3.SS2.p2.15.m11.2.3.cmml"><msup id="S3.SS2.p2.15.m11.2.3.2" xref="S3.SS2.p2.15.m11.2.3.2.cmml"><mrow id="S3.SS2.p2.15.m11.2.3.2.2.2" xref="S3.SS2.p2.15.m11.2.3.2.2.1.cmml"><mo stretchy="false" id="S3.SS2.p2.15.m11.2.3.2.2.2.1" xref="S3.SS2.p2.15.m11.2.3.2.2.1.1.cmml">[</mo><mi id="S3.SS2.p2.15.m11.1.1" xref="S3.SS2.p2.15.m11.1.1.cmml">e</mi><mo stretchy="false" id="S3.SS2.p2.15.m11.2.3.2.2.2.2" xref="S3.SS2.p2.15.m11.2.3.2.2.1.1.cmml">]</mo></mrow><mi id="S3.SS2.p2.15.m11.2.3.2.3" xref="S3.SS2.p2.15.m11.2.3.2.3.cmml">J</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.15.m11.2.3.1" xref="S3.SS2.p2.15.m11.2.3.1.cmml">⊙</mo><mi mathvariant="normal" id="S3.SS2.p2.15.m11.2.3.3" xref="S3.SS2.p2.15.m11.2.3.3.cmml">⋯</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.15.m11.2.3.1a" xref="S3.SS2.p2.15.m11.2.3.1.cmml">⊙</mo><msup id="S3.SS2.p2.15.m11.2.3.4" xref="S3.SS2.p2.15.m11.2.3.4.cmml"><mrow id="S3.SS2.p2.15.m11.2.3.4.2.2" xref="S3.SS2.p2.15.m11.2.3.4.2.1.cmml"><mo stretchy="false" id="S3.SS2.p2.15.m11.2.3.4.2.2.1" xref="S3.SS2.p2.15.m11.2.3.4.2.1.1.cmml">[</mo><mi id="S3.SS2.p2.15.m11.2.2" xref="S3.SS2.p2.15.m11.2.2.cmml">e</mi><mo stretchy="false" id="S3.SS2.p2.15.m11.2.3.4.2.2.2" xref="S3.SS2.p2.15.m11.2.3.4.2.1.1.cmml">]</mo></mrow><mi id="S3.SS2.p2.15.m11.2.3.4.3" xref="S3.SS2.p2.15.m11.2.3.4.3.cmml">J</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.15.m11.2b"><apply id="S3.SS2.p2.15.m11.2.3.cmml" xref="S3.SS2.p2.15.m11.2.3"><csymbol cd="latexml" id="S3.SS2.p2.15.m11.2.3.1.cmml" xref="S3.SS2.p2.15.m11.2.3.1">direct-product</csymbol><apply id="S3.SS2.p2.15.m11.2.3.2.cmml" xref="S3.SS2.p2.15.m11.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.15.m11.2.3.2.1.cmml" xref="S3.SS2.p2.15.m11.2.3.2">superscript</csymbol><apply id="S3.SS2.p2.15.m11.2.3.2.2.1.cmml" xref="S3.SS2.p2.15.m11.2.3.2.2.2"><csymbol cd="latexml" id="S3.SS2.p2.15.m11.2.3.2.2.1.1.cmml" xref="S3.SS2.p2.15.m11.2.3.2.2.2.1">delimited-[]</csymbol><ci id="S3.SS2.p2.15.m11.1.1.cmml" xref="S3.SS2.p2.15.m11.1.1">𝑒</ci></apply><ci id="S3.SS2.p2.15.m11.2.3.2.3.cmml" xref="S3.SS2.p2.15.m11.2.3.2.3">𝐽</ci></apply><ci id="S3.SS2.p2.15.m11.2.3.3.cmml" xref="S3.SS2.p2.15.m11.2.3.3">⋯</ci><apply id="S3.SS2.p2.15.m11.2.3.4.cmml" xref="S3.SS2.p2.15.m11.2.3.4"><csymbol cd="ambiguous" id="S3.SS2.p2.15.m11.2.3.4.1.cmml" xref="S3.SS2.p2.15.m11.2.3.4">superscript</csymbol><apply id="S3.SS2.p2.15.m11.2.3.4.2.1.cmml" xref="S3.SS2.p2.15.m11.2.3.4.2.2"><csymbol cd="latexml" id="S3.SS2.p2.15.m11.2.3.4.2.1.1.cmml" xref="S3.SS2.p2.15.m11.2.3.4.2.2.1">delimited-[]</csymbol><ci id="S3.SS2.p2.15.m11.2.2.cmml" xref="S3.SS2.p2.15.m11.2.2">𝑒</ci></apply><ci id="S3.SS2.p2.15.m11.2.3.4.3.cmml" xref="S3.SS2.p2.15.m11.2.3.4.3">𝐽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.15.m11.2c">[e]^{J}\odot\cdots\odot[e]^{J}</annotation></semantics></math>, informally). Hence, we conclude: <span id="S3.SS2.p2.15.1" class="ltx_text ltx_font_italic">taking PANs as a switch could control the permutation invariance property of neural networks. The designed multiplicative PANs will make this switch more sensitive.</span></p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>FL with PANs</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we briefly introduce FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> and analyze the effects of PANs when applied to FL.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>FedAvg</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.14" class="ltx_p">Suppose we have a server and <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">K</annotation></semantics></math> clients with various data distributions. FedAvg first initializes a global model <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">θ</mi><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝜃</ci><cn type="integer" id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\theta_{0}</annotation></semantics></math> on the server. Then, a small fraction (i.e. <math id="S4.SS1.p1.3.m3.2" class="ltx_Math" alttext="R\in[0,1]" display="inline"><semantics id="S4.SS1.p1.3.m3.2a"><mrow id="S4.SS1.p1.3.m3.2.3" xref="S4.SS1.p1.3.m3.2.3.cmml"><mi id="S4.SS1.p1.3.m3.2.3.2" xref="S4.SS1.p1.3.m3.2.3.2.cmml">R</mi><mo id="S4.SS1.p1.3.m3.2.3.1" xref="S4.SS1.p1.3.m3.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p1.3.m3.2.3.3.2" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.2.3.3.2.1" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml">[</mo><mn id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">0</mn><mo id="S4.SS1.p1.3.m3.2.3.3.2.2" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p1.3.m3.2.2" xref="S4.SS1.p1.3.m3.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.p1.3.m3.2.3.3.2.3" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.2b"><apply id="S4.SS1.p1.3.m3.2.3.cmml" xref="S4.SS1.p1.3.m3.2.3"><in id="S4.SS1.p1.3.m3.2.3.1.cmml" xref="S4.SS1.p1.3.m3.2.3.1"></in><ci id="S4.SS1.p1.3.m3.2.3.2.cmml" xref="S4.SS1.p1.3.m3.2.3.2">𝑅</ci><interval closure="closed" id="S4.SS1.p1.3.m3.2.3.3.1.cmml" xref="S4.SS1.p1.3.m3.2.3.3.2"><cn type="integer" id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">0</cn><cn type="integer" id="S4.SS1.p1.3.m3.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.2c">R\in[0,1]</annotation></semantics></math>) of clients <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">S</mi><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝑆</ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">S_{t}</annotation></semantics></math> download the global model and update it on their local data for <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">E</annotation></semantics></math> epochs, and then upload the updated model <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="\theta_{0}^{(k)}" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><msubsup id="S4.SS1.p1.6.m6.1.2" xref="S4.SS1.p1.6.m6.1.2.cmml"><mi id="S4.SS1.p1.6.m6.1.2.2.2" xref="S4.SS1.p1.6.m6.1.2.2.2.cmml">θ</mi><mn id="S4.SS1.p1.6.m6.1.2.2.3" xref="S4.SS1.p1.6.m6.1.2.2.3.cmml">0</mn><mrow id="S4.SS1.p1.6.m6.1.1.1.3" xref="S4.SS1.p1.6.m6.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.6.m6.1.1.1.3.1" xref="S4.SS1.p1.6.m6.1.2.cmml">(</mo><mi id="S4.SS1.p1.6.m6.1.1.1.1" xref="S4.SS1.p1.6.m6.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S4.SS1.p1.6.m6.1.1.1.3.2" xref="S4.SS1.p1.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.2.cmml" xref="S4.SS1.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.2.1.cmml" xref="S4.SS1.p1.6.m6.1.2">superscript</csymbol><apply id="S4.SS1.p1.6.m6.1.2.2.cmml" xref="S4.SS1.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.2.2.1.cmml" xref="S4.SS1.p1.6.m6.1.2">subscript</csymbol><ci id="S4.SS1.p1.6.m6.1.2.2.2.cmml" xref="S4.SS1.p1.6.m6.1.2.2.2">𝜃</ci><cn type="integer" id="S4.SS1.p1.6.m6.1.2.2.3.cmml" xref="S4.SS1.p1.6.m6.1.2.2.3">0</cn></apply><ci id="S4.SS1.p1.6.m6.1.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">\theta_{0}^{(k)}</annotation></semantics></math> to the server. Then, the server takes a coordinate-based parameter averaging, i.e., <math id="S4.SS1.p1.7.m7.2" class="ltx_Math" alttext="\theta_{1}\leftarrow\frac{1}{|S_{t}|}\sum_{k\in S_{t}}\theta_{0}^{(k)}" display="inline"><semantics id="S4.SS1.p1.7.m7.2a"><mrow id="S4.SS1.p1.7.m7.2.3" xref="S4.SS1.p1.7.m7.2.3.cmml"><msub id="S4.SS1.p1.7.m7.2.3.2" xref="S4.SS1.p1.7.m7.2.3.2.cmml"><mi id="S4.SS1.p1.7.m7.2.3.2.2" xref="S4.SS1.p1.7.m7.2.3.2.2.cmml">θ</mi><mn id="S4.SS1.p1.7.m7.2.3.2.3" xref="S4.SS1.p1.7.m7.2.3.2.3.cmml">1</mn></msub><mo stretchy="false" id="S4.SS1.p1.7.m7.2.3.1" xref="S4.SS1.p1.7.m7.2.3.1.cmml">←</mo><mrow id="S4.SS1.p1.7.m7.2.3.3" xref="S4.SS1.p1.7.m7.2.3.3.cmml"><mfrac id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mn id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">1</mn><mrow id="S4.SS1.p1.7.m7.1.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.7.m7.1.1.1.1.2" xref="S4.SS1.p1.7.m7.1.1.1.2.1.cmml">|</mo><msub id="S4.SS1.p1.7.m7.1.1.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.2.cmml">S</mi><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S4.SS1.p1.7.m7.1.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.SS1.p1.7.m7.2.3.3.1" xref="S4.SS1.p1.7.m7.2.3.3.1.cmml">​</mo><mrow id="S4.SS1.p1.7.m7.2.3.3.2" xref="S4.SS1.p1.7.m7.2.3.3.2.cmml"><msub id="S4.SS1.p1.7.m7.2.3.3.2.1" xref="S4.SS1.p1.7.m7.2.3.3.2.1.cmml"><mo id="S4.SS1.p1.7.m7.2.3.3.2.1.2" xref="S4.SS1.p1.7.m7.2.3.3.2.1.2.cmml">∑</mo><mrow id="S4.SS1.p1.7.m7.2.3.3.2.1.3" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3.cmml"><mi id="S4.SS1.p1.7.m7.2.3.3.2.1.3.2" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3.2.cmml">k</mi><mo id="S4.SS1.p1.7.m7.2.3.3.2.1.3.1" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3.1.cmml">∈</mo><msub id="S4.SS1.p1.7.m7.2.3.3.2.1.3.3" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3.3.cmml"><mi id="S4.SS1.p1.7.m7.2.3.3.2.1.3.3.2" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3.3.2.cmml">S</mi><mi id="S4.SS1.p1.7.m7.2.3.3.2.1.3.3.3" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3.3.3.cmml">t</mi></msub></mrow></msub><msubsup id="S4.SS1.p1.7.m7.2.3.3.2.2" xref="S4.SS1.p1.7.m7.2.3.3.2.2.cmml"><mi id="S4.SS1.p1.7.m7.2.3.3.2.2.2.2" xref="S4.SS1.p1.7.m7.2.3.3.2.2.2.2.cmml">θ</mi><mn id="S4.SS1.p1.7.m7.2.3.3.2.2.2.3" xref="S4.SS1.p1.7.m7.2.3.3.2.2.2.3.cmml">0</mn><mrow id="S4.SS1.p1.7.m7.2.2.1.3" xref="S4.SS1.p1.7.m7.2.3.3.2.2.cmml"><mo stretchy="false" id="S4.SS1.p1.7.m7.2.2.1.3.1" xref="S4.SS1.p1.7.m7.2.3.3.2.2.cmml">(</mo><mi id="S4.SS1.p1.7.m7.2.2.1.1" xref="S4.SS1.p1.7.m7.2.2.1.1.cmml">k</mi><mo stretchy="false" id="S4.SS1.p1.7.m7.2.2.1.3.2" xref="S4.SS1.p1.7.m7.2.3.3.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.2b"><apply id="S4.SS1.p1.7.m7.2.3.cmml" xref="S4.SS1.p1.7.m7.2.3"><ci id="S4.SS1.p1.7.m7.2.3.1.cmml" xref="S4.SS1.p1.7.m7.2.3.1">←</ci><apply id="S4.SS1.p1.7.m7.2.3.2.cmml" xref="S4.SS1.p1.7.m7.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.2.3.2.1.cmml" xref="S4.SS1.p1.7.m7.2.3.2">subscript</csymbol><ci id="S4.SS1.p1.7.m7.2.3.2.2.cmml" xref="S4.SS1.p1.7.m7.2.3.2.2">𝜃</ci><cn type="integer" id="S4.SS1.p1.7.m7.2.3.2.3.cmml" xref="S4.SS1.p1.7.m7.2.3.2.3">1</cn></apply><apply id="S4.SS1.p1.7.m7.2.3.3.cmml" xref="S4.SS1.p1.7.m7.2.3.3"><times id="S4.SS1.p1.7.m7.2.3.3.1.cmml" xref="S4.SS1.p1.7.m7.2.3.3.1"></times><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><divide id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1"></divide><cn type="integer" id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3">1</cn><apply id="S4.SS1.p1.7.m7.1.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1"><abs id="S4.SS1.p1.7.m7.1.1.1.2.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.2"></abs><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.2">𝑆</ci><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S4.SS1.p1.7.m7.2.3.3.2.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2"><apply id="S4.SS1.p1.7.m7.2.3.3.2.1.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.2.3.3.2.1.1.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.1">subscript</csymbol><sum id="S4.SS1.p1.7.m7.2.3.3.2.1.2.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.1.2"></sum><apply id="S4.SS1.p1.7.m7.2.3.3.2.1.3.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3"><in id="S4.SS1.p1.7.m7.2.3.3.2.1.3.1.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3.1"></in><ci id="S4.SS1.p1.7.m7.2.3.3.2.1.3.2.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3.2">𝑘</ci><apply id="S4.SS1.p1.7.m7.2.3.3.2.1.3.3.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.2.3.3.2.1.3.3.1.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3.3">subscript</csymbol><ci id="S4.SS1.p1.7.m7.2.3.3.2.1.3.3.2.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3.3.2">𝑆</ci><ci id="S4.SS1.p1.7.m7.2.3.3.2.1.3.3.3.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S4.SS1.p1.7.m7.2.3.3.2.2.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.2.3.3.2.2.1.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.2">superscript</csymbol><apply id="S4.SS1.p1.7.m7.2.3.3.2.2.2.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.2.3.3.2.2.2.1.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.2">subscript</csymbol><ci id="S4.SS1.p1.7.m7.2.3.3.2.2.2.2.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.2.2.2">𝜃</ci><cn type="integer" id="S4.SS1.p1.7.m7.2.3.3.2.2.2.3.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2.2.2.3">0</cn></apply><ci id="S4.SS1.p1.7.m7.2.2.1.1.cmml" xref="S4.SS1.p1.7.m7.2.2.1.1">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.2c">\theta_{1}\leftarrow\frac{1}{|S_{t}|}\sum_{k\in S_{t}}\theta_{0}^{(k)}</annotation></semantics></math>. Next, <math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="\theta_{1}" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><msub id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml"><mi id="S4.SS1.p1.8.m8.1.1.2" xref="S4.SS1.p1.8.m8.1.1.2.cmml">θ</mi><mn id="S4.SS1.p1.8.m8.1.1.3" xref="S4.SS1.p1.8.m8.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><apply id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.1.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.p1.8.m8.1.1.2.cmml" xref="S4.SS1.p1.8.m8.1.1.2">𝜃</ci><cn type="integer" id="S4.SS1.p1.8.m8.1.1.3.cmml" xref="S4.SS1.p1.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">\theta_{1}</annotation></semantics></math> will be sent down for a new communication round. This will be repeated for <math id="S4.SS1.p1.9.m9.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S4.SS1.p1.9.m9.1a"><mi id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><ci id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">H</annotation></semantics></math> communication rounds. Because the parameters could be misaligned during local training, some works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> are devoted to finding the correspondences between clients’ uploaded neurons for better aggregation. For example, the parameters <math id="S4.SS1.p1.10.m10.1" class="ltx_Math" alttext="W_{l}^{(1)}" display="inline"><semantics id="S4.SS1.p1.10.m10.1a"><msubsup id="S4.SS1.p1.10.m10.1.2" xref="S4.SS1.p1.10.m10.1.2.cmml"><mi id="S4.SS1.p1.10.m10.1.2.2.2" xref="S4.SS1.p1.10.m10.1.2.2.2.cmml">W</mi><mi id="S4.SS1.p1.10.m10.1.2.2.3" xref="S4.SS1.p1.10.m10.1.2.2.3.cmml">l</mi><mrow id="S4.SS1.p1.10.m10.1.1.1.3" xref="S4.SS1.p1.10.m10.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.10.m10.1.1.1.3.1" xref="S4.SS1.p1.10.m10.1.2.cmml">(</mo><mn id="S4.SS1.p1.10.m10.1.1.1.1" xref="S4.SS1.p1.10.m10.1.1.1.1.cmml">1</mn><mo stretchy="false" id="S4.SS1.p1.10.m10.1.1.1.3.2" xref="S4.SS1.p1.10.m10.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><apply id="S4.SS1.p1.10.m10.1.2.cmml" xref="S4.SS1.p1.10.m10.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.2.1.cmml" xref="S4.SS1.p1.10.m10.1.2">superscript</csymbol><apply id="S4.SS1.p1.10.m10.1.2.2.cmml" xref="S4.SS1.p1.10.m10.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.2.2.1.cmml" xref="S4.SS1.p1.10.m10.1.2">subscript</csymbol><ci id="S4.SS1.p1.10.m10.1.2.2.2.cmml" xref="S4.SS1.p1.10.m10.1.2.2.2">𝑊</ci><ci id="S4.SS1.p1.10.m10.1.2.2.3.cmml" xref="S4.SS1.p1.10.m10.1.2.2.3">𝑙</ci></apply><cn type="integer" id="S4.SS1.p1.10.m10.1.1.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">W_{l}^{(1)}</annotation></semantics></math> and <math id="S4.SS1.p1.11.m11.1" class="ltx_Math" alttext="W_{l}^{(2)}" display="inline"><semantics id="S4.SS1.p1.11.m11.1a"><msubsup id="S4.SS1.p1.11.m11.1.2" xref="S4.SS1.p1.11.m11.1.2.cmml"><mi id="S4.SS1.p1.11.m11.1.2.2.2" xref="S4.SS1.p1.11.m11.1.2.2.2.cmml">W</mi><mi id="S4.SS1.p1.11.m11.1.2.2.3" xref="S4.SS1.p1.11.m11.1.2.2.3.cmml">l</mi><mrow id="S4.SS1.p1.11.m11.1.1.1.3" xref="S4.SS1.p1.11.m11.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.11.m11.1.1.1.3.1" xref="S4.SS1.p1.11.m11.1.2.cmml">(</mo><mn id="S4.SS1.p1.11.m11.1.1.1.1" xref="S4.SS1.p1.11.m11.1.1.1.1.cmml">2</mn><mo stretchy="false" id="S4.SS1.p1.11.m11.1.1.1.3.2" xref="S4.SS1.p1.11.m11.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><apply id="S4.SS1.p1.11.m11.1.2.cmml" xref="S4.SS1.p1.11.m11.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m11.1.2.1.cmml" xref="S4.SS1.p1.11.m11.1.2">superscript</csymbol><apply id="S4.SS1.p1.11.m11.1.2.2.cmml" xref="S4.SS1.p1.11.m11.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m11.1.2.2.1.cmml" xref="S4.SS1.p1.11.m11.1.2">subscript</csymbol><ci id="S4.SS1.p1.11.m11.1.2.2.2.cmml" xref="S4.SS1.p1.11.m11.1.2.2.2">𝑊</ci><ci id="S4.SS1.p1.11.m11.1.2.2.3.cmml" xref="S4.SS1.p1.11.m11.1.2.2.3">𝑙</ci></apply><cn type="integer" id="S4.SS1.p1.11.m11.1.1.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">W_{l}^{(2)}</annotation></semantics></math> may be misaligned, and we should search for proper matrices to match them, i.e., <math id="S4.SS1.p1.12.m12.3" class="ltx_Math" alttext="\frac{1}{2}(W_{l}^{(1)}+M_{l}W_{l}^{(2)}M_{l-1}^{T})" display="inline"><semantics id="S4.SS1.p1.12.m12.3a"><mrow id="S4.SS1.p1.12.m12.3.3" xref="S4.SS1.p1.12.m12.3.3.cmml"><mfrac id="S4.SS1.p1.12.m12.3.3.3" xref="S4.SS1.p1.12.m12.3.3.3.cmml"><mn id="S4.SS1.p1.12.m12.3.3.3.2" xref="S4.SS1.p1.12.m12.3.3.3.2.cmml">1</mn><mn id="S4.SS1.p1.12.m12.3.3.3.3" xref="S4.SS1.p1.12.m12.3.3.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S4.SS1.p1.12.m12.3.3.2" xref="S4.SS1.p1.12.m12.3.3.2.cmml">​</mo><mrow id="S4.SS1.p1.12.m12.3.3.1.1" xref="S4.SS1.p1.12.m12.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.12.m12.3.3.1.1.2" xref="S4.SS1.p1.12.m12.3.3.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.12.m12.3.3.1.1.1" xref="S4.SS1.p1.12.m12.3.3.1.1.1.cmml"><msubsup id="S4.SS1.p1.12.m12.3.3.1.1.1.2" xref="S4.SS1.p1.12.m12.3.3.1.1.1.2.cmml"><mi id="S4.SS1.p1.12.m12.3.3.1.1.1.2.2.2" xref="S4.SS1.p1.12.m12.3.3.1.1.1.2.2.2.cmml">W</mi><mi id="S4.SS1.p1.12.m12.3.3.1.1.1.2.2.3" xref="S4.SS1.p1.12.m12.3.3.1.1.1.2.2.3.cmml">l</mi><mrow id="S4.SS1.p1.12.m12.1.1.1.3" xref="S4.SS1.p1.12.m12.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.12.m12.1.1.1.3.1" xref="S4.SS1.p1.12.m12.3.3.1.1.1.2.cmml">(</mo><mn id="S4.SS1.p1.12.m12.1.1.1.1" xref="S4.SS1.p1.12.m12.1.1.1.1.cmml">1</mn><mo stretchy="false" id="S4.SS1.p1.12.m12.1.1.1.3.2" xref="S4.SS1.p1.12.m12.3.3.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p1.12.m12.3.3.1.1.1.1" xref="S4.SS1.p1.12.m12.3.3.1.1.1.1.cmml">+</mo><mrow id="S4.SS1.p1.12.m12.3.3.1.1.1.3" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.cmml"><msub id="S4.SS1.p1.12.m12.3.3.1.1.1.3.2" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.2.cmml"><mi id="S4.SS1.p1.12.m12.3.3.1.1.1.3.2.2" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.2.2.cmml">M</mi><mi id="S4.SS1.p1.12.m12.3.3.1.1.1.3.2.3" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.12.m12.3.3.1.1.1.3.1" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.1.cmml">​</mo><msubsup id="S4.SS1.p1.12.m12.3.3.1.1.1.3.3" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.cmml"><mi id="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.2.2" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.2.2.cmml">W</mi><mi id="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.2.3" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.2.3.cmml">l</mi><mrow id="S4.SS1.p1.12.m12.2.2.1.3" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.cmml"><mo stretchy="false" id="S4.SS1.p1.12.m12.2.2.1.3.1" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.cmml">(</mo><mn id="S4.SS1.p1.12.m12.2.2.1.1" xref="S4.SS1.p1.12.m12.2.2.1.1.cmml">2</mn><mo stretchy="false" id="S4.SS1.p1.12.m12.2.2.1.3.2" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.SS1.p1.12.m12.3.3.1.1.1.3.1a" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.1.cmml">​</mo><msubsup id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.cmml"><mi id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.2" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.2.cmml">M</mi><mrow id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.cmml"><mi id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.2" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.2.cmml">l</mi><mo id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.1" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.1.cmml">−</mo><mn id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.3" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.3" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.3.cmml">T</mi></msubsup></mrow></mrow><mo stretchy="false" id="S4.SS1.p1.12.m12.3.3.1.1.3" xref="S4.SS1.p1.12.m12.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.3b"><apply id="S4.SS1.p1.12.m12.3.3.cmml" xref="S4.SS1.p1.12.m12.3.3"><times id="S4.SS1.p1.12.m12.3.3.2.cmml" xref="S4.SS1.p1.12.m12.3.3.2"></times><apply id="S4.SS1.p1.12.m12.3.3.3.cmml" xref="S4.SS1.p1.12.m12.3.3.3"><divide id="S4.SS1.p1.12.m12.3.3.3.1.cmml" xref="S4.SS1.p1.12.m12.3.3.3"></divide><cn type="integer" id="S4.SS1.p1.12.m12.3.3.3.2.cmml" xref="S4.SS1.p1.12.m12.3.3.3.2">1</cn><cn type="integer" id="S4.SS1.p1.12.m12.3.3.3.3.cmml" xref="S4.SS1.p1.12.m12.3.3.3.3">2</cn></apply><apply id="S4.SS1.p1.12.m12.3.3.1.1.1.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1"><plus id="S4.SS1.p1.12.m12.3.3.1.1.1.1.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.1"></plus><apply id="S4.SS1.p1.12.m12.3.3.1.1.1.2.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.3.3.1.1.1.2.1.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.2">superscript</csymbol><apply id="S4.SS1.p1.12.m12.3.3.1.1.1.2.2.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.3.3.1.1.1.2.2.1.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.12.m12.3.3.1.1.1.2.2.2.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.2.2.2">𝑊</ci><ci id="S4.SS1.p1.12.m12.3.3.1.1.1.2.2.3.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.2.2.3">𝑙</ci></apply><cn type="integer" id="S4.SS1.p1.12.m12.1.1.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1.1.1">1</cn></apply><apply id="S4.SS1.p1.12.m12.3.3.1.1.1.3.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3"><times id="S4.SS1.p1.12.m12.3.3.1.1.1.3.1.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.1"></times><apply id="S4.SS1.p1.12.m12.3.3.1.1.1.3.2.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.3.3.1.1.1.3.2.1.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p1.12.m12.3.3.1.1.1.3.2.2.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.2.2">𝑀</ci><ci id="S4.SS1.p1.12.m12.3.3.1.1.1.3.2.3.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.2.3">𝑙</ci></apply><apply id="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.1.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.3">superscript</csymbol><apply id="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.2.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.2.1.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.2.2.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.2.2">𝑊</ci><ci id="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.2.3.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.3.2.3">𝑙</ci></apply><cn type="integer" id="S4.SS1.p1.12.m12.2.2.1.1.cmml" xref="S4.SS1.p1.12.m12.2.2.1.1">2</cn></apply><apply id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.1.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4">superscript</csymbol><apply id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.1.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4">subscript</csymbol><ci id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.2.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.2">𝑀</ci><apply id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3"><minus id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.1.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.1"></minus><ci id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.2.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.2">𝑙</ci><cn type="integer" id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.3.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.2.3.3">1</cn></apply></apply><ci id="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.3.cmml" xref="S4.SS1.p1.12.m12.3.3.1.1.1.3.4.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.3c">\frac{1}{2}(W_{l}^{(1)}+M_{l}W_{l}^{(2)}M_{l-1}^{T})</annotation></semantics></math>, rather than <math id="S4.SS1.p1.13.m13.3" class="ltx_Math" alttext="\frac{1}{2}(W_{l}^{(1)}+W_{l}^{(2)})" display="inline"><semantics id="S4.SS1.p1.13.m13.3a"><mrow id="S4.SS1.p1.13.m13.3.3" xref="S4.SS1.p1.13.m13.3.3.cmml"><mfrac id="S4.SS1.p1.13.m13.3.3.3" xref="S4.SS1.p1.13.m13.3.3.3.cmml"><mn id="S4.SS1.p1.13.m13.3.3.3.2" xref="S4.SS1.p1.13.m13.3.3.3.2.cmml">1</mn><mn id="S4.SS1.p1.13.m13.3.3.3.3" xref="S4.SS1.p1.13.m13.3.3.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S4.SS1.p1.13.m13.3.3.2" xref="S4.SS1.p1.13.m13.3.3.2.cmml">​</mo><mrow id="S4.SS1.p1.13.m13.3.3.1.1" xref="S4.SS1.p1.13.m13.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.13.m13.3.3.1.1.2" xref="S4.SS1.p1.13.m13.3.3.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.13.m13.3.3.1.1.1" xref="S4.SS1.p1.13.m13.3.3.1.1.1.cmml"><msubsup id="S4.SS1.p1.13.m13.3.3.1.1.1.2" xref="S4.SS1.p1.13.m13.3.3.1.1.1.2.cmml"><mi id="S4.SS1.p1.13.m13.3.3.1.1.1.2.2.2" xref="S4.SS1.p1.13.m13.3.3.1.1.1.2.2.2.cmml">W</mi><mi id="S4.SS1.p1.13.m13.3.3.1.1.1.2.2.3" xref="S4.SS1.p1.13.m13.3.3.1.1.1.2.2.3.cmml">l</mi><mrow id="S4.SS1.p1.13.m13.1.1.1.3" xref="S4.SS1.p1.13.m13.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.13.m13.1.1.1.3.1" xref="S4.SS1.p1.13.m13.3.3.1.1.1.2.cmml">(</mo><mn id="S4.SS1.p1.13.m13.1.1.1.1" xref="S4.SS1.p1.13.m13.1.1.1.1.cmml">1</mn><mo stretchy="false" id="S4.SS1.p1.13.m13.1.1.1.3.2" xref="S4.SS1.p1.13.m13.3.3.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p1.13.m13.3.3.1.1.1.1" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1.cmml">+</mo><msubsup id="S4.SS1.p1.13.m13.3.3.1.1.1.3" xref="S4.SS1.p1.13.m13.3.3.1.1.1.3.cmml"><mi id="S4.SS1.p1.13.m13.3.3.1.1.1.3.2.2" xref="S4.SS1.p1.13.m13.3.3.1.1.1.3.2.2.cmml">W</mi><mi id="S4.SS1.p1.13.m13.3.3.1.1.1.3.2.3" xref="S4.SS1.p1.13.m13.3.3.1.1.1.3.2.3.cmml">l</mi><mrow id="S4.SS1.p1.13.m13.2.2.1.3" xref="S4.SS1.p1.13.m13.3.3.1.1.1.3.cmml"><mo stretchy="false" id="S4.SS1.p1.13.m13.2.2.1.3.1" xref="S4.SS1.p1.13.m13.3.3.1.1.1.3.cmml">(</mo><mn id="S4.SS1.p1.13.m13.2.2.1.1" xref="S4.SS1.p1.13.m13.2.2.1.1.cmml">2</mn><mo stretchy="false" id="S4.SS1.p1.13.m13.2.2.1.3.2" xref="S4.SS1.p1.13.m13.3.3.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="S4.SS1.p1.13.m13.3.3.1.1.3" xref="S4.SS1.p1.13.m13.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.3b"><apply id="S4.SS1.p1.13.m13.3.3.cmml" xref="S4.SS1.p1.13.m13.3.3"><times id="S4.SS1.p1.13.m13.3.3.2.cmml" xref="S4.SS1.p1.13.m13.3.3.2"></times><apply id="S4.SS1.p1.13.m13.3.3.3.cmml" xref="S4.SS1.p1.13.m13.3.3.3"><divide id="S4.SS1.p1.13.m13.3.3.3.1.cmml" xref="S4.SS1.p1.13.m13.3.3.3"></divide><cn type="integer" id="S4.SS1.p1.13.m13.3.3.3.2.cmml" xref="S4.SS1.p1.13.m13.3.3.3.2">1</cn><cn type="integer" id="S4.SS1.p1.13.m13.3.3.3.3.cmml" xref="S4.SS1.p1.13.m13.3.3.3.3">2</cn></apply><apply id="S4.SS1.p1.13.m13.3.3.1.1.1.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1"><plus id="S4.SS1.p1.13.m13.3.3.1.1.1.1.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.1"></plus><apply id="S4.SS1.p1.13.m13.3.3.1.1.1.2.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.3.3.1.1.1.2.1.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.2">superscript</csymbol><apply id="S4.SS1.p1.13.m13.3.3.1.1.1.2.2.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.3.3.1.1.1.2.2.1.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.13.m13.3.3.1.1.1.2.2.2.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.2.2.2">𝑊</ci><ci id="S4.SS1.p1.13.m13.3.3.1.1.1.2.2.3.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.2.2.3">𝑙</ci></apply><cn type="integer" id="S4.SS1.p1.13.m13.1.1.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1.1.1">1</cn></apply><apply id="S4.SS1.p1.13.m13.3.3.1.1.1.3.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.3.3.1.1.1.3.1.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.3">superscript</csymbol><apply id="S4.SS1.p1.13.m13.3.3.1.1.1.3.2.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.3.3.1.1.1.3.2.1.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.13.m13.3.3.1.1.1.3.2.2.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.3.2.2">𝑊</ci><ci id="S4.SS1.p1.13.m13.3.3.1.1.1.3.2.3.cmml" xref="S4.SS1.p1.13.m13.3.3.1.1.1.3.2.3">𝑙</ci></apply><cn type="integer" id="S4.SS1.p1.13.m13.2.2.1.1.cmml" xref="S4.SS1.p1.13.m13.2.2.1.1">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.3c">\frac{1}{2}(W_{l}^{(1)}+W_{l}^{(2)})</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. However, searching for appropriate <math id="S4.SS1.p1.14.m14.2" class="ltx_Math" alttext="M_{\{l,l-1\}}" display="inline"><semantics id="S4.SS1.p1.14.m14.2a"><msub id="S4.SS1.p1.14.m14.2.3" xref="S4.SS1.p1.14.m14.2.3.cmml"><mi id="S4.SS1.p1.14.m14.2.3.2" xref="S4.SS1.p1.14.m14.2.3.2.cmml">M</mi><mrow id="S4.SS1.p1.14.m14.2.2.2.2" xref="S4.SS1.p1.14.m14.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p1.14.m14.2.2.2.2.2" xref="S4.SS1.p1.14.m14.2.2.2.3.cmml">{</mo><mi id="S4.SS1.p1.14.m14.1.1.1.1" xref="S4.SS1.p1.14.m14.1.1.1.1.cmml">l</mi><mo id="S4.SS1.p1.14.m14.2.2.2.2.3" xref="S4.SS1.p1.14.m14.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.p1.14.m14.2.2.2.2.1" xref="S4.SS1.p1.14.m14.2.2.2.2.1.cmml"><mi id="S4.SS1.p1.14.m14.2.2.2.2.1.2" xref="S4.SS1.p1.14.m14.2.2.2.2.1.2.cmml">l</mi><mo id="S4.SS1.p1.14.m14.2.2.2.2.1.1" xref="S4.SS1.p1.14.m14.2.2.2.2.1.1.cmml">−</mo><mn id="S4.SS1.p1.14.m14.2.2.2.2.1.3" xref="S4.SS1.p1.14.m14.2.2.2.2.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS1.p1.14.m14.2.2.2.2.4" xref="S4.SS1.p1.14.m14.2.2.2.3.cmml">}</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m14.2b"><apply id="S4.SS1.p1.14.m14.2.3.cmml" xref="S4.SS1.p1.14.m14.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.2.3.1.cmml" xref="S4.SS1.p1.14.m14.2.3">subscript</csymbol><ci id="S4.SS1.p1.14.m14.2.3.2.cmml" xref="S4.SS1.p1.14.m14.2.3.2">𝑀</ci><set id="S4.SS1.p1.14.m14.2.2.2.3.cmml" xref="S4.SS1.p1.14.m14.2.2.2.2"><ci id="S4.SS1.p1.14.m14.1.1.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1.1.1">𝑙</ci><apply id="S4.SS1.p1.14.m14.2.2.2.2.1.cmml" xref="S4.SS1.p1.14.m14.2.2.2.2.1"><minus id="S4.SS1.p1.14.m14.2.2.2.2.1.1.cmml" xref="S4.SS1.p1.14.m14.2.2.2.2.1.1"></minus><ci id="S4.SS1.p1.14.m14.2.2.2.2.1.2.cmml" xref="S4.SS1.p1.14.m14.2.2.2.2.1.2">𝑙</ci><cn type="integer" id="S4.SS1.p1.14.m14.2.2.2.2.1.3.cmml" xref="S4.SS1.p1.14.m14.2.2.2.2.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m14.2c">M_{\{l,l-1\}}</annotation></semantics></math> is challenging. Generally, these works require additional data to search for proper alignment. In addition, the matching process has typically to solve complex optimization problems, such as optimal transport or optimal assignment, leading to additional computational overhead. An intuitive question is: <span id="S4.SS1.p1.14.1" class="ltx_text ltx_font_italic">could we pre-align the neurons during local training instead of post-matching?</span></p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Applying PANs to FL</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Replacing traditional neurons with PANs in FL is straightforward to implement. Why does such a subtle improvement help? We heuristically expect PANs in FL could bring such effects: <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">PANs could limit the dislocation of neurons since the disturbance of them will bring significant changes to the outputs of the neural network and lead to higher training errors and fluctuations</span>. Theoretically, the forward pass on the <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">k</annotation></semantics></math>th client with PANs is as follows:</p>
<table id="A6.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E12.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{+}:~{}h_{l}^{(k)}" display="inline"><semantics id="S4.E12.m1.1a"><mrow id="S4.E12.m1.1.2" xref="S4.E12.m1.1.2.cmml"><msub id="S4.E12.m1.1.2.2" xref="S4.E12.m1.1.2.2.cmml"><mtext id="S4.E12.m1.1.2.2.2" xref="S4.E12.m1.1.2.2.2a.cmml">PAN</mtext><mo id="S4.E12.m1.1.2.2.3" xref="S4.E12.m1.1.2.2.3.cmml">+</mo></msub><mo lspace="0.278em" rspace="0.608em" id="S4.E12.m1.1.2.1" xref="S4.E12.m1.1.2.1.cmml">:</mo><msubsup id="S4.E12.m1.1.2.3" xref="S4.E12.m1.1.2.3.cmml"><mi id="S4.E12.m1.1.2.3.2.2" xref="S4.E12.m1.1.2.3.2.2.cmml">h</mi><mi id="S4.E12.m1.1.2.3.2.3" xref="S4.E12.m1.1.2.3.2.3.cmml">l</mi><mrow id="S4.E12.m1.1.1.1.3" xref="S4.E12.m1.1.2.3.cmml"><mo stretchy="false" id="S4.E12.m1.1.1.1.3.1" xref="S4.E12.m1.1.2.3.cmml">(</mo><mi id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S4.E12.m1.1.1.1.3.2" xref="S4.E12.m1.1.2.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.1b"><apply id="S4.E12.m1.1.2.cmml" xref="S4.E12.m1.1.2"><ci id="S4.E12.m1.1.2.1.cmml" xref="S4.E12.m1.1.2.1">:</ci><apply id="S4.E12.m1.1.2.2.cmml" xref="S4.E12.m1.1.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.2.2.1.cmml" xref="S4.E12.m1.1.2.2">subscript</csymbol><ci id="S4.E12.m1.1.2.2.2a.cmml" xref="S4.E12.m1.1.2.2.2"><mtext id="S4.E12.m1.1.2.2.2.cmml" xref="S4.E12.m1.1.2.2.2">PAN</mtext></ci><plus id="S4.E12.m1.1.2.2.3.cmml" xref="S4.E12.m1.1.2.2.3"></plus></apply><apply id="S4.E12.m1.1.2.3.cmml" xref="S4.E12.m1.1.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.2.3.1.cmml" xref="S4.E12.m1.1.2.3">superscript</csymbol><apply id="S4.E12.m1.1.2.3.2.cmml" xref="S4.E12.m1.1.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.2.3.2.1.cmml" xref="S4.E12.m1.1.2.3">subscript</csymbol><ci id="S4.E12.m1.1.2.3.2.2.cmml" xref="S4.E12.m1.1.2.3.2.2">ℎ</ci><ci id="S4.E12.m1.1.2.3.2.3.cmml" xref="S4.E12.m1.1.2.3.2.3">𝑙</ci></apply><ci id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.1c">\displaystyle\text{PAN}_{+}:~{}h_{l}^{(k)}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E12.m2.5" class="ltx_Math" alttext="\displaystyle=f_{l}^{(k)}(W_{l}^{(k)}h_{l-1}^{(k)}+b_{l}^{(k)}+\underline{e_{l}})," display="inline"><semantics id="S4.E12.m2.5a"><mrow id="S4.E12.m2.5.5.1" xref="S4.E12.m2.5.5.1.1.cmml"><mrow id="S4.E12.m2.5.5.1.1" xref="S4.E12.m2.5.5.1.1.cmml"><mi id="S4.E12.m2.5.5.1.1.3" xref="S4.E12.m2.5.5.1.1.3.cmml"></mi><mo id="S4.E12.m2.5.5.1.1.2" xref="S4.E12.m2.5.5.1.1.2.cmml">=</mo><mrow id="S4.E12.m2.5.5.1.1.1" xref="S4.E12.m2.5.5.1.1.1.cmml"><msubsup id="S4.E12.m2.5.5.1.1.1.3" xref="S4.E12.m2.5.5.1.1.1.3.cmml"><mi id="S4.E12.m2.5.5.1.1.1.3.2.2" xref="S4.E12.m2.5.5.1.1.1.3.2.2.cmml">f</mi><mi id="S4.E12.m2.5.5.1.1.1.3.2.3" xref="S4.E12.m2.5.5.1.1.1.3.2.3.cmml">l</mi><mrow id="S4.E12.m2.1.1.1.3" xref="S4.E12.m2.5.5.1.1.1.3.cmml"><mo stretchy="false" id="S4.E12.m2.1.1.1.3.1" xref="S4.E12.m2.5.5.1.1.1.3.cmml">(</mo><mi id="S4.E12.m2.1.1.1.1" xref="S4.E12.m2.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S4.E12.m2.1.1.1.3.2" xref="S4.E12.m2.5.5.1.1.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E12.m2.5.5.1.1.1.2" xref="S4.E12.m2.5.5.1.1.1.2.cmml">​</mo><mrow id="S4.E12.m2.5.5.1.1.1.1.1" xref="S4.E12.m2.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E12.m2.5.5.1.1.1.1.1.2" xref="S4.E12.m2.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E12.m2.5.5.1.1.1.1.1.1" xref="S4.E12.m2.5.5.1.1.1.1.1.1.cmml"><mrow id="S4.E12.m2.5.5.1.1.1.1.1.1.2" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.cmml"><msubsup id="S4.E12.m2.5.5.1.1.1.1.1.1.2.2" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.2.2" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.2.2.cmml">W</mi><mi id="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.2.3" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.2.3.cmml">l</mi><mrow id="S4.E12.m2.2.2.1.3" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S4.E12.m2.2.2.1.3.1" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.cmml">(</mo><mi id="S4.E12.m2.2.2.1.1" xref="S4.E12.m2.2.2.1.1.cmml">k</mi><mo stretchy="false" id="S4.E12.m2.2.2.1.3.2" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E12.m2.5.5.1.1.1.1.1.1.2.1" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.2" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.2.cmml">h</mi><mrow id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.cmml"><mi id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.2" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.2.cmml">l</mi><mo id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.1" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.1.cmml">−</mo><mn id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.3" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S4.E12.m2.3.3.1.3" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.E12.m2.3.3.1.3.1" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.cmml">(</mo><mi id="S4.E12.m2.3.3.1.1" xref="S4.E12.m2.3.3.1.1.cmml">k</mi><mo stretchy="false" id="S4.E12.m2.3.3.1.3.2" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.E12.m2.5.5.1.1.1.1.1.1.1" xref="S4.E12.m2.5.5.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="S4.E12.m2.5.5.1.1.1.1.1.1.3" xref="S4.E12.m2.5.5.1.1.1.1.1.1.3.cmml"><mi id="S4.E12.m2.5.5.1.1.1.1.1.1.3.2.2" xref="S4.E12.m2.5.5.1.1.1.1.1.1.3.2.2.cmml">b</mi><mi id="S4.E12.m2.5.5.1.1.1.1.1.1.3.2.3" xref="S4.E12.m2.5.5.1.1.1.1.1.1.3.2.3.cmml">l</mi><mrow id="S4.E12.m2.4.4.1.3" xref="S4.E12.m2.5.5.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E12.m2.4.4.1.3.1" xref="S4.E12.m2.5.5.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E12.m2.4.4.1.1" xref="S4.E12.m2.4.4.1.1.cmml">k</mi><mo stretchy="false" id="S4.E12.m2.4.4.1.3.2" xref="S4.E12.m2.5.5.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup><mo id="S4.E12.m2.5.5.1.1.1.1.1.1.1a" xref="S4.E12.m2.5.5.1.1.1.1.1.1.1.cmml">+</mo><munder accentunder="true" id="S4.E12.m2.5.5.1.1.1.1.1.1.4" xref="S4.E12.m2.5.5.1.1.1.1.1.1.4.cmml"><msub id="S4.E12.m2.5.5.1.1.1.1.1.1.4.2" xref="S4.E12.m2.5.5.1.1.1.1.1.1.4.2.cmml"><mi id="S4.E12.m2.5.5.1.1.1.1.1.1.4.2.2" xref="S4.E12.m2.5.5.1.1.1.1.1.1.4.2.2.cmml">e</mi><mi id="S4.E12.m2.5.5.1.1.1.1.1.1.4.2.3" xref="S4.E12.m2.5.5.1.1.1.1.1.1.4.2.3.cmml">l</mi></msub><mo id="S4.E12.m2.5.5.1.1.1.1.1.1.4.1" xref="S4.E12.m2.5.5.1.1.1.1.1.1.4.1.cmml">¯</mo></munder></mrow><mo stretchy="false" id="S4.E12.m2.5.5.1.1.1.1.1.3" xref="S4.E12.m2.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E12.m2.5.5.1.2" xref="S4.E12.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m2.5b"><apply id="S4.E12.m2.5.5.1.1.cmml" xref="S4.E12.m2.5.5.1"><eq id="S4.E12.m2.5.5.1.1.2.cmml" xref="S4.E12.m2.5.5.1.1.2"></eq><csymbol cd="latexml" id="S4.E12.m2.5.5.1.1.3.cmml" xref="S4.E12.m2.5.5.1.1.3">absent</csymbol><apply id="S4.E12.m2.5.5.1.1.1.cmml" xref="S4.E12.m2.5.5.1.1.1"><times id="S4.E12.m2.5.5.1.1.1.2.cmml" xref="S4.E12.m2.5.5.1.1.1.2"></times><apply id="S4.E12.m2.5.5.1.1.1.3.cmml" xref="S4.E12.m2.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m2.5.5.1.1.1.3.1.cmml" xref="S4.E12.m2.5.5.1.1.1.3">superscript</csymbol><apply id="S4.E12.m2.5.5.1.1.1.3.2.cmml" xref="S4.E12.m2.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m2.5.5.1.1.1.3.2.1.cmml" xref="S4.E12.m2.5.5.1.1.1.3">subscript</csymbol><ci id="S4.E12.m2.5.5.1.1.1.3.2.2.cmml" xref="S4.E12.m2.5.5.1.1.1.3.2.2">𝑓</ci><ci id="S4.E12.m2.5.5.1.1.1.3.2.3.cmml" xref="S4.E12.m2.5.5.1.1.1.3.2.3">𝑙</ci></apply><ci id="S4.E12.m2.1.1.1.1.cmml" xref="S4.E12.m2.1.1.1.1">𝑘</ci></apply><apply id="S4.E12.m2.5.5.1.1.1.1.1.1.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1"><plus id="S4.E12.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.1"></plus><apply id="S4.E12.m2.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2"><times id="S4.E12.m2.5.5.1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.1"></times><apply id="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.2.2">𝑊</ci><ci id="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.2.2.3">𝑙</ci></apply><ci id="S4.E12.m2.2.2.1.1.cmml" xref="S4.E12.m2.2.2.1.1">𝑘</ci></apply><apply id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.1.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.2.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.2">ℎ</ci><apply id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3"><minus id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.1.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.1"></minus><ci id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.2.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.2">𝑙</ci><cn type="integer" id="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.3.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E12.m2.3.3.1.1.cmml" xref="S4.E12.m2.3.3.1.1">𝑘</ci></apply></apply><apply id="S4.E12.m2.5.5.1.1.1.1.1.1.3.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m2.5.5.1.1.1.1.1.1.3.1.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E12.m2.5.5.1.1.1.1.1.1.3.2.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m2.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E12.m2.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.3.2.2">𝑏</ci><ci id="S4.E12.m2.5.5.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S4.E12.m2.4.4.1.1.cmml" xref="S4.E12.m2.4.4.1.1">𝑘</ci></apply><apply id="S4.E12.m2.5.5.1.1.1.1.1.1.4.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.4"><ci id="S4.E12.m2.5.5.1.1.1.1.1.1.4.1.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.4.1">¯</ci><apply id="S4.E12.m2.5.5.1.1.1.1.1.1.4.2.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S4.E12.m2.5.5.1.1.1.1.1.1.4.2.1.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S4.E12.m2.5.5.1.1.1.1.1.1.4.2.2.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.4.2.2">𝑒</ci><ci id="S4.E12.m2.5.5.1.1.1.1.1.1.4.2.3.cmml" xref="S4.E12.m2.5.5.1.1.1.1.1.1.4.2.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m2.5c">\displaystyle=f_{l}^{(k)}(W_{l}^{(k)}h_{l-1}^{(k)}+b_{l}^{(k)}+\underline{e_{l}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="S4.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E13.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{\circ}:~{}h_{l}^{(k)}" display="inline"><semantics id="S4.E13.m1.1a"><mrow id="S4.E13.m1.1.2" xref="S4.E13.m1.1.2.cmml"><msub id="S4.E13.m1.1.2.2" xref="S4.E13.m1.1.2.2.cmml"><mtext id="S4.E13.m1.1.2.2.2" xref="S4.E13.m1.1.2.2.2a.cmml">PAN</mtext><mo id="S4.E13.m1.1.2.2.3" xref="S4.E13.m1.1.2.2.3.cmml">∘</mo></msub><mo lspace="0.278em" rspace="0.608em" id="S4.E13.m1.1.2.1" xref="S4.E13.m1.1.2.1.cmml">:</mo><msubsup id="S4.E13.m1.1.2.3" xref="S4.E13.m1.1.2.3.cmml"><mi id="S4.E13.m1.1.2.3.2.2" xref="S4.E13.m1.1.2.3.2.2.cmml">h</mi><mi id="S4.E13.m1.1.2.3.2.3" xref="S4.E13.m1.1.2.3.2.3.cmml">l</mi><mrow id="S4.E13.m1.1.1.1.3" xref="S4.E13.m1.1.2.3.cmml"><mo stretchy="false" id="S4.E13.m1.1.1.1.3.1" xref="S4.E13.m1.1.2.3.cmml">(</mo><mi id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S4.E13.m1.1.1.1.3.2" xref="S4.E13.m1.1.2.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.1b"><apply id="S4.E13.m1.1.2.cmml" xref="S4.E13.m1.1.2"><ci id="S4.E13.m1.1.2.1.cmml" xref="S4.E13.m1.1.2.1">:</ci><apply id="S4.E13.m1.1.2.2.cmml" xref="S4.E13.m1.1.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.2.2.1.cmml" xref="S4.E13.m1.1.2.2">subscript</csymbol><ci id="S4.E13.m1.1.2.2.2a.cmml" xref="S4.E13.m1.1.2.2.2"><mtext id="S4.E13.m1.1.2.2.2.cmml" xref="S4.E13.m1.1.2.2.2">PAN</mtext></ci><compose id="S4.E13.m1.1.2.2.3.cmml" xref="S4.E13.m1.1.2.2.3"></compose></apply><apply id="S4.E13.m1.1.2.3.cmml" xref="S4.E13.m1.1.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.2.3.1.cmml" xref="S4.E13.m1.1.2.3">superscript</csymbol><apply id="S4.E13.m1.1.2.3.2.cmml" xref="S4.E13.m1.1.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.2.3.2.1.cmml" xref="S4.E13.m1.1.2.3">subscript</csymbol><ci id="S4.E13.m1.1.2.3.2.2.cmml" xref="S4.E13.m1.1.2.3.2.2">ℎ</ci><ci id="S4.E13.m1.1.2.3.2.3.cmml" xref="S4.E13.m1.1.2.3.2.3">𝑙</ci></apply><ci id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.1c">\displaystyle\text{PAN}_{\circ}:~{}h_{l}^{(k)}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E13.m2.5" class="ltx_Math" alttext="\displaystyle=f_{l}^{(k)}((W_{l}^{(k)}h_{l-1}^{(k)}+b_{l}^{(k)})\odot\underline{e_{l}})." display="inline"><semantics id="S4.E13.m2.5a"><mrow id="S4.E13.m2.5.5.1" xref="S4.E13.m2.5.5.1.1.cmml"><mrow id="S4.E13.m2.5.5.1.1" xref="S4.E13.m2.5.5.1.1.cmml"><mi id="S4.E13.m2.5.5.1.1.3" xref="S4.E13.m2.5.5.1.1.3.cmml"></mi><mo id="S4.E13.m2.5.5.1.1.2" xref="S4.E13.m2.5.5.1.1.2.cmml">=</mo><mrow id="S4.E13.m2.5.5.1.1.1" xref="S4.E13.m2.5.5.1.1.1.cmml"><msubsup id="S4.E13.m2.5.5.1.1.1.3" xref="S4.E13.m2.5.5.1.1.1.3.cmml"><mi id="S4.E13.m2.5.5.1.1.1.3.2.2" xref="S4.E13.m2.5.5.1.1.1.3.2.2.cmml">f</mi><mi id="S4.E13.m2.5.5.1.1.1.3.2.3" xref="S4.E13.m2.5.5.1.1.1.3.2.3.cmml">l</mi><mrow id="S4.E13.m2.1.1.1.3" xref="S4.E13.m2.5.5.1.1.1.3.cmml"><mo stretchy="false" id="S4.E13.m2.1.1.1.3.1" xref="S4.E13.m2.5.5.1.1.1.3.cmml">(</mo><mi id="S4.E13.m2.1.1.1.1" xref="S4.E13.m2.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S4.E13.m2.1.1.1.3.2" xref="S4.E13.m2.5.5.1.1.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E13.m2.5.5.1.1.1.2" xref="S4.E13.m2.5.5.1.1.1.2.cmml">​</mo><mrow id="S4.E13.m2.5.5.1.1.1.1.1" xref="S4.E13.m2.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E13.m2.5.5.1.1.1.1.1.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m2.5.5.1.1.1.1.1.1" xref="S4.E13.m2.5.5.1.1.1.1.1.1.cmml"><mrow id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><msubsup id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">W</mi><mi id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">l</mi><mrow id="S4.E13.m2.2.2.1.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S4.E13.m2.2.2.1.3.1" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">(</mo><mi id="S4.E13.m2.2.2.1.1" xref="S4.E13.m2.2.2.1.1.cmml">k</mi><mo stretchy="false" id="S4.E13.m2.2.2.1.3.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml">h</mi><mrow id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml"><mi id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.2.cmml">l</mi><mo id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.1" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.1.cmml">−</mo><mn id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S4.E13.m2.3.3.1.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.E13.m2.3.3.1.3.1" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><mi id="S4.E13.m2.3.3.1.1" xref="S4.E13.m2.3.3.1.1.cmml">k</mi><mo stretchy="false" id="S4.E13.m2.3.3.1.3.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.1" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml">b</mi><mi id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.3.cmml">l</mi><mrow id="S4.E13.m2.4.4.1.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E13.m2.4.4.1.3.1" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E13.m2.4.4.1.1" xref="S4.E13.m2.4.4.1.1.cmml">k</mi><mo stretchy="false" id="S4.E13.m2.4.4.1.3.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo rspace="0.055em" stretchy="false" id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.E13.m2.5.5.1.1.1.1.1.1.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.2.cmml">⊙</mo><munder accentunder="true" id="S4.E13.m2.5.5.1.1.1.1.1.1.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.3.cmml"><msub id="S4.E13.m2.5.5.1.1.1.1.1.1.3.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E13.m2.5.5.1.1.1.1.1.1.3.2.2" xref="S4.E13.m2.5.5.1.1.1.1.1.1.3.2.2.cmml">e</mi><mi id="S4.E13.m2.5.5.1.1.1.1.1.1.3.2.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.3.2.3.cmml">l</mi></msub><mo id="S4.E13.m2.5.5.1.1.1.1.1.1.3.1" xref="S4.E13.m2.5.5.1.1.1.1.1.1.3.1.cmml">¯</mo></munder></mrow><mo stretchy="false" id="S4.E13.m2.5.5.1.1.1.1.1.3" xref="S4.E13.m2.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S4.E13.m2.5.5.1.2" xref="S4.E13.m2.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m2.5b"><apply id="S4.E13.m2.5.5.1.1.cmml" xref="S4.E13.m2.5.5.1"><eq id="S4.E13.m2.5.5.1.1.2.cmml" xref="S4.E13.m2.5.5.1.1.2"></eq><csymbol cd="latexml" id="S4.E13.m2.5.5.1.1.3.cmml" xref="S4.E13.m2.5.5.1.1.3">absent</csymbol><apply id="S4.E13.m2.5.5.1.1.1.cmml" xref="S4.E13.m2.5.5.1.1.1"><times id="S4.E13.m2.5.5.1.1.1.2.cmml" xref="S4.E13.m2.5.5.1.1.1.2"></times><apply id="S4.E13.m2.5.5.1.1.1.3.cmml" xref="S4.E13.m2.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m2.5.5.1.1.1.3.1.cmml" xref="S4.E13.m2.5.5.1.1.1.3">superscript</csymbol><apply id="S4.E13.m2.5.5.1.1.1.3.2.cmml" xref="S4.E13.m2.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m2.5.5.1.1.1.3.2.1.cmml" xref="S4.E13.m2.5.5.1.1.1.3">subscript</csymbol><ci id="S4.E13.m2.5.5.1.1.1.3.2.2.cmml" xref="S4.E13.m2.5.5.1.1.1.3.2.2">𝑓</ci><ci id="S4.E13.m2.5.5.1.1.1.3.2.3.cmml" xref="S4.E13.m2.5.5.1.1.1.3.2.3">𝑙</ci></apply><ci id="S4.E13.m2.1.1.1.1.cmml" xref="S4.E13.m2.1.1.1.1">𝑘</ci></apply><apply id="S4.E13.m2.5.5.1.1.1.1.1.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S4.E13.m2.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1"><plus id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2"><times id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑊</ci><ci id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑙</ci></apply><ci id="S4.E13.m2.2.2.1.1.cmml" xref="S4.E13.m2.2.2.1.1">𝑘</ci></apply><apply id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.2">ℎ</ci><apply id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3"><minus id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.1"></minus><ci id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.2.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.2">𝑙</ci><cn type="integer" id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.3.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E13.m2.3.3.1.1.cmml" xref="S4.E13.m2.3.3.1.1">𝑘</ci></apply></apply><apply id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.2">𝑏</ci><ci id="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S4.E13.m2.4.4.1.1.cmml" xref="S4.E13.m2.4.4.1.1">𝑘</ci></apply></apply><apply id="S4.E13.m2.5.5.1.1.1.1.1.1.3.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.3"><ci id="S4.E13.m2.5.5.1.1.1.1.1.1.3.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.3.1">¯</ci><apply id="S4.E13.m2.5.5.1.1.1.1.1.1.3.2.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E13.m2.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E13.m2.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.3.2.2">𝑒</ci><ci id="S4.E13.m2.5.5.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E13.m2.5.5.1.1.1.1.1.1.3.2.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m2.5c">\displaystyle=f_{l}^{(k)}((W_{l}^{(k)}h_{l-1}^{(k)}+b_{l}^{(k)})\odot\underline{e_{l}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.13" class="ltx_p">Notably, the position encodings are commonly utilized across clients, i.e., the forward pass across local clients share some consistent information. Then, the parameters’ gradient of Eq. <a href="#S4.E12" title="Equation 12 ‣ 4.2 Applying PANs to FL ‣ 4 FL with PANs ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> and Eq. <a href="#S4.E13" title="Equation 13 ‣ 4.2 Applying PANs to FL ‣ 4 FL with PANs ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a> can be calculated by:</p>
<table id="A6.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E14.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{+}" display="inline"><semantics id="S4.E14.m1.1a"><msub id="S4.E14.m1.1.1" xref="S4.E14.m1.1.1.cmml"><mtext id="S4.E14.m1.1.1.2" xref="S4.E14.m1.1.1.2a.cmml">PAN</mtext><mo id="S4.E14.m1.1.1.3" xref="S4.E14.m1.1.1.3.cmml">+</mo></msub><annotation-xml encoding="MathML-Content" id="S4.E14.m1.1b"><apply id="S4.E14.m1.1.1.cmml" xref="S4.E14.m1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.cmml" xref="S4.E14.m1.1.1">subscript</csymbol><ci id="S4.E14.m1.1.1.2a.cmml" xref="S4.E14.m1.1.1.2"><mtext id="S4.E14.m1.1.1.2.cmml" xref="S4.E14.m1.1.1.2">PAN</mtext></ci><plus id="S4.E14.m1.1.1.3.cmml" xref="S4.E14.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.1c">\displaystyle\text{PAN}_{+}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E14.m2.4" class="ltx_Math" alttext="\displaystyle:~{}\partial{h_{l}^{(k)}}/\partial{b_{l}^{(k)}}=\text{D}({f_{l}^{(k)}}^{\prime})," display="inline"><semantics id="S4.E14.m2.4a"><mrow id="S4.E14.m2.4.4.1" xref="S4.E14.m2.4.4.1.1.cmml"><mrow id="S4.E14.m2.4.4.1.1" xref="S4.E14.m2.4.4.1.1.cmml"><mi id="S4.E14.m2.4.4.1.1.3" xref="S4.E14.m2.4.4.1.1.3.cmml"></mi><mo lspace="0.278em" rspace="0.330em" id="S4.E14.m2.4.4.1.1.2" xref="S4.E14.m2.4.4.1.1.2.cmml">:</mo><mrow id="S4.E14.m2.4.4.1.1.1" xref="S4.E14.m2.4.4.1.1.1.cmml"><mrow id="S4.E14.m2.4.4.1.1.1.3" xref="S4.E14.m2.4.4.1.1.1.3.cmml"><mo rspace="0em" id="S4.E14.m2.4.4.1.1.1.3.1" xref="S4.E14.m2.4.4.1.1.1.3.1.cmml">∂</mo><mrow id="S4.E14.m2.4.4.1.1.1.3.2" xref="S4.E14.m2.4.4.1.1.1.3.2.cmml"><msubsup id="S4.E14.m2.4.4.1.1.1.3.2.2" xref="S4.E14.m2.4.4.1.1.1.3.2.2.cmml"><mi id="S4.E14.m2.4.4.1.1.1.3.2.2.2.2" xref="S4.E14.m2.4.4.1.1.1.3.2.2.2.2.cmml">h</mi><mi id="S4.E14.m2.4.4.1.1.1.3.2.2.2.3" xref="S4.E14.m2.4.4.1.1.1.3.2.2.2.3.cmml">l</mi><mrow id="S4.E14.m2.1.1.1.3" xref="S4.E14.m2.4.4.1.1.1.3.2.2.cmml"><mo stretchy="false" id="S4.E14.m2.1.1.1.3.1" xref="S4.E14.m2.4.4.1.1.1.3.2.2.cmml">(</mo><mi id="S4.E14.m2.1.1.1.1" xref="S4.E14.m2.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S4.E14.m2.1.1.1.3.2" xref="S4.E14.m2.4.4.1.1.1.3.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.E14.m2.4.4.1.1.1.3.2.1" xref="S4.E14.m2.4.4.1.1.1.3.2.1.cmml">/</mo><mrow id="S4.E14.m2.4.4.1.1.1.3.2.3" xref="S4.E14.m2.4.4.1.1.1.3.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.E14.m2.4.4.1.1.1.3.2.3.1" xref="S4.E14.m2.4.4.1.1.1.3.2.3.1.cmml">∂</mo><msubsup id="S4.E14.m2.4.4.1.1.1.3.2.3.2" xref="S4.E14.m2.4.4.1.1.1.3.2.3.2.cmml"><mi id="S4.E14.m2.4.4.1.1.1.3.2.3.2.2.2" xref="S4.E14.m2.4.4.1.1.1.3.2.3.2.2.2.cmml">b</mi><mi id="S4.E14.m2.4.4.1.1.1.3.2.3.2.2.3" xref="S4.E14.m2.4.4.1.1.1.3.2.3.2.2.3.cmml">l</mi><mrow id="S4.E14.m2.2.2.1.3" xref="S4.E14.m2.4.4.1.1.1.3.2.3.2.cmml"><mo stretchy="false" id="S4.E14.m2.2.2.1.3.1" xref="S4.E14.m2.4.4.1.1.1.3.2.3.2.cmml">(</mo><mi id="S4.E14.m2.2.2.1.1" xref="S4.E14.m2.2.2.1.1.cmml">k</mi><mo stretchy="false" id="S4.E14.m2.2.2.1.3.2" xref="S4.E14.m2.4.4.1.1.1.3.2.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S4.E14.m2.4.4.1.1.1.2" xref="S4.E14.m2.4.4.1.1.1.2.cmml">=</mo><mrow id="S4.E14.m2.4.4.1.1.1.1" xref="S4.E14.m2.4.4.1.1.1.1.cmml"><mtext id="S4.E14.m2.4.4.1.1.1.1.3" xref="S4.E14.m2.4.4.1.1.1.1.3a.cmml">D</mtext><mo lspace="0em" rspace="0em" id="S4.E14.m2.4.4.1.1.1.1.2" xref="S4.E14.m2.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S4.E14.m2.4.4.1.1.1.1.1.1" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E14.m2.4.4.1.1.1.1.1.1.2" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.cmml">(</mo><mmultiscripts id="S4.E14.m2.4.4.1.1.1.1.1.1.1" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.E14.m2.4.4.1.1.1.1.1.1.1.2.2.2" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.2.2.2.cmml">f</mi><mi id="S4.E14.m2.4.4.1.1.1.1.1.1.1.2.2.3" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.2.2.3.cmml">l</mi><mrow id="S4.E14.m2.3.3.1.3" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E14.m2.3.3.1.3.1" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E14.m2.3.3.1.1" xref="S4.E14.m2.3.3.1.1.cmml">k</mi><mo stretchy="false" id="S4.E14.m2.3.3.1.3.2" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E14.m2.4.4.1.1.1.1.1.1.1a" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.cmml"></mrow><mo id="S4.E14.m2.4.4.1.1.1.1.1.1.1.3" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo stretchy="false" id="S4.E14.m2.4.4.1.1.1.1.1.1.3" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E14.m2.4.4.1.2" xref="S4.E14.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m2.4b"><apply id="S4.E14.m2.4.4.1.1.cmml" xref="S4.E14.m2.4.4.1"><ci id="S4.E14.m2.4.4.1.1.2.cmml" xref="S4.E14.m2.4.4.1.1.2">:</ci><csymbol cd="latexml" id="S4.E14.m2.4.4.1.1.3.cmml" xref="S4.E14.m2.4.4.1.1.3">absent</csymbol><apply id="S4.E14.m2.4.4.1.1.1.cmml" xref="S4.E14.m2.4.4.1.1.1"><eq id="S4.E14.m2.4.4.1.1.1.2.cmml" xref="S4.E14.m2.4.4.1.1.1.2"></eq><apply id="S4.E14.m2.4.4.1.1.1.3.cmml" xref="S4.E14.m2.4.4.1.1.1.3"><partialdiff id="S4.E14.m2.4.4.1.1.1.3.1.cmml" xref="S4.E14.m2.4.4.1.1.1.3.1"></partialdiff><apply id="S4.E14.m2.4.4.1.1.1.3.2.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2"><divide id="S4.E14.m2.4.4.1.1.1.3.2.1.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.1"></divide><apply id="S4.E14.m2.4.4.1.1.1.3.2.2.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E14.m2.4.4.1.1.1.3.2.2.1.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.2">superscript</csymbol><apply id="S4.E14.m2.4.4.1.1.1.3.2.2.2.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E14.m2.4.4.1.1.1.3.2.2.2.1.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.2">subscript</csymbol><ci id="S4.E14.m2.4.4.1.1.1.3.2.2.2.2.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.2.2.2">ℎ</ci><ci id="S4.E14.m2.4.4.1.1.1.3.2.2.2.3.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.2.2.3">𝑙</ci></apply><ci id="S4.E14.m2.1.1.1.1.cmml" xref="S4.E14.m2.1.1.1.1">𝑘</ci></apply><apply id="S4.E14.m2.4.4.1.1.1.3.2.3.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.3"><partialdiff id="S4.E14.m2.4.4.1.1.1.3.2.3.1.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.3.1"></partialdiff><apply id="S4.E14.m2.4.4.1.1.1.3.2.3.2.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S4.E14.m2.4.4.1.1.1.3.2.3.2.1.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.3.2">superscript</csymbol><apply id="S4.E14.m2.4.4.1.1.1.3.2.3.2.2.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S4.E14.m2.4.4.1.1.1.3.2.3.2.2.1.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.3.2">subscript</csymbol><ci id="S4.E14.m2.4.4.1.1.1.3.2.3.2.2.2.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.3.2.2.2">𝑏</ci><ci id="S4.E14.m2.4.4.1.1.1.3.2.3.2.2.3.cmml" xref="S4.E14.m2.4.4.1.1.1.3.2.3.2.2.3">𝑙</ci></apply><ci id="S4.E14.m2.2.2.1.1.cmml" xref="S4.E14.m2.2.2.1.1">𝑘</ci></apply></apply></apply></apply><apply id="S4.E14.m2.4.4.1.1.1.1.cmml" xref="S4.E14.m2.4.4.1.1.1.1"><times id="S4.E14.m2.4.4.1.1.1.1.2.cmml" xref="S4.E14.m2.4.4.1.1.1.1.2"></times><ci id="S4.E14.m2.4.4.1.1.1.1.3a.cmml" xref="S4.E14.m2.4.4.1.1.1.1.3"><mtext id="S4.E14.m2.4.4.1.1.1.1.3.cmml" xref="S4.E14.m2.4.4.1.1.1.1.3">D</mtext></ci><apply id="S4.E14.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E14.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m2.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E14.m2.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m2.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m2.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E14.m2.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m2.4.4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E14.m2.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E14.m2.4.4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.2.2.2">𝑓</ci><ci id="S4.E14.m2.4.4.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.2.2.3">𝑙</ci></apply><ci id="S4.E14.m2.3.3.1.1.cmml" xref="S4.E14.m2.3.3.1.1">𝑘</ci></apply><ci id="S4.E14.m2.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m2.4.4.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m2.4c">\displaystyle:~{}\partial{h_{l}^{(k)}}/\partial{b_{l}^{(k)}}=\text{D}({f_{l}^{(k)}}^{\prime}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
<tbody id="S4.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E15.m1.1" class="ltx_Math" alttext="\displaystyle\text{PAN}_{\circ}" display="inline"><semantics id="S4.E15.m1.1a"><msub id="S4.E15.m1.1.1" xref="S4.E15.m1.1.1.cmml"><mtext id="S4.E15.m1.1.1.2" xref="S4.E15.m1.1.1.2a.cmml">PAN</mtext><mo id="S4.E15.m1.1.1.3" xref="S4.E15.m1.1.1.3.cmml">∘</mo></msub><annotation-xml encoding="MathML-Content" id="S4.E15.m1.1b"><apply id="S4.E15.m1.1.1.cmml" xref="S4.E15.m1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.cmml" xref="S4.E15.m1.1.1">subscript</csymbol><ci id="S4.E15.m1.1.1.2a.cmml" xref="S4.E15.m1.1.1.2"><mtext id="S4.E15.m1.1.1.2.cmml" xref="S4.E15.m1.1.1.2">PAN</mtext></ci><compose id="S4.E15.m1.1.1.3.cmml" xref="S4.E15.m1.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.1c">\displaystyle\text{PAN}_{\circ}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E15.m2.4" class="ltx_Math" alttext="\displaystyle:~{}\partial{h_{l}^{(k)}}/\partial{b_{l}^{(k)}}=\text{D}({f_{l}^{(k)}}^{\prime})\text{D}(e_{l})," display="inline"><semantics id="S4.E15.m2.4a"><mrow id="S4.E15.m2.4.4.1" xref="S4.E15.m2.4.4.1.1.cmml"><mrow id="S4.E15.m2.4.4.1.1" xref="S4.E15.m2.4.4.1.1.cmml"><mi id="S4.E15.m2.4.4.1.1.4" xref="S4.E15.m2.4.4.1.1.4.cmml"></mi><mo lspace="0.278em" rspace="0.330em" id="S4.E15.m2.4.4.1.1.3" xref="S4.E15.m2.4.4.1.1.3.cmml">:</mo><mrow id="S4.E15.m2.4.4.1.1.2" xref="S4.E15.m2.4.4.1.1.2.cmml"><mrow id="S4.E15.m2.4.4.1.1.2.4" xref="S4.E15.m2.4.4.1.1.2.4.cmml"><mo rspace="0em" id="S4.E15.m2.4.4.1.1.2.4.1" xref="S4.E15.m2.4.4.1.1.2.4.1.cmml">∂</mo><mrow id="S4.E15.m2.4.4.1.1.2.4.2" xref="S4.E15.m2.4.4.1.1.2.4.2.cmml"><msubsup id="S4.E15.m2.4.4.1.1.2.4.2.2" xref="S4.E15.m2.4.4.1.1.2.4.2.2.cmml"><mi id="S4.E15.m2.4.4.1.1.2.4.2.2.2.2" xref="S4.E15.m2.4.4.1.1.2.4.2.2.2.2.cmml">h</mi><mi id="S4.E15.m2.4.4.1.1.2.4.2.2.2.3" xref="S4.E15.m2.4.4.1.1.2.4.2.2.2.3.cmml">l</mi><mrow id="S4.E15.m2.1.1.1.3" xref="S4.E15.m2.4.4.1.1.2.4.2.2.cmml"><mo stretchy="false" id="S4.E15.m2.1.1.1.3.1" xref="S4.E15.m2.4.4.1.1.2.4.2.2.cmml">(</mo><mi id="S4.E15.m2.1.1.1.1" xref="S4.E15.m2.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S4.E15.m2.1.1.1.3.2" xref="S4.E15.m2.4.4.1.1.2.4.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.E15.m2.4.4.1.1.2.4.2.1" xref="S4.E15.m2.4.4.1.1.2.4.2.1.cmml">/</mo><mrow id="S4.E15.m2.4.4.1.1.2.4.2.3" xref="S4.E15.m2.4.4.1.1.2.4.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.E15.m2.4.4.1.1.2.4.2.3.1" xref="S4.E15.m2.4.4.1.1.2.4.2.3.1.cmml">∂</mo><msubsup id="S4.E15.m2.4.4.1.1.2.4.2.3.2" xref="S4.E15.m2.4.4.1.1.2.4.2.3.2.cmml"><mi id="S4.E15.m2.4.4.1.1.2.4.2.3.2.2.2" xref="S4.E15.m2.4.4.1.1.2.4.2.3.2.2.2.cmml">b</mi><mi id="S4.E15.m2.4.4.1.1.2.4.2.3.2.2.3" xref="S4.E15.m2.4.4.1.1.2.4.2.3.2.2.3.cmml">l</mi><mrow id="S4.E15.m2.2.2.1.3" xref="S4.E15.m2.4.4.1.1.2.4.2.3.2.cmml"><mo stretchy="false" id="S4.E15.m2.2.2.1.3.1" xref="S4.E15.m2.4.4.1.1.2.4.2.3.2.cmml">(</mo><mi id="S4.E15.m2.2.2.1.1" xref="S4.E15.m2.2.2.1.1.cmml">k</mi><mo stretchy="false" id="S4.E15.m2.2.2.1.3.2" xref="S4.E15.m2.4.4.1.1.2.4.2.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S4.E15.m2.4.4.1.1.2.3" xref="S4.E15.m2.4.4.1.1.2.3.cmml">=</mo><mrow id="S4.E15.m2.4.4.1.1.2.2" xref="S4.E15.m2.4.4.1.1.2.2.cmml"><mtext id="S4.E15.m2.4.4.1.1.2.2.4" xref="S4.E15.m2.4.4.1.1.2.2.4a.cmml">D</mtext><mo lspace="0em" rspace="0em" id="S4.E15.m2.4.4.1.1.2.2.3" xref="S4.E15.m2.4.4.1.1.2.2.3.cmml">​</mo><mrow id="S4.E15.m2.4.4.1.1.1.1.1.1" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E15.m2.4.4.1.1.1.1.1.1.2" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.cmml">(</mo><mmultiscripts id="S4.E15.m2.4.4.1.1.1.1.1.1.1" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.E15.m2.4.4.1.1.1.1.1.1.1.2.2.2" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.2.2.2.cmml">f</mi><mi id="S4.E15.m2.4.4.1.1.1.1.1.1.1.2.2.3" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.2.2.3.cmml">l</mi><mrow id="S4.E15.m2.3.3.1.3" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E15.m2.3.3.1.3.1" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E15.m2.3.3.1.1" xref="S4.E15.m2.3.3.1.1.cmml">k</mi><mo stretchy="false" id="S4.E15.m2.3.3.1.3.2" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E15.m2.4.4.1.1.1.1.1.1.1a" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.cmml"></mrow><mo id="S4.E15.m2.4.4.1.1.1.1.1.1.1.3" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.3.cmml">′</mo></mmultiscripts><mo stretchy="false" id="S4.E15.m2.4.4.1.1.1.1.1.1.3" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E15.m2.4.4.1.1.2.2.3a" xref="S4.E15.m2.4.4.1.1.2.2.3.cmml">​</mo><mtext id="S4.E15.m2.4.4.1.1.2.2.5" xref="S4.E15.m2.4.4.1.1.2.2.5a.cmml">D</mtext><mo lspace="0em" rspace="0em" id="S4.E15.m2.4.4.1.1.2.2.3b" xref="S4.E15.m2.4.4.1.1.2.2.3.cmml">​</mo><mrow id="S4.E15.m2.4.4.1.1.2.2.2.1" xref="S4.E15.m2.4.4.1.1.2.2.2.1.1.cmml"><mo stretchy="false" id="S4.E15.m2.4.4.1.1.2.2.2.1.2" xref="S4.E15.m2.4.4.1.1.2.2.2.1.1.cmml">(</mo><msub id="S4.E15.m2.4.4.1.1.2.2.2.1.1" xref="S4.E15.m2.4.4.1.1.2.2.2.1.1.cmml"><mi id="S4.E15.m2.4.4.1.1.2.2.2.1.1.2" xref="S4.E15.m2.4.4.1.1.2.2.2.1.1.2.cmml">e</mi><mi id="S4.E15.m2.4.4.1.1.2.2.2.1.1.3" xref="S4.E15.m2.4.4.1.1.2.2.2.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S4.E15.m2.4.4.1.1.2.2.2.1.3" xref="S4.E15.m2.4.4.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E15.m2.4.4.1.2" xref="S4.E15.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m2.4b"><apply id="S4.E15.m2.4.4.1.1.cmml" xref="S4.E15.m2.4.4.1"><ci id="S4.E15.m2.4.4.1.1.3.cmml" xref="S4.E15.m2.4.4.1.1.3">:</ci><csymbol cd="latexml" id="S4.E15.m2.4.4.1.1.4.cmml" xref="S4.E15.m2.4.4.1.1.4">absent</csymbol><apply id="S4.E15.m2.4.4.1.1.2.cmml" xref="S4.E15.m2.4.4.1.1.2"><eq id="S4.E15.m2.4.4.1.1.2.3.cmml" xref="S4.E15.m2.4.4.1.1.2.3"></eq><apply id="S4.E15.m2.4.4.1.1.2.4.cmml" xref="S4.E15.m2.4.4.1.1.2.4"><partialdiff id="S4.E15.m2.4.4.1.1.2.4.1.cmml" xref="S4.E15.m2.4.4.1.1.2.4.1"></partialdiff><apply id="S4.E15.m2.4.4.1.1.2.4.2.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2"><divide id="S4.E15.m2.4.4.1.1.2.4.2.1.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.1"></divide><apply id="S4.E15.m2.4.4.1.1.2.4.2.2.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.2"><csymbol cd="ambiguous" id="S4.E15.m2.4.4.1.1.2.4.2.2.1.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.2">superscript</csymbol><apply id="S4.E15.m2.4.4.1.1.2.4.2.2.2.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.2"><csymbol cd="ambiguous" id="S4.E15.m2.4.4.1.1.2.4.2.2.2.1.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.2">subscript</csymbol><ci id="S4.E15.m2.4.4.1.1.2.4.2.2.2.2.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.2.2.2">ℎ</ci><ci id="S4.E15.m2.4.4.1.1.2.4.2.2.2.3.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.2.2.3">𝑙</ci></apply><ci id="S4.E15.m2.1.1.1.1.cmml" xref="S4.E15.m2.1.1.1.1">𝑘</ci></apply><apply id="S4.E15.m2.4.4.1.1.2.4.2.3.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.3"><partialdiff id="S4.E15.m2.4.4.1.1.2.4.2.3.1.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.3.1"></partialdiff><apply id="S4.E15.m2.4.4.1.1.2.4.2.3.2.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.3.2"><csymbol cd="ambiguous" id="S4.E15.m2.4.4.1.1.2.4.2.3.2.1.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.3.2">superscript</csymbol><apply id="S4.E15.m2.4.4.1.1.2.4.2.3.2.2.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.3.2"><csymbol cd="ambiguous" id="S4.E15.m2.4.4.1.1.2.4.2.3.2.2.1.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.3.2">subscript</csymbol><ci id="S4.E15.m2.4.4.1.1.2.4.2.3.2.2.2.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.3.2.2.2">𝑏</ci><ci id="S4.E15.m2.4.4.1.1.2.4.2.3.2.2.3.cmml" xref="S4.E15.m2.4.4.1.1.2.4.2.3.2.2.3">𝑙</ci></apply><ci id="S4.E15.m2.2.2.1.1.cmml" xref="S4.E15.m2.2.2.1.1">𝑘</ci></apply></apply></apply></apply><apply id="S4.E15.m2.4.4.1.1.2.2.cmml" xref="S4.E15.m2.4.4.1.1.2.2"><times id="S4.E15.m2.4.4.1.1.2.2.3.cmml" xref="S4.E15.m2.4.4.1.1.2.2.3"></times><ci id="S4.E15.m2.4.4.1.1.2.2.4a.cmml" xref="S4.E15.m2.4.4.1.1.2.2.4"><mtext id="S4.E15.m2.4.4.1.1.2.2.4.cmml" xref="S4.E15.m2.4.4.1.1.2.2.4">D</mtext></ci><apply id="S4.E15.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E15.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m2.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E15.m2.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m2.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E15.m2.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E15.m2.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E15.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m2.4.4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E15.m2.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E15.m2.4.4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.2.2.2">𝑓</ci><ci id="S4.E15.m2.4.4.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.2.2.3">𝑙</ci></apply><ci id="S4.E15.m2.3.3.1.1.cmml" xref="S4.E15.m2.3.3.1.1">𝑘</ci></apply><ci id="S4.E15.m2.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m2.4.4.1.1.1.1.1.1.1.3">′</ci></apply><ci id="S4.E15.m2.4.4.1.1.2.2.5a.cmml" xref="S4.E15.m2.4.4.1.1.2.2.5"><mtext id="S4.E15.m2.4.4.1.1.2.2.5.cmml" xref="S4.E15.m2.4.4.1.1.2.2.5">D</mtext></ci><apply id="S4.E15.m2.4.4.1.1.2.2.2.1.1.cmml" xref="S4.E15.m2.4.4.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S4.E15.m2.4.4.1.1.2.2.2.1.1.1.cmml" xref="S4.E15.m2.4.4.1.1.2.2.2.1">subscript</csymbol><ci id="S4.E15.m2.4.4.1.1.2.2.2.1.1.2.cmml" xref="S4.E15.m2.4.4.1.1.2.2.2.1.1.2">𝑒</ci><ci id="S4.E15.m2.4.4.1.1.2.2.2.1.1.3.cmml" xref="S4.E15.m2.4.4.1.1.2.2.2.1.1.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m2.4c">\displaystyle:~{}\partial{h_{l}^{(k)}}/\partial{b_{l}^{(k)}}=\text{D}({f_{l}^{(k)}}^{\prime})\text{D}(e_{l}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.12" class="ltx_p">where we only give the gradient of bias for simplification. The gradients of multiplicative PANs directly contain the same position information across clients (e.g., <math id="S4.SS2.p1.2.m1.1" class="ltx_Math" alttext="e_{l}" display="inline"><semantics id="S4.SS2.p1.2.m1.1a"><msub id="S4.SS2.p1.2.m1.1.1" xref="S4.SS2.p1.2.m1.1.1.cmml"><mi id="S4.SS2.p1.2.m1.1.1.2" xref="S4.SS2.p1.2.m1.1.1.2.cmml">e</mi><mi id="S4.SS2.p1.2.m1.1.1.3" xref="S4.SS2.p1.2.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m1.1b"><apply id="S4.SS2.p1.2.m1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m1.1.1.2.cmml" xref="S4.SS2.p1.2.m1.1.1.2">𝑒</ci><ci id="S4.SS2.p1.2.m1.1.1.3.cmml" xref="S4.SS2.p1.2.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m1.1c">e_{l}</annotation></semantics></math>) in spite of various data distributions (e.g., <math id="S4.SS2.p1.3.m2.1" class="ltx_Math" alttext="h_{l-1}^{(k)}" display="inline"><semantics id="S4.SS2.p1.3.m2.1a"><msubsup id="S4.SS2.p1.3.m2.1.2" xref="S4.SS2.p1.3.m2.1.2.cmml"><mi id="S4.SS2.p1.3.m2.1.2.2.2" xref="S4.SS2.p1.3.m2.1.2.2.2.cmml">h</mi><mrow id="S4.SS2.p1.3.m2.1.2.2.3" xref="S4.SS2.p1.3.m2.1.2.2.3.cmml"><mi id="S4.SS2.p1.3.m2.1.2.2.3.2" xref="S4.SS2.p1.3.m2.1.2.2.3.2.cmml">l</mi><mo id="S4.SS2.p1.3.m2.1.2.2.3.1" xref="S4.SS2.p1.3.m2.1.2.2.3.1.cmml">−</mo><mn id="S4.SS2.p1.3.m2.1.2.2.3.3" xref="S4.SS2.p1.3.m2.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.SS2.p1.3.m2.1.1.1.3" xref="S4.SS2.p1.3.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.3.m2.1.1.1.3.1" xref="S4.SS2.p1.3.m2.1.2.cmml">(</mo><mi id="S4.SS2.p1.3.m2.1.1.1.1" xref="S4.SS2.p1.3.m2.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S4.SS2.p1.3.m2.1.1.1.3.2" xref="S4.SS2.p1.3.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m2.1b"><apply id="S4.SS2.p1.3.m2.1.2.cmml" xref="S4.SS2.p1.3.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.1.2.1.cmml" xref="S4.SS2.p1.3.m2.1.2">superscript</csymbol><apply id="S4.SS2.p1.3.m2.1.2.2.cmml" xref="S4.SS2.p1.3.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.1.2.2.1.cmml" xref="S4.SS2.p1.3.m2.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m2.1.2.2.2.cmml" xref="S4.SS2.p1.3.m2.1.2.2.2">ℎ</ci><apply id="S4.SS2.p1.3.m2.1.2.2.3.cmml" xref="S4.SS2.p1.3.m2.1.2.2.3"><minus id="S4.SS2.p1.3.m2.1.2.2.3.1.cmml" xref="S4.SS2.p1.3.m2.1.2.2.3.1"></minus><ci id="S4.SS2.p1.3.m2.1.2.2.3.2.cmml" xref="S4.SS2.p1.3.m2.1.2.2.3.2">𝑙</ci><cn type="integer" id="S4.SS2.p1.3.m2.1.2.2.3.3.cmml" xref="S4.SS2.p1.3.m2.1.2.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p1.3.m2.1.1.1.1.cmml" xref="S4.SS2.p1.3.m2.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m2.1c">h_{l-1}^{(k)}</annotation></semantics></math>). For the additive ones, the impact of <math id="S4.SS2.p1.4.m3.1" class="ltx_Math" alttext="e_{l}" display="inline"><semantics id="S4.SS2.p1.4.m3.1a"><msub id="S4.SS2.p1.4.m3.1.1" xref="S4.SS2.p1.4.m3.1.1.cmml"><mi id="S4.SS2.p1.4.m3.1.1.2" xref="S4.SS2.p1.4.m3.1.1.2.cmml">e</mi><mi id="S4.SS2.p1.4.m3.1.1.3" xref="S4.SS2.p1.4.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m3.1b"><apply id="S4.SS2.p1.4.m3.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m3.1.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.4.m3.1.1.2.cmml" xref="S4.SS2.p1.4.m3.1.1.2">𝑒</ci><ci id="S4.SS2.p1.4.m3.1.1.3.cmml" xref="S4.SS2.p1.4.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m3.1c">e_{l}</annotation></semantics></math> is implicit because <math id="S4.SS2.p1.5.m4.1" class="ltx_Math" alttext="{f_{l}^{(k)}}^{\prime}" display="inline"><semantics id="S4.SS2.p1.5.m4.1a"><mmultiscripts id="S4.SS2.p1.5.m4.1.2" xref="S4.SS2.p1.5.m4.1.2.cmml"><mi id="S4.SS2.p1.5.m4.1.2.2.2.2" xref="S4.SS2.p1.5.m4.1.2.2.2.2.cmml">f</mi><mi id="S4.SS2.p1.5.m4.1.2.2.2.3" xref="S4.SS2.p1.5.m4.1.2.2.2.3.cmml">l</mi><mrow id="S4.SS2.p1.5.m4.1.1.1.3" xref="S4.SS2.p1.5.m4.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.5.m4.1.1.1.3.1" xref="S4.SS2.p1.5.m4.1.2.cmml">(</mo><mi id="S4.SS2.p1.5.m4.1.1.1.1" xref="S4.SS2.p1.5.m4.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S4.SS2.p1.5.m4.1.1.1.3.2" xref="S4.SS2.p1.5.m4.1.2.cmml">)</mo></mrow><mrow id="S4.SS2.p1.5.m4.1.2a" xref="S4.SS2.p1.5.m4.1.2.cmml"></mrow><mo id="S4.SS2.p1.5.m4.1.2.3" xref="S4.SS2.p1.5.m4.1.2.3.cmml">′</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m4.1b"><apply id="S4.SS2.p1.5.m4.1.2.cmml" xref="S4.SS2.p1.5.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m4.1.2.1.cmml" xref="S4.SS2.p1.5.m4.1.2">superscript</csymbol><apply id="S4.SS2.p1.5.m4.1.2.2.cmml" xref="S4.SS2.p1.5.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m4.1.2.2.1.cmml" xref="S4.SS2.p1.5.m4.1.2">superscript</csymbol><apply id="S4.SS2.p1.5.m4.1.2.2.2.cmml" xref="S4.SS2.p1.5.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m4.1.2.2.2.1.cmml" xref="S4.SS2.p1.5.m4.1.2">subscript</csymbol><ci id="S4.SS2.p1.5.m4.1.2.2.2.2.cmml" xref="S4.SS2.p1.5.m4.1.2.2.2.2">𝑓</ci><ci id="S4.SS2.p1.5.m4.1.2.2.2.3.cmml" xref="S4.SS2.p1.5.m4.1.2.2.2.3">𝑙</ci></apply><ci id="S4.SS2.p1.5.m4.1.1.1.1.cmml" xref="S4.SS2.p1.5.m4.1.1.1.1">𝑘</ci></apply><ci id="S4.SS2.p1.5.m4.1.2.3.cmml" xref="S4.SS2.p1.5.m4.1.2.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m4.1c">{f_{l}^{(k)}}^{\prime}</annotation></semantics></math> is related to <math id="S4.SS2.p1.6.m5.1" class="ltx_Math" alttext="e_{l}" display="inline"><semantics id="S4.SS2.p1.6.m5.1a"><msub id="S4.SS2.p1.6.m5.1.1" xref="S4.SS2.p1.6.m5.1.1.cmml"><mi id="S4.SS2.p1.6.m5.1.1.2" xref="S4.SS2.p1.6.m5.1.1.2.cmml">e</mi><mi id="S4.SS2.p1.6.m5.1.1.3" xref="S4.SS2.p1.6.m5.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m5.1b"><apply id="S4.SS2.p1.6.m5.1.1.cmml" xref="S4.SS2.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.1.1.1.cmml" xref="S4.SS2.p1.6.m5.1.1">subscript</csymbol><ci id="S4.SS2.p1.6.m5.1.1.2.cmml" xref="S4.SS2.p1.6.m5.1.1.2">𝑒</ci><ci id="S4.SS2.p1.6.m5.1.1.3.cmml" xref="S4.SS2.p1.6.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m5.1c">e_{l}</annotation></semantics></math>, but nevertheless, the effect is not significant as multiplicative ones. <span id="S4.SS2.p1.7.1" class="ltx_text ltx_font_italic">Overall, <math id="S4.SS2.p1.7.1.m1.1" class="ltx_Math" alttext="e_{l}" display="inline"><semantics id="S4.SS2.p1.7.1.m1.1a"><msub id="S4.SS2.p1.7.1.m1.1.1" xref="S4.SS2.p1.7.1.m1.1.1.cmml"><mi id="S4.SS2.p1.7.1.m1.1.1.2" xref="S4.SS2.p1.7.1.m1.1.1.2.cmml">e</mi><mi id="S4.SS2.p1.7.1.m1.1.1.3" xref="S4.SS2.p1.7.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.1.m1.1b"><apply id="S4.SS2.p1.7.1.m1.1.1.cmml" xref="S4.SS2.p1.7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.1.m1.1.1.1.cmml" xref="S4.SS2.p1.7.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.7.1.m1.1.1.2.cmml" xref="S4.SS2.p1.7.1.m1.1.1.2">𝑒</ci><ci id="S4.SS2.p1.7.1.m1.1.1.3.cmml" xref="S4.SS2.p1.7.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.1.m1.1c">e_{l}</annotation></semantics></math> could regularize and rectify local gradient directions, keeping some ingredients consistent during backward propagation.</span> As an extreme case, if <math id="S4.SS2.p1.8.m6.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS2.p1.8.m6.1a"><mi id="S4.SS2.p1.8.m6.1.1" xref="S4.SS2.p1.8.m6.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m6.1b"><ci id="S4.SS2.p1.8.m6.1.1.cmml" xref="S4.SS2.p1.8.m6.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m6.1c">A</annotation></semantics></math> in <math id="S4.SS2.p1.9.m7.1" class="ltx_Math" alttext="e_{l}" display="inline"><semantics id="S4.SS2.p1.9.m7.1a"><msub id="S4.SS2.p1.9.m7.1.1" xref="S4.SS2.p1.9.m7.1.1.cmml"><mi id="S4.SS2.p1.9.m7.1.1.2" xref="S4.SS2.p1.9.m7.1.1.2.cmml">e</mi><mi id="S4.SS2.p1.9.m7.1.1.3" xref="S4.SS2.p1.9.m7.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m7.1b"><apply id="S4.SS2.p1.9.m7.1.1.cmml" xref="S4.SS2.p1.9.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m7.1.1.1.cmml" xref="S4.SS2.p1.9.m7.1.1">subscript</csymbol><ci id="S4.SS2.p1.9.m7.1.1.2.cmml" xref="S4.SS2.p1.9.m7.1.1.2">𝑒</ci><ci id="S4.SS2.p1.9.m7.1.1.3.cmml" xref="S4.SS2.p1.9.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m7.1c">e_{l}</annotation></semantics></math> is very large, the gradients in Eq. <a href="#S4.E14" title="Equation 14 ‣ 4.2 Applying PANs to FL ‣ 4 FL with PANs ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a> and Eq. <a href="#S4.E15" title="Equation 15 ‣ 4.2 Applying PANs to FL ‣ 4 FL with PANs ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a> will tend to be the same, mitigating the weight divergence completely. However, setting <math id="S4.SS2.p1.10.m8.1" class="ltx_Math" alttext="e_{l}" display="inline"><semantics id="S4.SS2.p1.10.m8.1a"><msub id="S4.SS2.p1.10.m8.1.1" xref="S4.SS2.p1.10.m8.1.1.cmml"><mi id="S4.SS2.p1.10.m8.1.1.2" xref="S4.SS2.p1.10.m8.1.1.2.cmml">e</mi><mi id="S4.SS2.p1.10.m8.1.1.3" xref="S4.SS2.p1.10.m8.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m8.1b"><apply id="S4.SS2.p1.10.m8.1.1.cmml" xref="S4.SS2.p1.10.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m8.1.1.1.cmml" xref="S4.SS2.p1.10.m8.1.1">subscript</csymbol><ci id="S4.SS2.p1.10.m8.1.1.2.cmml" xref="S4.SS2.p1.10.m8.1.1.2">𝑒</ci><ci id="S4.SS2.p1.10.m8.1.1.3.cmml" xref="S4.SS2.p1.10.m8.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m8.1c">e_{l}</annotation></semantics></math> too large will make the neural network difficult to train and the data information is completely covered, so the strength of <math id="S4.SS2.p1.11.m9.1" class="ltx_Math" alttext="e_{l}" display="inline"><semantics id="S4.SS2.p1.11.m9.1a"><msub id="S4.SS2.p1.11.m9.1.1" xref="S4.SS2.p1.11.m9.1.1.cmml"><mi id="S4.SS2.p1.11.m9.1.1.2" xref="S4.SS2.p1.11.m9.1.1.2.cmml">e</mi><mi id="S4.SS2.p1.11.m9.1.1.3" xref="S4.SS2.p1.11.m9.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m9.1b"><apply id="S4.SS2.p1.11.m9.1.1.cmml" xref="S4.SS2.p1.11.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.11.m9.1.1.1.cmml" xref="S4.SS2.p1.11.m9.1.1">subscript</csymbol><ci id="S4.SS2.p1.11.m9.1.1.2.cmml" xref="S4.SS2.p1.11.m9.1.1.2">𝑒</ci><ci id="S4.SS2.p1.11.m9.1.1.3.cmml" xref="S4.SS2.p1.11.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m9.1c">e_{l}</annotation></semantics></math> (i.e., <math id="S4.SS2.p1.12.m10.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS2.p1.12.m10.1a"><mi id="S4.SS2.p1.12.m10.1.1" xref="S4.SS2.p1.12.m10.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m10.1b"><ci id="S4.SS2.p1.12.m10.1.1.cmml" xref="S4.SS2.p1.12.m10.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m10.1c">A</annotation></semantics></math>) is a tradeoff.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2203.14666/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="186" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.8.3.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Left<span id="S4.F2.3.1.1" class="ltx_text ltx_font_medium">: how much neurons are not shuffled with various <math id="S4.F2.3.1.1.m1.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="S4.F2.3.1.1.m1.1b"><msub id="S4.F2.3.1.1.m1.1.1" xref="S4.F2.3.1.1.m1.1.1.cmml"><mi id="S4.F2.3.1.1.m1.1.1.2" xref="S4.F2.3.1.1.m1.1.1.2.cmml">P</mi><mtext id="S4.F2.3.1.1.m1.1.1.3" xref="S4.F2.3.1.1.m1.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.F2.3.1.1.m1.1c"><apply id="S4.F2.3.1.1.m1.1.1.cmml" xref="S4.F2.3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.F2.3.1.1.m1.1.1.1.cmml" xref="S4.F2.3.1.1.m1.1.1">subscript</csymbol><ci id="S4.F2.3.1.1.m1.1.1.2.cmml" xref="S4.F2.3.1.1.m1.1.1.2">𝑃</ci><ci id="S4.F2.3.1.1.m1.1.1.3a.cmml" xref="S4.F2.3.1.1.m1.1.1.3"><mtext mathsize="70%" id="S4.F2.3.1.1.m1.1.1.3.cmml" xref="S4.F2.3.1.1.m1.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.3.1.1.m1.1d">P_{\text{sf}}</annotation></semantics></math>. </span>Right<span id="S4.F2.4.2.2" class="ltx_text ltx_font_medium">: a permutation matrix demo with <math id="S4.F2.4.2.2.m1.1" class="ltx_Math" alttext="P_{\text{sf}}=0.1" display="inline"><semantics id="S4.F2.4.2.2.m1.1b"><mrow id="S4.F2.4.2.2.m1.1.1" xref="S4.F2.4.2.2.m1.1.1.cmml"><msub id="S4.F2.4.2.2.m1.1.1.2" xref="S4.F2.4.2.2.m1.1.1.2.cmml"><mi id="S4.F2.4.2.2.m1.1.1.2.2" xref="S4.F2.4.2.2.m1.1.1.2.2.cmml">P</mi><mtext id="S4.F2.4.2.2.m1.1.1.2.3" xref="S4.F2.4.2.2.m1.1.1.2.3a.cmml">sf</mtext></msub><mo id="S4.F2.4.2.2.m1.1.1.1" xref="S4.F2.4.2.2.m1.1.1.1.cmml">=</mo><mn id="S4.F2.4.2.2.m1.1.1.3" xref="S4.F2.4.2.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.4.2.2.m1.1c"><apply id="S4.F2.4.2.2.m1.1.1.cmml" xref="S4.F2.4.2.2.m1.1.1"><eq id="S4.F2.4.2.2.m1.1.1.1.cmml" xref="S4.F2.4.2.2.m1.1.1.1"></eq><apply id="S4.F2.4.2.2.m1.1.1.2.cmml" xref="S4.F2.4.2.2.m1.1.1.2"><csymbol cd="ambiguous" id="S4.F2.4.2.2.m1.1.1.2.1.cmml" xref="S4.F2.4.2.2.m1.1.1.2">subscript</csymbol><ci id="S4.F2.4.2.2.m1.1.1.2.2.cmml" xref="S4.F2.4.2.2.m1.1.1.2.2">𝑃</ci><ci id="S4.F2.4.2.2.m1.1.1.2.3a.cmml" xref="S4.F2.4.2.2.m1.1.1.2.3"><mtext mathsize="70%" id="S4.F2.4.2.2.m1.1.1.2.3.cmml" xref="S4.F2.4.2.2.m1.1.1.2.3">sf</mtext></ci></apply><cn type="float" id="S4.F2.4.2.2.m1.1.1.3.cmml" xref="S4.F2.4.2.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.4.2.2.m1.1d">P_{\text{sf}}=0.1</annotation></semantics></math>.</span></span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.12" class="ltx_p">We study how much influence the proposed PANs have on both centralized training and decentralized training (i.e., FL). The datasets used are Mnist <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, FeMnist <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, SVHN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, GTSRB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, Cifar10/100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, and Cinic10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. FeMnist is recommended by LEAF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and FedScale <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. We use MLP for Mnist/FeMnist, VGG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> for SVHN/GTSRB/Cifar10, ResNet20 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> for Cifar100/Cinic10 by default if without more declarations. We sometimes take VGG9 used in previous FL works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. For centralized training, we use the provided training and test set correspondingly. For FL, we split the training set according to Dirichlet distributions, where <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="\text{Dir}(\alpha)" display="inline"><semantics id="S5.p1.1.m1.1a"><mrow id="S5.p1.1.m1.1.2" xref="S5.p1.1.m1.1.2.cmml"><mtext id="S5.p1.1.m1.1.2.2" xref="S5.p1.1.m1.1.2.2a.cmml">Dir</mtext><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.1.2.1" xref="S5.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S5.p1.1.m1.1.2.3.2" xref="S5.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S5.p1.1.m1.1.2.3.2.1" xref="S5.p1.1.m1.1.2.cmml">(</mo><mi id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">α</mi><mo stretchy="false" id="S5.p1.1.m1.1.2.3.2.2" xref="S5.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.2.cmml" xref="S5.p1.1.m1.1.2"><times id="S5.p1.1.m1.1.2.1.cmml" xref="S5.p1.1.m1.1.2.1"></times><ci id="S5.p1.1.m1.1.2.2a.cmml" xref="S5.p1.1.m1.1.2.2"><mtext id="S5.p1.1.m1.1.2.2.cmml" xref="S5.p1.1.m1.1.2.2">Dir</mtext></ci><ci id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">\text{Dir}(\alpha)</annotation></semantics></math> controls the non-i.i.d. level. Smaller <math id="S5.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.p1.2.m2.1a"><mi id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><ci id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">\alpha</annotation></semantics></math> leads to more non-i.i.d. cases. For each FL scene, we report several key hyper-parameters: number of clients <math id="S5.p1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.p1.3.m3.1a"><mi id="S5.p1.3.m3.1.1" xref="S5.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.p1.3.m3.1b"><ci id="S5.p1.3.m3.1.1.cmml" xref="S5.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.3.m3.1c">K</annotation></semantics></math>, client participation ratio <math id="S5.p1.4.m4.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S5.p1.4.m4.1a"><mi id="S5.p1.4.m4.1.1" xref="S5.p1.4.m4.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S5.p1.4.m4.1b"><ci id="S5.p1.4.m4.1.1.cmml" xref="S5.p1.4.m4.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.4.m4.1c">R</annotation></semantics></math>, number of local training epochs <math id="S5.p1.5.m5.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.p1.5.m5.1a"><mi id="S5.p1.5.m5.1.1" xref="S5.p1.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.p1.5.m5.1b"><ci id="S5.p1.5.m5.1.1.cmml" xref="S5.p1.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.5.m5.1c">E</annotation></semantics></math>, Dirichlet alpha <math id="S5.p1.6.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.p1.6.m6.1a"><mi id="S5.p1.6.m6.1.1" xref="S5.p1.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.p1.6.m6.1b"><ci id="S5.p1.6.m6.1.1.cmml" xref="S5.p1.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.6.m6.1c">\alpha</annotation></semantics></math>, number of communication rounds <math id="S5.p1.7.m7.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S5.p1.7.m7.1a"><mi id="S5.p1.7.m7.1.1" xref="S5.p1.7.m7.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S5.p1.7.m7.1b"><ci id="S5.p1.7.m7.1.1.cmml" xref="S5.p1.7.m7.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.7.m7.1c">H</annotation></semantics></math>. For PANs, we report <math id="S5.p1.8.m8.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.p1.8.m8.1a"><mi id="S5.p1.8.m8.1.1" xref="S5.p1.8.m8.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.p1.8.m8.1b"><ci id="S5.p1.8.m8.1.1.cmml" xref="S5.p1.8.m8.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.8.m8.1c">T</annotation></semantics></math> and <math id="S5.p1.9.m9.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.p1.9.m9.1a"><mi id="S5.p1.9.m9.1.1" xref="S5.p1.9.m9.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.p1.9.m9.1b"><ci id="S5.p1.9.m9.1.1.cmml" xref="S5.p1.9.m9.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.9.m9.1c">A</annotation></semantics></math>. <span id="S5.p1.11.2" class="ltx_text ltx_font_italic">With <math id="S5.p1.10.1.m1.1" class="ltx_Math" alttext="A=0.0" display="inline"><semantics id="S5.p1.10.1.m1.1a"><mrow id="S5.p1.10.1.m1.1.1" xref="S5.p1.10.1.m1.1.1.cmml"><mi id="S5.p1.10.1.m1.1.1.2" xref="S5.p1.10.1.m1.1.1.2.cmml">A</mi><mo id="S5.p1.10.1.m1.1.1.1" xref="S5.p1.10.1.m1.1.1.1.cmml">=</mo><mn id="S5.p1.10.1.m1.1.1.3" xref="S5.p1.10.1.m1.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.10.1.m1.1b"><apply id="S5.p1.10.1.m1.1.1.cmml" xref="S5.p1.10.1.m1.1.1"><eq id="S5.p1.10.1.m1.1.1.1.cmml" xref="S5.p1.10.1.m1.1.1.1"></eq><ci id="S5.p1.10.1.m1.1.1.2.cmml" xref="S5.p1.10.1.m1.1.1.2">𝐴</ci><cn type="float" id="S5.p1.10.1.m1.1.1.3.cmml" xref="S5.p1.10.1.m1.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.10.1.m1.1c">A=0.0</annotation></semantics></math>, we turn off PANs, i.e., using traditional neurons or the baselines; with <math id="S5.p1.11.2.m2.1" class="ltx_Math" alttext="A&gt;0.0" display="inline"><semantics id="S5.p1.11.2.m2.1a"><mrow id="S5.p1.11.2.m2.1.1" xref="S5.p1.11.2.m2.1.1.cmml"><mi id="S5.p1.11.2.m2.1.1.2" xref="S5.p1.11.2.m2.1.1.2.cmml">A</mi><mo id="S5.p1.11.2.m2.1.1.1" xref="S5.p1.11.2.m2.1.1.1.cmml">&gt;</mo><mn id="S5.p1.11.2.m2.1.1.3" xref="S5.p1.11.2.m2.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.11.2.m2.1b"><apply id="S5.p1.11.2.m2.1.1.cmml" xref="S5.p1.11.2.m2.1.1"><gt id="S5.p1.11.2.m2.1.1.1.cmml" xref="S5.p1.11.2.m2.1.1.1"></gt><ci id="S5.p1.11.2.m2.1.1.2.cmml" xref="S5.p1.11.2.m2.1.1.2">𝐴</ci><cn type="float" id="S5.p1.11.2.m2.1.1.3.cmml" xref="S5.p1.11.2.m2.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.11.2.m2.1c">A&gt;0.0</annotation></semantics></math>, we turn on PANs. We </span><span id="S5.p1.12.4" class="ltx_text ltx_font_bold">leave PANs turned on by default</span><span id="S5.p1.12.3" class="ltx_text ltx_font_italic"> if with no mention of the state on/off or the value of <math id="S5.p1.12.3.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.p1.12.3.m1.1a"><mi id="S5.p1.12.3.m1.1.1" xref="S5.p1.12.3.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.p1.12.3.m1.1b"><ci id="S5.p1.12.3.m1.1.1.cmml" xref="S5.p1.12.3.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.12.3.m1.1c">A</annotation></semantics></math></span>. Details of datasets, networks and training are presented in Supp.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Centralized Training</h3>

<section id="S5.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Shuffle Test:</h4>

<div id="S5.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS1.SSS0.Px1.p1.5" class="ltx_p">We first propose a procedure to measure the degree of permutation invariance of a certain neural network, that is, how large the shuffle error in Eq. <a href="#S3.E8" title="Equation 8 ‣ 3.2 Position-Aware Neurons ‣ 3 Position-Aware Neurons ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> is after shuffling the neurons. We name this procedure <span id="S5.SS1.SSS0.Px1.p1.5.1" class="ltx_text ltx_font_italic">shuffle test</span>. Given a neural network and a batch of data, we first obtain the outputs. Then, we shuffle the neurons of hidden layers. The shuffle process is shown in Supp, where <math id="S5.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.1.m1.1a"><msub id="S5.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml">P</mi><mtext id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.2">𝑃</ci><ci id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.3a.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.1.m1.1c">P_{\text{sf}}</annotation></semantics></math> controls the disorder level of the constructed permutation matrices. Then we could get the outputs after shuffling and then calculate the shuffle error. We vary <math id="S5.SS1.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.2.m2.1a"><msub id="S5.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S5.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">P</mi><mtext id="S5.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S5.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1.2">𝑃</ci><ci id="S5.SS1.SSS0.Px1.p1.2.m2.1.1.3a.cmml" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S5.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.2.m2.1c">P_{\text{sf}}</annotation></semantics></math> in <math id="S5.SS1.SSS0.Px1.p1.3.m3.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.3.m3.2a"><mrow id="S5.SS1.SSS0.Px1.p1.3.m3.2.3.2" xref="S5.SS1.SSS0.Px1.p1.3.m3.2.3.1.cmml"><mo stretchy="false" id="S5.SS1.SSS0.Px1.p1.3.m3.2.3.2.1" xref="S5.SS1.SSS0.Px1.p1.3.m3.2.3.1.cmml">[</mo><mn id="S5.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S5.SS1.SSS0.Px1.p1.3.m3.1.1.cmml">0</mn><mo id="S5.SS1.SSS0.Px1.p1.3.m3.2.3.2.2" xref="S5.SS1.SSS0.Px1.p1.3.m3.2.3.1.cmml">,</mo><mn id="S5.SS1.SSS0.Px1.p1.3.m3.2.2" xref="S5.SS1.SSS0.Px1.p1.3.m3.2.2.cmml">1</mn><mo stretchy="false" id="S5.SS1.SSS0.Px1.p1.3.m3.2.3.2.3" xref="S5.SS1.SSS0.Px1.p1.3.m3.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.3.m3.2b"><interval closure="closed" id="S5.SS1.SSS0.Px1.p1.3.m3.2.3.1.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.2.3.2"><cn type="integer" id="S5.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.1.1">0</cn><cn type="integer" id="S5.SS1.SSS0.Px1.p1.3.m3.2.2.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.3.m3.2c">[0,1]</annotation></semantics></math> and plot the ratio of permutation matrices’ diagonal ones (i.e., how much neurons are not shuffled). We denote this ratio as <math id="S5.SS1.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="R_{\text{kept}}" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.4.m4.1a"><msub id="S5.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S5.SS1.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S5.SS1.SSS0.Px1.p1.4.m4.1.1.2" xref="S5.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml">R</mi><mtext id="S5.SS1.SSS0.Px1.p1.4.m4.1.1.3" xref="S5.SS1.SSS0.Px1.p1.4.m4.1.1.3a.cmml">kept</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.4.m4.1b"><apply id="S5.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S5.SS1.SSS0.Px1.p1.4.m4.1.1.2">𝑅</ci><ci id="S5.SS1.SSS0.Px1.p1.4.m4.1.1.3a.cmml" xref="S5.SS1.SSS0.Px1.p1.4.m4.1.1.3"><mtext mathsize="70%" id="S5.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S5.SS1.SSS0.Px1.p1.4.m4.1.1.3">kept</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.4.m4.1c">R_{\text{kept}}</annotation></semantics></math> and plot them in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.2 Applying PANs to FL ‣ 4 FL with PANs ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (average of 10 experiments), where we also show a generated permutation matrix with <math id="S5.SS1.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="P_{\text{sf}}=0.1" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.5.m5.1a"><mrow id="S5.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.cmml"><msub id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml"><mi id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.2" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.2.cmml">P</mi><mtext id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.3" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.3a.cmml">sf</mtext></msub><mo id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.1" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.3" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.5.m5.1b"><apply id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1"><eq id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.1"></eq><apply id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.1.cmml" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.2.cmml" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.2">𝑃</ci><ci id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.3a.cmml" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.3"><mtext mathsize="70%" id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.3.cmml" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.2.3">sf</mtext></ci></apply><cn type="float" id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.5.m5.1c">P_{\text{sf}}=0.1</annotation></semantics></math>.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2203.14666/assets/x3.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="178" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.20.7.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.12.6" class="ltx_text ltx_font_bold" style="font-size:90%;">Left<span id="S5.F3.9.3.3" class="ltx_text ltx_font_medium">: shuffle error (Eq. <a href="#S3.E8" title="Equation 8 ‣ 3.2 Position-Aware Neurons ‣ 3 Position-Aware Neurons ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) with various <math id="S5.F3.7.1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.F3.7.1.1.m1.1b"><mi id="S5.F3.7.1.1.m1.1.1" xref="S5.F3.7.1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.F3.7.1.1.m1.1c"><ci id="S5.F3.7.1.1.m1.1.1.cmml" xref="S5.F3.7.1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.7.1.1.m1.1d">T</annotation></semantics></math> and <math id="S5.F3.8.2.2.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.F3.8.2.2.m2.1b"><mi id="S5.F3.8.2.2.m2.1.1" xref="S5.F3.8.2.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.F3.8.2.2.m2.1c"><ci id="S5.F3.8.2.2.m2.1.1.cmml" xref="S5.F3.8.2.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.8.2.2.m2.1d">A</annotation></semantics></math> (PAN<sub id="S5.F3.9.3.3.1" class="ltx_sub">∘</sub>). </span>Right<span id="S5.F3.12.6.6" class="ltx_text ltx_font_medium">: the difference between PAN<sub id="S5.F3.12.6.6.1" class="ltx_sub">+</sub> and PAN<sub id="S5.F3.12.6.6.2" class="ltx_sub">∘</sub> (<math id="S5.F3.12.6.6.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.F3.12.6.6.m3.1b"><mi id="S5.F3.12.6.6.m3.1.1" xref="S5.F3.12.6.6.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.F3.12.6.6.m3.1c"><ci id="S5.F3.12.6.6.m3.1.1.cmml" xref="S5.F3.12.6.6.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.12.6.6.m3.1d">T</annotation></semantics></math>=1). (<span id="S5.F3.12.6.6.3" class="ltx_text" style="font-size:78%;">VGG13 is used, more networks are in Supp.</span>)</span></span></figcaption>
</figure>
</section>
<section id="S5.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Shuffle Error with Random Data:</h4>

<div id="S5.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS1.SSS0.Px2.p1.10" class="ltx_p">With different hyper-parameters of <math id="S5.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.1.m1.1a"><mi id="S5.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.1.m1.1c">T</annotation></semantics></math> and <math id="S5.SS1.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.2.m2.1a"><mi id="S5.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S5.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.2.m2.1b"><ci id="S5.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.2.m2.1c">A</annotation></semantics></math> in Eq. <a href="#S3.E4" title="Equation 4 ‣ 3.2 Position-Aware Neurons ‣ 3 Position-Aware Neurons ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>/Eq. <a href="#S3.E5" title="Equation 5 ‣ 3.2 Position-Aware Neurons ‣ 3 Position-Aware Neurons ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we use random data generated from Gaussian distributions (i.e., <math id="S5.SS1.SSS0.Px2.p1.3.m3.4" class="ltx_Math" alttext="x_{i,\cdot}\sim\mathcal{N}(0,1)" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.3.m3.4a"><mrow id="S5.SS1.SSS0.Px2.p1.3.m3.4.5" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.cmml"><msub id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.2" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.2.cmml"><mi id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.2.2" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.2.2.cmml">x</mi><mrow id="S5.SS1.SSS0.Px2.p1.3.m3.2.2.2.4" xref="S5.SS1.SSS0.Px2.p1.3.m3.2.2.2.3.cmml"><mi id="S5.SS1.SSS0.Px2.p1.3.m3.1.1.1.1" xref="S5.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.cmml">i</mi><mo rspace="0em" id="S5.SS1.SSS0.Px2.p1.3.m3.2.2.2.4.1" xref="S5.SS1.SSS0.Px2.p1.3.m3.2.2.2.3.cmml">,</mo><mo lspace="0em" id="S5.SS1.SSS0.Px2.p1.3.m3.2.2.2.2" xref="S5.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.cmml">⋅</mo></mrow></msub><mo id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.1" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.1.cmml">∼</mo><mrow id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.2" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.1" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.1.cmml">​</mo><mrow id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.3.2" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.3.1.cmml"><mo stretchy="false" id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.3.2.1" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.3.1.cmml">(</mo><mn id="S5.SS1.SSS0.Px2.p1.3.m3.3.3" xref="S5.SS1.SSS0.Px2.p1.3.m3.3.3.cmml">0</mn><mo id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.3.2.2" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.3.1.cmml">,</mo><mn id="S5.SS1.SSS0.Px2.p1.3.m3.4.4" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.4.cmml">1</mn><mo stretchy="false" id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.3.2.3" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.3.m3.4b"><apply id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5"><csymbol cd="latexml" id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.1.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.1">similar-to</csymbol><apply id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.2.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.2.1.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.2">subscript</csymbol><ci id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.2.2.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.2.2">𝑥</ci><list id="S5.SS1.SSS0.Px2.p1.3.m3.2.2.2.3.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.2.2.2.4"><ci id="S5.SS1.SSS0.Px2.p1.3.m3.1.1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.1.1.1.1">𝑖</ci><ci id="S5.SS1.SSS0.Px2.p1.3.m3.2.2.2.2.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.2.2.2.2">⋅</ci></list></apply><apply id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3"><times id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.1.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.1"></times><ci id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.2.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.2">𝒩</ci><interval closure="open" id="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.3.1.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.5.3.3.2"><cn type="integer" id="S5.SS1.SSS0.Px2.p1.3.m3.3.3.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.3.3">0</cn><cn type="integer" id="S5.SS1.SSS0.Px2.p1.3.m3.4.4.cmml" xref="S5.SS1.SSS0.Px2.p1.3.m3.4.4">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.3.m3.4c">x_{i,\cdot}\sim\mathcal{N}(0,1)</annotation></semantics></math>) to calculate the shuffle error. The results based on VGG13 are shown in Fig. <a href="#S5.F3" title="Figure 3 ‣ Shuffle Test: ‣ 5.1 Centralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The error is more related to <math id="S5.SS1.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.4.m4.1a"><mi id="S5.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S5.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.4.m4.1b"><ci id="S5.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.4.m4.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.4.m4.1c">A</annotation></semantics></math> while less sensitive to <math id="S5.SS1.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.5.m5.1a"><mi id="S5.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S5.SS1.SSS0.Px2.p1.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.5.m5.1b"><ci id="S5.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.5.m5.1c">T</annotation></semantics></math>. This is intuitive because <math id="S5.SS1.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.6.m6.1a"><mi id="S5.SS1.SSS0.Px2.p1.6.m6.1.1" xref="S5.SS1.SSS0.Px2.p1.6.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.6.m6.1b"><ci id="S5.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.6.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.6.m6.1c">T</annotation></semantics></math> controls local volatility while neuron permutation could happen globally, e.g., the first neuron could swap positions with the last neuron. A larger <math id="S5.SS1.SSS0.Px2.p1.7.m7.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.7.m7.1a"><mi id="S5.SS1.SSS0.Px2.p1.7.m7.1.1" xref="S5.SS1.SSS0.Px2.p1.7.m7.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.7.m7.1b"><ci id="S5.SS1.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.7.m7.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.7.m7.1c">A</annotation></semantics></math> leads to a larger shuffle error, i.e., the more serious the network loses the permutation invariance property. In addition, the shuffle error based on the additive PANs increases linearly, while that based on the multiplicative PANs increases quickly. This verifies the theoretical analysis in Sect. <a href="#S3.SS2" title="3.2 Position-Aware Neurons ‣ 3 Position-Aware Neurons ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>. However, in practice, a larger <math id="S5.SS1.SSS0.Px2.p1.8.m8.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.8.m8.1a"><mi id="S5.SS1.SSS0.Px2.p1.8.m8.1.1" xref="S5.SS1.SSS0.Px2.p1.8.m8.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.8.m8.1b"><ci id="S5.SS1.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.8.m8.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.8.m8.1c">A</annotation></semantics></math> may cause training failure and we only set <math id="S5.SS1.SSS0.Px2.p1.9.m9.2" class="ltx_Math" alttext="A\in[0.0,0.25]" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.9.m9.2a"><mrow id="S5.SS1.SSS0.Px2.p1.9.m9.2.3" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.3.cmml"><mi id="S5.SS1.SSS0.Px2.p1.9.m9.2.3.2" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.3.2.cmml">A</mi><mo id="S5.SS1.SSS0.Px2.p1.9.m9.2.3.1" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.3.1.cmml">∈</mo><mrow id="S5.SS1.SSS0.Px2.p1.9.m9.2.3.3.2" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS1.SSS0.Px2.p1.9.m9.2.3.3.2.1" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.3.3.1.cmml">[</mo><mn id="S5.SS1.SSS0.Px2.p1.9.m9.1.1" xref="S5.SS1.SSS0.Px2.p1.9.m9.1.1.cmml">0.0</mn><mo id="S5.SS1.SSS0.Px2.p1.9.m9.2.3.3.2.2" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.3.3.1.cmml">,</mo><mn id="S5.SS1.SSS0.Px2.p1.9.m9.2.2" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.2.cmml">0.25</mn><mo stretchy="false" id="S5.SS1.SSS0.Px2.p1.9.m9.2.3.3.2.3" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.9.m9.2b"><apply id="S5.SS1.SSS0.Px2.p1.9.m9.2.3.cmml" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.3"><in id="S5.SS1.SSS0.Px2.p1.9.m9.2.3.1.cmml" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.3.1"></in><ci id="S5.SS1.SSS0.Px2.p1.9.m9.2.3.2.cmml" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.3.2">𝐴</ci><interval closure="closed" id="S5.SS1.SSS0.Px2.p1.9.m9.2.3.3.1.cmml" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.3.3.2"><cn type="float" id="S5.SS1.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.9.m9.1.1">0.0</cn><cn type="float" id="S5.SS1.SSS0.Px2.p1.9.m9.2.2.cmml" xref="S5.SS1.SSS0.Px2.p1.9.m9.2.2">0.25</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.9.m9.2c">A\in[0.0,0.25]</annotation></semantics></math> for additive PANs and <math id="S5.SS1.SSS0.Px2.p1.10.m10.2" class="ltx_Math" alttext="A\in[0.0,0.75]" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.10.m10.2a"><mrow id="S5.SS1.SSS0.Px2.p1.10.m10.2.3" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.3.cmml"><mi id="S5.SS1.SSS0.Px2.p1.10.m10.2.3.2" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.3.2.cmml">A</mi><mo id="S5.SS1.SSS0.Px2.p1.10.m10.2.3.1" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.3.1.cmml">∈</mo><mrow id="S5.SS1.SSS0.Px2.p1.10.m10.2.3.3.2" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS1.SSS0.Px2.p1.10.m10.2.3.3.2.1" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.3.3.1.cmml">[</mo><mn id="S5.SS1.SSS0.Px2.p1.10.m10.1.1" xref="S5.SS1.SSS0.Px2.p1.10.m10.1.1.cmml">0.0</mn><mo id="S5.SS1.SSS0.Px2.p1.10.m10.2.3.3.2.2" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.3.3.1.cmml">,</mo><mn id="S5.SS1.SSS0.Px2.p1.10.m10.2.2" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.2.cmml">0.75</mn><mo stretchy="false" id="S5.SS1.SSS0.Px2.p1.10.m10.2.3.3.2.3" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.10.m10.2b"><apply id="S5.SS1.SSS0.Px2.p1.10.m10.2.3.cmml" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.3"><in id="S5.SS1.SSS0.Px2.p1.10.m10.2.3.1.cmml" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.3.1"></in><ci id="S5.SS1.SSS0.Px2.p1.10.m10.2.3.2.cmml" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.3.2">𝐴</ci><interval closure="closed" id="S5.SS1.SSS0.Px2.p1.10.m10.2.3.3.1.cmml" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.3.3.2"><cn type="float" id="S5.SS1.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.10.m10.1.1">0.0</cn><cn type="float" id="S5.SS1.SSS0.Px2.p1.10.m10.2.2.cmml" xref="S5.SS1.SSS0.Px2.p1.10.m10.2.2">0.75</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.10.m10.2c">A\in[0.0,0.75]</annotation></semantics></math> for multiplicative PANs (the bold part on the right side of Fig. <a href="#S5.F3" title="Figure 3 ‣ Shuffle Test: ‣ 5.1 Centralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
<figure id="S5.F4" class="ltx_figure"><img src="/html/2203.14666/assets/x4.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="325" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.6.2.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">The first<span id="S5.F4.2.1.2" class="ltx_text ltx_font_medium">: test accuracy of models trained with different PANs. </span>The other three<span id="S5.F4.2.1.1" class="ltx_text ltx_font_medium">: test accuracy change after manual permutation with various <math id="S5.F4.2.1.1.m1.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="S5.F4.2.1.1.m1.1b"><msub id="S5.F4.2.1.1.m1.1.1" xref="S5.F4.2.1.1.m1.1.1.cmml"><mi id="S5.F4.2.1.1.m1.1.1.2" xref="S5.F4.2.1.1.m1.1.1.2.cmml">P</mi><mtext id="S5.F4.2.1.1.m1.1.1.3" xref="S5.F4.2.1.1.m1.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.F4.2.1.1.m1.1c"><apply id="S5.F4.2.1.1.m1.1.1.cmml" xref="S5.F4.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F4.2.1.1.m1.1.1.1.cmml" xref="S5.F4.2.1.1.m1.1.1">subscript</csymbol><ci id="S5.F4.2.1.1.m1.1.1.2.cmml" xref="S5.F4.2.1.1.m1.1.1.2">𝑃</ci><ci id="S5.F4.2.1.1.m1.1.1.3a.cmml" xref="S5.F4.2.1.1.m1.1.1.3"><mtext mathsize="70%" id="S5.F4.2.1.1.m1.1.1.3.cmml" xref="S5.F4.2.1.1.m1.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.2.1.1.m1.1d">P_{\text{sf}}</annotation></semantics></math>. </span></span></figcaption>
</figure>
</section>
<section id="S5.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Influence on Inference:</h4>

<div id="S5.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="S5.SS1.SSS0.Px3.p1.16" class="ltx_p">We study the influence of PANs on test accuracies. We use MLP on Mnist, VGG13 on SVHN, and ResNet20 on Cifar10. We first train models with various PANs until convergence, and the model performances are shown in the first figure of Fig. <a href="#S5.F4" title="Figure 4 ‣ Shuffle Error with Random Data: ‣ 5.1 Centralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. The horizontal dotted lines show the accuracies of normal networks, and the solid segments show the results of networks with various PANs. We find that introducing PANs to neural networks does not improve performances, but brings a slight degradation. That is, PANs could make the network somewhat harder to train. More studies of how PANs influence the network predictions could be found in Supp. Then, we investigate the shuffle error reflected by the change of test accuracies. Specifically, we shuffle the trained network to make predictions on the test set. We vary several groups of <math id="S5.SS1.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.1.m1.1a"><mi id="S5.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.1.m1.1b"><ci id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.1.m1.1c">T</annotation></semantics></math> and <math id="S5.SS1.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.2.m2.1a"><mi id="S5.SS1.SSS0.Px3.p1.2.m2.1.1" xref="S5.SS1.SSS0.Px3.p1.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.2.m2.1b"><ci id="S5.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.2.m2.1c">A</annotation></semantics></math> for PANs. We show the results in the last three figures of Fig. <a href="#S5.F4" title="Figure 4 ‣ Shuffle Error with Random Data: ‣ 5.1 Centralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. With larger <math id="S5.SS1.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.3.m3.1a"><msub id="S5.SS1.SSS0.Px3.p1.3.m3.1.1" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.2" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml">P</mi><mtext id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.3" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.3.m3.1b"><apply id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.2">𝑃</ci><ci id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.3a.cmml" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.3"><mtext mathsize="70%" id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.3.m3.1c">P_{\text{sf}}</annotation></semantics></math>, i.e., more neurons are shuffled, the test accuracy of the network with <math id="S5.SS1.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="A=0.0" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.4.m4.1a"><mrow id="S5.SS1.SSS0.Px3.p1.4.m4.1.1" xref="S5.SS1.SSS0.Px3.p1.4.m4.1.1.cmml"><mi id="S5.SS1.SSS0.Px3.p1.4.m4.1.1.2" xref="S5.SS1.SSS0.Px3.p1.4.m4.1.1.2.cmml">A</mi><mo id="S5.SS1.SSS0.Px3.p1.4.m4.1.1.1" xref="S5.SS1.SSS0.Px3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px3.p1.4.m4.1.1.3" xref="S5.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.4.m4.1b"><apply id="S5.SS1.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.4.m4.1.1"><eq id="S5.SS1.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.4.m4.1.1.1"></eq><ci id="S5.SS1.SSS0.Px3.p1.4.m4.1.1.2.cmml" xref="S5.SS1.SSS0.Px3.p1.4.m4.1.1.2">𝐴</ci><cn type="float" id="S5.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml" xref="S5.SS1.SSS0.Px3.p1.4.m4.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.4.m4.1c">A=0.0</annotation></semantics></math> does not change (the permutation invariance property). However, larger <math id="S5.SS1.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.5.m5.1a"><mi id="S5.SS1.SSS0.Px3.p1.5.m5.1.1" xref="S5.SS1.SSS0.Px3.p1.5.m5.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.5.m5.1b"><ci id="S5.SS1.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.5.m5.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.5.m5.1c">A</annotation></semantics></math> leads to more significant performance degradation (<math id="S5.SS1.SSS0.Px3.p1.6.m6.1" class="ltx_Math" alttext="A=0.25" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.6.m6.1a"><mrow id="S5.SS1.SSS0.Px3.p1.6.m6.1.1" xref="S5.SS1.SSS0.Px3.p1.6.m6.1.1.cmml"><mi id="S5.SS1.SSS0.Px3.p1.6.m6.1.1.2" xref="S5.SS1.SSS0.Px3.p1.6.m6.1.1.2.cmml">A</mi><mo id="S5.SS1.SSS0.Px3.p1.6.m6.1.1.1" xref="S5.SS1.SSS0.Px3.p1.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px3.p1.6.m6.1.1.3" xref="S5.SS1.SSS0.Px3.p1.6.m6.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.6.m6.1b"><apply id="S5.SS1.SSS0.Px3.p1.6.m6.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.6.m6.1.1"><eq id="S5.SS1.SSS0.Px3.p1.6.m6.1.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.6.m6.1.1.1"></eq><ci id="S5.SS1.SSS0.Px3.p1.6.m6.1.1.2.cmml" xref="S5.SS1.SSS0.Px3.p1.6.m6.1.1.2">𝐴</ci><cn type="float" id="S5.SS1.SSS0.Px3.p1.6.m6.1.1.3.cmml" xref="S5.SS1.SSS0.Px3.p1.6.m6.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.6.m6.1c">A=0.25</annotation></semantics></math> vs. <math id="S5.SS1.SSS0.Px3.p1.7.m7.1" class="ltx_Math" alttext="A=0.01" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.7.m7.1a"><mrow id="S5.SS1.SSS0.Px3.p1.7.m7.1.1" xref="S5.SS1.SSS0.Px3.p1.7.m7.1.1.cmml"><mi id="S5.SS1.SSS0.Px3.p1.7.m7.1.1.2" xref="S5.SS1.SSS0.Px3.p1.7.m7.1.1.2.cmml">A</mi><mo id="S5.SS1.SSS0.Px3.p1.7.m7.1.1.1" xref="S5.SS1.SSS0.Px3.p1.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px3.p1.7.m7.1.1.3" xref="S5.SS1.SSS0.Px3.p1.7.m7.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.7.m7.1b"><apply id="S5.SS1.SSS0.Px3.p1.7.m7.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.7.m7.1.1"><eq id="S5.SS1.SSS0.Px3.p1.7.m7.1.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.7.m7.1.1.1"></eq><ci id="S5.SS1.SSS0.Px3.p1.7.m7.1.1.2.cmml" xref="S5.SS1.SSS0.Px3.p1.7.m7.1.1.2">𝐴</ci><cn type="float" id="S5.SS1.SSS0.Px3.p1.7.m7.1.1.3.cmml" xref="S5.SS1.SSS0.Px3.p1.7.m7.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.7.m7.1c">A=0.01</annotation></semantics></math> for PAN<sub id="S5.SS1.SSS0.Px3.p1.16.1" class="ltx_sub">+</sub>; <math id="S5.SS1.SSS0.Px3.p1.9.m9.1" class="ltx_Math" alttext="A=0.75" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.9.m9.1a"><mrow id="S5.SS1.SSS0.Px3.p1.9.m9.1.1" xref="S5.SS1.SSS0.Px3.p1.9.m9.1.1.cmml"><mi id="S5.SS1.SSS0.Px3.p1.9.m9.1.1.2" xref="S5.SS1.SSS0.Px3.p1.9.m9.1.1.2.cmml">A</mi><mo id="S5.SS1.SSS0.Px3.p1.9.m9.1.1.1" xref="S5.SS1.SSS0.Px3.p1.9.m9.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px3.p1.9.m9.1.1.3" xref="S5.SS1.SSS0.Px3.p1.9.m9.1.1.3.cmml">0.75</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.9.m9.1b"><apply id="S5.SS1.SSS0.Px3.p1.9.m9.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.9.m9.1.1"><eq id="S5.SS1.SSS0.Px3.p1.9.m9.1.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.9.m9.1.1.1"></eq><ci id="S5.SS1.SSS0.Px3.p1.9.m9.1.1.2.cmml" xref="S5.SS1.SSS0.Px3.p1.9.m9.1.1.2">𝐴</ci><cn type="float" id="S5.SS1.SSS0.Px3.p1.9.m9.1.1.3.cmml" xref="S5.SS1.SSS0.Px3.p1.9.m9.1.1.3">0.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.9.m9.1c">A=0.75</annotation></semantics></math> vs. <math id="S5.SS1.SSS0.Px3.p1.10.m10.1" class="ltx_Math" alttext="A=0.05" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.10.m10.1a"><mrow id="S5.SS1.SSS0.Px3.p1.10.m10.1.1" xref="S5.SS1.SSS0.Px3.p1.10.m10.1.1.cmml"><mi id="S5.SS1.SSS0.Px3.p1.10.m10.1.1.2" xref="S5.SS1.SSS0.Px3.p1.10.m10.1.1.2.cmml">A</mi><mo id="S5.SS1.SSS0.Px3.p1.10.m10.1.1.1" xref="S5.SS1.SSS0.Px3.p1.10.m10.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px3.p1.10.m10.1.1.3" xref="S5.SS1.SSS0.Px3.p1.10.m10.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.10.m10.1b"><apply id="S5.SS1.SSS0.Px3.p1.10.m10.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.10.m10.1.1"><eq id="S5.SS1.SSS0.Px3.p1.10.m10.1.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.10.m10.1.1.1"></eq><ci id="S5.SS1.SSS0.Px3.p1.10.m10.1.1.2.cmml" xref="S5.SS1.SSS0.Px3.p1.10.m10.1.1.2">𝐴</ci><cn type="float" id="S5.SS1.SSS0.Px3.p1.10.m10.1.1.3.cmml" xref="S5.SS1.SSS0.Px3.p1.10.m10.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.10.m10.1c">A=0.05</annotation></semantics></math> for PAN<sub id="S5.SS1.SSS0.Px3.p1.16.2" class="ltx_sub">∘</sub>). PAN<sub id="S5.SS1.SSS0.Px3.p1.16.3" class="ltx_sub">∘</sub> makes the network more sensitive to shuffling than PAN<sub id="S5.SS1.SSS0.Px3.p1.16.4" class="ltx_sub">+</sub> (curves with “<math id="S5.SS1.SSS0.Px3.p1.14.m14.1" class="ltx_Math" alttext="\circ" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.14.m14.1a"><mo id="S5.SS1.SSS0.Px3.p1.14.m14.1.1" xref="S5.SS1.SSS0.Px3.p1.14.m14.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.14.m14.1b"><compose id="S5.SS1.SSS0.Px3.p1.14.m14.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.14.m14.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.14.m14.1c">\circ</annotation></semantics></math>” degrades significantly). With different <math id="S5.SS1.SSS0.Px3.p1.15.m15.2" class="ltx_Math" alttext="T\in\{1,8\}" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.15.m15.2a"><mrow id="S5.SS1.SSS0.Px3.p1.15.m15.2.3" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.3.cmml"><mi id="S5.SS1.SSS0.Px3.p1.15.m15.2.3.2" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.3.2.cmml">T</mi><mo id="S5.SS1.SSS0.Px3.p1.15.m15.2.3.1" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.3.1.cmml">∈</mo><mrow id="S5.SS1.SSS0.Px3.p1.15.m15.2.3.3.2" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS1.SSS0.Px3.p1.15.m15.2.3.3.2.1" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.3.3.1.cmml">{</mo><mn id="S5.SS1.SSS0.Px3.p1.15.m15.1.1" xref="S5.SS1.SSS0.Px3.p1.15.m15.1.1.cmml">1</mn><mo id="S5.SS1.SSS0.Px3.p1.15.m15.2.3.3.2.2" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.3.3.1.cmml">,</mo><mn id="S5.SS1.SSS0.Px3.p1.15.m15.2.2" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.2.cmml">8</mn><mo stretchy="false" id="S5.SS1.SSS0.Px3.p1.15.m15.2.3.3.2.3" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.15.m15.2b"><apply id="S5.SS1.SSS0.Px3.p1.15.m15.2.3.cmml" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.3"><in id="S5.SS1.SSS0.Px3.p1.15.m15.2.3.1.cmml" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.3.1"></in><ci id="S5.SS1.SSS0.Px3.p1.15.m15.2.3.2.cmml" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.3.2">𝑇</ci><set id="S5.SS1.SSS0.Px3.p1.15.m15.2.3.3.1.cmml" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.3.3.2"><cn type="integer" id="S5.SS1.SSS0.Px3.p1.15.m15.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.15.m15.1.1">1</cn><cn type="integer" id="S5.SS1.SSS0.Px3.p1.15.m15.2.2.cmml" xref="S5.SS1.SSS0.Px3.p1.15.m15.2.2">8</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.15.m15.2c">T\in\{1,8\}</annotation></semantics></math>, the performance degradation is nearly the same, again showing that PANs are robust to <math id="S5.SS1.SSS0.Px3.p1.16.m16.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.16.m16.1a"><mi id="S5.SS1.SSS0.Px3.p1.16.m16.1.1" xref="S5.SS1.SSS0.Px3.p1.16.m16.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.16.m16.1b"><ci id="S5.SS1.SSS0.Px3.p1.16.m16.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.16.m16.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.16.m16.1c">T</annotation></semantics></math>. These verify the conclusions in Sect. <a href="#S3.SS2" title="3.2 Position-Aware Neurons ‣ 3 Position-Aware Neurons ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>. <span id="S5.SS1.SSS0.Px3.p1.16.5" class="ltx_text ltx_font_italic">Overall, PANs work as a tradeoff between model performances and control of permutation invariance.</span></p>
</div>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F5.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2203.14666/assets/x5.png" id="S5.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="120" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F5.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2203.14666/assets/x6.png" id="S5.F5.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="151" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.12.4.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S5.F5.8.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Top<span id="S5.F5.6.1.1" class="ltx_text ltx_font_medium">: how much neurons are not shuffled with various <math id="S5.F5.6.1.1.m1.1" class="ltx_Math" alttext="N_{\text{sf}}" display="inline"><semantics id="S5.F5.6.1.1.m1.1b"><msub id="S5.F5.6.1.1.m1.1.1" xref="S5.F5.6.1.1.m1.1.1.cmml"><mi id="S5.F5.6.1.1.m1.1.1.2" xref="S5.F5.6.1.1.m1.1.1.2.cmml">N</mi><mtext id="S5.F5.6.1.1.m1.1.1.3" xref="S5.F5.6.1.1.m1.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.F5.6.1.1.m1.1c"><apply id="S5.F5.6.1.1.m1.1.1.cmml" xref="S5.F5.6.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F5.6.1.1.m1.1.1.1.cmml" xref="S5.F5.6.1.1.m1.1.1">subscript</csymbol><ci id="S5.F5.6.1.1.m1.1.1.2.cmml" xref="S5.F5.6.1.1.m1.1.1.2">𝑁</ci><ci id="S5.F5.6.1.1.m1.1.1.3a.cmml" xref="S5.F5.6.1.1.m1.1.1.3"><mtext mathsize="70%" id="S5.F5.6.1.1.m1.1.1.3.cmml" xref="S5.F5.6.1.1.m1.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.6.1.1.m1.1d">N_{\text{sf}}</annotation></semantics></math>. </span>Bottom<span id="S5.F5.8.3.3" class="ltx_text ltx_font_medium">: test accuracies of FL with various <math id="S5.F5.7.2.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.F5.7.2.2.m1.1b"><mi id="S5.F5.7.2.2.m1.1.1" xref="S5.F5.7.2.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.F5.7.2.2.m1.1c"><ci id="S5.F5.7.2.2.m1.1.1.cmml" xref="S5.F5.7.2.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.7.2.2.m1.1d">\alpha</annotation></semantics></math> (dotted lines) and accuracies after manual shufflling on i.i.d. data (<math id="S5.F5.8.3.3.m2.1" class="ltx_Math" alttext="\alpha=10.0" display="inline"><semantics id="S5.F5.8.3.3.m2.1b"><mrow id="S5.F5.8.3.3.m2.1.1" xref="S5.F5.8.3.3.m2.1.1.cmml"><mi id="S5.F5.8.3.3.m2.1.1.2" xref="S5.F5.8.3.3.m2.1.1.2.cmml">α</mi><mo id="S5.F5.8.3.3.m2.1.1.1" xref="S5.F5.8.3.3.m2.1.1.1.cmml">=</mo><mn id="S5.F5.8.3.3.m2.1.1.3" xref="S5.F5.8.3.3.m2.1.1.3.cmml">10.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F5.8.3.3.m2.1c"><apply id="S5.F5.8.3.3.m2.1.1.cmml" xref="S5.F5.8.3.3.m2.1.1"><eq id="S5.F5.8.3.3.m2.1.1.1.cmml" xref="S5.F5.8.3.3.m2.1.1.1"></eq><ci id="S5.F5.8.3.3.m2.1.1.2.cmml" xref="S5.F5.8.3.3.m2.1.1.2">𝛼</ci><cn type="float" id="S5.F5.8.3.3.m2.1.1.3.cmml" xref="S5.F5.8.3.3.m2.1.1.3">10.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.8.3.3.m2.1d">\alpha=10.0</annotation></semantics></math>) (red scatters).</span></span></figcaption>
</figure>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Decentralized Training</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">Then we study the effects of introducing PANs to FL. We first present some empirical studies to verify the pre-alignment effects of PANs, and then show performances.</p>
</div>
<section id="S5.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">How many neurons are misaligned in FL?</h4>

<div id="S5.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px1.p1.17" class="ltx_p">Although some previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> declare that neurons could be dislocated when faced with non-i.i.d. data, they do not show this in evidence and do not show the degree of misalignment. We present a heuristic method: <span id="S5.SS2.SSS0.Px1.p1.17.1" class="ltx_text ltx_font_italic">we manually shuffle the neurons during local training with i.i.d. data and study how much misalignment could cause the performance to drop to the same as training with non-i.i.d. data</span>. Specifically, during each client’s training step (each batch as a step), we shuffle the neurons with a probability <math id="S5.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\frac{N_{\text{sf}}}{E\times N_{k}/B}" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.1.m1.1a"><mfrac id="S5.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><msub id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml"><mi id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.2" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.cmml">N</mi><mtext id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.3" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.3a.cmml">sf</mtext></msub><mrow id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mrow id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.cmml"><mi id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.2" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.2.cmml">E</mi><mo lspace="0.222em" rspace="0.222em" id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.1" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.1.cmml">×</mo><msub id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.cmml"><mi id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.2" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.2.cmml">N</mi><mi id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.3" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.3.cmml">k</mi></msub></mrow><mo id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.1" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.1.cmml">/</mo><mi id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.cmml">B</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1"><divide id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1"></divide><apply id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.1.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.2.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.2">𝑁</ci><ci id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.3a.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.3"><mtext mathsize="50%" id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.3.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.3">sf</mtext></ci></apply><apply id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3"><divide id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.1"></divide><apply id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2"><times id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.1.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.1"></times><ci id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.2.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.2">𝐸</ci><apply id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.1.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.2.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.2">𝑁</ci><ci id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.3.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.3.3">𝑘</ci></apply></apply><ci id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.1.m1.1c">\frac{N_{\text{sf}}}{E\times N_{k}/B}</annotation></semantics></math>, where <math id="S5.SS2.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.2.m2.1a"><mi id="S5.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.2.m2.1b"><ci id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.2.m2.1c">B</annotation></semantics></math>,<math id="S5.SS2.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.3.m3.1a"><mi id="S5.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.3.m3.1b"><ci id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.3.m3.1c">E</annotation></semantics></math>,<math id="S5.SS2.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="N_{k}" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.4.m4.1a"><msub id="S5.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S5.SS2.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S5.SS2.SSS0.Px1.p1.4.m4.1.1.2" xref="S5.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml">N</mi><mi id="S5.SS2.SSS0.Px1.p1.4.m4.1.1.3" xref="S5.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.4.m4.1b"><apply id="S5.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.4.m4.1.1.2">𝑁</ci><ci id="S5.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.4.m4.1c">N_{k}</annotation></semantics></math> are respectively the batch size, the number of local epochs, and the number of local data samples. In each shuffle process, we keep <math id="S5.SS2.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="P_{\text{sf}}=0.1" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.5.m5.1a"><mrow id="S5.SS2.SSS0.Px1.p1.5.m5.1.1" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.cmml"><msub id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.cmml"><mi id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.2" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.cmml">P</mi><mtext id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.3" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.3a.cmml">sf</mtext></msub><mo id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.1" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.3" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.5.m5.1b"><apply id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1"><eq id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.1"></eq><apply id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.1.cmml" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.cmml" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.2">𝑃</ci><ci id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.3a.cmml" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.3"><mtext mathsize="70%" id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.cmml" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.2.3">sf</mtext></ci></apply><cn type="float" id="S5.SS2.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.5.m5.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.5.m5.1c">P_{\text{sf}}=0.1</annotation></semantics></math>. <math id="S5.SS2.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="N_{\text{sf}}" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.6.m6.1a"><msub id="S5.SS2.SSS0.Px1.p1.6.m6.1.1" xref="S5.SS2.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S5.SS2.SSS0.Px1.p1.6.m6.1.1.2" xref="S5.SS2.SSS0.Px1.p1.6.m6.1.1.2.cmml">N</mi><mtext id="S5.SS2.SSS0.Px1.p1.6.m6.1.1.3" xref="S5.SS2.SSS0.Px1.p1.6.m6.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.6.m6.1b"><apply id="S5.SS2.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.6.m6.1.1.2">𝑁</ci><ci id="S5.SS2.SSS0.Px1.p1.6.m6.1.1.3a.cmml" xref="S5.SS2.SSS0.Px1.p1.6.m6.1.1.3"><mtext mathsize="70%" id="S5.SS2.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.6.m6.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.6.m6.1c">N_{\text{sf}}</annotation></semantics></math> determines how many times the network could be shuffled during local training. Larger <math id="S5.SS2.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="N_{\text{sf}}" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.7.m7.1a"><msub id="S5.SS2.SSS0.Px1.p1.7.m7.1.1" xref="S5.SS2.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S5.SS2.SSS0.Px1.p1.7.m7.1.1.2" xref="S5.SS2.SSS0.Px1.p1.7.m7.1.1.2.cmml">N</mi><mtext id="S5.SS2.SSS0.Px1.p1.7.m7.1.1.3" xref="S5.SS2.SSS0.Px1.p1.7.m7.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.7.m7.1b"><apply id="S5.SS2.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.7.m7.1.1.2">𝑁</ci><ci id="S5.SS2.SSS0.Px1.p1.7.m7.1.1.3a.cmml" xref="S5.SS2.SSS0.Px1.p1.7.m7.1.1.3"><mtext mathsize="70%" id="S5.SS2.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.7.m7.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.7.m7.1c">N_{\text{sf}}</annotation></semantics></math> means more neurons are shuffled upon finishing training, e.g., <math id="S5.SS2.SSS0.Px1.p1.8.m8.1" class="ltx_Math" alttext="N_{\text{sf}}=1.0" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.8.m8.1a"><mrow id="S5.SS2.SSS0.Px1.p1.8.m8.1.1" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.cmml"><msub id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.cmml"><mi id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.2" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.2.cmml">N</mi><mtext id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.3" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.3a.cmml">sf</mtext></msub><mo id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.1" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.3" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.8.m8.1b"><apply id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1"><eq id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.1"></eq><apply id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.1.cmml" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.2.cmml" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.2">𝑁</ci><ci id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.3a.cmml" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.3"><mtext mathsize="70%" id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.3.cmml" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.2.3">sf</mtext></ci></apply><cn type="float" id="S5.SS2.SSS0.Px1.p1.8.m8.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.8.m8.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.8.m8.1c">N_{\text{sf}}=1.0</annotation></semantics></math> keeps approximately <math id="S5.SS2.SSS0.Px1.p1.9.m9.1" class="ltx_Math" alttext="84\%" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.9.m9.1a"><mrow id="S5.SS2.SSS0.Px1.p1.9.m9.1.1" xref="S5.SS2.SSS0.Px1.p1.9.m9.1.1.cmml"><mn id="S5.SS2.SSS0.Px1.p1.9.m9.1.1.2" xref="S5.SS2.SSS0.Px1.p1.9.m9.1.1.2.cmml">84</mn><mo id="S5.SS2.SSS0.Px1.p1.9.m9.1.1.1" xref="S5.SS2.SSS0.Px1.p1.9.m9.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.9.m9.1b"><apply id="S5.SS2.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.9.m9.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px1.p1.9.m9.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.9.m9.1.1.1">percent</csymbol><cn type="integer" id="S5.SS2.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.9.m9.1.1.2">84</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.9.m9.1c">84\%</annotation></semantics></math> neurons not shuffled as shown in Fig. <a href="#S5.F5" title="Figure 5 ‣ Influence on Inference: ‣ 5.1 Centralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The calculation of <math id="S5.SS2.SSS0.Px1.p1.10.m10.1" class="ltx_Math" alttext="R_{\text{kept}}" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.10.m10.1a"><msub id="S5.SS2.SSS0.Px1.p1.10.m10.1.1" xref="S5.SS2.SSS0.Px1.p1.10.m10.1.1.cmml"><mi id="S5.SS2.SSS0.Px1.p1.10.m10.1.1.2" xref="S5.SS2.SSS0.Px1.p1.10.m10.1.1.2.cmml">R</mi><mtext id="S5.SS2.SSS0.Px1.p1.10.m10.1.1.3" xref="S5.SS2.SSS0.Px1.p1.10.m10.1.1.3a.cmml">kept</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.10.m10.1b"><apply id="S5.SS2.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.10.m10.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.10.m10.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.10.m10.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.10.m10.1.1.2">𝑅</ci><ci id="S5.SS2.SSS0.Px1.p1.10.m10.1.1.3a.cmml" xref="S5.SS2.SSS0.Px1.p1.10.m10.1.1.3"><mtext mathsize="70%" id="S5.SS2.SSS0.Px1.p1.10.m10.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.10.m10.1.1.3">kept</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.10.m10.1c">R_{\text{kept}}</annotation></semantics></math> in Fig. <a href="#S5.F5" title="Figure 5 ‣ Influence on Inference: ‣ 5.1 Centralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> is presented in Supp. Then, we show the test accuracies of FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> under various levels of non-i.i.d. data, i.e., <math id="S5.SS2.SSS0.Px1.p1.11.m11.3" class="ltx_Math" alttext="\alpha\in\{10.0,1.0,0.1\}" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.11.m11.3a"><mrow id="S5.SS2.SSS0.Px1.p1.11.m11.3.4" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.4.cmml"><mi id="S5.SS2.SSS0.Px1.p1.11.m11.3.4.2" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.4.2.cmml">α</mi><mo id="S5.SS2.SSS0.Px1.p1.11.m11.3.4.1" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.4.1.cmml">∈</mo><mrow id="S5.SS2.SSS0.Px1.p1.11.m11.3.4.3.2" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.4.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px1.p1.11.m11.3.4.3.2.1" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.4.3.1.cmml">{</mo><mn id="S5.SS2.SSS0.Px1.p1.11.m11.1.1" xref="S5.SS2.SSS0.Px1.p1.11.m11.1.1.cmml">10.0</mn><mo id="S5.SS2.SSS0.Px1.p1.11.m11.3.4.3.2.2" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.4.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px1.p1.11.m11.2.2" xref="S5.SS2.SSS0.Px1.p1.11.m11.2.2.cmml">1.0</mn><mo id="S5.SS2.SSS0.Px1.p1.11.m11.3.4.3.2.3" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.4.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px1.p1.11.m11.3.3" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.3.cmml">0.1</mn><mo stretchy="false" id="S5.SS2.SSS0.Px1.p1.11.m11.3.4.3.2.4" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.11.m11.3b"><apply id="S5.SS2.SSS0.Px1.p1.11.m11.3.4.cmml" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.4"><in id="S5.SS2.SSS0.Px1.p1.11.m11.3.4.1.cmml" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.4.1"></in><ci id="S5.SS2.SSS0.Px1.p1.11.m11.3.4.2.cmml" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.4.2">𝛼</ci><set id="S5.SS2.SSS0.Px1.p1.11.m11.3.4.3.1.cmml" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.4.3.2"><cn type="float" id="S5.SS2.SSS0.Px1.p1.11.m11.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.11.m11.1.1">10.0</cn><cn type="float" id="S5.SS2.SSS0.Px1.p1.11.m11.2.2.cmml" xref="S5.SS2.SSS0.Px1.p1.11.m11.2.2">1.0</cn><cn type="float" id="S5.SS2.SSS0.Px1.p1.11.m11.3.3.cmml" xref="S5.SS2.SSS0.Px1.p1.11.m11.3.3">0.1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.11.m11.3c">\alpha\in\{10.0,1.0,0.1\}</annotation></semantics></math>. The results correspond to the three horizontal lines in the bottom three figures of Fig. <a href="#S5.F5" title="Figure 5 ‣ Influence on Inference: ‣ 5.1 Centralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The scatters in red show the performances of shuffling neurons with various <math id="S5.SS2.SSS0.Px1.p1.12.m12.1" class="ltx_Math" alttext="N_{\text{sf}}" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.12.m12.1a"><msub id="S5.SS2.SSS0.Px1.p1.12.m12.1.1" xref="S5.SS2.SSS0.Px1.p1.12.m12.1.1.cmml"><mi id="S5.SS2.SSS0.Px1.p1.12.m12.1.1.2" xref="S5.SS2.SSS0.Px1.p1.12.m12.1.1.2.cmml">N</mi><mtext id="S5.SS2.SSS0.Px1.p1.12.m12.1.1.3" xref="S5.SS2.SSS0.Px1.p1.12.m12.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.12.m12.1b"><apply id="S5.SS2.SSS0.Px1.p1.12.m12.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.12.m12.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.12.m12.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.12.m12.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.12.m12.1.1.2">𝑁</ci><ci id="S5.SS2.SSS0.Px1.p1.12.m12.1.1.3a.cmml" xref="S5.SS2.SSS0.Px1.p1.12.m12.1.1.3"><mtext mathsize="70%" id="S5.SS2.SSS0.Px1.p1.12.m12.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.12.m12.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.12.m12.1c">N_{\text{sf}}</annotation></semantics></math>. Obviously, even with i.i.d. data, the larger the <math id="S5.SS2.SSS0.Px1.p1.13.m13.1" class="ltx_Math" alttext="N_{\text{sf}}" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.13.m13.1a"><msub id="S5.SS2.SSS0.Px1.p1.13.m13.1.1" xref="S5.SS2.SSS0.Px1.p1.13.m13.1.1.cmml"><mi id="S5.SS2.SSS0.Px1.p1.13.m13.1.1.2" xref="S5.SS2.SSS0.Px1.p1.13.m13.1.1.2.cmml">N</mi><mtext id="S5.SS2.SSS0.Px1.p1.13.m13.1.1.3" xref="S5.SS2.SSS0.Px1.p1.13.m13.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.13.m13.1b"><apply id="S5.SS2.SSS0.Px1.p1.13.m13.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.13.m13.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.13.m13.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.13.m13.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.13.m13.1.1.2">𝑁</ci><ci id="S5.SS2.SSS0.Px1.p1.13.m13.1.1.3a.cmml" xref="S5.SS2.SSS0.Px1.p1.13.m13.1.1.3"><mtext mathsize="70%" id="S5.SS2.SSS0.Px1.p1.13.m13.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.13.m13.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.13.m13.1c">N_{\text{sf}}</annotation></semantics></math>, the worse the performance. This implies that neuron misalignment could actually lead to performance degradation. Compared with non-i.i.d. performances, taking Cifar10 as an example, setting <math id="S5.SS2.SSS0.Px1.p1.14.m14.1" class="ltx_Math" alttext="N_{\text{sf}}=0.2" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.14.m14.1a"><mrow id="S5.SS2.SSS0.Px1.p1.14.m14.1.1" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.cmml"><msub id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.cmml"><mi id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.2" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.2.cmml">N</mi><mtext id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.3" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.3a.cmml">sf</mtext></msub><mo id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.1" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.3" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.14.m14.1b"><apply id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1"><eq id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.1"></eq><apply id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.1.cmml" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.2.cmml" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.2">𝑁</ci><ci id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.3a.cmml" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.3"><mtext mathsize="70%" id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.3.cmml" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.2.3">sf</mtext></ci></apply><cn type="float" id="S5.SS2.SSS0.Px1.p1.14.m14.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.14.m14.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.14.m14.1c">N_{\text{sf}}=0.2</annotation></semantics></math> could make the i.i.d. (<math id="S5.SS2.SSS0.Px1.p1.15.m15.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.15.m15.1a"><mi id="S5.SS2.SSS0.Px1.p1.15.m15.1.1" xref="S5.SS2.SSS0.Px1.p1.15.m15.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.15.m15.1b"><ci id="S5.SS2.SSS0.Px1.p1.15.m15.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.15.m15.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.15.m15.1c">\alpha</annotation></semantics></math>=10.0) performance degrade to the same as non-i.i.d. (<math id="S5.SS2.SSS0.Px1.p1.16.m16.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.16.m16.1a"><mi id="S5.SS2.SSS0.Px1.p1.16.m16.1.1" xref="S5.SS2.SSS0.Px1.p1.16.m16.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.16.m16.1b"><ci id="S5.SS2.SSS0.Px1.p1.16.m16.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.16.m16.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.16.m16.1c">\alpha</annotation></semantics></math>=0.1), that is, approximately <math id="S5.SS2.SSS0.Px1.p1.17.m17.1" class="ltx_Math" alttext="3.8\%" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.17.m17.1a"><mrow id="S5.SS2.SSS0.Px1.p1.17.m17.1.1" xref="S5.SS2.SSS0.Px1.p1.17.m17.1.1.cmml"><mn id="S5.SS2.SSS0.Px1.p1.17.m17.1.1.2" xref="S5.SS2.SSS0.Px1.p1.17.m17.1.1.2.cmml">3.8</mn><mo id="S5.SS2.SSS0.Px1.p1.17.m17.1.1.1" xref="S5.SS2.SSS0.Px1.p1.17.m17.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.17.m17.1b"><apply id="S5.SS2.SSS0.Px1.p1.17.m17.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.17.m17.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px1.p1.17.m17.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.17.m17.1.1.1">percent</csymbol><cn type="float" id="S5.SS2.SSS0.Px1.p1.17.m17.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.17.m17.1.1.2">3.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.17.m17.1c">3.8\%</annotation></semantics></math> neurons are misaligned on each client. This may provide some enlightenment for the quantitative measure of how many neurons are misaligned in FL with non-i.i.d. data.</p>
</div>
<figure id="S5.F6" class="ltx_figure"><img src="/html/2203.14666/assets/x7.png" id="S5.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="180" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.5.2.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S5.F6.2.1" class="ltx_text" style="font-size:90%;">Weight divergence with PANs off/on. (<math id="S5.F6.2.1.m1.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="S5.F6.2.1.m1.1b"><mrow id="S5.F6.2.1.m1.1.1" xref="S5.F6.2.1.m1.1.1.cmml"><mi mathsize="78%" id="S5.F6.2.1.m1.1.1.2" xref="S5.F6.2.1.m1.1.1.2.cmml">E</mi><mo mathsize="78%" id="S5.F6.2.1.m1.1.1.1" xref="S5.F6.2.1.m1.1.1.1.cmml">=</mo><mn mathsize="78%" id="S5.F6.2.1.m1.1.1.3" xref="S5.F6.2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.2.1.m1.1c"><apply id="S5.F6.2.1.m1.1.1.cmml" xref="S5.F6.2.1.m1.1.1"><eq id="S5.F6.2.1.m1.1.1.1.cmml" xref="S5.F6.2.1.m1.1.1.1"></eq><ci id="S5.F6.2.1.m1.1.1.2.cmml" xref="S5.F6.2.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.F6.2.1.m1.1.1.3.cmml" xref="S5.F6.2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.2.1.m1.1d">E=5</annotation></semantics></math><span id="S5.F6.2.1.1" class="ltx_text" style="font-size:78%;">, MLP on Mnist, more datasets’ results are in Supp.</span>)</span></figcaption>
</figure>
<figure id="S5.F7" class="ltx_figure"><img src="/html/2203.14666/assets/x8.png" id="S5.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="219" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.6.3.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S5.F7.4.2" class="ltx_text" style="font-size:90%;">Optimal assignment matrix with PANs off/on, left vs. right. (<math id="S5.F7.3.1.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S5.F7.3.1.m1.1b"><mrow id="S5.F7.3.1.m1.1.1" xref="S5.F7.3.1.m1.1.1.cmml"><mi mathsize="78%" id="S5.F7.3.1.m1.1.1.2" xref="S5.F7.3.1.m1.1.1.2.cmml">α</mi><mo mathsize="78%" id="S5.F7.3.1.m1.1.1.1" xref="S5.F7.3.1.m1.1.1.1.cmml">=</mo><mn mathsize="78%" id="S5.F7.3.1.m1.1.1.3" xref="S5.F7.3.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.3.1.m1.1c"><apply id="S5.F7.3.1.m1.1.1.cmml" xref="S5.F7.3.1.m1.1.1"><eq id="S5.F7.3.1.m1.1.1.1.cmml" xref="S5.F7.3.1.m1.1.1.1"></eq><ci id="S5.F7.3.1.m1.1.1.2.cmml" xref="S5.F7.3.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.F7.3.1.m1.1.1.3.cmml" xref="S5.F7.3.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.3.1.m1.1d">\alpha=1.0</annotation></semantics></math><span id="S5.F7.4.2.1" class="ltx_text" style="font-size:78%;">, <math id="S5.F7.4.2.1.m1.1" class="ltx_Math" alttext="E=20" display="inline"><semantics id="S5.F7.4.2.1.m1.1b"><mrow id="S5.F7.4.2.1.m1.1.1" xref="S5.F7.4.2.1.m1.1.1.cmml"><mi id="S5.F7.4.2.1.m1.1.1.2" xref="S5.F7.4.2.1.m1.1.1.2.cmml">E</mi><mo id="S5.F7.4.2.1.m1.1.1.1" xref="S5.F7.4.2.1.m1.1.1.1.cmml">=</mo><mn id="S5.F7.4.2.1.m1.1.1.3" xref="S5.F7.4.2.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.4.2.1.m1.1c"><apply id="S5.F7.4.2.1.m1.1.1.cmml" xref="S5.F7.4.2.1.m1.1.1"><eq id="S5.F7.4.2.1.m1.1.1.1.cmml" xref="S5.F7.4.2.1.m1.1.1.1"></eq><ci id="S5.F7.4.2.1.m1.1.1.2.cmml" xref="S5.F7.4.2.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.F7.4.2.1.m1.1.1.3.cmml" xref="S5.F7.4.2.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.4.2.1.m1.1d">E=20</annotation></semantics></math>, VGG9 Conv5 on Cifar10, more results are in Supp.</span>)</span></figcaption>
</figure>
</section>
<section id="S5.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Do PANs indeed reduce the possibility of neuron misalignment?</h4>

<div id="S5.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px2.p1.2" class="ltx_p">We propose several strategies from aspects of parameters, activations, and preference vectors to compare the neuron correspondences in FL with PANs off/on. For PANs turned on, we use multiplicative PANs with <math id="S5.SS2.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="T=1.0" display="inline"><semantics id="S5.SS2.SSS0.Px2.p1.1.m1.1a"><mrow id="S5.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">T</mi><mo id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.1" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1"><eq id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.1"></eq><ci id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2">𝑇</ci><cn type="float" id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.1.m1.1c">T=1.0</annotation></semantics></math> and <math id="S5.SS2.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="A=0.1" display="inline"><semantics id="S5.SS2.SSS0.Px2.p1.2.m2.1a"><mrow id="S5.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.2" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml">A</mi><mo id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.1" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.2.m2.1b"><apply id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1"><eq id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.1"></eq><ci id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.2">𝐴</ci><cn type="float" id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.2.m2.1c">A=0.1</annotation></semantics></math> by default.</p>
</div>
<div id="S5.SS2.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px2.p2.4" class="ltx_p"><span id="S5.SS2.SSS0.Px2.p2.4.1" class="ltx_text ltx_font_bold">I. Weight Divergence:</span> Weight divergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> measures the variances of local parameters. Specifically, we calculate <math id="S5.SS2.SSS0.Px2.p2.1.m1.3" class="ltx_Math" alttext="\frac{1}{|S_{t}|}\sum_{k\in S_{t}}\lVert W_{l}^{(k)}-W_{l}\rVert_{2}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p2.1.m1.3a"><mrow id="S5.SS2.SSS0.Px2.p2.1.m1.3.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.cmml"><mfrac id="S5.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.cmml"><mn id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml">1</mn><mrow id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.2.1.cmml">|</mo><msub id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.cmml">S</mi><mi id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.2.cmml">​</mo><mrow id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.cmml"><msub id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.cmml"><mo rspace="0em" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.2.cmml">∑</mo><mrow id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.2.cmml">k</mi><mo id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.1.cmml">∈</mo><msub id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3.cmml"><mi id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3.2.cmml">S</mi><mi id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3.3.cmml">t</mi></msub></mrow></msub><msub id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.cmml"><mrow id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.2.1.cmml">∥</mo><mrow id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.cmml"><msubsup id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.2.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.2.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.2.3.cmml">l</mi><mrow id="S5.SS2.SSS0.Px2.p2.1.m1.2.2.1.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.1.m1.2.2.1.3.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.cmml">(</mo><mi id="S5.SS2.SSS0.Px2.p2.1.m1.2.2.1.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.2.2.1.1.cmml">k</mi><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.1.m1.2.2.1.3.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.1.cmml">−</mo><msub id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3.2.cmml">W</mi><mi id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo fence="true" lspace="0em" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p2.1.m1.3b"><apply id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3"><times id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.2"></times><apply id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1"><divide id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1"></divide><cn type="integer" id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.3">1</cn><apply id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1"><abs id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.2"></abs><apply id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2">𝑆</ci><ci id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1"><apply id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2">subscript</csymbol><sum id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.2"></sum><apply id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3"><in id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.1"></in><ci id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.2">𝑘</ci><apply id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3.2">𝑆</ci><ci id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3.3.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1">subscript</csymbol><apply id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1"><minus id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.1"></minus><apply id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2">superscript</csymbol><apply id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.2.2.3">𝑙</ci></apply><ci id="S5.SS2.SSS0.Px2.p2.1.m1.2.2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.2.2.1.1">𝑘</ci></apply><apply id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3.2">𝑊</ci><ci id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><cn type="integer" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p2.1.m1.3c">\frac{1}{|S_{t}|}\sum_{k\in S_{t}}\lVert W_{l}^{(k)}-W_{l}\rVert_{2}</annotation></semantics></math> for each layer <math id="S5.SS2.SSS0.Px2.p2.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S5.SS2.SSS0.Px2.p2.2.m2.1a"><mi id="S5.SS2.SSS0.Px2.p2.2.m2.1.1" xref="S5.SS2.SSS0.Px2.p2.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p2.2.m2.1b"><ci id="S5.SS2.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p2.2.m2.1c">l</annotation></semantics></math>. <math id="S5.SS2.SSS0.Px2.p2.3.m3.2" class="ltx_Math" alttext="W_{l}=\frac{1}{|S_{t}|}\sum_{k\in S_{t}}W_{l}^{(k)}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p2.3.m3.2a"><mrow id="S5.SS2.SSS0.Px2.p2.3.m3.2.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.cmml"><msub id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2.cmml"><mi id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2.2.cmml">W</mi><mi id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2.3.cmml">l</mi></msub><mo id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.1" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.1.cmml">=</mo><mrow id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.cmml"><mfrac id="S5.SS2.SSS0.Px2.p2.3.m3.1.1" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.cmml"><mn id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml">1</mn><mrow id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.2.1.cmml">|</mo><msub id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.cmml">S</mi><mi id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.1" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.1.cmml">​</mo><mrow id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.cmml"><msub id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.cmml"><mo id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.2.cmml">∑</mo><mrow id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.cmml"><mi id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.2.cmml">k</mi><mo id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.1" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.1.cmml">∈</mo><msub id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3.cmml"><mi id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3.2.cmml">S</mi><mi id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3.3.cmml">t</mi></msub></mrow></msub><msubsup id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.cmml"><mi id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.2.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.2.2.cmml">W</mi><mi id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.2.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.2.3.cmml">l</mi><mrow id="S5.SS2.SSS0.Px2.p2.3.m3.2.2.1.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.3.m3.2.2.1.3.1" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.cmml">(</mo><mi id="S5.SS2.SSS0.Px2.p2.3.m3.2.2.1.1" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.2.1.1.cmml">k</mi><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.3.m3.2.2.1.3.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p2.3.m3.2b"><apply id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3"><eq id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.1"></eq><apply id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2.2">𝑊</ci><ci id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2.3.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.2.3">𝑙</ci></apply><apply id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3"><times id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.1"></times><apply id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1"><divide id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1"></divide><cn type="integer" id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.3">1</cn><apply id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1"><abs id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.2"></abs><apply id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2">𝑆</ci><ci id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2"><apply id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1">subscript</csymbol><sum id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.2"></sum><apply id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3"><in id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.1"></in><ci id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.2">𝑘</ci><apply id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3.2">𝑆</ci><ci id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3.3.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2">superscript</csymbol><apply id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.2.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.2.2">𝑊</ci><ci id="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.3.3.2.2.2.3">𝑙</ci></apply><ci id="S5.SS2.SSS0.Px2.p2.3.m3.2.2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.2.1.1">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p2.3.m3.2c">W_{l}=\frac{1}{|S_{t}|}\sum_{k\in S_{t}}W_{l}^{(k)}</annotation></semantics></math> denotes the averaged parameters. The weight divergences of MLP on Mnist with <math id="S5.SS2.SSS0.Px2.p2.4.m4.2" class="ltx_Math" alttext="\alpha\in\{1.0,0.1\}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p2.4.m4.2a"><mrow id="S5.SS2.SSS0.Px2.p2.4.m4.2.3" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p2.4.m4.2.3.2" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.3.2.cmml">α</mi><mo id="S5.SS2.SSS0.Px2.p2.4.m4.2.3.1" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.3.1.cmml">∈</mo><mrow id="S5.SS2.SSS0.Px2.p2.4.m4.2.3.3.2" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.4.m4.2.3.3.2.1" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.3.3.1.cmml">{</mo><mn id="S5.SS2.SSS0.Px2.p2.4.m4.1.1" xref="S5.SS2.SSS0.Px2.p2.4.m4.1.1.cmml">1.0</mn><mo id="S5.SS2.SSS0.Px2.p2.4.m4.2.3.3.2.2" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.3.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.4.m4.2.2" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.2.cmml">0.1</mn><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.4.m4.2.3.3.2.3" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p2.4.m4.2b"><apply id="S5.SS2.SSS0.Px2.p2.4.m4.2.3.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.3"><in id="S5.SS2.SSS0.Px2.p2.4.m4.2.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.3.1"></in><ci id="S5.SS2.SSS0.Px2.p2.4.m4.2.3.2.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.3.2">𝛼</ci><set id="S5.SS2.SSS0.Px2.p2.4.m4.2.3.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.3.3.2"><cn type="float" id="S5.SS2.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.1.1">1.0</cn><cn type="float" id="S5.SS2.SSS0.Px2.p2.4.m4.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.2">0.1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p2.4.m4.2c">\alpha\in\{1.0,0.1\}</annotation></semantics></math> are in Fig. <a href="#S5.F6" title="Figure 6 ‣ How many neurons are misaligned in FL? ‣ 5.2 Decentralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, where PANs could reduce the divergences a lot (the red bars). This corresponds to the explanation in Sect. <a href="#S4.SS2" title="4.2 Applying PANs to FL ‣ 4 FL with PANs ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> that clients’ parameters are partially updated towards the same direction.</p>
</div>
<figure id="S5.F8" class="ltx_figure"><img src="/html/2203.14666/assets/x9.png" id="S5.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="185" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F8.5.2.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="S5.F8.2.1" class="ltx_text" style="font-size:90%;">Preference vectors with PANs off/on, left vs. right. (<math id="S5.F8.2.1.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S5.F8.2.1.m1.1b"><mrow id="S5.F8.2.1.m1.1.1" xref="S5.F8.2.1.m1.1.1.cmml"><mi mathsize="78%" id="S5.F8.2.1.m1.1.1.2" xref="S5.F8.2.1.m1.1.1.2.cmml">α</mi><mo mathsize="78%" id="S5.F8.2.1.m1.1.1.1" xref="S5.F8.2.1.m1.1.1.1.cmml">=</mo><mn mathsize="78%" id="S5.F8.2.1.m1.1.1.3" xref="S5.F8.2.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F8.2.1.m1.1c"><apply id="S5.F8.2.1.m1.1.1.cmml" xref="S5.F8.2.1.m1.1.1"><eq id="S5.F8.2.1.m1.1.1.1.cmml" xref="S5.F8.2.1.m1.1.1.1"></eq><ci id="S5.F8.2.1.m1.1.1.2.cmml" xref="S5.F8.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.F8.2.1.m1.1.1.3.cmml" xref="S5.F8.2.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.2.1.m1.1d">\alpha=1.0</annotation></semantics></math><span id="S5.F8.2.1.1" class="ltx_text" style="font-size:78%;">, VGG9 Conv6 on Cifar10, more results are shown in Supp.</span>)</span></figcaption>
</figure>
<div id="S5.SS2.SSS0.Px2.p3" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px2.p3.8" class="ltx_p"><span id="S5.SS2.SSS0.Px2.p3.8.1" class="ltx_text ltx_font_bold">II. Matching via Optimal Assignment:</span> We feed 500 test samples into the network and obtain the activations of each neuron as its representation. Neurons’ representations of global and local model are denoted as <math id="S5.SS2.SSS0.Px2.p3.1.m1.1" class="ltx_Math" alttext="h_{l}\in\mathcal{R}^{J_{l}\times m}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p3.1.m1.1a"><mrow id="S5.SS2.SSS0.Px2.p3.1.m1.1.1" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.cmml"><msub id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2.cmml"><mi id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2.2" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2.2.cmml">h</mi><mi id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2.3" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2.3.cmml">l</mi></msub><mo id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.1" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.2" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.2.cmml">ℛ</mi><mrow id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.cmml"><msub id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2.cmml"><mi id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2.2" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2.2.cmml">J</mi><mi id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2.3" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.1" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.3" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p3.1.m1.1b"><apply id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1"><in id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.1"></in><apply id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2.2">ℎ</ci><ci id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.2.3">𝑙</ci></apply><apply id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3">superscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.2">ℛ</ci><apply id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3"><times id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.1"></times><apply id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2.2">𝐽</ci><ci id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.2.3">𝑙</ci></apply><ci id="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p3.1.m1.1c">h_{l}\in\mathcal{R}^{J_{l}\times m}</annotation></semantics></math> and <math id="S5.SS2.SSS0.Px2.p3.2.m2.1" class="ltx_Math" alttext="h_{l}^{(k)}\in\mathcal{R}^{J_{l}\times m}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p3.2.m2.1a"><mrow id="S5.SS2.SSS0.Px2.p3.2.m2.1.2" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.cmml"><msubsup id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.cmml"><mi id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.2.2" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.2.2.cmml">h</mi><mi id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.2.3" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.2.3.cmml">l</mi><mrow id="S5.SS2.SSS0.Px2.p3.2.m2.1.1.1.3" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p3.2.m2.1.1.1.3.1" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.cmml">(</mo><mi id="S5.SS2.SSS0.Px2.p3.2.m2.1.1.1.1" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.1.1.1.cmml">k</mi><mo stretchy="false" id="S5.SS2.SSS0.Px2.p3.2.m2.1.1.1.3.2" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.1" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.1.cmml">∈</mo><msup id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.2" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.2.cmml">ℛ</mi><mrow id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.cmml"><msub id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2.cmml"><mi id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2.2" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2.2.cmml">J</mi><mi id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2.3" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.1" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.1.cmml">×</mo><mi id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.3" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p3.2.m2.1b"><apply id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2"><in id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.1"></in><apply id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2">superscript</csymbol><apply id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.2.2">ℎ</ci><ci id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.2.2.3">𝑙</ci></apply><ci id="S5.SS2.SSS0.Px2.p3.2.m2.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.1.1.1">𝑘</ci></apply><apply id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3">superscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.2">ℛ</ci><apply id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3"><times id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.1"></times><apply id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2.2">𝐽</ci><ci id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.2.3">𝑙</ci></apply><ci id="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.2.m2.1.2.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p3.2.m2.1c">h_{l}^{(k)}\in\mathcal{R}^{J_{l}\times m}</annotation></semantics></math>, where <math id="S5.SS2.SSS0.Px2.p3.3.m3.1" class="ltx_Math" alttext="m=500" display="inline"><semantics id="S5.SS2.SSS0.Px2.p3.3.m3.1a"><mrow id="S5.SS2.SSS0.Px2.p3.3.m3.1.1" xref="S5.SS2.SSS0.Px2.p3.3.m3.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p3.3.m3.1.1.2" xref="S5.SS2.SSS0.Px2.p3.3.m3.1.1.2.cmml">m</mi><mo id="S5.SS2.SSS0.Px2.p3.3.m3.1.1.1" xref="S5.SS2.SSS0.Px2.p3.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px2.p3.3.m3.1.1.3" xref="S5.SS2.SSS0.Px2.p3.3.m3.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p3.3.m3.1b"><apply id="S5.SS2.SSS0.Px2.p3.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.3.m3.1.1"><eq id="S5.SS2.SSS0.Px2.p3.3.m3.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.3.m3.1.1.1"></eq><ci id="S5.SS2.SSS0.Px2.p3.3.m3.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p3.3.m3.1.1.2">𝑚</ci><cn type="integer" id="S5.SS2.SSS0.Px2.p3.3.m3.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p3.3.m3.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p3.3.m3.1c">m=500</annotation></semantics></math>. Then we search for the optimal assignment matrix <math id="S5.SS2.SSS0.Px2.p3.4.m4.2" class="ltx_Math" alttext="Q\in\{0,1\}^{J_{l}\times J_{l}}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p3.4.m4.2a"><mrow id="S5.SS2.SSS0.Px2.p3.4.m4.2.3" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.2" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.2.cmml">Q</mi><mo id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.1" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.1.cmml">∈</mo><msup id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.cmml"><mrow id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.2.2" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.2.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.2.2.1" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.2.1.cmml">{</mo><mn id="S5.SS2.SSS0.Px2.p3.4.m4.1.1" xref="S5.SS2.SSS0.Px2.p3.4.m4.1.1.cmml">0</mn><mo id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.2.2.2" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.2.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p3.4.m4.2.2" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.2.cmml">1</mn><mo stretchy="false" id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.2.2.3" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.2.1.cmml">}</mo></mrow><mrow id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.cmml"><msub id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2.cmml"><mi id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2.2" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2.2.cmml">J</mi><mi id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2.3" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.1" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.1.cmml">×</mo><msub id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3.cmml"><mi id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3.2" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3.2.cmml">J</mi><mi id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3.3" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3.3.cmml">l</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p3.4.m4.2b"><apply id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3"><in id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.1"></in><ci id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.2">𝑄</ci><apply id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3">superscript</csymbol><set id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.2.2"><cn type="integer" id="S5.SS2.SSS0.Px2.p3.4.m4.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.1.1">0</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p3.4.m4.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.2">1</cn></set><apply id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3"><times id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.1"></times><apply id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2.2">𝐽</ci><ci id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.2.3">𝑙</ci></apply><apply id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3.2">𝐽</ci><ci id="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.4.m4.2.3.3.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p3.4.m4.2c">Q\in\{0,1\}^{J_{l}\times J_{l}}</annotation></semantics></math> that minimizes <math id="S5.SS2.SSS0.Px2.p3.5.m5.6" class="ltx_Math" alttext="\sum_{i=1}^{J_{l}}\sum_{j=1}^{J_{l}}Q_{ij}\lVert h_{l,i}-h_{l,j}^{(k)}\rVert_{2}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p3.5.m5.6a"><mrow id="S5.SS2.SSS0.Px2.p3.5.m5.6.6" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.cmml"><msubsup id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.cmml"><mo id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.2.cmml">∑</mo><mrow id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.2.cmml">i</mi><mo id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.3.cmml">1</mn></mrow><msub id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3.2.cmml">J</mi><mi id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3.3.cmml">l</mi></msub></msubsup><mrow id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.cmml"><msubsup id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.cmml"><mo lspace="0.167em" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.2.cmml">∑</mo><mrow id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.2.cmml">j</mi><mo id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.3.cmml">1</mn></mrow><msub id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3.2.cmml">J</mi><mi id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3.3.cmml">l</mi></msub></msubsup><mrow id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.cmml"><msub id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.cmml"><mi id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.2.cmml">Q</mi><mrow id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.cmml"><mi id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.2.cmml">​</mo><msub id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.cmml"><mrow id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.2.cmml"><mo fence="true" rspace="0em" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.2.1.cmml">∥</mo><mrow id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.cmml"><msub id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.2.cmml"><mi id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.2.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S5.SS2.SSS0.Px2.p3.5.m5.2.2.2.4" xref="S5.SS2.SSS0.Px2.p3.5.m5.2.2.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p3.5.m5.1.1.1.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.1.1.1.1.cmml">l</mi><mo id="S5.SS2.SSS0.Px2.p3.5.m5.2.2.2.4.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.2.2.2.3.cmml">,</mo><mi id="S5.SS2.SSS0.Px2.p3.5.m5.2.2.2.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3.cmml"><mi id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3.2.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3.2.2.cmml">h</mi><mrow id="S5.SS2.SSS0.Px2.p3.5.m5.4.4.2.4" xref="S5.SS2.SSS0.Px2.p3.5.m5.4.4.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p3.5.m5.3.3.1.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.3.3.1.1.cmml">l</mi><mo id="S5.SS2.SSS0.Px2.p3.5.m5.4.4.2.4.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.4.4.2.3.cmml">,</mo><mi id="S5.SS2.SSS0.Px2.p3.5.m5.4.4.2.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.4.4.2.2.cmml">j</mi></mrow><mrow id="S5.SS2.SSS0.Px2.p3.5.m5.5.5.1.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p3.5.m5.5.5.1.3.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3.cmml">(</mo><mi id="S5.SS2.SSS0.Px2.p3.5.m5.5.5.1.1" xref="S5.SS2.SSS0.Px2.p3.5.m5.5.5.1.1.cmml">k</mi><mo stretchy="false" id="S5.SS2.SSS0.Px2.p3.5.m5.5.5.1.3.2" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo fence="true" lspace="0em" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.3" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.3.cmml">2</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p3.5.m5.6b"><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6"><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2">superscript</csymbol><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2">subscript</csymbol><sum id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.2"></sum><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3"><eq id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.1"></eq><ci id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.2">𝑖</ci><cn type="integer" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.2.3.3">1</cn></apply></apply><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3.2">𝐽</ci><ci id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.2.3.3">𝑙</ci></apply></apply><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1"><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2">superscript</csymbol><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2">subscript</csymbol><sum id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.2"></sum><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3"><eq id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.1"></eq><ci id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.2">𝑗</ci><cn type="integer" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.2.3.3">1</cn></apply></apply><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3.2">𝐽</ci><ci id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.2.3.3">𝑙</ci></apply></apply><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1"><times id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.2"></times><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.2">𝑄</ci><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3"><times id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.1"></times><ci id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.2">𝑖</ci><ci id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1">subscript</csymbol><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1"><minus id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.1"></minus><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.2.2">ℎ</ci><list id="S5.SS2.SSS0.Px2.p3.5.m5.2.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.2.2.2.4"><ci id="S5.SS2.SSS0.Px2.p3.5.m5.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.1.1.1.1">𝑙</ci><ci id="S5.SS2.SSS0.Px2.p3.5.m5.2.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.2.2.2.2">𝑖</ci></list></apply><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3">superscript</csymbol><apply id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.1.1.1.3.2.2">ℎ</ci><list id="S5.SS2.SSS0.Px2.p3.5.m5.4.4.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.4.4.2.4"><ci id="S5.SS2.SSS0.Px2.p3.5.m5.3.3.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.3.3.1.1">𝑙</ci><ci id="S5.SS2.SSS0.Px2.p3.5.m5.4.4.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.4.4.2.2">𝑗</ci></list></apply><ci id="S5.SS2.SSS0.Px2.p3.5.m5.5.5.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.5.5.1.1">𝑘</ci></apply></apply></apply><cn type="integer" id="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p3.5.m5.6.6.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p3.5.m5.6c">\sum_{i=1}^{J_{l}}\sum_{j=1}^{J_{l}}Q_{ij}\lVert h_{l,i}-h_{l,j}^{(k)}\rVert_{2}</annotation></semantics></math> and satisfies <math id="S5.SS2.SSS0.Px2.p3.6.m6.2" class="ltx_Math" alttext="\sum_{i}Q_{i,\cdot}=1" display="inline"><semantics id="S5.SS2.SSS0.Px2.p3.6.m6.2a"><mrow id="S5.SS2.SSS0.Px2.p3.6.m6.2.3" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.cmml"><mrow id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.cmml"><msub id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1.cmml"><mo id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1.2" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1.2.cmml">∑</mo><mi id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1.3" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1.3.cmml">i</mi></msub><msub id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.2" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.2.cmml"><mi id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.2.2" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.2.2.cmml">Q</mi><mrow id="S5.SS2.SSS0.Px2.p3.6.m6.2.2.2.4" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.2.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p3.6.m6.1.1.1.1" xref="S5.SS2.SSS0.Px2.p3.6.m6.1.1.1.1.cmml">i</mi><mo rspace="0em" id="S5.SS2.SSS0.Px2.p3.6.m6.2.2.2.4.1" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.2.2.3.cmml">,</mo><mo lspace="0em" id="S5.SS2.SSS0.Px2.p3.6.m6.2.2.2.2" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.2.2.2.cmml">⋅</mo></mrow></msub></mrow><mo id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.1" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.3" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p3.6.m6.2b"><apply id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3"><eq id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.1"></eq><apply id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2"><apply id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1">subscript</csymbol><sum id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1.2.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1.2"></sum><ci id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1.3.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.1.3">𝑖</ci></apply><apply id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.2.2.2">𝑄</ci><list id="S5.SS2.SSS0.Px2.p3.6.m6.2.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.2.2.4"><ci id="S5.SS2.SSS0.Px2.p3.6.m6.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.1.1.1.1">𝑖</ci><ci id="S5.SS2.SSS0.Px2.p3.6.m6.2.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.2.2.2">⋅</ci></list></apply></apply><cn type="integer" id="S5.SS2.SSS0.Px2.p3.6.m6.2.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.6.m6.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p3.6.m6.2c">\sum_{i}Q_{i,\cdot}=1</annotation></semantics></math>, <math id="S5.SS2.SSS0.Px2.p3.7.m7.2" class="ltx_Math" alttext="\sum_{j}Q_{\cdot,j}=1" display="inline"><semantics id="S5.SS2.SSS0.Px2.p3.7.m7.2a"><mrow id="S5.SS2.SSS0.Px2.p3.7.m7.2.3" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.cmml"><mrow id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.cmml"><msub id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1.cmml"><mo id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1.2" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1.2.cmml">∑</mo><mi id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1.3" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1.3.cmml">j</mi></msub><msub id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.2" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.2.cmml"><mi id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.2.2" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.2.2.cmml">Q</mi><mrow id="S5.SS2.SSS0.Px2.p3.7.m7.2.2.2.4" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.2.2.3.cmml"><mo rspace="0em" id="S5.SS2.SSS0.Px2.p3.7.m7.1.1.1.1" xref="S5.SS2.SSS0.Px2.p3.7.m7.1.1.1.1.cmml">⋅</mo><mo id="S5.SS2.SSS0.Px2.p3.7.m7.2.2.2.4.1" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.2.2.3.cmml">,</mo><mi id="S5.SS2.SSS0.Px2.p3.7.m7.2.2.2.2" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.1" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.3" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p3.7.m7.2b"><apply id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3"><eq id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.1.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.1"></eq><apply id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2"><apply id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1">subscript</csymbol><sum id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1.2.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1.2"></sum><ci id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1.3.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.1.3">𝑗</ci></apply><apply id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.2.1.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.2.2.2">𝑄</ci><list id="S5.SS2.SSS0.Px2.p3.7.m7.2.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.2.2.4"><ci id="S5.SS2.SSS0.Px2.p3.7.m7.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.1.1.1.1">⋅</ci><ci id="S5.SS2.SSS0.Px2.p3.7.m7.2.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.2.2.2">𝑗</ci></list></apply></apply><cn type="integer" id="S5.SS2.SSS0.Px2.p3.7.m7.2.3.3.cmml" xref="S5.SS2.SSS0.Px2.p3.7.m7.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p3.7.m7.2c">\sum_{j}Q_{\cdot,j}=1</annotation></semantics></math>. In fact, <math id="S5.SS2.SSS0.Px2.p3.8.m8.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S5.SS2.SSS0.Px2.p3.8.m8.1a"><mi id="S5.SS2.SSS0.Px2.p3.8.m8.1.1" xref="S5.SS2.SSS0.Px2.p3.8.m8.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p3.8.m8.1b"><ci id="S5.SS2.SSS0.Px2.p3.8.m8.1.1.cmml" xref="S5.SS2.SSS0.Px2.p3.8.m8.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p3.8.m8.1c">Q</annotation></semantics></math> is a permutation matrix that could approximately reflect the disturbance of neurons, and it could match neurons with similar outputs. We plot the solved matching matrix in Fig. <a href="#S5.F7" title="Figure 7 ‣ How many neurons are misaligned in FL? ‣ 5.2 Decentralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, where the number in “[]” shows the ratio of the diagonal ones. Using PANs could make the diagonal denser, implying that neurons at the same coordinates output similarly.</p>
</div>
<div id="S5.SS2.SSS0.Px2.p4" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px2.p4.7" class="ltx_p"><span id="S5.SS2.SSS0.Px2.p4.7.1" class="ltx_text ltx_font_bold">III. Visualizing Neurons via Preference Vectors:</span> Then, we correspond neurons to classes via calculating preference vectors as done in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. Specifically, we calculate <math id="S5.SS2.SSS0.Px2.p4.1.m1.6" class="ltx_Math" alttext="p_{c}=\sum_{b=1}^{B}\text{Acti}(x_{c,b})\frac{\partial Z_{c}}{\partial\text{Acti}(x_{c,b})}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p4.1.m1.6a"><mrow id="S5.SS2.SSS0.Px2.p4.1.m1.6.6" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.cmml"><msub id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3.cmml"><mi id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3.2.cmml">p</mi><mi id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3.3" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3.3.cmml">c</mi></msub><mo rspace="0.111em" id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.2.cmml">=</mo><mrow id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.cmml"><msubsup id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.cmml"><mo id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.2.cmml">∑</mo><mrow id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.2.cmml">b</mi><mo id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.1" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.3" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.3.cmml">1</mn></mrow><mi id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.3" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.3.cmml">B</mi></msubsup><mrow id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.cmml"><mtext id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.3" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.3a.cmml">Acti</mtext><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.2.cmml">​</mo><mrow id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.1.cmml">(</mo><msub id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.1" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.1.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.1.2.cmml">x</mi><mrow id="S5.SS2.SSS0.Px2.p4.1.m1.2.2.2.4" xref="S5.SS2.SSS0.Px2.p4.1.m1.2.2.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p4.1.m1.1.1.1.1" xref="S5.SS2.SSS0.Px2.p4.1.m1.1.1.1.1.cmml">c</mi><mo id="S5.SS2.SSS0.Px2.p4.1.m1.2.2.2.4.1" xref="S5.SS2.SSS0.Px2.p4.1.m1.2.2.2.3.cmml">,</mo><mi id="S5.SS2.SSS0.Px2.p4.1.m1.2.2.2.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.2.2.2.2.cmml">b</mi></mrow></msub><mo stretchy="false" id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.3" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.2a" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.2.cmml">​</mo><mfrac id="S5.SS2.SSS0.Px2.p4.1.m1.5.5" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.cmml"><mrow id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.cmml"><mo rspace="0em" id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.1" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.1.cmml">∂</mo><msub id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2.cmml"><mi id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2.2.cmml">Z</mi><mi id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2.3" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2.3.cmml">c</mi></msub></mrow><mrow id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.cmml"><mo rspace="0em" id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.4" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.4.cmml">∂</mo><mrow id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.cmml"><mtext id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.3" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.3a.cmml">Acti</mtext><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.2.cmml">​</mo><mrow id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.1.cmml">(</mo><msub id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.1" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.1.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.1.2.cmml">x</mi><mrow id="S5.SS2.SSS0.Px2.p4.1.m1.4.4.2.2.2.4" xref="S5.SS2.SSS0.Px2.p4.1.m1.4.4.2.2.2.3.cmml"><mi id="S5.SS2.SSS0.Px2.p4.1.m1.3.3.1.1.1.1" xref="S5.SS2.SSS0.Px2.p4.1.m1.3.3.1.1.1.1.cmml">c</mi><mo id="S5.SS2.SSS0.Px2.p4.1.m1.4.4.2.2.2.4.1" xref="S5.SS2.SSS0.Px2.p4.1.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S5.SS2.SSS0.Px2.p4.1.m1.4.4.2.2.2.2" xref="S5.SS2.SSS0.Px2.p4.1.m1.4.4.2.2.2.2.cmml">b</mi></mrow></msub><mo stretchy="false" id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.3" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p4.1.m1.6b"><apply id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6"><eq id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.2"></eq><apply id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3.2">𝑝</ci><ci id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3.3.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.3.3">𝑐</ci></apply><apply id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1"><apply id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2">superscript</csymbol><apply id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2">subscript</csymbol><sum id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.2"></sum><apply id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3"><eq id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.1"></eq><ci id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.2">𝑏</ci><cn type="integer" id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.3.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.2.3.3">1</cn></apply></apply><ci id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.3.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.2.3">𝐵</ci></apply><apply id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1"><times id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.2"></times><ci id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.3a.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.3"><mtext id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.3">Acti</mtext></ci><apply id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.6.6.1.1.1.1.1.2">𝑥</ci><list id="S5.SS2.SSS0.Px2.p4.1.m1.2.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.2.2.2.4"><ci id="S5.SS2.SSS0.Px2.p4.1.m1.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.1.1.1.1">𝑐</ci><ci id="S5.SS2.SSS0.Px2.p4.1.m1.2.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.2.2.2.2">𝑏</ci></list></apply><apply id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5"><divide id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.4.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5"></divide><apply id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5"><partialdiff id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.1"></partialdiff><apply id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2.2">𝑍</ci><ci id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2.3.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.5.2.3">𝑐</ci></apply></apply><apply id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3"><partialdiff id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.4.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.4"></partialdiff><apply id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3"><times id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.2"></times><ci id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.3a.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.3"><mtext mathsize="70%" id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.3.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.3">Acti</mtext></ci><apply id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.5.5.3.3.1.1.1.2">𝑥</ci><list id="S5.SS2.SSS0.Px2.p4.1.m1.4.4.2.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.4.4.2.2.2.4"><ci id="S5.SS2.SSS0.Px2.p4.1.m1.3.3.1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.3.3.1.1.1.1">𝑐</ci><ci id="S5.SS2.SSS0.Px2.p4.1.m1.4.4.2.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p4.1.m1.4.4.2.2.2.2">𝑏</ci></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p4.1.m1.6c">p_{c}=\sum_{b=1}^{B}\text{Acti}(x_{c,b})\frac{\partial Z_{c}}{\partial\text{Acti}(x_{c,b})}</annotation></semantics></math> for each class <math id="S5.SS2.SSS0.Px2.p4.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S5.SS2.SSS0.Px2.p4.2.m2.1a"><mi id="S5.SS2.SSS0.Px2.p4.2.m2.1.1" xref="S5.SS2.SSS0.Px2.p4.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p4.2.m2.1b"><ci id="S5.SS2.SSS0.Px2.p4.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p4.2.m2.1c">c</annotation></semantics></math>, and then concatenate all classes as the preference vector <math id="S5.SS2.SSS0.Px2.p4.3.m3.4" class="ltx_Math" alttext="[p_{1},p_{2},\cdots,p_{C}]" display="inline"><semantics id="S5.SS2.SSS0.Px2.p4.3.m3.4a"><mrow id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.4.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.4" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.4.cmml">[</mo><msub id="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1" xref="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1.2" xref="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1.2.cmml">p</mi><mn id="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1.3" xref="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.5" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.4.cmml">,</mo><msub id="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2" xref="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2.cmml"><mi id="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2.2" xref="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2.2.cmml">p</mi><mn id="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2.3" xref="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2.3.cmml">2</mn></msub><mo id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.6" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S5.SS2.SSS0.Px2.p4.3.m3.1.1" xref="S5.SS2.SSS0.Px2.p4.3.m3.1.1.cmml">⋯</mi><mo id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.7" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.4.cmml">,</mo><msub id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3.cmml"><mi id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3.2" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3.2.cmml">p</mi><mi id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3.3" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3.3.cmml">C</mi></msub><mo stretchy="false" id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.8" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p4.3.m3.4b"><list id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.4.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3"><apply id="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1.2">𝑝</ci><cn type="integer" id="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.2.2.1.1.3">1</cn></apply><apply id="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2.1.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2.2">𝑝</ci><cn type="integer" id="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.3.3.2.2.3">2</cn></apply><ci id="S5.SS2.SSS0.Px2.p4.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.1.1">⋯</ci><apply id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3.1.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3.2.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3.2">𝑝</ci><ci id="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3.3.cmml" xref="S5.SS2.SSS0.Px2.p4.3.m3.4.4.3.3.3">𝐶</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p4.3.m3.4c">[p_{1},p_{2},\cdots,p_{C}]</annotation></semantics></math>. <math id="S5.SS2.SSS0.Px2.p4.4.m4.1" class="ltx_Math" alttext="\text{Acti}(\cdot)" display="inline"><semantics id="S5.SS2.SSS0.Px2.p4.4.m4.1a"><mrow id="S5.SS2.SSS0.Px2.p4.4.m4.1.2" xref="S5.SS2.SSS0.Px2.p4.4.m4.1.2.cmml"><mtext id="S5.SS2.SSS0.Px2.p4.4.m4.1.2.2" xref="S5.SS2.SSS0.Px2.p4.4.m4.1.2.2a.cmml">Acti</mtext><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p4.4.m4.1.2.1" xref="S5.SS2.SSS0.Px2.p4.4.m4.1.2.1.cmml">​</mo><mrow id="S5.SS2.SSS0.Px2.p4.4.m4.1.2.3.2" xref="S5.SS2.SSS0.Px2.p4.4.m4.1.2.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p4.4.m4.1.2.3.2.1" xref="S5.SS2.SSS0.Px2.p4.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p4.4.m4.1.1" xref="S5.SS2.SSS0.Px2.p4.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S5.SS2.SSS0.Px2.p4.4.m4.1.2.3.2.2" xref="S5.SS2.SSS0.Px2.p4.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p4.4.m4.1b"><apply id="S5.SS2.SSS0.Px2.p4.4.m4.1.2.cmml" xref="S5.SS2.SSS0.Px2.p4.4.m4.1.2"><times id="S5.SS2.SSS0.Px2.p4.4.m4.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p4.4.m4.1.2.1"></times><ci id="S5.SS2.SSS0.Px2.p4.4.m4.1.2.2a.cmml" xref="S5.SS2.SSS0.Px2.p4.4.m4.1.2.2"><mtext id="S5.SS2.SSS0.Px2.p4.4.m4.1.2.2.cmml" xref="S5.SS2.SSS0.Px2.p4.4.m4.1.2.2">Acti</mtext></ci><ci id="S5.SS2.SSS0.Px2.p4.4.m4.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p4.4.m4.1c">\text{Acti}(\cdot)</annotation></semantics></math> denotes the activation value and <math id="S5.SS2.SSS0.Px2.p4.5.m5.1" class="ltx_Math" alttext="Z_{c}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p4.5.m5.1a"><msub id="S5.SS2.SSS0.Px2.p4.5.m5.1.1" xref="S5.SS2.SSS0.Px2.p4.5.m5.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p4.5.m5.1.1.2" xref="S5.SS2.SSS0.Px2.p4.5.m5.1.1.2.cmml">Z</mi><mi id="S5.SS2.SSS0.Px2.p4.5.m5.1.1.3" xref="S5.SS2.SSS0.Px2.p4.5.m5.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p4.5.m5.1b"><apply id="S5.SS2.SSS0.Px2.p4.5.m5.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p4.5.m5.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.5.m5.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p4.5.m5.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p4.5.m5.1.1.2">𝑍</ci><ci id="S5.SS2.SSS0.Px2.p4.5.m5.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p4.5.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p4.5.m5.1c">Z_{c}</annotation></semantics></math> is the prediction score of the <math id="S5.SS2.SSS0.Px2.p4.6.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S5.SS2.SSS0.Px2.p4.6.m6.1a"><mi id="S5.SS2.SSS0.Px2.p4.6.m6.1.1" xref="S5.SS2.SSS0.Px2.p4.6.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p4.6.m6.1b"><ci id="S5.SS2.SSS0.Px2.p4.6.m6.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.6.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p4.6.m6.1c">c</annotation></semantics></math>th class. Then, <math id="S5.SS2.SSS0.Px2.p4.7.m7.1" class="ltx_Math" alttext="\arg\max_{c}p_{c}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p4.7.m7.1a"><mrow id="S5.SS2.SSS0.Px2.p4.7.m7.1.1" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.1" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.1.cmml">arg</mi><mo lspace="0.167em" id="S5.SS2.SSS0.Px2.p4.7.m7.1.1a" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.cmml">⁡</mo><mrow id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.cmml"><msub id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1.cmml"><mi id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1.2" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1.2.cmml">max</mi><mi id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1.3" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1.3.cmml">c</mi></msub><mo lspace="0.167em" id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2a" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.cmml">⁡</mo><msub id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2.cmml"><mi id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2.2" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2.2.cmml">p</mi><mi id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2.3" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2.3.cmml">c</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p4.7.m7.1b"><apply id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1"><arg id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.1"></arg><apply id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2"><apply id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1.cmml" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1">subscript</csymbol><max id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1.2.cmml" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1.2"></max><ci id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1.3.cmml" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.1.3">𝑐</ci></apply><apply id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2.cmml" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2.1.cmml" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2.2">𝑝</ci><ci id="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2.3.cmml" xref="S5.SS2.SSS0.Px2.p4.7.m7.1.1.2.2.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p4.7.m7.1c">\arg\max_{c}p_{c}</annotation></semantics></math> implies which class the neuron contributes to more. The results are shown in Fig. <a href="#S5.F8" title="Figure 8 ‣ Do PANs indeed reduce the possibility of neuron misalignment? ‣ 5.2 Decentralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, where each vertical line represents a neuron/channel. The number in “[]” shows how much neurons/channels correspond to the same class between global and local models. With PANs, the coordinate matching results are better. These empirical results verify the pre-alignment effects brought by PANs.</p>
</div>
<figure id="S5.F9" class="ltx_figure"><img src="/html/2203.14666/assets/x10.png" id="S5.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="247" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F9.5.2.1" class="ltx_text" style="font-size:90%;">Figure 9</span>: </span><span id="S5.F9.2.1" class="ltx_text" style="font-size:90%;">Comparison results on non-i.i.d. data (<math id="S5.F9.2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.F9.2.1.m1.1b"><mi id="S5.F9.2.1.m1.1.1" xref="S5.F9.2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.F9.2.1.m1.1c"><ci id="S5.F9.2.1.m1.1.1.cmml" xref="S5.F9.2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F9.2.1.m1.1d">\alpha</annotation></semantics></math>=0.1). Rows show datasets and columns show FL algorithms. PANs could universally improve these algorithms. (<span id="S5.F9.2.1.1" class="ltx_text" style="font-size:78%;">More datasets are shown in Supp.</span>)</span></figcaption>
</figure>
<figure id="S5.T1" class="ltx_table">
<table id="S5.T1.9" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.4.4" class="ltx_tr">
<th id="S5.T1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Settings (<math id="S5.T1.1.1.1.m1.4" class="ltx_Math" alttext="K,R,\alpha,E" display="inline"><semantics id="S5.T1.1.1.1.m1.4a"><mrow id="S5.T1.1.1.1.m1.4.5.2" xref="S5.T1.1.1.1.m1.4.5.1.cmml"><mi id="S5.T1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.m1.1.1.cmml">K</mi><mo id="S5.T1.1.1.1.m1.4.5.2.1" xref="S5.T1.1.1.1.m1.4.5.1.cmml">,</mo><mi id="S5.T1.1.1.1.m1.2.2" xref="S5.T1.1.1.1.m1.2.2.cmml">R</mi><mo id="S5.T1.1.1.1.m1.4.5.2.2" xref="S5.T1.1.1.1.m1.4.5.1.cmml">,</mo><mi id="S5.T1.1.1.1.m1.3.3" xref="S5.T1.1.1.1.m1.3.3.cmml">α</mi><mo id="S5.T1.1.1.1.m1.4.5.2.3" xref="S5.T1.1.1.1.m1.4.5.1.cmml">,</mo><mi id="S5.T1.1.1.1.m1.4.4" xref="S5.T1.1.1.1.m1.4.4.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.m1.4b"><list id="S5.T1.1.1.1.m1.4.5.1.cmml" xref="S5.T1.1.1.1.m1.4.5.2"><ci id="S5.T1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1">𝐾</ci><ci id="S5.T1.1.1.1.m1.2.2.cmml" xref="S5.T1.1.1.1.m1.2.2">𝑅</ci><ci id="S5.T1.1.1.1.m1.3.3.cmml" xref="S5.T1.1.1.1.m1.3.3">𝛼</ci><ci id="S5.T1.1.1.1.m1.4.4.cmml" xref="S5.T1.1.1.1.m1.4.4">𝐸</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.m1.4c">K,R,\alpha,E</annotation></semantics></math>)</th>
<th id="S5.T1.4.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg</th>
<th id="S5.T1.4.4.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedProx</th>
<th id="S5.T1.4.4.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedMA</th>
<th id="S5.T1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Fed<sup id="S5.T1.2.2.2.1" class="ltx_sup">2</sup>
</th>
<th id="S5.T1.4.4.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">FedDF</th>
<th id="S5.T1.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg<sup id="S5.T1.3.3.3.1" class="ltx_sup">⋆</sup>
</th>
<th id="S5.T1.4.4.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg<sup id="S5.T1.4.4.4.1" class="ltx_sup">⋆</sup>+PANs</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.7.7" class="ltx_tr">
<td id="S5.T1.5.5.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">(<math id="S5.T1.5.5.1.m1.4" class="ltx_Math" alttext="16,1.0,0.5,20" display="inline"><semantics id="S5.T1.5.5.1.m1.4a"><mrow id="S5.T1.5.5.1.m1.4.5.2" xref="S5.T1.5.5.1.m1.4.5.1.cmml"><mn id="S5.T1.5.5.1.m1.1.1" xref="S5.T1.5.5.1.m1.1.1.cmml">16</mn><mo id="S5.T1.5.5.1.m1.4.5.2.1" xref="S5.T1.5.5.1.m1.4.5.1.cmml">,</mo><mn id="S5.T1.5.5.1.m1.2.2" xref="S5.T1.5.5.1.m1.2.2.cmml">1.0</mn><mo id="S5.T1.5.5.1.m1.4.5.2.2" xref="S5.T1.5.5.1.m1.4.5.1.cmml">,</mo><mn id="S5.T1.5.5.1.m1.3.3" xref="S5.T1.5.5.1.m1.3.3.cmml">0.5</mn><mo id="S5.T1.5.5.1.m1.4.5.2.3" xref="S5.T1.5.5.1.m1.4.5.1.cmml">,</mo><mn id="S5.T1.5.5.1.m1.4.4" xref="S5.T1.5.5.1.m1.4.4.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.5.5.1.m1.4b"><list id="S5.T1.5.5.1.m1.4.5.1.cmml" xref="S5.T1.5.5.1.m1.4.5.2"><cn type="integer" id="S5.T1.5.5.1.m1.1.1.cmml" xref="S5.T1.5.5.1.m1.1.1">16</cn><cn type="float" id="S5.T1.5.5.1.m1.2.2.cmml" xref="S5.T1.5.5.1.m1.2.2">1.0</cn><cn type="float" id="S5.T1.5.5.1.m1.3.3.cmml" xref="S5.T1.5.5.1.m1.3.3">0.5</cn><cn type="integer" id="S5.T1.5.5.1.m1.4.4.cmml" xref="S5.T1.5.5.1.m1.4.4">20</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.5.1.m1.4c">16,1.0,0.5,20</annotation></semantics></math>)</td>
<td id="S5.T1.7.7.4" class="ltx_td ltx_align_center ltx_border_t">86.29</td>
<td id="S5.T1.7.7.5" class="ltx_td ltx_align_center ltx_border_t">85.32</td>
<td id="S5.T1.6.6.2" class="ltx_td ltx_align_center ltx_border_t">84.0 (<span id="S5.T1.6.6.2.1" class="ltx_text" style="font-size:90%;">87.53, <math id="S5.T1.6.6.2.1.m1.1" class="ltx_Math" alttext="E=150" display="inline"><semantics id="S5.T1.6.6.2.1.m1.1a"><mrow id="S5.T1.6.6.2.1.m1.1.1" xref="S5.T1.6.6.2.1.m1.1.1.cmml"><mi id="S5.T1.6.6.2.1.m1.1.1.2" xref="S5.T1.6.6.2.1.m1.1.1.2.cmml">E</mi><mo id="S5.T1.6.6.2.1.m1.1.1.1" xref="S5.T1.6.6.2.1.m1.1.1.1.cmml">=</mo><mn id="S5.T1.6.6.2.1.m1.1.1.3" xref="S5.T1.6.6.2.1.m1.1.1.3.cmml">150</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.6.6.2.1.m1.1b"><apply id="S5.T1.6.6.2.1.m1.1.1.cmml" xref="S5.T1.6.6.2.1.m1.1.1"><eq id="S5.T1.6.6.2.1.m1.1.1.1.cmml" xref="S5.T1.6.6.2.1.m1.1.1.1"></eq><ci id="S5.T1.6.6.2.1.m1.1.1.2.cmml" xref="S5.T1.6.6.2.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S5.T1.6.6.2.1.m1.1.1.3.cmml" xref="S5.T1.6.6.2.1.m1.1.1.3">150</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.6.2.1.m1.1c">E=150</annotation></semantics></math>)</span>
</td>
<td id="S5.T1.7.7.6" class="ltx_td ltx_align_center ltx_border_t">88.29</td>
<td id="S5.T1.7.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S5.T1.7.7.8" class="ltx_td ltx_align_center ltx_border_t">86.83</td>
<td id="S5.T1.7.7.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S5.T1.7.7.3.1" class="ltx_text ltx_font_bold">88.49<math id="S5.T1.7.7.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.7.7.3.1.m1.1a"><mo id="S5.T1.7.7.3.1.m1.1.1" xref="S5.T1.7.7.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.7.7.3.1.m1.1b"><csymbol cd="latexml" id="S5.T1.7.7.3.1.m1.1.1.cmml" xref="S5.T1.7.7.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.7.3.1.m1.1c">\pm</annotation></semantics></math>0.07</span></td>
</tr>
<tr id="S5.T1.9.9" class="ltx_tr">
<td id="S5.T1.8.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">(<math id="S5.T1.8.8.1.m1.4" class="ltx_Math" alttext="20,0.4,1.0,40" display="inline"><semantics id="S5.T1.8.8.1.m1.4a"><mrow id="S5.T1.8.8.1.m1.4.5.2" xref="S5.T1.8.8.1.m1.4.5.1.cmml"><mn id="S5.T1.8.8.1.m1.1.1" xref="S5.T1.8.8.1.m1.1.1.cmml">20</mn><mo id="S5.T1.8.8.1.m1.4.5.2.1" xref="S5.T1.8.8.1.m1.4.5.1.cmml">,</mo><mn id="S5.T1.8.8.1.m1.2.2" xref="S5.T1.8.8.1.m1.2.2.cmml">0.4</mn><mo id="S5.T1.8.8.1.m1.4.5.2.2" xref="S5.T1.8.8.1.m1.4.5.1.cmml">,</mo><mn id="S5.T1.8.8.1.m1.3.3" xref="S5.T1.8.8.1.m1.3.3.cmml">1.0</mn><mo id="S5.T1.8.8.1.m1.4.5.2.3" xref="S5.T1.8.8.1.m1.4.5.1.cmml">,</mo><mn id="S5.T1.8.8.1.m1.4.4" xref="S5.T1.8.8.1.m1.4.4.cmml">40</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.8.8.1.m1.4b"><list id="S5.T1.8.8.1.m1.4.5.1.cmml" xref="S5.T1.8.8.1.m1.4.5.2"><cn type="integer" id="S5.T1.8.8.1.m1.1.1.cmml" xref="S5.T1.8.8.1.m1.1.1">20</cn><cn type="float" id="S5.T1.8.8.1.m1.2.2.cmml" xref="S5.T1.8.8.1.m1.2.2">0.4</cn><cn type="float" id="S5.T1.8.8.1.m1.3.3.cmml" xref="S5.T1.8.8.1.m1.3.3">1.0</cn><cn type="integer" id="S5.T1.8.8.1.m1.4.4.cmml" xref="S5.T1.8.8.1.m1.4.4">40</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.8.8.1.m1.4c">20,0.4,1.0,40</annotation></semantics></math>)</td>
<td id="S5.T1.9.9.3" class="ltx_td ltx_align_center ltx_border_bb">78.34</td>
<td id="S5.T1.9.9.4" class="ltx_td ltx_align_center ltx_border_bb">78.60</td>
<td id="S5.T1.9.9.5" class="ltx_td ltx_align_center ltx_border_bb">65.0</td>
<td id="S5.T1.9.9.6" class="ltx_td ltx_align_center ltx_border_bb">-</td>
<td id="S5.T1.9.9.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">80.36</td>
<td id="S5.T1.9.9.8" class="ltx_td ltx_align_center ltx_border_bb">79.76</td>
<td id="S5.T1.9.9.2" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="S5.T1.9.9.2.1" class="ltx_text ltx_font_bold">81.94<math id="S5.T1.9.9.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.9.9.2.1.m1.1a"><mo id="S5.T1.9.9.2.1.m1.1.1" xref="S5.T1.9.9.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.9.9.2.1.m1.1b"><csymbol cd="latexml" id="S5.T1.9.9.2.1.m1.1.1.cmml" xref="S5.T1.9.9.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.9.9.2.1.m1.1c">\pm</annotation></semantics></math>0.09</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.14.2.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S5.T1.11.1" class="ltx_text" style="font-size:90%;">Comparison results with other popular FL algorithms on Cifar10 with VGG9. The left shows settings. The middle shows the cited results from FedMA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, Fed<sup id="S5.T1.11.1.1" class="ltx_sup">2</sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>, and FedDF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. The last two columns show the results we implement.</span></figcaption>
</figure>
<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.9" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.5.5" class="ltx_tr">
<th id="S5.T2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">(<math id="S5.T2.1.1.1.m1.4" class="ltx_Math" alttext="K,R,\alpha,E" display="inline"><semantics id="S5.T2.1.1.1.m1.4a"><mrow id="S5.T2.1.1.1.m1.4.5.2" xref="S5.T2.1.1.1.m1.4.5.1.cmml"><mi id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">K</mi><mo id="S5.T2.1.1.1.m1.4.5.2.1" xref="S5.T2.1.1.1.m1.4.5.1.cmml">,</mo><mi id="S5.T2.1.1.1.m1.2.2" xref="S5.T2.1.1.1.m1.2.2.cmml">R</mi><mo id="S5.T2.1.1.1.m1.4.5.2.2" xref="S5.T2.1.1.1.m1.4.5.1.cmml">,</mo><mi id="S5.T2.1.1.1.m1.3.3" xref="S5.T2.1.1.1.m1.3.3.cmml">α</mi><mo id="S5.T2.1.1.1.m1.4.5.2.3" xref="S5.T2.1.1.1.m1.4.5.1.cmml">,</mo><mi id="S5.T2.1.1.1.m1.4.4" xref="S5.T2.1.1.1.m1.4.4.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.4b"><list id="S5.T2.1.1.1.m1.4.5.1.cmml" xref="S5.T2.1.1.1.m1.4.5.2"><ci id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">𝐾</ci><ci id="S5.T2.1.1.1.m1.2.2.cmml" xref="S5.T2.1.1.1.m1.2.2">𝑅</ci><ci id="S5.T2.1.1.1.m1.3.3.cmml" xref="S5.T2.1.1.1.m1.3.3">𝛼</ci><ci id="S5.T2.1.1.1.m1.4.4.cmml" xref="S5.T2.1.1.1.m1.4.4">𝐸</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.4c">K,R,\alpha,E</annotation></semantics></math>)</th>
<th id="S5.T2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedMA<sup id="S5.T2.2.2.2.1" class="ltx_sup">⋆</sup>
</th>
<th id="S5.T2.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Fed<sup id="S5.T2.4.4.4.1" class="ltx_sup"><span id="S5.T2.4.4.4.1.1" class="ltx_text ltx_font_italic">2</span></sup><sup id="S5.T2.4.4.4.2" class="ltx_sup">⋆</sup>
</th>
<th id="S5.T2.5.5.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg<sup id="S5.T2.5.5.5.1" class="ltx_sup">⋆</sup>+PANs</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.7.7" class="ltx_tr">
<th id="S5.T2.6.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">(<math id="S5.T2.6.6.1.m1.4" class="ltx_Math" alttext="16,1.0,\underline{0.1},20" display="inline"><semantics id="S5.T2.6.6.1.m1.4a"><mrow id="S5.T2.6.6.1.m1.4.5.2" xref="S5.T2.6.6.1.m1.4.5.1.cmml"><mn id="S5.T2.6.6.1.m1.1.1" xref="S5.T2.6.6.1.m1.1.1.cmml">16</mn><mo id="S5.T2.6.6.1.m1.4.5.2.1" xref="S5.T2.6.6.1.m1.4.5.1.cmml">,</mo><mn id="S5.T2.6.6.1.m1.2.2" xref="S5.T2.6.6.1.m1.2.2.cmml">1.0</mn><mo id="S5.T2.6.6.1.m1.4.5.2.2" xref="S5.T2.6.6.1.m1.4.5.1.cmml">,</mo><munder accentunder="true" id="S5.T2.6.6.1.m1.3.3" xref="S5.T2.6.6.1.m1.3.3.cmml"><mn id="S5.T2.6.6.1.m1.3.3.2" xref="S5.T2.6.6.1.m1.3.3.2.cmml">0.1</mn><mo id="S5.T2.6.6.1.m1.3.3.1" xref="S5.T2.6.6.1.m1.3.3.1.cmml">¯</mo></munder><mo id="S5.T2.6.6.1.m1.4.5.2.3" xref="S5.T2.6.6.1.m1.4.5.1.cmml">,</mo><mn id="S5.T2.6.6.1.m1.4.4" xref="S5.T2.6.6.1.m1.4.4.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.1.m1.4b"><list id="S5.T2.6.6.1.m1.4.5.1.cmml" xref="S5.T2.6.6.1.m1.4.5.2"><cn type="integer" id="S5.T2.6.6.1.m1.1.1.cmml" xref="S5.T2.6.6.1.m1.1.1">16</cn><cn type="float" id="S5.T2.6.6.1.m1.2.2.cmml" xref="S5.T2.6.6.1.m1.2.2">1.0</cn><apply id="S5.T2.6.6.1.m1.3.3.cmml" xref="S5.T2.6.6.1.m1.3.3"><ci id="S5.T2.6.6.1.m1.3.3.1.cmml" xref="S5.T2.6.6.1.m1.3.3.1">¯</ci><cn type="float" id="S5.T2.6.6.1.m1.3.3.2.cmml" xref="S5.T2.6.6.1.m1.3.3.2">0.1</cn></apply><cn type="integer" id="S5.T2.6.6.1.m1.4.4.cmml" xref="S5.T2.6.6.1.m1.4.4">20</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.1.m1.4c">16,1.0,\underline{0.1},20</annotation></semantics></math>)</th>
<td id="S5.T2.7.7.3" class="ltx_td ltx_align_center ltx_border_t">83.91</td>
<td id="S5.T2.7.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">82.26</td>
<td id="S5.T2.7.7.2" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S5.T2.7.7.2.1" class="ltx_text ltx_font_bold">85.82 <math id="S5.T2.7.7.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.7.7.2.1.m1.1a"><mo id="S5.T2.7.7.2.1.m1.1.1" xref="S5.T2.7.7.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.2.1.m1.1b"><csymbol cd="latexml" id="S5.T2.7.7.2.1.m1.1.1.cmml" xref="S5.T2.7.7.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.2.1.m1.1c">\pm</annotation></semantics></math>0.16</span></td>
</tr>
<tr id="S5.T2.9.9" class="ltx_tr">
<th id="S5.T2.8.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">(<math id="S5.T2.8.8.1.m1.4" class="ltx_Math" alttext="16,\underline{0.4},0.5,20" display="inline"><semantics id="S5.T2.8.8.1.m1.4a"><mrow id="S5.T2.8.8.1.m1.4.5.2" xref="S5.T2.8.8.1.m1.4.5.1.cmml"><mn id="S5.T2.8.8.1.m1.1.1" xref="S5.T2.8.8.1.m1.1.1.cmml">16</mn><mo id="S5.T2.8.8.1.m1.4.5.2.1" xref="S5.T2.8.8.1.m1.4.5.1.cmml">,</mo><munder accentunder="true" id="S5.T2.8.8.1.m1.2.2" xref="S5.T2.8.8.1.m1.2.2.cmml"><mn id="S5.T2.8.8.1.m1.2.2.2" xref="S5.T2.8.8.1.m1.2.2.2.cmml">0.4</mn><mo id="S5.T2.8.8.1.m1.2.2.1" xref="S5.T2.8.8.1.m1.2.2.1.cmml">¯</mo></munder><mo id="S5.T2.8.8.1.m1.4.5.2.2" xref="S5.T2.8.8.1.m1.4.5.1.cmml">,</mo><mn id="S5.T2.8.8.1.m1.3.3" xref="S5.T2.8.8.1.m1.3.3.cmml">0.5</mn><mo id="S5.T2.8.8.1.m1.4.5.2.3" xref="S5.T2.8.8.1.m1.4.5.1.cmml">,</mo><mn id="S5.T2.8.8.1.m1.4.4" xref="S5.T2.8.8.1.m1.4.4.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.1.m1.4b"><list id="S5.T2.8.8.1.m1.4.5.1.cmml" xref="S5.T2.8.8.1.m1.4.5.2"><cn type="integer" id="S5.T2.8.8.1.m1.1.1.cmml" xref="S5.T2.8.8.1.m1.1.1">16</cn><apply id="S5.T2.8.8.1.m1.2.2.cmml" xref="S5.T2.8.8.1.m1.2.2"><ci id="S5.T2.8.8.1.m1.2.2.1.cmml" xref="S5.T2.8.8.1.m1.2.2.1">¯</ci><cn type="float" id="S5.T2.8.8.1.m1.2.2.2.cmml" xref="S5.T2.8.8.1.m1.2.2.2">0.4</cn></apply><cn type="float" id="S5.T2.8.8.1.m1.3.3.cmml" xref="S5.T2.8.8.1.m1.3.3">0.5</cn><cn type="integer" id="S5.T2.8.8.1.m1.4.4.cmml" xref="S5.T2.8.8.1.m1.4.4">20</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.1.m1.4c">16,\underline{0.4},0.5,20</annotation></semantics></math>)</th>
<td id="S5.T2.9.9.3" class="ltx_td ltx_align_center ltx_border_bb">48.25</td>
<td id="S5.T2.9.9.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">81.23</td>
<td id="S5.T2.9.9.2" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="S5.T2.9.9.2.1" class="ltx_text ltx_font_bold">82.87 <math id="S5.T2.9.9.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.9.9.2.1.m1.1a"><mo id="S5.T2.9.9.2.1.m1.1.1" xref="S5.T2.9.9.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.2.1.m1.1b"><csymbol cd="latexml" id="S5.T2.9.9.2.1.m1.1.1.cmml" xref="S5.T2.9.9.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.2.1.m1.1c">\pm</annotation></semantics></math>0.21</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.11.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S5.T2.12.2" class="ltx_text" style="font-size:90%;">Comparison results with SOTA on more scenes. The results are all implemented by our reproduced code.</span></figcaption>
</figure>
</section>
<section id="S5.SS2.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Do PANs bring performance improvement in FL?</h4>

<div id="S5.SS2.SSS0.Px3.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px3.p1.1" class="ltx_p">We then compare the performances of FL with PANs off/on.</p>
</div>
<div id="S5.SS2.SSS0.Px3.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px3.p2.21" class="ltx_p"><span id="S5.SS2.SSS0.Px3.p2.21.1" class="ltx_text ltx_font_bold">I. Universal Application of PANs:</span> We first apply PANs to some popular FL algorithms as introduced in Sect. <a href="#S2" title="2 Related Works ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, including FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, FedOpt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, Scaffold <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. These methods solve the non-i.i.d. problem from different aspects. Training details of these algorithms are provided in Supp. We add PANs to them and investigate the performance improvements on FeMnist, Cifar10, Cifar100, and Cinic10, where <math id="S5.SS2.SSS0.Px3.p2.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.1.m1.1a"><mrow id="S5.SS2.SSS0.Px3.p2.1.m1.1.1" xref="S5.SS2.SSS0.Px3.p2.1.m1.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p2.1.m1.1.1.2" xref="S5.SS2.SSS0.Px3.p2.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS2.SSS0.Px3.p2.1.m1.1.1.1" xref="S5.SS2.SSS0.Px3.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p2.1.m1.1.1.3" xref="S5.SS2.SSS0.Px3.p2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.1.m1.1b"><apply id="S5.SS2.SSS0.Px3.p2.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.1.m1.1.1"><eq id="S5.SS2.SSS0.Px3.p2.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.1.m1.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p2.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.SS2.SSS0.Px3.p2.1.m1.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.1.m1.1c">\alpha=0.1</annotation></semantics></math>, <math id="S5.SS2.SSS0.Px3.p2.2.m2.1" class="ltx_Math" alttext="K=100" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.2.m2.1a"><mrow id="S5.SS2.SSS0.Px3.p2.2.m2.1.1" xref="S5.SS2.SSS0.Px3.p2.2.m2.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p2.2.m2.1.1.2" xref="S5.SS2.SSS0.Px3.p2.2.m2.1.1.2.cmml">K</mi><mo id="S5.SS2.SSS0.Px3.p2.2.m2.1.1.1" xref="S5.SS2.SSS0.Px3.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p2.2.m2.1.1.3" xref="S5.SS2.SSS0.Px3.p2.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.2.m2.1b"><apply id="S5.SS2.SSS0.Px3.p2.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.2.m2.1.1"><eq id="S5.SS2.SSS0.Px3.p2.2.m2.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.2.m2.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p2.2.m2.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.2.m2.1.1.2">𝐾</ci><cn type="integer" id="S5.SS2.SSS0.Px3.p2.2.m2.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p2.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.2.m2.1c">K=100</annotation></semantics></math>, <math id="S5.SS2.SSS0.Px3.p2.3.m3.1" class="ltx_Math" alttext="R=10\%" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.3.m3.1a"><mrow id="S5.SS2.SSS0.Px3.p2.3.m3.1.1" xref="S5.SS2.SSS0.Px3.p2.3.m3.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p2.3.m3.1.1.2" xref="S5.SS2.SSS0.Px3.p2.3.m3.1.1.2.cmml">R</mi><mo id="S5.SS2.SSS0.Px3.p2.3.m3.1.1.1" xref="S5.SS2.SSS0.Px3.p2.3.m3.1.1.1.cmml">=</mo><mrow id="S5.SS2.SSS0.Px3.p2.3.m3.1.1.3" xref="S5.SS2.SSS0.Px3.p2.3.m3.1.1.3.cmml"><mn id="S5.SS2.SSS0.Px3.p2.3.m3.1.1.3.2" xref="S5.SS2.SSS0.Px3.p2.3.m3.1.1.3.2.cmml">10</mn><mo id="S5.SS2.SSS0.Px3.p2.3.m3.1.1.3.1" xref="S5.SS2.SSS0.Px3.p2.3.m3.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.3.m3.1b"><apply id="S5.SS2.SSS0.Px3.p2.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.3.m3.1.1"><eq id="S5.SS2.SSS0.Px3.p2.3.m3.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.3.m3.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p2.3.m3.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.3.m3.1.1.2">𝑅</ci><apply id="S5.SS2.SSS0.Px3.p2.3.m3.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p2.3.m3.1.1.3"><csymbol cd="latexml" id="S5.SS2.SSS0.Px3.p2.3.m3.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px3.p2.3.m3.1.1.3.1">percent</csymbol><cn type="integer" id="S5.SS2.SSS0.Px3.p2.3.m3.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px3.p2.3.m3.1.1.3.2">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.3.m3.1c">R=10\%</annotation></semantics></math>, <math id="S5.SS2.SSS0.Px3.p2.4.m4.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.4.m4.1a"><mrow id="S5.SS2.SSS0.Px3.p2.4.m4.1.1" xref="S5.SS2.SSS0.Px3.p2.4.m4.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p2.4.m4.1.1.2" xref="S5.SS2.SSS0.Px3.p2.4.m4.1.1.2.cmml">E</mi><mo id="S5.SS2.SSS0.Px3.p2.4.m4.1.1.1" xref="S5.SS2.SSS0.Px3.p2.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p2.4.m4.1.1.3" xref="S5.SS2.SSS0.Px3.p2.4.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.4.m4.1b"><apply id="S5.SS2.SSS0.Px3.p2.4.m4.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.4.m4.1.1"><eq id="S5.SS2.SSS0.Px3.p2.4.m4.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.4.m4.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p2.4.m4.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.4.m4.1.1.2">𝐸</ci><cn type="integer" id="S5.SS2.SSS0.Px3.p2.4.m4.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p2.4.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.4.m4.1c">E=5</annotation></semantics></math>, <math id="S5.SS2.SSS0.Px3.p2.5.m5.1" class="ltx_Math" alttext="H=1000" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.5.m5.1a"><mrow id="S5.SS2.SSS0.Px3.p2.5.m5.1.1" xref="S5.SS2.SSS0.Px3.p2.5.m5.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p2.5.m5.1.1.2" xref="S5.SS2.SSS0.Px3.p2.5.m5.1.1.2.cmml">H</mi><mo id="S5.SS2.SSS0.Px3.p2.5.m5.1.1.1" xref="S5.SS2.SSS0.Px3.p2.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p2.5.m5.1.1.3" xref="S5.SS2.SSS0.Px3.p2.5.m5.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.5.m5.1b"><apply id="S5.SS2.SSS0.Px3.p2.5.m5.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.5.m5.1.1"><eq id="S5.SS2.SSS0.Px3.p2.5.m5.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.5.m5.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p2.5.m5.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.5.m5.1.1.2">𝐻</ci><cn type="integer" id="S5.SS2.SSS0.Px3.p2.5.m5.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p2.5.m5.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.5.m5.1c">H=1000</annotation></semantics></math>. We use <math id="S5.SS2.SSS0.Px3.p2.6.m6.1" class="ltx_Math" alttext="A=0.0" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.6.m6.1a"><mrow id="S5.SS2.SSS0.Px3.p2.6.m6.1.1" xref="S5.SS2.SSS0.Px3.p2.6.m6.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p2.6.m6.1.1.2" xref="S5.SS2.SSS0.Px3.p2.6.m6.1.1.2.cmml">A</mi><mo id="S5.SS2.SSS0.Px3.p2.6.m6.1.1.1" xref="S5.SS2.SSS0.Px3.p2.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p2.6.m6.1.1.3" xref="S5.SS2.SSS0.Px3.p2.6.m6.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.6.m6.1b"><apply id="S5.SS2.SSS0.Px3.p2.6.m6.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.6.m6.1.1"><eq id="S5.SS2.SSS0.Px3.p2.6.m6.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.6.m6.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p2.6.m6.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.6.m6.1.1.2">𝐴</ci><cn type="float" id="S5.SS2.SSS0.Px3.p2.6.m6.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p2.6.m6.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.6.m6.1c">A=0.0</annotation></semantics></math> as the baseline. Hyper-parameters are searched from three groups: PAN<sub id="S5.SS2.SSS0.Px3.p2.21.2" class="ltx_sub">+</sub> with <math id="S5.SS2.SSS0.Px3.p2.8.m8.1" class="ltx_Math" alttext="A=0.05" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.8.m8.1a"><mrow id="S5.SS2.SSS0.Px3.p2.8.m8.1.1" xref="S5.SS2.SSS0.Px3.p2.8.m8.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p2.8.m8.1.1.2" xref="S5.SS2.SSS0.Px3.p2.8.m8.1.1.2.cmml">A</mi><mo id="S5.SS2.SSS0.Px3.p2.8.m8.1.1.1" xref="S5.SS2.SSS0.Px3.p2.8.m8.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p2.8.m8.1.1.3" xref="S5.SS2.SSS0.Px3.p2.8.m8.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.8.m8.1b"><apply id="S5.SS2.SSS0.Px3.p2.8.m8.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.8.m8.1.1"><eq id="S5.SS2.SSS0.Px3.p2.8.m8.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.8.m8.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p2.8.m8.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.8.m8.1.1.2">𝐴</ci><cn type="float" id="S5.SS2.SSS0.Px3.p2.8.m8.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p2.8.m8.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.8.m8.1c">A=0.05</annotation></semantics></math>, PAN<sub id="S5.SS2.SSS0.Px3.p2.21.3" class="ltx_sub">∘</sub> with <math id="S5.SS2.SSS0.Px3.p2.10.m10.1" class="ltx_Math" alttext="A=0.05" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.10.m10.1a"><mrow id="S5.SS2.SSS0.Px3.p2.10.m10.1.1" xref="S5.SS2.SSS0.Px3.p2.10.m10.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p2.10.m10.1.1.2" xref="S5.SS2.SSS0.Px3.p2.10.m10.1.1.2.cmml">A</mi><mo id="S5.SS2.SSS0.Px3.p2.10.m10.1.1.1" xref="S5.SS2.SSS0.Px3.p2.10.m10.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p2.10.m10.1.1.3" xref="S5.SS2.SSS0.Px3.p2.10.m10.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.10.m10.1b"><apply id="S5.SS2.SSS0.Px3.p2.10.m10.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.10.m10.1.1"><eq id="S5.SS2.SSS0.Px3.p2.10.m10.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.10.m10.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p2.10.m10.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.10.m10.1.1.2">𝐴</ci><cn type="float" id="S5.SS2.SSS0.Px3.p2.10.m10.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p2.10.m10.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.10.m10.1c">A=0.05</annotation></semantics></math>, PAN<sub id="S5.SS2.SSS0.Px3.p2.21.4" class="ltx_sub">∘</sub> with <math id="S5.SS2.SSS0.Px3.p2.12.m12.1" class="ltx_Math" alttext="A=0.1" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.12.m12.1a"><mrow id="S5.SS2.SSS0.Px3.p2.12.m12.1.1" xref="S5.SS2.SSS0.Px3.p2.12.m12.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p2.12.m12.1.1.2" xref="S5.SS2.SSS0.Px3.p2.12.m12.1.1.2.cmml">A</mi><mo id="S5.SS2.SSS0.Px3.p2.12.m12.1.1.1" xref="S5.SS2.SSS0.Px3.p2.12.m12.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p2.12.m12.1.1.3" xref="S5.SS2.SSS0.Px3.p2.12.m12.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.12.m12.1b"><apply id="S5.SS2.SSS0.Px3.p2.12.m12.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.12.m12.1.1"><eq id="S5.SS2.SSS0.Px3.p2.12.m12.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.12.m12.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p2.12.m12.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.12.m12.1.1.2">𝐴</ci><cn type="float" id="S5.SS2.SSS0.Px3.p2.12.m12.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p2.12.m12.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.12.m12.1c">A=0.1</annotation></semantics></math>, and the best result is reported in Fig. <a href="#S5.F9" title="Figure 9 ‣ Do PANs indeed reduce the possibility of neuron misalignment? ‣ 5.2 Decentralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. PANs indeed improve these algorithms. With various non-i.i.d. levels of decentralized data, i.e., <math id="S5.SS2.SSS0.Px3.p2.13.m13.3" class="ltx_Math" alttext="\alpha\in\{10.0,1.0,0.5\}" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.13.m13.3a"><mrow id="S5.SS2.SSS0.Px3.p2.13.m13.3.4" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.4.cmml"><mi id="S5.SS2.SSS0.Px3.p2.13.m13.3.4.2" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.4.2.cmml">α</mi><mo id="S5.SS2.SSS0.Px3.p2.13.m13.3.4.1" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.4.1.cmml">∈</mo><mrow id="S5.SS2.SSS0.Px3.p2.13.m13.3.4.3.2" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.4.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px3.p2.13.m13.3.4.3.2.1" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.4.3.1.cmml">{</mo><mn id="S5.SS2.SSS0.Px3.p2.13.m13.1.1" xref="S5.SS2.SSS0.Px3.p2.13.m13.1.1.cmml">10.0</mn><mo id="S5.SS2.SSS0.Px3.p2.13.m13.3.4.3.2.2" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.4.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px3.p2.13.m13.2.2" xref="S5.SS2.SSS0.Px3.p2.13.m13.2.2.cmml">1.0</mn><mo id="S5.SS2.SSS0.Px3.p2.13.m13.3.4.3.2.3" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.4.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px3.p2.13.m13.3.3" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.3.cmml">0.5</mn><mo stretchy="false" id="S5.SS2.SSS0.Px3.p2.13.m13.3.4.3.2.4" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.13.m13.3b"><apply id="S5.SS2.SSS0.Px3.p2.13.m13.3.4.cmml" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.4"><in id="S5.SS2.SSS0.Px3.p2.13.m13.3.4.1.cmml" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.4.1"></in><ci id="S5.SS2.SSS0.Px3.p2.13.m13.3.4.2.cmml" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.4.2">𝛼</ci><set id="S5.SS2.SSS0.Px3.p2.13.m13.3.4.3.1.cmml" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.4.3.2"><cn type="float" id="S5.SS2.SSS0.Px3.p2.13.m13.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.13.m13.1.1">10.0</cn><cn type="float" id="S5.SS2.SSS0.Px3.p2.13.m13.2.2.cmml" xref="S5.SS2.SSS0.Px3.p2.13.m13.2.2">1.0</cn><cn type="float" id="S5.SS2.SSS0.Px3.p2.13.m13.3.3.cmml" xref="S5.SS2.SSS0.Px3.p2.13.m13.3.3">0.5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.13.m13.3c">\alpha\in\{10.0,1.0,0.5\}</annotation></semantics></math>. We report the averaged accuracy of the last five communication rounds in Fig. <a href="#S5.F10" title="Figure 10 ‣ Do PANs bring performance improvement in FL? ‣ 5.2 Decentralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> (<math id="S5.SS2.SSS0.Px3.p2.14.m14.1" class="ltx_Math" alttext="H=200" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.14.m14.1a"><mrow id="S5.SS2.SSS0.Px3.p2.14.m14.1.1" xref="S5.SS2.SSS0.Px3.p2.14.m14.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p2.14.m14.1.1.2" xref="S5.SS2.SSS0.Px3.p2.14.m14.1.1.2.cmml">H</mi><mo id="S5.SS2.SSS0.Px3.p2.14.m14.1.1.1" xref="S5.SS2.SSS0.Px3.p2.14.m14.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p2.14.m14.1.1.3" xref="S5.SS2.SSS0.Px3.p2.14.m14.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.14.m14.1b"><apply id="S5.SS2.SSS0.Px3.p2.14.m14.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.14.m14.1.1"><eq id="S5.SS2.SSS0.Px3.p2.14.m14.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.14.m14.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p2.14.m14.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.14.m14.1.1.2">𝐻</ci><cn type="integer" id="S5.SS2.SSS0.Px3.p2.14.m14.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p2.14.m14.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.14.m14.1c">H=200</annotation></semantics></math> communication rounds with other hyper-parameters the same). Obviously, more non-i.i.d. scenes (smaller <math id="S5.SS2.SSS0.Px3.p2.15.m15.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.15.m15.1a"><mi id="S5.SS2.SSS0.Px3.p2.15.m15.1.1" xref="S5.SS2.SSS0.Px3.p2.15.m15.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.15.m15.1b"><ci id="S5.SS2.SSS0.Px3.p2.15.m15.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.15.m15.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.15.m15.1c">\alpha</annotation></semantics></math>) experience more significant improvements. This is related to the regularization effect as analyzed in Sect. <a href="#S4.SS2" title="4.2 Applying PANs to FL ‣ 4 FL with PANs ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>. We also investigate the results with various numbers of clients and local training epochs, i.e., <math id="S5.SS2.SSS0.Px3.p2.16.m16.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.16.m16.1a"><mi id="S5.SS2.SSS0.Px3.p2.16.m16.1.1" xref="S5.SS2.SSS0.Px3.p2.16.m16.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.16.m16.1b"><ci id="S5.SS2.SSS0.Px3.p2.16.m16.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.16.m16.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.16.m16.1c">K</annotation></semantics></math> and <math id="S5.SS2.SSS0.Px3.p2.17.m17.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.17.m17.1a"><mi id="S5.SS2.SSS0.Px3.p2.17.m17.1.1" xref="S5.SS2.SSS0.Px3.p2.17.m17.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.17.m17.1b"><ci id="S5.SS2.SSS0.Px3.p2.17.m17.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.17.m17.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.17.m17.1c">E</annotation></semantics></math>. The results of FedAvg on Cifar10 and Cifar100 are shown in Fig. <a href="#S5.F11" title="Figure 11 ‣ Do PANs bring performance improvement in FL? ‣ 5.2 Decentralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>, where we take <math id="S5.SS2.SSS0.Px3.p2.18.m18.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.18.m18.1a"><mrow id="S5.SS2.SSS0.Px3.p2.18.m18.1.1" xref="S5.SS2.SSS0.Px3.p2.18.m18.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p2.18.m18.1.1.2" xref="S5.SS2.SSS0.Px3.p2.18.m18.1.1.2.cmml">α</mi><mo id="S5.SS2.SSS0.Px3.p2.18.m18.1.1.1" xref="S5.SS2.SSS0.Px3.p2.18.m18.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p2.18.m18.1.1.3" xref="S5.SS2.SSS0.Px3.p2.18.m18.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.18.m18.1b"><apply id="S5.SS2.SSS0.Px3.p2.18.m18.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.18.m18.1.1"><eq id="S5.SS2.SSS0.Px3.p2.18.m18.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.18.m18.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p2.18.m18.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.18.m18.1.1.2">𝛼</ci><cn type="float" id="S5.SS2.SSS0.Px3.p2.18.m18.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p2.18.m18.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.18.m18.1c">\alpha=0.1</annotation></semantics></math> and <math id="S5.SS2.SSS0.Px3.p2.19.m19.1" class="ltx_Math" alttext="H=400" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.19.m19.1a"><mrow id="S5.SS2.SSS0.Px3.p2.19.m19.1.1" xref="S5.SS2.SSS0.Px3.p2.19.m19.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p2.19.m19.1.1.2" xref="S5.SS2.SSS0.Px3.p2.19.m19.1.1.2.cmml">H</mi><mo id="S5.SS2.SSS0.Px3.p2.19.m19.1.1.1" xref="S5.SS2.SSS0.Px3.p2.19.m19.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p2.19.m19.1.1.3" xref="S5.SS2.SSS0.Px3.p2.19.m19.1.1.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.19.m19.1b"><apply id="S5.SS2.SSS0.Px3.p2.19.m19.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.19.m19.1.1"><eq id="S5.SS2.SSS0.Px3.p2.19.m19.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.19.m19.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p2.19.m19.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.19.m19.1.1.2">𝐻</ci><cn type="integer" id="S5.SS2.SSS0.Px3.p2.19.m19.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p2.19.m19.1.1.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.19.m19.1c">H=400</annotation></semantics></math>. On average, introducing PANs could lead to about <math id="S5.SS2.SSS0.Px3.p2.20.m20.1" class="ltx_Math" alttext="1\%" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.20.m20.1a"><mrow id="S5.SS2.SSS0.Px3.p2.20.m20.1.1" xref="S5.SS2.SSS0.Px3.p2.20.m20.1.1.cmml"><mn id="S5.SS2.SSS0.Px3.p2.20.m20.1.1.2" xref="S5.SS2.SSS0.Px3.p2.20.m20.1.1.2.cmml">1</mn><mo id="S5.SS2.SSS0.Px3.p2.20.m20.1.1.1" xref="S5.SS2.SSS0.Px3.p2.20.m20.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.20.m20.1b"><apply id="S5.SS2.SSS0.Px3.p2.20.m20.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.20.m20.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px3.p2.20.m20.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.20.m20.1.1.1">percent</csymbol><cn type="integer" id="S5.SS2.SSS0.Px3.p2.20.m20.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.20.m20.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.20.m20.1c">1\%</annotation></semantics></math> to <math id="S5.SS2.SSS0.Px3.p2.21.m21.1" class="ltx_Math" alttext="2\%" display="inline"><semantics id="S5.SS2.SSS0.Px3.p2.21.m21.1a"><mrow id="S5.SS2.SSS0.Px3.p2.21.m21.1.1" xref="S5.SS2.SSS0.Px3.p2.21.m21.1.1.cmml"><mn id="S5.SS2.SSS0.Px3.p2.21.m21.1.1.2" xref="S5.SS2.SSS0.Px3.p2.21.m21.1.1.2.cmml">2</mn><mo id="S5.SS2.SSS0.Px3.p2.21.m21.1.1.1" xref="S5.SS2.SSS0.Px3.p2.21.m21.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p2.21.m21.1b"><apply id="S5.SS2.SSS0.Px3.p2.21.m21.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.21.m21.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px3.p2.21.m21.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p2.21.m21.1.1.1">percent</csymbol><cn type="integer" id="S5.SS2.SSS0.Px3.p2.21.m21.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p2.21.m21.1.1.2">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p2.21.m21.1c">2\%</annotation></semantics></math> improvement on various scenes. These studies verify that PANs could be universally and effectively applied to FL algorithms under various settings.</p>
</div>
<figure id="S5.F10" class="ltx_figure"><img src="/html/2203.14666/assets/x11.png" id="S5.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="163" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F10.5.2.1" class="ltx_text" style="font-size:90%;">Figure 10</span>: </span><span id="S5.F10.2.1" class="ltx_text" style="font-size:90%;">Comparisons under various levels of non-i.i.d. data on Cinic10. Smaller <math id="S5.F10.2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.F10.2.1.m1.1b"><mi id="S5.F10.2.1.m1.1.1" xref="S5.F10.2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.F10.2.1.m1.1c"><ci id="S5.F10.2.1.m1.1.1.cmml" xref="S5.F10.2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F10.2.1.m1.1d">\alpha</annotation></semantics></math> implies more non-i.i.d. data. (<span id="S5.F10.2.1.1" class="ltx_text" style="font-size:78%;">More datasets are shown in Supp.</span>)</span></figcaption>
</figure>
<figure id="S5.F11" class="ltx_figure"><img src="/html/2203.14666/assets/x12.png" id="S5.F11.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="218" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F11.7.3.1" class="ltx_text" style="font-size:90%;">Figure 11</span>: </span><span id="S5.F11.4.2" class="ltx_text" style="font-size:90%;">Comparisons under different FL scenes (<math id="S5.F11.3.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.F11.3.1.m1.1b"><mi id="S5.F11.3.1.m1.1.1" xref="S5.F11.3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.F11.3.1.m1.1c"><ci id="S5.F11.3.1.m1.1.1.cmml" xref="S5.F11.3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F11.3.1.m1.1d">K</annotation></semantics></math>, <math id="S5.F11.4.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.F11.4.2.m2.1b"><mi id="S5.F11.4.2.m2.1.1" xref="S5.F11.4.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.F11.4.2.m2.1c"><ci id="S5.F11.4.2.m2.1.1.cmml" xref="S5.F11.4.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F11.4.2.m2.1d">E</annotation></semantics></math>) based on FedAvg. (<span id="S5.F11.4.2.1" class="ltx_text" style="font-size:78%;">Scaffold results are shown in Supp.</span>)</span></figcaption>
</figure>
<div id="S5.SS2.SSS0.Px3.p3" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px3.p3.8" class="ltx_p"><span id="S5.SS2.SSS0.Px3.p3.8.1" class="ltx_text ltx_font_bold">II. Hyper-parameter Analysis:</span> We first vary <math id="S5.SS2.SSS0.Px3.p3.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.SS2.SSS0.Px3.p3.1.m1.1a"><mi id="S5.SS2.SSS0.Px3.p3.1.m1.1.1" xref="S5.SS2.SSS0.Px3.p3.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p3.1.m1.1b"><ci id="S5.SS2.SSS0.Px3.p3.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p3.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p3.1.m1.1c">A</annotation></semantics></math> on Cifar10 and plot the results on the left of Fig. <a href="#S5.F12" title="Figure 12 ‣ Do PANs bring performance improvement in FL? ‣ 5.2 Decentralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>. We set <math id="S5.SS2.SSS0.Px3.p3.2.m2.1" class="ltx_Math" alttext="T=1.0" display="inline"><semantics id="S5.SS2.SSS0.Px3.p3.2.m2.1a"><mrow id="S5.SS2.SSS0.Px3.p3.2.m2.1.1" xref="S5.SS2.SSS0.Px3.p3.2.m2.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p3.2.m2.1.1.2" xref="S5.SS2.SSS0.Px3.p3.2.m2.1.1.2.cmml">T</mi><mo id="S5.SS2.SSS0.Px3.p3.2.m2.1.1.1" xref="S5.SS2.SSS0.Px3.p3.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p3.2.m2.1.1.3" xref="S5.SS2.SSS0.Px3.p3.2.m2.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p3.2.m2.1b"><apply id="S5.SS2.SSS0.Px3.p3.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px3.p3.2.m2.1.1"><eq id="S5.SS2.SSS0.Px3.p3.2.m2.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p3.2.m2.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p3.2.m2.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p3.2.m2.1.1.2">𝑇</ci><cn type="float" id="S5.SS2.SSS0.Px3.p3.2.m2.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p3.2.m2.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p3.2.m2.1c">T=1.0</annotation></semantics></math> and only report the results of multiplicative PANs. Setting <math id="S5.SS2.SSS0.Px3.p3.3.m3.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.SS2.SSS0.Px3.p3.3.m3.1a"><mi id="S5.SS2.SSS0.Px3.p3.3.m3.1.1" xref="S5.SS2.SSS0.Px3.p3.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p3.3.m3.1b"><ci id="S5.SS2.SSS0.Px3.p3.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px3.p3.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p3.3.m3.1c">A</annotation></semantics></math> around 0.1 could improve the performance a lot, while using larger <math id="S5.SS2.SSS0.Px3.p3.4.m4.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.SS2.SSS0.Px3.p3.4.m4.1a"><mi id="S5.SS2.SSS0.Px3.p3.4.m4.1.1" xref="S5.SS2.SSS0.Px3.p3.4.m4.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p3.4.m4.1b"><ci id="S5.SS2.SSS0.Px3.p3.4.m4.1.1.cmml" xref="S5.SS2.SSS0.Px3.p3.4.m4.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p3.4.m4.1c">A</annotation></semantics></math> experiences degradation, which is because neural networks become harder to train. This again shows that <math id="S5.SS2.SSS0.Px3.p3.5.m5.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.SS2.SSS0.Px3.p3.5.m5.1a"><mi id="S5.SS2.SSS0.Px3.p3.5.m5.1.1" xref="S5.SS2.SSS0.Px3.p3.5.m5.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p3.5.m5.1b"><ci id="S5.SS2.SSS0.Px3.p3.5.m5.1.1.cmml" xref="S5.SS2.SSS0.Px3.p3.5.m5.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p3.5.m5.1c">A</annotation></semantics></math> is a tradeoff between neuron pre-alignment and network performance. The proportions of the optimal hyper-parameters from the results of the above experiments are shown on the right of Fig. <a href="#S5.F12" title="Figure 12 ‣ Do PANs bring performance improvement in FL? ‣ 5.2 Decentralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>. Using <math id="S5.SS2.SSS0.Px3.p3.6.m6.1" class="ltx_Math" alttext="A=0.1" display="inline"><semantics id="S5.SS2.SSS0.Px3.p3.6.m6.1a"><mrow id="S5.SS2.SSS0.Px3.p3.6.m6.1.1" xref="S5.SS2.SSS0.Px3.p3.6.m6.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p3.6.m6.1.1.2" xref="S5.SS2.SSS0.Px3.p3.6.m6.1.1.2.cmml">A</mi><mo id="S5.SS2.SSS0.Px3.p3.6.m6.1.1.1" xref="S5.SS2.SSS0.Px3.p3.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p3.6.m6.1.1.3" xref="S5.SS2.SSS0.Px3.p3.6.m6.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p3.6.m6.1b"><apply id="S5.SS2.SSS0.Px3.p3.6.m6.1.1.cmml" xref="S5.SS2.SSS0.Px3.p3.6.m6.1.1"><eq id="S5.SS2.SSS0.Px3.p3.6.m6.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p3.6.m6.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p3.6.m6.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p3.6.m6.1.1.2">𝐴</ci><cn type="float" id="S5.SS2.SSS0.Px3.p3.6.m6.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p3.6.m6.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p3.6.m6.1c">A=0.1</annotation></semantics></math> in multiplicative PANs is a good choice. <math id="S5.SS2.SSS0.Px3.p3.7.m7.1" class="ltx_Math" alttext="A=0.0" display="inline"><semantics id="S5.SS2.SSS0.Px3.p3.7.m7.1a"><mrow id="S5.SS2.SSS0.Px3.p3.7.m7.1.1" xref="S5.SS2.SSS0.Px3.p3.7.m7.1.1.cmml"><mi id="S5.SS2.SSS0.Px3.p3.7.m7.1.1.2" xref="S5.SS2.SSS0.Px3.p3.7.m7.1.1.2.cmml">A</mi><mo id="S5.SS2.SSS0.Px3.p3.7.m7.1.1.1" xref="S5.SS2.SSS0.Px3.p3.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px3.p3.7.m7.1.1.3" xref="S5.SS2.SSS0.Px3.p3.7.m7.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p3.7.m7.1b"><apply id="S5.SS2.SSS0.Px3.p3.7.m7.1.1.cmml" xref="S5.SS2.SSS0.Px3.p3.7.m7.1.1"><eq id="S5.SS2.SSS0.Px3.p3.7.m7.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p3.7.m7.1.1.1"></eq><ci id="S5.SS2.SSS0.Px3.p3.7.m7.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p3.7.m7.1.1.2">𝐴</ci><cn type="float" id="S5.SS2.SSS0.Px3.p3.7.m7.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p3.7.m7.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p3.7.m7.1c">A=0.0</annotation></semantics></math> means turning off PANs, and its ratio is only about <math id="S5.SS2.SSS0.Px3.p3.8.m8.1" class="ltx_Math" alttext="13\%" display="inline"><semantics id="S5.SS2.SSS0.Px3.p3.8.m8.1a"><mrow id="S5.SS2.SSS0.Px3.p3.8.m8.1.1" xref="S5.SS2.SSS0.Px3.p3.8.m8.1.1.cmml"><mn id="S5.SS2.SSS0.Px3.p3.8.m8.1.1.2" xref="S5.SS2.SSS0.Px3.p3.8.m8.1.1.2.cmml">13</mn><mo id="S5.SS2.SSS0.Px3.p3.8.m8.1.1.1" xref="S5.SS2.SSS0.Px3.p3.8.m8.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p3.8.m8.1b"><apply id="S5.SS2.SSS0.Px3.p3.8.m8.1.1.cmml" xref="S5.SS2.SSS0.Px3.p3.8.m8.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px3.p3.8.m8.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p3.8.m8.1.1.1">percent</csymbol><cn type="integer" id="S5.SS2.SSS0.Px3.p3.8.m8.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p3.8.m8.1.1.2">13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p3.8.m8.1c">13\%</annotation></semantics></math>, which means turning on PANs is useful in most cases.</p>
</div>
<div id="S5.SS2.SSS0.Px3.p4" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px3.p4.10" class="ltx_p"><span id="S5.SS2.SSS0.Px3.p4.10.1" class="ltx_text ltx_font_bold">III. Comparing with SOTA:</span> FedMA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> and Fed<sup id="S5.SS2.SSS0.Px3.p4.10.2" class="ltx_sup">2</sup> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> are representative works that solve the parameter alignment problems in FL. We collect the reported settings and results in FedMA, Fed<sup id="S5.SS2.SSS0.Px3.p4.10.3" class="ltx_sup">2</sup>, and FedDF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, and compare the performances under the same settings. We list the results on Cifar10 with VGG9 in Tab. <a href="#S5.T1" title="Table 1 ‣ Do PANs indeed reduce the possibility of neuron misalignment? ‣ 5.2 Decentralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, where the last three columns show our results. Although our reproduced FedAvg performs slightly better than the cited results, the performance gain via introducing PANs is remarkable. We then vary the settings of (<math id="S5.SS2.SSS0.Px3.p4.3.m3.4" class="ltx_Math" alttext="16,1.0,0.5,20" display="inline"><semantics id="S5.SS2.SSS0.Px3.p4.3.m3.4a"><mrow id="S5.SS2.SSS0.Px3.p4.3.m3.4.5.2" xref="S5.SS2.SSS0.Px3.p4.3.m3.4.5.1.cmml"><mn id="S5.SS2.SSS0.Px3.p4.3.m3.1.1" xref="S5.SS2.SSS0.Px3.p4.3.m3.1.1.cmml">16</mn><mo id="S5.SS2.SSS0.Px3.p4.3.m3.4.5.2.1" xref="S5.SS2.SSS0.Px3.p4.3.m3.4.5.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px3.p4.3.m3.2.2" xref="S5.SS2.SSS0.Px3.p4.3.m3.2.2.cmml">1.0</mn><mo id="S5.SS2.SSS0.Px3.p4.3.m3.4.5.2.2" xref="S5.SS2.SSS0.Px3.p4.3.m3.4.5.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px3.p4.3.m3.3.3" xref="S5.SS2.SSS0.Px3.p4.3.m3.3.3.cmml">0.5</mn><mo id="S5.SS2.SSS0.Px3.p4.3.m3.4.5.2.3" xref="S5.SS2.SSS0.Px3.p4.3.m3.4.5.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px3.p4.3.m3.4.4" xref="S5.SS2.SSS0.Px3.p4.3.m3.4.4.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p4.3.m3.4b"><list id="S5.SS2.SSS0.Px3.p4.3.m3.4.5.1.cmml" xref="S5.SS2.SSS0.Px3.p4.3.m3.4.5.2"><cn type="integer" id="S5.SS2.SSS0.Px3.p4.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px3.p4.3.m3.1.1">16</cn><cn type="float" id="S5.SS2.SSS0.Px3.p4.3.m3.2.2.cmml" xref="S5.SS2.SSS0.Px3.p4.3.m3.2.2">1.0</cn><cn type="float" id="S5.SS2.SSS0.Px3.p4.3.m3.3.3.cmml" xref="S5.SS2.SSS0.Px3.p4.3.m3.3.3">0.5</cn><cn type="integer" id="S5.SS2.SSS0.Px3.p4.3.m3.4.4.cmml" xref="S5.SS2.SSS0.Px3.p4.3.m3.4.4">20</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p4.3.m3.4c">16,1.0,0.5,20</annotation></semantics></math>) from two aspects: (1) decreasing the non-i.i.d. <math id="S5.SS2.SSS0.Px3.p4.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.SSS0.Px3.p4.4.m4.1a"><mi id="S5.SS2.SSS0.Px3.p4.4.m4.1.1" xref="S5.SS2.SSS0.Px3.p4.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p4.4.m4.1b"><ci id="S5.SS2.SSS0.Px3.p4.4.m4.1.1.cmml" xref="S5.SS2.SSS0.Px3.p4.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p4.4.m4.1c">\alpha</annotation></semantics></math> from <math id="S5.SS2.SSS0.Px3.p4.5.m5.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S5.SS2.SSS0.Px3.p4.5.m5.1a"><mn id="S5.SS2.SSS0.Px3.p4.5.m5.1.1" xref="S5.SS2.SSS0.Px3.p4.5.m5.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p4.5.m5.1b"><cn type="float" id="S5.SS2.SSS0.Px3.p4.5.m5.1.1.cmml" xref="S5.SS2.SSS0.Px3.p4.5.m5.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p4.5.m5.1c">0.5</annotation></semantics></math> to <math id="S5.SS2.SSS0.Px3.p4.6.m6.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S5.SS2.SSS0.Px3.p4.6.m6.1a"><mn id="S5.SS2.SSS0.Px3.p4.6.m6.1.1" xref="S5.SS2.SSS0.Px3.p4.6.m6.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p4.6.m6.1b"><cn type="float" id="S5.SS2.SSS0.Px3.p4.6.m6.1.1.cmml" xref="S5.SS2.SSS0.Px3.p4.6.m6.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p4.6.m6.1c">0.1</annotation></semantics></math>, i.e., a more non-i.i.d. scene; (2) decreasing the client selection ratio from <math id="S5.SS2.SSS0.Px3.p4.7.m7.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S5.SS2.SSS0.Px3.p4.7.m7.1a"><mn id="S5.SS2.SSS0.Px3.p4.7.m7.1.1" xref="S5.SS2.SSS0.Px3.p4.7.m7.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p4.7.m7.1b"><cn type="float" id="S5.SS2.SSS0.Px3.p4.7.m7.1.1.cmml" xref="S5.SS2.SSS0.Px3.p4.7.m7.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p4.7.m7.1c">1.0</annotation></semantics></math> to <math id="S5.SS2.SSS0.Px3.p4.8.m8.1" class="ltx_Math" alttext="0.4" display="inline"><semantics id="S5.SS2.SSS0.Px3.p4.8.m8.1a"><mn id="S5.SS2.SSS0.Px3.p4.8.m8.1.1" xref="S5.SS2.SSS0.Px3.p4.8.m8.1.1.cmml">0.4</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p4.8.m8.1b"><cn type="float" id="S5.SS2.SSS0.Px3.p4.8.m8.1.1.cmml" xref="S5.SS2.SSS0.Px3.p4.8.m8.1.1">0.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p4.8.m8.1c">0.4</annotation></semantics></math>, i.e., partial client participation. Aside from the above changes, other hyper-parameters are kept the same. We run the code provided by FedMA<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a target="_blank" href="https://github.com/IBM/FedMA" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/IBM/FedMA</a></span></span></span> and reproduce Fed<sup id="S5.SS2.SSS0.Px3.p4.10.4" class="ltx_sup">2</sup> via our implementations. The results are listed in Tab. <a href="#S5.T2" title="Table 2 ‣ Do PANs indeed reduce the possibility of neuron misalignment? ‣ 5.2 Decentralized Training ‣ 5 Experiments ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. FedMA performs especially worse under partial client participation. Fed<sup id="S5.SS2.SSS0.Px3.p4.10.5" class="ltx_sup">2</sup> also performs not so well. Our method surpasses the compared methods obviously in these cases. Furthermore, our method is more efficient, e.g., with four 10-core Intel(R) Xeon(R) Silver 4210R CPUs @ 2.40GHz and one NVIDIA GeForce RTX 3090 GPU card, FedMA needs about 4 hours for a single communication round while ours only requires several minutes.</p>
</div>
<div id="S5.SS2.SSS0.Px3.p5" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px3.p5.1" class="ltx_p"><span id="S5.SS2.SSS0.Px3.p5.1.1" class="ltx_text ltx_font_bold">IV. More Studies:</span> We study using optimal transport to fuse neural networks with PANs as done in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. We also investigate the BatchNorm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> and GroupNorm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> used in VGG or ResNet, where PANs are more applicable to BatchNorm. We finally investigate some varieties of PANs for better personalization in FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. These are provided in Supp.</p>
</div>
<figure id="S5.F12" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F12.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2203.14666/assets/x13.png" id="S5.F12.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="302" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F12.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2203.14666/assets/x14.png" id="S5.F12.2.g1" class="ltx_graphics ltx_img_square" width="461" height="377" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F12.8.2.1" class="ltx_text" style="font-size:90%;">Figure 12</span>: </span><span id="S5.F12.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Left<span id="S5.F12.4.1.1" class="ltx_text ltx_font_medium">: performance comparisons under various <math id="S5.F12.4.1.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S5.F12.4.1.1.m1.1b"><mi id="S5.F12.4.1.1.m1.1.1" xref="S5.F12.4.1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S5.F12.4.1.1.m1.1c"><ci id="S5.F12.4.1.1.m1.1.1.cmml" xref="S5.F12.4.1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F12.4.1.1.m1.1d">A</annotation></semantics></math>. </span>Right<span id="S5.F12.4.1.2" class="ltx_text ltx_font_medium">: the distributions of optimal hyper-parameters.</span></span></figcaption>
</figure>
<div id="S5.SS2.SSS0.Px3.p6" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px3.p6.1" class="ltx_p"><span id="S5.SS2.SSS0.Px3.p6.1.1" class="ltx_text ltx_font_bold">V. Disadvantages:</span> Fusing different values makes the magnitudes of neuron activations/gradients varied, which requires a customized neuron-aware optimizer. In supp, we try applying the adaptive optimizer Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> to PANs, but we do not find too much improvement. Hence, advanced optimizers should be explored in future work.</p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We propose position-aware neurons (PANs) to disable/enable the permutation invariance property of neural networks. PANs bind themselves in their positions, making parameters pre-aligned in FL even faced with non-i.i.d. data and facilitating the coordinate-based parameter averaging. PANs keep the same position encodings across clients, making local training contains consistent ingredients. Abundant experimental studies verify the role of PANs in parameter alignment. Future works are to find an optimization method specifically suitable for PANs, and extend PANs to large-scale FL benchmarks or more scenarios that require parameter alignment.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work is partially supported by National Natural Science Foundation of China (Grant No. 41901270), NSFC-NRF Joint Research Project under Grant 61861146001, and Natural Science Foundation of Jiangsu Province (Grant No. BK20190296). Thanks to Huawei Noah’s Ark Lab NetMIND Research Team and CAAI-Huawei MindSpore Open Fund (CAAIXSJLJJ-2021-014B). Thanks for Professor Yang Yang’s suggestions. Professor De-Chuan Zhan is the corresponding author.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Durmus Alp Emre Acar, Yue Zhao, Ramon Matas Navarro, Matthew Mattina, Paul N.
Whatmough, and Venkatesh Saligrama.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Federated learning based on dynamic regularization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Martial Agueh and Guillaume Carlier.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Barycenters in the wasserstein space.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">SIMA</span><span id="bib.bib2.4.2" class="ltx_text" style="font-size:90%;">, 43(2):904–924, 2011.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Rohan Anil, Gabriel Pereyra, Alexandre Passos, Róbert Ormándi,
George E. Dahl, and Geoffrey E. Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Large scale distributed neural network training through online
distillation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Sebastian Caldas, Peter Wu, Tian Li, Jakub Konecný, H. Brendan McMahan,
Virginia Smith, and Ameet Talwalkar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">LEAF: A benchmark for federated settings.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib4.4.2" class="ltx_text" style="font-size:90%;">, abs/1812.01097, 2018.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Giulia Fanti Charlie Hou, Kiran Thekumparampil and Sewoong Oh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Multistage stepsize schedule in federated learning: Bridging theory
and practice.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML Workshop</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Gregory Cohen, Saeed Afshar, Jonathan Tapson, and André van Schaik.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">EMNIST: an extension of MNIST to handwritten letters.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib6.4.2" class="ltx_text" style="font-size:90%;">, abs/1702.05373, 2017.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Luke Nicholas Darlow, Elliot J. Crowley, Antreas Antoniou, and Amos J. Storkey.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">CINIC-10 is not imagenet or CIFAR-10.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib7.4.2" class="ltx_text" style="font-size:90%;">, abs/1810.03505, 2018.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Jeffrey Dean, Greg Corrado, Rajat Monga, Kai Chen, Matthieu Devin, Quoc V. Le,
Mark Z. Mao, Marc’Aurelio Ranzato, Andrew W. Senior, Paul A. Tucker, Ke Yang,
and Andrew Y. Ng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Large scale distributed deep networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, pages 1232–1240, 2012.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Imagenet: A large-scale hierarchical image database.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, pages 248–255, 2009.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Alireza Fallah, Aryan Mokhtari, and Asuman E. Ozdaglar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Personalized federated learning with theoretical guarantees: A
model-agnostic meta-learning approach.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Jonas Gehring, Michael Auli, David Grangier, Denis Yarats, and Yann N. Dauphin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Convolutional sequence to sequence learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, pages 1243–1252, 2017.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Thomas L. Griffiths and Zoubin Ghahramani.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">The indian buffet process: An introduction and review.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">JMLR</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">, 12:1185–1224, 2011.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Chaoyang He, Songze Li, Jinhyun So, Mi Zhang, Hongyi Wang, Xiaoyang Wang,
Praneeth Vepakomma, Abhishek Singh, Hang Qiu, Li Shen, Peilin Zhao, Yan Kang,
Yang Liu, Ramesh Raskar, Qiang Yang, Murali Annavaram, and Salman Avestimehr.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Fedml: A research library and benchmark for federated machine
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib13.4.2" class="ltx_text" style="font-size:90%;">, abs/2007.13518, 2020.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, pages 770–778, 2016.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Kevin Hsieh, Amar Phanishayee, Onur Mutlu, and Phillip B. Gibbons.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">The non-iid data quagmire of decentralized machine learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">, pages 4387–4398, 2020.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Measuring the effects of non-identical data distribution for
federated visual classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib16.4.2" class="ltx_text" style="font-size:90%;">, abs/1909.06335, 2019.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Sergey Ioffe and Christian Szegedy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Batch normalization: Accelerating deep network training by reducing
internal covariate shift.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, pages 448–456, 2015.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Peter Kairouz, H. Brendan McMahan, and et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Advances and open problems in federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">, abs/1912.04977, 2019.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank J. Reddi,
Sebastian U. Stich, and Ananda Theertha Suresh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">SCAFFOLD: stochastic controlled averaging for federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, pages 5132–5143, 2020.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Diederik P. Kingma and Jimmy Ba.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Adam: A method for stochastic optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Alex Krizhevsky.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Learning multiple layers of features from tiny images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">2012.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Alex Krizhevsky, Ilya Sutskever, and Geoffrey E. Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Imagenet classification with deep convolutional neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, pages 1106–1114, 2012.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
H. W. Kuhn.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">The hungarian method for the assignment problem.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Naval Research Logistics Quarterly</span><span id="bib.bib23.4.2" class="ltx_text" style="font-size:90%;">, 2(1-2):83–97, 1955.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Fan Lai, Yinwei Dai, Xiangfeng Zhu, Harsha V. Madhyastha, and Mosharaf
Chowdhury.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Fedscale: Benchmarking model and system performance of federated
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ResilientFL Workshop</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, pages 1–3, 2021.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Y. Lecun, L. Bottou, Y. Bengio, and P. Haffner.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Gradient-based learning applied to document recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE</span><span id="bib.bib25.4.2" class="ltx_text" style="font-size:90%;">, 86(11):2278–2324, 1998.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Mu Li, Li Zhou, Zichao Yang, Aaron Li, Fei Xia, David G Andersen, and Alexander
Smola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Parameter server for distributed machine learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, volume 6, page 2, 2013.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Qinbin Li, Bingsheng He, and Dawn Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Model-contrastive federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, pages 10713–10722, 2021.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Federated optimization in heterogeneous networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">MLSys</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Xin-Chun Li and De-Chuan Zhan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Fedrs: Federated learning with restricted softmax for label
distribution non-iid data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">KDD</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, pages 995–1005, 2021.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Xin-Chun Li, De-Chuan Zhan, Yunfeng Shao, Bingshuai Li, and Shaoming Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Fedphp: Federated personalization with inherited private models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECML/PKDD</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, pages 587–602, 2021.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Tao Lin, Lingjing Kong, Sebastian U. Stich, and Martin Jaggi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Ensemble distillation for robust model fusion in federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and
Blaise Agüera y Arcas.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Communication-efficient learning of deep networks from decentralized
data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AISTATS</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, pages 1273–1282, 2017.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Vinod Nair and Geoffrey E. Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Rectified linear units improve restricted boltzmann machines.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib33.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib33.5.3" class="ltx_text" style="font-size:90%;">, pages 807–814, 2010.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Yuval Netzer, Tiejie Wang, Adam Coates, A. Bissacco, Bo Wu, and A. Ng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Reading digits in natural images with unsupervised feature learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">2011.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Sashank J. Reddi, Zachary Charles, Manzil Zaheer, Zachary Garrett, Keith Rush,
Jakub Konečný, Sanjiv Kumar, and Hugh Brendan McMahan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Adaptive federated optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib35.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib35.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Peter Shaw, Jakob Uszkoreit, and Ashish Vaswani.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Self-attention with relative position representations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib36.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NAACL-HLT</span><span id="bib.bib36.5.3" class="ltx_text" style="font-size:90%;">, pages 464–468, 2018.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Karen Simonyan and Andrew Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Very deep convolutional networks for large-scale image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib37.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib37.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Sidak Pal Singh and Martin Jaggi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Model fusion via optimal transport.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib38.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib38.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Johannes Stallkamp, Marc Schlipsing, Jan Salmen, and Christian Igel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">The german traffic sign recognition benchmark: A multi-class
classification competition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib39.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IJCNN</span><span id="bib.bib39.5.3" class="ltx_text" style="font-size:90%;">, pages 1453–1460, 2011.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Romain Thibaux and Michael I. Jordan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Hierarchical beta processes and the indian buffet process.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib40.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AIS</span><span id="bib.bib40.5.3" class="ltx_text" style="font-size:90%;">, pages 564–571, 2007.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Attention is all you need.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib41.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib41.5.3" class="ltx_text" style="font-size:90%;">, pages 5998–6008, 2017.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Benyou Wang, Lifeng Shang, Christina Lioma, Xin Jiang, Hao Yang, Qun Liu, and
Jakob Grue Simonsen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">On position embeddings in BERT.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib42.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib42.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Hongyi Wang, Mikhail Yurochkin, Yuekai Sun, Dimitris S. Papailiopoulos, and
Yasaman Khazaeni.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Federated learning with matched averaging.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib43.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib43.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Yu-An Wang and Yun-Nung Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">What do position embeddings learn? an empirical study of pre-trained
language model positional encoding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib44.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">EMNLP</span><span id="bib.bib44.5.3" class="ltx_text" style="font-size:90%;">, pages 6840–6849, 2020.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
Yuxin Wu and Kaiming He.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Group normalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IJCV</span><span id="bib.bib45.4.2" class="ltx_text" style="font-size:90%;">, 128(3):742–755, 2020.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Rui Xu, Xintao Wang, Kai Chen, Bolei Zhou, and Chen Change Loy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">Positional encoding as spatial inductive bias in gans.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib46.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib46.5.3" class="ltx_text" style="font-size:90%;">, pages 13569–13578, 2021.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text" style="font-size:90%;">
Qiang Yang, Yang Liu, Tianjian Chen, and Yongxin Tong.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.2.1" class="ltx_text" style="font-size:90%;">Federated machine learning: Concept and applications.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM TIST</span><span id="bib.bib47.4.2" class="ltx_text" style="font-size:90%;">, 10(2):12:1–12:19, 2019.
</span>
</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text" style="font-size:90%;">
Fuxun Yu, Weishan Zhang, Zhuwei Qin, Zirui Xu, Di Wang, Chenchen Liu, Zhi Tian,
and Xiang Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.2.1" class="ltx_text" style="font-size:90%;">Fed2: Feature-aligned federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib48.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">KDD</span><span id="bib.bib48.5.3" class="ltx_text" style="font-size:90%;">, pages 2066–2074, 2021.
</span>
</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text" style="font-size:90%;">
Mikhail Yurochkin, Mayank Agarwal, Soumya Ghosh, Kristjan H. Greenewald, and
Trong Nghia Hoang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.2.1" class="ltx_text" style="font-size:90%;">Statistical model aggregation via parameter matching.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib49.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib49.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NeurIPS</span><span id="bib.bib49.5.3" class="ltx_text" style="font-size:90%;">, pages 10954–10964, 2019.
</span>
</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text" style="font-size:90%;">
Mikhail Yurochkin, Mayank Agarwal, Soumya Ghosh, Kristjan H. Greenewald,
Trong Nghia Hoang, and Yasaman Khazaeni.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.2.1" class="ltx_text" style="font-size:90%;">Bayesian nonparametric federated learning of neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib50.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib50.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib50.5.3" class="ltx_text" style="font-size:90%;">, pages 7252–7261, 2019.
</span>
</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text" style="font-size:90%;">
Manzil Zaheer, Sashank J. Reddi, Devendra Singh Sachan, Satyen Kale, and Sanjiv
Kumar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.2.1" class="ltx_text" style="font-size:90%;">Adaptive methods for nonconvex optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib51.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib51.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib51.5.3" class="ltx_text" style="font-size:90%;">, pages 9815–9825, 2018.
</span>
</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock"><span id="bib.bib52.1.1" class="ltx_text" style="font-size:90%;">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.2.1" class="ltx_text" style="font-size:90%;">Federated learning with non-iid data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib52.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib52.4.2" class="ltx_text" style="font-size:90%;">, abs/1806.00582, 2018.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Dataset Details</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">The utilized datasets include Mnist <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, FeMnist <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, SVHN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, GTSRB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, Cifar10/100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, and Cinic10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. We detail these datasets as follows.</p>
<ul id="A1.I1" class="ltx_itemize">
<li id="A1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i1.p1" class="ltx_para">
<p id="A1.I1.i1.p1.1" class="ltx_p"><span id="A1.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Mnist</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> is a digit recognition dataset that contains 10 digits to classify. The raw set contains 60,000 samples for training and 10,000 samples for evaluation. The image size is <math id="A1.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="28\times 28" display="inline"><semantics id="A1.I1.i1.p1.1.m1.1a"><mrow id="A1.I1.i1.p1.1.m1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.cmml"><mn id="A1.I1.i1.p1.1.m1.1.1.2" xref="A1.I1.i1.p1.1.m1.1.1.2.cmml">28</mn><mo lspace="0.222em" rspace="0.222em" id="A1.I1.i1.p1.1.m1.1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.1.cmml">×</mo><mn id="A1.I1.i1.p1.1.m1.1.1.3" xref="A1.I1.i1.p1.1.m1.1.1.3.cmml">28</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.1b"><apply id="A1.I1.i1.p1.1.m1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1"><times id="A1.I1.i1.p1.1.m1.1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1.1"></times><cn type="integer" id="A1.I1.i1.p1.1.m1.1.1.2.cmml" xref="A1.I1.i1.p1.1.m1.1.1.2">28</cn><cn type="integer" id="A1.I1.i1.p1.1.m1.1.1.3.cmml" xref="A1.I1.i1.p1.1.m1.1.1.3">28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.1c">28\times 28</annotation></semantics></math>.</p>
</div>
</li>
<li id="A1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i2.p1" class="ltx_para">
<p id="A1.I1.i2.p1.1" class="ltx_p"><span id="A1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">SVHN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> is the Street View House Number dataset which contains 10 numbers to classify. The raw set contains 73,257 samples for training and 26,032 samples for evaluation. The image size is <math id="A1.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="32\times 32" display="inline"><semantics id="A1.I1.i2.p1.1.m1.1a"><mrow id="A1.I1.i2.p1.1.m1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.cmml"><mn id="A1.I1.i2.p1.1.m1.1.1.2" xref="A1.I1.i2.p1.1.m1.1.1.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="A1.I1.i2.p1.1.m1.1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.1.cmml">×</mo><mn id="A1.I1.i2.p1.1.m1.1.1.3" xref="A1.I1.i2.p1.1.m1.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.1.m1.1b"><apply id="A1.I1.i2.p1.1.m1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1"><times id="A1.I1.i2.p1.1.m1.1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1.1"></times><cn type="integer" id="A1.I1.i2.p1.1.m1.1.1.2.cmml" xref="A1.I1.i2.p1.1.m1.1.1.2">32</cn><cn type="integer" id="A1.I1.i2.p1.1.m1.1.1.3.cmml" xref="A1.I1.i2.p1.1.m1.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.1.m1.1c">32\times 32</annotation></semantics></math>.</p>
</div>
</li>
<li id="A1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i3.p1" class="ltx_para">
<p id="A1.I1.i3.p1.1" class="ltx_p"><span id="A1.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">GTSRB</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> is the German Traffic Recognition Benchmark with 43 traffic signs. The raw set contains 39,209 samples for training and 12,630 samples for evaluation. We resize the images to <math id="A1.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="32\times 32" display="inline"><semantics id="A1.I1.i3.p1.1.m1.1a"><mrow id="A1.I1.i3.p1.1.m1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.cmml"><mn id="A1.I1.i3.p1.1.m1.1.1.2" xref="A1.I1.i3.p1.1.m1.1.1.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="A1.I1.i3.p1.1.m1.1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.1.cmml">×</mo><mn id="A1.I1.i3.p1.1.m1.1.1.3" xref="A1.I1.i3.p1.1.m1.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.1.m1.1b"><apply id="A1.I1.i3.p1.1.m1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1"><times id="A1.I1.i3.p1.1.m1.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1.1"></times><cn type="integer" id="A1.I1.i3.p1.1.m1.1.1.2.cmml" xref="A1.I1.i3.p1.1.m1.1.1.2">32</cn><cn type="integer" id="A1.I1.i3.p1.1.m1.1.1.3.cmml" xref="A1.I1.i3.p1.1.m1.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.1.m1.1c">32\times 32</annotation></semantics></math>.</p>
</div>
</li>
<li id="A1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i4.p1" class="ltx_para">
<p id="A1.I1.i4.p1.1" class="ltx_p"><span id="A1.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">Cifar10</span> and <span id="A1.I1.i4.p1.1.2" class="ltx_text ltx_font_bold">Cifar100</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> are subsets of the Tiny Images dataset and respectively have 10/100 classes to classify. They consist of 50,000 training images and 10,000 test images. The image size is <math id="A1.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="32\times 32" display="inline"><semantics id="A1.I1.i4.p1.1.m1.1a"><mrow id="A1.I1.i4.p1.1.m1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.cmml"><mn id="A1.I1.i4.p1.1.m1.1.1.2" xref="A1.I1.i4.p1.1.m1.1.1.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="A1.I1.i4.p1.1.m1.1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.1.cmml">×</mo><mn id="A1.I1.i4.p1.1.m1.1.1.3" xref="A1.I1.i4.p1.1.m1.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.1.m1.1b"><apply id="A1.I1.i4.p1.1.m1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1"><times id="A1.I1.i4.p1.1.m1.1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1.1"></times><cn type="integer" id="A1.I1.i4.p1.1.m1.1.1.2.cmml" xref="A1.I1.i4.p1.1.m1.1.1.2">32</cn><cn type="integer" id="A1.I1.i4.p1.1.m1.1.1.3.cmml" xref="A1.I1.i4.p1.1.m1.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.1.m1.1c">32\times 32</annotation></semantics></math>.</p>
</div>
</li>
<li id="A1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i5.p1" class="ltx_para">
<p id="A1.I1.i5.p1.1" class="ltx_p"><span id="A1.I1.i5.p1.1.1" class="ltx_text ltx_font_bold">Cinic10</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> is a combination of Cifar10 and ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, which contains 10 classes. It contains 90,000 samples for training, validation, and test, respectively. We do not use the validation set. The image size is <math id="A1.I1.i5.p1.1.m1.1" class="ltx_Math" alttext="32\times 32" display="inline"><semantics id="A1.I1.i5.p1.1.m1.1a"><mrow id="A1.I1.i5.p1.1.m1.1.1" xref="A1.I1.i5.p1.1.m1.1.1.cmml"><mn id="A1.I1.i5.p1.1.m1.1.1.2" xref="A1.I1.i5.p1.1.m1.1.1.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="A1.I1.i5.p1.1.m1.1.1.1" xref="A1.I1.i5.p1.1.m1.1.1.1.cmml">×</mo><mn id="A1.I1.i5.p1.1.m1.1.1.3" xref="A1.I1.i5.p1.1.m1.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.1.m1.1b"><apply id="A1.I1.i5.p1.1.m1.1.1.cmml" xref="A1.I1.i5.p1.1.m1.1.1"><times id="A1.I1.i5.p1.1.m1.1.1.1.cmml" xref="A1.I1.i5.p1.1.m1.1.1.1"></times><cn type="integer" id="A1.I1.i5.p1.1.m1.1.1.2.cmml" xref="A1.I1.i5.p1.1.m1.1.1.2">32</cn><cn type="integer" id="A1.I1.i5.p1.1.m1.1.1.3.cmml" xref="A1.I1.i5.p1.1.m1.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.1.m1.1c">32\times 32</annotation></semantics></math>.</p>
</div>
</li>
<li id="A1.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i6.p1" class="ltx_para">
<p id="A1.I1.i6.p1.3" class="ltx_p"><span id="A1.I1.i6.p1.3.1" class="ltx_text ltx_font_bold">FeMnist</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> is built by partitioning the data in Extended MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> based on the writer of the digit/character. There are 62 digits and characters in all. The total number of training samples is 805,263. There are 3,550 users, and each user owns 226.8 samples on average. We only use <math id="A1.I1.i6.p1.1.m1.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="A1.I1.i6.p1.1.m1.1a"><mrow id="A1.I1.i6.p1.1.m1.1.1" xref="A1.I1.i6.p1.1.m1.1.1.cmml"><mn id="A1.I1.i6.p1.1.m1.1.1.2" xref="A1.I1.i6.p1.1.m1.1.1.2.cmml">10</mn><mo id="A1.I1.i6.p1.1.m1.1.1.1" xref="A1.I1.i6.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i6.p1.1.m1.1b"><apply id="A1.I1.i6.p1.1.m1.1.1.cmml" xref="A1.I1.i6.p1.1.m1.1.1"><csymbol cd="latexml" id="A1.I1.i6.p1.1.m1.1.1.1.cmml" xref="A1.I1.i6.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="A1.I1.i6.p1.1.m1.1.1.2.cmml" xref="A1.I1.i6.p1.1.m1.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i6.p1.1.m1.1c">10\%</annotation></semantics></math> users (i.e., 355 users). For each user, we take <math id="A1.I1.i6.p1.2.m2.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="A1.I1.i6.p1.2.m2.1a"><mrow id="A1.I1.i6.p1.2.m2.1.1" xref="A1.I1.i6.p1.2.m2.1.1.cmml"><mn id="A1.I1.i6.p1.2.m2.1.1.2" xref="A1.I1.i6.p1.2.m2.1.1.2.cmml">20</mn><mo id="A1.I1.i6.p1.2.m2.1.1.1" xref="A1.I1.i6.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i6.p1.2.m2.1b"><apply id="A1.I1.i6.p1.2.m2.1.1.cmml" xref="A1.I1.i6.p1.2.m2.1.1"><csymbol cd="latexml" id="A1.I1.i6.p1.2.m2.1.1.1.cmml" xref="A1.I1.i6.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="A1.I1.i6.p1.2.m2.1.1.2.cmml" xref="A1.I1.i6.p1.2.m2.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i6.p1.2.m2.1c">20\%</annotation></semantics></math> of the samples to construct the global test set. We resize the images to <math id="A1.I1.i6.p1.3.m3.1" class="ltx_Math" alttext="28\times 28" display="inline"><semantics id="A1.I1.i6.p1.3.m3.1a"><mrow id="A1.I1.i6.p1.3.m3.1.1" xref="A1.I1.i6.p1.3.m3.1.1.cmml"><mn id="A1.I1.i6.p1.3.m3.1.1.2" xref="A1.I1.i6.p1.3.m3.1.1.2.cmml">28</mn><mo lspace="0.222em" rspace="0.222em" id="A1.I1.i6.p1.3.m3.1.1.1" xref="A1.I1.i6.p1.3.m3.1.1.1.cmml">×</mo><mn id="A1.I1.i6.p1.3.m3.1.1.3" xref="A1.I1.i6.p1.3.m3.1.1.3.cmml">28</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i6.p1.3.m3.1b"><apply id="A1.I1.i6.p1.3.m3.1.1.cmml" xref="A1.I1.i6.p1.3.m3.1.1"><times id="A1.I1.i6.p1.3.m3.1.1.1.cmml" xref="A1.I1.i6.p1.3.m3.1.1.1"></times><cn type="integer" id="A1.I1.i6.p1.3.m3.1.1.2.cmml" xref="A1.I1.i6.p1.3.m3.1.1.2">28</cn><cn type="integer" id="A1.I1.i6.p1.3.m3.1.1.3.cmml" xref="A1.I1.i6.p1.3.m3.1.1.3">28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i6.p1.3.m3.1c">28\times 28</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.2" class="ltx_p">For centralized training, we correspondingly use the training set and test set for the first six datasets. For FeMnist, we centralize users’ training samples as the training set. For decentralized training (i.e., FL), we split the training set of the first six datasets according to Dirichlet distributions as done in previous FL works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. Specifically, we split the training set onto <math id="A1.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A1.p2.1.m1.1a"><mi id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><ci id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">K</annotation></semantics></math> clients and each client’s label distribution is generated from <math id="A1.p2.2.m2.1" class="ltx_Math" alttext="\text{Dirichlet}(\alpha)" display="inline"><semantics id="A1.p2.2.m2.1a"><mrow id="A1.p2.2.m2.1.2" xref="A1.p2.2.m2.1.2.cmml"><mtext id="A1.p2.2.m2.1.2.2" xref="A1.p2.2.m2.1.2.2a.cmml">Dirichlet</mtext><mo lspace="0em" rspace="0em" id="A1.p2.2.m2.1.2.1" xref="A1.p2.2.m2.1.2.1.cmml">​</mo><mrow id="A1.p2.2.m2.1.2.3.2" xref="A1.p2.2.m2.1.2.cmml"><mo stretchy="false" id="A1.p2.2.m2.1.2.3.2.1" xref="A1.p2.2.m2.1.2.cmml">(</mo><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">α</mi><mo stretchy="false" id="A1.p2.2.m2.1.2.3.2.2" xref="A1.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><apply id="A1.p2.2.m2.1.2.cmml" xref="A1.p2.2.m2.1.2"><times id="A1.p2.2.m2.1.2.1.cmml" xref="A1.p2.2.m2.1.2.1"></times><ci id="A1.p2.2.m2.1.2.2a.cmml" xref="A1.p2.2.m2.1.2.2"><mtext id="A1.p2.2.m2.1.2.2.cmml" xref="A1.p2.2.m2.1.2.2">Dirichlet</mtext></ci><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">\text{Dirichlet}(\alpha)</annotation></semantics></math>. While for FeMnist, we directly take the 355 users as clients. Some of these datasets are utilized in previous FL works. For example, Cifar10/Cifar100/Cinic10 are recommended by FedML <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, and FeMnist is recommended by LEAF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
<figure id="A1.F13" class="ltx_figure"><img src="/html/2203.14666/assets/x15.png" id="A1.F13.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="246" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A1.F13.2.1.1" class="ltx_text" style="font-size:90%;">Figure 13</span>: </span><span id="A1.F13.3.2" class="ltx_text" style="font-size:90%;">Network architectures with PANs. “PE” denotes position encoding; “SC” denotes shortcut. For ResNet, we only show one convolution layer in the basic block and omit the BatchNorm layers for simplification.</span></figcaption>
</figure>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Shuffle Process</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.3" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  Input: parameters <math id="alg1.l1.m1.2" class="ltx_Math" alttext="\{W_{l},b_{l}\}_{l=1}^{L}" display="inline"><semantics id="alg1.l1.m1.2a"><msubsup id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml"><mrow id="alg1.l1.m1.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l1.m1.2.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.3.cmml">{</mo><msub id="alg1.l1.m1.1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.1.1.2.cmml">W</mi><mi id="alg1.l1.m1.1.1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="alg1.l1.m1.2.2.2.2.2.4" xref="alg1.l1.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l1.m1.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l1.m1.2.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.2.cmml">b</mi><mi id="alg1.l1.m1.2.2.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="alg1.l1.m1.2.2.2.2.2.5" xref="alg1.l1.m1.2.2.2.2.3.cmml">}</mo></mrow><mrow id="alg1.l1.m1.2.2.2.4" xref="alg1.l1.m1.2.2.2.4.cmml"><mi id="alg1.l1.m1.2.2.2.4.2" xref="alg1.l1.m1.2.2.2.4.2.cmml">l</mi><mo id="alg1.l1.m1.2.2.2.4.1" xref="alg1.l1.m1.2.2.2.4.1.cmml">=</mo><mn id="alg1.l1.m1.2.2.2.4.3" xref="alg1.l1.m1.2.2.2.4.3.cmml">1</mn></mrow><mi id="alg1.l1.m1.2.2.4" xref="alg1.l1.m1.2.2.4.cmml">L</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.2b"><apply id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.3.cmml" xref="alg1.l1.m1.2.2">superscript</csymbol><apply id="alg1.l1.m1.2.2.2.cmml" xref="alg1.l1.m1.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.3.cmml" xref="alg1.l1.m1.2.2">subscript</csymbol><set id="alg1.l1.m1.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.2"><apply id="alg1.l1.m1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.2">𝑊</ci><ci id="alg1.l1.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="alg1.l1.m1.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l1.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2">𝑏</ci><ci id="alg1.l1.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.3">𝑙</ci></apply></set><apply id="alg1.l1.m1.2.2.2.4.cmml" xref="alg1.l1.m1.2.2.2.4"><eq id="alg1.l1.m1.2.2.2.4.1.cmml" xref="alg1.l1.m1.2.2.2.4.1"></eq><ci id="alg1.l1.m1.2.2.2.4.2.cmml" xref="alg1.l1.m1.2.2.2.4.2">𝑙</ci><cn type="integer" id="alg1.l1.m1.2.2.2.4.3.cmml" xref="alg1.l1.m1.2.2.2.4.3">1</cn></apply></apply><ci id="alg1.l1.m1.2.2.4.cmml" xref="alg1.l1.m1.2.2.4">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.2c">\{W_{l},b_{l}\}_{l=1}^{L}</annotation></semantics></math>; shuffle probability <math id="alg1.l1.m2.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="alg1.l1.m2.1a"><msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">P</mi><mtext id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝑃</ci><ci id="alg1.l1.m2.1.1.3a.cmml" xref="alg1.l1.m2.1.1.3"><mtext mathsize="70%" id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">P_{\text{sf}}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  Generate-Permutation-Matrix: <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\{\Pi_{l}\}_{l=1}^{L-1}" display="inline"><semantics id="alg1.l2.m1.1a"><msubsup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mrow id="alg1.l2.m1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l2.m1.1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.2.cmml">{</mo><msub id="alg1.l2.m1.1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l2.m1.1.1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.1.1.2.cmml">Π</mi><mi id="alg1.l2.m1.1.1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="alg1.l2.m1.1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l2.m1.1.1.1.3" xref="alg1.l2.m1.1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.1.3.2" xref="alg1.l2.m1.1.1.1.3.2.cmml">l</mi><mo id="alg1.l2.m1.1.1.1.3.1" xref="alg1.l2.m1.1.1.1.3.1.cmml">=</mo><mn id="alg1.l2.m1.1.1.1.3.3" xref="alg1.l2.m1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">L</mi><mo id="alg1.l2.m1.1.1.3.1" xref="alg1.l2.m1.1.1.3.1.cmml">−</mo><mn id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><apply id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><set id="alg1.l2.m1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.1"><apply id="alg1.l2.m1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.2">Π</ci><ci id="alg1.l2.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.3">𝑙</ci></apply></set><apply id="alg1.l2.m1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.3"><eq id="alg1.l2.m1.1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.1.3.1"></eq><ci id="alg1.l2.m1.1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.1.3.2">𝑙</ci><cn type="integer" id="alg1.l2.m1.1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><minus id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.1"></minus><ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">𝐿</ci><cn type="integer" id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\{\Pi_{l}\}_{l=1}^{L-1}</annotation></semantics></math>, <math id="alg1.l2.m2.2" class="ltx_Math" alttext="\Pi_{\{0,L\}}=I" display="inline"><semantics id="alg1.l2.m2.2a"><mrow id="alg1.l2.m2.2.3" xref="alg1.l2.m2.2.3.cmml"><msub id="alg1.l2.m2.2.3.2" xref="alg1.l2.m2.2.3.2.cmml"><mi mathvariant="normal" id="alg1.l2.m2.2.3.2.2" xref="alg1.l2.m2.2.3.2.2.cmml">Π</mi><mrow id="alg1.l2.m2.2.2.2.4" xref="alg1.l2.m2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l2.m2.2.2.2.4.1" xref="alg1.l2.m2.2.2.2.3.cmml">{</mo><mn id="alg1.l2.m2.1.1.1.1" xref="alg1.l2.m2.1.1.1.1.cmml">0</mn><mo id="alg1.l2.m2.2.2.2.4.2" xref="alg1.l2.m2.2.2.2.3.cmml">,</mo><mi id="alg1.l2.m2.2.2.2.2" xref="alg1.l2.m2.2.2.2.2.cmml">L</mi><mo stretchy="false" id="alg1.l2.m2.2.2.2.4.3" xref="alg1.l2.m2.2.2.2.3.cmml">}</mo></mrow></msub><mo id="alg1.l2.m2.2.3.1" xref="alg1.l2.m2.2.3.1.cmml">=</mo><mi id="alg1.l2.m2.2.3.3" xref="alg1.l2.m2.2.3.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.2b"><apply id="alg1.l2.m2.2.3.cmml" xref="alg1.l2.m2.2.3"><eq id="alg1.l2.m2.2.3.1.cmml" xref="alg1.l2.m2.2.3.1"></eq><apply id="alg1.l2.m2.2.3.2.cmml" xref="alg1.l2.m2.2.3.2"><csymbol cd="ambiguous" id="alg1.l2.m2.2.3.2.1.cmml" xref="alg1.l2.m2.2.3.2">subscript</csymbol><ci id="alg1.l2.m2.2.3.2.2.cmml" xref="alg1.l2.m2.2.3.2.2">Π</ci><set id="alg1.l2.m2.2.2.2.3.cmml" xref="alg1.l2.m2.2.2.2.4"><cn type="integer" id="alg1.l2.m2.1.1.1.1.cmml" xref="alg1.l2.m2.1.1.1.1">0</cn><ci id="alg1.l2.m2.2.2.2.2.cmml" xref="alg1.l2.m2.2.2.2.2">𝐿</ci></set></apply><ci id="alg1.l2.m2.2.3.3.cmml" xref="alg1.l2.m2.2.3.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.2c">\Pi_{\{0,L\}}=I</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span> each layer <math id="alg1.l3.m1.4" class="ltx_Math" alttext="l=1,2,\ldots,L" display="inline"><semantics id="alg1.l3.m1.4a"><mrow id="alg1.l3.m1.4.5" xref="alg1.l3.m1.4.5.cmml"><mi id="alg1.l3.m1.4.5.2" xref="alg1.l3.m1.4.5.2.cmml">l</mi><mo id="alg1.l3.m1.4.5.1" xref="alg1.l3.m1.4.5.1.cmml">=</mo><mrow id="alg1.l3.m1.4.5.3.2" xref="alg1.l3.m1.4.5.3.1.cmml"><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.4.5.3.2.1" xref="alg1.l3.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">2</mn><mo id="alg1.l3.m1.4.5.3.2.2" xref="alg1.l3.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">…</mi><mo id="alg1.l3.m1.4.5.3.2.3" xref="alg1.l3.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l3.m1.4.4" xref="alg1.l3.m1.4.4.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.4b"><apply id="alg1.l3.m1.4.5.cmml" xref="alg1.l3.m1.4.5"><eq id="alg1.l3.m1.4.5.1.cmml" xref="alg1.l3.m1.4.5.1"></eq><ci id="alg1.l3.m1.4.5.2.cmml" xref="alg1.l3.m1.4.5.2">𝑙</ci><list id="alg1.l3.m1.4.5.3.1.cmml" xref="alg1.l3.m1.4.5.3.2"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><cn type="integer" id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">2</cn><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">…</ci><ci id="alg1.l3.m1.4.4.cmml" xref="alg1.l3.m1.4.4">𝐿</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.4c">l=1,2,\ldots,L</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <math id="alg1.l4.m1.1" class="ltx_Math" alttext="W_{l}\leftarrow\Pi_{l}W_{l}\Pi_{l-1}^{T}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">W</mi><mi id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml">l</mi></msub><mo stretchy="false" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">←</mo><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><msub id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml"><mi mathvariant="normal" id="alg1.l4.m1.1.1.3.2.2" xref="alg1.l4.m1.1.1.3.2.2.cmml">Π</mi><mi id="alg1.l4.m1.1.1.3.2.3" xref="alg1.l4.m1.1.1.3.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">​</mo><msub id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml"><mi id="alg1.l4.m1.1.1.3.3.2" xref="alg1.l4.m1.1.1.3.3.2.cmml">W</mi><mi id="alg1.l4.m1.1.1.3.3.3" xref="alg1.l4.m1.1.1.3.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1a" xref="alg1.l4.m1.1.1.3.1.cmml">​</mo><msubsup id="alg1.l4.m1.1.1.3.4" xref="alg1.l4.m1.1.1.3.4.cmml"><mi mathvariant="normal" id="alg1.l4.m1.1.1.3.4.2.2" xref="alg1.l4.m1.1.1.3.4.2.2.cmml">Π</mi><mrow id="alg1.l4.m1.1.1.3.4.2.3" xref="alg1.l4.m1.1.1.3.4.2.3.cmml"><mi id="alg1.l4.m1.1.1.3.4.2.3.2" xref="alg1.l4.m1.1.1.3.4.2.3.2.cmml">l</mi><mo id="alg1.l4.m1.1.1.3.4.2.3.1" xref="alg1.l4.m1.1.1.3.4.2.3.1.cmml">−</mo><mn id="alg1.l4.m1.1.1.3.4.2.3.3" xref="alg1.l4.m1.1.1.3.4.2.3.3.cmml">1</mn></mrow><mi id="alg1.l4.m1.1.1.3.4.3" xref="alg1.l4.m1.1.1.3.4.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">←</ci><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">𝑊</ci><ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">𝑙</ci></apply><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><times id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></times><apply id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.2.1.cmml" xref="alg1.l4.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.2.2.cmml" xref="alg1.l4.m1.1.1.3.2.2">Π</ci><ci id="alg1.l4.m1.1.1.3.2.3.cmml" xref="alg1.l4.m1.1.1.3.2.3">𝑙</ci></apply><apply id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.3.1.cmml" xref="alg1.l4.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.3.2.cmml" xref="alg1.l4.m1.1.1.3.3.2">𝑊</ci><ci id="alg1.l4.m1.1.1.3.3.3.cmml" xref="alg1.l4.m1.1.1.3.3.3">𝑙</ci></apply><apply id="alg1.l4.m1.1.1.3.4.cmml" xref="alg1.l4.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.4.1.cmml" xref="alg1.l4.m1.1.1.3.4">superscript</csymbol><apply id="alg1.l4.m1.1.1.3.4.2.cmml" xref="alg1.l4.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.4.2.1.cmml" xref="alg1.l4.m1.1.1.3.4">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.4.2.2.cmml" xref="alg1.l4.m1.1.1.3.4.2.2">Π</ci><apply id="alg1.l4.m1.1.1.3.4.2.3.cmml" xref="alg1.l4.m1.1.1.3.4.2.3"><minus id="alg1.l4.m1.1.1.3.4.2.3.1.cmml" xref="alg1.l4.m1.1.1.3.4.2.3.1"></minus><ci id="alg1.l4.m1.1.1.3.4.2.3.2.cmml" xref="alg1.l4.m1.1.1.3.4.2.3.2">𝑙</ci><cn type="integer" id="alg1.l4.m1.1.1.3.4.2.3.3.cmml" xref="alg1.l4.m1.1.1.3.4.2.3.3">1</cn></apply></apply><ci id="alg1.l4.m1.1.1.3.4.3.cmml" xref="alg1.l4.m1.1.1.3.4.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">W_{l}\leftarrow\Pi_{l}W_{l}\Pi_{l-1}^{T}</annotation></semantics></math>, <math id="alg1.l4.m2.1" class="ltx_Math" alttext="b_{l}\leftarrow\Pi_{l}b_{l}" display="inline"><semantics id="alg1.l4.m2.1a"><mrow id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><msub id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml"><mi id="alg1.l4.m2.1.1.2.2" xref="alg1.l4.m2.1.1.2.2.cmml">b</mi><mi id="alg1.l4.m2.1.1.2.3" xref="alg1.l4.m2.1.1.2.3.cmml">l</mi></msub><mo stretchy="false" id="alg1.l4.m2.1.1.1" xref="alg1.l4.m2.1.1.1.cmml">←</mo><mrow id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml"><msub id="alg1.l4.m2.1.1.3.2" xref="alg1.l4.m2.1.1.3.2.cmml"><mi mathvariant="normal" id="alg1.l4.m2.1.1.3.2.2" xref="alg1.l4.m2.1.1.3.2.2.cmml">Π</mi><mi id="alg1.l4.m2.1.1.3.2.3" xref="alg1.l4.m2.1.1.3.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l4.m2.1.1.3.1" xref="alg1.l4.m2.1.1.3.1.cmml">​</mo><msub id="alg1.l4.m2.1.1.3.3" xref="alg1.l4.m2.1.1.3.3.cmml"><mi id="alg1.l4.m2.1.1.3.3.2" xref="alg1.l4.m2.1.1.3.3.2.cmml">b</mi><mi id="alg1.l4.m2.1.1.3.3.3" xref="alg1.l4.m2.1.1.3.3.3.cmml">l</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><ci id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1.1">←</ci><apply id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.2.1.cmml" xref="alg1.l4.m2.1.1.2">subscript</csymbol><ci id="alg1.l4.m2.1.1.2.2.cmml" xref="alg1.l4.m2.1.1.2.2">𝑏</ci><ci id="alg1.l4.m2.1.1.2.3.cmml" xref="alg1.l4.m2.1.1.2.3">𝑙</ci></apply><apply id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3"><times id="alg1.l4.m2.1.1.3.1.cmml" xref="alg1.l4.m2.1.1.3.1"></times><apply id="alg1.l4.m2.1.1.3.2.cmml" xref="alg1.l4.m2.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.3.2.1.cmml" xref="alg1.l4.m2.1.1.3.2">subscript</csymbol><ci id="alg1.l4.m2.1.1.3.2.2.cmml" xref="alg1.l4.m2.1.1.3.2.2">Π</ci><ci id="alg1.l4.m2.1.1.3.2.3.cmml" xref="alg1.l4.m2.1.1.3.2.3">𝑙</ci></apply><apply id="alg1.l4.m2.1.1.3.3.cmml" xref="alg1.l4.m2.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.3.3.1.cmml" xref="alg1.l4.m2.1.1.3.3">subscript</csymbol><ci id="alg1.l4.m2.1.1.3.3.2.cmml" xref="alg1.l4.m2.1.1.3.3.2">𝑏</ci><ci id="alg1.l4.m2.1.1.3.3.3.cmml" xref="alg1.l4.m2.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">b_{l}\leftarrow\Pi_{l}b_{l}</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>  <span id="alg1.l5.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.4" class="ltx_p ltx_figure_panel"><span id="alg1.4.1" class="ltx_text ltx_font_bold">Generate-Permutation-Matrix</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.5" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1a.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  Input: number of neurons <math id="alg1.l1a.m1.1" class="ltx_Math" alttext="J" display="inline"><semantics id="alg1.l1a.m1.1a"><mi id="alg1.l1a.m1.1.1" xref="alg1.l1a.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="alg1.l1a.m1.1b"><ci id="alg1.l1a.m1.1.1.cmml" xref="alg1.l1a.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1a.m1.1c">J</annotation></semantics></math>; shuffle probability <math id="alg1.l1a.m2.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="alg1.l1a.m2.1a"><msub id="alg1.l1a.m2.1.1" xref="alg1.l1a.m2.1.1.cmml"><mi id="alg1.l1a.m2.1.1.2" xref="alg1.l1a.m2.1.1.2.cmml">P</mi><mtext id="alg1.l1a.m2.1.1.3" xref="alg1.l1a.m2.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l1a.m2.1b"><apply id="alg1.l1a.m2.1.1.cmml" xref="alg1.l1a.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1a.m2.1.1.1.cmml" xref="alg1.l1a.m2.1.1">subscript</csymbol><ci id="alg1.l1a.m2.1.1.2.cmml" xref="alg1.l1a.m2.1.1.2">𝑃</ci><ci id="alg1.l1a.m2.1.1.3a.cmml" xref="alg1.l1a.m2.1.1.3"><mtext mathsize="70%" id="alg1.l1a.m2.1.1.3.cmml" xref="alg1.l1a.m2.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1a.m2.1c">P_{\text{sf}}</annotation></semantics></math>

</div>
<div id="alg1.l2a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2a.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  Initialize: <math id="alg1.l2a.m1.1" class="ltx_Math" alttext="\Pi=I^{J\times J}" display="inline"><semantics id="alg1.l2a.m1.1a"><mrow id="alg1.l2a.m1.1.1" xref="alg1.l2a.m1.1.1.cmml"><mi mathvariant="normal" id="alg1.l2a.m1.1.1.2" xref="alg1.l2a.m1.1.1.2.cmml">Π</mi><mo id="alg1.l2a.m1.1.1.1" xref="alg1.l2a.m1.1.1.1.cmml">=</mo><msup id="alg1.l2a.m1.1.1.3" xref="alg1.l2a.m1.1.1.3.cmml"><mi id="alg1.l2a.m1.1.1.3.2" xref="alg1.l2a.m1.1.1.3.2.cmml">I</mi><mrow id="alg1.l2a.m1.1.1.3.3" xref="alg1.l2a.m1.1.1.3.3.cmml"><mi id="alg1.l2a.m1.1.1.3.3.2" xref="alg1.l2a.m1.1.1.3.3.2.cmml">J</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l2a.m1.1.1.3.3.1" xref="alg1.l2a.m1.1.1.3.3.1.cmml">×</mo><mi id="alg1.l2a.m1.1.1.3.3.3" xref="alg1.l2a.m1.1.1.3.3.3.cmml">J</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2a.m1.1b"><apply id="alg1.l2a.m1.1.1.cmml" xref="alg1.l2a.m1.1.1"><eq id="alg1.l2a.m1.1.1.1.cmml" xref="alg1.l2a.m1.1.1.1"></eq><ci id="alg1.l2a.m1.1.1.2.cmml" xref="alg1.l2a.m1.1.1.2">Π</ci><apply id="alg1.l2a.m1.1.1.3.cmml" xref="alg1.l2a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l2a.m1.1.1.3.1.cmml" xref="alg1.l2a.m1.1.1.3">superscript</csymbol><ci id="alg1.l2a.m1.1.1.3.2.cmml" xref="alg1.l2a.m1.1.1.3.2">𝐼</ci><apply id="alg1.l2a.m1.1.1.3.3.cmml" xref="alg1.l2a.m1.1.1.3.3"><times id="alg1.l2a.m1.1.1.3.3.1.cmml" xref="alg1.l2a.m1.1.1.3.3.1"></times><ci id="alg1.l2a.m1.1.1.3.3.2.cmml" xref="alg1.l2a.m1.1.1.3.3.2">𝐽</ci><ci id="alg1.l2a.m1.1.1.3.3.3.cmml" xref="alg1.l2a.m1.1.1.3.3.3">𝐽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2a.m1.1c">\Pi=I^{J\times J}</annotation></semantics></math>

</div>
<div id="alg1.l3a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3a.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  <span id="alg1.l3a.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3a.m1.4" class="ltx_Math" alttext="j=1,2,\ldots,J" display="inline"><semantics id="alg1.l3a.m1.4a"><mrow id="alg1.l3a.m1.4.5" xref="alg1.l3a.m1.4.5.cmml"><mi id="alg1.l3a.m1.4.5.2" xref="alg1.l3a.m1.4.5.2.cmml">j</mi><mo id="alg1.l3a.m1.4.5.1" xref="alg1.l3a.m1.4.5.1.cmml">=</mo><mrow id="alg1.l3a.m1.4.5.3.2" xref="alg1.l3a.m1.4.5.3.1.cmml"><mn id="alg1.l3a.m1.1.1" xref="alg1.l3a.m1.1.1.cmml">1</mn><mo id="alg1.l3a.m1.4.5.3.2.1" xref="alg1.l3a.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l3a.m1.2.2" xref="alg1.l3a.m1.2.2.cmml">2</mn><mo id="alg1.l3a.m1.4.5.3.2.2" xref="alg1.l3a.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l3a.m1.3.3" xref="alg1.l3a.m1.3.3.cmml">…</mi><mo id="alg1.l3a.m1.4.5.3.2.3" xref="alg1.l3a.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l3a.m1.4.4" xref="alg1.l3a.m1.4.4.cmml">J</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3a.m1.4b"><apply id="alg1.l3a.m1.4.5.cmml" xref="alg1.l3a.m1.4.5"><eq id="alg1.l3a.m1.4.5.1.cmml" xref="alg1.l3a.m1.4.5.1"></eq><ci id="alg1.l3a.m1.4.5.2.cmml" xref="alg1.l3a.m1.4.5.2">𝑗</ci><list id="alg1.l3a.m1.4.5.3.1.cmml" xref="alg1.l3a.m1.4.5.3.2"><cn type="integer" id="alg1.l3a.m1.1.1.cmml" xref="alg1.l3a.m1.1.1">1</cn><cn type="integer" id="alg1.l3a.m1.2.2.cmml" xref="alg1.l3a.m1.2.2">2</cn><ci id="alg1.l3a.m1.3.3.cmml" xref="alg1.l3a.m1.3.3">…</ci><ci id="alg1.l3a.m1.4.4.cmml" xref="alg1.l3a.m1.4.4">𝐽</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3a.m1.4c">j=1,2,\ldots,J</annotation></semantics></math> <span id="alg1.l3a.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4a.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     sample <math id="alg1.l4a.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l4a.m1.1a"><mi id="alg1.l4a.m1.1.1" xref="alg1.l4a.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l4a.m1.1b"><ci id="alg1.l4a.m1.1.1.cmml" xref="alg1.l4a.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4a.m1.1c">i</annotation></semantics></math> from <math id="alg1.l4a.m2.2" class="ltx_Math" alttext="\text{Range}(j+1,J)" display="inline"><semantics id="alg1.l4a.m2.2a"><mrow id="alg1.l4a.m2.2.2" xref="alg1.l4a.m2.2.2.cmml"><mtext id="alg1.l4a.m2.2.2.3" xref="alg1.l4a.m2.2.2.3a.cmml">Range</mtext><mo lspace="0em" rspace="0em" id="alg1.l4a.m2.2.2.2" xref="alg1.l4a.m2.2.2.2.cmml">​</mo><mrow id="alg1.l4a.m2.2.2.1.1" xref="alg1.l4a.m2.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l4a.m2.2.2.1.1.2" xref="alg1.l4a.m2.2.2.1.2.cmml">(</mo><mrow id="alg1.l4a.m2.2.2.1.1.1" xref="alg1.l4a.m2.2.2.1.1.1.cmml"><mi id="alg1.l4a.m2.2.2.1.1.1.2" xref="alg1.l4a.m2.2.2.1.1.1.2.cmml">j</mi><mo id="alg1.l4a.m2.2.2.1.1.1.1" xref="alg1.l4a.m2.2.2.1.1.1.1.cmml">+</mo><mn id="alg1.l4a.m2.2.2.1.1.1.3" xref="alg1.l4a.m2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l4a.m2.2.2.1.1.3" xref="alg1.l4a.m2.2.2.1.2.cmml">,</mo><mi id="alg1.l4a.m2.1.1" xref="alg1.l4a.m2.1.1.cmml">J</mi><mo stretchy="false" id="alg1.l4a.m2.2.2.1.1.4" xref="alg1.l4a.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4a.m2.2b"><apply id="alg1.l4a.m2.2.2.cmml" xref="alg1.l4a.m2.2.2"><times id="alg1.l4a.m2.2.2.2.cmml" xref="alg1.l4a.m2.2.2.2"></times><ci id="alg1.l4a.m2.2.2.3a.cmml" xref="alg1.l4a.m2.2.2.3"><mtext id="alg1.l4a.m2.2.2.3.cmml" xref="alg1.l4a.m2.2.2.3">Range</mtext></ci><interval closure="open" id="alg1.l4a.m2.2.2.1.2.cmml" xref="alg1.l4a.m2.2.2.1.1"><apply id="alg1.l4a.m2.2.2.1.1.1.cmml" xref="alg1.l4a.m2.2.2.1.1.1"><plus id="alg1.l4a.m2.2.2.1.1.1.1.cmml" xref="alg1.l4a.m2.2.2.1.1.1.1"></plus><ci id="alg1.l4a.m2.2.2.1.1.1.2.cmml" xref="alg1.l4a.m2.2.2.1.1.1.2">𝑗</ci><cn type="integer" id="alg1.l4a.m2.2.2.1.1.1.3.cmml" xref="alg1.l4a.m2.2.2.1.1.1.3">1</cn></apply><ci id="alg1.l4a.m2.1.1.cmml" xref="alg1.l4a.m2.1.1">𝐽</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4a.m2.2c">\text{Range}(j+1,J)</annotation></semantics></math>

</div>
<div id="alg1.l5a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5a.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     if <math id="alg1.l5a.m1.2" class="ltx_Math" alttext="p\sim\text{Uniform}(0,1)\leq P_{\text{sf}}" display="inline"><semantics id="alg1.l5a.m1.2a"><mrow id="alg1.l5a.m1.2.3" xref="alg1.l5a.m1.2.3.cmml"><mi id="alg1.l5a.m1.2.3.2" xref="alg1.l5a.m1.2.3.2.cmml">p</mi><mo id="alg1.l5a.m1.2.3.3" xref="alg1.l5a.m1.2.3.3.cmml">∼</mo><mrow id="alg1.l5a.m1.2.3.4" xref="alg1.l5a.m1.2.3.4.cmml"><mtext id="alg1.l5a.m1.2.3.4.2" xref="alg1.l5a.m1.2.3.4.2a.cmml">Uniform</mtext><mo lspace="0em" rspace="0em" id="alg1.l5a.m1.2.3.4.1" xref="alg1.l5a.m1.2.3.4.1.cmml">​</mo><mrow id="alg1.l5a.m1.2.3.4.3.2" xref="alg1.l5a.m1.2.3.4.3.1.cmml"><mo stretchy="false" id="alg1.l5a.m1.2.3.4.3.2.1" xref="alg1.l5a.m1.2.3.4.3.1.cmml">(</mo><mn id="alg1.l5a.m1.1.1" xref="alg1.l5a.m1.1.1.cmml">0</mn><mo id="alg1.l5a.m1.2.3.4.3.2.2" xref="alg1.l5a.m1.2.3.4.3.1.cmml">,</mo><mn id="alg1.l5a.m1.2.2" xref="alg1.l5a.m1.2.2.cmml">1</mn><mo stretchy="false" id="alg1.l5a.m1.2.3.4.3.2.3" xref="alg1.l5a.m1.2.3.4.3.1.cmml">)</mo></mrow></mrow><mo id="alg1.l5a.m1.2.3.5" xref="alg1.l5a.m1.2.3.5.cmml">≤</mo><msub id="alg1.l5a.m1.2.3.6" xref="alg1.l5a.m1.2.3.6.cmml"><mi id="alg1.l5a.m1.2.3.6.2" xref="alg1.l5a.m1.2.3.6.2.cmml">P</mi><mtext id="alg1.l5a.m1.2.3.6.3" xref="alg1.l5a.m1.2.3.6.3a.cmml">sf</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5a.m1.2b"><apply id="alg1.l5a.m1.2.3.cmml" xref="alg1.l5a.m1.2.3"><and id="alg1.l5a.m1.2.3a.cmml" xref="alg1.l5a.m1.2.3"></and><apply id="alg1.l5a.m1.2.3b.cmml" xref="alg1.l5a.m1.2.3"><csymbol cd="latexml" id="alg1.l5a.m1.2.3.3.cmml" xref="alg1.l5a.m1.2.3.3">similar-to</csymbol><ci id="alg1.l5a.m1.2.3.2.cmml" xref="alg1.l5a.m1.2.3.2">𝑝</ci><apply id="alg1.l5a.m1.2.3.4.cmml" xref="alg1.l5a.m1.2.3.4"><times id="alg1.l5a.m1.2.3.4.1.cmml" xref="alg1.l5a.m1.2.3.4.1"></times><ci id="alg1.l5a.m1.2.3.4.2a.cmml" xref="alg1.l5a.m1.2.3.4.2"><mtext id="alg1.l5a.m1.2.3.4.2.cmml" xref="alg1.l5a.m1.2.3.4.2">Uniform</mtext></ci><interval closure="open" id="alg1.l5a.m1.2.3.4.3.1.cmml" xref="alg1.l5a.m1.2.3.4.3.2"><cn type="integer" id="alg1.l5a.m1.1.1.cmml" xref="alg1.l5a.m1.1.1">0</cn><cn type="integer" id="alg1.l5a.m1.2.2.cmml" xref="alg1.l5a.m1.2.2">1</cn></interval></apply></apply><apply id="alg1.l5a.m1.2.3c.cmml" xref="alg1.l5a.m1.2.3"><leq id="alg1.l5a.m1.2.3.5.cmml" xref="alg1.l5a.m1.2.3.5"></leq><share href="#alg1.l5a.m1.2.3.4.cmml" id="alg1.l5a.m1.2.3d.cmml" xref="alg1.l5a.m1.2.3"></share><apply id="alg1.l5a.m1.2.3.6.cmml" xref="alg1.l5a.m1.2.3.6"><csymbol cd="ambiguous" id="alg1.l5a.m1.2.3.6.1.cmml" xref="alg1.l5a.m1.2.3.6">subscript</csymbol><ci id="alg1.l5a.m1.2.3.6.2.cmml" xref="alg1.l5a.m1.2.3.6.2">𝑃</ci><ci id="alg1.l5a.m1.2.3.6.3a.cmml" xref="alg1.l5a.m1.2.3.6.3"><mtext mathsize="70%" id="alg1.l5a.m1.2.3.6.3.cmml" xref="alg1.l5a.m1.2.3.6.3">sf</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5a.m1.2c">p\sim\text{Uniform}(0,1)\leq P_{\text{sf}}</annotation></semantics></math> then <math id="alg1.l5a.m2.2" class="ltx_Math" alttext="\text{Swap}(\Pi_{j},\Pi_{i})" display="inline"><semantics id="alg1.l5a.m2.2a"><mrow id="alg1.l5a.m2.2.2" xref="alg1.l5a.m2.2.2.cmml"><mtext id="alg1.l5a.m2.2.2.4" xref="alg1.l5a.m2.2.2.4a.cmml">Swap</mtext><mo lspace="0em" rspace="0em" id="alg1.l5a.m2.2.2.3" xref="alg1.l5a.m2.2.2.3.cmml">​</mo><mrow id="alg1.l5a.m2.2.2.2.2" xref="alg1.l5a.m2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l5a.m2.2.2.2.2.3" xref="alg1.l5a.m2.2.2.2.3.cmml">(</mo><msub id="alg1.l5a.m2.1.1.1.1.1" xref="alg1.l5a.m2.1.1.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l5a.m2.1.1.1.1.1.2" xref="alg1.l5a.m2.1.1.1.1.1.2.cmml">Π</mi><mi id="alg1.l5a.m2.1.1.1.1.1.3" xref="alg1.l5a.m2.1.1.1.1.1.3.cmml">j</mi></msub><mo id="alg1.l5a.m2.2.2.2.2.4" xref="alg1.l5a.m2.2.2.2.3.cmml">,</mo><msub id="alg1.l5a.m2.2.2.2.2.2" xref="alg1.l5a.m2.2.2.2.2.2.cmml"><mi mathvariant="normal" id="alg1.l5a.m2.2.2.2.2.2.2" xref="alg1.l5a.m2.2.2.2.2.2.2.cmml">Π</mi><mi id="alg1.l5a.m2.2.2.2.2.2.3" xref="alg1.l5a.m2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l5a.m2.2.2.2.2.5" xref="alg1.l5a.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5a.m2.2b"><apply id="alg1.l5a.m2.2.2.cmml" xref="alg1.l5a.m2.2.2"><times id="alg1.l5a.m2.2.2.3.cmml" xref="alg1.l5a.m2.2.2.3"></times><ci id="alg1.l5a.m2.2.2.4a.cmml" xref="alg1.l5a.m2.2.2.4"><mtext id="alg1.l5a.m2.2.2.4.cmml" xref="alg1.l5a.m2.2.2.4">Swap</mtext></ci><interval closure="open" id="alg1.l5a.m2.2.2.2.3.cmml" xref="alg1.l5a.m2.2.2.2.2"><apply id="alg1.l5a.m2.1.1.1.1.1.cmml" xref="alg1.l5a.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5a.m2.1.1.1.1.1.1.cmml" xref="alg1.l5a.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5a.m2.1.1.1.1.1.2.cmml" xref="alg1.l5a.m2.1.1.1.1.1.2">Π</ci><ci id="alg1.l5a.m2.1.1.1.1.1.3.cmml" xref="alg1.l5a.m2.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l5a.m2.2.2.2.2.2.cmml" xref="alg1.l5a.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5a.m2.2.2.2.2.2.1.cmml" xref="alg1.l5a.m2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l5a.m2.2.2.2.2.2.2.cmml" xref="alg1.l5a.m2.2.2.2.2.2.2">Π</ci><ci id="alg1.l5a.m2.2.2.2.2.2.3.cmml" xref="alg1.l5a.m2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5a.m2.2c">\text{Swap}(\Pi_{j},\Pi_{i})</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>  <span id="alg1.l6.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l6.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</div>
</div>
</figure>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Shuffle Process in FL</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  Input: shuffle probability <math id="alg2.l1.m1.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="alg2.l1.m1.1a"><msub id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><mi id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml">P</mi><mtext id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1">subscript</csymbol><ci id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2">𝑃</ci><ci id="alg2.l1.m1.1.1.3a.cmml" xref="alg2.l1.m1.1.1.3"><mtext mathsize="70%" id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">P_{\text{sf}}</annotation></semantics></math>; expected shuffle times <math id="alg2.l1.m2.1" class="ltx_Math" alttext="N_{\text{sf}}" display="inline"><semantics id="alg2.l1.m2.1a"><msub id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml"><mi id="alg2.l1.m2.1.1.2" xref="alg2.l1.m2.1.1.2.cmml">N</mi><mtext id="alg2.l1.m2.1.1.3" xref="alg2.l1.m2.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><apply id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.1.cmml" xref="alg2.l1.m2.1.1">subscript</csymbol><ci id="alg2.l1.m2.1.1.2.cmml" xref="alg2.l1.m2.1.1.2">𝑁</ci><ci id="alg2.l1.m2.1.1.3a.cmml" xref="alg2.l1.m2.1.1.3"><mtext mathsize="70%" id="alg2.l1.m2.1.1.3.cmml" xref="alg2.l1.m2.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">N_{\text{sf}}</annotation></semantics></math>; number of local epochs <math id="alg2.l1.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg2.l1.m3.1a"><mi id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><ci id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">E</annotation></semantics></math>; batch size <math id="alg2.l1.m4.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg2.l1.m4.1a"><mi id="alg2.l1.m4.1.1" xref="alg2.l1.m4.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><ci id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">B</annotation></semantics></math>; number of local samples <math id="alg2.l1.m5.1" class="ltx_Math" alttext="\{N_{k}\}_{k=1}^{K}" display="inline"><semantics id="alg2.l1.m5.1a"><msubsup id="alg2.l1.m5.1.1" xref="alg2.l1.m5.1.1.cmml"><mrow id="alg2.l1.m5.1.1.1.1.1" xref="alg2.l1.m5.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l1.m5.1.1.1.1.1.2" xref="alg2.l1.m5.1.1.1.1.2.cmml">{</mo><msub id="alg2.l1.m5.1.1.1.1.1.1" xref="alg2.l1.m5.1.1.1.1.1.1.cmml"><mi id="alg2.l1.m5.1.1.1.1.1.1.2" xref="alg2.l1.m5.1.1.1.1.1.1.2.cmml">N</mi><mi id="alg2.l1.m5.1.1.1.1.1.1.3" xref="alg2.l1.m5.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="alg2.l1.m5.1.1.1.1.1.3" xref="alg2.l1.m5.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l1.m5.1.1.1.3" xref="alg2.l1.m5.1.1.1.3.cmml"><mi id="alg2.l1.m5.1.1.1.3.2" xref="alg2.l1.m5.1.1.1.3.2.cmml">k</mi><mo id="alg2.l1.m5.1.1.1.3.1" xref="alg2.l1.m5.1.1.1.3.1.cmml">=</mo><mn id="alg2.l1.m5.1.1.1.3.3" xref="alg2.l1.m5.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg2.l1.m5.1.1.3" xref="alg2.l1.m5.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l1.m5.1b"><apply id="alg2.l1.m5.1.1.cmml" xref="alg2.l1.m5.1.1"><csymbol cd="ambiguous" id="alg2.l1.m5.1.1.2.cmml" xref="alg2.l1.m5.1.1">superscript</csymbol><apply id="alg2.l1.m5.1.1.1.cmml" xref="alg2.l1.m5.1.1"><csymbol cd="ambiguous" id="alg2.l1.m5.1.1.1.2.cmml" xref="alg2.l1.m5.1.1">subscript</csymbol><set id="alg2.l1.m5.1.1.1.1.2.cmml" xref="alg2.l1.m5.1.1.1.1.1"><apply id="alg2.l1.m5.1.1.1.1.1.1.cmml" xref="alg2.l1.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m5.1.1.1.1.1.1.1.cmml" xref="alg2.l1.m5.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l1.m5.1.1.1.1.1.1.2.cmml" xref="alg2.l1.m5.1.1.1.1.1.1.2">𝑁</ci><ci id="alg2.l1.m5.1.1.1.1.1.1.3.cmml" xref="alg2.l1.m5.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="alg2.l1.m5.1.1.1.3.cmml" xref="alg2.l1.m5.1.1.1.3"><eq id="alg2.l1.m5.1.1.1.3.1.cmml" xref="alg2.l1.m5.1.1.1.3.1"></eq><ci id="alg2.l1.m5.1.1.1.3.2.cmml" xref="alg2.l1.m5.1.1.1.3.2">𝑘</ci><cn type="integer" id="alg2.l1.m5.1.1.1.3.3.cmml" xref="alg2.l1.m5.1.1.1.3.3">1</cn></apply></apply><ci id="alg2.l1.m5.1.1.3.cmml" xref="alg2.l1.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m5.1c">\{N_{k}\}_{k=1}^{K}</annotation></semantics></math>

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg2.l2.2" class="ltx_text ltx_font_bold">for</span> each client <math id="alg2.l2.m1.1" class="ltx_Math" alttext="k\in S_{t}" display="inline"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">k</mi><mo id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">∈</mo><msub id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml"><mi id="alg2.l2.m1.1.1.3.2" xref="alg2.l2.m1.1.1.3.2.cmml">S</mi><mi id="alg2.l2.m1.1.1.3.3" xref="alg2.l2.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><in id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></in><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝑘</ci><apply id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.3">subscript</csymbol><ci id="alg2.l2.m1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.3.2">𝑆</ci><ci id="alg2.l2.m1.1.1.3.3.cmml" xref="alg2.l2.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">k\in S_{t}</annotation></semantics></math> <span id="alg2.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     Calculate the number of local update steps: <math id="alg2.l3.m1.1" class="ltx_Math" alttext="r_{k}=E*N_{k}/B" display="inline"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><msub id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml"><mi id="alg2.l3.m1.1.1.2.2" xref="alg2.l3.m1.1.1.2.2.cmml">r</mi><mi id="alg2.l3.m1.1.1.2.3" xref="alg2.l3.m1.1.1.2.3.cmml">k</mi></msub><mo id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">=</mo><mrow id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml"><mrow id="alg2.l3.m1.1.1.3.2" xref="alg2.l3.m1.1.1.3.2.cmml"><mi id="alg2.l3.m1.1.1.3.2.2" xref="alg2.l3.m1.1.1.3.2.2.cmml">E</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l3.m1.1.1.3.2.1" xref="alg2.l3.m1.1.1.3.2.1.cmml">∗</mo><msub id="alg2.l3.m1.1.1.3.2.3" xref="alg2.l3.m1.1.1.3.2.3.cmml"><mi id="alg2.l3.m1.1.1.3.2.3.2" xref="alg2.l3.m1.1.1.3.2.3.2.cmml">N</mi><mi id="alg2.l3.m1.1.1.3.2.3.3" xref="alg2.l3.m1.1.1.3.2.3.3.cmml">k</mi></msub></mrow><mo id="alg2.l3.m1.1.1.3.1" xref="alg2.l3.m1.1.1.3.1.cmml">/</mo><mi id="alg2.l3.m1.1.1.3.3" xref="alg2.l3.m1.1.1.3.3.cmml">B</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><eq id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"></eq><apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1.2">subscript</csymbol><ci id="alg2.l3.m1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.2.2">𝑟</ci><ci id="alg2.l3.m1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.2.3">𝑘</ci></apply><apply id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3"><divide id="alg2.l3.m1.1.1.3.1.cmml" xref="alg2.l3.m1.1.1.3.1"></divide><apply id="alg2.l3.m1.1.1.3.2.cmml" xref="alg2.l3.m1.1.1.3.2"><times id="alg2.l3.m1.1.1.3.2.1.cmml" xref="alg2.l3.m1.1.1.3.2.1"></times><ci id="alg2.l3.m1.1.1.3.2.2.cmml" xref="alg2.l3.m1.1.1.3.2.2">𝐸</ci><apply id="alg2.l3.m1.1.1.3.2.3.cmml" xref="alg2.l3.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.2.3.1.cmml" xref="alg2.l3.m1.1.1.3.2.3">subscript</csymbol><ci id="alg2.l3.m1.1.1.3.2.3.2.cmml" xref="alg2.l3.m1.1.1.3.2.3.2">𝑁</ci><ci id="alg2.l3.m1.1.1.3.2.3.3.cmml" xref="alg2.l3.m1.1.1.3.2.3.3">𝑘</ci></apply></apply><ci id="alg2.l3.m1.1.1.3.3.cmml" xref="alg2.l3.m1.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">r_{k}=E*N_{k}/B</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg2.l4.2" class="ltx_text ltx_font_bold">for</span> each local step in <math id="alg2.l4.m1.1" class="ltx_Math" alttext="[r_{k}]" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.2.cmml"><mo stretchy="false" id="alg2.l4.m1.1.1.1.2" xref="alg2.l4.m1.1.1.2.1.cmml">[</mo><msub id="alg2.l4.m1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.cmml"><mi id="alg2.l4.m1.1.1.1.1.2" xref="alg2.l4.m1.1.1.1.1.2.cmml">r</mi><mi id="alg2.l4.m1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="alg2.l4.m1.1.1.1.3" xref="alg2.l4.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1"><csymbol cd="latexml" id="alg2.l4.m1.1.1.2.1.cmml" xref="alg2.l4.m1.1.1.1.2">delimited-[]</csymbol><apply id="alg2.l4.m1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1">subscript</csymbol><ci id="alg2.l4.m1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1.2">𝑟</ci><ci id="alg2.l4.m1.1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">[r_{k}]</annotation></semantics></math> <span id="alg2.l4.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        if <math id="alg2.l5.m1.2" class="ltx_Math" alttext="p\sim\text{Uniform}(0,1)\leq N_{\text{sf}}/r_{k}" display="inline"><semantics id="alg2.l5.m1.2a"><mrow id="alg2.l5.m1.2.3" xref="alg2.l5.m1.2.3.cmml"><mi id="alg2.l5.m1.2.3.2" xref="alg2.l5.m1.2.3.2.cmml">p</mi><mo id="alg2.l5.m1.2.3.3" xref="alg2.l5.m1.2.3.3.cmml">∼</mo><mrow id="alg2.l5.m1.2.3.4" xref="alg2.l5.m1.2.3.4.cmml"><mtext id="alg2.l5.m1.2.3.4.2" xref="alg2.l5.m1.2.3.4.2a.cmml">Uniform</mtext><mo lspace="0em" rspace="0em" id="alg2.l5.m1.2.3.4.1" xref="alg2.l5.m1.2.3.4.1.cmml">​</mo><mrow id="alg2.l5.m1.2.3.4.3.2" xref="alg2.l5.m1.2.3.4.3.1.cmml"><mo stretchy="false" id="alg2.l5.m1.2.3.4.3.2.1" xref="alg2.l5.m1.2.3.4.3.1.cmml">(</mo><mn id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">0</mn><mo id="alg2.l5.m1.2.3.4.3.2.2" xref="alg2.l5.m1.2.3.4.3.1.cmml">,</mo><mn id="alg2.l5.m1.2.2" xref="alg2.l5.m1.2.2.cmml">1</mn><mo stretchy="false" id="alg2.l5.m1.2.3.4.3.2.3" xref="alg2.l5.m1.2.3.4.3.1.cmml">)</mo></mrow></mrow><mo id="alg2.l5.m1.2.3.5" xref="alg2.l5.m1.2.3.5.cmml">≤</mo><mrow id="alg2.l5.m1.2.3.6" xref="alg2.l5.m1.2.3.6.cmml"><msub id="alg2.l5.m1.2.3.6.2" xref="alg2.l5.m1.2.3.6.2.cmml"><mi id="alg2.l5.m1.2.3.6.2.2" xref="alg2.l5.m1.2.3.6.2.2.cmml">N</mi><mtext id="alg2.l5.m1.2.3.6.2.3" xref="alg2.l5.m1.2.3.6.2.3a.cmml">sf</mtext></msub><mo id="alg2.l5.m1.2.3.6.1" xref="alg2.l5.m1.2.3.6.1.cmml">/</mo><msub id="alg2.l5.m1.2.3.6.3" xref="alg2.l5.m1.2.3.6.3.cmml"><mi id="alg2.l5.m1.2.3.6.3.2" xref="alg2.l5.m1.2.3.6.3.2.cmml">r</mi><mi id="alg2.l5.m1.2.3.6.3.3" xref="alg2.l5.m1.2.3.6.3.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.2b"><apply id="alg2.l5.m1.2.3.cmml" xref="alg2.l5.m1.2.3"><and id="alg2.l5.m1.2.3a.cmml" xref="alg2.l5.m1.2.3"></and><apply id="alg2.l5.m1.2.3b.cmml" xref="alg2.l5.m1.2.3"><csymbol cd="latexml" id="alg2.l5.m1.2.3.3.cmml" xref="alg2.l5.m1.2.3.3">similar-to</csymbol><ci id="alg2.l5.m1.2.3.2.cmml" xref="alg2.l5.m1.2.3.2">𝑝</ci><apply id="alg2.l5.m1.2.3.4.cmml" xref="alg2.l5.m1.2.3.4"><times id="alg2.l5.m1.2.3.4.1.cmml" xref="alg2.l5.m1.2.3.4.1"></times><ci id="alg2.l5.m1.2.3.4.2a.cmml" xref="alg2.l5.m1.2.3.4.2"><mtext id="alg2.l5.m1.2.3.4.2.cmml" xref="alg2.l5.m1.2.3.4.2">Uniform</mtext></ci><interval closure="open" id="alg2.l5.m1.2.3.4.3.1.cmml" xref="alg2.l5.m1.2.3.4.3.2"><cn type="integer" id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">0</cn><cn type="integer" id="alg2.l5.m1.2.2.cmml" xref="alg2.l5.m1.2.2">1</cn></interval></apply></apply><apply id="alg2.l5.m1.2.3c.cmml" xref="alg2.l5.m1.2.3"><leq id="alg2.l5.m1.2.3.5.cmml" xref="alg2.l5.m1.2.3.5"></leq><share href="#alg2.l5.m1.2.3.4.cmml" id="alg2.l5.m1.2.3d.cmml" xref="alg2.l5.m1.2.3"></share><apply id="alg2.l5.m1.2.3.6.cmml" xref="alg2.l5.m1.2.3.6"><divide id="alg2.l5.m1.2.3.6.1.cmml" xref="alg2.l5.m1.2.3.6.1"></divide><apply id="alg2.l5.m1.2.3.6.2.cmml" xref="alg2.l5.m1.2.3.6.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.3.6.2.1.cmml" xref="alg2.l5.m1.2.3.6.2">subscript</csymbol><ci id="alg2.l5.m1.2.3.6.2.2.cmml" xref="alg2.l5.m1.2.3.6.2.2">𝑁</ci><ci id="alg2.l5.m1.2.3.6.2.3a.cmml" xref="alg2.l5.m1.2.3.6.2.3"><mtext mathsize="70%" id="alg2.l5.m1.2.3.6.2.3.cmml" xref="alg2.l5.m1.2.3.6.2.3">sf</mtext></ci></apply><apply id="alg2.l5.m1.2.3.6.3.cmml" xref="alg2.l5.m1.2.3.6.3"><csymbol cd="ambiguous" id="alg2.l5.m1.2.3.6.3.1.cmml" xref="alg2.l5.m1.2.3.6.3">subscript</csymbol><ci id="alg2.l5.m1.2.3.6.3.2.cmml" xref="alg2.l5.m1.2.3.6.3.2">𝑟</ci><ci id="alg2.l5.m1.2.3.6.3.3.cmml" xref="alg2.l5.m1.2.3.6.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.2c">p\sim\text{Uniform}(0,1)\leq N_{\text{sf}}/r_{k}</annotation></semantics></math> run the ShuffleProcess with shuffle probability <math id="alg2.l5.m2.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="alg2.l5.m2.1a"><msub id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml"><mi id="alg2.l5.m2.1.1.2" xref="alg2.l5.m2.1.1.2.cmml">P</mi><mtext id="alg2.l5.m2.1.1.3" xref="alg2.l5.m2.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><apply id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1"><csymbol cd="ambiguous" id="alg2.l5.m2.1.1.1.cmml" xref="alg2.l5.m2.1.1">subscript</csymbol><ci id="alg2.l5.m2.1.1.2.cmml" xref="alg2.l5.m2.1.1.2">𝑃</ci><ci id="alg2.l5.m2.1.1.3a.cmml" xref="alg2.l5.m2.1.1.3"><mtext mathsize="70%" id="alg2.l5.m2.1.1.3.cmml" xref="alg2.l5.m2.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">P_{\text{sf}}</annotation></semantics></math>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     <span id="alg2.l6.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l6.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>  <span id="alg2.l7.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l7.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Network Details</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">We utilize MLP, VGG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> in this paper. We detail their architectures as follows:</p>
<ul id="A2.I1" class="ltx_itemize">
<li id="A2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i1.p1" class="ltx_para">
<p id="A2.I1.i1.p1.3" class="ltx_p"><span id="A2.I1.i1.p1.3.1" class="ltx_text ltx_font_bold">MLP</span> denotes a multiple layer perceptron with four layers containing input and output layers. For Mnist and FeMnist, the input size is <math id="A2.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="28\times 28=784" display="inline"><semantics id="A2.I1.i1.p1.1.m1.1a"><mrow id="A2.I1.i1.p1.1.m1.1.1" xref="A2.I1.i1.p1.1.m1.1.1.cmml"><mrow id="A2.I1.i1.p1.1.m1.1.1.2" xref="A2.I1.i1.p1.1.m1.1.1.2.cmml"><mn id="A2.I1.i1.p1.1.m1.1.1.2.2" xref="A2.I1.i1.p1.1.m1.1.1.2.2.cmml">28</mn><mo lspace="0.222em" rspace="0.222em" id="A2.I1.i1.p1.1.m1.1.1.2.1" xref="A2.I1.i1.p1.1.m1.1.1.2.1.cmml">×</mo><mn id="A2.I1.i1.p1.1.m1.1.1.2.3" xref="A2.I1.i1.p1.1.m1.1.1.2.3.cmml">28</mn></mrow><mo id="A2.I1.i1.p1.1.m1.1.1.1" xref="A2.I1.i1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A2.I1.i1.p1.1.m1.1.1.3" xref="A2.I1.i1.p1.1.m1.1.1.3.cmml">784</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.1.m1.1b"><apply id="A2.I1.i1.p1.1.m1.1.1.cmml" xref="A2.I1.i1.p1.1.m1.1.1"><eq id="A2.I1.i1.p1.1.m1.1.1.1.cmml" xref="A2.I1.i1.p1.1.m1.1.1.1"></eq><apply id="A2.I1.i1.p1.1.m1.1.1.2.cmml" xref="A2.I1.i1.p1.1.m1.1.1.2"><times id="A2.I1.i1.p1.1.m1.1.1.2.1.cmml" xref="A2.I1.i1.p1.1.m1.1.1.2.1"></times><cn type="integer" id="A2.I1.i1.p1.1.m1.1.1.2.2.cmml" xref="A2.I1.i1.p1.1.m1.1.1.2.2">28</cn><cn type="integer" id="A2.I1.i1.p1.1.m1.1.1.2.3.cmml" xref="A2.I1.i1.p1.1.m1.1.1.2.3">28</cn></apply><cn type="integer" id="A2.I1.i1.p1.1.m1.1.1.3.cmml" xref="A2.I1.i1.p1.1.m1.1.1.3">784</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.1.m1.1c">28\times 28=784</annotation></semantics></math>. MLP has the architecture: FC1(784, 1024), ReLU(), FC2(1024, 1024), ReLU(), FC3(1024, 1024), ReLU(), FC4(1024, <math id="A2.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A2.I1.i1.p1.2.m2.1a"><mi id="A2.I1.i1.p1.2.m2.1.1" xref="A2.I1.i1.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.2.m2.1b"><ci id="A2.I1.i1.p1.2.m2.1.1.cmml" xref="A2.I1.i1.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.2.m2.1c">C</annotation></semantics></math>). <math id="A2.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A2.I1.i1.p1.3.m3.1a"><mi id="A2.I1.i1.p1.3.m3.1.1" xref="A2.I1.i1.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.3.m3.1b"><ci id="A2.I1.i1.p1.3.m3.1.1.cmml" xref="A2.I1.i1.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.3.m3.1c">C</annotation></semantics></math> denotes the number of classes.</p>
</div>
</li>
<li id="A2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i2.p1" class="ltx_para">
<p id="A2.I1.i2.p1.3" class="ltx_p"><span id="A2.I1.i2.p1.3.1" class="ltx_text ltx_font_bold">VGG</span> contains a series of networks with various layers. The paper of VGG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> presents VGG11, VGG13, VGG16, and VGG19. We follow their architectures and report the configuration of VGG11 as an example: 64, M, 128, M, 256, 256, M, 512, 512, M, 512, 512, M. “M” denotes the max-pooling layer. VGG11 contains 8 convolution blocks and three fully-connected layers in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. However, we only use one fully-connected layer for classification in this paper. VGG9 is commonly utilized in previous FL works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, whose configuration is: 32, 64, M, 128, 128, M, 256, 256, M. We keep all the fully-connected layers in VGG9 for a fair comparison with other works. The three fully-connected layers in VGG9 are: FC(4096, 512), ReLU(), FC(512, 512), ReLU(), FC(512, <math id="A2.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A2.I1.i2.p1.1.m1.1a"><mi id="A2.I1.i2.p1.1.m1.1.1" xref="A2.I1.i2.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.1.m1.1b"><ci id="A2.I1.i2.p1.1.m1.1.1.cmml" xref="A2.I1.i2.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.1.m1.1c">C</annotation></semantics></math>). We name the <math id="A2.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A2.I1.i2.p1.2.m2.1a"><mi id="A2.I1.i2.p1.2.m2.1.1" xref="A2.I1.i2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.2.m2.1b"><ci id="A2.I1.i2.p1.2.m2.1.1.cmml" xref="A2.I1.i2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.2.m2.1c">i</annotation></semantics></math>th convolution layer in VGG as “Conv<math id="A2.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A2.I1.i2.p1.3.m3.1a"><mi id="A2.I1.i2.p1.3.m3.1.1" xref="A2.I1.i2.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.3.m3.1b"><ci id="A2.I1.i2.p1.3.m3.1.1.cmml" xref="A2.I1.i2.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.3.m3.1c">i</annotation></semantics></math>”. We do not use BatchNorm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> in VGG by default.</p>
</div>
</li>
<li id="A2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i3.p1" class="ltx_para">
<p id="A2.I1.i3.p1.1" class="ltx_p"><span id="A2.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">ResNet</span> introduces residual connections to plain neural networks. We take the Cifar versions used in the paper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, i.e., ResNet20 with the basic block. We set the initial channel as 64 (i.e., the output channel of the first convolution layer), and take nine continual basic blocks with 64, 64, 64, 128, 128, 128, 256, 256, 256 channels, respectively. We add a fully-connected layer for classification. We use BatchNorm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> in ResNet20 and add it before ReLU activation.</p>
</div>
</li>
</ul>
</div>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p">For these networks with PANs, we plot the demos in Fig. <a href="#A1.F13" title="Figure 13 ‣ Appendix A Dataset Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>. We add PE before the ReLU activation layer and after the BatchNorm layer. We show the formulations of additive PANs and multiplicative PANs in the table of Fig. <a href="#A1.F13" title="Figure 13 ‣ Appendix A Dataset Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>.</p>
</div>
<figure id="A2.F14" class="ltx_figure"><img src="/html/2203.14666/assets/x16.png" id="A2.F14.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="183" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F14.20.7.1" class="ltx_text" style="font-size:90%;">Figure 14</span>: </span><span id="A2.F14.12.6" class="ltx_text ltx_font_bold" style="font-size:90%;">Left<span id="A2.F14.9.3.3" class="ltx_text ltx_font_medium">: shuffle error with various <math id="A2.F14.7.1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A2.F14.7.1.1.m1.1b"><mi id="A2.F14.7.1.1.m1.1.1" xref="A2.F14.7.1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A2.F14.7.1.1.m1.1c"><ci id="A2.F14.7.1.1.m1.1.1.cmml" xref="A2.F14.7.1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F14.7.1.1.m1.1d">T</annotation></semantics></math> and <math id="A2.F14.8.2.2.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A2.F14.8.2.2.m2.1b"><mi id="A2.F14.8.2.2.m2.1.1" xref="A2.F14.8.2.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A2.F14.8.2.2.m2.1c"><ci id="A2.F14.8.2.2.m2.1.1.cmml" xref="A2.F14.8.2.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F14.8.2.2.m2.1d">A</annotation></semantics></math> (PAN<sub id="A2.F14.9.3.3.1" class="ltx_sub">∘</sub>). </span>Right<span id="A2.F14.12.6.6" class="ltx_text ltx_font_medium">: the difference between PAN<sub id="A2.F14.12.6.6.1" class="ltx_sub">+</sub> and PAN<sub id="A2.F14.12.6.6.2" class="ltx_sub">∘</sub> (<math id="A2.F14.12.6.6.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A2.F14.12.6.6.m3.1b"><mi id="A2.F14.12.6.6.m3.1.1" xref="A2.F14.12.6.6.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A2.F14.12.6.6.m3.1c"><ci id="A2.F14.12.6.6.m3.1.1.cmml" xref="A2.F14.12.6.6.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F14.12.6.6.m3.1d">T</annotation></semantics></math>=1). (<span id="A2.F14.12.6.6.3" class="ltx_text" style="font-size:78%;">MLP</span>)</span></span></figcaption>
</figure>
<figure id="A2.F15" class="ltx_figure"><img src="/html/2203.14666/assets/x17.png" id="A2.F15.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="183" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F15.20.7.1" class="ltx_text" style="font-size:90%;">Figure 15</span>: </span><span id="A2.F15.12.6" class="ltx_text ltx_font_bold" style="font-size:90%;">Left<span id="A2.F15.9.3.3" class="ltx_text ltx_font_medium">: shuffle error with various <math id="A2.F15.7.1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A2.F15.7.1.1.m1.1b"><mi id="A2.F15.7.1.1.m1.1.1" xref="A2.F15.7.1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A2.F15.7.1.1.m1.1c"><ci id="A2.F15.7.1.1.m1.1.1.cmml" xref="A2.F15.7.1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F15.7.1.1.m1.1d">T</annotation></semantics></math> and <math id="A2.F15.8.2.2.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A2.F15.8.2.2.m2.1b"><mi id="A2.F15.8.2.2.m2.1.1" xref="A2.F15.8.2.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A2.F15.8.2.2.m2.1c"><ci id="A2.F15.8.2.2.m2.1.1.cmml" xref="A2.F15.8.2.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F15.8.2.2.m2.1d">A</annotation></semantics></math> (PAN<sub id="A2.F15.9.3.3.1" class="ltx_sub">∘</sub>). </span>Right<span id="A2.F15.12.6.6" class="ltx_text ltx_font_medium">: the difference between PAN<sub id="A2.F15.12.6.6.1" class="ltx_sub">+</sub> and PAN<sub id="A2.F15.12.6.6.2" class="ltx_sub">∘</sub> (<math id="A2.F15.12.6.6.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A2.F15.12.6.6.m3.1b"><mi id="A2.F15.12.6.6.m3.1.1" xref="A2.F15.12.6.6.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A2.F15.12.6.6.m3.1c"><ci id="A2.F15.12.6.6.m3.1.1.cmml" xref="A2.F15.12.6.6.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F15.12.6.6.m3.1d">T</annotation></semantics></math>=1). (<span id="A2.F15.12.6.6.3" class="ltx_text" style="font-size:78%;">ResNet20</span>)</span></span></figcaption>
</figure>
<figure id="A2.F16" class="ltx_figure"><img src="/html/2203.14666/assets/x18.png" id="A2.F16.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="178" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F16.5.2.1" class="ltx_text" style="font-size:90%;">Figure 16</span>: </span><span id="A2.F16.2.1" class="ltx_text" style="font-size:90%;">Weight divergence with PANs off/on. (<math id="A2.F16.2.1.m1.1" class="ltx_Math" alttext="E=20" display="inline"><semantics id="A2.F16.2.1.m1.1b"><mrow id="A2.F16.2.1.m1.1.1" xref="A2.F16.2.1.m1.1.1.cmml"><mi mathsize="78%" id="A2.F16.2.1.m1.1.1.2" xref="A2.F16.2.1.m1.1.1.2.cmml">E</mi><mo mathsize="78%" id="A2.F16.2.1.m1.1.1.1" xref="A2.F16.2.1.m1.1.1.1.cmml">=</mo><mn mathsize="78%" id="A2.F16.2.1.m1.1.1.3" xref="A2.F16.2.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F16.2.1.m1.1c"><apply id="A2.F16.2.1.m1.1.1.cmml" xref="A2.F16.2.1.m1.1.1"><eq id="A2.F16.2.1.m1.1.1.1.cmml" xref="A2.F16.2.1.m1.1.1.1"></eq><ci id="A2.F16.2.1.m1.1.1.2.cmml" xref="A2.F16.2.1.m1.1.1.2">𝐸</ci><cn type="integer" id="A2.F16.2.1.m1.1.1.3.cmml" xref="A2.F16.2.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F16.2.1.m1.1d">E=20</annotation></semantics></math><span id="A2.F16.2.1.1" class="ltx_text" style="font-size:78%;">, MLP on Mnist.</span>)</span></figcaption>
</figure>
<figure id="A2.F17" class="ltx_figure"><img src="/html/2203.14666/assets/x19.png" id="A2.F17.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="184" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F17.5.2.1" class="ltx_text" style="font-size:90%;">Figure 17</span>: </span><span id="A2.F17.2.1" class="ltx_text" style="font-size:90%;">Weight divergence with PANs off/on. (<math id="A2.F17.2.1.m1.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="A2.F17.2.1.m1.1b"><mrow id="A2.F17.2.1.m1.1.1" xref="A2.F17.2.1.m1.1.1.cmml"><mi mathsize="78%" id="A2.F17.2.1.m1.1.1.2" xref="A2.F17.2.1.m1.1.1.2.cmml">E</mi><mo mathsize="78%" id="A2.F17.2.1.m1.1.1.1" xref="A2.F17.2.1.m1.1.1.1.cmml">=</mo><mn mathsize="78%" id="A2.F17.2.1.m1.1.1.3" xref="A2.F17.2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F17.2.1.m1.1c"><apply id="A2.F17.2.1.m1.1.1.cmml" xref="A2.F17.2.1.m1.1.1"><eq id="A2.F17.2.1.m1.1.1.1.cmml" xref="A2.F17.2.1.m1.1.1.1"></eq><ci id="A2.F17.2.1.m1.1.1.2.cmml" xref="A2.F17.2.1.m1.1.1.2">𝐸</ci><cn type="integer" id="A2.F17.2.1.m1.1.1.3.cmml" xref="A2.F17.2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F17.2.1.m1.1d">E=5</annotation></semantics></math><span id="A2.F17.2.1.1" class="ltx_text" style="font-size:78%;">, VGG9 on Cifar10.</span>)</span></figcaption>
</figure>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Hyper-parameter Details</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">For both centralized training and decentralized training (i.e., FL), we take a constant learning rate without scheduling, although some works have pointed out decaying the learning rate will help in FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. We take SGD with momentum 0.9 as the optimizer by default if without more declaration. For MLP and VGG networks, we set the learning rate as 0.05; for ResNet, we use 0.1. We respectively use a warm start with 100 training steps and 10 training steps for centralized training and decentralized training (during local training). We use batch size 10 for FeMnist and 64 for other datasets.</p>
</div>
<div id="A3.p2" class="ltx_para">
<p id="A3.p2.13" class="ltx_p">We use FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, FedOpt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, Scaffold <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, and MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> as base FL algorithms. For all of these algorithms, we take <math id="A3.p2.1.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="A3.p2.1.m1.1a"><mi id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.1b"><ci id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.1c">H</annotation></semantics></math> communication rounds, and select <math id="A3.p2.2.m2.1" class="ltx_Math" alttext="R*100.0\%" display="inline"><semantics id="A3.p2.2.m2.1a"><mrow id="A3.p2.2.m2.1.1" xref="A3.p2.2.m2.1.1.cmml"><mi id="A3.p2.2.m2.1.1.2" xref="A3.p2.2.m2.1.1.2.cmml">R</mi><mo lspace="0.222em" rspace="0.222em" id="A3.p2.2.m2.1.1.1" xref="A3.p2.2.m2.1.1.1.cmml">∗</mo><mrow id="A3.p2.2.m2.1.1.3" xref="A3.p2.2.m2.1.1.3.cmml"><mn id="A3.p2.2.m2.1.1.3.2" xref="A3.p2.2.m2.1.1.3.2.cmml">100.0</mn><mo id="A3.p2.2.m2.1.1.3.1" xref="A3.p2.2.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.2.m2.1b"><apply id="A3.p2.2.m2.1.1.cmml" xref="A3.p2.2.m2.1.1"><times id="A3.p2.2.m2.1.1.1.cmml" xref="A3.p2.2.m2.1.1.1"></times><ci id="A3.p2.2.m2.1.1.2.cmml" xref="A3.p2.2.m2.1.1.2">𝑅</ci><apply id="A3.p2.2.m2.1.1.3.cmml" xref="A3.p2.2.m2.1.1.3"><csymbol cd="latexml" id="A3.p2.2.m2.1.1.3.1.cmml" xref="A3.p2.2.m2.1.1.3.1">percent</csymbol><cn type="float" id="A3.p2.2.m2.1.1.3.2.cmml" xref="A3.p2.2.m2.1.1.3.2">100.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.2.m2.1c">R*100.0\%</annotation></semantics></math> clients during each round. Each client updates the global model on their private data for <math id="A3.p2.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="A3.p2.3.m3.1a"><mi id="A3.p2.3.m3.1.1" xref="A3.p2.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A3.p2.3.m3.1b"><ci id="A3.p2.3.m3.1.1.cmml" xref="A3.p2.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.3.m3.1c">E</annotation></semantics></math> epochs. For FedProx, the regularization coefficient of the proximal term is tuned in <math id="A3.p2.4.m4.2" class="ltx_Math" alttext="\{1e-4,1e-3\}" display="inline"><semantics id="A3.p2.4.m4.2a"><mrow id="A3.p2.4.m4.2.2.2" xref="A3.p2.4.m4.2.2.3.cmml"><mo stretchy="false" id="A3.p2.4.m4.2.2.2.3" xref="A3.p2.4.m4.2.2.3.cmml">{</mo><mrow id="A3.p2.4.m4.1.1.1.1" xref="A3.p2.4.m4.1.1.1.1.cmml"><mrow id="A3.p2.4.m4.1.1.1.1.2" xref="A3.p2.4.m4.1.1.1.1.2.cmml"><mn id="A3.p2.4.m4.1.1.1.1.2.2" xref="A3.p2.4.m4.1.1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A3.p2.4.m4.1.1.1.1.2.1" xref="A3.p2.4.m4.1.1.1.1.2.1.cmml">​</mo><mi id="A3.p2.4.m4.1.1.1.1.2.3" xref="A3.p2.4.m4.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="A3.p2.4.m4.1.1.1.1.1" xref="A3.p2.4.m4.1.1.1.1.1.cmml">−</mo><mn id="A3.p2.4.m4.1.1.1.1.3" xref="A3.p2.4.m4.1.1.1.1.3.cmml">4</mn></mrow><mo id="A3.p2.4.m4.2.2.2.4" xref="A3.p2.4.m4.2.2.3.cmml">,</mo><mrow id="A3.p2.4.m4.2.2.2.2" xref="A3.p2.4.m4.2.2.2.2.cmml"><mrow id="A3.p2.4.m4.2.2.2.2.2" xref="A3.p2.4.m4.2.2.2.2.2.cmml"><mn id="A3.p2.4.m4.2.2.2.2.2.2" xref="A3.p2.4.m4.2.2.2.2.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A3.p2.4.m4.2.2.2.2.2.1" xref="A3.p2.4.m4.2.2.2.2.2.1.cmml">​</mo><mi id="A3.p2.4.m4.2.2.2.2.2.3" xref="A3.p2.4.m4.2.2.2.2.2.3.cmml">e</mi></mrow><mo id="A3.p2.4.m4.2.2.2.2.1" xref="A3.p2.4.m4.2.2.2.2.1.cmml">−</mo><mn id="A3.p2.4.m4.2.2.2.2.3" xref="A3.p2.4.m4.2.2.2.2.3.cmml">3</mn></mrow><mo stretchy="false" id="A3.p2.4.m4.2.2.2.5" xref="A3.p2.4.m4.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.4.m4.2b"><set id="A3.p2.4.m4.2.2.3.cmml" xref="A3.p2.4.m4.2.2.2"><apply id="A3.p2.4.m4.1.1.1.1.cmml" xref="A3.p2.4.m4.1.1.1.1"><minus id="A3.p2.4.m4.1.1.1.1.1.cmml" xref="A3.p2.4.m4.1.1.1.1.1"></minus><apply id="A3.p2.4.m4.1.1.1.1.2.cmml" xref="A3.p2.4.m4.1.1.1.1.2"><times id="A3.p2.4.m4.1.1.1.1.2.1.cmml" xref="A3.p2.4.m4.1.1.1.1.2.1"></times><cn type="integer" id="A3.p2.4.m4.1.1.1.1.2.2.cmml" xref="A3.p2.4.m4.1.1.1.1.2.2">1</cn><ci id="A3.p2.4.m4.1.1.1.1.2.3.cmml" xref="A3.p2.4.m4.1.1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A3.p2.4.m4.1.1.1.1.3.cmml" xref="A3.p2.4.m4.1.1.1.1.3">4</cn></apply><apply id="A3.p2.4.m4.2.2.2.2.cmml" xref="A3.p2.4.m4.2.2.2.2"><minus id="A3.p2.4.m4.2.2.2.2.1.cmml" xref="A3.p2.4.m4.2.2.2.2.1"></minus><apply id="A3.p2.4.m4.2.2.2.2.2.cmml" xref="A3.p2.4.m4.2.2.2.2.2"><times id="A3.p2.4.m4.2.2.2.2.2.1.cmml" xref="A3.p2.4.m4.2.2.2.2.2.1"></times><cn type="integer" id="A3.p2.4.m4.2.2.2.2.2.2.cmml" xref="A3.p2.4.m4.2.2.2.2.2.2">1</cn><ci id="A3.p2.4.m4.2.2.2.2.2.3.cmml" xref="A3.p2.4.m4.2.2.2.2.2.3">𝑒</ci></apply><cn type="integer" id="A3.p2.4.m4.2.2.2.2.3.cmml" xref="A3.p2.4.m4.2.2.2.2.3">3</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.4.m4.2c">\{1e-4,1e-3\}</annotation></semantics></math> and the best one is reported. For FedOpt, we take SGD with momentum 0.9 as the global optimizer, and tune the global learning rate in <math id="A3.p2.5.m5.3" class="ltx_Math" alttext="\{0.1,0.5,0.9\}" display="inline"><semantics id="A3.p2.5.m5.3a"><mrow id="A3.p2.5.m5.3.4.2" xref="A3.p2.5.m5.3.4.1.cmml"><mo stretchy="false" id="A3.p2.5.m5.3.4.2.1" xref="A3.p2.5.m5.3.4.1.cmml">{</mo><mn id="A3.p2.5.m5.1.1" xref="A3.p2.5.m5.1.1.cmml">0.1</mn><mo id="A3.p2.5.m5.3.4.2.2" xref="A3.p2.5.m5.3.4.1.cmml">,</mo><mn id="A3.p2.5.m5.2.2" xref="A3.p2.5.m5.2.2.cmml">0.5</mn><mo id="A3.p2.5.m5.3.4.2.3" xref="A3.p2.5.m5.3.4.1.cmml">,</mo><mn id="A3.p2.5.m5.3.3" xref="A3.p2.5.m5.3.3.cmml">0.9</mn><mo stretchy="false" id="A3.p2.5.m5.3.4.2.4" xref="A3.p2.5.m5.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.5.m5.3b"><set id="A3.p2.5.m5.3.4.1.cmml" xref="A3.p2.5.m5.3.4.2"><cn type="float" id="A3.p2.5.m5.1.1.cmml" xref="A3.p2.5.m5.1.1">0.1</cn><cn type="float" id="A3.p2.5.m5.2.2.cmml" xref="A3.p2.5.m5.2.2">0.5</cn><cn type="float" id="A3.p2.5.m5.3.3.cmml" xref="A3.p2.5.m5.3.3">0.9</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.5.m5.3c">\{0.1,0.5,0.9\}</annotation></semantics></math>, which is similar to FedAvgM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. We also try using Adam as the global optimizer and find the performances are not stable. For Scaffold, we use the implementation from the online page <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a target="_blank" href="https://github.com/ramshi236/Accelerated-Federated-Learning-Over-MAC-in-Heterogeneous-Networks" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/ramshi236/Accelerated-Federated-Learning-Over-MAC-in-Heterogeneous-Networks</a></span></span></span>. For MOON, we set the coefficient of the contrastive loss as <math id="A3.p2.6.m6.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="A3.p2.6.m6.1a"><mn id="A3.p2.6.m6.1.1" xref="A3.p2.6.m6.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="A3.p2.6.m6.1b"><cn type="float" id="A3.p2.6.m6.1.1.cmml" xref="A3.p2.6.m6.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.6.m6.1c">1.0</annotation></semantics></math>, which is recommended by the authors. We then replace the normal neurons with the proposed PANs to improve these algorithms. We keep <math id="A3.p2.7.m7.1" class="ltx_Math" alttext="T=1" display="inline"><semantics id="A3.p2.7.m7.1a"><mrow id="A3.p2.7.m7.1.1" xref="A3.p2.7.m7.1.1.cmml"><mi id="A3.p2.7.m7.1.1.2" xref="A3.p2.7.m7.1.1.2.cmml">T</mi><mo id="A3.p2.7.m7.1.1.1" xref="A3.p2.7.m7.1.1.1.cmml">=</mo><mn id="A3.p2.7.m7.1.1.3" xref="A3.p2.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.7.m7.1b"><apply id="A3.p2.7.m7.1.1.cmml" xref="A3.p2.7.m7.1.1"><eq id="A3.p2.7.m7.1.1.1.cmml" xref="A3.p2.7.m7.1.1.1"></eq><ci id="A3.p2.7.m7.1.1.2.cmml" xref="A3.p2.7.m7.1.1.2">𝑇</ci><cn type="integer" id="A3.p2.7.m7.1.1.3.cmml" xref="A3.p2.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.7.m7.1c">T=1</annotation></semantics></math> by default and tune hyper-parameters from: PAN<sub id="A3.p2.13.1" class="ltx_sub">+</sub> with <math id="A3.p2.9.m9.1" class="ltx_Math" alttext="A=0.05" display="inline"><semantics id="A3.p2.9.m9.1a"><mrow id="A3.p2.9.m9.1.1" xref="A3.p2.9.m9.1.1.cmml"><mi id="A3.p2.9.m9.1.1.2" xref="A3.p2.9.m9.1.1.2.cmml">A</mi><mo id="A3.p2.9.m9.1.1.1" xref="A3.p2.9.m9.1.1.1.cmml">=</mo><mn id="A3.p2.9.m9.1.1.3" xref="A3.p2.9.m9.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.9.m9.1b"><apply id="A3.p2.9.m9.1.1.cmml" xref="A3.p2.9.m9.1.1"><eq id="A3.p2.9.m9.1.1.1.cmml" xref="A3.p2.9.m9.1.1.1"></eq><ci id="A3.p2.9.m9.1.1.2.cmml" xref="A3.p2.9.m9.1.1.2">𝐴</ci><cn type="float" id="A3.p2.9.m9.1.1.3.cmml" xref="A3.p2.9.m9.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.9.m9.1c">A=0.05</annotation></semantics></math>, PAN<sub id="A3.p2.13.2" class="ltx_sub">∘</sub> with <math id="A3.p2.11.m11.1" class="ltx_Math" alttext="A=0.05" display="inline"><semantics id="A3.p2.11.m11.1a"><mrow id="A3.p2.11.m11.1.1" xref="A3.p2.11.m11.1.1.cmml"><mi id="A3.p2.11.m11.1.1.2" xref="A3.p2.11.m11.1.1.2.cmml">A</mi><mo id="A3.p2.11.m11.1.1.1" xref="A3.p2.11.m11.1.1.1.cmml">=</mo><mn id="A3.p2.11.m11.1.1.3" xref="A3.p2.11.m11.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.11.m11.1b"><apply id="A3.p2.11.m11.1.1.cmml" xref="A3.p2.11.m11.1.1"><eq id="A3.p2.11.m11.1.1.1.cmml" xref="A3.p2.11.m11.1.1.1"></eq><ci id="A3.p2.11.m11.1.1.2.cmml" xref="A3.p2.11.m11.1.1.2">𝐴</ci><cn type="float" id="A3.p2.11.m11.1.1.3.cmml" xref="A3.p2.11.m11.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.11.m11.1c">A=0.05</annotation></semantics></math>, PAN<sub id="A3.p2.13.3" class="ltx_sub">∘</sub> with <math id="A3.p2.13.m13.1" class="ltx_Math" alttext="A=0.1" display="inline"><semantics id="A3.p2.13.m13.1a"><mrow id="A3.p2.13.m13.1.1" xref="A3.p2.13.m13.1.1.cmml"><mi id="A3.p2.13.m13.1.1.2" xref="A3.p2.13.m13.1.1.2.cmml">A</mi><mo id="A3.p2.13.m13.1.1.1" xref="A3.p2.13.m13.1.1.1.cmml">=</mo><mn id="A3.p2.13.m13.1.1.3" xref="A3.p2.13.m13.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.13.m13.1b"><apply id="A3.p2.13.m13.1.1.cmml" xref="A3.p2.13.m13.1.1"><eq id="A3.p2.13.m13.1.1.1.cmml" xref="A3.p2.13.m13.1.1.1"></eq><ci id="A3.p2.13.m13.1.1.2.cmml" xref="A3.p2.13.m13.1.1.2">𝐴</ci><cn type="float" id="A3.p2.13.m13.1.1.3.cmml" xref="A3.p2.13.m13.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.13.m13.1c">A=0.1</annotation></semantics></math>.</p>
</div>
<figure id="A3.F18" class="ltx_figure"><img src="" id="A3.F18.g1" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F18.6.3.1" class="ltx_text" style="font-size:90%;">Figure 18</span>: </span><span id="A3.F18.4.2" class="ltx_text" style="font-size:90%;">Optimal assignment matrix with PANs off/on, left vs. right. (<math id="A3.F18.3.1.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A3.F18.3.1.m1.1b"><mrow id="A3.F18.3.1.m1.1.1" xref="A3.F18.3.1.m1.1.1.cmml"><mi mathsize="78%" id="A3.F18.3.1.m1.1.1.2" xref="A3.F18.3.1.m1.1.1.2.cmml">α</mi><mo mathsize="78%" id="A3.F18.3.1.m1.1.1.1" xref="A3.F18.3.1.m1.1.1.1.cmml">=</mo><mn mathsize="78%" id="A3.F18.3.1.m1.1.1.3" xref="A3.F18.3.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F18.3.1.m1.1c"><apply id="A3.F18.3.1.m1.1.1.cmml" xref="A3.F18.3.1.m1.1.1"><eq id="A3.F18.3.1.m1.1.1.1.cmml" xref="A3.F18.3.1.m1.1.1.1"></eq><ci id="A3.F18.3.1.m1.1.1.2.cmml" xref="A3.F18.3.1.m1.1.1.2">𝛼</ci><cn type="float" id="A3.F18.3.1.m1.1.1.3.cmml" xref="A3.F18.3.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F18.3.1.m1.1d">\alpha=1.0</annotation></semantics></math><span id="A3.F18.4.2.1" class="ltx_text" style="font-size:78%;">, <math id="A3.F18.4.2.1.m1.1" class="ltx_Math" alttext="E=20" display="inline"><semantics id="A3.F18.4.2.1.m1.1b"><mrow id="A3.F18.4.2.1.m1.1.1" xref="A3.F18.4.2.1.m1.1.1.cmml"><mi id="A3.F18.4.2.1.m1.1.1.2" xref="A3.F18.4.2.1.m1.1.1.2.cmml">E</mi><mo id="A3.F18.4.2.1.m1.1.1.1" xref="A3.F18.4.2.1.m1.1.1.1.cmml">=</mo><mn id="A3.F18.4.2.1.m1.1.1.3" xref="A3.F18.4.2.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F18.4.2.1.m1.1c"><apply id="A3.F18.4.2.1.m1.1.1.cmml" xref="A3.F18.4.2.1.m1.1.1"><eq id="A3.F18.4.2.1.m1.1.1.1.cmml" xref="A3.F18.4.2.1.m1.1.1.1"></eq><ci id="A3.F18.4.2.1.m1.1.1.2.cmml" xref="A3.F18.4.2.1.m1.1.1.2">𝐸</ci><cn type="integer" id="A3.F18.4.2.1.m1.1.1.3.cmml" xref="A3.F18.4.2.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F18.4.2.1.m1.1d">E=20</annotation></semantics></math>, VGG9 Conv6 on Cifar10.</span>)</span></figcaption>
</figure>
<figure id="A3.F19" class="ltx_figure"><img src="/html/2203.14666/assets/x21.png" id="A3.F19.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="219" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F19.6.3.1" class="ltx_text" style="font-size:90%;">Figure 19</span>: </span><span id="A3.F19.4.2" class="ltx_text" style="font-size:90%;">Optimal assignment matrix with PANs off/on, left vs. right. (<math id="A3.F19.3.1.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A3.F19.3.1.m1.1b"><mrow id="A3.F19.3.1.m1.1.1" xref="A3.F19.3.1.m1.1.1.cmml"><mi mathsize="78%" id="A3.F19.3.1.m1.1.1.2" xref="A3.F19.3.1.m1.1.1.2.cmml">α</mi><mo mathsize="78%" id="A3.F19.3.1.m1.1.1.1" xref="A3.F19.3.1.m1.1.1.1.cmml">=</mo><mn mathsize="78%" id="A3.F19.3.1.m1.1.1.3" xref="A3.F19.3.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F19.3.1.m1.1c"><apply id="A3.F19.3.1.m1.1.1.cmml" xref="A3.F19.3.1.m1.1.1"><eq id="A3.F19.3.1.m1.1.1.1.cmml" xref="A3.F19.3.1.m1.1.1.1"></eq><ci id="A3.F19.3.1.m1.1.1.2.cmml" xref="A3.F19.3.1.m1.1.1.2">𝛼</ci><cn type="float" id="A3.F19.3.1.m1.1.1.3.cmml" xref="A3.F19.3.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F19.3.1.m1.1d">\alpha=1.0</annotation></semantics></math><span id="A3.F19.4.2.1" class="ltx_text" style="font-size:78%;">, <math id="A3.F19.4.2.1.m1.1" class="ltx_Math" alttext="E=20" display="inline"><semantics id="A3.F19.4.2.1.m1.1b"><mrow id="A3.F19.4.2.1.m1.1.1" xref="A3.F19.4.2.1.m1.1.1.cmml"><mi id="A3.F19.4.2.1.m1.1.1.2" xref="A3.F19.4.2.1.m1.1.1.2.cmml">E</mi><mo id="A3.F19.4.2.1.m1.1.1.1" xref="A3.F19.4.2.1.m1.1.1.1.cmml">=</mo><mn id="A3.F19.4.2.1.m1.1.1.3" xref="A3.F19.4.2.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F19.4.2.1.m1.1c"><apply id="A3.F19.4.2.1.m1.1.1.cmml" xref="A3.F19.4.2.1.m1.1.1"><eq id="A3.F19.4.2.1.m1.1.1.1.cmml" xref="A3.F19.4.2.1.m1.1.1.1"></eq><ci id="A3.F19.4.2.1.m1.1.1.2.cmml" xref="A3.F19.4.2.1.m1.1.1.2">𝐸</ci><cn type="integer" id="A3.F19.4.2.1.m1.1.1.3.cmml" xref="A3.F19.4.2.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F19.4.2.1.m1.1d">E=20</annotation></semantics></math>, MLP FC3 on Mnist.</span>)</span></figcaption>
</figure>
<figure id="A3.F20" class="ltx_figure"><img src="/html/2203.14666/assets/x22.png" id="A3.F20.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="185" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F20.5.2.1" class="ltx_text" style="font-size:90%;">Figure 20</span>: </span><span id="A3.F20.2.1" class="ltx_text" style="font-size:90%;">Preference vectors with PANs off/on, left vs. right. (<math id="A3.F20.2.1.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A3.F20.2.1.m1.1b"><mrow id="A3.F20.2.1.m1.1.1" xref="A3.F20.2.1.m1.1.1.cmml"><mi mathsize="78%" id="A3.F20.2.1.m1.1.1.2" xref="A3.F20.2.1.m1.1.1.2.cmml">α</mi><mo mathsize="78%" id="A3.F20.2.1.m1.1.1.1" xref="A3.F20.2.1.m1.1.1.1.cmml">=</mo><mn mathsize="78%" id="A3.F20.2.1.m1.1.1.3" xref="A3.F20.2.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F20.2.1.m1.1c"><apply id="A3.F20.2.1.m1.1.1.cmml" xref="A3.F20.2.1.m1.1.1"><eq id="A3.F20.2.1.m1.1.1.1.cmml" xref="A3.F20.2.1.m1.1.1.1"></eq><ci id="A3.F20.2.1.m1.1.1.2.cmml" xref="A3.F20.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="A3.F20.2.1.m1.1.1.3.cmml" xref="A3.F20.2.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F20.2.1.m1.1d">\alpha=1.0</annotation></semantics></math><span id="A3.F20.2.1.1" class="ltx_text" style="font-size:78%;">, VGG9 Conv5 on Cifar10.</span>)</span></figcaption>
</figure>
<figure id="A3.F21" class="ltx_figure"><img src="/html/2203.14666/assets/x23.png" id="A3.F21.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="185" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F21.5.2.1" class="ltx_text" style="font-size:90%;">Figure 21</span>: </span><span id="A3.F21.2.1" class="ltx_text" style="font-size:90%;">Preference vectors with PANs off/on, left vs. right. (<math id="A3.F21.2.1.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A3.F21.2.1.m1.1b"><mrow id="A3.F21.2.1.m1.1.1" xref="A3.F21.2.1.m1.1.1.cmml"><mi mathsize="78%" id="A3.F21.2.1.m1.1.1.2" xref="A3.F21.2.1.m1.1.1.2.cmml">α</mi><mo mathsize="78%" id="A3.F21.2.1.m1.1.1.1" xref="A3.F21.2.1.m1.1.1.1.cmml">=</mo><mn mathsize="78%" id="A3.F21.2.1.m1.1.1.3" xref="A3.F21.2.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F21.2.1.m1.1c"><apply id="A3.F21.2.1.m1.1.1.cmml" xref="A3.F21.2.1.m1.1.1"><eq id="A3.F21.2.1.m1.1.1.1.cmml" xref="A3.F21.2.1.m1.1.1.1"></eq><ci id="A3.F21.2.1.m1.1.1.2.cmml" xref="A3.F21.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="A3.F21.2.1.m1.1.1.3.cmml" xref="A3.F21.2.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F21.2.1.m1.1d">\alpha=1.0</annotation></semantics></math><span id="A3.F21.2.1.1" class="ltx_text" style="font-size:78%;">, VGG9 Conv4 on Cifar10.</span>)</span></figcaption>
</figure>
<figure id="A3.F22" class="ltx_figure"><img src="/html/2203.14666/assets/x24.png" id="A3.F22.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="185" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F22.5.2.1" class="ltx_text" style="font-size:90%;">Figure 22</span>: </span><span id="A3.F22.2.1" class="ltx_text" style="font-size:90%;">Preference vectors with PANs off/on, left vs. right. (<math id="A3.F22.2.1.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A3.F22.2.1.m1.1b"><mrow id="A3.F22.2.1.m1.1.1" xref="A3.F22.2.1.m1.1.1.cmml"><mi mathsize="78%" id="A3.F22.2.1.m1.1.1.2" xref="A3.F22.2.1.m1.1.1.2.cmml">α</mi><mo mathsize="78%" id="A3.F22.2.1.m1.1.1.1" xref="A3.F22.2.1.m1.1.1.1.cmml">=</mo><mn mathsize="78%" id="A3.F22.2.1.m1.1.1.3" xref="A3.F22.2.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F22.2.1.m1.1c"><apply id="A3.F22.2.1.m1.1.1.cmml" xref="A3.F22.2.1.m1.1.1"><eq id="A3.F22.2.1.m1.1.1.1.cmml" xref="A3.F22.2.1.m1.1.1.1"></eq><ci id="A3.F22.2.1.m1.1.1.2.cmml" xref="A3.F22.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="A3.F22.2.1.m1.1.1.3.cmml" xref="A3.F22.2.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F22.2.1.m1.1d">\alpha=1.0</annotation></semantics></math><span id="A3.F22.2.1.1" class="ltx_text" style="font-size:78%;">, MLP FC4 on Mnist.</span>)</span></figcaption>
</figure>
<figure id="A3.F23" class="ltx_figure"><img src="/html/2203.14666/assets/x25.png" id="A3.F23.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="185" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F23.5.2.1" class="ltx_text" style="font-size:90%;">Figure 23</span>: </span><span id="A3.F23.2.1" class="ltx_text" style="font-size:90%;">Preference vectors with PANs off/on, left vs. right. (<math id="A3.F23.2.1.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A3.F23.2.1.m1.1b"><mrow id="A3.F23.2.1.m1.1.1" xref="A3.F23.2.1.m1.1.1.cmml"><mi mathsize="78%" id="A3.F23.2.1.m1.1.1.2" xref="A3.F23.2.1.m1.1.1.2.cmml">α</mi><mo mathsize="78%" id="A3.F23.2.1.m1.1.1.1" xref="A3.F23.2.1.m1.1.1.1.cmml">=</mo><mn mathsize="78%" id="A3.F23.2.1.m1.1.1.3" xref="A3.F23.2.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.F23.2.1.m1.1c"><apply id="A3.F23.2.1.m1.1.1.cmml" xref="A3.F23.2.1.m1.1.1"><eq id="A3.F23.2.1.m1.1.1.1.cmml" xref="A3.F23.2.1.m1.1.1.1"></eq><ci id="A3.F23.2.1.m1.1.1.2.cmml" xref="A3.F23.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="A3.F23.2.1.m1.1.1.3.cmml" xref="A3.F23.2.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F23.2.1.m1.1d">\alpha=1.0</annotation></semantics></math><span id="A3.F23.2.1.1" class="ltx_text" style="font-size:78%;">, MLP FC3 on Mnist.</span>)</span></figcaption>
</figure>
<figure id="A3.F24" class="ltx_figure"><img src="/html/2203.14666/assets/x26.png" id="A3.F24.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="141" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F24.4.2.1" class="ltx_text" style="font-size:90%;">Figure 24</span>: </span><span id="A3.F24.2.1" class="ltx_text" style="font-size:90%;">Comparison results on non-i.i.d. data (<math id="A3.F24.2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A3.F24.2.1.m1.1b"><mi id="A3.F24.2.1.m1.1.1" xref="A3.F24.2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A3.F24.2.1.m1.1c"><ci id="A3.F24.2.1.m1.1.1.cmml" xref="A3.F24.2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F24.2.1.m1.1d">\alpha</annotation></semantics></math>=0.1). Rows show datasets and columns show FL algorithms. PANs could universally improve these algorithms.</span></figcaption>
</figure>
<figure id="A3.F25" class="ltx_figure"><img src="/html/2203.14666/assets/x27.png" id="A3.F25.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="163" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F25.4.2.1" class="ltx_text" style="font-size:90%;">Figure 25</span>: </span><span id="A3.F25.2.1" class="ltx_text" style="font-size:90%;">Comparisons under various levels of non-i.i.d. data on Cifar10. Smaller <math id="A3.F25.2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A3.F25.2.1.m1.1b"><mi id="A3.F25.2.1.m1.1.1" xref="A3.F25.2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A3.F25.2.1.m1.1c"><ci id="A3.F25.2.1.m1.1.1.cmml" xref="A3.F25.2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F25.2.1.m1.1d">\alpha</annotation></semantics></math> implies more non-i.i.d. data.</span></figcaption>
</figure>
<figure id="A3.F26" class="ltx_figure"><img src="/html/2203.14666/assets/x28.png" id="A3.F26.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="162" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F26.4.2.1" class="ltx_text" style="font-size:90%;">Figure 26</span>: </span><span id="A3.F26.2.1" class="ltx_text" style="font-size:90%;">Comparisons under various levels of non-i.i.d. data on Cifar100. Smaller <math id="A3.F26.2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A3.F26.2.1.m1.1b"><mi id="A3.F26.2.1.m1.1.1" xref="A3.F26.2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A3.F26.2.1.m1.1c"><ci id="A3.F26.2.1.m1.1.1.cmml" xref="A3.F26.2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F26.2.1.m1.1d">\alpha</annotation></semantics></math> implies more non-i.i.d. data.</span></figcaption>
</figure>
<figure id="A3.F27" class="ltx_figure"><img src="/html/2203.14666/assets/x29.png" id="A3.F27.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="218" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F27.6.3.1" class="ltx_text" style="font-size:90%;">Figure 27</span>: </span><span id="A3.F27.4.2" class="ltx_text" style="font-size:90%;">Comparisons under different FL scenes (<math id="A3.F27.3.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A3.F27.3.1.m1.1b"><mi id="A3.F27.3.1.m1.1.1" xref="A3.F27.3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.F27.3.1.m1.1c"><ci id="A3.F27.3.1.m1.1.1.cmml" xref="A3.F27.3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F27.3.1.m1.1d">K</annotation></semantics></math>, <math id="A3.F27.4.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="A3.F27.4.2.m2.1b"><mi id="A3.F27.4.2.m2.1.1" xref="A3.F27.4.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A3.F27.4.2.m2.1c"><ci id="A3.F27.4.2.m2.1.1.cmml" xref="A3.F27.4.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.F27.4.2.m2.1d">E</annotation></semantics></math>) based on Scaffold.</span></figcaption>
</figure>
<figure id="A3.F28" class="ltx_figure"><img src="/html/2203.14666/assets/x30.png" id="A3.F28.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="111" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F28.2.1.1" class="ltx_text" style="font-size:90%;">Figure 28</span>: </span><span id="A3.F28.3.2" class="ltx_text" style="font-size:90%;">Hyper-parameter analysis on Cifar10 with VGG11.</span></figcaption>
</figure>
<figure id="A3.F29" class="ltx_figure"><img src="/html/2203.14666/assets/x31.png" id="A3.F29.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="111" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F29.2.1.1" class="ltx_text" style="font-size:90%;">Figure 29</span>: </span><span id="A3.F29.3.2" class="ltx_text" style="font-size:90%;">Hyper-parameter analysis on Cifar100 with ResNet20.</span></figcaption>
</figure>
<figure id="A3.T3" class="ltx_table">
<table id="A3.T3.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A3.T3.2.1.1" class="ltx_tr">
<td id="A3.T3.2.1.1.1" class="ltx_td ltx_border_tt"></td>
<th id="A3.T3.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FeMnist</th>
<th id="A3.T3.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">GTSRB</th>
<th id="A3.T3.2.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">SVHN</th>
<th id="A3.T3.2.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Cifar10</th>
<th id="A3.T3.2.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Cifar100</th>
<th id="A3.T3.2.1.1.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">Cinic10</th>
</tr>
<tr id="A3.T3.2.2.2" class="ltx_tr">
<td id="A3.T3.2.2.2.1" class="ltx_td"></td>
<td id="A3.T3.2.2.2.2" class="ltx_td ltx_align_center">MLP</td>
<td id="A3.T3.2.2.2.3" class="ltx_td ltx_align_center">VGG9</td>
<td id="A3.T3.2.2.2.4" class="ltx_td ltx_align_center">VGG9</td>
<td id="A3.T3.2.2.2.5" class="ltx_td ltx_align_center">VGG11</td>
<td id="A3.T3.2.2.2.6" class="ltx_td ltx_align_center">ResNet20</td>
<td id="A3.T3.2.2.2.7" class="ltx_td ltx_nopad_r ltx_align_center">ResNet20</td>
</tr>
<tr id="A3.T3.2.3.3" class="ltx_tr">
<th id="A3.T3.2.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">SGD + Momentum=0.9 (LR in {0.05,0.1})</th>
<th id="A3.T3.2.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">53.39</th>
<th id="A3.T3.2.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">86.96</th>
<th id="A3.T3.2.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">89.93</th>
<th id="A3.T3.2.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">84.57</th>
<th id="A3.T3.2.3.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">70.82</th>
<th id="A3.T3.2.3.3.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t">82.76</th>
</tr>
<tr id="A3.T3.2.4.4" class="ltx_tr">
<td id="A3.T3.2.4.4.1" class="ltx_td ltx_align_center ltx_border_bb">Adam (LR=3e-4)</td>
<td id="A3.T3.2.4.4.2" class="ltx_td ltx_align_center ltx_border_bb">54.25</td>
<td id="A3.T3.2.4.4.3" class="ltx_td ltx_align_center ltx_border_bb">90.84</td>
<td id="A3.T3.2.4.4.4" class="ltx_td ltx_align_center ltx_border_bb">91.13</td>
<td id="A3.T3.2.4.4.5" class="ltx_td ltx_align_center ltx_border_bb">87.13</td>
<td id="A3.T3.2.4.4.6" class="ltx_td ltx_align_center ltx_border_bb">67.22</td>
<td id="A3.T3.2.4.4.7" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb">81.99</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A3.T3.4.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="A3.T3.5.2" class="ltx_text" style="font-size:90%;">The performances of centralized training with corresponding networks (without PANs), i.e., the <span id="A3.T3.5.2.1" class="ltx_text ltx_font_bold">upper bound of decentralized training</span> (FL).</span></figcaption>
</figure>
<figure id="A3.F30" class="ltx_figure"><img src="/html/2203.14666/assets/x32.png" id="A3.F30.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="157" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F30.2.1.1" class="ltx_text" style="font-size:90%;">Figure 30</span>: </span><span id="A3.F30.3.2" class="ltx_text" style="font-size:90%;">Performances of centralized training with PANs. The two parts respectively show the results of additive PANs and multiplicative PANs.</span></figcaption>
</figure>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Experimental Details</h2>

<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Shuffle Test and Shuffle Test in FL</h3>

<div id="A4.SS1.p1" class="ltx_para">
<p id="A4.SS1.p1.2" class="ltx_p">We propose a procedure to measure the degree of permutation invariance of a certain neural network, that is, how large the shuffle error is after shuffling the neurons. The shuffle process is shown in Alg. <a href="#alg1" title="Algorithm 1 ‣ Appendix A Dataset Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, where <math id="A4.SS1.p1.1.m1.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="A4.SS1.p1.1.m1.1a"><msub id="A4.SS1.p1.1.m1.1.1" xref="A4.SS1.p1.1.m1.1.1.cmml"><mi id="A4.SS1.p1.1.m1.1.1.2" xref="A4.SS1.p1.1.m1.1.1.2.cmml">P</mi><mtext id="A4.SS1.p1.1.m1.1.1.3" xref="A4.SS1.p1.1.m1.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.1.m1.1b"><apply id="A4.SS1.p1.1.m1.1.1.cmml" xref="A4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS1.p1.1.m1.1.1.1.cmml" xref="A4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="A4.SS1.p1.1.m1.1.1.2.cmml" xref="A4.SS1.p1.1.m1.1.1.2">𝑃</ci><ci id="A4.SS1.p1.1.m1.1.1.3a.cmml" xref="A4.SS1.p1.1.m1.1.1.3"><mtext mathsize="70%" id="A4.SS1.p1.1.m1.1.1.3.cmml" xref="A4.SS1.p1.1.m1.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.1.m1.1c">P_{\text{sf}}</annotation></semantics></math> controls the disorder level of the constructed permutation matrices. Some additional descriptions are: (1) the permutation matrix (PM) should be randomly generated and we don’t need to solve it; (2) PMs are introduced just to verify the property of PANs that they can disable the permutation invariance of neural networks, which is not used in our FedPAN algorithm; (3) the computational complexity is <math id="A4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{O}(J)" display="inline"><semantics id="A4.SS1.p1.2.m2.1a"><mrow id="A4.SS1.p1.2.m2.1.2" xref="A4.SS1.p1.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A4.SS1.p1.2.m2.1.2.2" xref="A4.SS1.p1.2.m2.1.2.2.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="A4.SS1.p1.2.m2.1.2.1" xref="A4.SS1.p1.2.m2.1.2.1.cmml">​</mo><mrow id="A4.SS1.p1.2.m2.1.2.3.2" xref="A4.SS1.p1.2.m2.1.2.cmml"><mo stretchy="false" id="A4.SS1.p1.2.m2.1.2.3.2.1" xref="A4.SS1.p1.2.m2.1.2.cmml">(</mo><mi id="A4.SS1.p1.2.m2.1.1" xref="A4.SS1.p1.2.m2.1.1.cmml">J</mi><mo stretchy="false" id="A4.SS1.p1.2.m2.1.2.3.2.2" xref="A4.SS1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p1.2.m2.1b"><apply id="A4.SS1.p1.2.m2.1.2.cmml" xref="A4.SS1.p1.2.m2.1.2"><times id="A4.SS1.p1.2.m2.1.2.1.cmml" xref="A4.SS1.p1.2.m2.1.2.1"></times><ci id="A4.SS1.p1.2.m2.1.2.2.cmml" xref="A4.SS1.p1.2.m2.1.2.2">𝒪</ci><ci id="A4.SS1.p1.2.m2.1.1.cmml" xref="A4.SS1.p1.2.m2.1.1">𝐽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p1.2.m2.1c">\mathcal{O}(J)</annotation></semantics></math>, requiring at most J swaps, which is very efficient to implement during simulation.</p>
</div>
<div id="A4.SS1.p2" class="ltx_para">
<p id="A4.SS1.p2.17" class="ltx_p">We introduce the shuffle test in the body of this paper. Specifically, we manually shuffle the network and study the output change, i.e., the shuffle error defined in the body. A hyper-parameter <math id="A4.SS1.p2.1.m1.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="A4.SS1.p2.1.m1.1a"><msub id="A4.SS1.p2.1.m1.1.1" xref="A4.SS1.p2.1.m1.1.1.cmml"><mi id="A4.SS1.p2.1.m1.1.1.2" xref="A4.SS1.p2.1.m1.1.1.2.cmml">P</mi><mtext id="A4.SS1.p2.1.m1.1.1.3" xref="A4.SS1.p2.1.m1.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.1.m1.1b"><apply id="A4.SS1.p2.1.m1.1.1.cmml" xref="A4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.1.m1.1.1.1.cmml" xref="A4.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="A4.SS1.p2.1.m1.1.1.2.cmml" xref="A4.SS1.p2.1.m1.1.1.2">𝑃</ci><ci id="A4.SS1.p2.1.m1.1.1.3a.cmml" xref="A4.SS1.p2.1.m1.1.1.3"><mtext mathsize="70%" id="A4.SS1.p2.1.m1.1.1.3.cmml" xref="A4.SS1.p2.1.m1.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.1.m1.1c">P_{\text{sf}}</annotation></semantics></math> is used to control the disorder of permutation. Given a <math id="A4.SS1.p2.2.m2.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="A4.SS1.p2.2.m2.1a"><msub id="A4.SS1.p2.2.m2.1.1" xref="A4.SS1.p2.2.m2.1.1.cmml"><mi id="A4.SS1.p2.2.m2.1.1.2" xref="A4.SS1.p2.2.m2.1.1.2.cmml">P</mi><mtext id="A4.SS1.p2.2.m2.1.1.3" xref="A4.SS1.p2.2.m2.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.2.m2.1b"><apply id="A4.SS1.p2.2.m2.1.1.cmml" xref="A4.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.2.m2.1.1.1.cmml" xref="A4.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="A4.SS1.p2.2.m2.1.1.2.cmml" xref="A4.SS1.p2.2.m2.1.1.2">𝑃</ci><ci id="A4.SS1.p2.2.m2.1.1.3a.cmml" xref="A4.SS1.p2.2.m2.1.1.3"><mtext mathsize="70%" id="A4.SS1.p2.2.m2.1.1.3.cmml" xref="A4.SS1.p2.2.m2.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.2.m2.1c">P_{\text{sf}}</annotation></semantics></math>, we could generate a permutation matrix <math id="A4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\Pi" display="inline"><semantics id="A4.SS1.p2.3.m3.1a"><mi mathvariant="normal" id="A4.SS1.p2.3.m3.1.1" xref="A4.SS1.p2.3.m3.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.3.m3.1b"><ci id="A4.SS1.p2.3.m3.1.1.cmml" xref="A4.SS1.p2.3.m3.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.3.m3.1c">\Pi</annotation></semantics></math>, then we calculate how many neurons are not shuffled via computing “<math id="A4.SS1.p2.4.m4.1" class="ltx_Math" alttext="R_{\text{kept}}" display="inline"><semantics id="A4.SS1.p2.4.m4.1a"><msub id="A4.SS1.p2.4.m4.1.1" xref="A4.SS1.p2.4.m4.1.1.cmml"><mi id="A4.SS1.p2.4.m4.1.1.2" xref="A4.SS1.p2.4.m4.1.1.2.cmml">R</mi><mtext id="A4.SS1.p2.4.m4.1.1.3" xref="A4.SS1.p2.4.m4.1.1.3a.cmml">kept</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.4.m4.1b"><apply id="A4.SS1.p2.4.m4.1.1.cmml" xref="A4.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.4.m4.1.1.1.cmml" xref="A4.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="A4.SS1.p2.4.m4.1.1.2.cmml" xref="A4.SS1.p2.4.m4.1.1.2">𝑅</ci><ci id="A4.SS1.p2.4.m4.1.1.3a.cmml" xref="A4.SS1.p2.4.m4.1.1.3"><mtext mathsize="70%" id="A4.SS1.p2.4.m4.1.1.3.cmml" xref="A4.SS1.p2.4.m4.1.1.3">kept</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.4.m4.1c">R_{\text{kept}}</annotation></semantics></math>=np.mean(np.diag(<math id="A4.SS1.p2.5.m5.1" class="ltx_Math" alttext="\Pi" display="inline"><semantics id="A4.SS1.p2.5.m5.1a"><mi mathvariant="normal" id="A4.SS1.p2.5.m5.1.1" xref="A4.SS1.p2.5.m5.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.5.m5.1b"><ci id="A4.SS1.p2.5.m5.1.1.cmml" xref="A4.SS1.p2.5.m5.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.5.m5.1c">\Pi</annotation></semantics></math>))”. We use the functions provided in the Numpy <span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a target="_blank" href="https://numpy.org/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://numpy.org/</a></span></span></span> package. This is calculated and its correspondence to <math id="A4.SS1.p2.6.m6.1" class="ltx_Math" alttext="P_{\text{sf}}" display="inline"><semantics id="A4.SS1.p2.6.m6.1a"><msub id="A4.SS1.p2.6.m6.1.1" xref="A4.SS1.p2.6.m6.1.1.cmml"><mi id="A4.SS1.p2.6.m6.1.1.2" xref="A4.SS1.p2.6.m6.1.1.2.cmml">P</mi><mtext id="A4.SS1.p2.6.m6.1.1.3" xref="A4.SS1.p2.6.m6.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.6.m6.1b"><apply id="A4.SS1.p2.6.m6.1.1.cmml" xref="A4.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.6.m6.1.1.1.cmml" xref="A4.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="A4.SS1.p2.6.m6.1.1.2.cmml" xref="A4.SS1.p2.6.m6.1.1.2">𝑃</ci><ci id="A4.SS1.p2.6.m6.1.1.3a.cmml" xref="A4.SS1.p2.6.m6.1.1.3"><mtext mathsize="70%" id="A4.SS1.p2.6.m6.1.1.3.cmml" xref="A4.SS1.p2.6.m6.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.6.m6.1c">P_{\text{sf}}</annotation></semantics></math> is shown in the body.
The shuffle process is also applied to FL. Specifically, we present the Pseudo-Code in Alg. <a href="#alg2" title="Algorithm 2 ‣ Appendix A Dataset Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Easily, the model will be shuffled for <math id="A4.SS1.p2.7.m7.1" class="ltx_Math" alttext="N_{\text{sf}}" display="inline"><semantics id="A4.SS1.p2.7.m7.1a"><msub id="A4.SS1.p2.7.m7.1.1" xref="A4.SS1.p2.7.m7.1.1.cmml"><mi id="A4.SS1.p2.7.m7.1.1.2" xref="A4.SS1.p2.7.m7.1.1.2.cmml">N</mi><mtext id="A4.SS1.p2.7.m7.1.1.3" xref="A4.SS1.p2.7.m7.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.7.m7.1b"><apply id="A4.SS1.p2.7.m7.1.1.cmml" xref="A4.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.7.m7.1.1.1.cmml" xref="A4.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="A4.SS1.p2.7.m7.1.1.2.cmml" xref="A4.SS1.p2.7.m7.1.1.2">𝑁</ci><ci id="A4.SS1.p2.7.m7.1.1.3a.cmml" xref="A4.SS1.p2.7.m7.1.1.3"><mtext mathsize="70%" id="A4.SS1.p2.7.m7.1.1.3.cmml" xref="A4.SS1.p2.7.m7.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.7.m7.1c">N_{\text{sf}}</annotation></semantics></math> times during local training in expectation. Hence, we calculate the corresponding <math id="A4.SS1.p2.8.m8.1" class="ltx_Math" alttext="R_{\text{kept}}" display="inline"><semantics id="A4.SS1.p2.8.m8.1a"><msub id="A4.SS1.p2.8.m8.1.1" xref="A4.SS1.p2.8.m8.1.1.cmml"><mi id="A4.SS1.p2.8.m8.1.1.2" xref="A4.SS1.p2.8.m8.1.1.2.cmml">R</mi><mtext id="A4.SS1.p2.8.m8.1.1.3" xref="A4.SS1.p2.8.m8.1.1.3a.cmml">kept</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.8.m8.1b"><apply id="A4.SS1.p2.8.m8.1.1.cmml" xref="A4.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.8.m8.1.1.1.cmml" xref="A4.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="A4.SS1.p2.8.m8.1.1.2.cmml" xref="A4.SS1.p2.8.m8.1.1.2">𝑅</ci><ci id="A4.SS1.p2.8.m8.1.1.3a.cmml" xref="A4.SS1.p2.8.m8.1.1.3"><mtext mathsize="70%" id="A4.SS1.p2.8.m8.1.1.3.cmml" xref="A4.SS1.p2.8.m8.1.1.3">kept</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.8.m8.1c">R_{\text{kept}}</annotation></semantics></math> as the diagonal ones after several accumulative permutation, i.e., “<math id="A4.SS1.p2.9.m9.1" class="ltx_Math" alttext="R_{\text{kept}}" display="inline"><semantics id="A4.SS1.p2.9.m9.1a"><msub id="A4.SS1.p2.9.m9.1.1" xref="A4.SS1.p2.9.m9.1.1.cmml"><mi id="A4.SS1.p2.9.m9.1.1.2" xref="A4.SS1.p2.9.m9.1.1.2.cmml">R</mi><mtext id="A4.SS1.p2.9.m9.1.1.3" xref="A4.SS1.p2.9.m9.1.1.3a.cmml">kept</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.9.m9.1b"><apply id="A4.SS1.p2.9.m9.1.1.cmml" xref="A4.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.9.m9.1.1.1.cmml" xref="A4.SS1.p2.9.m9.1.1">subscript</csymbol><ci id="A4.SS1.p2.9.m9.1.1.2.cmml" xref="A4.SS1.p2.9.m9.1.1.2">𝑅</ci><ci id="A4.SS1.p2.9.m9.1.1.3a.cmml" xref="A4.SS1.p2.9.m9.1.1.3"><mtext mathsize="70%" id="A4.SS1.p2.9.m9.1.1.3.cmml" xref="A4.SS1.p2.9.m9.1.1.3">kept</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.9.m9.1c">R_{\text{kept}}</annotation></semantics></math>=np.mean(np.diag(<math id="A4.SS1.p2.10.m10.1" class="ltx_Math" alttext="\Pi_{r_{k}}\cdots\Pi_{2}\Pi_{1}" display="inline"><semantics id="A4.SS1.p2.10.m10.1a"><mrow id="A4.SS1.p2.10.m10.1.1" xref="A4.SS1.p2.10.m10.1.1.cmml"><msub id="A4.SS1.p2.10.m10.1.1.2" xref="A4.SS1.p2.10.m10.1.1.2.cmml"><mi mathvariant="normal" id="A4.SS1.p2.10.m10.1.1.2.2" xref="A4.SS1.p2.10.m10.1.1.2.2.cmml">Π</mi><msub id="A4.SS1.p2.10.m10.1.1.2.3" xref="A4.SS1.p2.10.m10.1.1.2.3.cmml"><mi id="A4.SS1.p2.10.m10.1.1.2.3.2" xref="A4.SS1.p2.10.m10.1.1.2.3.2.cmml">r</mi><mi id="A4.SS1.p2.10.m10.1.1.2.3.3" xref="A4.SS1.p2.10.m10.1.1.2.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="A4.SS1.p2.10.m10.1.1.1" xref="A4.SS1.p2.10.m10.1.1.1.cmml">​</mo><mi mathvariant="normal" id="A4.SS1.p2.10.m10.1.1.3" xref="A4.SS1.p2.10.m10.1.1.3.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="A4.SS1.p2.10.m10.1.1.1a" xref="A4.SS1.p2.10.m10.1.1.1.cmml">​</mo><msub id="A4.SS1.p2.10.m10.1.1.4" xref="A4.SS1.p2.10.m10.1.1.4.cmml"><mi mathvariant="normal" id="A4.SS1.p2.10.m10.1.1.4.2" xref="A4.SS1.p2.10.m10.1.1.4.2.cmml">Π</mi><mn id="A4.SS1.p2.10.m10.1.1.4.3" xref="A4.SS1.p2.10.m10.1.1.4.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="A4.SS1.p2.10.m10.1.1.1b" xref="A4.SS1.p2.10.m10.1.1.1.cmml">​</mo><msub id="A4.SS1.p2.10.m10.1.1.5" xref="A4.SS1.p2.10.m10.1.1.5.cmml"><mi mathvariant="normal" id="A4.SS1.p2.10.m10.1.1.5.2" xref="A4.SS1.p2.10.m10.1.1.5.2.cmml">Π</mi><mn id="A4.SS1.p2.10.m10.1.1.5.3" xref="A4.SS1.p2.10.m10.1.1.5.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.10.m10.1b"><apply id="A4.SS1.p2.10.m10.1.1.cmml" xref="A4.SS1.p2.10.m10.1.1"><times id="A4.SS1.p2.10.m10.1.1.1.cmml" xref="A4.SS1.p2.10.m10.1.1.1"></times><apply id="A4.SS1.p2.10.m10.1.1.2.cmml" xref="A4.SS1.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="A4.SS1.p2.10.m10.1.1.2.1.cmml" xref="A4.SS1.p2.10.m10.1.1.2">subscript</csymbol><ci id="A4.SS1.p2.10.m10.1.1.2.2.cmml" xref="A4.SS1.p2.10.m10.1.1.2.2">Π</ci><apply id="A4.SS1.p2.10.m10.1.1.2.3.cmml" xref="A4.SS1.p2.10.m10.1.1.2.3"><csymbol cd="ambiguous" id="A4.SS1.p2.10.m10.1.1.2.3.1.cmml" xref="A4.SS1.p2.10.m10.1.1.2.3">subscript</csymbol><ci id="A4.SS1.p2.10.m10.1.1.2.3.2.cmml" xref="A4.SS1.p2.10.m10.1.1.2.3.2">𝑟</ci><ci id="A4.SS1.p2.10.m10.1.1.2.3.3.cmml" xref="A4.SS1.p2.10.m10.1.1.2.3.3">𝑘</ci></apply></apply><ci id="A4.SS1.p2.10.m10.1.1.3.cmml" xref="A4.SS1.p2.10.m10.1.1.3">⋯</ci><apply id="A4.SS1.p2.10.m10.1.1.4.cmml" xref="A4.SS1.p2.10.m10.1.1.4"><csymbol cd="ambiguous" id="A4.SS1.p2.10.m10.1.1.4.1.cmml" xref="A4.SS1.p2.10.m10.1.1.4">subscript</csymbol><ci id="A4.SS1.p2.10.m10.1.1.4.2.cmml" xref="A4.SS1.p2.10.m10.1.1.4.2">Π</ci><cn type="integer" id="A4.SS1.p2.10.m10.1.1.4.3.cmml" xref="A4.SS1.p2.10.m10.1.1.4.3">2</cn></apply><apply id="A4.SS1.p2.10.m10.1.1.5.cmml" xref="A4.SS1.p2.10.m10.1.1.5"><csymbol cd="ambiguous" id="A4.SS1.p2.10.m10.1.1.5.1.cmml" xref="A4.SS1.p2.10.m10.1.1.5">subscript</csymbol><ci id="A4.SS1.p2.10.m10.1.1.5.2.cmml" xref="A4.SS1.p2.10.m10.1.1.5.2">Π</ci><cn type="integer" id="A4.SS1.p2.10.m10.1.1.5.3.cmml" xref="A4.SS1.p2.10.m10.1.1.5.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.10.m10.1c">\Pi_{r_{k}}\cdots\Pi_{2}\Pi_{1}</annotation></semantics></math>))”, where <math id="A4.SS1.p2.11.m11.1" class="ltx_Math" alttext="\Pi_{1}" display="inline"><semantics id="A4.SS1.p2.11.m11.1a"><msub id="A4.SS1.p2.11.m11.1.1" xref="A4.SS1.p2.11.m11.1.1.cmml"><mi mathvariant="normal" id="A4.SS1.p2.11.m11.1.1.2" xref="A4.SS1.p2.11.m11.1.1.2.cmml">Π</mi><mn id="A4.SS1.p2.11.m11.1.1.3" xref="A4.SS1.p2.11.m11.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.11.m11.1b"><apply id="A4.SS1.p2.11.m11.1.1.cmml" xref="A4.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.11.m11.1.1.1.cmml" xref="A4.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="A4.SS1.p2.11.m11.1.1.2.cmml" xref="A4.SS1.p2.11.m11.1.1.2">Π</ci><cn type="integer" id="A4.SS1.p2.11.m11.1.1.3.cmml" xref="A4.SS1.p2.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.11.m11.1c">\Pi_{1}</annotation></semantics></math>, <math id="A4.SS1.p2.12.m12.1" class="ltx_Math" alttext="\Pi_{2}" display="inline"><semantics id="A4.SS1.p2.12.m12.1a"><msub id="A4.SS1.p2.12.m12.1.1" xref="A4.SS1.p2.12.m12.1.1.cmml"><mi mathvariant="normal" id="A4.SS1.p2.12.m12.1.1.2" xref="A4.SS1.p2.12.m12.1.1.2.cmml">Π</mi><mn id="A4.SS1.p2.12.m12.1.1.3" xref="A4.SS1.p2.12.m12.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.12.m12.1b"><apply id="A4.SS1.p2.12.m12.1.1.cmml" xref="A4.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.12.m12.1.1.1.cmml" xref="A4.SS1.p2.12.m12.1.1">subscript</csymbol><ci id="A4.SS1.p2.12.m12.1.1.2.cmml" xref="A4.SS1.p2.12.m12.1.1.2">Π</ci><cn type="integer" id="A4.SS1.p2.12.m12.1.1.3.cmml" xref="A4.SS1.p2.12.m12.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.12.m12.1c">\Pi_{2}</annotation></semantics></math>, and <math id="A4.SS1.p2.13.m13.1" class="ltx_Math" alttext="\Pi_{r_{k}}" display="inline"><semantics id="A4.SS1.p2.13.m13.1a"><msub id="A4.SS1.p2.13.m13.1.1" xref="A4.SS1.p2.13.m13.1.1.cmml"><mi mathvariant="normal" id="A4.SS1.p2.13.m13.1.1.2" xref="A4.SS1.p2.13.m13.1.1.2.cmml">Π</mi><msub id="A4.SS1.p2.13.m13.1.1.3" xref="A4.SS1.p2.13.m13.1.1.3.cmml"><mi id="A4.SS1.p2.13.m13.1.1.3.2" xref="A4.SS1.p2.13.m13.1.1.3.2.cmml">r</mi><mi id="A4.SS1.p2.13.m13.1.1.3.3" xref="A4.SS1.p2.13.m13.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.13.m13.1b"><apply id="A4.SS1.p2.13.m13.1.1.cmml" xref="A4.SS1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.13.m13.1.1.1.cmml" xref="A4.SS1.p2.13.m13.1.1">subscript</csymbol><ci id="A4.SS1.p2.13.m13.1.1.2.cmml" xref="A4.SS1.p2.13.m13.1.1.2">Π</ci><apply id="A4.SS1.p2.13.m13.1.1.3.cmml" xref="A4.SS1.p2.13.m13.1.1.3"><csymbol cd="ambiguous" id="A4.SS1.p2.13.m13.1.1.3.1.cmml" xref="A4.SS1.p2.13.m13.1.1.3">subscript</csymbol><ci id="A4.SS1.p2.13.m13.1.1.3.2.cmml" xref="A4.SS1.p2.13.m13.1.1.3.2">𝑟</ci><ci id="A4.SS1.p2.13.m13.1.1.3.3.cmml" xref="A4.SS1.p2.13.m13.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.13.m13.1c">\Pi_{r_{k}}</annotation></semantics></math> denote the generated permutation matrices in each local update step. We simulate the process for a single layer 10 times and calculate the averaged <math id="A4.SS1.p2.14.m14.1" class="ltx_Math" alttext="R_{\text{kept}}" display="inline"><semantics id="A4.SS1.p2.14.m14.1a"><msub id="A4.SS1.p2.14.m14.1.1" xref="A4.SS1.p2.14.m14.1.1.cmml"><mi id="A4.SS1.p2.14.m14.1.1.2" xref="A4.SS1.p2.14.m14.1.1.2.cmml">R</mi><mtext id="A4.SS1.p2.14.m14.1.1.3" xref="A4.SS1.p2.14.m14.1.1.3a.cmml">kept</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.14.m14.1b"><apply id="A4.SS1.p2.14.m14.1.1.cmml" xref="A4.SS1.p2.14.m14.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.14.m14.1.1.1.cmml" xref="A4.SS1.p2.14.m14.1.1">subscript</csymbol><ci id="A4.SS1.p2.14.m14.1.1.2.cmml" xref="A4.SS1.p2.14.m14.1.1.2">𝑅</ci><ci id="A4.SS1.p2.14.m14.1.1.3a.cmml" xref="A4.SS1.p2.14.m14.1.1.3"><mtext mathsize="70%" id="A4.SS1.p2.14.m14.1.1.3.cmml" xref="A4.SS1.p2.14.m14.1.1.3">kept</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.14.m14.1c">R_{\text{kept}}</annotation></semantics></math>. We keep <math id="A4.SS1.p2.15.m15.1" class="ltx_Math" alttext="P_{\text{sf}}=0.1" display="inline"><semantics id="A4.SS1.p2.15.m15.1a"><mrow id="A4.SS1.p2.15.m15.1.1" xref="A4.SS1.p2.15.m15.1.1.cmml"><msub id="A4.SS1.p2.15.m15.1.1.2" xref="A4.SS1.p2.15.m15.1.1.2.cmml"><mi id="A4.SS1.p2.15.m15.1.1.2.2" xref="A4.SS1.p2.15.m15.1.1.2.2.cmml">P</mi><mtext id="A4.SS1.p2.15.m15.1.1.2.3" xref="A4.SS1.p2.15.m15.1.1.2.3a.cmml">sf</mtext></msub><mo id="A4.SS1.p2.15.m15.1.1.1" xref="A4.SS1.p2.15.m15.1.1.1.cmml">=</mo><mn id="A4.SS1.p2.15.m15.1.1.3" xref="A4.SS1.p2.15.m15.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.15.m15.1b"><apply id="A4.SS1.p2.15.m15.1.1.cmml" xref="A4.SS1.p2.15.m15.1.1"><eq id="A4.SS1.p2.15.m15.1.1.1.cmml" xref="A4.SS1.p2.15.m15.1.1.1"></eq><apply id="A4.SS1.p2.15.m15.1.1.2.cmml" xref="A4.SS1.p2.15.m15.1.1.2"><csymbol cd="ambiguous" id="A4.SS1.p2.15.m15.1.1.2.1.cmml" xref="A4.SS1.p2.15.m15.1.1.2">subscript</csymbol><ci id="A4.SS1.p2.15.m15.1.1.2.2.cmml" xref="A4.SS1.p2.15.m15.1.1.2.2">𝑃</ci><ci id="A4.SS1.p2.15.m15.1.1.2.3a.cmml" xref="A4.SS1.p2.15.m15.1.1.2.3"><mtext mathsize="70%" id="A4.SS1.p2.15.m15.1.1.2.3.cmml" xref="A4.SS1.p2.15.m15.1.1.2.3">sf</mtext></ci></apply><cn type="float" id="A4.SS1.p2.15.m15.1.1.3.cmml" xref="A4.SS1.p2.15.m15.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.15.m15.1c">P_{\text{sf}}=0.1</annotation></semantics></math> and show the relations of <math id="A4.SS1.p2.16.m16.1" class="ltx_Math" alttext="R_{\text{kept}}" display="inline"><semantics id="A4.SS1.p2.16.m16.1a"><msub id="A4.SS1.p2.16.m16.1.1" xref="A4.SS1.p2.16.m16.1.1.cmml"><mi id="A4.SS1.p2.16.m16.1.1.2" xref="A4.SS1.p2.16.m16.1.1.2.cmml">R</mi><mtext id="A4.SS1.p2.16.m16.1.1.3" xref="A4.SS1.p2.16.m16.1.1.3a.cmml">kept</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.16.m16.1b"><apply id="A4.SS1.p2.16.m16.1.1.cmml" xref="A4.SS1.p2.16.m16.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.16.m16.1.1.1.cmml" xref="A4.SS1.p2.16.m16.1.1">subscript</csymbol><ci id="A4.SS1.p2.16.m16.1.1.2.cmml" xref="A4.SS1.p2.16.m16.1.1.2">𝑅</ci><ci id="A4.SS1.p2.16.m16.1.1.3a.cmml" xref="A4.SS1.p2.16.m16.1.1.3"><mtext mathsize="70%" id="A4.SS1.p2.16.m16.1.1.3.cmml" xref="A4.SS1.p2.16.m16.1.1.3">kept</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.16.m16.1c">R_{\text{kept}}</annotation></semantics></math> and <math id="A4.SS1.p2.17.m17.1" class="ltx_Math" alttext="N_{\text{sf}}" display="inline"><semantics id="A4.SS1.p2.17.m17.1a"><msub id="A4.SS1.p2.17.m17.1.1" xref="A4.SS1.p2.17.m17.1.1.cmml"><mi id="A4.SS1.p2.17.m17.1.1.2" xref="A4.SS1.p2.17.m17.1.1.2.cmml">N</mi><mtext id="A4.SS1.p2.17.m17.1.1.3" xref="A4.SS1.p2.17.m17.1.1.3a.cmml">sf</mtext></msub><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.17.m17.1b"><apply id="A4.SS1.p2.17.m17.1.1.cmml" xref="A4.SS1.p2.17.m17.1.1"><csymbol cd="ambiguous" id="A4.SS1.p2.17.m17.1.1.1.cmml" xref="A4.SS1.p2.17.m17.1.1">subscript</csymbol><ci id="A4.SS1.p2.17.m17.1.1.2.cmml" xref="A4.SS1.p2.17.m17.1.1.2">𝑁</ci><ci id="A4.SS1.p2.17.m17.1.1.3a.cmml" xref="A4.SS1.p2.17.m17.1.1.3"><mtext mathsize="70%" id="A4.SS1.p2.17.m17.1.1.3.cmml" xref="A4.SS1.p2.17.m17.1.1.3">sf</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.17.m17.1c">N_{\text{sf}}</annotation></semantics></math> in the body.</p>
</div>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Additional Experimental Results</h2>

<div id="A5.p1" class="ltx_para ltx_noindent">
<p id="A5.p1.1" class="ltx_p"><span id="A5.p1.1.1" class="ltx_text ltx_font_bold">Shuffle Error on Random Data:</span> We investigate the shuffle error via taking the random data as input in the body, where we only present the results based on VGG13. We report similar results on MLP and ResNet20, which are shown in Fig. <a href="#A2.F14" title="Figure 14 ‣ Appendix B Network Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a> and Fig. <a href="#A2.F15" title="Figure 15 ‣ Appendix B Network Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>. Multiplicative PANs with a larger A make the network more sensitive to neuron permutation.</p>
</div>
<div id="A5.p2" class="ltx_para ltx_noindent">
<p id="A5.p2.8" class="ltx_p"><span id="A5.p2.8.1" class="ltx_text ltx_font_bold">Weight Divergence:</span> Our proposed PANs could decrease the weight divergence during FL. Specifically, we split the training data onto <math id="A5.p2.1.m1.1" class="ltx_Math" alttext="K=10" display="inline"><semantics id="A5.p2.1.m1.1a"><mrow id="A5.p2.1.m1.1.1" xref="A5.p2.1.m1.1.1.cmml"><mi id="A5.p2.1.m1.1.1.2" xref="A5.p2.1.m1.1.1.2.cmml">K</mi><mo id="A5.p2.1.m1.1.1.1" xref="A5.p2.1.m1.1.1.1.cmml">=</mo><mn id="A5.p2.1.m1.1.1.3" xref="A5.p2.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p2.1.m1.1b"><apply id="A5.p2.1.m1.1.1.cmml" xref="A5.p2.1.m1.1.1"><eq id="A5.p2.1.m1.1.1.1.cmml" xref="A5.p2.1.m1.1.1.1"></eq><ci id="A5.p2.1.m1.1.1.2.cmml" xref="A5.p2.1.m1.1.1.2">𝐾</ci><cn type="integer" id="A5.p2.1.m1.1.1.3.cmml" xref="A5.p2.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.1.m1.1c">K=10</annotation></semantics></math> clients with <math id="A5.p2.2.m2.2" class="ltx_Math" alttext="\alpha\in\{1.0,0.1\}" display="inline"><semantics id="A5.p2.2.m2.2a"><mrow id="A5.p2.2.m2.2.3" xref="A5.p2.2.m2.2.3.cmml"><mi id="A5.p2.2.m2.2.3.2" xref="A5.p2.2.m2.2.3.2.cmml">α</mi><mo id="A5.p2.2.m2.2.3.1" xref="A5.p2.2.m2.2.3.1.cmml">∈</mo><mrow id="A5.p2.2.m2.2.3.3.2" xref="A5.p2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="A5.p2.2.m2.2.3.3.2.1" xref="A5.p2.2.m2.2.3.3.1.cmml">{</mo><mn id="A5.p2.2.m2.1.1" xref="A5.p2.2.m2.1.1.cmml">1.0</mn><mo id="A5.p2.2.m2.2.3.3.2.2" xref="A5.p2.2.m2.2.3.3.1.cmml">,</mo><mn id="A5.p2.2.m2.2.2" xref="A5.p2.2.m2.2.2.cmml">0.1</mn><mo stretchy="false" id="A5.p2.2.m2.2.3.3.2.3" xref="A5.p2.2.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p2.2.m2.2b"><apply id="A5.p2.2.m2.2.3.cmml" xref="A5.p2.2.m2.2.3"><in id="A5.p2.2.m2.2.3.1.cmml" xref="A5.p2.2.m2.2.3.1"></in><ci id="A5.p2.2.m2.2.3.2.cmml" xref="A5.p2.2.m2.2.3.2">𝛼</ci><set id="A5.p2.2.m2.2.3.3.1.cmml" xref="A5.p2.2.m2.2.3.3.2"><cn type="float" id="A5.p2.2.m2.1.1.cmml" xref="A5.p2.2.m2.1.1">1.0</cn><cn type="float" id="A5.p2.2.m2.2.2.cmml" xref="A5.p2.2.m2.2.2">0.1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.2.m2.2c">\alpha\in\{1.0,0.1\}</annotation></semantics></math> and select all clients in each round, i.e., <math id="A5.p2.3.m3.1" class="ltx_Math" alttext="R=1.0" display="inline"><semantics id="A5.p2.3.m3.1a"><mrow id="A5.p2.3.m3.1.1" xref="A5.p2.3.m3.1.1.cmml"><mi id="A5.p2.3.m3.1.1.2" xref="A5.p2.3.m3.1.1.2.cmml">R</mi><mo id="A5.p2.3.m3.1.1.1" xref="A5.p2.3.m3.1.1.1.cmml">=</mo><mn id="A5.p2.3.m3.1.1.3" xref="A5.p2.3.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p2.3.m3.1b"><apply id="A5.p2.3.m3.1.1.cmml" xref="A5.p2.3.m3.1.1"><eq id="A5.p2.3.m3.1.1.1.cmml" xref="A5.p2.3.m3.1.1.1"></eq><ci id="A5.p2.3.m3.1.1.2.cmml" xref="A5.p2.3.m3.1.1.2">𝑅</ci><cn type="float" id="A5.p2.3.m3.1.1.3.cmml" xref="A5.p2.3.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.3.m3.1c">R=1.0</annotation></semantics></math>. We take <math id="A5.p2.4.m4.1" class="ltx_Math" alttext="H=20" display="inline"><semantics id="A5.p2.4.m4.1a"><mrow id="A5.p2.4.m4.1.1" xref="A5.p2.4.m4.1.1.cmml"><mi id="A5.p2.4.m4.1.1.2" xref="A5.p2.4.m4.1.1.2.cmml">H</mi><mo id="A5.p2.4.m4.1.1.1" xref="A5.p2.4.m4.1.1.1.cmml">=</mo><mn id="A5.p2.4.m4.1.1.3" xref="A5.p2.4.m4.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p2.4.m4.1b"><apply id="A5.p2.4.m4.1.1.cmml" xref="A5.p2.4.m4.1.1"><eq id="A5.p2.4.m4.1.1.1.cmml" xref="A5.p2.4.m4.1.1.1"></eq><ci id="A5.p2.4.m4.1.1.2.cmml" xref="A5.p2.4.m4.1.1.2">𝐻</ci><cn type="integer" id="A5.p2.4.m4.1.1.3.cmml" xref="A5.p2.4.m4.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.4.m4.1c">H=20</annotation></semantics></math> communication rounds and then calculate the local gradient variance as an approximation. We vary the number of local epochs <math id="A5.p2.5.m5.2" class="ltx_Math" alttext="E\in\{5,20\}" display="inline"><semantics id="A5.p2.5.m5.2a"><mrow id="A5.p2.5.m5.2.3" xref="A5.p2.5.m5.2.3.cmml"><mi id="A5.p2.5.m5.2.3.2" xref="A5.p2.5.m5.2.3.2.cmml">E</mi><mo id="A5.p2.5.m5.2.3.1" xref="A5.p2.5.m5.2.3.1.cmml">∈</mo><mrow id="A5.p2.5.m5.2.3.3.2" xref="A5.p2.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="A5.p2.5.m5.2.3.3.2.1" xref="A5.p2.5.m5.2.3.3.1.cmml">{</mo><mn id="A5.p2.5.m5.1.1" xref="A5.p2.5.m5.1.1.cmml">5</mn><mo id="A5.p2.5.m5.2.3.3.2.2" xref="A5.p2.5.m5.2.3.3.1.cmml">,</mo><mn id="A5.p2.5.m5.2.2" xref="A5.p2.5.m5.2.2.cmml">20</mn><mo stretchy="false" id="A5.p2.5.m5.2.3.3.2.3" xref="A5.p2.5.m5.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p2.5.m5.2b"><apply id="A5.p2.5.m5.2.3.cmml" xref="A5.p2.5.m5.2.3"><in id="A5.p2.5.m5.2.3.1.cmml" xref="A5.p2.5.m5.2.3.1"></in><ci id="A5.p2.5.m5.2.3.2.cmml" xref="A5.p2.5.m5.2.3.2">𝐸</ci><set id="A5.p2.5.m5.2.3.3.1.cmml" xref="A5.p2.5.m5.2.3.3.2"><cn type="integer" id="A5.p2.5.m5.1.1.cmml" xref="A5.p2.5.m5.1.1">5</cn><cn type="integer" id="A5.p2.5.m5.2.2.cmml" xref="A5.p2.5.m5.2.2">20</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.5.m5.2c">E\in\{5,20\}</annotation></semantics></math>. We only report the results on Mnist with <math id="A5.p2.6.m6.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="A5.p2.6.m6.1a"><mrow id="A5.p2.6.m6.1.1" xref="A5.p2.6.m6.1.1.cmml"><mi id="A5.p2.6.m6.1.1.2" xref="A5.p2.6.m6.1.1.2.cmml">E</mi><mo id="A5.p2.6.m6.1.1.1" xref="A5.p2.6.m6.1.1.1.cmml">=</mo><mn id="A5.p2.6.m6.1.1.3" xref="A5.p2.6.m6.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p2.6.m6.1b"><apply id="A5.p2.6.m6.1.1.cmml" xref="A5.p2.6.m6.1.1"><eq id="A5.p2.6.m6.1.1.1.cmml" xref="A5.p2.6.m6.1.1.1"></eq><ci id="A5.p2.6.m6.1.1.2.cmml" xref="A5.p2.6.m6.1.1.2">𝐸</ci><cn type="integer" id="A5.p2.6.m6.1.1.3.cmml" xref="A5.p2.6.m6.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.6.m6.1c">E=5</annotation></semantics></math> in the body. Additional results of Mnist with <math id="A5.p2.7.m7.1" class="ltx_Math" alttext="E=20" display="inline"><semantics id="A5.p2.7.m7.1a"><mrow id="A5.p2.7.m7.1.1" xref="A5.p2.7.m7.1.1.cmml"><mi id="A5.p2.7.m7.1.1.2" xref="A5.p2.7.m7.1.1.2.cmml">E</mi><mo id="A5.p2.7.m7.1.1.1" xref="A5.p2.7.m7.1.1.1.cmml">=</mo><mn id="A5.p2.7.m7.1.1.3" xref="A5.p2.7.m7.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p2.7.m7.1b"><apply id="A5.p2.7.m7.1.1.cmml" xref="A5.p2.7.m7.1.1"><eq id="A5.p2.7.m7.1.1.1.cmml" xref="A5.p2.7.m7.1.1.1"></eq><ci id="A5.p2.7.m7.1.1.2.cmml" xref="A5.p2.7.m7.1.1.2">𝐸</ci><cn type="integer" id="A5.p2.7.m7.1.1.3.cmml" xref="A5.p2.7.m7.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.7.m7.1c">E=20</annotation></semantics></math> (Fig. <a href="#A2.F16" title="Figure 16 ‣ Appendix B Network Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>) and Cifar10 with <math id="A5.p2.8.m8.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="A5.p2.8.m8.1a"><mrow id="A5.p2.8.m8.1.1" xref="A5.p2.8.m8.1.1.cmml"><mi id="A5.p2.8.m8.1.1.2" xref="A5.p2.8.m8.1.1.2.cmml">E</mi><mo id="A5.p2.8.m8.1.1.1" xref="A5.p2.8.m8.1.1.1.cmml">=</mo><mn id="A5.p2.8.m8.1.1.3" xref="A5.p2.8.m8.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p2.8.m8.1b"><apply id="A5.p2.8.m8.1.1.cmml" xref="A5.p2.8.m8.1.1"><eq id="A5.p2.8.m8.1.1.1.cmml" xref="A5.p2.8.m8.1.1.1"></eq><ci id="A5.p2.8.m8.1.1.2.cmml" xref="A5.p2.8.m8.1.1.2">𝐸</ci><cn type="integer" id="A5.p2.8.m8.1.1.3.cmml" xref="A5.p2.8.m8.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.8.m8.1c">E=5</annotation></semantics></math> (Fig. <a href="#A2.F17" title="Figure 17 ‣ Appendix B Network Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17</span></a>) further verify that PANs could decrease the local gradient variance.</p>
</div>
<div id="A5.p3" class="ltx_para ltx_noindent">
<p id="A5.p3.4" class="ltx_p"><span id="A5.p3.4.1" class="ltx_text ltx_font_bold">Matching via Optimal Assignment:</span> We first train a global model via FL for <math id="A5.p3.1.m1.1" class="ltx_Math" alttext="H=20" display="inline"><semantics id="A5.p3.1.m1.1a"><mrow id="A5.p3.1.m1.1.1" xref="A5.p3.1.m1.1.1.cmml"><mi id="A5.p3.1.m1.1.1.2" xref="A5.p3.1.m1.1.1.2.cmml">H</mi><mo id="A5.p3.1.m1.1.1.1" xref="A5.p3.1.m1.1.1.1.cmml">=</mo><mn id="A5.p3.1.m1.1.1.3" xref="A5.p3.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p3.1.m1.1b"><apply id="A5.p3.1.m1.1.1.cmml" xref="A5.p3.1.m1.1.1"><eq id="A5.p3.1.m1.1.1.1.cmml" xref="A5.p3.1.m1.1.1.1"></eq><ci id="A5.p3.1.m1.1.1.2.cmml" xref="A5.p3.1.m1.1.1.2">𝐻</ci><cn type="integer" id="A5.p3.1.m1.1.1.3.cmml" xref="A5.p3.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p3.1.m1.1c">H=20</annotation></semantics></math> communication rounds, where the scene contains <math id="A5.p3.2.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A5.p3.2.m2.1a"><mn id="A5.p3.2.m2.1.1" xref="A5.p3.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A5.p3.2.m2.1b"><cn type="integer" id="A5.p3.2.m2.1.1.cmml" xref="A5.p3.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.p3.2.m2.1c">10</annotation></semantics></math> clients with <math id="A5.p3.3.m3.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A5.p3.3.m3.1a"><mrow id="A5.p3.3.m3.1.1" xref="A5.p3.3.m3.1.1.cmml"><mi id="A5.p3.3.m3.1.1.2" xref="A5.p3.3.m3.1.1.2.cmml">α</mi><mo id="A5.p3.3.m3.1.1.1" xref="A5.p3.3.m3.1.1.1.cmml">=</mo><mn id="A5.p3.3.m3.1.1.3" xref="A5.p3.3.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p3.3.m3.1b"><apply id="A5.p3.3.m3.1.1.cmml" xref="A5.p3.3.m3.1.1"><eq id="A5.p3.3.m3.1.1.1.cmml" xref="A5.p3.3.m3.1.1.1"></eq><ci id="A5.p3.3.m3.1.1.2.cmml" xref="A5.p3.3.m3.1.1.2">𝛼</ci><cn type="float" id="A5.p3.3.m3.1.1.3.cmml" xref="A5.p3.3.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p3.3.m3.1c">\alpha=1.0</annotation></semantics></math>. Then, we randomly sample a local client and update the global model for <math id="A5.p3.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="A5.p3.4.m4.1a"><mi id="A5.p3.4.m4.1.1" xref="A5.p3.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A5.p3.4.m4.1b"><ci id="A5.p3.4.m4.1.1.cmml" xref="A5.p3.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.p3.4.m4.1c">E</annotation></semantics></math> epochs. Our goal is to search for a matrix to match the neurons of the global model and the updated one, i.e., the local model of this client. We then use 500 test samples to obtain the neuron’s activations as their representations. Hence, the optimal assignment problem could be solved and the assignment matrix is a permutation matrix. The results on various layers of VGG9 and MLP are shown in Fig. <a href="#A3.F18" title="Figure 18 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">18</span></a> and Fig. <a href="#A3.F19" title="Figure 19 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">19</span></a>. <span id="A5.p3.4.2" class="ltx_text ltx_font_italic">Notably, the calculated matching ratio, i.e., the number in “[]”, is only an approximated value which represents how much neurons are shuffled. The absolute value (e.g., 0.062) does not represent the actual permutation during training.</span></p>
</div>
<div id="A5.p4" class="ltx_para ltx_noindent">
<p id="A5.p4.1" class="ltx_p"><span id="A5.p4.1.1" class="ltx_text ltx_font_bold">Visualizing Neurons via Preference Vectors:</span> Similarly, more of the visualization results via preference vectors of neurons are provided in Fig. <a href="#A3.F20" title="Figure 20 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">20</span></a>, Fig. <a href="#A3.F21" title="Figure 21 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">21</span></a>, Fig. <a href="#A3.F22" title="Figure 22 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">22</span></a>, and Fig. <a href="#A3.F23" title="Figure 23 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">23</span></a>. Notably, there are only 10 neurons in Fig. <a href="#A3.F22" title="Figure 22 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">22</span></a> because FC4 is the output layer with 10 classes. Using PANs could encourage neurons at the same position contribute to the same classes as much as possible.</p>
</div>
<div id="A5.p5" class="ltx_para ltx_noindent">
<p id="A5.p5.1" class="ltx_p"><span id="A5.p5.1.1" class="ltx_text ltx_font_bold">Universal Application of PANs:</span> We report the results of applying PANs to popular FL algorithms on FeMnist, Cifar10, Cifar100, and Cinic10 in the body. We show the results on SVHN and GTSRB in Fig. <a href="#A3.F24" title="Figure 24 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">24</span></a>. Training on GTSRB is not stable, and some algorithms will converge slower, e.g., FedAvg and FedOpt. This could be improved with the additional effort of tuning learning rates, while we omit this in this paper. Comparison results on Cifar10 and Cifar100 under various levels of non-i.i.d. data are shown in Fig. <a href="#A3.F25" title="Figure 25 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">25</span></a> and Fig. <a href="#A3.F26" title="Figure 26 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">26</span></a>. The improvements under various scenes based on Scaffold are shown in Fig. <a href="#A3.F27" title="Figure 27 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">27</span></a>. These additional results further verify the universal application of PANs to improve the performance of FL.</p>
</div>
<div id="A5.p6" class="ltx_para ltx_noindent">
<p id="A5.p6.19" class="ltx_p"><span id="A5.p6.19.1" class="ltx_text ltx_font_bold">Hyper-parameter Analysis:</span> We present the performances of various <math id="A5.p6.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A5.p6.1.m1.1a"><mi id="A5.p6.1.m1.1.1" xref="A5.p6.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A5.p6.1.m1.1b"><ci id="A5.p6.1.m1.1.1.cmml" xref="A5.p6.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.1.m1.1c">A</annotation></semantics></math> with PAN<sub id="A5.p6.19.2" class="ltx_sub"><span id="A5.p6.19.2.1" class="ltx_text ltx_font_italic">∘</span></sub> when <math id="A5.p6.3.m3.1" class="ltx_Math" alttext="T=1" display="inline"><semantics id="A5.p6.3.m3.1a"><mrow id="A5.p6.3.m3.1.1" xref="A5.p6.3.m3.1.1.cmml"><mi id="A5.p6.3.m3.1.1.2" xref="A5.p6.3.m3.1.1.2.cmml">T</mi><mo id="A5.p6.3.m3.1.1.1" xref="A5.p6.3.m3.1.1.1.cmml">=</mo><mn id="A5.p6.3.m3.1.1.3" xref="A5.p6.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p6.3.m3.1b"><apply id="A5.p6.3.m3.1.1.cmml" xref="A5.p6.3.m3.1.1"><eq id="A5.p6.3.m3.1.1.1.cmml" xref="A5.p6.3.m3.1.1.1"></eq><ci id="A5.p6.3.m3.1.1.2.cmml" xref="A5.p6.3.m3.1.1.2">𝑇</ci><cn type="integer" id="A5.p6.3.m3.1.1.3.cmml" xref="A5.p6.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.3.m3.1c">T=1</annotation></semantics></math> in the body and point out that setting <math id="A5.p6.4.m4.1" class="ltx_Math" alttext="A=0.1" display="inline"><semantics id="A5.p6.4.m4.1a"><mrow id="A5.p6.4.m4.1.1" xref="A5.p6.4.m4.1.1.cmml"><mi id="A5.p6.4.m4.1.1.2" xref="A5.p6.4.m4.1.1.2.cmml">A</mi><mo id="A5.p6.4.m4.1.1.1" xref="A5.p6.4.m4.1.1.1.cmml">=</mo><mn id="A5.p6.4.m4.1.1.3" xref="A5.p6.4.m4.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p6.4.m4.1b"><apply id="A5.p6.4.m4.1.1.cmml" xref="A5.p6.4.m4.1.1"><eq id="A5.p6.4.m4.1.1.1.cmml" xref="A5.p6.4.m4.1.1.1"></eq><ci id="A5.p6.4.m4.1.1.2.cmml" xref="A5.p6.4.m4.1.1.2">𝐴</ci><cn type="float" id="A5.p6.4.m4.1.1.3.cmml" xref="A5.p6.4.m4.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.4.m4.1c">A=0.1</annotation></semantics></math> is a good choice. Here, we present a more comprehensive analysis with both additive and multiplicative PANs. The used FL scene is: <math id="A5.p6.5.m5.1" class="ltx_Math" alttext="K=100" display="inline"><semantics id="A5.p6.5.m5.1a"><mrow id="A5.p6.5.m5.1.1" xref="A5.p6.5.m5.1.1.cmml"><mi id="A5.p6.5.m5.1.1.2" xref="A5.p6.5.m5.1.1.2.cmml">K</mi><mo id="A5.p6.5.m5.1.1.1" xref="A5.p6.5.m5.1.1.1.cmml">=</mo><mn id="A5.p6.5.m5.1.1.3" xref="A5.p6.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p6.5.m5.1b"><apply id="A5.p6.5.m5.1.1.cmml" xref="A5.p6.5.m5.1.1"><eq id="A5.p6.5.m5.1.1.1.cmml" xref="A5.p6.5.m5.1.1.1"></eq><ci id="A5.p6.5.m5.1.1.2.cmml" xref="A5.p6.5.m5.1.1.2">𝐾</ci><cn type="integer" id="A5.p6.5.m5.1.1.3.cmml" xref="A5.p6.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.5.m5.1c">K=100</annotation></semantics></math>, <math id="A5.p6.6.m6.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A5.p6.6.m6.1a"><mrow id="A5.p6.6.m6.1.1" xref="A5.p6.6.m6.1.1.cmml"><mi id="A5.p6.6.m6.1.1.2" xref="A5.p6.6.m6.1.1.2.cmml">α</mi><mo id="A5.p6.6.m6.1.1.1" xref="A5.p6.6.m6.1.1.1.cmml">=</mo><mn id="A5.p6.6.m6.1.1.3" xref="A5.p6.6.m6.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p6.6.m6.1b"><apply id="A5.p6.6.m6.1.1.cmml" xref="A5.p6.6.m6.1.1"><eq id="A5.p6.6.m6.1.1.1.cmml" xref="A5.p6.6.m6.1.1.1"></eq><ci id="A5.p6.6.m6.1.1.2.cmml" xref="A5.p6.6.m6.1.1.2">𝛼</ci><cn type="float" id="A5.p6.6.m6.1.1.3.cmml" xref="A5.p6.6.m6.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.6.m6.1c">\alpha=0.1</annotation></semantics></math>, <math id="A5.p6.7.m7.1" class="ltx_Math" alttext="H=2000" display="inline"><semantics id="A5.p6.7.m7.1a"><mrow id="A5.p6.7.m7.1.1" xref="A5.p6.7.m7.1.1.cmml"><mi id="A5.p6.7.m7.1.1.2" xref="A5.p6.7.m7.1.1.2.cmml">H</mi><mo id="A5.p6.7.m7.1.1.1" xref="A5.p6.7.m7.1.1.1.cmml">=</mo><mn id="A5.p6.7.m7.1.1.3" xref="A5.p6.7.m7.1.1.3.cmml">2000</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p6.7.m7.1b"><apply id="A5.p6.7.m7.1.1.cmml" xref="A5.p6.7.m7.1.1"><eq id="A5.p6.7.m7.1.1.1.cmml" xref="A5.p6.7.m7.1.1.1"></eq><ci id="A5.p6.7.m7.1.1.2.cmml" xref="A5.p6.7.m7.1.1.2">𝐻</ci><cn type="integer" id="A5.p6.7.m7.1.1.3.cmml" xref="A5.p6.7.m7.1.1.3">2000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.7.m7.1c">H=2000</annotation></semantics></math>, <math id="A5.p6.8.m8.1" class="ltx_Math" alttext="R=0.1" display="inline"><semantics id="A5.p6.8.m8.1a"><mrow id="A5.p6.8.m8.1.1" xref="A5.p6.8.m8.1.1.cmml"><mi id="A5.p6.8.m8.1.1.2" xref="A5.p6.8.m8.1.1.2.cmml">R</mi><mo id="A5.p6.8.m8.1.1.1" xref="A5.p6.8.m8.1.1.1.cmml">=</mo><mn id="A5.p6.8.m8.1.1.3" xref="A5.p6.8.m8.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p6.8.m8.1b"><apply id="A5.p6.8.m8.1.1.cmml" xref="A5.p6.8.m8.1.1"><eq id="A5.p6.8.m8.1.1.1.cmml" xref="A5.p6.8.m8.1.1.1"></eq><ci id="A5.p6.8.m8.1.1.2.cmml" xref="A5.p6.8.m8.1.1.2">𝑅</ci><cn type="float" id="A5.p6.8.m8.1.1.3.cmml" xref="A5.p6.8.m8.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.8.m8.1c">R=0.1</annotation></semantics></math>, <math id="A5.p6.9.m9.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="A5.p6.9.m9.1a"><mrow id="A5.p6.9.m9.1.1" xref="A5.p6.9.m9.1.1.cmml"><mi id="A5.p6.9.m9.1.1.2" xref="A5.p6.9.m9.1.1.2.cmml">E</mi><mo id="A5.p6.9.m9.1.1.1" xref="A5.p6.9.m9.1.1.1.cmml">=</mo><mn id="A5.p6.9.m9.1.1.3" xref="A5.p6.9.m9.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p6.9.m9.1b"><apply id="A5.p6.9.m9.1.1.cmml" xref="A5.p6.9.m9.1.1"><eq id="A5.p6.9.m9.1.1.1.cmml" xref="A5.p6.9.m9.1.1.1"></eq><ci id="A5.p6.9.m9.1.1.2.cmml" xref="A5.p6.9.m9.1.1.2">𝐸</ci><cn type="integer" id="A5.p6.9.m9.1.1.3.cmml" xref="A5.p6.9.m9.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.9.m9.1c">E=5</annotation></semantics></math>. We plot the results on Cifar10 with VGG11 and Cifar100 with ResNet20 in Fig <a href="#A3.F28" title="Figure 28 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">28</span></a> and Fig. <a href="#A3.F29" title="Figure 29 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">29</span></a>. The leftmost point shows the baseline of the performance. The four parts in different colors show the results with various <math id="A5.p6.10.m10.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A5.p6.10.m10.1a"><mi id="A5.p6.10.m10.1.1" xref="A5.p6.10.m10.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A5.p6.10.m10.1b"><ci id="A5.p6.10.m10.1.1.cmml" xref="A5.p6.10.m10.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.10.m10.1c">T</annotation></semantics></math> or <math id="A5.p6.11.m11.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A5.p6.11.m11.1a"><mi id="A5.p6.11.m11.1.1" xref="A5.p6.11.m11.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A5.p6.11.m11.1b"><ci id="A5.p6.11.m11.1.1.cmml" xref="A5.p6.11.m11.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.11.m11.1c">A</annotation></semantics></math>, while the other one is fixed. For example, the first part shows the performances with <math id="A5.p6.12.m12.7" class="ltx_Math" alttext="T\in\{1,2,4,8,12,16,32\}" display="inline"><semantics id="A5.p6.12.m12.7a"><mrow id="A5.p6.12.m12.7.8" xref="A5.p6.12.m12.7.8.cmml"><mi id="A5.p6.12.m12.7.8.2" xref="A5.p6.12.m12.7.8.2.cmml">T</mi><mo id="A5.p6.12.m12.7.8.1" xref="A5.p6.12.m12.7.8.1.cmml">∈</mo><mrow id="A5.p6.12.m12.7.8.3.2" xref="A5.p6.12.m12.7.8.3.1.cmml"><mo stretchy="false" id="A5.p6.12.m12.7.8.3.2.1" xref="A5.p6.12.m12.7.8.3.1.cmml">{</mo><mn id="A5.p6.12.m12.1.1" xref="A5.p6.12.m12.1.1.cmml">1</mn><mo id="A5.p6.12.m12.7.8.3.2.2" xref="A5.p6.12.m12.7.8.3.1.cmml">,</mo><mn id="A5.p6.12.m12.2.2" xref="A5.p6.12.m12.2.2.cmml">2</mn><mo id="A5.p6.12.m12.7.8.3.2.3" xref="A5.p6.12.m12.7.8.3.1.cmml">,</mo><mn id="A5.p6.12.m12.3.3" xref="A5.p6.12.m12.3.3.cmml">4</mn><mo id="A5.p6.12.m12.7.8.3.2.4" xref="A5.p6.12.m12.7.8.3.1.cmml">,</mo><mn id="A5.p6.12.m12.4.4" xref="A5.p6.12.m12.4.4.cmml">8</mn><mo id="A5.p6.12.m12.7.8.3.2.5" xref="A5.p6.12.m12.7.8.3.1.cmml">,</mo><mn id="A5.p6.12.m12.5.5" xref="A5.p6.12.m12.5.5.cmml">12</mn><mo id="A5.p6.12.m12.7.8.3.2.6" xref="A5.p6.12.m12.7.8.3.1.cmml">,</mo><mn id="A5.p6.12.m12.6.6" xref="A5.p6.12.m12.6.6.cmml">16</mn><mo id="A5.p6.12.m12.7.8.3.2.7" xref="A5.p6.12.m12.7.8.3.1.cmml">,</mo><mn id="A5.p6.12.m12.7.7" xref="A5.p6.12.m12.7.7.cmml">32</mn><mo stretchy="false" id="A5.p6.12.m12.7.8.3.2.8" xref="A5.p6.12.m12.7.8.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p6.12.m12.7b"><apply id="A5.p6.12.m12.7.8.cmml" xref="A5.p6.12.m12.7.8"><in id="A5.p6.12.m12.7.8.1.cmml" xref="A5.p6.12.m12.7.8.1"></in><ci id="A5.p6.12.m12.7.8.2.cmml" xref="A5.p6.12.m12.7.8.2">𝑇</ci><set id="A5.p6.12.m12.7.8.3.1.cmml" xref="A5.p6.12.m12.7.8.3.2"><cn type="integer" id="A5.p6.12.m12.1.1.cmml" xref="A5.p6.12.m12.1.1">1</cn><cn type="integer" id="A5.p6.12.m12.2.2.cmml" xref="A5.p6.12.m12.2.2">2</cn><cn type="integer" id="A5.p6.12.m12.3.3.cmml" xref="A5.p6.12.m12.3.3">4</cn><cn type="integer" id="A5.p6.12.m12.4.4.cmml" xref="A5.p6.12.m12.4.4">8</cn><cn type="integer" id="A5.p6.12.m12.5.5.cmml" xref="A5.p6.12.m12.5.5">12</cn><cn type="integer" id="A5.p6.12.m12.6.6.cmml" xref="A5.p6.12.m12.6.6">16</cn><cn type="integer" id="A5.p6.12.m12.7.7.cmml" xref="A5.p6.12.m12.7.7">32</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.12.m12.7c">T\in\{1,2,4,8,12,16,32\}</annotation></semantics></math> in PAN<sub id="A5.p6.19.3" class="ltx_sub">+</sub>, while <math id="A5.p6.14.m14.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A5.p6.14.m14.1a"><mi id="A5.p6.14.m14.1.1" xref="A5.p6.14.m14.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A5.p6.14.m14.1b"><ci id="A5.p6.14.m14.1.1.cmml" xref="A5.p6.14.m14.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.14.m14.1c">A</annotation></semantics></math> is fixed to 0.05. Clearly, with fixed <math id="A5.p6.15.m15.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A5.p6.15.m15.1a"><mi id="A5.p6.15.m15.1.1" xref="A5.p6.15.m15.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A5.p6.15.m15.1b"><ci id="A5.p6.15.m15.1.1.cmml" xref="A5.p6.15.m15.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.15.m15.1c">T</annotation></semantics></math>, a larger <math id="A5.p6.16.m16.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A5.p6.16.m16.1a"><mi id="A5.p6.16.m16.1.1" xref="A5.p6.16.m16.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A5.p6.16.m16.1b"><ci id="A5.p6.16.m16.1.1.cmml" xref="A5.p6.16.m16.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.16.m16.1c">A</annotation></semantics></math> leads to degradation (the green and the red part). Setting <math id="A5.p6.17.m17.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A5.p6.17.m17.1a"><mi id="A5.p6.17.m17.1.1" xref="A5.p6.17.m17.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A5.p6.17.m17.1b"><ci id="A5.p6.17.m17.1.1.cmml" xref="A5.p6.17.m17.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.17.m17.1c">A</annotation></semantics></math> around 0.1 for PAN<sub id="A5.p6.19.4" class="ltx_sub">∘</sub> is recommended. The results on Cifar100 are more invariant to <math id="A5.p6.19.m19.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A5.p6.19.m19.1a"><mi id="A5.p6.19.m19.1.1" xref="A5.p6.19.m19.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A5.p6.19.m19.1b"><ci id="A5.p6.19.m19.1.1.cmml" xref="A5.p6.19.m19.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.p6.19.m19.1c">T</annotation></semantics></math>, although the performances fluctuate a lot on Cifar10. Many of these hyper-parameters could surpass the baseline.</p>
</div>
<figure id="A5.F31" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A5.F31.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2203.14666/assets/x33.png" id="A5.F31.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="302" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A5.F31.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2203.14666/assets/x34.png" id="A5.F31.2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="302" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F31.4.1.1" class="ltx_text" style="font-size:90%;">Figure 31</span>: </span><span id="A5.F31.5.2" class="ltx_text" style="font-size:90%;">Model fusion of MLP on Mnist (Left) and VGG9 on Cifar10 (Right) with direct parameter averaging, optimal transport, and PANs. The x-axis shows the interpolation coefficient.</span></figcaption>
</figure>
<figure id="A5.F32" class="ltx_figure"><img src="/html/2203.14666/assets/x35.png" id="A5.F32.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="366" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F32.2.1.1" class="ltx_text" style="font-size:90%;">Figure 32</span>: </span><span id="A5.F32.3.2" class="ltx_text" style="font-size:90%;">Comparisons of different normalization techniques in ConvNet. The top is based on VGG11 and the bottom is based on ResNet20. We use datasets Cifar10 and Cifar100.</span></figcaption>
</figure>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>More Studies</h2>

<section id="A6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.1 </span>Centralized Training</h3>

<div id="A6.SS1.p1" class="ltx_para">
<p id="A6.SS1.p1.3" class="ltx_p">We report the test accuracies of centralized training on FeMnist, GTSRB, SVHN, Cifar10, Cifar100, and Cinic10. The utilized networks are correspondingly MLP, VGG9, VGG9, VGG11, ResNet20, and ResNet20. The numbers of training epochs are respectively 30, 20, 30, 30, 100, and 100. We utilize both SGD with momentum 0.9 and Adam as the optimizer. For SGD, we use 0.05 as the learning rate for MLP and VGG, while 0.1 for ResNet20. For Adam, we use 0.0003 for all networks. The performances are listed in Tab. <a href="#A3.T3" title="Table 3 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
We then add PANs to some datasets and find that the performances degrade slightly. We vary the hyper-parameter <math id="A6.SS1.p1.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A6.SS1.p1.1.m1.1a"><mi id="A6.SS1.p1.1.m1.1.1" xref="A6.SS1.p1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A6.SS1.p1.1.m1.1b"><ci id="A6.SS1.p1.1.m1.1.1.cmml" xref="A6.SS1.p1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS1.p1.1.m1.1c">A</annotation></semantics></math> in PANs while keeping <math id="A6.SS1.p1.2.m2.1" class="ltx_Math" alttext="T=1" display="inline"><semantics id="A6.SS1.p1.2.m2.1a"><mrow id="A6.SS1.p1.2.m2.1.1" xref="A6.SS1.p1.2.m2.1.1.cmml"><mi id="A6.SS1.p1.2.m2.1.1.2" xref="A6.SS1.p1.2.m2.1.1.2.cmml">T</mi><mo id="A6.SS1.p1.2.m2.1.1.1" xref="A6.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="A6.SS1.p1.2.m2.1.1.3" xref="A6.SS1.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.SS1.p1.2.m2.1b"><apply id="A6.SS1.p1.2.m2.1.1.cmml" xref="A6.SS1.p1.2.m2.1.1"><eq id="A6.SS1.p1.2.m2.1.1.1.cmml" xref="A6.SS1.p1.2.m2.1.1.1"></eq><ci id="A6.SS1.p1.2.m2.1.1.2.cmml" xref="A6.SS1.p1.2.m2.1.1.2">𝑇</ci><cn type="integer" id="A6.SS1.p1.2.m2.1.1.3.cmml" xref="A6.SS1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS1.p1.2.m2.1c">T=1</annotation></semantics></math>. The results are shown in Fig. <a href="#A3.F30" title="Figure 30 ‣ Appendix C Hyper-parameter Details ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">30</span></a>. Using PANs could harm the training process slightly, and commonly, a larger <math id="A6.SS1.p1.3.m3.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A6.SS1.p1.3.m3.1a"><mi id="A6.SS1.p1.3.m3.1.1" xref="A6.SS1.p1.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A6.SS1.p1.3.m3.1b"><ci id="A6.SS1.p1.3.m3.1.1.cmml" xref="A6.SS1.p1.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS1.p1.3.m3.1c">A</annotation></semantics></math> could make the results worse. Although we try utilizing the adaptive optimizer (i.e., Adam), the results of utilizing PANs do not improve. Advanced optimizers should be proposed to mitigate the degradation, which is left for future work.</p>
</div>
</section>
<section id="A6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.2 </span>Optimal Transport for Model Fusion</h3>

<div id="A6.SS2.p1" class="ltx_para">
<p id="A6.SS2.p1.5" class="ltx_p">FL should send down the global model to local clients as the initialization during each communication round. If not, coordinate-based parameter averaging will become worse. The work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> studies model fusion with different initializations, and utilizes optimal transport <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> to align model parameters. We split Mnist and Cifar10 into two parts uniformly. We train independent models on these two sets correspondingly. The obtained models after training <math id="A6.SS2.p1.1.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A6.SS2.p1.1.m1.1a"><mn id="A6.SS2.p1.1.m1.1.1" xref="A6.SS2.p1.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.1.m1.1b"><cn type="integer" id="A6.SS2.p1.1.m1.1.1.cmml" xref="A6.SS2.p1.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.1.m1.1c">20</annotation></semantics></math> epochs are denoted as <math id="A6.SS2.p1.2.m2.1" class="ltx_Math" alttext="\theta_{A}" display="inline"><semantics id="A6.SS2.p1.2.m2.1a"><msub id="A6.SS2.p1.2.m2.1.1" xref="A6.SS2.p1.2.m2.1.1.cmml"><mi id="A6.SS2.p1.2.m2.1.1.2" xref="A6.SS2.p1.2.m2.1.1.2.cmml">θ</mi><mi id="A6.SS2.p1.2.m2.1.1.3" xref="A6.SS2.p1.2.m2.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.2.m2.1b"><apply id="A6.SS2.p1.2.m2.1.1.cmml" xref="A6.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A6.SS2.p1.2.m2.1.1.1.cmml" xref="A6.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="A6.SS2.p1.2.m2.1.1.2.cmml" xref="A6.SS2.p1.2.m2.1.1.2">𝜃</ci><ci id="A6.SS2.p1.2.m2.1.1.3.cmml" xref="A6.SS2.p1.2.m2.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.2.m2.1c">\theta_{A}</annotation></semantics></math> and <math id="A6.SS2.p1.3.m3.1" class="ltx_Math" alttext="\theta_{B}" display="inline"><semantics id="A6.SS2.p1.3.m3.1a"><msub id="A6.SS2.p1.3.m3.1.1" xref="A6.SS2.p1.3.m3.1.1.cmml"><mi id="A6.SS2.p1.3.m3.1.1.2" xref="A6.SS2.p1.3.m3.1.1.2.cmml">θ</mi><mi id="A6.SS2.p1.3.m3.1.1.3" xref="A6.SS2.p1.3.m3.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.3.m3.1b"><apply id="A6.SS2.p1.3.m3.1.1.cmml" xref="A6.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A6.SS2.p1.3.m3.1.1.1.cmml" xref="A6.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="A6.SS2.p1.3.m3.1.1.2.cmml" xref="A6.SS2.p1.3.m3.1.1.2">𝜃</ci><ci id="A6.SS2.p1.3.m3.1.1.3.cmml" xref="A6.SS2.p1.3.m3.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.3.m3.1c">\theta_{B}</annotation></semantics></math>. Then, an interpolation is evaluated, i.e., <math id="A6.SS2.p1.4.m4.1" class="ltx_Math" alttext="(1-\mu)\theta_{A}+\mu\theta_{B}" display="inline"><semantics id="A6.SS2.p1.4.m4.1a"><mrow id="A6.SS2.p1.4.m4.1.1" xref="A6.SS2.p1.4.m4.1.1.cmml"><mrow id="A6.SS2.p1.4.m4.1.1.1" xref="A6.SS2.p1.4.m4.1.1.1.cmml"><mrow id="A6.SS2.p1.4.m4.1.1.1.1.1" xref="A6.SS2.p1.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A6.SS2.p1.4.m4.1.1.1.1.1.2" xref="A6.SS2.p1.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.SS2.p1.4.m4.1.1.1.1.1.1" xref="A6.SS2.p1.4.m4.1.1.1.1.1.1.cmml"><mn id="A6.SS2.p1.4.m4.1.1.1.1.1.1.2" xref="A6.SS2.p1.4.m4.1.1.1.1.1.1.2.cmml">1</mn><mo id="A6.SS2.p1.4.m4.1.1.1.1.1.1.1" xref="A6.SS2.p1.4.m4.1.1.1.1.1.1.1.cmml">−</mo><mi id="A6.SS2.p1.4.m4.1.1.1.1.1.1.3" xref="A6.SS2.p1.4.m4.1.1.1.1.1.1.3.cmml">μ</mi></mrow><mo stretchy="false" id="A6.SS2.p1.4.m4.1.1.1.1.1.3" xref="A6.SS2.p1.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A6.SS2.p1.4.m4.1.1.1.2" xref="A6.SS2.p1.4.m4.1.1.1.2.cmml">​</mo><msub id="A6.SS2.p1.4.m4.1.1.1.3" xref="A6.SS2.p1.4.m4.1.1.1.3.cmml"><mi id="A6.SS2.p1.4.m4.1.1.1.3.2" xref="A6.SS2.p1.4.m4.1.1.1.3.2.cmml">θ</mi><mi id="A6.SS2.p1.4.m4.1.1.1.3.3" xref="A6.SS2.p1.4.m4.1.1.1.3.3.cmml">A</mi></msub></mrow><mo id="A6.SS2.p1.4.m4.1.1.2" xref="A6.SS2.p1.4.m4.1.1.2.cmml">+</mo><mrow id="A6.SS2.p1.4.m4.1.1.3" xref="A6.SS2.p1.4.m4.1.1.3.cmml"><mi id="A6.SS2.p1.4.m4.1.1.3.2" xref="A6.SS2.p1.4.m4.1.1.3.2.cmml">μ</mi><mo lspace="0em" rspace="0em" id="A6.SS2.p1.4.m4.1.1.3.1" xref="A6.SS2.p1.4.m4.1.1.3.1.cmml">​</mo><msub id="A6.SS2.p1.4.m4.1.1.3.3" xref="A6.SS2.p1.4.m4.1.1.3.3.cmml"><mi id="A6.SS2.p1.4.m4.1.1.3.3.2" xref="A6.SS2.p1.4.m4.1.1.3.3.2.cmml">θ</mi><mi id="A6.SS2.p1.4.m4.1.1.3.3.3" xref="A6.SS2.p1.4.m4.1.1.3.3.3.cmml">B</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.4.m4.1b"><apply id="A6.SS2.p1.4.m4.1.1.cmml" xref="A6.SS2.p1.4.m4.1.1"><plus id="A6.SS2.p1.4.m4.1.1.2.cmml" xref="A6.SS2.p1.4.m4.1.1.2"></plus><apply id="A6.SS2.p1.4.m4.1.1.1.cmml" xref="A6.SS2.p1.4.m4.1.1.1"><times id="A6.SS2.p1.4.m4.1.1.1.2.cmml" xref="A6.SS2.p1.4.m4.1.1.1.2"></times><apply id="A6.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="A6.SS2.p1.4.m4.1.1.1.1.1"><minus id="A6.SS2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="A6.SS2.p1.4.m4.1.1.1.1.1.1.1"></minus><cn type="integer" id="A6.SS2.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="A6.SS2.p1.4.m4.1.1.1.1.1.1.2">1</cn><ci id="A6.SS2.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="A6.SS2.p1.4.m4.1.1.1.1.1.1.3">𝜇</ci></apply><apply id="A6.SS2.p1.4.m4.1.1.1.3.cmml" xref="A6.SS2.p1.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="A6.SS2.p1.4.m4.1.1.1.3.1.cmml" xref="A6.SS2.p1.4.m4.1.1.1.3">subscript</csymbol><ci id="A6.SS2.p1.4.m4.1.1.1.3.2.cmml" xref="A6.SS2.p1.4.m4.1.1.1.3.2">𝜃</ci><ci id="A6.SS2.p1.4.m4.1.1.1.3.3.cmml" xref="A6.SS2.p1.4.m4.1.1.1.3.3">𝐴</ci></apply></apply><apply id="A6.SS2.p1.4.m4.1.1.3.cmml" xref="A6.SS2.p1.4.m4.1.1.3"><times id="A6.SS2.p1.4.m4.1.1.3.1.cmml" xref="A6.SS2.p1.4.m4.1.1.3.1"></times><ci id="A6.SS2.p1.4.m4.1.1.3.2.cmml" xref="A6.SS2.p1.4.m4.1.1.3.2">𝜇</ci><apply id="A6.SS2.p1.4.m4.1.1.3.3.cmml" xref="A6.SS2.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="A6.SS2.p1.4.m4.1.1.3.3.1.cmml" xref="A6.SS2.p1.4.m4.1.1.3.3">subscript</csymbol><ci id="A6.SS2.p1.4.m4.1.1.3.3.2.cmml" xref="A6.SS2.p1.4.m4.1.1.3.3.2">𝜃</ci><ci id="A6.SS2.p1.4.m4.1.1.3.3.3.cmml" xref="A6.SS2.p1.4.m4.1.1.3.3.3">𝐵</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.4.m4.1c">(1-\mu)\theta_{A}+\mu\theta_{B}</annotation></semantics></math>, <math id="A6.SS2.p1.5.m5.2" class="ltx_Math" alttext="\mu\in[0,1]" display="inline"><semantics id="A6.SS2.p1.5.m5.2a"><mrow id="A6.SS2.p1.5.m5.2.3" xref="A6.SS2.p1.5.m5.2.3.cmml"><mi id="A6.SS2.p1.5.m5.2.3.2" xref="A6.SS2.p1.5.m5.2.3.2.cmml">μ</mi><mo id="A6.SS2.p1.5.m5.2.3.1" xref="A6.SS2.p1.5.m5.2.3.1.cmml">∈</mo><mrow id="A6.SS2.p1.5.m5.2.3.3.2" xref="A6.SS2.p1.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="A6.SS2.p1.5.m5.2.3.3.2.1" xref="A6.SS2.p1.5.m5.2.3.3.1.cmml">[</mo><mn id="A6.SS2.p1.5.m5.1.1" xref="A6.SS2.p1.5.m5.1.1.cmml">0</mn><mo id="A6.SS2.p1.5.m5.2.3.3.2.2" xref="A6.SS2.p1.5.m5.2.3.3.1.cmml">,</mo><mn id="A6.SS2.p1.5.m5.2.2" xref="A6.SS2.p1.5.m5.2.2.cmml">1</mn><mo stretchy="false" id="A6.SS2.p1.5.m5.2.3.3.2.3" xref="A6.SS2.p1.5.m5.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.SS2.p1.5.m5.2b"><apply id="A6.SS2.p1.5.m5.2.3.cmml" xref="A6.SS2.p1.5.m5.2.3"><in id="A6.SS2.p1.5.m5.2.3.1.cmml" xref="A6.SS2.p1.5.m5.2.3.1"></in><ci id="A6.SS2.p1.5.m5.2.3.2.cmml" xref="A6.SS2.p1.5.m5.2.3.2">𝜇</ci><interval closure="closed" id="A6.SS2.p1.5.m5.2.3.3.1.cmml" xref="A6.SS2.p1.5.m5.2.3.3.2"><cn type="integer" id="A6.SS2.p1.5.m5.1.1.cmml" xref="A6.SS2.p1.5.m5.1.1">0</cn><cn type="integer" id="A6.SS2.p1.5.m5.2.2.cmml" xref="A6.SS2.p1.5.m5.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS2.p1.5.m5.2c">\mu\in[0,1]</annotation></semantics></math>. Directly averaging these two models will perform poorly, which is shown in Fig <a href="#A5.F31" title="Figure 31 ‣ Appendix E Additional Experimental Results ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">31</span></a> (the line with legend “Avg”). If we align the models via optimal transport and then interpolate the aligned models, the results become better (the line with legend “OT+Avg” in Fig <a href="#A5.F31" title="Figure 31 ‣ Appendix E Additional Experimental Results ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">31</span></a>). We further add PANs during model training and the performances could be slightly improved (the line with legend “PANs+OT+Avg” in Fig <a href="#A5.F31" title="Figure 31 ‣ Appendix E Additional Experimental Results ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">31</span></a>). This shows that PANs may still be helpful with different initializations.</p>
</div>
</section>
<section id="A6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.3 </span>BatchNorm vs. GroupNorm</h3>

<div id="A6.SS3.p1" class="ltx_para">
<p id="A6.SS3.p1.1" class="ltx_p">We then investigate the normalization techniques in deep neural networks. Previous FL works point out that GroupNorm may be more applicable to FL with non-iid data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Specifically, BatchNorm calculates the mean and variance of a data batch, which is relevant to local training data. Hence, the statistical information in BatchNorm will diverge a lot across clients. One solution is aggregating the statistical information during FL, i.e., averaging the “running mean” and “running variance” in BatchNorm. We denote this as “BN-Y”. In contrast, we use “BY-N” to represent the method that “running mean” and “running variance” are not aggregated. We also vary the number of groups in GroupNorm, i.e., <math id="A6.SS3.p1.1.m1.4" class="ltx_Math" alttext="\{1,2,8,32\}" display="inline"><semantics id="A6.SS3.p1.1.m1.4a"><mrow id="A6.SS3.p1.1.m1.4.5.2" xref="A6.SS3.p1.1.m1.4.5.1.cmml"><mo stretchy="false" id="A6.SS3.p1.1.m1.4.5.2.1" xref="A6.SS3.p1.1.m1.4.5.1.cmml">{</mo><mn id="A6.SS3.p1.1.m1.1.1" xref="A6.SS3.p1.1.m1.1.1.cmml">1</mn><mo id="A6.SS3.p1.1.m1.4.5.2.2" xref="A6.SS3.p1.1.m1.4.5.1.cmml">,</mo><mn id="A6.SS3.p1.1.m1.2.2" xref="A6.SS3.p1.1.m1.2.2.cmml">2</mn><mo id="A6.SS3.p1.1.m1.4.5.2.3" xref="A6.SS3.p1.1.m1.4.5.1.cmml">,</mo><mn id="A6.SS3.p1.1.m1.3.3" xref="A6.SS3.p1.1.m1.3.3.cmml">8</mn><mo id="A6.SS3.p1.1.m1.4.5.2.4" xref="A6.SS3.p1.1.m1.4.5.1.cmml">,</mo><mn id="A6.SS3.p1.1.m1.4.4" xref="A6.SS3.p1.1.m1.4.4.cmml">32</mn><mo stretchy="false" id="A6.SS3.p1.1.m1.4.5.2.5" xref="A6.SS3.p1.1.m1.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.SS3.p1.1.m1.4b"><set id="A6.SS3.p1.1.m1.4.5.1.cmml" xref="A6.SS3.p1.1.m1.4.5.2"><cn type="integer" id="A6.SS3.p1.1.m1.1.1.cmml" xref="A6.SS3.p1.1.m1.1.1">1</cn><cn type="integer" id="A6.SS3.p1.1.m1.2.2.cmml" xref="A6.SS3.p1.1.m1.2.2">2</cn><cn type="integer" id="A6.SS3.p1.1.m1.3.3.cmml" xref="A6.SS3.p1.1.m1.3.3">8</cn><cn type="integer" id="A6.SS3.p1.1.m1.4.4.cmml" xref="A6.SS3.p1.1.m1.4.4">32</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A6.SS3.p1.1.m1.4c">\{1,2,8,32\}</annotation></semantics></math>, which are denoted as “GN1”, “GN2”, “GN8”, and “GN32”. We list the convergence curves on Cifar10 and Cifar100 in Fig. <a href="#A5.F32" title="Figure 32 ‣ Appendix E Additional Experimental Results ‣ Federated Learning with Position-Aware Neurons" class="ltx_ref"><span class="ltx_text ltx_ref_tag">32</span></a>. We use VGG11 and ResNet20 as the backbone. The numbers in the legends denote the final test accuracies. GroupNorm only improves the performances of Cifar10 with VGG11. Additionally, setting the number of groups as 1 is better. We also apply PANs to networks with “GN1” and find the performance does not improve. The combination of PANs with various normalization techniques is also interesting, which is also left for future work.</p>
</div>
</section>
<section id="A6.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">F.4 </span>Personalization in FL</h3>

<div id="A6.SS4.p1" class="ltx_para">
<p id="A6.SS4.p1.1" class="ltx_p">Finally, we present some possible varieties of PANs for personalization in FL. In the body of this paper, we take the same position encodings among clients and implicitly make neurons combined with their positions. However, if we take different position encodings or partially shared position encodings among clients, we could let similar clients contribute more. Some clients own individual positions, which could be utilized for personalization. These ideas are also left for future work.</p>
</div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2203.14665" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2203.14666" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2203.14666">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2203.14666" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2203.14667" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 03:34:17 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
