<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2210.01961] Split Federated Learning on Micro-controllers: A Keyword Spotting Showcase</title><meta property="og:description" content="Nowadays, AI companies improve service quality by aggressively collecting users’ data generated by edge devices, which jeopardizes data privacy.
To prevent this, Federated Learning is proposed as a private learning sch…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Split Federated Learning on Micro-controllers: A Keyword Spotting Showcase">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Split Federated Learning on Micro-controllers: A Keyword Spotting Showcase">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2210.01961">

<!--Generated on Thu Mar 14 04:42:28 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="TinyML,  Federated Learning,  Keyword Spotting">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Split Federated Learning on Micro-controllers: A Keyword Spotting Showcase</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jingtao Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_affiliation_institution">ASU</span><span id="id2.2.id2" class="ltx_text ltx_affiliation_city">Tempe</span><span id="id3.3.id3" class="ltx_text ltx_affiliation_country">USA</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Runcong Kuang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id4.1.id1" class="ltx_text ltx_affiliation_institution">ASU</span><span id="id5.2.id2" class="ltx_text ltx_affiliation_city">Tempe</span><span id="id6.3.id3" class="ltx_text ltx_affiliation_country">USA</span>
</span></span></span>
</div>
<div class="ltx_dates">(2022)</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id7.id1" class="ltx_p">Nowadays, AI companies improve service quality by aggressively collecting users’ data generated by edge devices, which jeopardizes data privacy.
To prevent this, Federated Learning is proposed as a private learning scheme, using which users can locally train the model without collecting users’ raw data to servers.
However, for machine-learning applications on edge devices that have hard memory constraints, implementing a large model using FL is infeasible.
To meet the memory requirement, a recent collaborative learning scheme named split federal learning is a potential solution since it keeps a small model on the device and keeps the rest of the model on the server. In this work, we implement a simply SFL framework on the Arduino board and verify its correctness on the Chinese digits audio dataset for keyword spotting application with over 90% accuracy. Furthermore, on the English digits audio dataset, our SFL implementation achieves 13.89% higher accuracy compared to a state-of-the-art FL implementation.
</p>
</div>
<div class="ltx_keywords">TinyML, Federated Learning, Keyword Spotting
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_journalyear"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2022</span></span></span><span id="id3" class="ltx_note ltx_note_frontmatter ltx_role_doi"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span id="id4" class="ltx_note ltx_note_frontmatter ltx_role_conference"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct
conference title from your rights confirmation emai; June 03–05,
2022; Woodstock, NY</span></span></span><span id="id5" class="ltx_note ltx_note_frontmatter ltx_role_price"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span id="id6" class="ltx_note ltx_note_frontmatter ltx_role_isbn"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Increasing accessibility of edge computing devices has shown great impact on our daily life, and at the same time, their generated data powers up machine learning applications such as computer vision and voice recognition. However, as these devices are close to our living environment, it starts to raise concern on the data privacy. General Data Protection Regulation (GDPR) that is recently approved by European Union imposes a strong limitation on collecting data from users. In this context, how to utilize these valuable data while comply with GDPR is still a challenge for AI community.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In fact, private schemes such as multi-party computation (MPC)<cite class="ltx_cite ltx_citemacro_citep">(Goldreich, <a href="#bib.bib3" title="" class="ltx_ref">1998</a>)</cite> and homomorphic encryption (HE) can enable provable privacy while handling users’ data. However, the large overhead of computation and communication of these private methods are not practical for public use (though they can be good for cross-silo use case). Thus, companies start to investigate cheap but privacy-preserving learning schemes. Google presents Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2017</a>)</cite> as one of these schemes and deploy it in its Google assistant and Google Keyboard applications.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The key idea of FL is to prevent users’ data from leaving the device. In its design, each user acquires a local copy of the model, train it on user’s own private data, and send the updated parameters to the server periodically. Server, once collecting updated parameters from all users, perform an average (as in FedAvg<cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2017</a>)</cite>) to get the global model updated and transfer to user for training in the next round. For the first time, <cite class="ltx_cite ltx_citemacro_citep">(Llisterri Giménez et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite> brings the Federated Learning idea to the TinyML community, where they are able to demonstrate the successful implementation of FL in a tiny micro-controller for a 2-layer MLP model in a binary keyword classification problem.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">A clear limitation of using FL is that it requires user have the ability to train the entire model locally on the device. For embedded systems which are extremely constrained by memory and power, training locally is not possible for an industry-scale model. Thus, <cite class="ltx_cite ltx_citemacro_citep">(Llisterri Giménez et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite> uses a tiny 2-layer MLP of 16K parameter, mostly in the concern of the limited SRAM of the micro-controller.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">For more complex datasets and use cases, model has to be larger. Thus, we investigate the realization of Split Federated Learning (SFL) <cite class="ltx_cite ltx_citemacro_citep">(Thapa et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2022</a>)</cite> as an edge-friendly version of FL on a micro-controller. SFL, splits the model into two parts, client-side model and server-side model. Client-side model is designed to be small enough to run on the device and server-side model can be very large to achieve a good accuracy.
As a split version of Federated Learning, the raw data is also protected in SFL since it is processed pure in local devices. Moreover, SFL allows users to have only a small part of the model which can relieve the hardware requirement.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">In the scope of our project, we implemented SFL on Arduino Nano BLE 33 sense for a multi-class keyword classification task, where an audio dataset of digits pronounced in Chinese and English is classified respectively. By SFL, We are able to use very large model in training because server does not have memory limitation and has fast training speed. We compared different model sizes (FL’s and SFL’s) in terms of the model’s classification accuracy, and gave a proof-of-concept example of using SFL can achieve better performance than using FL in practice. We also demonstrated that SFL enables using bigger model to enhance the accuracy. SFL shows 13.89% better accuracy using a large CNN model compared to Federated Learning where only a small MLP can be used. After training, we compressed the entire model and put it back to the device. Then, the device can perform inference without dependence on the server. Moreover, we realized multi-client training to speed up the process, although they are processing in serial mode.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">In summary, we made several <span id="S1.p7.1.1" class="ltx_text ltx_font_bold">contributions</span>:</p>
</div>
<div id="S1.p8" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">For the first time, SFL is deployed on a micro-controller on an extremely low-power and low cost embedded system, for a meaningful digit-spotting application.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We demonstrate using SFL breaks the hard memory limitation of training a large model. The resulting large model can achieve better performance than a small model which is constrained under the case of FL implementation.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">As the inference of conventional SFL is also dependent on remote communication with a server, to speed it up, after training is done, we compress the entire model and convert it to a TensorFlow-lite model for easy deployment.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p9" class="ltx_para">
<p id="S1.p9.1" class="ltx_p">The structure of the rest of the paper is as follows: in section 2 we will go over the related works, system design is introduced in section 3, and a thorough evaluation is done in section 4. Finally, section 5 concludes this work.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Secure Computation &amp; Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Secure multi-party computation and homomorphic encryption are two well-established computational scheme that guarantees the data privacy. However, these are hard to implement for public use and thus heuristic private learning scheme such as FL are proposed and used in practice for cross-client collaborative learning.
FL, first proposed by <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2017</a>)</cite>, has achieved great amount of attention. But due to its requirement on user that training needs to be done locally, it may not be the optimal solution for micro-controller use cases, especially to solve meaningful and complicated tasks.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Split Federated Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">SFL <cite class="ltx_cite ltx_citemacro_citep">(Thapa et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2022</a>)</cite> has been proposed as a parallel version of Split Learning <cite class="ltx_cite ltx_citemacro_citep">(Vepakomma et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2018</a>)</cite> (SL), by incorporating the model aggregation idea of FL. It separates the global model into two part, client-side model and server-side model.
At each round, each client gets the up-to-date client-side model from the server, and perform forward propagation on its private data, send only the label of the data, and output (intermediate activation) of client-side model to the server. Server accepts the activation, continue forward propagation on the server-side model and compute the loss on the logits and label. Backward propagation is done at the server and the server-side model is updated, then, the gradients w.r.t. the activation is transmitted to the client from the server. Clients continue the backward-propagation and update its client-model. The above process can happen in parallel for multiple clients and clients can get different copies of client-side model since they train on different data. Thus, at the end of each round, server would collect all the local copies of the client-side model and perform a central aggregation, similar to FedAvg.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Apart from its strength, SFL has two known problems, one is its communication overhead and the other is its vulnerability to model inversion attacks. Recent works <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2021</a>; Titcombe et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite> have addressed these weaknesses in some extent, but these are still need to be cautiously evaluated.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>System Design</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Overall system</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p"><span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_bold">Platform.</span>
We use Arduino Nano 33 BLE board as the main demonstration platform for this work. The board has a 2-bit ARM Cortex-M4 CPU running at 64 MHz with 256KB SRAM and 1MB Flash memory, operating at 3.3V.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p"><span id="S3.SS1.p2.1.1" class="ltx_text ltx_font_bold">Preparation.</span>
To perform the SFL training, as the data labeling and storage function has not been supported yet. We simulate the data collection, we store the client’s data on another PC and transfer to the board using serial port.
Then, the board locally performs the Mel-frequency cepstral coefficients (MFCC) for audio data preprocessing following and pass the MFCC feature to the client-side model.
We use the pc as the server as well as the main control of the whole process including communication, which can also store public and pre-collected dataset for pre-training and training. In addition, We use pc for simulation of additional boards virtually as we don’t have more boards. The board equipped with the microphone can be used to collect real-time data for inference, but it’s hard to collect data to do the training because it has limited storage space and it’s hard to let users label data only on board synchronously, which is left for future work.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p"><span id="S3.SS1.p3.1.1" class="ltx_text ltx_font_bold">SFL training.</span>
Figure <a href="#S3.F1" title="Figure 1 ‣ 3.1. Overall system ‣ 3. System Design ‣ Split Federated Learning on Micro-controllers: A Keyword Spotting Showcase" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the overall system design of SFL setup. The model is divided into two sides: client model (on-board) and server model (on server/pc). These two parts are connected by the serial link and serial ports.
The detailed process of SFL training is shown in algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.1. Overall system ‣ 3. System Design ‣ Split Federated Learning on Micro-controllers: A Keyword Spotting Showcase" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Board preprocesses the raw audio using MFCC and process the MFCC features on client-side model, and send the intermediate activation to the server together with labels.
Then the server continues the training, using the label and computed logits to generate the loss. Then, server performs backward-propagation and send the gradients to the board.
to get both client-side model and erver-side model updated.
After each epoch of training, local copies of client-side model from multiple devices is aggregated in the server and the aggregated weight is distributed to clients.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2210.01961/assets/SFL_sys.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="118" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Overall System</figcaption>
</figure>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Split Federated Learning</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>      For <math id="alg1.l0.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">M</annotation></semantics></math> clients, instantiate private training data (<math id="alg1.l0.m3.2" class="ltx_Math" alttext="X_{i},Y_{i}" display="inline"><semantics id="alg1.l0.m3.2a"><mrow id="alg1.l0.m3.2.2.2" xref="alg1.l0.m3.2.2.3.cmml"><msub id="alg1.l0.m3.1.1.1.1" xref="alg1.l0.m3.1.1.1.1.cmml"><mi id="alg1.l0.m3.1.1.1.1.2" xref="alg1.l0.m3.1.1.1.1.2.cmml">X</mi><mi id="alg1.l0.m3.1.1.1.1.3" xref="alg1.l0.m3.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l0.m3.2.2.2.3" xref="alg1.l0.m3.2.2.3.cmml">,</mo><msub id="alg1.l0.m3.2.2.2.2" xref="alg1.l0.m3.2.2.2.2.cmml"><mi id="alg1.l0.m3.2.2.2.2.2" xref="alg1.l0.m3.2.2.2.2.2.cmml">Y</mi><mi id="alg1.l0.m3.2.2.2.2.3" xref="alg1.l0.m3.2.2.2.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.2b"><list id="alg1.l0.m3.2.2.3.cmml" xref="alg1.l0.m3.2.2.2"><apply id="alg1.l0.m3.1.1.1.1.cmml" xref="alg1.l0.m3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m3.1.1.1.1.1.cmml" xref="alg1.l0.m3.1.1.1.1">subscript</csymbol><ci id="alg1.l0.m3.1.1.1.1.2.cmml" xref="alg1.l0.m3.1.1.1.1.2">𝑋</ci><ci id="alg1.l0.m3.1.1.1.1.3.cmml" xref="alg1.l0.m3.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l0.m3.2.2.2.2.cmml" xref="alg1.l0.m3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l0.m3.2.2.2.2.1.cmml" xref="alg1.l0.m3.2.2.2.2">subscript</csymbol><ci id="alg1.l0.m3.2.2.2.2.2.cmml" xref="alg1.l0.m3.2.2.2.2.2">𝑌</ci><ci id="alg1.l0.m3.2.2.2.2.3.cmml" xref="alg1.l0.m3.2.2.2.2.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.2c">X_{i},Y_{i}</annotation></semantics></math>) for <math id="alg1.l0.m4.4" class="ltx_Math" alttext="1,2,...,M" display="inline"><semantics id="alg1.l0.m4.4a"><mrow id="alg1.l0.m4.4.5.2" xref="alg1.l0.m4.4.5.1.cmml"><mn id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml">1</mn><mo id="alg1.l0.m4.4.5.2.1" xref="alg1.l0.m4.4.5.1.cmml">,</mo><mn id="alg1.l0.m4.2.2" xref="alg1.l0.m4.2.2.cmml">2</mn><mo id="alg1.l0.m4.4.5.2.2" xref="alg1.l0.m4.4.5.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l0.m4.3.3" xref="alg1.l0.m4.3.3.cmml">…</mi><mo id="alg1.l0.m4.4.5.2.3" xref="alg1.l0.m4.4.5.1.cmml">,</mo><mi id="alg1.l0.m4.4.4" xref="alg1.l0.m4.4.4.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.4b"><list id="alg1.l0.m4.4.5.1.cmml" xref="alg1.l0.m4.4.5.2"><cn type="integer" id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1">1</cn><cn type="integer" id="alg1.l0.m4.2.2.cmml" xref="alg1.l0.m4.2.2">2</cn><ci id="alg1.l0.m4.3.3.cmml" xref="alg1.l0.m4.3.3">…</ci><ci id="alg1.l0.m4.4.4.cmml" xref="alg1.l0.m4.4.4">𝑀</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.4c">1,2,...,M</annotation></semantics></math>. The entire DNN model of <math id="alg1.l0.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l0.m5.1a"><mi id="alg1.l0.m5.1.1" xref="alg1.l0.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.1b"><ci id="alg1.l0.m5.1.1.cmml" xref="alg1.l0.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.1c">L</annotation></semantics></math> layers is split to server-side model <math id="alg1.l0.m6.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg1.l0.m6.1a"><mi id="alg1.l0.m6.1.1" xref="alg1.l0.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m6.1b"><ci id="alg1.l0.m6.1.1.cmml" xref="alg1.l0.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m6.1c">S</annotation></semantics></math> and client-side model <math id="alg1.l0.m7.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="alg1.l0.m7.1a"><msub id="alg1.l0.m7.1.1" xref="alg1.l0.m7.1.1.cmml"><mi id="alg1.l0.m7.1.1.2" xref="alg1.l0.m7.1.1.2.cmml">C</mi><mi id="alg1.l0.m7.1.1.3" xref="alg1.l0.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m7.1b"><apply id="alg1.l0.m7.1.1.cmml" xref="alg1.l0.m7.1.1"><csymbol cd="ambiguous" id="alg1.l0.m7.1.1.1.cmml" xref="alg1.l0.m7.1.1">subscript</csymbol><ci id="alg1.l0.m7.1.1.2.cmml" xref="alg1.l0.m7.1.1.2">𝐶</ci><ci id="alg1.l0.m7.1.1.3.cmml" xref="alg1.l0.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m7.1c">C_{i}</annotation></semantics></math>.

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  initialize <math id="alg1.l1.m1.2" class="ltx_Math" alttext="C_{i},S" display="inline"><semantics id="alg1.l1.m1.2a"><mrow id="alg1.l1.m1.2.2.1" xref="alg1.l1.m1.2.2.2.cmml"><msub id="alg1.l1.m1.2.2.1.1" xref="alg1.l1.m1.2.2.1.1.cmml"><mi id="alg1.l1.m1.2.2.1.1.2" xref="alg1.l1.m1.2.2.1.1.2.cmml">C</mi><mi id="alg1.l1.m1.2.2.1.1.3" xref="alg1.l1.m1.2.2.1.1.3.cmml">i</mi></msub><mo id="alg1.l1.m1.2.2.1.2" xref="alg1.l1.m1.2.2.2.cmml">,</mo><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.2b"><list id="alg1.l1.m1.2.2.2.cmml" xref="alg1.l1.m1.2.2.1"><apply id="alg1.l1.m1.2.2.1.1.cmml" xref="alg1.l1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.2.cmml" xref="alg1.l1.m1.2.2.1.1.2">𝐶</ci><ci id="alg1.l1.m1.2.2.1.1.3.cmml" xref="alg1.l1.m1.2.2.1.1.3">𝑖</ci></apply><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑆</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.2c">C_{i},S</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2.2" class="ltx_text ltx_font_bold">for</span> epoch <math id="alg1.l2.m1.1" class="ltx_Math" alttext="t\leftarrow 1" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">t</mi><mo stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">t\leftarrow 1</annotation></semantics></math> to num_epochs <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <math id="alg1.l3.m1.1" class="ltx_Math" alttext="C^{*}=\frac{1}{M}\sum_{i=1}^{M}{C_{i}}" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><msup id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml"><mi id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">C</mi><mo id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">∗</mo></msup><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mrow id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mfrac id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml"><mn id="alg1.l3.m1.1.1.3.2.2" xref="alg1.l3.m1.1.1.3.2.2.cmml">1</mn><mi id="alg1.l3.m1.1.1.3.2.3" xref="alg1.l3.m1.1.1.3.2.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.1" xref="alg1.l3.m1.1.1.3.1.cmml">​</mo><mrow id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml"><msubsup id="alg1.l3.m1.1.1.3.3.1" xref="alg1.l3.m1.1.1.3.3.1.cmml"><mo id="alg1.l3.m1.1.1.3.3.1.2.2" xref="alg1.l3.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l3.m1.1.1.3.3.1.2.3" xref="alg1.l3.m1.1.1.3.3.1.2.3.cmml"><mi id="alg1.l3.m1.1.1.3.3.1.2.3.2" xref="alg1.l3.m1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="alg1.l3.m1.1.1.3.3.1.2.3.1" xref="alg1.l3.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="alg1.l3.m1.1.1.3.3.1.2.3.3" xref="alg1.l3.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l3.m1.1.1.3.3.1.3" xref="alg1.l3.m1.1.1.3.3.1.3.cmml">M</mi></msubsup><msub id="alg1.l3.m1.1.1.3.3.2" xref="alg1.l3.m1.1.1.3.3.2.cmml"><mi id="alg1.l3.m1.1.1.3.3.2.2" xref="alg1.l3.m1.1.1.3.3.2.2.cmml">C</mi><mi id="alg1.l3.m1.1.1.3.3.2.3" xref="alg1.l3.m1.1.1.3.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2">superscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">𝐶</ci><times id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3"></times></apply><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><times id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.1"></times><apply id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2"><divide id="alg1.l3.m1.1.1.3.2.1.cmml" xref="alg1.l3.m1.1.1.3.2"></divide><cn type="integer" id="alg1.l3.m1.1.1.3.2.2.cmml" xref="alg1.l3.m1.1.1.3.2.2">1</cn><ci id="alg1.l3.m1.1.1.3.2.3.cmml" xref="alg1.l3.m1.1.1.3.2.3">𝑀</ci></apply><apply id="alg1.l3.m1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.3.3"><apply id="alg1.l3.m1.1.1.3.3.1.cmml" xref="alg1.l3.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.3.1.1.cmml" xref="alg1.l3.m1.1.1.3.3.1">superscript</csymbol><apply id="alg1.l3.m1.1.1.3.3.1.2.cmml" xref="alg1.l3.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.3.1.2.1.cmml" xref="alg1.l3.m1.1.1.3.3.1">subscript</csymbol><sum id="alg1.l3.m1.1.1.3.3.1.2.2.cmml" xref="alg1.l3.m1.1.1.3.3.1.2.2"></sum><apply id="alg1.l3.m1.1.1.3.3.1.2.3.cmml" xref="alg1.l3.m1.1.1.3.3.1.2.3"><eq id="alg1.l3.m1.1.1.3.3.1.2.3.1.cmml" xref="alg1.l3.m1.1.1.3.3.1.2.3.1"></eq><ci id="alg1.l3.m1.1.1.3.3.1.2.3.2.cmml" xref="alg1.l3.m1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.l3.m1.1.1.3.3.1.2.3.3.cmml" xref="alg1.l3.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l3.m1.1.1.3.3.1.3.cmml" xref="alg1.l3.m1.1.1.3.3.1.3">𝑀</ci></apply><apply id="alg1.l3.m1.1.1.3.3.2.cmml" xref="alg1.l3.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.3.2.1.cmml" xref="alg1.l3.m1.1.1.3.3.2">subscript</csymbol><ci id="alg1.l3.m1.1.1.3.3.2.2.cmml" xref="alg1.l3.m1.1.1.3.3.2.2">𝐶</ci><ci id="alg1.l3.m1.1.1.3.3.2.3.cmml" xref="alg1.l3.m1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">C^{*}=\frac{1}{M}\sum_{i=1}^{M}{C_{i}}</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text" style="float:right;">{<span id="alg1.l3.2.1" class="ltx_text" style="color:#0000FF;">Model Synchronization</span>}
</span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <math id="alg1.l4.m1.1" class="ltx_Math" alttext="C_{i}\leftarrow C^{*}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">C</mi><mi id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">←</mo><msup id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">C</mi><mo id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">←</ci><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">𝐶</ci><ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3">superscript</csymbol><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">𝐶</ci><times id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">C_{i}\leftarrow C^{*}</annotation></semantics></math> for all <math id="alg1.l4.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l4.m2.1a"><mi id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">i</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg1.l5.2" class="ltx_text ltx_font_bold">for</span> step <math id="alg1.l5.m1.1" class="ltx_Math" alttext="s\leftarrow 1" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">s</mi><mo stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><mn id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑠</ci><cn type="integer" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">s\leftarrow 1</annotation></semantics></math> to num_batches  <span id="alg1.l5.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        <span id="alg1.l6.2" class="ltx_text ltx_font_bold">for</span> client <math id="alg1.l6.m1.1" class="ltx_Math" alttext="i\leftarrow 1" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">i</mi><mo stretchy="false" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">←</mo><mn id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">i\leftarrow 1</annotation></semantics></math> to <math id="alg1.l6.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l6.m2.1a"><mi id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><ci id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">M</annotation></semantics></math> <span id="alg1.l6.3" class="ltx_text ltx_font_bold">in Parallel</span> <span id="alg1.l6.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>           data batch (<math id="alg1.l7.m1.2" class="ltx_Math" alttext="x_{i},y_{i}" display="inline"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.2.2" xref="alg1.l7.m1.2.2.3.cmml"><msub id="alg1.l7.m1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.2.cmml">x</mi><mi id="alg1.l7.m1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l7.m1.2.2.2.3" xref="alg1.l7.m1.2.2.3.cmml">,</mo><msub id="alg1.l7.m1.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.cmml"><mi id="alg1.l7.m1.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.cmml">y</mi><mi id="alg1.l7.m1.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><list id="alg1.l7.m1.2.2.3.cmml" xref="alg1.l7.m1.2.2.2"><apply id="alg1.l7.m1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.2">𝑥</ci><ci id="alg1.l7.m1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l7.m1.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.1.cmml" xref="alg1.l7.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l7.m1.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2">𝑦</ci><ci id="alg1.l7.m1.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">x_{i},y_{i}</annotation></semantics></math>) <math id="alg1.l7.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l7.m2.1a"><mo stretchy="false" id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">\leftarrow</annotation></semantics></math> (<math id="alg1.l7.m3.2" class="ltx_Math" alttext="X_{i},Y_{i}" display="inline"><semantics id="alg1.l7.m3.2a"><mrow id="alg1.l7.m3.2.2.2" xref="alg1.l7.m3.2.2.3.cmml"><msub id="alg1.l7.m3.1.1.1.1" xref="alg1.l7.m3.1.1.1.1.cmml"><mi id="alg1.l7.m3.1.1.1.1.2" xref="alg1.l7.m3.1.1.1.1.2.cmml">X</mi><mi id="alg1.l7.m3.1.1.1.1.3" xref="alg1.l7.m3.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l7.m3.2.2.2.3" xref="alg1.l7.m3.2.2.3.cmml">,</mo><msub id="alg1.l7.m3.2.2.2.2" xref="alg1.l7.m3.2.2.2.2.cmml"><mi id="alg1.l7.m3.2.2.2.2.2" xref="alg1.l7.m3.2.2.2.2.2.cmml">Y</mi><mi id="alg1.l7.m3.2.2.2.2.3" xref="alg1.l7.m3.2.2.2.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.2b"><list id="alg1.l7.m3.2.2.3.cmml" xref="alg1.l7.m3.2.2.2"><apply id="alg1.l7.m3.1.1.1.1.cmml" xref="alg1.l7.m3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m3.1.1.1.1.1.cmml" xref="alg1.l7.m3.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m3.1.1.1.1.2.cmml" xref="alg1.l7.m3.1.1.1.1.2">𝑋</ci><ci id="alg1.l7.m3.1.1.1.1.3.cmml" xref="alg1.l7.m3.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l7.m3.2.2.2.2.cmml" xref="alg1.l7.m3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m3.2.2.2.2.1.cmml" xref="alg1.l7.m3.2.2.2.2">subscript</csymbol><ci id="alg1.l7.m3.2.2.2.2.2.cmml" xref="alg1.l7.m3.2.2.2.2.2">𝑌</ci><ci id="alg1.l7.m3.2.2.2.2.3.cmml" xref="alg1.l7.m3.2.2.2.2.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.2c">X_{i},Y_{i}</annotation></semantics></math>)

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.2.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>           <math id="alg1.l8.m1.2" class="ltx_Math" alttext="A_{i}=C_{i}(W_{C_{i}};x_{i})" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml"><msub id="alg1.l8.m1.2.2.4" xref="alg1.l8.m1.2.2.4.cmml"><mi id="alg1.l8.m1.2.2.4.2" xref="alg1.l8.m1.2.2.4.2.cmml">A</mi><mi id="alg1.l8.m1.2.2.4.3" xref="alg1.l8.m1.2.2.4.3.cmml">i</mi></msub><mo id="alg1.l8.m1.2.2.3" xref="alg1.l8.m1.2.2.3.cmml">=</mo><mrow id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.2.cmml"><msub id="alg1.l8.m1.2.2.2.4" xref="alg1.l8.m1.2.2.2.4.cmml"><mi id="alg1.l8.m1.2.2.2.4.2" xref="alg1.l8.m1.2.2.2.4.2.cmml">C</mi><mi id="alg1.l8.m1.2.2.2.4.3" xref="alg1.l8.m1.2.2.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.3" xref="alg1.l8.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l8.m1.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.cmml">W</mi><msub id="alg1.l8.m1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.1.1.1.3.2.cmml">C</mi><mi id="alg1.l8.m1.1.1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="alg1.l8.m1.2.2.2.2.2.4" xref="alg1.l8.m1.2.2.2.2.3.cmml">;</mo><msub id="alg1.l8.m1.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.2.cmml">x</mi><mi id="alg1.l8.m1.2.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l8.m1.2.2.2.2.2.5" xref="alg1.l8.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"><eq id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2.3"></eq><apply id="alg1.l8.m1.2.2.4.cmml" xref="alg1.l8.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.4.1.cmml" xref="alg1.l8.m1.2.2.4">subscript</csymbol><ci id="alg1.l8.m1.2.2.4.2.cmml" xref="alg1.l8.m1.2.2.4.2">𝐴</ci><ci id="alg1.l8.m1.2.2.4.3.cmml" xref="alg1.l8.m1.2.2.4.3">𝑖</ci></apply><apply id="alg1.l8.m1.2.2.2.cmml" xref="alg1.l8.m1.2.2.2"><times id="alg1.l8.m1.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.3"></times><apply id="alg1.l8.m1.2.2.2.4.cmml" xref="alg1.l8.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.4.1.cmml" xref="alg1.l8.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.4.2.cmml" xref="alg1.l8.m1.2.2.2.4.2">𝐶</ci><ci id="alg1.l8.m1.2.2.2.4.3.cmml" xref="alg1.l8.m1.2.2.2.4.3">𝑖</ci></apply><list id="alg1.l8.m1.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2"><apply id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2">𝑊</ci><apply id="alg1.l8.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.2">𝐶</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="alg1.l8.m1.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2">𝑥</ci><ci id="alg1.l8.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">A_{i}=C_{i}(W_{C_{i}};x_{i})</annotation></semantics></math> <span id="alg1.l8.1" class="ltx_text" style="float:right;">{<span id="alg1.l8.1.1" class="ltx_text" style="color:#0000FF;">Client forward; send <math id="alg1.l8.1.1.m1.1" class="ltx_Math" alttext="A_{i}" display="inline"><semantics id="alg1.l8.1.1.m1.1a"><msub id="alg1.l8.1.1.m1.1.1" xref="alg1.l8.1.1.m1.1.1.cmml"><mi mathcolor="#0000FF" id="alg1.l8.1.1.m1.1.1.2" xref="alg1.l8.1.1.m1.1.1.2.cmml">A</mi><mi mathcolor="#0000FF" id="alg1.l8.1.1.m1.1.1.3" xref="alg1.l8.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.1.1.m1.1b"><apply id="alg1.l8.1.1.m1.1.1.cmml" xref="alg1.l8.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.1.1.m1.1.1.1.cmml" xref="alg1.l8.1.1.m1.1.1">subscript</csymbol><ci id="alg1.l8.1.1.m1.1.1.2.cmml" xref="alg1.l8.1.1.m1.1.1.2">𝐴</ci><ci id="alg1.l8.1.1.m1.1.1.3.cmml" xref="alg1.l8.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.1.m1.1c">A_{i}</annotation></semantics></math> to Server</span>}

</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>        <span id="alg1.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>        <span id="alg1.l10.2" class="ltx_text ltx_font_bold">for</span> client <math id="alg1.l10.m1.1" class="ltx_Math" alttext="i\leftarrow 1" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">i</mi><mo stretchy="false" id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">←</mo><mn id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">i\leftarrow 1</annotation></semantics></math> to <math id="alg1.l10.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l10.m2.1a"><mi id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">M</annotation></semantics></math> <span id="alg1.l10.3" class="ltx_text ltx_font_bold">in Sequential</span> <span id="alg1.l10.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>           <math id="alg1.l11.m1.2" class="ltx_Math" alttext="l=l_{CE}(S(W_{S};A_{i}),y_{i})" display="inline"><semantics id="alg1.l11.m1.2a"><mrow id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml"><mi id="alg1.l11.m1.2.2.4" xref="alg1.l11.m1.2.2.4.cmml">l</mi><mo id="alg1.l11.m1.2.2.3" xref="alg1.l11.m1.2.2.3.cmml">=</mo><mrow id="alg1.l11.m1.2.2.2" xref="alg1.l11.m1.2.2.2.cmml"><msub id="alg1.l11.m1.2.2.2.4" xref="alg1.l11.m1.2.2.2.4.cmml"><mi id="alg1.l11.m1.2.2.2.4.2" xref="alg1.l11.m1.2.2.2.4.2.cmml">l</mi><mrow id="alg1.l11.m1.2.2.2.4.3" xref="alg1.l11.m1.2.2.2.4.3.cmml"><mi id="alg1.l11.m1.2.2.2.4.3.2" xref="alg1.l11.m1.2.2.2.4.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.2.2.2.4.3.1" xref="alg1.l11.m1.2.2.2.4.3.1.cmml">​</mo><mi id="alg1.l11.m1.2.2.2.4.3.3" xref="alg1.l11.m1.2.2.2.4.3.3.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg1.l11.m1.2.2.2.3" xref="alg1.l11.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l11.m1.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l11.m1.2.2.2.2.2.3" xref="alg1.l11.m1.2.2.2.2.3.cmml">(</mo><mrow id="alg1.l11.m1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.4" xref="alg1.l11.m1.1.1.1.1.1.1.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="alg1.l11.m1.1.1.1.1.1.1.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="alg1.l11.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="alg1.l11.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.3.cmml">S</mi></msub><mo id="alg1.l11.m1.1.1.1.1.1.1.2.2.4" xref="alg1.l11.m1.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="alg1.l11.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2.2.cmml">A</mi><mi id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l11.m1.1.1.1.1.1.1.2.2.5" xref="alg1.l11.m1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l11.m1.2.2.2.2.2.4" xref="alg1.l11.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l11.m1.2.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l11.m1.2.2.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg1.l11.m1.2.2.2.2.2.2.3" xref="alg1.l11.m1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l11.m1.2.2.2.2.2.5" xref="alg1.l11.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.2b"><apply id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2"><eq id="alg1.l11.m1.2.2.3.cmml" xref="alg1.l11.m1.2.2.3"></eq><ci id="alg1.l11.m1.2.2.4.cmml" xref="alg1.l11.m1.2.2.4">𝑙</ci><apply id="alg1.l11.m1.2.2.2.cmml" xref="alg1.l11.m1.2.2.2"><times id="alg1.l11.m1.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.3"></times><apply id="alg1.l11.m1.2.2.2.4.cmml" xref="alg1.l11.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.4.1.cmml" xref="alg1.l11.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l11.m1.2.2.2.4.2.cmml" xref="alg1.l11.m1.2.2.2.4.2">𝑙</ci><apply id="alg1.l11.m1.2.2.2.4.3.cmml" xref="alg1.l11.m1.2.2.2.4.3"><times id="alg1.l11.m1.2.2.2.4.3.1.cmml" xref="alg1.l11.m1.2.2.2.4.3.1"></times><ci id="alg1.l11.m1.2.2.2.4.3.2.cmml" xref="alg1.l11.m1.2.2.2.4.3.2">𝐶</ci><ci id="alg1.l11.m1.2.2.2.4.3.3.cmml" xref="alg1.l11.m1.2.2.2.4.3.3">𝐸</ci></apply></apply><interval closure="open" id="alg1.l11.m1.2.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.2"><apply id="alg1.l11.m1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1"><times id="alg1.l11.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3"></times><ci id="alg1.l11.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.4">𝑆</ci><list id="alg1.l11.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2"><apply id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.1.3">𝑆</ci></apply><apply id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2.2">𝐴</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply><apply id="alg1.l11.m1.2.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l11.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="alg1.l11.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.2c">l=l_{CE}(S(W_{S};A_{i}),y_{i})</annotation></semantics></math> <span id="alg1.l11.2" class="ltx_text" style="float:right;">{<span id="alg1.l11.2.1" class="ltx_text" style="color:#0000FF;">Server forward</span>}
</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.2.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>           <math id="alg1.l12.m1.1" class="ltx_Math" alttext="\nabla_{A_{i}}l\leftarrow" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mrow id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml"><msub id="alg1.l12.m1.1.1.2.1" xref="alg1.l12.m1.1.1.2.1.cmml"><mo id="alg1.l12.m1.1.1.2.1.2" xref="alg1.l12.m1.1.1.2.1.2.cmml">∇</mo><msub id="alg1.l12.m1.1.1.2.1.3" xref="alg1.l12.m1.1.1.2.1.3.cmml"><mi id="alg1.l12.m1.1.1.2.1.3.2" xref="alg1.l12.m1.1.1.2.1.3.2.cmml">A</mi><mi id="alg1.l12.m1.1.1.2.1.3.3" xref="alg1.l12.m1.1.1.2.1.3.3.cmml">i</mi></msub></msub><mi id="alg1.l12.m1.1.1.2.2" xref="alg1.l12.m1.1.1.2.2.cmml">l</mi></mrow><mo stretchy="false" id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">←</mo><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"><apply id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.1.cmml" xref="alg1.l12.m1.1.1.2.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.1.2.cmml" xref="alg1.l12.m1.1.1.2.1.2">∇</ci><apply id="alg1.l12.m1.1.1.2.1.3.cmml" xref="alg1.l12.m1.1.1.2.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.3.1.cmml" xref="alg1.l12.m1.1.1.2.1.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.1.3.2.cmml" xref="alg1.l12.m1.1.1.2.1.3.2">𝐴</ci><ci id="alg1.l12.m1.1.1.2.1.3.3.cmml" xref="alg1.l12.m1.1.1.2.1.3.3">𝑖</ci></apply></apply><ci id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2.2">𝑙</ci></apply><csymbol cd="latexml" id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\nabla_{A_{i}}l\leftarrow</annotation></semantics></math> back-propagation
<span id="alg1.l12.1" class="ltx_text" style="float:right;">{<span id="alg1.l12.1.1" class="ltx_text" style="color:#0000FF;">Send <math id="alg1.l12.1.1.m1.1" class="ltx_Math" alttext="\nabla_{A_{i}}l" display="inline"><semantics id="alg1.l12.1.1.m1.1a"><mrow id="alg1.l12.1.1.m1.1.1" xref="alg1.l12.1.1.m1.1.1.cmml"><msub id="alg1.l12.1.1.m1.1.1.1" xref="alg1.l12.1.1.m1.1.1.1.cmml"><mo mathcolor="#0000FF" id="alg1.l12.1.1.m1.1.1.1.2" xref="alg1.l12.1.1.m1.1.1.1.2.cmml">∇</mo><msub id="alg1.l12.1.1.m1.1.1.1.3" xref="alg1.l12.1.1.m1.1.1.1.3.cmml"><mi mathcolor="#0000FF" id="alg1.l12.1.1.m1.1.1.1.3.2" xref="alg1.l12.1.1.m1.1.1.1.3.2.cmml">A</mi><mi mathcolor="#0000FF" id="alg1.l12.1.1.m1.1.1.1.3.3" xref="alg1.l12.1.1.m1.1.1.1.3.3.cmml">i</mi></msub></msub><mi mathcolor="#0000FF" id="alg1.l12.1.1.m1.1.1.2" xref="alg1.l12.1.1.m1.1.1.2.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.1.1.m1.1b"><apply id="alg1.l12.1.1.m1.1.1.cmml" xref="alg1.l12.1.1.m1.1.1"><apply id="alg1.l12.1.1.m1.1.1.1.cmml" xref="alg1.l12.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.1.1.m1.1.1.1.1.cmml" xref="alg1.l12.1.1.m1.1.1.1">subscript</csymbol><ci id="alg1.l12.1.1.m1.1.1.1.2.cmml" xref="alg1.l12.1.1.m1.1.1.1.2">∇</ci><apply id="alg1.l12.1.1.m1.1.1.1.3.cmml" xref="alg1.l12.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.1.1.m1.1.1.1.3.1.cmml" xref="alg1.l12.1.1.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l12.1.1.m1.1.1.1.3.2.cmml" xref="alg1.l12.1.1.m1.1.1.1.3.2">𝐴</ci><ci id="alg1.l12.1.1.m1.1.1.1.3.3.cmml" xref="alg1.l12.1.1.m1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="alg1.l12.1.1.m1.1.1.2.cmml" xref="alg1.l12.1.1.m1.1.1.2">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.1.m1.1c">\nabla_{A_{i}}l</annotation></semantics></math> to Client</span>}

</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>        <span id="alg1.l13.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>        Update <math id="alg1.l14.m1.1" class="ltx_Math" alttext="W_{S}" display="inline"><semantics id="alg1.l14.m1.1a"><msub id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">W</mi><mi id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1">subscript</csymbol><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑊</ci><ci id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">W_{S}</annotation></semantics></math>;

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>        <span id="alg1.l15.2" class="ltx_text ltx_font_bold">for</span> client <math id="alg1.l15.m1.1" class="ltx_Math" alttext="i\leftarrow 1" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">i</mi><mo stretchy="false" id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">←</mo><mn id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1">←</ci><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">i\leftarrow 1</annotation></semantics></math> to <math id="alg1.l15.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l15.m2.1a"><mi id="alg1.l15.m2.1.1" xref="alg1.l15.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.m2.1b"><ci id="alg1.l15.m2.1.1.cmml" xref="alg1.l15.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m2.1c">M</annotation></semantics></math> <span id="alg1.l15.3" class="ltx_text ltx_font_bold">in Parallel</span> <span id="alg1.l15.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>           <math id="alg1.l16.m1.1" class="ltx_Math" alttext="\nabla_{x_{i}}l\leftarrow" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mrow id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml"><msub id="alg1.l16.m1.1.1.2.1" xref="alg1.l16.m1.1.1.2.1.cmml"><mo id="alg1.l16.m1.1.1.2.1.2" xref="alg1.l16.m1.1.1.2.1.2.cmml">∇</mo><msub id="alg1.l16.m1.1.1.2.1.3" xref="alg1.l16.m1.1.1.2.1.3.cmml"><mi id="alg1.l16.m1.1.1.2.1.3.2" xref="alg1.l16.m1.1.1.2.1.3.2.cmml">x</mi><mi id="alg1.l16.m1.1.1.2.1.3.3" xref="alg1.l16.m1.1.1.2.1.3.3.cmml">i</mi></msub></msub><mi id="alg1.l16.m1.1.1.2.2" xref="alg1.l16.m1.1.1.2.2.cmml">l</mi></mrow><mo stretchy="false" id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml">←</mo><mi id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1">←</ci><apply id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2"><apply id="alg1.l16.m1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1.2.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.2.1.1.cmml" xref="alg1.l16.m1.1.1.2.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.2.1.2.cmml" xref="alg1.l16.m1.1.1.2.1.2">∇</ci><apply id="alg1.l16.m1.1.1.2.1.3.cmml" xref="alg1.l16.m1.1.1.2.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.2.1.3.1.cmml" xref="alg1.l16.m1.1.1.2.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.2.1.3.2.cmml" xref="alg1.l16.m1.1.1.2.1.3.2">𝑥</ci><ci id="alg1.l16.m1.1.1.2.1.3.3.cmml" xref="alg1.l16.m1.1.1.2.1.3.3">𝑖</ci></apply></apply><ci id="alg1.l16.m1.1.1.2.2.cmml" xref="alg1.l16.m1.1.1.2.2">𝑙</ci></apply><csymbol cd="latexml" id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\nabla_{x_{i}}l\leftarrow</annotation></semantics></math> back-propagation
<span id="alg1.l16.2" class="ltx_text" style="float:right;">{<span id="alg1.l16.2.1" class="ltx_text" style="color:#0000FF;">Client backward</span>}
</span>
</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>           Update <math id="alg1.l17.m1.1" class="ltx_Math" alttext="W_{C_{i}}" display="inline"><semantics id="alg1.l17.m1.1a"><msub id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">W</mi><msub id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml">C</mi><mi id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">𝑊</ci><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2">𝐶</ci><ci id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">W_{C_{i}}</annotation></semantics></math>;


</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>        <span id="alg1.l18.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l18.3" class="ltx_text ltx_font_bold">for</span>

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>     <span id="alg1.l19.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.3" class="ltx_text ltx_font_bold">for</span>

</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>  <span id="alg1.l20.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l20.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
<br class="ltx_break ltx_break">
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Data Collection and Preprocessing</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">We collected audios of Chinese digits’ (from 1 to 5, plus ’silence’ and ’unknown’) pronunciation from us using the open-source edge impulse platform online. For each class, we collected 50 data. We We also used corresponding classes from the existed popular <em id="S3.SS2.p1.1.1" class="ltx_emph ltx_font_italic">Speech Command</em> <cite class="ltx_cite ltx_citemacro_citep">(Warden, <a href="#bib.bib9" title="" class="ltx_ref">2018</a>)</cite> dataset, which has 7000 data in total, in English. We name it as ENdigits.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">For data preprocessing, We used the embedded MFCC in edge impulse to preprocess data first, which is directly deployable on board. We also implement MFCC in python to enable fully training online to speed up the model’s hyper-parameters search. For the MFCC hyperparameter, we use a number of coefficients of 13, frame length of 0.02 with 0.02 stride. We use 32 filters and the FFT length of 256. And the normalization window size is set to 101.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">To perform the SFL training, as we cannot really collect data and train them in real time, we allow audio input of 1 second (16,000 samples) to be stored on another PC and transfer to the board using serial port.
After the board locally performs the MFCC (as implemented in <cite class="ltx_cite ltx_citemacro_citep">(Llisterri Giménez et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite>) followed by audio data preprocessing, MFCC’s features are passed to the client-side model.</p>
</div>
<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2210.01961/assets/x1.png" id="S3.F2.sf1.g1" class="ltx_graphics ltx_img_landscape" width="226" height="169" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Train Accuracy</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2210.01961/assets/x2.png" id="S3.F2.sf2.g1" class="ltx_graphics ltx_img_landscape" width="226" height="169" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Validation Accuracy</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Split Federated Learning on CNdigits dataset using MLP model.</figcaption>
</figure>
<figure id="S3.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2210.01961/assets/x3.png" id="S3.F3.sf1.g1" class="ltx_graphics ltx_img_landscape" width="138" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Model 1</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2210.01961/assets/x4.png" id="S3.F3.sf2.g1" class="ltx_graphics ltx_img_landscape" width="138" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Model 2</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S3.F3.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2210.01961/assets/x5.png" id="S3.F3.sf3.g1" class="ltx_graphics ltx_img_landscape" width="138" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Model 3</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Training accuracy of 3 models on ENdigits dataset.</figcaption>
</figure>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2210.01961/assets/res_conv.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="131" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Validation Accuracy of 3 models on ENdigits dataset.</figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Model Structure</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Because of the small size of memory space of the board, we need to carefully design the neural network architecture. For the client-side model, given the hardware restriction of the board, we can either choose a small 1-layer MLP model (650x25) on the client model, same as in<cite class="ltx_cite ltx_citemacro_citep">(Llisterri Giménez et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite> or a 1-layer Conv2D model with (12x1x3x3) size.
On the server side, we implement several models with different complexity. The detailed network topology is shown in Table <a href="#S3.T1" title="Table 1 ‣ 3.3. Model Structure ‣ 3. System Design ‣ Split Federated Learning on Micro-controllers: A Keyword Spotting Showcase" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>Network Options</figcaption>
<div id="S3.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:114.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(80.9pt,-21.4pt) scale(1.59516530707487,1.59516530707487) ;">
<table id="S3.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.1.1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S3.T1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="S3.T1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Client</span></th>
<th id="S3.T1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S3.T1.1.1.1.1.3.1" class="ltx_text ltx_font_bold">Server</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.1.2.1" class="ltx_tr">
<th id="S3.T1.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Model 1 (MLP)</th>
<td id="S3.T1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">FC25</td>
<td id="S3.T1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">FC7</td>
</tr>
<tr id="S3.T1.1.1.3.2" class="ltx_tr">
<th id="S3.T1.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Model 2 (CNN)</th>
<td id="S3.T1.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_bb" rowspan="2"><span id="S3.T1.1.1.3.2.2.1" class="ltx_text">Conv12x3x3</span></td>
<td id="S3.T1.1.1.3.2.3" class="ltx_td ltx_align_center">Conv16x3x3-FC128-FC7</td>
</tr>
<tr id="S3.T1.1.1.4.3" class="ltx_tr">
<th id="S3.T1.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Model 3 (CNN)</th>
<td id="S3.T1.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb">Conv30x3x3-FC256-FC7</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">MLP model is good enough for the easy dataset where feature maps are linearly separable. In the case, higher complexity in server model doesn’t help a lot. We choose 2-layer FC (650 * 25 * 7) as our baseline for SFL, which has 650 * 25 + 25 * 7 = 4725 parameters, with 4550 parameters on board.
It turns out that for small CNdigits dataset, MLP would work very well and we don’t need a very big CNN model. Typically, a large CNN can cause overfitting problem and gets even worse validation accuracy.
For the larger ENdigits dataset, we observe using a CNN model can get much better performance than the MLP. Thus, we design two Conv2D models for the server-side model, one with small output channel size of 16 and is connected with a FC layer with 128 neurons, and one with larger output channel of 30 and is connected with a FC layer with 256 neurons.
</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Training Hyperparameter</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">Due to the limitation of onboard resources, we keep the training batch size as 1. We set learning rate as 0.005 for CNN model and 0.0005 for MLP model. The SGD’s momentum is set as 0.6.
The training and validation split ratio is 9:1. The number of epochs for SFL is fixed at 3 epochs.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5. </span>Model implementation</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.1" class="ltx_p">For training, we used Pytorch to implement the server-side model in the server and use C++ to code the client-side model on the board. We also code the client-side model with MFCC in Pytorch to simulate other clients, to simiulate a multi-client SFL scheme.
After training, we transferred the entire Pytorch model to Keras model, by manually loading the weights, which causes us tons of trouble because of different layout of parameters in these two different framework. After that, the model is converted to TensorFlow lite with int8 quantization.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Evaluation Approach</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We use the validation accuracy (trained model’s prediction on the validation dataset) as the criteria to evaluate learning scheme’s performance.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Results</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Proof of Correctness</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">First We prove the correctness of our SFL implementation. We train model 1 using SFL on the Chinese digits (CNdigits) dataset and the result is shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2. Data Collection and Preprocessing ‣ 3. System Design ‣ Split Federated Learning on Micro-controllers: A Keyword Spotting Showcase" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We can see the model converges quickly in 70 rounds and converges to a high accuracy of above 90%.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Advantage of SFL</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">To show the advantage of SFL, We test both MLP model and CNN model on ENdigits. The FC model represents performance of FL as it cannot train the entire CNN on board. Two CNN models are made possible with SFL.
From the results shown in Figure<a href="#S3.F4" title="Figure 4 ‣ 3.2. Data Collection and Preprocessing ‣ 3. System Design ‣ Split Federated Learning on Micro-controllers: A Keyword Spotting Showcase" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>,
all models can reach over 80% training accuracy after 2 epochs of training. Because of SGD with batch size of 1, accuracy varies a lot in the training period. In addition, CNN shows a faster converge speed.
For validation accuracy, three models converge at 66.25%, 78.29%, 80.14%, respectively.
We conclude that larger and more complex model can generate higher performance than smaller models on ENdigits dataset.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Convert to TFlite</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">Server collects the final trained global model (combined of the client-side and server-side models). After transformation from Pytorch to Keras, Keras model is transformed into TFlite model with quantization enabled, to better fit into the size of the client device. Finally, the quantized TFlite model is able to be directly deployed on the Arduino board such that user can perform inference locally with low latency.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Conclusion</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">In conclusion, this project demonstrate that SFL shows clear advantage over FL because it can implement a larger CNN model. It can achieve both great utility than FL and better preserve user data privacy compared to centralized training.</p>
</div>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5. </span>Limitations and Future work</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.1" class="ltx_p"><span id="S5.SS5.p1.1.1" class="ltx_text ltx_font_bold">Limitations</span>
There is a workflow we find online for the model transformation between different framework: Pytorch -¿ ONNX -¿ TensorFlow -¿ TensorFlowlite (TFlite). This transformation is not suitable for final deployment on a micro-controller as the <em id="S5.SS5.p1.1.2" class="ltx_emph ltx_font_italic">Transpose</em> operation is not yet supported by TFlite micro library, which is needed to handle the different layout of the shape of weight in conv2d layer in Pytorch and TensorFlow.
Thus, we can only take this approach: Pytorch -¿ Keras -¿ TFlite. Convert Pytorch model into Keras needs reinstantiate of the model in Keras and load the Pytorch weight in.
However, as the Keras and Pytorch have different weight format, we spent extra effort in the conversion. Because of this delay, we don’t have time for the final deployment &amp; on-board testing.</p>
</div>
<div id="S5.SS5.p2" class="ltx_para">
<p id="S5.SS5.p2.1" class="ltx_p"><span id="S5.SS5.p2.1.1" class="ltx_text ltx_font_bold">Future works</span></p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p">Bluetooth Communication Support for more convenient use</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p">Training Data Labeling and Data Storage Support. Get user’s raw data stored on the edge device and labeled at the same time for SFL training.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p">Train multi clients in parallel. (Currently only support sequential training)</p>
</div>
</li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i4.p1" class="ltx_para">
<p id="S5.I1.i4.p1.1" class="ltx_p">Instant deployment. Once global model converges, the server generates deployable model (compressed/quantized) and send it to clients.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span id="bib.bib2.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Xing Chen, Jingtao Li,
and Chaitali Chakrabarti.
2021.

</span>
<span class="ltx_bibblock">Communication and Computation Reduction for Split
Learning using Asynchronous Training. In <em id="bib.bib2.3.1" class="ltx_emph ltx_font_italic">2021 IEEE
Workshop on Signal Processing Systems (SiPS)</em>. IEEE,
76–81.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goldreich (1998)</span>
<span class="ltx_bibblock">
Oded Goldreich.
1998.

</span>
<span class="ltx_bibblock">Secure multi-party computation.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Manuscript. Preliminary version</em>
78 (1998).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Llisterri Giménez et al<span id="bib.bib4.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Nil Llisterri Giménez,
Marc Monfort Grau, Roger Pueyo Centelles,
and Felix Freitag. 2022.

</span>
<span class="ltx_bibblock">On-Device Training of Machine Learning Models on
Microcontrollers with Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.3.1" class="ltx_emph ltx_font_italic">Electronics</em> 11,
4 (2022), 573.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al<span id="bib.bib5.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider
Moore, Daniel Ramage, Seth Hampson,
and Blaise Aguera y Arcas.
2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks
from decentralized data. In <em id="bib.bib5.3.1" class="ltx_emph ltx_font_italic">Artificial
Intelligence and Statistics</em>. PMLR, 1273–1282.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thapa et al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Chandra Thapa, Pathum
Chamikara Mahawaga Arachchige, Seyit Camtepe, and
Lichao Sun. 2022.

</span>
<span class="ltx_bibblock">Splitfed: When federated learning meets split
learning. In <em id="bib.bib6.3.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on
Artificial Intelligence</em>, Vol. 36.
8485–8493.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Titcombe et al<span id="bib.bib7.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Tom Titcombe, Adam J
Hall, Pavlos Papadopoulos, and Daniele
Romanini. 2021.

</span>
<span class="ltx_bibblock">Practical Defences Against Model Inversion Attacks
for Split Neural Networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2104.05743</em>
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vepakomma et al<span id="bib.bib8.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Praneeth Vepakomma,
Otkrist Gupta, Tristan Swedish, and
Ramesh Raskar. 2018.

</span>
<span class="ltx_bibblock">Split learning for health: Distributed deep
learning without sharing raw patient data. In <em id="bib.bib8.3.1" class="ltx_emph ltx_font_italic">32nd
Conference on Neural Information Processing Systems (NIPS)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Warden (2018)</span>
<span class="ltx_bibblock">
Pete Warden.
2018.

</span>
<span class="ltx_bibblock">Speech commands: A dataset for limited-vocabulary
speech recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1804.03209</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2210.01960" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2210.01961" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2210.01961">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2210.01961" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2210.01962" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 04:42:28 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
