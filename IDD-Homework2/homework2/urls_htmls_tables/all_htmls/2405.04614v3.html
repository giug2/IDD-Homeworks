<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems</title>
<!--Generated on Tue Sep 10 14:35:21 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Recommender systems,  Loss function" lang="en" name="keywords"/>
<base href="/html/2405.04614v3/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S1" title="In Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S2" title="In Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S2.SS1" title="In 2. Related Work ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Collaborative Filtering-based Recommender Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S2.SS2" title="In 2. Related Work ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Overview of Loss Functions used in Recommender Systems</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S2.SS3" title="In 2. Related Work ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Contrastive Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S3" title="In Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Proposed Loss Function</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S3.SS1" title="In 3. Proposed Loss Function ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Generalized Contrastive Loss</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S3.SS2" title="In 3. Proposed Loss Function ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Motivation for Multi-Margin Cosine Loss</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S3.SS3" title="In 3. Proposed Loss Function ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Multi-Margin Cosine Loss</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S4" title="In Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Evaluation Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S4.SS1" title="In 4. Evaluation Results ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Evaluation Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S4.SS2" title="In 4. Evaluation Results ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Evaluation Results</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S5" title="In Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Makbule Gulcin Ozsoy
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_city" id="id1.1.id1">London</span><span class="ltx_text ltx_affiliation_country" id="id2.2.id2">UK</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:makbulegulcin@gmail.com">makbulegulcin@gmail.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id3.id1">Recommender systems guide users through vast amounts of information by suggesting items based on their predicted preferences. Collaborative filtering-based deep learning techniques have regained popularity due to their straightforward nature, relying only on user-item interactions. Typically, these systems consist of three main components: an interaction module, a loss function, and a negative sampling strategy. Initially, researchers focused on enhancing performance by developing complex interaction modules. However, there has been a recent shift toward refining loss functions and negative sampling strategies. This shift has led to an increased interest in contrastive learning, which pulls similar pairs closer while pushing dissimilar ones apart. Contrastive learning may bring challenges like high memory demands and under-utilization of some negative samples. The proposed Multi-Margin Cosine Loss (MMCL) addresses these challenges by introducing multiple margins and varying weights for negative samples. It efficiently utilizes not only the hardest negatives but also other non-trivial negatives, offers a simpler yet effective loss function that outperforms more complex methods, especially when resources are limited. Experiments on two well-known datasets demonstrated that MMCL achieved up to a 20% performance improvement compared to a baseline loss function when fewer number of negative samples are used.</p>
</div>
<div class="ltx_keywords">Recommender systems, Loss function
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct
conference title from your rights confirmation emai; June 03–05,
2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Neural networks</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.3">Numerous web applications like YouTube, Amazon, Spotify use recommendation systems (RS) suggest items such as videos, products, and music tracks by estimating user preferences.
RS utilize various methods, from traditional methods like collaborative filtering (CF), content-based filtering, matrix factorization <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib16" title="">2015</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib11" title="">2016</a>)</cite> to
more recent techniques like deep learning, reinforcement learning, language models <cite class="ltx_cite ltx_citemacro_citep">(Ozsoy, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib22" title="">2016</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib12" title="">2017</a>; Musto et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib20" title="">2018</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib39" title="">2018</a>; Shi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib27" title="">2021</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib28" title="">2019</a>; Fan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib8" title="">2023</a>)</cite>.
Recently, CF-based deep learning techniques have regained popularity due to their simplicity, efficacy, and reliance solely on user-item interactions.
These methods are composed of three main components: interaction encoder, loss function and negative sampling strategy, Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates these steps: A user interacts with an item <math alttext="p" class="ltx_Math" display="inline" id="S1.p1.1.m1.1"><semantics id="S1.p1.1.m1.1a"><mi id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><ci id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.1d">italic_p</annotation></semantics></math> (e.g., purchases a product), and four negative items, <math alttext="n_{1}" class="ltx_Math" display="inline" id="S1.p1.2.m2.1"><semantics id="S1.p1.2.m2.1a"><msub id="S1.p1.2.m2.1.1" xref="S1.p1.2.m2.1.1.cmml"><mi id="S1.p1.2.m2.1.1.2" xref="S1.p1.2.m2.1.1.2.cmml">n</mi><mn id="S1.p1.2.m2.1.1.3" xref="S1.p1.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p1.2.m2.1b"><apply id="S1.p1.2.m2.1.1.cmml" xref="S1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p1.2.m2.1.1.1.cmml" xref="S1.p1.2.m2.1.1">subscript</csymbol><ci id="S1.p1.2.m2.1.1.2.cmml" xref="S1.p1.2.m2.1.1.2">𝑛</ci><cn id="S1.p1.2.m2.1.1.3.cmml" type="integer" xref="S1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.2.m2.1c">n_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.2.m2.1d">italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-<math alttext="n_{4}" class="ltx_Math" display="inline" id="S1.p1.3.m3.1"><semantics id="S1.p1.3.m3.1a"><msub id="S1.p1.3.m3.1.1" xref="S1.p1.3.m3.1.1.cmml"><mi id="S1.p1.3.m3.1.1.2" xref="S1.p1.3.m3.1.1.2.cmml">n</mi><mn id="S1.p1.3.m3.1.1.3" xref="S1.p1.3.m3.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p1.3.m3.1b"><apply id="S1.p1.3.m3.1.1.cmml" xref="S1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p1.3.m3.1.1.1.cmml" xref="S1.p1.3.m3.1.1">subscript</csymbol><ci id="S1.p1.3.m3.1.1.2.cmml" xref="S1.p1.3.m3.1.1.2">𝑛</ci><cn id="S1.p1.3.m3.1.1.3.cmml" type="integer" xref="S1.p1.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.3.m3.1c">n_{4}</annotation><annotation encoding="application/x-llamapun" id="S1.p1.3.m3.1d">italic_n start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>, are sampled. The sampled negative items, positive item and user representations are then used by the interaction encoding and loss function modules for the computations and making recommendations.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="464" id="S1.F1.g1" src="extracted/5845867/figures/stages.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>
Three major components for a deep-learning based CF model: (i) interaction encoder, (ii) loss function and (iii) negative sampling. A user interacts with an item <math alttext="p" class="ltx_Math" display="inline" id="S1.F1.5.m1.1"><semantics id="S1.F1.5.m1.1b"><mi id="S1.F1.5.m1.1.1" xref="S1.F1.5.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S1.F1.5.m1.1c"><ci id="S1.F1.5.m1.1.1.cmml" xref="S1.F1.5.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.m1.1d">p</annotation><annotation encoding="application/x-llamapun" id="S1.F1.5.m1.1e">italic_p</annotation></semantics></math> (e.g., purchases a product). From the remaining negative items <math alttext="n" class="ltx_Math" display="inline" id="S1.F1.6.m2.1"><semantics id="S1.F1.6.m2.1b"><mi id="S1.F1.6.m2.1.1" xref="S1.F1.6.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S1.F1.6.m2.1c"><ci id="S1.F1.6.m2.1.1.cmml" xref="S1.F1.6.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m2.1d">n</annotation><annotation encoding="application/x-llamapun" id="S1.F1.6.m2.1e">italic_n</annotation></semantics></math>, four negatives, <math alttext="n_{1}" class="ltx_Math" display="inline" id="S1.F1.7.m3.1"><semantics id="S1.F1.7.m3.1b"><msub id="S1.F1.7.m3.1.1" xref="S1.F1.7.m3.1.1.cmml"><mi id="S1.F1.7.m3.1.1.2" xref="S1.F1.7.m3.1.1.2.cmml">n</mi><mn id="S1.F1.7.m3.1.1.3" xref="S1.F1.7.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.7.m3.1c"><apply id="S1.F1.7.m3.1.1.cmml" xref="S1.F1.7.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.7.m3.1.1.1.cmml" xref="S1.F1.7.m3.1.1">subscript</csymbol><ci id="S1.F1.7.m3.1.1.2.cmml" xref="S1.F1.7.m3.1.1.2">𝑛</ci><cn id="S1.F1.7.m3.1.1.3.cmml" type="integer" xref="S1.F1.7.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.7.m3.1d">n_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.7.m3.1e">italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>-<math alttext="n_{4}" class="ltx_Math" display="inline" id="S1.F1.8.m4.1"><semantics id="S1.F1.8.m4.1b"><msub id="S1.F1.8.m4.1.1" xref="S1.F1.8.m4.1.1.cmml"><mi id="S1.F1.8.m4.1.1.2" xref="S1.F1.8.m4.1.1.2.cmml">n</mi><mn id="S1.F1.8.m4.1.1.3" xref="S1.F1.8.m4.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.8.m4.1c"><apply id="S1.F1.8.m4.1.1.cmml" xref="S1.F1.8.m4.1.1"><csymbol cd="ambiguous" id="S1.F1.8.m4.1.1.1.cmml" xref="S1.F1.8.m4.1.1">subscript</csymbol><ci id="S1.F1.8.m4.1.1.2.cmml" xref="S1.F1.8.m4.1.1.2">𝑛</ci><cn id="S1.F1.8.m4.1.1.3.cmml" type="integer" xref="S1.F1.8.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.8.m4.1d">n_{4}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.8.m4.1e">italic_n start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>, are sampled. The sampled negative items, positive item and user representations are fed into the interaction encoding and loss function modules for computation.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S1.F1.9">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S1.F1.10">Three major components for a deep-learning based CF model: (i) interaction module/encoder, (ii) loss function and (iii) negative sampling strategy.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">SimpleX <cite class="ltx_cite ltx_citemacro_citep">(Mao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib19" title="">2021</a>)</cite> demonstrated that a simple interaction encoding model with a well-designed loss function can outperform more complex techniques, shifting focus in RS towards loss functions and negative sampling strategies.
Recent studies have analyzed the impact of loss functions on recommendation performance,
and developed new ones to address challenges like popularity bias and robustness <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib32" title="">2022</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib15" title="">2023</a>; Park et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib24" title="">2023</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib35" title="">2022</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib29" title="">2023</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib31" title="">2023</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib36" title="">2024</a>)</cite>.
These efforts increased the interest in contrastive learning within RS domain.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Contrastive learning models aim to learn representations by bringing similar pairs closer while separating dissimilar pairs. For an efficient contrastive learning system, three key components have been identified <cite class="ltx_cite ltx_citemacro_citep">(Weng, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib30" title="">2021</a>)</cite>: heavy data augmentation, large batch size and hard-negative sampling. While using larger batch sizes and more negative samples introduce more diverse and ‘hard’-negative samples to the system, they require more memory as a side-effect.
A common approach is to use a margin parameter to distinguish ‘hard’-negatives from the rest. However, this approach sets only a single threshold, failing to fully utilize all available negative samples efficiently.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this work, we hypothesise that using all non-trivial negative instances, not just the hardest, allows the model to generalize more efficiently, even with fewer negative samples or smaller batch sizes.
Assigning different weights to varying levels of ”hardness” in negative instances—such as giving higher weight to the hardest negatives and relatively lower weights to easier ones—can enhance performance.
For this purpose, we propose Multi-Margin Cosine Loss (MMCL), a simple yet efficient loss function, that uses multiple margins and assigns different weights to different levels of negative instances.
The main contributions of this work are:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We proposed Multi-Margin Cosine Loss (MMCL), which introduces multiple margins and weights for negative instances. It allows consideration of not only the hardest negatives but also ’semi-hard’ and ’semi-easy’ negatives.
The ability of assigning different weights enables tuning the importance of each level of negative samples.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We conducted experiments on two well-known recommender system datasets, comparing MMCL’s performance to state-of-the-art loss functions.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">MMCL performs comparably to state-of-the-art contrastive loss functions with a large negative sample size (e.g., 800) and achieves up to a 20% performance improvement over baseline loss functions with smaller sample sizes (e.g., 10 or 100).</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The paper is structured as follows: Section <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S2" title="2. Related Work ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">2</span></a> provides background on recommender systems, contrastive learning and loss functions. Section <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S3" title="3. Proposed Loss Function ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">3</span></a> presents the proposed Multi-Margin Cosine Loss (MMCL). Section <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S4" title="4. Evaluation Results ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">4</span></a> details the experimental setup and evaluation results. Section <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S5" title="5. Conclusion ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">5</span></a> discusses the conclusion and future directions.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, background information on recommender systems (RS), overview of loss functions used in RS and details on contrastive loss functions are presented.</p>
</div>
<figure class="ltx_figure" id="S2.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="199" id="S2.F2.sf1.g1" src="extracted/5845867/figures/classic_cl.png" width="222"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="199" id="S2.F2.sf2.g1" src="extracted/5845867/figures/mml.png" width="222"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>(a) Margin <math alttext="m" class="ltx_Math" display="inline" id="S2.F2.6.m1.1"><semantics id="S2.F2.6.m1.1b"><mi id="S2.F2.6.m1.1.1" xref="S2.F2.6.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.F2.6.m1.1c"><ci id="S2.F2.6.m1.1.1.cmml" xref="S2.F2.6.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.6.m1.1d">m</annotation><annotation encoding="application/x-llamapun" id="S2.F2.6.m1.1e">italic_m</annotation></semantics></math> defines a radius, which makes the model to pay attention to harder-negatives. In Contrastive Loss, Eq.<a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S2.E1" title="In 2.3. Contrastive Learning ‣ 2. Related Work ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">1</span></a>, the radius is relative to user representation (<math alttext="m1" class="ltx_Math" display="inline" id="S2.F2.7.m2.1"><semantics id="S2.F2.7.m2.1b"><mrow id="S2.F2.7.m2.1.1" xref="S2.F2.7.m2.1.1.cmml"><mi id="S2.F2.7.m2.1.1.2" xref="S2.F2.7.m2.1.1.2.cmml">m</mi><mo id="S2.F2.7.m2.1.1.1" xref="S2.F2.7.m2.1.1.1.cmml">⁢</mo><mn id="S2.F2.7.m2.1.1.3" xref="S2.F2.7.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.7.m2.1c"><apply id="S2.F2.7.m2.1.1.cmml" xref="S2.F2.7.m2.1.1"><times id="S2.F2.7.m2.1.1.1.cmml" xref="S2.F2.7.m2.1.1.1"></times><ci id="S2.F2.7.m2.1.1.2.cmml" xref="S2.F2.7.m2.1.1.2">𝑚</ci><cn id="S2.F2.7.m2.1.1.3.cmml" type="integer" xref="S2.F2.7.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.7.m2.1d">m1</annotation><annotation encoding="application/x-llamapun" id="S2.F2.7.m2.1e">italic_m 1</annotation></semantics></math>). In Triplet Loss, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S2.E3" title="In 2.3. Contrastive Learning ‣ 2. Related Work ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">3</span></a> it is relative to positive item (<math alttext="m2" class="ltx_Math" display="inline" id="S2.F2.8.m3.1"><semantics id="S2.F2.8.m3.1b"><mrow id="S2.F2.8.m3.1.1" xref="S2.F2.8.m3.1.1.cmml"><mi id="S2.F2.8.m3.1.1.2" xref="S2.F2.8.m3.1.1.2.cmml">m</mi><mo id="S2.F2.8.m3.1.1.1" xref="S2.F2.8.m3.1.1.1.cmml">⁢</mo><mn id="S2.F2.8.m3.1.1.3" xref="S2.F2.8.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.8.m3.1c"><apply id="S2.F2.8.m3.1.1.cmml" xref="S2.F2.8.m3.1.1"><times id="S2.F2.8.m3.1.1.1.cmml" xref="S2.F2.8.m3.1.1.1"></times><ci id="S2.F2.8.m3.1.1.2.cmml" xref="S2.F2.8.m3.1.1.2">𝑚</ci><cn id="S2.F2.8.m3.1.1.3.cmml" type="integer" xref="S2.F2.8.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.m3.1d">m2</annotation><annotation encoding="application/x-llamapun" id="S2.F2.8.m3.1e">italic_m 2</annotation></semantics></math>). (b) Proposed Multi-Margin Cosine Loss (MMCL), Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S3.E7" title="In 3.3. Multi-Margin Cosine Loss ‣ 3. Proposed Loss Function ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">7</span></a>, filters not only the hardest-negatives but also other non-trivial negatives, using multiple margins, <math alttext="m1,m2,m3" class="ltx_Math" display="inline" id="S2.F2.9.m4.3"><semantics id="S2.F2.9.m4.3b"><mrow id="S2.F2.9.m4.3.3.3" xref="S2.F2.9.m4.3.3.4.cmml"><mrow id="S2.F2.9.m4.1.1.1.1" xref="S2.F2.9.m4.1.1.1.1.cmml"><mi id="S2.F2.9.m4.1.1.1.1.2" xref="S2.F2.9.m4.1.1.1.1.2.cmml">m</mi><mo id="S2.F2.9.m4.1.1.1.1.1" xref="S2.F2.9.m4.1.1.1.1.1.cmml">⁢</mo><mn id="S2.F2.9.m4.1.1.1.1.3" xref="S2.F2.9.m4.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.F2.9.m4.3.3.3.4" xref="S2.F2.9.m4.3.3.4.cmml">,</mo><mrow id="S2.F2.9.m4.2.2.2.2" xref="S2.F2.9.m4.2.2.2.2.cmml"><mi id="S2.F2.9.m4.2.2.2.2.2" xref="S2.F2.9.m4.2.2.2.2.2.cmml">m</mi><mo id="S2.F2.9.m4.2.2.2.2.1" xref="S2.F2.9.m4.2.2.2.2.1.cmml">⁢</mo><mn id="S2.F2.9.m4.2.2.2.2.3" xref="S2.F2.9.m4.2.2.2.2.3.cmml">2</mn></mrow><mo id="S2.F2.9.m4.3.3.3.5" xref="S2.F2.9.m4.3.3.4.cmml">,</mo><mrow id="S2.F2.9.m4.3.3.3.3" xref="S2.F2.9.m4.3.3.3.3.cmml"><mi id="S2.F2.9.m4.3.3.3.3.2" xref="S2.F2.9.m4.3.3.3.3.2.cmml">m</mi><mo id="S2.F2.9.m4.3.3.3.3.1" xref="S2.F2.9.m4.3.3.3.3.1.cmml">⁢</mo><mn id="S2.F2.9.m4.3.3.3.3.3" xref="S2.F2.9.m4.3.3.3.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.9.m4.3c"><list id="S2.F2.9.m4.3.3.4.cmml" xref="S2.F2.9.m4.3.3.3"><apply id="S2.F2.9.m4.1.1.1.1.cmml" xref="S2.F2.9.m4.1.1.1.1"><times id="S2.F2.9.m4.1.1.1.1.1.cmml" xref="S2.F2.9.m4.1.1.1.1.1"></times><ci id="S2.F2.9.m4.1.1.1.1.2.cmml" xref="S2.F2.9.m4.1.1.1.1.2">𝑚</ci><cn id="S2.F2.9.m4.1.1.1.1.3.cmml" type="integer" xref="S2.F2.9.m4.1.1.1.1.3">1</cn></apply><apply id="S2.F2.9.m4.2.2.2.2.cmml" xref="S2.F2.9.m4.2.2.2.2"><times id="S2.F2.9.m4.2.2.2.2.1.cmml" xref="S2.F2.9.m4.2.2.2.2.1"></times><ci id="S2.F2.9.m4.2.2.2.2.2.cmml" xref="S2.F2.9.m4.2.2.2.2.2">𝑚</ci><cn id="S2.F2.9.m4.2.2.2.2.3.cmml" type="integer" xref="S2.F2.9.m4.2.2.2.2.3">2</cn></apply><apply id="S2.F2.9.m4.3.3.3.3.cmml" xref="S2.F2.9.m4.3.3.3.3"><times id="S2.F2.9.m4.3.3.3.3.1.cmml" xref="S2.F2.9.m4.3.3.3.3.1"></times><ci id="S2.F2.9.m4.3.3.3.3.2.cmml" xref="S2.F2.9.m4.3.3.3.3.2">𝑚</ci><cn id="S2.F2.9.m4.3.3.3.3.3.cmml" type="integer" xref="S2.F2.9.m4.3.3.3.3.3">3</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.9.m4.3d">m1,m2,m3</annotation><annotation encoding="application/x-llamapun" id="S2.F2.9.m4.3e">italic_m 1 , italic_m 2 , italic_m 3</annotation></semantics></math>, and assigns different weights to each level, <math alttext="w1,w2,w3" class="ltx_Math" display="inline" id="S2.F2.10.m5.3"><semantics id="S2.F2.10.m5.3b"><mrow id="S2.F2.10.m5.3.3.3" xref="S2.F2.10.m5.3.3.4.cmml"><mrow id="S2.F2.10.m5.1.1.1.1" xref="S2.F2.10.m5.1.1.1.1.cmml"><mi id="S2.F2.10.m5.1.1.1.1.2" xref="S2.F2.10.m5.1.1.1.1.2.cmml">w</mi><mo id="S2.F2.10.m5.1.1.1.1.1" xref="S2.F2.10.m5.1.1.1.1.1.cmml">⁢</mo><mn id="S2.F2.10.m5.1.1.1.1.3" xref="S2.F2.10.m5.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.F2.10.m5.3.3.3.4" xref="S2.F2.10.m5.3.3.4.cmml">,</mo><mrow id="S2.F2.10.m5.2.2.2.2" xref="S2.F2.10.m5.2.2.2.2.cmml"><mi id="S2.F2.10.m5.2.2.2.2.2" xref="S2.F2.10.m5.2.2.2.2.2.cmml">w</mi><mo id="S2.F2.10.m5.2.2.2.2.1" xref="S2.F2.10.m5.2.2.2.2.1.cmml">⁢</mo><mn id="S2.F2.10.m5.2.2.2.2.3" xref="S2.F2.10.m5.2.2.2.2.3.cmml">2</mn></mrow><mo id="S2.F2.10.m5.3.3.3.5" xref="S2.F2.10.m5.3.3.4.cmml">,</mo><mrow id="S2.F2.10.m5.3.3.3.3" xref="S2.F2.10.m5.3.3.3.3.cmml"><mi id="S2.F2.10.m5.3.3.3.3.2" xref="S2.F2.10.m5.3.3.3.3.2.cmml">w</mi><mo id="S2.F2.10.m5.3.3.3.3.1" xref="S2.F2.10.m5.3.3.3.3.1.cmml">⁢</mo><mn id="S2.F2.10.m5.3.3.3.3.3" xref="S2.F2.10.m5.3.3.3.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.10.m5.3c"><list id="S2.F2.10.m5.3.3.4.cmml" xref="S2.F2.10.m5.3.3.3"><apply id="S2.F2.10.m5.1.1.1.1.cmml" xref="S2.F2.10.m5.1.1.1.1"><times id="S2.F2.10.m5.1.1.1.1.1.cmml" xref="S2.F2.10.m5.1.1.1.1.1"></times><ci id="S2.F2.10.m5.1.1.1.1.2.cmml" xref="S2.F2.10.m5.1.1.1.1.2">𝑤</ci><cn id="S2.F2.10.m5.1.1.1.1.3.cmml" type="integer" xref="S2.F2.10.m5.1.1.1.1.3">1</cn></apply><apply id="S2.F2.10.m5.2.2.2.2.cmml" xref="S2.F2.10.m5.2.2.2.2"><times id="S2.F2.10.m5.2.2.2.2.1.cmml" xref="S2.F2.10.m5.2.2.2.2.1"></times><ci id="S2.F2.10.m5.2.2.2.2.2.cmml" xref="S2.F2.10.m5.2.2.2.2.2">𝑤</ci><cn id="S2.F2.10.m5.2.2.2.2.3.cmml" type="integer" xref="S2.F2.10.m5.2.2.2.2.3">2</cn></apply><apply id="S2.F2.10.m5.3.3.3.3.cmml" xref="S2.F2.10.m5.3.3.3.3"><times id="S2.F2.10.m5.3.3.3.3.1.cmml" xref="S2.F2.10.m5.3.3.3.3.1"></times><ci id="S2.F2.10.m5.3.3.3.3.2.cmml" xref="S2.F2.10.m5.3.3.3.3.2">𝑤</ci><cn id="S2.F2.10.m5.3.3.3.3.3.cmml" type="integer" xref="S2.F2.10.m5.3.3.3.3.3">3</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.10.m5.3d">w1,w2,w3</annotation><annotation encoding="application/x-llamapun" id="S2.F2.10.m5.3e">italic_w 1 , italic_w 2 , italic_w 3</annotation></semantics></math>.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S2.F2.12">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S2.F2.11">Margin <math alttext="m" class="ltx_Math" display="inline" id="S2.F2.11.m1.1"><semantics id="S2.F2.11.m1.1a"><mi id="S2.F2.11.m1.1.1" xref="S2.F2.11.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.F2.11.m1.1b"><ci id="S2.F2.11.m1.1.1.cmml" xref="S2.F2.11.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.11.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.F2.11.m1.1d">italic_m</annotation></semantics></math> defines a radius, which makes the model to pay attention to harder-negatives.</p>
</div>
</div>
</figure>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Collaborative Filtering-based Recommender Models</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Recommender systems (RS) estimate users’ preferences and recommend items based on historical user-item interaction.
Recently, CF-based deep learning techniques have regained popularity due to their simplicity, efficacy, and reliance solely on user-item interactions.
These systems consist of three main components (Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">1</span></a>):
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.SS1.p1.1.1">(i) Interaction encoder</span> learns embeddings of each user and item. It has been primary focus in the field for many years and various techniques have been employed, such as vector embeddings, multi-layer perceptrons, auto-encoders, attention networks, transformers, graph neural networks, reinforcement learning techniques <cite class="ltx_cite ltx_citemacro_citep">(Ozsoy, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib22" title="">2016</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib12" title="">2017</a>; Musto et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib20" title="">2018</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib28" title="">2019</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib4" title="">2020a</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib39" title="">2018</a>; Ozsoy et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib23" title="">2020</a>; Shi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib27" title="">2021</a>)</cite>. Although these methods improve performance, their complexity has increased. Efficient models are in higher demand for practical applications.
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.SS1.p1.1.2">(ii) Loss function</span>: Common loss functions in RS include Binary Cross-Entropy (BCE) <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib12" title="">2017</a>)</cite>, Bayesian Personalized Ranking (BPR) <cite class="ltx_cite ltx_citemacro_citep">(Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib25" title="">2009</a>)</cite> or mean square error (MSE) <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib3" title="">2020b</a>)</cite>.
Inspired by advancements in computer vision and natural language processing, new loss functions utilizing both positive and negative instances and contrastive learning approaches receive increased focus in RS applications.
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.SS1.p1.1.3">(iii) Negative sampling</span> samples a subset of negative instances from a larger set. In RS, there are vast amount of negative or unobserved instances compared to positive ones and to improve training efficiency negative sampling techniques are applied. Various strategies exist in the literature, such as random, popularity-based and GAN-based sampling <cite class="ltx_cite ltx_citemacro_citep">(Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib7" title="">2019</a>; Barkan and Koenigstein, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib2" title="">2016</a>; Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib18" title="">2020</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib37" title="">2013</a>; Jin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib14" title="">2020</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib33" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Overview of Loss Functions used in Recommender Systems</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">There are three common types of loss functions in RS:
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.SS2.p1.1.1">(i) Point-wise loss</span> measures the distance between predicted and expected labels, using each instance independently, i.e., either a positive or a negative instance is used at a time. Examples in RS include Binary Cross Entropy (BCE) <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib12" title="">2017</a>)</cite>, Mixed-centric (MCL) <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib9" title="">2022</a>)</cite> and User Interest Boundary (UIB) <cite class="ltx_cite ltx_citemacro_citep">(Zhuo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib40" title="">2022</a>)</cite> losses.
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.SS2.p1.1.2">(ii) Pair-wise loss</span> compares pair of items to decide the optimal ordering. Examples used in RS include Bayesian Personalized Ranking (BPR) <cite class="ltx_cite ltx_citemacro_citep">(Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib25" title="">2009</a>)</cite> and Collaborative Metric Learning (CML) <cite class="ltx_cite ltx_citemacro_citep">(Hsieh et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib13" title="">2017</a>)</cite> losses
<span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.SS2.p1.1.3">(iii) Set-wise loss</span> generalizes pairwise loss functions by considering multiple negative items for a single positive item. Examples used in RS include Cosine Contrastive Loss (CCL) <cite class="ltx_cite ltx_citemacro_citep">(Mao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib19" title="">2021</a>)</cite>, Sampled Softmax (SSM) <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib32" title="">2022</a>)</cite>, Bias-aware Contrastive (BC) <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib35" title="">2022</a>)</cite> losses.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Another direction in RS involves using automated machine learning (AutoML) techniques to explore loss functions, such as AutoLoss<cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib38" title="">2021</a>)</cite>, AutoLossGen <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib17" title="">2022</a>)</cite>, which combine or generate new loss functions automatically. Well-designed loss functions and AutoML techniques complement each other and enhance RS performance.
For instance, SimpleX <cite class="ltx_cite ltx_citemacro_citep">(Mao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib19" title="">2021</a>)</cite> showed that a well-designed loss function enables a simple model to outperform more complex ones, sparking interest in loss functions for RS.
Recent studies have analyzed the impact of loss functions on RS performance and developed new ones to address challenges, like popularity bias <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib32" title="">2022</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib15" title="">2023</a>; Park et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib24" title="">2023</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib31" title="">2023</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib35" title="">2022</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib29" title="">2023</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib36" title="">2024</a>)</cite>, highlighting contrastive learning as a significant trend.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Contrastive Learning</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">In machine-learning, contrastive learning gained attention attention for its better performance, as it learns representations by bringing similar pairs closer and separating dissimilar ones.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.17"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.SS3.p2.17.1">Scientific Notation</span>: Given a set of users, <math alttext="U" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><mi id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><ci id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">U</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">italic_U</annotation></semantics></math>, and items, <math alttext="I" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1"><semantics id="S2.SS3.p2.2.m2.1a"><mi id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><ci id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">italic_I</annotation></semantics></math>, user-item interaction can be represented as <math alttext="R\in\{0,1\}^{|U|x|I|}" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m3.4"><semantics id="S2.SS3.p2.3.m3.4a"><mrow id="S2.SS3.p2.3.m3.4.5" xref="S2.SS3.p2.3.m3.4.5.cmml"><mi id="S2.SS3.p2.3.m3.4.5.2" xref="S2.SS3.p2.3.m3.4.5.2.cmml">R</mi><mo id="S2.SS3.p2.3.m3.4.5.1" xref="S2.SS3.p2.3.m3.4.5.1.cmml">∈</mo><msup id="S2.SS3.p2.3.m3.4.5.3" xref="S2.SS3.p2.3.m3.4.5.3.cmml"><mrow id="S2.SS3.p2.3.m3.4.5.3.2.2" xref="S2.SS3.p2.3.m3.4.5.3.2.1.cmml"><mo id="S2.SS3.p2.3.m3.4.5.3.2.2.1" stretchy="false" xref="S2.SS3.p2.3.m3.4.5.3.2.1.cmml">{</mo><mn id="S2.SS3.p2.3.m3.3.3" xref="S2.SS3.p2.3.m3.3.3.cmml">0</mn><mo id="S2.SS3.p2.3.m3.4.5.3.2.2.2" xref="S2.SS3.p2.3.m3.4.5.3.2.1.cmml">,</mo><mn id="S2.SS3.p2.3.m3.4.4" xref="S2.SS3.p2.3.m3.4.4.cmml">1</mn><mo id="S2.SS3.p2.3.m3.4.5.3.2.2.3" stretchy="false" xref="S2.SS3.p2.3.m3.4.5.3.2.1.cmml">}</mo></mrow><mrow id="S2.SS3.p2.3.m3.2.2.2" xref="S2.SS3.p2.3.m3.2.2.2.cmml"><mrow id="S2.SS3.p2.3.m3.2.2.2.4.2" xref="S2.SS3.p2.3.m3.2.2.2.4.1.cmml"><mo id="S2.SS3.p2.3.m3.2.2.2.4.2.1" stretchy="false" xref="S2.SS3.p2.3.m3.2.2.2.4.1.1.cmml">|</mo><mi id="S2.SS3.p2.3.m3.1.1.1.1" xref="S2.SS3.p2.3.m3.1.1.1.1.cmml">U</mi><mo id="S2.SS3.p2.3.m3.2.2.2.4.2.2" stretchy="false" xref="S2.SS3.p2.3.m3.2.2.2.4.1.1.cmml">|</mo></mrow><mo id="S2.SS3.p2.3.m3.2.2.2.3" xref="S2.SS3.p2.3.m3.2.2.2.3.cmml">⁢</mo><mi id="S2.SS3.p2.3.m3.2.2.2.5" xref="S2.SS3.p2.3.m3.2.2.2.5.cmml">x</mi><mo id="S2.SS3.p2.3.m3.2.2.2.3a" xref="S2.SS3.p2.3.m3.2.2.2.3.cmml">⁢</mo><mrow id="S2.SS3.p2.3.m3.2.2.2.6.2" xref="S2.SS3.p2.3.m3.2.2.2.6.1.cmml"><mo id="S2.SS3.p2.3.m3.2.2.2.6.2.1" stretchy="false" xref="S2.SS3.p2.3.m3.2.2.2.6.1.1.cmml">|</mo><mi id="S2.SS3.p2.3.m3.2.2.2.2" xref="S2.SS3.p2.3.m3.2.2.2.2.cmml">I</mi><mo id="S2.SS3.p2.3.m3.2.2.2.6.2.2" stretchy="false" xref="S2.SS3.p2.3.m3.2.2.2.6.1.1.cmml">|</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.4b"><apply id="S2.SS3.p2.3.m3.4.5.cmml" xref="S2.SS3.p2.3.m3.4.5"><in id="S2.SS3.p2.3.m3.4.5.1.cmml" xref="S2.SS3.p2.3.m3.4.5.1"></in><ci id="S2.SS3.p2.3.m3.4.5.2.cmml" xref="S2.SS3.p2.3.m3.4.5.2">𝑅</ci><apply id="S2.SS3.p2.3.m3.4.5.3.cmml" xref="S2.SS3.p2.3.m3.4.5.3"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.4.5.3.1.cmml" xref="S2.SS3.p2.3.m3.4.5.3">superscript</csymbol><set id="S2.SS3.p2.3.m3.4.5.3.2.1.cmml" xref="S2.SS3.p2.3.m3.4.5.3.2.2"><cn id="S2.SS3.p2.3.m3.3.3.cmml" type="integer" xref="S2.SS3.p2.3.m3.3.3">0</cn><cn id="S2.SS3.p2.3.m3.4.4.cmml" type="integer" xref="S2.SS3.p2.3.m3.4.4">1</cn></set><apply id="S2.SS3.p2.3.m3.2.2.2.cmml" xref="S2.SS3.p2.3.m3.2.2.2"><times id="S2.SS3.p2.3.m3.2.2.2.3.cmml" xref="S2.SS3.p2.3.m3.2.2.2.3"></times><apply id="S2.SS3.p2.3.m3.2.2.2.4.1.cmml" xref="S2.SS3.p2.3.m3.2.2.2.4.2"><abs id="S2.SS3.p2.3.m3.2.2.2.4.1.1.cmml" xref="S2.SS3.p2.3.m3.2.2.2.4.2.1"></abs><ci id="S2.SS3.p2.3.m3.1.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1.1.1">𝑈</ci></apply><ci id="S2.SS3.p2.3.m3.2.2.2.5.cmml" xref="S2.SS3.p2.3.m3.2.2.2.5">𝑥</ci><apply id="S2.SS3.p2.3.m3.2.2.2.6.1.cmml" xref="S2.SS3.p2.3.m3.2.2.2.6.2"><abs id="S2.SS3.p2.3.m3.2.2.2.6.1.1.cmml" xref="S2.SS3.p2.3.m3.2.2.2.6.2.1"></abs><ci id="S2.SS3.p2.3.m3.2.2.2.2.cmml" xref="S2.SS3.p2.3.m3.2.2.2.2">𝐼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.4c">R\in\{0,1\}^{|U|x|I|}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m3.4d">italic_R ∈ { 0 , 1 } start_POSTSUPERSCRIPT | italic_U | italic_x | italic_I | end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="r_{ui}=1" class="ltx_Math" display="inline" id="S2.SS3.p2.4.m4.1"><semantics id="S2.SS3.p2.4.m4.1a"><mrow id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml"><msub id="S2.SS3.p2.4.m4.1.1.2" xref="S2.SS3.p2.4.m4.1.1.2.cmml"><mi id="S2.SS3.p2.4.m4.1.1.2.2" xref="S2.SS3.p2.4.m4.1.1.2.2.cmml">r</mi><mrow id="S2.SS3.p2.4.m4.1.1.2.3" xref="S2.SS3.p2.4.m4.1.1.2.3.cmml"><mi id="S2.SS3.p2.4.m4.1.1.2.3.2" xref="S2.SS3.p2.4.m4.1.1.2.3.2.cmml">u</mi><mo id="S2.SS3.p2.4.m4.1.1.2.3.1" xref="S2.SS3.p2.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.4.m4.1.1.2.3.3" xref="S2.SS3.p2.4.m4.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="S2.SS3.p2.4.m4.1.1.1" xref="S2.SS3.p2.4.m4.1.1.1.cmml">=</mo><mn id="S2.SS3.p2.4.m4.1.1.3" xref="S2.SS3.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><apply id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1"><eq id="S2.SS3.p2.4.m4.1.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1.1"></eq><apply id="S2.SS3.p2.4.m4.1.1.2.cmml" xref="S2.SS3.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.1.1.2.1.cmml" xref="S2.SS3.p2.4.m4.1.1.2">subscript</csymbol><ci id="S2.SS3.p2.4.m4.1.1.2.2.cmml" xref="S2.SS3.p2.4.m4.1.1.2.2">𝑟</ci><apply id="S2.SS3.p2.4.m4.1.1.2.3.cmml" xref="S2.SS3.p2.4.m4.1.1.2.3"><times id="S2.SS3.p2.4.m4.1.1.2.3.1.cmml" xref="S2.SS3.p2.4.m4.1.1.2.3.1"></times><ci id="S2.SS3.p2.4.m4.1.1.2.3.2.cmml" xref="S2.SS3.p2.4.m4.1.1.2.3.2">𝑢</ci><ci id="S2.SS3.p2.4.m4.1.1.2.3.3.cmml" xref="S2.SS3.p2.4.m4.1.1.2.3.3">𝑖</ci></apply></apply><cn id="S2.SS3.p2.4.m4.1.1.3.cmml" type="integer" xref="S2.SS3.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">r_{ui}=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.4.m4.1d">italic_r start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT = 1</annotation></semantics></math> indicates positive interactions and <math alttext="r_{ui}=0" class="ltx_Math" display="inline" id="S2.SS3.p2.5.m5.1"><semantics id="S2.SS3.p2.5.m5.1a"><mrow id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml"><msub id="S2.SS3.p2.5.m5.1.1.2" xref="S2.SS3.p2.5.m5.1.1.2.cmml"><mi id="S2.SS3.p2.5.m5.1.1.2.2" xref="S2.SS3.p2.5.m5.1.1.2.2.cmml">r</mi><mrow id="S2.SS3.p2.5.m5.1.1.2.3" xref="S2.SS3.p2.5.m5.1.1.2.3.cmml"><mi id="S2.SS3.p2.5.m5.1.1.2.3.2" xref="S2.SS3.p2.5.m5.1.1.2.3.2.cmml">u</mi><mo id="S2.SS3.p2.5.m5.1.1.2.3.1" xref="S2.SS3.p2.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.5.m5.1.1.2.3.3" xref="S2.SS3.p2.5.m5.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="S2.SS3.p2.5.m5.1.1.1" xref="S2.SS3.p2.5.m5.1.1.1.cmml">=</mo><mn id="S2.SS3.p2.5.m5.1.1.3" xref="S2.SS3.p2.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.1b"><apply id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1"><eq id="S2.SS3.p2.5.m5.1.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1.1"></eq><apply id="S2.SS3.p2.5.m5.1.1.2.cmml" xref="S2.SS3.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.1.1.2.1.cmml" xref="S2.SS3.p2.5.m5.1.1.2">subscript</csymbol><ci id="S2.SS3.p2.5.m5.1.1.2.2.cmml" xref="S2.SS3.p2.5.m5.1.1.2.2">𝑟</ci><apply id="S2.SS3.p2.5.m5.1.1.2.3.cmml" xref="S2.SS3.p2.5.m5.1.1.2.3"><times id="S2.SS3.p2.5.m5.1.1.2.3.1.cmml" xref="S2.SS3.p2.5.m5.1.1.2.3.1"></times><ci id="S2.SS3.p2.5.m5.1.1.2.3.2.cmml" xref="S2.SS3.p2.5.m5.1.1.2.3.2">𝑢</ci><ci id="S2.SS3.p2.5.m5.1.1.2.3.3.cmml" xref="S2.SS3.p2.5.m5.1.1.2.3.3">𝑖</ci></apply></apply><cn id="S2.SS3.p2.5.m5.1.1.3.cmml" type="integer" xref="S2.SS3.p2.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.1c">r_{ui}=0</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.5.m5.1d">italic_r start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT = 0</annotation></semantics></math> indicate negative interactions.
Positive interactions form the set of positive instances: <math alttext="I_{u}^{+}=\{i\in I|r_{ui}=1\}" class="ltx_Math" display="inline" id="S2.SS3.p2.6.m6.2"><semantics id="S2.SS3.p2.6.m6.2a"><mrow id="S2.SS3.p2.6.m6.2.2" xref="S2.SS3.p2.6.m6.2.2.cmml"><msubsup id="S2.SS3.p2.6.m6.2.2.4" xref="S2.SS3.p2.6.m6.2.2.4.cmml"><mi id="S2.SS3.p2.6.m6.2.2.4.2.2" xref="S2.SS3.p2.6.m6.2.2.4.2.2.cmml">I</mi><mi id="S2.SS3.p2.6.m6.2.2.4.2.3" xref="S2.SS3.p2.6.m6.2.2.4.2.3.cmml">u</mi><mo id="S2.SS3.p2.6.m6.2.2.4.3" xref="S2.SS3.p2.6.m6.2.2.4.3.cmml">+</mo></msubsup><mo id="S2.SS3.p2.6.m6.2.2.3" xref="S2.SS3.p2.6.m6.2.2.3.cmml">=</mo><mrow id="S2.SS3.p2.6.m6.2.2.2.2" xref="S2.SS3.p2.6.m6.2.2.2.3.cmml"><mo id="S2.SS3.p2.6.m6.2.2.2.2.3" stretchy="false" xref="S2.SS3.p2.6.m6.2.2.2.3.1.cmml">{</mo><mrow id="S2.SS3.p2.6.m6.1.1.1.1.1" xref="S2.SS3.p2.6.m6.1.1.1.1.1.cmml"><mi id="S2.SS3.p2.6.m6.1.1.1.1.1.2" xref="S2.SS3.p2.6.m6.1.1.1.1.1.2.cmml">i</mi><mo id="S2.SS3.p2.6.m6.1.1.1.1.1.1" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1.cmml">∈</mo><mi id="S2.SS3.p2.6.m6.1.1.1.1.1.3" xref="S2.SS3.p2.6.m6.1.1.1.1.1.3.cmml">I</mi></mrow><mo id="S2.SS3.p2.6.m6.2.2.2.2.4" lspace="0em" rspace="0em" xref="S2.SS3.p2.6.m6.2.2.2.3.1.cmml">|</mo><mrow id="S2.SS3.p2.6.m6.2.2.2.2.2" xref="S2.SS3.p2.6.m6.2.2.2.2.2.cmml"><msub id="S2.SS3.p2.6.m6.2.2.2.2.2.2" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2.cmml"><mi id="S2.SS3.p2.6.m6.2.2.2.2.2.2.2" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2.2.cmml">r</mi><mrow id="S2.SS3.p2.6.m6.2.2.2.2.2.2.3" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.cmml"><mi id="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.2" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.2.cmml">u</mi><mo id="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.1" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.3" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.3.cmml">i</mi></mrow></msub><mo id="S2.SS3.p2.6.m6.2.2.2.2.2.1" xref="S2.SS3.p2.6.m6.2.2.2.2.2.1.cmml">=</mo><mn id="S2.SS3.p2.6.m6.2.2.2.2.2.3" xref="S2.SS3.p2.6.m6.2.2.2.2.2.3.cmml">1</mn></mrow><mo id="S2.SS3.p2.6.m6.2.2.2.2.5" stretchy="false" xref="S2.SS3.p2.6.m6.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m6.2b"><apply id="S2.SS3.p2.6.m6.2.2.cmml" xref="S2.SS3.p2.6.m6.2.2"><eq id="S2.SS3.p2.6.m6.2.2.3.cmml" xref="S2.SS3.p2.6.m6.2.2.3"></eq><apply id="S2.SS3.p2.6.m6.2.2.4.cmml" xref="S2.SS3.p2.6.m6.2.2.4"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.2.2.4.1.cmml" xref="S2.SS3.p2.6.m6.2.2.4">superscript</csymbol><apply id="S2.SS3.p2.6.m6.2.2.4.2.cmml" xref="S2.SS3.p2.6.m6.2.2.4"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.2.2.4.2.1.cmml" xref="S2.SS3.p2.6.m6.2.2.4">subscript</csymbol><ci id="S2.SS3.p2.6.m6.2.2.4.2.2.cmml" xref="S2.SS3.p2.6.m6.2.2.4.2.2">𝐼</ci><ci id="S2.SS3.p2.6.m6.2.2.4.2.3.cmml" xref="S2.SS3.p2.6.m6.2.2.4.2.3">𝑢</ci></apply><plus id="S2.SS3.p2.6.m6.2.2.4.3.cmml" xref="S2.SS3.p2.6.m6.2.2.4.3"></plus></apply><apply id="S2.SS3.p2.6.m6.2.2.2.3.cmml" xref="S2.SS3.p2.6.m6.2.2.2.2"><csymbol cd="latexml" id="S2.SS3.p2.6.m6.2.2.2.3.1.cmml" xref="S2.SS3.p2.6.m6.2.2.2.2.3">conditional-set</csymbol><apply id="S2.SS3.p2.6.m6.1.1.1.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1"><in id="S2.SS3.p2.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1.1"></in><ci id="S2.SS3.p2.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1.2">𝑖</ci><ci id="S2.SS3.p2.6.m6.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1.1.3">𝐼</ci></apply><apply id="S2.SS3.p2.6.m6.2.2.2.2.2.cmml" xref="S2.SS3.p2.6.m6.2.2.2.2.2"><eq id="S2.SS3.p2.6.m6.2.2.2.2.2.1.cmml" xref="S2.SS3.p2.6.m6.2.2.2.2.2.1"></eq><apply id="S2.SS3.p2.6.m6.2.2.2.2.2.2.cmml" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.2.2.2.2.2.2.1.cmml" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS3.p2.6.m6.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2.2">𝑟</ci><apply id="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.cmml" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2.3"><times id="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.1.cmml" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.1"></times><ci id="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.2.cmml" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.2">𝑢</ci><ci id="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.3.cmml" xref="S2.SS3.p2.6.m6.2.2.2.2.2.2.3.3">𝑖</ci></apply></apply><cn id="S2.SS3.p2.6.m6.2.2.2.2.2.3.cmml" type="integer" xref="S2.SS3.p2.6.m6.2.2.2.2.2.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m6.2c">I_{u}^{+}=\{i\in I|r_{ui}=1\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.6.m6.2d">italic_I start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT = { italic_i ∈ italic_I | italic_r start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT = 1 }</annotation></semantics></math> and negative interactions form the set of negative instances: <math alttext="I_{u}^{-}=\{i\in I|r_{ui}=0\}" class="ltx_Math" display="inline" id="S2.SS3.p2.7.m7.2"><semantics id="S2.SS3.p2.7.m7.2a"><mrow id="S2.SS3.p2.7.m7.2.2" xref="S2.SS3.p2.7.m7.2.2.cmml"><msubsup id="S2.SS3.p2.7.m7.2.2.4" xref="S2.SS3.p2.7.m7.2.2.4.cmml"><mi id="S2.SS3.p2.7.m7.2.2.4.2.2" xref="S2.SS3.p2.7.m7.2.2.4.2.2.cmml">I</mi><mi id="S2.SS3.p2.7.m7.2.2.4.2.3" xref="S2.SS3.p2.7.m7.2.2.4.2.3.cmml">u</mi><mo id="S2.SS3.p2.7.m7.2.2.4.3" xref="S2.SS3.p2.7.m7.2.2.4.3.cmml">−</mo></msubsup><mo id="S2.SS3.p2.7.m7.2.2.3" xref="S2.SS3.p2.7.m7.2.2.3.cmml">=</mo><mrow id="S2.SS3.p2.7.m7.2.2.2.2" xref="S2.SS3.p2.7.m7.2.2.2.3.cmml"><mo id="S2.SS3.p2.7.m7.2.2.2.2.3" stretchy="false" xref="S2.SS3.p2.7.m7.2.2.2.3.1.cmml">{</mo><mrow id="S2.SS3.p2.7.m7.1.1.1.1.1" xref="S2.SS3.p2.7.m7.1.1.1.1.1.cmml"><mi id="S2.SS3.p2.7.m7.1.1.1.1.1.2" xref="S2.SS3.p2.7.m7.1.1.1.1.1.2.cmml">i</mi><mo id="S2.SS3.p2.7.m7.1.1.1.1.1.1" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1.cmml">∈</mo><mi id="S2.SS3.p2.7.m7.1.1.1.1.1.3" xref="S2.SS3.p2.7.m7.1.1.1.1.1.3.cmml">I</mi></mrow><mo id="S2.SS3.p2.7.m7.2.2.2.2.4" lspace="0em" rspace="0em" xref="S2.SS3.p2.7.m7.2.2.2.3.1.cmml">|</mo><mrow id="S2.SS3.p2.7.m7.2.2.2.2.2" xref="S2.SS3.p2.7.m7.2.2.2.2.2.cmml"><msub id="S2.SS3.p2.7.m7.2.2.2.2.2.2" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2.cmml"><mi id="S2.SS3.p2.7.m7.2.2.2.2.2.2.2" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2.2.cmml">r</mi><mrow id="S2.SS3.p2.7.m7.2.2.2.2.2.2.3" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.cmml"><mi id="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.2" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.2.cmml">u</mi><mo id="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.1" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.3" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.3.cmml">i</mi></mrow></msub><mo id="S2.SS3.p2.7.m7.2.2.2.2.2.1" xref="S2.SS3.p2.7.m7.2.2.2.2.2.1.cmml">=</mo><mn id="S2.SS3.p2.7.m7.2.2.2.2.2.3" xref="S2.SS3.p2.7.m7.2.2.2.2.2.3.cmml">0</mn></mrow><mo id="S2.SS3.p2.7.m7.2.2.2.2.5" stretchy="false" xref="S2.SS3.p2.7.m7.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.7.m7.2b"><apply id="S2.SS3.p2.7.m7.2.2.cmml" xref="S2.SS3.p2.7.m7.2.2"><eq id="S2.SS3.p2.7.m7.2.2.3.cmml" xref="S2.SS3.p2.7.m7.2.2.3"></eq><apply id="S2.SS3.p2.7.m7.2.2.4.cmml" xref="S2.SS3.p2.7.m7.2.2.4"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m7.2.2.4.1.cmml" xref="S2.SS3.p2.7.m7.2.2.4">superscript</csymbol><apply id="S2.SS3.p2.7.m7.2.2.4.2.cmml" xref="S2.SS3.p2.7.m7.2.2.4"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m7.2.2.4.2.1.cmml" xref="S2.SS3.p2.7.m7.2.2.4">subscript</csymbol><ci id="S2.SS3.p2.7.m7.2.2.4.2.2.cmml" xref="S2.SS3.p2.7.m7.2.2.4.2.2">𝐼</ci><ci id="S2.SS3.p2.7.m7.2.2.4.2.3.cmml" xref="S2.SS3.p2.7.m7.2.2.4.2.3">𝑢</ci></apply><minus id="S2.SS3.p2.7.m7.2.2.4.3.cmml" xref="S2.SS3.p2.7.m7.2.2.4.3"></minus></apply><apply id="S2.SS3.p2.7.m7.2.2.2.3.cmml" xref="S2.SS3.p2.7.m7.2.2.2.2"><csymbol cd="latexml" id="S2.SS3.p2.7.m7.2.2.2.3.1.cmml" xref="S2.SS3.p2.7.m7.2.2.2.2.3">conditional-set</csymbol><apply id="S2.SS3.p2.7.m7.1.1.1.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1"><in id="S2.SS3.p2.7.m7.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.1"></in><ci id="S2.SS3.p2.7.m7.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.2">𝑖</ci><ci id="S2.SS3.p2.7.m7.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.7.m7.1.1.1.1.1.3">𝐼</ci></apply><apply id="S2.SS3.p2.7.m7.2.2.2.2.2.cmml" xref="S2.SS3.p2.7.m7.2.2.2.2.2"><eq id="S2.SS3.p2.7.m7.2.2.2.2.2.1.cmml" xref="S2.SS3.p2.7.m7.2.2.2.2.2.1"></eq><apply id="S2.SS3.p2.7.m7.2.2.2.2.2.2.cmml" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m7.2.2.2.2.2.2.1.cmml" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS3.p2.7.m7.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2.2">𝑟</ci><apply id="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.cmml" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2.3"><times id="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.1.cmml" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.1"></times><ci id="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.2.cmml" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.2">𝑢</ci><ci id="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.3.cmml" xref="S2.SS3.p2.7.m7.2.2.2.2.2.2.3.3">𝑖</ci></apply></apply><cn id="S2.SS3.p2.7.m7.2.2.2.2.2.3.cmml" type="integer" xref="S2.SS3.p2.7.m7.2.2.2.2.2.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.7.m7.2c">I_{u}^{-}=\{i\in I|r_{ui}=0\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.7.m7.2d">italic_I start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT = { italic_i ∈ italic_I | italic_r start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT = 0 }</annotation></semantics></math>.
Various loss functions, <math alttext="f" class="ltx_Math" display="inline" id="S2.SS3.p2.8.m8.1"><semantics id="S2.SS3.p2.8.m8.1a"><mi id="S2.SS3.p2.8.m8.1.1" xref="S2.SS3.p2.8.m8.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.8.m8.1b"><ci id="S2.SS3.p2.8.m8.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.8.m8.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.8.m8.1d">italic_f</annotation></semantics></math>, are used for training, utilizing predicted relevance <math alttext="s(u,i)" class="ltx_Math" display="inline" id="S2.SS3.p2.9.m9.2"><semantics id="S2.SS3.p2.9.m9.2a"><mrow id="S2.SS3.p2.9.m9.2.3" xref="S2.SS3.p2.9.m9.2.3.cmml"><mi id="S2.SS3.p2.9.m9.2.3.2" xref="S2.SS3.p2.9.m9.2.3.2.cmml">s</mi><mo id="S2.SS3.p2.9.m9.2.3.1" xref="S2.SS3.p2.9.m9.2.3.1.cmml">⁢</mo><mrow id="S2.SS3.p2.9.m9.2.3.3.2" xref="S2.SS3.p2.9.m9.2.3.3.1.cmml"><mo id="S2.SS3.p2.9.m9.2.3.3.2.1" stretchy="false" xref="S2.SS3.p2.9.m9.2.3.3.1.cmml">(</mo><mi id="S2.SS3.p2.9.m9.1.1" xref="S2.SS3.p2.9.m9.1.1.cmml">u</mi><mo id="S2.SS3.p2.9.m9.2.3.3.2.2" xref="S2.SS3.p2.9.m9.2.3.3.1.cmml">,</mo><mi id="S2.SS3.p2.9.m9.2.2" xref="S2.SS3.p2.9.m9.2.2.cmml">i</mi><mo id="S2.SS3.p2.9.m9.2.3.3.2.3" stretchy="false" xref="S2.SS3.p2.9.m9.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.9.m9.2b"><apply id="S2.SS3.p2.9.m9.2.3.cmml" xref="S2.SS3.p2.9.m9.2.3"><times id="S2.SS3.p2.9.m9.2.3.1.cmml" xref="S2.SS3.p2.9.m9.2.3.1"></times><ci id="S2.SS3.p2.9.m9.2.3.2.cmml" xref="S2.SS3.p2.9.m9.2.3.2">𝑠</ci><interval closure="open" id="S2.SS3.p2.9.m9.2.3.3.1.cmml" xref="S2.SS3.p2.9.m9.2.3.3.2"><ci id="S2.SS3.p2.9.m9.1.1.cmml" xref="S2.SS3.p2.9.m9.1.1">𝑢</ci><ci id="S2.SS3.p2.9.m9.2.2.cmml" xref="S2.SS3.p2.9.m9.2.2">𝑖</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.9.m9.2c">s(u,i)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.9.m9.2d">italic_s ( italic_u , italic_i )</annotation></semantics></math>, predicted distance <math alttext="d(u,i)" class="ltx_Math" display="inline" id="S2.SS3.p2.10.m10.2"><semantics id="S2.SS3.p2.10.m10.2a"><mrow id="S2.SS3.p2.10.m10.2.3" xref="S2.SS3.p2.10.m10.2.3.cmml"><mi id="S2.SS3.p2.10.m10.2.3.2" xref="S2.SS3.p2.10.m10.2.3.2.cmml">d</mi><mo id="S2.SS3.p2.10.m10.2.3.1" xref="S2.SS3.p2.10.m10.2.3.1.cmml">⁢</mo><mrow id="S2.SS3.p2.10.m10.2.3.3.2" xref="S2.SS3.p2.10.m10.2.3.3.1.cmml"><mo id="S2.SS3.p2.10.m10.2.3.3.2.1" stretchy="false" xref="S2.SS3.p2.10.m10.2.3.3.1.cmml">(</mo><mi id="S2.SS3.p2.10.m10.1.1" xref="S2.SS3.p2.10.m10.1.1.cmml">u</mi><mo id="S2.SS3.p2.10.m10.2.3.3.2.2" xref="S2.SS3.p2.10.m10.2.3.3.1.cmml">,</mo><mi id="S2.SS3.p2.10.m10.2.2" xref="S2.SS3.p2.10.m10.2.2.cmml">i</mi><mo id="S2.SS3.p2.10.m10.2.3.3.2.3" stretchy="false" xref="S2.SS3.p2.10.m10.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.10.m10.2b"><apply id="S2.SS3.p2.10.m10.2.3.cmml" xref="S2.SS3.p2.10.m10.2.3"><times id="S2.SS3.p2.10.m10.2.3.1.cmml" xref="S2.SS3.p2.10.m10.2.3.1"></times><ci id="S2.SS3.p2.10.m10.2.3.2.cmml" xref="S2.SS3.p2.10.m10.2.3.2">𝑑</ci><interval closure="open" id="S2.SS3.p2.10.m10.2.3.3.1.cmml" xref="S2.SS3.p2.10.m10.2.3.3.2"><ci id="S2.SS3.p2.10.m10.1.1.cmml" xref="S2.SS3.p2.10.m10.1.1">𝑢</ci><ci id="S2.SS3.p2.10.m10.2.2.cmml" xref="S2.SS3.p2.10.m10.2.2">𝑖</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.10.m10.2c">d(u,i)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.10.m10.2d">italic_d ( italic_u , italic_i )</annotation></semantics></math> and actual label <math alttext="l(u,i)" class="ltx_Math" display="inline" id="S2.SS3.p2.11.m11.2"><semantics id="S2.SS3.p2.11.m11.2a"><mrow id="S2.SS3.p2.11.m11.2.3" xref="S2.SS3.p2.11.m11.2.3.cmml"><mi id="S2.SS3.p2.11.m11.2.3.2" xref="S2.SS3.p2.11.m11.2.3.2.cmml">l</mi><mo id="S2.SS3.p2.11.m11.2.3.1" xref="S2.SS3.p2.11.m11.2.3.1.cmml">⁢</mo><mrow id="S2.SS3.p2.11.m11.2.3.3.2" xref="S2.SS3.p2.11.m11.2.3.3.1.cmml"><mo id="S2.SS3.p2.11.m11.2.3.3.2.1" stretchy="false" xref="S2.SS3.p2.11.m11.2.3.3.1.cmml">(</mo><mi id="S2.SS3.p2.11.m11.1.1" xref="S2.SS3.p2.11.m11.1.1.cmml">u</mi><mo id="S2.SS3.p2.11.m11.2.3.3.2.2" xref="S2.SS3.p2.11.m11.2.3.3.1.cmml">,</mo><mi id="S2.SS3.p2.11.m11.2.2" xref="S2.SS3.p2.11.m11.2.2.cmml">i</mi><mo id="S2.SS3.p2.11.m11.2.3.3.2.3" stretchy="false" xref="S2.SS3.p2.11.m11.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.11.m11.2b"><apply id="S2.SS3.p2.11.m11.2.3.cmml" xref="S2.SS3.p2.11.m11.2.3"><times id="S2.SS3.p2.11.m11.2.3.1.cmml" xref="S2.SS3.p2.11.m11.2.3.1"></times><ci id="S2.SS3.p2.11.m11.2.3.2.cmml" xref="S2.SS3.p2.11.m11.2.3.2">𝑙</ci><interval closure="open" id="S2.SS3.p2.11.m11.2.3.3.1.cmml" xref="S2.SS3.p2.11.m11.2.3.3.2"><ci id="S2.SS3.p2.11.m11.1.1.cmml" xref="S2.SS3.p2.11.m11.1.1">𝑢</ci><ci id="S2.SS3.p2.11.m11.2.2.cmml" xref="S2.SS3.p2.11.m11.2.2">𝑖</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.11.m11.2c">l(u,i)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.11.m11.2d">italic_l ( italic_u , italic_i )</annotation></semantics></math> of the user-item interactions. Some loss functions also use margin <math alttext="m" class="ltx_Math" display="inline" id="S2.SS3.p2.12.m12.1"><semantics id="S2.SS3.p2.12.m12.1a"><mi id="S2.SS3.p2.12.m12.1.1" xref="S2.SS3.p2.12.m12.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.12.m12.1b"><ci id="S2.SS3.p2.12.m12.1.1.cmml" xref="S2.SS3.p2.12.m12.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.12.m12.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.12.m12.1d">italic_m</annotation></semantics></math> and weight <math alttext="w" class="ltx_Math" display="inline" id="S2.SS3.p2.13.m13.1"><semantics id="S2.SS3.p2.13.m13.1a"><mi id="S2.SS3.p2.13.m13.1.1" xref="S2.SS3.p2.13.m13.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.13.m13.1b"><ci id="S2.SS3.p2.13.m13.1.1.cmml" xref="S2.SS3.p2.13.m13.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.13.m13.1c">w</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.13.m13.1d">italic_w</annotation></semantics></math> parameters.
Common contrastive loss functions are summarized below: 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.SS3.p2.17.2">Contrastive loss <cite class="ltx_cite ltx_citemacro_citep">(Chopra et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib6" title="">2005</a>)</cite></span> is one of the earliest contrastive loss functions.
For a user <math alttext="u" class="ltx_Math" display="inline" id="S2.SS3.p2.14.m14.1"><semantics id="S2.SS3.p2.14.m14.1a"><mi id="S2.SS3.p2.14.m14.1.1" xref="S2.SS3.p2.14.m14.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.14.m14.1b"><ci id="S2.SS3.p2.14.m14.1.1.cmml" xref="S2.SS3.p2.14.m14.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.14.m14.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.14.m14.1d">italic_u</annotation></semantics></math> and item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS3.p2.15.m15.1"><semantics id="S2.SS3.p2.15.m15.1a"><mi id="S2.SS3.p2.15.m15.1.1" xref="S2.SS3.p2.15.m15.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.15.m15.1b"><ci id="S2.SS3.p2.15.m15.1.1.cmml" xref="S2.SS3.p2.15.m15.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.15.m15.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.15.m15.1d">italic_i</annotation></semantics></math> (i.e., <math alttext="i\in I+" class="ltx_Math" display="inline" id="S2.SS3.p2.16.m16.1"><semantics id="S2.SS3.p2.16.m16.1a"><mrow id="S2.SS3.p2.16.m16.1.1" xref="S2.SS3.p2.16.m16.1.1.cmml"><mi id="S2.SS3.p2.16.m16.1.1.2" xref="S2.SS3.p2.16.m16.1.1.2.cmml">i</mi><mo id="S2.SS3.p2.16.m16.1.1.1" xref="S2.SS3.p2.16.m16.1.1.1.cmml">∈</mo><mrow id="S2.SS3.p2.16.m16.1.1.3" xref="S2.SS3.p2.16.m16.1.1.3.cmml"><mi id="S2.SS3.p2.16.m16.1.1.3.2" xref="S2.SS3.p2.16.m16.1.1.3.2.cmml">I</mi><mo id="S2.SS3.p2.16.m16.1.1.3.3" xref="S2.SS3.p2.16.m16.1.1.3.3.cmml">+</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.16.m16.1b"><apply id="S2.SS3.p2.16.m16.1.1.cmml" xref="S2.SS3.p2.16.m16.1.1"><in id="S2.SS3.p2.16.m16.1.1.1.cmml" xref="S2.SS3.p2.16.m16.1.1.1"></in><ci id="S2.SS3.p2.16.m16.1.1.2.cmml" xref="S2.SS3.p2.16.m16.1.1.2">𝑖</ci><apply id="S2.SS3.p2.16.m16.1.1.3.cmml" xref="S2.SS3.p2.16.m16.1.1.3"><csymbol cd="latexml" id="S2.SS3.p2.16.m16.1.1.3.1.cmml" xref="S2.SS3.p2.16.m16.1.1.3">limit-from</csymbol><ci id="S2.SS3.p2.16.m16.1.1.3.2.cmml" xref="S2.SS3.p2.16.m16.1.1.3.2">𝐼</ci><plus id="S2.SS3.p2.16.m16.1.1.3.3.cmml" xref="S2.SS3.p2.16.m16.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.16.m16.1c">i\in I+</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.16.m16.1d">italic_i ∈ italic_I +</annotation></semantics></math> or <math alttext="i\in I-" class="ltx_Math" display="inline" id="S2.SS3.p2.17.m17.1"><semantics id="S2.SS3.p2.17.m17.1a"><mrow id="S2.SS3.p2.17.m17.1.1" xref="S2.SS3.p2.17.m17.1.1.cmml"><mi id="S2.SS3.p2.17.m17.1.1.2" xref="S2.SS3.p2.17.m17.1.1.2.cmml">i</mi><mo id="S2.SS3.p2.17.m17.1.1.1" xref="S2.SS3.p2.17.m17.1.1.1.cmml">∈</mo><mrow id="S2.SS3.p2.17.m17.1.1.3" xref="S2.SS3.p2.17.m17.1.1.3.cmml"><mi id="S2.SS3.p2.17.m17.1.1.3.2" xref="S2.SS3.p2.17.m17.1.1.3.2.cmml">I</mi><mo id="S2.SS3.p2.17.m17.1.1.3.3" xref="S2.SS3.p2.17.m17.1.1.3.3.cmml">−</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.17.m17.1b"><apply id="S2.SS3.p2.17.m17.1.1.cmml" xref="S2.SS3.p2.17.m17.1.1"><in id="S2.SS3.p2.17.m17.1.1.1.cmml" xref="S2.SS3.p2.17.m17.1.1.1"></in><ci id="S2.SS3.p2.17.m17.1.1.2.cmml" xref="S2.SS3.p2.17.m17.1.1.2">𝑖</ci><apply id="S2.SS3.p2.17.m17.1.1.3.cmml" xref="S2.SS3.p2.17.m17.1.1.3"><csymbol cd="latexml" id="S2.SS3.p2.17.m17.1.1.3.1.cmml" xref="S2.SS3.p2.17.m17.1.1.3">limit-from</csymbol><ci id="S2.SS3.p2.17.m17.1.1.3.2.cmml" xref="S2.SS3.p2.17.m17.1.1.3.2">𝐼</ci><minus id="S2.SS3.p2.17.m17.1.1.3.3.cmml" xref="S2.SS3.p2.17.m17.1.1.3.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.17.m17.1c">i\in I-</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.17.m17.1d">italic_i ∈ italic_I -</annotation></semantics></math>), the goal is to make positive items closer and the negative items further away from the user. Its equation is:</p>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}L_{Contr.}=\dfrac{1}{2}\sum_{{x}\in{I}}Y_{i}d(u,i)^{2}{\ +}(1-Y_{%
i})max(0,m-d(u,i))^{2}\end{split}" class="ltx_Math" display="block" id="S2.E1.m1.42"><semantics id="S2.E1.m1.42a"><mtable displaystyle="true" id="S2.E1.m1.42.42.4" xref="S2.E1.m1.40.40.2.cmml"><mtr id="S2.E1.m1.42.42.4a" xref="S2.E1.m1.40.40.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S2.E1.m1.42.42.4b" xref="S2.E1.m1.40.40.2.cmml"><mrow id="S2.E1.m1.42.42.4.40.40.40" xref="S2.E1.m1.40.40.2.cmml"><msub id="S2.E1.m1.42.42.4.40.40.40.41" xref="S2.E1.m1.40.40.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml">L</mi><mrow id="S2.E1.m1.2.2.2.2.2.2.1.1" xref="S2.E1.m1.2.2.2.2.2.2.1.2.cmml"><mrow id="S2.E1.m1.2.2.2.2.2.2.1.1.1" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S2.E1.m1.2.2.2.2.2.2.1.1.1.2" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.2.cmml">C</mi><mo id="S2.E1.m1.2.2.2.2.2.2.1.1.1.1" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.2.2.2.2.2.2.1.1.1.3" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.3.cmml">o</mi><mo id="S2.E1.m1.2.2.2.2.2.2.1.1.1.1a" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.2.2.2.2.2.2.1.1.1.4" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.4.cmml">n</mi><mo id="S2.E1.m1.2.2.2.2.2.2.1.1.1.1b" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.2.2.2.2.2.2.1.1.1.5" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.5.cmml">t</mi><mo id="S2.E1.m1.2.2.2.2.2.2.1.1.1.1c" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S2.E1.m1.2.2.2.2.2.2.1.1.1.6" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.6.cmml">r</mi></mrow><mo id="S2.E1.m1.2.2.2.2.2.2.1.1.2" lspace="0em" xref="S2.E1.m1.2.2.2.2.2.2.1.2.cmml">.</mo></mrow></msub><mo id="S2.E1.m1.3.3.3.3.3.3" xref="S2.E1.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S2.E1.m1.42.42.4.40.40.40.40" xref="S2.E1.m1.40.40.2.cmml"><mrow id="S2.E1.m1.42.42.4.40.40.40.40.3" xref="S2.E1.m1.40.40.2.cmml"><mfrac id="S2.E1.m1.4.4.4.4.4.4" xref="S2.E1.m1.4.4.4.4.4.4.cmml"><mn id="S2.E1.m1.4.4.4.4.4.4.2" xref="S2.E1.m1.4.4.4.4.4.4.2.cmml">1</mn><mn id="S2.E1.m1.4.4.4.4.4.4.3" xref="S2.E1.m1.4.4.4.4.4.4.3.cmml">2</mn></mfrac><mo id="S2.E1.m1.42.42.4.40.40.40.40.3.1" xref="S2.E1.m1.40.40.2.cmml">⁢</mo><mrow id="S2.E1.m1.42.42.4.40.40.40.40.3.2" xref="S2.E1.m1.40.40.2.cmml"><munder id="S2.E1.m1.42.42.4.40.40.40.40.3.2.1" xref="S2.E1.m1.40.40.2.cmml"><mo id="S2.E1.m1.5.5.5.5.5.5" movablelimits="false" xref="S2.E1.m1.5.5.5.5.5.5.cmml">∑</mo><mrow id="S2.E1.m1.6.6.6.6.6.6.1" xref="S2.E1.m1.6.6.6.6.6.6.1.cmml"><mi id="S2.E1.m1.6.6.6.6.6.6.1.2" xref="S2.E1.m1.6.6.6.6.6.6.1.2.cmml">x</mi><mo id="S2.E1.m1.6.6.6.6.6.6.1.1" xref="S2.E1.m1.6.6.6.6.6.6.1.1.cmml">∈</mo><mi id="S2.E1.m1.6.6.6.6.6.6.1.3" xref="S2.E1.m1.6.6.6.6.6.6.1.3.cmml">I</mi></mrow></munder><mrow id="S2.E1.m1.42.42.4.40.40.40.40.3.2.2" xref="S2.E1.m1.40.40.2.cmml"><msub id="S2.E1.m1.42.42.4.40.40.40.40.3.2.2.2" xref="S2.E1.m1.40.40.2.cmml"><mi id="S2.E1.m1.7.7.7.7.7.7" xref="S2.E1.m1.7.7.7.7.7.7.cmml">Y</mi><mi id="S2.E1.m1.8.8.8.8.8.8.1" xref="S2.E1.m1.8.8.8.8.8.8.1.cmml">i</mi></msub><mo id="S2.E1.m1.42.42.4.40.40.40.40.3.2.2.1" xref="S2.E1.m1.40.40.2.cmml">⁢</mo><mi id="S2.E1.m1.9.9.9.9.9.9" xref="S2.E1.m1.9.9.9.9.9.9.cmml">d</mi><mo id="S2.E1.m1.42.42.4.40.40.40.40.3.2.2.1a" xref="S2.E1.m1.40.40.2.cmml">⁢</mo><msup id="S2.E1.m1.42.42.4.40.40.40.40.3.2.2.3" xref="S2.E1.m1.40.40.2.cmml"><mrow id="S2.E1.m1.42.42.4.40.40.40.40.3.2.2.3.2" xref="S2.E1.m1.40.40.2.cmml"><mo id="S2.E1.m1.10.10.10.10.10.10" stretchy="false" xref="S2.E1.m1.40.40.2.cmml">(</mo><mi id="S2.E1.m1.11.11.11.11.11.11" xref="S2.E1.m1.11.11.11.11.11.11.cmml">u</mi><mo id="S2.E1.m1.12.12.12.12.12.12" xref="S2.E1.m1.40.40.2.cmml">,</mo><mi id="S2.E1.m1.13.13.13.13.13.13" xref="S2.E1.m1.13.13.13.13.13.13.cmml">i</mi><mo id="S2.E1.m1.14.14.14.14.14.14" stretchy="false" xref="S2.E1.m1.40.40.2.cmml">)</mo></mrow><mn id="S2.E1.m1.15.15.15.15.15.15.1" xref="S2.E1.m1.15.15.15.15.15.15.1.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S2.E1.m1.16.16.16.16.16.16" xref="S2.E1.m1.16.16.16.16.16.16.cmml">+</mo><mrow id="S2.E1.m1.42.42.4.40.40.40.40.2" xref="S2.E1.m1.40.40.2.cmml"><mrow id="S2.E1.m1.41.41.3.39.39.39.39.1.1.1" xref="S2.E1.m1.40.40.2.cmml"><mo id="S2.E1.m1.17.17.17.17.17.17" stretchy="false" xref="S2.E1.m1.40.40.2.cmml">(</mo><mrow id="S2.E1.m1.41.41.3.39.39.39.39.1.1.1.1" xref="S2.E1.m1.40.40.2.cmml"><mn id="S2.E1.m1.18.18.18.18.18.18" xref="S2.E1.m1.18.18.18.18.18.18.cmml">1</mn><mo id="S2.E1.m1.19.19.19.19.19.19" xref="S2.E1.m1.19.19.19.19.19.19.cmml">−</mo><msub id="S2.E1.m1.41.41.3.39.39.39.39.1.1.1.1.1" xref="S2.E1.m1.40.40.2.cmml"><mi id="S2.E1.m1.20.20.20.20.20.20" xref="S2.E1.m1.20.20.20.20.20.20.cmml">Y</mi><mi id="S2.E1.m1.21.21.21.21.21.21.1" xref="S2.E1.m1.21.21.21.21.21.21.1.cmml">i</mi></msub></mrow><mo id="S2.E1.m1.22.22.22.22.22.22" stretchy="false" xref="S2.E1.m1.40.40.2.cmml">)</mo></mrow><mo id="S2.E1.m1.42.42.4.40.40.40.40.2.3" xref="S2.E1.m1.40.40.2.cmml">⁢</mo><mi id="S2.E1.m1.23.23.23.23.23.23" xref="S2.E1.m1.23.23.23.23.23.23.cmml">m</mi><mo id="S2.E1.m1.42.42.4.40.40.40.40.2.3a" xref="S2.E1.m1.40.40.2.cmml">⁢</mo><mi id="S2.E1.m1.24.24.24.24.24.24" xref="S2.E1.m1.24.24.24.24.24.24.cmml">a</mi><mo id="S2.E1.m1.42.42.4.40.40.40.40.2.3b" xref="S2.E1.m1.40.40.2.cmml">⁢</mo><mi id="S2.E1.m1.25.25.25.25.25.25" xref="S2.E1.m1.25.25.25.25.25.25.cmml">x</mi><mo id="S2.E1.m1.42.42.4.40.40.40.40.2.3c" xref="S2.E1.m1.40.40.2.cmml">⁢</mo><msup id="S2.E1.m1.42.42.4.40.40.40.40.2.2" xref="S2.E1.m1.40.40.2.cmml"><mrow id="S2.E1.m1.42.42.4.40.40.40.40.2.2.1.1" xref="S2.E1.m1.40.40.2.cmml"><mo id="S2.E1.m1.26.26.26.26.26.26" stretchy="false" xref="S2.E1.m1.40.40.2.cmml">(</mo><mn id="S2.E1.m1.27.27.27.27.27.27" xref="S2.E1.m1.27.27.27.27.27.27.cmml">0</mn><mo id="S2.E1.m1.28.28.28.28.28.28" xref="S2.E1.m1.40.40.2.cmml">,</mo><mrow id="S2.E1.m1.42.42.4.40.40.40.40.2.2.1.1.1" xref="S2.E1.m1.40.40.2.cmml"><mi id="S2.E1.m1.29.29.29.29.29.29" xref="S2.E1.m1.29.29.29.29.29.29.cmml">m</mi><mo id="S2.E1.m1.30.30.30.30.30.30" xref="S2.E1.m1.30.30.30.30.30.30.cmml">−</mo><mrow id="S2.E1.m1.42.42.4.40.40.40.40.2.2.1.1.1.1" xref="S2.E1.m1.40.40.2.cmml"><mi id="S2.E1.m1.31.31.31.31.31.31" xref="S2.E1.m1.31.31.31.31.31.31.cmml">d</mi><mo id="S2.E1.m1.42.42.4.40.40.40.40.2.2.1.1.1.1.1" xref="S2.E1.m1.40.40.2.cmml">⁢</mo><mrow id="S2.E1.m1.42.42.4.40.40.40.40.2.2.1.1.1.1.2" xref="S2.E1.m1.40.40.2.cmml"><mo id="S2.E1.m1.32.32.32.32.32.32" stretchy="false" xref="S2.E1.m1.40.40.2.cmml">(</mo><mi id="S2.E1.m1.33.33.33.33.33.33" xref="S2.E1.m1.33.33.33.33.33.33.cmml">u</mi><mo id="S2.E1.m1.34.34.34.34.34.34" xref="S2.E1.m1.40.40.2.cmml">,</mo><mi id="S2.E1.m1.35.35.35.35.35.35" xref="S2.E1.m1.35.35.35.35.35.35.cmml">i</mi><mo id="S2.E1.m1.36.36.36.36.36.36" stretchy="false" xref="S2.E1.m1.40.40.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.37.37.37.37.37.37" stretchy="false" xref="S2.E1.m1.40.40.2.cmml">)</mo></mrow><mn id="S2.E1.m1.38.38.38.38.38.38.1" xref="S2.E1.m1.38.38.38.38.38.38.1.cmml">2</mn></msup></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E1.m1.42b"><apply id="S2.E1.m1.40.40.2.cmml" xref="S2.E1.m1.42.42.4"><eq id="S2.E1.m1.3.3.3.3.3.3.cmml" xref="S2.E1.m1.3.3.3.3.3.3"></eq><apply id="S2.E1.m1.40.40.2.4.cmml" xref="S2.E1.m1.42.42.4"><csymbol cd="ambiguous" id="S2.E1.m1.40.40.2.4.1.cmml" xref="S2.E1.m1.42.42.4">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1">𝐿</ci><list id="S2.E1.m1.2.2.2.2.2.2.1.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1.1"><apply id="S2.E1.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1"><times id="S2.E1.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.1"></times><ci id="S2.E1.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.2">𝐶</ci><ci id="S2.E1.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.3">𝑜</ci><ci id="S2.E1.m1.2.2.2.2.2.2.1.1.1.4.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.4">𝑛</ci><ci id="S2.E1.m1.2.2.2.2.2.2.1.1.1.5.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.5">𝑡</ci><ci id="S2.E1.m1.2.2.2.2.2.2.1.1.1.6.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1.1.1.6">𝑟</ci></apply></list></apply><apply id="S2.E1.m1.40.40.2.2.cmml" xref="S2.E1.m1.42.42.4"><plus id="S2.E1.m1.16.16.16.16.16.16.cmml" xref="S2.E1.m1.16.16.16.16.16.16"></plus><apply id="S2.E1.m1.40.40.2.2.4.cmml" xref="S2.E1.m1.42.42.4"><times id="S2.E1.m1.40.40.2.2.4.1.cmml" xref="S2.E1.m1.42.42.4"></times><apply id="S2.E1.m1.4.4.4.4.4.4.cmml" xref="S2.E1.m1.4.4.4.4.4.4"><divide id="S2.E1.m1.4.4.4.4.4.4.1.cmml" xref="S2.E1.m1.4.4.4.4.4.4"></divide><cn id="S2.E1.m1.4.4.4.4.4.4.2.cmml" type="integer" xref="S2.E1.m1.4.4.4.4.4.4.2">1</cn><cn id="S2.E1.m1.4.4.4.4.4.4.3.cmml" type="integer" xref="S2.E1.m1.4.4.4.4.4.4.3">2</cn></apply><apply id="S2.E1.m1.40.40.2.2.4.3.cmml" xref="S2.E1.m1.42.42.4"><apply id="S2.E1.m1.40.40.2.2.4.3.1.cmml" xref="S2.E1.m1.42.42.4"><csymbol cd="ambiguous" id="S2.E1.m1.40.40.2.2.4.3.1.1.cmml" xref="S2.E1.m1.42.42.4">subscript</csymbol><sum id="S2.E1.m1.5.5.5.5.5.5.cmml" xref="S2.E1.m1.5.5.5.5.5.5"></sum><apply id="S2.E1.m1.6.6.6.6.6.6.1.cmml" xref="S2.E1.m1.6.6.6.6.6.6.1"><in id="S2.E1.m1.6.6.6.6.6.6.1.1.cmml" xref="S2.E1.m1.6.6.6.6.6.6.1.1"></in><ci id="S2.E1.m1.6.6.6.6.6.6.1.2.cmml" xref="S2.E1.m1.6.6.6.6.6.6.1.2">𝑥</ci><ci id="S2.E1.m1.6.6.6.6.6.6.1.3.cmml" xref="S2.E1.m1.6.6.6.6.6.6.1.3">𝐼</ci></apply></apply><apply id="S2.E1.m1.40.40.2.2.4.3.2.cmml" xref="S2.E1.m1.42.42.4"><times id="S2.E1.m1.40.40.2.2.4.3.2.1.cmml" xref="S2.E1.m1.42.42.4"></times><apply id="S2.E1.m1.40.40.2.2.4.3.2.2.cmml" xref="S2.E1.m1.42.42.4"><csymbol cd="ambiguous" id="S2.E1.m1.40.40.2.2.4.3.2.2.1.cmml" xref="S2.E1.m1.42.42.4">subscript</csymbol><ci id="S2.E1.m1.7.7.7.7.7.7.cmml" xref="S2.E1.m1.7.7.7.7.7.7">𝑌</ci><ci id="S2.E1.m1.8.8.8.8.8.8.1.cmml" xref="S2.E1.m1.8.8.8.8.8.8.1">𝑖</ci></apply><ci id="S2.E1.m1.9.9.9.9.9.9.cmml" xref="S2.E1.m1.9.9.9.9.9.9">𝑑</ci><apply id="S2.E1.m1.40.40.2.2.4.3.2.4.cmml" xref="S2.E1.m1.42.42.4"><csymbol cd="ambiguous" id="S2.E1.m1.40.40.2.2.4.3.2.4.1.cmml" xref="S2.E1.m1.42.42.4">superscript</csymbol><interval closure="open" id="S2.E1.m1.40.40.2.2.4.3.2.4.2.cmml" xref="S2.E1.m1.42.42.4"><ci id="S2.E1.m1.11.11.11.11.11.11.cmml" xref="S2.E1.m1.11.11.11.11.11.11">𝑢</ci><ci id="S2.E1.m1.13.13.13.13.13.13.cmml" xref="S2.E1.m1.13.13.13.13.13.13">𝑖</ci></interval><cn id="S2.E1.m1.15.15.15.15.15.15.1.cmml" type="integer" xref="S2.E1.m1.15.15.15.15.15.15.1">2</cn></apply></apply></apply></apply><apply id="S2.E1.m1.40.40.2.2.2.cmml" xref="S2.E1.m1.42.42.4"><times id="S2.E1.m1.40.40.2.2.2.3.cmml" xref="S2.E1.m1.42.42.4"></times><apply id="S2.E1.m1.39.39.1.1.1.1.1.1.cmml" xref="S2.E1.m1.42.42.4"><minus id="S2.E1.m1.19.19.19.19.19.19.cmml" xref="S2.E1.m1.19.19.19.19.19.19"></minus><cn id="S2.E1.m1.18.18.18.18.18.18.cmml" type="integer" xref="S2.E1.m1.18.18.18.18.18.18">1</cn><apply id="S2.E1.m1.39.39.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.42.42.4"><csymbol cd="ambiguous" id="S2.E1.m1.39.39.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.42.42.4">subscript</csymbol><ci id="S2.E1.m1.20.20.20.20.20.20.cmml" xref="S2.E1.m1.20.20.20.20.20.20">𝑌</ci><ci id="S2.E1.m1.21.21.21.21.21.21.1.cmml" xref="S2.E1.m1.21.21.21.21.21.21.1">𝑖</ci></apply></apply><ci id="S2.E1.m1.23.23.23.23.23.23.cmml" xref="S2.E1.m1.23.23.23.23.23.23">𝑚</ci><ci id="S2.E1.m1.24.24.24.24.24.24.cmml" xref="S2.E1.m1.24.24.24.24.24.24">𝑎</ci><ci id="S2.E1.m1.25.25.25.25.25.25.cmml" xref="S2.E1.m1.25.25.25.25.25.25">𝑥</ci><apply id="S2.E1.m1.40.40.2.2.2.2.cmml" xref="S2.E1.m1.42.42.4"><csymbol cd="ambiguous" id="S2.E1.m1.40.40.2.2.2.2.2.cmml" xref="S2.E1.m1.42.42.4">superscript</csymbol><interval closure="open" id="S2.E1.m1.40.40.2.2.2.2.1.2.cmml" xref="S2.E1.m1.42.42.4"><cn id="S2.E1.m1.27.27.27.27.27.27.cmml" type="integer" xref="S2.E1.m1.27.27.27.27.27.27">0</cn><apply id="S2.E1.m1.40.40.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.42.42.4"><minus id="S2.E1.m1.30.30.30.30.30.30.cmml" xref="S2.E1.m1.30.30.30.30.30.30"></minus><ci id="S2.E1.m1.29.29.29.29.29.29.cmml" xref="S2.E1.m1.29.29.29.29.29.29">𝑚</ci><apply id="S2.E1.m1.40.40.2.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.42.42.4"><times id="S2.E1.m1.40.40.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E1.m1.42.42.4"></times><ci id="S2.E1.m1.31.31.31.31.31.31.cmml" xref="S2.E1.m1.31.31.31.31.31.31">𝑑</ci><interval closure="open" id="S2.E1.m1.40.40.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E1.m1.42.42.4"><ci id="S2.E1.m1.33.33.33.33.33.33.cmml" xref="S2.E1.m1.33.33.33.33.33.33">𝑢</ci><ci id="S2.E1.m1.35.35.35.35.35.35.cmml" xref="S2.E1.m1.35.35.35.35.35.35">𝑖</ci></interval></apply></apply></interval><cn id="S2.E1.m1.38.38.38.38.38.38.1.cmml" type="integer" xref="S2.E1.m1.38.38.38.38.38.38.1">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.42c">\begin{split}L_{Contr.}=\dfrac{1}{2}\sum_{{x}\in{I}}Y_{i}d(u,i)^{2}{\ +}(1-Y_{%
i})max(0,m-d(u,i))^{2}\end{split}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.42d">start_ROW start_CELL italic_L start_POSTSUBSCRIPT italic_C italic_o italic_n italic_t italic_r . end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∑ start_POSTSUBSCRIPT italic_x ∈ italic_I end_POSTSUBSCRIPT italic_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_d ( italic_u , italic_i ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( 1 - italic_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) italic_m italic_a italic_x ( 0 , italic_m - italic_d ( italic_u , italic_i ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p3.6">In the equation, <math alttext="Y_{i}" class="ltx_Math" display="inline" id="S2.SS3.p3.1.m1.1"><semantics id="S2.SS3.p3.1.m1.1a"><msub id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml"><mi id="S2.SS3.p3.1.m1.1.1.2" xref="S2.SS3.p3.1.m1.1.1.2.cmml">Y</mi><mi id="S2.SS3.p3.1.m1.1.1.3" xref="S2.SS3.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><apply id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p3.1.m1.1.1.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2">𝑌</ci><ci id="S2.SS3.p3.1.m1.1.1.3.cmml" xref="S2.SS3.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">Y_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.1d">italic_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> function returns 1 if item is positive (i.e., <math alttext="i\in I+" class="ltx_Math" display="inline" id="S2.SS3.p3.2.m2.1"><semantics id="S2.SS3.p3.2.m2.1a"><mrow id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml"><mi id="S2.SS3.p3.2.m2.1.1.2" xref="S2.SS3.p3.2.m2.1.1.2.cmml">i</mi><mo id="S2.SS3.p3.2.m2.1.1.1" xref="S2.SS3.p3.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS3.p3.2.m2.1.1.3" xref="S2.SS3.p3.2.m2.1.1.3.cmml"><mi id="S2.SS3.p3.2.m2.1.1.3.2" xref="S2.SS3.p3.2.m2.1.1.3.2.cmml">I</mi><mo id="S2.SS3.p3.2.m2.1.1.3.3" xref="S2.SS3.p3.2.m2.1.1.3.3.cmml">+</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><apply id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1"><in id="S2.SS3.p3.2.m2.1.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1.1"></in><ci id="S2.SS3.p3.2.m2.1.1.2.cmml" xref="S2.SS3.p3.2.m2.1.1.2">𝑖</ci><apply id="S2.SS3.p3.2.m2.1.1.3.cmml" xref="S2.SS3.p3.2.m2.1.1.3"><csymbol cd="latexml" id="S2.SS3.p3.2.m2.1.1.3.1.cmml" xref="S2.SS3.p3.2.m2.1.1.3">limit-from</csymbol><ci id="S2.SS3.p3.2.m2.1.1.3.2.cmml" xref="S2.SS3.p3.2.m2.1.1.3.2">𝐼</ci><plus id="S2.SS3.p3.2.m2.1.1.3.3.cmml" xref="S2.SS3.p3.2.m2.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">i\in I+</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m2.1d">italic_i ∈ italic_I +</annotation></semantics></math>) and 0 otherwise. Margin <math alttext="m" class="ltx_Math" display="inline" id="S2.SS3.p3.3.m3.1"><semantics id="S2.SS3.p3.3.m3.1a"><mi id="S2.SS3.p3.3.m3.1.1" xref="S2.SS3.p3.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><ci id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.3.m3.1d">italic_m</annotation></semantics></math> defines a radius making the model to pay attention to hard-negatives, which are negative instances which has the lowest distance (i.e., most similar) to the user representation. Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S2.F2.sf1" title="In Figure 2 ‣ 2. Related Work ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">2a</span></a> illustrates this concept, where margin <math alttext="m1" class="ltx_Math" display="inline" id="S2.SS3.p3.4.m4.1"><semantics id="S2.SS3.p3.4.m4.1a"><mrow id="S2.SS3.p3.4.m4.1.1" xref="S2.SS3.p3.4.m4.1.1.cmml"><mi id="S2.SS3.p3.4.m4.1.1.2" xref="S2.SS3.p3.4.m4.1.1.2.cmml">m</mi><mo id="S2.SS3.p3.4.m4.1.1.1" xref="S2.SS3.p3.4.m4.1.1.1.cmml">⁢</mo><mn id="S2.SS3.p3.4.m4.1.1.3" xref="S2.SS3.p3.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m4.1b"><apply id="S2.SS3.p3.4.m4.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1"><times id="S2.SS3.p3.4.m4.1.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1.1"></times><ci id="S2.SS3.p3.4.m4.1.1.2.cmml" xref="S2.SS3.p3.4.m4.1.1.2">𝑚</ci><cn id="S2.SS3.p3.4.m4.1.1.3.cmml" type="integer" xref="S2.SS3.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m4.1c">m1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.4.m4.1d">italic_m 1</annotation></semantics></math> filters negative samples. As the result, only <math alttext="n1" class="ltx_Math" display="inline" id="S2.SS3.p3.5.m5.1"><semantics id="S2.SS3.p3.5.m5.1a"><mrow id="S2.SS3.p3.5.m5.1.1" xref="S2.SS3.p3.5.m5.1.1.cmml"><mi id="S2.SS3.p3.5.m5.1.1.2" xref="S2.SS3.p3.5.m5.1.1.2.cmml">n</mi><mo id="S2.SS3.p3.5.m5.1.1.1" xref="S2.SS3.p3.5.m5.1.1.1.cmml">⁢</mo><mn id="S2.SS3.p3.5.m5.1.1.3" xref="S2.SS3.p3.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.5.m5.1b"><apply id="S2.SS3.p3.5.m5.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1"><times id="S2.SS3.p3.5.m5.1.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1.1"></times><ci id="S2.SS3.p3.5.m5.1.1.2.cmml" xref="S2.SS3.p3.5.m5.1.1.2">𝑛</ci><cn id="S2.SS3.p3.5.m5.1.1.3.cmml" type="integer" xref="S2.SS3.p3.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.5.m5.1c">n1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.5.m5.1d">italic_n 1</annotation></semantics></math>, which is in the hard-negatives area, and positive item <math alttext="p" class="ltx_Math" display="inline" id="S2.SS3.p3.6.m6.1"><semantics id="S2.SS3.p3.6.m6.1a"><mi id="S2.SS3.p3.6.m6.1.1" xref="S2.SS3.p3.6.m6.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.6.m6.1b"><ci id="S2.SS3.p3.6.m6.1.1.cmml" xref="S2.SS3.p3.6.m6.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.6.m6.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.6.m6.1d">italic_p</annotation></semantics></math> are used for the computations.</p>
</div>
<div class="ltx_para" id="S2.SS3.p4">
<p class="ltx_p" id="S2.SS3.p4.14">Following a similar concept, Cosine Contrastive Loss (CCL), proposed by SimpleX <cite class="ltx_cite ltx_citemacro_citep">(Mao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib19" title="">2021</a>)</cite>, is one of the first application of contrastive loss in RS. CCL utilizes a set of negative items and cosine similarity instead of distance. Its equation is:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}L_{CCL}=\sum_{{i}\in{I+},{N}\subset{I-}}1-s(u,i){\ +}\dfrac{w}{N}%
\sum_{{j}\in{N}}max(0,s(u,j)-m)\end{split}" class="ltx_Math" display="block" id="S2.E2.m1.34"><semantics id="S2.E2.m1.34a"><mtable displaystyle="true" id="S2.E2.m1.34.34.2" xref="S2.E2.m1.33.33.1.cmml"><mtr id="S2.E2.m1.34.34.2a" xref="S2.E2.m1.33.33.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S2.E2.m1.34.34.2b" xref="S2.E2.m1.33.33.1.cmml"><mrow id="S2.E2.m1.34.34.2.33.33.33" xref="S2.E2.m1.33.33.1.cmml"><msub id="S2.E2.m1.34.34.2.33.33.33.34" xref="S2.E2.m1.33.33.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml">L</mi><mrow id="S2.E2.m1.2.2.2.2.2.2.1" xref="S2.E2.m1.2.2.2.2.2.2.1.cmml"><mi id="S2.E2.m1.2.2.2.2.2.2.1.2" xref="S2.E2.m1.2.2.2.2.2.2.1.2.cmml">C</mi><mo id="S2.E2.m1.2.2.2.2.2.2.1.1" xref="S2.E2.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.2.2.2.2.1.3" xref="S2.E2.m1.2.2.2.2.2.2.1.3.cmml">C</mi><mo id="S2.E2.m1.2.2.2.2.2.2.1.1a" xref="S2.E2.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S2.E2.m1.2.2.2.2.2.2.1.4" xref="S2.E2.m1.2.2.2.2.2.2.1.4.cmml">L</mi></mrow></msub><mo id="S2.E2.m1.3.3.3.3.3.3" rspace="0.111em" xref="S2.E2.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S2.E2.m1.34.34.2.33.33.33.33" xref="S2.E2.m1.33.33.1.cmml"><mrow id="S2.E2.m1.34.34.2.33.33.33.33.2" xref="S2.E2.m1.33.33.1.cmml"><mrow id="S2.E2.m1.34.34.2.33.33.33.33.2.1" xref="S2.E2.m1.33.33.1.cmml"><munder id="S2.E2.m1.34.34.2.33.33.33.33.2.1.1" xref="S2.E2.m1.33.33.1.cmml"><mo id="S2.E2.m1.4.4.4.4.4.4" movablelimits="false" xref="S2.E2.m1.4.4.4.4.4.4.cmml">∑</mo><mrow id="S2.E2.m1.5.5.5.5.5.5.1.2" xref="S2.E2.m1.5.5.5.5.5.5.1.3.cmml"><mrow id="S2.E2.m1.5.5.5.5.5.5.1.1.1" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.cmml"><mi id="S2.E2.m1.5.5.5.5.5.5.1.1.1.2" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.2.cmml">i</mi><mo id="S2.E2.m1.5.5.5.5.5.5.1.1.1.1" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.cmml">∈</mo><mrow id="S2.E2.m1.5.5.5.5.5.5.1.1.1.3" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.5.5.5.5.1.1.1.3.2" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.3.2.cmml">I</mi><mo id="S2.E2.m1.5.5.5.5.5.5.1.1.1.3.3" rspace="0em" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.3.3.cmml">+</mo></mrow></mrow><mo id="S2.E2.m1.5.5.5.5.5.5.1.2.3" xref="S2.E2.m1.5.5.5.5.5.5.1.3a.cmml">,</mo><mrow id="S2.E2.m1.5.5.5.5.5.5.1.2.2" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2.cmml"><mi id="S2.E2.m1.5.5.5.5.5.5.1.2.2.2" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2.2.cmml">N</mi><mo id="S2.E2.m1.5.5.5.5.5.5.1.2.2.1" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2.1.cmml">⊂</mo><mrow id="S2.E2.m1.5.5.5.5.5.5.1.2.2.3" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2.3.cmml"><mi id="S2.E2.m1.5.5.5.5.5.5.1.2.2.3.2" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2.3.2.cmml">I</mi><mo id="S2.E2.m1.5.5.5.5.5.5.1.2.2.3.3" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2.3.3.cmml">−</mo></mrow></mrow></mrow></munder><mn id="S2.E2.m1.6.6.6.6.6.6" xref="S2.E2.m1.6.6.6.6.6.6.cmml">1</mn></mrow><mo id="S2.E2.m1.7.7.7.7.7.7" xref="S2.E2.m1.7.7.7.7.7.7.cmml">−</mo><mrow id="S2.E2.m1.34.34.2.33.33.33.33.2.2" xref="S2.E2.m1.33.33.1.cmml"><mi id="S2.E2.m1.8.8.8.8.8.8" xref="S2.E2.m1.8.8.8.8.8.8.cmml">s</mi><mo id="S2.E2.m1.34.34.2.33.33.33.33.2.2.1" xref="S2.E2.m1.33.33.1.cmml">⁢</mo><mrow id="S2.E2.m1.34.34.2.33.33.33.33.2.2.2" xref="S2.E2.m1.33.33.1.cmml"><mo id="S2.E2.m1.9.9.9.9.9.9" stretchy="false" xref="S2.E2.m1.33.33.1.cmml">(</mo><mi id="S2.E2.m1.10.10.10.10.10.10" xref="S2.E2.m1.10.10.10.10.10.10.cmml">u</mi><mo id="S2.E2.m1.11.11.11.11.11.11" xref="S2.E2.m1.33.33.1.cmml">,</mo><mi id="S2.E2.m1.12.12.12.12.12.12" xref="S2.E2.m1.12.12.12.12.12.12.cmml">i</mi><mo id="S2.E2.m1.13.13.13.13.13.13" rspace="0.500em" stretchy="false" xref="S2.E2.m1.33.33.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.14.14.14.14.14.14" xref="S2.E2.m1.14.14.14.14.14.14.cmml">+</mo><mrow id="S2.E2.m1.34.34.2.33.33.33.33.1" xref="S2.E2.m1.33.33.1.cmml"><mfrac id="S2.E2.m1.15.15.15.15.15.15" xref="S2.E2.m1.15.15.15.15.15.15.cmml"><mi id="S2.E2.m1.15.15.15.15.15.15.2" xref="S2.E2.m1.15.15.15.15.15.15.2.cmml">w</mi><mi id="S2.E2.m1.15.15.15.15.15.15.3" xref="S2.E2.m1.15.15.15.15.15.15.3.cmml">N</mi></mfrac><mo id="S2.E2.m1.34.34.2.33.33.33.33.1.2" xref="S2.E2.m1.33.33.1.cmml">⁢</mo><mrow id="S2.E2.m1.34.34.2.33.33.33.33.1.1" xref="S2.E2.m1.33.33.1.cmml"><munder id="S2.E2.m1.34.34.2.33.33.33.33.1.1.2" xref="S2.E2.m1.33.33.1.cmml"><mo id="S2.E2.m1.16.16.16.16.16.16" movablelimits="false" xref="S2.E2.m1.16.16.16.16.16.16.cmml">∑</mo><mrow id="S2.E2.m1.17.17.17.17.17.17.1" xref="S2.E2.m1.17.17.17.17.17.17.1.cmml"><mi id="S2.E2.m1.17.17.17.17.17.17.1.2" xref="S2.E2.m1.17.17.17.17.17.17.1.2.cmml">j</mi><mo id="S2.E2.m1.17.17.17.17.17.17.1.1" xref="S2.E2.m1.17.17.17.17.17.17.1.1.cmml">∈</mo><mi id="S2.E2.m1.17.17.17.17.17.17.1.3" xref="S2.E2.m1.17.17.17.17.17.17.1.3.cmml">N</mi></mrow></munder><mrow id="S2.E2.m1.34.34.2.33.33.33.33.1.1.1" xref="S2.E2.m1.33.33.1.cmml"><mi id="S2.E2.m1.18.18.18.18.18.18" xref="S2.E2.m1.18.18.18.18.18.18.cmml">m</mi><mo id="S2.E2.m1.34.34.2.33.33.33.33.1.1.1.2" xref="S2.E2.m1.33.33.1.cmml">⁢</mo><mi id="S2.E2.m1.19.19.19.19.19.19" xref="S2.E2.m1.19.19.19.19.19.19.cmml">a</mi><mo id="S2.E2.m1.34.34.2.33.33.33.33.1.1.1.2a" xref="S2.E2.m1.33.33.1.cmml">⁢</mo><mi id="S2.E2.m1.20.20.20.20.20.20" xref="S2.E2.m1.20.20.20.20.20.20.cmml">x</mi><mo id="S2.E2.m1.34.34.2.33.33.33.33.1.1.1.2b" xref="S2.E2.m1.33.33.1.cmml">⁢</mo><mrow id="S2.E2.m1.34.34.2.33.33.33.33.1.1.1.1.1" xref="S2.E2.m1.33.33.1.cmml"><mo id="S2.E2.m1.21.21.21.21.21.21" stretchy="false" xref="S2.E2.m1.33.33.1.cmml">(</mo><mn id="S2.E2.m1.22.22.22.22.22.22" xref="S2.E2.m1.22.22.22.22.22.22.cmml">0</mn><mo id="S2.E2.m1.23.23.23.23.23.23" xref="S2.E2.m1.33.33.1.cmml">,</mo><mrow id="S2.E2.m1.34.34.2.33.33.33.33.1.1.1.1.1.1" xref="S2.E2.m1.33.33.1.cmml"><mrow id="S2.E2.m1.34.34.2.33.33.33.33.1.1.1.1.1.1.1" xref="S2.E2.m1.33.33.1.cmml"><mi id="S2.E2.m1.24.24.24.24.24.24" xref="S2.E2.m1.24.24.24.24.24.24.cmml">s</mi><mo id="S2.E2.m1.34.34.2.33.33.33.33.1.1.1.1.1.1.1.1" xref="S2.E2.m1.33.33.1.cmml">⁢</mo><mrow id="S2.E2.m1.34.34.2.33.33.33.33.1.1.1.1.1.1.1.2" xref="S2.E2.m1.33.33.1.cmml"><mo id="S2.E2.m1.25.25.25.25.25.25" stretchy="false" xref="S2.E2.m1.33.33.1.cmml">(</mo><mi id="S2.E2.m1.26.26.26.26.26.26" xref="S2.E2.m1.26.26.26.26.26.26.cmml">u</mi><mo id="S2.E2.m1.27.27.27.27.27.27" xref="S2.E2.m1.33.33.1.cmml">,</mo><mi id="S2.E2.m1.28.28.28.28.28.28" xref="S2.E2.m1.28.28.28.28.28.28.cmml">j</mi><mo id="S2.E2.m1.29.29.29.29.29.29" stretchy="false" xref="S2.E2.m1.33.33.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.30.30.30.30.30.30" xref="S2.E2.m1.30.30.30.30.30.30.cmml">−</mo><mi id="S2.E2.m1.31.31.31.31.31.31" xref="S2.E2.m1.31.31.31.31.31.31.cmml">m</mi></mrow><mo id="S2.E2.m1.32.32.32.32.32.32" stretchy="false" xref="S2.E2.m1.33.33.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E2.m1.34b"><apply id="S2.E2.m1.33.33.1.cmml" xref="S2.E2.m1.34.34.2"><eq id="S2.E2.m1.3.3.3.3.3.3.cmml" xref="S2.E2.m1.3.3.3.3.3.3"></eq><apply id="S2.E2.m1.33.33.1.3.cmml" xref="S2.E2.m1.34.34.2"><csymbol cd="ambiguous" id="S2.E2.m1.33.33.1.3.1.cmml" xref="S2.E2.m1.34.34.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1">𝐿</ci><apply id="S2.E2.m1.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2.1"><times id="S2.E2.m1.2.2.2.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2.1.1"></times><ci id="S2.E2.m1.2.2.2.2.2.2.1.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2.1.2">𝐶</ci><ci id="S2.E2.m1.2.2.2.2.2.2.1.3.cmml" xref="S2.E2.m1.2.2.2.2.2.2.1.3">𝐶</ci><ci id="S2.E2.m1.2.2.2.2.2.2.1.4.cmml" xref="S2.E2.m1.2.2.2.2.2.2.1.4">𝐿</ci></apply></apply><apply id="S2.E2.m1.33.33.1.1.cmml" xref="S2.E2.m1.34.34.2"><plus id="S2.E2.m1.14.14.14.14.14.14.cmml" xref="S2.E2.m1.14.14.14.14.14.14"></plus><apply id="S2.E2.m1.33.33.1.1.3.cmml" xref="S2.E2.m1.34.34.2"><minus id="S2.E2.m1.7.7.7.7.7.7.cmml" xref="S2.E2.m1.7.7.7.7.7.7"></minus><apply id="S2.E2.m1.33.33.1.1.3.2.cmml" xref="S2.E2.m1.34.34.2"><apply id="S2.E2.m1.33.33.1.1.3.2.1.cmml" xref="S2.E2.m1.34.34.2"><csymbol cd="ambiguous" id="S2.E2.m1.33.33.1.1.3.2.1.1.cmml" xref="S2.E2.m1.34.34.2">subscript</csymbol><sum id="S2.E2.m1.4.4.4.4.4.4.cmml" xref="S2.E2.m1.4.4.4.4.4.4"></sum><apply id="S2.E2.m1.5.5.5.5.5.5.1.3.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.5.5.5.5.1.3a.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.2.3">formulae-sequence</csymbol><apply id="S2.E2.m1.5.5.5.5.5.5.1.1.1.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1"><in id="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.1"></in><ci id="S2.E2.m1.5.5.5.5.5.5.1.1.1.2.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.2">𝑖</ci><apply id="S2.E2.m1.5.5.5.5.5.5.1.1.1.3.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.3"><csymbol cd="latexml" id="S2.E2.m1.5.5.5.5.5.5.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.3">limit-from</csymbol><ci id="S2.E2.m1.5.5.5.5.5.5.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.3.2">𝐼</ci><plus id="S2.E2.m1.5.5.5.5.5.5.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.3.3"></plus></apply></apply><apply id="S2.E2.m1.5.5.5.5.5.5.1.2.2.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2"><subset id="S2.E2.m1.5.5.5.5.5.5.1.2.2.1.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2.1"></subset><ci id="S2.E2.m1.5.5.5.5.5.5.1.2.2.2.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2.2">𝑁</ci><apply id="S2.E2.m1.5.5.5.5.5.5.1.2.2.3.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2.3"><csymbol cd="latexml" id="S2.E2.m1.5.5.5.5.5.5.1.2.2.3.1.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2.3">limit-from</csymbol><ci id="S2.E2.m1.5.5.5.5.5.5.1.2.2.3.2.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2.3.2">𝐼</ci><minus id="S2.E2.m1.5.5.5.5.5.5.1.2.2.3.3.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.2.2.3.3"></minus></apply></apply></apply></apply><cn id="S2.E2.m1.6.6.6.6.6.6.cmml" type="integer" xref="S2.E2.m1.6.6.6.6.6.6">1</cn></apply><apply id="S2.E2.m1.33.33.1.1.3.3.cmml" xref="S2.E2.m1.34.34.2"><times id="S2.E2.m1.33.33.1.1.3.3.1.cmml" xref="S2.E2.m1.34.34.2"></times><ci id="S2.E2.m1.8.8.8.8.8.8.cmml" xref="S2.E2.m1.8.8.8.8.8.8">𝑠</ci><interval closure="open" id="S2.E2.m1.33.33.1.1.3.3.3.cmml" xref="S2.E2.m1.34.34.2"><ci id="S2.E2.m1.10.10.10.10.10.10.cmml" xref="S2.E2.m1.10.10.10.10.10.10">𝑢</ci><ci id="S2.E2.m1.12.12.12.12.12.12.cmml" xref="S2.E2.m1.12.12.12.12.12.12">𝑖</ci></interval></apply></apply><apply id="S2.E2.m1.33.33.1.1.1.cmml" xref="S2.E2.m1.34.34.2"><times id="S2.E2.m1.33.33.1.1.1.2.cmml" xref="S2.E2.m1.34.34.2"></times><apply id="S2.E2.m1.15.15.15.15.15.15.cmml" xref="S2.E2.m1.15.15.15.15.15.15"><divide id="S2.E2.m1.15.15.15.15.15.15.1.cmml" xref="S2.E2.m1.15.15.15.15.15.15"></divide><ci id="S2.E2.m1.15.15.15.15.15.15.2.cmml" xref="S2.E2.m1.15.15.15.15.15.15.2">𝑤</ci><ci id="S2.E2.m1.15.15.15.15.15.15.3.cmml" xref="S2.E2.m1.15.15.15.15.15.15.3">𝑁</ci></apply><apply id="S2.E2.m1.33.33.1.1.1.1.cmml" xref="S2.E2.m1.34.34.2"><apply id="S2.E2.m1.33.33.1.1.1.1.2.cmml" xref="S2.E2.m1.34.34.2"><csymbol cd="ambiguous" id="S2.E2.m1.33.33.1.1.1.1.2.1.cmml" xref="S2.E2.m1.34.34.2">subscript</csymbol><sum id="S2.E2.m1.16.16.16.16.16.16.cmml" xref="S2.E2.m1.16.16.16.16.16.16"></sum><apply id="S2.E2.m1.17.17.17.17.17.17.1.cmml" xref="S2.E2.m1.17.17.17.17.17.17.1"><in id="S2.E2.m1.17.17.17.17.17.17.1.1.cmml" xref="S2.E2.m1.17.17.17.17.17.17.1.1"></in><ci id="S2.E2.m1.17.17.17.17.17.17.1.2.cmml" xref="S2.E2.m1.17.17.17.17.17.17.1.2">𝑗</ci><ci id="S2.E2.m1.17.17.17.17.17.17.1.3.cmml" xref="S2.E2.m1.17.17.17.17.17.17.1.3">𝑁</ci></apply></apply><apply id="S2.E2.m1.33.33.1.1.1.1.1.cmml" xref="S2.E2.m1.34.34.2"><times id="S2.E2.m1.33.33.1.1.1.1.1.2.cmml" xref="S2.E2.m1.34.34.2"></times><ci id="S2.E2.m1.18.18.18.18.18.18.cmml" xref="S2.E2.m1.18.18.18.18.18.18">𝑚</ci><ci id="S2.E2.m1.19.19.19.19.19.19.cmml" xref="S2.E2.m1.19.19.19.19.19.19">𝑎</ci><ci id="S2.E2.m1.20.20.20.20.20.20.cmml" xref="S2.E2.m1.20.20.20.20.20.20">𝑥</ci><interval closure="open" id="S2.E2.m1.33.33.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.34.34.2"><cn id="S2.E2.m1.22.22.22.22.22.22.cmml" type="integer" xref="S2.E2.m1.22.22.22.22.22.22">0</cn><apply id="S2.E2.m1.33.33.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.34.34.2"><minus id="S2.E2.m1.30.30.30.30.30.30.cmml" xref="S2.E2.m1.30.30.30.30.30.30"></minus><apply id="S2.E2.m1.33.33.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.34.34.2"><times id="S2.E2.m1.33.33.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.34.34.2"></times><ci id="S2.E2.m1.24.24.24.24.24.24.cmml" xref="S2.E2.m1.24.24.24.24.24.24">𝑠</ci><interval closure="open" id="S2.E2.m1.33.33.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.34.34.2"><ci id="S2.E2.m1.26.26.26.26.26.26.cmml" xref="S2.E2.m1.26.26.26.26.26.26">𝑢</ci><ci id="S2.E2.m1.28.28.28.28.28.28.cmml" xref="S2.E2.m1.28.28.28.28.28.28">𝑗</ci></interval></apply><ci id="S2.E2.m1.31.31.31.31.31.31.cmml" xref="S2.E2.m1.31.31.31.31.31.31">𝑚</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.34c">\begin{split}L_{CCL}=\sum_{{i}\in{I+},{N}\subset{I-}}1-s(u,i){\ +}\dfrac{w}{N}%
\sum_{{j}\in{N}}max(0,s(u,j)-m)\end{split}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.34d">start_ROW start_CELL italic_L start_POSTSUBSCRIPT italic_C italic_C italic_L end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i ∈ italic_I + , italic_N ⊂ italic_I - end_POSTSUBSCRIPT 1 - italic_s ( italic_u , italic_i ) + divide start_ARG italic_w end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_j ∈ italic_N end_POSTSUBSCRIPT italic_m italic_a italic_x ( 0 , italic_s ( italic_u , italic_j ) - italic_m ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p4.3"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.SS3.p4.3.1">Triplet loss <cite class="ltx_cite ltx_citemacro_citep">(Schroff et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib26" title="">2015</a>)</cite></span> is another commonly used contrastive loss function, originally proposed for face recognition in FaceNet <cite class="ltx_cite ltx_citemacro_citep">(Schroff et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib26" title="">2015</a>)</cite>. Using triplets of user <math alttext="u" class="ltx_Math" display="inline" id="S2.SS3.p4.1.m1.1"><semantics id="S2.SS3.p4.1.m1.1a"><mi id="S2.SS3.p4.1.m1.1.1" xref="S2.SS3.p4.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.1.m1.1b"><ci id="S2.SS3.p4.1.m1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.1.m1.1d">italic_u</annotation></semantics></math>, positive item <math alttext="i\in I+" class="ltx_Math" display="inline" id="S2.SS3.p4.2.m2.1"><semantics id="S2.SS3.p4.2.m2.1a"><mrow id="S2.SS3.p4.2.m2.1.1" xref="S2.SS3.p4.2.m2.1.1.cmml"><mi id="S2.SS3.p4.2.m2.1.1.2" xref="S2.SS3.p4.2.m2.1.1.2.cmml">i</mi><mo id="S2.SS3.p4.2.m2.1.1.1" xref="S2.SS3.p4.2.m2.1.1.1.cmml">∈</mo><mrow id="S2.SS3.p4.2.m2.1.1.3" xref="S2.SS3.p4.2.m2.1.1.3.cmml"><mi id="S2.SS3.p4.2.m2.1.1.3.2" xref="S2.SS3.p4.2.m2.1.1.3.2.cmml">I</mi><mo id="S2.SS3.p4.2.m2.1.1.3.3" xref="S2.SS3.p4.2.m2.1.1.3.3.cmml">+</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.2.m2.1b"><apply id="S2.SS3.p4.2.m2.1.1.cmml" xref="S2.SS3.p4.2.m2.1.1"><in id="S2.SS3.p4.2.m2.1.1.1.cmml" xref="S2.SS3.p4.2.m2.1.1.1"></in><ci id="S2.SS3.p4.2.m2.1.1.2.cmml" xref="S2.SS3.p4.2.m2.1.1.2">𝑖</ci><apply id="S2.SS3.p4.2.m2.1.1.3.cmml" xref="S2.SS3.p4.2.m2.1.1.3"><csymbol cd="latexml" id="S2.SS3.p4.2.m2.1.1.3.1.cmml" xref="S2.SS3.p4.2.m2.1.1.3">limit-from</csymbol><ci id="S2.SS3.p4.2.m2.1.1.3.2.cmml" xref="S2.SS3.p4.2.m2.1.1.3.2">𝐼</ci><plus id="S2.SS3.p4.2.m2.1.1.3.3.cmml" xref="S2.SS3.p4.2.m2.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.2.m2.1c">i\in I+</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.2.m2.1d">italic_i ∈ italic_I +</annotation></semantics></math> and negative item <math alttext="j\in I-" class="ltx_Math" display="inline" id="S2.SS3.p4.3.m3.1"><semantics id="S2.SS3.p4.3.m3.1a"><mrow id="S2.SS3.p4.3.m3.1.1" xref="S2.SS3.p4.3.m3.1.1.cmml"><mi id="S2.SS3.p4.3.m3.1.1.2" xref="S2.SS3.p4.3.m3.1.1.2.cmml">j</mi><mo id="S2.SS3.p4.3.m3.1.1.1" xref="S2.SS3.p4.3.m3.1.1.1.cmml">∈</mo><mrow id="S2.SS3.p4.3.m3.1.1.3" xref="S2.SS3.p4.3.m3.1.1.3.cmml"><mi id="S2.SS3.p4.3.m3.1.1.3.2" xref="S2.SS3.p4.3.m3.1.1.3.2.cmml">I</mi><mo id="S2.SS3.p4.3.m3.1.1.3.3" xref="S2.SS3.p4.3.m3.1.1.3.3.cmml">−</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.3.m3.1b"><apply id="S2.SS3.p4.3.m3.1.1.cmml" xref="S2.SS3.p4.3.m3.1.1"><in id="S2.SS3.p4.3.m3.1.1.1.cmml" xref="S2.SS3.p4.3.m3.1.1.1"></in><ci id="S2.SS3.p4.3.m3.1.1.2.cmml" xref="S2.SS3.p4.3.m3.1.1.2">𝑗</ci><apply id="S2.SS3.p4.3.m3.1.1.3.cmml" xref="S2.SS3.p4.3.m3.1.1.3"><csymbol cd="latexml" id="S2.SS3.p4.3.m3.1.1.3.1.cmml" xref="S2.SS3.p4.3.m3.1.1.3">limit-from</csymbol><ci id="S2.SS3.p4.3.m3.1.1.3.2.cmml" xref="S2.SS3.p4.3.m3.1.1.3.2">𝐼</ci><minus id="S2.SS3.p4.3.m3.1.1.3.3.cmml" xref="S2.SS3.p4.3.m3.1.1.3.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.3.m3.1c">j\in I-</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.3.m3.1d">italic_j ∈ italic_I -</annotation></semantics></math>, triplet loss aims to minimize distance between the user and the positive item while maximizing the distance between the user and the negative item. Its equation:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{Triplet}=\sum_{i\in I+,j\in I-}max(0,d(u,i)^{2}-d(u,j)^{2}+m)" class="ltx_Math" display="block" id="S2.E3.m1.8"><semantics id="S2.E3.m1.8a"><mrow id="S2.E3.m1.8.8" xref="S2.E3.m1.8.8.cmml"><msub id="S2.E3.m1.8.8.3" xref="S2.E3.m1.8.8.3.cmml"><mi id="S2.E3.m1.8.8.3.2" xref="S2.E3.m1.8.8.3.2.cmml">L</mi><mrow id="S2.E3.m1.8.8.3.3" xref="S2.E3.m1.8.8.3.3.cmml"><mi id="S2.E3.m1.8.8.3.3.2" xref="S2.E3.m1.8.8.3.3.2.cmml">T</mi><mo id="S2.E3.m1.8.8.3.3.1" xref="S2.E3.m1.8.8.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.8.8.3.3.3" xref="S2.E3.m1.8.8.3.3.3.cmml">r</mi><mo id="S2.E3.m1.8.8.3.3.1a" xref="S2.E3.m1.8.8.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.8.8.3.3.4" xref="S2.E3.m1.8.8.3.3.4.cmml">i</mi><mo id="S2.E3.m1.8.8.3.3.1b" xref="S2.E3.m1.8.8.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.8.8.3.3.5" xref="S2.E3.m1.8.8.3.3.5.cmml">p</mi><mo id="S2.E3.m1.8.8.3.3.1c" xref="S2.E3.m1.8.8.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.8.8.3.3.6" xref="S2.E3.m1.8.8.3.3.6.cmml">l</mi><mo id="S2.E3.m1.8.8.3.3.1d" xref="S2.E3.m1.8.8.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.8.8.3.3.7" xref="S2.E3.m1.8.8.3.3.7.cmml">e</mi><mo id="S2.E3.m1.8.8.3.3.1e" xref="S2.E3.m1.8.8.3.3.1.cmml">⁢</mo><mi id="S2.E3.m1.8.8.3.3.8" xref="S2.E3.m1.8.8.3.3.8.cmml">t</mi></mrow></msub><mo id="S2.E3.m1.8.8.2" rspace="0.111em" xref="S2.E3.m1.8.8.2.cmml">=</mo><mrow id="S2.E3.m1.8.8.1" xref="S2.E3.m1.8.8.1.cmml"><munder id="S2.E3.m1.8.8.1.2" xref="S2.E3.m1.8.8.1.2.cmml"><mo id="S2.E3.m1.8.8.1.2.2" movablelimits="false" xref="S2.E3.m1.8.8.1.2.2.cmml">∑</mo><mrow id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.3.cmml"><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.cmml">i</mi><mo id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml">∈</mo><mrow id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.3.2.cmml">I</mi><mo id="S2.E3.m1.1.1.1.1.1.3.3" rspace="0em" xref="S2.E3.m1.1.1.1.1.1.3.3.cmml">+</mo></mrow></mrow><mo id="S2.E3.m1.2.2.2.2.3" xref="S2.E3.m1.2.2.2.3a.cmml">,</mo><mrow id="S2.E3.m1.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.2.cmml"><mi id="S2.E3.m1.2.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.2.2.cmml">j</mi><mo id="S2.E3.m1.2.2.2.2.2.1" xref="S2.E3.m1.2.2.2.2.2.1.cmml">∈</mo><mrow id="S2.E3.m1.2.2.2.2.2.3" xref="S2.E3.m1.2.2.2.2.2.3.cmml"><mi id="S2.E3.m1.2.2.2.2.2.3.2" xref="S2.E3.m1.2.2.2.2.2.3.2.cmml">I</mi><mo id="S2.E3.m1.2.2.2.2.2.3.3" xref="S2.E3.m1.2.2.2.2.2.3.3.cmml">−</mo></mrow></mrow></mrow></munder><mrow id="S2.E3.m1.8.8.1.1" xref="S2.E3.m1.8.8.1.1.cmml"><mi id="S2.E3.m1.8.8.1.1.3" xref="S2.E3.m1.8.8.1.1.3.cmml">m</mi><mo id="S2.E3.m1.8.8.1.1.2" xref="S2.E3.m1.8.8.1.1.2.cmml">⁢</mo><mi id="S2.E3.m1.8.8.1.1.4" xref="S2.E3.m1.8.8.1.1.4.cmml">a</mi><mo id="S2.E3.m1.8.8.1.1.2a" xref="S2.E3.m1.8.8.1.1.2.cmml">⁢</mo><mi id="S2.E3.m1.8.8.1.1.5" xref="S2.E3.m1.8.8.1.1.5.cmml">x</mi><mo id="S2.E3.m1.8.8.1.1.2b" xref="S2.E3.m1.8.8.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.8.8.1.1.1.1" xref="S2.E3.m1.8.8.1.1.1.2.cmml"><mo id="S2.E3.m1.8.8.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.8.8.1.1.1.2.cmml">(</mo><mn id="S2.E3.m1.7.7" xref="S2.E3.m1.7.7.cmml">0</mn><mo id="S2.E3.m1.8.8.1.1.1.1.3" xref="S2.E3.m1.8.8.1.1.1.2.cmml">,</mo><mrow id="S2.E3.m1.8.8.1.1.1.1.1" xref="S2.E3.m1.8.8.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.8.8.1.1.1.1.1.2" xref="S2.E3.m1.8.8.1.1.1.1.1.2.cmml"><mrow id="S2.E3.m1.8.8.1.1.1.1.1.2.2" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.cmml"><mi id="S2.E3.m1.8.8.1.1.1.1.1.2.2.2" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.2.cmml">d</mi><mo id="S2.E3.m1.8.8.1.1.1.1.1.2.2.1" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.1.cmml">⁢</mo><msup id="S2.E3.m1.8.8.1.1.1.1.1.2.2.3" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.cmml"><mrow id="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.2.2" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.2.1.cmml"><mo id="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.2.2.1" stretchy="false" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.2.1.cmml">(</mo><mi id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">u</mi><mo id="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.2.2.2" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.2.1.cmml">,</mo><mi id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml">i</mi><mo id="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.2.2.3" stretchy="false" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.2.1.cmml">)</mo></mrow><mn id="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.3" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.3.cmml">2</mn></msup></mrow><mo id="S2.E3.m1.8.8.1.1.1.1.1.2.1" xref="S2.E3.m1.8.8.1.1.1.1.1.2.1.cmml">−</mo><mrow id="S2.E3.m1.8.8.1.1.1.1.1.2.3" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.cmml"><mi id="S2.E3.m1.8.8.1.1.1.1.1.2.3.2" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.2.cmml">d</mi><mo id="S2.E3.m1.8.8.1.1.1.1.1.2.3.1" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.1.cmml">⁢</mo><msup id="S2.E3.m1.8.8.1.1.1.1.1.2.3.3" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.cmml"><mrow id="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.2.2" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.2.1.cmml"><mo id="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.2.2.1" stretchy="false" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.2.1.cmml">(</mo><mi id="S2.E3.m1.5.5" xref="S2.E3.m1.5.5.cmml">u</mi><mo id="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.2.2.2" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.2.1.cmml">,</mo><mi id="S2.E3.m1.6.6" xref="S2.E3.m1.6.6.cmml">j</mi><mo id="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.2.2.3" stretchy="false" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.2.1.cmml">)</mo></mrow><mn id="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.3" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.3.cmml">2</mn></msup></mrow></mrow><mo id="S2.E3.m1.8.8.1.1.1.1.1.1" xref="S2.E3.m1.8.8.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E3.m1.8.8.1.1.1.1.1.3" xref="S2.E3.m1.8.8.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S2.E3.m1.8.8.1.1.1.1.4" stretchy="false" xref="S2.E3.m1.8.8.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.8b"><apply id="S2.E3.m1.8.8.cmml" xref="S2.E3.m1.8.8"><eq id="S2.E3.m1.8.8.2.cmml" xref="S2.E3.m1.8.8.2"></eq><apply id="S2.E3.m1.8.8.3.cmml" xref="S2.E3.m1.8.8.3"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.3.1.cmml" xref="S2.E3.m1.8.8.3">subscript</csymbol><ci id="S2.E3.m1.8.8.3.2.cmml" xref="S2.E3.m1.8.8.3.2">𝐿</ci><apply id="S2.E3.m1.8.8.3.3.cmml" xref="S2.E3.m1.8.8.3.3"><times id="S2.E3.m1.8.8.3.3.1.cmml" xref="S2.E3.m1.8.8.3.3.1"></times><ci id="S2.E3.m1.8.8.3.3.2.cmml" xref="S2.E3.m1.8.8.3.3.2">𝑇</ci><ci id="S2.E3.m1.8.8.3.3.3.cmml" xref="S2.E3.m1.8.8.3.3.3">𝑟</ci><ci id="S2.E3.m1.8.8.3.3.4.cmml" xref="S2.E3.m1.8.8.3.3.4">𝑖</ci><ci id="S2.E3.m1.8.8.3.3.5.cmml" xref="S2.E3.m1.8.8.3.3.5">𝑝</ci><ci id="S2.E3.m1.8.8.3.3.6.cmml" xref="S2.E3.m1.8.8.3.3.6">𝑙</ci><ci id="S2.E3.m1.8.8.3.3.7.cmml" xref="S2.E3.m1.8.8.3.3.7">𝑒</ci><ci id="S2.E3.m1.8.8.3.3.8.cmml" xref="S2.E3.m1.8.8.3.3.8">𝑡</ci></apply></apply><apply id="S2.E3.m1.8.8.1.cmml" xref="S2.E3.m1.8.8.1"><apply id="S2.E3.m1.8.8.1.2.cmml" xref="S2.E3.m1.8.8.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.1.2.1.cmml" xref="S2.E3.m1.8.8.1.2">subscript</csymbol><sum id="S2.E3.m1.8.8.1.2.2.cmml" xref="S2.E3.m1.8.8.1.2.2"></sum><apply id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.3a.cmml" xref="S2.E3.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><in id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1"></in><ci id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.2">𝑖</ci><apply id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3"><csymbol cd="latexml" id="S2.E3.m1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.3">limit-from</csymbol><ci id="S2.E3.m1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2">𝐼</ci><plus id="S2.E3.m1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3.3"></plus></apply></apply><apply id="S2.E3.m1.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2"><in id="S2.E3.m1.2.2.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1"></in><ci id="S2.E3.m1.2.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.2">𝑗</ci><apply id="S2.E3.m1.2.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.3"><csymbol cd="latexml" id="S2.E3.m1.2.2.2.2.2.3.1.cmml" xref="S2.E3.m1.2.2.2.2.2.3">limit-from</csymbol><ci id="S2.E3.m1.2.2.2.2.2.3.2.cmml" xref="S2.E3.m1.2.2.2.2.2.3.2">𝐼</ci><minus id="S2.E3.m1.2.2.2.2.2.3.3.cmml" xref="S2.E3.m1.2.2.2.2.2.3.3"></minus></apply></apply></apply></apply><apply id="S2.E3.m1.8.8.1.1.cmml" xref="S2.E3.m1.8.8.1.1"><times id="S2.E3.m1.8.8.1.1.2.cmml" xref="S2.E3.m1.8.8.1.1.2"></times><ci id="S2.E3.m1.8.8.1.1.3.cmml" xref="S2.E3.m1.8.8.1.1.3">𝑚</ci><ci id="S2.E3.m1.8.8.1.1.4.cmml" xref="S2.E3.m1.8.8.1.1.4">𝑎</ci><ci id="S2.E3.m1.8.8.1.1.5.cmml" xref="S2.E3.m1.8.8.1.1.5">𝑥</ci><interval closure="open" id="S2.E3.m1.8.8.1.1.1.2.cmml" xref="S2.E3.m1.8.8.1.1.1.1"><cn id="S2.E3.m1.7.7.cmml" type="integer" xref="S2.E3.m1.7.7">0</cn><apply id="S2.E3.m1.8.8.1.1.1.1.1.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1"><plus id="S2.E3.m1.8.8.1.1.1.1.1.1.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.1"></plus><apply id="S2.E3.m1.8.8.1.1.1.1.1.2.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2"><minus id="S2.E3.m1.8.8.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.1"></minus><apply id="S2.E3.m1.8.8.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2"><times id="S2.E3.m1.8.8.1.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.1"></times><ci id="S2.E3.m1.8.8.1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.2">𝑑</ci><apply id="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.3">superscript</csymbol><interval closure="open" id="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.2.1.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.2.2"><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">𝑢</ci><ci id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4">𝑖</ci></interval><cn id="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E3.m1.8.8.1.1.1.1.1.2.2.3.3">2</cn></apply></apply><apply id="S2.E3.m1.8.8.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3"><times id="S2.E3.m1.8.8.1.1.1.1.1.2.3.1.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.1"></times><ci id="S2.E3.m1.8.8.1.1.1.1.1.2.3.2.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.2">𝑑</ci><apply id="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.1.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.3">superscript</csymbol><interval closure="open" id="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.2.1.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.2.2"><ci id="S2.E3.m1.5.5.cmml" xref="S2.E3.m1.5.5">𝑢</ci><ci id="S2.E3.m1.6.6.cmml" xref="S2.E3.m1.6.6">𝑗</ci></interval><cn id="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.3.cmml" type="integer" xref="S2.E3.m1.8.8.1.1.1.1.1.2.3.3.3">2</cn></apply></apply></apply><ci id="S2.E3.m1.8.8.1.1.1.1.1.3.cmml" xref="S2.E3.m1.8.8.1.1.1.1.1.3">𝑚</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.8c">L_{Triplet}=\sum_{i\in I+,j\in I-}max(0,d(u,i)^{2}-d(u,j)^{2}+m)</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.8d">italic_L start_POSTSUBSCRIPT italic_T italic_r italic_i italic_p italic_l italic_e italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i ∈ italic_I + , italic_j ∈ italic_I - end_POSTSUBSCRIPT italic_m italic_a italic_x ( 0 , italic_d ( italic_u , italic_i ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - italic_d ( italic_u , italic_j ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_m )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p4.10">In the equation, margin <math alttext="m" class="ltx_Math" display="inline" id="S2.SS3.p4.4.m1.1"><semantics id="S2.SS3.p4.4.m1.1a"><mi id="S2.SS3.p4.4.m1.1.1" xref="S2.SS3.p4.4.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.4.m1.1b"><ci id="S2.SS3.p4.4.m1.1.1.cmml" xref="S2.SS3.p4.4.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.4.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.4.m1.1d">italic_m</annotation></semantics></math> defines a radius: (i) If the distance of negative item to the user is less than the distance of the positive item, <math alttext="d(u,n)&lt;d(u,p)" class="ltx_Math" display="inline" id="S2.SS3.p4.5.m2.4"><semantics id="S2.SS3.p4.5.m2.4a"><mrow id="S2.SS3.p4.5.m2.4.5" xref="S2.SS3.p4.5.m2.4.5.cmml"><mrow id="S2.SS3.p4.5.m2.4.5.2" xref="S2.SS3.p4.5.m2.4.5.2.cmml"><mi id="S2.SS3.p4.5.m2.4.5.2.2" xref="S2.SS3.p4.5.m2.4.5.2.2.cmml">d</mi><mo id="S2.SS3.p4.5.m2.4.5.2.1" xref="S2.SS3.p4.5.m2.4.5.2.1.cmml">⁢</mo><mrow id="S2.SS3.p4.5.m2.4.5.2.3.2" xref="S2.SS3.p4.5.m2.4.5.2.3.1.cmml"><mo id="S2.SS3.p4.5.m2.4.5.2.3.2.1" stretchy="false" xref="S2.SS3.p4.5.m2.4.5.2.3.1.cmml">(</mo><mi id="S2.SS3.p4.5.m2.1.1" xref="S2.SS3.p4.5.m2.1.1.cmml">u</mi><mo id="S2.SS3.p4.5.m2.4.5.2.3.2.2" xref="S2.SS3.p4.5.m2.4.5.2.3.1.cmml">,</mo><mi id="S2.SS3.p4.5.m2.2.2" xref="S2.SS3.p4.5.m2.2.2.cmml">n</mi><mo id="S2.SS3.p4.5.m2.4.5.2.3.2.3" stretchy="false" xref="S2.SS3.p4.5.m2.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p4.5.m2.4.5.1" xref="S2.SS3.p4.5.m2.4.5.1.cmml">&lt;</mo><mrow id="S2.SS3.p4.5.m2.4.5.3" xref="S2.SS3.p4.5.m2.4.5.3.cmml"><mi id="S2.SS3.p4.5.m2.4.5.3.2" xref="S2.SS3.p4.5.m2.4.5.3.2.cmml">d</mi><mo id="S2.SS3.p4.5.m2.4.5.3.1" xref="S2.SS3.p4.5.m2.4.5.3.1.cmml">⁢</mo><mrow id="S2.SS3.p4.5.m2.4.5.3.3.2" xref="S2.SS3.p4.5.m2.4.5.3.3.1.cmml"><mo id="S2.SS3.p4.5.m2.4.5.3.3.2.1" stretchy="false" xref="S2.SS3.p4.5.m2.4.5.3.3.1.cmml">(</mo><mi id="S2.SS3.p4.5.m2.3.3" xref="S2.SS3.p4.5.m2.3.3.cmml">u</mi><mo id="S2.SS3.p4.5.m2.4.5.3.3.2.2" xref="S2.SS3.p4.5.m2.4.5.3.3.1.cmml">,</mo><mi id="S2.SS3.p4.5.m2.4.4" xref="S2.SS3.p4.5.m2.4.4.cmml">p</mi><mo id="S2.SS3.p4.5.m2.4.5.3.3.2.3" stretchy="false" xref="S2.SS3.p4.5.m2.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.5.m2.4b"><apply id="S2.SS3.p4.5.m2.4.5.cmml" xref="S2.SS3.p4.5.m2.4.5"><lt id="S2.SS3.p4.5.m2.4.5.1.cmml" xref="S2.SS3.p4.5.m2.4.5.1"></lt><apply id="S2.SS3.p4.5.m2.4.5.2.cmml" xref="S2.SS3.p4.5.m2.4.5.2"><times id="S2.SS3.p4.5.m2.4.5.2.1.cmml" xref="S2.SS3.p4.5.m2.4.5.2.1"></times><ci id="S2.SS3.p4.5.m2.4.5.2.2.cmml" xref="S2.SS3.p4.5.m2.4.5.2.2">𝑑</ci><interval closure="open" id="S2.SS3.p4.5.m2.4.5.2.3.1.cmml" xref="S2.SS3.p4.5.m2.4.5.2.3.2"><ci id="S2.SS3.p4.5.m2.1.1.cmml" xref="S2.SS3.p4.5.m2.1.1">𝑢</ci><ci id="S2.SS3.p4.5.m2.2.2.cmml" xref="S2.SS3.p4.5.m2.2.2">𝑛</ci></interval></apply><apply id="S2.SS3.p4.5.m2.4.5.3.cmml" xref="S2.SS3.p4.5.m2.4.5.3"><times id="S2.SS3.p4.5.m2.4.5.3.1.cmml" xref="S2.SS3.p4.5.m2.4.5.3.1"></times><ci id="S2.SS3.p4.5.m2.4.5.3.2.cmml" xref="S2.SS3.p4.5.m2.4.5.3.2">𝑑</ci><interval closure="open" id="S2.SS3.p4.5.m2.4.5.3.3.1.cmml" xref="S2.SS3.p4.5.m2.4.5.3.3.2"><ci id="S2.SS3.p4.5.m2.3.3.cmml" xref="S2.SS3.p4.5.m2.3.3">𝑢</ci><ci id="S2.SS3.p4.5.m2.4.4.cmml" xref="S2.SS3.p4.5.m2.4.4">𝑝</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.5.m2.4c">d(u,n)&lt;d(u,p)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.5.m2.4d">italic_d ( italic_u , italic_n ) &lt; italic_d ( italic_u , italic_p )</annotation></semantics></math>, it is considered a hard negative. (ii) If the distance of negative item is between the distance of the positive item and the sum of the positive item distance and margin, <math alttext="d(u,p)&lt;d(u,n)&lt;d(u,p)+m" class="ltx_Math" display="inline" id="S2.SS3.p4.6.m3.6"><semantics id="S2.SS3.p4.6.m3.6a"><mrow id="S2.SS3.p4.6.m3.6.7" xref="S2.SS3.p4.6.m3.6.7.cmml"><mrow id="S2.SS3.p4.6.m3.6.7.2" xref="S2.SS3.p4.6.m3.6.7.2.cmml"><mi id="S2.SS3.p4.6.m3.6.7.2.2" xref="S2.SS3.p4.6.m3.6.7.2.2.cmml">d</mi><mo id="S2.SS3.p4.6.m3.6.7.2.1" xref="S2.SS3.p4.6.m3.6.7.2.1.cmml">⁢</mo><mrow id="S2.SS3.p4.6.m3.6.7.2.3.2" xref="S2.SS3.p4.6.m3.6.7.2.3.1.cmml"><mo id="S2.SS3.p4.6.m3.6.7.2.3.2.1" stretchy="false" xref="S2.SS3.p4.6.m3.6.7.2.3.1.cmml">(</mo><mi id="S2.SS3.p4.6.m3.1.1" xref="S2.SS3.p4.6.m3.1.1.cmml">u</mi><mo id="S2.SS3.p4.6.m3.6.7.2.3.2.2" xref="S2.SS3.p4.6.m3.6.7.2.3.1.cmml">,</mo><mi id="S2.SS3.p4.6.m3.2.2" xref="S2.SS3.p4.6.m3.2.2.cmml">p</mi><mo id="S2.SS3.p4.6.m3.6.7.2.3.2.3" stretchy="false" xref="S2.SS3.p4.6.m3.6.7.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p4.6.m3.6.7.3" xref="S2.SS3.p4.6.m3.6.7.3.cmml">&lt;</mo><mrow id="S2.SS3.p4.6.m3.6.7.4" xref="S2.SS3.p4.6.m3.6.7.4.cmml"><mi id="S2.SS3.p4.6.m3.6.7.4.2" xref="S2.SS3.p4.6.m3.6.7.4.2.cmml">d</mi><mo id="S2.SS3.p4.6.m3.6.7.4.1" xref="S2.SS3.p4.6.m3.6.7.4.1.cmml">⁢</mo><mrow id="S2.SS3.p4.6.m3.6.7.4.3.2" xref="S2.SS3.p4.6.m3.6.7.4.3.1.cmml"><mo id="S2.SS3.p4.6.m3.6.7.4.3.2.1" stretchy="false" xref="S2.SS3.p4.6.m3.6.7.4.3.1.cmml">(</mo><mi id="S2.SS3.p4.6.m3.3.3" xref="S2.SS3.p4.6.m3.3.3.cmml">u</mi><mo id="S2.SS3.p4.6.m3.6.7.4.3.2.2" xref="S2.SS3.p4.6.m3.6.7.4.3.1.cmml">,</mo><mi id="S2.SS3.p4.6.m3.4.4" xref="S2.SS3.p4.6.m3.4.4.cmml">n</mi><mo id="S2.SS3.p4.6.m3.6.7.4.3.2.3" stretchy="false" xref="S2.SS3.p4.6.m3.6.7.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p4.6.m3.6.7.5" xref="S2.SS3.p4.6.m3.6.7.5.cmml">&lt;</mo><mrow id="S2.SS3.p4.6.m3.6.7.6" xref="S2.SS3.p4.6.m3.6.7.6.cmml"><mrow id="S2.SS3.p4.6.m3.6.7.6.2" xref="S2.SS3.p4.6.m3.6.7.6.2.cmml"><mi id="S2.SS3.p4.6.m3.6.7.6.2.2" xref="S2.SS3.p4.6.m3.6.7.6.2.2.cmml">d</mi><mo id="S2.SS3.p4.6.m3.6.7.6.2.1" xref="S2.SS3.p4.6.m3.6.7.6.2.1.cmml">⁢</mo><mrow id="S2.SS3.p4.6.m3.6.7.6.2.3.2" xref="S2.SS3.p4.6.m3.6.7.6.2.3.1.cmml"><mo id="S2.SS3.p4.6.m3.6.7.6.2.3.2.1" stretchy="false" xref="S2.SS3.p4.6.m3.6.7.6.2.3.1.cmml">(</mo><mi id="S2.SS3.p4.6.m3.5.5" xref="S2.SS3.p4.6.m3.5.5.cmml">u</mi><mo id="S2.SS3.p4.6.m3.6.7.6.2.3.2.2" xref="S2.SS3.p4.6.m3.6.7.6.2.3.1.cmml">,</mo><mi id="S2.SS3.p4.6.m3.6.6" xref="S2.SS3.p4.6.m3.6.6.cmml">p</mi><mo id="S2.SS3.p4.6.m3.6.7.6.2.3.2.3" stretchy="false" xref="S2.SS3.p4.6.m3.6.7.6.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p4.6.m3.6.7.6.1" xref="S2.SS3.p4.6.m3.6.7.6.1.cmml">+</mo><mi id="S2.SS3.p4.6.m3.6.7.6.3" xref="S2.SS3.p4.6.m3.6.7.6.3.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.6.m3.6b"><apply id="S2.SS3.p4.6.m3.6.7.cmml" xref="S2.SS3.p4.6.m3.6.7"><and id="S2.SS3.p4.6.m3.6.7a.cmml" xref="S2.SS3.p4.6.m3.6.7"></and><apply id="S2.SS3.p4.6.m3.6.7b.cmml" xref="S2.SS3.p4.6.m3.6.7"><lt id="S2.SS3.p4.6.m3.6.7.3.cmml" xref="S2.SS3.p4.6.m3.6.7.3"></lt><apply id="S2.SS3.p4.6.m3.6.7.2.cmml" xref="S2.SS3.p4.6.m3.6.7.2"><times id="S2.SS3.p4.6.m3.6.7.2.1.cmml" xref="S2.SS3.p4.6.m3.6.7.2.1"></times><ci id="S2.SS3.p4.6.m3.6.7.2.2.cmml" xref="S2.SS3.p4.6.m3.6.7.2.2">𝑑</ci><interval closure="open" id="S2.SS3.p4.6.m3.6.7.2.3.1.cmml" xref="S2.SS3.p4.6.m3.6.7.2.3.2"><ci id="S2.SS3.p4.6.m3.1.1.cmml" xref="S2.SS3.p4.6.m3.1.1">𝑢</ci><ci id="S2.SS3.p4.6.m3.2.2.cmml" xref="S2.SS3.p4.6.m3.2.2">𝑝</ci></interval></apply><apply id="S2.SS3.p4.6.m3.6.7.4.cmml" xref="S2.SS3.p4.6.m3.6.7.4"><times id="S2.SS3.p4.6.m3.6.7.4.1.cmml" xref="S2.SS3.p4.6.m3.6.7.4.1"></times><ci id="S2.SS3.p4.6.m3.6.7.4.2.cmml" xref="S2.SS3.p4.6.m3.6.7.4.2">𝑑</ci><interval closure="open" id="S2.SS3.p4.6.m3.6.7.4.3.1.cmml" xref="S2.SS3.p4.6.m3.6.7.4.3.2"><ci id="S2.SS3.p4.6.m3.3.3.cmml" xref="S2.SS3.p4.6.m3.3.3">𝑢</ci><ci id="S2.SS3.p4.6.m3.4.4.cmml" xref="S2.SS3.p4.6.m3.4.4">𝑛</ci></interval></apply></apply><apply id="S2.SS3.p4.6.m3.6.7c.cmml" xref="S2.SS3.p4.6.m3.6.7"><lt id="S2.SS3.p4.6.m3.6.7.5.cmml" xref="S2.SS3.p4.6.m3.6.7.5"></lt><share href="https://arxiv.org/html/2405.04614v3#S2.SS3.p4.6.m3.6.7.4.cmml" id="S2.SS3.p4.6.m3.6.7d.cmml" xref="S2.SS3.p4.6.m3.6.7"></share><apply id="S2.SS3.p4.6.m3.6.7.6.cmml" xref="S2.SS3.p4.6.m3.6.7.6"><plus id="S2.SS3.p4.6.m3.6.7.6.1.cmml" xref="S2.SS3.p4.6.m3.6.7.6.1"></plus><apply id="S2.SS3.p4.6.m3.6.7.6.2.cmml" xref="S2.SS3.p4.6.m3.6.7.6.2"><times id="S2.SS3.p4.6.m3.6.7.6.2.1.cmml" xref="S2.SS3.p4.6.m3.6.7.6.2.1"></times><ci id="S2.SS3.p4.6.m3.6.7.6.2.2.cmml" xref="S2.SS3.p4.6.m3.6.7.6.2.2">𝑑</ci><interval closure="open" id="S2.SS3.p4.6.m3.6.7.6.2.3.1.cmml" xref="S2.SS3.p4.6.m3.6.7.6.2.3.2"><ci id="S2.SS3.p4.6.m3.5.5.cmml" xref="S2.SS3.p4.6.m3.5.5">𝑢</ci><ci id="S2.SS3.p4.6.m3.6.6.cmml" xref="S2.SS3.p4.6.m3.6.6">𝑝</ci></interval></apply><ci id="S2.SS3.p4.6.m3.6.7.6.3.cmml" xref="S2.SS3.p4.6.m3.6.7.6.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.6.m3.6c">d(u,p)&lt;d(u,n)&lt;d(u,p)+m</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.6.m3.6d">italic_d ( italic_u , italic_p ) &lt; italic_d ( italic_u , italic_n ) &lt; italic_d ( italic_u , italic_p ) + italic_m</annotation></semantics></math>, it is a semi-hard negative.
Both hard and semi-hard negatives are included in the computations.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S2.F2.sf1" title="In Figure 2 ‣ 2. Related Work ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">2a</span></a>, the margin <math alttext="m2" class="ltx_Math" display="inline" id="S2.SS3.p4.7.m4.1"><semantics id="S2.SS3.p4.7.m4.1a"><mrow id="S2.SS3.p4.7.m4.1.1" xref="S2.SS3.p4.7.m4.1.1.cmml"><mi id="S2.SS3.p4.7.m4.1.1.2" xref="S2.SS3.p4.7.m4.1.1.2.cmml">m</mi><mo id="S2.SS3.p4.7.m4.1.1.1" xref="S2.SS3.p4.7.m4.1.1.1.cmml">⁢</mo><mn id="S2.SS3.p4.7.m4.1.1.3" xref="S2.SS3.p4.7.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.7.m4.1b"><apply id="S2.SS3.p4.7.m4.1.1.cmml" xref="S2.SS3.p4.7.m4.1.1"><times id="S2.SS3.p4.7.m4.1.1.1.cmml" xref="S2.SS3.p4.7.m4.1.1.1"></times><ci id="S2.SS3.p4.7.m4.1.1.2.cmml" xref="S2.SS3.p4.7.m4.1.1.2">𝑚</ci><cn id="S2.SS3.p4.7.m4.1.1.3.cmml" type="integer" xref="S2.SS3.p4.7.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.7.m4.1c">m2</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.7.m4.1d">italic_m 2</annotation></semantics></math> is used for filtering negative samples. As the result, <math alttext="n1" class="ltx_Math" display="inline" id="S2.SS3.p4.8.m5.1"><semantics id="S2.SS3.p4.8.m5.1a"><mrow id="S2.SS3.p4.8.m5.1.1" xref="S2.SS3.p4.8.m5.1.1.cmml"><mi id="S2.SS3.p4.8.m5.1.1.2" xref="S2.SS3.p4.8.m5.1.1.2.cmml">n</mi><mo id="S2.SS3.p4.8.m5.1.1.1" xref="S2.SS3.p4.8.m5.1.1.1.cmml">⁢</mo><mn id="S2.SS3.p4.8.m5.1.1.3" xref="S2.SS3.p4.8.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.8.m5.1b"><apply id="S2.SS3.p4.8.m5.1.1.cmml" xref="S2.SS3.p4.8.m5.1.1"><times id="S2.SS3.p4.8.m5.1.1.1.cmml" xref="S2.SS3.p4.8.m5.1.1.1"></times><ci id="S2.SS3.p4.8.m5.1.1.2.cmml" xref="S2.SS3.p4.8.m5.1.1.2">𝑛</ci><cn id="S2.SS3.p4.8.m5.1.1.3.cmml" type="integer" xref="S2.SS3.p4.8.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.8.m5.1c">n1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.8.m5.1d">italic_n 1</annotation></semantics></math> and <math alttext="n2" class="ltx_Math" display="inline" id="S2.SS3.p4.9.m6.1"><semantics id="S2.SS3.p4.9.m6.1a"><mrow id="S2.SS3.p4.9.m6.1.1" xref="S2.SS3.p4.9.m6.1.1.cmml"><mi id="S2.SS3.p4.9.m6.1.1.2" xref="S2.SS3.p4.9.m6.1.1.2.cmml">n</mi><mo id="S2.SS3.p4.9.m6.1.1.1" xref="S2.SS3.p4.9.m6.1.1.1.cmml">⁢</mo><mn id="S2.SS3.p4.9.m6.1.1.3" xref="S2.SS3.p4.9.m6.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.9.m6.1b"><apply id="S2.SS3.p4.9.m6.1.1.cmml" xref="S2.SS3.p4.9.m6.1.1"><times id="S2.SS3.p4.9.m6.1.1.1.cmml" xref="S2.SS3.p4.9.m6.1.1.1"></times><ci id="S2.SS3.p4.9.m6.1.1.2.cmml" xref="S2.SS3.p4.9.m6.1.1.2">𝑛</ci><cn id="S2.SS3.p4.9.m6.1.1.3.cmml" type="integer" xref="S2.SS3.p4.9.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.9.m6.1c">n2</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.9.m6.1d">italic_n 2</annotation></semantics></math>, which are in the radius of positive item <math alttext="p" class="ltx_Math" display="inline" id="S2.SS3.p4.10.m7.1"><semantics id="S2.SS3.p4.10.m7.1a"><mi id="S2.SS3.p4.10.m7.1.1" xref="S2.SS3.p4.10.m7.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.10.m7.1b"><ci id="S2.SS3.p4.10.m7.1.1.cmml" xref="S2.SS3.p4.10.m7.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.10.m7.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.10.m7.1d">italic_p</annotation></semantics></math>, are used for the computations.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.SS3.p4.10.1">InfoNCE loss <cite class="ltx_cite ltx_citemacro_citep">(Oord et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib21" title="">2018</a>)</cite></span> builds on Noise Contrastive Estimation (NCE) <cite class="ltx_cite ltx_citemacro_citep">(Gutmann and Hyvärinen, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib10" title="">2010</a>)</cite>, which distinguishes the target data from noise. It ranks the positive samples higher. Its equation is:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{InfoNCE}=-\sum_{i\in I+}log\dfrac{exp(s(u,i))}{exp(s(u,i))+\sum_{j\in N}{%
exp(s(u,j))}}" class="ltx_Math" display="block" id="S2.E4.m1.9"><semantics id="S2.E4.m1.9a"><mrow id="S2.E4.m1.9.10" xref="S2.E4.m1.9.10.cmml"><msub id="S2.E4.m1.9.10.2" xref="S2.E4.m1.9.10.2.cmml"><mi id="S2.E4.m1.9.10.2.2" xref="S2.E4.m1.9.10.2.2.cmml">L</mi><mrow id="S2.E4.m1.9.10.2.3" xref="S2.E4.m1.9.10.2.3.cmml"><mi id="S2.E4.m1.9.10.2.3.2" xref="S2.E4.m1.9.10.2.3.2.cmml">I</mi><mo id="S2.E4.m1.9.10.2.3.1" xref="S2.E4.m1.9.10.2.3.1.cmml">⁢</mo><mi id="S2.E4.m1.9.10.2.3.3" xref="S2.E4.m1.9.10.2.3.3.cmml">n</mi><mo id="S2.E4.m1.9.10.2.3.1a" xref="S2.E4.m1.9.10.2.3.1.cmml">⁢</mo><mi id="S2.E4.m1.9.10.2.3.4" xref="S2.E4.m1.9.10.2.3.4.cmml">f</mi><mo id="S2.E4.m1.9.10.2.3.1b" xref="S2.E4.m1.9.10.2.3.1.cmml">⁢</mo><mi id="S2.E4.m1.9.10.2.3.5" xref="S2.E4.m1.9.10.2.3.5.cmml">o</mi><mo id="S2.E4.m1.9.10.2.3.1c" xref="S2.E4.m1.9.10.2.3.1.cmml">⁢</mo><mi id="S2.E4.m1.9.10.2.3.6" xref="S2.E4.m1.9.10.2.3.6.cmml">N</mi><mo id="S2.E4.m1.9.10.2.3.1d" xref="S2.E4.m1.9.10.2.3.1.cmml">⁢</mo><mi id="S2.E4.m1.9.10.2.3.7" xref="S2.E4.m1.9.10.2.3.7.cmml">C</mi><mo id="S2.E4.m1.9.10.2.3.1e" xref="S2.E4.m1.9.10.2.3.1.cmml">⁢</mo><mi id="S2.E4.m1.9.10.2.3.8" xref="S2.E4.m1.9.10.2.3.8.cmml">E</mi></mrow></msub><mo id="S2.E4.m1.9.10.1" xref="S2.E4.m1.9.10.1.cmml">=</mo><mrow id="S2.E4.m1.9.10.3" xref="S2.E4.m1.9.10.3.cmml"><mo id="S2.E4.m1.9.10.3a" xref="S2.E4.m1.9.10.3.cmml">−</mo><mrow id="S2.E4.m1.9.10.3.2" xref="S2.E4.m1.9.10.3.2.cmml"><munder id="S2.E4.m1.9.10.3.2.1" xref="S2.E4.m1.9.10.3.2.1.cmml"><mo id="S2.E4.m1.9.10.3.2.1.2" movablelimits="false" xref="S2.E4.m1.9.10.3.2.1.2.cmml">∑</mo><mrow id="S2.E4.m1.9.10.3.2.1.3" xref="S2.E4.m1.9.10.3.2.1.3.cmml"><mi id="S2.E4.m1.9.10.3.2.1.3.2" xref="S2.E4.m1.9.10.3.2.1.3.2.cmml">i</mi><mo id="S2.E4.m1.9.10.3.2.1.3.1" xref="S2.E4.m1.9.10.3.2.1.3.1.cmml">∈</mo><mrow id="S2.E4.m1.9.10.3.2.1.3.3" xref="S2.E4.m1.9.10.3.2.1.3.3.cmml"><mi id="S2.E4.m1.9.10.3.2.1.3.3.2" xref="S2.E4.m1.9.10.3.2.1.3.3.2.cmml">I</mi><mo id="S2.E4.m1.9.10.3.2.1.3.3.3" xref="S2.E4.m1.9.10.3.2.1.3.3.3.cmml">+</mo></mrow></mrow></munder><mrow id="S2.E4.m1.9.10.3.2.2" xref="S2.E4.m1.9.10.3.2.2.cmml"><mi id="S2.E4.m1.9.10.3.2.2.2" xref="S2.E4.m1.9.10.3.2.2.2.cmml">l</mi><mo id="S2.E4.m1.9.10.3.2.2.1" xref="S2.E4.m1.9.10.3.2.2.1.cmml">⁢</mo><mi id="S2.E4.m1.9.10.3.2.2.3" xref="S2.E4.m1.9.10.3.2.2.3.cmml">o</mi><mo id="S2.E4.m1.9.10.3.2.2.1a" xref="S2.E4.m1.9.10.3.2.2.1.cmml">⁢</mo><mi id="S2.E4.m1.9.10.3.2.2.4" xref="S2.E4.m1.9.10.3.2.2.4.cmml">g</mi><mo id="S2.E4.m1.9.10.3.2.2.1b" xref="S2.E4.m1.9.10.3.2.2.1.cmml">⁢</mo><mfrac id="S2.E4.m1.9.9" xref="S2.E4.m1.9.9.cmml"><mrow id="S2.E4.m1.3.3.3" xref="S2.E4.m1.3.3.3.cmml"><mi id="S2.E4.m1.3.3.3.5" xref="S2.E4.m1.3.3.3.5.cmml">e</mi><mo id="S2.E4.m1.3.3.3.4" xref="S2.E4.m1.3.3.3.4.cmml">⁢</mo><mi id="S2.E4.m1.3.3.3.6" xref="S2.E4.m1.3.3.3.6.cmml">x</mi><mo id="S2.E4.m1.3.3.3.4a" xref="S2.E4.m1.3.3.3.4.cmml">⁢</mo><mi id="S2.E4.m1.3.3.3.7" xref="S2.E4.m1.3.3.3.7.cmml">p</mi><mo id="S2.E4.m1.3.3.3.4b" xref="S2.E4.m1.3.3.3.4.cmml">⁢</mo><mrow id="S2.E4.m1.3.3.3.3.1" xref="S2.E4.m1.3.3.3.3.1.1.cmml"><mo id="S2.E4.m1.3.3.3.3.1.2" stretchy="false" xref="S2.E4.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S2.E4.m1.3.3.3.3.1.1" xref="S2.E4.m1.3.3.3.3.1.1.cmml"><mi id="S2.E4.m1.3.3.3.3.1.1.2" xref="S2.E4.m1.3.3.3.3.1.1.2.cmml">s</mi><mo id="S2.E4.m1.3.3.3.3.1.1.1" xref="S2.E4.m1.3.3.3.3.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.3.3.3.3.1.1.3.2" xref="S2.E4.m1.3.3.3.3.1.1.3.1.cmml"><mo id="S2.E4.m1.3.3.3.3.1.1.3.2.1" stretchy="false" xref="S2.E4.m1.3.3.3.3.1.1.3.1.cmml">(</mo><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">u</mi><mo id="S2.E4.m1.3.3.3.3.1.1.3.2.2" xref="S2.E4.m1.3.3.3.3.1.1.3.1.cmml">,</mo><mi id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.2.cmml">i</mi><mo id="S2.E4.m1.3.3.3.3.1.1.3.2.3" stretchy="false" xref="S2.E4.m1.3.3.3.3.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.3.3.3.3.1.3" stretchy="false" xref="S2.E4.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E4.m1.9.9.9" xref="S2.E4.m1.9.9.9.cmml"><mrow id="S2.E4.m1.8.8.8.5" xref="S2.E4.m1.8.8.8.5.cmml"><mi id="S2.E4.m1.8.8.8.5.3" xref="S2.E4.m1.8.8.8.5.3.cmml">e</mi><mo id="S2.E4.m1.8.8.8.5.2" xref="S2.E4.m1.8.8.8.5.2.cmml">⁢</mo><mi id="S2.E4.m1.8.8.8.5.4" xref="S2.E4.m1.8.8.8.5.4.cmml">x</mi><mo id="S2.E4.m1.8.8.8.5.2a" xref="S2.E4.m1.8.8.8.5.2.cmml">⁢</mo><mi id="S2.E4.m1.8.8.8.5.5" xref="S2.E4.m1.8.8.8.5.5.cmml">p</mi><mo id="S2.E4.m1.8.8.8.5.2b" xref="S2.E4.m1.8.8.8.5.2.cmml">⁢</mo><mrow id="S2.E4.m1.8.8.8.5.1.1" xref="S2.E4.m1.8.8.8.5.1.1.1.cmml"><mo id="S2.E4.m1.8.8.8.5.1.1.2" stretchy="false" xref="S2.E4.m1.8.8.8.5.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.8.8.8.5.1.1.1" xref="S2.E4.m1.8.8.8.5.1.1.1.cmml"><mi id="S2.E4.m1.8.8.8.5.1.1.1.2" xref="S2.E4.m1.8.8.8.5.1.1.1.2.cmml">s</mi><mo id="S2.E4.m1.8.8.8.5.1.1.1.1" xref="S2.E4.m1.8.8.8.5.1.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.8.8.8.5.1.1.1.3.2" xref="S2.E4.m1.8.8.8.5.1.1.1.3.1.cmml"><mo id="S2.E4.m1.8.8.8.5.1.1.1.3.2.1" stretchy="false" xref="S2.E4.m1.8.8.8.5.1.1.1.3.1.cmml">(</mo><mi id="S2.E4.m1.4.4.4.1" xref="S2.E4.m1.4.4.4.1.cmml">u</mi><mo id="S2.E4.m1.8.8.8.5.1.1.1.3.2.2" xref="S2.E4.m1.8.8.8.5.1.1.1.3.1.cmml">,</mo><mi id="S2.E4.m1.5.5.5.2" xref="S2.E4.m1.5.5.5.2.cmml">i</mi><mo id="S2.E4.m1.8.8.8.5.1.1.1.3.2.3" stretchy="false" xref="S2.E4.m1.8.8.8.5.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.8.8.8.5.1.1.3" stretchy="false" xref="S2.E4.m1.8.8.8.5.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.9.9.9.7" rspace="0.055em" xref="S2.E4.m1.9.9.9.7.cmml">+</mo><mrow id="S2.E4.m1.9.9.9.6" xref="S2.E4.m1.9.9.9.6.cmml"><msub id="S2.E4.m1.9.9.9.6.2" xref="S2.E4.m1.9.9.9.6.2.cmml"><mo id="S2.E4.m1.9.9.9.6.2.2" xref="S2.E4.m1.9.9.9.6.2.2.cmml">∑</mo><mrow id="S2.E4.m1.9.9.9.6.2.3" xref="S2.E4.m1.9.9.9.6.2.3.cmml"><mi id="S2.E4.m1.9.9.9.6.2.3.2" xref="S2.E4.m1.9.9.9.6.2.3.2.cmml">j</mi><mo id="S2.E4.m1.9.9.9.6.2.3.1" xref="S2.E4.m1.9.9.9.6.2.3.1.cmml">∈</mo><mi id="S2.E4.m1.9.9.9.6.2.3.3" xref="S2.E4.m1.9.9.9.6.2.3.3.cmml">N</mi></mrow></msub><mrow id="S2.E4.m1.9.9.9.6.1" xref="S2.E4.m1.9.9.9.6.1.cmml"><mi id="S2.E4.m1.9.9.9.6.1.3" xref="S2.E4.m1.9.9.9.6.1.3.cmml">e</mi><mo id="S2.E4.m1.9.9.9.6.1.2" xref="S2.E4.m1.9.9.9.6.1.2.cmml">⁢</mo><mi id="S2.E4.m1.9.9.9.6.1.4" xref="S2.E4.m1.9.9.9.6.1.4.cmml">x</mi><mo id="S2.E4.m1.9.9.9.6.1.2a" xref="S2.E4.m1.9.9.9.6.1.2.cmml">⁢</mo><mi id="S2.E4.m1.9.9.9.6.1.5" xref="S2.E4.m1.9.9.9.6.1.5.cmml">p</mi><mo id="S2.E4.m1.9.9.9.6.1.2b" xref="S2.E4.m1.9.9.9.6.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.9.9.9.6.1.1.1" xref="S2.E4.m1.9.9.9.6.1.1.1.1.cmml"><mo id="S2.E4.m1.9.9.9.6.1.1.1.2" stretchy="false" xref="S2.E4.m1.9.9.9.6.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.9.9.9.6.1.1.1.1" xref="S2.E4.m1.9.9.9.6.1.1.1.1.cmml"><mi id="S2.E4.m1.9.9.9.6.1.1.1.1.2" xref="S2.E4.m1.9.9.9.6.1.1.1.1.2.cmml">s</mi><mo id="S2.E4.m1.9.9.9.6.1.1.1.1.1" xref="S2.E4.m1.9.9.9.6.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E4.m1.9.9.9.6.1.1.1.1.3.2" xref="S2.E4.m1.9.9.9.6.1.1.1.1.3.1.cmml"><mo id="S2.E4.m1.9.9.9.6.1.1.1.1.3.2.1" stretchy="false" xref="S2.E4.m1.9.9.9.6.1.1.1.1.3.1.cmml">(</mo><mi id="S2.E4.m1.6.6.6.3" xref="S2.E4.m1.6.6.6.3.cmml">u</mi><mo id="S2.E4.m1.9.9.9.6.1.1.1.1.3.2.2" xref="S2.E4.m1.9.9.9.6.1.1.1.1.3.1.cmml">,</mo><mi id="S2.E4.m1.7.7.7.4" xref="S2.E4.m1.7.7.7.4.cmml">j</mi><mo id="S2.E4.m1.9.9.9.6.1.1.1.1.3.2.3" stretchy="false" xref="S2.E4.m1.9.9.9.6.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.9.9.9.6.1.1.1.3" stretchy="false" xref="S2.E4.m1.9.9.9.6.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.9b"><apply id="S2.E4.m1.9.10.cmml" xref="S2.E4.m1.9.10"><eq id="S2.E4.m1.9.10.1.cmml" xref="S2.E4.m1.9.10.1"></eq><apply id="S2.E4.m1.9.10.2.cmml" xref="S2.E4.m1.9.10.2"><csymbol cd="ambiguous" id="S2.E4.m1.9.10.2.1.cmml" xref="S2.E4.m1.9.10.2">subscript</csymbol><ci id="S2.E4.m1.9.10.2.2.cmml" xref="S2.E4.m1.9.10.2.2">𝐿</ci><apply id="S2.E4.m1.9.10.2.3.cmml" xref="S2.E4.m1.9.10.2.3"><times id="S2.E4.m1.9.10.2.3.1.cmml" xref="S2.E4.m1.9.10.2.3.1"></times><ci id="S2.E4.m1.9.10.2.3.2.cmml" xref="S2.E4.m1.9.10.2.3.2">𝐼</ci><ci id="S2.E4.m1.9.10.2.3.3.cmml" xref="S2.E4.m1.9.10.2.3.3">𝑛</ci><ci id="S2.E4.m1.9.10.2.3.4.cmml" xref="S2.E4.m1.9.10.2.3.4">𝑓</ci><ci id="S2.E4.m1.9.10.2.3.5.cmml" xref="S2.E4.m1.9.10.2.3.5">𝑜</ci><ci id="S2.E4.m1.9.10.2.3.6.cmml" xref="S2.E4.m1.9.10.2.3.6">𝑁</ci><ci id="S2.E4.m1.9.10.2.3.7.cmml" xref="S2.E4.m1.9.10.2.3.7">𝐶</ci><ci id="S2.E4.m1.9.10.2.3.8.cmml" xref="S2.E4.m1.9.10.2.3.8">𝐸</ci></apply></apply><apply id="S2.E4.m1.9.10.3.cmml" xref="S2.E4.m1.9.10.3"><minus id="S2.E4.m1.9.10.3.1.cmml" xref="S2.E4.m1.9.10.3"></minus><apply id="S2.E4.m1.9.10.3.2.cmml" xref="S2.E4.m1.9.10.3.2"><apply id="S2.E4.m1.9.10.3.2.1.cmml" xref="S2.E4.m1.9.10.3.2.1"><csymbol cd="ambiguous" id="S2.E4.m1.9.10.3.2.1.1.cmml" xref="S2.E4.m1.9.10.3.2.1">subscript</csymbol><sum id="S2.E4.m1.9.10.3.2.1.2.cmml" xref="S2.E4.m1.9.10.3.2.1.2"></sum><apply id="S2.E4.m1.9.10.3.2.1.3.cmml" xref="S2.E4.m1.9.10.3.2.1.3"><in id="S2.E4.m1.9.10.3.2.1.3.1.cmml" xref="S2.E4.m1.9.10.3.2.1.3.1"></in><ci id="S2.E4.m1.9.10.3.2.1.3.2.cmml" xref="S2.E4.m1.9.10.3.2.1.3.2">𝑖</ci><apply id="S2.E4.m1.9.10.3.2.1.3.3.cmml" xref="S2.E4.m1.9.10.3.2.1.3.3"><csymbol cd="latexml" id="S2.E4.m1.9.10.3.2.1.3.3.1.cmml" xref="S2.E4.m1.9.10.3.2.1.3.3">limit-from</csymbol><ci id="S2.E4.m1.9.10.3.2.1.3.3.2.cmml" xref="S2.E4.m1.9.10.3.2.1.3.3.2">𝐼</ci><plus id="S2.E4.m1.9.10.3.2.1.3.3.3.cmml" xref="S2.E4.m1.9.10.3.2.1.3.3.3"></plus></apply></apply></apply><apply id="S2.E4.m1.9.10.3.2.2.cmml" xref="S2.E4.m1.9.10.3.2.2"><times id="S2.E4.m1.9.10.3.2.2.1.cmml" xref="S2.E4.m1.9.10.3.2.2.1"></times><ci id="S2.E4.m1.9.10.3.2.2.2.cmml" xref="S2.E4.m1.9.10.3.2.2.2">𝑙</ci><ci id="S2.E4.m1.9.10.3.2.2.3.cmml" xref="S2.E4.m1.9.10.3.2.2.3">𝑜</ci><ci id="S2.E4.m1.9.10.3.2.2.4.cmml" xref="S2.E4.m1.9.10.3.2.2.4">𝑔</ci><apply id="S2.E4.m1.9.9.cmml" xref="S2.E4.m1.9.9"><divide id="S2.E4.m1.9.9.10.cmml" xref="S2.E4.m1.9.9"></divide><apply id="S2.E4.m1.3.3.3.cmml" xref="S2.E4.m1.3.3.3"><times id="S2.E4.m1.3.3.3.4.cmml" xref="S2.E4.m1.3.3.3.4"></times><ci id="S2.E4.m1.3.3.3.5.cmml" xref="S2.E4.m1.3.3.3.5">𝑒</ci><ci id="S2.E4.m1.3.3.3.6.cmml" xref="S2.E4.m1.3.3.3.6">𝑥</ci><ci id="S2.E4.m1.3.3.3.7.cmml" xref="S2.E4.m1.3.3.3.7">𝑝</ci><apply id="S2.E4.m1.3.3.3.3.1.1.cmml" xref="S2.E4.m1.3.3.3.3.1"><times id="S2.E4.m1.3.3.3.3.1.1.1.cmml" xref="S2.E4.m1.3.3.3.3.1.1.1"></times><ci id="S2.E4.m1.3.3.3.3.1.1.2.cmml" xref="S2.E4.m1.3.3.3.3.1.1.2">𝑠</ci><interval closure="open" id="S2.E4.m1.3.3.3.3.1.1.3.1.cmml" xref="S2.E4.m1.3.3.3.3.1.1.3.2"><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝑢</ci><ci id="S2.E4.m1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2">𝑖</ci></interval></apply></apply><apply id="S2.E4.m1.9.9.9.cmml" xref="S2.E4.m1.9.9.9"><plus id="S2.E4.m1.9.9.9.7.cmml" xref="S2.E4.m1.9.9.9.7"></plus><apply id="S2.E4.m1.8.8.8.5.cmml" xref="S2.E4.m1.8.8.8.5"><times id="S2.E4.m1.8.8.8.5.2.cmml" xref="S2.E4.m1.8.8.8.5.2"></times><ci id="S2.E4.m1.8.8.8.5.3.cmml" xref="S2.E4.m1.8.8.8.5.3">𝑒</ci><ci id="S2.E4.m1.8.8.8.5.4.cmml" xref="S2.E4.m1.8.8.8.5.4">𝑥</ci><ci id="S2.E4.m1.8.8.8.5.5.cmml" xref="S2.E4.m1.8.8.8.5.5">𝑝</ci><apply id="S2.E4.m1.8.8.8.5.1.1.1.cmml" xref="S2.E4.m1.8.8.8.5.1.1"><times id="S2.E4.m1.8.8.8.5.1.1.1.1.cmml" xref="S2.E4.m1.8.8.8.5.1.1.1.1"></times><ci id="S2.E4.m1.8.8.8.5.1.1.1.2.cmml" xref="S2.E4.m1.8.8.8.5.1.1.1.2">𝑠</ci><interval closure="open" id="S2.E4.m1.8.8.8.5.1.1.1.3.1.cmml" xref="S2.E4.m1.8.8.8.5.1.1.1.3.2"><ci id="S2.E4.m1.4.4.4.1.cmml" xref="S2.E4.m1.4.4.4.1">𝑢</ci><ci id="S2.E4.m1.5.5.5.2.cmml" xref="S2.E4.m1.5.5.5.2">𝑖</ci></interval></apply></apply><apply id="S2.E4.m1.9.9.9.6.cmml" xref="S2.E4.m1.9.9.9.6"><apply id="S2.E4.m1.9.9.9.6.2.cmml" xref="S2.E4.m1.9.9.9.6.2"><csymbol cd="ambiguous" id="S2.E4.m1.9.9.9.6.2.1.cmml" xref="S2.E4.m1.9.9.9.6.2">subscript</csymbol><sum id="S2.E4.m1.9.9.9.6.2.2.cmml" xref="S2.E4.m1.9.9.9.6.2.2"></sum><apply id="S2.E4.m1.9.9.9.6.2.3.cmml" xref="S2.E4.m1.9.9.9.6.2.3"><in id="S2.E4.m1.9.9.9.6.2.3.1.cmml" xref="S2.E4.m1.9.9.9.6.2.3.1"></in><ci id="S2.E4.m1.9.9.9.6.2.3.2.cmml" xref="S2.E4.m1.9.9.9.6.2.3.2">𝑗</ci><ci id="S2.E4.m1.9.9.9.6.2.3.3.cmml" xref="S2.E4.m1.9.9.9.6.2.3.3">𝑁</ci></apply></apply><apply id="S2.E4.m1.9.9.9.6.1.cmml" xref="S2.E4.m1.9.9.9.6.1"><times id="S2.E4.m1.9.9.9.6.1.2.cmml" xref="S2.E4.m1.9.9.9.6.1.2"></times><ci id="S2.E4.m1.9.9.9.6.1.3.cmml" xref="S2.E4.m1.9.9.9.6.1.3">𝑒</ci><ci id="S2.E4.m1.9.9.9.6.1.4.cmml" xref="S2.E4.m1.9.9.9.6.1.4">𝑥</ci><ci id="S2.E4.m1.9.9.9.6.1.5.cmml" xref="S2.E4.m1.9.9.9.6.1.5">𝑝</ci><apply id="S2.E4.m1.9.9.9.6.1.1.1.1.cmml" xref="S2.E4.m1.9.9.9.6.1.1.1"><times id="S2.E4.m1.9.9.9.6.1.1.1.1.1.cmml" xref="S2.E4.m1.9.9.9.6.1.1.1.1.1"></times><ci id="S2.E4.m1.9.9.9.6.1.1.1.1.2.cmml" xref="S2.E4.m1.9.9.9.6.1.1.1.1.2">𝑠</ci><interval closure="open" id="S2.E4.m1.9.9.9.6.1.1.1.1.3.1.cmml" xref="S2.E4.m1.9.9.9.6.1.1.1.1.3.2"><ci id="S2.E4.m1.6.6.6.3.cmml" xref="S2.E4.m1.6.6.6.3">𝑢</ci><ci id="S2.E4.m1.7.7.7.4.cmml" xref="S2.E4.m1.7.7.7.4">𝑗</ci></interval></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.9c">L_{InfoNCE}=-\sum_{i\in I+}log\dfrac{exp(s(u,i))}{exp(s(u,i))+\sum_{j\in N}{%
exp(s(u,j))}}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.9d">italic_L start_POSTSUBSCRIPT italic_I italic_n italic_f italic_o italic_N italic_C italic_E end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_i ∈ italic_I + end_POSTSUBSCRIPT italic_l italic_o italic_g divide start_ARG italic_e italic_x italic_p ( italic_s ( italic_u , italic_i ) ) end_ARG start_ARG italic_e italic_x italic_p ( italic_s ( italic_u , italic_i ) ) + ∑ start_POSTSUBSCRIPT italic_j ∈ italic_N end_POSTSUBSCRIPT italic_e italic_x italic_p ( italic_s ( italic_u , italic_j ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p4.15">AdvInfoNCE<cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib36" title="">2024</a>)</cite> enhances InfoNCE loss by adaptively exploring and assigning a difficulty level to each negative instance in an adversarial manner.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.SS3.p4.15.1">Bilateral SoftMax Loss <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib31" title="">2023</a>)</cite></span> is a recent addition to RS loss functions. It extends softmax loss (SL) by applying normalization techniques to both positive and negative instances, enhancing robustness to noisy data.
Its equation is:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}L_{BSL}=-\tau_{1}log\mathbb{E}_{i\sim P+}\dfrac{exp(s(u,i))}{\tau%
_{1}}{\ +}\tau_{2}log\mathbb{E}_{j\sim P-}\dfrac{exp(s(u,j))}{\tau_{2}}\end{split}" class="ltx_Math" display="block" id="S2.E5.m1.21"><semantics id="S2.E5.m1.21a"><mtable displaystyle="true" id="S2.E5.m1.21.21" xref="S2.E5.m1.21.22.1.cmml"><mtr id="S2.E5.m1.21.21a" xref="S2.E5.m1.21.22.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S2.E5.m1.21.21b" xref="S2.E5.m1.21.22.1.cmml"><mrow id="S2.E5.m1.21.21.21.21.21" xref="S2.E5.m1.21.22.1.cmml"><msub id="S2.E5.m1.21.21.21.21.21.22" xref="S2.E5.m1.21.22.1.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.cmml">L</mi><mrow id="S2.E5.m1.2.2.2.2.2.2.1" xref="S2.E5.m1.2.2.2.2.2.2.1.cmml"><mi id="S2.E5.m1.2.2.2.2.2.2.1.2" xref="S2.E5.m1.2.2.2.2.2.2.1.2.cmml">B</mi><mo id="S2.E5.m1.2.2.2.2.2.2.1.1" xref="S2.E5.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S2.E5.m1.2.2.2.2.2.2.1.3" xref="S2.E5.m1.2.2.2.2.2.2.1.3.cmml">S</mi><mo id="S2.E5.m1.2.2.2.2.2.2.1.1a" xref="S2.E5.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S2.E5.m1.2.2.2.2.2.2.1.4" xref="S2.E5.m1.2.2.2.2.2.2.1.4.cmml">L</mi></mrow></msub><mo id="S2.E5.m1.3.3.3.3.3.3" xref="S2.E5.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S2.E5.m1.21.21.21.21.21.23" xref="S2.E5.m1.21.22.1.cmml"><mrow id="S2.E5.m1.21.21.21.21.21.23.1" xref="S2.E5.m1.21.22.1.cmml"><mo id="S2.E5.m1.21.21.21.21.21.23.1a" xref="S2.E5.m1.21.22.1.cmml">−</mo><mrow id="S2.E5.m1.21.21.21.21.21.23.1.1" xref="S2.E5.m1.21.22.1.cmml"><msub id="S2.E5.m1.21.21.21.21.21.23.1.1.2" xref="S2.E5.m1.21.22.1.cmml"><mi id="S2.E5.m1.5.5.5.5.5.5" xref="S2.E5.m1.5.5.5.5.5.5.cmml">τ</mi><mn id="S2.E5.m1.6.6.6.6.6.6.1" xref="S2.E5.m1.6.6.6.6.6.6.1.cmml">1</mn></msub><mo id="S2.E5.m1.21.21.21.21.21.23.1.1.1" xref="S2.E5.m1.21.22.1.cmml">⁢</mo><mi id="S2.E5.m1.7.7.7.7.7.7" xref="S2.E5.m1.7.7.7.7.7.7.cmml">l</mi><mo id="S2.E5.m1.21.21.21.21.21.23.1.1.1a" xref="S2.E5.m1.21.22.1.cmml">⁢</mo><mi id="S2.E5.m1.8.8.8.8.8.8" xref="S2.E5.m1.8.8.8.8.8.8.cmml">o</mi><mo id="S2.E5.m1.21.21.21.21.21.23.1.1.1b" xref="S2.E5.m1.21.22.1.cmml">⁢</mo><mi id="S2.E5.m1.9.9.9.9.9.9" xref="S2.E5.m1.9.9.9.9.9.9.cmml">g</mi><mo id="S2.E5.m1.21.21.21.21.21.23.1.1.1c" xref="S2.E5.m1.21.22.1.cmml">⁢</mo><msub id="S2.E5.m1.21.21.21.21.21.23.1.1.3" xref="S2.E5.m1.21.22.1.cmml"><mi id="S2.E5.m1.10.10.10.10.10.10" xref="S2.E5.m1.10.10.10.10.10.10.cmml">𝔼</mi><mrow id="S2.E5.m1.11.11.11.11.11.11.1" xref="S2.E5.m1.11.11.11.11.11.11.1.cmml"><mi id="S2.E5.m1.11.11.11.11.11.11.1.2" xref="S2.E5.m1.11.11.11.11.11.11.1.2.cmml">i</mi><mo id="S2.E5.m1.11.11.11.11.11.11.1.1" xref="S2.E5.m1.11.11.11.11.11.11.1.1.cmml">∼</mo><mrow id="S2.E5.m1.11.11.11.11.11.11.1.3" xref="S2.E5.m1.11.11.11.11.11.11.1.3.cmml"><mi id="S2.E5.m1.11.11.11.11.11.11.1.3.2" xref="S2.E5.m1.11.11.11.11.11.11.1.3.2.cmml">P</mi><mo id="S2.E5.m1.11.11.11.11.11.11.1.3.3" xref="S2.E5.m1.11.11.11.11.11.11.1.3.3.cmml">+</mo></mrow></mrow></msub><mo id="S2.E5.m1.21.21.21.21.21.23.1.1.1d" xref="S2.E5.m1.21.22.1.cmml">⁢</mo><mfrac id="S2.E5.m1.12.12.12.12.12.12" xref="S2.E5.m1.12.12.12.12.12.12.cmml"><mrow id="S2.E5.m1.12.12.12.12.12.12.3" xref="S2.E5.m1.12.12.12.12.12.12.3.cmml"><mi id="S2.E5.m1.12.12.12.12.12.12.3.5" xref="S2.E5.m1.12.12.12.12.12.12.3.5.cmml">e</mi><mo id="S2.E5.m1.12.12.12.12.12.12.3.4" xref="S2.E5.m1.12.12.12.12.12.12.3.4.cmml">⁢</mo><mi id="S2.E5.m1.12.12.12.12.12.12.3.6" xref="S2.E5.m1.12.12.12.12.12.12.3.6.cmml">x</mi><mo id="S2.E5.m1.12.12.12.12.12.12.3.4a" xref="S2.E5.m1.12.12.12.12.12.12.3.4.cmml">⁢</mo><mi id="S2.E5.m1.12.12.12.12.12.12.3.7" xref="S2.E5.m1.12.12.12.12.12.12.3.7.cmml">p</mi><mo id="S2.E5.m1.12.12.12.12.12.12.3.4b" xref="S2.E5.m1.12.12.12.12.12.12.3.4.cmml">⁢</mo><mrow id="S2.E5.m1.12.12.12.12.12.12.3.3.1" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.cmml"><mo id="S2.E5.m1.12.12.12.12.12.12.3.3.1.2" stretchy="false" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.cmml">(</mo><mrow id="S2.E5.m1.12.12.12.12.12.12.3.3.1.1" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.cmml"><mi id="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.2" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.2.cmml">s</mi><mo id="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.1" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.1.cmml">⁢</mo><mrow id="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.3.2" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.3.1.cmml"><mo id="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.3.2.1" stretchy="false" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.3.1.cmml">(</mo><mi id="S2.E5.m1.12.12.12.12.12.12.1.1" xref="S2.E5.m1.12.12.12.12.12.12.1.1.cmml">u</mi><mo id="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.3.2.2" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.3.1.cmml">,</mo><mi id="S2.E5.m1.12.12.12.12.12.12.2.2" xref="S2.E5.m1.12.12.12.12.12.12.2.2.cmml">i</mi><mo id="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.3.2.3" stretchy="false" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.12.12.12.12.12.12.3.3.1.3" stretchy="false" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.cmml">)</mo></mrow></mrow><msub id="S2.E5.m1.12.12.12.12.12.12.5" xref="S2.E5.m1.12.12.12.12.12.12.5.cmml"><mi id="S2.E5.m1.12.12.12.12.12.12.5.2" xref="S2.E5.m1.12.12.12.12.12.12.5.2.cmml">τ</mi><mn id="S2.E5.m1.12.12.12.12.12.12.5.3" xref="S2.E5.m1.12.12.12.12.12.12.5.3.cmml">1</mn></msub></mfrac></mrow></mrow><mo id="S2.E5.m1.13.13.13.13.13.13" lspace="0.722em" xref="S2.E5.m1.13.13.13.13.13.13.cmml">+</mo><mrow id="S2.E5.m1.21.21.21.21.21.23.2" xref="S2.E5.m1.21.22.1.cmml"><msub id="S2.E5.m1.21.21.21.21.21.23.2.2" xref="S2.E5.m1.21.22.1.cmml"><mi id="S2.E5.m1.14.14.14.14.14.14" xref="S2.E5.m1.14.14.14.14.14.14.cmml">τ</mi><mn id="S2.E5.m1.15.15.15.15.15.15.1" xref="S2.E5.m1.15.15.15.15.15.15.1.cmml">2</mn></msub><mo id="S2.E5.m1.21.21.21.21.21.23.2.1" xref="S2.E5.m1.21.22.1.cmml">⁢</mo><mi id="S2.E5.m1.16.16.16.16.16.16" xref="S2.E5.m1.16.16.16.16.16.16.cmml">l</mi><mo id="S2.E5.m1.21.21.21.21.21.23.2.1a" xref="S2.E5.m1.21.22.1.cmml">⁢</mo><mi id="S2.E5.m1.17.17.17.17.17.17" xref="S2.E5.m1.17.17.17.17.17.17.cmml">o</mi><mo id="S2.E5.m1.21.21.21.21.21.23.2.1b" xref="S2.E5.m1.21.22.1.cmml">⁢</mo><mi id="S2.E5.m1.18.18.18.18.18.18" xref="S2.E5.m1.18.18.18.18.18.18.cmml">g</mi><mo id="S2.E5.m1.21.21.21.21.21.23.2.1c" xref="S2.E5.m1.21.22.1.cmml">⁢</mo><msub id="S2.E5.m1.21.21.21.21.21.23.2.3" xref="S2.E5.m1.21.22.1.cmml"><mi id="S2.E5.m1.19.19.19.19.19.19" xref="S2.E5.m1.19.19.19.19.19.19.cmml">𝔼</mi><mrow id="S2.E5.m1.20.20.20.20.20.20.1" xref="S2.E5.m1.20.20.20.20.20.20.1.cmml"><mi id="S2.E5.m1.20.20.20.20.20.20.1.2" xref="S2.E5.m1.20.20.20.20.20.20.1.2.cmml">j</mi><mo id="S2.E5.m1.20.20.20.20.20.20.1.1" xref="S2.E5.m1.20.20.20.20.20.20.1.1.cmml">∼</mo><mrow id="S2.E5.m1.20.20.20.20.20.20.1.3" xref="S2.E5.m1.20.20.20.20.20.20.1.3.cmml"><mi id="S2.E5.m1.20.20.20.20.20.20.1.3.2" xref="S2.E5.m1.20.20.20.20.20.20.1.3.2.cmml">P</mi><mo id="S2.E5.m1.20.20.20.20.20.20.1.3.3" xref="S2.E5.m1.20.20.20.20.20.20.1.3.3.cmml">−</mo></mrow></mrow></msub><mo id="S2.E5.m1.21.21.21.21.21.23.2.1d" xref="S2.E5.m1.21.22.1.cmml">⁢</mo><mfrac id="S2.E5.m1.21.21.21.21.21.21" xref="S2.E5.m1.21.21.21.21.21.21.cmml"><mrow id="S2.E5.m1.21.21.21.21.21.21.3" xref="S2.E5.m1.21.21.21.21.21.21.3.cmml"><mi id="S2.E5.m1.21.21.21.21.21.21.3.5" xref="S2.E5.m1.21.21.21.21.21.21.3.5.cmml">e</mi><mo id="S2.E5.m1.21.21.21.21.21.21.3.4" xref="S2.E5.m1.21.21.21.21.21.21.3.4.cmml">⁢</mo><mi id="S2.E5.m1.21.21.21.21.21.21.3.6" xref="S2.E5.m1.21.21.21.21.21.21.3.6.cmml">x</mi><mo id="S2.E5.m1.21.21.21.21.21.21.3.4a" xref="S2.E5.m1.21.21.21.21.21.21.3.4.cmml">⁢</mo><mi id="S2.E5.m1.21.21.21.21.21.21.3.7" xref="S2.E5.m1.21.21.21.21.21.21.3.7.cmml">p</mi><mo id="S2.E5.m1.21.21.21.21.21.21.3.4b" xref="S2.E5.m1.21.21.21.21.21.21.3.4.cmml">⁢</mo><mrow id="S2.E5.m1.21.21.21.21.21.21.3.3.1" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.cmml"><mo id="S2.E5.m1.21.21.21.21.21.21.3.3.1.2" stretchy="false" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.cmml">(</mo><mrow id="S2.E5.m1.21.21.21.21.21.21.3.3.1.1" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.cmml"><mi id="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.2" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.2.cmml">s</mi><mo id="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.1" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.1.cmml">⁢</mo><mrow id="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.3.2" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.3.1.cmml"><mo id="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.3.2.1" stretchy="false" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.3.1.cmml">(</mo><mi id="S2.E5.m1.21.21.21.21.21.21.1.1" xref="S2.E5.m1.21.21.21.21.21.21.1.1.cmml">u</mi><mo id="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.3.2.2" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.3.1.cmml">,</mo><mi id="S2.E5.m1.21.21.21.21.21.21.2.2" xref="S2.E5.m1.21.21.21.21.21.21.2.2.cmml">j</mi><mo id="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.3.2.3" stretchy="false" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.21.21.21.21.21.21.3.3.1.3" stretchy="false" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.cmml">)</mo></mrow></mrow><msub id="S2.E5.m1.21.21.21.21.21.21.5" xref="S2.E5.m1.21.21.21.21.21.21.5.cmml"><mi id="S2.E5.m1.21.21.21.21.21.21.5.2" xref="S2.E5.m1.21.21.21.21.21.21.5.2.cmml">τ</mi><mn id="S2.E5.m1.21.21.21.21.21.21.5.3" xref="S2.E5.m1.21.21.21.21.21.21.5.3.cmml">2</mn></msub></mfrac></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E5.m1.21b"><apply id="S2.E5.m1.21.22.1.cmml" xref="S2.E5.m1.21.21"><eq id="S2.E5.m1.3.3.3.3.3.3.cmml" xref="S2.E5.m1.3.3.3.3.3.3"></eq><apply id="S2.E5.m1.21.22.1.2.cmml" xref="S2.E5.m1.21.21"><csymbol cd="ambiguous" id="S2.E5.m1.21.22.1.2.1.cmml" xref="S2.E5.m1.21.21">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1">𝐿</ci><apply id="S2.E5.m1.2.2.2.2.2.2.1.cmml" xref="S2.E5.m1.2.2.2.2.2.2.1"><times id="S2.E5.m1.2.2.2.2.2.2.1.1.cmml" xref="S2.E5.m1.2.2.2.2.2.2.1.1"></times><ci id="S2.E5.m1.2.2.2.2.2.2.1.2.cmml" xref="S2.E5.m1.2.2.2.2.2.2.1.2">𝐵</ci><ci id="S2.E5.m1.2.2.2.2.2.2.1.3.cmml" xref="S2.E5.m1.2.2.2.2.2.2.1.3">𝑆</ci><ci id="S2.E5.m1.2.2.2.2.2.2.1.4.cmml" xref="S2.E5.m1.2.2.2.2.2.2.1.4">𝐿</ci></apply></apply><apply id="S2.E5.m1.21.22.1.3.cmml" xref="S2.E5.m1.21.21"><plus id="S2.E5.m1.13.13.13.13.13.13.cmml" xref="S2.E5.m1.13.13.13.13.13.13"></plus><apply id="S2.E5.m1.21.22.1.3.2.cmml" xref="S2.E5.m1.21.21"><minus id="S2.E5.m1.4.4.4.4.4.4.cmml" xref="S2.E5.m1.21.21"></minus><apply id="S2.E5.m1.21.22.1.3.2.2.cmml" xref="S2.E5.m1.21.21"><times id="S2.E5.m1.21.22.1.3.2.2.1.cmml" xref="S2.E5.m1.21.21"></times><apply id="S2.E5.m1.21.22.1.3.2.2.2.cmml" xref="S2.E5.m1.21.21"><csymbol cd="ambiguous" id="S2.E5.m1.21.22.1.3.2.2.2.1.cmml" xref="S2.E5.m1.21.21">subscript</csymbol><ci id="S2.E5.m1.5.5.5.5.5.5.cmml" xref="S2.E5.m1.5.5.5.5.5.5">𝜏</ci><cn id="S2.E5.m1.6.6.6.6.6.6.1.cmml" type="integer" xref="S2.E5.m1.6.6.6.6.6.6.1">1</cn></apply><ci id="S2.E5.m1.7.7.7.7.7.7.cmml" xref="S2.E5.m1.7.7.7.7.7.7">𝑙</ci><ci id="S2.E5.m1.8.8.8.8.8.8.cmml" xref="S2.E5.m1.8.8.8.8.8.8">𝑜</ci><ci id="S2.E5.m1.9.9.9.9.9.9.cmml" xref="S2.E5.m1.9.9.9.9.9.9">𝑔</ci><apply id="S2.E5.m1.21.22.1.3.2.2.6.cmml" xref="S2.E5.m1.21.21"><csymbol cd="ambiguous" id="S2.E5.m1.21.22.1.3.2.2.6.1.cmml" xref="S2.E5.m1.21.21">subscript</csymbol><ci id="S2.E5.m1.10.10.10.10.10.10.cmml" xref="S2.E5.m1.10.10.10.10.10.10">𝔼</ci><apply id="S2.E5.m1.11.11.11.11.11.11.1.cmml" xref="S2.E5.m1.11.11.11.11.11.11.1"><csymbol cd="latexml" id="S2.E5.m1.11.11.11.11.11.11.1.1.cmml" xref="S2.E5.m1.11.11.11.11.11.11.1.1">similar-to</csymbol><ci id="S2.E5.m1.11.11.11.11.11.11.1.2.cmml" xref="S2.E5.m1.11.11.11.11.11.11.1.2">𝑖</ci><apply id="S2.E5.m1.11.11.11.11.11.11.1.3.cmml" xref="S2.E5.m1.11.11.11.11.11.11.1.3"><csymbol cd="latexml" id="S2.E5.m1.11.11.11.11.11.11.1.3.1.cmml" xref="S2.E5.m1.11.11.11.11.11.11.1.3">limit-from</csymbol><ci id="S2.E5.m1.11.11.11.11.11.11.1.3.2.cmml" xref="S2.E5.m1.11.11.11.11.11.11.1.3.2">𝑃</ci><plus id="S2.E5.m1.11.11.11.11.11.11.1.3.3.cmml" xref="S2.E5.m1.11.11.11.11.11.11.1.3.3"></plus></apply></apply></apply><apply id="S2.E5.m1.12.12.12.12.12.12.cmml" xref="S2.E5.m1.12.12.12.12.12.12"><divide id="S2.E5.m1.12.12.12.12.12.12.4.cmml" xref="S2.E5.m1.12.12.12.12.12.12"></divide><apply id="S2.E5.m1.12.12.12.12.12.12.3.cmml" xref="S2.E5.m1.12.12.12.12.12.12.3"><times id="S2.E5.m1.12.12.12.12.12.12.3.4.cmml" xref="S2.E5.m1.12.12.12.12.12.12.3.4"></times><ci id="S2.E5.m1.12.12.12.12.12.12.3.5.cmml" xref="S2.E5.m1.12.12.12.12.12.12.3.5">𝑒</ci><ci id="S2.E5.m1.12.12.12.12.12.12.3.6.cmml" xref="S2.E5.m1.12.12.12.12.12.12.3.6">𝑥</ci><ci id="S2.E5.m1.12.12.12.12.12.12.3.7.cmml" xref="S2.E5.m1.12.12.12.12.12.12.3.7">𝑝</ci><apply id="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.cmml" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1"><times id="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.1.cmml" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.1"></times><ci id="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.2.cmml" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.2">𝑠</ci><interval closure="open" id="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.3.1.cmml" xref="S2.E5.m1.12.12.12.12.12.12.3.3.1.1.3.2"><ci id="S2.E5.m1.12.12.12.12.12.12.1.1.cmml" xref="S2.E5.m1.12.12.12.12.12.12.1.1">𝑢</ci><ci id="S2.E5.m1.12.12.12.12.12.12.2.2.cmml" xref="S2.E5.m1.12.12.12.12.12.12.2.2">𝑖</ci></interval></apply></apply><apply id="S2.E5.m1.12.12.12.12.12.12.5.cmml" xref="S2.E5.m1.12.12.12.12.12.12.5"><csymbol cd="ambiguous" id="S2.E5.m1.12.12.12.12.12.12.5.1.cmml" xref="S2.E5.m1.12.12.12.12.12.12.5">subscript</csymbol><ci id="S2.E5.m1.12.12.12.12.12.12.5.2.cmml" xref="S2.E5.m1.12.12.12.12.12.12.5.2">𝜏</ci><cn id="S2.E5.m1.12.12.12.12.12.12.5.3.cmml" type="integer" xref="S2.E5.m1.12.12.12.12.12.12.5.3">1</cn></apply></apply></apply></apply><apply id="S2.E5.m1.21.22.1.3.3.cmml" xref="S2.E5.m1.21.21"><times id="S2.E5.m1.21.22.1.3.3.1.cmml" xref="S2.E5.m1.21.21"></times><apply id="S2.E5.m1.21.22.1.3.3.2.cmml" xref="S2.E5.m1.21.21"><csymbol cd="ambiguous" id="S2.E5.m1.21.22.1.3.3.2.1.cmml" xref="S2.E5.m1.21.21">subscript</csymbol><ci id="S2.E5.m1.14.14.14.14.14.14.cmml" xref="S2.E5.m1.14.14.14.14.14.14">𝜏</ci><cn id="S2.E5.m1.15.15.15.15.15.15.1.cmml" type="integer" xref="S2.E5.m1.15.15.15.15.15.15.1">2</cn></apply><ci id="S2.E5.m1.16.16.16.16.16.16.cmml" xref="S2.E5.m1.16.16.16.16.16.16">𝑙</ci><ci id="S2.E5.m1.17.17.17.17.17.17.cmml" xref="S2.E5.m1.17.17.17.17.17.17">𝑜</ci><ci id="S2.E5.m1.18.18.18.18.18.18.cmml" xref="S2.E5.m1.18.18.18.18.18.18">𝑔</ci><apply id="S2.E5.m1.21.22.1.3.3.6.cmml" xref="S2.E5.m1.21.21"><csymbol cd="ambiguous" id="S2.E5.m1.21.22.1.3.3.6.1.cmml" xref="S2.E5.m1.21.21">subscript</csymbol><ci id="S2.E5.m1.19.19.19.19.19.19.cmml" xref="S2.E5.m1.19.19.19.19.19.19">𝔼</ci><apply id="S2.E5.m1.20.20.20.20.20.20.1.cmml" xref="S2.E5.m1.20.20.20.20.20.20.1"><csymbol cd="latexml" id="S2.E5.m1.20.20.20.20.20.20.1.1.cmml" xref="S2.E5.m1.20.20.20.20.20.20.1.1">similar-to</csymbol><ci id="S2.E5.m1.20.20.20.20.20.20.1.2.cmml" xref="S2.E5.m1.20.20.20.20.20.20.1.2">𝑗</ci><apply id="S2.E5.m1.20.20.20.20.20.20.1.3.cmml" xref="S2.E5.m1.20.20.20.20.20.20.1.3"><csymbol cd="latexml" id="S2.E5.m1.20.20.20.20.20.20.1.3.1.cmml" xref="S2.E5.m1.20.20.20.20.20.20.1.3">limit-from</csymbol><ci id="S2.E5.m1.20.20.20.20.20.20.1.3.2.cmml" xref="S2.E5.m1.20.20.20.20.20.20.1.3.2">𝑃</ci><minus id="S2.E5.m1.20.20.20.20.20.20.1.3.3.cmml" xref="S2.E5.m1.20.20.20.20.20.20.1.3.3"></minus></apply></apply></apply><apply id="S2.E5.m1.21.21.21.21.21.21.cmml" xref="S2.E5.m1.21.21.21.21.21.21"><divide id="S2.E5.m1.21.21.21.21.21.21.4.cmml" xref="S2.E5.m1.21.21.21.21.21.21"></divide><apply id="S2.E5.m1.21.21.21.21.21.21.3.cmml" xref="S2.E5.m1.21.21.21.21.21.21.3"><times id="S2.E5.m1.21.21.21.21.21.21.3.4.cmml" xref="S2.E5.m1.21.21.21.21.21.21.3.4"></times><ci id="S2.E5.m1.21.21.21.21.21.21.3.5.cmml" xref="S2.E5.m1.21.21.21.21.21.21.3.5">𝑒</ci><ci id="S2.E5.m1.21.21.21.21.21.21.3.6.cmml" xref="S2.E5.m1.21.21.21.21.21.21.3.6">𝑥</ci><ci id="S2.E5.m1.21.21.21.21.21.21.3.7.cmml" xref="S2.E5.m1.21.21.21.21.21.21.3.7">𝑝</ci><apply id="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.cmml" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1"><times id="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.1.cmml" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.1"></times><ci id="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.2.cmml" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.2">𝑠</ci><interval closure="open" id="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.3.1.cmml" xref="S2.E5.m1.21.21.21.21.21.21.3.3.1.1.3.2"><ci id="S2.E5.m1.21.21.21.21.21.21.1.1.cmml" xref="S2.E5.m1.21.21.21.21.21.21.1.1">𝑢</ci><ci id="S2.E5.m1.21.21.21.21.21.21.2.2.cmml" xref="S2.E5.m1.21.21.21.21.21.21.2.2">𝑗</ci></interval></apply></apply><apply id="S2.E5.m1.21.21.21.21.21.21.5.cmml" xref="S2.E5.m1.21.21.21.21.21.21.5"><csymbol cd="ambiguous" id="S2.E5.m1.21.21.21.21.21.21.5.1.cmml" xref="S2.E5.m1.21.21.21.21.21.21.5">subscript</csymbol><ci id="S2.E5.m1.21.21.21.21.21.21.5.2.cmml" xref="S2.E5.m1.21.21.21.21.21.21.5.2">𝜏</ci><cn id="S2.E5.m1.21.21.21.21.21.21.5.3.cmml" type="integer" xref="S2.E5.m1.21.21.21.21.21.21.5.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.21c">\begin{split}L_{BSL}=-\tau_{1}log\mathbb{E}_{i\sim P+}\dfrac{exp(s(u,i))}{\tau%
_{1}}{\ +}\tau_{2}log\mathbb{E}_{j\sim P-}\dfrac{exp(s(u,j))}{\tau_{2}}\end{split}</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.21d">start_ROW start_CELL italic_L start_POSTSUBSCRIPT italic_B italic_S italic_L end_POSTSUBSCRIPT = - italic_τ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_l italic_o italic_g blackboard_E start_POSTSUBSCRIPT italic_i ∼ italic_P + end_POSTSUBSCRIPT divide start_ARG italic_e italic_x italic_p ( italic_s ( italic_u , italic_i ) ) end_ARG start_ARG italic_τ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG + italic_τ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_l italic_o italic_g blackboard_E start_POSTSUBSCRIPT italic_j ∼ italic_P - end_POSTSUBSCRIPT divide start_ARG italic_e italic_x italic_p ( italic_s ( italic_u , italic_j ) ) end_ARG start_ARG italic_τ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p4.13">In the equation, <math alttext="P" class="ltx_Math" display="inline" id="S2.SS3.p4.11.m1.1"><semantics id="S2.SS3.p4.11.m1.1a"><mi id="S2.SS3.p4.11.m1.1.1" xref="S2.SS3.p4.11.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.11.m1.1b"><ci id="S2.SS3.p4.11.m1.1.1.cmml" xref="S2.SS3.p4.11.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.11.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.11.m1.1d">italic_P</annotation></semantics></math> is the distribution of instances, <math alttext="\mathbb{E}" class="ltx_Math" display="inline" id="S2.SS3.p4.12.m2.1"><semantics id="S2.SS3.p4.12.m2.1a"><mi id="S2.SS3.p4.12.m2.1.1" xref="S2.SS3.p4.12.m2.1.1.cmml">𝔼</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.12.m2.1b"><ci id="S2.SS3.p4.12.m2.1.1.cmml" xref="S2.SS3.p4.12.m2.1.1">𝔼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.12.m2.1c">\mathbb{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.12.m2.1d">blackboard_E</annotation></semantics></math> is the expectation, and <math alttext="\tau" class="ltx_Math" display="inline" id="S2.SS3.p4.13.m3.1"><semantics id="S2.SS3.p4.13.m3.1a"><mi id="S2.SS3.p4.13.m3.1.1" xref="S2.SS3.p4.13.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.13.m3.1b"><ci id="S2.SS3.p4.13.m3.1.1.cmml" xref="S2.SS3.p4.13.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.13.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.13.m3.1d">italic_τ</annotation></semantics></math> are the temperatures of components.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Proposed Loss Function</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, discuss the generalization of contrastive loss functions, explain the rationale behind the proposed Multi-Margin Cosine Loss (MMCL) function and provide its details.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Generalized Contrastive Loss</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.12">From the loss functions summarized in the related work section, we can generalize the contrastive loss as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}L_{\begin{subarray}{c}Gen\\
Contr\end{subarray}}=\sum_{i\in I+,N\subset I-}w_{p}f(u,i){\ +}\dfrac{w_{n}}{N%
}\sum_{j\in N}max(0,f(u,i,j,m))\end{split}" class="ltx_Math" display="block" id="S3.E6.m1.36"><semantics id="S3.E6.m1.36a"><mtable displaystyle="true" id="S3.E6.m1.36.36.2" xref="S3.E6.m1.35.35.1.cmml"><mtr id="S3.E6.m1.36.36.2a" xref="S3.E6.m1.35.35.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.36.36.2b" xref="S3.E6.m1.35.35.1.cmml"><mrow id="S3.E6.m1.36.36.2.35.35.35" xref="S3.E6.m1.35.35.1.cmml"><msub id="S3.E6.m1.36.36.2.35.35.35.36" xref="S3.E6.m1.35.35.1.cmml"><mi id="S3.E6.m1.2.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.2.cmml">L</mi><mtable id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1" rowspacing="0pt" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml"><mtr id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1a" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml"><mtd id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1b" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">G</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1a" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">n</mi></mrow></mtd></mtr><mtr id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1c" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml"><mtd id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1d" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml">C</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml">o</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1a" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.4" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.4.cmml">n</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1b" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.5" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.5.cmml">t</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1c" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.6" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.6.cmml">r</mi></mrow></mtd></mtr></mtable></msub><mo id="S3.E6.m1.3.3.3.3.3.3" rspace="0.111em" xref="S3.E6.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E6.m1.36.36.2.35.35.35.35" xref="S3.E6.m1.35.35.1.cmml"><mrow id="S3.E6.m1.36.36.2.35.35.35.35.2" xref="S3.E6.m1.35.35.1.cmml"><munder id="S3.E6.m1.36.36.2.35.35.35.35.2.1" xref="S3.E6.m1.35.35.1.cmml"><mo id="S3.E6.m1.4.4.4.4.4.4" movablelimits="false" xref="S3.E6.m1.4.4.4.4.4.4.cmml">∑</mo><mrow id="S3.E6.m1.5.5.5.5.5.5.1.2" xref="S3.E6.m1.5.5.5.5.5.5.1.3.cmml"><mrow id="S3.E6.m1.5.5.5.5.5.5.1.1.1" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1.cmml"><mi id="S3.E6.m1.5.5.5.5.5.5.1.1.1.2" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1.2.cmml">i</mi><mo id="S3.E6.m1.5.5.5.5.5.5.1.1.1.1" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1.1.cmml">∈</mo><mrow id="S3.E6.m1.5.5.5.5.5.5.1.1.1.3" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1.3.cmml"><mi id="S3.E6.m1.5.5.5.5.5.5.1.1.1.3.2" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1.3.2.cmml">I</mi><mo id="S3.E6.m1.5.5.5.5.5.5.1.1.1.3.3" rspace="0em" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1.3.3.cmml">+</mo></mrow></mrow><mo id="S3.E6.m1.5.5.5.5.5.5.1.2.3" xref="S3.E6.m1.5.5.5.5.5.5.1.3a.cmml">,</mo><mrow id="S3.E6.m1.5.5.5.5.5.5.1.2.2" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2.cmml"><mi id="S3.E6.m1.5.5.5.5.5.5.1.2.2.2" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2.2.cmml">N</mi><mo id="S3.E6.m1.5.5.5.5.5.5.1.2.2.1" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2.1.cmml">⊂</mo><mrow id="S3.E6.m1.5.5.5.5.5.5.1.2.2.3" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2.3.cmml"><mi id="S3.E6.m1.5.5.5.5.5.5.1.2.2.3.2" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2.3.2.cmml">I</mi><mo id="S3.E6.m1.5.5.5.5.5.5.1.2.2.3.3" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2.3.3.cmml">−</mo></mrow></mrow></mrow></munder><mrow id="S3.E6.m1.36.36.2.35.35.35.35.2.2" xref="S3.E6.m1.35.35.1.cmml"><msub id="S3.E6.m1.36.36.2.35.35.35.35.2.2.2" xref="S3.E6.m1.35.35.1.cmml"><mi id="S3.E6.m1.6.6.6.6.6.6" xref="S3.E6.m1.6.6.6.6.6.6.cmml">w</mi><mi id="S3.E6.m1.7.7.7.7.7.7.1" xref="S3.E6.m1.7.7.7.7.7.7.1.cmml">p</mi></msub><mo id="S3.E6.m1.36.36.2.35.35.35.35.2.2.1" xref="S3.E6.m1.35.35.1.cmml">⁢</mo><mi id="S3.E6.m1.8.8.8.8.8.8" xref="S3.E6.m1.8.8.8.8.8.8.cmml">f</mi><mo id="S3.E6.m1.36.36.2.35.35.35.35.2.2.1a" xref="S3.E6.m1.35.35.1.cmml">⁢</mo><mrow id="S3.E6.m1.36.36.2.35.35.35.35.2.2.3" xref="S3.E6.m1.35.35.1.cmml"><mo id="S3.E6.m1.9.9.9.9.9.9" stretchy="false" xref="S3.E6.m1.35.35.1.cmml">(</mo><mi id="S3.E6.m1.10.10.10.10.10.10" xref="S3.E6.m1.10.10.10.10.10.10.cmml">u</mi><mo id="S3.E6.m1.11.11.11.11.11.11" xref="S3.E6.m1.35.35.1.cmml">,</mo><mi id="S3.E6.m1.12.12.12.12.12.12" xref="S3.E6.m1.12.12.12.12.12.12.cmml">i</mi><mo id="S3.E6.m1.13.13.13.13.13.13" rspace="0.500em" stretchy="false" xref="S3.E6.m1.35.35.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.14.14.14.14.14.14" xref="S3.E6.m1.14.14.14.14.14.14.cmml">+</mo><mrow id="S3.E6.m1.36.36.2.35.35.35.35.1" xref="S3.E6.m1.35.35.1.cmml"><mfrac id="S3.E6.m1.15.15.15.15.15.15" xref="S3.E6.m1.15.15.15.15.15.15.cmml"><msub id="S3.E6.m1.15.15.15.15.15.15.2" xref="S3.E6.m1.15.15.15.15.15.15.2.cmml"><mi id="S3.E6.m1.15.15.15.15.15.15.2.2" xref="S3.E6.m1.15.15.15.15.15.15.2.2.cmml">w</mi><mi id="S3.E6.m1.15.15.15.15.15.15.2.3" xref="S3.E6.m1.15.15.15.15.15.15.2.3.cmml">n</mi></msub><mi id="S3.E6.m1.15.15.15.15.15.15.3" xref="S3.E6.m1.15.15.15.15.15.15.3.cmml">N</mi></mfrac><mo id="S3.E6.m1.36.36.2.35.35.35.35.1.2" xref="S3.E6.m1.35.35.1.cmml">⁢</mo><mrow id="S3.E6.m1.36.36.2.35.35.35.35.1.1" xref="S3.E6.m1.35.35.1.cmml"><munder id="S3.E6.m1.36.36.2.35.35.35.35.1.1.2" xref="S3.E6.m1.35.35.1.cmml"><mo id="S3.E6.m1.16.16.16.16.16.16" movablelimits="false" xref="S3.E6.m1.16.16.16.16.16.16.cmml">∑</mo><mrow id="S3.E6.m1.17.17.17.17.17.17.1" xref="S3.E6.m1.17.17.17.17.17.17.1.cmml"><mi id="S3.E6.m1.17.17.17.17.17.17.1.2" xref="S3.E6.m1.17.17.17.17.17.17.1.2.cmml">j</mi><mo id="S3.E6.m1.17.17.17.17.17.17.1.1" xref="S3.E6.m1.17.17.17.17.17.17.1.1.cmml">∈</mo><mi id="S3.E6.m1.17.17.17.17.17.17.1.3" xref="S3.E6.m1.17.17.17.17.17.17.1.3.cmml">N</mi></mrow></munder><mrow id="S3.E6.m1.36.36.2.35.35.35.35.1.1.1" xref="S3.E6.m1.35.35.1.cmml"><mi id="S3.E6.m1.18.18.18.18.18.18" xref="S3.E6.m1.18.18.18.18.18.18.cmml">m</mi><mo id="S3.E6.m1.36.36.2.35.35.35.35.1.1.1.2" xref="S3.E6.m1.35.35.1.cmml">⁢</mo><mi id="S3.E6.m1.19.19.19.19.19.19" xref="S3.E6.m1.19.19.19.19.19.19.cmml">a</mi><mo id="S3.E6.m1.36.36.2.35.35.35.35.1.1.1.2a" xref="S3.E6.m1.35.35.1.cmml">⁢</mo><mi id="S3.E6.m1.20.20.20.20.20.20" xref="S3.E6.m1.20.20.20.20.20.20.cmml">x</mi><mo id="S3.E6.m1.36.36.2.35.35.35.35.1.1.1.2b" xref="S3.E6.m1.35.35.1.cmml">⁢</mo><mrow id="S3.E6.m1.36.36.2.35.35.35.35.1.1.1.1.1" xref="S3.E6.m1.35.35.1.cmml"><mo id="S3.E6.m1.21.21.21.21.21.21" stretchy="false" xref="S3.E6.m1.35.35.1.cmml">(</mo><mn id="S3.E6.m1.22.22.22.22.22.22" xref="S3.E6.m1.22.22.22.22.22.22.cmml">0</mn><mo id="S3.E6.m1.23.23.23.23.23.23" xref="S3.E6.m1.35.35.1.cmml">,</mo><mrow id="S3.E6.m1.36.36.2.35.35.35.35.1.1.1.1.1.1" xref="S3.E6.m1.35.35.1.cmml"><mi id="S3.E6.m1.24.24.24.24.24.24" xref="S3.E6.m1.24.24.24.24.24.24.cmml">f</mi><mo id="S3.E6.m1.36.36.2.35.35.35.35.1.1.1.1.1.1.1" xref="S3.E6.m1.35.35.1.cmml">⁢</mo><mrow id="S3.E6.m1.36.36.2.35.35.35.35.1.1.1.1.1.1.2" xref="S3.E6.m1.35.35.1.cmml"><mo id="S3.E6.m1.25.25.25.25.25.25" stretchy="false" xref="S3.E6.m1.35.35.1.cmml">(</mo><mi id="S3.E6.m1.26.26.26.26.26.26" xref="S3.E6.m1.26.26.26.26.26.26.cmml">u</mi><mo id="S3.E6.m1.27.27.27.27.27.27" xref="S3.E6.m1.35.35.1.cmml">,</mo><mi id="S3.E6.m1.28.28.28.28.28.28" xref="S3.E6.m1.28.28.28.28.28.28.cmml">i</mi><mo id="S3.E6.m1.29.29.29.29.29.29" xref="S3.E6.m1.35.35.1.cmml">,</mo><mi id="S3.E6.m1.30.30.30.30.30.30" xref="S3.E6.m1.30.30.30.30.30.30.cmml">j</mi><mo id="S3.E6.m1.31.31.31.31.31.31" xref="S3.E6.m1.35.35.1.cmml">,</mo><mi id="S3.E6.m1.32.32.32.32.32.32" xref="S3.E6.m1.32.32.32.32.32.32.cmml">m</mi><mo id="S3.E6.m1.33.33.33.33.33.33" stretchy="false" xref="S3.E6.m1.35.35.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.34.34.34.34.34.34" stretchy="false" xref="S3.E6.m1.35.35.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E6.m1.36b"><apply id="S3.E6.m1.35.35.1.cmml" xref="S3.E6.m1.36.36.2"><eq id="S3.E6.m1.3.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3"></eq><apply id="S3.E6.m1.35.35.1.3.cmml" xref="S3.E6.m1.36.36.2"><csymbol cd="ambiguous" id="S3.E6.m1.35.35.1.3.1.cmml" xref="S3.E6.m1.36.36.2">subscript</csymbol><ci id="S3.E6.m1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2">𝐿</ci><list id="S3.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1"><matrix id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1"><matrixrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1a.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐺</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑒</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4">𝑛</ci></apply></matrixrow><matrixrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1b.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.2">𝐶</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.3">𝑜</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.4">𝑛</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.5.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.5">𝑡</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.6.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.6">𝑟</ci></apply></matrixrow></matrix></list></apply><apply id="S3.E6.m1.35.35.1.1.cmml" xref="S3.E6.m1.36.36.2"><plus id="S3.E6.m1.14.14.14.14.14.14.cmml" xref="S3.E6.m1.14.14.14.14.14.14"></plus><apply id="S3.E6.m1.35.35.1.1.3.cmml" xref="S3.E6.m1.36.36.2"><apply id="S3.E6.m1.35.35.1.1.3.1.cmml" xref="S3.E6.m1.36.36.2"><csymbol cd="ambiguous" id="S3.E6.m1.35.35.1.1.3.1.1.cmml" xref="S3.E6.m1.36.36.2">subscript</csymbol><sum id="S3.E6.m1.4.4.4.4.4.4.cmml" xref="S3.E6.m1.4.4.4.4.4.4"></sum><apply id="S3.E6.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.5.5.5.5.1.3a.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.5.5.5.5.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1"><in id="S3.E6.m1.5.5.5.5.5.5.1.1.1.1.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1.1"></in><ci id="S3.E6.m1.5.5.5.5.5.5.1.1.1.2.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1.2">𝑖</ci><apply id="S3.E6.m1.5.5.5.5.5.5.1.1.1.3.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1.3"><csymbol cd="latexml" id="S3.E6.m1.5.5.5.5.5.5.1.1.1.3.1.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1.3">limit-from</csymbol><ci id="S3.E6.m1.5.5.5.5.5.5.1.1.1.3.2.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1.3.2">𝐼</ci><plus id="S3.E6.m1.5.5.5.5.5.5.1.1.1.3.3.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.1.1.3.3"></plus></apply></apply><apply id="S3.E6.m1.5.5.5.5.5.5.1.2.2.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2"><subset id="S3.E6.m1.5.5.5.5.5.5.1.2.2.1.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2.1"></subset><ci id="S3.E6.m1.5.5.5.5.5.5.1.2.2.2.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2.2">𝑁</ci><apply id="S3.E6.m1.5.5.5.5.5.5.1.2.2.3.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2.3"><csymbol cd="latexml" id="S3.E6.m1.5.5.5.5.5.5.1.2.2.3.1.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2.3">limit-from</csymbol><ci id="S3.E6.m1.5.5.5.5.5.5.1.2.2.3.2.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2.3.2">𝐼</ci><minus id="S3.E6.m1.5.5.5.5.5.5.1.2.2.3.3.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.2.2.3.3"></minus></apply></apply></apply></apply><apply id="S3.E6.m1.35.35.1.1.3.2.cmml" xref="S3.E6.m1.36.36.2"><times id="S3.E6.m1.35.35.1.1.3.2.1.cmml" xref="S3.E6.m1.36.36.2"></times><apply id="S3.E6.m1.35.35.1.1.3.2.2.cmml" xref="S3.E6.m1.36.36.2"><csymbol cd="ambiguous" id="S3.E6.m1.35.35.1.1.3.2.2.1.cmml" xref="S3.E6.m1.36.36.2">subscript</csymbol><ci id="S3.E6.m1.6.6.6.6.6.6.cmml" xref="S3.E6.m1.6.6.6.6.6.6">𝑤</ci><ci id="S3.E6.m1.7.7.7.7.7.7.1.cmml" xref="S3.E6.m1.7.7.7.7.7.7.1">𝑝</ci></apply><ci id="S3.E6.m1.8.8.8.8.8.8.cmml" xref="S3.E6.m1.8.8.8.8.8.8">𝑓</ci><interval closure="open" id="S3.E6.m1.35.35.1.1.3.2.4.cmml" xref="S3.E6.m1.36.36.2"><ci id="S3.E6.m1.10.10.10.10.10.10.cmml" xref="S3.E6.m1.10.10.10.10.10.10">𝑢</ci><ci id="S3.E6.m1.12.12.12.12.12.12.cmml" xref="S3.E6.m1.12.12.12.12.12.12">𝑖</ci></interval></apply></apply><apply id="S3.E6.m1.35.35.1.1.1.cmml" xref="S3.E6.m1.36.36.2"><times id="S3.E6.m1.35.35.1.1.1.2.cmml" xref="S3.E6.m1.36.36.2"></times><apply id="S3.E6.m1.15.15.15.15.15.15.cmml" xref="S3.E6.m1.15.15.15.15.15.15"><divide id="S3.E6.m1.15.15.15.15.15.15.1.cmml" xref="S3.E6.m1.15.15.15.15.15.15"></divide><apply id="S3.E6.m1.15.15.15.15.15.15.2.cmml" xref="S3.E6.m1.15.15.15.15.15.15.2"><csymbol cd="ambiguous" id="S3.E6.m1.15.15.15.15.15.15.2.1.cmml" xref="S3.E6.m1.15.15.15.15.15.15.2">subscript</csymbol><ci id="S3.E6.m1.15.15.15.15.15.15.2.2.cmml" xref="S3.E6.m1.15.15.15.15.15.15.2.2">𝑤</ci><ci id="S3.E6.m1.15.15.15.15.15.15.2.3.cmml" xref="S3.E6.m1.15.15.15.15.15.15.2.3">𝑛</ci></apply><ci id="S3.E6.m1.15.15.15.15.15.15.3.cmml" xref="S3.E6.m1.15.15.15.15.15.15.3">𝑁</ci></apply><apply id="S3.E6.m1.35.35.1.1.1.1.cmml" xref="S3.E6.m1.36.36.2"><apply id="S3.E6.m1.35.35.1.1.1.1.2.cmml" xref="S3.E6.m1.36.36.2"><csymbol cd="ambiguous" id="S3.E6.m1.35.35.1.1.1.1.2.1.cmml" xref="S3.E6.m1.36.36.2">subscript</csymbol><sum id="S3.E6.m1.16.16.16.16.16.16.cmml" xref="S3.E6.m1.16.16.16.16.16.16"></sum><apply id="S3.E6.m1.17.17.17.17.17.17.1.cmml" xref="S3.E6.m1.17.17.17.17.17.17.1"><in id="S3.E6.m1.17.17.17.17.17.17.1.1.cmml" xref="S3.E6.m1.17.17.17.17.17.17.1.1"></in><ci id="S3.E6.m1.17.17.17.17.17.17.1.2.cmml" xref="S3.E6.m1.17.17.17.17.17.17.1.2">𝑗</ci><ci id="S3.E6.m1.17.17.17.17.17.17.1.3.cmml" xref="S3.E6.m1.17.17.17.17.17.17.1.3">𝑁</ci></apply></apply><apply id="S3.E6.m1.35.35.1.1.1.1.1.cmml" xref="S3.E6.m1.36.36.2"><times id="S3.E6.m1.35.35.1.1.1.1.1.2.cmml" xref="S3.E6.m1.36.36.2"></times><ci id="S3.E6.m1.18.18.18.18.18.18.cmml" xref="S3.E6.m1.18.18.18.18.18.18">𝑚</ci><ci id="S3.E6.m1.19.19.19.19.19.19.cmml" xref="S3.E6.m1.19.19.19.19.19.19">𝑎</ci><ci id="S3.E6.m1.20.20.20.20.20.20.cmml" xref="S3.E6.m1.20.20.20.20.20.20">𝑥</ci><interval closure="open" id="S3.E6.m1.35.35.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.36.36.2"><cn id="S3.E6.m1.22.22.22.22.22.22.cmml" type="integer" xref="S3.E6.m1.22.22.22.22.22.22">0</cn><apply id="S3.E6.m1.35.35.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.36.36.2"><times id="S3.E6.m1.35.35.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.36.36.2"></times><ci id="S3.E6.m1.24.24.24.24.24.24.cmml" xref="S3.E6.m1.24.24.24.24.24.24">𝑓</ci><vector id="S3.E6.m1.35.35.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.36.36.2"><ci id="S3.E6.m1.26.26.26.26.26.26.cmml" xref="S3.E6.m1.26.26.26.26.26.26">𝑢</ci><ci id="S3.E6.m1.28.28.28.28.28.28.cmml" xref="S3.E6.m1.28.28.28.28.28.28">𝑖</ci><ci id="S3.E6.m1.30.30.30.30.30.30.cmml" xref="S3.E6.m1.30.30.30.30.30.30">𝑗</ci><ci id="S3.E6.m1.32.32.32.32.32.32.cmml" xref="S3.E6.m1.32.32.32.32.32.32">𝑚</ci></vector></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.36c">\begin{split}L_{\begin{subarray}{c}Gen\\
Contr\end{subarray}}=\sum_{i\in I+,N\subset I-}w_{p}f(u,i){\ +}\dfrac{w_{n}}{N%
}\sum_{j\in N}max(0,f(u,i,j,m))\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.36d">start_ROW start_CELL italic_L start_POSTSUBSCRIPT start_ARG start_ROW start_CELL italic_G italic_e italic_n end_CELL end_ROW start_ROW start_CELL italic_C italic_o italic_n italic_t italic_r end_CELL end_ROW end_ARG end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i ∈ italic_I + , italic_N ⊂ italic_I - end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_f ( italic_u , italic_i ) + divide start_ARG italic_w start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_j ∈ italic_N end_POSTSUBSCRIPT italic_m italic_a italic_x ( 0 , italic_f ( italic_u , italic_i , italic_j , italic_m ) ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.11">In the equation:
(i) We used a set-wise loss, computing the loss over a positive instance and a set of N negative samples. Using only one negative sample reduces it to pair-wise loss.
(ii) We assigned distinct weights to positive and negative instances, <math alttext="w_{p}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">w</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑤</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">w_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_w start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="w_{n}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">w</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑤</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">w_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_w start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math>. Previously, in Contrastive Loss or CCL, <math alttext="w_{p}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">w</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑤</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">w_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_w start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> is set to 1.0, and in Triplet Loss to 0.0.
(iii) We employed a generic function <math alttext="f(u,i,j,m)" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.4"><semantics id="S3.SS1.p1.4.m4.4a"><mrow id="S3.SS1.p1.4.m4.4.5" xref="S3.SS1.p1.4.m4.4.5.cmml"><mi id="S3.SS1.p1.4.m4.4.5.2" xref="S3.SS1.p1.4.m4.4.5.2.cmml">f</mi><mo id="S3.SS1.p1.4.m4.4.5.1" xref="S3.SS1.p1.4.m4.4.5.1.cmml">⁢</mo><mrow id="S3.SS1.p1.4.m4.4.5.3.2" xref="S3.SS1.p1.4.m4.4.5.3.1.cmml"><mo id="S3.SS1.p1.4.m4.4.5.3.2.1" stretchy="false" xref="S3.SS1.p1.4.m4.4.5.3.1.cmml">(</mo><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">u</mi><mo id="S3.SS1.p1.4.m4.4.5.3.2.2" xref="S3.SS1.p1.4.m4.4.5.3.1.cmml">,</mo><mi id="S3.SS1.p1.4.m4.2.2" xref="S3.SS1.p1.4.m4.2.2.cmml">i</mi><mo id="S3.SS1.p1.4.m4.4.5.3.2.3" xref="S3.SS1.p1.4.m4.4.5.3.1.cmml">,</mo><mi id="S3.SS1.p1.4.m4.3.3" xref="S3.SS1.p1.4.m4.3.3.cmml">j</mi><mo id="S3.SS1.p1.4.m4.4.5.3.2.4" xref="S3.SS1.p1.4.m4.4.5.3.1.cmml">,</mo><mi id="S3.SS1.p1.4.m4.4.4" xref="S3.SS1.p1.4.m4.4.4.cmml">m</mi><mo id="S3.SS1.p1.4.m4.4.5.3.2.5" stretchy="false" xref="S3.SS1.p1.4.m4.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.4b"><apply id="S3.SS1.p1.4.m4.4.5.cmml" xref="S3.SS1.p1.4.m4.4.5"><times id="S3.SS1.p1.4.m4.4.5.1.cmml" xref="S3.SS1.p1.4.m4.4.5.1"></times><ci id="S3.SS1.p1.4.m4.4.5.2.cmml" xref="S3.SS1.p1.4.m4.4.5.2">𝑓</ci><vector id="S3.SS1.p1.4.m4.4.5.3.1.cmml" xref="S3.SS1.p1.4.m4.4.5.3.2"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑢</ci><ci id="S3.SS1.p1.4.m4.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2">𝑖</ci><ci id="S3.SS1.p1.4.m4.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3">𝑗</ci><ci id="S3.SS1.p1.4.m4.4.4.cmml" xref="S3.SS1.p1.4.m4.4.4">𝑚</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.4c">f(u,i,j,m)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.4d">italic_f ( italic_u , italic_i , italic_j , italic_m )</annotation></semantics></math> to represent various combinations of margin <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_m</annotation></semantics></math>, positive and negative instances, <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_j</annotation></semantics></math>, respectively.
The function can vary: InfoNCE does not use a margin; <math alttext="s(u,j)" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.2"><semantics id="S3.SS1.p1.8.m8.2a"><mrow id="S3.SS1.p1.8.m8.2.3" xref="S3.SS1.p1.8.m8.2.3.cmml"><mi id="S3.SS1.p1.8.m8.2.3.2" xref="S3.SS1.p1.8.m8.2.3.2.cmml">s</mi><mo id="S3.SS1.p1.8.m8.2.3.1" xref="S3.SS1.p1.8.m8.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.8.m8.2.3.3.2" xref="S3.SS1.p1.8.m8.2.3.3.1.cmml"><mo id="S3.SS1.p1.8.m8.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.8.m8.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">u</mi><mo id="S3.SS1.p1.8.m8.2.3.3.2.2" xref="S3.SS1.p1.8.m8.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.8.m8.2.2" xref="S3.SS1.p1.8.m8.2.2.cmml">j</mi><mo id="S3.SS1.p1.8.m8.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.8.m8.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.2b"><apply id="S3.SS1.p1.8.m8.2.3.cmml" xref="S3.SS1.p1.8.m8.2.3"><times id="S3.SS1.p1.8.m8.2.3.1.cmml" xref="S3.SS1.p1.8.m8.2.3.1"></times><ci id="S3.SS1.p1.8.m8.2.3.2.cmml" xref="S3.SS1.p1.8.m8.2.3.2">𝑠</ci><interval closure="open" id="S3.SS1.p1.8.m8.2.3.3.1.cmml" xref="S3.SS1.p1.8.m8.2.3.3.2"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑢</ci><ci id="S3.SS1.p1.8.m8.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.2c">s(u,j)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.2d">italic_s ( italic_u , italic_j )</annotation></semantics></math>.
CCL uses similarity between the user and the negative instance and margin; <math alttext="s(u,j)-m" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.2"><semantics id="S3.SS1.p1.9.m9.2a"><mrow id="S3.SS1.p1.9.m9.2.3" xref="S3.SS1.p1.9.m9.2.3.cmml"><mrow id="S3.SS1.p1.9.m9.2.3.2" xref="S3.SS1.p1.9.m9.2.3.2.cmml"><mi id="S3.SS1.p1.9.m9.2.3.2.2" xref="S3.SS1.p1.9.m9.2.3.2.2.cmml">s</mi><mo id="S3.SS1.p1.9.m9.2.3.2.1" xref="S3.SS1.p1.9.m9.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.9.m9.2.3.2.3.2" xref="S3.SS1.p1.9.m9.2.3.2.3.1.cmml"><mo id="S3.SS1.p1.9.m9.2.3.2.3.2.1" stretchy="false" xref="S3.SS1.p1.9.m9.2.3.2.3.1.cmml">(</mo><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">u</mi><mo id="S3.SS1.p1.9.m9.2.3.2.3.2.2" xref="S3.SS1.p1.9.m9.2.3.2.3.1.cmml">,</mo><mi id="S3.SS1.p1.9.m9.2.2" xref="S3.SS1.p1.9.m9.2.2.cmml">j</mi><mo id="S3.SS1.p1.9.m9.2.3.2.3.2.3" stretchy="false" xref="S3.SS1.p1.9.m9.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.9.m9.2.3.1" xref="S3.SS1.p1.9.m9.2.3.1.cmml">−</mo><mi id="S3.SS1.p1.9.m9.2.3.3" xref="S3.SS1.p1.9.m9.2.3.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.2b"><apply id="S3.SS1.p1.9.m9.2.3.cmml" xref="S3.SS1.p1.9.m9.2.3"><minus id="S3.SS1.p1.9.m9.2.3.1.cmml" xref="S3.SS1.p1.9.m9.2.3.1"></minus><apply id="S3.SS1.p1.9.m9.2.3.2.cmml" xref="S3.SS1.p1.9.m9.2.3.2"><times id="S3.SS1.p1.9.m9.2.3.2.1.cmml" xref="S3.SS1.p1.9.m9.2.3.2.1"></times><ci id="S3.SS1.p1.9.m9.2.3.2.2.cmml" xref="S3.SS1.p1.9.m9.2.3.2.2">𝑠</ci><interval closure="open" id="S3.SS1.p1.9.m9.2.3.2.3.1.cmml" xref="S3.SS1.p1.9.m9.2.3.2.3.2"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑢</ci><ci id="S3.SS1.p1.9.m9.2.2.cmml" xref="S3.SS1.p1.9.m9.2.2">𝑗</ci></interval></apply><ci id="S3.SS1.p1.9.m9.2.3.3.cmml" xref="S3.SS1.p1.9.m9.2.3.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.2c">s(u,j)-m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.2d">italic_s ( italic_u , italic_j ) - italic_m</annotation></semantics></math>.
Contrastive Loss uses a distance function and margin; <math alttext="m-d(u,j)" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.2"><semantics id="S3.SS1.p1.10.m10.2a"><mrow id="S3.SS1.p1.10.m10.2.3" xref="S3.SS1.p1.10.m10.2.3.cmml"><mi id="S3.SS1.p1.10.m10.2.3.2" xref="S3.SS1.p1.10.m10.2.3.2.cmml">m</mi><mo id="S3.SS1.p1.10.m10.2.3.1" xref="S3.SS1.p1.10.m10.2.3.1.cmml">−</mo><mrow id="S3.SS1.p1.10.m10.2.3.3" xref="S3.SS1.p1.10.m10.2.3.3.cmml"><mi id="S3.SS1.p1.10.m10.2.3.3.2" xref="S3.SS1.p1.10.m10.2.3.3.2.cmml">d</mi><mo id="S3.SS1.p1.10.m10.2.3.3.1" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.10.m10.2.3.3.3.2" xref="S3.SS1.p1.10.m10.2.3.3.3.1.cmml"><mo id="S3.SS1.p1.10.m10.2.3.3.3.2.1" stretchy="false" xref="S3.SS1.p1.10.m10.2.3.3.3.1.cmml">(</mo><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">u</mi><mo id="S3.SS1.p1.10.m10.2.3.3.3.2.2" xref="S3.SS1.p1.10.m10.2.3.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.10.m10.2.2" xref="S3.SS1.p1.10.m10.2.2.cmml">j</mi><mo id="S3.SS1.p1.10.m10.2.3.3.3.2.3" stretchy="false" xref="S3.SS1.p1.10.m10.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.2b"><apply id="S3.SS1.p1.10.m10.2.3.cmml" xref="S3.SS1.p1.10.m10.2.3"><minus id="S3.SS1.p1.10.m10.2.3.1.cmml" xref="S3.SS1.p1.10.m10.2.3.1"></minus><ci id="S3.SS1.p1.10.m10.2.3.2.cmml" xref="S3.SS1.p1.10.m10.2.3.2">𝑚</ci><apply id="S3.SS1.p1.10.m10.2.3.3.cmml" xref="S3.SS1.p1.10.m10.2.3.3"><times id="S3.SS1.p1.10.m10.2.3.3.1.cmml" xref="S3.SS1.p1.10.m10.2.3.3.1"></times><ci id="S3.SS1.p1.10.m10.2.3.3.2.cmml" xref="S3.SS1.p1.10.m10.2.3.3.2">𝑑</ci><interval closure="open" id="S3.SS1.p1.10.m10.2.3.3.3.1.cmml" xref="S3.SS1.p1.10.m10.2.3.3.3.2"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑢</ci><ci id="S3.SS1.p1.10.m10.2.2.cmml" xref="S3.SS1.p1.10.m10.2.2">𝑗</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.2c">m-d(u,j)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.2d">italic_m - italic_d ( italic_u , italic_j )</annotation></semantics></math>. Triplet Loss uses positive and negative items and margin; <math alttext="d(u,i)-d(u,j)+m" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.4"><semantics id="S3.SS1.p1.11.m11.4a"><mrow id="S3.SS1.p1.11.m11.4.5" xref="S3.SS1.p1.11.m11.4.5.cmml"><mrow id="S3.SS1.p1.11.m11.4.5.2" xref="S3.SS1.p1.11.m11.4.5.2.cmml"><mrow id="S3.SS1.p1.11.m11.4.5.2.2" xref="S3.SS1.p1.11.m11.4.5.2.2.cmml"><mi id="S3.SS1.p1.11.m11.4.5.2.2.2" xref="S3.SS1.p1.11.m11.4.5.2.2.2.cmml">d</mi><mo id="S3.SS1.p1.11.m11.4.5.2.2.1" xref="S3.SS1.p1.11.m11.4.5.2.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.11.m11.4.5.2.2.3.2" xref="S3.SS1.p1.11.m11.4.5.2.2.3.1.cmml"><mo id="S3.SS1.p1.11.m11.4.5.2.2.3.2.1" stretchy="false" xref="S3.SS1.p1.11.m11.4.5.2.2.3.1.cmml">(</mo><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">u</mi><mo id="S3.SS1.p1.11.m11.4.5.2.2.3.2.2" xref="S3.SS1.p1.11.m11.4.5.2.2.3.1.cmml">,</mo><mi id="S3.SS1.p1.11.m11.2.2" xref="S3.SS1.p1.11.m11.2.2.cmml">i</mi><mo id="S3.SS1.p1.11.m11.4.5.2.2.3.2.3" stretchy="false" xref="S3.SS1.p1.11.m11.4.5.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.11.m11.4.5.2.1" xref="S3.SS1.p1.11.m11.4.5.2.1.cmml">−</mo><mrow id="S3.SS1.p1.11.m11.4.5.2.3" xref="S3.SS1.p1.11.m11.4.5.2.3.cmml"><mi id="S3.SS1.p1.11.m11.4.5.2.3.2" xref="S3.SS1.p1.11.m11.4.5.2.3.2.cmml">d</mi><mo id="S3.SS1.p1.11.m11.4.5.2.3.1" xref="S3.SS1.p1.11.m11.4.5.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.11.m11.4.5.2.3.3.2" xref="S3.SS1.p1.11.m11.4.5.2.3.3.1.cmml"><mo id="S3.SS1.p1.11.m11.4.5.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.11.m11.4.5.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p1.11.m11.3.3" xref="S3.SS1.p1.11.m11.3.3.cmml">u</mi><mo id="S3.SS1.p1.11.m11.4.5.2.3.3.2.2" xref="S3.SS1.p1.11.m11.4.5.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.11.m11.4.4" xref="S3.SS1.p1.11.m11.4.4.cmml">j</mi><mo id="S3.SS1.p1.11.m11.4.5.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.11.m11.4.5.2.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS1.p1.11.m11.4.5.1" xref="S3.SS1.p1.11.m11.4.5.1.cmml">+</mo><mi id="S3.SS1.p1.11.m11.4.5.3" xref="S3.SS1.p1.11.m11.4.5.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.4b"><apply id="S3.SS1.p1.11.m11.4.5.cmml" xref="S3.SS1.p1.11.m11.4.5"><plus id="S3.SS1.p1.11.m11.4.5.1.cmml" xref="S3.SS1.p1.11.m11.4.5.1"></plus><apply id="S3.SS1.p1.11.m11.4.5.2.cmml" xref="S3.SS1.p1.11.m11.4.5.2"><minus id="S3.SS1.p1.11.m11.4.5.2.1.cmml" xref="S3.SS1.p1.11.m11.4.5.2.1"></minus><apply id="S3.SS1.p1.11.m11.4.5.2.2.cmml" xref="S3.SS1.p1.11.m11.4.5.2.2"><times id="S3.SS1.p1.11.m11.4.5.2.2.1.cmml" xref="S3.SS1.p1.11.m11.4.5.2.2.1"></times><ci id="S3.SS1.p1.11.m11.4.5.2.2.2.cmml" xref="S3.SS1.p1.11.m11.4.5.2.2.2">𝑑</ci><interval closure="open" id="S3.SS1.p1.11.m11.4.5.2.2.3.1.cmml" xref="S3.SS1.p1.11.m11.4.5.2.2.3.2"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝑢</ci><ci id="S3.SS1.p1.11.m11.2.2.cmml" xref="S3.SS1.p1.11.m11.2.2">𝑖</ci></interval></apply><apply id="S3.SS1.p1.11.m11.4.5.2.3.cmml" xref="S3.SS1.p1.11.m11.4.5.2.3"><times id="S3.SS1.p1.11.m11.4.5.2.3.1.cmml" xref="S3.SS1.p1.11.m11.4.5.2.3.1"></times><ci id="S3.SS1.p1.11.m11.4.5.2.3.2.cmml" xref="S3.SS1.p1.11.m11.4.5.2.3.2">𝑑</ci><interval closure="open" id="S3.SS1.p1.11.m11.4.5.2.3.3.1.cmml" xref="S3.SS1.p1.11.m11.4.5.2.3.3.2"><ci id="S3.SS1.p1.11.m11.3.3.cmml" xref="S3.SS1.p1.11.m11.3.3">𝑢</ci><ci id="S3.SS1.p1.11.m11.4.4.cmml" xref="S3.SS1.p1.11.m11.4.4">𝑗</ci></interval></apply></apply><ci id="S3.SS1.p1.11.m11.4.5.3.cmml" xref="S3.SS1.p1.11.m11.4.5.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.4c">d(u,i)-d(u,j)+m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.4d">italic_d ( italic_u , italic_i ) - italic_d ( italic_u , italic_j ) + italic_m</annotation></semantics></math>, where margin is relative to the positive item.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Motivation for Multi-Margin Cosine Loss</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Effective contrastive learning relies on three key components <cite class="ltx_cite ltx_citemacro_citep">(Weng, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib30" title="">2021</a>)</cite>:
<span class="ltx_text ltx_font_italic" id="S3.SS2.p1.1.1">(i) Heavy Data Augmentation</span> techniques generate noisy versions of positive instances to enhance feature generalization;
<span class="ltx_text ltx_font_italic" id="S3.SS2.p1.1.2">(ii) Large Batch Size</span> provides a diverse and challenging set of negative samples, although it can be memory-intensive;
<span class="ltx_text ltx_font_italic" id="S3.SS2.p1.1.3">(iii) Hard-Negative Mining</span> identifies negative samples similar to the anchor (user) but which are negative, i.e., user did not like that item.
A solution for incorporating hard negatives is to use large batch sizes or more negative samples. However, this approach suffers from higher memory usage as a side effect.
A more efficient solution is to use a margin <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_m</annotation></semantics></math> in computations to distinguish hard negatives efficiently.
In contrastive learning, it is important to effectively utilize negative samples while prioritizing the more challenging ones.
Instead of relying on larger batch sizes for introducing more hard negatives, we propose using not only the most challenging but all non-trivial instances,
and assigning weights based on their ”hardness”.
This approach allows effective learning with fewer samples or smaller batch sizes, from a diverse set of negative instances.
</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Training an RS model with contrastive learning helps distinguish similar and dissimilar pairs and learn representations that capture meaningful relationships between users and items.
This improves RS performance by generalizing effectively with limited interaction data, understanding a wider range of item similarities and dissimilarities, and ensuring that the negative pairs are diverse and unbiased.
We propose Multi-Margin Cosine Loss (MMCL) to address these needs, which enhances contrastive learning by considering multiple margins and weights for improved representation and performance.
</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Multi-Margin Cosine Loss</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The proposed Multi-Margin Cosine Loss (MMCL) introduces multiple margins and weights for negative instances, considering hardest-negatives other non-trivial negatives; i.e., ’semi-hard’, ’semi-easy’-negatives.
Weights enable tuning the importance of each level of negatives.
Using a similar approach to CCL <cite class="ltx_cite ltx_citemacro_citep">(Mao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib19" title="">2021</a>)</cite>, we extended the generalized contrastive loss.
The MMCL equation is as follows:</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}L_{MMCL}=\sum_{i\in I+,N\subset I-}w_{p}(1-s(u,i)){\ +}\\
\dfrac{1}{N}\sum_{j\in N}\sum_{k\in|M|}w_{k}max(0,s(u,j)-m_{k})\end{split}" class="ltx_Math" display="block" id="S3.E7.m1.45"><semantics id="S3.E7.m1.45a"><mtable displaystyle="true" id="S3.E7.m1.45.45.4" rowspacing="0pt" xref="S3.E7.m1.43.43.2.cmml"><mtr id="S3.E7.m1.45.45.4a" xref="S3.E7.m1.43.43.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E7.m1.45.45.4b" xref="S3.E7.m1.43.43.2.cmml"><mrow id="S3.E7.m1.44.44.3.42.19.19" xref="S3.E7.m1.43.43.2.cmml"><msub id="S3.E7.m1.44.44.3.42.19.19.20" xref="S3.E7.m1.43.43.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml">L</mi><mrow id="S3.E7.m1.2.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.1.2" xref="S3.E7.m1.2.2.2.2.2.2.1.2.cmml">M</mi><mo id="S3.E7.m1.2.2.2.2.2.2.1.1" xref="S3.E7.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S3.E7.m1.2.2.2.2.2.2.1.3" xref="S3.E7.m1.2.2.2.2.2.2.1.3.cmml">M</mi><mo id="S3.E7.m1.2.2.2.2.2.2.1.1a" xref="S3.E7.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S3.E7.m1.2.2.2.2.2.2.1.4" xref="S3.E7.m1.2.2.2.2.2.2.1.4.cmml">C</mi><mo id="S3.E7.m1.2.2.2.2.2.2.1.1b" xref="S3.E7.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S3.E7.m1.2.2.2.2.2.2.1.5" xref="S3.E7.m1.2.2.2.2.2.2.1.5.cmml">L</mi></mrow></msub><mo id="S3.E7.m1.3.3.3.3.3.3" rspace="0.111em" xref="S3.E7.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E7.m1.44.44.3.42.19.19.19" xref="S3.E7.m1.43.43.2.cmml"><mrow id="S3.E7.m1.44.44.3.42.19.19.19.1" xref="S3.E7.m1.43.43.2.cmml"><munder id="S3.E7.m1.44.44.3.42.19.19.19.1.2" xref="S3.E7.m1.43.43.2.cmml"><mo id="S3.E7.m1.4.4.4.4.4.4" movablelimits="false" xref="S3.E7.m1.4.4.4.4.4.4.cmml">∑</mo><mrow id="S3.E7.m1.5.5.5.5.5.5.1.2" xref="S3.E7.m1.5.5.5.5.5.5.1.3.cmml"><mrow id="S3.E7.m1.5.5.5.5.5.5.1.1.1" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1.cmml"><mi id="S3.E7.m1.5.5.5.5.5.5.1.1.1.2" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1.2.cmml">i</mi><mo id="S3.E7.m1.5.5.5.5.5.5.1.1.1.1" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1.1.cmml">∈</mo><mrow id="S3.E7.m1.5.5.5.5.5.5.1.1.1.3" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1.3.cmml"><mi id="S3.E7.m1.5.5.5.5.5.5.1.1.1.3.2" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1.3.2.cmml">I</mi><mo id="S3.E7.m1.5.5.5.5.5.5.1.1.1.3.3" rspace="0em" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1.3.3.cmml">+</mo></mrow></mrow><mo id="S3.E7.m1.5.5.5.5.5.5.1.2.3" xref="S3.E7.m1.5.5.5.5.5.5.1.3a.cmml">,</mo><mrow id="S3.E7.m1.5.5.5.5.5.5.1.2.2" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2.cmml"><mi id="S3.E7.m1.5.5.5.5.5.5.1.2.2.2" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2.2.cmml">N</mi><mo id="S3.E7.m1.5.5.5.5.5.5.1.2.2.1" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2.1.cmml">⊂</mo><mrow id="S3.E7.m1.5.5.5.5.5.5.1.2.2.3" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2.3.cmml"><mi id="S3.E7.m1.5.5.5.5.5.5.1.2.2.3.2" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2.3.2.cmml">I</mi><mo id="S3.E7.m1.5.5.5.5.5.5.1.2.2.3.3" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2.3.3.cmml">−</mo></mrow></mrow></mrow></munder><mrow id="S3.E7.m1.44.44.3.42.19.19.19.1.1" xref="S3.E7.m1.43.43.2.cmml"><msub id="S3.E7.m1.44.44.3.42.19.19.19.1.1.3" xref="S3.E7.m1.43.43.2.cmml"><mi id="S3.E7.m1.6.6.6.6.6.6" xref="S3.E7.m1.6.6.6.6.6.6.cmml">w</mi><mi id="S3.E7.m1.7.7.7.7.7.7.1" xref="S3.E7.m1.7.7.7.7.7.7.1.cmml">p</mi></msub><mo id="S3.E7.m1.44.44.3.42.19.19.19.1.1.2" xref="S3.E7.m1.43.43.2.cmml">⁢</mo><mrow id="S3.E7.m1.44.44.3.42.19.19.19.1.1.1.1" xref="S3.E7.m1.43.43.2.cmml"><mo id="S3.E7.m1.8.8.8.8.8.8" stretchy="false" xref="S3.E7.m1.43.43.2.cmml">(</mo><mrow id="S3.E7.m1.44.44.3.42.19.19.19.1.1.1.1.1" xref="S3.E7.m1.43.43.2.cmml"><mn id="S3.E7.m1.9.9.9.9.9.9" xref="S3.E7.m1.9.9.9.9.9.9.cmml">1</mn><mo id="S3.E7.m1.10.10.10.10.10.10" xref="S3.E7.m1.10.10.10.10.10.10.cmml">−</mo><mrow id="S3.E7.m1.44.44.3.42.19.19.19.1.1.1.1.1.1" xref="S3.E7.m1.43.43.2.cmml"><mi id="S3.E7.m1.11.11.11.11.11.11" xref="S3.E7.m1.11.11.11.11.11.11.cmml">s</mi><mo id="S3.E7.m1.44.44.3.42.19.19.19.1.1.1.1.1.1.1" xref="S3.E7.m1.43.43.2.cmml">⁢</mo><mrow id="S3.E7.m1.44.44.3.42.19.19.19.1.1.1.1.1.1.2" xref="S3.E7.m1.43.43.2.cmml"><mo id="S3.E7.m1.12.12.12.12.12.12" stretchy="false" xref="S3.E7.m1.43.43.2.cmml">(</mo><mi id="S3.E7.m1.13.13.13.13.13.13" xref="S3.E7.m1.13.13.13.13.13.13.cmml">u</mi><mo id="S3.E7.m1.14.14.14.14.14.14" xref="S3.E7.m1.43.43.2.cmml">,</mo><mi id="S3.E7.m1.15.15.15.15.15.15" xref="S3.E7.m1.15.15.15.15.15.15.cmml">i</mi><mo id="S3.E7.m1.16.16.16.16.16.16" stretchy="false" xref="S3.E7.m1.43.43.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.17.17.17.17.17.17" rspace="0.500em" stretchy="false" xref="S3.E7.m1.43.43.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.18.18.18.18.18.18" xref="S3.E7.m1.18.18.18.18.18.18.cmml">+</mo></mrow></mrow></mtd></mtr><mtr id="S3.E7.m1.45.45.4c" xref="S3.E7.m1.43.43.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E7.m1.45.45.4d" xref="S3.E7.m1.43.43.2.cmml"><mrow id="S3.E7.m1.45.45.4.43.24.24" xref="S3.E7.m1.43.43.2.cmml"><mfrac id="S3.E7.m1.19.19.19.1.1.1" xref="S3.E7.m1.19.19.19.1.1.1.cmml"><mn id="S3.E7.m1.19.19.19.1.1.1.2" xref="S3.E7.m1.19.19.19.1.1.1.2.cmml">1</mn><mi id="S3.E7.m1.19.19.19.1.1.1.3" xref="S3.E7.m1.19.19.19.1.1.1.3.cmml">N</mi></mfrac><mo id="S3.E7.m1.45.45.4.43.24.24.25" xref="S3.E7.m1.43.43.2.cmml">⁢</mo><mrow id="S3.E7.m1.45.45.4.43.24.24.24" xref="S3.E7.m1.43.43.2.cmml"><munder id="S3.E7.m1.45.45.4.43.24.24.24.2" xref="S3.E7.m1.43.43.2.cmml"><mo id="S3.E7.m1.20.20.20.2.2.2" movablelimits="false" rspace="0em" xref="S3.E7.m1.20.20.20.2.2.2.cmml">∑</mo><mrow id="S3.E7.m1.21.21.21.3.3.3.1" xref="S3.E7.m1.21.21.21.3.3.3.1.cmml"><mi id="S3.E7.m1.21.21.21.3.3.3.1.2" xref="S3.E7.m1.21.21.21.3.3.3.1.2.cmml">j</mi><mo id="S3.E7.m1.21.21.21.3.3.3.1.1" xref="S3.E7.m1.21.21.21.3.3.3.1.1.cmml">∈</mo><mi id="S3.E7.m1.21.21.21.3.3.3.1.3" xref="S3.E7.m1.21.21.21.3.3.3.1.3.cmml">N</mi></mrow></munder><mrow id="S3.E7.m1.45.45.4.43.24.24.24.1" xref="S3.E7.m1.43.43.2.cmml"><munder id="S3.E7.m1.45.45.4.43.24.24.24.1.2" xref="S3.E7.m1.43.43.2.cmml"><mo id="S3.E7.m1.22.22.22.4.4.4" movablelimits="false" xref="S3.E7.m1.22.22.22.4.4.4.cmml">∑</mo><mrow id="S3.E7.m1.23.23.23.5.5.5.1" xref="S3.E7.m1.23.23.23.5.5.5.1.cmml"><mi id="S3.E7.m1.23.23.23.5.5.5.1.3" xref="S3.E7.m1.23.23.23.5.5.5.1.3.cmml">k</mi><mo id="S3.E7.m1.23.23.23.5.5.5.1.2" xref="S3.E7.m1.23.23.23.5.5.5.1.2.cmml">∈</mo><mrow id="S3.E7.m1.23.23.23.5.5.5.1.4.2" xref="S3.E7.m1.23.23.23.5.5.5.1.4.1.cmml"><mo id="S3.E7.m1.23.23.23.5.5.5.1.4.2.1" stretchy="false" xref="S3.E7.m1.23.23.23.5.5.5.1.4.1.1.cmml">|</mo><mi id="S3.E7.m1.23.23.23.5.5.5.1.1" xref="S3.E7.m1.23.23.23.5.5.5.1.1.cmml">M</mi><mo id="S3.E7.m1.23.23.23.5.5.5.1.4.2.2" stretchy="false" xref="S3.E7.m1.23.23.23.5.5.5.1.4.1.1.cmml">|</mo></mrow></mrow></munder><mrow id="S3.E7.m1.45.45.4.43.24.24.24.1.1" xref="S3.E7.m1.43.43.2.cmml"><msub id="S3.E7.m1.45.45.4.43.24.24.24.1.1.3" xref="S3.E7.m1.43.43.2.cmml"><mi id="S3.E7.m1.24.24.24.6.6.6" xref="S3.E7.m1.24.24.24.6.6.6.cmml">w</mi><mi id="S3.E7.m1.25.25.25.7.7.7.1" xref="S3.E7.m1.25.25.25.7.7.7.1.cmml">k</mi></msub><mo id="S3.E7.m1.45.45.4.43.24.24.24.1.1.2" xref="S3.E7.m1.43.43.2.cmml">⁢</mo><mi id="S3.E7.m1.26.26.26.8.8.8" xref="S3.E7.m1.26.26.26.8.8.8.cmml">m</mi><mo id="S3.E7.m1.45.45.4.43.24.24.24.1.1.2a" xref="S3.E7.m1.43.43.2.cmml">⁢</mo><mi id="S3.E7.m1.27.27.27.9.9.9" xref="S3.E7.m1.27.27.27.9.9.9.cmml">a</mi><mo id="S3.E7.m1.45.45.4.43.24.24.24.1.1.2b" xref="S3.E7.m1.43.43.2.cmml">⁢</mo><mi id="S3.E7.m1.28.28.28.10.10.10" xref="S3.E7.m1.28.28.28.10.10.10.cmml">x</mi><mo id="S3.E7.m1.45.45.4.43.24.24.24.1.1.2c" xref="S3.E7.m1.43.43.2.cmml">⁢</mo><mrow id="S3.E7.m1.45.45.4.43.24.24.24.1.1.1.1" xref="S3.E7.m1.43.43.2.cmml"><mo id="S3.E7.m1.29.29.29.11.11.11" stretchy="false" xref="S3.E7.m1.43.43.2.cmml">(</mo><mn id="S3.E7.m1.30.30.30.12.12.12" xref="S3.E7.m1.30.30.30.12.12.12.cmml">0</mn><mo id="S3.E7.m1.31.31.31.13.13.13" xref="S3.E7.m1.43.43.2.cmml">,</mo><mrow id="S3.E7.m1.45.45.4.43.24.24.24.1.1.1.1.1" xref="S3.E7.m1.43.43.2.cmml"><mrow id="S3.E7.m1.45.45.4.43.24.24.24.1.1.1.1.1.1" xref="S3.E7.m1.43.43.2.cmml"><mi id="S3.E7.m1.32.32.32.14.14.14" xref="S3.E7.m1.32.32.32.14.14.14.cmml">s</mi><mo id="S3.E7.m1.45.45.4.43.24.24.24.1.1.1.1.1.1.1" xref="S3.E7.m1.43.43.2.cmml">⁢</mo><mrow id="S3.E7.m1.45.45.4.43.24.24.24.1.1.1.1.1.1.2" xref="S3.E7.m1.43.43.2.cmml"><mo id="S3.E7.m1.33.33.33.15.15.15" stretchy="false" xref="S3.E7.m1.43.43.2.cmml">(</mo><mi id="S3.E7.m1.34.34.34.16.16.16" xref="S3.E7.m1.34.34.34.16.16.16.cmml">u</mi><mo id="S3.E7.m1.35.35.35.17.17.17" xref="S3.E7.m1.43.43.2.cmml">,</mo><mi id="S3.E7.m1.36.36.36.18.18.18" xref="S3.E7.m1.36.36.36.18.18.18.cmml">j</mi><mo id="S3.E7.m1.37.37.37.19.19.19" stretchy="false" xref="S3.E7.m1.43.43.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.38.38.38.20.20.20" xref="S3.E7.m1.38.38.38.20.20.20.cmml">−</mo><msub id="S3.E7.m1.45.45.4.43.24.24.24.1.1.1.1.1.2" xref="S3.E7.m1.43.43.2.cmml"><mi id="S3.E7.m1.39.39.39.21.21.21" xref="S3.E7.m1.39.39.39.21.21.21.cmml">m</mi><mi id="S3.E7.m1.40.40.40.22.22.22.1" xref="S3.E7.m1.40.40.40.22.22.22.1.cmml">k</mi></msub></mrow><mo id="S3.E7.m1.41.41.41.23.23.23" stretchy="false" xref="S3.E7.m1.43.43.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E7.m1.45b"><apply id="S3.E7.m1.43.43.2.cmml" xref="S3.E7.m1.45.45.4"><eq id="S3.E7.m1.3.3.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3.3.3"></eq><apply id="S3.E7.m1.43.43.2.4.cmml" xref="S3.E7.m1.45.45.4"><csymbol cd="ambiguous" id="S3.E7.m1.43.43.2.4.1.cmml" xref="S3.E7.m1.45.45.4">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">𝐿</ci><apply id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1"><times id="S3.E7.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.1"></times><ci id="S3.E7.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.2">𝑀</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.3">𝑀</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.4.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.4">𝐶</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.5.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1.5">𝐿</ci></apply></apply><apply id="S3.E7.m1.43.43.2.2.cmml" xref="S3.E7.m1.45.45.4"><plus id="S3.E7.m1.18.18.18.18.18.18.cmml" xref="S3.E7.m1.18.18.18.18.18.18"></plus><apply id="S3.E7.m1.42.42.1.1.1.cmml" xref="S3.E7.m1.45.45.4"><apply id="S3.E7.m1.42.42.1.1.1.2.cmml" xref="S3.E7.m1.45.45.4"><csymbol cd="ambiguous" id="S3.E7.m1.42.42.1.1.1.2.1.cmml" xref="S3.E7.m1.45.45.4">subscript</csymbol><sum id="S3.E7.m1.4.4.4.4.4.4.cmml" xref="S3.E7.m1.4.4.4.4.4.4"></sum><apply id="S3.E7.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.5.5.5.5.1.3a.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.5.5.5.5.5.5.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1"><in id="S3.E7.m1.5.5.5.5.5.5.1.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1.1"></in><ci id="S3.E7.m1.5.5.5.5.5.5.1.1.1.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1.2">𝑖</ci><apply id="S3.E7.m1.5.5.5.5.5.5.1.1.1.3.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1.3"><csymbol cd="latexml" id="S3.E7.m1.5.5.5.5.5.5.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1.3">limit-from</csymbol><ci id="S3.E7.m1.5.5.5.5.5.5.1.1.1.3.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1.3.2">𝐼</ci><plus id="S3.E7.m1.5.5.5.5.5.5.1.1.1.3.3.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.1.1.3.3"></plus></apply></apply><apply id="S3.E7.m1.5.5.5.5.5.5.1.2.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2"><subset id="S3.E7.m1.5.5.5.5.5.5.1.2.2.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2.1"></subset><ci id="S3.E7.m1.5.5.5.5.5.5.1.2.2.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2.2">𝑁</ci><apply id="S3.E7.m1.5.5.5.5.5.5.1.2.2.3.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2.3"><csymbol cd="latexml" id="S3.E7.m1.5.5.5.5.5.5.1.2.2.3.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2.3">limit-from</csymbol><ci id="S3.E7.m1.5.5.5.5.5.5.1.2.2.3.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2.3.2">𝐼</ci><minus id="S3.E7.m1.5.5.5.5.5.5.1.2.2.3.3.cmml" xref="S3.E7.m1.5.5.5.5.5.5.1.2.2.3.3"></minus></apply></apply></apply></apply><apply id="S3.E7.m1.42.42.1.1.1.1.cmml" xref="S3.E7.m1.45.45.4"><times id="S3.E7.m1.42.42.1.1.1.1.2.cmml" xref="S3.E7.m1.45.45.4"></times><apply id="S3.E7.m1.42.42.1.1.1.1.3.cmml" xref="S3.E7.m1.45.45.4"><csymbol cd="ambiguous" id="S3.E7.m1.42.42.1.1.1.1.3.1.cmml" xref="S3.E7.m1.45.45.4">subscript</csymbol><ci id="S3.E7.m1.6.6.6.6.6.6.cmml" xref="S3.E7.m1.6.6.6.6.6.6">𝑤</ci><ci id="S3.E7.m1.7.7.7.7.7.7.1.cmml" xref="S3.E7.m1.7.7.7.7.7.7.1">𝑝</ci></apply><apply id="S3.E7.m1.42.42.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.45.45.4"><minus id="S3.E7.m1.10.10.10.10.10.10.cmml" xref="S3.E7.m1.10.10.10.10.10.10"></minus><cn id="S3.E7.m1.9.9.9.9.9.9.cmml" type="integer" xref="S3.E7.m1.9.9.9.9.9.9">1</cn><apply id="S3.E7.m1.42.42.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.45.45.4"><times id="S3.E7.m1.42.42.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.45.45.4"></times><ci id="S3.E7.m1.11.11.11.11.11.11.cmml" xref="S3.E7.m1.11.11.11.11.11.11">𝑠</ci><interval closure="open" id="S3.E7.m1.42.42.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.45.45.4"><ci id="S3.E7.m1.13.13.13.13.13.13.cmml" xref="S3.E7.m1.13.13.13.13.13.13">𝑢</ci><ci id="S3.E7.m1.15.15.15.15.15.15.cmml" xref="S3.E7.m1.15.15.15.15.15.15">𝑖</ci></interval></apply></apply></apply></apply><apply id="S3.E7.m1.43.43.2.2.2.cmml" xref="S3.E7.m1.45.45.4"><times id="S3.E7.m1.43.43.2.2.2.2.cmml" xref="S3.E7.m1.45.45.4"></times><apply id="S3.E7.m1.19.19.19.1.1.1.cmml" xref="S3.E7.m1.19.19.19.1.1.1"><divide id="S3.E7.m1.19.19.19.1.1.1.1.cmml" xref="S3.E7.m1.19.19.19.1.1.1"></divide><cn id="S3.E7.m1.19.19.19.1.1.1.2.cmml" type="integer" xref="S3.E7.m1.19.19.19.1.1.1.2">1</cn><ci id="S3.E7.m1.19.19.19.1.1.1.3.cmml" xref="S3.E7.m1.19.19.19.1.1.1.3">𝑁</ci></apply><apply id="S3.E7.m1.43.43.2.2.2.1.cmml" xref="S3.E7.m1.45.45.4"><apply id="S3.E7.m1.43.43.2.2.2.1.2.cmml" xref="S3.E7.m1.45.45.4"><csymbol cd="ambiguous" id="S3.E7.m1.43.43.2.2.2.1.2.1.cmml" xref="S3.E7.m1.45.45.4">subscript</csymbol><sum id="S3.E7.m1.20.20.20.2.2.2.cmml" xref="S3.E7.m1.20.20.20.2.2.2"></sum><apply id="S3.E7.m1.21.21.21.3.3.3.1.cmml" xref="S3.E7.m1.21.21.21.3.3.3.1"><in id="S3.E7.m1.21.21.21.3.3.3.1.1.cmml" xref="S3.E7.m1.21.21.21.3.3.3.1.1"></in><ci id="S3.E7.m1.21.21.21.3.3.3.1.2.cmml" xref="S3.E7.m1.21.21.21.3.3.3.1.2">𝑗</ci><ci id="S3.E7.m1.21.21.21.3.3.3.1.3.cmml" xref="S3.E7.m1.21.21.21.3.3.3.1.3">𝑁</ci></apply></apply><apply id="S3.E7.m1.43.43.2.2.2.1.1.cmml" xref="S3.E7.m1.45.45.4"><apply id="S3.E7.m1.43.43.2.2.2.1.1.2.cmml" xref="S3.E7.m1.45.45.4"><csymbol cd="ambiguous" id="S3.E7.m1.43.43.2.2.2.1.1.2.1.cmml" xref="S3.E7.m1.45.45.4">subscript</csymbol><sum id="S3.E7.m1.22.22.22.4.4.4.cmml" xref="S3.E7.m1.22.22.22.4.4.4"></sum><apply id="S3.E7.m1.23.23.23.5.5.5.1.cmml" xref="S3.E7.m1.23.23.23.5.5.5.1"><in id="S3.E7.m1.23.23.23.5.5.5.1.2.cmml" xref="S3.E7.m1.23.23.23.5.5.5.1.2"></in><ci id="S3.E7.m1.23.23.23.5.5.5.1.3.cmml" xref="S3.E7.m1.23.23.23.5.5.5.1.3">𝑘</ci><apply id="S3.E7.m1.23.23.23.5.5.5.1.4.1.cmml" xref="S3.E7.m1.23.23.23.5.5.5.1.4.2"><abs id="S3.E7.m1.23.23.23.5.5.5.1.4.1.1.cmml" xref="S3.E7.m1.23.23.23.5.5.5.1.4.2.1"></abs><ci id="S3.E7.m1.23.23.23.5.5.5.1.1.cmml" xref="S3.E7.m1.23.23.23.5.5.5.1.1">𝑀</ci></apply></apply></apply><apply id="S3.E7.m1.43.43.2.2.2.1.1.1.cmml" xref="S3.E7.m1.45.45.4"><times id="S3.E7.m1.43.43.2.2.2.1.1.1.2.cmml" xref="S3.E7.m1.45.45.4"></times><apply id="S3.E7.m1.43.43.2.2.2.1.1.1.3.cmml" xref="S3.E7.m1.45.45.4"><csymbol cd="ambiguous" id="S3.E7.m1.43.43.2.2.2.1.1.1.3.1.cmml" xref="S3.E7.m1.45.45.4">subscript</csymbol><ci id="S3.E7.m1.24.24.24.6.6.6.cmml" xref="S3.E7.m1.24.24.24.6.6.6">𝑤</ci><ci id="S3.E7.m1.25.25.25.7.7.7.1.cmml" xref="S3.E7.m1.25.25.25.7.7.7.1">𝑘</ci></apply><ci id="S3.E7.m1.26.26.26.8.8.8.cmml" xref="S3.E7.m1.26.26.26.8.8.8">𝑚</ci><ci id="S3.E7.m1.27.27.27.9.9.9.cmml" xref="S3.E7.m1.27.27.27.9.9.9">𝑎</ci><ci id="S3.E7.m1.28.28.28.10.10.10.cmml" xref="S3.E7.m1.28.28.28.10.10.10">𝑥</ci><interval closure="open" id="S3.E7.m1.43.43.2.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.45.45.4"><cn id="S3.E7.m1.30.30.30.12.12.12.cmml" type="integer" xref="S3.E7.m1.30.30.30.12.12.12">0</cn><apply id="S3.E7.m1.43.43.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E7.m1.45.45.4"><minus id="S3.E7.m1.38.38.38.20.20.20.cmml" xref="S3.E7.m1.38.38.38.20.20.20"></minus><apply id="S3.E7.m1.43.43.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.45.45.4"><times id="S3.E7.m1.43.43.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.45.45.4"></times><ci id="S3.E7.m1.32.32.32.14.14.14.cmml" xref="S3.E7.m1.32.32.32.14.14.14">𝑠</ci><interval closure="open" id="S3.E7.m1.43.43.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.45.45.4"><ci id="S3.E7.m1.34.34.34.16.16.16.cmml" xref="S3.E7.m1.34.34.34.16.16.16">𝑢</ci><ci id="S3.E7.m1.36.36.36.18.18.18.cmml" xref="S3.E7.m1.36.36.36.18.18.18">𝑗</ci></interval></apply><apply id="S3.E7.m1.43.43.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.45.45.4"><csymbol cd="ambiguous" id="S3.E7.m1.43.43.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.45.45.4">subscript</csymbol><ci id="S3.E7.m1.39.39.39.21.21.21.cmml" xref="S3.E7.m1.39.39.39.21.21.21">𝑚</ci><ci id="S3.E7.m1.40.40.40.22.22.22.1.cmml" xref="S3.E7.m1.40.40.40.22.22.22.1">𝑘</ci></apply></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.45c">\begin{split}L_{MMCL}=\sum_{i\in I+,N\subset I-}w_{p}(1-s(u,i)){\ +}\\
\dfrac{1}{N}\sum_{j\in N}\sum_{k\in|M|}w_{k}max(0,s(u,j)-m_{k})\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.45d">start_ROW start_CELL italic_L start_POSTSUBSCRIPT italic_M italic_M italic_C italic_L end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i ∈ italic_I + , italic_N ⊂ italic_I - end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( 1 - italic_s ( italic_u , italic_i ) ) + end_CELL end_ROW start_ROW start_CELL divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_j ∈ italic_N end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_k ∈ | italic_M | end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_m italic_a italic_x ( 0 , italic_s ( italic_u , italic_j ) - italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.11">In the equation, <math alttext="|M|" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.2.2" xref="S3.SS3.p2.1.m1.1.2.1.cmml"><mo id="S3.SS3.p2.1.m1.1.2.2.1" stretchy="false" xref="S3.SS3.p2.1.m1.1.2.1.1.cmml">|</mo><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">M</mi><mo id="S3.SS3.p2.1.m1.1.2.2.2" stretchy="false" xref="S3.SS3.p2.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.2.2"><abs id="S3.SS3.p2.1.m1.1.2.1.1.cmml" xref="S3.SS3.p2.1.m1.1.2.2.1"></abs><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">|M|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">| italic_M |</annotation></semantics></math> is the size of the defined margins. Each margin <math alttext="m_{k}\in M" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><msub id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2.2" xref="S3.SS3.p2.2.m2.1.1.2.2.cmml">m</mi><mi id="S3.SS3.p2.2.m2.1.1.2.3" xref="S3.SS3.p2.2.m2.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">∈</mo><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><in id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"></in><apply id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2">𝑚</ci><ci id="S3.SS3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">m_{k}\in M</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ italic_M</annotation></semantics></math> is assigned a different weight, <math alttext="w_{k}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">w</mi><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝑤</ci><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">w_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_w start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
Similar to CCL, (i) similarity is used for computations: <math alttext="f(u,i)=1-s(u,i)" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.4"><semantics id="S3.SS3.p2.4.m4.4a"><mrow id="S3.SS3.p2.4.m4.4.5" xref="S3.SS3.p2.4.m4.4.5.cmml"><mrow id="S3.SS3.p2.4.m4.4.5.2" xref="S3.SS3.p2.4.m4.4.5.2.cmml"><mi id="S3.SS3.p2.4.m4.4.5.2.2" xref="S3.SS3.p2.4.m4.4.5.2.2.cmml">f</mi><mo id="S3.SS3.p2.4.m4.4.5.2.1" xref="S3.SS3.p2.4.m4.4.5.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.4.m4.4.5.2.3.2" xref="S3.SS3.p2.4.m4.4.5.2.3.1.cmml"><mo id="S3.SS3.p2.4.m4.4.5.2.3.2.1" stretchy="false" xref="S3.SS3.p2.4.m4.4.5.2.3.1.cmml">(</mo><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">u</mi><mo id="S3.SS3.p2.4.m4.4.5.2.3.2.2" xref="S3.SS3.p2.4.m4.4.5.2.3.1.cmml">,</mo><mi id="S3.SS3.p2.4.m4.2.2" xref="S3.SS3.p2.4.m4.2.2.cmml">i</mi><mo id="S3.SS3.p2.4.m4.4.5.2.3.2.3" stretchy="false" xref="S3.SS3.p2.4.m4.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.4.m4.4.5.1" xref="S3.SS3.p2.4.m4.4.5.1.cmml">=</mo><mrow id="S3.SS3.p2.4.m4.4.5.3" xref="S3.SS3.p2.4.m4.4.5.3.cmml"><mn id="S3.SS3.p2.4.m4.4.5.3.2" xref="S3.SS3.p2.4.m4.4.5.3.2.cmml">1</mn><mo id="S3.SS3.p2.4.m4.4.5.3.1" xref="S3.SS3.p2.4.m4.4.5.3.1.cmml">−</mo><mrow id="S3.SS3.p2.4.m4.4.5.3.3" xref="S3.SS3.p2.4.m4.4.5.3.3.cmml"><mi id="S3.SS3.p2.4.m4.4.5.3.3.2" xref="S3.SS3.p2.4.m4.4.5.3.3.2.cmml">s</mi><mo id="S3.SS3.p2.4.m4.4.5.3.3.1" xref="S3.SS3.p2.4.m4.4.5.3.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.4.m4.4.5.3.3.3.2" xref="S3.SS3.p2.4.m4.4.5.3.3.3.1.cmml"><mo id="S3.SS3.p2.4.m4.4.5.3.3.3.2.1" stretchy="false" xref="S3.SS3.p2.4.m4.4.5.3.3.3.1.cmml">(</mo><mi id="S3.SS3.p2.4.m4.3.3" xref="S3.SS3.p2.4.m4.3.3.cmml">u</mi><mo id="S3.SS3.p2.4.m4.4.5.3.3.3.2.2" xref="S3.SS3.p2.4.m4.4.5.3.3.3.1.cmml">,</mo><mi id="S3.SS3.p2.4.m4.4.4" xref="S3.SS3.p2.4.m4.4.4.cmml">i</mi><mo id="S3.SS3.p2.4.m4.4.5.3.3.3.2.3" stretchy="false" xref="S3.SS3.p2.4.m4.4.5.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.4b"><apply id="S3.SS3.p2.4.m4.4.5.cmml" xref="S3.SS3.p2.4.m4.4.5"><eq id="S3.SS3.p2.4.m4.4.5.1.cmml" xref="S3.SS3.p2.4.m4.4.5.1"></eq><apply id="S3.SS3.p2.4.m4.4.5.2.cmml" xref="S3.SS3.p2.4.m4.4.5.2"><times id="S3.SS3.p2.4.m4.4.5.2.1.cmml" xref="S3.SS3.p2.4.m4.4.5.2.1"></times><ci id="S3.SS3.p2.4.m4.4.5.2.2.cmml" xref="S3.SS3.p2.4.m4.4.5.2.2">𝑓</ci><interval closure="open" id="S3.SS3.p2.4.m4.4.5.2.3.1.cmml" xref="S3.SS3.p2.4.m4.4.5.2.3.2"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝑢</ci><ci id="S3.SS3.p2.4.m4.2.2.cmml" xref="S3.SS3.p2.4.m4.2.2">𝑖</ci></interval></apply><apply id="S3.SS3.p2.4.m4.4.5.3.cmml" xref="S3.SS3.p2.4.m4.4.5.3"><minus id="S3.SS3.p2.4.m4.4.5.3.1.cmml" xref="S3.SS3.p2.4.m4.4.5.3.1"></minus><cn id="S3.SS3.p2.4.m4.4.5.3.2.cmml" type="integer" xref="S3.SS3.p2.4.m4.4.5.3.2">1</cn><apply id="S3.SS3.p2.4.m4.4.5.3.3.cmml" xref="S3.SS3.p2.4.m4.4.5.3.3"><times id="S3.SS3.p2.4.m4.4.5.3.3.1.cmml" xref="S3.SS3.p2.4.m4.4.5.3.3.1"></times><ci id="S3.SS3.p2.4.m4.4.5.3.3.2.cmml" xref="S3.SS3.p2.4.m4.4.5.3.3.2">𝑠</ci><interval closure="open" id="S3.SS3.p2.4.m4.4.5.3.3.3.1.cmml" xref="S3.SS3.p2.4.m4.4.5.3.3.3.2"><ci id="S3.SS3.p2.4.m4.3.3.cmml" xref="S3.SS3.p2.4.m4.3.3">𝑢</ci><ci id="S3.SS3.p2.4.m4.4.4.cmml" xref="S3.SS3.p2.4.m4.4.4">𝑖</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.4c">f(u,i)=1-s(u,i)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.4d">italic_f ( italic_u , italic_i ) = 1 - italic_s ( italic_u , italic_i )</annotation></semantics></math> and <math alttext="f(u,i,j,m_{k})=s(u,j)-m_{k}" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.6"><semantics id="S3.SS3.p2.5.m5.6a"><mrow id="S3.SS3.p2.5.m5.6.6" xref="S3.SS3.p2.5.m5.6.6.cmml"><mrow id="S3.SS3.p2.5.m5.6.6.1" xref="S3.SS3.p2.5.m5.6.6.1.cmml"><mi id="S3.SS3.p2.5.m5.6.6.1.3" xref="S3.SS3.p2.5.m5.6.6.1.3.cmml">f</mi><mo id="S3.SS3.p2.5.m5.6.6.1.2" xref="S3.SS3.p2.5.m5.6.6.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.5.m5.6.6.1.1.1" xref="S3.SS3.p2.5.m5.6.6.1.1.2.cmml"><mo id="S3.SS3.p2.5.m5.6.6.1.1.1.2" stretchy="false" xref="S3.SS3.p2.5.m5.6.6.1.1.2.cmml">(</mo><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">u</mi><mo id="S3.SS3.p2.5.m5.6.6.1.1.1.3" xref="S3.SS3.p2.5.m5.6.6.1.1.2.cmml">,</mo><mi id="S3.SS3.p2.5.m5.2.2" xref="S3.SS3.p2.5.m5.2.2.cmml">i</mi><mo id="S3.SS3.p2.5.m5.6.6.1.1.1.4" xref="S3.SS3.p2.5.m5.6.6.1.1.2.cmml">,</mo><mi id="S3.SS3.p2.5.m5.3.3" xref="S3.SS3.p2.5.m5.3.3.cmml">j</mi><mo id="S3.SS3.p2.5.m5.6.6.1.1.1.5" xref="S3.SS3.p2.5.m5.6.6.1.1.2.cmml">,</mo><msub id="S3.SS3.p2.5.m5.6.6.1.1.1.1" xref="S3.SS3.p2.5.m5.6.6.1.1.1.1.cmml"><mi id="S3.SS3.p2.5.m5.6.6.1.1.1.1.2" xref="S3.SS3.p2.5.m5.6.6.1.1.1.1.2.cmml">m</mi><mi id="S3.SS3.p2.5.m5.6.6.1.1.1.1.3" xref="S3.SS3.p2.5.m5.6.6.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS3.p2.5.m5.6.6.1.1.1.6" stretchy="false" xref="S3.SS3.p2.5.m5.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.5.m5.6.6.2" xref="S3.SS3.p2.5.m5.6.6.2.cmml">=</mo><mrow id="S3.SS3.p2.5.m5.6.6.3" xref="S3.SS3.p2.5.m5.6.6.3.cmml"><mrow id="S3.SS3.p2.5.m5.6.6.3.2" xref="S3.SS3.p2.5.m5.6.6.3.2.cmml"><mi id="S3.SS3.p2.5.m5.6.6.3.2.2" xref="S3.SS3.p2.5.m5.6.6.3.2.2.cmml">s</mi><mo id="S3.SS3.p2.5.m5.6.6.3.2.1" xref="S3.SS3.p2.5.m5.6.6.3.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.5.m5.6.6.3.2.3.2" xref="S3.SS3.p2.5.m5.6.6.3.2.3.1.cmml"><mo id="S3.SS3.p2.5.m5.6.6.3.2.3.2.1" stretchy="false" xref="S3.SS3.p2.5.m5.6.6.3.2.3.1.cmml">(</mo><mi id="S3.SS3.p2.5.m5.4.4" xref="S3.SS3.p2.5.m5.4.4.cmml">u</mi><mo id="S3.SS3.p2.5.m5.6.6.3.2.3.2.2" xref="S3.SS3.p2.5.m5.6.6.3.2.3.1.cmml">,</mo><mi id="S3.SS3.p2.5.m5.5.5" xref="S3.SS3.p2.5.m5.5.5.cmml">j</mi><mo id="S3.SS3.p2.5.m5.6.6.3.2.3.2.3" stretchy="false" xref="S3.SS3.p2.5.m5.6.6.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.5.m5.6.6.3.1" xref="S3.SS3.p2.5.m5.6.6.3.1.cmml">−</mo><msub id="S3.SS3.p2.5.m5.6.6.3.3" xref="S3.SS3.p2.5.m5.6.6.3.3.cmml"><mi id="S3.SS3.p2.5.m5.6.6.3.3.2" xref="S3.SS3.p2.5.m5.6.6.3.3.2.cmml">m</mi><mi id="S3.SS3.p2.5.m5.6.6.3.3.3" xref="S3.SS3.p2.5.m5.6.6.3.3.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.6b"><apply id="S3.SS3.p2.5.m5.6.6.cmml" xref="S3.SS3.p2.5.m5.6.6"><eq id="S3.SS3.p2.5.m5.6.6.2.cmml" xref="S3.SS3.p2.5.m5.6.6.2"></eq><apply id="S3.SS3.p2.5.m5.6.6.1.cmml" xref="S3.SS3.p2.5.m5.6.6.1"><times id="S3.SS3.p2.5.m5.6.6.1.2.cmml" xref="S3.SS3.p2.5.m5.6.6.1.2"></times><ci id="S3.SS3.p2.5.m5.6.6.1.3.cmml" xref="S3.SS3.p2.5.m5.6.6.1.3">𝑓</ci><vector id="S3.SS3.p2.5.m5.6.6.1.1.2.cmml" xref="S3.SS3.p2.5.m5.6.6.1.1.1"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝑢</ci><ci id="S3.SS3.p2.5.m5.2.2.cmml" xref="S3.SS3.p2.5.m5.2.2">𝑖</ci><ci id="S3.SS3.p2.5.m5.3.3.cmml" xref="S3.SS3.p2.5.m5.3.3">𝑗</ci><apply id="S3.SS3.p2.5.m5.6.6.1.1.1.1.cmml" xref="S3.SS3.p2.5.m5.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.6.6.1.1.1.1.1.cmml" xref="S3.SS3.p2.5.m5.6.6.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.6.6.1.1.1.1.2.cmml" xref="S3.SS3.p2.5.m5.6.6.1.1.1.1.2">𝑚</ci><ci id="S3.SS3.p2.5.m5.6.6.1.1.1.1.3.cmml" xref="S3.SS3.p2.5.m5.6.6.1.1.1.1.3">𝑘</ci></apply></vector></apply><apply id="S3.SS3.p2.5.m5.6.6.3.cmml" xref="S3.SS3.p2.5.m5.6.6.3"><minus id="S3.SS3.p2.5.m5.6.6.3.1.cmml" xref="S3.SS3.p2.5.m5.6.6.3.1"></minus><apply id="S3.SS3.p2.5.m5.6.6.3.2.cmml" xref="S3.SS3.p2.5.m5.6.6.3.2"><times id="S3.SS3.p2.5.m5.6.6.3.2.1.cmml" xref="S3.SS3.p2.5.m5.6.6.3.2.1"></times><ci id="S3.SS3.p2.5.m5.6.6.3.2.2.cmml" xref="S3.SS3.p2.5.m5.6.6.3.2.2">𝑠</ci><interval closure="open" id="S3.SS3.p2.5.m5.6.6.3.2.3.1.cmml" xref="S3.SS3.p2.5.m5.6.6.3.2.3.2"><ci id="S3.SS3.p2.5.m5.4.4.cmml" xref="S3.SS3.p2.5.m5.4.4">𝑢</ci><ci id="S3.SS3.p2.5.m5.5.5.cmml" xref="S3.SS3.p2.5.m5.5.5">𝑗</ci></interval></apply><apply id="S3.SS3.p2.5.m5.6.6.3.3.cmml" xref="S3.SS3.p2.5.m5.6.6.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.6.6.3.3.1.cmml" xref="S3.SS3.p2.5.m5.6.6.3.3">subscript</csymbol><ci id="S3.SS3.p2.5.m5.6.6.3.3.2.cmml" xref="S3.SS3.p2.5.m5.6.6.3.3.2">𝑚</ci><ci id="S3.SS3.p2.5.m5.6.6.3.3.3.cmml" xref="S3.SS3.p2.5.m5.6.6.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.6c">f(u,i,j,m_{k})=s(u,j)-m_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.6d">italic_f ( italic_u , italic_i , italic_j , italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) = italic_s ( italic_u , italic_j ) - italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and (ii) margins are set relative to the user representation.
Figure <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:subfig:mmcl</span> illustrates MMCL: It uses multiple margins, <math alttext="m1,m2,m3" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.3"><semantics id="S3.SS3.p2.6.m6.3a"><mrow id="S3.SS3.p2.6.m6.3.3.3" xref="S3.SS3.p2.6.m6.3.3.4.cmml"><mrow id="S3.SS3.p2.6.m6.1.1.1.1" xref="S3.SS3.p2.6.m6.1.1.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.1.1.2" xref="S3.SS3.p2.6.m6.1.1.1.1.2.cmml">m</mi><mo id="S3.SS3.p2.6.m6.1.1.1.1.1" xref="S3.SS3.p2.6.m6.1.1.1.1.1.cmml">⁢</mo><mn id="S3.SS3.p2.6.m6.1.1.1.1.3" xref="S3.SS3.p2.6.m6.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS3.p2.6.m6.3.3.3.4" xref="S3.SS3.p2.6.m6.3.3.4.cmml">,</mo><mrow id="S3.SS3.p2.6.m6.2.2.2.2" xref="S3.SS3.p2.6.m6.2.2.2.2.cmml"><mi id="S3.SS3.p2.6.m6.2.2.2.2.2" xref="S3.SS3.p2.6.m6.2.2.2.2.2.cmml">m</mi><mo id="S3.SS3.p2.6.m6.2.2.2.2.1" xref="S3.SS3.p2.6.m6.2.2.2.2.1.cmml">⁢</mo><mn id="S3.SS3.p2.6.m6.2.2.2.2.3" xref="S3.SS3.p2.6.m6.2.2.2.2.3.cmml">2</mn></mrow><mo id="S3.SS3.p2.6.m6.3.3.3.5" xref="S3.SS3.p2.6.m6.3.3.4.cmml">,</mo><mrow id="S3.SS3.p2.6.m6.3.3.3.3" xref="S3.SS3.p2.6.m6.3.3.3.3.cmml"><mi id="S3.SS3.p2.6.m6.3.3.3.3.2" xref="S3.SS3.p2.6.m6.3.3.3.3.2.cmml">m</mi><mo id="S3.SS3.p2.6.m6.3.3.3.3.1" xref="S3.SS3.p2.6.m6.3.3.3.3.1.cmml">⁢</mo><mn id="S3.SS3.p2.6.m6.3.3.3.3.3" xref="S3.SS3.p2.6.m6.3.3.3.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.3b"><list id="S3.SS3.p2.6.m6.3.3.4.cmml" xref="S3.SS3.p2.6.m6.3.3.3"><apply id="S3.SS3.p2.6.m6.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1"><times id="S3.SS3.p2.6.m6.1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1"></times><ci id="S3.SS3.p2.6.m6.1.1.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.2">𝑚</ci><cn id="S3.SS3.p2.6.m6.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.p2.6.m6.1.1.1.1.3">1</cn></apply><apply id="S3.SS3.p2.6.m6.2.2.2.2.cmml" xref="S3.SS3.p2.6.m6.2.2.2.2"><times id="S3.SS3.p2.6.m6.2.2.2.2.1.cmml" xref="S3.SS3.p2.6.m6.2.2.2.2.1"></times><ci id="S3.SS3.p2.6.m6.2.2.2.2.2.cmml" xref="S3.SS3.p2.6.m6.2.2.2.2.2">𝑚</ci><cn id="S3.SS3.p2.6.m6.2.2.2.2.3.cmml" type="integer" xref="S3.SS3.p2.6.m6.2.2.2.2.3">2</cn></apply><apply id="S3.SS3.p2.6.m6.3.3.3.3.cmml" xref="S3.SS3.p2.6.m6.3.3.3.3"><times id="S3.SS3.p2.6.m6.3.3.3.3.1.cmml" xref="S3.SS3.p2.6.m6.3.3.3.3.1"></times><ci id="S3.SS3.p2.6.m6.3.3.3.3.2.cmml" xref="S3.SS3.p2.6.m6.3.3.3.3.2">𝑚</ci><cn id="S3.SS3.p2.6.m6.3.3.3.3.3.cmml" type="integer" xref="S3.SS3.p2.6.m6.3.3.3.3.3">3</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.3c">m1,m2,m3</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.3d">italic_m 1 , italic_m 2 , italic_m 3</annotation></semantics></math> <math alttext="m1" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><mrow id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><mi id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml">m</mi><mo id="S3.SS3.p2.7.m7.1.1.1" xref="S3.SS3.p2.7.m7.1.1.1.cmml">⁢</mo><mn id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><times id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1.1"></times><ci id="S3.SS3.p2.7.m7.1.1.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2">𝑚</ci><cn id="S3.SS3.p2.7.m7.1.1.3.cmml" type="integer" xref="S3.SS3.p2.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">m1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">italic_m 1</annotation></semantics></math>, and assigns different weights <math alttext="w1,w2,w3" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m8.3"><semantics id="S3.SS3.p2.8.m8.3a"><mrow id="S3.SS3.p2.8.m8.3.3.3" xref="S3.SS3.p2.8.m8.3.3.4.cmml"><mrow id="S3.SS3.p2.8.m8.1.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.1.cmml"><mi id="S3.SS3.p2.8.m8.1.1.1.1.2" xref="S3.SS3.p2.8.m8.1.1.1.1.2.cmml">w</mi><mo id="S3.SS3.p2.8.m8.1.1.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.1.1.cmml">⁢</mo><mn id="S3.SS3.p2.8.m8.1.1.1.1.3" xref="S3.SS3.p2.8.m8.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS3.p2.8.m8.3.3.3.4" xref="S3.SS3.p2.8.m8.3.3.4.cmml">,</mo><mrow id="S3.SS3.p2.8.m8.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.2.cmml"><mi id="S3.SS3.p2.8.m8.2.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.2.2.cmml">w</mi><mo id="S3.SS3.p2.8.m8.2.2.2.2.1" xref="S3.SS3.p2.8.m8.2.2.2.2.1.cmml">⁢</mo><mn id="S3.SS3.p2.8.m8.2.2.2.2.3" xref="S3.SS3.p2.8.m8.2.2.2.2.3.cmml">2</mn></mrow><mo id="S3.SS3.p2.8.m8.3.3.3.5" xref="S3.SS3.p2.8.m8.3.3.4.cmml">,</mo><mrow id="S3.SS3.p2.8.m8.3.3.3.3" xref="S3.SS3.p2.8.m8.3.3.3.3.cmml"><mi id="S3.SS3.p2.8.m8.3.3.3.3.2" xref="S3.SS3.p2.8.m8.3.3.3.3.2.cmml">w</mi><mo id="S3.SS3.p2.8.m8.3.3.3.3.1" xref="S3.SS3.p2.8.m8.3.3.3.3.1.cmml">⁢</mo><mn id="S3.SS3.p2.8.m8.3.3.3.3.3" xref="S3.SS3.p2.8.m8.3.3.3.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.3b"><list id="S3.SS3.p2.8.m8.3.3.4.cmml" xref="S3.SS3.p2.8.m8.3.3.3"><apply id="S3.SS3.p2.8.m8.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1"><times id="S3.SS3.p2.8.m8.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1"></times><ci id="S3.SS3.p2.8.m8.1.1.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.2">𝑤</ci><cn id="S3.SS3.p2.8.m8.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.p2.8.m8.1.1.1.1.3">1</cn></apply><apply id="S3.SS3.p2.8.m8.2.2.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2"><times id="S3.SS3.p2.8.m8.2.2.2.2.1.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.1"></times><ci id="S3.SS3.p2.8.m8.2.2.2.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2">𝑤</ci><cn id="S3.SS3.p2.8.m8.2.2.2.2.3.cmml" type="integer" xref="S3.SS3.p2.8.m8.2.2.2.2.3">2</cn></apply><apply id="S3.SS3.p2.8.m8.3.3.3.3.cmml" xref="S3.SS3.p2.8.m8.3.3.3.3"><times id="S3.SS3.p2.8.m8.3.3.3.3.1.cmml" xref="S3.SS3.p2.8.m8.3.3.3.3.1"></times><ci id="S3.SS3.p2.8.m8.3.3.3.3.2.cmml" xref="S3.SS3.p2.8.m8.3.3.3.3.2">𝑤</ci><cn id="S3.SS3.p2.8.m8.3.3.3.3.3.cmml" type="integer" xref="S3.SS3.p2.8.m8.3.3.3.3.3">3</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.3c">w1,w2,w3</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m8.3d">italic_w 1 , italic_w 2 , italic_w 3</annotation></semantics></math>. Consequently, not only hardest-negatives, e.g., <math alttext="n1" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m9.1"><semantics id="S3.SS3.p2.9.m9.1a"><mrow id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml"><mi id="S3.SS3.p2.9.m9.1.1.2" xref="S3.SS3.p2.9.m9.1.1.2.cmml">n</mi><mo id="S3.SS3.p2.9.m9.1.1.1" xref="S3.SS3.p2.9.m9.1.1.1.cmml">⁢</mo><mn id="S3.SS3.p2.9.m9.1.1.3" xref="S3.SS3.p2.9.m9.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><apply id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1"><times id="S3.SS3.p2.9.m9.1.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1.1"></times><ci id="S3.SS3.p2.9.m9.1.1.2.cmml" xref="S3.SS3.p2.9.m9.1.1.2">𝑛</ci><cn id="S3.SS3.p2.9.m9.1.1.3.cmml" type="integer" xref="S3.SS3.p2.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">n1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m9.1d">italic_n 1</annotation></semantics></math>, but other non-trivial negatives, e.g., <math alttext="n2" class="ltx_Math" display="inline" id="S3.SS3.p2.10.m10.1"><semantics id="S3.SS3.p2.10.m10.1a"><mrow id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml"><mi id="S3.SS3.p2.10.m10.1.1.2" xref="S3.SS3.p2.10.m10.1.1.2.cmml">n</mi><mo id="S3.SS3.p2.10.m10.1.1.1" xref="S3.SS3.p2.10.m10.1.1.1.cmml">⁢</mo><mn id="S3.SS3.p2.10.m10.1.1.3" xref="S3.SS3.p2.10.m10.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><apply id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1"><times id="S3.SS3.p2.10.m10.1.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1.1"></times><ci id="S3.SS3.p2.10.m10.1.1.2.cmml" xref="S3.SS3.p2.10.m10.1.1.2">𝑛</ci><cn id="S3.SS3.p2.10.m10.1.1.3.cmml" type="integer" xref="S3.SS3.p2.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">n2</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.10.m10.1d">italic_n 2</annotation></semantics></math> and <math alttext="n3" class="ltx_Math" display="inline" id="S3.SS3.p2.11.m11.1"><semantics id="S3.SS3.p2.11.m11.1a"><mrow id="S3.SS3.p2.11.m11.1.1" xref="S3.SS3.p2.11.m11.1.1.cmml"><mi id="S3.SS3.p2.11.m11.1.1.2" xref="S3.SS3.p2.11.m11.1.1.2.cmml">n</mi><mo id="S3.SS3.p2.11.m11.1.1.1" xref="S3.SS3.p2.11.m11.1.1.1.cmml">⁢</mo><mn id="S3.SS3.p2.11.m11.1.1.3" xref="S3.SS3.p2.11.m11.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m11.1b"><apply id="S3.SS3.p2.11.m11.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1"><times id="S3.SS3.p2.11.m11.1.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1.1"></times><ci id="S3.SS3.p2.11.m11.1.1.2.cmml" xref="S3.SS3.p2.11.m11.1.1.2">𝑛</ci><cn id="S3.SS3.p2.11.m11.1.1.3.cmml" type="integer" xref="S3.SS3.p2.11.m11.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m11.1c">n3</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.11.m11.1d">italic_n 3</annotation></semantics></math>, are selected and used in the computations.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">In this section, we introduce the Multi-Margin Loss (MML). We start by discussing the generalization of contrastive loss functions, then we explain the rationale behind the MML function. Finally, we provide a detailed description of the MML function itself.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>The statistics of the datasets</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1.1">
<td class="ltx_td ltx_border_tt" id="S3.T1.1.1.1.1"></td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.2.1">Yelp</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.3.1">Gowalla</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.2.2.1.1">#Users</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.2.2">31,668</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.2.3">29,858</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3.3">
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.3.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.3.3.1.1">#Items</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.3.2">38,048</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.3.3">40,981</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4.4">
<td class="ltx_td ltx_align_center" id="S3.T1.1.4.4.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.4.4.1.1">#Interactions</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.4.4.2">1,561,406</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.4.4.3">1,027,370</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.5.5">
<td class="ltx_td ltx_align_center" id="S3.T1.1.5.5.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.5.5.1.1">#Train</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.5.5.2">1,237,259</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.5.5.3">810,128</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.6.6">
<td class="ltx_td ltx_align_center" id="S3.T1.1.6.6.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.6.6.1.1">#Test</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.6.6.2">324,147</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.6.6.3">217,242</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.7.7.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.7.7.1.1">Density</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.7.7.2">0.00130</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.7.7.3">0.00084</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>Performance comparison of MMCL and CCL on SimpleX and MF architectures
(#Negative samples = 100). Among the all settings, MMCL consistently delivers the best results on the Yelp and Gowalla datasets.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.1" rowspan="2"><span class="ltx_text" id="S3.T2.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.2" rowspan="2"><span class="ltx_text" id="S3.T2.1.1.1.2.1">Loss</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.3" rowspan="2"><span class="ltx_text" id="S3.T2.1.1.1.3.1">Early-stop?</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T2.1.1.1.4">Yelp18</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T2.1.1.1.5">Gowalla</th>
</tr>
<tr class="ltx_tr" id="S3.T2.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.2.2.1">Recall@20</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.2.2.2">Ndcg@20</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.2.2.3">Recall@20</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.2.2.4">Ndcg@20</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.3.1.1" rowspan="4"><span class="ltx_text" id="S3.T2.1.3.1.1.1">SimpleX</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.3.1.2">CCL (2023)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.3.1.3">Y</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.3.1.4">0.0634</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.3.1.5">0.0517</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.3.1.6">0.1622</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.3.1.7">0.1283</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4.2">
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.2.1">CCL (2023)</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.2.2">N</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.2.3">0.0679</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.2.4">0.0555</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.2.5">0.1663</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.2.6">0.1319</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.5.3">
<td class="ltx_td ltx_align_center" id="S3.T2.1.5.3.1">MMCL (2024) - <span class="ltx_text ltx_font_italic" id="S3.T2.1.5.3.1.1">Proposed</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.5.3.2">Y</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.5.3.3">0.0662</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.5.3.4">0.0539</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.5.3.5">0.1723</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.5.3.6">0.1358</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.6.4">
<td class="ltx_td ltx_align_center" id="S3.T2.1.6.4.1">MMCL (2024) - <span class="ltx_text ltx_font_italic" id="S3.T2.1.6.4.1.1">Proposed</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.6.4.2">N</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.6.4.3"><span class="ltx_text ltx_font_bold" id="S3.T2.1.6.4.3.1">0.0706</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.6.4.4"><span class="ltx_text ltx_font_bold" id="S3.T2.1.6.4.4.1">0.0578</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.6.4.5"><span class="ltx_text ltx_font_bold" id="S3.T2.1.6.4.5.1">0.1787</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.6.4.6"><span class="ltx_text ltx_font_bold" id="S3.T2.1.6.4.6.1">0.1412</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.7.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.1.7.5.1" rowspan="4"><span class="ltx_text" id="S3.T2.1.7.5.1.1">MF</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.7.5.2">CCL (2023)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.7.5.3">Y</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.7.5.4">0.0601</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.7.5.5">0.0490</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.7.5.6">0.1632</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.7.5.7">0.1279</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.8.6">
<td class="ltx_td ltx_align_center" id="S3.T2.1.8.6.1">CCL (2023)</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.8.6.2">N</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.8.6.3">0.0673</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.8.6.4">0.0551</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.8.6.5">0.1783</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.8.6.6">0.1426</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.9.7">
<td class="ltx_td ltx_align_center" id="S3.T2.1.9.7.1">MMCL (2024) - <span class="ltx_text ltx_font_italic" id="S3.T2.1.9.7.1.1">Proposed</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.9.7.2">Y</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.9.7.3">0.0674</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.9.7.4">0.0550</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.9.7.5">0.1756</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.9.7.6">0.1370</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.10.8">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.10.8.1">MMCL (2024) - <span class="ltx_text ltx_font_italic" id="S3.T2.1.10.8.1.1">Proposed</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.10.8.2">N</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.10.8.3"><span class="ltx_text ltx_font_bold" id="S3.T2.1.10.8.3.1">0.0702</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.10.8.4"><span class="ltx_text ltx_font_bold" id="S3.T2.1.10.8.4.1">0.0580</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.10.8.5"><span class="ltx_text ltx_font_bold" id="S3.T2.1.10.8.5.1">0.1816</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.10.8.6"><span class="ltx_text ltx_font_bold" id="S3.T2.1.10.8.6.1">0.1435</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3. </span>Training-Runtime Comparison on MF model (Without early-stopping, 100 epochs). MMCL increases training time per epoch by at most 2 seconds on average.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T3.10.10">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.10.10.11.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T3.10.10.11.1.1" rowspan="2"><span class="ltx_text" id="S3.T3.10.10.11.1.1.1">#Negative samples</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T3.10.10.11.1.2" rowspan="2"><span class="ltx_text" id="S3.T3.10.10.11.1.2.1">Loss</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S3.T3.10.10.11.1.3">Yelp18</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S3.T3.10.10.11.1.4">Gowalla</td>
</tr>
<tr class="ltx_tr" id="S3.T3.10.10.12.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.10.10.12.2.1">Time per epoch</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.10.10.12.2.2">Ratio</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.10.10.12.2.3">Total time</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.10.10.12.2.4">Time per epoch</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.10.10.12.2.5">Ratio</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.10.10.12.2.6">Total time</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.1.2" rowspan="2"><span class="ltx_text" id="S3.T3.1.1.1.2.1">800</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.1.3">CCL (2021)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.1.4">77.5 secs</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.1.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.1.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="S3.T3.1.1.1.1.m1.1"><semantics id="S3.T3.1.1.1.1.m1.1a"><mo id="S3.T3.1.1.1.1.m1.1.1" xref="S3.T3.1.1.1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.T3.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T3.1.1.1.1.m1.1.1.cmml" xref="S3.T3.1.1.1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.1.1.1.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S3.T3.1.1.1.1.m1.1d">∼</annotation></semantics></math>129 mins</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.1.6">66 secs</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.1.7">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.1.8">110 mins</td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.3.3">
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.3">MMCL (2024) - <span class="ltx_text ltx_font_italic" id="S3.T3.3.3.3.3.1">Proposed</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.4">78.5 secs</td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.5">+1.3%</td>
<td class="ltx_td ltx_align_center" id="S3.T3.2.2.2.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="S3.T3.2.2.2.1.m1.1"><semantics id="S3.T3.2.2.2.1.m1.1a"><mo id="S3.T3.2.2.2.1.m1.1.1" xref="S3.T3.2.2.2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.T3.2.2.2.1.m1.1b"><csymbol cd="latexml" id="S3.T3.2.2.2.1.m1.1.1.cmml" xref="S3.T3.2.2.2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.2.2.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S3.T3.2.2.2.1.m1.1d">∼</annotation></semantics></math>130 mins</td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.6">64 secs</td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.7">-3.0%</td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.2">
<math alttext="\sim" class="ltx_Math" display="inline" id="S3.T3.3.3.3.2.m1.1"><semantics id="S3.T3.3.3.3.2.m1.1a"><mo id="S3.T3.3.3.3.2.m1.1.1" xref="S3.T3.3.3.3.2.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.T3.3.3.3.2.m1.1b"><csymbol cd="latexml" id="S3.T3.3.3.3.2.m1.1.1.cmml" xref="S3.T3.3.3.3.2.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.3.3.3.2.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S3.T3.3.3.3.2.m1.1d">∼</annotation></semantics></math>107 mins</td>
</tr>
<tr class="ltx_tr" id="S3.T3.5.5.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.5.5.3" rowspan="2"><span class="ltx_text" id="S3.T3.5.5.5.3.1">100</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.5.5.4">CCL (2021)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.5.5.5">35 secs</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.5.5.6">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.4.4.4.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="S3.T3.4.4.4.1.m1.1"><semantics id="S3.T3.4.4.4.1.m1.1a"><mo id="S3.T3.4.4.4.1.m1.1.1" xref="S3.T3.4.4.4.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.T3.4.4.4.1.m1.1b"><csymbol cd="latexml" id="S3.T3.4.4.4.1.m1.1.1.cmml" xref="S3.T3.4.4.4.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.4.4.4.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S3.T3.4.4.4.1.m1.1d">∼</annotation></semantics></math>58 mins</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.5.5.7">37 secs</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.5.5.8">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.5.5.2">
<math alttext="\sim" class="ltx_Math" display="inline" id="S3.T3.5.5.5.2.m1.1"><semantics id="S3.T3.5.5.5.2.m1.1a"><mo id="S3.T3.5.5.5.2.m1.1.1" xref="S3.T3.5.5.5.2.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.T3.5.5.5.2.m1.1b"><csymbol cd="latexml" id="S3.T3.5.5.5.2.m1.1.1.cmml" xref="S3.T3.5.5.5.2.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.5.5.5.2.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S3.T3.5.5.5.2.m1.1d">∼</annotation></semantics></math>62 mins</td>
</tr>
<tr class="ltx_tr" id="S3.T3.7.7.7">
<td class="ltx_td ltx_align_center" id="S3.T3.7.7.7.3">MMCL (2024) - <span class="ltx_text ltx_font_italic" id="S3.T3.7.7.7.3.1">Proposed</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.7.7.4">35 secs</td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.7.7.5">0.0%</td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.6.6.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="S3.T3.6.6.6.1.m1.1"><semantics id="S3.T3.6.6.6.1.m1.1a"><mo id="S3.T3.6.6.6.1.m1.1.1" xref="S3.T3.6.6.6.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.T3.6.6.6.1.m1.1b"><csymbol cd="latexml" id="S3.T3.6.6.6.1.m1.1.1.cmml" xref="S3.T3.6.6.6.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.6.6.6.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S3.T3.6.6.6.1.m1.1d">∼</annotation></semantics></math>58 mins</td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.7.7.6">37.5 secs</td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.7.7.7">+1.4%</td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.7.7.2">
<math alttext="\sim" class="ltx_Math" display="inline" id="S3.T3.7.7.7.2.m1.1"><semantics id="S3.T3.7.7.7.2.m1.1a"><mo id="S3.T3.7.7.7.2.m1.1.1" xref="S3.T3.7.7.7.2.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.T3.7.7.7.2.m1.1b"><csymbol cd="latexml" id="S3.T3.7.7.7.2.m1.1.1.cmml" xref="S3.T3.7.7.7.2.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.7.7.7.2.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S3.T3.7.7.7.2.m1.1d">∼</annotation></semantics></math>63 mins</td>
</tr>
<tr class="ltx_tr" id="S3.T3.9.9.9">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T3.9.9.9.3" rowspan="3"><span class="ltx_text" id="S3.T3.9.9.9.3.1">10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.9.9.9.4">CCL (2021)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.9.9.9.5">31 secs</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.9.9.9.6">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.8.8.8.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="S3.T3.8.8.8.1.m1.1"><semantics id="S3.T3.8.8.8.1.m1.1a"><mo id="S3.T3.8.8.8.1.m1.1.1" xref="S3.T3.8.8.8.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.T3.8.8.8.1.m1.1b"><csymbol cd="latexml" id="S3.T3.8.8.8.1.m1.1.1.cmml" xref="S3.T3.8.8.8.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.8.8.8.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S3.T3.8.8.8.1.m1.1d">∼</annotation></semantics></math>51 mins</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.9.9.9.7">32 secs</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.9.9.9.8">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.9.9.9.2">
<math alttext="\sim" class="ltx_Math" display="inline" id="S3.T3.9.9.9.2.m1.1"><semantics id="S3.T3.9.9.9.2.m1.1a"><mo id="S3.T3.9.9.9.2.m1.1.1" xref="S3.T3.9.9.9.2.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.T3.9.9.9.2.m1.1b"><csymbol cd="latexml" id="S3.T3.9.9.9.2.m1.1.1.cmml" xref="S3.T3.9.9.9.2.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.9.9.9.2.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S3.T3.9.9.9.2.m1.1d">∼</annotation></semantics></math>53 mins</td>
</tr>
<tr class="ltx_tr" id="S3.T3.10.10.10">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.10.10.10.2">MMCL (2024) - <span class="ltx_text ltx_font_italic" id="S3.T3.10.10.10.2.1">Proposed</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.10.10.10.3">33 secs</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.10.10.10.4">+6.5%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.10.10.10.5">55 mins</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.10.10.10.6">33.5 secs</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.10.10.10.7">+4.7%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.10.10.10.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="S3.T3.10.10.10.1.m1.1"><semantics id="S3.T3.10.10.10.1.m1.1a"><mo id="S3.T3.10.10.10.1.m1.1.1" xref="S3.T3.10.10.10.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.T3.10.10.10.1.m1.1b"><csymbol cd="latexml" id="S3.T3.10.10.10.1.m1.1.1.cmml" xref="S3.T3.10.10.10.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.10.10.10.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S3.T3.10.10.10.1.m1.1d">∼</annotation></semantics></math>56 mins</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Evaluation Results</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Evaluation Setup</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">For comparisons,
six loss functions are used: (i) four classical loss functions: BPR, Pairwise Hinge, Softmax Cross-Entropy, and Mean Square Error; (ii) two recently proposed contrastive loss functions: CCL <cite class="ltx_cite ltx_citemacro_citep">(Mao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib19" title="">2021</a>)</cite> and BSL <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib31" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">We use two commonly used datasets in RS, particularly by recent neural-network-based CF models: (i) Yelp2018 <cite class="ltx_cite ltx_citemacro_citep">(Yelp, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib34" title="">2018</a>)</cite><span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Yelp2018: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/datasets/reczoo/Yelp18_m1" title="">https://huggingface.co/datasets/reczoo/Yelp18_m1</a></span></span></span> and (ii) Gowalla <cite class="ltx_cite ltx_citemacro_citep">(Cho et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib5" title="">2011</a>)</cite><span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Gowalla: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/datasets/reczoo/Gowalla_m1" title="">https://huggingface.co/datasets/reczoo/Gowalla_m1</a></span></span></span>.
These datasets are pre-split, pre-processed, and publicly available and their statistics are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S3.T1" title="Table 1 ‣ 3.3. Multi-Margin Cosine Loss ‣ 3. Proposed Loss Function ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">1</span></a>. We use the datasets as is, without any additional preprocessing or filtering based on popularity or cold-start.
All not interacted items are considered candidates, and average results across all users are reported.
Performance is evaluated using Recall and NDCG metrics @20, as used by comparison partners, CCL and BSL.
</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.7">Computations were performed on a P100 GPU with a 30-hour weekly limit, focusing on performance enhancement within this constraint.
The MMCL implementation expanded on SimpleX’s code and is shared online<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>MMCL (Proposed) code: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/mgulcin/mmcl" title="">https://github.com/mgulcin/mmcl</a></span></span></span>.
Experiments using CCL employed SimpleX code<cite class="ltx_cite ltx_citemacro_citep">(Mao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib19" title="">2021</a>)</cite><span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>SimpleX (CCL) <cite class="ltx_cite ltx_citemacro_citep">(Mao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib19" title="">2021</a>)</cite> code: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://reczoo.github.io/SimpleX" title="">https://reczoo.github.io/SimpleX</a></span></span></span> and BSL experiments used BSL code<cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib31" title="">2023</a>)</cite><span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>BSL <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#bib.bib31" title="">2023</a>)</cite> code: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/junkangwu/BSL" title="">https://github.com/junkangwu/BSL</a></span></span></span>. All experiments were rerun, and results are presented below.
Parameters followed the SimpleX paper: Adam optimizer with <math alttext="L_{2}" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><msub id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">L</mi><mn id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝐿</ci><cn id="S4.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">L_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> regularization, a 1e-4 learning rate, a 64 embedding dimension, and 100 epochs.
The batch size was 512 for Yelp and 256 for Gowalla, with regularizers of 1e-09 and 1e-08, respectively.
Results with 100 negative samples are presented, unless otherwise specified.
The MMCL parameters were determined via grid search.
For Yelp, <math alttext="w_{p}" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><msub id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">w</mi><mi id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝑤</ci><ci id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">w_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_w start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>:<math alttext="w_{n}" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><msub id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">w</mi><mi id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2">𝑤</ci><ci id="S4.SS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">w_{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">italic_w start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> ranged from [1:150] to [1:450] in increments of 50, and for Gowalla from [1:500] to [1:1000] in increments of 100.
Margin values started at [0.9] and expanded to [0.5, 0.6, 0.7, 0.8, 0.9]. Margin weights were adjusted with priority given to the highest margin and reductions made proportionally.
As a result, for Yelp, margins set to [0.6, 0.7, 0.8, 0.9] with weights [0.05, 0.15, 0.2, 0.6] and <math alttext="w_{p}" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.1"><semantics id="S4.SS1.p3.4.m4.1a"><msub id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">w</mi><mi id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">𝑤</ci><ci id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">w_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.1d">italic_w start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>:<math alttext="w_{n}" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><msub id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml">w</mi><mi id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2">𝑤</ci><ci id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">w_{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">italic_w start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> set to [1:400]. For Gowalla, margins set to [0.7, 0.8, 0.9] with weights of [0.10, 0.15, 0.75] and <math alttext="w_{p}" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.1"><semantics id="S4.SS1.p3.6.m6.1a"><msub id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml">w</mi><mi id="S4.SS1.p3.6.m6.1.1.3" xref="S4.SS1.p3.6.m6.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2">𝑤</ci><ci id="S4.SS1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">w_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.1d">italic_w start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>:<math alttext="w_{n}" class="ltx_Math" display="inline" id="S4.SS1.p3.7.m7.1"><semantics id="S4.SS1.p3.7.m7.1a"><msub id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml"><mi id="S4.SS1.p3.7.m7.1.1.2" xref="S4.SS1.p3.7.m7.1.1.2.cmml">w</mi><mi id="S4.SS1.p3.7.m7.1.1.3" xref="S4.SS1.p3.7.m7.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.1b"><apply id="S4.SS1.p3.7.m7.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m7.1.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p3.7.m7.1.1.2.cmml" xref="S4.SS1.p3.7.m7.1.1.2">𝑤</ci><ci id="S4.SS1.p3.7.m7.1.1.3.cmml" xref="S4.SS1.p3.7.m7.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.1c">w_{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.7.m7.1d">italic_w start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> set to [1:700].
Baseline loss functions CCL and BSL were rerun using their publicly available code and configurations.
</p>
</div>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4. </span>Performance of MF model with different loss functions (#Negative samples = 100). MMCL performs equally well in recall and Ndcg on the Yelp dataset and achieves the best results in Recall on the Gowalla dataset.
</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T4.1.1.1.1.1">Loss</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T4.1.1.1.2">Yelp18</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T4.1.1.1.3">Gowalla</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.2.1">Recall@20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.2.2">Ndcg@20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.2.3">Recall@20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.2.4">Ndcg@20</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.3.1">BPR Loss</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.3.2">0.0272</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.3.3">0.0216</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.3.4">0.0708</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.3.5">0.0509</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.4.4">
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.1">Pairwise Hinge Loss</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.2">0.0340</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.3">0.0269</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.4">0.0758</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4.5">0.0541</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.5.5">
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.5.1">Softmax Cross-Entropy</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.5.2">0.0309</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.5.3">0.0246</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.5.4">0.0734</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.5.5">0.0543</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.6.6">
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.6.1">Mean Square Error</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.6.2">0.0609</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.6.3">0.0502</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.6.4">0.1391</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.6.5">0.1171</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.7.7.1">CCL (2021)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.7.7.2">0.0673</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.7.7.3">0.0551</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.7.7.4">0.1783</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.7.7.5">0.1426</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.8.8">
<td class="ltx_td ltx_align_center" id="S4.T4.1.8.8.1">BSL (2023)</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.8.8.2"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.8.2.1">0.0703</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.8.8.3"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.8.3.1">0.0580</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.8.8.4">0.1804</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.8.8.5"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.8.5.1">0.1521</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.9.9">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.9.9.1">MMCL (2024) - <span class="ltx_text ltx_font_italic" id="S4.T4.1.9.9.1.1">Proposed</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.9.9.2">0.0702</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.9.9.3"><span class="ltx_text ltx_font_bold" id="S4.T4.1.9.9.3.1">0.0580</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.9.9.4"><span class="ltx_text ltx_font_bold" id="S4.T4.1.9.9.4.1">0.1816</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.9.9.5">0.1435</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="291" id="S4.F3.sf1.g1" src="extracted/5845867/figures/yelp.png" width="240"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Yelp dataset</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="291" id="S4.F3.sf2.g1" src="extracted/5845867/figures/gowalla.png" width="234"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Gowalla dataset</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Performance of MF model under recent loss functions. The proposed MMCL outperforms baseline loss functions when the number of negative samples is 100 or fewer, suggesting it is more efficient in resource-constrained environments.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Evaluation Results</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS2.p1.1.1">Impact of model architecture and early-stopping</span>
SimpleX demonstrated that their CCL loss function, combined with simpler neural network architectures, like SimpleX and Matrix Factorization (MF), outperforms more complex models.
They used early-stopping, which halts training when validation performance no longer improves.
Table <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S3.T2" title="Table 2 ‣ 3.3. Multi-Margin Cosine Loss ‣ 3. Proposed Loss Function ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">2</span></a> compares the performance of CCL and MMCL on SimpleX and MF architectures, with and without early-stopping. With early-stopping, SimpleX architecture concluded after 33 epochs with CCL and 19 epochs with MMCL, while the MF architecture ended after 19 epochs for both loss functions. The table shows that omitting early-stopping results in better performance for both the CCL and MMCL loss functions on both architectures, in our settings.
MMCL consistently delivers the best results on the Yelp and Gowalla datasets.
For Yelp, without early-stopping, MMCL outperforms CCL by 3.98% in recall and 4.14% in Ndcg on SimpleX and by 4.31% in recall and 5.26% in Ndcg on MF.
On Gowalla, MMCL gains 7.46% in recall and 7.05% in Ndcg on SimpleX, and 1.85% in recall and 0.63% in Ndcg on MF.
The relatively lower performance gain on Gowalla is attributed to dataset sparsity, which affects MMCL’s ability to learn sufficiently from positive instances while considering all non-trivial negatives.
</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS2.p2.1.1">Training Runtime Comparison</span>
We compare the training runtime of the CCL and MMCL loss functions using the MF architecture in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S3.T3" title="Table 3 ‣ 3.3. Multi-Margin Cosine Loss ‣ 3. Proposed Loss Function ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">3</span></a>. The table shows the average time per epoch, change ratio and total training time on the Yelp and Gowalla datasets when with different numbers of negative samples. The results indicate that the time per epoch increases as the number of negative samples increases. Training with 800 negative samples takes about 2 hours, while with 100 samples it takes about 1 hour. Comparing CCL and MMCL, using multiple margins has a minor impact, increasing the training time per epoch by no more than 2 seconds on average. This small increase, while utilizing negative samples more efficiently, makes MMCL a promising loss function for RS.
</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS2.p3.1.1">Impact of number of negative samples</span>
One of MMCL’s main objectives is to utilize negative samples better while keeping batch size and number of negatives limited, reducing the memory requirements during training.
We compared recent loss functions against MMCL across various numbers of negative samples, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S4.F3" title="Figure 3 ‣ 4.1. Evaluation Setup ‣ 4. Evaluation Results ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">3</span></a>. MMCL outperforms CCL with many negative samples, though it is not as effective as BSL. However, with 100 or fewer negative samples, MMCL consistently beats the baselines.
With 10 negative samples, MMCL outperforms CCL by 19.5% in recall and 20.13% in Ndcg on Yelp and by 12.99% in recall and 15.07% in Ndcg on Gowalla.
On the Gowalla dataset, MMCL outperforms both CCL and BSL in recall but lags behind BSL in Ndcg. This discrepancy is due to MMCL’s effectiveness in learning from non-trivial negative instances, while dataset sparsity makes it challenging for MMCL to gain sufficient insights from positive instances.
As all loss functions achieve stability with 100 negatives, this value was used throughout the experiments.
</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS2.p4.1.1">Performance comparison of MMCL and various loss functions</span>
The proposed MMCL loss function was compared with various loss functions using the MF architecture as the base model. Table <a class="ltx_ref" href="https://arxiv.org/html/2405.04614v3#S4.T4" title="Table 4 ‣ 4.1. Evaluation Setup ‣ 4. Evaluation Results ‣ Multi-Margin Cosine Loss: Proposal and Application in Recommender Systems"><span class="ltx_text ltx_ref_tag">4</span></a> lists the comparison results.
The first group includes traditional loss functions commonly used in RS, while the second group contains recent state-of-the-art loss functions.
The table shows that BSL is a strong baseline, outperforming MMCL in recall on the Yelp dataset and in Ndcg on the Gowalla dataset.
However, MMCL performs equally well in recall and Ndcg on Yelp and achieves the best results in recall on Gowalla.
MMCL outperforms the best traditional loss function, MSE, by 15.27% in recall and 15.54% in Ndcg on Yelp and 30.55% in recall and 22.54% in Ndcg on Gowalla.
</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Recommender systems (RS) guide users by estimating their preferences using methods like collaborative filtering and deep learning.
While complex neural networks are common in RS, simpler models with effective loss functions can perform equally well or better.
Recent trends focus on optimizing loss functions and negative sampling strategies, emphasizing contrastive learning.
In contrastive learning, it’s crucial to effectively utilize negative samples without requiring significant memory resources.
In order to address the challenges of efficient contrastive learning, we propose a new loss function called Multi-Margin Loss (MML). MML uses all non-trivial instances and assigns weights based on their difficulty, enabling effective learning with fewer or smaller batch sizes. Experiments on two real-world datasets showed that MML performs as well as or better than other loss functions, achieving up to a 20% improvement over baseline contrastive loss functions when fewer number of negative samples are used.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">While MML shows notable performance improvements, particularly with smaller negative sample sets, it could benefit from ideas from other loss functions that address issues in RS like popularity bias and diversification. Future research could also explore applying MML to other domains beyond recommender systems.
</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Barkan and Koenigstein (2016)</span>
<span class="ltx_bibblock">
Oren Barkan and Noam Koenigstein. 2016.

</span>
<span class="ltx_bibblock">Item2vec: neural item embedding for collaborative filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">2016 IEEE 26th International Workshop on Machine Learning for Signal Processing (MLSP)</em>. IEEE, 1–6.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2020b)</span>
<span class="ltx_bibblock">
Chong Chen, Min Zhang, Yongfeng Zhang, Yiqun Liu, and Shaoping Ma. 2020b.

</span>
<span class="ltx_bibblock">Efficient neural matrix factorization without sampling for recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">ACM Transactions on Information Systems (TOIS)</em> 38, 2 (2020), 1–28.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2020a)</span>
<span class="ltx_bibblock">
Lei Chen, Le Wu, Richang Hong, Kun Zhang, and Meng Wang. 2020a.

</span>
<span class="ltx_bibblock">Revisiting graph based collaborative filtering: A linear residual graph convolutional network approach. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the AAAI conference on artificial intelligence</em>, Vol. 34. 27–34.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cho et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Eunjoon Cho, Seth A Myers, and Jure Leskovec. 2011.

</span>
<span class="ltx_bibblock">Friendship and mobility: user movement in location-based social networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Proceedings of the 17th ACM SIGKDD international conference on Knowledge discovery and data mining</em>. 1082–1090.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chopra et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2005)</span>
<span class="ltx_bibblock">
Sumit Chopra, Raia Hadsell, and Yann LeCun. 2005.

</span>
<span class="ltx_bibblock">Learning a similarity metric discriminatively, with application to face verification. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">2005 IEEE computer society conference on computer vision and pattern recognition (CVPR’05)</em>, Vol. 1. IEEE, 539–546.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Jingtao Ding, Yuhan Quan, Xiangnan He, Yong Li, and Depeng Jin. 2019.

</span>
<span class="ltx_bibblock">Reinforced Negative Sampling for Recommendation with Exposure Data.. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">IJCAI</em>. Macao, 2230–2236.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wenqi Fan, Zihuai Zhao, Jiatong Li, Yunqing Liu, Xiaowei Mei, Yiqi Wang, Jiliang Tang, and Qing Li. 2023.

</span>
<span class="ltx_bibblock">Recommender systems in the era of large language models (llms).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">arXiv preprint arXiv:2307.02046</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Zhaolin Gao, Zhaoyue Cheng, Felipe Pérez, Jianing Sun, and Maksims Volkovs. 2022.

</span>
<span class="ltx_bibblock">MCL: Mixed-centric loss for collaborative filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the ACM Web Conference 2022</em>. 2339–2347.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gutmann and Hyvärinen (2010)</span>
<span class="ltx_bibblock">
Michael Gutmann and Aapo Hyvärinen. 2010.

</span>
<span class="ltx_bibblock">Noise-contrastive estimation: A new estimation principle for unnormalized statistical models. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the thirteenth international conference on artificial intelligence and statistics</em>. 297–304.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Jing He, Xin Li, Lejian Liao, Dandan Song, and William K. Cheung. 2016.

</span>
<span class="ltx_bibblock">Inferring a Personalized Next Point-of-Interest Recommendation Model with Latent Behavior Patterns. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of the Thirtieth AAAI Conference on Artificial Intelligence</em> (Phoenix, Arizona, USA). 137–143.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Xiangnan He, Lizi Liao, Hanwang Zhang, Liqiang Nie, Xia Hu, and Tat-Seng Chua. 2017.

</span>
<span class="ltx_bibblock">Neural collaborative filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of the 26th international conference on world wide web</em>. 173–182.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsieh et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Cheng-Kang Hsieh, Longqi Yang, Yin Cui, Tsung-Yi Lin, Serge Belongie, and Deborah Estrin. 2017.

</span>
<span class="ltx_bibblock">Collaborative metric learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">Proceedings of the 26th international conference on world wide web</em>. 193–201.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Binbin Jin, Defu Lian, Zheng Liu, Qi Liu, Jianhui Ma, Xing Xie, and Enhong Chen. 2020.

</span>
<span class="ltx_bibblock">Sampling-decomposable generative adversarial recommender.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Advances in Neural Information Processing Systems</em> 33 (2020), 22629–22639.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Dong Li, Ruoming Jin, and Bin Ren. 2023.

</span>
<span class="ltx_bibblock">Revisiting Recommendation Loss Functions through Contrastive Learning (Technical Report).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">arXiv preprint arXiv:2312.08520</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Xutao Li, Gao Cong, Xiao-Li Li, Tuan-Anh Nguyen Pham, and Shonali Krishnaswamy. 2015.

</span>
<span class="ltx_bibblock">Rank-geofm: A ranking based geographical factorization method for point of interest recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 38th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. ACM, 433–442.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Zelong Li, Jianchao Ji, Yingqiang Ge, and Yongfeng Zhang. 2022.

</span>
<span class="ltx_bibblock">Autolossgen: Automatic loss function generation for recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 1304–1315.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Defu Lian, Qi Liu, and Enhong Chen. 2020.

</span>
<span class="ltx_bibblock">Personalized ranking with importance sampling. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Proceedings of The Web Conference</em>. 1093–1103.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mao et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Kelong Mao, Jieming Zhu, Jinpeng Wang, Quanyu Dai, Zhenhua Dong, Xi Xiao, and Xiuqiang He. 2021.

</span>
<span class="ltx_bibblock">SimpleX: A simple and strong baseline for collaborative filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Proceedings of the 30th ACM International Conference on Information &amp; Knowledge Management</em>. 1243–1252.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Musto et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Cataldo Musto, Tiziano Franza, Giovanni Semeraro, Marco de Gemmis, and Pasquale Lops. 2018.

</span>
<span class="ltx_bibblock">Deep Content-based Recommender Systems Exploiting Recurrent Neural Networks and Linked Open Data. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Adjunct Publication of the 26th Conference on User Modeling, Adaptation and Personalization</em>. ACM, 239–244.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oord et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Aaron van den Oord, Yazhe Li, and Oriol Vinyals. 2018.

</span>
<span class="ltx_bibblock">Representation learning with contrastive predictive coding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">arXiv preprint arXiv:1807.03748</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ozsoy (2016)</span>
<span class="ltx_bibblock">
Makbule Gulcin Ozsoy. 2016.

</span>
<span class="ltx_bibblock">From word embeddings to item recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:1601.01356</em> (2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ozsoy et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Makbule Gulcin Ozsoy, Diarmuid O’Reilly-Morgan, Panagiotis Symeonidis, Elias Z Tragos, Neil Hurley, Barry Smyth, and Aonghus Lawlor. 2020.

</span>
<span class="ltx_bibblock">MP4Rec: Explainable and accurate top-n recommendations in heterogeneous information networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">IEEE Access</em> 8 (2020), 181835–181847.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Seongmin Park, Mincheol Yoon, Jae-woong Lee, Hogun Park, and Jongwuk Lee. 2023.

</span>
<span class="ltx_bibblock">Toward a Better Understanding of Loss Functions for Collaborative Filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">Proceedings of the 32nd ACM International Conference on Information and Knowledge Management</em>. 2034–2043.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2009)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme. 2009.

</span>
<span class="ltx_bibblock">BPR: Bayesian personalized ranking from implicit feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the twenty-fifth conference on uncertainty in artificial intelligence</em>. AUAI Press, 452–461.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schroff et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Florian Schroff, Dmitry Kalenichenko, and James Philbin. 2015.

</span>
<span class="ltx_bibblock">Facenet: A unified embedding for face recognition and clustering. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Proceedings of the IEEE conf. on computer vision and pattern recognition</em>. 815–823.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Bichen Shi, Elias Z Tragos, Makbule Gulcin Ozsoy, Ruihai Dong, Neil Hurley, Barry Smyth, and Aonghus Lawlor. 2021.

</span>
<span class="ltx_bibblock">Dares: an asynchronous distributed recommender system using deep reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">IEEE access</em> 9 (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential recommendation with bidirectional encoder representations from transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>. 1441–1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Peijie Sun, Le Wu, Kun Zhang, Xiangzhi Chen, and Meng Wang. 2023.

</span>
<span class="ltx_bibblock">Neighborhood-Enhanced Supervised Contrastive Learning for Collaborative Filtering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">IEEE Transactions on Knowledge and Data Engineering</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weng (2021)</span>
<span class="ltx_bibblock">
Lilian Weng. 2021.

</span>
<span class="ltx_bibblock">Contrastive Representation Learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">lilianweng.github.io</em> (May 2021).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://lilianweng.github.io/posts/2021-05-31-contrastive/" title="">https://lilianweng.github.io/posts/2021-05-31-contrastive/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Junkang Wu, Jiawei Chen, Jiancan Wu, Wentao Shi, Jizhi Zhang, and Xiang Wang. 2023.

</span>
<span class="ltx_bibblock">BSL: Understanding and Improving Softmax Loss for Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">arXiv preprint arXiv:2312.12882</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jiancan Wu, Xiang Wang, Xingyu Gao, Jiawei Chen, Hongcheng Fu, Tianyu Qiu, and Xiangnan He. 2022.

</span>
<span class="ltx_bibblock">On the effectiveness of sampled softmax loss for item recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">ACM Transactions on Information Systems</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zhen Yang, Ming Ding, Tinglin Huang, Yukuo Cen, Junshuai Song, Bin Xu, Yuxiao Dong, and Jie Tang. 2024.

</span>
<span class="ltx_bibblock">Does Negative Sampling Matter? A Review with Insights into its Theory and Applications.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">IEEE Transactions on Pattern Analysis and Machine Intelligence</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yelp (2018)</span>
<span class="ltx_bibblock">
Yelp. 2018.

</span>
<span class="ltx_bibblock">Yelp2018 Dataset.

</span>
<span class="ltx_bibblock">(2018).

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.yelp.com/dataset" title="">https://www.yelp.com/dataset</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
An Zhang, Wenchang Ma, Xiang Wang, and Tat-Seng Chua. 2022.

</span>
<span class="ltx_bibblock">Incorporating bias-aware margins into contrastive loss for collaborative filtering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">Advances in Neural Information Processing Systems</em> 35 (2022), 7866–7878.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
An Zhang, Leheng Sheng, Zhibo Cai, Xiang Wang, and Tat-Seng Chua. 2024.

</span>
<span class="ltx_bibblock">Empowering Collaborative Filtering with Principled Adversarial Contrastive Loss.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Advances in Neural Information Processing Systems</em> 36 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2013)</span>
<span class="ltx_bibblock">
Weinan Zhang, Tianqi Chen, Jun Wang, and Yong Yu. 2013.

</span>
<span class="ltx_bibblock">Optimizing top-n collaborative filtering via dynamic negative item sampling. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">Proceedings of the 36th international ACM SIGIR conference on Research and development in information retrieval</em>. 785–788.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xiangyu Zhao, Haochen Liu, Wenqi Fan, Hui Liu, Jiliang Tang, and Chong Wang. 2021.

</span>
<span class="ltx_bibblock">Autoloss: Automated loss function search in recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery &amp; Data Mining</em>. 3959–3967.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guanjie Zheng, Fuzheng Zhang, Zihan Zheng, Yang Xiang, Nicholas Jing Yuan, Xing Xie, and Zhenhui Li. 2018.

</span>
<span class="ltx_bibblock">DRN: A deep reinforcement learning framework for news recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">Proc. of the world wide web conference</em>. 167–176.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuo et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jianhuan Zhuo, Qiannan Zhu, Yinliang Yue, and Yuhong Zhao. 2022.

</span>
<span class="ltx_bibblock">Learning explicit user interest boundary for recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Proceedings of the ACM Web Conference 2022</em>. 193–202.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Sep 10 14:35:21 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
