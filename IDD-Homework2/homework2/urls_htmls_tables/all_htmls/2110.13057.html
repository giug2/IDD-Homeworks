<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2110.13057] Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models</title><meta property="og:description" content="Federated learning has quickly gained popularity with its promises of increased user privacy and efficiency. Previous works have shown that federated gradient updates contain information that can be used to approximate…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2110.13057">

<!--Generated on Sun Mar  3 23:32:34 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Liam Fowl

<br class="ltx_break">Department of Mathematics 
<br class="ltx_break">University of Maryland 
<br class="ltx_break">&amp;Jonas Geiping<sup id="id2.2.id1" class="ltx_sup">∗</sup>

<br class="ltx_break">Department of Computer Science 
<br class="ltx_break">University of Maryland 
<br class="ltx_break"><span id="id3.3.id2" class="ltx_ERROR undefined">\AND</span>Wojtek Czaja

<br class="ltx_break">Department of Mathematics 
<br class="ltx_break">University of Maryland
&amp;Micah Goldblum

<br class="ltx_break">Center for Data Science 
<br class="ltx_break">New York University
&amp;Tom Goldstein

<br class="ltx_break">Department of Computer Science 
<br class="ltx_break">University of Maryland
</span><span class="ltx_author_notes">Authors contributed equally. Order chosen alphabetically.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Federated learning has quickly gained popularity with its promises of increased user privacy and efficiency. Previous works have shown that federated gradient updates contain information that can be used to approximately recover user data in some situations. These previous attacks on user privacy have been limited in scope and do not scale to gradient updates aggregated over even a handful of data points, leaving some to conclude that data privacy is still intact for realistic training regimes.
In this work, we introduce a new threat model based on minimal but malicious modifications of the shared model architecture which enable the server to directly obtain a verbatim copy of user data from gradient updates without solving difficult inverse problems. Even user data aggregated over large batches – where previous methods fail to extract meaningful content – can be reconstructed by these minimally modified models.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Federated learning <cite class="ltx_cite ltx_citemacro_citep">(Konečný et al., <a href="#bib.bib15" title="" class="ltx_ref">2015</a>)</cite>, also known as collaborative learning <cite class="ltx_cite ltx_citemacro_citep">(Shokri &amp; Shmatikov, <a href="#bib.bib30" title="" class="ltx_ref">2015</a>)</cite>, is a mechanism for training machine learning models in a distributed fashion on multiple user devices. In the simplest setting, a central <span id="S1.p1.1.1" class="ltx_text ltx_font_italic">server</span> sends out model states to a group of <span id="S1.p1.1.2" class="ltx_text ltx_font_italic">users</span>, who compute an update to the model based on their local data. These updates are then returned to the server, aggregated, and used to train the model. Over multiple rounds, this protocol can train a machine learning model, distributed over all users, without exchanging local data – only model updates are exchanged.
Two central goals of federated learning are to improve training efficiency by decreasing communication overhead and to side-step issues of user-level privacy and data access rights that have become a focus of public attention in recent years <cite class="ltx_cite ltx_citemacro_citep">(Veale et al., <a href="#bib.bib34" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Accordingly, many organizations, ranging from large tech companies <cite class="ltx_cite ltx_citemacro_citep">(McMahan &amp; Ramage, <a href="#bib.bib17" title="" class="ltx_ref">2017</a>)</cite> to medical institutions with especially strict privacy laws, such as hospitals <cite class="ltx_cite ltx_citemacro_citep">(Jochems et al., <a href="#bib.bib13" title="" class="ltx_ref">2016</a>)</cite>, have utilized federated learning to train machine learning models.
However, in practice, data privacy is not guaranteed in general, but is dependent on a large number of interdependent settings and design choices specific to each federated learning system. In this work, we focus on the user perspective of privacy, and we study federated learning systems in which the central server is not able to directly view user data.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">The key privacy concern for users is whether model updates reveal too much about the data on which they were calculated. Although <cite class="ltx_cite ltx_citemacro_citet">Kairouz et al. (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite> discuss that “model updates are more focused on the learning task at hand than is the raw data (i.e. they contain strictly no additional information about the user, and typically significantly less, compared to the raw data)”, scenarios can be constructed in which the model updates themselves can be inverted to recover their input user information <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib37" title="" class="ltx_ref">2018</a>; Melis et al., <a href="#bib.bib19" title="" class="ltx_ref">2018</a>)</cite>. Simple knowledge of the shared model state and model update can be sufficient for such an attack <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib43" title="" class="ltx_ref">2019</a>; Geiping et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>. These inversion attacks are particularly fruitful if a user’s model update is based on a single data point or only a small batch.
Accordingly, a strong defense against these attacks is aggregation. The user only reports model updates aggregated over a significant number of local data points, and data from multiple users can be combined with secure aggregation protocols <cite class="ltx_cite ltx_citemacro_citep">(Bonawitz et al., <a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite> before being passed to the server. This ability to aggregate user updates while maintaining their utility is thought to be the main source of security in federated learning. Averaging raw local data in similar amounts would make it unusable for training, but model updates can be effectively aggregated.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">Previous inversion attacks typically focus on a threat model in which the server (server here is a stand-in for any party with root access to the server or its incoming and outgoing communication) is interested in uncovering user information by examining updates, but without modifying the federated learning protocol, a behavior also referred to as <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">honest-but-curious</span> or <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">semi-honest</span> <cite class="ltx_cite ltx_citemacro_citep">(Goldreich, <a href="#bib.bib9" title="" class="ltx_ref">2009</a>)</cite>. In our case, where the party intending to recover user data <em id="S1.p4.1.3" class="ltx_emph ltx_font_italic">is</em> the server, this “honest” scenario appears contrived, as the server can modify its behavior to obtain private information.
In this work, we are thus interested in explicitly <span id="S1.p4.1.4" class="ltx_text ltx_font_italic">malicious servers</span> that may modify the model architecture and model parameters sent to the user.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">We focus on scenarios in which an agent obtains data without making suspicious changes to the client code or learning behavior.
One scenario which enables this threat model involves recently introduced APIs that allow organizations to train their own models using established federated learning protocols <cite class="ltx_cite ltx_citemacro_citep">(Cason, <a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite>.
In this environment, a malicious API participant can change their model’s architecture and parameters but cannot force unsuspecting edge devices to send user data directly.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">We introduce minimal changes to model architectures that enable servers to breach user privacy, even in the face of large aggregations that have been previously deemed secure. These changes induce a structured pattern in the model update, where parts of the update contain information only about a fixed subset of data points. The constituent data points can then be recovered exactly, while evading existing aggregation defenses. For architectures that already contain large linear layers, the attack even works directly, modifying only the parameters of these layers.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Limitations of Existing Attack Strategies</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">A range of possible attacks against privacy in federated learning have been proposed in recent literature. In the simplest case of <span id="S2.p1.1.1" class="ltx_text ltx_font_italic">analytic attacks</span>, <cite class="ltx_cite ltx_citemacro_citet">Phong et al. (<a href="#bib.bib24" title="" class="ltx_ref">2017b</a>)</cite> were among the first to discuss that the input to a learnable affine function can be directly computed from the gradient of its weights and bias, and additional analysis of this case can be found in <cite class="ltx_cite ltx_citemacro_citet">Qian &amp; Hansen (<a href="#bib.bib25" title="" class="ltx_ref">2020</a>); Fan et al. (<a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite>, and in <a href="#S3.SS2" title="3.2 A Simple Example ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3.2</span></a>. However, analytic recovery of this kind only succeeds for a single data point. For multiple data points, only the average of their inputs can be recovered, leading the attack to fail in most realistic scenarios.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_italic">Recursive attacks</span> as proposed in <cite class="ltx_cite ltx_citemacro_citet">Zhu &amp; Blaschko (<a href="#bib.bib42" title="" class="ltx_ref">2021</a>)</cite> can extend analytic attacks to models with more than only linear layers - a construction also mentioned in <cite class="ltx_cite ltx_citemacro_cite">Fan et al. (<a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite>. However, these attacks still recover only the average of inputs in the best case. Improvements in <cite class="ltx_cite ltx_citemacro_citet">Pan et al. (<a href="#bib.bib21" title="" class="ltx_ref">2020</a>)</cite> transform linear layers with ReLU activations into systems of linear equations that allow for a degree of recovery for batched inputs to these linear layers, although preceding convolutional layers still have to be deconvolved by recursion or numerical inversion techniques.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.4" class="ltx_p">Surprisingly, <span id="S2.p3.4.1" class="ltx_text ltx_font_italic">optimization-based attacks</span> turn out to be highly effective in inverting model updates. <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a href="#bib.bib37" title="" class="ltx_ref">2018</a>)</cite> propose the direct recovery of input information in a setting where the users’ model update is the model parameter gradient averaged over local data. In a supervised learning setting, we define this update by <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S2.p3.1.m1.1a"><mi id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">g</annotation></semantics></math> and the loss function over this model by <math id="S2.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S2.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\mathcal{L}</annotation></semantics></math> with model parameters <math id="S2.p3.3.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.p3.3.m3.1a"><mi id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><ci id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">\theta</annotation></semantics></math> and data points <math id="S2.p3.4.m4.4" class="ltx_Math" alttext="(x,y)\in[0,1]^{n}\times\mathbb{R}^{m}" display="inline"><semantics id="S2.p3.4.m4.4a"><mrow id="S2.p3.4.m4.4.5" xref="S2.p3.4.m4.4.5.cmml"><mrow id="S2.p3.4.m4.4.5.2.2" xref="S2.p3.4.m4.4.5.2.1.cmml"><mo stretchy="false" id="S2.p3.4.m4.4.5.2.2.1" xref="S2.p3.4.m4.4.5.2.1.cmml">(</mo><mi id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml">x</mi><mo id="S2.p3.4.m4.4.5.2.2.2" xref="S2.p3.4.m4.4.5.2.1.cmml">,</mo><mi id="S2.p3.4.m4.2.2" xref="S2.p3.4.m4.2.2.cmml">y</mi><mo stretchy="false" id="S2.p3.4.m4.4.5.2.2.3" xref="S2.p3.4.m4.4.5.2.1.cmml">)</mo></mrow><mo id="S2.p3.4.m4.4.5.1" xref="S2.p3.4.m4.4.5.1.cmml">∈</mo><mrow id="S2.p3.4.m4.4.5.3" xref="S2.p3.4.m4.4.5.3.cmml"><msup id="S2.p3.4.m4.4.5.3.2" xref="S2.p3.4.m4.4.5.3.2.cmml"><mrow id="S2.p3.4.m4.4.5.3.2.2.2" xref="S2.p3.4.m4.4.5.3.2.2.1.cmml"><mo stretchy="false" id="S2.p3.4.m4.4.5.3.2.2.2.1" xref="S2.p3.4.m4.4.5.3.2.2.1.cmml">[</mo><mn id="S2.p3.4.m4.3.3" xref="S2.p3.4.m4.3.3.cmml">0</mn><mo id="S2.p3.4.m4.4.5.3.2.2.2.2" xref="S2.p3.4.m4.4.5.3.2.2.1.cmml">,</mo><mn id="S2.p3.4.m4.4.4" xref="S2.p3.4.m4.4.4.cmml">1</mn><mo rspace="0.055em" stretchy="false" id="S2.p3.4.m4.4.5.3.2.2.2.3" xref="S2.p3.4.m4.4.5.3.2.2.1.cmml">]</mo></mrow><mi id="S2.p3.4.m4.4.5.3.2.3" xref="S2.p3.4.m4.4.5.3.2.3.cmml">n</mi></msup><mo rspace="0.222em" id="S2.p3.4.m4.4.5.3.1" xref="S2.p3.4.m4.4.5.3.1.cmml">×</mo><msup id="S2.p3.4.m4.4.5.3.3" xref="S2.p3.4.m4.4.5.3.3.cmml"><mi id="S2.p3.4.m4.4.5.3.3.2" xref="S2.p3.4.m4.4.5.3.3.2.cmml">ℝ</mi><mi id="S2.p3.4.m4.4.5.3.3.3" xref="S2.p3.4.m4.4.5.3.3.3.cmml">m</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.4b"><apply id="S2.p3.4.m4.4.5.cmml" xref="S2.p3.4.m4.4.5"><in id="S2.p3.4.m4.4.5.1.cmml" xref="S2.p3.4.m4.4.5.1"></in><interval closure="open" id="S2.p3.4.m4.4.5.2.1.cmml" xref="S2.p3.4.m4.4.5.2.2"><ci id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1">𝑥</ci><ci id="S2.p3.4.m4.2.2.cmml" xref="S2.p3.4.m4.2.2">𝑦</ci></interval><apply id="S2.p3.4.m4.4.5.3.cmml" xref="S2.p3.4.m4.4.5.3"><times id="S2.p3.4.m4.4.5.3.1.cmml" xref="S2.p3.4.m4.4.5.3.1"></times><apply id="S2.p3.4.m4.4.5.3.2.cmml" xref="S2.p3.4.m4.4.5.3.2"><csymbol cd="ambiguous" id="S2.p3.4.m4.4.5.3.2.1.cmml" xref="S2.p3.4.m4.4.5.3.2">superscript</csymbol><interval closure="closed" id="S2.p3.4.m4.4.5.3.2.2.1.cmml" xref="S2.p3.4.m4.4.5.3.2.2.2"><cn type="integer" id="S2.p3.4.m4.3.3.cmml" xref="S2.p3.4.m4.3.3">0</cn><cn type="integer" id="S2.p3.4.m4.4.4.cmml" xref="S2.p3.4.m4.4.4">1</cn></interval><ci id="S2.p3.4.m4.4.5.3.2.3.cmml" xref="S2.p3.4.m4.4.5.3.2.3">𝑛</ci></apply><apply id="S2.p3.4.m4.4.5.3.3.cmml" xref="S2.p3.4.m4.4.5.3.3"><csymbol cd="ambiguous" id="S2.p3.4.m4.4.5.3.3.1.cmml" xref="S2.p3.4.m4.4.5.3.3">superscript</csymbol><ci id="S2.p3.4.m4.4.5.3.3.2.cmml" xref="S2.p3.4.m4.4.5.3.3.2">ℝ</ci><ci id="S2.p3.4.m4.4.5.3.3.3.cmml" xref="S2.p3.4.m4.4.5.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.4c">(x,y)\in[0,1]^{n}\times\mathbb{R}^{m}</annotation></semantics></math>. The server can then attempt recovery by solving the gradient matching problem of</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.6" class="ltx_Math" alttext="\min_{x\in[0,1]^{n}}||\nabla_{\theta}\mathcal{L}(x,y,\theta)-g||^{2}" display="block"><semantics id="S2.E1.m1.6a"><mrow id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml"><munder id="S2.E1.m1.6.6.3" xref="S2.E1.m1.6.6.3.cmml"><mi id="S2.E1.m1.6.6.3.2" xref="S2.E1.m1.6.6.3.2.cmml">min</mi><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><mi id="S2.E1.m1.2.2.2.4" xref="S2.E1.m1.2.2.2.4.cmml">x</mi><mo id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml">∈</mo><msup id="S2.E1.m1.2.2.2.5" xref="S2.E1.m1.2.2.2.5.cmml"><mrow id="S2.E1.m1.2.2.2.5.2.2" xref="S2.E1.m1.2.2.2.5.2.1.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.2.5.2.2.1" xref="S2.E1.m1.2.2.2.5.2.1.cmml">[</mo><mn id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">0</mn><mo id="S2.E1.m1.2.2.2.5.2.2.2" xref="S2.E1.m1.2.2.2.5.2.1.cmml">,</mo><mn id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">1</mn><mo stretchy="false" id="S2.E1.m1.2.2.2.5.2.2.3" xref="S2.E1.m1.2.2.2.5.2.1.cmml">]</mo></mrow><mi id="S2.E1.m1.2.2.2.5.3" xref="S2.E1.m1.2.2.2.5.3.cmml">n</mi></msup></mrow></munder><mo lspace="0em" rspace="0em" id="S2.E1.m1.6.6.2" xref="S2.E1.m1.6.6.2.cmml">​</mo><msup id="S2.E1.m1.6.6.1" xref="S2.E1.m1.6.6.1.cmml"><mrow id="S2.E1.m1.6.6.1.1.1" xref="S2.E1.m1.6.6.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.6.6.1.1.1.2" xref="S2.E1.m1.6.6.1.1.2.1.cmml">‖</mo><mrow id="S2.E1.m1.6.6.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.cmml"><mrow id="S2.E1.m1.6.6.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.2.cmml"><mrow id="S2.E1.m1.6.6.1.1.1.1.2.2" xref="S2.E1.m1.6.6.1.1.1.1.2.2.cmml"><msub id="S2.E1.m1.6.6.1.1.1.1.2.2.1" xref="S2.E1.m1.6.6.1.1.1.1.2.2.1.cmml"><mo rspace="0.167em" id="S2.E1.m1.6.6.1.1.1.1.2.2.1.2" xref="S2.E1.m1.6.6.1.1.1.1.2.2.1.2.cmml">∇</mo><mi id="S2.E1.m1.6.6.1.1.1.1.2.2.1.3" xref="S2.E1.m1.6.6.1.1.1.1.2.2.1.3.cmml">θ</mi></msub><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.6.6.1.1.1.1.2.2.2" xref="S2.E1.m1.6.6.1.1.1.1.2.2.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.6.6.1.1.1.1.2.1" xref="S2.E1.m1.6.6.1.1.1.1.2.1.cmml">​</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.2.3.2" xref="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.6.6.1.1.1.1.2.3.2.1" xref="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml">(</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">x</mi><mo id="S2.E1.m1.6.6.1.1.1.1.2.3.2.2" xref="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml">,</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">y</mi><mo id="S2.E1.m1.6.6.1.1.1.1.2.3.2.3" xref="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml">,</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">θ</mi><mo stretchy="false" id="S2.E1.m1.6.6.1.1.1.1.2.3.2.4" xref="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.6.6.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.cmml">−</mo><mi id="S2.E1.m1.6.6.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.3.cmml">g</mi></mrow><mo stretchy="false" id="S2.E1.m1.6.6.1.1.1.3" xref="S2.E1.m1.6.6.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E1.m1.6.6.1.3" xref="S2.E1.m1.6.6.1.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.6b"><apply id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6"><times id="S2.E1.m1.6.6.2.cmml" xref="S2.E1.m1.6.6.2"></times><apply id="S2.E1.m1.6.6.3.cmml" xref="S2.E1.m1.6.6.3"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.3.1.cmml" xref="S2.E1.m1.6.6.3">subscript</csymbol><min id="S2.E1.m1.6.6.3.2.cmml" xref="S2.E1.m1.6.6.3.2"></min><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><in id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3"></in><ci id="S2.E1.m1.2.2.2.4.cmml" xref="S2.E1.m1.2.2.2.4">𝑥</ci><apply id="S2.E1.m1.2.2.2.5.cmml" xref="S2.E1.m1.2.2.2.5"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.5.1.cmml" xref="S2.E1.m1.2.2.2.5">superscript</csymbol><interval closure="closed" id="S2.E1.m1.2.2.2.5.2.1.cmml" xref="S2.E1.m1.2.2.2.5.2.2"><cn type="integer" id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">0</cn><cn type="integer" id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2">1</cn></interval><ci id="S2.E1.m1.2.2.2.5.3.cmml" xref="S2.E1.m1.2.2.2.5.3">𝑛</ci></apply></apply></apply><apply id="S2.E1.m1.6.6.1.cmml" xref="S2.E1.m1.6.6.1"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.2.cmml" xref="S2.E1.m1.6.6.1">superscript</csymbol><apply id="S2.E1.m1.6.6.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.6.6.1.1.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.2">norm</csymbol><apply id="S2.E1.m1.6.6.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1"><minus id="S2.E1.m1.6.6.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1"></minus><apply id="S2.E1.m1.6.6.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2"><times id="S2.E1.m1.6.6.1.1.1.1.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.1"></times><apply id="S2.E1.m1.6.6.1.1.1.1.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.2"><apply id="S2.E1.m1.6.6.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.2.2.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.2.1">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.2.2.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.2.1.2">∇</ci><ci id="S2.E1.m1.6.6.1.1.1.1.2.2.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.2.1.3">𝜃</ci></apply><ci id="S2.E1.m1.6.6.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.2.2">ℒ</ci></apply><vector id="S2.E1.m1.6.6.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2.3.2"><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑥</ci><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝑦</ci><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝜃</ci></vector></apply><ci id="S2.E1.m1.6.6.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.3">𝑔</ci></apply></apply><cn type="integer" id="S2.E1.m1.6.6.1.3.cmml" xref="S2.E1.m1.6.6.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.6c">\min_{x\in[0,1]^{n}}||\nabla_{\theta}\mathcal{L}(x,y,\theta)-g||^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p3.5" class="ltx_p">and solve this optimization objective using first-order methods or any nonlinear equation solver. Subsequent work in <cite class="ltx_cite ltx_citemacro_citet">Zhu et al. (<a href="#bib.bib43" title="" class="ltx_ref">2019</a>); Zhao et al. (<a href="#bib.bib41" title="" class="ltx_ref">2020</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Wainakh et al. (<a href="#bib.bib35" title="" class="ltx_ref">2021</a>)</cite> proposes solutions that also handle recovery of targets <math id="S2.p3.5.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.p3.5.m1.1a"><mi id="S2.p3.5.m1.1.1" xref="S2.p3.5.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p3.5.m1.1b"><ci id="S2.p3.5.m1.1.1.cmml" xref="S2.p3.5.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m1.1c">y</annotation></semantics></math> and variants of this objective are solved for example in <cite class="ltx_cite ltx_citemacro_citet">Geiping et al. (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite> with cosine similarity and improved optimization and in <cite class="ltx_cite ltx_citemacro_citet">Jeon et al. (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite> with additional generative image priors. Reconstruction of input images can be further boosted by additional regularizers as in <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Qian et al. (<a href="#bib.bib26" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p">Most attacks in the literature focus on the described <span id="S2.p4.1.1" class="ltx_text ltx_font_italic">fedSGD</span> setting <cite class="ltx_cite ltx_citemacro_citep">(Konečný et al., <a href="#bib.bib15" title="" class="ltx_ref">2015</a>)</cite> in which the users return gradient information to the server, but numerical attacks can also be performed against local updates with multiple local steps <cite class="ltx_cite ltx_citemacro_cite">Geiping et al. (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>, for example against <span id="S2.p4.1.2" class="ltx_text ltx_font_italic">fedAVG</span> <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite>. In this work, we will discuss both update schemes, noting that gradient aggregation in “time”, with multiple local update steps, is not fundamentally more secure than aggregation over multiple data points. Previous attacks also focus significantly on learning scenarios where the user data is comprised of images. This is an advantage to the attacker, given that image data is highly structured, and a multitude of image priors are known and can be employed to improve reconstruction. In contrast, data types with weaker structure, such as tabular data, do not lend themselves to regularization based on strong priors, and we will show that our approach, on the other hand, does not rely on such tricks, and is therefore more data-agnostic.</p>
</div>
<div id="S2.p5" class="ltx_para ltx_noindent">
<p id="S2.p5.2" class="ltx_p">The central limitation of these attack mechanisms is the degradation of attack success when user data is aggregated over even moderately large batches of data (either by the user themselves or by secure aggregation). State-of-the-art attacks such as <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite> recover only <math id="S2.p5.1.m1.1" class="ltx_Math" alttext="28\%" display="inline"><semantics id="S2.p5.1.m1.1a"><mrow id="S2.p5.1.m1.1.1" xref="S2.p5.1.m1.1.1.cmml"><mn id="S2.p5.1.m1.1.1.2" xref="S2.p5.1.m1.1.1.2.cmml">28</mn><mo id="S2.p5.1.m1.1.1.1" xref="S2.p5.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.1b"><apply id="S2.p5.1.m1.1.1.cmml" xref="S2.p5.1.m1.1.1"><csymbol cd="latexml" id="S2.p5.1.m1.1.1.1.cmml" xref="S2.p5.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S2.p5.1.m1.1.1.2.cmml" xref="S2.p5.1.m1.1.1.2">28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.1c">28\%</annotation></semantics></math> of the user data (given a charitable measure of recovery) on a batch size of <math id="S2.p5.2.m2.1" class="ltx_Math" alttext="48" display="inline"><semantics id="S2.p5.2.m2.1a"><mn id="S2.p5.2.m2.1.1" xref="S2.p5.2.m2.1.1.cmml">48</mn><annotation-xml encoding="MathML-Content" id="S2.p5.2.m2.1b"><cn type="integer" id="S2.p5.2.m2.1.1.cmml" xref="S2.p5.2.m2.1.1">48</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.2.m2.1c">48</annotation></semantics></math> for a ResNet-50 <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a href="#bib.bib10" title="" class="ltx_ref">2015</a>)</cite> model on ImageNet (ILSVRC2012 <cite class="ltx_cite ltx_citemacro_citep">(Russakovsky et al., <a href="#bib.bib29" title="" class="ltx_ref">2015</a>)</cite>) with unlikely label collisions. The rate of images that can be successfully recovered drops drastically with increased batch sizes. Even without label collisions, large networks such as a ResNet-32-10 <cite class="ltx_cite ltx_citemacro_citep">(Zagoruyko &amp; Komodakis, <a href="#bib.bib39" title="" class="ltx_ref">2016</a>)</cite> leak only a few samples for a batch size of 128 in <cite class="ltx_cite ltx_citemacro_citet">Geiping et al. (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>. These attacks further reconstruct only approximations to the actual user data which can fail to recover parts of the user data or replace it with likely but unrelated information in the case of strong image priors.</p>
</div>
<div id="S2.p6" class="ltx_para ltx_noindent">
<p id="S2.p6.1" class="ltx_p">Further, although all of the previous works nominally operate under an <span id="S2.p6.1.1" class="ltx_text ltx_font_italic">honest-but-curious</span> server model, they do often contain model adaptations on which reconstruction works especially well, such as large vision models with large gradient vectors, models with many features <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib37" title="" class="ltx_ref">2018</a>; Zhu &amp; Blaschko, <a href="#bib.bib42" title="" class="ltx_ref">2021</a>)</cite>, special activation functions <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib43" title="" class="ltx_ref">2019</a>; Zhu &amp; Blaschko, <a href="#bib.bib42" title="" class="ltx_ref">2021</a>)</cite>, wide models <cite class="ltx_cite ltx_citemacro_citep">(Geiping et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>, or models trained with representation learning <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a href="#bib.bib38" title="" class="ltx_ref">2021</a>; Chen et al., <a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite>. These may be seen as <span id="S2.p6.1.2" class="ltx_text ltx_font_italic">malicious</span> models with architectural choices that breach user privacy. In the same vein, we ask, what is the worst-case (but small) modification that can be applied to a neural network to break privacy?</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Model Modifications</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">In this section, we detail an example of a small model modification that has a major effect on user privacy, even allowing for the direct recovery of verbatim user data from model updates.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Threat Model</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.4" class="ltx_p">We define two parties: the server <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{S}</annotation></semantics></math> and the users <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{U}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{U}</annotation></semantics></math>. The server could be a tech company, a third party app using a federated learning framework on a mobile platform, or an organization like a hospital. The server <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">S</annotation></semantics></math> defines a model architecture and distributes parameters <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\theta</annotation></semantics></math> for this architecture to the users, who compute local updates and return them to the server. The server cannot deviate from standard federated learning protocol in ways beyond changes to model architecture (within limits imposed by common ML frameworks) and model parameters. We measure the strength of a malicious modification of the architecture using the number of additional parameters inserted into the model. While it is clear that models with more parameters can leak more information, we will see that clever attacks can have a disproportionate effect on attack success, compared to more benign increases in parameter count, such as when model width is increased.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>A Simple Example</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.7" class="ltx_p">To motivate the introduction of malicious modifications, we start with the simple case of a fully connected layer.
A forward pass on this layer is written as <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="y=Wx+b" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">y</mi><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mrow id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2.2" xref="S3.SS2.p1.1.m1.1.1.3.2.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.1.3.2.1" xref="S3.SS2.p1.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S3.SS2.p1.1.m1.1.1.3.2.3" xref="S3.SS2.p1.1.m1.1.1.3.2.3.cmml">x</mi></mrow><mo id="S3.SS2.p1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">+</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">b</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><eq id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></eq><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑦</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><plus id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1"></plus><apply id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2"><times id="S3.SS2.p1.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.2">𝑊</ci><ci id="S3.SS2.p1.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.3">𝑥</ci></apply><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">y=Wx+b</annotation></semantics></math> where <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">W</annotation></semantics></math> is a weight matrix, <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">b</annotation></semantics></math> is a bias, and <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">x</annotation></semantics></math> is the layer’s input. As seen in <cite class="ltx_cite ltx_citemacro_cite">Phong et al. (<a href="#bib.bib23" title="" class="ltx_ref">2017a</a>); Qian &amp; Hansen (<a href="#bib.bib25" title="" class="ltx_ref">2020</a>); Fan et al. (<a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite>, when the parameters of the network are updated according to some objective <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\mathcal{L}</annotation></semantics></math>, the <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msup id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">i</mi><mrow id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.3.2" xref="S3.SS2.p1.6.m6.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.1.1.3.1" xref="S3.SS2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.6.m6.1.1.3.3" xref="S3.SS2.p1.6.m6.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝑖</ci><apply id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3"><times id="S3.SS2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.3.1"></times><ci id="S3.SS2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.3.2">𝑡</ci><ci id="S3.SS2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">i^{th}</annotation></semantics></math> row of the update to <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">W</annotation></semantics></math>:</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\nabla_{W^{i}}\mathcal{L}=\frac{\partial\mathcal{L}}{\partial y^{i}}\cdot\nabla_{W^{i}}y^{i}=\frac{\partial\mathcal{L}}{\partial y^{i}}\cdot x," display="block"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.2.cmml"><msub id="S3.Ex1.m1.1.1.1.1.2.1" xref="S3.Ex1.m1.1.1.1.1.2.1.cmml"><mo id="S3.Ex1.m1.1.1.1.1.2.1.2" xref="S3.Ex1.m1.1.1.1.1.2.1.2.cmml">∇</mo><msup id="S3.Ex1.m1.1.1.1.1.2.1.3" xref="S3.Ex1.m1.1.1.1.1.2.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.2.1.3.2" xref="S3.Ex1.m1.1.1.1.1.2.1.3.2.cmml">W</mi><mi id="S3.Ex1.m1.1.1.1.1.2.1.3.3" xref="S3.Ex1.m1.1.1.1.1.2.1.3.3.cmml">i</mi></msup></msub><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.1.1.1.1.2.2" xref="S3.Ex1.m1.1.1.1.1.2.2.cmml">ℒ</mi></mrow><mo id="S3.Ex1.m1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.1.1.4" xref="S3.Ex1.m1.1.1.1.1.4.cmml"><mfrac id="S3.Ex1.m1.1.1.1.1.4.2" xref="S3.Ex1.m1.1.1.1.1.4.2.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.4.2.2" xref="S3.Ex1.m1.1.1.1.1.4.2.2.cmml"><mo rspace="0em" id="S3.Ex1.m1.1.1.1.1.4.2.2.1" xref="S3.Ex1.m1.1.1.1.1.4.2.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.1.1.1.1.4.2.2.2" xref="S3.Ex1.m1.1.1.1.1.4.2.2.2.cmml">ℒ</mi></mrow><mrow id="S3.Ex1.m1.1.1.1.1.4.2.3" xref="S3.Ex1.m1.1.1.1.1.4.2.3.cmml"><mo rspace="0em" id="S3.Ex1.m1.1.1.1.1.4.2.3.1" xref="S3.Ex1.m1.1.1.1.1.4.2.3.1.cmml">∂</mo><msup id="S3.Ex1.m1.1.1.1.1.4.2.3.2" xref="S3.Ex1.m1.1.1.1.1.4.2.3.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.4.2.3.2.2" xref="S3.Ex1.m1.1.1.1.1.4.2.3.2.2.cmml">y</mi><mi id="S3.Ex1.m1.1.1.1.1.4.2.3.2.3" xref="S3.Ex1.m1.1.1.1.1.4.2.3.2.3.cmml">i</mi></msup></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.Ex1.m1.1.1.1.1.4.1" xref="S3.Ex1.m1.1.1.1.1.4.1.cmml">⋅</mo><mrow id="S3.Ex1.m1.1.1.1.1.4.3" xref="S3.Ex1.m1.1.1.1.1.4.3.cmml"><msub id="S3.Ex1.m1.1.1.1.1.4.3.1" xref="S3.Ex1.m1.1.1.1.1.4.3.1.cmml"><mo rspace="0.167em" id="S3.Ex1.m1.1.1.1.1.4.3.1.2" xref="S3.Ex1.m1.1.1.1.1.4.3.1.2.cmml">∇</mo><msup id="S3.Ex1.m1.1.1.1.1.4.3.1.3" xref="S3.Ex1.m1.1.1.1.1.4.3.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.4.3.1.3.2" xref="S3.Ex1.m1.1.1.1.1.4.3.1.3.2.cmml">W</mi><mi id="S3.Ex1.m1.1.1.1.1.4.3.1.3.3" xref="S3.Ex1.m1.1.1.1.1.4.3.1.3.3.cmml">i</mi></msup></msub><msup id="S3.Ex1.m1.1.1.1.1.4.3.2" xref="S3.Ex1.m1.1.1.1.1.4.3.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.4.3.2.2" xref="S3.Ex1.m1.1.1.1.1.4.3.2.2.cmml">y</mi><mi id="S3.Ex1.m1.1.1.1.1.4.3.2.3" xref="S3.Ex1.m1.1.1.1.1.4.3.2.3.cmml">i</mi></msup></mrow></mrow><mo id="S3.Ex1.m1.1.1.1.1.5" xref="S3.Ex1.m1.1.1.1.1.5.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.1.1.6" xref="S3.Ex1.m1.1.1.1.1.6.cmml"><mfrac id="S3.Ex1.m1.1.1.1.1.6.2" xref="S3.Ex1.m1.1.1.1.1.6.2.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.6.2.2" xref="S3.Ex1.m1.1.1.1.1.6.2.2.cmml"><mo rspace="0em" id="S3.Ex1.m1.1.1.1.1.6.2.2.1" xref="S3.Ex1.m1.1.1.1.1.6.2.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.1.1.1.1.6.2.2.2" xref="S3.Ex1.m1.1.1.1.1.6.2.2.2.cmml">ℒ</mi></mrow><mrow id="S3.Ex1.m1.1.1.1.1.6.2.3" xref="S3.Ex1.m1.1.1.1.1.6.2.3.cmml"><mo rspace="0em" id="S3.Ex1.m1.1.1.1.1.6.2.3.1" xref="S3.Ex1.m1.1.1.1.1.6.2.3.1.cmml">∂</mo><msup id="S3.Ex1.m1.1.1.1.1.6.2.3.2" xref="S3.Ex1.m1.1.1.1.1.6.2.3.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.6.2.3.2.2" xref="S3.Ex1.m1.1.1.1.1.6.2.3.2.2.cmml">y</mi><mi id="S3.Ex1.m1.1.1.1.1.6.2.3.2.3" xref="S3.Ex1.m1.1.1.1.1.6.2.3.2.3.cmml">i</mi></msup></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.Ex1.m1.1.1.1.1.6.1" xref="S3.Ex1.m1.1.1.1.1.6.1.cmml">⋅</mo><mi id="S3.Ex1.m1.1.1.1.1.6.3" xref="S3.Ex1.m1.1.1.1.1.6.3.cmml">x</mi></mrow></mrow><mo id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><and id="S3.Ex1.m1.1.1.1.1a.cmml" xref="S3.Ex1.m1.1.1.1"></and><apply id="S3.Ex1.m1.1.1.1.1b.cmml" xref="S3.Ex1.m1.1.1.1"><eq id="S3.Ex1.m1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3"></eq><apply id="S3.Ex1.m1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2"><apply id="S3.Ex1.m1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.2.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.2.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.1.2">∇</ci><apply id="S3.Ex1.m1.1.1.1.1.2.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.2.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.2.1.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.2.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.1.3.2">𝑊</ci><ci id="S3.Ex1.m1.1.1.1.1.2.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.2.1.3.3">𝑖</ci></apply></apply><ci id="S3.Ex1.m1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2.2">ℒ</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.4.cmml" xref="S3.Ex1.m1.1.1.1.1.4"><ci id="S3.Ex1.m1.1.1.1.1.4.1.cmml" xref="S3.Ex1.m1.1.1.1.1.4.1">⋅</ci><apply id="S3.Ex1.m1.1.1.1.1.4.2.cmml" xref="S3.Ex1.m1.1.1.1.1.4.2"><divide id="S3.Ex1.m1.1.1.1.1.4.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.4.2"></divide><apply id="S3.Ex1.m1.1.1.1.1.4.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.4.2.2"><partialdiff id="S3.Ex1.m1.1.1.1.1.4.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.4.2.2.1"></partialdiff><ci id="S3.Ex1.m1.1.1.1.1.4.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.4.2.2.2">ℒ</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.4.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.4.2.3"><partialdiff id="S3.Ex1.m1.1.1.1.1.4.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.4.2.3.1"></partialdiff><apply id="S3.Ex1.m1.1.1.1.1.4.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.4.2.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.4.2.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.4.2.3.2">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.4.2.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.4.2.3.2.2">𝑦</ci><ci id="S3.Ex1.m1.1.1.1.1.4.2.3.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.4.2.3.2.3">𝑖</ci></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.4.3.cmml" xref="S3.Ex1.m1.1.1.1.1.4.3"><apply id="S3.Ex1.m1.1.1.1.1.4.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.4.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.4.3.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.4.3.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.4.3.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.4.3.1.2">∇</ci><apply id="S3.Ex1.m1.1.1.1.1.4.3.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.4.3.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.4.3.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.4.3.1.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.4.3.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.4.3.1.3.2">𝑊</ci><ci id="S3.Ex1.m1.1.1.1.1.4.3.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.4.3.1.3.3">𝑖</ci></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.4.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.4.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.4.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.4.3.2">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.4.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.4.3.2.2">𝑦</ci><ci id="S3.Ex1.m1.1.1.1.1.4.3.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.4.3.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1c.cmml" xref="S3.Ex1.m1.1.1.1"><eq id="S3.Ex1.m1.1.1.1.1.5.cmml" xref="S3.Ex1.m1.1.1.1.1.5"></eq><share href="#S3.Ex1.m1.1.1.1.1.4.cmml" id="S3.Ex1.m1.1.1.1.1d.cmml" xref="S3.Ex1.m1.1.1.1"></share><apply id="S3.Ex1.m1.1.1.1.1.6.cmml" xref="S3.Ex1.m1.1.1.1.1.6"><ci id="S3.Ex1.m1.1.1.1.1.6.1.cmml" xref="S3.Ex1.m1.1.1.1.1.6.1">⋅</ci><apply id="S3.Ex1.m1.1.1.1.1.6.2.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2"><divide id="S3.Ex1.m1.1.1.1.1.6.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2"></divide><apply id="S3.Ex1.m1.1.1.1.1.6.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2.2"><partialdiff id="S3.Ex1.m1.1.1.1.1.6.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2.2.1"></partialdiff><ci id="S3.Ex1.m1.1.1.1.1.6.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2.2.2">ℒ</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.6.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2.3"><partialdiff id="S3.Ex1.m1.1.1.1.1.6.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2.3.1"></partialdiff><apply id="S3.Ex1.m1.1.1.1.1.6.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.6.2.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2.3.2">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.6.2.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2.3.2.2">𝑦</ci><ci id="S3.Ex1.m1.1.1.1.1.6.2.3.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2.3.2.3">𝑖</ci></apply></apply></apply><ci id="S3.Ex1.m1.1.1.1.1.6.3.cmml" xref="S3.Ex1.m1.1.1.1.1.6.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\nabla_{W^{i}}\mathcal{L}=\frac{\partial\mathcal{L}}{\partial y^{i}}\cdot\nabla_{W^{i}}y^{i}=\frac{\partial\mathcal{L}}{\partial y^{i}}\cdot x,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.8" class="ltx_p">where we use the shorthand <math id="S3.SS2.p1.8.m1.3" class="ltx_Math" alttext="\mathcal{L}=\mathcal{L}(x;W,b)" display="inline"><semantics id="S3.SS2.p1.8.m1.3a"><mrow id="S3.SS2.p1.8.m1.3.4" xref="S3.SS2.p1.8.m1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.8.m1.3.4.2" xref="S3.SS2.p1.8.m1.3.4.2.cmml">ℒ</mi><mo id="S3.SS2.p1.8.m1.3.4.1" xref="S3.SS2.p1.8.m1.3.4.1.cmml">=</mo><mrow id="S3.SS2.p1.8.m1.3.4.3" xref="S3.SS2.p1.8.m1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.8.m1.3.4.3.2" xref="S3.SS2.p1.8.m1.3.4.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.8.m1.3.4.3.1" xref="S3.SS2.p1.8.m1.3.4.3.1.cmml">​</mo><mrow id="S3.SS2.p1.8.m1.3.4.3.3.2" xref="S3.SS2.p1.8.m1.3.4.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.8.m1.3.4.3.3.2.1" xref="S3.SS2.p1.8.m1.3.4.3.3.1.cmml">(</mo><mi id="S3.SS2.p1.8.m1.1.1" xref="S3.SS2.p1.8.m1.1.1.cmml">x</mi><mo id="S3.SS2.p1.8.m1.3.4.3.3.2.2" xref="S3.SS2.p1.8.m1.3.4.3.3.1.cmml">;</mo><mi id="S3.SS2.p1.8.m1.2.2" xref="S3.SS2.p1.8.m1.2.2.cmml">W</mi><mo id="S3.SS2.p1.8.m1.3.4.3.3.2.3" xref="S3.SS2.p1.8.m1.3.4.3.3.1.cmml">,</mo><mi id="S3.SS2.p1.8.m1.3.3" xref="S3.SS2.p1.8.m1.3.3.cmml">b</mi><mo stretchy="false" id="S3.SS2.p1.8.m1.3.4.3.3.2.4" xref="S3.SS2.p1.8.m1.3.4.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m1.3b"><apply id="S3.SS2.p1.8.m1.3.4.cmml" xref="S3.SS2.p1.8.m1.3.4"><eq id="S3.SS2.p1.8.m1.3.4.1.cmml" xref="S3.SS2.p1.8.m1.3.4.1"></eq><ci id="S3.SS2.p1.8.m1.3.4.2.cmml" xref="S3.SS2.p1.8.m1.3.4.2">ℒ</ci><apply id="S3.SS2.p1.8.m1.3.4.3.cmml" xref="S3.SS2.p1.8.m1.3.4.3"><times id="S3.SS2.p1.8.m1.3.4.3.1.cmml" xref="S3.SS2.p1.8.m1.3.4.3.1"></times><ci id="S3.SS2.p1.8.m1.3.4.3.2.cmml" xref="S3.SS2.p1.8.m1.3.4.3.2">ℒ</ci><list id="S3.SS2.p1.8.m1.3.4.3.3.1.cmml" xref="S3.SS2.p1.8.m1.3.4.3.3.2"><ci id="S3.SS2.p1.8.m1.1.1.cmml" xref="S3.SS2.p1.8.m1.1.1">𝑥</ci><ci id="S3.SS2.p1.8.m1.2.2.cmml" xref="S3.SS2.p1.8.m1.2.2">𝑊</ci><ci id="S3.SS2.p1.8.m1.3.3.cmml" xref="S3.SS2.p1.8.m1.3.3">𝑏</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m1.3c">\mathcal{L}=\mathcal{L}(x;W,b)</annotation></semantics></math>. Similarly,</p>
<table id="S3.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex2.m1.1" class="ltx_Math" alttext="\frac{\partial\mathcal{L}}{\partial b^{i}}=\frac{\partial\mathcal{L}}{\partial y^{i}}\frac{\partial y^{i}}{\partial b^{i}}=\frac{\partial\mathcal{L}}{\partial y^{i}}." display="block"><semantics id="S3.Ex2.m1.1a"><mrow id="S3.Ex2.m1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.cmml"><mrow id="S3.Ex2.m1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.cmml"><mfrac id="S3.Ex2.m1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.2.cmml"><mrow id="S3.Ex2.m1.1.1.1.1.2.2" xref="S3.Ex2.m1.1.1.1.1.2.2.cmml"><mo rspace="0em" id="S3.Ex2.m1.1.1.1.1.2.2.1" xref="S3.Ex2.m1.1.1.1.1.2.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.1.1.1.1.2.2.2" xref="S3.Ex2.m1.1.1.1.1.2.2.2.cmml">ℒ</mi></mrow><mrow id="S3.Ex2.m1.1.1.1.1.2.3" xref="S3.Ex2.m1.1.1.1.1.2.3.cmml"><mo rspace="0em" id="S3.Ex2.m1.1.1.1.1.2.3.1" xref="S3.Ex2.m1.1.1.1.1.2.3.1.cmml">∂</mo><msup id="S3.Ex2.m1.1.1.1.1.2.3.2" xref="S3.Ex2.m1.1.1.1.1.2.3.2.cmml"><mi id="S3.Ex2.m1.1.1.1.1.2.3.2.2" xref="S3.Ex2.m1.1.1.1.1.2.3.2.2.cmml">b</mi><mi id="S3.Ex2.m1.1.1.1.1.2.3.2.3" xref="S3.Ex2.m1.1.1.1.1.2.3.2.3.cmml">i</mi></msup></mrow></mfrac><mo id="S3.Ex2.m1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.Ex2.m1.1.1.1.1.4" xref="S3.Ex2.m1.1.1.1.1.4.cmml"><mfrac id="S3.Ex2.m1.1.1.1.1.4.2" xref="S3.Ex2.m1.1.1.1.1.4.2.cmml"><mrow id="S3.Ex2.m1.1.1.1.1.4.2.2" xref="S3.Ex2.m1.1.1.1.1.4.2.2.cmml"><mo rspace="0em" id="S3.Ex2.m1.1.1.1.1.4.2.2.1" xref="S3.Ex2.m1.1.1.1.1.4.2.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.1.1.1.1.4.2.2.2" xref="S3.Ex2.m1.1.1.1.1.4.2.2.2.cmml">ℒ</mi></mrow><mrow id="S3.Ex2.m1.1.1.1.1.4.2.3" xref="S3.Ex2.m1.1.1.1.1.4.2.3.cmml"><mo rspace="0em" id="S3.Ex2.m1.1.1.1.1.4.2.3.1" xref="S3.Ex2.m1.1.1.1.1.4.2.3.1.cmml">∂</mo><msup id="S3.Ex2.m1.1.1.1.1.4.2.3.2" xref="S3.Ex2.m1.1.1.1.1.4.2.3.2.cmml"><mi id="S3.Ex2.m1.1.1.1.1.4.2.3.2.2" xref="S3.Ex2.m1.1.1.1.1.4.2.3.2.2.cmml">y</mi><mi id="S3.Ex2.m1.1.1.1.1.4.2.3.2.3" xref="S3.Ex2.m1.1.1.1.1.4.2.3.2.3.cmml">i</mi></msup></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.1.1.1.1.4.1" xref="S3.Ex2.m1.1.1.1.1.4.1.cmml">​</mo><mfrac id="S3.Ex2.m1.1.1.1.1.4.3" xref="S3.Ex2.m1.1.1.1.1.4.3.cmml"><mrow id="S3.Ex2.m1.1.1.1.1.4.3.2" xref="S3.Ex2.m1.1.1.1.1.4.3.2.cmml"><mo rspace="0em" id="S3.Ex2.m1.1.1.1.1.4.3.2.1" xref="S3.Ex2.m1.1.1.1.1.4.3.2.1.cmml">∂</mo><msup id="S3.Ex2.m1.1.1.1.1.4.3.2.2" xref="S3.Ex2.m1.1.1.1.1.4.3.2.2.cmml"><mi id="S3.Ex2.m1.1.1.1.1.4.3.2.2.2" xref="S3.Ex2.m1.1.1.1.1.4.3.2.2.2.cmml">y</mi><mi id="S3.Ex2.m1.1.1.1.1.4.3.2.2.3" xref="S3.Ex2.m1.1.1.1.1.4.3.2.2.3.cmml">i</mi></msup></mrow><mrow id="S3.Ex2.m1.1.1.1.1.4.3.3" xref="S3.Ex2.m1.1.1.1.1.4.3.3.cmml"><mo rspace="0em" id="S3.Ex2.m1.1.1.1.1.4.3.3.1" xref="S3.Ex2.m1.1.1.1.1.4.3.3.1.cmml">∂</mo><msup id="S3.Ex2.m1.1.1.1.1.4.3.3.2" xref="S3.Ex2.m1.1.1.1.1.4.3.3.2.cmml"><mi id="S3.Ex2.m1.1.1.1.1.4.3.3.2.2" xref="S3.Ex2.m1.1.1.1.1.4.3.3.2.2.cmml">b</mi><mi id="S3.Ex2.m1.1.1.1.1.4.3.3.2.3" xref="S3.Ex2.m1.1.1.1.1.4.3.3.2.3.cmml">i</mi></msup></mrow></mfrac></mrow><mo id="S3.Ex2.m1.1.1.1.1.5" xref="S3.Ex2.m1.1.1.1.1.5.cmml">=</mo><mfrac id="S3.Ex2.m1.1.1.1.1.6" xref="S3.Ex2.m1.1.1.1.1.6.cmml"><mrow id="S3.Ex2.m1.1.1.1.1.6.2" xref="S3.Ex2.m1.1.1.1.1.6.2.cmml"><mo rspace="0em" id="S3.Ex2.m1.1.1.1.1.6.2.1" xref="S3.Ex2.m1.1.1.1.1.6.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.1.1.1.1.6.2.2" xref="S3.Ex2.m1.1.1.1.1.6.2.2.cmml">ℒ</mi></mrow><mrow id="S3.Ex2.m1.1.1.1.1.6.3" xref="S3.Ex2.m1.1.1.1.1.6.3.cmml"><mo rspace="0em" id="S3.Ex2.m1.1.1.1.1.6.3.1" xref="S3.Ex2.m1.1.1.1.1.6.3.1.cmml">∂</mo><msup id="S3.Ex2.m1.1.1.1.1.6.3.2" xref="S3.Ex2.m1.1.1.1.1.6.3.2.cmml"><mi id="S3.Ex2.m1.1.1.1.1.6.3.2.2" xref="S3.Ex2.m1.1.1.1.1.6.3.2.2.cmml">y</mi><mi id="S3.Ex2.m1.1.1.1.1.6.3.2.3" xref="S3.Ex2.m1.1.1.1.1.6.3.2.3.cmml">i</mi></msup></mrow></mfrac></mrow><mo lspace="0em" id="S3.Ex2.m1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><apply id="S3.Ex2.m1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1"><and id="S3.Ex2.m1.1.1.1.1a.cmml" xref="S3.Ex2.m1.1.1.1"></and><apply id="S3.Ex2.m1.1.1.1.1b.cmml" xref="S3.Ex2.m1.1.1.1"><eq id="S3.Ex2.m1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.3"></eq><apply id="S3.Ex2.m1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.2"><divide id="S3.Ex2.m1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.2"></divide><apply id="S3.Ex2.m1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.2.2"><partialdiff id="S3.Ex2.m1.1.1.1.1.2.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.2.2.1"></partialdiff><ci id="S3.Ex2.m1.1.1.1.1.2.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.2.2.2">ℒ</ci></apply><apply id="S3.Ex2.m1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.2.3"><partialdiff id="S3.Ex2.m1.1.1.1.1.2.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.2.3.1"></partialdiff><apply id="S3.Ex2.m1.1.1.1.1.2.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.2.3.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.2.3.2">superscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.2.3.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.2.3.2.2">𝑏</ci><ci id="S3.Ex2.m1.1.1.1.1.2.3.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.2.3.2.3">𝑖</ci></apply></apply></apply><apply id="S3.Ex2.m1.1.1.1.1.4.cmml" xref="S3.Ex2.m1.1.1.1.1.4"><times id="S3.Ex2.m1.1.1.1.1.4.1.cmml" xref="S3.Ex2.m1.1.1.1.1.4.1"></times><apply id="S3.Ex2.m1.1.1.1.1.4.2.cmml" xref="S3.Ex2.m1.1.1.1.1.4.2"><divide id="S3.Ex2.m1.1.1.1.1.4.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.4.2"></divide><apply id="S3.Ex2.m1.1.1.1.1.4.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.4.2.2"><partialdiff id="S3.Ex2.m1.1.1.1.1.4.2.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.4.2.2.1"></partialdiff><ci id="S3.Ex2.m1.1.1.1.1.4.2.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.4.2.2.2">ℒ</ci></apply><apply id="S3.Ex2.m1.1.1.1.1.4.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.4.2.3"><partialdiff id="S3.Ex2.m1.1.1.1.1.4.2.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.4.2.3.1"></partialdiff><apply id="S3.Ex2.m1.1.1.1.1.4.2.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.4.2.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.4.2.3.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.4.2.3.2">superscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.4.2.3.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.4.2.3.2.2">𝑦</ci><ci id="S3.Ex2.m1.1.1.1.1.4.2.3.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.4.2.3.2.3">𝑖</ci></apply></apply></apply><apply id="S3.Ex2.m1.1.1.1.1.4.3.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3"><divide id="S3.Ex2.m1.1.1.1.1.4.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3"></divide><apply id="S3.Ex2.m1.1.1.1.1.4.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3.2"><partialdiff id="S3.Ex2.m1.1.1.1.1.4.3.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3.2.1"></partialdiff><apply id="S3.Ex2.m1.1.1.1.1.4.3.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.4.3.2.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3.2.2">superscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.4.3.2.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3.2.2.2">𝑦</ci><ci id="S3.Ex2.m1.1.1.1.1.4.3.2.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3.2.2.3">𝑖</ci></apply></apply><apply id="S3.Ex2.m1.1.1.1.1.4.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3.3"><partialdiff id="S3.Ex2.m1.1.1.1.1.4.3.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3.3.1"></partialdiff><apply id="S3.Ex2.m1.1.1.1.1.4.3.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.4.3.3.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3.3.2">superscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.4.3.3.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3.3.2.2">𝑏</ci><ci id="S3.Ex2.m1.1.1.1.1.4.3.3.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.4.3.3.2.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S3.Ex2.m1.1.1.1.1c.cmml" xref="S3.Ex2.m1.1.1.1"><eq id="S3.Ex2.m1.1.1.1.1.5.cmml" xref="S3.Ex2.m1.1.1.1.1.5"></eq><share href="#S3.Ex2.m1.1.1.1.1.4.cmml" id="S3.Ex2.m1.1.1.1.1d.cmml" xref="S3.Ex2.m1.1.1.1"></share><apply id="S3.Ex2.m1.1.1.1.1.6.cmml" xref="S3.Ex2.m1.1.1.1.1.6"><divide id="S3.Ex2.m1.1.1.1.1.6.1.cmml" xref="S3.Ex2.m1.1.1.1.1.6"></divide><apply id="S3.Ex2.m1.1.1.1.1.6.2.cmml" xref="S3.Ex2.m1.1.1.1.1.6.2"><partialdiff id="S3.Ex2.m1.1.1.1.1.6.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.6.2.1"></partialdiff><ci id="S3.Ex2.m1.1.1.1.1.6.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.6.2.2">ℒ</ci></apply><apply id="S3.Ex2.m1.1.1.1.1.6.3.cmml" xref="S3.Ex2.m1.1.1.1.1.6.3"><partialdiff id="S3.Ex2.m1.1.1.1.1.6.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.6.3.1"></partialdiff><apply id="S3.Ex2.m1.1.1.1.1.6.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.6.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.6.3.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.6.3.2">superscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.6.3.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.6.3.2.2">𝑦</ci><ci id="S3.Ex2.m1.1.1.1.1.6.3.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.6.3.2.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\frac{\partial\mathcal{L}}{\partial b^{i}}=\frac{\partial\mathcal{L}}{\partial y^{i}}\frac{\partial y^{i}}{\partial b^{i}}=\frac{\partial\mathcal{L}}{\partial y^{i}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.11" class="ltx_p">So as long as there exists some index <math id="S3.SS2.p1.9.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.9.m1.1a"><mi id="S3.SS2.p1.9.m1.1.1" xref="S3.SS2.p1.9.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m1.1b"><ci id="S3.SS2.p1.9.m1.1.1.cmml" xref="S3.SS2.p1.9.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m1.1c">i</annotation></semantics></math> with <math id="S3.SS2.p1.10.m2.1" class="ltx_Math" alttext="\frac{\partial\mathcal{L}}{\partial b^{i}}\neq 0" display="inline"><semantics id="S3.SS2.p1.10.m2.1a"><mrow id="S3.SS2.p1.10.m2.1.1" xref="S3.SS2.p1.10.m2.1.1.cmml"><mfrac id="S3.SS2.p1.10.m2.1.1.2" xref="S3.SS2.p1.10.m2.1.1.2.cmml"><mrow id="S3.SS2.p1.10.m2.1.1.2.2" xref="S3.SS2.p1.10.m2.1.1.2.2.cmml"><mo rspace="0em" id="S3.SS2.p1.10.m2.1.1.2.2.1" xref="S3.SS2.p1.10.m2.1.1.2.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.10.m2.1.1.2.2.2" xref="S3.SS2.p1.10.m2.1.1.2.2.2.cmml">ℒ</mi></mrow><mrow id="S3.SS2.p1.10.m2.1.1.2.3" xref="S3.SS2.p1.10.m2.1.1.2.3.cmml"><mo rspace="0em" id="S3.SS2.p1.10.m2.1.1.2.3.1" xref="S3.SS2.p1.10.m2.1.1.2.3.1.cmml">∂</mo><msup id="S3.SS2.p1.10.m2.1.1.2.3.2" xref="S3.SS2.p1.10.m2.1.1.2.3.2.cmml"><mi id="S3.SS2.p1.10.m2.1.1.2.3.2.2" xref="S3.SS2.p1.10.m2.1.1.2.3.2.2.cmml">b</mi><mi id="S3.SS2.p1.10.m2.1.1.2.3.2.3" xref="S3.SS2.p1.10.m2.1.1.2.3.2.3.cmml">i</mi></msup></mrow></mfrac><mo id="S3.SS2.p1.10.m2.1.1.1" xref="S3.SS2.p1.10.m2.1.1.1.cmml">≠</mo><mn id="S3.SS2.p1.10.m2.1.1.3" xref="S3.SS2.p1.10.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m2.1b"><apply id="S3.SS2.p1.10.m2.1.1.cmml" xref="S3.SS2.p1.10.m2.1.1"><neq id="S3.SS2.p1.10.m2.1.1.1.cmml" xref="S3.SS2.p1.10.m2.1.1.1"></neq><apply id="S3.SS2.p1.10.m2.1.1.2.cmml" xref="S3.SS2.p1.10.m2.1.1.2"><divide id="S3.SS2.p1.10.m2.1.1.2.1.cmml" xref="S3.SS2.p1.10.m2.1.1.2"></divide><apply id="S3.SS2.p1.10.m2.1.1.2.2.cmml" xref="S3.SS2.p1.10.m2.1.1.2.2"><partialdiff id="S3.SS2.p1.10.m2.1.1.2.2.1.cmml" xref="S3.SS2.p1.10.m2.1.1.2.2.1"></partialdiff><ci id="S3.SS2.p1.10.m2.1.1.2.2.2.cmml" xref="S3.SS2.p1.10.m2.1.1.2.2.2">ℒ</ci></apply><apply id="S3.SS2.p1.10.m2.1.1.2.3.cmml" xref="S3.SS2.p1.10.m2.1.1.2.3"><partialdiff id="S3.SS2.p1.10.m2.1.1.2.3.1.cmml" xref="S3.SS2.p1.10.m2.1.1.2.3.1"></partialdiff><apply id="S3.SS2.p1.10.m2.1.1.2.3.2.cmml" xref="S3.SS2.p1.10.m2.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m2.1.1.2.3.2.1.cmml" xref="S3.SS2.p1.10.m2.1.1.2.3.2">superscript</csymbol><ci id="S3.SS2.p1.10.m2.1.1.2.3.2.2.cmml" xref="S3.SS2.p1.10.m2.1.1.2.3.2.2">𝑏</ci><ci id="S3.SS2.p1.10.m2.1.1.2.3.2.3.cmml" xref="S3.SS2.p1.10.m2.1.1.2.3.2.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.SS2.p1.10.m2.1.1.3.cmml" xref="S3.SS2.p1.10.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m2.1c">\frac{\partial\mathcal{L}}{\partial b^{i}}\neq 0</annotation></semantics></math>,
the single input <math id="S3.SS2.p1.11.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p1.11.m3.1a"><mi id="S3.SS2.p1.11.m3.1.1" xref="S3.SS2.p1.11.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m3.1b"><ci id="S3.SS2.p1.11.m3.1.1.cmml" xref="S3.SS2.p1.11.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m3.1c">x</annotation></semantics></math> is recovered perfectly as:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="x=\nabla_{W^{i}}\mathcal{L}\oslash\frac{\partial\mathcal{L}}{\partial b^{i}}" display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">x</mi><mo id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml"><msub id="S3.E2.m1.1.1.3.1" xref="S3.E2.m1.1.1.3.1.cmml"><mo rspace="0.167em" id="S3.E2.m1.1.1.3.1.2" xref="S3.E2.m1.1.1.3.1.2.cmml">∇</mo><msup id="S3.E2.m1.1.1.3.1.3" xref="S3.E2.m1.1.1.3.1.3.cmml"><mi id="S3.E2.m1.1.1.3.1.3.2" xref="S3.E2.m1.1.1.3.1.3.2.cmml">W</mi><mi id="S3.E2.m1.1.1.3.1.3.3" xref="S3.E2.m1.1.1.3.1.3.3.cmml">i</mi></msup></msub><mrow id="S3.E2.m1.1.1.3.2" xref="S3.E2.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.3.2.2" xref="S3.E2.m1.1.1.3.2.2.cmml">ℒ</mi><mo id="S3.E2.m1.1.1.3.2.1" xref="S3.E2.m1.1.1.3.2.1.cmml">⊘</mo><mfrac id="S3.E2.m1.1.1.3.2.3" xref="S3.E2.m1.1.1.3.2.3.cmml"><mrow id="S3.E2.m1.1.1.3.2.3.2" xref="S3.E2.m1.1.1.3.2.3.2.cmml"><mo rspace="0em" id="S3.E2.m1.1.1.3.2.3.2.1" xref="S3.E2.m1.1.1.3.2.3.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.3.2.3.2.2" xref="S3.E2.m1.1.1.3.2.3.2.2.cmml">ℒ</mi></mrow><mrow id="S3.E2.m1.1.1.3.2.3.3" xref="S3.E2.m1.1.1.3.2.3.3.cmml"><mo rspace="0em" id="S3.E2.m1.1.1.3.2.3.3.1" xref="S3.E2.m1.1.1.3.2.3.3.1.cmml">∂</mo><msup id="S3.E2.m1.1.1.3.2.3.3.2" xref="S3.E2.m1.1.1.3.2.3.3.2.cmml"><mi id="S3.E2.m1.1.1.3.2.3.3.2.2" xref="S3.E2.m1.1.1.3.2.3.3.2.2.cmml">b</mi><mi id="S3.E2.m1.1.1.3.2.3.3.2.3" xref="S3.E2.m1.1.1.3.2.3.3.2.3.cmml">i</mi></msup></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><eq id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"></eq><ci id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">𝑥</ci><apply id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"><apply id="S3.E2.m1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.1.1.cmml" xref="S3.E2.m1.1.1.3.1">subscript</csymbol><ci id="S3.E2.m1.1.1.3.1.2.cmml" xref="S3.E2.m1.1.1.3.1.2">∇</ci><apply id="S3.E2.m1.1.1.3.1.3.cmml" xref="S3.E2.m1.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.1.3.1.cmml" xref="S3.E2.m1.1.1.3.1.3">superscript</csymbol><ci id="S3.E2.m1.1.1.3.1.3.2.cmml" xref="S3.E2.m1.1.1.3.1.3.2">𝑊</ci><ci id="S3.E2.m1.1.1.3.1.3.3.cmml" xref="S3.E2.m1.1.1.3.1.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.3.2"><ci id="S3.E2.m1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.3.2.1">⊘</ci><ci id="S3.E2.m1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.3.2.2">ℒ</ci><apply id="S3.E2.m1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.3.2.3"><divide id="S3.E2.m1.1.1.3.2.3.1.cmml" xref="S3.E2.m1.1.1.3.2.3"></divide><apply id="S3.E2.m1.1.1.3.2.3.2.cmml" xref="S3.E2.m1.1.1.3.2.3.2"><partialdiff id="S3.E2.m1.1.1.3.2.3.2.1.cmml" xref="S3.E2.m1.1.1.3.2.3.2.1"></partialdiff><ci id="S3.E2.m1.1.1.3.2.3.2.2.cmml" xref="S3.E2.m1.1.1.3.2.3.2.2">ℒ</ci></apply><apply id="S3.E2.m1.1.1.3.2.3.3.cmml" xref="S3.E2.m1.1.1.3.2.3.3"><partialdiff id="S3.E2.m1.1.1.3.2.3.3.1.cmml" xref="S3.E2.m1.1.1.3.2.3.3.1"></partialdiff><apply id="S3.E2.m1.1.1.3.2.3.3.2.cmml" xref="S3.E2.m1.1.1.3.2.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.2.3.3.2.1.cmml" xref="S3.E2.m1.1.1.3.2.3.3.2">superscript</csymbol><ci id="S3.E2.m1.1.1.3.2.3.3.2.2.cmml" xref="S3.E2.m1.1.1.3.2.3.3.2.2">𝑏</ci><ci id="S3.E2.m1.1.1.3.2.3.3.2.3.cmml" xref="S3.E2.m1.1.1.3.2.3.3.2.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">x=\nabla_{W^{i}}\mathcal{L}\oslash\frac{\partial\mathcal{L}}{\partial b^{i}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.12" class="ltx_p">where <math id="S3.SS2.p1.12.m1.1" class="ltx_Math" alttext="\oslash" display="inline"><semantics id="S3.SS2.p1.12.m1.1a"><mo id="S3.SS2.p1.12.m1.1.1" xref="S3.SS2.p1.12.m1.1.1.cmml">⊘</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m1.1b"><ci id="S3.SS2.p1.12.m1.1.1.cmml" xref="S3.SS2.p1.12.m1.1.1">⊘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m1.1c">\oslash</annotation></semantics></math> denotes entry-wise division.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.13" class="ltx_p">However, for batched input <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">x</annotation></semantics></math>, all derivatives are summed over the batch dimension <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">n</annotation></semantics></math> and the same computation can only recover <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\sum_{t=1}^{n}\nabla_{W_{l}^{i}}\mathcal{L}_{t}\oslash\sum_{t=1}^{n}\frac{\partial\mathcal{L}_{t}}{\partial b_{l}^{i}}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><msubsup id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml"><mo id="S3.SS2.p2.3.m3.1.1.1.2.2" xref="S3.SS2.p2.3.m3.1.1.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p2.3.m3.1.1.1.2.3" xref="S3.SS2.p2.3.m3.1.1.1.2.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.1.2.3.2" xref="S3.SS2.p2.3.m3.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS2.p2.3.m3.1.1.1.2.3.1" xref="S3.SS2.p2.3.m3.1.1.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p2.3.m3.1.1.1.2.3.3" xref="S3.SS2.p2.3.m3.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p2.3.m3.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.3.cmml">n</mi></msubsup><mrow id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml"><mrow id="S3.SS2.p2.3.m3.1.1.2.2" xref="S3.SS2.p2.3.m3.1.1.2.2.cmml"><msub id="S3.SS2.p2.3.m3.1.1.2.2.1" xref="S3.SS2.p2.3.m3.1.1.2.2.1.cmml"><mo rspace="0.167em" id="S3.SS2.p2.3.m3.1.1.2.2.1.2" xref="S3.SS2.p2.3.m3.1.1.2.2.1.2.cmml">∇</mo><msubsup id="S3.SS2.p2.3.m3.1.1.2.2.1.3" xref="S3.SS2.p2.3.m3.1.1.2.2.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2.2.1.3.2.2" xref="S3.SS2.p2.3.m3.1.1.2.2.1.3.2.2.cmml">W</mi><mi id="S3.SS2.p2.3.m3.1.1.2.2.1.3.2.3" xref="S3.SS2.p2.3.m3.1.1.2.2.1.3.2.3.cmml">l</mi><mi id="S3.SS2.p2.3.m3.1.1.2.2.1.3.3" xref="S3.SS2.p2.3.m3.1.1.2.2.1.3.3.cmml">i</mi></msubsup></msub><msub id="S3.SS2.p2.3.m3.1.1.2.2.2" xref="S3.SS2.p2.3.m3.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.3.m3.1.1.2.2.2.2" xref="S3.SS2.p2.3.m3.1.1.2.2.2.2.cmml">ℒ</mi><mi id="S3.SS2.p2.3.m3.1.1.2.2.2.3" xref="S3.SS2.p2.3.m3.1.1.2.2.2.3.cmml">t</mi></msub></mrow><mo rspace="0.055em" id="S3.SS2.p2.3.m3.1.1.2.1" xref="S3.SS2.p2.3.m3.1.1.2.1.cmml">⊘</mo><mrow id="S3.SS2.p2.3.m3.1.1.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3.cmml"><msubsup id="S3.SS2.p2.3.m3.1.1.2.3.1" xref="S3.SS2.p2.3.m3.1.1.2.3.1.cmml"><mo id="S3.SS2.p2.3.m3.1.1.2.3.1.2.2" xref="S3.SS2.p2.3.m3.1.1.2.3.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p2.3.m3.1.1.2.3.1.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.2" xref="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.2.cmml">t</mi><mo id="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.1" xref="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.3" xref="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p2.3.m3.1.1.2.3.1.3" xref="S3.SS2.p2.3.m3.1.1.2.3.1.3.cmml">n</mi></msubsup><mfrac id="S3.SS2.p2.3.m3.1.1.2.3.2" xref="S3.SS2.p2.3.m3.1.1.2.3.2.cmml"><mrow id="S3.SS2.p2.3.m3.1.1.2.3.2.2" xref="S3.SS2.p2.3.m3.1.1.2.3.2.2.cmml"><mo rspace="0em" id="S3.SS2.p2.3.m3.1.1.2.3.2.2.1" xref="S3.SS2.p2.3.m3.1.1.2.3.2.2.1.cmml">∂</mo><msub id="S3.SS2.p2.3.m3.1.1.2.3.2.2.2" xref="S3.SS2.p2.3.m3.1.1.2.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.3.m3.1.1.2.3.2.2.2.2" xref="S3.SS2.p2.3.m3.1.1.2.3.2.2.2.2.cmml">ℒ</mi><mi id="S3.SS2.p2.3.m3.1.1.2.3.2.2.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3.2.2.2.3.cmml">t</mi></msub></mrow><mrow id="S3.SS2.p2.3.m3.1.1.2.3.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.cmml"><mo rspace="0em" id="S3.SS2.p2.3.m3.1.1.2.3.2.3.1" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.1.cmml">∂</mo><msubsup id="S3.SS2.p2.3.m3.1.1.2.3.2.3.2" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.2.2" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.2.2.cmml">b</mi><mi id="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.2.3.cmml">l</mi><mi id="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.3.cmml">i</mi></msubsup></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><apply id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1">superscript</csymbol><apply id="S3.SS2.p2.3.m3.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1">subscript</csymbol><sum id="S3.SS2.p2.3.m3.1.1.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.2.2"></sum><apply id="S3.SS2.p2.3.m3.1.1.1.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.2.3"><eq id="S3.SS2.p2.3.m3.1.1.1.2.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.2.3.1"></eq><ci id="S3.SS2.p2.3.m3.1.1.1.2.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p2.3.m3.1.1.1.2.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p2.3.m3.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.3">𝑛</ci></apply><apply id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2"><ci id="S3.SS2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.1">⊘</ci><apply id="S3.SS2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2"><apply id="S3.SS2.p2.3.m3.1.1.2.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.2.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.2.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.1.2">∇</ci><apply id="S3.SS2.p2.3.m3.1.1.2.2.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.2.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.1.3">superscript</csymbol><apply id="S3.SS2.p2.3.m3.1.1.2.2.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.2.1.3.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.1.3">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.2.1.3.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.1.3.2.2">𝑊</ci><ci id="S3.SS2.p2.3.m3.1.1.2.2.1.3.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.1.3.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.3.m3.1.1.2.2.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.1.3.3">𝑖</ci></apply></apply><apply id="S3.SS2.p2.3.m3.1.1.2.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.2.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.2.2">ℒ</ci><ci id="S3.SS2.p2.3.m3.1.1.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2.2.3">𝑡</ci></apply></apply><apply id="S3.SS2.p2.3.m3.1.1.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3"><apply id="S3.SS2.p2.3.m3.1.1.2.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.1">superscript</csymbol><apply id="S3.SS2.p2.3.m3.1.1.2.3.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.3.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.1">subscript</csymbol><sum id="S3.SS2.p2.3.m3.1.1.2.3.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.1.2.2"></sum><apply id="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.1.2.3"><eq id="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.1"></eq><ci id="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p2.3.m3.1.1.2.3.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.1.3">𝑛</ci></apply><apply id="S3.SS2.p2.3.m3.1.1.2.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2"><divide id="S3.SS2.p2.3.m3.1.1.2.3.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2"></divide><apply id="S3.SS2.p2.3.m3.1.1.2.3.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.2"><partialdiff id="S3.SS2.p2.3.m3.1.1.2.3.2.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.2.1"></partialdiff><apply id="S3.SS2.p2.3.m3.1.1.2.3.2.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.3.2.2.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.3.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.2.2.2">ℒ</ci><ci id="S3.SS2.p2.3.m3.1.1.2.3.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.2.2.3">𝑡</ci></apply></apply><apply id="S3.SS2.p2.3.m3.1.1.2.3.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3"><partialdiff id="S3.SS2.p2.3.m3.1.1.2.3.2.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.1"></partialdiff><apply id="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.2">superscript</csymbol><apply id="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.2.2">𝑏</ci><ci id="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3.2.3.2.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\sum_{t=1}^{n}\nabla_{W_{l}^{i}}\mathcal{L}_{t}\oslash\sum_{t=1}^{n}\frac{\partial\mathcal{L}_{t}}{\partial b_{l}^{i}}</annotation></semantics></math> from each row where <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="\sum_{t=1}^{n}\frac{\partial\mathcal{L}_{t}}{\partial b_{l}^{i}}\neq 0" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mrow id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml"><msubsup id="S3.SS2.p2.4.m4.1.1.2.1" xref="S3.SS2.p2.4.m4.1.1.2.1.cmml"><mo id="S3.SS2.p2.4.m4.1.1.2.1.2.2" xref="S3.SS2.p2.4.m4.1.1.2.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p2.4.m4.1.1.2.1.2.3" xref="S3.SS2.p2.4.m4.1.1.2.1.2.3.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2.1.2.3.2" xref="S3.SS2.p2.4.m4.1.1.2.1.2.3.2.cmml">t</mi><mo id="S3.SS2.p2.4.m4.1.1.2.1.2.3.1" xref="S3.SS2.p2.4.m4.1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p2.4.m4.1.1.2.1.2.3.3" xref="S3.SS2.p2.4.m4.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p2.4.m4.1.1.2.1.3" xref="S3.SS2.p2.4.m4.1.1.2.1.3.cmml">n</mi></msubsup><mfrac id="S3.SS2.p2.4.m4.1.1.2.2" xref="S3.SS2.p2.4.m4.1.1.2.2.cmml"><mrow id="S3.SS2.p2.4.m4.1.1.2.2.2" xref="S3.SS2.p2.4.m4.1.1.2.2.2.cmml"><mo rspace="0em" id="S3.SS2.p2.4.m4.1.1.2.2.2.1" xref="S3.SS2.p2.4.m4.1.1.2.2.2.1.cmml">∂</mo><msub id="S3.SS2.p2.4.m4.1.1.2.2.2.2" xref="S3.SS2.p2.4.m4.1.1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.4.m4.1.1.2.2.2.2.2" xref="S3.SS2.p2.4.m4.1.1.2.2.2.2.2.cmml">ℒ</mi><mi id="S3.SS2.p2.4.m4.1.1.2.2.2.2.3" xref="S3.SS2.p2.4.m4.1.1.2.2.2.2.3.cmml">t</mi></msub></mrow><mrow id="S3.SS2.p2.4.m4.1.1.2.2.3" xref="S3.SS2.p2.4.m4.1.1.2.2.3.cmml"><mo rspace="0em" id="S3.SS2.p2.4.m4.1.1.2.2.3.1" xref="S3.SS2.p2.4.m4.1.1.2.2.3.1.cmml">∂</mo><msubsup id="S3.SS2.p2.4.m4.1.1.2.2.3.2" xref="S3.SS2.p2.4.m4.1.1.2.2.3.2.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2.2.3.2.2.2" xref="S3.SS2.p2.4.m4.1.1.2.2.3.2.2.2.cmml">b</mi><mi id="S3.SS2.p2.4.m4.1.1.2.2.3.2.2.3" xref="S3.SS2.p2.4.m4.1.1.2.2.3.2.2.3.cmml">l</mi><mi id="S3.SS2.p2.4.m4.1.1.2.2.3.2.3" xref="S3.SS2.p2.4.m4.1.1.2.2.3.2.3.cmml">i</mi></msubsup></mrow></mfrac></mrow><mo id="S3.SS2.p2.4.m4.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.cmml">≠</mo><mn id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><neq id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"></neq><apply id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2"><apply id="S3.SS2.p2.4.m4.1.1.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.2.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.2.1">superscript</csymbol><apply id="S3.SS2.p2.4.m4.1.1.2.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.2.1.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1.2.1">subscript</csymbol><sum id="S3.SS2.p2.4.m4.1.1.2.1.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.1.2.2"></sum><apply id="S3.SS2.p2.4.m4.1.1.2.1.2.3.cmml" xref="S3.SS2.p2.4.m4.1.1.2.1.2.3"><eq id="S3.SS2.p2.4.m4.1.1.2.1.2.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.2.1.2.3.1"></eq><ci id="S3.SS2.p2.4.m4.1.1.2.1.2.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p2.4.m4.1.1.2.1.2.3.3.cmml" xref="S3.SS2.p2.4.m4.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p2.4.m4.1.1.2.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.2.1.3">𝑛</ci></apply><apply id="S3.SS2.p2.4.m4.1.1.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2"><divide id="S3.SS2.p2.4.m4.1.1.2.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2"></divide><apply id="S3.SS2.p2.4.m4.1.1.2.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.2"><partialdiff id="S3.SS2.p2.4.m4.1.1.2.2.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.2.1"></partialdiff><apply id="S3.SS2.p2.4.m4.1.1.2.2.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.2.2.2.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.2.2.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.2.2.2">ℒ</ci><ci id="S3.SS2.p2.4.m4.1.1.2.2.2.2.3.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.2.2.3">𝑡</ci></apply></apply><apply id="S3.SS2.p2.4.m4.1.1.2.2.3.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.3"><partialdiff id="S3.SS2.p2.4.m4.1.1.2.2.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.3.1"></partialdiff><apply id="S3.SS2.p2.4.m4.1.1.2.2.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.2.2.3.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.3.2">superscript</csymbol><apply id="S3.SS2.p2.4.m4.1.1.2.2.3.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.2.2.3.2.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.3.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.2.3.2.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.3.2.2.2">𝑏</ci><ci id="S3.SS2.p2.4.m4.1.1.2.2.3.2.2.3.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.3.2.2.3">𝑙</ci></apply><ci id="S3.SS2.p2.4.m4.1.1.2.2.3.2.3.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2.3.2.3">𝑖</ci></apply></apply></apply></apply><cn type="integer" id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">\sum_{t=1}^{n}\frac{\partial\mathcal{L}_{t}}{\partial b_{l}^{i}}\neq 0</annotation></semantics></math>, which is merely proportional to a linear combination of the <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">x</mi><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝑥</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">x_{t}</annotation></semantics></math>’s.
However, data points <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><msub id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mi id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml">x</mi><mi id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2">𝑥</ci><ci id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">x_{t}</annotation></semantics></math> only appear in the average if <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="\frac{\partial\mathcal{L}_{t}}{\partial y^{i}_{t}}" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><mfrac id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml"><mrow id="S3.SS2.p2.7.m7.1.1.2" xref="S3.SS2.p2.7.m7.1.1.2.cmml"><mo rspace="0em" id="S3.SS2.p2.7.m7.1.1.2.1" xref="S3.SS2.p2.7.m7.1.1.2.1.cmml">∂</mo><msub id="S3.SS2.p2.7.m7.1.1.2.2" xref="S3.SS2.p2.7.m7.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.7.m7.1.1.2.2.2" xref="S3.SS2.p2.7.m7.1.1.2.2.2.cmml">ℒ</mi><mi id="S3.SS2.p2.7.m7.1.1.2.2.3" xref="S3.SS2.p2.7.m7.1.1.2.2.3.cmml">t</mi></msub></mrow><mrow id="S3.SS2.p2.7.m7.1.1.3" xref="S3.SS2.p2.7.m7.1.1.3.cmml"><mo rspace="0em" id="S3.SS2.p2.7.m7.1.1.3.1" xref="S3.SS2.p2.7.m7.1.1.3.1.cmml">∂</mo><msubsup id="S3.SS2.p2.7.m7.1.1.3.2" xref="S3.SS2.p2.7.m7.1.1.3.2.cmml"><mi id="S3.SS2.p2.7.m7.1.1.3.2.2.2" xref="S3.SS2.p2.7.m7.1.1.3.2.2.2.cmml">y</mi><mi id="S3.SS2.p2.7.m7.1.1.3.2.3" xref="S3.SS2.p2.7.m7.1.1.3.2.3.cmml">t</mi><mi id="S3.SS2.p2.7.m7.1.1.3.2.2.3" xref="S3.SS2.p2.7.m7.1.1.3.2.2.3.cmml">i</mi></msubsup></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><apply id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1"><divide id="S3.SS2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1"></divide><apply id="S3.SS2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2"><partialdiff id="S3.SS2.p2.7.m7.1.1.2.1.cmml" xref="S3.SS2.p2.7.m7.1.1.2.1"></partialdiff><apply id="S3.SS2.p2.7.m7.1.1.2.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.2.2.1.cmml" xref="S3.SS2.p2.7.m7.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.2.2.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2.2.2">ℒ</ci><ci id="S3.SS2.p2.7.m7.1.1.2.2.3.cmml" xref="S3.SS2.p2.7.m7.1.1.2.2.3">𝑡</ci></apply></apply><apply id="S3.SS2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3"><partialdiff id="S3.SS2.p2.7.m7.1.1.3.1.cmml" xref="S3.SS2.p2.7.m7.1.1.3.1"></partialdiff><apply id="S3.SS2.p2.7.m7.1.1.3.2.cmml" xref="S3.SS2.p2.7.m7.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.3.2.1.cmml" xref="S3.SS2.p2.7.m7.1.1.3.2">subscript</csymbol><apply id="S3.SS2.p2.7.m7.1.1.3.2.2.cmml" xref="S3.SS2.p2.7.m7.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.3.2.2.1.cmml" xref="S3.SS2.p2.7.m7.1.1.3.2">superscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.3.2.2.2.cmml" xref="S3.SS2.p2.7.m7.1.1.3.2.2.2">𝑦</ci><ci id="S3.SS2.p2.7.m7.1.1.3.2.2.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p2.7.m7.1.1.3.2.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3.2.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">\frac{\partial\mathcal{L}_{t}}{\partial y^{i}_{t}}</annotation></semantics></math> is non-zero, a phenomenon also discussed in <cite class="ltx_cite ltx_citemacro_citet">Sun et al. (<a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite>. If <math id="S3.SS2.p2.8.m8.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.SS2.p2.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><ci id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">\mathcal{L}</annotation></semantics></math> has a sparse gradient, e.g. in a multinomial logistic regression, then this structured gradient weakens the notion of averaging: Let <math id="S3.SS2.p2.9.m9.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p2.9.m9.1a"><mi id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><ci id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">x</annotation></semantics></math> be a batch of data with unique labels <math id="S3.SS2.p2.10.m10.3" class="ltx_Math" alttext="1,\dots,n" display="inline"><semantics id="S3.SS2.p2.10.m10.3a"><mrow id="S3.SS2.p2.10.m10.3.4.2" xref="S3.SS2.p2.10.m10.3.4.1.cmml"><mn id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml">1</mn><mo id="S3.SS2.p2.10.m10.3.4.2.1" xref="S3.SS2.p2.10.m10.3.4.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.10.m10.2.2" xref="S3.SS2.p2.10.m10.2.2.cmml">…</mi><mo id="S3.SS2.p2.10.m10.3.4.2.2" xref="S3.SS2.p2.10.m10.3.4.1.cmml">,</mo><mi id="S3.SS2.p2.10.m10.3.3" xref="S3.SS2.p2.10.m10.3.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.3b"><list id="S3.SS2.p2.10.m10.3.4.1.cmml" xref="S3.SS2.p2.10.m10.3.4.2"><cn type="integer" id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1">1</cn><ci id="S3.SS2.p2.10.m10.2.2.cmml" xref="S3.SS2.p2.10.m10.2.2">…</ci><ci id="S3.SS2.p2.10.m10.3.3.cmml" xref="S3.SS2.p2.10.m10.3.3">𝑛</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.3c">1,\dots,n</annotation></semantics></math>. In this setting <math id="S3.SS2.p2.11.m11.1" class="ltx_Math" alttext="\frac{\partial\mathcal{L}_{t}}{\partial y^{i}_{t}}=0" display="inline"><semantics id="S3.SS2.p2.11.m11.1a"><mrow id="S3.SS2.p2.11.m11.1.1" xref="S3.SS2.p2.11.m11.1.1.cmml"><mfrac id="S3.SS2.p2.11.m11.1.1.2" xref="S3.SS2.p2.11.m11.1.1.2.cmml"><mrow id="S3.SS2.p2.11.m11.1.1.2.2" xref="S3.SS2.p2.11.m11.1.1.2.2.cmml"><mo rspace="0em" id="S3.SS2.p2.11.m11.1.1.2.2.1" xref="S3.SS2.p2.11.m11.1.1.2.2.1.cmml">∂</mo><msub id="S3.SS2.p2.11.m11.1.1.2.2.2" xref="S3.SS2.p2.11.m11.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.11.m11.1.1.2.2.2.2" xref="S3.SS2.p2.11.m11.1.1.2.2.2.2.cmml">ℒ</mi><mi id="S3.SS2.p2.11.m11.1.1.2.2.2.3" xref="S3.SS2.p2.11.m11.1.1.2.2.2.3.cmml">t</mi></msub></mrow><mrow id="S3.SS2.p2.11.m11.1.1.2.3" xref="S3.SS2.p2.11.m11.1.1.2.3.cmml"><mo rspace="0em" id="S3.SS2.p2.11.m11.1.1.2.3.1" xref="S3.SS2.p2.11.m11.1.1.2.3.1.cmml">∂</mo><msubsup id="S3.SS2.p2.11.m11.1.1.2.3.2" xref="S3.SS2.p2.11.m11.1.1.2.3.2.cmml"><mi id="S3.SS2.p2.11.m11.1.1.2.3.2.2.2" xref="S3.SS2.p2.11.m11.1.1.2.3.2.2.2.cmml">y</mi><mi id="S3.SS2.p2.11.m11.1.1.2.3.2.3" xref="S3.SS2.p2.11.m11.1.1.2.3.2.3.cmml">t</mi><mi id="S3.SS2.p2.11.m11.1.1.2.3.2.2.3" xref="S3.SS2.p2.11.m11.1.1.2.3.2.2.3.cmml">i</mi></msubsup></mrow></mfrac><mo id="S3.SS2.p2.11.m11.1.1.1" xref="S3.SS2.p2.11.m11.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.11.m11.1.1.3" xref="S3.SS2.p2.11.m11.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m11.1b"><apply id="S3.SS2.p2.11.m11.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1"><eq id="S3.SS2.p2.11.m11.1.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1.1"></eq><apply id="S3.SS2.p2.11.m11.1.1.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2"><divide id="S3.SS2.p2.11.m11.1.1.2.1.cmml" xref="S3.SS2.p2.11.m11.1.1.2"></divide><apply id="S3.SS2.p2.11.m11.1.1.2.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2.2"><partialdiff id="S3.SS2.p2.11.m11.1.1.2.2.1.cmml" xref="S3.SS2.p2.11.m11.1.1.2.2.1"></partialdiff><apply id="S3.SS2.p2.11.m11.1.1.2.2.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.1.1.2.2.2.1.cmml" xref="S3.SS2.p2.11.m11.1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.11.m11.1.1.2.2.2.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2.2.2.2">ℒ</ci><ci id="S3.SS2.p2.11.m11.1.1.2.2.2.3.cmml" xref="S3.SS2.p2.11.m11.1.1.2.2.2.3">𝑡</ci></apply></apply><apply id="S3.SS2.p2.11.m11.1.1.2.3.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3"><partialdiff id="S3.SS2.p2.11.m11.1.1.2.3.1.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3.1"></partialdiff><apply id="S3.SS2.p2.11.m11.1.1.2.3.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.1.1.2.3.2.1.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3.2">subscript</csymbol><apply id="S3.SS2.p2.11.m11.1.1.2.3.2.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.1.1.2.3.2.2.1.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3.2">superscript</csymbol><ci id="S3.SS2.p2.11.m11.1.1.2.3.2.2.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3.2.2.2">𝑦</ci><ci id="S3.SS2.p2.11.m11.1.1.2.3.2.2.3.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p2.11.m11.1.1.2.3.2.3.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3.2.3">𝑡</ci></apply></apply></apply><cn type="integer" id="S3.SS2.p2.11.m11.1.1.3.cmml" xref="S3.SS2.p2.11.m11.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m11.1c">\frac{\partial\mathcal{L}_{t}}{\partial y^{i}_{t}}=0</annotation></semantics></math> for all <math id="S3.SS2.p2.12.m12.1" class="ltx_Math" alttext="i\neq t" display="inline"><semantics id="S3.SS2.p2.12.m12.1a"><mrow id="S3.SS2.p2.12.m12.1.1" xref="S3.SS2.p2.12.m12.1.1.cmml"><mi id="S3.SS2.p2.12.m12.1.1.2" xref="S3.SS2.p2.12.m12.1.1.2.cmml">i</mi><mo id="S3.SS2.p2.12.m12.1.1.1" xref="S3.SS2.p2.12.m12.1.1.1.cmml">≠</mo><mi id="S3.SS2.p2.12.m12.1.1.3" xref="S3.SS2.p2.12.m12.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m12.1b"><apply id="S3.SS2.p2.12.m12.1.1.cmml" xref="S3.SS2.p2.12.m12.1.1"><neq id="S3.SS2.p2.12.m12.1.1.1.cmml" xref="S3.SS2.p2.12.m12.1.1.1"></neq><ci id="S3.SS2.p2.12.m12.1.1.2.cmml" xref="S3.SS2.p2.12.m12.1.1.2">𝑖</ci><ci id="S3.SS2.p2.12.m12.1.1.3.cmml" xref="S3.SS2.p2.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m12.1c">i\neq t</annotation></semantics></math>, so that each row <math id="S3.SS2.p2.13.m13.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p2.13.m13.1a"><mi id="S3.SS2.p2.13.m13.1.1" xref="S3.SS2.p2.13.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m13.1b"><ci id="S3.SS2.p2.13.m13.1.1.cmml" xref="S3.SS2.p2.13.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m13.1c">i</annotation></semantics></math> actually recovers</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="x_{t}=\sum_{t=1}^{n}\frac{\partial\mathcal{L}_{t}}{\partial y^{i}_{t}}x_{t}\oslash\sum_{t=1}^{n}\frac{\partial\mathcal{L}_{t}}{\partial y^{i}_{t}}=\frac{\partial\mathcal{L}_{t}}{\partial y^{i}_{t}}x_{t}\oslash\frac{\partial\mathcal{L}_{t}}{\partial y^{i}_{t}}." display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E3.m1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.2.3.cmml">t</mi></msub><mo rspace="0.111em" id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.4" xref="S3.E3.m1.1.1.1.1.4.cmml"><munderover id="S3.E3.m1.1.1.1.1.4.1" xref="S3.E3.m1.1.1.1.1.4.1.cmml"><mo movablelimits="false" id="S3.E3.m1.1.1.1.1.4.1.2.2" xref="S3.E3.m1.1.1.1.1.4.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1.1.4.1.2.3" xref="S3.E3.m1.1.1.1.1.4.1.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.4.1.2.3.2" xref="S3.E3.m1.1.1.1.1.4.1.2.3.2.cmml">t</mi><mo id="S3.E3.m1.1.1.1.1.4.1.2.3.1" xref="S3.E3.m1.1.1.1.1.4.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.1.1.4.1.2.3.3" xref="S3.E3.m1.1.1.1.1.4.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.1.1.4.1.3" xref="S3.E3.m1.1.1.1.1.4.1.3.cmml">n</mi></munderover><mrow id="S3.E3.m1.1.1.1.1.4.2" xref="S3.E3.m1.1.1.1.1.4.2.cmml"><mrow id="S3.E3.m1.1.1.1.1.4.2.2" xref="S3.E3.m1.1.1.1.1.4.2.2.cmml"><mfrac id="S3.E3.m1.1.1.1.1.4.2.2.2" xref="S3.E3.m1.1.1.1.1.4.2.2.2.cmml"><mrow id="S3.E3.m1.1.1.1.1.4.2.2.2.2" xref="S3.E3.m1.1.1.1.1.4.2.2.2.2.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.4.2.2.2.2.1" xref="S3.E3.m1.1.1.1.1.4.2.2.2.2.1.cmml">∂</mo><msub id="S3.E3.m1.1.1.1.1.4.2.2.2.2.2" xref="S3.E3.m1.1.1.1.1.4.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1.4.2.2.2.2.2.2" xref="S3.E3.m1.1.1.1.1.4.2.2.2.2.2.2.cmml">ℒ</mi><mi id="S3.E3.m1.1.1.1.1.4.2.2.2.2.2.3" xref="S3.E3.m1.1.1.1.1.4.2.2.2.2.2.3.cmml">t</mi></msub></mrow><mrow id="S3.E3.m1.1.1.1.1.4.2.2.2.3" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.4.2.2.2.3.1" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.1.cmml">∂</mo><msubsup id="S3.E3.m1.1.1.1.1.4.2.2.2.3.2" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.2.2" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.2.2.cmml">y</mi><mi id="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.3" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.3.cmml">t</mi><mi id="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.2.3" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.2.3.cmml">i</mi></msubsup></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.4.2.2.1" xref="S3.E3.m1.1.1.1.1.4.2.2.1.cmml">​</mo><msub id="S3.E3.m1.1.1.1.1.4.2.2.3" xref="S3.E3.m1.1.1.1.1.4.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.4.2.2.3.2" xref="S3.E3.m1.1.1.1.1.4.2.2.3.2.cmml">x</mi><mi id="S3.E3.m1.1.1.1.1.4.2.2.3.3" xref="S3.E3.m1.1.1.1.1.4.2.2.3.3.cmml">t</mi></msub></mrow><mo rspace="0.055em" id="S3.E3.m1.1.1.1.1.4.2.1" xref="S3.E3.m1.1.1.1.1.4.2.1.cmml">⊘</mo><mrow id="S3.E3.m1.1.1.1.1.4.2.3" xref="S3.E3.m1.1.1.1.1.4.2.3.cmml"><munderover id="S3.E3.m1.1.1.1.1.4.2.3.1" xref="S3.E3.m1.1.1.1.1.4.2.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.1.1.1.1.4.2.3.1.2.2" xref="S3.E3.m1.1.1.1.1.4.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1.1.4.2.3.1.2.3" xref="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.2" xref="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.2.cmml">t</mi><mo id="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.1" xref="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.3" xref="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.1.1.4.2.3.1.3" xref="S3.E3.m1.1.1.1.1.4.2.3.1.3.cmml">n</mi></munderover><mfrac id="S3.E3.m1.1.1.1.1.4.2.3.2" xref="S3.E3.m1.1.1.1.1.4.2.3.2.cmml"><mrow id="S3.E3.m1.1.1.1.1.4.2.3.2.2" xref="S3.E3.m1.1.1.1.1.4.2.3.2.2.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.4.2.3.2.2.1" xref="S3.E3.m1.1.1.1.1.4.2.3.2.2.1.cmml">∂</mo><msub id="S3.E3.m1.1.1.1.1.4.2.3.2.2.2" xref="S3.E3.m1.1.1.1.1.4.2.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1.4.2.3.2.2.2.2" xref="S3.E3.m1.1.1.1.1.4.2.3.2.2.2.2.cmml">ℒ</mi><mi id="S3.E3.m1.1.1.1.1.4.2.3.2.2.2.3" xref="S3.E3.m1.1.1.1.1.4.2.3.2.2.2.3.cmml">t</mi></msub></mrow><mrow id="S3.E3.m1.1.1.1.1.4.2.3.2.3" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.4.2.3.2.3.1" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.1.cmml">∂</mo><msubsup id="S3.E3.m1.1.1.1.1.4.2.3.2.3.2" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.2.2" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.2.2.cmml">y</mi><mi id="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.3" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.3.cmml">t</mi><mi id="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.2.3" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.2.3.cmml">i</mi></msubsup></mrow></mfrac></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.5" xref="S3.E3.m1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.6" xref="S3.E3.m1.1.1.1.1.6.cmml"><mrow id="S3.E3.m1.1.1.1.1.6.2" xref="S3.E3.m1.1.1.1.1.6.2.cmml"><mfrac id="S3.E3.m1.1.1.1.1.6.2.2" xref="S3.E3.m1.1.1.1.1.6.2.2.cmml"><mrow id="S3.E3.m1.1.1.1.1.6.2.2.2" xref="S3.E3.m1.1.1.1.1.6.2.2.2.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.6.2.2.2.1" xref="S3.E3.m1.1.1.1.1.6.2.2.2.1.cmml">∂</mo><msub id="S3.E3.m1.1.1.1.1.6.2.2.2.2" xref="S3.E3.m1.1.1.1.1.6.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1.6.2.2.2.2.2" xref="S3.E3.m1.1.1.1.1.6.2.2.2.2.2.cmml">ℒ</mi><mi id="S3.E3.m1.1.1.1.1.6.2.2.2.2.3" xref="S3.E3.m1.1.1.1.1.6.2.2.2.2.3.cmml">t</mi></msub></mrow><mrow id="S3.E3.m1.1.1.1.1.6.2.2.3" xref="S3.E3.m1.1.1.1.1.6.2.2.3.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.6.2.2.3.1" xref="S3.E3.m1.1.1.1.1.6.2.2.3.1.cmml">∂</mo><msubsup id="S3.E3.m1.1.1.1.1.6.2.2.3.2" xref="S3.E3.m1.1.1.1.1.6.2.2.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.6.2.2.3.2.2.2" xref="S3.E3.m1.1.1.1.1.6.2.2.3.2.2.2.cmml">y</mi><mi id="S3.E3.m1.1.1.1.1.6.2.2.3.2.3" xref="S3.E3.m1.1.1.1.1.6.2.2.3.2.3.cmml">t</mi><mi id="S3.E3.m1.1.1.1.1.6.2.2.3.2.2.3" xref="S3.E3.m1.1.1.1.1.6.2.2.3.2.2.3.cmml">i</mi></msubsup></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.6.2.1" xref="S3.E3.m1.1.1.1.1.6.2.1.cmml">​</mo><msub id="S3.E3.m1.1.1.1.1.6.2.3" xref="S3.E3.m1.1.1.1.1.6.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.6.2.3.2" xref="S3.E3.m1.1.1.1.1.6.2.3.2.cmml">x</mi><mi id="S3.E3.m1.1.1.1.1.6.2.3.3" xref="S3.E3.m1.1.1.1.1.6.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.1.1.1.1.6.1" xref="S3.E3.m1.1.1.1.1.6.1.cmml">⊘</mo><mfrac id="S3.E3.m1.1.1.1.1.6.3" xref="S3.E3.m1.1.1.1.1.6.3.cmml"><mrow id="S3.E3.m1.1.1.1.1.6.3.2" xref="S3.E3.m1.1.1.1.1.6.3.2.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.6.3.2.1" xref="S3.E3.m1.1.1.1.1.6.3.2.1.cmml">∂</mo><msub id="S3.E3.m1.1.1.1.1.6.3.2.2" xref="S3.E3.m1.1.1.1.1.6.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1.6.3.2.2.2" xref="S3.E3.m1.1.1.1.1.6.3.2.2.2.cmml">ℒ</mi><mi id="S3.E3.m1.1.1.1.1.6.3.2.2.3" xref="S3.E3.m1.1.1.1.1.6.3.2.2.3.cmml">t</mi></msub></mrow><mrow id="S3.E3.m1.1.1.1.1.6.3.3" xref="S3.E3.m1.1.1.1.1.6.3.3.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.6.3.3.1" xref="S3.E3.m1.1.1.1.1.6.3.3.1.cmml">∂</mo><msubsup id="S3.E3.m1.1.1.1.1.6.3.3.2" xref="S3.E3.m1.1.1.1.1.6.3.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.6.3.3.2.2.2" xref="S3.E3.m1.1.1.1.1.6.3.3.2.2.2.cmml">y</mi><mi id="S3.E3.m1.1.1.1.1.6.3.3.2.3" xref="S3.E3.m1.1.1.1.1.6.3.3.2.3.cmml">t</mi><mi id="S3.E3.m1.1.1.1.1.6.3.3.2.2.3" xref="S3.E3.m1.1.1.1.1.6.3.3.2.2.3.cmml">i</mi></msubsup></mrow></mfrac></mrow></mrow><mo lspace="0em" id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><and id="S3.E3.m1.1.1.1.1a.cmml" xref="S3.E3.m1.1.1.1"></and><apply id="S3.E3.m1.1.1.1.1b.cmml" xref="S3.E3.m1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3"></eq><apply id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E3.m1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E3.m1.1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.4"><apply id="S3.E3.m1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.1.1.cmml" xref="S3.E3.m1.1.1.1.1.4.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.4.1.2.cmml" xref="S3.E3.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.1">subscript</csymbol><sum id="S3.E3.m1.1.1.1.1.4.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.1.2.2"></sum><apply id="S3.E3.m1.1.1.1.1.4.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.1.2.3"><eq id="S3.E3.m1.1.1.1.1.4.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.4.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.1.1.4.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.4.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.4.1.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.4.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.1.1.4.1.3.cmml" xref="S3.E3.m1.1.1.1.1.4.1.3">𝑛</ci></apply><apply id="S3.E3.m1.1.1.1.1.4.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2"><ci id="S3.E3.m1.1.1.1.1.4.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.1">⊘</ci><apply id="S3.E3.m1.1.1.1.1.4.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2"><times id="S3.E3.m1.1.1.1.1.4.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.1"></times><apply id="S3.E3.m1.1.1.1.1.4.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2"><divide id="S3.E3.m1.1.1.1.1.4.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2"></divide><apply id="S3.E3.m1.1.1.1.1.4.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.2"><partialdiff id="S3.E3.m1.1.1.1.1.4.2.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.2.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.4.2.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.2.2.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.4.2.2.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.2.2.2">ℒ</ci><ci id="S3.E3.m1.1.1.1.1.4.2.2.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.2.2.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.4.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3"><partialdiff id="S3.E3.m1.1.1.1.1.4.2.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.2">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.2">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.2.2">𝑦</ci><ci id="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.2.3">𝑖</ci></apply><ci id="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.2.3.2.3">𝑡</ci></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.4.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.4.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.3.2">𝑥</ci><ci id="S3.E3.m1.1.1.1.1.4.2.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.2.3.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.4.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3"><apply id="S3.E3.m1.1.1.1.1.4.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.2.3.1.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.4.2.3.1.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.2.3.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.1">subscript</csymbol><sum id="S3.E3.m1.1.1.1.1.4.2.3.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.1.2.2"></sum><apply id="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.1.2.3"><eq id="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.1.1.4.2.3.1.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.1.3">𝑛</ci></apply><apply id="S3.E3.m1.1.1.1.1.4.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2"><divide id="S3.E3.m1.1.1.1.1.4.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2"></divide><apply id="S3.E3.m1.1.1.1.1.4.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.2"><partialdiff id="S3.E3.m1.1.1.1.1.4.2.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.2.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.4.2.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.2.3.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.4.2.3.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.2.2.2">ℒ</ci><ci id="S3.E3.m1.1.1.1.1.4.2.3.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.2.2.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.4.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3"><partialdiff id="S3.E3.m1.1.1.1.1.4.2.3.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.2">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.2">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.2.2">𝑦</ci><ci id="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.2.3">𝑖</ci></apply><ci id="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.4.2.3.2.3.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1c.cmml" xref="S3.E3.m1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.5.cmml" xref="S3.E3.m1.1.1.1.1.5"></eq><share href="#S3.E3.m1.1.1.1.1.4.cmml" id="S3.E3.m1.1.1.1.1d.cmml" xref="S3.E3.m1.1.1.1"></share><apply id="S3.E3.m1.1.1.1.1.6.cmml" xref="S3.E3.m1.1.1.1.1.6"><ci id="S3.E3.m1.1.1.1.1.6.1.cmml" xref="S3.E3.m1.1.1.1.1.6.1">⊘</ci><apply id="S3.E3.m1.1.1.1.1.6.2.cmml" xref="S3.E3.m1.1.1.1.1.6.2"><times id="S3.E3.m1.1.1.1.1.6.2.1.cmml" xref="S3.E3.m1.1.1.1.1.6.2.1"></times><apply id="S3.E3.m1.1.1.1.1.6.2.2.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2"><divide id="S3.E3.m1.1.1.1.1.6.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2"></divide><apply id="S3.E3.m1.1.1.1.1.6.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.2"><partialdiff id="S3.E3.m1.1.1.1.1.6.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.2.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.6.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.6.2.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.6.2.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.2.2.2">ℒ</ci><ci id="S3.E3.m1.1.1.1.1.6.2.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.2.2.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.6.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.3"><partialdiff id="S3.E3.m1.1.1.1.1.6.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.3.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.6.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.6.2.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.3.2">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.6.2.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.6.2.2.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.3.2">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.6.2.2.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.3.2.2.2">𝑦</ci><ci id="S3.E3.m1.1.1.1.1.6.2.2.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.3.2.2.3">𝑖</ci></apply><ci id="S3.E3.m1.1.1.1.1.6.2.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.6.2.2.3.2.3">𝑡</ci></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.6.2.3.cmml" xref="S3.E3.m1.1.1.1.1.6.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.6.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.6.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.6.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.6.2.3.2">𝑥</ci><ci id="S3.E3.m1.1.1.1.1.6.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.6.2.3.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.6.3.cmml" xref="S3.E3.m1.1.1.1.1.6.3"><divide id="S3.E3.m1.1.1.1.1.6.3.1.cmml" xref="S3.E3.m1.1.1.1.1.6.3"></divide><apply id="S3.E3.m1.1.1.1.1.6.3.2.cmml" xref="S3.E3.m1.1.1.1.1.6.3.2"><partialdiff id="S3.E3.m1.1.1.1.1.6.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.6.3.2.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.6.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.6.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.6.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.6.3.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.6.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.6.3.2.2.2">ℒ</ci><ci id="S3.E3.m1.1.1.1.1.6.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.6.3.2.2.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.6.3.3.cmml" xref="S3.E3.m1.1.1.1.1.6.3.3"><partialdiff id="S3.E3.m1.1.1.1.1.6.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.6.3.3.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.6.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.6.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.6.3.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.6.3.3.2">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.6.3.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.6.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.6.3.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.6.3.3.2">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.6.3.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.6.3.3.2.2.2">𝑦</ci><ci id="S3.E3.m1.1.1.1.1.6.3.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.6.3.3.2.2.3">𝑖</ci></apply><ci id="S3.E3.m1.1.1.1.1.6.3.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.6.3.3.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">x_{t}=\sum_{t=1}^{n}\frac{\partial\mathcal{L}_{t}}{\partial y^{i}_{t}}x_{t}\oslash\sum_{t=1}^{n}\frac{\partial\mathcal{L}_{t}}{\partial y^{i}_{t}}=\frac{\partial\mathcal{L}_{t}}{\partial y^{i}_{t}}x_{t}\oslash\frac{\partial\mathcal{L}_{t}}{\partial y^{i}_{t}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.14" class="ltx_p">For a batch of <math id="S3.SS2.p2.14.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p2.14.m1.1a"><mi id="S3.SS2.p2.14.m1.1.1" xref="S3.SS2.p2.14.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.m1.1b"><ci id="S3.SS2.p2.14.m1.1.1.cmml" xref="S3.SS2.p2.14.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.m1.1c">n</annotation></semantics></math> data points with unique labels, we could thus recover all data points exactly for this multinomial logistic regression. We visualize this in Appendix <a href="#A1.F11" title="In A.6 Additional Images ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">11</span></a> for ImageNet data <cite class="ltx_cite ltx_citemacro_citet">Russakovsky et al. (<a href="#bib.bib29" title="" class="ltx_ref">2015</a>)</cite> (image classification, 1000 classes), where we could technically recover up to 1000 unique data points in the optimal case. However, this setup is impractical and suffers from several significant problems:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p"><span id="S3.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Averaging</span>: Multiple image reconstruction as described above is only possible in the linear setting, and with a logistic regression loss, a loss that depends on sparse logits is used. Even in this restrictive setting, reconstruction fails as soon as labels are repeated in a user update (which is the default case and outside the control of the server), especially if the accumulation size of a user update is larger than the underlying label space of the data. In this case, the server reconstructs the <em id="S3.I1.i1.p1.1.2" class="ltx_emph ltx_font_italic">average</em> of repeated classes. In Appendix <a href="#A1.F11" title="In A.6 Additional Images ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">11</span></a>, we see that in the worst-case scenario where all data points fall into the same class, each piece of user data contributes to the gradient equally, resulting in a mashup reconstruction that leaks little private information.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p"><span id="S3.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Integration</span>: As stated above, the naive reconstruction is only guaranteed to work only if the linear (single-layer) model is a standalone model, and not within a larger network. If the naive linear model was placed before another network, like a ResNet-18, then gradient entries for the linear layer contain elements averaged over all labels, as the combined network ostensibly depends on each output of the linear layer.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i3.p1.1" class="ltx_p"><span id="S3.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Scalability</span>: on an industrial scale dataset like ImageNet, the naive logistic regression model would require <math id="S3.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="&gt;150M" display="inline"><semantics id="S3.I1.i3.p1.1.m1.1a"><mrow id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.2" xref="S3.I1.i3.p1.1.m1.1.1.2.cmml"></mi><mo id="S3.I1.i3.p1.1.m1.1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.1.cmml">&gt;</mo><mrow id="S3.I1.i3.p1.1.m1.1.1.3" xref="S3.I1.i3.p1.1.m1.1.1.3.cmml"><mn id="S3.I1.i3.p1.1.m1.1.1.3.2" xref="S3.I1.i3.p1.1.m1.1.1.3.2.cmml">150</mn><mo lspace="0em" rspace="0em" id="S3.I1.i3.p1.1.m1.1.1.3.1" xref="S3.I1.i3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.I1.i3.p1.1.m1.1.1.3.3" xref="S3.I1.i3.p1.1.m1.1.1.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><apply id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1"><gt id="S3.I1.i3.p1.1.m1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S3.I1.i3.p1.1.m1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2">absent</csymbol><apply id="S3.I1.i3.p1.1.m1.1.1.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3"><times id="S3.I1.i3.p1.1.m1.1.1.3.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3.1"></times><cn type="integer" id="S3.I1.i3.p1.1.m1.1.1.3.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3.2">150</cn><ci id="S3.I1.i3.p1.1.m1.1.1.3.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">&gt;150M</annotation></semantics></math> parameters to retrieve an image from each label, which is of course far from any practical application.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Imprinting User Information into Model Updates</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.1" class="ltx_p">Nonetheless, the perfect reconstruction afforded by the linear model remains an attractive feature. To this end, we introduce the <em id="S3.SS3.p1.1.1" class="ltx_emph ltx_font_italic">imprint module</em> class of modifications which overcome the previously described issues, while maintaining the superior reconstruction abilities of an analytic reconstruction as described above. Further, the imprint module can be constructed from a combination of commonly used architectural features with maliciously modified parameters that can create structured gradient entries for large volumes of data.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.3" class="ltx_p">The imprint module can be constructed with a single linear layer (with bias), together with a ReLU activation. Formally, let <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\{x_{i}\}_{i=1}^{n}=X\in\mathbb{R}^{n\times m}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><msubsup id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml"><mrow id="S3.SS3.p2.1.m1.1.1.1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS3.p2.1.m1.1.1.1.1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS3.p2.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.p2.1.m1.1.1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p2.1.m1.1.1.1.1.3.1" xref="S3.SS3.p2.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS3.p2.1.m1.1.1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.1.m1.1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.1.3.cmml">n</mi></msubsup><mo id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">=</mo><mi id="S3.SS3.p2.1.m1.1.1.4" xref="S3.SS3.p2.1.m1.1.1.4.cmml">X</mi><mo id="S3.SS3.p2.1.m1.1.1.5" xref="S3.SS3.p2.1.m1.1.1.5.cmml">∈</mo><msup id="S3.SS3.p2.1.m1.1.1.6" xref="S3.SS3.p2.1.m1.1.1.6.cmml"><mi id="S3.SS3.p2.1.m1.1.1.6.2" xref="S3.SS3.p2.1.m1.1.1.6.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.1.m1.1.1.6.3" xref="S3.SS3.p2.1.m1.1.1.6.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.6.3.2" xref="S3.SS3.p2.1.m1.1.1.6.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.1.m1.1.1.6.3.1" xref="S3.SS3.p2.1.m1.1.1.6.3.1.cmml">×</mo><mi id="S3.SS3.p2.1.m1.1.1.6.3.3" xref="S3.SS3.p2.1.m1.1.1.6.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><and id="S3.SS3.p2.1.m1.1.1a.cmml" xref="S3.SS3.p2.1.m1.1.1"></and><apply id="S3.SS3.p2.1.m1.1.1b.cmml" xref="S3.SS3.p2.1.m1.1.1"><eq id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"></eq><apply id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.1.m1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.1">subscript</csymbol><set id="S3.SS3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1"><apply id="S3.SS3.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS3.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS3.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.3"><eq id="S3.SS3.p2.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.3.1"></eq><ci id="S3.SS3.p2.1.m1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p2.1.m1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.1.m1.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.1.3">𝑛</ci></apply><ci id="S3.SS3.p2.1.m1.1.1.4.cmml" xref="S3.SS3.p2.1.m1.1.1.4">𝑋</ci></apply><apply id="S3.SS3.p2.1.m1.1.1c.cmml" xref="S3.SS3.p2.1.m1.1.1"><in id="S3.SS3.p2.1.m1.1.1.5.cmml" xref="S3.SS3.p2.1.m1.1.1.5"></in><share href="#S3.SS3.p2.1.m1.1.1.4.cmml" id="S3.SS3.p2.1.m1.1.1d.cmml" xref="S3.SS3.p2.1.m1.1.1"></share><apply id="S3.SS3.p2.1.m1.1.1.6.cmml" xref="S3.SS3.p2.1.m1.1.1.6"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.6.1.cmml" xref="S3.SS3.p2.1.m1.1.1.6">superscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.6.2.cmml" xref="S3.SS3.p2.1.m1.1.1.6.2">ℝ</ci><apply id="S3.SS3.p2.1.m1.1.1.6.3.cmml" xref="S3.SS3.p2.1.m1.1.1.6.3"><times id="S3.SS3.p2.1.m1.1.1.6.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.6.3.1"></times><ci id="S3.SS3.p2.1.m1.1.1.6.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.6.3.2">𝑛</ci><ci id="S3.SS3.p2.1.m1.1.1.6.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.6.3.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\{x_{i}\}_{i=1}^{n}=X\in\mathbb{R}^{n\times m}</annotation></semantics></math> be a batch of size <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">n</annotation></semantics></math> of user data, then a malicious server can define an imprint module whose forward pass (on a single datapoint, <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">x</annotation></semantics></math>) looks like</p>
<table id="S3.Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex3.m1.2" class="ltx_Math" alttext="M(x)=f(W_{*}x+b_{*})," display="block"><semantics id="S3.Ex3.m1.2a"><mrow id="S3.Ex3.m1.2.2.1" xref="S3.Ex3.m1.2.2.1.1.cmml"><mrow id="S3.Ex3.m1.2.2.1.1" xref="S3.Ex3.m1.2.2.1.1.cmml"><mrow id="S3.Ex3.m1.2.2.1.1.3" xref="S3.Ex3.m1.2.2.1.1.3.cmml"><mi id="S3.Ex3.m1.2.2.1.1.3.2" xref="S3.Ex3.m1.2.2.1.1.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.2.2.1.1.3.1" xref="S3.Ex3.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.Ex3.m1.2.2.1.1.3.3.2" xref="S3.Ex3.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.Ex3.m1.2.2.1.1.3.3.2.1" xref="S3.Ex3.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.Ex3.m1.2.2.1.1.3.3.2.2" xref="S3.Ex3.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.2.2.1.1.2" xref="S3.Ex3.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.Ex3.m1.2.2.1.1.1" xref="S3.Ex3.m1.2.2.1.1.1.cmml"><mi id="S3.Ex3.m1.2.2.1.1.1.3" xref="S3.Ex3.m1.2.2.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.2.2.1.1.1.2" xref="S3.Ex3.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex3.m1.2.2.1.1.1.1.1" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex3.m1.2.2.1.1.1.1.1.2" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.2.2.1.1.1.1.1.1" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">W</mi><mo id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">∗</mo></msub><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.1" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.3.cmml">x</mi></mrow><mo id="S3.Ex3.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.Ex3.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex3.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.3.2.cmml">b</mi><mo id="S3.Ex3.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.3.3.cmml">∗</mo></msub></mrow><mo stretchy="false" id="S3.Ex3.m1.2.2.1.1.1.1.1.3" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex3.m1.2.2.1.2" xref="S3.Ex3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.2b"><apply id="S3.Ex3.m1.2.2.1.1.cmml" xref="S3.Ex3.m1.2.2.1"><eq id="S3.Ex3.m1.2.2.1.1.2.cmml" xref="S3.Ex3.m1.2.2.1.1.2"></eq><apply id="S3.Ex3.m1.2.2.1.1.3.cmml" xref="S3.Ex3.m1.2.2.1.1.3"><times id="S3.Ex3.m1.2.2.1.1.3.1.cmml" xref="S3.Ex3.m1.2.2.1.1.3.1"></times><ci id="S3.Ex3.m1.2.2.1.1.3.2.cmml" xref="S3.Ex3.m1.2.2.1.1.3.2">𝑀</ci><ci id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1">𝑥</ci></apply><apply id="S3.Ex3.m1.2.2.1.1.1.cmml" xref="S3.Ex3.m1.2.2.1.1.1"><times id="S3.Ex3.m1.2.2.1.1.1.2.cmml" xref="S3.Ex3.m1.2.2.1.1.1.2"></times><ci id="S3.Ex3.m1.2.2.1.1.1.3.cmml" xref="S3.Ex3.m1.2.2.1.1.1.3">𝑓</ci><apply id="S3.Ex3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1"><plus id="S3.Ex3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.1"></plus><apply id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2"><times id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2.2">𝑊</ci><times id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.2.3"></times></apply><ci id="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.2.3">𝑥</ci></apply><apply id="S3.Ex3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex3.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.3.2">𝑏</ci><times id="S3.Ex3.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex3.m1.2.2.1.1.1.1.1.1.3.3"></times></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.2c">M(x)=f(W_{*}x+b_{*}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.13" class="ltx_p">where <math id="S3.SS3.p2.4.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS3.p2.4.m1.1a"><mi id="S3.SS3.p2.4.m1.1.1" xref="S3.SS3.p2.4.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m1.1b"><ci id="S3.SS3.p2.4.m1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m1.1c">f</annotation></semantics></math> is a standard ReLU nonlinearity. The crux of the imprint module lies in the construction of <math id="S3.SS3.p2.5.m2.1" class="ltx_Math" alttext="W_{*}\in\mathbb{R}^{k\times m}" display="inline"><semantics id="S3.SS3.p2.5.m2.1a"><mrow id="S3.SS3.p2.5.m2.1.1" xref="S3.SS3.p2.5.m2.1.1.cmml"><msub id="S3.SS3.p2.5.m2.1.1.2" xref="S3.SS3.p2.5.m2.1.1.2.cmml"><mi id="S3.SS3.p2.5.m2.1.1.2.2" xref="S3.SS3.p2.5.m2.1.1.2.2.cmml">W</mi><mo id="S3.SS3.p2.5.m2.1.1.2.3" xref="S3.SS3.p2.5.m2.1.1.2.3.cmml">∗</mo></msub><mo id="S3.SS3.p2.5.m2.1.1.1" xref="S3.SS3.p2.5.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.5.m2.1.1.3" xref="S3.SS3.p2.5.m2.1.1.3.cmml"><mi id="S3.SS3.p2.5.m2.1.1.3.2" xref="S3.SS3.p2.5.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.5.m2.1.1.3.3" xref="S3.SS3.p2.5.m2.1.1.3.3.cmml"><mi id="S3.SS3.p2.5.m2.1.1.3.3.2" xref="S3.SS3.p2.5.m2.1.1.3.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.5.m2.1.1.3.3.1" xref="S3.SS3.p2.5.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p2.5.m2.1.1.3.3.3" xref="S3.SS3.p2.5.m2.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m2.1b"><apply id="S3.SS3.p2.5.m2.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1"><in id="S3.SS3.p2.5.m2.1.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1.1"></in><apply id="S3.SS3.p2.5.m2.1.1.2.cmml" xref="S3.SS3.p2.5.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m2.1.1.2.1.cmml" xref="S3.SS3.p2.5.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.5.m2.1.1.2.2.cmml" xref="S3.SS3.p2.5.m2.1.1.2.2">𝑊</ci><times id="S3.SS3.p2.5.m2.1.1.2.3.cmml" xref="S3.SS3.p2.5.m2.1.1.2.3"></times></apply><apply id="S3.SS3.p2.5.m2.1.1.3.cmml" xref="S3.SS3.p2.5.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m2.1.1.3.1.cmml" xref="S3.SS3.p2.5.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.5.m2.1.1.3.2.cmml" xref="S3.SS3.p2.5.m2.1.1.3.2">ℝ</ci><apply id="S3.SS3.p2.5.m2.1.1.3.3.cmml" xref="S3.SS3.p2.5.m2.1.1.3.3"><times id="S3.SS3.p2.5.m2.1.1.3.3.1.cmml" xref="S3.SS3.p2.5.m2.1.1.3.3.1"></times><ci id="S3.SS3.p2.5.m2.1.1.3.3.2.cmml" xref="S3.SS3.p2.5.m2.1.1.3.3.2">𝑘</ci><ci id="S3.SS3.p2.5.m2.1.1.3.3.3.cmml" xref="S3.SS3.p2.5.m2.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m2.1c">W_{*}\in\mathbb{R}^{k\times m}</annotation></semantics></math> and <math id="S3.SS3.p2.6.m3.1" class="ltx_Math" alttext="b_{*}\in\mathbb{R}^{k}" display="inline"><semantics id="S3.SS3.p2.6.m3.1a"><mrow id="S3.SS3.p2.6.m3.1.1" xref="S3.SS3.p2.6.m3.1.1.cmml"><msub id="S3.SS3.p2.6.m3.1.1.2" xref="S3.SS3.p2.6.m3.1.1.2.cmml"><mi id="S3.SS3.p2.6.m3.1.1.2.2" xref="S3.SS3.p2.6.m3.1.1.2.2.cmml">b</mi><mo id="S3.SS3.p2.6.m3.1.1.2.3" xref="S3.SS3.p2.6.m3.1.1.2.3.cmml">∗</mo></msub><mo id="S3.SS3.p2.6.m3.1.1.1" xref="S3.SS3.p2.6.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.6.m3.1.1.3" xref="S3.SS3.p2.6.m3.1.1.3.cmml"><mi id="S3.SS3.p2.6.m3.1.1.3.2" xref="S3.SS3.p2.6.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.p2.6.m3.1.1.3.3" xref="S3.SS3.p2.6.m3.1.1.3.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m3.1b"><apply id="S3.SS3.p2.6.m3.1.1.cmml" xref="S3.SS3.p2.6.m3.1.1"><in id="S3.SS3.p2.6.m3.1.1.1.cmml" xref="S3.SS3.p2.6.m3.1.1.1"></in><apply id="S3.SS3.p2.6.m3.1.1.2.cmml" xref="S3.SS3.p2.6.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m3.1.1.2.1.cmml" xref="S3.SS3.p2.6.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.6.m3.1.1.2.2.cmml" xref="S3.SS3.p2.6.m3.1.1.2.2">𝑏</ci><times id="S3.SS3.p2.6.m3.1.1.2.3.cmml" xref="S3.SS3.p2.6.m3.1.1.2.3"></times></apply><apply id="S3.SS3.p2.6.m3.1.1.3.cmml" xref="S3.SS3.p2.6.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m3.1.1.3.1.cmml" xref="S3.SS3.p2.6.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.6.m3.1.1.3.2.cmml" xref="S3.SS3.p2.6.m3.1.1.3.2">ℝ</ci><ci id="S3.SS3.p2.6.m3.1.1.3.3.cmml" xref="S3.SS3.p2.6.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m3.1c">b_{*}\in\mathbb{R}^{k}</annotation></semantics></math>. We denote the <math id="S3.SS3.p2.7.m4.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS3.p2.7.m4.1a"><msup id="S3.SS3.p2.7.m4.1.1" xref="S3.SS3.p2.7.m4.1.1.cmml"><mi id="S3.SS3.p2.7.m4.1.1.2" xref="S3.SS3.p2.7.m4.1.1.2.cmml">i</mi><mrow id="S3.SS3.p2.7.m4.1.1.3" xref="S3.SS3.p2.7.m4.1.1.3.cmml"><mi id="S3.SS3.p2.7.m4.1.1.3.2" xref="S3.SS3.p2.7.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.7.m4.1.1.3.1" xref="S3.SS3.p2.7.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.7.m4.1.1.3.3" xref="S3.SS3.p2.7.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m4.1b"><apply id="S3.SS3.p2.7.m4.1.1.cmml" xref="S3.SS3.p2.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m4.1.1.1.cmml" xref="S3.SS3.p2.7.m4.1.1">superscript</csymbol><ci id="S3.SS3.p2.7.m4.1.1.2.cmml" xref="S3.SS3.p2.7.m4.1.1.2">𝑖</ci><apply id="S3.SS3.p2.7.m4.1.1.3.cmml" xref="S3.SS3.p2.7.m4.1.1.3"><times id="S3.SS3.p2.7.m4.1.1.3.1.cmml" xref="S3.SS3.p2.7.m4.1.1.3.1"></times><ci id="S3.SS3.p2.7.m4.1.1.3.2.cmml" xref="S3.SS3.p2.7.m4.1.1.3.2">𝑡</ci><ci id="S3.SS3.p2.7.m4.1.1.3.3.cmml" xref="S3.SS3.p2.7.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m4.1c">i^{th}</annotation></semantics></math> row (or channel) of <math id="S3.SS3.p2.8.m5.1" class="ltx_Math" alttext="W_{*}" display="inline"><semantics id="S3.SS3.p2.8.m5.1a"><msub id="S3.SS3.p2.8.m5.1.1" xref="S3.SS3.p2.8.m5.1.1.cmml"><mi id="S3.SS3.p2.8.m5.1.1.2" xref="S3.SS3.p2.8.m5.1.1.2.cmml">W</mi><mo id="S3.SS3.p2.8.m5.1.1.3" xref="S3.SS3.p2.8.m5.1.1.3.cmml">∗</mo></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m5.1b"><apply id="S3.SS3.p2.8.m5.1.1.cmml" xref="S3.SS3.p2.8.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m5.1.1.1.cmml" xref="S3.SS3.p2.8.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m5.1.1.2.cmml" xref="S3.SS3.p2.8.m5.1.1.2">𝑊</ci><times id="S3.SS3.p2.8.m5.1.1.3.cmml" xref="S3.SS3.p2.8.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m5.1c">W_{*}</annotation></semantics></math> and the <math id="S3.SS3.p2.9.m6.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS3.p2.9.m6.1a"><msup id="S3.SS3.p2.9.m6.1.1" xref="S3.SS3.p2.9.m6.1.1.cmml"><mi id="S3.SS3.p2.9.m6.1.1.2" xref="S3.SS3.p2.9.m6.1.1.2.cmml">i</mi><mrow id="S3.SS3.p2.9.m6.1.1.3" xref="S3.SS3.p2.9.m6.1.1.3.cmml"><mi id="S3.SS3.p2.9.m6.1.1.3.2" xref="S3.SS3.p2.9.m6.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.9.m6.1.1.3.1" xref="S3.SS3.p2.9.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p2.9.m6.1.1.3.3" xref="S3.SS3.p2.9.m6.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m6.1b"><apply id="S3.SS3.p2.9.m6.1.1.cmml" xref="S3.SS3.p2.9.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m6.1.1.1.cmml" xref="S3.SS3.p2.9.m6.1.1">superscript</csymbol><ci id="S3.SS3.p2.9.m6.1.1.2.cmml" xref="S3.SS3.p2.9.m6.1.1.2">𝑖</ci><apply id="S3.SS3.p2.9.m6.1.1.3.cmml" xref="S3.SS3.p2.9.m6.1.1.3"><times id="S3.SS3.p2.9.m6.1.1.3.1.cmml" xref="S3.SS3.p2.9.m6.1.1.3.1"></times><ci id="S3.SS3.p2.9.m6.1.1.3.2.cmml" xref="S3.SS3.p2.9.m6.1.1.3.2">𝑡</ci><ci id="S3.SS3.p2.9.m6.1.1.3.3.cmml" xref="S3.SS3.p2.9.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m6.1c">i^{th}</annotation></semantics></math> entry of <math id="S3.SS3.p2.10.m7.1" class="ltx_Math" alttext="b_{*}" display="inline"><semantics id="S3.SS3.p2.10.m7.1a"><msub id="S3.SS3.p2.10.m7.1.1" xref="S3.SS3.p2.10.m7.1.1.cmml"><mi id="S3.SS3.p2.10.m7.1.1.2" xref="S3.SS3.p2.10.m7.1.1.2.cmml">b</mi><mo id="S3.SS3.p2.10.m7.1.1.3" xref="S3.SS3.p2.10.m7.1.1.3.cmml">∗</mo></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m7.1b"><apply id="S3.SS3.p2.10.m7.1.1.cmml" xref="S3.SS3.p2.10.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m7.1.1.1.cmml" xref="S3.SS3.p2.10.m7.1.1">subscript</csymbol><ci id="S3.SS3.p2.10.m7.1.1.2.cmml" xref="S3.SS3.p2.10.m7.1.1.2">𝑏</ci><times id="S3.SS3.p2.10.m7.1.1.3.cmml" xref="S3.SS3.p2.10.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m7.1c">b_{*}</annotation></semantics></math> as <math id="S3.SS3.p2.11.m8.1" class="ltx_Math" alttext="W_{*}^{i}" display="inline"><semantics id="S3.SS3.p2.11.m8.1a"><msubsup id="S3.SS3.p2.11.m8.1.1" xref="S3.SS3.p2.11.m8.1.1.cmml"><mi id="S3.SS3.p2.11.m8.1.1.2.2" xref="S3.SS3.p2.11.m8.1.1.2.2.cmml">W</mi><mo id="S3.SS3.p2.11.m8.1.1.2.3" xref="S3.SS3.p2.11.m8.1.1.2.3.cmml">∗</mo><mi id="S3.SS3.p2.11.m8.1.1.3" xref="S3.SS3.p2.11.m8.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m8.1b"><apply id="S3.SS3.p2.11.m8.1.1.cmml" xref="S3.SS3.p2.11.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.11.m8.1.1.1.cmml" xref="S3.SS3.p2.11.m8.1.1">superscript</csymbol><apply id="S3.SS3.p2.11.m8.1.1.2.cmml" xref="S3.SS3.p2.11.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.11.m8.1.1.2.1.cmml" xref="S3.SS3.p2.11.m8.1.1">subscript</csymbol><ci id="S3.SS3.p2.11.m8.1.1.2.2.cmml" xref="S3.SS3.p2.11.m8.1.1.2.2">𝑊</ci><times id="S3.SS3.p2.11.m8.1.1.2.3.cmml" xref="S3.SS3.p2.11.m8.1.1.2.3"></times></apply><ci id="S3.SS3.p2.11.m8.1.1.3.cmml" xref="S3.SS3.p2.11.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m8.1c">W_{*}^{i}</annotation></semantics></math> and <math id="S3.SS3.p2.12.m9.1" class="ltx_Math" alttext="b_{*}^{i}" display="inline"><semantics id="S3.SS3.p2.12.m9.1a"><msubsup id="S3.SS3.p2.12.m9.1.1" xref="S3.SS3.p2.12.m9.1.1.cmml"><mi id="S3.SS3.p2.12.m9.1.1.2.2" xref="S3.SS3.p2.12.m9.1.1.2.2.cmml">b</mi><mo id="S3.SS3.p2.12.m9.1.1.2.3" xref="S3.SS3.p2.12.m9.1.1.2.3.cmml">∗</mo><mi id="S3.SS3.p2.12.m9.1.1.3" xref="S3.SS3.p2.12.m9.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m9.1b"><apply id="S3.SS3.p2.12.m9.1.1.cmml" xref="S3.SS3.p2.12.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.12.m9.1.1.1.cmml" xref="S3.SS3.p2.12.m9.1.1">superscript</csymbol><apply id="S3.SS3.p2.12.m9.1.1.2.cmml" xref="S3.SS3.p2.12.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.12.m9.1.1.2.1.cmml" xref="S3.SS3.p2.12.m9.1.1">subscript</csymbol><ci id="S3.SS3.p2.12.m9.1.1.2.2.cmml" xref="S3.SS3.p2.12.m9.1.1.2.2">𝑏</ci><times id="S3.SS3.p2.12.m9.1.1.2.3.cmml" xref="S3.SS3.p2.12.m9.1.1.2.3"></times></apply><ci id="S3.SS3.p2.12.m9.1.1.3.cmml" xref="S3.SS3.p2.12.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m9.1c">b_{*}^{i}</annotation></semantics></math>, respectively. We then construct <math id="S3.SS3.p2.13.m10.1" class="ltx_Math" alttext="W_{*}^{(i)}" display="inline"><semantics id="S3.SS3.p2.13.m10.1a"><msubsup id="S3.SS3.p2.13.m10.1.2" xref="S3.SS3.p2.13.m10.1.2.cmml"><mi id="S3.SS3.p2.13.m10.1.2.2.2" xref="S3.SS3.p2.13.m10.1.2.2.2.cmml">W</mi><mo id="S3.SS3.p2.13.m10.1.2.2.3" xref="S3.SS3.p2.13.m10.1.2.2.3.cmml">∗</mo><mrow id="S3.SS3.p2.13.m10.1.1.1.3" xref="S3.SS3.p2.13.m10.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.13.m10.1.1.1.3.1" xref="S3.SS3.p2.13.m10.1.2.cmml">(</mo><mi id="S3.SS3.p2.13.m10.1.1.1.1" xref="S3.SS3.p2.13.m10.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.p2.13.m10.1.1.1.3.2" xref="S3.SS3.p2.13.m10.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m10.1b"><apply id="S3.SS3.p2.13.m10.1.2.cmml" xref="S3.SS3.p2.13.m10.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.13.m10.1.2.1.cmml" xref="S3.SS3.p2.13.m10.1.2">superscript</csymbol><apply id="S3.SS3.p2.13.m10.1.2.2.cmml" xref="S3.SS3.p2.13.m10.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.13.m10.1.2.2.1.cmml" xref="S3.SS3.p2.13.m10.1.2">subscript</csymbol><ci id="S3.SS3.p2.13.m10.1.2.2.2.cmml" xref="S3.SS3.p2.13.m10.1.2.2.2">𝑊</ci><times id="S3.SS3.p2.13.m10.1.2.2.3.cmml" xref="S3.SS3.p2.13.m10.1.2.2.3"></times></apply><ci id="S3.SS3.p2.13.m10.1.1.1.1.cmml" xref="S3.SS3.p2.13.m10.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m10.1c">W_{*}^{(i)}</annotation></semantics></math> so that</p>
<table id="S3.Ex4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex4.m1.3" class="ltx_Math" alttext="\langle W_{*}^{i},x\rangle=h(x)," display="block"><semantics id="S3.Ex4.m1.3a"><mrow id="S3.Ex4.m1.3.3.1" xref="S3.Ex4.m1.3.3.1.1.cmml"><mrow id="S3.Ex4.m1.3.3.1.1" xref="S3.Ex4.m1.3.3.1.1.cmml"><mrow id="S3.Ex4.m1.3.3.1.1.1.1" xref="S3.Ex4.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex4.m1.3.3.1.1.1.1.2" xref="S3.Ex4.m1.3.3.1.1.1.2.cmml">⟨</mo><msubsup id="S3.Ex4.m1.3.3.1.1.1.1.1" xref="S3.Ex4.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.3.3.1.1.1.1.1.2.2" xref="S3.Ex4.m1.3.3.1.1.1.1.1.2.2.cmml">W</mi><mo id="S3.Ex4.m1.3.3.1.1.1.1.1.2.3" xref="S3.Ex4.m1.3.3.1.1.1.1.1.2.3.cmml">∗</mo><mi id="S3.Ex4.m1.3.3.1.1.1.1.1.3" xref="S3.Ex4.m1.3.3.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.Ex4.m1.3.3.1.1.1.1.3" xref="S3.Ex4.m1.3.3.1.1.1.2.cmml">,</mo><mi id="S3.Ex4.m1.1.1" xref="S3.Ex4.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.Ex4.m1.3.3.1.1.1.1.4" xref="S3.Ex4.m1.3.3.1.1.1.2.cmml">⟩</mo></mrow><mo id="S3.Ex4.m1.3.3.1.1.2" xref="S3.Ex4.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.Ex4.m1.3.3.1.1.3" xref="S3.Ex4.m1.3.3.1.1.3.cmml"><mi id="S3.Ex4.m1.3.3.1.1.3.2" xref="S3.Ex4.m1.3.3.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.3.3.1.1.3.1" xref="S3.Ex4.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.Ex4.m1.3.3.1.1.3.3.2" xref="S3.Ex4.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S3.Ex4.m1.3.3.1.1.3.3.2.1" xref="S3.Ex4.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.Ex4.m1.2.2" xref="S3.Ex4.m1.2.2.cmml">x</mi><mo stretchy="false" id="S3.Ex4.m1.3.3.1.1.3.3.2.2" xref="S3.Ex4.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex4.m1.3.3.1.2" xref="S3.Ex4.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.3b"><apply id="S3.Ex4.m1.3.3.1.1.cmml" xref="S3.Ex4.m1.3.3.1"><eq id="S3.Ex4.m1.3.3.1.1.2.cmml" xref="S3.Ex4.m1.3.3.1.1.2"></eq><list id="S3.Ex4.m1.3.3.1.1.1.2.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1"><apply id="S3.Ex4.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex4.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex4.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1.1.2.2">𝑊</ci><times id="S3.Ex4.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1.1.2.3"></times></apply><ci id="S3.Ex4.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.3.3.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.Ex4.m1.1.1.cmml" xref="S3.Ex4.m1.1.1">𝑥</ci></list><apply id="S3.Ex4.m1.3.3.1.1.3.cmml" xref="S3.Ex4.m1.3.3.1.1.3"><times id="S3.Ex4.m1.3.3.1.1.3.1.cmml" xref="S3.Ex4.m1.3.3.1.1.3.1"></times><ci id="S3.Ex4.m1.3.3.1.1.3.2.cmml" xref="S3.Ex4.m1.3.3.1.1.3.2">ℎ</ci><ci id="S3.Ex4.m1.2.2.cmml" xref="S3.Ex4.m1.2.2">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.3c">\langle W_{*}^{i},x\rangle=h(x),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.23" class="ltx_p">where <math id="S3.SS3.p2.14.m1.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS3.p2.14.m1.1a"><mi id="S3.SS3.p2.14.m1.1.1" xref="S3.SS3.p2.14.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m1.1b"><ci id="S3.SS3.p2.14.m1.1.1.cmml" xref="S3.SS3.p2.14.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m1.1c">h</annotation></semantics></math> is <em id="S3.SS3.p2.23.1" class="ltx_emph ltx_font_italic">any</em> linear function of the data where the server can estimate the distribution of values <math id="S3.SS3.p2.15.m2.2" class="ltx_Math" alttext="\{h(x)\}_{x\sim\mathcal{D}}" display="inline"><semantics id="S3.SS3.p2.15.m2.2a"><msub id="S3.SS3.p2.15.m2.2.2" xref="S3.SS3.p2.15.m2.2.2.cmml"><mrow id="S3.SS3.p2.15.m2.2.2.1.1" xref="S3.SS3.p2.15.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.15.m2.2.2.1.1.2" xref="S3.SS3.p2.15.m2.2.2.1.2.cmml">{</mo><mrow id="S3.SS3.p2.15.m2.2.2.1.1.1" xref="S3.SS3.p2.15.m2.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.15.m2.2.2.1.1.1.2" xref="S3.SS3.p2.15.m2.2.2.1.1.1.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.15.m2.2.2.1.1.1.1" xref="S3.SS3.p2.15.m2.2.2.1.1.1.1.cmml">​</mo><mrow id="S3.SS3.p2.15.m2.2.2.1.1.1.3.2" xref="S3.SS3.p2.15.m2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.15.m2.2.2.1.1.1.3.2.1" xref="S3.SS3.p2.15.m2.2.2.1.1.1.cmml">(</mo><mi id="S3.SS3.p2.15.m2.1.1" xref="S3.SS3.p2.15.m2.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS3.p2.15.m2.2.2.1.1.1.3.2.2" xref="S3.SS3.p2.15.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.p2.15.m2.2.2.1.1.3" xref="S3.SS3.p2.15.m2.2.2.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.p2.15.m2.2.2.3" xref="S3.SS3.p2.15.m2.2.2.3.cmml"><mi id="S3.SS3.p2.15.m2.2.2.3.2" xref="S3.SS3.p2.15.m2.2.2.3.2.cmml">x</mi><mo id="S3.SS3.p2.15.m2.2.2.3.1" xref="S3.SS3.p2.15.m2.2.2.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.15.m2.2.2.3.3" xref="S3.SS3.p2.15.m2.2.2.3.3.cmml">𝒟</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.15.m2.2b"><apply id="S3.SS3.p2.15.m2.2.2.cmml" xref="S3.SS3.p2.15.m2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.15.m2.2.2.2.cmml" xref="S3.SS3.p2.15.m2.2.2">subscript</csymbol><set id="S3.SS3.p2.15.m2.2.2.1.2.cmml" xref="S3.SS3.p2.15.m2.2.2.1.1"><apply id="S3.SS3.p2.15.m2.2.2.1.1.1.cmml" xref="S3.SS3.p2.15.m2.2.2.1.1.1"><times id="S3.SS3.p2.15.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.15.m2.2.2.1.1.1.1"></times><ci id="S3.SS3.p2.15.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.15.m2.2.2.1.1.1.2">ℎ</ci><ci id="S3.SS3.p2.15.m2.1.1.cmml" xref="S3.SS3.p2.15.m2.1.1">𝑥</ci></apply></set><apply id="S3.SS3.p2.15.m2.2.2.3.cmml" xref="S3.SS3.p2.15.m2.2.2.3"><csymbol cd="latexml" id="S3.SS3.p2.15.m2.2.2.3.1.cmml" xref="S3.SS3.p2.15.m2.2.2.3.1">similar-to</csymbol><ci id="S3.SS3.p2.15.m2.2.2.3.2.cmml" xref="S3.SS3.p2.15.m2.2.2.3.2">𝑥</ci><ci id="S3.SS3.p2.15.m2.2.2.3.3.cmml" xref="S3.SS3.p2.15.m2.2.2.3.3">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.15.m2.2c">\{h(x)\}_{x\sim\mathcal{D}}</annotation></semantics></math> of this function on the user data distribution. For example, if the user data are images, <math id="S3.SS3.p2.16.m3.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS3.p2.16.m3.1a"><mi id="S3.SS3.p2.16.m3.1.1" xref="S3.SS3.p2.16.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.16.m3.1b"><ci id="S3.SS3.p2.16.m3.1.1.cmml" xref="S3.SS3.p2.16.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.16.m3.1c">h</annotation></semantics></math> could be average brightness, in which case <math id="S3.SS3.p2.17.m4.1" class="ltx_Math" alttext="W_{*}^{i}" display="inline"><semantics id="S3.SS3.p2.17.m4.1a"><msubsup id="S3.SS3.p2.17.m4.1.1" xref="S3.SS3.p2.17.m4.1.1.cmml"><mi id="S3.SS3.p2.17.m4.1.1.2.2" xref="S3.SS3.p2.17.m4.1.1.2.2.cmml">W</mi><mo id="S3.SS3.p2.17.m4.1.1.2.3" xref="S3.SS3.p2.17.m4.1.1.2.3.cmml">∗</mo><mi id="S3.SS3.p2.17.m4.1.1.3" xref="S3.SS3.p2.17.m4.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.17.m4.1b"><apply id="S3.SS3.p2.17.m4.1.1.cmml" xref="S3.SS3.p2.17.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m4.1.1.1.cmml" xref="S3.SS3.p2.17.m4.1.1">superscript</csymbol><apply id="S3.SS3.p2.17.m4.1.1.2.cmml" xref="S3.SS3.p2.17.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m4.1.1.2.1.cmml" xref="S3.SS3.p2.17.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.17.m4.1.1.2.2.cmml" xref="S3.SS3.p2.17.m4.1.1.2.2">𝑊</ci><times id="S3.SS3.p2.17.m4.1.1.2.3.cmml" xref="S3.SS3.p2.17.m4.1.1.2.3"></times></apply><ci id="S3.SS3.p2.17.m4.1.1.3.cmml" xref="S3.SS3.p2.17.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.17.m4.1c">W_{*}^{i}</annotation></semantics></math> is simply the row vector with entries identically equal to <math id="S3.SS3.p2.18.m5.1" class="ltx_Math" alttext="\frac{1}{m}" display="inline"><semantics id="S3.SS3.p2.18.m5.1a"><mfrac id="S3.SS3.p2.18.m5.1.1" xref="S3.SS3.p2.18.m5.1.1.cmml"><mn id="S3.SS3.p2.18.m5.1.1.2" xref="S3.SS3.p2.18.m5.1.1.2.cmml">1</mn><mi id="S3.SS3.p2.18.m5.1.1.3" xref="S3.SS3.p2.18.m5.1.1.3.cmml">m</mi></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.18.m5.1b"><apply id="S3.SS3.p2.18.m5.1.1.cmml" xref="S3.SS3.p2.18.m5.1.1"><divide id="S3.SS3.p2.18.m5.1.1.1.cmml" xref="S3.SS3.p2.18.m5.1.1"></divide><cn type="integer" id="S3.SS3.p2.18.m5.1.1.2.cmml" xref="S3.SS3.p2.18.m5.1.1.2">1</cn><ci id="S3.SS3.p2.18.m5.1.1.3.cmml" xref="S3.SS3.p2.18.m5.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.18.m5.1c">\frac{1}{m}</annotation></semantics></math>. In order to define the entries of the bias vector, we assume that the server knows some information about the cumulative density function (CDF), assumed to be continuous for the quantity measured by <math id="S3.SS3.p2.19.m6.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS3.p2.19.m6.1a"><mi id="S3.SS3.p2.19.m6.1.1" xref="S3.SS3.p2.19.m6.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.19.m6.1b"><ci id="S3.SS3.p2.19.m6.1.1.cmml" xref="S3.SS3.p2.19.m6.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.19.m6.1c">h</annotation></semantics></math>. Note this attack does <em id="S3.SS3.p2.23.2" class="ltx_emph ltx_font_italic">not</em> require the server to know the full distribution of user data, but rather can estimate the distribution of <em id="S3.SS3.p2.23.3" class="ltx_emph ltx_font_italic">some</em> scalar quantity associated with the user data (a much easier task). In Appendix <a href="#A1.F5" title="In A.2 Other Choices of Linear Functions and Distributions ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a>, we see this can be quite easy for a server, and can even be done with a small amount of surrogate data.
We also stress that the choice of <math id="S3.SS3.p2.20.m7.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS3.p2.20.m7.1a"><mi id="S3.SS3.p2.20.m7.1.1" xref="S3.SS3.p2.20.m7.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.20.m7.1b"><ci id="S3.SS3.p2.20.m7.1.1.cmml" xref="S3.SS3.p2.20.m7.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.20.m7.1c">h</annotation></semantics></math> here is not important to our method. For the purpose of explanation, we will assume that the quantity measured by <math id="S3.SS3.p2.21.m8.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS3.p2.21.m8.1a"><mi id="S3.SS3.p2.21.m8.1.1" xref="S3.SS3.p2.21.m8.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.21.m8.1b"><ci id="S3.SS3.p2.21.m8.1.1.cmml" xref="S3.SS3.p2.21.m8.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.21.m8.1c">h</annotation></semantics></math> is distributed normally, with <math id="S3.SS3.p2.22.m9.1" class="ltx_Math" alttext="\mu=0" display="inline"><semantics id="S3.SS3.p2.22.m9.1a"><mrow id="S3.SS3.p2.22.m9.1.1" xref="S3.SS3.p2.22.m9.1.1.cmml"><mi id="S3.SS3.p2.22.m9.1.1.2" xref="S3.SS3.p2.22.m9.1.1.2.cmml">μ</mi><mo id="S3.SS3.p2.22.m9.1.1.1" xref="S3.SS3.p2.22.m9.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.22.m9.1.1.3" xref="S3.SS3.p2.22.m9.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.22.m9.1b"><apply id="S3.SS3.p2.22.m9.1.1.cmml" xref="S3.SS3.p2.22.m9.1.1"><eq id="S3.SS3.p2.22.m9.1.1.1.cmml" xref="S3.SS3.p2.22.m9.1.1.1"></eq><ci id="S3.SS3.p2.22.m9.1.1.2.cmml" xref="S3.SS3.p2.22.m9.1.1.2">𝜇</ci><cn type="integer" id="S3.SS3.p2.22.m9.1.1.3.cmml" xref="S3.SS3.p2.22.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.22.m9.1c">\mu=0</annotation></semantics></math>, <math id="S3.SS3.p2.23.m10.1" class="ltx_Math" alttext="\sigma=1" display="inline"><semantics id="S3.SS3.p2.23.m10.1a"><mrow id="S3.SS3.p2.23.m10.1.1" xref="S3.SS3.p2.23.m10.1.1.cmml"><mi id="S3.SS3.p2.23.m10.1.1.2" xref="S3.SS3.p2.23.m10.1.1.2.cmml">σ</mi><mo id="S3.SS3.p2.23.m10.1.1.1" xref="S3.SS3.p2.23.m10.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.23.m10.1.1.3" xref="S3.SS3.p2.23.m10.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.23.m10.1b"><apply id="S3.SS3.p2.23.m10.1.1.cmml" xref="S3.SS3.p2.23.m10.1.1"><eq id="S3.SS3.p2.23.m10.1.1.1.cmml" xref="S3.SS3.p2.23.m10.1.1.1"></eq><ci id="S3.SS3.p2.23.m10.1.1.2.cmml" xref="S3.SS3.p2.23.m10.1.1.2">𝜎</ci><cn type="integer" id="S3.SS3.p2.23.m10.1.1.3.cmml" xref="S3.SS3.p2.23.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.23.m10.1c">\sigma=1</annotation></semantics></math>. Then, the biases of the imprint module are determined by</p>
<table id="S3.Ex5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex5.m1.2" class="ltx_Math" alttext="b_{*}^{i}=-\Phi^{-1}(\frac{i}{k})=-c_{i}," display="block"><semantics id="S3.Ex5.m1.2a"><mrow id="S3.Ex5.m1.2.2.1" xref="S3.Ex5.m1.2.2.1.1.cmml"><mrow id="S3.Ex5.m1.2.2.1.1" xref="S3.Ex5.m1.2.2.1.1.cmml"><msubsup id="S3.Ex5.m1.2.2.1.1.2" xref="S3.Ex5.m1.2.2.1.1.2.cmml"><mi id="S3.Ex5.m1.2.2.1.1.2.2.2" xref="S3.Ex5.m1.2.2.1.1.2.2.2.cmml">b</mi><mo id="S3.Ex5.m1.2.2.1.1.2.2.3" xref="S3.Ex5.m1.2.2.1.1.2.2.3.cmml">∗</mo><mi id="S3.Ex5.m1.2.2.1.1.2.3" xref="S3.Ex5.m1.2.2.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.Ex5.m1.2.2.1.1.3" xref="S3.Ex5.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.Ex5.m1.2.2.1.1.4" xref="S3.Ex5.m1.2.2.1.1.4.cmml"><mo id="S3.Ex5.m1.2.2.1.1.4a" xref="S3.Ex5.m1.2.2.1.1.4.cmml">−</mo><mrow id="S3.Ex5.m1.2.2.1.1.4.2" xref="S3.Ex5.m1.2.2.1.1.4.2.cmml"><msup id="S3.Ex5.m1.2.2.1.1.4.2.2" xref="S3.Ex5.m1.2.2.1.1.4.2.2.cmml"><mi mathvariant="normal" id="S3.Ex5.m1.2.2.1.1.4.2.2.2" xref="S3.Ex5.m1.2.2.1.1.4.2.2.2.cmml">Φ</mi><mrow id="S3.Ex5.m1.2.2.1.1.4.2.2.3" xref="S3.Ex5.m1.2.2.1.1.4.2.2.3.cmml"><mo id="S3.Ex5.m1.2.2.1.1.4.2.2.3a" xref="S3.Ex5.m1.2.2.1.1.4.2.2.3.cmml">−</mo><mn id="S3.Ex5.m1.2.2.1.1.4.2.2.3.2" xref="S3.Ex5.m1.2.2.1.1.4.2.2.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S3.Ex5.m1.2.2.1.1.4.2.1" xref="S3.Ex5.m1.2.2.1.1.4.2.1.cmml">​</mo><mrow id="S3.Ex5.m1.2.2.1.1.4.2.3.2" xref="S3.Ex5.m1.1.1.cmml"><mo stretchy="false" id="S3.Ex5.m1.2.2.1.1.4.2.3.2.1" xref="S3.Ex5.m1.1.1.cmml">(</mo><mfrac id="S3.Ex5.m1.1.1" xref="S3.Ex5.m1.1.1.cmml"><mi id="S3.Ex5.m1.1.1.2" xref="S3.Ex5.m1.1.1.2.cmml">i</mi><mi id="S3.Ex5.m1.1.1.3" xref="S3.Ex5.m1.1.1.3.cmml">k</mi></mfrac><mo stretchy="false" id="S3.Ex5.m1.2.2.1.1.4.2.3.2.2" xref="S3.Ex5.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex5.m1.2.2.1.1.5" xref="S3.Ex5.m1.2.2.1.1.5.cmml">=</mo><mrow id="S3.Ex5.m1.2.2.1.1.6" xref="S3.Ex5.m1.2.2.1.1.6.cmml"><mo id="S3.Ex5.m1.2.2.1.1.6a" xref="S3.Ex5.m1.2.2.1.1.6.cmml">−</mo><msub id="S3.Ex5.m1.2.2.1.1.6.2" xref="S3.Ex5.m1.2.2.1.1.6.2.cmml"><mi id="S3.Ex5.m1.2.2.1.1.6.2.2" xref="S3.Ex5.m1.2.2.1.1.6.2.2.cmml">c</mi><mi id="S3.Ex5.m1.2.2.1.1.6.2.3" xref="S3.Ex5.m1.2.2.1.1.6.2.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.Ex5.m1.2.2.1.2" xref="S3.Ex5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.2b"><apply id="S3.Ex5.m1.2.2.1.1.cmml" xref="S3.Ex5.m1.2.2.1"><and id="S3.Ex5.m1.2.2.1.1a.cmml" xref="S3.Ex5.m1.2.2.1"></and><apply id="S3.Ex5.m1.2.2.1.1b.cmml" xref="S3.Ex5.m1.2.2.1"><eq id="S3.Ex5.m1.2.2.1.1.3.cmml" xref="S3.Ex5.m1.2.2.1.1.3"></eq><apply id="S3.Ex5.m1.2.2.1.1.2.cmml" xref="S3.Ex5.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.2.1.1.2.1.cmml" xref="S3.Ex5.m1.2.2.1.1.2">superscript</csymbol><apply id="S3.Ex5.m1.2.2.1.1.2.2.cmml" xref="S3.Ex5.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.2.1.1.2.2.1.cmml" xref="S3.Ex5.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.Ex5.m1.2.2.1.1.2.2.2.cmml" xref="S3.Ex5.m1.2.2.1.1.2.2.2">𝑏</ci><times id="S3.Ex5.m1.2.2.1.1.2.2.3.cmml" xref="S3.Ex5.m1.2.2.1.1.2.2.3"></times></apply><ci id="S3.Ex5.m1.2.2.1.1.2.3.cmml" xref="S3.Ex5.m1.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.Ex5.m1.2.2.1.1.4.cmml" xref="S3.Ex5.m1.2.2.1.1.4"><minus id="S3.Ex5.m1.2.2.1.1.4.1.cmml" xref="S3.Ex5.m1.2.2.1.1.4"></minus><apply id="S3.Ex5.m1.2.2.1.1.4.2.cmml" xref="S3.Ex5.m1.2.2.1.1.4.2"><times id="S3.Ex5.m1.2.2.1.1.4.2.1.cmml" xref="S3.Ex5.m1.2.2.1.1.4.2.1"></times><apply id="S3.Ex5.m1.2.2.1.1.4.2.2.cmml" xref="S3.Ex5.m1.2.2.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.2.1.1.4.2.2.1.cmml" xref="S3.Ex5.m1.2.2.1.1.4.2.2">superscript</csymbol><ci id="S3.Ex5.m1.2.2.1.1.4.2.2.2.cmml" xref="S3.Ex5.m1.2.2.1.1.4.2.2.2">Φ</ci><apply id="S3.Ex5.m1.2.2.1.1.4.2.2.3.cmml" xref="S3.Ex5.m1.2.2.1.1.4.2.2.3"><minus id="S3.Ex5.m1.2.2.1.1.4.2.2.3.1.cmml" xref="S3.Ex5.m1.2.2.1.1.4.2.2.3"></minus><cn type="integer" id="S3.Ex5.m1.2.2.1.1.4.2.2.3.2.cmml" xref="S3.Ex5.m1.2.2.1.1.4.2.2.3.2">1</cn></apply></apply><apply id="S3.Ex5.m1.1.1.cmml" xref="S3.Ex5.m1.2.2.1.1.4.2.3.2"><divide id="S3.Ex5.m1.1.1.1.cmml" xref="S3.Ex5.m1.2.2.1.1.4.2.3.2"></divide><ci id="S3.Ex5.m1.1.1.2.cmml" xref="S3.Ex5.m1.1.1.2">𝑖</ci><ci id="S3.Ex5.m1.1.1.3.cmml" xref="S3.Ex5.m1.1.1.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.Ex5.m1.2.2.1.1c.cmml" xref="S3.Ex5.m1.2.2.1"><eq id="S3.Ex5.m1.2.2.1.1.5.cmml" xref="S3.Ex5.m1.2.2.1.1.5"></eq><share href="#S3.Ex5.m1.2.2.1.1.4.cmml" id="S3.Ex5.m1.2.2.1.1d.cmml" xref="S3.Ex5.m1.2.2.1"></share><apply id="S3.Ex5.m1.2.2.1.1.6.cmml" xref="S3.Ex5.m1.2.2.1.1.6"><minus id="S3.Ex5.m1.2.2.1.1.6.1.cmml" xref="S3.Ex5.m1.2.2.1.1.6"></minus><apply id="S3.Ex5.m1.2.2.1.1.6.2.cmml" xref="S3.Ex5.m1.2.2.1.1.6.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.2.1.1.6.2.1.cmml" xref="S3.Ex5.m1.2.2.1.1.6.2">subscript</csymbol><ci id="S3.Ex5.m1.2.2.1.1.6.2.2.cmml" xref="S3.Ex5.m1.2.2.1.1.6.2.2">𝑐</ci><ci id="S3.Ex5.m1.2.2.1.1.6.2.3.cmml" xref="S3.Ex5.m1.2.2.1.1.6.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.2c">b_{*}^{i}=-\Phi^{-1}(\frac{i}{k})=-c_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.30" class="ltx_p">where <math id="S3.SS3.p2.24.m1.1" class="ltx_Math" alttext="\Phi^{-1}" display="inline"><semantics id="S3.SS3.p2.24.m1.1a"><msup id="S3.SS3.p2.24.m1.1.1" xref="S3.SS3.p2.24.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p2.24.m1.1.1.2" xref="S3.SS3.p2.24.m1.1.1.2.cmml">Φ</mi><mrow id="S3.SS3.p2.24.m1.1.1.3" xref="S3.SS3.p2.24.m1.1.1.3.cmml"><mo id="S3.SS3.p2.24.m1.1.1.3a" xref="S3.SS3.p2.24.m1.1.1.3.cmml">−</mo><mn id="S3.SS3.p2.24.m1.1.1.3.2" xref="S3.SS3.p2.24.m1.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.24.m1.1b"><apply id="S3.SS3.p2.24.m1.1.1.cmml" xref="S3.SS3.p2.24.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.24.m1.1.1.1.cmml" xref="S3.SS3.p2.24.m1.1.1">superscript</csymbol><ci id="S3.SS3.p2.24.m1.1.1.2.cmml" xref="S3.SS3.p2.24.m1.1.1.2">Φ</ci><apply id="S3.SS3.p2.24.m1.1.1.3.cmml" xref="S3.SS3.p2.24.m1.1.1.3"><minus id="S3.SS3.p2.24.m1.1.1.3.1.cmml" xref="S3.SS3.p2.24.m1.1.1.3"></minus><cn type="integer" id="S3.SS3.p2.24.m1.1.1.3.2.cmml" xref="S3.SS3.p2.24.m1.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.24.m1.1c">\Phi^{-1}</annotation></semantics></math> is the inverse of the standard Gaussian CDF. In plain language, we first measure some quantity, like brightness, with the matrix <math id="S3.SS3.p2.25.m2.1" class="ltx_Math" alttext="W_{*}" display="inline"><semantics id="S3.SS3.p2.25.m2.1a"><msub id="S3.SS3.p2.25.m2.1.1" xref="S3.SS3.p2.25.m2.1.1.cmml"><mi id="S3.SS3.p2.25.m2.1.1.2" xref="S3.SS3.p2.25.m2.1.1.2.cmml">W</mi><mo id="S3.SS3.p2.25.m2.1.1.3" xref="S3.SS3.p2.25.m2.1.1.3.cmml">∗</mo></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.25.m2.1b"><apply id="S3.SS3.p2.25.m2.1.1.cmml" xref="S3.SS3.p2.25.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.25.m2.1.1.1.cmml" xref="S3.SS3.p2.25.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.25.m2.1.1.2.cmml" xref="S3.SS3.p2.25.m2.1.1.2">𝑊</ci><times id="S3.SS3.p2.25.m2.1.1.3.cmml" xref="S3.SS3.p2.25.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.25.m2.1c">W_{*}</annotation></semantics></math>. We duplicate this measurement along the <math id="S3.SS3.p2.26.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p2.26.m3.1a"><mi id="S3.SS3.p2.26.m3.1.1" xref="S3.SS3.p2.26.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.26.m3.1b"><ci id="S3.SS3.p2.26.m3.1.1.cmml" xref="S3.SS3.p2.26.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.26.m3.1c">k</annotation></semantics></math> channels (rows) of <math id="S3.SS3.p2.27.m4.1" class="ltx_Math" alttext="W_{*}" display="inline"><semantics id="S3.SS3.p2.27.m4.1a"><msub id="S3.SS3.p2.27.m4.1.1" xref="S3.SS3.p2.27.m4.1.1.cmml"><mi id="S3.SS3.p2.27.m4.1.1.2" xref="S3.SS3.p2.27.m4.1.1.2.cmml">W</mi><mo id="S3.SS3.p2.27.m4.1.1.3" xref="S3.SS3.p2.27.m4.1.1.3.cmml">∗</mo></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.27.m4.1b"><apply id="S3.SS3.p2.27.m4.1.1.cmml" xref="S3.SS3.p2.27.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.27.m4.1.1.1.cmml" xref="S3.SS3.p2.27.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.27.m4.1.1.2.cmml" xref="S3.SS3.p2.27.m4.1.1.2">𝑊</ci><times id="S3.SS3.p2.27.m4.1.1.3.cmml" xref="S3.SS3.p2.27.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.27.m4.1c">W_{*}</annotation></semantics></math>. In the meantime, we create <math id="S3.SS3.p2.28.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p2.28.m5.1a"><mi id="S3.SS3.p2.28.m5.1.1" xref="S3.SS3.p2.28.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.28.m5.1b"><ci id="S3.SS3.p2.28.m5.1.1.cmml" xref="S3.SS3.p2.28.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.28.m5.1c">k</annotation></semantics></math> “bins” for the data corresponding to intervals of equal mass according to the CDF of <math id="S3.SS3.p2.29.m6.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS3.p2.29.m6.1a"><mi id="S3.SS3.p2.29.m6.1.1" xref="S3.SS3.p2.29.m6.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.29.m6.1b"><ci id="S3.SS3.p2.29.m6.1.1.cmml" xref="S3.SS3.p2.29.m6.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.29.m6.1c">h</annotation></semantics></math>. Then, the measurement for a given datapoint will land somewhere in the distribution of <math id="S3.SS3.p2.30.m7.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS3.p2.30.m7.1a"><mi id="S3.SS3.p2.30.m7.1.1" xref="S3.SS3.p2.30.m7.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.30.m7.1b"><ci id="S3.SS3.p2.30.m7.1.1.cmml" xref="S3.SS3.p2.30.m7.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.30.m7.1c">h</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.5" class="ltx_p">For example, consider the case when the brightness of some image <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝑥</ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">x_{t}</annotation></semantics></math> lands between two values: <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="c_{l}\leq h(x_{t})\leq c_{l+1}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mrow id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><msub id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.2" xref="S3.SS3.p3.2.m2.1.1.3.2.cmml">c</mi><mi id="S3.SS3.p3.2.m2.1.1.3.3" xref="S3.SS3.p3.2.m2.1.1.3.3.cmml">l</mi></msub><mo id="S3.SS3.p3.2.m2.1.1.4" xref="S3.SS3.p3.2.m2.1.1.4.cmml">≤</mo><mrow id="S3.SS3.p3.2.m2.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.3" xref="S3.SS3.p3.2.m2.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.1.1.1.2" xref="S3.SS3.p3.2.m2.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p3.2.m2.1.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.2.m2.1.1.1.1.1.2" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p3.2.m2.1.1.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.1.2" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.1.3" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS3.p3.2.m2.1.1.1.1.1.3" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.2.m2.1.1.5" xref="S3.SS3.p3.2.m2.1.1.5.cmml">≤</mo><msub id="S3.SS3.p3.2.m2.1.1.6" xref="S3.SS3.p3.2.m2.1.1.6.cmml"><mi id="S3.SS3.p3.2.m2.1.1.6.2" xref="S3.SS3.p3.2.m2.1.1.6.2.cmml">c</mi><mrow id="S3.SS3.p3.2.m2.1.1.6.3" xref="S3.SS3.p3.2.m2.1.1.6.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.6.3.2" xref="S3.SS3.p3.2.m2.1.1.6.3.2.cmml">l</mi><mo id="S3.SS3.p3.2.m2.1.1.6.3.1" xref="S3.SS3.p3.2.m2.1.1.6.3.1.cmml">+</mo><mn id="S3.SS3.p3.2.m2.1.1.6.3.3" xref="S3.SS3.p3.2.m2.1.1.6.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><and id="S3.SS3.p3.2.m2.1.1a.cmml" xref="S3.SS3.p3.2.m2.1.1"></and><apply id="S3.SS3.p3.2.m2.1.1b.cmml" xref="S3.SS3.p3.2.m2.1.1"><leq id="S3.SS3.p3.2.m2.1.1.4.cmml" xref="S3.SS3.p3.2.m2.1.1.4"></leq><apply id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2">𝑐</ci><ci id="S3.SS3.p3.2.m2.1.1.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3">𝑙</ci></apply><apply id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1"><times id="S3.SS3.p3.2.m2.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.2"></times><ci id="S3.SS3.p3.2.m2.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.3">ℎ</ci><apply id="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.SS3.p3.2.m2.1.1c.cmml" xref="S3.SS3.p3.2.m2.1.1"><leq id="S3.SS3.p3.2.m2.1.1.5.cmml" xref="S3.SS3.p3.2.m2.1.1.5"></leq><share href="#S3.SS3.p3.2.m2.1.1.1.cmml" id="S3.SS3.p3.2.m2.1.1d.cmml" xref="S3.SS3.p3.2.m2.1.1"></share><apply id="S3.SS3.p3.2.m2.1.1.6.cmml" xref="S3.SS3.p3.2.m2.1.1.6"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.6.1.cmml" xref="S3.SS3.p3.2.m2.1.1.6">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.6.2.cmml" xref="S3.SS3.p3.2.m2.1.1.6.2">𝑐</ci><apply id="S3.SS3.p3.2.m2.1.1.6.3.cmml" xref="S3.SS3.p3.2.m2.1.1.6.3"><plus id="S3.SS3.p3.2.m2.1.1.6.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.6.3.1"></plus><ci id="S3.SS3.p3.2.m2.1.1.6.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.6.3.2">𝑙</ci><cn type="integer" id="S3.SS3.p3.2.m2.1.1.6.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.6.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">c_{l}\leq h(x_{t})\leq c_{l+1}</annotation></semantics></math>, and no other image in the same batch has brightness in this range. In this situation, we say that <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><msub id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml">x</mi><mi id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2">𝑥</ci><ci id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">x_{t}</annotation></semantics></math> alone activates bin <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">l</annotation></semantics></math>. Then, if the image <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><msub id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml">x</mi><mi id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2">𝑥</ci><ci id="S3.SS3.p3.5.m5.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">x_{t}</annotation></semantics></math> is passed through the imprint module, we have</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\big{(}\nabla_{W_{*}^{l}}\mathcal{L}-\nabla_{W_{*}^{l+1}}\mathcal{L}\big{)}\oslash\bigg{(}\frac{\partial\mathcal{L}}{\partial b_{*}^{l}}-\frac{\partial\mathcal{L}}{\partial b_{*}^{l+1}}\bigg{)}=x_{t}+\sum_{s=1}^{p}x_{i_{s}}-\sum_{s=1}^{p}x_{i_{s}}=x_{t}," display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="S3.E4.m1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml"><mo rspace="0.167em" id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.2.cmml">∇</mo><msubsup id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.2.2.cmml">W</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.2.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.2.3.cmml">∗</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.3.cmml">l</mi></msubsup></msub><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml">ℒ</mi></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.cmml"><mo rspace="0.167em" id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.2.cmml">∇</mo><msubsup id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.2.2.cmml">W</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.2.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.2.3.cmml">∗</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.2.cmml">l</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.1.cmml">+</mo><mn id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.3.cmml">1</mn></mrow></msubsup></msub><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.2.cmml">ℒ</mi></mrow></mrow><mo maxsize="120%" minsize="120%" id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E4.m1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.3.cmml">⊘</mo><mrow id="S3.E4.m1.1.1.1.1.2.2.1" xref="S3.E4.m1.1.1.1.1.2.2.1.1.cmml"><mo maxsize="210%" minsize="210%" id="S3.E4.m1.1.1.1.1.2.2.1.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.2.2.1.1" xref="S3.E4.m1.1.1.1.1.2.2.1.1.cmml"><mfrac id="S3.E4.m1.1.1.1.1.2.2.1.1.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.cmml"><mrow id="S3.E4.m1.1.1.1.1.2.2.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.2.cmml"><mo rspace="0em" id="S3.E4.m1.1.1.1.1.2.2.1.1.2.2.1" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.2.2.1.1.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.2.2.cmml">ℒ</mi></mrow><mrow id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.cmml"><mo rspace="0em" id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.1" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.1.cmml">∂</mo><msubsup id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2.2.cmml">b</mi><mo id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2.3.cmml">∗</mo><mi id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.3.cmml">l</mi></msubsup></mrow></mfrac><mo id="S3.E4.m1.1.1.1.1.2.2.1.1.1" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.cmml">−</mo><mfrac id="S3.E4.m1.1.1.1.1.2.2.1.1.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.cmml"><mrow id="S3.E4.m1.1.1.1.1.2.2.1.1.3.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.2.cmml"><mo rspace="0em" id="S3.E4.m1.1.1.1.1.2.2.1.1.3.2.1" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.2.2.1.1.3.2.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.2.2.cmml">ℒ</mi></mrow><mrow id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.cmml"><mo rspace="0em" id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.1.cmml">∂</mo><msubsup id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.2.2.cmml">b</mi><mo id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.2.3.cmml">∗</mo><mrow id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.2.cmml">l</mi><mo id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.1" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.1.cmml">+</mo><mn id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mfrac></mrow><mo maxsize="210%" minsize="210%" id="S3.E4.m1.1.1.1.1.2.2.1.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.5" xref="S3.E4.m1.1.1.1.1.5.cmml"><mrow id="S3.E4.m1.1.1.1.1.5.2" xref="S3.E4.m1.1.1.1.1.5.2.cmml"><msub id="S3.E4.m1.1.1.1.1.5.2.2" xref="S3.E4.m1.1.1.1.1.5.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.5.2.2.2" xref="S3.E4.m1.1.1.1.1.5.2.2.2.cmml">x</mi><mi id="S3.E4.m1.1.1.1.1.5.2.2.3" xref="S3.E4.m1.1.1.1.1.5.2.2.3.cmml">t</mi></msub><mo rspace="0.055em" id="S3.E4.m1.1.1.1.1.5.2.1" xref="S3.E4.m1.1.1.1.1.5.2.1.cmml">+</mo><mrow id="S3.E4.m1.1.1.1.1.5.2.3" xref="S3.E4.m1.1.1.1.1.5.2.3.cmml"><munderover id="S3.E4.m1.1.1.1.1.5.2.3.1" xref="S3.E4.m1.1.1.1.1.5.2.3.1.cmml"><mo movablelimits="false" id="S3.E4.m1.1.1.1.1.5.2.3.1.2.2" xref="S3.E4.m1.1.1.1.1.5.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.1.1.1.1.5.2.3.1.2.3" xref="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.2" xref="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.2.cmml">s</mi><mo id="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.1" xref="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.3" xref="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.1.1.1.1.5.2.3.1.3" xref="S3.E4.m1.1.1.1.1.5.2.3.1.3.cmml">p</mi></munderover><msub id="S3.E4.m1.1.1.1.1.5.2.3.2" xref="S3.E4.m1.1.1.1.1.5.2.3.2.cmml"><mi id="S3.E4.m1.1.1.1.1.5.2.3.2.2" xref="S3.E4.m1.1.1.1.1.5.2.3.2.2.cmml">x</mi><msub id="S3.E4.m1.1.1.1.1.5.2.3.2.3" xref="S3.E4.m1.1.1.1.1.5.2.3.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.5.2.3.2.3.2" xref="S3.E4.m1.1.1.1.1.5.2.3.2.3.2.cmml">i</mi><mi id="S3.E4.m1.1.1.1.1.5.2.3.2.3.3" xref="S3.E4.m1.1.1.1.1.5.2.3.2.3.3.cmml">s</mi></msub></msub></mrow></mrow><mo rspace="0.055em" id="S3.E4.m1.1.1.1.1.5.1" xref="S3.E4.m1.1.1.1.1.5.1.cmml">−</mo><mrow id="S3.E4.m1.1.1.1.1.5.3" xref="S3.E4.m1.1.1.1.1.5.3.cmml"><munderover id="S3.E4.m1.1.1.1.1.5.3.1" xref="S3.E4.m1.1.1.1.1.5.3.1.cmml"><mo movablelimits="false" id="S3.E4.m1.1.1.1.1.5.3.1.2.2" xref="S3.E4.m1.1.1.1.1.5.3.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.1.1.1.1.5.3.1.2.3" xref="S3.E4.m1.1.1.1.1.5.3.1.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.5.3.1.2.3.2" xref="S3.E4.m1.1.1.1.1.5.3.1.2.3.2.cmml">s</mi><mo id="S3.E4.m1.1.1.1.1.5.3.1.2.3.1" xref="S3.E4.m1.1.1.1.1.5.3.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.1.1.1.1.5.3.1.2.3.3" xref="S3.E4.m1.1.1.1.1.5.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.1.1.1.1.5.3.1.3" xref="S3.E4.m1.1.1.1.1.5.3.1.3.cmml">p</mi></munderover><msub id="S3.E4.m1.1.1.1.1.5.3.2" xref="S3.E4.m1.1.1.1.1.5.3.2.cmml"><mi id="S3.E4.m1.1.1.1.1.5.3.2.2" xref="S3.E4.m1.1.1.1.1.5.3.2.2.cmml">x</mi><msub id="S3.E4.m1.1.1.1.1.5.3.2.3" xref="S3.E4.m1.1.1.1.1.5.3.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.5.3.2.3.2" xref="S3.E4.m1.1.1.1.1.5.3.2.3.2.cmml">i</mi><mi id="S3.E4.m1.1.1.1.1.5.3.2.3.3" xref="S3.E4.m1.1.1.1.1.5.3.2.3.3.cmml">s</mi></msub></msub></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.6" xref="S3.E4.m1.1.1.1.1.6.cmml">=</mo><msub id="S3.E4.m1.1.1.1.1.7" xref="S3.E4.m1.1.1.1.1.7.cmml"><mi id="S3.E4.m1.1.1.1.1.7.2" xref="S3.E4.m1.1.1.1.1.7.2.cmml">x</mi><mi id="S3.E4.m1.1.1.1.1.7.3" xref="S3.E4.m1.1.1.1.1.7.3.cmml">t</mi></msub></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><and id="S3.E4.m1.1.1.1.1a.cmml" xref="S3.E4.m1.1.1.1"></and><apply id="S3.E4.m1.1.1.1.1b.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.4"></eq><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"><ci id="S3.E4.m1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.3">⊘</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1"><minus id="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2"><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.2">∇</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.2.2">𝑊</ci><times id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.2.3"></times></apply><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.3.3">𝑙</ci></apply></apply><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.2">ℒ</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3"><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.2">∇</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.2.2">𝑊</ci><times id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.2.3"></times></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3"><plus id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.1"></plus><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.2">𝑙</ci><cn type="integer" id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.3.3.3">1</cn></apply></apply></apply><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.2">ℒ</ci></apply></apply><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1"><minus id="S3.E4.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1"></minus><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2"><divide id="S3.E4.m1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2"></divide><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.2"><partialdiff id="S3.E4.m1.1.1.1.1.2.2.1.1.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.2.1"></partialdiff><ci id="S3.E4.m1.1.1.1.1.2.2.1.1.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.2.2">ℒ</ci></apply><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3"><partialdiff id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.1"></partialdiff><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2.2">𝑏</ci><times id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.2.3"></times></apply><ci id="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.2.3.2.3">𝑙</ci></apply></apply></apply><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3"><divide id="S3.E4.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3"></divide><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.2"><partialdiff id="S3.E4.m1.1.1.1.1.2.2.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.2.1"></partialdiff><ci id="S3.E4.m1.1.1.1.1.2.2.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.2.2">ℒ</ci></apply><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3"><partialdiff id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.1"></partialdiff><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.2.2">𝑏</ci><times id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.2.3"></times></apply><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3"><plus id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.1"></plus><ci id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.2">𝑙</ci><cn type="integer" id="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply></apply><apply id="S3.E4.m1.1.1.1.1.5.cmml" xref="S3.E4.m1.1.1.1.1.5"><minus id="S3.E4.m1.1.1.1.1.5.1.cmml" xref="S3.E4.m1.1.1.1.1.5.1"></minus><apply id="S3.E4.m1.1.1.1.1.5.2.cmml" xref="S3.E4.m1.1.1.1.1.5.2"><plus id="S3.E4.m1.1.1.1.1.5.2.1.cmml" xref="S3.E4.m1.1.1.1.1.5.2.1"></plus><apply id="S3.E4.m1.1.1.1.1.5.2.2.cmml" xref="S3.E4.m1.1.1.1.1.5.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.5.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.5.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.5.2.2.2">𝑥</ci><ci id="S3.E4.m1.1.1.1.1.5.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.5.2.2.3">𝑡</ci></apply><apply id="S3.E4.m1.1.1.1.1.5.2.3.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3"><apply id="S3.E4.m1.1.1.1.1.5.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.2.3.1.1.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.5.2.3.1.2.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.2.3.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.1">subscript</csymbol><sum id="S3.E4.m1.1.1.1.1.5.2.3.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.1.2.2"></sum><apply id="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.1.2.3"><eq id="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.1"></eq><ci id="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.2">𝑠</ci><cn type="integer" id="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.1.1.5.2.3.1.3.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.1.3">𝑝</ci></apply><apply id="S3.E4.m1.1.1.1.1.5.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.2.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.5.2.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.2.2">𝑥</ci><apply id="S3.E4.m1.1.1.1.1.5.2.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.2.3.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.2.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.5.2.3.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.2.3.2">𝑖</ci><ci id="S3.E4.m1.1.1.1.1.5.2.3.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.5.2.3.2.3.3">𝑠</ci></apply></apply></apply></apply><apply id="S3.E4.m1.1.1.1.1.5.3.cmml" xref="S3.E4.m1.1.1.1.1.5.3"><apply id="S3.E4.m1.1.1.1.1.5.3.1.cmml" xref="S3.E4.m1.1.1.1.1.5.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.3.1.1.cmml" xref="S3.E4.m1.1.1.1.1.5.3.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.5.3.1.2.cmml" xref="S3.E4.m1.1.1.1.1.5.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.3.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.5.3.1">subscript</csymbol><sum id="S3.E4.m1.1.1.1.1.5.3.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.5.3.1.2.2"></sum><apply id="S3.E4.m1.1.1.1.1.5.3.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.5.3.1.2.3"><eq id="S3.E4.m1.1.1.1.1.5.3.1.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.5.3.1.2.3.1"></eq><ci id="S3.E4.m1.1.1.1.1.5.3.1.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.5.3.1.2.3.2">𝑠</ci><cn type="integer" id="S3.E4.m1.1.1.1.1.5.3.1.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.5.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.1.1.5.3.1.3.cmml" xref="S3.E4.m1.1.1.1.1.5.3.1.3">𝑝</ci></apply><apply id="S3.E4.m1.1.1.1.1.5.3.2.cmml" xref="S3.E4.m1.1.1.1.1.5.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.5.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.5.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.5.3.2.2">𝑥</ci><apply id="S3.E4.m1.1.1.1.1.5.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.5.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.5.3.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.5.3.2.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.5.3.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.5.3.2.3.2">𝑖</ci><ci id="S3.E4.m1.1.1.1.1.5.3.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.5.3.2.3.3">𝑠</ci></apply></apply></apply></apply></apply><apply id="S3.E4.m1.1.1.1.1c.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.6.cmml" xref="S3.E4.m1.1.1.1.1.6"></eq><share href="#S3.E4.m1.1.1.1.1.5.cmml" id="S3.E4.m1.1.1.1.1d.cmml" xref="S3.E4.m1.1.1.1"></share><apply id="S3.E4.m1.1.1.1.1.7.cmml" xref="S3.E4.m1.1.1.1.1.7"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.7.1.cmml" xref="S3.E4.m1.1.1.1.1.7">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.7.2.cmml" xref="S3.E4.m1.1.1.1.1.7.2">𝑥</ci><ci id="S3.E4.m1.1.1.1.1.7.3.cmml" xref="S3.E4.m1.1.1.1.1.7.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\big{(}\nabla_{W_{*}^{l}}\mathcal{L}-\nabla_{W_{*}^{l+1}}\mathcal{L}\big{)}\oslash\bigg{(}\frac{\partial\mathcal{L}}{\partial b_{*}^{l}}-\frac{\partial\mathcal{L}}{\partial b_{*}^{l+1}}\bigg{)}=x_{t}+\sum_{s=1}^{p}x_{i_{s}}-\sum_{s=1}^{p}x_{i_{s}}=x_{t},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.18" class="ltx_p">where images <math id="S3.SS3.p3.6.m1.1" class="ltx_Math" alttext="\{x_{i_{s}}\}" display="inline"><semantics id="S3.SS3.p3.6.m1.1a"><mrow id="S3.SS3.p3.6.m1.1.1.1" xref="S3.SS3.p3.6.m1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.6.m1.1.1.1.2" xref="S3.SS3.p3.6.m1.1.1.2.cmml">{</mo><msub id="S3.SS3.p3.6.m1.1.1.1.1" xref="S3.SS3.p3.6.m1.1.1.1.1.cmml"><mi id="S3.SS3.p3.6.m1.1.1.1.1.2" xref="S3.SS3.p3.6.m1.1.1.1.1.2.cmml">x</mi><msub id="S3.SS3.p3.6.m1.1.1.1.1.3" xref="S3.SS3.p3.6.m1.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.6.m1.1.1.1.1.3.2" xref="S3.SS3.p3.6.m1.1.1.1.1.3.2.cmml">i</mi><mi id="S3.SS3.p3.6.m1.1.1.1.1.3.3" xref="S3.SS3.p3.6.m1.1.1.1.1.3.3.cmml">s</mi></msub></msub><mo stretchy="false" id="S3.SS3.p3.6.m1.1.1.1.3" xref="S3.SS3.p3.6.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m1.1b"><set id="S3.SS3.p3.6.m1.1.1.2.cmml" xref="S3.SS3.p3.6.m1.1.1.1"><apply id="S3.SS3.p3.6.m1.1.1.1.1.cmml" xref="S3.SS3.p3.6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m1.1.1.1.1.1.cmml" xref="S3.SS3.p3.6.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.6.m1.1.1.1.1.2.cmml" xref="S3.SS3.p3.6.m1.1.1.1.1.2">𝑥</ci><apply id="S3.SS3.p3.6.m1.1.1.1.1.3.cmml" xref="S3.SS3.p3.6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m1.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.6.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.6.m1.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.6.m1.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.6.m1.1.1.1.1.3.3.cmml" xref="S3.SS3.p3.6.m1.1.1.1.1.3.3">𝑠</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m1.1c">\{x_{i_{s}}\}</annotation></semantics></math> are images from the batch with brightness <math id="S3.SS3.p3.7.m2.1" class="ltx_Math" alttext="&gt;c_{l}" display="inline"><semantics id="S3.SS3.p3.7.m2.1a"><mrow id="S3.SS3.p3.7.m2.1.1" xref="S3.SS3.p3.7.m2.1.1.cmml"><mi id="S3.SS3.p3.7.m2.1.1.2" xref="S3.SS3.p3.7.m2.1.1.2.cmml"></mi><mo id="S3.SS3.p3.7.m2.1.1.1" xref="S3.SS3.p3.7.m2.1.1.1.cmml">&gt;</mo><msub id="S3.SS3.p3.7.m2.1.1.3" xref="S3.SS3.p3.7.m2.1.1.3.cmml"><mi id="S3.SS3.p3.7.m2.1.1.3.2" xref="S3.SS3.p3.7.m2.1.1.3.2.cmml">c</mi><mi id="S3.SS3.p3.7.m2.1.1.3.3" xref="S3.SS3.p3.7.m2.1.1.3.3.cmml">l</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m2.1b"><apply id="S3.SS3.p3.7.m2.1.1.cmml" xref="S3.SS3.p3.7.m2.1.1"><gt id="S3.SS3.p3.7.m2.1.1.1.cmml" xref="S3.SS3.p3.7.m2.1.1.1"></gt><csymbol cd="latexml" id="S3.SS3.p3.7.m2.1.1.2.cmml" xref="S3.SS3.p3.7.m2.1.1.2">absent</csymbol><apply id="S3.SS3.p3.7.m2.1.1.3.cmml" xref="S3.SS3.p3.7.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m2.1.1.3.1.cmml" xref="S3.SS3.p3.7.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.7.m2.1.1.3.2.cmml" xref="S3.SS3.p3.7.m2.1.1.3.2">𝑐</ci><ci id="S3.SS3.p3.7.m2.1.1.3.3.cmml" xref="S3.SS3.p3.7.m2.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m2.1c">&gt;c_{l}</annotation></semantics></math>. That is, the difference in successive rows <math id="S3.SS3.p3.8.m3.2" class="ltx_Math" alttext="l,l+1" display="inline"><semantics id="S3.SS3.p3.8.m3.2a"><mrow id="S3.SS3.p3.8.m3.2.2.1" xref="S3.SS3.p3.8.m3.2.2.2.cmml"><mi id="S3.SS3.p3.8.m3.1.1" xref="S3.SS3.p3.8.m3.1.1.cmml">l</mi><mo id="S3.SS3.p3.8.m3.2.2.1.2" xref="S3.SS3.p3.8.m3.2.2.2.cmml">,</mo><mrow id="S3.SS3.p3.8.m3.2.2.1.1" xref="S3.SS3.p3.8.m3.2.2.1.1.cmml"><mi id="S3.SS3.p3.8.m3.2.2.1.1.2" xref="S3.SS3.p3.8.m3.2.2.1.1.2.cmml">l</mi><mo id="S3.SS3.p3.8.m3.2.2.1.1.1" xref="S3.SS3.p3.8.m3.2.2.1.1.1.cmml">+</mo><mn id="S3.SS3.p3.8.m3.2.2.1.1.3" xref="S3.SS3.p3.8.m3.2.2.1.1.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m3.2b"><list id="S3.SS3.p3.8.m3.2.2.2.cmml" xref="S3.SS3.p3.8.m3.2.2.1"><ci id="S3.SS3.p3.8.m3.1.1.cmml" xref="S3.SS3.p3.8.m3.1.1">𝑙</ci><apply id="S3.SS3.p3.8.m3.2.2.1.1.cmml" xref="S3.SS3.p3.8.m3.2.2.1.1"><plus id="S3.SS3.p3.8.m3.2.2.1.1.1.cmml" xref="S3.SS3.p3.8.m3.2.2.1.1.1"></plus><ci id="S3.SS3.p3.8.m3.2.2.1.1.2.cmml" xref="S3.SS3.p3.8.m3.2.2.1.1.2">𝑙</ci><cn type="integer" id="S3.SS3.p3.8.m3.2.2.1.1.3.cmml" xref="S3.SS3.p3.8.m3.2.2.1.1.3">1</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m3.2c">l,l+1</annotation></semantics></math> of the gradient entry for <math id="S3.SS3.p3.9.m4.1" class="ltx_Math" alttext="W_{*}" display="inline"><semantics id="S3.SS3.p3.9.m4.1a"><msub id="S3.SS3.p3.9.m4.1.1" xref="S3.SS3.p3.9.m4.1.1.cmml"><mi id="S3.SS3.p3.9.m4.1.1.2" xref="S3.SS3.p3.9.m4.1.1.2.cmml">W</mi><mo id="S3.SS3.p3.9.m4.1.1.3" xref="S3.SS3.p3.9.m4.1.1.3.cmml">∗</mo></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m4.1b"><apply id="S3.SS3.p3.9.m4.1.1.cmml" xref="S3.SS3.p3.9.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m4.1.1.1.cmml" xref="S3.SS3.p3.9.m4.1.1">subscript</csymbol><ci id="S3.SS3.p3.9.m4.1.1.2.cmml" xref="S3.SS3.p3.9.m4.1.1.2">𝑊</ci><times id="S3.SS3.p3.9.m4.1.1.3.cmml" xref="S3.SS3.p3.9.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m4.1c">W_{*}</annotation></semantics></math> correspond to all elements with brightness <math id="S3.SS3.p3.10.m5.1" class="ltx_Math" alttext="c_{l}\leq h(x)\leq c_{l+1}" display="inline"><semantics id="S3.SS3.p3.10.m5.1a"><mrow id="S3.SS3.p3.10.m5.1.2" xref="S3.SS3.p3.10.m5.1.2.cmml"><msub id="S3.SS3.p3.10.m5.1.2.2" xref="S3.SS3.p3.10.m5.1.2.2.cmml"><mi id="S3.SS3.p3.10.m5.1.2.2.2" xref="S3.SS3.p3.10.m5.1.2.2.2.cmml">c</mi><mi id="S3.SS3.p3.10.m5.1.2.2.3" xref="S3.SS3.p3.10.m5.1.2.2.3.cmml">l</mi></msub><mo id="S3.SS3.p3.10.m5.1.2.3" xref="S3.SS3.p3.10.m5.1.2.3.cmml">≤</mo><mrow id="S3.SS3.p3.10.m5.1.2.4" xref="S3.SS3.p3.10.m5.1.2.4.cmml"><mi id="S3.SS3.p3.10.m5.1.2.4.2" xref="S3.SS3.p3.10.m5.1.2.4.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.10.m5.1.2.4.1" xref="S3.SS3.p3.10.m5.1.2.4.1.cmml">​</mo><mrow id="S3.SS3.p3.10.m5.1.2.4.3.2" xref="S3.SS3.p3.10.m5.1.2.4.cmml"><mo stretchy="false" id="S3.SS3.p3.10.m5.1.2.4.3.2.1" xref="S3.SS3.p3.10.m5.1.2.4.cmml">(</mo><mi id="S3.SS3.p3.10.m5.1.1" xref="S3.SS3.p3.10.m5.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS3.p3.10.m5.1.2.4.3.2.2" xref="S3.SS3.p3.10.m5.1.2.4.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.10.m5.1.2.5" xref="S3.SS3.p3.10.m5.1.2.5.cmml">≤</mo><msub id="S3.SS3.p3.10.m5.1.2.6" xref="S3.SS3.p3.10.m5.1.2.6.cmml"><mi id="S3.SS3.p3.10.m5.1.2.6.2" xref="S3.SS3.p3.10.m5.1.2.6.2.cmml">c</mi><mrow id="S3.SS3.p3.10.m5.1.2.6.3" xref="S3.SS3.p3.10.m5.1.2.6.3.cmml"><mi id="S3.SS3.p3.10.m5.1.2.6.3.2" xref="S3.SS3.p3.10.m5.1.2.6.3.2.cmml">l</mi><mo id="S3.SS3.p3.10.m5.1.2.6.3.1" xref="S3.SS3.p3.10.m5.1.2.6.3.1.cmml">+</mo><mn id="S3.SS3.p3.10.m5.1.2.6.3.3" xref="S3.SS3.p3.10.m5.1.2.6.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m5.1b"><apply id="S3.SS3.p3.10.m5.1.2.cmml" xref="S3.SS3.p3.10.m5.1.2"><and id="S3.SS3.p3.10.m5.1.2a.cmml" xref="S3.SS3.p3.10.m5.1.2"></and><apply id="S3.SS3.p3.10.m5.1.2b.cmml" xref="S3.SS3.p3.10.m5.1.2"><leq id="S3.SS3.p3.10.m5.1.2.3.cmml" xref="S3.SS3.p3.10.m5.1.2.3"></leq><apply id="S3.SS3.p3.10.m5.1.2.2.cmml" xref="S3.SS3.p3.10.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m5.1.2.2.1.cmml" xref="S3.SS3.p3.10.m5.1.2.2">subscript</csymbol><ci id="S3.SS3.p3.10.m5.1.2.2.2.cmml" xref="S3.SS3.p3.10.m5.1.2.2.2">𝑐</ci><ci id="S3.SS3.p3.10.m5.1.2.2.3.cmml" xref="S3.SS3.p3.10.m5.1.2.2.3">𝑙</ci></apply><apply id="S3.SS3.p3.10.m5.1.2.4.cmml" xref="S3.SS3.p3.10.m5.1.2.4"><times id="S3.SS3.p3.10.m5.1.2.4.1.cmml" xref="S3.SS3.p3.10.m5.1.2.4.1"></times><ci id="S3.SS3.p3.10.m5.1.2.4.2.cmml" xref="S3.SS3.p3.10.m5.1.2.4.2">ℎ</ci><ci id="S3.SS3.p3.10.m5.1.1.cmml" xref="S3.SS3.p3.10.m5.1.1">𝑥</ci></apply></apply><apply id="S3.SS3.p3.10.m5.1.2c.cmml" xref="S3.SS3.p3.10.m5.1.2"><leq id="S3.SS3.p3.10.m5.1.2.5.cmml" xref="S3.SS3.p3.10.m5.1.2.5"></leq><share href="#S3.SS3.p3.10.m5.1.2.4.cmml" id="S3.SS3.p3.10.m5.1.2d.cmml" xref="S3.SS3.p3.10.m5.1.2"></share><apply id="S3.SS3.p3.10.m5.1.2.6.cmml" xref="S3.SS3.p3.10.m5.1.2.6"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m5.1.2.6.1.cmml" xref="S3.SS3.p3.10.m5.1.2.6">subscript</csymbol><ci id="S3.SS3.p3.10.m5.1.2.6.2.cmml" xref="S3.SS3.p3.10.m5.1.2.6.2">𝑐</ci><apply id="S3.SS3.p3.10.m5.1.2.6.3.cmml" xref="S3.SS3.p3.10.m5.1.2.6.3"><plus id="S3.SS3.p3.10.m5.1.2.6.3.1.cmml" xref="S3.SS3.p3.10.m5.1.2.6.3.1"></plus><ci id="S3.SS3.p3.10.m5.1.2.6.3.2.cmml" xref="S3.SS3.p3.10.m5.1.2.6.3.2">𝑙</ci><cn type="integer" id="S3.SS3.p3.10.m5.1.2.6.3.3.cmml" xref="S3.SS3.p3.10.m5.1.2.6.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m5.1c">c_{l}\leq h(x)\leq c_{l+1}</annotation></semantics></math> (in this case, assumed to be just <math id="S3.SS3.p3.11.m6.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S3.SS3.p3.11.m6.1a"><msub id="S3.SS3.p3.11.m6.1.1" xref="S3.SS3.p3.11.m6.1.1.cmml"><mi id="S3.SS3.p3.11.m6.1.1.2" xref="S3.SS3.p3.11.m6.1.1.2.cmml">x</mi><mi id="S3.SS3.p3.11.m6.1.1.3" xref="S3.SS3.p3.11.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m6.1b"><apply id="S3.SS3.p3.11.m6.1.1.cmml" xref="S3.SS3.p3.11.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.11.m6.1.1.1.cmml" xref="S3.SS3.p3.11.m6.1.1">subscript</csymbol><ci id="S3.SS3.p3.11.m6.1.1.2.cmml" xref="S3.SS3.p3.11.m6.1.1.2">𝑥</ci><ci id="S3.SS3.p3.11.m6.1.1.3.cmml" xref="S3.SS3.p3.11.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.11.m6.1c">x_{t}</annotation></semantics></math> - see <a href="#A2" title="Appendix B Remark on Recovery ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">B</span></a> for remark). This is because all of <math id="S3.SS3.p3.12.m7.1" class="ltx_Math" alttext="x_{t}\cup\{x_{i_{s}}\}" display="inline"><semantics id="S3.SS3.p3.12.m7.1a"><mrow id="S3.SS3.p3.12.m7.1.1" xref="S3.SS3.p3.12.m7.1.1.cmml"><msub id="S3.SS3.p3.12.m7.1.1.3" xref="S3.SS3.p3.12.m7.1.1.3.cmml"><mi id="S3.SS3.p3.12.m7.1.1.3.2" xref="S3.SS3.p3.12.m7.1.1.3.2.cmml">x</mi><mi id="S3.SS3.p3.12.m7.1.1.3.3" xref="S3.SS3.p3.12.m7.1.1.3.3.cmml">t</mi></msub><mo id="S3.SS3.p3.12.m7.1.1.2" xref="S3.SS3.p3.12.m7.1.1.2.cmml">∪</mo><mrow id="S3.SS3.p3.12.m7.1.1.1.1" xref="S3.SS3.p3.12.m7.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.12.m7.1.1.1.1.2" xref="S3.SS3.p3.12.m7.1.1.1.2.cmml">{</mo><msub id="S3.SS3.p3.12.m7.1.1.1.1.1" xref="S3.SS3.p3.12.m7.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.12.m7.1.1.1.1.1.2" xref="S3.SS3.p3.12.m7.1.1.1.1.1.2.cmml">x</mi><msub id="S3.SS3.p3.12.m7.1.1.1.1.1.3" xref="S3.SS3.p3.12.m7.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.12.m7.1.1.1.1.1.3.2" xref="S3.SS3.p3.12.m7.1.1.1.1.1.3.2.cmml">i</mi><mi id="S3.SS3.p3.12.m7.1.1.1.1.1.3.3" xref="S3.SS3.p3.12.m7.1.1.1.1.1.3.3.cmml">s</mi></msub></msub><mo stretchy="false" id="S3.SS3.p3.12.m7.1.1.1.1.3" xref="S3.SS3.p3.12.m7.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.12.m7.1b"><apply id="S3.SS3.p3.12.m7.1.1.cmml" xref="S3.SS3.p3.12.m7.1.1"><union id="S3.SS3.p3.12.m7.1.1.2.cmml" xref="S3.SS3.p3.12.m7.1.1.2"></union><apply id="S3.SS3.p3.12.m7.1.1.3.cmml" xref="S3.SS3.p3.12.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m7.1.1.3.1.cmml" xref="S3.SS3.p3.12.m7.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.12.m7.1.1.3.2.cmml" xref="S3.SS3.p3.12.m7.1.1.3.2">𝑥</ci><ci id="S3.SS3.p3.12.m7.1.1.3.3.cmml" xref="S3.SS3.p3.12.m7.1.1.3.3">𝑡</ci></apply><set id="S3.SS3.p3.12.m7.1.1.1.2.cmml" xref="S3.SS3.p3.12.m7.1.1.1.1"><apply id="S3.SS3.p3.12.m7.1.1.1.1.1.cmml" xref="S3.SS3.p3.12.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m7.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.12.m7.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.12.m7.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.12.m7.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS3.p3.12.m7.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.12.m7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m7.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.12.m7.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.12.m7.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.12.m7.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.12.m7.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p3.12.m7.1.1.1.1.1.3.3">𝑠</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.12.m7.1c">x_{t}\cup\{x_{i_{s}}\}</annotation></semantics></math> activate the non-linearity for layer <math id="S3.SS3.p3.13.m8.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.p3.13.m8.1a"><mi id="S3.SS3.p3.13.m8.1.1" xref="S3.SS3.p3.13.m8.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.13.m8.1b"><ci id="S3.SS3.p3.13.m8.1.1.cmml" xref="S3.SS3.p3.13.m8.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.13.m8.1c">l</annotation></semantics></math>, since all these images have brightness <math id="S3.SS3.p3.14.m9.1" class="ltx_Math" alttext="\geq c_{l}" display="inline"><semantics id="S3.SS3.p3.14.m9.1a"><mrow id="S3.SS3.p3.14.m9.1.1" xref="S3.SS3.p3.14.m9.1.1.cmml"><mi id="S3.SS3.p3.14.m9.1.1.2" xref="S3.SS3.p3.14.m9.1.1.2.cmml"></mi><mo id="S3.SS3.p3.14.m9.1.1.1" xref="S3.SS3.p3.14.m9.1.1.1.cmml">≥</mo><msub id="S3.SS3.p3.14.m9.1.1.3" xref="S3.SS3.p3.14.m9.1.1.3.cmml"><mi id="S3.SS3.p3.14.m9.1.1.3.2" xref="S3.SS3.p3.14.m9.1.1.3.2.cmml">c</mi><mi id="S3.SS3.p3.14.m9.1.1.3.3" xref="S3.SS3.p3.14.m9.1.1.3.3.cmml">l</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.14.m9.1b"><apply id="S3.SS3.p3.14.m9.1.1.cmml" xref="S3.SS3.p3.14.m9.1.1"><geq id="S3.SS3.p3.14.m9.1.1.1.cmml" xref="S3.SS3.p3.14.m9.1.1.1"></geq><csymbol cd="latexml" id="S3.SS3.p3.14.m9.1.1.2.cmml" xref="S3.SS3.p3.14.m9.1.1.2">absent</csymbol><apply id="S3.SS3.p3.14.m9.1.1.3.cmml" xref="S3.SS3.p3.14.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.14.m9.1.1.3.1.cmml" xref="S3.SS3.p3.14.m9.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.14.m9.1.1.3.2.cmml" xref="S3.SS3.p3.14.m9.1.1.3.2">𝑐</ci><ci id="S3.SS3.p3.14.m9.1.1.3.3.cmml" xref="S3.SS3.p3.14.m9.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.14.m9.1c">\geq c_{l}</annotation></semantics></math>, however, only images <math id="S3.SS3.p3.15.m10.1" class="ltx_Math" alttext="\{x_{s}\}" display="inline"><semantics id="S3.SS3.p3.15.m10.1a"><mrow id="S3.SS3.p3.15.m10.1.1.1" xref="S3.SS3.p3.15.m10.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p3.15.m10.1.1.1.2" xref="S3.SS3.p3.15.m10.1.1.2.cmml">{</mo><msub id="S3.SS3.p3.15.m10.1.1.1.1" xref="S3.SS3.p3.15.m10.1.1.1.1.cmml"><mi id="S3.SS3.p3.15.m10.1.1.1.1.2" xref="S3.SS3.p3.15.m10.1.1.1.1.2.cmml">x</mi><mi id="S3.SS3.p3.15.m10.1.1.1.1.3" xref="S3.SS3.p3.15.m10.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.SS3.p3.15.m10.1.1.1.3" xref="S3.SS3.p3.15.m10.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.15.m10.1b"><set id="S3.SS3.p3.15.m10.1.1.2.cmml" xref="S3.SS3.p3.15.m10.1.1.1"><apply id="S3.SS3.p3.15.m10.1.1.1.1.cmml" xref="S3.SS3.p3.15.m10.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.15.m10.1.1.1.1.1.cmml" xref="S3.SS3.p3.15.m10.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.15.m10.1.1.1.1.2.cmml" xref="S3.SS3.p3.15.m10.1.1.1.1.2">𝑥</ci><ci id="S3.SS3.p3.15.m10.1.1.1.1.3.cmml" xref="S3.SS3.p3.15.m10.1.1.1.1.3">𝑠</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.15.m10.1c">\{x_{s}\}</annotation></semantics></math> have brightness <math id="S3.SS3.p3.16.m11.1" class="ltx_Math" alttext="\geq c_{l+1}" display="inline"><semantics id="S3.SS3.p3.16.m11.1a"><mrow id="S3.SS3.p3.16.m11.1.1" xref="S3.SS3.p3.16.m11.1.1.cmml"><mi id="S3.SS3.p3.16.m11.1.1.2" xref="S3.SS3.p3.16.m11.1.1.2.cmml"></mi><mo id="S3.SS3.p3.16.m11.1.1.1" xref="S3.SS3.p3.16.m11.1.1.1.cmml">≥</mo><msub id="S3.SS3.p3.16.m11.1.1.3" xref="S3.SS3.p3.16.m11.1.1.3.cmml"><mi id="S3.SS3.p3.16.m11.1.1.3.2" xref="S3.SS3.p3.16.m11.1.1.3.2.cmml">c</mi><mrow id="S3.SS3.p3.16.m11.1.1.3.3" xref="S3.SS3.p3.16.m11.1.1.3.3.cmml"><mi id="S3.SS3.p3.16.m11.1.1.3.3.2" xref="S3.SS3.p3.16.m11.1.1.3.3.2.cmml">l</mi><mo id="S3.SS3.p3.16.m11.1.1.3.3.1" xref="S3.SS3.p3.16.m11.1.1.3.3.1.cmml">+</mo><mn id="S3.SS3.p3.16.m11.1.1.3.3.3" xref="S3.SS3.p3.16.m11.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.16.m11.1b"><apply id="S3.SS3.p3.16.m11.1.1.cmml" xref="S3.SS3.p3.16.m11.1.1"><geq id="S3.SS3.p3.16.m11.1.1.1.cmml" xref="S3.SS3.p3.16.m11.1.1.1"></geq><csymbol cd="latexml" id="S3.SS3.p3.16.m11.1.1.2.cmml" xref="S3.SS3.p3.16.m11.1.1.2">absent</csymbol><apply id="S3.SS3.p3.16.m11.1.1.3.cmml" xref="S3.SS3.p3.16.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.16.m11.1.1.3.1.cmml" xref="S3.SS3.p3.16.m11.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.16.m11.1.1.3.2.cmml" xref="S3.SS3.p3.16.m11.1.1.3.2">𝑐</ci><apply id="S3.SS3.p3.16.m11.1.1.3.3.cmml" xref="S3.SS3.p3.16.m11.1.1.3.3"><plus id="S3.SS3.p3.16.m11.1.1.3.3.1.cmml" xref="S3.SS3.p3.16.m11.1.1.3.3.1"></plus><ci id="S3.SS3.p3.16.m11.1.1.3.3.2.cmml" xref="S3.SS3.p3.16.m11.1.1.3.3.2">𝑙</ci><cn type="integer" id="S3.SS3.p3.16.m11.1.1.3.3.3.cmml" xref="S3.SS3.p3.16.m11.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.16.m11.1c">\geq c_{l+1}</annotation></semantics></math>, so only these images activate the non-linearity for layer <math id="S3.SS3.p3.17.m12.1" class="ltx_Math" alttext="l+1" display="inline"><semantics id="S3.SS3.p3.17.m12.1a"><mrow id="S3.SS3.p3.17.m12.1.1" xref="S3.SS3.p3.17.m12.1.1.cmml"><mi id="S3.SS3.p3.17.m12.1.1.2" xref="S3.SS3.p3.17.m12.1.1.2.cmml">l</mi><mo id="S3.SS3.p3.17.m12.1.1.1" xref="S3.SS3.p3.17.m12.1.1.1.cmml">+</mo><mn id="S3.SS3.p3.17.m12.1.1.3" xref="S3.SS3.p3.17.m12.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.17.m12.1b"><apply id="S3.SS3.p3.17.m12.1.1.cmml" xref="S3.SS3.p3.17.m12.1.1"><plus id="S3.SS3.p3.17.m12.1.1.1.cmml" xref="S3.SS3.p3.17.m12.1.1.1"></plus><ci id="S3.SS3.p3.17.m12.1.1.2.cmml" xref="S3.SS3.p3.17.m12.1.1.2">𝑙</ci><cn type="integer" id="S3.SS3.p3.17.m12.1.1.3.cmml" xref="S3.SS3.p3.17.m12.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.17.m12.1c">l+1</annotation></semantics></math>. An interesting biproduct of this setup is that it would be difficult even for hand inspection of the parameters to reveal the inclusion of this module as the server could easily permute the bins, and add random rows to <math id="S3.SS3.p3.18.m13.1" class="ltx_Math" alttext="W_{*}" display="inline"><semantics id="S3.SS3.p3.18.m13.1a"><msub id="S3.SS3.p3.18.m13.1.1" xref="S3.SS3.p3.18.m13.1.1.cmml"><mi id="S3.SS3.p3.18.m13.1.1.2" xref="S3.SS3.p3.18.m13.1.1.2.cmml">W</mi><mo id="S3.SS3.p3.18.m13.1.1.3" xref="S3.SS3.p3.18.m13.1.1.3.cmml">∗</mo></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.18.m13.1b"><apply id="S3.SS3.p3.18.m13.1.1.cmml" xref="S3.SS3.p3.18.m13.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.18.m13.1.1.1.cmml" xref="S3.SS3.p3.18.m13.1.1">subscript</csymbol><ci id="S3.SS3.p3.18.m13.1.1.2.cmml" xref="S3.SS3.p3.18.m13.1.1.2">𝑊</ci><times id="S3.SS3.p3.18.m13.1.1.3.cmml" xref="S3.SS3.p3.18.m13.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.18.m13.1c">W_{*}</annotation></semantics></math> which do not correspond to actual bins and only contribute to model performance. The gradient does not directly contain user data, so that the leak is also difficult to find by analyzing the gradient data and checking for matches with user data therein.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.5" class="ltx_p">How successful will this attack be?
Recall the parameter <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">k</annotation></semantics></math> defined in the construction of the imprint module. This corresponds to the number of bins the malicious server can create to reconstruct user data. If a <em id="S3.SS3.p4.5.1" class="ltx_emph ltx_font_italic">batch</em> of data is passed through the imprint module, depending on the batch size <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">n</annotation></semantics></math> used to calculate the update sent to the server, and number of bins, <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">k</annotation></semantics></math>, the server can expect several bins to activate for <em id="S3.SS3.p4.5.2" class="ltx_emph ltx_font_italic">only</em> one datapoint. And the corresponding entries of the gradient vector can be appropriately combined, and inverted easily. The following result quantifies the user vulnerability in terms of the number of imprint bins, <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><mi id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><ci id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">k</annotation></semantics></math>, and the amount of data, <math id="S3.SS3.p4.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS3.p4.5.m5.1a"><mi id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><ci id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">n</annotation></semantics></math>, averaged in a given update.</p>
</div>
<div id="Thmproposition1" class="ltx_theorem ltx_theorem_proposition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmproposition1.1.1.1" class="ltx_text ltx_font_bold">Proposition 1</span></span><span id="Thmproposition1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmproposition1.p1" class="ltx_para ltx_noindent">
<p id="Thmproposition1.p1.3" class="ltx_p"><span id="Thmproposition1.p1.3.3" class="ltx_text ltx_font_italic">If the server knows the CDF (assumed to be continuous) of some quantity associated with user data that can be measured with a linear function <math id="Thmproposition1.p1.1.1.m1.1" class="ltx_Math" alttext="h:\mathbb{R}^{m}\rightarrow\mathbb{R}" display="inline"><semantics id="Thmproposition1.p1.1.1.m1.1a"><mrow id="Thmproposition1.p1.1.1.m1.1.1" xref="Thmproposition1.p1.1.1.m1.1.1.cmml"><mi id="Thmproposition1.p1.1.1.m1.1.1.2" xref="Thmproposition1.p1.1.1.m1.1.1.2.cmml">h</mi><mo lspace="0.278em" rspace="0.278em" id="Thmproposition1.p1.1.1.m1.1.1.1" xref="Thmproposition1.p1.1.1.m1.1.1.1.cmml">:</mo><mrow id="Thmproposition1.p1.1.1.m1.1.1.3" xref="Thmproposition1.p1.1.1.m1.1.1.3.cmml"><msup id="Thmproposition1.p1.1.1.m1.1.1.3.2" xref="Thmproposition1.p1.1.1.m1.1.1.3.2.cmml"><mi id="Thmproposition1.p1.1.1.m1.1.1.3.2.2" xref="Thmproposition1.p1.1.1.m1.1.1.3.2.2.cmml">ℝ</mi><mi id="Thmproposition1.p1.1.1.m1.1.1.3.2.3" xref="Thmproposition1.p1.1.1.m1.1.1.3.2.3.cmml">m</mi></msup><mo stretchy="false" id="Thmproposition1.p1.1.1.m1.1.1.3.1" xref="Thmproposition1.p1.1.1.m1.1.1.3.1.cmml">→</mo><mi id="Thmproposition1.p1.1.1.m1.1.1.3.3" xref="Thmproposition1.p1.1.1.m1.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.1.1.m1.1b"><apply id="Thmproposition1.p1.1.1.m1.1.1.cmml" xref="Thmproposition1.p1.1.1.m1.1.1"><ci id="Thmproposition1.p1.1.1.m1.1.1.1.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.1">:</ci><ci id="Thmproposition1.p1.1.1.m1.1.1.2.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.2">ℎ</ci><apply id="Thmproposition1.p1.1.1.m1.1.1.3.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.3"><ci id="Thmproposition1.p1.1.1.m1.1.1.3.1.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.3.1">→</ci><apply id="Thmproposition1.p1.1.1.m1.1.1.3.2.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="Thmproposition1.p1.1.1.m1.1.1.3.2.1.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.3.2">superscript</csymbol><ci id="Thmproposition1.p1.1.1.m1.1.1.3.2.2.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.3.2.2">ℝ</ci><ci id="Thmproposition1.p1.1.1.m1.1.1.3.2.3.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.3.2.3">𝑚</ci></apply><ci id="Thmproposition1.p1.1.1.m1.1.1.3.3.cmml" xref="Thmproposition1.p1.1.1.m1.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.1.1.m1.1c">h:\mathbb{R}^{m}\rightarrow\mathbb{R}</annotation></semantics></math>, then for a batch of size <math id="Thmproposition1.p1.2.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="Thmproposition1.p1.2.2.m2.1a"><mi id="Thmproposition1.p1.2.2.m2.1.1" xref="Thmproposition1.p1.2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.2.2.m2.1b"><ci id="Thmproposition1.p1.2.2.m2.1.1.cmml" xref="Thmproposition1.p1.2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.2.2.m2.1c">n</annotation></semantics></math> and a number of imprint bins <math id="Thmproposition1.p1.3.3.m3.1" class="ltx_Math" alttext="k&gt;n&gt;2" display="inline"><semantics id="Thmproposition1.p1.3.3.m3.1a"><mrow id="Thmproposition1.p1.3.3.m3.1.1" xref="Thmproposition1.p1.3.3.m3.1.1.cmml"><mi id="Thmproposition1.p1.3.3.m3.1.1.2" xref="Thmproposition1.p1.3.3.m3.1.1.2.cmml">k</mi><mo id="Thmproposition1.p1.3.3.m3.1.1.3" xref="Thmproposition1.p1.3.3.m3.1.1.3.cmml">&gt;</mo><mi id="Thmproposition1.p1.3.3.m3.1.1.4" xref="Thmproposition1.p1.3.3.m3.1.1.4.cmml">n</mi><mo id="Thmproposition1.p1.3.3.m3.1.1.5" xref="Thmproposition1.p1.3.3.m3.1.1.5.cmml">&gt;</mo><mn id="Thmproposition1.p1.3.3.m3.1.1.6" xref="Thmproposition1.p1.3.3.m3.1.1.6.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.3.3.m3.1b"><apply id="Thmproposition1.p1.3.3.m3.1.1.cmml" xref="Thmproposition1.p1.3.3.m3.1.1"><and id="Thmproposition1.p1.3.3.m3.1.1a.cmml" xref="Thmproposition1.p1.3.3.m3.1.1"></and><apply id="Thmproposition1.p1.3.3.m3.1.1b.cmml" xref="Thmproposition1.p1.3.3.m3.1.1"><gt id="Thmproposition1.p1.3.3.m3.1.1.3.cmml" xref="Thmproposition1.p1.3.3.m3.1.1.3"></gt><ci id="Thmproposition1.p1.3.3.m3.1.1.2.cmml" xref="Thmproposition1.p1.3.3.m3.1.1.2">𝑘</ci><ci id="Thmproposition1.p1.3.3.m3.1.1.4.cmml" xref="Thmproposition1.p1.3.3.m3.1.1.4">𝑛</ci></apply><apply id="Thmproposition1.p1.3.3.m3.1.1c.cmml" xref="Thmproposition1.p1.3.3.m3.1.1"><gt id="Thmproposition1.p1.3.3.m3.1.1.5.cmml" xref="Thmproposition1.p1.3.3.m3.1.1.5"></gt><share href="#Thmproposition1.p1.3.3.m3.1.1.4.cmml" id="Thmproposition1.p1.3.3.m3.1.1d.cmml" xref="Thmproposition1.p1.3.3.m3.1.1"></share><cn type="integer" id="Thmproposition1.p1.3.3.m3.1.1.6.cmml" xref="Thmproposition1.p1.3.3.m3.1.1.6">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.3.3.m3.1c">k&gt;n&gt;2</annotation></semantics></math>, by using an appropriate combination of linear layer and ReLU activation, the server can expect to exactly recover</span></p>
</div>
<div id="Thmproposition1.p2" class="ltx_para">
<table id="S3.Ex6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex6.m1.12" class="ltx_Math" alttext="\frac{1}{\binom{k+n-1}{k-1}}\bigg{[}\sum_{i=1}^{n-2}i\cdot\binom{k}{i}\cdot\bigg{(}\sum_{j=1}^{\lfloor\frac{n-i}{2}\rfloor}\binom{k-i}{j}\binom{n-i-j-1}{j-1}\bigg{)}\bigg{]}+r(n,k)" display="block"><semantics id="S3.Ex6.m1.12a"><mrow id="S3.Ex6.m1.12.12" xref="S3.Ex6.m1.12.12.cmml"><mrow id="S3.Ex6.m1.12.12.1" xref="S3.Ex6.m1.12.12.1.cmml"><mfrac id="S3.Ex6.m1.2.2" xref="S3.Ex6.m1.2.2.cmml"><mn id="S3.Ex6.m1.2.2.4" xref="S3.Ex6.m1.2.2.4.cmml">1</mn><mrow id="S3.Ex6.m1.2.2.2.4" xref="S3.Ex6.m1.2.2.2.3.cmml"><mo id="S3.Ex6.m1.2.2.2.4.1" xref="S3.Ex6.m1.2.2.2.3.1.cmml">(</mo><mfrac linethickness="0pt" id="S3.Ex6.m1.2.2.2.2.2.2" xref="S3.Ex6.m1.2.2.2.3.cmml"><mrow id="S3.Ex6.m1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex6.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></mrow><mo id="S3.Ex6.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mn id="S3.Ex6.m1.1.1.1.1.1.1.1.1.4" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.4.cmml">1</mn></mrow><mrow id="S3.Ex6.m1.2.2.2.2.2.2.2.1" xref="S3.Ex6.m1.2.2.2.2.2.2.2.1.cmml"><mi id="S3.Ex6.m1.2.2.2.2.2.2.2.1.3" xref="S3.Ex6.m1.2.2.2.2.2.2.2.1.3.cmml">k</mi><mo id="S3.Ex6.m1.2.2.2.2.2.2.2.1.2" xref="S3.Ex6.m1.2.2.2.2.2.2.2.1.2.cmml">−</mo><mn id="S3.Ex6.m1.2.2.2.2.2.2.2.1.4" xref="S3.Ex6.m1.2.2.2.2.2.2.2.1.4.cmml">1</mn></mrow></mfrac><mo id="S3.Ex6.m1.2.2.2.4.2" xref="S3.Ex6.m1.2.2.2.3.1.cmml">)</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.12.12.1.2" xref="S3.Ex6.m1.12.12.1.2.cmml">​</mo><mrow id="S3.Ex6.m1.12.12.1.1.1" xref="S3.Ex6.m1.12.12.1.1.2.cmml"><mo maxsize="210%" minsize="210%" id="S3.Ex6.m1.12.12.1.1.1.2" xref="S3.Ex6.m1.12.12.1.1.2.1.cmml">[</mo><mrow id="S3.Ex6.m1.12.12.1.1.1.1" xref="S3.Ex6.m1.12.12.1.1.1.1.cmml"><munderover id="S3.Ex6.m1.12.12.1.1.1.1.2" xref="S3.Ex6.m1.12.12.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" id="S3.Ex6.m1.12.12.1.1.1.1.2.2.2" xref="S3.Ex6.m1.12.12.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex6.m1.12.12.1.1.1.1.2.2.3" xref="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.2" xref="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.1" xref="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.3" xref="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.Ex6.m1.12.12.1.1.1.1.2.3" xref="S3.Ex6.m1.12.12.1.1.1.1.2.3.cmml"><mi id="S3.Ex6.m1.12.12.1.1.1.1.2.3.2" xref="S3.Ex6.m1.12.12.1.1.1.1.2.3.2.cmml">n</mi><mo id="S3.Ex6.m1.12.12.1.1.1.1.2.3.1" xref="S3.Ex6.m1.12.12.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.Ex6.m1.12.12.1.1.1.1.2.3.3" xref="S3.Ex6.m1.12.12.1.1.1.1.2.3.3.cmml">2</mn></mrow></munderover><mrow id="S3.Ex6.m1.12.12.1.1.1.1.1" xref="S3.Ex6.m1.12.12.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.12.12.1.1.1.1.1.3" xref="S3.Ex6.m1.12.12.1.1.1.1.1.3.cmml">i</mi><mo lspace="0.222em" rspace="0.222em" id="S3.Ex6.m1.12.12.1.1.1.1.1.2" xref="S3.Ex6.m1.12.12.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S3.Ex6.m1.4.4.4" xref="S3.Ex6.m1.4.4.3.cmml"><mo id="S3.Ex6.m1.4.4.4.1" xref="S3.Ex6.m1.4.4.3.1.cmml">(</mo><mfrac linethickness="0pt" id="S3.Ex6.m1.4.4.2.2" xref="S3.Ex6.m1.4.4.3.cmml"><mi id="S3.Ex6.m1.3.3.1.1.1.1" xref="S3.Ex6.m1.3.3.1.1.1.1.cmml">k</mi><mi id="S3.Ex6.m1.4.4.2.2.2.1" xref="S3.Ex6.m1.4.4.2.2.2.1.cmml">i</mi></mfrac><mo rspace="0.055em" id="S3.Ex6.m1.4.4.4.2" xref="S3.Ex6.m1.4.4.3.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.Ex6.m1.12.12.1.1.1.1.1.2a" xref="S3.Ex6.m1.12.12.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.cmml"><mo maxsize="210%" minsize="210%" id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.Ex6.m1.9.9.1.3" xref="S3.Ex6.m1.9.9.1.2.cmml"><mo stretchy="false" id="S3.Ex6.m1.9.9.1.3.1" xref="S3.Ex6.m1.9.9.1.2.1.cmml">⌊</mo><mfrac id="S3.Ex6.m1.9.9.1.1" xref="S3.Ex6.m1.9.9.1.1.cmml"><mrow id="S3.Ex6.m1.9.9.1.1.2" xref="S3.Ex6.m1.9.9.1.1.2.cmml"><mi id="S3.Ex6.m1.9.9.1.1.2.2" xref="S3.Ex6.m1.9.9.1.1.2.2.cmml">n</mi><mo id="S3.Ex6.m1.9.9.1.1.2.1" xref="S3.Ex6.m1.9.9.1.1.2.1.cmml">−</mo><mi id="S3.Ex6.m1.9.9.1.1.2.3" xref="S3.Ex6.m1.9.9.1.1.2.3.cmml">i</mi></mrow><mn id="S3.Ex6.m1.9.9.1.1.3" xref="S3.Ex6.m1.9.9.1.1.3.cmml">2</mn></mfrac><mo stretchy="false" id="S3.Ex6.m1.9.9.1.3.2" xref="S3.Ex6.m1.9.9.1.2.1.cmml">⌋</mo></mrow></munderover><mrow id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.Ex6.m1.6.6.4" xref="S3.Ex6.m1.6.6.3.cmml"><mo id="S3.Ex6.m1.6.6.4.1" xref="S3.Ex6.m1.6.6.3.1.cmml">(</mo><mfrac linethickness="0pt" id="S3.Ex6.m1.6.6.2.2" xref="S3.Ex6.m1.6.6.3.cmml"><mrow id="S3.Ex6.m1.5.5.1.1.1.1" xref="S3.Ex6.m1.5.5.1.1.1.1.cmml"><mi id="S3.Ex6.m1.5.5.1.1.1.1.3" xref="S3.Ex6.m1.5.5.1.1.1.1.3.cmml">k</mi><mo id="S3.Ex6.m1.5.5.1.1.1.1.2" xref="S3.Ex6.m1.5.5.1.1.1.1.2.cmml">−</mo><mi id="S3.Ex6.m1.5.5.1.1.1.1.4" xref="S3.Ex6.m1.5.5.1.1.1.1.4.cmml">i</mi></mrow><mi id="S3.Ex6.m1.6.6.2.2.2.1" xref="S3.Ex6.m1.6.6.2.2.2.1.cmml">j</mi></mfrac><mo id="S3.Ex6.m1.6.6.4.2" xref="S3.Ex6.m1.6.6.3.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.2.1" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S3.Ex6.m1.8.8.4" xref="S3.Ex6.m1.8.8.3.cmml"><mo id="S3.Ex6.m1.8.8.4.1" xref="S3.Ex6.m1.8.8.3.1.cmml">(</mo><mfrac linethickness="0pt" id="S3.Ex6.m1.8.8.2.2" xref="S3.Ex6.m1.8.8.3.cmml"><mrow id="S3.Ex6.m1.7.7.1.1.1.1" xref="S3.Ex6.m1.7.7.1.1.1.1.cmml"><mi id="S3.Ex6.m1.7.7.1.1.1.1.3" xref="S3.Ex6.m1.7.7.1.1.1.1.3.cmml">n</mi><mo id="S3.Ex6.m1.7.7.1.1.1.1.2" xref="S3.Ex6.m1.7.7.1.1.1.1.2.cmml">−</mo><mi id="S3.Ex6.m1.7.7.1.1.1.1.4" xref="S3.Ex6.m1.7.7.1.1.1.1.4.cmml">i</mi><mo id="S3.Ex6.m1.7.7.1.1.1.1.2a" xref="S3.Ex6.m1.7.7.1.1.1.1.2.cmml">−</mo><mi id="S3.Ex6.m1.7.7.1.1.1.1.5" xref="S3.Ex6.m1.7.7.1.1.1.1.5.cmml">j</mi><mo id="S3.Ex6.m1.7.7.1.1.1.1.2b" xref="S3.Ex6.m1.7.7.1.1.1.1.2.cmml">−</mo><mn id="S3.Ex6.m1.7.7.1.1.1.1.6" xref="S3.Ex6.m1.7.7.1.1.1.1.6.cmml">1</mn></mrow><mrow id="S3.Ex6.m1.8.8.2.2.2.1" xref="S3.Ex6.m1.8.8.2.2.2.1.cmml"><mi id="S3.Ex6.m1.8.8.2.2.2.1.3" xref="S3.Ex6.m1.8.8.2.2.2.1.3.cmml">j</mi><mo id="S3.Ex6.m1.8.8.2.2.2.1.2" xref="S3.Ex6.m1.8.8.2.2.2.1.2.cmml">−</mo><mn id="S3.Ex6.m1.8.8.2.2.2.1.4" xref="S3.Ex6.m1.8.8.2.2.2.1.4.cmml">1</mn></mrow></mfrac><mo id="S3.Ex6.m1.8.8.4.2" xref="S3.Ex6.m1.8.8.3.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="210%" minsize="210%" id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="210%" minsize="210%" id="S3.Ex6.m1.12.12.1.1.1.3" xref="S3.Ex6.m1.12.12.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.Ex6.m1.12.12.2" xref="S3.Ex6.m1.12.12.2.cmml">+</mo><mrow id="S3.Ex6.m1.12.12.3" xref="S3.Ex6.m1.12.12.3.cmml"><mi id="S3.Ex6.m1.12.12.3.2" xref="S3.Ex6.m1.12.12.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.12.12.3.1" xref="S3.Ex6.m1.12.12.3.1.cmml">​</mo><mrow id="S3.Ex6.m1.12.12.3.3.2" xref="S3.Ex6.m1.12.12.3.3.1.cmml"><mo stretchy="false" id="S3.Ex6.m1.12.12.3.3.2.1" xref="S3.Ex6.m1.12.12.3.3.1.cmml">(</mo><mi id="S3.Ex6.m1.10.10" xref="S3.Ex6.m1.10.10.cmml">n</mi><mo id="S3.Ex6.m1.12.12.3.3.2.2" xref="S3.Ex6.m1.12.12.3.3.1.cmml">,</mo><mi id="S3.Ex6.m1.11.11" xref="S3.Ex6.m1.11.11.cmml">k</mi><mo stretchy="false" id="S3.Ex6.m1.12.12.3.3.2.3" xref="S3.Ex6.m1.12.12.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.12b"><apply id="S3.Ex6.m1.12.12.cmml" xref="S3.Ex6.m1.12.12"><plus id="S3.Ex6.m1.12.12.2.cmml" xref="S3.Ex6.m1.12.12.2"></plus><apply id="S3.Ex6.m1.12.12.1.cmml" xref="S3.Ex6.m1.12.12.1"><times id="S3.Ex6.m1.12.12.1.2.cmml" xref="S3.Ex6.m1.12.12.1.2"></times><apply id="S3.Ex6.m1.2.2.cmml" xref="S3.Ex6.m1.2.2"><divide id="S3.Ex6.m1.2.2.3.cmml" xref="S3.Ex6.m1.2.2"></divide><cn type="integer" id="S3.Ex6.m1.2.2.4.cmml" xref="S3.Ex6.m1.2.2.4">1</cn><apply id="S3.Ex6.m1.2.2.2.3.cmml" xref="S3.Ex6.m1.2.2.2.4"><csymbol cd="latexml" id="S3.Ex6.m1.2.2.2.3.1.cmml" xref="S3.Ex6.m1.2.2.2.4.1">binomial</csymbol><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1"><minus id="S3.Ex6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.2"></minus><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.3"><plus id="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.2">𝑘</ci><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply><cn type="integer" id="S3.Ex6.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.4">1</cn></apply><apply id="S3.Ex6.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.Ex6.m1.2.2.2.2.2.2.2.1"><minus id="S3.Ex6.m1.2.2.2.2.2.2.2.1.2.cmml" xref="S3.Ex6.m1.2.2.2.2.2.2.2.1.2"></minus><ci id="S3.Ex6.m1.2.2.2.2.2.2.2.1.3.cmml" xref="S3.Ex6.m1.2.2.2.2.2.2.2.1.3">𝑘</ci><cn type="integer" id="S3.Ex6.m1.2.2.2.2.2.2.2.1.4.cmml" xref="S3.Ex6.m1.2.2.2.2.2.2.2.1.4">1</cn></apply></apply></apply><apply id="S3.Ex6.m1.12.12.1.1.2.cmml" xref="S3.Ex6.m1.12.12.1.1.1"><csymbol cd="latexml" id="S3.Ex6.m1.12.12.1.1.2.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex6.m1.12.12.1.1.1.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1"><apply id="S3.Ex6.m1.12.12.1.1.1.1.2.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.12.12.1.1.1.1.2.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex6.m1.12.12.1.1.1.1.2.2.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.12.12.1.1.1.1.2.2.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex6.m1.12.12.1.1.1.1.2.2.2.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2.2.2"></sum><apply id="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2.2.3"><eq id="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.1"></eq><ci id="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.Ex6.m1.12.12.1.1.1.1.2.3.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2.3"><minus id="S3.Ex6.m1.12.12.1.1.1.1.2.3.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2.3.1"></minus><ci id="S3.Ex6.m1.12.12.1.1.1.1.2.3.2.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2.3.2">𝑛</ci><cn type="integer" id="S3.Ex6.m1.12.12.1.1.1.1.2.3.3.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="S3.Ex6.m1.12.12.1.1.1.1.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1"><ci id="S3.Ex6.m1.12.12.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.2">⋅</ci><ci id="S3.Ex6.m1.12.12.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.3">𝑖</ci><apply id="S3.Ex6.m1.4.4.3.cmml" xref="S3.Ex6.m1.4.4.4"><csymbol cd="latexml" id="S3.Ex6.m1.4.4.3.1.cmml" xref="S3.Ex6.m1.4.4.4.1">binomial</csymbol><ci id="S3.Ex6.m1.3.3.1.1.1.1.cmml" xref="S3.Ex6.m1.3.3.1.1.1.1">𝑘</ci><ci id="S3.Ex6.m1.4.4.2.2.2.1.cmml" xref="S3.Ex6.m1.4.4.2.2.2.1">𝑖</ci></apply><apply id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1"><apply id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3"><eq id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.Ex6.m1.9.9.1.2.cmml" xref="S3.Ex6.m1.9.9.1.3"><floor id="S3.Ex6.m1.9.9.1.2.1.cmml" xref="S3.Ex6.m1.9.9.1.3.1"></floor><apply id="S3.Ex6.m1.9.9.1.1.cmml" xref="S3.Ex6.m1.9.9.1.1"><divide id="S3.Ex6.m1.9.9.1.1.1.cmml" xref="S3.Ex6.m1.9.9.1.1"></divide><apply id="S3.Ex6.m1.9.9.1.1.2.cmml" xref="S3.Ex6.m1.9.9.1.1.2"><minus id="S3.Ex6.m1.9.9.1.1.2.1.cmml" xref="S3.Ex6.m1.9.9.1.1.2.1"></minus><ci id="S3.Ex6.m1.9.9.1.1.2.2.cmml" xref="S3.Ex6.m1.9.9.1.1.2.2">𝑛</ci><ci id="S3.Ex6.m1.9.9.1.1.2.3.cmml" xref="S3.Ex6.m1.9.9.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.Ex6.m1.9.9.1.1.3.cmml" xref="S3.Ex6.m1.9.9.1.1.3">2</cn></apply></apply></apply><apply id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.2"><times id="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex6.m1.12.12.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex6.m1.6.6.3.cmml" xref="S3.Ex6.m1.6.6.4"><csymbol cd="latexml" id="S3.Ex6.m1.6.6.3.1.cmml" xref="S3.Ex6.m1.6.6.4.1">binomial</csymbol><apply id="S3.Ex6.m1.5.5.1.1.1.1.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1"><minus id="S3.Ex6.m1.5.5.1.1.1.1.2.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.2"></minus><ci id="S3.Ex6.m1.5.5.1.1.1.1.3.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.3">𝑘</ci><ci id="S3.Ex6.m1.5.5.1.1.1.1.4.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.4">𝑖</ci></apply><ci id="S3.Ex6.m1.6.6.2.2.2.1.cmml" xref="S3.Ex6.m1.6.6.2.2.2.1">𝑗</ci></apply><apply id="S3.Ex6.m1.8.8.3.cmml" xref="S3.Ex6.m1.8.8.4"><csymbol cd="latexml" id="S3.Ex6.m1.8.8.3.1.cmml" xref="S3.Ex6.m1.8.8.4.1">binomial</csymbol><apply id="S3.Ex6.m1.7.7.1.1.1.1.cmml" xref="S3.Ex6.m1.7.7.1.1.1.1"><minus id="S3.Ex6.m1.7.7.1.1.1.1.2.cmml" xref="S3.Ex6.m1.7.7.1.1.1.1.2"></minus><ci id="S3.Ex6.m1.7.7.1.1.1.1.3.cmml" xref="S3.Ex6.m1.7.7.1.1.1.1.3">𝑛</ci><ci id="S3.Ex6.m1.7.7.1.1.1.1.4.cmml" xref="S3.Ex6.m1.7.7.1.1.1.1.4">𝑖</ci><ci id="S3.Ex6.m1.7.7.1.1.1.1.5.cmml" xref="S3.Ex6.m1.7.7.1.1.1.1.5">𝑗</ci><cn type="integer" id="S3.Ex6.m1.7.7.1.1.1.1.6.cmml" xref="S3.Ex6.m1.7.7.1.1.1.1.6">1</cn></apply><apply id="S3.Ex6.m1.8.8.2.2.2.1.cmml" xref="S3.Ex6.m1.8.8.2.2.2.1"><minus id="S3.Ex6.m1.8.8.2.2.2.1.2.cmml" xref="S3.Ex6.m1.8.8.2.2.2.1.2"></minus><ci id="S3.Ex6.m1.8.8.2.2.2.1.3.cmml" xref="S3.Ex6.m1.8.8.2.2.2.1.3">𝑗</ci><cn type="integer" id="S3.Ex6.m1.8.8.2.2.2.1.4.cmml" xref="S3.Ex6.m1.8.8.2.2.2.1.4">1</cn></apply></apply></apply></apply></apply></apply></apply></apply><apply id="S3.Ex6.m1.12.12.3.cmml" xref="S3.Ex6.m1.12.12.3"><times id="S3.Ex6.m1.12.12.3.1.cmml" xref="S3.Ex6.m1.12.12.3.1"></times><ci id="S3.Ex6.m1.12.12.3.2.cmml" xref="S3.Ex6.m1.12.12.3.2">𝑟</ci><interval closure="open" id="S3.Ex6.m1.12.12.3.3.1.cmml" xref="S3.Ex6.m1.12.12.3.3.2"><ci id="S3.Ex6.m1.10.10.cmml" xref="S3.Ex6.m1.10.10">𝑛</ci><ci id="S3.Ex6.m1.11.11.cmml" xref="S3.Ex6.m1.11.11">𝑘</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.12c">\frac{1}{\binom{k+n-1}{k-1}}\bigg{[}\sum_{i=1}^{n-2}i\cdot\binom{k}{i}\cdot\bigg{(}\sum_{j=1}^{\lfloor\frac{n-i}{2}\rfloor}\binom{k-i}{j}\binom{n-i-j-1}{j-1}\bigg{)}\bigg{]}+r(n,k)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="Thmproposition1.p2.2" class="ltx_p"><span id="Thmproposition1.p2.2.2" class="ltx_text ltx_font_italic">samples of user data (where the data is in <math id="Thmproposition1.p2.1.1.m1.1" class="ltx_Math" alttext="\mathbb{R}^{m}" display="inline"><semantics id="Thmproposition1.p2.1.1.m1.1a"><msup id="Thmproposition1.p2.1.1.m1.1.1" xref="Thmproposition1.p2.1.1.m1.1.1.cmml"><mi id="Thmproposition1.p2.1.1.m1.1.1.2" xref="Thmproposition1.p2.1.1.m1.1.1.2.cmml">ℝ</mi><mi id="Thmproposition1.p2.1.1.m1.1.1.3" xref="Thmproposition1.p2.1.1.m1.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="Thmproposition1.p2.1.1.m1.1b"><apply id="Thmproposition1.p2.1.1.m1.1.1.cmml" xref="Thmproposition1.p2.1.1.m1.1.1"><csymbol cd="ambiguous" id="Thmproposition1.p2.1.1.m1.1.1.1.cmml" xref="Thmproposition1.p2.1.1.m1.1.1">superscript</csymbol><ci id="Thmproposition1.p2.1.1.m1.1.1.2.cmml" xref="Thmproposition1.p2.1.1.m1.1.1.2">ℝ</ci><ci id="Thmproposition1.p2.1.1.m1.1.1.3.cmml" xref="Thmproposition1.p2.1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p2.1.1.m1.1c">\mathbb{R}^{m}</annotation></semantics></math>) perfectly. Note: <math id="Thmproposition1.p2.2.2.m2.2" class="ltx_Math" alttext="r(n,k)" display="inline"><semantics id="Thmproposition1.p2.2.2.m2.2a"><mrow id="Thmproposition1.p2.2.2.m2.2.3" xref="Thmproposition1.p2.2.2.m2.2.3.cmml"><mi id="Thmproposition1.p2.2.2.m2.2.3.2" xref="Thmproposition1.p2.2.2.m2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="Thmproposition1.p2.2.2.m2.2.3.1" xref="Thmproposition1.p2.2.2.m2.2.3.1.cmml">​</mo><mrow id="Thmproposition1.p2.2.2.m2.2.3.3.2" xref="Thmproposition1.p2.2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="Thmproposition1.p2.2.2.m2.2.3.3.2.1" xref="Thmproposition1.p2.2.2.m2.2.3.3.1.cmml">(</mo><mi id="Thmproposition1.p2.2.2.m2.1.1" xref="Thmproposition1.p2.2.2.m2.1.1.cmml">n</mi><mo id="Thmproposition1.p2.2.2.m2.2.3.3.2.2" xref="Thmproposition1.p2.2.2.m2.2.3.3.1.cmml">,</mo><mi id="Thmproposition1.p2.2.2.m2.2.2" xref="Thmproposition1.p2.2.2.m2.2.2.cmml">k</mi><mo stretchy="false" id="Thmproposition1.p2.2.2.m2.2.3.3.2.3" xref="Thmproposition1.p2.2.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p2.2.2.m2.2b"><apply id="Thmproposition1.p2.2.2.m2.2.3.cmml" xref="Thmproposition1.p2.2.2.m2.2.3"><times id="Thmproposition1.p2.2.2.m2.2.3.1.cmml" xref="Thmproposition1.p2.2.2.m2.2.3.1"></times><ci id="Thmproposition1.p2.2.2.m2.2.3.2.cmml" xref="Thmproposition1.p2.2.2.m2.2.3.2">𝑟</ci><interval closure="open" id="Thmproposition1.p2.2.2.m2.2.3.3.1.cmml" xref="Thmproposition1.p2.2.2.m2.2.3.3.2"><ci id="Thmproposition1.p2.2.2.m2.1.1.cmml" xref="Thmproposition1.p2.2.2.m2.1.1">𝑛</ci><ci id="Thmproposition1.p2.2.2.m2.2.2.cmml" xref="Thmproposition1.p2.2.2.m2.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p2.2.2.m2.2c">r(n,k)</annotation></semantics></math> is a correction term (see proof for full expansion).</span></p>
</div>
</div>
<div id="S3.SS3.1" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="S3.SS3.1.p1" class="ltx_para">
<p id="S3.SS3.1.p1.1" class="ltx_p">See <a href="#A1.SS1" title="A.1 Proof of Proposition 1 ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.1</span></a>.
∎</p>
</div>
</div>
<div id="S3.SS3.p5" class="ltx_para ltx_noindent">
<p id="S3.SS3.p5.2" class="ltx_p">This can be thought of as a <em id="S3.SS3.p5.2.1" class="ltx_emph ltx_font_italic">lower</em> bound on privacy breaches since, often, identifiable information can be extracted from a mixture of two images. Note that increasing the expected number of perfectly reconstructed images requires increasing the number of imprint bins, which in turn requires increasing the number of channels of the matrix <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="W_{*}" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><msub id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><mi id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml">W</mi><mo id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3.cmml">∗</mo></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2">𝑊</ci><times id="S3.SS3.p5.1.m1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">W_{*}</annotation></semantics></math> and thus the number of parameters. Thus, to visualize the result above in terms of the server-side hyperparameter, <math id="S3.SS3.p5.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p5.2.m2.1a"><mi id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><ci id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">k</annotation></semantics></math>, we plot the expected proportion of data recovered as a function of number of bins in <a href="#S3.F1" title="In 3.3 Imprinting User Information into Model Updates ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>(a). Note that this inversion is analytic, and significantly more efficient and realistic than optimization based methods which often require tens of thousands of update steps.</p>
</div>
<figure id="S3.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2110.13057/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="190" height="95" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2110.13057/assets/x2.png" id="S3.F1.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="190" height="95" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S3.F1.4.1" class="ltx_text ltx_font_bold">Left (a)</span>: Expected proportion of a batch of 64 images <em id="S3.F1.5.2" class="ltx_emph ltx_font_italic">perfectly</em> recovered as a function of number of bins added via an imprint block in front of a ResNet-18 on ImageNet. With only 156 bins, an attacker can expect to recover over 50% of a batch of user images perfectly. <span id="S3.F1.6.3" class="ltx_text ltx_font_bold">Right (b)</span>: Probability of a successful “one-shot” attack on a batch of 4096 images as a function of mass captured in the one-shot bin. An attacker can optimize their bin size given an expected batch size.</figcaption>
</figure>
<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S3.F2.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/standard_model_input.png" id="S3.F2.1.g1" class="ltx_graphics ltx_img_square" width="135" height="132" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S3.F2.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/standard_64_128_75_59.png" id="S3.F2.2.g1" class="ltx_graphics ltx_img_square" width="135" height="132" alt="Refer to caption">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S3.F2.9.1" class="ltx_text ltx_font_bold">Left:</span> Ground truth batch of <math id="S3.F2.5.m1.1" class="ltx_Math" alttext="64" display="inline"><semantics id="S3.F2.5.m1.1b"><mn id="S3.F2.5.m1.1.1" xref="S3.F2.5.m1.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S3.F2.5.m1.1c"><cn type="integer" id="S3.F2.5.m1.1.1.cmml" xref="S3.F2.5.m1.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.m1.1d">64</annotation></semantics></math> user images. <span id="S3.F2.10.2" class="ltx_text ltx_font_bold">Right:</span> Analytic reconstruction for an imprint model with <math id="S3.F2.6.m2.1" class="ltx_Math" alttext="128" display="inline"><semantics id="S3.F2.6.m2.1b"><mn id="S3.F2.6.m2.1.1" xref="S3.F2.6.m2.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S3.F2.6.m2.1c"><cn type="integer" id="S3.F2.6.m2.1.1.cmml" xref="S3.F2.6.m2.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.m2.1d">128</annotation></semantics></math> bins in front of a ResNet-18. Gray reconstructions denote bins in which no data point falls.)</figcaption>
</figure>
<div id="S3.SS3.p6" class="ltx_para ltx_noindent">
<p id="S3.SS3.p6.1" class="ltx_p">The imprint module as described can be inserted in any position in any neural network which receives a non-zero gradient signal. To recover the input feature dimension of the module, a second linear layer can be appended, or – if no additional parameters are of interest – the sum of the outputs of the imprint module can be added to the next layer in the network. The binning behavior of the imprint module is independent of the structure of succeeding layers as long as any gradient signal is propagated. This flexibility allows for wide trade-offs between inconspicuousness and effectiveness of the imprint module. The module can be placed in later stages of model whereas an early linear layer might be suspicious to observers (now that they have seen this trick), but depending on the data modality, early linear layers can be a feature of an architecture anyway, in which case there is even no model modification necessary, only parameter changes.
The parameter alterations necessary to trigger this vulnerability can furthermore be hidden from inspection until use. The layer can lay “dormant”, functioning and training as a normal linear layer initialized with random activations, as long as the server desires. At any point, a party with access to the server can send out parameter updates containing <math id="S3.SS3.p6.1.m1.2" class="ltx_Math" alttext="W^{*},b^{*}" display="inline"><semantics id="S3.SS3.p6.1.m1.2a"><mrow id="S3.SS3.p6.1.m1.2.2.2" xref="S3.SS3.p6.1.m1.2.2.3.cmml"><msup id="S3.SS3.p6.1.m1.1.1.1.1" xref="S3.SS3.p6.1.m1.1.1.1.1.cmml"><mi id="S3.SS3.p6.1.m1.1.1.1.1.2" xref="S3.SS3.p6.1.m1.1.1.1.1.2.cmml">W</mi><mo id="S3.SS3.p6.1.m1.1.1.1.1.3" xref="S3.SS3.p6.1.m1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.SS3.p6.1.m1.2.2.2.3" xref="S3.SS3.p6.1.m1.2.2.3.cmml">,</mo><msup id="S3.SS3.p6.1.m1.2.2.2.2" xref="S3.SS3.p6.1.m1.2.2.2.2.cmml"><mi id="S3.SS3.p6.1.m1.2.2.2.2.2" xref="S3.SS3.p6.1.m1.2.2.2.2.2.cmml">b</mi><mo id="S3.SS3.p6.1.m1.2.2.2.2.3" xref="S3.SS3.p6.1.m1.2.2.2.2.3.cmml">∗</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.2b"><list id="S3.SS3.p6.1.m1.2.2.3.cmml" xref="S3.SS3.p6.1.m1.2.2.2"><apply id="S3.SS3.p6.1.m1.1.1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p6.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.p6.1.m1.1.1.1.1.2">𝑊</ci><times id="S3.SS3.p6.1.m1.1.1.1.1.3.cmml" xref="S3.SS3.p6.1.m1.1.1.1.1.3"></times></apply><apply id="S3.SS3.p6.1.m1.2.2.2.2.cmml" xref="S3.SS3.p6.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p6.1.m1.2.2.2.2.1.cmml" xref="S3.SS3.p6.1.m1.2.2.2.2">superscript</csymbol><ci id="S3.SS3.p6.1.m1.2.2.2.2.2.cmml" xref="S3.SS3.p6.1.m1.2.2.2.2.2">𝑏</ci><times id="S3.SS3.p6.1.m1.2.2.2.2.3.cmml" xref="S3.SS3.p6.1.m1.2.2.2.2.3"></times></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.2c">W^{*},b^{*}</annotation></semantics></math> and trigger the attack.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">In the following section, we provide empirical examples of imprint modules. In all experiments we evaluate ImageNet examples to relate to previous work <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite>, but stress that the approach is entirely data agnostic. Given an aggregated gradient update, we always reconstruct as discussed in <a href="#S3" title="3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3</span></a>. When, in the case of imprecision due to noise, more candidate data points are extracted than the expected batch size, only the candidates with highest gradient mean per row in <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="W^{*}" display="inline"><semantics id="S4.p1.1.m1.1a"><msup id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml"><mi id="S4.p1.1.m1.1.1.2" xref="S4.p1.1.m1.1.1.2.cmml">W</mi><mo id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1">superscript</csymbol><ci id="S4.p1.1.m1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.2">𝑊</ci><times id="S4.p1.1.m1.1.1.3.cmml" xref="S4.p1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">W^{*}</annotation></semantics></math> are selected and the rest discarded. For analysis, we then use ground-truth information to order all data points in their original order (as much as possible) and measure PSNR scores as well as Image Identifiability Precision (IIP) scores as described in <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite>. For IIP we search for nearest-neighbors in pixel space to evaluate a model-independent distance - a more strict metric compared to IIP as used in <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite>. All computations run in single floating point precision.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Full batch recovery</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.6" class="ltx_p">We begin with a straightforward and realistic case as a selling point for our method - user gradient updates aggregated over a batch of 64 ImageNet images. We modify a ResNet-18 to include an imprint module with <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="128" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><cn type="integer" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">128</annotation></semantics></math> bins in front. This relatively vanilla setup presents is a major stumbling block for optimization based techniques. For example, for a much smaller batch size of <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><cn type="integer" id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">8</annotation></semantics></math>, the prior art in optimization based batched reconstruction achieves only <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="12.93" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mn id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">12.93</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><cn type="float" id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">12.93</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">12.93</annotation></semantics></math> average PSNR <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite>. We do of course operate in different threat models (although <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite> also uses non-obvious parameter modifications). However, our imprint method is successfully able to recover almost perfect reconstructions of a majority of user data (see <a href="#S3.F2" title="In 3.3 Imprinting User Information into Model Updates ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>), and achieves an average PSNR of <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="75.75" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mn id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">75.75</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><cn type="float" id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">75.75</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">75.75</annotation></semantics></math>. We further stress that a batch size of <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="64" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mn id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><cn type="integer" id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">64</annotation></semantics></math> is by no means a limitation of the method. If bins, and hence additional rows in <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="W^{*}" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><msup id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><mi id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml">W</mi><mo id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">superscript</csymbol><ci id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2">𝑊</ci><times id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">W^{*}</annotation></semantics></math> are added proportionally to the expected batch size, then recovery of significant proportions (see <a href="#S3.F1" title="In 3.3 Imprinting User Information into Model Updates ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>) of batches of arbitrary size – albeit with the incurred cost in additional parameters for each row – is possible. Note that concurrent work, <cite class="ltx_cite ltx_citemacro_citet">Boenisch et al. (<a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite> also proposes a method to recover user data from large-batch updates by malicious modifications - operating in the same setting/threat model as our work . However, in a direct comparison, we find that our imprint module presents a much more significant threat to privacy compared to <cite class="ltx_cite ltx_citemacro_citet">Boenisch et al. (<a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite> - see Appendix <a href="#A1.F21" title="In A.8 Comparison to Concurrent Work ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">21</span></a>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Privacy breaches in industrial-sized batches – One-shot Attacks</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.6" class="ltx_p">A breach in privacy can occur if even a <em id="S4.SS2.p1.6.1" class="ltx_emph ltx_font_italic">single</em> piece of user data is compromised. Unfortunately, there is a threatening modification of the imprint module for exactly such an attack. If a server has access to enough users, then it becomes feasible for the server to start <span id="S4.SS2.p1.6.2" class="ltx_text ltx_font_italic">fishing</span> for private data among all updates, and attempt to recover a single data point from each incoming batch of data.
Attacks of this nature require only as many additional parameters as twice the size of a single piece of targeted user data, as only <em id="S4.SS2.p1.6.3" class="ltx_emph ltx_font_italic">two</em> bins are needed. For this, <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">k</annotation></semantics></math> bins are constructed initially, and then all bins are “fused” to create <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mn id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><cn type="integer" id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">2</annotation></semantics></math> final bins: a one-shot bin containing mass <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="n/k" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">n</mi><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">/</mo><mi id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><divide id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></divide><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝑛</ci><ci id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">n/k</annotation></semantics></math>, and the other containing the remaining mass <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="(n+1)/k" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mrow id="S4.SS2.p1.4.m4.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m4.1.1.1.1.2" xref="S4.SS2.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.4.m4.1.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.1.1.1.2" xref="S4.SS2.p1.4.m4.1.1.1.1.1.2.cmml">n</mi><mo id="S4.SS2.p1.4.m4.1.1.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.cmml">+</mo><mn id="S4.SS2.p1.4.m4.1.1.1.1.1.3" xref="S4.SS2.p1.4.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS2.p1.4.m4.1.1.1.1.3" xref="S4.SS2.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">/</mo><mi id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><divide id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2"></divide><apply id="S4.SS2.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1"><plus id="S4.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1"></plus><ci id="S4.SS2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.2">𝑛</ci><cn type="integer" id="S4.SS2.p1.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.3">1</cn></apply><ci id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">(n+1)/k</annotation></semantics></math>. For perspective, for a ResNet-18 on ImageNet, this would require only an additional <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="1\%" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mn id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">1</mn><mo id="S4.SS2.p1.5.m5.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><csymbol cd="latexml" id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">1\%</annotation></semantics></math> of parameters - this is tiny compared to potentially massive increases in the number of parameters when no bins were fused, which could raise suspicion under inspection. Further, based on <a href="#Thmproposition1" title="Proposition 1. ‣ 3.3 Imprinting User Information into Model Updates ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a>, it is always possible to select an optimal bin size, so that a data point is leaked on average once every four batches of incoming data, <span id="S4.SS2.p1.6.4" class="ltx_text ltx_font_italic">no matter how large the batch size</span>.
We demonstrate this statistical property by recovering a single image from an aggregated batch of <math id="S4.SS2.p1.6.m6.2" class="ltx_Math" alttext="2^{14}=16,384" display="inline"><semantics id="S4.SS2.p1.6.m6.2a"><mrow id="S4.SS2.p1.6.m6.2.3" xref="S4.SS2.p1.6.m6.2.3.cmml"><msup id="S4.SS2.p1.6.m6.2.3.2" xref="S4.SS2.p1.6.m6.2.3.2.cmml"><mn id="S4.SS2.p1.6.m6.2.3.2.2" xref="S4.SS2.p1.6.m6.2.3.2.2.cmml">2</mn><mn id="S4.SS2.p1.6.m6.2.3.2.3" xref="S4.SS2.p1.6.m6.2.3.2.3.cmml">14</mn></msup><mo id="S4.SS2.p1.6.m6.2.3.1" xref="S4.SS2.p1.6.m6.2.3.1.cmml">=</mo><mrow id="S4.SS2.p1.6.m6.2.3.3.2" xref="S4.SS2.p1.6.m6.2.3.3.1.cmml"><mn id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">16</mn><mo id="S4.SS2.p1.6.m6.2.3.3.2.1" xref="S4.SS2.p1.6.m6.2.3.3.1.cmml">,</mo><mn id="S4.SS2.p1.6.m6.2.2" xref="S4.SS2.p1.6.m6.2.2.cmml">384</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.2b"><apply id="S4.SS2.p1.6.m6.2.3.cmml" xref="S4.SS2.p1.6.m6.2.3"><eq id="S4.SS2.p1.6.m6.2.3.1.cmml" xref="S4.SS2.p1.6.m6.2.3.1"></eq><apply id="S4.SS2.p1.6.m6.2.3.2.cmml" xref="S4.SS2.p1.6.m6.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.2.3.2.1.cmml" xref="S4.SS2.p1.6.m6.2.3.2">superscript</csymbol><cn type="integer" id="S4.SS2.p1.6.m6.2.3.2.2.cmml" xref="S4.SS2.p1.6.m6.2.3.2.2">2</cn><cn type="integer" id="S4.SS2.p1.6.m6.2.3.2.3.cmml" xref="S4.SS2.p1.6.m6.2.3.2.3">14</cn></apply><list id="S4.SS2.p1.6.m6.2.3.3.1.cmml" xref="S4.SS2.p1.6.m6.2.3.3.2"><cn type="integer" id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">16</cn><cn type="integer" id="S4.SS2.p1.6.m6.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2">384</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.2c">2^{14}=16,384</annotation></semantics></math> ImageNet images (see <a href="#S4.F3" title="In 4.2 Privacy breaches in industrial-sized batches – One-shot Attacks ‣ 4 Experiments ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>). Even though the gradient updates are averaged over a vast number of data points, there can be no perfect privacy, and one data point is leaked in its entirety by only a minor model modification.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S4.F3.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/true_minibus.png" id="S4.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="93" height="93" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S4.F3.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/recon_minibus.png" id="S4.F3.2.g1" class="ltx_graphics ltx_img_square" width="93" height="93" alt="Refer to caption">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S4.F3.8.1" class="ltx_text ltx_font_bold">Left (a)</span>: A true user image from class “minibus”. <span id="S4.F3.9.2" class="ltx_text ltx_font_bold">Right (b)</span>: The reconstructed image from class “minibus” captured via our one-shot attack from averages aggregated over <span id="S4.F3.10.3" class="ltx_text ltx_font_bold">16,384 datapoints</span>. The PSNR is <math id="S4.F3.4.m1.1" class="ltx_Math" alttext="161.36" display="inline"><semantics id="S4.F3.4.m1.1b"><mn id="S4.F3.4.m1.1.1" xref="S4.F3.4.m1.1.1.cmml">161.36</mn><annotation-xml encoding="MathML-Content" id="S4.F3.4.m1.1c"><cn type="float" id="S4.F3.4.m1.1.1.cmml" xref="S4.F3.4.m1.1.1">161.36</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.4.m1.1d">161.36</annotation></semantics></math>, i.e. a verbatim copy at machine precision. This user could potentially be identified via their recovered license plate, which was blanked out (by us!) to preserve privacy.
</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Variants</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p"><span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_bold">Flexible placement</span> The imprint module does not depend on its placement within a given model. No matter its position in a network, the incoming input features will be leaked to the server. Furthermore, the server can also change the parameters of preceding layers to represent (near)-identity mappings, allowing for the recovery of raw input data from inconspicuous positions deep in a network. For a convolutional network, we show off this variant in <a href="#A1.F14" title="In A.6 Additional Images ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">14</span></a> for a ResNet-18. Here, the model parameters are manipulated to contain identity maps up to the location of the imprint module, while the downsampling operations remain. Even these later layers leak enough information that their inputs can be upsampled to breach privacy of the inputs. We remark that we show a simplified version of this attack here where the first three channels in each layer act as an identity, and all other channels are zero, but the model can also be modified to provide off-set pixels in all other channels, effectively increasing the spatial resolution in any layer proportionally with the number of channels.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.7" class="ltx_p"><span id="S4.SS3.p2.7.1" class="ltx_text ltx_font_bold">Multiple local updates:</span> In several federated learning protocols, such as fedAVG, users take several local update steps on data before sending model updates to the server <cite class="ltx_cite ltx_citemacro_cite">Konečný et al. (<a href="#bib.bib15" title="" class="ltx_ref">2015</a>)</cite>. The imprint module is threatening when a large amount of user data is used for a <em id="S4.SS3.p2.7.2" class="ltx_emph ltx_font_italic">single</em> update step. In this case, the only variable that matters is amount of total data used in the update. That is to say, <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mn id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><cn type="integer" id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">10</annotation></semantics></math> users sending updates on <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mn id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><cn type="integer" id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">100</annotation></semantics></math> datapoints each is equivalent (recovery-wise) to a single user sending an update calculated on <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><mn id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><cn type="integer" id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">1000</annotation></semantics></math> datapoints. However, when multiple steps are taken, inverting gradients from pairwise differences (as in <a href="#S3.E4" title="In 3.3 Imprinting User Information into Model Updates ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">4</span></a>) becomes more difficult, as entries in <math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="W^{*}" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><msup id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.2" xref="S4.SS3.p2.4.m4.1.1.2.cmml">W</mi><mo id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">superscript</csymbol><ci id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2">𝑊</ci><times id="S4.SS3.p2.4.m4.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">W^{*}</annotation></semantics></math> shift with local updates. However, an imprint variant that produces sparse gradients per data point is a threat to such federated averaging. Defining a forward pass in this new variant as <math id="S4.SS3.p2.5.m5.1" class="ltx_Math" alttext="M^{\prime}(x)" display="inline"><semantics id="S4.SS3.p2.5.m5.1a"><mrow id="S4.SS3.p2.5.m5.1.2" xref="S4.SS3.p2.5.m5.1.2.cmml"><msup id="S4.SS3.p2.5.m5.1.2.2" xref="S4.SS3.p2.5.m5.1.2.2.cmml"><mi id="S4.SS3.p2.5.m5.1.2.2.2" xref="S4.SS3.p2.5.m5.1.2.2.2.cmml">M</mi><mo id="S4.SS3.p2.5.m5.1.2.2.3" xref="S4.SS3.p2.5.m5.1.2.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="S4.SS3.p2.5.m5.1.2.1" xref="S4.SS3.p2.5.m5.1.2.1.cmml">​</mo><mrow id="S4.SS3.p2.5.m5.1.2.3.2" xref="S4.SS3.p2.5.m5.1.2.cmml"><mo stretchy="false" id="S4.SS3.p2.5.m5.1.2.3.2.1" xref="S4.SS3.p2.5.m5.1.2.cmml">(</mo><mi id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS3.p2.5.m5.1.2.3.2.2" xref="S4.SS3.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><apply id="S4.SS3.p2.5.m5.1.2.cmml" xref="S4.SS3.p2.5.m5.1.2"><times id="S4.SS3.p2.5.m5.1.2.1.cmml" xref="S4.SS3.p2.5.m5.1.2.1"></times><apply id="S4.SS3.p2.5.m5.1.2.2.cmml" xref="S4.SS3.p2.5.m5.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m5.1.2.2.1.cmml" xref="S4.SS3.p2.5.m5.1.2.2">superscript</csymbol><ci id="S4.SS3.p2.5.m5.1.2.2.2.cmml" xref="S4.SS3.p2.5.m5.1.2.2.2">𝑀</ci><ci id="S4.SS3.p2.5.m5.1.2.2.3.cmml" xref="S4.SS3.p2.5.m5.1.2.2.3">′</ci></apply><ci id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">M^{\prime}(x)</annotation></semantics></math> as <math id="S4.SS3.p2.6.m6.2" class="ltx_Math" alttext="M^{\prime}(x)=g(W_{*}x+b_{*})" display="inline"><semantics id="S4.SS3.p2.6.m6.2a"><mrow id="S4.SS3.p2.6.m6.2.2" xref="S4.SS3.p2.6.m6.2.2.cmml"><mrow id="S4.SS3.p2.6.m6.2.2.3" xref="S4.SS3.p2.6.m6.2.2.3.cmml"><msup id="S4.SS3.p2.6.m6.2.2.3.2" xref="S4.SS3.p2.6.m6.2.2.3.2.cmml"><mi id="S4.SS3.p2.6.m6.2.2.3.2.2" xref="S4.SS3.p2.6.m6.2.2.3.2.2.cmml">M</mi><mo id="S4.SS3.p2.6.m6.2.2.3.2.3" xref="S4.SS3.p2.6.m6.2.2.3.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="S4.SS3.p2.6.m6.2.2.3.1" xref="S4.SS3.p2.6.m6.2.2.3.1.cmml">​</mo><mrow id="S4.SS3.p2.6.m6.2.2.3.3.2" xref="S4.SS3.p2.6.m6.2.2.3.cmml"><mo stretchy="false" id="S4.SS3.p2.6.m6.2.2.3.3.2.1" xref="S4.SS3.p2.6.m6.2.2.3.cmml">(</mo><mi id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS3.p2.6.m6.2.2.3.3.2.2" xref="S4.SS3.p2.6.m6.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p2.6.m6.2.2.2" xref="S4.SS3.p2.6.m6.2.2.2.cmml">=</mo><mrow id="S4.SS3.p2.6.m6.2.2.1" xref="S4.SS3.p2.6.m6.2.2.1.cmml"><mi id="S4.SS3.p2.6.m6.2.2.1.3" xref="S4.SS3.p2.6.m6.2.2.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.6.m6.2.2.1.2" xref="S4.SS3.p2.6.m6.2.2.1.2.cmml">​</mo><mrow id="S4.SS3.p2.6.m6.2.2.1.1.1" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p2.6.m6.2.2.1.1.1.2" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p2.6.m6.2.2.1.1.1.1" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.cmml"><mrow id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.cmml"><msub id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2.cmml"><mi id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2.2" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2.2.cmml">W</mi><mo id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2.3" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2.3.cmml">∗</mo></msub><mo lspace="0em" rspace="0em" id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.1" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.1.cmml">​</mo><mi id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.3" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.3.cmml">x</mi></mrow><mo id="S4.SS3.p2.6.m6.2.2.1.1.1.1.1" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.1.cmml">+</mo><msub id="S4.SS3.p2.6.m6.2.2.1.1.1.1.3" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.3.cmml"><mi id="S4.SS3.p2.6.m6.2.2.1.1.1.1.3.2" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.3.2.cmml">b</mi><mo id="S4.SS3.p2.6.m6.2.2.1.1.1.1.3.3" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.3.3.cmml">∗</mo></msub></mrow><mo stretchy="false" id="S4.SS3.p2.6.m6.2.2.1.1.1.3" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.2b"><apply id="S4.SS3.p2.6.m6.2.2.cmml" xref="S4.SS3.p2.6.m6.2.2"><eq id="S4.SS3.p2.6.m6.2.2.2.cmml" xref="S4.SS3.p2.6.m6.2.2.2"></eq><apply id="S4.SS3.p2.6.m6.2.2.3.cmml" xref="S4.SS3.p2.6.m6.2.2.3"><times id="S4.SS3.p2.6.m6.2.2.3.1.cmml" xref="S4.SS3.p2.6.m6.2.2.3.1"></times><apply id="S4.SS3.p2.6.m6.2.2.3.2.cmml" xref="S4.SS3.p2.6.m6.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.2.2.3.2.1.cmml" xref="S4.SS3.p2.6.m6.2.2.3.2">superscript</csymbol><ci id="S4.SS3.p2.6.m6.2.2.3.2.2.cmml" xref="S4.SS3.p2.6.m6.2.2.3.2.2">𝑀</ci><ci id="S4.SS3.p2.6.m6.2.2.3.2.3.cmml" xref="S4.SS3.p2.6.m6.2.2.3.2.3">′</ci></apply><ci id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1">𝑥</ci></apply><apply id="S4.SS3.p2.6.m6.2.2.1.cmml" xref="S4.SS3.p2.6.m6.2.2.1"><times id="S4.SS3.p2.6.m6.2.2.1.2.cmml" xref="S4.SS3.p2.6.m6.2.2.1.2"></times><ci id="S4.SS3.p2.6.m6.2.2.1.3.cmml" xref="S4.SS3.p2.6.m6.2.2.1.3">𝑔</ci><apply id="S4.SS3.p2.6.m6.2.2.1.1.1.1.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1"><plus id="S4.SS3.p2.6.m6.2.2.1.1.1.1.1.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.1"></plus><apply id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2"><times id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.1.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.1"></times><apply id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2.1.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2.2.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2.2">𝑊</ci><times id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2.3.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.2.3"></times></apply><ci id="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.3.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.2.3">𝑥</ci></apply><apply id="S4.SS3.p2.6.m6.2.2.1.1.1.1.3.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.2.2.1.1.1.1.3.1.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.6.m6.2.2.1.1.1.1.3.2.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.3.2">𝑏</ci><times id="S4.SS3.p2.6.m6.2.2.1.1.1.1.3.3.cmml" xref="S4.SS3.p2.6.m6.2.2.1.1.1.1.3.3"></times></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.2c">M^{\prime}(x)=g(W_{*}x+b_{*})</annotation></semantics></math>
where the non-linearity <math id="S4.SS3.p2.7.m7.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.SS3.p2.7.m7.1a"><mi id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.1b"><ci id="S4.SS3.p2.7.m7.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.1c">g</annotation></semantics></math> is a thresholding function:</p>
<table id="S4.Ex7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex7.m1.7" class="ltx_Math" alttext="g(t)=\begin{cases}0&amp;t\leq 0\\
t&amp;0\leq t\leq 1\\
1&amp;1\leq t\end{cases}" display="block"><semantics id="S4.Ex7.m1.7a"><mrow id="S4.Ex7.m1.7.8" xref="S4.Ex7.m1.7.8.cmml"><mrow id="S4.Ex7.m1.7.8.2" xref="S4.Ex7.m1.7.8.2.cmml"><mi id="S4.Ex7.m1.7.8.2.2" xref="S4.Ex7.m1.7.8.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.7.8.2.1" xref="S4.Ex7.m1.7.8.2.1.cmml">​</mo><mrow id="S4.Ex7.m1.7.8.2.3.2" xref="S4.Ex7.m1.7.8.2.cmml"><mo stretchy="false" id="S4.Ex7.m1.7.8.2.3.2.1" xref="S4.Ex7.m1.7.8.2.cmml">(</mo><mi id="S4.Ex7.m1.7.7" xref="S4.Ex7.m1.7.7.cmml">t</mi><mo stretchy="false" id="S4.Ex7.m1.7.8.2.3.2.2" xref="S4.Ex7.m1.7.8.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex7.m1.7.8.1" xref="S4.Ex7.m1.7.8.1.cmml">=</mo><mrow id="S4.Ex7.m1.6.6" xref="S4.Ex7.m1.7.8.3.1.cmml"><mo id="S4.Ex7.m1.6.6.7" xref="S4.Ex7.m1.7.8.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.Ex7.m1.6.6.6" xref="S4.Ex7.m1.7.8.3.1.cmml"><mtr id="S4.Ex7.m1.6.6.6a" xref="S4.Ex7.m1.7.8.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.Ex7.m1.6.6.6b" xref="S4.Ex7.m1.7.8.3.1.cmml"><mn id="S4.Ex7.m1.1.1.1.1.1.1" xref="S4.Ex7.m1.1.1.1.1.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.Ex7.m1.6.6.6c" xref="S4.Ex7.m1.7.8.3.1.cmml"><mrow id="S4.Ex7.m1.2.2.2.2.2.1" xref="S4.Ex7.m1.2.2.2.2.2.1.cmml"><mi id="S4.Ex7.m1.2.2.2.2.2.1.2" xref="S4.Ex7.m1.2.2.2.2.2.1.2.cmml">t</mi><mo id="S4.Ex7.m1.2.2.2.2.2.1.1" xref="S4.Ex7.m1.2.2.2.2.2.1.1.cmml">≤</mo><mn id="S4.Ex7.m1.2.2.2.2.2.1.3" xref="S4.Ex7.m1.2.2.2.2.2.1.3.cmml">0</mn></mrow></mtd></mtr><mtr id="S4.Ex7.m1.6.6.6d" xref="S4.Ex7.m1.7.8.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.Ex7.m1.6.6.6e" xref="S4.Ex7.m1.7.8.3.1.cmml"><mi id="S4.Ex7.m1.3.3.3.3.1.1" xref="S4.Ex7.m1.3.3.3.3.1.1.cmml">t</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.Ex7.m1.6.6.6f" xref="S4.Ex7.m1.7.8.3.1.cmml"><mrow id="S4.Ex7.m1.4.4.4.4.2.1" xref="S4.Ex7.m1.4.4.4.4.2.1.cmml"><mn id="S4.Ex7.m1.4.4.4.4.2.1.2" xref="S4.Ex7.m1.4.4.4.4.2.1.2.cmml">0</mn><mo id="S4.Ex7.m1.4.4.4.4.2.1.3" xref="S4.Ex7.m1.4.4.4.4.2.1.3.cmml">≤</mo><mi id="S4.Ex7.m1.4.4.4.4.2.1.4" xref="S4.Ex7.m1.4.4.4.4.2.1.4.cmml">t</mi><mo id="S4.Ex7.m1.4.4.4.4.2.1.5" xref="S4.Ex7.m1.4.4.4.4.2.1.5.cmml">≤</mo><mn id="S4.Ex7.m1.4.4.4.4.2.1.6" xref="S4.Ex7.m1.4.4.4.4.2.1.6.cmml">1</mn></mrow></mtd></mtr><mtr id="S4.Ex7.m1.6.6.6g" xref="S4.Ex7.m1.7.8.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.Ex7.m1.6.6.6h" xref="S4.Ex7.m1.7.8.3.1.cmml"><mn id="S4.Ex7.m1.5.5.5.5.1.1" xref="S4.Ex7.m1.5.5.5.5.1.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.Ex7.m1.6.6.6i" xref="S4.Ex7.m1.7.8.3.1.cmml"><mrow id="S4.Ex7.m1.6.6.6.6.2.1" xref="S4.Ex7.m1.6.6.6.6.2.1.cmml"><mn id="S4.Ex7.m1.6.6.6.6.2.1.2" xref="S4.Ex7.m1.6.6.6.6.2.1.2.cmml">1</mn><mo id="S4.Ex7.m1.6.6.6.6.2.1.1" xref="S4.Ex7.m1.6.6.6.6.2.1.1.cmml">≤</mo><mi id="S4.Ex7.m1.6.6.6.6.2.1.3" xref="S4.Ex7.m1.6.6.6.6.2.1.3.cmml">t</mi></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex7.m1.7b"><apply id="S4.Ex7.m1.7.8.cmml" xref="S4.Ex7.m1.7.8"><eq id="S4.Ex7.m1.7.8.1.cmml" xref="S4.Ex7.m1.7.8.1"></eq><apply id="S4.Ex7.m1.7.8.2.cmml" xref="S4.Ex7.m1.7.8.2"><times id="S4.Ex7.m1.7.8.2.1.cmml" xref="S4.Ex7.m1.7.8.2.1"></times><ci id="S4.Ex7.m1.7.8.2.2.cmml" xref="S4.Ex7.m1.7.8.2.2">𝑔</ci><ci id="S4.Ex7.m1.7.7.cmml" xref="S4.Ex7.m1.7.7">𝑡</ci></apply><apply id="S4.Ex7.m1.7.8.3.1.cmml" xref="S4.Ex7.m1.6.6"><csymbol cd="latexml" id="S4.Ex7.m1.7.8.3.1.1.cmml" xref="S4.Ex7.m1.6.6.7">cases</csymbol><cn type="integer" id="S4.Ex7.m1.1.1.1.1.1.1.cmml" xref="S4.Ex7.m1.1.1.1.1.1.1">0</cn><apply id="S4.Ex7.m1.2.2.2.2.2.1.cmml" xref="S4.Ex7.m1.2.2.2.2.2.1"><leq id="S4.Ex7.m1.2.2.2.2.2.1.1.cmml" xref="S4.Ex7.m1.2.2.2.2.2.1.1"></leq><ci id="S4.Ex7.m1.2.2.2.2.2.1.2.cmml" xref="S4.Ex7.m1.2.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S4.Ex7.m1.2.2.2.2.2.1.3.cmml" xref="S4.Ex7.m1.2.2.2.2.2.1.3">0</cn></apply><ci id="S4.Ex7.m1.3.3.3.3.1.1.cmml" xref="S4.Ex7.m1.3.3.3.3.1.1">𝑡</ci><apply id="S4.Ex7.m1.4.4.4.4.2.1.cmml" xref="S4.Ex7.m1.4.4.4.4.2.1"><and id="S4.Ex7.m1.4.4.4.4.2.1a.cmml" xref="S4.Ex7.m1.4.4.4.4.2.1"></and><apply id="S4.Ex7.m1.4.4.4.4.2.1b.cmml" xref="S4.Ex7.m1.4.4.4.4.2.1"><leq id="S4.Ex7.m1.4.4.4.4.2.1.3.cmml" xref="S4.Ex7.m1.4.4.4.4.2.1.3"></leq><cn type="integer" id="S4.Ex7.m1.4.4.4.4.2.1.2.cmml" xref="S4.Ex7.m1.4.4.4.4.2.1.2">0</cn><ci id="S4.Ex7.m1.4.4.4.4.2.1.4.cmml" xref="S4.Ex7.m1.4.4.4.4.2.1.4">𝑡</ci></apply><apply id="S4.Ex7.m1.4.4.4.4.2.1c.cmml" xref="S4.Ex7.m1.4.4.4.4.2.1"><leq id="S4.Ex7.m1.4.4.4.4.2.1.5.cmml" xref="S4.Ex7.m1.4.4.4.4.2.1.5"></leq><share href="#S4.Ex7.m1.4.4.4.4.2.1.4.cmml" id="S4.Ex7.m1.4.4.4.4.2.1d.cmml" xref="S4.Ex7.m1.4.4.4.4.2.1"></share><cn type="integer" id="S4.Ex7.m1.4.4.4.4.2.1.6.cmml" xref="S4.Ex7.m1.4.4.4.4.2.1.6">1</cn></apply></apply><cn type="integer" id="S4.Ex7.m1.5.5.5.5.1.1.cmml" xref="S4.Ex7.m1.5.5.5.5.1.1">1</cn><apply id="S4.Ex7.m1.6.6.6.6.2.1.cmml" xref="S4.Ex7.m1.6.6.6.6.2.1"><leq id="S4.Ex7.m1.6.6.6.6.2.1.1.cmml" xref="S4.Ex7.m1.6.6.6.6.2.1.1"></leq><cn type="integer" id="S4.Ex7.m1.6.6.6.6.2.1.2.cmml" xref="S4.Ex7.m1.6.6.6.6.2.1.2">1</cn><ci id="S4.Ex7.m1.6.6.6.6.2.1.3.cmml" xref="S4.Ex7.m1.6.6.6.6.2.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex7.m1.7c">g(t)=\begin{cases}0&amp;t\leq 0\\
t&amp;0\leq t\leq 1\\
1&amp;1\leq t\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.10" class="ltx_p">Note this non-linearity can be simply constructed with a combination of two ReLUs, or with an implementation of a Hardtanh. We now define <math id="S4.SS3.p2.8.m1.1" class="ltx_Math" alttext="W_{*}^{i}" display="inline"><semantics id="S4.SS3.p2.8.m1.1a"><msubsup id="S4.SS3.p2.8.m1.1.1" xref="S4.SS3.p2.8.m1.1.1.cmml"><mi id="S4.SS3.p2.8.m1.1.1.2.2" xref="S4.SS3.p2.8.m1.1.1.2.2.cmml">W</mi><mo id="S4.SS3.p2.8.m1.1.1.2.3" xref="S4.SS3.p2.8.m1.1.1.2.3.cmml">∗</mo><mi id="S4.SS3.p2.8.m1.1.1.3" xref="S4.SS3.p2.8.m1.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m1.1b"><apply id="S4.SS3.p2.8.m1.1.1.cmml" xref="S4.SS3.p2.8.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m1.1.1.1.cmml" xref="S4.SS3.p2.8.m1.1.1">superscript</csymbol><apply id="S4.SS3.p2.8.m1.1.1.2.cmml" xref="S4.SS3.p2.8.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m1.1.1.2.1.cmml" xref="S4.SS3.p2.8.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.8.m1.1.1.2.2.cmml" xref="S4.SS3.p2.8.m1.1.1.2.2">𝑊</ci><times id="S4.SS3.p2.8.m1.1.1.2.3.cmml" xref="S4.SS3.p2.8.m1.1.1.2.3"></times></apply><ci id="S4.SS3.p2.8.m1.1.1.3.cmml" xref="S4.SS3.p2.8.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m1.1c">W_{*}^{i}</annotation></semantics></math> as:
<math id="S4.SS3.p2.9.m2.3" class="ltx_Math" alttext="\langle W_{*}^{i},x\rangle=\frac{h(x)}{\delta_{i}}" display="inline"><semantics id="S4.SS3.p2.9.m2.3a"><mrow id="S4.SS3.p2.9.m2.3.3" xref="S4.SS3.p2.9.m2.3.3.cmml"><mrow id="S4.SS3.p2.9.m2.3.3.1.1" xref="S4.SS3.p2.9.m2.3.3.1.2.cmml"><mo stretchy="false" id="S4.SS3.p2.9.m2.3.3.1.1.2" xref="S4.SS3.p2.9.m2.3.3.1.2.cmml">⟨</mo><msubsup id="S4.SS3.p2.9.m2.3.3.1.1.1" xref="S4.SS3.p2.9.m2.3.3.1.1.1.cmml"><mi id="S4.SS3.p2.9.m2.3.3.1.1.1.2.2" xref="S4.SS3.p2.9.m2.3.3.1.1.1.2.2.cmml">W</mi><mo id="S4.SS3.p2.9.m2.3.3.1.1.1.2.3" xref="S4.SS3.p2.9.m2.3.3.1.1.1.2.3.cmml">∗</mo><mi id="S4.SS3.p2.9.m2.3.3.1.1.1.3" xref="S4.SS3.p2.9.m2.3.3.1.1.1.3.cmml">i</mi></msubsup><mo id="S4.SS3.p2.9.m2.3.3.1.1.3" xref="S4.SS3.p2.9.m2.3.3.1.2.cmml">,</mo><mi id="S4.SS3.p2.9.m2.2.2" xref="S4.SS3.p2.9.m2.2.2.cmml">x</mi><mo stretchy="false" id="S4.SS3.p2.9.m2.3.3.1.1.4" xref="S4.SS3.p2.9.m2.3.3.1.2.cmml">⟩</mo></mrow><mo id="S4.SS3.p2.9.m2.3.3.2" xref="S4.SS3.p2.9.m2.3.3.2.cmml">=</mo><mfrac id="S4.SS3.p2.9.m2.1.1" xref="S4.SS3.p2.9.m2.1.1.cmml"><mrow id="S4.SS3.p2.9.m2.1.1.1" xref="S4.SS3.p2.9.m2.1.1.1.cmml"><mi id="S4.SS3.p2.9.m2.1.1.1.3" xref="S4.SS3.p2.9.m2.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.9.m2.1.1.1.2" xref="S4.SS3.p2.9.m2.1.1.1.2.cmml">​</mo><mrow id="S4.SS3.p2.9.m2.1.1.1.4.2" xref="S4.SS3.p2.9.m2.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p2.9.m2.1.1.1.4.2.1" xref="S4.SS3.p2.9.m2.1.1.1.cmml">(</mo><mi id="S4.SS3.p2.9.m2.1.1.1.1" xref="S4.SS3.p2.9.m2.1.1.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS3.p2.9.m2.1.1.1.4.2.2" xref="S4.SS3.p2.9.m2.1.1.1.cmml">)</mo></mrow></mrow><msub id="S4.SS3.p2.9.m2.1.1.3" xref="S4.SS3.p2.9.m2.1.1.3.cmml"><mi id="S4.SS3.p2.9.m2.1.1.3.2" xref="S4.SS3.p2.9.m2.1.1.3.2.cmml">δ</mi><mi id="S4.SS3.p2.9.m2.1.1.3.3" xref="S4.SS3.p2.9.m2.1.1.3.3.cmml">i</mi></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.9.m2.3b"><apply id="S4.SS3.p2.9.m2.3.3.cmml" xref="S4.SS3.p2.9.m2.3.3"><eq id="S4.SS3.p2.9.m2.3.3.2.cmml" xref="S4.SS3.p2.9.m2.3.3.2"></eq><list id="S4.SS3.p2.9.m2.3.3.1.2.cmml" xref="S4.SS3.p2.9.m2.3.3.1.1"><apply id="S4.SS3.p2.9.m2.3.3.1.1.1.cmml" xref="S4.SS3.p2.9.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m2.3.3.1.1.1.1.cmml" xref="S4.SS3.p2.9.m2.3.3.1.1.1">superscript</csymbol><apply id="S4.SS3.p2.9.m2.3.3.1.1.1.2.cmml" xref="S4.SS3.p2.9.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m2.3.3.1.1.1.2.1.cmml" xref="S4.SS3.p2.9.m2.3.3.1.1.1">subscript</csymbol><ci id="S4.SS3.p2.9.m2.3.3.1.1.1.2.2.cmml" xref="S4.SS3.p2.9.m2.3.3.1.1.1.2.2">𝑊</ci><times id="S4.SS3.p2.9.m2.3.3.1.1.1.2.3.cmml" xref="S4.SS3.p2.9.m2.3.3.1.1.1.2.3"></times></apply><ci id="S4.SS3.p2.9.m2.3.3.1.1.1.3.cmml" xref="S4.SS3.p2.9.m2.3.3.1.1.1.3">𝑖</ci></apply><ci id="S4.SS3.p2.9.m2.2.2.cmml" xref="S4.SS3.p2.9.m2.2.2">𝑥</ci></list><apply id="S4.SS3.p2.9.m2.1.1.cmml" xref="S4.SS3.p2.9.m2.1.1"><divide id="S4.SS3.p2.9.m2.1.1.2.cmml" xref="S4.SS3.p2.9.m2.1.1"></divide><apply id="S4.SS3.p2.9.m2.1.1.1.cmml" xref="S4.SS3.p2.9.m2.1.1.1"><times id="S4.SS3.p2.9.m2.1.1.1.2.cmml" xref="S4.SS3.p2.9.m2.1.1.1.2"></times><ci id="S4.SS3.p2.9.m2.1.1.1.3.cmml" xref="S4.SS3.p2.9.m2.1.1.1.3">ℎ</ci><ci id="S4.SS3.p2.9.m2.1.1.1.1.cmml" xref="S4.SS3.p2.9.m2.1.1.1.1">𝑥</ci></apply><apply id="S4.SS3.p2.9.m2.1.1.3.cmml" xref="S4.SS3.p2.9.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m2.1.1.3.1.cmml" xref="S4.SS3.p2.9.m2.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.9.m2.1.1.3.2.cmml" xref="S4.SS3.p2.9.m2.1.1.3.2">𝛿</ci><ci id="S4.SS3.p2.9.m2.1.1.3.3.cmml" xref="S4.SS3.p2.9.m2.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.9.m2.3c">\langle W_{*}^{i},x\rangle=\frac{h(x)}{\delta_{i}}</annotation></semantics></math>
where <math id="S4.SS3.p2.10.m3.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S4.SS3.p2.10.m3.1a"><mi id="S4.SS3.p2.10.m3.1.1" xref="S4.SS3.p2.10.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.10.m3.1b"><ci id="S4.SS3.p2.10.m3.1.1.cmml" xref="S4.SS3.p2.10.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.10.m3.1c">h</annotation></semantics></math> is the a linear function of the data as described before, and the biases are defined as:</p>
<table id="S4.Ex8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex8.m1.4" class="ltx_Math" alttext="b_{*}^{i}=-\frac{c_{i}}{\delta_{i}}\quad\text{where}\quad\delta_{i}=\Phi^{-1}(\frac{i+1}{k})-\Phi^{-1}(\frac{i}{k})." display="block"><semantics id="S4.Ex8.m1.4a"><mrow id="S4.Ex8.m1.4.4.1"><mrow id="S4.Ex8.m1.4.4.1.1.2" xref="S4.Ex8.m1.4.4.1.1.3.cmml"><mrow id="S4.Ex8.m1.4.4.1.1.1.1" xref="S4.Ex8.m1.4.4.1.1.1.1.cmml"><msubsup id="S4.Ex8.m1.4.4.1.1.1.1.3" xref="S4.Ex8.m1.4.4.1.1.1.1.3.cmml"><mi id="S4.Ex8.m1.4.4.1.1.1.1.3.2.2" xref="S4.Ex8.m1.4.4.1.1.1.1.3.2.2.cmml">b</mi><mo id="S4.Ex8.m1.4.4.1.1.1.1.3.2.3" xref="S4.Ex8.m1.4.4.1.1.1.1.3.2.3.cmml">∗</mo><mi id="S4.Ex8.m1.4.4.1.1.1.1.3.3" xref="S4.Ex8.m1.4.4.1.1.1.1.3.3.cmml">i</mi></msubsup><mo id="S4.Ex8.m1.4.4.1.1.1.1.2" xref="S4.Ex8.m1.4.4.1.1.1.1.2.cmml">=</mo><mrow id="S4.Ex8.m1.4.4.1.1.1.1.1.1" xref="S4.Ex8.m1.4.4.1.1.1.1.1.2.cmml"><mrow id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1a" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.cmml"><msub id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.2" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.3" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><msub id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.2" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml">δ</mi><mi id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.3" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mfrac></mrow><mspace width="1em" id="S4.Ex8.m1.4.4.1.1.1.1.1.1.2" xref="S4.Ex8.m1.4.4.1.1.1.1.1.2.cmml"></mspace><mtext id="S4.Ex8.m1.3.3" xref="S4.Ex8.m1.3.3a.cmml">where</mtext></mrow></mrow><mspace width="1em" id="S4.Ex8.m1.4.4.1.1.2.3" xref="S4.Ex8.m1.4.4.1.1.3a.cmml"></mspace><mrow id="S4.Ex8.m1.4.4.1.1.2.2" xref="S4.Ex8.m1.4.4.1.1.2.2.cmml"><msub id="S4.Ex8.m1.4.4.1.1.2.2.2" xref="S4.Ex8.m1.4.4.1.1.2.2.2.cmml"><mi id="S4.Ex8.m1.4.4.1.1.2.2.2.2" xref="S4.Ex8.m1.4.4.1.1.2.2.2.2.cmml">δ</mi><mi id="S4.Ex8.m1.4.4.1.1.2.2.2.3" xref="S4.Ex8.m1.4.4.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S4.Ex8.m1.4.4.1.1.2.2.1" xref="S4.Ex8.m1.4.4.1.1.2.2.1.cmml">=</mo><mrow id="S4.Ex8.m1.4.4.1.1.2.2.3" xref="S4.Ex8.m1.4.4.1.1.2.2.3.cmml"><mrow id="S4.Ex8.m1.4.4.1.1.2.2.3.2" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.cmml"><msup id="S4.Ex8.m1.4.4.1.1.2.2.3.2.2" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.cmml"><mi mathvariant="normal" id="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.2" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.2.cmml">Φ</mi><mrow id="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.3" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.3.cmml"><mo id="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.3a" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.3.cmml">−</mo><mn id="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.3.2" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S4.Ex8.m1.4.4.1.1.2.2.3.2.1" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.1.cmml">​</mo><mrow id="S4.Ex8.m1.4.4.1.1.2.2.3.2.3.2" xref="S4.Ex8.m1.1.1.cmml"><mo stretchy="false" id="S4.Ex8.m1.4.4.1.1.2.2.3.2.3.2.1" xref="S4.Ex8.m1.1.1.cmml">(</mo><mfrac id="S4.Ex8.m1.1.1" xref="S4.Ex8.m1.1.1.cmml"><mrow id="S4.Ex8.m1.1.1.2" xref="S4.Ex8.m1.1.1.2.cmml"><mi id="S4.Ex8.m1.1.1.2.2" xref="S4.Ex8.m1.1.1.2.2.cmml">i</mi><mo id="S4.Ex8.m1.1.1.2.1" xref="S4.Ex8.m1.1.1.2.1.cmml">+</mo><mn id="S4.Ex8.m1.1.1.2.3" xref="S4.Ex8.m1.1.1.2.3.cmml">1</mn></mrow><mi id="S4.Ex8.m1.1.1.3" xref="S4.Ex8.m1.1.1.3.cmml">k</mi></mfrac><mo stretchy="false" id="S4.Ex8.m1.4.4.1.1.2.2.3.2.3.2.2" xref="S4.Ex8.m1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex8.m1.4.4.1.1.2.2.3.1" xref="S4.Ex8.m1.4.4.1.1.2.2.3.1.cmml">−</mo><mrow id="S4.Ex8.m1.4.4.1.1.2.2.3.3" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.cmml"><msup id="S4.Ex8.m1.4.4.1.1.2.2.3.3.2" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.cmml"><mi mathvariant="normal" id="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.2" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.2.cmml">Φ</mi><mrow id="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.3" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.3.cmml"><mo id="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.3a" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.3.cmml">−</mo><mn id="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.3.2" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S4.Ex8.m1.4.4.1.1.2.2.3.3.1" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.1.cmml">​</mo><mrow id="S4.Ex8.m1.4.4.1.1.2.2.3.3.3.2" xref="S4.Ex8.m1.2.2.cmml"><mo stretchy="false" id="S4.Ex8.m1.4.4.1.1.2.2.3.3.3.2.1" xref="S4.Ex8.m1.2.2.cmml">(</mo><mfrac id="S4.Ex8.m1.2.2" xref="S4.Ex8.m1.2.2.cmml"><mi id="S4.Ex8.m1.2.2.2" xref="S4.Ex8.m1.2.2.2.cmml">i</mi><mi id="S4.Ex8.m1.2.2.3" xref="S4.Ex8.m1.2.2.3.cmml">k</mi></mfrac><mo stretchy="false" id="S4.Ex8.m1.4.4.1.1.2.2.3.3.3.2.2" xref="S4.Ex8.m1.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.Ex8.m1.4.4.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex8.m1.4b"><apply id="S4.Ex8.m1.4.4.1.1.3.cmml" xref="S4.Ex8.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S4.Ex8.m1.4.4.1.1.3a.cmml" xref="S4.Ex8.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S4.Ex8.m1.4.4.1.1.1.1.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1"><eq id="S4.Ex8.m1.4.4.1.1.1.1.2.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.2"></eq><apply id="S4.Ex8.m1.4.4.1.1.1.1.3.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex8.m1.4.4.1.1.1.1.3.1.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.3">superscript</csymbol><apply id="S4.Ex8.m1.4.4.1.1.1.1.3.2.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex8.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex8.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.3.2.2">𝑏</ci><times id="S4.Ex8.m1.4.4.1.1.1.1.3.2.3.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.3.2.3"></times></apply><ci id="S4.Ex8.m1.4.4.1.1.1.1.3.3.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.3.3">𝑖</ci></apply><list id="S4.Ex8.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1"><apply id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1"><minus id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1"></minus><apply id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2"><divide id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2"></divide><apply id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.2">𝑐</ci><ci id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.2">𝛿</ci><ci id="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.Ex8.m1.4.4.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply></apply><ci id="S4.Ex8.m1.3.3a.cmml" xref="S4.Ex8.m1.3.3"><mtext id="S4.Ex8.m1.3.3.cmml" xref="S4.Ex8.m1.3.3">where</mtext></ci></list></apply><apply id="S4.Ex8.m1.4.4.1.1.2.2.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2"><eq id="S4.Ex8.m1.4.4.1.1.2.2.1.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.1"></eq><apply id="S4.Ex8.m1.4.4.1.1.2.2.2.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.Ex8.m1.4.4.1.1.2.2.2.1.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.2">subscript</csymbol><ci id="S4.Ex8.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.2.2">𝛿</ci><ci id="S4.Ex8.m1.4.4.1.1.2.2.2.3.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.2.3">𝑖</ci></apply><apply id="S4.Ex8.m1.4.4.1.1.2.2.3.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3"><minus id="S4.Ex8.m1.4.4.1.1.2.2.3.1.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.1"></minus><apply id="S4.Ex8.m1.4.4.1.1.2.2.3.2.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2"><times id="S4.Ex8.m1.4.4.1.1.2.2.3.2.1.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.1"></times><apply id="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.1.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.2">superscript</csymbol><ci id="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.2.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.2">Φ</ci><apply id="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.3.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.3"><minus id="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.3.1.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.3"></minus><cn type="integer" id="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.3.2.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.2.3.2">1</cn></apply></apply><apply id="S4.Ex8.m1.1.1.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.3.2"><divide id="S4.Ex8.m1.1.1.1.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.2.3.2"></divide><apply id="S4.Ex8.m1.1.1.2.cmml" xref="S4.Ex8.m1.1.1.2"><plus id="S4.Ex8.m1.1.1.2.1.cmml" xref="S4.Ex8.m1.1.1.2.1"></plus><ci id="S4.Ex8.m1.1.1.2.2.cmml" xref="S4.Ex8.m1.1.1.2.2">𝑖</ci><cn type="integer" id="S4.Ex8.m1.1.1.2.3.cmml" xref="S4.Ex8.m1.1.1.2.3">1</cn></apply><ci id="S4.Ex8.m1.1.1.3.cmml" xref="S4.Ex8.m1.1.1.3">𝑘</ci></apply></apply><apply id="S4.Ex8.m1.4.4.1.1.2.2.3.3.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3"><times id="S4.Ex8.m1.4.4.1.1.2.2.3.3.1.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.1"></times><apply id="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.1.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.2">superscript</csymbol><ci id="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.2.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.2">Φ</ci><apply id="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.3.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.3"><minus id="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.3.1.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.3"></minus><cn type="integer" id="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.3.2.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.2.3.2">1</cn></apply></apply><apply id="S4.Ex8.m1.2.2.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.3.2"><divide id="S4.Ex8.m1.2.2.1.cmml" xref="S4.Ex8.m1.4.4.1.1.2.2.3.3.3.2"></divide><ci id="S4.Ex8.m1.2.2.2.cmml" xref="S4.Ex8.m1.2.2.2">𝑖</ci><ci id="S4.Ex8.m1.2.2.3.cmml" xref="S4.Ex8.m1.2.2.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex8.m1.4c">b_{*}^{i}=-\frac{c_{i}}{\delta_{i}}\quad\text{where}\quad\delta_{i}=\Phi^{-1}(\frac{i+1}{k})-\Phi^{-1}(\frac{i}{k}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.4" class="ltx_p">This setup creates sparse bins where inversion is directly possible (without taking pairwise differences) in gradient entries, at the cost of an additional activation layer. Analyzing a local update step with <math id="S4.SS3.p3.1.m1.2" class="ltx_Math" alttext="W_{*}^{i,j}" display="inline"><semantics id="S4.SS3.p3.1.m1.2a"><msubsup id="S4.SS3.p3.1.m1.2.3" xref="S4.SS3.p3.1.m1.2.3.cmml"><mi id="S4.SS3.p3.1.m1.2.3.2.2" xref="S4.SS3.p3.1.m1.2.3.2.2.cmml">W</mi><mo id="S4.SS3.p3.1.m1.2.3.2.3" xref="S4.SS3.p3.1.m1.2.3.2.3.cmml">∗</mo><mrow id="S4.SS3.p3.1.m1.2.2.2.4" xref="S4.SS3.p3.1.m1.2.2.2.3.cmml"><mi id="S4.SS3.p3.1.m1.1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p3.1.m1.2.2.2.4.1" xref="S4.SS3.p3.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p3.1.m1.2.2.2.2" xref="S4.SS3.p3.1.m1.2.2.2.2.cmml">j</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.2b"><apply id="S4.SS3.p3.1.m1.2.3.cmml" xref="S4.SS3.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.2.3.1.cmml" xref="S4.SS3.p3.1.m1.2.3">superscript</csymbol><apply id="S4.SS3.p3.1.m1.2.3.2.cmml" xref="S4.SS3.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.2.3.2.1.cmml" xref="S4.SS3.p3.1.m1.2.3">subscript</csymbol><ci id="S4.SS3.p3.1.m1.2.3.2.2.cmml" xref="S4.SS3.p3.1.m1.2.3.2.2">𝑊</ci><times id="S4.SS3.p3.1.m1.2.3.2.3.cmml" xref="S4.SS3.p3.1.m1.2.3.2.3"></times></apply><list id="S4.SS3.p3.1.m1.2.2.2.3.cmml" xref="S4.SS3.p3.1.m1.2.2.2.4"><ci id="S4.SS3.p3.1.m1.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS3.p3.1.m1.2.2.2.2.cmml" xref="S4.SS3.p3.1.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.2c">W_{*}^{i,j}</annotation></semantics></math> as the <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><msup id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">i</mi><mrow id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.3.2" xref="S4.SS3.p3.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.2.m2.1.1.3.1" xref="S4.SS3.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p3.2.m2.1.1.3.3" xref="S4.SS3.p3.2.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">𝑖</ci><apply id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3"><times id="S4.SS3.p3.2.m2.1.1.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3.1"></times><ci id="S4.SS3.p3.2.m2.1.1.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2">𝑡</ci><ci id="S4.SS3.p3.2.m2.1.1.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">i^{th}</annotation></semantics></math> row of <math id="S4.SS3.p3.3.m3.1" class="ltx_Math" alttext="W_{*}" display="inline"><semantics id="S4.SS3.p3.3.m3.1a"><msub id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml"><mi id="S4.SS3.p3.3.m3.1.1.2" xref="S4.SS3.p3.3.m3.1.1.2.cmml">W</mi><mo id="S4.SS3.p3.3.m3.1.1.3" xref="S4.SS3.p3.3.m3.1.1.3.cmml">∗</mo></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p3.3.m3.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.2">𝑊</ci><times id="S4.SS3.p3.3.m3.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">W_{*}</annotation></semantics></math> at update step <math id="S4.SS3.p3.4.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS3.p3.4.m4.1a"><mi id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><ci id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">j</annotation></semantics></math>, reveals that</p>
<table id="S4.Ex9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex9.m1.6" class="ltx_Math" alttext="W_{*}^{i,j}=W_{*}^{i,j-1}-\alpha\frac{\partial\mathcal{L}}{\partial a^{i,j}}x_{j}" display="block"><semantics id="S4.Ex9.m1.6a"><mrow id="S4.Ex9.m1.6.7" xref="S4.Ex9.m1.6.7.cmml"><msubsup id="S4.Ex9.m1.6.7.2" xref="S4.Ex9.m1.6.7.2.cmml"><mi id="S4.Ex9.m1.6.7.2.2.2" xref="S4.Ex9.m1.6.7.2.2.2.cmml">W</mi><mo id="S4.Ex9.m1.6.7.2.2.3" xref="S4.Ex9.m1.6.7.2.2.3.cmml">∗</mo><mrow id="S4.Ex9.m1.2.2.2.4" xref="S4.Ex9.m1.2.2.2.3.cmml"><mi id="S4.Ex9.m1.1.1.1.1" xref="S4.Ex9.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex9.m1.2.2.2.4.1" xref="S4.Ex9.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex9.m1.2.2.2.2" xref="S4.Ex9.m1.2.2.2.2.cmml">j</mi></mrow></msubsup><mo id="S4.Ex9.m1.6.7.1" xref="S4.Ex9.m1.6.7.1.cmml">=</mo><mrow id="S4.Ex9.m1.6.7.3" xref="S4.Ex9.m1.6.7.3.cmml"><msubsup id="S4.Ex9.m1.6.7.3.2" xref="S4.Ex9.m1.6.7.3.2.cmml"><mi id="S4.Ex9.m1.6.7.3.2.2.2" xref="S4.Ex9.m1.6.7.3.2.2.2.cmml">W</mi><mo id="S4.Ex9.m1.6.7.3.2.2.3" xref="S4.Ex9.m1.6.7.3.2.2.3.cmml">∗</mo><mrow id="S4.Ex9.m1.4.4.2.2" xref="S4.Ex9.m1.4.4.2.3.cmml"><mi id="S4.Ex9.m1.3.3.1.1" xref="S4.Ex9.m1.3.3.1.1.cmml">i</mi><mo id="S4.Ex9.m1.4.4.2.2.2" xref="S4.Ex9.m1.4.4.2.3.cmml">,</mo><mrow id="S4.Ex9.m1.4.4.2.2.1" xref="S4.Ex9.m1.4.4.2.2.1.cmml"><mi id="S4.Ex9.m1.4.4.2.2.1.2" xref="S4.Ex9.m1.4.4.2.2.1.2.cmml">j</mi><mo id="S4.Ex9.m1.4.4.2.2.1.1" xref="S4.Ex9.m1.4.4.2.2.1.1.cmml">−</mo><mn id="S4.Ex9.m1.4.4.2.2.1.3" xref="S4.Ex9.m1.4.4.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><mo id="S4.Ex9.m1.6.7.3.1" xref="S4.Ex9.m1.6.7.3.1.cmml">−</mo><mrow id="S4.Ex9.m1.6.7.3.3" xref="S4.Ex9.m1.6.7.3.3.cmml"><mi id="S4.Ex9.m1.6.7.3.3.2" xref="S4.Ex9.m1.6.7.3.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S4.Ex9.m1.6.7.3.3.1" xref="S4.Ex9.m1.6.7.3.3.1.cmml">​</mo><mfrac id="S4.Ex9.m1.6.6" xref="S4.Ex9.m1.6.6.cmml"><mrow id="S4.Ex9.m1.6.6.4" xref="S4.Ex9.m1.6.6.4.cmml"><mo rspace="0em" id="S4.Ex9.m1.6.6.4.1" xref="S4.Ex9.m1.6.6.4.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex9.m1.6.6.4.2" xref="S4.Ex9.m1.6.6.4.2.cmml">ℒ</mi></mrow><mrow id="S4.Ex9.m1.6.6.2" xref="S4.Ex9.m1.6.6.2.cmml"><mo rspace="0em" id="S4.Ex9.m1.6.6.2.3" xref="S4.Ex9.m1.6.6.2.3.cmml">∂</mo><msup id="S4.Ex9.m1.6.6.2.4" xref="S4.Ex9.m1.6.6.2.4.cmml"><mi id="S4.Ex9.m1.6.6.2.4.2" xref="S4.Ex9.m1.6.6.2.4.2.cmml">a</mi><mrow id="S4.Ex9.m1.6.6.2.2.2.4" xref="S4.Ex9.m1.6.6.2.2.2.3.cmml"><mi id="S4.Ex9.m1.5.5.1.1.1.1" xref="S4.Ex9.m1.5.5.1.1.1.1.cmml">i</mi><mo id="S4.Ex9.m1.6.6.2.2.2.4.1" xref="S4.Ex9.m1.6.6.2.2.2.3.cmml">,</mo><mi id="S4.Ex9.m1.6.6.2.2.2.2" xref="S4.Ex9.m1.6.6.2.2.2.2.cmml">j</mi></mrow></msup></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.Ex9.m1.6.7.3.3.1a" xref="S4.Ex9.m1.6.7.3.3.1.cmml">​</mo><msub id="S4.Ex9.m1.6.7.3.3.3" xref="S4.Ex9.m1.6.7.3.3.3.cmml"><mi id="S4.Ex9.m1.6.7.3.3.3.2" xref="S4.Ex9.m1.6.7.3.3.3.2.cmml">x</mi><mi id="S4.Ex9.m1.6.7.3.3.3.3" xref="S4.Ex9.m1.6.7.3.3.3.3.cmml">j</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex9.m1.6b"><apply id="S4.Ex9.m1.6.7.cmml" xref="S4.Ex9.m1.6.7"><eq id="S4.Ex9.m1.6.7.1.cmml" xref="S4.Ex9.m1.6.7.1"></eq><apply id="S4.Ex9.m1.6.7.2.cmml" xref="S4.Ex9.m1.6.7.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.6.7.2.1.cmml" xref="S4.Ex9.m1.6.7.2">superscript</csymbol><apply id="S4.Ex9.m1.6.7.2.2.cmml" xref="S4.Ex9.m1.6.7.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.6.7.2.2.1.cmml" xref="S4.Ex9.m1.6.7.2">subscript</csymbol><ci id="S4.Ex9.m1.6.7.2.2.2.cmml" xref="S4.Ex9.m1.6.7.2.2.2">𝑊</ci><times id="S4.Ex9.m1.6.7.2.2.3.cmml" xref="S4.Ex9.m1.6.7.2.2.3"></times></apply><list id="S4.Ex9.m1.2.2.2.3.cmml" xref="S4.Ex9.m1.2.2.2.4"><ci id="S4.Ex9.m1.1.1.1.1.cmml" xref="S4.Ex9.m1.1.1.1.1">𝑖</ci><ci id="S4.Ex9.m1.2.2.2.2.cmml" xref="S4.Ex9.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S4.Ex9.m1.6.7.3.cmml" xref="S4.Ex9.m1.6.7.3"><minus id="S4.Ex9.m1.6.7.3.1.cmml" xref="S4.Ex9.m1.6.7.3.1"></minus><apply id="S4.Ex9.m1.6.7.3.2.cmml" xref="S4.Ex9.m1.6.7.3.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.6.7.3.2.1.cmml" xref="S4.Ex9.m1.6.7.3.2">superscript</csymbol><apply id="S4.Ex9.m1.6.7.3.2.2.cmml" xref="S4.Ex9.m1.6.7.3.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.6.7.3.2.2.1.cmml" xref="S4.Ex9.m1.6.7.3.2">subscript</csymbol><ci id="S4.Ex9.m1.6.7.3.2.2.2.cmml" xref="S4.Ex9.m1.6.7.3.2.2.2">𝑊</ci><times id="S4.Ex9.m1.6.7.3.2.2.3.cmml" xref="S4.Ex9.m1.6.7.3.2.2.3"></times></apply><list id="S4.Ex9.m1.4.4.2.3.cmml" xref="S4.Ex9.m1.4.4.2.2"><ci id="S4.Ex9.m1.3.3.1.1.cmml" xref="S4.Ex9.m1.3.3.1.1">𝑖</ci><apply id="S4.Ex9.m1.4.4.2.2.1.cmml" xref="S4.Ex9.m1.4.4.2.2.1"><minus id="S4.Ex9.m1.4.4.2.2.1.1.cmml" xref="S4.Ex9.m1.4.4.2.2.1.1"></minus><ci id="S4.Ex9.m1.4.4.2.2.1.2.cmml" xref="S4.Ex9.m1.4.4.2.2.1.2">𝑗</ci><cn type="integer" id="S4.Ex9.m1.4.4.2.2.1.3.cmml" xref="S4.Ex9.m1.4.4.2.2.1.3">1</cn></apply></list></apply><apply id="S4.Ex9.m1.6.7.3.3.cmml" xref="S4.Ex9.m1.6.7.3.3"><times id="S4.Ex9.m1.6.7.3.3.1.cmml" xref="S4.Ex9.m1.6.7.3.3.1"></times><ci id="S4.Ex9.m1.6.7.3.3.2.cmml" xref="S4.Ex9.m1.6.7.3.3.2">𝛼</ci><apply id="S4.Ex9.m1.6.6.cmml" xref="S4.Ex9.m1.6.6"><divide id="S4.Ex9.m1.6.6.3.cmml" xref="S4.Ex9.m1.6.6"></divide><apply id="S4.Ex9.m1.6.6.4.cmml" xref="S4.Ex9.m1.6.6.4"><partialdiff id="S4.Ex9.m1.6.6.4.1.cmml" xref="S4.Ex9.m1.6.6.4.1"></partialdiff><ci id="S4.Ex9.m1.6.6.4.2.cmml" xref="S4.Ex9.m1.6.6.4.2">ℒ</ci></apply><apply id="S4.Ex9.m1.6.6.2.cmml" xref="S4.Ex9.m1.6.6.2"><partialdiff id="S4.Ex9.m1.6.6.2.3.cmml" xref="S4.Ex9.m1.6.6.2.3"></partialdiff><apply id="S4.Ex9.m1.6.6.2.4.cmml" xref="S4.Ex9.m1.6.6.2.4"><csymbol cd="ambiguous" id="S4.Ex9.m1.6.6.2.4.1.cmml" xref="S4.Ex9.m1.6.6.2.4">superscript</csymbol><ci id="S4.Ex9.m1.6.6.2.4.2.cmml" xref="S4.Ex9.m1.6.6.2.4.2">𝑎</ci><list id="S4.Ex9.m1.6.6.2.2.2.3.cmml" xref="S4.Ex9.m1.6.6.2.2.2.4"><ci id="S4.Ex9.m1.5.5.1.1.1.1.cmml" xref="S4.Ex9.m1.5.5.1.1.1.1">𝑖</ci><ci id="S4.Ex9.m1.6.6.2.2.2.2.cmml" xref="S4.Ex9.m1.6.6.2.2.2.2">𝑗</ci></list></apply></apply></apply><apply id="S4.Ex9.m1.6.7.3.3.3.cmml" xref="S4.Ex9.m1.6.7.3.3.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.6.7.3.3.3.1.cmml" xref="S4.Ex9.m1.6.7.3.3.3">subscript</csymbol><ci id="S4.Ex9.m1.6.7.3.3.3.2.cmml" xref="S4.Ex9.m1.6.7.3.3.3.2">𝑥</ci><ci id="S4.Ex9.m1.6.7.3.3.3.3.cmml" xref="S4.Ex9.m1.6.7.3.3.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex9.m1.6c">W_{*}^{i,j}=W_{*}^{i,j-1}-\alpha\frac{\partial\mathcal{L}}{\partial a^{i,j}}x_{j}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS3.p3.18" class="ltx_p">where <math id="S4.SS3.p3.5.m1.1" class="ltx_Math" alttext="x_{j}" display="inline"><semantics id="S4.SS3.p3.5.m1.1a"><msub id="S4.SS3.p3.5.m1.1.1" xref="S4.SS3.p3.5.m1.1.1.cmml"><mi id="S4.SS3.p3.5.m1.1.1.2" xref="S4.SS3.p3.5.m1.1.1.2.cmml">x</mi><mi id="S4.SS3.p3.5.m1.1.1.3" xref="S4.SS3.p3.5.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m1.1b"><apply id="S4.SS3.p3.5.m1.1.1.cmml" xref="S4.SS3.p3.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m1.1.1.1.cmml" xref="S4.SS3.p3.5.m1.1.1">subscript</csymbol><ci id="S4.SS3.p3.5.m1.1.1.2.cmml" xref="S4.SS3.p3.5.m1.1.1.2">𝑥</ci><ci id="S4.SS3.p3.5.m1.1.1.3.cmml" xref="S4.SS3.p3.5.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m1.1c">x_{j}</annotation></semantics></math> denotes the data from the previous batch that activated bin <math id="S4.SS3.p3.6.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS3.p3.6.m2.1a"><mi id="S4.SS3.p3.6.m2.1.1" xref="S4.SS3.p3.6.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m2.1b"><ci id="S4.SS3.p3.6.m2.1.1.cmml" xref="S4.SS3.p3.6.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m2.1c">i</annotation></semantics></math>, and <math id="S4.SS3.p3.7.m3.2" class="ltx_Math" alttext="a^{i,j}" display="inline"><semantics id="S4.SS3.p3.7.m3.2a"><msup id="S4.SS3.p3.7.m3.2.3" xref="S4.SS3.p3.7.m3.2.3.cmml"><mi id="S4.SS3.p3.7.m3.2.3.2" xref="S4.SS3.p3.7.m3.2.3.2.cmml">a</mi><mrow id="S4.SS3.p3.7.m3.2.2.2.4" xref="S4.SS3.p3.7.m3.2.2.2.3.cmml"><mi id="S4.SS3.p3.7.m3.1.1.1.1" xref="S4.SS3.p3.7.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p3.7.m3.2.2.2.4.1" xref="S4.SS3.p3.7.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p3.7.m3.2.2.2.2" xref="S4.SS3.p3.7.m3.2.2.2.2.cmml">j</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m3.2b"><apply id="S4.SS3.p3.7.m3.2.3.cmml" xref="S4.SS3.p3.7.m3.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m3.2.3.1.cmml" xref="S4.SS3.p3.7.m3.2.3">superscript</csymbol><ci id="S4.SS3.p3.7.m3.2.3.2.cmml" xref="S4.SS3.p3.7.m3.2.3.2">𝑎</ci><list id="S4.SS3.p3.7.m3.2.2.2.3.cmml" xref="S4.SS3.p3.7.m3.2.2.2.4"><ci id="S4.SS3.p3.7.m3.1.1.1.1.cmml" xref="S4.SS3.p3.7.m3.1.1.1.1">𝑖</ci><ci id="S4.SS3.p3.7.m3.2.2.2.2.cmml" xref="S4.SS3.p3.7.m3.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m3.2c">a^{i,j}</annotation></semantics></math> denotes the <math id="S4.SS3.p3.8.m4.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S4.SS3.p3.8.m4.1a"><msup id="S4.SS3.p3.8.m4.1.1" xref="S4.SS3.p3.8.m4.1.1.cmml"><mi id="S4.SS3.p3.8.m4.1.1.2" xref="S4.SS3.p3.8.m4.1.1.2.cmml">i</mi><mrow id="S4.SS3.p3.8.m4.1.1.3" xref="S4.SS3.p3.8.m4.1.1.3.cmml"><mi id="S4.SS3.p3.8.m4.1.1.3.2" xref="S4.SS3.p3.8.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.8.m4.1.1.3.1" xref="S4.SS3.p3.8.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p3.8.m4.1.1.3.3" xref="S4.SS3.p3.8.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m4.1b"><apply id="S4.SS3.p3.8.m4.1.1.cmml" xref="S4.SS3.p3.8.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m4.1.1.1.cmml" xref="S4.SS3.p3.8.m4.1.1">superscript</csymbol><ci id="S4.SS3.p3.8.m4.1.1.2.cmml" xref="S4.SS3.p3.8.m4.1.1.2">𝑖</ci><apply id="S4.SS3.p3.8.m4.1.1.3.cmml" xref="S4.SS3.p3.8.m4.1.1.3"><times id="S4.SS3.p3.8.m4.1.1.3.1.cmml" xref="S4.SS3.p3.8.m4.1.1.3.1"></times><ci id="S4.SS3.p3.8.m4.1.1.3.2.cmml" xref="S4.SS3.p3.8.m4.1.1.3.2">𝑡</ci><ci id="S4.SS3.p3.8.m4.1.1.3.3.cmml" xref="S4.SS3.p3.8.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m4.1c">i^{th}</annotation></semantics></math> activation at step <math id="S4.SS3.p3.9.m5.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS3.p3.9.m5.1a"><mi id="S4.SS3.p3.9.m5.1.1" xref="S4.SS3.p3.9.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.9.m5.1b"><ci id="S4.SS3.p3.9.m5.1.1.cmml" xref="S4.SS3.p3.9.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.9.m5.1c">j</annotation></semantics></math>, and <math id="S4.SS3.p3.10.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS3.p3.10.m6.1a"><mi id="S4.SS3.p3.10.m6.1.1" xref="S4.SS3.p3.10.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.10.m6.1b"><ci id="S4.SS3.p3.10.m6.1.1.cmml" xref="S4.SS3.p3.10.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.10.m6.1c">\alpha</annotation></semantics></math> is the local learning rate. Note that if either a linear layer, or a convolutional layer follows this imprint module, then <math id="S4.SS3.p3.11.m7.2" class="ltx_Math" alttext="\frac{\partial\mathcal{L}}{\partial a^{i,j}}" display="inline"><semantics id="S4.SS3.p3.11.m7.2a"><mfrac id="S4.SS3.p3.11.m7.2.2" xref="S4.SS3.p3.11.m7.2.2.cmml"><mrow id="S4.SS3.p3.11.m7.2.2.4" xref="S4.SS3.p3.11.m7.2.2.4.cmml"><mo rspace="0em" id="S4.SS3.p3.11.m7.2.2.4.1" xref="S4.SS3.p3.11.m7.2.2.4.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.11.m7.2.2.4.2" xref="S4.SS3.p3.11.m7.2.2.4.2.cmml">ℒ</mi></mrow><mrow id="S4.SS3.p3.11.m7.2.2.2" xref="S4.SS3.p3.11.m7.2.2.2.cmml"><mo rspace="0em" id="S4.SS3.p3.11.m7.2.2.2.3" xref="S4.SS3.p3.11.m7.2.2.2.3.cmml">∂</mo><msup id="S4.SS3.p3.11.m7.2.2.2.4" xref="S4.SS3.p3.11.m7.2.2.2.4.cmml"><mi id="S4.SS3.p3.11.m7.2.2.2.4.2" xref="S4.SS3.p3.11.m7.2.2.2.4.2.cmml">a</mi><mrow id="S4.SS3.p3.11.m7.2.2.2.2.2.4" xref="S4.SS3.p3.11.m7.2.2.2.2.2.3.cmml"><mi id="S4.SS3.p3.11.m7.1.1.1.1.1.1" xref="S4.SS3.p3.11.m7.1.1.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p3.11.m7.2.2.2.2.2.4.1" xref="S4.SS3.p3.11.m7.2.2.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p3.11.m7.2.2.2.2.2.2" xref="S4.SS3.p3.11.m7.2.2.2.2.2.2.cmml">j</mi></mrow></msup></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.11.m7.2b"><apply id="S4.SS3.p3.11.m7.2.2.cmml" xref="S4.SS3.p3.11.m7.2.2"><divide id="S4.SS3.p3.11.m7.2.2.3.cmml" xref="S4.SS3.p3.11.m7.2.2"></divide><apply id="S4.SS3.p3.11.m7.2.2.4.cmml" xref="S4.SS3.p3.11.m7.2.2.4"><partialdiff id="S4.SS3.p3.11.m7.2.2.4.1.cmml" xref="S4.SS3.p3.11.m7.2.2.4.1"></partialdiff><ci id="S4.SS3.p3.11.m7.2.2.4.2.cmml" xref="S4.SS3.p3.11.m7.2.2.4.2">ℒ</ci></apply><apply id="S4.SS3.p3.11.m7.2.2.2.cmml" xref="S4.SS3.p3.11.m7.2.2.2"><partialdiff id="S4.SS3.p3.11.m7.2.2.2.3.cmml" xref="S4.SS3.p3.11.m7.2.2.2.3"></partialdiff><apply id="S4.SS3.p3.11.m7.2.2.2.4.cmml" xref="S4.SS3.p3.11.m7.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS3.p3.11.m7.2.2.2.4.1.cmml" xref="S4.SS3.p3.11.m7.2.2.2.4">superscript</csymbol><ci id="S4.SS3.p3.11.m7.2.2.2.4.2.cmml" xref="S4.SS3.p3.11.m7.2.2.2.4.2">𝑎</ci><list id="S4.SS3.p3.11.m7.2.2.2.2.2.3.cmml" xref="S4.SS3.p3.11.m7.2.2.2.2.2.4"><ci id="S4.SS3.p3.11.m7.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.11.m7.1.1.1.1.1.1">𝑖</ci><ci id="S4.SS3.p3.11.m7.2.2.2.2.2.2.cmml" xref="S4.SS3.p3.11.m7.2.2.2.2.2.2">𝑗</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.11.m7.2c">\frac{\partial\mathcal{L}}{\partial a^{i,j}}</annotation></semantics></math> does not depend on the scale of <math id="S4.SS3.p3.12.m8.2" class="ltx_Math" alttext="W_{*}^{i,j}" display="inline"><semantics id="S4.SS3.p3.12.m8.2a"><msubsup id="S4.SS3.p3.12.m8.2.3" xref="S4.SS3.p3.12.m8.2.3.cmml"><mi id="S4.SS3.p3.12.m8.2.3.2.2" xref="S4.SS3.p3.12.m8.2.3.2.2.cmml">W</mi><mo id="S4.SS3.p3.12.m8.2.3.2.3" xref="S4.SS3.p3.12.m8.2.3.2.3.cmml">∗</mo><mrow id="S4.SS3.p3.12.m8.2.2.2.4" xref="S4.SS3.p3.12.m8.2.2.2.3.cmml"><mi id="S4.SS3.p3.12.m8.1.1.1.1" xref="S4.SS3.p3.12.m8.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p3.12.m8.2.2.2.4.1" xref="S4.SS3.p3.12.m8.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p3.12.m8.2.2.2.2" xref="S4.SS3.p3.12.m8.2.2.2.2.cmml">j</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.12.m8.2b"><apply id="S4.SS3.p3.12.m8.2.3.cmml" xref="S4.SS3.p3.12.m8.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.12.m8.2.3.1.cmml" xref="S4.SS3.p3.12.m8.2.3">superscript</csymbol><apply id="S4.SS3.p3.12.m8.2.3.2.cmml" xref="S4.SS3.p3.12.m8.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.12.m8.2.3.2.1.cmml" xref="S4.SS3.p3.12.m8.2.3">subscript</csymbol><ci id="S4.SS3.p3.12.m8.2.3.2.2.cmml" xref="S4.SS3.p3.12.m8.2.3.2.2">𝑊</ci><times id="S4.SS3.p3.12.m8.2.3.2.3.cmml" xref="S4.SS3.p3.12.m8.2.3.2.3"></times></apply><list id="S4.SS3.p3.12.m8.2.2.2.3.cmml" xref="S4.SS3.p3.12.m8.2.2.2.4"><ci id="S4.SS3.p3.12.m8.1.1.1.1.cmml" xref="S4.SS3.p3.12.m8.1.1.1.1">𝑖</ci><ci id="S4.SS3.p3.12.m8.2.2.2.2.cmml" xref="S4.SS3.p3.12.m8.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.12.m8.2c">W_{*}^{i,j}</annotation></semantics></math>. Therefore, a simple way to increase the effectiveness of the new imprint module, <math id="S4.SS3.p3.13.m9.1" class="ltx_Math" alttext="M^{\prime}" display="inline"><semantics id="S4.SS3.p3.13.m9.1a"><msup id="S4.SS3.p3.13.m9.1.1" xref="S4.SS3.p3.13.m9.1.1.cmml"><mi id="S4.SS3.p3.13.m9.1.1.2" xref="S4.SS3.p3.13.m9.1.1.2.cmml">M</mi><mo id="S4.SS3.p3.13.m9.1.1.3" xref="S4.SS3.p3.13.m9.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.13.m9.1b"><apply id="S4.SS3.p3.13.m9.1.1.cmml" xref="S4.SS3.p3.13.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.13.m9.1.1.1.cmml" xref="S4.SS3.p3.13.m9.1.1">superscript</csymbol><ci id="S4.SS3.p3.13.m9.1.1.2.cmml" xref="S4.SS3.p3.13.m9.1.1.2">𝑀</ci><ci id="S4.SS3.p3.13.m9.1.1.3.cmml" xref="S4.SS3.p3.13.m9.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.13.m9.1c">M^{\prime}</annotation></semantics></math> in the fedAVG case is to scale the linear function associated to the rows of <math id="S4.SS3.p3.14.m10.1" class="ltx_Math" alttext="W_{*}" display="inline"><semantics id="S4.SS3.p3.14.m10.1a"><msub id="S4.SS3.p3.14.m10.1.1" xref="S4.SS3.p3.14.m10.1.1.cmml"><mi id="S4.SS3.p3.14.m10.1.1.2" xref="S4.SS3.p3.14.m10.1.1.2.cmml">W</mi><mo id="S4.SS3.p3.14.m10.1.1.3" xref="S4.SS3.p3.14.m10.1.1.3.cmml">∗</mo></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.14.m10.1b"><apply id="S4.SS3.p3.14.m10.1.1.cmml" xref="S4.SS3.p3.14.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.14.m10.1.1.1.cmml" xref="S4.SS3.p3.14.m10.1.1">subscript</csymbol><ci id="S4.SS3.p3.14.m10.1.1.2.cmml" xref="S4.SS3.p3.14.m10.1.1.2">𝑊</ci><times id="S4.SS3.p3.14.m10.1.1.3.cmml" xref="S4.SS3.p3.14.m10.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.14.m10.1c">W_{*}</annotation></semantics></math> - i.e. <math id="S4.SS3.p3.15.m11.2" class="ltx_Math" alttext="h^{\prime}(x)=c_{0}\cdot h(x)" display="inline"><semantics id="S4.SS3.p3.15.m11.2a"><mrow id="S4.SS3.p3.15.m11.2.3" xref="S4.SS3.p3.15.m11.2.3.cmml"><mrow id="S4.SS3.p3.15.m11.2.3.2" xref="S4.SS3.p3.15.m11.2.3.2.cmml"><msup id="S4.SS3.p3.15.m11.2.3.2.2" xref="S4.SS3.p3.15.m11.2.3.2.2.cmml"><mi id="S4.SS3.p3.15.m11.2.3.2.2.2" xref="S4.SS3.p3.15.m11.2.3.2.2.2.cmml">h</mi><mo id="S4.SS3.p3.15.m11.2.3.2.2.3" xref="S4.SS3.p3.15.m11.2.3.2.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="S4.SS3.p3.15.m11.2.3.2.1" xref="S4.SS3.p3.15.m11.2.3.2.1.cmml">​</mo><mrow id="S4.SS3.p3.15.m11.2.3.2.3.2" xref="S4.SS3.p3.15.m11.2.3.2.cmml"><mo stretchy="false" id="S4.SS3.p3.15.m11.2.3.2.3.2.1" xref="S4.SS3.p3.15.m11.2.3.2.cmml">(</mo><mi id="S4.SS3.p3.15.m11.1.1" xref="S4.SS3.p3.15.m11.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS3.p3.15.m11.2.3.2.3.2.2" xref="S4.SS3.p3.15.m11.2.3.2.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p3.15.m11.2.3.1" xref="S4.SS3.p3.15.m11.2.3.1.cmml">=</mo><mrow id="S4.SS3.p3.15.m11.2.3.3" xref="S4.SS3.p3.15.m11.2.3.3.cmml"><mrow id="S4.SS3.p3.15.m11.2.3.3.2" xref="S4.SS3.p3.15.m11.2.3.3.2.cmml"><msub id="S4.SS3.p3.15.m11.2.3.3.2.2" xref="S4.SS3.p3.15.m11.2.3.3.2.2.cmml"><mi id="S4.SS3.p3.15.m11.2.3.3.2.2.2" xref="S4.SS3.p3.15.m11.2.3.3.2.2.2.cmml">c</mi><mn id="S4.SS3.p3.15.m11.2.3.3.2.2.3" xref="S4.SS3.p3.15.m11.2.3.3.2.2.3.cmml">0</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p3.15.m11.2.3.3.2.1" xref="S4.SS3.p3.15.m11.2.3.3.2.1.cmml">⋅</mo><mi id="S4.SS3.p3.15.m11.2.3.3.2.3" xref="S4.SS3.p3.15.m11.2.3.3.2.3.cmml">h</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS3.p3.15.m11.2.3.3.1" xref="S4.SS3.p3.15.m11.2.3.3.1.cmml">​</mo><mrow id="S4.SS3.p3.15.m11.2.3.3.3.2" xref="S4.SS3.p3.15.m11.2.3.3.cmml"><mo stretchy="false" id="S4.SS3.p3.15.m11.2.3.3.3.2.1" xref="S4.SS3.p3.15.m11.2.3.3.cmml">(</mo><mi id="S4.SS3.p3.15.m11.2.2" xref="S4.SS3.p3.15.m11.2.2.cmml">x</mi><mo stretchy="false" id="S4.SS3.p3.15.m11.2.3.3.3.2.2" xref="S4.SS3.p3.15.m11.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.15.m11.2b"><apply id="S4.SS3.p3.15.m11.2.3.cmml" xref="S4.SS3.p3.15.m11.2.3"><eq id="S4.SS3.p3.15.m11.2.3.1.cmml" xref="S4.SS3.p3.15.m11.2.3.1"></eq><apply id="S4.SS3.p3.15.m11.2.3.2.cmml" xref="S4.SS3.p3.15.m11.2.3.2"><times id="S4.SS3.p3.15.m11.2.3.2.1.cmml" xref="S4.SS3.p3.15.m11.2.3.2.1"></times><apply id="S4.SS3.p3.15.m11.2.3.2.2.cmml" xref="S4.SS3.p3.15.m11.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.15.m11.2.3.2.2.1.cmml" xref="S4.SS3.p3.15.m11.2.3.2.2">superscript</csymbol><ci id="S4.SS3.p3.15.m11.2.3.2.2.2.cmml" xref="S4.SS3.p3.15.m11.2.3.2.2.2">ℎ</ci><ci id="S4.SS3.p3.15.m11.2.3.2.2.3.cmml" xref="S4.SS3.p3.15.m11.2.3.2.2.3">′</ci></apply><ci id="S4.SS3.p3.15.m11.1.1.cmml" xref="S4.SS3.p3.15.m11.1.1">𝑥</ci></apply><apply id="S4.SS3.p3.15.m11.2.3.3.cmml" xref="S4.SS3.p3.15.m11.2.3.3"><times id="S4.SS3.p3.15.m11.2.3.3.1.cmml" xref="S4.SS3.p3.15.m11.2.3.3.1"></times><apply id="S4.SS3.p3.15.m11.2.3.3.2.cmml" xref="S4.SS3.p3.15.m11.2.3.3.2"><ci id="S4.SS3.p3.15.m11.2.3.3.2.1.cmml" xref="S4.SS3.p3.15.m11.2.3.3.2.1">⋅</ci><apply id="S4.SS3.p3.15.m11.2.3.3.2.2.cmml" xref="S4.SS3.p3.15.m11.2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.15.m11.2.3.3.2.2.1.cmml" xref="S4.SS3.p3.15.m11.2.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.15.m11.2.3.3.2.2.2.cmml" xref="S4.SS3.p3.15.m11.2.3.3.2.2.2">𝑐</ci><cn type="integer" id="S4.SS3.p3.15.m11.2.3.3.2.2.3.cmml" xref="S4.SS3.p3.15.m11.2.3.3.2.2.3">0</cn></apply><ci id="S4.SS3.p3.15.m11.2.3.3.2.3.cmml" xref="S4.SS3.p3.15.m11.2.3.3.2.3">ℎ</ci></apply><ci id="S4.SS3.p3.15.m11.2.2.cmml" xref="S4.SS3.p3.15.m11.2.2">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.15.m11.2c">h^{\prime}(x)=c_{0}\cdot h(x)</annotation></semantics></math>. This “flattens” the distribution of values, and increases the relative size of <math id="S4.SS3.p3.16.m12.2" class="ltx_Math" alttext="b_{*}^{i,j}" display="inline"><semantics id="S4.SS3.p3.16.m12.2a"><msubsup id="S4.SS3.p3.16.m12.2.3" xref="S4.SS3.p3.16.m12.2.3.cmml"><mi id="S4.SS3.p3.16.m12.2.3.2.2" xref="S4.SS3.p3.16.m12.2.3.2.2.cmml">b</mi><mo id="S4.SS3.p3.16.m12.2.3.2.3" xref="S4.SS3.p3.16.m12.2.3.2.3.cmml">∗</mo><mrow id="S4.SS3.p3.16.m12.2.2.2.4" xref="S4.SS3.p3.16.m12.2.2.2.3.cmml"><mi id="S4.SS3.p3.16.m12.1.1.1.1" xref="S4.SS3.p3.16.m12.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p3.16.m12.2.2.2.4.1" xref="S4.SS3.p3.16.m12.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p3.16.m12.2.2.2.2" xref="S4.SS3.p3.16.m12.2.2.2.2.cmml">j</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.16.m12.2b"><apply id="S4.SS3.p3.16.m12.2.3.cmml" xref="S4.SS3.p3.16.m12.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.16.m12.2.3.1.cmml" xref="S4.SS3.p3.16.m12.2.3">superscript</csymbol><apply id="S4.SS3.p3.16.m12.2.3.2.cmml" xref="S4.SS3.p3.16.m12.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.16.m12.2.3.2.1.cmml" xref="S4.SS3.p3.16.m12.2.3">subscript</csymbol><ci id="S4.SS3.p3.16.m12.2.3.2.2.cmml" xref="S4.SS3.p3.16.m12.2.3.2.2">𝑏</ci><times id="S4.SS3.p3.16.m12.2.3.2.3.cmml" xref="S4.SS3.p3.16.m12.2.3.2.3"></times></apply><list id="S4.SS3.p3.16.m12.2.2.2.3.cmml" xref="S4.SS3.p3.16.m12.2.2.2.4"><ci id="S4.SS3.p3.16.m12.1.1.1.1.cmml" xref="S4.SS3.p3.16.m12.1.1.1.1">𝑖</ci><ci id="S4.SS3.p3.16.m12.2.2.2.2.cmml" xref="S4.SS3.p3.16.m12.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.16.m12.2c">b_{*}^{i,j}</annotation></semantics></math> compared to the gradient update <math id="S4.SS3.p3.17.m13.2" class="ltx_Math" alttext="\frac{\partial\mathcal{L}}{\partial a^{i,j}}" display="inline"><semantics id="S4.SS3.p3.17.m13.2a"><mfrac id="S4.SS3.p3.17.m13.2.2" xref="S4.SS3.p3.17.m13.2.2.cmml"><mrow id="S4.SS3.p3.17.m13.2.2.4" xref="S4.SS3.p3.17.m13.2.2.4.cmml"><mo rspace="0em" id="S4.SS3.p3.17.m13.2.2.4.1" xref="S4.SS3.p3.17.m13.2.2.4.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.17.m13.2.2.4.2" xref="S4.SS3.p3.17.m13.2.2.4.2.cmml">ℒ</mi></mrow><mrow id="S4.SS3.p3.17.m13.2.2.2" xref="S4.SS3.p3.17.m13.2.2.2.cmml"><mo rspace="0em" id="S4.SS3.p3.17.m13.2.2.2.3" xref="S4.SS3.p3.17.m13.2.2.2.3.cmml">∂</mo><msup id="S4.SS3.p3.17.m13.2.2.2.4" xref="S4.SS3.p3.17.m13.2.2.2.4.cmml"><mi id="S4.SS3.p3.17.m13.2.2.2.4.2" xref="S4.SS3.p3.17.m13.2.2.2.4.2.cmml">a</mi><mrow id="S4.SS3.p3.17.m13.2.2.2.2.2.4" xref="S4.SS3.p3.17.m13.2.2.2.2.2.3.cmml"><mi id="S4.SS3.p3.17.m13.1.1.1.1.1.1" xref="S4.SS3.p3.17.m13.1.1.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p3.17.m13.2.2.2.2.2.4.1" xref="S4.SS3.p3.17.m13.2.2.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p3.17.m13.2.2.2.2.2.2" xref="S4.SS3.p3.17.m13.2.2.2.2.2.2.cmml">j</mi></mrow></msup></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.17.m13.2b"><apply id="S4.SS3.p3.17.m13.2.2.cmml" xref="S4.SS3.p3.17.m13.2.2"><divide id="S4.SS3.p3.17.m13.2.2.3.cmml" xref="S4.SS3.p3.17.m13.2.2"></divide><apply id="S4.SS3.p3.17.m13.2.2.4.cmml" xref="S4.SS3.p3.17.m13.2.2.4"><partialdiff id="S4.SS3.p3.17.m13.2.2.4.1.cmml" xref="S4.SS3.p3.17.m13.2.2.4.1"></partialdiff><ci id="S4.SS3.p3.17.m13.2.2.4.2.cmml" xref="S4.SS3.p3.17.m13.2.2.4.2">ℒ</ci></apply><apply id="S4.SS3.p3.17.m13.2.2.2.cmml" xref="S4.SS3.p3.17.m13.2.2.2"><partialdiff id="S4.SS3.p3.17.m13.2.2.2.3.cmml" xref="S4.SS3.p3.17.m13.2.2.2.3"></partialdiff><apply id="S4.SS3.p3.17.m13.2.2.2.4.cmml" xref="S4.SS3.p3.17.m13.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS3.p3.17.m13.2.2.2.4.1.cmml" xref="S4.SS3.p3.17.m13.2.2.2.4">superscript</csymbol><ci id="S4.SS3.p3.17.m13.2.2.2.4.2.cmml" xref="S4.SS3.p3.17.m13.2.2.2.4.2">𝑎</ci><list id="S4.SS3.p3.17.m13.2.2.2.2.2.3.cmml" xref="S4.SS3.p3.17.m13.2.2.2.2.2.4"><ci id="S4.SS3.p3.17.m13.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.17.m13.1.1.1.1.1.1">𝑖</ci><ci id="S4.SS3.p3.17.m13.2.2.2.2.2.2.cmml" xref="S4.SS3.p3.17.m13.2.2.2.2.2.2">𝑗</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.17.m13.2c">\frac{\partial\mathcal{L}}{\partial a^{i,j}}</annotation></semantics></math>, which prevents the bins from shifting too significantly during local updates. As bin shift goes to <math id="S4.SS3.p3.18.m14.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.SS3.p3.18.m14.1a"><mn id="S4.SS3.p3.18.m14.1.1" xref="S4.SS3.p3.18.m14.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.18.m14.1b"><cn type="integer" id="S4.SS3.p3.18.m14.1.1.cmml" xref="S4.SS3.p3.18.m14.1.1">0</cn></annotation-xml></semantics></math>, we recover the situation where the only variable that matters is the total data used in an update.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.2" class="ltx_p">With this modification, reconstruction quality remains similar to the fedSGD setting. For example, splitting the batch of 64 ImageNet images up into 8 local updates with learning rate <math id="S4.SS3.p4.1.m1.1" class="ltx_Math" alttext="\tau=1e-4" display="inline"><semantics id="S4.SS3.p4.1.m1.1a"><mrow id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml"><mi id="S4.SS3.p4.1.m1.1.1.2" xref="S4.SS3.p4.1.m1.1.1.2.cmml">τ</mi><mo id="S4.SS3.p4.1.m1.1.1.1" xref="S4.SS3.p4.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS3.p4.1.m1.1.1.3" xref="S4.SS3.p4.1.m1.1.1.3.cmml"><mrow id="S4.SS3.p4.1.m1.1.1.3.2" xref="S4.SS3.p4.1.m1.1.1.3.2.cmml"><mn id="S4.SS3.p4.1.m1.1.1.3.2.2" xref="S4.SS3.p4.1.m1.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.SS3.p4.1.m1.1.1.3.2.1" xref="S4.SS3.p4.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S4.SS3.p4.1.m1.1.1.3.2.3" xref="S4.SS3.p4.1.m1.1.1.3.2.3.cmml">e</mi></mrow><mo id="S4.SS3.p4.1.m1.1.1.3.1" xref="S4.SS3.p4.1.m1.1.1.3.1.cmml">−</mo><mn id="S4.SS3.p4.1.m1.1.1.3.3" xref="S4.SS3.p4.1.m1.1.1.3.3.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><apply id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1"><eq id="S4.SS3.p4.1.m1.1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1.1"></eq><ci id="S4.SS3.p4.1.m1.1.1.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2">𝜏</ci><apply id="S4.SS3.p4.1.m1.1.1.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3"><minus id="S4.SS3.p4.1.m1.1.1.3.1.cmml" xref="S4.SS3.p4.1.m1.1.1.3.1"></minus><apply id="S4.SS3.p4.1.m1.1.1.3.2.cmml" xref="S4.SS3.p4.1.m1.1.1.3.2"><times id="S4.SS3.p4.1.m1.1.1.3.2.1.cmml" xref="S4.SS3.p4.1.m1.1.1.3.2.1"></times><cn type="integer" id="S4.SS3.p4.1.m1.1.1.3.2.2.cmml" xref="S4.SS3.p4.1.m1.1.1.3.2.2">1</cn><ci id="S4.SS3.p4.1.m1.1.1.3.2.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="S4.SS3.p4.1.m1.1.1.3.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">\tau=1e-4</annotation></semantics></math> yields an IIP score of <math id="S4.SS3.p4.2.m2.1" class="ltx_Math" alttext="70.31\%" display="inline"><semantics id="S4.SS3.p4.2.m2.1a"><mrow id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml"><mn id="S4.SS3.p4.2.m2.1.1.2" xref="S4.SS3.p4.2.m2.1.1.2.cmml">70.31</mn><mo id="S4.SS3.p4.2.m2.1.1.1" xref="S4.SS3.p4.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><apply id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1"><csymbol cd="latexml" id="S4.SS3.p4.2.m2.1.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS3.p4.2.m2.1.1.2.cmml" xref="S4.SS3.p4.2.m2.1.1.2">70.31</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">70.31\%</annotation></semantics></math>, due to minor image duplications where images hit multiple shifted bins, which we visualize in Appendix <a href="#A1.F19" title="In A.6 Additional Images ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">19</span></a>.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2110.13057/assets/x3.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="207" height="104" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2110.13057/assets/x4.png" id="S4.F4.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="207" height="104" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S4.F4.3.1" class="ltx_text ltx_font_bold">Left:</span> Identification Success vs bin size. <span id="S4.F4.4.2" class="ltx_text ltx_font_bold">Right:</span> Identification Success (via IIP score) vs. bin size and position in a ResNet-18 model. We find that the attack is stable over a range of batch sizes and positions in a model.</figcaption>
</figure>
<div id="S4.SS3.p5" class="ltx_para ltx_noindent">
<p id="S4.SS3.p5.1" class="ltx_p"><span id="S4.SS3.p5.1.1" class="ltx_text ltx_font_bold">Other data modalities:</span>
Yet another advantage to our imprint module over existing optimization based gradient inversion techniques is the flexibility in data domain. Other techniques have demonstrated some success in the image domain by leveraging strong regularizers including total variation (TV), image registration, matching batch norm statistics, and DeepInversion priors <cite class="ltx_cite ltx_citemacro_citep">(Geiping et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Yin et al., <a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite>. Such strong regularizers do not always exist in other domains of interest, such as text or tabular data. The discussed imprint module, however, is data-agnostic, and while we focus our experiments on the image domain, nowhere do we use any assumptions unique to vision. In fact, linear layers often appear in language models, and tabular data models - cases in which the attacker only needs to modify parameters of an existing model to breach user privacy <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib33" title="" class="ltx_ref">2017</a>; Somepalli et al., <a href="#bib.bib31" title="" class="ltx_ref">2021</a>)</cite> without architecture modifications.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Potential Defense and Mitigation Strategies</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">If aggregation is the only source of security in a FL system, then the proposed attack breaks it, uncovering samples of private data from arbitrarily large batches, especially via the One-shot mechanism. In light of this attack, the effectiveness of secure aggregation is reduced to only <span id="S5.p1.1.1" class="ltx_text ltx_font_italic">secure shuffling</span> <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>: When private data is uncovered via the imprint module, based on data that has been securely aggregated, then the data is breached, but is not directly connected to any specific user (aside from possible revealing information in the data itself). A mitigation strategy for users that does not require coordination (or consent) of a central server is to employ local differential privacy <cite class="ltx_cite ltx_citemacro_citep">(Dwork &amp; Roth, <a href="#bib.bib5" title="" class="ltx_ref">2013</a>)</cite>. Adding sufficient gradient noise can be a defense against this attack as the division in <a href="#S3.E2" title="In 3.2 A Simple Example ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a> leads to potentially unbounded errors in the scale of the data. Yet, in practice, privacy is often still broken even if the correct scale cannot be determined, so that the amount of noise that has to be added is large. In Appendix <a href="#A1.F20" title="In A.7 Defense Discussion ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">20</span></a>, even with <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="\sigma=0.01" display="inline"><semantics id="S5.p1.1.m1.1a"><mrow id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">σ</mi><mo id="S5.p1.1.m1.1.1.1" xref="S5.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><eq id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1.1"></eq><ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">𝜎</ci><cn type="float" id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">\sigma=0.01</annotation></semantics></math>, private data is visibly leaked. Additional discussion on defenses can be found in <a href="#A1.SS7" title="A.7 Defense Discussion ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.7</span></a></p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">Federated learning offers a promising avenue for training models in a distributed fashion. However, the use of federated learning, even with large scale averaging, does not guarantee user privacy. Using common and inconspicuous machine learning modules, a malicious server can breach user privacy by sending minimally modified models and parameters in a federated setup. We hope that constructing these examples clarifies current limitations and informs discussions on upcoming applications, especially concerning API design.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Ethics Statement</h2>

<div id="Sx1.p1" class="ltx_para ltx_noindent">
<p id="Sx1.p1.1" class="ltx_p">In this work, we uncover an attack on federated learning that has the potential to compromise user privacy. While this method has the potential to be used for malicious purposes, the fundamental purpose of this research is to inform the community about the state of privacy in federated learning, and to help users and technical experts better understand the limitations of federated learning for the purpose of preserving user privacy.</p>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Reproducibility Statement</h2>

<div id="Sx2.p1" class="ltx_para ltx_noindent">
<p id="Sx2.p1.1" class="ltx_p">We provide additional technical details and the proof <a href="#Thmproposition1" title="Proposition 1. ‣ 3.3 Imprinting User Information into Model Updates ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a> in the appendix. Further, we provide open-source implementations of all attacks investigated in this work. The repository at <a target="_blank" href="https://github.com/lhfowl/robbing_the_fed" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/lhfowl/robbing_the_fed</a> shows a minimalistic implementation of the principles of this attack and the repository at <a target="_blank" href="https://github.com/JonasGeiping/breaching" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/JonasGeiping/breaching</a> embeds the attack in a larger framework of privacy attacks against federated learning. The experiments in this work require no GPU resources and can be cheaply evaluated on almost any machine with sufficient RAM.</p>
</div>
</section>
<section id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx3.p1" class="ltx_para ltx_noindent">
<p id="Sx3.p1.1" class="ltx_p">This work was supported by DARPA GARD, the Office and Naval Research, and the National Science Foundation Division of Mathematical Sciences. Addition support was provided by the Sloan Foundation, JP Morgan Chase, and Capital One Bank.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Boenisch et al. (2021)</span>
<span class="ltx_bibblock">
Franziska Boenisch, Adam Dziedzic, Roei Schuster, Ali Shahin Shamsabadi, Ilia
Shumailov, and Nicolas Papernot.

</span>
<span class="ltx_bibblock">When the curious abandon honesty: Federated learning is not private.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2112.02918</em>, 2021.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al. (2017)</span>
<span class="ltx_bibblock">
Kallista Bonawitz, Vladimir Ivanov, Ben Kreuter, Antonio Marcedone, H. Brendan
McMahan, Sarvar Patel, Daniel Ramage, Aaron Segal, and Karn Seth.

</span>
<span class="ltx_bibblock">Practical Secure Aggregation for Privacy Preserving Machine
Learning.

</span>
<span class="ltx_bibblock">Technical Report 281, 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://eprint.iacr.org/2017/281" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://eprint.iacr.org/2017/281</a>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cason (2020)</span>
<span class="ltx_bibblock">
Patrick Cason.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Announcing 4 New Libraries for Federated Learning on Web and
Mobile Devices</em>, 2020.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://blog.openmined.org/announcing-new-libraries-for-fl-on-web-and-mobile/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://blog.openmined.org/announcing-new-libraries-for-fl-on-web-and-mobile/</a>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020)</span>
<span class="ltx_bibblock">
Xinlei Chen, Haoqi Fan, Ross Girshick, and Kaiming He.

</span>
<span class="ltx_bibblock">Improved Baselines with Momentum Contrastive Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv:2003.04297 [cs]</em>, March 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2003.04297" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2003.04297</a>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dwork &amp; Roth (2013)</span>
<span class="ltx_bibblock">
Cynthia Dwork and Aaron Roth.

</span>
<span class="ltx_bibblock">The Algorithmic Foundations of Differential Privacy.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Theoretical Computer
Science</em>, 9(3-4):211–407, 2013.

</span>
<span class="ltx_bibblock">ISSN 1551-305X, 1551-3068.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1561/0400000042</span>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al. (2020)</span>
<span class="ltx_bibblock">
Lixin Fan, Kam Woh Ng, Ce Ju, Tianyu Zhang, Chang Liu, Chee Seng Chan, and
Qiang Yang.

</span>
<span class="ltx_bibblock">Rethinking Privacy Preserving Deep Learning: How to
Evaluate and Thwart Privacy Attacks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Federated Learning: Privacy and Incentive</em>,
Lecture Notes in Computer Science, pp.  32–50. Springer
International Publishing, Cham, 2020.

</span>
<span class="ltx_bibblock">ISBN 978-3-030-63076-8.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1007/978-3-030-63076-8˙3</span>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geiping et al. (2020)</span>
<span class="ltx_bibblock">
Jonas Geiping, Hartmut Bauermeister, Hannah Dröge, and Michael Moeller.

</span>
<span class="ltx_bibblock">Inverting Gradients - How easy is it to break privacy in
federated learning?

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume 33, December 2020.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://proceedings.neurips.cc//paper_files/paper/2020/hash/c4ede56bbd98819ae6112b20ac6bf145-Abstract.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc//paper_files/paper/2020/hash/c4ede56bbd98819ae6112b20ac6bf145-Abstract.html</a>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goldblum et al. (2020)</span>
<span class="ltx_bibblock">
Micah Goldblum, Jonas Geiping, Avi Schwarzschild, Michael Moeller, and Tom
Goldstein.

</span>
<span class="ltx_bibblock">Truth or backpropaganda? An empirical investigation of deep
learning theory.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Eighth International Conference on Learning
Representations (ICLR 2020, Oral Presentation)</em>, April 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://iclr.cc/virtual_2020/poster_HyxyIgHFvr.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://iclr.cc/virtual_2020/poster_HyxyIgHFvr.html</a>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goldreich (2009)</span>
<span class="ltx_bibblock">
Oded Goldreich.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Foundations of Cryptography: Volume 2, Basic
Applications</em>.

</span>
<span class="ltx_bibblock">Cambridge University Press, Cambridge, 1st edition edition,
September 2009.

</span>
<span class="ltx_bibblock">ISBN 978-0-521-11991-7.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2015)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep Residual Learning for Image Recognition.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv:1512.03385 [cs]</em>, December 2015.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1512.03385" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1512.03385</a>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang &amp; Mumford (1999)</span>
<span class="ltx_bibblock">
Jinggang Huang and David Mumford.

</span>
<span class="ltx_bibblock">Statistics of natural images and models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings. 1999 IEEE Computer Society Conference on
Computer Vision and Pattern Recognition (Cat. No PR00149)</em>,
volume 1, pp.  541–547 Vol. 1, June 1999.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/CVPR.1999.786990</span>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeon et al. (2021)</span>
<span class="ltx_bibblock">
Jinwoo Jeon, Jaechang Kim, Kangwook Lee, Sewoong Oh, and Jungseul Ok.

</span>
<span class="ltx_bibblock">Gradient Inversion with Generative Image Prior.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">International Workshop on Federated Learning for
User Privacy and Data Confidentiality</em>, pp.  12, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jochems et al. (2016)</span>
<span class="ltx_bibblock">
Arthur Jochems, Timo M. Deist, Johan van Soest, Michael Eble, Paul Bulens,
Philippe Coucke, Wim Dries, Philippe Lambin, and Andre Dekker.

</span>
<span class="ltx_bibblock">Distributed learning: Developing a predictive model based on data
from multiple hospitals without data leaving the hospital – A
real life proof of concept.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Radiotherapy and Oncology</em>, 121(3):459–467, December 2016.

</span>
<span class="ltx_bibblock">ISSN 0167-8140, 1879-0887.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1016/j.radonc.2016.10.002</span>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Peter Kairouz, H. Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi
Bennis, Arjun Nitin Bhagoji, Kallista Bonawitz, Zachary Charles, Graham
Cormode, Rachel Cummings, Rafael G. L. D’Oliveira, Hubert Eichner, Salim El
Rouayheb, David Evans, Josh Gardner, Zachary Garrett, Adrià Gascón,
Badih Ghazi, Phillip B. Gibbons, Marco Gruteser, Zaid Harchaoui, Chaoyang He,
Lie He, Zhouyuan Huo, Ben Hutchinson, Justin Hsu, Martin Jaggi, Tara Javidi,
Gauri Joshi, Mikhail Khodak, Jakub Konečný, Aleksandra Korolova,
Farinaz Koushanfar, Sanmi Koyejo, Tancrède Lepoint, Yang Liu, Prateek
Mittal, Mehryar Mohri, Richard Nock, Ayfer Özgür, Rasmus Pagh,
Mariana Raykova, Hang Qi, Daniel Ramage, Ramesh Raskar, Dawn Song, Weikang
Song, Sebastian U. Stich, Ziteng Sun, Ananda Theertha Suresh, Florian
Tramèr, Praneeth Vepakomma, Jianyu Wang, Li Xiong, Zheng Xu, Qiang Yang,
Felix X. Yu, Han Yu, and Sen Zhao.

</span>
<span class="ltx_bibblock">Advances and Open Problems in Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv:1912.04977 [cs, stat]</em>, March 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1912.04977" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1912.04977</a>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečný et al. (2015)</span>
<span class="ltx_bibblock">
Jakub Konečný, Brendan McMahan, and Daniel Ramage.

</span>
<span class="ltx_bibblock">Federated Optimization:Distributed Optimization Beyond the
Datacenter.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv:1511.03575 [cs, math]</em>, November 2015.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1511.03575" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1511.03575</a>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lam &amp; Goodman (2000)</span>
<span class="ltx_bibblock">
E.Y. Lam and J.W. Goodman.

</span>
<span class="ltx_bibblock">A mathematical analysis of the DCT coefficient distributions for
images.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Image Processing</em>, 9(10):1661–1666, October 2000.

</span>
<span class="ltx_bibblock">ISSN 10577149.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/83.869177</span>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan &amp; Ramage (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan and Daniel Ramage.

</span>
<span class="ltx_bibblock">Federated Learning: Collaborative Machine Learning without
Centralized Training Data, April 2017.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="http://ai.googleblog.com/2017/04/federated-learning-collaborative.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://ai.googleblog.com/2017/04/federated-learning-collaborative.html</a>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
H. Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and
Blaise Agüera y Arcas.

</span>
<span class="ltx_bibblock">Communication-Efficient Learning of Deep Networks from
Decentralized Data.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv:1602.05629 [cs]</em>, February 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1602.05629" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1602.05629</a>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Melis et al. (2018)</span>
<span class="ltx_bibblock">
Luca Melis, Congzheng Song, Emiliano De Cristofaro, and Vitaly Shmatikov.

</span>
<span class="ltx_bibblock">Exploiting Unintended Feature Leakage in Collaborative
Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv:1805.04049 [cs]</em>, November 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1805.04049" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1805.04049</a>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Merity et al. (2016)</span>
<span class="ltx_bibblock">
Stephen Merity, Caiming Xiong, James Bradbury, and Richard Socher.

</span>
<span class="ltx_bibblock">Pointer Sentinel Mixture Models.

</span>
<span class="ltx_bibblock">November 2016.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=Byj72udxe" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=Byj72udxe</a>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al. (2020)</span>
<span class="ltx_bibblock">
Xudong Pan, Mi Zhang, Yifan Yan, Jiaming Zhu, and Min Yang.

</span>
<span class="ltx_bibblock">Theory-Oriented Deep Leakage from Gradients via Linear
Equation Solver.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv:2010.13356 [cs, stat]</em>, October 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2010.13356" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2010.13356</a>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. (2017)</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross, Soumith Chintala, Gregory Chanan, Edward Yang, Zachary
DeVito, Zeming Lin, Alban Desmaison, Luca Antiga, and Adam Lerer.

</span>
<span class="ltx_bibblock">Automatic differentiation in PyTorch.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">NIPS 2017 Autodiff Workshop</em>, Long Beach, CA,
2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=BJJsrmfCZ" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=BJJsrmfCZ</a>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Phong et al. (2017a)</span>
<span class="ltx_bibblock">
Le Trieu Phong, Yoshinori Aono, Takuya Hayashi, Lihua Wang, and Shiho Moriai.

</span>
<span class="ltx_bibblock">Privacy-Preserving Deep Learning via Additively Homomorphic
Encryption.

</span>
<span class="ltx_bibblock">Technical Report 715, 2017a.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://eprint.iacr.org/2017/715" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://eprint.iacr.org/2017/715</a>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Phong et al. (2017b)</span>
<span class="ltx_bibblock">
Le Trieu Phong, Yoshinori Aono, Takuya Hayashi, Lihua Wang, and Shiho Moriai.

</span>
<span class="ltx_bibblock">Privacy-Preserving Deep Learning: Revisited and Enhanced.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Applications and Techniques in Information
Security</em>, Communications in Computer and Information Science, pp. 100–110, Singapore, 2017b. Springer.

</span>
<span class="ltx_bibblock">ISBN 978-981-10-5421-1.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1007/978-981-10-5421-1˙9</span>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qian &amp; Hansen (2020)</span>
<span class="ltx_bibblock">
Jia Qian and Lars Kai Hansen.

</span>
<span class="ltx_bibblock">What can we learn from gradients?

</span>
<span class="ltx_bibblock">September 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=gQn5xeVtz0I" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=gQn5xeVtz0I</a>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qian et al. (2021)</span>
<span class="ltx_bibblock">
Jia Qian, Hiba Nassar, and Lars Kai Hansen.

</span>
<span class="ltx_bibblock">Minimal conditions analysis of gradient-based reconstruction in
Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv:2010.15718 [cs, eess]</em>, March 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2010.15718" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2010.15718</a>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2019)</span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, and Ilya
Sutskever.

</span>
<span class="ltx_bibblock">Language Models are Unsupervised Multitask Learners.

</span>
<span class="ltx_bibblock">pp.  24, 2019.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ruderman (1994)</span>
<span class="ltx_bibblock">
Daniel L. Ruderman.

</span>
<span class="ltx_bibblock">The statistics of natural images.

</span>
<span class="ltx_bibblock">5(4):517–548, January 1994.

</span>
<span class="ltx_bibblock">ISSN 0954-898X.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1088/0954-898X/5/4/006</span>.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Russakovsky et al. (2015)</span>
<span class="ltx_bibblock">
Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause, Sanjeev Satheesh, Sean Ma,
Zhiheng Huang, Andrej Karpathy, Aditya Khosla, Michael Bernstein,
Alexander C. Berg, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">ImageNet Large Scale Visual Recognition Challenge.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, 115(3):211–252, December 2015.

</span>
<span class="ltx_bibblock">ISSN 1573-1405.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1007/s11263-015-0816-y</span>.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shokri &amp; Shmatikov (2015)</span>
<span class="ltx_bibblock">
Reza Shokri and Vitaly Shmatikov.

</span>
<span class="ltx_bibblock">Privacy-Preserving Deep Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 22nd ACM SIGSAC Conference on
Computer and Communications Security - CCS ’15</em>, pp. 1310–1321, Denver, Colorado, USA, 2015. ACM Press.

</span>
<span class="ltx_bibblock">ISBN 978-1-4503-3832-5.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/2810103.2813687</span>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Somepalli et al. (2021)</span>
<span class="ltx_bibblock">
Gowthami Somepalli, Micah Goldblum, Avi Schwarzschild, C Bayan Bruss, and Tom
Goldstein.

</span>
<span class="ltx_bibblock">Saint: Improved neural networks for tabular data via row attention
and contrastive pre-training.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.01342</em>, 2021.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2021)</span>
<span class="ltx_bibblock">
Jingwei Sun, Ang Li, Binghui Wang, Huanrui Yang, Hai Li, and Yiran Chen.

</span>
<span class="ltx_bibblock">Soteria: Provable Defense Against Privacy Leakage in Federated
Learning From Representation Perspective.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer
Vision and Pattern Recognition</em>, pp.  9311–9319, 2021.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://openaccess.thecvf.com/content/CVPR2021/html/Sun_Soteria_Provable_Defense_Against_Privacy_Leakage_in_Federated_Learning_From_CVPR_2021_paper.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openaccess.thecvf.com/content/CVPR2021/html/Sun_Soteria_Provable_Defense_Against_Privacy_Leakage_in_Federated_Learning_From_CVPR_2021_paper.html</a>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention Is All You Need.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv:1706.03762 [cs]</em>, December 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1706.03762" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1706.03762</a>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Veale et al. (2018)</span>
<span class="ltx_bibblock">
Michael Veale, Reuben Binns, and Lilian Edwards.

</span>
<span class="ltx_bibblock">Algorithms that remember: Model inversion attacks and data protection
law.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Philosophical Transactions of the Royal Society A:
Mathematical, Physical and Engineering Sciences</em>, 376(2133):20180083, November 2018.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1098/rsta.2018.0083</span>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wainakh et al. (2021)</span>
<span class="ltx_bibblock">
Aidmar Wainakh, Fabrizio Ventola, Till Müßig, Jens Keim, Carlos Garcia
Cordero, Ephraim Zimmer, Tim Grube, Kristian Kersting, and Max
Mühlhäuser.

</span>
<span class="ltx_bibblock">User Label Leakage from Gradients in Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv:2105.09369 [cs]</em>, June 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2105.09369" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2105.09369</a>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Jianyu Wang, Zachary Charles, Zheng Xu, Gauri Joshi, H. Brendan McMahan,
Blaise Aguera y Arcas, Maruan Al-Shedivat, Galen Andrew, Salman Avestimehr,
Katharine Daly, Deepesh Data, Suhas Diggavi, Hubert Eichner, Advait Gadhikar,
Zachary Garrett, Antonious M. Girgis, Filip Hanzely, Andrew Hard, Chaoyang
He, Samuel Horvath, Zhouyuan Huo, Alex Ingerman, Martin Jaggi, Tara Javidi,
Peter Kairouz, Satyen Kale, Sai Praneeth Karimireddy, Jakub Konecny, Sanmi
Koyejo, Tian Li, Luyang Liu, Mehryar Mohri, Hang Qi, Sashank J. Reddi, Peter
Richtarik, Karan Singhal, Virginia Smith, Mahdi Soltanolkotabi, Weikang Song,
Ananda Theertha Suresh, Sebastian U. Stich, Ameet Talwalkar, Hongyi Wang,
Blake Woodworth, Shanshan Wu, Felix X. Yu, Honglin Yuan, Manzil Zaheer,
Mi Zhang, Tong Zhang, Chunxiang Zheng, Chen Zhu, and Wennan Zhu.

</span>
<span class="ltx_bibblock">A Field Guide to Federated Optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv:2107.06917 [cs]</em>, July 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2107.06917" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2107.06917</a>.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2018)</span>
<span class="ltx_bibblock">
Zhibo Wang, Mengkai Song, Zhifei Zhang, Yang Song, Qian Wang, and Hairong Qi.

</span>
<span class="ltx_bibblock">Beyond Inferring Class Representatives: User-Level Privacy
Leakage From Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv:1812.00535 [cs]</em>, December 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1812.00535" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1812.00535</a>.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2021)</span>
<span class="ltx_bibblock">
Hongxu Yin, Arun Mallya, Arash Vahdat, Jose M. Alvarez, Jan Kautz, and Pavlo
Molchanov.

</span>
<span class="ltx_bibblock">See Through Gradients: Image Batch Recovery via
GradInversion.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer
Vision and Pattern Recognition</em>, pp.  16337–16346, 2021.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://openaccess.thecvf.com/content/CVPR2021/html/Yin_See_Through_Gradients_Image_Batch_Recovery_via_GradInversion_CVPR_2021_paper.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openaccess.thecvf.com/content/CVPR2021/html/Yin_See_Through_Gradients_Image_Batch_Recovery_via_GradInversion_CVPR_2021_paper.html</a>.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zagoruyko &amp; Komodakis (2016)</span>
<span class="ltx_bibblock">
Sergey Zagoruyko and Nikos Komodakis.

</span>
<span class="ltx_bibblock">Wide Residual Networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">arXiv:1605.07146 [cs]</em>, May 2016.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1605.07146" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1605.07146</a>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2018)</span>
<span class="ltx_bibblock">
Richard Zhang, Phillip Isola, Alexei A. Efros, Eli Shechtman, and Oliver Wang.

</span>
<span class="ltx_bibblock">The Unreasonable Effectiveness of Deep Features as a
Perceptual Metric.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition</em>, pp.  586–595, 2018.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://openaccess.thecvf.com/content_cvpr_2018/html/Zhang_The_Unreasonable_Effectiveness_CVPR_2018_paper.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openaccess.thecvf.com/content_cvpr_2018/html/Zhang_The_Unreasonable_Effectiveness_CVPR_2018_paper.html</a>.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2020)</span>
<span class="ltx_bibblock">
Bo Zhao, Konda Reddy Mopuri, and Hakan Bilen.

</span>
<span class="ltx_bibblock">iDLG: Improved Deep Leakage from Gradients.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">arXiv:2001.02610 [cs, stat]</em>, January 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2001.02610" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2001.02610</a>.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu &amp; Blaschko (2021)</span>
<span class="ltx_bibblock">
Junyi Zhu and Matthew Blaschko.

</span>
<span class="ltx_bibblock">R-GAP: Recursive Gradient Attack on Privacy.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv:2010.07733 [cs]</em>, March 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2010.07733" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2010.07733</a>.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2019)</span>
<span class="ltx_bibblock">
Ligeng Zhu, Zhijian Liu, and Song Han.

</span>
<span class="ltx_bibblock">Deep Leakage from Gradients.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 32</em>,
pp.  14774–14784. Curran Associates, Inc., 2019.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="http://papers.nips.cc/paper/9617-deep-leakage-from-gradients.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://papers.nips.cc/paper/9617-deep-leakage-from-gradients.pdf</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Proof of Proposition 1</h3>

<div id="Thmpropositionx1" class="ltx_theorem ltx_theorem_proposition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmpropositionx1.1.1.1" class="ltx_text ltx_font_bold">Proposition</span></span><span id="Thmpropositionx1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmpropositionx1.p1" class="ltx_para ltx_noindent">
<p id="Thmpropositionx1.p1.3" class="ltx_p"><span id="Thmpropositionx1.p1.3.3" class="ltx_text ltx_font_italic">If the server knows the CDF (assumed to be continuous) of some quantity associated with user data that can be measured with a linear function <math id="Thmpropositionx1.p1.1.1.m1.1" class="ltx_Math" alttext="h:\mathbb{R}^{m}\rightarrow\mathbb{R}" display="inline"><semantics id="Thmpropositionx1.p1.1.1.m1.1a"><mrow id="Thmpropositionx1.p1.1.1.m1.1.1" xref="Thmpropositionx1.p1.1.1.m1.1.1.cmml"><mi id="Thmpropositionx1.p1.1.1.m1.1.1.2" xref="Thmpropositionx1.p1.1.1.m1.1.1.2.cmml">h</mi><mo lspace="0.278em" rspace="0.278em" id="Thmpropositionx1.p1.1.1.m1.1.1.1" xref="Thmpropositionx1.p1.1.1.m1.1.1.1.cmml">:</mo><mrow id="Thmpropositionx1.p1.1.1.m1.1.1.3" xref="Thmpropositionx1.p1.1.1.m1.1.1.3.cmml"><msup id="Thmpropositionx1.p1.1.1.m1.1.1.3.2" xref="Thmpropositionx1.p1.1.1.m1.1.1.3.2.cmml"><mi id="Thmpropositionx1.p1.1.1.m1.1.1.3.2.2" xref="Thmpropositionx1.p1.1.1.m1.1.1.3.2.2.cmml">ℝ</mi><mi id="Thmpropositionx1.p1.1.1.m1.1.1.3.2.3" xref="Thmpropositionx1.p1.1.1.m1.1.1.3.2.3.cmml">m</mi></msup><mo stretchy="false" id="Thmpropositionx1.p1.1.1.m1.1.1.3.1" xref="Thmpropositionx1.p1.1.1.m1.1.1.3.1.cmml">→</mo><mi id="Thmpropositionx1.p1.1.1.m1.1.1.3.3" xref="Thmpropositionx1.p1.1.1.m1.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmpropositionx1.p1.1.1.m1.1b"><apply id="Thmpropositionx1.p1.1.1.m1.1.1.cmml" xref="Thmpropositionx1.p1.1.1.m1.1.1"><ci id="Thmpropositionx1.p1.1.1.m1.1.1.1.cmml" xref="Thmpropositionx1.p1.1.1.m1.1.1.1">:</ci><ci id="Thmpropositionx1.p1.1.1.m1.1.1.2.cmml" xref="Thmpropositionx1.p1.1.1.m1.1.1.2">ℎ</ci><apply id="Thmpropositionx1.p1.1.1.m1.1.1.3.cmml" xref="Thmpropositionx1.p1.1.1.m1.1.1.3"><ci id="Thmpropositionx1.p1.1.1.m1.1.1.3.1.cmml" xref="Thmpropositionx1.p1.1.1.m1.1.1.3.1">→</ci><apply id="Thmpropositionx1.p1.1.1.m1.1.1.3.2.cmml" xref="Thmpropositionx1.p1.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="Thmpropositionx1.p1.1.1.m1.1.1.3.2.1.cmml" xref="Thmpropositionx1.p1.1.1.m1.1.1.3.2">superscript</csymbol><ci id="Thmpropositionx1.p1.1.1.m1.1.1.3.2.2.cmml" xref="Thmpropositionx1.p1.1.1.m1.1.1.3.2.2">ℝ</ci><ci id="Thmpropositionx1.p1.1.1.m1.1.1.3.2.3.cmml" xref="Thmpropositionx1.p1.1.1.m1.1.1.3.2.3">𝑚</ci></apply><ci id="Thmpropositionx1.p1.1.1.m1.1.1.3.3.cmml" xref="Thmpropositionx1.p1.1.1.m1.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmpropositionx1.p1.1.1.m1.1c">h:\mathbb{R}^{m}\rightarrow\mathbb{R}</annotation></semantics></math>, then for a batch size of <math id="Thmpropositionx1.p1.2.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="Thmpropositionx1.p1.2.2.m2.1a"><mi id="Thmpropositionx1.p1.2.2.m2.1.1" xref="Thmpropositionx1.p1.2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="Thmpropositionx1.p1.2.2.m2.1b"><ci id="Thmpropositionx1.p1.2.2.m2.1.1.cmml" xref="Thmpropositionx1.p1.2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmpropositionx1.p1.2.2.m2.1c">n</annotation></semantics></math>, and a number of imprint bins <math id="Thmpropositionx1.p1.3.3.m3.1" class="ltx_Math" alttext="k&gt;n&gt;2" display="inline"><semantics id="Thmpropositionx1.p1.3.3.m3.1a"><mrow id="Thmpropositionx1.p1.3.3.m3.1.1" xref="Thmpropositionx1.p1.3.3.m3.1.1.cmml"><mi id="Thmpropositionx1.p1.3.3.m3.1.1.2" xref="Thmpropositionx1.p1.3.3.m3.1.1.2.cmml">k</mi><mo id="Thmpropositionx1.p1.3.3.m3.1.1.3" xref="Thmpropositionx1.p1.3.3.m3.1.1.3.cmml">&gt;</mo><mi id="Thmpropositionx1.p1.3.3.m3.1.1.4" xref="Thmpropositionx1.p1.3.3.m3.1.1.4.cmml">n</mi><mo id="Thmpropositionx1.p1.3.3.m3.1.1.5" xref="Thmpropositionx1.p1.3.3.m3.1.1.5.cmml">&gt;</mo><mn id="Thmpropositionx1.p1.3.3.m3.1.1.6" xref="Thmpropositionx1.p1.3.3.m3.1.1.6.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmpropositionx1.p1.3.3.m3.1b"><apply id="Thmpropositionx1.p1.3.3.m3.1.1.cmml" xref="Thmpropositionx1.p1.3.3.m3.1.1"><and id="Thmpropositionx1.p1.3.3.m3.1.1a.cmml" xref="Thmpropositionx1.p1.3.3.m3.1.1"></and><apply id="Thmpropositionx1.p1.3.3.m3.1.1b.cmml" xref="Thmpropositionx1.p1.3.3.m3.1.1"><gt id="Thmpropositionx1.p1.3.3.m3.1.1.3.cmml" xref="Thmpropositionx1.p1.3.3.m3.1.1.3"></gt><ci id="Thmpropositionx1.p1.3.3.m3.1.1.2.cmml" xref="Thmpropositionx1.p1.3.3.m3.1.1.2">𝑘</ci><ci id="Thmpropositionx1.p1.3.3.m3.1.1.4.cmml" xref="Thmpropositionx1.p1.3.3.m3.1.1.4">𝑛</ci></apply><apply id="Thmpropositionx1.p1.3.3.m3.1.1c.cmml" xref="Thmpropositionx1.p1.3.3.m3.1.1"><gt id="Thmpropositionx1.p1.3.3.m3.1.1.5.cmml" xref="Thmpropositionx1.p1.3.3.m3.1.1.5"></gt><share href="#Thmpropositionx1.p1.3.3.m3.1.1.4.cmml" id="Thmpropositionx1.p1.3.3.m3.1.1d.cmml" xref="Thmpropositionx1.p1.3.3.m3.1.1"></share><cn type="integer" id="Thmpropositionx1.p1.3.3.m3.1.1.6.cmml" xref="Thmpropositionx1.p1.3.3.m3.1.1.6">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmpropositionx1.p1.3.3.m3.1c">k&gt;n&gt;2</annotation></semantics></math>, by using an appropriate combination of linear layer and ReLU activation, the server can expect to recover</span></p>
</div>
<div id="Thmpropositionx1.p2" class="ltx_para">
<table id="A1.Ex10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex10.m1.12" class="ltx_Math" alttext="\frac{1}{\binom{k+n-1}{k-1}}\bigg{[}\sum_{i=1}^{n-2}i\cdot\binom{k}{i}\cdot\bigg{(}\sum_{j=1}^{\lfloor\frac{n-i}{2}\rfloor}\binom{k-i}{j}\binom{n-i-j-1}{j-1}\bigg{)}\bigg{]}+r(n,k)" display="block"><semantics id="A1.Ex10.m1.12a"><mrow id="A1.Ex10.m1.12.12" xref="A1.Ex10.m1.12.12.cmml"><mrow id="A1.Ex10.m1.12.12.1" xref="A1.Ex10.m1.12.12.1.cmml"><mfrac id="A1.Ex10.m1.2.2" xref="A1.Ex10.m1.2.2.cmml"><mn id="A1.Ex10.m1.2.2.4" xref="A1.Ex10.m1.2.2.4.cmml">1</mn><mrow id="A1.Ex10.m1.2.2.2.4" xref="A1.Ex10.m1.2.2.2.3.cmml"><mo id="A1.Ex10.m1.2.2.2.4.1" xref="A1.Ex10.m1.2.2.2.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.Ex10.m1.2.2.2.2.2.2" xref="A1.Ex10.m1.2.2.2.3.cmml"><mrow id="A1.Ex10.m1.1.1.1.1.1.1.1.1" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex10.m1.1.1.1.1.1.1.1.1.3" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.1" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mi id="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></mrow><mo id="A1.Ex10.m1.1.1.1.1.1.1.1.1.2" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mn id="A1.Ex10.m1.1.1.1.1.1.1.1.1.4" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.4.cmml">1</mn></mrow><mrow id="A1.Ex10.m1.2.2.2.2.2.2.2.1" xref="A1.Ex10.m1.2.2.2.2.2.2.2.1.cmml"><mi id="A1.Ex10.m1.2.2.2.2.2.2.2.1.3" xref="A1.Ex10.m1.2.2.2.2.2.2.2.1.3.cmml">k</mi><mo id="A1.Ex10.m1.2.2.2.2.2.2.2.1.2" xref="A1.Ex10.m1.2.2.2.2.2.2.2.1.2.cmml">−</mo><mn id="A1.Ex10.m1.2.2.2.2.2.2.2.1.4" xref="A1.Ex10.m1.2.2.2.2.2.2.2.1.4.cmml">1</mn></mrow></mfrac><mo id="A1.Ex10.m1.2.2.2.4.2" xref="A1.Ex10.m1.2.2.2.3.1.cmml">)</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="A1.Ex10.m1.12.12.1.2" xref="A1.Ex10.m1.12.12.1.2.cmml">​</mo><mrow id="A1.Ex10.m1.12.12.1.1.1" xref="A1.Ex10.m1.12.12.1.1.2.cmml"><mo maxsize="210%" minsize="210%" id="A1.Ex10.m1.12.12.1.1.1.2" xref="A1.Ex10.m1.12.12.1.1.2.1.cmml">[</mo><mrow id="A1.Ex10.m1.12.12.1.1.1.1" xref="A1.Ex10.m1.12.12.1.1.1.1.cmml"><munderover id="A1.Ex10.m1.12.12.1.1.1.1.2" xref="A1.Ex10.m1.12.12.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" id="A1.Ex10.m1.12.12.1.1.1.1.2.2.2" xref="A1.Ex10.m1.12.12.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.Ex10.m1.12.12.1.1.1.1.2.2.3" xref="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.cmml"><mi id="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.2" xref="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.1" xref="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.3" xref="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="A1.Ex10.m1.12.12.1.1.1.1.2.3" xref="A1.Ex10.m1.12.12.1.1.1.1.2.3.cmml"><mi id="A1.Ex10.m1.12.12.1.1.1.1.2.3.2" xref="A1.Ex10.m1.12.12.1.1.1.1.2.3.2.cmml">n</mi><mo id="A1.Ex10.m1.12.12.1.1.1.1.2.3.1" xref="A1.Ex10.m1.12.12.1.1.1.1.2.3.1.cmml">−</mo><mn id="A1.Ex10.m1.12.12.1.1.1.1.2.3.3" xref="A1.Ex10.m1.12.12.1.1.1.1.2.3.3.cmml">2</mn></mrow></munderover><mrow id="A1.Ex10.m1.12.12.1.1.1.1.1" xref="A1.Ex10.m1.12.12.1.1.1.1.1.cmml"><mi id="A1.Ex10.m1.12.12.1.1.1.1.1.3" xref="A1.Ex10.m1.12.12.1.1.1.1.1.3.cmml">i</mi><mo lspace="0.222em" rspace="0.222em" id="A1.Ex10.m1.12.12.1.1.1.1.1.2" xref="A1.Ex10.m1.12.12.1.1.1.1.1.2.cmml">⋅</mo><mrow id="A1.Ex10.m1.4.4.4" xref="A1.Ex10.m1.4.4.3.cmml"><mo id="A1.Ex10.m1.4.4.4.1" xref="A1.Ex10.m1.4.4.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.Ex10.m1.4.4.2.2" xref="A1.Ex10.m1.4.4.3.cmml"><mi id="A1.Ex10.m1.3.3.1.1.1.1" xref="A1.Ex10.m1.3.3.1.1.1.1.cmml">k</mi><mi id="A1.Ex10.m1.4.4.2.2.2.1" xref="A1.Ex10.m1.4.4.2.2.2.1.cmml">i</mi></mfrac><mo rspace="0.055em" id="A1.Ex10.m1.4.4.4.2" xref="A1.Ex10.m1.4.4.3.1.cmml">)</mo></mrow><mo rspace="0.222em" id="A1.Ex10.m1.12.12.1.1.1.1.1.2a" xref="A1.Ex10.m1.12.12.1.1.1.1.1.2.cmml">⋅</mo><mrow id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.cmml"><mo maxsize="210%" minsize="210%" id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.2" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.cmml"><munderover id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mrow id="A1.Ex10.m1.9.9.1.3" xref="A1.Ex10.m1.9.9.1.2.cmml"><mo stretchy="false" id="A1.Ex10.m1.9.9.1.3.1" xref="A1.Ex10.m1.9.9.1.2.1.cmml">⌊</mo><mfrac id="A1.Ex10.m1.9.9.1.1" xref="A1.Ex10.m1.9.9.1.1.cmml"><mrow id="A1.Ex10.m1.9.9.1.1.2" xref="A1.Ex10.m1.9.9.1.1.2.cmml"><mi id="A1.Ex10.m1.9.9.1.1.2.2" xref="A1.Ex10.m1.9.9.1.1.2.2.cmml">n</mi><mo id="A1.Ex10.m1.9.9.1.1.2.1" xref="A1.Ex10.m1.9.9.1.1.2.1.cmml">−</mo><mi id="A1.Ex10.m1.9.9.1.1.2.3" xref="A1.Ex10.m1.9.9.1.1.2.3.cmml">i</mi></mrow><mn id="A1.Ex10.m1.9.9.1.1.3" xref="A1.Ex10.m1.9.9.1.1.3.cmml">2</mn></mfrac><mo stretchy="false" id="A1.Ex10.m1.9.9.1.3.2" xref="A1.Ex10.m1.9.9.1.2.1.cmml">⌋</mo></mrow></munderover><mrow id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.2" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.2.cmml"><mrow id="A1.Ex10.m1.6.6.4" xref="A1.Ex10.m1.6.6.3.cmml"><mo id="A1.Ex10.m1.6.6.4.1" xref="A1.Ex10.m1.6.6.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.Ex10.m1.6.6.2.2" xref="A1.Ex10.m1.6.6.3.cmml"><mrow id="A1.Ex10.m1.5.5.1.1.1.1" xref="A1.Ex10.m1.5.5.1.1.1.1.cmml"><mi id="A1.Ex10.m1.5.5.1.1.1.1.3" xref="A1.Ex10.m1.5.5.1.1.1.1.3.cmml">k</mi><mo id="A1.Ex10.m1.5.5.1.1.1.1.2" xref="A1.Ex10.m1.5.5.1.1.1.1.2.cmml">−</mo><mi id="A1.Ex10.m1.5.5.1.1.1.1.4" xref="A1.Ex10.m1.5.5.1.1.1.1.4.cmml">i</mi></mrow><mi id="A1.Ex10.m1.6.6.2.2.2.1" xref="A1.Ex10.m1.6.6.2.2.2.1.cmml">j</mi></mfrac><mo id="A1.Ex10.m1.6.6.4.2" xref="A1.Ex10.m1.6.6.3.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.2.1" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="A1.Ex10.m1.8.8.4" xref="A1.Ex10.m1.8.8.3.cmml"><mo id="A1.Ex10.m1.8.8.4.1" xref="A1.Ex10.m1.8.8.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.Ex10.m1.8.8.2.2" xref="A1.Ex10.m1.8.8.3.cmml"><mrow id="A1.Ex10.m1.7.7.1.1.1.1" xref="A1.Ex10.m1.7.7.1.1.1.1.cmml"><mi id="A1.Ex10.m1.7.7.1.1.1.1.3" xref="A1.Ex10.m1.7.7.1.1.1.1.3.cmml">n</mi><mo id="A1.Ex10.m1.7.7.1.1.1.1.2" xref="A1.Ex10.m1.7.7.1.1.1.1.2.cmml">−</mo><mi id="A1.Ex10.m1.7.7.1.1.1.1.4" xref="A1.Ex10.m1.7.7.1.1.1.1.4.cmml">i</mi><mo id="A1.Ex10.m1.7.7.1.1.1.1.2a" xref="A1.Ex10.m1.7.7.1.1.1.1.2.cmml">−</mo><mi id="A1.Ex10.m1.7.7.1.1.1.1.5" xref="A1.Ex10.m1.7.7.1.1.1.1.5.cmml">j</mi><mo id="A1.Ex10.m1.7.7.1.1.1.1.2b" xref="A1.Ex10.m1.7.7.1.1.1.1.2.cmml">−</mo><mn id="A1.Ex10.m1.7.7.1.1.1.1.6" xref="A1.Ex10.m1.7.7.1.1.1.1.6.cmml">1</mn></mrow><mrow id="A1.Ex10.m1.8.8.2.2.2.1" xref="A1.Ex10.m1.8.8.2.2.2.1.cmml"><mi id="A1.Ex10.m1.8.8.2.2.2.1.3" xref="A1.Ex10.m1.8.8.2.2.2.1.3.cmml">j</mi><mo id="A1.Ex10.m1.8.8.2.2.2.1.2" xref="A1.Ex10.m1.8.8.2.2.2.1.2.cmml">−</mo><mn id="A1.Ex10.m1.8.8.2.2.2.1.4" xref="A1.Ex10.m1.8.8.2.2.2.1.4.cmml">1</mn></mrow></mfrac><mo id="A1.Ex10.m1.8.8.4.2" xref="A1.Ex10.m1.8.8.3.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="210%" minsize="210%" id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.3" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="210%" minsize="210%" id="A1.Ex10.m1.12.12.1.1.1.3" xref="A1.Ex10.m1.12.12.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex10.m1.12.12.2" xref="A1.Ex10.m1.12.12.2.cmml">+</mo><mrow id="A1.Ex10.m1.12.12.3" xref="A1.Ex10.m1.12.12.3.cmml"><mi id="A1.Ex10.m1.12.12.3.2" xref="A1.Ex10.m1.12.12.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.Ex10.m1.12.12.3.1" xref="A1.Ex10.m1.12.12.3.1.cmml">​</mo><mrow id="A1.Ex10.m1.12.12.3.3.2" xref="A1.Ex10.m1.12.12.3.3.1.cmml"><mo stretchy="false" id="A1.Ex10.m1.12.12.3.3.2.1" xref="A1.Ex10.m1.12.12.3.3.1.cmml">(</mo><mi id="A1.Ex10.m1.10.10" xref="A1.Ex10.m1.10.10.cmml">n</mi><mo id="A1.Ex10.m1.12.12.3.3.2.2" xref="A1.Ex10.m1.12.12.3.3.1.cmml">,</mo><mi id="A1.Ex10.m1.11.11" xref="A1.Ex10.m1.11.11.cmml">k</mi><mo stretchy="false" id="A1.Ex10.m1.12.12.3.3.2.3" xref="A1.Ex10.m1.12.12.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex10.m1.12b"><apply id="A1.Ex10.m1.12.12.cmml" xref="A1.Ex10.m1.12.12"><plus id="A1.Ex10.m1.12.12.2.cmml" xref="A1.Ex10.m1.12.12.2"></plus><apply id="A1.Ex10.m1.12.12.1.cmml" xref="A1.Ex10.m1.12.12.1"><times id="A1.Ex10.m1.12.12.1.2.cmml" xref="A1.Ex10.m1.12.12.1.2"></times><apply id="A1.Ex10.m1.2.2.cmml" xref="A1.Ex10.m1.2.2"><divide id="A1.Ex10.m1.2.2.3.cmml" xref="A1.Ex10.m1.2.2"></divide><cn type="integer" id="A1.Ex10.m1.2.2.4.cmml" xref="A1.Ex10.m1.2.2.4">1</cn><apply id="A1.Ex10.m1.2.2.2.3.cmml" xref="A1.Ex10.m1.2.2.2.4"><csymbol cd="latexml" id="A1.Ex10.m1.2.2.2.3.1.cmml" xref="A1.Ex10.m1.2.2.2.4.1">binomial</csymbol><apply id="A1.Ex10.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1"><minus id="A1.Ex10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.2"></minus><apply id="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.3"><plus id="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.2">𝑘</ci><ci id="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply><cn type="integer" id="A1.Ex10.m1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex10.m1.1.1.1.1.1.1.1.1.4">1</cn></apply><apply id="A1.Ex10.m1.2.2.2.2.2.2.2.1.cmml" xref="A1.Ex10.m1.2.2.2.2.2.2.2.1"><minus id="A1.Ex10.m1.2.2.2.2.2.2.2.1.2.cmml" xref="A1.Ex10.m1.2.2.2.2.2.2.2.1.2"></minus><ci id="A1.Ex10.m1.2.2.2.2.2.2.2.1.3.cmml" xref="A1.Ex10.m1.2.2.2.2.2.2.2.1.3">𝑘</ci><cn type="integer" id="A1.Ex10.m1.2.2.2.2.2.2.2.1.4.cmml" xref="A1.Ex10.m1.2.2.2.2.2.2.2.1.4">1</cn></apply></apply></apply><apply id="A1.Ex10.m1.12.12.1.1.2.cmml" xref="A1.Ex10.m1.12.12.1.1.1"><csymbol cd="latexml" id="A1.Ex10.m1.12.12.1.1.2.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex10.m1.12.12.1.1.1.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1"><apply id="A1.Ex10.m1.12.12.1.1.1.1.2.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex10.m1.12.12.1.1.1.1.2.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2">superscript</csymbol><apply id="A1.Ex10.m1.12.12.1.1.1.1.2.2.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex10.m1.12.12.1.1.1.1.2.2.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2">subscript</csymbol><sum id="A1.Ex10.m1.12.12.1.1.1.1.2.2.2.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2.2.2"></sum><apply id="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2.2.3"><eq id="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.1"></eq><ci id="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.2.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.3.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="A1.Ex10.m1.12.12.1.1.1.1.2.3.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2.3"><minus id="A1.Ex10.m1.12.12.1.1.1.1.2.3.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2.3.1"></minus><ci id="A1.Ex10.m1.12.12.1.1.1.1.2.3.2.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2.3.2">𝑛</ci><cn type="integer" id="A1.Ex10.m1.12.12.1.1.1.1.2.3.3.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="A1.Ex10.m1.12.12.1.1.1.1.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1"><ci id="A1.Ex10.m1.12.12.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.2">⋅</ci><ci id="A1.Ex10.m1.12.12.1.1.1.1.1.3.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.3">𝑖</ci><apply id="A1.Ex10.m1.4.4.3.cmml" xref="A1.Ex10.m1.4.4.4"><csymbol cd="latexml" id="A1.Ex10.m1.4.4.3.1.cmml" xref="A1.Ex10.m1.4.4.4.1">binomial</csymbol><ci id="A1.Ex10.m1.3.3.1.1.1.1.cmml" xref="A1.Ex10.m1.3.3.1.1.1.1">𝑘</ci><ci id="A1.Ex10.m1.4.4.2.2.2.1.cmml" xref="A1.Ex10.m1.4.4.2.2.2.1">𝑖</ci></apply><apply id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1"><apply id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3"><eq id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.Ex10.m1.9.9.1.2.cmml" xref="A1.Ex10.m1.9.9.1.3"><floor id="A1.Ex10.m1.9.9.1.2.1.cmml" xref="A1.Ex10.m1.9.9.1.3.1"></floor><apply id="A1.Ex10.m1.9.9.1.1.cmml" xref="A1.Ex10.m1.9.9.1.1"><divide id="A1.Ex10.m1.9.9.1.1.1.cmml" xref="A1.Ex10.m1.9.9.1.1"></divide><apply id="A1.Ex10.m1.9.9.1.1.2.cmml" xref="A1.Ex10.m1.9.9.1.1.2"><minus id="A1.Ex10.m1.9.9.1.1.2.1.cmml" xref="A1.Ex10.m1.9.9.1.1.2.1"></minus><ci id="A1.Ex10.m1.9.9.1.1.2.2.cmml" xref="A1.Ex10.m1.9.9.1.1.2.2">𝑛</ci><ci id="A1.Ex10.m1.9.9.1.1.2.3.cmml" xref="A1.Ex10.m1.9.9.1.1.2.3">𝑖</ci></apply><cn type="integer" id="A1.Ex10.m1.9.9.1.1.3.cmml" xref="A1.Ex10.m1.9.9.1.1.3">2</cn></apply></apply></apply><apply id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.2"><times id="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex10.m1.12.12.1.1.1.1.1.1.1.1.2.1"></times><apply id="A1.Ex10.m1.6.6.3.cmml" xref="A1.Ex10.m1.6.6.4"><csymbol cd="latexml" id="A1.Ex10.m1.6.6.3.1.cmml" xref="A1.Ex10.m1.6.6.4.1">binomial</csymbol><apply id="A1.Ex10.m1.5.5.1.1.1.1.cmml" xref="A1.Ex10.m1.5.5.1.1.1.1"><minus id="A1.Ex10.m1.5.5.1.1.1.1.2.cmml" xref="A1.Ex10.m1.5.5.1.1.1.1.2"></minus><ci id="A1.Ex10.m1.5.5.1.1.1.1.3.cmml" xref="A1.Ex10.m1.5.5.1.1.1.1.3">𝑘</ci><ci id="A1.Ex10.m1.5.5.1.1.1.1.4.cmml" xref="A1.Ex10.m1.5.5.1.1.1.1.4">𝑖</ci></apply><ci id="A1.Ex10.m1.6.6.2.2.2.1.cmml" xref="A1.Ex10.m1.6.6.2.2.2.1">𝑗</ci></apply><apply id="A1.Ex10.m1.8.8.3.cmml" xref="A1.Ex10.m1.8.8.4"><csymbol cd="latexml" id="A1.Ex10.m1.8.8.3.1.cmml" xref="A1.Ex10.m1.8.8.4.1">binomial</csymbol><apply id="A1.Ex10.m1.7.7.1.1.1.1.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1"><minus id="A1.Ex10.m1.7.7.1.1.1.1.2.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.2"></minus><ci id="A1.Ex10.m1.7.7.1.1.1.1.3.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.3">𝑛</ci><ci id="A1.Ex10.m1.7.7.1.1.1.1.4.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.4">𝑖</ci><ci id="A1.Ex10.m1.7.7.1.1.1.1.5.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.5">𝑗</ci><cn type="integer" id="A1.Ex10.m1.7.7.1.1.1.1.6.cmml" xref="A1.Ex10.m1.7.7.1.1.1.1.6">1</cn></apply><apply id="A1.Ex10.m1.8.8.2.2.2.1.cmml" xref="A1.Ex10.m1.8.8.2.2.2.1"><minus id="A1.Ex10.m1.8.8.2.2.2.1.2.cmml" xref="A1.Ex10.m1.8.8.2.2.2.1.2"></minus><ci id="A1.Ex10.m1.8.8.2.2.2.1.3.cmml" xref="A1.Ex10.m1.8.8.2.2.2.1.3">𝑗</ci><cn type="integer" id="A1.Ex10.m1.8.8.2.2.2.1.4.cmml" xref="A1.Ex10.m1.8.8.2.2.2.1.4">1</cn></apply></apply></apply></apply></apply></apply></apply></apply><apply id="A1.Ex10.m1.12.12.3.cmml" xref="A1.Ex10.m1.12.12.3"><times id="A1.Ex10.m1.12.12.3.1.cmml" xref="A1.Ex10.m1.12.12.3.1"></times><ci id="A1.Ex10.m1.12.12.3.2.cmml" xref="A1.Ex10.m1.12.12.3.2">𝑟</ci><interval closure="open" id="A1.Ex10.m1.12.12.3.3.1.cmml" xref="A1.Ex10.m1.12.12.3.3.2"><ci id="A1.Ex10.m1.10.10.cmml" xref="A1.Ex10.m1.10.10">𝑛</ci><ci id="A1.Ex10.m1.11.11.cmml" xref="A1.Ex10.m1.11.11">𝑘</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex10.m1.12c">\frac{1}{\binom{k+n-1}{k-1}}\bigg{[}\sum_{i=1}^{n-2}i\cdot\binom{k}{i}\cdot\bigg{(}\sum_{j=1}^{\lfloor\frac{n-i}{2}\rfloor}\binom{k-i}{j}\binom{n-i-j-1}{j-1}\bigg{)}\bigg{]}+r(n,k)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="Thmpropositionx1.p2.2" class="ltx_p"><span id="Thmpropositionx1.p2.2.2" class="ltx_text ltx_font_italic">amount of user data (where the data is in <math id="Thmpropositionx1.p2.1.1.m1.1" class="ltx_Math" alttext="\mathbb{R}^{m}" display="inline"><semantics id="Thmpropositionx1.p2.1.1.m1.1a"><msup id="Thmpropositionx1.p2.1.1.m1.1.1" xref="Thmpropositionx1.p2.1.1.m1.1.1.cmml"><mi id="Thmpropositionx1.p2.1.1.m1.1.1.2" xref="Thmpropositionx1.p2.1.1.m1.1.1.2.cmml">ℝ</mi><mi id="Thmpropositionx1.p2.1.1.m1.1.1.3" xref="Thmpropositionx1.p2.1.1.m1.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="Thmpropositionx1.p2.1.1.m1.1b"><apply id="Thmpropositionx1.p2.1.1.m1.1.1.cmml" xref="Thmpropositionx1.p2.1.1.m1.1.1"><csymbol cd="ambiguous" id="Thmpropositionx1.p2.1.1.m1.1.1.1.cmml" xref="Thmpropositionx1.p2.1.1.m1.1.1">superscript</csymbol><ci id="Thmpropositionx1.p2.1.1.m1.1.1.2.cmml" xref="Thmpropositionx1.p2.1.1.m1.1.1.2">ℝ</ci><ci id="Thmpropositionx1.p2.1.1.m1.1.1.3.cmml" xref="Thmpropositionx1.p2.1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmpropositionx1.p2.1.1.m1.1c">\mathbb{R}^{m}</annotation></semantics></math>) perfectly. Note: <math id="Thmpropositionx1.p2.2.2.m2.2" class="ltx_Math" alttext="r(n,k)" display="inline"><semantics id="Thmpropositionx1.p2.2.2.m2.2a"><mrow id="Thmpropositionx1.p2.2.2.m2.2.3" xref="Thmpropositionx1.p2.2.2.m2.2.3.cmml"><mi id="Thmpropositionx1.p2.2.2.m2.2.3.2" xref="Thmpropositionx1.p2.2.2.m2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="Thmpropositionx1.p2.2.2.m2.2.3.1" xref="Thmpropositionx1.p2.2.2.m2.2.3.1.cmml">​</mo><mrow id="Thmpropositionx1.p2.2.2.m2.2.3.3.2" xref="Thmpropositionx1.p2.2.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="Thmpropositionx1.p2.2.2.m2.2.3.3.2.1" xref="Thmpropositionx1.p2.2.2.m2.2.3.3.1.cmml">(</mo><mi id="Thmpropositionx1.p2.2.2.m2.1.1" xref="Thmpropositionx1.p2.2.2.m2.1.1.cmml">n</mi><mo id="Thmpropositionx1.p2.2.2.m2.2.3.3.2.2" xref="Thmpropositionx1.p2.2.2.m2.2.3.3.1.cmml">,</mo><mi id="Thmpropositionx1.p2.2.2.m2.2.2" xref="Thmpropositionx1.p2.2.2.m2.2.2.cmml">k</mi><mo stretchy="false" id="Thmpropositionx1.p2.2.2.m2.2.3.3.2.3" xref="Thmpropositionx1.p2.2.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmpropositionx1.p2.2.2.m2.2b"><apply id="Thmpropositionx1.p2.2.2.m2.2.3.cmml" xref="Thmpropositionx1.p2.2.2.m2.2.3"><times id="Thmpropositionx1.p2.2.2.m2.2.3.1.cmml" xref="Thmpropositionx1.p2.2.2.m2.2.3.1"></times><ci id="Thmpropositionx1.p2.2.2.m2.2.3.2.cmml" xref="Thmpropositionx1.p2.2.2.m2.2.3.2">𝑟</ci><interval closure="open" id="Thmpropositionx1.p2.2.2.m2.2.3.3.1.cmml" xref="Thmpropositionx1.p2.2.2.m2.2.3.3.2"><ci id="Thmpropositionx1.p2.2.2.m2.1.1.cmml" xref="Thmpropositionx1.p2.2.2.m2.1.1">𝑛</ci><ci id="Thmpropositionx1.p2.2.2.m2.2.2.cmml" xref="Thmpropositionx1.p2.2.2.m2.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmpropositionx1.p2.2.2.m2.2c">r(n,k)</annotation></semantics></math> is a correction term (see proof for expression).</span></p>
</div>
</div>
<div id="A1.SS1.10" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="A1.SS1.1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS1.1.p1.5" class="ltx_p">By construction of the imprint module, given a random sample (batch) <math id="A1.SS1.1.p1.1.m1.3" class="ltx_Math" alttext="X_{1},\dots,X_{n}" display="inline"><semantics id="A1.SS1.1.p1.1.m1.3a"><mrow id="A1.SS1.1.p1.1.m1.3.3.2" xref="A1.SS1.1.p1.1.m1.3.3.3.cmml"><msub id="A1.SS1.1.p1.1.m1.2.2.1.1" xref="A1.SS1.1.p1.1.m1.2.2.1.1.cmml"><mi id="A1.SS1.1.p1.1.m1.2.2.1.1.2" xref="A1.SS1.1.p1.1.m1.2.2.1.1.2.cmml">X</mi><mn id="A1.SS1.1.p1.1.m1.2.2.1.1.3" xref="A1.SS1.1.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="A1.SS1.1.p1.1.m1.3.3.2.3" xref="A1.SS1.1.p1.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="A1.SS1.1.p1.1.m1.1.1" xref="A1.SS1.1.p1.1.m1.1.1.cmml">…</mi><mo id="A1.SS1.1.p1.1.m1.3.3.2.4" xref="A1.SS1.1.p1.1.m1.3.3.3.cmml">,</mo><msub id="A1.SS1.1.p1.1.m1.3.3.2.2" xref="A1.SS1.1.p1.1.m1.3.3.2.2.cmml"><mi id="A1.SS1.1.p1.1.m1.3.3.2.2.2" xref="A1.SS1.1.p1.1.m1.3.3.2.2.2.cmml">X</mi><mi id="A1.SS1.1.p1.1.m1.3.3.2.2.3" xref="A1.SS1.1.p1.1.m1.3.3.2.2.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.1.m1.3b"><list id="A1.SS1.1.p1.1.m1.3.3.3.cmml" xref="A1.SS1.1.p1.1.m1.3.3.2"><apply id="A1.SS1.1.p1.1.m1.2.2.1.1.cmml" xref="A1.SS1.1.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS1.1.p1.1.m1.2.2.1.1.1.cmml" xref="A1.SS1.1.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="A1.SS1.1.p1.1.m1.2.2.1.1.2.cmml" xref="A1.SS1.1.p1.1.m1.2.2.1.1.2">𝑋</ci><cn type="integer" id="A1.SS1.1.p1.1.m1.2.2.1.1.3.cmml" xref="A1.SS1.1.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="A1.SS1.1.p1.1.m1.1.1.cmml" xref="A1.SS1.1.p1.1.m1.1.1">…</ci><apply id="A1.SS1.1.p1.1.m1.3.3.2.2.cmml" xref="A1.SS1.1.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS1.1.p1.1.m1.3.3.2.2.1.cmml" xref="A1.SS1.1.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="A1.SS1.1.p1.1.m1.3.3.2.2.2.cmml" xref="A1.SS1.1.p1.1.m1.3.3.2.2.2">𝑋</ci><ci id="A1.SS1.1.p1.1.m1.3.3.2.2.3.cmml" xref="A1.SS1.1.p1.1.m1.3.3.2.2.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.1.m1.3c">X_{1},\dots,X_{n}</annotation></semantics></math> (iid) the server perfectly recovers data whenever an imprint bin has exactly <math id="A1.SS1.1.p1.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.SS1.1.p1.2.m2.1a"><mn id="A1.SS1.1.p1.2.m2.1.1" xref="A1.SS1.1.p1.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.2.m2.1b"><cn type="integer" id="A1.SS1.1.p1.2.m2.1.1.cmml" xref="A1.SS1.1.p1.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.2.m2.1c">1</annotation></semantics></math> element of the batch. Because we know the CDFs, we can create partitions of equal mass corresponding to imprint bins <math id="A1.SS1.1.p1.3.m3.2" class="ltx_Math" alttext="\{b_{j}\}=\{[a_{j},b_{j}]\}" display="inline"><semantics id="A1.SS1.1.p1.3.m3.2a"><mrow id="A1.SS1.1.p1.3.m3.2.2" xref="A1.SS1.1.p1.3.m3.2.2.cmml"><mrow id="A1.SS1.1.p1.3.m3.1.1.1.1" xref="A1.SS1.1.p1.3.m3.1.1.1.2.cmml"><mo stretchy="false" id="A1.SS1.1.p1.3.m3.1.1.1.1.2" xref="A1.SS1.1.p1.3.m3.1.1.1.2.cmml">{</mo><msub id="A1.SS1.1.p1.3.m3.1.1.1.1.1" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.cmml"><mi id="A1.SS1.1.p1.3.m3.1.1.1.1.1.2" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.2.cmml">b</mi><mi id="A1.SS1.1.p1.3.m3.1.1.1.1.1.3" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="A1.SS1.1.p1.3.m3.1.1.1.1.3" xref="A1.SS1.1.p1.3.m3.1.1.1.2.cmml">}</mo></mrow><mo id="A1.SS1.1.p1.3.m3.2.2.3" xref="A1.SS1.1.p1.3.m3.2.2.3.cmml">=</mo><mrow id="A1.SS1.1.p1.3.m3.2.2.2.1" xref="A1.SS1.1.p1.3.m3.2.2.2.2.cmml"><mo stretchy="false" id="A1.SS1.1.p1.3.m3.2.2.2.1.2" xref="A1.SS1.1.p1.3.m3.2.2.2.2.cmml">{</mo><mrow id="A1.SS1.1.p1.3.m3.2.2.2.1.1.2" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.3.cmml"><mo stretchy="false" id="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.3" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.3.cmml">[</mo><msub id="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1.cmml"><mi id="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1.2" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1.2.cmml">a</mi><mi id="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1.3" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.4" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.3.cmml">,</mo><msub id="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2.cmml"><mi id="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2.2" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2.2.cmml">b</mi><mi id="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2.3" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.5" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="A1.SS1.1.p1.3.m3.2.2.2.1.3" xref="A1.SS1.1.p1.3.m3.2.2.2.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.3.m3.2b"><apply id="A1.SS1.1.p1.3.m3.2.2.cmml" xref="A1.SS1.1.p1.3.m3.2.2"><eq id="A1.SS1.1.p1.3.m3.2.2.3.cmml" xref="A1.SS1.1.p1.3.m3.2.2.3"></eq><set id="A1.SS1.1.p1.3.m3.1.1.1.2.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1"><apply id="A1.SS1.1.p1.3.m3.1.1.1.1.1.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.1.p1.3.m3.1.1.1.1.1.1.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.1.p1.3.m3.1.1.1.1.1.2.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.2">𝑏</ci><ci id="A1.SS1.1.p1.3.m3.1.1.1.1.1.3.cmml" xref="A1.SS1.1.p1.3.m3.1.1.1.1.1.3">𝑗</ci></apply></set><set id="A1.SS1.1.p1.3.m3.2.2.2.2.cmml" xref="A1.SS1.1.p1.3.m3.2.2.2.1"><interval closure="closed" id="A1.SS1.1.p1.3.m3.2.2.2.1.1.3.cmml" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.2"><apply id="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1.cmml" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1.1.cmml" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1">subscript</csymbol><ci id="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1.2.cmml" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1.2">𝑎</ci><ci id="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1.3.cmml" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.1.1.3">𝑗</ci></apply><apply id="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2.cmml" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2.1.cmml" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2">subscript</csymbol><ci id="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2.2.cmml" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2.2">𝑏</ci><ci id="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2.3.cmml" xref="A1.SS1.1.p1.3.m3.2.2.2.1.1.2.2.3">𝑗</ci></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.3.m3.2c">\{b_{j}\}=\{[a_{j},b_{j}]\}</annotation></semantics></math> where <math id="A1.SS1.1.p1.4.m4.1" class="ltx_Math" alttext="P(X_{i}\in[a_{j},b_{j}])=1/k" display="inline"><semantics id="A1.SS1.1.p1.4.m4.1a"><mrow id="A1.SS1.1.p1.4.m4.1.1" xref="A1.SS1.1.p1.4.m4.1.1.cmml"><mrow id="A1.SS1.1.p1.4.m4.1.1.1" xref="A1.SS1.1.p1.4.m4.1.1.1.cmml"><mi id="A1.SS1.1.p1.4.m4.1.1.1.3" xref="A1.SS1.1.p1.4.m4.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="A1.SS1.1.p1.4.m4.1.1.1.2" xref="A1.SS1.1.p1.4.m4.1.1.1.2.cmml">​</mo><mrow id="A1.SS1.1.p1.4.m4.1.1.1.1.1" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS1.1.p1.4.m4.1.1.1.1.1.2" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.cmml"><msub id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4.cmml"><mi id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4.2" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4.2.cmml">X</mi><mi id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4.3" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4.3.cmml">i</mi></msub><mo id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.3" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.3.cmml">∈</mo><mrow id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.3" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.3.cmml">[</mo><msub id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1.2" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mi id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1.3" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.4" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2.2" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2.2.cmml">b</mi><mi id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2.3" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.5" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="A1.SS1.1.p1.4.m4.1.1.1.1.1.3" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS1.1.p1.4.m4.1.1.2" xref="A1.SS1.1.p1.4.m4.1.1.2.cmml">=</mo><mrow id="A1.SS1.1.p1.4.m4.1.1.3" xref="A1.SS1.1.p1.4.m4.1.1.3.cmml"><mn id="A1.SS1.1.p1.4.m4.1.1.3.2" xref="A1.SS1.1.p1.4.m4.1.1.3.2.cmml">1</mn><mo id="A1.SS1.1.p1.4.m4.1.1.3.1" xref="A1.SS1.1.p1.4.m4.1.1.3.1.cmml">/</mo><mi id="A1.SS1.1.p1.4.m4.1.1.3.3" xref="A1.SS1.1.p1.4.m4.1.1.3.3.cmml">k</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.4.m4.1b"><apply id="A1.SS1.1.p1.4.m4.1.1.cmml" xref="A1.SS1.1.p1.4.m4.1.1"><eq id="A1.SS1.1.p1.4.m4.1.1.2.cmml" xref="A1.SS1.1.p1.4.m4.1.1.2"></eq><apply id="A1.SS1.1.p1.4.m4.1.1.1.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1"><times id="A1.SS1.1.p1.4.m4.1.1.1.2.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.2"></times><ci id="A1.SS1.1.p1.4.m4.1.1.1.3.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.3">𝑃</ci><apply id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1"><in id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.3"></in><apply id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4.1.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4">subscript</csymbol><ci id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4.2.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4.2">𝑋</ci><ci id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4.3.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.4.3">𝑖</ci></apply><interval closure="closed" id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.3.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2"><apply id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2.2">𝑏</ci><ci id="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.SS1.1.p1.4.m4.1.1.1.1.1.1.2.2.2.3">𝑗</ci></apply></interval></apply></apply><apply id="A1.SS1.1.p1.4.m4.1.1.3.cmml" xref="A1.SS1.1.p1.4.m4.1.1.3"><divide id="A1.SS1.1.p1.4.m4.1.1.3.1.cmml" xref="A1.SS1.1.p1.4.m4.1.1.3.1"></divide><cn type="integer" id="A1.SS1.1.p1.4.m4.1.1.3.2.cmml" xref="A1.SS1.1.p1.4.m4.1.1.3.2">1</cn><ci id="A1.SS1.1.p1.4.m4.1.1.3.3.cmml" xref="A1.SS1.1.p1.4.m4.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.4.m4.1c">P(X_{i}\in[a_{j},b_{j}])=1/k</annotation></semantics></math> <math id="A1.SS1.1.p1.5.m5.2" class="ltx_Math" alttext="\forall i,j" display="inline"><semantics id="A1.SS1.1.p1.5.m5.2a"><mrow id="A1.SS1.1.p1.5.m5.2.2.1" xref="A1.SS1.1.p1.5.m5.2.2.2.cmml"><mrow id="A1.SS1.1.p1.5.m5.2.2.1.1" xref="A1.SS1.1.p1.5.m5.2.2.1.1.cmml"><mo rspace="0.167em" id="A1.SS1.1.p1.5.m5.2.2.1.1.1" xref="A1.SS1.1.p1.5.m5.2.2.1.1.1.cmml">∀</mo><mi id="A1.SS1.1.p1.5.m5.2.2.1.1.2" xref="A1.SS1.1.p1.5.m5.2.2.1.1.2.cmml">i</mi></mrow><mo id="A1.SS1.1.p1.5.m5.2.2.1.2" xref="A1.SS1.1.p1.5.m5.2.2.2.cmml">,</mo><mi id="A1.SS1.1.p1.5.m5.1.1" xref="A1.SS1.1.p1.5.m5.1.1.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.5.m5.2b"><list id="A1.SS1.1.p1.5.m5.2.2.2.cmml" xref="A1.SS1.1.p1.5.m5.2.2.1"><apply id="A1.SS1.1.p1.5.m5.2.2.1.1.cmml" xref="A1.SS1.1.p1.5.m5.2.2.1.1"><csymbol cd="latexml" id="A1.SS1.1.p1.5.m5.2.2.1.1.1.cmml" xref="A1.SS1.1.p1.5.m5.2.2.1.1.1">for-all</csymbol><ci id="A1.SS1.1.p1.5.m5.2.2.1.1.2.cmml" xref="A1.SS1.1.p1.5.m5.2.2.1.1.2">𝑖</ci></apply><ci id="A1.SS1.1.p1.5.m5.1.1.cmml" xref="A1.SS1.1.p1.5.m5.1.1">𝑗</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.5.m5.2c">\forall i,j</annotation></semantics></math>.</p>
</div>
<div id="A1.SS1.2.p2" class="ltx_para ltx_noindent">
<p id="A1.SS1.2.p2.6" class="ltx_p">We can then phrase the problem of expected number of perfectly recovered samples as a modified “stars and bars” problem. For a given batch of data, to calculate the amount of data recovered, we first calculate:</p>
<table id="A1.Ex11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex11.m1.2" class="ltx_Math" alttext="\sum_{i=1}^{n}i\cdot\binom{k}{i}\cdot N_{i}" display="block"><semantics id="A1.Ex11.m1.2a"><mrow id="A1.Ex11.m1.2.3" xref="A1.Ex11.m1.2.3.cmml"><munderover id="A1.Ex11.m1.2.3.1" xref="A1.Ex11.m1.2.3.1.cmml"><mo movablelimits="false" id="A1.Ex11.m1.2.3.1.2.2" xref="A1.Ex11.m1.2.3.1.2.2.cmml">∑</mo><mrow id="A1.Ex11.m1.2.3.1.2.3" xref="A1.Ex11.m1.2.3.1.2.3.cmml"><mi id="A1.Ex11.m1.2.3.1.2.3.2" xref="A1.Ex11.m1.2.3.1.2.3.2.cmml">i</mi><mo id="A1.Ex11.m1.2.3.1.2.3.1" xref="A1.Ex11.m1.2.3.1.2.3.1.cmml">=</mo><mn id="A1.Ex11.m1.2.3.1.2.3.3" xref="A1.Ex11.m1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.Ex11.m1.2.3.1.3" xref="A1.Ex11.m1.2.3.1.3.cmml">n</mi></munderover><mrow id="A1.Ex11.m1.2.3.2" xref="A1.Ex11.m1.2.3.2.cmml"><mi id="A1.Ex11.m1.2.3.2.2" xref="A1.Ex11.m1.2.3.2.2.cmml">i</mi><mo lspace="0.222em" rspace="0.222em" id="A1.Ex11.m1.2.3.2.1" xref="A1.Ex11.m1.2.3.2.1.cmml">⋅</mo><mrow id="A1.Ex11.m1.2.2.4" xref="A1.Ex11.m1.2.2.3.cmml"><mo id="A1.Ex11.m1.2.2.4.1" xref="A1.Ex11.m1.2.2.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.Ex11.m1.2.2.2.2" xref="A1.Ex11.m1.2.2.3.cmml"><mi id="A1.Ex11.m1.1.1.1.1.1.1" xref="A1.Ex11.m1.1.1.1.1.1.1.cmml">k</mi><mi id="A1.Ex11.m1.2.2.2.2.2.1" xref="A1.Ex11.m1.2.2.2.2.2.1.cmml">i</mi></mfrac><mo rspace="0.055em" id="A1.Ex11.m1.2.2.4.2" xref="A1.Ex11.m1.2.2.3.1.cmml">)</mo></mrow><mo rspace="0.222em" id="A1.Ex11.m1.2.3.2.1a" xref="A1.Ex11.m1.2.3.2.1.cmml">⋅</mo><msub id="A1.Ex11.m1.2.3.2.3" xref="A1.Ex11.m1.2.3.2.3.cmml"><mi id="A1.Ex11.m1.2.3.2.3.2" xref="A1.Ex11.m1.2.3.2.3.2.cmml">N</mi><mi id="A1.Ex11.m1.2.3.2.3.3" xref="A1.Ex11.m1.2.3.2.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex11.m1.2b"><apply id="A1.Ex11.m1.2.3.cmml" xref="A1.Ex11.m1.2.3"><apply id="A1.Ex11.m1.2.3.1.cmml" xref="A1.Ex11.m1.2.3.1"><csymbol cd="ambiguous" id="A1.Ex11.m1.2.3.1.1.cmml" xref="A1.Ex11.m1.2.3.1">superscript</csymbol><apply id="A1.Ex11.m1.2.3.1.2.cmml" xref="A1.Ex11.m1.2.3.1"><csymbol cd="ambiguous" id="A1.Ex11.m1.2.3.1.2.1.cmml" xref="A1.Ex11.m1.2.3.1">subscript</csymbol><sum id="A1.Ex11.m1.2.3.1.2.2.cmml" xref="A1.Ex11.m1.2.3.1.2.2"></sum><apply id="A1.Ex11.m1.2.3.1.2.3.cmml" xref="A1.Ex11.m1.2.3.1.2.3"><eq id="A1.Ex11.m1.2.3.1.2.3.1.cmml" xref="A1.Ex11.m1.2.3.1.2.3.1"></eq><ci id="A1.Ex11.m1.2.3.1.2.3.2.cmml" xref="A1.Ex11.m1.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="A1.Ex11.m1.2.3.1.2.3.3.cmml" xref="A1.Ex11.m1.2.3.1.2.3.3">1</cn></apply></apply><ci id="A1.Ex11.m1.2.3.1.3.cmml" xref="A1.Ex11.m1.2.3.1.3">𝑛</ci></apply><apply id="A1.Ex11.m1.2.3.2.cmml" xref="A1.Ex11.m1.2.3.2"><ci id="A1.Ex11.m1.2.3.2.1.cmml" xref="A1.Ex11.m1.2.3.2.1">⋅</ci><ci id="A1.Ex11.m1.2.3.2.2.cmml" xref="A1.Ex11.m1.2.3.2.2">𝑖</ci><apply id="A1.Ex11.m1.2.2.3.cmml" xref="A1.Ex11.m1.2.2.4"><csymbol cd="latexml" id="A1.Ex11.m1.2.2.3.1.cmml" xref="A1.Ex11.m1.2.2.4.1">binomial</csymbol><ci id="A1.Ex11.m1.1.1.1.1.1.1.cmml" xref="A1.Ex11.m1.1.1.1.1.1.1">𝑘</ci><ci id="A1.Ex11.m1.2.2.2.2.2.1.cmml" xref="A1.Ex11.m1.2.2.2.2.2.1">𝑖</ci></apply><apply id="A1.Ex11.m1.2.3.2.3.cmml" xref="A1.Ex11.m1.2.3.2.3"><csymbol cd="ambiguous" id="A1.Ex11.m1.2.3.2.3.1.cmml" xref="A1.Ex11.m1.2.3.2.3">subscript</csymbol><ci id="A1.Ex11.m1.2.3.2.3.2.cmml" xref="A1.Ex11.m1.2.3.2.3.2">𝑁</ci><ci id="A1.Ex11.m1.2.3.2.3.3.cmml" xref="A1.Ex11.m1.2.3.2.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex11.m1.2c">\sum_{i=1}^{n}i\cdot\binom{k}{i}\cdot N_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS1.2.p2.5" class="ltx_p">Where <math id="A1.SS1.2.p2.1.m1.2" class="ltx_Math" alttext="\binom{k}{i}" display="inline"><semantics id="A1.SS1.2.p2.1.m1.2a"><mrow id="A1.SS1.2.p2.1.m1.2.2.4" xref="A1.SS1.2.p2.1.m1.2.2.3.cmml"><mo id="A1.SS1.2.p2.1.m1.2.2.4.1" xref="A1.SS1.2.p2.1.m1.2.2.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.SS1.2.p2.1.m1.2.2.2.2" xref="A1.SS1.2.p2.1.m1.2.2.3.cmml"><mi id="A1.SS1.2.p2.1.m1.1.1.1.1.1.1" xref="A1.SS1.2.p2.1.m1.1.1.1.1.1.1.cmml">k</mi><mi id="A1.SS1.2.p2.1.m1.2.2.2.2.2.1" xref="A1.SS1.2.p2.1.m1.2.2.2.2.2.1.cmml">i</mi></mfrac><mo id="A1.SS1.2.p2.1.m1.2.2.4.2" xref="A1.SS1.2.p2.1.m1.2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.2.p2.1.m1.2b"><apply id="A1.SS1.2.p2.1.m1.2.2.3.cmml" xref="A1.SS1.2.p2.1.m1.2.2.4"><csymbol cd="latexml" id="A1.SS1.2.p2.1.m1.2.2.3.1.cmml" xref="A1.SS1.2.p2.1.m1.2.2.4.1">binomial</csymbol><ci id="A1.SS1.2.p2.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS1.2.p2.1.m1.1.1.1.1.1.1">𝑘</ci><ci id="A1.SS1.2.p2.1.m1.2.2.2.2.2.1.cmml" xref="A1.SS1.2.p2.1.m1.2.2.2.2.2.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.2.p2.1.m1.2c">\binom{k}{i}</annotation></semantics></math> is the number of ways to select the <math id="A1.SS1.2.p2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS1.2.p2.2.m2.1a"><mi id="A1.SS1.2.p2.2.m2.1.1" xref="A1.SS1.2.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.2.p2.2.m2.1b"><ci id="A1.SS1.2.p2.2.m2.1.1.cmml" xref="A1.SS1.2.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.2.p2.2.m2.1c">i</annotation></semantics></math> bins that have exactly <math id="A1.SS1.2.p2.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.SS1.2.p2.3.m3.1a"><mn id="A1.SS1.2.p2.3.m3.1.1" xref="A1.SS1.2.p2.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.2.p2.3.m3.1b"><cn type="integer" id="A1.SS1.2.p2.3.m3.1.1.cmml" xref="A1.SS1.2.p2.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.2.p2.3.m3.1c">1</annotation></semantics></math> element, and <math id="A1.SS1.2.p2.4.m4.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="A1.SS1.2.p2.4.m4.1a"><msub id="A1.SS1.2.p2.4.m4.1.1" xref="A1.SS1.2.p2.4.m4.1.1.cmml"><mi id="A1.SS1.2.p2.4.m4.1.1.2" xref="A1.SS1.2.p2.4.m4.1.1.2.cmml">N</mi><mi id="A1.SS1.2.p2.4.m4.1.1.3" xref="A1.SS1.2.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.2.p2.4.m4.1b"><apply id="A1.SS1.2.p2.4.m4.1.1.cmml" xref="A1.SS1.2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.2.p2.4.m4.1.1.1.cmml" xref="A1.SS1.2.p2.4.m4.1.1">subscript</csymbol><ci id="A1.SS1.2.p2.4.m4.1.1.2.cmml" xref="A1.SS1.2.p2.4.m4.1.1.2">𝑁</ci><ci id="A1.SS1.2.p2.4.m4.1.1.3.cmml" xref="A1.SS1.2.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.2.p2.4.m4.1c">N_{i}</annotation></semantics></math> is the number of orientations of the remaining data into the remaining bins so that no bin has exactly <math id="A1.SS1.2.p2.5.m5.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.SS1.2.p2.5.m5.1a"><mn id="A1.SS1.2.p2.5.m5.1.1" xref="A1.SS1.2.p2.5.m5.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.2.p2.5.m5.1b"><cn type="integer" id="A1.SS1.2.p2.5.m5.1.1.cmml" xref="A1.SS1.2.p2.5.m5.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.2.p2.5.m5.1c">1</annotation></semantics></math> element. Note that we can do this because the bins all have equal mass, and thus we can factor out the (uniform) probability of any configuration from the sum.</p>
</div>
<div id="A1.SS1.3.p3" class="ltx_para ltx_noindent">
<p id="A1.SS1.3.p3.5" class="ltx_p">Simply put, we first take the configuration where there is only <math id="A1.SS1.3.p3.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.SS1.3.p3.1.m1.1a"><mn id="A1.SS1.3.p3.1.m1.1.1" xref="A1.SS1.3.p3.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.3.p3.1.m1.1b"><cn type="integer" id="A1.SS1.3.p3.1.m1.1.1.cmml" xref="A1.SS1.3.p3.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.3.p3.1.m1.1c">1</annotation></semantics></math> bin with exactly <math id="A1.SS1.3.p3.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.SS1.3.p3.2.m2.1a"><mn id="A1.SS1.3.p3.2.m2.1.1" xref="A1.SS1.3.p3.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.3.p3.2.m2.1b"><cn type="integer" id="A1.SS1.3.p3.2.m2.1.1.cmml" xref="A1.SS1.3.p3.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.3.p3.2.m2.1c">1</annotation></semantics></math> element, and weight it by <math id="A1.SS1.3.p3.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.SS1.3.p3.3.m3.1a"><mn id="A1.SS1.3.p3.3.m3.1.1" xref="A1.SS1.3.p3.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.3.p3.3.m3.1b"><cn type="integer" id="A1.SS1.3.p3.3.m3.1.1.cmml" xref="A1.SS1.3.p3.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.3.p3.3.m3.1c">1</annotation></semantics></math>, then we take the number of configurations with <math id="A1.SS1.3.p3.4.m4.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A1.SS1.3.p3.4.m4.1a"><mn id="A1.SS1.3.p3.4.m4.1.1" xref="A1.SS1.3.p3.4.m4.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.3.p3.4.m4.1b"><cn type="integer" id="A1.SS1.3.p3.4.m4.1.1.cmml" xref="A1.SS1.3.p3.4.m4.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.3.p3.4.m4.1c">2</annotation></semantics></math> bins with exactly 1 element, and weight it by <math id="A1.SS1.3.p3.5.m5.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A1.SS1.3.p3.5.m5.1a"><mn id="A1.SS1.3.p3.5.m5.1.1" xref="A1.SS1.3.p3.5.m5.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.3.p3.5.m5.1b"><cn type="integer" id="A1.SS1.3.p3.5.m5.1.1.cmml" xref="A1.SS1.3.p3.5.m5.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.3.p3.5.m5.1c">2</annotation></semantics></math>, and so on.</p>
</div>
<div id="A1.SS1.4.p4" class="ltx_para ltx_noindent">
<p id="A1.SS1.4.p4.8" class="ltx_p">In order to calculate <math id="A1.SS1.4.p4.1.m1.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="A1.SS1.4.p4.1.m1.1a"><msub id="A1.SS1.4.p4.1.m1.1.1" xref="A1.SS1.4.p4.1.m1.1.1.cmml"><mi id="A1.SS1.4.p4.1.m1.1.1.2" xref="A1.SS1.4.p4.1.m1.1.1.2.cmml">N</mi><mi id="A1.SS1.4.p4.1.m1.1.1.3" xref="A1.SS1.4.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.4.p4.1.m1.1b"><apply id="A1.SS1.4.p4.1.m1.1.1.cmml" xref="A1.SS1.4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.4.p4.1.m1.1.1.1.cmml" xref="A1.SS1.4.p4.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.4.p4.1.m1.1.1.2.cmml" xref="A1.SS1.4.p4.1.m1.1.1.2">𝑁</ci><ci id="A1.SS1.4.p4.1.m1.1.1.3.cmml" xref="A1.SS1.4.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.4.p4.1.m1.1c">N_{i}</annotation></semantics></math>, we notice that in our construction, once the <math id="A1.SS1.4.p4.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS1.4.p4.2.m2.1a"><mi id="A1.SS1.4.p4.2.m2.1.1" xref="A1.SS1.4.p4.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.4.p4.2.m2.1b"><ci id="A1.SS1.4.p4.2.m2.1.1.cmml" xref="A1.SS1.4.p4.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.4.p4.2.m2.1c">i</annotation></semantics></math> bins with exactly <math id="A1.SS1.4.p4.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.SS1.4.p4.3.m3.1a"><mn id="A1.SS1.4.p4.3.m3.1.1" xref="A1.SS1.4.p4.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.4.p4.3.m3.1b"><cn type="integer" id="A1.SS1.4.p4.3.m3.1.1.cmml" xref="A1.SS1.4.p4.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.4.p4.3.m3.1c">1</annotation></semantics></math> element are chosen, every other bin has either <math id="A1.SS1.4.p4.4.m4.1" class="ltx_Math" alttext="0" display="inline"><semantics id="A1.SS1.4.p4.4.m4.1a"><mn id="A1.SS1.4.p4.4.m4.1.1" xref="A1.SS1.4.p4.4.m4.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.4.p4.4.m4.1b"><cn type="integer" id="A1.SS1.4.p4.4.m4.1.1.cmml" xref="A1.SS1.4.p4.4.m4.1.1">0</cn></annotation-xml></semantics></math> or <math id="A1.SS1.4.p4.5.m5.1" class="ltx_Math" alttext="\geq 2" display="inline"><semantics id="A1.SS1.4.p4.5.m5.1a"><mrow id="A1.SS1.4.p4.5.m5.1.1" xref="A1.SS1.4.p4.5.m5.1.1.cmml"><mi id="A1.SS1.4.p4.5.m5.1.1.2" xref="A1.SS1.4.p4.5.m5.1.1.2.cmml"></mi><mo id="A1.SS1.4.p4.5.m5.1.1.1" xref="A1.SS1.4.p4.5.m5.1.1.1.cmml">≥</mo><mn id="A1.SS1.4.p4.5.m5.1.1.3" xref="A1.SS1.4.p4.5.m5.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.4.p4.5.m5.1b"><apply id="A1.SS1.4.p4.5.m5.1.1.cmml" xref="A1.SS1.4.p4.5.m5.1.1"><geq id="A1.SS1.4.p4.5.m5.1.1.1.cmml" xref="A1.SS1.4.p4.5.m5.1.1.1"></geq><csymbol cd="latexml" id="A1.SS1.4.p4.5.m5.1.1.2.cmml" xref="A1.SS1.4.p4.5.m5.1.1.2">absent</csymbol><cn type="integer" id="A1.SS1.4.p4.5.m5.1.1.3.cmml" xref="A1.SS1.4.p4.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.4.p4.5.m5.1c">\geq 2</annotation></semantics></math> elements. We focus on the bins that have <math id="A1.SS1.4.p4.6.m6.1" class="ltx_Math" alttext="\geq 2" display="inline"><semantics id="A1.SS1.4.p4.6.m6.1a"><mrow id="A1.SS1.4.p4.6.m6.1.1" xref="A1.SS1.4.p4.6.m6.1.1.cmml"><mi id="A1.SS1.4.p4.6.m6.1.1.2" xref="A1.SS1.4.p4.6.m6.1.1.2.cmml"></mi><mo id="A1.SS1.4.p4.6.m6.1.1.1" xref="A1.SS1.4.p4.6.m6.1.1.1.cmml">≥</mo><mn id="A1.SS1.4.p4.6.m6.1.1.3" xref="A1.SS1.4.p4.6.m6.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.4.p4.6.m6.1b"><apply id="A1.SS1.4.p4.6.m6.1.1.cmml" xref="A1.SS1.4.p4.6.m6.1.1"><geq id="A1.SS1.4.p4.6.m6.1.1.1.cmml" xref="A1.SS1.4.p4.6.m6.1.1.1"></geq><csymbol cd="latexml" id="A1.SS1.4.p4.6.m6.1.1.2.cmml" xref="A1.SS1.4.p4.6.m6.1.1.2">absent</csymbol><cn type="integer" id="A1.SS1.4.p4.6.m6.1.1.3.cmml" xref="A1.SS1.4.p4.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.4.p4.6.m6.1c">\geq 2</annotation></semantics></math> elements. By a simple “reverse” pigeon hole argument, we can now have at most <math id="A1.SS1.4.p4.7.m7.1" class="ltx_Math" alttext="\lfloor\frac{n-i}{2}\rfloor" display="inline"><semantics id="A1.SS1.4.p4.7.m7.1a"><mrow id="A1.SS1.4.p4.7.m7.1.2.2" xref="A1.SS1.4.p4.7.m7.1.2.1.cmml"><mo stretchy="false" id="A1.SS1.4.p4.7.m7.1.2.2.1" xref="A1.SS1.4.p4.7.m7.1.2.1.1.cmml">⌊</mo><mfrac id="A1.SS1.4.p4.7.m7.1.1" xref="A1.SS1.4.p4.7.m7.1.1.cmml"><mrow id="A1.SS1.4.p4.7.m7.1.1.2" xref="A1.SS1.4.p4.7.m7.1.1.2.cmml"><mi id="A1.SS1.4.p4.7.m7.1.1.2.2" xref="A1.SS1.4.p4.7.m7.1.1.2.2.cmml">n</mi><mo id="A1.SS1.4.p4.7.m7.1.1.2.1" xref="A1.SS1.4.p4.7.m7.1.1.2.1.cmml">−</mo><mi id="A1.SS1.4.p4.7.m7.1.1.2.3" xref="A1.SS1.4.p4.7.m7.1.1.2.3.cmml">i</mi></mrow><mn id="A1.SS1.4.p4.7.m7.1.1.3" xref="A1.SS1.4.p4.7.m7.1.1.3.cmml">2</mn></mfrac><mo stretchy="false" id="A1.SS1.4.p4.7.m7.1.2.2.2" xref="A1.SS1.4.p4.7.m7.1.2.1.1.cmml">⌋</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.4.p4.7.m7.1b"><apply id="A1.SS1.4.p4.7.m7.1.2.1.cmml" xref="A1.SS1.4.p4.7.m7.1.2.2"><floor id="A1.SS1.4.p4.7.m7.1.2.1.1.cmml" xref="A1.SS1.4.p4.7.m7.1.2.2.1"></floor><apply id="A1.SS1.4.p4.7.m7.1.1.cmml" xref="A1.SS1.4.p4.7.m7.1.1"><divide id="A1.SS1.4.p4.7.m7.1.1.1.cmml" xref="A1.SS1.4.p4.7.m7.1.1"></divide><apply id="A1.SS1.4.p4.7.m7.1.1.2.cmml" xref="A1.SS1.4.p4.7.m7.1.1.2"><minus id="A1.SS1.4.p4.7.m7.1.1.2.1.cmml" xref="A1.SS1.4.p4.7.m7.1.1.2.1"></minus><ci id="A1.SS1.4.p4.7.m7.1.1.2.2.cmml" xref="A1.SS1.4.p4.7.m7.1.1.2.2">𝑛</ci><ci id="A1.SS1.4.p4.7.m7.1.1.2.3.cmml" xref="A1.SS1.4.p4.7.m7.1.1.2.3">𝑖</ci></apply><cn type="integer" id="A1.SS1.4.p4.7.m7.1.1.3.cmml" xref="A1.SS1.4.p4.7.m7.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.4.p4.7.m7.1c">\lfloor\frac{n-i}{2}\rfloor</annotation></semantics></math> of the remaining bins containing any elements, as otherwise, one bin would be guaranteed to contain exactly <math id="A1.SS1.4.p4.8.m8.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.SS1.4.p4.8.m8.1a"><mn id="A1.SS1.4.p4.8.m8.1.1" xref="A1.SS1.4.p4.8.m8.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.4.p4.8.m8.1b"><cn type="integer" id="A1.SS1.4.p4.8.m8.1.1.cmml" xref="A1.SS1.4.p4.8.m8.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.4.p4.8.m8.1c">1</annotation></semantics></math> element.</p>
</div>
<div id="A1.SS1.5.p5" class="ltx_para ltx_noindent">
<p id="A1.SS1.5.p5.4" class="ltx_p">So we further select any <math id="A1.SS1.5.p5.1.m1.1" class="ltx_Math" alttext="1\leq j\leq\lfloor\frac{n-i}{2}\rfloor" display="inline"><semantics id="A1.SS1.5.p5.1.m1.1a"><mrow id="A1.SS1.5.p5.1.m1.1.2" xref="A1.SS1.5.p5.1.m1.1.2.cmml"><mn id="A1.SS1.5.p5.1.m1.1.2.2" xref="A1.SS1.5.p5.1.m1.1.2.2.cmml">1</mn><mo id="A1.SS1.5.p5.1.m1.1.2.3" xref="A1.SS1.5.p5.1.m1.1.2.3.cmml">≤</mo><mi id="A1.SS1.5.p5.1.m1.1.2.4" xref="A1.SS1.5.p5.1.m1.1.2.4.cmml">j</mi><mo id="A1.SS1.5.p5.1.m1.1.2.5" xref="A1.SS1.5.p5.1.m1.1.2.5.cmml">≤</mo><mrow id="A1.SS1.5.p5.1.m1.1.2.6.2" xref="A1.SS1.5.p5.1.m1.1.2.6.1.cmml"><mo stretchy="false" id="A1.SS1.5.p5.1.m1.1.2.6.2.1" xref="A1.SS1.5.p5.1.m1.1.2.6.1.1.cmml">⌊</mo><mfrac id="A1.SS1.5.p5.1.m1.1.1" xref="A1.SS1.5.p5.1.m1.1.1.cmml"><mrow id="A1.SS1.5.p5.1.m1.1.1.2" xref="A1.SS1.5.p5.1.m1.1.1.2.cmml"><mi id="A1.SS1.5.p5.1.m1.1.1.2.2" xref="A1.SS1.5.p5.1.m1.1.1.2.2.cmml">n</mi><mo id="A1.SS1.5.p5.1.m1.1.1.2.1" xref="A1.SS1.5.p5.1.m1.1.1.2.1.cmml">−</mo><mi id="A1.SS1.5.p5.1.m1.1.1.2.3" xref="A1.SS1.5.p5.1.m1.1.1.2.3.cmml">i</mi></mrow><mn id="A1.SS1.5.p5.1.m1.1.1.3" xref="A1.SS1.5.p5.1.m1.1.1.3.cmml">2</mn></mfrac><mo stretchy="false" id="A1.SS1.5.p5.1.m1.1.2.6.2.2" xref="A1.SS1.5.p5.1.m1.1.2.6.1.1.cmml">⌋</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.5.p5.1.m1.1b"><apply id="A1.SS1.5.p5.1.m1.1.2.cmml" xref="A1.SS1.5.p5.1.m1.1.2"><and id="A1.SS1.5.p5.1.m1.1.2a.cmml" xref="A1.SS1.5.p5.1.m1.1.2"></and><apply id="A1.SS1.5.p5.1.m1.1.2b.cmml" xref="A1.SS1.5.p5.1.m1.1.2"><leq id="A1.SS1.5.p5.1.m1.1.2.3.cmml" xref="A1.SS1.5.p5.1.m1.1.2.3"></leq><cn type="integer" id="A1.SS1.5.p5.1.m1.1.2.2.cmml" xref="A1.SS1.5.p5.1.m1.1.2.2">1</cn><ci id="A1.SS1.5.p5.1.m1.1.2.4.cmml" xref="A1.SS1.5.p5.1.m1.1.2.4">𝑗</ci></apply><apply id="A1.SS1.5.p5.1.m1.1.2c.cmml" xref="A1.SS1.5.p5.1.m1.1.2"><leq id="A1.SS1.5.p5.1.m1.1.2.5.cmml" xref="A1.SS1.5.p5.1.m1.1.2.5"></leq><share href="#A1.SS1.5.p5.1.m1.1.2.4.cmml" id="A1.SS1.5.p5.1.m1.1.2d.cmml" xref="A1.SS1.5.p5.1.m1.1.2"></share><apply id="A1.SS1.5.p5.1.m1.1.2.6.1.cmml" xref="A1.SS1.5.p5.1.m1.1.2.6.2"><floor id="A1.SS1.5.p5.1.m1.1.2.6.1.1.cmml" xref="A1.SS1.5.p5.1.m1.1.2.6.2.1"></floor><apply id="A1.SS1.5.p5.1.m1.1.1.cmml" xref="A1.SS1.5.p5.1.m1.1.1"><divide id="A1.SS1.5.p5.1.m1.1.1.1.cmml" xref="A1.SS1.5.p5.1.m1.1.1"></divide><apply id="A1.SS1.5.p5.1.m1.1.1.2.cmml" xref="A1.SS1.5.p5.1.m1.1.1.2"><minus id="A1.SS1.5.p5.1.m1.1.1.2.1.cmml" xref="A1.SS1.5.p5.1.m1.1.1.2.1"></minus><ci id="A1.SS1.5.p5.1.m1.1.1.2.2.cmml" xref="A1.SS1.5.p5.1.m1.1.1.2.2">𝑛</ci><ci id="A1.SS1.5.p5.1.m1.1.1.2.3.cmml" xref="A1.SS1.5.p5.1.m1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="A1.SS1.5.p5.1.m1.1.1.3.cmml" xref="A1.SS1.5.p5.1.m1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.5.p5.1.m1.1c">1\leq j\leq\lfloor\frac{n-i}{2}\rfloor</annotation></semantics></math> number of the remaining <math id="A1.SS1.5.p5.2.m2.1" class="ltx_Math" alttext="k-i" display="inline"><semantics id="A1.SS1.5.p5.2.m2.1a"><mrow id="A1.SS1.5.p5.2.m2.1.1" xref="A1.SS1.5.p5.2.m2.1.1.cmml"><mi id="A1.SS1.5.p5.2.m2.1.1.2" xref="A1.SS1.5.p5.2.m2.1.1.2.cmml">k</mi><mo id="A1.SS1.5.p5.2.m2.1.1.1" xref="A1.SS1.5.p5.2.m2.1.1.1.cmml">−</mo><mi id="A1.SS1.5.p5.2.m2.1.1.3" xref="A1.SS1.5.p5.2.m2.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.5.p5.2.m2.1b"><apply id="A1.SS1.5.p5.2.m2.1.1.cmml" xref="A1.SS1.5.p5.2.m2.1.1"><minus id="A1.SS1.5.p5.2.m2.1.1.1.cmml" xref="A1.SS1.5.p5.2.m2.1.1.1"></minus><ci id="A1.SS1.5.p5.2.m2.1.1.2.cmml" xref="A1.SS1.5.p5.2.m2.1.1.2">𝑘</ci><ci id="A1.SS1.5.p5.2.m2.1.1.3.cmml" xref="A1.SS1.5.p5.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.5.p5.2.m2.1c">k-i</annotation></semantics></math> bins all to contain at least <math id="A1.SS1.5.p5.3.m3.1" class="ltx_Math" alttext="2" display="inline"><semantics id="A1.SS1.5.p5.3.m3.1a"><mn id="A1.SS1.5.p5.3.m3.1.1" xref="A1.SS1.5.p5.3.m3.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.5.p5.3.m3.1b"><cn type="integer" id="A1.SS1.5.p5.3.m3.1.1.cmml" xref="A1.SS1.5.p5.3.m3.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.5.p5.3.m3.1c">2</annotation></semantics></math> elements. Formally, this is equivalent to calculating the number of orientations of integers <math id="A1.SS1.5.p5.4.m4.1" class="ltx_Math" alttext="\{x_{l}\}_{l=1}^{j}" display="inline"><semantics id="A1.SS1.5.p5.4.m4.1a"><msubsup id="A1.SS1.5.p5.4.m4.1.1" xref="A1.SS1.5.p5.4.m4.1.1.cmml"><mrow id="A1.SS1.5.p5.4.m4.1.1.1.1.1" xref="A1.SS1.5.p5.4.m4.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.SS1.5.p5.4.m4.1.1.1.1.1.2" xref="A1.SS1.5.p5.4.m4.1.1.1.1.2.cmml">{</mo><msub id="A1.SS1.5.p5.4.m4.1.1.1.1.1.1" xref="A1.SS1.5.p5.4.m4.1.1.1.1.1.1.cmml"><mi id="A1.SS1.5.p5.4.m4.1.1.1.1.1.1.2" xref="A1.SS1.5.p5.4.m4.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.SS1.5.p5.4.m4.1.1.1.1.1.1.3" xref="A1.SS1.5.p5.4.m4.1.1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="A1.SS1.5.p5.4.m4.1.1.1.1.1.3" xref="A1.SS1.5.p5.4.m4.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.SS1.5.p5.4.m4.1.1.1.3" xref="A1.SS1.5.p5.4.m4.1.1.1.3.cmml"><mi id="A1.SS1.5.p5.4.m4.1.1.1.3.2" xref="A1.SS1.5.p5.4.m4.1.1.1.3.2.cmml">l</mi><mo id="A1.SS1.5.p5.4.m4.1.1.1.3.1" xref="A1.SS1.5.p5.4.m4.1.1.1.3.1.cmml">=</mo><mn id="A1.SS1.5.p5.4.m4.1.1.1.3.3" xref="A1.SS1.5.p5.4.m4.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS1.5.p5.4.m4.1.1.3" xref="A1.SS1.5.p5.4.m4.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.5.p5.4.m4.1b"><apply id="A1.SS1.5.p5.4.m4.1.1.cmml" xref="A1.SS1.5.p5.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.5.p5.4.m4.1.1.2.cmml" xref="A1.SS1.5.p5.4.m4.1.1">superscript</csymbol><apply id="A1.SS1.5.p5.4.m4.1.1.1.cmml" xref="A1.SS1.5.p5.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.5.p5.4.m4.1.1.1.2.cmml" xref="A1.SS1.5.p5.4.m4.1.1">subscript</csymbol><set id="A1.SS1.5.p5.4.m4.1.1.1.1.2.cmml" xref="A1.SS1.5.p5.4.m4.1.1.1.1.1"><apply id="A1.SS1.5.p5.4.m4.1.1.1.1.1.1.cmml" xref="A1.SS1.5.p5.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.5.p5.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.SS1.5.p5.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.5.p5.4.m4.1.1.1.1.1.1.2.cmml" xref="A1.SS1.5.p5.4.m4.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.SS1.5.p5.4.m4.1.1.1.1.1.1.3.cmml" xref="A1.SS1.5.p5.4.m4.1.1.1.1.1.1.3">𝑙</ci></apply></set><apply id="A1.SS1.5.p5.4.m4.1.1.1.3.cmml" xref="A1.SS1.5.p5.4.m4.1.1.1.3"><eq id="A1.SS1.5.p5.4.m4.1.1.1.3.1.cmml" xref="A1.SS1.5.p5.4.m4.1.1.1.3.1"></eq><ci id="A1.SS1.5.p5.4.m4.1.1.1.3.2.cmml" xref="A1.SS1.5.p5.4.m4.1.1.1.3.2">𝑙</ci><cn type="integer" id="A1.SS1.5.p5.4.m4.1.1.1.3.3.cmml" xref="A1.SS1.5.p5.4.m4.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS1.5.p5.4.m4.1.1.3.cmml" xref="A1.SS1.5.p5.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.5.p5.4.m4.1c">\{x_{l}\}_{l=1}^{j}</annotation></semantics></math></p>
</div>
<div id="A1.SS1.6.p6" class="ltx_para ltx_noindent">
<p id="A1.SS1.6.p6.2" class="ltx_p">so that</p>
<table id="A1.Ex12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex12.m1.1" class="ltx_Math" alttext="x_{1}+\dots+x_{j}=n-i" display="block"><semantics id="A1.Ex12.m1.1a"><mrow id="A1.Ex12.m1.1.1" xref="A1.Ex12.m1.1.1.cmml"><mrow id="A1.Ex12.m1.1.1.2" xref="A1.Ex12.m1.1.1.2.cmml"><msub id="A1.Ex12.m1.1.1.2.2" xref="A1.Ex12.m1.1.1.2.2.cmml"><mi id="A1.Ex12.m1.1.1.2.2.2" xref="A1.Ex12.m1.1.1.2.2.2.cmml">x</mi><mn id="A1.Ex12.m1.1.1.2.2.3" xref="A1.Ex12.m1.1.1.2.2.3.cmml">1</mn></msub><mo id="A1.Ex12.m1.1.1.2.1" xref="A1.Ex12.m1.1.1.2.1.cmml">+</mo><mi mathvariant="normal" id="A1.Ex12.m1.1.1.2.3" xref="A1.Ex12.m1.1.1.2.3.cmml">⋯</mi><mo id="A1.Ex12.m1.1.1.2.1a" xref="A1.Ex12.m1.1.1.2.1.cmml">+</mo><msub id="A1.Ex12.m1.1.1.2.4" xref="A1.Ex12.m1.1.1.2.4.cmml"><mi id="A1.Ex12.m1.1.1.2.4.2" xref="A1.Ex12.m1.1.1.2.4.2.cmml">x</mi><mi id="A1.Ex12.m1.1.1.2.4.3" xref="A1.Ex12.m1.1.1.2.4.3.cmml">j</mi></msub></mrow><mo id="A1.Ex12.m1.1.1.1" xref="A1.Ex12.m1.1.1.1.cmml">=</mo><mrow id="A1.Ex12.m1.1.1.3" xref="A1.Ex12.m1.1.1.3.cmml"><mi id="A1.Ex12.m1.1.1.3.2" xref="A1.Ex12.m1.1.1.3.2.cmml">n</mi><mo id="A1.Ex12.m1.1.1.3.1" xref="A1.Ex12.m1.1.1.3.1.cmml">−</mo><mi id="A1.Ex12.m1.1.1.3.3" xref="A1.Ex12.m1.1.1.3.3.cmml">i</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex12.m1.1b"><apply id="A1.Ex12.m1.1.1.cmml" xref="A1.Ex12.m1.1.1"><eq id="A1.Ex12.m1.1.1.1.cmml" xref="A1.Ex12.m1.1.1.1"></eq><apply id="A1.Ex12.m1.1.1.2.cmml" xref="A1.Ex12.m1.1.1.2"><plus id="A1.Ex12.m1.1.1.2.1.cmml" xref="A1.Ex12.m1.1.1.2.1"></plus><apply id="A1.Ex12.m1.1.1.2.2.cmml" xref="A1.Ex12.m1.1.1.2.2"><csymbol cd="ambiguous" id="A1.Ex12.m1.1.1.2.2.1.cmml" xref="A1.Ex12.m1.1.1.2.2">subscript</csymbol><ci id="A1.Ex12.m1.1.1.2.2.2.cmml" xref="A1.Ex12.m1.1.1.2.2.2">𝑥</ci><cn type="integer" id="A1.Ex12.m1.1.1.2.2.3.cmml" xref="A1.Ex12.m1.1.1.2.2.3">1</cn></apply><ci id="A1.Ex12.m1.1.1.2.3.cmml" xref="A1.Ex12.m1.1.1.2.3">⋯</ci><apply id="A1.Ex12.m1.1.1.2.4.cmml" xref="A1.Ex12.m1.1.1.2.4"><csymbol cd="ambiguous" id="A1.Ex12.m1.1.1.2.4.1.cmml" xref="A1.Ex12.m1.1.1.2.4">subscript</csymbol><ci id="A1.Ex12.m1.1.1.2.4.2.cmml" xref="A1.Ex12.m1.1.1.2.4.2">𝑥</ci><ci id="A1.Ex12.m1.1.1.2.4.3.cmml" xref="A1.Ex12.m1.1.1.2.4.3">𝑗</ci></apply></apply><apply id="A1.Ex12.m1.1.1.3.cmml" xref="A1.Ex12.m1.1.1.3"><minus id="A1.Ex12.m1.1.1.3.1.cmml" xref="A1.Ex12.m1.1.1.3.1"></minus><ci id="A1.Ex12.m1.1.1.3.2.cmml" xref="A1.Ex12.m1.1.1.3.2">𝑛</ci><ci id="A1.Ex12.m1.1.1.3.3.cmml" xref="A1.Ex12.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex12.m1.1c">x_{1}+\dots+x_{j}=n-i</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS1.6.p6.1" class="ltx_p">constrained with <math id="A1.SS1.6.p6.1.m1.1" class="ltx_Math" alttext="x_{l}\geq 2\ \forall l" display="inline"><semantics id="A1.SS1.6.p6.1.m1.1a"><mrow id="A1.SS1.6.p6.1.m1.1.1" xref="A1.SS1.6.p6.1.m1.1.1.cmml"><msub id="A1.SS1.6.p6.1.m1.1.1.2" xref="A1.SS1.6.p6.1.m1.1.1.2.cmml"><mi id="A1.SS1.6.p6.1.m1.1.1.2.2" xref="A1.SS1.6.p6.1.m1.1.1.2.2.cmml">x</mi><mi id="A1.SS1.6.p6.1.m1.1.1.2.3" xref="A1.SS1.6.p6.1.m1.1.1.2.3.cmml">l</mi></msub><mo id="A1.SS1.6.p6.1.m1.1.1.1" xref="A1.SS1.6.p6.1.m1.1.1.1.cmml">≥</mo><mrow id="A1.SS1.6.p6.1.m1.1.1.3" xref="A1.SS1.6.p6.1.m1.1.1.3.cmml"><mn id="A1.SS1.6.p6.1.m1.1.1.3.2" xref="A1.SS1.6.p6.1.m1.1.1.3.2.cmml">2</mn><mo lspace="0.667em" rspace="0em" id="A1.SS1.6.p6.1.m1.1.1.3.1" xref="A1.SS1.6.p6.1.m1.1.1.3.1.cmml">​</mo><mrow id="A1.SS1.6.p6.1.m1.1.1.3.3" xref="A1.SS1.6.p6.1.m1.1.1.3.3.cmml"><mo rspace="0.167em" id="A1.SS1.6.p6.1.m1.1.1.3.3.1" xref="A1.SS1.6.p6.1.m1.1.1.3.3.1.cmml">∀</mo><mi id="A1.SS1.6.p6.1.m1.1.1.3.3.2" xref="A1.SS1.6.p6.1.m1.1.1.3.3.2.cmml">l</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.6.p6.1.m1.1b"><apply id="A1.SS1.6.p6.1.m1.1.1.cmml" xref="A1.SS1.6.p6.1.m1.1.1"><geq id="A1.SS1.6.p6.1.m1.1.1.1.cmml" xref="A1.SS1.6.p6.1.m1.1.1.1"></geq><apply id="A1.SS1.6.p6.1.m1.1.1.2.cmml" xref="A1.SS1.6.p6.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.6.p6.1.m1.1.1.2.1.cmml" xref="A1.SS1.6.p6.1.m1.1.1.2">subscript</csymbol><ci id="A1.SS1.6.p6.1.m1.1.1.2.2.cmml" xref="A1.SS1.6.p6.1.m1.1.1.2.2">𝑥</ci><ci id="A1.SS1.6.p6.1.m1.1.1.2.3.cmml" xref="A1.SS1.6.p6.1.m1.1.1.2.3">𝑙</ci></apply><apply id="A1.SS1.6.p6.1.m1.1.1.3.cmml" xref="A1.SS1.6.p6.1.m1.1.1.3"><times id="A1.SS1.6.p6.1.m1.1.1.3.1.cmml" xref="A1.SS1.6.p6.1.m1.1.1.3.1"></times><cn type="integer" id="A1.SS1.6.p6.1.m1.1.1.3.2.cmml" xref="A1.SS1.6.p6.1.m1.1.1.3.2">2</cn><apply id="A1.SS1.6.p6.1.m1.1.1.3.3.cmml" xref="A1.SS1.6.p6.1.m1.1.1.3.3"><csymbol cd="latexml" id="A1.SS1.6.p6.1.m1.1.1.3.3.1.cmml" xref="A1.SS1.6.p6.1.m1.1.1.3.3.1">for-all</csymbol><ci id="A1.SS1.6.p6.1.m1.1.1.3.3.2.cmml" xref="A1.SS1.6.p6.1.m1.1.1.3.3.2">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.6.p6.1.m1.1c">x_{l}\geq 2\ \forall l</annotation></semantics></math></p>
</div>
<div id="A1.SS1.7.p7" class="ltx_para ltx_noindent">
<p id="A1.SS1.7.p7.10" class="ltx_p">Now, we make a change of variables to instead calculate the number of orientations of integers</p>
<table id="A1.Ex13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex13.m1.1" class="ltx_Math" alttext="\{p_{l}\}_{l=1}^{j}" display="block"><semantics id="A1.Ex13.m1.1a"><msubsup id="A1.Ex13.m1.1.1" xref="A1.Ex13.m1.1.1.cmml"><mrow id="A1.Ex13.m1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.Ex13.m1.1.1.1.1.1.2" xref="A1.Ex13.m1.1.1.1.1.2.cmml">{</mo><msub id="A1.Ex13.m1.1.1.1.1.1.1" xref="A1.Ex13.m1.1.1.1.1.1.1.cmml"><mi id="A1.Ex13.m1.1.1.1.1.1.1.2" xref="A1.Ex13.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="A1.Ex13.m1.1.1.1.1.1.1.3" xref="A1.Ex13.m1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="A1.Ex13.m1.1.1.1.1.1.3" xref="A1.Ex13.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.Ex13.m1.1.1.1.3" xref="A1.Ex13.m1.1.1.1.3.cmml"><mi id="A1.Ex13.m1.1.1.1.3.2" xref="A1.Ex13.m1.1.1.1.3.2.cmml">l</mi><mo id="A1.Ex13.m1.1.1.1.3.1" xref="A1.Ex13.m1.1.1.1.3.1.cmml">=</mo><mn id="A1.Ex13.m1.1.1.1.3.3" xref="A1.Ex13.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.Ex13.m1.1.1.3" xref="A1.Ex13.m1.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.Ex13.m1.1b"><apply id="A1.Ex13.m1.1.1.cmml" xref="A1.Ex13.m1.1.1"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.2.cmml" xref="A1.Ex13.m1.1.1">superscript</csymbol><apply id="A1.Ex13.m1.1.1.1.cmml" xref="A1.Ex13.m1.1.1"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.1.2.cmml" xref="A1.Ex13.m1.1.1">subscript</csymbol><set id="A1.Ex13.m1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1"><apply id="A1.Ex13.m1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex13.m1.1.1.1.1.1.1.1.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex13.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="A1.Ex13.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex13.m1.1.1.1.1.1.1.3">𝑙</ci></apply></set><apply id="A1.Ex13.m1.1.1.1.3.cmml" xref="A1.Ex13.m1.1.1.1.3"><eq id="A1.Ex13.m1.1.1.1.3.1.cmml" xref="A1.Ex13.m1.1.1.1.3.1"></eq><ci id="A1.Ex13.m1.1.1.1.3.2.cmml" xref="A1.Ex13.m1.1.1.1.3.2">𝑙</ci><cn type="integer" id="A1.Ex13.m1.1.1.1.3.3.cmml" xref="A1.Ex13.m1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.Ex13.m1.1.1.3.cmml" xref="A1.Ex13.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex13.m1.1c">\{p_{l}\}_{l=1}^{j}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS1.7.p7.11" class="ltx_p">so that</p>
<table id="A1.Ex14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex14.m1.1" class="ltx_Math" alttext="p_{1}+\dots+p_{j}=n-i-2j" display="block"><semantics id="A1.Ex14.m1.1a"><mrow id="A1.Ex14.m1.1.1" xref="A1.Ex14.m1.1.1.cmml"><mrow id="A1.Ex14.m1.1.1.2" xref="A1.Ex14.m1.1.1.2.cmml"><msub id="A1.Ex14.m1.1.1.2.2" xref="A1.Ex14.m1.1.1.2.2.cmml"><mi id="A1.Ex14.m1.1.1.2.2.2" xref="A1.Ex14.m1.1.1.2.2.2.cmml">p</mi><mn id="A1.Ex14.m1.1.1.2.2.3" xref="A1.Ex14.m1.1.1.2.2.3.cmml">1</mn></msub><mo id="A1.Ex14.m1.1.1.2.1" xref="A1.Ex14.m1.1.1.2.1.cmml">+</mo><mi mathvariant="normal" id="A1.Ex14.m1.1.1.2.3" xref="A1.Ex14.m1.1.1.2.3.cmml">⋯</mi><mo id="A1.Ex14.m1.1.1.2.1a" xref="A1.Ex14.m1.1.1.2.1.cmml">+</mo><msub id="A1.Ex14.m1.1.1.2.4" xref="A1.Ex14.m1.1.1.2.4.cmml"><mi id="A1.Ex14.m1.1.1.2.4.2" xref="A1.Ex14.m1.1.1.2.4.2.cmml">p</mi><mi id="A1.Ex14.m1.1.1.2.4.3" xref="A1.Ex14.m1.1.1.2.4.3.cmml">j</mi></msub></mrow><mo id="A1.Ex14.m1.1.1.1" xref="A1.Ex14.m1.1.1.1.cmml">=</mo><mrow id="A1.Ex14.m1.1.1.3" xref="A1.Ex14.m1.1.1.3.cmml"><mi id="A1.Ex14.m1.1.1.3.2" xref="A1.Ex14.m1.1.1.3.2.cmml">n</mi><mo id="A1.Ex14.m1.1.1.3.1" xref="A1.Ex14.m1.1.1.3.1.cmml">−</mo><mi id="A1.Ex14.m1.1.1.3.3" xref="A1.Ex14.m1.1.1.3.3.cmml">i</mi><mo id="A1.Ex14.m1.1.1.3.1a" xref="A1.Ex14.m1.1.1.3.1.cmml">−</mo><mrow id="A1.Ex14.m1.1.1.3.4" xref="A1.Ex14.m1.1.1.3.4.cmml"><mn id="A1.Ex14.m1.1.1.3.4.2" xref="A1.Ex14.m1.1.1.3.4.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A1.Ex14.m1.1.1.3.4.1" xref="A1.Ex14.m1.1.1.3.4.1.cmml">​</mo><mi id="A1.Ex14.m1.1.1.3.4.3" xref="A1.Ex14.m1.1.1.3.4.3.cmml">j</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex14.m1.1b"><apply id="A1.Ex14.m1.1.1.cmml" xref="A1.Ex14.m1.1.1"><eq id="A1.Ex14.m1.1.1.1.cmml" xref="A1.Ex14.m1.1.1.1"></eq><apply id="A1.Ex14.m1.1.1.2.cmml" xref="A1.Ex14.m1.1.1.2"><plus id="A1.Ex14.m1.1.1.2.1.cmml" xref="A1.Ex14.m1.1.1.2.1"></plus><apply id="A1.Ex14.m1.1.1.2.2.cmml" xref="A1.Ex14.m1.1.1.2.2"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.2.2.1.cmml" xref="A1.Ex14.m1.1.1.2.2">subscript</csymbol><ci id="A1.Ex14.m1.1.1.2.2.2.cmml" xref="A1.Ex14.m1.1.1.2.2.2">𝑝</ci><cn type="integer" id="A1.Ex14.m1.1.1.2.2.3.cmml" xref="A1.Ex14.m1.1.1.2.2.3">1</cn></apply><ci id="A1.Ex14.m1.1.1.2.3.cmml" xref="A1.Ex14.m1.1.1.2.3">⋯</ci><apply id="A1.Ex14.m1.1.1.2.4.cmml" xref="A1.Ex14.m1.1.1.2.4"><csymbol cd="ambiguous" id="A1.Ex14.m1.1.1.2.4.1.cmml" xref="A1.Ex14.m1.1.1.2.4">subscript</csymbol><ci id="A1.Ex14.m1.1.1.2.4.2.cmml" xref="A1.Ex14.m1.1.1.2.4.2">𝑝</ci><ci id="A1.Ex14.m1.1.1.2.4.3.cmml" xref="A1.Ex14.m1.1.1.2.4.3">𝑗</ci></apply></apply><apply id="A1.Ex14.m1.1.1.3.cmml" xref="A1.Ex14.m1.1.1.3"><minus id="A1.Ex14.m1.1.1.3.1.cmml" xref="A1.Ex14.m1.1.1.3.1"></minus><ci id="A1.Ex14.m1.1.1.3.2.cmml" xref="A1.Ex14.m1.1.1.3.2">𝑛</ci><ci id="A1.Ex14.m1.1.1.3.3.cmml" xref="A1.Ex14.m1.1.1.3.3">𝑖</ci><apply id="A1.Ex14.m1.1.1.3.4.cmml" xref="A1.Ex14.m1.1.1.3.4"><times id="A1.Ex14.m1.1.1.3.4.1.cmml" xref="A1.Ex14.m1.1.1.3.4.1"></times><cn type="integer" id="A1.Ex14.m1.1.1.3.4.2.cmml" xref="A1.Ex14.m1.1.1.3.4.2">2</cn><ci id="A1.Ex14.m1.1.1.3.4.3.cmml" xref="A1.Ex14.m1.1.1.3.4.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex14.m1.1c">p_{1}+\dots+p_{j}=n-i-2j</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS1.7.p7.3" class="ltx_p">constrained with <math id="A1.SS1.7.p7.1.m1.1" class="ltx_Math" alttext="p_{l}\geq 0\ \forall l" display="inline"><semantics id="A1.SS1.7.p7.1.m1.1a"><mrow id="A1.SS1.7.p7.1.m1.1.1" xref="A1.SS1.7.p7.1.m1.1.1.cmml"><msub id="A1.SS1.7.p7.1.m1.1.1.2" xref="A1.SS1.7.p7.1.m1.1.1.2.cmml"><mi id="A1.SS1.7.p7.1.m1.1.1.2.2" xref="A1.SS1.7.p7.1.m1.1.1.2.2.cmml">p</mi><mi id="A1.SS1.7.p7.1.m1.1.1.2.3" xref="A1.SS1.7.p7.1.m1.1.1.2.3.cmml">l</mi></msub><mo id="A1.SS1.7.p7.1.m1.1.1.1" xref="A1.SS1.7.p7.1.m1.1.1.1.cmml">≥</mo><mrow id="A1.SS1.7.p7.1.m1.1.1.3" xref="A1.SS1.7.p7.1.m1.1.1.3.cmml"><mn id="A1.SS1.7.p7.1.m1.1.1.3.2" xref="A1.SS1.7.p7.1.m1.1.1.3.2.cmml">0</mn><mo lspace="0.667em" rspace="0em" id="A1.SS1.7.p7.1.m1.1.1.3.1" xref="A1.SS1.7.p7.1.m1.1.1.3.1.cmml">​</mo><mrow id="A1.SS1.7.p7.1.m1.1.1.3.3" xref="A1.SS1.7.p7.1.m1.1.1.3.3.cmml"><mo rspace="0.167em" id="A1.SS1.7.p7.1.m1.1.1.3.3.1" xref="A1.SS1.7.p7.1.m1.1.1.3.3.1.cmml">∀</mo><mi id="A1.SS1.7.p7.1.m1.1.1.3.3.2" xref="A1.SS1.7.p7.1.m1.1.1.3.3.2.cmml">l</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.7.p7.1.m1.1b"><apply id="A1.SS1.7.p7.1.m1.1.1.cmml" xref="A1.SS1.7.p7.1.m1.1.1"><geq id="A1.SS1.7.p7.1.m1.1.1.1.cmml" xref="A1.SS1.7.p7.1.m1.1.1.1"></geq><apply id="A1.SS1.7.p7.1.m1.1.1.2.cmml" xref="A1.SS1.7.p7.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.7.p7.1.m1.1.1.2.1.cmml" xref="A1.SS1.7.p7.1.m1.1.1.2">subscript</csymbol><ci id="A1.SS1.7.p7.1.m1.1.1.2.2.cmml" xref="A1.SS1.7.p7.1.m1.1.1.2.2">𝑝</ci><ci id="A1.SS1.7.p7.1.m1.1.1.2.3.cmml" xref="A1.SS1.7.p7.1.m1.1.1.2.3">𝑙</ci></apply><apply id="A1.SS1.7.p7.1.m1.1.1.3.cmml" xref="A1.SS1.7.p7.1.m1.1.1.3"><times id="A1.SS1.7.p7.1.m1.1.1.3.1.cmml" xref="A1.SS1.7.p7.1.m1.1.1.3.1"></times><cn type="integer" id="A1.SS1.7.p7.1.m1.1.1.3.2.cmml" xref="A1.SS1.7.p7.1.m1.1.1.3.2">0</cn><apply id="A1.SS1.7.p7.1.m1.1.1.3.3.cmml" xref="A1.SS1.7.p7.1.m1.1.1.3.3"><csymbol cd="latexml" id="A1.SS1.7.p7.1.m1.1.1.3.3.1.cmml" xref="A1.SS1.7.p7.1.m1.1.1.3.3.1">for-all</csymbol><ci id="A1.SS1.7.p7.1.m1.1.1.3.3.2.cmml" xref="A1.SS1.7.p7.1.m1.1.1.3.3.2">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.7.p7.1.m1.1c">p_{l}\geq 0\ \forall l</annotation></semantics></math>. Now we just have a “stars and bars” problem with <math id="A1.SS1.7.p7.2.m2.1" class="ltx_Math" alttext="k^{\prime}=j" display="inline"><semantics id="A1.SS1.7.p7.2.m2.1a"><mrow id="A1.SS1.7.p7.2.m2.1.1" xref="A1.SS1.7.p7.2.m2.1.1.cmml"><msup id="A1.SS1.7.p7.2.m2.1.1.2" xref="A1.SS1.7.p7.2.m2.1.1.2.cmml"><mi id="A1.SS1.7.p7.2.m2.1.1.2.2" xref="A1.SS1.7.p7.2.m2.1.1.2.2.cmml">k</mi><mo id="A1.SS1.7.p7.2.m2.1.1.2.3" xref="A1.SS1.7.p7.2.m2.1.1.2.3.cmml">′</mo></msup><mo id="A1.SS1.7.p7.2.m2.1.1.1" xref="A1.SS1.7.p7.2.m2.1.1.1.cmml">=</mo><mi id="A1.SS1.7.p7.2.m2.1.1.3" xref="A1.SS1.7.p7.2.m2.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.7.p7.2.m2.1b"><apply id="A1.SS1.7.p7.2.m2.1.1.cmml" xref="A1.SS1.7.p7.2.m2.1.1"><eq id="A1.SS1.7.p7.2.m2.1.1.1.cmml" xref="A1.SS1.7.p7.2.m2.1.1.1"></eq><apply id="A1.SS1.7.p7.2.m2.1.1.2.cmml" xref="A1.SS1.7.p7.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.7.p7.2.m2.1.1.2.1.cmml" xref="A1.SS1.7.p7.2.m2.1.1.2">superscript</csymbol><ci id="A1.SS1.7.p7.2.m2.1.1.2.2.cmml" xref="A1.SS1.7.p7.2.m2.1.1.2.2">𝑘</ci><ci id="A1.SS1.7.p7.2.m2.1.1.2.3.cmml" xref="A1.SS1.7.p7.2.m2.1.1.2.3">′</ci></apply><ci id="A1.SS1.7.p7.2.m2.1.1.3.cmml" xref="A1.SS1.7.p7.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.7.p7.2.m2.1c">k^{\prime}=j</annotation></semantics></math> bars and <math id="A1.SS1.7.p7.3.m3.1" class="ltx_Math" alttext="n^{\prime}=n-i-2j" display="inline"><semantics id="A1.SS1.7.p7.3.m3.1a"><mrow id="A1.SS1.7.p7.3.m3.1.1" xref="A1.SS1.7.p7.3.m3.1.1.cmml"><msup id="A1.SS1.7.p7.3.m3.1.1.2" xref="A1.SS1.7.p7.3.m3.1.1.2.cmml"><mi id="A1.SS1.7.p7.3.m3.1.1.2.2" xref="A1.SS1.7.p7.3.m3.1.1.2.2.cmml">n</mi><mo id="A1.SS1.7.p7.3.m3.1.1.2.3" xref="A1.SS1.7.p7.3.m3.1.1.2.3.cmml">′</mo></msup><mo id="A1.SS1.7.p7.3.m3.1.1.1" xref="A1.SS1.7.p7.3.m3.1.1.1.cmml">=</mo><mrow id="A1.SS1.7.p7.3.m3.1.1.3" xref="A1.SS1.7.p7.3.m3.1.1.3.cmml"><mi id="A1.SS1.7.p7.3.m3.1.1.3.2" xref="A1.SS1.7.p7.3.m3.1.1.3.2.cmml">n</mi><mo id="A1.SS1.7.p7.3.m3.1.1.3.1" xref="A1.SS1.7.p7.3.m3.1.1.3.1.cmml">−</mo><mi id="A1.SS1.7.p7.3.m3.1.1.3.3" xref="A1.SS1.7.p7.3.m3.1.1.3.3.cmml">i</mi><mo id="A1.SS1.7.p7.3.m3.1.1.3.1a" xref="A1.SS1.7.p7.3.m3.1.1.3.1.cmml">−</mo><mrow id="A1.SS1.7.p7.3.m3.1.1.3.4" xref="A1.SS1.7.p7.3.m3.1.1.3.4.cmml"><mn id="A1.SS1.7.p7.3.m3.1.1.3.4.2" xref="A1.SS1.7.p7.3.m3.1.1.3.4.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A1.SS1.7.p7.3.m3.1.1.3.4.1" xref="A1.SS1.7.p7.3.m3.1.1.3.4.1.cmml">​</mo><mi id="A1.SS1.7.p7.3.m3.1.1.3.4.3" xref="A1.SS1.7.p7.3.m3.1.1.3.4.3.cmml">j</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.7.p7.3.m3.1b"><apply id="A1.SS1.7.p7.3.m3.1.1.cmml" xref="A1.SS1.7.p7.3.m3.1.1"><eq id="A1.SS1.7.p7.3.m3.1.1.1.cmml" xref="A1.SS1.7.p7.3.m3.1.1.1"></eq><apply id="A1.SS1.7.p7.3.m3.1.1.2.cmml" xref="A1.SS1.7.p7.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.7.p7.3.m3.1.1.2.1.cmml" xref="A1.SS1.7.p7.3.m3.1.1.2">superscript</csymbol><ci id="A1.SS1.7.p7.3.m3.1.1.2.2.cmml" xref="A1.SS1.7.p7.3.m3.1.1.2.2">𝑛</ci><ci id="A1.SS1.7.p7.3.m3.1.1.2.3.cmml" xref="A1.SS1.7.p7.3.m3.1.1.2.3">′</ci></apply><apply id="A1.SS1.7.p7.3.m3.1.1.3.cmml" xref="A1.SS1.7.p7.3.m3.1.1.3"><minus id="A1.SS1.7.p7.3.m3.1.1.3.1.cmml" xref="A1.SS1.7.p7.3.m3.1.1.3.1"></minus><ci id="A1.SS1.7.p7.3.m3.1.1.3.2.cmml" xref="A1.SS1.7.p7.3.m3.1.1.3.2">𝑛</ci><ci id="A1.SS1.7.p7.3.m3.1.1.3.3.cmml" xref="A1.SS1.7.p7.3.m3.1.1.3.3">𝑖</ci><apply id="A1.SS1.7.p7.3.m3.1.1.3.4.cmml" xref="A1.SS1.7.p7.3.m3.1.1.3.4"><times id="A1.SS1.7.p7.3.m3.1.1.3.4.1.cmml" xref="A1.SS1.7.p7.3.m3.1.1.3.4.1"></times><cn type="integer" id="A1.SS1.7.p7.3.m3.1.1.3.4.2.cmml" xref="A1.SS1.7.p7.3.m3.1.1.3.4.2">2</cn><ci id="A1.SS1.7.p7.3.m3.1.1.3.4.3.cmml" xref="A1.SS1.7.p7.3.m3.1.1.3.4.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.7.p7.3.m3.1c">n^{\prime}=n-i-2j</annotation></semantics></math> stars. This reduces to:</p>
<table id="A1.Ex15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex15.m1.2" class="ltx_Math" alttext="\binom{n-i-j-1}{j-1}" display="block"><semantics id="A1.Ex15.m1.2a"><mrow id="A1.Ex15.m1.2.2.4" xref="A1.Ex15.m1.2.2.3.cmml"><mo id="A1.Ex15.m1.2.2.4.1" xref="A1.Ex15.m1.2.2.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.Ex15.m1.2.2.2.2" xref="A1.Ex15.m1.2.2.3.cmml"><mrow id="A1.Ex15.m1.1.1.1.1.1.1" xref="A1.Ex15.m1.1.1.1.1.1.1.cmml"><mi id="A1.Ex15.m1.1.1.1.1.1.1.3" xref="A1.Ex15.m1.1.1.1.1.1.1.3.cmml">n</mi><mo id="A1.Ex15.m1.1.1.1.1.1.1.2" xref="A1.Ex15.m1.1.1.1.1.1.1.2.cmml">−</mo><mi id="A1.Ex15.m1.1.1.1.1.1.1.4" xref="A1.Ex15.m1.1.1.1.1.1.1.4.cmml">i</mi><mo id="A1.Ex15.m1.1.1.1.1.1.1.2a" xref="A1.Ex15.m1.1.1.1.1.1.1.2.cmml">−</mo><mi id="A1.Ex15.m1.1.1.1.1.1.1.5" xref="A1.Ex15.m1.1.1.1.1.1.1.5.cmml">j</mi><mo id="A1.Ex15.m1.1.1.1.1.1.1.2b" xref="A1.Ex15.m1.1.1.1.1.1.1.2.cmml">−</mo><mn id="A1.Ex15.m1.1.1.1.1.1.1.6" xref="A1.Ex15.m1.1.1.1.1.1.1.6.cmml">1</mn></mrow><mrow id="A1.Ex15.m1.2.2.2.2.2.1" xref="A1.Ex15.m1.2.2.2.2.2.1.cmml"><mi id="A1.Ex15.m1.2.2.2.2.2.1.3" xref="A1.Ex15.m1.2.2.2.2.2.1.3.cmml">j</mi><mo id="A1.Ex15.m1.2.2.2.2.2.1.2" xref="A1.Ex15.m1.2.2.2.2.2.1.2.cmml">−</mo><mn id="A1.Ex15.m1.2.2.2.2.2.1.4" xref="A1.Ex15.m1.2.2.2.2.2.1.4.cmml">1</mn></mrow></mfrac><mo id="A1.Ex15.m1.2.2.4.2" xref="A1.Ex15.m1.2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex15.m1.2b"><apply id="A1.Ex15.m1.2.2.3.cmml" xref="A1.Ex15.m1.2.2.4"><csymbol cd="latexml" id="A1.Ex15.m1.2.2.3.1.cmml" xref="A1.Ex15.m1.2.2.4.1">binomial</csymbol><apply id="A1.Ex15.m1.1.1.1.1.1.1.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1"><minus id="A1.Ex15.m1.1.1.1.1.1.1.2.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.2"></minus><ci id="A1.Ex15.m1.1.1.1.1.1.1.3.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.3">𝑛</ci><ci id="A1.Ex15.m1.1.1.1.1.1.1.4.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.4">𝑖</ci><ci id="A1.Ex15.m1.1.1.1.1.1.1.5.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.5">𝑗</ci><cn type="integer" id="A1.Ex15.m1.1.1.1.1.1.1.6.cmml" xref="A1.Ex15.m1.1.1.1.1.1.1.6">1</cn></apply><apply id="A1.Ex15.m1.2.2.2.2.2.1.cmml" xref="A1.Ex15.m1.2.2.2.2.2.1"><minus id="A1.Ex15.m1.2.2.2.2.2.1.2.cmml" xref="A1.Ex15.m1.2.2.2.2.2.1.2"></minus><ci id="A1.Ex15.m1.2.2.2.2.2.1.3.cmml" xref="A1.Ex15.m1.2.2.2.2.2.1.3">𝑗</ci><cn type="integer" id="A1.Ex15.m1.2.2.2.2.2.1.4.cmml" xref="A1.Ex15.m1.2.2.2.2.2.1.4">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex15.m1.2c">\binom{n-i-j-1}{j-1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS1.7.p7.9" class="ltx_p">orientations for the remaining bins with exactly <math id="A1.SS1.7.p7.4.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="A1.SS1.7.p7.4.m1.1a"><mi id="A1.SS1.7.p7.4.m1.1.1" xref="A1.SS1.7.p7.4.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.7.p7.4.m1.1b"><ci id="A1.SS1.7.p7.4.m1.1.1.cmml" xref="A1.SS1.7.p7.4.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.7.p7.4.m1.1c">j</annotation></semantics></math> elements. Once these <math id="A1.SS1.7.p7.5.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A1.SS1.7.p7.5.m2.1a"><mi id="A1.SS1.7.p7.5.m2.1.1" xref="A1.SS1.7.p7.5.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.7.p7.5.m2.1b"><ci id="A1.SS1.7.p7.5.m2.1.1.cmml" xref="A1.SS1.7.p7.5.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.7.p7.5.m2.1c">i</annotation></semantics></math> bins with <math id="A1.SS1.7.p7.6.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.SS1.7.p7.6.m3.1a"><mn id="A1.SS1.7.p7.6.m3.1.1" xref="A1.SS1.7.p7.6.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.7.p7.6.m3.1b"><cn type="integer" id="A1.SS1.7.p7.6.m3.1.1.cmml" xref="A1.SS1.7.p7.6.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.7.p7.6.m3.1c">1</annotation></semantics></math> element, and <math id="A1.SS1.7.p7.7.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="A1.SS1.7.p7.7.m4.1a"><mi id="A1.SS1.7.p7.7.m4.1.1" xref="A1.SS1.7.p7.7.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.7.p7.7.m4.1b"><ci id="A1.SS1.7.p7.7.m4.1.1.cmml" xref="A1.SS1.7.p7.7.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.7.p7.7.m4.1c">j</annotation></semantics></math> bins with <math id="A1.SS1.7.p7.8.m5.1" class="ltx_Math" alttext="\geq 2" display="inline"><semantics id="A1.SS1.7.p7.8.m5.1a"><mrow id="A1.SS1.7.p7.8.m5.1.1" xref="A1.SS1.7.p7.8.m5.1.1.cmml"><mi id="A1.SS1.7.p7.8.m5.1.1.2" xref="A1.SS1.7.p7.8.m5.1.1.2.cmml"></mi><mo id="A1.SS1.7.p7.8.m5.1.1.1" xref="A1.SS1.7.p7.8.m5.1.1.1.cmml">≥</mo><mn id="A1.SS1.7.p7.8.m5.1.1.3" xref="A1.SS1.7.p7.8.m5.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.7.p7.8.m5.1b"><apply id="A1.SS1.7.p7.8.m5.1.1.cmml" xref="A1.SS1.7.p7.8.m5.1.1"><geq id="A1.SS1.7.p7.8.m5.1.1.1.cmml" xref="A1.SS1.7.p7.8.m5.1.1.1"></geq><csymbol cd="latexml" id="A1.SS1.7.p7.8.m5.1.1.2.cmml" xref="A1.SS1.7.p7.8.m5.1.1.2">absent</csymbol><cn type="integer" id="A1.SS1.7.p7.8.m5.1.1.3.cmml" xref="A1.SS1.7.p7.8.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.7.p7.8.m5.1c">\geq 2</annotation></semantics></math> elements are chosen, all the other bins are required to have <math id="A1.SS1.7.p7.9.m6.1" class="ltx_Math" alttext="0" display="inline"><semantics id="A1.SS1.7.p7.9.m6.1a"><mn id="A1.SS1.7.p7.9.m6.1.1" xref="A1.SS1.7.p7.9.m6.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A1.SS1.7.p7.9.m6.1b"><cn type="integer" id="A1.SS1.7.p7.9.m6.1.1.cmml" xref="A1.SS1.7.p7.9.m6.1.1">0</cn></annotation-xml></semantics></math> elements.</p>
</div>
<div id="A1.SS1.8.p8" class="ltx_para ltx_noindent">
<p id="A1.SS1.8.p8.1" class="ltx_p">So adding these parts together, we have the expected amount data the server can expect to reconstruct perfectly becomes:</p>
</div>
<div id="A1.SS1.9.p9" class="ltx_para ltx_noindent">
<table id="A1.Ex16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex16.m1.16" class="ltx_Math" alttext="\frac{1}{\binom{k+n-1}{k-1}}\bigg{[}\sum_{i=1}^{n-2}i\cdot\binom{k}{i}\cdot\bigg{(}\sum_{j=1}^{\lfloor\frac{n-i}{2}\rfloor}\binom{k-i}{j}\binom{n-i-j-1}{j-1}\bigg{)}\bigg{]}+\overbrace{\frac{n}{\binom{k+n-1}{k-1}}\binom{k}{n}-\frac{n}{k}}^{r(n,k)}" display="block"><semantics id="A1.Ex16.m1.16a"><mrow id="A1.Ex16.m1.16.16" xref="A1.Ex16.m1.16.16.cmml"><mrow id="A1.Ex16.m1.16.16.1" xref="A1.Ex16.m1.16.16.1.cmml"><mfrac id="A1.Ex16.m1.2.2" xref="A1.Ex16.m1.2.2.cmml"><mn id="A1.Ex16.m1.2.2.4" xref="A1.Ex16.m1.2.2.4.cmml">1</mn><mrow id="A1.Ex16.m1.2.2.2.4" xref="A1.Ex16.m1.2.2.2.3.cmml"><mo id="A1.Ex16.m1.2.2.2.4.1" xref="A1.Ex16.m1.2.2.2.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.Ex16.m1.2.2.2.2.2.2" xref="A1.Ex16.m1.2.2.2.3.cmml"><mrow id="A1.Ex16.m1.1.1.1.1.1.1.1.1" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex16.m1.1.1.1.1.1.1.1.1.3" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.1" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mi id="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></mrow><mo id="A1.Ex16.m1.1.1.1.1.1.1.1.1.2" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mn id="A1.Ex16.m1.1.1.1.1.1.1.1.1.4" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.4.cmml">1</mn></mrow><mrow id="A1.Ex16.m1.2.2.2.2.2.2.2.1" xref="A1.Ex16.m1.2.2.2.2.2.2.2.1.cmml"><mi id="A1.Ex16.m1.2.2.2.2.2.2.2.1.3" xref="A1.Ex16.m1.2.2.2.2.2.2.2.1.3.cmml">k</mi><mo id="A1.Ex16.m1.2.2.2.2.2.2.2.1.2" xref="A1.Ex16.m1.2.2.2.2.2.2.2.1.2.cmml">−</mo><mn id="A1.Ex16.m1.2.2.2.2.2.2.2.1.4" xref="A1.Ex16.m1.2.2.2.2.2.2.2.1.4.cmml">1</mn></mrow></mfrac><mo id="A1.Ex16.m1.2.2.2.4.2" xref="A1.Ex16.m1.2.2.2.3.1.cmml">)</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="A1.Ex16.m1.16.16.1.2" xref="A1.Ex16.m1.16.16.1.2.cmml">​</mo><mrow id="A1.Ex16.m1.16.16.1.1.1" xref="A1.Ex16.m1.16.16.1.1.2.cmml"><mo maxsize="210%" minsize="210%" id="A1.Ex16.m1.16.16.1.1.1.2" xref="A1.Ex16.m1.16.16.1.1.2.1.cmml">[</mo><mrow id="A1.Ex16.m1.16.16.1.1.1.1" xref="A1.Ex16.m1.16.16.1.1.1.1.cmml"><munderover id="A1.Ex16.m1.16.16.1.1.1.1.2" xref="A1.Ex16.m1.16.16.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" id="A1.Ex16.m1.16.16.1.1.1.1.2.2.2" xref="A1.Ex16.m1.16.16.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.Ex16.m1.16.16.1.1.1.1.2.2.3" xref="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.cmml"><mi id="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.2" xref="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.1" xref="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.3" xref="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="A1.Ex16.m1.16.16.1.1.1.1.2.3" xref="A1.Ex16.m1.16.16.1.1.1.1.2.3.cmml"><mi id="A1.Ex16.m1.16.16.1.1.1.1.2.3.2" xref="A1.Ex16.m1.16.16.1.1.1.1.2.3.2.cmml">n</mi><mo id="A1.Ex16.m1.16.16.1.1.1.1.2.3.1" xref="A1.Ex16.m1.16.16.1.1.1.1.2.3.1.cmml">−</mo><mn id="A1.Ex16.m1.16.16.1.1.1.1.2.3.3" xref="A1.Ex16.m1.16.16.1.1.1.1.2.3.3.cmml">2</mn></mrow></munderover><mrow id="A1.Ex16.m1.16.16.1.1.1.1.1" xref="A1.Ex16.m1.16.16.1.1.1.1.1.cmml"><mi id="A1.Ex16.m1.16.16.1.1.1.1.1.3" xref="A1.Ex16.m1.16.16.1.1.1.1.1.3.cmml">i</mi><mo lspace="0.222em" rspace="0.222em" id="A1.Ex16.m1.16.16.1.1.1.1.1.2" xref="A1.Ex16.m1.16.16.1.1.1.1.1.2.cmml">⋅</mo><mrow id="A1.Ex16.m1.4.4.4" xref="A1.Ex16.m1.4.4.3.cmml"><mo id="A1.Ex16.m1.4.4.4.1" xref="A1.Ex16.m1.4.4.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.Ex16.m1.4.4.2.2" xref="A1.Ex16.m1.4.4.3.cmml"><mi id="A1.Ex16.m1.3.3.1.1.1.1" xref="A1.Ex16.m1.3.3.1.1.1.1.cmml">k</mi><mi id="A1.Ex16.m1.4.4.2.2.2.1" xref="A1.Ex16.m1.4.4.2.2.2.1.cmml">i</mi></mfrac><mo rspace="0.055em" id="A1.Ex16.m1.4.4.4.2" xref="A1.Ex16.m1.4.4.3.1.cmml">)</mo></mrow><mo rspace="0.222em" id="A1.Ex16.m1.16.16.1.1.1.1.1.2a" xref="A1.Ex16.m1.16.16.1.1.1.1.1.2.cmml">⋅</mo><mrow id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.cmml"><mo maxsize="210%" minsize="210%" id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.2" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.cmml"><munderover id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mrow id="A1.Ex16.m1.13.13.1.3" xref="A1.Ex16.m1.13.13.1.2.cmml"><mo stretchy="false" id="A1.Ex16.m1.13.13.1.3.1" xref="A1.Ex16.m1.13.13.1.2.1.cmml">⌊</mo><mfrac id="A1.Ex16.m1.13.13.1.1" xref="A1.Ex16.m1.13.13.1.1.cmml"><mrow id="A1.Ex16.m1.13.13.1.1.2" xref="A1.Ex16.m1.13.13.1.1.2.cmml"><mi id="A1.Ex16.m1.13.13.1.1.2.2" xref="A1.Ex16.m1.13.13.1.1.2.2.cmml">n</mi><mo id="A1.Ex16.m1.13.13.1.1.2.1" xref="A1.Ex16.m1.13.13.1.1.2.1.cmml">−</mo><mi id="A1.Ex16.m1.13.13.1.1.2.3" xref="A1.Ex16.m1.13.13.1.1.2.3.cmml">i</mi></mrow><mn id="A1.Ex16.m1.13.13.1.1.3" xref="A1.Ex16.m1.13.13.1.1.3.cmml">2</mn></mfrac><mo stretchy="false" id="A1.Ex16.m1.13.13.1.3.2" xref="A1.Ex16.m1.13.13.1.2.1.cmml">⌋</mo></mrow></munderover><mrow id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.2" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.2.cmml"><mrow id="A1.Ex16.m1.6.6.4" xref="A1.Ex16.m1.6.6.3.cmml"><mo id="A1.Ex16.m1.6.6.4.1" xref="A1.Ex16.m1.6.6.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.Ex16.m1.6.6.2.2" xref="A1.Ex16.m1.6.6.3.cmml"><mrow id="A1.Ex16.m1.5.5.1.1.1.1" xref="A1.Ex16.m1.5.5.1.1.1.1.cmml"><mi id="A1.Ex16.m1.5.5.1.1.1.1.3" xref="A1.Ex16.m1.5.5.1.1.1.1.3.cmml">k</mi><mo id="A1.Ex16.m1.5.5.1.1.1.1.2" xref="A1.Ex16.m1.5.5.1.1.1.1.2.cmml">−</mo><mi id="A1.Ex16.m1.5.5.1.1.1.1.4" xref="A1.Ex16.m1.5.5.1.1.1.1.4.cmml">i</mi></mrow><mi id="A1.Ex16.m1.6.6.2.2.2.1" xref="A1.Ex16.m1.6.6.2.2.2.1.cmml">j</mi></mfrac><mo id="A1.Ex16.m1.6.6.4.2" xref="A1.Ex16.m1.6.6.3.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.2.1" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="A1.Ex16.m1.8.8.4" xref="A1.Ex16.m1.8.8.3.cmml"><mo id="A1.Ex16.m1.8.8.4.1" xref="A1.Ex16.m1.8.8.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.Ex16.m1.8.8.2.2" xref="A1.Ex16.m1.8.8.3.cmml"><mrow id="A1.Ex16.m1.7.7.1.1.1.1" xref="A1.Ex16.m1.7.7.1.1.1.1.cmml"><mi id="A1.Ex16.m1.7.7.1.1.1.1.3" xref="A1.Ex16.m1.7.7.1.1.1.1.3.cmml">n</mi><mo id="A1.Ex16.m1.7.7.1.1.1.1.2" xref="A1.Ex16.m1.7.7.1.1.1.1.2.cmml">−</mo><mi id="A1.Ex16.m1.7.7.1.1.1.1.4" xref="A1.Ex16.m1.7.7.1.1.1.1.4.cmml">i</mi><mo id="A1.Ex16.m1.7.7.1.1.1.1.2a" xref="A1.Ex16.m1.7.7.1.1.1.1.2.cmml">−</mo><mi id="A1.Ex16.m1.7.7.1.1.1.1.5" xref="A1.Ex16.m1.7.7.1.1.1.1.5.cmml">j</mi><mo id="A1.Ex16.m1.7.7.1.1.1.1.2b" xref="A1.Ex16.m1.7.7.1.1.1.1.2.cmml">−</mo><mn id="A1.Ex16.m1.7.7.1.1.1.1.6" xref="A1.Ex16.m1.7.7.1.1.1.1.6.cmml">1</mn></mrow><mrow id="A1.Ex16.m1.8.8.2.2.2.1" xref="A1.Ex16.m1.8.8.2.2.2.1.cmml"><mi id="A1.Ex16.m1.8.8.2.2.2.1.3" xref="A1.Ex16.m1.8.8.2.2.2.1.3.cmml">j</mi><mo id="A1.Ex16.m1.8.8.2.2.2.1.2" xref="A1.Ex16.m1.8.8.2.2.2.1.2.cmml">−</mo><mn id="A1.Ex16.m1.8.8.2.2.2.1.4" xref="A1.Ex16.m1.8.8.2.2.2.1.4.cmml">1</mn></mrow></mfrac><mo id="A1.Ex16.m1.8.8.4.2" xref="A1.Ex16.m1.8.8.3.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="210%" minsize="210%" id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.3" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="210%" minsize="210%" id="A1.Ex16.m1.16.16.1.1.1.3" xref="A1.Ex16.m1.16.16.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex16.m1.16.16.2" xref="A1.Ex16.m1.16.16.2.cmml">+</mo><mover id="A1.Ex16.m1.16.16.3" xref="A1.Ex16.m1.16.16.3.cmml"><mover accent="true" id="A1.Ex16.m1.12.12" xref="A1.Ex16.m1.12.12.cmml"><mrow id="A1.Ex16.m1.12.12.4" xref="A1.Ex16.m1.12.12.4.cmml"><mrow id="A1.Ex16.m1.12.12.4.6" xref="A1.Ex16.m1.12.12.4.6.cmml"><mfrac id="A1.Ex16.m1.10.10.2.2" xref="A1.Ex16.m1.10.10.2.2.cmml"><mi id="A1.Ex16.m1.10.10.2.2.4" xref="A1.Ex16.m1.10.10.2.2.4.cmml">n</mi><mrow id="A1.Ex16.m1.10.10.2.2.2.4" xref="A1.Ex16.m1.10.10.2.2.2.3.cmml"><mo id="A1.Ex16.m1.10.10.2.2.2.4.1" xref="A1.Ex16.m1.10.10.2.2.2.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.Ex16.m1.10.10.2.2.2.2.2.2" xref="A1.Ex16.m1.10.10.2.2.2.3.cmml"><mrow id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.1" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mi id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.3" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></mrow><mo id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.2" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">−</mo><mn id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.4" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.4.cmml">1</mn></mrow><mrow id="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1" xref="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.cmml"><mi id="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.3" xref="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.3.cmml">k</mi><mo id="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.2" xref="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.2.cmml">−</mo><mn id="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.4" xref="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.4.cmml">1</mn></mrow></mfrac><mo id="A1.Ex16.m1.10.10.2.2.2.4.2" xref="A1.Ex16.m1.10.10.2.2.2.3.1.cmml">)</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="A1.Ex16.m1.12.12.4.6.1" xref="A1.Ex16.m1.12.12.4.6.1.cmml">​</mo><mrow id="A1.Ex16.m1.12.12.4.4.4" xref="A1.Ex16.m1.12.12.4.4.3.cmml"><mo id="A1.Ex16.m1.12.12.4.4.4.1" xref="A1.Ex16.m1.12.12.4.4.3.1.cmml">(</mo><mfrac linethickness="0pt" id="A1.Ex16.m1.12.12.4.4.2.2" xref="A1.Ex16.m1.12.12.4.4.3.cmml"><mi id="A1.Ex16.m1.11.11.3.3.1.1.1.1" xref="A1.Ex16.m1.11.11.3.3.1.1.1.1.cmml">k</mi><mi id="A1.Ex16.m1.12.12.4.4.2.2.2.1" xref="A1.Ex16.m1.12.12.4.4.2.2.2.1.cmml">n</mi></mfrac><mo id="A1.Ex16.m1.12.12.4.4.4.2" xref="A1.Ex16.m1.12.12.4.4.3.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex16.m1.12.12.4.5" xref="A1.Ex16.m1.12.12.4.5.cmml">−</mo><mfrac id="A1.Ex16.m1.12.12.4.7" xref="A1.Ex16.m1.12.12.4.7.cmml"><mi id="A1.Ex16.m1.12.12.4.7.2" xref="A1.Ex16.m1.12.12.4.7.2.cmml">n</mi><mi id="A1.Ex16.m1.12.12.4.7.3" xref="A1.Ex16.m1.12.12.4.7.3.cmml">k</mi></mfrac></mrow><mo id="A1.Ex16.m1.12.12.5" xref="A1.Ex16.m1.12.12.5.cmml">⏞</mo></mover><mrow id="A1.Ex16.m1.15.15.2" xref="A1.Ex16.m1.15.15.2.cmml"><mi id="A1.Ex16.m1.15.15.2.4" xref="A1.Ex16.m1.15.15.2.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.Ex16.m1.15.15.2.3" xref="A1.Ex16.m1.15.15.2.3.cmml">​</mo><mrow id="A1.Ex16.m1.15.15.2.5.2" xref="A1.Ex16.m1.15.15.2.5.1.cmml"><mo stretchy="false" id="A1.Ex16.m1.15.15.2.5.2.1" xref="A1.Ex16.m1.15.15.2.5.1.cmml">(</mo><mi id="A1.Ex16.m1.14.14.1.1" xref="A1.Ex16.m1.14.14.1.1.cmml">n</mi><mo id="A1.Ex16.m1.15.15.2.5.2.2" xref="A1.Ex16.m1.15.15.2.5.1.cmml">,</mo><mi id="A1.Ex16.m1.15.15.2.2" xref="A1.Ex16.m1.15.15.2.2.cmml">k</mi><mo stretchy="false" id="A1.Ex16.m1.15.15.2.5.2.3" xref="A1.Ex16.m1.15.15.2.5.1.cmml">)</mo></mrow></mrow></mover></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex16.m1.16b"><apply id="A1.Ex16.m1.16.16.cmml" xref="A1.Ex16.m1.16.16"><plus id="A1.Ex16.m1.16.16.2.cmml" xref="A1.Ex16.m1.16.16.2"></plus><apply id="A1.Ex16.m1.16.16.1.cmml" xref="A1.Ex16.m1.16.16.1"><times id="A1.Ex16.m1.16.16.1.2.cmml" xref="A1.Ex16.m1.16.16.1.2"></times><apply id="A1.Ex16.m1.2.2.cmml" xref="A1.Ex16.m1.2.2"><divide id="A1.Ex16.m1.2.2.3.cmml" xref="A1.Ex16.m1.2.2"></divide><cn type="integer" id="A1.Ex16.m1.2.2.4.cmml" xref="A1.Ex16.m1.2.2.4">1</cn><apply id="A1.Ex16.m1.2.2.2.3.cmml" xref="A1.Ex16.m1.2.2.2.4"><csymbol cd="latexml" id="A1.Ex16.m1.2.2.2.3.1.cmml" xref="A1.Ex16.m1.2.2.2.4.1">binomial</csymbol><apply id="A1.Ex16.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1"><minus id="A1.Ex16.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.2"></minus><apply id="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.3"><plus id="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.2">𝑘</ci><ci id="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply><cn type="integer" id="A1.Ex16.m1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex16.m1.1.1.1.1.1.1.1.1.4">1</cn></apply><apply id="A1.Ex16.m1.2.2.2.2.2.2.2.1.cmml" xref="A1.Ex16.m1.2.2.2.2.2.2.2.1"><minus id="A1.Ex16.m1.2.2.2.2.2.2.2.1.2.cmml" xref="A1.Ex16.m1.2.2.2.2.2.2.2.1.2"></minus><ci id="A1.Ex16.m1.2.2.2.2.2.2.2.1.3.cmml" xref="A1.Ex16.m1.2.2.2.2.2.2.2.1.3">𝑘</ci><cn type="integer" id="A1.Ex16.m1.2.2.2.2.2.2.2.1.4.cmml" xref="A1.Ex16.m1.2.2.2.2.2.2.2.1.4">1</cn></apply></apply></apply><apply id="A1.Ex16.m1.16.16.1.1.2.cmml" xref="A1.Ex16.m1.16.16.1.1.1"><csymbol cd="latexml" id="A1.Ex16.m1.16.16.1.1.2.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex16.m1.16.16.1.1.1.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1"><apply id="A1.Ex16.m1.16.16.1.1.1.1.2.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex16.m1.16.16.1.1.1.1.2.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2">superscript</csymbol><apply id="A1.Ex16.m1.16.16.1.1.1.1.2.2.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.Ex16.m1.16.16.1.1.1.1.2.2.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2">subscript</csymbol><sum id="A1.Ex16.m1.16.16.1.1.1.1.2.2.2.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2.2.2"></sum><apply id="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2.2.3"><eq id="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.1"></eq><ci id="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.2.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.3.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="A1.Ex16.m1.16.16.1.1.1.1.2.3.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2.3"><minus id="A1.Ex16.m1.16.16.1.1.1.1.2.3.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2.3.1"></minus><ci id="A1.Ex16.m1.16.16.1.1.1.1.2.3.2.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2.3.2">𝑛</ci><cn type="integer" id="A1.Ex16.m1.16.16.1.1.1.1.2.3.3.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="A1.Ex16.m1.16.16.1.1.1.1.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1"><ci id="A1.Ex16.m1.16.16.1.1.1.1.1.2.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.2">⋅</ci><ci id="A1.Ex16.m1.16.16.1.1.1.1.1.3.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.3">𝑖</ci><apply id="A1.Ex16.m1.4.4.3.cmml" xref="A1.Ex16.m1.4.4.4"><csymbol cd="latexml" id="A1.Ex16.m1.4.4.3.1.cmml" xref="A1.Ex16.m1.4.4.4.1">binomial</csymbol><ci id="A1.Ex16.m1.3.3.1.1.1.1.cmml" xref="A1.Ex16.m1.3.3.1.1.1.1">𝑘</ci><ci id="A1.Ex16.m1.4.4.2.2.2.1.cmml" xref="A1.Ex16.m1.4.4.2.2.2.1">𝑖</ci></apply><apply id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1"><apply id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3"><eq id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.Ex16.m1.13.13.1.2.cmml" xref="A1.Ex16.m1.13.13.1.3"><floor id="A1.Ex16.m1.13.13.1.2.1.cmml" xref="A1.Ex16.m1.13.13.1.3.1"></floor><apply id="A1.Ex16.m1.13.13.1.1.cmml" xref="A1.Ex16.m1.13.13.1.1"><divide id="A1.Ex16.m1.13.13.1.1.1.cmml" xref="A1.Ex16.m1.13.13.1.1"></divide><apply id="A1.Ex16.m1.13.13.1.1.2.cmml" xref="A1.Ex16.m1.13.13.1.1.2"><minus id="A1.Ex16.m1.13.13.1.1.2.1.cmml" xref="A1.Ex16.m1.13.13.1.1.2.1"></minus><ci id="A1.Ex16.m1.13.13.1.1.2.2.cmml" xref="A1.Ex16.m1.13.13.1.1.2.2">𝑛</ci><ci id="A1.Ex16.m1.13.13.1.1.2.3.cmml" xref="A1.Ex16.m1.13.13.1.1.2.3">𝑖</ci></apply><cn type="integer" id="A1.Ex16.m1.13.13.1.1.3.cmml" xref="A1.Ex16.m1.13.13.1.1.3">2</cn></apply></apply></apply><apply id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.2"><times id="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex16.m1.16.16.1.1.1.1.1.1.1.1.2.1"></times><apply id="A1.Ex16.m1.6.6.3.cmml" xref="A1.Ex16.m1.6.6.4"><csymbol cd="latexml" id="A1.Ex16.m1.6.6.3.1.cmml" xref="A1.Ex16.m1.6.6.4.1">binomial</csymbol><apply id="A1.Ex16.m1.5.5.1.1.1.1.cmml" xref="A1.Ex16.m1.5.5.1.1.1.1"><minus id="A1.Ex16.m1.5.5.1.1.1.1.2.cmml" xref="A1.Ex16.m1.5.5.1.1.1.1.2"></minus><ci id="A1.Ex16.m1.5.5.1.1.1.1.3.cmml" xref="A1.Ex16.m1.5.5.1.1.1.1.3">𝑘</ci><ci id="A1.Ex16.m1.5.5.1.1.1.1.4.cmml" xref="A1.Ex16.m1.5.5.1.1.1.1.4">𝑖</ci></apply><ci id="A1.Ex16.m1.6.6.2.2.2.1.cmml" xref="A1.Ex16.m1.6.6.2.2.2.1">𝑗</ci></apply><apply id="A1.Ex16.m1.8.8.3.cmml" xref="A1.Ex16.m1.8.8.4"><csymbol cd="latexml" id="A1.Ex16.m1.8.8.3.1.cmml" xref="A1.Ex16.m1.8.8.4.1">binomial</csymbol><apply id="A1.Ex16.m1.7.7.1.1.1.1.cmml" xref="A1.Ex16.m1.7.7.1.1.1.1"><minus id="A1.Ex16.m1.7.7.1.1.1.1.2.cmml" xref="A1.Ex16.m1.7.7.1.1.1.1.2"></minus><ci id="A1.Ex16.m1.7.7.1.1.1.1.3.cmml" xref="A1.Ex16.m1.7.7.1.1.1.1.3">𝑛</ci><ci id="A1.Ex16.m1.7.7.1.1.1.1.4.cmml" xref="A1.Ex16.m1.7.7.1.1.1.1.4">𝑖</ci><ci id="A1.Ex16.m1.7.7.1.1.1.1.5.cmml" xref="A1.Ex16.m1.7.7.1.1.1.1.5">𝑗</ci><cn type="integer" id="A1.Ex16.m1.7.7.1.1.1.1.6.cmml" xref="A1.Ex16.m1.7.7.1.1.1.1.6">1</cn></apply><apply id="A1.Ex16.m1.8.8.2.2.2.1.cmml" xref="A1.Ex16.m1.8.8.2.2.2.1"><minus id="A1.Ex16.m1.8.8.2.2.2.1.2.cmml" xref="A1.Ex16.m1.8.8.2.2.2.1.2"></minus><ci id="A1.Ex16.m1.8.8.2.2.2.1.3.cmml" xref="A1.Ex16.m1.8.8.2.2.2.1.3">𝑗</ci><cn type="integer" id="A1.Ex16.m1.8.8.2.2.2.1.4.cmml" xref="A1.Ex16.m1.8.8.2.2.2.1.4">1</cn></apply></apply></apply></apply></apply></apply></apply></apply><apply id="A1.Ex16.m1.16.16.3.cmml" xref="A1.Ex16.m1.16.16.3"><csymbol cd="ambiguous" id="A1.Ex16.m1.16.16.3.1.cmml" xref="A1.Ex16.m1.16.16.3">superscript</csymbol><apply id="A1.Ex16.m1.12.12.cmml" xref="A1.Ex16.m1.12.12"><ci id="A1.Ex16.m1.12.12.5.cmml" xref="A1.Ex16.m1.12.12.5">⏞</ci><apply id="A1.Ex16.m1.12.12.4.cmml" xref="A1.Ex16.m1.12.12.4"><minus id="A1.Ex16.m1.12.12.4.5.cmml" xref="A1.Ex16.m1.12.12.4.5"></minus><apply id="A1.Ex16.m1.12.12.4.6.cmml" xref="A1.Ex16.m1.12.12.4.6"><times id="A1.Ex16.m1.12.12.4.6.1.cmml" xref="A1.Ex16.m1.12.12.4.6.1"></times><apply id="A1.Ex16.m1.10.10.2.2.cmml" xref="A1.Ex16.m1.10.10.2.2"><divide id="A1.Ex16.m1.10.10.2.2.3.cmml" xref="A1.Ex16.m1.10.10.2.2"></divide><ci id="A1.Ex16.m1.10.10.2.2.4.cmml" xref="A1.Ex16.m1.10.10.2.2.4">𝑛</ci><apply id="A1.Ex16.m1.10.10.2.2.2.3.cmml" xref="A1.Ex16.m1.10.10.2.2.2.4"><csymbol cd="latexml" id="A1.Ex16.m1.10.10.2.2.2.3.1.cmml" xref="A1.Ex16.m1.10.10.2.2.2.4.1">binomial</csymbol><apply id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1"><minus id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.2"></minus><apply id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3"><plus id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.1"></plus><ci id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.2">𝑘</ci><ci id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply><cn type="integer" id="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex16.m1.9.9.1.1.1.1.1.1.1.1.4">1</cn></apply><apply id="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.cmml" xref="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1"><minus id="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.2.cmml" xref="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.2"></minus><ci id="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.3.cmml" xref="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.3">𝑘</ci><cn type="integer" id="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.4.cmml" xref="A1.Ex16.m1.10.10.2.2.2.2.2.2.2.1.4">1</cn></apply></apply></apply><apply id="A1.Ex16.m1.12.12.4.4.3.cmml" xref="A1.Ex16.m1.12.12.4.4.4"><csymbol cd="latexml" id="A1.Ex16.m1.12.12.4.4.3.1.cmml" xref="A1.Ex16.m1.12.12.4.4.4.1">binomial</csymbol><ci id="A1.Ex16.m1.11.11.3.3.1.1.1.1.cmml" xref="A1.Ex16.m1.11.11.3.3.1.1.1.1">𝑘</ci><ci id="A1.Ex16.m1.12.12.4.4.2.2.2.1.cmml" xref="A1.Ex16.m1.12.12.4.4.2.2.2.1">𝑛</ci></apply></apply><apply id="A1.Ex16.m1.12.12.4.7.cmml" xref="A1.Ex16.m1.12.12.4.7"><divide id="A1.Ex16.m1.12.12.4.7.1.cmml" xref="A1.Ex16.m1.12.12.4.7"></divide><ci id="A1.Ex16.m1.12.12.4.7.2.cmml" xref="A1.Ex16.m1.12.12.4.7.2">𝑛</ci><ci id="A1.Ex16.m1.12.12.4.7.3.cmml" xref="A1.Ex16.m1.12.12.4.7.3">𝑘</ci></apply></apply></apply><apply id="A1.Ex16.m1.15.15.2.cmml" xref="A1.Ex16.m1.15.15.2"><times id="A1.Ex16.m1.15.15.2.3.cmml" xref="A1.Ex16.m1.15.15.2.3"></times><ci id="A1.Ex16.m1.15.15.2.4.cmml" xref="A1.Ex16.m1.15.15.2.4">𝑟</ci><interval closure="open" id="A1.Ex16.m1.15.15.2.5.1.cmml" xref="A1.Ex16.m1.15.15.2.5.2"><ci id="A1.Ex16.m1.14.14.1.1.cmml" xref="A1.Ex16.m1.14.14.1.1">𝑛</ci><ci id="A1.Ex16.m1.15.15.2.2.cmml" xref="A1.Ex16.m1.15.15.2.2">𝑘</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex16.m1.16c">\frac{1}{\binom{k+n-1}{k-1}}\bigg{[}\sum_{i=1}^{n-2}i\cdot\binom{k}{i}\cdot\bigg{(}\sum_{j=1}^{\lfloor\frac{n-i}{2}\rfloor}\binom{k-i}{j}\binom{n-i-j-1}{j-1}\bigg{)}\bigg{]}+\overbrace{\frac{n}{\binom{k+n-1}{k-1}}\binom{k}{n}-\frac{n}{k}}^{r(n,k)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="A1.SS1.10.p10" class="ltx_para">
<p id="A1.SS1.10.p10.1" class="ltx_p">We call the last two “residual” terms <math id="A1.SS1.10.p10.1.m1.2" class="ltx_Math" alttext="r(n,k)" display="inline"><semantics id="A1.SS1.10.p10.1.m1.2a"><mrow id="A1.SS1.10.p10.1.m1.2.3" xref="A1.SS1.10.p10.1.m1.2.3.cmml"><mi id="A1.SS1.10.p10.1.m1.2.3.2" xref="A1.SS1.10.p10.1.m1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.SS1.10.p10.1.m1.2.3.1" xref="A1.SS1.10.p10.1.m1.2.3.1.cmml">​</mo><mrow id="A1.SS1.10.p10.1.m1.2.3.3.2" xref="A1.SS1.10.p10.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="A1.SS1.10.p10.1.m1.2.3.3.2.1" xref="A1.SS1.10.p10.1.m1.2.3.3.1.cmml">(</mo><mi id="A1.SS1.10.p10.1.m1.1.1" xref="A1.SS1.10.p10.1.m1.1.1.cmml">n</mi><mo id="A1.SS1.10.p10.1.m1.2.3.3.2.2" xref="A1.SS1.10.p10.1.m1.2.3.3.1.cmml">,</mo><mi id="A1.SS1.10.p10.1.m1.2.2" xref="A1.SS1.10.p10.1.m1.2.2.cmml">k</mi><mo stretchy="false" id="A1.SS1.10.p10.1.m1.2.3.3.2.3" xref="A1.SS1.10.p10.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.10.p10.1.m1.2b"><apply id="A1.SS1.10.p10.1.m1.2.3.cmml" xref="A1.SS1.10.p10.1.m1.2.3"><times id="A1.SS1.10.p10.1.m1.2.3.1.cmml" xref="A1.SS1.10.p10.1.m1.2.3.1"></times><ci id="A1.SS1.10.p10.1.m1.2.3.2.cmml" xref="A1.SS1.10.p10.1.m1.2.3.2">𝑟</ci><interval closure="open" id="A1.SS1.10.p10.1.m1.2.3.3.1.cmml" xref="A1.SS1.10.p10.1.m1.2.3.3.2"><ci id="A1.SS1.10.p10.1.m1.1.1.cmml" xref="A1.SS1.10.p10.1.m1.1.1">𝑛</ci><ci id="A1.SS1.10.p10.1.m1.2.2.cmml" xref="A1.SS1.10.p10.1.m1.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.10.p10.1.m1.2c">r(n,k)</annotation></semantics></math>. The first of these terms corresponds to the term in the expectation where all elements of the batch end up in separate bins, and the second term is the expected number of elements that land in the tail of the CDF not covered in any bin.
∎</p>
</div>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Other Choices of Linear Functions and Distributions</h3>

<div id="A1.SS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS2.p1.2" class="ltx_p">In previous experiments we have restricted our investigations to the linear function <math id="A1.SS2.p1.1.m1.1" class="ltx_Math" alttext="h:\mathbb{R}^{m}\to\mathbb{R}" display="inline"><semantics id="A1.SS2.p1.1.m1.1a"><mrow id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml"><mi id="A1.SS2.p1.1.m1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.2.cmml">h</mi><mo lspace="0.278em" rspace="0.278em" id="A1.SS2.p1.1.m1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.cmml">:</mo><mrow id="A1.SS2.p1.1.m1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.3.cmml"><msup id="A1.SS2.p1.1.m1.1.1.3.2" xref="A1.SS2.p1.1.m1.1.1.3.2.cmml"><mi id="A1.SS2.p1.1.m1.1.1.3.2.2" xref="A1.SS2.p1.1.m1.1.1.3.2.2.cmml">ℝ</mi><mi id="A1.SS2.p1.1.m1.1.1.3.2.3" xref="A1.SS2.p1.1.m1.1.1.3.2.3.cmml">m</mi></msup><mo stretchy="false" id="A1.SS2.p1.1.m1.1.1.3.1" xref="A1.SS2.p1.1.m1.1.1.3.1.cmml">→</mo><mi id="A1.SS2.p1.1.m1.1.1.3.3" xref="A1.SS2.p1.1.m1.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1"><ci id="A1.SS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1">:</ci><ci id="A1.SS2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.2">ℎ</ci><apply id="A1.SS2.p1.1.m1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.3"><ci id="A1.SS2.p1.1.m1.1.1.3.1.cmml" xref="A1.SS2.p1.1.m1.1.1.3.1">→</ci><apply id="A1.SS2.p1.1.m1.1.1.3.2.cmml" xref="A1.SS2.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.1.3.2.1.cmml" xref="A1.SS2.p1.1.m1.1.1.3.2">superscript</csymbol><ci id="A1.SS2.p1.1.m1.1.1.3.2.2.cmml" xref="A1.SS2.p1.1.m1.1.1.3.2.2">ℝ</ci><ci id="A1.SS2.p1.1.m1.1.1.3.2.3.cmml" xref="A1.SS2.p1.1.m1.1.1.3.2.3">𝑚</ci></apply><ci id="A1.SS2.p1.1.m1.1.1.3.3.cmml" xref="A1.SS2.p1.1.m1.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">h:\mathbb{R}^{m}\to\mathbb{R}</annotation></semantics></math> that measures average brightness, i.e. <math id="A1.SS2.p1.2.m2.1" class="ltx_Math" alttext="h(x)=\frac{1}{m}\sum_{i=1}^{m}x_{i}" display="inline"><semantics id="A1.SS2.p1.2.m2.1a"><mrow id="A1.SS2.p1.2.m2.1.2" xref="A1.SS2.p1.2.m2.1.2.cmml"><mrow id="A1.SS2.p1.2.m2.1.2.2" xref="A1.SS2.p1.2.m2.1.2.2.cmml"><mi id="A1.SS2.p1.2.m2.1.2.2.2" xref="A1.SS2.p1.2.m2.1.2.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p1.2.m2.1.2.2.1" xref="A1.SS2.p1.2.m2.1.2.2.1.cmml">​</mo><mrow id="A1.SS2.p1.2.m2.1.2.2.3.2" xref="A1.SS2.p1.2.m2.1.2.2.cmml"><mo stretchy="false" id="A1.SS2.p1.2.m2.1.2.2.3.2.1" xref="A1.SS2.p1.2.m2.1.2.2.cmml">(</mo><mi id="A1.SS2.p1.2.m2.1.1" xref="A1.SS2.p1.2.m2.1.1.cmml">x</mi><mo stretchy="false" id="A1.SS2.p1.2.m2.1.2.2.3.2.2" xref="A1.SS2.p1.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p1.2.m2.1.2.1" xref="A1.SS2.p1.2.m2.1.2.1.cmml">=</mo><mrow id="A1.SS2.p1.2.m2.1.2.3" xref="A1.SS2.p1.2.m2.1.2.3.cmml"><mfrac id="A1.SS2.p1.2.m2.1.2.3.2" xref="A1.SS2.p1.2.m2.1.2.3.2.cmml"><mn id="A1.SS2.p1.2.m2.1.2.3.2.2" xref="A1.SS2.p1.2.m2.1.2.3.2.2.cmml">1</mn><mi id="A1.SS2.p1.2.m2.1.2.3.2.3" xref="A1.SS2.p1.2.m2.1.2.3.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="A1.SS2.p1.2.m2.1.2.3.1" xref="A1.SS2.p1.2.m2.1.2.3.1.cmml">​</mo><mrow id="A1.SS2.p1.2.m2.1.2.3.3" xref="A1.SS2.p1.2.m2.1.2.3.3.cmml"><msubsup id="A1.SS2.p1.2.m2.1.2.3.3.1" xref="A1.SS2.p1.2.m2.1.2.3.3.1.cmml"><mo id="A1.SS2.p1.2.m2.1.2.3.3.1.2.2" xref="A1.SS2.p1.2.m2.1.2.3.3.1.2.2.cmml">∑</mo><mrow id="A1.SS2.p1.2.m2.1.2.3.3.1.2.3" xref="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.cmml"><mi id="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.2" xref="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.2.cmml">i</mi><mo id="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.1" xref="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.3" xref="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="A1.SS2.p1.2.m2.1.2.3.3.1.3" xref="A1.SS2.p1.2.m2.1.2.3.3.1.3.cmml">m</mi></msubsup><msub id="A1.SS2.p1.2.m2.1.2.3.3.2" xref="A1.SS2.p1.2.m2.1.2.3.3.2.cmml"><mi id="A1.SS2.p1.2.m2.1.2.3.3.2.2" xref="A1.SS2.p1.2.m2.1.2.3.3.2.2.cmml">x</mi><mi id="A1.SS2.p1.2.m2.1.2.3.3.2.3" xref="A1.SS2.p1.2.m2.1.2.3.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.1b"><apply id="A1.SS2.p1.2.m2.1.2.cmml" xref="A1.SS2.p1.2.m2.1.2"><eq id="A1.SS2.p1.2.m2.1.2.1.cmml" xref="A1.SS2.p1.2.m2.1.2.1"></eq><apply id="A1.SS2.p1.2.m2.1.2.2.cmml" xref="A1.SS2.p1.2.m2.1.2.2"><times id="A1.SS2.p1.2.m2.1.2.2.1.cmml" xref="A1.SS2.p1.2.m2.1.2.2.1"></times><ci id="A1.SS2.p1.2.m2.1.2.2.2.cmml" xref="A1.SS2.p1.2.m2.1.2.2.2">ℎ</ci><ci id="A1.SS2.p1.2.m2.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1">𝑥</ci></apply><apply id="A1.SS2.p1.2.m2.1.2.3.cmml" xref="A1.SS2.p1.2.m2.1.2.3"><times id="A1.SS2.p1.2.m2.1.2.3.1.cmml" xref="A1.SS2.p1.2.m2.1.2.3.1"></times><apply id="A1.SS2.p1.2.m2.1.2.3.2.cmml" xref="A1.SS2.p1.2.m2.1.2.3.2"><divide id="A1.SS2.p1.2.m2.1.2.3.2.1.cmml" xref="A1.SS2.p1.2.m2.1.2.3.2"></divide><cn type="integer" id="A1.SS2.p1.2.m2.1.2.3.2.2.cmml" xref="A1.SS2.p1.2.m2.1.2.3.2.2">1</cn><ci id="A1.SS2.p1.2.m2.1.2.3.2.3.cmml" xref="A1.SS2.p1.2.m2.1.2.3.2.3">𝑚</ci></apply><apply id="A1.SS2.p1.2.m2.1.2.3.3.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3"><apply id="A1.SS2.p1.2.m2.1.2.3.3.1.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.1"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m2.1.2.3.3.1.1.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.1">superscript</csymbol><apply id="A1.SS2.p1.2.m2.1.2.3.3.1.2.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.1"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m2.1.2.3.3.1.2.1.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.1">subscript</csymbol><sum id="A1.SS2.p1.2.m2.1.2.3.3.1.2.2.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.1.2.2"></sum><apply id="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.1.2.3"><eq id="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.1.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.1"></eq><ci id="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.2.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.3.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="A1.SS2.p1.2.m2.1.2.3.3.1.3.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.1.3">𝑚</ci></apply><apply id="A1.SS2.p1.2.m2.1.2.3.3.2.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.2"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m2.1.2.3.3.2.1.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.2">subscript</csymbol><ci id="A1.SS2.p1.2.m2.1.2.3.3.2.2.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.2.2">𝑥</ci><ci id="A1.SS2.p1.2.m2.1.2.3.3.2.3.cmml" xref="A1.SS2.p1.2.m2.1.2.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.1c">h(x)=\frac{1}{m}\sum_{i=1}^{m}x_{i}</annotation></semantics></math> which we approximate to be normally distributed. Given that ImageNet (and this also applies to most image datasets) is pre-processed by normalization by color in each channel, and that the number of pixels is large and they are not perfectly correlated, this is a reasonable approximation based on the central limit theorem that could similarly apply to other data modalities as well. For analysis, we visualize the closeness of this approximation based on an evaluation over the full ImageNet validation set in <a href="#A1.F6" title="In A.2 Other Choices of Linear Functions and Distributions ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<div id="A1.SS2.p2" class="ltx_para ltx_noindent">
<p id="A1.SS2.p2.2" class="ltx_p">We verify that the actual ground truth distribution can be approximated by a normal distribution, but we also see that the approximation is imperfect. The attack works well in <a href="#S3.F2" title="In 3.3 Imprinting User Information into Model Updates ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a> even with this discrepancy, however it could be further improved if the attacker has more accurate about the CDF. Image brightness is better described by a Laplacian distribution <cite class="ltx_cite ltx_citemacro_cite">Ruderman (<a href="#bib.bib28" title="" class="ltx_ref">1994</a>); Huang &amp; Mumford (<a href="#bib.bib11" title="" class="ltx_ref">1999</a>)</cite>. Replacing the normal distribution by a Laplacian distribution with scale <math id="A1.SS2.p2.1.m1.1" class="ltx_Math" alttext="1/\sqrt{2}" display="inline"><semantics id="A1.SS2.p2.1.m1.1a"><mrow id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml"><mn id="A1.SS2.p2.1.m1.1.1.2" xref="A1.SS2.p2.1.m1.1.1.2.cmml">1</mn><mo id="A1.SS2.p2.1.m1.1.1.1" xref="A1.SS2.p2.1.m1.1.1.1.cmml">/</mo><msqrt id="A1.SS2.p2.1.m1.1.1.3" xref="A1.SS2.p2.1.m1.1.1.3.cmml"><mn id="A1.SS2.p2.1.m1.1.1.3.2" xref="A1.SS2.p2.1.m1.1.1.3.2.cmml">2</mn></msqrt></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><apply id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1"><divide id="A1.SS2.p2.1.m1.1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1.1"></divide><cn type="integer" id="A1.SS2.p2.1.m1.1.1.2.cmml" xref="A1.SS2.p2.1.m1.1.1.2">1</cn><apply id="A1.SS2.p2.1.m1.1.1.3.cmml" xref="A1.SS2.p2.1.m1.1.1.3"><root id="A1.SS2.p2.1.m1.1.1.3a.cmml" xref="A1.SS2.p2.1.m1.1.1.3"></root><cn type="integer" id="A1.SS2.p2.1.m1.1.1.3.2.cmml" xref="A1.SS2.p2.1.m1.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">1/\sqrt{2}</annotation></semantics></math> does improve the accuracy slightly. This distribution can be further stabilized by considering higher frequencies compared to the mean, e.g. via DCT coefficients <cite class="ltx_cite ltx_citemacro_cite">Lam &amp; Goodman (<a href="#bib.bib16" title="" class="ltx_ref">2000</a>); Huang &amp; Mumford (<a href="#bib.bib11" title="" class="ltx_ref">1999</a>)</cite>. We accordingly also visualize this distribution for e.g. the 32nd DCT coefficient in <a href="#A1.F6" title="In A.2 Other Choices of Linear Functions and Distributions ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a> and use this cosine wave for the imprint module (with scaling factor <math id="A1.SS2.p2.2.m2.1" class="ltx_Math" alttext="\frac{4}{m}f" display="inline"><semantics id="A1.SS2.p2.2.m2.1a"><mrow id="A1.SS2.p2.2.m2.1.1" xref="A1.SS2.p2.2.m2.1.1.cmml"><mfrac id="A1.SS2.p2.2.m2.1.1.2" xref="A1.SS2.p2.2.m2.1.1.2.cmml"><mn id="A1.SS2.p2.2.m2.1.1.2.2" xref="A1.SS2.p2.2.m2.1.1.2.2.cmml">4</mn><mi id="A1.SS2.p2.2.m2.1.1.2.3" xref="A1.SS2.p2.2.m2.1.1.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="A1.SS2.p2.2.m2.1.1.1" xref="A1.SS2.p2.2.m2.1.1.1.cmml">​</mo><mi id="A1.SS2.p2.2.m2.1.1.3" xref="A1.SS2.p2.2.m2.1.1.3.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.2.m2.1b"><apply id="A1.SS2.p2.2.m2.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1"><times id="A1.SS2.p2.2.m2.1.1.1.cmml" xref="A1.SS2.p2.2.m2.1.1.1"></times><apply id="A1.SS2.p2.2.m2.1.1.2.cmml" xref="A1.SS2.p2.2.m2.1.1.2"><divide id="A1.SS2.p2.2.m2.1.1.2.1.cmml" xref="A1.SS2.p2.2.m2.1.1.2"></divide><cn type="integer" id="A1.SS2.p2.2.m2.1.1.2.2.cmml" xref="A1.SS2.p2.2.m2.1.1.2.2">4</cn><ci id="A1.SS2.p2.2.m2.1.1.2.3.cmml" xref="A1.SS2.p2.2.m2.1.1.2.3">𝑚</ci></apply><ci id="A1.SS2.p2.2.m2.1.1.3.cmml" xref="A1.SS2.p2.2.m2.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.2.m2.1c">\frac{4}{m}f</annotation></semantics></math>. This leads to the strongest attack against image data, but of course utilizes attacker knowledge that the users train on natural images.</p>
</div>
<div id="A1.SS2.p3" class="ltx_para ltx_noindent">
<p id="A1.SS2.p3.2" class="ltx_p">On the flip side, the estimation can also be improved by replacing the linear function <math id="A1.SS2.p3.1.m1.1" class="ltx_Math" alttext="h" display="inline"><semantics id="A1.SS2.p3.1.m1.1a"><mi id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><ci id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">h</annotation></semantics></math> with a Gaussian random vector of independent draws from <math id="A1.SS2.p3.2.m2.2" class="ltx_Math" alttext="\mathcal{N}(0,\frac{1}{\sqrt{m}})" display="inline"><semantics id="A1.SS2.p3.2.m2.2a"><mrow id="A1.SS2.p3.2.m2.2.3" xref="A1.SS2.p3.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p3.2.m2.2.3.2" xref="A1.SS2.p3.2.m2.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p3.2.m2.2.3.1" xref="A1.SS2.p3.2.m2.2.3.1.cmml">​</mo><mrow id="A1.SS2.p3.2.m2.2.3.3.2" xref="A1.SS2.p3.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="A1.SS2.p3.2.m2.2.3.3.2.1" xref="A1.SS2.p3.2.m2.2.3.3.1.cmml">(</mo><mn id="A1.SS2.p3.2.m2.1.1" xref="A1.SS2.p3.2.m2.1.1.cmml">0</mn><mo id="A1.SS2.p3.2.m2.2.3.3.2.2" xref="A1.SS2.p3.2.m2.2.3.3.1.cmml">,</mo><mfrac id="A1.SS2.p3.2.m2.2.2" xref="A1.SS2.p3.2.m2.2.2.cmml"><mn id="A1.SS2.p3.2.m2.2.2.2" xref="A1.SS2.p3.2.m2.2.2.2.cmml">1</mn><msqrt id="A1.SS2.p3.2.m2.2.2.3" xref="A1.SS2.p3.2.m2.2.2.3.cmml"><mi id="A1.SS2.p3.2.m2.2.2.3.2" xref="A1.SS2.p3.2.m2.2.2.3.2.cmml">m</mi></msqrt></mfrac><mo stretchy="false" id="A1.SS2.p3.2.m2.2.3.3.2.3" xref="A1.SS2.p3.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.2b"><apply id="A1.SS2.p3.2.m2.2.3.cmml" xref="A1.SS2.p3.2.m2.2.3"><times id="A1.SS2.p3.2.m2.2.3.1.cmml" xref="A1.SS2.p3.2.m2.2.3.1"></times><ci id="A1.SS2.p3.2.m2.2.3.2.cmml" xref="A1.SS2.p3.2.m2.2.3.2">𝒩</ci><interval closure="open" id="A1.SS2.p3.2.m2.2.3.3.1.cmml" xref="A1.SS2.p3.2.m2.2.3.3.2"><cn type="integer" id="A1.SS2.p3.2.m2.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1">0</cn><apply id="A1.SS2.p3.2.m2.2.2.cmml" xref="A1.SS2.p3.2.m2.2.2"><divide id="A1.SS2.p3.2.m2.2.2.1.cmml" xref="A1.SS2.p3.2.m2.2.2"></divide><cn type="integer" id="A1.SS2.p3.2.m2.2.2.2.cmml" xref="A1.SS2.p3.2.m2.2.2.2">1</cn><apply id="A1.SS2.p3.2.m2.2.2.3.cmml" xref="A1.SS2.p3.2.m2.2.2.3"><root id="A1.SS2.p3.2.m2.2.2.3a.cmml" xref="A1.SS2.p3.2.m2.2.2.3"></root><ci id="A1.SS2.p3.2.m2.2.2.3.2.cmml" xref="A1.SS2.p3.2.m2.2.2.3.2">𝑚</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.2c">\mathcal{N}(0,\frac{1}{\sqrt{m}})</annotation></semantics></math>. The resulting distribution (4th figure in <a href="#A1.F6" title="In A.2 Other Choices of Linear Functions and Distributions ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>) approximates a normal distribution much better. While not as optimal as the Laplacian distribution for higher frequencies, this variant is applicable for other data modalities if the data has bounded variance. Visualizations of the reconstruction with other linear functions can be found in <a href="#A1.F7" title="In A.2 Other Choices of Linear Functions and Distributions ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<div id="A1.SS2.p4" class="ltx_para ltx_noindent">
<p id="A1.SS2.p4.1" class="ltx_p">Finally, even with a small amount of data, the server could estimate the density of the quantity of interest. Visually, we plot the the estimated density as for several amounts of ImageNet data used to estimate the brightness distribution. We find that even with <math id="A1.SS2.p4.1.m1.1" class="ltx_Math" alttext="0.1\%" display="inline"><semantics id="A1.SS2.p4.1.m1.1a"><mrow id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml"><mn id="A1.SS2.p4.1.m1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.2.cmml">0.1</mn><mo id="A1.SS2.p4.1.m1.1.1.1" xref="A1.SS2.p4.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><apply id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1"><csymbol cd="latexml" id="A1.SS2.p4.1.m1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1.1">percent</csymbol><cn type="float" id="A1.SS2.p4.1.m1.1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.1.2">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">0.1\%</annotation></semantics></math> of the data used, the server could obtain a close approximation to the distribution of interest (see <a href="#A1.F5" title="In A.2 Other Choices of Linear Functions and Distributions ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a>).</p>
</div>
<figure id="A1.F5" class="ltx_figure"><img src="/html/2110.13057/assets/images/density_estimate.png" id="A1.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="216" height="144" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Density of image brightness estimated from access to different amounts of data from the ImageNet dataset.</figcaption>
</figure>
<figure id="A1.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2110.13057/assets/x5.png" id="A1.F6.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="101" height="72" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2110.13057/assets/x6.png" id="A1.F6.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="101" height="72" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2110.13057/assets/x7.png" id="A1.F6.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="101" height="72" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2110.13057/assets/x8.png" id="A1.F6.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="101" height="71" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Distributions on the ImageNet validation set for several linear query functions. From left to right: Mean compared to normal distribution, mean compared to Laplacian distribution, 32nd DCT coeffcient compared to Laplacian distribution, random normal vector compared to normal distribution. In each plot the approximate distribution used by the attacker is visualized in blue/black and the ground-truth (GT) distribution in green/red.</figcaption>
</figure>
<figure id="A1.T1" class="ltx_table">
<table id="A1.T1.12" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T1.12.13.1" class="ltx_tr">
<th id="A1.T1.12.13.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r">Linear Function</th>
<th id="A1.T1.12.13.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r">Assumed Distribution</th>
<th id="A1.T1.12.13.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">MSE</th>
<th id="A1.T1.12.13.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">PSNR</th>
<th id="A1.T1.12.13.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">IIP-Pixel</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T1.3.3" class="ltx_tr">
<th id="A1.T1.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Mean</th>
<th id="A1.T1.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Normal</th>
<td id="A1.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="A1.T1.1.1.1.m1.1" class="ltx_Math" alttext="0.0183" display="inline"><semantics id="A1.T1.1.1.1.m1.1a"><mn id="A1.T1.1.1.1.m1.1.1" xref="A1.T1.1.1.1.m1.1.1.cmml">0.0183</mn><annotation-xml encoding="MathML-Content" id="A1.T1.1.1.1.m1.1b"><cn type="float" id="A1.T1.1.1.1.m1.1.1.cmml" xref="A1.T1.1.1.1.m1.1.1">0.0183</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.1.1.1.m1.1c">0.0183</annotation></semantics></math></td>
<td id="A1.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="A1.T1.2.2.2.m1.1" class="ltx_Math" alttext="75.75" display="inline"><semantics id="A1.T1.2.2.2.m1.1a"><mn id="A1.T1.2.2.2.m1.1.1" xref="A1.T1.2.2.2.m1.1.1.cmml">75.75</mn><annotation-xml encoding="MathML-Content" id="A1.T1.2.2.2.m1.1b"><cn type="float" id="A1.T1.2.2.2.m1.1.1.cmml" xref="A1.T1.2.2.2.m1.1.1">75.75</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.2.2.2.m1.1c">75.75</annotation></semantics></math></td>
<td id="A1.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T1.3.3.3.m1.1" class="ltx_Math" alttext="65.62\%" display="inline"><semantics id="A1.T1.3.3.3.m1.1a"><mrow id="A1.T1.3.3.3.m1.1.1" xref="A1.T1.3.3.3.m1.1.1.cmml"><mn id="A1.T1.3.3.3.m1.1.1.2" xref="A1.T1.3.3.3.m1.1.1.2.cmml">65.62</mn><mo id="A1.T1.3.3.3.m1.1.1.1" xref="A1.T1.3.3.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T1.3.3.3.m1.1b"><apply id="A1.T1.3.3.3.m1.1.1.cmml" xref="A1.T1.3.3.3.m1.1.1"><csymbol cd="latexml" id="A1.T1.3.3.3.m1.1.1.1.cmml" xref="A1.T1.3.3.3.m1.1.1.1">percent</csymbol><cn type="float" id="A1.T1.3.3.3.m1.1.1.2.cmml" xref="A1.T1.3.3.3.m1.1.1.2">65.62</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.3.3.3.m1.1c">65.62\%</annotation></semantics></math></td>
</tr>
<tr id="A1.T1.6.6" class="ltx_tr">
<th id="A1.T1.6.6.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Mean</th>
<th id="A1.T1.6.6.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Laplacian</th>
<td id="A1.T1.4.4.1" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T1.4.4.1.m1.1" class="ltx_Math" alttext="0.0174" display="inline"><semantics id="A1.T1.4.4.1.m1.1a"><mn id="A1.T1.4.4.1.m1.1.1" xref="A1.T1.4.4.1.m1.1.1.cmml">0.0174</mn><annotation-xml encoding="MathML-Content" id="A1.T1.4.4.1.m1.1b"><cn type="float" id="A1.T1.4.4.1.m1.1.1.cmml" xref="A1.T1.4.4.1.m1.1.1">0.0174</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.4.4.1.m1.1c">0.0174</annotation></semantics></math></td>
<td id="A1.T1.5.5.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T1.5.5.2.m1.1" class="ltx_Math" alttext="79.63" display="inline"><semantics id="A1.T1.5.5.2.m1.1a"><mn id="A1.T1.5.5.2.m1.1.1" xref="A1.T1.5.5.2.m1.1.1.cmml">79.63</mn><annotation-xml encoding="MathML-Content" id="A1.T1.5.5.2.m1.1b"><cn type="float" id="A1.T1.5.5.2.m1.1.1.cmml" xref="A1.T1.5.5.2.m1.1.1">79.63</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.5.5.2.m1.1c">79.63</annotation></semantics></math></td>
<td id="A1.T1.6.6.3" class="ltx_td ltx_align_center"><math id="A1.T1.6.6.3.m1.1" class="ltx_Math" alttext="71.88\%" display="inline"><semantics id="A1.T1.6.6.3.m1.1a"><mrow id="A1.T1.6.6.3.m1.1.1" xref="A1.T1.6.6.3.m1.1.1.cmml"><mn id="A1.T1.6.6.3.m1.1.1.2" xref="A1.T1.6.6.3.m1.1.1.2.cmml">71.88</mn><mo id="A1.T1.6.6.3.m1.1.1.1" xref="A1.T1.6.6.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T1.6.6.3.m1.1b"><apply id="A1.T1.6.6.3.m1.1.1.cmml" xref="A1.T1.6.6.3.m1.1.1"><csymbol cd="latexml" id="A1.T1.6.6.3.m1.1.1.1.cmml" xref="A1.T1.6.6.3.m1.1.1.1">percent</csymbol><cn type="float" id="A1.T1.6.6.3.m1.1.1.2.cmml" xref="A1.T1.6.6.3.m1.1.1.2">71.88</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.6.6.3.m1.1c">71.88\%</annotation></semantics></math></td>
</tr>
<tr id="A1.T1.9.9" class="ltx_tr">
<th id="A1.T1.9.9.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Cosine</th>
<th id="A1.T1.9.9.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Laplacian</th>
<td id="A1.T1.7.7.1" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T1.7.7.1.m1.1" class="ltx_Math" alttext="0.0167" display="inline"><semantics id="A1.T1.7.7.1.m1.1a"><mn id="A1.T1.7.7.1.m1.1.1" xref="A1.T1.7.7.1.m1.1.1.cmml">0.0167</mn><annotation-xml encoding="MathML-Content" id="A1.T1.7.7.1.m1.1b"><cn type="float" id="A1.T1.7.7.1.m1.1.1.cmml" xref="A1.T1.7.7.1.m1.1.1">0.0167</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.7.7.1.m1.1c">0.0167</annotation></semantics></math></td>
<td id="A1.T1.8.8.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T1.8.8.2.m1.1" class="ltx_Math" alttext="99.82" display="inline"><semantics id="A1.T1.8.8.2.m1.1a"><mn id="A1.T1.8.8.2.m1.1.1" xref="A1.T1.8.8.2.m1.1.1.cmml">99.82</mn><annotation-xml encoding="MathML-Content" id="A1.T1.8.8.2.m1.1b"><cn type="float" id="A1.T1.8.8.2.m1.1.1.cmml" xref="A1.T1.8.8.2.m1.1.1">99.82</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.8.8.2.m1.1c">99.82</annotation></semantics></math></td>
<td id="A1.T1.9.9.3" class="ltx_td ltx_align_center"><math id="A1.T1.9.9.3.m1.1" class="ltx_Math" alttext="79.69\%" display="inline"><semantics id="A1.T1.9.9.3.m1.1a"><mrow id="A1.T1.9.9.3.m1.1.1" xref="A1.T1.9.9.3.m1.1.1.cmml"><mn id="A1.T1.9.9.3.m1.1.1.2" xref="A1.T1.9.9.3.m1.1.1.2.cmml">79.69</mn><mo id="A1.T1.9.9.3.m1.1.1.1" xref="A1.T1.9.9.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T1.9.9.3.m1.1b"><apply id="A1.T1.9.9.3.m1.1.1.cmml" xref="A1.T1.9.9.3.m1.1.1"><csymbol cd="latexml" id="A1.T1.9.9.3.m1.1.1.1.cmml" xref="A1.T1.9.9.3.m1.1.1.1">percent</csymbol><cn type="float" id="A1.T1.9.9.3.m1.1.1.2.cmml" xref="A1.T1.9.9.3.m1.1.1.2">79.69</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.9.9.3.m1.1c">79.69\%</annotation></semantics></math></td>
</tr>
<tr id="A1.T1.12.12" class="ltx_tr">
<th id="A1.T1.12.12.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Random</th>
<th id="A1.T1.12.12.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Normal</th>
<td id="A1.T1.10.10.1" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T1.10.10.1.m1.1" class="ltx_Math" alttext="0.0203" display="inline"><semantics id="A1.T1.10.10.1.m1.1a"><mn id="A1.T1.10.10.1.m1.1.1" xref="A1.T1.10.10.1.m1.1.1.cmml">0.0203</mn><annotation-xml encoding="MathML-Content" id="A1.T1.10.10.1.m1.1b"><cn type="float" id="A1.T1.10.10.1.m1.1.1.cmml" xref="A1.T1.10.10.1.m1.1.1">0.0203</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.10.10.1.m1.1c">0.0203</annotation></semantics></math></td>
<td id="A1.T1.11.11.2" class="ltx_td ltx_align_center ltx_border_r"><math id="A1.T1.11.11.2.m1.1" class="ltx_Math" alttext="91.29" display="inline"><semantics id="A1.T1.11.11.2.m1.1a"><mn id="A1.T1.11.11.2.m1.1.1" xref="A1.T1.11.11.2.m1.1.1.cmml">91.29</mn><annotation-xml encoding="MathML-Content" id="A1.T1.11.11.2.m1.1b"><cn type="float" id="A1.T1.11.11.2.m1.1.1.cmml" xref="A1.T1.11.11.2.m1.1.1">91.29</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.11.11.2.m1.1c">91.29</annotation></semantics></math></td>
<td id="A1.T1.12.12.3" class="ltx_td ltx_align_center"><math id="A1.T1.12.12.3.m1.1" class="ltx_Math" alttext="75.00\%" display="inline"><semantics id="A1.T1.12.12.3.m1.1a"><mrow id="A1.T1.12.12.3.m1.1.1" xref="A1.T1.12.12.3.m1.1.1.cmml"><mn id="A1.T1.12.12.3.m1.1.1.2" xref="A1.T1.12.12.3.m1.1.1.2.cmml">75.00</mn><mo id="A1.T1.12.12.3.m1.1.1.1" xref="A1.T1.12.12.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T1.12.12.3.m1.1b"><apply id="A1.T1.12.12.3.m1.1.1.cmml" xref="A1.T1.12.12.3.m1.1.1"><csymbol cd="latexml" id="A1.T1.12.12.3.m1.1.1.1.cmml" xref="A1.T1.12.12.3.m1.1.1.1">percent</csymbol><cn type="float" id="A1.T1.12.12.3.m1.1.1.2.cmml" xref="A1.T1.12.12.3.m1.1.1.2">75.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.12.12.3.m1.1c">75.00\%</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Ablation study linear functions and distributions.</figcaption>
</figure>
<figure id="A1.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2110.13057/assets/images/result_64_128_laplacian_m32.png" id="A1.F7.g1" class="ltx_graphics ltx_figure_panel ltx_img_square" width="253" height="247" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2110.13057/assets/images/result_64_128_gaussian_randn.png" id="A1.F7.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="253" height="247" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Analytic reconstruction for an imprint model with <math id="A1.F7.2.m1.1" class="ltx_Math" alttext="128" display="inline"><semantics id="A1.F7.2.m1.1b"><mn id="A1.F7.2.m1.1.1" xref="A1.F7.2.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A1.F7.2.m1.1c"><cn type="integer" id="A1.F7.2.m1.1.1.cmml" xref="A1.F7.2.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F7.2.m1.1d">128</annotation></semantics></math> bins in front of a ResNet-18. <span id="A1.F7.5.1" class="ltx_text ltx_font_bold">Left:</span> The linear function is the 32nd DCT coefficient and bins are based on a Laplacian distribution. <span id="A1.F7.6.2" class="ltx_text ltx_font_bold">Right:</span> Linear function is a Gaussian random vector and bins are based on a normal distribution. Gray reconstructions denote bins in which no data point falls.)</figcaption>
</figure>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Comparison to Honest Servers and Optimization-based Attacks</h3>

<div id="A1.SS3.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.p1.3" class="ltx_p">We argue that the proposed attack operating in our threat model is significantly more threatening than existing optimization-based attacks in the honest-but-curious server model. To illustrate this point and show by example that the change is threat model which amounts to only a minor architectural change in the neural network leads to a massive difference in reconstruction, we run the attack of <cite class="ltx_cite ltx_citemacro_cite">Geiping et al. (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite> in the scenario of <a href="#S3.F2" title="In 3.3 Imprinting User Information into Model Updates ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>. The results can be found in <a href="#A1.F8" title="In A.3 Comparison to Honest Servers and Optimization-based Attacks ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">8</span></a>. The attack leads to an IIP score of <math id="A1.SS3.p1.1.m1.1" class="ltx_Math" alttext="6.25\%" display="inline"><semantics id="A1.SS3.p1.1.m1.1a"><mrow id="A1.SS3.p1.1.m1.1.1" xref="A1.SS3.p1.1.m1.1.1.cmml"><mn id="A1.SS3.p1.1.m1.1.1.2" xref="A1.SS3.p1.1.m1.1.1.2.cmml">6.25</mn><mo id="A1.SS3.p1.1.m1.1.1.1" xref="A1.SS3.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.1.m1.1b"><apply id="A1.SS3.p1.1.m1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1"><csymbol cd="latexml" id="A1.SS3.p1.1.m1.1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="A1.SS3.p1.1.m1.1.1.2.cmml" xref="A1.SS3.p1.1.m1.1.1.2">6.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.1.m1.1c">6.25\%</annotation></semantics></math> when measuring in pixel space, <math id="A1.SS3.p1.2.m2.1" class="ltx_Math" alttext="6.25\%" display="inline"><semantics id="A1.SS3.p1.2.m2.1a"><mrow id="A1.SS3.p1.2.m2.1.1" xref="A1.SS3.p1.2.m2.1.1.cmml"><mn id="A1.SS3.p1.2.m2.1.1.2" xref="A1.SS3.p1.2.m2.1.1.2.cmml">6.25</mn><mo id="A1.SS3.p1.2.m2.1.1.1" xref="A1.SS3.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.2.m2.1b"><apply id="A1.SS3.p1.2.m2.1.1.cmml" xref="A1.SS3.p1.2.m2.1.1"><csymbol cd="latexml" id="A1.SS3.p1.2.m2.1.1.1.cmml" xref="A1.SS3.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="A1.SS3.p1.2.m2.1.1.2.cmml" xref="A1.SS3.p1.2.m2.1.1.2">6.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.2.m2.1c">6.25\%</annotation></semantics></math> when measuring in LPIPS <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib40" title="" class="ltx_ref">2018</a>)</cite> and, and <math id="A1.SS3.p1.3.m3.1" class="ltx_Math" alttext="20.31\%" display="inline"><semantics id="A1.SS3.p1.3.m3.1a"><mrow id="A1.SS3.p1.3.m3.1.1" xref="A1.SS3.p1.3.m3.1.1.cmml"><mn id="A1.SS3.p1.3.m3.1.1.2" xref="A1.SS3.p1.3.m3.1.1.2.cmml">20.31</mn><mo id="A1.SS3.p1.3.m3.1.1.1" xref="A1.SS3.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.3.m3.1b"><apply id="A1.SS3.p1.3.m3.1.1.cmml" xref="A1.SS3.p1.3.m3.1.1"><csymbol cd="latexml" id="A1.SS3.p1.3.m3.1.1.1.cmml" xref="A1.SS3.p1.3.m3.1.1.1">percent</csymbol><cn type="float" id="A1.SS3.p1.3.m3.1.1.2.cmml" xref="A1.SS3.p1.3.m3.1.1.2">20.31</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.3.m3.1c">20.31\%</annotation></semantics></math> when measuring the cosine distances in feature space of this model (the metric of <cite class="ltx_cite ltx_citemacro_cite">Yin et al. (<a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite>).</p>
</div>
<div id="A1.SS3.p2" class="ltx_para ltx_noindent">
<p id="A1.SS3.p2.1" class="ltx_p">As an additional ablation, we also investigate whether the optimization-based attacks can find the optimal solution in the malicious server threat model that we consider. However, the right side of <a href="#A1.F8" title="In A.3 Comparison to Honest Servers and Optimization-based Attacks ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">8</span></a> shows that at least conventional optimization-based methods have trouble finding the vulnerability introduced by the imprint module. The vulnerability that the attack solves analytically might be hard to exploit by first-order optimization or require specifically tuned optimization schemes to succeed. This also shows that defenses that attempt to detect privacy breaches by evaluating a range of optimization-based attacks would not have triggered an alarm for this attack.</p>
</div>
<figure id="A1.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2110.13057/assets/images/inverting_gradient_bs64.png" id="A1.F8.g1" class="ltx_graphics ltx_figure_panel ltx_img_square" width="253" height="247" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2110.13057/assets/images/inverting_gradient_bs64_from_imprint.png" id="A1.F8.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="253" height="247" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Optimization-based attack of <cite class="ltx_cite ltx_citemacro_citet">Geiping et al. (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite> for a ResNet-18 and a batch size of 64, the setting of <a href="#S3.F2" title="In 3.3 Imprinting User Information into Model Updates ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>. <span id="A1.F8.3.1" class="ltx_text ltx_font_bold">Left:</span> An honest server model. <span id="A1.F8.4.2" class="ltx_text ltx_font_bold">Right:</span> Gradient inversion attack applied to a module that contains the imprint module.</figcaption>
</figure>
</section>
<section id="A1.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Other Data Modalities - Text</h3>

<div id="A1.SS4.p1" class="ltx_para ltx_noindent">
<p id="A1.SS4.p1.1" class="ltx_p">As discussed in the main body, the attack is entirely data-agnostic and could be launched against any kind of input data, e.g. not only image data but also tabular features or text. In principle the input data could be comprised of random signals - these can still be binned and separated by the proposed attack. We verify this property by launching the same attack against text data.</p>
</div>
<div id="A1.SS4.p2" class="ltx_para ltx_noindent">
<p id="A1.SS4.p2.5" class="ltx_p">We investigate the transformer architecture discussed in <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite> specifically for language tasks in federated learning scenarios and insert the imprint module as malicious block right after the word embeddings. This is strictly a maliciously modified architecture - normal feedforward blocks in a transformer would not span across the entire length of the sequence. We initialize the linear function as a Gaussian random vector and make no modifications to the attack hyperparameters. We recover the input tokens ids from a direct lookup of their closest match in the word embedding layer <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib43" title="" class="ltx_ref">2019</a>)</cite>. To evaluate the success of the attack we generate sample batches of sentences from the wikitext dataset <cite class="ltx_cite ltx_citemacro_citep">(Merity et al., <a href="#bib.bib20" title="" class="ltx_ref">2016</a>)</cite> with a batch size of <math id="A1.SS4.p2.1.m1.1" class="ltx_Math" alttext="128" display="inline"><semantics id="A1.SS4.p2.1.m1.1a"><mn id="A1.SS4.p2.1.m1.1.1" xref="A1.SS4.p2.1.m1.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.1.m1.1b"><cn type="integer" id="A1.SS4.p2.1.m1.1.1.cmml" xref="A1.SS4.p2.1.m1.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.1.m1.1c">128</annotation></semantics></math> and a sequence length of <math id="A1.SS4.p2.2.m2.1" class="ltx_Math" alttext="32" display="inline"><semantics id="A1.SS4.p2.2.m2.1a"><mn id="A1.SS4.p2.2.m2.1.1" xref="A1.SS4.p2.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.2.m2.1b"><cn type="integer" id="A1.SS4.p2.2.m2.1.1.cmml" xref="A1.SS4.p2.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.2.m2.1c">32</annotation></semantics></math>, tokenized via the GPT-2 tokenizer <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib27" title="" class="ltx_ref">2019</a>)</cite>. Instantiating the attack with 512 bins immediately reveals 110 out of 128 sentences perfectly, leading to an overall reconstruction accuracy of <math id="A1.SS4.p2.3.m3.1" class="ltx_Math" alttext="86.33\%" display="inline"><semantics id="A1.SS4.p2.3.m3.1a"><mrow id="A1.SS4.p2.3.m3.1.1" xref="A1.SS4.p2.3.m3.1.1.cmml"><mn id="A1.SS4.p2.3.m3.1.1.2" xref="A1.SS4.p2.3.m3.1.1.2.cmml">86.33</mn><mo id="A1.SS4.p2.3.m3.1.1.1" xref="A1.SS4.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.3.m3.1b"><apply id="A1.SS4.p2.3.m3.1.1.cmml" xref="A1.SS4.p2.3.m3.1.1"><csymbol cd="latexml" id="A1.SS4.p2.3.m3.1.1.1.cmml" xref="A1.SS4.p2.3.m3.1.1.1">percent</csymbol><cn type="float" id="A1.SS4.p2.3.m3.1.1.2.cmml" xref="A1.SS4.p2.3.m3.1.1.2">86.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.3.m3.1c">86.33\%</annotation></semantics></math> which is also a BLEU score of <math id="A1.SS4.p2.4.m4.1" class="ltx_Math" alttext="88\%" display="inline"><semantics id="A1.SS4.p2.4.m4.1a"><mrow id="A1.SS4.p2.4.m4.1.1" xref="A1.SS4.p2.4.m4.1.1.cmml"><mn id="A1.SS4.p2.4.m4.1.1.2" xref="A1.SS4.p2.4.m4.1.1.2.cmml">88</mn><mo id="A1.SS4.p2.4.m4.1.1.1" xref="A1.SS4.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.4.m4.1b"><apply id="A1.SS4.p2.4.m4.1.1.cmml" xref="A1.SS4.p2.4.m4.1.1"><csymbol cd="latexml" id="A1.SS4.p2.4.m4.1.1.1.cmml" xref="A1.SS4.p2.4.m4.1.1.1">percent</csymbol><cn type="integer" id="A1.SS4.p2.4.m4.1.1.2.cmml" xref="A1.SS4.p2.4.m4.1.1.2">88</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.4.m4.1c">88\%</annotation></semantics></math> and ROUGE-L of <math id="A1.SS4.p2.5.m5.1" class="ltx_Math" alttext="87\%" display="inline"><semantics id="A1.SS4.p2.5.m5.1a"><mrow id="A1.SS4.p2.5.m5.1.1" xref="A1.SS4.p2.5.m5.1.1.cmml"><mn id="A1.SS4.p2.5.m5.1.1.2" xref="A1.SS4.p2.5.m5.1.1.2.cmml">87</mn><mo id="A1.SS4.p2.5.m5.1.1.1" xref="A1.SS4.p2.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.5.m5.1b"><apply id="A1.SS4.p2.5.m5.1.1.cmml" xref="A1.SS4.p2.5.m5.1.1"><csymbol cd="latexml" id="A1.SS4.p2.5.m5.1.1.1.cmml" xref="A1.SS4.p2.5.m5.1.1.1">percent</csymbol><cn type="integer" id="A1.SS4.p2.5.m5.1.1.2.cmml" xref="A1.SS4.p2.5.m5.1.1.2">87</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.5.m5.1c">87\%</annotation></semantics></math>. We refer to our open source implementation for further details.</p>
</div>
<div id="A1.SS4.p3" class="ltx_para ltx_noindent">
<p id="A1.SS4.p3.1" class="ltx_p">We show examples of recovered data below, but note that printing the recovered text is not that insightful. The attack perfectly recovers a subset of sentences of user text and cannot recover some other sentences entirely, in full analogy to the results for images in e.g. <a href="#A1.F7" title="In A.2 Other Choices of Linear Functions and Distributions ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a>:</p>
</div>
<div id="A1.SS4.p4" class="ltx_para ltx_noindent">
<p id="A1.SS4.p4.1" class="ltx_p">Recovered wikitext data:
<br class="ltx_break"><span id="A1.SS4.p4.1.1" class="ltx_text ltx_font_typewriter">
The Tower Building of the Little Rock Arsenal, also known as U.S. Arsenal Building, is a building located in MacArthur Park in downtown Little Rock, Arkansas
. Built in 1840, it was part of Little Rock’s first military installation. Since its decommissioning, The Tower Building has housed two museums. It
was home to the Arkansas Museum of Natural History and Antiquities from 1942 to 1997 and the MacArthur Museum of Arkansas Military History since 2001. It has also been the
headquarters of the Little Rock Æsthetic Club since 1894.
The building receives its name from its distinct octagonal tower. Besides being the last
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
</span></p>
</div>
</section>
<section id="A1.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Technical Details</h3>

<div id="A1.SS5.p1" class="ltx_para ltx_noindent">
<p id="A1.SS5.p1.1" class="ltx_p">All experiments were implemented in PyTorch <cite class="ltx_cite ltx_citemacro_citep">(Paszke et al., <a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite> and were run on several laptop and machine CPUs, as the reconstruction itself requires only a few tensor operations. Especially, compared to optimization-based reconstruction techniques, this makes the approach significantly faster and significantly more portable. For visualization purposes and to measure accurate PSNR and IIP scores all images (which are recovered in the order given by the chosen function <math id="A1.SS5.p1.1.m1.1" class="ltx_Math" alttext="h" display="inline"><semantics id="A1.SS5.p1.1.m1.1a"><mi id="A1.SS5.p1.1.m1.1.1" xref="A1.SS5.p1.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.1.m1.1b"><ci id="A1.SS5.p1.1.m1.1.1.cmml" xref="A1.SS5.p1.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.1.m1.1c">h</annotation></semantics></math>) are matched with possible correspondences in the ground truth batch. The matching is found based on LPIPS feature similarities scores <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib40" title="" class="ltx_ref">2018</a>)</cite> which are matched using a linear sum assignment solver. No labels are recovered using the proposed approach which is entirely label-agnostic, but labels could be assigned a-posteriori using model predictions of the reconstructed data if required. For experiments where the imprint module is placed deeper into a network, the network (which is here a ResNet) is linearized by resetting batch normalization parameters and buffers to the identity map, setting all residual paths to zero and initializing the first convolution and the shortcut convolutions to identity maps. The nonlinearities can be bypassed by bias shifting as in <cite class="ltx_cite ltx_citemacro_cite">Goldblum et al. (<a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="A1.SS5.p2" class="ltx_para ltx_noindent">
<p id="A1.SS5.p2.1" class="ltx_p">PSNR scores are computed as average PSNR where we first compute PSNR scores per image and then average. This procedure is standard in computer vision, but does bias the score toward successful reconstructions, as the minimal PSNR score is bounded at 0, but its potential upside unbounded. For the image identifiability precision (IIP) score of <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a href="#bib.bib38" title="" class="ltx_ref">2021</a>)</cite> we implement the score as proposed therein, but measure nearest neighbors not in the model feature space (which we consider biased, given that the model parameters are already used for reconstruction), but directly in image pixel space, where we check whether the given reconstruction is indeed closer to its true counterpart in euclidean distance than any other image from this class in the validation set.</p>
</div>
</section>
<section id="A1.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6 </span>Additional Images</h3>

<figure id="A1.F9" class="ltx_figure"><img src="/html/2110.13057/assets/x9.png" id="A1.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="317" height="159" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Expected number of data points recovered for several batch sizes and increased bins and corresponding parameter increase. Model: ResNet50 with ImageNet, targeting the input to the 3rd residual block.</figcaption>
</figure>
<figure id="A1.F10" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="A1.F10.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/true_animals.png" id="A1.F10.1.g1" class="ltx_graphics ltx_img_square" width="176" height="172" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="A1.F10.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/sharks_without_humans_gt.png" id="A1.F10.2.g1" class="ltx_graphics ltx_img_square" width="176" height="172" alt="Refer to caption">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span id="A1.F10.5.1" class="ltx_text ltx_font_bold">Left:</span> Raw data for the 64 ImageNet images with separate classes. <span id="A1.F10.6.2" class="ltx_text ltx_font_bold">Right:</span> Raw data for the 64 images from the white shark class.</figcaption>
</figure>
<figure id="A1.F11" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="A1.F11.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/true_animals.png" id="A1.F11.1.g1" class="ltx_graphics ltx_img_square" width="176" height="172" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="A1.F11.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/shark_free_waters.png" id="A1.F11.2.g1" class="ltx_graphics ltx_img_square" width="176" height="172" alt="Refer to caption">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span><span id="A1.F11.9.1" class="ltx_text ltx_font_bold">Left:</span> Analytic reconstruction for a linear model of 64 ImageNet images with separate classes (PSNR: <math id="A1.F11.5.m1.1" class="ltx_Math" alttext="36.45" display="inline"><semantics id="A1.F11.5.m1.1b"><mn id="A1.F11.5.m1.1.1" xref="A1.F11.5.m1.1.1.cmml">36.45</mn><annotation-xml encoding="MathML-Content" id="A1.F11.5.m1.1c"><cn type="float" id="A1.F11.5.m1.1.1.cmml" xref="A1.F11.5.m1.1.1">36.45</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F11.5.m1.1d">36.45</annotation></semantics></math> versus true user data). <span id="A1.F11.10.2" class="ltx_text ltx_font_bold">Right:</span> Same recovery algorithm but for 64 images from the same class (white shark), (PSNR: <math id="A1.F11.6.m2.1" class="ltx_Math" alttext="13.84" display="inline"><semantics id="A1.F11.6.m2.1b"><mn id="A1.F11.6.m2.1.1" xref="A1.F11.6.m2.1.1.cmml">13.84</mn><annotation-xml encoding="MathML-Content" id="A1.F11.6.m2.1c"><cn type="float" id="A1.F11.6.m2.1.1.cmml" xref="A1.F11.6.m2.1.1">13.84</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F11.6.m2.1d">13.84</annotation></semantics></math> versus true user data.)</figcaption>
</figure>
<figure id="A1.F12" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="A1.F12.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/clean_cifar_batch.png" id="A1.F12.1.g1" class="ltx_graphics ltx_img_square" width="192" height="188" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="A1.F12.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/naive_linear_batch.png" id="A1.F12.2.g1" class="ltx_graphics ltx_img_square" width="192" height="188" alt="Refer to caption">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span><span id="A1.F12.5.1" class="ltx_text ltx_font_bold">Left (a)</span>: A batch of 64 CIFAR10 images. <span id="A1.F12.6.2" class="ltx_text ltx_font_bold">Right (b)</span>: The same batch of images reconstructed naively using <a href="#S3.E2" title="In 3.2 A Simple Example ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.</figcaption>
</figure>
<div id="A1.SS6.p1" class="ltx_para ltx_noindent">
<p id="A1.SS6.p1.1" class="ltx_p">This section contains additional image examples, such as using CIFAR-10 in <a href="#A1.F12" title="In A.6 Additional Images ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">12</span></a> and <a href="#A1.F13" title="In A.6 Additional Images ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">13</span></a> where an attack with the imprint module on this dataset shows that almost all of the user data is perfectly recovered. Furthermore, example panels of imprint modules inserted in later ResNet layers are visualized as well as the results of the sparse variant that is used to attack a federated averaging scheme.</p>
</div>
<figure id="A1.F13" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="A1.F13.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/clean_cifar_batch.png" id="A1.F13.1.g1" class="ltx_graphics ltx_img_square" width="174" height="170" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="A1.F13.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/imprint_cifar.png" id="A1.F13.2.g1" class="ltx_graphics ltx_img_square" width="174" height="170" alt="Refer to caption">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span><span id="A1.F13.7.1" class="ltx_text ltx_font_bold">Left (a)</span>: A batch of 64 CIFAR10 images. <span id="A1.F13.8.2" class="ltx_text ltx_font_bold">Right (b)</span>: The same batch of images reconstructed using the imprint module with <math id="A1.F13.4.m1.1" class="ltx_Math" alttext="300" display="inline"><semantics id="A1.F13.4.m1.1b"><mn id="A1.F13.4.m1.1.1" xref="A1.F13.4.m1.1.1.cmml">300</mn><annotation-xml encoding="MathML-Content" id="A1.F13.4.m1.1c"><cn type="integer" id="A1.F13.4.m1.1.1.cmml" xref="A1.F13.4.m1.1.1">300</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F13.4.m1.1d">300</annotation></semantics></math> bins. Gray images can result from collisions within a given bin.</figcaption>
</figure>
<figure id="A1.F14" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2110.13057/assets/images/standard56x56_64_128_15_04.png" id="A1.F14.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="132" height="129" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2110.13057/assets/images/standard28x28_64_128_14_63.png" id="A1.F14.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="132" height="129" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2110.13057/assets/images/standard14x14_64_128_13_84.png" id="A1.F14.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="132" height="129" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/2110.13057/assets/images/standard7x7_64_128_13_46.png" id="A1.F14.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" width="132" height="129" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>Different placements of the imprint module in a ResNet-18. From left to right: Before the first block (<math id="A1.F14.6.m1.1" class="ltx_Math" alttext="56x56" display="inline"><semantics id="A1.F14.6.m1.1b"><mrow id="A1.F14.6.m1.1.1" xref="A1.F14.6.m1.1.1.cmml"><mn id="A1.F14.6.m1.1.1.2" xref="A1.F14.6.m1.1.1.2.cmml">56</mn><mo lspace="0em" rspace="0em" id="A1.F14.6.m1.1.1.1" xref="A1.F14.6.m1.1.1.1.cmml">​</mo><mi id="A1.F14.6.m1.1.1.3" xref="A1.F14.6.m1.1.1.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="A1.F14.6.m1.1.1.1b" xref="A1.F14.6.m1.1.1.1.cmml">​</mo><mn id="A1.F14.6.m1.1.1.4" xref="A1.F14.6.m1.1.1.4.cmml">56</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F14.6.m1.1c"><apply id="A1.F14.6.m1.1.1.cmml" xref="A1.F14.6.m1.1.1"><times id="A1.F14.6.m1.1.1.1.cmml" xref="A1.F14.6.m1.1.1.1"></times><cn type="integer" id="A1.F14.6.m1.1.1.2.cmml" xref="A1.F14.6.m1.1.1.2">56</cn><ci id="A1.F14.6.m1.1.1.3.cmml" xref="A1.F14.6.m1.1.1.3">𝑥</ci><cn type="integer" id="A1.F14.6.m1.1.1.4.cmml" xref="A1.F14.6.m1.1.1.4">56</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F14.6.m1.1d">56x56</annotation></semantics></math>), before the third block (<math id="A1.F14.7.m2.1" class="ltx_Math" alttext="28x28" display="inline"><semantics id="A1.F14.7.m2.1b"><mrow id="A1.F14.7.m2.1.1" xref="A1.F14.7.m2.1.1.cmml"><mn id="A1.F14.7.m2.1.1.2" xref="A1.F14.7.m2.1.1.2.cmml">28</mn><mo lspace="0em" rspace="0em" id="A1.F14.7.m2.1.1.1" xref="A1.F14.7.m2.1.1.1.cmml">​</mo><mi id="A1.F14.7.m2.1.1.3" xref="A1.F14.7.m2.1.1.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="A1.F14.7.m2.1.1.1b" xref="A1.F14.7.m2.1.1.1.cmml">​</mo><mn id="A1.F14.7.m2.1.1.4" xref="A1.F14.7.m2.1.1.4.cmml">28</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F14.7.m2.1c"><apply id="A1.F14.7.m2.1.1.cmml" xref="A1.F14.7.m2.1.1"><times id="A1.F14.7.m2.1.1.1.cmml" xref="A1.F14.7.m2.1.1.1"></times><cn type="integer" id="A1.F14.7.m2.1.1.2.cmml" xref="A1.F14.7.m2.1.1.2">28</cn><ci id="A1.F14.7.m2.1.1.3.cmml" xref="A1.F14.7.m2.1.1.3">𝑥</ci><cn type="integer" id="A1.F14.7.m2.1.1.4.cmml" xref="A1.F14.7.m2.1.1.4">28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F14.7.m2.1d">28x28</annotation></semantics></math>), before the fourth block (<math id="A1.F14.8.m3.1" class="ltx_Math" alttext="14x14" display="inline"><semantics id="A1.F14.8.m3.1b"><mrow id="A1.F14.8.m3.1.1" xref="A1.F14.8.m3.1.1.cmml"><mn id="A1.F14.8.m3.1.1.2" xref="A1.F14.8.m3.1.1.2.cmml">14</mn><mo lspace="0em" rspace="0em" id="A1.F14.8.m3.1.1.1" xref="A1.F14.8.m3.1.1.1.cmml">​</mo><mi id="A1.F14.8.m3.1.1.3" xref="A1.F14.8.m3.1.1.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="A1.F14.8.m3.1.1.1b" xref="A1.F14.8.m3.1.1.1.cmml">​</mo><mn id="A1.F14.8.m3.1.1.4" xref="A1.F14.8.m3.1.1.4.cmml">14</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F14.8.m3.1c"><apply id="A1.F14.8.m3.1.1.cmml" xref="A1.F14.8.m3.1.1"><times id="A1.F14.8.m3.1.1.1.cmml" xref="A1.F14.8.m3.1.1.1"></times><cn type="integer" id="A1.F14.8.m3.1.1.2.cmml" xref="A1.F14.8.m3.1.1.2">14</cn><ci id="A1.F14.8.m3.1.1.3.cmml" xref="A1.F14.8.m3.1.1.3">𝑥</ci><cn type="integer" id="A1.F14.8.m3.1.1.4.cmml" xref="A1.F14.8.m3.1.1.4">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F14.8.m3.1d">14x14</annotation></semantics></math>) and before the last average pooling (<math id="A1.F14.9.m4.1" class="ltx_Math" alttext="7x7" display="inline"><semantics id="A1.F14.9.m4.1b"><mrow id="A1.F14.9.m4.1.1" xref="A1.F14.9.m4.1.1.cmml"><mn id="A1.F14.9.m4.1.1.2" xref="A1.F14.9.m4.1.1.2.cmml">7</mn><mo lspace="0em" rspace="0em" id="A1.F14.9.m4.1.1.1" xref="A1.F14.9.m4.1.1.1.cmml">​</mo><mi id="A1.F14.9.m4.1.1.3" xref="A1.F14.9.m4.1.1.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="A1.F14.9.m4.1.1.1b" xref="A1.F14.9.m4.1.1.1.cmml">​</mo><mn id="A1.F14.9.m4.1.1.4" xref="A1.F14.9.m4.1.1.4.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F14.9.m4.1c"><apply id="A1.F14.9.m4.1.1.cmml" xref="A1.F14.9.m4.1.1"><times id="A1.F14.9.m4.1.1.1.cmml" xref="A1.F14.9.m4.1.1.1"></times><cn type="integer" id="A1.F14.9.m4.1.1.2.cmml" xref="A1.F14.9.m4.1.1.2">7</cn><ci id="A1.F14.9.m4.1.1.3.cmml" xref="A1.F14.9.m4.1.1.3">𝑥</ci><cn type="integer" id="A1.F14.9.m4.1.1.4.cmml" xref="A1.F14.9.m4.1.1.4">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F14.9.m4.1d">7x7</annotation></semantics></math>).
Compare to a placement before the first convolution (<math id="A1.F14.10.m5.1" class="ltx_Math" alttext="224x224" display="inline"><semantics id="A1.F14.10.m5.1b"><mrow id="A1.F14.10.m5.1.1" xref="A1.F14.10.m5.1.1.cmml"><mn id="A1.F14.10.m5.1.1.2" xref="A1.F14.10.m5.1.1.2.cmml">224</mn><mo lspace="0em" rspace="0em" id="A1.F14.10.m5.1.1.1" xref="A1.F14.10.m5.1.1.1.cmml">​</mo><mi id="A1.F14.10.m5.1.1.3" xref="A1.F14.10.m5.1.1.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="A1.F14.10.m5.1.1.1b" xref="A1.F14.10.m5.1.1.1.cmml">​</mo><mn id="A1.F14.10.m5.1.1.4" xref="A1.F14.10.m5.1.1.4.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F14.10.m5.1c"><apply id="A1.F14.10.m5.1.1.cmml" xref="A1.F14.10.m5.1.1"><times id="A1.F14.10.m5.1.1.1.cmml" xref="A1.F14.10.m5.1.1.1"></times><cn type="integer" id="A1.F14.10.m5.1.1.2.cmml" xref="A1.F14.10.m5.1.1.2">224</cn><ci id="A1.F14.10.m5.1.1.3.cmml" xref="A1.F14.10.m5.1.1.3">𝑥</ci><cn type="integer" id="A1.F14.10.m5.1.1.4.cmml" xref="A1.F14.10.m5.1.1.4">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F14.10.m5.1d">224x224</annotation></semantics></math>) and raw input data in <a href="#S3.F2" title="In 3.3 Imprinting User Information into Model Updates ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>. Enlarged versions of each panel can be seen in Figs. <a href="#A1.F15" title="Figure 15 ‣ A.6 Additional Images ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a> - <a href="#A1.F18" title="Figure 18 ‣ A.6 Additional Images ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">18</span></a></figcaption>
</figure>
<figure id="A1.F15" class="ltx_figure">
<div id="A1.F15.1" class="ltx_block ltx_minipage ltx_align_center ltx_align_middle" style="width:397.5pt;">
<img src="/html/2110.13057/assets/images/standard56x56_64_128_15_04.png" id="A1.F15.1.g1" class="ltx_graphics ltx_img_square" width="270" height="264" alt="Refer to caption">
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>Different placements of the imprint module in a ResNet-18. Before the first block (<math id="A1.F15.3.m1.1" class="ltx_Math" alttext="56\times 56" display="inline"><semantics id="A1.F15.3.m1.1b"><mrow id="A1.F15.3.m1.1.1" xref="A1.F15.3.m1.1.1.cmml"><mn id="A1.F15.3.m1.1.1.2" xref="A1.F15.3.m1.1.1.2.cmml">56</mn><mo lspace="0.222em" rspace="0.222em" id="A1.F15.3.m1.1.1.1" xref="A1.F15.3.m1.1.1.1.cmml">×</mo><mn id="A1.F15.3.m1.1.1.3" xref="A1.F15.3.m1.1.1.3.cmml">56</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F15.3.m1.1c"><apply id="A1.F15.3.m1.1.1.cmml" xref="A1.F15.3.m1.1.1"><times id="A1.F15.3.m1.1.1.1.cmml" xref="A1.F15.3.m1.1.1.1"></times><cn type="integer" id="A1.F15.3.m1.1.1.2.cmml" xref="A1.F15.3.m1.1.1.2">56</cn><cn type="integer" id="A1.F15.3.m1.1.1.3.cmml" xref="A1.F15.3.m1.1.1.3">56</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F15.3.m1.1d">56\times 56</annotation></semantics></math>). Only the first three channels at this position are utilized in this demonstration.</figcaption>
</figure>
<figure id="A1.F16" class="ltx_figure">
<div id="A1.F16.1" class="ltx_block ltx_minipage ltx_align_center ltx_align_middle" style="width:397.5pt;">
<img src="/html/2110.13057/assets/images/standard28x28_64_128_14_63.png" id="A1.F16.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="270" height="264" alt="Refer to caption">
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span>Different placements of the imprint module in a ResNet-18. Before the third block (<math id="A1.F16.3.m1.1" class="ltx_Math" alttext="28\times 28" display="inline"><semantics id="A1.F16.3.m1.1b"><mrow id="A1.F16.3.m1.1.1" xref="A1.F16.3.m1.1.1.cmml"><mn id="A1.F16.3.m1.1.1.2" xref="A1.F16.3.m1.1.1.2.cmml">28</mn><mo lspace="0.222em" rspace="0.222em" id="A1.F16.3.m1.1.1.1" xref="A1.F16.3.m1.1.1.1.cmml">×</mo><mn id="A1.F16.3.m1.1.1.3" xref="A1.F16.3.m1.1.1.3.cmml">28</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F16.3.m1.1c"><apply id="A1.F16.3.m1.1.1.cmml" xref="A1.F16.3.m1.1.1"><times id="A1.F16.3.m1.1.1.1.cmml" xref="A1.F16.3.m1.1.1.1"></times><cn type="integer" id="A1.F16.3.m1.1.1.2.cmml" xref="A1.F16.3.m1.1.1.2">28</cn><cn type="integer" id="A1.F16.3.m1.1.1.3.cmml" xref="A1.F16.3.m1.1.1.3">28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F16.3.m1.1d">28\times 28</annotation></semantics></math>). Only the first three channels at this position are utilized in this demonstration.</figcaption>
</figure>
<figure id="A1.F17" class="ltx_figure">
<div id="A1.F17.1" class="ltx_block ltx_minipage ltx_align_center ltx_align_middle" style="width:397.5pt;">
<img src="/html/2110.13057/assets/images/standard14x14_64_128_13_84.png" id="A1.F17.1.g1" class="ltx_graphics ltx_img_square" width="270" height="264" alt="Refer to caption">
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span>Different placements of the imprint module in a ResNet-18. Before the fourth block (<math id="A1.F17.3.m1.1" class="ltx_Math" alttext="14\times 14" display="inline"><semantics id="A1.F17.3.m1.1b"><mrow id="A1.F17.3.m1.1.1" xref="A1.F17.3.m1.1.1.cmml"><mn id="A1.F17.3.m1.1.1.2" xref="A1.F17.3.m1.1.1.2.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="A1.F17.3.m1.1.1.1" xref="A1.F17.3.m1.1.1.1.cmml">×</mo><mn id="A1.F17.3.m1.1.1.3" xref="A1.F17.3.m1.1.1.3.cmml">14</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F17.3.m1.1c"><apply id="A1.F17.3.m1.1.1.cmml" xref="A1.F17.3.m1.1.1"><times id="A1.F17.3.m1.1.1.1.cmml" xref="A1.F17.3.m1.1.1.1"></times><cn type="integer" id="A1.F17.3.m1.1.1.2.cmml" xref="A1.F17.3.m1.1.1.2">14</cn><cn type="integer" id="A1.F17.3.m1.1.1.3.cmml" xref="A1.F17.3.m1.1.1.3">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F17.3.m1.1d">14\times 14</annotation></semantics></math>)</figcaption>
</figure>
<figure id="A1.F18" class="ltx_figure">
<div id="A1.F18.1" class="ltx_block ltx_minipage ltx_align_center ltx_align_middle" style="width:397.5pt;">
<img src="/html/2110.13057/assets/images/standard7x7_64_128_13_46.png" id="A1.F18.1.g1" class="ltx_graphics ltx_img_square" width="270" height="264" alt="Refer to caption">
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 18: </span>Different placements of the imprint module in a ResNet-18. Before the last average-pooling layer (<math id="A1.F18.3.m1.1" class="ltx_Math" alttext="7\times 7" display="inline"><semantics id="A1.F18.3.m1.1b"><mrow id="A1.F18.3.m1.1.1" xref="A1.F18.3.m1.1.1.cmml"><mn id="A1.F18.3.m1.1.1.2" xref="A1.F18.3.m1.1.1.2.cmml">7</mn><mo lspace="0.222em" rspace="0.222em" id="A1.F18.3.m1.1.1.1" xref="A1.F18.3.m1.1.1.1.cmml">×</mo><mn id="A1.F18.3.m1.1.1.3" xref="A1.F18.3.m1.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F18.3.m1.1c"><apply id="A1.F18.3.m1.1.1.cmml" xref="A1.F18.3.m1.1.1"><times id="A1.F18.3.m1.1.1.1.cmml" xref="A1.F18.3.m1.1.1.1"></times><cn type="integer" id="A1.F18.3.m1.1.1.2.cmml" xref="A1.F18.3.m1.1.1.2">7</cn><cn type="integer" id="A1.F18.3.m1.1.1.3.cmml" xref="A1.F18.3.m1.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F18.3.m1.1d">7\times 7</annotation></semantics></math>). Only the first three channels at this position are utilized in this demonstration.</figcaption>
</figure>
<figure id="A1.F19" class="ltx_figure">
<div id="A1.F19.1" class="ltx_block ltx_minipage ltx_align_center ltx_align_middle" style="width:397.5pt;">
<img src="/html/2110.13057/assets/images/fedAVG_8_8_1e4_fixed.png" id="A1.F19.1.g1" class="ltx_graphics ltx_img_square" width="270" height="264" alt="Refer to caption">
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 19: </span>Results for federated averaging for 8 steps with 8 images each, i.e. 64 unique data points for a single user, and 128 bins. PSNR: 32.65. IIP: 70.31%. Drift of bins during local updates leads to a few duplicated entries.</figcaption>
</figure>
</section>
<section id="A1.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.7 </span>Defense Discussion</h3>

<figure id="A1.F20" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="A1.F20.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/x10.png" id="A1.F20.1.g1" class="ltx_graphics ltx_img_landscape" width="206" height="103" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="A1.F20.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:194.8pt;">
<img src="/html/2110.13057/assets/images/standard_model_gradient_noise001.png" id="A1.F20.2.g1" class="ltx_graphics ltx_img_square" width="138" height="135" alt="Refer to caption">
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 20: </span><span id="A1.F20.7.1" class="ltx_text ltx_font_bold">Left:</span> IIP score vs Laplacian gradient noise. <span id="A1.F20.8.2" class="ltx_text ltx_font_bold">Right:</span> Exemplary recovery for <math id="A1.F20.4.m1.1" class="ltx_Math" alttext="\sigma=0.01" display="inline"><semantics id="A1.F20.4.m1.1b"><mrow id="A1.F20.4.m1.1.1" xref="A1.F20.4.m1.1.1.cmml"><mi id="A1.F20.4.m1.1.1.2" xref="A1.F20.4.m1.1.1.2.cmml">σ</mi><mo id="A1.F20.4.m1.1.1.1" xref="A1.F20.4.m1.1.1.1.cmml">=</mo><mn id="A1.F20.4.m1.1.1.3" xref="A1.F20.4.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F20.4.m1.1c"><apply id="A1.F20.4.m1.1.1.cmml" xref="A1.F20.4.m1.1.1"><eq id="A1.F20.4.m1.1.1.1.cmml" xref="A1.F20.4.m1.1.1.1"></eq><ci id="A1.F20.4.m1.1.1.2.cmml" xref="A1.F20.4.m1.1.1.2">𝜎</ci><cn type="float" id="A1.F20.4.m1.1.1.3.cmml" xref="A1.F20.4.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F20.4.m1.1d">\sigma=0.01</annotation></semantics></math>. Recovery is stable for a large range of Laplacian gradient noise injections.</figcaption>
</figure>
<div id="A1.SS7.p1" class="ltx_para ltx_noindent">
<p id="A1.SS7.p1.1" class="ltx_p">An algorithmic defense against the proposed attack would be to validate the incoming model parameters on the user side. There, the attack with multiple bins requires repeated computations of the same quantity. At first, this pattern could be detected by rank analysis of all linear layers (which would return a rank of 1 for the linear layer of the imprint module described above). Yet, the attacker can easily randomize a few entries of the linear layer to increase its rank without significantly weakening the attack, or introduce additional rows that compute normal deep features, so that we do not believe a defender can win by model analysis under the given threat model.</p>
</div>
</section>
<section id="A1.SS8" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.8 </span>Comparison to Concurrent Work</h3>

<div id="A1.SS8.p1" class="ltx_para ltx_noindent">
<p id="A1.SS8.p1.1" class="ltx_p">We include a comparison to the concurrent attack of <cite class="ltx_cite ltx_citemacro_citet">Boenisch et al. (<a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite> operating in the same threat model in <a href="#A1.F21" title="In A.8 Comparison to Concurrent Work ‣ Appendix A Appendix ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">21</span></a>. The threat model is characterized purely as a parameter modification therein that only applies to models with input-sized linear layers followed by ReLU activations. In the same vein the attack discussed in this work does not require malicious architecture modifications if these vulnerable layers are already present.</p>
</div>
<figure id="A1.F21" class="ltx_figure"><img src="/html/2110.13057/assets/x11.png" id="A1.F21.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="338" height="169" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 21: </span>Comparison to the ”Curious Abandon Honesty” (CAH) attack proposed in <cite class="ltx_cite ltx_citemacro_citet">Boenisch et al. (<a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite>. We find our attack outperforms their attack at every scale.</figcaption>
</figure>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Remark on Recovery</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.2" class="ltx_p">Note that for the recovery in <a href="#S3.E2" title="In 3.2 A Simple Example ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, we place either an averaging operation, or linear layer following <math id="A2.p1.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="A2.p1.1.m1.1a"><mi id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><ci id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">W</annotation></semantics></math> with identical row elements. This is because in <a href="#S3.E2" title="In 3.2 A Simple Example ‣ 3 Model Modifications ‣ Robbing the Fed: Directly Obtaining Private Data in Federated Learning with Modified Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, the attacker needs <math id="A2.p1.2.m2.1" class="ltx_Math" alttext="\frac{\partial\mathcal{L}}{\partial b_{i}}=\frac{\partial\mathcal{L}}{\partial b_{i+1}}" display="inline"><semantics id="A2.p1.2.m2.1a"><mrow id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml"><mfrac id="A2.p1.2.m2.1.1.2" xref="A2.p1.2.m2.1.1.2.cmml"><mrow id="A2.p1.2.m2.1.1.2.2" xref="A2.p1.2.m2.1.1.2.2.cmml"><mo rspace="0em" id="A2.p1.2.m2.1.1.2.2.1" xref="A2.p1.2.m2.1.1.2.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="A2.p1.2.m2.1.1.2.2.2" xref="A2.p1.2.m2.1.1.2.2.2.cmml">ℒ</mi></mrow><mrow id="A2.p1.2.m2.1.1.2.3" xref="A2.p1.2.m2.1.1.2.3.cmml"><mo rspace="0em" id="A2.p1.2.m2.1.1.2.3.1" xref="A2.p1.2.m2.1.1.2.3.1.cmml">∂</mo><msub id="A2.p1.2.m2.1.1.2.3.2" xref="A2.p1.2.m2.1.1.2.3.2.cmml"><mi id="A2.p1.2.m2.1.1.2.3.2.2" xref="A2.p1.2.m2.1.1.2.3.2.2.cmml">b</mi><mi id="A2.p1.2.m2.1.1.2.3.2.3" xref="A2.p1.2.m2.1.1.2.3.2.3.cmml">i</mi></msub></mrow></mfrac><mo id="A2.p1.2.m2.1.1.1" xref="A2.p1.2.m2.1.1.1.cmml">=</mo><mfrac id="A2.p1.2.m2.1.1.3" xref="A2.p1.2.m2.1.1.3.cmml"><mrow id="A2.p1.2.m2.1.1.3.2" xref="A2.p1.2.m2.1.1.3.2.cmml"><mo rspace="0em" id="A2.p1.2.m2.1.1.3.2.1" xref="A2.p1.2.m2.1.1.3.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="A2.p1.2.m2.1.1.3.2.2" xref="A2.p1.2.m2.1.1.3.2.2.cmml">ℒ</mi></mrow><mrow id="A2.p1.2.m2.1.1.3.3" xref="A2.p1.2.m2.1.1.3.3.cmml"><mo rspace="0em" id="A2.p1.2.m2.1.1.3.3.1" xref="A2.p1.2.m2.1.1.3.3.1.cmml">∂</mo><msub id="A2.p1.2.m2.1.1.3.3.2" xref="A2.p1.2.m2.1.1.3.3.2.cmml"><mi id="A2.p1.2.m2.1.1.3.3.2.2" xref="A2.p1.2.m2.1.1.3.3.2.2.cmml">b</mi><mrow id="A2.p1.2.m2.1.1.3.3.2.3" xref="A2.p1.2.m2.1.1.3.3.2.3.cmml"><mi id="A2.p1.2.m2.1.1.3.3.2.3.2" xref="A2.p1.2.m2.1.1.3.3.2.3.2.cmml">i</mi><mo id="A2.p1.2.m2.1.1.3.3.2.3.1" xref="A2.p1.2.m2.1.1.3.3.2.3.1.cmml">+</mo><mn id="A2.p1.2.m2.1.1.3.3.2.3.3" xref="A2.p1.2.m2.1.1.3.3.2.3.3.cmml">1</mn></mrow></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><apply id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1"><eq id="A2.p1.2.m2.1.1.1.cmml" xref="A2.p1.2.m2.1.1.1"></eq><apply id="A2.p1.2.m2.1.1.2.cmml" xref="A2.p1.2.m2.1.1.2"><divide id="A2.p1.2.m2.1.1.2.1.cmml" xref="A2.p1.2.m2.1.1.2"></divide><apply id="A2.p1.2.m2.1.1.2.2.cmml" xref="A2.p1.2.m2.1.1.2.2"><partialdiff id="A2.p1.2.m2.1.1.2.2.1.cmml" xref="A2.p1.2.m2.1.1.2.2.1"></partialdiff><ci id="A2.p1.2.m2.1.1.2.2.2.cmml" xref="A2.p1.2.m2.1.1.2.2.2">ℒ</ci></apply><apply id="A2.p1.2.m2.1.1.2.3.cmml" xref="A2.p1.2.m2.1.1.2.3"><partialdiff id="A2.p1.2.m2.1.1.2.3.1.cmml" xref="A2.p1.2.m2.1.1.2.3.1"></partialdiff><apply id="A2.p1.2.m2.1.1.2.3.2.cmml" xref="A2.p1.2.m2.1.1.2.3.2"><csymbol cd="ambiguous" id="A2.p1.2.m2.1.1.2.3.2.1.cmml" xref="A2.p1.2.m2.1.1.2.3.2">subscript</csymbol><ci id="A2.p1.2.m2.1.1.2.3.2.2.cmml" xref="A2.p1.2.m2.1.1.2.3.2.2">𝑏</ci><ci id="A2.p1.2.m2.1.1.2.3.2.3.cmml" xref="A2.p1.2.m2.1.1.2.3.2.3">𝑖</ci></apply></apply></apply><apply id="A2.p1.2.m2.1.1.3.cmml" xref="A2.p1.2.m2.1.1.3"><divide id="A2.p1.2.m2.1.1.3.1.cmml" xref="A2.p1.2.m2.1.1.3"></divide><apply id="A2.p1.2.m2.1.1.3.2.cmml" xref="A2.p1.2.m2.1.1.3.2"><partialdiff id="A2.p1.2.m2.1.1.3.2.1.cmml" xref="A2.p1.2.m2.1.1.3.2.1"></partialdiff><ci id="A2.p1.2.m2.1.1.3.2.2.cmml" xref="A2.p1.2.m2.1.1.3.2.2">ℒ</ci></apply><apply id="A2.p1.2.m2.1.1.3.3.cmml" xref="A2.p1.2.m2.1.1.3.3"><partialdiff id="A2.p1.2.m2.1.1.3.3.1.cmml" xref="A2.p1.2.m2.1.1.3.3.1"></partialdiff><apply id="A2.p1.2.m2.1.1.3.3.2.cmml" xref="A2.p1.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="A2.p1.2.m2.1.1.3.3.2.1.cmml" xref="A2.p1.2.m2.1.1.3.3.2">subscript</csymbol><ci id="A2.p1.2.m2.1.1.3.3.2.2.cmml" xref="A2.p1.2.m2.1.1.3.3.2.2">𝑏</ci><apply id="A2.p1.2.m2.1.1.3.3.2.3.cmml" xref="A2.p1.2.m2.1.1.3.3.2.3"><plus id="A2.p1.2.m2.1.1.3.3.2.3.1.cmml" xref="A2.p1.2.m2.1.1.3.3.2.3.1"></plus><ci id="A2.p1.2.m2.1.1.3.3.2.3.2.cmml" xref="A2.p1.2.m2.1.1.3.3.2.3.2">𝑖</ci><cn type="integer" id="A2.p1.2.m2.1.1.3.3.2.3.3.cmml" xref="A2.p1.2.m2.1.1.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">\frac{\partial\mathcal{L}}{\partial b_{i}}=\frac{\partial\mathcal{L}}{\partial b_{i+1}}</annotation></semantics></math>. A sufficient condition for this is that the operation proceeding the imprint module, such as averaging, can be expressed as a matrix operation with identical row elements. This falls squarely within our assumed threat model and is empirically how we implement our attack.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Code Release</h2>

<div id="A3.p1" class="ltx_para ltx_noindent">
<p id="A3.p1.1" class="ltx_p">We provide open-source implementations of all attacks investigated in this work. The repository at <a target="_blank" href="https://github.com/lhfowl/robbing_the_fed" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/lhfowl/robbing_the_fed</a> shows a minimalistic implementation of the principles of this attack and the repository at <a target="_blank" href="https://github.com/JonasGeiping/breaching" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/JonasGeiping/breaching</a> embeds the attack in a larger framework of privacy attacks against federated learning.</p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2110.13056" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2110.13057" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2110.13057">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2110.13057" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2110.13059" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Mar  3 23:32:34 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
