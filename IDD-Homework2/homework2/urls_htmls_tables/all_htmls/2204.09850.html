<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2204.09850] FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation</title><meta property="og:description" content="Contrastive learning is widely used for recommendation model learning, where selecting representative and informative negative samples is critical.
Existing methods usually focus on centralized data, where abundant and…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2204.09850">

<!--Generated on Mon Mar 11 12:39:04 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Chuhan Wu<sup id="id1.1.1" class="ltx_sup"><sup id="id1.1.1.1" class="ltx_sup">1</sup></sup>,
Fangzhao Wu<sup id="id2.2.2" class="ltx_sup"><sup id="id2.2.2.1" class="ltx_sup">2</sup></sup>,
Tao Qi<sup id="id3.3.3" class="ltx_sup"><sup id="id3.3.3.1" class="ltx_sup">1</sup></sup>,
Yongfeng Huang<sup id="id4.4.4" class="ltx_sup"><sup id="id4.4.4.1" class="ltx_sup">1</sup></sup>,
Xing Xie<sup id="id5.5.5" class="ltx_sup"><sup id="id5.5.5.1" class="ltx_sup">2</sup></sup>
<sup id="id6.6.6" class="ltx_sup"><sup id="id6.6.6.1" class="ltx_sup">1</sup></sup>Department of Electronic Engineering &amp; BNRist, Tsinghua University, Beijing 100084, China
<br class="ltx_break"><sup id="id7.7.7" class="ltx_sup"><sup id="id7.7.7.1" class="ltx_sup">2</sup></sup>Microsoft Research Asia, Beijing 100080, China
<br class="ltx_break">{wuchuhan15, wufangzhao, taoqi.qt}@gmail.com, yfhuang@tsinghua.edu.cn, xing.xie@microsoft.com
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id8.id1" class="ltx_p">Contrastive learning is widely used for recommendation model learning, where selecting representative and informative negative samples is critical.
Existing methods usually focus on centralized data, where abundant and high-quality negative samples are easy to obtain.
However, centralized user data storage and exploitation may lead to privacy risks and concerns, while decentralized user data on a single client can be too sparse and biased for accurate contrastive learning.
In this paper, we propose a federated contrastive learning method named <span id="id8.id1.1" class="ltx_text ltx_font_italic">FedCL</span> for privacy-preserving recommendation, which can exploit high-quality negative samples for effective model training with privacy well protected.
We first infer user embeddings from local user data through the local model on each client, and then perturb them with local differential privacy (LDP) before sending them to a central server for hard negative sampling.
Since individual user embedding contains heavy noise due to LDP, we propose to cluster user embeddings on the server to mitigate the influence of noise, and the cluster centroids are used to retrieve hard negative samples from the item pool.
These hard negative samples are delivered to user clients and mixed with the observed negative samples from local data as well as in-batch negatives constructed from positive samples for federated model training.
Extensive experiments on four benchmark datasets show <span id="id8.id1.2" class="ltx_text ltx_font_italic">FedCL</span> can empower various recommendation methods in a privacy-preserving way.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Contrastive learning is a widely-adopted technique in personalized recommendation <cite class="ltx_cite ltx_citemacro_cite">Zhou <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib26" title="" class="ltx_ref">2020</a>)</cite>.
Choosing informative negative samples is usually a necessity in contrastive recommendation model learning <cite class="ltx_cite ltx_citemacro_cite">Robinson <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>, and various strategies have been explored in existing works <cite class="ltx_cite ltx_citemacro_cite">Wang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>.
For example, Rendle et al. <cite class="ltx_cite ltx_citemacro_cite">Rendle <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2009</a>)</cite> proposed to compare each positive sample with a randomly selected negative sample from the entire item set.
Wu et al. <cite class="ltx_cite ltx_citemacro_cite">Wu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite> randomly selected several displayed but not clicked news within a news impression as negative samples to contrast them with the positive sample.
Some recommendation methods further introduce hard negatives to improve the informativeness of training samples.
For instance, Ding et al. <cite class="ltx_cite ltx_citemacro_cite">Ding <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite> proposed to use reinforcement learning to select hard negative samples from unclicked data.
These methods are usually learned on centralized user data, where abundant and representative negative samples can be drawn from the global dataset.
However, user data is usually highly privacy-sensitive, and centralized storage and mining of it may bring considerable privacy risks and user concerns.
Some strict data protection regulations like GDPR<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://gdpr-info.eu/</span></span></span> also restrict the collection and centralized storage of user data.
Thus, these methods are not feasible in privacy-preserving recommendation without centralized data to construct training samples.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Recent works study to use federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib13" title="" class="ltx_ref">2017</a>)</cite> to learn recommendation models in a decentralized way, where the raw user data is not necessarily uploaded to a server <cite class="ltx_cite ltx_citemacro_cite">Chai <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>.
For example, Ammad et al. <cite class="ltx_cite ltx_citemacro_cite">Ammad-Ud-Din <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite> proposed a federated collaborative filtering method that only uploads the item embedding gradients, where negative samples are random items chosen from the item pool.
These methods usually assume that there are sufficient negative items on each local device for negative sampling and model training, which may not be satisfied in real-world scenarios.
In fact, the local data on user devices can be rather sparse and biased, and even there is no negative sample stored on user devices because many online services do not locally record non-interacted items <cite class="ltx_cite ltx_citemacro_cite">Ning <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>, which poses great challenges to contrastive recommendation model learning under privacy protection.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we propose a federated contrastive recommendation model learning method named <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">FedCL</span>, which can exploit high-quality negative samples in a privacy-preserving way to empower model training.
In our approach, the local model maintained on each client first infers a user embedding based on local user profiles.
To protect user privacy, we perturb user embeddings via local differential privacy (LDP) before sending them to a central server for hard negative sampling.
Since the perturbed user embeddings are quite noisy, we propose to cluster them on the server via the Ward clustering algorithm to reduce the influence of noise.
The cluster centroids can represent users with different types of interests, and we use the cluster centroids instead of user embeddings to retrieve informative negatives from the item pool via a semi-hard negative sampling method.
These negatives are delivered to user clients for federated model training by mixing them with the real negative samples stored by local clients (if available) and the local in-batch negatives inferred from positive samples.
Extensive experiments on four benchmark recommendation datasets show that <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">FedCL</span> can effectively improve the performance of various recommendation methods and meanwhile protect user privacy.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The main contributions of this paper include:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a federated contrastive learning method for privacy-preserving recommendation that can exploit informative negatives for model training.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a federated hard negative sampling method that can accurately find hard negative samples for contrastive model training in a privacy-preserving way.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We design a negative mix-up method to incorporate various kinds of negative samples within a unified contrastive training framework.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">We conduct extensive experiments to verify the effectiveness of our approach in empowering various recommendation methods in federated learning scenarios.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Contrastive Learning in Information Retrieval</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Contrastive learning is a core technique in many information retrieval (IR) tasks such as web search <cite class="ltx_cite ltx_citemacro_cite">Xiong <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite> and personalized recommendation <cite class="ltx_cite ltx_citemacro_cite">Wei <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite>.
A core problem of contrastive IR model training is selecting proper negative samples to contrast with the positive ones <cite class="ltx_cite ltx_citemacro_cite">Robinson <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>.
One popular way is to randomly sample negatives from the candidate set.
For example, the Bayesian Personalized Ranking (BPR) <cite class="ltx_cite ltx_citemacro_cite">Rendle <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2009</a>)</cite> method uses a randomly selected negative sample to compare with a positive sample.
Many other works explore learning IR models by optimizing the gaps between the positive sample and a certain number of random negative samples <cite class="ltx_cite ltx_citemacro_cite">Shen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2014</a>); Wu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite>.
Another widely used way is in-batch negative sampling.
For example, Yi et al. <cite class="ltx_cite ltx_citemacro_cite">Yi <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite> proposed to use the positive items within the same batch as shared negatives for all queries in this batch.
However, random or in-batch negative samples can be somewhat too easy for model training <cite class="ltx_cite ltx_citemacro_cite">Robinson <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>.
To exploit more representative and informative negative samples for discriminative model training, some methods explore to incorporate hard negative samples into model learning <cite class="ltx_cite ltx_citemacro_cite">Kalantidis <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>.
For example, Ding et al. <cite class="ltx_cite ltx_citemacro_cite">Ding <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib3" title="" class="ltx_ref">2019</a>)</cite> proposed to use reinforcement learning to train a sampler model to select negative samples for contrastive recommendation model training.
Xiong et al. <cite class="ltx_cite ltx_citemacro_cite">Xiong <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite> proposed to use an asynchronously updated ANN index to select globally hardest negative samples from the candidate document pool for learning the matching model.
These methods usually require centralized data storage for negative sampling.
However, under privacy-preserving settings there is no centralized data and the local data on user devices can be too sparse to obtain effective negative samples, making it difficult to apply existing contrastive IR model learning methods.
Thus, in our work, we propose a federated contrastive learning method for recommendation, which can incorporate various kinds of negative samples into contrastive model training in a privacy-preserving way.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Federated Recommendation</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">In recent years, the application of federated learning in privacy-preserving recommendation has been extensively studied <cite class="ltx_cite ltx_citemacro_cite">Chai <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib2" title="" class="ltx_ref">2020</a>); Qi <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib15" title="" class="ltx_ref">2020</a>); Liang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2021</a>)</cite>.
For example, Ammad et al. <cite class="ltx_cite ltx_citemacro_cite">Ammad-Ud-Din <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite> proposed to locally learn user and item embeddings on local user data, and upload item embedding gradients to a server for global model updating and delivery.
Lin et al. <cite class="ltx_cite ltx_citemacro_cite">Lin <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib11" title="" class="ltx_ref">2020</a>)</cite> proposed to randomly sample some unrated items and assign them virtual ratings to avoid communicating the full item embedding table.
Qi et al. <cite class="ltx_cite ltx_citemacro_cite">Qi <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite> proposed a unified method for privacy-preserving news recall and ranking by modeling user interests with linear combinations of basis interest vectors.
However, these methods usually assume that there are sufficient negative samples available on local user devices.
Unfortunately, in many scenarios such as product recommendation and web search, non-interacted items are typically not locally recorded due to efficiency concerns.
It may also be suboptimal to simply use random negative items provided by the server without considering clients’ characteristics.
One recent work <cite class="ltx_cite ltx_citemacro_cite">Ning <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite> studies learning recommendation models under limited locally available negative samples.
They proposed to use a batch-insensitive loss that enables using local positive items only to construct training samples.
However, useful negative signals cannot be considered by this method.
By contrast, our proposed method can effectively exploit various kinds of negative samples under privacy protection to improve contrastive recommendation model learning.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>FedCL</h2>

<figure id="S3.F1" class="ltx_figure"><img src="/html/2204.09850/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="233" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The framework of our <span id="S3.F1.2.1" class="ltx_text ltx_font_italic">FedCL</span> approach. The standard local gradients uploading and aggregation in FL are omitted.</figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Next, we introduce our federated contrastive learning (<span id="S3.p1.1.1" class="ltx_text ltx_font_italic">FedCL</span>) approach for recommendation in detail.
Its overall framework is shown in Fig. <a href="#S3.F1" title="Figure 1 ‣ 3 FedCL ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
The server not only coordinates a large number of clients for collaborative model updating, but is also responsible for finding hard negative samples to empower model training.
There are two major steps in <span id="S3.p1.1.2" class="ltx_text ltx_font_italic">FedCL</span>, i.e., federated negative sampling and negative mix-up for local contrastive learning, which are described as follows.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Federated Negative Sampling</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.11" class="ltx_p">In federated learning, there is no global dataset for hard negative sampling.
In addition, since local user data is highly sparse and biased, it is also impractical to conduct hard negative sampling locally.
To solve this problem, we propose a federated negative sampling method to choose hard negatives in a privacy-preserving manner.
Assume that there are <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">N</annotation></semantics></math> clients in total.
Each client first uses its maintained local user model to infer a user embedding from the local user profile.
The user model can be a simple user ID embedding, or a more complicated one that learns user embeddings from the sequence of historical interacted items.
We denote the embedding of user <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">u</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑢</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">u_{i}</annotation></semantics></math> as <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{u}_{i}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">𝐮</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝐮</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathbf{u}_{i}</annotation></semantics></math>.
Since this user embedding still contains much private user information, we use local differential privacy (LDP) to perturb this embedding.
Motivated by <cite class="ltx_cite ltx_citemacro_cite">Qi <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib15" title="" class="ltx_ref">2020</a>)</cite>, we first clip each user embedding with a threshold <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\delta</annotation></semantics></math> according to its <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="L_{1}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">L</mi><mn id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝐿</ci><cn type="integer" id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">L_{1}</annotation></semantics></math> norm, and add Laplace noise <math id="S3.SS1.p1.6.m6.2" class="ltx_Math" alttext="\mathbf{n}\sim Laplace(0,\frac{2\delta}{\epsilon})" display="inline"><semantics id="S3.SS1.p1.6.m6.2a"><mrow id="S3.SS1.p1.6.m6.2.3" xref="S3.SS1.p1.6.m6.2.3.cmml"><mi id="S3.SS1.p1.6.m6.2.3.2" xref="S3.SS1.p1.6.m6.2.3.2.cmml">𝐧</mi><mo id="S3.SS1.p1.6.m6.2.3.1" xref="S3.SS1.p1.6.m6.2.3.1.cmml">∼</mo><mrow id="S3.SS1.p1.6.m6.2.3.3" xref="S3.SS1.p1.6.m6.2.3.3.cmml"><mi id="S3.SS1.p1.6.m6.2.3.3.2" xref="S3.SS1.p1.6.m6.2.3.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.2.3.3.1" xref="S3.SS1.p1.6.m6.2.3.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.2.3.3.3" xref="S3.SS1.p1.6.m6.2.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.2.3.3.1a" xref="S3.SS1.p1.6.m6.2.3.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.2.3.3.4" xref="S3.SS1.p1.6.m6.2.3.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.2.3.3.1b" xref="S3.SS1.p1.6.m6.2.3.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.2.3.3.5" xref="S3.SS1.p1.6.m6.2.3.3.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.2.3.3.1c" xref="S3.SS1.p1.6.m6.2.3.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.2.3.3.6" xref="S3.SS1.p1.6.m6.2.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.2.3.3.1d" xref="S3.SS1.p1.6.m6.2.3.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.2.3.3.7" xref="S3.SS1.p1.6.m6.2.3.3.7.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.2.3.3.1e" xref="S3.SS1.p1.6.m6.2.3.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.2.3.3.8" xref="S3.SS1.p1.6.m6.2.3.3.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.2.3.3.1f" xref="S3.SS1.p1.6.m6.2.3.3.1.cmml">​</mo><mrow id="S3.SS1.p1.6.m6.2.3.3.9.2" xref="S3.SS1.p1.6.m6.2.3.3.9.1.cmml"><mo stretchy="false" id="S3.SS1.p1.6.m6.2.3.3.9.2.1" xref="S3.SS1.p1.6.m6.2.3.3.9.1.cmml">(</mo><mn id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">0</mn><mo id="S3.SS1.p1.6.m6.2.3.3.9.2.2" xref="S3.SS1.p1.6.m6.2.3.3.9.1.cmml">,</mo><mfrac id="S3.SS1.p1.6.m6.2.2" xref="S3.SS1.p1.6.m6.2.2.cmml"><mrow id="S3.SS1.p1.6.m6.2.2.2" xref="S3.SS1.p1.6.m6.2.2.2.cmml"><mn id="S3.SS1.p1.6.m6.2.2.2.2" xref="S3.SS1.p1.6.m6.2.2.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.2.2.2.1" xref="S3.SS1.p1.6.m6.2.2.2.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.2.2.2.3" xref="S3.SS1.p1.6.m6.2.2.2.3.cmml">δ</mi></mrow><mi id="S3.SS1.p1.6.m6.2.2.3" xref="S3.SS1.p1.6.m6.2.2.3.cmml">ϵ</mi></mfrac><mo stretchy="false" id="S3.SS1.p1.6.m6.2.3.3.9.2.3" xref="S3.SS1.p1.6.m6.2.3.3.9.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.2b"><apply id="S3.SS1.p1.6.m6.2.3.cmml" xref="S3.SS1.p1.6.m6.2.3"><csymbol cd="latexml" id="S3.SS1.p1.6.m6.2.3.1.cmml" xref="S3.SS1.p1.6.m6.2.3.1">similar-to</csymbol><ci id="S3.SS1.p1.6.m6.2.3.2.cmml" xref="S3.SS1.p1.6.m6.2.3.2">𝐧</ci><apply id="S3.SS1.p1.6.m6.2.3.3.cmml" xref="S3.SS1.p1.6.m6.2.3.3"><times id="S3.SS1.p1.6.m6.2.3.3.1.cmml" xref="S3.SS1.p1.6.m6.2.3.3.1"></times><ci id="S3.SS1.p1.6.m6.2.3.3.2.cmml" xref="S3.SS1.p1.6.m6.2.3.3.2">𝐿</ci><ci id="S3.SS1.p1.6.m6.2.3.3.3.cmml" xref="S3.SS1.p1.6.m6.2.3.3.3">𝑎</ci><ci id="S3.SS1.p1.6.m6.2.3.3.4.cmml" xref="S3.SS1.p1.6.m6.2.3.3.4">𝑝</ci><ci id="S3.SS1.p1.6.m6.2.3.3.5.cmml" xref="S3.SS1.p1.6.m6.2.3.3.5">𝑙</ci><ci id="S3.SS1.p1.6.m6.2.3.3.6.cmml" xref="S3.SS1.p1.6.m6.2.3.3.6">𝑎</ci><ci id="S3.SS1.p1.6.m6.2.3.3.7.cmml" xref="S3.SS1.p1.6.m6.2.3.3.7">𝑐</ci><ci id="S3.SS1.p1.6.m6.2.3.3.8.cmml" xref="S3.SS1.p1.6.m6.2.3.3.8">𝑒</ci><interval closure="open" id="S3.SS1.p1.6.m6.2.3.3.9.1.cmml" xref="S3.SS1.p1.6.m6.2.3.3.9.2"><cn type="integer" id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">0</cn><apply id="S3.SS1.p1.6.m6.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2"><divide id="S3.SS1.p1.6.m6.2.2.1.cmml" xref="S3.SS1.p1.6.m6.2.2"></divide><apply id="S3.SS1.p1.6.m6.2.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2.2"><times id="S3.SS1.p1.6.m6.2.2.2.1.cmml" xref="S3.SS1.p1.6.m6.2.2.2.1"></times><cn type="integer" id="S3.SS1.p1.6.m6.2.2.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2">2</cn><ci id="S3.SS1.p1.6.m6.2.2.2.3.cmml" xref="S3.SS1.p1.6.m6.2.2.2.3">𝛿</ci></apply><ci id="S3.SS1.p1.6.m6.2.2.3.cmml" xref="S3.SS1.p1.6.m6.2.2.3">italic-ϵ</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.2c">\mathbf{n}\sim Laplace(0,\frac{2\delta}{\epsilon})</annotation></semantics></math> to protect this embedding (<math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\epsilon</annotation></semantics></math> is the privacy budget, and a lower <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\epsilon</annotation></semantics></math> means better privacy protection).
Then the protected user embeddings satisfy <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\epsilon</annotation></semantics></math>-DP.
We refer to the protected user embedding of <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><msub id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">u</mi><mi id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝑢</ci><ci id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">u_{i}</annotation></semantics></math> as <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="\mathbf{\hat{u}}_{i}" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><msub id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mover accent="true" id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2.2" xref="S3.SS1.p1.11.m11.1.1.2.2.cmml">𝐮</mi><mo id="S3.SS1.p1.11.m11.1.1.2.1" xref="S3.SS1.p1.11.m11.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">subscript</csymbol><apply id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2"><ci id="S3.SS1.p1.11.m11.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.2.1">^</ci><ci id="S3.SS1.p1.11.m11.1.1.2.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2.2">𝐮</ci></apply><ci id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">\mathbf{\hat{u}}_{i}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.4" class="ltx_p">The protected user embeddings on user clients are uploaded to the server for negative sampling.
A simple way is directly measuring the similarity between candidate items and these embeddings to find negative samples.
However, these embeddings contain heavy noise if the privacy budget is relatively small, and the selected negative samples are usually inaccurate, as shown in the middle plot in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.1 Federated Negative Sampling ‣ 3 FedCL ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
To mitigate the influence of noise on negative sampling, we propose to cluster the user embeddings and use their cluster centroids to represent users with different types of interests.
More specifically, we use the Ward clustering algorithm to aggregate the <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">N</annotation></semantics></math> user embeddings into <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">C</annotation></semantics></math> clusters.
The centroid of each cluster is the element-wise average of user embeddings in this cluster.
We use the cluster centroid to replace the user embeddings in this cluster to conduct hard negative sampling (right plot in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.1 Federated Negative Sampling ‣ 3 FedCL ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).
Since the noise added to the user embeddings is zero-mean, the errors brought by the noise can be mitigated to some extent by using cluster centroids.
We denote the cluster centroid corresponding to the user embedding <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{u}_{i}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">𝐮</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝐮</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mathbf{u}_{i}</annotation></semantics></math> as <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{c}_{i}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">𝐜</mi><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝐜</ci><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\mathbf{c}_{i}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.8" class="ltx_p">We evaluate the relevance between <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{c}_{i}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">𝐜</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝐜</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mathbf{c}_{i}</annotation></semantics></math> and each item embedding in the candidate pool on the server to choose negative samples.
A simple way is to pick the globally hardest negative samples <cite class="ltx_cite ltx_citemacro_cite">Xiong <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>.
However, there may be many false negatives because the candidate items in the entire pool have not necessarily been displayed to the users.
Thus, in our approach we propose to choose semi-hard negative samples to balance their difficulty and accuracy.
For each centroid vector <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{c}_{i}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">𝐜</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝐜</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mathbf{c}_{i}</annotation></semantics></math>, we first retrieve <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">R</annotation></semantics></math>% of candidate samples with the highest difficulties to form a hard candidate subset (a smaller <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">R</annotation></semantics></math> means harder negatives).
We then randomly select <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">T</annotation></semantics></math> negative samples from this subset as semi-hard negative samples.
Note that for clients that are associated with the same cluster centroid, the sampling of negative items from the hard candidate subset is independent, which aims to ensure the comprehensiveness of negative samples.
The semi-hard negative samples drawn from <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="\mathbf{c}_{i}" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><msub id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml"><mi id="S3.SS1.p3.6.m6.1.1.2" xref="S3.SS1.p3.6.m6.1.1.2.cmml">𝐜</mi><mi id="S3.SS1.p3.6.m6.1.1.3" xref="S3.SS1.p3.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p3.6.m6.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2">𝐜</ci><ci id="S3.SS1.p3.6.m6.1.1.3.cmml" xref="S3.SS1.p3.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">\mathbf{c}_{i}</annotation></semantics></math> are denoted as <math id="S3.SS1.p3.7.m7.4" class="ltx_Math" alttext="[h_{1}^{i},h_{2}^{i},...,h_{T}^{i}]" display="inline"><semantics id="S3.SS1.p3.7.m7.4a"><mrow id="S3.SS1.p3.7.m7.4.4.3" xref="S3.SS1.p3.7.m7.4.4.4.cmml"><mo stretchy="false" id="S3.SS1.p3.7.m7.4.4.3.4" xref="S3.SS1.p3.7.m7.4.4.4.cmml">[</mo><msubsup id="S3.SS1.p3.7.m7.2.2.1.1" xref="S3.SS1.p3.7.m7.2.2.1.1.cmml"><mi id="S3.SS1.p3.7.m7.2.2.1.1.2.2" xref="S3.SS1.p3.7.m7.2.2.1.1.2.2.cmml">h</mi><mn id="S3.SS1.p3.7.m7.2.2.1.1.2.3" xref="S3.SS1.p3.7.m7.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS1.p3.7.m7.2.2.1.1.3" xref="S3.SS1.p3.7.m7.2.2.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS1.p3.7.m7.4.4.3.5" xref="S3.SS1.p3.7.m7.4.4.4.cmml">,</mo><msubsup id="S3.SS1.p3.7.m7.3.3.2.2" xref="S3.SS1.p3.7.m7.3.3.2.2.cmml"><mi id="S3.SS1.p3.7.m7.3.3.2.2.2.2" xref="S3.SS1.p3.7.m7.3.3.2.2.2.2.cmml">h</mi><mn id="S3.SS1.p3.7.m7.3.3.2.2.2.3" xref="S3.SS1.p3.7.m7.3.3.2.2.2.3.cmml">2</mn><mi id="S3.SS1.p3.7.m7.3.3.2.2.3" xref="S3.SS1.p3.7.m7.3.3.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS1.p3.7.m7.4.4.3.6" xref="S3.SS1.p3.7.m7.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml">…</mi><mo id="S3.SS1.p3.7.m7.4.4.3.7" xref="S3.SS1.p3.7.m7.4.4.4.cmml">,</mo><msubsup id="S3.SS1.p3.7.m7.4.4.3.3" xref="S3.SS1.p3.7.m7.4.4.3.3.cmml"><mi id="S3.SS1.p3.7.m7.4.4.3.3.2.2" xref="S3.SS1.p3.7.m7.4.4.3.3.2.2.cmml">h</mi><mi id="S3.SS1.p3.7.m7.4.4.3.3.2.3" xref="S3.SS1.p3.7.m7.4.4.3.3.2.3.cmml">T</mi><mi id="S3.SS1.p3.7.m7.4.4.3.3.3" xref="S3.SS1.p3.7.m7.4.4.3.3.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.SS1.p3.7.m7.4.4.3.8" xref="S3.SS1.p3.7.m7.4.4.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.4b"><list id="S3.SS1.p3.7.m7.4.4.4.cmml" xref="S3.SS1.p3.7.m7.4.4.3"><apply id="S3.SS1.p3.7.m7.2.2.1.1.cmml" xref="S3.SS1.p3.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.2.2.1.1.1.cmml" xref="S3.SS1.p3.7.m7.2.2.1.1">superscript</csymbol><apply id="S3.SS1.p3.7.m7.2.2.1.1.2.cmml" xref="S3.SS1.p3.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.2.2.1.1.2.1.cmml" xref="S3.SS1.p3.7.m7.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p3.7.m7.2.2.1.1.2.2.cmml" xref="S3.SS1.p3.7.m7.2.2.1.1.2.2">ℎ</ci><cn type="integer" id="S3.SS1.p3.7.m7.2.2.1.1.2.3.cmml" xref="S3.SS1.p3.7.m7.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS1.p3.7.m7.2.2.1.1.3.cmml" xref="S3.SS1.p3.7.m7.2.2.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p3.7.m7.3.3.2.2.cmml" xref="S3.SS1.p3.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.3.3.2.2.1.cmml" xref="S3.SS1.p3.7.m7.3.3.2.2">superscript</csymbol><apply id="S3.SS1.p3.7.m7.3.3.2.2.2.cmml" xref="S3.SS1.p3.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.3.3.2.2.2.1.cmml" xref="S3.SS1.p3.7.m7.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p3.7.m7.3.3.2.2.2.2.cmml" xref="S3.SS1.p3.7.m7.3.3.2.2.2.2">ℎ</ci><cn type="integer" id="S3.SS1.p3.7.m7.3.3.2.2.2.3.cmml" xref="S3.SS1.p3.7.m7.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p3.7.m7.3.3.2.2.3.cmml" xref="S3.SS1.p3.7.m7.3.3.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">…</ci><apply id="S3.SS1.p3.7.m7.4.4.3.3.cmml" xref="S3.SS1.p3.7.m7.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.4.4.3.3.1.cmml" xref="S3.SS1.p3.7.m7.4.4.3.3">superscript</csymbol><apply id="S3.SS1.p3.7.m7.4.4.3.3.2.cmml" xref="S3.SS1.p3.7.m7.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.4.4.3.3.2.1.cmml" xref="S3.SS1.p3.7.m7.4.4.3.3">subscript</csymbol><ci id="S3.SS1.p3.7.m7.4.4.3.3.2.2.cmml" xref="S3.SS1.p3.7.m7.4.4.3.3.2.2">ℎ</ci><ci id="S3.SS1.p3.7.m7.4.4.3.3.2.3.cmml" xref="S3.SS1.p3.7.m7.4.4.3.3.2.3">𝑇</ci></apply><ci id="S3.SS1.p3.7.m7.4.4.3.3.3.cmml" xref="S3.SS1.p3.7.m7.4.4.3.3.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.4c">[h_{1}^{i},h_{2}^{i},...,h_{T}^{i}]</annotation></semantics></math>, which are further distributed to the <math id="S3.SS1.p3.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p3.8.m8.1a"><mi id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><ci id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">i</annotation></semantics></math>-th client for local model training.
In this way, the user clients can exploit the hard negative samples obtained from the global candidate pool in a privacy-preserving way.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2204.09850/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="346" height="71" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>A schematic example of negative sampling based on original user embeddings, perturbed embeddings and cluster centroids. Red circles and blue triangles represent users with two different types of interests. The squares represent the selected hard negative samples. The perturbed user embeddings cannot select accurate hard negative samples, while using the cluster centroids can reduce the noise impact.</figcaption>
</figure>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<div id="alg1.2" class="ltx_listing ltx_listing">
<div id="alg0.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  Initialize model parameters on the clients and server

</div>
<div id="alg0.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg0.l2.2" class="ltx_text ltx_font_bold">repeat</span>


</div>
<div id="alg0.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     Select a subset <math id="alg0.l3.m1.1" class="ltx_Math" alttext="\mathcal{U}^{\prime}" display="inline"><semantics id="alg0.l3.m1.1a"><msup id="alg0.l3.m1.1.1" xref="alg0.l3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg0.l3.m1.1.1.2" xref="alg0.l3.m1.1.1.2.cmml">𝒰</mi><mo id="alg0.l3.m1.1.1.3" xref="alg0.l3.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg0.l3.m1.1b"><apply id="alg0.l3.m1.1.1.cmml" xref="alg0.l3.m1.1.1"><csymbol cd="ambiguous" id="alg0.l3.m1.1.1.1.cmml" xref="alg0.l3.m1.1.1">superscript</csymbol><ci id="alg0.l3.m1.1.1.2.cmml" xref="alg0.l3.m1.1.1.2">𝒰</ci><ci id="alg0.l3.m1.1.1.3.cmml" xref="alg0.l3.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l3.m1.1c">\mathcal{U}^{\prime}</annotation></semantics></math> from the user set <math id="alg0.l3.m2.1" class="ltx_Math" alttext="\mathcal{U}" display="inline"><semantics id="alg0.l3.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg0.l3.m2.1.1" xref="alg0.l3.m2.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="alg0.l3.m2.1b"><ci id="alg0.l3.m2.1.1.cmml" xref="alg0.l3.m2.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg0.l3.m2.1c">\mathcal{U}</annotation></semantics></math> randomly

</div>
<div id="alg0.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <math id="alg0.l4.m1.1" class="ltx_Math" alttext="\mathbf{g}=0" display="inline"><semantics id="alg0.l4.m1.1a"><mrow id="alg0.l4.m1.1.1" xref="alg0.l4.m1.1.1.cmml"><mi id="alg0.l4.m1.1.1.2" xref="alg0.l4.m1.1.1.2.cmml">𝐠</mi><mo id="alg0.l4.m1.1.1.1" xref="alg0.l4.m1.1.1.1.cmml">=</mo><mn id="alg0.l4.m1.1.1.3" xref="alg0.l4.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg0.l4.m1.1b"><apply id="alg0.l4.m1.1.1.cmml" xref="alg0.l4.m1.1.1"><eq id="alg0.l4.m1.1.1.1.cmml" xref="alg0.l4.m1.1.1.1"></eq><ci id="alg0.l4.m1.1.1.2.cmml" xref="alg0.l4.m1.1.1.2">𝐠</ci><cn type="integer" id="alg0.l4.m1.1.1.3.cmml" xref="alg0.l4.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l4.m1.1c">\mathbf{g}=0</annotation></semantics></math>

</div>
<div id="alg0.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg0.l5.2" class="ltx_text ltx_font_bold">for</span> each user <math id="alg0.l5.m1.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="alg0.l5.m1.1a"><msub id="alg0.l5.m1.1.1" xref="alg0.l5.m1.1.1.cmml"><mi id="alg0.l5.m1.1.1.2" xref="alg0.l5.m1.1.1.2.cmml">u</mi><mi id="alg0.l5.m1.1.1.3" xref="alg0.l5.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg0.l5.m1.1b"><apply id="alg0.l5.m1.1.1.cmml" xref="alg0.l5.m1.1.1"><csymbol cd="ambiguous" id="alg0.l5.m1.1.1.1.cmml" xref="alg0.l5.m1.1.1">subscript</csymbol><ci id="alg0.l5.m1.1.1.2.cmml" xref="alg0.l5.m1.1.1.2">𝑢</ci><ci id="alg0.l5.m1.1.1.3.cmml" xref="alg0.l5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l5.m1.1c">u_{i}</annotation></semantics></math> <math id="alg0.l5.m2.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg0.l5.m2.1a"><mo id="alg0.l5.m2.1.1" xref="alg0.l5.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg0.l5.m2.1b"><in id="alg0.l5.m2.1.1.cmml" xref="alg0.l5.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg0.l5.m2.1c">\in</annotation></semantics></math> <math id="alg0.l5.m3.1" class="ltx_Math" alttext="\mathcal{U}^{\prime}" display="inline"><semantics id="alg0.l5.m3.1a"><msup id="alg0.l5.m3.1.1" xref="alg0.l5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg0.l5.m3.1.1.2" xref="alg0.l5.m3.1.1.2.cmml">𝒰</mi><mo id="alg0.l5.m3.1.1.3" xref="alg0.l5.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg0.l5.m3.1b"><apply id="alg0.l5.m3.1.1.cmml" xref="alg0.l5.m3.1.1"><csymbol cd="ambiguous" id="alg0.l5.m3.1.1.1.cmml" xref="alg0.l5.m3.1.1">superscript</csymbol><ci id="alg0.l5.m3.1.1.2.cmml" xref="alg0.l5.m3.1.1.2">𝒰</ci><ci id="alg0.l5.m3.1.1.3.cmml" xref="alg0.l5.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l5.m3.1c">\mathcal{U}^{\prime}</annotation></semantics></math> in parallel <span id="alg0.l5.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg0.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        Infer user embedding <math id="alg0.l6.m1.1" class="ltx_Math" alttext="\mathbf{u}_{i}" display="inline"><semantics id="alg0.l6.m1.1a"><msub id="alg0.l6.m1.1.1" xref="alg0.l6.m1.1.1.cmml"><mi id="alg0.l6.m1.1.1.2" xref="alg0.l6.m1.1.1.2.cmml">𝐮</mi><mi id="alg0.l6.m1.1.1.3" xref="alg0.l6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg0.l6.m1.1b"><apply id="alg0.l6.m1.1.1.cmml" xref="alg0.l6.m1.1.1"><csymbol cd="ambiguous" id="alg0.l6.m1.1.1.1.cmml" xref="alg0.l6.m1.1.1">subscript</csymbol><ci id="alg0.l6.m1.1.1.2.cmml" xref="alg0.l6.m1.1.1.2">𝐮</ci><ci id="alg0.l6.m1.1.1.3.cmml" xref="alg0.l6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l6.m1.1c">\mathbf{u}_{i}</annotation></semantics></math> from local profile

</div>
<div id="alg0.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>        <math id="alg0.l7.m1.4" class="ltx_Math" alttext="\mathbf{\hat{u}}_{i}\leftarrow clip(\mathbf{u}_{i},\delta)+Laplace(0,2\delta/\epsilon)" display="inline"><semantics id="alg0.l7.m1.4a"><mrow id="alg0.l7.m1.4.4" xref="alg0.l7.m1.4.4.cmml"><msub id="alg0.l7.m1.4.4.4" xref="alg0.l7.m1.4.4.4.cmml"><mover accent="true" id="alg0.l7.m1.4.4.4.2" xref="alg0.l7.m1.4.4.4.2.cmml"><mi id="alg0.l7.m1.4.4.4.2.2" xref="alg0.l7.m1.4.4.4.2.2.cmml">𝐮</mi><mo id="alg0.l7.m1.4.4.4.2.1" xref="alg0.l7.m1.4.4.4.2.1.cmml">^</mo></mover><mi id="alg0.l7.m1.4.4.4.3" xref="alg0.l7.m1.4.4.4.3.cmml">i</mi></msub><mo stretchy="false" id="alg0.l7.m1.4.4.3" xref="alg0.l7.m1.4.4.3.cmml">←</mo><mrow id="alg0.l7.m1.4.4.2" xref="alg0.l7.m1.4.4.2.cmml"><mrow id="alg0.l7.m1.3.3.1.1" xref="alg0.l7.m1.3.3.1.1.cmml"><mi id="alg0.l7.m1.3.3.1.1.3" xref="alg0.l7.m1.3.3.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.3.3.1.1.2" xref="alg0.l7.m1.3.3.1.1.2.cmml">​</mo><mi id="alg0.l7.m1.3.3.1.1.4" xref="alg0.l7.m1.3.3.1.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.3.3.1.1.2a" xref="alg0.l7.m1.3.3.1.1.2.cmml">​</mo><mi id="alg0.l7.m1.3.3.1.1.5" xref="alg0.l7.m1.3.3.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.3.3.1.1.2b" xref="alg0.l7.m1.3.3.1.1.2.cmml">​</mo><mi id="alg0.l7.m1.3.3.1.1.6" xref="alg0.l7.m1.3.3.1.1.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.3.3.1.1.2c" xref="alg0.l7.m1.3.3.1.1.2.cmml">​</mo><mrow id="alg0.l7.m1.3.3.1.1.1.1" xref="alg0.l7.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="alg0.l7.m1.3.3.1.1.1.1.2" xref="alg0.l7.m1.3.3.1.1.1.2.cmml">(</mo><msub id="alg0.l7.m1.3.3.1.1.1.1.1" xref="alg0.l7.m1.3.3.1.1.1.1.1.cmml"><mi id="alg0.l7.m1.3.3.1.1.1.1.1.2" xref="alg0.l7.m1.3.3.1.1.1.1.1.2.cmml">𝐮</mi><mi id="alg0.l7.m1.3.3.1.1.1.1.1.3" xref="alg0.l7.m1.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg0.l7.m1.3.3.1.1.1.1.3" xref="alg0.l7.m1.3.3.1.1.1.2.cmml">,</mo><mi id="alg0.l7.m1.1.1" xref="alg0.l7.m1.1.1.cmml">δ</mi><mo stretchy="false" id="alg0.l7.m1.3.3.1.1.1.1.4" xref="alg0.l7.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="alg0.l7.m1.4.4.2.3" xref="alg0.l7.m1.4.4.2.3.cmml">+</mo><mrow id="alg0.l7.m1.4.4.2.2" xref="alg0.l7.m1.4.4.2.2.cmml"><mi id="alg0.l7.m1.4.4.2.2.3" xref="alg0.l7.m1.4.4.2.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.4.4.2.2.2" xref="alg0.l7.m1.4.4.2.2.2.cmml">​</mo><mi id="alg0.l7.m1.4.4.2.2.4" xref="alg0.l7.m1.4.4.2.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.4.4.2.2.2a" xref="alg0.l7.m1.4.4.2.2.2.cmml">​</mo><mi id="alg0.l7.m1.4.4.2.2.5" xref="alg0.l7.m1.4.4.2.2.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.4.4.2.2.2b" xref="alg0.l7.m1.4.4.2.2.2.cmml">​</mo><mi id="alg0.l7.m1.4.4.2.2.6" xref="alg0.l7.m1.4.4.2.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.4.4.2.2.2c" xref="alg0.l7.m1.4.4.2.2.2.cmml">​</mo><mi id="alg0.l7.m1.4.4.2.2.7" xref="alg0.l7.m1.4.4.2.2.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.4.4.2.2.2d" xref="alg0.l7.m1.4.4.2.2.2.cmml">​</mo><mi id="alg0.l7.m1.4.4.2.2.8" xref="alg0.l7.m1.4.4.2.2.8.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.4.4.2.2.2e" xref="alg0.l7.m1.4.4.2.2.2.cmml">​</mo><mi id="alg0.l7.m1.4.4.2.2.9" xref="alg0.l7.m1.4.4.2.2.9.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.4.4.2.2.2f" xref="alg0.l7.m1.4.4.2.2.2.cmml">​</mo><mrow id="alg0.l7.m1.4.4.2.2.1.1" xref="alg0.l7.m1.4.4.2.2.1.2.cmml"><mo stretchy="false" id="alg0.l7.m1.4.4.2.2.1.1.2" xref="alg0.l7.m1.4.4.2.2.1.2.cmml">(</mo><mn id="alg0.l7.m1.2.2" xref="alg0.l7.m1.2.2.cmml">0</mn><mo id="alg0.l7.m1.4.4.2.2.1.1.3" xref="alg0.l7.m1.4.4.2.2.1.2.cmml">,</mo><mrow id="alg0.l7.m1.4.4.2.2.1.1.1" xref="alg0.l7.m1.4.4.2.2.1.1.1.cmml"><mrow id="alg0.l7.m1.4.4.2.2.1.1.1.2" xref="alg0.l7.m1.4.4.2.2.1.1.1.2.cmml"><mn id="alg0.l7.m1.4.4.2.2.1.1.1.2.2" xref="alg0.l7.m1.4.4.2.2.1.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="alg0.l7.m1.4.4.2.2.1.1.1.2.1" xref="alg0.l7.m1.4.4.2.2.1.1.1.2.1.cmml">​</mo><mi id="alg0.l7.m1.4.4.2.2.1.1.1.2.3" xref="alg0.l7.m1.4.4.2.2.1.1.1.2.3.cmml">δ</mi></mrow><mo id="alg0.l7.m1.4.4.2.2.1.1.1.1" xref="alg0.l7.m1.4.4.2.2.1.1.1.1.cmml">/</mo><mi id="alg0.l7.m1.4.4.2.2.1.1.1.3" xref="alg0.l7.m1.4.4.2.2.1.1.1.3.cmml">ϵ</mi></mrow><mo stretchy="false" id="alg0.l7.m1.4.4.2.2.1.1.4" xref="alg0.l7.m1.4.4.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg0.l7.m1.4b"><apply id="alg0.l7.m1.4.4.cmml" xref="alg0.l7.m1.4.4"><ci id="alg0.l7.m1.4.4.3.cmml" xref="alg0.l7.m1.4.4.3">←</ci><apply id="alg0.l7.m1.4.4.4.cmml" xref="alg0.l7.m1.4.4.4"><csymbol cd="ambiguous" id="alg0.l7.m1.4.4.4.1.cmml" xref="alg0.l7.m1.4.4.4">subscript</csymbol><apply id="alg0.l7.m1.4.4.4.2.cmml" xref="alg0.l7.m1.4.4.4.2"><ci id="alg0.l7.m1.4.4.4.2.1.cmml" xref="alg0.l7.m1.4.4.4.2.1">^</ci><ci id="alg0.l7.m1.4.4.4.2.2.cmml" xref="alg0.l7.m1.4.4.4.2.2">𝐮</ci></apply><ci id="alg0.l7.m1.4.4.4.3.cmml" xref="alg0.l7.m1.4.4.4.3">𝑖</ci></apply><apply id="alg0.l7.m1.4.4.2.cmml" xref="alg0.l7.m1.4.4.2"><plus id="alg0.l7.m1.4.4.2.3.cmml" xref="alg0.l7.m1.4.4.2.3"></plus><apply id="alg0.l7.m1.3.3.1.1.cmml" xref="alg0.l7.m1.3.3.1.1"><times id="alg0.l7.m1.3.3.1.1.2.cmml" xref="alg0.l7.m1.3.3.1.1.2"></times><ci id="alg0.l7.m1.3.3.1.1.3.cmml" xref="alg0.l7.m1.3.3.1.1.3">𝑐</ci><ci id="alg0.l7.m1.3.3.1.1.4.cmml" xref="alg0.l7.m1.3.3.1.1.4">𝑙</ci><ci id="alg0.l7.m1.3.3.1.1.5.cmml" xref="alg0.l7.m1.3.3.1.1.5">𝑖</ci><ci id="alg0.l7.m1.3.3.1.1.6.cmml" xref="alg0.l7.m1.3.3.1.1.6">𝑝</ci><interval closure="open" id="alg0.l7.m1.3.3.1.1.1.2.cmml" xref="alg0.l7.m1.3.3.1.1.1.1"><apply id="alg0.l7.m1.3.3.1.1.1.1.1.cmml" xref="alg0.l7.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg0.l7.m1.3.3.1.1.1.1.1.1.cmml" xref="alg0.l7.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="alg0.l7.m1.3.3.1.1.1.1.1.2.cmml" xref="alg0.l7.m1.3.3.1.1.1.1.1.2">𝐮</ci><ci id="alg0.l7.m1.3.3.1.1.1.1.1.3.cmml" xref="alg0.l7.m1.3.3.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg0.l7.m1.1.1.cmml" xref="alg0.l7.m1.1.1">𝛿</ci></interval></apply><apply id="alg0.l7.m1.4.4.2.2.cmml" xref="alg0.l7.m1.4.4.2.2"><times id="alg0.l7.m1.4.4.2.2.2.cmml" xref="alg0.l7.m1.4.4.2.2.2"></times><ci id="alg0.l7.m1.4.4.2.2.3.cmml" xref="alg0.l7.m1.4.4.2.2.3">𝐿</ci><ci id="alg0.l7.m1.4.4.2.2.4.cmml" xref="alg0.l7.m1.4.4.2.2.4">𝑎</ci><ci id="alg0.l7.m1.4.4.2.2.5.cmml" xref="alg0.l7.m1.4.4.2.2.5">𝑝</ci><ci id="alg0.l7.m1.4.4.2.2.6.cmml" xref="alg0.l7.m1.4.4.2.2.6">𝑙</ci><ci id="alg0.l7.m1.4.4.2.2.7.cmml" xref="alg0.l7.m1.4.4.2.2.7">𝑎</ci><ci id="alg0.l7.m1.4.4.2.2.8.cmml" xref="alg0.l7.m1.4.4.2.2.8">𝑐</ci><ci id="alg0.l7.m1.4.4.2.2.9.cmml" xref="alg0.l7.m1.4.4.2.2.9">𝑒</ci><interval closure="open" id="alg0.l7.m1.4.4.2.2.1.2.cmml" xref="alg0.l7.m1.4.4.2.2.1.1"><cn type="integer" id="alg0.l7.m1.2.2.cmml" xref="alg0.l7.m1.2.2">0</cn><apply id="alg0.l7.m1.4.4.2.2.1.1.1.cmml" xref="alg0.l7.m1.4.4.2.2.1.1.1"><divide id="alg0.l7.m1.4.4.2.2.1.1.1.1.cmml" xref="alg0.l7.m1.4.4.2.2.1.1.1.1"></divide><apply id="alg0.l7.m1.4.4.2.2.1.1.1.2.cmml" xref="alg0.l7.m1.4.4.2.2.1.1.1.2"><times id="alg0.l7.m1.4.4.2.2.1.1.1.2.1.cmml" xref="alg0.l7.m1.4.4.2.2.1.1.1.2.1"></times><cn type="integer" id="alg0.l7.m1.4.4.2.2.1.1.1.2.2.cmml" xref="alg0.l7.m1.4.4.2.2.1.1.1.2.2">2</cn><ci id="alg0.l7.m1.4.4.2.2.1.1.1.2.3.cmml" xref="alg0.l7.m1.4.4.2.2.1.1.1.2.3">𝛿</ci></apply><ci id="alg0.l7.m1.4.4.2.2.1.1.1.3.cmml" xref="alg0.l7.m1.4.4.2.2.1.1.1.3">italic-ϵ</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l7.m1.4c">\mathbf{\hat{u}}_{i}\leftarrow clip(\mathbf{u}_{i},\delta)+Laplace(0,2\delta/\epsilon)</annotation></semantics></math>

</div>
<div id="alg0.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>        Upload <math id="alg0.l8.m1.1" class="ltx_Math" alttext="\mathbf{\hat{u}}_{i}" display="inline"><semantics id="alg0.l8.m1.1a"><msub id="alg0.l8.m1.1.1" xref="alg0.l8.m1.1.1.cmml"><mover accent="true" id="alg0.l8.m1.1.1.2" xref="alg0.l8.m1.1.1.2.cmml"><mi id="alg0.l8.m1.1.1.2.2" xref="alg0.l8.m1.1.1.2.2.cmml">𝐮</mi><mo id="alg0.l8.m1.1.1.2.1" xref="alg0.l8.m1.1.1.2.1.cmml">^</mo></mover><mi id="alg0.l8.m1.1.1.3" xref="alg0.l8.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg0.l8.m1.1b"><apply id="alg0.l8.m1.1.1.cmml" xref="alg0.l8.m1.1.1"><csymbol cd="ambiguous" id="alg0.l8.m1.1.1.1.cmml" xref="alg0.l8.m1.1.1">subscript</csymbol><apply id="alg0.l8.m1.1.1.2.cmml" xref="alg0.l8.m1.1.1.2"><ci id="alg0.l8.m1.1.1.2.1.cmml" xref="alg0.l8.m1.1.1.2.1">^</ci><ci id="alg0.l8.m1.1.1.2.2.cmml" xref="alg0.l8.m1.1.1.2.2">𝐮</ci></apply><ci id="alg0.l8.m1.1.1.3.cmml" xref="alg0.l8.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l8.m1.1c">\mathbf{\hat{u}}_{i}</annotation></semantics></math> to the server

</div>
<div id="alg0.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     <span id="alg0.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg0.l9.3" class="ltx_text ltx_font_bold">for</span>// Federated negative sampling
</div>
<div id="alg0.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     Server clusters collected user embeddings

</div>
<div id="alg0.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <span id="alg0.l11.2" class="ltx_text ltx_font_bold">for</span> each user <math id="alg0.l11.m1.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="alg0.l11.m1.1a"><msub id="alg0.l11.m1.1.1" xref="alg0.l11.m1.1.1.cmml"><mi id="alg0.l11.m1.1.1.2" xref="alg0.l11.m1.1.1.2.cmml">u</mi><mi id="alg0.l11.m1.1.1.3" xref="alg0.l11.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg0.l11.m1.1b"><apply id="alg0.l11.m1.1.1.cmml" xref="alg0.l11.m1.1.1"><csymbol cd="ambiguous" id="alg0.l11.m1.1.1.1.cmml" xref="alg0.l11.m1.1.1">subscript</csymbol><ci id="alg0.l11.m1.1.1.2.cmml" xref="alg0.l11.m1.1.1.2">𝑢</ci><ci id="alg0.l11.m1.1.1.3.cmml" xref="alg0.l11.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l11.m1.1c">u_{i}</annotation></semantics></math> <math id="alg0.l11.m2.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg0.l11.m2.1a"><mo id="alg0.l11.m2.1.1" xref="alg0.l11.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg0.l11.m2.1b"><in id="alg0.l11.m2.1.1.cmml" xref="alg0.l11.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg0.l11.m2.1c">\in</annotation></semantics></math> <math id="alg0.l11.m3.1" class="ltx_Math" alttext="\mathcal{U}^{\prime}" display="inline"><semantics id="alg0.l11.m3.1a"><msup id="alg0.l11.m3.1.1" xref="alg0.l11.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg0.l11.m3.1.1.2" xref="alg0.l11.m3.1.1.2.cmml">𝒰</mi><mo id="alg0.l11.m3.1.1.3" xref="alg0.l11.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg0.l11.m3.1b"><apply id="alg0.l11.m3.1.1.cmml" xref="alg0.l11.m3.1.1"><csymbol cd="ambiguous" id="alg0.l11.m3.1.1.1.cmml" xref="alg0.l11.m3.1.1">superscript</csymbol><ci id="alg0.l11.m3.1.1.2.cmml" xref="alg0.l11.m3.1.1.2">𝒰</ci><ci id="alg0.l11.m3.1.1.3.cmml" xref="alg0.l11.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l11.m3.1c">\mathcal{U}^{\prime}</annotation></semantics></math> <span id="alg0.l11.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg0.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>        Retrieve semi-hard negatives from the item pool using the cluster centroid <math id="alg0.l12.m1.1" class="ltx_Math" alttext="\mathbf{c}_{i}" display="inline"><semantics id="alg0.l12.m1.1a"><msub id="alg0.l12.m1.1.1" xref="alg0.l12.m1.1.1.cmml"><mi id="alg0.l12.m1.1.1.2" xref="alg0.l12.m1.1.1.2.cmml">𝐜</mi><mi id="alg0.l12.m1.1.1.3" xref="alg0.l12.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg0.l12.m1.1b"><apply id="alg0.l12.m1.1.1.cmml" xref="alg0.l12.m1.1.1"><csymbol cd="ambiguous" id="alg0.l12.m1.1.1.1.cmml" xref="alg0.l12.m1.1.1">subscript</csymbol><ci id="alg0.l12.m1.1.1.2.cmml" xref="alg0.l12.m1.1.1.2">𝐜</ci><ci id="alg0.l12.m1.1.1.3.cmml" xref="alg0.l12.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l12.m1.1c">\mathbf{c}_{i}</annotation></semantics></math>

</div>
<div id="alg0.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>        Send negative items to the client <math id="alg0.l13.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg0.l13.m1.1a"><mi id="alg0.l13.m1.1.1" xref="alg0.l13.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg0.l13.m1.1b"><ci id="alg0.l13.m1.1.1.cmml" xref="alg0.l13.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg0.l13.m1.1c">i</annotation></semantics></math>

</div>
<div id="alg0.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     <span id="alg0.l14.2" class="ltx_text ltx_font_bold">end</span> <span id="alg0.l14.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg0.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>     Distribute <math id="alg0.l15.m1.1" class="ltx_Math" alttext="\mathbf{g}" display="inline"><semantics id="alg0.l15.m1.1a"><mi id="alg0.l15.m1.1.1" xref="alg0.l15.m1.1.1.cmml">𝐠</mi><annotation-xml encoding="MathML-Content" id="alg0.l15.m1.1b"><ci id="alg0.l15.m1.1.1.cmml" xref="alg0.l15.m1.1.1">𝐠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg0.l15.m1.1c">\mathbf{g}</annotation></semantics></math> to user clients for local update
// Federated Model Learning
</div>
<div id="alg0.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>     <span id="alg0.l16.2" class="ltx_text ltx_font_bold">for</span> each user <math id="alg0.l16.m1.1" class="ltx_Math" alttext="u_{i}" display="inline"><semantics id="alg0.l16.m1.1a"><msub id="alg0.l16.m1.1.1" xref="alg0.l16.m1.1.1.cmml"><mi id="alg0.l16.m1.1.1.2" xref="alg0.l16.m1.1.1.2.cmml">u</mi><mi id="alg0.l16.m1.1.1.3" xref="alg0.l16.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg0.l16.m1.1b"><apply id="alg0.l16.m1.1.1.cmml" xref="alg0.l16.m1.1.1"><csymbol cd="ambiguous" id="alg0.l16.m1.1.1.1.cmml" xref="alg0.l16.m1.1.1">subscript</csymbol><ci id="alg0.l16.m1.1.1.2.cmml" xref="alg0.l16.m1.1.1.2">𝑢</ci><ci id="alg0.l16.m1.1.1.3.cmml" xref="alg0.l16.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l16.m1.1c">u_{i}</annotation></semantics></math> <math id="alg0.l16.m2.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg0.l16.m2.1a"><mo id="alg0.l16.m2.1.1" xref="alg0.l16.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg0.l16.m2.1b"><in id="alg0.l16.m2.1.1.cmml" xref="alg0.l16.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg0.l16.m2.1c">\in</annotation></semantics></math> <math id="alg0.l16.m3.1" class="ltx_Math" alttext="\mathcal{U}^{\prime}" display="inline"><semantics id="alg0.l16.m3.1a"><msup id="alg0.l16.m3.1.1" xref="alg0.l16.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg0.l16.m3.1.1.2" xref="alg0.l16.m3.1.1.2.cmml">𝒰</mi><mo id="alg0.l16.m3.1.1.3" xref="alg0.l16.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg0.l16.m3.1b"><apply id="alg0.l16.m3.1.1.cmml" xref="alg0.l16.m3.1.1"><csymbol cd="ambiguous" id="alg0.l16.m3.1.1.1.cmml" xref="alg0.l16.m3.1.1">superscript</csymbol><ci id="alg0.l16.m3.1.1.2.cmml" xref="alg0.l16.m3.1.1.2">𝒰</ci><ci id="alg0.l16.m3.1.1.3.cmml" xref="alg0.l16.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l16.m3.1c">\mathcal{U}^{\prime}</annotation></semantics></math> in parallel <span id="alg0.l16.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg0.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>        Mix semi-hard, in-batch and local negatives

</div>
<div id="alg0.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>        Compute local loss <math id="alg0.l18.m1.1" class="ltx_Math" alttext="\mathcal{L}_{i}" display="inline"><semantics id="alg0.l18.m1.1a"><msub id="alg0.l18.m1.1.1" xref="alg0.l18.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg0.l18.m1.1.1.2" xref="alg0.l18.m1.1.1.2.cmml">ℒ</mi><mi id="alg0.l18.m1.1.1.3" xref="alg0.l18.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg0.l18.m1.1b"><apply id="alg0.l18.m1.1.1.cmml" xref="alg0.l18.m1.1.1"><csymbol cd="ambiguous" id="alg0.l18.m1.1.1.1.cmml" xref="alg0.l18.m1.1.1">subscript</csymbol><ci id="alg0.l18.m1.1.1.2.cmml" xref="alg0.l18.m1.1.1.2">ℒ</ci><ci id="alg0.l18.m1.1.1.3.cmml" xref="alg0.l18.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l18.m1.1c">\mathcal{L}_{i}</annotation></semantics></math> on local training samples

</div>
<div id="alg0.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>        Compute local model update <math id="alg0.l19.m1.1" class="ltx_Math" alttext="\mathbf{g}_{i}" display="inline"><semantics id="alg0.l19.m1.1a"><msub id="alg0.l19.m1.1.1" xref="alg0.l19.m1.1.1.cmml"><mi id="alg0.l19.m1.1.1.2" xref="alg0.l19.m1.1.1.2.cmml">𝐠</mi><mi id="alg0.l19.m1.1.1.3" xref="alg0.l19.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg0.l19.m1.1b"><apply id="alg0.l19.m1.1.1.cmml" xref="alg0.l19.m1.1.1"><csymbol cd="ambiguous" id="alg0.l19.m1.1.1.1.cmml" xref="alg0.l19.m1.1.1">subscript</csymbol><ci id="alg0.l19.m1.1.1.2.cmml" xref="alg0.l19.m1.1.1.2">𝐠</ci><ci id="alg0.l19.m1.1.1.3.cmml" xref="alg0.l19.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l19.m1.1c">\mathbf{g}_{i}</annotation></semantics></math>

</div>
<div id="alg0.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>        Securely upload <math id="alg0.l20.m1.1" class="ltx_Math" alttext="\mathbf{g}_{i}" display="inline"><semantics id="alg0.l20.m1.1a"><msub id="alg0.l20.m1.1.1" xref="alg0.l20.m1.1.1.cmml"><mi id="alg0.l20.m1.1.1.2" xref="alg0.l20.m1.1.1.2.cmml">𝐠</mi><mi id="alg0.l20.m1.1.1.3" xref="alg0.l20.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg0.l20.m1.1b"><apply id="alg0.l20.m1.1.1.cmml" xref="alg0.l20.m1.1.1"><csymbol cd="ambiguous" id="alg0.l20.m1.1.1.1.cmml" xref="alg0.l20.m1.1.1">subscript</csymbol><ci id="alg0.l20.m1.1.1.2.cmml" xref="alg0.l20.m1.1.1.2">𝐠</ci><ci id="alg0.l20.m1.1.1.3.cmml" xref="alg0.l20.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l20.m1.1c">\mathbf{g}_{i}</annotation></semantics></math> to the server

</div>
<div id="alg0.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>     <span id="alg0.l21.2" class="ltx_text ltx_font_bold">end</span> <span id="alg0.l21.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg0.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l22.1.1.1" class="ltx_text" style="font-size:80%;">22:</span></span>     Server aggregates local model updates

</div>
<div id="alg0.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l23.1.1.1" class="ltx_text" style="font-size:80%;">23:</span></span>     Update global model and distribute it to clients

</div>
<div id="alg0.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l24.1.1.1" class="ltx_text" style="font-size:80%;">24:</span></span>  <span id="alg0.l24.2" class="ltx_text ltx_font_bold">until</span> model convergence

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.3.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FedCL</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Negative Mix-up for Contrastive Training</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.11" class="ltx_p">Next, we introduce the proposed negative mix-up method for local contrastive model learning.
Motivated by the in-batch negative sampling in prior work <cite class="ltx_cite ltx_citemacro_cite">Yi <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite>, we propose to incorporate in-batch negatives by regarding the local positive items as a mini-batch, where the samples within this batch can be used as negatives for each other.
We denote the local positive samples on the client <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">i</annotation></semantics></math> as <math id="S3.SS2.p1.2.m2.4" class="ltx_Math" alttext="[p_{1}^{i},p_{2}^{i},...,p_{P}^{i}]" display="inline"><semantics id="S3.SS2.p1.2.m2.4a"><mrow id="S3.SS2.p1.2.m2.4.4.3" xref="S3.SS2.p1.2.m2.4.4.4.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.4.4.3.4" xref="S3.SS2.p1.2.m2.4.4.4.cmml">[</mo><msubsup id="S3.SS2.p1.2.m2.2.2.1.1" xref="S3.SS2.p1.2.m2.2.2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.2.2.1.1.2.2" xref="S3.SS2.p1.2.m2.2.2.1.1.2.2.cmml">p</mi><mn id="S3.SS2.p1.2.m2.2.2.1.1.2.3" xref="S3.SS2.p1.2.m2.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS2.p1.2.m2.2.2.1.1.3" xref="S3.SS2.p1.2.m2.2.2.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS2.p1.2.m2.4.4.3.5" xref="S3.SS2.p1.2.m2.4.4.4.cmml">,</mo><msubsup id="S3.SS2.p1.2.m2.3.3.2.2" xref="S3.SS2.p1.2.m2.3.3.2.2.cmml"><mi id="S3.SS2.p1.2.m2.3.3.2.2.2.2" xref="S3.SS2.p1.2.m2.3.3.2.2.2.2.cmml">p</mi><mn id="S3.SS2.p1.2.m2.3.3.2.2.2.3" xref="S3.SS2.p1.2.m2.3.3.2.2.2.3.cmml">2</mn><mi id="S3.SS2.p1.2.m2.3.3.2.2.3" xref="S3.SS2.p1.2.m2.3.3.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS2.p1.2.m2.4.4.3.6" xref="S3.SS2.p1.2.m2.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS2.p1.2.m2.4.4.3.7" xref="S3.SS2.p1.2.m2.4.4.4.cmml">,</mo><msubsup id="S3.SS2.p1.2.m2.4.4.3.3" xref="S3.SS2.p1.2.m2.4.4.3.3.cmml"><mi id="S3.SS2.p1.2.m2.4.4.3.3.2.2" xref="S3.SS2.p1.2.m2.4.4.3.3.2.2.cmml">p</mi><mi id="S3.SS2.p1.2.m2.4.4.3.3.2.3" xref="S3.SS2.p1.2.m2.4.4.3.3.2.3.cmml">P</mi><mi id="S3.SS2.p1.2.m2.4.4.3.3.3" xref="S3.SS2.p1.2.m2.4.4.3.3.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.2.m2.4.4.3.8" xref="S3.SS2.p1.2.m2.4.4.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.4b"><list id="S3.SS2.p1.2.m2.4.4.4.cmml" xref="S3.SS2.p1.2.m2.4.4.3"><apply id="S3.SS2.p1.2.m2.2.2.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1">superscript</csymbol><apply id="S3.SS2.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.2.2">𝑝</ci><cn type="integer" id="S3.SS2.p1.2.m2.2.2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS2.p1.2.m2.2.2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p1.2.m2.3.3.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2">superscript</csymbol><apply id="S3.SS2.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2.2">𝑝</ci><cn type="integer" id="S3.SS2.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">…</ci><apply id="S3.SS2.p1.2.m2.4.4.3.3.cmml" xref="S3.SS2.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.4.4.3.3.1.cmml" xref="S3.SS2.p1.2.m2.4.4.3.3">superscript</csymbol><apply id="S3.SS2.p1.2.m2.4.4.3.3.2.cmml" xref="S3.SS2.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.4.4.3.3.2.1.cmml" xref="S3.SS2.p1.2.m2.4.4.3.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.4.4.3.3.2.2.cmml" xref="S3.SS2.p1.2.m2.4.4.3.3.2.2">𝑝</ci><ci id="S3.SS2.p1.2.m2.4.4.3.3.2.3.cmml" xref="S3.SS2.p1.2.m2.4.4.3.3.2.3">𝑃</ci></apply><ci id="S3.SS2.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS2.p1.2.m2.4.4.3.3.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.4c">[p_{1}^{i},p_{2}^{i},...,p_{P}^{i}]</annotation></semantics></math>.
For the positive item <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="p_{j}^{i}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msubsup id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">p</mi><mi id="S3.SS2.p1.3.m3.1.1.2.3" xref="S3.SS2.p1.3.m3.1.1.2.3.cmml">j</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">superscript</csymbol><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">𝑝</ci><ci id="S3.SS2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3">𝑗</ci></apply><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">p_{j}^{i}</annotation></semantics></math>, its corresponding in-batch negatives are <math id="S3.SS2.p1.4.m4.5" class="ltx_Math" alttext="[p_{1}^{i},...,p_{j-1}^{i},p_{j+1}...,p_{P}^{i}]" display="inline"><semantics id="S3.SS2.p1.4.m4.5a"><mrow id="S3.SS2.p1.4.m4.5.5.4" xref="S3.SS2.p1.4.m4.5.5.5.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m4.5.5.4.5" xref="S3.SS2.p1.4.m4.5.5.5.cmml">[</mo><msubsup id="S3.SS2.p1.4.m4.2.2.1.1" xref="S3.SS2.p1.4.m4.2.2.1.1.cmml"><mi id="S3.SS2.p1.4.m4.2.2.1.1.2.2" xref="S3.SS2.p1.4.m4.2.2.1.1.2.2.cmml">p</mi><mn id="S3.SS2.p1.4.m4.2.2.1.1.2.3" xref="S3.SS2.p1.4.m4.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS2.p1.4.m4.2.2.1.1.3" xref="S3.SS2.p1.4.m4.2.2.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS2.p1.4.m4.5.5.4.6" xref="S3.SS2.p1.4.m4.5.5.5.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">…</mi><mo id="S3.SS2.p1.4.m4.5.5.4.7" xref="S3.SS2.p1.4.m4.5.5.5.cmml">,</mo><msubsup id="S3.SS2.p1.4.m4.3.3.2.2" xref="S3.SS2.p1.4.m4.3.3.2.2.cmml"><mi id="S3.SS2.p1.4.m4.3.3.2.2.2.2" xref="S3.SS2.p1.4.m4.3.3.2.2.2.2.cmml">p</mi><mrow id="S3.SS2.p1.4.m4.3.3.2.2.2.3" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.cmml"><mi id="S3.SS2.p1.4.m4.3.3.2.2.2.3.2" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.2.cmml">j</mi><mo id="S3.SS2.p1.4.m4.3.3.2.2.2.3.1" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.1.cmml">−</mo><mn id="S3.SS2.p1.4.m4.3.3.2.2.2.3.3" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p1.4.m4.3.3.2.2.3" xref="S3.SS2.p1.4.m4.3.3.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS2.p1.4.m4.5.5.4.8" xref="S3.SS2.p1.4.m4.5.5.5.cmml">,</mo><mrow id="S3.SS2.p1.4.m4.4.4.3.3" xref="S3.SS2.p1.4.m4.4.4.3.3.cmml"><msub id="S3.SS2.p1.4.m4.4.4.3.3.2" xref="S3.SS2.p1.4.m4.4.4.3.3.2.cmml"><mi id="S3.SS2.p1.4.m4.4.4.3.3.2.2" xref="S3.SS2.p1.4.m4.4.4.3.3.2.2.cmml">p</mi><mrow id="S3.SS2.p1.4.m4.4.4.3.3.2.3" xref="S3.SS2.p1.4.m4.4.4.3.3.2.3.cmml"><mi id="S3.SS2.p1.4.m4.4.4.3.3.2.3.2" xref="S3.SS2.p1.4.m4.4.4.3.3.2.3.2.cmml">j</mi><mo id="S3.SS2.p1.4.m4.4.4.3.3.2.3.1" xref="S3.SS2.p1.4.m4.4.4.3.3.2.3.1.cmml">+</mo><mn id="S3.SS2.p1.4.m4.4.4.3.3.2.3.3" xref="S3.SS2.p1.4.m4.4.4.3.3.2.3.3.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m4.4.4.3.3.1" xref="S3.SS2.p1.4.m4.4.4.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS2.p1.4.m4.4.4.3.3.3" xref="S3.SS2.p1.4.m4.4.4.3.3.3.cmml">…</mi></mrow><mo id="S3.SS2.p1.4.m4.5.5.4.9" xref="S3.SS2.p1.4.m4.5.5.5.cmml">,</mo><msubsup id="S3.SS2.p1.4.m4.5.5.4.4" xref="S3.SS2.p1.4.m4.5.5.4.4.cmml"><mi id="S3.SS2.p1.4.m4.5.5.4.4.2.2" xref="S3.SS2.p1.4.m4.5.5.4.4.2.2.cmml">p</mi><mi id="S3.SS2.p1.4.m4.5.5.4.4.2.3" xref="S3.SS2.p1.4.m4.5.5.4.4.2.3.cmml">P</mi><mi id="S3.SS2.p1.4.m4.5.5.4.4.3" xref="S3.SS2.p1.4.m4.5.5.4.4.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.4.m4.5.5.4.10" xref="S3.SS2.p1.4.m4.5.5.5.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.5b"><list id="S3.SS2.p1.4.m4.5.5.5.cmml" xref="S3.SS2.p1.4.m4.5.5.4"><apply id="S3.SS2.p1.4.m4.2.2.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1">superscript</csymbol><apply id="S3.SS2.p1.4.m4.2.2.1.1.2.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.2.2.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.2.2">𝑝</ci><cn type="integer" id="S3.SS2.p1.4.m4.2.2.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS2.p1.4.m4.2.2.1.1.3.cmml" xref="S3.SS2.p1.4.m4.2.2.1.1.3">𝑖</ci></apply><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">…</ci><apply id="S3.SS2.p1.4.m4.3.3.2.2.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.2.2.1.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2">superscript</csymbol><apply id="S3.SS2.p1.4.m4.3.3.2.2.2.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.2">𝑝</ci><apply id="S3.SS2.p1.4.m4.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3"><minus id="S3.SS2.p1.4.m4.3.3.2.2.2.3.1.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.1"></minus><ci id="S3.SS2.p1.4.m4.3.3.2.2.2.3.2.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.2">𝑗</ci><cn type="integer" id="S3.SS2.p1.4.m4.3.3.2.2.2.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p1.4.m4.3.3.2.2.3.cmml" xref="S3.SS2.p1.4.m4.3.3.2.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.4.m4.4.4.3.3.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3"><times id="S3.SS2.p1.4.m4.4.4.3.3.1.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.1"></times><apply id="S3.SS2.p1.4.m4.4.4.3.3.2.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.4.4.3.3.2.1.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.2">subscript</csymbol><ci id="S3.SS2.p1.4.m4.4.4.3.3.2.2.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.2.2">𝑝</ci><apply id="S3.SS2.p1.4.m4.4.4.3.3.2.3.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.2.3"><plus id="S3.SS2.p1.4.m4.4.4.3.3.2.3.1.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.2.3.1"></plus><ci id="S3.SS2.p1.4.m4.4.4.3.3.2.3.2.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.2.3.2">𝑗</ci><cn type="integer" id="S3.SS2.p1.4.m4.4.4.3.3.2.3.3.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p1.4.m4.4.4.3.3.3.cmml" xref="S3.SS2.p1.4.m4.4.4.3.3.3">…</ci></apply><apply id="S3.SS2.p1.4.m4.5.5.4.4.cmml" xref="S3.SS2.p1.4.m4.5.5.4.4"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.5.5.4.4.1.cmml" xref="S3.SS2.p1.4.m4.5.5.4.4">superscript</csymbol><apply id="S3.SS2.p1.4.m4.5.5.4.4.2.cmml" xref="S3.SS2.p1.4.m4.5.5.4.4"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.5.5.4.4.2.1.cmml" xref="S3.SS2.p1.4.m4.5.5.4.4">subscript</csymbol><ci id="S3.SS2.p1.4.m4.5.5.4.4.2.2.cmml" xref="S3.SS2.p1.4.m4.5.5.4.4.2.2">𝑝</ci><ci id="S3.SS2.p1.4.m4.5.5.4.4.2.3.cmml" xref="S3.SS2.p1.4.m4.5.5.4.4.2.3">𝑃</ci></apply><ci id="S3.SS2.p1.4.m4.5.5.4.4.3.cmml" xref="S3.SS2.p1.4.m4.5.5.4.4.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.5c">[p_{1}^{i},...,p_{j-1}^{i},p_{j+1}...,p_{P}^{i}]</annotation></semantics></math>.
Note that this kind of in-batch negative samples cannot be used for training ID-based user modeling methods because they cannot learn different user embeddings based on the item interaction histories.
In addition, in real-world scenarios there can be a small number of negative items stored on user devices or randomly distributed by the server.
To help our approach be compatible with this setting, we also incorporate the local negative items into model training, which are denoted as <math id="S3.SS2.p1.5.m5.4" class="ltx_Math" alttext="[n_{1}^{i},n_{2}^{i},...,n_{K}^{i}]" display="inline"><semantics id="S3.SS2.p1.5.m5.4a"><mrow id="S3.SS2.p1.5.m5.4.4.3" xref="S3.SS2.p1.5.m5.4.4.4.cmml"><mo stretchy="false" id="S3.SS2.p1.5.m5.4.4.3.4" xref="S3.SS2.p1.5.m5.4.4.4.cmml">[</mo><msubsup id="S3.SS2.p1.5.m5.2.2.1.1" xref="S3.SS2.p1.5.m5.2.2.1.1.cmml"><mi id="S3.SS2.p1.5.m5.2.2.1.1.2.2" xref="S3.SS2.p1.5.m5.2.2.1.1.2.2.cmml">n</mi><mn id="S3.SS2.p1.5.m5.2.2.1.1.2.3" xref="S3.SS2.p1.5.m5.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS2.p1.5.m5.2.2.1.1.3" xref="S3.SS2.p1.5.m5.2.2.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS2.p1.5.m5.4.4.3.5" xref="S3.SS2.p1.5.m5.4.4.4.cmml">,</mo><msubsup id="S3.SS2.p1.5.m5.3.3.2.2" xref="S3.SS2.p1.5.m5.3.3.2.2.cmml"><mi id="S3.SS2.p1.5.m5.3.3.2.2.2.2" xref="S3.SS2.p1.5.m5.3.3.2.2.2.2.cmml">n</mi><mn id="S3.SS2.p1.5.m5.3.3.2.2.2.3" xref="S3.SS2.p1.5.m5.3.3.2.2.2.3.cmml">2</mn><mi id="S3.SS2.p1.5.m5.3.3.2.2.3" xref="S3.SS2.p1.5.m5.3.3.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS2.p1.5.m5.4.4.3.6" xref="S3.SS2.p1.5.m5.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">…</mi><mo id="S3.SS2.p1.5.m5.4.4.3.7" xref="S3.SS2.p1.5.m5.4.4.4.cmml">,</mo><msubsup id="S3.SS2.p1.5.m5.4.4.3.3" xref="S3.SS2.p1.5.m5.4.4.3.3.cmml"><mi id="S3.SS2.p1.5.m5.4.4.3.3.2.2" xref="S3.SS2.p1.5.m5.4.4.3.3.2.2.cmml">n</mi><mi id="S3.SS2.p1.5.m5.4.4.3.3.2.3" xref="S3.SS2.p1.5.m5.4.4.3.3.2.3.cmml">K</mi><mi id="S3.SS2.p1.5.m5.4.4.3.3.3" xref="S3.SS2.p1.5.m5.4.4.3.3.3.cmml">i</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.5.m5.4.4.3.8" xref="S3.SS2.p1.5.m5.4.4.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.4b"><list id="S3.SS2.p1.5.m5.4.4.4.cmml" xref="S3.SS2.p1.5.m5.4.4.3"><apply id="S3.SS2.p1.5.m5.2.2.1.1.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1">superscript</csymbol><apply id="S3.SS2.p1.5.m5.2.2.1.1.2.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.2.2.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.2.2.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1.2.2">𝑛</ci><cn type="integer" id="S3.SS2.p1.5.m5.2.2.1.1.2.3.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS2.p1.5.m5.2.2.1.1.3.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p1.5.m5.3.3.2.2.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.3.3.2.2.1.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2">superscript</csymbol><apply id="S3.SS2.p1.5.m5.3.3.2.2.2.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2.2.2">𝑛</ci><cn type="integer" id="S3.SS2.p1.5.m5.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.5.m5.3.3.2.2.3.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">…</ci><apply id="S3.SS2.p1.5.m5.4.4.3.3.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.4.4.3.3.1.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3">superscript</csymbol><apply id="S3.SS2.p1.5.m5.4.4.3.3.2.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.4.4.3.3.2.1.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3">subscript</csymbol><ci id="S3.SS2.p1.5.m5.4.4.3.3.2.2.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3.2.2">𝑛</ci><ci id="S3.SS2.p1.5.m5.4.4.3.3.2.3.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3.2.3">𝐾</ci></apply><ci id="S3.SS2.p1.5.m5.4.4.3.3.3.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.4c">[n_{1}^{i},n_{2}^{i},...,n_{K}^{i}]</annotation></semantics></math>.
Given each positive item <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="p_{j}^{i}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msubsup id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2.2" xref="S3.SS2.p1.6.m6.1.1.2.2.cmml">p</mi><mi id="S3.SS2.p1.6.m6.1.1.2.3" xref="S3.SS2.p1.6.m6.1.1.2.3.cmml">j</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">superscript</csymbol><apply id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2.2">𝑝</ci><ci id="S3.SS2.p1.6.m6.1.1.2.3.cmml" xref="S3.SS2.p1.6.m6.1.1.2.3">𝑗</ci></apply><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">p_{j}^{i}</annotation></semantics></math>, we mix up the in-batch negatives, local negatives, and semi-hard negatives into a unified list of negative samples, and we denote the list of their embeddings as <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{N}_{j}^{i}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><msubsup id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m7.1.1.2.2" xref="S3.SS2.p1.7.m7.1.1.2.2.cmml">𝒩</mi><mi id="S3.SS2.p1.7.m7.1.1.2.3" xref="S3.SS2.p1.7.m7.1.1.2.3.cmml">j</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">superscript</csymbol><apply id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.2.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2.2">𝒩</ci><ci id="S3.SS2.p1.7.m7.1.1.2.3.cmml" xref="S3.SS2.p1.7.m7.1.1.2.3">𝑗</ci></apply><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\mathcal{N}_{j}^{i}</annotation></semantics></math>.
The embedding of the positive item <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="p_{j}^{i}" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><msubsup id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1.2.2" xref="S3.SS2.p1.8.m8.1.1.2.2.cmml">p</mi><mi id="S3.SS2.p1.8.m8.1.1.2.3" xref="S3.SS2.p1.8.m8.1.1.2.3.cmml">j</mi><mi id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">superscript</csymbol><apply id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.2.1.cmml" xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2.2">𝑝</ci><ci id="S3.SS2.p1.8.m8.1.1.2.3.cmml" xref="S3.SS2.p1.8.m8.1.1.2.3">𝑗</ci></apply><ci id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">p_{j}^{i}</annotation></semantics></math> is denoted as <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{p}_{j}^{i}" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><msubsup id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><mi id="S3.SS2.p1.9.m9.1.1.2.2" xref="S3.SS2.p1.9.m9.1.1.2.2.cmml">𝐩</mi><mi id="S3.SS2.p1.9.m9.1.1.2.3" xref="S3.SS2.p1.9.m9.1.1.2.3.cmml">j</mi><mi id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">superscript</csymbol><apply id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2.2">𝐩</ci><ci id="S3.SS2.p1.9.m9.1.1.2.3.cmml" xref="S3.SS2.p1.9.m9.1.1.2.3">𝑗</ci></apply><ci id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\mathbf{p}_{j}^{i}</annotation></semantics></math>
The local contrastive training loss function <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{L}_{i}" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><msub id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.10.m10.1.1.2" xref="S3.SS2.p1.10.m10.1.1.2.cmml">ℒ</mi><mi id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2">ℒ</ci><ci id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">\mathcal{L}_{i}</annotation></semantics></math> of the <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><mi id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><ci id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">i</annotation></semantics></math>-th client is formulated as follows:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.8" class="ltx_Math" alttext="\mathcal{L}_{i}=-\sum_{j=1}^{P}\log(\frac{\exp(\mathbf{u}^{i}_{j}\cdot\mathbf{p}_{j}^{i})}{\exp(\mathbf{u}^{i}_{j}\cdot\mathbf{p}_{j}^{i})+\sum_{\mathbf{n}\in\mathcal{N}_{j}^{i}}\exp(\mathbf{u}^{i}_{j}\cdot\mathbf{n})})," display="block"><semantics id="S3.E1.m1.8a"><mrow id="S3.E1.m1.8.8.1" xref="S3.E1.m1.8.8.1.1.cmml"><mrow id="S3.E1.m1.8.8.1.1" xref="S3.E1.m1.8.8.1.1.cmml"><msub id="S3.E1.m1.8.8.1.1.2" xref="S3.E1.m1.8.8.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.8.8.1.1.2.2" xref="S3.E1.m1.8.8.1.1.2.2.cmml">ℒ</mi><mi id="S3.E1.m1.8.8.1.1.2.3" xref="S3.E1.m1.8.8.1.1.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.8.8.1.1.1" xref="S3.E1.m1.8.8.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.8.8.1.1.3" xref="S3.E1.m1.8.8.1.1.3.cmml"><mo id="S3.E1.m1.8.8.1.1.3a" xref="S3.E1.m1.8.8.1.1.3.cmml">−</mo><mrow id="S3.E1.m1.8.8.1.1.3.2" xref="S3.E1.m1.8.8.1.1.3.2.cmml"><munderover id="S3.E1.m1.8.8.1.1.3.2.1" xref="S3.E1.m1.8.8.1.1.3.2.1.cmml"><mo movablelimits="false" id="S3.E1.m1.8.8.1.1.3.2.1.2.2" xref="S3.E1.m1.8.8.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.8.8.1.1.3.2.1.2.3" xref="S3.E1.m1.8.8.1.1.3.2.1.2.3.cmml"><mi id="S3.E1.m1.8.8.1.1.3.2.1.2.3.2" xref="S3.E1.m1.8.8.1.1.3.2.1.2.3.2.cmml">j</mi><mo id="S3.E1.m1.8.8.1.1.3.2.1.2.3.1" xref="S3.E1.m1.8.8.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.8.8.1.1.3.2.1.2.3.3" xref="S3.E1.m1.8.8.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.8.8.1.1.3.2.1.3" xref="S3.E1.m1.8.8.1.1.3.2.1.3.cmml">P</mi></munderover><mrow id="S3.E1.m1.8.8.1.1.3.2.2.2" xref="S3.E1.m1.8.8.1.1.3.2.2.1.cmml"><mi id="S3.E1.m1.7.7" xref="S3.E1.m1.7.7.cmml">log</mi><mo id="S3.E1.m1.8.8.1.1.3.2.2.2a" xref="S3.E1.m1.8.8.1.1.3.2.2.1.cmml">⁡</mo><mrow id="S3.E1.m1.8.8.1.1.3.2.2.2.1" xref="S3.E1.m1.8.8.1.1.3.2.2.1.cmml"><mo stretchy="false" id="S3.E1.m1.8.8.1.1.3.2.2.2.1.1" xref="S3.E1.m1.8.8.1.1.3.2.2.1.cmml">(</mo><mfrac id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml"><mrow id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E1.m1.2.2.2.2a" xref="S3.E1.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E1.m1.2.2.2.2.1" xref="S3.E1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.2.1.2" xref="S3.E1.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.2.2.2.2.1.1" xref="S3.E1.m1.2.2.2.2.1.1.cmml"><msubsup id="S3.E1.m1.2.2.2.2.1.1.2" xref="S3.E1.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.2.2.2" xref="S3.E1.m1.2.2.2.2.1.1.2.2.2.cmml">𝐮</mi><mi id="S3.E1.m1.2.2.2.2.1.1.2.3" xref="S3.E1.m1.2.2.2.2.1.1.2.3.cmml">j</mi><mi id="S3.E1.m1.2.2.2.2.1.1.2.2.3" xref="S3.E1.m1.2.2.2.2.1.1.2.2.3.cmml">i</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.2.2.2.2.1.1.1" xref="S3.E1.m1.2.2.2.2.1.1.1.cmml">⋅</mo><msubsup id="S3.E1.m1.2.2.2.2.1.1.3" xref="S3.E1.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.3.2.2" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.cmml">𝐩</mi><mi id="S3.E1.m1.2.2.2.2.1.1.3.2.3" xref="S3.E1.m1.2.2.2.2.1.1.3.2.3.cmml">j</mi><mi id="S3.E1.m1.2.2.2.2.1.1.3.3" xref="S3.E1.m1.2.2.2.2.1.1.3.3.cmml">i</mi></msubsup></mrow><mo stretchy="false" id="S3.E1.m1.2.2.2.2.1.3" xref="S3.E1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E1.m1.6.6.6" xref="S3.E1.m1.6.6.6.cmml"><mrow id="S3.E1.m1.5.5.5.3.1" xref="S3.E1.m1.5.5.5.3.2.cmml"><mi id="S3.E1.m1.3.3.3.1" xref="S3.E1.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E1.m1.5.5.5.3.1a" xref="S3.E1.m1.5.5.5.3.2.cmml">⁡</mo><mrow id="S3.E1.m1.5.5.5.3.1.1" xref="S3.E1.m1.5.5.5.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.5.3.1.1.2" xref="S3.E1.m1.5.5.5.3.2.cmml">(</mo><mrow id="S3.E1.m1.5.5.5.3.1.1.1" xref="S3.E1.m1.5.5.5.3.1.1.1.cmml"><msubsup id="S3.E1.m1.5.5.5.3.1.1.1.2" xref="S3.E1.m1.5.5.5.3.1.1.1.2.cmml"><mi id="S3.E1.m1.5.5.5.3.1.1.1.2.2.2" xref="S3.E1.m1.5.5.5.3.1.1.1.2.2.2.cmml">𝐮</mi><mi id="S3.E1.m1.5.5.5.3.1.1.1.2.3" xref="S3.E1.m1.5.5.5.3.1.1.1.2.3.cmml">j</mi><mi id="S3.E1.m1.5.5.5.3.1.1.1.2.2.3" xref="S3.E1.m1.5.5.5.3.1.1.1.2.2.3.cmml">i</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.5.5.5.3.1.1.1.1" xref="S3.E1.m1.5.5.5.3.1.1.1.1.cmml">⋅</mo><msubsup id="S3.E1.m1.5.5.5.3.1.1.1.3" xref="S3.E1.m1.5.5.5.3.1.1.1.3.cmml"><mi id="S3.E1.m1.5.5.5.3.1.1.1.3.2.2" xref="S3.E1.m1.5.5.5.3.1.1.1.3.2.2.cmml">𝐩</mi><mi id="S3.E1.m1.5.5.5.3.1.1.1.3.2.3" xref="S3.E1.m1.5.5.5.3.1.1.1.3.2.3.cmml">j</mi><mi id="S3.E1.m1.5.5.5.3.1.1.1.3.3" xref="S3.E1.m1.5.5.5.3.1.1.1.3.3.cmml">i</mi></msubsup></mrow><mo stretchy="false" id="S3.E1.m1.5.5.5.3.1.1.3" xref="S3.E1.m1.5.5.5.3.2.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="S3.E1.m1.6.6.6.5" xref="S3.E1.m1.6.6.6.5.cmml">+</mo><mrow id="S3.E1.m1.6.6.6.4" xref="S3.E1.m1.6.6.6.4.cmml"><msub id="S3.E1.m1.6.6.6.4.2" xref="S3.E1.m1.6.6.6.4.2.cmml"><mo id="S3.E1.m1.6.6.6.4.2.2" xref="S3.E1.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="S3.E1.m1.6.6.6.4.2.3" xref="S3.E1.m1.6.6.6.4.2.3.cmml"><mi id="S3.E1.m1.6.6.6.4.2.3.2" xref="S3.E1.m1.6.6.6.4.2.3.2.cmml">𝐧</mi><mo id="S3.E1.m1.6.6.6.4.2.3.1" xref="S3.E1.m1.6.6.6.4.2.3.1.cmml">∈</mo><msubsup id="S3.E1.m1.6.6.6.4.2.3.3" xref="S3.E1.m1.6.6.6.4.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.6.6.6.4.2.3.3.2.2" xref="S3.E1.m1.6.6.6.4.2.3.3.2.2.cmml">𝒩</mi><mi id="S3.E1.m1.6.6.6.4.2.3.3.2.3" xref="S3.E1.m1.6.6.6.4.2.3.3.2.3.cmml">j</mi><mi id="S3.E1.m1.6.6.6.4.2.3.3.3" xref="S3.E1.m1.6.6.6.4.2.3.3.3.cmml">i</mi></msubsup></mrow></msub><mrow id="S3.E1.m1.6.6.6.4.1.1" xref="S3.E1.m1.6.6.6.4.1.2.cmml"><mi id="S3.E1.m1.4.4.4.2" xref="S3.E1.m1.4.4.4.2.cmml">exp</mi><mo id="S3.E1.m1.6.6.6.4.1.1a" xref="S3.E1.m1.6.6.6.4.1.2.cmml">⁡</mo><mrow id="S3.E1.m1.6.6.6.4.1.1.1" xref="S3.E1.m1.6.6.6.4.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.6.4.1.1.1.2" xref="S3.E1.m1.6.6.6.4.1.2.cmml">(</mo><mrow id="S3.E1.m1.6.6.6.4.1.1.1.1" xref="S3.E1.m1.6.6.6.4.1.1.1.1.cmml"><msubsup id="S3.E1.m1.6.6.6.4.1.1.1.1.2" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.cmml"><mi id="S3.E1.m1.6.6.6.4.1.1.1.1.2.2.2" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.2.2.cmml">𝐮</mi><mi id="S3.E1.m1.6.6.6.4.1.1.1.1.2.3" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.3.cmml">j</mi><mi id="S3.E1.m1.6.6.6.4.1.1.1.1.2.2.3" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.2.3.cmml">i</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.6.6.6.4.1.1.1.1.1" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.cmml">⋅</mo><mi id="S3.E1.m1.6.6.6.4.1.1.1.1.3" xref="S3.E1.m1.6.6.6.4.1.1.1.1.3.cmml">𝐧</mi></mrow><mo stretchy="false" id="S3.E1.m1.6.6.6.4.1.1.1.3" xref="S3.E1.m1.6.6.6.4.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac><mo stretchy="false" id="S3.E1.m1.8.8.1.1.3.2.2.2.1.2" xref="S3.E1.m1.8.8.1.1.3.2.2.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.8.8.1.2" xref="S3.E1.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.8b"><apply id="S3.E1.m1.8.8.1.1.cmml" xref="S3.E1.m1.8.8.1"><eq id="S3.E1.m1.8.8.1.1.1.cmml" xref="S3.E1.m1.8.8.1.1.1"></eq><apply id="S3.E1.m1.8.8.1.1.2.cmml" xref="S3.E1.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.1.1.2.1.cmml" xref="S3.E1.m1.8.8.1.1.2">subscript</csymbol><ci id="S3.E1.m1.8.8.1.1.2.2.cmml" xref="S3.E1.m1.8.8.1.1.2.2">ℒ</ci><ci id="S3.E1.m1.8.8.1.1.2.3.cmml" xref="S3.E1.m1.8.8.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.8.8.1.1.3.cmml" xref="S3.E1.m1.8.8.1.1.3"><minus id="S3.E1.m1.8.8.1.1.3.1.cmml" xref="S3.E1.m1.8.8.1.1.3"></minus><apply id="S3.E1.m1.8.8.1.1.3.2.cmml" xref="S3.E1.m1.8.8.1.1.3.2"><apply id="S3.E1.m1.8.8.1.1.3.2.1.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.1.1.3.2.1.1.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1">superscript</csymbol><apply id="S3.E1.m1.8.8.1.1.3.2.1.2.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.1.1.3.2.1.2.1.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1">subscript</csymbol><sum id="S3.E1.m1.8.8.1.1.3.2.1.2.2.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1.2.2"></sum><apply id="S3.E1.m1.8.8.1.1.3.2.1.2.3.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1.2.3"><eq id="S3.E1.m1.8.8.1.1.3.2.1.2.3.1.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1.2.3.1"></eq><ci id="S3.E1.m1.8.8.1.1.3.2.1.2.3.2.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E1.m1.8.8.1.1.3.2.1.2.3.3.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.8.8.1.1.3.2.1.3.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1.3">𝑃</ci></apply><apply id="S3.E1.m1.8.8.1.1.3.2.2.1.cmml" xref="S3.E1.m1.8.8.1.1.3.2.2.2"><log id="S3.E1.m1.7.7.cmml" xref="S3.E1.m1.7.7"></log><apply id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><divide id="S3.E1.m1.6.6.7.cmml" xref="S3.E1.m1.6.6"></divide><apply id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2"><exp id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"></exp><apply id="S3.E1.m1.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1"><ci id="S3.E1.m1.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1">⋅</ci><apply id="S3.E1.m1.2.2.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2">subscript</csymbol><apply id="S3.E1.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2">superscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.2.2">𝐮</ci><ci id="S3.E1.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.3">𝑗</ci></apply><apply id="S3.E1.m1.2.2.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3">superscript</csymbol><apply id="S3.E1.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.3.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.3.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2">𝐩</ci><ci id="S3.E1.m1.2.2.2.2.1.1.3.2.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.3">𝑗</ci></apply><ci id="S3.E1.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E1.m1.6.6.6.cmml" xref="S3.E1.m1.6.6.6"><plus id="S3.E1.m1.6.6.6.5.cmml" xref="S3.E1.m1.6.6.6.5"></plus><apply id="S3.E1.m1.5.5.5.3.2.cmml" xref="S3.E1.m1.5.5.5.3.1"><exp id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.1"></exp><apply id="S3.E1.m1.5.5.5.3.1.1.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1"><ci id="S3.E1.m1.5.5.5.3.1.1.1.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1">⋅</ci><apply id="S3.E1.m1.5.5.5.3.1.1.1.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.3.1.1.1.2.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2">subscript</csymbol><apply id="S3.E1.m1.5.5.5.3.1.1.1.2.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.3.1.1.1.2.2.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2">superscript</csymbol><ci id="S3.E1.m1.5.5.5.3.1.1.1.2.2.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2.2.2">𝐮</ci><ci id="S3.E1.m1.5.5.5.3.1.1.1.2.2.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.5.5.5.3.1.1.1.2.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E1.m1.5.5.5.3.1.1.1.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.3.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.3">superscript</csymbol><apply id="S3.E1.m1.5.5.5.3.1.1.1.3.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.3.1.1.1.3.2.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.5.5.5.3.1.1.1.3.2.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.3.2.2">𝐩</ci><ci id="S3.E1.m1.5.5.5.3.1.1.1.3.2.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.3.2.3">𝑗</ci></apply><ci id="S3.E1.m1.5.5.5.3.1.1.1.3.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E1.m1.6.6.6.4.cmml" xref="S3.E1.m1.6.6.6.4"><apply id="S3.E1.m1.6.6.6.4.2.cmml" xref="S3.E1.m1.6.6.6.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.2.1.cmml" xref="S3.E1.m1.6.6.6.4.2">subscript</csymbol><sum id="S3.E1.m1.6.6.6.4.2.2.cmml" xref="S3.E1.m1.6.6.6.4.2.2"></sum><apply id="S3.E1.m1.6.6.6.4.2.3.cmml" xref="S3.E1.m1.6.6.6.4.2.3"><in id="S3.E1.m1.6.6.6.4.2.3.1.cmml" xref="S3.E1.m1.6.6.6.4.2.3.1"></in><ci id="S3.E1.m1.6.6.6.4.2.3.2.cmml" xref="S3.E1.m1.6.6.6.4.2.3.2">𝐧</ci><apply id="S3.E1.m1.6.6.6.4.2.3.3.cmml" xref="S3.E1.m1.6.6.6.4.2.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.2.3.3.1.cmml" xref="S3.E1.m1.6.6.6.4.2.3.3">superscript</csymbol><apply id="S3.E1.m1.6.6.6.4.2.3.3.2.cmml" xref="S3.E1.m1.6.6.6.4.2.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.2.3.3.2.1.cmml" xref="S3.E1.m1.6.6.6.4.2.3.3">subscript</csymbol><ci id="S3.E1.m1.6.6.6.4.2.3.3.2.2.cmml" xref="S3.E1.m1.6.6.6.4.2.3.3.2.2">𝒩</ci><ci id="S3.E1.m1.6.6.6.4.2.3.3.2.3.cmml" xref="S3.E1.m1.6.6.6.4.2.3.3.2.3">𝑗</ci></apply><ci id="S3.E1.m1.6.6.6.4.2.3.3.3.cmml" xref="S3.E1.m1.6.6.6.4.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E1.m1.6.6.6.4.1.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1"><exp id="S3.E1.m1.4.4.4.2.cmml" xref="S3.E1.m1.4.4.4.2"></exp><apply id="S3.E1.m1.6.6.6.4.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1"><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1">⋅</ci><apply id="S3.E1.m1.6.6.6.4.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2">subscript</csymbol><apply id="S3.E1.m1.6.6.6.4.1.1.1.1.2.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2">superscript</csymbol><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.2.2">𝐮</ci><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.2.3.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.3">𝐧</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.8c">\mathcal{L}_{i}=-\sum_{j=1}^{P}\log(\frac{\exp(\mathbf{u}^{i}_{j}\cdot\mathbf{p}_{j}^{i})}{\exp(\mathbf{u}^{i}_{j}\cdot\mathbf{p}_{j}^{i})+\sum_{\mathbf{n}\in\mathcal{N}_{j}^{i}}\exp(\mathbf{u}^{i}_{j}\cdot\mathbf{n})}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.14" class="ltx_p">where <math id="S3.SS2.p1.12.m1.1" class="ltx_Math" alttext="\mathbf{u}^{i}_{j}" display="inline"><semantics id="S3.SS2.p1.12.m1.1a"><msubsup id="S3.SS2.p1.12.m1.1.1" xref="S3.SS2.p1.12.m1.1.1.cmml"><mi id="S3.SS2.p1.12.m1.1.1.2.2" xref="S3.SS2.p1.12.m1.1.1.2.2.cmml">𝐮</mi><mi id="S3.SS2.p1.12.m1.1.1.3" xref="S3.SS2.p1.12.m1.1.1.3.cmml">j</mi><mi id="S3.SS2.p1.12.m1.1.1.2.3" xref="S3.SS2.p1.12.m1.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m1.1b"><apply id="S3.SS2.p1.12.m1.1.1.cmml" xref="S3.SS2.p1.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m1.1.1.1.cmml" xref="S3.SS2.p1.12.m1.1.1">subscript</csymbol><apply id="S3.SS2.p1.12.m1.1.1.2.cmml" xref="S3.SS2.p1.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m1.1.1.2.1.cmml" xref="S3.SS2.p1.12.m1.1.1">superscript</csymbol><ci id="S3.SS2.p1.12.m1.1.1.2.2.cmml" xref="S3.SS2.p1.12.m1.1.1.2.2">𝐮</ci><ci id="S3.SS2.p1.12.m1.1.1.2.3.cmml" xref="S3.SS2.p1.12.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.12.m1.1.1.3.cmml" xref="S3.SS2.p1.12.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m1.1c">\mathbf{u}^{i}_{j}</annotation></semantics></math> represents the user embedding for matching with the positive item <math id="S3.SS2.p1.13.m2.1" class="ltx_Math" alttext="p_{j}^{i}" display="inline"><semantics id="S3.SS2.p1.13.m2.1a"><msubsup id="S3.SS2.p1.13.m2.1.1" xref="S3.SS2.p1.13.m2.1.1.cmml"><mi id="S3.SS2.p1.13.m2.1.1.2.2" xref="S3.SS2.p1.13.m2.1.1.2.2.cmml">p</mi><mi id="S3.SS2.p1.13.m2.1.1.2.3" xref="S3.SS2.p1.13.m2.1.1.2.3.cmml">j</mi><mi id="S3.SS2.p1.13.m2.1.1.3" xref="S3.SS2.p1.13.m2.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m2.1b"><apply id="S3.SS2.p1.13.m2.1.1.cmml" xref="S3.SS2.p1.13.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m2.1.1.1.cmml" xref="S3.SS2.p1.13.m2.1.1">superscript</csymbol><apply id="S3.SS2.p1.13.m2.1.1.2.cmml" xref="S3.SS2.p1.13.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m2.1.1.2.1.cmml" xref="S3.SS2.p1.13.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.13.m2.1.1.2.2.cmml" xref="S3.SS2.p1.13.m2.1.1.2.2">𝑝</ci><ci id="S3.SS2.p1.13.m2.1.1.2.3.cmml" xref="S3.SS2.p1.13.m2.1.1.2.3">𝑗</ci></apply><ci id="S3.SS2.p1.13.m2.1.1.3.cmml" xref="S3.SS2.p1.13.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m2.1c">p_{j}^{i}</annotation></semantics></math> (inferred by the user model on client <math id="S3.SS2.p1.14.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.14.m3.1a"><mi id="S3.SS2.p1.14.m3.1.1" xref="S3.SS2.p1.14.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m3.1b"><ci id="S3.SS2.p1.14.m3.1.1.cmml" xref="S3.SS2.p1.14.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m3.1c">i</annotation></semantics></math>).</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Federated Model Update</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Finally, we briefly introduce the federated model update process in <span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_italic">FedCL</span>.
After computing the loss function <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{i}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">ℒ</ci><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathcal{L}_{i}</annotation></semantics></math>, each client locally optimizes this loss to update the maintained local recommendation model.
The local model updates from a certain number of clients are securely uploaded <cite class="ltx_cite ltx_citemacro_cite">Chai <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite> to the server for aggregation, and the aggregated model updates are used to update the global model maintained by the server.
The server further distributes the global model to each client to conduct local update.
The cascaded process of federated negative sampling, local negative mix-up for contrastive training, and federated model update is repeated for multiple rounds until the model converges.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets and Experimental Settings</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We conduct experiments on four widely used benchmark datasets for recommendation.
Two of them are taken from the Amazon dataset dump <cite class="ltx_cite ltx_citemacro_cite">McAuley <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib12" title="" class="ltx_ref">2015</a>)</cite>.
We use the “Beauty” and “Sports and Outdoors” (shorten as “Sports”) domains for experiments.
The third dataset is collected on Yelp.
Following the settings in <cite class="ltx_cite ltx_citemacro_cite">Zhou <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib26" title="" class="ltx_ref">2020</a>)</cite>, we use the transaction records after January 1st, 2019.
The last dataset is MovieLens 1M
(denoted as ML-1M) <cite class="ltx_cite ltx_citemacro_cite">Harper and
Konstan (<a href="#bib.bib4" title="" class="ltx_ref">2015</a>)</cite>, which is also a canonical recommendation dataset.
The statistics of the four datasets are listed in Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Datasets and Experimental Settings ‣ 4 Experiments ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
For each user, the last interacted item is used for test, and the item before the last one is used for validation.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<div id="S4.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:208.1pt;height:65.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-68.7pt,21.5pt) scale(0.602369825760159,0.602369825760159) ;">
<table id="S4.T1.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left">
<span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span>
   Datasets</td>
<td id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center">#Users</td>
<td id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center">#Items</td>
<td id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center">#Actions</td>
<td id="S4.T1.1.1.1.5" class="ltx_td ltx_align_center">Avg. length</td>
<td id="S4.T1.1.1.1.6" class="ltx_td ltx_align_center">Density</td>
</tr>
<tr id="S4.T1.1.1.2" class="ltx_tr">
<td id="S4.T1.1.1.2.1" class="ltx_td ltx_align_left ltx_border_t">Beauty</td>
<td id="S4.T1.1.1.2.2" class="ltx_td ltx_align_right ltx_border_t">40,226</td>
<td id="S4.T1.1.1.2.3" class="ltx_td ltx_align_right ltx_border_t">54,542</td>
<td id="S4.T1.1.1.2.4" class="ltx_td ltx_align_right ltx_border_t">0.35m</td>
<td id="S4.T1.1.1.2.5" class="ltx_td ltx_align_right ltx_border_t">8.8</td>
<td id="S4.T1.1.1.2.6" class="ltx_td ltx_align_right ltx_border_t">0.02%</td>
</tr>
<tr id="S4.T1.1.1.3" class="ltx_tr">
<td id="S4.T1.1.1.3.1" class="ltx_td ltx_align_left">Sports</td>
<td id="S4.T1.1.1.3.2" class="ltx_td ltx_align_right">25,598</td>
<td id="S4.T1.1.1.3.3" class="ltx_td ltx_align_right">18,357</td>
<td id="S4.T1.1.1.3.4" class="ltx_td ltx_align_right">0.30m</td>
<td id="S4.T1.1.1.3.5" class="ltx_td ltx_align_right">8.3</td>
<td id="S4.T1.1.1.3.6" class="ltx_td ltx_align_right">0.05%</td>
</tr>
<tr id="S4.T1.1.1.4" class="ltx_tr">
<td id="S4.T1.1.1.4.1" class="ltx_td ltx_align_left">Yelp</td>
<td id="S4.T1.1.1.4.2" class="ltx_td ltx_align_right">30,431</td>
<td id="S4.T1.1.1.4.3" class="ltx_td ltx_align_right">20,033</td>
<td id="S4.T1.1.1.4.4" class="ltx_td ltx_align_right">0.32m</td>
<td id="S4.T1.1.1.4.5" class="ltx_td ltx_align_right">10.4</td>
<td id="S4.T1.1.1.4.6" class="ltx_td ltx_align_right">0.05%</td>
</tr>
<tr id="S4.T1.1.1.5" class="ltx_tr">
<td id="S4.T1.1.1.5.1" class="ltx_td ltx_align_left">ML-1M</td>
<td id="S4.T1.1.1.5.2" class="ltx_td ltx_align_right">6,040</td>
<td id="S4.T1.1.1.5.3" class="ltx_td ltx_align_right">3,416</td>
<td id="S4.T1.1.1.5.4" class="ltx_td ltx_align_right">1.0m</td>
<td id="S4.T1.1.1.5.5" class="ltx_td ltx_align_right">163.5</td>
<td id="S4.T1.1.1.5.6" class="ltx_td ltx_align_right">4.79%</td>
</tr>
<tr id="S4.T1.1.1.6" class="ltx_tr">
<td id="S4.T1.1.1.6.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S4.T1.1.1.6.2" class="ltx_td"></td>
<td id="S4.T1.1.1.6.3" class="ltx_td"></td>
<td id="S4.T1.1.1.6.4" class="ltx_td"></td>
<td id="S4.T1.1.1.6.5" class="ltx_td"></td>
<td id="S4.T1.1.1.6.6" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Statistics of the four datasets used in experiments.</figcaption>
</figure>
<figure id="S4.T2" class="ltx_table">
<div id="S4.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:214.9pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-51.0pt,28.0pt) scale(0.792931991777443,0.792931991777443) ;">
<table id="S4.T2.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1.1" class="ltx_td ltx_align_left" colspan="3">
<span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span>
   <span id="S4.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Methods</span></td>
<td id="S4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r" colspan="4"><span id="S4.T2.1.1.1.2.1" class="ltx_text ltx_font_bold">Beauty</span></td>
<td id="S4.T2.1.1.1.3" class="ltx_td ltx_align_center" colspan="2">      <span id="S4.T2.1.1.1.3.1" class="ltx_text ltx_font_bold">Sports</span>
</td>
</tr>
<tr id="S4.T2.1.1.2" class="ltx_tr">
<td id="S4.T2.1.1.2.1" class="ltx_td ltx_border_r"></td>
<td id="S4.T2.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">HR@5</td>
<td id="S4.T2.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t">HR@10</td>
<td id="S4.T2.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">nDCG@5</td>
<td id="S4.T2.1.1.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">nDCG@10</td>
<td id="S4.T2.1.1.2.6" class="ltx_td ltx_align_center ltx_border_t">HR@5</td>
<td id="S4.T2.1.1.2.7" class="ltx_td ltx_align_center ltx_border_t">HR@10</td>
<td id="S4.T2.1.1.2.8" class="ltx_td ltx_align_center ltx_border_t">nDCG@5</td>
<td id="S4.T2.1.1.2.9" class="ltx_td ltx_align_center ltx_border_t">nDCG@10</td>
</tr>
<tr id="S4.T2.1.1.3" class="ltx_tr">
<td id="S4.T2.1.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">NCF</td>
<td id="S4.T2.1.1.3.2" class="ltx_td ltx_align_center ltx_border_t">0.0144</td>
<td id="S4.T2.1.1.3.3" class="ltx_td ltx_align_center ltx_border_t">0.0296</td>
<td id="S4.T2.1.1.3.4" class="ltx_td ltx_align_center ltx_border_t">0.0082</td>
<td id="S4.T2.1.1.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.0131</td>
<td id="S4.T2.1.1.3.6" class="ltx_td ltx_align_center ltx_border_t">0.0124</td>
<td id="S4.T2.1.1.3.7" class="ltx_td ltx_align_center ltx_border_t">0.0220</td>
<td id="S4.T2.1.1.3.8" class="ltx_td ltx_align_center ltx_border_t">0.0068</td>
<td id="S4.T2.1.1.3.9" class="ltx_td ltx_align_center ltx_border_t">0.0101</td>
</tr>
<tr id="S4.T2.1.1.4" class="ltx_tr">
<td id="S4.T2.1.1.4.1" class="ltx_td ltx_align_left ltx_border_r">NCF+Fed</td>
<td id="S4.T2.1.1.4.2" class="ltx_td ltx_align_center">0.0122</td>
<td id="S4.T2.1.1.4.3" class="ltx_td ltx_align_center">0.0267</td>
<td id="S4.T2.1.1.4.4" class="ltx_td ltx_align_center">0.0070</td>
<td id="S4.T2.1.1.4.5" class="ltx_td ltx_align_center ltx_border_r">0.0123</td>
<td id="S4.T2.1.1.4.6" class="ltx_td ltx_align_center">0.0106</td>
<td id="S4.T2.1.1.4.7" class="ltx_td ltx_align_center">0.0199</td>
<td id="S4.T2.1.1.4.8" class="ltx_td ltx_align_center">0.0062</td>
<td id="S4.T2.1.1.4.9" class="ltx_td ltx_align_center">0.0094</td>
</tr>
<tr id="S4.T2.1.1.5" class="ltx_tr">
<td id="S4.T2.1.1.5.1" class="ltx_td ltx_align_left ltx_border_r">NCF+BIL</td>
<td id="S4.T2.1.1.5.2" class="ltx_td ltx_align_center">0.0140</td>
<td id="S4.T2.1.1.5.3" class="ltx_td ltx_align_center">0.0288</td>
<td id="S4.T2.1.1.5.4" class="ltx_td ltx_align_center">0.0079</td>
<td id="S4.T2.1.1.5.5" class="ltx_td ltx_align_center ltx_border_r">0.0129</td>
<td id="S4.T2.1.1.5.6" class="ltx_td ltx_align_center">0.0125</td>
<td id="S4.T2.1.1.5.7" class="ltx_td ltx_align_center">0.0223</td>
<td id="S4.T2.1.1.5.8" class="ltx_td ltx_align_center">0.0070</td>
<td id="S4.T2.1.1.5.9" class="ltx_td ltx_align_center">0.0102</td>
</tr>
<tr id="S4.T2.1.1.6" class="ltx_tr">
<td id="S4.T2.1.1.6.1" class="ltx_td ltx_align_left ltx_border_r">NCF+FedCL</td>
<td id="S4.T2.1.1.6.2" class="ltx_td ltx_align_center">0.0245</td>
<td id="S4.T2.1.1.6.3" class="ltx_td ltx_align_center">0.0413</td>
<td id="S4.T2.1.1.6.4" class="ltx_td ltx_align_center">0.0155</td>
<td id="S4.T2.1.1.6.5" class="ltx_td ltx_align_center ltx_border_r">0.0209</td>
<td id="S4.T2.1.1.6.6" class="ltx_td ltx_align_center">0.0178</td>
<td id="S4.T2.1.1.6.7" class="ltx_td ltx_align_center">0.0304</td>
<td id="S4.T2.1.1.6.8" class="ltx_td ltx_align_center">0.0109</td>
<td id="S4.T2.1.1.6.9" class="ltx_td ltx_align_center">0.0148</td>
</tr>
<tr id="S4.T2.1.1.7" class="ltx_tr">
<td id="S4.T2.1.1.7.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">GRU4Rec</td>
<td id="S4.T2.1.1.7.2" class="ltx_td ltx_align_center ltx_border_t">0.0166</td>
<td id="S4.T2.1.1.7.3" class="ltx_td ltx_align_center ltx_border_t">0.0358</td>
<td id="S4.T2.1.1.7.4" class="ltx_td ltx_align_center ltx_border_t">0.0088</td>
<td id="S4.T2.1.1.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.0143</td>
<td id="S4.T2.1.1.7.6" class="ltx_td ltx_align_center ltx_border_t">0.0135</td>
<td id="S4.T2.1.1.7.7" class="ltx_td ltx_align_center ltx_border_t">0.0277</td>
<td id="S4.T2.1.1.7.8" class="ltx_td ltx_align_center ltx_border_t">0.0094</td>
<td id="S4.T2.1.1.7.9" class="ltx_td ltx_align_center ltx_border_t">0.0135</td>
</tr>
<tr id="S4.T2.1.1.8" class="ltx_tr">
<td id="S4.T2.1.1.8.1" class="ltx_td ltx_align_left ltx_border_r">GRU4Rec+Fed</td>
<td id="S4.T2.1.1.8.2" class="ltx_td ltx_align_center">0.0134</td>
<td id="S4.T2.1.1.8.3" class="ltx_td ltx_align_center">0.0316</td>
<td id="S4.T2.1.1.8.4" class="ltx_td ltx_align_center">0.0074</td>
<td id="S4.T2.1.1.8.5" class="ltx_td ltx_align_center ltx_border_r">0.0130</td>
<td id="S4.T2.1.1.8.6" class="ltx_td ltx_align_center">0.0115</td>
<td id="S4.T2.1.1.8.7" class="ltx_td ltx_align_center">0.0227</td>
<td id="S4.T2.1.1.8.8" class="ltx_td ltx_align_center">0.0079</td>
<td id="S4.T2.1.1.8.9" class="ltx_td ltx_align_center">0.0104</td>
</tr>
<tr id="S4.T2.1.1.9" class="ltx_tr">
<td id="S4.T2.1.1.9.1" class="ltx_td ltx_align_left ltx_border_r">GRU4Rec+BIL</td>
<td id="S4.T2.1.1.9.2" class="ltx_td ltx_align_center">0.0160</td>
<td id="S4.T2.1.1.9.3" class="ltx_td ltx_align_center">0.0343</td>
<td id="S4.T2.1.1.9.4" class="ltx_td ltx_align_center">0.0083</td>
<td id="S4.T2.1.1.9.5" class="ltx_td ltx_align_center ltx_border_r">0.0136</td>
<td id="S4.T2.1.1.9.6" class="ltx_td ltx_align_center">0.0130</td>
<td id="S4.T2.1.1.9.7" class="ltx_td ltx_align_center">0.0270</td>
<td id="S4.T2.1.1.9.8" class="ltx_td ltx_align_center">0.0091</td>
<td id="S4.T2.1.1.9.9" class="ltx_td ltx_align_center">0.0129</td>
</tr>
<tr id="S4.T2.1.1.10" class="ltx_tr">
<td id="S4.T2.1.1.10.1" class="ltx_td ltx_align_left ltx_border_r">GRU4Rec+FedCL</td>
<td id="S4.T2.1.1.10.2" class="ltx_td ltx_align_center">0.0312</td>
<td id="S4.T2.1.1.10.3" class="ltx_td ltx_align_center">0.0539</td>
<td id="S4.T2.1.1.10.4" class="ltx_td ltx_align_center">0.0189</td>
<td id="S4.T2.1.1.10.5" class="ltx_td ltx_align_center ltx_border_r">0.0265</td>
<td id="S4.T2.1.1.10.6" class="ltx_td ltx_align_center">0.0184</td>
<td id="S4.T2.1.1.10.7" class="ltx_td ltx_align_center">0.0311</td>
<td id="S4.T2.1.1.10.8" class="ltx_td ltx_align_center">0.0115</td>
<td id="S4.T2.1.1.10.9" class="ltx_td ltx_align_center">0.0156</td>
</tr>
<tr id="S4.T2.1.1.11" class="ltx_tr">
<td id="S4.T2.1.1.11.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">BERT4Rec</td>
<td id="S4.T2.1.1.11.2" class="ltx_td ltx_align_center ltx_border_t">0.0199</td>
<td id="S4.T2.1.1.11.3" class="ltx_td ltx_align_center ltx_border_t">0.0410</td>
<td id="S4.T2.1.1.11.4" class="ltx_td ltx_align_center ltx_border_t">0.0188</td>
<td id="S4.T2.1.1.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.0259</td>
<td id="S4.T2.1.1.11.6" class="ltx_td ltx_align_center ltx_border_t">0.0169</td>
<td id="S4.T2.1.1.11.7" class="ltx_td ltx_align_center ltx_border_t">0.0332</td>
<td id="S4.T2.1.1.11.8" class="ltx_td ltx_align_center ltx_border_t">0.0104</td>
<td id="S4.T2.1.1.11.9" class="ltx_td ltx_align_center ltx_border_t">0.0156</td>
</tr>
<tr id="S4.T2.1.1.12" class="ltx_tr">
<td id="S4.T2.1.1.12.1" class="ltx_td ltx_align_left ltx_border_r">BERT4Rec+Fed</td>
<td id="S4.T2.1.1.12.2" class="ltx_td ltx_align_center">0.0158</td>
<td id="S4.T2.1.1.12.3" class="ltx_td ltx_align_center">0.0352</td>
<td id="S4.T2.1.1.12.4" class="ltx_td ltx_align_center">0.0160</td>
<td id="S4.T2.1.1.12.5" class="ltx_td ltx_align_center ltx_border_r">0.0222</td>
<td id="S4.T2.1.1.12.6" class="ltx_td ltx_align_center">0.0134</td>
<td id="S4.T2.1.1.12.7" class="ltx_td ltx_align_center">0.0292</td>
<td id="S4.T2.1.1.12.8" class="ltx_td ltx_align_center">0.0098</td>
<td id="S4.T2.1.1.12.9" class="ltx_td ltx_align_center">0.0135</td>
</tr>
<tr id="S4.T2.1.1.13" class="ltx_tr">
<td id="S4.T2.1.1.13.1" class="ltx_td ltx_align_left ltx_border_r">BERT4Rec+BIL</td>
<td id="S4.T2.1.1.13.2" class="ltx_td ltx_align_center">0.0191</td>
<td id="S4.T2.1.1.13.3" class="ltx_td ltx_align_center">0.0397</td>
<td id="S4.T2.1.1.13.4" class="ltx_td ltx_align_center">0.0182</td>
<td id="S4.T2.1.1.13.5" class="ltx_td ltx_align_center ltx_border_r">0.0250</td>
<td id="S4.T2.1.1.13.6" class="ltx_td ltx_align_center">0.0164</td>
<td id="S4.T2.1.1.13.7" class="ltx_td ltx_align_center">0.0325</td>
<td id="S4.T2.1.1.13.8" class="ltx_td ltx_align_center">0.0101</td>
<td id="S4.T2.1.1.13.9" class="ltx_td ltx_align_center">0.0150</td>
</tr>
<tr id="S4.T2.1.1.14" class="ltx_tr">
<td id="S4.T2.1.1.14.1" class="ltx_td ltx_align_left ltx_border_r">BERT4Rec+FedCL</td>
<td id="S4.T2.1.1.14.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.14.2.1" class="ltx_text ltx_font_bold">0.0368</span></td>
<td id="S4.T2.1.1.14.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.14.3.1" class="ltx_text ltx_font_bold">0.0654</span></td>
<td id="S4.T2.1.1.14.4" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.14.4.1" class="ltx_text ltx_font_bold">0.0209</span></td>
<td id="S4.T2.1.1.14.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.1.1.14.5.1" class="ltx_text ltx_font_bold">0.0304</span></td>
<td id="S4.T2.1.1.14.6" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.14.6.1" class="ltx_text ltx_font_bold">0.0215</span></td>
<td id="S4.T2.1.1.14.7" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.14.7.1" class="ltx_text ltx_font_bold">0.0348</span></td>
<td id="S4.T2.1.1.14.8" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.14.8.1" class="ltx_text ltx_font_bold">0.0124</span></td>
<td id="S4.T2.1.1.14.9" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.14.9.1" class="ltx_text ltx_font_bold">0.0179</span></td>
</tr>
<tr id="S4.T2.1.1.15" class="ltx_tr">
<td id="S4.T2.1.1.15.1" class="ltx_td ltx_align_left ltx_border_r"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S4.T2.1.1.15.2" class="ltx_td"></td>
<td id="S4.T2.1.1.15.3" class="ltx_td"></td>
<td id="S4.T2.1.1.15.4" class="ltx_td"></td>
<td id="S4.T2.1.1.15.5" class="ltx_td"></td>
<td id="S4.T2.1.1.15.6" class="ltx_td"></td>
<td id="S4.T2.1.1.15.7" class="ltx_td"></td>
<td id="S4.T2.1.1.15.8" class="ltx_td"></td>
<td id="S4.T2.1.1.15.9" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results of different methods on the Beauty and Sports datasets.</figcaption>
</figure>
<figure id="S4.T3" class="ltx_table">
<div id="S4.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:214.9pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-51.0pt,28.0pt) scale(0.792931991777443,0.792931991777443) ;">
<table id="S4.T3.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<td id="S4.T3.1.1.1.1" class="ltx_td ltx_align_left" colspan="3">
<span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span>
   <span id="S4.T3.1.1.1.1.1" class="ltx_text ltx_font_bold">Methods</span></td>
<td id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center" colspan="4"><span id="S4.T3.1.1.1.2.1" class="ltx_text ltx_font_bold">Yelp</span></td>
<td id="S4.T3.1.1.1.3" class="ltx_td ltx_align_center" colspan="2">      <span id="S4.T3.1.1.1.3.1" class="ltx_text ltx_font_bold">ML-1M</span>
</td>
</tr>
<tr id="S4.T3.1.1.2" class="ltx_tr">
<td id="S4.T3.1.1.2.1" class="ltx_td ltx_border_r"></td>
<td id="S4.T3.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">HR@5</td>
<td id="S4.T3.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t">HR@10</td>
<td id="S4.T3.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">nDCG@5</td>
<td id="S4.T3.1.1.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">nDCG@10</td>
<td id="S4.T3.1.1.2.6" class="ltx_td ltx_align_center ltx_border_t">HR@5</td>
<td id="S4.T3.1.1.2.7" class="ltx_td ltx_align_center ltx_border_t">HR@10</td>
<td id="S4.T3.1.1.2.8" class="ltx_td ltx_align_center ltx_border_t">nDCG@5</td>
<td id="S4.T3.1.1.2.9" class="ltx_td ltx_align_center ltx_border_t">nDCG@10</td>
</tr>
<tr id="S4.T3.1.1.3" class="ltx_tr">
<td id="S4.T3.1.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">NCF</td>
<td id="S4.T3.1.1.3.2" class="ltx_td ltx_align_center ltx_border_t">0.0134</td>
<td id="S4.T3.1.1.3.3" class="ltx_td ltx_align_center ltx_border_t">0.0275</td>
<td id="S4.T3.1.1.3.4" class="ltx_td ltx_align_center ltx_border_t">0.0080</td>
<td id="S4.T3.1.1.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.0118</td>
<td id="S4.T3.1.1.3.6" class="ltx_td ltx_align_center ltx_border_t">0.0168</td>
<td id="S4.T3.1.1.3.7" class="ltx_td ltx_align_center ltx_border_t">0.0322</td>
<td id="S4.T3.1.1.3.8" class="ltx_td ltx_align_center ltx_border_t">0.0098</td>
<td id="S4.T3.1.1.3.9" class="ltx_td ltx_align_center ltx_border_t">0.0145</td>
</tr>
<tr id="S4.T3.1.1.4" class="ltx_tr">
<td id="S4.T3.1.1.4.1" class="ltx_td ltx_align_left ltx_border_r">NCF+Fed</td>
<td id="S4.T3.1.1.4.2" class="ltx_td ltx_align_center">0.0104</td>
<td id="S4.T3.1.1.4.3" class="ltx_td ltx_align_center">0.0212</td>
<td id="S4.T3.1.1.4.4" class="ltx_td ltx_align_center">0.0072</td>
<td id="S4.T3.1.1.4.5" class="ltx_td ltx_align_center ltx_border_r">0.0109</td>
<td id="S4.T3.1.1.4.6" class="ltx_td ltx_align_center">0.0133</td>
<td id="S4.T3.1.1.4.7" class="ltx_td ltx_align_center">0.0275</td>
<td id="S4.T3.1.1.4.8" class="ltx_td ltx_align_center">0.0090</td>
<td id="S4.T3.1.1.4.9" class="ltx_td ltx_align_center">0.0137</td>
</tr>
<tr id="S4.T3.1.1.5" class="ltx_tr">
<td id="S4.T3.1.1.5.1" class="ltx_td ltx_align_left ltx_border_r">NCF+BIL</td>
<td id="S4.T3.1.1.5.2" class="ltx_td ltx_align_center">0.0128</td>
<td id="S4.T3.1.1.5.3" class="ltx_td ltx_align_center">0.0266</td>
<td id="S4.T3.1.1.5.4" class="ltx_td ltx_align_center">0.0078</td>
<td id="S4.T3.1.1.5.5" class="ltx_td ltx_align_center ltx_border_r">0.0116</td>
<td id="S4.T3.1.1.5.6" class="ltx_td ltx_align_center">0.0157</td>
<td id="S4.T3.1.1.5.7" class="ltx_td ltx_align_center">0.0310</td>
<td id="S4.T3.1.1.5.8" class="ltx_td ltx_align_center">0.0095</td>
<td id="S4.T3.1.1.5.9" class="ltx_td ltx_align_center">0.0142</td>
</tr>
<tr id="S4.T3.1.1.6" class="ltx_tr">
<td id="S4.T3.1.1.6.1" class="ltx_td ltx_align_left ltx_border_r">NCF+FedCL</td>
<td id="S4.T3.1.1.6.2" class="ltx_td ltx_align_center">0.0213</td>
<td id="S4.T3.1.1.6.3" class="ltx_td ltx_align_center">0.0359</td>
<td id="S4.T3.1.1.6.4" class="ltx_td ltx_align_center">0.0135</td>
<td id="S4.T3.1.1.6.5" class="ltx_td ltx_align_center ltx_border_r">0.0186</td>
<td id="S4.T3.1.1.6.6" class="ltx_td ltx_align_center">0.0414</td>
<td id="S4.T3.1.1.6.7" class="ltx_td ltx_align_center">0.0675</td>
<td id="S4.T3.1.1.6.8" class="ltx_td ltx_align_center">0.0256</td>
<td id="S4.T3.1.1.6.9" class="ltx_td ltx_align_center">0.0342</td>
</tr>
<tr id="S4.T3.1.1.7" class="ltx_tr">
<td id="S4.T3.1.1.7.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">GRU4Rec</td>
<td id="S4.T3.1.1.7.2" class="ltx_td ltx_align_center ltx_border_t">0.0153</td>
<td id="S4.T3.1.1.7.3" class="ltx_td ltx_align_center ltx_border_t">0.0262</td>
<td id="S4.T3.1.1.7.4" class="ltx_td ltx_align_center ltx_border_t">0.0101</td>
<td id="S4.T3.1.1.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.0135</td>
<td id="S4.T3.1.1.7.6" class="ltx_td ltx_align_center ltx_border_t">0.0769</td>
<td id="S4.T3.1.1.7.7" class="ltx_td ltx_align_center ltx_border_t">0.1662</td>
<td id="S4.T3.1.1.7.8" class="ltx_td ltx_align_center ltx_border_t">0.0388</td>
<td id="S4.T3.1.1.7.9" class="ltx_td ltx_align_center ltx_border_t">0.0674</td>
</tr>
<tr id="S4.T3.1.1.8" class="ltx_tr">
<td id="S4.T3.1.1.8.1" class="ltx_td ltx_align_left ltx_border_r">GRU4Rec+Fed</td>
<td id="S4.T3.1.1.8.2" class="ltx_td ltx_align_center">0.0120</td>
<td id="S4.T3.1.1.8.3" class="ltx_td ltx_align_center">0.0237</td>
<td id="S4.T3.1.1.8.4" class="ltx_td ltx_align_center">0.0084</td>
<td id="S4.T3.1.1.8.5" class="ltx_td ltx_align_center ltx_border_r">0.0112</td>
<td id="S4.T3.1.1.8.6" class="ltx_td ltx_align_center">0.0588</td>
<td id="S4.T3.1.1.8.7" class="ltx_td ltx_align_center">0.1025</td>
<td id="S4.T3.1.1.8.8" class="ltx_td ltx_align_center">0.0309</td>
<td id="S4.T3.1.1.8.9" class="ltx_td ltx_align_center">0.0531</td>
</tr>
<tr id="S4.T3.1.1.9" class="ltx_tr">
<td id="S4.T3.1.1.9.1" class="ltx_td ltx_align_left ltx_border_r">GRU4Rec+BIL</td>
<td id="S4.T3.1.1.9.2" class="ltx_td ltx_align_center">0.0146</td>
<td id="S4.T3.1.1.9.3" class="ltx_td ltx_align_center">0.0255</td>
<td id="S4.T3.1.1.9.4" class="ltx_td ltx_align_center">0.0098</td>
<td id="S4.T3.1.1.9.5" class="ltx_td ltx_align_center ltx_border_r">0.0129</td>
<td id="S4.T3.1.1.9.6" class="ltx_td ltx_align_center">0.0754</td>
<td id="S4.T3.1.1.9.7" class="ltx_td ltx_align_center">0.1633</td>
<td id="S4.T3.1.1.9.8" class="ltx_td ltx_align_center">0.0372</td>
<td id="S4.T3.1.1.9.9" class="ltx_td ltx_align_center">0.0660</td>
</tr>
<tr id="S4.T3.1.1.10" class="ltx_tr">
<td id="S4.T3.1.1.10.1" class="ltx_td ltx_align_left ltx_border_r">GRU4Rec+FedCL</td>
<td id="S4.T3.1.1.10.2" class="ltx_td ltx_align_center">0.0264</td>
<td id="S4.T3.1.1.10.3" class="ltx_td ltx_align_center">0.0413</td>
<td id="S4.T3.1.1.10.4" class="ltx_td ltx_align_center">0.0176</td>
<td id="S4.T3.1.1.10.5" class="ltx_td ltx_align_center ltx_border_r">0.0225</td>
<td id="S4.T3.1.1.10.6" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.10.6.1" class="ltx_text ltx_font_bold">0.1155</span></td>
<td id="S4.T3.1.1.10.7" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.10.7.1" class="ltx_text ltx_font_bold">0.2013</span></td>
<td id="S4.T3.1.1.10.8" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.10.8.1" class="ltx_text ltx_font_bold">0.0671</span></td>
<td id="S4.T3.1.1.10.9" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.10.9.1" class="ltx_text ltx_font_bold">0.0940</span></td>
</tr>
<tr id="S4.T3.1.1.11" class="ltx_tr">
<td id="S4.T3.1.1.11.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">BERT4Rec</td>
<td id="S4.T3.1.1.11.2" class="ltx_td ltx_align_center ltx_border_t">0.0184</td>
<td id="S4.T3.1.1.11.3" class="ltx_td ltx_align_center ltx_border_t">0.0292</td>
<td id="S4.T3.1.1.11.4" class="ltx_td ltx_align_center ltx_border_t">0.0117</td>
<td id="S4.T3.1.1.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.0173</td>
<td id="S4.T3.1.1.11.6" class="ltx_td ltx_align_center ltx_border_t">0.0736</td>
<td id="S4.T3.1.1.11.7" class="ltx_td ltx_align_center ltx_border_t">0.1344</td>
<td id="S4.T3.1.1.11.8" class="ltx_td ltx_align_center ltx_border_t">0.0427</td>
<td id="S4.T3.1.1.11.9" class="ltx_td ltx_align_center ltx_border_t">0.0622</td>
</tr>
<tr id="S4.T3.1.1.12" class="ltx_tr">
<td id="S4.T3.1.1.12.1" class="ltx_td ltx_align_left ltx_border_r">BERT4Rec+Fed</td>
<td id="S4.T3.1.1.12.2" class="ltx_td ltx_align_center">0.0152</td>
<td id="S4.T3.1.1.12.3" class="ltx_td ltx_align_center">0.0256</td>
<td id="S4.T3.1.1.12.4" class="ltx_td ltx_align_center">0.0100</td>
<td id="S4.T3.1.1.12.5" class="ltx_td ltx_align_center ltx_border_r">0.0114</td>
<td id="S4.T3.1.1.12.6" class="ltx_td ltx_align_center">0.0544</td>
<td id="S4.T3.1.1.12.7" class="ltx_td ltx_align_center">0.0939</td>
<td id="S4.T3.1.1.12.8" class="ltx_td ltx_align_center">0.0288</td>
<td id="S4.T3.1.1.12.9" class="ltx_td ltx_align_center">0.0487</td>
</tr>
<tr id="S4.T3.1.1.13" class="ltx_tr">
<td id="S4.T3.1.1.13.1" class="ltx_td ltx_align_left ltx_border_r">BERT4Rec+BIL</td>
<td id="S4.T3.1.1.13.2" class="ltx_td ltx_align_center">0.0178</td>
<td id="S4.T3.1.1.13.3" class="ltx_td ltx_align_center">0.0299</td>
<td id="S4.T3.1.1.13.4" class="ltx_td ltx_align_center">0.0119</td>
<td id="S4.T3.1.1.13.5" class="ltx_td ltx_align_center ltx_border_r">0.0180</td>
<td id="S4.T3.1.1.13.6" class="ltx_td ltx_align_center">0.0727</td>
<td id="S4.T3.1.1.13.7" class="ltx_td ltx_align_center">0.1316</td>
<td id="S4.T3.1.1.13.8" class="ltx_td ltx_align_center">0.0420</td>
<td id="S4.T3.1.1.13.9" class="ltx_td ltx_align_center">0.0616</td>
</tr>
<tr id="S4.T3.1.1.14" class="ltx_tr">
<td id="S4.T3.1.1.14.1" class="ltx_td ltx_align_left ltx_border_r">BERT4Rec+FedCL</td>
<td id="S4.T3.1.1.14.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.14.2.1" class="ltx_text ltx_font_bold">0.0281</span></td>
<td id="S4.T3.1.1.14.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.14.3.1" class="ltx_text ltx_font_bold">0.0440</span></td>
<td id="S4.T3.1.1.14.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.14.4.1" class="ltx_text ltx_font_bold">0.0189</span></td>
<td id="S4.T3.1.1.14.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T3.1.1.14.5.1" class="ltx_text ltx_font_bold">0.0236</span></td>
<td id="S4.T3.1.1.14.6" class="ltx_td ltx_align_center">0.1115</td>
<td id="S4.T3.1.1.14.7" class="ltx_td ltx_align_center">0.1946</td>
<td id="S4.T3.1.1.14.8" class="ltx_td ltx_align_center">0.0642</td>
<td id="S4.T3.1.1.14.9" class="ltx_td ltx_align_center">0.0909</td>
</tr>
<tr id="S4.T3.1.1.15" class="ltx_tr">
<td id="S4.T3.1.1.15.1" class="ltx_td ltx_align_left ltx_border_r"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></td>
<td id="S4.T3.1.1.15.2" class="ltx_td"></td>
<td id="S4.T3.1.1.15.3" class="ltx_td"></td>
<td id="S4.T3.1.1.15.4" class="ltx_td"></td>
<td id="S4.T3.1.1.15.5" class="ltx_td"></td>
<td id="S4.T3.1.1.15.6" class="ltx_td"></td>
<td id="S4.T3.1.1.15.7" class="ltx_td"></td>
<td id="S4.T3.1.1.15.8" class="ltx_td"></td>
<td id="S4.T3.1.1.15.9" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results of different methods on the Yelp and ML-1M datasets.</figcaption>
</figure>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.2" class="ltx_p">We use the Adam <cite class="ltx_cite ltx_citemacro_cite">Kingma and Ba (<a href="#bib.bib8" title="" class="ltx_ref">2015</a>)</cite> optimizer for model training.
The learning rate is 1e-3, and the number of selected users per update is 16.
The hidden dimension is 64.
The user embedding norm clip threshold is 1.
The privacy budget <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\epsilon</annotation></semantics></math> is 4.
The number of clusters is 25.
To simulate local negative items, we randomly sample 100 items on each client, and for each positive we randomly choose 10 local negatives to participate in contrastive learning.
The difficulty <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">R</annotation></semantics></math>% of negative samples is set to 25%.
The number of semi-hard negatives is 20.
These hyperparameters are tuned on the validation sets.
Motivated by <cite class="ltx_cite ltx_citemacro_cite">Krichene and
Rendle (<a href="#bib.bib9" title="" class="ltx_ref">2020</a>)</cite>, we evaluate the recommendation performance on the whole item set rather than the sampled subsets used in <cite class="ltx_cite ltx_citemacro_cite">Sun <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib20" title="" class="ltx_ref">2019</a>)</cite>.
We use the Hit Ratio (HR) and normalized Discounted Cumulative Gain (nDCG) metrics over the top 5 or 10 ranked items.
We repeat each experiment 5 times and report the average scores.
We will soon release our code for reproducibility.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Performance Evaluation</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">To verify the effectiveness and generality of <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">FedCL</span>, we compare the results of several widely used methods, including NCF <cite class="ltx_cite ltx_citemacro_cite">He <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib5" title="" class="ltx_ref">2017</a>)</cite>, GRU4Rec <cite class="ltx_cite ltx_citemacro_cite">Hidasi <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib6" title="" class="ltx_ref">2016</a>)</cite> and BERT4Rec <cite class="ltx_cite ltx_citemacro_cite">Sun <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib20" title="" class="ltx_ref">2019</a>)</cite>, under four different settings as follows:
(a) centralized learning, which uses the original data sampling and model learning methods based on centralized data;
(b) federated learning (Fed), which directly applies the federated learning framework to the basic model (local negatives are used);
(c) federated learning with batch-insensitive loss (BIL) <cite class="ltx_cite ltx_citemacro_cite">Ning <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>, which uses batch-insensitive loss to learn models on local positive items only;
(d) federated contrastive learning (FedCL), our proposed method.
The results on the four datasets are shown in Tables <a href="#S4.T2" title="Table 2 ‣ 4.1 Datasets and Experimental Settings ‣ 4 Experiments ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#S4.T3" title="Table 3 ‣ 4.1 Datasets and Experimental Settings ‣ 4 Experiments ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
We find that compared with centralized learning, the performance of models learned in the standard federated framework usually decreases.
This is mainly due to the non-IID property of user data decentralized on different clients and the scarcity of informative negative samples.
In addition, the <span id="S4.SS2.p1.1.2" class="ltx_text ltx_font_italic">BIL</span> method outperforms the federated baseline.
This is because BIL learns uniform item representations via a spreadout regularization instead of learning from the limited local negative samples.
Moreover, our proposed <span id="S4.SS2.p1.1.3" class="ltx_text ltx_font_italic">FedCL</span> method outperforms other methods (t-test results show the improvement is significant, <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="p&lt;0.001" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">p</mi><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">&lt;</mo><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><lt id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></lt><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑝</ci><cn type="float" id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">p&lt;0.001</annotation></semantics></math>), and it can consistently boost the performance of different base models.
This is because our approach can incorporate various kinds of negative samples into contrastive model training to exploit richer negative signals.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Influence of Negative Samples</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Next, we study the impacts of different types of negative samples in our approach.
We compare the model performance with one kind of negative samples removed, and the performance of replacing semi-hard negatives with globally hardest negatives <cite class="ltx_cite ltx_citemacro_cite">Xiong <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>.
The results on the Yelp and ML-1M datasets are shown in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.4 Influence of Clustering ‣ 4 Experiments ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
We find that the hard negatives obtained by the federated negative sampling method have a major contribution to model performance.
However, the performance has a huge decline if they are replaced by globally hardest samples.
This is mainly because globally hardest samples may contain many false negatives, which are harmful to model training.
In addition, both in-batch and local negatives have contributions, but the performance gain brought by the local negatives is not so large.
Thus, the performance of <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_italic">FedCL</span> can still be promising if there is no local negative sample available on user devices.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Influence of Clustering</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">We further study the influence of clustering on the model performance.
The results without clustering, with Kmeans clustering, or with Ward clustering are compared in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.4 Influence of Clustering ‣ 4 Experiments ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
We observe that the performance is suboptimal when the user embeddings are directly used for hard negative sampling.
This is intuitive because the perturbed user embeddings are quite noisy.
In addition, both Kmeans and Ward clustering algorithms can improve the model performance.
This may be because using the centroids of clusters to replace original user embeddings can mitigate the influence of noise.
In addition, the Ward clustering method is better than Kmeans.
This may be because the hierarchical clustering method is stronger in modeling the relations between similar user interests.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2204.09850/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="181" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Influence of different types of negative samples.</figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2204.09850/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="170" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Influence of user embedding clustering.</figcaption>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Influence of Cluster Number</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">We then analyze the impacts of the number of clusters on model performance, as shown in Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.7 Experiments in Appendix ‣ 4 Experiments ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
The results reveal that when the number of clusters is too small, the performance is suboptimal.
This may be because user interests cannot be effectively distinguished when there are too few clusters.
However, the performance starts to decrease when the number of clusters is larger than 25.
This may be because the influence of noise encoded in user embeddings becomes large.
Thus, we set the number of clusters <math id="S4.SS5.p1.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS5.p1.1.m1.1a"><mi id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><ci id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">C</annotation></semantics></math> to 25.</p>
</div>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Influence of Privacy Budget</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.3" class="ltx_p">Finally, we analyze the influence of the privacy budget of user embeddings for hard negative sampling on the model performance.
We change the intensity of Laplace noise according to different privacy budgets, and the corresponding results are shown in Fig. <a href="#S4.F6" title="Figure 6 ‣ 4.7 Experiments in Appendix ‣ 4 Experiments ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
We find that the performance usually decreases when a smaller privacy budget <math id="S4.SS6.p1.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS6.p1.1.m1.1a"><mi id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><ci id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">\epsilon</annotation></semantics></math> is used.
This is intuitive because the noise is stronger when <math id="S4.SS6.p1.2.m2.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS6.p1.2.m2.1a"><mi id="S4.SS6.p1.2.m2.1.1" xref="S4.SS6.p1.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.m2.1b"><ci id="S4.SS6.p1.2.m2.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.2.m2.1c">\epsilon</annotation></semantics></math> is smaller, and the obtained negative samples are more inaccurate.
In our approach, we choose <math id="S4.SS6.p1.3.m3.1" class="ltx_Math" alttext="\epsilon=4" display="inline"><semantics id="S4.SS6.p1.3.m3.1a"><mrow id="S4.SS6.p1.3.m3.1.1" xref="S4.SS6.p1.3.m3.1.1.cmml"><mi id="S4.SS6.p1.3.m3.1.1.2" xref="S4.SS6.p1.3.m3.1.1.2.cmml">ϵ</mi><mo id="S4.SS6.p1.3.m3.1.1.1" xref="S4.SS6.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS6.p1.3.m3.1.1.3" xref="S4.SS6.p1.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.3.m3.1b"><apply id="S4.SS6.p1.3.m3.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1"><eq id="S4.SS6.p1.3.m3.1.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1.1"></eq><ci id="S4.SS6.p1.3.m3.1.1.2.cmml" xref="S4.SS6.p1.3.m3.1.1.2">italic-ϵ</ci><cn type="integer" id="S4.SS6.p1.3.m3.1.1.3.cmml" xref="S4.SS6.p1.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.3.m3.1c">\epsilon=4</annotation></semantics></math> that can yield a good performance and satisfactory user privacy protection ability.</p>
</div>
</section>
<section id="S4.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>Experiments in Appendix</h3>

<div id="S4.SS7.p1" class="ltx_para">
<p id="S4.SS7.p1.1" class="ltx_p">In the appendix, we analyze the impact of the negative sample difficulty (<math id="S4.SS7.p1.1.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S4.SS7.p1.1.m1.1a"><mi id="S4.SS7.p1.1.m1.1.1" xref="S4.SS7.p1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.1.m1.1b"><ci id="S4.SS7.p1.1.m1.1.1.cmml" xref="S4.SS7.p1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.1.m1.1c">R</annotation></semantics></math>%) as well as the number of local and semi-hard negative samples.
The results show that selecting negatives from the top 25% relevant candidates and using a medium number of negative samples is suitable.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2204.09850/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="178" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Influence of the number of clusters.</figcaption>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2204.09850/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="179" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Influence of the privacy budget of user embeddings for hard negative sampling.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we propose a federated contrastive learning framework for privacy-preserving recommendation, which can effectively exploit various kinds of informative negative samples to empower federated recommendation model learning.
In our approach, we propose a federated negative sampling method to choose semi-hard negatives from the candidate item pool in a privacy-preserving way based on the locally inferred and perturbed user embeddings.
In addition, we explore using a negative mix-up method to jointly incorporate local, in-batch and semi-hard negative samples into a unified contrastive learning framework.
Extensive experiments on four widely used benchmark recommendation datasets validate that our approach can effectively improve different recommendation methods in a privacy-preserving manner.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ammad-Ud-Din <span id="bib.bib1.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Muhammad Ammad-Ud-Din, Elena Ivannikova, Suleiman A Khan, Were Oyomno, Qiang
Fu, Kuan Eeik Tan, and Adrian Flanagan.

</span>
<span class="ltx_bibblock">Federated collaborative filtering for privacy-preserving personalized
recommendation system.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1901.09888</span>, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chai <span id="bib.bib2.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Di Chai, Leye Wang, Kai Chen, and Qiang Yang.

</span>
<span class="ltx_bibblock">Secure federated matrix factorization.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic">IEEE Intelligent Systems</span>, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding <span id="bib.bib3.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Jingtao Ding, Yuhan Quan, Xiangnan He, Yong Li, and Depeng Jin.

</span>
<span class="ltx_bibblock">Reinforced negative sampling for recommendation with exposure data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib3.3.1" class="ltx_text ltx_font_italic">IJCAI</span>, pages 2230–2236, 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harper and
Konstan [2015]</span>
<span class="ltx_bibblock">
F Maxwell Harper and Joseph A Konstan.

</span>
<span class="ltx_bibblock">The movielens datasets: History and context.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">TIIS</span>, 5(4):1–19, 2015.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He <span id="bib.bib5.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Xiangnan He, Lizi Liao, Hanwang Zhang, Liqiang Nie, Xia Hu, and Tat-Seng Chua.

</span>
<span class="ltx_bibblock">Neural collaborative filtering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.3.1" class="ltx_text ltx_font_italic">WWW</span>, pages 173–182, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi <span id="bib.bib6.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2016]</span>
<span class="ltx_bibblock">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk.

</span>
<span class="ltx_bibblock">Session-based recommendations with recurrent neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.3.1" class="ltx_text ltx_font_italic">ICLR</span>, 2016.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kalantidis <span id="bib.bib7.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Yannis Kalantidis, Mert Bulent Sariyildiz, Noe Pion, Philippe Weinzaepfel, and
Diane Larlus.

</span>
<span class="ltx_bibblock">Hard negative mixing for contrastive learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2010.01028</span>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba [2015]</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2015.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krichene and
Rendle [2020]</span>
<span class="ltx_bibblock">
Walid Krichene and Steffen Rendle.

</span>
<span class="ltx_bibblock">On sampled metrics for item recommendation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">KDD</span>, pages 1748–1757, 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang <span id="bib.bib10.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Feng Liang, Weike Pan, and Zhong Ming.

</span>
<span class="ltx_bibblock">Fedrec++: Lossless federated recommendation with explicit feedback.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.3.1" class="ltx_text ltx_font_italic">AAAI</span>, pages 4224–4231, 2021.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin <span id="bib.bib11.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Guanyu Lin, Feng Liang, Weike Pan, and Zhong Ming.

</span>
<span class="ltx_bibblock">Fedrec: Federated recommendation with explicit feedback.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic">IEEE Intelligent Systems</span>, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McAuley <span id="bib.bib12.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2015]</span>
<span class="ltx_bibblock">
Julian McAuley, Christopher Targett, Qinfeng Shi, and Anton Van Den Hengel.

</span>
<span class="ltx_bibblock">Image-based recommendations on styles and substitutes.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.3.1" class="ltx_text ltx_font_italic">SIGIR</span>, pages 43–52, 2015.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan <span id="bib.bib13.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.3.1" class="ltx_text ltx_font_italic">AISTATS</span>, pages 1273–1282. PMLR, 2017.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ning <span id="bib.bib14.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Lin Ning, Karan Singhal, Ellie X Zhou, and Sushant Prakash.

</span>
<span class="ltx_bibblock">Learning federated representations and recommendations with limited
negatives.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2108.07931</span>, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi <span id="bib.bib15.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Tao Qi, Fangzhao Wu, Chuhan Wu, Yongfeng Huang, and Xing Xie.

</span>
<span class="ltx_bibblock">Privacy-preserving news recommendation model learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.3.1" class="ltx_text ltx_font_italic">EMNLP: Findings</span>, pages 1423–1432, 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi <span id="bib.bib16.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Tao Qi, Fangzhao Wu, Chuhan Wu, Yongfeng Huang, and Xing Xie.

</span>
<span class="ltx_bibblock">Uni-fedrec: A unified privacy-preserving news recommendation
framework for model training and online serving.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.3.1" class="ltx_text ltx_font_italic">EMNLP: Findings</span>, pages 1438–1448, 2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle <span id="bib.bib17.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2009]</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme.

</span>
<span class="ltx_bibblock">Bpr: Bayesian personalized ranking from implicit feedback.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.3.1" class="ltx_text ltx_font_italic">UAI</span>, pages 452–461, 2009.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Robinson <span id="bib.bib18.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Joshua Robinson, Ching-Yao Chuang, Suvrit Sra, and Stefanie Jegelka.

</span>
<span class="ltx_bibblock">Contrastive learning with hard negative samples.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2010.04592</span>, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen <span id="bib.bib19.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2014]</span>
<span class="ltx_bibblock">
Yelong Shen, Xiaodong He, Jianfeng Gao, Li Deng, and Grégoire Mesnil.

</span>
<span class="ltx_bibblock">Learning semantic representations using convolutional neural networks
for web search.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.3.1" class="ltx_text ltx_font_italic">WWW</span>, pages 373–374, 2014.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun <span id="bib.bib20.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang.

</span>
<span class="ltx_bibblock">Bert4rec: Sequential recommendation with bidirectional encoder
representations from transformer.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.3.1" class="ltx_text ltx_font_italic">CIKM</span>, pages 1441–1450, 2019.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang <span id="bib.bib21.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Jinpeng Wang, Jieming Zhu, and Xiuqiang He.

</span>
<span class="ltx_bibblock">Cross-batch negative sampling for training two-tower recommenders.

</span>
<span class="ltx_bibblock">In <span id="bib.bib21.3.1" class="ltx_text ltx_font_italic">SIGIR</span>, pages 1632–1636, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei <span id="bib.bib22.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Yinwei Wei, Xiang Wang, Qi Li, Liqiang Nie, Yan Li, Xuanping Li, and Tat-Seng
Chua.

</span>
<span class="ltx_bibblock">Contrastive learning for cold-start recommendation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.3.1" class="ltx_text ltx_font_italic">MM</span>, pages 5382–5390, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu <span id="bib.bib23.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Chuhan Wu, Fangzhao Wu, Mingxiao An, Jianqiang Huang, Yongfeng Huang, and Xing
Xie.

</span>
<span class="ltx_bibblock">Npa: Neural news recommendation with personalized attention.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.3.1" class="ltx_text ltx_font_italic">KDD</span>, pages 2576–2584, 2019.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong <span id="bib.bib24.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Lee Xiong, Chenyan Xiong, Ye Li, Kwok-Fung Tang, Jialin Liu, Paul Bennett,
Junaid Ahmed, and Arnold Overwijk.

</span>
<span class="ltx_bibblock">Approximate nearest neighbor negative contrastive learning for dense
text retrieval.

</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2007.00808</span>, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yi <span id="bib.bib25.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Xinyang Yi, Ji Yang, Lichan Hong, Derek Zhiyuan Cheng, Lukasz Heldt, Aditee
Kumthekar, Zhe Zhao, Li Wei, and Ed Chi.

</span>
<span class="ltx_bibblock">Sampling-bias-corrected neural modeling for large corpus item
recommendations.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.3.1" class="ltx_text ltx_font_italic">Recsys</span>, pages 269–277, 2019.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou <span id="bib.bib26.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Wang, Wayne Xin Zhao, Yutao Zhu, Sirui Wang, Fuzheng Zhang,
Zhongyuan Wang, and Ji-Rong Wen.

</span>
<span class="ltx_bibblock">S3-rec: Self-supervised learning for sequential recommendation with
mutual information maximization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib26.3.1" class="ltx_text ltx_font_italic">CIKM</span>, pages 1893–1902, 2020.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="Ax1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>

<section id="Ax1.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Implementation Details</h3>

<div id="Ax1.SSx1.p1" class="ltx_para">
<p id="Ax1.SSx1.p1.1" class="ltx_p">Several implementation details are introduced as follows.
We conducted experiments using a machine with Ubuntu 16.04 operating system and Python 3.6.
The machine has a memory of 256GB and a Tesla V100 GPU with 32GB memory.
We used Keras 2.2.4 and tensorflow 1.15 to implement deep learning models.
The Faiss library is used to retrieve negative samples.</p>
</div>
</section>
<section id="Ax1.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Influence of Negative Sample Difficulty</h3>

<div id="Ax1.SSx2.p1" class="ltx_para">
<p id="Ax1.SSx2.p1.5" class="ltx_p">Fig. <a href="#Ax1.F7" title="Figure 7 ‣ Influence of Sample Number ‣ Appendix ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows the influence of using top <math id="Ax1.SSx2.p1.1.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="Ax1.SSx2.p1.1.m1.1a"><mi id="Ax1.SSx2.p1.1.m1.1.1" xref="Ax1.SSx2.p1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="Ax1.SSx2.p1.1.m1.1b"><ci id="Ax1.SSx2.p1.1.m1.1.1.cmml" xref="Ax1.SSx2.p1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SSx2.p1.1.m1.1c">R</annotation></semantics></math>% relevant candidate items for semi-hard negative sampling.
The results show that the performance is suboptimal when the ratio <math id="Ax1.SSx2.p1.2.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="Ax1.SSx2.p1.2.m2.1a"><mi id="Ax1.SSx2.p1.2.m2.1.1" xref="Ax1.SSx2.p1.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="Ax1.SSx2.p1.2.m2.1b"><ci id="Ax1.SSx2.p1.2.m2.1.1.cmml" xref="Ax1.SSx2.p1.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SSx2.p1.2.m2.1c">R</annotation></semantics></math> is either too small or too large.
This is because when <math id="Ax1.SSx2.p1.3.m3.1" class="ltx_Math" alttext="R" display="inline"><semantics id="Ax1.SSx2.p1.3.m3.1a"><mi id="Ax1.SSx2.p1.3.m3.1.1" xref="Ax1.SSx2.p1.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="Ax1.SSx2.p1.3.m3.1b"><ci id="Ax1.SSx2.p1.3.m3.1.1.cmml" xref="Ax1.SSx2.p1.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SSx2.p1.3.m3.1c">R</annotation></semantics></math> is too large the sampled items are not so informative, while a small <math id="Ax1.SSx2.p1.4.m4.1" class="ltx_Math" alttext="R" display="inline"><semantics id="Ax1.SSx2.p1.4.m4.1a"><mi id="Ax1.SSx2.p1.4.m4.1.1" xref="Ax1.SSx2.p1.4.m4.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="Ax1.SSx2.p1.4.m4.1b"><ci id="Ax1.SSx2.p1.4.m4.1.1.cmml" xref="Ax1.SSx2.p1.4.m4.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SSx2.p1.4.m4.1c">R</annotation></semantics></math> may lead to inaccurate negatives because they are too hard.
Thus, we choose <math id="Ax1.SSx2.p1.5.m5.1" class="ltx_Math" alttext="R=25" display="inline"><semantics id="Ax1.SSx2.p1.5.m5.1a"><mrow id="Ax1.SSx2.p1.5.m5.1.1" xref="Ax1.SSx2.p1.5.m5.1.1.cmml"><mi id="Ax1.SSx2.p1.5.m5.1.1.2" xref="Ax1.SSx2.p1.5.m5.1.1.2.cmml">R</mi><mo id="Ax1.SSx2.p1.5.m5.1.1.1" xref="Ax1.SSx2.p1.5.m5.1.1.1.cmml">=</mo><mn id="Ax1.SSx2.p1.5.m5.1.1.3" xref="Ax1.SSx2.p1.5.m5.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="Ax1.SSx2.p1.5.m5.1b"><apply id="Ax1.SSx2.p1.5.m5.1.1.cmml" xref="Ax1.SSx2.p1.5.m5.1.1"><eq id="Ax1.SSx2.p1.5.m5.1.1.1.cmml" xref="Ax1.SSx2.p1.5.m5.1.1.1"></eq><ci id="Ax1.SSx2.p1.5.m5.1.1.2.cmml" xref="Ax1.SSx2.p1.5.m5.1.1.2">𝑅</ci><cn type="integer" id="Ax1.SSx2.p1.5.m5.1.1.3.cmml" xref="Ax1.SSx2.p1.5.m5.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SSx2.p1.5.m5.1c">R=25</annotation></semantics></math> in our experiments.</p>
</div>
</section>
<section id="Ax1.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Influence of Sample Number</h3>

<div id="Ax1.SSx3.p1" class="ltx_para">
<p id="Ax1.SSx3.p1.1" class="ltx_p">We also study the influence of semi-hard and local negative samples on the model performance.
We first set the number of local negative samples to 10 and change the number of semi-hard negative samples, as shown in Fig. <a href="#Ax1.F8" title="Figure 8 ‣ Influence of Sample Number ‣ Appendix ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.
We find the performance is optimal when about 20 semi-hard negative samples are used.
This is because the negative signals cannot be effectively exploited when semi-hard negatives are insufficient, while the negative sets are not uniform enough when there are too many hard negatives.</p>
</div>
<div id="Ax1.SSx3.p2" class="ltx_para">
<p id="Ax1.SSx3.p2.1" class="ltx_p">We further change the number of local negative samples and compare the results (Fig. <a href="#Ax1.F9" title="Figure 9 ‣ Influence of Sample Number ‣ Appendix ‣ FedCL: Federated Contrastive Learning for Privacy-Preserving Recommendation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>).
We find that the number of local negative samples used for model training also needs to be moderate.
Thus, we choose to use 10 negative samples in model learning.</p>
</div>
<figure id="Ax1.F7" class="ltx_figure"><img src="/html/2204.09850/assets/x7.png" id="Ax1.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="221" height="86" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Influence of the negative sample difficulty. </figcaption>
</figure>
<figure id="Ax1.F8" class="ltx_figure"><img src="/html/2204.09850/assets/x8.png" id="Ax1.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="221" height="85" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Influence of the number of semi-hard negative samples. </figcaption>
</figure>
<figure id="Ax1.F9" class="ltx_figure"><img src="/html/2204.09850/assets/x9.png" id="Ax1.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="221" height="86" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Influence of the number of local negative samples. </figcaption>
</figure>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2204.09849" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2204.09850" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2204.09850">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2204.09850" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2204.09851" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Mar 11 12:39:04 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
