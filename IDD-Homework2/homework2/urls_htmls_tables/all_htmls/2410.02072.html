<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation</title>
<!--Generated on Wed Oct  2 22:36:00 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.02072v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S1" title="In Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S2" title="In Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S2.SS0.SSS0.Px1" title="In 2 Related Work ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Discriminative Models,</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S2.SS0.SSS0.Px2" title="In 2 Related Work ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Generative Models,</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S2.SS0.SSS0.Px3" title="In 2 Related Work ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Synthetic vs. Real Data for MDSNE:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S2.SS0.SSS0.Px4" title="In 2 Related Work ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Bridging the Gap:</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3" title="In Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS1" title="In 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Learning from the Giants</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS1.SSS0.Px1" title="In 3.1 Learning from the Giants ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Key Findings:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS1.SSS0.Px2" title="In 3.1 Learning from the Giants ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Challenges with Real Labeled Data:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS1.SSS0.Px3" title="In 3.1 Learning from the Giants ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Advantages and Limitations of Synthetic Data:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS1.SSS0.Px4" title="In 3.1 Learning from the Giants ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Our Approach:</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS2" title="In 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Step 1: Pseudo-Labelled Data Generation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS2.SSS0.Px1" title="In 3.2 Step 1: Pseudo-Labelled Data Generation ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Depth Normal Evaluation and Selection Algorithm (DNESA):</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS3" title="In 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Step 2: Training of the Student Model</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS3.SSS1" title="In 3.3 Step 2: Training of the Student Model ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Encoder Architecture Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS3.SSS2" title="In 3.3 Step 2: Training of the Student Model ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Decoder Architecture Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS3.SSS3" title="In 3.3 Step 2: Training of the Student Model ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.3 </span>Loss Function</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS3.SSS3.Px1" title="In 3.3.3 Loss Function ‣ 3.3 Step 2: Training of the Student Model ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_text ltx_font_bold">Scale- and Shift-Invariant Loss</span>:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS3.SSS3.Px2" title="In 3.3.3 Loss Function ‣ 3.3 Step 2: Training of the Student Model ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_text ltx_font_bold">Gradient Matching Term</span>:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.SS3.SSS3.Px3" title="In 3.3.3 Loss Function ‣ 3.3 Step 2: Training of the Student Model ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_text ltx_font_bold">Final Loss</span>:</span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4" title="In Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.SS1" title="In 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.SS2" title="In 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.SS3" title="In 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.SS4" title="In 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Quantitative Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.SS5" title="In 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Qualitative Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.SS6" title="In 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.SS7" title="In 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.7 </span>Computational Efficiency</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S5" title="In Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Discussion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S5.SS0.SSS0.Px1" title="In 5 Discussion ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Balancing Local and Global Features:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S5.SS0.SSS0.Px2" title="In 5 Discussion ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Enhancing Generalisation with Pseudo-Labelling:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S5.SS0.SSS0.Px3" title="In 5 Discussion ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Practicality Through Efficiency:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S5.SS0.SSS0.Px4" title="In 5 Discussion ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title">Broader Implications for Marine Science:</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S6" title="In Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusions</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_fleqn">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\UseRawInputEncoding</span>
</div>
<div class="ltx_para" id="p2">
<p class="ltx_p" id="p2.1">[orcid=0000-0001-6973-019X]
<span class="ltx_ERROR undefined" id="p2.1.1">\cormark</span>[1]
<span class="ltx_ERROR undefined" id="p2.1.2">\credit</span>Conceptualisation, Data Curation, Data Analysis, Software Development, DL Algorithm Design, Visualization, Writing original draft</p>
</div>
<div class="ltx_para" id="p3">
<p class="ltx_p" id="p3.1">[orcid=0000]
<span class="ltx_ERROR undefined" id="p3.1.1">\credit</span>Conceptualisation, Supervision, Reviewing/editing the draft</p>
</div>
<div class="ltx_para" id="p4">
<p class="ltx_p" id="p4.1">[orcid=0000]
<span class="ltx_ERROR undefined" id="p4.1.1">\credit</span>Conceptualisation, Supervision, Reviewing/editing the draft</p>
</div>
<div class="ltx_para" id="p5">
<p class="ltx_p" id="p5.1">[ orcid=0000-0001-7975-3985]</p>
</div>
<div class="ltx_para" id="p6">
<span class="ltx_ERROR undefined" id="p6.1">\credit</span>
<p class="ltx_p" id="p6.2">Conceptualisation, Supervision, Reviewing/editing the draft</p>
</div>
<div class="ltx_para" id="p7">
<p class="ltx_p" id="p7.1">1]organization=College of Science and Engineering, James Cook University,
city=Townsville,
postcode=4814,
state=QLD,
country=Australia
</p>
</div>
<div class="ltx_para" id="p8">
<p class="ltx_p" id="p8.1">2]organization=The Australian Institute of Marine Science | AIMS,
city=Townsville,
postcode=4814,
state=QLD,
country=Australia
</p>
</div>
<div class="ltx_para" id="p9">
<span class="ltx_ERROR undefined" id="p9.1">\cortext</span>
<p class="ltx_p" id="p9.2">[cor1]Corresponding author</p>
</div>
<h1 class="ltx_title ltx_title_document">
Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Alzayat Saleh
</span><span class="ltx_author_notes">alzayat.saleh@my.jcu.edu.au</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Melanie Olsen
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Bouchra Senadji
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mostafa Rahimi Azghadi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Monocular Depth and Surface Normals Estimation (MDSNE) is crucial for tasks such as 3D reconstruction, autonomous navigation, and underwater exploration. Current methods rely either on discriminative models, which struggle with transparent or reflective surfaces, or generative models, which, while accurate, are computationally expensive. This paper presents a novel deep learning model for MDSNE, specifically tailored for underwater environments, using a hybrid architecture that integrates Convolutional Neural Networks (CNNs) with Transformers, leveraging the strengths of both approaches.
Training effective MDSNE models is often hampered by noisy real-world datasets and the limited generalization of synthetic datasets. To address this, we generate pseudo-labeled real data using multiple pre-trained MDSNE models. To ensure the quality of this data, we propose the Depth Normal Evaluation and Selection Algorithm (DNESA), which evaluates and selects the most reliable pseudo-labeled samples using domain-specific metrics. A lightweight student model is then trained on this curated dataset.
Our model reduces parameters by 90% and training costs by 80%, allowing real-time 3D perception on resource-constrained devices. Key contributions include: a novel and efficient MDSNE model, the DNESA algorithm, a domain-specific data pipeline, and a focus on real-time performance and scalability. Designed for real-world underwater applications, our model facilitates low-cost deployments in underwater robots and autonomous vehicles, bridging the gap between research and practical implementation.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
Semi-supervised Learning, <span class="ltx_ERROR undefined" id="id2.id1">\sep</span>Weed Detection, <span class="ltx_ERROR undefined" id="id3.id2">\sep</span>Deep Learning, <span class="ltx_ERROR undefined" id="id4.id3">\sep</span>Computer Vision, <span class="ltx_ERROR undefined" id="id5.id4">\sep</span>Agriculture. <span class="ltx_ERROR undefined" id="id6.id5">\sep</span>
</div>
<figure class="ltx_figure" id="S0.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="351" id="S0.F1.g1" src="extracted/5897268/Figures/fig_1.png" width="586"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
<span class="ltx_text ltx_font_bold" id="S0.F1.2.1">Integrating the strengths of both discriminative and generative approaches for geometry estimation.</span> Left: Depth and normal
predictions of our method on in-the-wild images. Right: Abs Rel Errors vs Frames Per Second (FPS) for Different Models
</figcaption>
</figure>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Monocular Depth and Surface Normals Estimation (MDSNE) plays a critical role in various applications, such as 3D reconstruction, autonomous navigation, and underwater exploration. Existing MDSNE approaches generally fall into two categories: discriminative models and generative models. Discriminative models, like Depth Anything <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib23" title="">23</a>]</cite>, excel at producing robust depth predictions efficiently, even in complex scenes, but struggle with transparent or reflective surfaces. However, generative models, like Marigold <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib12" title="">12</a>]</cite>, capture intricate object details, providing more refined depth maps, but are less practical in real-time or resource-constrained situations.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">This performance gap between discriminative and generative models highlights the need for an approach that combines the strengths of both, offering both efficiency and detailed precision. Furthermore, training accurate and robust MDSNE models often relies on large-scale datasets. However, real-world datasets often contain noisy labels, particularly for transparent or reflective objects, and lack fine-grained depth and surface normals annotations, leading to suboptimal predictions. Although synthetic datasets offer precise labels and consistent annotations, they suffer from domain gaps when applied to real-world scenarios.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">This paper introduces a novel deep learning model for MDSNE that addresses these challenges by merging the strengths of discriminative and generative approaches within a lightweight architecture, specifically designed for the complex underwater environment. We achieve this by first generating high-quality pseudo-labelled depth and surface normal data from unlabelled real underwater images using multiple state-of-the-art pre-trained models. However, generating high-quality pseudo-labels is not straightforward or simple, as it requires careful selection and evaluation to ensure the accuracy of the generated labels. To address this, we introduce the Depth Normal Evaluation and Selection Algorithm (DNESA) to evaluate the quality of the generated pseudo-depth and surface normals. DNESA helps select the most reliable pseudo-labeled data, ensuring that our training process is not compromised by inaccuracies in the labels. We then train a lightweight student model on this carefully curated pseudo-labeled dataset, combining a hybrid architecture of Convolutional Neural Networks (CNNs) and Transformers to capture both local and global image features effectively. This approach allows us to leverage the strengths of both synthetic and real-world data, leading to a model that is accurate and computationally efficient.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">The paper addresses key limitations in Monocular Depth and Surface Normals Estimation (MDSNE) for underwater environments, with five main contributions:</p>
</div>
<div class="ltx_para" id="S1.p5">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Novel MDSNE Model:</span> A hybrid model combining CNNs for local features and Transformers for global context, reducing parameters by 90% and training costs by 80% compared to Marigold <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib12" title="">12</a>]</cite>, making it suitable for low-power devices.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Depth Normal Evaluation and Selection Algorithm (DNESA):</span> An algorithm to assess and select reliable pseudo-labeled data based on underwater-specific challenges like light refraction and turbidity.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Domain-Specific Data Pipeline:</span> A pipeline tailored for underwater visuals, addressing low light, turbidity, and colour variation to improve model performance.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i4.p1.1.1">Real-Time 3D Perception:</span> The model achieves real-time inference (approximately 15.87ms per image), enabling use in tasks like underwater robot navigation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i5.p1">
<p class="ltx_p" id="S1.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i5.p1.1.1">Scalability and Practicality:</span> Prioritising efficiency and accessibility, the model supports scalability for broader use in real-world underwater applications.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">The rest of this paper is organised as follows: Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S2" title="2 Related Work ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">2</span></a> reviews related work on underwater depth estimation and surface normals, focussing on state-of-the-art approaches and their limitations in resource-constrained environments.
Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3" title="3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">3</span></a> details our proposed methodology, including the hybrid CNN-Transformer architecture and the domain-specific data pipeline. Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4" title="4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">4</span></a> presents the experimental setup and evaluates the performance of our model compared to existing methods, highlighting its efficiency and precision.
Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S5" title="5 Discussion ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">5</span></a> provides an in-depth discussion of the impact of the model on marine science tasks and outlines potential applications. Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S6" title="6 Conclusions ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">6</span></a> concludes the paper, summarising the contributions and suggesting directions for future research.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Research in Monocular Depth and Surface Normals Estimation (MDSNE) has significantly advanced, driven by the increasing demand for 3D perception in fields like robotics, autonomous navigation, and underwater exploration. This section provides an overview of key contributions in MDSNE, categorising them into discriminative and generative models, and discusses the challenges posed by different data sources for training these models.</p>
</div>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Discriminative Models,</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">have gained prominence in MDSNE due to their ability to produce robust depth predictions efficiently, even in complex scenes. These models typically rely on Convolutional Neural Networks (CNNs) to learn a direct mapping from input images to depth maps. A prime example is Depth Anything <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib23" title="">23</a>]</cite>, a model known for its efficiency and robustness in handling cluttered scenes. However, discriminative models often struggle with transparent or reflective surfaces, as they primarily focus on local features and struggle to capture global context <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib7" title="">7</a>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Generative Models,</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">such as Marigold <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib12" title="">12</a>]</cite>, address some limitations of discriminative models by learning to generate depth and surface normals from scene representations. These models excel at capturing fine-grained details and handling challenging surface properties like transparency and reflectivity. However, they typically come with a higher computational cost, making them less practical for real-time applications or resource-constrained environments <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib25" title="">25</a>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Synthetic vs. Real Data for MDSNE:</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">Training effective MDSNE models heavily relies on the availability of large-scale datasets. These datasets can be categorised into synthetic and real data, each presenting unique advantages and challenges.
1) <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px3.p1.1.1">Synthetic Datasets:</span> These datasets provide precise depth labels and surface normals due to the controlled environment in which they are generated. However, their main drawback lies in the domain gap between synthetic and real-world scenarios, which often leads to decreased performance when applied to real-world settings <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib28" title="">28</a>]</cite>.
2) <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px3.p1.1.2">Real Datasets:</span> These datasets offer greater realism and scene diversity but suffer from noisy labels, particularly for transparent or reflective objects. They often lack the fine-grained annotations required for accurate depth and surface normal estimations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib25" title="">25</a>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Bridging the Gap:</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px4.p1.1">Our method leverages the strengths of both discriminative and generative models, addressing their individual limitations through a lightweight, hybrid CNN-Transformer architecture. This approach balances accuracy and computational efficiency, making it suitable for real-time deployment on resource-constrained devices, unlike more resource-intensive diffusion-based models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib27" title="">27</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px4.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px4.p2.1">To overcome the challenge of noisy labels in real-world data, we introduce a novel pseudo-labelling technique. By utilising state-of-the-art models, we generate high-quality pseudo-labelled data from unlabeled real underwater images, combining the efficiency of discriminative models with the detail-oriented capabilities of generative models. This approach ensures robust generalisation across diverse underwater environments <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib18" title="">18</a>]</cite>.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="226" id="S2.F2.g1" src="extracted/5897268/Figures/fig_4.png" width="586"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S2.F2.4.1">Our Framework</span>: Two-step process for generating pseudo-labeled data and training a student model. <span class="ltx_text ltx_font_bold" id="S2.F2.5.2">Step 1</span> involves generating pseudo-labeled data by inputting real images into multiple Giant Models to produce depth maps and surface normals, followed by evaluation and selection of the best outputs. <span class="ltx_text ltx_font_bold" id="S2.F2.6.3">Step 2</span> involves training a Lightweight Student Model using the pseudo-labeled real images, highlighting regions to ignore during training due to high-error loss, and resulting in fine-grained predictions.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Learning from the Giants</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">This section presents our analysis of state-of-the-art models, which motivated us to develop our approach.</p>
</div>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Key Findings:</h5>
<div class="ltx_para" id="S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.1">Through this research, we identified several critical insights into the development of MDSNE models:</p>
<ol class="ltx_enumerate" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1">Fine details in depth maps can be achieved using discriminative models when trained on synthetic images, which offer more precise control over scene content.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1">Despite the superiority of synthetic images for detail-oriented tasks, real images are still widely used due to the challenges of fully addressing the limitations of synthetic data.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1">The limitations of synthetic data, such as distribution shifts and scene diversity, can be mitigated by creating large-scale pseudo-labeled real datasets, improving the robustness of the models.</p>
</div>
</li>
</ol>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="273" id="S3.F3.g1" src="extracted/5897268/Figures/fig_2.png" width="586"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S3.F3.2.1">Schematic of our network architecture for depth and surface normals estimation</span>. This diagram delineates the data flow through various components, including the Conv-Stem, ConvBlock, and Transformer, culminating in two parallel branches. The upper branch is dedicated to depth estimation, incorporating upsampling, convolutional layers, and a Disparity Head. The lower branch is focused on surface normals estimation, featuring upsampling, convolutional layers, and a Surface Normals Head. This architecture underscores the integration of convolutional and transformer blocks to enhance the accuracy of depth and surface normals estimation.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Challenges with Real Labeled Data:</h5>
<div class="ltx_para" id="S3.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.1">Real-world datasets often introduce significant challenges in MDSNE due to inherent noise in labels, particularly with objects that possess transparent or reflective properties. Furthermore, real datasets frequently lack fine-grained depth and surface normals annotations for smaller or thinner objects, leading to suboptimal predictions in such scenarios. This makes it difficult to achieve the same level of precision and accuracy that can be derived from synthetic data, where labels are precise and controlled.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Advantages and Limitations of Synthetic Data:</h5>
<div class="ltx_para" id="S3.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px3.p1.1">Synthetic data offer clear advantages in providing precise depth labels and consistent annotations, but they are not without limitations. The primary challenge with synthetic data lies in the distribution shift between synthetic and real-world scenarios, which can hinder model performance when applied to real environments. In addition, synthetic datasets often lack the diversity and complexity of real-world scenes, making it difficult to generalise effectively between tasks. Synthetic-to-real transfer, therefore, remains a significant challenge in the deployment of MDSNE models.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Our Approach:</h5>
<div class="ltx_para" id="S3.SS1.SSS0.Px4.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px4.p1.1">According to all the above analyses, our proposed approach is designed with a focus on both precision and computational efficiency, particularly in the context of real-time applications. The general framework consists of two main steps: (1) generating precise pseudo-depth and surface normals labels from large-scale, unlabelled real images, and (2) training a final student model that balances accuracy with computational efficiency for deployment on edge devices, ensuring robust generalisation across diverse environments, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S2.F2" title="In Bridging the Gap: ‣ 2 Related Work ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="321" id="S3.F4.g1" src="extracted/5897268/Figures/fig_3.png" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Schematic diagram illustrates the components and flow of data through ConvBlock, Transformer Block, and associated processes.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Step 1: Pseudo-Labelled Data Generation</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">In the first step, our objective is to address the limitations of real-world labelled datasets, which often suffer from noise, particularly with reflective, transparent, or fine-grained objects. To overcome this, we utilise a combination of state-of-the-art discriminative and generative models to create high-quality pseudo-labeled data. These models are pre-trained on synthetic and real datasets, which provide precise depth and surface normal annotations. These models are DepthAnything V2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib23" title="">23</a>]</cite>, ZoeDepth <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib6" title="">6</a>]</cite>, Metric3D -V2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib25" title="">25</a>]</cite>, and Marigold <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib12" title="">12</a>]</cite>.
Using these pre-trained models, we infer pseudo depth and surface normals on large-scale, unlabeled real images. This process helps bridge the gap between synthetic and real data, capturing the complexities and variations present in real-world scenes while maintaining the accuracy associated with synthetic annotations. The generated pseudo-labeled data thus serves as a more reliable and diverse dataset for training.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">While these state-of-the-art pre-trained models demonstrate exceptional performance and robustness in general depth and surface normals estimation tasks, they may encounter challenges when applied to underwater environments. The unique visual characteristics of underwater scenes, such as low-light conditions, water turbidity, and variations in colour spectra, can introduce a domain gap between the training data and the target underwater images. This domain gap can lead to inaccuracies in depth maps estimated for out-of-distribution underwater scenarios.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">To address this challenge, we propose the Depth Normal Evaluation and Selection Algorithm (DNESA). This algorithm is designed to evaluate the quality of the generated pseudo depth and surface normals in underwater environments and select the most accurate samples for training. DNESA operates by comparing the pseudo-labeled depth and normals against domain-specific metrics, such as contrast variation, edge sharpness, and noise levels, which are more representative of underwater conditions.
Once the pseudo-labeled data have been evaluated and filtered through DNESA, the remaining high-quality samples are added to the training pipeline. This approach ensures that the final training dataset is not only diverse but also better suited to underwater domains, reducing the impact of domain gaps and improving overall model performance when deployed in real-world underwater tasks.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="alg1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg1.38">
<div class="ltx_listingline" id="alg1.38.39">
<span class="ltx_text" id="alg1.38.39.1" style="font-size:80%;">
<span class="ltx_text" id="alg1.38.39.1.1"><span class="ltx_text ltx_font_bold" id="alg1.38.39.1.1.1">Input:</span> </span>RGB folder path, Model folders paths, Output folder path</span>
</div>
<div class="ltx_listingline" id="alg1.38.40">
<span class="ltx_text" id="alg1.38.40.1" style="font-size:80%;">
</span><span class="ltx_text" id="alg1.38.40.2" style="font-size:80%;"><span class="ltx_text ltx_font_bold" id="alg1.38.40.2.1">Output:</span> </span><span class="ltx_text" id="alg1.38.40.3" style="font-size:80%;">Best depth map and surface normals for each RGB image are copied to the output folder</span>
</div>
<div class="ltx_listingline" id="alg1.38.41">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.41.1.1.1" style="font-size:80%;">1</span></span><span class="ltx_text" id="alg1.38.41.2" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.38.41.3" style="font-size:80%;">Function</span><span class="ltx_text" id="alg1.38.41.4" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_typewriter" id="alg1.38.41.5" style="font-size:80%;">Main(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg1.38.41.5.1">rgbFolder, modelFolders, outputFolder</em>)</em><span class="ltx_text ltx_font_bold" id="alg1.38.41.6" style="font-size:80%;">:</span>
</div>
<div class="ltx_listingline" id="alg1.38.42">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.42.1.1.1" style="font-size:80%;">2</span></span><span class="ltx_text" id="alg1.38.42.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.42.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.42.4" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.38.42.5" style="font-size:80%;">foreach</span><span class="ltx_text" id="alg1.38.42.6" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.38.42.7" style="font-size:80%;">rgbFile in rgbFolder</em><span class="ltx_text" id="alg1.38.42.8" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.38.42.9" style="font-size:80%;">do</span>
</div>
<div class="ltx_listingline" id="alg1.1.1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.1.1.1.1.1" style="font-size:80%;">3</span></span><span class="ltx_text" id="alg1.1.1.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.1.1.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.1.1.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.1.1.5" style="font-size:80%;">
rgbImage </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.1.1.m1.1"><semantics id="alg1.1.1.m1.1a"><mo id="alg1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.1.1.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.1.1.m1.1b"><ci id="alg1.1.1.m1.1.1.cmml" xref="alg1.1.1.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.1.1.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.1.1.6" style="font-size:80%;"> LoadImage(rgbFile);</span>
</div>
<div class="ltx_listingline" id="alg1.2.2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.2.2.1.1.1" style="font-size:80%;">4</span></span><span class="ltx_text" id="alg1.2.2.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.2.2.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.2.2.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.2.2.5" style="font-size:80%;">
depthResults </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.2.2.m1.1"><semantics id="alg1.2.2.m1.1a"><mo id="alg1.2.2.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.2.2.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.2.2.m1.1b"><ci id="alg1.2.2.m1.1.1.cmml" xref="alg1.2.2.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.2.2.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.2.2.6" style="font-size:80%;"> {};</span>
</div>
<div class="ltx_listingline" id="alg1.3.3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.3.3.1.1.1" style="font-size:80%;">5</span></span><span class="ltx_text" id="alg1.3.3.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.3.3.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.3.3.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.3.3.5" style="font-size:80%;">
normalResults </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.3.3.m1.1"><semantics id="alg1.3.3.m1.1a"><mo id="alg1.3.3.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.3.3.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.3.3.m1.1b"><ci id="alg1.3.3.m1.1.1.cmml" xref="alg1.3.3.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.3.3.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.3.3.6" style="font-size:80%;"> {};</span>
</div>
<div class="ltx_listingline" id="alg1.4.4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.4.4.1.1.1" style="font-size:80%;">6</span></span><span class="ltx_text" id="alg1.4.4.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.4.4.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.4.4.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.4.4.5" style="font-size:80%;">
depthPaths </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.4.4.m1.1"><semantics id="alg1.4.4.m1.1a"><mo id="alg1.4.4.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.4.4.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.4.4.m1.1b"><ci id="alg1.4.4.m1.1.1.cmml" xref="alg1.4.4.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.4.4.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.4.4.6" style="font-size:80%;"> {};</span>
</div>
<div class="ltx_listingline" id="alg1.5.5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.5.5.1.1.1" style="font-size:80%;">7</span></span><span class="ltx_text" id="alg1.5.5.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.5.5.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.5.5.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.5.5.5" style="font-size:80%;">
normalPaths </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.5.5.m1.1"><semantics id="alg1.5.5.m1.1a"><mo id="alg1.5.5.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.5.5.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.5.5.m1.1b"><ci id="alg1.5.5.m1.1.1.cmml" xref="alg1.5.5.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.5.5.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.5.5.6" style="font-size:80%;"> {};</span>
</div>
<div class="ltx_listingline" id="alg1.38.43">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.43.1.1.1" style="font-size:80%;">8</span></span><span class="ltx_text" id="alg1.38.43.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.43.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.43.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.43.5" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.38.43.6" style="font-size:80%;">foreach</span><span class="ltx_text" id="alg1.38.43.7" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.38.43.8" style="font-size:80%;">modelFolder in modelFolders</em><span class="ltx_text" id="alg1.38.43.9" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.38.43.10" style="font-size:80%;">do</span>
</div>
<div class="ltx_listingline" id="alg1.6.6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.6.6.1.1.1" style="font-size:80%;">9</span></span><span class="ltx_text" id="alg1.6.6.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.6.6.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.6.6.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.6.6.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.6.6.6" style="font-size:80%;">
depthFile </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.6.6.m1.1"><semantics id="alg1.6.6.m1.1a"><mo id="alg1.6.6.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.6.6.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.6.6.m1.1b"><ci id="alg1.6.6.m1.1.1.cmml" xref="alg1.6.6.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.6.6.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.6.6.7" style="font-size:80%;"> FindCorrespondingDepthFile(rgbFile, modelFolder);</span>
</div>
<div class="ltx_listingline" id="alg1.7.7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.7.7.1.1.1" style="font-size:80%;">10</span></span><span class="ltx_text" id="alg1.7.7.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.7.7.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.7.7.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.7.7.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.7.7.6" style="font-size:80%;">
normalFile </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.7.7.m1.1"><semantics id="alg1.7.7.m1.1a"><mo id="alg1.7.7.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.7.7.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.7.7.m1.1b"><ci id="alg1.7.7.m1.1.1.cmml" xref="alg1.7.7.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.7.7.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.7.7.7" style="font-size:80%;"> FindCorrespondingNormalFile(rgbFile, modelFolder);</span>
</div>
<div class="ltx_listingline" id="alg1.9.9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.9.9.3.1.1" style="font-size:80%;">11</span></span><span class="ltx_text" id="alg1.9.9.4" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.9.9.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.9.9.6" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.9.9.7" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.9.9.8" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.9.9.9" style="font-size:80%;">if</span><span class="ltx_text" id="alg1.9.9.10" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.9.9.2" style="font-size:80%;">depthFile <math alttext="\neq" class="ltx_Math" display="inline" id="alg1.8.8.1.m1.1"><semantics id="alg1.8.8.1.m1.1a"><mo id="alg1.8.8.1.m1.1.1" xref="alg1.8.8.1.m1.1.1.cmml">≠</mo><annotation-xml encoding="MathML-Content" id="alg1.8.8.1.m1.1b"><neq id="alg1.8.8.1.m1.1.1.cmml" xref="alg1.8.8.1.m1.1.1"></neq></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.1.m1.1c">\neq</annotation><annotation encoding="application/x-llamapun" id="alg1.8.8.1.m1.1d">≠</annotation></semantics></math> null <span class="ltx_text ltx_font_bold" id="alg1.9.9.2.1">and</span> normalFile <math alttext="\neq" class="ltx_Math" display="inline" id="alg1.9.9.2.m2.1"><semantics id="alg1.9.9.2.m2.1a"><mo id="alg1.9.9.2.m2.1.1" xref="alg1.9.9.2.m2.1.1.cmml">≠</mo><annotation-xml encoding="MathML-Content" id="alg1.9.9.2.m2.1b"><neq id="alg1.9.9.2.m2.1.1.cmml" xref="alg1.9.9.2.m2.1.1"></neq></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.2.m2.1c">\neq</annotation><annotation encoding="application/x-llamapun" id="alg1.9.9.2.m2.1d">≠</annotation></semantics></math> null</em><span class="ltx_text" id="alg1.9.9.11" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.9.9.12" style="font-size:80%;">then</span>
</div>
<div class="ltx_listingline" id="alg1.10.10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.10.10.1.1.1" style="font-size:80%;">12</span></span><span class="ltx_text" id="alg1.10.10.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.10.10.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.10.10.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.10.10.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.10.10.6" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.10.10.7" style="font-size:80%;">
depthMap </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.10.10.m1.1"><semantics id="alg1.10.10.m1.1a"><mo id="alg1.10.10.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.10.10.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.10.10.m1.1b"><ci id="alg1.10.10.m1.1.1.cmml" xref="alg1.10.10.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.10.10.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.10.10.8" style="font-size:80%;"> LoadDepthMap(depthFile);</span>
</div>
<div class="ltx_listingline" id="alg1.11.11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.11.11.1.1.1" style="font-size:80%;">13</span></span><span class="ltx_text" id="alg1.11.11.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.11.11.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.11.11.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.11.11.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.11.11.6" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.11.11.7" style="font-size:80%;">
normalMap </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.11.11.m1.1"><semantics id="alg1.11.11.m1.1a"><mo id="alg1.11.11.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.11.11.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.11.11.m1.1b"><ci id="alg1.11.11.m1.1.1.cmml" xref="alg1.11.11.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.11.11.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.11.11.8" style="font-size:80%;"> LoadNormalMap(normalFile);</span>
</div>
<div class="ltx_listingline" id="alg1.12.12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.12.12.1.1.1" style="font-size:80%;">14</span></span><span class="ltx_text" id="alg1.12.12.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.12.12.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.12.12.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.12.12.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.12.12.6" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.12.12.7" style="font-size:80%;">
depthResult </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.12.12.m1.1"><semantics id="alg1.12.12.m1.1a"><mo id="alg1.12.12.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.12.12.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.12.12.m1.1b"><ci id="alg1.12.12.m1.1.1.cmml" xref="alg1.12.12.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.12.12.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.12.12.8" style="font-size:80%;"> EvaluateDepthMap(depthMap, rgbImage);</span>
</div>
<div class="ltx_listingline" id="alg1.13.13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.13.13.1.1.1" style="font-size:80%;">15</span></span><span class="ltx_text" id="alg1.13.13.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.13.13.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.13.13.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.13.13.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.13.13.6" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.13.13.7" style="font-size:80%;">
normalResult </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.13.13.m1.1"><semantics id="alg1.13.13.m1.1a"><mo id="alg1.13.13.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.13.13.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.13.13.m1.1b"><ci id="alg1.13.13.m1.1.1.cmml" xref="alg1.13.13.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.13.13.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.13.13.8" style="font-size:80%;"> EvaluateNormalMap(normalMap, rgbImage);</span>
</div>
<div class="ltx_listingline" id="alg1.38.44">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.44.1.1.1" style="font-size:80%;">16</span></span><span class="ltx_text" id="alg1.38.44.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.44.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.44.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.44.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.44.6" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.44.7" style="font-size:80%;">
depthResults.append(depthResult);</span>
</div>
<div class="ltx_listingline" id="alg1.38.45">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.45.1.1.1" style="font-size:80%;">17</span></span><span class="ltx_text" id="alg1.38.45.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.45.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.45.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.45.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.45.6" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.45.7" style="font-size:80%;">
normalResults.append(normalResult);</span>
</div>
<div class="ltx_listingline" id="alg1.38.46">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.46.1.1.1" style="font-size:80%;">18</span></span><span class="ltx_text" id="alg1.38.46.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.46.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.46.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.46.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.46.6" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.46.7" style="font-size:80%;">
depthPaths.append(depthFile);</span>
</div>
<div class="ltx_listingline" id="alg1.38.47">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.47.1.1.1" style="font-size:80%;">19</span></span><span class="ltx_text" id="alg1.38.47.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.47.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.47.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.47.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.47.6" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.47.7" style="font-size:80%;">
normalPaths.append(normalFile);</span>
</div>
<div class="ltx_listingline" id="alg1.38.48">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.48.1.1.1" style="font-size:80%;">20</span></span><span class="ltx_text" id="alg1.38.48.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.48.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.48.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.48.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.48.6" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.48.7" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.38.49">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.49.1.1.1" style="font-size:80%;">21</span></span><span class="ltx_text" id="alg1.38.49.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.49.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.49.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.49.5" style="font-size:80%;">   </span>
</div>
<div class="ltx_listingline" id="alg1.15.15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.15.15.3.1.1" style="font-size:80%;">22</span></span><span class="ltx_text" id="alg1.15.15.4" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.15.15.5" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.15.15.6" style="font-size:80%;">   </span><span class="ltx_text ltx_font_bold" id="alg1.15.15.7" style="font-size:80%;">if</span><span class="ltx_text" id="alg1.15.15.8" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.15.15.2" style="font-size:80%;">depthResults <math alttext="\neq" class="ltx_Math" display="inline" id="alg1.14.14.1.m1.1"><semantics id="alg1.14.14.1.m1.1a"><mo id="alg1.14.14.1.m1.1.1" xref="alg1.14.14.1.m1.1.1.cmml">≠</mo><annotation-xml encoding="MathML-Content" id="alg1.14.14.1.m1.1b"><neq id="alg1.14.14.1.m1.1.1.cmml" xref="alg1.14.14.1.m1.1.1"></neq></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.1.m1.1c">\neq</annotation><annotation encoding="application/x-llamapun" id="alg1.14.14.1.m1.1d">≠</annotation></semantics></math> <span class="ltx_text ltx_font_upright" id="alg1.15.15.2.1">{}</span> <span class="ltx_text ltx_font_bold" id="alg1.15.15.2.2">and</span> normalResults <math alttext="\neq" class="ltx_Math" display="inline" id="alg1.15.15.2.m2.1"><semantics id="alg1.15.15.2.m2.1a"><mo id="alg1.15.15.2.m2.1.1" xref="alg1.15.15.2.m2.1.1.cmml">≠</mo><annotation-xml encoding="MathML-Content" id="alg1.15.15.2.m2.1b"><neq id="alg1.15.15.2.m2.1.1.cmml" xref="alg1.15.15.2.m2.1.1"></neq></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.2.m2.1c">\neq</annotation><annotation encoding="application/x-llamapun" id="alg1.15.15.2.m2.1d">≠</annotation></semantics></math> <span class="ltx_text ltx_font_upright" id="alg1.15.15.2.3">{}</span></em><span class="ltx_text" id="alg1.15.15.9" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.15.15.10" style="font-size:80%;">then</span>
</div>
<div class="ltx_listingline" id="alg1.16.16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.16.16.1.1.1" style="font-size:80%;">23</span></span><span class="ltx_text" id="alg1.16.16.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.16.16.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.16.16.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.16.16.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.16.16.6" style="font-size:80%;">
bestIndex </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.16.16.m1.1"><semantics id="alg1.16.16.m1.1a"><mo id="alg1.16.16.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.16.16.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.16.16.m1.1b"><ci id="alg1.16.16.m1.1.1.cmml" xref="alg1.16.16.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.16.16.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.16.16.7" style="font-size:80%;"> FindBestDepthNormalPair(depthResults, normalResults);</span>
</div>
<div class="ltx_listingline" id="alg1.17.17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.17.17.1.1.1" style="font-size:80%;">24</span></span><span class="ltx_text" id="alg1.17.17.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.17.17.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.17.17.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.17.17.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.17.17.6" style="font-size:80%;">
bestDepthPath </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.17.17.m1.1"><semantics id="alg1.17.17.m1.1a"><mo id="alg1.17.17.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.17.17.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.17.17.m1.1b"><ci id="alg1.17.17.m1.1.1.cmml" xref="alg1.17.17.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.17.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.17.17.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.17.17.7" style="font-size:80%;"> depthPaths[bestIndex];</span>
</div>
<div class="ltx_listingline" id="alg1.18.18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.18.18.1.1.1" style="font-size:80%;">25</span></span><span class="ltx_text" id="alg1.18.18.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.18.18.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.18.18.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.18.18.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.18.18.6" style="font-size:80%;">
bestNormalPath </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.18.18.m1.1"><semantics id="alg1.18.18.m1.1a"><mo id="alg1.18.18.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.18.18.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.18.18.m1.1b"><ci id="alg1.18.18.m1.1.1.cmml" xref="alg1.18.18.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.18.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.18.18.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.18.18.7" style="font-size:80%;"> normalPaths[bestIndex];</span>
</div>
<div class="ltx_listingline" id="alg1.38.50">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.50.1.1.1" style="font-size:80%;">26</span></span><span class="ltx_text" id="alg1.38.50.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.50.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.50.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.50.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.50.6" style="font-size:80%;">
CopyFile(bestDepthPath, outputFolder);</span>
</div>
<div class="ltx_listingline" id="alg1.38.51">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.51.1.1.1" style="font-size:80%;">27</span></span><span class="ltx_text" id="alg1.38.51.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.51.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.51.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.51.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.51.6" style="font-size:80%;">
CopyFile(bestNormalPath, outputFolder);</span>
</div>
<div class="ltx_listingline" id="alg1.38.52">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.52.1.1.1" style="font-size:80%;">28</span></span><span class="ltx_text" id="alg1.38.52.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.52.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.52.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.52.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.52.6" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.38.53">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.53.1.1.1" style="font-size:80%;">29</span></span><span class="ltx_text" id="alg1.38.53.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.53.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.53.4" style="font-size:80%;">   </span>
</div>
<div class="ltx_listingline" id="alg1.38.54">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.54.1.1.1" style="font-size:80%;">30</span></span><span class="ltx_text" id="alg1.38.54.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.54.3" style="font-size:80%;">   </span>
</div>
<div class="ltx_listingline" id="alg1.38.55">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.55.1.1.1" style="font-size:80%;">31</span></span><span class="ltx_text ltx_font_bold" id="alg1.38.55.2" style="font-size:80%;">Function</span><span class="ltx_text" id="alg1.38.55.3" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.38.55.4" style="font-size:80%;">EvaluateDepthMapdepthMap, rgbImage</em><span class="ltx_text ltx_font_bold" id="alg1.38.55.5" style="font-size:80%;">:</span>
</div>
<div class="ltx_listingline" id="alg1.19.19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.19.19.1.1.1" style="font-size:80%;">32</span></span><span class="ltx_text" id="alg1.19.19.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.19.19.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.19.19.4" style="font-size:80%;">
depthMap </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.19.19.m1.1"><semantics id="alg1.19.19.m1.1a"><mo id="alg1.19.19.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.19.19.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.19.19.m1.1b"><ci id="alg1.19.19.m1.1.1.cmml" xref="alg1.19.19.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.19.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.19.19.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.19.19.5" style="font-size:80%;"> NormalizeDepthMap(depthMap);</span>
</div>
<div class="ltx_listingline" id="alg1.20.20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.20.20.1.1.1" style="font-size:80%;">33</span></span><span class="ltx_text" id="alg1.20.20.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.20.20.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.20.20.4" style="font-size:80%;">
edgeConsistency </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.20.20.m1.1"><semantics id="alg1.20.20.m1.1a"><mo id="alg1.20.20.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.20.20.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.20.20.m1.1b"><ci id="alg1.20.20.m1.1.1.cmml" xref="alg1.20.20.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.20.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.20.20.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.20.20.5" style="font-size:80%;"> ComputeEdgeConsistency(depthMap, rgbImage);</span>
</div>
<div class="ltx_listingline" id="alg1.21.21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.21.21.1.1.1" style="font-size:80%;">34</span></span><span class="ltx_text" id="alg1.21.21.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.21.21.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.21.21.4" style="font-size:80%;">
localVariance </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.21.21.m1.1"><semantics id="alg1.21.21.m1.1a"><mo id="alg1.21.21.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.21.21.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.21.21.m1.1b"><ci id="alg1.21.21.m1.1.1.cmml" xref="alg1.21.21.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.21.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.21.21.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.21.21.5" style="font-size:80%;"> ComputeLocalDepthVariance(depthMap);</span>
</div>
<div class="ltx_listingline" id="alg1.22.22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.22.22.1.1.1" style="font-size:80%;">35</span></span><span class="ltx_text" id="alg1.22.22.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.22.22.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.22.22.4" style="font-size:80%;">
complexity </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.22.22.m1.1"><semantics id="alg1.22.22.m1.1a"><mo id="alg1.22.22.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.22.22.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.22.22.m1.1b"><ci id="alg1.22.22.m1.1.1.cmml" xref="alg1.22.22.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.22.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.22.22.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.22.22.5" style="font-size:80%;"> ComputeDepthComplexity(depthMap);</span>
</div>
<div class="ltx_listingline" id="alg1.23.23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.23.23.1.1.1" style="font-size:80%;">36</span></span><span class="ltx_text" id="alg1.23.23.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.23.23.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.23.23.4" style="font-size:80%;">
sharpness </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.23.23.m1.1"><semantics id="alg1.23.23.m1.1a"><mo id="alg1.23.23.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.23.23.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.23.23.m1.1b"><ci id="alg1.23.23.m1.1.1.cmml" xref="alg1.23.23.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.23.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.23.23.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.23.23.5" style="font-size:80%;"> ComputeSharpnessMetric(depthMap);</span>
</div>
<div class="ltx_listingline" id="alg1.38.56">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.56.1.1.1" style="font-size:80%;">37</span></span><span class="ltx_text" id="alg1.38.56.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.56.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.56.4" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.38.56.5" style="font-size:80%;">return</span><span class="ltx_text" id="alg1.38.56.6" style="font-size:80%;"> {edgeConsistency, localVariance, complexity, sharpness};</span>
</div>
<div class="ltx_listingline" id="alg1.38.57">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.57.1.1.1" style="font-size:80%;">38</span></span><span class="ltx_text" id="alg1.38.57.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.57.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.57.4" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.38.58">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.58.1.1.1" style="font-size:80%;">39</span></span><span class="ltx_text ltx_font_bold" id="alg1.38.58.2" style="font-size:80%;">Function</span><span class="ltx_text" id="alg1.38.58.3" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.38.58.4" style="font-size:80%;">EvaluateNormalMapnormalMap, rgbImage</em><span class="ltx_text ltx_font_bold" id="alg1.38.58.5" style="font-size:80%;">:</span>
</div>
<div class="ltx_listingline" id="alg1.24.24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.24.24.1.1.1" style="font-size:80%;">40</span></span><span class="ltx_text" id="alg1.24.24.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.24.24.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.24.24.4" style="font-size:80%;">
normalMap </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.24.24.m1.1"><semantics id="alg1.24.24.m1.1a"><mo id="alg1.24.24.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.24.24.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.24.24.m1.1b"><ci id="alg1.24.24.m1.1.1.cmml" xref="alg1.24.24.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.24.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.24.24.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.24.24.5" style="font-size:80%;"> NormalizeNormalMap(normalMap);</span>
</div>
<div class="ltx_listingline" id="alg1.25.25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.25.25.1.1.1" style="font-size:80%;">41</span></span><span class="ltx_text" id="alg1.25.25.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.25.25.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.25.25.4" style="font-size:80%;">
edgeConsistency </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.25.25.m1.1"><semantics id="alg1.25.25.m1.1a"><mo id="alg1.25.25.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.25.25.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.25.25.m1.1b"><ci id="alg1.25.25.m1.1.1.cmml" xref="alg1.25.25.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.25.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.25.25.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.25.25.5" style="font-size:80%;"> ComputeEdgeConsistency(normalMap, rgbImage);</span>
</div>
<div class="ltx_listingline" id="alg1.26.26">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.26.1.1.1" style="font-size:80%;">42</span></span><span class="ltx_text" id="alg1.26.26.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.26.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.26.26.4" style="font-size:80%;">
orientationVariance </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.26.26.m1.1"><semantics id="alg1.26.26.m1.1a"><mo id="alg1.26.26.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.26.26.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.26.26.m1.1b"><ci id="alg1.26.26.m1.1.1.cmml" xref="alg1.26.26.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.26.26.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.26.26.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.26.26.5" style="font-size:80%;"> ComputeNormalorientationVariance(normalMap);</span>
</div>
<div class="ltx_listingline" id="alg1.27.27">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.27.27.1.1.1" style="font-size:80%;">43</span></span><span class="ltx_text" id="alg1.27.27.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.27.27.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.27.27.4" style="font-size:80%;">
sharpness </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.27.27.m1.1"><semantics id="alg1.27.27.m1.1a"><mo id="alg1.27.27.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.27.27.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.27.27.m1.1b"><ci id="alg1.27.27.m1.1.1.cmml" xref="alg1.27.27.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.27.27.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.27.27.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.27.27.5" style="font-size:80%;"> ComputeSharpnessMetric(normalMap);</span>
</div>
<div class="ltx_listingline" id="alg1.38.59">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.59.1.1.1" style="font-size:80%;">44</span></span><span class="ltx_text" id="alg1.38.59.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.59.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.59.4" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.38.59.5" style="font-size:80%;">return</span><span class="ltx_text" id="alg1.38.59.6" style="font-size:80%;"> {edgeConsistency, orientationVariance, sharpness};</span>
</div>
<div class="ltx_listingline" id="alg1.38.60">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.60.1.1.1" style="font-size:80%;">45</span></span><span class="ltx_text" id="alg1.38.60.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.60.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.60.4" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.38.61">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.61.1.1.1" style="font-size:80%;">46</span></span><span class="ltx_text ltx_font_bold" id="alg1.38.61.2" style="font-size:80%;">Function</span><span class="ltx_text" id="alg1.38.61.3" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.38.61.4" style="font-size:80%;">FindBestDepthNormalPairdepthResults, normalResults</em><span class="ltx_text ltx_font_bold" id="alg1.38.61.5" style="font-size:80%;">:</span>
</div>
<div class="ltx_listingline" id="alg1.28.28">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.28.28.1.1.1" style="font-size:80%;">47</span></span><span class="ltx_text" id="alg1.28.28.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.28.28.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.28.28.4" style="font-size:80%;">
depthWeights </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.28.28.m1.1"><semantics id="alg1.28.28.m1.1a"><mo id="alg1.28.28.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.28.28.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.28.28.m1.1b"><ci id="alg1.28.28.m1.1.1.cmml" xref="alg1.28.28.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.28.28.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.28.28.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.28.28.5" style="font-size:80%;"> {edgeConsistency: 0.3, localVariance: -0.2, complexity: 0.2, sharpness: 0.3};</span>
</div>
<div class="ltx_listingline" id="alg1.29.29">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.29.29.1.1.1" style="font-size:80%;">48</span></span><span class="ltx_text" id="alg1.29.29.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.29.29.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.29.29.4" style="font-size:80%;">
normalWeights </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.29.29.m1.1"><semantics id="alg1.29.29.m1.1a"><mo id="alg1.29.29.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.29.29.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.29.29.m1.1b"><ci id="alg1.29.29.m1.1.1.cmml" xref="alg1.29.29.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.29.29.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.29.29.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.29.29.5" style="font-size:80%;"> {edgeConsistency: 0.4, orientationVariance: 0.4, sharpness: 0.2};</span>
</div>
<div class="ltx_listingline" id="alg1.30.30">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.30.30.1.1.1" style="font-size:80%;">49</span></span><span class="ltx_text" id="alg1.30.30.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.30.30.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.30.30.4" style="font-size:80%;">
combinedScores </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.30.30.m1.1"><semantics id="alg1.30.30.m1.1a"><mo id="alg1.30.30.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.30.30.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.30.30.m1.1b"><ci id="alg1.30.30.m1.1.1.cmml" xref="alg1.30.30.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.30.30.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.30.30.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.30.30.5" style="font-size:80%;"> {};</span>
</div>
<div class="ltx_listingline" id="alg1.38.62">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.62.1.1.1" style="font-size:80%;">50</span></span><span class="ltx_text" id="alg1.38.62.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.62.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.62.4" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.38.62.5" style="font-size:80%;">foreach</span><span class="ltx_text" id="alg1.38.62.6" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.38.62.7" style="font-size:80%;">(depthResult, normalResult) in zip(depthResults, normalResults)</em><span class="ltx_text" id="alg1.38.62.8" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.38.62.9" style="font-size:80%;">do</span>
</div>
<div class="ltx_listingline" id="alg1.31.31">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.31.31.1.1.1" style="font-size:80%;">51</span></span><span class="ltx_text" id="alg1.31.31.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.31.31.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.31.31.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.31.31.5" style="font-size:80%;">
depthScore </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.31.31.m1.1"><semantics id="alg1.31.31.m1.1a"><mo id="alg1.31.31.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.31.31.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.31.31.m1.1b"><ci id="alg1.31.31.m1.1.1.cmml" xref="alg1.31.31.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.31.31.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.31.31.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.31.31.6" style="font-size:80%;"> 0;</span>
</div>
<div class="ltx_listingline" id="alg1.32.32">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.32.32.1.1.1" style="font-size:80%;">52</span></span><span class="ltx_text" id="alg1.32.32.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.32.32.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.32.32.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.32.32.5" style="font-size:80%;">
normalScore </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.32.32.m1.1"><semantics id="alg1.32.32.m1.1a"><mo id="alg1.32.32.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.32.32.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.32.32.m1.1b"><ci id="alg1.32.32.m1.1.1.cmml" xref="alg1.32.32.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.32.32.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.32.32.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.32.32.6" style="font-size:80%;"> 0;</span>
</div>
<div class="ltx_listingline" id="alg1.38.63">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.63.1.1.1" style="font-size:80%;">53</span></span><span class="ltx_text" id="alg1.38.63.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.63.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.63.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.63.5" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.38.63.6" style="font-size:80%;">foreach</span><span class="ltx_text" id="alg1.38.63.7" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.38.63.8" style="font-size:80%;">metric in depthWeights</em><span class="ltx_text" id="alg1.38.63.9" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.38.63.10" style="font-size:80%;">do</span>
</div>
<div class="ltx_listingline" id="alg1.34.34">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.34.34.1.1.1" style="font-size:80%;">54</span></span><span class="ltx_text" id="alg1.34.34.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.34.34.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.34.34.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.34.34.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.34.34.6" style="font-size:80%;">
depthScore </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.33.33.m1.1"><semantics id="alg1.33.33.m1.1a"><mo id="alg1.33.33.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.33.33.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.33.33.m1.1b"><ci id="alg1.33.33.m1.1.1.cmml" xref="alg1.33.33.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.33.33.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.33.33.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.34.34.7" style="font-size:80%;"> depthScore + depthResult[metric] </span><math alttext="\times" class="ltx_Math" display="inline" id="alg1.34.34.m2.1"><semantics id="alg1.34.34.m2.1a"><mo id="alg1.34.34.m2.1.1" mathsize="80%" xref="alg1.34.34.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="alg1.34.34.m2.1b"><times id="alg1.34.34.m2.1.1.cmml" xref="alg1.34.34.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="alg1.34.34.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="alg1.34.34.m2.1d">×</annotation></semantics></math><span class="ltx_text" id="alg1.34.34.8" style="font-size:80%;"> depthWeights[metric];</span>
</div>
<div class="ltx_listingline" id="alg1.38.64">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.64.1.1.1" style="font-size:80%;">55</span></span><span class="ltx_text" id="alg1.38.64.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.64.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.64.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.64.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.64.6" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.38.65">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.65.1.1.1" style="font-size:80%;">56</span></span><span class="ltx_text" id="alg1.38.65.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.65.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.65.4" style="font-size:80%;">   </span><span class="ltx_text ltx_font_bold" id="alg1.38.65.5" style="font-size:80%;">foreach</span><span class="ltx_text" id="alg1.38.65.6" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.38.65.7" style="font-size:80%;">metric in normalWeights</em><span class="ltx_text" id="alg1.38.65.8" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.38.65.9" style="font-size:80%;">do</span>
</div>
<div class="ltx_listingline" id="alg1.36.36">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.36.36.1.1.1" style="font-size:80%;">57</span></span><span class="ltx_text" id="alg1.36.36.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.36.36.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.36.36.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.36.36.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.36.36.6" style="font-size:80%;">
normalScore </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.35.35.m1.1"><semantics id="alg1.35.35.m1.1a"><mo id="alg1.35.35.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.35.35.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.35.35.m1.1b"><ci id="alg1.35.35.m1.1.1.cmml" xref="alg1.35.35.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.35.35.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.35.35.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.36.36.7" style="font-size:80%;"> normalScore + normalResult[metric] </span><math alttext="\times" class="ltx_Math" display="inline" id="alg1.36.36.m2.1"><semantics id="alg1.36.36.m2.1a"><mo id="alg1.36.36.m2.1.1" mathsize="80%" xref="alg1.36.36.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="alg1.36.36.m2.1b"><times id="alg1.36.36.m2.1.1.cmml" xref="alg1.36.36.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="alg1.36.36.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="alg1.36.36.m2.1d">×</annotation></semantics></math><span class="ltx_text" id="alg1.36.36.8" style="font-size:80%;"> normalWeights[metric];</span>
</div>
<div class="ltx_listingline" id="alg1.38.66">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.66.1.1.1" style="font-size:80%;">58</span></span><span class="ltx_text" id="alg1.38.66.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.66.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.66.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.66.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.66.6" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.37.37">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.37.37.1.1.1" style="font-size:80%;">59</span></span><span class="ltx_text" id="alg1.37.37.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.37.37.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.37.37.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.37.37.5" style="font-size:80%;">combinedScore </span><math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.37.37.m1.1"><semantics id="alg1.37.37.m1.1a"><mo id="alg1.37.37.m1.1.1" mathsize="80%" stretchy="false" xref="alg1.37.37.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.37.37.m1.1b"><ci id="alg1.37.37.m1.1.1.cmml" xref="alg1.37.37.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.37.37.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.37.37.m1.1d">←</annotation></semantics></math><span class="ltx_text" id="alg1.37.37.6" style="font-size:80%;"> depthScore + normalScore;</span>
</div>
<div class="ltx_listingline" id="alg1.38.67">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.67.1.1.1" style="font-size:80%;">60</span></span><span class="ltx_text" id="alg1.38.67.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.67.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.67.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.67.5" style="font-size:80%;">
combinedScores.append(combinedScore);</span>
</div>
<div class="ltx_listingline" id="alg1.38.68">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.68.1.1.1" style="font-size:80%;">61</span></span><span class="ltx_text" id="alg1.38.68.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.68.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.68.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.68.5" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.38.38">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.38.1.1.1" style="font-size:80%;">62</span></span><span class="ltx_text" id="alg1.38.38.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.38.3" style="font-size:80%;">   </span><span class="ltx_text ltx_font_bold" id="alg1.38.38.4" style="font-size:80%;">return</span><span class="ltx_text" id="alg1.38.38.5" style="font-size:80%;"> </span><math alttext="\operatorname*{arg\,max}(combinedScores)" class="ltx_Math" display="inline" id="alg1.38.38.m1.2"><semantics id="alg1.38.38.m1.2a"><mrow id="alg1.38.38.m1.2.2.1" xref="alg1.38.38.m1.2.2.2.cmml"><mrow id="alg1.38.38.m1.1.1" xref="alg1.38.38.m1.1.1.cmml"><mi id="alg1.38.38.m1.1.1.2" mathsize="80%" xref="alg1.38.38.m1.1.1.2.cmml">arg</mi><mo id="alg1.38.38.m1.1.1.1" lspace="0.170em" xref="alg1.38.38.m1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.1.1.3" mathsize="80%" xref="alg1.38.38.m1.1.1.3.cmml">max</mi></mrow><mo id="alg1.38.38.m1.2.2.1a" xref="alg1.38.38.m1.2.2.2.cmml">⁡</mo><mrow id="alg1.38.38.m1.2.2.1.1" xref="alg1.38.38.m1.2.2.2.cmml"><mo id="alg1.38.38.m1.2.2.1.1.2" maxsize="80%" minsize="80%" xref="alg1.38.38.m1.2.2.2.cmml">(</mo><mrow id="alg1.38.38.m1.2.2.1.1.1" xref="alg1.38.38.m1.2.2.1.1.1.cmml"><mi id="alg1.38.38.m1.2.2.1.1.1.2" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.2.cmml">c</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.3" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.3.cmml">o</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1a" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.4" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.4.cmml">m</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1b" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.5" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.5.cmml">b</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1c" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.6" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.6.cmml">i</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1d" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.7" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.7.cmml">n</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1e" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.8" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.8.cmml">e</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1f" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.9" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.9.cmml">d</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1g" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.10" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.10.cmml">S</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1h" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.11" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.11.cmml">c</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1i" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.12" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.12.cmml">o</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1j" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.13" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.13.cmml">r</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1k" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.14" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.14.cmml">e</mi><mo id="alg1.38.38.m1.2.2.1.1.1.1l" xref="alg1.38.38.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="alg1.38.38.m1.2.2.1.1.1.15" mathsize="80%" xref="alg1.38.38.m1.2.2.1.1.1.15.cmml">s</mi></mrow><mo id="alg1.38.38.m1.2.2.1.1.3" maxsize="80%" minsize="80%" xref="alg1.38.38.m1.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.38.38.m1.2b"><apply id="alg1.38.38.m1.2.2.2.cmml" xref="alg1.38.38.m1.2.2.1"><apply id="alg1.38.38.m1.1.1.cmml" xref="alg1.38.38.m1.1.1"><times id="alg1.38.38.m1.1.1.1.cmml" xref="alg1.38.38.m1.1.1.1"></times><ci id="alg1.38.38.m1.1.1.2.cmml" xref="alg1.38.38.m1.1.1.2">arg</ci><ci id="alg1.38.38.m1.1.1.3.cmml" xref="alg1.38.38.m1.1.1.3">max</ci></apply><apply id="alg1.38.38.m1.2.2.1.1.1.cmml" xref="alg1.38.38.m1.2.2.1.1.1"><times id="alg1.38.38.m1.2.2.1.1.1.1.cmml" xref="alg1.38.38.m1.2.2.1.1.1.1"></times><ci id="alg1.38.38.m1.2.2.1.1.1.2.cmml" xref="alg1.38.38.m1.2.2.1.1.1.2">𝑐</ci><ci id="alg1.38.38.m1.2.2.1.1.1.3.cmml" xref="alg1.38.38.m1.2.2.1.1.1.3">𝑜</ci><ci id="alg1.38.38.m1.2.2.1.1.1.4.cmml" xref="alg1.38.38.m1.2.2.1.1.1.4">𝑚</ci><ci id="alg1.38.38.m1.2.2.1.1.1.5.cmml" xref="alg1.38.38.m1.2.2.1.1.1.5">𝑏</ci><ci id="alg1.38.38.m1.2.2.1.1.1.6.cmml" xref="alg1.38.38.m1.2.2.1.1.1.6">𝑖</ci><ci id="alg1.38.38.m1.2.2.1.1.1.7.cmml" xref="alg1.38.38.m1.2.2.1.1.1.7">𝑛</ci><ci id="alg1.38.38.m1.2.2.1.1.1.8.cmml" xref="alg1.38.38.m1.2.2.1.1.1.8">𝑒</ci><ci id="alg1.38.38.m1.2.2.1.1.1.9.cmml" xref="alg1.38.38.m1.2.2.1.1.1.9">𝑑</ci><ci id="alg1.38.38.m1.2.2.1.1.1.10.cmml" xref="alg1.38.38.m1.2.2.1.1.1.10">𝑆</ci><ci id="alg1.38.38.m1.2.2.1.1.1.11.cmml" xref="alg1.38.38.m1.2.2.1.1.1.11">𝑐</ci><ci id="alg1.38.38.m1.2.2.1.1.1.12.cmml" xref="alg1.38.38.m1.2.2.1.1.1.12">𝑜</ci><ci id="alg1.38.38.m1.2.2.1.1.1.13.cmml" xref="alg1.38.38.m1.2.2.1.1.1.13">𝑟</ci><ci id="alg1.38.38.m1.2.2.1.1.1.14.cmml" xref="alg1.38.38.m1.2.2.1.1.1.14">𝑒</ci><ci id="alg1.38.38.m1.2.2.1.1.1.15.cmml" xref="alg1.38.38.m1.2.2.1.1.1.15">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.38.38.m1.2c">\operatorname*{arg\,max}(combinedScores)</annotation><annotation encoding="application/x-llamapun" id="alg1.38.38.m1.2d">start_OPERATOR roman_arg roman_max end_OPERATOR ( italic_c italic_o italic_m italic_b italic_i italic_n italic_e italic_d italic_S italic_c italic_o italic_r italic_e italic_s )</annotation></semantics></math><span class="ltx_text" id="alg1.38.38.6" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.38.69">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.38.69.1.1.1" style="font-size:80%;">63</span></span><span class="ltx_text" id="alg1.38.69.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.38.69.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.38.69.4" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.38.70">
</div>
</div>
<figcaption class="ltx_caption" style="font-size:80%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.42.1.1">Algorithm 1</span> </span>Depth Normal Evaluation and Selection Algorithm (DNESA)</figcaption>
</figure>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_font_bold ltx_title_paragraph">Depth Normal Evaluation and Selection Algorithm (DNESA):</h5>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.1">The Depth Normal Evaluation and Selection Algorithm (DNESA), as outlined in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#alg1" title="Algorithm 1 ‣ 3.2 Step 1: Pseudo-Labelled Data Generation ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">1</span></a>, addresses the challenge of noisy labels commonly present in real-world underwater datasets. DNESA systematically evaluates the quality of pseudo-depth maps and surface normals derived from unlabelled underwater images, leveraging multiple pre-trained models. The algorithm assesses these outputs using a set of predefined metrics and selects the most reliable data to train a lightweight student model.
DNESA operates in two primary stages. The first stage involves evaluating the pseudo-labeled data by computing several critical metrics:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p2">
<ul class="ltx_itemize" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.4"><span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.4.1">Edge Consistency:</span> This metric quantifies the alignment between the edges of the depth map or surface normal map and the corresponding edges in the RGB image. Given an RGB image <math alttext="\mathbf{I}_{\text{RGB}}" class="ltx_Math" display="inline" id="S3.I2.i1.p1.1.m1.1"><semantics id="S3.I2.i1.p1.1.m1.1a"><msub id="S3.I2.i1.p1.1.m1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.cmml"><mi id="S3.I2.i1.p1.1.m1.1.1.2" xref="S3.I2.i1.p1.1.m1.1.1.2.cmml">𝐈</mi><mtext id="S3.I2.i1.p1.1.m1.1.1.3" xref="S3.I2.i1.p1.1.m1.1.1.3a.cmml">RGB</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.m1.1b"><apply id="S3.I2.i1.p1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i1.p1.1.m1.1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I2.i1.p1.1.m1.1.1.2.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2">𝐈</ci><ci id="S3.I2.i1.p1.1.m1.1.1.3a.cmml" xref="S3.I2.i1.p1.1.m1.1.1.3"><mtext id="S3.I2.i1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.I2.i1.p1.1.m1.1.1.3">RGB</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.m1.1c">\mathbf{I}_{\text{RGB}}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.1.m1.1d">bold_I start_POSTSUBSCRIPT RGB end_POSTSUBSCRIPT</annotation></semantics></math> and a depth map <math alttext="\mathbf{D}" class="ltx_Math" display="inline" id="S3.I2.i1.p1.2.m2.1"><semantics id="S3.I2.i1.p1.2.m2.1a"><mi id="S3.I2.i1.p1.2.m2.1.1" xref="S3.I2.i1.p1.2.m2.1.1.cmml">𝐃</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.2.m2.1b"><ci id="S3.I2.i1.p1.2.m2.1.1.cmml" xref="S3.I2.i1.p1.2.m2.1.1">𝐃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.2.m2.1c">\mathbf{D}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.2.m2.1d">bold_D</annotation></semantics></math>, edge consistency is evaluated as:
<math alttext="E_{c}=\frac{|\nabla\mathbf{D}|\cap|\nabla\mathbf{I}_{\text{RGB}}|}{|\nabla%
\mathbf{I}_{\text{RGB}}|}" class="ltx_Math" display="inline" id="S3.I2.i1.p1.3.m3.3"><semantics id="S3.I2.i1.p1.3.m3.3a"><mrow id="S3.I2.i1.p1.3.m3.3.4" xref="S3.I2.i1.p1.3.m3.3.4.cmml"><msub id="S3.I2.i1.p1.3.m3.3.4.2" xref="S3.I2.i1.p1.3.m3.3.4.2.cmml"><mi id="S3.I2.i1.p1.3.m3.3.4.2.2" xref="S3.I2.i1.p1.3.m3.3.4.2.2.cmml">E</mi><mi id="S3.I2.i1.p1.3.m3.3.4.2.3" xref="S3.I2.i1.p1.3.m3.3.4.2.3.cmml">c</mi></msub><mo id="S3.I2.i1.p1.3.m3.3.4.1" xref="S3.I2.i1.p1.3.m3.3.4.1.cmml">=</mo><mfrac id="S3.I2.i1.p1.3.m3.3.3" xref="S3.I2.i1.p1.3.m3.3.3.cmml"><mrow id="S3.I2.i1.p1.3.m3.2.2.2" xref="S3.I2.i1.p1.3.m3.2.2.2.cmml"><mrow id="S3.I2.i1.p1.3.m3.1.1.1.1.1" xref="S3.I2.i1.p1.3.m3.1.1.1.1.2.cmml"><mo id="S3.I2.i1.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S3.I2.i1.p1.3.m3.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.I2.i1.p1.3.m3.1.1.1.1.1.1" xref="S3.I2.i1.p1.3.m3.1.1.1.1.1.1.cmml"><mo id="S3.I2.i1.p1.3.m3.1.1.1.1.1.1.1" rspace="0.167em" xref="S3.I2.i1.p1.3.m3.1.1.1.1.1.1.1.cmml">∇</mo><mi id="S3.I2.i1.p1.3.m3.1.1.1.1.1.1.2" xref="S3.I2.i1.p1.3.m3.1.1.1.1.1.1.2.cmml">𝐃</mi></mrow><mo id="S3.I2.i1.p1.3.m3.1.1.1.1.1.3" stretchy="false" xref="S3.I2.i1.p1.3.m3.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.I2.i1.p1.3.m3.2.2.2.3" xref="S3.I2.i1.p1.3.m3.2.2.2.3.cmml">∩</mo><mrow id="S3.I2.i1.p1.3.m3.2.2.2.2.1" xref="S3.I2.i1.p1.3.m3.2.2.2.2.2.cmml"><mo id="S3.I2.i1.p1.3.m3.2.2.2.2.1.2" stretchy="false" xref="S3.I2.i1.p1.3.m3.2.2.2.2.2.1.cmml">|</mo><mrow id="S3.I2.i1.p1.3.m3.2.2.2.2.1.1" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.cmml"><mo id="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.1" rspace="0.167em" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.1.cmml">∇</mo><msub id="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.cmml"><mi id="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.2" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.2.cmml">𝐈</mi><mtext id="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.3" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.3a.cmml">RGB</mtext></msub></mrow><mo id="S3.I2.i1.p1.3.m3.2.2.2.2.1.3" stretchy="false" xref="S3.I2.i1.p1.3.m3.2.2.2.2.2.1.cmml">|</mo></mrow></mrow><mrow id="S3.I2.i1.p1.3.m3.3.3.3.1" xref="S3.I2.i1.p1.3.m3.3.3.3.2.cmml"><mo id="S3.I2.i1.p1.3.m3.3.3.3.1.2" stretchy="false" xref="S3.I2.i1.p1.3.m3.3.3.3.2.1.cmml">|</mo><mrow id="S3.I2.i1.p1.3.m3.3.3.3.1.1" xref="S3.I2.i1.p1.3.m3.3.3.3.1.1.cmml"><mo id="S3.I2.i1.p1.3.m3.3.3.3.1.1.1" rspace="0.167em" xref="S3.I2.i1.p1.3.m3.3.3.3.1.1.1.cmml">∇</mo><msub id="S3.I2.i1.p1.3.m3.3.3.3.1.1.2" xref="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.cmml"><mi id="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.2" xref="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.2.cmml">𝐈</mi><mtext id="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.3" xref="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.3a.cmml">RGB</mtext></msub></mrow><mo id="S3.I2.i1.p1.3.m3.3.3.3.1.3" stretchy="false" xref="S3.I2.i1.p1.3.m3.3.3.3.2.1.cmml">|</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.3.m3.3b"><apply id="S3.I2.i1.p1.3.m3.3.4.cmml" xref="S3.I2.i1.p1.3.m3.3.4"><eq id="S3.I2.i1.p1.3.m3.3.4.1.cmml" xref="S3.I2.i1.p1.3.m3.3.4.1"></eq><apply id="S3.I2.i1.p1.3.m3.3.4.2.cmml" xref="S3.I2.i1.p1.3.m3.3.4.2"><csymbol cd="ambiguous" id="S3.I2.i1.p1.3.m3.3.4.2.1.cmml" xref="S3.I2.i1.p1.3.m3.3.4.2">subscript</csymbol><ci id="S3.I2.i1.p1.3.m3.3.4.2.2.cmml" xref="S3.I2.i1.p1.3.m3.3.4.2.2">𝐸</ci><ci id="S3.I2.i1.p1.3.m3.3.4.2.3.cmml" xref="S3.I2.i1.p1.3.m3.3.4.2.3">𝑐</ci></apply><apply id="S3.I2.i1.p1.3.m3.3.3.cmml" xref="S3.I2.i1.p1.3.m3.3.3"><divide id="S3.I2.i1.p1.3.m3.3.3.4.cmml" xref="S3.I2.i1.p1.3.m3.3.3"></divide><apply id="S3.I2.i1.p1.3.m3.2.2.2.cmml" xref="S3.I2.i1.p1.3.m3.2.2.2"><intersect id="S3.I2.i1.p1.3.m3.2.2.2.3.cmml" xref="S3.I2.i1.p1.3.m3.2.2.2.3"></intersect><apply id="S3.I2.i1.p1.3.m3.1.1.1.1.2.cmml" xref="S3.I2.i1.p1.3.m3.1.1.1.1.1"><abs id="S3.I2.i1.p1.3.m3.1.1.1.1.2.1.cmml" xref="S3.I2.i1.p1.3.m3.1.1.1.1.1.2"></abs><apply id="S3.I2.i1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.I2.i1.p1.3.m3.1.1.1.1.1.1"><ci id="S3.I2.i1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.I2.i1.p1.3.m3.1.1.1.1.1.1.1">∇</ci><ci id="S3.I2.i1.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.I2.i1.p1.3.m3.1.1.1.1.1.1.2">𝐃</ci></apply></apply><apply id="S3.I2.i1.p1.3.m3.2.2.2.2.2.cmml" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1"><abs id="S3.I2.i1.p1.3.m3.2.2.2.2.2.1.cmml" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.2"></abs><apply id="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.cmml" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.1"><ci id="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.1.cmml" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.1">∇</ci><apply id="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.cmml" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.1.cmml" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.2.cmml" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.2">𝐈</ci><ci id="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.3a.cmml" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.3"><mtext id="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.3.cmml" mathsize="50%" xref="S3.I2.i1.p1.3.m3.2.2.2.2.1.1.2.3">RGB</mtext></ci></apply></apply></apply></apply><apply id="S3.I2.i1.p1.3.m3.3.3.3.2.cmml" xref="S3.I2.i1.p1.3.m3.3.3.3.1"><abs id="S3.I2.i1.p1.3.m3.3.3.3.2.1.cmml" xref="S3.I2.i1.p1.3.m3.3.3.3.1.2"></abs><apply id="S3.I2.i1.p1.3.m3.3.3.3.1.1.cmml" xref="S3.I2.i1.p1.3.m3.3.3.3.1.1"><ci id="S3.I2.i1.p1.3.m3.3.3.3.1.1.1.cmml" xref="S3.I2.i1.p1.3.m3.3.3.3.1.1.1">∇</ci><apply id="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.cmml" xref="S3.I2.i1.p1.3.m3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.1.cmml" xref="S3.I2.i1.p1.3.m3.3.3.3.1.1.2">subscript</csymbol><ci id="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.2.cmml" xref="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.2">𝐈</ci><ci id="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.3a.cmml" xref="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.3"><mtext id="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.3.cmml" mathsize="50%" xref="S3.I2.i1.p1.3.m3.3.3.3.1.1.2.3">RGB</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.3.m3.3c">E_{c}=\frac{|\nabla\mathbf{D}|\cap|\nabla\mathbf{I}_{\text{RGB}}|}{|\nabla%
\mathbf{I}_{\text{RGB}}|}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.3.m3.3d">italic_E start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = divide start_ARG | ∇ bold_D | ∩ | ∇ bold_I start_POSTSUBSCRIPT RGB end_POSTSUBSCRIPT | end_ARG start_ARG | ∇ bold_I start_POSTSUBSCRIPT RGB end_POSTSUBSCRIPT | end_ARG</annotation></semantics></math>
where <math alttext="\nabla" class="ltx_Math" display="inline" id="S3.I2.i1.p1.4.m4.1"><semantics id="S3.I2.i1.p1.4.m4.1a"><mo id="S3.I2.i1.p1.4.m4.1.1" xref="S3.I2.i1.p1.4.m4.1.1.cmml">∇</mo><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.4.m4.1b"><ci id="S3.I2.i1.p1.4.m4.1.1.cmml" xref="S3.I2.i1.p1.4.m4.1.1">∇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.4.m4.1c">\nabla</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.4.m4.1d">∇</annotation></semantics></math> denotes the gradient operation.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.6"><span class="ltx_text ltx_font_bold" id="S3.I2.i2.p1.6.1">Local Variance:</span> Measures the variability of depth values or surface normal orientations within local neighbourhoods. For a depth map <math alttext="\mathbf{D}" class="ltx_Math" display="inline" id="S3.I2.i2.p1.1.m1.1"><semantics id="S3.I2.i2.p1.1.m1.1a"><mi id="S3.I2.i2.p1.1.m1.1.1" xref="S3.I2.i2.p1.1.m1.1.1.cmml">𝐃</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.1.m1.1b"><ci id="S3.I2.i2.p1.1.m1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.1.1">𝐃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.1.m1.1c">\mathbf{D}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.1.m1.1d">bold_D</annotation></semantics></math>, local variance <math alttext="V" class="ltx_Math" display="inline" id="S3.I2.i2.p1.2.m2.1"><semantics id="S3.I2.i2.p1.2.m2.1a"><mi id="S3.I2.i2.p1.2.m2.1.1" xref="S3.I2.i2.p1.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.2.m2.1b"><ci id="S3.I2.i2.p1.2.m2.1.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.2.m2.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.2.m2.1d">italic_V</annotation></semantics></math> within a window <math alttext="W" class="ltx_Math" display="inline" id="S3.I2.i2.p1.3.m3.1"><semantics id="S3.I2.i2.p1.3.m3.1a"><mi id="S3.I2.i2.p1.3.m3.1.1" xref="S3.I2.i2.p1.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.3.m3.1b"><ci id="S3.I2.i2.p1.3.m3.1.1.cmml" xref="S3.I2.i2.p1.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.3.m3.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.3.m3.1d">italic_W</annotation></semantics></math> is computed as:
<math alttext="V=\frac{1}{|W|}\sum_{i\in W}\left(D_{i}-\mu_{W}\right)^{2}," class="ltx_Math" display="inline" id="S3.I2.i2.p1.4.m4.2"><semantics id="S3.I2.i2.p1.4.m4.2a"><mrow id="S3.I2.i2.p1.4.m4.2.2.1" xref="S3.I2.i2.p1.4.m4.2.2.1.1.cmml"><mrow id="S3.I2.i2.p1.4.m4.2.2.1.1" xref="S3.I2.i2.p1.4.m4.2.2.1.1.cmml"><mi id="S3.I2.i2.p1.4.m4.2.2.1.1.3" xref="S3.I2.i2.p1.4.m4.2.2.1.1.3.cmml">V</mi><mo id="S3.I2.i2.p1.4.m4.2.2.1.1.2" xref="S3.I2.i2.p1.4.m4.2.2.1.1.2.cmml">=</mo><mrow id="S3.I2.i2.p1.4.m4.2.2.1.1.1" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.cmml"><mfrac id="S3.I2.i2.p1.4.m4.1.1" xref="S3.I2.i2.p1.4.m4.1.1.cmml"><mn id="S3.I2.i2.p1.4.m4.1.1.3" xref="S3.I2.i2.p1.4.m4.1.1.3.cmml">1</mn><mrow id="S3.I2.i2.p1.4.m4.1.1.1.3" xref="S3.I2.i2.p1.4.m4.1.1.1.2.cmml"><mo id="S3.I2.i2.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S3.I2.i2.p1.4.m4.1.1.1.2.1.cmml">|</mo><mi id="S3.I2.i2.p1.4.m4.1.1.1.1" xref="S3.I2.i2.p1.4.m4.1.1.1.1.cmml">W</mi><mo id="S3.I2.i2.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S3.I2.i2.p1.4.m4.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.I2.i2.p1.4.m4.2.2.1.1.1.2" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.cmml"><msub id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.cmml"><mo id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.2" rspace="0em" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.cmml"><mi id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.2" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.1" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.1.cmml">∈</mo><mi id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.3" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.3.cmml">W</mi></mrow></msub><msup id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.cmml"><mrow id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.2" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.2.cmml">D</mi><mi id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.1" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.2.cmml">μ</mi><mi id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.3.cmml">W</mi></msub></mrow><mo id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.3" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.3" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S3.I2.i2.p1.4.m4.2.2.1.2" xref="S3.I2.i2.p1.4.m4.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.4.m4.2b"><apply id="S3.I2.i2.p1.4.m4.2.2.1.1.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1"><eq id="S3.I2.i2.p1.4.m4.2.2.1.1.2.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.2"></eq><ci id="S3.I2.i2.p1.4.m4.2.2.1.1.3.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.3">𝑉</ci><apply id="S3.I2.i2.p1.4.m4.2.2.1.1.1.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1"><times id="S3.I2.i2.p1.4.m4.2.2.1.1.1.2.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.2"></times><apply id="S3.I2.i2.p1.4.m4.1.1.cmml" xref="S3.I2.i2.p1.4.m4.1.1"><divide id="S3.I2.i2.p1.4.m4.1.1.2.cmml" xref="S3.I2.i2.p1.4.m4.1.1"></divide><cn id="S3.I2.i2.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.I2.i2.p1.4.m4.1.1.3">1</cn><apply id="S3.I2.i2.p1.4.m4.1.1.1.2.cmml" xref="S3.I2.i2.p1.4.m4.1.1.1.3"><abs id="S3.I2.i2.p1.4.m4.1.1.1.2.1.cmml" xref="S3.I2.i2.p1.4.m4.1.1.1.3.1"></abs><ci id="S3.I2.i2.p1.4.m4.1.1.1.1.cmml" xref="S3.I2.i2.p1.4.m4.1.1.1.1">𝑊</ci></apply></apply><apply id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1"><apply id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.1.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2">subscript</csymbol><sum id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.2.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.2"></sum><apply id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3"><in id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.1.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.1"></in><ci id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.2.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.3.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.2.3.3">𝑊</ci></apply></apply><apply id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.2.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1"><minus id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.2">𝐷</ci><ci id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.2">𝜇</ci><ci id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.3">𝑊</ci></apply></apply><cn id="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S3.I2.i2.p1.4.m4.2.2.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.4.m4.2c">V=\frac{1}{|W|}\sum_{i\in W}\left(D_{i}-\mu_{W}\right)^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.4.m4.2d">italic_V = divide start_ARG 1 end_ARG start_ARG | italic_W | end_ARG ∑ start_POSTSUBSCRIPT italic_i ∈ italic_W end_POSTSUBSCRIPT ( italic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT italic_W end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math>
where <math alttext="\mu_{W}" class="ltx_Math" display="inline" id="S3.I2.i2.p1.5.m5.1"><semantics id="S3.I2.i2.p1.5.m5.1a"><msub id="S3.I2.i2.p1.5.m5.1.1" xref="S3.I2.i2.p1.5.m5.1.1.cmml"><mi id="S3.I2.i2.p1.5.m5.1.1.2" xref="S3.I2.i2.p1.5.m5.1.1.2.cmml">μ</mi><mi id="S3.I2.i2.p1.5.m5.1.1.3" xref="S3.I2.i2.p1.5.m5.1.1.3.cmml">W</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.5.m5.1b"><apply id="S3.I2.i2.p1.5.m5.1.1.cmml" xref="S3.I2.i2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.I2.i2.p1.5.m5.1.1.1.cmml" xref="S3.I2.i2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.I2.i2.p1.5.m5.1.1.2.cmml" xref="S3.I2.i2.p1.5.m5.1.1.2">𝜇</ci><ci id="S3.I2.i2.p1.5.m5.1.1.3.cmml" xref="S3.I2.i2.p1.5.m5.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.5.m5.1c">\mu_{W}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.5.m5.1d">italic_μ start_POSTSUBSCRIPT italic_W end_POSTSUBSCRIPT</annotation></semantics></math> is the mean depth value within window <math alttext="W" class="ltx_Math" display="inline" id="S3.I2.i2.p1.6.m6.1"><semantics id="S3.I2.i2.p1.6.m6.1a"><mi id="S3.I2.i2.p1.6.m6.1.1" xref="S3.I2.i2.p1.6.m6.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.6.m6.1b"><ci id="S3.I2.i2.p1.6.m6.1.1.cmml" xref="S3.I2.i2.p1.6.m6.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.6.m6.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.6.m6.1d">italic_W</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i3.p1">
<p class="ltx_p" id="S3.I2.i3.p1.2"><span class="ltx_text ltx_font_bold" id="S3.I2.i3.p1.2.1">Complexity:</span> Complexity quantifies the structural intricacy of the depth map or surface normal map by assessing the spatial frequency content, expressed as:
<math alttext="C=\frac{1}{N}\sum_{i=1}^{N}|\nabla\mathbf{D}_{i}|," class="ltx_Math" display="inline" id="S3.I2.i3.p1.1.m1.1"><semantics id="S3.I2.i3.p1.1.m1.1a"><mrow id="S3.I2.i3.p1.1.m1.1.1.1" xref="S3.I2.i3.p1.1.m1.1.1.1.1.cmml"><mrow id="S3.I2.i3.p1.1.m1.1.1.1.1" xref="S3.I2.i3.p1.1.m1.1.1.1.1.cmml"><mi id="S3.I2.i3.p1.1.m1.1.1.1.1.3" xref="S3.I2.i3.p1.1.m1.1.1.1.1.3.cmml">C</mi><mo id="S3.I2.i3.p1.1.m1.1.1.1.1.2" xref="S3.I2.i3.p1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.I2.i3.p1.1.m1.1.1.1.1.1" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.cmml"><mfrac id="S3.I2.i3.p1.1.m1.1.1.1.1.1.3" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.3.cmml"><mn id="S3.I2.i3.p1.1.m1.1.1.1.1.1.3.2" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.I2.i3.p1.1.m1.1.1.1.1.1.3.3" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S3.I2.i3.p1.1.m1.1.1.1.1.1.2" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.cmml"><msubsup id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.2" rspace="0em" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.3" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.3.cmml">N</mi></msubsup><mrow id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1" rspace="0.167em" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">∇</mo><msub id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐃</mi><mi id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub></mrow><mo id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><mo id="S3.I2.i3.p1.1.m1.1.1.1.2" xref="S3.I2.i3.p1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i3.p1.1.m1.1b"><apply id="S3.I2.i3.p1.1.m1.1.1.1.1.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1"><eq id="S3.I2.i3.p1.1.m1.1.1.1.1.2.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.2"></eq><ci id="S3.I2.i3.p1.1.m1.1.1.1.1.3.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.3">𝐶</ci><apply id="S3.I2.i3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1"><times id="S3.I2.i3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.2"></times><apply id="S3.I2.i3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.3"><divide id="S3.I2.i3.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.3"></divide><cn id="S3.I2.i3.p1.1.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.3.2">1</cn><ci id="S3.I2.i3.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1"><apply id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3"><eq id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1"><abs id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1"><ci id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1">∇</ci><apply id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.2">𝐃</ci><ci id="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i3.p1.1.m1.1c">C=\frac{1}{N}\sum_{i=1}^{N}|\nabla\mathbf{D}_{i}|,</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i3.p1.1.m1.1d">italic_C = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT | ∇ bold_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | ,</annotation></semantics></math>
where <math alttext="N" class="ltx_Math" display="inline" id="S3.I2.i3.p1.2.m2.1"><semantics id="S3.I2.i3.p1.2.m2.1a"><mi id="S3.I2.i3.p1.2.m2.1.1" xref="S3.I2.i3.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i3.p1.2.m2.1b"><ci id="S3.I2.i3.p1.2.m2.1.1.cmml" xref="S3.I2.i3.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i3.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i3.p1.2.m2.1d">italic_N</annotation></semantics></math> is the number of pixels in the map.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i4.p1">
<p class="ltx_p" id="S3.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i4.p1.1.1">Sharpness:</span> Sharpness evaluates the clarity of the edges in the depth or normal maps, defined by the maximum gradient magnitude across the map:
<math alttext="S=\max\left(|\nabla\mathbf{D}|\right)." class="ltx_Math" display="inline" id="S3.I2.i4.p1.1.m1.2"><semantics id="S3.I2.i4.p1.1.m1.2a"><mrow id="S3.I2.i4.p1.1.m1.2.2.1" xref="S3.I2.i4.p1.1.m1.2.2.1.1.cmml"><mrow id="S3.I2.i4.p1.1.m1.2.2.1.1" xref="S3.I2.i4.p1.1.m1.2.2.1.1.cmml"><mi id="S3.I2.i4.p1.1.m1.2.2.1.1.3" xref="S3.I2.i4.p1.1.m1.2.2.1.1.3.cmml">S</mi><mo id="S3.I2.i4.p1.1.m1.2.2.1.1.2" xref="S3.I2.i4.p1.1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.2.cmml"><mi id="S3.I2.i4.p1.1.m1.1.1" xref="S3.I2.i4.p1.1.m1.1.1.cmml">max</mi><mo id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1a" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.2.cmml"><mo id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.2" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.2.cmml">(</mo><mrow id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.2.cmml"><mo id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1" rspace="0.167em" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">∇</mo><mi id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">𝐃</mi></mrow><mo id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.3" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.I2.i4.p1.1.m1.2.2.1.2" lspace="0em" xref="S3.I2.i4.p1.1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i4.p1.1.m1.2b"><apply id="S3.I2.i4.p1.1.m1.2.2.1.1.cmml" xref="S3.I2.i4.p1.1.m1.2.2.1"><eq id="S3.I2.i4.p1.1.m1.2.2.1.1.2.cmml" xref="S3.I2.i4.p1.1.m1.2.2.1.1.2"></eq><ci id="S3.I2.i4.p1.1.m1.2.2.1.1.3.cmml" xref="S3.I2.i4.p1.1.m1.2.2.1.1.3">𝑆</ci><apply id="S3.I2.i4.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.1"><max id="S3.I2.i4.p1.1.m1.1.1.cmml" xref="S3.I2.i4.p1.1.m1.1.1"></max><apply id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1"><abs id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.2"></abs><apply id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.1"><ci id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1">∇</ci><ci id="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.I2.i4.p1.1.m1.2.2.1.1.1.1.1.1.1.1.2">𝐃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i4.p1.1.m1.2c">S=\max\left(|\nabla\mathbf{D}|\right).</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i4.p1.1.m1.2d">italic_S = roman_max ( | ∇ bold_D | ) .</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i5.p1">
<p class="ltx_p" id="S3.I2.i5.p1.4"><span class="ltx_text ltx_font_bold" id="S3.I2.i5.p1.4.1">Orientation Variance:</span> For surface normals, orientation variance assesses the alignment of predicted normal orientations. Given a set of normal vectors <math alttext="\mathbf{n}_{i}" class="ltx_Math" display="inline" id="S3.I2.i5.p1.1.m1.1"><semantics id="S3.I2.i5.p1.1.m1.1a"><msub id="S3.I2.i5.p1.1.m1.1.1" xref="S3.I2.i5.p1.1.m1.1.1.cmml"><mi id="S3.I2.i5.p1.1.m1.1.1.2" xref="S3.I2.i5.p1.1.m1.1.1.2.cmml">𝐧</mi><mi id="S3.I2.i5.p1.1.m1.1.1.3" xref="S3.I2.i5.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I2.i5.p1.1.m1.1b"><apply id="S3.I2.i5.p1.1.m1.1.1.cmml" xref="S3.I2.i5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i5.p1.1.m1.1.1.1.cmml" xref="S3.I2.i5.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I2.i5.p1.1.m1.1.1.2.cmml" xref="S3.I2.i5.p1.1.m1.1.1.2">𝐧</ci><ci id="S3.I2.i5.p1.1.m1.1.1.3.cmml" xref="S3.I2.i5.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i5.p1.1.m1.1c">\mathbf{n}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i5.p1.1.m1.1d">bold_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and their mean <math alttext="\bar{\mathbf{n}}" class="ltx_Math" display="inline" id="S3.I2.i5.p1.2.m2.1"><semantics id="S3.I2.i5.p1.2.m2.1a"><mover accent="true" id="S3.I2.i5.p1.2.m2.1.1" xref="S3.I2.i5.p1.2.m2.1.1.cmml"><mi id="S3.I2.i5.p1.2.m2.1.1.2" xref="S3.I2.i5.p1.2.m2.1.1.2.cmml">𝐧</mi><mo id="S3.I2.i5.p1.2.m2.1.1.1" xref="S3.I2.i5.p1.2.m2.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.I2.i5.p1.2.m2.1b"><apply id="S3.I2.i5.p1.2.m2.1.1.cmml" xref="S3.I2.i5.p1.2.m2.1.1"><ci id="S3.I2.i5.p1.2.m2.1.1.1.cmml" xref="S3.I2.i5.p1.2.m2.1.1.1">¯</ci><ci id="S3.I2.i5.p1.2.m2.1.1.2.cmml" xref="S3.I2.i5.p1.2.m2.1.1.2">𝐧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i5.p1.2.m2.1c">\bar{\mathbf{n}}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i5.p1.2.m2.1d">over¯ start_ARG bold_n end_ARG</annotation></semantics></math>, this metric is expressed as:
<math alttext="V_{o}=\frac{1}{N}\sum_{i=1}^{N}\left(1-\mathbf{n}_{i}\cdot\bar{\mathbf{n}}%
\right)," class="ltx_Math" display="inline" id="S3.I2.i5.p1.3.m3.1"><semantics id="S3.I2.i5.p1.3.m3.1a"><mrow id="S3.I2.i5.p1.3.m3.1.1.1" xref="S3.I2.i5.p1.3.m3.1.1.1.1.cmml"><mrow id="S3.I2.i5.p1.3.m3.1.1.1.1" xref="S3.I2.i5.p1.3.m3.1.1.1.1.cmml"><msub id="S3.I2.i5.p1.3.m3.1.1.1.1.3" xref="S3.I2.i5.p1.3.m3.1.1.1.1.3.cmml"><mi id="S3.I2.i5.p1.3.m3.1.1.1.1.3.2" xref="S3.I2.i5.p1.3.m3.1.1.1.1.3.2.cmml">V</mi><mi id="S3.I2.i5.p1.3.m3.1.1.1.1.3.3" xref="S3.I2.i5.p1.3.m3.1.1.1.1.3.3.cmml">o</mi></msub><mo id="S3.I2.i5.p1.3.m3.1.1.1.1.2" xref="S3.I2.i5.p1.3.m3.1.1.1.1.2.cmml">=</mo><mrow id="S3.I2.i5.p1.3.m3.1.1.1.1.1" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.cmml"><mfrac id="S3.I2.i5.p1.3.m3.1.1.1.1.1.3" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.3.cmml"><mn id="S3.I2.i5.p1.3.m3.1.1.1.1.1.3.2" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.I2.i5.p1.3.m3.1.1.1.1.1.3.3" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S3.I2.i5.p1.3.m3.1.1.1.1.1.2" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.cmml"><msubsup id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.cmml"><mo id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.2" rspace="0em" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.2" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.1" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.3" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.3" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.3.cmml">N</mi></msubsup><mrow id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.2" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.2" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.1" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐧</mi><mi id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.1.cmml">⋅</mo><mover accent="true" id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝐧</mi><mo id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3.1.cmml">¯</mo></mover></mrow></mrow><mo id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.3" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.I2.i5.p1.3.m3.1.1.1.2" xref="S3.I2.i5.p1.3.m3.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i5.p1.3.m3.1b"><apply id="S3.I2.i5.p1.3.m3.1.1.1.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1"><eq id="S3.I2.i5.p1.3.m3.1.1.1.1.2.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.2"></eq><apply id="S3.I2.i5.p1.3.m3.1.1.1.1.3.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.I2.i5.p1.3.m3.1.1.1.1.3.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.3">subscript</csymbol><ci id="S3.I2.i5.p1.3.m3.1.1.1.1.3.2.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.3.2">𝑉</ci><ci id="S3.I2.i5.p1.3.m3.1.1.1.1.3.3.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.3.3">𝑜</ci></apply><apply id="S3.I2.i5.p1.3.m3.1.1.1.1.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1"><times id="S3.I2.i5.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.2"></times><apply id="S3.I2.i5.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.3"><divide id="S3.I2.i5.p1.3.m3.1.1.1.1.1.3.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.3"></divide><cn id="S3.I2.i5.p1.3.m3.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.3.2">1</cn><ci id="S3.I2.i5.p1.3.m3.1.1.1.1.1.3.3.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1"><apply id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3"><eq id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1"><minus id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3"><ci id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.1">⋅</ci><apply id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.2">𝐧</ci><ci id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3"><ci id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3.1">¯</ci><ci id="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.I2.i5.p1.3.m3.1.1.1.1.1.1.1.1.1.3.3.2">𝐧</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i5.p1.3.m3.1c">V_{o}=\frac{1}{N}\sum_{i=1}^{N}\left(1-\mathbf{n}_{i}\cdot\bar{\mathbf{n}}%
\right),</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i5.p1.3.m3.1d">italic_V start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( 1 - bold_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ over¯ start_ARG bold_n end_ARG ) ,</annotation></semantics></math>
where <math alttext="\cdot" class="ltx_Math" display="inline" id="S3.I2.i5.p1.4.m4.1"><semantics id="S3.I2.i5.p1.4.m4.1a"><mo id="S3.I2.i5.p1.4.m4.1.1" xref="S3.I2.i5.p1.4.m4.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="S3.I2.i5.p1.4.m4.1b"><ci id="S3.I2.i5.p1.4.m4.1.1.cmml" xref="S3.I2.i5.p1.4.m4.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i5.p1.4.m4.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i5.p1.4.m4.1d">⋅</annotation></semantics></math> denotes the dot product.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p3">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p3.11">In the second stage, DNESA selects the most reliable depth and surface normal maps by ranking them based on a weighted scoring system. For depth maps, the metrics are weighted as follows: edge consistency (<math alttext="w_{1}=0.3" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p3.1.m1.1a"><mrow id="S3.SS2.SSS0.Px1.p3.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1"><eq id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.2.3">1</cn></apply><cn id="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3.cmml" type="float" xref="S3.SS2.SSS0.Px1.p3.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.1.m1.1c">w_{1}=0.3</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.1.m1.1d">italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.3</annotation></semantics></math>), sharpness (<math alttext="w_{2}=0.3" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p3.2.m2.1a"><mrow id="S3.SS2.SSS0.Px1.p3.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1"><eq id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.2.3">2</cn></apply><cn id="S3.SS2.SSS0.Px1.p3.2.m2.1.1.3.cmml" type="float" xref="S3.SS2.SSS0.Px1.p3.2.m2.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.2.m2.1c">w_{2}=0.3</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.2.m2.1d">italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.3</annotation></semantics></math>), local variance (<math alttext="w_{3}=-0.2" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p3.3.m3.1a"><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2.3.cmml">3</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.3" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.3.cmml"><mo id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.3a" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.3.cmml">−</mo><mn id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.3.2.cmml">0.2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.3.m3.1b"><apply id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1"><eq id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.2.3">3</cn></apply><apply id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.3"><minus id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.3"></minus><cn id="S3.SS2.SSS0.Px1.p3.3.m3.1.1.3.2.cmml" type="float" xref="S3.SS2.SSS0.Px1.p3.3.m3.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.3.m3.1c">w_{3}=-0.2</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.3.m3.1d">italic_w start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT = - 0.2</annotation></semantics></math>), and complexity (<math alttext="w_{4}=0.2" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p3.4.m4.1a"><mrow id="S3.SS2.SSS0.Px1.p3.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.3.cmml">4</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.3" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.4.m4.1b"><apply id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1"><eq id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.2.3">4</cn></apply><cn id="S3.SS2.SSS0.Px1.p3.4.m4.1.1.3.cmml" type="float" xref="S3.SS2.SSS0.Px1.p3.4.m4.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.4.m4.1c">w_{4}=0.2</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.4.m4.1d">italic_w start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT = 0.2</annotation></semantics></math>). The final score for each depth map <math alttext="\mathbf{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p3.5.m5.1a"><mi id="S3.SS2.SSS0.Px1.p3.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.1.cmml">𝐃</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.5.m5.1b"><ci id="S3.SS2.SSS0.Px1.p3.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.5.m5.1.1">𝐃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.5.m5.1c">\mathbf{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.5.m5.1d">bold_D</annotation></semantics></math> is computed as:
<math alttext="S_{\mathbf{D}}=w_{1}E_{c}+w_{2}S-w_{3}V+w_{4}C." class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.6.m6.1"><semantics id="S3.SS2.SSS0.Px1.p3.6.m6.1a"><mrow id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2.2.cmml">S</mi><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2.3.cmml">𝐃</mi></msub><mo id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.cmml"><msub id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.1" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.1.cmml">⁢</mo><msub id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3.2.cmml">E</mi><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3.3.cmml">c</mi></msub></mrow><mo id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.1" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.1.cmml">+</mo><mrow id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.cmml"><msub id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.1" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.3.cmml">S</mi></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.1" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.1.cmml">−</mo><mrow id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.cmml"><msub id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2.3.cmml">3</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.1" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.3.cmml">V</mi></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.cmml"><msub id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2.2" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2.3.cmml">4</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.1" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.3.cmml">C</mi></mrow></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.2" lspace="0em" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.6.m6.1b"><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1"><eq id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2.2">𝑆</ci><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.2.3">𝐃</ci></apply><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3"><plus id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.1"></plus><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2"><minus id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.1"></minus><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2"><plus id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.1"></plus><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2"><times id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.1"></times><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.2.3">1</cn></apply><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3.2">𝐸</ci><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.2.3.3">𝑐</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3"><times id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.1"></times><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.2.3">2</cn></apply><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.2.3.3">𝑆</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3"><times id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.1"></times><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.2.3">3</cn></apply><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.2.3.3">𝑉</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3"><times id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.1"></times><apply id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.2.3">4</cn></apply><ci id="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.6.m6.1.1.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.6.m6.1c">S_{\mathbf{D}}=w_{1}E_{c}+w_{2}S-w_{3}V+w_{4}C.</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.6.m6.1d">italic_S start_POSTSUBSCRIPT bold_D end_POSTSUBSCRIPT = italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_E start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT + italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_S - italic_w start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_V + italic_w start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT italic_C .</annotation></semantics></math>
For surface normals, edge consistency (<math alttext="w_{1}=0.4" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.7.m7.1"><semantics id="S3.SS2.SSS0.Px1.p3.7.m7.1a"><mrow id="S3.SS2.SSS0.Px1.p3.7.m7.1.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.1" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.3" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.7.m7.1b"><apply id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1"><eq id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.2.3">1</cn></apply><cn id="S3.SS2.SSS0.Px1.p3.7.m7.1.1.3.cmml" type="float" xref="S3.SS2.SSS0.Px1.p3.7.m7.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.7.m7.1c">w_{1}=0.4</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.7.m7.1d">italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.4</annotation></semantics></math>) and orientation variance (<math alttext="w_{2}=0.4" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.8.m8.1"><semantics id="S3.SS2.SSS0.Px1.p3.8.m8.1a"><mrow id="S3.SS2.SSS0.Px1.p3.8.m8.1.1" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.1" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.3" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.8.m8.1b"><apply id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1"><eq id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.2.3">2</cn></apply><cn id="S3.SS2.SSS0.Px1.p3.8.m8.1.1.3.cmml" type="float" xref="S3.SS2.SSS0.Px1.p3.8.m8.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.8.m8.1c">w_{2}=0.4</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.8.m8.1d">italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.4</annotation></semantics></math>) are prioritised, with sharpness (<math alttext="w_{3}=0.2" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.9.m9.1"><semantics id="S3.SS2.SSS0.Px1.p3.9.m9.1a"><mrow id="S3.SS2.SSS0.Px1.p3.9.m9.1.1" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2.3.cmml">3</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.1" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.1.cmml">=</mo><mn id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.3" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.9.m9.1b"><apply id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1"><eq id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.2.3">3</cn></apply><cn id="S3.SS2.SSS0.Px1.p3.9.m9.1.1.3.cmml" type="float" xref="S3.SS2.SSS0.Px1.p3.9.m9.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.9.m9.1c">w_{3}=0.2</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.9.m9.1d">italic_w start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT = 0.2</annotation></semantics></math>) contributing to a lesser extent. The score for surface normals <math alttext="\mathbf{N}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.10.m10.1"><semantics id="S3.SS2.SSS0.Px1.p3.10.m10.1a"><mi id="S3.SS2.SSS0.Px1.p3.10.m10.1.1" xref="S3.SS2.SSS0.Px1.p3.10.m10.1.1.cmml">𝐍</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.10.m10.1b"><ci id="S3.SS2.SSS0.Px1.p3.10.m10.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.10.m10.1.1">𝐍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.10.m10.1c">\mathbf{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.10.m10.1d">bold_N</annotation></semantics></math> is:
<math alttext="S_{\mathbf{N}}=w_{1}E_{c}+w_{2}V_{o}+w_{3}S." class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p3.11.m11.1"><semantics id="S3.SS2.SSS0.Px1.p3.11.m11.1a"><mrow id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2.2.cmml">S</mi><mi id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2.3.cmml">𝐍</mi></msub><mo id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.cmml"><msub id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2.3" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.1" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3.2.cmml">E</mi><mi id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3.3" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3.3.cmml">c</mi></msub></mrow><mo id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.1" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.cmml"><msub id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2.3" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.1" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3.2.cmml">V</mi><mi id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3.3" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3.3.cmml">o</mi></msub></mrow><mo id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.1a" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.cmml"><msub id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2.cmml"><mi id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2.2" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2.2.cmml">w</mi><mn id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2.3" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2.3.cmml">3</mn></msub><mo id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.1" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.3" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.3.cmml">S</mi></mrow></mrow></mrow><mo id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.2" lspace="0em" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p3.11.m11.1b"><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1"><eq id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.1"></eq><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2.2">𝑆</ci><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.2.3">𝐍</ci></apply><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3"><plus id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.1"></plus><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2"><times id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.1"></times><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.2.3">1</cn></apply><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3.2">𝐸</ci><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.2.3.3">𝑐</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3"><times id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.1"></times><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.2.3">2</cn></apply><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3.2">𝑉</ci><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.3.3.3">𝑜</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4"><times id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.1"></times><apply id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2.1.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2.2.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2.2">𝑤</ci><cn id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.2.3">3</cn></apply><ci id="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.3.cmml" xref="S3.SS2.SSS0.Px1.p3.11.m11.1.1.1.1.3.4.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p3.11.m11.1c">S_{\mathbf{N}}=w_{1}E_{c}+w_{2}V_{o}+w_{3}S.</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p3.11.m11.1d">italic_S start_POSTSUBSCRIPT bold_N end_POSTSUBSCRIPT = italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_E start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT + italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT + italic_w start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT italic_S .</annotation></semantics></math></p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p4">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p4.1">The <span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS0.Px1.p4.1.1">FindBestDepthNormalPair</span> function, as detailed in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#alg1" title="Algorithm 1 ‣ 3.2 Step 1: Pseudo-Labelled Data Generation ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">1</span></a>, selects the depth-normal pair that achieves the highest combined score. This process ensures that the student model is trained on the highest-quality pseudo-labeled data, which is crucial for achieving reliable 3D perception in underwater environments.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Step 2: Training of the Student Model</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Following the generation of a robust pseudo-labelled real dataset, the next step involves training a lightweight student model. This model is engineered for computational efficiency while preserving the accuracy achieved by the more complex teacher models used in the pseudo-labelling phase. The student model adopts a hybrid architecture that combines Convolutional Neural Networks (CNNs) with Transformers, as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.F3" title="Figure 3 ‣ Key Findings: ‣ 3.1 Learning from the Giants ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">The student model architecture comprises two key components: the encoder and the decoder. Each component is carefully designed to achieve an optimal balance between performance and computational efficiency, making it particularly suitable for deployment on resource-constrained edge devices. The encoder, leveraging CNN layers, efficiently extracts feature maps, while the inclusion of Transformer layers enhances the model’s ability to capture long-range dependencies and global context.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">The architecture is also scalable, allowing for adjustments in channel numbers, convolutional blocks, and dilation rates. This scalability ensures the model’s adaptability to varying computational constraints and resource availability. The flexibility in design enables the model to maintain high performance across a wide range of devices, from high-powered servers to low-power embedded systems. This makes the student model versatile, capable of delivering reliable results even when deployed in environments with limited computational resources.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Encoder Architecture Design</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.3">The encoder, as outlined in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#alg2" title="Algorithm 2 ‣ 3.3.1 Encoder Architecture Design ‣ 3.3 Step 2: Training of the Student Model ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">2</span></a>, is tasked with extracting hierarchical feature representations from the input image, denoted as <math alttext="\mathbf{x}\in\mathbb{R}^{H\times W\times C}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mrow id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml">𝐱</mi><mo id="S3.SS3.SSS1.p1.1.m1.1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.1.m1.1.1.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.2" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.2.cmml">H</mi><mo id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.3" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.3.cmml">W</mi><mo id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.4" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><apply id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1"><in id="S3.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.1"></in><ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.2">𝐱</ci><apply id="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3"><times id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.3">𝑊</ci><ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.4.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">\mathbf{x}\in\mathbb{R}^{H\times W\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">bold_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>. The first step involves normalising the input image using the mean <math alttext="\mu" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.1"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mi id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.1d">italic_μ</annotation></semantics></math> and standard deviation <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.3.m3.1"><semantics id="S3.SS3.SSS1.p1.3.m3.1a"><mi id="S3.SS3.SSS1.p1.3.m3.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m3.1b"><ci id="S3.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.3.m3.1d">italic_σ</annotation></semantics></math> across the dataset:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{x}_{norm}=\frac{\mathbf{x}-\mu}{\sigma}." class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2.cmml">𝐱</mi><mrow id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.3.2" xref="S3.E1.m1.1.1.1.1.2.3.2.cmml">n</mi><mo id="S3.E1.m1.1.1.1.1.2.3.1" xref="S3.E1.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.2.3.3.cmml">o</mi><mo id="S3.E1.m1.1.1.1.1.2.3.1a" xref="S3.E1.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.1.1.2.3.4" xref="S3.E1.m1.1.1.1.1.2.3.4.cmml">r</mi><mo id="S3.E1.m1.1.1.1.1.2.3.1b" xref="S3.E1.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.1.1.1.1.2.3.5" xref="S3.E1.m1.1.1.1.1.2.3.5.cmml">m</mi></mrow></msub><mo id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml">=</mo><mfrac id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.3.2.2.cmml">𝐱</mi><mo id="S3.E1.m1.1.1.1.1.3.2.1" xref="S3.E1.m1.1.1.1.1.3.2.1.cmml">−</mo><mi id="S3.E1.m1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.3.2.3.cmml">μ</mi></mrow><mi id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml">σ</mi></mfrac></mrow><mo id="S3.E1.m1.1.1.1.2" lspace="0em" xref="S3.E1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"></eq><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2">𝐱</ci><apply id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3"><times id="S3.E1.m1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.3.1"></times><ci id="S3.E1.m1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.3.2">𝑛</ci><ci id="S3.E1.m1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3.3">𝑜</ci><ci id="S3.E1.m1.1.1.1.1.2.3.4.cmml" xref="S3.E1.m1.1.1.1.1.2.3.4">𝑟</ci><ci id="S3.E1.m1.1.1.1.1.2.3.5.cmml" xref="S3.E1.m1.1.1.1.1.2.3.5">𝑚</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><divide id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3"></divide><apply id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2"><minus id="S3.E1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.2.1"></minus><ci id="S3.E1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2.2">𝐱</ci><ci id="S3.E1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.3.2.3">𝜇</ci></apply><ci id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3">𝜎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\mathbf{x}_{norm}=\frac{\mathbf{x}-\mu}{\sigma}.</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">bold_x start_POSTSUBSCRIPT italic_n italic_o italic_r italic_m end_POSTSUBSCRIPT = divide start_ARG bold_x - italic_μ end_ARG start_ARG italic_σ end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p2">
<p class="ltx_p" id="S3.SS3.SSS1.p2.1">Following normalisation, a series of downsampling operations is applied to progressively reduce the spatial resolution while retaining essential visual information. This multi-scale downsampling is achieved using average pooling over different scales, such that for each scale <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.1.m1.1"><semantics id="S3.SS3.SSS1.p2.1.m1.1a"><mi id="S3.SS3.SSS1.p2.1.m1.1.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.1.m1.1b"><ci id="S3.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.1.m1.1d">italic_i</annotation></semantics></math>, the pooled representation is denoted as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{x}_{down}^{i}=\text{AvgPool}(\mathbf{x},i),\quad i\in[1,5]." class="ltx_Math" display="block" id="S3.E2.m1.5"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.1"><mrow id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.3.cmml"><mrow id="S3.E2.m1.5.5.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.cmml"><msubsup id="S3.E2.m1.5.5.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.2.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.1.1.2.2.2.cmml">𝐱</mi><mrow id="S3.E2.m1.5.5.1.1.1.1.2.2.3" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.2.2.3.2" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.2.cmml">d</mi><mo id="S3.E2.m1.5.5.1.1.1.1.2.2.3.1" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.5.5.1.1.1.1.2.2.3.3" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.3.cmml">o</mi><mo id="S3.E2.m1.5.5.1.1.1.1.2.2.3.1a" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.5.5.1.1.1.1.2.2.3.4" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.4.cmml">w</mi><mo id="S3.E2.m1.5.5.1.1.1.1.2.2.3.1b" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.5.5.1.1.1.1.2.2.3.5" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.5.cmml">n</mi></mrow><mi id="S3.E2.m1.5.5.1.1.1.1.2.3" xref="S3.E2.m1.5.5.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S3.E2.m1.5.5.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.3.cmml"><mtext id="S3.E2.m1.5.5.1.1.1.1.3.2" xref="S3.E2.m1.5.5.1.1.1.1.3.2a.cmml">AvgPool</mtext><mo id="S3.E2.m1.5.5.1.1.1.1.3.1" xref="S3.E2.m1.5.5.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.3.3.2" xref="S3.E2.m1.5.5.1.1.1.1.3.3.1.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝐱</mi><mo id="S3.E2.m1.5.5.1.1.1.1.3.3.2.2" xref="S3.E2.m1.5.5.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">i</mi><mo id="S3.E2.m1.5.5.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.2.3" rspace="1.167em" xref="S3.E2.m1.5.5.1.1.3a.cmml">,</mo><mrow id="S3.E2.m1.5.5.1.1.2.2" xref="S3.E2.m1.5.5.1.1.2.2.cmml"><mi id="S3.E2.m1.5.5.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.2.2.2.cmml">i</mi><mo id="S3.E2.m1.5.5.1.1.2.2.1" xref="S3.E2.m1.5.5.1.1.2.2.1.cmml">∈</mo><mrow id="S3.E2.m1.5.5.1.1.2.2.3.2" xref="S3.E2.m1.5.5.1.1.2.2.3.1.cmml"><mo id="S3.E2.m1.5.5.1.1.2.2.3.2.1" stretchy="false" xref="S3.E2.m1.5.5.1.1.2.2.3.1.cmml">[</mo><mn id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">1</mn><mo id="S3.E2.m1.5.5.1.1.2.2.3.2.2" xref="S3.E2.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mn id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">5</mn><mo id="S3.E2.m1.5.5.1.1.2.2.3.2.3" stretchy="false" xref="S3.E2.m1.5.5.1.1.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3a.cmml" xref="S3.E2.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1"><eq id="S3.E2.m1.5.5.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1"></eq><apply id="S3.E2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2.2.2">𝐱</ci><apply id="S3.E2.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3"><times id="S3.E2.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.1"></times><ci id="S3.E2.m1.5.5.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.2">𝑑</ci><ci id="S3.E2.m1.5.5.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.3">𝑜</ci><ci id="S3.E2.m1.5.5.1.1.1.1.2.2.3.4.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.4">𝑤</ci><ci id="S3.E2.m1.5.5.1.1.1.1.2.2.3.5.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2.2.3.5">𝑛</ci></apply></apply><ci id="S3.E2.m1.5.5.1.1.1.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E2.m1.5.5.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3"><times id="S3.E2.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.1"></times><ci id="S3.E2.m1.5.5.1.1.1.1.3.2a.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.2"><mtext id="S3.E2.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.2">AvgPool</mtext></ci><interval closure="open" id="S3.E2.m1.5.5.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.3.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝐱</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑖</ci></interval></apply></apply><apply id="S3.E2.m1.5.5.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2"><in id="S3.E2.m1.5.5.1.1.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.1"></in><ci id="S3.E2.m1.5.5.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2">𝑖</ci><interval closure="closed" id="S3.E2.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3.2"><cn id="S3.E2.m1.3.3.cmml" type="integer" xref="S3.E2.m1.3.3">1</cn><cn id="S3.E2.m1.4.4.cmml" type="integer" xref="S3.E2.m1.4.4">5</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\mathbf{x}_{down}^{i}=\text{AvgPool}(\mathbf{x},i),\quad i\in[1,5].</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.5d">bold_x start_POSTSUBSCRIPT italic_d italic_o italic_w italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = AvgPool ( bold_x , italic_i ) , italic_i ∈ [ 1 , 5 ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p3">
<p class="ltx_p" id="S3.SS3.SSS1.p3.4">The core of the encoder is organised into three distinct stages, each comprising a combination of convolutional and transformer blocks, as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.F4" title="Figure 4 ‣ Our Approach: ‣ 3.1 Learning from the Giants ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">4</span></a>. The convolutional layers employ dilated convolutions, represented as <math alttext="\text{Conv}_{\text{dilation}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.1.m1.1"><semantics id="S3.SS3.SSS1.p3.1.m1.1a"><msub id="S3.SS3.SSS1.p3.1.m1.1.1" xref="S3.SS3.SSS1.p3.1.m1.1.1.cmml"><mtext id="S3.SS3.SSS1.p3.1.m1.1.1.2" xref="S3.SS3.SSS1.p3.1.m1.1.1.2a.cmml">Conv</mtext><mtext id="S3.SS3.SSS1.p3.1.m1.1.1.3" xref="S3.SS3.SSS1.p3.1.m1.1.1.3a.cmml">dilation</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.1.m1.1b"><apply id="S3.SS3.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p3.1.m1.1.1.2a.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.2"><mtext id="S3.SS3.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.2">Conv</mtext></ci><ci id="S3.SS3.SSS1.p3.1.m1.1.1.3a.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.3"><mtext id="S3.SS3.SSS1.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS1.p3.1.m1.1.1.3">dilation</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.1.m1.1c">\text{Conv}_{\text{dilation}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.1.m1.1d">Conv start_POSTSUBSCRIPT dilation end_POSTSUBSCRIPT</annotation></semantics></math>, to expand the receptive field without a significant increase in computational cost. Specifically, for a convolution operation with kernel size <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.2.m2.1"><semantics id="S3.SS3.SSS1.p3.2.m2.1a"><mi id="S3.SS3.SSS1.p3.2.m2.1.1" xref="S3.SS3.SSS1.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.2.m2.1b"><ci id="S3.SS3.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.2.m2.1d">italic_k</annotation></semantics></math> and dilation factor <math alttext="d" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.3.m3.1"><semantics id="S3.SS3.SSS1.p3.3.m3.1a"><mi id="S3.SS3.SSS1.p3.3.m3.1.1" xref="S3.SS3.SSS1.p3.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.3.m3.1b"><ci id="S3.SS3.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.3.m3.1d">italic_d</annotation></semantics></math>, the receptive field is increased by a factor of <math alttext="d" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.4.m4.1"><semantics id="S3.SS3.SSS1.p3.4.m4.1a"><mi id="S3.SS3.SSS1.p3.4.m4.1.1" xref="S3.SS3.SSS1.p3.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.4.m4.1b"><ci id="S3.SS3.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.4.m4.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.4.m4.1d">italic_d</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{Receptive Field}=(k-1)\cdot d+1." class="ltx_Math" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mtext id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3a.cmml">Receptive Field</mtext><mo id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml">k</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml">⋅</mo><mi id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml">d</mi></mrow><mo id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">+</mo><mn id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">1</mn></mrow></mrow><mo id="S3.E3.m1.1.1.1.2" lspace="0em" xref="S3.E3.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2"></eq><ci id="S3.E3.m1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.3"><mtext id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3">Receptive Field</mtext></ci><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><plus id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2"></plus><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><ci id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1"><minus id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.2">𝑘</ci><cn id="S3.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">𝑑</ci></apply><cn id="S3.E3.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\text{Receptive Field}=(k-1)\cdot d+1.</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">Receptive Field = ( italic_k - 1 ) ⋅ italic_d + 1 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p4">
<p class="ltx_p" id="S3.SS3.SSS1.p4.2">In parallel, transformer blocks are selectively introduced within each stage to capture long-range dependencies and global context. These blocks operate based on the model’s configuration, ensuring a balance between local and global feature extraction. At each stage <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p4.1.m1.1"><semantics id="S3.SS3.SSS1.p4.1.m1.1a"><mi id="S3.SS3.SSS1.p4.1.m1.1.1" xref="S3.SS3.SSS1.p4.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p4.1.m1.1b"><ci id="S3.SS3.SSS1.p4.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p4.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p4.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p4.1.m1.1d">italic_i</annotation></semantics></math>, a feature map <math alttext="\mathbf{F}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p4.2.m2.1"><semantics id="S3.SS3.SSS1.p4.2.m2.1a"><msub id="S3.SS3.SSS1.p4.2.m2.1.1" xref="S3.SS3.SSS1.p4.2.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p4.2.m2.1.1.2" xref="S3.SS3.SSS1.p4.2.m2.1.1.2.cmml">𝐅</mi><mi id="S3.SS3.SSS1.p4.2.m2.1.1.3" xref="S3.SS3.SSS1.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p4.2.m2.1b"><apply id="S3.SS3.SSS1.p4.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p4.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p4.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p4.2.m2.1.1.2">𝐅</ci><ci id="S3.SS3.SSS1.p4.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p4.2.m2.1c">\mathbf{F}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p4.2.m2.1d">bold_F start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is generated, which is subsequently downsampled to reduce the spatial resolution. This operation is performed between stages to progressively capture both fine-grained details and high-level semantics:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{F}_{i}=\text{Downsample}(\mathbf{F}_{i-1},\mathbf{x}_{down}^{i})." class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.4.cmml"><mi id="S3.E4.m1.1.1.1.1.4.2" xref="S3.E4.m1.1.1.1.1.4.2.cmml">𝐅</mi><mi id="S3.E4.m1.1.1.1.1.4.3" xref="S3.E4.m1.1.1.1.1.4.3.cmml">i</mi></msub><mo id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml"><mtext id="S3.E4.m1.1.1.1.1.2.4" xref="S3.E4.m1.1.1.1.1.2.4a.cmml">Downsample</mtext><mo id="S3.E4.m1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.3.cmml"><mo id="S3.E4.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.cmml">𝐅</mi><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E4.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E4.m1.1.1.1.1.2.2.2.4" xref="S3.E4.m1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E4.m1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml">𝐱</mi><mrow id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.2" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.2.cmml">d</mi><mo id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.3" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.3.cmml">o</mi><mo id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1a" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.4" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.4.cmml">w</mi><mo id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1b" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.5" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.5.cmml">n</mi></mrow><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.E4.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S3.E4.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" lspace="0em" xref="S3.E4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"></eq><apply id="S3.E4.m1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.4.1.cmml" xref="S3.E4.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.4.2.cmml" xref="S3.E4.m1.1.1.1.1.4.2">𝐅</ci><ci id="S3.E4.m1.1.1.1.1.4.3.cmml" xref="S3.E4.m1.1.1.1.1.4.3">𝑖</ci></apply><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"><times id="S3.E4.m1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.3"></times><ci id="S3.E4.m1.1.1.1.1.2.4a.cmml" xref="S3.E4.m1.1.1.1.1.2.4"><mtext id="S3.E4.m1.1.1.1.1.2.4.cmml" xref="S3.E4.m1.1.1.1.1.2.4">Downsample</mtext></ci><interval closure="open" id="S3.E4.m1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2"><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2">𝐅</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3"><minus id="S3.E4.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.E4.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E4.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.2">𝐱</ci><apply id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3"><times id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1"></times><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.2">𝑑</ci><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.3">𝑜</ci><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.4.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.4">𝑤</ci><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.5.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.5">𝑛</ci></apply></apply><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\mathbf{F}_{i}=\text{Downsample}(\mathbf{F}_{i-1},\mathbf{x}_{down}^{i}).</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">bold_F start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = Downsample ( bold_F start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT , bold_x start_POSTSUBSCRIPT italic_d italic_o italic_w italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p5">
<p class="ltx_p" id="S3.SS3.SSS1.p5.1">The final output of the encoder is a multi-scale representation <math alttext="\mathbf{F}=\{\mathbf{F}_{1},\mathbf{F}_{2},\mathbf{F}_{3}\}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p5.1.m1.3"><semantics id="S3.SS3.SSS1.p5.1.m1.3a"><mrow id="S3.SS3.SSS1.p5.1.m1.3.3" xref="S3.SS3.SSS1.p5.1.m1.3.3.cmml"><mi id="S3.SS3.SSS1.p5.1.m1.3.3.5" xref="S3.SS3.SSS1.p5.1.m1.3.3.5.cmml">𝐅</mi><mo id="S3.SS3.SSS1.p5.1.m1.3.3.4" xref="S3.SS3.SSS1.p5.1.m1.3.3.4.cmml">=</mo><mrow id="S3.SS3.SSS1.p5.1.m1.3.3.3.3" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.4.cmml"><mo id="S3.SS3.SSS1.p5.1.m1.3.3.3.3.4" stretchy="false" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.4.cmml">{</mo><msub id="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1" xref="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1.2" xref="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1.2.cmml">𝐅</mi><mn id="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS1.p5.1.m1.3.3.3.3.5" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2" xref="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2.2" xref="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2.2.cmml">𝐅</mi><mn id="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2.3" xref="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS1.p5.1.m1.3.3.3.3.6" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3.cmml"><mi id="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3.2" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3.2.cmml">𝐅</mi><mn id="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3.3" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3.3.cmml">3</mn></msub><mo id="S3.SS3.SSS1.p5.1.m1.3.3.3.3.7" stretchy="false" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p5.1.m1.3b"><apply id="S3.SS3.SSS1.p5.1.m1.3.3.cmml" xref="S3.SS3.SSS1.p5.1.m1.3.3"><eq id="S3.SS3.SSS1.p5.1.m1.3.3.4.cmml" xref="S3.SS3.SSS1.p5.1.m1.3.3.4"></eq><ci id="S3.SS3.SSS1.p5.1.m1.3.3.5.cmml" xref="S3.SS3.SSS1.p5.1.m1.3.3.5">𝐅</ci><set id="S3.SS3.SSS1.p5.1.m1.3.3.3.4.cmml" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.3"><apply id="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1.2">𝐅</ci><cn id="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p5.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2.2">𝐅</ci><cn id="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS3.SSS1.p5.1.m1.2.2.2.2.2.3">2</cn></apply><apply id="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3.cmml" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3.1.cmml" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3.2.cmml" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3.2">𝐅</ci><cn id="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3.3.cmml" type="integer" xref="S3.SS3.SSS1.p5.1.m1.3.3.3.3.3.3">3</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p5.1.m1.3c">\mathbf{F}=\{\mathbf{F}_{1},\mathbf{F}_{2},\mathbf{F}_{3}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p5.1.m1.3d">bold_F = { bold_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_F start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , bold_F start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT }</annotation></semantics></math>, consisting of hierarchical feature maps that preserve both local and global contextual information. These features are then passed to the decoder for further processing, enabling effective reconstruction and depth estimation.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="alg2">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg2.70">
<div class="ltx_listingline" id="alg2.2.2">
<span class="ltx_text" id="alg2.2.2.2" style="font-size:90%;">
<span class="ltx_text" id="alg2.2.2.2.1"><span class="ltx_text ltx_font_bold" id="alg2.2.2.2.1.1">Input:</span> </span>Input image <math alttext="x" class="ltx_Math" display="inline" id="alg2.1.1.1.m1.1"><semantics id="alg2.1.1.1.m1.1a"><mi id="alg2.1.1.1.m1.1.1" xref="alg2.1.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.1.1.1.m1.1b"><ci id="alg2.1.1.1.m1.1.1.cmml" xref="alg2.1.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.1.1.1.m1.1d">italic_x</annotation></semantics></math>, model configuration <math alttext="config" class="ltx_Math" display="inline" id="alg2.2.2.2.m2.1"><semantics id="alg2.2.2.2.m2.1a"><mrow id="alg2.2.2.2.m2.1.1" xref="alg2.2.2.2.m2.1.1.cmml"><mi id="alg2.2.2.2.m2.1.1.2" xref="alg2.2.2.2.m2.1.1.2.cmml">c</mi><mo id="alg2.2.2.2.m2.1.1.1" xref="alg2.2.2.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.2.2.2.m2.1.1.3" xref="alg2.2.2.2.m2.1.1.3.cmml">o</mi><mo id="alg2.2.2.2.m2.1.1.1a" xref="alg2.2.2.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.2.2.2.m2.1.1.4" xref="alg2.2.2.2.m2.1.1.4.cmml">n</mi><mo id="alg2.2.2.2.m2.1.1.1b" xref="alg2.2.2.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.2.2.2.m2.1.1.5" xref="alg2.2.2.2.m2.1.1.5.cmml">f</mi><mo id="alg2.2.2.2.m2.1.1.1c" xref="alg2.2.2.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.2.2.2.m2.1.1.6" xref="alg2.2.2.2.m2.1.1.6.cmml">i</mi><mo id="alg2.2.2.2.m2.1.1.1d" xref="alg2.2.2.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.2.2.2.m2.1.1.7" xref="alg2.2.2.2.m2.1.1.7.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.2.2.2.m2.1b"><apply id="alg2.2.2.2.m2.1.1.cmml" xref="alg2.2.2.2.m2.1.1"><times id="alg2.2.2.2.m2.1.1.1.cmml" xref="alg2.2.2.2.m2.1.1.1"></times><ci id="alg2.2.2.2.m2.1.1.2.cmml" xref="alg2.2.2.2.m2.1.1.2">𝑐</ci><ci id="alg2.2.2.2.m2.1.1.3.cmml" xref="alg2.2.2.2.m2.1.1.3">𝑜</ci><ci id="alg2.2.2.2.m2.1.1.4.cmml" xref="alg2.2.2.2.m2.1.1.4">𝑛</ci><ci id="alg2.2.2.2.m2.1.1.5.cmml" xref="alg2.2.2.2.m2.1.1.5">𝑓</ci><ci id="alg2.2.2.2.m2.1.1.6.cmml" xref="alg2.2.2.2.m2.1.1.6">𝑖</ci><ci id="alg2.2.2.2.m2.1.1.7.cmml" xref="alg2.2.2.2.m2.1.1.7">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.2.2.m2.1c">config</annotation><annotation encoding="application/x-llamapun" id="alg2.2.2.2.m2.1d">italic_c italic_o italic_n italic_f italic_i italic_g</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="alg2.3.3">
<span class="ltx_text" id="alg2.3.3.1" style="font-size:90%;">
</span><span class="ltx_text" id="alg2.3.3.2" style="font-size:90%;"><span class="ltx_text ltx_font_bold" id="alg2.3.3.2.1">Output:</span> </span><span class="ltx_text" id="alg2.3.3.3" style="font-size:90%;">Encoded features </span><math alttext="F" class="ltx_Math" display="inline" id="alg2.3.3.m1.1"><semantics id="alg2.3.3.m1.1a"><mi id="alg2.3.3.m1.1.1" mathsize="90%" xref="alg2.3.3.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="alg2.3.3.m1.1b"><ci id="alg2.3.3.m1.1.1.cmml" xref="alg2.3.3.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.3.m1.1c">F</annotation><annotation encoding="application/x-llamapun" id="alg2.3.3.m1.1d">italic_F</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.70.71">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.71.1.1.1" style="font-size:90%;">1</span></span><span class="ltx_text" id="alg2.70.71.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.4.4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.4.4.2.1.1" style="font-size:90%;">2</span></span><span class="ltx_text ltx_font_bold" id="alg2.4.4.3" style="font-size:90%;">Function</span><span class="ltx_text" id="alg2.4.4.4" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_typewriter" id="alg2.4.4.1" style="font-size:90%;">Forward(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.4.4.1.1.1"><math alttext="x" class="ltx_Math" display="inline" id="alg2.4.4.1.1.1.m1.1"><semantics id="alg2.4.4.1.1.1.m1.1a"><mi id="alg2.4.4.1.1.1.m1.1.1" xref="alg2.4.4.1.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.4.4.1.1.1.m1.1b"><ci id="alg2.4.4.1.1.1.m1.1.1.cmml" xref="alg2.4.4.1.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.4.1.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.4.4.1.1.1.m1.1d">italic_x</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="alg2.4.4.5" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="alg2.6.6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.6.6.2.1.1" style="font-size:90%;">3</span></span><span class="ltx_text" id="alg2.6.6.3" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.6.6.4" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.6.6.5" style="font-size:90%;">
</span><math alttext="F\leftarrow" class="ltx_Math" display="inline" id="alg2.5.5.m1.1"><semantics id="alg2.5.5.m1.1a"><mrow id="alg2.5.5.m1.1.1" xref="alg2.5.5.m1.1.1.cmml"><mi id="alg2.5.5.m1.1.1.2" mathsize="90%" xref="alg2.5.5.m1.1.1.2.cmml">F</mi><mo id="alg2.5.5.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.5.5.m1.1.1.1.cmml">←</mo><mi id="alg2.5.5.m1.1.1.3" xref="alg2.5.5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.5.5.m1.1b"><apply id="alg2.5.5.m1.1.1.cmml" xref="alg2.5.5.m1.1.1"><ci id="alg2.5.5.m1.1.1.1.cmml" xref="alg2.5.5.m1.1.1.1">←</ci><ci id="alg2.5.5.m1.1.1.2.cmml" xref="alg2.5.5.m1.1.1.2">𝐹</ci><csymbol cd="latexml" id="alg2.5.5.m1.1.1.3.cmml" xref="alg2.5.5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.5.m1.1c">F\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.5.5.m1.1d">italic_F ←</annotation></semantics></math><span class="ltx_text" id="alg2.6.6.6" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="alg2.6.6.1" style="font-size:90%;">ForwardFeatures(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.6.6.1.1"><math alttext="x" class="ltx_Math" display="inline" id="alg2.6.6.1.1.m1.1"><semantics id="alg2.6.6.1.1.m1.1a"><mi id="alg2.6.6.1.1.m1.1.1" xref="alg2.6.6.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.6.6.1.1.m1.1b"><ci id="alg2.6.6.1.1.m1.1.1.cmml" xref="alg2.6.6.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.6.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.6.6.1.1.m1.1d">italic_x</annotation></semantics></math></em>)</span><span class="ltx_text" id="alg2.6.6.7" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg2.7.7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.7.7.1.1.1" style="font-size:90%;">4</span></span><span class="ltx_text" id="alg2.7.7.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.7.7.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.7.7.4" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg2.7.7.5" style="font-size:90%;">return</span><span class="ltx_text" id="alg2.7.7.6" style="font-size:90%;"> </span><math alttext="F" class="ltx_Math" display="inline" id="alg2.7.7.m1.1"><semantics id="alg2.7.7.m1.1a"><mi id="alg2.7.7.m1.1.1" mathsize="90%" xref="alg2.7.7.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="alg2.7.7.m1.1b"><ci id="alg2.7.7.m1.1.1.cmml" xref="alg2.7.7.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.7.m1.1c">F</annotation><annotation encoding="application/x-llamapun" id="alg2.7.7.m1.1d">italic_F</annotation></semantics></math><span class="ltx_text" id="alg2.7.7.7" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg2.70.72">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.72.1.1.1" style="font-size:90%;">5</span></span><span class="ltx_text" id="alg2.70.72.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.72.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.70.72.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.70.73">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.73.1.1.1" style="font-size:90%;">6</span></span>
</div>
<div class="ltx_listingline" id="alg2.8.8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.8.8.2.1.1" style="font-size:90%;">7</span></span><span class="ltx_text ltx_font_bold" id="alg2.8.8.3" style="font-size:90%;">Function</span><span class="ltx_text" id="alg2.8.8.4" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_typewriter" id="alg2.8.8.1" style="font-size:90%;">ForwardFeatures(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.8.8.1.1.1"><math alttext="x" class="ltx_Math" display="inline" id="alg2.8.8.1.1.1.m1.1"><semantics id="alg2.8.8.1.1.1.m1.1a"><mi id="alg2.8.8.1.1.1.m1.1.1" xref="alg2.8.8.1.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.8.8.1.1.1.m1.1b"><ci id="alg2.8.8.1.1.1.m1.1.1.cmml" xref="alg2.8.8.1.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.8.1.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.8.8.1.1.1.m1.1d">italic_x</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="alg2.8.8.5" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="alg2.9.9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.9.9.1.1.1" style="font-size:90%;">8</span></span><span class="ltx_text" id="alg2.9.9.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.9.9.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.9.9.4" style="font-size:90%;">
</span><math alttext="x\leftarrow(x-\mu)/\sigma" class="ltx_Math" display="inline" id="alg2.9.9.m1.1"><semantics id="alg2.9.9.m1.1a"><mrow id="alg2.9.9.m1.1.1" xref="alg2.9.9.m1.1.1.cmml"><mi id="alg2.9.9.m1.1.1.3" mathsize="90%" xref="alg2.9.9.m1.1.1.3.cmml">x</mi><mo id="alg2.9.9.m1.1.1.2" mathsize="90%" stretchy="false" xref="alg2.9.9.m1.1.1.2.cmml">←</mo><mrow id="alg2.9.9.m1.1.1.1" xref="alg2.9.9.m1.1.1.1.cmml"><mrow id="alg2.9.9.m1.1.1.1.1.1" xref="alg2.9.9.m1.1.1.1.1.1.1.cmml"><mo id="alg2.9.9.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg2.9.9.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.9.9.m1.1.1.1.1.1.1" xref="alg2.9.9.m1.1.1.1.1.1.1.cmml"><mi id="alg2.9.9.m1.1.1.1.1.1.1.2" mathsize="90%" xref="alg2.9.9.m1.1.1.1.1.1.1.2.cmml">x</mi><mo id="alg2.9.9.m1.1.1.1.1.1.1.1" mathsize="90%" xref="alg2.9.9.m1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg2.9.9.m1.1.1.1.1.1.1.3" mathsize="90%" xref="alg2.9.9.m1.1.1.1.1.1.1.3.cmml">μ</mi></mrow><mo id="alg2.9.9.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg2.9.9.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg2.9.9.m1.1.1.1.2" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg2.9.9.m1.1.1.1.2.cmml">/</mo><mi id="alg2.9.9.m1.1.1.1.3" mathsize="90%" xref="alg2.9.9.m1.1.1.1.3.cmml">σ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.9.9.m1.1b"><apply id="alg2.9.9.m1.1.1.cmml" xref="alg2.9.9.m1.1.1"><ci id="alg2.9.9.m1.1.1.2.cmml" xref="alg2.9.9.m1.1.1.2">←</ci><ci id="alg2.9.9.m1.1.1.3.cmml" xref="alg2.9.9.m1.1.1.3">𝑥</ci><apply id="alg2.9.9.m1.1.1.1.cmml" xref="alg2.9.9.m1.1.1.1"><divide id="alg2.9.9.m1.1.1.1.2.cmml" xref="alg2.9.9.m1.1.1.1.2"></divide><apply id="alg2.9.9.m1.1.1.1.1.1.1.cmml" xref="alg2.9.9.m1.1.1.1.1.1"><minus id="alg2.9.9.m1.1.1.1.1.1.1.1.cmml" xref="alg2.9.9.m1.1.1.1.1.1.1.1"></minus><ci id="alg2.9.9.m1.1.1.1.1.1.1.2.cmml" xref="alg2.9.9.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg2.9.9.m1.1.1.1.1.1.1.3.cmml" xref="alg2.9.9.m1.1.1.1.1.1.1.3">𝜇</ci></apply><ci id="alg2.9.9.m1.1.1.1.3.cmml" xref="alg2.9.9.m1.1.1.1.3">𝜎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.9.m1.1c">x\leftarrow(x-\mu)/\sigma</annotation><annotation encoding="application/x-llamapun" id="alg2.9.9.m1.1d">italic_x ← ( italic_x - italic_μ ) / italic_σ</annotation></semantics></math><span class="ltx_text" id="alg2.9.9.5" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg2.13.13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.13.13.1.1.1" style="font-size:90%;">9</span></span><span class="ltx_text" id="alg2.13.13.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.13.13.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.13.13.4" style="font-size:90%;">
</span><math alttext="x\_down\leftarrow" class="ltx_Math" display="inline" id="alg2.10.10.m1.1"><semantics id="alg2.10.10.m1.1a"><mrow id="alg2.10.10.m1.1.1" xref="alg2.10.10.m1.1.1.cmml"><mrow id="alg2.10.10.m1.1.1.2" xref="alg2.10.10.m1.1.1.2.cmml"><mi id="alg2.10.10.m1.1.1.2.2" mathsize="90%" xref="alg2.10.10.m1.1.1.2.2.cmml">x</mi><mo id="alg2.10.10.m1.1.1.2.1" xref="alg2.10.10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.10.10.m1.1.1.2.3" mathsize="90%" mathvariant="normal" xref="alg2.10.10.m1.1.1.2.3.cmml">_</mi><mo id="alg2.10.10.m1.1.1.2.1a" xref="alg2.10.10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.10.10.m1.1.1.2.4" mathsize="90%" xref="alg2.10.10.m1.1.1.2.4.cmml">d</mi><mo id="alg2.10.10.m1.1.1.2.1b" xref="alg2.10.10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.10.10.m1.1.1.2.5" mathsize="90%" xref="alg2.10.10.m1.1.1.2.5.cmml">o</mi><mo id="alg2.10.10.m1.1.1.2.1c" xref="alg2.10.10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.10.10.m1.1.1.2.6" mathsize="90%" xref="alg2.10.10.m1.1.1.2.6.cmml">w</mi><mo id="alg2.10.10.m1.1.1.2.1d" xref="alg2.10.10.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.10.10.m1.1.1.2.7" mathsize="90%" xref="alg2.10.10.m1.1.1.2.7.cmml">n</mi></mrow><mo id="alg2.10.10.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.10.10.m1.1.1.1.cmml">←</mo><mi id="alg2.10.10.m1.1.1.3" xref="alg2.10.10.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.10.10.m1.1b"><apply id="alg2.10.10.m1.1.1.cmml" xref="alg2.10.10.m1.1.1"><ci id="alg2.10.10.m1.1.1.1.cmml" xref="alg2.10.10.m1.1.1.1">←</ci><apply id="alg2.10.10.m1.1.1.2.cmml" xref="alg2.10.10.m1.1.1.2"><times id="alg2.10.10.m1.1.1.2.1.cmml" xref="alg2.10.10.m1.1.1.2.1"></times><ci id="alg2.10.10.m1.1.1.2.2.cmml" xref="alg2.10.10.m1.1.1.2.2">𝑥</ci><ci id="alg2.10.10.m1.1.1.2.3.cmml" xref="alg2.10.10.m1.1.1.2.3">_</ci><ci id="alg2.10.10.m1.1.1.2.4.cmml" xref="alg2.10.10.m1.1.1.2.4">𝑑</ci><ci id="alg2.10.10.m1.1.1.2.5.cmml" xref="alg2.10.10.m1.1.1.2.5">𝑜</ci><ci id="alg2.10.10.m1.1.1.2.6.cmml" xref="alg2.10.10.m1.1.1.2.6">𝑤</ci><ci id="alg2.10.10.m1.1.1.2.7.cmml" xref="alg2.10.10.m1.1.1.2.7">𝑛</ci></apply><csymbol cd="latexml" id="alg2.10.10.m1.1.1.3.cmml" xref="alg2.10.10.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.10.m1.1c">x\_down\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.10.10.m1.1d">italic_x _ italic_d italic_o italic_w italic_n ←</annotation></semantics></math><span class="ltx_text" id="alg2.13.13.5" style="font-size:90%;"> [AvgPool(</span><math alttext="x" class="ltx_Math" display="inline" id="alg2.11.11.m2.1"><semantics id="alg2.11.11.m2.1a"><mi id="alg2.11.11.m2.1.1" mathsize="90%" xref="alg2.11.11.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.11.11.m2.1b"><ci id="alg2.11.11.m2.1.1.cmml" xref="alg2.11.11.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.11.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.11.11.m2.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.13.13.6" style="font-size:90%;">, </span><math alttext="i" class="ltx_Math" display="inline" id="alg2.12.12.m3.1"><semantics id="alg2.12.12.m3.1a"><mi id="alg2.12.12.m3.1.1" mathsize="90%" xref="alg2.12.12.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.12.12.m3.1b"><ci id="alg2.12.12.m3.1.1.cmml" xref="alg2.12.12.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.12.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg2.12.12.m3.1d">italic_i</annotation></semantics></math><span class="ltx_text" id="alg2.13.13.7" style="font-size:90%;">) for </span><math alttext="i" class="ltx_Math" display="inline" id="alg2.13.13.m4.1"><semantics id="alg2.13.13.m4.1a"><mi id="alg2.13.13.m4.1.1" mathsize="90%" xref="alg2.13.13.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.13.13.m4.1b"><ci id="alg2.13.13.m4.1.1.cmml" xref="alg2.13.13.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.13.13.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg2.13.13.m4.1d">italic_i</annotation></semantics></math><span class="ltx_text" id="alg2.13.13.8" style="font-size:90%;"> in range(1, 5)];</span>
</div>
<div class="ltx_listingline" id="alg2.14.14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.14.14.1.1.1" style="font-size:90%;">10</span></span><span class="ltx_text" id="alg2.14.14.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.14.14.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.14.14.4" style="font-size:90%;">
</span><math alttext="features\leftarrow[]" class="ltx_Math" display="inline" id="alg2.14.14.m1.1"><semantics id="alg2.14.14.m1.1a"><mrow id="alg2.14.14.m1.1.1" xref="alg2.14.14.m1.1.1.cmml"><mrow id="alg2.14.14.m1.1.1.2" xref="alg2.14.14.m1.1.1.2.cmml"><mi id="alg2.14.14.m1.1.1.2.2" mathsize="90%" xref="alg2.14.14.m1.1.1.2.2.cmml">f</mi><mo id="alg2.14.14.m1.1.1.2.1" xref="alg2.14.14.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.14.14.m1.1.1.2.3" mathsize="90%" xref="alg2.14.14.m1.1.1.2.3.cmml">e</mi><mo id="alg2.14.14.m1.1.1.2.1a" xref="alg2.14.14.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.14.14.m1.1.1.2.4" mathsize="90%" xref="alg2.14.14.m1.1.1.2.4.cmml">a</mi><mo id="alg2.14.14.m1.1.1.2.1b" xref="alg2.14.14.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.14.14.m1.1.1.2.5" mathsize="90%" xref="alg2.14.14.m1.1.1.2.5.cmml">t</mi><mo id="alg2.14.14.m1.1.1.2.1c" xref="alg2.14.14.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.14.14.m1.1.1.2.6" mathsize="90%" xref="alg2.14.14.m1.1.1.2.6.cmml">u</mi><mo id="alg2.14.14.m1.1.1.2.1d" xref="alg2.14.14.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.14.14.m1.1.1.2.7" mathsize="90%" xref="alg2.14.14.m1.1.1.2.7.cmml">r</mi><mo id="alg2.14.14.m1.1.1.2.1e" xref="alg2.14.14.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.14.14.m1.1.1.2.8" mathsize="90%" xref="alg2.14.14.m1.1.1.2.8.cmml">e</mi><mo id="alg2.14.14.m1.1.1.2.1f" xref="alg2.14.14.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.14.14.m1.1.1.2.9" mathsize="90%" xref="alg2.14.14.m1.1.1.2.9.cmml">s</mi></mrow><mo id="alg2.14.14.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.14.14.m1.1.1.1.cmml">←</mo><mrow id="alg2.14.14.m1.1.1.3.2" xref="alg2.14.14.m1.1.1.cmml"><mo id="alg2.14.14.m1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg2.14.14.m1.1.1.3.1.cmml">[</mo><mo id="alg2.14.14.m1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg2.14.14.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.14.14.m1.1b"><apply id="alg2.14.14.m1.1.1.cmml" xref="alg2.14.14.m1.1.1"><ci id="alg2.14.14.m1.1.1.1.cmml" xref="alg2.14.14.m1.1.1.1">←</ci><apply id="alg2.14.14.m1.1.1.2.cmml" xref="alg2.14.14.m1.1.1.2"><times id="alg2.14.14.m1.1.1.2.1.cmml" xref="alg2.14.14.m1.1.1.2.1"></times><ci id="alg2.14.14.m1.1.1.2.2.cmml" xref="alg2.14.14.m1.1.1.2.2">𝑓</ci><ci id="alg2.14.14.m1.1.1.2.3.cmml" xref="alg2.14.14.m1.1.1.2.3">𝑒</ci><ci id="alg2.14.14.m1.1.1.2.4.cmml" xref="alg2.14.14.m1.1.1.2.4">𝑎</ci><ci id="alg2.14.14.m1.1.1.2.5.cmml" xref="alg2.14.14.m1.1.1.2.5">𝑡</ci><ci id="alg2.14.14.m1.1.1.2.6.cmml" xref="alg2.14.14.m1.1.1.2.6">𝑢</ci><ci id="alg2.14.14.m1.1.1.2.7.cmml" xref="alg2.14.14.m1.1.1.2.7">𝑟</ci><ci id="alg2.14.14.m1.1.1.2.8.cmml" xref="alg2.14.14.m1.1.1.2.8">𝑒</ci><ci id="alg2.14.14.m1.1.1.2.9.cmml" xref="alg2.14.14.m1.1.1.2.9">𝑠</ci></apply><list id="alg2.14.14.m1.1.1.3.1.cmml" xref="alg2.14.14.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.14.14.m1.1c">features\leftarrow[]</annotation><annotation encoding="application/x-llamapun" id="alg2.14.14.m1.1d">italic_f italic_e italic_a italic_t italic_u italic_r italic_e italic_s ← [ ]</annotation></semantics></math><span class="ltx_text" id="alg2.14.14.5" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg2.17.17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.17.17.1.1.1" style="font-size:90%;">11</span></span><span class="ltx_text" id="alg2.17.17.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.17.17.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.17.17.4" style="font-size:90%;">
</span><math alttext="x\leftarrow" class="ltx_Math" display="inline" id="alg2.15.15.m1.1"><semantics id="alg2.15.15.m1.1a"><mrow id="alg2.15.15.m1.1.1" xref="alg2.15.15.m1.1.1.cmml"><mi id="alg2.15.15.m1.1.1.2" mathsize="90%" xref="alg2.15.15.m1.1.1.2.cmml">x</mi><mo id="alg2.15.15.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.15.15.m1.1.1.1.cmml">←</mo><mi id="alg2.15.15.m1.1.1.3" xref="alg2.15.15.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.15.15.m1.1b"><apply id="alg2.15.15.m1.1.1.cmml" xref="alg2.15.15.m1.1.1"><ci id="alg2.15.15.m1.1.1.1.cmml" xref="alg2.15.15.m1.1.1.1">←</ci><ci id="alg2.15.15.m1.1.1.2.cmml" xref="alg2.15.15.m1.1.1.2">𝑥</ci><csymbol cd="latexml" id="alg2.15.15.m1.1.1.3.cmml" xref="alg2.15.15.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.15.15.m1.1c">x\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.15.15.m1.1d">italic_x ←</annotation></semantics></math><span class="ltx_text" id="alg2.17.17.5" style="font-size:90%;"> Stem(</span><math alttext="x" class="ltx_Math" display="inline" id="alg2.16.16.m2.1"><semantics id="alg2.16.16.m2.1a"><mi id="alg2.16.16.m2.1.1" mathsize="90%" xref="alg2.16.16.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.16.16.m2.1b"><ci id="alg2.16.16.m2.1.1.cmml" xref="alg2.16.16.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.16.16.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.16.16.m2.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.17.17.6" style="font-size:90%;">, </span><math alttext="x\_down[0]" class="ltx_Math" display="inline" id="alg2.17.17.m3.1"><semantics id="alg2.17.17.m3.1a"><mrow id="alg2.17.17.m3.1.2" xref="alg2.17.17.m3.1.2.cmml"><mi id="alg2.17.17.m3.1.2.2" mathsize="90%" xref="alg2.17.17.m3.1.2.2.cmml">x</mi><mo id="alg2.17.17.m3.1.2.1" xref="alg2.17.17.m3.1.2.1.cmml">⁢</mo><mi id="alg2.17.17.m3.1.2.3" mathsize="90%" mathvariant="normal" xref="alg2.17.17.m3.1.2.3.cmml">_</mi><mo id="alg2.17.17.m3.1.2.1a" xref="alg2.17.17.m3.1.2.1.cmml">⁢</mo><mi id="alg2.17.17.m3.1.2.4" mathsize="90%" xref="alg2.17.17.m3.1.2.4.cmml">d</mi><mo id="alg2.17.17.m3.1.2.1b" xref="alg2.17.17.m3.1.2.1.cmml">⁢</mo><mi id="alg2.17.17.m3.1.2.5" mathsize="90%" xref="alg2.17.17.m3.1.2.5.cmml">o</mi><mo id="alg2.17.17.m3.1.2.1c" xref="alg2.17.17.m3.1.2.1.cmml">⁢</mo><mi id="alg2.17.17.m3.1.2.6" mathsize="90%" xref="alg2.17.17.m3.1.2.6.cmml">w</mi><mo id="alg2.17.17.m3.1.2.1d" xref="alg2.17.17.m3.1.2.1.cmml">⁢</mo><mi id="alg2.17.17.m3.1.2.7" mathsize="90%" xref="alg2.17.17.m3.1.2.7.cmml">n</mi><mo id="alg2.17.17.m3.1.2.1e" xref="alg2.17.17.m3.1.2.1.cmml">⁢</mo><mrow id="alg2.17.17.m3.1.2.8.2" xref="alg2.17.17.m3.1.2.8.1.cmml"><mo id="alg2.17.17.m3.1.2.8.2.1" maxsize="90%" minsize="90%" xref="alg2.17.17.m3.1.2.8.1.1.cmml">[</mo><mn id="alg2.17.17.m3.1.1" mathsize="90%" xref="alg2.17.17.m3.1.1.cmml">0</mn><mo id="alg2.17.17.m3.1.2.8.2.2" maxsize="90%" minsize="90%" xref="alg2.17.17.m3.1.2.8.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.17.17.m3.1b"><apply id="alg2.17.17.m3.1.2.cmml" xref="alg2.17.17.m3.1.2"><times id="alg2.17.17.m3.1.2.1.cmml" xref="alg2.17.17.m3.1.2.1"></times><ci id="alg2.17.17.m3.1.2.2.cmml" xref="alg2.17.17.m3.1.2.2">𝑥</ci><ci id="alg2.17.17.m3.1.2.3.cmml" xref="alg2.17.17.m3.1.2.3">_</ci><ci id="alg2.17.17.m3.1.2.4.cmml" xref="alg2.17.17.m3.1.2.4">𝑑</ci><ci id="alg2.17.17.m3.1.2.5.cmml" xref="alg2.17.17.m3.1.2.5">𝑜</ci><ci id="alg2.17.17.m3.1.2.6.cmml" xref="alg2.17.17.m3.1.2.6">𝑤</ci><ci id="alg2.17.17.m3.1.2.7.cmml" xref="alg2.17.17.m3.1.2.7">𝑛</ci><apply id="alg2.17.17.m3.1.2.8.1.cmml" xref="alg2.17.17.m3.1.2.8.2"><csymbol cd="latexml" id="alg2.17.17.m3.1.2.8.1.1.cmml" xref="alg2.17.17.m3.1.2.8.2.1">delimited-[]</csymbol><cn id="alg2.17.17.m3.1.1.cmml" type="integer" xref="alg2.17.17.m3.1.1">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.17.17.m3.1c">x\_down[0]</annotation><annotation encoding="application/x-llamapun" id="alg2.17.17.m3.1d">italic_x _ italic_d italic_o italic_w italic_n [ 0 ]</annotation></semantics></math><span class="ltx_text" id="alg2.17.17.7" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg2.19.19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.19.19.3.1.1" style="font-size:90%;">12</span></span><span class="ltx_text" id="alg2.19.19.4" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.19.19.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.19.19.6" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg2.19.19.7" style="font-size:90%;">for</span><span class="ltx_text" id="alg2.19.19.8" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg2.19.19.2" style="font-size:90%;"><math alttext="i\leftarrow 0" class="ltx_Math" display="inline" id="alg2.18.18.1.m1.1"><semantics id="alg2.18.18.1.m1.1a"><mrow id="alg2.18.18.1.m1.1.1" xref="alg2.18.18.1.m1.1.1.cmml"><mi id="alg2.18.18.1.m1.1.1.2" xref="alg2.18.18.1.m1.1.1.2.cmml">i</mi><mo id="alg2.18.18.1.m1.1.1.1" stretchy="false" xref="alg2.18.18.1.m1.1.1.1.cmml">←</mo><mn id="alg2.18.18.1.m1.1.1.3" xref="alg2.18.18.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.18.18.1.m1.1b"><apply id="alg2.18.18.1.m1.1.1.cmml" xref="alg2.18.18.1.m1.1.1"><ci id="alg2.18.18.1.m1.1.1.1.cmml" xref="alg2.18.18.1.m1.1.1.1">←</ci><ci id="alg2.18.18.1.m1.1.1.2.cmml" xref="alg2.18.18.1.m1.1.1.2">𝑖</ci><cn id="alg2.18.18.1.m1.1.1.3.cmml" type="integer" xref="alg2.18.18.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.18.18.1.m1.1c">i\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg2.18.18.1.m1.1d">italic_i ← 0</annotation></semantics></math> <span class="ltx_text ltx_font_bold ltx_font_upright" id="alg2.19.19.2.1">to</span> <math alttext="2" class="ltx_Math" display="inline" id="alg2.19.19.2.m2.1"><semantics id="alg2.19.19.2.m2.1a"><mn id="alg2.19.19.2.m2.1.1" xref="alg2.19.19.2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="alg2.19.19.2.m2.1b"><cn id="alg2.19.19.2.m2.1.1.cmml" type="integer" xref="alg2.19.19.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="alg2.19.19.2.m2.1c">2</annotation><annotation encoding="application/x-llamapun" id="alg2.19.19.2.m2.1d">2</annotation></semantics></math></em><span class="ltx_text" id="alg2.19.19.9" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.19.19.10" style="font-size:90%;">do</span>
</div>
<div class="ltx_listingline" id="alg2.22.22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.22.22.3.1.1" style="font-size:90%;">13</span></span><span class="ltx_text" id="alg2.22.22.4" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.22.22.5" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.22.22.6" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.22.22.7" style="font-size:90%;">
</span><math alttext="x\leftarrow" class="ltx_Math" display="inline" id="alg2.20.20.m1.1"><semantics id="alg2.20.20.m1.1a"><mrow id="alg2.20.20.m1.1.1" xref="alg2.20.20.m1.1.1.cmml"><mi id="alg2.20.20.m1.1.1.2" mathsize="90%" xref="alg2.20.20.m1.1.1.2.cmml">x</mi><mo id="alg2.20.20.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.20.20.m1.1.1.1.cmml">←</mo><mi id="alg2.20.20.m1.1.1.3" xref="alg2.20.20.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.20.20.m1.1b"><apply id="alg2.20.20.m1.1.1.cmml" xref="alg2.20.20.m1.1.1"><ci id="alg2.20.20.m1.1.1.1.cmml" xref="alg2.20.20.m1.1.1.1">←</ci><ci id="alg2.20.20.m1.1.1.2.cmml" xref="alg2.20.20.m1.1.1.2">𝑥</ci><csymbol cd="latexml" id="alg2.20.20.m1.1.1.3.cmml" xref="alg2.20.20.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.20.20.m1.1c">x\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.20.20.m1.1d">italic_x ←</annotation></semantics></math><span class="ltx_text" id="alg2.22.22.8" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="alg2.22.22.2" style="font-size:90%;">StageProcess(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.22.22.2.2"><math alttext="x" class="ltx_Math" display="inline" id="alg2.21.21.1.1.m1.1"><semantics id="alg2.21.21.1.1.m1.1a"><mi id="alg2.21.21.1.1.m1.1.1" xref="alg2.21.21.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.21.21.1.1.m1.1b"><ci id="alg2.21.21.1.1.m1.1.1.cmml" xref="alg2.21.21.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.21.21.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.21.21.1.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="i" class="ltx_Math" display="inline" id="alg2.22.22.2.2.m2.1"><semantics id="alg2.22.22.2.2.m2.1a"><mi id="alg2.22.22.2.2.m2.1.1" xref="alg2.22.22.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.22.22.2.2.m2.1b"><ci id="alg2.22.22.2.2.m2.1.1.cmml" xref="alg2.22.22.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.22.22.2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg2.22.22.2.2.m2.1d">italic_i</annotation></semantics></math></em>)</span><span class="ltx_text" id="alg2.22.22.9" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg2.24.24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.24.24.1.1.1" style="font-size:90%;">14</span></span><span class="ltx_text" id="alg2.24.24.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.24.24.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.24.24.4" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.24.24.5" style="font-size:90%;">
</span><math alttext="features" class="ltx_Math" display="inline" id="alg2.23.23.m1.1"><semantics id="alg2.23.23.m1.1a"><mrow id="alg2.23.23.m1.1.1" xref="alg2.23.23.m1.1.1.cmml"><mi id="alg2.23.23.m1.1.1.2" mathsize="90%" xref="alg2.23.23.m1.1.1.2.cmml">f</mi><mo id="alg2.23.23.m1.1.1.1" xref="alg2.23.23.m1.1.1.1.cmml">⁢</mo><mi id="alg2.23.23.m1.1.1.3" mathsize="90%" xref="alg2.23.23.m1.1.1.3.cmml">e</mi><mo id="alg2.23.23.m1.1.1.1a" xref="alg2.23.23.m1.1.1.1.cmml">⁢</mo><mi id="alg2.23.23.m1.1.1.4" mathsize="90%" xref="alg2.23.23.m1.1.1.4.cmml">a</mi><mo id="alg2.23.23.m1.1.1.1b" xref="alg2.23.23.m1.1.1.1.cmml">⁢</mo><mi id="alg2.23.23.m1.1.1.5" mathsize="90%" xref="alg2.23.23.m1.1.1.5.cmml">t</mi><mo id="alg2.23.23.m1.1.1.1c" xref="alg2.23.23.m1.1.1.1.cmml">⁢</mo><mi id="alg2.23.23.m1.1.1.6" mathsize="90%" xref="alg2.23.23.m1.1.1.6.cmml">u</mi><mo id="alg2.23.23.m1.1.1.1d" xref="alg2.23.23.m1.1.1.1.cmml">⁢</mo><mi id="alg2.23.23.m1.1.1.7" mathsize="90%" xref="alg2.23.23.m1.1.1.7.cmml">r</mi><mo id="alg2.23.23.m1.1.1.1e" xref="alg2.23.23.m1.1.1.1.cmml">⁢</mo><mi id="alg2.23.23.m1.1.1.8" mathsize="90%" xref="alg2.23.23.m1.1.1.8.cmml">e</mi><mo id="alg2.23.23.m1.1.1.1f" xref="alg2.23.23.m1.1.1.1.cmml">⁢</mo><mi id="alg2.23.23.m1.1.1.9" mathsize="90%" xref="alg2.23.23.m1.1.1.9.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.23.23.m1.1b"><apply id="alg2.23.23.m1.1.1.cmml" xref="alg2.23.23.m1.1.1"><times id="alg2.23.23.m1.1.1.1.cmml" xref="alg2.23.23.m1.1.1.1"></times><ci id="alg2.23.23.m1.1.1.2.cmml" xref="alg2.23.23.m1.1.1.2">𝑓</ci><ci id="alg2.23.23.m1.1.1.3.cmml" xref="alg2.23.23.m1.1.1.3">𝑒</ci><ci id="alg2.23.23.m1.1.1.4.cmml" xref="alg2.23.23.m1.1.1.4">𝑎</ci><ci id="alg2.23.23.m1.1.1.5.cmml" xref="alg2.23.23.m1.1.1.5">𝑡</ci><ci id="alg2.23.23.m1.1.1.6.cmml" xref="alg2.23.23.m1.1.1.6">𝑢</ci><ci id="alg2.23.23.m1.1.1.7.cmml" xref="alg2.23.23.m1.1.1.7">𝑟</ci><ci id="alg2.23.23.m1.1.1.8.cmml" xref="alg2.23.23.m1.1.1.8">𝑒</ci><ci id="alg2.23.23.m1.1.1.9.cmml" xref="alg2.23.23.m1.1.1.9">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.23.23.m1.1c">features</annotation><annotation encoding="application/x-llamapun" id="alg2.23.23.m1.1d">italic_f italic_e italic_a italic_t italic_u italic_r italic_e italic_s</annotation></semantics></math><span class="ltx_text" id="alg2.24.24.6" style="font-size:90%;">.append(</span><math alttext="x" class="ltx_Math" display="inline" id="alg2.24.24.m2.1"><semantics id="alg2.24.24.m2.1a"><mi id="alg2.24.24.m2.1.1" mathsize="90%" xref="alg2.24.24.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.24.24.m2.1b"><ci id="alg2.24.24.m2.1.1.cmml" xref="alg2.24.24.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.24.24.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.24.24.m2.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.24.24.7" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg2.25.25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.25.25.2.1.1" style="font-size:90%;">15</span></span><span class="ltx_text" id="alg2.25.25.3" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.25.25.4" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.25.25.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.25.25.6" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg2.25.25.7" style="font-size:90%;">if</span><span class="ltx_text" id="alg2.25.25.8" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg2.25.25.1" style="font-size:90%;"><math alttext="i&lt;2" class="ltx_Math" display="inline" id="alg2.25.25.1.m1.1"><semantics id="alg2.25.25.1.m1.1a"><mrow id="alg2.25.25.1.m1.1.1" xref="alg2.25.25.1.m1.1.1.cmml"><mi id="alg2.25.25.1.m1.1.1.2" xref="alg2.25.25.1.m1.1.1.2.cmml">i</mi><mo id="alg2.25.25.1.m1.1.1.1" xref="alg2.25.25.1.m1.1.1.1.cmml">&lt;</mo><mn id="alg2.25.25.1.m1.1.1.3" xref="alg2.25.25.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.25.25.1.m1.1b"><apply id="alg2.25.25.1.m1.1.1.cmml" xref="alg2.25.25.1.m1.1.1"><lt id="alg2.25.25.1.m1.1.1.1.cmml" xref="alg2.25.25.1.m1.1.1.1"></lt><ci id="alg2.25.25.1.m1.1.1.2.cmml" xref="alg2.25.25.1.m1.1.1.2">𝑖</ci><cn id="alg2.25.25.1.m1.1.1.3.cmml" type="integer" xref="alg2.25.25.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.25.25.1.m1.1c">i&lt;2</annotation><annotation encoding="application/x-llamapun" id="alg2.25.25.1.m1.1d">italic_i &lt; 2</annotation></semantics></math></em><span class="ltx_text" id="alg2.25.25.9" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.25.25.10" style="font-size:90%;">then</span>
</div>
<div class="ltx_listingline" id="alg2.29.29">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.29.29.4.1.1" style="font-size:90%;">16</span></span><span class="ltx_text" id="alg2.29.29.5" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.29.29.6" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.29.29.7" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.29.29.8" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.29.29.9" style="font-size:90%;">
</span><math alttext="x\leftarrow" class="ltx_Math" display="inline" id="alg2.26.26.m1.1"><semantics id="alg2.26.26.m1.1a"><mrow id="alg2.26.26.m1.1.1" xref="alg2.26.26.m1.1.1.cmml"><mi id="alg2.26.26.m1.1.1.2" mathsize="90%" xref="alg2.26.26.m1.1.1.2.cmml">x</mi><mo id="alg2.26.26.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.26.26.m1.1.1.1.cmml">←</mo><mi id="alg2.26.26.m1.1.1.3" xref="alg2.26.26.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.26.26.m1.1b"><apply id="alg2.26.26.m1.1.1.cmml" xref="alg2.26.26.m1.1.1"><ci id="alg2.26.26.m1.1.1.1.cmml" xref="alg2.26.26.m1.1.1.1">←</ci><ci id="alg2.26.26.m1.1.1.2.cmml" xref="alg2.26.26.m1.1.1.2">𝑥</ci><csymbol cd="latexml" id="alg2.26.26.m1.1.1.3.cmml" xref="alg2.26.26.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.26.26.m1.1c">x\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.26.26.m1.1d">italic_x ←</annotation></semantics></math><span class="ltx_text" id="alg2.29.29.10" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="alg2.29.29.3" style="font-size:90%;">Downsample(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.29.29.3.3"><math alttext="x" class="ltx_Math" display="inline" id="alg2.27.27.1.1.m1.1"><semantics id="alg2.27.27.1.1.m1.1a"><mi id="alg2.27.27.1.1.m1.1.1" xref="alg2.27.27.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.27.27.1.1.m1.1b"><ci id="alg2.27.27.1.1.m1.1.1.cmml" xref="alg2.27.27.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.27.27.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.27.27.1.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="x\_down[i+1]" class="ltx_Math" display="inline" id="alg2.28.28.2.2.m2.1"><semantics id="alg2.28.28.2.2.m2.1a"><mrow id="alg2.28.28.2.2.m2.1.1" xref="alg2.28.28.2.2.m2.1.1.cmml"><mi id="alg2.28.28.2.2.m2.1.1.3" xref="alg2.28.28.2.2.m2.1.1.3.cmml">x</mi><mo id="alg2.28.28.2.2.m2.1.1.2" xref="alg2.28.28.2.2.m2.1.1.2.cmml">⁢</mo><mi id="alg2.28.28.2.2.m2.1.1.4" mathvariant="normal" xref="alg2.28.28.2.2.m2.1.1.4.cmml">_</mi><mo id="alg2.28.28.2.2.m2.1.1.2a" xref="alg2.28.28.2.2.m2.1.1.2.cmml">⁢</mo><mi id="alg2.28.28.2.2.m2.1.1.5" xref="alg2.28.28.2.2.m2.1.1.5.cmml">d</mi><mo id="alg2.28.28.2.2.m2.1.1.2b" xref="alg2.28.28.2.2.m2.1.1.2.cmml">⁢</mo><mi id="alg2.28.28.2.2.m2.1.1.6" xref="alg2.28.28.2.2.m2.1.1.6.cmml">o</mi><mo id="alg2.28.28.2.2.m2.1.1.2c" xref="alg2.28.28.2.2.m2.1.1.2.cmml">⁢</mo><mi id="alg2.28.28.2.2.m2.1.1.7" xref="alg2.28.28.2.2.m2.1.1.7.cmml">w</mi><mo id="alg2.28.28.2.2.m2.1.1.2d" xref="alg2.28.28.2.2.m2.1.1.2.cmml">⁢</mo><mi id="alg2.28.28.2.2.m2.1.1.8" xref="alg2.28.28.2.2.m2.1.1.8.cmml">n</mi><mo id="alg2.28.28.2.2.m2.1.1.2e" xref="alg2.28.28.2.2.m2.1.1.2.cmml">⁢</mo><mrow id="alg2.28.28.2.2.m2.1.1.1.1" xref="alg2.28.28.2.2.m2.1.1.1.2.cmml"><mo id="alg2.28.28.2.2.m2.1.1.1.1.2" stretchy="false" xref="alg2.28.28.2.2.m2.1.1.1.2.1.cmml">[</mo><mrow id="alg2.28.28.2.2.m2.1.1.1.1.1" xref="alg2.28.28.2.2.m2.1.1.1.1.1.cmml"><mi id="alg2.28.28.2.2.m2.1.1.1.1.1.2" xref="alg2.28.28.2.2.m2.1.1.1.1.1.2.cmml">i</mi><mo id="alg2.28.28.2.2.m2.1.1.1.1.1.1" xref="alg2.28.28.2.2.m2.1.1.1.1.1.1.cmml">+</mo><mn id="alg2.28.28.2.2.m2.1.1.1.1.1.3" xref="alg2.28.28.2.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg2.28.28.2.2.m2.1.1.1.1.3" stretchy="false" xref="alg2.28.28.2.2.m2.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.28.28.2.2.m2.1b"><apply id="alg2.28.28.2.2.m2.1.1.cmml" xref="alg2.28.28.2.2.m2.1.1"><times id="alg2.28.28.2.2.m2.1.1.2.cmml" xref="alg2.28.28.2.2.m2.1.1.2"></times><ci id="alg2.28.28.2.2.m2.1.1.3.cmml" xref="alg2.28.28.2.2.m2.1.1.3">𝑥</ci><ci id="alg2.28.28.2.2.m2.1.1.4.cmml" xref="alg2.28.28.2.2.m2.1.1.4">_</ci><ci id="alg2.28.28.2.2.m2.1.1.5.cmml" xref="alg2.28.28.2.2.m2.1.1.5">𝑑</ci><ci id="alg2.28.28.2.2.m2.1.1.6.cmml" xref="alg2.28.28.2.2.m2.1.1.6">𝑜</ci><ci id="alg2.28.28.2.2.m2.1.1.7.cmml" xref="alg2.28.28.2.2.m2.1.1.7">𝑤</ci><ci id="alg2.28.28.2.2.m2.1.1.8.cmml" xref="alg2.28.28.2.2.m2.1.1.8">𝑛</ci><apply id="alg2.28.28.2.2.m2.1.1.1.2.cmml" xref="alg2.28.28.2.2.m2.1.1.1.1"><csymbol cd="latexml" id="alg2.28.28.2.2.m2.1.1.1.2.1.cmml" xref="alg2.28.28.2.2.m2.1.1.1.1.2">delimited-[]</csymbol><apply id="alg2.28.28.2.2.m2.1.1.1.1.1.cmml" xref="alg2.28.28.2.2.m2.1.1.1.1.1"><plus id="alg2.28.28.2.2.m2.1.1.1.1.1.1.cmml" xref="alg2.28.28.2.2.m2.1.1.1.1.1.1"></plus><ci id="alg2.28.28.2.2.m2.1.1.1.1.1.2.cmml" xref="alg2.28.28.2.2.m2.1.1.1.1.1.2">𝑖</ci><cn id="alg2.28.28.2.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="alg2.28.28.2.2.m2.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.28.28.2.2.m2.1c">x\_down[i+1]</annotation><annotation encoding="application/x-llamapun" id="alg2.28.28.2.2.m2.1d">italic_x _ italic_d italic_o italic_w italic_n [ italic_i + 1 ]</annotation></semantics></math>, <math alttext="features" class="ltx_Math" display="inline" id="alg2.29.29.3.3.m3.1"><semantics id="alg2.29.29.3.3.m3.1a"><mrow id="alg2.29.29.3.3.m3.1.1" xref="alg2.29.29.3.3.m3.1.1.cmml"><mi id="alg2.29.29.3.3.m3.1.1.2" xref="alg2.29.29.3.3.m3.1.1.2.cmml">f</mi><mo id="alg2.29.29.3.3.m3.1.1.1" xref="alg2.29.29.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.29.29.3.3.m3.1.1.3" xref="alg2.29.29.3.3.m3.1.1.3.cmml">e</mi><mo id="alg2.29.29.3.3.m3.1.1.1a" xref="alg2.29.29.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.29.29.3.3.m3.1.1.4" xref="alg2.29.29.3.3.m3.1.1.4.cmml">a</mi><mo id="alg2.29.29.3.3.m3.1.1.1b" xref="alg2.29.29.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.29.29.3.3.m3.1.1.5" xref="alg2.29.29.3.3.m3.1.1.5.cmml">t</mi><mo id="alg2.29.29.3.3.m3.1.1.1c" xref="alg2.29.29.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.29.29.3.3.m3.1.1.6" xref="alg2.29.29.3.3.m3.1.1.6.cmml">u</mi><mo id="alg2.29.29.3.3.m3.1.1.1d" xref="alg2.29.29.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.29.29.3.3.m3.1.1.7" xref="alg2.29.29.3.3.m3.1.1.7.cmml">r</mi><mo id="alg2.29.29.3.3.m3.1.1.1e" xref="alg2.29.29.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.29.29.3.3.m3.1.1.8" xref="alg2.29.29.3.3.m3.1.1.8.cmml">e</mi><mo id="alg2.29.29.3.3.m3.1.1.1f" xref="alg2.29.29.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.29.29.3.3.m3.1.1.9" xref="alg2.29.29.3.3.m3.1.1.9.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.29.29.3.3.m3.1b"><apply id="alg2.29.29.3.3.m3.1.1.cmml" xref="alg2.29.29.3.3.m3.1.1"><times id="alg2.29.29.3.3.m3.1.1.1.cmml" xref="alg2.29.29.3.3.m3.1.1.1"></times><ci id="alg2.29.29.3.3.m3.1.1.2.cmml" xref="alg2.29.29.3.3.m3.1.1.2">𝑓</ci><ci id="alg2.29.29.3.3.m3.1.1.3.cmml" xref="alg2.29.29.3.3.m3.1.1.3">𝑒</ci><ci id="alg2.29.29.3.3.m3.1.1.4.cmml" xref="alg2.29.29.3.3.m3.1.1.4">𝑎</ci><ci id="alg2.29.29.3.3.m3.1.1.5.cmml" xref="alg2.29.29.3.3.m3.1.1.5">𝑡</ci><ci id="alg2.29.29.3.3.m3.1.1.6.cmml" xref="alg2.29.29.3.3.m3.1.1.6">𝑢</ci><ci id="alg2.29.29.3.3.m3.1.1.7.cmml" xref="alg2.29.29.3.3.m3.1.1.7">𝑟</ci><ci id="alg2.29.29.3.3.m3.1.1.8.cmml" xref="alg2.29.29.3.3.m3.1.1.8">𝑒</ci><ci id="alg2.29.29.3.3.m3.1.1.9.cmml" xref="alg2.29.29.3.3.m3.1.1.9">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.29.29.3.3.m3.1c">features</annotation><annotation encoding="application/x-llamapun" id="alg2.29.29.3.3.m3.1d">italic_f italic_e italic_a italic_t italic_u italic_r italic_e italic_s</annotation></semantics></math></em>)</span><span class="ltx_text" id="alg2.29.29.11" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg2.70.74">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.74.1.1.1" style="font-size:90%;">17</span></span><span class="ltx_text" id="alg2.70.74.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.74.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.74.4" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.74.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.70.74.6" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.70.75">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.75.1.1.1" style="font-size:90%;">18</span></span><span class="ltx_text" id="alg2.70.75.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.75.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.75.4" style="font-size:90%;">   </span>
</div>
<div class="ltx_listingline" id="alg2.30.30">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.30.30.1.1.1" style="font-size:90%;">19</span></span><span class="ltx_text" id="alg2.30.30.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.30.30.3" style="font-size:90%;">   </span><span class="ltx_text ltx_font_bold" id="alg2.30.30.4" style="font-size:90%;">return</span><span class="ltx_text" id="alg2.30.30.5" style="font-size:90%;"> </span><math alttext="features" class="ltx_Math" display="inline" id="alg2.30.30.m1.1"><semantics id="alg2.30.30.m1.1a"><mrow id="alg2.30.30.m1.1.1" xref="alg2.30.30.m1.1.1.cmml"><mi id="alg2.30.30.m1.1.1.2" mathsize="90%" xref="alg2.30.30.m1.1.1.2.cmml">f</mi><mo id="alg2.30.30.m1.1.1.1" xref="alg2.30.30.m1.1.1.1.cmml">⁢</mo><mi id="alg2.30.30.m1.1.1.3" mathsize="90%" xref="alg2.30.30.m1.1.1.3.cmml">e</mi><mo id="alg2.30.30.m1.1.1.1a" xref="alg2.30.30.m1.1.1.1.cmml">⁢</mo><mi id="alg2.30.30.m1.1.1.4" mathsize="90%" xref="alg2.30.30.m1.1.1.4.cmml">a</mi><mo id="alg2.30.30.m1.1.1.1b" xref="alg2.30.30.m1.1.1.1.cmml">⁢</mo><mi id="alg2.30.30.m1.1.1.5" mathsize="90%" xref="alg2.30.30.m1.1.1.5.cmml">t</mi><mo id="alg2.30.30.m1.1.1.1c" xref="alg2.30.30.m1.1.1.1.cmml">⁢</mo><mi id="alg2.30.30.m1.1.1.6" mathsize="90%" xref="alg2.30.30.m1.1.1.6.cmml">u</mi><mo id="alg2.30.30.m1.1.1.1d" xref="alg2.30.30.m1.1.1.1.cmml">⁢</mo><mi id="alg2.30.30.m1.1.1.7" mathsize="90%" xref="alg2.30.30.m1.1.1.7.cmml">r</mi><mo id="alg2.30.30.m1.1.1.1e" xref="alg2.30.30.m1.1.1.1.cmml">⁢</mo><mi id="alg2.30.30.m1.1.1.8" mathsize="90%" xref="alg2.30.30.m1.1.1.8.cmml">e</mi><mo id="alg2.30.30.m1.1.1.1f" xref="alg2.30.30.m1.1.1.1.cmml">⁢</mo><mi id="alg2.30.30.m1.1.1.9" mathsize="90%" xref="alg2.30.30.m1.1.1.9.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.30.30.m1.1b"><apply id="alg2.30.30.m1.1.1.cmml" xref="alg2.30.30.m1.1.1"><times id="alg2.30.30.m1.1.1.1.cmml" xref="alg2.30.30.m1.1.1.1"></times><ci id="alg2.30.30.m1.1.1.2.cmml" xref="alg2.30.30.m1.1.1.2">𝑓</ci><ci id="alg2.30.30.m1.1.1.3.cmml" xref="alg2.30.30.m1.1.1.3">𝑒</ci><ci id="alg2.30.30.m1.1.1.4.cmml" xref="alg2.30.30.m1.1.1.4">𝑎</ci><ci id="alg2.30.30.m1.1.1.5.cmml" xref="alg2.30.30.m1.1.1.5">𝑡</ci><ci id="alg2.30.30.m1.1.1.6.cmml" xref="alg2.30.30.m1.1.1.6">𝑢</ci><ci id="alg2.30.30.m1.1.1.7.cmml" xref="alg2.30.30.m1.1.1.7">𝑟</ci><ci id="alg2.30.30.m1.1.1.8.cmml" xref="alg2.30.30.m1.1.1.8">𝑒</ci><ci id="alg2.30.30.m1.1.1.9.cmml" xref="alg2.30.30.m1.1.1.9">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.30.30.m1.1c">features</annotation><annotation encoding="application/x-llamapun" id="alg2.30.30.m1.1d">italic_f italic_e italic_a italic_t italic_u italic_r italic_e italic_s</annotation></semantics></math><span class="ltx_text" id="alg2.30.30.6" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg2.70.76">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.76.1.1.1" style="font-size:90%;">20</span></span><span class="ltx_text" id="alg2.70.76.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.76.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.70.76.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.70.77">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.77.1.1.1" style="font-size:90%;">21</span></span>
</div>
<div class="ltx_listingline" id="alg2.32.32">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.32.32.3.1.1" style="font-size:90%;">22</span></span><span class="ltx_text ltx_font_bold" id="alg2.32.32.4" style="font-size:90%;">Function</span><span class="ltx_text" id="alg2.32.32.5" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_typewriter" id="alg2.32.32.2" style="font-size:90%;">StageProcess(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.32.32.2.2.2"><math alttext="x" class="ltx_Math" display="inline" id="alg2.31.31.1.1.1.m1.1"><semantics id="alg2.31.31.1.1.1.m1.1a"><mi id="alg2.31.31.1.1.1.m1.1.1" xref="alg2.31.31.1.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.31.31.1.1.1.m1.1b"><ci id="alg2.31.31.1.1.1.m1.1.1.cmml" xref="alg2.31.31.1.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.31.31.1.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.31.31.1.1.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="i" class="ltx_Math" display="inline" id="alg2.32.32.2.2.2.m2.1"><semantics id="alg2.32.32.2.2.2.m2.1a"><mi id="alg2.32.32.2.2.2.m2.1.1" xref="alg2.32.32.2.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.32.32.2.2.2.m2.1b"><ci id="alg2.32.32.2.2.2.m2.1.1.cmml" xref="alg2.32.32.2.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.32.32.2.2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg2.32.32.2.2.2.m2.1d">italic_i</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="alg2.32.32.6" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="alg2.34.34">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.34.34.3.1.1" style="font-size:90%;">23</span></span><span class="ltx_text" id="alg2.34.34.4" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.34.34.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.34.34.6" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg2.34.34.7" style="font-size:90%;">for</span><span class="ltx_text" id="alg2.34.34.8" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg2.34.34.2" style="font-size:90%;"><math alttext="j\leftarrow 0" class="ltx_Math" display="inline" id="alg2.33.33.1.m1.1"><semantics id="alg2.33.33.1.m1.1a"><mrow id="alg2.33.33.1.m1.1.1" xref="alg2.33.33.1.m1.1.1.cmml"><mi id="alg2.33.33.1.m1.1.1.2" xref="alg2.33.33.1.m1.1.1.2.cmml">j</mi><mo id="alg2.33.33.1.m1.1.1.1" stretchy="false" xref="alg2.33.33.1.m1.1.1.1.cmml">←</mo><mn id="alg2.33.33.1.m1.1.1.3" xref="alg2.33.33.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.33.33.1.m1.1b"><apply id="alg2.33.33.1.m1.1.1.cmml" xref="alg2.33.33.1.m1.1.1"><ci id="alg2.33.33.1.m1.1.1.1.cmml" xref="alg2.33.33.1.m1.1.1.1">←</ci><ci id="alg2.33.33.1.m1.1.1.2.cmml" xref="alg2.33.33.1.m1.1.1.2">𝑗</ci><cn id="alg2.33.33.1.m1.1.1.3.cmml" type="integer" xref="alg2.33.33.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.33.33.1.m1.1c">j\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg2.33.33.1.m1.1d">italic_j ← 0</annotation></semantics></math> <span class="ltx_text ltx_font_bold ltx_font_upright" id="alg2.34.34.2.1">to</span> <math alttext="depth[i]-1" class="ltx_Math" display="inline" id="alg2.34.34.2.m2.1"><semantics id="alg2.34.34.2.m2.1a"><mrow id="alg2.34.34.2.m2.1.2" xref="alg2.34.34.2.m2.1.2.cmml"><mrow id="alg2.34.34.2.m2.1.2.2" xref="alg2.34.34.2.m2.1.2.2.cmml"><mi id="alg2.34.34.2.m2.1.2.2.2" xref="alg2.34.34.2.m2.1.2.2.2.cmml">d</mi><mo id="alg2.34.34.2.m2.1.2.2.1" xref="alg2.34.34.2.m2.1.2.2.1.cmml">⁢</mo><mi id="alg2.34.34.2.m2.1.2.2.3" xref="alg2.34.34.2.m2.1.2.2.3.cmml">e</mi><mo id="alg2.34.34.2.m2.1.2.2.1a" xref="alg2.34.34.2.m2.1.2.2.1.cmml">⁢</mo><mi id="alg2.34.34.2.m2.1.2.2.4" xref="alg2.34.34.2.m2.1.2.2.4.cmml">p</mi><mo id="alg2.34.34.2.m2.1.2.2.1b" xref="alg2.34.34.2.m2.1.2.2.1.cmml">⁢</mo><mi id="alg2.34.34.2.m2.1.2.2.5" xref="alg2.34.34.2.m2.1.2.2.5.cmml">t</mi><mo id="alg2.34.34.2.m2.1.2.2.1c" xref="alg2.34.34.2.m2.1.2.2.1.cmml">⁢</mo><mi id="alg2.34.34.2.m2.1.2.2.6" xref="alg2.34.34.2.m2.1.2.2.6.cmml">h</mi><mo id="alg2.34.34.2.m2.1.2.2.1d" xref="alg2.34.34.2.m2.1.2.2.1.cmml">⁢</mo><mrow id="alg2.34.34.2.m2.1.2.2.7.2" xref="alg2.34.34.2.m2.1.2.2.7.1.cmml"><mo id="alg2.34.34.2.m2.1.2.2.7.2.1" stretchy="false" xref="alg2.34.34.2.m2.1.2.2.7.1.1.cmml">[</mo><mi id="alg2.34.34.2.m2.1.1" xref="alg2.34.34.2.m2.1.1.cmml">i</mi><mo id="alg2.34.34.2.m2.1.2.2.7.2.2" stretchy="false" xref="alg2.34.34.2.m2.1.2.2.7.1.1.cmml">]</mo></mrow></mrow><mo id="alg2.34.34.2.m2.1.2.1" xref="alg2.34.34.2.m2.1.2.1.cmml">−</mo><mn id="alg2.34.34.2.m2.1.2.3" xref="alg2.34.34.2.m2.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.34.34.2.m2.1b"><apply id="alg2.34.34.2.m2.1.2.cmml" xref="alg2.34.34.2.m2.1.2"><minus id="alg2.34.34.2.m2.1.2.1.cmml" xref="alg2.34.34.2.m2.1.2.1"></minus><apply id="alg2.34.34.2.m2.1.2.2.cmml" xref="alg2.34.34.2.m2.1.2.2"><times id="alg2.34.34.2.m2.1.2.2.1.cmml" xref="alg2.34.34.2.m2.1.2.2.1"></times><ci id="alg2.34.34.2.m2.1.2.2.2.cmml" xref="alg2.34.34.2.m2.1.2.2.2">𝑑</ci><ci id="alg2.34.34.2.m2.1.2.2.3.cmml" xref="alg2.34.34.2.m2.1.2.2.3">𝑒</ci><ci id="alg2.34.34.2.m2.1.2.2.4.cmml" xref="alg2.34.34.2.m2.1.2.2.4">𝑝</ci><ci id="alg2.34.34.2.m2.1.2.2.5.cmml" xref="alg2.34.34.2.m2.1.2.2.5">𝑡</ci><ci id="alg2.34.34.2.m2.1.2.2.6.cmml" xref="alg2.34.34.2.m2.1.2.2.6">ℎ</ci><apply id="alg2.34.34.2.m2.1.2.2.7.1.cmml" xref="alg2.34.34.2.m2.1.2.2.7.2"><csymbol cd="latexml" id="alg2.34.34.2.m2.1.2.2.7.1.1.cmml" xref="alg2.34.34.2.m2.1.2.2.7.2.1">delimited-[]</csymbol><ci id="alg2.34.34.2.m2.1.1.cmml" xref="alg2.34.34.2.m2.1.1">𝑖</ci></apply></apply><cn id="alg2.34.34.2.m2.1.2.3.cmml" type="integer" xref="alg2.34.34.2.m2.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.34.34.2.m2.1c">depth[i]-1</annotation><annotation encoding="application/x-llamapun" id="alg2.34.34.2.m2.1d">italic_d italic_e italic_p italic_t italic_h [ italic_i ] - 1</annotation></semantics></math></em><span class="ltx_text" id="alg2.34.34.9" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.34.34.10" style="font-size:90%;">do</span>
</div>
<div class="ltx_listingline" id="alg2.35.35">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.35.35.2.1.1" style="font-size:90%;">24</span></span><span class="ltx_text" id="alg2.35.35.3" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.35.35.4" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.35.35.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.35.35.6" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg2.35.35.7" style="font-size:90%;">if</span><span class="ltx_text" id="alg2.35.35.8" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg2.35.35.1" style="font-size:90%;"><math alttext="j&gt;depth[i]-transformer\_block[i]-1" class="ltx_Math" display="inline" id="alg2.35.35.1.m1.2"><semantics id="alg2.35.35.1.m1.2a"><mrow id="alg2.35.35.1.m1.2.3" xref="alg2.35.35.1.m1.2.3.cmml"><mi id="alg2.35.35.1.m1.2.3.2" xref="alg2.35.35.1.m1.2.3.2.cmml">j</mi><mo id="alg2.35.35.1.m1.2.3.1" xref="alg2.35.35.1.m1.2.3.1.cmml">&gt;</mo><mrow id="alg2.35.35.1.m1.2.3.3" xref="alg2.35.35.1.m1.2.3.3.cmml"><mrow id="alg2.35.35.1.m1.2.3.3.2" xref="alg2.35.35.1.m1.2.3.3.2.cmml"><mi id="alg2.35.35.1.m1.2.3.3.2.2" xref="alg2.35.35.1.m1.2.3.3.2.2.cmml">d</mi><mo id="alg2.35.35.1.m1.2.3.3.2.1" xref="alg2.35.35.1.m1.2.3.3.2.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.2.3" xref="alg2.35.35.1.m1.2.3.3.2.3.cmml">e</mi><mo id="alg2.35.35.1.m1.2.3.3.2.1a" xref="alg2.35.35.1.m1.2.3.3.2.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.2.4" xref="alg2.35.35.1.m1.2.3.3.2.4.cmml">p</mi><mo id="alg2.35.35.1.m1.2.3.3.2.1b" xref="alg2.35.35.1.m1.2.3.3.2.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.2.5" xref="alg2.35.35.1.m1.2.3.3.2.5.cmml">t</mi><mo id="alg2.35.35.1.m1.2.3.3.2.1c" xref="alg2.35.35.1.m1.2.3.3.2.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.2.6" xref="alg2.35.35.1.m1.2.3.3.2.6.cmml">h</mi><mo id="alg2.35.35.1.m1.2.3.3.2.1d" xref="alg2.35.35.1.m1.2.3.3.2.1.cmml">⁢</mo><mrow id="alg2.35.35.1.m1.2.3.3.2.7.2" xref="alg2.35.35.1.m1.2.3.3.2.7.1.cmml"><mo id="alg2.35.35.1.m1.2.3.3.2.7.2.1" stretchy="false" xref="alg2.35.35.1.m1.2.3.3.2.7.1.1.cmml">[</mo><mi id="alg2.35.35.1.m1.1.1" xref="alg2.35.35.1.m1.1.1.cmml">i</mi><mo id="alg2.35.35.1.m1.2.3.3.2.7.2.2" stretchy="false" xref="alg2.35.35.1.m1.2.3.3.2.7.1.1.cmml">]</mo></mrow></mrow><mo id="alg2.35.35.1.m1.2.3.3.1" xref="alg2.35.35.1.m1.2.3.3.1.cmml">−</mo><mrow id="alg2.35.35.1.m1.2.3.3.3" xref="alg2.35.35.1.m1.2.3.3.3.cmml"><mi id="alg2.35.35.1.m1.2.3.3.3.2" xref="alg2.35.35.1.m1.2.3.3.3.2.cmml">t</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.3" xref="alg2.35.35.1.m1.2.3.3.3.3.cmml">r</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1a" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.4" xref="alg2.35.35.1.m1.2.3.3.3.4.cmml">a</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1b" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.5" xref="alg2.35.35.1.m1.2.3.3.3.5.cmml">n</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1c" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.6" xref="alg2.35.35.1.m1.2.3.3.3.6.cmml">s</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1d" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.7" xref="alg2.35.35.1.m1.2.3.3.3.7.cmml">f</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1e" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.8" xref="alg2.35.35.1.m1.2.3.3.3.8.cmml">o</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1f" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.9" xref="alg2.35.35.1.m1.2.3.3.3.9.cmml">r</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1g" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.10" xref="alg2.35.35.1.m1.2.3.3.3.10.cmml">m</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1h" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.11" xref="alg2.35.35.1.m1.2.3.3.3.11.cmml">e</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1i" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.12" xref="alg2.35.35.1.m1.2.3.3.3.12.cmml">r</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1j" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.13" mathvariant="normal" xref="alg2.35.35.1.m1.2.3.3.3.13.cmml">_</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1k" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.14" xref="alg2.35.35.1.m1.2.3.3.3.14.cmml">b</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1l" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.15" xref="alg2.35.35.1.m1.2.3.3.3.15.cmml">l</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1m" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.16" xref="alg2.35.35.1.m1.2.3.3.3.16.cmml">o</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1n" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.17" xref="alg2.35.35.1.m1.2.3.3.3.17.cmml">c</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1o" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="alg2.35.35.1.m1.2.3.3.3.18" xref="alg2.35.35.1.m1.2.3.3.3.18.cmml">k</mi><mo id="alg2.35.35.1.m1.2.3.3.3.1p" xref="alg2.35.35.1.m1.2.3.3.3.1.cmml">⁢</mo><mrow id="alg2.35.35.1.m1.2.3.3.3.19.2" xref="alg2.35.35.1.m1.2.3.3.3.19.1.cmml"><mo id="alg2.35.35.1.m1.2.3.3.3.19.2.1" stretchy="false" xref="alg2.35.35.1.m1.2.3.3.3.19.1.1.cmml">[</mo><mi id="alg2.35.35.1.m1.2.2" xref="alg2.35.35.1.m1.2.2.cmml">i</mi><mo id="alg2.35.35.1.m1.2.3.3.3.19.2.2" stretchy="false" xref="alg2.35.35.1.m1.2.3.3.3.19.1.1.cmml">]</mo></mrow></mrow><mo id="alg2.35.35.1.m1.2.3.3.1a" xref="alg2.35.35.1.m1.2.3.3.1.cmml">−</mo><mn id="alg2.35.35.1.m1.2.3.3.4" xref="alg2.35.35.1.m1.2.3.3.4.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.35.35.1.m1.2b"><apply id="alg2.35.35.1.m1.2.3.cmml" xref="alg2.35.35.1.m1.2.3"><gt id="alg2.35.35.1.m1.2.3.1.cmml" xref="alg2.35.35.1.m1.2.3.1"></gt><ci id="alg2.35.35.1.m1.2.3.2.cmml" xref="alg2.35.35.1.m1.2.3.2">𝑗</ci><apply id="alg2.35.35.1.m1.2.3.3.cmml" xref="alg2.35.35.1.m1.2.3.3"><minus id="alg2.35.35.1.m1.2.3.3.1.cmml" xref="alg2.35.35.1.m1.2.3.3.1"></minus><apply id="alg2.35.35.1.m1.2.3.3.2.cmml" xref="alg2.35.35.1.m1.2.3.3.2"><times id="alg2.35.35.1.m1.2.3.3.2.1.cmml" xref="alg2.35.35.1.m1.2.3.3.2.1"></times><ci id="alg2.35.35.1.m1.2.3.3.2.2.cmml" xref="alg2.35.35.1.m1.2.3.3.2.2">𝑑</ci><ci id="alg2.35.35.1.m1.2.3.3.2.3.cmml" xref="alg2.35.35.1.m1.2.3.3.2.3">𝑒</ci><ci id="alg2.35.35.1.m1.2.3.3.2.4.cmml" xref="alg2.35.35.1.m1.2.3.3.2.4">𝑝</ci><ci id="alg2.35.35.1.m1.2.3.3.2.5.cmml" xref="alg2.35.35.1.m1.2.3.3.2.5">𝑡</ci><ci id="alg2.35.35.1.m1.2.3.3.2.6.cmml" xref="alg2.35.35.1.m1.2.3.3.2.6">ℎ</ci><apply id="alg2.35.35.1.m1.2.3.3.2.7.1.cmml" xref="alg2.35.35.1.m1.2.3.3.2.7.2"><csymbol cd="latexml" id="alg2.35.35.1.m1.2.3.3.2.7.1.1.cmml" xref="alg2.35.35.1.m1.2.3.3.2.7.2.1">delimited-[]</csymbol><ci id="alg2.35.35.1.m1.1.1.cmml" xref="alg2.35.35.1.m1.1.1">𝑖</ci></apply></apply><apply id="alg2.35.35.1.m1.2.3.3.3.cmml" xref="alg2.35.35.1.m1.2.3.3.3"><times id="alg2.35.35.1.m1.2.3.3.3.1.cmml" xref="alg2.35.35.1.m1.2.3.3.3.1"></times><ci id="alg2.35.35.1.m1.2.3.3.3.2.cmml" xref="alg2.35.35.1.m1.2.3.3.3.2">𝑡</ci><ci id="alg2.35.35.1.m1.2.3.3.3.3.cmml" xref="alg2.35.35.1.m1.2.3.3.3.3">𝑟</ci><ci id="alg2.35.35.1.m1.2.3.3.3.4.cmml" xref="alg2.35.35.1.m1.2.3.3.3.4">𝑎</ci><ci id="alg2.35.35.1.m1.2.3.3.3.5.cmml" xref="alg2.35.35.1.m1.2.3.3.3.5">𝑛</ci><ci id="alg2.35.35.1.m1.2.3.3.3.6.cmml" xref="alg2.35.35.1.m1.2.3.3.3.6">𝑠</ci><ci id="alg2.35.35.1.m1.2.3.3.3.7.cmml" xref="alg2.35.35.1.m1.2.3.3.3.7">𝑓</ci><ci id="alg2.35.35.1.m1.2.3.3.3.8.cmml" xref="alg2.35.35.1.m1.2.3.3.3.8">𝑜</ci><ci id="alg2.35.35.1.m1.2.3.3.3.9.cmml" xref="alg2.35.35.1.m1.2.3.3.3.9">𝑟</ci><ci id="alg2.35.35.1.m1.2.3.3.3.10.cmml" xref="alg2.35.35.1.m1.2.3.3.3.10">𝑚</ci><ci id="alg2.35.35.1.m1.2.3.3.3.11.cmml" xref="alg2.35.35.1.m1.2.3.3.3.11">𝑒</ci><ci id="alg2.35.35.1.m1.2.3.3.3.12.cmml" xref="alg2.35.35.1.m1.2.3.3.3.12">𝑟</ci><ci id="alg2.35.35.1.m1.2.3.3.3.13.cmml" xref="alg2.35.35.1.m1.2.3.3.3.13">_</ci><ci id="alg2.35.35.1.m1.2.3.3.3.14.cmml" xref="alg2.35.35.1.m1.2.3.3.3.14">𝑏</ci><ci id="alg2.35.35.1.m1.2.3.3.3.15.cmml" xref="alg2.35.35.1.m1.2.3.3.3.15">𝑙</ci><ci id="alg2.35.35.1.m1.2.3.3.3.16.cmml" xref="alg2.35.35.1.m1.2.3.3.3.16">𝑜</ci><ci id="alg2.35.35.1.m1.2.3.3.3.17.cmml" xref="alg2.35.35.1.m1.2.3.3.3.17">𝑐</ci><ci id="alg2.35.35.1.m1.2.3.3.3.18.cmml" xref="alg2.35.35.1.m1.2.3.3.3.18">𝑘</ci><apply id="alg2.35.35.1.m1.2.3.3.3.19.1.cmml" xref="alg2.35.35.1.m1.2.3.3.3.19.2"><csymbol cd="latexml" id="alg2.35.35.1.m1.2.3.3.3.19.1.1.cmml" xref="alg2.35.35.1.m1.2.3.3.3.19.2.1">delimited-[]</csymbol><ci id="alg2.35.35.1.m1.2.2.cmml" xref="alg2.35.35.1.m1.2.2">𝑖</ci></apply></apply><cn id="alg2.35.35.1.m1.2.3.3.4.cmml" type="integer" xref="alg2.35.35.1.m1.2.3.3.4">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.35.35.1.m1.2c">j&gt;depth[i]-transformer\_block[i]-1</annotation><annotation encoding="application/x-llamapun" id="alg2.35.35.1.m1.2d">italic_j &gt; italic_d italic_e italic_p italic_t italic_h [ italic_i ] - italic_t italic_r italic_a italic_n italic_s italic_f italic_o italic_r italic_m italic_e italic_r _ italic_b italic_l italic_o italic_c italic_k [ italic_i ] - 1</annotation></semantics></math></em><span class="ltx_text" id="alg2.35.35.9" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.35.35.10" style="font-size:90%;">then</span>
</div>
<div class="ltx_listingline" id="alg2.38.38">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.38.38.1.1.1" style="font-size:90%;">25</span></span><span class="ltx_text" id="alg2.38.38.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.38.38.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.38.38.4" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.38.38.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.38.38.6" style="font-size:90%;">
</span><math alttext="x\leftarrow" class="ltx_Math" display="inline" id="alg2.36.36.m1.1"><semantics id="alg2.36.36.m1.1a"><mrow id="alg2.36.36.m1.1.1" xref="alg2.36.36.m1.1.1.cmml"><mi id="alg2.36.36.m1.1.1.2" mathsize="90%" xref="alg2.36.36.m1.1.1.2.cmml">x</mi><mo id="alg2.36.36.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.36.36.m1.1.1.1.cmml">←</mo><mi id="alg2.36.36.m1.1.1.3" xref="alg2.36.36.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.36.36.m1.1b"><apply id="alg2.36.36.m1.1.1.cmml" xref="alg2.36.36.m1.1.1"><ci id="alg2.36.36.m1.1.1.1.cmml" xref="alg2.36.36.m1.1.1.1">←</ci><ci id="alg2.36.36.m1.1.1.2.cmml" xref="alg2.36.36.m1.1.1.2">𝑥</ci><csymbol cd="latexml" id="alg2.36.36.m1.1.1.3.cmml" xref="alg2.36.36.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.36.36.m1.1c">x\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.36.36.m1.1d">italic_x ←</annotation></semantics></math><span class="ltx_text" id="alg2.38.38.7" style="font-size:90%;"> TransformerBlock(</span><math alttext="x" class="ltx_Math" display="inline" id="alg2.37.37.m2.1"><semantics id="alg2.37.37.m2.1a"><mi id="alg2.37.37.m2.1.1" mathsize="90%" xref="alg2.37.37.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.37.37.m2.1b"><ci id="alg2.37.37.m2.1.1.cmml" xref="alg2.37.37.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.37.37.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.37.37.m2.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.38.38.8" style="font-size:90%;">, </span><math alttext="config" class="ltx_Math" display="inline" id="alg2.38.38.m3.1"><semantics id="alg2.38.38.m3.1a"><mrow id="alg2.38.38.m3.1.1" xref="alg2.38.38.m3.1.1.cmml"><mi id="alg2.38.38.m3.1.1.2" mathsize="90%" xref="alg2.38.38.m3.1.1.2.cmml">c</mi><mo id="alg2.38.38.m3.1.1.1" xref="alg2.38.38.m3.1.1.1.cmml">⁢</mo><mi id="alg2.38.38.m3.1.1.3" mathsize="90%" xref="alg2.38.38.m3.1.1.3.cmml">o</mi><mo id="alg2.38.38.m3.1.1.1a" xref="alg2.38.38.m3.1.1.1.cmml">⁢</mo><mi id="alg2.38.38.m3.1.1.4" mathsize="90%" xref="alg2.38.38.m3.1.1.4.cmml">n</mi><mo id="alg2.38.38.m3.1.1.1b" xref="alg2.38.38.m3.1.1.1.cmml">⁢</mo><mi id="alg2.38.38.m3.1.1.5" mathsize="90%" xref="alg2.38.38.m3.1.1.5.cmml">f</mi><mo id="alg2.38.38.m3.1.1.1c" xref="alg2.38.38.m3.1.1.1.cmml">⁢</mo><mi id="alg2.38.38.m3.1.1.6" mathsize="90%" xref="alg2.38.38.m3.1.1.6.cmml">i</mi><mo id="alg2.38.38.m3.1.1.1d" xref="alg2.38.38.m3.1.1.1.cmml">⁢</mo><mi id="alg2.38.38.m3.1.1.7" mathsize="90%" xref="alg2.38.38.m3.1.1.7.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.38.38.m3.1b"><apply id="alg2.38.38.m3.1.1.cmml" xref="alg2.38.38.m3.1.1"><times id="alg2.38.38.m3.1.1.1.cmml" xref="alg2.38.38.m3.1.1.1"></times><ci id="alg2.38.38.m3.1.1.2.cmml" xref="alg2.38.38.m3.1.1.2">𝑐</ci><ci id="alg2.38.38.m3.1.1.3.cmml" xref="alg2.38.38.m3.1.1.3">𝑜</ci><ci id="alg2.38.38.m3.1.1.4.cmml" xref="alg2.38.38.m3.1.1.4">𝑛</ci><ci id="alg2.38.38.m3.1.1.5.cmml" xref="alg2.38.38.m3.1.1.5">𝑓</ci><ci id="alg2.38.38.m3.1.1.6.cmml" xref="alg2.38.38.m3.1.1.6">𝑖</ci><ci id="alg2.38.38.m3.1.1.7.cmml" xref="alg2.38.38.m3.1.1.7">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.38.38.m3.1c">config</annotation><annotation encoding="application/x-llamapun" id="alg2.38.38.m3.1d">italic_c italic_o italic_n italic_f italic_i italic_g</annotation></semantics></math><span class="ltx_text" id="alg2.38.38.9" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg2.70.78">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.78.1.1.1" style="font-size:90%;">26</span></span><span class="ltx_text" id="alg2.70.78.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.78.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.78.4" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.78.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.70.78.6" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.70.79">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.79.1.1.1" style="font-size:90%;">27</span></span><span class="ltx_text" id="alg2.70.79.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.79.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.79.4" style="font-size:90%;">   </span><span class="ltx_text ltx_font_bold" id="alg2.70.79.5" style="font-size:90%;">else</span>
</div>
<div class="ltx_listingline" id="alg2.41.41">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.41.41.1.1.1" style="font-size:90%;">28</span></span><span class="ltx_text" id="alg2.41.41.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.41.41.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.41.41.4" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.41.41.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.41.41.6" style="font-size:90%;">
</span><math alttext="x\leftarrow" class="ltx_Math" display="inline" id="alg2.39.39.m1.1"><semantics id="alg2.39.39.m1.1a"><mrow id="alg2.39.39.m1.1.1" xref="alg2.39.39.m1.1.1.cmml"><mi id="alg2.39.39.m1.1.1.2" mathsize="90%" xref="alg2.39.39.m1.1.1.2.cmml">x</mi><mo id="alg2.39.39.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.39.39.m1.1.1.1.cmml">←</mo><mi id="alg2.39.39.m1.1.1.3" xref="alg2.39.39.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.39.39.m1.1b"><apply id="alg2.39.39.m1.1.1.cmml" xref="alg2.39.39.m1.1.1"><ci id="alg2.39.39.m1.1.1.1.cmml" xref="alg2.39.39.m1.1.1.1">←</ci><ci id="alg2.39.39.m1.1.1.2.cmml" xref="alg2.39.39.m1.1.1.2">𝑥</ci><csymbol cd="latexml" id="alg2.39.39.m1.1.1.3.cmml" xref="alg2.39.39.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.39.39.m1.1c">x\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.39.39.m1.1d">italic_x ←</annotation></semantics></math><span class="ltx_text" id="alg2.41.41.7" style="font-size:90%;"> ConvBlock(</span><math alttext="x" class="ltx_Math" display="inline" id="alg2.40.40.m2.1"><semantics id="alg2.40.40.m2.1a"><mi id="alg2.40.40.m2.1.1" mathsize="90%" xref="alg2.40.40.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.40.40.m2.1b"><ci id="alg2.40.40.m2.1.1.cmml" xref="alg2.40.40.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.40.40.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.40.40.m2.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.41.41.8" style="font-size:90%;">, </span><math alttext="dilation[i][j]" class="ltx_Math" display="inline" id="alg2.41.41.m3.2"><semantics id="alg2.41.41.m3.2a"><mrow id="alg2.41.41.m3.2.3" xref="alg2.41.41.m3.2.3.cmml"><mi id="alg2.41.41.m3.2.3.2" mathsize="90%" xref="alg2.41.41.m3.2.3.2.cmml">d</mi><mo id="alg2.41.41.m3.2.3.1" xref="alg2.41.41.m3.2.3.1.cmml">⁢</mo><mi id="alg2.41.41.m3.2.3.3" mathsize="90%" xref="alg2.41.41.m3.2.3.3.cmml">i</mi><mo id="alg2.41.41.m3.2.3.1a" xref="alg2.41.41.m3.2.3.1.cmml">⁢</mo><mi id="alg2.41.41.m3.2.3.4" mathsize="90%" xref="alg2.41.41.m3.2.3.4.cmml">l</mi><mo id="alg2.41.41.m3.2.3.1b" xref="alg2.41.41.m3.2.3.1.cmml">⁢</mo><mi id="alg2.41.41.m3.2.3.5" mathsize="90%" xref="alg2.41.41.m3.2.3.5.cmml">a</mi><mo id="alg2.41.41.m3.2.3.1c" xref="alg2.41.41.m3.2.3.1.cmml">⁢</mo><mi id="alg2.41.41.m3.2.3.6" mathsize="90%" xref="alg2.41.41.m3.2.3.6.cmml">t</mi><mo id="alg2.41.41.m3.2.3.1d" xref="alg2.41.41.m3.2.3.1.cmml">⁢</mo><mi id="alg2.41.41.m3.2.3.7" mathsize="90%" xref="alg2.41.41.m3.2.3.7.cmml">i</mi><mo id="alg2.41.41.m3.2.3.1e" xref="alg2.41.41.m3.2.3.1.cmml">⁢</mo><mi id="alg2.41.41.m3.2.3.8" mathsize="90%" xref="alg2.41.41.m3.2.3.8.cmml">o</mi><mo id="alg2.41.41.m3.2.3.1f" xref="alg2.41.41.m3.2.3.1.cmml">⁢</mo><mi id="alg2.41.41.m3.2.3.9" mathsize="90%" xref="alg2.41.41.m3.2.3.9.cmml">n</mi><mo id="alg2.41.41.m3.2.3.1g" xref="alg2.41.41.m3.2.3.1.cmml">⁢</mo><mrow id="alg2.41.41.m3.2.3.10.2" xref="alg2.41.41.m3.2.3.10.1.cmml"><mo id="alg2.41.41.m3.2.3.10.2.1" maxsize="90%" minsize="90%" xref="alg2.41.41.m3.2.3.10.1.1.cmml">[</mo><mi id="alg2.41.41.m3.1.1" mathsize="90%" xref="alg2.41.41.m3.1.1.cmml">i</mi><mo id="alg2.41.41.m3.2.3.10.2.2" maxsize="90%" minsize="90%" xref="alg2.41.41.m3.2.3.10.1.1.cmml">]</mo></mrow><mo id="alg2.41.41.m3.2.3.1h" xref="alg2.41.41.m3.2.3.1.cmml">⁢</mo><mrow id="alg2.41.41.m3.2.3.11.2" xref="alg2.41.41.m3.2.3.11.1.cmml"><mo id="alg2.41.41.m3.2.3.11.2.1" maxsize="90%" minsize="90%" xref="alg2.41.41.m3.2.3.11.1.1.cmml">[</mo><mi id="alg2.41.41.m3.2.2" mathsize="90%" xref="alg2.41.41.m3.2.2.cmml">j</mi><mo id="alg2.41.41.m3.2.3.11.2.2" maxsize="90%" minsize="90%" xref="alg2.41.41.m3.2.3.11.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.41.41.m3.2b"><apply id="alg2.41.41.m3.2.3.cmml" xref="alg2.41.41.m3.2.3"><times id="alg2.41.41.m3.2.3.1.cmml" xref="alg2.41.41.m3.2.3.1"></times><ci id="alg2.41.41.m3.2.3.2.cmml" xref="alg2.41.41.m3.2.3.2">𝑑</ci><ci id="alg2.41.41.m3.2.3.3.cmml" xref="alg2.41.41.m3.2.3.3">𝑖</ci><ci id="alg2.41.41.m3.2.3.4.cmml" xref="alg2.41.41.m3.2.3.4">𝑙</ci><ci id="alg2.41.41.m3.2.3.5.cmml" xref="alg2.41.41.m3.2.3.5">𝑎</ci><ci id="alg2.41.41.m3.2.3.6.cmml" xref="alg2.41.41.m3.2.3.6">𝑡</ci><ci id="alg2.41.41.m3.2.3.7.cmml" xref="alg2.41.41.m3.2.3.7">𝑖</ci><ci id="alg2.41.41.m3.2.3.8.cmml" xref="alg2.41.41.m3.2.3.8">𝑜</ci><ci id="alg2.41.41.m3.2.3.9.cmml" xref="alg2.41.41.m3.2.3.9">𝑛</ci><apply id="alg2.41.41.m3.2.3.10.1.cmml" xref="alg2.41.41.m3.2.3.10.2"><csymbol cd="latexml" id="alg2.41.41.m3.2.3.10.1.1.cmml" xref="alg2.41.41.m3.2.3.10.2.1">delimited-[]</csymbol><ci id="alg2.41.41.m3.1.1.cmml" xref="alg2.41.41.m3.1.1">𝑖</ci></apply><apply id="alg2.41.41.m3.2.3.11.1.cmml" xref="alg2.41.41.m3.2.3.11.2"><csymbol cd="latexml" id="alg2.41.41.m3.2.3.11.1.1.cmml" xref="alg2.41.41.m3.2.3.11.2.1">delimited-[]</csymbol><ci id="alg2.41.41.m3.2.2.cmml" xref="alg2.41.41.m3.2.2">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.41.41.m3.2c">dilation[i][j]</annotation><annotation encoding="application/x-llamapun" id="alg2.41.41.m3.2d">italic_d italic_i italic_l italic_a italic_t italic_i italic_o italic_n [ italic_i ] [ italic_j ]</annotation></semantics></math><span class="ltx_text" id="alg2.41.41.9" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg2.70.80">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.80.1.1.1" style="font-size:90%;">29</span></span><span class="ltx_text" id="alg2.70.80.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.80.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.80.4" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.80.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.70.80.6" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.70.81">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.81.1.1.1" style="font-size:90%;">30</span></span><span class="ltx_text" id="alg2.70.81.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.81.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.81.4" style="font-size:90%;">   </span>
</div>
<div class="ltx_listingline" id="alg2.42.42">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.42.42.1.1.1" style="font-size:90%;">31</span></span><span class="ltx_text" id="alg2.42.42.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.42.42.3" style="font-size:90%;">   </span><span class="ltx_text ltx_font_bold" id="alg2.42.42.4" style="font-size:90%;">return</span><span class="ltx_text" id="alg2.42.42.5" style="font-size:90%;"> </span><math alttext="x" class="ltx_Math" display="inline" id="alg2.42.42.m1.1"><semantics id="alg2.42.42.m1.1a"><mi id="alg2.42.42.m1.1.1" mathsize="90%" xref="alg2.42.42.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.42.42.m1.1b"><ci id="alg2.42.42.m1.1.1.cmml" xref="alg2.42.42.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.42.42.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.42.42.m1.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.42.42.6" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg2.70.82">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.82.1.1.1" style="font-size:90%;">32</span></span><span class="ltx_text" id="alg2.70.82.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.82.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.70.82.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.70.83">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.83.1.1.1" style="font-size:90%;">33</span></span>
</div>
<div class="ltx_listingline" id="alg2.45.45">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.45.45.4.1.1" style="font-size:90%;">34</span></span><span class="ltx_text ltx_font_bold" id="alg2.45.45.5" style="font-size:90%;">Function</span><span class="ltx_text" id="alg2.45.45.6" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_typewriter" id="alg2.45.45.3" style="font-size:90%;">Downsample(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg2.45.45.3.3.3"><math alttext="x" class="ltx_Math" display="inline" id="alg2.43.43.1.1.1.m1.1"><semantics id="alg2.43.43.1.1.1.m1.1a"><mi id="alg2.43.43.1.1.1.m1.1.1" xref="alg2.43.43.1.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.43.43.1.1.1.m1.1b"><ci id="alg2.43.43.1.1.1.m1.1.1.cmml" xref="alg2.43.43.1.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.43.43.1.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.43.43.1.1.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="x\_down" class="ltx_Math" display="inline" id="alg2.44.44.2.2.2.m2.1"><semantics id="alg2.44.44.2.2.2.m2.1a"><mrow id="alg2.44.44.2.2.2.m2.1.1" xref="alg2.44.44.2.2.2.m2.1.1.cmml"><mi id="alg2.44.44.2.2.2.m2.1.1.2" xref="alg2.44.44.2.2.2.m2.1.1.2.cmml">x</mi><mo id="alg2.44.44.2.2.2.m2.1.1.1" xref="alg2.44.44.2.2.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.44.44.2.2.2.m2.1.1.3" mathvariant="normal" xref="alg2.44.44.2.2.2.m2.1.1.3.cmml">_</mi><mo id="alg2.44.44.2.2.2.m2.1.1.1a" xref="alg2.44.44.2.2.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.44.44.2.2.2.m2.1.1.4" xref="alg2.44.44.2.2.2.m2.1.1.4.cmml">d</mi><mo id="alg2.44.44.2.2.2.m2.1.1.1b" xref="alg2.44.44.2.2.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.44.44.2.2.2.m2.1.1.5" xref="alg2.44.44.2.2.2.m2.1.1.5.cmml">o</mi><mo id="alg2.44.44.2.2.2.m2.1.1.1c" xref="alg2.44.44.2.2.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.44.44.2.2.2.m2.1.1.6" xref="alg2.44.44.2.2.2.m2.1.1.6.cmml">w</mi><mo id="alg2.44.44.2.2.2.m2.1.1.1d" xref="alg2.44.44.2.2.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.44.44.2.2.2.m2.1.1.7" xref="alg2.44.44.2.2.2.m2.1.1.7.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.44.44.2.2.2.m2.1b"><apply id="alg2.44.44.2.2.2.m2.1.1.cmml" xref="alg2.44.44.2.2.2.m2.1.1"><times id="alg2.44.44.2.2.2.m2.1.1.1.cmml" xref="alg2.44.44.2.2.2.m2.1.1.1"></times><ci id="alg2.44.44.2.2.2.m2.1.1.2.cmml" xref="alg2.44.44.2.2.2.m2.1.1.2">𝑥</ci><ci id="alg2.44.44.2.2.2.m2.1.1.3.cmml" xref="alg2.44.44.2.2.2.m2.1.1.3">_</ci><ci id="alg2.44.44.2.2.2.m2.1.1.4.cmml" xref="alg2.44.44.2.2.2.m2.1.1.4">𝑑</ci><ci id="alg2.44.44.2.2.2.m2.1.1.5.cmml" xref="alg2.44.44.2.2.2.m2.1.1.5">𝑜</ci><ci id="alg2.44.44.2.2.2.m2.1.1.6.cmml" xref="alg2.44.44.2.2.2.m2.1.1.6">𝑤</ci><ci id="alg2.44.44.2.2.2.m2.1.1.7.cmml" xref="alg2.44.44.2.2.2.m2.1.1.7">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.44.44.2.2.2.m2.1c">x\_down</annotation><annotation encoding="application/x-llamapun" id="alg2.44.44.2.2.2.m2.1d">italic_x _ italic_d italic_o italic_w italic_n</annotation></semantics></math>, <math alttext="features" class="ltx_Math" display="inline" id="alg2.45.45.3.3.3.m3.1"><semantics id="alg2.45.45.3.3.3.m3.1a"><mrow id="alg2.45.45.3.3.3.m3.1.1" xref="alg2.45.45.3.3.3.m3.1.1.cmml"><mi id="alg2.45.45.3.3.3.m3.1.1.2" xref="alg2.45.45.3.3.3.m3.1.1.2.cmml">f</mi><mo id="alg2.45.45.3.3.3.m3.1.1.1" xref="alg2.45.45.3.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.45.45.3.3.3.m3.1.1.3" xref="alg2.45.45.3.3.3.m3.1.1.3.cmml">e</mi><mo id="alg2.45.45.3.3.3.m3.1.1.1a" xref="alg2.45.45.3.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.45.45.3.3.3.m3.1.1.4" xref="alg2.45.45.3.3.3.m3.1.1.4.cmml">a</mi><mo id="alg2.45.45.3.3.3.m3.1.1.1b" xref="alg2.45.45.3.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.45.45.3.3.3.m3.1.1.5" xref="alg2.45.45.3.3.3.m3.1.1.5.cmml">t</mi><mo id="alg2.45.45.3.3.3.m3.1.1.1c" xref="alg2.45.45.3.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.45.45.3.3.3.m3.1.1.6" xref="alg2.45.45.3.3.3.m3.1.1.6.cmml">u</mi><mo id="alg2.45.45.3.3.3.m3.1.1.1d" xref="alg2.45.45.3.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.45.45.3.3.3.m3.1.1.7" xref="alg2.45.45.3.3.3.m3.1.1.7.cmml">r</mi><mo id="alg2.45.45.3.3.3.m3.1.1.1e" xref="alg2.45.45.3.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.45.45.3.3.3.m3.1.1.8" xref="alg2.45.45.3.3.3.m3.1.1.8.cmml">e</mi><mo id="alg2.45.45.3.3.3.m3.1.1.1f" xref="alg2.45.45.3.3.3.m3.1.1.1.cmml">⁢</mo><mi id="alg2.45.45.3.3.3.m3.1.1.9" xref="alg2.45.45.3.3.3.m3.1.1.9.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.45.45.3.3.3.m3.1b"><apply id="alg2.45.45.3.3.3.m3.1.1.cmml" xref="alg2.45.45.3.3.3.m3.1.1"><times id="alg2.45.45.3.3.3.m3.1.1.1.cmml" xref="alg2.45.45.3.3.3.m3.1.1.1"></times><ci id="alg2.45.45.3.3.3.m3.1.1.2.cmml" xref="alg2.45.45.3.3.3.m3.1.1.2">𝑓</ci><ci id="alg2.45.45.3.3.3.m3.1.1.3.cmml" xref="alg2.45.45.3.3.3.m3.1.1.3">𝑒</ci><ci id="alg2.45.45.3.3.3.m3.1.1.4.cmml" xref="alg2.45.45.3.3.3.m3.1.1.4">𝑎</ci><ci id="alg2.45.45.3.3.3.m3.1.1.5.cmml" xref="alg2.45.45.3.3.3.m3.1.1.5">𝑡</ci><ci id="alg2.45.45.3.3.3.m3.1.1.6.cmml" xref="alg2.45.45.3.3.3.m3.1.1.6">𝑢</ci><ci id="alg2.45.45.3.3.3.m3.1.1.7.cmml" xref="alg2.45.45.3.3.3.m3.1.1.7">𝑟</ci><ci id="alg2.45.45.3.3.3.m3.1.1.8.cmml" xref="alg2.45.45.3.3.3.m3.1.1.8">𝑒</ci><ci id="alg2.45.45.3.3.3.m3.1.1.9.cmml" xref="alg2.45.45.3.3.3.m3.1.1.9">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.45.45.3.3.3.m3.1c">features</annotation><annotation encoding="application/x-llamapun" id="alg2.45.45.3.3.3.m3.1d">italic_f italic_e italic_a italic_t italic_u italic_r italic_e italic_s</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="alg2.45.45.7" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="alg2.48.48">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.48.48.1.1.1" style="font-size:90%;">35</span></span><span class="ltx_text" id="alg2.48.48.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.48.48.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.48.48.4" style="font-size:90%;">
</span><math alttext="tmp\_x\leftarrow" class="ltx_Math" display="inline" id="alg2.46.46.m1.1"><semantics id="alg2.46.46.m1.1a"><mrow id="alg2.46.46.m1.1.1" xref="alg2.46.46.m1.1.1.cmml"><mrow id="alg2.46.46.m1.1.1.2" xref="alg2.46.46.m1.1.1.2.cmml"><mi id="alg2.46.46.m1.1.1.2.2" mathsize="90%" xref="alg2.46.46.m1.1.1.2.2.cmml">t</mi><mo id="alg2.46.46.m1.1.1.2.1" xref="alg2.46.46.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.46.46.m1.1.1.2.3" mathsize="90%" xref="alg2.46.46.m1.1.1.2.3.cmml">m</mi><mo id="alg2.46.46.m1.1.1.2.1a" xref="alg2.46.46.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.46.46.m1.1.1.2.4" mathsize="90%" xref="alg2.46.46.m1.1.1.2.4.cmml">p</mi><mo id="alg2.46.46.m1.1.1.2.1b" xref="alg2.46.46.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.46.46.m1.1.1.2.5" mathsize="90%" mathvariant="normal" xref="alg2.46.46.m1.1.1.2.5.cmml">_</mi><mo id="alg2.46.46.m1.1.1.2.1c" xref="alg2.46.46.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.46.46.m1.1.1.2.6" mathsize="90%" xref="alg2.46.46.m1.1.1.2.6.cmml">x</mi></mrow><mo id="alg2.46.46.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.46.46.m1.1.1.1.cmml">←</mo><mi id="alg2.46.46.m1.1.1.3" xref="alg2.46.46.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.46.46.m1.1b"><apply id="alg2.46.46.m1.1.1.cmml" xref="alg2.46.46.m1.1.1"><ci id="alg2.46.46.m1.1.1.1.cmml" xref="alg2.46.46.m1.1.1.1">←</ci><apply id="alg2.46.46.m1.1.1.2.cmml" xref="alg2.46.46.m1.1.1.2"><times id="alg2.46.46.m1.1.1.2.1.cmml" xref="alg2.46.46.m1.1.1.2.1"></times><ci id="alg2.46.46.m1.1.1.2.2.cmml" xref="alg2.46.46.m1.1.1.2.2">𝑡</ci><ci id="alg2.46.46.m1.1.1.2.3.cmml" xref="alg2.46.46.m1.1.1.2.3">𝑚</ci><ci id="alg2.46.46.m1.1.1.2.4.cmml" xref="alg2.46.46.m1.1.1.2.4">𝑝</ci><ci id="alg2.46.46.m1.1.1.2.5.cmml" xref="alg2.46.46.m1.1.1.2.5">_</ci><ci id="alg2.46.46.m1.1.1.2.6.cmml" xref="alg2.46.46.m1.1.1.2.6">𝑥</ci></apply><csymbol cd="latexml" id="alg2.46.46.m1.1.1.3.cmml" xref="alg2.46.46.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.46.46.m1.1c">tmp\_x\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.46.46.m1.1d">italic_t italic_m italic_p _ italic_x ←</annotation></semantics></math><span class="ltx_text" id="alg2.48.48.5" style="font-size:90%;"> Concatenate(</span><math alttext="features" class="ltx_Math" display="inline" id="alg2.47.47.m2.1"><semantics id="alg2.47.47.m2.1a"><mrow id="alg2.47.47.m2.1.1" xref="alg2.47.47.m2.1.1.cmml"><mi id="alg2.47.47.m2.1.1.2" mathsize="90%" xref="alg2.47.47.m2.1.1.2.cmml">f</mi><mo id="alg2.47.47.m2.1.1.1" xref="alg2.47.47.m2.1.1.1.cmml">⁢</mo><mi id="alg2.47.47.m2.1.1.3" mathsize="90%" xref="alg2.47.47.m2.1.1.3.cmml">e</mi><mo id="alg2.47.47.m2.1.1.1a" xref="alg2.47.47.m2.1.1.1.cmml">⁢</mo><mi id="alg2.47.47.m2.1.1.4" mathsize="90%" xref="alg2.47.47.m2.1.1.4.cmml">a</mi><mo id="alg2.47.47.m2.1.1.1b" xref="alg2.47.47.m2.1.1.1.cmml">⁢</mo><mi id="alg2.47.47.m2.1.1.5" mathsize="90%" xref="alg2.47.47.m2.1.1.5.cmml">t</mi><mo id="alg2.47.47.m2.1.1.1c" xref="alg2.47.47.m2.1.1.1.cmml">⁢</mo><mi id="alg2.47.47.m2.1.1.6" mathsize="90%" xref="alg2.47.47.m2.1.1.6.cmml">u</mi><mo id="alg2.47.47.m2.1.1.1d" xref="alg2.47.47.m2.1.1.1.cmml">⁢</mo><mi id="alg2.47.47.m2.1.1.7" mathsize="90%" xref="alg2.47.47.m2.1.1.7.cmml">r</mi><mo id="alg2.47.47.m2.1.1.1e" xref="alg2.47.47.m2.1.1.1.cmml">⁢</mo><mi id="alg2.47.47.m2.1.1.8" mathsize="90%" xref="alg2.47.47.m2.1.1.8.cmml">e</mi><mo id="alg2.47.47.m2.1.1.1f" xref="alg2.47.47.m2.1.1.1.cmml">⁢</mo><mi id="alg2.47.47.m2.1.1.9" mathsize="90%" xref="alg2.47.47.m2.1.1.9.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.47.47.m2.1b"><apply id="alg2.47.47.m2.1.1.cmml" xref="alg2.47.47.m2.1.1"><times id="alg2.47.47.m2.1.1.1.cmml" xref="alg2.47.47.m2.1.1.1"></times><ci id="alg2.47.47.m2.1.1.2.cmml" xref="alg2.47.47.m2.1.1.2">𝑓</ci><ci id="alg2.47.47.m2.1.1.3.cmml" xref="alg2.47.47.m2.1.1.3">𝑒</ci><ci id="alg2.47.47.m2.1.1.4.cmml" xref="alg2.47.47.m2.1.1.4">𝑎</ci><ci id="alg2.47.47.m2.1.1.5.cmml" xref="alg2.47.47.m2.1.1.5">𝑡</ci><ci id="alg2.47.47.m2.1.1.6.cmml" xref="alg2.47.47.m2.1.1.6">𝑢</ci><ci id="alg2.47.47.m2.1.1.7.cmml" xref="alg2.47.47.m2.1.1.7">𝑟</ci><ci id="alg2.47.47.m2.1.1.8.cmml" xref="alg2.47.47.m2.1.1.8">𝑒</ci><ci id="alg2.47.47.m2.1.1.9.cmml" xref="alg2.47.47.m2.1.1.9">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.47.47.m2.1c">features</annotation><annotation encoding="application/x-llamapun" id="alg2.47.47.m2.1d">italic_f italic_e italic_a italic_t italic_u italic_r italic_e italic_s</annotation></semantics></math><span class="ltx_text" id="alg2.48.48.6" style="font-size:90%;">, </span><math alttext="x\_down" class="ltx_Math" display="inline" id="alg2.48.48.m3.1"><semantics id="alg2.48.48.m3.1a"><mrow id="alg2.48.48.m3.1.1" xref="alg2.48.48.m3.1.1.cmml"><mi id="alg2.48.48.m3.1.1.2" mathsize="90%" xref="alg2.48.48.m3.1.1.2.cmml">x</mi><mo id="alg2.48.48.m3.1.1.1" xref="alg2.48.48.m3.1.1.1.cmml">⁢</mo><mi id="alg2.48.48.m3.1.1.3" mathsize="90%" mathvariant="normal" xref="alg2.48.48.m3.1.1.3.cmml">_</mi><mo id="alg2.48.48.m3.1.1.1a" xref="alg2.48.48.m3.1.1.1.cmml">⁢</mo><mi id="alg2.48.48.m3.1.1.4" mathsize="90%" xref="alg2.48.48.m3.1.1.4.cmml">d</mi><mo id="alg2.48.48.m3.1.1.1b" xref="alg2.48.48.m3.1.1.1.cmml">⁢</mo><mi id="alg2.48.48.m3.1.1.5" mathsize="90%" xref="alg2.48.48.m3.1.1.5.cmml">o</mi><mo id="alg2.48.48.m3.1.1.1c" xref="alg2.48.48.m3.1.1.1.cmml">⁢</mo><mi id="alg2.48.48.m3.1.1.6" mathsize="90%" xref="alg2.48.48.m3.1.1.6.cmml">w</mi><mo id="alg2.48.48.m3.1.1.1d" xref="alg2.48.48.m3.1.1.1.cmml">⁢</mo><mi id="alg2.48.48.m3.1.1.7" mathsize="90%" xref="alg2.48.48.m3.1.1.7.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.48.48.m3.1b"><apply id="alg2.48.48.m3.1.1.cmml" xref="alg2.48.48.m3.1.1"><times id="alg2.48.48.m3.1.1.1.cmml" xref="alg2.48.48.m3.1.1.1"></times><ci id="alg2.48.48.m3.1.1.2.cmml" xref="alg2.48.48.m3.1.1.2">𝑥</ci><ci id="alg2.48.48.m3.1.1.3.cmml" xref="alg2.48.48.m3.1.1.3">_</ci><ci id="alg2.48.48.m3.1.1.4.cmml" xref="alg2.48.48.m3.1.1.4">𝑑</ci><ci id="alg2.48.48.m3.1.1.5.cmml" xref="alg2.48.48.m3.1.1.5">𝑜</ci><ci id="alg2.48.48.m3.1.1.6.cmml" xref="alg2.48.48.m3.1.1.6">𝑤</ci><ci id="alg2.48.48.m3.1.1.7.cmml" xref="alg2.48.48.m3.1.1.7">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.48.48.m3.1c">x\_down</annotation><annotation encoding="application/x-llamapun" id="alg2.48.48.m3.1d">italic_x _ italic_d italic_o italic_w italic_n</annotation></semantics></math><span class="ltx_text" id="alg2.48.48.7" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg2.50.50">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.50.50.1.1.1" style="font-size:90%;">36</span></span><span class="ltx_text" id="alg2.50.50.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.50.50.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.50.50.4" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg2.50.50.5" style="font-size:90%;">return</span><span class="ltx_text" id="alg2.50.50.6" style="font-size:90%;"> Conv(</span><math alttext="tmp\_x" class="ltx_Math" display="inline" id="alg2.49.49.m1.1"><semantics id="alg2.49.49.m1.1a"><mrow id="alg2.49.49.m1.1.1" xref="alg2.49.49.m1.1.1.cmml"><mi id="alg2.49.49.m1.1.1.2" mathsize="90%" xref="alg2.49.49.m1.1.1.2.cmml">t</mi><mo id="alg2.49.49.m1.1.1.1" xref="alg2.49.49.m1.1.1.1.cmml">⁢</mo><mi id="alg2.49.49.m1.1.1.3" mathsize="90%" xref="alg2.49.49.m1.1.1.3.cmml">m</mi><mo id="alg2.49.49.m1.1.1.1a" xref="alg2.49.49.m1.1.1.1.cmml">⁢</mo><mi id="alg2.49.49.m1.1.1.4" mathsize="90%" xref="alg2.49.49.m1.1.1.4.cmml">p</mi><mo id="alg2.49.49.m1.1.1.1b" xref="alg2.49.49.m1.1.1.1.cmml">⁢</mo><mi id="alg2.49.49.m1.1.1.5" mathsize="90%" mathvariant="normal" xref="alg2.49.49.m1.1.1.5.cmml">_</mi><mo id="alg2.49.49.m1.1.1.1c" xref="alg2.49.49.m1.1.1.1.cmml">⁢</mo><mi id="alg2.49.49.m1.1.1.6" mathsize="90%" xref="alg2.49.49.m1.1.1.6.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.49.49.m1.1b"><apply id="alg2.49.49.m1.1.1.cmml" xref="alg2.49.49.m1.1.1"><times id="alg2.49.49.m1.1.1.1.cmml" xref="alg2.49.49.m1.1.1.1"></times><ci id="alg2.49.49.m1.1.1.2.cmml" xref="alg2.49.49.m1.1.1.2">𝑡</ci><ci id="alg2.49.49.m1.1.1.3.cmml" xref="alg2.49.49.m1.1.1.3">𝑚</ci><ci id="alg2.49.49.m1.1.1.4.cmml" xref="alg2.49.49.m1.1.1.4">𝑝</ci><ci id="alg2.49.49.m1.1.1.5.cmml" xref="alg2.49.49.m1.1.1.5">_</ci><ci id="alg2.49.49.m1.1.1.6.cmml" xref="alg2.49.49.m1.1.1.6">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.49.49.m1.1c">tmp\_x</annotation><annotation encoding="application/x-llamapun" id="alg2.49.49.m1.1d">italic_t italic_m italic_p _ italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.50.50.7" style="font-size:90%;">, </span><math alttext="dims[i+1]" class="ltx_Math" display="inline" id="alg2.50.50.m2.1"><semantics id="alg2.50.50.m2.1a"><mrow id="alg2.50.50.m2.1.1" xref="alg2.50.50.m2.1.1.cmml"><mi id="alg2.50.50.m2.1.1.3" mathsize="90%" xref="alg2.50.50.m2.1.1.3.cmml">d</mi><mo id="alg2.50.50.m2.1.1.2" xref="alg2.50.50.m2.1.1.2.cmml">⁢</mo><mi id="alg2.50.50.m2.1.1.4" mathsize="90%" xref="alg2.50.50.m2.1.1.4.cmml">i</mi><mo id="alg2.50.50.m2.1.1.2a" xref="alg2.50.50.m2.1.1.2.cmml">⁢</mo><mi id="alg2.50.50.m2.1.1.5" mathsize="90%" xref="alg2.50.50.m2.1.1.5.cmml">m</mi><mo id="alg2.50.50.m2.1.1.2b" xref="alg2.50.50.m2.1.1.2.cmml">⁢</mo><mi id="alg2.50.50.m2.1.1.6" mathsize="90%" xref="alg2.50.50.m2.1.1.6.cmml">s</mi><mo id="alg2.50.50.m2.1.1.2c" xref="alg2.50.50.m2.1.1.2.cmml">⁢</mo><mrow id="alg2.50.50.m2.1.1.1.1" xref="alg2.50.50.m2.1.1.1.2.cmml"><mo id="alg2.50.50.m2.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg2.50.50.m2.1.1.1.2.1.cmml">[</mo><mrow id="alg2.50.50.m2.1.1.1.1.1" xref="alg2.50.50.m2.1.1.1.1.1.cmml"><mi id="alg2.50.50.m2.1.1.1.1.1.2" mathsize="90%" xref="alg2.50.50.m2.1.1.1.1.1.2.cmml">i</mi><mo id="alg2.50.50.m2.1.1.1.1.1.1" mathsize="90%" xref="alg2.50.50.m2.1.1.1.1.1.1.cmml">+</mo><mn id="alg2.50.50.m2.1.1.1.1.1.3" mathsize="90%" xref="alg2.50.50.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg2.50.50.m2.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg2.50.50.m2.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.50.50.m2.1b"><apply id="alg2.50.50.m2.1.1.cmml" xref="alg2.50.50.m2.1.1"><times id="alg2.50.50.m2.1.1.2.cmml" xref="alg2.50.50.m2.1.1.2"></times><ci id="alg2.50.50.m2.1.1.3.cmml" xref="alg2.50.50.m2.1.1.3">𝑑</ci><ci id="alg2.50.50.m2.1.1.4.cmml" xref="alg2.50.50.m2.1.1.4">𝑖</ci><ci id="alg2.50.50.m2.1.1.5.cmml" xref="alg2.50.50.m2.1.1.5">𝑚</ci><ci id="alg2.50.50.m2.1.1.6.cmml" xref="alg2.50.50.m2.1.1.6">𝑠</ci><apply id="alg2.50.50.m2.1.1.1.2.cmml" xref="alg2.50.50.m2.1.1.1.1"><csymbol cd="latexml" id="alg2.50.50.m2.1.1.1.2.1.cmml" xref="alg2.50.50.m2.1.1.1.1.2">delimited-[]</csymbol><apply id="alg2.50.50.m2.1.1.1.1.1.cmml" xref="alg2.50.50.m2.1.1.1.1.1"><plus id="alg2.50.50.m2.1.1.1.1.1.1.cmml" xref="alg2.50.50.m2.1.1.1.1.1.1"></plus><ci id="alg2.50.50.m2.1.1.1.1.1.2.cmml" xref="alg2.50.50.m2.1.1.1.1.1.2">𝑖</ci><cn id="alg2.50.50.m2.1.1.1.1.1.3.cmml" type="integer" xref="alg2.50.50.m2.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.50.50.m2.1c">dims[i+1]</annotation><annotation encoding="application/x-llamapun" id="alg2.50.50.m2.1d">italic_d italic_i italic_m italic_s [ italic_i + 1 ]</annotation></semantics></math><span class="ltx_text" id="alg2.50.50.8" style="font-size:90%;">, stride=2);</span>
</div>
<div class="ltx_listingline" id="alg2.70.84">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.84.1.1.1" style="font-size:90%;">37</span></span><span class="ltx_text" id="alg2.70.84.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.84.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.70.84.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.70.85">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.85.1.1.1" style="font-size:90%;">38</span></span>
</div>
<div class="ltx_listingline" id="alg2.52.52">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.52.52.3.1.1" style="font-size:90%;">39</span></span><span class="ltx_text ltx_font_bold" id="alg2.52.52.4" style="font-size:90%;">Function</span><span class="ltx_text" id="alg2.52.52.5" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg2.52.52.2" style="font-size:90%;">Stem<math alttext="x" class="ltx_Math" display="inline" id="alg2.51.51.1.m1.1"><semantics id="alg2.51.51.1.m1.1a"><mi id="alg2.51.51.1.m1.1.1" xref="alg2.51.51.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.51.51.1.m1.1b"><ci id="alg2.51.51.1.m1.1.1.cmml" xref="alg2.51.51.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.51.51.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.51.51.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="x\_down" class="ltx_Math" display="inline" id="alg2.52.52.2.m2.1"><semantics id="alg2.52.52.2.m2.1a"><mrow id="alg2.52.52.2.m2.1.1" xref="alg2.52.52.2.m2.1.1.cmml"><mi id="alg2.52.52.2.m2.1.1.2" xref="alg2.52.52.2.m2.1.1.2.cmml">x</mi><mo id="alg2.52.52.2.m2.1.1.1" xref="alg2.52.52.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.52.52.2.m2.1.1.3" mathvariant="normal" xref="alg2.52.52.2.m2.1.1.3.cmml">_</mi><mo id="alg2.52.52.2.m2.1.1.1a" xref="alg2.52.52.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.52.52.2.m2.1.1.4" xref="alg2.52.52.2.m2.1.1.4.cmml">d</mi><mo id="alg2.52.52.2.m2.1.1.1b" xref="alg2.52.52.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.52.52.2.m2.1.1.5" xref="alg2.52.52.2.m2.1.1.5.cmml">o</mi><mo id="alg2.52.52.2.m2.1.1.1c" xref="alg2.52.52.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.52.52.2.m2.1.1.6" xref="alg2.52.52.2.m2.1.1.6.cmml">w</mi><mo id="alg2.52.52.2.m2.1.1.1d" xref="alg2.52.52.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.52.52.2.m2.1.1.7" xref="alg2.52.52.2.m2.1.1.7.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.52.52.2.m2.1b"><apply id="alg2.52.52.2.m2.1.1.cmml" xref="alg2.52.52.2.m2.1.1"><times id="alg2.52.52.2.m2.1.1.1.cmml" xref="alg2.52.52.2.m2.1.1.1"></times><ci id="alg2.52.52.2.m2.1.1.2.cmml" xref="alg2.52.52.2.m2.1.1.2">𝑥</ci><ci id="alg2.52.52.2.m2.1.1.3.cmml" xref="alg2.52.52.2.m2.1.1.3">_</ci><ci id="alg2.52.52.2.m2.1.1.4.cmml" xref="alg2.52.52.2.m2.1.1.4">𝑑</ci><ci id="alg2.52.52.2.m2.1.1.5.cmml" xref="alg2.52.52.2.m2.1.1.5">𝑜</ci><ci id="alg2.52.52.2.m2.1.1.6.cmml" xref="alg2.52.52.2.m2.1.1.6">𝑤</ci><ci id="alg2.52.52.2.m2.1.1.7.cmml" xref="alg2.52.52.2.m2.1.1.7">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.52.52.2.m2.1c">x\_down</annotation><annotation encoding="application/x-llamapun" id="alg2.52.52.2.m2.1d">italic_x _ italic_d italic_o italic_w italic_n</annotation></semantics></math></em><span class="ltx_text ltx_font_bold" id="alg2.52.52.6" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="alg2.55.55">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.55.55.1.1.1" style="font-size:90%;">40</span></span><span class="ltx_text" id="alg2.55.55.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.55.55.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.55.55.4" style="font-size:90%;">
</span><math alttext="x\leftarrow" class="ltx_Math" display="inline" id="alg2.53.53.m1.1"><semantics id="alg2.53.53.m1.1a"><mrow id="alg2.53.53.m1.1.1" xref="alg2.53.53.m1.1.1.cmml"><mi id="alg2.53.53.m1.1.1.2" mathsize="90%" xref="alg2.53.53.m1.1.1.2.cmml">x</mi><mo id="alg2.53.53.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.53.53.m1.1.1.1.cmml">←</mo><mi id="alg2.53.53.m1.1.1.3" xref="alg2.53.53.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.53.53.m1.1b"><apply id="alg2.53.53.m1.1.1.cmml" xref="alg2.53.53.m1.1.1"><ci id="alg2.53.53.m1.1.1.1.cmml" xref="alg2.53.53.m1.1.1.1">←</ci><ci id="alg2.53.53.m1.1.1.2.cmml" xref="alg2.53.53.m1.1.1.2">𝑥</ci><csymbol cd="latexml" id="alg2.53.53.m1.1.1.3.cmml" xref="alg2.53.53.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.53.53.m1.1c">x\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.53.53.m1.1d">italic_x ←</annotation></semantics></math><span class="ltx_text" id="alg2.55.55.5" style="font-size:90%;"> Conv(</span><math alttext="x" class="ltx_Math" display="inline" id="alg2.54.54.m2.1"><semantics id="alg2.54.54.m2.1a"><mi id="alg2.54.54.m2.1.1" mathsize="90%" xref="alg2.54.54.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.54.54.m2.1b"><ci id="alg2.54.54.m2.1.1.cmml" xref="alg2.54.54.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.54.54.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.54.54.m2.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.55.55.6" style="font-size:90%;">, </span><math alttext="dims[0]" class="ltx_Math" display="inline" id="alg2.55.55.m3.1"><semantics id="alg2.55.55.m3.1a"><mrow id="alg2.55.55.m3.1.2" xref="alg2.55.55.m3.1.2.cmml"><mi id="alg2.55.55.m3.1.2.2" mathsize="90%" xref="alg2.55.55.m3.1.2.2.cmml">d</mi><mo id="alg2.55.55.m3.1.2.1" xref="alg2.55.55.m3.1.2.1.cmml">⁢</mo><mi id="alg2.55.55.m3.1.2.3" mathsize="90%" xref="alg2.55.55.m3.1.2.3.cmml">i</mi><mo id="alg2.55.55.m3.1.2.1a" xref="alg2.55.55.m3.1.2.1.cmml">⁢</mo><mi id="alg2.55.55.m3.1.2.4" mathsize="90%" xref="alg2.55.55.m3.1.2.4.cmml">m</mi><mo id="alg2.55.55.m3.1.2.1b" xref="alg2.55.55.m3.1.2.1.cmml">⁢</mo><mi id="alg2.55.55.m3.1.2.5" mathsize="90%" xref="alg2.55.55.m3.1.2.5.cmml">s</mi><mo id="alg2.55.55.m3.1.2.1c" xref="alg2.55.55.m3.1.2.1.cmml">⁢</mo><mrow id="alg2.55.55.m3.1.2.6.2" xref="alg2.55.55.m3.1.2.6.1.cmml"><mo id="alg2.55.55.m3.1.2.6.2.1" maxsize="90%" minsize="90%" xref="alg2.55.55.m3.1.2.6.1.1.cmml">[</mo><mn id="alg2.55.55.m3.1.1" mathsize="90%" xref="alg2.55.55.m3.1.1.cmml">0</mn><mo id="alg2.55.55.m3.1.2.6.2.2" maxsize="90%" minsize="90%" xref="alg2.55.55.m3.1.2.6.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.55.55.m3.1b"><apply id="alg2.55.55.m3.1.2.cmml" xref="alg2.55.55.m3.1.2"><times id="alg2.55.55.m3.1.2.1.cmml" xref="alg2.55.55.m3.1.2.1"></times><ci id="alg2.55.55.m3.1.2.2.cmml" xref="alg2.55.55.m3.1.2.2">𝑑</ci><ci id="alg2.55.55.m3.1.2.3.cmml" xref="alg2.55.55.m3.1.2.3">𝑖</ci><ci id="alg2.55.55.m3.1.2.4.cmml" xref="alg2.55.55.m3.1.2.4">𝑚</ci><ci id="alg2.55.55.m3.1.2.5.cmml" xref="alg2.55.55.m3.1.2.5">𝑠</ci><apply id="alg2.55.55.m3.1.2.6.1.cmml" xref="alg2.55.55.m3.1.2.6.2"><csymbol cd="latexml" id="alg2.55.55.m3.1.2.6.1.1.cmml" xref="alg2.55.55.m3.1.2.6.2.1">delimited-[]</csymbol><cn id="alg2.55.55.m3.1.1.cmml" type="integer" xref="alg2.55.55.m3.1.1">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.55.55.m3.1c">dims[0]</annotation><annotation encoding="application/x-llamapun" id="alg2.55.55.m3.1d">italic_d italic_i italic_m italic_s [ 0 ]</annotation></semantics></math><span class="ltx_text" id="alg2.55.55.7" style="font-size:90%;">, stride=2);</span>
</div>
<div class="ltx_listingline" id="alg2.58.58">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.58.58.1.1.1" style="font-size:90%;">41</span></span><span class="ltx_text" id="alg2.58.58.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.58.58.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.58.58.4" style="font-size:90%;">
</span><math alttext="x\leftarrow" class="ltx_Math" display="inline" id="alg2.56.56.m1.1"><semantics id="alg2.56.56.m1.1a"><mrow id="alg2.56.56.m1.1.1" xref="alg2.56.56.m1.1.1.cmml"><mi id="alg2.56.56.m1.1.1.2" mathsize="90%" xref="alg2.56.56.m1.1.1.2.cmml">x</mi><mo id="alg2.56.56.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.56.56.m1.1.1.1.cmml">←</mo><mi id="alg2.56.56.m1.1.1.3" xref="alg2.56.56.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.56.56.m1.1b"><apply id="alg2.56.56.m1.1.1.cmml" xref="alg2.56.56.m1.1.1"><ci id="alg2.56.56.m1.1.1.1.cmml" xref="alg2.56.56.m1.1.1.1">←</ci><ci id="alg2.56.56.m1.1.1.2.cmml" xref="alg2.56.56.m1.1.1.2">𝑥</ci><csymbol cd="latexml" id="alg2.56.56.m1.1.1.3.cmml" xref="alg2.56.56.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.56.56.m1.1c">x\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.56.56.m1.1d">italic_x ←</annotation></semantics></math><span class="ltx_text" id="alg2.58.58.5" style="font-size:90%;"> Conv(</span><math alttext="x" class="ltx_Math" display="inline" id="alg2.57.57.m2.1"><semantics id="alg2.57.57.m2.1a"><mi id="alg2.57.57.m2.1.1" mathsize="90%" xref="alg2.57.57.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.57.57.m2.1b"><ci id="alg2.57.57.m2.1.1.cmml" xref="alg2.57.57.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.57.57.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.57.57.m2.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.58.58.6" style="font-size:90%;">, </span><math alttext="dims[0]" class="ltx_Math" display="inline" id="alg2.58.58.m3.1"><semantics id="alg2.58.58.m3.1a"><mrow id="alg2.58.58.m3.1.2" xref="alg2.58.58.m3.1.2.cmml"><mi id="alg2.58.58.m3.1.2.2" mathsize="90%" xref="alg2.58.58.m3.1.2.2.cmml">d</mi><mo id="alg2.58.58.m3.1.2.1" xref="alg2.58.58.m3.1.2.1.cmml">⁢</mo><mi id="alg2.58.58.m3.1.2.3" mathsize="90%" xref="alg2.58.58.m3.1.2.3.cmml">i</mi><mo id="alg2.58.58.m3.1.2.1a" xref="alg2.58.58.m3.1.2.1.cmml">⁢</mo><mi id="alg2.58.58.m3.1.2.4" mathsize="90%" xref="alg2.58.58.m3.1.2.4.cmml">m</mi><mo id="alg2.58.58.m3.1.2.1b" xref="alg2.58.58.m3.1.2.1.cmml">⁢</mo><mi id="alg2.58.58.m3.1.2.5" mathsize="90%" xref="alg2.58.58.m3.1.2.5.cmml">s</mi><mo id="alg2.58.58.m3.1.2.1c" xref="alg2.58.58.m3.1.2.1.cmml">⁢</mo><mrow id="alg2.58.58.m3.1.2.6.2" xref="alg2.58.58.m3.1.2.6.1.cmml"><mo id="alg2.58.58.m3.1.2.6.2.1" maxsize="90%" minsize="90%" xref="alg2.58.58.m3.1.2.6.1.1.cmml">[</mo><mn id="alg2.58.58.m3.1.1" mathsize="90%" xref="alg2.58.58.m3.1.1.cmml">0</mn><mo id="alg2.58.58.m3.1.2.6.2.2" maxsize="90%" minsize="90%" xref="alg2.58.58.m3.1.2.6.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.58.58.m3.1b"><apply id="alg2.58.58.m3.1.2.cmml" xref="alg2.58.58.m3.1.2"><times id="alg2.58.58.m3.1.2.1.cmml" xref="alg2.58.58.m3.1.2.1"></times><ci id="alg2.58.58.m3.1.2.2.cmml" xref="alg2.58.58.m3.1.2.2">𝑑</ci><ci id="alg2.58.58.m3.1.2.3.cmml" xref="alg2.58.58.m3.1.2.3">𝑖</ci><ci id="alg2.58.58.m3.1.2.4.cmml" xref="alg2.58.58.m3.1.2.4">𝑚</ci><ci id="alg2.58.58.m3.1.2.5.cmml" xref="alg2.58.58.m3.1.2.5">𝑠</ci><apply id="alg2.58.58.m3.1.2.6.1.cmml" xref="alg2.58.58.m3.1.2.6.2"><csymbol cd="latexml" id="alg2.58.58.m3.1.2.6.1.1.cmml" xref="alg2.58.58.m3.1.2.6.2.1">delimited-[]</csymbol><cn id="alg2.58.58.m3.1.1.cmml" type="integer" xref="alg2.58.58.m3.1.1">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.58.58.m3.1c">dims[0]</annotation><annotation encoding="application/x-llamapun" id="alg2.58.58.m3.1d">italic_d italic_i italic_m italic_s [ 0 ]</annotation></semantics></math><span class="ltx_text" id="alg2.58.58.7" style="font-size:90%;">, stride=1);</span>
</div>
<div class="ltx_listingline" id="alg2.61.61">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.61.61.1.1.1" style="font-size:90%;">42</span></span><span class="ltx_text" id="alg2.61.61.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.61.61.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.61.61.4" style="font-size:90%;">
</span><math alttext="x\leftarrow" class="ltx_Math" display="inline" id="alg2.59.59.m1.1"><semantics id="alg2.59.59.m1.1a"><mrow id="alg2.59.59.m1.1.1" xref="alg2.59.59.m1.1.1.cmml"><mi id="alg2.59.59.m1.1.1.2" mathsize="90%" xref="alg2.59.59.m1.1.1.2.cmml">x</mi><mo id="alg2.59.59.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg2.59.59.m1.1.1.1.cmml">←</mo><mi id="alg2.59.59.m1.1.1.3" xref="alg2.59.59.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.59.59.m1.1b"><apply id="alg2.59.59.m1.1.1.cmml" xref="alg2.59.59.m1.1.1"><ci id="alg2.59.59.m1.1.1.1.cmml" xref="alg2.59.59.m1.1.1.1">←</ci><ci id="alg2.59.59.m1.1.1.2.cmml" xref="alg2.59.59.m1.1.1.2">𝑥</ci><csymbol cd="latexml" id="alg2.59.59.m1.1.1.3.cmml" xref="alg2.59.59.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.59.59.m1.1c">x\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg2.59.59.m1.1d">italic_x ←</annotation></semantics></math><span class="ltx_text" id="alg2.61.61.5" style="font-size:90%;"> Conv(</span><math alttext="x" class="ltx_Math" display="inline" id="alg2.60.60.m2.1"><semantics id="alg2.60.60.m2.1a"><mi id="alg2.60.60.m2.1.1" mathsize="90%" xref="alg2.60.60.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.60.60.m2.1b"><ci id="alg2.60.60.m2.1.1.cmml" xref="alg2.60.60.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.60.60.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.60.60.m2.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.61.61.6" style="font-size:90%;">, </span><math alttext="dims[0]" class="ltx_Math" display="inline" id="alg2.61.61.m3.1"><semantics id="alg2.61.61.m3.1a"><mrow id="alg2.61.61.m3.1.2" xref="alg2.61.61.m3.1.2.cmml"><mi id="alg2.61.61.m3.1.2.2" mathsize="90%" xref="alg2.61.61.m3.1.2.2.cmml">d</mi><mo id="alg2.61.61.m3.1.2.1" xref="alg2.61.61.m3.1.2.1.cmml">⁢</mo><mi id="alg2.61.61.m3.1.2.3" mathsize="90%" xref="alg2.61.61.m3.1.2.3.cmml">i</mi><mo id="alg2.61.61.m3.1.2.1a" xref="alg2.61.61.m3.1.2.1.cmml">⁢</mo><mi id="alg2.61.61.m3.1.2.4" mathsize="90%" xref="alg2.61.61.m3.1.2.4.cmml">m</mi><mo id="alg2.61.61.m3.1.2.1b" xref="alg2.61.61.m3.1.2.1.cmml">⁢</mo><mi id="alg2.61.61.m3.1.2.5" mathsize="90%" xref="alg2.61.61.m3.1.2.5.cmml">s</mi><mo id="alg2.61.61.m3.1.2.1c" xref="alg2.61.61.m3.1.2.1.cmml">⁢</mo><mrow id="alg2.61.61.m3.1.2.6.2" xref="alg2.61.61.m3.1.2.6.1.cmml"><mo id="alg2.61.61.m3.1.2.6.2.1" maxsize="90%" minsize="90%" xref="alg2.61.61.m3.1.2.6.1.1.cmml">[</mo><mn id="alg2.61.61.m3.1.1" mathsize="90%" xref="alg2.61.61.m3.1.1.cmml">0</mn><mo id="alg2.61.61.m3.1.2.6.2.2" maxsize="90%" minsize="90%" xref="alg2.61.61.m3.1.2.6.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.61.61.m3.1b"><apply id="alg2.61.61.m3.1.2.cmml" xref="alg2.61.61.m3.1.2"><times id="alg2.61.61.m3.1.2.1.cmml" xref="alg2.61.61.m3.1.2.1"></times><ci id="alg2.61.61.m3.1.2.2.cmml" xref="alg2.61.61.m3.1.2.2">𝑑</ci><ci id="alg2.61.61.m3.1.2.3.cmml" xref="alg2.61.61.m3.1.2.3">𝑖</ci><ci id="alg2.61.61.m3.1.2.4.cmml" xref="alg2.61.61.m3.1.2.4">𝑚</ci><ci id="alg2.61.61.m3.1.2.5.cmml" xref="alg2.61.61.m3.1.2.5">𝑠</ci><apply id="alg2.61.61.m3.1.2.6.1.cmml" xref="alg2.61.61.m3.1.2.6.2"><csymbol cd="latexml" id="alg2.61.61.m3.1.2.6.1.1.cmml" xref="alg2.61.61.m3.1.2.6.2.1">delimited-[]</csymbol><cn id="alg2.61.61.m3.1.1.cmml" type="integer" xref="alg2.61.61.m3.1.1">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.61.61.m3.1c">dims[0]</annotation><annotation encoding="application/x-llamapun" id="alg2.61.61.m3.1d">italic_d italic_i italic_m italic_s [ 0 ]</annotation></semantics></math><span class="ltx_text" id="alg2.61.61.7" style="font-size:90%;">, stride=1);</span>
</div>
<div class="ltx_listingline" id="alg2.64.64">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.64.64.1.1.1" style="font-size:90%;">43</span></span><span class="ltx_text" id="alg2.64.64.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.64.64.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.64.64.4" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg2.64.64.5" style="font-size:90%;">return</span><span class="ltx_text" id="alg2.64.64.6" style="font-size:90%;"> Conv(Concatenate(</span><math alttext="x" class="ltx_Math" display="inline" id="alg2.62.62.m1.1"><semantics id="alg2.62.62.m1.1a"><mi id="alg2.62.62.m1.1.1" mathsize="90%" xref="alg2.62.62.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.62.62.m1.1b"><ci id="alg2.62.62.m1.1.1.cmml" xref="alg2.62.62.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.62.62.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.62.62.m1.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.64.64.7" style="font-size:90%;">, </span><math alttext="x\_down" class="ltx_Math" display="inline" id="alg2.63.63.m2.1"><semantics id="alg2.63.63.m2.1a"><mrow id="alg2.63.63.m2.1.1" xref="alg2.63.63.m2.1.1.cmml"><mi id="alg2.63.63.m2.1.1.2" mathsize="90%" xref="alg2.63.63.m2.1.1.2.cmml">x</mi><mo id="alg2.63.63.m2.1.1.1" xref="alg2.63.63.m2.1.1.1.cmml">⁢</mo><mi id="alg2.63.63.m2.1.1.3" mathsize="90%" mathvariant="normal" xref="alg2.63.63.m2.1.1.3.cmml">_</mi><mo id="alg2.63.63.m2.1.1.1a" xref="alg2.63.63.m2.1.1.1.cmml">⁢</mo><mi id="alg2.63.63.m2.1.1.4" mathsize="90%" xref="alg2.63.63.m2.1.1.4.cmml">d</mi><mo id="alg2.63.63.m2.1.1.1b" xref="alg2.63.63.m2.1.1.1.cmml">⁢</mo><mi id="alg2.63.63.m2.1.1.5" mathsize="90%" xref="alg2.63.63.m2.1.1.5.cmml">o</mi><mo id="alg2.63.63.m2.1.1.1c" xref="alg2.63.63.m2.1.1.1.cmml">⁢</mo><mi id="alg2.63.63.m2.1.1.6" mathsize="90%" xref="alg2.63.63.m2.1.1.6.cmml">w</mi><mo id="alg2.63.63.m2.1.1.1d" xref="alg2.63.63.m2.1.1.1.cmml">⁢</mo><mi id="alg2.63.63.m2.1.1.7" mathsize="90%" xref="alg2.63.63.m2.1.1.7.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.63.63.m2.1b"><apply id="alg2.63.63.m2.1.1.cmml" xref="alg2.63.63.m2.1.1"><times id="alg2.63.63.m2.1.1.1.cmml" xref="alg2.63.63.m2.1.1.1"></times><ci id="alg2.63.63.m2.1.1.2.cmml" xref="alg2.63.63.m2.1.1.2">𝑥</ci><ci id="alg2.63.63.m2.1.1.3.cmml" xref="alg2.63.63.m2.1.1.3">_</ci><ci id="alg2.63.63.m2.1.1.4.cmml" xref="alg2.63.63.m2.1.1.4">𝑑</ci><ci id="alg2.63.63.m2.1.1.5.cmml" xref="alg2.63.63.m2.1.1.5">𝑜</ci><ci id="alg2.63.63.m2.1.1.6.cmml" xref="alg2.63.63.m2.1.1.6">𝑤</ci><ci id="alg2.63.63.m2.1.1.7.cmml" xref="alg2.63.63.m2.1.1.7">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.63.63.m2.1c">x\_down</annotation><annotation encoding="application/x-llamapun" id="alg2.63.63.m2.1d">italic_x _ italic_d italic_o italic_w italic_n</annotation></semantics></math><span class="ltx_text" id="alg2.64.64.8" style="font-size:90%;">), </span><math alttext="dims[0]" class="ltx_Math" display="inline" id="alg2.64.64.m3.1"><semantics id="alg2.64.64.m3.1a"><mrow id="alg2.64.64.m3.1.2" xref="alg2.64.64.m3.1.2.cmml"><mi id="alg2.64.64.m3.1.2.2" mathsize="90%" xref="alg2.64.64.m3.1.2.2.cmml">d</mi><mo id="alg2.64.64.m3.1.2.1" xref="alg2.64.64.m3.1.2.1.cmml">⁢</mo><mi id="alg2.64.64.m3.1.2.3" mathsize="90%" xref="alg2.64.64.m3.1.2.3.cmml">i</mi><mo id="alg2.64.64.m3.1.2.1a" xref="alg2.64.64.m3.1.2.1.cmml">⁢</mo><mi id="alg2.64.64.m3.1.2.4" mathsize="90%" xref="alg2.64.64.m3.1.2.4.cmml">m</mi><mo id="alg2.64.64.m3.1.2.1b" xref="alg2.64.64.m3.1.2.1.cmml">⁢</mo><mi id="alg2.64.64.m3.1.2.5" mathsize="90%" xref="alg2.64.64.m3.1.2.5.cmml">s</mi><mo id="alg2.64.64.m3.1.2.1c" xref="alg2.64.64.m3.1.2.1.cmml">⁢</mo><mrow id="alg2.64.64.m3.1.2.6.2" xref="alg2.64.64.m3.1.2.6.1.cmml"><mo id="alg2.64.64.m3.1.2.6.2.1" maxsize="90%" minsize="90%" xref="alg2.64.64.m3.1.2.6.1.1.cmml">[</mo><mn id="alg2.64.64.m3.1.1" mathsize="90%" xref="alg2.64.64.m3.1.1.cmml">0</mn><mo id="alg2.64.64.m3.1.2.6.2.2" maxsize="90%" minsize="90%" xref="alg2.64.64.m3.1.2.6.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.64.64.m3.1b"><apply id="alg2.64.64.m3.1.2.cmml" xref="alg2.64.64.m3.1.2"><times id="alg2.64.64.m3.1.2.1.cmml" xref="alg2.64.64.m3.1.2.1"></times><ci id="alg2.64.64.m3.1.2.2.cmml" xref="alg2.64.64.m3.1.2.2">𝑑</ci><ci id="alg2.64.64.m3.1.2.3.cmml" xref="alg2.64.64.m3.1.2.3">𝑖</ci><ci id="alg2.64.64.m3.1.2.4.cmml" xref="alg2.64.64.m3.1.2.4">𝑚</ci><ci id="alg2.64.64.m3.1.2.5.cmml" xref="alg2.64.64.m3.1.2.5">𝑠</ci><apply id="alg2.64.64.m3.1.2.6.1.cmml" xref="alg2.64.64.m3.1.2.6.2"><csymbol cd="latexml" id="alg2.64.64.m3.1.2.6.1.1.cmml" xref="alg2.64.64.m3.1.2.6.2.1">delimited-[]</csymbol><cn id="alg2.64.64.m3.1.1.cmml" type="integer" xref="alg2.64.64.m3.1.1">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.64.64.m3.1c">dims[0]</annotation><annotation encoding="application/x-llamapun" id="alg2.64.64.m3.1d">italic_d italic_i italic_m italic_s [ 0 ]</annotation></semantics></math><span class="ltx_text" id="alg2.64.64.9" style="font-size:90%;">, stride=2);</span>
</div>
<div class="ltx_listingline" id="alg2.70.86">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.86.1.1.1" style="font-size:90%;">44</span></span><span class="ltx_text" id="alg2.70.86.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.86.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.70.86.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.70.87">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.87.1.1.1" style="font-size:90%;">45</span></span>
</div>
<div class="ltx_listingline" id="alg2.66.66">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.66.66.3.1.1" style="font-size:90%;">46</span></span><span class="ltx_text ltx_font_bold" id="alg2.66.66.4" style="font-size:90%;">Function</span><span class="ltx_text" id="alg2.66.66.5" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg2.66.66.2" style="font-size:90%;">TransformerBlock<math alttext="x" class="ltx_Math" display="inline" id="alg2.65.65.1.m1.1"><semantics id="alg2.65.65.1.m1.1a"><mi id="alg2.65.65.1.m1.1.1" xref="alg2.65.65.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.65.65.1.m1.1b"><ci id="alg2.65.65.1.m1.1.1.cmml" xref="alg2.65.65.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.65.65.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.65.65.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="config" class="ltx_Math" display="inline" id="alg2.66.66.2.m2.1"><semantics id="alg2.66.66.2.m2.1a"><mrow id="alg2.66.66.2.m2.1.1" xref="alg2.66.66.2.m2.1.1.cmml"><mi id="alg2.66.66.2.m2.1.1.2" xref="alg2.66.66.2.m2.1.1.2.cmml">c</mi><mo id="alg2.66.66.2.m2.1.1.1" xref="alg2.66.66.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.66.66.2.m2.1.1.3" xref="alg2.66.66.2.m2.1.1.3.cmml">o</mi><mo id="alg2.66.66.2.m2.1.1.1a" xref="alg2.66.66.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.66.66.2.m2.1.1.4" xref="alg2.66.66.2.m2.1.1.4.cmml">n</mi><mo id="alg2.66.66.2.m2.1.1.1b" xref="alg2.66.66.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.66.66.2.m2.1.1.5" xref="alg2.66.66.2.m2.1.1.5.cmml">f</mi><mo id="alg2.66.66.2.m2.1.1.1c" xref="alg2.66.66.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.66.66.2.m2.1.1.6" xref="alg2.66.66.2.m2.1.1.6.cmml">i</mi><mo id="alg2.66.66.2.m2.1.1.1d" xref="alg2.66.66.2.m2.1.1.1.cmml">⁢</mo><mi id="alg2.66.66.2.m2.1.1.7" xref="alg2.66.66.2.m2.1.1.7.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.66.66.2.m2.1b"><apply id="alg2.66.66.2.m2.1.1.cmml" xref="alg2.66.66.2.m2.1.1"><times id="alg2.66.66.2.m2.1.1.1.cmml" xref="alg2.66.66.2.m2.1.1.1"></times><ci id="alg2.66.66.2.m2.1.1.2.cmml" xref="alg2.66.66.2.m2.1.1.2">𝑐</ci><ci id="alg2.66.66.2.m2.1.1.3.cmml" xref="alg2.66.66.2.m2.1.1.3">𝑜</ci><ci id="alg2.66.66.2.m2.1.1.4.cmml" xref="alg2.66.66.2.m2.1.1.4">𝑛</ci><ci id="alg2.66.66.2.m2.1.1.5.cmml" xref="alg2.66.66.2.m2.1.1.5">𝑓</ci><ci id="alg2.66.66.2.m2.1.1.6.cmml" xref="alg2.66.66.2.m2.1.1.6">𝑖</ci><ci id="alg2.66.66.2.m2.1.1.7.cmml" xref="alg2.66.66.2.m2.1.1.7">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.66.66.2.m2.1c">config</annotation><annotation encoding="application/x-llamapun" id="alg2.66.66.2.m2.1d">italic_c italic_o italic_n italic_f italic_i italic_g</annotation></semantics></math></em><span class="ltx_text ltx_font_bold" id="alg2.66.66.6" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="alg2.67.67">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.67.67.2.1.1" style="font-size:90%;">47</span></span><span class="ltx_text" id="alg2.67.67.3" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.67.67.4" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.67.67.5" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg2.67.67.6" style="font-size:90%;">if</span><span class="ltx_text" id="alg2.67.67.7" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg2.67.67.1" style="font-size:90%;"><math alttext="transformer\_block\_type==" class="ltx_Math" display="inline" id="alg2.67.67.1.m1.1"><semantics id="alg2.67.67.1.m1.1a"><mrow id="alg2.67.67.1.m1.1.1" xref="alg2.67.67.1.m1.1.1.cmml"><mrow id="alg2.67.67.1.m1.1.1.2" xref="alg2.67.67.1.m1.1.1.2.cmml"><mi id="alg2.67.67.1.m1.1.1.2.2" xref="alg2.67.67.1.m1.1.1.2.2.cmml">t</mi><mo id="alg2.67.67.1.m1.1.1.2.1" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.3" xref="alg2.67.67.1.m1.1.1.2.3.cmml">r</mi><mo id="alg2.67.67.1.m1.1.1.2.1a" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.4" xref="alg2.67.67.1.m1.1.1.2.4.cmml">a</mi><mo id="alg2.67.67.1.m1.1.1.2.1b" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.5" xref="alg2.67.67.1.m1.1.1.2.5.cmml">n</mi><mo id="alg2.67.67.1.m1.1.1.2.1c" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.6" xref="alg2.67.67.1.m1.1.1.2.6.cmml">s</mi><mo id="alg2.67.67.1.m1.1.1.2.1d" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.7" xref="alg2.67.67.1.m1.1.1.2.7.cmml">f</mi><mo id="alg2.67.67.1.m1.1.1.2.1e" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.8" xref="alg2.67.67.1.m1.1.1.2.8.cmml">o</mi><mo id="alg2.67.67.1.m1.1.1.2.1f" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.9" xref="alg2.67.67.1.m1.1.1.2.9.cmml">r</mi><mo id="alg2.67.67.1.m1.1.1.2.1g" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.10" xref="alg2.67.67.1.m1.1.1.2.10.cmml">m</mi><mo id="alg2.67.67.1.m1.1.1.2.1h" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.11" xref="alg2.67.67.1.m1.1.1.2.11.cmml">e</mi><mo id="alg2.67.67.1.m1.1.1.2.1i" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.12" xref="alg2.67.67.1.m1.1.1.2.12.cmml">r</mi><mo id="alg2.67.67.1.m1.1.1.2.1j" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.13" mathvariant="normal" xref="alg2.67.67.1.m1.1.1.2.13.cmml">_</mi><mo id="alg2.67.67.1.m1.1.1.2.1k" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.14" xref="alg2.67.67.1.m1.1.1.2.14.cmml">b</mi><mo id="alg2.67.67.1.m1.1.1.2.1l" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.15" xref="alg2.67.67.1.m1.1.1.2.15.cmml">l</mi><mo id="alg2.67.67.1.m1.1.1.2.1m" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.16" xref="alg2.67.67.1.m1.1.1.2.16.cmml">o</mi><mo id="alg2.67.67.1.m1.1.1.2.1n" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.17" xref="alg2.67.67.1.m1.1.1.2.17.cmml">c</mi><mo id="alg2.67.67.1.m1.1.1.2.1o" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.18" xref="alg2.67.67.1.m1.1.1.2.18.cmml">k</mi><mo id="alg2.67.67.1.m1.1.1.2.1p" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.19" mathvariant="normal" xref="alg2.67.67.1.m1.1.1.2.19.cmml">_</mi><mo id="alg2.67.67.1.m1.1.1.2.1q" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.20" xref="alg2.67.67.1.m1.1.1.2.20.cmml">t</mi><mo id="alg2.67.67.1.m1.1.1.2.1r" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.21" xref="alg2.67.67.1.m1.1.1.2.21.cmml">y</mi><mo id="alg2.67.67.1.m1.1.1.2.1s" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.22" xref="alg2.67.67.1.m1.1.1.2.22.cmml">p</mi><mo id="alg2.67.67.1.m1.1.1.2.1t" xref="alg2.67.67.1.m1.1.1.2.1.cmml">⁢</mo><mi id="alg2.67.67.1.m1.1.1.2.23" xref="alg2.67.67.1.m1.1.1.2.23.cmml">e</mi></mrow><mo id="alg2.67.67.1.m1.1.1.1" rspace="0em" xref="alg2.67.67.1.m1.1.1.1.cmml">=</mo><mo id="alg2.67.67.1.m1.1.1.3" lspace="0em" xref="alg2.67.67.1.m1.1.1.3.cmml">=</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.67.67.1.m1.1b"><apply id="alg2.67.67.1.m1.1.1.cmml" xref="alg2.67.67.1.m1.1.1"><eq id="alg2.67.67.1.m1.1.1.1.cmml" xref="alg2.67.67.1.m1.1.1.1"></eq><apply id="alg2.67.67.1.m1.1.1.2.cmml" xref="alg2.67.67.1.m1.1.1.2"><times id="alg2.67.67.1.m1.1.1.2.1.cmml" xref="alg2.67.67.1.m1.1.1.2.1"></times><ci id="alg2.67.67.1.m1.1.1.2.2.cmml" xref="alg2.67.67.1.m1.1.1.2.2">𝑡</ci><ci id="alg2.67.67.1.m1.1.1.2.3.cmml" xref="alg2.67.67.1.m1.1.1.2.3">𝑟</ci><ci id="alg2.67.67.1.m1.1.1.2.4.cmml" xref="alg2.67.67.1.m1.1.1.2.4">𝑎</ci><ci id="alg2.67.67.1.m1.1.1.2.5.cmml" xref="alg2.67.67.1.m1.1.1.2.5">𝑛</ci><ci id="alg2.67.67.1.m1.1.1.2.6.cmml" xref="alg2.67.67.1.m1.1.1.2.6">𝑠</ci><ci id="alg2.67.67.1.m1.1.1.2.7.cmml" xref="alg2.67.67.1.m1.1.1.2.7">𝑓</ci><ci id="alg2.67.67.1.m1.1.1.2.8.cmml" xref="alg2.67.67.1.m1.1.1.2.8">𝑜</ci><ci id="alg2.67.67.1.m1.1.1.2.9.cmml" xref="alg2.67.67.1.m1.1.1.2.9">𝑟</ci><ci id="alg2.67.67.1.m1.1.1.2.10.cmml" xref="alg2.67.67.1.m1.1.1.2.10">𝑚</ci><ci id="alg2.67.67.1.m1.1.1.2.11.cmml" xref="alg2.67.67.1.m1.1.1.2.11">𝑒</ci><ci id="alg2.67.67.1.m1.1.1.2.12.cmml" xref="alg2.67.67.1.m1.1.1.2.12">𝑟</ci><ci id="alg2.67.67.1.m1.1.1.2.13.cmml" xref="alg2.67.67.1.m1.1.1.2.13">_</ci><ci id="alg2.67.67.1.m1.1.1.2.14.cmml" xref="alg2.67.67.1.m1.1.1.2.14">𝑏</ci><ci id="alg2.67.67.1.m1.1.1.2.15.cmml" xref="alg2.67.67.1.m1.1.1.2.15">𝑙</ci><ci id="alg2.67.67.1.m1.1.1.2.16.cmml" xref="alg2.67.67.1.m1.1.1.2.16">𝑜</ci><ci id="alg2.67.67.1.m1.1.1.2.17.cmml" xref="alg2.67.67.1.m1.1.1.2.17">𝑐</ci><ci id="alg2.67.67.1.m1.1.1.2.18.cmml" xref="alg2.67.67.1.m1.1.1.2.18">𝑘</ci><ci id="alg2.67.67.1.m1.1.1.2.19.cmml" xref="alg2.67.67.1.m1.1.1.2.19">_</ci><ci id="alg2.67.67.1.m1.1.1.2.20.cmml" xref="alg2.67.67.1.m1.1.1.2.20">𝑡</ci><ci id="alg2.67.67.1.m1.1.1.2.21.cmml" xref="alg2.67.67.1.m1.1.1.2.21">𝑦</ci><ci id="alg2.67.67.1.m1.1.1.2.22.cmml" xref="alg2.67.67.1.m1.1.1.2.22">𝑝</ci><ci id="alg2.67.67.1.m1.1.1.2.23.cmml" xref="alg2.67.67.1.m1.1.1.2.23">𝑒</ci></apply><eq id="alg2.67.67.1.m1.1.1.3.cmml" xref="alg2.67.67.1.m1.1.1.3"></eq></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.67.67.1.m1.1c">transformer\_block\_type==</annotation><annotation encoding="application/x-llamapun" id="alg2.67.67.1.m1.1d">italic_t italic_r italic_a italic_n italic_s italic_f italic_o italic_r italic_m italic_e italic_r _ italic_b italic_l italic_o italic_c italic_k _ italic_t italic_y italic_p italic_e = =</annotation></semantics></math> ’TFB’</em><span class="ltx_text" id="alg2.67.67.8" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg2.67.67.9" style="font-size:90%;">then</span>
</div>
<div class="ltx_listingline" id="alg2.69.69">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.69.69.1.1.1" style="font-size:90%;">48</span></span><span class="ltx_text" id="alg2.69.69.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.69.69.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.69.69.4" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.69.69.5" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg2.69.69.6" style="font-size:90%;">return</span><span class="ltx_text" id="alg2.69.69.7" style="font-size:90%;"> TFB(</span><math alttext="x" class="ltx_Math" display="inline" id="alg2.68.68.m1.1"><semantics id="alg2.68.68.m1.1a"><mi id="alg2.68.68.m1.1.1" mathsize="90%" xref="alg2.68.68.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.68.68.m1.1b"><ci id="alg2.68.68.m1.1.1.cmml" xref="alg2.68.68.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.68.68.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.68.68.m1.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.69.69.8" style="font-size:90%;">, </span><math alttext="config" class="ltx_Math" display="inline" id="alg2.69.69.m2.1"><semantics id="alg2.69.69.m2.1a"><mrow id="alg2.69.69.m2.1.1" xref="alg2.69.69.m2.1.1.cmml"><mi id="alg2.69.69.m2.1.1.2" mathsize="90%" xref="alg2.69.69.m2.1.1.2.cmml">c</mi><mo id="alg2.69.69.m2.1.1.1" xref="alg2.69.69.m2.1.1.1.cmml">⁢</mo><mi id="alg2.69.69.m2.1.1.3" mathsize="90%" xref="alg2.69.69.m2.1.1.3.cmml">o</mi><mo id="alg2.69.69.m2.1.1.1a" xref="alg2.69.69.m2.1.1.1.cmml">⁢</mo><mi id="alg2.69.69.m2.1.1.4" mathsize="90%" xref="alg2.69.69.m2.1.1.4.cmml">n</mi><mo id="alg2.69.69.m2.1.1.1b" xref="alg2.69.69.m2.1.1.1.cmml">⁢</mo><mi id="alg2.69.69.m2.1.1.5" mathsize="90%" xref="alg2.69.69.m2.1.1.5.cmml">f</mi><mo id="alg2.69.69.m2.1.1.1c" xref="alg2.69.69.m2.1.1.1.cmml">⁢</mo><mi id="alg2.69.69.m2.1.1.6" mathsize="90%" xref="alg2.69.69.m2.1.1.6.cmml">i</mi><mo id="alg2.69.69.m2.1.1.1d" xref="alg2.69.69.m2.1.1.1.cmml">⁢</mo><mi id="alg2.69.69.m2.1.1.7" mathsize="90%" xref="alg2.69.69.m2.1.1.7.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.69.69.m2.1b"><apply id="alg2.69.69.m2.1.1.cmml" xref="alg2.69.69.m2.1.1"><times id="alg2.69.69.m2.1.1.1.cmml" xref="alg2.69.69.m2.1.1.1"></times><ci id="alg2.69.69.m2.1.1.2.cmml" xref="alg2.69.69.m2.1.1.2">𝑐</ci><ci id="alg2.69.69.m2.1.1.3.cmml" xref="alg2.69.69.m2.1.1.3">𝑜</ci><ci id="alg2.69.69.m2.1.1.4.cmml" xref="alg2.69.69.m2.1.1.4">𝑛</ci><ci id="alg2.69.69.m2.1.1.5.cmml" xref="alg2.69.69.m2.1.1.5">𝑓</ci><ci id="alg2.69.69.m2.1.1.6.cmml" xref="alg2.69.69.m2.1.1.6">𝑖</ci><ci id="alg2.69.69.m2.1.1.7.cmml" xref="alg2.69.69.m2.1.1.7">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.69.69.m2.1c">config</annotation><annotation encoding="application/x-llamapun" id="alg2.69.69.m2.1d">italic_c italic_o italic_n italic_f italic_i italic_g</annotation></semantics></math><span class="ltx_text" id="alg2.69.69.9" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg2.70.88">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.88.1.1.1" style="font-size:90%;">49</span></span><span class="ltx_text" id="alg2.70.88.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.88.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.88.4" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.70.88.5" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.70.89">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.89.1.1.1" style="font-size:90%;">50</span></span><span class="ltx_text" id="alg2.70.89.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.89.3" style="font-size:90%;">   </span><span class="ltx_text ltx_font_bold" id="alg2.70.89.4" style="font-size:90%;">else</span>
</div>
<div class="ltx_listingline" id="alg2.70.70">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.70.1.1.1" style="font-size:90%;">51</span></span><span class="ltx_text" id="alg2.70.70.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.70.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.70.4" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.70.70.5" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg2.70.70.6" style="font-size:90%;">return</span><span class="ltx_text" id="alg2.70.70.7" style="font-size:90%;"> </span><math alttext="x" class="ltx_Math" display="inline" id="alg2.70.70.m1.1"><semantics id="alg2.70.70.m1.1a"><mi id="alg2.70.70.m1.1.1" mathsize="90%" xref="alg2.70.70.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.70.70.m1.1b"><ci id="alg2.70.70.m1.1.1.cmml" xref="alg2.70.70.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.70.70.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg2.70.70.m1.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg2.70.70.8" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg2.70.90">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.90.1.1.1" style="font-size:90%;">52</span></span><span class="ltx_text" id="alg2.70.90.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.90.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.90.4" style="font-size:90%;">   </span><span class="ltx_text" id="alg2.70.90.5" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg2.70.91">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.70.91.1.1.1" style="font-size:90%;">53</span></span><span class="ltx_text" id="alg2.70.91.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg2.70.91.3" style="font-size:90%;">   </span>
</div>
<div class="ltx_listingline" id="alg2.70.92">
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.74.1.1">Algorithm 2</span> </span>Encoder</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Decoder Architecture Design</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.2">The decoder is responsible for reconstructing the output, specifically depth maps and surface normals, from the encoded features <math alttext="\mathbf{F}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.1.m1.1"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><mi id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><ci id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">\mathbf{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.1.m1.1d">bold_F</annotation></semantics></math>. The decoding process, as outlined in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#alg3" title="Algorithm 3 ‣ 3.3.2 Decoder Architecture Design ‣ 3.3 Step 2: Training of the Student Model ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">3</span></a>, begins with a series of upsampling operations to progressively restore the spatial resolution of the feature maps. For each stage <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.2.m2.1"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mi id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><ci id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.2.m2.1d">italic_i</annotation></semantics></math>, the decoder employs an upsampling convolution, denoted as <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p1.2.1">Upconv</span>, to increase the resolution of the feature maps, expressed as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{F}_{up}^{i}=\text{Upconv}(\mathbf{F}_{enc}^{i})." class="ltx_Math" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msubsup id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.3.2.2.cmml">𝐅</mi><mrow id="S3.E5.m1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.3.2" xref="S3.E5.m1.1.1.1.1.3.2.3.2.cmml">u</mi><mo id="S3.E5.m1.1.1.1.1.3.2.3.1" xref="S3.E5.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.1.1.3.2.3.3.cmml">p</mi></mrow><mi id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml">i</mi></msubsup><mo id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><mtext id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.3a.cmml">Upconv</mtext><mo id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐅</mi><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">e</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">n</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.1a" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.4" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.4.cmml">c</mi></mrow><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E5.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" lspace="0em" xref="S3.E5.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"></eq><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2">𝐅</ci><apply id="S3.E5.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3"><times id="S3.E5.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E5.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.2">𝑢</ci><ci id="S3.E5.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.3">𝑝</ci></apply></apply><ci id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.1.1.3a.cmml" xref="S3.E5.m1.1.1.1.1.1.3"><mtext id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3">Upconv</mtext></ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.2">𝐅</ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.2">𝑒</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.3">𝑛</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.4">𝑐</ci></apply></apply><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathbf{F}_{up}^{i}=\text{Upconv}(\mathbf{F}_{enc}^{i}).</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">bold_F start_POSTSUBSCRIPT italic_u italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = Upconv ( bold_F start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p2">
<p class="ltx_p" id="S3.SS3.SSS2.p2.2">At each stage, skip connections are utilised to concatenate the feature maps from the encoder <math alttext="\mathbf{F}_{enc}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.1.m1.1"><semantics id="S3.SS3.SSS2.p2.1.m1.1a"><msub id="S3.SS3.SSS2.p2.1.m1.1.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.1.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.2.cmml">𝐅</mi><mrow id="S3.SS3.SSS2.p2.1.m1.1.1.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.1.m1.1.1.3.2" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.2.cmml">e</mi><mo id="S3.SS3.SSS2.p2.1.m1.1.1.3.1" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.1.m1.1.1.3.3" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3.cmml">n</mi><mo id="S3.SS3.SSS2.p2.1.m1.1.1.3.1a" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.1.m1.1.1.3.4" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.1.m1.1b"><apply id="S3.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.2">𝐅</ci><apply id="S3.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3"><times id="S3.SS3.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.1"></times><ci id="S3.SS3.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.2">𝑒</ci><ci id="S3.SS3.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.3">𝑛</ci><ci id="S3.SS3.SSS2.p2.1.m1.1.1.3.4.cmml" xref="S3.SS3.SSS2.p2.1.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.1.m1.1c">\mathbf{F}_{enc}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.1.m1.1d">bold_F start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT</annotation></semantics></math> with the upsampled feature maps in the decoder <math alttext="\mathbf{F}_{up}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p2.2.m2.1"><semantics id="S3.SS3.SSS2.p2.2.m2.1a"><msub id="S3.SS3.SSS2.p2.2.m2.1.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.1.1.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml">𝐅</mi><mrow id="S3.SS3.SSS2.p2.2.m2.1.1.3" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.SSS2.p2.2.m2.1.1.3.2" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.2.cmml">u</mi><mo id="S3.SS3.SSS2.p2.2.m2.1.1.3.1" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p2.2.m2.1.1.3.3" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p2.2.m2.1b"><apply id="S3.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.2">𝐅</ci><apply id="S3.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3"><times id="S3.SS3.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.1"></times><ci id="S3.SS3.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.2">𝑢</ci><ci id="S3.SS3.SSS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.SSS2.p2.2.m2.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p2.2.m2.1c">\mathbf{F}_{up}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p2.2.m2.1d">bold_F start_POSTSUBSCRIPT italic_u italic_p end_POSTSUBSCRIPT</annotation></semantics></math>. This strategy allows the model to merge high-level semantic information from the encoder with fine-grained details, enabling better reconstruction of complex spatial structures. The concatenation is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{F}_{dec}^{i}=\text{Concatenate}(\mathbf{F}_{up}^{i},\mathbf{F}_{enc}^{%
i-1})." class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msubsup id="S3.E6.m1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.4.cmml"><mi id="S3.E6.m1.1.1.1.1.4.2.2" xref="S3.E6.m1.1.1.1.1.4.2.2.cmml">𝐅</mi><mrow id="S3.E6.m1.1.1.1.1.4.2.3" xref="S3.E6.m1.1.1.1.1.4.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.4.2.3.2" xref="S3.E6.m1.1.1.1.1.4.2.3.2.cmml">d</mi><mo id="S3.E6.m1.1.1.1.1.4.2.3.1" xref="S3.E6.m1.1.1.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.4.2.3.3" xref="S3.E6.m1.1.1.1.1.4.2.3.3.cmml">e</mi><mo id="S3.E6.m1.1.1.1.1.4.2.3.1a" xref="S3.E6.m1.1.1.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.4.2.3.4" xref="S3.E6.m1.1.1.1.1.4.2.3.4.cmml">c</mi></mrow><mi id="S3.E6.m1.1.1.1.1.4.3" xref="S3.E6.m1.1.1.1.1.4.3.cmml">i</mi></msubsup><mo id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml"><mtext id="S3.E6.m1.1.1.1.1.2.4" xref="S3.E6.m1.1.1.1.1.2.4a.cmml">Concatenate</mtext><mo id="S3.E6.m1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml"><mo id="S3.E6.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐅</mi><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">u</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">p</mi></mrow><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E6.m1.1.1.1.1.2.2.2.4" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E6.m1.1.1.1.1.2.2.2.2" xref="S3.E6.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.2.cmml">𝐅</mi><mrow id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.2" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.2.cmml">e</mi><mo id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.1" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.3" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.3.cmml">n</mi><mo id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.1a" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.4" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.4.cmml">c</mi></mrow><mrow id="S3.E6.m1.1.1.1.1.2.2.2.2.3" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2.2.2.3.2" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.2.2.2.2.3.1" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E6.m1.1.1.1.1.2.2.2.2.3.3" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" lspace="0em" xref="S3.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"></eq><apply id="S3.E6.m1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.4.1.cmml" xref="S3.E6.m1.1.1.1.1.4">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.4.2.cmml" xref="S3.E6.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.4.2.1.cmml" xref="S3.E6.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.4.2.2.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2">𝐅</ci><apply id="S3.E6.m1.1.1.1.1.4.2.3.cmml" xref="S3.E6.m1.1.1.1.1.4.2.3"><times id="S3.E6.m1.1.1.1.1.4.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.4.2.3.1"></times><ci id="S3.E6.m1.1.1.1.1.4.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.4.2.3.2">𝑑</ci><ci id="S3.E6.m1.1.1.1.1.4.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.4.2.3.3">𝑒</ci><ci id="S3.E6.m1.1.1.1.1.4.2.3.4.cmml" xref="S3.E6.m1.1.1.1.1.4.2.3.4">𝑐</ci></apply></apply><ci id="S3.E6.m1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.1.1.1.1.4.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><times id="S3.E6.m1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.3"></times><ci id="S3.E6.m1.1.1.1.1.2.4a.cmml" xref="S3.E6.m1.1.1.1.1.2.4"><mtext id="S3.E6.m1.1.1.1.1.2.4.cmml" xref="S3.E6.m1.1.1.1.1.2.4">Concatenate</mtext></ci><interval closure="open" id="S3.E6.m1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2"><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2">𝐅</ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.2">𝑢</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.3">𝑝</ci></apply></apply><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.2">𝐅</ci><apply id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3"><times id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.1"></times><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.2">𝑒</ci><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.3">𝑛</ci><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.4.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2.3.4">𝑐</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3"><minus id="S3.E6.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.1"></minus><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.2">𝑖</ci><cn id="S3.E6.m1.1.1.1.1.2.2.2.2.3.3.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\mathbf{F}_{dec}^{i}=\text{Concatenate}(\mathbf{F}_{up}^{i},\mathbf{F}_{enc}^{%
i-1}).</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">bold_F start_POSTSUBSCRIPT italic_d italic_e italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = Concatenate ( bold_F start_POSTSUBSCRIPT italic_u italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , bold_F start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i - 1 end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p3">
<p class="ltx_p" id="S3.SS3.SSS2.p3.2">For specific scales <math alttext="i\in S" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.1.m1.1"><semantics id="S3.SS3.SSS2.p3.1.m1.1a"><mrow id="S3.SS3.SSS2.p3.1.m1.1.1" xref="S3.SS3.SSS2.p3.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p3.1.m1.1.1.2" xref="S3.SS3.SSS2.p3.1.m1.1.1.2.cmml">i</mi><mo id="S3.SS3.SSS2.p3.1.m1.1.1.1" xref="S3.SS3.SSS2.p3.1.m1.1.1.1.cmml">∈</mo><mi id="S3.SS3.SSS2.p3.1.m1.1.1.3" xref="S3.SS3.SSS2.p3.1.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.1.m1.1b"><apply id="S3.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1"><in id="S3.SS3.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.1"></in><ci id="S3.SS3.SSS2.p3.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.2">𝑖</ci><ci id="S3.SS3.SSS2.p3.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p3.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.1.m1.1c">i\in S</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.1.m1.1d">italic_i ∈ italic_S</annotation></semantics></math>, the decoder produces depth and surface normal predictions. The depth predictions, denoted by <math alttext="\mathbf{D}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.2.m2.1"><semantics id="S3.SS3.SSS2.p3.2.m2.1a"><msub id="S3.SS3.SSS2.p3.2.m2.1.1" xref="S3.SS3.SSS2.p3.2.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p3.2.m2.1.1.2" xref="S3.SS3.SSS2.p3.2.m2.1.1.2.cmml">𝐃</mi><mi id="S3.SS3.SSS2.p3.2.m2.1.1.3" xref="S3.SS3.SSS2.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.2.m2.1b"><apply id="S3.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p3.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p3.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.2">𝐃</ci><ci id="S3.SS3.SSS2.p3.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.2.m2.1c">\mathbf{D}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.2.m2.1d">bold_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, are generated using a <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p3.2.1">Dispconv</span> operation, followed by a sigmoid activation to ensure the depth values are bounded within a valid range:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{D}_{i}=\sigma\left(\text{Dispconv}\left(\mathbf{F}_{dec}^{i}\right)%
\right)," class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml">𝐃</mi><mi id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E7.m1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3a.cmml">Dispconv</mtext><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐅</mi><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">d</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">e</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1a" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.4" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.4.cmml">c</mi></mrow><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"></eq><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2">𝐃</ci><ci id="S3.E7.m1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3">𝜎</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3">Dispconv</mtext></ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐅</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑑</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑒</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.4">𝑐</ci></apply></apply><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\mathbf{D}_{i}=\sigma\left(\text{Dispconv}\left(\mathbf{F}_{dec}^{i}\right)%
\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">bold_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_σ ( Dispconv ( bold_F start_POSTSUBSCRIPT italic_d italic_e italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p3.3">where <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p3.3.m1.1"><semantics id="S3.SS3.SSS2.p3.3.m1.1a"><mi id="S3.SS3.SSS2.p3.3.m1.1.1" xref="S3.SS3.SSS2.p3.3.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p3.3.m1.1b"><ci id="S3.SS3.SSS2.p3.3.m1.1.1.cmml" xref="S3.SS3.SSS2.p3.3.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p3.3.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p3.3.m1.1d">italic_σ</annotation></semantics></math> represents the sigmoid function.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p4">
<p class="ltx_p" id="S3.SS3.SSS2.p4.4">Surface normal predictions, <math alttext="\mathbf{N}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.1.m1.1"><semantics id="S3.SS3.SSS2.p4.1.m1.1a"><msub id="S3.SS3.SSS2.p4.1.m1.1.1" xref="S3.SS3.SSS2.p4.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p4.1.m1.1.1.2" xref="S3.SS3.SSS2.p4.1.m1.1.1.2.cmml">𝐍</mi><mi id="S3.SS3.SSS2.p4.1.m1.1.1.3" xref="S3.SS3.SSS2.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.1.m1.1b"><apply id="S3.SS3.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1.2">𝐍</ci><ci id="S3.SS3.SSS2.p4.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.1.m1.1c">\mathbf{N}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.1.m1.1d">bold_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, are obtained via a <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS2.p4.4.1">Normconv</span> operation. The predicted normals are then normalised to form unit vectors, ensuring physically plausible surface orientations. This is achieved by normalising the vector components <math alttext="N_{x}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.2.m2.1"><semantics id="S3.SS3.SSS2.p4.2.m2.1a"><msub id="S3.SS3.SSS2.p4.2.m2.1.1" xref="S3.SS3.SSS2.p4.2.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p4.2.m2.1.1.2" xref="S3.SS3.SSS2.p4.2.m2.1.1.2.cmml">N</mi><mi id="S3.SS3.SSS2.p4.2.m2.1.1.3" xref="S3.SS3.SSS2.p4.2.m2.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.2.m2.1b"><apply id="S3.SS3.SSS2.p4.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1.2">𝑁</ci><ci id="S3.SS3.SSS2.p4.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p4.2.m2.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.2.m2.1c">N_{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="N_{y}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.3.m3.1"><semantics id="S3.SS3.SSS2.p4.3.m3.1a"><msub id="S3.SS3.SSS2.p4.3.m3.1.1" xref="S3.SS3.SSS2.p4.3.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p4.3.m3.1.1.2" xref="S3.SS3.SSS2.p4.3.m3.1.1.2.cmml">N</mi><mi id="S3.SS3.SSS2.p4.3.m3.1.1.3" xref="S3.SS3.SSS2.p4.3.m3.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.3.m3.1b"><apply id="S3.SS3.SSS2.p4.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.3.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.3.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1.2">𝑁</ci><ci id="S3.SS3.SSS2.p4.3.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p4.3.m3.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.3.m3.1c">N_{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="N_{z}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.4.m4.1"><semantics id="S3.SS3.SSS2.p4.4.m4.1a"><msub id="S3.SS3.SSS2.p4.4.m4.1.1" xref="S3.SS3.SSS2.p4.4.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p4.4.m4.1.1.2" xref="S3.SS3.SSS2.p4.4.m4.1.1.2.cmml">N</mi><mi id="S3.SS3.SSS2.p4.4.m4.1.1.3" xref="S3.SS3.SSS2.p4.4.m4.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.4.m4.1b"><apply id="S3.SS3.SSS2.p4.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p4.4.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p4.4.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1.2">𝑁</ci><ci id="S3.SS3.SSS2.p4.4.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p4.4.m4.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.4.m4.1c">N_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathbf{N}_{i}=\frac{\left(N_{x},N_{y},N_{z}\right)}{\sqrt{N_{x}^{2}+N_{y}^{2}%
+N_{z}^{2}}+\epsilon}," class="ltx_Math" display="block" id="S3.E8.m1.4"><semantics id="S3.E8.m1.4a"><mrow id="S3.E8.m1.4.4.1" xref="S3.E8.m1.4.4.1.1.cmml"><mrow id="S3.E8.m1.4.4.1.1" xref="S3.E8.m1.4.4.1.1.cmml"><msub id="S3.E8.m1.4.4.1.1.2" xref="S3.E8.m1.4.4.1.1.2.cmml"><mi id="S3.E8.m1.4.4.1.1.2.2" xref="S3.E8.m1.4.4.1.1.2.2.cmml">𝐍</mi><mi id="S3.E8.m1.4.4.1.1.2.3" xref="S3.E8.m1.4.4.1.1.2.3.cmml">i</mi></msub><mo id="S3.E8.m1.4.4.1.1.1" xref="S3.E8.m1.4.4.1.1.1.cmml">=</mo><mfrac id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml"><mrow id="S3.E8.m1.3.3.3.3" xref="S3.E8.m1.3.3.3.4.cmml"><mo id="S3.E8.m1.3.3.3.3.4" xref="S3.E8.m1.3.3.3.4.cmml">(</mo><msub id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.2.cmml">N</mi><mi id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.E8.m1.3.3.3.3.5" xref="S3.E8.m1.3.3.3.4.cmml">,</mo><msub id="S3.E8.m1.2.2.2.2.2" xref="S3.E8.m1.2.2.2.2.2.cmml"><mi id="S3.E8.m1.2.2.2.2.2.2" xref="S3.E8.m1.2.2.2.2.2.2.cmml">N</mi><mi id="S3.E8.m1.2.2.2.2.2.3" xref="S3.E8.m1.2.2.2.2.2.3.cmml">y</mi></msub><mo id="S3.E8.m1.3.3.3.3.6" xref="S3.E8.m1.3.3.3.4.cmml">,</mo><msub id="S3.E8.m1.3.3.3.3.3" xref="S3.E8.m1.3.3.3.3.3.cmml"><mi id="S3.E8.m1.3.3.3.3.3.2" xref="S3.E8.m1.3.3.3.3.3.2.cmml">N</mi><mi id="S3.E8.m1.3.3.3.3.3.3" xref="S3.E8.m1.3.3.3.3.3.3.cmml">z</mi></msub><mo id="S3.E8.m1.3.3.3.3.7" xref="S3.E8.m1.3.3.3.4.cmml">)</mo></mrow><mrow id="S3.E8.m1.3.3.5" xref="S3.E8.m1.3.3.5.cmml"><msqrt id="S3.E8.m1.3.3.5.2" xref="S3.E8.m1.3.3.5.2.cmml"><mrow id="S3.E8.m1.3.3.5.2.2" xref="S3.E8.m1.3.3.5.2.2.cmml"><msubsup id="S3.E8.m1.3.3.5.2.2.2" xref="S3.E8.m1.3.3.5.2.2.2.cmml"><mi id="S3.E8.m1.3.3.5.2.2.2.2.2" xref="S3.E8.m1.3.3.5.2.2.2.2.2.cmml">N</mi><mi id="S3.E8.m1.3.3.5.2.2.2.2.3" xref="S3.E8.m1.3.3.5.2.2.2.2.3.cmml">x</mi><mn id="S3.E8.m1.3.3.5.2.2.2.3" xref="S3.E8.m1.3.3.5.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.E8.m1.3.3.5.2.2.1" xref="S3.E8.m1.3.3.5.2.2.1.cmml">+</mo><msubsup id="S3.E8.m1.3.3.5.2.2.3" xref="S3.E8.m1.3.3.5.2.2.3.cmml"><mi id="S3.E8.m1.3.3.5.2.2.3.2.2" xref="S3.E8.m1.3.3.5.2.2.3.2.2.cmml">N</mi><mi id="S3.E8.m1.3.3.5.2.2.3.2.3" xref="S3.E8.m1.3.3.5.2.2.3.2.3.cmml">y</mi><mn id="S3.E8.m1.3.3.5.2.2.3.3" xref="S3.E8.m1.3.3.5.2.2.3.3.cmml">2</mn></msubsup><mo id="S3.E8.m1.3.3.5.2.2.1a" xref="S3.E8.m1.3.3.5.2.2.1.cmml">+</mo><msubsup id="S3.E8.m1.3.3.5.2.2.4" xref="S3.E8.m1.3.3.5.2.2.4.cmml"><mi id="S3.E8.m1.3.3.5.2.2.4.2.2" xref="S3.E8.m1.3.3.5.2.2.4.2.2.cmml">N</mi><mi id="S3.E8.m1.3.3.5.2.2.4.2.3" xref="S3.E8.m1.3.3.5.2.2.4.2.3.cmml">z</mi><mn id="S3.E8.m1.3.3.5.2.2.4.3" xref="S3.E8.m1.3.3.5.2.2.4.3.cmml">2</mn></msubsup></mrow></msqrt><mo id="S3.E8.m1.3.3.5.1" xref="S3.E8.m1.3.3.5.1.cmml">+</mo><mi id="S3.E8.m1.3.3.5.3" xref="S3.E8.m1.3.3.5.3.cmml">ϵ</mi></mrow></mfrac></mrow><mo id="S3.E8.m1.4.4.1.2" xref="S3.E8.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.4b"><apply id="S3.E8.m1.4.4.1.1.cmml" xref="S3.E8.m1.4.4.1"><eq id="S3.E8.m1.4.4.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1"></eq><apply id="S3.E8.m1.4.4.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.1.1.2.1.cmml" xref="S3.E8.m1.4.4.1.1.2">subscript</csymbol><ci id="S3.E8.m1.4.4.1.1.2.2.cmml" xref="S3.E8.m1.4.4.1.1.2.2">𝐍</ci><ci id="S3.E8.m1.4.4.1.1.2.3.cmml" xref="S3.E8.m1.4.4.1.1.2.3">𝑖</ci></apply><apply id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3"><divide id="S3.E8.m1.3.3.4.cmml" xref="S3.E8.m1.3.3"></divide><vector id="S3.E8.m1.3.3.3.4.cmml" xref="S3.E8.m1.3.3.3.3"><apply id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.2">𝑁</ci><ci id="S3.E8.m1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S3.E8.m1.2.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.2.1.cmml" xref="S3.E8.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E8.m1.2.2.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2.2.2">𝑁</ci><ci id="S3.E8.m1.2.2.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.2.2.3">𝑦</ci></apply><apply id="S3.E8.m1.3.3.3.3.3.cmml" xref="S3.E8.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.3.3.3.1.cmml" xref="S3.E8.m1.3.3.3.3.3">subscript</csymbol><ci id="S3.E8.m1.3.3.3.3.3.2.cmml" xref="S3.E8.m1.3.3.3.3.3.2">𝑁</ci><ci id="S3.E8.m1.3.3.3.3.3.3.cmml" xref="S3.E8.m1.3.3.3.3.3.3">𝑧</ci></apply></vector><apply id="S3.E8.m1.3.3.5.cmml" xref="S3.E8.m1.3.3.5"><plus id="S3.E8.m1.3.3.5.1.cmml" xref="S3.E8.m1.3.3.5.1"></plus><apply id="S3.E8.m1.3.3.5.2.cmml" xref="S3.E8.m1.3.3.5.2"><root id="S3.E8.m1.3.3.5.2a.cmml" xref="S3.E8.m1.3.3.5.2"></root><apply id="S3.E8.m1.3.3.5.2.2.cmml" xref="S3.E8.m1.3.3.5.2.2"><plus id="S3.E8.m1.3.3.5.2.2.1.cmml" xref="S3.E8.m1.3.3.5.2.2.1"></plus><apply id="S3.E8.m1.3.3.5.2.2.2.cmml" xref="S3.E8.m1.3.3.5.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.5.2.2.2.1.cmml" xref="S3.E8.m1.3.3.5.2.2.2">superscript</csymbol><apply id="S3.E8.m1.3.3.5.2.2.2.2.cmml" xref="S3.E8.m1.3.3.5.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.5.2.2.2.2.1.cmml" xref="S3.E8.m1.3.3.5.2.2.2">subscript</csymbol><ci id="S3.E8.m1.3.3.5.2.2.2.2.2.cmml" xref="S3.E8.m1.3.3.5.2.2.2.2.2">𝑁</ci><ci id="S3.E8.m1.3.3.5.2.2.2.2.3.cmml" xref="S3.E8.m1.3.3.5.2.2.2.2.3">𝑥</ci></apply><cn id="S3.E8.m1.3.3.5.2.2.2.3.cmml" type="integer" xref="S3.E8.m1.3.3.5.2.2.2.3">2</cn></apply><apply id="S3.E8.m1.3.3.5.2.2.3.cmml" xref="S3.E8.m1.3.3.5.2.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.5.2.2.3.1.cmml" xref="S3.E8.m1.3.3.5.2.2.3">superscript</csymbol><apply id="S3.E8.m1.3.3.5.2.2.3.2.cmml" xref="S3.E8.m1.3.3.5.2.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.5.2.2.3.2.1.cmml" xref="S3.E8.m1.3.3.5.2.2.3">subscript</csymbol><ci id="S3.E8.m1.3.3.5.2.2.3.2.2.cmml" xref="S3.E8.m1.3.3.5.2.2.3.2.2">𝑁</ci><ci id="S3.E8.m1.3.3.5.2.2.3.2.3.cmml" xref="S3.E8.m1.3.3.5.2.2.3.2.3">𝑦</ci></apply><cn id="S3.E8.m1.3.3.5.2.2.3.3.cmml" type="integer" xref="S3.E8.m1.3.3.5.2.2.3.3">2</cn></apply><apply id="S3.E8.m1.3.3.5.2.2.4.cmml" xref="S3.E8.m1.3.3.5.2.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.5.2.2.4.1.cmml" xref="S3.E8.m1.3.3.5.2.2.4">superscript</csymbol><apply id="S3.E8.m1.3.3.5.2.2.4.2.cmml" xref="S3.E8.m1.3.3.5.2.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.5.2.2.4.2.1.cmml" xref="S3.E8.m1.3.3.5.2.2.4">subscript</csymbol><ci id="S3.E8.m1.3.3.5.2.2.4.2.2.cmml" xref="S3.E8.m1.3.3.5.2.2.4.2.2">𝑁</ci><ci id="S3.E8.m1.3.3.5.2.2.4.2.3.cmml" xref="S3.E8.m1.3.3.5.2.2.4.2.3">𝑧</ci></apply><cn id="S3.E8.m1.3.3.5.2.2.4.3.cmml" type="integer" xref="S3.E8.m1.3.3.5.2.2.4.3">2</cn></apply></apply></apply><ci id="S3.E8.m1.3.3.5.3.cmml" xref="S3.E8.m1.3.3.5.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.4c">\mathbf{N}_{i}=\frac{\left(N_{x},N_{y},N_{z}\right)}{\sqrt{N_{x}^{2}+N_{y}^{2}%
+N_{z}^{2}}+\epsilon},</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.4d">bold_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = divide start_ARG ( italic_N start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT , italic_N start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT , italic_N start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ) end_ARG start_ARG square-root start_ARG italic_N start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_N start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_N start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG + italic_ϵ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p4.5">where <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p4.5.m1.1"><semantics id="S3.SS3.SSS2.p4.5.m1.1a"><mi id="S3.SS3.SSS2.p4.5.m1.1.1" xref="S3.SS3.SSS2.p4.5.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p4.5.m1.1b"><ci id="S3.SS3.SSS2.p4.5.m1.1.1.cmml" xref="S3.SS3.SSS2.p4.5.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p4.5.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p4.5.m1.1d">italic_ϵ</annotation></semantics></math> is a small constant added for numerical stability during normalisation.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p5">
<p class="ltx_p" id="S3.SS3.SSS2.p5.2">By leveraging these operations, the decoder efficiently reconstructs the target depth maps and surface normals, maintaining a balance between accuracy and computational efficiency. The outputs <math alttext="\mathbf{D}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.1.m1.1"><semantics id="S3.SS3.SSS2.p5.1.m1.1a"><mi id="S3.SS3.SSS2.p5.1.m1.1.1" xref="S3.SS3.SSS2.p5.1.m1.1.1.cmml">𝐃</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.1.m1.1b"><ci id="S3.SS3.SSS2.p5.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p5.1.m1.1.1">𝐃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.1.m1.1c">\mathbf{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.1.m1.1d">bold_D</annotation></semantics></math> and <math alttext="\mathbf{N}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p5.2.m2.1"><semantics id="S3.SS3.SSS2.p5.2.m2.1a"><mi id="S3.SS3.SSS2.p5.2.m2.1.1" xref="S3.SS3.SSS2.p5.2.m2.1.1.cmml">𝐍</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p5.2.m2.1b"><ci id="S3.SS3.SSS2.p5.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p5.2.m2.1.1">𝐍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p5.2.m2.1c">\mathbf{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p5.2.m2.1d">bold_N</annotation></semantics></math> at different scales are passed to the subsequent modules for further refinement or application.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="alg3">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg3.60">
<div class="ltx_listingline" id="alg3.3.3">
<span class="ltx_text" id="alg3.3.3.3" style="font-size:90%;">
<span class="ltx_text" id="alg3.3.3.3.1"><span class="ltx_text ltx_font_bold" id="alg3.3.3.3.1.1">Input:</span> </span>Encoder features <math alttext="F" class="ltx_Math" display="inline" id="alg3.1.1.1.m1.1"><semantics id="alg3.1.1.1.m1.1a"><mi id="alg3.1.1.1.m1.1.1" xref="alg3.1.1.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="alg3.1.1.1.m1.1b"><ci id="alg3.1.1.1.m1.1.1.cmml" xref="alg3.1.1.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.1.1.1.m1.1c">F</annotation><annotation encoding="application/x-llamapun" id="alg3.1.1.1.m1.1d">italic_F</annotation></semantics></math>, scales <math alttext="S" class="ltx_Math" display="inline" id="alg3.2.2.2.m2.1"><semantics id="alg3.2.2.2.m2.1a"><mi id="alg3.2.2.2.m2.1.1" xref="alg3.2.2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg3.2.2.2.m2.1b"><ci id="alg3.2.2.2.m2.1.1.cmml" xref="alg3.2.2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.2.2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg3.2.2.2.m2.1d">italic_S</annotation></semantics></math>, use_skips <math alttext="U" class="ltx_Math" display="inline" id="alg3.3.3.3.m3.1"><semantics id="alg3.3.3.3.m3.1a"><mi id="alg3.3.3.3.m3.1.1" xref="alg3.3.3.3.m3.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="alg3.3.3.3.m3.1b"><ci id="alg3.3.3.3.m3.1.1.cmml" xref="alg3.3.3.3.m3.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.3.3.3.m3.1c">U</annotation><annotation encoding="application/x-llamapun" id="alg3.3.3.3.m3.1d">italic_U</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="alg3.5.5">
<span class="ltx_text" id="alg3.5.5.1" style="font-size:90%;">
</span><span class="ltx_text" id="alg3.5.5.2" style="font-size:90%;"><span class="ltx_text ltx_font_bold" id="alg3.5.5.2.1">Output:</span> </span><span class="ltx_text" id="alg3.5.5.3" style="font-size:90%;">Depth maps </span><math alttext="D" class="ltx_Math" display="inline" id="alg3.4.4.m1.1"><semantics id="alg3.4.4.m1.1a"><mi id="alg3.4.4.m1.1.1" mathsize="90%" xref="alg3.4.4.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="alg3.4.4.m1.1b"><ci id="alg3.4.4.m1.1.1.cmml" xref="alg3.4.4.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.4.4.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="alg3.4.4.m1.1d">italic_D</annotation></semantics></math><span class="ltx_text" id="alg3.5.5.4" style="font-size:90%;">, Normal maps </span><math alttext="N" class="ltx_Math" display="inline" id="alg3.5.5.m2.1"><semantics id="alg3.5.5.m2.1a"><mi id="alg3.5.5.m2.1.1" mathsize="90%" xref="alg3.5.5.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg3.5.5.m2.1b"><ci id="alg3.5.5.m2.1.1.cmml" xref="alg3.5.5.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.5.5.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg3.5.5.m2.1d">italic_N</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.60.61">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.61.1.1.1" style="font-size:90%;">1</span></span><span class="ltx_text" id="alg3.60.61.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.8.8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.8.8.4.1.1" style="font-size:90%;">2</span></span><span class="ltx_text ltx_font_bold" id="alg3.8.8.5" style="font-size:90%;">Function</span><span class="ltx_text" id="alg3.8.8.6" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_typewriter" id="alg3.8.8.3" style="font-size:90%;">Forward(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.8.8.3.3.3"><math alttext="F" class="ltx_Math" display="inline" id="alg3.6.6.1.1.1.m1.1"><semantics id="alg3.6.6.1.1.1.m1.1a"><mi id="alg3.6.6.1.1.1.m1.1.1" xref="alg3.6.6.1.1.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="alg3.6.6.1.1.1.m1.1b"><ci id="alg3.6.6.1.1.1.m1.1.1.cmml" xref="alg3.6.6.1.1.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.6.6.1.1.1.m1.1c">F</annotation><annotation encoding="application/x-llamapun" id="alg3.6.6.1.1.1.m1.1d">italic_F</annotation></semantics></math>, <math alttext="S" class="ltx_Math" display="inline" id="alg3.7.7.2.2.2.m2.1"><semantics id="alg3.7.7.2.2.2.m2.1a"><mi id="alg3.7.7.2.2.2.m2.1.1" xref="alg3.7.7.2.2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg3.7.7.2.2.2.m2.1b"><ci id="alg3.7.7.2.2.2.m2.1.1.cmml" xref="alg3.7.7.2.2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.7.7.2.2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="alg3.7.7.2.2.2.m2.1d">italic_S</annotation></semantics></math>, <math alttext="U" class="ltx_Math" display="inline" id="alg3.8.8.3.3.3.m3.1"><semantics id="alg3.8.8.3.3.3.m3.1a"><mi id="alg3.8.8.3.3.3.m3.1.1" xref="alg3.8.8.3.3.3.m3.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="alg3.8.8.3.3.3.m3.1b"><ci id="alg3.8.8.3.3.3.m3.1.1.cmml" xref="alg3.8.8.3.3.3.m3.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.8.8.3.3.3.m3.1c">U</annotation><annotation encoding="application/x-llamapun" id="alg3.8.8.3.3.3.m3.1d">italic_U</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="alg3.8.8.7" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="alg3.9.9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.9.9.1.1.1" style="font-size:90%;">3</span></span><span class="ltx_text" id="alg3.9.9.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.9.9.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.9.9.4" style="font-size:90%;">
</span><math alttext="x\leftarrow F[-1]" class="ltx_Math" display="inline" id="alg3.9.9.m1.1"><semantics id="alg3.9.9.m1.1a"><mrow id="alg3.9.9.m1.1.1" xref="alg3.9.9.m1.1.1.cmml"><mi id="alg3.9.9.m1.1.1.3" mathsize="90%" xref="alg3.9.9.m1.1.1.3.cmml">x</mi><mo id="alg3.9.9.m1.1.1.2" mathsize="90%" stretchy="false" xref="alg3.9.9.m1.1.1.2.cmml">←</mo><mrow id="alg3.9.9.m1.1.1.1" xref="alg3.9.9.m1.1.1.1.cmml"><mi id="alg3.9.9.m1.1.1.1.3" mathsize="90%" xref="alg3.9.9.m1.1.1.1.3.cmml">F</mi><mo id="alg3.9.9.m1.1.1.1.2" xref="alg3.9.9.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg3.9.9.m1.1.1.1.1.1" xref="alg3.9.9.m1.1.1.1.1.2.cmml"><mo id="alg3.9.9.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg3.9.9.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg3.9.9.m1.1.1.1.1.1.1" xref="alg3.9.9.m1.1.1.1.1.1.1.cmml"><mo id="alg3.9.9.m1.1.1.1.1.1.1a" mathsize="90%" xref="alg3.9.9.m1.1.1.1.1.1.1.cmml">−</mo><mn id="alg3.9.9.m1.1.1.1.1.1.1.2" mathsize="90%" xref="alg3.9.9.m1.1.1.1.1.1.1.2.cmml">1</mn></mrow><mo id="alg3.9.9.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg3.9.9.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.9.9.m1.1b"><apply id="alg3.9.9.m1.1.1.cmml" xref="alg3.9.9.m1.1.1"><ci id="alg3.9.9.m1.1.1.2.cmml" xref="alg3.9.9.m1.1.1.2">←</ci><ci id="alg3.9.9.m1.1.1.3.cmml" xref="alg3.9.9.m1.1.1.3">𝑥</ci><apply id="alg3.9.9.m1.1.1.1.cmml" xref="alg3.9.9.m1.1.1.1"><times id="alg3.9.9.m1.1.1.1.2.cmml" xref="alg3.9.9.m1.1.1.1.2"></times><ci id="alg3.9.9.m1.1.1.1.3.cmml" xref="alg3.9.9.m1.1.1.1.3">𝐹</ci><apply id="alg3.9.9.m1.1.1.1.1.2.cmml" xref="alg3.9.9.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg3.9.9.m1.1.1.1.1.2.1.cmml" xref="alg3.9.9.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg3.9.9.m1.1.1.1.1.1.1.cmml" xref="alg3.9.9.m1.1.1.1.1.1.1"><minus id="alg3.9.9.m1.1.1.1.1.1.1.1.cmml" xref="alg3.9.9.m1.1.1.1.1.1.1"></minus><cn id="alg3.9.9.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg3.9.9.m1.1.1.1.1.1.1.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.9.9.m1.1c">x\leftarrow F[-1]</annotation><annotation encoding="application/x-llamapun" id="alg3.9.9.m1.1d">italic_x ← italic_F [ - 1 ]</annotation></semantics></math><span class="ltx_text" id="alg3.9.9.5" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg3.10.10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.10.10.1.1.1" style="font-size:90%;">4</span></span><span class="ltx_text" id="alg3.10.10.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.10.10.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.10.10.4" style="font-size:90%;">
outputs </span><math alttext="\leftarrow\{\}" class="ltx_Math" display="inline" id="alg3.10.10.m1.1"><semantics id="alg3.10.10.m1.1a"><mrow id="alg3.10.10.m1.1.1" xref="alg3.10.10.m1.1.1.cmml"><mi id="alg3.10.10.m1.1.1.2" xref="alg3.10.10.m1.1.1.2.cmml"></mi><mo id="alg3.10.10.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg3.10.10.m1.1.1.1.cmml">←</mo><mrow id="alg3.10.10.m1.1.1.3.2" xref="alg3.10.10.m1.1.1.cmml"><mo id="alg3.10.10.m1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="alg3.10.10.m1.1.1.3.1.cmml">{</mo><mo id="alg3.10.10.m1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="alg3.10.10.m1.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.10.10.m1.1b"><apply id="alg3.10.10.m1.1.1.cmml" xref="alg3.10.10.m1.1.1"><ci id="alg3.10.10.m1.1.1.1.cmml" xref="alg3.10.10.m1.1.1.1">←</ci><csymbol cd="latexml" id="alg3.10.10.m1.1.1.2.cmml" xref="alg3.10.10.m1.1.1.2">absent</csymbol><list id="alg3.10.10.m1.1.1.3.1.cmml" xref="alg3.10.10.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.10.10.m1.1c">\leftarrow\{\}</annotation><annotation encoding="application/x-llamapun" id="alg3.10.10.m1.1d">← { }</annotation></semantics></math><span class="ltx_text" id="alg3.10.10.5" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg3.13.13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.13.13.4.1.1" style="font-size:90%;">5</span></span><span class="ltx_text" id="alg3.13.13.5" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.13.13.6" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.13.13.7" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg3.13.13.8" style="font-size:90%;">for</span><span class="ltx_text" id="alg3.13.13.9" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg3.13.13.3" style="font-size:90%;"><math alttext="i\leftarrow 2" class="ltx_Math" display="inline" id="alg3.11.11.1.m1.1"><semantics id="alg3.11.11.1.m1.1a"><mrow id="alg3.11.11.1.m1.1.1" xref="alg3.11.11.1.m1.1.1.cmml"><mi id="alg3.11.11.1.m1.1.1.2" xref="alg3.11.11.1.m1.1.1.2.cmml">i</mi><mo id="alg3.11.11.1.m1.1.1.1" stretchy="false" xref="alg3.11.11.1.m1.1.1.1.cmml">←</mo><mn id="alg3.11.11.1.m1.1.1.3" xref="alg3.11.11.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.11.11.1.m1.1b"><apply id="alg3.11.11.1.m1.1.1.cmml" xref="alg3.11.11.1.m1.1.1"><ci id="alg3.11.11.1.m1.1.1.1.cmml" xref="alg3.11.11.1.m1.1.1.1">←</ci><ci id="alg3.11.11.1.m1.1.1.2.cmml" xref="alg3.11.11.1.m1.1.1.2">𝑖</ci><cn id="alg3.11.11.1.m1.1.1.3.cmml" type="integer" xref="alg3.11.11.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.11.11.1.m1.1c">i\leftarrow 2</annotation><annotation encoding="application/x-llamapun" id="alg3.11.11.1.m1.1d">italic_i ← 2</annotation></semantics></math> <span class="ltx_text ltx_font_bold ltx_font_upright" id="alg3.13.13.3.1">to</span> <math alttext="0" class="ltx_Math" display="inline" id="alg3.12.12.2.m2.1"><semantics id="alg3.12.12.2.m2.1a"><mn id="alg3.12.12.2.m2.1.1" xref="alg3.12.12.2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="alg3.12.12.2.m2.1b"><cn id="alg3.12.12.2.m2.1.1.cmml" type="integer" xref="alg3.12.12.2.m2.1.1">0</cn></annotation-xml></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.13.13.3.2">step</span> <math alttext="-1" class="ltx_Math" display="inline" id="alg3.13.13.3.m3.1"><semantics id="alg3.13.13.3.m3.1a"><mrow id="alg3.13.13.3.m3.1.1" xref="alg3.13.13.3.m3.1.1.cmml"><mo id="alg3.13.13.3.m3.1.1a" xref="alg3.13.13.3.m3.1.1.cmml">−</mo><mn id="alg3.13.13.3.m3.1.1.2" xref="alg3.13.13.3.m3.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.13.13.3.m3.1b"><apply id="alg3.13.13.3.m3.1.1.cmml" xref="alg3.13.13.3.m3.1.1"><minus id="alg3.13.13.3.m3.1.1.1.cmml" xref="alg3.13.13.3.m3.1.1"></minus><cn id="alg3.13.13.3.m3.1.1.2.cmml" type="integer" xref="alg3.13.13.3.m3.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.13.13.3.m3.1c">-1</annotation><annotation encoding="application/x-llamapun" id="alg3.13.13.3.m3.1d">- 1</annotation></semantics></math></em><span class="ltx_text" id="alg3.13.13.10" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg3.13.13.11" style="font-size:90%;">do</span>
</div>
<div class="ltx_listingline" id="alg3.16.16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.16.16.3.1.1" style="font-size:90%;">6</span></span><span class="ltx_text" id="alg3.16.16.4" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.16.16.5" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.16.16.6" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.16.16.7" style="font-size:90%;">
</span><math alttext="x\leftarrow" class="ltx_Math" display="inline" id="alg3.14.14.m1.1"><semantics id="alg3.14.14.m1.1a"><mrow id="alg3.14.14.m1.1.1" xref="alg3.14.14.m1.1.1.cmml"><mi id="alg3.14.14.m1.1.1.2" mathsize="90%" xref="alg3.14.14.m1.1.1.2.cmml">x</mi><mo id="alg3.14.14.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg3.14.14.m1.1.1.1.cmml">←</mo><mi id="alg3.14.14.m1.1.1.3" xref="alg3.14.14.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.14.14.m1.1b"><apply id="alg3.14.14.m1.1.1.cmml" xref="alg3.14.14.m1.1.1"><ci id="alg3.14.14.m1.1.1.1.cmml" xref="alg3.14.14.m1.1.1.1">←</ci><ci id="alg3.14.14.m1.1.1.2.cmml" xref="alg3.14.14.m1.1.1.2">𝑥</ci><csymbol cd="latexml" id="alg3.14.14.m1.1.1.3.cmml" xref="alg3.14.14.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.14.14.m1.1c">x\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg3.14.14.m1.1d">italic_x ←</annotation></semantics></math><span class="ltx_text" id="alg3.16.16.8" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="alg3.16.16.2" style="font-size:90%;">Upconv(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.16.16.2.2"><math alttext="x" class="ltx_Math" display="inline" id="alg3.15.15.1.1.m1.1"><semantics id="alg3.15.15.1.1.m1.1a"><mi id="alg3.15.15.1.1.m1.1.1" xref="alg3.15.15.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg3.15.15.1.1.m1.1b"><ci id="alg3.15.15.1.1.m1.1.1.cmml" xref="alg3.15.15.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.15.15.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg3.15.15.1.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="i" class="ltx_Math" display="inline" id="alg3.16.16.2.2.m2.1"><semantics id="alg3.16.16.2.2.m2.1a"><mi id="alg3.16.16.2.2.m2.1.1" xref="alg3.16.16.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.16.16.2.2.m2.1b"><ci id="alg3.16.16.2.2.m2.1.1.cmml" xref="alg3.16.16.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.16.16.2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg3.16.16.2.2.m2.1d">italic_i</annotation></semantics></math></em>)</span><span class="ltx_text" id="alg3.16.16.9" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg3.18.18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.18.18.3.1.1" style="font-size:90%;">7</span></span><span class="ltx_text" id="alg3.18.18.4" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.18.18.5" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.18.18.6" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.18.18.7" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg3.18.18.8" style="font-size:90%;">if</span><span class="ltx_text" id="alg3.18.18.9" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg3.18.18.2" style="font-size:90%;"><math alttext="U" class="ltx_Math" display="inline" id="alg3.17.17.1.m1.1"><semantics id="alg3.17.17.1.m1.1a"><mi id="alg3.17.17.1.m1.1.1" xref="alg3.17.17.1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="alg3.17.17.1.m1.1b"><ci id="alg3.17.17.1.m1.1.1.cmml" xref="alg3.17.17.1.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.17.17.1.m1.1c">U</annotation><annotation encoding="application/x-llamapun" id="alg3.17.17.1.m1.1d">italic_U</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.18.18.2.1">and</span> <math alttext="i&gt;0" class="ltx_Math" display="inline" id="alg3.18.18.2.m2.1"><semantics id="alg3.18.18.2.m2.1a"><mrow id="alg3.18.18.2.m2.1.1" xref="alg3.18.18.2.m2.1.1.cmml"><mi id="alg3.18.18.2.m2.1.1.2" xref="alg3.18.18.2.m2.1.1.2.cmml">i</mi><mo id="alg3.18.18.2.m2.1.1.1" xref="alg3.18.18.2.m2.1.1.1.cmml">&gt;</mo><mn id="alg3.18.18.2.m2.1.1.3" xref="alg3.18.18.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.18.18.2.m2.1b"><apply id="alg3.18.18.2.m2.1.1.cmml" xref="alg3.18.18.2.m2.1.1"><gt id="alg3.18.18.2.m2.1.1.1.cmml" xref="alg3.18.18.2.m2.1.1.1"></gt><ci id="alg3.18.18.2.m2.1.1.2.cmml" xref="alg3.18.18.2.m2.1.1.2">𝑖</ci><cn id="alg3.18.18.2.m2.1.1.3.cmml" type="integer" xref="alg3.18.18.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.18.18.2.m2.1c">i&gt;0</annotation><annotation encoding="application/x-llamapun" id="alg3.18.18.2.m2.1d">italic_i &gt; 0</annotation></semantics></math></em><span class="ltx_text" id="alg3.18.18.10" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg3.18.18.11" style="font-size:90%;">then</span>
</div>
<div class="ltx_listingline" id="alg3.21.21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.21.21.1.1.1" style="font-size:90%;">8</span></span><span class="ltx_text" id="alg3.21.21.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.21.21.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.21.21.4" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.21.21.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.21.21.6" style="font-size:90%;">
</span><math alttext="x\leftarrow" class="ltx_Math" display="inline" id="alg3.19.19.m1.1"><semantics id="alg3.19.19.m1.1a"><mrow id="alg3.19.19.m1.1.1" xref="alg3.19.19.m1.1.1.cmml"><mi id="alg3.19.19.m1.1.1.2" mathsize="90%" xref="alg3.19.19.m1.1.1.2.cmml">x</mi><mo id="alg3.19.19.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg3.19.19.m1.1.1.1.cmml">←</mo><mi id="alg3.19.19.m1.1.1.3" xref="alg3.19.19.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.19.19.m1.1b"><apply id="alg3.19.19.m1.1.1.cmml" xref="alg3.19.19.m1.1.1"><ci id="alg3.19.19.m1.1.1.1.cmml" xref="alg3.19.19.m1.1.1.1">←</ci><ci id="alg3.19.19.m1.1.1.2.cmml" xref="alg3.19.19.m1.1.1.2">𝑥</ci><csymbol cd="latexml" id="alg3.19.19.m1.1.1.3.cmml" xref="alg3.19.19.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.19.19.m1.1c">x\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg3.19.19.m1.1d">italic_x ←</annotation></semantics></math><span class="ltx_text" id="alg3.21.21.7" style="font-size:90%;"> Concatenate(</span><math alttext="x" class="ltx_Math" display="inline" id="alg3.20.20.m2.1"><semantics id="alg3.20.20.m2.1a"><mi id="alg3.20.20.m2.1.1" mathsize="90%" xref="alg3.20.20.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg3.20.20.m2.1b"><ci id="alg3.20.20.m2.1.1.cmml" xref="alg3.20.20.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.20.20.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg3.20.20.m2.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg3.21.21.8" style="font-size:90%;">, </span><math alttext="F[i-1]" class="ltx_Math" display="inline" id="alg3.21.21.m3.1"><semantics id="alg3.21.21.m3.1a"><mrow id="alg3.21.21.m3.1.1" xref="alg3.21.21.m3.1.1.cmml"><mi id="alg3.21.21.m3.1.1.3" mathsize="90%" xref="alg3.21.21.m3.1.1.3.cmml">F</mi><mo id="alg3.21.21.m3.1.1.2" xref="alg3.21.21.m3.1.1.2.cmml">⁢</mo><mrow id="alg3.21.21.m3.1.1.1.1" xref="alg3.21.21.m3.1.1.1.2.cmml"><mo id="alg3.21.21.m3.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg3.21.21.m3.1.1.1.2.1.cmml">[</mo><mrow id="alg3.21.21.m3.1.1.1.1.1" xref="alg3.21.21.m3.1.1.1.1.1.cmml"><mi id="alg3.21.21.m3.1.1.1.1.1.2" mathsize="90%" xref="alg3.21.21.m3.1.1.1.1.1.2.cmml">i</mi><mo id="alg3.21.21.m3.1.1.1.1.1.1" mathsize="90%" xref="alg3.21.21.m3.1.1.1.1.1.1.cmml">−</mo><mn id="alg3.21.21.m3.1.1.1.1.1.3" mathsize="90%" xref="alg3.21.21.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg3.21.21.m3.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg3.21.21.m3.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.21.21.m3.1b"><apply id="alg3.21.21.m3.1.1.cmml" xref="alg3.21.21.m3.1.1"><times id="alg3.21.21.m3.1.1.2.cmml" xref="alg3.21.21.m3.1.1.2"></times><ci id="alg3.21.21.m3.1.1.3.cmml" xref="alg3.21.21.m3.1.1.3">𝐹</ci><apply id="alg3.21.21.m3.1.1.1.2.cmml" xref="alg3.21.21.m3.1.1.1.1"><csymbol cd="latexml" id="alg3.21.21.m3.1.1.1.2.1.cmml" xref="alg3.21.21.m3.1.1.1.1.2">delimited-[]</csymbol><apply id="alg3.21.21.m3.1.1.1.1.1.cmml" xref="alg3.21.21.m3.1.1.1.1.1"><minus id="alg3.21.21.m3.1.1.1.1.1.1.cmml" xref="alg3.21.21.m3.1.1.1.1.1.1"></minus><ci id="alg3.21.21.m3.1.1.1.1.1.2.cmml" xref="alg3.21.21.m3.1.1.1.1.1.2">𝑖</ci><cn id="alg3.21.21.m3.1.1.1.1.1.3.cmml" type="integer" xref="alg3.21.21.m3.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.21.21.m3.1c">F[i-1]</annotation><annotation encoding="application/x-llamapun" id="alg3.21.21.m3.1d">italic_F [ italic_i - 1 ]</annotation></semantics></math><span class="ltx_text" id="alg3.21.21.9" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg3.60.62">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.62.1.1.1" style="font-size:90%;">9</span></span><span class="ltx_text" id="alg3.60.62.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.62.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.62.4" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.62.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.60.62.6" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.24.24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.24.24.3.1.1" style="font-size:90%;">10</span></span><span class="ltx_text" id="alg3.24.24.4" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.24.24.5" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.24.24.6" style="font-size:90%;">   </span><math alttext="x\leftarrow" class="ltx_Math" display="inline" id="alg3.22.22.m1.1"><semantics id="alg3.22.22.m1.1a"><mrow id="alg3.22.22.m1.1.1" xref="alg3.22.22.m1.1.1.cmml"><mi id="alg3.22.22.m1.1.1.2" mathsize="90%" xref="alg3.22.22.m1.1.1.2.cmml">x</mi><mo id="alg3.22.22.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg3.22.22.m1.1.1.1.cmml">←</mo><mi id="alg3.22.22.m1.1.1.3" xref="alg3.22.22.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.22.22.m1.1b"><apply id="alg3.22.22.m1.1.1.cmml" xref="alg3.22.22.m1.1.1"><ci id="alg3.22.22.m1.1.1.1.cmml" xref="alg3.22.22.m1.1.1.1">←</ci><ci id="alg3.22.22.m1.1.1.2.cmml" xref="alg3.22.22.m1.1.1.2">𝑥</ci><csymbol cd="latexml" id="alg3.22.22.m1.1.1.3.cmml" xref="alg3.22.22.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.22.22.m1.1c">x\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg3.22.22.m1.1d">italic_x ←</annotation></semantics></math><span class="ltx_text" id="alg3.24.24.7" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="alg3.24.24.2" style="font-size:90%;">Upconv(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.24.24.2.2"><math alttext="x" class="ltx_Math" display="inline" id="alg3.23.23.1.1.m1.1"><semantics id="alg3.23.23.1.1.m1.1a"><mi id="alg3.23.23.1.1.m1.1.1" xref="alg3.23.23.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg3.23.23.1.1.m1.1b"><ci id="alg3.23.23.1.1.m1.1.1.cmml" xref="alg3.23.23.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.23.23.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg3.23.23.1.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="i" class="ltx_Math" display="inline" id="alg3.24.24.2.2.m2.1"><semantics id="alg3.24.24.2.2.m2.1a"><mi id="alg3.24.24.2.2.m2.1.1" xref="alg3.24.24.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.24.24.2.2.m2.1b"><ci id="alg3.24.24.2.2.m2.1.1.cmml" xref="alg3.24.24.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.24.24.2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg3.24.24.2.2.m2.1d">italic_i</annotation></semantics></math></em>)</span><span class="ltx_text" id="alg3.24.24.8" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg3.25.25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.25.25.2.1.1" style="font-size:90%;">11</span></span><span class="ltx_text" id="alg3.25.25.3" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.25.25.4" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.25.25.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.25.25.6" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg3.25.25.7" style="font-size:90%;">if</span><span class="ltx_text" id="alg3.25.25.8" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg3.25.25.1" style="font-size:90%;"><math alttext="i\in S" class="ltx_Math" display="inline" id="alg3.25.25.1.m1.1"><semantics id="alg3.25.25.1.m1.1a"><mrow id="alg3.25.25.1.m1.1.1" xref="alg3.25.25.1.m1.1.1.cmml"><mi id="alg3.25.25.1.m1.1.1.2" xref="alg3.25.25.1.m1.1.1.2.cmml">i</mi><mo id="alg3.25.25.1.m1.1.1.1" xref="alg3.25.25.1.m1.1.1.1.cmml">∈</mo><mi id="alg3.25.25.1.m1.1.1.3" xref="alg3.25.25.1.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.25.25.1.m1.1b"><apply id="alg3.25.25.1.m1.1.1.cmml" xref="alg3.25.25.1.m1.1.1"><in id="alg3.25.25.1.m1.1.1.1.cmml" xref="alg3.25.25.1.m1.1.1.1"></in><ci id="alg3.25.25.1.m1.1.1.2.cmml" xref="alg3.25.25.1.m1.1.1.2">𝑖</ci><ci id="alg3.25.25.1.m1.1.1.3.cmml" xref="alg3.25.25.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.25.25.1.m1.1c">i\in S</annotation><annotation encoding="application/x-llamapun" id="alg3.25.25.1.m1.1d">italic_i ∈ italic_S</annotation></semantics></math></em><span class="ltx_text" id="alg3.25.25.9" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg3.25.25.10" style="font-size:90%;">then</span>
</div>
<div class="ltx_listingline" id="alg3.28.28">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.28.28.3.1.1" style="font-size:90%;">12</span></span><span class="ltx_text" id="alg3.28.28.4" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.28.28.5" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.28.28.6" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.28.28.7" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.28.28.8" style="font-size:90%;">
</span><math alttext="disp\leftarrow" class="ltx_Math" display="inline" id="alg3.26.26.m1.1"><semantics id="alg3.26.26.m1.1a"><mrow id="alg3.26.26.m1.1.1" xref="alg3.26.26.m1.1.1.cmml"><mrow id="alg3.26.26.m1.1.1.2" xref="alg3.26.26.m1.1.1.2.cmml"><mi id="alg3.26.26.m1.1.1.2.2" mathsize="90%" xref="alg3.26.26.m1.1.1.2.2.cmml">d</mi><mo id="alg3.26.26.m1.1.1.2.1" xref="alg3.26.26.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.26.26.m1.1.1.2.3" mathsize="90%" xref="alg3.26.26.m1.1.1.2.3.cmml">i</mi><mo id="alg3.26.26.m1.1.1.2.1a" xref="alg3.26.26.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.26.26.m1.1.1.2.4" mathsize="90%" xref="alg3.26.26.m1.1.1.2.4.cmml">s</mi><mo id="alg3.26.26.m1.1.1.2.1b" xref="alg3.26.26.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.26.26.m1.1.1.2.5" mathsize="90%" xref="alg3.26.26.m1.1.1.2.5.cmml">p</mi></mrow><mo id="alg3.26.26.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg3.26.26.m1.1.1.1.cmml">←</mo><mi id="alg3.26.26.m1.1.1.3" xref="alg3.26.26.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.26.26.m1.1b"><apply id="alg3.26.26.m1.1.1.cmml" xref="alg3.26.26.m1.1.1"><ci id="alg3.26.26.m1.1.1.1.cmml" xref="alg3.26.26.m1.1.1.1">←</ci><apply id="alg3.26.26.m1.1.1.2.cmml" xref="alg3.26.26.m1.1.1.2"><times id="alg3.26.26.m1.1.1.2.1.cmml" xref="alg3.26.26.m1.1.1.2.1"></times><ci id="alg3.26.26.m1.1.1.2.2.cmml" xref="alg3.26.26.m1.1.1.2.2">𝑑</ci><ci id="alg3.26.26.m1.1.1.2.3.cmml" xref="alg3.26.26.m1.1.1.2.3">𝑖</ci><ci id="alg3.26.26.m1.1.1.2.4.cmml" xref="alg3.26.26.m1.1.1.2.4">𝑠</ci><ci id="alg3.26.26.m1.1.1.2.5.cmml" xref="alg3.26.26.m1.1.1.2.5">𝑝</ci></apply><csymbol cd="latexml" id="alg3.26.26.m1.1.1.3.cmml" xref="alg3.26.26.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.26.26.m1.1c">disp\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg3.26.26.m1.1d">italic_d italic_i italic_s italic_p ←</annotation></semantics></math><span class="ltx_text" id="alg3.28.28.9" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="alg3.28.28.2" style="font-size:90%;">Dispconv(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.28.28.2.2"><math alttext="x" class="ltx_Math" display="inline" id="alg3.27.27.1.1.m1.1"><semantics id="alg3.27.27.1.1.m1.1a"><mi id="alg3.27.27.1.1.m1.1.1" xref="alg3.27.27.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg3.27.27.1.1.m1.1b"><ci id="alg3.27.27.1.1.m1.1.1.cmml" xref="alg3.27.27.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.27.27.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg3.27.27.1.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="i" class="ltx_Math" display="inline" id="alg3.28.28.2.2.m2.1"><semantics id="alg3.28.28.2.2.m2.1a"><mi id="alg3.28.28.2.2.m2.1.1" xref="alg3.28.28.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.28.28.2.2.m2.1b"><ci id="alg3.28.28.2.2.m2.1.1.cmml" xref="alg3.28.28.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.28.28.2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg3.28.28.2.2.m2.1d">italic_i</annotation></semantics></math></em>)</span><span class="ltx_text" id="alg3.28.28.10" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg3.31.31">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.31.31.3.1.1" style="font-size:90%;">13</span></span><span class="ltx_text" id="alg3.31.31.4" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.31.31.5" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.31.31.6" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.31.31.7" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.31.31.8" style="font-size:90%;">
</span><math alttext="normal\leftarrow" class="ltx_Math" display="inline" id="alg3.29.29.m1.1"><semantics id="alg3.29.29.m1.1a"><mrow id="alg3.29.29.m1.1.1" xref="alg3.29.29.m1.1.1.cmml"><mrow id="alg3.29.29.m1.1.1.2" xref="alg3.29.29.m1.1.1.2.cmml"><mi id="alg3.29.29.m1.1.1.2.2" mathsize="90%" xref="alg3.29.29.m1.1.1.2.2.cmml">n</mi><mo id="alg3.29.29.m1.1.1.2.1" xref="alg3.29.29.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.29.29.m1.1.1.2.3" mathsize="90%" xref="alg3.29.29.m1.1.1.2.3.cmml">o</mi><mo id="alg3.29.29.m1.1.1.2.1a" xref="alg3.29.29.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.29.29.m1.1.1.2.4" mathsize="90%" xref="alg3.29.29.m1.1.1.2.4.cmml">r</mi><mo id="alg3.29.29.m1.1.1.2.1b" xref="alg3.29.29.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.29.29.m1.1.1.2.5" mathsize="90%" xref="alg3.29.29.m1.1.1.2.5.cmml">m</mi><mo id="alg3.29.29.m1.1.1.2.1c" xref="alg3.29.29.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.29.29.m1.1.1.2.6" mathsize="90%" xref="alg3.29.29.m1.1.1.2.6.cmml">a</mi><mo id="alg3.29.29.m1.1.1.2.1d" xref="alg3.29.29.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.29.29.m1.1.1.2.7" mathsize="90%" xref="alg3.29.29.m1.1.1.2.7.cmml">l</mi></mrow><mo id="alg3.29.29.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg3.29.29.m1.1.1.1.cmml">←</mo><mi id="alg3.29.29.m1.1.1.3" xref="alg3.29.29.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.29.29.m1.1b"><apply id="alg3.29.29.m1.1.1.cmml" xref="alg3.29.29.m1.1.1"><ci id="alg3.29.29.m1.1.1.1.cmml" xref="alg3.29.29.m1.1.1.1">←</ci><apply id="alg3.29.29.m1.1.1.2.cmml" xref="alg3.29.29.m1.1.1.2"><times id="alg3.29.29.m1.1.1.2.1.cmml" xref="alg3.29.29.m1.1.1.2.1"></times><ci id="alg3.29.29.m1.1.1.2.2.cmml" xref="alg3.29.29.m1.1.1.2.2">𝑛</ci><ci id="alg3.29.29.m1.1.1.2.3.cmml" xref="alg3.29.29.m1.1.1.2.3">𝑜</ci><ci id="alg3.29.29.m1.1.1.2.4.cmml" xref="alg3.29.29.m1.1.1.2.4">𝑟</ci><ci id="alg3.29.29.m1.1.1.2.5.cmml" xref="alg3.29.29.m1.1.1.2.5">𝑚</ci><ci id="alg3.29.29.m1.1.1.2.6.cmml" xref="alg3.29.29.m1.1.1.2.6">𝑎</ci><ci id="alg3.29.29.m1.1.1.2.7.cmml" xref="alg3.29.29.m1.1.1.2.7">𝑙</ci></apply><csymbol cd="latexml" id="alg3.29.29.m1.1.1.3.cmml" xref="alg3.29.29.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.29.29.m1.1c">normal\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg3.29.29.m1.1d">italic_n italic_o italic_r italic_m italic_a italic_l ←</annotation></semantics></math><span class="ltx_text" id="alg3.31.31.9" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="alg3.31.31.2" style="font-size:90%;">Normconv(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.31.31.2.2"><math alttext="x" class="ltx_Math" display="inline" id="alg3.30.30.1.1.m1.1"><semantics id="alg3.30.30.1.1.m1.1a"><mi id="alg3.30.30.1.1.m1.1.1" xref="alg3.30.30.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg3.30.30.1.1.m1.1b"><ci id="alg3.30.30.1.1.m1.1.1.cmml" xref="alg3.30.30.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.30.30.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg3.30.30.1.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="i" class="ltx_Math" display="inline" id="alg3.31.31.2.2.m2.1"><semantics id="alg3.31.31.2.2.m2.1a"><mi id="alg3.31.31.2.2.m2.1.1" xref="alg3.31.31.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.31.31.2.2.m2.1b"><ci id="alg3.31.31.2.2.m2.1.1.cmml" xref="alg3.31.31.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.31.31.2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg3.31.31.2.2.m2.1d">italic_i</annotation></semantics></math></em>)</span><span class="ltx_text" id="alg3.31.31.10" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg3.33.33">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.33.33.1.1.1" style="font-size:90%;">14</span></span><span class="ltx_text" id="alg3.33.33.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.33.33.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.33.33.4" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.33.33.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.33.33.6" style="font-size:90%;">
outputs[</span><math alttext="i" class="ltx_Math" display="inline" id="alg3.32.32.m1.1"><semantics id="alg3.32.32.m1.1a"><mi id="alg3.32.32.m1.1.1" mathsize="90%" xref="alg3.32.32.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.32.32.m1.1b"><ci id="alg3.32.32.m1.1.1.cmml" xref="alg3.32.32.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.32.32.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg3.32.32.m1.1d">italic_i</annotation></semantics></math><span class="ltx_text" id="alg3.33.33.7" style="font-size:90%;">] </span><math alttext="\leftarrow\{disp,normal\}" class="ltx_Math" display="inline" id="alg3.33.33.m2.2"><semantics id="alg3.33.33.m2.2a"><mrow id="alg3.33.33.m2.2.2" xref="alg3.33.33.m2.2.2.cmml"><mi id="alg3.33.33.m2.2.2.4" xref="alg3.33.33.m2.2.2.4.cmml"></mi><mo id="alg3.33.33.m2.2.2.3" mathsize="90%" stretchy="false" xref="alg3.33.33.m2.2.2.3.cmml">←</mo><mrow id="alg3.33.33.m2.2.2.2.2" xref="alg3.33.33.m2.2.2.2.3.cmml"><mo id="alg3.33.33.m2.2.2.2.2.3" maxsize="90%" minsize="90%" xref="alg3.33.33.m2.2.2.2.3.cmml">{</mo><mrow id="alg3.33.33.m2.1.1.1.1.1" xref="alg3.33.33.m2.1.1.1.1.1.cmml"><mi id="alg3.33.33.m2.1.1.1.1.1.2" mathsize="90%" xref="alg3.33.33.m2.1.1.1.1.1.2.cmml">d</mi><mo id="alg3.33.33.m2.1.1.1.1.1.1" xref="alg3.33.33.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg3.33.33.m2.1.1.1.1.1.3" mathsize="90%" xref="alg3.33.33.m2.1.1.1.1.1.3.cmml">i</mi><mo id="alg3.33.33.m2.1.1.1.1.1.1a" xref="alg3.33.33.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg3.33.33.m2.1.1.1.1.1.4" mathsize="90%" xref="alg3.33.33.m2.1.1.1.1.1.4.cmml">s</mi><mo id="alg3.33.33.m2.1.1.1.1.1.1b" xref="alg3.33.33.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg3.33.33.m2.1.1.1.1.1.5" mathsize="90%" xref="alg3.33.33.m2.1.1.1.1.1.5.cmml">p</mi></mrow><mo id="alg3.33.33.m2.2.2.2.2.4" mathsize="90%" xref="alg3.33.33.m2.2.2.2.3.cmml">,</mo><mrow id="alg3.33.33.m2.2.2.2.2.2" xref="alg3.33.33.m2.2.2.2.2.2.cmml"><mi id="alg3.33.33.m2.2.2.2.2.2.2" mathsize="90%" xref="alg3.33.33.m2.2.2.2.2.2.2.cmml">n</mi><mo id="alg3.33.33.m2.2.2.2.2.2.1" xref="alg3.33.33.m2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg3.33.33.m2.2.2.2.2.2.3" mathsize="90%" xref="alg3.33.33.m2.2.2.2.2.2.3.cmml">o</mi><mo id="alg3.33.33.m2.2.2.2.2.2.1a" xref="alg3.33.33.m2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg3.33.33.m2.2.2.2.2.2.4" mathsize="90%" xref="alg3.33.33.m2.2.2.2.2.2.4.cmml">r</mi><mo id="alg3.33.33.m2.2.2.2.2.2.1b" xref="alg3.33.33.m2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg3.33.33.m2.2.2.2.2.2.5" mathsize="90%" xref="alg3.33.33.m2.2.2.2.2.2.5.cmml">m</mi><mo id="alg3.33.33.m2.2.2.2.2.2.1c" xref="alg3.33.33.m2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg3.33.33.m2.2.2.2.2.2.6" mathsize="90%" xref="alg3.33.33.m2.2.2.2.2.2.6.cmml">a</mi><mo id="alg3.33.33.m2.2.2.2.2.2.1d" xref="alg3.33.33.m2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg3.33.33.m2.2.2.2.2.2.7" mathsize="90%" xref="alg3.33.33.m2.2.2.2.2.2.7.cmml">l</mi></mrow><mo id="alg3.33.33.m2.2.2.2.2.5" maxsize="90%" minsize="90%" xref="alg3.33.33.m2.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.33.33.m2.2b"><apply id="alg3.33.33.m2.2.2.cmml" xref="alg3.33.33.m2.2.2"><ci id="alg3.33.33.m2.2.2.3.cmml" xref="alg3.33.33.m2.2.2.3">←</ci><csymbol cd="latexml" id="alg3.33.33.m2.2.2.4.cmml" xref="alg3.33.33.m2.2.2.4">absent</csymbol><set id="alg3.33.33.m2.2.2.2.3.cmml" xref="alg3.33.33.m2.2.2.2.2"><apply id="alg3.33.33.m2.1.1.1.1.1.cmml" xref="alg3.33.33.m2.1.1.1.1.1"><times id="alg3.33.33.m2.1.1.1.1.1.1.cmml" xref="alg3.33.33.m2.1.1.1.1.1.1"></times><ci id="alg3.33.33.m2.1.1.1.1.1.2.cmml" xref="alg3.33.33.m2.1.1.1.1.1.2">𝑑</ci><ci id="alg3.33.33.m2.1.1.1.1.1.3.cmml" xref="alg3.33.33.m2.1.1.1.1.1.3">𝑖</ci><ci id="alg3.33.33.m2.1.1.1.1.1.4.cmml" xref="alg3.33.33.m2.1.1.1.1.1.4">𝑠</ci><ci id="alg3.33.33.m2.1.1.1.1.1.5.cmml" xref="alg3.33.33.m2.1.1.1.1.1.5">𝑝</ci></apply><apply id="alg3.33.33.m2.2.2.2.2.2.cmml" xref="alg3.33.33.m2.2.2.2.2.2"><times id="alg3.33.33.m2.2.2.2.2.2.1.cmml" xref="alg3.33.33.m2.2.2.2.2.2.1"></times><ci id="alg3.33.33.m2.2.2.2.2.2.2.cmml" xref="alg3.33.33.m2.2.2.2.2.2.2">𝑛</ci><ci id="alg3.33.33.m2.2.2.2.2.2.3.cmml" xref="alg3.33.33.m2.2.2.2.2.2.3">𝑜</ci><ci id="alg3.33.33.m2.2.2.2.2.2.4.cmml" xref="alg3.33.33.m2.2.2.2.2.2.4">𝑟</ci><ci id="alg3.33.33.m2.2.2.2.2.2.5.cmml" xref="alg3.33.33.m2.2.2.2.2.2.5">𝑚</ci><ci id="alg3.33.33.m2.2.2.2.2.2.6.cmml" xref="alg3.33.33.m2.2.2.2.2.2.6">𝑎</ci><ci id="alg3.33.33.m2.2.2.2.2.2.7.cmml" xref="alg3.33.33.m2.2.2.2.2.2.7">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.33.33.m2.2c">\leftarrow\{disp,normal\}</annotation><annotation encoding="application/x-llamapun" id="alg3.33.33.m2.2d">← { italic_d italic_i italic_s italic_p , italic_n italic_o italic_r italic_m italic_a italic_l }</annotation></semantics></math><span class="ltx_text" id="alg3.33.33.8" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg3.60.63">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.63.1.1.1" style="font-size:90%;">15</span></span><span class="ltx_text" id="alg3.60.63.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.63.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.63.4" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.63.5" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.60.63.6" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.60.64">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.64.1.1.1" style="font-size:90%;">16</span></span><span class="ltx_text" id="alg3.60.64.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.64.3" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.64.4" style="font-size:90%;">   </span>
</div>
<div class="ltx_listingline" id="alg3.60.65">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.65.1.1.1" style="font-size:90%;">17</span></span><span class="ltx_text" id="alg3.60.65.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.65.3" style="font-size:90%;">   </span><span class="ltx_text ltx_font_bold" id="alg3.60.65.4" style="font-size:90%;">return</span><span class="ltx_text" id="alg3.60.65.5" style="font-size:90%;"> outputs;</span>
</div>
<div class="ltx_listingline" id="alg3.60.66">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.66.1.1.1" style="font-size:90%;">18</span></span><span class="ltx_text" id="alg3.60.66.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.66.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.60.66.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.60.67">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.67.1.1.1" style="font-size:90%;">19</span></span>
</div>
<div class="ltx_listingline" id="alg3.35.35">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.35.35.3.1.1" style="font-size:90%;">20</span></span><span class="ltx_text ltx_font_bold" id="alg3.35.35.4" style="font-size:90%;">Function</span><span class="ltx_text" id="alg3.35.35.5" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_typewriter" id="alg3.35.35.2" style="font-size:90%;">Upconv(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.35.35.2.2.2"><math alttext="x" class="ltx_Math" display="inline" id="alg3.34.34.1.1.1.m1.1"><semantics id="alg3.34.34.1.1.1.m1.1a"><mi id="alg3.34.34.1.1.1.m1.1.1" xref="alg3.34.34.1.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg3.34.34.1.1.1.m1.1b"><ci id="alg3.34.34.1.1.1.m1.1.1.cmml" xref="alg3.34.34.1.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.34.34.1.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg3.34.34.1.1.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="i" class="ltx_Math" display="inline" id="alg3.35.35.2.2.2.m2.1"><semantics id="alg3.35.35.2.2.2.m2.1a"><mi id="alg3.35.35.2.2.2.m2.1.1" xref="alg3.35.35.2.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.35.35.2.2.2.m2.1b"><ci id="alg3.35.35.2.2.2.m2.1.1.cmml" xref="alg3.35.35.2.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.35.35.2.2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg3.35.35.2.2.2.m2.1d">italic_i</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="alg3.35.35.6" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="alg3.37.37">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.37.37.1.1.1" style="font-size:90%;">21</span></span><span class="ltx_text" id="alg3.37.37.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.37.37.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.37.37.4" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg3.37.37.5" style="font-size:90%;">return</span><span class="ltx_text" id="alg3.37.37.6" style="font-size:90%;"> ConvBlock(</span><math alttext="x" class="ltx_Math" display="inline" id="alg3.36.36.m1.1"><semantics id="alg3.36.36.m1.1a"><mi id="alg3.36.36.m1.1.1" mathsize="90%" xref="alg3.36.36.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg3.36.36.m1.1b"><ci id="alg3.36.36.m1.1.1.cmml" xref="alg3.36.36.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.36.36.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg3.36.36.m1.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg3.37.37.7" style="font-size:90%;">, </span><math alttext="channels\_out=num\_ch\_dec[i]" class="ltx_Math" display="inline" id="alg3.37.37.m2.1"><semantics id="alg3.37.37.m2.1a"><mrow id="alg3.37.37.m2.1.2" xref="alg3.37.37.m2.1.2.cmml"><mrow id="alg3.37.37.m2.1.2.2" xref="alg3.37.37.m2.1.2.2.cmml"><mi id="alg3.37.37.m2.1.2.2.2" mathsize="90%" xref="alg3.37.37.m2.1.2.2.2.cmml">c</mi><mo id="alg3.37.37.m2.1.2.2.1" xref="alg3.37.37.m2.1.2.2.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.2.3" mathsize="90%" xref="alg3.37.37.m2.1.2.2.3.cmml">h</mi><mo id="alg3.37.37.m2.1.2.2.1a" xref="alg3.37.37.m2.1.2.2.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.2.4" mathsize="90%" xref="alg3.37.37.m2.1.2.2.4.cmml">a</mi><mo id="alg3.37.37.m2.1.2.2.1b" xref="alg3.37.37.m2.1.2.2.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.2.5" mathsize="90%" xref="alg3.37.37.m2.1.2.2.5.cmml">n</mi><mo id="alg3.37.37.m2.1.2.2.1c" xref="alg3.37.37.m2.1.2.2.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.2.6" mathsize="90%" xref="alg3.37.37.m2.1.2.2.6.cmml">n</mi><mo id="alg3.37.37.m2.1.2.2.1d" xref="alg3.37.37.m2.1.2.2.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.2.7" mathsize="90%" xref="alg3.37.37.m2.1.2.2.7.cmml">e</mi><mo id="alg3.37.37.m2.1.2.2.1e" xref="alg3.37.37.m2.1.2.2.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.2.8" mathsize="90%" xref="alg3.37.37.m2.1.2.2.8.cmml">l</mi><mo id="alg3.37.37.m2.1.2.2.1f" xref="alg3.37.37.m2.1.2.2.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.2.9" mathsize="90%" xref="alg3.37.37.m2.1.2.2.9.cmml">s</mi><mo id="alg3.37.37.m2.1.2.2.1g" xref="alg3.37.37.m2.1.2.2.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.2.10" mathsize="90%" mathvariant="normal" xref="alg3.37.37.m2.1.2.2.10.cmml">_</mi><mo id="alg3.37.37.m2.1.2.2.1h" xref="alg3.37.37.m2.1.2.2.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.2.11" mathsize="90%" xref="alg3.37.37.m2.1.2.2.11.cmml">o</mi><mo id="alg3.37.37.m2.1.2.2.1i" xref="alg3.37.37.m2.1.2.2.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.2.12" mathsize="90%" xref="alg3.37.37.m2.1.2.2.12.cmml">u</mi><mo id="alg3.37.37.m2.1.2.2.1j" xref="alg3.37.37.m2.1.2.2.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.2.13" mathsize="90%" xref="alg3.37.37.m2.1.2.2.13.cmml">t</mi></mrow><mo id="alg3.37.37.m2.1.2.1" mathsize="90%" xref="alg3.37.37.m2.1.2.1.cmml">=</mo><mrow id="alg3.37.37.m2.1.2.3" xref="alg3.37.37.m2.1.2.3.cmml"><mi id="alg3.37.37.m2.1.2.3.2" mathsize="90%" xref="alg3.37.37.m2.1.2.3.2.cmml">n</mi><mo id="alg3.37.37.m2.1.2.3.1" xref="alg3.37.37.m2.1.2.3.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.3.3" mathsize="90%" xref="alg3.37.37.m2.1.2.3.3.cmml">u</mi><mo id="alg3.37.37.m2.1.2.3.1a" xref="alg3.37.37.m2.1.2.3.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.3.4" mathsize="90%" xref="alg3.37.37.m2.1.2.3.4.cmml">m</mi><mo id="alg3.37.37.m2.1.2.3.1b" xref="alg3.37.37.m2.1.2.3.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.3.5" mathsize="90%" mathvariant="normal" xref="alg3.37.37.m2.1.2.3.5.cmml">_</mi><mo id="alg3.37.37.m2.1.2.3.1c" xref="alg3.37.37.m2.1.2.3.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.3.6" mathsize="90%" xref="alg3.37.37.m2.1.2.3.6.cmml">c</mi><mo id="alg3.37.37.m2.1.2.3.1d" xref="alg3.37.37.m2.1.2.3.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.3.7" mathsize="90%" xref="alg3.37.37.m2.1.2.3.7.cmml">h</mi><mo id="alg3.37.37.m2.1.2.3.1e" xref="alg3.37.37.m2.1.2.3.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.3.8" mathsize="90%" mathvariant="normal" xref="alg3.37.37.m2.1.2.3.8.cmml">_</mi><mo id="alg3.37.37.m2.1.2.3.1f" xref="alg3.37.37.m2.1.2.3.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.3.9" mathsize="90%" xref="alg3.37.37.m2.1.2.3.9.cmml">d</mi><mo id="alg3.37.37.m2.1.2.3.1g" xref="alg3.37.37.m2.1.2.3.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.3.10" mathsize="90%" xref="alg3.37.37.m2.1.2.3.10.cmml">e</mi><mo id="alg3.37.37.m2.1.2.3.1h" xref="alg3.37.37.m2.1.2.3.1.cmml">⁢</mo><mi id="alg3.37.37.m2.1.2.3.11" mathsize="90%" xref="alg3.37.37.m2.1.2.3.11.cmml">c</mi><mo id="alg3.37.37.m2.1.2.3.1i" xref="alg3.37.37.m2.1.2.3.1.cmml">⁢</mo><mrow id="alg3.37.37.m2.1.2.3.12.2" xref="alg3.37.37.m2.1.2.3.12.1.cmml"><mo id="alg3.37.37.m2.1.2.3.12.2.1" maxsize="90%" minsize="90%" xref="alg3.37.37.m2.1.2.3.12.1.1.cmml">[</mo><mi id="alg3.37.37.m2.1.1" mathsize="90%" xref="alg3.37.37.m2.1.1.cmml">i</mi><mo id="alg3.37.37.m2.1.2.3.12.2.2" maxsize="90%" minsize="90%" xref="alg3.37.37.m2.1.2.3.12.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.37.37.m2.1b"><apply id="alg3.37.37.m2.1.2.cmml" xref="alg3.37.37.m2.1.2"><eq id="alg3.37.37.m2.1.2.1.cmml" xref="alg3.37.37.m2.1.2.1"></eq><apply id="alg3.37.37.m2.1.2.2.cmml" xref="alg3.37.37.m2.1.2.2"><times id="alg3.37.37.m2.1.2.2.1.cmml" xref="alg3.37.37.m2.1.2.2.1"></times><ci id="alg3.37.37.m2.1.2.2.2.cmml" xref="alg3.37.37.m2.1.2.2.2">𝑐</ci><ci id="alg3.37.37.m2.1.2.2.3.cmml" xref="alg3.37.37.m2.1.2.2.3">ℎ</ci><ci id="alg3.37.37.m2.1.2.2.4.cmml" xref="alg3.37.37.m2.1.2.2.4">𝑎</ci><ci id="alg3.37.37.m2.1.2.2.5.cmml" xref="alg3.37.37.m2.1.2.2.5">𝑛</ci><ci id="alg3.37.37.m2.1.2.2.6.cmml" xref="alg3.37.37.m2.1.2.2.6">𝑛</ci><ci id="alg3.37.37.m2.1.2.2.7.cmml" xref="alg3.37.37.m2.1.2.2.7">𝑒</ci><ci id="alg3.37.37.m2.1.2.2.8.cmml" xref="alg3.37.37.m2.1.2.2.8">𝑙</ci><ci id="alg3.37.37.m2.1.2.2.9.cmml" xref="alg3.37.37.m2.1.2.2.9">𝑠</ci><ci id="alg3.37.37.m2.1.2.2.10.cmml" xref="alg3.37.37.m2.1.2.2.10">_</ci><ci id="alg3.37.37.m2.1.2.2.11.cmml" xref="alg3.37.37.m2.1.2.2.11">𝑜</ci><ci id="alg3.37.37.m2.1.2.2.12.cmml" xref="alg3.37.37.m2.1.2.2.12">𝑢</ci><ci id="alg3.37.37.m2.1.2.2.13.cmml" xref="alg3.37.37.m2.1.2.2.13">𝑡</ci></apply><apply id="alg3.37.37.m2.1.2.3.cmml" xref="alg3.37.37.m2.1.2.3"><times id="alg3.37.37.m2.1.2.3.1.cmml" xref="alg3.37.37.m2.1.2.3.1"></times><ci id="alg3.37.37.m2.1.2.3.2.cmml" xref="alg3.37.37.m2.1.2.3.2">𝑛</ci><ci id="alg3.37.37.m2.1.2.3.3.cmml" xref="alg3.37.37.m2.1.2.3.3">𝑢</ci><ci id="alg3.37.37.m2.1.2.3.4.cmml" xref="alg3.37.37.m2.1.2.3.4">𝑚</ci><ci id="alg3.37.37.m2.1.2.3.5.cmml" xref="alg3.37.37.m2.1.2.3.5">_</ci><ci id="alg3.37.37.m2.1.2.3.6.cmml" xref="alg3.37.37.m2.1.2.3.6">𝑐</ci><ci id="alg3.37.37.m2.1.2.3.7.cmml" xref="alg3.37.37.m2.1.2.3.7">ℎ</ci><ci id="alg3.37.37.m2.1.2.3.8.cmml" xref="alg3.37.37.m2.1.2.3.8">_</ci><ci id="alg3.37.37.m2.1.2.3.9.cmml" xref="alg3.37.37.m2.1.2.3.9">𝑑</ci><ci id="alg3.37.37.m2.1.2.3.10.cmml" xref="alg3.37.37.m2.1.2.3.10">𝑒</ci><ci id="alg3.37.37.m2.1.2.3.11.cmml" xref="alg3.37.37.m2.1.2.3.11">𝑐</ci><apply id="alg3.37.37.m2.1.2.3.12.1.cmml" xref="alg3.37.37.m2.1.2.3.12.2"><csymbol cd="latexml" id="alg3.37.37.m2.1.2.3.12.1.1.cmml" xref="alg3.37.37.m2.1.2.3.12.2.1">delimited-[]</csymbol><ci id="alg3.37.37.m2.1.1.cmml" xref="alg3.37.37.m2.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.37.37.m2.1c">channels\_out=num\_ch\_dec[i]</annotation><annotation encoding="application/x-llamapun" id="alg3.37.37.m2.1d">italic_c italic_h italic_a italic_n italic_n italic_e italic_l italic_s _ italic_o italic_u italic_t = italic_n italic_u italic_m _ italic_c italic_h _ italic_d italic_e italic_c [ italic_i ]</annotation></semantics></math><span class="ltx_text" id="alg3.37.37.8" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg3.60.68">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.68.1.1.1" style="font-size:90%;">22</span></span><span class="ltx_text" id="alg3.60.68.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.68.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.60.68.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.60.69">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.69.1.1.1" style="font-size:90%;">23</span></span>
</div>
<div class="ltx_listingline" id="alg3.39.39">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.39.39.3.1.1" style="font-size:90%;">24</span></span><span class="ltx_text ltx_font_bold" id="alg3.39.39.4" style="font-size:90%;">Function</span><span class="ltx_text" id="alg3.39.39.5" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_typewriter" id="alg3.39.39.2" style="font-size:90%;">Dispconv(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.39.39.2.2.2"><math alttext="x" class="ltx_Math" display="inline" id="alg3.38.38.1.1.1.m1.1"><semantics id="alg3.38.38.1.1.1.m1.1a"><mi id="alg3.38.38.1.1.1.m1.1.1" xref="alg3.38.38.1.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg3.38.38.1.1.1.m1.1b"><ci id="alg3.38.38.1.1.1.m1.1.1.cmml" xref="alg3.38.38.1.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.38.38.1.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg3.38.38.1.1.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="i" class="ltx_Math" display="inline" id="alg3.39.39.2.2.2.m2.1"><semantics id="alg3.39.39.2.2.2.m2.1a"><mi id="alg3.39.39.2.2.2.m2.1.1" xref="alg3.39.39.2.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.39.39.2.2.2.m2.1b"><ci id="alg3.39.39.2.2.2.m2.1.1.cmml" xref="alg3.39.39.2.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.39.39.2.2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg3.39.39.2.2.2.m2.1d">italic_i</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="alg3.39.39.6" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="alg3.42.42">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.42.42.1.1.1" style="font-size:90%;">25</span></span><span class="ltx_text" id="alg3.42.42.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.42.42.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.42.42.4" style="font-size:90%;">
</span><math alttext="disp\leftarrow" class="ltx_Math" display="inline" id="alg3.40.40.m1.1"><semantics id="alg3.40.40.m1.1a"><mrow id="alg3.40.40.m1.1.1" xref="alg3.40.40.m1.1.1.cmml"><mrow id="alg3.40.40.m1.1.1.2" xref="alg3.40.40.m1.1.1.2.cmml"><mi id="alg3.40.40.m1.1.1.2.2" mathsize="90%" xref="alg3.40.40.m1.1.1.2.2.cmml">d</mi><mo id="alg3.40.40.m1.1.1.2.1" xref="alg3.40.40.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.40.40.m1.1.1.2.3" mathsize="90%" xref="alg3.40.40.m1.1.1.2.3.cmml">i</mi><mo id="alg3.40.40.m1.1.1.2.1a" xref="alg3.40.40.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.40.40.m1.1.1.2.4" mathsize="90%" xref="alg3.40.40.m1.1.1.2.4.cmml">s</mi><mo id="alg3.40.40.m1.1.1.2.1b" xref="alg3.40.40.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.40.40.m1.1.1.2.5" mathsize="90%" xref="alg3.40.40.m1.1.1.2.5.cmml">p</mi></mrow><mo id="alg3.40.40.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg3.40.40.m1.1.1.1.cmml">←</mo><mi id="alg3.40.40.m1.1.1.3" xref="alg3.40.40.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.40.40.m1.1b"><apply id="alg3.40.40.m1.1.1.cmml" xref="alg3.40.40.m1.1.1"><ci id="alg3.40.40.m1.1.1.1.cmml" xref="alg3.40.40.m1.1.1.1">←</ci><apply id="alg3.40.40.m1.1.1.2.cmml" xref="alg3.40.40.m1.1.1.2"><times id="alg3.40.40.m1.1.1.2.1.cmml" xref="alg3.40.40.m1.1.1.2.1"></times><ci id="alg3.40.40.m1.1.1.2.2.cmml" xref="alg3.40.40.m1.1.1.2.2">𝑑</ci><ci id="alg3.40.40.m1.1.1.2.3.cmml" xref="alg3.40.40.m1.1.1.2.3">𝑖</ci><ci id="alg3.40.40.m1.1.1.2.4.cmml" xref="alg3.40.40.m1.1.1.2.4">𝑠</ci><ci id="alg3.40.40.m1.1.1.2.5.cmml" xref="alg3.40.40.m1.1.1.2.5">𝑝</ci></apply><csymbol cd="latexml" id="alg3.40.40.m1.1.1.3.cmml" xref="alg3.40.40.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.40.40.m1.1c">disp\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg3.40.40.m1.1d">italic_d italic_i italic_s italic_p ←</annotation></semantics></math><span class="ltx_text" id="alg3.42.42.5" style="font-size:90%;"> Conv3x3(</span><math alttext="x" class="ltx_Math" display="inline" id="alg3.41.41.m2.1"><semantics id="alg3.41.41.m2.1a"><mi id="alg3.41.41.m2.1.1" mathsize="90%" xref="alg3.41.41.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg3.41.41.m2.1b"><ci id="alg3.41.41.m2.1.1.cmml" xref="alg3.41.41.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.41.41.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg3.41.41.m2.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg3.42.42.6" style="font-size:90%;">, </span><math alttext="channels\_out=1" class="ltx_Math" display="inline" id="alg3.42.42.m3.1"><semantics id="alg3.42.42.m3.1a"><mrow id="alg3.42.42.m3.1.1" xref="alg3.42.42.m3.1.1.cmml"><mrow id="alg3.42.42.m3.1.1.2" xref="alg3.42.42.m3.1.1.2.cmml"><mi id="alg3.42.42.m3.1.1.2.2" mathsize="90%" xref="alg3.42.42.m3.1.1.2.2.cmml">c</mi><mo id="alg3.42.42.m3.1.1.2.1" xref="alg3.42.42.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.42.42.m3.1.1.2.3" mathsize="90%" xref="alg3.42.42.m3.1.1.2.3.cmml">h</mi><mo id="alg3.42.42.m3.1.1.2.1a" xref="alg3.42.42.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.42.42.m3.1.1.2.4" mathsize="90%" xref="alg3.42.42.m3.1.1.2.4.cmml">a</mi><mo id="alg3.42.42.m3.1.1.2.1b" xref="alg3.42.42.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.42.42.m3.1.1.2.5" mathsize="90%" xref="alg3.42.42.m3.1.1.2.5.cmml">n</mi><mo id="alg3.42.42.m3.1.1.2.1c" xref="alg3.42.42.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.42.42.m3.1.1.2.6" mathsize="90%" xref="alg3.42.42.m3.1.1.2.6.cmml">n</mi><mo id="alg3.42.42.m3.1.1.2.1d" xref="alg3.42.42.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.42.42.m3.1.1.2.7" mathsize="90%" xref="alg3.42.42.m3.1.1.2.7.cmml">e</mi><mo id="alg3.42.42.m3.1.1.2.1e" xref="alg3.42.42.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.42.42.m3.1.1.2.8" mathsize="90%" xref="alg3.42.42.m3.1.1.2.8.cmml">l</mi><mo id="alg3.42.42.m3.1.1.2.1f" xref="alg3.42.42.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.42.42.m3.1.1.2.9" mathsize="90%" xref="alg3.42.42.m3.1.1.2.9.cmml">s</mi><mo id="alg3.42.42.m3.1.1.2.1g" xref="alg3.42.42.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.42.42.m3.1.1.2.10" mathsize="90%" mathvariant="normal" xref="alg3.42.42.m3.1.1.2.10.cmml">_</mi><mo id="alg3.42.42.m3.1.1.2.1h" xref="alg3.42.42.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.42.42.m3.1.1.2.11" mathsize="90%" xref="alg3.42.42.m3.1.1.2.11.cmml">o</mi><mo id="alg3.42.42.m3.1.1.2.1i" xref="alg3.42.42.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.42.42.m3.1.1.2.12" mathsize="90%" xref="alg3.42.42.m3.1.1.2.12.cmml">u</mi><mo id="alg3.42.42.m3.1.1.2.1j" xref="alg3.42.42.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.42.42.m3.1.1.2.13" mathsize="90%" xref="alg3.42.42.m3.1.1.2.13.cmml">t</mi></mrow><mo id="alg3.42.42.m3.1.1.1" mathsize="90%" xref="alg3.42.42.m3.1.1.1.cmml">=</mo><mn id="alg3.42.42.m3.1.1.3" mathsize="90%" xref="alg3.42.42.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.42.42.m3.1b"><apply id="alg3.42.42.m3.1.1.cmml" xref="alg3.42.42.m3.1.1"><eq id="alg3.42.42.m3.1.1.1.cmml" xref="alg3.42.42.m3.1.1.1"></eq><apply id="alg3.42.42.m3.1.1.2.cmml" xref="alg3.42.42.m3.1.1.2"><times id="alg3.42.42.m3.1.1.2.1.cmml" xref="alg3.42.42.m3.1.1.2.1"></times><ci id="alg3.42.42.m3.1.1.2.2.cmml" xref="alg3.42.42.m3.1.1.2.2">𝑐</ci><ci id="alg3.42.42.m3.1.1.2.3.cmml" xref="alg3.42.42.m3.1.1.2.3">ℎ</ci><ci id="alg3.42.42.m3.1.1.2.4.cmml" xref="alg3.42.42.m3.1.1.2.4">𝑎</ci><ci id="alg3.42.42.m3.1.1.2.5.cmml" xref="alg3.42.42.m3.1.1.2.5">𝑛</ci><ci id="alg3.42.42.m3.1.1.2.6.cmml" xref="alg3.42.42.m3.1.1.2.6">𝑛</ci><ci id="alg3.42.42.m3.1.1.2.7.cmml" xref="alg3.42.42.m3.1.1.2.7">𝑒</ci><ci id="alg3.42.42.m3.1.1.2.8.cmml" xref="alg3.42.42.m3.1.1.2.8">𝑙</ci><ci id="alg3.42.42.m3.1.1.2.9.cmml" xref="alg3.42.42.m3.1.1.2.9">𝑠</ci><ci id="alg3.42.42.m3.1.1.2.10.cmml" xref="alg3.42.42.m3.1.1.2.10">_</ci><ci id="alg3.42.42.m3.1.1.2.11.cmml" xref="alg3.42.42.m3.1.1.2.11">𝑜</ci><ci id="alg3.42.42.m3.1.1.2.12.cmml" xref="alg3.42.42.m3.1.1.2.12">𝑢</ci><ci id="alg3.42.42.m3.1.1.2.13.cmml" xref="alg3.42.42.m3.1.1.2.13">𝑡</ci></apply><cn id="alg3.42.42.m3.1.1.3.cmml" type="integer" xref="alg3.42.42.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.42.42.m3.1c">channels\_out=1</annotation><annotation encoding="application/x-llamapun" id="alg3.42.42.m3.1d">italic_c italic_h italic_a italic_n italic_n italic_e italic_l italic_s _ italic_o italic_u italic_t = 1</annotation></semantics></math><span class="ltx_text" id="alg3.42.42.7" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg3.44.44">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.44.44.1.1.1" style="font-size:90%;">26</span></span><span class="ltx_text" id="alg3.44.44.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.44.44.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.44.44.4" style="font-size:90%;">
</span><math alttext="disp\leftarrow" class="ltx_Math" display="inline" id="alg3.43.43.m1.1"><semantics id="alg3.43.43.m1.1a"><mrow id="alg3.43.43.m1.1.1" xref="alg3.43.43.m1.1.1.cmml"><mrow id="alg3.43.43.m1.1.1.2" xref="alg3.43.43.m1.1.1.2.cmml"><mi id="alg3.43.43.m1.1.1.2.2" mathsize="90%" xref="alg3.43.43.m1.1.1.2.2.cmml">d</mi><mo id="alg3.43.43.m1.1.1.2.1" xref="alg3.43.43.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.43.43.m1.1.1.2.3" mathsize="90%" xref="alg3.43.43.m1.1.1.2.3.cmml">i</mi><mo id="alg3.43.43.m1.1.1.2.1a" xref="alg3.43.43.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.43.43.m1.1.1.2.4" mathsize="90%" xref="alg3.43.43.m1.1.1.2.4.cmml">s</mi><mo id="alg3.43.43.m1.1.1.2.1b" xref="alg3.43.43.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.43.43.m1.1.1.2.5" mathsize="90%" xref="alg3.43.43.m1.1.1.2.5.cmml">p</mi></mrow><mo id="alg3.43.43.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg3.43.43.m1.1.1.1.cmml">←</mo><mi id="alg3.43.43.m1.1.1.3" xref="alg3.43.43.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.43.43.m1.1b"><apply id="alg3.43.43.m1.1.1.cmml" xref="alg3.43.43.m1.1.1"><ci id="alg3.43.43.m1.1.1.1.cmml" xref="alg3.43.43.m1.1.1.1">←</ci><apply id="alg3.43.43.m1.1.1.2.cmml" xref="alg3.43.43.m1.1.1.2"><times id="alg3.43.43.m1.1.1.2.1.cmml" xref="alg3.43.43.m1.1.1.2.1"></times><ci id="alg3.43.43.m1.1.1.2.2.cmml" xref="alg3.43.43.m1.1.1.2.2">𝑑</ci><ci id="alg3.43.43.m1.1.1.2.3.cmml" xref="alg3.43.43.m1.1.1.2.3">𝑖</ci><ci id="alg3.43.43.m1.1.1.2.4.cmml" xref="alg3.43.43.m1.1.1.2.4">𝑠</ci><ci id="alg3.43.43.m1.1.1.2.5.cmml" xref="alg3.43.43.m1.1.1.2.5">𝑝</ci></apply><csymbol cd="latexml" id="alg3.43.43.m1.1.1.3.cmml" xref="alg3.43.43.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.43.43.m1.1c">disp\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg3.43.43.m1.1d">italic_d italic_i italic_s italic_p ←</annotation></semantics></math><span class="ltx_text" id="alg3.44.44.5" style="font-size:90%;"> Upsample(</span><math alttext="disp" class="ltx_Math" display="inline" id="alg3.44.44.m2.1"><semantics id="alg3.44.44.m2.1a"><mrow id="alg3.44.44.m2.1.1" xref="alg3.44.44.m2.1.1.cmml"><mi id="alg3.44.44.m2.1.1.2" mathsize="90%" xref="alg3.44.44.m2.1.1.2.cmml">d</mi><mo id="alg3.44.44.m2.1.1.1" xref="alg3.44.44.m2.1.1.1.cmml">⁢</mo><mi id="alg3.44.44.m2.1.1.3" mathsize="90%" xref="alg3.44.44.m2.1.1.3.cmml">i</mi><mo id="alg3.44.44.m2.1.1.1a" xref="alg3.44.44.m2.1.1.1.cmml">⁢</mo><mi id="alg3.44.44.m2.1.1.4" mathsize="90%" xref="alg3.44.44.m2.1.1.4.cmml">s</mi><mo id="alg3.44.44.m2.1.1.1b" xref="alg3.44.44.m2.1.1.1.cmml">⁢</mo><mi id="alg3.44.44.m2.1.1.5" mathsize="90%" xref="alg3.44.44.m2.1.1.5.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.44.44.m2.1b"><apply id="alg3.44.44.m2.1.1.cmml" xref="alg3.44.44.m2.1.1"><times id="alg3.44.44.m2.1.1.1.cmml" xref="alg3.44.44.m2.1.1.1"></times><ci id="alg3.44.44.m2.1.1.2.cmml" xref="alg3.44.44.m2.1.1.2">𝑑</ci><ci id="alg3.44.44.m2.1.1.3.cmml" xref="alg3.44.44.m2.1.1.3">𝑖</ci><ci id="alg3.44.44.m2.1.1.4.cmml" xref="alg3.44.44.m2.1.1.4">𝑠</ci><ci id="alg3.44.44.m2.1.1.5.cmml" xref="alg3.44.44.m2.1.1.5">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.44.44.m2.1c">disp</annotation><annotation encoding="application/x-llamapun" id="alg3.44.44.m2.1d">italic_d italic_i italic_s italic_p</annotation></semantics></math><span class="ltx_text" id="alg3.44.44.6" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg3.45.45">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.45.45.1.1.1" style="font-size:90%;">27</span></span><span class="ltx_text" id="alg3.45.45.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.45.45.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.45.45.4" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg3.45.45.5" style="font-size:90%;">return</span><span class="ltx_text" id="alg3.45.45.6" style="font-size:90%;"> Sigmoid(</span><math alttext="disp" class="ltx_Math" display="inline" id="alg3.45.45.m1.1"><semantics id="alg3.45.45.m1.1a"><mrow id="alg3.45.45.m1.1.1" xref="alg3.45.45.m1.1.1.cmml"><mi id="alg3.45.45.m1.1.1.2" mathsize="90%" xref="alg3.45.45.m1.1.1.2.cmml">d</mi><mo id="alg3.45.45.m1.1.1.1" xref="alg3.45.45.m1.1.1.1.cmml">⁢</mo><mi id="alg3.45.45.m1.1.1.3" mathsize="90%" xref="alg3.45.45.m1.1.1.3.cmml">i</mi><mo id="alg3.45.45.m1.1.1.1a" xref="alg3.45.45.m1.1.1.1.cmml">⁢</mo><mi id="alg3.45.45.m1.1.1.4" mathsize="90%" xref="alg3.45.45.m1.1.1.4.cmml">s</mi><mo id="alg3.45.45.m1.1.1.1b" xref="alg3.45.45.m1.1.1.1.cmml">⁢</mo><mi id="alg3.45.45.m1.1.1.5" mathsize="90%" xref="alg3.45.45.m1.1.1.5.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.45.45.m1.1b"><apply id="alg3.45.45.m1.1.1.cmml" xref="alg3.45.45.m1.1.1"><times id="alg3.45.45.m1.1.1.1.cmml" xref="alg3.45.45.m1.1.1.1"></times><ci id="alg3.45.45.m1.1.1.2.cmml" xref="alg3.45.45.m1.1.1.2">𝑑</ci><ci id="alg3.45.45.m1.1.1.3.cmml" xref="alg3.45.45.m1.1.1.3">𝑖</ci><ci id="alg3.45.45.m1.1.1.4.cmml" xref="alg3.45.45.m1.1.1.4">𝑠</ci><ci id="alg3.45.45.m1.1.1.5.cmml" xref="alg3.45.45.m1.1.1.5">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.45.45.m1.1c">disp</annotation><annotation encoding="application/x-llamapun" id="alg3.45.45.m1.1d">italic_d italic_i italic_s italic_p</annotation></semantics></math><span class="ltx_text" id="alg3.45.45.7" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg3.60.70">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.70.1.1.1" style="font-size:90%;">28</span></span><span class="ltx_text" id="alg3.60.70.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.70.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.60.70.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.60.71">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.71.1.1.1" style="font-size:90%;">29</span></span>
</div>
<div class="ltx_listingline" id="alg3.47.47">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.47.47.3.1.1" style="font-size:90%;">30</span></span><span class="ltx_text ltx_font_bold" id="alg3.47.47.4" style="font-size:90%;">Function</span><span class="ltx_text" id="alg3.47.47.5" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_typewriter" id="alg3.47.47.2" style="font-size:90%;">Normconv(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="alg3.47.47.2.2.2"><math alttext="x" class="ltx_Math" display="inline" id="alg3.46.46.1.1.1.m1.1"><semantics id="alg3.46.46.1.1.1.m1.1a"><mi id="alg3.46.46.1.1.1.m1.1.1" xref="alg3.46.46.1.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg3.46.46.1.1.1.m1.1b"><ci id="alg3.46.46.1.1.1.m1.1.1.cmml" xref="alg3.46.46.1.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.46.46.1.1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg3.46.46.1.1.1.m1.1d">italic_x</annotation></semantics></math>, <math alttext="i" class="ltx_Math" display="inline" id="alg3.47.47.2.2.2.m2.1"><semantics id="alg3.47.47.2.2.2.m2.1a"><mi id="alg3.47.47.2.2.2.m2.1.1" xref="alg3.47.47.2.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.47.47.2.2.2.m2.1b"><ci id="alg3.47.47.2.2.2.m2.1.1.cmml" xref="alg3.47.47.2.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.47.47.2.2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="alg3.47.47.2.2.2.m2.1d">italic_i</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="alg3.47.47.6" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="alg3.50.50">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.50.50.1.1.1" style="font-size:90%;">31</span></span><span class="ltx_text" id="alg3.50.50.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.50.50.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.50.50.4" style="font-size:90%;">
</span><math alttext="normal\leftarrow" class="ltx_Math" display="inline" id="alg3.48.48.m1.1"><semantics id="alg3.48.48.m1.1a"><mrow id="alg3.48.48.m1.1.1" xref="alg3.48.48.m1.1.1.cmml"><mrow id="alg3.48.48.m1.1.1.2" xref="alg3.48.48.m1.1.1.2.cmml"><mi id="alg3.48.48.m1.1.1.2.2" mathsize="90%" xref="alg3.48.48.m1.1.1.2.2.cmml">n</mi><mo id="alg3.48.48.m1.1.1.2.1" xref="alg3.48.48.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.48.48.m1.1.1.2.3" mathsize="90%" xref="alg3.48.48.m1.1.1.2.3.cmml">o</mi><mo id="alg3.48.48.m1.1.1.2.1a" xref="alg3.48.48.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.48.48.m1.1.1.2.4" mathsize="90%" xref="alg3.48.48.m1.1.1.2.4.cmml">r</mi><mo id="alg3.48.48.m1.1.1.2.1b" xref="alg3.48.48.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.48.48.m1.1.1.2.5" mathsize="90%" xref="alg3.48.48.m1.1.1.2.5.cmml">m</mi><mo id="alg3.48.48.m1.1.1.2.1c" xref="alg3.48.48.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.48.48.m1.1.1.2.6" mathsize="90%" xref="alg3.48.48.m1.1.1.2.6.cmml">a</mi><mo id="alg3.48.48.m1.1.1.2.1d" xref="alg3.48.48.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.48.48.m1.1.1.2.7" mathsize="90%" xref="alg3.48.48.m1.1.1.2.7.cmml">l</mi></mrow><mo id="alg3.48.48.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg3.48.48.m1.1.1.1.cmml">←</mo><mi id="alg3.48.48.m1.1.1.3" xref="alg3.48.48.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.48.48.m1.1b"><apply id="alg3.48.48.m1.1.1.cmml" xref="alg3.48.48.m1.1.1"><ci id="alg3.48.48.m1.1.1.1.cmml" xref="alg3.48.48.m1.1.1.1">←</ci><apply id="alg3.48.48.m1.1.1.2.cmml" xref="alg3.48.48.m1.1.1.2"><times id="alg3.48.48.m1.1.1.2.1.cmml" xref="alg3.48.48.m1.1.1.2.1"></times><ci id="alg3.48.48.m1.1.1.2.2.cmml" xref="alg3.48.48.m1.1.1.2.2">𝑛</ci><ci id="alg3.48.48.m1.1.1.2.3.cmml" xref="alg3.48.48.m1.1.1.2.3">𝑜</ci><ci id="alg3.48.48.m1.1.1.2.4.cmml" xref="alg3.48.48.m1.1.1.2.4">𝑟</ci><ci id="alg3.48.48.m1.1.1.2.5.cmml" xref="alg3.48.48.m1.1.1.2.5">𝑚</ci><ci id="alg3.48.48.m1.1.1.2.6.cmml" xref="alg3.48.48.m1.1.1.2.6">𝑎</ci><ci id="alg3.48.48.m1.1.1.2.7.cmml" xref="alg3.48.48.m1.1.1.2.7">𝑙</ci></apply><csymbol cd="latexml" id="alg3.48.48.m1.1.1.3.cmml" xref="alg3.48.48.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.48.48.m1.1c">normal\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg3.48.48.m1.1d">italic_n italic_o italic_r italic_m italic_a italic_l ←</annotation></semantics></math><span class="ltx_text" id="alg3.50.50.5" style="font-size:90%;"> Conv3x3(</span><math alttext="x" class="ltx_Math" display="inline" id="alg3.49.49.m2.1"><semantics id="alg3.49.49.m2.1a"><mi id="alg3.49.49.m2.1.1" mathsize="90%" xref="alg3.49.49.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg3.49.49.m2.1b"><ci id="alg3.49.49.m2.1.1.cmml" xref="alg3.49.49.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.49.49.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg3.49.49.m2.1d">italic_x</annotation></semantics></math><span class="ltx_text" id="alg3.50.50.6" style="font-size:90%;">, </span><math alttext="channels\_out=3" class="ltx_Math" display="inline" id="alg3.50.50.m3.1"><semantics id="alg3.50.50.m3.1a"><mrow id="alg3.50.50.m3.1.1" xref="alg3.50.50.m3.1.1.cmml"><mrow id="alg3.50.50.m3.1.1.2" xref="alg3.50.50.m3.1.1.2.cmml"><mi id="alg3.50.50.m3.1.1.2.2" mathsize="90%" xref="alg3.50.50.m3.1.1.2.2.cmml">c</mi><mo id="alg3.50.50.m3.1.1.2.1" xref="alg3.50.50.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.50.50.m3.1.1.2.3" mathsize="90%" xref="alg3.50.50.m3.1.1.2.3.cmml">h</mi><mo id="alg3.50.50.m3.1.1.2.1a" xref="alg3.50.50.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.50.50.m3.1.1.2.4" mathsize="90%" xref="alg3.50.50.m3.1.1.2.4.cmml">a</mi><mo id="alg3.50.50.m3.1.1.2.1b" xref="alg3.50.50.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.50.50.m3.1.1.2.5" mathsize="90%" xref="alg3.50.50.m3.1.1.2.5.cmml">n</mi><mo id="alg3.50.50.m3.1.1.2.1c" xref="alg3.50.50.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.50.50.m3.1.1.2.6" mathsize="90%" xref="alg3.50.50.m3.1.1.2.6.cmml">n</mi><mo id="alg3.50.50.m3.1.1.2.1d" xref="alg3.50.50.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.50.50.m3.1.1.2.7" mathsize="90%" xref="alg3.50.50.m3.1.1.2.7.cmml">e</mi><mo id="alg3.50.50.m3.1.1.2.1e" xref="alg3.50.50.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.50.50.m3.1.1.2.8" mathsize="90%" xref="alg3.50.50.m3.1.1.2.8.cmml">l</mi><mo id="alg3.50.50.m3.1.1.2.1f" xref="alg3.50.50.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.50.50.m3.1.1.2.9" mathsize="90%" xref="alg3.50.50.m3.1.1.2.9.cmml">s</mi><mo id="alg3.50.50.m3.1.1.2.1g" xref="alg3.50.50.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.50.50.m3.1.1.2.10" mathsize="90%" mathvariant="normal" xref="alg3.50.50.m3.1.1.2.10.cmml">_</mi><mo id="alg3.50.50.m3.1.1.2.1h" xref="alg3.50.50.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.50.50.m3.1.1.2.11" mathsize="90%" xref="alg3.50.50.m3.1.1.2.11.cmml">o</mi><mo id="alg3.50.50.m3.1.1.2.1i" xref="alg3.50.50.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.50.50.m3.1.1.2.12" mathsize="90%" xref="alg3.50.50.m3.1.1.2.12.cmml">u</mi><mo id="alg3.50.50.m3.1.1.2.1j" xref="alg3.50.50.m3.1.1.2.1.cmml">⁢</mo><mi id="alg3.50.50.m3.1.1.2.13" mathsize="90%" xref="alg3.50.50.m3.1.1.2.13.cmml">t</mi></mrow><mo id="alg3.50.50.m3.1.1.1" mathsize="90%" xref="alg3.50.50.m3.1.1.1.cmml">=</mo><mn id="alg3.50.50.m3.1.1.3" mathsize="90%" xref="alg3.50.50.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.50.50.m3.1b"><apply id="alg3.50.50.m3.1.1.cmml" xref="alg3.50.50.m3.1.1"><eq id="alg3.50.50.m3.1.1.1.cmml" xref="alg3.50.50.m3.1.1.1"></eq><apply id="alg3.50.50.m3.1.1.2.cmml" xref="alg3.50.50.m3.1.1.2"><times id="alg3.50.50.m3.1.1.2.1.cmml" xref="alg3.50.50.m3.1.1.2.1"></times><ci id="alg3.50.50.m3.1.1.2.2.cmml" xref="alg3.50.50.m3.1.1.2.2">𝑐</ci><ci id="alg3.50.50.m3.1.1.2.3.cmml" xref="alg3.50.50.m3.1.1.2.3">ℎ</ci><ci id="alg3.50.50.m3.1.1.2.4.cmml" xref="alg3.50.50.m3.1.1.2.4">𝑎</ci><ci id="alg3.50.50.m3.1.1.2.5.cmml" xref="alg3.50.50.m3.1.1.2.5">𝑛</ci><ci id="alg3.50.50.m3.1.1.2.6.cmml" xref="alg3.50.50.m3.1.1.2.6">𝑛</ci><ci id="alg3.50.50.m3.1.1.2.7.cmml" xref="alg3.50.50.m3.1.1.2.7">𝑒</ci><ci id="alg3.50.50.m3.1.1.2.8.cmml" xref="alg3.50.50.m3.1.1.2.8">𝑙</ci><ci id="alg3.50.50.m3.1.1.2.9.cmml" xref="alg3.50.50.m3.1.1.2.9">𝑠</ci><ci id="alg3.50.50.m3.1.1.2.10.cmml" xref="alg3.50.50.m3.1.1.2.10">_</ci><ci id="alg3.50.50.m3.1.1.2.11.cmml" xref="alg3.50.50.m3.1.1.2.11">𝑜</ci><ci id="alg3.50.50.m3.1.1.2.12.cmml" xref="alg3.50.50.m3.1.1.2.12">𝑢</ci><ci id="alg3.50.50.m3.1.1.2.13.cmml" xref="alg3.50.50.m3.1.1.2.13">𝑡</ci></apply><cn id="alg3.50.50.m3.1.1.3.cmml" type="integer" xref="alg3.50.50.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.50.50.m3.1c">channels\_out=3</annotation><annotation encoding="application/x-llamapun" id="alg3.50.50.m3.1d">italic_c italic_h italic_a italic_n italic_n italic_e italic_l italic_s _ italic_o italic_u italic_t = 3</annotation></semantics></math><span class="ltx_text" id="alg3.50.50.7" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg3.52.52">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.52.52.1.1.1" style="font-size:90%;">32</span></span><span class="ltx_text" id="alg3.52.52.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.52.52.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.52.52.4" style="font-size:90%;">
</span><math alttext="normal\leftarrow" class="ltx_Math" display="inline" id="alg3.51.51.m1.1"><semantics id="alg3.51.51.m1.1a"><mrow id="alg3.51.51.m1.1.1" xref="alg3.51.51.m1.1.1.cmml"><mrow id="alg3.51.51.m1.1.1.2" xref="alg3.51.51.m1.1.1.2.cmml"><mi id="alg3.51.51.m1.1.1.2.2" mathsize="90%" xref="alg3.51.51.m1.1.1.2.2.cmml">n</mi><mo id="alg3.51.51.m1.1.1.2.1" xref="alg3.51.51.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.51.51.m1.1.1.2.3" mathsize="90%" xref="alg3.51.51.m1.1.1.2.3.cmml">o</mi><mo id="alg3.51.51.m1.1.1.2.1a" xref="alg3.51.51.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.51.51.m1.1.1.2.4" mathsize="90%" xref="alg3.51.51.m1.1.1.2.4.cmml">r</mi><mo id="alg3.51.51.m1.1.1.2.1b" xref="alg3.51.51.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.51.51.m1.1.1.2.5" mathsize="90%" xref="alg3.51.51.m1.1.1.2.5.cmml">m</mi><mo id="alg3.51.51.m1.1.1.2.1c" xref="alg3.51.51.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.51.51.m1.1.1.2.6" mathsize="90%" xref="alg3.51.51.m1.1.1.2.6.cmml">a</mi><mo id="alg3.51.51.m1.1.1.2.1d" xref="alg3.51.51.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.51.51.m1.1.1.2.7" mathsize="90%" xref="alg3.51.51.m1.1.1.2.7.cmml">l</mi></mrow><mo id="alg3.51.51.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg3.51.51.m1.1.1.1.cmml">←</mo><mi id="alg3.51.51.m1.1.1.3" xref="alg3.51.51.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.51.51.m1.1b"><apply id="alg3.51.51.m1.1.1.cmml" xref="alg3.51.51.m1.1.1"><ci id="alg3.51.51.m1.1.1.1.cmml" xref="alg3.51.51.m1.1.1.1">←</ci><apply id="alg3.51.51.m1.1.1.2.cmml" xref="alg3.51.51.m1.1.1.2"><times id="alg3.51.51.m1.1.1.2.1.cmml" xref="alg3.51.51.m1.1.1.2.1"></times><ci id="alg3.51.51.m1.1.1.2.2.cmml" xref="alg3.51.51.m1.1.1.2.2">𝑛</ci><ci id="alg3.51.51.m1.1.1.2.3.cmml" xref="alg3.51.51.m1.1.1.2.3">𝑜</ci><ci id="alg3.51.51.m1.1.1.2.4.cmml" xref="alg3.51.51.m1.1.1.2.4">𝑟</ci><ci id="alg3.51.51.m1.1.1.2.5.cmml" xref="alg3.51.51.m1.1.1.2.5">𝑚</ci><ci id="alg3.51.51.m1.1.1.2.6.cmml" xref="alg3.51.51.m1.1.1.2.6">𝑎</ci><ci id="alg3.51.51.m1.1.1.2.7.cmml" xref="alg3.51.51.m1.1.1.2.7">𝑙</ci></apply><csymbol cd="latexml" id="alg3.51.51.m1.1.1.3.cmml" xref="alg3.51.51.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.51.51.m1.1c">normal\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg3.51.51.m1.1d">italic_n italic_o italic_r italic_m italic_a italic_l ←</annotation></semantics></math><span class="ltx_text" id="alg3.52.52.5" style="font-size:90%;"> Upsample(</span><math alttext="normal" class="ltx_Math" display="inline" id="alg3.52.52.m2.1"><semantics id="alg3.52.52.m2.1a"><mrow id="alg3.52.52.m2.1.1" xref="alg3.52.52.m2.1.1.cmml"><mi id="alg3.52.52.m2.1.1.2" mathsize="90%" xref="alg3.52.52.m2.1.1.2.cmml">n</mi><mo id="alg3.52.52.m2.1.1.1" xref="alg3.52.52.m2.1.1.1.cmml">⁢</mo><mi id="alg3.52.52.m2.1.1.3" mathsize="90%" xref="alg3.52.52.m2.1.1.3.cmml">o</mi><mo id="alg3.52.52.m2.1.1.1a" xref="alg3.52.52.m2.1.1.1.cmml">⁢</mo><mi id="alg3.52.52.m2.1.1.4" mathsize="90%" xref="alg3.52.52.m2.1.1.4.cmml">r</mi><mo id="alg3.52.52.m2.1.1.1b" xref="alg3.52.52.m2.1.1.1.cmml">⁢</mo><mi id="alg3.52.52.m2.1.1.5" mathsize="90%" xref="alg3.52.52.m2.1.1.5.cmml">m</mi><mo id="alg3.52.52.m2.1.1.1c" xref="alg3.52.52.m2.1.1.1.cmml">⁢</mo><mi id="alg3.52.52.m2.1.1.6" mathsize="90%" xref="alg3.52.52.m2.1.1.6.cmml">a</mi><mo id="alg3.52.52.m2.1.1.1d" xref="alg3.52.52.m2.1.1.1.cmml">⁢</mo><mi id="alg3.52.52.m2.1.1.7" mathsize="90%" xref="alg3.52.52.m2.1.1.7.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.52.52.m2.1b"><apply id="alg3.52.52.m2.1.1.cmml" xref="alg3.52.52.m2.1.1"><times id="alg3.52.52.m2.1.1.1.cmml" xref="alg3.52.52.m2.1.1.1"></times><ci id="alg3.52.52.m2.1.1.2.cmml" xref="alg3.52.52.m2.1.1.2">𝑛</ci><ci id="alg3.52.52.m2.1.1.3.cmml" xref="alg3.52.52.m2.1.1.3">𝑜</ci><ci id="alg3.52.52.m2.1.1.4.cmml" xref="alg3.52.52.m2.1.1.4">𝑟</ci><ci id="alg3.52.52.m2.1.1.5.cmml" xref="alg3.52.52.m2.1.1.5">𝑚</ci><ci id="alg3.52.52.m2.1.1.6.cmml" xref="alg3.52.52.m2.1.1.6">𝑎</ci><ci id="alg3.52.52.m2.1.1.7.cmml" xref="alg3.52.52.m2.1.1.7">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.52.52.m2.1c">normal</annotation><annotation encoding="application/x-llamapun" id="alg3.52.52.m2.1d">italic_n italic_o italic_r italic_m italic_a italic_l</annotation></semantics></math><span class="ltx_text" id="alg3.52.52.6" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg3.53.53">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.53.53.1.1.1" style="font-size:90%;">33</span></span><span class="ltx_text" id="alg3.53.53.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.53.53.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.53.53.4" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg3.53.53.5" style="font-size:90%;">return</span><span class="ltx_text" id="alg3.53.53.6" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" id="alg3.53.53.7" style="font-size:90%;">Normalize</span><span class="ltx_text" id="alg3.53.53.8" style="font-size:90%;"> (</span><math alttext="normal" class="ltx_Math" display="inline" id="alg3.53.53.m1.1"><semantics id="alg3.53.53.m1.1a"><mrow id="alg3.53.53.m1.1.1" xref="alg3.53.53.m1.1.1.cmml"><mi id="alg3.53.53.m1.1.1.2" mathsize="90%" xref="alg3.53.53.m1.1.1.2.cmml">n</mi><mo id="alg3.53.53.m1.1.1.1" xref="alg3.53.53.m1.1.1.1.cmml">⁢</mo><mi id="alg3.53.53.m1.1.1.3" mathsize="90%" xref="alg3.53.53.m1.1.1.3.cmml">o</mi><mo id="alg3.53.53.m1.1.1.1a" xref="alg3.53.53.m1.1.1.1.cmml">⁢</mo><mi id="alg3.53.53.m1.1.1.4" mathsize="90%" xref="alg3.53.53.m1.1.1.4.cmml">r</mi><mo id="alg3.53.53.m1.1.1.1b" xref="alg3.53.53.m1.1.1.1.cmml">⁢</mo><mi id="alg3.53.53.m1.1.1.5" mathsize="90%" xref="alg3.53.53.m1.1.1.5.cmml">m</mi><mo id="alg3.53.53.m1.1.1.1c" xref="alg3.53.53.m1.1.1.1.cmml">⁢</mo><mi id="alg3.53.53.m1.1.1.6" mathsize="90%" xref="alg3.53.53.m1.1.1.6.cmml">a</mi><mo id="alg3.53.53.m1.1.1.1d" xref="alg3.53.53.m1.1.1.1.cmml">⁢</mo><mi id="alg3.53.53.m1.1.1.7" mathsize="90%" xref="alg3.53.53.m1.1.1.7.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.53.53.m1.1b"><apply id="alg3.53.53.m1.1.1.cmml" xref="alg3.53.53.m1.1.1"><times id="alg3.53.53.m1.1.1.1.cmml" xref="alg3.53.53.m1.1.1.1"></times><ci id="alg3.53.53.m1.1.1.2.cmml" xref="alg3.53.53.m1.1.1.2">𝑛</ci><ci id="alg3.53.53.m1.1.1.3.cmml" xref="alg3.53.53.m1.1.1.3">𝑜</ci><ci id="alg3.53.53.m1.1.1.4.cmml" xref="alg3.53.53.m1.1.1.4">𝑟</ci><ci id="alg3.53.53.m1.1.1.5.cmml" xref="alg3.53.53.m1.1.1.5">𝑚</ci><ci id="alg3.53.53.m1.1.1.6.cmml" xref="alg3.53.53.m1.1.1.6">𝑎</ci><ci id="alg3.53.53.m1.1.1.7.cmml" xref="alg3.53.53.m1.1.1.7">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.53.53.m1.1c">normal</annotation><annotation encoding="application/x-llamapun" id="alg3.53.53.m1.1d">italic_n italic_o italic_r italic_m italic_a italic_l</annotation></semantics></math><span class="ltx_text" id="alg3.53.53.9" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg3.60.72">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.72.1.1.1" style="font-size:90%;">34</span></span><span class="ltx_text" id="alg3.60.72.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.72.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.60.72.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.60.73">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.73.1.1.1" style="font-size:90%;">35</span></span>
</div>
<div class="ltx_listingline" id="alg3.54.54">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.54.54.2.1.1" style="font-size:90%;">36</span></span><span class="ltx_text ltx_font_bold" id="alg3.54.54.3" style="font-size:90%;">Function</span><span class="ltx_text" id="alg3.54.54.4" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg3.54.54.1" style="font-size:90%;"><span class="ltx_text ltx_font_typewriter ltx_font_upright" id="alg3.54.54.1.1">Normalize</span> (<math alttext="normal" class="ltx_Math" display="inline" id="alg3.54.54.1.m1.1"><semantics id="alg3.54.54.1.m1.1a"><mrow id="alg3.54.54.1.m1.1.1" xref="alg3.54.54.1.m1.1.1.cmml"><mi id="alg3.54.54.1.m1.1.1.2" xref="alg3.54.54.1.m1.1.1.2.cmml">n</mi><mo id="alg3.54.54.1.m1.1.1.1" xref="alg3.54.54.1.m1.1.1.1.cmml">⁢</mo><mi id="alg3.54.54.1.m1.1.1.3" xref="alg3.54.54.1.m1.1.1.3.cmml">o</mi><mo id="alg3.54.54.1.m1.1.1.1a" xref="alg3.54.54.1.m1.1.1.1.cmml">⁢</mo><mi id="alg3.54.54.1.m1.1.1.4" xref="alg3.54.54.1.m1.1.1.4.cmml">r</mi><mo id="alg3.54.54.1.m1.1.1.1b" xref="alg3.54.54.1.m1.1.1.1.cmml">⁢</mo><mi id="alg3.54.54.1.m1.1.1.5" xref="alg3.54.54.1.m1.1.1.5.cmml">m</mi><mo id="alg3.54.54.1.m1.1.1.1c" xref="alg3.54.54.1.m1.1.1.1.cmml">⁢</mo><mi id="alg3.54.54.1.m1.1.1.6" xref="alg3.54.54.1.m1.1.1.6.cmml">a</mi><mo id="alg3.54.54.1.m1.1.1.1d" xref="alg3.54.54.1.m1.1.1.1.cmml">⁢</mo><mi id="alg3.54.54.1.m1.1.1.7" xref="alg3.54.54.1.m1.1.1.7.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.54.54.1.m1.1b"><apply id="alg3.54.54.1.m1.1.1.cmml" xref="alg3.54.54.1.m1.1.1"><times id="alg3.54.54.1.m1.1.1.1.cmml" xref="alg3.54.54.1.m1.1.1.1"></times><ci id="alg3.54.54.1.m1.1.1.2.cmml" xref="alg3.54.54.1.m1.1.1.2">𝑛</ci><ci id="alg3.54.54.1.m1.1.1.3.cmml" xref="alg3.54.54.1.m1.1.1.3">𝑜</ci><ci id="alg3.54.54.1.m1.1.1.4.cmml" xref="alg3.54.54.1.m1.1.1.4">𝑟</ci><ci id="alg3.54.54.1.m1.1.1.5.cmml" xref="alg3.54.54.1.m1.1.1.5">𝑚</ci><ci id="alg3.54.54.1.m1.1.1.6.cmml" xref="alg3.54.54.1.m1.1.1.6">𝑎</ci><ci id="alg3.54.54.1.m1.1.1.7.cmml" xref="alg3.54.54.1.m1.1.1.7">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.54.54.1.m1.1c">normal</annotation><annotation encoding="application/x-llamapun" id="alg3.54.54.1.m1.1d">italic_n italic_o italic_r italic_m italic_a italic_l</annotation></semantics></math>)</em><span class="ltx_text ltx_font_bold" id="alg3.54.54.5" style="font-size:90%;">:</span>
</div>
<div class="ltx_listingline" id="alg3.56.56">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.56.56.1.1.1" style="font-size:90%;">37</span></span><span class="ltx_text" id="alg3.56.56.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.56.56.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.56.56.4" style="font-size:90%;">
</span><math alttext="norm\_x,norm\_y,norm\_z\leftarrow" class="ltx_Math" display="inline" id="alg3.55.55.m1.3"><semantics id="alg3.55.55.m1.3a"><mrow id="alg3.55.55.m1.3.3" xref="alg3.55.55.m1.3.3.cmml"><mrow id="alg3.55.55.m1.3.3.3.3" xref="alg3.55.55.m1.3.3.3.4.cmml"><mrow id="alg3.55.55.m1.1.1.1.1.1" xref="alg3.55.55.m1.1.1.1.1.1.cmml"><mi id="alg3.55.55.m1.1.1.1.1.1.2" mathsize="90%" xref="alg3.55.55.m1.1.1.1.1.1.2.cmml">n</mi><mo id="alg3.55.55.m1.1.1.1.1.1.1" xref="alg3.55.55.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg3.55.55.m1.1.1.1.1.1.3" mathsize="90%" xref="alg3.55.55.m1.1.1.1.1.1.3.cmml">o</mi><mo id="alg3.55.55.m1.1.1.1.1.1.1a" xref="alg3.55.55.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg3.55.55.m1.1.1.1.1.1.4" mathsize="90%" xref="alg3.55.55.m1.1.1.1.1.1.4.cmml">r</mi><mo id="alg3.55.55.m1.1.1.1.1.1.1b" xref="alg3.55.55.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg3.55.55.m1.1.1.1.1.1.5" mathsize="90%" xref="alg3.55.55.m1.1.1.1.1.1.5.cmml">m</mi><mo id="alg3.55.55.m1.1.1.1.1.1.1c" xref="alg3.55.55.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg3.55.55.m1.1.1.1.1.1.6" mathsize="90%" mathvariant="normal" xref="alg3.55.55.m1.1.1.1.1.1.6.cmml">_</mi><mo id="alg3.55.55.m1.1.1.1.1.1.1d" xref="alg3.55.55.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg3.55.55.m1.1.1.1.1.1.7" mathsize="90%" xref="alg3.55.55.m1.1.1.1.1.1.7.cmml">x</mi></mrow><mo id="alg3.55.55.m1.3.3.3.3.4" mathsize="90%" xref="alg3.55.55.m1.3.3.3.4.cmml">,</mo><mrow id="alg3.55.55.m1.2.2.2.2.2" xref="alg3.55.55.m1.2.2.2.2.2.cmml"><mi id="alg3.55.55.m1.2.2.2.2.2.2" mathsize="90%" xref="alg3.55.55.m1.2.2.2.2.2.2.cmml">n</mi><mo id="alg3.55.55.m1.2.2.2.2.2.1" xref="alg3.55.55.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg3.55.55.m1.2.2.2.2.2.3" mathsize="90%" xref="alg3.55.55.m1.2.2.2.2.2.3.cmml">o</mi><mo id="alg3.55.55.m1.2.2.2.2.2.1a" xref="alg3.55.55.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg3.55.55.m1.2.2.2.2.2.4" mathsize="90%" xref="alg3.55.55.m1.2.2.2.2.2.4.cmml">r</mi><mo id="alg3.55.55.m1.2.2.2.2.2.1b" xref="alg3.55.55.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg3.55.55.m1.2.2.2.2.2.5" mathsize="90%" xref="alg3.55.55.m1.2.2.2.2.2.5.cmml">m</mi><mo id="alg3.55.55.m1.2.2.2.2.2.1c" xref="alg3.55.55.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg3.55.55.m1.2.2.2.2.2.6" mathsize="90%" mathvariant="normal" xref="alg3.55.55.m1.2.2.2.2.2.6.cmml">_</mi><mo id="alg3.55.55.m1.2.2.2.2.2.1d" xref="alg3.55.55.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg3.55.55.m1.2.2.2.2.2.7" mathsize="90%" xref="alg3.55.55.m1.2.2.2.2.2.7.cmml">y</mi></mrow><mo id="alg3.55.55.m1.3.3.3.3.5" mathsize="90%" xref="alg3.55.55.m1.3.3.3.4.cmml">,</mo><mrow id="alg3.55.55.m1.3.3.3.3.3" xref="alg3.55.55.m1.3.3.3.3.3.cmml"><mi id="alg3.55.55.m1.3.3.3.3.3.2" mathsize="90%" xref="alg3.55.55.m1.3.3.3.3.3.2.cmml">n</mi><mo id="alg3.55.55.m1.3.3.3.3.3.1" xref="alg3.55.55.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg3.55.55.m1.3.3.3.3.3.3" mathsize="90%" xref="alg3.55.55.m1.3.3.3.3.3.3.cmml">o</mi><mo id="alg3.55.55.m1.3.3.3.3.3.1a" xref="alg3.55.55.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg3.55.55.m1.3.3.3.3.3.4" mathsize="90%" xref="alg3.55.55.m1.3.3.3.3.3.4.cmml">r</mi><mo id="alg3.55.55.m1.3.3.3.3.3.1b" xref="alg3.55.55.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg3.55.55.m1.3.3.3.3.3.5" mathsize="90%" xref="alg3.55.55.m1.3.3.3.3.3.5.cmml">m</mi><mo id="alg3.55.55.m1.3.3.3.3.3.1c" xref="alg3.55.55.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg3.55.55.m1.3.3.3.3.3.6" mathsize="90%" mathvariant="normal" xref="alg3.55.55.m1.3.3.3.3.3.6.cmml">_</mi><mo id="alg3.55.55.m1.3.3.3.3.3.1d" xref="alg3.55.55.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="alg3.55.55.m1.3.3.3.3.3.7" mathsize="90%" xref="alg3.55.55.m1.3.3.3.3.3.7.cmml">z</mi></mrow></mrow><mo id="alg3.55.55.m1.3.3.4" mathsize="90%" stretchy="false" xref="alg3.55.55.m1.3.3.4.cmml">←</mo><mi id="alg3.55.55.m1.3.3.5" xref="alg3.55.55.m1.3.3.5.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.55.55.m1.3b"><apply id="alg3.55.55.m1.3.3.cmml" xref="alg3.55.55.m1.3.3"><ci id="alg3.55.55.m1.3.3.4.cmml" xref="alg3.55.55.m1.3.3.4">←</ci><list id="alg3.55.55.m1.3.3.3.4.cmml" xref="alg3.55.55.m1.3.3.3.3"><apply id="alg3.55.55.m1.1.1.1.1.1.cmml" xref="alg3.55.55.m1.1.1.1.1.1"><times id="alg3.55.55.m1.1.1.1.1.1.1.cmml" xref="alg3.55.55.m1.1.1.1.1.1.1"></times><ci id="alg3.55.55.m1.1.1.1.1.1.2.cmml" xref="alg3.55.55.m1.1.1.1.1.1.2">𝑛</ci><ci id="alg3.55.55.m1.1.1.1.1.1.3.cmml" xref="alg3.55.55.m1.1.1.1.1.1.3">𝑜</ci><ci id="alg3.55.55.m1.1.1.1.1.1.4.cmml" xref="alg3.55.55.m1.1.1.1.1.1.4">𝑟</ci><ci id="alg3.55.55.m1.1.1.1.1.1.5.cmml" xref="alg3.55.55.m1.1.1.1.1.1.5">𝑚</ci><ci id="alg3.55.55.m1.1.1.1.1.1.6.cmml" xref="alg3.55.55.m1.1.1.1.1.1.6">_</ci><ci id="alg3.55.55.m1.1.1.1.1.1.7.cmml" xref="alg3.55.55.m1.1.1.1.1.1.7">𝑥</ci></apply><apply id="alg3.55.55.m1.2.2.2.2.2.cmml" xref="alg3.55.55.m1.2.2.2.2.2"><times id="alg3.55.55.m1.2.2.2.2.2.1.cmml" xref="alg3.55.55.m1.2.2.2.2.2.1"></times><ci id="alg3.55.55.m1.2.2.2.2.2.2.cmml" xref="alg3.55.55.m1.2.2.2.2.2.2">𝑛</ci><ci id="alg3.55.55.m1.2.2.2.2.2.3.cmml" xref="alg3.55.55.m1.2.2.2.2.2.3">𝑜</ci><ci id="alg3.55.55.m1.2.2.2.2.2.4.cmml" xref="alg3.55.55.m1.2.2.2.2.2.4">𝑟</ci><ci id="alg3.55.55.m1.2.2.2.2.2.5.cmml" xref="alg3.55.55.m1.2.2.2.2.2.5">𝑚</ci><ci id="alg3.55.55.m1.2.2.2.2.2.6.cmml" xref="alg3.55.55.m1.2.2.2.2.2.6">_</ci><ci id="alg3.55.55.m1.2.2.2.2.2.7.cmml" xref="alg3.55.55.m1.2.2.2.2.2.7">𝑦</ci></apply><apply id="alg3.55.55.m1.3.3.3.3.3.cmml" xref="alg3.55.55.m1.3.3.3.3.3"><times id="alg3.55.55.m1.3.3.3.3.3.1.cmml" xref="alg3.55.55.m1.3.3.3.3.3.1"></times><ci id="alg3.55.55.m1.3.3.3.3.3.2.cmml" xref="alg3.55.55.m1.3.3.3.3.3.2">𝑛</ci><ci id="alg3.55.55.m1.3.3.3.3.3.3.cmml" xref="alg3.55.55.m1.3.3.3.3.3.3">𝑜</ci><ci id="alg3.55.55.m1.3.3.3.3.3.4.cmml" xref="alg3.55.55.m1.3.3.3.3.3.4">𝑟</ci><ci id="alg3.55.55.m1.3.3.3.3.3.5.cmml" xref="alg3.55.55.m1.3.3.3.3.3.5">𝑚</ci><ci id="alg3.55.55.m1.3.3.3.3.3.6.cmml" xref="alg3.55.55.m1.3.3.3.3.3.6">_</ci><ci id="alg3.55.55.m1.3.3.3.3.3.7.cmml" xref="alg3.55.55.m1.3.3.3.3.3.7">𝑧</ci></apply></list><csymbol cd="latexml" id="alg3.55.55.m1.3.3.5.cmml" xref="alg3.55.55.m1.3.3.5">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.55.55.m1.3c">norm\_x,norm\_y,norm\_z\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg3.55.55.m1.3d">italic_n italic_o italic_r italic_m _ italic_x , italic_n italic_o italic_r italic_m _ italic_y , italic_n italic_o italic_r italic_m _ italic_z ←</annotation></semantics></math><span class="ltx_text" id="alg3.56.56.5" style="font-size:90%;"> SplitChannels(</span><math alttext="normal" class="ltx_Math" display="inline" id="alg3.56.56.m2.1"><semantics id="alg3.56.56.m2.1a"><mrow id="alg3.56.56.m2.1.1" xref="alg3.56.56.m2.1.1.cmml"><mi id="alg3.56.56.m2.1.1.2" mathsize="90%" xref="alg3.56.56.m2.1.1.2.cmml">n</mi><mo id="alg3.56.56.m2.1.1.1" xref="alg3.56.56.m2.1.1.1.cmml">⁢</mo><mi id="alg3.56.56.m2.1.1.3" mathsize="90%" xref="alg3.56.56.m2.1.1.3.cmml">o</mi><mo id="alg3.56.56.m2.1.1.1a" xref="alg3.56.56.m2.1.1.1.cmml">⁢</mo><mi id="alg3.56.56.m2.1.1.4" mathsize="90%" xref="alg3.56.56.m2.1.1.4.cmml">r</mi><mo id="alg3.56.56.m2.1.1.1b" xref="alg3.56.56.m2.1.1.1.cmml">⁢</mo><mi id="alg3.56.56.m2.1.1.5" mathsize="90%" xref="alg3.56.56.m2.1.1.5.cmml">m</mi><mo id="alg3.56.56.m2.1.1.1c" xref="alg3.56.56.m2.1.1.1.cmml">⁢</mo><mi id="alg3.56.56.m2.1.1.6" mathsize="90%" xref="alg3.56.56.m2.1.1.6.cmml">a</mi><mo id="alg3.56.56.m2.1.1.1d" xref="alg3.56.56.m2.1.1.1.cmml">⁢</mo><mi id="alg3.56.56.m2.1.1.7" mathsize="90%" xref="alg3.56.56.m2.1.1.7.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.56.56.m2.1b"><apply id="alg3.56.56.m2.1.1.cmml" xref="alg3.56.56.m2.1.1"><times id="alg3.56.56.m2.1.1.1.cmml" xref="alg3.56.56.m2.1.1.1"></times><ci id="alg3.56.56.m2.1.1.2.cmml" xref="alg3.56.56.m2.1.1.2">𝑛</ci><ci id="alg3.56.56.m2.1.1.3.cmml" xref="alg3.56.56.m2.1.1.3">𝑜</ci><ci id="alg3.56.56.m2.1.1.4.cmml" xref="alg3.56.56.m2.1.1.4">𝑟</ci><ci id="alg3.56.56.m2.1.1.5.cmml" xref="alg3.56.56.m2.1.1.5">𝑚</ci><ci id="alg3.56.56.m2.1.1.6.cmml" xref="alg3.56.56.m2.1.1.6">𝑎</ci><ci id="alg3.56.56.m2.1.1.7.cmml" xref="alg3.56.56.m2.1.1.7">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.56.56.m2.1c">normal</annotation><annotation encoding="application/x-llamapun" id="alg3.56.56.m2.1d">italic_n italic_o italic_r italic_m italic_a italic_l</annotation></semantics></math><span class="ltx_text" id="alg3.56.56.6" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg3.57.57">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.57.57.1.1.1" style="font-size:90%;">38</span></span><span class="ltx_text" id="alg3.57.57.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.57.57.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.57.57.4" style="font-size:90%;">
</span><math alttext="norm\leftarrow\sqrt{norm\_x^{2}+norm\_y^{2}+norm\_z^{2}}+\epsilon" class="ltx_Math" display="inline" id="alg3.57.57.m1.1"><semantics id="alg3.57.57.m1.1a"><mrow id="alg3.57.57.m1.1.1" xref="alg3.57.57.m1.1.1.cmml"><mrow id="alg3.57.57.m1.1.1.2" xref="alg3.57.57.m1.1.1.2.cmml"><mi id="alg3.57.57.m1.1.1.2.2" mathsize="90%" xref="alg3.57.57.m1.1.1.2.2.cmml">n</mi><mo id="alg3.57.57.m1.1.1.2.1" xref="alg3.57.57.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.2.3" mathsize="90%" xref="alg3.57.57.m1.1.1.2.3.cmml">o</mi><mo id="alg3.57.57.m1.1.1.2.1a" xref="alg3.57.57.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.2.4" mathsize="90%" xref="alg3.57.57.m1.1.1.2.4.cmml">r</mi><mo id="alg3.57.57.m1.1.1.2.1b" xref="alg3.57.57.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.2.5" mathsize="90%" xref="alg3.57.57.m1.1.1.2.5.cmml">m</mi></mrow><mo id="alg3.57.57.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg3.57.57.m1.1.1.1.cmml">←</mo><mrow id="alg3.57.57.m1.1.1.3" xref="alg3.57.57.m1.1.1.3.cmml"><msqrt id="alg3.57.57.m1.1.1.3.2" xref="alg3.57.57.m1.1.1.3.2.cmml"><mrow id="alg3.57.57.m1.1.1.3.2.2" xref="alg3.57.57.m1.1.1.3.2.2.cmml"><mrow id="alg3.57.57.m1.1.1.3.2.2.2" xref="alg3.57.57.m1.1.1.3.2.2.2.cmml"><mi id="alg3.57.57.m1.1.1.3.2.2.2.2" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.2.2.cmml">n</mi><mo id="alg3.57.57.m1.1.1.3.2.2.2.1" xref="alg3.57.57.m1.1.1.3.2.2.2.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.3.2.2.2.3" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.2.3.cmml">o</mi><mo id="alg3.57.57.m1.1.1.3.2.2.2.1a" xref="alg3.57.57.m1.1.1.3.2.2.2.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.3.2.2.2.4" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.2.4.cmml">r</mi><mo id="alg3.57.57.m1.1.1.3.2.2.2.1b" xref="alg3.57.57.m1.1.1.3.2.2.2.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.3.2.2.2.5" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.2.5.cmml">m</mi><mo id="alg3.57.57.m1.1.1.3.2.2.2.1c" xref="alg3.57.57.m1.1.1.3.2.2.2.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.3.2.2.2.6" mathsize="90%" mathvariant="normal" xref="alg3.57.57.m1.1.1.3.2.2.2.6.cmml">_</mi><mo id="alg3.57.57.m1.1.1.3.2.2.2.1d" xref="alg3.57.57.m1.1.1.3.2.2.2.1.cmml">⁢</mo><msup id="alg3.57.57.m1.1.1.3.2.2.2.7" xref="alg3.57.57.m1.1.1.3.2.2.2.7.cmml"><mi id="alg3.57.57.m1.1.1.3.2.2.2.7.2" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.2.7.2.cmml">x</mi><mn id="alg3.57.57.m1.1.1.3.2.2.2.7.3" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.2.7.3.cmml">2</mn></msup></mrow><mo id="alg3.57.57.m1.1.1.3.2.2.1" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.1.cmml">+</mo><mrow id="alg3.57.57.m1.1.1.3.2.2.3" xref="alg3.57.57.m1.1.1.3.2.2.3.cmml"><mi id="alg3.57.57.m1.1.1.3.2.2.3.2" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.3.2.cmml">n</mi><mo id="alg3.57.57.m1.1.1.3.2.2.3.1" xref="alg3.57.57.m1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.3.2.2.3.3" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.3.3.cmml">o</mi><mo id="alg3.57.57.m1.1.1.3.2.2.3.1a" xref="alg3.57.57.m1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.3.2.2.3.4" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.3.4.cmml">r</mi><mo id="alg3.57.57.m1.1.1.3.2.2.3.1b" xref="alg3.57.57.m1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.3.2.2.3.5" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.3.5.cmml">m</mi><mo id="alg3.57.57.m1.1.1.3.2.2.3.1c" xref="alg3.57.57.m1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.3.2.2.3.6" mathsize="90%" mathvariant="normal" xref="alg3.57.57.m1.1.1.3.2.2.3.6.cmml">_</mi><mo id="alg3.57.57.m1.1.1.3.2.2.3.1d" xref="alg3.57.57.m1.1.1.3.2.2.3.1.cmml">⁢</mo><msup id="alg3.57.57.m1.1.1.3.2.2.3.7" xref="alg3.57.57.m1.1.1.3.2.2.3.7.cmml"><mi id="alg3.57.57.m1.1.1.3.2.2.3.7.2" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.3.7.2.cmml">y</mi><mn id="alg3.57.57.m1.1.1.3.2.2.3.7.3" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.3.7.3.cmml">2</mn></msup></mrow><mo id="alg3.57.57.m1.1.1.3.2.2.1a" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.1.cmml">+</mo><mrow id="alg3.57.57.m1.1.1.3.2.2.4" xref="alg3.57.57.m1.1.1.3.2.2.4.cmml"><mi id="alg3.57.57.m1.1.1.3.2.2.4.2" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.4.2.cmml">n</mi><mo id="alg3.57.57.m1.1.1.3.2.2.4.1" xref="alg3.57.57.m1.1.1.3.2.2.4.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.3.2.2.4.3" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.4.3.cmml">o</mi><mo id="alg3.57.57.m1.1.1.3.2.2.4.1a" xref="alg3.57.57.m1.1.1.3.2.2.4.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.3.2.2.4.4" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.4.4.cmml">r</mi><mo id="alg3.57.57.m1.1.1.3.2.2.4.1b" xref="alg3.57.57.m1.1.1.3.2.2.4.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.3.2.2.4.5" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.4.5.cmml">m</mi><mo id="alg3.57.57.m1.1.1.3.2.2.4.1c" xref="alg3.57.57.m1.1.1.3.2.2.4.1.cmml">⁢</mo><mi id="alg3.57.57.m1.1.1.3.2.2.4.6" mathsize="90%" mathvariant="normal" xref="alg3.57.57.m1.1.1.3.2.2.4.6.cmml">_</mi><mo id="alg3.57.57.m1.1.1.3.2.2.4.1d" xref="alg3.57.57.m1.1.1.3.2.2.4.1.cmml">⁢</mo><msup id="alg3.57.57.m1.1.1.3.2.2.4.7" xref="alg3.57.57.m1.1.1.3.2.2.4.7.cmml"><mi id="alg3.57.57.m1.1.1.3.2.2.4.7.2" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.4.7.2.cmml">z</mi><mn id="alg3.57.57.m1.1.1.3.2.2.4.7.3" mathsize="90%" xref="alg3.57.57.m1.1.1.3.2.2.4.7.3.cmml">2</mn></msup></mrow></mrow></msqrt><mo id="alg3.57.57.m1.1.1.3.1" mathsize="90%" xref="alg3.57.57.m1.1.1.3.1.cmml">+</mo><mi id="alg3.57.57.m1.1.1.3.3" mathsize="90%" xref="alg3.57.57.m1.1.1.3.3.cmml">ϵ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.57.57.m1.1b"><apply id="alg3.57.57.m1.1.1.cmml" xref="alg3.57.57.m1.1.1"><ci id="alg3.57.57.m1.1.1.1.cmml" xref="alg3.57.57.m1.1.1.1">←</ci><apply id="alg3.57.57.m1.1.1.2.cmml" xref="alg3.57.57.m1.1.1.2"><times id="alg3.57.57.m1.1.1.2.1.cmml" xref="alg3.57.57.m1.1.1.2.1"></times><ci id="alg3.57.57.m1.1.1.2.2.cmml" xref="alg3.57.57.m1.1.1.2.2">𝑛</ci><ci id="alg3.57.57.m1.1.1.2.3.cmml" xref="alg3.57.57.m1.1.1.2.3">𝑜</ci><ci id="alg3.57.57.m1.1.1.2.4.cmml" xref="alg3.57.57.m1.1.1.2.4">𝑟</ci><ci id="alg3.57.57.m1.1.1.2.5.cmml" xref="alg3.57.57.m1.1.1.2.5">𝑚</ci></apply><apply id="alg3.57.57.m1.1.1.3.cmml" xref="alg3.57.57.m1.1.1.3"><plus id="alg3.57.57.m1.1.1.3.1.cmml" xref="alg3.57.57.m1.1.1.3.1"></plus><apply id="alg3.57.57.m1.1.1.3.2.cmml" xref="alg3.57.57.m1.1.1.3.2"><root id="alg3.57.57.m1.1.1.3.2a.cmml" xref="alg3.57.57.m1.1.1.3.2"></root><apply id="alg3.57.57.m1.1.1.3.2.2.cmml" xref="alg3.57.57.m1.1.1.3.2.2"><plus id="alg3.57.57.m1.1.1.3.2.2.1.cmml" xref="alg3.57.57.m1.1.1.3.2.2.1"></plus><apply id="alg3.57.57.m1.1.1.3.2.2.2.cmml" xref="alg3.57.57.m1.1.1.3.2.2.2"><times id="alg3.57.57.m1.1.1.3.2.2.2.1.cmml" xref="alg3.57.57.m1.1.1.3.2.2.2.1"></times><ci id="alg3.57.57.m1.1.1.3.2.2.2.2.cmml" xref="alg3.57.57.m1.1.1.3.2.2.2.2">𝑛</ci><ci id="alg3.57.57.m1.1.1.3.2.2.2.3.cmml" xref="alg3.57.57.m1.1.1.3.2.2.2.3">𝑜</ci><ci id="alg3.57.57.m1.1.1.3.2.2.2.4.cmml" xref="alg3.57.57.m1.1.1.3.2.2.2.4">𝑟</ci><ci id="alg3.57.57.m1.1.1.3.2.2.2.5.cmml" xref="alg3.57.57.m1.1.1.3.2.2.2.5">𝑚</ci><ci id="alg3.57.57.m1.1.1.3.2.2.2.6.cmml" xref="alg3.57.57.m1.1.1.3.2.2.2.6">_</ci><apply id="alg3.57.57.m1.1.1.3.2.2.2.7.cmml" xref="alg3.57.57.m1.1.1.3.2.2.2.7"><csymbol cd="ambiguous" id="alg3.57.57.m1.1.1.3.2.2.2.7.1.cmml" xref="alg3.57.57.m1.1.1.3.2.2.2.7">superscript</csymbol><ci id="alg3.57.57.m1.1.1.3.2.2.2.7.2.cmml" xref="alg3.57.57.m1.1.1.3.2.2.2.7.2">𝑥</ci><cn id="alg3.57.57.m1.1.1.3.2.2.2.7.3.cmml" type="integer" xref="alg3.57.57.m1.1.1.3.2.2.2.7.3">2</cn></apply></apply><apply id="alg3.57.57.m1.1.1.3.2.2.3.cmml" xref="alg3.57.57.m1.1.1.3.2.2.3"><times id="alg3.57.57.m1.1.1.3.2.2.3.1.cmml" xref="alg3.57.57.m1.1.1.3.2.2.3.1"></times><ci id="alg3.57.57.m1.1.1.3.2.2.3.2.cmml" xref="alg3.57.57.m1.1.1.3.2.2.3.2">𝑛</ci><ci id="alg3.57.57.m1.1.1.3.2.2.3.3.cmml" xref="alg3.57.57.m1.1.1.3.2.2.3.3">𝑜</ci><ci id="alg3.57.57.m1.1.1.3.2.2.3.4.cmml" xref="alg3.57.57.m1.1.1.3.2.2.3.4">𝑟</ci><ci id="alg3.57.57.m1.1.1.3.2.2.3.5.cmml" xref="alg3.57.57.m1.1.1.3.2.2.3.5">𝑚</ci><ci id="alg3.57.57.m1.1.1.3.2.2.3.6.cmml" xref="alg3.57.57.m1.1.1.3.2.2.3.6">_</ci><apply id="alg3.57.57.m1.1.1.3.2.2.3.7.cmml" xref="alg3.57.57.m1.1.1.3.2.2.3.7"><csymbol cd="ambiguous" id="alg3.57.57.m1.1.1.3.2.2.3.7.1.cmml" xref="alg3.57.57.m1.1.1.3.2.2.3.7">superscript</csymbol><ci id="alg3.57.57.m1.1.1.3.2.2.3.7.2.cmml" xref="alg3.57.57.m1.1.1.3.2.2.3.7.2">𝑦</ci><cn id="alg3.57.57.m1.1.1.3.2.2.3.7.3.cmml" type="integer" xref="alg3.57.57.m1.1.1.3.2.2.3.7.3">2</cn></apply></apply><apply id="alg3.57.57.m1.1.1.3.2.2.4.cmml" xref="alg3.57.57.m1.1.1.3.2.2.4"><times id="alg3.57.57.m1.1.1.3.2.2.4.1.cmml" xref="alg3.57.57.m1.1.1.3.2.2.4.1"></times><ci id="alg3.57.57.m1.1.1.3.2.2.4.2.cmml" xref="alg3.57.57.m1.1.1.3.2.2.4.2">𝑛</ci><ci id="alg3.57.57.m1.1.1.3.2.2.4.3.cmml" xref="alg3.57.57.m1.1.1.3.2.2.4.3">𝑜</ci><ci id="alg3.57.57.m1.1.1.3.2.2.4.4.cmml" xref="alg3.57.57.m1.1.1.3.2.2.4.4">𝑟</ci><ci id="alg3.57.57.m1.1.1.3.2.2.4.5.cmml" xref="alg3.57.57.m1.1.1.3.2.2.4.5">𝑚</ci><ci id="alg3.57.57.m1.1.1.3.2.2.4.6.cmml" xref="alg3.57.57.m1.1.1.3.2.2.4.6">_</ci><apply id="alg3.57.57.m1.1.1.3.2.2.4.7.cmml" xref="alg3.57.57.m1.1.1.3.2.2.4.7"><csymbol cd="ambiguous" id="alg3.57.57.m1.1.1.3.2.2.4.7.1.cmml" xref="alg3.57.57.m1.1.1.3.2.2.4.7">superscript</csymbol><ci id="alg3.57.57.m1.1.1.3.2.2.4.7.2.cmml" xref="alg3.57.57.m1.1.1.3.2.2.4.7.2">𝑧</ci><cn id="alg3.57.57.m1.1.1.3.2.2.4.7.3.cmml" type="integer" xref="alg3.57.57.m1.1.1.3.2.2.4.7.3">2</cn></apply></apply></apply></apply><ci id="alg3.57.57.m1.1.1.3.3.cmml" xref="alg3.57.57.m1.1.1.3.3">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.57.57.m1.1c">norm\leftarrow\sqrt{norm\_x^{2}+norm\_y^{2}+norm\_z^{2}}+\epsilon</annotation><annotation encoding="application/x-llamapun" id="alg3.57.57.m1.1d">italic_n italic_o italic_r italic_m ← square-root start_ARG italic_n italic_o italic_r italic_m _ italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_n italic_o italic_r italic_m _ italic_y start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_n italic_o italic_r italic_m _ italic_z start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG + italic_ϵ</annotation></semantics></math><span class="ltx_text" id="alg3.57.57.5" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg3.60.60">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.60.1.1.1" style="font-size:90%;">39</span></span><span class="ltx_text" id="alg3.60.60.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.60.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.60.60.4" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg3.60.60.5" style="font-size:90%;">return</span><span class="ltx_text" id="alg3.60.60.6" style="font-size:90%;"> Concatenate(</span><math alttext="norm\_x/norm" class="ltx_Math" display="inline" id="alg3.58.58.m1.1"><semantics id="alg3.58.58.m1.1a"><mrow id="alg3.58.58.m1.1.1" xref="alg3.58.58.m1.1.1.cmml"><mrow id="alg3.58.58.m1.1.1.2" xref="alg3.58.58.m1.1.1.2.cmml"><mrow id="alg3.58.58.m1.1.1.2.2" xref="alg3.58.58.m1.1.1.2.2.cmml"><mi id="alg3.58.58.m1.1.1.2.2.2" mathsize="90%" xref="alg3.58.58.m1.1.1.2.2.2.cmml">n</mi><mo id="alg3.58.58.m1.1.1.2.2.1" xref="alg3.58.58.m1.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.58.58.m1.1.1.2.2.3" mathsize="90%" xref="alg3.58.58.m1.1.1.2.2.3.cmml">o</mi><mo id="alg3.58.58.m1.1.1.2.2.1a" xref="alg3.58.58.m1.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.58.58.m1.1.1.2.2.4" mathsize="90%" xref="alg3.58.58.m1.1.1.2.2.4.cmml">r</mi><mo id="alg3.58.58.m1.1.1.2.2.1b" xref="alg3.58.58.m1.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.58.58.m1.1.1.2.2.5" mathsize="90%" xref="alg3.58.58.m1.1.1.2.2.5.cmml">m</mi><mo id="alg3.58.58.m1.1.1.2.2.1c" xref="alg3.58.58.m1.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.58.58.m1.1.1.2.2.6" mathsize="90%" mathvariant="normal" xref="alg3.58.58.m1.1.1.2.2.6.cmml">_</mi><mo id="alg3.58.58.m1.1.1.2.2.1d" xref="alg3.58.58.m1.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.58.58.m1.1.1.2.2.7" mathsize="90%" xref="alg3.58.58.m1.1.1.2.2.7.cmml">x</mi></mrow><mo id="alg3.58.58.m1.1.1.2.1" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg3.58.58.m1.1.1.2.1.cmml">/</mo><mi id="alg3.58.58.m1.1.1.2.3" mathsize="90%" xref="alg3.58.58.m1.1.1.2.3.cmml">n</mi></mrow><mo id="alg3.58.58.m1.1.1.1" xref="alg3.58.58.m1.1.1.1.cmml">⁢</mo><mi id="alg3.58.58.m1.1.1.3" mathsize="90%" xref="alg3.58.58.m1.1.1.3.cmml">o</mi><mo id="alg3.58.58.m1.1.1.1a" xref="alg3.58.58.m1.1.1.1.cmml">⁢</mo><mi id="alg3.58.58.m1.1.1.4" mathsize="90%" xref="alg3.58.58.m1.1.1.4.cmml">r</mi><mo id="alg3.58.58.m1.1.1.1b" xref="alg3.58.58.m1.1.1.1.cmml">⁢</mo><mi id="alg3.58.58.m1.1.1.5" mathsize="90%" xref="alg3.58.58.m1.1.1.5.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.58.58.m1.1b"><apply id="alg3.58.58.m1.1.1.cmml" xref="alg3.58.58.m1.1.1"><times id="alg3.58.58.m1.1.1.1.cmml" xref="alg3.58.58.m1.1.1.1"></times><apply id="alg3.58.58.m1.1.1.2.cmml" xref="alg3.58.58.m1.1.1.2"><divide id="alg3.58.58.m1.1.1.2.1.cmml" xref="alg3.58.58.m1.1.1.2.1"></divide><apply id="alg3.58.58.m1.1.1.2.2.cmml" xref="alg3.58.58.m1.1.1.2.2"><times id="alg3.58.58.m1.1.1.2.2.1.cmml" xref="alg3.58.58.m1.1.1.2.2.1"></times><ci id="alg3.58.58.m1.1.1.2.2.2.cmml" xref="alg3.58.58.m1.1.1.2.2.2">𝑛</ci><ci id="alg3.58.58.m1.1.1.2.2.3.cmml" xref="alg3.58.58.m1.1.1.2.2.3">𝑜</ci><ci id="alg3.58.58.m1.1.1.2.2.4.cmml" xref="alg3.58.58.m1.1.1.2.2.4">𝑟</ci><ci id="alg3.58.58.m1.1.1.2.2.5.cmml" xref="alg3.58.58.m1.1.1.2.2.5">𝑚</ci><ci id="alg3.58.58.m1.1.1.2.2.6.cmml" xref="alg3.58.58.m1.1.1.2.2.6">_</ci><ci id="alg3.58.58.m1.1.1.2.2.7.cmml" xref="alg3.58.58.m1.1.1.2.2.7">𝑥</ci></apply><ci id="alg3.58.58.m1.1.1.2.3.cmml" xref="alg3.58.58.m1.1.1.2.3">𝑛</ci></apply><ci id="alg3.58.58.m1.1.1.3.cmml" xref="alg3.58.58.m1.1.1.3">𝑜</ci><ci id="alg3.58.58.m1.1.1.4.cmml" xref="alg3.58.58.m1.1.1.4">𝑟</ci><ci id="alg3.58.58.m1.1.1.5.cmml" xref="alg3.58.58.m1.1.1.5">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.58.58.m1.1c">norm\_x/norm</annotation><annotation encoding="application/x-llamapun" id="alg3.58.58.m1.1d">italic_n italic_o italic_r italic_m _ italic_x / italic_n italic_o italic_r italic_m</annotation></semantics></math><span class="ltx_text" id="alg3.60.60.7" style="font-size:90%;">, </span><math alttext="norm\_y/norm" class="ltx_Math" display="inline" id="alg3.59.59.m2.1"><semantics id="alg3.59.59.m2.1a"><mrow id="alg3.59.59.m2.1.1" xref="alg3.59.59.m2.1.1.cmml"><mrow id="alg3.59.59.m2.1.1.2" xref="alg3.59.59.m2.1.1.2.cmml"><mrow id="alg3.59.59.m2.1.1.2.2" xref="alg3.59.59.m2.1.1.2.2.cmml"><mi id="alg3.59.59.m2.1.1.2.2.2" mathsize="90%" xref="alg3.59.59.m2.1.1.2.2.2.cmml">n</mi><mo id="alg3.59.59.m2.1.1.2.2.1" xref="alg3.59.59.m2.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.59.59.m2.1.1.2.2.3" mathsize="90%" xref="alg3.59.59.m2.1.1.2.2.3.cmml">o</mi><mo id="alg3.59.59.m2.1.1.2.2.1a" xref="alg3.59.59.m2.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.59.59.m2.1.1.2.2.4" mathsize="90%" xref="alg3.59.59.m2.1.1.2.2.4.cmml">r</mi><mo id="alg3.59.59.m2.1.1.2.2.1b" xref="alg3.59.59.m2.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.59.59.m2.1.1.2.2.5" mathsize="90%" xref="alg3.59.59.m2.1.1.2.2.5.cmml">m</mi><mo id="alg3.59.59.m2.1.1.2.2.1c" xref="alg3.59.59.m2.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.59.59.m2.1.1.2.2.6" mathsize="90%" mathvariant="normal" xref="alg3.59.59.m2.1.1.2.2.6.cmml">_</mi><mo id="alg3.59.59.m2.1.1.2.2.1d" xref="alg3.59.59.m2.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.59.59.m2.1.1.2.2.7" mathsize="90%" xref="alg3.59.59.m2.1.1.2.2.7.cmml">y</mi></mrow><mo id="alg3.59.59.m2.1.1.2.1" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg3.59.59.m2.1.1.2.1.cmml">/</mo><mi id="alg3.59.59.m2.1.1.2.3" mathsize="90%" xref="alg3.59.59.m2.1.1.2.3.cmml">n</mi></mrow><mo id="alg3.59.59.m2.1.1.1" xref="alg3.59.59.m2.1.1.1.cmml">⁢</mo><mi id="alg3.59.59.m2.1.1.3" mathsize="90%" xref="alg3.59.59.m2.1.1.3.cmml">o</mi><mo id="alg3.59.59.m2.1.1.1a" xref="alg3.59.59.m2.1.1.1.cmml">⁢</mo><mi id="alg3.59.59.m2.1.1.4" mathsize="90%" xref="alg3.59.59.m2.1.1.4.cmml">r</mi><mo id="alg3.59.59.m2.1.1.1b" xref="alg3.59.59.m2.1.1.1.cmml">⁢</mo><mi id="alg3.59.59.m2.1.1.5" mathsize="90%" xref="alg3.59.59.m2.1.1.5.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.59.59.m2.1b"><apply id="alg3.59.59.m2.1.1.cmml" xref="alg3.59.59.m2.1.1"><times id="alg3.59.59.m2.1.1.1.cmml" xref="alg3.59.59.m2.1.1.1"></times><apply id="alg3.59.59.m2.1.1.2.cmml" xref="alg3.59.59.m2.1.1.2"><divide id="alg3.59.59.m2.1.1.2.1.cmml" xref="alg3.59.59.m2.1.1.2.1"></divide><apply id="alg3.59.59.m2.1.1.2.2.cmml" xref="alg3.59.59.m2.1.1.2.2"><times id="alg3.59.59.m2.1.1.2.2.1.cmml" xref="alg3.59.59.m2.1.1.2.2.1"></times><ci id="alg3.59.59.m2.1.1.2.2.2.cmml" xref="alg3.59.59.m2.1.1.2.2.2">𝑛</ci><ci id="alg3.59.59.m2.1.1.2.2.3.cmml" xref="alg3.59.59.m2.1.1.2.2.3">𝑜</ci><ci id="alg3.59.59.m2.1.1.2.2.4.cmml" xref="alg3.59.59.m2.1.1.2.2.4">𝑟</ci><ci id="alg3.59.59.m2.1.1.2.2.5.cmml" xref="alg3.59.59.m2.1.1.2.2.5">𝑚</ci><ci id="alg3.59.59.m2.1.1.2.2.6.cmml" xref="alg3.59.59.m2.1.1.2.2.6">_</ci><ci id="alg3.59.59.m2.1.1.2.2.7.cmml" xref="alg3.59.59.m2.1.1.2.2.7">𝑦</ci></apply><ci id="alg3.59.59.m2.1.1.2.3.cmml" xref="alg3.59.59.m2.1.1.2.3">𝑛</ci></apply><ci id="alg3.59.59.m2.1.1.3.cmml" xref="alg3.59.59.m2.1.1.3">𝑜</ci><ci id="alg3.59.59.m2.1.1.4.cmml" xref="alg3.59.59.m2.1.1.4">𝑟</ci><ci id="alg3.59.59.m2.1.1.5.cmml" xref="alg3.59.59.m2.1.1.5">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.59.59.m2.1c">norm\_y/norm</annotation><annotation encoding="application/x-llamapun" id="alg3.59.59.m2.1d">italic_n italic_o italic_r italic_m _ italic_y / italic_n italic_o italic_r italic_m</annotation></semantics></math><span class="ltx_text" id="alg3.60.60.8" style="font-size:90%;">, </span><math alttext="norm\_z/norm" class="ltx_Math" display="inline" id="alg3.60.60.m3.1"><semantics id="alg3.60.60.m3.1a"><mrow id="alg3.60.60.m3.1.1" xref="alg3.60.60.m3.1.1.cmml"><mrow id="alg3.60.60.m3.1.1.2" xref="alg3.60.60.m3.1.1.2.cmml"><mrow id="alg3.60.60.m3.1.1.2.2" xref="alg3.60.60.m3.1.1.2.2.cmml"><mi id="alg3.60.60.m3.1.1.2.2.2" mathsize="90%" xref="alg3.60.60.m3.1.1.2.2.2.cmml">n</mi><mo id="alg3.60.60.m3.1.1.2.2.1" xref="alg3.60.60.m3.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.60.60.m3.1.1.2.2.3" mathsize="90%" xref="alg3.60.60.m3.1.1.2.2.3.cmml">o</mi><mo id="alg3.60.60.m3.1.1.2.2.1a" xref="alg3.60.60.m3.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.60.60.m3.1.1.2.2.4" mathsize="90%" xref="alg3.60.60.m3.1.1.2.2.4.cmml">r</mi><mo id="alg3.60.60.m3.1.1.2.2.1b" xref="alg3.60.60.m3.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.60.60.m3.1.1.2.2.5" mathsize="90%" xref="alg3.60.60.m3.1.1.2.2.5.cmml">m</mi><mo id="alg3.60.60.m3.1.1.2.2.1c" xref="alg3.60.60.m3.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.60.60.m3.1.1.2.2.6" mathsize="90%" mathvariant="normal" xref="alg3.60.60.m3.1.1.2.2.6.cmml">_</mi><mo id="alg3.60.60.m3.1.1.2.2.1d" xref="alg3.60.60.m3.1.1.2.2.1.cmml">⁢</mo><mi id="alg3.60.60.m3.1.1.2.2.7" mathsize="90%" xref="alg3.60.60.m3.1.1.2.2.7.cmml">z</mi></mrow><mo id="alg3.60.60.m3.1.1.2.1" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="alg3.60.60.m3.1.1.2.1.cmml">/</mo><mi id="alg3.60.60.m3.1.1.2.3" mathsize="90%" xref="alg3.60.60.m3.1.1.2.3.cmml">n</mi></mrow><mo id="alg3.60.60.m3.1.1.1" xref="alg3.60.60.m3.1.1.1.cmml">⁢</mo><mi id="alg3.60.60.m3.1.1.3" mathsize="90%" xref="alg3.60.60.m3.1.1.3.cmml">o</mi><mo id="alg3.60.60.m3.1.1.1a" xref="alg3.60.60.m3.1.1.1.cmml">⁢</mo><mi id="alg3.60.60.m3.1.1.4" mathsize="90%" xref="alg3.60.60.m3.1.1.4.cmml">r</mi><mo id="alg3.60.60.m3.1.1.1b" xref="alg3.60.60.m3.1.1.1.cmml">⁢</mo><mi id="alg3.60.60.m3.1.1.5" mathsize="90%" xref="alg3.60.60.m3.1.1.5.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.60.60.m3.1b"><apply id="alg3.60.60.m3.1.1.cmml" xref="alg3.60.60.m3.1.1"><times id="alg3.60.60.m3.1.1.1.cmml" xref="alg3.60.60.m3.1.1.1"></times><apply id="alg3.60.60.m3.1.1.2.cmml" xref="alg3.60.60.m3.1.1.2"><divide id="alg3.60.60.m3.1.1.2.1.cmml" xref="alg3.60.60.m3.1.1.2.1"></divide><apply id="alg3.60.60.m3.1.1.2.2.cmml" xref="alg3.60.60.m3.1.1.2.2"><times id="alg3.60.60.m3.1.1.2.2.1.cmml" xref="alg3.60.60.m3.1.1.2.2.1"></times><ci id="alg3.60.60.m3.1.1.2.2.2.cmml" xref="alg3.60.60.m3.1.1.2.2.2">𝑛</ci><ci id="alg3.60.60.m3.1.1.2.2.3.cmml" xref="alg3.60.60.m3.1.1.2.2.3">𝑜</ci><ci id="alg3.60.60.m3.1.1.2.2.4.cmml" xref="alg3.60.60.m3.1.1.2.2.4">𝑟</ci><ci id="alg3.60.60.m3.1.1.2.2.5.cmml" xref="alg3.60.60.m3.1.1.2.2.5">𝑚</ci><ci id="alg3.60.60.m3.1.1.2.2.6.cmml" xref="alg3.60.60.m3.1.1.2.2.6">_</ci><ci id="alg3.60.60.m3.1.1.2.2.7.cmml" xref="alg3.60.60.m3.1.1.2.2.7">𝑧</ci></apply><ci id="alg3.60.60.m3.1.1.2.3.cmml" xref="alg3.60.60.m3.1.1.2.3">𝑛</ci></apply><ci id="alg3.60.60.m3.1.1.3.cmml" xref="alg3.60.60.m3.1.1.3">𝑜</ci><ci id="alg3.60.60.m3.1.1.4.cmml" xref="alg3.60.60.m3.1.1.4">𝑟</ci><ci id="alg3.60.60.m3.1.1.5.cmml" xref="alg3.60.60.m3.1.1.5">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.60.60.m3.1c">norm\_z/norm</annotation><annotation encoding="application/x-llamapun" id="alg3.60.60.m3.1d">italic_n italic_o italic_r italic_m _ italic_z / italic_n italic_o italic_r italic_m</annotation></semantics></math><span class="ltx_text" id="alg3.60.60.9" style="font-size:90%;">);</span>
</div>
<div class="ltx_listingline" id="alg3.60.74">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.74.1.1.1" style="font-size:90%;">40</span></span><span class="ltx_text" id="alg3.60.74.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg3.60.74.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg3.60.74.4" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg3.60.75">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg3.60.75.1.1.1" style="font-size:90%;">41</span></span>
</div>
<div class="ltx_listingline" id="alg3.60.76">
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg3.64.1.1">Algorithm 3</span> </span>Decoder</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3 </span>Loss Function</h4>
<div class="ltx_para" id="S3.SS3.SSS3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.p1.1">Addressing the inherent challenges in depth estimation, our approach focuses on predicting depth. We use a set of scale- and shift-invariant loss functions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib17" title="">17</a>]</cite>, ensuring that model predictions remain consistent across different scales and shifts in the data, enhancing the robustness of the training process.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p2">
<p class="ltx_p" id="S3.SS3.SSS3.p2.4">Let <math alttext="M" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.1.m1.1"><semantics id="S3.SS3.SSS3.p2.1.m1.1a"><mi id="S3.SS3.SSS3.p2.1.m1.1.1" xref="S3.SS3.SSS3.p2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.1.m1.1b"><ci id="S3.SS3.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.1.m1.1d">italic_M</annotation></semantics></math> denote the number of pixels in an image with valid ground truth, and let <math alttext="{\bm{\theta}}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.2.m2.1"><semantics id="S3.SS3.SSS3.p2.2.m2.1a"><mi id="S3.SS3.SSS3.p2.2.m2.1.1" xref="S3.SS3.SSS3.p2.2.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.2.m2.1b"><ci id="S3.SS3.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.2.m2.1c">{\bm{\theta}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.2.m2.1d">bold_italic_θ</annotation></semantics></math> represent the parameters of the prediction model. We define the predicted depth as <math alttext="\mathbf{d}=\mathbf{d}({\bm{\theta}})\in\mathbb{R}^{M}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.3.m3.1"><semantics id="S3.SS3.SSS3.p2.3.m3.1a"><mrow id="S3.SS3.SSS3.p2.3.m3.1.2" xref="S3.SS3.SSS3.p2.3.m3.1.2.cmml"><mi id="S3.SS3.SSS3.p2.3.m3.1.2.2" xref="S3.SS3.SSS3.p2.3.m3.1.2.2.cmml">𝐝</mi><mo id="S3.SS3.SSS3.p2.3.m3.1.2.3" xref="S3.SS3.SSS3.p2.3.m3.1.2.3.cmml">=</mo><mrow id="S3.SS3.SSS3.p2.3.m3.1.2.4" xref="S3.SS3.SSS3.p2.3.m3.1.2.4.cmml"><mi id="S3.SS3.SSS3.p2.3.m3.1.2.4.2" xref="S3.SS3.SSS3.p2.3.m3.1.2.4.2.cmml">𝐝</mi><mo id="S3.SS3.SSS3.p2.3.m3.1.2.4.1" xref="S3.SS3.SSS3.p2.3.m3.1.2.4.1.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p2.3.m3.1.2.4.3.2" xref="S3.SS3.SSS3.p2.3.m3.1.2.4.cmml"><mo id="S3.SS3.SSS3.p2.3.m3.1.2.4.3.2.1" stretchy="false" xref="S3.SS3.SSS3.p2.3.m3.1.2.4.cmml">(</mo><mi id="S3.SS3.SSS3.p2.3.m3.1.1" xref="S3.SS3.SSS3.p2.3.m3.1.1.cmml">𝜽</mi><mo id="S3.SS3.SSS3.p2.3.m3.1.2.4.3.2.2" stretchy="false" xref="S3.SS3.SSS3.p2.3.m3.1.2.4.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS3.p2.3.m3.1.2.5" xref="S3.SS3.SSS3.p2.3.m3.1.2.5.cmml">∈</mo><msup id="S3.SS3.SSS3.p2.3.m3.1.2.6" xref="S3.SS3.SSS3.p2.3.m3.1.2.6.cmml"><mi id="S3.SS3.SSS3.p2.3.m3.1.2.6.2" xref="S3.SS3.SSS3.p2.3.m3.1.2.6.2.cmml">ℝ</mi><mi id="S3.SS3.SSS3.p2.3.m3.1.2.6.3" xref="S3.SS3.SSS3.p2.3.m3.1.2.6.3.cmml">M</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.3.m3.1b"><apply id="S3.SS3.SSS3.p2.3.m3.1.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2"><and id="S3.SS3.SSS3.p2.3.m3.1.2a.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2"></and><apply id="S3.SS3.SSS3.p2.3.m3.1.2b.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2"><eq id="S3.SS3.SSS3.p2.3.m3.1.2.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2.3"></eq><ci id="S3.SS3.SSS3.p2.3.m3.1.2.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2.2">𝐝</ci><apply id="S3.SS3.SSS3.p2.3.m3.1.2.4.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2.4"><times id="S3.SS3.SSS3.p2.3.m3.1.2.4.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2.4.1"></times><ci id="S3.SS3.SSS3.p2.3.m3.1.2.4.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2.4.2">𝐝</ci><ci id="S3.SS3.SSS3.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1">𝜽</ci></apply></apply><apply id="S3.SS3.SSS3.p2.3.m3.1.2c.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2"><in id="S3.SS3.SSS3.p2.3.m3.1.2.5.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2.5"></in><share href="https://arxiv.org/html/2410.02072v1#S3.SS3.SSS3.p2.3.m3.1.2.4.cmml" id="S3.SS3.SSS3.p2.3.m3.1.2d.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2"></share><apply id="S3.SS3.SSS3.p2.3.m3.1.2.6.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2.6"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.3.m3.1.2.6.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2.6">superscript</csymbol><ci id="S3.SS3.SSS3.p2.3.m3.1.2.6.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2.6.2">ℝ</ci><ci id="S3.SS3.SSS3.p2.3.m3.1.2.6.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.2.6.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.3.m3.1c">\mathbf{d}=\mathbf{d}({\bm{\theta}})\in\mathbb{R}^{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.3.m3.1d">bold_d = bold_d ( bold_italic_θ ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> and the ground truth depth as <math alttext="\mathbf{d}^{*}\in\mathbb{R}^{M}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.4.m4.1"><semantics id="S3.SS3.SSS3.p2.4.m4.1a"><mrow id="S3.SS3.SSS3.p2.4.m4.1.1" xref="S3.SS3.SSS3.p2.4.m4.1.1.cmml"><msup id="S3.SS3.SSS3.p2.4.m4.1.1.2" xref="S3.SS3.SSS3.p2.4.m4.1.1.2.cmml"><mi id="S3.SS3.SSS3.p2.4.m4.1.1.2.2" xref="S3.SS3.SSS3.p2.4.m4.1.1.2.2.cmml">𝐝</mi><mo id="S3.SS3.SSS3.p2.4.m4.1.1.2.3" xref="S3.SS3.SSS3.p2.4.m4.1.1.2.3.cmml">∗</mo></msup><mo id="S3.SS3.SSS3.p2.4.m4.1.1.1" xref="S3.SS3.SSS3.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS3.p2.4.m4.1.1.3" xref="S3.SS3.SSS3.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.SSS3.p2.4.m4.1.1.3.2" xref="S3.SS3.SSS3.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS3.p2.4.m4.1.1.3.3" xref="S3.SS3.SSS3.p2.4.m4.1.1.3.3.cmml">M</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.4.m4.1b"><apply id="S3.SS3.SSS3.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1"><in id="S3.SS3.SSS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.1"></in><apply id="S3.SS3.SSS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.4.m4.1.1.2.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS3.SSS3.p2.4.m4.1.1.2.2.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.2.2">𝐝</ci><times id="S3.SS3.SSS3.p2.4.m4.1.1.2.3.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.2.3"></times></apply><apply id="S3.SS3.SSS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS3.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS3.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.4.m4.1c">\mathbf{d}^{*}\in\mathbb{R}^{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.4.m4.1d">bold_d start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>. Individual pixel values are denoted by subscripts.</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS3.Px1">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.Px1.1.1">Scale- and Shift-Invariant Loss</span>:</h5>
<div class="ltx_para" id="S3.SS3.SSS3.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS3.Px1.p1.1">To compute the loss for a single sample, we apply a scale- and shift-invariant loss, formulated as:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.Px1.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{ssi}(\hat{\mathbf{d}},\hat{\mathbf{d}}^{*})=\frac{1}{2M}\sum_{i=1%
}^{M}\rho\left(\hat{\mathbf{d}}_{i}-\hat{\mathbf{d}}_{i}^{*}\right)," class="ltx_Math" display="block" id="S3.E9.m1.2"><semantics id="S3.E9.m1.2a"><mrow id="S3.E9.m1.2.2.1" xref="S3.E9.m1.2.2.1.1.cmml"><mrow id="S3.E9.m1.2.2.1.1" xref="S3.E9.m1.2.2.1.1.cmml"><mrow id="S3.E9.m1.2.2.1.1.1" xref="S3.E9.m1.2.2.1.1.1.cmml"><msub id="S3.E9.m1.2.2.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.2.2.1.1.1.3.2" xref="S3.E9.m1.2.2.1.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E9.m1.2.2.1.1.1.3.3" xref="S3.E9.m1.2.2.1.1.1.3.3.cmml"><mi id="S3.E9.m1.2.2.1.1.1.3.3.2" xref="S3.E9.m1.2.2.1.1.1.3.3.2.cmml">s</mi><mo id="S3.E9.m1.2.2.1.1.1.3.3.1" xref="S3.E9.m1.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E9.m1.2.2.1.1.1.3.3.3" xref="S3.E9.m1.2.2.1.1.1.3.3.3.cmml">s</mi><mo id="S3.E9.m1.2.2.1.1.1.3.3.1a" xref="S3.E9.m1.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E9.m1.2.2.1.1.1.3.3.4" xref="S3.E9.m1.2.2.1.1.1.3.3.4.cmml">i</mi></mrow></msub><mo id="S3.E9.m1.2.2.1.1.1.2" xref="S3.E9.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.2.2.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E9.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.2.2.1.1.1.1.2.cmml">(</mo><mover accent="true" id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><mi id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml">𝐝</mi><mo id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.cmml">^</mo></mover><mo id="S3.E9.m1.2.2.1.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.1.2.cmml">,</mo><msup id="S3.E9.m1.2.2.1.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E9.m1.2.2.1.1.1.1.1.1.2" xref="S3.E9.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E9.m1.2.2.1.1.1.1.1.1.2.2.cmml">𝐝</mi><mo id="S3.E9.m1.2.2.1.1.1.1.1.1.2.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E9.m1.2.2.1.1.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E9.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S3.E9.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.2.2.1.1.3" xref="S3.E9.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E9.m1.2.2.1.1.2" xref="S3.E9.m1.2.2.1.1.2.cmml"><mfrac id="S3.E9.m1.2.2.1.1.2.3" xref="S3.E9.m1.2.2.1.1.2.3.cmml"><mn id="S3.E9.m1.2.2.1.1.2.3.2" xref="S3.E9.m1.2.2.1.1.2.3.2.cmml">1</mn><mrow id="S3.E9.m1.2.2.1.1.2.3.3" xref="S3.E9.m1.2.2.1.1.2.3.3.cmml"><mn id="S3.E9.m1.2.2.1.1.2.3.3.2" xref="S3.E9.m1.2.2.1.1.2.3.3.2.cmml">2</mn><mo id="S3.E9.m1.2.2.1.1.2.3.3.1" xref="S3.E9.m1.2.2.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.E9.m1.2.2.1.1.2.3.3.3" xref="S3.E9.m1.2.2.1.1.2.3.3.3.cmml">M</mi></mrow></mfrac><mo id="S3.E9.m1.2.2.1.1.2.2" xref="S3.E9.m1.2.2.1.1.2.2.cmml">⁢</mo><mrow id="S3.E9.m1.2.2.1.1.2.1" xref="S3.E9.m1.2.2.1.1.2.1.cmml"><munderover id="S3.E9.m1.2.2.1.1.2.1.2" xref="S3.E9.m1.2.2.1.1.2.1.2.cmml"><mo id="S3.E9.m1.2.2.1.1.2.1.2.2.2" movablelimits="false" xref="S3.E9.m1.2.2.1.1.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E9.m1.2.2.1.1.2.1.2.2.3" xref="S3.E9.m1.2.2.1.1.2.1.2.2.3.cmml"><mi id="S3.E9.m1.2.2.1.1.2.1.2.2.3.2" xref="S3.E9.m1.2.2.1.1.2.1.2.2.3.2.cmml">i</mi><mo id="S3.E9.m1.2.2.1.1.2.1.2.2.3.1" xref="S3.E9.m1.2.2.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E9.m1.2.2.1.1.2.1.2.2.3.3" xref="S3.E9.m1.2.2.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.2.2.1.1.2.1.2.3" xref="S3.E9.m1.2.2.1.1.2.1.2.3.cmml">M</mi></munderover><mrow id="S3.E9.m1.2.2.1.1.2.1.1" xref="S3.E9.m1.2.2.1.1.2.1.1.cmml"><mi id="S3.E9.m1.2.2.1.1.2.1.1.3" xref="S3.E9.m1.2.2.1.1.2.1.1.3.cmml">ρ</mi><mo id="S3.E9.m1.2.2.1.1.2.1.1.2" xref="S3.E9.m1.2.2.1.1.2.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.2.2.1.1.2.1.1.1.1" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.cmml"><mo id="S3.E9.m1.2.2.1.1.2.1.1.1.1.2" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.cmml"><msub id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.2" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml"><mi id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.2.2" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.2.2.cmml">𝐝</mi><mo id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.2.1" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.3" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.2" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.2" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.2.cmml">𝐝</mi><mo id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.1" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.3" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.3.cmml">i</mi><mo id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.3" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.3.cmml">∗</mo></msubsup></mrow><mo id="S3.E9.m1.2.2.1.1.2.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E9.m1.2.2.1.2" xref="S3.E9.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.2b"><apply id="S3.E9.m1.2.2.1.1.cmml" xref="S3.E9.m1.2.2.1"><eq id="S3.E9.m1.2.2.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.3"></eq><apply id="S3.E9.m1.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1"><times id="S3.E9.m1.2.2.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.2"></times><apply id="S3.E9.m1.2.2.1.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.1.3.1.cmml" xref="S3.E9.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.2.2.1.1.1.3.2.cmml" xref="S3.E9.m1.2.2.1.1.1.3.2">ℒ</ci><apply id="S3.E9.m1.2.2.1.1.1.3.3.cmml" xref="S3.E9.m1.2.2.1.1.1.3.3"><times id="S3.E9.m1.2.2.1.1.1.3.3.1.cmml" xref="S3.E9.m1.2.2.1.1.1.3.3.1"></times><ci id="S3.E9.m1.2.2.1.1.1.3.3.2.cmml" xref="S3.E9.m1.2.2.1.1.1.3.3.2">𝑠</ci><ci id="S3.E9.m1.2.2.1.1.1.3.3.3.cmml" xref="S3.E9.m1.2.2.1.1.1.3.3.3">𝑠</ci><ci id="S3.E9.m1.2.2.1.1.1.3.3.4.cmml" xref="S3.E9.m1.2.2.1.1.1.3.3.4">𝑖</ci></apply></apply><interval closure="open" id="S3.E9.m1.2.2.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><ci id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1.1">^</ci><ci id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2">𝐝</ci></apply><apply id="S3.E9.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E9.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.2"><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.2.2">𝐝</ci></apply><times id="S3.E9.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3"></times></apply></interval></apply><apply id="S3.E9.m1.2.2.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.2"><times id="S3.E9.m1.2.2.1.1.2.2.cmml" xref="S3.E9.m1.2.2.1.1.2.2"></times><apply id="S3.E9.m1.2.2.1.1.2.3.cmml" xref="S3.E9.m1.2.2.1.1.2.3"><divide id="S3.E9.m1.2.2.1.1.2.3.1.cmml" xref="S3.E9.m1.2.2.1.1.2.3"></divide><cn id="S3.E9.m1.2.2.1.1.2.3.2.cmml" type="integer" xref="S3.E9.m1.2.2.1.1.2.3.2">1</cn><apply id="S3.E9.m1.2.2.1.1.2.3.3.cmml" xref="S3.E9.m1.2.2.1.1.2.3.3"><times id="S3.E9.m1.2.2.1.1.2.3.3.1.cmml" xref="S3.E9.m1.2.2.1.1.2.3.3.1"></times><cn id="S3.E9.m1.2.2.1.1.2.3.3.2.cmml" type="integer" xref="S3.E9.m1.2.2.1.1.2.3.3.2">2</cn><ci id="S3.E9.m1.2.2.1.1.2.3.3.3.cmml" xref="S3.E9.m1.2.2.1.1.2.3.3.3">𝑀</ci></apply></apply><apply id="S3.E9.m1.2.2.1.1.2.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1"><apply id="S3.E9.m1.2.2.1.1.2.1.2.cmml" xref="S3.E9.m1.2.2.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.2.1.2.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1.2">superscript</csymbol><apply id="S3.E9.m1.2.2.1.1.2.1.2.2.cmml" xref="S3.E9.m1.2.2.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.2.1.2.2.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1.2">subscript</csymbol><sum id="S3.E9.m1.2.2.1.1.2.1.2.2.2.cmml" xref="S3.E9.m1.2.2.1.1.2.1.2.2.2"></sum><apply id="S3.E9.m1.2.2.1.1.2.1.2.2.3.cmml" xref="S3.E9.m1.2.2.1.1.2.1.2.2.3"><eq id="S3.E9.m1.2.2.1.1.2.1.2.2.3.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1.2.2.3.1"></eq><ci id="S3.E9.m1.2.2.1.1.2.1.2.2.3.2.cmml" xref="S3.E9.m1.2.2.1.1.2.1.2.2.3.2">𝑖</ci><cn id="S3.E9.m1.2.2.1.1.2.1.2.2.3.3.cmml" type="integer" xref="S3.E9.m1.2.2.1.1.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.2.2.1.1.2.1.2.3.cmml" xref="S3.E9.m1.2.2.1.1.2.1.2.3">𝑀</ci></apply><apply id="S3.E9.m1.2.2.1.1.2.1.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1"><times id="S3.E9.m1.2.2.1.1.2.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.2"></times><ci id="S3.E9.m1.2.2.1.1.2.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.3">𝜌</ci><apply id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1"><minus id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.1"></minus><apply id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.2"><ci id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.2.2">𝐝</ci></apply><ci id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.2"><ci id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.1">^</ci><ci id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.2">𝐝</ci></apply><ci id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.3.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.2.3">𝑖</ci></apply><times id="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.2.2.1.1.2.1.1.1.1.1.3.3"></times></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.2c">\mathcal{L}_{ssi}(\hat{\mathbf{d}},\hat{\mathbf{d}}^{*})=\frac{1}{2M}\sum_{i=1%
}^{M}\rho\left(\hat{\mathbf{d}}_{i}-\hat{\mathbf{d}}_{i}^{*}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_s italic_s italic_i end_POSTSUBSCRIPT ( over^ start_ARG bold_d end_ARG , over^ start_ARG bold_d end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) = divide start_ARG 1 end_ARG start_ARG 2 italic_M end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_ρ ( over^ start_ARG bold_d end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - over^ start_ARG bold_d end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.Px1.p3">
<p class="ltx_p" id="S3.SS3.SSS3.Px1.p3.3">where <math alttext="\hat{\mathbf{d}}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.Px1.p3.1.m1.1"><semantics id="S3.SS3.SSS3.Px1.p3.1.m1.1a"><mover accent="true" id="S3.SS3.SSS3.Px1.p3.1.m1.1.1" xref="S3.SS3.SSS3.Px1.p3.1.m1.1.1.cmml"><mi id="S3.SS3.SSS3.Px1.p3.1.m1.1.1.2" xref="S3.SS3.SSS3.Px1.p3.1.m1.1.1.2.cmml">𝐝</mi><mo id="S3.SS3.SSS3.Px1.p3.1.m1.1.1.1" xref="S3.SS3.SSS3.Px1.p3.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.Px1.p3.1.m1.1b"><apply id="S3.SS3.SSS3.Px1.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS3.Px1.p3.1.m1.1.1"><ci id="S3.SS3.SSS3.Px1.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.Px1.p3.1.m1.1.1.1">^</ci><ci id="S3.SS3.SSS3.Px1.p3.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.Px1.p3.1.m1.1.1.2">𝐝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.Px1.p3.1.m1.1c">\hat{\mathbf{d}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.Px1.p3.1.m1.1d">over^ start_ARG bold_d end_ARG</annotation></semantics></math> and <math alttext="\hat{\mathbf{d}}^{*}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.Px1.p3.2.m2.1"><semantics id="S3.SS3.SSS3.Px1.p3.2.m2.1a"><msup id="S3.SS3.SSS3.Px1.p3.2.m2.1.1" xref="S3.SS3.SSS3.Px1.p3.2.m2.1.1.cmml"><mover accent="true" id="S3.SS3.SSS3.Px1.p3.2.m2.1.1.2" xref="S3.SS3.SSS3.Px1.p3.2.m2.1.1.2.cmml"><mi id="S3.SS3.SSS3.Px1.p3.2.m2.1.1.2.2" xref="S3.SS3.SSS3.Px1.p3.2.m2.1.1.2.2.cmml">𝐝</mi><mo id="S3.SS3.SSS3.Px1.p3.2.m2.1.1.2.1" xref="S3.SS3.SSS3.Px1.p3.2.m2.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS3.SSS3.Px1.p3.2.m2.1.1.3" xref="S3.SS3.SSS3.Px1.p3.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.Px1.p3.2.m2.1b"><apply id="S3.SS3.SSS3.Px1.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS3.Px1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.Px1.p3.2.m2.1.1.1.cmml" xref="S3.SS3.SSS3.Px1.p3.2.m2.1.1">superscript</csymbol><apply id="S3.SS3.SSS3.Px1.p3.2.m2.1.1.2.cmml" xref="S3.SS3.SSS3.Px1.p3.2.m2.1.1.2"><ci id="S3.SS3.SSS3.Px1.p3.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS3.Px1.p3.2.m2.1.1.2.1">^</ci><ci id="S3.SS3.SSS3.Px1.p3.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS3.Px1.p3.2.m2.1.1.2.2">𝐝</ci></apply><times id="S3.SS3.SSS3.Px1.p3.2.m2.1.1.3.cmml" xref="S3.SS3.SSS3.Px1.p3.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.Px1.p3.2.m2.1c">\hat{\mathbf{d}}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.Px1.p3.2.m2.1d">over^ start_ARG bold_d end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> are the scaled and shifted versions of the predicted and ground truth disparities, respectively. The function <math alttext="\rho" class="ltx_Math" display="inline" id="S3.SS3.SSS3.Px1.p3.3.m3.1"><semantics id="S3.SS3.SSS3.Px1.p3.3.m3.1a"><mi id="S3.SS3.SSS3.Px1.p3.3.m3.1.1" xref="S3.SS3.SSS3.Px1.p3.3.m3.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.Px1.p3.3.m3.1b"><ci id="S3.SS3.SSS3.Px1.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS3.Px1.p3.3.m3.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.Px1.p3.3.m3.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.Px1.p3.3.m3.1d">italic_ρ</annotation></semantics></math> defines the type of loss applied, allowing flexibility in the choice of error metric.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS3.Px2">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.Px2.1.1">Gradient Matching Term</span>:</h5>
<div class="ltx_para" id="S3.SS3.SSS3.Px2.p1">
<p class="ltx_p" id="S3.SS3.SSS3.Px2.p1.1">To refine the depth prediction, we employ a multi-scale, scale-invariant gradient matching term, inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib17" title="">17</a>]</cite>, to promote sharp discontinuities that align with the ground truth. This term is defined as:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.Px2.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{reg}(\hat{\mathbf{d}},\hat{\mathbf{d}}^{*})=\frac{1}{M}\sum_{k=1}%
^{K}\sum_{i=1}^{M}\left(|\nabla_{x}R_{i}^{k}|+|\nabla_{y}R_{i}^{k}|\right)," class="ltx_Math" display="block" id="S3.E10.m1.2"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2.1" xref="S3.E10.m1.2.2.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1" xref="S3.E10.m1.2.2.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1.1" xref="S3.E10.m1.2.2.1.1.1.cmml"><msub id="S3.E10.m1.2.2.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.2.2.1.1.1.3.2" xref="S3.E10.m1.2.2.1.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E10.m1.2.2.1.1.1.3.3" xref="S3.E10.m1.2.2.1.1.1.3.3.cmml"><mi id="S3.E10.m1.2.2.1.1.1.3.3.2" xref="S3.E10.m1.2.2.1.1.1.3.3.2.cmml">r</mi><mo id="S3.E10.m1.2.2.1.1.1.3.3.1" xref="S3.E10.m1.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E10.m1.2.2.1.1.1.3.3.3" xref="S3.E10.m1.2.2.1.1.1.3.3.3.cmml">e</mi><mo id="S3.E10.m1.2.2.1.1.1.3.3.1a" xref="S3.E10.m1.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E10.m1.2.2.1.1.1.3.3.4" xref="S3.E10.m1.2.2.1.1.1.3.3.4.cmml">g</mi></mrow></msub><mo id="S3.E10.m1.2.2.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E10.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.2.2.1.1.1.1.2.cmml">(</mo><mover accent="true" id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><mi id="S3.E10.m1.1.1.2" xref="S3.E10.m1.1.1.2.cmml">𝐝</mi><mo id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.cmml">^</mo></mover><mo id="S3.E10.m1.2.2.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.2.cmml">,</mo><msup id="S3.E10.m1.2.2.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E10.m1.2.2.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.2.2.cmml">𝐝</mi><mo id="S3.E10.m1.2.2.1.1.1.1.1.1.2.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E10.m1.2.2.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E10.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S3.E10.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.2.2.1.1.3" xref="S3.E10.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E10.m1.2.2.1.1.2" xref="S3.E10.m1.2.2.1.1.2.cmml"><mfrac id="S3.E10.m1.2.2.1.1.2.3" xref="S3.E10.m1.2.2.1.1.2.3.cmml"><mn id="S3.E10.m1.2.2.1.1.2.3.2" xref="S3.E10.m1.2.2.1.1.2.3.2.cmml">1</mn><mi id="S3.E10.m1.2.2.1.1.2.3.3" xref="S3.E10.m1.2.2.1.1.2.3.3.cmml">M</mi></mfrac><mo id="S3.E10.m1.2.2.1.1.2.2" xref="S3.E10.m1.2.2.1.1.2.2.cmml">⁢</mo><mrow id="S3.E10.m1.2.2.1.1.2.1" xref="S3.E10.m1.2.2.1.1.2.1.cmml"><munderover id="S3.E10.m1.2.2.1.1.2.1.2" xref="S3.E10.m1.2.2.1.1.2.1.2.cmml"><mo id="S3.E10.m1.2.2.1.1.2.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E10.m1.2.2.1.1.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E10.m1.2.2.1.1.2.1.2.2.3" xref="S3.E10.m1.2.2.1.1.2.1.2.2.3.cmml"><mi id="S3.E10.m1.2.2.1.1.2.1.2.2.3.2" xref="S3.E10.m1.2.2.1.1.2.1.2.2.3.2.cmml">k</mi><mo id="S3.E10.m1.2.2.1.1.2.1.2.2.3.1" xref="S3.E10.m1.2.2.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E10.m1.2.2.1.1.2.1.2.2.3.3" xref="S3.E10.m1.2.2.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E10.m1.2.2.1.1.2.1.2.3" xref="S3.E10.m1.2.2.1.1.2.1.2.3.cmml">K</mi></munderover><mrow id="S3.E10.m1.2.2.1.1.2.1.1" xref="S3.E10.m1.2.2.1.1.2.1.1.cmml"><munderover id="S3.E10.m1.2.2.1.1.2.1.1.2" xref="S3.E10.m1.2.2.1.1.2.1.1.2.cmml"><mo id="S3.E10.m1.2.2.1.1.2.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E10.m1.2.2.1.1.2.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E10.m1.2.2.1.1.2.1.1.2.2.3" xref="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.cmml"><mi id="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.2" xref="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.1" xref="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.3" xref="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E10.m1.2.2.1.1.2.1.1.2.3" xref="S3.E10.m1.2.2.1.1.2.1.1.2.3.cmml">M</mi></munderover><mrow id="S3.E10.m1.2.2.1.1.2.1.1.1.1" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.cmml"><mo id="S3.E10.m1.2.2.1.1.2.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml"><mo id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.2" rspace="0.167em" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">∇</mo><mi id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml">x</mi></msub><msubsup id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.cmml">R</mi><mi id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup></mrow><mo id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.3.cmml">+</mo><mrow id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml"><mo id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.2" stretchy="false" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.2.1.cmml">|</mo><mrow id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.cmml"><msub id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1.2" rspace="0.167em" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1.2.cmml">∇</mo><mi id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1.3" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1.3.cmml">y</mi></msub><msubsup id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.cmml"><mi id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.2.2" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.2.2.cmml">R</mi><mi id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.2.3" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.2.3.cmml">i</mi><mi id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.3" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.3.cmml">k</mi></msubsup></mrow><mo id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.3" stretchy="false" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.2.1.cmml">|</mo></mrow></mrow><mo id="S3.E10.m1.2.2.1.1.2.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E10.m1.2.2.1.2" xref="S3.E10.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.2.1.1.cmml" xref="S3.E10.m1.2.2.1"><eq id="S3.E10.m1.2.2.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.3"></eq><apply id="S3.E10.m1.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1"><times id="S3.E10.m1.2.2.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.2"></times><apply id="S3.E10.m1.2.2.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.3.1.cmml" xref="S3.E10.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.3.2.cmml" xref="S3.E10.m1.2.2.1.1.1.3.2">ℒ</ci><apply id="S3.E10.m1.2.2.1.1.1.3.3.cmml" xref="S3.E10.m1.2.2.1.1.1.3.3"><times id="S3.E10.m1.2.2.1.1.1.3.3.1.cmml" xref="S3.E10.m1.2.2.1.1.1.3.3.1"></times><ci id="S3.E10.m1.2.2.1.1.1.3.3.2.cmml" xref="S3.E10.m1.2.2.1.1.1.3.3.2">𝑟</ci><ci id="S3.E10.m1.2.2.1.1.1.3.3.3.cmml" xref="S3.E10.m1.2.2.1.1.1.3.3.3">𝑒</ci><ci id="S3.E10.m1.2.2.1.1.1.3.3.4.cmml" xref="S3.E10.m1.2.2.1.1.1.3.3.4">𝑔</ci></apply></apply><interval closure="open" id="S3.E10.m1.2.2.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1"><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><ci id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1.1">^</ci><ci id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1.2">𝐝</ci></apply><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.2"><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.2.2">𝐝</ci></apply><times id="S3.E10.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.3"></times></apply></interval></apply><apply id="S3.E10.m1.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2"><times id="S3.E10.m1.2.2.1.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.2"></times><apply id="S3.E10.m1.2.2.1.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.3"><divide id="S3.E10.m1.2.2.1.1.2.3.1.cmml" xref="S3.E10.m1.2.2.1.1.2.3"></divide><cn id="S3.E10.m1.2.2.1.1.2.3.2.cmml" type="integer" xref="S3.E10.m1.2.2.1.1.2.3.2">1</cn><ci id="S3.E10.m1.2.2.1.1.2.3.3.cmml" xref="S3.E10.m1.2.2.1.1.2.3.3">𝑀</ci></apply><apply id="S3.E10.m1.2.2.1.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1"><apply id="S3.E10.m1.2.2.1.1.2.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.2">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.2.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.1.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.2">subscript</csymbol><sum id="S3.E10.m1.2.2.1.1.2.1.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.2.2.2"></sum><apply id="S3.E10.m1.2.2.1.1.2.1.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.1.2.2.3"><eq id="S3.E10.m1.2.2.1.1.2.1.2.2.3.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.2.2.3.1"></eq><ci id="S3.E10.m1.2.2.1.1.2.1.2.2.3.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.2.2.3.2">𝑘</ci><cn id="S3.E10.m1.2.2.1.1.2.1.2.2.3.3.cmml" type="integer" xref="S3.E10.m1.2.2.1.1.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E10.m1.2.2.1.1.2.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.1.2.3">𝐾</ci></apply><apply id="S3.E10.m1.2.2.1.1.2.1.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1"><apply id="S3.E10.m1.2.2.1.1.2.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.1.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.2">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.2.1.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.1.1.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.2">subscript</csymbol><sum id="S3.E10.m1.2.2.1.1.2.1.1.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.2.2.2"></sum><apply id="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.2.2.3"><eq id="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.1"></eq><ci id="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.2">𝑖</ci><cn id="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.3.cmml" type="integer" xref="S3.E10.m1.2.2.1.1.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E10.m1.2.2.1.1.2.1.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.2.3">𝑀</ci></apply><apply id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1"><plus id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.3"></plus><apply id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1"><abs id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.2"></abs><apply id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1"><apply id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.2">∇</ci><ci id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2">𝑅</ci><ci id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply></apply></apply><apply id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1"><abs id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.2"></abs><apply id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1"><apply id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1.2">∇</ci><ci id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.1.3">𝑦</ci></apply><apply id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2">superscript</csymbol><apply id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.2.2">𝑅</ci><ci id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.1.1.1.1.1.2.1.1.2.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">\mathcal{L}_{reg}(\hat{\mathbf{d}},\hat{\mathbf{d}}^{*})=\frac{1}{M}\sum_{k=1}%
^{K}\sum_{i=1}^{M}\left(|\nabla_{x}R_{i}^{k}|+|\nabla_{y}R_{i}^{k}|\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_r italic_e italic_g end_POSTSUBSCRIPT ( over^ start_ARG bold_d end_ARG , over^ start_ARG bold_d end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) = divide start_ARG 1 end_ARG start_ARG italic_M end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT ( | ∇ start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT | + | ∇ start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT | ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.Px2.p3">
<p class="ltx_p" id="S3.SS3.SSS3.Px2.p3.4">where <math alttext="R_{i}=\hat{\mathbf{d}}_{i}-\hat{\mathbf{d}}_{i}^{*}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.Px2.p3.1.m1.1"><semantics id="S3.SS3.SSS3.Px2.p3.1.m1.1a"><mrow id="S3.SS3.SSS3.Px2.p3.1.m1.1.1" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.cmml"><msub id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2.cmml"><mi id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2.2" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2.2.cmml">R</mi><mi id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2.3" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.1" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.cmml"><msub id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.cmml"><mover accent="true" id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.2" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.2.cmml"><mi id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.2.2" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.2.2.cmml">𝐝</mi><mo id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.2.1" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.3" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.1" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.1.cmml">−</mo><msubsup id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.cmml"><mover accent="true" id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.2" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.2.cmml"><mi id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.2.2" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.2.2.cmml">𝐝</mi><mo id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.2.1" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.3" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.3.cmml">i</mi><mo id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.3" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.3.cmml">∗</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.Px2.p3.1.m1.1b"><apply id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1"><eq id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.1"></eq><apply id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2.1.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2.2.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2.2">𝑅</ci><ci id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2.3.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3"><minus id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.1"></minus><apply id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.1.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2">subscript</csymbol><apply id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.2.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.2"><ci id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.2.1.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.2.1">^</ci><ci id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.2.2.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.2.2">𝐝</ci></apply><ci id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.3.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3">superscript</csymbol><apply id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3">subscript</csymbol><apply id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.2"><ci id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.2.1.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.2.1">^</ci><ci id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.2.2.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.2.2">𝐝</ci></apply><ci id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.2.3">𝑖</ci></apply><times id="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.SSS3.Px2.p3.1.m1.1.1.3.3.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.Px2.p3.1.m1.1c">R_{i}=\hat{\mathbf{d}}_{i}-\hat{\mathbf{d}}_{i}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.Px2.p3.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = over^ start_ARG bold_d end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - over^ start_ARG bold_d end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> represents the difference between predicted and ground truth depth values, and <math alttext="R^{k}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.Px2.p3.2.m2.1"><semantics id="S3.SS3.SSS3.Px2.p3.2.m2.1a"><msup id="S3.SS3.SSS3.Px2.p3.2.m2.1.1" xref="S3.SS3.SSS3.Px2.p3.2.m2.1.1.cmml"><mi id="S3.SS3.SSS3.Px2.p3.2.m2.1.1.2" xref="S3.SS3.SSS3.Px2.p3.2.m2.1.1.2.cmml">R</mi><mi id="S3.SS3.SSS3.Px2.p3.2.m2.1.1.3" xref="S3.SS3.SSS3.Px2.p3.2.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.Px2.p3.2.m2.1b"><apply id="S3.SS3.SSS3.Px2.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS3.Px2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.Px2.p3.2.m2.1.1.1.cmml" xref="S3.SS3.SSS3.Px2.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.Px2.p3.2.m2.1.1.2.cmml" xref="S3.SS3.SSS3.Px2.p3.2.m2.1.1.2">𝑅</ci><ci id="S3.SS3.SSS3.Px2.p3.2.m2.1.1.3.cmml" xref="S3.SS3.SSS3.Px2.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.Px2.p3.2.m2.1c">R^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.Px2.p3.2.m2.1d">italic_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> refers to the difference at scale <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.SSS3.Px2.p3.3.m3.1"><semantics id="S3.SS3.SSS3.Px2.p3.3.m3.1a"><mi id="S3.SS3.SSS3.Px2.p3.3.m3.1.1" xref="S3.SS3.SSS3.Px2.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.Px2.p3.3.m3.1b"><ci id="S3.SS3.SSS3.Px2.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS3.Px2.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.Px2.p3.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.Px2.p3.3.m3.1d">italic_k</annotation></semantics></math>. We use <math alttext="K=4" class="ltx_Math" display="inline" id="S3.SS3.SSS3.Px2.p3.4.m4.1"><semantics id="S3.SS3.SSS3.Px2.p3.4.m4.1a"><mrow id="S3.SS3.SSS3.Px2.p3.4.m4.1.1" xref="S3.SS3.SSS3.Px2.p3.4.m4.1.1.cmml"><mi id="S3.SS3.SSS3.Px2.p3.4.m4.1.1.2" xref="S3.SS3.SSS3.Px2.p3.4.m4.1.1.2.cmml">K</mi><mo id="S3.SS3.SSS3.Px2.p3.4.m4.1.1.1" xref="S3.SS3.SSS3.Px2.p3.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS3.Px2.p3.4.m4.1.1.3" xref="S3.SS3.SSS3.Px2.p3.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.Px2.p3.4.m4.1b"><apply id="S3.SS3.SSS3.Px2.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS3.Px2.p3.4.m4.1.1"><eq id="S3.SS3.SSS3.Px2.p3.4.m4.1.1.1.cmml" xref="S3.SS3.SSS3.Px2.p3.4.m4.1.1.1"></eq><ci id="S3.SS3.SSS3.Px2.p3.4.m4.1.1.2.cmml" xref="S3.SS3.SSS3.Px2.p3.4.m4.1.1.2">𝐾</ci><cn id="S3.SS3.SSS3.Px2.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.Px2.p3.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.Px2.p3.4.m4.1c">K=4</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.Px2.p3.4.m4.1d">italic_K = 4</annotation></semantics></math> scales, progressively reducing the resolution by half at each level.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS3.Px3">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.Px3.1.1">Final Loss</span>:</h5>
<div class="ltx_para" id="S3.SS3.SSS3.Px3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.Px3.p1.1">The overall loss for a training set <math alttext="l" class="ltx_Math" display="inline" id="S3.SS3.SSS3.Px3.p1.1.m1.1"><semantics id="S3.SS3.SSS3.Px3.p1.1.m1.1a"><mi id="S3.SS3.SSS3.Px3.p1.1.m1.1.1" xref="S3.SS3.SSS3.Px3.p1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.Px3.p1.1.m1.1b"><ci id="S3.SS3.SSS3.Px3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS3.Px3.p1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.Px3.p1.1.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.Px3.p1.1.m1.1d">italic_l</annotation></semantics></math> is a combination of the scale- and shift-invariant loss (Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.E9" title="Equation 9 ‣ Scale- and Shift-Invariant Loss: ‣ 3.3.3 Loss Function ‣ 3.3 Step 2: Training of the Student Model ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">9</span></a>) and the gradient matching term (Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S3.E10" title="Equation 10 ‣ Gradient Matching Term: ‣ 3.3.3 Loss Function ‣ 3.3 Step 2: Training of the Student Model ‣ 3 Method ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">10</span></a>):</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.Px3.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\mathcal{L}_{l}=\frac{1}{N_{l}}\sum_{n=1}^{N_{l}}\left(\mathcal{L}_{ssi}\big{(%
}\hat{\mathbf{d}}^{n},(\hat{\mathbf{d}}^{*})^{n}\big{)}+\alpha\;\mathcal{L}_{%
reg}\big{(}\hat{\mathbf{d}}^{n},(\hat{\mathbf{d}}^{*})^{n}\big{)}\right)," class="ltx_Math" display="block" id="S3.E11.m1.1"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml"><mrow id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml"><msub id="S3.E11.m1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.1.1.1.1.3.2" xref="S3.E11.m1.1.1.1.1.3.2.cmml">ℒ</mi><mi id="S3.E11.m1.1.1.1.1.3.3" xref="S3.E11.m1.1.1.1.1.3.3.cmml">l</mi></msub><mo id="S3.E11.m1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E11.m1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.cmml"><mfrac id="S3.E11.m1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.3.cmml"><mn id="S3.E11.m1.1.1.1.1.1.3.2" xref="S3.E11.m1.1.1.1.1.1.3.2.cmml">1</mn><msub id="S3.E11.m1.1.1.1.1.1.3.3" xref="S3.E11.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.E11.m1.1.1.1.1.1.3.3.2" xref="S3.E11.m1.1.1.1.1.1.3.3.2.cmml">N</mi><mi id="S3.E11.m1.1.1.1.1.1.3.3.3" xref="S3.E11.m1.1.1.1.1.1.3.3.3.cmml">l</mi></msub></mfrac><mo id="S3.E11.m1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.cmml"><munderover id="S3.E11.m1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E11.m1.1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E11.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E11.m1.1.1.1.1.1.1.2.2.3" xref="S3.E11.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E11.m1.1.1.1.1.1.1.2.2.3.2.cmml">n</mi><mo id="S3.E11.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E11.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E11.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E11.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E11.m1.1.1.1.1.1.1.2.3" xref="S3.E11.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.2.3.2" xref="S3.E11.m1.1.1.1.1.1.1.2.3.2.cmml">N</mi><mi id="S3.E11.m1.1.1.1.1.1.1.2.3.3" xref="S3.E11.m1.1.1.1.1.1.1.2.3.3.cmml">l</mi></msub></munderover><mrow id="S3.E11.m1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.2.cmml">ℒ</mi><mrow id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.2.cmml">s</mi><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.3.cmml">s</mi><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.1a" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.4" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.4.cmml">i</mi></mrow></msub><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" maxsize="120%" minsize="120%" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msup id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐝</mi><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msup id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mrow id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.cmml"><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.2" stretchy="false" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.cmml">(</mo><msup id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.cmml"><mover accent="true" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.2.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.2.2.cmml">𝐝</mi><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.2.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.3" stretchy="false" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">n</mi></msup><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.5" maxsize="120%" minsize="120%" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.5" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.5.cmml">+</mo><mrow id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.4" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.4.cmml">α</mi><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.3" lspace="0.280em" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.3.cmml">⁢</mo><msub id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.2.cmml">ℒ</mi><mrow id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.2.cmml">r</mi><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.3.cmml">e</mi><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.1a" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.4" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.4.cmml">g</mi></mrow></msub><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.3a" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.3.cmml">⁢</mo><mrow id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.3.cmml"><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.3" maxsize="120%" minsize="120%" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.3.cmml">(</mo><msup id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.cmml"><mover accent="true" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.2.cmml">𝐝</mi><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.3.cmml">n</mi></msup><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.4" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.3.cmml">,</mo><msup id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.cmml"><mrow id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml"><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.2" stretchy="false" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml">(</mo><msup id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml"><mover accent="true" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.cmml"><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.2.cmml">𝐝</mi><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.1" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.3" stretchy="false" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.3.cmml">n</mi></msup><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.5" maxsize="120%" minsize="120%" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E11.m1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E11.m1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1b"><apply id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1"><eq id="S3.E11.m1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.2"></eq><apply id="S3.E11.m1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E11.m1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E11.m1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1"><times id="S3.E11.m1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.2"></times><apply id="S3.E11.m1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.3"><divide id="S3.E11.m1.1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.1.1.1.3"></divide><cn id="S3.E11.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E11.m1.1.1.1.1.1.3.2">1</cn><apply id="S3.E11.m1.1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E11.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E11.m1.1.1.1.1.1.3.3.2">𝑁</ci><ci id="S3.E11.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E11.m1.1.1.1.1.1.3.3.3">𝑙</ci></apply></apply><apply id="S3.E11.m1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1"><apply id="S3.E11.m1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E11.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E11.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.2.3"><eq id="S3.E11.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E11.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.2.3.2">𝑛</ci><cn id="S3.E11.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E11.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E11.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.3.2">𝑁</ci><ci id="S3.E11.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.3.3">𝑙</ci></apply></apply><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1"><plus id="S3.E11.m1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.5"></plus><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2"><times id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.3"></times><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.2">ℒ</ci><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3"><times id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.1"></times><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.2">𝑠</ci><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.3">𝑠</ci><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.4.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.4.3.4">𝑖</ci></apply></apply><interval closure="open" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2"><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐝</ci></apply><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.2"><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.2.1">^</ci><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.2.2">𝐝</ci></apply><times id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.1.1.3"></times></apply><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑛</ci></apply></interval></apply><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4"><times id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.3"></times><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.4.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.4">𝛼</ci><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.2">ℒ</ci><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3"><times id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.1"></times><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.2">𝑟</ci><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.3">𝑒</ci><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.4.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.5.3.4">𝑔</ci></apply></apply><interval closure="open" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2"><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.2"><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.1">^</ci><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.2.2">𝐝</ci></apply><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.3.1.1.1.3">𝑛</ci></apply><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1">superscript</csymbol><apply id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2"><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.1">^</ci><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.2">𝐝</ci></apply><times id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.3"></times></apply><ci id="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1.1.1.4.2.2.2.3">𝑛</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1c">\mathcal{L}_{l}=\frac{1}{N_{l}}\sum_{n=1}^{N_{l}}\left(\mathcal{L}_{ssi}\big{(%
}\hat{\mathbf{d}}^{n},(\hat{\mathbf{d}}^{*})^{n}\big{)}+\alpha\;\mathcal{L}_{%
reg}\big{(}\hat{\mathbf{d}}^{n},(\hat{\mathbf{d}}^{*})^{n}\big{)}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( caligraphic_L start_POSTSUBSCRIPT italic_s italic_s italic_i end_POSTSUBSCRIPT ( over^ start_ARG bold_d end_ARG start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT , ( over^ start_ARG bold_d end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ) + italic_α caligraphic_L start_POSTSUBSCRIPT italic_r italic_e italic_g end_POSTSUBSCRIPT ( over^ start_ARG bold_d end_ARG start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT , ( over^ start_ARG bold_d end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.Px3.p3">
<p class="ltx_p" id="S3.SS3.SSS3.Px3.p3.3">where <math alttext="N_{l}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.Px3.p3.1.m1.1"><semantics id="S3.SS3.SSS3.Px3.p3.1.m1.1a"><msub id="S3.SS3.SSS3.Px3.p3.1.m1.1.1" xref="S3.SS3.SSS3.Px3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.SSS3.Px3.p3.1.m1.1.1.2" xref="S3.SS3.SSS3.Px3.p3.1.m1.1.1.2.cmml">N</mi><mi id="S3.SS3.SSS3.Px3.p3.1.m1.1.1.3" xref="S3.SS3.SSS3.Px3.p3.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.Px3.p3.1.m1.1b"><apply id="S3.SS3.SSS3.Px3.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS3.Px3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.Px3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.Px3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.Px3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.Px3.p3.1.m1.1.1.2">𝑁</ci><ci id="S3.SS3.SSS3.Px3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.Px3.p3.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.Px3.p3.1.m1.1c">N_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.Px3.p3.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> is the size of the training set, and the weighting parameter <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.SSS3.Px3.p3.2.m2.1"><semantics id="S3.SS3.SSS3.Px3.p3.2.m2.1a"><mi id="S3.SS3.SSS3.Px3.p3.2.m2.1.1" xref="S3.SS3.SSS3.Px3.p3.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.Px3.p3.2.m2.1b"><ci id="S3.SS3.SSS3.Px3.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS3.Px3.p3.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.Px3.p3.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.Px3.p3.2.m2.1d">italic_α</annotation></semantics></math> is set to <math alttext="0.5" class="ltx_Math" display="inline" id="S3.SS3.SSS3.Px3.p3.3.m3.1"><semantics id="S3.SS3.SSS3.Px3.p3.3.m3.1a"><mn id="S3.SS3.SSS3.Px3.p3.3.m3.1.1" xref="S3.SS3.SSS3.Px3.p3.3.m3.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.Px3.p3.3.m3.1b"><cn id="S3.SS3.SSS3.Px3.p3.3.m3.1.1.cmml" type="float" xref="S3.SS3.SSS3.Px3.p3.3.m3.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.Px3.p3.3.m3.1c">0.5</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.Px3.p3.3.m3.1d">0.5</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.Px3.p4">
<p class="ltx_p" id="S3.SS3.SSS3.Px3.p4.1">This carefully designed loss structure ensures both accurate depth prediction and the precise alignment of salient features, such as edges, between the predicted and ground truth disparities. This approach ensures that the model produces high-quality, affine-invariant inverse depth maps while effectively mitigating the impact of noisy pseudo-labels during the training process. We apply the same loss formulation to surface normals, ensuring consistency and accuracy across varying scales and shifts, ultimately contributing to the overall robustness of the model.</p>
</div>
</section>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">This section evaluates the performance of our proposed method for underwater monocular depth and surface normals estimation. We benchmark our approach against state-of-the-art methods, focusing on key metrics such as accuracy, inference speed, and computational cost, to highlight the model’s efficacy in resource-constrained environments. Extensive tests on real-world underwater datasets demonstrate the accuracy, computational efficiency, and generalisation capabilities of our lightweight hybrid CNN-Transformer model, particularly for real-time applications on edge devices.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Implementation Details</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.8">The proposed method is implemented in PyTorch and trained on a Linux platform using a single NVIDIA GeForce RTX 4090 GPU, with a batch size of 22. The Adam optimizer <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib13" title="">13</a>]</cite> is employed, using <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><msub id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2.2" xref="S4.SS1.p1.1.m1.1.1.2.2.cmml">β</mi><mn id="S4.SS1.p1.1.m1.1.1.2.3" xref="S4.SS1.p1.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><eq id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></eq><apply id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2.2">𝛽</ci><cn id="S4.SS1.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.2.3">1</cn></apply><cn id="S4.SS1.p1.1.m1.1.1.3.cmml" type="float" xref="S4.SS1.p1.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\beta_{1}=0.9</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.999" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><msub id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.cmml">β</mi><mn id="S4.SS1.p1.2.m2.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><eq id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></eq><apply id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2">𝛽</ci><cn id="S4.SS1.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.1.2.3">2</cn></apply><cn id="S4.SS1.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS1.p1.2.m2.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\beta_{2}=0.999</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.999</annotation></semantics></math>, and <math alttext="\epsilon=1.0\times 10^{-8}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">ϵ</mi><mo id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml"><mn id="S4.SS1.p1.3.m3.1.1.3.2" xref="S4.SS1.p1.3.m3.1.1.3.2.cmml">1.0</mn><mo id="S4.SS1.p1.3.m3.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.3.m3.1.1.3.1.cmml">×</mo><msup id="S4.SS1.p1.3.m3.1.1.3.3" xref="S4.SS1.p1.3.m3.1.1.3.3.cmml"><mn id="S4.SS1.p1.3.m3.1.1.3.3.2" xref="S4.SS1.p1.3.m3.1.1.3.3.2.cmml">10</mn><mrow id="S4.SS1.p1.3.m3.1.1.3.3.3" xref="S4.SS1.p1.3.m3.1.1.3.3.3.cmml"><mo id="S4.SS1.p1.3.m3.1.1.3.3.3a" xref="S4.SS1.p1.3.m3.1.1.3.3.3.cmml">−</mo><mn id="S4.SS1.p1.3.m3.1.1.3.3.3.2" xref="S4.SS1.p1.3.m3.1.1.3.3.3.2.cmml">8</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><eq id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1"></eq><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">italic-ϵ</ci><apply id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3"><times id="S4.SS1.p1.3.m3.1.1.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3.1"></times><cn id="S4.SS1.p1.3.m3.1.1.3.2.cmml" type="float" xref="S4.SS1.p1.3.m3.1.1.3.2">1.0</cn><apply id="S4.SS1.p1.3.m3.1.1.3.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3">superscript</csymbol><cn id="S4.SS1.p1.3.m3.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1.3.3.2">10</cn><apply id="S4.SS1.p1.3.m3.1.1.3.3.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3.3"><minus id="S4.SS1.p1.3.m3.1.1.3.3.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3.3"></minus><cn id="S4.SS1.p1.3.m3.1.1.3.3.3.2.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1.3.3.3.2">8</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\epsilon=1.0\times 10^{-8}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_ϵ = 1.0 × 10 start_POSTSUPERSCRIPT - 8 end_POSTSUPERSCRIPT</annotation></semantics></math>. The initial learning rate is set to <math alttext="lr_{initial}=1\times 10^{-4}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mrow id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2.2" xref="S4.SS1.p1.4.m4.1.1.2.2.cmml">l</mi><mo id="S4.SS1.p1.4.m4.1.1.2.1" xref="S4.SS1.p1.4.m4.1.1.2.1.cmml">⁢</mo><msub id="S4.SS1.p1.4.m4.1.1.2.3" xref="S4.SS1.p1.4.m4.1.1.2.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2.3.2" xref="S4.SS1.p1.4.m4.1.1.2.3.2.cmml">r</mi><mrow id="S4.SS1.p1.4.m4.1.1.2.3.3" xref="S4.SS1.p1.4.m4.1.1.2.3.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2.3.3.2" xref="S4.SS1.p1.4.m4.1.1.2.3.3.2.cmml">i</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.3.1" xref="S4.SS1.p1.4.m4.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.3.3" xref="S4.SS1.p1.4.m4.1.1.2.3.3.3.cmml">n</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.3.1a" xref="S4.SS1.p1.4.m4.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.3.4" xref="S4.SS1.p1.4.m4.1.1.2.3.3.4.cmml">i</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.3.1b" xref="S4.SS1.p1.4.m4.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.3.5" xref="S4.SS1.p1.4.m4.1.1.2.3.3.5.cmml">t</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.3.1c" xref="S4.SS1.p1.4.m4.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.3.6" xref="S4.SS1.p1.4.m4.1.1.2.3.3.6.cmml">i</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.3.1d" xref="S4.SS1.p1.4.m4.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.3.7" xref="S4.SS1.p1.4.m4.1.1.2.3.3.7.cmml">a</mi><mo id="S4.SS1.p1.4.m4.1.1.2.3.3.1e" xref="S4.SS1.p1.4.m4.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3.3.8" xref="S4.SS1.p1.4.m4.1.1.2.3.3.8.cmml">l</mi></mrow></msub></mrow><mo id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml"><mn id="S4.SS1.p1.4.m4.1.1.3.2" xref="S4.SS1.p1.4.m4.1.1.3.2.cmml">1</mn><mo id="S4.SS1.p1.4.m4.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.4.m4.1.1.3.1.cmml">×</mo><msup id="S4.SS1.p1.4.m4.1.1.3.3" xref="S4.SS1.p1.4.m4.1.1.3.3.cmml"><mn id="S4.SS1.p1.4.m4.1.1.3.3.2" xref="S4.SS1.p1.4.m4.1.1.3.3.2.cmml">10</mn><mrow id="S4.SS1.p1.4.m4.1.1.3.3.3" xref="S4.SS1.p1.4.m4.1.1.3.3.3.cmml"><mo id="S4.SS1.p1.4.m4.1.1.3.3.3a" xref="S4.SS1.p1.4.m4.1.1.3.3.3.cmml">−</mo><mn id="S4.SS1.p1.4.m4.1.1.3.3.3.2" xref="S4.SS1.p1.4.m4.1.1.3.3.3.2.cmml">4</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><eq id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"></eq><apply id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2"><times id="S4.SS1.p1.4.m4.1.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.1.2.1"></times><ci id="S4.SS1.p1.4.m4.1.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2.2">𝑙</ci><apply id="S4.SS1.p1.4.m4.1.1.2.3.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.2.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.2">𝑟</ci><apply id="S4.SS1.p1.4.m4.1.1.2.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.3"><times id="S4.SS1.p1.4.m4.1.1.2.3.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.3.1"></times><ci id="S4.SS1.p1.4.m4.1.1.2.3.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.3.2">𝑖</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.3.3">𝑛</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.3.4.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.3.4">𝑖</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.3.5.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.3.5">𝑡</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.3.6.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.3.6">𝑖</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.3.7.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.3.7">𝑎</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.3.8.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3.3.8">𝑙</ci></apply></apply></apply><apply id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3"><times id="S4.SS1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.3.1"></times><cn id="S4.SS1.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.1.3.2">1</cn><apply id="S4.SS1.p1.4.m4.1.1.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3">superscript</csymbol><cn id="S4.SS1.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.1.3.3.2">10</cn><apply id="S4.SS1.p1.4.m4.1.1.3.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.3"><minus id="S4.SS1.p1.4.m4.1.1.3.3.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3.3"></minus><cn id="S4.SS1.p1.4.m4.1.1.3.3.3.2.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.1.3.3.3.2">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">lr_{initial}=1\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_l italic_r start_POSTSUBSCRIPT italic_i italic_n italic_i italic_t italic_i italic_a italic_l end_POSTSUBSCRIPT = 1 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, which linearly decays to <math alttext="lr_{final}=1\times 10^{-6}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mrow id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2.2" xref="S4.SS1.p1.5.m5.1.1.2.2.cmml">l</mi><mo id="S4.SS1.p1.5.m5.1.1.2.1" xref="S4.SS1.p1.5.m5.1.1.2.1.cmml">⁢</mo><msub id="S4.SS1.p1.5.m5.1.1.2.3" xref="S4.SS1.p1.5.m5.1.1.2.3.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2.3.2" xref="S4.SS1.p1.5.m5.1.1.2.3.2.cmml">r</mi><mrow id="S4.SS1.p1.5.m5.1.1.2.3.3" xref="S4.SS1.p1.5.m5.1.1.2.3.3.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2.3.3.2" xref="S4.SS1.p1.5.m5.1.1.2.3.3.2.cmml">f</mi><mo id="S4.SS1.p1.5.m5.1.1.2.3.3.1" xref="S4.SS1.p1.5.m5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.2.3.3.3" xref="S4.SS1.p1.5.m5.1.1.2.3.3.3.cmml">i</mi><mo id="S4.SS1.p1.5.m5.1.1.2.3.3.1a" xref="S4.SS1.p1.5.m5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.2.3.3.4" xref="S4.SS1.p1.5.m5.1.1.2.3.3.4.cmml">n</mi><mo id="S4.SS1.p1.5.m5.1.1.2.3.3.1b" xref="S4.SS1.p1.5.m5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.2.3.3.5" xref="S4.SS1.p1.5.m5.1.1.2.3.3.5.cmml">a</mi><mo id="S4.SS1.p1.5.m5.1.1.2.3.3.1c" xref="S4.SS1.p1.5.m5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.2.3.3.6" xref="S4.SS1.p1.5.m5.1.1.2.3.3.6.cmml">l</mi></mrow></msub></mrow><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml"><mn id="S4.SS1.p1.5.m5.1.1.3.2" xref="S4.SS1.p1.5.m5.1.1.3.2.cmml">1</mn><mo id="S4.SS1.p1.5.m5.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.5.m5.1.1.3.1.cmml">×</mo><msup id="S4.SS1.p1.5.m5.1.1.3.3" xref="S4.SS1.p1.5.m5.1.1.3.3.cmml"><mn id="S4.SS1.p1.5.m5.1.1.3.3.2" xref="S4.SS1.p1.5.m5.1.1.3.3.2.cmml">10</mn><mrow id="S4.SS1.p1.5.m5.1.1.3.3.3" xref="S4.SS1.p1.5.m5.1.1.3.3.3.cmml"><mo id="S4.SS1.p1.5.m5.1.1.3.3.3a" xref="S4.SS1.p1.5.m5.1.1.3.3.3.cmml">−</mo><mn id="S4.SS1.p1.5.m5.1.1.3.3.3.2" xref="S4.SS1.p1.5.m5.1.1.3.3.3.2.cmml">6</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><eq id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"></eq><apply id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2"><times id="S4.SS1.p1.5.m5.1.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.1.2.1"></times><ci id="S4.SS1.p1.5.m5.1.1.2.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2.2">𝑙</ci><apply id="S4.SS1.p1.5.m5.1.1.2.3.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.2.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.3.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.2">𝑟</ci><apply id="S4.SS1.p1.5.m5.1.1.2.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.3"><times id="S4.SS1.p1.5.m5.1.1.2.3.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.3.1"></times><ci id="S4.SS1.p1.5.m5.1.1.2.3.3.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.3.2">𝑓</ci><ci id="S4.SS1.p1.5.m5.1.1.2.3.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.3.3">𝑖</ci><ci id="S4.SS1.p1.5.m5.1.1.2.3.3.4.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.3.4">𝑛</ci><ci id="S4.SS1.p1.5.m5.1.1.2.3.3.5.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.3.5">𝑎</ci><ci id="S4.SS1.p1.5.m5.1.1.2.3.3.6.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3.3.6">𝑙</ci></apply></apply></apply><apply id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3"><times id="S4.SS1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.3.1"></times><cn id="S4.SS1.p1.5.m5.1.1.3.2.cmml" type="integer" xref="S4.SS1.p1.5.m5.1.1.3.2">1</cn><apply id="S4.SS1.p1.5.m5.1.1.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.3.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3">superscript</csymbol><cn id="S4.SS1.p1.5.m5.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p1.5.m5.1.1.3.3.2">10</cn><apply id="S4.SS1.p1.5.m5.1.1.3.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3.3"><minus id="S4.SS1.p1.5.m5.1.1.3.3.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3.3"></minus><cn id="S4.SS1.p1.5.m5.1.1.3.3.3.2.cmml" type="integer" xref="S4.SS1.p1.5.m5.1.1.3.3.3.2">6</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">lr_{final}=1\times 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_l italic_r start_POSTSUBSCRIPT italic_f italic_i italic_n italic_a italic_l end_POSTSUBSCRIPT = 1 × 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math> over the final <math alttext="100" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mn id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><cn id="S4.SS1.p1.6.m6.1.1.cmml" type="integer" xref="S4.SS1.p1.6.m6.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">100</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">100</annotation></semantics></math> epochs. The model was trained on RGB-D image pairs, covering diverse underwater scenes, for a total of <math alttext="400" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1"><semantics id="S4.SS1.p1.7.m7.1a"><mn id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">400</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><cn id="S4.SS1.p1.7.m7.1.1.cmml" type="integer" xref="S4.SS1.p1.7.m7.1.1">400</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">400</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.1d">400</annotation></semantics></math> epochs. The complete training process takes approximately <math alttext="48" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m8.1"><semantics id="S4.SS1.p1.8.m8.1a"><mn id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">48</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><cn id="S4.SS1.p1.8.m8.1.1.cmml" type="integer" xref="S4.SS1.p1.8.m8.1.1">48</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">48</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m8.1d">48</annotation></semantics></math> hours on the specified hardware.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Datasets</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">This research used a variety of publicly available underwater image datasets, as detailed in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.T1" title="Table 1 ‣ 4.2 Datasets ‣ 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">1</span></a> to train and evaluate the performance of our proposed method. These datasets represent diverse underwater environments with variations in water clarity, lighting conditions, and object types. The data sets were divided into different training and testing sets.
Unlike previous methods, our approach did <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1"> not</span> rely on ground-truth depth maps or surface normals during training, highlighting the strength of our pseudo-labelling technique.
Using these data sets, we ensured a robust evaluation of our method for both depth and surface normal estimation in challenging underwater scenarios.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Dataset Overview</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.2">
<tr class="ltx_tr" id="S4.T1.2.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.2.3.1"><span class="ltx_text ltx_font_bold" id="S4.T1.2.3.1.1">Dataset</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.3.2"><span class="ltx_text ltx_font_bold" id="S4.T1.2.3.2.1">Type</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.2.3.3"><span class="ltx_text ltx_font_bold" id="S4.T1.2.3.3.1">Samples</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.3.4"><span class="ltx_text ltx_font_bold" id="S4.T1.2.3.4.1">Key Characteristics</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.1.2">USOD10K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib11" title="">11</a>]</cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.1.1.3">Train/Test</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.4">9229/1026</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.1.1.1">
<math alttext="640\times 480" class="ltx_Math" display="inline" id="S4.T1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml"><mn id="S4.T1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.m1.1.1.2.cmml">640</mn><mo id="S4.T1.1.1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T1.1.1.1.m1.1.1.1.cmml">×</mo><mn id="S4.T1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.m1.1.1.3.cmml">480</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"><times id="S4.T1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1.1"></times><cn id="S4.T1.1.1.1.m1.1.1.2.cmml" type="integer" xref="S4.T1.1.1.1.m1.1.1.2">640</cn><cn id="S4.T1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T1.1.1.1.m1.1.1.3">480</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">640\times 480</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">640 × 480</annotation></semantics></math> RGB images with depth maps from 12 scenes</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.2.4.1">DRUVA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib20" title="">20</a>]</cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.4.2">Train/Test</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.2.4.3">2000</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.4.4">Video sequences of submerged rocks, shallow waters</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.2.5.1">DeepFish <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib18" title="">18</a>]</cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.5.2">Train/Test</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.2.5.3">5000</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.5.4">Underwater images from tropical Australian waters</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.2.2.2">Atlantis <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib28" title="">28</a>]</cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.2.3">Test</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.2.2.4">3200</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.2.1">
<math alttext="672\times 512" class="ltx_Math" display="inline" id="S4.T1.2.2.1.m1.1"><semantics id="S4.T1.2.2.1.m1.1a"><mrow id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml"><mn id="S4.T1.2.2.1.m1.1.1.2" xref="S4.T1.2.2.1.m1.1.1.2.cmml">672</mn><mo id="S4.T1.2.2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T1.2.2.1.m1.1.1.1.cmml">×</mo><mn id="S4.T1.2.2.1.m1.1.1.3" xref="S4.T1.2.2.1.m1.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><apply id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1"><times id="S4.T1.2.2.1.m1.1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1.1"></times><cn id="S4.T1.2.2.1.m1.1.1.2.cmml" type="integer" xref="S4.T1.2.2.1.m1.1.1.2">672</cn><cn id="S4.T1.2.2.1.m1.1.1.3.cmml" type="integer" xref="S4.T1.2.2.1.m1.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">672\times 512</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.1.m1.1d">672 × 512</annotation></semantics></math> images, varied underwater environments</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.2.6.1">Sea-Thru <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib1" title="">1</a>]</cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.6.2">Test</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.2.6.3">1100</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.6.4">Depth-varied underwater images for depth estimation</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.7">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.2.7.1">SQUID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib4" title="">4</a>]</cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.7.2">Test</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.2.7.3">114</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.7.4">Stereo image dataset with distance maps</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.8">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.2.8.1">iBims-1 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib14" title="">14</a>]</cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S4.T1.2.8.2">Train/Test</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T1.2.8.3">108</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S4.T1.2.8.4">RGB-D dataset for surface normal estimation benchmark</td>
</tr>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Evaluation Metrics</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We employed widely used evaluation metrics to rigorously assess the performance of our model. These metrics are commonly used for both depth estimation and normal estimation tasks, allowing for a standardised comparison with existing methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib29" title="">29</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p2.1.1">Depth Estimation Metrics:</span>
Following established practices in the field <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib27" title="">27</a>]</cite>, we assessed depth estimation performance using the following metrics:</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">Absolute Relative Error (Abs Rel):</span>
<math alttext="\text{AbsRel}=\frac{1}{N}\sum_{i=1}^{N}\frac{|d_{i}-d_{i}^{*}|}{d_{i}^{*}}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><mrow id="S4.I1.i1.p1.1.m1.1.2" xref="S4.I1.i1.p1.1.m1.1.2.cmml"><mtext id="S4.I1.i1.p1.1.m1.1.2.2" xref="S4.I1.i1.p1.1.m1.1.2.2a.cmml">AbsRel</mtext><mo id="S4.I1.i1.p1.1.m1.1.2.1" xref="S4.I1.i1.p1.1.m1.1.2.1.cmml">=</mo><mrow id="S4.I1.i1.p1.1.m1.1.2.3" xref="S4.I1.i1.p1.1.m1.1.2.3.cmml"><mfrac id="S4.I1.i1.p1.1.m1.1.2.3.2" xref="S4.I1.i1.p1.1.m1.1.2.3.2.cmml"><mn id="S4.I1.i1.p1.1.m1.1.2.3.2.2" xref="S4.I1.i1.p1.1.m1.1.2.3.2.2.cmml">1</mn><mi id="S4.I1.i1.p1.1.m1.1.2.3.2.3" xref="S4.I1.i1.p1.1.m1.1.2.3.2.3.cmml">N</mi></mfrac><mo id="S4.I1.i1.p1.1.m1.1.2.3.1" xref="S4.I1.i1.p1.1.m1.1.2.3.1.cmml">⁢</mo><mrow id="S4.I1.i1.p1.1.m1.1.2.3.3" xref="S4.I1.i1.p1.1.m1.1.2.3.3.cmml"><msubsup id="S4.I1.i1.p1.1.m1.1.2.3.3.1" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.cmml"><mo id="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.2" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.cmml"><mi id="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.2" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.2.cmml">i</mi><mo id="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.1" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.3" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.I1.i1.p1.1.m1.1.2.3.3.1.3" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.3.cmml">N</mi></msubsup><mfrac id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mrow id="S4.I1.i1.p1.1.m1.1.1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.1.2.cmml"><mo id="S4.I1.i1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S4.I1.i1.p1.1.m1.1.1.1.2.1.cmml">|</mo><mrow id="S4.I1.i1.p1.1.m1.1.1.1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.cmml"><msub id="S4.I1.i1.p1.1.m1.1.1.1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.1.1.1.2.2" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mi id="S4.I1.i1.p1.1.m1.1.1.1.1.1.2.3" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.I1.i1.p1.1.m1.1.1.1.1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.I1.i1.p1.1.m1.1.1.1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.2.2" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.2.2.cmml">d</mi><mi id="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.cmml">i</mi><mo id="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.3" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.3.cmml">∗</mo></msubsup></mrow><mo id="S4.I1.i1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S4.I1.i1.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow><msubsup id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.3.2.2" xref="S4.I1.i1.p1.1.m1.1.1.3.2.2.cmml">d</mi><mi id="S4.I1.i1.p1.1.m1.1.1.3.2.3" xref="S4.I1.i1.p1.1.m1.1.1.3.2.3.cmml">i</mi><mo id="S4.I1.i1.p1.1.m1.1.1.3.3" xref="S4.I1.i1.p1.1.m1.1.1.3.3.cmml">∗</mo></msubsup></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.2"><eq id="S4.I1.i1.p1.1.m1.1.2.1.cmml" xref="S4.I1.i1.p1.1.m1.1.2.1"></eq><ci id="S4.I1.i1.p1.1.m1.1.2.2a.cmml" xref="S4.I1.i1.p1.1.m1.1.2.2"><mtext id="S4.I1.i1.p1.1.m1.1.2.2.cmml" xref="S4.I1.i1.p1.1.m1.1.2.2">AbsRel</mtext></ci><apply id="S4.I1.i1.p1.1.m1.1.2.3.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3"><times id="S4.I1.i1.p1.1.m1.1.2.3.1.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.1"></times><apply id="S4.I1.i1.p1.1.m1.1.2.3.2.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.2"><divide id="S4.I1.i1.p1.1.m1.1.2.3.2.1.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.2"></divide><cn id="S4.I1.i1.p1.1.m1.1.2.3.2.2.cmml" type="integer" xref="S4.I1.i1.p1.1.m1.1.2.3.2.2">1</cn><ci id="S4.I1.i1.p1.1.m1.1.2.3.2.3.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.2.3">𝑁</ci></apply><apply id="S4.I1.i1.p1.1.m1.1.2.3.3.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.3"><apply id="S4.I1.i1.p1.1.m1.1.2.3.3.1.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.2.3.3.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1">superscript</csymbol><apply id="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.1.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1">subscript</csymbol><sum id="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.2.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.2"></sum><apply id="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3"><eq id="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.1.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.1"></eq><ci id="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.2.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.2">𝑖</ci><cn id="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.3.cmml" type="integer" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.I1.i1.p1.1.m1.1.2.3.3.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.2.3.3.1.3">𝑁</ci></apply><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><divide id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1"></divide><apply id="S4.I1.i1.p1.1.m1.1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1"><abs id="S4.I1.i1.p1.1.m1.1.1.1.2.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.2"></abs><apply id="S4.I1.i1.p1.1.m1.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1"><minus id="S4.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.1"></minus><apply id="S4.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.2.2">𝑑</ci><ci id="S4.I1.i1.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.2.2">𝑑</ci><ci id="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.2.3">𝑖</ci></apply><times id="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1.1.1.3.3"></times></apply></apply></apply><apply id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3">superscript</csymbol><apply id="S4.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.3.2.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.3.2.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3.2.2">𝑑</ci><ci id="S4.I1.i1.p1.1.m1.1.1.3.2.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3.2.3">𝑖</ci></apply><times id="S4.I1.i1.p1.1.m1.1.1.3.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3.3"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">\text{AbsRel}=\frac{1}{N}\sum_{i=1}^{N}\frac{|d_{i}-d_{i}^{*}|}{d_{i}^{*}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">AbsRel = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG | italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT | end_ARG start_ARG italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">Squared Relative Error (Sq Rel):</span>
<math alttext="\text{SqRel}=\frac{1}{N}\sum_{i=1}^{N}\frac{(d_{i}-d_{i}^{*})^{2}}{d_{i}^{*}}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.1"><semantics id="S4.I1.i2.p1.1.m1.1a"><mrow id="S4.I1.i2.p1.1.m1.1.2" xref="S4.I1.i2.p1.1.m1.1.2.cmml"><mtext id="S4.I1.i2.p1.1.m1.1.2.2" xref="S4.I1.i2.p1.1.m1.1.2.2a.cmml">SqRel</mtext><mo id="S4.I1.i2.p1.1.m1.1.2.1" xref="S4.I1.i2.p1.1.m1.1.2.1.cmml">=</mo><mrow id="S4.I1.i2.p1.1.m1.1.2.3" xref="S4.I1.i2.p1.1.m1.1.2.3.cmml"><mfrac id="S4.I1.i2.p1.1.m1.1.2.3.2" xref="S4.I1.i2.p1.1.m1.1.2.3.2.cmml"><mn id="S4.I1.i2.p1.1.m1.1.2.3.2.2" xref="S4.I1.i2.p1.1.m1.1.2.3.2.2.cmml">1</mn><mi id="S4.I1.i2.p1.1.m1.1.2.3.2.3" xref="S4.I1.i2.p1.1.m1.1.2.3.2.3.cmml">N</mi></mfrac><mo id="S4.I1.i2.p1.1.m1.1.2.3.1" xref="S4.I1.i2.p1.1.m1.1.2.3.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.1.m1.1.2.3.3" xref="S4.I1.i2.p1.1.m1.1.2.3.3.cmml"><msubsup id="S4.I1.i2.p1.1.m1.1.2.3.3.1" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.cmml"><mo id="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.2" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.cmml"><mi id="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.2" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.2.cmml">i</mi><mo id="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.1" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.3" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.I1.i2.p1.1.m1.1.2.3.3.1.3" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.3.cmml">N</mi></msubsup><mfrac id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml"><msup id="S4.I1.i2.p1.1.m1.1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.1.cmml"><mrow id="S4.I1.i2.p1.1.m1.1.1.1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml"><mo id="S4.I1.i2.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml"><msub id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2.2" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2.2.cmml">d</mi><mi id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2.3" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2.2" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2.2.cmml">d</mi><mi id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2.3" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mo id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.3" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.3.cmml">∗</mo></msubsup></mrow><mo id="S4.I1.i2.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.I1.i2.p1.1.m1.1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.1.3.cmml">2</mn></msup><msubsup id="S4.I1.i2.p1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.3.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.3.2.2" xref="S4.I1.i2.p1.1.m1.1.1.3.2.2.cmml">d</mi><mi id="S4.I1.i2.p1.1.m1.1.1.3.2.3" xref="S4.I1.i2.p1.1.m1.1.1.3.2.3.cmml">i</mi><mo id="S4.I1.i2.p1.1.m1.1.1.3.3" xref="S4.I1.i2.p1.1.m1.1.1.3.3.cmml">∗</mo></msubsup></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><apply id="S4.I1.i2.p1.1.m1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.2"><eq id="S4.I1.i2.p1.1.m1.1.2.1.cmml" xref="S4.I1.i2.p1.1.m1.1.2.1"></eq><ci id="S4.I1.i2.p1.1.m1.1.2.2a.cmml" xref="S4.I1.i2.p1.1.m1.1.2.2"><mtext id="S4.I1.i2.p1.1.m1.1.2.2.cmml" xref="S4.I1.i2.p1.1.m1.1.2.2">SqRel</mtext></ci><apply id="S4.I1.i2.p1.1.m1.1.2.3.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3"><times id="S4.I1.i2.p1.1.m1.1.2.3.1.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.1"></times><apply id="S4.I1.i2.p1.1.m1.1.2.3.2.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.2"><divide id="S4.I1.i2.p1.1.m1.1.2.3.2.1.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.2"></divide><cn id="S4.I1.i2.p1.1.m1.1.2.3.2.2.cmml" type="integer" xref="S4.I1.i2.p1.1.m1.1.2.3.2.2">1</cn><ci id="S4.I1.i2.p1.1.m1.1.2.3.2.3.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.2.3">𝑁</ci></apply><apply id="S4.I1.i2.p1.1.m1.1.2.3.3.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.3"><apply id="S4.I1.i2.p1.1.m1.1.2.3.3.1.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.2.3.3.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1">superscript</csymbol><apply id="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.1.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1">subscript</csymbol><sum id="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.2.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.2"></sum><apply id="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3"><eq id="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.1.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.1"></eq><ci id="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.2.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.2">𝑖</ci><cn id="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.3.cmml" type="integer" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.I1.i2.p1.1.m1.1.2.3.3.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.2.3.3.1.3">𝑁</ci></apply><apply id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1"><divide id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1"></divide><apply id="S4.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1">superscript</csymbol><apply id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1"><minus id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.1"></minus><apply id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2.2">𝑑</ci><ci id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2.2">𝑑</ci><ci id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><times id="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1.1.1.1.3.3"></times></apply></apply><cn id="S4.I1.i2.p1.1.m1.1.1.1.3.cmml" type="integer" xref="S4.I1.i2.p1.1.m1.1.1.1.3">2</cn></apply><apply id="S4.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3">superscript</csymbol><apply id="S4.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.3.2.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.1.1.3.2.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.2.2">𝑑</ci><ci id="S4.I1.i2.p1.1.m1.1.1.3.2.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.2.3">𝑖</ci></apply><times id="S4.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.3"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">\text{SqRel}=\frac{1}{N}\sum_{i=1}^{N}\frac{(d_{i}-d_{i}^{*})^{2}}{d_{i}^{*}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.1d">SqRel = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG ( italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">Root Mean Squared Error (RMSE):</span>
<math alttext="\text{RMSE}=\sqrt{\frac{1}{N}\sum_{i=1}^{N}(d_{i}-d_{i}^{*})^{2}}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.m1.1"><semantics id="S4.I1.i3.p1.1.m1.1a"><mrow id="S4.I1.i3.p1.1.m1.1.2" xref="S4.I1.i3.p1.1.m1.1.2.cmml"><mtext id="S4.I1.i3.p1.1.m1.1.2.2" xref="S4.I1.i3.p1.1.m1.1.2.2a.cmml">RMSE</mtext><mo id="S4.I1.i3.p1.1.m1.1.2.1" xref="S4.I1.i3.p1.1.m1.1.2.1.cmml">=</mo><msqrt id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml"><mrow id="S4.I1.i3.p1.1.m1.1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.1.cmml"><mfrac id="S4.I1.i3.p1.1.m1.1.1.1.3" xref="S4.I1.i3.p1.1.m1.1.1.1.3.cmml"><mn id="S4.I1.i3.p1.1.m1.1.1.1.3.2" xref="S4.I1.i3.p1.1.m1.1.1.1.3.2.cmml">1</mn><mi id="S4.I1.i3.p1.1.m1.1.1.1.3.3" xref="S4.I1.i3.p1.1.m1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S4.I1.i3.p1.1.m1.1.1.1.2" xref="S4.I1.i3.p1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.I1.i3.p1.1.m1.1.1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.1.1.cmml"><msubsup id="S4.I1.i3.p1.1.m1.1.1.1.1.2" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.cmml"><mo id="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.2" rspace="0em" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.2" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.1" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.3" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.I1.i3.p1.1.m1.1.1.1.1.2.3" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.3.cmml">N</mi></msubsup><msup id="S4.I1.i3.p1.1.m1.1.1.1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.cmml"><mrow id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml">d</mi><mi id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">d</mi><mi id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mo id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">∗</mo></msubsup></mrow><mo id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.I1.i3.p1.1.m1.1.1.1.1.1.3" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><apply id="S4.I1.i3.p1.1.m1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.1.2"><eq id="S4.I1.i3.p1.1.m1.1.2.1.cmml" xref="S4.I1.i3.p1.1.m1.1.2.1"></eq><ci id="S4.I1.i3.p1.1.m1.1.2.2a.cmml" xref="S4.I1.i3.p1.1.m1.1.2.2"><mtext id="S4.I1.i3.p1.1.m1.1.2.2.cmml" xref="S4.I1.i3.p1.1.m1.1.2.2">RMSE</mtext></ci><apply id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1"><root id="S4.I1.i3.p1.1.m1.1.1a.cmml" xref="S4.I1.i3.p1.1.m1.1.1"></root><apply id="S4.I1.i3.p1.1.m1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1"><times id="S4.I1.i3.p1.1.m1.1.1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.2"></times><apply id="S4.I1.i3.p1.1.m1.1.1.1.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.3"><divide id="S4.I1.i3.p1.1.m1.1.1.1.3.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.3"></divide><cn id="S4.I1.i3.p1.1.m1.1.1.1.3.2.cmml" type="integer" xref="S4.I1.i3.p1.1.m1.1.1.1.3.2">1</cn><ci id="S4.I1.i3.p1.1.m1.1.1.1.3.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.3.3">𝑁</ci></apply><apply id="S4.I1.i3.p1.1.m1.1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1"><apply id="S4.I1.i3.p1.1.m1.1.1.1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.1.1.2.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2">superscript</csymbol><apply id="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2">subscript</csymbol><sum id="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.2"></sum><apply id="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3"><eq id="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.1"></eq><ci id="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.I1.i3.p1.1.m1.1.1.1.1.2.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.I1.i3.p1.1.m1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1"><minus id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2">𝑑</ci><ci id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.2.2">𝑑</ci><ci id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><times id="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.3"></times></apply></apply><cn id="S4.I1.i3.p1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I1.i3.p1.1.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">\text{RMSE}=\sqrt{\frac{1}{N}\sum_{i=1}^{N}(d_{i}-d_{i}^{*})^{2}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.1.m1.1d">RMSE = square-root start_ARG divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.1.1">Logarithmic Error (log10):</span>
<math alttext="\log_{10}=\frac{1}{N}\sum_{i=1}^{N}|\log_{10}(d_{i})-\log_{10}(d_{i}^{*})|" class="ltx_Math" display="inline" id="S4.I1.i4.p1.1.m1.1"><semantics id="S4.I1.i4.p1.1.m1.1a"><mrow id="S4.I1.i4.p1.1.m1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.cmml"><msub id="S4.I1.i4.p1.1.m1.1.1.3" xref="S4.I1.i4.p1.1.m1.1.1.3.cmml"><mi id="S4.I1.i4.p1.1.m1.1.1.3.2" xref="S4.I1.i4.p1.1.m1.1.1.3.2.cmml">log</mi><mn id="S4.I1.i4.p1.1.m1.1.1.3.3" xref="S4.I1.i4.p1.1.m1.1.1.3.3.cmml">10</mn></msub><mo id="S4.I1.i4.p1.1.m1.1.1.2" xref="S4.I1.i4.p1.1.m1.1.1.2.cmml">=</mo><mrow id="S4.I1.i4.p1.1.m1.1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.1.cmml"><mfrac id="S4.I1.i4.p1.1.m1.1.1.1.3" xref="S4.I1.i4.p1.1.m1.1.1.1.3.cmml"><mn id="S4.I1.i4.p1.1.m1.1.1.1.3.2" xref="S4.I1.i4.p1.1.m1.1.1.1.3.2.cmml">1</mn><mi id="S4.I1.i4.p1.1.m1.1.1.1.3.3" xref="S4.I1.i4.p1.1.m1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S4.I1.i4.p1.1.m1.1.1.1.2" xref="S4.I1.i4.p1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.I1.i4.p1.1.m1.1.1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.1.1.cmml"><msubsup id="S4.I1.i4.p1.1.m1.1.1.1.1.2" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.cmml"><mo id="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.2" rspace="0em" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.2" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.1" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.3" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.I1.i4.p1.1.m1.1.1.1.1.2.3" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.3.cmml">N</mi></msubsup><mrow id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.2.cmml"><mo id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.cmml"><mrow id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.3.cmml"><msub id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">log</mi><mn id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">10</mn></msub><mo id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2a" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.2" stretchy="false" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.2" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.2.cmml">d</mi><mi id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.3" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.3.cmml">i</mi></msub><mo id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.5" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.5.cmml">−</mo><mrow id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.3.cmml"><msub id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1.cmml"><mi id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1.2" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1.2.cmml">log</mi><mn id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1.3" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1.3.cmml">10</mn></msub><mo id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2a" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.3.cmml">⁡</mo><mrow id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.3.cmml"><mo id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.2" stretchy="false" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.3.cmml">(</mo><msubsup id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.cmml"><mi id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.2.2" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.2.2.cmml">d</mi><mi id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.2.3" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.2.3.cmml">i</mi><mo id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.3" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.3.cmml">∗</mo></msubsup><mo id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.3" stretchy="false" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.1.m1.1b"><apply id="S4.I1.i4.p1.1.m1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1"><eq id="S4.I1.i4.p1.1.m1.1.1.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.2"></eq><apply id="S4.I1.i4.p1.1.m1.1.1.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.1.1.3.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.3">subscript</csymbol><log id="S4.I1.i4.p1.1.m1.1.1.3.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.3.2"></log><cn id="S4.I1.i4.p1.1.m1.1.1.3.3.cmml" type="integer" xref="S4.I1.i4.p1.1.m1.1.1.3.3">10</cn></apply><apply id="S4.I1.i4.p1.1.m1.1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1"><times id="S4.I1.i4.p1.1.m1.1.1.1.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.2"></times><apply id="S4.I1.i4.p1.1.m1.1.1.1.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.3"><divide id="S4.I1.i4.p1.1.m1.1.1.1.3.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.3"></divide><cn id="S4.I1.i4.p1.1.m1.1.1.1.3.2.cmml" type="integer" xref="S4.I1.i4.p1.1.m1.1.1.1.3.2">1</cn><ci id="S4.I1.i4.p1.1.m1.1.1.1.3.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.3.3">𝑁</ci></apply><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1"><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.1.1.1.1.2.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2">superscript</csymbol><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2">subscript</csymbol><sum id="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.2"></sum><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3"><eq id="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.1"></eq><ci id="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.I1.i4.p1.1.m1.1.1.1.1.2.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1"><abs id="S4.I1.i4.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.2"></abs><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1"><minus id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.5.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.5"></minus><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2"><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><log id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1.2"></log><cn id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3">10</cn></apply><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.2">𝑑</ci><ci id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.2.2.2.1.3">𝑖</ci></apply></apply><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2"><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1">subscript</csymbol><log id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1.2"></log><cn id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1.3.cmml" type="integer" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.3.1.1.3">10</cn></apply><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1">superscript</csymbol><apply id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.2.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1">subscript</csymbol><ci id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.2.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.2.2">𝑑</ci><ci id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.2.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.2.3">𝑖</ci></apply><times id="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.1.1.1.1.1.4.2.2.1.3"></times></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.1.m1.1c">\log_{10}=\frac{1}{N}\sum_{i=1}^{N}|\log_{10}(d_{i})-\log_{10}(d_{i}^{*})|</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.1.m1.1d">roman_log start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT | roman_log start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT ( italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - roman_log start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT ( italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) |</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i5.p1">
<p class="ltx_p" id="S4.I1.i5.p1.6"><span class="ltx_text ltx_font_bold" id="S4.I1.i5.p1.6.1">Accuracy:</span> The percentage of predicted depths <math alttext="d_{i}" class="ltx_Math" display="inline" id="S4.I1.i5.p1.1.m1.1"><semantics id="S4.I1.i5.p1.1.m1.1a"><msub id="S4.I1.i5.p1.1.m1.1.1" xref="S4.I1.i5.p1.1.m1.1.1.cmml"><mi id="S4.I1.i5.p1.1.m1.1.1.2" xref="S4.I1.i5.p1.1.m1.1.1.2.cmml">d</mi><mi id="S4.I1.i5.p1.1.m1.1.1.3" xref="S4.I1.i5.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i5.p1.1.m1.1b"><apply id="S4.I1.i5.p1.1.m1.1.1.cmml" xref="S4.I1.i5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i5.p1.1.m1.1.1.1.cmml" xref="S4.I1.i5.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i5.p1.1.m1.1.1.2.cmml" xref="S4.I1.i5.p1.1.m1.1.1.2">𝑑</ci><ci id="S4.I1.i5.p1.1.m1.1.1.3.cmml" xref="S4.I1.i5.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i5.p1.1.m1.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i5.p1.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> such that:
<math alttext="\max\left(\frac{d_{i}}{d_{i}^{*}},\frac{d_{i}^{*}}{d_{i}}\right)&lt;\delta" class="ltx_Math" display="inline" id="S4.I1.i5.p1.2.m2.3"><semantics id="S4.I1.i5.p1.2.m2.3a"><mrow id="S4.I1.i5.p1.2.m2.3.4" xref="S4.I1.i5.p1.2.m2.3.4.cmml"><mrow id="S4.I1.i5.p1.2.m2.3.4.2.2" xref="S4.I1.i5.p1.2.m2.3.4.2.1.cmml"><mi id="S4.I1.i5.p1.2.m2.1.1" xref="S4.I1.i5.p1.2.m2.1.1.cmml">max</mi><mo id="S4.I1.i5.p1.2.m2.3.4.2.2a" xref="S4.I1.i5.p1.2.m2.3.4.2.1.cmml">⁡</mo><mrow id="S4.I1.i5.p1.2.m2.3.4.2.2.1" xref="S4.I1.i5.p1.2.m2.3.4.2.1.cmml"><mo id="S4.I1.i5.p1.2.m2.3.4.2.2.1.1" xref="S4.I1.i5.p1.2.m2.3.4.2.1.cmml">(</mo><mfrac id="S4.I1.i5.p1.2.m2.2.2" xref="S4.I1.i5.p1.2.m2.2.2.cmml"><msub id="S4.I1.i5.p1.2.m2.2.2.2" xref="S4.I1.i5.p1.2.m2.2.2.2.cmml"><mi id="S4.I1.i5.p1.2.m2.2.2.2.2" xref="S4.I1.i5.p1.2.m2.2.2.2.2.cmml">d</mi><mi id="S4.I1.i5.p1.2.m2.2.2.2.3" xref="S4.I1.i5.p1.2.m2.2.2.2.3.cmml">i</mi></msub><msubsup id="S4.I1.i5.p1.2.m2.2.2.3" xref="S4.I1.i5.p1.2.m2.2.2.3.cmml"><mi id="S4.I1.i5.p1.2.m2.2.2.3.2.2" xref="S4.I1.i5.p1.2.m2.2.2.3.2.2.cmml">d</mi><mi id="S4.I1.i5.p1.2.m2.2.2.3.2.3" xref="S4.I1.i5.p1.2.m2.2.2.3.2.3.cmml">i</mi><mo id="S4.I1.i5.p1.2.m2.2.2.3.3" xref="S4.I1.i5.p1.2.m2.2.2.3.3.cmml">∗</mo></msubsup></mfrac><mo id="S4.I1.i5.p1.2.m2.3.4.2.2.1.2" xref="S4.I1.i5.p1.2.m2.3.4.2.1.cmml">,</mo><mfrac id="S4.I1.i5.p1.2.m2.3.3" xref="S4.I1.i5.p1.2.m2.3.3.cmml"><msubsup id="S4.I1.i5.p1.2.m2.3.3.2" xref="S4.I1.i5.p1.2.m2.3.3.2.cmml"><mi id="S4.I1.i5.p1.2.m2.3.3.2.2.2" xref="S4.I1.i5.p1.2.m2.3.3.2.2.2.cmml">d</mi><mi id="S4.I1.i5.p1.2.m2.3.3.2.2.3" xref="S4.I1.i5.p1.2.m2.3.3.2.2.3.cmml">i</mi><mo id="S4.I1.i5.p1.2.m2.3.3.2.3" xref="S4.I1.i5.p1.2.m2.3.3.2.3.cmml">∗</mo></msubsup><msub id="S4.I1.i5.p1.2.m2.3.3.3" xref="S4.I1.i5.p1.2.m2.3.3.3.cmml"><mi id="S4.I1.i5.p1.2.m2.3.3.3.2" xref="S4.I1.i5.p1.2.m2.3.3.3.2.cmml">d</mi><mi id="S4.I1.i5.p1.2.m2.3.3.3.3" xref="S4.I1.i5.p1.2.m2.3.3.3.3.cmml">i</mi></msub></mfrac><mo id="S4.I1.i5.p1.2.m2.3.4.2.2.1.3" xref="S4.I1.i5.p1.2.m2.3.4.2.1.cmml">)</mo></mrow></mrow><mo id="S4.I1.i5.p1.2.m2.3.4.1" xref="S4.I1.i5.p1.2.m2.3.4.1.cmml">&lt;</mo><mi id="S4.I1.i5.p1.2.m2.3.4.3" xref="S4.I1.i5.p1.2.m2.3.4.3.cmml">δ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i5.p1.2.m2.3b"><apply id="S4.I1.i5.p1.2.m2.3.4.cmml" xref="S4.I1.i5.p1.2.m2.3.4"><lt id="S4.I1.i5.p1.2.m2.3.4.1.cmml" xref="S4.I1.i5.p1.2.m2.3.4.1"></lt><apply id="S4.I1.i5.p1.2.m2.3.4.2.1.cmml" xref="S4.I1.i5.p1.2.m2.3.4.2.2"><max id="S4.I1.i5.p1.2.m2.1.1.cmml" xref="S4.I1.i5.p1.2.m2.1.1"></max><apply id="S4.I1.i5.p1.2.m2.2.2.cmml" xref="S4.I1.i5.p1.2.m2.2.2"><divide id="S4.I1.i5.p1.2.m2.2.2.1.cmml" xref="S4.I1.i5.p1.2.m2.2.2"></divide><apply id="S4.I1.i5.p1.2.m2.2.2.2.cmml" xref="S4.I1.i5.p1.2.m2.2.2.2"><csymbol cd="ambiguous" id="S4.I1.i5.p1.2.m2.2.2.2.1.cmml" xref="S4.I1.i5.p1.2.m2.2.2.2">subscript</csymbol><ci id="S4.I1.i5.p1.2.m2.2.2.2.2.cmml" xref="S4.I1.i5.p1.2.m2.2.2.2.2">𝑑</ci><ci id="S4.I1.i5.p1.2.m2.2.2.2.3.cmml" xref="S4.I1.i5.p1.2.m2.2.2.2.3">𝑖</ci></apply><apply id="S4.I1.i5.p1.2.m2.2.2.3.cmml" xref="S4.I1.i5.p1.2.m2.2.2.3"><csymbol cd="ambiguous" id="S4.I1.i5.p1.2.m2.2.2.3.1.cmml" xref="S4.I1.i5.p1.2.m2.2.2.3">superscript</csymbol><apply id="S4.I1.i5.p1.2.m2.2.2.3.2.cmml" xref="S4.I1.i5.p1.2.m2.2.2.3"><csymbol cd="ambiguous" id="S4.I1.i5.p1.2.m2.2.2.3.2.1.cmml" xref="S4.I1.i5.p1.2.m2.2.2.3">subscript</csymbol><ci id="S4.I1.i5.p1.2.m2.2.2.3.2.2.cmml" xref="S4.I1.i5.p1.2.m2.2.2.3.2.2">𝑑</ci><ci id="S4.I1.i5.p1.2.m2.2.2.3.2.3.cmml" xref="S4.I1.i5.p1.2.m2.2.2.3.2.3">𝑖</ci></apply><times id="S4.I1.i5.p1.2.m2.2.2.3.3.cmml" xref="S4.I1.i5.p1.2.m2.2.2.3.3"></times></apply></apply><apply id="S4.I1.i5.p1.2.m2.3.3.cmml" xref="S4.I1.i5.p1.2.m2.3.3"><divide id="S4.I1.i5.p1.2.m2.3.3.1.cmml" xref="S4.I1.i5.p1.2.m2.3.3"></divide><apply id="S4.I1.i5.p1.2.m2.3.3.2.cmml" xref="S4.I1.i5.p1.2.m2.3.3.2"><csymbol cd="ambiguous" id="S4.I1.i5.p1.2.m2.3.3.2.1.cmml" xref="S4.I1.i5.p1.2.m2.3.3.2">superscript</csymbol><apply id="S4.I1.i5.p1.2.m2.3.3.2.2.cmml" xref="S4.I1.i5.p1.2.m2.3.3.2"><csymbol cd="ambiguous" id="S4.I1.i5.p1.2.m2.3.3.2.2.1.cmml" xref="S4.I1.i5.p1.2.m2.3.3.2">subscript</csymbol><ci id="S4.I1.i5.p1.2.m2.3.3.2.2.2.cmml" xref="S4.I1.i5.p1.2.m2.3.3.2.2.2">𝑑</ci><ci id="S4.I1.i5.p1.2.m2.3.3.2.2.3.cmml" xref="S4.I1.i5.p1.2.m2.3.3.2.2.3">𝑖</ci></apply><times id="S4.I1.i5.p1.2.m2.3.3.2.3.cmml" xref="S4.I1.i5.p1.2.m2.3.3.2.3"></times></apply><apply id="S4.I1.i5.p1.2.m2.3.3.3.cmml" xref="S4.I1.i5.p1.2.m2.3.3.3"><csymbol cd="ambiguous" id="S4.I1.i5.p1.2.m2.3.3.3.1.cmml" xref="S4.I1.i5.p1.2.m2.3.3.3">subscript</csymbol><ci id="S4.I1.i5.p1.2.m2.3.3.3.2.cmml" xref="S4.I1.i5.p1.2.m2.3.3.3.2">𝑑</ci><ci id="S4.I1.i5.p1.2.m2.3.3.3.3.cmml" xref="S4.I1.i5.p1.2.m2.3.3.3.3">𝑖</ci></apply></apply></apply><ci id="S4.I1.i5.p1.2.m2.3.4.3.cmml" xref="S4.I1.i5.p1.2.m2.3.4.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i5.p1.2.m2.3c">\max\left(\frac{d_{i}}{d_{i}^{*}},\frac{d_{i}^{*}}{d_{i}}\right)&lt;\delta</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i5.p1.2.m2.3d">roman_max ( divide start_ARG italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_ARG , divide start_ARG italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_ARG start_ARG italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG ) &lt; italic_δ</annotation></semantics></math>
Where <math alttext="\delta" class="ltx_Math" display="inline" id="S4.I1.i5.p1.3.m3.1"><semantics id="S4.I1.i5.p1.3.m3.1a"><mi id="S4.I1.i5.p1.3.m3.1.1" xref="S4.I1.i5.p1.3.m3.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i5.p1.3.m3.1b"><ci id="S4.I1.i5.p1.3.m3.1.1.cmml" xref="S4.I1.i5.p1.3.m3.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i5.p1.3.m3.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i5.p1.3.m3.1d">italic_δ</annotation></semantics></math> is typically set to <math alttext="\tau=1.25" class="ltx_Math" display="inline" id="S4.I1.i5.p1.4.m4.1"><semantics id="S4.I1.i5.p1.4.m4.1a"><mrow id="S4.I1.i5.p1.4.m4.1.1" xref="S4.I1.i5.p1.4.m4.1.1.cmml"><mi id="S4.I1.i5.p1.4.m4.1.1.2" xref="S4.I1.i5.p1.4.m4.1.1.2.cmml">τ</mi><mo id="S4.I1.i5.p1.4.m4.1.1.1" xref="S4.I1.i5.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.I1.i5.p1.4.m4.1.1.3" xref="S4.I1.i5.p1.4.m4.1.1.3.cmml">1.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i5.p1.4.m4.1b"><apply id="S4.I1.i5.p1.4.m4.1.1.cmml" xref="S4.I1.i5.p1.4.m4.1.1"><eq id="S4.I1.i5.p1.4.m4.1.1.1.cmml" xref="S4.I1.i5.p1.4.m4.1.1.1"></eq><ci id="S4.I1.i5.p1.4.m4.1.1.2.cmml" xref="S4.I1.i5.p1.4.m4.1.1.2">𝜏</ci><cn id="S4.I1.i5.p1.4.m4.1.1.3.cmml" type="float" xref="S4.I1.i5.p1.4.m4.1.1.3">1.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i5.p1.4.m4.1c">\tau=1.25</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i5.p1.4.m4.1d">italic_τ = 1.25</annotation></semantics></math>, <math alttext="1.25^{2}" class="ltx_Math" display="inline" id="S4.I1.i5.p1.5.m5.1"><semantics id="S4.I1.i5.p1.5.m5.1a"><msup id="S4.I1.i5.p1.5.m5.1.1" xref="S4.I1.i5.p1.5.m5.1.1.cmml"><mn id="S4.I1.i5.p1.5.m5.1.1.2" xref="S4.I1.i5.p1.5.m5.1.1.2.cmml">1.25</mn><mn id="S4.I1.i5.p1.5.m5.1.1.3" xref="S4.I1.i5.p1.5.m5.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S4.I1.i5.p1.5.m5.1b"><apply id="S4.I1.i5.p1.5.m5.1.1.cmml" xref="S4.I1.i5.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i5.p1.5.m5.1.1.1.cmml" xref="S4.I1.i5.p1.5.m5.1.1">superscript</csymbol><cn id="S4.I1.i5.p1.5.m5.1.1.2.cmml" type="float" xref="S4.I1.i5.p1.5.m5.1.1.2">1.25</cn><cn id="S4.I1.i5.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.I1.i5.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i5.p1.5.m5.1c">1.25^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i5.p1.5.m5.1d">1.25 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, or <math alttext="1.25^{3}" class="ltx_Math" display="inline" id="S4.I1.i5.p1.6.m6.1"><semantics id="S4.I1.i5.p1.6.m6.1a"><msup id="S4.I1.i5.p1.6.m6.1.1" xref="S4.I1.i5.p1.6.m6.1.1.cmml"><mn id="S4.I1.i5.p1.6.m6.1.1.2" xref="S4.I1.i5.p1.6.m6.1.1.2.cmml">1.25</mn><mn id="S4.I1.i5.p1.6.m6.1.1.3" xref="S4.I1.i5.p1.6.m6.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S4.I1.i5.p1.6.m6.1b"><apply id="S4.I1.i5.p1.6.m6.1.1.cmml" xref="S4.I1.i5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.I1.i5.p1.6.m6.1.1.1.cmml" xref="S4.I1.i5.p1.6.m6.1.1">superscript</csymbol><cn id="S4.I1.i5.p1.6.m6.1.1.2.cmml" type="float" xref="S4.I1.i5.p1.6.m6.1.1.2">1.25</cn><cn id="S4.I1.i5.p1.6.m6.1.1.3.cmml" type="integer" xref="S4.I1.i5.p1.6.m6.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i5.p1.6.m6.1c">1.25^{3}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i5.p1.6.m6.1d">1.25 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, depending on the evaluation threshold.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.3">Here, <math alttext="d_{i}" class="ltx_Math" display="inline" id="S4.SS3.p4.1.m1.1"><semantics id="S4.SS3.p4.1.m1.1a"><msub id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml"><mi id="S4.SS3.p4.1.m1.1.1.2" xref="S4.SS3.p4.1.m1.1.1.2.cmml">d</mi><mi id="S4.SS3.p4.1.m1.1.1.3" xref="S4.SS3.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><apply id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p4.1.m1.1.1.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2">𝑑</ci><ci id="S4.SS3.p4.1.m1.1.1.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the predicted depth, <math alttext="d_{i}^{*}" class="ltx_Math" display="inline" id="S4.SS3.p4.2.m2.1"><semantics id="S4.SS3.p4.2.m2.1a"><msubsup id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml"><mi id="S4.SS3.p4.2.m2.1.1.2.2" xref="S4.SS3.p4.2.m2.1.1.2.2.cmml">d</mi><mi id="S4.SS3.p4.2.m2.1.1.2.3" xref="S4.SS3.p4.2.m2.1.1.2.3.cmml">i</mi><mo id="S4.SS3.p4.2.m2.1.1.3" xref="S4.SS3.p4.2.m2.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><apply id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.1.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">superscript</csymbol><apply id="S4.SS3.p4.2.m2.1.1.2.cmml" xref="S4.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.1.1.2.1.cmml" xref="S4.SS3.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p4.2.m2.1.1.2.2.cmml" xref="S4.SS3.p4.2.m2.1.1.2.2">𝑑</ci><ci id="S4.SS3.p4.2.m2.1.1.2.3.cmml" xref="S4.SS3.p4.2.m2.1.1.2.3">𝑖</ci></apply><times id="S4.SS3.p4.2.m2.1.1.3.cmml" xref="S4.SS3.p4.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">d_{i}^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.2.m2.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is the ground truth depth, and <math alttext="N" class="ltx_Math" display="inline" id="S4.SS3.p4.3.m3.1"><semantics id="S4.SS3.p4.3.m3.1a"><mi id="S4.SS3.p4.3.m3.1.1" xref="S4.SS3.p4.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.1b"><ci id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.3.m3.1d">italic_N</annotation></semantics></math> is the total number of pixels in the depth map.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p5.1.1">Surface Normals Estimation Metrics:</span>
The evaluation of surface normals estimation relied on several error metrics designed to quantify angular error:</p>
</div>
<div class="ltx_para" id="S4.SS3.p6">
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.3"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.3.1">Mean Angular Error:</span> The mean angular error between predicted normals <math alttext="n_{i}" class="ltx_Math" display="inline" id="S4.I2.i1.p1.1.m1.1"><semantics id="S4.I2.i1.p1.1.m1.1a"><msub id="S4.I2.i1.p1.1.m1.1.1" xref="S4.I2.i1.p1.1.m1.1.1.cmml"><mi id="S4.I2.i1.p1.1.m1.1.1.2" xref="S4.I2.i1.p1.1.m1.1.1.2.cmml">n</mi><mi id="S4.I2.i1.p1.1.m1.1.1.3" xref="S4.I2.i1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.1.m1.1b"><apply id="S4.I2.i1.p1.1.m1.1.1.cmml" xref="S4.I2.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.p1.1.m1.1.1.1.cmml" xref="S4.I2.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I2.i1.p1.1.m1.1.1.2.cmml" xref="S4.I2.i1.p1.1.m1.1.1.2">𝑛</ci><ci id="S4.I2.i1.p1.1.m1.1.1.3.cmml" xref="S4.I2.i1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.1.m1.1c">n_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.1.m1.1d">italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and ground truth normals <math alttext="n_{i}^{*}" class="ltx_Math" display="inline" id="S4.I2.i1.p1.2.m2.1"><semantics id="S4.I2.i1.p1.2.m2.1a"><msubsup id="S4.I2.i1.p1.2.m2.1.1" xref="S4.I2.i1.p1.2.m2.1.1.cmml"><mi id="S4.I2.i1.p1.2.m2.1.1.2.2" xref="S4.I2.i1.p1.2.m2.1.1.2.2.cmml">n</mi><mi id="S4.I2.i1.p1.2.m2.1.1.2.3" xref="S4.I2.i1.p1.2.m2.1.1.2.3.cmml">i</mi><mo id="S4.I2.i1.p1.2.m2.1.1.3" xref="S4.I2.i1.p1.2.m2.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.2.m2.1b"><apply id="S4.I2.i1.p1.2.m2.1.1.cmml" xref="S4.I2.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.p1.2.m2.1.1.1.cmml" xref="S4.I2.i1.p1.2.m2.1.1">superscript</csymbol><apply id="S4.I2.i1.p1.2.m2.1.1.2.cmml" xref="S4.I2.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.p1.2.m2.1.1.2.1.cmml" xref="S4.I2.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I2.i1.p1.2.m2.1.1.2.2.cmml" xref="S4.I2.i1.p1.2.m2.1.1.2.2">𝑛</ci><ci id="S4.I2.i1.p1.2.m2.1.1.2.3.cmml" xref="S4.I2.i1.p1.2.m2.1.1.2.3">𝑖</ci></apply><times id="S4.I2.i1.p1.2.m2.1.1.3.cmml" xref="S4.I2.i1.p1.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.2.m2.1c">n_{i}^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.2.m2.1d">italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>:
<math alttext="\text{Mean}=\frac{1}{N}\sum_{i=1}^{N}\cos^{-1}(n_{i}\cdot n_{i}^{*})" class="ltx_Math" display="inline" id="S4.I2.i1.p1.3.m3.2"><semantics id="S4.I2.i1.p1.3.m3.2a"><mrow id="S4.I2.i1.p1.3.m3.2.2" xref="S4.I2.i1.p1.3.m3.2.2.cmml"><mtext id="S4.I2.i1.p1.3.m3.2.2.4" xref="S4.I2.i1.p1.3.m3.2.2.4a.cmml">Mean</mtext><mo id="S4.I2.i1.p1.3.m3.2.2.3" xref="S4.I2.i1.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S4.I2.i1.p1.3.m3.2.2.2" xref="S4.I2.i1.p1.3.m3.2.2.2.cmml"><mfrac id="S4.I2.i1.p1.3.m3.2.2.2.4" xref="S4.I2.i1.p1.3.m3.2.2.2.4.cmml"><mn id="S4.I2.i1.p1.3.m3.2.2.2.4.2" xref="S4.I2.i1.p1.3.m3.2.2.2.4.2.cmml">1</mn><mi id="S4.I2.i1.p1.3.m3.2.2.2.4.3" xref="S4.I2.i1.p1.3.m3.2.2.2.4.3.cmml">N</mi></mfrac><mo id="S4.I2.i1.p1.3.m3.2.2.2.3" xref="S4.I2.i1.p1.3.m3.2.2.2.3.cmml">⁢</mo><mrow id="S4.I2.i1.p1.3.m3.2.2.2.2" xref="S4.I2.i1.p1.3.m3.2.2.2.2.cmml"><msubsup id="S4.I2.i1.p1.3.m3.2.2.2.2.3" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.cmml"><mo id="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.2" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.cmml"><mi id="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.2" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.2.cmml">i</mi><mo id="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.1" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.3" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.I2.i1.p1.3.m3.2.2.2.2.3.3" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.3.cmml">N</mi></msubsup><mrow id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.3.cmml"><msup id="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1" xref="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.2" xref="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.2.cmml">cos</mi><mrow id="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.3" xref="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.3.cmml"><mo id="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.3a" xref="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.3.cmml">−</mo><mn id="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.3.2" xref="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.3.2.cmml">1</mn></mrow></msup><mo id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2a" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.3.cmml">⁡</mo><mrow id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.3.cmml"><mo id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.2" stretchy="false" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.3.cmml">(</mo><mrow id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.cmml"><msub id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2.cmml"><mi id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2.2" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2.2.cmml">n</mi><mi id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2.3" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2.3.cmml">i</mi></msub><mo id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.1" lspace="0.222em" rspace="0.222em" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.1.cmml">⋅</mo><msubsup id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.cmml"><mi id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.2.2" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.2.2.cmml">n</mi><mi id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.2.3" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.2.3.cmml">i</mi><mo id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.3" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.3.cmml">∗</mo></msubsup></mrow><mo id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.3" stretchy="false" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.3.m3.2b"><apply id="S4.I2.i1.p1.3.m3.2.2.cmml" xref="S4.I2.i1.p1.3.m3.2.2"><eq id="S4.I2.i1.p1.3.m3.2.2.3.cmml" xref="S4.I2.i1.p1.3.m3.2.2.3"></eq><ci id="S4.I2.i1.p1.3.m3.2.2.4a.cmml" xref="S4.I2.i1.p1.3.m3.2.2.4"><mtext id="S4.I2.i1.p1.3.m3.2.2.4.cmml" xref="S4.I2.i1.p1.3.m3.2.2.4">Mean</mtext></ci><apply id="S4.I2.i1.p1.3.m3.2.2.2.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2"><times id="S4.I2.i1.p1.3.m3.2.2.2.3.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.3"></times><apply id="S4.I2.i1.p1.3.m3.2.2.2.4.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.4"><divide id="S4.I2.i1.p1.3.m3.2.2.2.4.1.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.4"></divide><cn id="S4.I2.i1.p1.3.m3.2.2.2.4.2.cmml" type="integer" xref="S4.I2.i1.p1.3.m3.2.2.2.4.2">1</cn><ci id="S4.I2.i1.p1.3.m3.2.2.2.4.3.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.4.3">𝑁</ci></apply><apply id="S4.I2.i1.p1.3.m3.2.2.2.2.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2"><apply id="S4.I2.i1.p1.3.m3.2.2.2.2.3.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.I2.i1.p1.3.m3.2.2.2.2.3.1.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3">superscript</csymbol><apply id="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.1.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3">subscript</csymbol><sum id="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.2.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.2"></sum><apply id="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3"><eq id="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.1.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.1"></eq><ci id="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.2.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.2">𝑖</ci><cn id="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.3.cmml" type="integer" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.I2.i1.p1.3.m3.2.2.2.2.3.3.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.3.3">𝑁</ci></apply><apply id="S4.I2.i1.p1.3.m3.2.2.2.2.2.3.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2"><apply id="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1">superscript</csymbol><cos id="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.2"></cos><apply id="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.3"><minus id="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.3"></minus><cn id="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.I2.i1.p1.3.m3.1.1.1.1.1.1.1.3.2">1</cn></apply></apply><apply id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1"><ci id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.1.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.1">⋅</ci><apply id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2.1.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2">subscript</csymbol><ci id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2.2.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2.2">𝑛</ci><ci id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2.3.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.2.3">𝑖</ci></apply><apply id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.1.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3">superscript</csymbol><apply id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.2.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.2.1.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3">subscript</csymbol><ci id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.2.2.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.2.2">𝑛</ci><ci id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.2.3.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.2.3">𝑖</ci></apply><times id="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.3.cmml" xref="S4.I2.i1.p1.3.m3.2.2.2.2.2.2.2.1.3.3"></times></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.3.m3.2c">\text{Mean}=\frac{1}{N}\sum_{i=1}^{N}\cos^{-1}(n_{i}\cdot n_{i}^{*})</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.3.m3.2d">Mean = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT roman_cos start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT )</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">Median Angular Error:</span> The median of the angular errors:
<math alttext="\text{Median}=\text{Median}\left(\cos^{-1}(n_{i}\cdot n_{i}^{*})\right)" class="ltx_Math" display="inline" id="S4.I2.i2.p1.1.m1.1"><semantics id="S4.I2.i2.p1.1.m1.1a"><mrow id="S4.I2.i2.p1.1.m1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.cmml"><mtext id="S4.I2.i2.p1.1.m1.1.1.3" xref="S4.I2.i2.p1.1.m1.1.1.3a.cmml">Median</mtext><mo id="S4.I2.i2.p1.1.m1.1.1.2" xref="S4.I2.i2.p1.1.m1.1.1.2.cmml">=</mo><mrow id="S4.I2.i2.p1.1.m1.1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.1.cmml"><mtext id="S4.I2.i2.p1.1.m1.1.1.1.3" xref="S4.I2.i2.p1.1.m1.1.1.1.3a.cmml">Median</mtext><mo id="S4.I2.i2.p1.1.m1.1.1.1.2" xref="S4.I2.i2.p1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i2.p1.1.m1.1.1.1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.1.cmml"><mo id="S4.I2.i2.p1.1.m1.1.1.1.1.1.2" xref="S4.I2.i2.p1.1.m1.1.1.1.cmml">(</mo><mrow id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.3.cmml"><msup id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">cos</mi><mrow id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.3a" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mn id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn></mrow></msup><mo id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2a" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.3.cmml"><mo id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.2" stretchy="false" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.3.cmml">(</mo><mrow id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.cmml"><msub id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2.cmml"><mi id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2.2" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2.2.cmml">n</mi><mi id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2.3" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2.3.cmml">i</mi></msub><mo id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.1" lspace="0.222em" rspace="0.222em" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.1.cmml">⋅</mo><msubsup id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.cmml"><mi id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.2.2" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.2.2.cmml">n</mi><mi id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.2.3" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.2.3.cmml">i</mi><mo id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.3" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.3.cmml">∗</mo></msubsup></mrow><mo id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.I2.i2.p1.1.m1.1.1.1.1.1.3" xref="S4.I2.i2.p1.1.m1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.1.m1.1b"><apply id="S4.I2.i2.p1.1.m1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1"><eq id="S4.I2.i2.p1.1.m1.1.1.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.2"></eq><ci id="S4.I2.i2.p1.1.m1.1.1.3a.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3"><mtext id="S4.I2.i2.p1.1.m1.1.1.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3">Median</mtext></ci><apply id="S4.I2.i2.p1.1.m1.1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1"><times id="S4.I2.i2.p1.1.m1.1.1.1.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.2"></times><ci id="S4.I2.i2.p1.1.m1.1.1.1.3a.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.3"><mtext id="S4.I2.i2.p1.1.m1.1.1.1.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.3">Median</mtext></ci><apply id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2"><apply id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1">superscript</csymbol><cos id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.2"></cos><apply id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.3"><minus id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.3"></minus><cn id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.1.1.3.2">1</cn></apply></apply><apply id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1"><ci id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.1">⋅</ci><apply id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2"><csymbol cd="ambiguous" id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2">subscript</csymbol><ci id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2.2">𝑛</ci><ci id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.2.3">𝑖</ci></apply><apply id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3">superscript</csymbol><apply id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.2.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3">subscript</csymbol><ci id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.2.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.2.2">𝑛</ci><ci id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.2.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.2.3">𝑖</ci></apply><times id="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1.1.1.1.2.2.1.3.3"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.1.m1.1c">\text{Median}=\text{Median}\left(\cos^{-1}(n_{i}\cdot n_{i}^{*})\right)</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.1.m1.1d">Median = Median ( roman_cos start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) )</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i3.p1.1.1">Root Mean Squared Error (RMS Normal):</span> The root mean squared of the angular errors:
<math alttext="\text{RMS Normal}=\sqrt{\frac{1}{N}\sum_{i=1}^{N}\left(\cos^{-1}(n_{i}\cdot n_%
{i}^{*})\right)^{2}}" class="ltx_Math" display="inline" id="S4.I2.i3.p1.1.m1.1"><semantics id="S4.I2.i3.p1.1.m1.1a"><mrow id="S4.I2.i3.p1.1.m1.1.2" xref="S4.I2.i3.p1.1.m1.1.2.cmml"><mtext id="S4.I2.i3.p1.1.m1.1.2.2" xref="S4.I2.i3.p1.1.m1.1.2.2a.cmml">RMS Normal</mtext><mo id="S4.I2.i3.p1.1.m1.1.2.1" xref="S4.I2.i3.p1.1.m1.1.2.1.cmml">=</mo><msqrt id="S4.I2.i3.p1.1.m1.1.1" xref="S4.I2.i3.p1.1.m1.1.1.cmml"><mrow id="S4.I2.i3.p1.1.m1.1.1.1" xref="S4.I2.i3.p1.1.m1.1.1.1.cmml"><mfrac id="S4.I2.i3.p1.1.m1.1.1.1.3" xref="S4.I2.i3.p1.1.m1.1.1.1.3.cmml"><mn id="S4.I2.i3.p1.1.m1.1.1.1.3.2" xref="S4.I2.i3.p1.1.m1.1.1.1.3.2.cmml">1</mn><mi id="S4.I2.i3.p1.1.m1.1.1.1.3.3" xref="S4.I2.i3.p1.1.m1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S4.I2.i3.p1.1.m1.1.1.1.2" xref="S4.I2.i3.p1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i3.p1.1.m1.1.1.1.1" xref="S4.I2.i3.p1.1.m1.1.1.1.1.cmml"><msubsup id="S4.I2.i3.p1.1.m1.1.1.1.1.2" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.cmml"><mo id="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.2" rspace="0em" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.2" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.1" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.3" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.I2.i3.p1.1.m1.1.1.1.1.2.3" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.3.cmml">N</mi></msubsup><msup id="S4.I2.i3.p1.1.m1.1.1.1.1.1" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.cmml"><mrow id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.cmml"><mo id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.2" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><msup id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">cos</mi><mrow id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3a" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mn id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn></mrow></msup><mo id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2a" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.2" stretchy="false" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mrow id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml"><msub id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2.cmml"><mi id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2.2" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2.2.cmml">n</mi><mi id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2.3" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2.3.cmml">i</mi></msub><mo id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.1" lspace="0.222em" rspace="0.222em" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">⋅</mo><msubsup id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.cmml"><mi id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.2.2" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.2.2.cmml">n</mi><mi id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.2.3" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.2.3.cmml">i</mi><mo id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.3" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.3.cmml">∗</mo></msubsup></mrow><mo id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.3" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.I2.i3.p1.1.m1.1.1.1.1.1.3" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i3.p1.1.m1.1b"><apply id="S4.I2.i3.p1.1.m1.1.2.cmml" xref="S4.I2.i3.p1.1.m1.1.2"><eq id="S4.I2.i3.p1.1.m1.1.2.1.cmml" xref="S4.I2.i3.p1.1.m1.1.2.1"></eq><ci id="S4.I2.i3.p1.1.m1.1.2.2a.cmml" xref="S4.I2.i3.p1.1.m1.1.2.2"><mtext id="S4.I2.i3.p1.1.m1.1.2.2.cmml" xref="S4.I2.i3.p1.1.m1.1.2.2">RMS Normal</mtext></ci><apply id="S4.I2.i3.p1.1.m1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1"><root id="S4.I2.i3.p1.1.m1.1.1a.cmml" xref="S4.I2.i3.p1.1.m1.1.1"></root><apply id="S4.I2.i3.p1.1.m1.1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1"><times id="S4.I2.i3.p1.1.m1.1.1.1.2.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.2"></times><apply id="S4.I2.i3.p1.1.m1.1.1.1.3.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.3"><divide id="S4.I2.i3.p1.1.m1.1.1.1.3.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.3"></divide><cn id="S4.I2.i3.p1.1.m1.1.1.1.3.2.cmml" type="integer" xref="S4.I2.i3.p1.1.m1.1.1.1.3.2">1</cn><ci id="S4.I2.i3.p1.1.m1.1.1.1.3.3.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.3.3">𝑁</ci></apply><apply id="S4.I2.i3.p1.1.m1.1.1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1"><apply id="S4.I2.i3.p1.1.m1.1.1.1.1.2.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.1.1.1.1.2.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2">superscript</csymbol><apply id="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2">subscript</csymbol><sum id="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.2.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.2"></sum><apply id="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3"><eq id="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.1"></eq><ci id="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.I2.i3.p1.1.m1.1.1.1.1.2.3.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.I2.i3.p1.1.m1.1.1.1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2"><apply id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><cos id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.2"></cos><apply id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3"><minus id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3"></minus><cn id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.3.2">1</cn></apply></apply><apply id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1"><ci id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.1">⋅</ci><apply id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2">subscript</csymbol><ci id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2.2.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2.2">𝑛</ci><ci id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2.3.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.2.3">𝑖</ci></apply><apply id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3">superscript</csymbol><apply id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.2.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.2.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3">subscript</csymbol><ci id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.2.2.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.2.2">𝑛</ci><ci id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.2.3.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.2.3">𝑖</ci></apply><times id="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.3.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.1.1.1.2.2.1.3.3"></times></apply></apply></apply><cn id="S4.I2.i3.p1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I2.i3.p1.1.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i3.p1.1.m1.1c">\text{RMS Normal}=\sqrt{\frac{1}{N}\sum_{i=1}^{N}\left(\cos^{-1}(n_{i}\cdot n_%
{i}^{*})\right)^{2}}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i3.p1.1.m1.1d">RMS Normal = square-root start_ARG divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( roman_cos start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i4.p1">
<p class="ltx_p" id="S4.I2.i4.p1.3"><span class="ltx_text ltx_font_bold" id="S4.I2.i4.p1.3.1">Accuracy:</span> The percentage of predicted normals where the angular error is less than a threshold, typically set to <math alttext="11.25^{\circ}" class="ltx_Math" display="inline" id="S4.I2.i4.p1.1.m1.1"><semantics id="S4.I2.i4.p1.1.m1.1a"><msup id="S4.I2.i4.p1.1.m1.1.1" xref="S4.I2.i4.p1.1.m1.1.1.cmml"><mn id="S4.I2.i4.p1.1.m1.1.1.2" xref="S4.I2.i4.p1.1.m1.1.1.2.cmml">11.25</mn><mo id="S4.I2.i4.p1.1.m1.1.1.3" xref="S4.I2.i4.p1.1.m1.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.1.m1.1b"><apply id="S4.I2.i4.p1.1.m1.1.1.cmml" xref="S4.I2.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I2.i4.p1.1.m1.1.1.1.cmml" xref="S4.I2.i4.p1.1.m1.1.1">superscript</csymbol><cn id="S4.I2.i4.p1.1.m1.1.1.2.cmml" type="float" xref="S4.I2.i4.p1.1.m1.1.1.2">11.25</cn><compose id="S4.I2.i4.p1.1.m1.1.1.3.cmml" xref="S4.I2.i4.p1.1.m1.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.1.m1.1c">11.25^{\circ}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i4.p1.1.m1.1d">11.25 start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="22.5^{\circ}" class="ltx_Math" display="inline" id="S4.I2.i4.p1.2.m2.1"><semantics id="S4.I2.i4.p1.2.m2.1a"><msup id="S4.I2.i4.p1.2.m2.1.1" xref="S4.I2.i4.p1.2.m2.1.1.cmml"><mn id="S4.I2.i4.p1.2.m2.1.1.2" xref="S4.I2.i4.p1.2.m2.1.1.2.cmml">22.5</mn><mo id="S4.I2.i4.p1.2.m2.1.1.3" xref="S4.I2.i4.p1.2.m2.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.2.m2.1b"><apply id="S4.I2.i4.p1.2.m2.1.1.cmml" xref="S4.I2.i4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I2.i4.p1.2.m2.1.1.1.cmml" xref="S4.I2.i4.p1.2.m2.1.1">superscript</csymbol><cn id="S4.I2.i4.p1.2.m2.1.1.2.cmml" type="float" xref="S4.I2.i4.p1.2.m2.1.1.2">22.5</cn><compose id="S4.I2.i4.p1.2.m2.1.1.3.cmml" xref="S4.I2.i4.p1.2.m2.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.2.m2.1c">22.5^{\circ}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i4.p1.2.m2.1d">22.5 start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT</annotation></semantics></math>, or <math alttext="30^{\circ}" class="ltx_Math" display="inline" id="S4.I2.i4.p1.3.m3.1"><semantics id="S4.I2.i4.p1.3.m3.1a"><msup id="S4.I2.i4.p1.3.m3.1.1" xref="S4.I2.i4.p1.3.m3.1.1.cmml"><mn id="S4.I2.i4.p1.3.m3.1.1.2" xref="S4.I2.i4.p1.3.m3.1.1.2.cmml">30</mn><mo id="S4.I2.i4.p1.3.m3.1.1.3" xref="S4.I2.i4.p1.3.m3.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.3.m3.1b"><apply id="S4.I2.i4.p1.3.m3.1.1.cmml" xref="S4.I2.i4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I2.i4.p1.3.m3.1.1.1.cmml" xref="S4.I2.i4.p1.3.m3.1.1">superscript</csymbol><cn id="S4.I2.i4.p1.3.m3.1.1.2.cmml" type="integer" xref="S4.I2.i4.p1.3.m3.1.1.2">30</cn><compose id="S4.I2.i4.p1.3.m3.1.1.3.cmml" xref="S4.I2.i4.p1.3.m3.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.3.m3.1c">30^{\circ}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i4.p1.3.m3.1d">30 start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Quantitative Comparison</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">To fairly evaluate the performance of our proposed model, PoseidonNet, we performed a quantitative comparison against several state-of-the-art methods of similar size for both depth estimation and surface normals estimation, ensuring a fair comparison without including significantly larger models. All baseline model results were obtained from the published articles of the respective authors to ensure a fair and accurate comparison.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p2.1.1">Depth Estimation</span>:
We evaluated the depth estimation capabilities of PoseidonNet on three diverse underwater datasets: USOD 10K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib11" title="">11</a>]</cite>, Atlantis <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib28" title="">28</a>]</cite> , and Sea-thru <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib1" title="">1</a>]</cite>. These datasets were chosen to assess the model’s performance across various underwater scenarios and its ability to generalise to unseen data.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.3"><span class="ltx_text ltx_font_bold" id="S4.SS4.p3.3.1">USOD 10K:</span> As shown in table <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.T2" title="Table 2 ‣ 4.4 Quantitative Comparison ‣ 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">2</span></a>, PoseidonNet significantly outperformed all other methods. It achieved the highest accuracy scores across all three thresholds (<math alttext="\delta_{1}" class="ltx_Math" display="inline" id="S4.SS4.p3.1.m1.1"><semantics id="S4.SS4.p3.1.m1.1a"><msub id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml"><mi id="S4.SS4.p3.1.m1.1.1.2" xref="S4.SS4.p3.1.m1.1.1.2.cmml">δ</mi><mn id="S4.SS4.p3.1.m1.1.1.3" xref="S4.SS4.p3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><apply id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p3.1.m1.1.1.2.cmml" xref="S4.SS4.p3.1.m1.1.1.2">𝛿</ci><cn id="S4.SS4.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS4.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">\delta_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.1.m1.1d">italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\delta_{2}" class="ltx_Math" display="inline" id="S4.SS4.p3.2.m2.1"><semantics id="S4.SS4.p3.2.m2.1a"><msub id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml"><mi id="S4.SS4.p3.2.m2.1.1.2" xref="S4.SS4.p3.2.m2.1.1.2.cmml">δ</mi><mn id="S4.SS4.p3.2.m2.1.1.3" xref="S4.SS4.p3.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><apply id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.2.m2.1.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p3.2.m2.1.1.2.cmml" xref="S4.SS4.p3.2.m2.1.1.2">𝛿</ci><cn id="S4.SS4.p3.2.m2.1.1.3.cmml" type="integer" xref="S4.SS4.p3.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">\delta_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.2.m2.1d">italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\delta_{3}" class="ltx_Math" display="inline" id="S4.SS4.p3.3.m3.1"><semantics id="S4.SS4.p3.3.m3.1a"><msub id="S4.SS4.p3.3.m3.1.1" xref="S4.SS4.p3.3.m3.1.1.cmml"><mi id="S4.SS4.p3.3.m3.1.1.2" xref="S4.SS4.p3.3.m3.1.1.2.cmml">δ</mi><mn id="S4.SS4.p3.3.m3.1.1.3" xref="S4.SS4.p3.3.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.3.m3.1b"><apply id="S4.SS4.p3.3.m3.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.3.m3.1.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p3.3.m3.1.1.2.cmml" xref="S4.SS4.p3.3.m3.1.1.2">𝛿</ci><cn id="S4.SS4.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.SS4.p3.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.3.m3.1c">\delta_{3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.3.m3.1d">italic_δ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>) while simultaneously achieving the lowest error rates (Abs Rel, Sq Rel, RMSE, and log10).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p4.1.1">Atlantis:</span> Similar to its performance on USOD 10K, PoseidonNet demonstrated superior performance on the Atlantis dataset, table <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.T3" title="Table 3 ‣ 4.4 Quantitative Comparison ‣ 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">3</span></a>, surpassing other methods in both accuracy and error metrics.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p5">
<p class="ltx_p" id="S4.SS4.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p5.1.1">Sea-thru:</span> On the Sea-thru (D3) dataset, PoseidonNet again achieved the best results across all evaluation metrics, further validating its effectiveness in accurate depth estimation for diverse underwater scenes. Table Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.T4" title="Table 4 ‣ 4.4 Quantitative Comparison ‣ 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">4</span></a> provides a detailed breakdown of the results, with PoseidonNet consistently achieving the lowest error rates.</p>
</div>
<div class="ltx_para" id="S4.SS4.p6">
<p class="ltx_p" id="S4.SS4.p6.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p6.1.1">Surface Normals Estimation:</span>
Evaluating surface normal estimation in underwater environments presents a unique challenge due to the lack of an established benchmark or dataset specifically designed for this task. To address this limitation, we trained and evaluated PoseidonNet on the iBims-1 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib14" title="">14</a>]</cite>. Although iBims-1 was not created for underwater images, it serves as a robust benchmark for assessing surface normal estimation techniques.
As presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.T5" title="Table 5 ‣ 4.4 Quantitative Comparison ‣ 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">5</span></a>, PoseidonNet achieved competitive results on the iBims-1 benchmark. It performed strongly across key metrics like mean and median errors, as well as accuracy thresholds at various angles.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Quantitative comparison results for depth estimation of our proposed method and compared methods on USOD 10K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib11" title="">11</a>]</cite> dataset. For <math alttext="\delta_{1}" class="ltx_Math" display="inline" id="S4.T2.6.m1.1"><semantics id="S4.T2.6.m1.1b"><msub id="S4.T2.6.m1.1.1" xref="S4.T2.6.m1.1.1.cmml"><mi id="S4.T2.6.m1.1.1.2" xref="S4.T2.6.m1.1.1.2.cmml">δ</mi><mn id="S4.T2.6.m1.1.1.3" xref="S4.T2.6.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.6.m1.1c"><apply id="S4.T2.6.m1.1.1.cmml" xref="S4.T2.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.6.m1.1.1.1.cmml" xref="S4.T2.6.m1.1.1">subscript</csymbol><ci id="S4.T2.6.m1.1.1.2.cmml" xref="S4.T2.6.m1.1.1.2">𝛿</ci><cn id="S4.T2.6.m1.1.1.3.cmml" type="integer" xref="S4.T2.6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.m1.1d">\delta_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.m1.1e">italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\delta_{2}" class="ltx_Math" display="inline" id="S4.T2.7.m2.1"><semantics id="S4.T2.7.m2.1b"><msub id="S4.T2.7.m2.1.1" xref="S4.T2.7.m2.1.1.cmml"><mi id="S4.T2.7.m2.1.1.2" xref="S4.T2.7.m2.1.1.2.cmml">δ</mi><mn id="S4.T2.7.m2.1.1.3" xref="S4.T2.7.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.7.m2.1c"><apply id="S4.T2.7.m2.1.1.cmml" xref="S4.T2.7.m2.1.1"><csymbol cd="ambiguous" id="S4.T2.7.m2.1.1.1.cmml" xref="S4.T2.7.m2.1.1">subscript</csymbol><ci id="S4.T2.7.m2.1.1.2.cmml" xref="S4.T2.7.m2.1.1.2">𝛿</ci><cn id="S4.T2.7.m2.1.1.3.cmml" type="integer" xref="S4.T2.7.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.m2.1d">\delta_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.m2.1e">italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\delta_{3}" class="ltx_Math" display="inline" id="S4.T2.8.m3.1"><semantics id="S4.T2.8.m3.1b"><msub id="S4.T2.8.m3.1.1" xref="S4.T2.8.m3.1.1.cmml"><mi id="S4.T2.8.m3.1.1.2" xref="S4.T2.8.m3.1.1.2.cmml">δ</mi><mn id="S4.T2.8.m3.1.1.3" xref="S4.T2.8.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.8.m3.1c"><apply id="S4.T2.8.m3.1.1.cmml" xref="S4.T2.8.m3.1.1"><csymbol cd="ambiguous" id="S4.T2.8.m3.1.1.1.cmml" xref="S4.T2.8.m3.1.1">subscript</csymbol><ci id="S4.T2.8.m3.1.1.2.cmml" xref="S4.T2.8.m3.1.1.2">𝛿</ci><cn id="S4.T2.8.m3.1.1.3.cmml" type="integer" xref="S4.T2.8.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.m3.1d">\delta_{3}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.m3.1e">italic_δ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>, (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.9.m4.1"><semantics id="S4.T2.9.m4.1b"><mo id="S4.T2.9.m4.1.1" stretchy="false" xref="S4.T2.9.m4.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.9.m4.1c"><ci id="S4.T2.9.m4.1.1.cmml" xref="S4.T2.9.m4.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.m4.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.9.m4.1e">↑</annotation></semantics></math>) means higher is better. For other metrics, (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.10.m5.1"><semantics id="S4.T2.10.m5.1b"><mo id="S4.T2.10.m5.1.1" stretchy="false" xref="S4.T2.10.m5.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.10.m5.1c"><ci id="S4.T2.10.m5.1.1.cmml" xref="S4.T2.10.m5.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.m5.1d">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.10.m5.1e">↓</annotation></semantics></math>) means that lower is better. </figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T2.20">
<tr class="ltx_tr" id="S4.T2.20.10">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.20.10.11"><span class="ltx_text ltx_font_bold" id="S4.T2.20.10.11.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.2.2">
<math alttext="\delta_{1}" class="ltx_Math" display="inline" id="S4.T2.11.1.1.m1.1"><semantics id="S4.T2.11.1.1.m1.1a"><msub id="S4.T2.11.1.1.m1.1.1" xref="S4.T2.11.1.1.m1.1.1.cmml"><mi id="S4.T2.11.1.1.m1.1.1.2" xref="S4.T2.11.1.1.m1.1.1.2.cmml">δ</mi><mn id="S4.T2.11.1.1.m1.1.1.3" xref="S4.T2.11.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.11.1.1.m1.1b"><apply id="S4.T2.11.1.1.m1.1.1.cmml" xref="S4.T2.11.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.11.1.1.m1.1.1.1.cmml" xref="S4.T2.11.1.1.m1.1.1">subscript</csymbol><ci id="S4.T2.11.1.1.m1.1.1.2.cmml" xref="S4.T2.11.1.1.m1.1.1.2">𝛿</ci><cn id="S4.T2.11.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T2.11.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.1.1.m1.1c">\delta_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.11.1.1.m1.1d">italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.12.2.2.m2.1"><semantics id="S4.T2.12.2.2.m2.1a"><mo id="S4.T2.12.2.2.m2.1.1" stretchy="false" xref="S4.T2.12.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.12.2.2.m2.1b"><ci id="S4.T2.12.2.2.m2.1.1.cmml" xref="S4.T2.12.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.2.2.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.12.2.2.m2.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.14.4.4">
<math alttext="\delta_{2}" class="ltx_Math" display="inline" id="S4.T2.13.3.3.m1.1"><semantics id="S4.T2.13.3.3.m1.1a"><msub id="S4.T2.13.3.3.m1.1.1" xref="S4.T2.13.3.3.m1.1.1.cmml"><mi id="S4.T2.13.3.3.m1.1.1.2" xref="S4.T2.13.3.3.m1.1.1.2.cmml">δ</mi><mn id="S4.T2.13.3.3.m1.1.1.3" xref="S4.T2.13.3.3.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.13.3.3.m1.1b"><apply id="S4.T2.13.3.3.m1.1.1.cmml" xref="S4.T2.13.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.13.3.3.m1.1.1.1.cmml" xref="S4.T2.13.3.3.m1.1.1">subscript</csymbol><ci id="S4.T2.13.3.3.m1.1.1.2.cmml" xref="S4.T2.13.3.3.m1.1.1.2">𝛿</ci><cn id="S4.T2.13.3.3.m1.1.1.3.cmml" type="integer" xref="S4.T2.13.3.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.3.3.m1.1c">\delta_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.13.3.3.m1.1d">italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.14.4.4.m2.1"><semantics id="S4.T2.14.4.4.m2.1a"><mo id="S4.T2.14.4.4.m2.1.1" stretchy="false" xref="S4.T2.14.4.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.14.4.4.m2.1b"><ci id="S4.T2.14.4.4.m2.1.1.cmml" xref="S4.T2.14.4.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.4.4.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.14.4.4.m2.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.16.6.6">
<math alttext="\delta_{3}" class="ltx_Math" display="inline" id="S4.T2.15.5.5.m1.1"><semantics id="S4.T2.15.5.5.m1.1a"><msub id="S4.T2.15.5.5.m1.1.1" xref="S4.T2.15.5.5.m1.1.1.cmml"><mi id="S4.T2.15.5.5.m1.1.1.2" xref="S4.T2.15.5.5.m1.1.1.2.cmml">δ</mi><mn id="S4.T2.15.5.5.m1.1.1.3" xref="S4.T2.15.5.5.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T2.15.5.5.m1.1b"><apply id="S4.T2.15.5.5.m1.1.1.cmml" xref="S4.T2.15.5.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.15.5.5.m1.1.1.1.cmml" xref="S4.T2.15.5.5.m1.1.1">subscript</csymbol><ci id="S4.T2.15.5.5.m1.1.1.2.cmml" xref="S4.T2.15.5.5.m1.1.1.2">𝛿</ci><cn id="S4.T2.15.5.5.m1.1.1.3.cmml" type="integer" xref="S4.T2.15.5.5.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.5.5.m1.1c">\delta_{3}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.15.5.5.m1.1d">italic_δ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.16.6.6.m2.1"><semantics id="S4.T2.16.6.6.m2.1a"><mo id="S4.T2.16.6.6.m2.1.1" stretchy="false" xref="S4.T2.16.6.6.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.16.6.6.m2.1b"><ci id="S4.T2.16.6.6.m2.1.1.cmml" xref="S4.T2.16.6.6.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.6.6.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.16.6.6.m2.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.17.7.7">
<span class="ltx_text ltx_font_bold" id="S4.T2.17.7.7.1">Abs Rel</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.17.7.7.m1.1"><semantics id="S4.T2.17.7.7.m1.1a"><mo id="S4.T2.17.7.7.m1.1.1" stretchy="false" xref="S4.T2.17.7.7.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.17.7.7.m1.1b"><ci id="S4.T2.17.7.7.m1.1.1.cmml" xref="S4.T2.17.7.7.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.7.7.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.17.7.7.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.18.8.8">
<span class="ltx_text ltx_font_bold" id="S4.T2.18.8.8.1">Sq Rel</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.18.8.8.m1.1"><semantics id="S4.T2.18.8.8.m1.1a"><mo id="S4.T2.18.8.8.m1.1.1" stretchy="false" xref="S4.T2.18.8.8.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.18.8.8.m1.1b"><ci id="S4.T2.18.8.8.m1.1.1.cmml" xref="S4.T2.18.8.8.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.8.8.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.18.8.8.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.19.9.9">
<span class="ltx_text ltx_font_bold" id="S4.T2.19.9.9.1">RMSE</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.19.9.9.m1.1"><semantics id="S4.T2.19.9.9.m1.1a"><mo id="S4.T2.19.9.9.m1.1.1" stretchy="false" xref="S4.T2.19.9.9.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.19.9.9.m1.1b"><ci id="S4.T2.19.9.9.m1.1.1.cmml" xref="S4.T2.19.9.9.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.19.9.9.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.19.9.9.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.20.10.10">
<span class="ltx_text ltx_font_bold" id="S4.T2.20.10.10.1">log10</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.20.10.10.m1.1"><semantics id="S4.T2.20.10.10.m1.1a"><mo id="S4.T2.20.10.10.m1.1.1" stretchy="false" xref="S4.T2.20.10.10.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.20.10.10.m1.1b"><ci id="S4.T2.20.10.10.m1.1.1.cmml" xref="S4.T2.20.10.10.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.20.10.10.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.20.10.10.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.20.11">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.20.11.1">GDCP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib16" title="">16</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.20.11.2">0.2100</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.20.11.3">0.3878</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.20.11.4">0.5376</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.20.11.5">1.6465</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.20.11.6">0.6501</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.20.11.7">0.2963</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.20.11.8">0.3444</td>
</tr>
<tr class="ltx_tr" id="S4.T2.20.12">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.20.12.1">UW-Net <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib10" title="">10</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.12.2">0.2276</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.12.3">0.3846</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.12.4">0.5101</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.12.5">2.5464</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.12.6">1.4091</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.12.7">0.3894</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.12.8">0.3753</td>
</tr>
<tr class="ltx_tr" id="S4.T2.20.13">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.20.13.1">BTS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib15" title="">15</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.13.2">0.4242</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.13.3">0.6709</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.13.4">0.8010</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.13.5">0.6634</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.13.6">0.1154</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.13.7">0.1476</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.13.8">0.1876</td>
</tr>
<tr class="ltx_tr" id="S4.T2.20.14">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.20.14.1">LapDepth <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib19" title="">19</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.14.2">0.4664</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.14.3">0.6993</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.14.4">0.8238</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.14.5">0.5885</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.14.6">0.1005</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.14.7">0.1327</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.14.8">0.1709</td>
</tr>
<tr class="ltx_tr" id="S4.T2.20.15">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.20.15.1">LiteMono <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib29" title="">29</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.15.2">0.4629</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.15.3">0.6897</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.15.4">0.8111</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.15.5">0.5406</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.15.6">0.0940</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.15.7">0.1344</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.15.8">0.1811</td>
</tr>
<tr class="ltx_tr" id="S4.T2.20.16">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.20.16.1">TransDepth <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib22" title="">22</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.16.2">0.4636</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.16.3">0.7085</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.16.4">0.8267</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.16.5">0.5405</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.16.6">0.0910</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.16.7">0.1324</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.16.8">0.1780</td>
</tr>
<tr class="ltx_tr" id="S4.T2.20.17">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.20.17.1">UDepth <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib26" title="">26</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.17.2">0.4508</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.17.3">0.6723</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.17.4">0.7935</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.17.5">0.6810</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.17.6">0.1230</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.17.7">0.1430</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.17.8">0.1880</td>
</tr>
<tr class="ltx_tr" id="S4.T2.20.18">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.20.18.1">UMono <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib21" title="">21</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.18.2">0.5237</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.18.3">0.7471</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.18.4">0.8519</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.18.5">0.4956</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.18.6">0.0778</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.18.7">0.1182</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.18.8">0.1526</td>
</tr>
<tr class="ltx_tr" id="S4.T2.20.19">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S4.T2.20.19.1">PoseidonNet (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.20.19.2"><span class="ltx_text ltx_font_bold" id="S4.T2.20.19.2.1">0.7546</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.20.19.3"><span class="ltx_text ltx_font_bold" id="S4.T2.20.19.3.1">0.8065</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.20.19.4"><span class="ltx_text ltx_font_bold" id="S4.T2.20.19.4.1">0.9224</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.20.19.5"><span class="ltx_text ltx_font_bold" id="S4.T2.20.19.5.1">0.3511</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.20.19.6"><span class="ltx_text ltx_font_bold" id="S4.T2.20.19.6.1">0.0457</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.20.19.7"><span class="ltx_text ltx_font_bold" id="S4.T2.20.19.7.1">0.0952</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.20.19.8"><span class="ltx_text ltx_font_bold" id="S4.T2.20.19.8.1">0.0943</span></td>
</tr>
</table>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Quantitative comparison results for depth estimation of our proposed method and compared methods on Atlantis <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib28" title="">28</a>]</cite> dataset. For <math alttext="\delta_{1}" class="ltx_Math" display="inline" id="S4.T3.6.m1.1"><semantics id="S4.T3.6.m1.1b"><msub id="S4.T3.6.m1.1.1" xref="S4.T3.6.m1.1.1.cmml"><mi id="S4.T3.6.m1.1.1.2" xref="S4.T3.6.m1.1.1.2.cmml">δ</mi><mn id="S4.T3.6.m1.1.1.3" xref="S4.T3.6.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T3.6.m1.1c"><apply id="S4.T3.6.m1.1.1.cmml" xref="S4.T3.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.6.m1.1.1.1.cmml" xref="S4.T3.6.m1.1.1">subscript</csymbol><ci id="S4.T3.6.m1.1.1.2.cmml" xref="S4.T3.6.m1.1.1.2">𝛿</ci><cn id="S4.T3.6.m1.1.1.3.cmml" type="integer" xref="S4.T3.6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.m1.1d">\delta_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.m1.1e">italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\delta_{2}" class="ltx_Math" display="inline" id="S4.T3.7.m2.1"><semantics id="S4.T3.7.m2.1b"><msub id="S4.T3.7.m2.1.1" xref="S4.T3.7.m2.1.1.cmml"><mi id="S4.T3.7.m2.1.1.2" xref="S4.T3.7.m2.1.1.2.cmml">δ</mi><mn id="S4.T3.7.m2.1.1.3" xref="S4.T3.7.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T3.7.m2.1c"><apply id="S4.T3.7.m2.1.1.cmml" xref="S4.T3.7.m2.1.1"><csymbol cd="ambiguous" id="S4.T3.7.m2.1.1.1.cmml" xref="S4.T3.7.m2.1.1">subscript</csymbol><ci id="S4.T3.7.m2.1.1.2.cmml" xref="S4.T3.7.m2.1.1.2">𝛿</ci><cn id="S4.T3.7.m2.1.1.3.cmml" type="integer" xref="S4.T3.7.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.m2.1d">\delta_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.m2.1e">italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\delta_{3}" class="ltx_Math" display="inline" id="S4.T3.8.m3.1"><semantics id="S4.T3.8.m3.1b"><msub id="S4.T3.8.m3.1.1" xref="S4.T3.8.m3.1.1.cmml"><mi id="S4.T3.8.m3.1.1.2" xref="S4.T3.8.m3.1.1.2.cmml">δ</mi><mn id="S4.T3.8.m3.1.1.3" xref="S4.T3.8.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T3.8.m3.1c"><apply id="S4.T3.8.m3.1.1.cmml" xref="S4.T3.8.m3.1.1"><csymbol cd="ambiguous" id="S4.T3.8.m3.1.1.1.cmml" xref="S4.T3.8.m3.1.1">subscript</csymbol><ci id="S4.T3.8.m3.1.1.2.cmml" xref="S4.T3.8.m3.1.1.2">𝛿</ci><cn id="S4.T3.8.m3.1.1.3.cmml" type="integer" xref="S4.T3.8.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.m3.1d">\delta_{3}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.m3.1e">italic_δ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>, (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.9.m4.1"><semantics id="S4.T3.9.m4.1b"><mo id="S4.T3.9.m4.1.1" stretchy="false" xref="S4.T3.9.m4.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.9.m4.1c"><ci id="S4.T3.9.m4.1.1.cmml" xref="S4.T3.9.m4.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.m4.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.9.m4.1e">↑</annotation></semantics></math>) means higher is better. For other metrics, (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.10.m5.1"><semantics id="S4.T3.10.m5.1b"><mo id="S4.T3.10.m5.1.1" stretchy="false" xref="S4.T3.10.m5.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.10.m5.1c"><ci id="S4.T3.10.m5.1.1.cmml" xref="S4.T3.10.m5.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.m5.1d">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.10.m5.1e">↓</annotation></semantics></math>) means that lower is better. </figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T3.20">
<tr class="ltx_tr" id="S4.T3.20.10">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.20.10.11"><span class="ltx_text ltx_font_bold" id="S4.T3.20.10.11.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.12.2.2">
<math alttext="\delta_{1}" class="ltx_Math" display="inline" id="S4.T3.11.1.1.m1.1"><semantics id="S4.T3.11.1.1.m1.1a"><msub id="S4.T3.11.1.1.m1.1.1" xref="S4.T3.11.1.1.m1.1.1.cmml"><mi id="S4.T3.11.1.1.m1.1.1.2" xref="S4.T3.11.1.1.m1.1.1.2.cmml">δ</mi><mn id="S4.T3.11.1.1.m1.1.1.3" xref="S4.T3.11.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T3.11.1.1.m1.1b"><apply id="S4.T3.11.1.1.m1.1.1.cmml" xref="S4.T3.11.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.11.1.1.m1.1.1.1.cmml" xref="S4.T3.11.1.1.m1.1.1">subscript</csymbol><ci id="S4.T3.11.1.1.m1.1.1.2.cmml" xref="S4.T3.11.1.1.m1.1.1.2">𝛿</ci><cn id="S4.T3.11.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T3.11.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.1.1.m1.1c">\delta_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.11.1.1.m1.1d">italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.12.2.2.m2.1"><semantics id="S4.T3.12.2.2.m2.1a"><mo id="S4.T3.12.2.2.m2.1.1" stretchy="false" xref="S4.T3.12.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.12.2.2.m2.1b"><ci id="S4.T3.12.2.2.m2.1.1.cmml" xref="S4.T3.12.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.2.2.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.12.2.2.m2.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.14.4.4">
<math alttext="\delta_{2}" class="ltx_Math" display="inline" id="S4.T3.13.3.3.m1.1"><semantics id="S4.T3.13.3.3.m1.1a"><msub id="S4.T3.13.3.3.m1.1.1" xref="S4.T3.13.3.3.m1.1.1.cmml"><mi id="S4.T3.13.3.3.m1.1.1.2" xref="S4.T3.13.3.3.m1.1.1.2.cmml">δ</mi><mn id="S4.T3.13.3.3.m1.1.1.3" xref="S4.T3.13.3.3.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T3.13.3.3.m1.1b"><apply id="S4.T3.13.3.3.m1.1.1.cmml" xref="S4.T3.13.3.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.13.3.3.m1.1.1.1.cmml" xref="S4.T3.13.3.3.m1.1.1">subscript</csymbol><ci id="S4.T3.13.3.3.m1.1.1.2.cmml" xref="S4.T3.13.3.3.m1.1.1.2">𝛿</ci><cn id="S4.T3.13.3.3.m1.1.1.3.cmml" type="integer" xref="S4.T3.13.3.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.13.3.3.m1.1c">\delta_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.13.3.3.m1.1d">italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.14.4.4.m2.1"><semantics id="S4.T3.14.4.4.m2.1a"><mo id="S4.T3.14.4.4.m2.1.1" stretchy="false" xref="S4.T3.14.4.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.14.4.4.m2.1b"><ci id="S4.T3.14.4.4.m2.1.1.cmml" xref="S4.T3.14.4.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.14.4.4.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.14.4.4.m2.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.16.6.6">
<math alttext="\delta_{3}" class="ltx_Math" display="inline" id="S4.T3.15.5.5.m1.1"><semantics id="S4.T3.15.5.5.m1.1a"><msub id="S4.T3.15.5.5.m1.1.1" xref="S4.T3.15.5.5.m1.1.1.cmml"><mi id="S4.T3.15.5.5.m1.1.1.2" xref="S4.T3.15.5.5.m1.1.1.2.cmml">δ</mi><mn id="S4.T3.15.5.5.m1.1.1.3" xref="S4.T3.15.5.5.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T3.15.5.5.m1.1b"><apply id="S4.T3.15.5.5.m1.1.1.cmml" xref="S4.T3.15.5.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.15.5.5.m1.1.1.1.cmml" xref="S4.T3.15.5.5.m1.1.1">subscript</csymbol><ci id="S4.T3.15.5.5.m1.1.1.2.cmml" xref="S4.T3.15.5.5.m1.1.1.2">𝛿</ci><cn id="S4.T3.15.5.5.m1.1.1.3.cmml" type="integer" xref="S4.T3.15.5.5.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.15.5.5.m1.1c">\delta_{3}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.15.5.5.m1.1d">italic_δ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.16.6.6.m2.1"><semantics id="S4.T3.16.6.6.m2.1a"><mo id="S4.T3.16.6.6.m2.1.1" stretchy="false" xref="S4.T3.16.6.6.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.16.6.6.m2.1b"><ci id="S4.T3.16.6.6.m2.1.1.cmml" xref="S4.T3.16.6.6.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.16.6.6.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.16.6.6.m2.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.17.7.7">
<span class="ltx_text ltx_font_bold" id="S4.T3.17.7.7.1">Abs Rel</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.17.7.7.m1.1"><semantics id="S4.T3.17.7.7.m1.1a"><mo id="S4.T3.17.7.7.m1.1.1" stretchy="false" xref="S4.T3.17.7.7.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.17.7.7.m1.1b"><ci id="S4.T3.17.7.7.m1.1.1.cmml" xref="S4.T3.17.7.7.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.17.7.7.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.17.7.7.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.18.8.8">
<span class="ltx_text ltx_font_bold" id="S4.T3.18.8.8.1">Sq Rel</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.18.8.8.m1.1"><semantics id="S4.T3.18.8.8.m1.1a"><mo id="S4.T3.18.8.8.m1.1.1" stretchy="false" xref="S4.T3.18.8.8.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.18.8.8.m1.1b"><ci id="S4.T3.18.8.8.m1.1.1.cmml" xref="S4.T3.18.8.8.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.18.8.8.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.18.8.8.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.19.9.9">
<span class="ltx_text ltx_font_bold" id="S4.T3.19.9.9.1">RMSE</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.19.9.9.m1.1"><semantics id="S4.T3.19.9.9.m1.1a"><mo id="S4.T3.19.9.9.m1.1.1" stretchy="false" xref="S4.T3.19.9.9.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.19.9.9.m1.1b"><ci id="S4.T3.19.9.9.m1.1.1.cmml" xref="S4.T3.19.9.9.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.19.9.9.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.19.9.9.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.20.10.10">
<span class="ltx_text ltx_font_bold" id="S4.T3.20.10.10.1">log10</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.20.10.10.m1.1"><semantics id="S4.T3.20.10.10.m1.1a"><mo id="S4.T3.20.10.10.m1.1.1" stretchy="false" xref="S4.T3.20.10.10.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.20.10.10.m1.1b"><ci id="S4.T3.20.10.10.m1.1.1.cmml" xref="S4.T3.20.10.10.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.20.10.10.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.20.10.10.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.20.11">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.20.11.1">GDCP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib16" title="">16</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.20.11.2">0.1636</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.20.11.3">0.3349</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.20.11.4">0.4762</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.20.11.5">3.3197</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.20.11.6">2.7447</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.20.11.7">0.4540</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.20.11.8">0.4108</td>
</tr>
<tr class="ltx_tr" id="S4.T3.20.12">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.20.12.1">UW-Net <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib10" title="">10</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.12.2">0.1489</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.12.3">0.2887</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.12.4">0.4302</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.12.5">1.6701</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.12.6">0.9291</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.12.7">0.4504</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.12.8">0.3610</td>
</tr>
<tr class="ltx_tr" id="S4.T3.20.13">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.20.13.1">BTS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib15" title="">15</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.13.2">0.3753</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.13.3">0.6017</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.13.4">0.7366</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.13.5">1.1198</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.13.6">0.2188</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.13.7">0.1550</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.13.8">0.2260</td>
</tr>
<tr class="ltx_tr" id="S4.T3.20.14">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.20.14.1">LapDepth <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib19" title="">19</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.14.2">0.4062</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.14.3">0.6221</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.14.4">0.7501</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.14.5">1.0856</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.14.6">0.2041</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.14.7">0.1443</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.14.8">0.2144</td>
</tr>
<tr class="ltx_tr" id="S4.T3.20.15">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.20.15.1">LiteMono <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib29" title="">29</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.15.2">0.4047</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.15.3">0.6298</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.15.4">0.7545</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.15.5">0.8493</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.15.6">0.1573</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.15.7">0.1456</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.15.8">0.2117</td>
</tr>
<tr class="ltx_tr" id="S4.T3.20.16">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.20.16.1">TransDepth <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib22" title="">22</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.16.2">0.4078</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.16.3">0.6254</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.16.4">0.7602</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.16.5">0.8851</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.16.6">0.1580</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.16.7">0.1443</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.16.8">0.2060</td>
</tr>
<tr class="ltx_tr" id="S4.T3.20.17">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.20.17.1">UDepth <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib26" title="">26</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.17.2">0.3616</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.17.3">0.5632</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.17.4">0.6975</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.17.5">1.2664</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.17.6">0.3231</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.17.7">0.1799</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.17.8">0.2451</td>
</tr>
<tr class="ltx_tr" id="S4.T3.20.18">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.20.18.1">UMono <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib21" title="">21</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.18.2">0.4096</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.18.3">0.6354</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.18.4">0.7694</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.18.5">0.8449</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.18.6">0.1450</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.18.7">0.1422</td>
<td class="ltx_td ltx_align_center" id="S4.T3.20.18.8">0.2017</td>
</tr>
<tr class="ltx_tr" id="S4.T3.20.19">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S4.T3.20.19.1">PoseidonNet (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.20.19.2"><span class="ltx_text ltx_font_bold" id="S4.T3.20.19.2.1">0.6324</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.20.19.3"><span class="ltx_text ltx_font_bold" id="S4.T3.20.19.3.1">0.8141</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.20.19.4"><span class="ltx_text ltx_font_bold" id="S4.T3.20.19.4.1">0.9182</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.20.19.5"><span class="ltx_text ltx_font_bold" id="S4.T3.20.19.5.1">0.6241</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.20.19.6"><span class="ltx_text ltx_font_bold" id="S4.T3.20.19.6.1">0.0932</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.20.19.7"><span class="ltx_text ltx_font_bold" id="S4.T3.20.19.7.1">0.0944</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.20.19.8"><span class="ltx_text ltx_font_bold" id="S4.T3.20.19.8.1">0.1054</span></td>
</tr>
</table>
</figure>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Quantitative performance comparison on Sea-thru (D3) dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib1" title="">1</a>]</cite>. Lower scores represent better performance for all metrics.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T4.1">
<tr class="ltx_tr" id="S4.T4.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T4.1.1.1" style="padding-left:4.3pt;padding-right:4.3pt;">Model</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.2" style="padding-left:4.3pt;padding-right:4.3pt;">Abs Rel</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.3" style="padding-left:4.3pt;padding-right:4.3pt;">Sq Rel</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.4" style="padding-left:4.3pt;padding-right:4.3pt;">RMSE</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.5" style="padding-left:4.3pt;padding-right:4.3pt;">log10</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T4.1.2.1" style="padding-left:4.3pt;padding-right:4.3pt;">AdaBins (RGB) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib5" title="">5</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.2" style="padding-left:4.3pt;padding-right:4.3pt;">1.314</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.3" style="padding-left:4.3pt;padding-right:4.3pt;">0.663</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.4" style="padding-left:4.3pt;padding-right:4.3pt;">0.441</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.5" style="padding-left:4.3pt;padding-right:4.3pt;">0.356</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.1.3.1" style="padding-left:4.3pt;padding-right:4.3pt;">AdaBins (RMI) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib5" title="">5</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.2" style="padding-left:4.3pt;padding-right:4.3pt;">1.258</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.3" style="padding-left:4.3pt;padding-right:4.3pt;">0.617</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.4" style="padding-left:4.3pt;padding-right:4.3pt;">0.426</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.3.5" style="padding-left:4.3pt;padding-right:4.3pt;">0.346</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.1.4.1" style="padding-left:4.3pt;padding-right:4.3pt;">DenseDepth (RGB) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib2" title="">2</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.2" style="padding-left:4.3pt;padding-right:4.3pt;">1.073</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.3" style="padding-left:4.3pt;padding-right:4.3pt;">0.448</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.4" style="padding-left:4.3pt;padding-right:4.3pt;">0.366</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.5" style="padding-left:4.3pt;padding-right:4.3pt;">0.312</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.1.5.1" style="padding-left:4.3pt;padding-right:4.3pt;">DenseDepth (RMI) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib2" title="">2</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.2" style="padding-left:4.3pt;padding-right:4.3pt;">1.092</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.3" style="padding-left:4.3pt;padding-right:4.3pt;">0.470</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.4" style="padding-left:4.3pt;padding-right:4.3pt;">0.370</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.5" style="padding-left:4.3pt;padding-right:4.3pt;">0.312</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.1.6.1" style="padding-left:4.3pt;padding-right:4.3pt;">UDepth (RGB) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib26" title="">26</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.2" style="padding-left:4.3pt;padding-right:4.3pt;">1.304</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.3" style="padding-left:4.3pt;padding-right:4.3pt;">0.653</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.4" style="padding-left:4.3pt;padding-right:4.3pt;">0.440</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.5" style="padding-left:4.3pt;padding-right:4.3pt;">0.355</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.1.7.1" style="padding-left:4.3pt;padding-right:4.3pt;">UDepth (RMI) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib26" title="">26</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.7.2" style="padding-left:4.3pt;padding-right:4.3pt;">1.153</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.7.3" style="padding-left:4.3pt;padding-right:4.3pt;">0.514</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.7.4" style="padding-left:4.3pt;padding-right:4.3pt;">0.388</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.7.5" style="padding-left:4.3pt;padding-right:4.3pt;">0.321</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.8">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T4.1.8.1" style="padding-left:4.3pt;padding-right:4.3pt;">PoseidonNet (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.8.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.2.1">1.014</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.8.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.3.1">0.414</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.8.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.4.1">0.317</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.8.5" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.1.8.5.1">0.294</span></td>
</tr>
</table>
</figure>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>ibims-1 datset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib14" title="">14</a>]</cite> Normal Benchmark comparison. Higher is better for 11.25°, 22.5°, and 30°(<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.3.m1.1"><semantics id="S4.T5.3.m1.1b"><mo id="S4.T5.3.m1.1.1" stretchy="false" xref="S4.T5.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.3.m1.1c"><ci id="S4.T5.3.m1.1.1.cmml" xref="S4.T5.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.m1.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.3.m1.1e">↑</annotation></semantics></math>), while lower is better for mean, median, and RMS normal error (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T5.4.m2.1"><semantics id="S4.T5.4.m2.1b"><mo id="S4.T5.4.m2.1.1" stretchy="false" xref="S4.T5.4.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.4.m2.1c"><ci id="S4.T5.4.m2.1.1.cmml" xref="S4.T5.4.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.m2.1d">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.4.m2.1e">↓</annotation></semantics></math>).</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T5.10">
<tr class="ltx_tr" id="S4.T5.10.6">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T5.10.6.7"><span class="ltx_text ltx_font_bold" id="S4.T5.10.6.7.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.5.1.1">
<span class="ltx_text ltx_font_bold" id="S4.T5.5.1.1.1">11.25°</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.5.1.1.m1.1"><semantics id="S4.T5.5.1.1.m1.1a"><mo id="S4.T5.5.1.1.m1.1.1" stretchy="false" xref="S4.T5.5.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.5.1.1.m1.1b"><ci id="S4.T5.5.1.1.m1.1.1.cmml" xref="S4.T5.5.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.5.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.6.2.2">
<span class="ltx_text ltx_font_bold" id="S4.T5.6.2.2.1">22.5°</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.6.2.2.m1.1"><semantics id="S4.T5.6.2.2.m1.1a"><mo id="S4.T5.6.2.2.m1.1.1" stretchy="false" xref="S4.T5.6.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.6.2.2.m1.1b"><ci id="S4.T5.6.2.2.m1.1.1.cmml" xref="S4.T5.6.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.6.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.6.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.7.3.3">
<span class="ltx_text ltx_font_bold" id="S4.T5.7.3.3.1">30°</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.7.3.3.m1.1"><semantics id="S4.T5.7.3.3.m1.1a"><mo id="S4.T5.7.3.3.m1.1.1" stretchy="false" xref="S4.T5.7.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.7.3.3.m1.1b"><ci id="S4.T5.7.3.3.m1.1.1.cmml" xref="S4.T5.7.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.7.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.7.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.8.4.4">
<span class="ltx_text ltx_font_bold" id="S4.T5.8.4.4.1">Mean</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T5.8.4.4.m1.1"><semantics id="S4.T5.8.4.4.m1.1a"><mo id="S4.T5.8.4.4.m1.1.1" stretchy="false" xref="S4.T5.8.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.8.4.4.m1.1b"><ci id="S4.T5.8.4.4.m1.1.1.cmml" xref="S4.T5.8.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.8.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.8.4.4.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.9.5.5">
<span class="ltx_text ltx_font_bold" id="S4.T5.9.5.5.1">Median</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T5.9.5.5.m1.1"><semantics id="S4.T5.9.5.5.m1.1a"><mo id="S4.T5.9.5.5.m1.1.1" stretchy="false" xref="S4.T5.9.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.9.5.5.m1.1b"><ci id="S4.T5.9.5.5.m1.1.1.cmml" xref="S4.T5.9.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.9.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.9.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.10.6.6">
<span class="ltx_text ltx_font_bold" id="S4.T5.10.6.6.1">RMS Normal</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T5.10.6.6.m1.1"><semantics id="S4.T5.10.6.6.m1.1a"><mo id="S4.T5.10.6.6.m1.1.1" stretchy="false" xref="S4.T5.10.6.6.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T5.10.6.6.m1.1b"><ci id="S4.T5.10.6.6.m1.1.1.cmml" xref="S4.T5.10.6.6.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.10.6.6.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.10.6.6.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.10.7">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T5.10.7.1">VNL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib24" title="">24</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.10.7.2">0.179</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.10.7.3">0.386</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.10.7.4">0.494</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.10.7.5">39.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.10.7.6">30.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.10.7.7">51.0</td>
</tr>
<tr class="ltx_tr" id="S4.T5.10.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.10.8.1">BTS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib15" title="">15</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.8.2">0.130</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.8.3">0.295</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.10.8.4">0.400</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.8.5">44.0</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.8.6">37.8</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.8.7">53.5</td>
</tr>
<tr class="ltx_tr" id="S4.T5.10.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.10.9.1">Adabins <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib5" title="">5</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.9.2">0.180</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.9.3">0.387</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.10.9.4">0.506</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.9.5">37.1</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.9.6">29.6</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.9.7">46.9</td>
</tr>
<tr class="ltx_tr" id="S4.T5.10.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.10.10.1">IronDepth <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib3" title="">3</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.10.2">0.431</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.10.3">0.639</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.10.10.4">0.716</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.10.5">25.3</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.10.6">14.2</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.10.7">37.4</td>
</tr>
<tr class="ltx_tr" id="S4.T5.10.11">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.10.11.1">Omnidata <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib8" title="">8</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.11.2">0.647</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.11.3">0.734</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.10.11.4">0.768</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.11.5">20.8</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.11.6">7.7</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.11.7">35.1</td>
</tr>
<tr class="ltx_tr" id="S4.T5.10.12">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.10.12.1">Metric3D v2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib25" title="">25</a>]</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.12.2"><span class="ltx_text ltx_font_bold" id="S4.T5.10.12.2.1">0.697</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.12.3"><span class="ltx_text ltx_font_bold" id="S4.T5.10.12.3.1">0.762</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.10.12.4"><span class="ltx_text ltx_font_bold" id="S4.T5.10.12.4.1">0.788</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.12.5"><span class="ltx_text ltx_font_bold" id="S4.T5.10.12.5.1">19.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.12.6"><span class="ltx_text ltx_font_bold" id="S4.T5.10.12.6.1">5.7</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.10.12.7"><span class="ltx_text ltx_font_bold" id="S4.T5.10.12.7.1">35.2</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.10.13">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S4.T5.10.13.1">PoseidonNet (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.10.13.2">0.634</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.10.13.3">0.738</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T5.10.13.4">0.775</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.10.13.5">20.4</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.10.13.6">6.7</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.10.13.7">36.9</td>
</tr>
</table>
</figure>
<figure class="ltx_table" id="S4.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Quantitative Comparison Results of Ablation Study on the Benefit of Conv and Transformer Block. The value in <span class="ltx_text ltx_font_bold" id="S4.T6.8.1">bold</span> means the best results.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T6.6">
<tr class="ltx_tr" id="S4.T6.6.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T6.6.6.7"><span class="ltx_text ltx_font_bold" id="S4.T6.6.6.7.1">Variant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.2.2.2">
<math alttext="\delta_{3}" class="ltx_Math" display="inline" id="S4.T6.1.1.1.m1.1"><semantics id="S4.T6.1.1.1.m1.1a"><msub id="S4.T6.1.1.1.m1.1.1" xref="S4.T6.1.1.1.m1.1.1.cmml"><mi id="S4.T6.1.1.1.m1.1.1.2" xref="S4.T6.1.1.1.m1.1.1.2.cmml">δ</mi><mn id="S4.T6.1.1.1.m1.1.1.3" xref="S4.T6.1.1.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T6.1.1.1.m1.1b"><apply id="S4.T6.1.1.1.m1.1.1.cmml" xref="S4.T6.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.1.1.1.m1.1.1.1.cmml" xref="S4.T6.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T6.1.1.1.m1.1.1.2.cmml" xref="S4.T6.1.1.1.m1.1.1.2">𝛿</ci><cn id="S4.T6.1.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T6.1.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.1.1.1.m1.1c">\delta_{3}</annotation><annotation encoding="application/x-llamapun" id="S4.T6.1.1.1.m1.1d">italic_δ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.2.2.2.m2.1"><semantics id="S4.T6.2.2.2.m2.1a"><mo id="S4.T6.2.2.2.m2.1.1" stretchy="false" xref="S4.T6.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.2.2.2.m2.1b"><ci id="S4.T6.2.2.2.m2.1.1.cmml" xref="S4.T6.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.2.2.2.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.2.2.2.m2.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.3.3.3">
<span class="ltx_text ltx_font_bold" id="S4.T6.3.3.3.1">Abs Rel</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T6.3.3.3.m1.1"><semantics id="S4.T6.3.3.3.m1.1a"><mo id="S4.T6.3.3.3.m1.1.1" stretchy="false" xref="S4.T6.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T6.3.3.3.m1.1b"><ci id="S4.T6.3.3.3.m1.1.1.cmml" xref="S4.T6.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.4.4.4">
<span class="ltx_text ltx_font_bold" id="S4.T6.4.4.4.1">Sq Rel</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T6.4.4.4.m1.1"><semantics id="S4.T6.4.4.4.m1.1a"><mo id="S4.T6.4.4.4.m1.1.1" stretchy="false" xref="S4.T6.4.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T6.4.4.4.m1.1b"><ci id="S4.T6.4.4.4.m1.1.1.cmml" xref="S4.T6.4.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.4.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.4.4.4.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.5.5.5">
<span class="ltx_text ltx_font_bold" id="S4.T6.5.5.5.1">RMSE</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T6.5.5.5.m1.1"><semantics id="S4.T6.5.5.5.m1.1a"><mo id="S4.T6.5.5.5.m1.1.1" stretchy="false" xref="S4.T6.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T6.5.5.5.m1.1b"><ci id="S4.T6.5.5.5.m1.1.1.cmml" xref="S4.T6.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.6.6.6">
<span class="ltx_text ltx_font_bold" id="S4.T6.6.6.6.1">log10</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T6.6.6.6.m1.1"><semantics id="S4.T6.6.6.6.m1.1a"><mo id="S4.T6.6.6.6.m1.1.1" stretchy="false" xref="S4.T6.6.6.6.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T6.6.6.6.m1.1b"><ci id="S4.T6.6.6.6.m1.1.1.cmml" xref="S4.T6.6.6.6.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.6.6.6.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.6.6.6.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.6.7">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T6.6.7.1">w/ Conv</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.6.7.2">0.9120</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.6.7.3">0.3602</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.6.7.4">0.0501</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.6.7.5">0.1034</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.6.7.6">0.1078</td>
</tr>
<tr class="ltx_tr" id="S4.T6.6.8">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S4.T6.6.8.1">w/ Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.6.8.2">0.9153</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.6.8.3">0.3553</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.6.8.4">0.0483</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.6.8.5">0.0981</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.6.8.6">0.0967</td>
</tr>
<tr class="ltx_tr" id="S4.T6.6.9">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S4.T6.6.9.1">w/o Feature Fusion</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.6.9.2">0.9207</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.6.9.3">0.3543</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.6.9.4">0.0461</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.6.9.5">0.0964</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.6.9.6">0.0950</td>
</tr>
<tr class="ltx_tr" id="S4.T6.6.10">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r" id="S4.T6.6.10.1">Full model</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T6.6.10.2"><span class="ltx_text ltx_font_bold" id="S4.T6.6.10.2.1">0.9224</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T6.6.10.3"><span class="ltx_text ltx_font_bold" id="S4.T6.6.10.3.1">0.3511</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T6.6.10.4"><span class="ltx_text ltx_font_bold" id="S4.T6.6.10.4.1">0.0457</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T6.6.10.5"><span class="ltx_text ltx_font_bold" id="S4.T6.6.10.5.1">0.0952</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T6.6.10.6"><span class="ltx_text ltx_font_bold" id="S4.T6.6.10.6.1">0.0943</span></td>
</tr>
</table>
</figure>
<figure class="ltx_table" id="S4.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Quantitative Comparison Results of Ablation Study on the Benefit of dilated convolutions, pooled concatenations and cross-stage connections. The value in <span class="ltx_text ltx_font_bold" id="S4.T7.8.1">bold</span> means the best results.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T7.6">
<tr class="ltx_tr" id="S4.T7.6.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T7.6.6.7"><span class="ltx_text ltx_font_bold" id="S4.T7.6.6.7.1">Variant</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.2.2.2">
<math alttext="\delta_{3}" class="ltx_Math" display="inline" id="S4.T7.1.1.1.m1.1"><semantics id="S4.T7.1.1.1.m1.1a"><msub id="S4.T7.1.1.1.m1.1.1" xref="S4.T7.1.1.1.m1.1.1.cmml"><mi id="S4.T7.1.1.1.m1.1.1.2" xref="S4.T7.1.1.1.m1.1.1.2.cmml">δ</mi><mn id="S4.T7.1.1.1.m1.1.1.3" xref="S4.T7.1.1.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.T7.1.1.1.m1.1b"><apply id="S4.T7.1.1.1.m1.1.1.cmml" xref="S4.T7.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T7.1.1.1.m1.1.1.1.cmml" xref="S4.T7.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T7.1.1.1.m1.1.1.2.cmml" xref="S4.T7.1.1.1.m1.1.1.2">𝛿</ci><cn id="S4.T7.1.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T7.1.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.1.1.1.m1.1c">\delta_{3}</annotation><annotation encoding="application/x-llamapun" id="S4.T7.1.1.1.m1.1d">italic_δ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T7.2.2.2.m2.1"><semantics id="S4.T7.2.2.2.m2.1a"><mo id="S4.T7.2.2.2.m2.1.1" stretchy="false" xref="S4.T7.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T7.2.2.2.m2.1b"><ci id="S4.T7.2.2.2.m2.1.1.cmml" xref="S4.T7.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.2.2.2.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T7.2.2.2.m2.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.3.3.3">
<span class="ltx_text ltx_font_bold" id="S4.T7.3.3.3.1">Abs Rel</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T7.3.3.3.m1.1"><semantics id="S4.T7.3.3.3.m1.1a"><mo id="S4.T7.3.3.3.m1.1.1" stretchy="false" xref="S4.T7.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T7.3.3.3.m1.1b"><ci id="S4.T7.3.3.3.m1.1.1.cmml" xref="S4.T7.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T7.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.4.4.4">
<span class="ltx_text ltx_font_bold" id="S4.T7.4.4.4.1">Sq Rel</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T7.4.4.4.m1.1"><semantics id="S4.T7.4.4.4.m1.1a"><mo id="S4.T7.4.4.4.m1.1.1" stretchy="false" xref="S4.T7.4.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T7.4.4.4.m1.1b"><ci id="S4.T7.4.4.4.m1.1.1.cmml" xref="S4.T7.4.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.4.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T7.4.4.4.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.5.5.5">
<span class="ltx_text ltx_font_bold" id="S4.T7.5.5.5.1">RMSE</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T7.5.5.5.m1.1"><semantics id="S4.T7.5.5.5.m1.1a"><mo id="S4.T7.5.5.5.m1.1.1" stretchy="false" xref="S4.T7.5.5.5.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T7.5.5.5.m1.1b"><ci id="S4.T7.5.5.5.m1.1.1.cmml" xref="S4.T7.5.5.5.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.5.5.5.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T7.5.5.5.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.6.6.6">
<span class="ltx_text ltx_font_bold" id="S4.T7.6.6.6.1">log10</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T7.6.6.6.m1.1"><semantics id="S4.T7.6.6.6.m1.1a"><mo id="S4.T7.6.6.6.m1.1.1" stretchy="false" xref="S4.T7.6.6.6.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T7.6.6.6.m1.1b"><ci id="S4.T7.6.6.6.m1.1.1.cmml" xref="S4.T7.6.6.6.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.6.6.6.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T7.6.6.6.m1.1d">↓</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T7.6.7">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T7.6.7.1">w/o dilated convolutions</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.6.7.2">0.9202</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.6.7.3">0.3520</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.6.7.4">0.0465</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.6.7.5">0.0965</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.6.7.6">0.0954</td>
</tr>
<tr class="ltx_tr" id="S4.T7.6.8">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S4.T7.6.8.1">w/o pooled concatenations</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.6.8.2">0.9211</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.6.8.3">0.3515</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.6.8.4">0.0461</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.6.8.5">0.0963</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.6.8.6">0.0950</td>
</tr>
<tr class="ltx_tr" id="S4.T7.6.9">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S4.T7.6.9.1">w/o cross-stage connections</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.6.9.2">0.9215</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.6.9.3">0.3513</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.6.9.4">0.0459</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.6.9.5">0.0957</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.6.9.6">0.0948</td>
</tr>
<tr class="ltx_tr" id="S4.T7.6.10">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r" id="S4.T7.6.10.1">Full model</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T7.6.10.2"><span class="ltx_text ltx_font_bold" id="S4.T7.6.10.2.1">0.9224</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T7.6.10.3"><span class="ltx_text ltx_font_bold" id="S4.T7.6.10.3.1">0.3511</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T7.6.10.4"><span class="ltx_text ltx_font_bold" id="S4.T7.6.10.4.1">0.0457</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T7.6.10.5"><span class="ltx_text ltx_font_bold" id="S4.T7.6.10.5.1">0.0952</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T7.6.10.6"><span class="ltx_text ltx_font_bold" id="S4.T7.6.10.6.1">0.0943</span></td>
</tr>
</table>
</figure>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="584" id="S4.F5.g1" src="extracted/5897268/Figures/fig_5.png" width="586"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Qualitative comparison of our model’s depth and surface normal predictions, trained exclusively on pseudo-labelled real-world images. From top left: DeepFish <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib18" title="">18</a>]</cite>, USOD10K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib11" title="">11</a>]</cite>, SQUID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib4" title="">4</a>]</cite>, and Sea-Thru <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib1" title="">1</a>]</cite>. These results demonstrate the model’s robustness and ability to capture fine-grained details.
</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="440" id="S4.F6.g1" src="extracted/5897268/Figures/fig_6.png" width="586"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Comparison between Marigold <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib12" title="">12</a>]</cite>, Metric3D-V2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib25" title="">25</a>]</cite>, and our model for depth and surface normals in open-world images. These predictions are from their public HuggingFace best model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib9" title="">9</a>]</cite>. <span class="ltx_text ltx_font_italic" id="S4.F6.2.1">The figure may be better viewed online where you can zoom in for more detail.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Qualitative Comparison</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">To further evaluate our proposed method, we conducted a qualitative comparison against existing models, focusing on both depth estimation and surface normals estimation. This qualitative assessment complements the quantitative results, providing visual insights into the model’s performance.</p>
</div>
<div class="ltx_para" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.F5" title="Figure 5 ‣ 4.4 Quantitative Comparison ‣ 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">5</span></a> showcases the outputs of our model trained exclusively on pseudo-labeled real images. The results demonstrate the model’s robustness in capturing intricate details in both depth and surface normals, particularly in visually complex underwater environments.</p>
</div>
<div class="ltx_para" id="S4.SS5.p3">
<p class="ltx_p" id="S4.SS5.p3.1">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.F6" title="Figure 6 ‣ 4.4 Quantitative Comparison ‣ 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">6</span></a>, we present a comparative analysis between our model (PoseidonNet), Marigold <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib12" title="">12</a>]</cite>, and Metric3D-V2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib25" title="">25</a>]</cite>, using open-world images. All models were evaluated using their best publicly available versions from the HuggingFace model hub <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib9" title="">9</a>]</cite>. The results consistently demonstrate that our method delivers more refined and accurate predictions for both depth and surface normals, especially in challenging scenarios where existing models, such as Marigold and Metric3D-V2, tend to exhibit limitations. Our approach demonstrates a noticeable improvement in sharpness and structure preservation, further illustrating its effectiveness in handling real-world imagery.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Ablation Study</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">To thoroughly investigate the contribution of each component in our proposed model, we conducted an extensive ablation study. Our analysis focused on evaluating the performance impact of various architectural elements, specifically the convolutional and transformer blocks, dilated convolutions, pooled concatenations, and cross-stage connections.</p>
</div>
<div class="ltx_para" id="S4.SS6.p2">
<ol class="ltx_enumerate" id="S4.I3">
<li class="ltx_item" id="S4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S4.I3.i1.p1">
<p class="ltx_p" id="S4.I3.i1.p1.2"><span class="ltx_text ltx_font_bold" id="S4.I3.i1.p1.2.1">Convolutional and Transformer Blocks</span>: The study revealed that both the convolutional (<span class="ltx_text ltx_markedasmath" id="S4.I3.i1.p1.2.2">Conv</span>) and transformer (<span class="ltx_text ltx_markedasmath" id="S4.I3.i1.p1.2.3">Transformer</span>) blocks are critical to the model’s overall performance. Removing either block resulted in a significant decrease in accuracy, underscoring the importance of the synergy between these two components. This observation is supported by the quantitative results presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.T6" title="Table 6 ‣ 4.4 Quantitative Comparison ‣ 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">6</span></a>, where the full model, which includes both convolutional and transformer blocks, achieves the best performance.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S4.I3.i2.p1">
<p class="ltx_p" id="S4.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i2.p1.1.1">Dilated Convolutions, Pooled Concatenations, and Cross-Stage Connections</span>: Similarly, the removal of any of the following components-dilated convolutions, pooled concatenations, or cross-stage connections-led to a degradation in the model’s performance. This suggests that each of these architectural elements plays a pivotal role in enhancing depth and surface normal estimation accuracy. The quantitative comparison results for these components are summarised in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.T7" title="Table 7 ‣ 4.4 Quantitative Comparison ‣ 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">7</span></a>, where the full model consistently outperforms the variants lacking these features.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_subsection" id="S4.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>Computational Efficiency</h3>
<div class="ltx_para" id="S4.SS7.p1">
<p class="ltx_p" id="S4.SS7.p1.1">Beyond accuracy, we also analysed PoseidonNet’s computational efficiency, a crucial factor for real-time applications and deployment on resource-constrained devices. As illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#S4.T8" title="Table 8 ‣ 4.7 Computational Efficiency ‣ 4 Experiments ‣ Learning from the Giants: A Practical Approach to Underwater Depth and Surface Normals Estimation"><span class="ltx_text ltx_ref_tag">8</span></a>, PoseidonNet demonstrated a notable balance between accuracy and efficiency. It boasts a significantly lower parameter count and requires less memory compared to more complex models like TransDepth. Furthermore, PoseidonNet achieves a high frame rate (FPS), enabling real-time performance with minimal computational resources.</p>
</div>
<figure class="ltx_table" id="S4.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Comparison Results for Complexity and FPS of the proposed PoseidonNet and compared methods. On a Linux platform using a single NVIDIA GeForce RTX 4090 GPU</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T8.1">
<tr class="ltx_tr" id="S4.T8.1.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T8.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T8.1.1.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T8.1.1.2.1">Params (M)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T8.1.1.3.1">Memory (GB)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T8.1.1.4.1">FLOPs (G)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T8.1.1.5.1">FPS</span></td>
</tr>
<tr class="ltx_tr" id="S4.T8.1.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T8.1.2.1">BTS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib15" title="">15</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.1.2.2">16.34</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.1.2.3">62.65</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.1.2.4">246.80</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.1.2.5">26</td>
</tr>
<tr class="ltx_tr" id="S4.T8.1.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S4.T8.1.3.1">LapDepth <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib19" title="">19</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.3.2">73.57</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.3.3">281.62</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.3.4">364.57</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.3.5">20</td>
</tr>
<tr class="ltx_tr" id="S4.T8.1.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S4.T8.1.4.1">LiteMono <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib29" title="">29</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.4.2">8.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.4.3">33.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.4.4">112.12</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.4.5">55</td>
</tr>
<tr class="ltx_tr" id="S4.T8.1.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S4.T8.1.5.1">TransDepth <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib22" title="">22</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.5.2">247.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.5.3">944.13</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.5.4">1187.67</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.5.5">6</td>
</tr>
<tr class="ltx_tr" id="S4.T8.1.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S4.T8.1.6.1">UDepth <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib26" title="">26</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.6.2">15.65</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.6.3">59.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.6.4">77.16</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.6.5">66</td>
</tr>
<tr class="ltx_tr" id="S4.T8.1.7">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S4.T8.1.7.1">UMono <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02072v1#bib.bib21" title="">21</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.7.2">28.11</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.7.3">107.61</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.7.4">148.91</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.1.7.5">30</td>
</tr>
<tr class="ltx_tr" id="S4.T8.1.8">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r" id="S4.T8.1.8.1">PoseidonNet (Ours)</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T8.1.8.2">7.58</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T8.1.8.3">30.60</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T8.1.8.4">98.10</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T8.1.8.5">63</td>
</tr>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">This research introduces a novel approach to underwater monocular depth and surface normals estimation, addressing the limitations of existing methods while prioritising efficiency and practical applicability. By combining a hybrid CNN-Transformer architecture with a novel pseudo-labelling technique, this work achieves state-of-the-art performance with significantly reduced computational demands.</p>
</div>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Balancing Local and Global Features:</h5>
<div class="ltx_para" id="S5.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px1.p1.1">The success of our proposed PoseidonNet model stems from its hybrid architecture, which effectively integrates the strengths of CNNs and Transformers. CNNs excel at extracting local features and details, while Transformers are adept at capturing long-range dependencies and global context. This combination is particularly valuable in underwater environments, where variations in lighting, turbidity, and object textures complicate accurate depth and surface normal estimation.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Enhancing Generalisation with Pseudo-Labelling:</h5>
<div class="ltx_para" id="S5.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px2.p1.1">Recognising the limitations of relying solely on real-world datasets, often plagued by noisy or missing labels, this research introduces a novel pseudo-labelling approach. This method leverages the strengths of existing pre-trained models to generate high-quality pseudo-labelled data from readily available unlabeled underwater images. To ensure the accuracy of these pseudo-labelled data, we developed DNESA (Depth Normal Evaluation and Selection Algorithm), which uses domain-specific metrics to evaluate and select the most reliable samples for training. This approach effectively bridges the gap between synthetic and real-world data, resulting in a more robust and generalisable model.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Practicality Through Efficiency:</h5>
<div class="ltx_para" id="S5.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px3.p1.1">A key contribution of this work is its focus on computational efficiency without compromising accuracy. The proposed model achieves a notable reduction in parameters 90% and a reduction in the computational cost of training 80% compared to current methods. This efficiency translates to real-time inference capabilities (approximately 15.87ms per image), making the model highly suitable for deployment on resource-constrained devices commonly used in underwater robotics and autonomous vehicles. This advancement opens up new possibilities for real-time 3D perception in underwater environments.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS0.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Broader Implications for Marine Science:</h5>
<div class="ltx_para" id="S5.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S5.SS0.SSS0.Px4.p1.1">The implications of this research extend beyond the improved estimate of the depth and surface normals. The ability to generate accurate 3D information from a single image, efficiently and in real time, holds immense potential for various marine science applications, including:</p>
</div>
<div class="ltx_para" id="S5.SS0.SSS0.Px4.p2">
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">Detailed Seafloor Mapping:</span> High-resolution depth maps facilitate the creation of more accurate and detailed seafloor maps, essential for understanding underwater topography and ecosystems.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">Coral Reef Health Assessment:</span> By providing detailed 3D models of coral reefs, this technology aids in monitoring their health, identifying areas of damage or disease, and informing conservation efforts.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">Species Population Studies:</span> Accurate depth information can be used to estimate fish populations and track their movements, providing valuable data for fisheries management and ecological research.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.1">Monitoring Underwater Infrastructure:</span> This technology assists in inspecting and monitoring the structural integrity of underwater infrastructure, such as pipelines and submerged structures.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S5.SS0.SSS0.Px4.p3">
<p class="ltx_p" id="S5.SS0.SSS0.Px4.p3.1">The efficient and scalable nature of our proposed model makes it a valuable tool for both researchers and practitioners in marine science, offering a practical solution for a wide range of underwater applications.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">This research presents a practical solution for the estimation of monocular depth and surface normals in underwater environments. By combining a hybrid CNN-Transformer architecture with an innovative pseudo-labelling technique, the proposed model achieves high accuracy while significantly reducing computational demands and reliance on large labelled datasets.
PoseidonNet, our hybrid model, is designed for efficient depth and surface normal estimation, with DNESA improving the quality of pseudo-labelled data and enhancing generalisation. This approach bridges the gap between research and real-world application, enabling real-time 3D perception on resource-constrained devices.
Our model is particularly suited for underwater tasks such as seafloor mapping, coral reef monitoring, and species population studies. Future work will expand the model’s capabilities for broader marine applications and improve its integration into real-world systems.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Data Availability</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">The datasets are publicly available on their corresponding online repositories.</p>
</div>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>
<div class="ltx_para" id="Sx2.p1">
<p class="ltx_p" id="Sx2.p1.1">This research was supported by the Australian Institute of Marine Science (AIMS) and James Cook University (JCU) through a Postdoctoral Research Fellowship under the AIMS@JCU program. The authors would like to thank AIMS and JCU for their continued support and resources provided during the course of this work.</p>
</div>
</section>
<section class="ltx_section" id="Sx3">
<h2 class="ltx_title ltx_title_section">Additional Information</h2>
<div class="ltx_para" id="Sx3.p1">
<p class="ltx_p" id="Sx3.p1.1"><span class="ltx_text ltx_font_bold" id="Sx3.p1.1.1">Competing interests</span> The authors declare no competing interests.
<br class="ltx_break"/></p>
</div>
<div class="ltx_para" id="Sx3.p2">
<span class="ltx_ERROR undefined" id="Sx3.p2.1">\printcredits</span>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Akkaynak and Treibitz [2019]</span>
<span class="ltx_bibblock">
Akkaynak, D., Treibitz, T., 2019.

</span>
<span class="ltx_bibblock">Sea-thru: A method for removing water from underwater images, in: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pp. 1682–1691.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alhashim [2018]</span>
<span class="ltx_bibblock">
Alhashim, I., 2018.

</span>
<span class="ltx_bibblock">High quality monocular depth estimation via transfer learning.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1812.11941 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bae et al. [2022]</span>
<span class="ltx_bibblock">
Bae, G., Budvytis, I., Cipolla, R., 2022.

</span>
<span class="ltx_bibblock">Irondepth: Iterative refinement of single-view depth using surface normal and its uncertainty.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:2210.03676 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berman et al. [2020]</span>
<span class="ltx_bibblock">
Berman, D., Levy, D., Avidan, S., Treibitz, T., 2020.

</span>
<span class="ltx_bibblock">Underwater single image color restoration using haze-lines and a new quantitative dataset.

</span>
<span class="ltx_bibblock">IEEE transactions on pattern analysis and machine intelligence 43, 2822–2837.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhat et al. [2020]</span>
<span class="ltx_bibblock">
Bhat, S.F., Alhashim, I., Wonka, P., 2020.

</span>
<span class="ltx_bibblock">Adabins: Depth estimation using adaptive bins. in 2021 ieee, in: CVF Conference on Computer Vision and Pattern Recognition (CVPR), pp. 4008–4017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhat et al. [2023]</span>
<span class="ltx_bibblock">
Bhat, S.F., Birkl, R., Wofk, D., Wonka, P., Müller, M., 2023.

</span>
<span class="ltx_bibblock">Zoedepth: Zero-shot transfer by combining relative and metric depth.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:2302.12288 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Costanzino et al. [2023]</span>
<span class="ltx_bibblock">
Costanzino, A., Ramirez, P.Z., Poggi, M., Tosi, F., Mattoccia, S., Di Stefano, L., 2023.

</span>
<span class="ltx_bibblock">Learning depth estimation for transparent and mirror surfaces, in: Proceedings of the IEEE/CVF International Conference on Computer Vision, pp. 9244–9255.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Eftekhar et al. [2021]</span>
<span class="ltx_bibblock">
Eftekhar, A., Sax, A., Malik, J., Zamir, A., 2021.

</span>
<span class="ltx_bibblock">Omnidata: A scalable pipeline for making multi-task mid-level vision datasets from 3d scans, in: Proceedings of the IEEE/CVF International Conference on Computer Vision, pp. 10786–10796.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Face and Face [2021]</span>
<span class="ltx_bibblock">
Face, H., Face, H., 2021.

</span>
<span class="ltx_bibblock">The ai community building the future.

</span>
<span class="ltx_bibblock">URL: https://huggingface. co .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta and Mitra [2019]</span>
<span class="ltx_bibblock">
Gupta, H., Mitra, K., 2019.

</span>
<span class="ltx_bibblock">Unsupervised single image underwater depth estimation, in: 2019 IEEE International Conference on Image Processing (ICIP), IEEE. pp. 624–628.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Hong, L., Wang, X., Zhang, G., Zhao, M., .

</span>
<span class="ltx_bibblock">USOD10K: A New Benchmark Dataset for Underwater Salient Object Detection.

</span>
<span class="ltx_bibblock">Online: github.com/LinHong-HIT/USOD10K.

</span>
<span class="ltx_bibblock">Accessed: 09-09-2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ke et al. [2024]</span>
<span class="ltx_bibblock">
Ke, B., Obukhov, A., Huang, S., Metzger, N., Daudt, R.C., Schindler, K., 2024.

</span>
<span class="ltx_bibblock">Repurposing diffusion-based image generators for monocular depth estimation, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pp. 9492–9502.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma [2014]</span>
<span class="ltx_bibblock">
Kingma, D.P., 2014.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1412.6980 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koch et al. [2018]</span>
<span class="ltx_bibblock">
Koch, T., Liebel, L., Fraundorfer, F., Korner, M., 2018.

</span>
<span class="ltx_bibblock">Evaluation of cnn-based single-image depth estimation methods, in: Proceedings of the European Conference on Computer Vision (ECCV) Workshops, pp. 0–0.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. [2019]</span>
<span class="ltx_bibblock">
Lee, J.H., Han, M.K., Ko, D.W., Suh, I.H., 2019.

</span>
<span class="ltx_bibblock">From big to small: Multi-scale local planar guidance for monocular depth estimation.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1907.10326 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. [2018]</span>
<span class="ltx_bibblock">
Peng, Y.T., Cao, K., Cosman, P.C., 2018.

</span>
<span class="ltx_bibblock">Generalization of the dark channel prior for single image restoration.

</span>
<span class="ltx_bibblock">IEEE Transactions on Image Processing 27, 2856–2868.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ranftl et al. [2020]</span>
<span class="ltx_bibblock">
Ranftl, R., Lasinger, K., Hafner, D., Schindler, K., Koltun, V., 2020.

</span>
<span class="ltx_bibblock">Towards robust monocular depth estimation: Mixing datasets for zero-shot cross-dataset transfer.

</span>
<span class="ltx_bibblock">IEEE transactions on pattern analysis and machine intelligence 44, 1623–1637.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saleh et al. [2020]</span>
<span class="ltx_bibblock">
Saleh, A., Laradji, I.H., Konovalov, D.A., Bradley, M., Vazquez, D., Sheaves, M., 2020.

</span>
<span class="ltx_bibblock">A realistic fish-habitat dataset to evaluate algorithms for underwater visual analysis.

</span>
<span class="ltx_bibblock">Scientific Reports 10, 14671.

</span>
<span class="ltx_bibblock">doi:<a class="ltx_ref" href="https:/doi.org/https://doi.org/10.1038/s41598-020-71639-x" title="">https://doi.org/10.1038/s41598-020-71639-x</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. [2021]</span>
<span class="ltx_bibblock">
Song, M., Lim, S., Kim, W., 2021.

</span>
<span class="ltx_bibblock">Monocular depth estimation using laplacian pyramid-based depth residuals.

</span>
<span class="ltx_bibblock">IEEE transactions on circuits and systems for video technology 31, 4381–4393.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Varghese et al. [2023]</span>
<span class="ltx_bibblock">
Varghese, N., Kumar, A., Rajagopalan, A.N., 2023.

</span>
<span class="ltx_bibblock">Self-supervised monocular underwater depth recovery, image restoration, and a real-sea video dataset, in: Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV), pp. 12248–12258.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2024]</span>
<span class="ltx_bibblock">
Wang, J., Wang, J., Rong, S., He, B., 2024.

</span>
<span class="ltx_bibblock">Umono: Physical model informed hybrid cnn-transformer framework for underwater monocular depth estimation.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:2407.17838 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2021]</span>
<span class="ltx_bibblock">
Yang, G., Tang, H., Ding, M., Sebe, N., Ricci, E., 2021.

</span>
<span class="ltx_bibblock">Transformer-based attention networks for continuous pixel-wise prediction, in: Proceedings of the IEEE/CVF International Conference on Computer vision, pp. 16269–16279.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2024]</span>
<span class="ltx_bibblock">
Yang, L., Kang, B., Huang, Z., Zhao, Z., Xu, X., Feng, J., Zhao, H., 2024.

</span>
<span class="ltx_bibblock">Depth anything v2.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:2406.09414 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. [2019]</span>
<span class="ltx_bibblock">
Yin, W., Liu, Y., Shen, C., Yan, Y., 2019.

</span>
<span class="ltx_bibblock">Enforcing geometric constraints of virtual normal for depth prediction, in: Proceedings of the IEEE/CVF international conference on computer vision, pp. 5684–5693.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. [2023]</span>
<span class="ltx_bibblock">
Yin, W., Zhang, C., Chen, H., Cai, Z., Yu, G., Wang, K., Chen, X., Shen, C., 2023.

</span>
<span class="ltx_bibblock">Metric3d: Towards zero-shot metric 3d prediction from a single image, in: Proceedings of the IEEE/CVF International Conference on Computer Vision, pp. 9043–9053.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. [2023]</span>
<span class="ltx_bibblock">
Yu, B., Wu, J., Islam, M.J., 2023.

</span>
<span class="ltx_bibblock">Udepth: Fast monocular depth estimation for visually-guided underwater robots, in: 2023 IEEE International Conference on Robotics and Automation (ICRA), IEEE. pp. 3116–3123.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zavadski et al. [2024]</span>
<span class="ltx_bibblock">
Zavadski, D., Kalšan, D., Rother, C., 2024.

</span>
<span class="ltx_bibblock">Primedepth: Efficient monocular depth estimation with a stable diffusion preimage.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:2409.09144 .

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2024]</span>
<span class="ltx_bibblock">
Zhang, F., You, S., Li, Y., Fu, Y., 2024.

</span>
<span class="ltx_bibblock">Atlantis: Enabling underwater depth estimation with stable diffusion, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pp. 11852–11861.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2023]</span>
<span class="ltx_bibblock">
Zhang, N., Nex, F., Vosselman, G., Kerle, N., 2023.

</span>
<span class="ltx_bibblock">Lite-mono: A lightweight cnn and transformer architecture for self-supervised monocular depth estimation, in: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pp. 18537–18546.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct  2 22:36:00 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
