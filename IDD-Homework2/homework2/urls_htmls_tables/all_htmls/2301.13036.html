<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2301.13036] Federated Learning for Water Consumption Forecasting in Smart Cities</title><meta property="og:description" content="Water consumption remains a major concern among the world’s future challenges. For applications like load monitoring and demand response, deep learning models are trained using enormous volumes of consumption data in s…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning for Water Consumption Forecasting in Smart Cities">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning for Water Consumption Forecasting in Smart Cities">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2301.13036">

<!--Generated on Fri Mar  1 03:38:59 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Federated learning,  edge learning,  water consumption prediction
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Learning for Water Consumption Forecasting in Smart Cities</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Mohammed El Hanjri3, Hibatallah Kabbaj3, Abdellatif Kobbane3, Amine Abouaomar1
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">3ENSIAS, Mohammed V University in Rabat, Morocco.
</span>
<span class="ltx_contact ltx_role_affiliation">1School of Science and Engineering, Al Akhawayn University in Ifrane, Morocco.
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Water consumption remains a major concern among the world’s future challenges. For applications like load monitoring and demand response, deep learning models are trained using enormous volumes of consumption data in smart cities. On the one hand, the information used is private. For instance, the precise information gathered by a smart meter that is a part of the system’s IoT architecture at a consumer’s residence may give details about the appliances and, consequently, the consumer’s behavior at home. On the other hand, enormous data volumes with sufficient variation are needed for the deep learning models to be trained properly. This paper introduces a novel model for water consumption prediction in smart cities while preserving privacy regarding monthly consumption. The proposed approach leverages federated learning (FL) as a machine learning paradigm designed to train a machine learning model in a distributed manner while avoiding sharing the users data with a central training facility. In addition, this approach is promising to reduce the overhead utilization through decreasing the frequency of data transmission between the users and the central entity. Extensive simulation illustrate that the proposed approach shows an enhancement in predicting water consumption for different households.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Federated learning, edge learning, water consumption prediction

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">In order to develop smart cities, load forecasting is a crucial step. Long-term consumption forecasts of various vital resources are essential for infrastructure management and planning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. In addition, short and medium term consumption forecasts are critical for system performance. The daily operational efficiency of water distribution, in particular, requires accurate short-term forecasting, which relies on the collection and analysis of large volumes of data from the various domains<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. However, the forecasting of individual short-term loads is a challenging task to accomplish due to the high volatility of user profiles. Indeed, the water demand of a household or building is strongly influenced by the behavior of its residents, which is too stochastic and therefore difficult to anticipate.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To predict load and consumption, different approaches have been proposed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, including linear and dynamic programming, heuristic methods, game theory, and fuzzy methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. The problem is that existing centralized and decentralized approaches do not consider online solutions for large-scale real-world databases, which is usually the case for residential consumption <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Due to large amounts of data from water meters, these approaches generate notable slowdowns, which are not optimal for real-time applications. In the era of big data, many machine learning methods are emerging as suitable for overcoming this limitation by automatically exploiting, controlling, and optimizing load prediction models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. This can be achieved by applying successive transformations to historical data to train robust machine learning models to accommodate the high uncertainty of water patterns, and control demand based on load patterns and market cost signals.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">By utilizing the caching capabilities coupled with the Fog characteristics, the authors provide a green method to enhance performance of the energy efficiency in a fog computing environment and Internet of Everything (IoE) devices. To handle distributed networking, processing, and storage resources, they make use of fog computing. As content requesters with limited resources, IoT devices will make use of cutting-edge caching techniques to deliver high-quality services that demand a lot of computational power and a high throughput <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Recently, the machine learning community proposed Federated Learning (FL) as a novel on-device method to address privacy issues while also growing the number and variety of data sets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.
A decentralized machine learning method called federated learning allows any device to train a central model without delivering any data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. The model is initially initialized by the server either randomly or using data that is readily accessible to the public <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.
The model is then given to a group of clients that have been chosen at random, where it will be trained locally using their data.
Each client updates the model’s weights, which are then communicated to the server, averaged, and used to update the overall model.
This process will be continued until the global model stabilizes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">This paper’s primary goal is to assess how well the Federated Learning approach worked for the STLF challenge on home water use.
For time series forecasting, we use a deep neural network called Long Short Term Memory (LSTM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, which makes predictions about future measurements of the water consumption of the home based on past ones. We investigate a set of structures with comparable characteristics (geographical location, type of building). Federated learning is carried out using home grid Edge technology <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. Edge equipment, such as smart meters or more sophisticated devices, is frequently installed at the end of the water distribution system to serve as a smart interface between the customer and the water supply. We made the following contributions to this effort, in brief: Using Edge technology in smart cities, We first suggest an enabling architecture for FL, then we simulate the potential accuracy gain of FL and last we use numerical findings to simulate the potential network load gain. We also include in these contributions the improvement in privacy made available by decentralization and Edge computing.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The rest of this paper is organized as follows, with section II discussing related works with a focus on load forecasting and privacy. The system model is described in Section III, while Section IV presents the simulation and numerical findings. Section V serves as the paper’s conclusion. 
<br class="ltx_break"></p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Deep neural networks, especially in particular Long-short term memory (LSTM), have been employed extensively in recent research to address the difficulty of short-term load forecasting.
However, the results fall short of the required level of precision in terms of Mean Average Percentage Error (MAPE) and Root Mean Square Error (RMSE), despite benchmarks demonstrating LSTM’s capability in comparison to other methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. The authors of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> suggest using a sequence-to-sequence LSTM version of LSTM to increase forecasting accuracy. This variant performs better for data with a one-minute resolution but does not significantly outperform regular LSTM for data with an hour resolution. Additionally, some writers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> employ the evolutionary algorithm to solve the challenge of selecting the optimal LSTM network because they view it as a hyperparameter tuning problem.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">According to some other studies, the issue is actually with data-driven forecasting models capacity to generalize, not just with neural network architecture.
In fact, when applied to fresh datasets, several of the presented models accuracy decreases <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Grouping data from several clients is another method for enhancing the training data. By grouping people with comparable profiles, the authors of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> are able to lower the variation of uncertainty within groups. To solve the overfitting issue, authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> suggest a pooling strategy that broadens the diversity of the data. However, these approaches are very centralized and prone to privacy problems.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">In the proposed study, we recommend using the federated learning strategy to carry out client selection and neural network training at the edge. This will allow the use of data to build a reference model without sacrificing resident privacy.
In order to do this, the Home Area Network (HAN) Edge Equipment is utilized.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">System Model</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We suggest the network architecture shown in Figure 1, which has a Multi-access Edge Computing (MEC) server and users as its two primary parts. The users are buildings having Edge equipment made up primarily of smart meters and other HAN devices. For STLF, FL is utilized to create a global model based on LSTM.
The MEC server orchestrates the training rounds, which are carried out by the users using information about their local water consumption. We go into greater detail regarding LSTM and its use in forecasting, as well as FL and its use in our system model, in this part. 
<br class="ltx_break"></p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2301.13036/assets/Picture1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="344" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Network architecture and components</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Time series forecasting using LSTM</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">In this work, the time series forecasting technique with LSTM is used to predict the future water load. A time series is an organized collection of equally spaced data sets that shows how a certain variable has changed over time. By modeling the connections between the points of the current data and the points of the past, time series forecasting is made possible, but the precision of the forecasts is greatly influenced by the model that is used and the caliber of the historical data points. 
<br class="ltx_break">Recurrent neural networks (RNNs) like LSTM are more effective than typical RNNs and fundamentally different from conventional feedforward RNNs. The strength of LSTM is sequence learning. It can resolve vanishing and exploding gradient difficulties, which are frequent in RNNs, and establish temporal correlations between earlier data points and the current situation. Gradient exploding relates to the opposite process, whereas gradient vanishing describes how the norm of the gradient for long-term components gets less, leading weights to never change at lower levels. This is made possible by two of its essential elements: the memory cell, which is utilized to recall significant prior events, and the gates, which control the information flow. The input gate, output gate, and forget gate are the three gates that make up an LSTM. During the learning process, they acquire the skill of clearing the memory of irrelevant data.
Utilizing LSTM and its derivatives, nearly all state-of-the-art outcomes in sequence learning are accomplished.
For residential STLF, it is anticipated that the LSTM network will be able to track the states of the inhabitants, abstract some states from the provided consumption profile, and forecast future consumption using the learned data.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Federated Learning</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.9" class="ltx_p">A type of machine learning called federated learning involves distributing the majority of the training process across various clients, or computer devices. On mobile device keyboards for next word prediction, Google first put out and executed the idea <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. For many situations, this strategy is ideal: 1) In highly distributed systems, when there are orders of magnitude more devices than data center nodes, 2) When data privacy is important, and 3) When data is huge in comparison to model updates. In cases when datasets are uneven or not dispersed evenly, federated learning has been shown to be quite effective.
<br class="ltx_break">Following is an example of federated learning iteration:
First, the current model is given to each client in a selected subset. In this instance, clients are housed using Edge equipment (e.g. smart meters). On locally stored data, a few clients choose to compute Stochastic Gradient Descent (SGD) updates. A server then integrates the client updates to produce a new global model. A different group of clients is sent the updated model. Until the necessary forecast accuracy is attained, this process is repeated. Algorithm 1 describes the procedures in detail.
<br class="ltx_break">The server employs the Federated Averaging algorithm to integrate the client updates <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.
The starting global model is first randomly initialized or trained beforehand using publicly accessible data. A subset <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">S</annotation></semantics></math> of clients with sufficient data records and diverse enough consumption loads to augment the training data are sent a global model <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\omega_{t}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">ω</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝜔</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\omega_{t}</annotation></semantics></math> by the server in each training round <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">t</annotation></semantics></math>. This requirement was introduced to make sure we have enough variety among the data points to accurately depict the occupants’ typical consumption. Each client <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">s</annotation></semantics></math> in the subset then employs <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="m_{s}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">m</mi><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝑚</ci><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">m_{s}</annotation></semantics></math> samples from its own local data. In our case, the volume is based on the amount of data that is locally stored and the length of time that the smart meter has been providing data. The dataset used consists of sliding windows with a predetermined number of look-back steps. The average gradient <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="g_{s}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">g</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝑔</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">g_{s}</annotation></semantics></math> is then calculated by each client <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">s</annotation></semantics></math> using SGD, with a learning rate <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><mi id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">\eta</annotation></semantics></math>. The server receives the updated models <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="\omega_{s}" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><msub id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><mi id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml">ω</mi><mi id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2">𝜔</ci><ci id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\omega_{s}</annotation></semantics></math> and aggregates them.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.18" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.18.15" class="ltx_listingline">
</div>
<div id="algorithm1.5.1" class="ltx_listingline">Initialize the model in training round <math id="algorithm1.5.1.m1.1" class="ltx_Math" alttext="t=0" display="inline"><semantics id="algorithm1.5.1.m1.1a"><mrow id="algorithm1.5.1.m1.1.1" xref="algorithm1.5.1.m1.1.1.cmml"><mi id="algorithm1.5.1.m1.1.1.2" xref="algorithm1.5.1.m1.1.1.2.cmml">t</mi><mo id="algorithm1.5.1.m1.1.1.1" xref="algorithm1.5.1.m1.1.1.1.cmml">=</mo><mn id="algorithm1.5.1.m1.1.1.3" xref="algorithm1.5.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.1.m1.1b"><apply id="algorithm1.5.1.m1.1.1.cmml" xref="algorithm1.5.1.m1.1.1"><eq id="algorithm1.5.1.m1.1.1.1.cmml" xref="algorithm1.5.1.m1.1.1.1"></eq><ci id="algorithm1.5.1.m1.1.1.2.cmml" xref="algorithm1.5.1.m1.1.1.2">𝑡</ci><cn type="integer" id="algorithm1.5.1.m1.1.1.3.cmml" xref="algorithm1.5.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.1.m1.1c">t=0</annotation></semantics></math>;
</div>
<div id="algorithm1.6.2" class="ltx_listingline">
<span id="algorithm1.6.2.2" class="ltx_text ltx_font_bold">while</span> <em id="algorithm1.6.2.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.6.2.1.m1.1" class="ltx_Math" alttext="t\leq t_{max}" display="inline"><semantics id="algorithm1.6.2.1.m1.1a"><mrow id="algorithm1.6.2.1.m1.1.1" xref="algorithm1.6.2.1.m1.1.1.cmml"><mi id="algorithm1.6.2.1.m1.1.1.2" xref="algorithm1.6.2.1.m1.1.1.2.cmml">t</mi><mo id="algorithm1.6.2.1.m1.1.1.1" xref="algorithm1.6.2.1.m1.1.1.1.cmml">≤</mo><msub id="algorithm1.6.2.1.m1.1.1.3" xref="algorithm1.6.2.1.m1.1.1.3.cmml"><mi id="algorithm1.6.2.1.m1.1.1.3.2" xref="algorithm1.6.2.1.m1.1.1.3.2.cmml">t</mi><mrow id="algorithm1.6.2.1.m1.1.1.3.3" xref="algorithm1.6.2.1.m1.1.1.3.3.cmml"><mi id="algorithm1.6.2.1.m1.1.1.3.3.2" xref="algorithm1.6.2.1.m1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="algorithm1.6.2.1.m1.1.1.3.3.1" xref="algorithm1.6.2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="algorithm1.6.2.1.m1.1.1.3.3.3" xref="algorithm1.6.2.1.m1.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.6.2.1.m1.1.1.3.3.1a" xref="algorithm1.6.2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="algorithm1.6.2.1.m1.1.1.3.3.4" xref="algorithm1.6.2.1.m1.1.1.3.3.4.cmml">x</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.6.2.1.m1.1b"><apply id="algorithm1.6.2.1.m1.1.1.cmml" xref="algorithm1.6.2.1.m1.1.1"><leq id="algorithm1.6.2.1.m1.1.1.1.cmml" xref="algorithm1.6.2.1.m1.1.1.1"></leq><ci id="algorithm1.6.2.1.m1.1.1.2.cmml" xref="algorithm1.6.2.1.m1.1.1.2">𝑡</ci><apply id="algorithm1.6.2.1.m1.1.1.3.cmml" xref="algorithm1.6.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.6.2.1.m1.1.1.3.1.cmml" xref="algorithm1.6.2.1.m1.1.1.3">subscript</csymbol><ci id="algorithm1.6.2.1.m1.1.1.3.2.cmml" xref="algorithm1.6.2.1.m1.1.1.3.2">𝑡</ci><apply id="algorithm1.6.2.1.m1.1.1.3.3.cmml" xref="algorithm1.6.2.1.m1.1.1.3.3"><times id="algorithm1.6.2.1.m1.1.1.3.3.1.cmml" xref="algorithm1.6.2.1.m1.1.1.3.3.1"></times><ci id="algorithm1.6.2.1.m1.1.1.3.3.2.cmml" xref="algorithm1.6.2.1.m1.1.1.3.3.2">𝑚</ci><ci id="algorithm1.6.2.1.m1.1.1.3.3.3.cmml" xref="algorithm1.6.2.1.m1.1.1.3.3.3">𝑎</ci><ci id="algorithm1.6.2.1.m1.1.1.3.3.4.cmml" xref="algorithm1.6.2.1.m1.1.1.3.3.4">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.2.1.m1.1c">t\leq t_{max}</annotation></semantics></math></em> <span id="algorithm1.6.2.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.7.3" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Select subset <math id="algorithm1.7.3.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="algorithm1.7.3.m1.1a"><mi id="algorithm1.7.3.m1.1.1" xref="algorithm1.7.3.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm1.7.3.m1.1b"><ci id="algorithm1.7.3.m1.1.1.cmml" xref="algorithm1.7.3.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.3.m1.1c">S</annotation></semantics></math> of clients;
</div>
<div id="algorithm1.9.5" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.9.5.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.9.5.2" class="ltx_emph ltx_font_italic">client <math id="algorithm1.8.4.1.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="algorithm1.8.4.1.m1.1a"><mi id="algorithm1.8.4.1.m1.1.1" xref="algorithm1.8.4.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="algorithm1.8.4.1.m1.1b"><ci id="algorithm1.8.4.1.m1.1.1.cmml" xref="algorithm1.8.4.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.4.1.m1.1c">s</annotation></semantics></math> in <math id="algorithm1.9.5.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="algorithm1.9.5.2.m2.1a"><mi id="algorithm1.9.5.2.m2.1.1" xref="algorithm1.9.5.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm1.9.5.2.m2.1b"><ci id="algorithm1.9.5.2.m2.1.1.cmml" xref="algorithm1.9.5.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.5.2.m2.1c">S</annotation></semantics></math></em> <span id="algorithm1.9.5.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.10.6" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.10.6.2" class="ltx_text ltx_font_bold">if</span> <em id="algorithm1.10.6.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.10.6.1.m1.1" class="ltx_Math" alttext="\Delta(monthlyload)&gt;threshold" display="inline"><semantics id="algorithm1.10.6.1.m1.1a"><mrow id="algorithm1.10.6.1.m1.1.1" xref="algorithm1.10.6.1.m1.1.1.cmml"><mrow id="algorithm1.10.6.1.m1.1.1.1" xref="algorithm1.10.6.1.m1.1.1.1.cmml"><mi mathvariant="normal" id="algorithm1.10.6.1.m1.1.1.1.3" xref="algorithm1.10.6.1.m1.1.1.1.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.1.2" xref="algorithm1.10.6.1.m1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.10.6.1.m1.1.1.1.1.1" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.10.6.1.m1.1.1.1.1.1.2" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.10.6.1.m1.1.1.1.1.1.1" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.10.6.1.m1.1.1.1.1.1.1.2" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.1.1.1.1.1" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.1.1.1.1.3" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.1.1.1.1.1a" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.1.1.1.1.4" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.1.1.1.1.1b" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.1.1.1.1.5" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.1.1.1.1.1c" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.1.1.1.1.6" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.1.1.1.1.1d" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.1.1.1.1.7" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.7.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.1.1.1.1.1e" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.1.1.1.1.8" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.8.cmml">y</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.1.1.1.1.1f" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.1.1.1.1.9" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.1.1.1.1.1g" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.1.1.1.1.10" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.10.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.1.1.1.1.1h" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.1.1.1.1.11" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.11.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.1.1.1.1.1i" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.1.1.1.1.12" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.12.cmml">d</mi></mrow><mo stretchy="false" id="algorithm1.10.6.1.m1.1.1.1.1.1.3" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.10.6.1.m1.1.1.2" xref="algorithm1.10.6.1.m1.1.1.2.cmml">&gt;</mo><mrow id="algorithm1.10.6.1.m1.1.1.3" xref="algorithm1.10.6.1.m1.1.1.3.cmml"><mi id="algorithm1.10.6.1.m1.1.1.3.2" xref="algorithm1.10.6.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.3.1" xref="algorithm1.10.6.1.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.3.3" xref="algorithm1.10.6.1.m1.1.1.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.3.1a" xref="algorithm1.10.6.1.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.3.4" xref="algorithm1.10.6.1.m1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.3.1b" xref="algorithm1.10.6.1.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.3.5" xref="algorithm1.10.6.1.m1.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.3.1c" xref="algorithm1.10.6.1.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.3.6" xref="algorithm1.10.6.1.m1.1.1.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.3.1d" xref="algorithm1.10.6.1.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.3.7" xref="algorithm1.10.6.1.m1.1.1.3.7.cmml">h</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.3.1e" xref="algorithm1.10.6.1.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.3.8" xref="algorithm1.10.6.1.m1.1.1.3.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.3.1f" xref="algorithm1.10.6.1.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.3.9" xref="algorithm1.10.6.1.m1.1.1.3.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.6.1.m1.1.1.3.1g" xref="algorithm1.10.6.1.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.10.6.1.m1.1.1.3.10" xref="algorithm1.10.6.1.m1.1.1.3.10.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.6.1.m1.1b"><apply id="algorithm1.10.6.1.m1.1.1.cmml" xref="algorithm1.10.6.1.m1.1.1"><gt id="algorithm1.10.6.1.m1.1.1.2.cmml" xref="algorithm1.10.6.1.m1.1.1.2"></gt><apply id="algorithm1.10.6.1.m1.1.1.1.cmml" xref="algorithm1.10.6.1.m1.1.1.1"><times id="algorithm1.10.6.1.m1.1.1.1.2.cmml" xref="algorithm1.10.6.1.m1.1.1.1.2"></times><ci id="algorithm1.10.6.1.m1.1.1.1.3.cmml" xref="algorithm1.10.6.1.m1.1.1.1.3">Δ</ci><apply id="algorithm1.10.6.1.m1.1.1.1.1.1.1.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1"><times id="algorithm1.10.6.1.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.1"></times><ci id="algorithm1.10.6.1.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.2">𝑚</ci><ci id="algorithm1.10.6.1.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.3">𝑜</ci><ci id="algorithm1.10.6.1.m1.1.1.1.1.1.1.4.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.4">𝑛</ci><ci id="algorithm1.10.6.1.m1.1.1.1.1.1.1.5.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.5">𝑡</ci><ci id="algorithm1.10.6.1.m1.1.1.1.1.1.1.6.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.6">ℎ</ci><ci id="algorithm1.10.6.1.m1.1.1.1.1.1.1.7.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.7">𝑙</ci><ci id="algorithm1.10.6.1.m1.1.1.1.1.1.1.8.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.8">𝑦</ci><ci id="algorithm1.10.6.1.m1.1.1.1.1.1.1.9.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.9">𝑙</ci><ci id="algorithm1.10.6.1.m1.1.1.1.1.1.1.10.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.10">𝑜</ci><ci id="algorithm1.10.6.1.m1.1.1.1.1.1.1.11.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.11">𝑎</ci><ci id="algorithm1.10.6.1.m1.1.1.1.1.1.1.12.cmml" xref="algorithm1.10.6.1.m1.1.1.1.1.1.1.12">𝑑</ci></apply></apply><apply id="algorithm1.10.6.1.m1.1.1.3.cmml" xref="algorithm1.10.6.1.m1.1.1.3"><times id="algorithm1.10.6.1.m1.1.1.3.1.cmml" xref="algorithm1.10.6.1.m1.1.1.3.1"></times><ci id="algorithm1.10.6.1.m1.1.1.3.2.cmml" xref="algorithm1.10.6.1.m1.1.1.3.2">𝑡</ci><ci id="algorithm1.10.6.1.m1.1.1.3.3.cmml" xref="algorithm1.10.6.1.m1.1.1.3.3">ℎ</ci><ci id="algorithm1.10.6.1.m1.1.1.3.4.cmml" xref="algorithm1.10.6.1.m1.1.1.3.4">𝑟</ci><ci id="algorithm1.10.6.1.m1.1.1.3.5.cmml" xref="algorithm1.10.6.1.m1.1.1.3.5">𝑒</ci><ci id="algorithm1.10.6.1.m1.1.1.3.6.cmml" xref="algorithm1.10.6.1.m1.1.1.3.6">𝑠</ci><ci id="algorithm1.10.6.1.m1.1.1.3.7.cmml" xref="algorithm1.10.6.1.m1.1.1.3.7">ℎ</ci><ci id="algorithm1.10.6.1.m1.1.1.3.8.cmml" xref="algorithm1.10.6.1.m1.1.1.3.8">𝑜</ci><ci id="algorithm1.10.6.1.m1.1.1.3.9.cmml" xref="algorithm1.10.6.1.m1.1.1.3.9">𝑙</ci><ci id="algorithm1.10.6.1.m1.1.1.3.10.cmml" xref="algorithm1.10.6.1.m1.1.1.3.10">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.6.1.m1.1c">\Delta(monthlyload)&gt;threshold</annotation></semantics></math></em> <span id="algorithm1.10.6.3" class="ltx_text ltx_font_bold">then</span> 
</div>
<div id="algorithm1.12.8" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.11.7.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="algorithm1.11.7.m1.1a"><mi id="algorithm1.11.7.m1.1.1" xref="algorithm1.11.7.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="algorithm1.11.7.m1.1b"><ci id="algorithm1.11.7.m1.1.1.cmml" xref="algorithm1.11.7.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.7.m1.1c">s</annotation></semantics></math> obtains model <math id="algorithm1.12.8.m2.1" class="ltx_Math" alttext="\omega_{t}" display="inline"><semantics id="algorithm1.12.8.m2.1a"><msub id="algorithm1.12.8.m2.1.1" xref="algorithm1.12.8.m2.1.1.cmml"><mi id="algorithm1.12.8.m2.1.1.2" xref="algorithm1.12.8.m2.1.1.2.cmml">ω</mi><mi id="algorithm1.12.8.m2.1.1.3" xref="algorithm1.12.8.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.12.8.m2.1b"><apply id="algorithm1.12.8.m2.1.1.cmml" xref="algorithm1.12.8.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.12.8.m2.1.1.1.cmml" xref="algorithm1.12.8.m2.1.1">subscript</csymbol><ci id="algorithm1.12.8.m2.1.1.2.cmml" xref="algorithm1.12.8.m2.1.1.2">𝜔</ci><ci id="algorithm1.12.8.m2.1.1.3.cmml" xref="algorithm1.12.8.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.8.m2.1c">\omega_{t}</annotation></semantics></math>;
</div>
<div id="algorithm1.14.10" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.13.9.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="algorithm1.13.9.m1.1a"><mi id="algorithm1.13.9.m1.1.1" xref="algorithm1.13.9.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="algorithm1.13.9.m1.1b"><ci id="algorithm1.13.9.m1.1.1.cmml" xref="algorithm1.13.9.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.9.m1.1c">s</annotation></semantics></math> calculates average gradient <math id="algorithm1.14.10.m2.1" class="ltx_Math" alttext="g_{s}" display="inline"><semantics id="algorithm1.14.10.m2.1a"><msub id="algorithm1.14.10.m2.1.1" xref="algorithm1.14.10.m2.1.1.cmml"><mi id="algorithm1.14.10.m2.1.1.2" xref="algorithm1.14.10.m2.1.1.2.cmml">g</mi><mi id="algorithm1.14.10.m2.1.1.3" xref="algorithm1.14.10.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.14.10.m2.1b"><apply id="algorithm1.14.10.m2.1.1.cmml" xref="algorithm1.14.10.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.14.10.m2.1.1.1.cmml" xref="algorithm1.14.10.m2.1.1">subscript</csymbol><ci id="algorithm1.14.10.m2.1.1.2.cmml" xref="algorithm1.14.10.m2.1.1.2">𝑔</ci><ci id="algorithm1.14.10.m2.1.1.3.cmml" xref="algorithm1.14.10.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.10.m2.1c">g_{s}</annotation></semantics></math> with SGD;
</div>
<div id="algorithm1.16.12" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.15.11.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="algorithm1.15.11.m1.1a"><mi id="algorithm1.15.11.m1.1.1" xref="algorithm1.15.11.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="algorithm1.15.11.m1.1b"><ci id="algorithm1.15.11.m1.1.1.cmml" xref="algorithm1.15.11.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.11.m1.1c">s</annotation></semantics></math> updates local model <math id="algorithm1.16.12.m2.1" class="ltx_Math" alttext="\omega_{t+1}^{s}\leftarrow\omega_{t}^{s}-\eta g_{s}" display="inline"><semantics id="algorithm1.16.12.m2.1a"><mrow id="algorithm1.16.12.m2.1.1" xref="algorithm1.16.12.m2.1.1.cmml"><msubsup id="algorithm1.16.12.m2.1.1.2" xref="algorithm1.16.12.m2.1.1.2.cmml"><mi id="algorithm1.16.12.m2.1.1.2.2.2" xref="algorithm1.16.12.m2.1.1.2.2.2.cmml">ω</mi><mrow id="algorithm1.16.12.m2.1.1.2.2.3" xref="algorithm1.16.12.m2.1.1.2.2.3.cmml"><mi id="algorithm1.16.12.m2.1.1.2.2.3.2" xref="algorithm1.16.12.m2.1.1.2.2.3.2.cmml">t</mi><mo id="algorithm1.16.12.m2.1.1.2.2.3.1" xref="algorithm1.16.12.m2.1.1.2.2.3.1.cmml">+</mo><mn id="algorithm1.16.12.m2.1.1.2.2.3.3" xref="algorithm1.16.12.m2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.16.12.m2.1.1.2.3" xref="algorithm1.16.12.m2.1.1.2.3.cmml">s</mi></msubsup><mo stretchy="false" id="algorithm1.16.12.m2.1.1.1" xref="algorithm1.16.12.m2.1.1.1.cmml">←</mo><mrow id="algorithm1.16.12.m2.1.1.3" xref="algorithm1.16.12.m2.1.1.3.cmml"><msubsup id="algorithm1.16.12.m2.1.1.3.2" xref="algorithm1.16.12.m2.1.1.3.2.cmml"><mi id="algorithm1.16.12.m2.1.1.3.2.2.2" xref="algorithm1.16.12.m2.1.1.3.2.2.2.cmml">ω</mi><mi id="algorithm1.16.12.m2.1.1.3.2.2.3" xref="algorithm1.16.12.m2.1.1.3.2.2.3.cmml">t</mi><mi id="algorithm1.16.12.m2.1.1.3.2.3" xref="algorithm1.16.12.m2.1.1.3.2.3.cmml">s</mi></msubsup><mo id="algorithm1.16.12.m2.1.1.3.1" xref="algorithm1.16.12.m2.1.1.3.1.cmml">−</mo><mrow id="algorithm1.16.12.m2.1.1.3.3" xref="algorithm1.16.12.m2.1.1.3.3.cmml"><mi id="algorithm1.16.12.m2.1.1.3.3.2" xref="algorithm1.16.12.m2.1.1.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="algorithm1.16.12.m2.1.1.3.3.1" xref="algorithm1.16.12.m2.1.1.3.3.1.cmml">​</mo><msub id="algorithm1.16.12.m2.1.1.3.3.3" xref="algorithm1.16.12.m2.1.1.3.3.3.cmml"><mi id="algorithm1.16.12.m2.1.1.3.3.3.2" xref="algorithm1.16.12.m2.1.1.3.3.3.2.cmml">g</mi><mi id="algorithm1.16.12.m2.1.1.3.3.3.3" xref="algorithm1.16.12.m2.1.1.3.3.3.3.cmml">s</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.16.12.m2.1b"><apply id="algorithm1.16.12.m2.1.1.cmml" xref="algorithm1.16.12.m2.1.1"><ci id="algorithm1.16.12.m2.1.1.1.cmml" xref="algorithm1.16.12.m2.1.1.1">←</ci><apply id="algorithm1.16.12.m2.1.1.2.cmml" xref="algorithm1.16.12.m2.1.1.2"><csymbol cd="ambiguous" id="algorithm1.16.12.m2.1.1.2.1.cmml" xref="algorithm1.16.12.m2.1.1.2">superscript</csymbol><apply id="algorithm1.16.12.m2.1.1.2.2.cmml" xref="algorithm1.16.12.m2.1.1.2"><csymbol cd="ambiguous" id="algorithm1.16.12.m2.1.1.2.2.1.cmml" xref="algorithm1.16.12.m2.1.1.2">subscript</csymbol><ci id="algorithm1.16.12.m2.1.1.2.2.2.cmml" xref="algorithm1.16.12.m2.1.1.2.2.2">𝜔</ci><apply id="algorithm1.16.12.m2.1.1.2.2.3.cmml" xref="algorithm1.16.12.m2.1.1.2.2.3"><plus id="algorithm1.16.12.m2.1.1.2.2.3.1.cmml" xref="algorithm1.16.12.m2.1.1.2.2.3.1"></plus><ci id="algorithm1.16.12.m2.1.1.2.2.3.2.cmml" xref="algorithm1.16.12.m2.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.16.12.m2.1.1.2.2.3.3.cmml" xref="algorithm1.16.12.m2.1.1.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.16.12.m2.1.1.2.3.cmml" xref="algorithm1.16.12.m2.1.1.2.3">𝑠</ci></apply><apply id="algorithm1.16.12.m2.1.1.3.cmml" xref="algorithm1.16.12.m2.1.1.3"><minus id="algorithm1.16.12.m2.1.1.3.1.cmml" xref="algorithm1.16.12.m2.1.1.3.1"></minus><apply id="algorithm1.16.12.m2.1.1.3.2.cmml" xref="algorithm1.16.12.m2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.16.12.m2.1.1.3.2.1.cmml" xref="algorithm1.16.12.m2.1.1.3.2">superscript</csymbol><apply id="algorithm1.16.12.m2.1.1.3.2.2.cmml" xref="algorithm1.16.12.m2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.16.12.m2.1.1.3.2.2.1.cmml" xref="algorithm1.16.12.m2.1.1.3.2">subscript</csymbol><ci id="algorithm1.16.12.m2.1.1.3.2.2.2.cmml" xref="algorithm1.16.12.m2.1.1.3.2.2.2">𝜔</ci><ci id="algorithm1.16.12.m2.1.1.3.2.2.3.cmml" xref="algorithm1.16.12.m2.1.1.3.2.2.3">𝑡</ci></apply><ci id="algorithm1.16.12.m2.1.1.3.2.3.cmml" xref="algorithm1.16.12.m2.1.1.3.2.3">𝑠</ci></apply><apply id="algorithm1.16.12.m2.1.1.3.3.cmml" xref="algorithm1.16.12.m2.1.1.3.3"><times id="algorithm1.16.12.m2.1.1.3.3.1.cmml" xref="algorithm1.16.12.m2.1.1.3.3.1"></times><ci id="algorithm1.16.12.m2.1.1.3.3.2.cmml" xref="algorithm1.16.12.m2.1.1.3.3.2">𝜂</ci><apply id="algorithm1.16.12.m2.1.1.3.3.3.cmml" xref="algorithm1.16.12.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.16.12.m2.1.1.3.3.3.1.cmml" xref="algorithm1.16.12.m2.1.1.3.3.3">subscript</csymbol><ci id="algorithm1.16.12.m2.1.1.3.3.3.2.cmml" xref="algorithm1.16.12.m2.1.1.3.3.3.2">𝑔</ci><ci id="algorithm1.16.12.m2.1.1.3.3.3.3.cmml" xref="algorithm1.16.12.m2.1.1.3.3.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.12.m2.1c">\omega_{t+1}^{s}\leftarrow\omega_{t}^{s}-\eta g_{s}</annotation></semantics></math>;
</div>
<div id="algorithm1.17.13" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.17.13.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="algorithm1.17.13.m1.1a"><mi id="algorithm1.17.13.m1.1.1" xref="algorithm1.17.13.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="algorithm1.17.13.m1.1b"><ci id="algorithm1.17.13.m1.1.1.cmml" xref="algorithm1.17.13.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.13.m1.1c">s</annotation></semantics></math> communicates updated model to server;
</div>
<div id="algorithm1.18.16" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.18.17" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end if
</div>
<div id="algorithm1.18.18" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm1.18.19" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.18.14" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   server updates global model using the formula in eq (<a href="#S3.E1" title="In III-B Federated Learning ‣ III System Model ‣ Federated Learning for Water Consumption Forecasting in Smart Cities" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>);
begin the following round <math id="algorithm1.18.14.m1.1" class="ltx_Math" alttext="t\leftarrow t+1" display="inline"><semantics id="algorithm1.18.14.m1.1a"><mrow id="algorithm1.18.14.m1.1.1" xref="algorithm1.18.14.m1.1.1.cmml"><mi id="algorithm1.18.14.m1.1.1.2" xref="algorithm1.18.14.m1.1.1.2.cmml">t</mi><mo stretchy="false" id="algorithm1.18.14.m1.1.1.1" xref="algorithm1.18.14.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.18.14.m1.1.1.3" xref="algorithm1.18.14.m1.1.1.3.cmml"><mi id="algorithm1.18.14.m1.1.1.3.2" xref="algorithm1.18.14.m1.1.1.3.2.cmml">t</mi><mo id="algorithm1.18.14.m1.1.1.3.1" xref="algorithm1.18.14.m1.1.1.3.1.cmml">+</mo><mn id="algorithm1.18.14.m1.1.1.3.3" xref="algorithm1.18.14.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.18.14.m1.1b"><apply id="algorithm1.18.14.m1.1.1.cmml" xref="algorithm1.18.14.m1.1.1"><ci id="algorithm1.18.14.m1.1.1.1.cmml" xref="algorithm1.18.14.m1.1.1.1">←</ci><ci id="algorithm1.18.14.m1.1.1.2.cmml" xref="algorithm1.18.14.m1.1.1.2">𝑡</ci><apply id="algorithm1.18.14.m1.1.1.3.cmml" xref="algorithm1.18.14.m1.1.1.3"><plus id="algorithm1.18.14.m1.1.1.3.1.cmml" xref="algorithm1.18.14.m1.1.1.3.1"></plus><ci id="algorithm1.18.14.m1.1.1.3.2.cmml" xref="algorithm1.18.14.m1.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.18.14.m1.1.1.3.3.cmml" xref="algorithm1.18.14.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.14.m1.1c">t\leftarrow t+1</annotation></semantics></math>.

</div>
<div id="algorithm1.18.20" class="ltx_listingline"> end while
</div>
<div id="algorithm1.18.21" class="ltx_listingline">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.20.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Federated Averaging Algorithm. <math id="algorithm1.3.m1.1" class="ltx_Math" alttext="t_{max}" display="inline"><semantics id="algorithm1.3.m1.1b"><msub id="algorithm1.3.m1.1.1" xref="algorithm1.3.m1.1.1.cmml"><mi id="algorithm1.3.m1.1.1.2" xref="algorithm1.3.m1.1.1.2.cmml">t</mi><mrow id="algorithm1.3.m1.1.1.3" xref="algorithm1.3.m1.1.1.3.cmml"><mi id="algorithm1.3.m1.1.1.3.2" xref="algorithm1.3.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.m1.1.1.3.1" xref="algorithm1.3.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.3.m1.1.1.3.3" xref="algorithm1.3.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.3.m1.1.1.3.1b" xref="algorithm1.3.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.3.m1.1.1.3.4" xref="algorithm1.3.m1.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.3.m1.1c"><apply id="algorithm1.3.m1.1.1.cmml" xref="algorithm1.3.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.3.m1.1.1.1.cmml" xref="algorithm1.3.m1.1.1">subscript</csymbol><ci id="algorithm1.3.m1.1.1.2.cmml" xref="algorithm1.3.m1.1.1.2">𝑡</ci><apply id="algorithm1.3.m1.1.1.3.cmml" xref="algorithm1.3.m1.1.1.3"><times id="algorithm1.3.m1.1.1.3.1.cmml" xref="algorithm1.3.m1.1.1.3.1"></times><ci id="algorithm1.3.m1.1.1.3.2.cmml" xref="algorithm1.3.m1.1.1.3.2">𝑚</ci><ci id="algorithm1.3.m1.1.1.3.3.cmml" xref="algorithm1.3.m1.1.1.3.3">𝑎</ci><ci id="algorithm1.3.m1.1.1.3.4.cmml" xref="algorithm1.3.m1.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.m1.1d">t_{max}</annotation></semantics></math> is the maximum number of rounds and <math id="algorithm1.4.m2.1" class="ltx_Math" alttext="M=\sum_{s}m_{s}" display="inline"><semantics id="algorithm1.4.m2.1b"><mrow id="algorithm1.4.m2.1.1" xref="algorithm1.4.m2.1.1.cmml"><mi id="algorithm1.4.m2.1.1.2" xref="algorithm1.4.m2.1.1.2.cmml">M</mi><mo rspace="0.111em" id="algorithm1.4.m2.1.1.1" xref="algorithm1.4.m2.1.1.1.cmml">=</mo><mrow id="algorithm1.4.m2.1.1.3" xref="algorithm1.4.m2.1.1.3.cmml"><msub id="algorithm1.4.m2.1.1.3.1" xref="algorithm1.4.m2.1.1.3.1.cmml"><mo id="algorithm1.4.m2.1.1.3.1.2" xref="algorithm1.4.m2.1.1.3.1.2.cmml">∑</mo><mi id="algorithm1.4.m2.1.1.3.1.3" xref="algorithm1.4.m2.1.1.3.1.3.cmml">s</mi></msub><msub id="algorithm1.4.m2.1.1.3.2" xref="algorithm1.4.m2.1.1.3.2.cmml"><mi id="algorithm1.4.m2.1.1.3.2.2" xref="algorithm1.4.m2.1.1.3.2.2.cmml">m</mi><mi id="algorithm1.4.m2.1.1.3.2.3" xref="algorithm1.4.m2.1.1.3.2.3.cmml">s</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.m2.1c"><apply id="algorithm1.4.m2.1.1.cmml" xref="algorithm1.4.m2.1.1"><eq id="algorithm1.4.m2.1.1.1.cmml" xref="algorithm1.4.m2.1.1.1"></eq><ci id="algorithm1.4.m2.1.1.2.cmml" xref="algorithm1.4.m2.1.1.2">𝑀</ci><apply id="algorithm1.4.m2.1.1.3.cmml" xref="algorithm1.4.m2.1.1.3"><apply id="algorithm1.4.m2.1.1.3.1.cmml" xref="algorithm1.4.m2.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.4.m2.1.1.3.1.1.cmml" xref="algorithm1.4.m2.1.1.3.1">subscript</csymbol><sum id="algorithm1.4.m2.1.1.3.1.2.cmml" xref="algorithm1.4.m2.1.1.3.1.2"></sum><ci id="algorithm1.4.m2.1.1.3.1.3.cmml" xref="algorithm1.4.m2.1.1.3.1.3">𝑠</ci></apply><apply id="algorithm1.4.m2.1.1.3.2.cmml" xref="algorithm1.4.m2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.4.m2.1.1.3.2.1.cmml" xref="algorithm1.4.m2.1.1.3.2">subscript</csymbol><ci id="algorithm1.4.m2.1.1.3.2.2.cmml" xref="algorithm1.4.m2.1.1.3.2.2">𝑚</ci><ci id="algorithm1.4.m2.1.1.3.2.3.cmml" xref="algorithm1.4.m2.1.1.3.2.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.m2.1d">M=\sum_{s}m_{s}</annotation></semantics></math>. </figcaption>
</figure>
<div id="S3.SS2.p2" class="ltx_para">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\omega_{t+1}=\sum_{s=0}^{S}\frac{m_{s}}{M}\omega_{t+1}^{s}" display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><msub id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.2.2" xref="S3.E1.m1.1.1.2.2.cmml">ω</mi><mrow id="S3.E1.m1.1.1.2.3" xref="S3.E1.m1.1.1.2.3.cmml"><mi id="S3.E1.m1.1.1.2.3.2" xref="S3.E1.m1.1.1.2.3.2.cmml">t</mi><mo id="S3.E1.m1.1.1.2.3.1" xref="S3.E1.m1.1.1.2.3.1.cmml">+</mo><mn id="S3.E1.m1.1.1.2.3.3" xref="S3.E1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><munderover id="S3.E1.m1.1.1.3.1" xref="S3.E1.m1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.1.1.3.1.2.2" xref="S3.E1.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.3.1.2.3" xref="S3.E1.m1.1.1.3.1.2.3.cmml"><mi id="S3.E1.m1.1.1.3.1.2.3.2" xref="S3.E1.m1.1.1.3.1.2.3.2.cmml">s</mi><mo id="S3.E1.m1.1.1.3.1.2.3.1" xref="S3.E1.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.3.1.2.3.3" xref="S3.E1.m1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mi id="S3.E1.m1.1.1.3.1.3" xref="S3.E1.m1.1.1.3.1.3.cmml">S</mi></munderover><mrow id="S3.E1.m1.1.1.3.2" xref="S3.E1.m1.1.1.3.2.cmml"><mfrac id="S3.E1.m1.1.1.3.2.2" xref="S3.E1.m1.1.1.3.2.2.cmml"><msub id="S3.E1.m1.1.1.3.2.2.2" xref="S3.E1.m1.1.1.3.2.2.2.cmml"><mi id="S3.E1.m1.1.1.3.2.2.2.2" xref="S3.E1.m1.1.1.3.2.2.2.2.cmml">m</mi><mi id="S3.E1.m1.1.1.3.2.2.2.3" xref="S3.E1.m1.1.1.3.2.2.2.3.cmml">s</mi></msub><mi id="S3.E1.m1.1.1.3.2.2.3" xref="S3.E1.m1.1.1.3.2.2.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.3.2.1" xref="S3.E1.m1.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E1.m1.1.1.3.2.3" xref="S3.E1.m1.1.1.3.2.3.cmml"><mi id="S3.E1.m1.1.1.3.2.3.2.2" xref="S3.E1.m1.1.1.3.2.3.2.2.cmml">ω</mi><mrow id="S3.E1.m1.1.1.3.2.3.2.3" xref="S3.E1.m1.1.1.3.2.3.2.3.cmml"><mi id="S3.E1.m1.1.1.3.2.3.2.3.2" xref="S3.E1.m1.1.1.3.2.3.2.3.2.cmml">t</mi><mo id="S3.E1.m1.1.1.3.2.3.2.3.1" xref="S3.E1.m1.1.1.3.2.3.2.3.1.cmml">+</mo><mn id="S3.E1.m1.1.1.3.2.3.2.3.3" xref="S3.E1.m1.1.1.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.3.2.3.3" xref="S3.E1.m1.1.1.3.2.3.3.cmml">s</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><eq id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"></eq><apply id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.2.2">𝜔</ci><apply id="S3.E1.m1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.2.3"><plus id="S3.E1.m1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.2.3.1"></plus><ci id="S3.E1.m1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.1.1.2.3.3.cmml" xref="S3.E1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><apply id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.1.1.cmml" xref="S3.E1.m1.1.1.3.1">superscript</csymbol><apply id="S3.E1.m1.1.1.3.1.2.cmml" xref="S3.E1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.1.2.1.cmml" xref="S3.E1.m1.1.1.3.1">subscript</csymbol><sum id="S3.E1.m1.1.1.3.1.2.2.cmml" xref="S3.E1.m1.1.1.3.1.2.2"></sum><apply id="S3.E1.m1.1.1.3.1.2.3.cmml" xref="S3.E1.m1.1.1.3.1.2.3"><eq id="S3.E1.m1.1.1.3.1.2.3.1.cmml" xref="S3.E1.m1.1.1.3.1.2.3.1"></eq><ci id="S3.E1.m1.1.1.3.1.2.3.2.cmml" xref="S3.E1.m1.1.1.3.1.2.3.2">𝑠</ci><cn type="integer" id="S3.E1.m1.1.1.3.1.2.3.3.cmml" xref="S3.E1.m1.1.1.3.1.2.3.3">0</cn></apply></apply><ci id="S3.E1.m1.1.1.3.1.3.cmml" xref="S3.E1.m1.1.1.3.1.3">𝑆</ci></apply><apply id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3.2"><times id="S3.E1.m1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.3.2.1"></times><apply id="S3.E1.m1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.3.2.2"><divide id="S3.E1.m1.1.1.3.2.2.1.cmml" xref="S3.E1.m1.1.1.3.2.2"></divide><apply id="S3.E1.m1.1.1.3.2.2.2.cmml" xref="S3.E1.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.2.2.2.1.cmml" xref="S3.E1.m1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.2.2.2.cmml" xref="S3.E1.m1.1.1.3.2.2.2.2">𝑚</ci><ci id="S3.E1.m1.1.1.3.2.2.2.3.cmml" xref="S3.E1.m1.1.1.3.2.2.2.3">𝑠</ci></apply><ci id="S3.E1.m1.1.1.3.2.2.3.cmml" xref="S3.E1.m1.1.1.3.2.2.3">𝑀</ci></apply><apply id="S3.E1.m1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.2.3.1.cmml" xref="S3.E1.m1.1.1.3.2.3">superscript</csymbol><apply id="S3.E1.m1.1.1.3.2.3.2.cmml" xref="S3.E1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.2.3.2.1.cmml" xref="S3.E1.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.3.2.2.cmml" xref="S3.E1.m1.1.1.3.2.3.2.2">𝜔</ci><apply id="S3.E1.m1.1.1.3.2.3.2.3.cmml" xref="S3.E1.m1.1.1.3.2.3.2.3"><plus id="S3.E1.m1.1.1.3.2.3.2.3.1.cmml" xref="S3.E1.m1.1.1.3.2.3.2.3.1"></plus><ci id="S3.E1.m1.1.1.3.2.3.2.3.2.cmml" xref="S3.E1.m1.1.1.3.2.3.2.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.1.1.3.2.3.2.3.3.cmml" xref="S3.E1.m1.1.1.3.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.3.2.3.3.cmml" xref="S3.E1.m1.1.1.3.2.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\omega_{t+1}=\sum_{s=0}^{S}\frac{m_{s}}{M}\omega_{t+1}^{s}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2301.13036/assets/x1.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="201" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The distribution of water consumption data in building 04 (BLD 04).
<br class="ltx_break"><span id="S3.F2.2.1" class="ltx_text ltx_font_italic"> (HCF; Hundred-Cubic Foot)</span></figcaption>
</figure>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">The centralized strategy might not, however, account for every user’s water consumption. Personalization is one suggestion for resolving this issue. Many applications, which call for analyzing and responding to user behavior, are focused on personalization. To create a customized model for each user, the centralized model is retrained using user-specific data. This can be accomplished by retraining the model locally over a limited number of epochs using only the customer’s data.
<br class="ltx_break">Since user identities are still at risk and can be ascertained through reverse engineering, federated learning poses less of a privacy threat than centralized server storage. Weight changes are processed in memory and are deleted after aggregation, whereas model updates received by each client are transient and never retained on the server. Individual weight uploads must not be reviewed or assessed according to the federated learning approach. Because the network and server cannot be trusted with precise user data, this is nevertheless more secure than server training. For billing purposes, some data must still be supplied in an aggregated form, but these data are not particularly revealing.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.4.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.5.2" class="ltx_text ltx_font_italic">Reward in the network load</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.7" class="ltx_p">First, we establish the network load <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="Q_{C}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">Q</mi><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑄</ci><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">Q_{C}</annotation></semantics></math> for a server in centralized training in Eq. 1 and the network load in FL <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="Q_{F}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">Q</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑄</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">Q_{F}</annotation></semantics></math> in Eq. 2, in order to compare the reward in network load in FL to centralized training. 
<br class="ltx_break"><math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="\ell_{G}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">ℓ</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">ℓ</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\ell_{G}</annotation></semantics></math> is the length of the global model, and <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="\ell_{s}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">ℓ</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">ℓ</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\ell_{s}</annotation></semantics></math> is the length of the data that the client <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">s</annotation></semantics></math> supplied. The number of hops between client <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">s</annotation></semantics></math> and the server in the centralized training is denoted by <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="h_{s}" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><msub id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2" xref="S3.SS3.p1.7.m7.1.1.2.cmml">h</mi><mi id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2">ℎ</ci><ci id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">h_{s}</annotation></semantics></math>.</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="Q_{C}=\sum_{s=1}^{M}\ell_{s}\times h_{s}" display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><msub id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml"><mi id="S3.E2.m1.1.1.2.2" xref="S3.E2.m1.1.1.2.2.cmml">Q</mi><mi id="S3.E2.m1.1.1.2.3" xref="S3.E2.m1.1.1.2.3.cmml">C</mi></msub><mo rspace="0.111em" id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml"><munderover id="S3.E2.m1.1.1.3.1" xref="S3.E2.m1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.1.1.3.1.2.2" xref="S3.E2.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.3.1.2.3" xref="S3.E2.m1.1.1.3.1.2.3.cmml"><mi id="S3.E2.m1.1.1.3.1.2.3.2" xref="S3.E2.m1.1.1.3.1.2.3.2.cmml">s</mi><mo id="S3.E2.m1.1.1.3.1.2.3.1" xref="S3.E2.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.1.1.3.1.2.3.3" xref="S3.E2.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.1.1.3.1.3" xref="S3.E2.m1.1.1.3.1.3.cmml">M</mi></munderover><mrow id="S3.E2.m1.1.1.3.2" xref="S3.E2.m1.1.1.3.2.cmml"><msub id="S3.E2.m1.1.1.3.2.2" xref="S3.E2.m1.1.1.3.2.2.cmml"><mi mathvariant="normal" id="S3.E2.m1.1.1.3.2.2.2" xref="S3.E2.m1.1.1.3.2.2.2.cmml">ℓ</mi><mi id="S3.E2.m1.1.1.3.2.2.3" xref="S3.E2.m1.1.1.3.2.2.3.cmml">s</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.1.1.3.2.1" xref="S3.E2.m1.1.1.3.2.1.cmml">×</mo><msub id="S3.E2.m1.1.1.3.2.3" xref="S3.E2.m1.1.1.3.2.3.cmml"><mi id="S3.E2.m1.1.1.3.2.3.2" xref="S3.E2.m1.1.1.3.2.3.2.cmml">h</mi><mi id="S3.E2.m1.1.1.3.2.3.3" xref="S3.E2.m1.1.1.3.2.3.3.cmml">s</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><eq id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"></eq><apply id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.2.2">𝑄</ci><ci id="S3.E2.m1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.2.3">𝐶</ci></apply><apply id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"><apply id="S3.E2.m1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.1.1.cmml" xref="S3.E2.m1.1.1.3.1">superscript</csymbol><apply id="S3.E2.m1.1.1.3.1.2.cmml" xref="S3.E2.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.1.2.1.cmml" xref="S3.E2.m1.1.1.3.1">subscript</csymbol><sum id="S3.E2.m1.1.1.3.1.2.2.cmml" xref="S3.E2.m1.1.1.3.1.2.2"></sum><apply id="S3.E2.m1.1.1.3.1.2.3.cmml" xref="S3.E2.m1.1.1.3.1.2.3"><eq id="S3.E2.m1.1.1.3.1.2.3.1.cmml" xref="S3.E2.m1.1.1.3.1.2.3.1"></eq><ci id="S3.E2.m1.1.1.3.1.2.3.2.cmml" xref="S3.E2.m1.1.1.3.1.2.3.2">𝑠</ci><cn type="integer" id="S3.E2.m1.1.1.3.1.2.3.3.cmml" xref="S3.E2.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.1.3.1.3.cmml" xref="S3.E2.m1.1.1.3.1.3">𝑀</ci></apply><apply id="S3.E2.m1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.3.2"><times id="S3.E2.m1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.3.2.1"></times><apply id="S3.E2.m1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.2.2.1.cmml" xref="S3.E2.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.3.2.2.2.cmml" xref="S3.E2.m1.1.1.3.2.2.2">ℓ</ci><ci id="S3.E2.m1.1.1.3.2.2.3.cmml" xref="S3.E2.m1.1.1.3.2.2.3">𝑠</ci></apply><apply id="S3.E2.m1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.2.3.1.cmml" xref="S3.E2.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E2.m1.1.1.3.2.3.2.cmml" xref="S3.E2.m1.1.1.3.2.3.2">ℎ</ci><ci id="S3.E2.m1.1.1.3.2.3.3.cmml" xref="S3.E2.m1.1.1.3.2.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">Q_{C}=\sum_{s=1}^{M}\ell_{s}\times h_{s}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.12" class="ltx_p">and</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.2" class="ltx_Math" alttext="Q_{F}=\ell_{G}\times\sum_{t=1}^{t_{max}}\sum_{s=1}^{S}h_{s,t}" display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.3" xref="S3.E3.m1.2.3.cmml"><msub id="S3.E3.m1.2.3.2" xref="S3.E3.m1.2.3.2.cmml"><mi id="S3.E3.m1.2.3.2.2" xref="S3.E3.m1.2.3.2.2.cmml">Q</mi><mi id="S3.E3.m1.2.3.2.3" xref="S3.E3.m1.2.3.2.3.cmml">F</mi></msub><mo id="S3.E3.m1.2.3.1" xref="S3.E3.m1.2.3.1.cmml">=</mo><mrow id="S3.E3.m1.2.3.3" xref="S3.E3.m1.2.3.3.cmml"><msub id="S3.E3.m1.2.3.3.2" xref="S3.E3.m1.2.3.3.2.cmml"><mi mathvariant="normal" id="S3.E3.m1.2.3.3.2.2" xref="S3.E3.m1.2.3.3.2.2.cmml">ℓ</mi><mi id="S3.E3.m1.2.3.3.2.3" xref="S3.E3.m1.2.3.3.2.3.cmml">G</mi></msub><mo lspace="0.222em" rspace="0.055em" id="S3.E3.m1.2.3.3.1" xref="S3.E3.m1.2.3.3.1.cmml">×</mo><mrow id="S3.E3.m1.2.3.3.3" xref="S3.E3.m1.2.3.3.3.cmml"><munderover id="S3.E3.m1.2.3.3.3.1" xref="S3.E3.m1.2.3.3.3.1.cmml"><mo movablelimits="false" rspace="0em" id="S3.E3.m1.2.3.3.3.1.2.2" xref="S3.E3.m1.2.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.2.3.3.3.1.2.3" xref="S3.E3.m1.2.3.3.3.1.2.3.cmml"><mi id="S3.E3.m1.2.3.3.3.1.2.3.2" xref="S3.E3.m1.2.3.3.3.1.2.3.2.cmml">t</mi><mo id="S3.E3.m1.2.3.3.3.1.2.3.1" xref="S3.E3.m1.2.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.2.3.3.3.1.2.3.3" xref="S3.E3.m1.2.3.3.3.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E3.m1.2.3.3.3.1.3" xref="S3.E3.m1.2.3.3.3.1.3.cmml"><mi id="S3.E3.m1.2.3.3.3.1.3.2" xref="S3.E3.m1.2.3.3.3.1.3.2.cmml">t</mi><mrow id="S3.E3.m1.2.3.3.3.1.3.3" xref="S3.E3.m1.2.3.3.3.1.3.3.cmml"><mi id="S3.E3.m1.2.3.3.3.1.3.3.2" xref="S3.E3.m1.2.3.3.3.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.3.3.1.3.3.1" xref="S3.E3.m1.2.3.3.3.1.3.3.1.cmml">​</mo><mi id="S3.E3.m1.2.3.3.3.1.3.3.3" xref="S3.E3.m1.2.3.3.3.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.3.3.1.3.3.1a" xref="S3.E3.m1.2.3.3.3.1.3.3.1.cmml">​</mo><mi id="S3.E3.m1.2.3.3.3.1.3.3.4" xref="S3.E3.m1.2.3.3.3.1.3.3.4.cmml">x</mi></mrow></msub></munderover><mrow id="S3.E3.m1.2.3.3.3.2" xref="S3.E3.m1.2.3.3.3.2.cmml"><munderover id="S3.E3.m1.2.3.3.3.2.1" xref="S3.E3.m1.2.3.3.3.2.1.cmml"><mo movablelimits="false" id="S3.E3.m1.2.3.3.3.2.1.2.2" xref="S3.E3.m1.2.3.3.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.2.3.3.3.2.1.2.3" xref="S3.E3.m1.2.3.3.3.2.1.2.3.cmml"><mi id="S3.E3.m1.2.3.3.3.2.1.2.3.2" xref="S3.E3.m1.2.3.3.3.2.1.2.3.2.cmml">s</mi><mo id="S3.E3.m1.2.3.3.3.2.1.2.3.1" xref="S3.E3.m1.2.3.3.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.2.3.3.3.2.1.2.3.3" xref="S3.E3.m1.2.3.3.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.2.3.3.3.2.1.3" xref="S3.E3.m1.2.3.3.3.2.1.3.cmml">S</mi></munderover><msub id="S3.E3.m1.2.3.3.3.2.2" xref="S3.E3.m1.2.3.3.3.2.2.cmml"><mi id="S3.E3.m1.2.3.3.3.2.2.2" xref="S3.E3.m1.2.3.3.3.2.2.2.cmml">h</mi><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">s</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">t</mi></mrow></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.3.cmml" xref="S3.E3.m1.2.3"><eq id="S3.E3.m1.2.3.1.cmml" xref="S3.E3.m1.2.3.1"></eq><apply id="S3.E3.m1.2.3.2.cmml" xref="S3.E3.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.2.1.cmml" xref="S3.E3.m1.2.3.2">subscript</csymbol><ci id="S3.E3.m1.2.3.2.2.cmml" xref="S3.E3.m1.2.3.2.2">𝑄</ci><ci id="S3.E3.m1.2.3.2.3.cmml" xref="S3.E3.m1.2.3.2.3">𝐹</ci></apply><apply id="S3.E3.m1.2.3.3.cmml" xref="S3.E3.m1.2.3.3"><times id="S3.E3.m1.2.3.3.1.cmml" xref="S3.E3.m1.2.3.3.1"></times><apply id="S3.E3.m1.2.3.3.2.cmml" xref="S3.E3.m1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.2.1.cmml" xref="S3.E3.m1.2.3.3.2">subscript</csymbol><ci id="S3.E3.m1.2.3.3.2.2.cmml" xref="S3.E3.m1.2.3.3.2.2">ℓ</ci><ci id="S3.E3.m1.2.3.3.2.3.cmml" xref="S3.E3.m1.2.3.3.2.3">𝐺</ci></apply><apply id="S3.E3.m1.2.3.3.3.cmml" xref="S3.E3.m1.2.3.3.3"><apply id="S3.E3.m1.2.3.3.3.1.cmml" xref="S3.E3.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.3.1.1.cmml" xref="S3.E3.m1.2.3.3.3.1">superscript</csymbol><apply id="S3.E3.m1.2.3.3.3.1.2.cmml" xref="S3.E3.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.3.1.2.1.cmml" xref="S3.E3.m1.2.3.3.3.1">subscript</csymbol><sum id="S3.E3.m1.2.3.3.3.1.2.2.cmml" xref="S3.E3.m1.2.3.3.3.1.2.2"></sum><apply id="S3.E3.m1.2.3.3.3.1.2.3.cmml" xref="S3.E3.m1.2.3.3.3.1.2.3"><eq id="S3.E3.m1.2.3.3.3.1.2.3.1.cmml" xref="S3.E3.m1.2.3.3.3.1.2.3.1"></eq><ci id="S3.E3.m1.2.3.3.3.1.2.3.2.cmml" xref="S3.E3.m1.2.3.3.3.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E3.m1.2.3.3.3.1.2.3.3.cmml" xref="S3.E3.m1.2.3.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.2.3.3.3.1.3.cmml" xref="S3.E3.m1.2.3.3.3.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.3.1.3.1.cmml" xref="S3.E3.m1.2.3.3.3.1.3">subscript</csymbol><ci id="S3.E3.m1.2.3.3.3.1.3.2.cmml" xref="S3.E3.m1.2.3.3.3.1.3.2">𝑡</ci><apply id="S3.E3.m1.2.3.3.3.1.3.3.cmml" xref="S3.E3.m1.2.3.3.3.1.3.3"><times id="S3.E3.m1.2.3.3.3.1.3.3.1.cmml" xref="S3.E3.m1.2.3.3.3.1.3.3.1"></times><ci id="S3.E3.m1.2.3.3.3.1.3.3.2.cmml" xref="S3.E3.m1.2.3.3.3.1.3.3.2">𝑚</ci><ci id="S3.E3.m1.2.3.3.3.1.3.3.3.cmml" xref="S3.E3.m1.2.3.3.3.1.3.3.3">𝑎</ci><ci id="S3.E3.m1.2.3.3.3.1.3.3.4.cmml" xref="S3.E3.m1.2.3.3.3.1.3.3.4">𝑥</ci></apply></apply></apply><apply id="S3.E3.m1.2.3.3.3.2.cmml" xref="S3.E3.m1.2.3.3.3.2"><apply id="S3.E3.m1.2.3.3.3.2.1.cmml" xref="S3.E3.m1.2.3.3.3.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.3.2.1.1.cmml" xref="S3.E3.m1.2.3.3.3.2.1">superscript</csymbol><apply id="S3.E3.m1.2.3.3.3.2.1.2.cmml" xref="S3.E3.m1.2.3.3.3.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.3.2.1.2.1.cmml" xref="S3.E3.m1.2.3.3.3.2.1">subscript</csymbol><sum id="S3.E3.m1.2.3.3.3.2.1.2.2.cmml" xref="S3.E3.m1.2.3.3.3.2.1.2.2"></sum><apply id="S3.E3.m1.2.3.3.3.2.1.2.3.cmml" xref="S3.E3.m1.2.3.3.3.2.1.2.3"><eq id="S3.E3.m1.2.3.3.3.2.1.2.3.1.cmml" xref="S3.E3.m1.2.3.3.3.2.1.2.3.1"></eq><ci id="S3.E3.m1.2.3.3.3.2.1.2.3.2.cmml" xref="S3.E3.m1.2.3.3.3.2.1.2.3.2">𝑠</ci><cn type="integer" id="S3.E3.m1.2.3.3.3.2.1.2.3.3.cmml" xref="S3.E3.m1.2.3.3.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.2.3.3.3.2.1.3.cmml" xref="S3.E3.m1.2.3.3.3.2.1.3">𝑆</ci></apply><apply id="S3.E3.m1.2.3.3.3.2.2.cmml" xref="S3.E3.m1.2.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.3.2.2.1.cmml" xref="S3.E3.m1.2.3.3.3.2.2">subscript</csymbol><ci id="S3.E3.m1.2.3.3.3.2.2.2.cmml" xref="S3.E3.m1.2.3.3.3.2.2.2">ℎ</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑠</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑡</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">Q_{F}=\ell_{G}\times\sum_{t=1}^{t_{max}}\sum_{s=1}^{S}h_{s,t}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.11" class="ltx_p">where <math id="S3.SS3.p1.8.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS3.p1.8.m1.1a"><mi id="S3.SS3.p1.8.m1.1.1" xref="S3.SS3.p1.8.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m1.1b"><ci id="S3.SS3.p1.8.m1.1.1.cmml" xref="S3.SS3.p1.8.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m1.1c">S</annotation></semantics></math> is the total number of users in each batch, and <math id="S3.SS3.p1.9.m2.2" class="ltx_Math" alttext="h_{s,t}" display="inline"><semantics id="S3.SS3.p1.9.m2.2a"><msub id="S3.SS3.p1.9.m2.2.3" xref="S3.SS3.p1.9.m2.2.3.cmml"><mi id="S3.SS3.p1.9.m2.2.3.2" xref="S3.SS3.p1.9.m2.2.3.2.cmml">h</mi><mrow id="S3.SS3.p1.9.m2.2.2.2.4" xref="S3.SS3.p1.9.m2.2.2.2.3.cmml"><mi id="S3.SS3.p1.9.m2.1.1.1.1" xref="S3.SS3.p1.9.m2.1.1.1.1.cmml">s</mi><mo id="S3.SS3.p1.9.m2.2.2.2.4.1" xref="S3.SS3.p1.9.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.9.m2.2.2.2.2" xref="S3.SS3.p1.9.m2.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m2.2b"><apply id="S3.SS3.p1.9.m2.2.3.cmml" xref="S3.SS3.p1.9.m2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m2.2.3.1.cmml" xref="S3.SS3.p1.9.m2.2.3">subscript</csymbol><ci id="S3.SS3.p1.9.m2.2.3.2.cmml" xref="S3.SS3.p1.9.m2.2.3.2">ℎ</ci><list id="S3.SS3.p1.9.m2.2.2.2.3.cmml" xref="S3.SS3.p1.9.m2.2.2.2.4"><ci id="S3.SS3.p1.9.m2.1.1.1.1.cmml" xref="S3.SS3.p1.9.m2.1.1.1.1">𝑠</ci><ci id="S3.SS3.p1.9.m2.2.2.2.2.cmml" xref="S3.SS3.p1.9.m2.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m2.2c">h_{s,t}</annotation></semantics></math> is the number of hops between the client <math id="S3.SS3.p1.10.m3.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS3.p1.10.m3.1a"><mi id="S3.SS3.p1.10.m3.1.1" xref="S3.SS3.p1.10.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m3.1b"><ci id="S3.SS3.p1.10.m3.1.1.cmml" xref="S3.SS3.p1.10.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m3.1c">s</annotation></semantics></math> chosen in round <math id="S3.SS3.p1.11.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p1.11.m4.1a"><mi id="S3.SS3.p1.11.m4.1.1" xref="S3.SS3.p1.11.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m4.1b"><ci id="S3.SS3.p1.11.m4.1.1.cmml" xref="S3.SS3.p1.11.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m4.1c">t</annotation></semantics></math> and the server. 
<br class="ltx_break">We define the reward in networking load using Eq.1 and Eq.2, as follows:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="R=1-\frac{Q_{F}}{Q_{C}}" display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mi id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml">R</mi><mo id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><mn id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml">1</mn><mo id="S3.E4.m1.1.1.3.1" xref="S3.E4.m1.1.1.3.1.cmml">−</mo><mfrac id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml"><msub id="S3.E4.m1.1.1.3.3.2" xref="S3.E4.m1.1.1.3.3.2.cmml"><mi id="S3.E4.m1.1.1.3.3.2.2" xref="S3.E4.m1.1.1.3.3.2.2.cmml">Q</mi><mi id="S3.E4.m1.1.1.3.3.2.3" xref="S3.E4.m1.1.1.3.3.2.3.cmml">F</mi></msub><msub id="S3.E4.m1.1.1.3.3.3" xref="S3.E4.m1.1.1.3.3.3.cmml"><mi id="S3.E4.m1.1.1.3.3.3.2" xref="S3.E4.m1.1.1.3.3.3.2.cmml">Q</mi><mi id="S3.E4.m1.1.1.3.3.3.3" xref="S3.E4.m1.1.1.3.3.3.3.cmml">C</mi></msub></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><eq id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"></eq><ci id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2">𝑅</ci><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><minus id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3.1"></minus><cn type="integer" id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2">1</cn><apply id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3"><divide id="S3.E4.m1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3"></divide><apply id="S3.E4.m1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.2.1.cmml" xref="S3.E4.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.3.3.2.2.cmml" xref="S3.E4.m1.1.1.3.3.2.2">𝑄</ci><ci id="S3.E4.m1.1.1.3.3.2.3.cmml" xref="S3.E4.m1.1.1.3.3.2.3">𝐹</ci></apply><apply id="S3.E4.m1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E4.m1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2">𝑄</ci><ci id="S3.E4.m1.1.1.3.3.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">R=1-\frac{Q_{F}}{Q_{C}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<br class="ltx_break">
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Simulation and Results</span>
</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.4.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.5.2" class="ltx_text ltx_font_italic">Dataset Pre-Processing</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">This study made use of data from the Kaggle website. Data about New York’s water consumption and costs include Consumption and expense data broken down by borough and development monthly. Utility vendor and meter information is included in the data set. For over 300 buildings in the New York city, New York Water data provides water consumption and cost statistics at ”monthly” intervals between 2013 and 2020.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.4.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.5.2" class="ltx_text ltx_font_italic">Numerical Results</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">For deep learning models to perform the best in forecasting, hyper-parameter adjustment is crucial. However, we only evaluate the federated learning approach in this paper.
<br class="ltx_break">This section examines how personalization affects the efficiency of the models. First, we examine if localizing the model’s training for the participating clients improves outcomes.
<br class="ltx_break"></p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">We chose a client (building; BLD 04) randomly from the sample of participants to show how personalization can improve predictions. The distribution of water consumption data in building 04 (BLD 04) between 2013 and 2020 is given as shown in Figure 2.
<br class="ltx_break">We have used the matching personalized models as well as the global model. Figure 3 illustrates the actual and anticipated consumption profiles between 2018 and 2020.
<br class="ltx_break"></p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2301.13036/assets/x2.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="201" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>predictions for the client’s (BLD 04) consumption for the following month for those who took part in training the global model.
<br class="ltx_break"><span id="S4.F3.2.1" class="ltx_text ltx_font_italic">(HCF; Hundred-Cubic Foot)</span></figcaption>
</figure>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">Using just a portion of the users that make up the population, we come to the conclusion that it is possible to train robust models for the consumption profiles of that population. Retraining the model can produce a customized model that better follows the profile’s characteristics and produces predictions with higher accuracy for applications with high accuracy needs. Even said, for brand-new customers lacking sufficient data for customisation, the predictions made using the global model can be a useful starting point.
<br class="ltx_break">The edge devices ability to provide local training is a necessity for the suggested approach’s feasibility. The performance of new IoT devices will very certainly be compromised by training a neural network, even though they have the CPU power to execute complex machine learning models.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Given the stochastic nature of consumption profiles, projecting individual short-term loads is a difficult challenge. For the purpose of short-term load forecasting in smart cities, we proposed a system model in this research that uses federated learning to address issues with privacy and data diversity. Contrary to centralized techniques, federated learning in the proposed system trains models on edge devices, limiting security concerns to those specific to the device. We ran tests to assess how well centralized and customized models performed in federated contexts.
The simulation results show that it is a promising approach for developing high-performing models with a significantly reduced networking load than a centralised model, while preserving the privacy of consumption data. 
<br class="ltx_break"></p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
A. Tak and S. Cherkaoui, “Federated edge learning: Design issues and
challenges,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">IEEE Network</em>, vol. 35, no. 2, pp. 252–258, 2021.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
A. Taïk and S. Cherkaoui, “Electrical load forecasting using edge computing
and federated learning,” in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE International Conference on
Communications (ICC)</em>, 2020, pp. 1–6.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
A. Taik <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Empowering prosumer communities in smart grid with
wireless communications and federated edge learning,” <em id="bib.bib3.2.2" class="ltx_emph ltx_font_italic">IEEE Wireless
Communications</em>, vol. 28, no. 6, pp. 26–33, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
E. Imaie, S. Abdolreza, and R. A. Ahangar, “Improving short-term wind power
prediction with neural network and ica algorithm and input feature
selection,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Journal of Advances in Computer Research</em>, vol. 5, no. 3,
pp. 13–34, 2014.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Y. Rongxin, K. Emre C., L. Yaping, D. Nicholas, and W. Ke, “Quantifying
flexibility of commercial and residential loads for demand response using
setpoint changes,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Applied Energy</em>, vol. 177, pp. 149–169, 2016.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
L. Weixian, L. Thillainathan, P. Van-Tung, and W. Wai Lok, “Implemented
iot-based self-learning home management system (shms) for singapore,”
<em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">IEEE Internet Of Things Journal</em>, vol. 5, no. 3, pp. 2212–2220, 2018.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
A. Abouaomar, A. Taik, A. Filali, and S. Cherkaoui, “Federated deep
reinforcement learning for open ran slicing in 6g networks,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">IEEE
Communications Magazine</em>, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
D. Li and J. Sudharman K., “Machine-learning aided optimal customer decisions
for an interactive smart grid,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">IEEE Systems Journal</em>, vol. 9, no. 4,
pp. 1529–1541, 2015.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
M. Amine, A. Walid, A. Kobbane, and J. Ben-Othman, “New user association
scheme based on multi-objective optimization for 5g ultra-dense multi-rat
hetnets,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">2018 IEEE International Conference on Communications
(ICC)</em>, 2018, pp. 1–6.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
B. Assila, A. Kobbane, A. Walid, and M. El Koutbi, “Achieving low-energy
consumption in fog computing environment: A matching game approach,” in
<em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">2018 19th IEEE Mediterranean Electrotechnical Conference
(MELECON)</em>.   IEEE, 2018, pp. 213–218.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
S. Gmira, A. Kobbane, and E. Sabir, “A new optimal hybrid spectrum access in
cognitive radio: Overlay-underlay mode,” in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">2015 international
conference on wireless networks and mobile communications (WINCOM)</em>.   IEEE, 2015, pp. 1–7.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>.   PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
M. Chen, D. Gündüz, K. Huang, W. Saad, M. Bennis, A. V. Feljan, and
H. V. Poor, “Distributed learning in wireless networks: Recent progress and
future challenges,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">IEEE Journal on Selected Areas in Communications</em>,
2021.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
P. Kairouz, H. B. McMahan, B. Avent, A. Bellet, M. Bennis, A. N. Bhagoji,
K. Bonawitz, Z. Charles, G. Cormode, R. Cummings <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Advances
and open problems in federated learning,” <em id="bib.bib14.2.2" class="ltx_emph ltx_font_italic">Foundations and
Trends® in Machine Learning</em>, vol. 14, no. 1–2, pp. 1–210,
2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
S. Hochreiter and J. Schmidhuber, “Long short-term memory,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Neural
computation</em>, vol. 9, no. 8, pp. 1735–1780, 1997.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
A. Filali, A. Abouaomar, S. Cherkaoui, A. Kobbane, and M. Guizani,
“Multi-access edge computing: A survey,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>, vol. 8, pp.
197 017–197 046, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
A. Abouaomar, S. Cherkaoui, Z. Mlika, and A. Kobbane, “Resource provisioning
in edge computing for latency-sensitive applications,” <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">IEEE Internet
of Things Journal</em>, vol. 8, no. 14, pp. 11 088–11 099, 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
S. Bouktif, A. Fiaz, A. Ouni, and M. A. Serhani, “Optimal deep learning lstm
model for electric load forecasting using feature selection and genetic
algorithm: Comparison with machine learning approaches,” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Energies</em>,
vol. 11, no. 7, p. 1636, 2018.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
D. L. Marino, K. Amarasinghe, and M. Manic, “Building energy load forecasting
using deep neural networks,” in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IECON 2016-42nd Annual Conference of
the IEEE Industrial Electronics Society</em>.   IEEE, 2016, pp. 7046–7051.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
A. Almalaq and J. J. Zhang, “Evolutionary deep learning-based energy
consumption prediction for buildings,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">ieee access</em>, vol. 7, pp.
1520–1531, 2018.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
B. Stephen, X. Tang, P. R. Harvey, S. Galloway, and K. I. Jennett,
“Incorporating practice theory in sub-profile models for short term
aggregated residential load forecasting,” <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Smart
Grid</em>, vol. 8, no. 4, pp. 1591–1598, 2015.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
H. Shi, M. Xu, and R. Li, “Deep learning for household load forecasting—a
novel pooling deep rnn,” <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Smart Grid</em>, vol. 9,
no. 5, pp. 5271–5280, 2017.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
A. Hard, K. Rao, R. Mathews, S. Ramaswamy, F. Beaufays, S. Augenstein,
H. Eichner, C. Kiddon, and D. Ramage, “Federated learning for mobile
keyboard prediction,” <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1811.03604</em>, 2018.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2301.13035" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2301.13036" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2301.13036">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2301.13036" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2301.13037" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 03:38:59 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
