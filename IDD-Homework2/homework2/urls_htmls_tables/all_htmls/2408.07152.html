<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2408.07152] FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method</title><meta property="og:description" content="The rapid proliferation of Internet of Things (IoT) devices across multiple sectors has escalated serious network security concerns. This has prompted ongoing research in Machine Learning (ML)-based Intrusion Detection…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2408.07152">

<!--Generated on Thu Sep  5 12:27:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="IoT networks Intrusion detection Federated learning.">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="id1" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>
Virginia Tech, Arlington VA, USA 
<br class="ltx_break"><span id="id1.1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>{shihuas,pragyasharma,nwodok,angelos,hnw}@vt.edu</span></span></span>
</span></span></span>
<h1 class="ltx_title ltx_title_document">FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shihua Sun
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pragya Sharma
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kenechukwu Nwodo
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Angelos Stavrou
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Haining Wang
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">The rapid proliferation of Internet of Things (IoT) devices across multiple sectors has escalated serious network security concerns. This has prompted ongoing research in Machine Learning (ML)-based Intrusion Detection Systems (IDSs) for cyber-attack classification.
Traditional ML models require data transmission from IoT devices to a centralized server for traffic analysis, raising severe privacy concerns. To address this issue, researchers have studied Federated Learning (FL)-based IDSs that train models across IoT devices while keeping their data localized.
However, the heterogeneity of data, stemming from distinct vulnerabilities of devices and complexity of attack vectors, poses a significant challenge to the effectiveness of FL models.
While current research focuses on adapting various ML models within the FL framework, they fail to effectively address the issue of attack class imbalance among devices, which significantly degrades the classification accuracy of minority attacks.
To overcome this challenge, we introduce FedMADE, a novel dynamic aggregation method, which
clusters devices by their traffic patterns and aggregates local models based on their contributions towards overall performance.
We evaluate FedMADE against other FL algorithms designed for non-IID data and observe up to 71.07% improvement in minority attack classification accuracy.
We further show that FedMADE is robust to poisoning attacks and incurs only a 4.7% (5.03 seconds) latency overhead in each communication round compared to FedAvg, without increasing the computational load of IoT devices.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>IoT networks Intrusion detection Federated learning.
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The last decade has witnessed significant advancements in the Internet of Things (IoT) across various domains, including smart city infrastructures, e-health systems, and transportation networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. The widespread deployment of IoT devices expands the attack surfaces, and the inadequate security mechanisms of many IoT devices increase the vulnerability of these systems to cyber-threats. In response to these security issues, Intrusion Detection Systems (IDSs) have emerged as a critical defensive measure to protect IoT networks.
Typical IDSs primarily utilize two attack detection approaches: anomaly-based and signature-based <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. The former method employs learning-based techniques to differentiate between benign and malicious traffic patterns, while the latter method inspects traffic against known attack signatures.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Prevalent Machine Learning (ML) based IDSs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> collect data from devices across the network and process it on a central server, thus compromising data privacy. Therefore, in recent years, Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> has emerged as a distributed IDS solution that protects data privacy by decentralizing the training of ML models.
These models are locally trained and updated at the client-end and are sent to a central server for the construction of a global model.
However, FL-based IDSs face challenges due to data heterogeneity, caused by diverse device types, device vulnerabilities, complex attack vectors, and varying data collection environments <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. The disparity in attack distribution across devices, which we refer to as device-specific class imbalance, results in poor classification accuracy, particularly for minority attack classes. In this paper, we define minority attacks as those that impact only a small subset of devices.
For the scope of our work, we analyze the CICIoT2023 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> which is currently the most extensive dataset for IoT attack analysis. In this dataset, prevalent attacks such as Denial of Service (DoS), reconnaissance, and Mirai botnet attacks are observed across the majority of devices, whereas web-based and brute force attacks remain restricted to a limited number of devices.
While strategies like undersampling and oversampling can alleviate the class data quantity imbalance in centralized environments, these approaches fall short in addressing the device-specific class imbalance prevalent in modern distributed IDS frameworks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Existing FL-based IDS solutions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> are inadequate in addressing the data heterogeneity problem of IoT networks. Among these works, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> split centralized datasets in a statistical manner with artificially constructed non-independent and identically distributed (non-IID) distributions (see Table <a href="#S2.T1" title="Table 1 ‣ 2 Background &amp; Related works ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), which fail to reflect the real IoT network traffic distribution. Meanwhile, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> emphasize on integrating local models with different architectures to enhance their performance, but they neglect the impact of model divergence among clients in global model aggregation.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">This paper presents FedMADE, a dynamic aggregation method designed for data heterogeneity management and <span id="S1.p4.1.1" class="ltx_text ltx_framed ltx_framed_underline">m</span>inority <span id="S1.p4.1.2" class="ltx_text ltx_framed ltx_framed_underline">a</span>ttack <span id="S1.p4.1.3" class="ltx_text ltx_framed ltx_framed_underline">d</span>etection <span id="S1.p4.1.4" class="ltx_text ltx_framed ltx_framed_underline">e</span>nhancement in FL-based IDSs.
This method is implemented solely on the central server, without disturbing the local model update process, and therefore does not require additional computational resources from IoT devices.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">FedMADE comprises two steps: device clustering and dynamic aggregation weight design <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The term “aggregation weight” refers to the coefficient associated with the local model during the aggregation process, distinct from the model weights. </span></span></span>.
In the clustering phase, local models that exhibit similar classification performance are grouped together as detailed here.
This classification performance is represented using a class probability matrix (CPM), with each row representing the average probability vector (i.e. the output vector of the last layer after applying softmax function) of a class across all samples.
In practice, the server computes CPMs for each local model using a randomly-sampled minor auxiliary dataset for validation. Subsequently, the DBSCAN algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> is applied to these matrices to facilitate model clustering. Each cluster is then treated as a single entity to calculate aggregation weights, which reduces the computational complexity involved in analyzing large-scale IoT networks.
For each cluster, we average the class probabilities from each model to generate cluster class probability matrices (CCPMs).
We formulate the design of aggregation weights as an optimization problem aimed at minimizing the distance between the weighted sum of CCPMs and the identity matrix. The identity matrix represents the ideal CPM, in which each sample is classified into the correct class with 100% confidence.
As a result, local models that exhibit consistently superior performance will be allocated larger coefficients, thereby increasing their influence on the global model.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Apart from the performance degradation issues in IoT networks, FL frameworks are also vulnerable to various adversarial attacks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. Prominent among these are poisoning attacks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, where a set of local IoT clients may be compromised to erroneously steer the FL model towards incorrect classification. In this adversarial environment, FedMADE can also serve as a robust aggregation method to protect FL-based IDSs from such attacks. By using CPMs as performance indicators, the server can identify suspicious models that adversely affect the optimization of aggregation weights.
Consequently, compromised models can be allocated minimal or zero coefficients to limit their effect on the global model.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">Our contributions are summarized below:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We introduce a dynamic aggregation approach called FedMADE, that adaptively adjusts aggregation weights for FL-based IDS solutions. This approach selectively allocates larger weights to local models that demonstrate a consistent ability to accurately classify samples across all classes.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We conduct a comprehensive evaluation of FedMADE, utilizing the CICIoT2023 dataset, for binary attack detection and multiclass classification scenarios and demonstrate its effectiveness in addressing device-specific class imbalance.
FedMADE increases the classification accuracy of minority attacks by up to 71.07%, with only a marginal 4.7% (5.03 seconds) increase in round training time compared to FedAvg.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Lastly, we examine the robustness of FedMADE against poisoning attacks in adversarial settings.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background &amp; Related works</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this section, we outline the background of FL and current FL-based IDSs for IoT networks, discuss the challenges of applying FL in IoT environments, and present existing FL methods designed to address data heterogeneity.</p>
</div>
<figure id="S2.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S2.T1.2.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S2.T1.3.2" class="ltx_text" style="font-size:90%;">Overview of existing FL-based IDS methods, including their utilized datasets and data partition strategies.</span></figcaption>
<div id="S2.T1.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:251.4pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-122.4pt,70.8pt) scale(0.639091487124411,0.639091487124411) ;">
<table id="S2.T1.4.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S2.T1.4.1.1.1" class="ltx_tr">
<td id="S2.T1.4.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S2.T1.4.1.1.1.1.1" class="ltx_text ltx_font_bold">Dataset: Collection Environment</span></td>
<td id="S2.T1.4.1.1.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S2.T1.4.1.1.1.2.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S2.T1.4.1.1.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S2.T1.4.1.1.1.3.1" class="ltx_text ltx_font_bold">Partition</span></td>
<td id="S2.T1.4.1.1.1.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S2.T1.4.1.1.1.4.1" class="ltx_text ltx_font_bold">Attacks</span></td>
</tr>
<tr id="S2.T1.4.1.2.2" class="ltx_tr">
<td id="S2.T1.4.1.2.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">Modbus: N/A</td>
<td id="S2.T1.4.1.2.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">FL-LSTM-GRU (2022) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>
</td>
<td id="S2.T1.4.1.2.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">N/A</td>
<td id="S2.T1.4.1.2.2.4" class="ltx_td ltx_align_left ltx_border_tt">DDoS, MITM</td>
</tr>
<tr id="S2.T1.4.1.3.3" class="ltx_tr">
<td id="S2.T1.4.1.3.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<table id="S2.T1.4.1.3.3.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.4.1.3.3.1.1.1" class="ltx_tr">
<td id="S2.T1.4.1.3.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">NSL-KDD (2009) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>:</td>
</tr>
<tr id="S2.T1.4.1.3.3.1.1.2" class="ltx_tr">
<td id="S2.T1.4.1.3.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">Simulated U.S. Air Force LAN</td>
</tr>
</table>
</td>
<td id="S2.T1.4.1.3.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<table id="S2.T1.4.1.3.3.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.4.1.3.3.2.1.1" class="ltx_tr">
<td id="S2.T1.4.1.3.3.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">FeCo (2022) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</td>
</tr>
<tr id="S2.T1.4.1.3.3.2.1.2" class="ltx_tr">
<td id="S2.T1.4.1.3.3.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">Fed-PCA (2023) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>
</td>
</tr>
<tr id="S2.T1.4.1.3.3.2.1.3" class="ltx_tr">
<td id="S2.T1.4.1.3.3.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">IoT-SN (2020) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
</tr>
</table>
</td>
<td id="S2.T1.4.1.3.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Statistics</td>
<td id="S2.T1.4.1.3.3.4" class="ltx_td ltx_align_left ltx_border_t">DoS, Probe, R2L, U2R</td>
</tr>
<tr id="S2.T1.4.1.4.4" class="ltx_tr">
<td id="S2.T1.4.1.4.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<table id="S2.T1.4.1.4.4.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.4.1.4.4.1.1.1" class="ltx_tr">
<td id="S2.T1.4.1.4.4.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">UNSW-NB15 (2015) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>:</td>
</tr>
<tr id="S2.T1.4.1.4.4.1.1.2" class="ltx_tr">
<td id="S2.T1.4.1.4.4.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">Virtual network</td>
</tr>
</table>
</td>
<td id="S2.T1.4.1.4.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">IoT-SN (2020) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S2.T1.4.1.4.4.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Statistics</td>
<td id="S2.T1.4.1.4.4.4" class="ltx_td ltx_align_left ltx_border_t">
<table id="S2.T1.4.1.4.4.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.4.1.4.4.4.1.1" class="ltx_tr">
<td id="S2.T1.4.1.4.4.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Fuzzers, Analysis, Backdoors, DoS,</td>
</tr>
<tr id="S2.T1.4.1.4.4.4.1.2" class="ltx_tr">
<td id="S2.T1.4.1.4.4.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">Exploits, Generic, Recon, Shellcode</td>
</tr>
<tr id="S2.T1.4.1.4.4.4.1.3" class="ltx_tr">
<td id="S2.T1.4.1.4.4.4.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">and Worms</td>
</tr>
</table>
</td>
</tr>
<tr id="S2.T1.4.1.5.5" class="ltx_tr">
<td id="S2.T1.4.1.5.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" rowspan="2"><span id="S2.T1.4.1.5.5.1.1" class="ltx_text">
<span id="S2.T1.4.1.5.5.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S2.T1.4.1.5.5.1.1.1.1" class="ltx_tr">
<span id="S2.T1.4.1.5.5.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">N-BaIoT (2018) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>:</span></span>
<span id="S2.T1.4.1.5.5.1.1.1.2" class="ltx_tr">
<span id="S2.T1.4.1.5.5.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">Realistic network with 9 IoT devices</span></span>
</span></span></td>
<td id="S2.T1.4.1.5.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">FL-IoT-Malware (2022) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>
</td>
<td id="S2.T1.4.1.5.5.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Device</td>
<td id="S2.T1.4.1.5.5.4" class="ltx_td ltx_align_left ltx_border_t" rowspan="2"><span id="S2.T1.4.1.5.5.4.1" class="ltx_text">BASHLITE, Mirai</span></td>
</tr>
<tr id="S2.T1.4.1.6.6" class="ltx_tr">
<td id="S2.T1.4.1.6.6.1" class="ltx_td ltx_align_left ltx_border_r">IoT-SN(2020) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S2.T1.4.1.6.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Statistics</td>
</tr>
<tr id="S2.T1.4.1.7.7" class="ltx_tr">
<td id="S2.T1.4.1.7.7.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<table id="S2.T1.4.1.7.7.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.4.1.7.7.1.1.1" class="ltx_tr">
<td id="S2.T1.4.1.7.7.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Bot-IoT (2018) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>:</td>
</tr>
<tr id="S2.T1.4.1.7.7.1.1.2" class="ltx_tr">
<td id="S2.T1.4.1.7.7.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">Virtual network</td>
</tr>
</table>
</td>
<td id="S2.T1.4.1.7.7.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">FL-Botnet (2022) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>
</td>
<td id="S2.T1.4.1.7.7.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Statistics</td>
<td id="S2.T1.4.1.7.7.4" class="ltx_td ltx_align_left ltx_border_t">DoS, DDoS, Recon, and Data theft</td>
</tr>
<tr id="S2.T1.4.1.8.8" class="ltx_tr">
<td id="S2.T1.4.1.8.8.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<table id="S2.T1.4.1.8.8.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.4.1.8.8.1.1.1" class="ltx_tr">
<td id="S2.T1.4.1.8.8.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">D̈IoT dataset (2019) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>:</td>
</tr>
<tr id="S2.T1.4.1.8.8.1.1.2" class="ltx_tr">
<td id="S2.T1.4.1.8.8.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">Realistic network with 33 IoT devices</td>
</tr>
</table>
</td>
<td id="S2.T1.4.1.8.8.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">D̈IoT (2019) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</td>
<td id="S2.T1.4.1.8.8.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Device</td>
<td id="S2.T1.4.1.8.8.4" class="ltx_td ltx_align_left ltx_border_t">
<table id="S2.T1.4.1.8.8.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.4.1.8.8.4.1.1" class="ltx_tr">
<td id="S2.T1.4.1.8.8.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Four attack states of Mirai malware:</td>
</tr>
<tr id="S2.T1.4.1.8.8.4.1.2" class="ltx_tr">
<td id="S2.T1.4.1.8.8.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">pre-infection, infection, scanning, DoS</td>
</tr>
</table>
</td>
</tr>
<tr id="S2.T1.4.1.9.9" class="ltx_tr">
<td id="S2.T1.4.1.9.9.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<table id="S2.T1.4.1.9.9.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.4.1.9.9.1.1.1" class="ltx_tr">
<td id="S2.T1.4.1.9.9.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">TON-IoT (2020) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>:</td>
</tr>
<tr id="S2.T1.4.1.9.9.1.1.2" class="ltx_tr">
<td id="S2.T1.4.1.9.9.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">Network with 7 IoT and IIoT sensors</td>
</tr>
</table>
</td>
<td id="S2.T1.4.1.9.9.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Fed-DBN (2023) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
<td id="S2.T1.4.1.9.9.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">IP addresses</td>
<td id="S2.T1.4.1.9.9.4" class="ltx_td ltx_align_left ltx_border_t">
<table id="S2.T1.4.1.9.9.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.4.1.9.9.4.1.1" class="ltx_tr">
<td id="S2.T1.4.1.9.9.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Scanning, DDoS, DoS, Ransomware,</td>
</tr>
<tr id="S2.T1.4.1.9.9.4.1.2" class="ltx_tr">
<td id="S2.T1.4.1.9.9.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">Backdoor, Injection, XSS,</td>
</tr>
<tr id="S2.T1.4.1.9.9.4.1.3" class="ltx_tr">
<td id="S2.T1.4.1.9.9.4.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">Password Cracking, MITM</td>
</tr>
</table>
</td>
</tr>
<tr id="S2.T1.4.1.10.10" class="ltx_tr">
<td id="S2.T1.4.1.10.10.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">
<table id="S2.T1.4.1.10.10.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.4.1.10.10.1.1.1" class="ltx_tr">
<td id="S2.T1.4.1.10.10.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S2.T1.4.1.10.10.1.1.1.1.1" class="ltx_text ltx_font_bold">CICIoT2023 (2023):</span></td>
</tr>
<tr id="S2.T1.4.1.10.10.1.1.2" class="ltx_tr">
<td id="S2.T1.4.1.10.10.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S2.T1.4.1.10.10.1.1.2.1.1" class="ltx_text ltx_font_bold">Realistic IoT network with 105</span></td>
</tr>
<tr id="S2.T1.4.1.10.10.1.1.3" class="ltx_tr">
<td id="S2.T1.4.1.10.10.1.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S2.T1.4.1.10.10.1.1.3.1.1" class="ltx_text ltx_font_bold">devices</span></td>
</tr>
</table>
</td>
<td id="S2.T1.4.1.10.10.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="S2.T1.4.1.10.10.2.1" class="ltx_text ltx_font_bold">FedMADE</span></td>
<td id="S2.T1.4.1.10.10.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">
<table id="S2.T1.4.1.10.10.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.4.1.10.10.3.1.1" class="ltx_tr">
<td id="S2.T1.4.1.10.10.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">Victim MAC</td>
</tr>
<tr id="S2.T1.4.1.10.10.3.1.2" class="ltx_tr">
<td id="S2.T1.4.1.10.10.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">addresses by</td>
</tr>
<tr id="S2.T1.4.1.10.10.3.1.3" class="ltx_tr">
<td id="S2.T1.4.1.10.10.3.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">attack</td>
</tr>
</table>
</td>
<td id="S2.T1.4.1.10.10.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">
<table id="S2.T1.4.1.10.10.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.4.1.10.10.4.1.1" class="ltx_tr">
<td id="S2.T1.4.1.10.10.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left">DoS, DDoS, Mirai, Recon,</td>
</tr>
<tr id="S2.T1.4.1.10.10.4.1.2" class="ltx_tr">
<td id="S2.T1.4.1.10.10.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left">Spoofing, Web-based,</td>
</tr>
<tr id="S2.T1.4.1.10.10.4.1.3" class="ltx_tr">
<td id="S2.T1.4.1.10.10.4.1.3.1" class="ltx_td ltx_nopad_r ltx_align_left">Brute Force</td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">An FL system consists of a central server and a set of distributed local clients that collaboratively develop a global model without sharing their data with the server or each other.
The FL model training process is as follows: (1) the central server initializes a global model and distributes it to the local clients; (2) the clients update their local models based on captured traffic and then send their updated models back to the server; (3) the server aggregates the local models and broadcasts the updated global model to the clients for the next training round <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>
In this paper, the terms “training rounds” and “communication rounds” are used interchangeably.</span></span></span>. Steps (2) and (3) are repeated until the FL model converges.
In most works, FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> is employed as the default aggregation method in step (3), which averages the local models with weights proportional to their dataset sizes.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Existing FL-based IDSs for IoT Networks</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Nguyen et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> introduced DÏoT, a pioneering FL strategy for intrusion detection within IoT networks. This method utilizes diverse device-type-specific models to effectively manage the inherent heterogeneity among IoT devices.
Wang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> introduced FeCo, a representation learning method designed to create a new feature space. This space allows for the precise classification of benign and attack traffic, as benign traffic clusters tightly together, making it clearly distinguishable from attack traffic.
Popoola et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> focused on zero-day botnet attack detection, demonstrating the superior performance of their FL strategy over both centralized and localized detection methods.
Nguyen et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> incorporated Principal Component Analysis (PCA) into the FL framework, employing Grassmann manifold optimization to expedite the training process and reduce computation time.
The integration of diverse ML models into FL frameworks for IoT networks has been explored in several studies: <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> employed Deep Belief Networks (DBNs) and autoencoders; <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> utilized Attention Mechanism-based Convolutional Neural Network Long Short-Term Memory (AMCNN-LSTM) models for anomaly detection; <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> incorporated various architectures of Multi-Layer Perceptrons (MLPs) and autoencoders; <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> applied LSTM networks and Gated Recurrent Units (GRUs); and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> integrated Deep Neural Networks (DNNs) and DBNs. In addition, Liu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> introduced a gradient compression mechanism aimed at reducing the communication overhead associated with transmitting models between the server and local devices.
Rey et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>
discussed the vulnerabilities of FL models to poisoning attacks in the context of IDSs.
Belarbi et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> employed a pre-trained global model to facilitate the convergence of the global model during training.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Table <a href="#S2.T1" title="Table 1 ‣ 2 Background &amp; Related works ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes existing FL-based IDS solutions, the datasets employed, and their data partition strategies.
The data partition strategies include ‘Statistics,’ which denotes either IID or artificially designed non-IID distributions; ‘Device,’ indicating datasets pre-split by device; ‘IP addresses,’ describing allocations based on destination IP addresses; and ‘Victim MAC addresses by attack,’ where traffic from each attack is distributed to local clients based on the corresponding victim devices (further details are provided in Section <a href="#S3" title="3 System model ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p"><span id="S2.SS2.p3.1.1" class="ltx_text ltx_font_italic">Challenges of deploying FL to IoT networks.</span> (1) Lack of realistic network traffic in the FL context: IDS datasets are typically collected centrally within the network, necessitating a realistic data splitting strategy that effectively replicates the intricate traffic patterns of real-world IoT networks. However, most existing works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> split these centralized IDS datasets into either IID or artificially designed non-IID distributions, which do not adequately represent the true network traffic scenarios.
(2) Traffic heterogeneity: Various devices are susceptible to different types of attacks. While the diversity of attack types may not significantly impact binary classification for attack detection, it substantially affects the accuracy of classification to more detailed attack classes. This issue impedes the accurate assessment of network conditions. Additionally, much of the current research <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> aims to incorporate diverse ML models into the FL framework using the standard FedAvg aggregation, which neglects unique attack class imbalances among devices.
(3) Latency and resource constraints: The adoption of FL into IoT networks must take into account the limitations of computational resources and memory.
(4) Scalability: Considering the large scale of IoT networks, FL-based IDS solutions must be capable of accommodating a large number of participating devices.
(5) Robustness: Given the expansion of attack surfaces with FL, poisoning attacks can severely degrade the performance of FL-based IDSs by altering or injecting data into compromised IoT devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. Thus, a robust FL framework is crucial for practical IoT networks.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>FL with Data Heterogeneity</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Previous works design their methods to accommodate heterogeneous data by focusing on the three techniques:
(1) adjusting local model updates <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, (2) loss re-weighting and data augmentation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, and (3) intelligent local model selection and aggregation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>.
FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> incorporates a proximal term into the loss function of local clients, which limits the divergence between updated local models and the global model.
SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> measures client drift through the difference between update directions of the server and the clients, subsequently adjusting for this drift during the local model update.
MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> leveraged contrastive learning to minimize the discrepancy between representations derived from the global and local models. Wang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> developed a new loss function, called Ratio Loss, which adjusts the contributions of different training samples to emphasize those from minority classes.
Yoon et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> approximated the impact of Global Mixup, a linear interpolation-based data augmentation technique, by assuming that clients could exchange averaged data with others.
Fraboni et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> developed a client sampling strategy aimed at reducing the variability of selected models during training and improving client representations.
Wu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> increased the client sampling probability for those with higher similarity between their local gradients and the global gradient.</p>
</div>
<figure id="S2.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S2.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S2.T2.3.2" class="ltx_text" style="font-size:90%;">CICIoT2023 Dataset Statistics: number of samples in each class, class size ratios, and victim device count per class.</span></figcaption>
<div id="S2.T2.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:61.6pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-39.9pt,5.6pt) scale(0.844438401031902,0.844438401031902) ;">
<table id="S2.T2.4.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S2.T2.4.1.1.1" class="ltx_tr">
<td id="S2.T2.4.1.1.1.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="S2.T2.4.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Benign</td>
<td id="S2.T2.4.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">DDoS</td>
<td id="S2.T2.4.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">DoS</td>
<td id="S2.T2.4.1.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mirai</td>
<td id="S2.T2.4.1.1.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Recon</td>
<td id="S2.T2.4.1.1.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Spoofing</td>
<td id="S2.T2.4.1.1.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Web-based</td>
<td id="S2.T2.4.1.1.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Brute Force</td>
</tr>
<tr id="S2.T2.4.1.2.2" class="ltx_tr">
<td id="S2.T2.4.1.2.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">#data samples</td>
<td id="S2.T2.4.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1,098,195</td>
<td id="S2.T2.4.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">33,984,560</td>
<td id="S2.T2.4.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">8,090,738</td>
<td id="S2.T2.4.1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2,634,124</td>
<td id="S2.T2.4.1.2.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">354,565</td>
<td id="S2.T2.4.1.2.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">486,504</td>
<td id="S2.T2.4.1.2.2.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">24,829</td>
<td id="S2.T2.4.1.2.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">13,064</td>
</tr>
<tr id="S2.T2.4.1.3.3" class="ltx_tr">
<td id="S2.T2.4.1.3.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Ratio (%)</td>
<td id="S2.T2.4.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.35</td>
<td id="S2.T2.4.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.79</td>
<td id="S2.T2.4.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">17.33</td>
<td id="S2.T2.4.1.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5.64</td>
<td id="S2.T2.4.1.3.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.76</td>
<td id="S2.T2.4.1.3.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.04</td>
<td id="S2.T2.4.1.3.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.05</td>
<td id="S2.T2.4.1.3.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.03</td>
</tr>
<tr id="S2.T2.4.1.4.4" class="ltx_tr">
<td id="S2.T2.4.1.4.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">#victims</td>
<td id="S2.T2.4.1.4.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">63</td>
<td id="S2.T2.4.1.4.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">63</td>
<td id="S2.T2.4.1.4.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">54</td>
<td id="S2.T2.4.1.4.4.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">61</td>
<td id="S2.T2.4.1.4.4.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">63</td>
<td id="S2.T2.4.1.4.4.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">58</td>
<td id="S2.T2.4.1.4.4.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">3</td>
<td id="S2.T2.4.1.4.4.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">5</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>System model</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Dataset and Data Partition</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">For this work, we utilize the latest IDS dataset, CICIoT2023 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, which was collected from an extensive network topology of 105 real IoT devices, including smart home devices, cameras, sensors, and micro-controllers. This network comprises 67 devices involved in various attacks (63 victims and 4 attackers) and 38 Zigbee and Z-Wave devices. Moreover, the dataset covers the most comprehensive range of attacks targeting IoT networks to date, including 33 attacks divided into 7 broad categories: DDoS, DoS, Mirai, Recon, Spoofing, Web-based, and Brute Force. The packet capture (pcap) files are processed using the DPKT library <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> to extract 47 features <span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>For more details on the extracted features, please refer to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.</span></span></span>, saved in CSV files with corresponding labels.
In contrast, alternative IDS datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> from IoT environments are often derived from small-scale virtual networks that lack realistic device configurations, or they cover only a limited set of attacks. These limitations render such datasets inadequate for a thorough evaluation of the generalization and scalability of IDS solutions.
Table <a href="#S2.T2" title="Table 2 ‣ 2.3 FL with Data Heterogeneity ‣ 2 Background &amp; Related works ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents the data distribution of CICIoT2023. While the CSV files lack the source and destination IP addresses of traffic flows, this dataset provides a list of victims for each type of attack, including their MAC addresses. Consequently, in our FL framework, we designate each client as an IoT device identified by a MAC address and distribute network traffic from each class to the corresponding clients based on the victim list.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>FL-based IDS</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">As explained in Section <a href="#S2.SS1" title="2.1 Federated Learning ‣ 2 Background &amp; Related works ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.1</span></a>, the FL system consists of two fundamental categories of components: multiple distributed clients and a central server.
In the deployment of an FL-based IDS in IoT networks, the local model of each device is managed by its respective gateway, which connects the device to the Internet, and the central server is responsible for aggregating these local models.
For the CICIoT2023 scenario, we developed an FL system with 63 clients, where each client corresponds to a victim IoT device.
Local models are updated using gradient descent on the client side and FedMADE is employed on the server side to dynamically aggregate these local models.
During the FL training process, clients can choose to participate in each communication round based on the sporadic availability of IoT devices influenced by factors such as CPU, memory, battery capacity, and network connectivity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Proposed Method: FedMADE</h2>

<figure id="S4.F1" class="ltx_figure">
<p id="S4.F1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S4.F1.1.1" class="ltx_text"><img src="/html/2408.07152/assets/x1.png" id="S4.F1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="232" height="156" alt="Refer to caption"></span></p>
<br class="ltx_break ltx_break">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S4.F1.4.2" class="ltx_text" style="font-size:90%;">The visualization of FedMADE-based IDS.</span></figcaption>
</figure>
<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The primary cause of poor classification of minority attacks is the heterogeneous distribution of attack traffic. For instance, in the CICIoT2023 dataset, web-based attacks affect only 3 out of 67 devices. Consequently, with the use of FedAvg, knowledge about web-based attacks gets diminished during the aggregation process.
To address this issue, we propose FedMADE which incorporates a dynamic allocation of aggregation weights to different clients, prioritizing those with minority attack representations. This approach is designed to ensure robust classification performance across a diverse set of attack types.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">We formulate the design of aggregation weights as an optimization problem. In case of large-scale IoT networks, the scalability of our IDS solution can get limited with the increased number of devices. Thus, we propose a clustering of clients by the central server to reduce computation complexity.
As illustrated in Figure <a href="#S4.F1" title="Figure 1 ‣ 4 Proposed Method: FedMADE ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the key steps in FedMADE are (1) Device Clustering: Upon receiving the local models, the server groups the clients into clusters based on their classification performance, (2) Weight Calculation: The server calculates aggregation weights for each cluster, with clients in the same cluster receiving identical weights, and (3) Model Aggregation: The local models are aggregated together with these dynamically assigned weights.
The FedMADE approach is summarized in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 4.1 Local Model Training ‣ 4 Proposed Method: FedMADE ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">In this section, we first provide an overview of the local model training process at the clients in Section <a href="#S4.SS1" title="4.1 Local Model Training ‣ 4 Proposed Method: FedMADE ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>. Further, we comprehensively detail the device clustering and dynamic aggregation approach in Sections <a href="#S4.SS2" title="4.2 Client Clustering ‣ 4 Proposed Method: FedMADE ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> and <a href="#S4.SS3" title="4.3 Dynamic Aggregation Weight Calculation ‣ 4 Proposed Method: FedMADE ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Local Model Training</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.7" class="ltx_p">During the <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">r</annotation></semantics></math>-th training round, clients receive the global model <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="w^{(r)}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msup id="S4.SS1.p1.2.m2.1.2" xref="S4.SS1.p1.2.m2.1.2.cmml"><mi id="S4.SS1.p1.2.m2.1.2.2" xref="S4.SS1.p1.2.m2.1.2.2.cmml">w</mi><mrow id="S4.SS1.p1.2.m2.1.1.1.3" xref="S4.SS1.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.2.m2.1.1.1.3.1" xref="S4.SS1.p1.2.m2.1.2.cmml">(</mo><mi id="S4.SS1.p1.2.m2.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.SS1.p1.2.m2.1.1.1.3.2" xref="S4.SS1.p1.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.2.cmml" xref="S4.SS1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.2">superscript</csymbol><ci id="S4.SS1.p1.2.m2.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.2.2">𝑤</ci><ci id="S4.SS1.p1.2.m2.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">w^{(r)}</annotation></semantics></math> and update their local models following the formula <math id="S4.SS1.p1.3.m3.5" class="ltx_Math" alttext="{w}^{(r)}_{i}={w}^{(r)}-\eta\nabla L\left({w}^{(r)},D_{i}\right)" display="inline"><semantics id="S4.SS1.p1.3.m3.5a"><mrow id="S4.SS1.p1.3.m3.5.5" xref="S4.SS1.p1.3.m3.5.5.cmml"><msubsup id="S4.SS1.p1.3.m3.5.5.4" xref="S4.SS1.p1.3.m3.5.5.4.cmml"><mi id="S4.SS1.p1.3.m3.5.5.4.2.2" xref="S4.SS1.p1.3.m3.5.5.4.2.2.cmml">w</mi><mi id="S4.SS1.p1.3.m3.5.5.4.3" xref="S4.SS1.p1.3.m3.5.5.4.3.cmml">i</mi><mrow id="S4.SS1.p1.3.m3.1.1.1.3" xref="S4.SS1.p1.3.m3.5.5.4.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.1.1.1.3.1" xref="S4.SS1.p1.3.m3.5.5.4.cmml">(</mo><mi id="S4.SS1.p1.3.m3.1.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.SS1.p1.3.m3.1.1.1.3.2" xref="S4.SS1.p1.3.m3.5.5.4.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.p1.3.m3.5.5.3" xref="S4.SS1.p1.3.m3.5.5.3.cmml">=</mo><mrow id="S4.SS1.p1.3.m3.5.5.2" xref="S4.SS1.p1.3.m3.5.5.2.cmml"><msup id="S4.SS1.p1.3.m3.5.5.2.4" xref="S4.SS1.p1.3.m3.5.5.2.4.cmml"><mi id="S4.SS1.p1.3.m3.5.5.2.4.2" xref="S4.SS1.p1.3.m3.5.5.2.4.2.cmml">w</mi><mrow id="S4.SS1.p1.3.m3.2.2.1.3" xref="S4.SS1.p1.3.m3.5.5.2.4.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.2.2.1.3.1" xref="S4.SS1.p1.3.m3.5.5.2.4.cmml">(</mo><mi id="S4.SS1.p1.3.m3.2.2.1.1" xref="S4.SS1.p1.3.m3.2.2.1.1.cmml">r</mi><mo stretchy="false" id="S4.SS1.p1.3.m3.2.2.1.3.2" xref="S4.SS1.p1.3.m3.5.5.2.4.cmml">)</mo></mrow></msup><mo id="S4.SS1.p1.3.m3.5.5.2.3" xref="S4.SS1.p1.3.m3.5.5.2.3.cmml">−</mo><mrow id="S4.SS1.p1.3.m3.5.5.2.2" xref="S4.SS1.p1.3.m3.5.5.2.2.cmml"><mi id="S4.SS1.p1.3.m3.5.5.2.2.4" xref="S4.SS1.p1.3.m3.5.5.2.2.4.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S4.SS1.p1.3.m3.5.5.2.2.3" xref="S4.SS1.p1.3.m3.5.5.2.2.3.cmml">​</mo><mrow id="S4.SS1.p1.3.m3.5.5.2.2.5" xref="S4.SS1.p1.3.m3.5.5.2.2.5.cmml"><mo rspace="0.167em" id="S4.SS1.p1.3.m3.5.5.2.2.5.1" xref="S4.SS1.p1.3.m3.5.5.2.2.5.1.cmml">∇</mo><mi id="S4.SS1.p1.3.m3.5.5.2.2.5.2" xref="S4.SS1.p1.3.m3.5.5.2.2.5.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS1.p1.3.m3.5.5.2.2.3a" xref="S4.SS1.p1.3.m3.5.5.2.2.3.cmml">​</mo><mrow id="S4.SS1.p1.3.m3.5.5.2.2.2.2" xref="S4.SS1.p1.3.m3.5.5.2.2.2.3.cmml"><mo id="S4.SS1.p1.3.m3.5.5.2.2.2.2.3" xref="S4.SS1.p1.3.m3.5.5.2.2.2.3.cmml">(</mo><msup id="S4.SS1.p1.3.m3.4.4.1.1.1.1.1" xref="S4.SS1.p1.3.m3.4.4.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.3.m3.4.4.1.1.1.1.1.2" xref="S4.SS1.p1.3.m3.4.4.1.1.1.1.1.2.cmml">w</mi><mrow id="S4.SS1.p1.3.m3.3.3.1.3" xref="S4.SS1.p1.3.m3.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.3.3.1.3.1" xref="S4.SS1.p1.3.m3.4.4.1.1.1.1.1.cmml">(</mo><mi id="S4.SS1.p1.3.m3.3.3.1.1" xref="S4.SS1.p1.3.m3.3.3.1.1.cmml">r</mi><mo stretchy="false" id="S4.SS1.p1.3.m3.3.3.1.3.2" xref="S4.SS1.p1.3.m3.4.4.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.SS1.p1.3.m3.5.5.2.2.2.2.4" xref="S4.SS1.p1.3.m3.5.5.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p1.3.m3.5.5.2.2.2.2.2" xref="S4.SS1.p1.3.m3.5.5.2.2.2.2.2.cmml"><mi id="S4.SS1.p1.3.m3.5.5.2.2.2.2.2.2" xref="S4.SS1.p1.3.m3.5.5.2.2.2.2.2.2.cmml">D</mi><mi id="S4.SS1.p1.3.m3.5.5.2.2.2.2.2.3" xref="S4.SS1.p1.3.m3.5.5.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS1.p1.3.m3.5.5.2.2.2.2.5" xref="S4.SS1.p1.3.m3.5.5.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.5b"><apply id="S4.SS1.p1.3.m3.5.5.cmml" xref="S4.SS1.p1.3.m3.5.5"><eq id="S4.SS1.p1.3.m3.5.5.3.cmml" xref="S4.SS1.p1.3.m3.5.5.3"></eq><apply id="S4.SS1.p1.3.m3.5.5.4.cmml" xref="S4.SS1.p1.3.m3.5.5.4"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.5.5.4.1.cmml" xref="S4.SS1.p1.3.m3.5.5.4">subscript</csymbol><apply id="S4.SS1.p1.3.m3.5.5.4.2.cmml" xref="S4.SS1.p1.3.m3.5.5.4"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.5.5.4.2.1.cmml" xref="S4.SS1.p1.3.m3.5.5.4">superscript</csymbol><ci id="S4.SS1.p1.3.m3.5.5.4.2.2.cmml" xref="S4.SS1.p1.3.m3.5.5.4.2.2">𝑤</ci><ci id="S4.SS1.p1.3.m3.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1">𝑟</ci></apply><ci id="S4.SS1.p1.3.m3.5.5.4.3.cmml" xref="S4.SS1.p1.3.m3.5.5.4.3">𝑖</ci></apply><apply id="S4.SS1.p1.3.m3.5.5.2.cmml" xref="S4.SS1.p1.3.m3.5.5.2"><minus id="S4.SS1.p1.3.m3.5.5.2.3.cmml" xref="S4.SS1.p1.3.m3.5.5.2.3"></minus><apply id="S4.SS1.p1.3.m3.5.5.2.4.cmml" xref="S4.SS1.p1.3.m3.5.5.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.5.5.2.4.1.cmml" xref="S4.SS1.p1.3.m3.5.5.2.4">superscript</csymbol><ci id="S4.SS1.p1.3.m3.5.5.2.4.2.cmml" xref="S4.SS1.p1.3.m3.5.5.2.4.2">𝑤</ci><ci id="S4.SS1.p1.3.m3.2.2.1.1.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1">𝑟</ci></apply><apply id="S4.SS1.p1.3.m3.5.5.2.2.cmml" xref="S4.SS1.p1.3.m3.5.5.2.2"><times id="S4.SS1.p1.3.m3.5.5.2.2.3.cmml" xref="S4.SS1.p1.3.m3.5.5.2.2.3"></times><ci id="S4.SS1.p1.3.m3.5.5.2.2.4.cmml" xref="S4.SS1.p1.3.m3.5.5.2.2.4">𝜂</ci><apply id="S4.SS1.p1.3.m3.5.5.2.2.5.cmml" xref="S4.SS1.p1.3.m3.5.5.2.2.5"><ci id="S4.SS1.p1.3.m3.5.5.2.2.5.1.cmml" xref="S4.SS1.p1.3.m3.5.5.2.2.5.1">∇</ci><ci id="S4.SS1.p1.3.m3.5.5.2.2.5.2.cmml" xref="S4.SS1.p1.3.m3.5.5.2.2.5.2">𝐿</ci></apply><interval closure="open" id="S4.SS1.p1.3.m3.5.5.2.2.2.3.cmml" xref="S4.SS1.p1.3.m3.5.5.2.2.2.2"><apply id="S4.SS1.p1.3.m3.4.4.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.4.4.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.4.4.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p1.3.m3.4.4.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.4.4.1.1.1.1.1.2">𝑤</ci><ci id="S4.SS1.p1.3.m3.3.3.1.1.cmml" xref="S4.SS1.p1.3.m3.3.3.1.1">𝑟</ci></apply><apply id="S4.SS1.p1.3.m3.5.5.2.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.5.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.5.5.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.3.m3.5.5.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.5.5.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.5.5.2.2.2.2.2.2">𝐷</ci><ci id="S4.SS1.p1.3.m3.5.5.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.3.m3.5.5.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.5c">{w}^{(r)}_{i}={w}^{(r)}-\eta\nabla L\left({w}^{(r)},D_{i}\right)</annotation></semantics></math>, where <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\eta</annotation></semantics></math> is the learning rate, <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><msub id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">D</mi><mi id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">𝐷</ci><ci id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">D_{i}</annotation></semantics></math> denotes the local dataset of the <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">i</annotation></semantics></math>-th client, and <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mi id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><ci id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">L</annotation></semantics></math> represents the loss function. These local model updates are conducted iteratively over several epochs, depending on the available resources of the IoT devices, such as battery capacity and CPU utilization.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FedMADE</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text ltx_font_bold">for</span> each round <math id="alg1.l1.m1.3" class="ltx_Math" alttext="r=1,...,R" display="inline"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.4" xref="alg1.l1.m1.3.4.cmml"><mi id="alg1.l1.m1.3.4.2" xref="alg1.l1.m1.3.4.2.cmml">r</mi><mo id="alg1.l1.m1.3.4.1" xref="alg1.l1.m1.3.4.1.cmml">=</mo><mrow id="alg1.l1.m1.3.4.3.2" xref="alg1.l1.m1.3.4.3.1.cmml"><mn id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">1</mn><mo id="alg1.l1.m1.3.4.3.2.1" xref="alg1.l1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">…</mi><mo id="alg1.l1.m1.3.4.3.2.2" xref="alg1.l1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml">R</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.4.cmml" xref="alg1.l1.m1.3.4"><eq id="alg1.l1.m1.3.4.1.cmml" xref="alg1.l1.m1.3.4.1"></eq><ci id="alg1.l1.m1.3.4.2.cmml" xref="alg1.l1.m1.3.4.2">𝑟</ci><list id="alg1.l1.m1.3.4.3.1.cmml" xref="alg1.l1.m1.3.4.3.2"><cn type="integer" id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">1</cn><ci id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">…</ci><ci id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3">𝑅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">r=1,...,R</annotation></semantics></math> <span id="alg1.l1.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>     Sample a set of clients <math id="alg1.l2.m1.1" class="ltx_Math" alttext="U" display="inline"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">U</annotation></semantics></math> according to the client sampling rate <math id="alg1.l2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">\gamma</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     Broadcast <math id="alg1.l3.m1.1" class="ltx_Math" alttext="w^{(r)}" display="inline"><semantics id="alg1.l3.m1.1a"><msup id="alg1.l3.m1.1.2" xref="alg1.l3.m1.1.2.cmml"><mi id="alg1.l3.m1.1.2.2" xref="alg1.l3.m1.1.2.2.cmml">w</mi><mrow id="alg1.l3.m1.1.1.1.3" xref="alg1.l3.m1.1.2.cmml"><mo stretchy="false" id="alg1.l3.m1.1.1.1.3.1" xref="alg1.l3.m1.1.2.cmml">(</mo><mi id="alg1.l3.m1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l3.m1.1.1.1.3.2" xref="alg1.l3.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.2.cmml" xref="alg1.l3.m1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.2.1.cmml" xref="alg1.l3.m1.1.2">superscript</csymbol><ci id="alg1.l3.m1.1.2.2.cmml" xref="alg1.l3.m1.1.2.2">𝑤</ci><ci id="alg1.l3.m1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">w^{(r)}</annotation></semantics></math> to all clients in <math id="alg1.l3.m2.1" class="ltx_Math" alttext="U" display="inline"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">U</annotation></semantics></math>, and do local updates

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     Collect local models {<math id="alg1.l4.m1.6" class="ltx_Math" alttext="w^{(r)}_{1},...,w^{(r)}_{|U|}" display="inline"><semantics id="alg1.l4.m1.6a"><mrow id="alg1.l4.m1.6.6.2" xref="alg1.l4.m1.6.6.3.cmml"><msubsup id="alg1.l4.m1.5.5.1.1" xref="alg1.l4.m1.5.5.1.1.cmml"><mi id="alg1.l4.m1.5.5.1.1.2.2" xref="alg1.l4.m1.5.5.1.1.2.2.cmml">w</mi><mn id="alg1.l4.m1.5.5.1.1.3" xref="alg1.l4.m1.5.5.1.1.3.cmml">1</mn><mrow id="alg1.l4.m1.1.1.1.3" xref="alg1.l4.m1.5.5.1.1.cmml"><mo stretchy="false" id="alg1.l4.m1.1.1.1.3.1" xref="alg1.l4.m1.5.5.1.1.cmml">(</mo><mi id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l4.m1.1.1.1.3.2" xref="alg1.l4.m1.5.5.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l4.m1.6.6.2.3" xref="alg1.l4.m1.6.6.3.cmml">,</mo><mi mathvariant="normal" id="alg1.l4.m1.4.4" xref="alg1.l4.m1.4.4.cmml">…</mi><mo id="alg1.l4.m1.6.6.2.4" xref="alg1.l4.m1.6.6.3.cmml">,</mo><msubsup id="alg1.l4.m1.6.6.2.2" xref="alg1.l4.m1.6.6.2.2.cmml"><mi id="alg1.l4.m1.6.6.2.2.2.2" xref="alg1.l4.m1.6.6.2.2.2.2.cmml">w</mi><mrow id="alg1.l4.m1.3.3.1.3" xref="alg1.l4.m1.3.3.1.2.cmml"><mo stretchy="false" id="alg1.l4.m1.3.3.1.3.1" xref="alg1.l4.m1.3.3.1.2.1.cmml">|</mo><mi id="alg1.l4.m1.3.3.1.1" xref="alg1.l4.m1.3.3.1.1.cmml">U</mi><mo stretchy="false" id="alg1.l4.m1.3.3.1.3.2" xref="alg1.l4.m1.3.3.1.2.1.cmml">|</mo></mrow><mrow id="alg1.l4.m1.2.2.1.3" xref="alg1.l4.m1.6.6.2.2.cmml"><mo stretchy="false" id="alg1.l4.m1.2.2.1.3.1" xref="alg1.l4.m1.6.6.2.2.cmml">(</mo><mi id="alg1.l4.m1.2.2.1.1" xref="alg1.l4.m1.2.2.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l4.m1.2.2.1.3.2" xref="alg1.l4.m1.6.6.2.2.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.6b"><list id="alg1.l4.m1.6.6.3.cmml" xref="alg1.l4.m1.6.6.2"><apply id="alg1.l4.m1.5.5.1.1.cmml" xref="alg1.l4.m1.5.5.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1">subscript</csymbol><apply id="alg1.l4.m1.5.5.1.1.2.cmml" xref="alg1.l4.m1.5.5.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.1.1.2.1.cmml" xref="alg1.l4.m1.5.5.1.1">superscript</csymbol><ci id="alg1.l4.m1.5.5.1.1.2.2.cmml" xref="alg1.l4.m1.5.5.1.1.2.2">𝑤</ci><ci id="alg1.l4.m1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1">𝑟</ci></apply><cn type="integer" id="alg1.l4.m1.5.5.1.1.3.cmml" xref="alg1.l4.m1.5.5.1.1.3">1</cn></apply><ci id="alg1.l4.m1.4.4.cmml" xref="alg1.l4.m1.4.4">…</ci><apply id="alg1.l4.m1.6.6.2.2.cmml" xref="alg1.l4.m1.6.6.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.2.2.1.cmml" xref="alg1.l4.m1.6.6.2.2">subscript</csymbol><apply id="alg1.l4.m1.6.6.2.2.2.cmml" xref="alg1.l4.m1.6.6.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.2.2.2.1.cmml" xref="alg1.l4.m1.6.6.2.2">superscript</csymbol><ci id="alg1.l4.m1.6.6.2.2.2.2.cmml" xref="alg1.l4.m1.6.6.2.2.2.2">𝑤</ci><ci id="alg1.l4.m1.2.2.1.1.cmml" xref="alg1.l4.m1.2.2.1.1">𝑟</ci></apply><apply id="alg1.l4.m1.3.3.1.2.cmml" xref="alg1.l4.m1.3.3.1.3"><abs id="alg1.l4.m1.3.3.1.2.1.cmml" xref="alg1.l4.m1.3.3.1.3.1"></abs><ci id="alg1.l4.m1.3.3.1.1.cmml" xref="alg1.l4.m1.3.3.1.1">𝑈</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.6c">w^{(r)}_{1},...,w^{(r)}_{|U|}</annotation></semantics></math>} from clients

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg1.l5.2" class="ltx_text ltx_font_bold">for</span> each local model <math id="alg1.l5.m1.1" class="ltx_Math" alttext="w^{(r)}_{i}" display="inline"><semantics id="alg1.l5.m1.1a"><msubsup id="alg1.l5.m1.1.2" xref="alg1.l5.m1.1.2.cmml"><mi id="alg1.l5.m1.1.2.2.2" xref="alg1.l5.m1.1.2.2.2.cmml">w</mi><mi id="alg1.l5.m1.1.2.3" xref="alg1.l5.m1.1.2.3.cmml">i</mi><mrow id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.2.cmml"><mo stretchy="false" id="alg1.l5.m1.1.1.1.3.1" xref="alg1.l5.m1.1.2.cmml">(</mo><mi id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l5.m1.1.1.1.3.2" xref="alg1.l5.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.2.cmml" xref="alg1.l5.m1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.1.cmml" xref="alg1.l5.m1.1.2">subscript</csymbol><apply id="alg1.l5.m1.1.2.2.cmml" xref="alg1.l5.m1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.2.1.cmml" xref="alg1.l5.m1.1.2">superscript</csymbol><ci id="alg1.l5.m1.1.2.2.2.cmml" xref="alg1.l5.m1.1.2.2.2">𝑤</ci><ci id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">𝑟</ci></apply><ci id="alg1.l5.m1.1.2.3.cmml" xref="alg1.l5.m1.1.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">w^{(r)}_{i}</annotation></semantics></math> <span id="alg1.l5.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>         Compute class probability matrix <math id="alg1.l6.m1.1" class="ltx_Math" alttext="P_{w^{(r)}_{i}}" display="inline"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.2" xref="alg1.l6.m1.1.2.cmml"><mi id="alg1.l6.m1.1.2.2" xref="alg1.l6.m1.1.2.2.cmml">P</mi><msubsup id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.3.2.cmml">w</mi><mi id="alg1.l6.m1.1.1.1.4" xref="alg1.l6.m1.1.1.1.4.cmml">i</mi><mrow id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.3.1" xref="alg1.l6.m1.1.1.1.cmml">(</mo><mi id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.2.cmml" xref="alg1.l6.m1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.2.1.cmml" xref="alg1.l6.m1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.2.2.cmml" xref="alg1.l6.m1.1.2.2">𝑃</ci><apply id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1">subscript</csymbol><apply id="alg1.l6.m1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1">superscript</csymbol><ci id="alg1.l6.m1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.3.2">𝑤</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1">𝑟</ci></apply><ci id="alg1.l6.m1.1.1.1.4.cmml" xref="alg1.l6.m1.1.1.1.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">P_{w^{(r)}_{i}}</annotation></semantics></math> according to Equation <a href="#S4.E1" title="In 4.2 Client Clustering ‣ 4 Proposed Method: FedMADE ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="alg1.l7.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l7.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <math id="alg1.l8.m1.6" class="ltx_Math" alttext="\mathcal{C}\leftarrow\operatorname{DBSCAN}(\{P_{w^{(r)}_{1}},...,P_{w^{(r)}_{|U|}}\})" display="inline"><semantics id="alg1.l8.m1.6a"><mrow id="alg1.l8.m1.6.6" xref="alg1.l8.m1.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.6.6.3" xref="alg1.l8.m1.6.6.3.cmml">𝒞</mi><mo stretchy="false" id="alg1.l8.m1.6.6.2" xref="alg1.l8.m1.6.6.2.cmml">←</mo><mrow id="alg1.l8.m1.6.6.1.1" xref="alg1.l8.m1.6.6.1.2.cmml"><mi id="alg1.l8.m1.5.5" xref="alg1.l8.m1.5.5.cmml">DBSCAN</mi><mo id="alg1.l8.m1.6.6.1.1a" xref="alg1.l8.m1.6.6.1.2.cmml">⁡</mo><mrow id="alg1.l8.m1.6.6.1.1.1" xref="alg1.l8.m1.6.6.1.2.cmml"><mo stretchy="false" id="alg1.l8.m1.6.6.1.1.1.2" xref="alg1.l8.m1.6.6.1.2.cmml">(</mo><mrow id="alg1.l8.m1.6.6.1.1.1.1.2" xref="alg1.l8.m1.6.6.1.1.1.1.3.cmml"><mo stretchy="false" id="alg1.l8.m1.6.6.1.1.1.1.2.3" xref="alg1.l8.m1.6.6.1.1.1.1.3.cmml">{</mo><msub id="alg1.l8.m1.6.6.1.1.1.1.1.1" xref="alg1.l8.m1.6.6.1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.6.6.1.1.1.1.1.1.2" xref="alg1.l8.m1.6.6.1.1.1.1.1.1.2.cmml">P</mi><msubsup id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.3.2.cmml">w</mi><mn id="alg1.l8.m1.1.1.1.4" xref="alg1.l8.m1.1.1.1.4.cmml">1</mn><mrow id="alg1.l8.m1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.cmml"><mo stretchy="false" id="alg1.l8.m1.1.1.1.1.1.3.1" xref="alg1.l8.m1.1.1.1.cmml">(</mo><mi id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l8.m1.1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><mo id="alg1.l8.m1.6.6.1.1.1.1.2.4" xref="alg1.l8.m1.6.6.1.1.1.1.3.cmml">,</mo><mi mathvariant="normal" id="alg1.l8.m1.4.4" xref="alg1.l8.m1.4.4.cmml">…</mi><mo id="alg1.l8.m1.6.6.1.1.1.1.2.5" xref="alg1.l8.m1.6.6.1.1.1.1.3.cmml">,</mo><msub id="alg1.l8.m1.6.6.1.1.1.1.2.2" xref="alg1.l8.m1.6.6.1.1.1.1.2.2.cmml"><mi id="alg1.l8.m1.6.6.1.1.1.1.2.2.2" xref="alg1.l8.m1.6.6.1.1.1.1.2.2.2.cmml">P</mi><msubsup id="alg1.l8.m1.3.3.2" xref="alg1.l8.m1.3.3.2.cmml"><mi id="alg1.l8.m1.3.3.2.4.2" xref="alg1.l8.m1.3.3.2.4.2.cmml">w</mi><mrow id="alg1.l8.m1.3.3.2.2.1.3" xref="alg1.l8.m1.3.3.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l8.m1.3.3.2.2.1.3.1" xref="alg1.l8.m1.3.3.2.2.1.2.1.cmml">|</mo><mi id="alg1.l8.m1.3.3.2.2.1.1" xref="alg1.l8.m1.3.3.2.2.1.1.cmml">U</mi><mo stretchy="false" id="alg1.l8.m1.3.3.2.2.1.3.2" xref="alg1.l8.m1.3.3.2.2.1.2.1.cmml">|</mo></mrow><mrow id="alg1.l8.m1.2.2.1.1.1.3" xref="alg1.l8.m1.3.3.2.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.1.3.1" xref="alg1.l8.m1.3.3.2.cmml">(</mo><mi id="alg1.l8.m1.2.2.1.1.1.1" xref="alg1.l8.m1.2.2.1.1.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.1.3.2" xref="alg1.l8.m1.3.3.2.cmml">)</mo></mrow></msubsup></msub><mo stretchy="false" id="alg1.l8.m1.6.6.1.1.1.1.2.6" xref="alg1.l8.m1.6.6.1.1.1.1.3.cmml">}</mo></mrow><mo stretchy="false" id="alg1.l8.m1.6.6.1.1.1.3" xref="alg1.l8.m1.6.6.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.6b"><apply id="alg1.l8.m1.6.6.cmml" xref="alg1.l8.m1.6.6"><ci id="alg1.l8.m1.6.6.2.cmml" xref="alg1.l8.m1.6.6.2">←</ci><ci id="alg1.l8.m1.6.6.3.cmml" xref="alg1.l8.m1.6.6.3">𝒞</ci><apply id="alg1.l8.m1.6.6.1.2.cmml" xref="alg1.l8.m1.6.6.1.1"><ci id="alg1.l8.m1.5.5.cmml" xref="alg1.l8.m1.5.5">DBSCAN</ci><set id="alg1.l8.m1.6.6.1.1.1.1.3.cmml" xref="alg1.l8.m1.6.6.1.1.1.1.2"><apply id="alg1.l8.m1.6.6.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.6.6.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.6.6.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.6.6.1.1.1.1.1.1.2">𝑃</ci><apply id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1">subscript</csymbol><apply id="alg1.l8.m1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1">superscript</csymbol><ci id="alg1.l8.m1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.3.2">𝑤</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1">𝑟</ci></apply><cn type="integer" id="alg1.l8.m1.1.1.1.4.cmml" xref="alg1.l8.m1.1.1.1.4">1</cn></apply></apply><ci id="alg1.l8.m1.4.4.cmml" xref="alg1.l8.m1.4.4">…</ci><apply id="alg1.l8.m1.6.6.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.6.6.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.6.6.1.1.1.1.2.2.1.cmml" xref="alg1.l8.m1.6.6.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l8.m1.6.6.1.1.1.1.2.2.2.cmml" xref="alg1.l8.m1.6.6.1.1.1.1.2.2.2">𝑃</ci><apply id="alg1.l8.m1.3.3.2.cmml" xref="alg1.l8.m1.3.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.2.3.cmml" xref="alg1.l8.m1.3.3.2">subscript</csymbol><apply id="alg1.l8.m1.3.3.2.4.cmml" xref="alg1.l8.m1.3.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.2.4.1.cmml" xref="alg1.l8.m1.3.3.2">superscript</csymbol><ci id="alg1.l8.m1.3.3.2.4.2.cmml" xref="alg1.l8.m1.3.3.2.4.2">𝑤</ci><ci id="alg1.l8.m1.2.2.1.1.1.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1">𝑟</ci></apply><apply id="alg1.l8.m1.3.3.2.2.1.2.cmml" xref="alg1.l8.m1.3.3.2.2.1.3"><abs id="alg1.l8.m1.3.3.2.2.1.2.1.cmml" xref="alg1.l8.m1.3.3.2.2.1.3.1"></abs><ci id="alg1.l8.m1.3.3.2.2.1.1.cmml" xref="alg1.l8.m1.3.3.2.2.1.1">𝑈</ci></apply></apply></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.6c">\mathcal{C}\leftarrow\operatorname{DBSCAN}(\{P_{w^{(r)}_{1}},...,P_{w^{(r)}_{|U|}}\})</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     <span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span> for each cluster <math id="alg1.l9.m1.1" class="ltx_Math" alttext="\mathcal{C}_{k}" display="inline"><semantics id="alg1.l9.m1.1a"><msub id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">𝒞</mi><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝒞</ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\mathcal{C}_{k}</annotation></semantics></math> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>         <math id="alg1.l10.m1.3" class="ltx_Math" alttext="P_{\mathcal{C}_{k}}\leftarrow\frac{1}{|\mathcal{C}_{k}|}\sum_{w_{i}^{(r)}\in\mathcal{C}_{k}}P_{w_{i}^{(r)}}" display="inline"><semantics id="alg1.l10.m1.3a"><mrow id="alg1.l10.m1.3.4" xref="alg1.l10.m1.3.4.cmml"><msub id="alg1.l10.m1.3.4.2" xref="alg1.l10.m1.3.4.2.cmml"><mi id="alg1.l10.m1.3.4.2.2" xref="alg1.l10.m1.3.4.2.2.cmml">P</mi><msub id="alg1.l10.m1.3.4.2.3" xref="alg1.l10.m1.3.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.3.4.2.3.2" xref="alg1.l10.m1.3.4.2.3.2.cmml">𝒞</mi><mi id="alg1.l10.m1.3.4.2.3.3" xref="alg1.l10.m1.3.4.2.3.3.cmml">k</mi></msub></msub><mo stretchy="false" id="alg1.l10.m1.3.4.1" xref="alg1.l10.m1.3.4.1.cmml">←</mo><mrow id="alg1.l10.m1.3.4.3" xref="alg1.l10.m1.3.4.3.cmml"><mfrac id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mn id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">1</mn><mrow id="alg1.l10.m1.1.1.1.1" xref="alg1.l10.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l10.m1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.2.1.cmml">|</mo><msub id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.2.cmml">𝒞</mi><mi id="alg1.l10.m1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l10.m1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l10.m1.3.4.3.1" xref="alg1.l10.m1.3.4.3.1.cmml">​</mo><mrow id="alg1.l10.m1.3.4.3.2" xref="alg1.l10.m1.3.4.3.2.cmml"><msub id="alg1.l10.m1.3.4.3.2.1" xref="alg1.l10.m1.3.4.3.2.1.cmml"><mo id="alg1.l10.m1.3.4.3.2.1.2" xref="alg1.l10.m1.3.4.3.2.1.2.cmml">∑</mo><mrow id="alg1.l10.m1.2.2.1" xref="alg1.l10.m1.2.2.1.cmml"><msubsup id="alg1.l10.m1.2.2.1.3" xref="alg1.l10.m1.2.2.1.3.cmml"><mi id="alg1.l10.m1.2.2.1.3.2.2" xref="alg1.l10.m1.2.2.1.3.2.2.cmml">w</mi><mi id="alg1.l10.m1.2.2.1.3.2.3" xref="alg1.l10.m1.2.2.1.3.2.3.cmml">i</mi><mrow id="alg1.l10.m1.2.2.1.1.1.3" xref="alg1.l10.m1.2.2.1.3.cmml"><mo stretchy="false" id="alg1.l10.m1.2.2.1.1.1.3.1" xref="alg1.l10.m1.2.2.1.3.cmml">(</mo><mi id="alg1.l10.m1.2.2.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l10.m1.2.2.1.1.1.3.2" xref="alg1.l10.m1.2.2.1.3.cmml">)</mo></mrow></msubsup><mo id="alg1.l10.m1.2.2.1.2" xref="alg1.l10.m1.2.2.1.2.cmml">∈</mo><msub id="alg1.l10.m1.2.2.1.4" xref="alg1.l10.m1.2.2.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.2.2.1.4.2" xref="alg1.l10.m1.2.2.1.4.2.cmml">𝒞</mi><mi id="alg1.l10.m1.2.2.1.4.3" xref="alg1.l10.m1.2.2.1.4.3.cmml">k</mi></msub></mrow></msub><msub id="alg1.l10.m1.3.4.3.2.2" xref="alg1.l10.m1.3.4.3.2.2.cmml"><mi id="alg1.l10.m1.3.4.3.2.2.2" xref="alg1.l10.m1.3.4.3.2.2.2.cmml">P</mi><msubsup id="alg1.l10.m1.3.3.1" xref="alg1.l10.m1.3.3.1.cmml"><mi id="alg1.l10.m1.3.3.1.3.2" xref="alg1.l10.m1.3.3.1.3.2.cmml">w</mi><mi id="alg1.l10.m1.3.3.1.3.3" xref="alg1.l10.m1.3.3.1.3.3.cmml">i</mi><mrow id="alg1.l10.m1.3.3.1.1.1.3" xref="alg1.l10.m1.3.3.1.cmml"><mo stretchy="false" id="alg1.l10.m1.3.3.1.1.1.3.1" xref="alg1.l10.m1.3.3.1.cmml">(</mo><mi id="alg1.l10.m1.3.3.1.1.1.1" xref="alg1.l10.m1.3.3.1.1.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l10.m1.3.3.1.1.1.3.2" xref="alg1.l10.m1.3.3.1.cmml">)</mo></mrow></msubsup></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.3b"><apply id="alg1.l10.m1.3.4.cmml" xref="alg1.l10.m1.3.4"><ci id="alg1.l10.m1.3.4.1.cmml" xref="alg1.l10.m1.3.4.1">←</ci><apply id="alg1.l10.m1.3.4.2.cmml" xref="alg1.l10.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l10.m1.3.4.2.1.cmml" xref="alg1.l10.m1.3.4.2">subscript</csymbol><ci id="alg1.l10.m1.3.4.2.2.cmml" xref="alg1.l10.m1.3.4.2.2">𝑃</ci><apply id="alg1.l10.m1.3.4.2.3.cmml" xref="alg1.l10.m1.3.4.2.3"><csymbol cd="ambiguous" id="alg1.l10.m1.3.4.2.3.1.cmml" xref="alg1.l10.m1.3.4.2.3">subscript</csymbol><ci id="alg1.l10.m1.3.4.2.3.2.cmml" xref="alg1.l10.m1.3.4.2.3.2">𝒞</ci><ci id="alg1.l10.m1.3.4.2.3.3.cmml" xref="alg1.l10.m1.3.4.2.3.3">𝑘</ci></apply></apply><apply id="alg1.l10.m1.3.4.3.cmml" xref="alg1.l10.m1.3.4.3"><times id="alg1.l10.m1.3.4.3.1.cmml" xref="alg1.l10.m1.3.4.3.1"></times><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><divide id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1"></divide><cn type="integer" id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">1</cn><apply id="alg1.l10.m1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1"><abs id="alg1.l10.m1.1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.2"></abs><apply id="alg1.l10.m1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.2">𝒞</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="alg1.l10.m1.3.4.3.2.cmml" xref="alg1.l10.m1.3.4.3.2"><apply id="alg1.l10.m1.3.4.3.2.1.cmml" xref="alg1.l10.m1.3.4.3.2.1"><csymbol cd="ambiguous" id="alg1.l10.m1.3.4.3.2.1.1.cmml" xref="alg1.l10.m1.3.4.3.2.1">subscript</csymbol><sum id="alg1.l10.m1.3.4.3.2.1.2.cmml" xref="alg1.l10.m1.3.4.3.2.1.2"></sum><apply id="alg1.l10.m1.2.2.1.cmml" xref="alg1.l10.m1.2.2.1"><in id="alg1.l10.m1.2.2.1.2.cmml" xref="alg1.l10.m1.2.2.1.2"></in><apply id="alg1.l10.m1.2.2.1.3.cmml" xref="alg1.l10.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.1.3.1.cmml" xref="alg1.l10.m1.2.2.1.3">superscript</csymbol><apply id="alg1.l10.m1.2.2.1.3.2.cmml" xref="alg1.l10.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.1.3.2.1.cmml" xref="alg1.l10.m1.2.2.1.3">subscript</csymbol><ci id="alg1.l10.m1.2.2.1.3.2.2.cmml" xref="alg1.l10.m1.2.2.1.3.2.2">𝑤</ci><ci id="alg1.l10.m1.2.2.1.3.2.3.cmml" xref="alg1.l10.m1.2.2.1.3.2.3">𝑖</ci></apply><ci id="alg1.l10.m1.2.2.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1">𝑟</ci></apply><apply id="alg1.l10.m1.2.2.1.4.cmml" xref="alg1.l10.m1.2.2.1.4"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.1.4.1.cmml" xref="alg1.l10.m1.2.2.1.4">subscript</csymbol><ci id="alg1.l10.m1.2.2.1.4.2.cmml" xref="alg1.l10.m1.2.2.1.4.2">𝒞</ci><ci id="alg1.l10.m1.2.2.1.4.3.cmml" xref="alg1.l10.m1.2.2.1.4.3">𝑘</ci></apply></apply></apply><apply id="alg1.l10.m1.3.4.3.2.2.cmml" xref="alg1.l10.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.3.4.3.2.2.1.cmml" xref="alg1.l10.m1.3.4.3.2.2">subscript</csymbol><ci id="alg1.l10.m1.3.4.3.2.2.2.cmml" xref="alg1.l10.m1.3.4.3.2.2.2">𝑃</ci><apply id="alg1.l10.m1.3.3.1.cmml" xref="alg1.l10.m1.3.3.1"><csymbol cd="ambiguous" id="alg1.l10.m1.3.3.1.2.cmml" xref="alg1.l10.m1.3.3.1">superscript</csymbol><apply id="alg1.l10.m1.3.3.1.3.cmml" xref="alg1.l10.m1.3.3.1"><csymbol cd="ambiguous" id="alg1.l10.m1.3.3.1.3.1.cmml" xref="alg1.l10.m1.3.3.1">subscript</csymbol><ci id="alg1.l10.m1.3.3.1.3.2.cmml" xref="alg1.l10.m1.3.3.1.3.2">𝑤</ci><ci id="alg1.l10.m1.3.3.1.3.3.cmml" xref="alg1.l10.m1.3.3.1.3.3">𝑖</ci></apply><ci id="alg1.l10.m1.3.3.1.1.1.1.cmml" xref="alg1.l10.m1.3.3.1.1.1.1">𝑟</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.3c">P_{\mathcal{C}_{k}}\leftarrow\frac{1}{|\mathcal{C}_{k}|}\sum_{w_{i}^{(r)}\in\mathcal{C}_{k}}P_{w_{i}^{(r)}}</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <span id="alg1.l11.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>     <math id="alg1.l12.m1.1" class="ltx_Math" alttext="\alpha_{k}\leftarrow\text{argmin}\|\sum_{k=1}^{K}\alpha_{k}P_{\mathcal{C}_{k}}-I\|_{2}" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msub id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml">α</mi><mi id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">←</mo><mrow id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml"><mtext id="alg1.l12.m1.1.1.1.3" xref="alg1.l12.m1.1.1.1.3a.cmml">argmin</mtext><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><msub id="alg1.l12.m1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.cmml"><mrow id="alg1.l12.m1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l12.m1.1.1.1.1.1.1.2" xref="alg1.l12.m1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="alg1.l12.m1.1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.1.cmml"><mrow id="alg1.l12.m1.1.1.1.1.1.1.1.2" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.cmml"><msubsup id="alg1.l12.m1.1.1.1.1.1.1.1.2.1" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.cmml"><mo lspace="0em" id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.2" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.2" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.2.cmml">k</mi><mo id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.1" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.3" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.3" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.3.cmml">K</mi></msubsup><mrow id="alg1.l12.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.cmml"><msub id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2.2.cmml">α</mi><mi id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.1" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.1.cmml">​</mo><msub id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.2" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.2.cmml">P</mi><msub id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3.2" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3.2.cmml">𝒞</mi><mi id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3.3" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3.3.cmml">k</mi></msub></msub></mrow></mrow><mo id="alg1.l12.m1.1.1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l12.m1.1.1.1.1.1.1.1.3" xref="alg1.l12.m1.1.1.1.1.1.1.1.3.cmml">I</mi></mrow><mo stretchy="false" id="alg1.l12.m1.1.1.1.1.1.1.3" xref="alg1.l12.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="alg1.l12.m1.1.1.1.1.3" xref="alg1.l12.m1.1.1.1.1.3.cmml">2</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">←</ci><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2">𝛼</ci><ci id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3">𝑘</ci></apply><apply id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"><times id="alg1.l12.m1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.2"></times><ci id="alg1.l12.m1.1.1.1.3a.cmml" xref="alg1.l12.m1.1.1.1.3"><mtext id="alg1.l12.m1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.3">argmin</mtext></ci><apply id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l12.m1.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l12.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="alg1.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1"><minus id="alg1.l12.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.1"></minus><apply id="alg1.l12.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2"><apply id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.2"></sum><apply id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3"><eq id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.1"></eq><ci id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="alg1.l12.m1.1.1.1.1.1.1.1.2.1.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.1.3">𝐾</ci></apply><apply id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2"><times id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.1"></times><apply id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2.2">𝛼</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply><apply id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.2">𝑃</ci><apply id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3.2">𝒞</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.2.2.3.3.3">𝑘</ci></apply></apply></apply></apply><ci id="alg1.l12.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1.3">𝐼</ci></apply></apply><cn type="integer" id="alg1.l12.m1.1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\alpha_{k}\leftarrow\text{argmin}\|\sum_{k=1}^{K}\alpha_{k}P_{\mathcal{C}_{k}}-I\|_{2}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>     <math id="alg1.l13.m1.1" class="ltx_Math" alttext="\beta_{i}\leftarrow\frac{\alpha_{k}}{\lvert\mathcal{C}_{k}\rvert}" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.2" xref="alg1.l13.m1.1.2.cmml"><msub id="alg1.l13.m1.1.2.2" xref="alg1.l13.m1.1.2.2.cmml"><mi id="alg1.l13.m1.1.2.2.2" xref="alg1.l13.m1.1.2.2.2.cmml">β</mi><mi id="alg1.l13.m1.1.2.2.3" xref="alg1.l13.m1.1.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l13.m1.1.2.1" xref="alg1.l13.m1.1.2.1.cmml">←</mo><mfrac id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><msub id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">α</mi><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">k</mi></msub><mrow id="alg1.l13.m1.1.1.1.1" xref="alg1.l13.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l13.m1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.2.1.cmml">|</mo><msub id="alg1.l13.m1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.2.cmml">𝒞</mi><mi id="alg1.l13.m1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l13.m1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.2.cmml" xref="alg1.l13.m1.1.2"><ci id="alg1.l13.m1.1.2.1.cmml" xref="alg1.l13.m1.1.2.1">←</ci><apply id="alg1.l13.m1.1.2.2.cmml" xref="alg1.l13.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.2.2.1.cmml" xref="alg1.l13.m1.1.2.2">subscript</csymbol><ci id="alg1.l13.m1.1.2.2.2.cmml" xref="alg1.l13.m1.1.2.2.2">𝛽</ci><ci id="alg1.l13.m1.1.2.2.3.cmml" xref="alg1.l13.m1.1.2.2.3">𝑖</ci></apply><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><divide id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1"></divide><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">𝛼</ci><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">𝑘</ci></apply><apply id="alg1.l13.m1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1"><abs id="alg1.l13.m1.1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.1.1.2"></abs><apply id="alg1.l13.m1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.2">𝒞</ci><ci id="alg1.l13.m1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\beta_{i}\leftarrow\frac{\alpha_{k}}{\lvert\mathcal{C}_{k}\rvert}</annotation></semantics></math> if <math id="alg1.l13.m2.1" class="ltx_Math" alttext="w_{i}^{(r)}\in\mathcal{C}_{k}" display="inline"><semantics id="alg1.l13.m2.1a"><mrow id="alg1.l13.m2.1.2" xref="alg1.l13.m2.1.2.cmml"><msubsup id="alg1.l13.m2.1.2.2" xref="alg1.l13.m2.1.2.2.cmml"><mi id="alg1.l13.m2.1.2.2.2.2" xref="alg1.l13.m2.1.2.2.2.2.cmml">w</mi><mi id="alg1.l13.m2.1.2.2.2.3" xref="alg1.l13.m2.1.2.2.2.3.cmml">i</mi><mrow id="alg1.l13.m2.1.1.1.3" xref="alg1.l13.m2.1.2.2.cmml"><mo stretchy="false" id="alg1.l13.m2.1.1.1.3.1" xref="alg1.l13.m2.1.2.2.cmml">(</mo><mi id="alg1.l13.m2.1.1.1.1" xref="alg1.l13.m2.1.1.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l13.m2.1.1.1.3.2" xref="alg1.l13.m2.1.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l13.m2.1.2.1" xref="alg1.l13.m2.1.2.1.cmml">∈</mo><msub id="alg1.l13.m2.1.2.3" xref="alg1.l13.m2.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m2.1.2.3.2" xref="alg1.l13.m2.1.2.3.2.cmml">𝒞</mi><mi id="alg1.l13.m2.1.2.3.3" xref="alg1.l13.m2.1.2.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><apply id="alg1.l13.m2.1.2.cmml" xref="alg1.l13.m2.1.2"><in id="alg1.l13.m2.1.2.1.cmml" xref="alg1.l13.m2.1.2.1"></in><apply id="alg1.l13.m2.1.2.2.cmml" xref="alg1.l13.m2.1.2.2"><csymbol cd="ambiguous" id="alg1.l13.m2.1.2.2.1.cmml" xref="alg1.l13.m2.1.2.2">superscript</csymbol><apply id="alg1.l13.m2.1.2.2.2.cmml" xref="alg1.l13.m2.1.2.2"><csymbol cd="ambiguous" id="alg1.l13.m2.1.2.2.2.1.cmml" xref="alg1.l13.m2.1.2.2">subscript</csymbol><ci id="alg1.l13.m2.1.2.2.2.2.cmml" xref="alg1.l13.m2.1.2.2.2.2">𝑤</ci><ci id="alg1.l13.m2.1.2.2.2.3.cmml" xref="alg1.l13.m2.1.2.2.2.3">𝑖</ci></apply><ci id="alg1.l13.m2.1.1.1.1.cmml" xref="alg1.l13.m2.1.1.1.1">𝑟</ci></apply><apply id="alg1.l13.m2.1.2.3.cmml" xref="alg1.l13.m2.1.2.3"><csymbol cd="ambiguous" id="alg1.l13.m2.1.2.3.1.cmml" xref="alg1.l13.m2.1.2.3">subscript</csymbol><ci id="alg1.l13.m2.1.2.3.2.cmml" xref="alg1.l13.m2.1.2.3.2">𝒞</ci><ci id="alg1.l13.m2.1.2.3.3.cmml" xref="alg1.l13.m2.1.2.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">w_{i}^{(r)}\in\mathcal{C}_{k}</annotation></semantics></math> for each <math id="alg1.l13.m3.1" class="ltx_Math" alttext="w_{i}^{(r)}" display="inline"><semantics id="alg1.l13.m3.1a"><msubsup id="alg1.l13.m3.1.2" xref="alg1.l13.m3.1.2.cmml"><mi id="alg1.l13.m3.1.2.2.2" xref="alg1.l13.m3.1.2.2.2.cmml">w</mi><mi id="alg1.l13.m3.1.2.2.3" xref="alg1.l13.m3.1.2.2.3.cmml">i</mi><mrow id="alg1.l13.m3.1.1.1.3" xref="alg1.l13.m3.1.2.cmml"><mo stretchy="false" id="alg1.l13.m3.1.1.1.3.1" xref="alg1.l13.m3.1.2.cmml">(</mo><mi id="alg1.l13.m3.1.1.1.1" xref="alg1.l13.m3.1.1.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l13.m3.1.1.1.3.2" xref="alg1.l13.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l13.m3.1b"><apply id="alg1.l13.m3.1.2.cmml" xref="alg1.l13.m3.1.2"><csymbol cd="ambiguous" id="alg1.l13.m3.1.2.1.cmml" xref="alg1.l13.m3.1.2">superscript</csymbol><apply id="alg1.l13.m3.1.2.2.cmml" xref="alg1.l13.m3.1.2"><csymbol cd="ambiguous" id="alg1.l13.m3.1.2.2.1.cmml" xref="alg1.l13.m3.1.2">subscript</csymbol><ci id="alg1.l13.m3.1.2.2.2.cmml" xref="alg1.l13.m3.1.2.2.2">𝑤</ci><ci id="alg1.l13.m3.1.2.2.3.cmml" xref="alg1.l13.m3.1.2.2.3">𝑖</ci></apply><ci id="alg1.l13.m3.1.1.1.1.cmml" xref="alg1.l13.m3.1.1.1.1">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m3.1c">w_{i}^{(r)}</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     <math id="alg1.l14.m1.1" class="ltx_Math" alttext="\beta_{i}\leftarrow\frac{\beta_{i}}{\sum_{i}^{|U|}\beta_{i}}" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.2" xref="alg1.l14.m1.1.2.cmml"><msub id="alg1.l14.m1.1.2.2" xref="alg1.l14.m1.1.2.2.cmml"><mi id="alg1.l14.m1.1.2.2.2" xref="alg1.l14.m1.1.2.2.2.cmml">β</mi><mi id="alg1.l14.m1.1.2.2.3" xref="alg1.l14.m1.1.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l14.m1.1.2.1" xref="alg1.l14.m1.1.2.1.cmml">←</mo><mfrac id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><msub id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml">β</mi><mi id="alg1.l14.m1.1.1.3.3" xref="alg1.l14.m1.1.1.3.3.cmml">i</mi></msub><mrow id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml"><mstyle displaystyle="false" id="alg1.l14.m1.1.1.1.2" xref="alg1.l14.m1.1.1.1.2.cmml"><msubsup id="alg1.l14.m1.1.1.1.2a" xref="alg1.l14.m1.1.1.1.2.cmml"><mo id="alg1.l14.m1.1.1.1.2.2.2" xref="alg1.l14.m1.1.1.1.2.2.2.cmml">∑</mo><mi id="alg1.l14.m1.1.1.1.2.2.3" xref="alg1.l14.m1.1.1.1.2.2.3.cmml">i</mi><mrow id="alg1.l14.m1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.1.3.1" xref="alg1.l14.m1.1.1.1.1.1.2.1.cmml">|</mo><mi id="alg1.l14.m1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.cmml">U</mi><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.1.3.2" xref="alg1.l14.m1.1.1.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mstyle><msub id="alg1.l14.m1.1.1.1.3" xref="alg1.l14.m1.1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.1.3.2" xref="alg1.l14.m1.1.1.1.3.2.cmml">β</mi><mi id="alg1.l14.m1.1.1.1.3.3" xref="alg1.l14.m1.1.1.1.3.3.cmml">i</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.2.cmml" xref="alg1.l14.m1.1.2"><ci id="alg1.l14.m1.1.2.1.cmml" xref="alg1.l14.m1.1.2.1">←</ci><apply id="alg1.l14.m1.1.2.2.cmml" xref="alg1.l14.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.2.2.1.cmml" xref="alg1.l14.m1.1.2.2">subscript</csymbol><ci id="alg1.l14.m1.1.2.2.2.cmml" xref="alg1.l14.m1.1.2.2.2">𝛽</ci><ci id="alg1.l14.m1.1.2.2.3.cmml" xref="alg1.l14.m1.1.2.2.3">𝑖</ci></apply><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><divide id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1"></divide><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2">𝛽</ci><ci id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3">𝑖</ci></apply><apply id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"><apply id="alg1.l14.m1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.2">superscript</csymbol><apply id="alg1.l14.m1.1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.2.2.1.cmml" xref="alg1.l14.m1.1.1.1.2">subscript</csymbol><sum id="alg1.l14.m1.1.1.1.2.2.2.cmml" xref="alg1.l14.m1.1.1.1.2.2.2"></sum><ci id="alg1.l14.m1.1.1.1.2.2.3.cmml" xref="alg1.l14.m1.1.1.1.2.2.3">𝑖</ci></apply><apply id="alg1.l14.m1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.3"><abs id="alg1.l14.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.3.1"></abs><ci id="alg1.l14.m1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1">𝑈</ci></apply></apply><apply id="alg1.l14.m1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.1.3.2">𝛽</ci><ci id="alg1.l14.m1.1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">\beta_{i}\leftarrow\frac{\beta_{i}}{\sum_{i}^{|U|}\beta_{i}}</annotation></semantics></math> for each <math id="alg1.l14.m2.1" class="ltx_Math" alttext="\beta_{i}" display="inline"><semantics id="alg1.l14.m2.1a"><msub id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml"><mi id="alg1.l14.m2.1.1.2" xref="alg1.l14.m2.1.1.2.cmml">β</mi><mi id="alg1.l14.m2.1.1.3" xref="alg1.l14.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b"><apply id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1"><csymbol cd="ambiguous" id="alg1.l14.m2.1.1.1.cmml" xref="alg1.l14.m2.1.1">subscript</csymbol><ci id="alg1.l14.m2.1.1.2.cmml" xref="alg1.l14.m2.1.1.2">𝛽</ci><ci id="alg1.l14.m2.1.1.3.cmml" xref="alg1.l14.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.1c">\beta_{i}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>     <math id="alg1.l15.m1.3" class="ltx_Math" alttext="w^{(r+1)}\leftarrow\sum_{i}^{|U|}\beta_{i}w_{i}^{(r)}" display="inline"><semantics id="alg1.l15.m1.3a"><mrow id="alg1.l15.m1.3.4" xref="alg1.l15.m1.3.4.cmml"><msup id="alg1.l15.m1.3.4.2" xref="alg1.l15.m1.3.4.2.cmml"><mi id="alg1.l15.m1.3.4.2.2" xref="alg1.l15.m1.3.4.2.2.cmml">w</mi><mrow id="alg1.l15.m1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l15.m1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.2.cmml">r</mi><mo id="alg1.l15.m1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.l15.m1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo rspace="0.111em" stretchy="false" id="alg1.l15.m1.3.4.1" xref="alg1.l15.m1.3.4.1.cmml">←</mo><mrow id="alg1.l15.m1.3.4.3" xref="alg1.l15.m1.3.4.3.cmml"><msubsup id="alg1.l15.m1.3.4.3.1" xref="alg1.l15.m1.3.4.3.1.cmml"><mo id="alg1.l15.m1.3.4.3.1.2.2" xref="alg1.l15.m1.3.4.3.1.2.2.cmml">∑</mo><mi id="alg1.l15.m1.3.4.3.1.2.3" xref="alg1.l15.m1.3.4.3.1.2.3.cmml">i</mi><mrow id="alg1.l15.m1.2.2.1.3" xref="alg1.l15.m1.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l15.m1.2.2.1.3.1" xref="alg1.l15.m1.2.2.1.2.1.cmml">|</mo><mi id="alg1.l15.m1.2.2.1.1" xref="alg1.l15.m1.2.2.1.1.cmml">U</mi><mo stretchy="false" id="alg1.l15.m1.2.2.1.3.2" xref="alg1.l15.m1.2.2.1.2.1.cmml">|</mo></mrow></msubsup><mrow id="alg1.l15.m1.3.4.3.2" xref="alg1.l15.m1.3.4.3.2.cmml"><msub id="alg1.l15.m1.3.4.3.2.2" xref="alg1.l15.m1.3.4.3.2.2.cmml"><mi id="alg1.l15.m1.3.4.3.2.2.2" xref="alg1.l15.m1.3.4.3.2.2.2.cmml">β</mi><mi id="alg1.l15.m1.3.4.3.2.2.3" xref="alg1.l15.m1.3.4.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l15.m1.3.4.3.2.1" xref="alg1.l15.m1.3.4.3.2.1.cmml">​</mo><msubsup id="alg1.l15.m1.3.4.3.2.3" xref="alg1.l15.m1.3.4.3.2.3.cmml"><mi id="alg1.l15.m1.3.4.3.2.3.2.2" xref="alg1.l15.m1.3.4.3.2.3.2.2.cmml">w</mi><mi id="alg1.l15.m1.3.4.3.2.3.2.3" xref="alg1.l15.m1.3.4.3.2.3.2.3.cmml">i</mi><mrow id="alg1.l15.m1.3.3.1.3" xref="alg1.l15.m1.3.4.3.2.3.cmml"><mo stretchy="false" id="alg1.l15.m1.3.3.1.3.1" xref="alg1.l15.m1.3.4.3.2.3.cmml">(</mo><mi id="alg1.l15.m1.3.3.1.1" xref="alg1.l15.m1.3.3.1.1.cmml">r</mi><mo stretchy="false" id="alg1.l15.m1.3.3.1.3.2" xref="alg1.l15.m1.3.4.3.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.3b"><apply id="alg1.l15.m1.3.4.cmml" xref="alg1.l15.m1.3.4"><ci id="alg1.l15.m1.3.4.1.cmml" xref="alg1.l15.m1.3.4.1">←</ci><apply id="alg1.l15.m1.3.4.2.cmml" xref="alg1.l15.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l15.m1.3.4.2.1.cmml" xref="alg1.l15.m1.3.4.2">superscript</csymbol><ci id="alg1.l15.m1.3.4.2.2.cmml" xref="alg1.l15.m1.3.4.2.2">𝑤</ci><apply id="alg1.l15.m1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1"><plus id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1"></plus><ci id="alg1.l15.m1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.2">𝑟</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg1.l15.m1.3.4.3.cmml" xref="alg1.l15.m1.3.4.3"><apply id="alg1.l15.m1.3.4.3.1.cmml" xref="alg1.l15.m1.3.4.3.1"><csymbol cd="ambiguous" id="alg1.l15.m1.3.4.3.1.1.cmml" xref="alg1.l15.m1.3.4.3.1">superscript</csymbol><apply id="alg1.l15.m1.3.4.3.1.2.cmml" xref="alg1.l15.m1.3.4.3.1"><csymbol cd="ambiguous" id="alg1.l15.m1.3.4.3.1.2.1.cmml" xref="alg1.l15.m1.3.4.3.1">subscript</csymbol><sum id="alg1.l15.m1.3.4.3.1.2.2.cmml" xref="alg1.l15.m1.3.4.3.1.2.2"></sum><ci id="alg1.l15.m1.3.4.3.1.2.3.cmml" xref="alg1.l15.m1.3.4.3.1.2.3">𝑖</ci></apply><apply id="alg1.l15.m1.2.2.1.2.cmml" xref="alg1.l15.m1.2.2.1.3"><abs id="alg1.l15.m1.2.2.1.2.1.cmml" xref="alg1.l15.m1.2.2.1.3.1"></abs><ci id="alg1.l15.m1.2.2.1.1.cmml" xref="alg1.l15.m1.2.2.1.1">𝑈</ci></apply></apply><apply id="alg1.l15.m1.3.4.3.2.cmml" xref="alg1.l15.m1.3.4.3.2"><times id="alg1.l15.m1.3.4.3.2.1.cmml" xref="alg1.l15.m1.3.4.3.2.1"></times><apply id="alg1.l15.m1.3.4.3.2.2.cmml" xref="alg1.l15.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.3.4.3.2.2.1.cmml" xref="alg1.l15.m1.3.4.3.2.2">subscript</csymbol><ci id="alg1.l15.m1.3.4.3.2.2.2.cmml" xref="alg1.l15.m1.3.4.3.2.2.2">𝛽</ci><ci id="alg1.l15.m1.3.4.3.2.2.3.cmml" xref="alg1.l15.m1.3.4.3.2.2.3">𝑖</ci></apply><apply id="alg1.l15.m1.3.4.3.2.3.cmml" xref="alg1.l15.m1.3.4.3.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.3.4.3.2.3.1.cmml" xref="alg1.l15.m1.3.4.3.2.3">superscript</csymbol><apply id="alg1.l15.m1.3.4.3.2.3.2.cmml" xref="alg1.l15.m1.3.4.3.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.3.4.3.2.3.2.1.cmml" xref="alg1.l15.m1.3.4.3.2.3">subscript</csymbol><ci id="alg1.l15.m1.3.4.3.2.3.2.2.cmml" xref="alg1.l15.m1.3.4.3.2.3.2.2">𝑤</ci><ci id="alg1.l15.m1.3.4.3.2.3.2.3.cmml" xref="alg1.l15.m1.3.4.3.2.3.2.3">𝑖</ci></apply><ci id="alg1.l15.m1.3.3.1.1.cmml" xref="alg1.l15.m1.3.3.1.1">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.3c">w^{(r+1)}\leftarrow\sum_{i}^{|U|}\beta_{i}w_{i}^{(r)}</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span><span id="alg1.l16.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l16.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Client Clustering</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.14" class="ltx_p">Consider the local model in the <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">i</annotation></semantics></math>-th client from the <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">r</annotation></semantics></math>-th training round, denoted as <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="w_{i}^{(r)}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><msubsup id="S4.SS2.p1.3.m3.1.2" xref="S4.SS2.p1.3.m3.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.2.2.2" xref="S4.SS2.p1.3.m3.1.2.2.2.cmml">w</mi><mi id="S4.SS2.p1.3.m3.1.2.2.3" xref="S4.SS2.p1.3.m3.1.2.2.3.cmml">i</mi><mrow id="S4.SS2.p1.3.m3.1.1.1.3" xref="S4.SS2.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1.3.1" xref="S4.SS2.p1.3.m3.1.2.cmml">(</mo><mi id="S4.SS2.p1.3.m3.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1.3.2" xref="S4.SS2.p1.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.2.cmml" xref="S4.SS2.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.2">superscript</csymbol><apply id="S4.SS2.p1.3.m3.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.2.2.1.cmml" xref="S4.SS2.p1.3.m3.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.2.2.2.cmml" xref="S4.SS2.p1.3.m3.1.2.2.2">𝑤</ci><ci id="S4.SS2.p1.3.m3.1.2.2.3.cmml" xref="S4.SS2.p1.3.m3.1.2.2.3">𝑖</ci></apply><ci id="S4.SS2.p1.3.m3.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">w_{i}^{(r)}</annotation></semantics></math>. The associated mapping function from the feature space to the output space is represented as <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="f_{w_{i}^{(r)}}" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><msub id="S4.SS2.p1.4.m4.1.2" xref="S4.SS2.p1.4.m4.1.2.cmml"><mi id="S4.SS2.p1.4.m4.1.2.2" xref="S4.SS2.p1.4.m4.1.2.2.cmml">f</mi><msubsup id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.1.3.2" xref="S4.SS2.p1.4.m4.1.1.1.3.2.cmml">w</mi><mi id="S4.SS2.p1.4.m4.1.1.1.3.3" xref="S4.SS2.p1.4.m4.1.1.1.3.3.cmml">i</mi><mrow id="S4.SS2.p1.4.m4.1.1.1.1.1.3" xref="S4.SS2.p1.4.m4.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m4.1.1.1.1.1.3.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">(</mo><mi id="S4.SS2.p1.4.m4.1.1.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.SS2.p1.4.m4.1.1.1.1.1.3.2" xref="S4.SS2.p1.4.m4.1.1.1.cmml">)</mo></mrow></msubsup></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.2.cmml" xref="S4.SS2.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.2.1.cmml" xref="S4.SS2.p1.4.m4.1.2">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.2.2.cmml" xref="S4.SS2.p1.4.m4.1.2.2">𝑓</ci><apply id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1">superscript</csymbol><apply id="S4.SS2.p1.4.m4.1.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.1.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.3.2">𝑤</ci><ci id="S4.SS2.p1.4.m4.1.1.1.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1.3.3">𝑖</ci></apply><ci id="S4.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1.1">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">f_{w_{i}^{(r)}}</annotation></semantics></math>.
Given an input sample <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">x</annotation></semantics></math>, the output probability vector is denoted as <math id="S4.SS2.p1.6.m6.3" class="ltx_Math" alttext="p(x)=f_{w_{i}^{(r)}}(x)" display="inline"><semantics id="S4.SS2.p1.6.m6.3a"><mrow id="S4.SS2.p1.6.m6.3.4" xref="S4.SS2.p1.6.m6.3.4.cmml"><mrow id="S4.SS2.p1.6.m6.3.4.2" xref="S4.SS2.p1.6.m6.3.4.2.cmml"><mi id="S4.SS2.p1.6.m6.3.4.2.2" xref="S4.SS2.p1.6.m6.3.4.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.6.m6.3.4.2.1" xref="S4.SS2.p1.6.m6.3.4.2.1.cmml">​</mo><mrow id="S4.SS2.p1.6.m6.3.4.2.3.2" xref="S4.SS2.p1.6.m6.3.4.2.cmml"><mo stretchy="false" id="S4.SS2.p1.6.m6.3.4.2.3.2.1" xref="S4.SS2.p1.6.m6.3.4.2.cmml">(</mo><mi id="S4.SS2.p1.6.m6.2.2" xref="S4.SS2.p1.6.m6.2.2.cmml">x</mi><mo stretchy="false" id="S4.SS2.p1.6.m6.3.4.2.3.2.2" xref="S4.SS2.p1.6.m6.3.4.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.6.m6.3.4.1" xref="S4.SS2.p1.6.m6.3.4.1.cmml">=</mo><mrow id="S4.SS2.p1.6.m6.3.4.3" xref="S4.SS2.p1.6.m6.3.4.3.cmml"><msub id="S4.SS2.p1.6.m6.3.4.3.2" xref="S4.SS2.p1.6.m6.3.4.3.2.cmml"><mi id="S4.SS2.p1.6.m6.3.4.3.2.2" xref="S4.SS2.p1.6.m6.3.4.3.2.2.cmml">f</mi><msubsup id="S4.SS2.p1.6.m6.1.1.1" xref="S4.SS2.p1.6.m6.1.1.1.cmml"><mi id="S4.SS2.p1.6.m6.1.1.1.3.2" xref="S4.SS2.p1.6.m6.1.1.1.3.2.cmml">w</mi><mi id="S4.SS2.p1.6.m6.1.1.1.3.3" xref="S4.SS2.p1.6.m6.1.1.1.3.3.cmml">i</mi><mrow id="S4.SS2.p1.6.m6.1.1.1.1.1.3" xref="S4.SS2.p1.6.m6.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.6.m6.1.1.1.1.1.3.1" xref="S4.SS2.p1.6.m6.1.1.1.cmml">(</mo><mi id="S4.SS2.p1.6.m6.1.1.1.1.1.1" xref="S4.SS2.p1.6.m6.1.1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.SS2.p1.6.m6.1.1.1.1.1.3.2" xref="S4.SS2.p1.6.m6.1.1.1.cmml">)</mo></mrow></msubsup></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.6.m6.3.4.3.1" xref="S4.SS2.p1.6.m6.3.4.3.1.cmml">​</mo><mrow id="S4.SS2.p1.6.m6.3.4.3.3.2" xref="S4.SS2.p1.6.m6.3.4.3.cmml"><mo stretchy="false" id="S4.SS2.p1.6.m6.3.4.3.3.2.1" xref="S4.SS2.p1.6.m6.3.4.3.cmml">(</mo><mi id="S4.SS2.p1.6.m6.3.3" xref="S4.SS2.p1.6.m6.3.3.cmml">x</mi><mo stretchy="false" id="S4.SS2.p1.6.m6.3.4.3.3.2.2" xref="S4.SS2.p1.6.m6.3.4.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.3b"><apply id="S4.SS2.p1.6.m6.3.4.cmml" xref="S4.SS2.p1.6.m6.3.4"><eq id="S4.SS2.p1.6.m6.3.4.1.cmml" xref="S4.SS2.p1.6.m6.3.4.1"></eq><apply id="S4.SS2.p1.6.m6.3.4.2.cmml" xref="S4.SS2.p1.6.m6.3.4.2"><times id="S4.SS2.p1.6.m6.3.4.2.1.cmml" xref="S4.SS2.p1.6.m6.3.4.2.1"></times><ci id="S4.SS2.p1.6.m6.3.4.2.2.cmml" xref="S4.SS2.p1.6.m6.3.4.2.2">𝑝</ci><ci id="S4.SS2.p1.6.m6.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2">𝑥</ci></apply><apply id="S4.SS2.p1.6.m6.3.4.3.cmml" xref="S4.SS2.p1.6.m6.3.4.3"><times id="S4.SS2.p1.6.m6.3.4.3.1.cmml" xref="S4.SS2.p1.6.m6.3.4.3.1"></times><apply id="S4.SS2.p1.6.m6.3.4.3.2.cmml" xref="S4.SS2.p1.6.m6.3.4.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.3.4.3.2.1.cmml" xref="S4.SS2.p1.6.m6.3.4.3.2">subscript</csymbol><ci id="S4.SS2.p1.6.m6.3.4.3.2.2.cmml" xref="S4.SS2.p1.6.m6.3.4.3.2.2">𝑓</ci><apply id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.1">superscript</csymbol><apply id="S4.SS2.p1.6.m6.1.1.1.3.cmml" xref="S4.SS2.p1.6.m6.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.3.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.1.3.2.cmml" xref="S4.SS2.p1.6.m6.1.1.1.3.2">𝑤</ci><ci id="S4.SS2.p1.6.m6.1.1.1.3.3.cmml" xref="S4.SS2.p1.6.m6.1.1.1.3.3">𝑖</ci></apply><ci id="S4.SS2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1.1.1.1">𝑟</ci></apply></apply><ci id="S4.SS2.p1.6.m6.3.3.cmml" xref="S4.SS2.p1.6.m6.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.3c">p(x)=f_{w_{i}^{(r)}}(x)</annotation></semantics></math>. Each component of <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="p(x)" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><mrow id="S4.SS2.p1.7.m7.1.2" xref="S4.SS2.p1.7.m7.1.2.cmml"><mi id="S4.SS2.p1.7.m7.1.2.2" xref="S4.SS2.p1.7.m7.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.7.m7.1.2.1" xref="S4.SS2.p1.7.m7.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.7.m7.1.2.3.2" xref="S4.SS2.p1.7.m7.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.7.m7.1.2.3.2.1" xref="S4.SS2.p1.7.m7.1.2.cmml">(</mo><mi id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS2.p1.7.m7.1.2.3.2.2" xref="S4.SS2.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.2.cmml" xref="S4.SS2.p1.7.m7.1.2"><times id="S4.SS2.p1.7.m7.1.2.1.cmml" xref="S4.SS2.p1.7.m7.1.2.1"></times><ci id="S4.SS2.p1.7.m7.1.2.2.cmml" xref="S4.SS2.p1.7.m7.1.2.2">𝑝</ci><ci id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">p(x)</annotation></semantics></math> represents the likelihood that the input is classified into a specific class, with the sum of all components equaling 1. To represent the capability of local models to differentiate between different attack classes, we introduce a metric called Class Probability Matrix (CPM). This metric is derived by averaging the output probabilities of all samples within each class. Specifically, for class <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><mi id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><ci id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">c</annotation></semantics></math>, the class probability vector is calculated as <math id="S4.SS2.p1.9.m9.3" class="ltx_Math" alttext="\bar{P_{c}}=\frac{1}{n_{c}}\sum_{j=1}^{n_{c}}p(x_{c,j})" display="inline"><semantics id="S4.SS2.p1.9.m9.3a"><mrow id="S4.SS2.p1.9.m9.3.3" xref="S4.SS2.p1.9.m9.3.3.cmml"><mover accent="true" id="S4.SS2.p1.9.m9.3.3.3" xref="S4.SS2.p1.9.m9.3.3.3.cmml"><msub id="S4.SS2.p1.9.m9.3.3.3.2" xref="S4.SS2.p1.9.m9.3.3.3.2.cmml"><mi id="S4.SS2.p1.9.m9.3.3.3.2.2" xref="S4.SS2.p1.9.m9.3.3.3.2.2.cmml">P</mi><mi id="S4.SS2.p1.9.m9.3.3.3.2.3" xref="S4.SS2.p1.9.m9.3.3.3.2.3.cmml">c</mi></msub><mo id="S4.SS2.p1.9.m9.3.3.3.1" xref="S4.SS2.p1.9.m9.3.3.3.1.cmml">¯</mo></mover><mo id="S4.SS2.p1.9.m9.3.3.2" xref="S4.SS2.p1.9.m9.3.3.2.cmml">=</mo><mrow id="S4.SS2.p1.9.m9.3.3.1" xref="S4.SS2.p1.9.m9.3.3.1.cmml"><mfrac id="S4.SS2.p1.9.m9.3.3.1.3" xref="S4.SS2.p1.9.m9.3.3.1.3.cmml"><mn id="S4.SS2.p1.9.m9.3.3.1.3.2" xref="S4.SS2.p1.9.m9.3.3.1.3.2.cmml">1</mn><msub id="S4.SS2.p1.9.m9.3.3.1.3.3" xref="S4.SS2.p1.9.m9.3.3.1.3.3.cmml"><mi id="S4.SS2.p1.9.m9.3.3.1.3.3.2" xref="S4.SS2.p1.9.m9.3.3.1.3.3.2.cmml">n</mi><mi id="S4.SS2.p1.9.m9.3.3.1.3.3.3" xref="S4.SS2.p1.9.m9.3.3.1.3.3.3.cmml">c</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S4.SS2.p1.9.m9.3.3.1.2" xref="S4.SS2.p1.9.m9.3.3.1.2.cmml">​</mo><mrow id="S4.SS2.p1.9.m9.3.3.1.1" xref="S4.SS2.p1.9.m9.3.3.1.1.cmml"><msubsup id="S4.SS2.p1.9.m9.3.3.1.1.2" xref="S4.SS2.p1.9.m9.3.3.1.1.2.cmml"><mo id="S4.SS2.p1.9.m9.3.3.1.1.2.2.2" xref="S4.SS2.p1.9.m9.3.3.1.1.2.2.2.cmml">∑</mo><mrow id="S4.SS2.p1.9.m9.3.3.1.1.2.2.3" xref="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.cmml"><mi id="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.2" xref="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.2.cmml">j</mi><mo id="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.1" xref="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.1.cmml">=</mo><mn id="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.3" xref="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S4.SS2.p1.9.m9.3.3.1.1.2.3" xref="S4.SS2.p1.9.m9.3.3.1.1.2.3.cmml"><mi id="S4.SS2.p1.9.m9.3.3.1.1.2.3.2" xref="S4.SS2.p1.9.m9.3.3.1.1.2.3.2.cmml">n</mi><mi id="S4.SS2.p1.9.m9.3.3.1.1.2.3.3" xref="S4.SS2.p1.9.m9.3.3.1.1.2.3.3.cmml">c</mi></msub></msubsup><mrow id="S4.SS2.p1.9.m9.3.3.1.1.1" xref="S4.SS2.p1.9.m9.3.3.1.1.1.cmml"><mi id="S4.SS2.p1.9.m9.3.3.1.1.1.3" xref="S4.SS2.p1.9.m9.3.3.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.9.m9.3.3.1.1.1.2" xref="S4.SS2.p1.9.m9.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.9.m9.3.3.1.1.1.1.1" xref="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.2" xref="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.1" xref="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.1.2" xref="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.SS2.p1.9.m9.2.2.2.4" xref="S4.SS2.p1.9.m9.2.2.2.3.cmml"><mi id="S4.SS2.p1.9.m9.1.1.1.1" xref="S4.SS2.p1.9.m9.1.1.1.1.cmml">c</mi><mo id="S4.SS2.p1.9.m9.2.2.2.4.1" xref="S4.SS2.p1.9.m9.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p1.9.m9.2.2.2.2" xref="S4.SS2.p1.9.m9.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.3" xref="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.3b"><apply id="S4.SS2.p1.9.m9.3.3.cmml" xref="S4.SS2.p1.9.m9.3.3"><eq id="S4.SS2.p1.9.m9.3.3.2.cmml" xref="S4.SS2.p1.9.m9.3.3.2"></eq><apply id="S4.SS2.p1.9.m9.3.3.3.cmml" xref="S4.SS2.p1.9.m9.3.3.3"><ci id="S4.SS2.p1.9.m9.3.3.3.1.cmml" xref="S4.SS2.p1.9.m9.3.3.3.1">¯</ci><apply id="S4.SS2.p1.9.m9.3.3.3.2.cmml" xref="S4.SS2.p1.9.m9.3.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.3.3.3.2.1.cmml" xref="S4.SS2.p1.9.m9.3.3.3.2">subscript</csymbol><ci id="S4.SS2.p1.9.m9.3.3.3.2.2.cmml" xref="S4.SS2.p1.9.m9.3.3.3.2.2">𝑃</ci><ci id="S4.SS2.p1.9.m9.3.3.3.2.3.cmml" xref="S4.SS2.p1.9.m9.3.3.3.2.3">𝑐</ci></apply></apply><apply id="S4.SS2.p1.9.m9.3.3.1.cmml" xref="S4.SS2.p1.9.m9.3.3.1"><times id="S4.SS2.p1.9.m9.3.3.1.2.cmml" xref="S4.SS2.p1.9.m9.3.3.1.2"></times><apply id="S4.SS2.p1.9.m9.3.3.1.3.cmml" xref="S4.SS2.p1.9.m9.3.3.1.3"><divide id="S4.SS2.p1.9.m9.3.3.1.3.1.cmml" xref="S4.SS2.p1.9.m9.3.3.1.3"></divide><cn type="integer" id="S4.SS2.p1.9.m9.3.3.1.3.2.cmml" xref="S4.SS2.p1.9.m9.3.3.1.3.2">1</cn><apply id="S4.SS2.p1.9.m9.3.3.1.3.3.cmml" xref="S4.SS2.p1.9.m9.3.3.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.3.3.1.3.3.1.cmml" xref="S4.SS2.p1.9.m9.3.3.1.3.3">subscript</csymbol><ci id="S4.SS2.p1.9.m9.3.3.1.3.3.2.cmml" xref="S4.SS2.p1.9.m9.3.3.1.3.3.2">𝑛</ci><ci id="S4.SS2.p1.9.m9.3.3.1.3.3.3.cmml" xref="S4.SS2.p1.9.m9.3.3.1.3.3.3">𝑐</ci></apply></apply><apply id="S4.SS2.p1.9.m9.3.3.1.1.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1"><apply id="S4.SS2.p1.9.m9.3.3.1.1.2.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.3.3.1.1.2.1.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2">superscript</csymbol><apply id="S4.SS2.p1.9.m9.3.3.1.1.2.2.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.3.3.1.1.2.2.1.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2">subscript</csymbol><sum id="S4.SS2.p1.9.m9.3.3.1.1.2.2.2.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2.2.2"></sum><apply id="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2.2.3"><eq id="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.1.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.1"></eq><ci id="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.2.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.3.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p1.9.m9.3.3.1.1.2.3.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.3.3.1.1.2.3.1.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p1.9.m9.3.3.1.1.2.3.2.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2.3.2">𝑛</ci><ci id="S4.SS2.p1.9.m9.3.3.1.1.2.3.3.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.2.3.3">𝑐</ci></apply></apply><apply id="S4.SS2.p1.9.m9.3.3.1.1.1.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.1"><times id="S4.SS2.p1.9.m9.3.3.1.1.1.2.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.1.2"></times><ci id="S4.SS2.p1.9.m9.3.3.1.1.1.3.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.1.3">𝑝</ci><apply id="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.9.m9.3.3.1.1.1.1.1.1.2">𝑥</ci><list id="S4.SS2.p1.9.m9.2.2.2.3.cmml" xref="S4.SS2.p1.9.m9.2.2.2.4"><ci id="S4.SS2.p1.9.m9.1.1.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1.1.1">𝑐</ci><ci id="S4.SS2.p1.9.m9.2.2.2.2.cmml" xref="S4.SS2.p1.9.m9.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.3c">\bar{P_{c}}=\frac{1}{n_{c}}\sum_{j=1}^{n_{c}}p(x_{c,j})</annotation></semantics></math>, where <math id="S4.SS2.p1.10.m10.1" class="ltx_Math" alttext="n_{c}" display="inline"><semantics id="S4.SS2.p1.10.m10.1a"><msub id="S4.SS2.p1.10.m10.1.1" xref="S4.SS2.p1.10.m10.1.1.cmml"><mi id="S4.SS2.p1.10.m10.1.1.2" xref="S4.SS2.p1.10.m10.1.1.2.cmml">n</mi><mi id="S4.SS2.p1.10.m10.1.1.3" xref="S4.SS2.p1.10.m10.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m10.1b"><apply id="S4.SS2.p1.10.m10.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m10.1.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS2.p1.10.m10.1.1.2.cmml" xref="S4.SS2.p1.10.m10.1.1.2">𝑛</ci><ci id="S4.SS2.p1.10.m10.1.1.3.cmml" xref="S4.SS2.p1.10.m10.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m10.1c">n_{c}</annotation></semantics></math> represents the number of data samples in class <math id="S4.SS2.p1.11.m11.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.p1.11.m11.1a"><mi id="S4.SS2.p1.11.m11.1.1" xref="S4.SS2.p1.11.m11.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m11.1b"><ci id="S4.SS2.p1.11.m11.1.1.cmml" xref="S4.SS2.p1.11.m11.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m11.1c">c</annotation></semantics></math>, and <math id="S4.SS2.p1.12.m12.2" class="ltx_Math" alttext="x_{c,j}" display="inline"><semantics id="S4.SS2.p1.12.m12.2a"><msub id="S4.SS2.p1.12.m12.2.3" xref="S4.SS2.p1.12.m12.2.3.cmml"><mi id="S4.SS2.p1.12.m12.2.3.2" xref="S4.SS2.p1.12.m12.2.3.2.cmml">x</mi><mrow id="S4.SS2.p1.12.m12.2.2.2.4" xref="S4.SS2.p1.12.m12.2.2.2.3.cmml"><mi id="S4.SS2.p1.12.m12.1.1.1.1" xref="S4.SS2.p1.12.m12.1.1.1.1.cmml">c</mi><mo id="S4.SS2.p1.12.m12.2.2.2.4.1" xref="S4.SS2.p1.12.m12.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p1.12.m12.2.2.2.2" xref="S4.SS2.p1.12.m12.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m12.2b"><apply id="S4.SS2.p1.12.m12.2.3.cmml" xref="S4.SS2.p1.12.m12.2.3"><csymbol cd="ambiguous" id="S4.SS2.p1.12.m12.2.3.1.cmml" xref="S4.SS2.p1.12.m12.2.3">subscript</csymbol><ci id="S4.SS2.p1.12.m12.2.3.2.cmml" xref="S4.SS2.p1.12.m12.2.3.2">𝑥</ci><list id="S4.SS2.p1.12.m12.2.2.2.3.cmml" xref="S4.SS2.p1.12.m12.2.2.2.4"><ci id="S4.SS2.p1.12.m12.1.1.1.1.cmml" xref="S4.SS2.p1.12.m12.1.1.1.1">𝑐</ci><ci id="S4.SS2.p1.12.m12.2.2.2.2.cmml" xref="S4.SS2.p1.12.m12.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m12.2c">x_{c,j}</annotation></semantics></math> is the <math id="S4.SS2.p1.13.m13.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS2.p1.13.m13.1a"><mi id="S4.SS2.p1.13.m13.1.1" xref="S4.SS2.p1.13.m13.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m13.1b"><ci id="S4.SS2.p1.13.m13.1.1.cmml" xref="S4.SS2.p1.13.m13.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.13.m13.1c">j</annotation></semantics></math>-th data sample of that class. Finally, by concatenating the class probability vectors for all classes, we construct the CPM for a local model <math id="S4.SS2.p1.14.m14.1" class="ltx_Math" alttext="w_{i}^{(r)}" display="inline"><semantics id="S4.SS2.p1.14.m14.1a"><msubsup id="S4.SS2.p1.14.m14.1.2" xref="S4.SS2.p1.14.m14.1.2.cmml"><mi id="S4.SS2.p1.14.m14.1.2.2.2" xref="S4.SS2.p1.14.m14.1.2.2.2.cmml">w</mi><mi id="S4.SS2.p1.14.m14.1.2.2.3" xref="S4.SS2.p1.14.m14.1.2.2.3.cmml">i</mi><mrow id="S4.SS2.p1.14.m14.1.1.1.3" xref="S4.SS2.p1.14.m14.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.14.m14.1.1.1.3.1" xref="S4.SS2.p1.14.m14.1.2.cmml">(</mo><mi id="S4.SS2.p1.14.m14.1.1.1.1" xref="S4.SS2.p1.14.m14.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.SS2.p1.14.m14.1.1.1.3.2" xref="S4.SS2.p1.14.m14.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.14.m14.1b"><apply id="S4.SS2.p1.14.m14.1.2.cmml" xref="S4.SS2.p1.14.m14.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.14.m14.1.2.1.cmml" xref="S4.SS2.p1.14.m14.1.2">superscript</csymbol><apply id="S4.SS2.p1.14.m14.1.2.2.cmml" xref="S4.SS2.p1.14.m14.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.14.m14.1.2.2.1.cmml" xref="S4.SS2.p1.14.m14.1.2">subscript</csymbol><ci id="S4.SS2.p1.14.m14.1.2.2.2.cmml" xref="S4.SS2.p1.14.m14.1.2.2.2">𝑤</ci><ci id="S4.SS2.p1.14.m14.1.2.2.3.cmml" xref="S4.SS2.p1.14.m14.1.2.2.3">𝑖</ci></apply><ci id="S4.SS2.p1.14.m14.1.1.1.1.cmml" xref="S4.SS2.p1.14.m14.1.1.1.1">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.14.m14.1c">w_{i}^{(r)}</annotation></semantics></math>:</p>
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.6" class="ltx_Math" alttext="P_{w_{i}^{(r)}}=[\bar{P_{1}},\bar{P_{2}},\cdots,\bar{P_{N_{C}}}]," display="block"><semantics id="S4.E1.m1.6a"><mrow id="S4.E1.m1.6.6.1" xref="S4.E1.m1.6.6.1.1.cmml"><mrow id="S4.E1.m1.6.6.1.1" xref="S4.E1.m1.6.6.1.1.cmml"><msub id="S4.E1.m1.6.6.1.1.2" xref="S4.E1.m1.6.6.1.1.2.cmml"><mi id="S4.E1.m1.6.6.1.1.2.2" xref="S4.E1.m1.6.6.1.1.2.2.cmml">P</mi><msubsup id="S4.E1.m1.1.1.1" xref="S4.E1.m1.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.3.2" xref="S4.E1.m1.1.1.1.3.2.cmml">w</mi><mi id="S4.E1.m1.1.1.1.3.3" xref="S4.E1.m1.1.1.1.3.3.cmml">i</mi><mrow id="S4.E1.m1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.1.1.1.1.1.3.1" xref="S4.E1.m1.1.1.1.cmml">(</mo><mi id="S4.E1.m1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.E1.m1.1.1.1.1.1.3.2" xref="S4.E1.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><mo id="S4.E1.m1.6.6.1.1.1" xref="S4.E1.m1.6.6.1.1.1.cmml">=</mo><mrow id="S4.E1.m1.6.6.1.1.3.2" xref="S4.E1.m1.6.6.1.1.3.1.cmml"><mo stretchy="false" id="S4.E1.m1.6.6.1.1.3.2.1" xref="S4.E1.m1.6.6.1.1.3.1.cmml">[</mo><mover accent="true" id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml"><msub id="S4.E1.m1.2.2.2" xref="S4.E1.m1.2.2.2.cmml"><mi id="S4.E1.m1.2.2.2.2" xref="S4.E1.m1.2.2.2.2.cmml">P</mi><mn id="S4.E1.m1.2.2.2.3" xref="S4.E1.m1.2.2.2.3.cmml">1</mn></msub><mo id="S4.E1.m1.2.2.1" xref="S4.E1.m1.2.2.1.cmml">¯</mo></mover><mo id="S4.E1.m1.6.6.1.1.3.2.2" xref="S4.E1.m1.6.6.1.1.3.1.cmml">,</mo><mover accent="true" id="S4.E1.m1.3.3" xref="S4.E1.m1.3.3.cmml"><msub id="S4.E1.m1.3.3.2" xref="S4.E1.m1.3.3.2.cmml"><mi id="S4.E1.m1.3.3.2.2" xref="S4.E1.m1.3.3.2.2.cmml">P</mi><mn id="S4.E1.m1.3.3.2.3" xref="S4.E1.m1.3.3.2.3.cmml">2</mn></msub><mo id="S4.E1.m1.3.3.1" xref="S4.E1.m1.3.3.1.cmml">¯</mo></mover><mo id="S4.E1.m1.6.6.1.1.3.2.3" xref="S4.E1.m1.6.6.1.1.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.E1.m1.4.4" xref="S4.E1.m1.4.4.cmml">⋯</mi><mo id="S4.E1.m1.6.6.1.1.3.2.4" xref="S4.E1.m1.6.6.1.1.3.1.cmml">,</mo><mover accent="true" id="S4.E1.m1.5.5" xref="S4.E1.m1.5.5.cmml"><msub id="S4.E1.m1.5.5.2" xref="S4.E1.m1.5.5.2.cmml"><mi id="S4.E1.m1.5.5.2.2" xref="S4.E1.m1.5.5.2.2.cmml">P</mi><msub id="S4.E1.m1.5.5.2.3" xref="S4.E1.m1.5.5.2.3.cmml"><mi id="S4.E1.m1.5.5.2.3.2" xref="S4.E1.m1.5.5.2.3.2.cmml">N</mi><mi id="S4.E1.m1.5.5.2.3.3" xref="S4.E1.m1.5.5.2.3.3.cmml">C</mi></msub></msub><mo id="S4.E1.m1.5.5.1" xref="S4.E1.m1.5.5.1.cmml">¯</mo></mover><mo stretchy="false" id="S4.E1.m1.6.6.1.1.3.2.5" xref="S4.E1.m1.6.6.1.1.3.1.cmml">]</mo></mrow></mrow><mo id="S4.E1.m1.6.6.1.2" xref="S4.E1.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.6b"><apply id="S4.E1.m1.6.6.1.1.cmml" xref="S4.E1.m1.6.6.1"><eq id="S4.E1.m1.6.6.1.1.1.cmml" xref="S4.E1.m1.6.6.1.1.1"></eq><apply id="S4.E1.m1.6.6.1.1.2.cmml" xref="S4.E1.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.6.6.1.1.2.1.cmml" xref="S4.E1.m1.6.6.1.1.2">subscript</csymbol><ci id="S4.E1.m1.6.6.1.1.2.2.cmml" xref="S4.E1.m1.6.6.1.1.2.2">𝑃</ci><apply id="S4.E1.m1.1.1.1.cmml" xref="S4.E1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1">superscript</csymbol><apply id="S4.E1.m1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.3.2">𝑤</ci><ci id="S4.E1.m1.1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.1.3.3">𝑖</ci></apply><ci id="S4.E1.m1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1">𝑟</ci></apply></apply><list id="S4.E1.m1.6.6.1.1.3.1.cmml" xref="S4.E1.m1.6.6.1.1.3.2"><apply id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2"><ci id="S4.E1.m1.2.2.1.cmml" xref="S4.E1.m1.2.2.1">¯</ci><apply id="S4.E1.m1.2.2.2.cmml" xref="S4.E1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.2.1.cmml" xref="S4.E1.m1.2.2.2">subscript</csymbol><ci id="S4.E1.m1.2.2.2.2.cmml" xref="S4.E1.m1.2.2.2.2">𝑃</ci><cn type="integer" id="S4.E1.m1.2.2.2.3.cmml" xref="S4.E1.m1.2.2.2.3">1</cn></apply></apply><apply id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3"><ci id="S4.E1.m1.3.3.1.cmml" xref="S4.E1.m1.3.3.1">¯</ci><apply id="S4.E1.m1.3.3.2.cmml" xref="S4.E1.m1.3.3.2"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.2.1.cmml" xref="S4.E1.m1.3.3.2">subscript</csymbol><ci id="S4.E1.m1.3.3.2.2.cmml" xref="S4.E1.m1.3.3.2.2">𝑃</ci><cn type="integer" id="S4.E1.m1.3.3.2.3.cmml" xref="S4.E1.m1.3.3.2.3">2</cn></apply></apply><ci id="S4.E1.m1.4.4.cmml" xref="S4.E1.m1.4.4">⋯</ci><apply id="S4.E1.m1.5.5.cmml" xref="S4.E1.m1.5.5"><ci id="S4.E1.m1.5.5.1.cmml" xref="S4.E1.m1.5.5.1">¯</ci><apply id="S4.E1.m1.5.5.2.cmml" xref="S4.E1.m1.5.5.2"><csymbol cd="ambiguous" id="S4.E1.m1.5.5.2.1.cmml" xref="S4.E1.m1.5.5.2">subscript</csymbol><ci id="S4.E1.m1.5.5.2.2.cmml" xref="S4.E1.m1.5.5.2.2">𝑃</ci><apply id="S4.E1.m1.5.5.2.3.cmml" xref="S4.E1.m1.5.5.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.5.5.2.3.1.cmml" xref="S4.E1.m1.5.5.2.3">subscript</csymbol><ci id="S4.E1.m1.5.5.2.3.2.cmml" xref="S4.E1.m1.5.5.2.3.2">𝑁</ci><ci id="S4.E1.m1.5.5.2.3.3.cmml" xref="S4.E1.m1.5.5.2.3.3">𝐶</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.6c">P_{w_{i}^{(r)}}=[\bar{P_{1}},\bar{P_{2}},\cdots,\bar{P_{N_{C}}}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.15" class="ltx_p">where <math id="S4.SS2.p1.15.m1.1" class="ltx_Math" alttext="N_{C}" display="inline"><semantics id="S4.SS2.p1.15.m1.1a"><msub id="S4.SS2.p1.15.m1.1.1" xref="S4.SS2.p1.15.m1.1.1.cmml"><mi id="S4.SS2.p1.15.m1.1.1.2" xref="S4.SS2.p1.15.m1.1.1.2.cmml">N</mi><mi id="S4.SS2.p1.15.m1.1.1.3" xref="S4.SS2.p1.15.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.15.m1.1b"><apply id="S4.SS2.p1.15.m1.1.1.cmml" xref="S4.SS2.p1.15.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.15.m1.1.1.1.cmml" xref="S4.SS2.p1.15.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.15.m1.1.1.2.cmml" xref="S4.SS2.p1.15.m1.1.1.2">𝑁</ci><ci id="S4.SS2.p1.15.m1.1.1.3.cmml" xref="S4.SS2.p1.15.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.15.m1.1c">N_{C}</annotation></semantics></math> is the number of classes.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.7" class="ltx_p">In each training round, when the server collects local models from the local client gateways, it utilizes an auxiliary dataset to calculate the CPM for each local model. For our experiments, we construct a small auxiliary dataset of ten samples from each class.
We denote the set of clients that participate in the <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">r</annotation></semantics></math>-th training round as <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">U</annotation></semantics></math>, and the collected local models from the participants as <math id="S4.SS2.p2.3.m3.6" class="ltx_Math" alttext="{w^{(r)}_{1},...,w^{(r)}_{|U|}}" display="inline"><semantics id="S4.SS2.p2.3.m3.6a"><mrow id="S4.SS2.p2.3.m3.6.6.2" xref="S4.SS2.p2.3.m3.6.6.3.cmml"><msubsup id="S4.SS2.p2.3.m3.5.5.1.1" xref="S4.SS2.p2.3.m3.5.5.1.1.cmml"><mi id="S4.SS2.p2.3.m3.5.5.1.1.2.2" xref="S4.SS2.p2.3.m3.5.5.1.1.2.2.cmml">w</mi><mn id="S4.SS2.p2.3.m3.5.5.1.1.3" xref="S4.SS2.p2.3.m3.5.5.1.1.3.cmml">1</mn><mrow id="S4.SS2.p2.3.m3.1.1.1.3" xref="S4.SS2.p2.3.m3.5.5.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.3.m3.1.1.1.3.1" xref="S4.SS2.p2.3.m3.5.5.1.1.cmml">(</mo><mi id="S4.SS2.p2.3.m3.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.SS2.p2.3.m3.1.1.1.3.2" xref="S4.SS2.p2.3.m3.5.5.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.p2.3.m3.6.6.2.3" xref="S4.SS2.p2.3.m3.6.6.3.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.p2.3.m3.4.4" xref="S4.SS2.p2.3.m3.4.4.cmml">…</mi><mo id="S4.SS2.p2.3.m3.6.6.2.4" xref="S4.SS2.p2.3.m3.6.6.3.cmml">,</mo><msubsup id="S4.SS2.p2.3.m3.6.6.2.2" xref="S4.SS2.p2.3.m3.6.6.2.2.cmml"><mi id="S4.SS2.p2.3.m3.6.6.2.2.2.2" xref="S4.SS2.p2.3.m3.6.6.2.2.2.2.cmml">w</mi><mrow id="S4.SS2.p2.3.m3.3.3.1.3" xref="S4.SS2.p2.3.m3.3.3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.3.m3.3.3.1.3.1" xref="S4.SS2.p2.3.m3.3.3.1.2.1.cmml">|</mo><mi id="S4.SS2.p2.3.m3.3.3.1.1" xref="S4.SS2.p2.3.m3.3.3.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS2.p2.3.m3.3.3.1.3.2" xref="S4.SS2.p2.3.m3.3.3.1.2.1.cmml">|</mo></mrow><mrow id="S4.SS2.p2.3.m3.2.2.1.3" xref="S4.SS2.p2.3.m3.6.6.2.2.cmml"><mo stretchy="false" id="S4.SS2.p2.3.m3.2.2.1.3.1" xref="S4.SS2.p2.3.m3.6.6.2.2.cmml">(</mo><mi id="S4.SS2.p2.3.m3.2.2.1.1" xref="S4.SS2.p2.3.m3.2.2.1.1.cmml">r</mi><mo stretchy="false" id="S4.SS2.p2.3.m3.2.2.1.3.2" xref="S4.SS2.p2.3.m3.6.6.2.2.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.6b"><list id="S4.SS2.p2.3.m3.6.6.3.cmml" xref="S4.SS2.p2.3.m3.6.6.2"><apply id="S4.SS2.p2.3.m3.5.5.1.1.cmml" xref="S4.SS2.p2.3.m3.5.5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.5.5.1.1.1.cmml" xref="S4.SS2.p2.3.m3.5.5.1.1">subscript</csymbol><apply id="S4.SS2.p2.3.m3.5.5.1.1.2.cmml" xref="S4.SS2.p2.3.m3.5.5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.5.5.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.5.5.1.1">superscript</csymbol><ci id="S4.SS2.p2.3.m3.5.5.1.1.2.2.cmml" xref="S4.SS2.p2.3.m3.5.5.1.1.2.2">𝑤</ci><ci id="S4.SS2.p2.3.m3.1.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1">𝑟</ci></apply><cn type="integer" id="S4.SS2.p2.3.m3.5.5.1.1.3.cmml" xref="S4.SS2.p2.3.m3.5.5.1.1.3">1</cn></apply><ci id="S4.SS2.p2.3.m3.4.4.cmml" xref="S4.SS2.p2.3.m3.4.4">…</ci><apply id="S4.SS2.p2.3.m3.6.6.2.2.cmml" xref="S4.SS2.p2.3.m3.6.6.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.6.6.2.2.1.cmml" xref="S4.SS2.p2.3.m3.6.6.2.2">subscript</csymbol><apply id="S4.SS2.p2.3.m3.6.6.2.2.2.cmml" xref="S4.SS2.p2.3.m3.6.6.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.6.6.2.2.2.1.cmml" xref="S4.SS2.p2.3.m3.6.6.2.2">superscript</csymbol><ci id="S4.SS2.p2.3.m3.6.6.2.2.2.2.cmml" xref="S4.SS2.p2.3.m3.6.6.2.2.2.2">𝑤</ci><ci id="S4.SS2.p2.3.m3.2.2.1.1.cmml" xref="S4.SS2.p2.3.m3.2.2.1.1">𝑟</ci></apply><apply id="S4.SS2.p2.3.m3.3.3.1.2.cmml" xref="S4.SS2.p2.3.m3.3.3.1.3"><abs id="S4.SS2.p2.3.m3.3.3.1.2.1.cmml" xref="S4.SS2.p2.3.m3.3.3.1.3.1"></abs><ci id="S4.SS2.p2.3.m3.3.3.1.1.cmml" xref="S4.SS2.p2.3.m3.3.3.1.1">𝑈</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.6c">{w^{(r)}_{1},...,w^{(r)}_{|U|}}</annotation></semantics></math>, where <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="|U|" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.2.2" xref="S4.SS2.p2.4.m4.1.2.1.cmml"><mo stretchy="false" id="S4.SS2.p2.4.m4.1.2.2.1" xref="S4.SS2.p2.4.m4.1.2.1.1.cmml">|</mo><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">U</mi><mo stretchy="false" id="S4.SS2.p2.4.m4.1.2.2.2" xref="S4.SS2.p2.4.m4.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.2.1.cmml" xref="S4.SS2.p2.4.m4.1.2.2"><abs id="S4.SS2.p2.4.m4.1.2.1.1.cmml" xref="S4.SS2.p2.4.m4.1.2.2.1"></abs><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">|U|</annotation></semantics></math> is the number of participants in this training round.
Next, the server applies the DBSCAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> clustering technique to the obtained CPMs, and groups their corresponding clients into different clusters.
DBSCAN, a density-based algorithm, identifies core points with nearby neighbors and does not require specifying the number of clusters. This technique is suitable for our case, as CPMs from clients with similar classification performance naturally form compact and dense clusters.
Using this technique, the clients which have similar class-specific performance can be grouped in the same cluster. Ultimately, we obtain the set <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><ci id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\mathcal{C}</annotation></semantics></math> of <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mi id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><ci id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">K</annotation></semantics></math> client-clusters, <math id="S4.SS2.p2.7.m7.4" class="ltx_Math" alttext="\mathcal{C}=\{\mathcal{C}_{1},\mathcal{C}_{2},\cdots,\mathcal{C}_{K}\}" display="inline"><semantics id="S4.SS2.p2.7.m7.4a"><mrow id="S4.SS2.p2.7.m7.4.4" xref="S4.SS2.p2.7.m7.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.7.m7.4.4.5" xref="S4.SS2.p2.7.m7.4.4.5.cmml">𝒞</mi><mo id="S4.SS2.p2.7.m7.4.4.4" xref="S4.SS2.p2.7.m7.4.4.4.cmml">=</mo><mrow id="S4.SS2.p2.7.m7.4.4.3.3" xref="S4.SS2.p2.7.m7.4.4.3.4.cmml"><mo stretchy="false" id="S4.SS2.p2.7.m7.4.4.3.3.4" xref="S4.SS2.p2.7.m7.4.4.3.4.cmml">{</mo><msub id="S4.SS2.p2.7.m7.2.2.1.1.1" xref="S4.SS2.p2.7.m7.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.7.m7.2.2.1.1.1.2" xref="S4.SS2.p2.7.m7.2.2.1.1.1.2.cmml">𝒞</mi><mn id="S4.SS2.p2.7.m7.2.2.1.1.1.3" xref="S4.SS2.p2.7.m7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.p2.7.m7.4.4.3.3.5" xref="S4.SS2.p2.7.m7.4.4.3.4.cmml">,</mo><msub id="S4.SS2.p2.7.m7.3.3.2.2.2" xref="S4.SS2.p2.7.m7.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.7.m7.3.3.2.2.2.2" xref="S4.SS2.p2.7.m7.3.3.2.2.2.2.cmml">𝒞</mi><mn id="S4.SS2.p2.7.m7.3.3.2.2.2.3" xref="S4.SS2.p2.7.m7.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS2.p2.7.m7.4.4.3.3.6" xref="S4.SS2.p2.7.m7.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml">⋯</mi><mo id="S4.SS2.p2.7.m7.4.4.3.3.7" xref="S4.SS2.p2.7.m7.4.4.3.4.cmml">,</mo><msub id="S4.SS2.p2.7.m7.4.4.3.3.3" xref="S4.SS2.p2.7.m7.4.4.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.7.m7.4.4.3.3.3.2" xref="S4.SS2.p2.7.m7.4.4.3.3.3.2.cmml">𝒞</mi><mi id="S4.SS2.p2.7.m7.4.4.3.3.3.3" xref="S4.SS2.p2.7.m7.4.4.3.3.3.3.cmml">K</mi></msub><mo stretchy="false" id="S4.SS2.p2.7.m7.4.4.3.3.8" xref="S4.SS2.p2.7.m7.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.4b"><apply id="S4.SS2.p2.7.m7.4.4.cmml" xref="S4.SS2.p2.7.m7.4.4"><eq id="S4.SS2.p2.7.m7.4.4.4.cmml" xref="S4.SS2.p2.7.m7.4.4.4"></eq><ci id="S4.SS2.p2.7.m7.4.4.5.cmml" xref="S4.SS2.p2.7.m7.4.4.5">𝒞</ci><set id="S4.SS2.p2.7.m7.4.4.3.4.cmml" xref="S4.SS2.p2.7.m7.4.4.3.3"><apply id="S4.SS2.p2.7.m7.2.2.1.1.1.cmml" xref="S4.SS2.p2.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.2.2.1.1.1.1.cmml" xref="S4.SS2.p2.7.m7.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.7.m7.2.2.1.1.1.2.cmml" xref="S4.SS2.p2.7.m7.2.2.1.1.1.2">𝒞</ci><cn type="integer" id="S4.SS2.p2.7.m7.2.2.1.1.1.3.cmml" xref="S4.SS2.p2.7.m7.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS2.p2.7.m7.3.3.2.2.2.cmml" xref="S4.SS2.p2.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.3.3.2.2.2.1.cmml" xref="S4.SS2.p2.7.m7.3.3.2.2.2">subscript</csymbol><ci id="S4.SS2.p2.7.m7.3.3.2.2.2.2.cmml" xref="S4.SS2.p2.7.m7.3.3.2.2.2.2">𝒞</ci><cn type="integer" id="S4.SS2.p2.7.m7.3.3.2.2.2.3.cmml" xref="S4.SS2.p2.7.m7.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">⋯</ci><apply id="S4.SS2.p2.7.m7.4.4.3.3.3.cmml" xref="S4.SS2.p2.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.4.4.3.3.3.1.cmml" xref="S4.SS2.p2.7.m7.4.4.3.3.3">subscript</csymbol><ci id="S4.SS2.p2.7.m7.4.4.3.3.3.2.cmml" xref="S4.SS2.p2.7.m7.4.4.3.3.3.2">𝒞</ci><ci id="S4.SS2.p2.7.m7.4.4.3.3.3.3.cmml" xref="S4.SS2.p2.7.m7.4.4.3.3.3.3">𝐾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.4c">\mathcal{C}=\{\mathcal{C}_{1},\mathcal{C}_{2},\cdots,\mathcal{C}_{K}\}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Dynamic Aggregation Weight Calculation</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We formulate the dynamic assignment of aggregation weights as an optimization problem based on the local CPMs. When applied to large-scale networks, the computation complexity of our method can grow significantly if each client participates individually in solving the optimization problem. Hence, we view each client-cluster as a single entity and assign the same aggregation weights to all the clients in the same cluster.
For each cluster, we average the CPMs obtained from all local models in that cluster to get the averaged Cluster Class Probability Matrix (CCPM). The averaged CCPM for the cluster <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{C}_{k}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">𝒞</mi><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝒞</ci><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\mathcal{C}_{k}</annotation></semantics></math> is represented as</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.4" class="ltx_Math" alttext="P_{\mathcal{C}_{k}}=\frac{1}{|\mathcal{C}_{k}|}\sum_{w_{i}^{(r)}\in\mathcal{C}_{k}}P_{w_{i}^{(r)}}." display="block"><semantics id="S4.E2.m1.4a"><mrow id="S4.E2.m1.4.4.1" xref="S4.E2.m1.4.4.1.1.cmml"><mrow id="S4.E2.m1.4.4.1.1" xref="S4.E2.m1.4.4.1.1.cmml"><msub id="S4.E2.m1.4.4.1.1.2" xref="S4.E2.m1.4.4.1.1.2.cmml"><mi id="S4.E2.m1.4.4.1.1.2.2" xref="S4.E2.m1.4.4.1.1.2.2.cmml">P</mi><msub id="S4.E2.m1.4.4.1.1.2.3" xref="S4.E2.m1.4.4.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.4.4.1.1.2.3.2" xref="S4.E2.m1.4.4.1.1.2.3.2.cmml">𝒞</mi><mi id="S4.E2.m1.4.4.1.1.2.3.3" xref="S4.E2.m1.4.4.1.1.2.3.3.cmml">k</mi></msub></msub><mo id="S4.E2.m1.4.4.1.1.1" xref="S4.E2.m1.4.4.1.1.1.cmml">=</mo><mrow id="S4.E2.m1.4.4.1.1.3" xref="S4.E2.m1.4.4.1.1.3.cmml"><mfrac id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml"><mn id="S4.E2.m1.1.1.3" xref="S4.E2.m1.1.1.3.cmml">1</mn><mrow id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.2.1.cmml">|</mo><msub id="S4.E2.m1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.2.cmml">𝒞</mi><mi id="S4.E2.m1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.E2.m1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E2.m1.4.4.1.1.3.1" xref="S4.E2.m1.4.4.1.1.3.1.cmml">​</mo><mrow id="S4.E2.m1.4.4.1.1.3.2" xref="S4.E2.m1.4.4.1.1.3.2.cmml"><munder id="S4.E2.m1.4.4.1.1.3.2.1" xref="S4.E2.m1.4.4.1.1.3.2.1.cmml"><mo movablelimits="false" id="S4.E2.m1.4.4.1.1.3.2.1.2" xref="S4.E2.m1.4.4.1.1.3.2.1.2.cmml">∑</mo><mrow id="S4.E2.m1.2.2.1" xref="S4.E2.m1.2.2.1.cmml"><msubsup id="S4.E2.m1.2.2.1.3" xref="S4.E2.m1.2.2.1.3.cmml"><mi id="S4.E2.m1.2.2.1.3.2.2" xref="S4.E2.m1.2.2.1.3.2.2.cmml">w</mi><mi id="S4.E2.m1.2.2.1.3.2.3" xref="S4.E2.m1.2.2.1.3.2.3.cmml">i</mi><mrow id="S4.E2.m1.2.2.1.1.1.3" xref="S4.E2.m1.2.2.1.3.cmml"><mo stretchy="false" id="S4.E2.m1.2.2.1.1.1.3.1" xref="S4.E2.m1.2.2.1.3.cmml">(</mo><mi id="S4.E2.m1.2.2.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.E2.m1.2.2.1.1.1.3.2" xref="S4.E2.m1.2.2.1.3.cmml">)</mo></mrow></msubsup><mo id="S4.E2.m1.2.2.1.2" xref="S4.E2.m1.2.2.1.2.cmml">∈</mo><msub id="S4.E2.m1.2.2.1.4" xref="S4.E2.m1.2.2.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.2.2.1.4.2" xref="S4.E2.m1.2.2.1.4.2.cmml">𝒞</mi><mi id="S4.E2.m1.2.2.1.4.3" xref="S4.E2.m1.2.2.1.4.3.cmml">k</mi></msub></mrow></munder><msub id="S4.E2.m1.4.4.1.1.3.2.2" xref="S4.E2.m1.4.4.1.1.3.2.2.cmml"><mi id="S4.E2.m1.4.4.1.1.3.2.2.2" xref="S4.E2.m1.4.4.1.1.3.2.2.2.cmml">P</mi><msubsup id="S4.E2.m1.3.3.1" xref="S4.E2.m1.3.3.1.cmml"><mi id="S4.E2.m1.3.3.1.3.2" xref="S4.E2.m1.3.3.1.3.2.cmml">w</mi><mi id="S4.E2.m1.3.3.1.3.3" xref="S4.E2.m1.3.3.1.3.3.cmml">i</mi><mrow id="S4.E2.m1.3.3.1.1.1.3" xref="S4.E2.m1.3.3.1.cmml"><mo stretchy="false" id="S4.E2.m1.3.3.1.1.1.3.1" xref="S4.E2.m1.3.3.1.cmml">(</mo><mi id="S4.E2.m1.3.3.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.E2.m1.3.3.1.1.1.3.2" xref="S4.E2.m1.3.3.1.cmml">)</mo></mrow></msubsup></msub></mrow></mrow></mrow><mo lspace="0em" id="S4.E2.m1.4.4.1.2" xref="S4.E2.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.4b"><apply id="S4.E2.m1.4.4.1.1.cmml" xref="S4.E2.m1.4.4.1"><eq id="S4.E2.m1.4.4.1.1.1.cmml" xref="S4.E2.m1.4.4.1.1.1"></eq><apply id="S4.E2.m1.4.4.1.1.2.cmml" xref="S4.E2.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.1.1.2.1.cmml" xref="S4.E2.m1.4.4.1.1.2">subscript</csymbol><ci id="S4.E2.m1.4.4.1.1.2.2.cmml" xref="S4.E2.m1.4.4.1.1.2.2">𝑃</ci><apply id="S4.E2.m1.4.4.1.1.2.3.cmml" xref="S4.E2.m1.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.1.1.2.3.1.cmml" xref="S4.E2.m1.4.4.1.1.2.3">subscript</csymbol><ci id="S4.E2.m1.4.4.1.1.2.3.2.cmml" xref="S4.E2.m1.4.4.1.1.2.3.2">𝒞</ci><ci id="S4.E2.m1.4.4.1.1.2.3.3.cmml" xref="S4.E2.m1.4.4.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S4.E2.m1.4.4.1.1.3.cmml" xref="S4.E2.m1.4.4.1.1.3"><times id="S4.E2.m1.4.4.1.1.3.1.cmml" xref="S4.E2.m1.4.4.1.1.3.1"></times><apply id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1"><divide id="S4.E2.m1.1.1.2.cmml" xref="S4.E2.m1.1.1"></divide><cn type="integer" id="S4.E2.m1.1.1.3.cmml" xref="S4.E2.m1.1.1.3">1</cn><apply id="S4.E2.m1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1"><abs id="S4.E2.m1.1.1.1.2.1.cmml" xref="S4.E2.m1.1.1.1.1.2"></abs><apply id="S4.E2.m1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.2">𝒞</ci><ci id="S4.E2.m1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S4.E2.m1.4.4.1.1.3.2.cmml" xref="S4.E2.m1.4.4.1.1.3.2"><apply id="S4.E2.m1.4.4.1.1.3.2.1.cmml" xref="S4.E2.m1.4.4.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.1.1.3.2.1.1.cmml" xref="S4.E2.m1.4.4.1.1.3.2.1">subscript</csymbol><sum id="S4.E2.m1.4.4.1.1.3.2.1.2.cmml" xref="S4.E2.m1.4.4.1.1.3.2.1.2"></sum><apply id="S4.E2.m1.2.2.1.cmml" xref="S4.E2.m1.2.2.1"><in id="S4.E2.m1.2.2.1.2.cmml" xref="S4.E2.m1.2.2.1.2"></in><apply id="S4.E2.m1.2.2.1.3.cmml" xref="S4.E2.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.3.1.cmml" xref="S4.E2.m1.2.2.1.3">superscript</csymbol><apply id="S4.E2.m1.2.2.1.3.2.cmml" xref="S4.E2.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.3.2.1.cmml" xref="S4.E2.m1.2.2.1.3">subscript</csymbol><ci id="S4.E2.m1.2.2.1.3.2.2.cmml" xref="S4.E2.m1.2.2.1.3.2.2">𝑤</ci><ci id="S4.E2.m1.2.2.1.3.2.3.cmml" xref="S4.E2.m1.2.2.1.3.2.3">𝑖</ci></apply><ci id="S4.E2.m1.2.2.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1">𝑟</ci></apply><apply id="S4.E2.m1.2.2.1.4.cmml" xref="S4.E2.m1.2.2.1.4"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.4.1.cmml" xref="S4.E2.m1.2.2.1.4">subscript</csymbol><ci id="S4.E2.m1.2.2.1.4.2.cmml" xref="S4.E2.m1.2.2.1.4.2">𝒞</ci><ci id="S4.E2.m1.2.2.1.4.3.cmml" xref="S4.E2.m1.2.2.1.4.3">𝑘</ci></apply></apply></apply><apply id="S4.E2.m1.4.4.1.1.3.2.2.cmml" xref="S4.E2.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.1.1.3.2.2.1.cmml" xref="S4.E2.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="S4.E2.m1.4.4.1.1.3.2.2.2.cmml" xref="S4.E2.m1.4.4.1.1.3.2.2.2">𝑃</ci><apply id="S4.E2.m1.3.3.1.cmml" xref="S4.E2.m1.3.3.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.2.cmml" xref="S4.E2.m1.3.3.1">superscript</csymbol><apply id="S4.E2.m1.3.3.1.3.cmml" xref="S4.E2.m1.3.3.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.3.1.cmml" xref="S4.E2.m1.3.3.1">subscript</csymbol><ci id="S4.E2.m1.3.3.1.3.2.cmml" xref="S4.E2.m1.3.3.1.3.2">𝑤</ci><ci id="S4.E2.m1.3.3.1.3.3.cmml" xref="S4.E2.m1.3.3.1.3.3">𝑖</ci></apply><ci id="S4.E2.m1.3.3.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1">𝑟</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.4c">P_{\mathcal{C}_{k}}=\frac{1}{|\mathcal{C}_{k}|}\sum_{w_{i}^{(r)}\in\mathcal{C}_{k}}P_{w_{i}^{(r)}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.5" class="ltx_p">The averaged CCPMs reflect the classification performance of local models in each cluster. The ultimate objective of the global model is to achieve consistently strong performance across all attack classes, including minority ones. To this end, the problem is designed to align the aggregated CCPMs with the identity matrix <math id="S4.SS3.p1.2.m1.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S4.SS3.p1.2.m1.1a"><mi id="S4.SS3.p1.2.m1.1.1" xref="S4.SS3.p1.2.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m1.1b"><ci id="S4.SS3.p1.2.m1.1.1.cmml" xref="S4.SS3.p1.2.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m1.1c">I</annotation></semantics></math>. Here, <math id="S4.SS3.p1.3.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S4.SS3.p1.3.m2.1a"><mi id="S4.SS3.p1.3.m2.1.1" xref="S4.SS3.p1.3.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m2.1b"><ci id="S4.SS3.p1.3.m2.1.1.cmml" xref="S4.SS3.p1.3.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m2.1c">I</annotation></semantics></math> represents the ideal classification scenario, with each row representing a distinct class and the probability of correctly classifying an input into its corresponding class being 100%. In practice, the optimization problem aims to constrain the <math id="S4.SS3.p1.4.m3.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S4.SS3.p1.4.m3.1a"><msub id="S4.SS3.p1.4.m3.1.1" xref="S4.SS3.p1.4.m3.1.1.cmml"><mi id="S4.SS3.p1.4.m3.1.1.2" xref="S4.SS3.p1.4.m3.1.1.2.cmml">L</mi><mn id="S4.SS3.p1.4.m3.1.1.3" xref="S4.SS3.p1.4.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m3.1b"><apply id="S4.SS3.p1.4.m3.1.1.cmml" xref="S4.SS3.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m3.1.1.1.cmml" xref="S4.SS3.p1.4.m3.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m3.1.1.2.cmml" xref="S4.SS3.p1.4.m3.1.1.2">𝐿</ci><cn type="integer" id="S4.SS3.p1.4.m3.1.1.3.cmml" xref="S4.SS3.p1.4.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m3.1c">L_{2}</annotation></semantics></math> distance between the aggregated CCPMs and the identity matrix within a tolerance limit of <math id="S4.SS3.p1.5.m4.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS3.p1.5.m4.1a"><mi id="S4.SS3.p1.5.m4.1.1" xref="S4.SS3.p1.5.m4.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m4.1b"><ci id="S4.SS3.p1.5.m4.1.1.cmml" xref="S4.SS3.p1.5.m4.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m4.1c">\epsilon</annotation></semantics></math>. To achieve this, the optimization expression can be formulated as</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.1" class="ltx_Math" alttext="\min\|\sum_{k=1}^{K}\alpha_{k}P_{\mathcal{C}_{k}}-I\|_{2}," display="block"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.2.cmml">min</mi><mo id="S4.E3.m1.1.1.1.1a" xref="S4.E3.m1.1.1.1.1.cmml">⁡</mo><msub id="S4.E3.m1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml"><munderover id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.cmml"><mo lspace="0em" movablelimits="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.2.cmml">k</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.cmml">K</mi></munderover><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml"><msub id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">α</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.1.cmml">​</mo><msub id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">P</mi><msub id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3.2.cmml">𝒞</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3.3.cmml">k</mi></msub></msub></mrow></mrow><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml">I</mi></mrow><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E3.m1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.3.cmml">2</mn></msub></mrow><mo id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><min id="S4.E3.m1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.2"></min><apply id="S4.E3.m1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1">subscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1"><minus id="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2"><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.2"></sum><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3"><eq id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.1"></eq><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.2">𝑘</ci><cn type="integer" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3">𝐾</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2"><times id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.1"></times><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝛼</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.2">𝑃</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3.2">𝒞</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.3.3.3">𝑘</ci></apply></apply></apply></apply><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3">𝐼</ci></apply></apply><cn type="integer" id="S4.E3.m1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\min\|\sum_{k=1}^{K}\alpha_{k}P_{\mathcal{C}_{k}}-I\|_{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.10" class="ltx_p">with the constraint that <math id="S4.SS3.p1.6.m1.1" class="ltx_Math" alttext="\alpha_{k}" display="inline"><semantics id="S4.SS3.p1.6.m1.1a"><msub id="S4.SS3.p1.6.m1.1.1" xref="S4.SS3.p1.6.m1.1.1.cmml"><mi id="S4.SS3.p1.6.m1.1.1.2" xref="S4.SS3.p1.6.m1.1.1.2.cmml">α</mi><mi id="S4.SS3.p1.6.m1.1.1.3" xref="S4.SS3.p1.6.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m1.1b"><apply id="S4.SS3.p1.6.m1.1.1.cmml" xref="S4.SS3.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m1.1.1.1.cmml" xref="S4.SS3.p1.6.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.6.m1.1.1.2.cmml" xref="S4.SS3.p1.6.m1.1.1.2">𝛼</ci><ci id="S4.SS3.p1.6.m1.1.1.3.cmml" xref="S4.SS3.p1.6.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m1.1c">\alpha_{k}</annotation></semantics></math>, which represents the aggregation weight of client cluster <math id="S4.SS3.p1.7.m2.1" class="ltx_Math" alttext="\mathcal{C}_{k}" display="inline"><semantics id="S4.SS3.p1.7.m2.1a"><msub id="S4.SS3.p1.7.m2.1.1" xref="S4.SS3.p1.7.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.7.m2.1.1.2" xref="S4.SS3.p1.7.m2.1.1.2.cmml">𝒞</mi><mi id="S4.SS3.p1.7.m2.1.1.3" xref="S4.SS3.p1.7.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m2.1b"><apply id="S4.SS3.p1.7.m2.1.1.cmml" xref="S4.SS3.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m2.1.1.1.cmml" xref="S4.SS3.p1.7.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.7.m2.1.1.2.cmml" xref="S4.SS3.p1.7.m2.1.1.2">𝒞</ci><ci id="S4.SS3.p1.7.m2.1.1.3.cmml" xref="S4.SS3.p1.7.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m2.1c">\mathcal{C}_{k}</annotation></semantics></math>, is non-negative. Then, for each client, the client weight is the cluster weight divided by the number of clients in that cluster. For a local model <math id="S4.SS3.p1.8.m3.1" class="ltx_Math" alttext="w_{i}^{(r)}" display="inline"><semantics id="S4.SS3.p1.8.m3.1a"><msubsup id="S4.SS3.p1.8.m3.1.2" xref="S4.SS3.p1.8.m3.1.2.cmml"><mi id="S4.SS3.p1.8.m3.1.2.2.2" xref="S4.SS3.p1.8.m3.1.2.2.2.cmml">w</mi><mi id="S4.SS3.p1.8.m3.1.2.2.3" xref="S4.SS3.p1.8.m3.1.2.2.3.cmml">i</mi><mrow id="S4.SS3.p1.8.m3.1.1.1.3" xref="S4.SS3.p1.8.m3.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.8.m3.1.1.1.3.1" xref="S4.SS3.p1.8.m3.1.2.cmml">(</mo><mi id="S4.SS3.p1.8.m3.1.1.1.1" xref="S4.SS3.p1.8.m3.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.SS3.p1.8.m3.1.1.1.3.2" xref="S4.SS3.p1.8.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m3.1b"><apply id="S4.SS3.p1.8.m3.1.2.cmml" xref="S4.SS3.p1.8.m3.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m3.1.2.1.cmml" xref="S4.SS3.p1.8.m3.1.2">superscript</csymbol><apply id="S4.SS3.p1.8.m3.1.2.2.cmml" xref="S4.SS3.p1.8.m3.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m3.1.2.2.1.cmml" xref="S4.SS3.p1.8.m3.1.2">subscript</csymbol><ci id="S4.SS3.p1.8.m3.1.2.2.2.cmml" xref="S4.SS3.p1.8.m3.1.2.2.2">𝑤</ci><ci id="S4.SS3.p1.8.m3.1.2.2.3.cmml" xref="S4.SS3.p1.8.m3.1.2.2.3">𝑖</ci></apply><ci id="S4.SS3.p1.8.m3.1.1.1.1.cmml" xref="S4.SS3.p1.8.m3.1.1.1.1">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m3.1c">w_{i}^{(r)}</annotation></semantics></math> of the <math id="S4.SS3.p1.9.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS3.p1.9.m4.1a"><mi id="S4.SS3.p1.9.m4.1.1" xref="S4.SS3.p1.9.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m4.1b"><ci id="S4.SS3.p1.9.m4.1.1.cmml" xref="S4.SS3.p1.9.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m4.1c">i</annotation></semantics></math>-th client, belonging to a cluster <math id="S4.SS3.p1.10.m5.1" class="ltx_Math" alttext="\mathcal{C}_{k}" display="inline"><semantics id="S4.SS3.p1.10.m5.1a"><msub id="S4.SS3.p1.10.m5.1.1" xref="S4.SS3.p1.10.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.10.m5.1.1.2" xref="S4.SS3.p1.10.m5.1.1.2.cmml">𝒞</mi><mi id="S4.SS3.p1.10.m5.1.1.3" xref="S4.SS3.p1.10.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m5.1b"><apply id="S4.SS3.p1.10.m5.1.1.cmml" xref="S4.SS3.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m5.1.1.1.cmml" xref="S4.SS3.p1.10.m5.1.1">subscript</csymbol><ci id="S4.SS3.p1.10.m5.1.1.2.cmml" xref="S4.SS3.p1.10.m5.1.1.2">𝒞</ci><ci id="S4.SS3.p1.10.m5.1.1.3.cmml" xref="S4.SS3.p1.10.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m5.1c">\mathcal{C}_{k}</annotation></semantics></math>, the aggregation weight is</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.2" class="ltx_Math" alttext="\beta_{i}=\frac{\alpha_{k}}{\lvert\mathcal{C}_{k}\rvert}." display="block"><semantics id="S4.E4.m1.2a"><mrow id="S4.E4.m1.2.2.1" xref="S4.E4.m1.2.2.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1" xref="S4.E4.m1.2.2.1.1.cmml"><msub id="S4.E4.m1.2.2.1.1.2" xref="S4.E4.m1.2.2.1.1.2.cmml"><mi id="S4.E4.m1.2.2.1.1.2.2" xref="S4.E4.m1.2.2.1.1.2.2.cmml">β</mi><mi id="S4.E4.m1.2.2.1.1.2.3" xref="S4.E4.m1.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S4.E4.m1.2.2.1.1.1" xref="S4.E4.m1.2.2.1.1.1.cmml">=</mo><mfrac id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml"><msub id="S4.E4.m1.1.1.3" xref="S4.E4.m1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.3.2" xref="S4.E4.m1.1.1.3.2.cmml">α</mi><mi id="S4.E4.m1.1.1.3.3" xref="S4.E4.m1.1.1.3.3.cmml">k</mi></msub><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E4.m1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.2.1.cmml">|</mo><msub id="S4.E4.m1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.2.cmml">𝒞</mi><mi id="S4.E4.m1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.E4.m1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mrow><mo lspace="0em" id="S4.E4.m1.2.2.1.2" xref="S4.E4.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.2b"><apply id="S4.E4.m1.2.2.1.1.cmml" xref="S4.E4.m1.2.2.1"><eq id="S4.E4.m1.2.2.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1"></eq><apply id="S4.E4.m1.2.2.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.2.1.cmml" xref="S4.E4.m1.2.2.1.1.2">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.2.2.cmml" xref="S4.E4.m1.2.2.1.1.2.2">𝛽</ci><ci id="S4.E4.m1.2.2.1.1.2.3.cmml" xref="S4.E4.m1.2.2.1.1.2.3">𝑖</ci></apply><apply id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"><divide id="S4.E4.m1.1.1.2.cmml" xref="S4.E4.m1.1.1"></divide><apply id="S4.E4.m1.1.1.3.cmml" xref="S4.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.3.2">𝛼</ci><ci id="S4.E4.m1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.3.3">𝑘</ci></apply><apply id="S4.E4.m1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1"><abs id="S4.E4.m1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2"></abs><apply id="S4.E4.m1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.2">𝒞</ci><ci id="S4.E4.m1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.2c">\beta_{i}=\frac{\alpha_{k}}{\lvert\mathcal{C}_{k}\rvert}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.11" class="ltx_p">Next, the aggregation weights are normalized so that their sum equals 1.
Intuitively, a local model that exhibits higher probabilities for accurate class predictions and maintains consistent performance across all classes receives greater coefficients.
Finally, with the dynamic weights, the new aggregated global model for the next training round can be expressed as</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.4" class="ltx_Math" alttext="w^{(r+1)}=\sum_{i}^{|U|}\beta_{i}w_{i}^{(r)}." display="block"><semantics id="S4.E5.m1.4a"><mrow id="S4.E5.m1.4.4.1" xref="S4.E5.m1.4.4.1.1.cmml"><mrow id="S4.E5.m1.4.4.1.1" xref="S4.E5.m1.4.4.1.1.cmml"><msup id="S4.E5.m1.4.4.1.1.2" xref="S4.E5.m1.4.4.1.1.2.cmml"><mi id="S4.E5.m1.4.4.1.1.2.2" xref="S4.E5.m1.4.4.1.1.2.2.cmml">w</mi><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.2.cmml">r</mi><mo id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo rspace="0.111em" id="S4.E5.m1.4.4.1.1.1" xref="S4.E5.m1.4.4.1.1.1.cmml">=</mo><mrow id="S4.E5.m1.4.4.1.1.3" xref="S4.E5.m1.4.4.1.1.3.cmml"><munderover id="S4.E5.m1.4.4.1.1.3.1" xref="S4.E5.m1.4.4.1.1.3.1.cmml"><mo movablelimits="false" id="S4.E5.m1.4.4.1.1.3.1.2.2" xref="S4.E5.m1.4.4.1.1.3.1.2.2.cmml">∑</mo><mi id="S4.E5.m1.4.4.1.1.3.1.2.3" xref="S4.E5.m1.4.4.1.1.3.1.2.3.cmml">i</mi><mrow id="S4.E5.m1.2.2.1.3" xref="S4.E5.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.3.1" xref="S4.E5.m1.2.2.1.2.1.cmml">|</mo><mi id="S4.E5.m1.2.2.1.1" xref="S4.E5.m1.2.2.1.1.cmml">U</mi><mo stretchy="false" id="S4.E5.m1.2.2.1.3.2" xref="S4.E5.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E5.m1.4.4.1.1.3.2" xref="S4.E5.m1.4.4.1.1.3.2.cmml"><msub id="S4.E5.m1.4.4.1.1.3.2.2" xref="S4.E5.m1.4.4.1.1.3.2.2.cmml"><mi id="S4.E5.m1.4.4.1.1.3.2.2.2" xref="S4.E5.m1.4.4.1.1.3.2.2.2.cmml">β</mi><mi id="S4.E5.m1.4.4.1.1.3.2.2.3" xref="S4.E5.m1.4.4.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.1.1.3.2.1" xref="S4.E5.m1.4.4.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E5.m1.4.4.1.1.3.2.3" xref="S4.E5.m1.4.4.1.1.3.2.3.cmml"><mi id="S4.E5.m1.4.4.1.1.3.2.3.2.2" xref="S4.E5.m1.4.4.1.1.3.2.3.2.2.cmml">w</mi><mi id="S4.E5.m1.4.4.1.1.3.2.3.2.3" xref="S4.E5.m1.4.4.1.1.3.2.3.2.3.cmml">i</mi><mrow id="S4.E5.m1.3.3.1.3" xref="S4.E5.m1.4.4.1.1.3.2.3.cmml"><mo stretchy="false" id="S4.E5.m1.3.3.1.3.1" xref="S4.E5.m1.4.4.1.1.3.2.3.cmml">(</mo><mi id="S4.E5.m1.3.3.1.1" xref="S4.E5.m1.3.3.1.1.cmml">r</mi><mo stretchy="false" id="S4.E5.m1.3.3.1.3.2" xref="S4.E5.m1.4.4.1.1.3.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo lspace="0em" id="S4.E5.m1.4.4.1.2" xref="S4.E5.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.4b"><apply id="S4.E5.m1.4.4.1.1.cmml" xref="S4.E5.m1.4.4.1"><eq id="S4.E5.m1.4.4.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1"></eq><apply id="S4.E5.m1.4.4.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.2.1.cmml" xref="S4.E5.m1.4.4.1.1.2">superscript</csymbol><ci id="S4.E5.m1.4.4.1.1.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2">𝑤</ci><apply id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1"><plus id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1"></plus><ci id="S4.E5.m1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.2">𝑟</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.E5.m1.4.4.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.3"><apply id="S4.E5.m1.4.4.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.3.1.1.cmml" xref="S4.E5.m1.4.4.1.1.3.1">superscript</csymbol><apply id="S4.E5.m1.4.4.1.1.3.1.2.cmml" xref="S4.E5.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.3.1.2.1.cmml" xref="S4.E5.m1.4.4.1.1.3.1">subscript</csymbol><sum id="S4.E5.m1.4.4.1.1.3.1.2.2.cmml" xref="S4.E5.m1.4.4.1.1.3.1.2.2"></sum><ci id="S4.E5.m1.4.4.1.1.3.1.2.3.cmml" xref="S4.E5.m1.4.4.1.1.3.1.2.3">𝑖</ci></apply><apply id="S4.E5.m1.2.2.1.2.cmml" xref="S4.E5.m1.2.2.1.3"><abs id="S4.E5.m1.2.2.1.2.1.cmml" xref="S4.E5.m1.2.2.1.3.1"></abs><ci id="S4.E5.m1.2.2.1.1.cmml" xref="S4.E5.m1.2.2.1.1">𝑈</ci></apply></apply><apply id="S4.E5.m1.4.4.1.1.3.2.cmml" xref="S4.E5.m1.4.4.1.1.3.2"><times id="S4.E5.m1.4.4.1.1.3.2.1.cmml" xref="S4.E5.m1.4.4.1.1.3.2.1"></times><apply id="S4.E5.m1.4.4.1.1.3.2.2.cmml" xref="S4.E5.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.3.2.2.1.cmml" xref="S4.E5.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.3.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.3.2.2.2">𝛽</ci><ci id="S4.E5.m1.4.4.1.1.3.2.2.3.cmml" xref="S4.E5.m1.4.4.1.1.3.2.2.3">𝑖</ci></apply><apply id="S4.E5.m1.4.4.1.1.3.2.3.cmml" xref="S4.E5.m1.4.4.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.3.2.3.1.cmml" xref="S4.E5.m1.4.4.1.1.3.2.3">superscript</csymbol><apply id="S4.E5.m1.4.4.1.1.3.2.3.2.cmml" xref="S4.E5.m1.4.4.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.3.2.3.2.1.cmml" xref="S4.E5.m1.4.4.1.1.3.2.3">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.3.2.3.2.2.cmml" xref="S4.E5.m1.4.4.1.1.3.2.3.2.2">𝑤</ci><ci id="S4.E5.m1.4.4.1.1.3.2.3.2.3.cmml" xref="S4.E5.m1.4.4.1.1.3.2.3.2.3">𝑖</ci></apply><ci id="S4.E5.m1.3.3.1.1.cmml" xref="S4.E5.m1.3.3.1.1">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.4c">w^{(r+1)}=\sum_{i}^{|U|}\beta_{i}w_{i}^{(r)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Evaluation</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we first outline our experimental setup, followed by a comparison of FedMADE with other FL methods in terms of attack detection and classification. Finally, we analyze the robustness and latency of our method to examine the practicality and feasibility of implementing FedMADE.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p"><span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_bold">Data Preprocessing.</span> The CICIoT2023 dataset is divided into training and testing subsets, containing 80% and 20% of the samples, respectively. The input features are normalized using min-max scaling.
To alleviate the class imbalance issue in local traffic, the Synthetic Minority Oversampling Technique (SMOTE) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> is employed to oversample classes, excluding DoS, DDoS and Mirai attacks. Specifically, the number of samples in web-based and brute force attacks is quadrupled, while the number of samples from other traffic classes is doubled. This configuration is designed to improve the representation of minority classes without causing the model to become overfitted to them. SMOTE generates synthetic samples for minority classes by interpolating between several close examples in the feature space.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.4" class="ltx_p"><span id="S5.SS1.p2.4.1" class="ltx_text ltx_font_bold">FL System.</span> We employ two base models in the FL system: a Convolutional Neural Network (CNN) and a Fully Connected Neural Network (FCNN). The CNN model is structured with two convolutional layers followed by one dense layer.
The FCNN model consists of three dense layers, each followed by a dropout layer. The more detailed architectures are provided in Appendix <a href="#Pt0.A1" title="Appendix 0.A Model Architecture ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">0.A</span></a>.
In each communication round, a subset of local clients is randomly selected to participate, with client sampling rate <math id="S5.SS1.p2.1.m1.2" class="ltx_Math" alttext="\gamma\in\{0.5,1\}" display="inline"><semantics id="S5.SS1.p2.1.m1.2a"><mrow id="S5.SS1.p2.1.m1.2.3" xref="S5.SS1.p2.1.m1.2.3.cmml"><mi id="S5.SS1.p2.1.m1.2.3.2" xref="S5.SS1.p2.1.m1.2.3.2.cmml">γ</mi><mo id="S5.SS1.p2.1.m1.2.3.1" xref="S5.SS1.p2.1.m1.2.3.1.cmml">∈</mo><mrow id="S5.SS1.p2.1.m1.2.3.3.2" xref="S5.SS1.p2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS1.p2.1.m1.2.3.3.2.1" xref="S5.SS1.p2.1.m1.2.3.3.1.cmml">{</mo><mn id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">0.5</mn><mo id="S5.SS1.p2.1.m1.2.3.3.2.2" xref="S5.SS1.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="S5.SS1.p2.1.m1.2.2" xref="S5.SS1.p2.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S5.SS1.p2.1.m1.2.3.3.2.3" xref="S5.SS1.p2.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.2b"><apply id="S5.SS1.p2.1.m1.2.3.cmml" xref="S5.SS1.p2.1.m1.2.3"><in id="S5.SS1.p2.1.m1.2.3.1.cmml" xref="S5.SS1.p2.1.m1.2.3.1"></in><ci id="S5.SS1.p2.1.m1.2.3.2.cmml" xref="S5.SS1.p2.1.m1.2.3.2">𝛾</ci><set id="S5.SS1.p2.1.m1.2.3.3.1.cmml" xref="S5.SS1.p2.1.m1.2.3.3.2"><cn type="float" id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">0.5</cn><cn type="integer" id="S5.SS1.p2.1.m1.2.2.cmml" xref="S5.SS1.p2.1.m1.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.2c">\gamma\in\{0.5,1\}</annotation></semantics></math>.
While <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="\gamma=1" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mrow id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml"><mi id="S5.SS1.p2.2.m2.1.1.2" xref="S5.SS1.p2.2.m2.1.1.2.cmml">γ</mi><mo id="S5.SS1.p2.2.m2.1.1.1" xref="S5.SS1.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.2.m2.1.1.3" xref="S5.SS1.p2.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><apply id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1"><eq id="S5.SS1.p2.2.m2.1.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1.1"></eq><ci id="S5.SS1.p2.2.m2.1.1.2.cmml" xref="S5.SS1.p2.2.m2.1.1.2">𝛾</ci><cn type="integer" id="S5.SS1.p2.2.m2.1.1.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">\gamma=1</annotation></semantics></math> expresses the ideal scenario where all local models participate in each communication round,
<math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="\gamma=0.5" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><mrow id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml"><mi id="S5.SS1.p2.3.m3.1.1.2" xref="S5.SS1.p2.3.m3.1.1.2.cmml">γ</mi><mo id="S5.SS1.p2.3.m3.1.1.1" xref="S5.SS1.p2.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.3.m3.1.1.3" xref="S5.SS1.p2.3.m3.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><apply id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1"><eq id="S5.SS1.p2.3.m3.1.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1.1"></eq><ci id="S5.SS1.p2.3.m3.1.1.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2">𝛾</ci><cn type="float" id="S5.SS1.p2.3.m3.1.1.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">\gamma=0.5</annotation></semantics></math> demonstrates a more practical scenario where devices with minority attacks do not consistently participate in each training round<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>The <math id="footnote4.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="footnote4.m1.1b"><mi id="footnote4.m1.1.1" xref="footnote4.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="footnote4.m1.1c"><ci id="footnote4.m1.1.1.cmml" xref="footnote4.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m1.1d">\gamma</annotation></semantics></math> value can be adjusted based on real IoT network configurations.</span></span></span>.
In each communication round, participating clients update their local models for two epochs using the Adam optimizer set at a learning rate of <math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="5\times 10^{-4}" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><mrow id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml"><mn id="S5.SS1.p2.4.m4.1.1.2" xref="S5.SS1.p2.4.m4.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p2.4.m4.1.1.1" xref="S5.SS1.p2.4.m4.1.1.1.cmml">×</mo><msup id="S5.SS1.p2.4.m4.1.1.3" xref="S5.SS1.p2.4.m4.1.1.3.cmml"><mn id="S5.SS1.p2.4.m4.1.1.3.2" xref="S5.SS1.p2.4.m4.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.p2.4.m4.1.1.3.3" xref="S5.SS1.p2.4.m4.1.1.3.3.cmml"><mo id="S5.SS1.p2.4.m4.1.1.3.3a" xref="S5.SS1.p2.4.m4.1.1.3.3.cmml">−</mo><mn id="S5.SS1.p2.4.m4.1.1.3.3.2" xref="S5.SS1.p2.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><apply id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1"><times id="S5.SS1.p2.4.m4.1.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1.1"></times><cn type="integer" id="S5.SS1.p2.4.m4.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2">5</cn><apply id="S5.SS1.p2.4.m4.1.1.3.cmml" xref="S5.SS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p2.4.m4.1.1.3.1.cmml" xref="S5.SS1.p2.4.m4.1.1.3">superscript</csymbol><cn type="integer" id="S5.SS1.p2.4.m4.1.1.3.2.cmml" xref="S5.SS1.p2.4.m4.1.1.3.2">10</cn><apply id="S5.SS1.p2.4.m4.1.1.3.3.cmml" xref="S5.SS1.p2.4.m4.1.1.3.3"><minus id="S5.SS1.p2.4.m4.1.1.3.3.1.cmml" xref="S5.SS1.p2.4.m4.1.1.3.3"></minus><cn type="integer" id="S5.SS1.p2.4.m4.1.1.3.3.2.cmml" xref="S5.SS1.p2.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">5\times 10^{-4}</annotation></semantics></math>. After local updates, these models are sent back to the central server. The server then generates a new global model and evaluates it using a validation dataset. If the new model achieves higher classification accuracy than the previous ones, it is retained as the best model until it is surpassed by another model with superior accuracy. Eventually, the best model is deployed in all IoT devices for attack detection or classification.
To calculate aggregation weights, we use the Adam optimizer with a learning rate of 0.01 to solve the optimization problem.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.3" class="ltx_p"><span id="S5.SS1.p3.3.1" class="ltx_text ltx_font_bold">Evaluation Metrics.</span> To evaluate the overall detection performance, we employ metrics such as precision, recall, F1 score, and accuracy. Additionally, to assess the model’s performance on each minority class, we employ per-class accuracy to overcome the effect of class size in the testing dataset. Precision is defined as <math id="S5.SS1.p3.1.m1.1" class="ltx_Math" alttext="\frac{TP}{TP+FP}" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><mfrac id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml"><mrow id="S5.SS1.p3.1.m1.1.1.2" xref="S5.SS1.p3.1.m1.1.1.2.cmml"><mi id="S5.SS1.p3.1.m1.1.1.2.2" xref="S5.SS1.p3.1.m1.1.1.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.1.m1.1.1.2.1" xref="S5.SS1.p3.1.m1.1.1.2.1.cmml">​</mo><mi id="S5.SS1.p3.1.m1.1.1.2.3" xref="S5.SS1.p3.1.m1.1.1.2.3.cmml">P</mi></mrow><mrow id="S5.SS1.p3.1.m1.1.1.3" xref="S5.SS1.p3.1.m1.1.1.3.cmml"><mrow id="S5.SS1.p3.1.m1.1.1.3.2" xref="S5.SS1.p3.1.m1.1.1.3.2.cmml"><mi id="S5.SS1.p3.1.m1.1.1.3.2.2" xref="S5.SS1.p3.1.m1.1.1.3.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.1.m1.1.1.3.2.1" xref="S5.SS1.p3.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.1.m1.1.1.3.2.3" xref="S5.SS1.p3.1.m1.1.1.3.2.3.cmml">P</mi></mrow><mo id="S5.SS1.p3.1.m1.1.1.3.1" xref="S5.SS1.p3.1.m1.1.1.3.1.cmml">+</mo><mrow id="S5.SS1.p3.1.m1.1.1.3.3" xref="S5.SS1.p3.1.m1.1.1.3.3.cmml"><mi id="S5.SS1.p3.1.m1.1.1.3.3.2" xref="S5.SS1.p3.1.m1.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.1.m1.1.1.3.3.1" xref="S5.SS1.p3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p3.1.m1.1.1.3.3.3" xref="S5.SS1.p3.1.m1.1.1.3.3.3.cmml">P</mi></mrow></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><apply id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1"><divide id="S5.SS1.p3.1.m1.1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1"></divide><apply id="S5.SS1.p3.1.m1.1.1.2.cmml" xref="S5.SS1.p3.1.m1.1.1.2"><times id="S5.SS1.p3.1.m1.1.1.2.1.cmml" xref="S5.SS1.p3.1.m1.1.1.2.1"></times><ci id="S5.SS1.p3.1.m1.1.1.2.2.cmml" xref="S5.SS1.p3.1.m1.1.1.2.2">𝑇</ci><ci id="S5.SS1.p3.1.m1.1.1.2.3.cmml" xref="S5.SS1.p3.1.m1.1.1.2.3">𝑃</ci></apply><apply id="S5.SS1.p3.1.m1.1.1.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3"><plus id="S5.SS1.p3.1.m1.1.1.3.1.cmml" xref="S5.SS1.p3.1.m1.1.1.3.1"></plus><apply id="S5.SS1.p3.1.m1.1.1.3.2.cmml" xref="S5.SS1.p3.1.m1.1.1.3.2"><times id="S5.SS1.p3.1.m1.1.1.3.2.1.cmml" xref="S5.SS1.p3.1.m1.1.1.3.2.1"></times><ci id="S5.SS1.p3.1.m1.1.1.3.2.2.cmml" xref="S5.SS1.p3.1.m1.1.1.3.2.2">𝑇</ci><ci id="S5.SS1.p3.1.m1.1.1.3.2.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3.2.3">𝑃</ci></apply><apply id="S5.SS1.p3.1.m1.1.1.3.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3"><times id="S5.SS1.p3.1.m1.1.1.3.3.1.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3.1"></times><ci id="S5.SS1.p3.1.m1.1.1.3.3.2.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3.2">𝐹</ci><ci id="S5.SS1.p3.1.m1.1.1.3.3.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3.3">𝑃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">\frac{TP}{TP+FP}</annotation></semantics></math>, where TP and FP denote the number of true positives and false positives, respectively. Recall is calculated as <math id="S5.SS1.p3.2.m2.1" class="ltx_Math" alttext="\frac{TP}{TP+FN}" display="inline"><semantics id="S5.SS1.p3.2.m2.1a"><mfrac id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml"><mrow id="S5.SS1.p3.2.m2.1.1.2" xref="S5.SS1.p3.2.m2.1.1.2.cmml"><mi id="S5.SS1.p3.2.m2.1.1.2.2" xref="S5.SS1.p3.2.m2.1.1.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.2.m2.1.1.2.1" xref="S5.SS1.p3.2.m2.1.1.2.1.cmml">​</mo><mi id="S5.SS1.p3.2.m2.1.1.2.3" xref="S5.SS1.p3.2.m2.1.1.2.3.cmml">P</mi></mrow><mrow id="S5.SS1.p3.2.m2.1.1.3" xref="S5.SS1.p3.2.m2.1.1.3.cmml"><mrow id="S5.SS1.p3.2.m2.1.1.3.2" xref="S5.SS1.p3.2.m2.1.1.3.2.cmml"><mi id="S5.SS1.p3.2.m2.1.1.3.2.2" xref="S5.SS1.p3.2.m2.1.1.3.2.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.2.m2.1.1.3.2.1" xref="S5.SS1.p3.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.2.m2.1.1.3.2.3" xref="S5.SS1.p3.2.m2.1.1.3.2.3.cmml">P</mi></mrow><mo id="S5.SS1.p3.2.m2.1.1.3.1" xref="S5.SS1.p3.2.m2.1.1.3.1.cmml">+</mo><mrow id="S5.SS1.p3.2.m2.1.1.3.3" xref="S5.SS1.p3.2.m2.1.1.3.3.cmml"><mi id="S5.SS1.p3.2.m2.1.1.3.3.2" xref="S5.SS1.p3.2.m2.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.2.m2.1.1.3.3.1" xref="S5.SS1.p3.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p3.2.m2.1.1.3.3.3" xref="S5.SS1.p3.2.m2.1.1.3.3.3.cmml">N</mi></mrow></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><apply id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1"><divide id="S5.SS1.p3.2.m2.1.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1"></divide><apply id="S5.SS1.p3.2.m2.1.1.2.cmml" xref="S5.SS1.p3.2.m2.1.1.2"><times id="S5.SS1.p3.2.m2.1.1.2.1.cmml" xref="S5.SS1.p3.2.m2.1.1.2.1"></times><ci id="S5.SS1.p3.2.m2.1.1.2.2.cmml" xref="S5.SS1.p3.2.m2.1.1.2.2">𝑇</ci><ci id="S5.SS1.p3.2.m2.1.1.2.3.cmml" xref="S5.SS1.p3.2.m2.1.1.2.3">𝑃</ci></apply><apply id="S5.SS1.p3.2.m2.1.1.3.cmml" xref="S5.SS1.p3.2.m2.1.1.3"><plus id="S5.SS1.p3.2.m2.1.1.3.1.cmml" xref="S5.SS1.p3.2.m2.1.1.3.1"></plus><apply id="S5.SS1.p3.2.m2.1.1.3.2.cmml" xref="S5.SS1.p3.2.m2.1.1.3.2"><times id="S5.SS1.p3.2.m2.1.1.3.2.1.cmml" xref="S5.SS1.p3.2.m2.1.1.3.2.1"></times><ci id="S5.SS1.p3.2.m2.1.1.3.2.2.cmml" xref="S5.SS1.p3.2.m2.1.1.3.2.2">𝑇</ci><ci id="S5.SS1.p3.2.m2.1.1.3.2.3.cmml" xref="S5.SS1.p3.2.m2.1.1.3.2.3">𝑃</ci></apply><apply id="S5.SS1.p3.2.m2.1.1.3.3.cmml" xref="S5.SS1.p3.2.m2.1.1.3.3"><times id="S5.SS1.p3.2.m2.1.1.3.3.1.cmml" xref="S5.SS1.p3.2.m2.1.1.3.3.1"></times><ci id="S5.SS1.p3.2.m2.1.1.3.3.2.cmml" xref="S5.SS1.p3.2.m2.1.1.3.3.2">𝐹</ci><ci id="S5.SS1.p3.2.m2.1.1.3.3.3.cmml" xref="S5.SS1.p3.2.m2.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">\frac{TP}{TP+FN}</annotation></semantics></math>, with FN indicating the number of false negatives. The F1 Score is computed as <math id="S5.SS1.p3.3.m3.1" class="ltx_Math" alttext="2\times\frac{Precision\times Recall}{Precision+Recall}" display="inline"><semantics id="S5.SS1.p3.3.m3.1a"><mrow id="S5.SS1.p3.3.m3.1.1" xref="S5.SS1.p3.3.m3.1.1.cmml"><mn id="S5.SS1.p3.3.m3.1.1.2" xref="S5.SS1.p3.3.m3.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p3.3.m3.1.1.1" xref="S5.SS1.p3.3.m3.1.1.1.cmml">×</mo><mfrac id="S5.SS1.p3.3.m3.1.1.3" xref="S5.SS1.p3.3.m3.1.1.3.cmml"><mrow id="S5.SS1.p3.3.m3.1.1.3.2" xref="S5.SS1.p3.3.m3.1.1.3.2.cmml"><mrow id="S5.SS1.p3.3.m3.1.1.3.2.2" xref="S5.SS1.p3.3.m3.1.1.3.2.2.cmml"><mrow id="S5.SS1.p3.3.m3.1.1.3.2.2.2" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.cmml"><mi id="S5.SS1.p3.3.m3.1.1.3.2.2.2.2" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.2.2.1" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.2.2.3" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.2.2.1a" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.2.2.4" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.2.2.1b" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.2.2.5" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.2.2.1c" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.2.2.6" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.2.2.1d" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.2.2.7" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.2.2.1e" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.2.2.8" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.2.2.1f" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.2.2.9" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.2.2.1g" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.2.2.10" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.10.cmml">n</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p3.3.m3.1.1.3.2.2.1" xref="S5.SS1.p3.3.m3.1.1.3.2.2.1.cmml">×</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.2.3" xref="S5.SS1.p3.3.m3.1.1.3.2.2.3.cmml">R</mi></mrow><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.1" xref="S5.SS1.p3.3.m3.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.3" xref="S5.SS1.p3.3.m3.1.1.3.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.1a" xref="S5.SS1.p3.3.m3.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.4" xref="S5.SS1.p3.3.m3.1.1.3.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.1b" xref="S5.SS1.p3.3.m3.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.5" xref="S5.SS1.p3.3.m3.1.1.3.2.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.1c" xref="S5.SS1.p3.3.m3.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.6" xref="S5.SS1.p3.3.m3.1.1.3.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.2.1d" xref="S5.SS1.p3.3.m3.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.2.7" xref="S5.SS1.p3.3.m3.1.1.3.2.7.cmml">l</mi></mrow><mrow id="S5.SS1.p3.3.m3.1.1.3.3" xref="S5.SS1.p3.3.m3.1.1.3.3.cmml"><mrow id="S5.SS1.p3.3.m3.1.1.3.3.2" xref="S5.SS1.p3.3.m3.1.1.3.3.2.cmml"><mi id="S5.SS1.p3.3.m3.1.1.3.3.2.2" xref="S5.SS1.p3.3.m3.1.1.3.3.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.2.1" xref="S5.SS1.p3.3.m3.1.1.3.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.2.3" xref="S5.SS1.p3.3.m3.1.1.3.3.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.2.1a" xref="S5.SS1.p3.3.m3.1.1.3.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.2.4" xref="S5.SS1.p3.3.m3.1.1.3.3.2.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.2.1b" xref="S5.SS1.p3.3.m3.1.1.3.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.2.5" xref="S5.SS1.p3.3.m3.1.1.3.3.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.2.1c" xref="S5.SS1.p3.3.m3.1.1.3.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.2.6" xref="S5.SS1.p3.3.m3.1.1.3.3.2.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.2.1d" xref="S5.SS1.p3.3.m3.1.1.3.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.2.7" xref="S5.SS1.p3.3.m3.1.1.3.3.2.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.2.1e" xref="S5.SS1.p3.3.m3.1.1.3.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.2.8" xref="S5.SS1.p3.3.m3.1.1.3.3.2.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.2.1f" xref="S5.SS1.p3.3.m3.1.1.3.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.2.9" xref="S5.SS1.p3.3.m3.1.1.3.3.2.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.2.1g" xref="S5.SS1.p3.3.m3.1.1.3.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.2.10" xref="S5.SS1.p3.3.m3.1.1.3.3.2.10.cmml">n</mi></mrow><mo id="S5.SS1.p3.3.m3.1.1.3.3.1" xref="S5.SS1.p3.3.m3.1.1.3.3.1.cmml">+</mo><mrow id="S5.SS1.p3.3.m3.1.1.3.3.3" xref="S5.SS1.p3.3.m3.1.1.3.3.3.cmml"><mi id="S5.SS1.p3.3.m3.1.1.3.3.3.2" xref="S5.SS1.p3.3.m3.1.1.3.3.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.3.1" xref="S5.SS1.p3.3.m3.1.1.3.3.3.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.3.3" xref="S5.SS1.p3.3.m3.1.1.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.3.1a" xref="S5.SS1.p3.3.m3.1.1.3.3.3.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.3.4" xref="S5.SS1.p3.3.m3.1.1.3.3.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.3.1b" xref="S5.SS1.p3.3.m3.1.1.3.3.3.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.3.5" xref="S5.SS1.p3.3.m3.1.1.3.3.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.3.1c" xref="S5.SS1.p3.3.m3.1.1.3.3.3.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.3.6" xref="S5.SS1.p3.3.m3.1.1.3.3.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.3.m3.1.1.3.3.3.1d" xref="S5.SS1.p3.3.m3.1.1.3.3.3.1.cmml">​</mo><mi id="S5.SS1.p3.3.m3.1.1.3.3.3.7" xref="S5.SS1.p3.3.m3.1.1.3.3.3.7.cmml">l</mi></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.3.m3.1b"><apply id="S5.SS1.p3.3.m3.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1"><times id="S5.SS1.p3.3.m3.1.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1.1"></times><cn type="integer" id="S5.SS1.p3.3.m3.1.1.2.cmml" xref="S5.SS1.p3.3.m3.1.1.2">2</cn><apply id="S5.SS1.p3.3.m3.1.1.3.cmml" xref="S5.SS1.p3.3.m3.1.1.3"><divide id="S5.SS1.p3.3.m3.1.1.3.1.cmml" xref="S5.SS1.p3.3.m3.1.1.3"></divide><apply id="S5.SS1.p3.3.m3.1.1.3.2.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2"><times id="S5.SS1.p3.3.m3.1.1.3.2.1.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.1"></times><apply id="S5.SS1.p3.3.m3.1.1.3.2.2.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2"><times id="S5.SS1.p3.3.m3.1.1.3.2.2.1.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.1"></times><apply id="S5.SS1.p3.3.m3.1.1.3.2.2.2.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2"><times id="S5.SS1.p3.3.m3.1.1.3.2.2.2.1.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.1"></times><ci id="S5.SS1.p3.3.m3.1.1.3.2.2.2.2.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.2">𝑃</ci><ci id="S5.SS1.p3.3.m3.1.1.3.2.2.2.3.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.3">𝑟</ci><ci id="S5.SS1.p3.3.m3.1.1.3.2.2.2.4.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.4">𝑒</ci><ci id="S5.SS1.p3.3.m3.1.1.3.2.2.2.5.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.5">𝑐</ci><ci id="S5.SS1.p3.3.m3.1.1.3.2.2.2.6.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.6">𝑖</ci><ci id="S5.SS1.p3.3.m3.1.1.3.2.2.2.7.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.7">𝑠</ci><ci id="S5.SS1.p3.3.m3.1.1.3.2.2.2.8.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.8">𝑖</ci><ci id="S5.SS1.p3.3.m3.1.1.3.2.2.2.9.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.9">𝑜</ci><ci id="S5.SS1.p3.3.m3.1.1.3.2.2.2.10.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.2.10">𝑛</ci></apply><ci id="S5.SS1.p3.3.m3.1.1.3.2.2.3.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.2.3">𝑅</ci></apply><ci id="S5.SS1.p3.3.m3.1.1.3.2.3.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.3">𝑒</ci><ci id="S5.SS1.p3.3.m3.1.1.3.2.4.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.4">𝑐</ci><ci id="S5.SS1.p3.3.m3.1.1.3.2.5.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.5">𝑎</ci><ci id="S5.SS1.p3.3.m3.1.1.3.2.6.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.6">𝑙</ci><ci id="S5.SS1.p3.3.m3.1.1.3.2.7.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2.7">𝑙</ci></apply><apply id="S5.SS1.p3.3.m3.1.1.3.3.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3"><plus id="S5.SS1.p3.3.m3.1.1.3.3.1.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.1"></plus><apply id="S5.SS1.p3.3.m3.1.1.3.3.2.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.2"><times id="S5.SS1.p3.3.m3.1.1.3.3.2.1.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.2.1"></times><ci id="S5.SS1.p3.3.m3.1.1.3.3.2.2.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.2.2">𝑃</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.2.3.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.2.3">𝑟</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.2.4.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.2.4">𝑒</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.2.5.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.2.5">𝑐</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.2.6.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.2.6">𝑖</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.2.7.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.2.7">𝑠</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.2.8.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.2.8">𝑖</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.2.9.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.2.9">𝑜</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.2.10.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.2.10">𝑛</ci></apply><apply id="S5.SS1.p3.3.m3.1.1.3.3.3.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.3"><times id="S5.SS1.p3.3.m3.1.1.3.3.3.1.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.3.1"></times><ci id="S5.SS1.p3.3.m3.1.1.3.3.3.2.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.3.2">𝑅</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.3.3.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.3.3">𝑒</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.3.4.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.3.4">𝑐</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.3.5.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.3.5">𝑎</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.3.6.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.3.6">𝑙</ci><ci id="S5.SS1.p3.3.m3.1.1.3.3.3.7.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.3.7">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.3.m3.1c">2\times\frac{Precision\times Recall}{Precision+Recall}</annotation></semantics></math>. Overall accuracy is determined by the ratio of correctly classified samples to the total number of samples, while per-class accuracy quantifies the proportion of correctly classified samples within each specific class.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Performance of FedMADE</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We begin by evaluating FedMADE’s ability to detect attacks through binary classification. Following that, we compare FedMADE with FedAvg and two other well-known methods that are designed for non-IID data—FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>—on attack classification into multiple classes.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p"><span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">Attack Detection (Binary classification).</span>
The main focus of our approach is on improving multi-class classification instead of binary classification, due to the fact that device-specific class imbalance becomes less significant when all attack types are grouped into a single class. However, we still present binary classification results for FedMADE and FedAvg to show their effectiveness in attack detection. Tables <a href="#S5.T3" title="Table 3 ‣ 5.2 Performance of FedMADE ‣ 5 Evaluation ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and <a href="#S5.T4" title="Table 4 ‣ 5.2 Performance of FedMADE ‣ 5 Evaluation ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> show the precision, recall, F1-score, and accuracy of using CNN and FCNN models. We observe that the performance of FedMADE is very similar to that of FedAvg, with both methods demonstrating strong attack detection capabilities and achieving F1 scores greater than 0.99, despite a marginal reduction in recall (up to 0.0023) in some cases.
This is largely because minority attack classes, such as web-based and brute force attacks, make up only 0.08% of all traffic flows, whereas major attacks like DoS/DDoS and Mirai constitute 95.76% of the traffic. Given the small proportion of minority attack classes, their impact on the overall performance of binary attack detection is negligible. Furthermore, rather than assuming all clients are honest, we illustrate the robustness of FedMADE to poisoned clients in Section <a href="#S5.SS3" title="5.3 Robustness ‣ 5 Evaluation ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.3</span></a>.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T3.4.2.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S5.T3.2.1" class="ltx_text" style="font-size:90%;">Performance on attack detection with <math id="S5.T3.2.1.m1.1" class="ltx_Math" alttext="\gamma=1.0" display="inline"><semantics id="S5.T3.2.1.m1.1b"><mrow id="S5.T3.2.1.m1.1.1" xref="S5.T3.2.1.m1.1.1.cmml"><mi id="S5.T3.2.1.m1.1.1.2" xref="S5.T3.2.1.m1.1.1.2.cmml">γ</mi><mo id="S5.T3.2.1.m1.1.1.1" xref="S5.T3.2.1.m1.1.1.1.cmml">=</mo><mn id="S5.T3.2.1.m1.1.1.3" xref="S5.T3.2.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.2.1.m1.1c"><apply id="S5.T3.2.1.m1.1.1.cmml" xref="S5.T3.2.1.m1.1.1"><eq id="S5.T3.2.1.m1.1.1.1.cmml" xref="S5.T3.2.1.m1.1.1.1"></eq><ci id="S5.T3.2.1.m1.1.1.2.cmml" xref="S5.T3.2.1.m1.1.1.2">𝛾</ci><cn type="float" id="S5.T3.2.1.m1.1.1.3.cmml" xref="S5.T3.2.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.1.m1.1d">\gamma=1.0</annotation></semantics></math>.</span></figcaption>
<table id="S5.T3.5" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.5.1.1" class="ltx_tr">
<td id="S5.T3.5.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Base Model</td>
<td id="S5.T3.5.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Aggregation</td>
<td id="S5.T3.5.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Precision</td>
<td id="S5.T3.5.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Recall</td>
<td id="S5.T3.5.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">F1 Score</td>
<td id="S5.T3.5.1.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Accuracy</td>
</tr>
<tr id="S5.T3.5.2.2" class="ltx_tr">
<td id="S5.T3.5.2.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T3.5.2.2.1.1" class="ltx_text">CNN</span></td>
<td id="S5.T3.5.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedAvg</td>
<td id="S5.T3.5.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9982</td>
<td id="S5.T3.5.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9947</td>
<td id="S5.T3.5.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9965</td>
<td id="S5.T3.5.2.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9931</td>
</tr>
<tr id="S5.T3.5.3.3" class="ltx_tr">
<td id="S5.T3.5.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedMADE</td>
<td id="S5.T3.5.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9990</td>
<td id="S5.T3.5.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9931</td>
<td id="S5.T3.5.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9960</td>
<td id="S5.T3.5.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9923</td>
</tr>
<tr id="S5.T3.5.4.4" class="ltx_tr">
<td id="S5.T3.5.4.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T3.5.4.4.1.1" class="ltx_text">FCNN</span></td>
<td id="S5.T3.5.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedAvg</td>
<td id="S5.T3.5.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9997</td>
<td id="S5.T3.5.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9913</td>
<td id="S5.T3.5.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9955</td>
<td id="S5.T3.5.4.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9912</td>
</tr>
<tr id="S5.T3.5.5.5" class="ltx_tr">
<td id="S5.T3.5.5.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">FedMADE</td>
<td id="S5.T3.5.5.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.9998</td>
<td id="S5.T3.5.5.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.9908</td>
<td id="S5.T3.5.5.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.9953</td>
<td id="S5.T3.5.5.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.9908</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T4.4.2.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S5.T4.2.1" class="ltx_text" style="font-size:90%;">Performance on attack detection with <math id="S5.T4.2.1.m1.1" class="ltx_Math" alttext="\gamma=0.5" display="inline"><semantics id="S5.T4.2.1.m1.1b"><mrow id="S5.T4.2.1.m1.1.1" xref="S5.T4.2.1.m1.1.1.cmml"><mi id="S5.T4.2.1.m1.1.1.2" xref="S5.T4.2.1.m1.1.1.2.cmml">γ</mi><mo id="S5.T4.2.1.m1.1.1.1" xref="S5.T4.2.1.m1.1.1.1.cmml">=</mo><mn id="S5.T4.2.1.m1.1.1.3" xref="S5.T4.2.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.2.1.m1.1c"><apply id="S5.T4.2.1.m1.1.1.cmml" xref="S5.T4.2.1.m1.1.1"><eq id="S5.T4.2.1.m1.1.1.1.cmml" xref="S5.T4.2.1.m1.1.1.1"></eq><ci id="S5.T4.2.1.m1.1.1.2.cmml" xref="S5.T4.2.1.m1.1.1.2">𝛾</ci><cn type="float" id="S5.T4.2.1.m1.1.1.3.cmml" xref="S5.T4.2.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.1.m1.1d">\gamma=0.5</annotation></semantics></math>.</span></figcaption>
<table id="S5.T4.5" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T4.5.1.1" class="ltx_tr">
<td id="S5.T4.5.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Base Model</td>
<td id="S5.T4.5.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Aggregation</td>
<td id="S5.T4.5.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Precision</td>
<td id="S5.T4.5.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Recall</td>
<td id="S5.T4.5.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">F1 Score</td>
<td id="S5.T4.5.1.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Accuracy</td>
</tr>
<tr id="S5.T4.5.2.2" class="ltx_tr">
<td id="S5.T4.5.2.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T4.5.2.2.1.1" class="ltx_text">CNN</span></td>
<td id="S5.T4.5.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedAvg</td>
<td id="S5.T4.5.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9983</td>
<td id="S5.T4.5.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9948</td>
<td id="S5.T4.5.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9965</td>
<td id="S5.T4.5.2.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9932</td>
</tr>
<tr id="S5.T4.5.3.3" class="ltx_tr">
<td id="S5.T4.5.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedMADE</td>
<td id="S5.T4.5.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9985</td>
<td id="S5.T4.5.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9945</td>
<td id="S5.T4.5.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9965</td>
<td id="S5.T4.5.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9932</td>
</tr>
<tr id="S5.T4.5.4.4" class="ltx_tr">
<td id="S5.T4.5.4.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T4.5.4.4.1.1" class="ltx_text">FCNN</span></td>
<td id="S5.T4.5.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedAvg</td>
<td id="S5.T4.5.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9989</td>
<td id="S5.T4.5.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9940</td>
<td id="S5.T4.5.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9965</td>
<td id="S5.T4.5.4.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.9931</td>
</tr>
<tr id="S5.T4.5.5.5" class="ltx_tr">
<td id="S5.T4.5.5.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">FedMADE</td>
<td id="S5.T4.5.5.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.9997</td>
<td id="S5.T4.5.5.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.9917</td>
<td id="S5.T4.5.5.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.9957</td>
<td id="S5.T4.5.5.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.9916</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.2" class="ltx_p"><span id="S5.SS2.p3.2.1" class="ltx_text ltx_font_bold">Attack Classification (Multi-class classification).</span>
Considering the significant class size differences between different attack types, we use per-class accuracy to demonstrate the model’s classification performance on each type of traffic. Figures <a href="#S5.F2" title="Figure 2 ‣ 5.2 Performance of FedMADE ‣ 5 Evaluation ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#S5.F3" title="Figure 3 ‣ 5.2 Performance of FedMADE ‣ 5 Evaluation ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> compare the proposed FedMADE method with FedAvg, FedProx, and SCAFFOLD. When <math id="S5.SS2.p3.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS2.p3.1.m1.1a"><mi id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><ci id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">\gamma</annotation></semantics></math> is set to 1.0, FedMADE improves the classification accuracy for minority attack classes, including web-based and brute force attacks. Specifically, the classification accuracy of web-based attacks increases to 58.5% and 69.5%, using the CNN and FCNN models, respectively. For brute force attacks, the accuracy increases to 51.4% with CNN and 47.1% with FCNN.
The improvement can be attributed to FedMADE’s ability to direct the global model’s attention towards local models that consistently demonstrate strong performance across all classes. In contrast, other FL methods either fail to classify minority attacks or achieve an accuracy of only up to 13.8%.
FedMADE exhibits a slight decrease in accuracy for classifying benign traffic and reconnaissance attacks, which is attributed to the inherent limitations of the base models (i.e., CNN and FCNN) in distinguishing between benign traffic, reconnaissance, web-based, and brute force attacks, as demonstrated in the original paper on the CICIoT2023 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. These decreases are within an acceptable range, given the significant improvement in classifying minority attacks, leading to a more accurate diagnosis of network conditions.
Similarly, in a realistic setting with <math id="S5.SS2.p3.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS2.p3.2.m2.1a"><mi id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><ci id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">\gamma</annotation></semantics></math> set to 0.5, FedMADE increases the accuracy of minority attack classification to 71.07%. In contrast, while FedProx and SCAFFOLD maintain accuracy for benign traffic, they severely impact the classification of reconnaissance and spoofing attacks as compared to FedMADE and do not improve the accuracy of minority attack classification.</p>
</div>
<figure id="S5.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.07152/assets/figs/bar_cnn.png" id="S5.F2.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="104" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F2.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F2.sf1.3.2" class="ltx_text" style="font-size:90%;">CNN model</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.07152/assets/figs/bar_dnn.png" id="S5.F2.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="104" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F2.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F2.sf2.3.2" class="ltx_text" style="font-size:90%;">FCNN model</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S5.F2.3.2" class="ltx_text" style="font-size:90%;">Comparison of performance across different FL methods for each class with a client sampling rate of 1.0. ‘0’ denotes the FL model fails to correctly classify any sample from that class.</span></figcaption>
</figure>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.07152/assets/figs/bar_cnn_gamma05.png" id="S5.F3.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="249" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">CNN model</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.07152/assets/figs/bar_dnn_gamma05.png" id="S5.F3.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="248" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">FCNN model</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.3.2" class="ltx_text" style="font-size:90%;">
Performance comparison at a client sampling rate of 0.5, excluding DDoS/DoS and Mirai attacks, as each FL method consistently achieves over 99% accuracy for these attacks.</span></figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Robustness</h3>

<figure id="S5.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.07152/assets/figs/robustness.png" id="S5.F4.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="205" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F4.sf1.3.2" class="ltx_text" style="font-size:90%;">Data poisoning attacks</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2408.07152/assets/figs/robustness_model.png" id="S5.F4.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="205" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F4.sf2.3.2" class="ltx_text" style="font-size:90%;">Model poisoning attacks</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.6.3.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.4.2" class="ltx_text" style="font-size:90%;">Per-class accuracy under label flipping and model poisoning attacks. ‘Attack <math id="S5.F4.3.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.F4.3.1.m1.1b"><mo stretchy="false" id="S5.F4.3.1.m1.1.1" xref="S5.F4.3.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.F4.3.1.m1.1c"><ci id="S5.F4.3.1.m1.1.1.cmml" xref="S5.F4.3.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.3.1.m1.1d">\rightarrow</annotation></semantics></math> Benign’ and ‘Benign <math id="S5.F4.4.2.m2.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.F4.4.2.m2.1b"><mo stretchy="false" id="S5.F4.4.2.m2.1.1" xref="S5.F4.4.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.F4.4.2.m2.1c"><ci id="S5.F4.4.2.m2.1.1.cmml" xref="S5.F4.4.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.4.2.m2.1d">\rightarrow</annotation></semantics></math> Attack’ represent scenarios where attack traffic is labeled as benign, and benign traffic is labeled as attack, respectively.</span></figcaption>
</figure>
<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.3" class="ltx_p">Instead of assuming all clients are honest, we consider some clients are compromised in adversarial settings.
The attacker’s goal is to mislead the FL model into incorrectly classifying incoming traffic. Following the attack scenarios targeting attack detection models outlined in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, we study two categories of poisoning attacks: data poisoning, where attackers modify the labels of the traffic data, and model poisoning, where the training process of the local models is manipulated. For both attacks, we explore two scenarios: attack label flipping, where attack traffic labels are altered to benign, and benign label flipping, where benign traffic labels are modified to attack.
The details of the poisoning attacks are as follows. (1) For data poisoning attacks, the percentage of compromised devices varies from 5% to 40%. While fewer compromised devices are more practical, we extend our analysis to include up to 40% compromised clients to assess the resilience of our aggregation method under severe adversarial conditions. (2) For model poisoning attacks, we limit the percentage of compromised clients to 5% and scale up the malicious models using different scaling factors. Specifically, compromised clients upload model weights scaled by a factor, <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="\lambda w" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mrow id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p1.1.m1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.cmml">​</mo><mi id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><times id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1"></times><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝜆</ci><ci id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\lambda w</annotation></semantics></math>, rather than the original weights <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mi id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><ci id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">w</annotation></semantics></math>, to the server, where <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mi id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><ci id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">\lambda</annotation></semantics></math> ranges from 5 to 40 in evaluation.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.4" class="ltx_p">Figure <a href="#S5.F4" title="Figure 4 ‣ 5.3 Robustness ‣ 5 Evaluation ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> presents a performance comparison of FL-based IDSs using the CNN model under data and model poisoning attacks. For data poisoning, as the percentage of compromised devices increases, the per-class accuracy of victim classes declines with the FedAvg method.
In contrast, IDS performance using FedMADE remains stable and is not significantly affected by an increase in the number of compromised devices. For instance, in a scenario with 35% compromised devices, the accuracy of attack and benign traffic classified using FedAvg decreases to <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="94.44\%" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mn id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">94.44</mn><mo id="S5.SS3.p2.1.m1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><csymbol cd="latexml" id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1">percent</csymbol><cn type="float" id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2">94.44</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">94.44\%</annotation></semantics></math> and <math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="23.22\%" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><mrow id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mn id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">23.22</mn><mo id="S5.SS3.p2.2.m2.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><csymbol cd="latexml" id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">23.22</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">23.22\%</annotation></semantics></math> (Figure <a href="#S5.F4" title="Figure 4 ‣ 5.3 Robustness ‣ 5 Evaluation ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(a)), respectively.
However, with FedMADE, these values are observed to be <math id="S5.SS3.p2.3.m3.1" class="ltx_Math" alttext="98.20\%" display="inline"><semantics id="S5.SS3.p2.3.m3.1a"><mrow id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml"><mn id="S5.SS3.p2.3.m3.1.1.2" xref="S5.SS3.p2.3.m3.1.1.2.cmml">98.20</mn><mo id="S5.SS3.p2.3.m3.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><apply id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1"><csymbol cd="latexml" id="S5.SS3.p2.3.m3.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1">percent</csymbol><cn type="float" id="S5.SS3.p2.3.m3.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.2">98.20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">98.20\%</annotation></semantics></math> and <math id="S5.SS3.p2.4.m4.1" class="ltx_Math" alttext="98.35\%" display="inline"><semantics id="S5.SS3.p2.4.m4.1a"><mrow id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml"><mn id="S5.SS3.p2.4.m4.1.1.2" xref="S5.SS3.p2.4.m4.1.1.2.cmml">98.35</mn><mo id="S5.SS3.p2.4.m4.1.1.1" xref="S5.SS3.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><apply id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1"><csymbol cd="latexml" id="S5.SS3.p2.4.m4.1.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1.1">percent</csymbol><cn type="float" id="S5.SS3.p2.4.m4.1.1.2.cmml" xref="S5.SS3.p2.4.m4.1.1.2">98.35</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">98.35\%</annotation></semantics></math> respectively. This robustness stems from the optimization mechanism where poisoned local models receive negligible aggregation weights due to the deviation of their CPMs from those of benign clients, consequently reducing their impact on the global model. We observe similar behaviour in case of model poisoning attacks (Figure <a href="#S5.F4" title="Figure 4 ‣ 5.3 Robustness ‣ 5 Evaluation ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(b)), bolstering our claim that FedMADE is more robust as an aggregation method compared to FedAvg within the context of IDS deployments in IoT networks.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Latency Analysis</h3>

<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T5.4.1.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="S5.T5.5.2" class="ltx_text" style="font-size:90%;">Latency comparison. ‘Ratio’ refers to the relative increase in each method’s round training time compared to that of FedAvg.</span></figcaption>
<table id="S5.T5.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T5.2.2" class="ltx_tr">
<th id="S5.T5.2.2.3" class="ltx_td ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" rowspan="2"></th>
<th id="S5.T5.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2">
<math id="S5.T5.1.1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.T5.1.1.1.m1.1a"><mi id="S5.T5.1.1.1.m1.1.1" xref="S5.T5.1.1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.T5.1.1.1.m1.1b"><ci id="S5.T5.1.1.1.m1.1.1.cmml" xref="S5.T5.1.1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.1.1.1.m1.1c">\gamma</annotation></semantics></math> = 0.5</th>
<th id="S5.T5.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2">
<math id="S5.T5.2.2.2.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.T5.2.2.2.m1.1a"><mi id="S5.T5.2.2.2.m1.1.1" xref="S5.T5.2.2.2.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.T5.2.2.2.m1.1b"><ci id="S5.T5.2.2.2.m1.1.1.cmml" xref="S5.T5.2.2.2.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.2.2.2.m1.1c">\gamma</annotation></semantics></math> = 1.0</th>
</tr>
<tr id="S5.T5.2.3.1" class="ltx_tr">
<td id="S5.T5.2.3.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Round Training Times (s)</td>
<td id="S5.T5.2.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Ratio</td>
<td id="S5.T5.2.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Round Training Times (s)</td>
<td id="S5.T5.2.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Ratio</td>
</tr>
<tr id="S5.T5.2.4.2" class="ltx_tr">
<td id="S5.T5.2.4.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">FedAvg</td>
<td id="S5.T5.2.4.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">107.46</td>
<td id="S5.T5.2.4.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S5.T5.2.4.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">221.82</td>
<td id="S5.T5.2.4.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
</tr>
<tr id="S5.T5.2.5.3" class="ltx_tr">
<td id="S5.T5.2.5.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">FedProx</td>
<td id="S5.T5.2.5.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">132.51</td>
<td id="S5.T5.2.5.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">23.3%</td>
<td id="S5.T5.2.5.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">269.60</td>
<td id="S5.T5.2.5.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">21.5%</td>
</tr>
<tr id="S5.T5.2.6.4" class="ltx_tr">
<td id="S5.T5.2.6.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">SCAFFOLD</td>
<td id="S5.T5.2.6.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">161.38</td>
<td id="S5.T5.2.6.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">50.2%</td>
<td id="S5.T5.2.6.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">333.78</td>
<td id="S5.T5.2.6.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">50.5%</td>
</tr>
<tr id="S5.T5.2.7.5" class="ltx_tr">
<td id="S5.T5.2.7.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">FedMADE</td>
<td id="S5.T5.2.7.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">112.49</td>
<td id="S5.T5.2.7.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">4.7%</td>
<td id="S5.T5.2.7.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">227.66</td>
<td id="S5.T5.2.7.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">2.6%</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">For the implementation of any FL-based IDS methods in practical, large-scale IoT network environments, it is essential to conduct an analysis of their latency in the distributed training process.
The factors contributing towards latency of FedMADE are (1) calculation of CPMs for local models (Equation <a href="#S4.E1" title="In 4.2 Client Clustering ‣ 4 Proposed Method: FedMADE ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), and (2) minimization of the distance between the weighted sum of CPMs and the identity matrix (Equation <a href="#S4.E3" title="In 4.3 Dynamic Aggregation Weight Calculation ‣ 4 Proposed Method: FedMADE ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
It is worth noting that all operations associated with FedMADE are conducted on the central server, preventing any additional computational burden on the IoT devices.
Given the negligible differences observed in convergence rates with respect to training rounds (refer to Appendix <a href="#Pt0.A2" title="Appendix 0.B Supplemental Results ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">0.B</span></a>), we utilize round training times to analyze the latency overhead incurred by each FL method, as presented in Table <a href="#S5.T5" title="Table 5 ‣ 5.4 Latency Analysis ‣ 5 Evaluation ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
Each communication round includes the server broadcasting the global model to clients, clients training and uploading their local models, and the server aggregating these models to generate the new global model. With client sampling rates of <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><mi id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><ci id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">\gamma</annotation></semantics></math> at 0.5 and 1.0, the process involves 31 and 63 local models in each round, respectively. Our experiments are conducted on a server equipped with an AMD EPYC 7763 Processor with an 8-core CPU, an NVIDIA A100 GPU, and Ubuntu 22.04.3 LTS. We sample 10% of the training data from the CICIoT2023 dataset for performing this experiment.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">As observed in Table <a href="#S5.T5" title="Table 5 ‣ 5.4 Latency Analysis ‣ 5 Evaluation ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, the round training times of FedMADE show slight increases of 4.7% and 2.6% compared to FedAvg, for client sampling rates of 0.5 and 1, respectively. Given the gains in performance and robustness, these latency overheads are within an acceptable range. In contrast, the training times for FedProx and SCAFFOLD exhibit significantly large increases of 21.5% and 50.2%. Additionally, both methods involve modifications to the local training process and demand additional computational resources from IoT devices. Therefore, they are less suited for IoT networks, where devices are resource-constrained.</p>
</div>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Privacy Analysis</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.1" class="ltx_p">To compute local CPMs, FedMADE requires only a small validation dataset consisting of ten samples per class, which is negligible in comparison to the extensive training dataset that comprises millions of samples. Moreover, it is a standard practice to validate any ML model before deploying it in practical settings. Thus, our method barely affects the privacy of devices in IoT networks. This is in contrast to other FL methods that compromise privacy by directly sharing local data distributions (e.g., class sizes) with the server <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, distributing a proportion of the total data among other clients to mitigate local model weight divergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, or transmitting local feature statistics to the central server and other clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In our evaluations, we observe a slight decrease in accuracy for some classes, along with the improvement in minority attack classification. This is due to the limitations of local models in effectively differentiating between these minority attacks and some other traffic types, such as benign and reconnaissance traffic. To address this, we tested various feature selection methods including feature variance, information gain, recursive feature elimination, and tree-based approaches, as well as feature extraction techniques such as Principal Component Analysis (PCA) and Autoencoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. However, these popular methods do not substantially enhance the classification among benign, web-based, brute force, and reconnaissance attacks. Advanced feature engineering approaches are essential to improve classification performance of local models; however, they are beyond the scope of this paper.
Furthermore, FedMADE can be combined with various advanced ML models for IDSs in IoT networks.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">This paper adapts the FL framework to function as a distributed IDS in IoT networks for preserving privacy of IoT clients.
We introduced FedMADE, a dynamic aggregation method designed to handle traffic heterogeneity across IoT devices and enhance the detection capabilities for minority attacks.
FedMADE shows strong performance in both detecting and classifying attacks, as demonstrated by its results with the CICIoT2023 dataset.
Moreover, our findings indicate that FedMADE is a robust and secure aggregation method, showing resilience against poisoning attacks in adversarial settings.
FedMADE incurs a negligible latency overhead during training without imposing additional computational demands on local IoT devices.
In conclusion, FedMADE offers a practical IDS solution for IoT networks, characterized by its robustness, scalability, low latency, and superior classification performance.</p>
</div>
</section>
<section id="Pt0.A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.A </span>Model Architecture</h2>

<div id="Pt0.A1.p1" class="ltx_para">
<p id="Pt0.A1.p1.1" class="ltx_p">The detailed architectures of the base models are provided in Tables <a href="#Pt0.A1.T7" title="Table 7 ‣ Appendix 0.A Model Architecture ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> and  <a href="#Pt0.A1.T7" title="Table 7 ‣ Appendix 0.A Model Architecture ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<figure id="Pt0.A1.T7" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="Pt0.A1.T7.fig1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:216.8pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="Pt0.A1.T7.fig1.1.1.1" class="ltx_text" style="font-size:90%;">Table 6</span>: </span><span id="Pt0.A1.T7.fig1.2.2" class="ltx_text" style="font-size:90%;">CNN Model architecture.</span></figcaption>
<table id="Pt0.A1.T7.fig1.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Pt0.A1.T7.fig1.3.1.1" class="ltx_tr">
<th id="Pt0.A1.T7.fig1.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Type</th>
<th id="Pt0.A1.T7.fig1.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Kernel</th>
<th id="Pt0.A1.T7.fig1.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Shape</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Pt0.A1.T7.fig1.3.2.1" class="ltx_tr">
<td id="Pt0.A1.T7.fig1.3.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Convolution + Relu</td>
<td id="Pt0.A1.T7.fig1.3.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">(3,3)</td>
<td id="Pt0.A1.T7.fig1.3.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">(64,47)</td>
</tr>
<tr id="Pt0.A1.T7.fig1.3.3.2" class="ltx_tr">
<td id="Pt0.A1.T7.fig1.3.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Convolution + Relu</td>
<td id="Pt0.A1.T7.fig1.3.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">(3,3)</td>
<td id="Pt0.A1.T7.fig1.3.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">(128,47)</td>
</tr>
<tr id="Pt0.A1.T7.fig1.3.4.3" class="ltx_tr">
<td id="Pt0.A1.T7.fig1.3.4.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Flatten</td>
<td id="Pt0.A1.T7.fig1.3.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="Pt0.A1.T7.fig1.3.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">(6016)</td>
</tr>
<tr id="Pt0.A1.T7.fig1.3.5.4" class="ltx_tr">
<td id="Pt0.A1.T7.fig1.3.5.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Dense + Softmax</td>
<td id="Pt0.A1.T7.fig1.3.5.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">-</td>
<td id="Pt0.A1.T7.fig1.3.5.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">(7)</td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="Pt0.A1.T7.fig2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:216.8pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="Pt0.A1.T7.fig2.1.1.1" class="ltx_text" style="font-size:90%;">Table 7</span>: </span><span id="Pt0.A1.T7.fig2.2.2" class="ltx_text" style="font-size:90%;">FCNN Model architecture.</span></figcaption>
<table id="Pt0.A1.T7.fig2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Pt0.A1.T7.fig2.3.1.1" class="ltx_tr">
<th id="Pt0.A1.T7.fig2.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Type</th>
<th id="Pt0.A1.T7.fig2.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Shape</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Pt0.A1.T7.fig2.3.2.1" class="ltx_tr">
<td id="Pt0.A1.T7.fig2.3.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Dense + Relu</td>
<td id="Pt0.A1.T7.fig2.3.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">(50)</td>
</tr>
<tr id="Pt0.A1.T7.fig2.3.3.2" class="ltx_tr">
<td id="Pt0.A1.T7.fig2.3.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Dense + Relu</td>
<td id="Pt0.A1.T7.fig2.3.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">(25)</td>
</tr>
<tr id="Pt0.A1.T7.fig2.3.4.3" class="ltx_tr">
<td id="Pt0.A1.T7.fig2.3.4.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Dense + Softmax</td>
<td id="Pt0.A1.T7.fig2.3.4.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">(7)</td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
</figure>
</section>
<section id="Pt0.A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.B </span>Supplemental Results</h2>

<div id="Pt0.A2.p1" class="ltx_para">
<p id="Pt0.A2.p1.1" class="ltx_p"><span id="Pt0.A2.p1.1.1" class="ltx_text ltx_font_italic">Training Process and Convergence Analysis</span>: Figures <a href="#Pt0.A2.F5" title="Figure 5 ‣ Appendix 0.B Supplemental Results ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and <a href="#Pt0.A2.F6" title="Figure 6 ‣ Appendix 0.B Supplemental Results ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> present the per-class accuracy during the training process. Despite differences in round training times, FedAvg, FedProx, and FedMADE demonstrate convergence within five training rounds. In contrast, SCAFFOLD exhibits a slower convergence rate compared to the other methods.
In Figure <a href="#Pt0.A2.F6" title="Figure 6 ‣ Appendix 0.B Supplemental Results ‣ FedMADE: Robust Federated Learning for Intrusion Detection in IoT Networks Using a Dynamic Aggregation Method" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, the per-class accuracy for web-based attacks rapidly decreases to zero in certain training rounds. This occurs because web-based attacks target only three out of 63 devices in the network. When these specific devices do not participate in a training round, the aggregated global model tends to forget the information associated with these attacks. However, by utilizing a validation dataset to evaluate the global model’s performance in each communication round and preserving the best-performing model for deployment, the best model can ultimately achieve robust performance on minority attacks.</p>
</div>
<figure id="Pt0.A2.F5" class="ltx_figure">
<p id="Pt0.A2.F5.1" class="ltx_p ltx_align_center"><span id="Pt0.A2.F5.1.1" class="ltx_text"><img src="/html/2408.07152/assets/figs/avg_our3_cnn.png" id="Pt0.A2.F5.1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="234" alt="Refer to caption"></span></p>
<br class="ltx_break ltx_break">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="Pt0.A2.F5.5.2.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="Pt0.A2.F5.3.1" class="ltx_text" style="font-size:90%;">Curves of per-class accuracy across training rounds with <math id="Pt0.A2.F5.3.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="Pt0.A2.F5.3.1.m1.1b"><mi id="Pt0.A2.F5.3.1.m1.1.1" xref="Pt0.A2.F5.3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="Pt0.A2.F5.3.1.m1.1c"><ci id="Pt0.A2.F5.3.1.m1.1.1.cmml" xref="Pt0.A2.F5.3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A2.F5.3.1.m1.1d">\gamma</annotation></semantics></math> being 1.0.</span></figcaption>
</figure>
<figure id="Pt0.A2.F6" class="ltx_figure">
<p id="Pt0.A2.F6.1" class="ltx_p ltx_align_center"><span id="Pt0.A2.F6.1.1" class="ltx_text"><img src="/html/2408.07152/assets/figs/avg_our3_cnn_frac.png" id="Pt0.A2.F6.1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="234" alt="Refer to caption"></span></p>
<br class="ltx_break ltx_break">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="Pt0.A2.F6.5.2.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="Pt0.A2.F6.3.1" class="ltx_text" style="font-size:90%;">Curves of per-class accuracy across training rounds with <math id="Pt0.A2.F6.3.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="Pt0.A2.F6.3.1.m1.1b"><mi id="Pt0.A2.F6.3.1.m1.1.1" xref="Pt0.A2.F6.3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="Pt0.A2.F6.3.1.m1.1c"><ci id="Pt0.A2.F6.3.1.m1.1.1.cmml" xref="Pt0.A2.F6.3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A2.F6.3.1.m1.1d">\gamma</annotation></semantics></math> being 0.5.</span></figcaption>
</figure>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Dpkt library. <a target="_blank" href="https://dpkt.readthedocs.io/en/latest/" title="" class="ltx_ref">https://dpkt.readthedocs.io/en/latest/</a>, accessed: 2024-04-25

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Anthi, E., Williams, L., Słowińska, M., Theodorakopoulos, G., Burnap, P.: A supervised intrusion detection system for smart home iot devices. IEEE Internet of Things Journal <span id="bib.bib2.1.1" class="ltx_text ltx_font_bold">6</span>(5), 9042–9053 (2019)

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Ayesha S., D., A.B., S., D., M.: Fs3: Few-shot and self-supervised framework for efficient intrusion detection in Internet of Things networks. In: Proceedings of the 39th Annual Computer Security Applications Conference (ACSAC). p. 138–149. Association for Computing Machinery (2023)

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Belarbi, O., Spyridopoulos, T., Anthi, E., Mavromatis, I., Carnelli, P., Khan, A.: Federated deep learning for intrusion detection in IoT networks. In: IEEE Global Communications Conference (GLOBECOM). pp. 237–242 (2023)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Chawla, N.V., Bowyer, K.W., Hall, L.O., Kegelmeyer, W.P.: Smote: synthetic minority over-sampling technique. Journal of artificial intelligence research <span id="bib.bib5.1.1" class="ltx_text ltx_font_bold">16</span>, 321–357 (2002)

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Ester, M., Kriegel, H.P., Sander, J., Xu, X.: A density-based algorithm for discovering clusters in large spatial databases with noise. In: Proceedings of the Second International Conference on Knowledge Discovery and Data Mining (KDD). p. 226–231. AAAI Press (1996)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Fraboni, Y., Vidal, R., Kameni, L., Lorenzi, M.: Clustered sampling: Low-variance and improved representativity for clients selection in federated learning. In: International Conference on Machine Learning (ICML). pp. 3407–3416 (2021)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Huang, Y., Gupta, S., Song, Z., Li, K., Arora, S.: Evaluating gradient inversion attacks and defenses in federated learning. In: Advances in Neural Information Processing Systems (NIPS). vol. 34, pp. 7232–7241 (2021)

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Karimireddy, S.P., Kale, S., Mohri, M., Reddi, S., Stich, S., Suresh, A.T.: Scaffold: Stochastic controlled averaging for federated learning. In: International conference on machine learning (ICML). pp. 5132–5143 (2020)

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Khoa, T.V., Saputra, Y.M., Hoang, D.T., Trung, N.L., Nguyen, D., Ha, N.V., Dutkiewicz, E.: Collaborative learning model for cyberattack detection systems in iot industry 4.0. In: IEEE Wireless Communications and Networking Conference (WCNC). pp. 1–6 (2020)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Khraisat, A., Gondal, I., Vamplew, P., Kamruzzaman, J.: Survey of intrusion detection systems: techniques, datasets and challenges. Cybersecurity <span id="bib.bib11.1.1" class="ltx_text ltx_font_bold">2</span>(1), 1–22 (2019)

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Koroniotis, N., Moustafa, N., Sitnikova, E., Turnbull, B.: Towards the development of realistic botnet dataset in the Internet of Things for network forensic analytics: Bot-iot dataset. Future Generation Computer Systems <span id="bib.bib12.1.1" class="ltx_text ltx_font_bold">100</span>, 779–796 (2019)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Li, Q., He, B., Song, D.: Model-contrastive federated learning. In: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition (CVPR). pp. 10713–10722 (2021)

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Li, T., Sahu, A.K., Zaheer, M., Sanjabi, M., Talwalkar, A., Smith, V.: Federated optimization in heterogeneous networks. Proceedings of Machine learning and systems (MLSys) <span id="bib.bib14.1.1" class="ltx_text ltx_font_bold">2</span>, 429–450 (2020)

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Liu, Y., Garg, S., Nie, J., Zhang, Y., Xiong, Z., Kang, J., Hossain, M.S.: Deep anomaly detection for time-series data in industrial IoT: A communication-efficient on-device federated learning approach. IEEE Internet of Things Journal <span id="bib.bib15.1.1" class="ltx_text ltx_font_bold">8</span>(8) (2021)

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Luo, J., Wu, S.: Fedsld: Federated learning with shared label distribution for medical image classification. In: 2022 IEEE 19th International Symposium on Biomedical Imaging (ISBI). pp. 1–5 (2022)

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Maldonado, J., Riff, M.C., Neveu, B.: A review of recent approaches on wrapper feature selection for intrusion detection. Expert Systems with Applications <span id="bib.bib17.1.1" class="ltx_text ltx_font_bold">198</span>, 116822 (2022)

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Masdari, M., Khezri, H.: A survey and taxonomy of the fuzzy signature-based intrusion detection systems. Applied Soft Computing <span id="bib.bib18.1.1" class="ltx_text ltx_font_bold">92</span>, 106301 (2020)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., y Arcas, B.A.: Communication-efficient learning of deep networks from decentralized data. In: Artificial intelligence and statistics (AISTATS). pp. 1273–1282. PMLR (2017)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Meidan, Y., Bohadana, M., Mathov, Y., Mirsky, Y., Shabtai, A., Breitenbacher, D., Elovici, Y.: N-BaIoT—Network-based detection of IoT botnet attacks using deep autoencoders). IEEE Pervasive Computing <span id="bib.bib20.1.1" class="ltx_text ltx_font_bold">17</span>(3), 12–22 (2018)

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Mothukuri, V., Khare, P., Parizi, R.M., Pouriyeh, S., Dehghantanha, A., Srivastava, G.: Federated-learning-based anomaly detection for IoT security attacks. IEEE Internet of Things Journal <span id="bib.bib21.1.1" class="ltx_text ltx_font_bold">9</span>(4), 2545–2554 (2022)

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Moustafa, N.: A new distributed architecture for evaluating ai-based security systems at the edge: Network TON_IoT datasets. Sustainable Cities and Society <span id="bib.bib22.1.1" class="ltx_text ltx_font_bold">72</span>, 102994 (2021)

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Moustafa, N., Slay, J.: UNSW-NB15: a comprehensive data set for network intrusion detection systems. In: 2015 Military Communications and Information Systems Conference (MilCIS). pp. 1–6 (2015)

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Neto, E.C.P., Dadkhah, S., Ferreira, R., Zohourian, A., Lu, R., Ghorbani, A.A.: CICIoT2023: A real-time dataset and benchmark for large-scale attacks in IoT environment. Sensors <span id="bib.bib24.1.1" class="ltx_text ltx_font_bold">23</span>(13) (2023)

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Nguyen, T.D., Marchal, S., Miettinen, M., Fereidooni, H., Asokan, N., Sadeghi, A.R.: Dïot: A federated self-learning anomaly detection system for IoT. In: 2019 IEEE 39th International conference on distributed computing systems (ICDCS). pp. 756–767. IEEE (2019)

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Nguyen, T.D., Rieger, P., Miettinen, M., Sadeghi, A.R.: Poisoning attacks on federated learning-based iot intrusion detection system. In: Proc. Workshop Decentralized IoT Syst. Secur.(DISS). vol. 79 (2020)

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Nguyen, T.A., He, J., Le, L.T., Bao, W., Tran, N.H.: Federated PCA on grassmann manifold for anomaly detection in IoT networks. In: IEEE Conference on Computer Communications (INFOCOM). pp. 1–10 (2023)

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Nižetić, S., Šolić, P., Gonzalez-De, D.L.d.I., Patrono, L., et al.: Internet of Things (IoT): Opportunities, issues and challenges towards a smart and sustainable future. Journal of cleaner production <span id="bib.bib28.1.1" class="ltx_text ltx_font_bold">274</span>, 122877 (2020)

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Pajouh, H., Javidan, R., Khayami, R., Dehghantanha, A., Choo, K.: A two-layer dimension reduction and two-tier classification model for anomaly-based intrusion detection in IoT backbone networks. IEEE Transactions on Emerging Topics in Computing <span id="bib.bib29.1.1" class="ltx_text ltx_font_bold">7</span>(02), 314–323 (2019)

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Popoola, S.I., Ande, R., Adebisi, B., Gui, G., Hammoudeh, M., Jogunola, O.: Federated deep learning for zero-day botnet attack detection in IoT-edge devices. IEEE Internet of Things Journal <span id="bib.bib30.1.1" class="ltx_text ltx_font_bold">9</span>(5), 3930–3944 (2022)

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Rey, V., Sánchez Sánchez, P.M., Huertas Celdrán, A., Bovet, G.: Federated learning for malware detection in IoT devices. Computer Networks <span id="bib.bib31.1.1" class="ltx_text ltx_font_bold">204</span>, 108693 (2022)

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Shi, S., Haque, M.S., Parida, A., Linguraru, M.G., Hou, Y.T., Anwar, S.M., Lou, W.: Harvesting private medical images in federated learning systems with crafted models. arXiv (2024)

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Shi, S., Wang, N., Xiao, Y., Zhang, C., Shi, Y., Hou, Y.T., Lou, W.: Scale-mia: A scalable model inversion attack against secure federated learning via latent space reconstruction. arXiv (2023)

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Sun, S., Sugrim, S., Stavrou, A., Wang, H.: Partner in crime: Boosting targeted poisoning attacks against federated learning. arXiv (2024)

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Tavallaee, M., Bagheri, E., Lu, W., Ghorbani, A.A.: A detailed analysis of the KDD CUP 99 data set. In: 2009 IEEE Symposium on Computational Intelligence for Security and Defense Applications. pp. 1–6 (2009)

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Wang, L., Xu, S., Wang, X., Zhu, Q.: Addressing class imbalance in federated learning. In: Proceedings of the AAAI Conference on Artificial Intelligence. pp. 10165–10173 (2021)

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Wang, N., Chen, Y., Hu, Y., Lou, W., Hou, Y.T.: FeCo: Boosting intrusion detection capability in IoT networks via contrastive learning. In: IEEE Conference on Computer Communications (INFOCOM). pp. 1409–1418 (2022)

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Wu, H., Wang, P.: Node selection toward faster convergence for federated learning on non-iid data. IEEE Transactions on Network Science and Engineering <span id="bib.bib38.1.1" class="ltx_text ltx_font_bold">9</span>(5), 3099–3111 (2022)

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Xu, J., Tong, X., Huang, S.L.: Personalized federated learning with feature alignment and classifier collaboration. In: The Eleventh International Conference on Learning Representations (ICLR) (2023)

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Yoon, T., Shin, S., Hwang, S.J., Yang, E.: Fedmix: Approximation of mixup under mean augmented federated learning. arXiv (2021)

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Zhang, C., Wang, N., Shi, S., Du, C., Lou, W., Hou, Y.T.: Mindfl: Mitigating the impact of imbalanced and noisy-labeled data in federated learning with quality and fairness-aware client selection. In: IEEE Military Communications Conference (MILCOM). pp. 331–338 (2023)

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Zhao, Y., Li, M., Lai, L., Suda, N., Civin, D., Chandra, V.: Federated learning with non-iid data. arXiv (2018)

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Zolanvari, M., Teixeira, M.A., Gupta, L., Khan, K.M., Jain, R.: Machine learning-based network vulnerability analysis of industrial Internet of Things. IEEE Internet of Things Journal <span id="bib.bib43.1.1" class="ltx_text ltx_font_bold">6</span>(4), 6822–6834 (2019)

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2408.07151" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2408.07152" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2408.07152">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2408.07152" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2408.07153" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Sep  5 12:27:12 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
