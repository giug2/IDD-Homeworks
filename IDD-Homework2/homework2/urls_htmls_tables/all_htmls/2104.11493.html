<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2104.11493] Stroke-Based Scene Text Erasing Using Synthetic Data for Training</title><meta property="og:description" content="Scene text erasing, which replaces text regions with reasonable content in natural images, has drawn significant attention in the computer vision community in recent years. There are two potential subtasks in scene tex…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Stroke-Based Scene Text Erasing Using Synthetic Data for Training">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Stroke-Based Scene Text Erasing Using Synthetic Data for Training">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2104.11493">

<!--Generated on Sun Mar 17 04:00:38 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Scene text erasing,  Synthetic text,  Background inpainting
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Stroke-Based Scene Text Erasing 
<br class="ltx_break">Using Synthetic Data for Training</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhengmi Tang,
Tomo Miyazaki, 
Yoshihiro Sugaya, 
and Shinichiro Omachi, 


</span><span class="ltx_author_notes">Manuscript received March 10, 2021. This work was partially supported by JSPS KAKENHI Grant Numbers 18K19772, 19K12033, 20H04201.The authors are with the Graduate School of Engineering, Tohoku University, Sendai, 980-8579, Japan. (e-mail: tzm@dc.tohoku.ac.jp, tomo@tohoku.ac.jp, sugaya@iic.ecei.tohoku.ac.jp, machi@ecei.tohoku.ac.jp).</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id5.id1" class="ltx_p">Scene text erasing, which replaces text regions with reasonable content in natural images, has drawn significant attention in the computer vision community in recent years. There are two potential subtasks in scene text erasing: text detection and image inpainting. Both subtasks require considerable data to achieve better performance; however, the lack of a large-scale real-world scene-text removal dataset does not allow existing methods to realize their potential. To compensate for the lack of pairwise real-world data, we made considerable use of synthetic text after additional enhancement and subsequently trained our model only on the dataset generated by the improved synthetic text engine. Our proposed network contains a stroke mask prediction module and background inpainting module that can extract the text stroke as a relatively small hole from the cropped text image to maintain more background content for better inpainting results. This model can partially erase text instances in a scene image with a bounding box or work with an existing scene-text detector for automatic scene text erasing. The experimental results from the qualitative and quantitative evaluation on the SCUT-Syn, ICDAR2013, and SCUT-EnsText datasets demonstrate that our method significantly outperforms existing state-of-the-art methods even when they are trained on real-world data.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Scene text erasing, Synthetic text, Background inpainting

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Texts created by humankind comprise rich, precise high-level semantics. Text, in daily life, provides a considerable amount of valuable information. However, with the increasing number of portable devices, such as digital cameras, tablets, smartphones, and SNS, a huge volume of scene images, including text, are shared on the Internet every second. These texts can contain private information, such as names, addresses, and vehicle number plates. With the increasing development of scene text detection and recognition technology, there is a high risk that the information collected automatically is used for illegal purposes. Therefore, scene text erasing, which is replacing text regions in scene images with proper content, has drawn considerable attention in the computer vision community in recent years.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">After the prior work of Scene Text Eraser <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, scene text erasing research has developed in two directions: one-step and two-step methods. One-step methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> do not require the input of any text location information because they combine text detection and inpainting functions into one network, making them lightweight and fast. The drawback is that the text localization mechanism of these networks is weak, and the text-erasing process is not controllable. To allow the network to learn the complicated distribution of scene texts, a considerable number of manually text-erased real-world images are required as training data because the text distribution of the Synth-text <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> dataset, which is generated according to human rules, is significantly different from real-world cases. To generate scene-text-erased images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, photo editing software such as Photoshop is used to fill the text region of natural images with visually plausible content. However, this type of annotation is expensive and time-consuming because the annotators need to operate carefully to guarantee the quality of the erasing, especially when the text to be erased is on a complicated background.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S1.F1.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:143.1pt;">
<img src="/html/2104.11493/assets/x1.jpg" id="S1.F1.1.g1" class="ltx_graphics ltx_img_square" width="664" height="565" alt="Refer to caption"><img src="/html/2104.11493/assets/fig1/img_545_0.jpg" id="S1.F1.2.g2" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S1.F1.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:143.1pt;">
<img src="/html/2104.11493/assets/x2.jpg" id="S1.F1.3.g1" class="ltx_graphics ltx_img_square" width="664" height="565" alt="Refer to caption"><img src="/html/2104.11493/assets/fig1/img_545_2.jpg" id="S1.F1.4.g2" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S1.F1.6.2" class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:143.1pt;"><span id="S1.F1.5.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/x3.jpg" id="S1.F1.5.1.1.g1" class="ltx_graphics ltx_img_square" width="664" height="565" alt="Refer to caption"></span>
<span id="S1.F1.6.2.2" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig1/img_545_3.jpg" id="S1.F1.6.2.2.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span></p>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Scene Text Erasing: original images and text bounding boxes (left); text-erased images by our method (middle); predicted text stroke mask (right).</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The two-step approaches decompose the text-erasing task into two sub-problems: text detection and background inpainting. MTRNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> inpaints the text region by manually providing a mask of the text regions. Zdenek <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> used a pretrained scene text detection model and a pretrained inpainting model to erase the text. This weak supervision method does not require paired training data. However, the inpainting model is trained on the Street View <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> or ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> datasets, and thus, the pretrained models face domain shift problems, which cannot make a “perfect fit” in the context of scene text.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this study, we propose a word-level two-stage scene-text-erasing network that works on cropped text images. First, it predicts the region of text stroke as a hole, then inpaints the hole according to the background. To compensate for the lack of pairwise real-world data, we made full use of synthetic texts. The appearance of the synthetic texts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> was enhanced, and we trained our model only on the dataset generated by the improved synthetic text engine in an end-to-end fashion. The model can partially erase text instances in a scene image if text bounding boxes are provided. The model can also work with existing scene-text detectors for automatic scene text erasing. Examples of text-erasing results obtained using the proposed method are shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The main contributions of our study can be summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.ix1.p1" class="ltx_para">
<p id="S1.I1.ix1.p1.1" class="ltx_p">We propose a practical text erasing method and a stroke-based text-erasing network using cropped text images instead of the entire image, which makes prediction of the pixel-level mask of text strokes more accurate and stable. Benefiting from our erasing pipeline and network structure, our method can erase text instances while retaining and restoring more background details.</p>
</div>
</li>
<li id="S1.I1.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.ix2.p1" class="ltx_para">
<p id="S1.I1.ix2.p1.1" class="ltx_p">We enhance the Text Synthesis Engine <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> to make the appearance of synthetic text instances share more similarity with real-world data.</p>
</div>
</li>
<li id="S1.I1.ix3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.ix3.p1" class="ltx_para">
<p id="S1.I1.ix3.p1.1" class="ltx_p">The quantitative and qualitative evaluation results on SCUT-Syn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, ICDAR 2013 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and SCUT-EnsText <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> datasets demonstrate that our method outperforms previous state-of-the-art methods while it is only trained on the dataset generated by the improved synthetic text engine <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The remainder of this paper is organized as follows. Section <a href="#S2" title="II Related work ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> reviews related works on scene-text detection, image inpainting, and text erasing. Section <a href="#S3" title="III Methodology ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> introduces the details of our method, including the pipeline and the proposed networks. In Section <a href="#S4" title="IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>, we evaluate and compare our proposed method with related inpainting and scene-text erasing studies based on the results of experiments. Finally, we provide concluding statements in Section <a href="#S5" title="V Conclusion ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>.</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2104.11493/assets/fig2.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="159" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Pipeline of our proposed method. Our text-erasing network uses cropped text images as inputs and outputs the corresponding text-erased images. Then, by placing these text-erased images back into the original locations of the input image, we can obtain the final text-erased image.</figcaption>
</figure>
<figure id="S1.F3" class="ltx_figure"><img src="/html/2104.11493/assets/fig3.png" id="S1.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="574" height="256" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Structure of our proposed network. It is composed of a stroke mask prediction module (SMPM) (top) and a background inpainting module (BIPM) (bottom). The SMPM first predicts the stroke mask of the text, and the BIPM inpaints the stroke pixels with the appropriate content to erase the text.</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related work</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">Scene Text Detection</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">The emergence of deep learning has facilitated the development of scene text detection research and shows promising performance compared to traditional manually designed algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. Recent learning-based scene text detection methods can be roughly categorized into regression-based and segmentation-based methods.
Regression-based methods aim to directly predict the bounding boxes of text instances. TextBoxes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> adjusts the aspect ratios of anchors in SSD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> to detect text with different shapes. CTPN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> combines the framework of Faster R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> with a recurrence mechanism to predict the contextual and dense components of text. RRPN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> proposes a rotation region proposal to bind multi-oriented scene text with rotated rectangles. EAST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> directly regresses rotated rectangles or quadrangles of text through a simplified pipeline without using any anchors.
LOMO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> detects long text and arbitrarily shaped text in scene images by refining the preliminary proposals iteratively and considering text geometry properties including text region, text center line, and border offsets.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Segmentation-based methods usually first extract text pixels from the segmentation map and then obtain bounding boxes of the text by post-processing. Zhang <span id="S2.SS1.p2.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> used the FCN and MSER for pixel-level multi-oriented text detection. Mask textspotter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> built a model based on the framework of Mask R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> and performed character-level instance segmentation for each alphabet. TextSnake <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> proposed a novel representation of arbitrarily shaped text and predicted heat maps of text center lines, text regions, radii, and orientations to extract text regions. PSENet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> gradually expanded the text region from small to large kernels to make final predictions through multiple semantic segmentation maps. Liao <span id="S2.SS1.p2.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> proposed a module called differentiable binarization (DB) to perform the binarization process in a segmentation network. CRAFT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> proposed learning each character center and the affinity between characters in the form of a heat map.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Image Inpainting</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Image inpainting fills the hole regions of an image with plausible content. Image inpainting research can generally be divided into two categories: non-learning and deep-learning-based approaches. Non-learning approaches transfer the surrounding content to the hole region based on low-level features using a traditional algorithm such as patch matching <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and diffusion <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. Although these methods can work well on small holes, they cannot deal with large missing regions, which require semantics patches for the hole restoration based on a high-level understanding of the whole image.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">The generative adversarial network (GAN) strategy has been widely adopted in recent deep-learning-based approaches and can be categorized as single-stage inpainting and progressive inpainting. Context encoders <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> first trained an image-inpainting deep neural network using an encoder–decoder structure and adversarial losses. Iizuka <span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> adopted dilated convolution and proposed global and local discriminators for adversarial training. Liu <span id="S2.SS2.p2.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> defined a partial convolutional layer with a mask-update mechanism to ensure that the partial convolution filters learn more valid information from the non-hole region and can robustly handle holes of any shape. Xie <span id="S2.SS2.p2.1.3" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> proposed a learnable bidirectional attention module that included forward and reverse attention maps for more effective hole filling. Li <span id="S2.SS2.p2.1.4" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> exploited the correlation between adjacent pixels by recurrently inferring and gathering the hole boundary for the encoder, referred to as the recurrent feature reasoning module.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">To generate a more realistic texture, a coarse-to-fine strategy was adopted in the progressive inpainting methods. Yu <span id="S2.SS2.p3.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> exploited textural similarities to borrow feature information from known background patches to generate missing patches and designed a two-stage network architecture from coarse to fine. Yu <span id="S2.SS2.p3.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> introduced gated convolution, which further generalizes partial convolution to make the mask-update mechanism learnable. The method was then combined with the SN-PatchGAN discriminator to obtain better performance. Yi <span id="S2.SS2.p3.1.3" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> improved gated convolution through a lightweight design and proposed high-frequency residuals to generate rich and detailed textures for efficient ultra-high-resolution image inpainting.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">Text Erasing</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Early text erasing research starts with the removal of born-digital text such as watermarks, captions, and subtitles on images or video sequences <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>. Owing to the plain layout, color, and regular font, born-digital text can be detected by traditional feature engineering approaches such as binarization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, and inpainted by patch matching <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> or smoothing algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">Erasing text in the wild is a more complex and challenging task because of the various fonts with different layouts and illumination conditions. The recent rapid development of deep neural networks has made scene text erasure a promising research task in the computer vision field. Scene text erasing research can be classified into two categories: one-step and two-step methods. One-step methods use an end-to-end model to directly output a text-erased image without the aid of text location information. Pix2Pix <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> is a conditional generative adversarial network (cGAN) designed for general-purpose image-to-image translation tasks that can be applied to text removal. Nakamura <span id="S2.SS3.p2.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> made the first attempt to build a one-stage scene text eraser, a sliding window method using a skip-connected auto-encoder. This method destroys the integrity of text strokes but cannot maintain the global consistency of the entire image. EnsNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> adopted cGAN with a refined loss function and a local-aware discriminator to erase texts at the entire image level. Liu <span id="S2.SS3.p2.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> provided a comprehensive real-world scene-text removal benchmark, named SCUT-EnsText, and proposed EraseNet, which adopts a coarse-to-fine erasure network structure with a segmentation module to generate a mask of the text region to help with text region localization. MTRNet++ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> shared the same coarse-to-fine inpainting idea but used a multi-branch generator. The mask-refine branch predicts stroke-level text masks to guide text removal.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.1" class="ltx_p">Two-step methods remove the text with an awareness of text location, which can be provided by users or by a pretrained text detector. Qin <span id="S2.SS3.p3.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> proposed a cGAN with one encoder and two decoder architectures to perform content region segmentation and inpainting jointly, which can be applied for text removal in cropped text images. MTRNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> used manually provided text masks to guide the training and prediction processes of cGAN, thereby realizing the controllability of the text-erasing region. Zdenek <span id="S2.SS3.p3.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> proposed a weak supervision method employing a pretrained scene text detector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> and a pretrained image inpainting model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> to free the scene text erasing task from the requirement of paired-wise training data of scene images with text and the corresponding text-erased images. Bian <span id="S2.SS3.p3.1.3" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> proposed a cascaded GAN-based model to decouple text stroke detection and stroke removal in text removal tasks.</p>
</div>
<div id="S2.SS3.p4" class="ltx_para">
<p id="S2.SS3.p4.1" class="ltx_p">We consider our proposed method to be a practical solution to scene text erasing tasks because the pretrained scene text detector and synthetic data obviate the need for paired real-world data. The relatively weak text detection ability of one-step end-to-end methods can lead to excessive erasure of text-free areas and incomplete erasure of the text region. The detection ability of these networks can only be improved during end-to-end training, which would require expensive real-world training data. The advantage of our method over weak supervision methods is that using improved synthetic data for training can greatly reduce the domain shift problem during the inpainting process.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Methodology</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The pipeline of the proposed method is shown in Fig. <a href="#S1.F2" title="Figure 2 ‣ I Introduction ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Given the source image containing the scene text and the corresponding text bounding boxes, text images are cropped from the source image. Subsequently, each cropped text image goes through the text-erasing network. The cropped text-erased images are then inserted into the source image to obtain an output image that does not contain text.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.4" class="ltx_p">Our network comprises 1) a stroke mask prediction module and 2) a background inpainting module, as illustrated in Fig. <a href="#S1.F3" title="Figure 3 ‣ I Introduction ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Specifically, the stroke mask prediction module first predicts the stroke mask of the scene text <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\hat{I}_{mask}" display="inline"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mover accent="true" id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml"><mi id="S3.p2.1.m1.1.1.2.2" xref="S3.p2.1.m1.1.1.2.2.cmml">I</mi><mo id="S3.p2.1.m1.1.1.2.1" xref="S3.p2.1.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml"><mi id="S3.p2.1.m1.1.1.3.2" xref="S3.p2.1.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.1.1.3.1" xref="S3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.p2.1.m1.1.1.3.3" xref="S3.p2.1.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.1.1.3.1a" xref="S3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.p2.1.m1.1.1.3.4" xref="S3.p2.1.m1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.1.1.3.1b" xref="S3.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.p2.1.m1.1.1.3.5" xref="S3.p2.1.m1.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><apply id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2"><ci id="S3.p2.1.m1.1.1.2.1.cmml" xref="S3.p2.1.m1.1.1.2.1">^</ci><ci id="S3.p2.1.m1.1.1.2.2.cmml" xref="S3.p2.1.m1.1.1.2.2">𝐼</ci></apply><apply id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3"><times id="S3.p2.1.m1.1.1.3.1.cmml" xref="S3.p2.1.m1.1.1.3.1"></times><ci id="S3.p2.1.m1.1.1.3.2.cmml" xref="S3.p2.1.m1.1.1.3.2">𝑚</ci><ci id="S3.p2.1.m1.1.1.3.3.cmml" xref="S3.p2.1.m1.1.1.3.3">𝑎</ci><ci id="S3.p2.1.m1.1.1.3.4.cmml" xref="S3.p2.1.m1.1.1.3.4">𝑠</ci><ci id="S3.p2.1.m1.1.1.3.5.cmml" xref="S3.p2.1.m1.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\hat{I}_{mask}</annotation></semantics></math> as the hole from <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="I_{in}" display="inline"><semantics id="S3.p2.2.m2.1a"><msub id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">I</mi><mrow id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml"><mi id="S3.p2.2.m2.1.1.3.2" xref="S3.p2.2.m2.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p2.2.m2.1.1.3.1" xref="S3.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.p2.2.m2.1.1.3.3" xref="S3.p2.2.m2.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝐼</ci><apply id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3"><times id="S3.p2.2.m2.1.1.3.1.cmml" xref="S3.p2.2.m2.1.1.3.1"></times><ci id="S3.p2.2.m2.1.1.3.2.cmml" xref="S3.p2.2.m2.1.1.3.2">𝑖</ci><ci id="S3.p2.2.m2.1.1.3.3.cmml" xref="S3.p2.2.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">I_{in}</annotation></semantics></math>. Then, the background inpainting module is used to fill the hole of the input image <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="I_{in}" display="inline"><semantics id="S3.p2.3.m3.1a"><msub id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">I</mi><mrow id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml"><mi id="S3.p2.3.m3.1.1.3.2" xref="S3.p2.3.m3.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p2.3.m3.1.1.3.1" xref="S3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.p2.3.m3.1.1.3.3" xref="S3.p2.3.m3.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝐼</ci><apply id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3"><times id="S3.p2.3.m3.1.1.3.1.cmml" xref="S3.p2.3.m3.1.1.3.1"></times><ci id="S3.p2.3.m3.1.1.3.2.cmml" xref="S3.p2.3.m3.1.1.3.2">𝑖</ci><ci id="S3.p2.3.m3.1.1.3.3.cmml" xref="S3.p2.3.m3.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">I_{in}</annotation></semantics></math> with the appropriate content and output text-erased image <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="\hat{I}_{out}" display="inline"><semantics id="S3.p2.4.m4.1a"><msub id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mover accent="true" id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml"><mi id="S3.p2.4.m4.1.1.2.2" xref="S3.p2.4.m4.1.1.2.2.cmml">I</mi><mo id="S3.p2.4.m4.1.1.2.1" xref="S3.p2.4.m4.1.1.2.1.cmml">^</mo></mover><mrow id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml"><mi id="S3.p2.4.m4.1.1.3.2" xref="S3.p2.4.m4.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p2.4.m4.1.1.3.1" xref="S3.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.p2.4.m4.1.1.3.3" xref="S3.p2.4.m4.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.p2.4.m4.1.1.3.1a" xref="S3.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.p2.4.m4.1.1.3.4" xref="S3.p2.4.m4.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1">subscript</csymbol><apply id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2"><ci id="S3.p2.4.m4.1.1.2.1.cmml" xref="S3.p2.4.m4.1.1.2.1">^</ci><ci id="S3.p2.4.m4.1.1.2.2.cmml" xref="S3.p2.4.m4.1.1.2.2">𝐼</ci></apply><apply id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3"><times id="S3.p2.4.m4.1.1.3.1.cmml" xref="S3.p2.4.m4.1.1.3.1"></times><ci id="S3.p2.4.m4.1.1.3.2.cmml" xref="S3.p2.4.m4.1.1.3.2">𝑜</ci><ci id="S3.p2.4.m4.1.1.3.3.cmml" xref="S3.p2.4.m4.1.1.3.3">𝑢</ci><ci id="S3.p2.4.m4.1.1.3.4.cmml" xref="S3.p2.4.m4.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">\hat{I}_{out}</annotation></semantics></math>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Stroke Mask Prediction Module</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.6" class="ltx_p">An encoder–decoder FCN is adopted in this module. The input image <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="I_{in}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">I</mi><mrow id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.1.m1.1.1.3.1" xref="S3.SS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝐼</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><times id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.1"></times><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">I_{in}</annotation></semantics></math> is encoded by three down-sampling convolutional layers and four residual blocks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>, and the feature maps <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="F_{m}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">F</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝐹</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">F_{m}</annotation></semantics></math> are decoded by three up-sampling transposed convolutional layers to generate the text stroke mask <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\hat{I}_{mask}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mover accent="true" id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.2.2.cmml">I</mi><mo id="S3.SS1.p1.3.m3.1.1.2.1" xref="S3.SS1.p1.3.m3.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.1.1.3.1" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.1.1.3.1a" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.3.m3.1.1.3.4" xref="S3.SS1.p1.3.m3.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.1.1.3.1b" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.3.m3.1.1.3.5" xref="S3.SS1.p1.3.m3.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><apply id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2"><ci id="S3.SS1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.2.1">^</ci><ci id="S3.SS1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2.2">𝐼</ci></apply><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><times id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1"></times><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">𝑚</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">𝑎</ci><ci id="S3.SS1.p1.3.m3.1.1.3.4.cmml" xref="S3.SS1.p1.3.m3.1.1.3.4">𝑠</ci><ci id="S3.SS1.p1.3.m3.1.1.3.5.cmml" xref="S3.SS1.p1.3.m3.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\hat{I}_{mask}</annotation></semantics></math>. The architecture of the SMPM is presented in Table <a href="#S3.T1" title="TABLE I ‣ III-A Stroke Mask Prediction Module ‣ III Methodology ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>. The skip connections concatenate feature maps of the same shape between the encoder and decoder. The feature maps <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="F_{m}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">F</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝐹</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">F_{m}</annotation></semantics></math> output from the residual blocks are concatenated with the feature maps <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="F_{b}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">F</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝐹</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">F_{b}</annotation></semantics></math> in the background inpainting module, which is introduced in Section B. There is usually an imbalance between the pixels of the text region and the pixels of the non-text region in <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="I_{in}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">I</mi><mrow id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.3.1" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝐼</ci><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><times id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1"></times><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">𝑖</ci><ci id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">I_{in}</annotation></semantics></math>, and both high recall and precision are expected during mask prediction. Therefore, the dice loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> and L1 loss are employed to guide the generation of the text mask. In image segmentation, the dice loss is a region-based loss measure that expresses the proportion of correctly predicted pixels to the sum of the total pixels of both the prediction and ground truth. Mathematically, the dice loss is defined as</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.5" class="ltx_Math" alttext="\mathcal{L}_{dice}=1-\frac{2\sum_{i}^{N}(\hat{I}_{mask})_{i}(I_{mask})_{i}}{\sum_{i}^{N}(\hat{I}_{mask})_{i}+\sum_{i}^{N}(I_{mask})_{i}}," display="block"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml"><msub id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.1.1.2.2" xref="S3.E1.m1.5.5.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E1.m1.5.5.1.1.2.3" xref="S3.E1.m1.5.5.1.1.2.3.cmml"><mi id="S3.E1.m1.5.5.1.1.2.3.2" xref="S3.E1.m1.5.5.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.2.3.1" xref="S3.E1.m1.5.5.1.1.2.3.1.cmml">​</mo><mi id="S3.E1.m1.5.5.1.1.2.3.3" xref="S3.E1.m1.5.5.1.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.2.3.1a" xref="S3.E1.m1.5.5.1.1.2.3.1.cmml">​</mo><mi id="S3.E1.m1.5.5.1.1.2.3.4" xref="S3.E1.m1.5.5.1.1.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.2.3.1b" xref="S3.E1.m1.5.5.1.1.2.3.1.cmml">​</mo><mi id="S3.E1.m1.5.5.1.1.2.3.5" xref="S3.E1.m1.5.5.1.1.2.3.5.cmml">e</mi></mrow></msub><mo id="S3.E1.m1.5.5.1.1.1" xref="S3.E1.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.3" xref="S3.E1.m1.5.5.1.1.3.cmml"><mn id="S3.E1.m1.5.5.1.1.3.2" xref="S3.E1.m1.5.5.1.1.3.2.cmml">1</mn><mo id="S3.E1.m1.5.5.1.1.3.1" xref="S3.E1.m1.5.5.1.1.3.1.cmml">−</mo><mfrac id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mn id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.4.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml"><msubsup id="S3.E1.m1.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.3.cmml"><mo rspace="0em" id="S3.E1.m1.2.2.2.2.3.2.2" xref="S3.E1.m1.2.2.2.2.3.2.2.cmml">∑</mo><mi id="S3.E1.m1.2.2.2.2.3.2.3" xref="S3.E1.m1.2.2.2.2.3.2.3.cmml">i</mi><mi id="S3.E1.m1.2.2.2.2.3.3" xref="S3.E1.m1.2.2.2.2.3.3.cmml">N</mi></msubsup><mrow id="S3.E1.m1.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">I</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.4" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1b" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.5" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.5.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.3.cmml">​</mo><msub id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml"><mrow id="S3.E1.m1.2.2.2.2.2.2.1.1" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.2.2.2.1.1.2" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E1.m1.2.2.2.2.2.2.1.1.1" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.1.1.1.2" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.2.cmml">I</mi><mrow id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.2" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.1" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.3" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.1a" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.4" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.1b" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.5" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.5.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.2.2.2.2.2.2.1.1.3" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.E1.m1.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.2.3.cmml">i</mi></msub></mrow></mrow></mrow><mrow id="S3.E1.m1.4.4.4" xref="S3.E1.m1.4.4.4.cmml"><mrow id="S3.E1.m1.3.3.3.1" xref="S3.E1.m1.3.3.3.1.cmml"><msubsup id="S3.E1.m1.3.3.3.1.2" xref="S3.E1.m1.3.3.3.1.2.cmml"><mo id="S3.E1.m1.3.3.3.1.2.2.2" xref="S3.E1.m1.3.3.3.1.2.2.2.cmml">∑</mo><mi id="S3.E1.m1.3.3.3.1.2.2.3" xref="S3.E1.m1.3.3.3.1.2.2.3.cmml">i</mi><mi id="S3.E1.m1.3.3.3.1.2.3" xref="S3.E1.m1.3.3.3.1.2.3.cmml">N</mi></msubsup><msub id="S3.E1.m1.3.3.3.1.1" xref="S3.E1.m1.3.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.3.1.1.1.1" xref="S3.E1.m1.3.3.3.1.1.1.1.1.cmml"><mo lspace="0em" stretchy="false" id="S3.E1.m1.3.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.3.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.3.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.3.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1.m1.3.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.3.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.3.3.3.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.3.1.1.1.1.1.2.2.cmml">I</mi><mo id="S3.E1.m1.3.3.3.1.1.1.1.1.2.1" xref="S3.E1.m1.3.3.3.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.E1.m1.3.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.3.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.3.1.1.1.1.1.3.1" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.3.3.3.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.3.1.1.1.1.1.3.1a" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.3.3.3.1.1.1.1.1.3.4" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.3.1.1.1.1.1.3.1b" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.3.3.3.1.1.1.1.1.3.5" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.5.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.3.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.3.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E1.m1.3.3.3.1.1.3" xref="S3.E1.m1.3.3.3.1.1.3.cmml">i</mi></msub></mrow><mo rspace="0.055em" id="S3.E1.m1.4.4.4.3" xref="S3.E1.m1.4.4.4.3.cmml">+</mo><mrow id="S3.E1.m1.4.4.4.2" xref="S3.E1.m1.4.4.4.2.cmml"><msubsup id="S3.E1.m1.4.4.4.2.2" xref="S3.E1.m1.4.4.4.2.2.cmml"><mo rspace="0em" id="S3.E1.m1.4.4.4.2.2.2.2" xref="S3.E1.m1.4.4.4.2.2.2.2.cmml">∑</mo><mi id="S3.E1.m1.4.4.4.2.2.2.3" xref="S3.E1.m1.4.4.4.2.2.2.3.cmml">i</mi><mi id="S3.E1.m1.4.4.4.2.2.3" xref="S3.E1.m1.4.4.4.2.2.3.cmml">N</mi></msubsup><msub id="S3.E1.m1.4.4.4.2.1" xref="S3.E1.m1.4.4.4.2.1.cmml"><mrow id="S3.E1.m1.4.4.4.2.1.1.1" xref="S3.E1.m1.4.4.4.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.4.2.1.1.1.2" xref="S3.E1.m1.4.4.4.2.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.4.4.4.2.1.1.1.1" xref="S3.E1.m1.4.4.4.2.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.4.2.1.1.1.1.2" xref="S3.E1.m1.4.4.4.2.1.1.1.1.2.cmml">I</mi><mrow id="S3.E1.m1.4.4.4.2.1.1.1.1.3" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.cmml"><mi id="S3.E1.m1.4.4.4.2.1.1.1.1.3.2" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.4.2.1.1.1.1.3.1" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.4.2.1.1.1.1.3.3" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.4.2.1.1.1.1.3.1a" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.4.2.1.1.1.1.3.4" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.4.2.1.1.1.1.3.1b" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E1.m1.4.4.4.2.1.1.1.1.3.5" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.5.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.4.4.4.2.1.1.1.3" xref="S3.E1.m1.4.4.4.2.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E1.m1.4.4.4.2.1.3" xref="S3.E1.m1.4.4.4.2.1.3.cmml">i</mi></msub></mrow></mrow></mfrac></mrow></mrow><mo id="S3.E1.m1.5.5.1.2" xref="S3.E1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1"><eq id="S3.E1.m1.5.5.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1"></eq><apply id="S3.E1.m1.5.5.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2">ℒ</ci><apply id="S3.E1.m1.5.5.1.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.3"><times id="S3.E1.m1.5.5.1.1.2.3.1.cmml" xref="S3.E1.m1.5.5.1.1.2.3.1"></times><ci id="S3.E1.m1.5.5.1.1.2.3.2.cmml" xref="S3.E1.m1.5.5.1.1.2.3.2">𝑑</ci><ci id="S3.E1.m1.5.5.1.1.2.3.3.cmml" xref="S3.E1.m1.5.5.1.1.2.3.3">𝑖</ci><ci id="S3.E1.m1.5.5.1.1.2.3.4.cmml" xref="S3.E1.m1.5.5.1.1.2.3.4">𝑐</ci><ci id="S3.E1.m1.5.5.1.1.2.3.5.cmml" xref="S3.E1.m1.5.5.1.1.2.3.5">𝑒</ci></apply></apply><apply id="S3.E1.m1.5.5.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.3"><minus id="S3.E1.m1.5.5.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.3.1"></minus><cn type="integer" id="S3.E1.m1.5.5.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.3.2">1</cn><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"><divide id="S3.E1.m1.4.4.5.cmml" xref="S3.E1.m1.4.4"></divide><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><times id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3"></times><cn type="integer" id="S3.E1.m1.2.2.2.4.cmml" xref="S3.E1.m1.2.2.2.4">2</cn><apply id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2"><apply id="S3.E1.m1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.3.1.cmml" xref="S3.E1.m1.2.2.2.2.3">superscript</csymbol><apply id="S3.E1.m1.2.2.2.2.3.2.cmml" xref="S3.E1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.3.2.1.cmml" xref="S3.E1.m1.2.2.2.2.3">subscript</csymbol><sum id="S3.E1.m1.2.2.2.2.3.2.2.cmml" xref="S3.E1.m1.2.2.2.2.3.2.2"></sum><ci id="S3.E1.m1.2.2.2.2.3.2.3.cmml" xref="S3.E1.m1.2.2.2.2.3.2.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.2.2.3.3.cmml" xref="S3.E1.m1.2.2.2.2.3.3">𝑁</ci></apply><apply id="S3.E1.m1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2"><times id="S3.E1.m1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.3"></times><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2">𝐼</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2">𝑚</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.3">𝑎</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.4">𝑠</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.5">𝑘</ci></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E1.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.2">𝐼</ci><apply id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3"><times id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.1"></times><ci id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.2">𝑚</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.3">𝑎</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.4.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.4">𝑠</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.5.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.3.5">𝑘</ci></apply></apply><ci id="S3.E1.m1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E1.m1.4.4.4.cmml" xref="S3.E1.m1.4.4.4"><plus id="S3.E1.m1.4.4.4.3.cmml" xref="S3.E1.m1.4.4.4.3"></plus><apply id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.1"><apply id="S3.E1.m1.3.3.3.1.2.cmml" xref="S3.E1.m1.3.3.3.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.2.1.cmml" xref="S3.E1.m1.3.3.3.1.2">superscript</csymbol><apply id="S3.E1.m1.3.3.3.1.2.2.cmml" xref="S3.E1.m1.3.3.3.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.2.2.1.cmml" xref="S3.E1.m1.3.3.3.1.2">subscript</csymbol><sum id="S3.E1.m1.3.3.3.1.2.2.2.cmml" xref="S3.E1.m1.3.3.3.1.2.2.2"></sum><ci id="S3.E1.m1.3.3.3.1.2.2.3.cmml" xref="S3.E1.m1.3.3.3.1.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.3.3.3.1.2.3.cmml" xref="S3.E1.m1.3.3.3.1.2.3">𝑁</ci></apply><apply id="S3.E1.m1.3.3.3.1.1.cmml" xref="S3.E1.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.3.1.1">subscript</csymbol><apply id="S3.E1.m1.3.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1.1.2"><ci id="S3.E1.m1.3.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1.1.2.1">^</ci><ci id="S3.E1.m1.3.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1.1.2.2">𝐼</ci></apply><apply id="S3.E1.m1.3.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3"><times id="S3.E1.m1.3.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.1"></times><ci id="S3.E1.m1.3.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.2">𝑚</ci><ci id="S3.E1.m1.3.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.3">𝑎</ci><ci id="S3.E1.m1.3.3.3.1.1.1.1.1.3.4.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.4">𝑠</ci><ci id="S3.E1.m1.3.3.3.1.1.1.1.1.3.5.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1.1.3.5">𝑘</ci></apply></apply><ci id="S3.E1.m1.3.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.3.1.1.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.4.4.4.2.cmml" xref="S3.E1.m1.4.4.4.2"><apply id="S3.E1.m1.4.4.4.2.2.cmml" xref="S3.E1.m1.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.2.2.1.cmml" xref="S3.E1.m1.4.4.4.2.2">superscript</csymbol><apply id="S3.E1.m1.4.4.4.2.2.2.cmml" xref="S3.E1.m1.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.2.2.2.1.cmml" xref="S3.E1.m1.4.4.4.2.2">subscript</csymbol><sum id="S3.E1.m1.4.4.4.2.2.2.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.2"></sum><ci id="S3.E1.m1.4.4.4.2.2.2.3.cmml" xref="S3.E1.m1.4.4.4.2.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.4.4.4.2.2.3.cmml" xref="S3.E1.m1.4.4.4.2.2.3">𝑁</ci></apply><apply id="S3.E1.m1.4.4.4.2.1.cmml" xref="S3.E1.m1.4.4.4.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.2.1.2.cmml" xref="S3.E1.m1.4.4.4.2.1">subscript</csymbol><apply id="S3.E1.m1.4.4.4.2.1.1.1.1.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.2.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.4.2.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.2">𝐼</ci><apply id="S3.E1.m1.4.4.4.2.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3"><times id="S3.E1.m1.4.4.4.2.1.1.1.1.3.1.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.1"></times><ci id="S3.E1.m1.4.4.4.2.1.1.1.1.3.2.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.2">𝑚</ci><ci id="S3.E1.m1.4.4.4.2.1.1.1.1.3.3.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.3">𝑎</ci><ci id="S3.E1.m1.4.4.4.2.1.1.1.1.3.4.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.4">𝑠</ci><ci id="S3.E1.m1.4.4.4.2.1.1.1.1.3.5.cmml" xref="S3.E1.m1.4.4.4.2.1.1.1.1.3.5">𝑘</ci></apply></apply><ci id="S3.E1.m1.4.4.4.2.1.3.cmml" xref="S3.E1.m1.4.4.4.2.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\mathcal{L}_{dice}=1-\frac{2\sum_{i}^{N}(\hat{I}_{mask})_{i}(I_{mask})_{i}}{\sum_{i}^{N}(\hat{I}_{mask})_{i}+\sum_{i}^{N}(I_{mask})_{i}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.8" class="ltx_p">where N denotes the total number of pixels in the input image, and <math id="S3.SS1.p1.7.m1.1" class="ltx_Math" alttext="\hat{I}_{mask}" display="inline"><semantics id="S3.SS1.p1.7.m1.1a"><msub id="S3.SS1.p1.7.m1.1.1" xref="S3.SS1.p1.7.m1.1.1.cmml"><mover accent="true" id="S3.SS1.p1.7.m1.1.1.2" xref="S3.SS1.p1.7.m1.1.1.2.cmml"><mi id="S3.SS1.p1.7.m1.1.1.2.2" xref="S3.SS1.p1.7.m1.1.1.2.2.cmml">I</mi><mo id="S3.SS1.p1.7.m1.1.1.2.1" xref="S3.SS1.p1.7.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS1.p1.7.m1.1.1.3" xref="S3.SS1.p1.7.m1.1.1.3.cmml"><mi id="S3.SS1.p1.7.m1.1.1.3.2" xref="S3.SS1.p1.7.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m1.1.1.3.1" xref="S3.SS1.p1.7.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.7.m1.1.1.3.3" xref="S3.SS1.p1.7.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m1.1.1.3.1a" xref="S3.SS1.p1.7.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.7.m1.1.1.3.4" xref="S3.SS1.p1.7.m1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m1.1.1.3.1b" xref="S3.SS1.p1.7.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.7.m1.1.1.3.5" xref="S3.SS1.p1.7.m1.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m1.1b"><apply id="S3.SS1.p1.7.m1.1.1.cmml" xref="S3.SS1.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m1.1.1.1.cmml" xref="S3.SS1.p1.7.m1.1.1">subscript</csymbol><apply id="S3.SS1.p1.7.m1.1.1.2.cmml" xref="S3.SS1.p1.7.m1.1.1.2"><ci id="S3.SS1.p1.7.m1.1.1.2.1.cmml" xref="S3.SS1.p1.7.m1.1.1.2.1">^</ci><ci id="S3.SS1.p1.7.m1.1.1.2.2.cmml" xref="S3.SS1.p1.7.m1.1.1.2.2">𝐼</ci></apply><apply id="S3.SS1.p1.7.m1.1.1.3.cmml" xref="S3.SS1.p1.7.m1.1.1.3"><times id="S3.SS1.p1.7.m1.1.1.3.1.cmml" xref="S3.SS1.p1.7.m1.1.1.3.1"></times><ci id="S3.SS1.p1.7.m1.1.1.3.2.cmml" xref="S3.SS1.p1.7.m1.1.1.3.2">𝑚</ci><ci id="S3.SS1.p1.7.m1.1.1.3.3.cmml" xref="S3.SS1.p1.7.m1.1.1.3.3">𝑎</ci><ci id="S3.SS1.p1.7.m1.1.1.3.4.cmml" xref="S3.SS1.p1.7.m1.1.1.3.4">𝑠</ci><ci id="S3.SS1.p1.7.m1.1.1.3.5.cmml" xref="S3.SS1.p1.7.m1.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m1.1c">\hat{I}_{mask}</annotation></semantics></math> and <math id="S3.SS1.p1.8.m2.1" class="ltx_Math" alttext="I_{mask}" display="inline"><semantics id="S3.SS1.p1.8.m2.1a"><msub id="S3.SS1.p1.8.m2.1.1" xref="S3.SS1.p1.8.m2.1.1.cmml"><mi id="S3.SS1.p1.8.m2.1.1.2" xref="S3.SS1.p1.8.m2.1.1.2.cmml">I</mi><mrow id="S3.SS1.p1.8.m2.1.1.3" xref="S3.SS1.p1.8.m2.1.1.3.cmml"><mi id="S3.SS1.p1.8.m2.1.1.3.2" xref="S3.SS1.p1.8.m2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m2.1.1.3.1" xref="S3.SS1.p1.8.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.8.m2.1.1.3.3" xref="S3.SS1.p1.8.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m2.1.1.3.1a" xref="S3.SS1.p1.8.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.8.m2.1.1.3.4" xref="S3.SS1.p1.8.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m2.1.1.3.1b" xref="S3.SS1.p1.8.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.8.m2.1.1.3.5" xref="S3.SS1.p1.8.m2.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m2.1b"><apply id="S3.SS1.p1.8.m2.1.1.cmml" xref="S3.SS1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m2.1.1.1.cmml" xref="S3.SS1.p1.8.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m2.1.1.2.cmml" xref="S3.SS1.p1.8.m2.1.1.2">𝐼</ci><apply id="S3.SS1.p1.8.m2.1.1.3.cmml" xref="S3.SS1.p1.8.m2.1.1.3"><times id="S3.SS1.p1.8.m2.1.1.3.1.cmml" xref="S3.SS1.p1.8.m2.1.1.3.1"></times><ci id="S3.SS1.p1.8.m2.1.1.3.2.cmml" xref="S3.SS1.p1.8.m2.1.1.3.2">𝑚</ci><ci id="S3.SS1.p1.8.m2.1.1.3.3.cmml" xref="S3.SS1.p1.8.m2.1.1.3.3">𝑎</ci><ci id="S3.SS1.p1.8.m2.1.1.3.4.cmml" xref="S3.SS1.p1.8.m2.1.1.3.4">𝑠</ci><ci id="S3.SS1.p1.8.m2.1.1.3.5.cmml" xref="S3.SS1.p1.8.m2.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m2.1c">I_{mask}</annotation></semantics></math> represent the prediction and ground truth of the text mask, respectively. The total loss of the stroke mask prediction module is</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\mathcal{L}_{SMPM}=\|\hat{I}_{mask}-I_{mask}\|_{1}+\lambda_{0}\mathcal{L}_{dice}," display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.3.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.3.1" xref="S3.E2.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.3.3.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.3.1a" xref="S3.E2.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.3.4" xref="S3.E2.m1.1.1.1.1.3.3.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.3.1b" xref="S3.E2.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.3.3.5" xref="S3.E2.m1.1.1.1.1.3.3.5.cmml">M</mi></mrow></msub><mo id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">I</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1a" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.4" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1b" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.5" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.5.cmml">k</mi></mrow></msub><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">I</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.1b" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.5" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.5.cmml">k</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml"><msub id="S3.E2.m1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.1.3.2.2.cmml">λ</mi><mn id="S3.E2.m1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.1.3.2.3.cmml">0</mn></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E2.m1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S3.E2.m1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.3.3.3.2" xref="S3.E2.m1.1.1.1.1.1.3.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.3.3.3.1" xref="S3.E2.m1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.3.3.3.3" xref="S3.E2.m1.1.1.1.1.1.3.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.3.3.3.1a" xref="S3.E2.m1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.3.3.3.4" xref="S3.E2.m1.1.1.1.1.1.3.3.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.3.3.3.1b" xref="S3.E2.m1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.3.3.3.5" xref="S3.E2.m1.1.1.1.1.1.3.3.3.5.cmml">e</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"></eq><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2">ℒ</ci><apply id="S3.E2.m1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><times id="S3.E2.m1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.1"></times><ci id="S3.E2.m1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2">𝑆</ci><ci id="S3.E2.m1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3">𝑀</ci><ci id="S3.E2.m1.1.1.1.1.3.3.4.cmml" xref="S3.E2.m1.1.1.1.1.3.3.4">𝑃</ci><ci id="S3.E2.m1.1.1.1.1.3.3.5.cmml" xref="S3.E2.m1.1.1.1.1.3.3.5">𝑀</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><plus id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2"></plus><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1"><minus id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝐼</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑚</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.3">𝑎</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.4">𝑠</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.5.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.5">𝑘</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.2">𝐼</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑚</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.4">𝑠</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.3.5">𝑘</ci></apply></apply></apply></apply><cn type="integer" id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3"><times id="S3.E2.m1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.3.1"></times><apply id="S3.E2.m1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.3.2.2">𝜆</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3.2.3">0</cn></apply><apply id="S3.E2.m1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3.2">ℒ</ci><apply id="S3.E2.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3.3"><times id="S3.E2.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3.3.2">𝑑</ci><ci id="S3.E2.m1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3.3.3">𝑖</ci><ci id="S3.E2.m1.1.1.1.1.1.3.3.3.4.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3.3.4">𝑐</ci><ci id="S3.E2.m1.1.1.1.1.1.3.3.3.5.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3.3.5">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\mathcal{L}_{SMPM}=\|\hat{I}_{mask}-I_{mask}\|_{1}+\lambda_{0}\mathcal{L}_{dice},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.9" class="ltx_p">and in our experiments, <math id="S3.SS1.p1.9.m1.1" class="ltx_Math" alttext="\lambda_{0}" display="inline"><semantics id="S3.SS1.p1.9.m1.1a"><msub id="S3.SS1.p1.9.m1.1.1" xref="S3.SS1.p1.9.m1.1.1.cmml"><mi id="S3.SS1.p1.9.m1.1.1.2" xref="S3.SS1.p1.9.m1.1.1.2.cmml">λ</mi><mn id="S3.SS1.p1.9.m1.1.1.3" xref="S3.SS1.p1.9.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m1.1b"><apply id="S3.SS1.p1.9.m1.1.1.cmml" xref="S3.SS1.p1.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m1.1.1.1.cmml" xref="S3.SS1.p1.9.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m1.1.1.2.cmml" xref="S3.SS1.p1.9.m1.1.1.2">𝜆</ci><cn type="integer" id="S3.SS1.p1.9.m1.1.1.3.cmml" xref="S3.SS1.p1.9.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m1.1c">\lambda_{0}</annotation></semantics></math> is set to 1.0.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Architecture of the SMPM. Conv: Convolutional Layer, Deconv: Transposed Convolutional Layer, ResBlock: Residual Convolutional Block, C: Channels, K: Kernel Size, S: Stride</figcaption>
<table id="S3.T1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.1.1.1" class="ltx_tr">
<td id="S3.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:15.6pt;padding-right:15.6pt;">     Layers</td>
<td id="S3.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:15.6pt;padding-right:15.6pt;">     Conﬁgurations</td>
<td id="S3.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:15.6pt;padding-right:15.6pt;">     Output</td>
</tr>
<tr id="S3.T1.1.2.2" class="ltx_tr">
<td id="S3.T1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     Conv×2</td>
<td id="S3.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 32, k: 3, s: 1</td>
<td id="S3.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     128×640</td>
</tr>
<tr id="S3.T1.1.3.3" class="ltx_tr">
<td id="S3.T1.1.3.3.1" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     Conv</td>
<td id="S3.T1.1.3.3.2" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 64, k: 3, s: 2</td>
<td id="S3.T1.1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     64×320</td>
</tr>
<tr id="S3.T1.1.4.4" class="ltx_tr">
<td id="S3.T1.1.4.4.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     Conv×2</td>
<td id="S3.T1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 64, k: 3, s: 1</td>
<td id="S3.T1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     64×320</td>
</tr>
<tr id="S3.T1.1.5.5" class="ltx_tr">
<td id="S3.T1.1.5.5.1" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     Conv</td>
<td id="S3.T1.1.5.5.2" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 128, k: 3, s: 2</td>
<td id="S3.T1.1.5.5.3" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     32×160</td>
</tr>
<tr id="S3.T1.1.6.6" class="ltx_tr">
<td id="S3.T1.1.6.6.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     Conv×2</td>
<td id="S3.T1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 128, k: 3, s: 1</td>
<td id="S3.T1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     32×160</td>
</tr>
<tr id="S3.T1.1.7.7" class="ltx_tr">
<td id="S3.T1.1.7.7.1" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     Conv</td>
<td id="S3.T1.1.7.7.2" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 256, k: 3, s: 2</td>
<td id="S3.T1.1.7.7.3" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     16×80</td>
</tr>
<tr id="S3.T1.1.8.8" class="ltx_tr">
<td id="S3.T1.1.8.8.1" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     Conv×2</td>
<td id="S3.T1.1.8.8.2" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 256, k: 3, s: 1</td>
<td id="S3.T1.1.8.8.3" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     16×80</td>
</tr>
<tr id="S3.T1.1.9.9" class="ltx_tr">
<td id="S3.T1.1.9.9.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     ResBlock×4</td>
<td id="S3.T1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 256, k: 3</td>
<td id="S3.T1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     16×80</td>
</tr>
<tr id="S3.T1.1.10.10" class="ltx_tr">
<td id="S3.T1.1.10.10.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     Conv×2</td>
<td id="S3.T1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 256, k: 3, s: 1</td>
<td id="S3.T1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     16×80</td>
</tr>
<tr id="S3.T1.1.11.11" class="ltx_tr">
<td id="S3.T1.1.11.11.1" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     Deconv</td>
<td id="S3.T1.1.11.11.2" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 128, k: 3, s: 1/2</td>
<td id="S3.T1.1.11.11.3" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     32×160</td>
</tr>
<tr id="S3.T1.1.12.12" class="ltx_tr">
<td id="S3.T1.1.12.12.1" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     Conv×2</td>
<td id="S3.T1.1.12.12.2" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 128, k: 3, s: 1</td>
<td id="S3.T1.1.12.12.3" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     32×160</td>
</tr>
<tr id="S3.T1.1.13.13" class="ltx_tr">
<td id="S3.T1.1.13.13.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     Deconv</td>
<td id="S3.T1.1.13.13.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 64, k: 3, s: 1/2</td>
<td id="S3.T1.1.13.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     64×320</td>
</tr>
<tr id="S3.T1.1.14.14" class="ltx_tr">
<td id="S3.T1.1.14.14.1" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     Conv×2</td>
<td id="S3.T1.1.14.14.2" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 64, k: 3, s: 1</td>
<td id="S3.T1.1.14.14.3" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     64×320</td>
</tr>
<tr id="S3.T1.1.15.15" class="ltx_tr">
<td id="S3.T1.1.15.15.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     Deconv</td>
<td id="S3.T1.1.15.15.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 32, k: 3, s: 1/2</td>
<td id="S3.T1.1.15.15.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:15.6pt;padding-right:15.6pt;">     128×640</td>
</tr>
<tr id="S3.T1.1.16.16" class="ltx_tr">
<td id="S3.T1.1.16.16.1" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     Conv×2</td>
<td id="S3.T1.1.16.16.2" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 32, k: 3, s: 1</td>
<td id="S3.T1.1.16.16.3" class="ltx_td ltx_align_center" style="padding-left:15.6pt;padding-right:15.6pt;">     128×640</td>
</tr>
<tr id="S3.T1.1.17.17" class="ltx_tr">
<td id="S3.T1.1.17.17.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:15.6pt;padding-right:15.6pt;">     Conv</td>
<td id="S3.T1.1.17.17.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:15.6pt;padding-right:15.6pt;">     c: 3, k: 3, s: 1</td>
<td id="S3.T1.1.17.17.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:15.6pt;padding-right:15.6pt;">     128×640</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Architecture of the BIPM. PConv: Partial Convolutional Layer, Upsample: Upsample Layer, Scale: Scale Factor, C: Channels, K: Kernel Size, S: Stride</figcaption>
<table id="S3.T2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T2.1.1.1" class="ltx_tr">
<td id="S3.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:17.1pt;padding-right:17.1pt;">      Layers</td>
<td id="S3.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:17.1pt;padding-right:17.1pt;">      Conﬁgurations</td>
<td id="S3.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:17.1pt;padding-right:17.1pt;">      Output</td>
</tr>
<tr id="S3.T2.1.2.2" class="ltx_tr">
<td id="S3.T2.1.2.2.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      PConv</td>
<td id="S3.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 64, k: 7, s: 2</td>
<td id="S3.T2.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      64×320</td>
</tr>
<tr id="S3.T2.1.3.3" class="ltx_tr">
<td id="S3.T2.1.3.3.1" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      PConv×2</td>
<td id="S3.T2.1.3.3.2" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 64, k: 3, s: 1</td>
<td id="S3.T2.1.3.3.3" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      64×320</td>
</tr>
<tr id="S3.T2.1.4.4" class="ltx_tr">
<td id="S3.T2.1.4.4.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      PConv</td>
<td id="S3.T2.1.4.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 128, k: 5, s: 2</td>
<td id="S3.T2.1.4.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      32×160</td>
</tr>
<tr id="S3.T2.1.5.5" class="ltx_tr">
<td id="S3.T2.1.5.5.1" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      PConv×2</td>
<td id="S3.T2.1.5.5.2" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 128, k: 3, s: 1</td>
<td id="S3.T2.1.5.5.3" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      32×160</td>
</tr>
<tr id="S3.T2.1.6.6" class="ltx_tr">
<td id="S3.T2.1.6.6.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      PConv</td>
<td id="S3.T2.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 256, k: 3, s: 2</td>
<td id="S3.T2.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      16×80</td>
</tr>
<tr id="S3.T2.1.7.7" class="ltx_tr">
<td id="S3.T2.1.7.7.1" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      PConv×2</td>
<td id="S3.T2.1.7.7.2" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 256, k: 3, s: 1</td>
<td id="S3.T2.1.7.7.3" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      16×80</td>
</tr>
<tr id="S3.T2.1.8.8" class="ltx_tr">
<td id="S3.T2.1.8.8.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      GCblock</td>
<td id="S3.T2.1.8.8.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 512, ratio: 4</td>
<td id="S3.T2.1.8.8.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      16×80</td>
</tr>
<tr id="S3.T2.1.9.9" class="ltx_tr">
<td id="S3.T2.1.9.9.1" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      Conv</td>
<td id="S3.T2.1.9.9.2" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 256, k: 3, s: 1</td>
<td id="S3.T2.1.9.9.3" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      16×80</td>
</tr>
<tr id="S3.T2.1.10.10" class="ltx_tr">
<td id="S3.T2.1.10.10.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      Upsample</td>
<td id="S3.T2.1.10.10.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      scale: 2</td>
<td id="S3.T2.1.10.10.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      32×160</td>
</tr>
<tr id="S3.T2.1.11.11" class="ltx_tr">
<td id="S3.T2.1.11.11.1" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      Pconv×2</td>
<td id="S3.T2.1.11.11.2" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 256, k: 3, s: 1</td>
<td id="S3.T2.1.11.11.3" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      32×160</td>
</tr>
<tr id="S3.T2.1.12.12" class="ltx_tr">
<td id="S3.T2.1.12.12.1" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      PConv</td>
<td id="S3.T2.1.12.12.2" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 128, k: 3, s: 1</td>
<td id="S3.T2.1.12.12.3" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      32×160</td>
</tr>
<tr id="S3.T2.1.13.13" class="ltx_tr">
<td id="S3.T2.1.13.13.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      Upsample</td>
<td id="S3.T2.1.13.13.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      scale: 2</td>
<td id="S3.T2.1.13.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      64×320</td>
</tr>
<tr id="S3.T2.1.14.14" class="ltx_tr">
<td id="S3.T2.1.14.14.1" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      Pconv×2</td>
<td id="S3.T2.1.14.14.2" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 128, k: 3, s: 1</td>
<td id="S3.T2.1.14.14.3" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      64×320</td>
</tr>
<tr id="S3.T2.1.15.15" class="ltx_tr">
<td id="S3.T2.1.15.15.1" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      PConv</td>
<td id="S3.T2.1.15.15.2" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 64, k: 3, s: 1</td>
<td id="S3.T2.1.15.15.3" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      64×320</td>
</tr>
<tr id="S3.T2.1.16.16" class="ltx_tr">
<td id="S3.T2.1.16.16.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      Upsample</td>
<td id="S3.T2.1.16.16.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      scale: 2</td>
<td id="S3.T2.1.16.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:17.1pt;padding-right:17.1pt;">      128×640</td>
</tr>
<tr id="S3.T2.1.17.17" class="ltx_tr">
<td id="S3.T2.1.17.17.1" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      Pconv×2</td>
<td id="S3.T2.1.17.17.2" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 64, k: 3, s: 1</td>
<td id="S3.T2.1.17.17.3" class="ltx_td ltx_align_center" style="padding-left:17.1pt;padding-right:17.1pt;">      128×640</td>
</tr>
<tr id="S3.T2.1.18.18" class="ltx_tr">
<td id="S3.T2.1.18.18.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:17.1pt;padding-right:17.1pt;">      PConv</td>
<td id="S3.T2.1.18.18.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:17.1pt;padding-right:17.1pt;">      c: 3, k: 3, s: 1</td>
<td id="S3.T2.1.18.18.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:17.1pt;padding-right:17.1pt;">      128×640</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2104.11493/assets/fig4.png" id="S3.F4.g1" class="ltx_graphics ltx_img_landscape" width="598" height="256" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Architecture of self-attention block: Global Context (GC) block.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Background Inpainting Module</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.5" class="ltx_p">In this module, the input image <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="I_{in}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">I</mi><mrow id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝐼</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><times id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">I_{in}</annotation></semantics></math> and the predicted mask image <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\hat{I}_{mask}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mover accent="true" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml">I</mi><mo id="S3.SS2.p1.2.m2.1.1.2.1" xref="S3.SS2.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.3.1" xref="S3.SS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.3.1a" xref="S3.SS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.2.m2.1.1.3.4" xref="S3.SS2.p1.2.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.3.1b" xref="S3.SS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.2.m2.1.1.3.5" xref="S3.SS2.p1.2.m2.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"><ci id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2.1">^</ci><ci id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">𝐼</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><times id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">𝑚</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">𝑎</ci><ci id="S3.SS2.p1.2.m2.1.1.3.4.cmml" xref="S3.SS2.p1.2.m2.1.1.3.4">𝑠</ci><ci id="S3.SS2.p1.2.m2.1.1.3.5.cmml" xref="S3.SS2.p1.2.m2.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\hat{I}_{mask}</annotation></semantics></math> are taken as input, and the output is the background image <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="O_{b}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">O</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑂</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">O_{b}</annotation></semantics></math>, in which all text stroke pixels, including text shadows caused by illumination, are replaced with proper texture. As shown in the blue part of Fig. <a href="#S1.F3" title="Figure 3 ‣ I Introduction ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the input image is encoded by three down-sampling partial convolutional layers and concatenated with the feature map <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="F_{m}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">F</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝐹</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">F_{m}</annotation></semantics></math> from the SMPM. This is followed by a self-attention block, which allows the network to learn long-range dependencies. Finally, the decoder generates the output image <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\hat{I}_{out}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mover accent="true" id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2.2" xref="S3.SS2.p1.5.m5.1.1.2.2.cmml">I</mi><mo id="S3.SS2.p1.5.m5.1.1.2.1" xref="S3.SS2.p1.5.m5.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.2" xref="S3.SS2.p1.5.m5.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.3.1" xref="S3.SS2.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.5.m5.1.1.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.3.1a" xref="S3.SS2.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.5.m5.1.1.3.4" xref="S3.SS2.p1.5.m5.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2"><ci id="S3.SS2.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1.2.1">^</ci><ci id="S3.SS2.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2">𝐼</ci></apply><apply id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><times id="S3.SS2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3.1"></times><ci id="S3.SS2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2">𝑜</ci><ci id="S3.SS2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3">𝑢</ci><ci id="S3.SS2.p1.5.m5.1.1.3.4.cmml" xref="S3.SS2.p1.5.m5.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\hat{I}_{out}</annotation></semantics></math>. The architecture of the BIPM is presented in Table <a href="#S3.T2" title="TABLE II ‣ III-A Stroke Mask Prediction Module ‣ III Methodology ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>.</p>
</div>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS2.SSS1.4.1.1" class="ltx_text">III-B</span>1 </span>Partial Convolutional Layers</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.1" class="ltx_p">To generate clearer background images and suppress text ghosts and artifacts, we use partial convolutional layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> to allow the network to learn more features from the non-text part of <math id="S3.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="I_{in}" display="inline"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><msub id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml">I</mi><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.1.m1.1.1.3.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2">𝐼</ci><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3"><times id="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.1"></times><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">I_{in}</annotation></semantics></math>. The partial convolution layer comprises two steps: the partial convolution operation and mask update. The partial convolution operation and mask update are defined as follows:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.6" class="ltx_Math" alttext="{x^{\prime}}=\left\{\begin{array}[]{l}{\textbf{W}}^{\textit{T}}(\textbf{X}\odot\textbf{M})\frac{\text{ sum($\textbf{1}$)}}{\text{sum({M})}}+b,\quad{\text{if sum({M})}}&gt;0\\
0,\qquad\qquad\qquad\qquad\qquad\quad\text{otherwise}\end{array}\right.," display="block"><semantics id="S3.E3.m1.6a"><mrow id="S3.E3.m1.6.6.1" xref="S3.E3.m1.6.6.1.1.cmml"><mrow id="S3.E3.m1.6.6.1.1" xref="S3.E3.m1.6.6.1.1.cmml"><msup id="S3.E3.m1.6.6.1.1.2" xref="S3.E3.m1.6.6.1.1.2.cmml"><mi id="S3.E3.m1.6.6.1.1.2.2" xref="S3.E3.m1.6.6.1.1.2.2.cmml">x</mi><mo id="S3.E3.m1.6.6.1.1.2.3" xref="S3.E3.m1.6.6.1.1.2.3.cmml">′</mo></msup><mo id="S3.E3.m1.6.6.1.1.1" xref="S3.E3.m1.6.6.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.6.6.1.1.3.2" xref="S3.E3.m1.6.6.1.1.3.1.cmml"><mo id="S3.E3.m1.6.6.1.1.3.2.1" xref="S3.E3.m1.6.6.1.1.3.1.1.cmml">{</mo><mtable displaystyle="true" rowspacing="0pt" id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml"><mtr id="S3.E3.m1.5.5a" xref="S3.E3.m1.5.5.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.5.5b" xref="S3.E3.m1.5.5.cmml"><mrow id="S3.E3.m1.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.cmml"><mrow id="S3.E3.m1.3.3.3.3.3.3.1" xref="S3.E3.m1.3.3.3.3.3.3.2.cmml"><mrow id="S3.E3.m1.3.3.3.3.3.3.1.1" xref="S3.E3.m1.3.3.3.3.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.3.3.3.3.1.1.1" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.cmml"><msup id="S3.E3.m1.3.3.3.3.3.3.1.1.1.3" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.2" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.2a.cmml">W</mtext><mtext class="ltx_mathvariant_italic" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.3" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.3a.cmml">T</mtext></msup><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.2" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.2a.cmml">X</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.cmml">⊙</mo><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.3a.cmml">M</mtext></mrow><mo stretchy="false" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.3" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.2a" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.2.cmml">​</mo><mstyle displaystyle="false" id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mfrac id="S3.E3.m1.1.1.1.1.1.1a" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1d.cmml"><mtext id="S3.E3.m1.1.1.1.1.1.1.1a" xref="S3.E3.m1.1.1.1.1.1.1.1d.cmml"> sum(</mtext><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.1.1.1.1.1.1.1b" xref="S3.E3.m1.1.1.1.1.1.1.1d.cmml">1</mtext><mtext id="S3.E3.m1.1.1.1.1.1.1.1c" xref="S3.E3.m1.1.1.1.1.1.1.1d.cmml">)</mtext></mrow><mrow id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3d.cmml"><mtext id="S3.E3.m1.1.1.1.1.1.1.3a" xref="S3.E3.m1.1.1.1.1.1.1.3d.cmml">sum(</mtext><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.1.1.1.1.1.1.3b" xref="S3.E3.m1.1.1.1.1.1.1.3d.cmml">M</mtext><mtext id="S3.E3.m1.1.1.1.1.1.1.3c" xref="S3.E3.m1.1.1.1.1.1.1.3d.cmml">)</mtext></mrow></mfrac></mstyle></mrow><mo id="S3.E3.m1.3.3.3.3.3.3.1.1.2" xref="S3.E3.m1.3.3.3.3.3.3.1.1.2.cmml">+</mo><mi id="S3.E3.m1.3.3.3.3.3.3.1.1.3" xref="S3.E3.m1.3.3.3.3.3.3.1.1.3.cmml">b</mi></mrow><mo rspace="1.167em" id="S3.E3.m1.3.3.3.3.3.3.1.2" xref="S3.E3.m1.3.3.3.3.3.3.2.cmml">,</mo><mrow id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2d.cmml"><mtext id="S3.E3.m1.2.2.2.2.2.2a" xref="S3.E3.m1.2.2.2.2.2.2d.cmml">if sum(</mtext><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.2.2.2.2.2.2b" xref="S3.E3.m1.2.2.2.2.2.2d.cmml">M</mtext><mtext id="S3.E3.m1.2.2.2.2.2.2c" xref="S3.E3.m1.2.2.2.2.2.2d.cmml">)</mtext></mrow></mrow><mo id="S3.E3.m1.3.3.3.3.3.4" xref="S3.E3.m1.3.3.3.3.3.4.cmml">&gt;</mo><mn id="S3.E3.m1.3.3.3.3.3.5" xref="S3.E3.m1.3.3.3.3.3.5.cmml">0</mn></mrow></mtd></mtr><mtr id="S3.E3.m1.5.5c" xref="S3.E3.m1.5.5.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.5.5d" xref="S3.E3.m1.5.5.cmml"><mrow id="S3.E3.m1.5.5.5.2.2.4" xref="S3.E3.m1.5.5.5.2.2.3.cmml"><mn id="S3.E3.m1.4.4.4.1.1.1" xref="S3.E3.m1.4.4.4.1.1.1.cmml">0</mn><mo rspace="11.167em" id="S3.E3.m1.5.5.5.2.2.4.1" xref="S3.E3.m1.5.5.5.2.2.3.cmml">,</mo><mtext id="S3.E3.m1.5.5.5.2.2.2" xref="S3.E3.m1.5.5.5.2.2.2a.cmml">otherwise</mtext></mrow></mtd></mtr></mtable><mi id="S3.E3.m1.6.6.1.1.3.2.2" xref="S3.E3.m1.6.6.1.1.3.1.1.cmml"></mi></mrow></mrow><mo id="S3.E3.m1.6.6.1.2" xref="S3.E3.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.6b"><apply id="S3.E3.m1.6.6.1.1.cmml" xref="S3.E3.m1.6.6.1"><eq id="S3.E3.m1.6.6.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1"></eq><apply id="S3.E3.m1.6.6.1.1.2.cmml" xref="S3.E3.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.2.1.cmml" xref="S3.E3.m1.6.6.1.1.2">superscript</csymbol><ci id="S3.E3.m1.6.6.1.1.2.2.cmml" xref="S3.E3.m1.6.6.1.1.2.2">𝑥</ci><ci id="S3.E3.m1.6.6.1.1.2.3.cmml" xref="S3.E3.m1.6.6.1.1.2.3">′</ci></apply><apply id="S3.E3.m1.6.6.1.1.3.1.cmml" xref="S3.E3.m1.6.6.1.1.3.2"><csymbol cd="latexml" id="S3.E3.m1.6.6.1.1.3.1.1.cmml" xref="S3.E3.m1.6.6.1.1.3.2.1">cases</csymbol><matrix id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5"><matrixrow id="S3.E3.m1.5.5a.cmml" xref="S3.E3.m1.5.5"><apply id="S3.E3.m1.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3"><gt id="S3.E3.m1.3.3.3.3.3.4.cmml" xref="S3.E3.m1.3.3.3.3.3.4"></gt><list id="S3.E3.m1.3.3.3.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1"><apply id="S3.E3.m1.3.3.3.3.3.3.1.1.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1"><plus id="S3.E3.m1.3.3.3.3.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.2"></plus><apply id="S3.E3.m1.3.3.3.3.3.3.1.1.1.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1"><times id="S3.E3.m1.3.3.3.3.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.2"></times><apply id="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.3">superscript</csymbol><ci id="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.2a.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.2">W</mtext></ci><ci id="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.3a.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.3"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.3.3">T</mtext></ci></apply><apply id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.1">direct-product</csymbol><ci id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.2a.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.2">X</mtext></ci><ci id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.3a.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.1.1.1.1.3">M</mtext></ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><divide id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"></divide><ci id="S3.E3.m1.1.1.1.1.1.1.1d.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><mtext mathsize="70%" id="S3.E3.m1.1.1.1.1.1.1.1a.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"> sum(</mtext><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S3.E3.m1.1.1.1.1.1.1.1b.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">1</mtext><mtext mathsize="70%" id="S3.E3.m1.1.1.1.1.1.1.1c.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">)</mtext></mrow></ci><ci id="S3.E3.m1.1.1.1.1.1.1.3d.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><mrow id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E3.m1.1.1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">sum(</mtext><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S3.E3.m1.1.1.1.1.1.1.3b.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">M</mtext><mtext mathsize="70%" id="S3.E3.m1.1.1.1.1.1.1.3c.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">)</mtext></mrow></ci></apply></apply><ci id="S3.E3.m1.3.3.3.3.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.1.3">𝑏</ci></apply><ci id="S3.E3.m1.2.2.2.2.2.2d.cmml" xref="S3.E3.m1.2.2.2.2.2.2"><mrow id="S3.E3.m1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2"><mtext id="S3.E3.m1.2.2.2.2.2.2a.cmml" xref="S3.E3.m1.2.2.2.2.2.2">if sum(</mtext><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.2.2.2.2.2.2b.cmml" xref="S3.E3.m1.2.2.2.2.2.2">M</mtext><mtext id="S3.E3.m1.2.2.2.2.2.2c.cmml" xref="S3.E3.m1.2.2.2.2.2.2">)</mtext></mrow></ci></list><cn type="integer" id="S3.E3.m1.3.3.3.3.3.5.cmml" xref="S3.E3.m1.3.3.3.3.3.5">0</cn></apply></matrixrow><matrixrow id="S3.E3.m1.5.5b.cmml" xref="S3.E3.m1.5.5"><list id="S3.E3.m1.5.5.5.2.2.3.cmml" xref="S3.E3.m1.5.5.5.2.2.4"><cn type="integer" id="S3.E3.m1.4.4.4.1.1.1.cmml" xref="S3.E3.m1.4.4.4.1.1.1">0</cn><ci id="S3.E3.m1.5.5.5.2.2.2a.cmml" xref="S3.E3.m1.5.5.5.2.2.2"><mtext id="S3.E3.m1.5.5.5.2.2.2.cmml" xref="S3.E3.m1.5.5.5.2.2.2">otherwise</mtext></ci></list></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.6c">{x^{\prime}}=\left\{\begin{array}[]{l}{\textbf{W}}^{\textit{T}}(\textbf{X}\odot\textbf{M})\frac{\text{ sum($\textbf{1}$)}}{\text{sum({M})}}+b,\quad{\text{if sum({M})}}&gt;0\\
0,\qquad\qquad\qquad\qquad\qquad\quad\text{otherwise}\end{array}\right.,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.5" class="ltx_Math" alttext="{m^{\prime}}=\left\{\begin{array}[]{l}1,\quad\text{if sum({M})}&gt;0\\
0,\quad\text{otherwise}\end{array}\right.," display="block"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><msup id="S3.E4.m1.5.5.1.1.2" xref="S3.E4.m1.5.5.1.1.2.cmml"><mi id="S3.E4.m1.5.5.1.1.2.2" xref="S3.E4.m1.5.5.1.1.2.2.cmml">m</mi><mo id="S3.E4.m1.5.5.1.1.2.3" xref="S3.E4.m1.5.5.1.1.2.3.cmml">′</mo></msup><mo id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.5.5.1.1.3.2" xref="S3.E4.m1.5.5.1.1.3.1.cmml"><mo id="S3.E4.m1.5.5.1.1.3.2.1" xref="S3.E4.m1.5.5.1.1.3.1.1.cmml">{</mo><mtable displaystyle="true" rowspacing="0pt" id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mtr id="S3.E4.m1.4.4a" xref="S3.E4.m1.4.4.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.4.4b" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.cmml"><mrow id="S3.E4.m1.2.2.2.2.2.4.2" xref="S3.E4.m1.2.2.2.2.2.4.1.cmml"><mn id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">1</mn><mo rspace="1.167em" id="S3.E4.m1.2.2.2.2.2.4.2.1" xref="S3.E4.m1.2.2.2.2.2.4.1.cmml">,</mo><mrow id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2d.cmml"><mtext id="S3.E4.m1.2.2.2.2.2.2a" xref="S3.E4.m1.2.2.2.2.2.2d.cmml">if sum(</mtext><mtext class="ltx_mathvariant_bold" id="S3.E4.m1.2.2.2.2.2.2b" xref="S3.E4.m1.2.2.2.2.2.2d.cmml">M</mtext><mtext id="S3.E4.m1.2.2.2.2.2.2c" xref="S3.E4.m1.2.2.2.2.2.2d.cmml">)</mtext></mrow></mrow><mo id="S3.E4.m1.2.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.3.cmml">&gt;</mo><mn id="S3.E4.m1.2.2.2.2.2.5" xref="S3.E4.m1.2.2.2.2.2.5.cmml">0</mn></mrow></mtd></mtr><mtr id="S3.E4.m1.4.4c" xref="S3.E4.m1.4.4.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.4.4d" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.4.4.4.2.2.4" xref="S3.E4.m1.4.4.4.2.2.3.cmml"><mn id="S3.E4.m1.3.3.3.1.1.1" xref="S3.E4.m1.3.3.3.1.1.1.cmml">0</mn><mo rspace="1.167em" id="S3.E4.m1.4.4.4.2.2.4.1" xref="S3.E4.m1.4.4.4.2.2.3.cmml">,</mo><mtext id="S3.E4.m1.4.4.4.2.2.2" xref="S3.E4.m1.4.4.4.2.2.2a.cmml">otherwise</mtext></mrow></mtd></mtr></mtable><mi id="S3.E4.m1.5.5.1.1.3.2.2" xref="S3.E4.m1.5.5.1.1.3.1.1.cmml"></mi></mrow></mrow><mo id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1"><eq id="S3.E4.m1.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"></eq><apply id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2">superscript</csymbol><ci id="S3.E4.m1.5.5.1.1.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2.2">𝑚</ci><ci id="S3.E4.m1.5.5.1.1.2.3.cmml" xref="S3.E4.m1.5.5.1.1.2.3">′</ci></apply><apply id="S3.E4.m1.5.5.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.3.1.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.1">cases</csymbol><matrix id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><matrixrow id="S3.E4.m1.4.4a.cmml" xref="S3.E4.m1.4.4"><apply id="S3.E4.m1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2"><gt id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.3"></gt><list id="S3.E4.m1.2.2.2.2.2.4.1.cmml" xref="S3.E4.m1.2.2.2.2.2.4.2"><cn type="integer" id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">1</cn><ci id="S3.E4.m1.2.2.2.2.2.2d.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><mrow id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><mtext id="S3.E4.m1.2.2.2.2.2.2a.cmml" xref="S3.E4.m1.2.2.2.2.2.2">if sum(</mtext><mtext class="ltx_mathvariant_bold" id="S3.E4.m1.2.2.2.2.2.2b.cmml" xref="S3.E4.m1.2.2.2.2.2.2">M</mtext><mtext id="S3.E4.m1.2.2.2.2.2.2c.cmml" xref="S3.E4.m1.2.2.2.2.2.2">)</mtext></mrow></ci></list><cn type="integer" id="S3.E4.m1.2.2.2.2.2.5.cmml" xref="S3.E4.m1.2.2.2.2.2.5">0</cn></apply></matrixrow><matrixrow id="S3.E4.m1.4.4b.cmml" xref="S3.E4.m1.4.4"><list id="S3.E4.m1.4.4.4.2.2.3.cmml" xref="S3.E4.m1.4.4.4.2.2.4"><cn type="integer" id="S3.E4.m1.3.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.3.1.1.1">0</cn><ci id="S3.E4.m1.4.4.4.2.2.2a.cmml" xref="S3.E4.m1.4.4.4.2.2.2"><mtext id="S3.E4.m1.4.4.4.2.2.2.cmml" xref="S3.E4.m1.4.4.4.2.2.2">otherwise</mtext></ci></list></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">{m^{\prime}}=\left\{\begin{array}[]{l}1,\quad\text{if sum({M})}&gt;0\\
0,\quad\text{otherwise}\end{array}\right.,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p2.9" class="ltx_p">where <span id="S3.SS2.SSS1.p2.9.1" class="ltx_text ltx_markedasmath ltx_font_bold">W</span> and <math id="S3.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="{b}" display="inline"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><mi id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><ci id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">{b}</annotation></semantics></math> indicate the weights and bias of the convolution filter, respectively. <span id="S3.SS2.SSS1.p2.9.2" class="ltx_text ltx_markedasmath ltx_font_bold">X</span> are the input pixels for the current convolution window, and <span id="S3.SS2.SSS1.p2.9.3" class="ltx_text ltx_markedasmath ltx_font_bold">M</span> is the corresponding mask in the receptive field. <math id="S3.SS2.SSS1.p2.5.m5.1" class="ltx_Math" alttext="{\odot}" display="inline"><semantics id="S3.SS2.SSS1.p2.5.m5.1a"><mo id="S3.SS2.SSS1.p2.5.m5.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.5.m5.1b"><csymbol cd="latexml" id="S3.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m5.1c">{\odot}</annotation></semantics></math> denotes element-wise multiplication. <math id="S3.SS2.SSS1.p2.6.m6.1" class="ltx_Math" alttext="x^{\prime}" display="inline"><semantics id="S3.SS2.SSS1.p2.6.m6.1a"><msup id="S3.SS2.SSS1.p2.6.m6.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.cmml"><mi id="S3.SS2.SSS1.p2.6.m6.1.1.2" xref="S3.SS2.SSS1.p2.6.m6.1.1.2.cmml">x</mi><mo id="S3.SS2.SSS1.p2.6.m6.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.6.m6.1b"><apply id="S3.SS2.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.6.m6.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p2.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p2.6.m6.1.1.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.6.m6.1c">x^{\prime}</annotation></semantics></math> is the output feature value of the partial convolution, and <math id="S3.SS2.SSS1.p2.7.m7.1" class="ltx_Math" alttext="m^{\prime}" display="inline"><semantics id="S3.SS2.SSS1.p2.7.m7.1a"><msup id="S3.SS2.SSS1.p2.7.m7.1.1" xref="S3.SS2.SSS1.p2.7.m7.1.1.cmml"><mi id="S3.SS2.SSS1.p2.7.m7.1.1.2" xref="S3.SS2.SSS1.p2.7.m7.1.1.2.cmml">m</mi><mo id="S3.SS2.SSS1.p2.7.m7.1.1.3" xref="S3.SS2.SSS1.p2.7.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.7.m7.1b"><apply id="S3.SS2.SSS1.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.7.m7.1.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p2.7.m7.1.1.2.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1.2">𝑚</ci><ci id="S3.SS2.SSS1.p2.7.m7.1.1.3.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.7.m7.1c">m^{\prime}</annotation></semantics></math> is the updated mask value. <span id="S3.SS2.SSS1.p2.9.4" class="ltx_text ltx_markedasmath ltx_font_bold">1</span> is an all-one matrix with the same shape as <span id="S3.SS2.SSS1.p2.9.5" class="ltx_text ltx_markedasmath ltx_font_bold">M</span>.</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS2.SSS2.4.1.1" class="ltx_text">III-B</span>2 </span>Skip Connection and Self-Attention Block</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.3" class="ltx_p">By leveraging partial convolutional layers, we can extract more features from outside the text region, which are beneficial for background reconstruction. However, in some cases, the feature information related to texture and illumination (such as highlight, shadow, and transparency) inside the text region is also helpful for background inpainting. Thus, considering that the feature maps <math id="S3.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="F_{m}" display="inline"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><msub id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml">F</mi><mi id="S3.SS2.SSS2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2">𝐹</ci><ci id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">F_{m}</annotation></semantics></math> generated in the SMPM contain rich feature information of the text, we concatenate the feature maps <math id="S3.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="F_{m}" display="inline"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><msub id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml">F</mi><mi id="S3.SS2.SSS2.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><apply id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.2">𝐹</ci><ci id="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">F_{m}</annotation></semantics></math> and <math id="S3.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="F_{b}" display="inline"><semantics id="S3.SS2.SSS2.p1.3.m3.1a"><msub id="S3.SS2.SSS2.p1.3.m3.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml">F</mi><mi id="S3.SS2.SSS2.p1.3.m3.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.1b"><apply id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.2">𝐹</ci><ci id="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">F_{b}</annotation></semantics></math> from the two modules using skip connection, and feed the concatenated feature maps into a self-attention network that learns both the correspondences between feature maps and non-local features. Consequently, the features inside and outside the text regions are split and weighted by a self-attention block for later decoding. Here, we adopt a Global Context (GC) block <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> as the self-attention module, the architecture of which is illustrated in Fig. <a href="#S3.F4" title="Figure 4 ‣ III-A Stroke Mask Prediction Module ‣ III Methodology ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
<section id="S3.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS2.SSS3.4.1.1" class="ltx_text">III-B</span>3 </span>Training Loss</h4>

<div id="S3.SS2.SSS3.p1" class="ltx_para">
<p id="S3.SS2.SSS3.p1.3" class="ltx_p">We introduce four loss functions to measure the structural and textural differences between the output image <math id="S3.SS2.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\hat{I}_{out}" display="inline"><semantics id="S3.SS2.SSS3.p1.1.m1.1a"><msub id="S3.SS2.SSS3.p1.1.m1.1.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.cmml"><mover accent="true" id="S3.SS2.SSS3.p1.1.m1.1.1.2" xref="S3.SS2.SSS3.p1.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.1.1.2.2" xref="S3.SS2.SSS3.p1.1.m1.1.1.2.2.cmml">I</mi><mo id="S3.SS2.SSS3.p1.1.m1.1.1.2.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.SSS3.p1.1.m1.1.1.3" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p1.1.m1.1.1.3.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p1.1.m1.1.1.3.1a" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p1.1.m1.1.1.3.4" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.1.m1.1b"><apply id="S3.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.2"><ci id="S3.SS2.SSS3.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.2.1">^</ci><ci id="S3.SS2.SSS3.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.2.2">𝐼</ci></apply><apply id="S3.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3"><times id="S3.SS2.SSS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.1"></times><ci id="S3.SS2.SSS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.2">𝑜</ci><ci id="S3.SS2.SSS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.3">𝑢</ci><ci id="S3.SS2.SSS3.p1.1.m1.1.1.3.4.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.1.m1.1c">\hat{I}_{out}</annotation></semantics></math> and the final ground truth <math id="S3.SS2.SSS3.p1.2.m2.1" class="ltx_Math" alttext="{I}_{out}" display="inline"><semantics id="S3.SS2.SSS3.p1.2.m2.1a"><msub id="S3.SS2.SSS3.p1.2.m2.1.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p1.2.m2.1.1.2" xref="S3.SS2.SSS3.p1.2.m2.1.1.2.cmml">I</mi><mrow id="S3.SS2.SSS3.p1.2.m2.1.1.3" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS3.p1.2.m2.1.1.3.2" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p1.2.m2.1.1.3.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p1.2.m2.1.1.3.3" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p1.2.m2.1.1.3.1a" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p1.2.m2.1.1.3.4" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.2.m2.1b"><apply id="S3.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.2">𝐼</ci><apply id="S3.SS2.SSS3.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.3"><times id="S3.SS2.SSS3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.1"></times><ci id="S3.SS2.SSS3.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.2">𝑜</ci><ci id="S3.SS2.SSS3.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.3">𝑢</ci><ci id="S3.SS2.SSS3.p1.2.m2.1.1.3.4.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.2.m2.1c">{I}_{out}</annotation></semantics></math>, also considering the spatial smoothness of the inpainted region of <math id="S3.SS2.SSS3.p1.3.m3.1" class="ltx_Math" alttext="\hat{I}_{out}" display="inline"><semantics id="S3.SS2.SSS3.p1.3.m3.1a"><msub id="S3.SS2.SSS3.p1.3.m3.1.1" xref="S3.SS2.SSS3.p1.3.m3.1.1.cmml"><mover accent="true" id="S3.SS2.SSS3.p1.3.m3.1.1.2" xref="S3.SS2.SSS3.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS3.p1.3.m3.1.1.2.2" xref="S3.SS2.SSS3.p1.3.m3.1.1.2.2.cmml">I</mi><mo id="S3.SS2.SSS3.p1.3.m3.1.1.2.1" xref="S3.SS2.SSS3.p1.3.m3.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.SSS3.p1.3.m3.1.1.3" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS3.p1.3.m3.1.1.3.2" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p1.3.m3.1.1.3.1" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p1.3.m3.1.1.3.3" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p1.3.m3.1.1.3.1a" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p1.3.m3.1.1.3.4" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.3.m3.1b"><apply id="S3.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1">subscript</csymbol><apply id="S3.SS2.SSS3.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.2"><ci id="S3.SS2.SSS3.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.2.1">^</ci><ci id="S3.SS2.SSS3.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.2.2">𝐼</ci></apply><apply id="S3.SS2.SSS3.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3"><times id="S3.SS2.SSS3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.1"></times><ci id="S3.SS2.SSS3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.2">𝑜</ci><ci id="S3.SS2.SSS3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.3">𝑢</ci><ci id="S3.SS2.SSS3.p1.3.m3.1.1.3.4.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.3.m3.1c">\hat{I}_{out}</annotation></semantics></math> during the training of the background inpainting module, which include pixel reconstruction loss, perceptual loss, style loss, and total variation loss. Details of the loss functions are presented below.</p>
</div>
<div id="S3.SS2.SSS3.p2" class="ltx_para">
<p id="S3.SS2.SSS3.p2.1" class="ltx_p">Pixel loss is aimed at guiding pixel-level reconstruction, where more weight is added to the inpainted region. The pixel loss can be formulated as follows:</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{pixel}=" display="inline"><semantics id="S3.E5X.2.1.1.m1.1a"><mrow id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml"><msub id="S3.E5X.2.1.1.m1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5X.2.1.1.m1.1.1.2.2" xref="S3.E5X.2.1.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E5X.2.1.1.m1.1.1.2.3" xref="S3.E5X.2.1.1.m1.1.1.2.3.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.2.3.2" xref="S3.E5X.2.1.1.m1.1.1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.1.1.2.3.1" xref="S3.E5X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E5X.2.1.1.m1.1.1.2.3.3" xref="S3.E5X.2.1.1.m1.1.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.1.1.2.3.1a" xref="S3.E5X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E5X.2.1.1.m1.1.1.2.3.4" xref="S3.E5X.2.1.1.m1.1.1.2.3.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.1.1.2.3.1b" xref="S3.E5X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E5X.2.1.1.m1.1.1.2.3.5" xref="S3.E5X.2.1.1.m1.1.1.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E5X.2.1.1.m1.1.1.2.3.1c" xref="S3.E5X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E5X.2.1.1.m1.1.1.2.3.6" xref="S3.E5X.2.1.1.m1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S3.E5X.2.1.1.m1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.cmml">=</mo><mi id="S3.E5X.2.1.1.m1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><apply id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1"><eq id="S3.E5X.2.1.1.m1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1"></eq><apply id="S3.E5X.2.1.1.m1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.2">ℒ</ci><apply id="S3.E5X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3"><times id="S3.E5X.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3.1"></times><ci id="S3.E5X.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3.2">𝑝</ci><ci id="S3.E5X.2.1.1.m1.1.1.2.3.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3.3">𝑖</ci><ci id="S3.E5X.2.1.1.m1.1.1.2.3.4.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3.4">𝑥</ci><ci id="S3.E5X.2.1.1.m1.1.1.2.3.5.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3.5">𝑒</ci><ci id="S3.E5X.2.1.1.m1.1.1.2.3.6.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3.6">𝑙</ci></apply></apply><csymbol cd="latexml" id="S3.E5X.2.1.1.m1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle\mathcal{L}_{pixel}=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\ \|\hat{I}_{mask}\odot(\hat{I}_{out}-I_{out})\|_{1}" display="inline"><semantics id="S3.E5X.3.2.2.m1.1a"><msub id="S3.E5X.3.2.2.m1.1.1" xref="S3.E5X.3.2.2.m1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml"><msub id="S3.E5X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.2.2.cmml">I</mi><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.2.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.1a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.4" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.1b" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.5" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.5.cmml">k</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">I</mi><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.1a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.4" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml">I</mi><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.1a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.4" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E5X.3.2.2.m1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.1b"><apply id="S3.E5X.3.2.2.m1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2">norm</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.2"><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.2.2">𝐼</ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3"><times id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.1"></times><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.2">𝑚</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.4.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.4">𝑠</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.5.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.3.3.5">𝑘</ci></apply></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1"><minus id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.2">𝐼</ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.2">𝑜</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3">𝑢</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2">𝐼</ci><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3"><times id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.2">𝑜</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.3">𝑢</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></apply></apply><cn type="integer" id="S3.E5X.3.2.2.m1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.1c">\displaystyle\ \|\hat{I}_{mask}\odot(\hat{I}_{out}-I_{out})\|_{1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S3.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle+6\|(1-\hat{I}_{mask})\odot(\hat{I}_{out}-I_{out})\|_{1}." display="inline"><semantics id="S3.E5Xa.2.1.1.m1.1a"><mrow id="S3.E5Xa.2.1.1.m1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml"><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1a" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml">+</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.cmml"><mn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.cmml">6</mn><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">I</mi><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1b" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.5" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.5.cmml">k</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">⊙</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.cmml">(</mo><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.cmml"><msub id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml"><mover accent="true" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.cmml">I</mi><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.1.cmml">​</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.1a" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.1.cmml">​</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.4" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">−</mo><msub id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.2.cmml">I</mi><mrow id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.1.cmml">​</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.1a" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.1.cmml">​</mo><mi id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.4" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml">1</mn></msub></mrow></mrow><mo lspace="0em" id="S3.E5Xa.2.1.1.m1.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.1b"><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1"><plus id="S3.E5Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1"></plus><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.2"></times><cn type="integer" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.3">6</cn><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">direct-product</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐼</ci></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑚</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.4">𝑠</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.5">𝑘</ci></apply></apply></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1"><minus id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.1"></minus><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2">subscript</csymbol><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.2"><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.1">^</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.2.2">𝐼</ci></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.1"></times><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.2">𝑜</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.3">𝑢</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.4.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.2">𝐼</ci><apply id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3"><times id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.1"></times><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.2">𝑜</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.3">𝑢</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.4.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.1.3.3.4">𝑡</ci></apply></apply></apply></apply></apply><cn type="integer" id="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.1c">\displaystyle+6\|(1-\hat{I}_{mask})\odot(\hat{I}_{out}-I_{out})\|_{1}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.SSS3.p3" class="ltx_para">
<p id="S3.SS2.SSS3.p3.6" class="ltx_p">Perceptual loss and style loss, which are also known as VGG loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>, are used to make the generated image more realistic.
Perceptual loss captures high-level semantics and can be considered as a simulation of human perception on images. Perceptual loss computes the differences (L1 loss) between different levels of feature representations between both <math id="S3.SS2.SSS3.p3.1.m1.1" class="ltx_Math" alttext="\hat{I}_{out}" display="inline"><semantics id="S3.SS2.SSS3.p3.1.m1.1a"><msub id="S3.SS2.SSS3.p3.1.m1.1.1" xref="S3.SS2.SSS3.p3.1.m1.1.1.cmml"><mover accent="true" id="S3.SS2.SSS3.p3.1.m1.1.1.2" xref="S3.SS2.SSS3.p3.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS3.p3.1.m1.1.1.2.2" xref="S3.SS2.SSS3.p3.1.m1.1.1.2.2.cmml">I</mi><mo id="S3.SS2.SSS3.p3.1.m1.1.1.2.1" xref="S3.SS2.SSS3.p3.1.m1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.SSS3.p3.1.m1.1.1.3" xref="S3.SS2.SSS3.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS3.p3.1.m1.1.1.3.2" xref="S3.SS2.SSS3.p3.1.m1.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.1.m1.1.1.3.1" xref="S3.SS2.SSS3.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.1.m1.1.1.3.3" xref="S3.SS2.SSS3.p3.1.m1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.1.m1.1.1.3.1a" xref="S3.SS2.SSS3.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.1.m1.1.1.3.4" xref="S3.SS2.SSS3.p3.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p3.1.m1.1b"><apply id="S3.SS2.SSS3.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1">subscript</csymbol><apply id="S3.SS2.SSS3.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1.2"><ci id="S3.SS2.SSS3.p3.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1.2.1">^</ci><ci id="S3.SS2.SSS3.p3.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1.2.2">𝐼</ci></apply><apply id="S3.SS2.SSS3.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1.3"><times id="S3.SS2.SSS3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1.3.1"></times><ci id="S3.SS2.SSS3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1.3.2">𝑜</ci><ci id="S3.SS2.SSS3.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1.3.3">𝑢</ci><ci id="S3.SS2.SSS3.p3.1.m1.1.1.3.4.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p3.1.m1.1c">\hat{I}_{out}</annotation></semantics></math> and <math id="S3.SS2.SSS3.p3.2.m2.1" class="ltx_Math" alttext="{I}_{comp}" display="inline"><semantics id="S3.SS2.SSS3.p3.2.m2.1a"><msub id="S3.SS2.SSS3.p3.2.m2.1.1" xref="S3.SS2.SSS3.p3.2.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p3.2.m2.1.1.2" xref="S3.SS2.SSS3.p3.2.m2.1.1.2.cmml">I</mi><mrow id="S3.SS2.SSS3.p3.2.m2.1.1.3" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS3.p3.2.m2.1.1.3.2" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.2.m2.1.1.3.1" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.2.m2.1.1.3.3" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.2.m2.1.1.3.1a" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.2.m2.1.1.3.4" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.2.m2.1.1.3.1b" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.2.m2.1.1.3.5" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.5.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p3.2.m2.1b"><apply id="S3.SS2.SSS3.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.2.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p3.2.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.2">𝐼</ci><apply id="S3.SS2.SSS3.p3.2.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.3"><times id="S3.SS2.SSS3.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.1"></times><ci id="S3.SS2.SSS3.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.2">𝑐</ci><ci id="S3.SS2.SSS3.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.3">𝑜</ci><ci id="S3.SS2.SSS3.p3.2.m2.1.1.3.4.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.4">𝑚</ci><ci id="S3.SS2.SSS3.p3.2.m2.1.1.3.5.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1.3.5">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p3.2.m2.1c">{I}_{comp}</annotation></semantics></math> and <math id="S3.SS2.SSS3.p3.3.m3.1" class="ltx_Math" alttext="{I}_{out}" display="inline"><semantics id="S3.SS2.SSS3.p3.3.m3.1a"><msub id="S3.SS2.SSS3.p3.3.m3.1.1" xref="S3.SS2.SSS3.p3.3.m3.1.1.cmml"><mi id="S3.SS2.SSS3.p3.3.m3.1.1.2" xref="S3.SS2.SSS3.p3.3.m3.1.1.2.cmml">I</mi><mrow id="S3.SS2.SSS3.p3.3.m3.1.1.3" xref="S3.SS2.SSS3.p3.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS3.p3.3.m3.1.1.3.2" xref="S3.SS2.SSS3.p3.3.m3.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.3.m3.1.1.3.1" xref="S3.SS2.SSS3.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.3.m3.1.1.3.3" xref="S3.SS2.SSS3.p3.3.m3.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.3.m3.1.1.3.1a" xref="S3.SS2.SSS3.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.3.m3.1.1.3.4" xref="S3.SS2.SSS3.p3.3.m3.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p3.3.m3.1b"><apply id="S3.SS2.SSS3.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.3.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p3.3.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p3.3.m3.1.1.2">𝐼</ci><apply id="S3.SS2.SSS3.p3.3.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p3.3.m3.1.1.3"><times id="S3.SS2.SSS3.p3.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS3.p3.3.m3.1.1.3.1"></times><ci id="S3.SS2.SSS3.p3.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS3.p3.3.m3.1.1.3.2">𝑜</ci><ci id="S3.SS2.SSS3.p3.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS3.p3.3.m3.1.1.3.3">𝑢</ci><ci id="S3.SS2.SSS3.p3.3.m3.1.1.3.4.cmml" xref="S3.SS2.SSS3.p3.3.m3.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p3.3.m3.1c">{I}_{out}</annotation></semantics></math>, and is extracted by the same pretrained VGG network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>. <math id="S3.SS2.SSS3.p3.4.m4.1" class="ltx_Math" alttext="{I}_{comp}" display="inline"><semantics id="S3.SS2.SSS3.p3.4.m4.1a"><msub id="S3.SS2.SSS3.p3.4.m4.1.1" xref="S3.SS2.SSS3.p3.4.m4.1.1.cmml"><mi id="S3.SS2.SSS3.p3.4.m4.1.1.2" xref="S3.SS2.SSS3.p3.4.m4.1.1.2.cmml">I</mi><mrow id="S3.SS2.SSS3.p3.4.m4.1.1.3" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS3.p3.4.m4.1.1.3.2" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.4.m4.1.1.3.1" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.4.m4.1.1.3.3" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.4.m4.1.1.3.1a" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.4.m4.1.1.3.4" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.4.m4.1.1.3.1b" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.4.m4.1.1.3.5" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.5.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p3.4.m4.1b"><apply id="S3.SS2.SSS3.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.4.m4.1.1.1.cmml" xref="S3.SS2.SSS3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p3.4.m4.1.1.2.cmml" xref="S3.SS2.SSS3.p3.4.m4.1.1.2">𝐼</ci><apply id="S3.SS2.SSS3.p3.4.m4.1.1.3.cmml" xref="S3.SS2.SSS3.p3.4.m4.1.1.3"><times id="S3.SS2.SSS3.p3.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.1"></times><ci id="S3.SS2.SSS3.p3.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.2">𝑐</ci><ci id="S3.SS2.SSS3.p3.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.3">𝑜</ci><ci id="S3.SS2.SSS3.p3.4.m4.1.1.3.4.cmml" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.4">𝑚</ci><ci id="S3.SS2.SSS3.p3.4.m4.1.1.3.5.cmml" xref="S3.SS2.SSS3.p3.4.m4.1.1.3.5">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p3.4.m4.1c">{I}_{comp}</annotation></semantics></math> is the composed image, where the hole and non-hole regions are from <math id="S3.SS2.SSS3.p3.5.m5.1" class="ltx_Math" alttext="\hat{I}_{out}" display="inline"><semantics id="S3.SS2.SSS3.p3.5.m5.1a"><msub id="S3.SS2.SSS3.p3.5.m5.1.1" xref="S3.SS2.SSS3.p3.5.m5.1.1.cmml"><mover accent="true" id="S3.SS2.SSS3.p3.5.m5.1.1.2" xref="S3.SS2.SSS3.p3.5.m5.1.1.2.cmml"><mi id="S3.SS2.SSS3.p3.5.m5.1.1.2.2" xref="S3.SS2.SSS3.p3.5.m5.1.1.2.2.cmml">I</mi><mo id="S3.SS2.SSS3.p3.5.m5.1.1.2.1" xref="S3.SS2.SSS3.p3.5.m5.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.SSS3.p3.5.m5.1.1.3" xref="S3.SS2.SSS3.p3.5.m5.1.1.3.cmml"><mi id="S3.SS2.SSS3.p3.5.m5.1.1.3.2" xref="S3.SS2.SSS3.p3.5.m5.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.5.m5.1.1.3.1" xref="S3.SS2.SSS3.p3.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.5.m5.1.1.3.3" xref="S3.SS2.SSS3.p3.5.m5.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.5.m5.1.1.3.1a" xref="S3.SS2.SSS3.p3.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.5.m5.1.1.3.4" xref="S3.SS2.SSS3.p3.5.m5.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p3.5.m5.1b"><apply id="S3.SS2.SSS3.p3.5.m5.1.1.cmml" xref="S3.SS2.SSS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.5.m5.1.1.1.cmml" xref="S3.SS2.SSS3.p3.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.SSS3.p3.5.m5.1.1.2.cmml" xref="S3.SS2.SSS3.p3.5.m5.1.1.2"><ci id="S3.SS2.SSS3.p3.5.m5.1.1.2.1.cmml" xref="S3.SS2.SSS3.p3.5.m5.1.1.2.1">^</ci><ci id="S3.SS2.SSS3.p3.5.m5.1.1.2.2.cmml" xref="S3.SS2.SSS3.p3.5.m5.1.1.2.2">𝐼</ci></apply><apply id="S3.SS2.SSS3.p3.5.m5.1.1.3.cmml" xref="S3.SS2.SSS3.p3.5.m5.1.1.3"><times id="S3.SS2.SSS3.p3.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS3.p3.5.m5.1.1.3.1"></times><ci id="S3.SS2.SSS3.p3.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS3.p3.5.m5.1.1.3.2">𝑜</ci><ci id="S3.SS2.SSS3.p3.5.m5.1.1.3.3.cmml" xref="S3.SS2.SSS3.p3.5.m5.1.1.3.3">𝑢</ci><ci id="S3.SS2.SSS3.p3.5.m5.1.1.3.4.cmml" xref="S3.SS2.SSS3.p3.5.m5.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p3.5.m5.1c">\hat{I}_{out}</annotation></semantics></math> and <math id="S3.SS2.SSS3.p3.6.m6.1" class="ltx_Math" alttext="{I}_{out}" display="inline"><semantics id="S3.SS2.SSS3.p3.6.m6.1a"><msub id="S3.SS2.SSS3.p3.6.m6.1.1" xref="S3.SS2.SSS3.p3.6.m6.1.1.cmml"><mi id="S3.SS2.SSS3.p3.6.m6.1.1.2" xref="S3.SS2.SSS3.p3.6.m6.1.1.2.cmml">I</mi><mrow id="S3.SS2.SSS3.p3.6.m6.1.1.3" xref="S3.SS2.SSS3.p3.6.m6.1.1.3.cmml"><mi id="S3.SS2.SSS3.p3.6.m6.1.1.3.2" xref="S3.SS2.SSS3.p3.6.m6.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.6.m6.1.1.3.1" xref="S3.SS2.SSS3.p3.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.6.m6.1.1.3.3" xref="S3.SS2.SSS3.p3.6.m6.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p3.6.m6.1.1.3.1a" xref="S3.SS2.SSS3.p3.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p3.6.m6.1.1.3.4" xref="S3.SS2.SSS3.p3.6.m6.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p3.6.m6.1b"><apply id="S3.SS2.SSS3.p3.6.m6.1.1.cmml" xref="S3.SS2.SSS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.6.m6.1.1.1.cmml" xref="S3.SS2.SSS3.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p3.6.m6.1.1.2.cmml" xref="S3.SS2.SSS3.p3.6.m6.1.1.2">𝐼</ci><apply id="S3.SS2.SSS3.p3.6.m6.1.1.3.cmml" xref="S3.SS2.SSS3.p3.6.m6.1.1.3"><times id="S3.SS2.SSS3.p3.6.m6.1.1.3.1.cmml" xref="S3.SS2.SSS3.p3.6.m6.1.1.3.1"></times><ci id="S3.SS2.SSS3.p3.6.m6.1.1.3.2.cmml" xref="S3.SS2.SSS3.p3.6.m6.1.1.3.2">𝑜</ci><ci id="S3.SS2.SSS3.p3.6.m6.1.1.3.3.cmml" xref="S3.SS2.SSS3.p3.6.m6.1.1.3.3">𝑢</ci><ci id="S3.SS2.SSS3.p3.6.m6.1.1.3.4.cmml" xref="S3.SS2.SSS3.p3.6.m6.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p3.6.m6.1c">{I}_{out}</annotation></semantics></math>, respectively. Perceptual loss can be defined by Eq. <a href="#S3.E7" title="In III-B3 Training Loss ‣ III-B Background Inpainting Module ‣ III Methodology ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>:</p>
</div>
<div id="S3.SS2.SSS3.p4" class="ltx_para">
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.1" class="ltx_Math" alttext="I_{comp}=\hat{I}_{mask}\odot I_{out}+(1-\hat{I}_{mask})\odot\hat{I}_{out}." display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml">I</mi><mrow id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.3.3.1" xref="S3.E6.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.3.3.1a" xref="S3.E6.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.3.3.4" xref="S3.E6.m1.1.1.1.1.3.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.3.3.1b" xref="S3.E6.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.3.3.5" xref="S3.E6.m1.1.1.1.1.3.3.5.cmml">p</mi></mrow></msub><mo id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml"><msub id="S3.E6.m1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.cmml"><mover accent="true" id="S3.E6.m1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.2.2.2" xref="S3.E6.m1.1.1.1.1.1.3.2.2.2.cmml">I</mi><mo id="S3.E6.m1.1.1.1.1.1.3.2.2.1" xref="S3.E6.m1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mrow id="S3.E6.m1.1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.2.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.3.2.3.1" xref="S3.E6.m1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.3.2.3.3" xref="S3.E6.m1.1.1.1.1.1.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.3.2.3.1a" xref="S3.E6.m1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.3.2.3.4" xref="S3.E6.m1.1.1.1.1.1.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.3.2.3.1b" xref="S3.E6.m1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.3.2.3.5" xref="S3.E6.m1.1.1.1.1.1.3.2.3.5.cmml">k</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.1.3.1.cmml">⊙</mo><msub id="S3.E6.m1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.1.1.3.3.2.cmml">I</mi><mrow id="S3.E6.m1.1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.3.3.2" xref="S3.E6.m1.1.1.1.1.1.3.3.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.3.3.3.1" xref="S3.E6.m1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.3.3.3.3" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.3.3.3.1a" xref="S3.E6.m1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.3.3.3.4" xref="S3.E6.m1.1.1.1.1.1.3.3.3.4.cmml">t</mi></mrow></msub></mrow><mo id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">I</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.1b" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.5" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.5.cmml">k</mi></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml">⊙</mo><msub id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E6.m1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.1.1.3.2.2.cmml">I</mi><mo id="S3.E6.m1.1.1.1.1.1.1.3.2.1" xref="S3.E6.m1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.E6.m1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.1.1.1.3.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.3.3.1" xref="S3.E6.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.1.1.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.1.3.3.1a" xref="S3.E6.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.1.3.3.4" xref="S3.E6.m1.1.1.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow></mrow></mrow><mo lspace="0em" id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></eq><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2">𝐼</ci><apply id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3"><times id="S3.E6.m1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.3.1"></times><ci id="S3.E6.m1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.3.2">𝑐</ci><ci id="S3.E6.m1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3.3">𝑜</ci><ci id="S3.E6.m1.1.1.1.1.3.3.4.cmml" xref="S3.E6.m1.1.1.1.1.3.3.4">𝑚</ci><ci id="S3.E6.m1.1.1.1.1.3.3.5.cmml" xref="S3.E6.m1.1.1.1.1.3.3.5">𝑝</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><plus id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"></plus><apply id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.1">direct-product</csymbol><apply id="S3.E6.m1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2"><ci id="S3.E6.m1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.1">^</ci><ci id="S3.E6.m1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.2.2">𝐼</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.3"><times id="S3.E6.m1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.3.2">𝑚</ci><ci id="S3.E6.m1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.3.3">𝑎</ci><ci id="S3.E6.m1.1.1.1.1.1.3.2.3.4.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.3.4">𝑠</ci><ci id="S3.E6.m1.1.1.1.1.1.3.2.3.5.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2.3.5">𝑘</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.2">𝐼</ci><apply id="S3.E6.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3"><times id="S3.E6.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3.2">𝑜</ci><ci id="S3.E6.m1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3">𝑢</ci><ci id="S3.E6.m1.1.1.1.1.1.3.3.3.4.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3.4">𝑡</ci></apply></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"><minus id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝐼</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑚</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑎</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.4">𝑠</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.5">𝑘</ci></apply></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2"><ci id="S3.E6.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E6.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2.2">𝐼</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.3"><times id="S3.E6.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.3.2">𝑜</ci><ci id="S3.E6.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.3.3">𝑢</ci><ci id="S3.E6.m1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">I_{comp}=\hat{I}_{mask}\odot I_{out}+(1-\hat{I}_{mask})\odot\hat{I}_{out}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.SSS3.p5" class="ltx_para">
<table id="S3.E7" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E7X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{per}=" display="inline"><semantics id="S3.E7X.2.1.1.m1.1a"><mrow id="S3.E7X.2.1.1.m1.1.1" xref="S3.E7X.2.1.1.m1.1.1.cmml"><msub id="S3.E7X.2.1.1.m1.1.1.2" xref="S3.E7X.2.1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7X.2.1.1.m1.1.1.2.2" xref="S3.E7X.2.1.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E7X.2.1.1.m1.1.1.2.3" xref="S3.E7X.2.1.1.m1.1.1.2.3.cmml"><mi id="S3.E7X.2.1.1.m1.1.1.2.3.2" xref="S3.E7X.2.1.1.m1.1.1.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E7X.2.1.1.m1.1.1.2.3.1" xref="S3.E7X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E7X.2.1.1.m1.1.1.2.3.3" xref="S3.E7X.2.1.1.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E7X.2.1.1.m1.1.1.2.3.1a" xref="S3.E7X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E7X.2.1.1.m1.1.1.2.3.4" xref="S3.E7X.2.1.1.m1.1.1.2.3.4.cmml">r</mi></mrow></msub><mo id="S3.E7X.2.1.1.m1.1.1.1" xref="S3.E7X.2.1.1.m1.1.1.1.cmml">=</mo><mi id="S3.E7X.2.1.1.m1.1.1.3" xref="S3.E7X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E7X.2.1.1.m1.1b"><apply id="S3.E7X.2.1.1.m1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1"><eq id="S3.E7X.2.1.1.m1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.1"></eq><apply id="S3.E7X.2.1.1.m1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.2.2">ℒ</ci><apply id="S3.E7X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.2.3"><times id="S3.E7X.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.2.3.1"></times><ci id="S3.E7X.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.2.3.2">𝑝</ci><ci id="S3.E7X.2.1.1.m1.1.1.2.3.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.2.3.3">𝑒</ci><ci id="S3.E7X.2.1.1.m1.1.1.2.3.4.cmml" xref="S3.E7X.2.1.1.m1.1.1.2.3.4">𝑟</ci></apply></apply><csymbol cd="latexml" id="S3.E7X.2.1.1.m1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.2.1.1.m1.1c">\displaystyle\mathcal{L}_{per}=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7X.3.2.2.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\ \mathbb{E}[\sum\limits_{i=1}{\|\phi_{i}(\hat{I}_{out})-\phi_{i}(I_{out})\|_{1}}" display="inline"><semantics id="S3.E7X.3.2.2.m1.1a"><mrow id="S3.E7X.3.2.2.m1.1b"><mi id="S3.E7X.3.2.2.m1.1.1">𝔼</mi><mrow id="S3.E7X.3.2.2.m1.1.2"><mo stretchy="false" id="S3.E7X.3.2.2.m1.1.2.1">[</mo><mstyle displaystyle="true" id="S3.E7X.3.2.2.m1.1.2.2"><munder id="S3.E7X.3.2.2.m1.1.2.2a"><mo movablelimits="false" id="S3.E7X.3.2.2.m1.1.2.2.2">∑</mo><mrow id="S3.E7X.3.2.2.m1.1.2.2.3"><mi id="S3.E7X.3.2.2.m1.1.2.2.3.2">i</mi><mo id="S3.E7X.3.2.2.m1.1.2.2.3.1">=</mo><mn id="S3.E7X.3.2.2.m1.1.2.2.3.3">1</mn></mrow></munder></mstyle><mo lspace="0em" rspace="0.167em" id="S3.E7X.3.2.2.m1.1.2.3">∥</mo><msub id="S3.E7X.3.2.2.m1.1.2.4"><mi id="S3.E7X.3.2.2.m1.1.2.4.2">ϕ</mi><mi id="S3.E7X.3.2.2.m1.1.2.4.3">i</mi></msub><mrow id="S3.E7X.3.2.2.m1.1.2.5"><mo stretchy="false" id="S3.E7X.3.2.2.m1.1.2.5.1">(</mo><msub id="S3.E7X.3.2.2.m1.1.2.5.2"><mover accent="true" id="S3.E7X.3.2.2.m1.1.2.5.2.2"><mi id="S3.E7X.3.2.2.m1.1.2.5.2.2.2">I</mi><mo id="S3.E7X.3.2.2.m1.1.2.5.2.2.1">^</mo></mover><mrow id="S3.E7X.3.2.2.m1.1.2.5.2.3"><mi id="S3.E7X.3.2.2.m1.1.2.5.2.3.2">o</mi><mo lspace="0em" rspace="0em" id="S3.E7X.3.2.2.m1.1.2.5.2.3.1">​</mo><mi id="S3.E7X.3.2.2.m1.1.2.5.2.3.3">u</mi><mo lspace="0em" rspace="0em" id="S3.E7X.3.2.2.m1.1.2.5.2.3.1a">​</mo><mi id="S3.E7X.3.2.2.m1.1.2.5.2.3.4">t</mi></mrow></msub><mo stretchy="false" id="S3.E7X.3.2.2.m1.1.2.5.3">)</mo></mrow><mo id="S3.E7X.3.2.2.m1.1.2.6">−</mo><msub id="S3.E7X.3.2.2.m1.1.2.7"><mi id="S3.E7X.3.2.2.m1.1.2.7.2">ϕ</mi><mi id="S3.E7X.3.2.2.m1.1.2.7.3">i</mi></msub><mrow id="S3.E7X.3.2.2.m1.1.2.8"><mo stretchy="false" id="S3.E7X.3.2.2.m1.1.2.8.1">(</mo><msub id="S3.E7X.3.2.2.m1.1.2.8.2"><mi id="S3.E7X.3.2.2.m1.1.2.8.2.2">I</mi><mrow id="S3.E7X.3.2.2.m1.1.2.8.2.3"><mi id="S3.E7X.3.2.2.m1.1.2.8.2.3.2">o</mi><mo lspace="0em" rspace="0em" id="S3.E7X.3.2.2.m1.1.2.8.2.3.1">​</mo><mi id="S3.E7X.3.2.2.m1.1.2.8.2.3.3">u</mi><mo lspace="0em" rspace="0em" id="S3.E7X.3.2.2.m1.1.2.8.2.3.1a">​</mo><mi id="S3.E7X.3.2.2.m1.1.2.8.2.3.4">t</mi></mrow></msub><mo stretchy="false" id="S3.E7X.3.2.2.m1.1.2.8.3">)</mo></mrow><msub id="S3.E7X.3.2.2.m1.1.2.9"><mo lspace="0em" id="S3.E7X.3.2.2.m1.1.2.9.2">∥</mo><mn id="S3.E7X.3.2.2.m1.1.2.9.3">1</mn></msub></mrow></mrow><annotation encoding="application/x-tex" id="S3.E7X.3.2.2.m1.1c">\displaystyle\ \mathbb{E}[\sum\limits_{i=1}{\|\phi_{i}(\hat{I}_{out})-\phi_{i}(I_{out})\|_{1}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr id="S3.E7Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xa.2.1.1.m1.1" class="ltx_math_unparsed" alttext="\displaystyle+\sum\limits_{i=1}{\|\phi_{i}({I_{comp}})-\phi_{i}(I_{out})\|_{1}}]," display="inline"><semantics id="S3.E7Xa.2.1.1.m1.1a"><mrow id="S3.E7Xa.2.1.1.m1.1b"><mo id="S3.E7Xa.2.1.1.m1.1.1">+</mo><mstyle displaystyle="true" id="S3.E7Xa.2.1.1.m1.1.2"><munder id="S3.E7Xa.2.1.1.m1.1.2a"><mo movablelimits="false" id="S3.E7Xa.2.1.1.m1.1.2.2">∑</mo><mrow id="S3.E7Xa.2.1.1.m1.1.2.3"><mi id="S3.E7Xa.2.1.1.m1.1.2.3.2">i</mi><mo id="S3.E7Xa.2.1.1.m1.1.2.3.1">=</mo><mn id="S3.E7Xa.2.1.1.m1.1.2.3.3">1</mn></mrow></munder></mstyle><mo lspace="0em" rspace="0.167em" id="S3.E7Xa.2.1.1.m1.1.3">∥</mo><msub id="S3.E7Xa.2.1.1.m1.1.4"><mi id="S3.E7Xa.2.1.1.m1.1.4.2">ϕ</mi><mi id="S3.E7Xa.2.1.1.m1.1.4.3">i</mi></msub><mrow id="S3.E7Xa.2.1.1.m1.1.5"><mo stretchy="false" id="S3.E7Xa.2.1.1.m1.1.5.1">(</mo><msub id="S3.E7Xa.2.1.1.m1.1.5.2"><mi id="S3.E7Xa.2.1.1.m1.1.5.2.2">I</mi><mrow id="S3.E7Xa.2.1.1.m1.1.5.2.3"><mi id="S3.E7Xa.2.1.1.m1.1.5.2.3.2">c</mi><mo lspace="0em" rspace="0em" id="S3.E7Xa.2.1.1.m1.1.5.2.3.1">​</mo><mi id="S3.E7Xa.2.1.1.m1.1.5.2.3.3">o</mi><mo lspace="0em" rspace="0em" id="S3.E7Xa.2.1.1.m1.1.5.2.3.1a">​</mo><mi id="S3.E7Xa.2.1.1.m1.1.5.2.3.4">m</mi><mo lspace="0em" rspace="0em" id="S3.E7Xa.2.1.1.m1.1.5.2.3.1b">​</mo><mi id="S3.E7Xa.2.1.1.m1.1.5.2.3.5">p</mi></mrow></msub><mo stretchy="false" id="S3.E7Xa.2.1.1.m1.1.5.3">)</mo></mrow><mo id="S3.E7Xa.2.1.1.m1.1.6">−</mo><msub id="S3.E7Xa.2.1.1.m1.1.7"><mi id="S3.E7Xa.2.1.1.m1.1.7.2">ϕ</mi><mi id="S3.E7Xa.2.1.1.m1.1.7.3">i</mi></msub><mrow id="S3.E7Xa.2.1.1.m1.1.8"><mo stretchy="false" id="S3.E7Xa.2.1.1.m1.1.8.1">(</mo><msub id="S3.E7Xa.2.1.1.m1.1.8.2"><mi id="S3.E7Xa.2.1.1.m1.1.8.2.2">I</mi><mrow id="S3.E7Xa.2.1.1.m1.1.8.2.3"><mi id="S3.E7Xa.2.1.1.m1.1.8.2.3.2">o</mi><mo lspace="0em" rspace="0em" id="S3.E7Xa.2.1.1.m1.1.8.2.3.1">​</mo><mi id="S3.E7Xa.2.1.1.m1.1.8.2.3.3">u</mi><mo lspace="0em" rspace="0em" id="S3.E7Xa.2.1.1.m1.1.8.2.3.1a">​</mo><mi id="S3.E7Xa.2.1.1.m1.1.8.2.3.4">t</mi></mrow></msub><mo stretchy="false" id="S3.E7Xa.2.1.1.m1.1.8.3">)</mo></mrow><msub id="S3.E7Xa.2.1.1.m1.1.9"><mo lspace="0em" rspace="0.167em" id="S3.E7Xa.2.1.1.m1.1.9.2">∥</mo><mn id="S3.E7Xa.2.1.1.m1.1.9.3">1</mn></msub><mo stretchy="false" id="S3.E7Xa.2.1.1.m1.1.10">]</mo><mo id="S3.E7Xa.2.1.1.m1.1.11">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E7Xa.2.1.1.m1.1c">\displaystyle+\sum\limits_{i=1}{\|\phi_{i}({I_{comp}})-\phi_{i}(I_{out})\|_{1}}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.SSS3.p5.6" class="ltx_p">where <math id="S3.SS2.SSS3.p5.1.m1.1" class="ltx_Math" alttext="\phi_{i}" display="inline"><semantics id="S3.SS2.SSS3.p5.1.m1.1a"><msub id="S3.SS2.SSS3.p5.1.m1.1.1" xref="S3.SS2.SSS3.p5.1.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p5.1.m1.1.1.2" xref="S3.SS2.SSS3.p5.1.m1.1.1.2.cmml">ϕ</mi><mi id="S3.SS2.SSS3.p5.1.m1.1.1.3" xref="S3.SS2.SSS3.p5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p5.1.m1.1b"><apply id="S3.SS2.SSS3.p5.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p5.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p5.1.m1.1.1.2">italic-ϕ</ci><ci id="S3.SS2.SSS3.p5.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p5.1.m1.1c">\phi_{i}</annotation></semantics></math> is the activation map from relu1<math id="S3.SS2.SSS3.p5.2.m2.1" class="ltx_Math" alttext="\_" display="inline"><semantics id="S3.SS2.SSS3.p5.2.m2.1a"><mi mathvariant="normal" id="S3.SS2.SSS3.p5.2.m2.1.1" xref="S3.SS2.SSS3.p5.2.m2.1.1.cmml">_</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p5.2.m2.1b"><ci id="S3.SS2.SSS3.p5.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p5.2.m2.1.1">_</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p5.2.m2.1c">\_</annotation></semantics></math>1 to the relu5<math id="S3.SS2.SSS3.p5.3.m3.1" class="ltx_Math" alttext="\_" display="inline"><semantics id="S3.SS2.SSS3.p5.3.m3.1a"><mi mathvariant="normal" id="S3.SS2.SSS3.p5.3.m3.1.1" xref="S3.SS2.SSS3.p5.3.m3.1.1.cmml">_</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p5.3.m3.1b"><ci id="S3.SS2.SSS3.p5.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p5.3.m3.1.1">_</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p5.3.m3.1c">\_</annotation></semantics></math>1 layer of an ImageNet-pretrained VGG-19 model.
Style loss penalizes the differences between both <math id="S3.SS2.SSS3.p5.4.m4.1" class="ltx_Math" alttext="\hat{I}_{out}" display="inline"><semantics id="S3.SS2.SSS3.p5.4.m4.1a"><msub id="S3.SS2.SSS3.p5.4.m4.1.1" xref="S3.SS2.SSS3.p5.4.m4.1.1.cmml"><mover accent="true" id="S3.SS2.SSS3.p5.4.m4.1.1.2" xref="S3.SS2.SSS3.p5.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS3.p5.4.m4.1.1.2.2" xref="S3.SS2.SSS3.p5.4.m4.1.1.2.2.cmml">I</mi><mo id="S3.SS2.SSS3.p5.4.m4.1.1.2.1" xref="S3.SS2.SSS3.p5.4.m4.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.SSS3.p5.4.m4.1.1.3" xref="S3.SS2.SSS3.p5.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS3.p5.4.m4.1.1.3.2" xref="S3.SS2.SSS3.p5.4.m4.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p5.4.m4.1.1.3.1" xref="S3.SS2.SSS3.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p5.4.m4.1.1.3.3" xref="S3.SS2.SSS3.p5.4.m4.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p5.4.m4.1.1.3.1a" xref="S3.SS2.SSS3.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p5.4.m4.1.1.3.4" xref="S3.SS2.SSS3.p5.4.m4.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p5.4.m4.1b"><apply id="S3.SS2.SSS3.p5.4.m4.1.1.cmml" xref="S3.SS2.SSS3.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.4.m4.1.1.1.cmml" xref="S3.SS2.SSS3.p5.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.SSS3.p5.4.m4.1.1.2.cmml" xref="S3.SS2.SSS3.p5.4.m4.1.1.2"><ci id="S3.SS2.SSS3.p5.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS3.p5.4.m4.1.1.2.1">^</ci><ci id="S3.SS2.SSS3.p5.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS3.p5.4.m4.1.1.2.2">𝐼</ci></apply><apply id="S3.SS2.SSS3.p5.4.m4.1.1.3.cmml" xref="S3.SS2.SSS3.p5.4.m4.1.1.3"><times id="S3.SS2.SSS3.p5.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS3.p5.4.m4.1.1.3.1"></times><ci id="S3.SS2.SSS3.p5.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS3.p5.4.m4.1.1.3.2">𝑜</ci><ci id="S3.SS2.SSS3.p5.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS3.p5.4.m4.1.1.3.3">𝑢</ci><ci id="S3.SS2.SSS3.p5.4.m4.1.1.3.4.cmml" xref="S3.SS2.SSS3.p5.4.m4.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p5.4.m4.1c">\hat{I}_{out}</annotation></semantics></math> and <math id="S3.SS2.SSS3.p5.5.m5.1" class="ltx_Math" alttext="{I}_{comp}" display="inline"><semantics id="S3.SS2.SSS3.p5.5.m5.1a"><msub id="S3.SS2.SSS3.p5.5.m5.1.1" xref="S3.SS2.SSS3.p5.5.m5.1.1.cmml"><mi id="S3.SS2.SSS3.p5.5.m5.1.1.2" xref="S3.SS2.SSS3.p5.5.m5.1.1.2.cmml">I</mi><mrow id="S3.SS2.SSS3.p5.5.m5.1.1.3" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.cmml"><mi id="S3.SS2.SSS3.p5.5.m5.1.1.3.2" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p5.5.m5.1.1.3.1" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p5.5.m5.1.1.3.3" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p5.5.m5.1.1.3.1a" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p5.5.m5.1.1.3.4" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p5.5.m5.1.1.3.1b" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p5.5.m5.1.1.3.5" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.5.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p5.5.m5.1b"><apply id="S3.SS2.SSS3.p5.5.m5.1.1.cmml" xref="S3.SS2.SSS3.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.5.m5.1.1.1.cmml" xref="S3.SS2.SSS3.p5.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p5.5.m5.1.1.2.cmml" xref="S3.SS2.SSS3.p5.5.m5.1.1.2">𝐼</ci><apply id="S3.SS2.SSS3.p5.5.m5.1.1.3.cmml" xref="S3.SS2.SSS3.p5.5.m5.1.1.3"><times id="S3.SS2.SSS3.p5.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.1"></times><ci id="S3.SS2.SSS3.p5.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.2">𝑐</ci><ci id="S3.SS2.SSS3.p5.5.m5.1.1.3.3.cmml" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.3">𝑜</ci><ci id="S3.SS2.SSS3.p5.5.m5.1.1.3.4.cmml" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.4">𝑚</ci><ci id="S3.SS2.SSS3.p5.5.m5.1.1.3.5.cmml" xref="S3.SS2.SSS3.p5.5.m5.1.1.3.5">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p5.5.m5.1c">{I}_{comp}</annotation></semantics></math> and <math id="S3.SS2.SSS3.p5.6.m6.1" class="ltx_Math" alttext="{I}_{out}" display="inline"><semantics id="S3.SS2.SSS3.p5.6.m6.1a"><msub id="S3.SS2.SSS3.p5.6.m6.1.1" xref="S3.SS2.SSS3.p5.6.m6.1.1.cmml"><mi id="S3.SS2.SSS3.p5.6.m6.1.1.2" xref="S3.SS2.SSS3.p5.6.m6.1.1.2.cmml">I</mi><mrow id="S3.SS2.SSS3.p5.6.m6.1.1.3" xref="S3.SS2.SSS3.p5.6.m6.1.1.3.cmml"><mi id="S3.SS2.SSS3.p5.6.m6.1.1.3.2" xref="S3.SS2.SSS3.p5.6.m6.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p5.6.m6.1.1.3.1" xref="S3.SS2.SSS3.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p5.6.m6.1.1.3.3" xref="S3.SS2.SSS3.p5.6.m6.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p5.6.m6.1.1.3.1a" xref="S3.SS2.SSS3.p5.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p5.6.m6.1.1.3.4" xref="S3.SS2.SSS3.p5.6.m6.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p5.6.m6.1b"><apply id="S3.SS2.SSS3.p5.6.m6.1.1.cmml" xref="S3.SS2.SSS3.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.6.m6.1.1.1.cmml" xref="S3.SS2.SSS3.p5.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p5.6.m6.1.1.2.cmml" xref="S3.SS2.SSS3.p5.6.m6.1.1.2">𝐼</ci><apply id="S3.SS2.SSS3.p5.6.m6.1.1.3.cmml" xref="S3.SS2.SSS3.p5.6.m6.1.1.3"><times id="S3.SS2.SSS3.p5.6.m6.1.1.3.1.cmml" xref="S3.SS2.SSS3.p5.6.m6.1.1.3.1"></times><ci id="S3.SS2.SSS3.p5.6.m6.1.1.3.2.cmml" xref="S3.SS2.SSS3.p5.6.m6.1.1.3.2">𝑜</ci><ci id="S3.SS2.SSS3.p5.6.m6.1.1.3.3.cmml" xref="S3.SS2.SSS3.p5.6.m6.1.1.3.3">𝑢</ci><ci id="S3.SS2.SSS3.p5.6.m6.1.1.3.4.cmml" xref="S3.SS2.SSS3.p5.6.m6.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p5.6.m6.1c">{I}_{out}</annotation></semantics></math> in the image style, such as color, texture, and pattern. The style loss is defined as follows:</p>
<table id="S3.E8" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E8X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{style}=" display="inline"><semantics id="S3.E8X.2.1.1.m1.1a"><mrow id="S3.E8X.2.1.1.m1.1.1" xref="S3.E8X.2.1.1.m1.1.1.cmml"><msub id="S3.E8X.2.1.1.m1.1.1.2" xref="S3.E8X.2.1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8X.2.1.1.m1.1.1.2.2" xref="S3.E8X.2.1.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E8X.2.1.1.m1.1.1.2.3" xref="S3.E8X.2.1.1.m1.1.1.2.3.cmml"><mi id="S3.E8X.2.1.1.m1.1.1.2.3.2" xref="S3.E8X.2.1.1.m1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E8X.2.1.1.m1.1.1.2.3.1" xref="S3.E8X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8X.2.1.1.m1.1.1.2.3.3" xref="S3.E8X.2.1.1.m1.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E8X.2.1.1.m1.1.1.2.3.1a" xref="S3.E8X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8X.2.1.1.m1.1.1.2.3.4" xref="S3.E8X.2.1.1.m1.1.1.2.3.4.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.E8X.2.1.1.m1.1.1.2.3.1b" xref="S3.E8X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8X.2.1.1.m1.1.1.2.3.5" xref="S3.E8X.2.1.1.m1.1.1.2.3.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E8X.2.1.1.m1.1.1.2.3.1c" xref="S3.E8X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8X.2.1.1.m1.1.1.2.3.6" xref="S3.E8X.2.1.1.m1.1.1.2.3.6.cmml">e</mi></mrow></msub><mo id="S3.E8X.2.1.1.m1.1.1.1" xref="S3.E8X.2.1.1.m1.1.1.1.cmml">=</mo><mi id="S3.E8X.2.1.1.m1.1.1.3" xref="S3.E8X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E8X.2.1.1.m1.1b"><apply id="S3.E8X.2.1.1.m1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1"><eq id="S3.E8X.2.1.1.m1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.1"></eq><apply id="S3.E8X.2.1.1.m1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.2.2">ℒ</ci><apply id="S3.E8X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.2.3"><times id="S3.E8X.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E8X.2.1.1.m1.1.1.2.3.1"></times><ci id="S3.E8X.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E8X.2.1.1.m1.1.1.2.3.2">𝑠</ci><ci id="S3.E8X.2.1.1.m1.1.1.2.3.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.2.3.3">𝑡</ci><ci id="S3.E8X.2.1.1.m1.1.1.2.3.4.cmml" xref="S3.E8X.2.1.1.m1.1.1.2.3.4">𝑦</ci><ci id="S3.E8X.2.1.1.m1.1.1.2.3.5.cmml" xref="S3.E8X.2.1.1.m1.1.1.2.3.5">𝑙</ci><ci id="S3.E8X.2.1.1.m1.1.1.2.3.6.cmml" xref="S3.E8X.2.1.1.m1.1.1.2.3.6">𝑒</ci></apply></apply><csymbol cd="latexml" id="S3.E8X.2.1.1.m1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8X.2.1.1.m1.1c">\displaystyle\mathcal{L}_{style}=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8X.3.2.2.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\ \mathbb{E}_{i}[\|G_{i}^{\phi}(\hat{I}_{out})-G_{i}^{\phi}(I_{out})\|_{1}" display="inline"><semantics id="S3.E8X.3.2.2.m1.1a"><mrow id="S3.E8X.3.2.2.m1.1b"><msub id="S3.E8X.3.2.2.m1.1.1"><mi id="S3.E8X.3.2.2.m1.1.1.2">𝔼</mi><mi id="S3.E8X.3.2.2.m1.1.1.3">i</mi></msub><mrow id="S3.E8X.3.2.2.m1.1.2"><mo stretchy="false" id="S3.E8X.3.2.2.m1.1.2.1">[</mo><mo lspace="0em" rspace="0.167em" id="S3.E8X.3.2.2.m1.1.2.2">∥</mo><msubsup id="S3.E8X.3.2.2.m1.1.2.3"><mi id="S3.E8X.3.2.2.m1.1.2.3.2.2">G</mi><mi id="S3.E8X.3.2.2.m1.1.2.3.2.3">i</mi><mi id="S3.E8X.3.2.2.m1.1.2.3.3">ϕ</mi></msubsup><mrow id="S3.E8X.3.2.2.m1.1.2.4"><mo stretchy="false" id="S3.E8X.3.2.2.m1.1.2.4.1">(</mo><msub id="S3.E8X.3.2.2.m1.1.2.4.2"><mover accent="true" id="S3.E8X.3.2.2.m1.1.2.4.2.2"><mi id="S3.E8X.3.2.2.m1.1.2.4.2.2.2">I</mi><mo id="S3.E8X.3.2.2.m1.1.2.4.2.2.1">^</mo></mover><mrow id="S3.E8X.3.2.2.m1.1.2.4.2.3"><mi id="S3.E8X.3.2.2.m1.1.2.4.2.3.2">o</mi><mo lspace="0em" rspace="0em" id="S3.E8X.3.2.2.m1.1.2.4.2.3.1">​</mo><mi id="S3.E8X.3.2.2.m1.1.2.4.2.3.3">u</mi><mo lspace="0em" rspace="0em" id="S3.E8X.3.2.2.m1.1.2.4.2.3.1a">​</mo><mi id="S3.E8X.3.2.2.m1.1.2.4.2.3.4">t</mi></mrow></msub><mo stretchy="false" id="S3.E8X.3.2.2.m1.1.2.4.3">)</mo></mrow><mo id="S3.E8X.3.2.2.m1.1.2.5">−</mo><msubsup id="S3.E8X.3.2.2.m1.1.2.6"><mi id="S3.E8X.3.2.2.m1.1.2.6.2.2">G</mi><mi id="S3.E8X.3.2.2.m1.1.2.6.2.3">i</mi><mi id="S3.E8X.3.2.2.m1.1.2.6.3">ϕ</mi></msubsup><mrow id="S3.E8X.3.2.2.m1.1.2.7"><mo stretchy="false" id="S3.E8X.3.2.2.m1.1.2.7.1">(</mo><msub id="S3.E8X.3.2.2.m1.1.2.7.2"><mi id="S3.E8X.3.2.2.m1.1.2.7.2.2">I</mi><mrow id="S3.E8X.3.2.2.m1.1.2.7.2.3"><mi id="S3.E8X.3.2.2.m1.1.2.7.2.3.2">o</mi><mo lspace="0em" rspace="0em" id="S3.E8X.3.2.2.m1.1.2.7.2.3.1">​</mo><mi id="S3.E8X.3.2.2.m1.1.2.7.2.3.3">u</mi><mo lspace="0em" rspace="0em" id="S3.E8X.3.2.2.m1.1.2.7.2.3.1a">​</mo><mi id="S3.E8X.3.2.2.m1.1.2.7.2.3.4">t</mi></mrow></msub><mo stretchy="false" id="S3.E8X.3.2.2.m1.1.2.7.3">)</mo></mrow><msub id="S3.E8X.3.2.2.m1.1.2.8"><mo lspace="0em" id="S3.E8X.3.2.2.m1.1.2.8.2">∥</mo><mn id="S3.E8X.3.2.2.m1.1.2.8.3">1</mn></msub></mrow></mrow><annotation encoding="application/x-tex" id="S3.E8X.3.2.2.m1.1c">\displaystyle\ \mathbb{E}_{i}[\|G_{i}^{\phi}(\hat{I}_{out})-G_{i}^{\phi}(I_{out})\|_{1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
<tr id="S3.E8Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E8Xa.2.1.1.m1.1" class="ltx_math_unparsed" alttext="\displaystyle+\|G_{i}^{\phi}(I_{comp})-G_{i}^{\phi}(I_{out})\|_{1}]," display="inline"><semantics id="S3.E8Xa.2.1.1.m1.1a"><mrow id="S3.E8Xa.2.1.1.m1.1b"><mo rspace="0em" id="S3.E8Xa.2.1.1.m1.1.1">+</mo><mo lspace="0em" rspace="0.167em" id="S3.E8Xa.2.1.1.m1.1.2">∥</mo><msubsup id="S3.E8Xa.2.1.1.m1.1.3"><mi id="S3.E8Xa.2.1.1.m1.1.3.2.2">G</mi><mi id="S3.E8Xa.2.1.1.m1.1.3.2.3">i</mi><mi id="S3.E8Xa.2.1.1.m1.1.3.3">ϕ</mi></msubsup><mrow id="S3.E8Xa.2.1.1.m1.1.4"><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.1.4.1">(</mo><msub id="S3.E8Xa.2.1.1.m1.1.4.2"><mi id="S3.E8Xa.2.1.1.m1.1.4.2.2">I</mi><mrow id="S3.E8Xa.2.1.1.m1.1.4.2.3"><mi id="S3.E8Xa.2.1.1.m1.1.4.2.3.2">c</mi><mo lspace="0em" rspace="0em" id="S3.E8Xa.2.1.1.m1.1.4.2.3.1">​</mo><mi id="S3.E8Xa.2.1.1.m1.1.4.2.3.3">o</mi><mo lspace="0em" rspace="0em" id="S3.E8Xa.2.1.1.m1.1.4.2.3.1a">​</mo><mi id="S3.E8Xa.2.1.1.m1.1.4.2.3.4">m</mi><mo lspace="0em" rspace="0em" id="S3.E8Xa.2.1.1.m1.1.4.2.3.1b">​</mo><mi id="S3.E8Xa.2.1.1.m1.1.4.2.3.5">p</mi></mrow></msub><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.1.4.3">)</mo></mrow><mo id="S3.E8Xa.2.1.1.m1.1.5">−</mo><msubsup id="S3.E8Xa.2.1.1.m1.1.6"><mi id="S3.E8Xa.2.1.1.m1.1.6.2.2">G</mi><mi id="S3.E8Xa.2.1.1.m1.1.6.2.3">i</mi><mi id="S3.E8Xa.2.1.1.m1.1.6.3">ϕ</mi></msubsup><mrow id="S3.E8Xa.2.1.1.m1.1.7"><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.1.7.1">(</mo><msub id="S3.E8Xa.2.1.1.m1.1.7.2"><mi id="S3.E8Xa.2.1.1.m1.1.7.2.2">I</mi><mrow id="S3.E8Xa.2.1.1.m1.1.7.2.3"><mi id="S3.E8Xa.2.1.1.m1.1.7.2.3.2">o</mi><mo lspace="0em" rspace="0em" id="S3.E8Xa.2.1.1.m1.1.7.2.3.1">​</mo><mi id="S3.E8Xa.2.1.1.m1.1.7.2.3.3">u</mi><mo lspace="0em" rspace="0em" id="S3.E8Xa.2.1.1.m1.1.7.2.3.1a">​</mo><mi id="S3.E8Xa.2.1.1.m1.1.7.2.3.4">t</mi></mrow></msub><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.1.7.3">)</mo></mrow><msub id="S3.E8Xa.2.1.1.m1.1.8"><mo lspace="0em" rspace="0.167em" id="S3.E8Xa.2.1.1.m1.1.8.2">∥</mo><mn id="S3.E8Xa.2.1.1.m1.1.8.3">1</mn></msub><mo stretchy="false" id="S3.E8Xa.2.1.1.m1.1.9">]</mo><mo id="S3.E8Xa.2.1.1.m1.1.10">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E8Xa.2.1.1.m1.1c">\displaystyle+\|G_{i}^{\phi}(I_{comp})-G_{i}^{\phi}(I_{out})\|_{1}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.SSS3.p5.9" class="ltx_p">here, the Gram matrix <math id="S3.SS2.SSS3.p5.7.m1.1" class="ltx_Math" alttext="G_{i}^{\phi}=\phi_{i}\phi_{i}^{T}/C_{i}H_{i}W_{i}" display="inline"><semantics id="S3.SS2.SSS3.p5.7.m1.1a"><mrow id="S3.SS2.SSS3.p5.7.m1.1.1" xref="S3.SS2.SSS3.p5.7.m1.1.1.cmml"><msubsup id="S3.SS2.SSS3.p5.7.m1.1.1.2" xref="S3.SS2.SSS3.p5.7.m1.1.1.2.cmml"><mi id="S3.SS2.SSS3.p5.7.m1.1.1.2.2.2" xref="S3.SS2.SSS3.p5.7.m1.1.1.2.2.2.cmml">G</mi><mi id="S3.SS2.SSS3.p5.7.m1.1.1.2.2.3" xref="S3.SS2.SSS3.p5.7.m1.1.1.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS3.p5.7.m1.1.1.2.3" xref="S3.SS2.SSS3.p5.7.m1.1.1.2.3.cmml">ϕ</mi></msubsup><mo id="S3.SS2.SSS3.p5.7.m1.1.1.1" xref="S3.SS2.SSS3.p5.7.m1.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS3.p5.7.m1.1.1.3" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.cmml"><mrow id="S3.SS2.SSS3.p5.7.m1.1.1.3.2" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.cmml"><mrow id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.cmml"><msub id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2.cmml"><mi id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2.2" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2.2.cmml">ϕ</mi><mi id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2.3" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.1" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.1.cmml">​</mo><msubsup id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.cmml"><mi id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.2.2" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.2.2.cmml">ϕ</mi><mi id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.2.3" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.2.3.cmml">i</mi><mi id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.3" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.3.cmml">T</mi></msubsup></mrow><mo id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.1" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.1.cmml">/</mo><msub id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3.cmml"><mi id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3.2" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3.2.cmml">C</mi><mi id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3.3" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p5.7.m1.1.1.3.1" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.1.cmml">​</mo><msub id="S3.SS2.SSS3.p5.7.m1.1.1.3.3" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS3.p5.7.m1.1.1.3.3.2" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.3.2.cmml">H</mi><mi id="S3.SS2.SSS3.p5.7.m1.1.1.3.3.3" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p5.7.m1.1.1.3.1a" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.1.cmml">​</mo><msub id="S3.SS2.SSS3.p5.7.m1.1.1.3.4" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.4.cmml"><mi id="S3.SS2.SSS3.p5.7.m1.1.1.3.4.2" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.4.2.cmml">W</mi><mi id="S3.SS2.SSS3.p5.7.m1.1.1.3.4.3" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.4.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p5.7.m1.1b"><apply id="S3.SS2.SSS3.p5.7.m1.1.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1"><eq id="S3.SS2.SSS3.p5.7.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.1"></eq><apply id="S3.SS2.SSS3.p5.7.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.7.m1.1.1.2.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS3.p5.7.m1.1.1.2.2.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.7.m1.1.1.2.2.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS3.p5.7.m1.1.1.2.2.2.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.2.2.2">𝐺</ci><ci id="S3.SS2.SSS3.p5.7.m1.1.1.2.2.3.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS3.p5.7.m1.1.1.2.3.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.2.3">italic-ϕ</ci></apply><apply id="S3.SS2.SSS3.p5.7.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3"><times id="S3.SS2.SSS3.p5.7.m1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.1"></times><apply id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2"><divide id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.1"></divide><apply id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2"><times id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.1"></times><apply id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2.2.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2.2">italic-ϕ</ci><ci id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2.3.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3">superscript</csymbol><apply id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.2.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.2.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.2.2.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.2.2">italic-ϕ</ci><ci id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.2.3.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.3.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.2.3.3">𝑇</ci></apply></apply><apply id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3.2.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3.2">𝐶</ci><ci id="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3.3.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="S3.SS2.SSS3.p5.7.m1.1.1.3.3.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.7.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS3.p5.7.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS2.SSS3.p5.7.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.3.3">𝑖</ci></apply><apply id="S3.SS2.SSS3.p5.7.m1.1.1.3.4.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.4"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.7.m1.1.1.3.4.1.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.4">subscript</csymbol><ci id="S3.SS2.SSS3.p5.7.m1.1.1.3.4.2.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.4.2">𝑊</ci><ci id="S3.SS2.SSS3.p5.7.m1.1.1.3.4.3.cmml" xref="S3.SS2.SSS3.p5.7.m1.1.1.3.4.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p5.7.m1.1c">G_{i}^{\phi}=\phi_{i}\phi_{i}^{T}/C_{i}H_{i}W_{i}</annotation></semantics></math> and <math id="S3.SS2.SSS3.p5.8.m2.1" class="ltx_Math" alttext="C_{i}H_{i}W_{i}" display="inline"><semantics id="S3.SS2.SSS3.p5.8.m2.1a"><mrow id="S3.SS2.SSS3.p5.8.m2.1.1" xref="S3.SS2.SSS3.p5.8.m2.1.1.cmml"><msub id="S3.SS2.SSS3.p5.8.m2.1.1.2" xref="S3.SS2.SSS3.p5.8.m2.1.1.2.cmml"><mi id="S3.SS2.SSS3.p5.8.m2.1.1.2.2" xref="S3.SS2.SSS3.p5.8.m2.1.1.2.2.cmml">C</mi><mi id="S3.SS2.SSS3.p5.8.m2.1.1.2.3" xref="S3.SS2.SSS3.p5.8.m2.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p5.8.m2.1.1.1" xref="S3.SS2.SSS3.p5.8.m2.1.1.1.cmml">​</mo><msub id="S3.SS2.SSS3.p5.8.m2.1.1.3" xref="S3.SS2.SSS3.p5.8.m2.1.1.3.cmml"><mi id="S3.SS2.SSS3.p5.8.m2.1.1.3.2" xref="S3.SS2.SSS3.p5.8.m2.1.1.3.2.cmml">H</mi><mi id="S3.SS2.SSS3.p5.8.m2.1.1.3.3" xref="S3.SS2.SSS3.p5.8.m2.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p5.8.m2.1.1.1a" xref="S3.SS2.SSS3.p5.8.m2.1.1.1.cmml">​</mo><msub id="S3.SS2.SSS3.p5.8.m2.1.1.4" xref="S3.SS2.SSS3.p5.8.m2.1.1.4.cmml"><mi id="S3.SS2.SSS3.p5.8.m2.1.1.4.2" xref="S3.SS2.SSS3.p5.8.m2.1.1.4.2.cmml">W</mi><mi id="S3.SS2.SSS3.p5.8.m2.1.1.4.3" xref="S3.SS2.SSS3.p5.8.m2.1.1.4.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p5.8.m2.1b"><apply id="S3.SS2.SSS3.p5.8.m2.1.1.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1"><times id="S3.SS2.SSS3.p5.8.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.1"></times><apply id="S3.SS2.SSS3.p5.8.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.8.m2.1.1.2.1.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS3.p5.8.m2.1.1.2.2.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.2.2">𝐶</ci><ci id="S3.SS2.SSS3.p5.8.m2.1.1.2.3.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS3.p5.8.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.8.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS3.p5.8.m2.1.1.3.2.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.3.2">𝐻</ci><ci id="S3.SS2.SSS3.p5.8.m2.1.1.3.3.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.3.3">𝑖</ci></apply><apply id="S3.SS2.SSS3.p5.8.m2.1.1.4.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.8.m2.1.1.4.1.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.4">subscript</csymbol><ci id="S3.SS2.SSS3.p5.8.m2.1.1.4.2.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.4.2">𝑊</ci><ci id="S3.SS2.SSS3.p5.8.m2.1.1.4.3.cmml" xref="S3.SS2.SSS3.p5.8.m2.1.1.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p5.8.m2.1c">C_{i}H_{i}W_{i}</annotation></semantics></math> is the shape of the feature map of <math id="S3.SS2.SSS3.p5.9.m3.1" class="ltx_Math" alttext="\phi_{i}" display="inline"><semantics id="S3.SS2.SSS3.p5.9.m3.1a"><msub id="S3.SS2.SSS3.p5.9.m3.1.1" xref="S3.SS2.SSS3.p5.9.m3.1.1.cmml"><mi id="S3.SS2.SSS3.p5.9.m3.1.1.2" xref="S3.SS2.SSS3.p5.9.m3.1.1.2.cmml">ϕ</mi><mi id="S3.SS2.SSS3.p5.9.m3.1.1.3" xref="S3.SS2.SSS3.p5.9.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p5.9.m3.1b"><apply id="S3.SS2.SSS3.p5.9.m3.1.1.cmml" xref="S3.SS2.SSS3.p5.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p5.9.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p5.9.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p5.9.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p5.9.m3.1.1.2">italic-ϕ</ci><ci id="S3.SS2.SSS3.p5.9.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p5.9.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p5.9.m3.1c">\phi_{i}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.SSS3.p6" class="ltx_para">
<p id="S3.SS2.SSS3.p6.3" class="ltx_p">The total variation loss is employed to maintain spatial continuity and smoothness in the generated image to reduce the effect of noise.</p>
<table id="S3.E9" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E9X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{tv}=" display="inline"><semantics id="S3.E9X.2.1.1.m1.1a"><mrow id="S3.E9X.2.1.1.m1.1.1" xref="S3.E9X.2.1.1.m1.1.1.cmml"><msub id="S3.E9X.2.1.1.m1.1.1.2" xref="S3.E9X.2.1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9X.2.1.1.m1.1.1.2.2" xref="S3.E9X.2.1.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E9X.2.1.1.m1.1.1.2.3" xref="S3.E9X.2.1.1.m1.1.1.2.3.cmml"><mi id="S3.E9X.2.1.1.m1.1.1.2.3.2" xref="S3.E9X.2.1.1.m1.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E9X.2.1.1.m1.1.1.2.3.1" xref="S3.E9X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E9X.2.1.1.m1.1.1.2.3.3" xref="S3.E9X.2.1.1.m1.1.1.2.3.3.cmml">v</mi></mrow></msub><mo id="S3.E9X.2.1.1.m1.1.1.1" xref="S3.E9X.2.1.1.m1.1.1.1.cmml">=</mo><mi id="S3.E9X.2.1.1.m1.1.1.3" xref="S3.E9X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E9X.2.1.1.m1.1b"><apply id="S3.E9X.2.1.1.m1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1"><eq id="S3.E9X.2.1.1.m1.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.1"></eq><apply id="S3.E9X.2.1.1.m1.1.1.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E9X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S3.E9X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.2.2">ℒ</ci><apply id="S3.E9X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.2.3"><times id="S3.E9X.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E9X.2.1.1.m1.1.1.2.3.1"></times><ci id="S3.E9X.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E9X.2.1.1.m1.1.1.2.3.2">𝑡</ci><ci id="S3.E9X.2.1.1.m1.1.1.2.3.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.2.3.3">𝑣</ci></apply></apply><csymbol cd="latexml" id="S3.E9X.2.1.1.m1.1.1.3.cmml" xref="S3.E9X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9X.2.1.1.m1.1c">\displaystyle\mathcal{L}_{tv}=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9X.3.2.2.m1.8" class="ltx_Math" alttext="\displaystyle\ \sum\limits_{(i,j,j+1)\in M}{\|I_{comp}^{i,j+1}-I_{comp}^{i,j}\|_{1}}" display="inline"><semantics id="S3.E9X.3.2.2.m1.8a"><mrow id="S3.E9X.3.2.2.m1.8.8" xref="S3.E9X.3.2.2.m1.8.8.cmml"><mstyle displaystyle="true" id="S3.E9X.3.2.2.m1.8.8.2" xref="S3.E9X.3.2.2.m1.8.8.2.cmml"><munder id="S3.E9X.3.2.2.m1.8.8.2a" xref="S3.E9X.3.2.2.m1.8.8.2.cmml"><mo movablelimits="false" id="S3.E9X.3.2.2.m1.8.8.2.2" xref="S3.E9X.3.2.2.m1.8.8.2.2.cmml">∑</mo><mrow id="S3.E9X.3.2.2.m1.3.3.3" xref="S3.E9X.3.2.2.m1.3.3.3.cmml"><mrow id="S3.E9X.3.2.2.m1.3.3.3.3.1" xref="S3.E9X.3.2.2.m1.3.3.3.3.2.cmml"><mo stretchy="false" id="S3.E9X.3.2.2.m1.3.3.3.3.1.2" xref="S3.E9X.3.2.2.m1.3.3.3.3.2.cmml">(</mo><mi id="S3.E9X.3.2.2.m1.1.1.1.1" xref="S3.E9X.3.2.2.m1.1.1.1.1.cmml">i</mi><mo id="S3.E9X.3.2.2.m1.3.3.3.3.1.3" xref="S3.E9X.3.2.2.m1.3.3.3.3.2.cmml">,</mo><mi id="S3.E9X.3.2.2.m1.2.2.2.2" xref="S3.E9X.3.2.2.m1.2.2.2.2.cmml">j</mi><mo id="S3.E9X.3.2.2.m1.3.3.3.3.1.4" xref="S3.E9X.3.2.2.m1.3.3.3.3.2.cmml">,</mo><mrow id="S3.E9X.3.2.2.m1.3.3.3.3.1.1" xref="S3.E9X.3.2.2.m1.3.3.3.3.1.1.cmml"><mi id="S3.E9X.3.2.2.m1.3.3.3.3.1.1.2" xref="S3.E9X.3.2.2.m1.3.3.3.3.1.1.2.cmml">j</mi><mo id="S3.E9X.3.2.2.m1.3.3.3.3.1.1.1" xref="S3.E9X.3.2.2.m1.3.3.3.3.1.1.1.cmml">+</mo><mn id="S3.E9X.3.2.2.m1.3.3.3.3.1.1.3" xref="S3.E9X.3.2.2.m1.3.3.3.3.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E9X.3.2.2.m1.3.3.3.3.1.5" xref="S3.E9X.3.2.2.m1.3.3.3.3.2.cmml">)</mo></mrow><mo id="S3.E9X.3.2.2.m1.3.3.3.4" xref="S3.E9X.3.2.2.m1.3.3.3.4.cmml">∈</mo><mi id="S3.E9X.3.2.2.m1.3.3.3.5" xref="S3.E9X.3.2.2.m1.3.3.3.5.cmml">M</mi></mrow></munder></mstyle><msub id="S3.E9X.3.2.2.m1.8.8.1" xref="S3.E9X.3.2.2.m1.8.8.1.cmml"><mrow id="S3.E9X.3.2.2.m1.8.8.1.1.1" xref="S3.E9X.3.2.2.m1.8.8.1.1.2.cmml"><mo stretchy="false" id="S3.E9X.3.2.2.m1.8.8.1.1.1.2" xref="S3.E9X.3.2.2.m1.8.8.1.1.2.1.cmml">‖</mo><mrow id="S3.E9X.3.2.2.m1.8.8.1.1.1.1" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.cmml"><msubsup id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.cmml"><mi id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.2" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.2.cmml">I</mi><mrow id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.cmml"><mi id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.2" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.1" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.3" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.1a" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.4" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.1b" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.5" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.5.cmml">p</mi></mrow><mrow id="S3.E9X.3.2.2.m1.5.5.2.2" xref="S3.E9X.3.2.2.m1.5.5.2.3.cmml"><mi id="S3.E9X.3.2.2.m1.4.4.1.1" xref="S3.E9X.3.2.2.m1.4.4.1.1.cmml">i</mi><mo id="S3.E9X.3.2.2.m1.5.5.2.2.2" xref="S3.E9X.3.2.2.m1.5.5.2.3.cmml">,</mo><mrow id="S3.E9X.3.2.2.m1.5.5.2.2.1" xref="S3.E9X.3.2.2.m1.5.5.2.2.1.cmml"><mi id="S3.E9X.3.2.2.m1.5.5.2.2.1.2" xref="S3.E9X.3.2.2.m1.5.5.2.2.1.2.cmml">j</mi><mo id="S3.E9X.3.2.2.m1.5.5.2.2.1.1" xref="S3.E9X.3.2.2.m1.5.5.2.2.1.1.cmml">+</mo><mn id="S3.E9X.3.2.2.m1.5.5.2.2.1.3" xref="S3.E9X.3.2.2.m1.5.5.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><mo id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.1" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.cmml"><mi id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.2" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.2.cmml">I</mi><mrow id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.cmml"><mi id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.2" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.1" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.3" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.1a" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.4" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.1b" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.5" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.5.cmml">p</mi></mrow><mrow id="S3.E9X.3.2.2.m1.7.7.2.4" xref="S3.E9X.3.2.2.m1.7.7.2.3.cmml"><mi id="S3.E9X.3.2.2.m1.6.6.1.1" xref="S3.E9X.3.2.2.m1.6.6.1.1.cmml">i</mi><mo id="S3.E9X.3.2.2.m1.7.7.2.4.1" xref="S3.E9X.3.2.2.m1.7.7.2.3.cmml">,</mo><mi id="S3.E9X.3.2.2.m1.7.7.2.2" xref="S3.E9X.3.2.2.m1.7.7.2.2.cmml">j</mi></mrow></msubsup></mrow><mo stretchy="false" id="S3.E9X.3.2.2.m1.8.8.1.1.1.3" xref="S3.E9X.3.2.2.m1.8.8.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E9X.3.2.2.m1.8.8.1.3" xref="S3.E9X.3.2.2.m1.8.8.1.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E9X.3.2.2.m1.8b"><apply id="S3.E9X.3.2.2.m1.8.8.cmml" xref="S3.E9X.3.2.2.m1.8.8"><apply id="S3.E9X.3.2.2.m1.8.8.2.cmml" xref="S3.E9X.3.2.2.m1.8.8.2"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.8.8.2.1.cmml" xref="S3.E9X.3.2.2.m1.8.8.2">subscript</csymbol><sum id="S3.E9X.3.2.2.m1.8.8.2.2.cmml" xref="S3.E9X.3.2.2.m1.8.8.2.2"></sum><apply id="S3.E9X.3.2.2.m1.3.3.3.cmml" xref="S3.E9X.3.2.2.m1.3.3.3"><in id="S3.E9X.3.2.2.m1.3.3.3.4.cmml" xref="S3.E9X.3.2.2.m1.3.3.3.4"></in><vector id="S3.E9X.3.2.2.m1.3.3.3.3.2.cmml" xref="S3.E9X.3.2.2.m1.3.3.3.3.1"><ci id="S3.E9X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1">𝑖</ci><ci id="S3.E9X.3.2.2.m1.2.2.2.2.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2">𝑗</ci><apply id="S3.E9X.3.2.2.m1.3.3.3.3.1.1.cmml" xref="S3.E9X.3.2.2.m1.3.3.3.3.1.1"><plus id="S3.E9X.3.2.2.m1.3.3.3.3.1.1.1.cmml" xref="S3.E9X.3.2.2.m1.3.3.3.3.1.1.1"></plus><ci id="S3.E9X.3.2.2.m1.3.3.3.3.1.1.2.cmml" xref="S3.E9X.3.2.2.m1.3.3.3.3.1.1.2">𝑗</ci><cn type="integer" id="S3.E9X.3.2.2.m1.3.3.3.3.1.1.3.cmml" xref="S3.E9X.3.2.2.m1.3.3.3.3.1.1.3">1</cn></apply></vector><ci id="S3.E9X.3.2.2.m1.3.3.3.5.cmml" xref="S3.E9X.3.2.2.m1.3.3.3.5">𝑀</ci></apply></apply><apply id="S3.E9X.3.2.2.m1.8.8.1.cmml" xref="S3.E9X.3.2.2.m1.8.8.1"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.8.8.1.2.cmml" xref="S3.E9X.3.2.2.m1.8.8.1">subscript</csymbol><apply id="S3.E9X.3.2.2.m1.8.8.1.1.2.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1"><csymbol cd="latexml" id="S3.E9X.3.2.2.m1.8.8.1.1.2.1.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.2">norm</csymbol><apply id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1"><minus id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.1.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.1"></minus><apply id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.1.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2">superscript</csymbol><apply id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.1.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2">subscript</csymbol><ci id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.2.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.2">𝐼</ci><apply id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3"><times id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.1.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.1"></times><ci id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.2.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.2">𝑐</ci><ci id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.3.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.3">𝑜</ci><ci id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.4.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.4">𝑚</ci><ci id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.5.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.2.2.3.5">𝑝</ci></apply></apply><list id="S3.E9X.3.2.2.m1.5.5.2.3.cmml" xref="S3.E9X.3.2.2.m1.5.5.2.2"><ci id="S3.E9X.3.2.2.m1.4.4.1.1.cmml" xref="S3.E9X.3.2.2.m1.4.4.1.1">𝑖</ci><apply id="S3.E9X.3.2.2.m1.5.5.2.2.1.cmml" xref="S3.E9X.3.2.2.m1.5.5.2.2.1"><plus id="S3.E9X.3.2.2.m1.5.5.2.2.1.1.cmml" xref="S3.E9X.3.2.2.m1.5.5.2.2.1.1"></plus><ci id="S3.E9X.3.2.2.m1.5.5.2.2.1.2.cmml" xref="S3.E9X.3.2.2.m1.5.5.2.2.1.2">𝑗</ci><cn type="integer" id="S3.E9X.3.2.2.m1.5.5.2.2.1.3.cmml" xref="S3.E9X.3.2.2.m1.5.5.2.2.1.3">1</cn></apply></list></apply><apply id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.1.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3">superscript</csymbol><apply id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.1.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3">subscript</csymbol><ci id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.2.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.2">𝐼</ci><apply id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3"><times id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.1.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.1"></times><ci id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.2.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.2">𝑐</ci><ci id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.3.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.3">𝑜</ci><ci id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.4.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.4">𝑚</ci><ci id="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.5.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.1.1.1.3.2.3.5">𝑝</ci></apply></apply><list id="S3.E9X.3.2.2.m1.7.7.2.3.cmml" xref="S3.E9X.3.2.2.m1.7.7.2.4"><ci id="S3.E9X.3.2.2.m1.6.6.1.1.cmml" xref="S3.E9X.3.2.2.m1.6.6.1.1">𝑖</ci><ci id="S3.E9X.3.2.2.m1.7.7.2.2.cmml" xref="S3.E9X.3.2.2.m1.7.7.2.2">𝑗</ci></list></apply></apply></apply><cn type="integer" id="S3.E9X.3.2.2.m1.8.8.1.3.cmml" xref="S3.E9X.3.2.2.m1.8.8.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9X.3.2.2.m1.8c">\displaystyle\ \sum\limits_{(i,j,j+1)\in M}{\|I_{comp}^{i,j+1}-I_{comp}^{i,j}\|_{1}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
<tr id="S3.E9Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9Xa.2.1.1.m1.8" class="ltx_Math" alttext="\displaystyle+\sum\limits_{(i,j,i+1)\in M}{\|I_{comp}^{i+1,j}-I_{comp}^{i,j}\|_{1}}," display="inline"><semantics id="S3.E9Xa.2.1.1.m1.8a"><mrow id="S3.E9Xa.2.1.1.m1.8.8.1" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.cmml"><mrow id="S3.E9Xa.2.1.1.m1.8.8.1.1" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.cmml"><mo id="S3.E9Xa.2.1.1.m1.8.8.1.1a" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.cmml">+</mo><mrow id="S3.E9Xa.2.1.1.m1.8.8.1.1.1" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.cmml"><munder id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2a" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.2" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E9Xa.2.1.1.m1.3.3.3" xref="S3.E9Xa.2.1.1.m1.3.3.3.cmml"><mrow id="S3.E9Xa.2.1.1.m1.3.3.3.3.1" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.2.cmml"><mo stretchy="false" id="S3.E9Xa.2.1.1.m1.3.3.3.3.1.2" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.2.cmml">(</mo><mi id="S3.E9Xa.2.1.1.m1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.E9Xa.2.1.1.m1.3.3.3.3.1.3" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.2.cmml">,</mo><mi id="S3.E9Xa.2.1.1.m1.2.2.2.2" xref="S3.E9Xa.2.1.1.m1.2.2.2.2.cmml">j</mi><mo id="S3.E9Xa.2.1.1.m1.3.3.3.3.1.4" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.2.cmml">,</mo><mrow id="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.cmml"><mi id="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.2" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.2.cmml">i</mi><mo id="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.1" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.1.cmml">+</mo><mn id="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.3" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E9Xa.2.1.1.m1.3.3.3.3.1.5" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.2.cmml">)</mo></mrow><mo id="S3.E9Xa.2.1.1.m1.3.3.3.4" xref="S3.E9Xa.2.1.1.m1.3.3.3.4.cmml">∈</mo><mi id="S3.E9Xa.2.1.1.m1.3.3.3.5" xref="S3.E9Xa.2.1.1.m1.3.3.3.5.cmml">M</mi></mrow></munder></mstyle><msub id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.cmml"><mrow id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.2" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.2" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.2.cmml">I</mi><mrow id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.1a" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.4" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.1b" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.5" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.5.cmml">p</mi></mrow><mrow id="S3.E9Xa.2.1.1.m1.5.5.2.2" xref="S3.E9Xa.2.1.1.m1.5.5.2.3.cmml"><mrow id="S3.E9Xa.2.1.1.m1.5.5.2.2.1" xref="S3.E9Xa.2.1.1.m1.5.5.2.2.1.cmml"><mi id="S3.E9Xa.2.1.1.m1.5.5.2.2.1.2" xref="S3.E9Xa.2.1.1.m1.5.5.2.2.1.2.cmml">i</mi><mo id="S3.E9Xa.2.1.1.m1.5.5.2.2.1.1" xref="S3.E9Xa.2.1.1.m1.5.5.2.2.1.1.cmml">+</mo><mn id="S3.E9Xa.2.1.1.m1.5.5.2.2.1.3" xref="S3.E9Xa.2.1.1.m1.5.5.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E9Xa.2.1.1.m1.5.5.2.2.2" xref="S3.E9Xa.2.1.1.m1.5.5.2.3.cmml">,</mo><mi id="S3.E9Xa.2.1.1.m1.4.4.1.1" xref="S3.E9Xa.2.1.1.m1.4.4.1.1.cmml">j</mi></mrow></msubsup><mo id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.2" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.2.cmml">I</mi><mrow id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.2" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.1" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.3" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.1a" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.4" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.1b" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.5" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.5.cmml">p</mi></mrow><mrow id="S3.E9Xa.2.1.1.m1.7.7.2.4" xref="S3.E9Xa.2.1.1.m1.7.7.2.3.cmml"><mi id="S3.E9Xa.2.1.1.m1.6.6.1.1" xref="S3.E9Xa.2.1.1.m1.6.6.1.1.cmml">i</mi><mo id="S3.E9Xa.2.1.1.m1.7.7.2.4.1" xref="S3.E9Xa.2.1.1.m1.7.7.2.3.cmml">,</mo><mi id="S3.E9Xa.2.1.1.m1.7.7.2.2" xref="S3.E9Xa.2.1.1.m1.7.7.2.2.cmml">j</mi></mrow></msubsup></mrow><mo stretchy="false" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.3.cmml">1</mn></msub></mrow></mrow><mo id="S3.E9Xa.2.1.1.m1.8.8.1.2" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9Xa.2.1.1.m1.8b"><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1"><plus id="S3.E9Xa.2.1.1.m1.8.8.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1"></plus><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1"><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2">subscript</csymbol><sum id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.2"></sum><apply id="S3.E9Xa.2.1.1.m1.3.3.3.cmml" xref="S3.E9Xa.2.1.1.m1.3.3.3"><in id="S3.E9Xa.2.1.1.m1.3.3.3.4.cmml" xref="S3.E9Xa.2.1.1.m1.3.3.3.4"></in><vector id="S3.E9Xa.2.1.1.m1.3.3.3.3.2.cmml" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.1"><ci id="S3.E9Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1">𝑖</ci><ci id="S3.E9Xa.2.1.1.m1.2.2.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.2.2">𝑗</ci><apply id="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1"><plus id="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.1"></plus><ci id="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.2">𝑖</ci><cn type="integer" id="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.3.3.3.3.1.1.3">1</cn></apply></vector><ci id="S3.E9Xa.2.1.1.m1.3.3.3.5.cmml" xref="S3.E9Xa.2.1.1.m1.3.3.3.5">𝑀</ci></apply></apply><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1">subscript</csymbol><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1"><minus id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.1"></minus><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.2">𝐼</ci><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3"><times id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.2">𝑐</ci><ci id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.3">𝑜</ci><ci id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.4.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.4">𝑚</ci><ci id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.5.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.2.2.3.5">𝑝</ci></apply></apply><list id="S3.E9Xa.2.1.1.m1.5.5.2.3.cmml" xref="S3.E9Xa.2.1.1.m1.5.5.2.2"><apply id="S3.E9Xa.2.1.1.m1.5.5.2.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.5.5.2.2.1"><plus id="S3.E9Xa.2.1.1.m1.5.5.2.2.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.5.5.2.2.1.1"></plus><ci id="S3.E9Xa.2.1.1.m1.5.5.2.2.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.5.5.2.2.1.2">𝑖</ci><cn type="integer" id="S3.E9Xa.2.1.1.m1.5.5.2.2.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.5.5.2.2.1.3">1</cn></apply><ci id="S3.E9Xa.2.1.1.m1.4.4.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.4.4.1.1">𝑗</ci></list></apply><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.2">𝐼</ci><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3"><times id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.2">𝑐</ci><ci id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.3">𝑜</ci><ci id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.4">𝑚</ci><ci id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.5.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.1.3.2.3.5">𝑝</ci></apply></apply><list id="S3.E9Xa.2.1.1.m1.7.7.2.3.cmml" xref="S3.E9Xa.2.1.1.m1.7.7.2.4"><ci id="S3.E9Xa.2.1.1.m1.6.6.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.6.6.1.1">𝑖</ci><ci id="S3.E9Xa.2.1.1.m1.7.7.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.7.7.2.2">𝑗</ci></list></apply></apply></apply><cn type="integer" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.3.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9Xa.2.1.1.m1.8c">\displaystyle+\sum\limits_{(i,j,i+1)\in M}{\|I_{comp}^{i+1,j}-I_{comp}^{i,j}\|_{1}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS2.SSS3.p6.2" class="ltx_p">where <math id="S3.SS2.SSS3.p6.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.SSS3.p6.1.m1.1a"><mi id="S3.SS2.SSS3.p6.1.m1.1.1" xref="S3.SS2.SSS3.p6.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p6.1.m1.1b"><ci id="S3.SS2.SSS3.p6.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p6.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p6.1.m1.1c">M</annotation></semantics></math> is the hole region in <math id="S3.SS2.SSS3.p6.2.m2.1" class="ltx_Math" alttext="\hat{I}_{mask}" display="inline"><semantics id="S3.SS2.SSS3.p6.2.m2.1a"><msub id="S3.SS2.SSS3.p6.2.m2.1.1" xref="S3.SS2.SSS3.p6.2.m2.1.1.cmml"><mover accent="true" id="S3.SS2.SSS3.p6.2.m2.1.1.2" xref="S3.SS2.SSS3.p6.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS3.p6.2.m2.1.1.2.2" xref="S3.SS2.SSS3.p6.2.m2.1.1.2.2.cmml">I</mi><mo id="S3.SS2.SSS3.p6.2.m2.1.1.2.1" xref="S3.SS2.SSS3.p6.2.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S3.SS2.SSS3.p6.2.m2.1.1.3" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS3.p6.2.m2.1.1.3.2" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p6.2.m2.1.1.3.1" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p6.2.m2.1.1.3.3" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p6.2.m2.1.1.3.1a" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p6.2.m2.1.1.3.4" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.p6.2.m2.1.1.3.1b" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS3.p6.2.m2.1.1.3.5" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p6.2.m2.1b"><apply id="S3.SS2.SSS3.p6.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p6.2.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p6.2.m2.1.1">subscript</csymbol><apply id="S3.SS2.SSS3.p6.2.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p6.2.m2.1.1.2"><ci id="S3.SS2.SSS3.p6.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS3.p6.2.m2.1.1.2.1">^</ci><ci id="S3.SS2.SSS3.p6.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS3.p6.2.m2.1.1.2.2">𝐼</ci></apply><apply id="S3.SS2.SSS3.p6.2.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p6.2.m2.1.1.3"><times id="S3.SS2.SSS3.p6.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.1"></times><ci id="S3.SS2.SSS3.p6.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.2">𝑚</ci><ci id="S3.SS2.SSS3.p6.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.3">𝑎</ci><ci id="S3.SS2.SSS3.p6.2.m2.1.1.3.4.cmml" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.4">𝑠</ci><ci id="S3.SS2.SSS3.p6.2.m2.1.1.3.5.cmml" xref="S3.SS2.SSS3.p6.2.m2.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p6.2.m2.1c">\hat{I}_{mask}</annotation></semantics></math>.</p>
</div>
<figure id="S3.F5" class="ltx_figure"><img src="/html/2104.11493/assets/fig5.png" id="S3.F5.g1" class="ltx_graphics ltx_img_landscape" width="598" height="140" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Some training image samples generated by our enhanced synthesis text engine. Input (top), final ground truth (middle), text mask ground truth (bottom).</figcaption>
</figure>
<div id="S3.SS2.SSS3.p7" class="ltx_para">
<p id="S3.SS2.SSS3.p7.4" class="ltx_p">Finally, the loss function of the entire network is expressed as follows:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.1" class="ltx_Math" alttext="\mathcal{L}=10\mathcal{L}_{SMPM}+\mathcal{L}_{pixel}+\lambda_{1}\mathcal{L}_{per}+\lambda_{2}\mathcal{L}_{style}+\lambda_{3}\mathcal{L}_{tv}," display="block"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.3.cmml"><mrow id="S3.E10.m1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.3.2.cmml"><mn id="S3.E10.m1.1.1.1.1.3.2.2" xref="S3.E10.m1.1.1.1.1.3.2.2.cmml">10</mn><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.2.1" xref="S3.E10.m1.1.1.1.1.3.2.1.cmml">​</mo><msub id="S3.E10.m1.1.1.1.1.3.2.3" xref="S3.E10.m1.1.1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.3.2.3.2" xref="S3.E10.m1.1.1.1.1.3.2.3.2.cmml">ℒ</mi><mrow id="S3.E10.m1.1.1.1.1.3.2.3.3" xref="S3.E10.m1.1.1.1.1.3.2.3.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.2.3.3.2" xref="S3.E10.m1.1.1.1.1.3.2.3.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.2.3.3.1" xref="S3.E10.m1.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.2.3.3.3" xref="S3.E10.m1.1.1.1.1.3.2.3.3.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.2.3.3.1a" xref="S3.E10.m1.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.2.3.3.4" xref="S3.E10.m1.1.1.1.1.3.2.3.3.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.2.3.3.1b" xref="S3.E10.m1.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.2.3.3.5" xref="S3.E10.m1.1.1.1.1.3.2.3.3.5.cmml">M</mi></mrow></msub></mrow><mo id="S3.E10.m1.1.1.1.1.3.1" xref="S3.E10.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E10.m1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.3.3.2" xref="S3.E10.m1.1.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S3.E10.m1.1.1.1.1.3.3.3" xref="S3.E10.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.3.3.2" xref="S3.E10.m1.1.1.1.1.3.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.3.3.1" xref="S3.E10.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.3.3.3" xref="S3.E10.m1.1.1.1.1.3.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.3.3.1a" xref="S3.E10.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.3.3.4" xref="S3.E10.m1.1.1.1.1.3.3.3.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.3.3.1b" xref="S3.E10.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.3.3.5" xref="S3.E10.m1.1.1.1.1.3.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.3.3.1c" xref="S3.E10.m1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.3.3.6" xref="S3.E10.m1.1.1.1.1.3.3.3.6.cmml">l</mi></mrow></msub><mo id="S3.E10.m1.1.1.1.1.3.1a" xref="S3.E10.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E10.m1.1.1.1.1.3.4" xref="S3.E10.m1.1.1.1.1.3.4.cmml"><msub id="S3.E10.m1.1.1.1.1.3.4.2" xref="S3.E10.m1.1.1.1.1.3.4.2.cmml"><mi id="S3.E10.m1.1.1.1.1.3.4.2.2" xref="S3.E10.m1.1.1.1.1.3.4.2.2.cmml">λ</mi><mn id="S3.E10.m1.1.1.1.1.3.4.2.3" xref="S3.E10.m1.1.1.1.1.3.4.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.4.1" xref="S3.E10.m1.1.1.1.1.3.4.1.cmml">​</mo><msub id="S3.E10.m1.1.1.1.1.3.4.3" xref="S3.E10.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.3.4.3.2" xref="S3.E10.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mrow id="S3.E10.m1.1.1.1.1.3.4.3.3" xref="S3.E10.m1.1.1.1.1.3.4.3.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.4.3.3.2" xref="S3.E10.m1.1.1.1.1.3.4.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.4.3.3.1" xref="S3.E10.m1.1.1.1.1.3.4.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.4.3.3.3" xref="S3.E10.m1.1.1.1.1.3.4.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.4.3.3.1a" xref="S3.E10.m1.1.1.1.1.3.4.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.4.3.3.4" xref="S3.E10.m1.1.1.1.1.3.4.3.3.4.cmml">r</mi></mrow></msub></mrow><mo id="S3.E10.m1.1.1.1.1.3.1b" xref="S3.E10.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E10.m1.1.1.1.1.3.5" xref="S3.E10.m1.1.1.1.1.3.5.cmml"><msub id="S3.E10.m1.1.1.1.1.3.5.2" xref="S3.E10.m1.1.1.1.1.3.5.2.cmml"><mi id="S3.E10.m1.1.1.1.1.3.5.2.2" xref="S3.E10.m1.1.1.1.1.3.5.2.2.cmml">λ</mi><mn id="S3.E10.m1.1.1.1.1.3.5.2.3" xref="S3.E10.m1.1.1.1.1.3.5.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.5.1" xref="S3.E10.m1.1.1.1.1.3.5.1.cmml">​</mo><msub id="S3.E10.m1.1.1.1.1.3.5.3" xref="S3.E10.m1.1.1.1.1.3.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.3.5.3.2" xref="S3.E10.m1.1.1.1.1.3.5.3.2.cmml">ℒ</mi><mrow id="S3.E10.m1.1.1.1.1.3.5.3.3" xref="S3.E10.m1.1.1.1.1.3.5.3.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.5.3.3.2" xref="S3.E10.m1.1.1.1.1.3.5.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.5.3.3.1" xref="S3.E10.m1.1.1.1.1.3.5.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.5.3.3.3" xref="S3.E10.m1.1.1.1.1.3.5.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.5.3.3.1a" xref="S3.E10.m1.1.1.1.1.3.5.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.5.3.3.4" xref="S3.E10.m1.1.1.1.1.3.5.3.3.4.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.5.3.3.1b" xref="S3.E10.m1.1.1.1.1.3.5.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.5.3.3.5" xref="S3.E10.m1.1.1.1.1.3.5.3.3.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.5.3.3.1c" xref="S3.E10.m1.1.1.1.1.3.5.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.5.3.3.6" xref="S3.E10.m1.1.1.1.1.3.5.3.3.6.cmml">e</mi></mrow></msub></mrow><mo id="S3.E10.m1.1.1.1.1.3.1c" xref="S3.E10.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E10.m1.1.1.1.1.3.6" xref="S3.E10.m1.1.1.1.1.3.6.cmml"><msub id="S3.E10.m1.1.1.1.1.3.6.2" xref="S3.E10.m1.1.1.1.1.3.6.2.cmml"><mi id="S3.E10.m1.1.1.1.1.3.6.2.2" xref="S3.E10.m1.1.1.1.1.3.6.2.2.cmml">λ</mi><mn id="S3.E10.m1.1.1.1.1.3.6.2.3" xref="S3.E10.m1.1.1.1.1.3.6.2.3.cmml">3</mn></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.6.1" xref="S3.E10.m1.1.1.1.1.3.6.1.cmml">​</mo><msub id="S3.E10.m1.1.1.1.1.3.6.3" xref="S3.E10.m1.1.1.1.1.3.6.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.3.6.3.2" xref="S3.E10.m1.1.1.1.1.3.6.3.2.cmml">ℒ</mi><mrow id="S3.E10.m1.1.1.1.1.3.6.3.3" xref="S3.E10.m1.1.1.1.1.3.6.3.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.6.3.3.2" xref="S3.E10.m1.1.1.1.1.3.6.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.3.6.3.3.1" xref="S3.E10.m1.1.1.1.1.3.6.3.3.1.cmml">​</mo><mi id="S3.E10.m1.1.1.1.1.3.6.3.3.3" xref="S3.E10.m1.1.1.1.1.3.6.3.3.3.cmml">v</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"></eq><ci id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2">ℒ</ci><apply id="S3.E10.m1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3"><plus id="S3.E10.m1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.1"></plus><apply id="S3.E10.m1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2"><times id="S3.E10.m1.1.1.1.1.3.2.1.cmml" xref="S3.E10.m1.1.1.1.1.3.2.1"></times><cn type="integer" id="S3.E10.m1.1.1.1.1.3.2.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2.2">10</cn><apply id="S3.E10.m1.1.1.1.1.3.2.3.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3.2">ℒ</ci><apply id="S3.E10.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3.3"><times id="S3.E10.m1.1.1.1.1.3.2.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3.3.1"></times><ci id="S3.E10.m1.1.1.1.1.3.2.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3.3.2">𝑆</ci><ci id="S3.E10.m1.1.1.1.1.3.2.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3.3.3">𝑀</ci><ci id="S3.E10.m1.1.1.1.1.3.2.3.3.4.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3.3.4">𝑃</ci><ci id="S3.E10.m1.1.1.1.1.3.2.3.3.5.cmml" xref="S3.E10.m1.1.1.1.1.3.2.3.3.5">𝑀</ci></apply></apply></apply><apply id="S3.E10.m1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.3.2">ℒ</ci><apply id="S3.E10.m1.1.1.1.1.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3"><times id="S3.E10.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.1"></times><ci id="S3.E10.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.2">𝑝</ci><ci id="S3.E10.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.3">𝑖</ci><ci id="S3.E10.m1.1.1.1.1.3.3.3.4.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.4">𝑥</ci><ci id="S3.E10.m1.1.1.1.1.3.3.3.5.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.5">𝑒</ci><ci id="S3.E10.m1.1.1.1.1.3.3.3.6.cmml" xref="S3.E10.m1.1.1.1.1.3.3.3.6">𝑙</ci></apply></apply><apply id="S3.E10.m1.1.1.1.1.3.4.cmml" xref="S3.E10.m1.1.1.1.1.3.4"><times id="S3.E10.m1.1.1.1.1.3.4.1.cmml" xref="S3.E10.m1.1.1.1.1.3.4.1"></times><apply id="S3.E10.m1.1.1.1.1.3.4.2.cmml" xref="S3.E10.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.4.2.1.cmml" xref="S3.E10.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.4.2.2.cmml" xref="S3.E10.m1.1.1.1.1.3.4.2.2">𝜆</ci><cn type="integer" id="S3.E10.m1.1.1.1.1.3.4.2.3.cmml" xref="S3.E10.m1.1.1.1.1.3.4.2.3">1</cn></apply><apply id="S3.E10.m1.1.1.1.1.3.4.3.cmml" xref="S3.E10.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.4.3.2">ℒ</ci><apply id="S3.E10.m1.1.1.1.1.3.4.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.4.3.3"><times id="S3.E10.m1.1.1.1.1.3.4.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.4.3.3.1"></times><ci id="S3.E10.m1.1.1.1.1.3.4.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.4.3.3.2">𝑝</ci><ci id="S3.E10.m1.1.1.1.1.3.4.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.4.3.3.3">𝑒</ci><ci id="S3.E10.m1.1.1.1.1.3.4.3.3.4.cmml" xref="S3.E10.m1.1.1.1.1.3.4.3.3.4">𝑟</ci></apply></apply></apply><apply id="S3.E10.m1.1.1.1.1.3.5.cmml" xref="S3.E10.m1.1.1.1.1.3.5"><times id="S3.E10.m1.1.1.1.1.3.5.1.cmml" xref="S3.E10.m1.1.1.1.1.3.5.1"></times><apply id="S3.E10.m1.1.1.1.1.3.5.2.cmml" xref="S3.E10.m1.1.1.1.1.3.5.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.5.2.1.cmml" xref="S3.E10.m1.1.1.1.1.3.5.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.5.2.2.cmml" xref="S3.E10.m1.1.1.1.1.3.5.2.2">𝜆</ci><cn type="integer" id="S3.E10.m1.1.1.1.1.3.5.2.3.cmml" xref="S3.E10.m1.1.1.1.1.3.5.2.3">2</cn></apply><apply id="S3.E10.m1.1.1.1.1.3.5.3.cmml" xref="S3.E10.m1.1.1.1.1.3.5.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.5.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.5.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.5.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.5.3.2">ℒ</ci><apply id="S3.E10.m1.1.1.1.1.3.5.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.5.3.3"><times id="S3.E10.m1.1.1.1.1.3.5.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.5.3.3.1"></times><ci id="S3.E10.m1.1.1.1.1.3.5.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.5.3.3.2">𝑠</ci><ci id="S3.E10.m1.1.1.1.1.3.5.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.5.3.3.3">𝑡</ci><ci id="S3.E10.m1.1.1.1.1.3.5.3.3.4.cmml" xref="S3.E10.m1.1.1.1.1.3.5.3.3.4">𝑦</ci><ci id="S3.E10.m1.1.1.1.1.3.5.3.3.5.cmml" xref="S3.E10.m1.1.1.1.1.3.5.3.3.5">𝑙</ci><ci id="S3.E10.m1.1.1.1.1.3.5.3.3.6.cmml" xref="S3.E10.m1.1.1.1.1.3.5.3.3.6">𝑒</ci></apply></apply></apply><apply id="S3.E10.m1.1.1.1.1.3.6.cmml" xref="S3.E10.m1.1.1.1.1.3.6"><times id="S3.E10.m1.1.1.1.1.3.6.1.cmml" xref="S3.E10.m1.1.1.1.1.3.6.1"></times><apply id="S3.E10.m1.1.1.1.1.3.6.2.cmml" xref="S3.E10.m1.1.1.1.1.3.6.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.6.2.1.cmml" xref="S3.E10.m1.1.1.1.1.3.6.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.6.2.2.cmml" xref="S3.E10.m1.1.1.1.1.3.6.2.2">𝜆</ci><cn type="integer" id="S3.E10.m1.1.1.1.1.3.6.2.3.cmml" xref="S3.E10.m1.1.1.1.1.3.6.2.3">3</cn></apply><apply id="S3.E10.m1.1.1.1.1.3.6.3.cmml" xref="S3.E10.m1.1.1.1.1.3.6.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.6.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.6.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.6.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.6.3.2">ℒ</ci><apply id="S3.E10.m1.1.1.1.1.3.6.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.6.3.3"><times id="S3.E10.m1.1.1.1.1.3.6.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.6.3.3.1"></times><ci id="S3.E10.m1.1.1.1.1.3.6.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.6.3.3.2">𝑡</ci><ci id="S3.E10.m1.1.1.1.1.3.6.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.6.3.3.3">𝑣</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\mathcal{L}=10\mathcal{L}_{SMPM}+\mathcal{L}_{pixel}+\lambda_{1}\mathcal{L}_{per}+\lambda_{2}\mathcal{L}_{style}+\lambda_{3}\mathcal{L}_{tv},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.p7.3" class="ltx_p">where <math id="S3.SS2.SSS3.p7.1.m1.1" class="ltx_Math" alttext="\lambda_{1}" display="inline"><semantics id="S3.SS2.SSS3.p7.1.m1.1a"><msub id="S3.SS2.SSS3.p7.1.m1.1.1" xref="S3.SS2.SSS3.p7.1.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p7.1.m1.1.1.2" xref="S3.SS2.SSS3.p7.1.m1.1.1.2.cmml">λ</mi><mn id="S3.SS2.SSS3.p7.1.m1.1.1.3" xref="S3.SS2.SSS3.p7.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p7.1.m1.1b"><apply id="S3.SS2.SSS3.p7.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p7.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p7.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p7.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p7.1.m1.1.1.2">𝜆</ci><cn type="integer" id="S3.SS2.SSS3.p7.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p7.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p7.1.m1.1c">\lambda_{1}</annotation></semantics></math>, <math id="S3.SS2.SSS3.p7.2.m2.1" class="ltx_Math" alttext="\lambda_{2}" display="inline"><semantics id="S3.SS2.SSS3.p7.2.m2.1a"><msub id="S3.SS2.SSS3.p7.2.m2.1.1" xref="S3.SS2.SSS3.p7.2.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p7.2.m2.1.1.2" xref="S3.SS2.SSS3.p7.2.m2.1.1.2.cmml">λ</mi><mn id="S3.SS2.SSS3.p7.2.m2.1.1.3" xref="S3.SS2.SSS3.p7.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p7.2.m2.1b"><apply id="S3.SS2.SSS3.p7.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p7.2.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p7.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p7.2.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p7.2.m2.1.1.2">𝜆</ci><cn type="integer" id="S3.SS2.SSS3.p7.2.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p7.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p7.2.m2.1c">\lambda_{2}</annotation></semantics></math>, and <math id="S3.SS2.SSS3.p7.3.m3.1" class="ltx_Math" alttext="\lambda_{3}" display="inline"><semantics id="S3.SS2.SSS3.p7.3.m3.1a"><msub id="S3.SS2.SSS3.p7.3.m3.1.1" xref="S3.SS2.SSS3.p7.3.m3.1.1.cmml"><mi id="S3.SS2.SSS3.p7.3.m3.1.1.2" xref="S3.SS2.SSS3.p7.3.m3.1.1.2.cmml">λ</mi><mn id="S3.SS2.SSS3.p7.3.m3.1.1.3" xref="S3.SS2.SSS3.p7.3.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p7.3.m3.1b"><apply id="S3.SS2.SSS3.p7.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p7.3.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p7.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p7.3.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p7.3.m3.1.1.2">𝜆</ci><cn type="integer" id="S3.SS2.SSS3.p7.3.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p7.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p7.3.m3.1c">\lambda_{3}</annotation></semantics></math> are set to 0.05, 100, and 0.1, respectively, according to Liu <span id="S3.SS2.SSS3.p7.3.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. We slightly changed the weight of the style loss according to our own training loss curve.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiment</span>
</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.4.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.5.2" class="ltx_text ltx_font_italic">Implementation Details</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Our implementation is based on PyTorch. In the training process, we generated one million synthetic text images and corresponding text mask images as training data from background images that did not contain text. The input size of our network was 128×640, and the height of the training images was first resized to 128 while maintaining the aspect ratio. Then, if the width of the image was insufficient, the remaining pixels were padded with 0 on the right side of the image; otherwise, it was resized to 640. The training batch size was 8 on a single 1080Ti GPU. We used Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite> to optimize the entire network with <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="{\beta}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">{\beta}</annotation></semantics></math> = (0.9, 0.999) and set the weight decay to 0. The learning rate started with 0.0002 and decayed to nine-tenth after each epoch in the training phase. The network was trained in an end-to-end manner, and we followed the fine-tuning strategy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>, which freezes the batch normalization parameters in the encoder of the background inpainting module after approximately 10 epochs.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">In the inference process, we first expanded the text bounding box to include more background information and cropped the expanded text region from the image. Then, we resized and padded the cropped text image following the preprocessing strategy of training and fed it to our proposed network for text erasing. Subsequently, we cut off the padding part of the network output and resized the remaining part back to its original size and ratio. Finally, part of the output, which was inside the original bounding box, was pasted back into the source image. The text in an arbitrary quadrilateral annotation was transformed by perspective transformation, and the text in the curved annotation was transformed by thin-plate-spline into rectangular text images before being fed into our network. The network output was transformed back to its original shape and copied to the original position to obtain the final text-erased image.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.4.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.5.2" class="ltx_text ltx_font_italic">Dataset and Evaluation Metrics</span>
</h3>

<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS2.SSS1.4.1.1" class="ltx_text">IV-B</span>1 </span>Synthetic Dataset</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.ix1.p1" class="ltx_para">
<p id="S4.I1.ix1.p1.1" class="ltx_p"><span id="S4.I1.ix1.p1.1.1" class="ltx_text ltx_font_bold">Improved Synth-text image</span> We used over 1,500 English and Chinese fonts and 10,000 background images without text to generate a total of one million images for our model training using our enhanced synthesis text engine, which is improved from Synth-text technology <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. The training dataset contains original background images as the final ground truth, synthetic text in background images as input, and mask images of synthetic text as the ground truth of the text mask.</p>
</div>
<div id="S4.I1.ix1.p2" class="ltx_para">
<p id="S4.I1.ix1.p2.1" class="ltx_p">Compared with the vanilla synth-text method, we made several improvements to make our generated data share more similarity with real-world data. 1) There is a 50% possibility that the text instance is composed directly on the background instead of being generated by Poisson blending, in which case, some background information behind the text instance would be provided. 2) Some other effects were added to the text instance, such as Gaussian blur to simulate out-of-focus, text shift, text with a 3D structure, and more shadow parameters to make the shadow of the text more realistic, among others. 3) We compressed and saved the image in JPEG format with different compression qualities to handle images of varying quality. 4) A dilation mask of a text instance, including all of its effects, was generated in the mask image to reduce the effect of JPEG artifacts around the text edge. Some samples of the generated images are shown in Fig. <a href="#S3.F5" title="Figure 5 ‣ III-B3 Training Loss ‣ III-B Background Inpainting Module ‣ III Methodology ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</li>
<li id="S4.I1.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.ix2.p1" class="ltx_para">
<p id="S4.I1.ix2.p1.1" class="ltx_p"><span id="S4.I1.ix2.p1.1.1" class="ltx_text ltx_font_bold">SCUT-Syn</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> was created by Synthesis text engine <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, which contains 8,000 images for training and 800 images for testing. The background images of this dataset were collected from ICDAR 2013 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and ICDAR MLT-2017 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite>, and the text instances in the background images were manually removed. Most test images were from the training set, and the training and testing sets were generated from the same background images, although the synthesized text instances were different. We evaluated our method using only test images.</p>
</div>
</li>
</ul>
</div>
<figure id="S4.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F6.sf1.3" class="ltx_block ltx_minipage ltx_align_top" style="width:70.2pt;">
<img src="/html/2104.11493/assets/fig6/img_689_0.jpg" id="S4.F6.sf1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig6/img_353_0.jpg" id="S4.F6.sf1.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig6/img_368_0.jpg" id="S4.F6.sf1.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf1.5.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S4.F6.sf1.6.2" class="ltx_text" style="font-size:80%;">Input</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F6.sf2.3" class="ltx_block ltx_minipage ltx_align_top" style="width:70.2pt;">
<img src="/html/2104.11493/assets/fig6/img_689_24.jpg" id="S4.F6.sf2.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig6/img_353_24.jpg" id="S4.F6.sf2.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig6/img_368_24.jpg" id="S4.F6.sf2.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf2.5.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S4.F6.sf2.6.2" class="ltx_text" style="font-size:80%;">BIPM</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F6.sf3" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F6.sf3.3" class="ltx_block ltx_minipage ltx_align_top" style="width:70.2pt;">
<img src="/html/2104.11493/assets/fig6/img_689_23.jpg" id="S4.F6.sf3.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig6/img_353_23.jpg" id="S4.F6.sf3.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig6/img_368_23.jpg" id="S4.F6.sf3.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf3.5.1.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="S4.F6.sf3.6.2" class="ltx_text" style="font-size:80%;">SMPM+BIPM</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F6.sf4" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F6.sf4.3" class="ltx_block ltx_minipage ltx_align_top" style="width:70.2pt;">
<img src="/html/2104.11493/assets/fig6/img_689_22.jpg" id="S4.F6.sf4.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig6/img_353_22.jpg" id="S4.F6.sf4.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig6/img_368_22.jpg" id="S4.F6.sf4.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf4.5.1.1" class="ltx_text" style="font-size:80%;">(d)</span> </span><span id="S4.F6.sf4.6.2" class="ltx_text" style="font-size:80%;">SMPM+BIPM+SC</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F6.sf5" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F6.sf5.3" class="ltx_block ltx_minipage ltx_align_top" style="width:70.2pt;">
<img src="/html/2104.11493/assets/fig6/img_689_25.jpg" id="S4.F6.sf5.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig6/img_353_25.jpg" id="S4.F6.sf5.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig6/img_368_25.jpg" id="S4.F6.sf5.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf5.5.1.1" class="ltx_text" style="font-size:80%;">(e)</span> </span><span id="S4.F6.sf5.6.2" class="ltx_text" style="font-size:80%;">All (w/o PConv)</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F6.sf6" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F6.sf6.3" class="ltx_block ltx_minipage ltx_align_top" style="width:70.2pt;">
<img src="/html/2104.11493/assets/fig6/img_689_20.jpg" id="S4.F6.sf6.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig6/img_353_20.jpg" id="S4.F6.sf6.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig6/img_368_20.jpg" id="S4.F6.sf6.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf6.5.1.1" class="ltx_text" style="font-size:80%;">(f)</span> </span><span id="S4.F6.sf6.6.2" class="ltx_text" style="font-size:80%;">All</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Visual quality results of ablation study on SCUT-EnsText dataset. From left to right: input images, output of BIPM, output of SMPM+BIPM, output of SMPM+BIPM+SC, output of all (w/o PConv), and output of all. SMPM: Stroke mask prediction module, BIPM: Background inpainting module, PConv: Partial convolutions, SC: Skip connection between two modules, SA: Self-attention block, All: SMPM + BIPM + SC + SA.</figcaption>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Ablation Study and Qualitative Comparison Between Different Configurations of Our Proposed Network on SCUT-Syn and SCUT-EnsText Datasets. SMPM: Stroke Mask Prediction Module, BIPM: Background Inpainting Module, PConv: Partial Convolutions, SC: Skip Connection between Two Modules, SA: Self-attention Block, Dice: Dice Loss, L1: L1 Loss</figcaption>
<table id="S4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T3.1.1.1.1.1" class="ltx_text">Method</span></th>
<td id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="3">SCUT-Syn</td>
<td id="S4.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="3">SCUT-EnsText</td>
</tr>
<tr id="S4.T3.1.2.2" class="ltx_tr">
<td id="S4.T3.1.2.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">PSNR↑</td>
<td id="S4.T3.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">SSIM(%)↑</td>
<td id="S4.T3.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">MSE↓</td>
<td id="S4.T3.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">PSNR↑</td>
<td id="S4.T3.1.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">SSIM(%)↑</td>
<td id="S4.T3.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">MSE↓</td>
</tr>
<tr id="S4.T3.1.3.3" class="ltx_tr">
<th id="S4.T3.1.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">BIPM (w/o PConv)</th>
<td id="S4.T3.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">34.78</td>
<td id="S4.T3.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">96.67</td>
<td id="S4.T3.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.00061</td>
<td id="S4.T3.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">34.62</td>
<td id="S4.T3.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">95.79</td>
<td id="S4.T3.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">0.00114</td>
</tr>
<tr id="S4.T3.1.4.4" class="ltx_tr">
<th id="S4.T3.1.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">SMPM + BIPM</th>
<td id="S4.T3.1.4.4.2" class="ltx_td ltx_align_center">37.74</td>
<td id="S4.T3.1.4.4.3" class="ltx_td ltx_align_center">97.31</td>
<td id="S4.T3.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r">0.00034</td>
<td id="S4.T3.1.4.4.5" class="ltx_td ltx_align_center">36.11</td>
<td id="S4.T3.1.4.4.6" class="ltx_td ltx_align_center">96.31</td>
<td id="S4.T3.1.4.4.7" class="ltx_td ltx_align_center">0.00077</td>
</tr>
<tr id="S4.T3.1.5.5" class="ltx_tr">
<th id="S4.T3.1.5.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">SMPM + BIPM + SC</th>
<td id="S4.T3.1.5.5.2" class="ltx_td ltx_align_center">38.29</td>
<td id="S4.T3.1.5.5.3" class="ltx_td ltx_align_center">97.48</td>
<td id="S4.T3.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r">0.00030</td>
<td id="S4.T3.1.5.5.5" class="ltx_td ltx_align_center">36.36</td>
<td id="S4.T3.1.5.5.6" class="ltx_td ltx_align_center">96.39</td>
<td id="S4.T3.1.5.5.7" class="ltx_td ltx_align_center">0.00070</td>
</tr>
<tr id="S4.T3.1.6.6" class="ltx_tr">
<th id="S4.T3.1.6.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">SMPM + BIPM (w/o PConv) + SC + SA</th>
<td id="S4.T3.1.6.6.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.2.1" class="ltx_text ltx_font_bold">38.70</span></td>
<td id="S4.T3.1.6.6.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.6.6.3.1" class="ltx_text ltx_font_bold">97.67</span></td>
<td id="S4.T3.1.6.6.4" class="ltx_td ltx_align_center ltx_border_r">0.00025</td>
<td id="S4.T3.1.6.6.5" class="ltx_td ltx_align_center">36.49</td>
<td id="S4.T3.1.6.6.6" class="ltx_td ltx_align_center">96.39</td>
<td id="S4.T3.1.6.6.7" class="ltx_td ltx_align_center">0.00073</td>
</tr>
<tr id="S4.T3.1.7.7" class="ltx_tr">
<th id="S4.T3.1.7.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">SMPM + BIPM + SC + SA w/o Dice</th>
<td id="S4.T3.1.7.7.2" class="ltx_td ltx_align_center ltx_border_t">38.58</td>
<td id="S4.T3.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t">97.59</td>
<td id="S4.T3.1.7.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.00026</td>
<td id="S4.T3.1.7.7.5" class="ltx_td ltx_align_center ltx_border_t">36.64</td>
<td id="S4.T3.1.7.7.6" class="ltx_td ltx_align_center ltx_border_t">96.42</td>
<td id="S4.T3.1.7.7.7" class="ltx_td ltx_align_center ltx_border_t">0.00067</td>
</tr>
<tr id="S4.T3.1.8.8" class="ltx_tr">
<th id="S4.T3.1.8.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">SMPM + BIPM + SC + SA w/o L1</th>
<td id="S4.T3.1.8.8.2" class="ltx_td ltx_align_center">38.60</td>
<td id="S4.T3.1.8.8.3" class="ltx_td ltx_align_center">97.61</td>
<td id="S4.T3.1.8.8.4" class="ltx_td ltx_align_center ltx_border_r">0.00026</td>
<td id="S4.T3.1.8.8.5" class="ltx_td ltx_align_center">36.82</td>
<td id="S4.T3.1.8.8.6" class="ltx_td ltx_align_center">96.50</td>
<td id="S4.T3.1.8.8.7" class="ltx_td ltx_align_center">0.00062</td>
</tr>
<tr id="S4.T3.1.9.9" class="ltx_tr">
<th id="S4.T3.1.9.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r">SMPM + BIPM + SC + SA (all)</th>
<td id="S4.T3.1.9.9.2" class="ltx_td ltx_align_center ltx_border_b">38.60</td>
<td id="S4.T3.1.9.9.3" class="ltx_td ltx_align_center ltx_border_b">97.55</td>
<td id="S4.T3.1.9.9.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.1.9.9.4.1" class="ltx_text ltx_font_bold">0.00024</span></td>
<td id="S4.T3.1.9.9.5" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T3.1.9.9.5.1" class="ltx_text ltx_font_bold">37.08</span></td>
<td id="S4.T3.1.9.9.6" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T3.1.9.9.6.1" class="ltx_text ltx_font_bold">96.54</span></td>
<td id="S4.T3.1.9.9.7" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T3.1.9.9.7.1" class="ltx_text ltx_font_bold">0.00054</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS2.SSS2.4.1.1" class="ltx_text">IV-B</span>2 </span>Real-world Dataset</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<ul id="S4.I2" class="ltx_itemize">
<li id="S4.I2.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.ix1.p1" class="ltx_para">
<p id="S4.I2.ix1.p1.1" class="ltx_p"><span id="S4.I2.ix1.p1.1.1" class="ltx_text ltx_font_bold">ICDAR 2013</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> is a widely used scene text images dataset that includes 229 training images and 223 testing images. All text instances were in English and were well-focused. In this study, only the test set was used for the evaluation.</p>
</div>
</li>
<li id="S4.I2.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.ix2.p1" class="ltx_para">
<p id="S4.I2.ix2.p1.1" class="ltx_p"><span id="S4.I2.ix2.p1.1.1" class="ltx_text ltx_font_bold">SCUT-EnsText</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> is a comprehensive and challenging scene text removal dataset, containing 2,749 training images and 813 testing images, which are collected from ICDAR2013 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, ICDAR-2015 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>, MS COCO-Text <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>, SVT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite>, MLT-2019 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>, and ArTs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>. The text instances of this dataset are in Chinese or English with diverse shapes, such as horizontal text, arbitrary quadrilateral text, and curved text. All text instances were carefully erased by annotators with good visual quality. By providing original text annotation and text-erased ground-truth, this dataset can be comprehensively used for both qualitative and quantitative evaluations. In this study, we used this test set to evaluate the performance of the proposed method.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S4.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS2.SSS3.4.1.1" class="ltx_text">IV-B</span>3 </span>Evaluation metrics</h4>

<div id="S4.SS2.SSS3.p1" class="ltx_para">
<ul id="S4.I3" class="ltx_itemize">
<li id="S4.I3.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.ix1.p1" class="ltx_para">
<p id="S4.I3.ix1.p1.1" class="ltx_p"><span id="S4.I3.ix1.p1.1.1" class="ltx_text ltx_font_bold">Quantitative Evaluation</span> To quantify the text erasure ability of a model, we followed <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and utilized a baseline scene text detection model to detect the texts in the text-erased images and evaluated how low are the recall of the detection results. A lower recall indicated that less text was detected, and more text was erased by the model. To make a fair comparison with previous studies, scene text detector EAST and ICDAR 2013 evaluation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> protocols were used in the ICDAR 2013 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, text detector CRAFT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, and ICDAR 2015 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> protocols were adopted in the evaluation of SCUT-EnsText <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
</li>
<li id="S4.I3.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I3.ix2.p1" class="ltx_para">
<p id="S4.I3.ix2.p1.1" class="ltx_p"><span id="S4.I3.ix2.p1.1.1" class="ltx_text ltx_font_bold">Qualitative Evaluation</span> We followed the previous image inpainting works by reporting metrics including peak signal-to-noise ratio (PSNR), the structural similarity index (SSIM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite> and mean squared error (MSE). Higher SSIM, PSNR, and lower MSE values indicate better image restoration quality. Qualitative evaluations were conducted on both the SCUT-Syn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and SCUT-EnsText <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> datasets.</p>
</div>
</li>
</ul>
</div>
<figure id="S4.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F7.sf1.3" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<img src="/html/2104.11493/assets/fig7/img_112_0.png" id="S4.F7.sf1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig7/img_146_0.png" id="S4.F7.sf1.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig7/img_394_0.png" id="S4.F7.sf1.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F7.sf1.5.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S4.F7.sf1.6.2" class="ltx_text" style="font-size:80%;">Input of ours</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F7.sf2.3" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<img src="/html/2104.11493/assets/fig7/img_112_1.png" id="S4.F7.sf2.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig7/img_146_1.png" id="S4.F7.sf2.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig7/img_394_1.png" id="S4.F7.sf2.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F7.sf2.5.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S4.F7.sf2.6.2" class="ltx_text" style="font-size:80%;">Ground-truth</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F7.sf3" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F7.sf3.3" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<img src="/html/2104.11493/assets/fig7/img_112_2.png" id="S4.F7.sf3.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig7/img_146_2.png" id="S4.F7.sf3.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig7/img_394_2.png" id="S4.F7.sf3.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F7.sf3.5.1.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="S4.F7.sf3.6.2" class="ltx_text" style="font-size:80%;">Ours</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F7.sf4" class="ltx_figure ltx_figure_panel ltx_align_center">
<p id="S4.F7.sf4.3.3" class="ltx_p ltx_minipage ltx_align_top" style="width:104.5pt;"><span id="S4.F7.sf4.1.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig7/img_112_3.png" id="S4.F7.sf4.1.1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span>
<span id="S4.F7.sf4.2.2.2" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig7/img_146_3.png" id="S4.F7.sf4.2.2.2.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span>
<span id="S4.F7.sf4.3.3.3" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig7/img_394_3.png" id="S4.F7.sf4.3.3.3.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F7.sf4.5.1.1" class="ltx_text" style="font-size:80%;">(d)</span> </span><span id="S4.F7.sf4.6.2" class="ltx_text" style="font-size:80%;">Predicted text mask</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Qualitative results of our method on the SCUT-Syn dataset. From left to right: input image and text bounding boxes, ground truth, output of our method, and predicted text mask.</figcaption>
</figure>
<figure id="S4.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F8.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F8.sf1.4" class="ltx_block ltx_minipage ltx_align_top" style="width:70.2pt;">
<img src="/html/2104.11493/assets/fig8/img_226_0.jpg" id="S4.F8.sf1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_396_0.jpg" id="S4.F8.sf1.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_707_0.jpg" id="S4.F8.sf1.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_755_0.jpg" id="S4.F8.sf1.4.g4" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F8.sf1.6.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S4.F8.sf1.7.2" class="ltx_text" style="font-size:80%;">Input of ours</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F8.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F8.sf2.4" class="ltx_block ltx_minipage ltx_align_top" style="width:70.2pt;">
<img src="/html/2104.11493/assets/fig8/img_226_1.png" id="S4.F8.sf2.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_396_1.png" id="S4.F8.sf2.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_707_1.png" id="S4.F8.sf2.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_755_1.png" id="S4.F8.sf2.4.g4" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F8.sf2.6.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S4.F8.sf2.7.2" class="ltx_text" style="font-size:80%;">Input of inpainting methods</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F8.sf3" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F8.sf3.4" class="ltx_block ltx_minipage ltx_align_top" style="width:70.2pt;">
<img src="/html/2104.11493/assets/fig8/img_226_2.jpg" id="S4.F8.sf3.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_396_2.jpg" id="S4.F8.sf3.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_707_2.jpg" id="S4.F8.sf3.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_755_2.jpg" id="S4.F8.sf3.4.g4" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F8.sf3.6.1.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="S4.F8.sf3.7.2" class="ltx_text" style="font-size:80%;">Ours</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F8.sf4" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F8.sf4.4" class="ltx_block ltx_minipage ltx_align_top" style="width:70.2pt;">
<img src="/html/2104.11493/assets/fig8/img_226_3.png" id="S4.F8.sf4.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_396_3.png" id="S4.F8.sf4.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_707_3.png" id="S4.F8.sf4.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_755_3.png" id="S4.F8.sf4.4.g4" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F8.sf4.6.1.1" class="ltx_text" style="font-size:80%;">(d)</span> </span><span id="S4.F8.sf4.7.2" class="ltx_text" style="font-size:80%;">LBAM</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F8.sf5" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F8.sf5.4" class="ltx_block ltx_minipage ltx_align_top" style="width:70.2pt;">
<img src="/html/2104.11493/assets/fig8/img_226_4.png" id="S4.F8.sf5.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_396_4.png" id="S4.F8.sf5.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_707_4.png" id="S4.F8.sf5.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_755_4.png" id="S4.F8.sf5.4.g4" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F8.sf5.6.1.1" class="ltx_text" style="font-size:80%;">(e)</span> </span><span id="S4.F8.sf5.7.2" class="ltx_text" style="font-size:80%;">RFR-Net</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S4.F8.sf6" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F8.sf6.4" class="ltx_block ltx_minipage ltx_align_top" style="width:70.2pt;">
<img src="/html/2104.11493/assets/fig8/img_226_5.jpg" id="S4.F8.sf6.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_396_5.jpg" id="S4.F8.sf6.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_707_5.jpg" id="S4.F8.sf6.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig8/img_755_5.jpg" id="S4.F8.sf6.4.g4" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F8.sf6.6.1.1" class="ltx_text" style="font-size:80%;">(f)</span> </span><span id="S4.F8.sf6.7.2" class="ltx_text" style="font-size:80%;">HiFill</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Visual qualitative comparison between our method and state-of-the-art image inpainting methods on the SCUT-EnsText dataset. From left to right: input of our method, input of inpainting methods, output of our method, output of LBAM, output of RFR-Net, and output of HiFiII.</figcaption>
</figure>
<figure id="S4.F9" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F9.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F9.sf1.6" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<img src="/html/2104.11493/assets/fig9/img_489_0.jpg" id="S4.F9.sf1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_479_0.jpg" id="S4.F9.sf1.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_272_0.jpg" id="S4.F9.sf1.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_676_0.jpg" id="S4.F9.sf1.4.g4" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_812_0.jpg" id="S4.F9.sf1.5.g5" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_656_0.jpg" id="S4.F9.sf1.6.g6" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F9.sf1.8.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S4.F9.sf1.9.2" class="ltx_text" style="font-size:80%;">Input</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F9.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F9.sf2.6" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<img src="/html/2104.11493/assets/fig9/img_489_1.jpg" id="S4.F9.sf2.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_479_1.jpg" id="S4.F9.sf2.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_272_1.jpg" id="S4.F9.sf2.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_676_1.jpg" id="S4.F9.sf2.4.g4" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_812_1.jpg" id="S4.F9.sf2.5.g5" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_656_1.jpg" id="S4.F9.sf2.6.g6" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F9.sf2.8.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S4.F9.sf2.9.2" class="ltx_text" style="font-size:80%;">Ground-truth</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F9.sf3" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F9.sf3.6" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<img src="/html/2104.11493/assets/fig9/img_489_2.jpg" id="S4.F9.sf3.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_479_2.jpg" id="S4.F9.sf3.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_272_2.jpg" id="S4.F9.sf3.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_676_2.jpg" id="S4.F9.sf3.4.g4" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_812_2.jpg" id="S4.F9.sf3.5.g5" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig9/img_656_2.jpg" id="S4.F9.sf3.6.g6" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F9.sf3.8.1.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="S4.F9.sf3.9.2" class="ltx_text" style="font-size:80%;">Ours</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F9.sf4" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F9.sf4.6" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<p id="S4.F9.sf4.6.6" class="ltx_p"><span id="S4.F9.sf4.1.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig9/img_489_3.jpg" id="S4.F9.sf4.1.1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span>
<span id="S4.F9.sf4.2.2.2" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig9/img_479_3.jpg" id="S4.F9.sf4.2.2.2.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span>
<span id="S4.F9.sf4.3.3.3" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig9/img_272_3.jpg" id="S4.F9.sf4.3.3.3.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span>
<span id="S4.F9.sf4.4.4.4" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig9/img_676_3.jpg" id="S4.F9.sf4.4.4.4.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span>
<span id="S4.F9.sf4.5.5.5" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig9/img_812_3.jpg" id="S4.F9.sf4.5.5.5.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span>
<span id="S4.F9.sf4.6.6.6" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig9/img_656_3.jpg" id="S4.F9.sf4.6.6.6.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span></p>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F9.sf4.8.1.1" class="ltx_text" style="font-size:80%;">(d)</span> </span><span id="S4.F9.sf4.9.2" class="ltx_text" style="font-size:80%;">Predicted text mask</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Qualitative results of our method on SCUT-EnsText dataset. From left to right: input, ground truth, output of our method, and predicted text mask.</figcaption>
</figure>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Comparison Between Previous Scene Text-erasing Studies and Our Proposed Method on the SCUT-Syn and ICDAR2013 Datasets.</figcaption>
<table id="S4.T4.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.5.6.1" class="ltx_tr">
<th id="S4.T4.5.6.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T4.5.6.1.1.1" class="ltx_text">Method</span></th>
<td id="S4.T4.5.6.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3">SCUT-Syn</td>
<td id="S4.T4.5.6.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ICDAR2013</td>
<td id="S4.T4.5.6.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T4.5.6.1.4.1" class="ltx_text">Parameters</span></td>
<td id="S4.T4.5.6.1.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T4.5.6.1.5.1" class="ltx_text">Inference speed</span></td>
<td id="S4.T4.5.6.1.6" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.T4.5.6.1.6.1" class="ltx_text">Input</span></td>
</tr>
<tr id="S4.T4.5.7.2" class="ltx_tr">
<td id="S4.T4.5.7.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">PSNR↑</td>
<td id="S4.T4.5.7.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">SSIM(%)↑</td>
<td id="S4.T4.5.7.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">MSE↓</td>
<td id="S4.T4.5.7.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">R↓</td>
</tr>
<tr id="S4.T4.5.8.3" class="ltx_tr">
<th id="S4.T4.5.8.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Original images</th>
<td id="S4.T4.5.8.3.2" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S4.T4.5.8.3.3" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S4.T4.5.8.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S4.T4.5.8.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">70.83</td>
<td id="S4.T4.5.8.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S4.T4.5.8.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S4.T4.5.8.3.8" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="S4.T4.5.9.4" class="ltx_tr">
<th id="S4.T4.5.9.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">SceneTextEraser <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</th>
<td id="S4.T4.5.9.4.2" class="ltx_td ltx_align_center">14.68</td>
<td id="S4.T4.5.9.4.3" class="ltx_td ltx_align_center">46.13</td>
<td id="S4.T4.5.9.4.4" class="ltx_td ltx_align_center ltx_border_r">0.7148</td>
<td id="S4.T4.5.9.4.5" class="ltx_td ltx_align_center ltx_border_r">10.08</td>
<td id="S4.T4.5.9.4.6" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S4.T4.5.9.4.7" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S4.T4.5.9.4.8" class="ltx_td ltx_align_center">Image</td>
</tr>
<tr id="S4.T4.5.10.5" class="ltx_tr">
<th id="S4.T4.5.10.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Pix2Pix <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>
</th>
<td id="S4.T4.5.10.5.2" class="ltx_td ltx_align_center">25.60</td>
<td id="S4.T4.5.10.5.3" class="ltx_td ltx_align_center">89.86</td>
<td id="S4.T4.5.10.5.4" class="ltx_td ltx_align_center ltx_border_r">0.2465</td>
<td id="S4.T4.5.10.5.5" class="ltx_td ltx_align_center ltx_border_r">10.19</td>
<td id="S4.T4.5.10.5.6" class="ltx_td ltx_align_center ltx_border_r">54.4M</td>
<td id="S4.T4.5.10.5.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.5.10.5.7.1" class="ltx_text ltx_font_bold">17ms</span></td>
<td id="S4.T4.5.10.5.8" class="ltx_td ltx_align_center">Image</td>
</tr>
<tr id="S4.T4.5.11.6" class="ltx_tr">
<th id="S4.T4.5.11.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">EnsNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>
</th>
<td id="S4.T4.5.11.6.2" class="ltx_td ltx_align_center">37.36</td>
<td id="S4.T4.5.11.6.3" class="ltx_td ltx_align_center">96.44</td>
<td id="S4.T4.5.11.6.4" class="ltx_td ltx_align_center ltx_border_r">0.0021</td>
<td id="S4.T4.5.11.6.5" class="ltx_td ltx_align_center ltx_border_r">5.66</td>
<td id="S4.T4.5.11.6.6" class="ltx_td ltx_align_center ltx_border_r">12.4M</td>
<td id="S4.T4.5.11.6.7" class="ltx_td ltx_align_center ltx_border_r">24ms</td>
<td id="S4.T4.5.11.6.8" class="ltx_td ltx_align_center">Image</td>
</tr>
<tr id="S4.T4.1.1" class="ltx_tr">
<th id="S4.T4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">MTRNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</th>
<td id="S4.T4.1.1.3" class="ltx_td ltx_align_center">29.71</td>
<td id="S4.T4.1.1.4" class="ltx_td ltx_align_center">94.43</td>
<td id="S4.T4.1.1.5" class="ltx_td ltx_align_center ltx_border_r">0.0001</td>
<td id="S4.T4.1.1.6" class="ltx_td ltx_align_center ltx_border_r">0.18</td>
<td id="S4.T4.1.1.7" class="ltx_td ltx_align_center ltx_border_r">54.4M</td>
<td id="S4.T4.1.1.8" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S4.T4.1.1.1" class="ltx_td ltx_align_center">Image(256<math id="S4.T4.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T4.1.1.1.m1.1a"><mo id="S4.T4.1.1.1.m1.1.1" xref="S4.T4.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.m1.1b"><times id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.m1.1c">\times</annotation></semantics></math>256) + Text Mask</td>
</tr>
<tr id="S4.T4.2.2" class="ltx_tr">
<th id="S4.T4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">Weak Supervision <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</th>
<td id="S4.T4.2.2.3" class="ltx_td ltx_align_center">37.44</td>
<td id="S4.T4.2.2.4" class="ltx_td ltx_align_center">93.69</td>
<td id="S4.T4.2.2.5" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S4.T4.2.2.6" class="ltx_td ltx_align_center ltx_border_r">2.47</td>
<td id="S4.T4.2.2.7" class="ltx_td ltx_align_center ltx_border_r">28.7+6.0M</td>
<td id="S4.T4.2.2.8" class="ltx_td ltx_align_center ltx_border_r">57+39ms</td>
<td id="S4.T4.2.2.1" class="ltx_td ltx_align_center">Image(256<math id="S4.T4.2.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T4.2.2.1.m1.1a"><mo id="S4.T4.2.2.1.m1.1.1" xref="S4.T4.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.1.m1.1b"><times id="S4.T4.2.2.1.m1.1.1.cmml" xref="S4.T4.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.1.m1.1c">\times</annotation></semantics></math>256)</td>
</tr>
<tr id="S4.T4.3.3" class="ltx_tr">
<th id="S4.T4.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">MTRNet++ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>
</th>
<td id="S4.T4.3.3.3" class="ltx_td ltx_align_center">34.55</td>
<td id="S4.T4.3.3.4" class="ltx_td ltx_align_center"><span id="S4.T4.3.3.4.1" class="ltx_text ltx_font_bold">98.45</span></td>
<td id="S4.T4.3.3.5" class="ltx_td ltx_align_center ltx_border_r">0.0004</td>
<td id="S4.T4.3.3.6" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S4.T4.3.3.7" class="ltx_td ltx_align_center ltx_border_r">18.7M</td>
<td id="S4.T4.3.3.8" class="ltx_td ltx_align_center ltx_border_r">37ms</td>
<td id="S4.T4.3.3.1" class="ltx_td ltx_align_center">Image(256<math id="S4.T4.3.3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T4.3.3.1.m1.1a"><mo id="S4.T4.3.3.1.m1.1.1" xref="S4.T4.3.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.1.m1.1b"><times id="S4.T4.3.3.1.m1.1.1.cmml" xref="S4.T4.3.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.1.m1.1c">\times</annotation></semantics></math>256)</td>
</tr>
<tr id="S4.T4.5.12.7" class="ltx_tr">
<th id="S4.T4.5.12.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">EraseNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</th>
<td id="S4.T4.5.12.7.2" class="ltx_td ltx_align_center">38.32</td>
<td id="S4.T4.5.12.7.3" class="ltx_td ltx_align_center">97.67</td>
<td id="S4.T4.5.12.7.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.5.12.7.4.1" class="ltx_text ltx_font_bold">0.0002</span></td>
<td id="S4.T4.5.12.7.5" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S4.T4.5.12.7.6" class="ltx_td ltx_align_center ltx_border_r">19.7M</td>
<td id="S4.T4.5.12.7.7" class="ltx_td ltx_align_center ltx_border_r">34ms</td>
<td id="S4.T4.5.12.7.8" class="ltx_td ltx_align_center">Image</td>
</tr>
<tr id="S4.T4.4.4" class="ltx_tr">
<th id="S4.T4.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">EAST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> + Ours</th>
<td id="S4.T4.4.4.3" class="ltx_td ltx_align_center ltx_border_t">31.18</td>
<td id="S4.T4.4.4.4" class="ltx_td ltx_align_center ltx_border_t">95.93</td>
<td id="S4.T4.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.002</td>
<td id="S4.T4.4.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.73</td>
<td id="S4.T4.4.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">24.1+9.9M</td>
<td id="S4.T4.4.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">18+23<math id="S4.T4.4.4.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.T4.4.4.1.m1.1a"><mo id="S4.T4.4.4.1.m1.1.1" xref="S4.T4.4.4.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.1.m1.1b"><csymbol cd="latexml" id="S4.T4.4.4.1.m1.1.1.cmml" xref="S4.T4.4.4.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.1.m1.1c">\sim</annotation></semantics></math>ms</td>
<td id="S4.T4.4.4.8" class="ltx_td ltx_align_center ltx_border_t">Image</td>
</tr>
<tr id="S4.T4.5.5" class="ltx_tr">
<th id="S4.T4.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r">Ours</th>
<td id="S4.T4.5.5.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T4.5.5.3.1" class="ltx_text ltx_font_bold">38.60</span></td>
<td id="S4.T4.5.5.4" class="ltx_td ltx_align_center ltx_border_b">97.55</td>
<td id="S4.T4.5.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.5.5.5.1" class="ltx_text ltx_font_bold">0.0002</span></td>
<td id="S4.T4.5.5.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.5.5.6.1" class="ltx_text ltx_font_bold">0</span></td>
<td id="S4.T4.5.5.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.5.5.7.1" class="ltx_text ltx_font_bold">9.9M</span></td>
<td id="S4.T4.5.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">23<math id="S4.T4.5.5.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.T4.5.5.1.m1.1a"><mo id="S4.T4.5.5.1.m1.1.1" xref="S4.T4.5.5.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.1.m1.1b"><csymbol cd="latexml" id="S4.T4.5.5.1.m1.1.1.cmml" xref="S4.T4.5.5.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.1.m1.1c">\sim</annotation></semantics></math>ms</td>
<td id="S4.T4.5.5.8" class="ltx_td ltx_align_center ltx_border_b">Image + BBox</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.4.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.5.2" class="ltx_text ltx_font_italic">Ablation Study</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">In this section, we investigate the effectiveness of the different settings of the proposed model. The stroke mask prediction module (SMPM), skip connection (SC) between two modules, self-attention block (SA), partial convolutions (PConv), L1 loss, and dice loss are the focus of this study. The qualitative evaluation results on the SCUT-Syn and SCUT-EnsText datasets are presented in Table <a href="#S4.T3" title="TABLE III ‣ IV-B1 Synthetic Dataset ‣ IV-B Dataset and Evaluation Metrics ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>, and some text-erasing samples are shown in Fig. <a href="#S4.F6" title="Figure 6 ‣ IV-B1 Synthetic Dataset ‣ IV-B Dataset and Evaluation Metrics ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
<ul id="S4.I4" class="ltx_itemize">
<li id="S4.I4.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I4.ix1.p1" class="ltx_para">
<p id="S4.I4.ix1.p1.1" class="ltx_p"><span id="S4.I4.ix1.p1.1.1" class="ltx_text ltx_font_bold">Stroke Mask Prediction Module</span> SMPM aims to provide the pixel-level information of text region as the hole for background inpainting Module (BIPM), so that the network can learn more from the valid features of the non-text region and suppress the text residue. The qualitative results are presented in Table <a href="#S4.T3" title="TABLE III ‣ IV-B1 Synthetic Dataset ‣ IV-B Dataset and Evaluation Metrics ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>. Using the text mask can significantly improve the text erasing performance. It should be noted that the partial convolutional layers in the background inpainting module, function as normal convolutional layers without the mask image from the SMPM.</p>
</div>
</li>
<li id="S4.I4.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I4.ix2.p1" class="ltx_para">
<p id="S4.I4.ix2.p1.1" class="ltx_p"><span id="S4.I4.ix2.p1.1.1" class="ltx_text ltx_font_bold">Skip Connection</span> Skip connection links and concatenates the low-resolution feature maps of the two modules to provide the features inside the text region for the decoder of the BIPM and to improve the accuracy and stability of text mask prediction. Table <a href="#S4.T3" title="TABLE III ‣ IV-B1 Synthetic Dataset ‣ IV-B Dataset and Evaluation Metrics ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> implies that the skip connection between the two modules can improve the erasing quality of the image in both the SCUT-Syn and SCUT-EnsText datasets.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE V: </span>Comparison Between State-of-the-art Inpainting Methods and Proposed Method on the SCUT-EnsText Dataset.</figcaption>
<table id="S4.T5.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T5.2.3.1" class="ltx_tr">
<th id="S4.T5.2.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T5.2.3.1.1.1" class="ltx_text">Method</span></th>
<td id="S4.T5.2.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3">SCUT-EnsText</td>
<td id="S4.T5.2.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T5.2.3.1.3.1" class="ltx_text">Parameters</span></td>
<td id="S4.T5.2.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T5.2.3.1.4.1" class="ltx_text">Inference speed</span></td>
<td id="S4.T5.2.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T5.2.3.1.5.1" class="ltx_text">Input</span></td>
<td id="S4.T5.2.3.1.6" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.T5.2.3.1.6.1" class="ltx_text">Training dataset</span></td>
</tr>
<tr id="S4.T5.2.4.2" class="ltx_tr">
<td id="S4.T5.2.4.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">PSNR↑</td>
<td id="S4.T5.2.4.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">SSIM(%)↑</td>
<td id="S4.T5.2.4.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">MSE↓</td>
</tr>
<tr id="S4.T5.2.5.3" class="ltx_tr">
<th id="S4.T5.2.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">LBAM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>
</th>
<td id="S4.T5.2.5.3.2" class="ltx_td ltx_align_center ltx_border_t">36.21</td>
<td id="S4.T5.2.5.3.3" class="ltx_td ltx_align_center ltx_border_t">95.58</td>
<td id="S4.T5.2.5.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.0007</td>
<td id="S4.T5.2.5.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">68.3M</td>
<td id="S4.T5.2.5.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.2.5.3.6.1" class="ltx_text ltx_font_bold">11ms</span></td>
<td id="S4.T5.2.5.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Image(256×256) + Text Mask</td>
<td id="S4.T5.2.5.3.8" class="ltx_td ltx_align_center ltx_border_t">Paris Street View <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>
</td>
</tr>
<tr id="S4.T5.2.6.4" class="ltx_tr">
<th id="S4.T5.2.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">RFR-Net <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>
</th>
<td id="S4.T5.2.6.4.2" class="ltx_td ltx_align_center">36.95</td>
<td id="S4.T5.2.6.4.3" class="ltx_td ltx_align_center">96.12</td>
<td id="S4.T5.2.6.4.4" class="ltx_td ltx_align_center ltx_border_r">0.0006</td>
<td id="S4.T5.2.6.4.5" class="ltx_td ltx_align_center ltx_border_r">31.2M</td>
<td id="S4.T5.2.6.4.6" class="ltx_td ltx_align_center ltx_border_r">90ms</td>
<td id="S4.T5.2.6.4.7" class="ltx_td ltx_align_center ltx_border_r">Image(256×256) + Text Mask</td>
<td id="S4.T5.2.6.4.8" class="ltx_td ltx_align_center">Paris Street View <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>
</td>
</tr>
<tr id="S4.T5.2.7.5" class="ltx_tr">
<th id="S4.T5.2.7.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">HiFill <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
</th>
<td id="S4.T5.2.7.5.2" class="ltx_td ltx_align_center">31.48</td>
<td id="S4.T5.2.7.5.3" class="ltx_td ltx_align_center">94.17</td>
<td id="S4.T5.2.7.5.4" class="ltx_td ltx_align_center ltx_border_r">0.0021</td>
<td id="S4.T5.2.7.5.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T5.2.7.5.5.1" class="ltx_text ltx_font_bold">2.7M</span></td>
<td id="S4.T5.2.7.5.6" class="ltx_td ltx_align_center ltx_border_r">28ms</td>
<td id="S4.T5.2.7.5.7" class="ltx_td ltx_align_center ltx_border_r">Image + Text Mask</td>
<td id="S4.T5.2.7.5.8" class="ltx_td ltx_align_center">Places2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite>
</td>
</tr>
<tr id="S4.T5.1.1" class="ltx_tr">
<th id="S4.T5.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Ours</th>
<td id="S4.T5.1.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.1.1.3.1" class="ltx_text ltx_font_bold">37.89</span></td>
<td id="S4.T5.1.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.1.1.4.1" class="ltx_text ltx_font_bold">97.02</span></td>
<td id="S4.T5.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T5.1.1.5.1" class="ltx_text ltx_font_bold">0.0004</span></td>
<td id="S4.T5.1.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">9.9M</td>
<td id="S4.T5.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">23<math id="S4.T5.1.1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.T5.1.1.1.m1.1a"><mo id="S4.T5.1.1.1.m1.1.1" xref="S4.T5.1.1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.T5.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T5.1.1.1.m1.1.1.cmml" xref="S4.T5.1.1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.1.1.1.m1.1c">\sim</annotation></semantics></math>ms</td>
<td id="S4.T5.1.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Image(256×256) + BBox</td>
<td id="S4.T5.1.1.8" class="ltx_td ltx_align_center ltx_border_t">Improved Synth text</td>
</tr>
<tr id="S4.T5.2.2" class="ltx_tr">
<th id="S4.T5.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r">Ours</th>
<td id="S4.T5.2.2.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T5.2.2.3.1" class="ltx_text ltx_font_bold">37.08</span></td>
<td id="S4.T5.2.2.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T5.2.2.4.1" class="ltx_text ltx_font_bold">96.54</span></td>
<td id="S4.T5.2.2.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T5.2.2.5.1" class="ltx_text ltx_font_bold">0.0005</span></td>
<td id="S4.T5.2.2.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">9.9M</td>
<td id="S4.T5.2.2.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">23<math id="S4.T5.2.2.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.T5.2.2.1.m1.1a"><mo id="S4.T5.2.2.1.m1.1.1" xref="S4.T5.2.2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.T5.2.2.1.m1.1b"><csymbol cd="latexml" id="S4.T5.2.2.1.m1.1.1.cmml" xref="S4.T5.2.2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.2.2.1.m1.1c">\sim</annotation></semantics></math>ms</td>
<td id="S4.T5.2.2.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Image + BBox</td>
<td id="S4.T5.2.2.8" class="ltx_td ltx_align_center ltx_border_b">Improved Synth text</td>
</tr>
</tbody>
</table>
</figure>
</li>
<li id="S4.I4.ix3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I4.ix3.p1" class="ltx_para">
<p id="S4.I4.ix3.p1.1" class="ltx_p"><span id="S4.I4.ix3.p1.1.1" class="ltx_text ltx_font_bold">Self-Attention Block</span> GCblock adds channel-wise weights to the input feature maps taking into consideration the correspondences between feature maps and non-local features. To confirm the importance of the self-attention block, we trained our network without the SA block. In Table <a href="#S4.T3" title="TABLE III ‣ IV-B1 Synthetic Dataset ‣ IV-B Dataset and Evaluation Metrics ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>, we see that the performance of our network decreases when the self-attention block is missing.</p>
</div>
</li>
<li id="S4.I4.ix4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I4.ix4.p1" class="ltx_para">
<p id="S4.I4.ix4.p1.1" class="ltx_p"><span id="S4.I4.ix4.p1.1.1" class="ltx_text ltx_font_bold">Partial Convolutions</span> To evaluate the advantages of the partial convolutional layers, we also re-implemented our method without these layers. Table <a href="#S4.T3" title="TABLE III ‣ IV-B1 Synthetic Dataset ‣ IV-B Dataset and Evaluation Metrics ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> lists the qualitative performance of the SCUT-Syn and SCUT-EnsText datasets. We observed that, compared to a network with partial convolutional layers, the network with partial convolutional layers performs better on SCUT-EnsText but worse on SCUT-Syn datasets. We believe that the discrepancies between synthetic data and real-world data are the cause for this difference in performance. As mentioned before, the reason for improving the Synth-text engine is that Poisson image editing retains some texture information of the background image when it blends the foreground text instances into a background image. However, most scene text instances in real-world images are not transparent. For the erasure result on SCUT-Syn datasets, compared with directly extracting features using normal convolution, using partial convolution and <math id="S4.I4.ix4.p1.1.m1.1" class="ltx_Math" alttext="F_{m}" display="inline"><semantics id="S4.I4.ix4.p1.1.m1.1a"><msub id="S4.I4.ix4.p1.1.m1.1.1" xref="S4.I4.ix4.p1.1.m1.1.1.cmml"><mi id="S4.I4.ix4.p1.1.m1.1.1.2" xref="S4.I4.ix4.p1.1.m1.1.1.2.cmml">F</mi><mi id="S4.I4.ix4.p1.1.m1.1.1.3" xref="S4.I4.ix4.p1.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I4.ix4.p1.1.m1.1b"><apply id="S4.I4.ix4.p1.1.m1.1.1.cmml" xref="S4.I4.ix4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I4.ix4.p1.1.m1.1.1.1.cmml" xref="S4.I4.ix4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I4.ix4.p1.1.m1.1.1.2.cmml" xref="S4.I4.ix4.p1.1.m1.1.1.2">𝐹</ci><ci id="S4.I4.ix4.p1.1.m1.1.1.3.cmml" xref="S4.I4.ix4.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I4.ix4.p1.1.m1.1c">F_{m}</annotation></semantics></math> feature concatenation to split the features inside and outside the text region is a relatively inefficient approach for transparent text erasure. However, when facing the real-world data such as SCUT-EnsText, using partial convolution can achieve better performance than normal convolution.</p>
</div>
</li>
<li id="S4.I4.ix5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I4.ix5.p1" class="ltx_para">
<p id="S4.I4.ix5.p1.1" class="ltx_p"><span id="S4.I4.ix5.p1.1.1" class="ltx_text ltx_font_bold">L1 Loss and Dice Loss</span> To confirm the contribution of these two losses in SMPM, we trained our whole network with single L1 loss or dice loss and compared the final erasure result with all. In Table <a href="#S4.T3" title="TABLE III ‣ IV-B1 Synthetic Dataset ‣ IV-B Dataset and Evaluation Metrics ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>, we observe that our network with the L1 loss and dice loss combination achieved better results on the real-world dataset.</p>
</div>
</li>
</ul>
</div>
<figure id="S4.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>Comparison Between State-of-the-art Scene Text-erasing Methods and Proposed Method on the SCUT-EnsText Dataset. Re: We Re-implemented this Method.</figcaption>
<table id="S4.T6.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T6.3.4.1" class="ltx_tr">
<th id="S4.T6.3.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T6.3.4.1.1.1" class="ltx_text">Method</span></th>
<td id="S4.T6.3.4.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3">Qualitative eval</td>
<td id="S4.T6.3.4.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Quantitative eval</td>
<td id="S4.T6.3.4.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T6.3.4.1.4.1" class="ltx_text">Parameters</span></td>
<td id="S4.T6.3.4.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T6.3.4.1.5.1" class="ltx_text">Inference speed</span></td>
<td id="S4.T6.3.4.1.6" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.T6.3.4.1.6.1" class="ltx_text">Input</span></td>
</tr>
<tr id="S4.T6.3.5.2" class="ltx_tr">
<td id="S4.T6.3.5.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">PSNR↑</td>
<td id="S4.T6.3.5.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">SSIM(%)↑</td>
<td id="S4.T6.3.5.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">MSE↓</td>
<td id="S4.T6.3.5.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">R↓</td>
</tr>
<tr id="S4.T6.3.6.3" class="ltx_tr">
<th id="S4.T6.3.6.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Original images</th>
<td id="S4.T6.3.6.3.2" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S4.T6.3.6.3.3" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S4.T6.3.6.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S4.T6.3.6.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">69.5</td>
<td id="S4.T6.3.6.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S4.T6.3.6.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S4.T6.3.6.3.8" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="S4.T6.3.7.4" class="ltx_tr">
<th id="S4.T6.3.7.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">SceneTextEraser <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</th>
<td id="S4.T6.3.7.4.2" class="ltx_td ltx_align_center">25.47</td>
<td id="S4.T6.3.7.4.3" class="ltx_td ltx_align_center">90.14</td>
<td id="S4.T6.3.7.4.4" class="ltx_td ltx_align_center ltx_border_r">0.0047</td>
<td id="S4.T6.3.7.4.5" class="ltx_td ltx_align_center ltx_border_r">5.9</td>
<td id="S4.T6.3.7.4.6" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S4.T6.3.7.4.7" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S4.T6.3.7.4.8" class="ltx_td ltx_align_center">Image</td>
</tr>
<tr id="S4.T6.3.8.5" class="ltx_tr">
<th id="S4.T6.3.8.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">EnsNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>
</th>
<td id="S4.T6.3.8.5.2" class="ltx_td ltx_align_center">29.54</td>
<td id="S4.T6.3.8.5.3" class="ltx_td ltx_align_center">92.74</td>
<td id="S4.T6.3.8.5.4" class="ltx_td ltx_align_center ltx_border_r">0.0024</td>
<td id="S4.T6.3.8.5.5" class="ltx_td ltx_align_center ltx_border_r">32.8</td>
<td id="S4.T6.3.8.5.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T6.3.8.5.6.1" class="ltx_text ltx_font_bold">12.4M</span></td>
<td id="S4.T6.3.8.5.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T6.3.8.5.7.1" class="ltx_text ltx_font_bold">24ms</span></td>
<td id="S4.T6.3.8.5.8" class="ltx_td ltx_align_center">Image</td>
</tr>
<tr id="S4.T6.3.9.6" class="ltx_tr">
<th id="S4.T6.3.9.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">EraseNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</th>
<td id="S4.T6.3.9.6.2" class="ltx_td ltx_align_center">32.30</td>
<td id="S4.T6.3.9.6.3" class="ltx_td ltx_align_center">95.42</td>
<td id="S4.T6.3.9.6.4" class="ltx_td ltx_align_center ltx_border_r">0.0015</td>
<td id="S4.T6.3.9.6.5" class="ltx_td ltx_align_center ltx_border_r">4.6</td>
<td id="S4.T6.3.9.6.6" class="ltx_td ltx_align_center ltx_border_r">19.7M</td>
<td id="S4.T6.3.9.6.7" class="ltx_td ltx_align_center ltx_border_r">34ms</td>
<td id="S4.T6.3.9.6.8" class="ltx_td ltx_align_center">Image</td>
</tr>
<tr id="S4.T6.3.10.7" class="ltx_tr">
<th id="S4.T6.3.10.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">EraseNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> (Re)</th>
<td id="S4.T6.3.10.7.2" class="ltx_td ltx_align_center">32.64</td>
<td id="S4.T6.3.10.7.3" class="ltx_td ltx_align_center">95.13</td>
<td id="S4.T6.3.10.7.4" class="ltx_td ltx_align_center ltx_border_r">0.0017</td>
<td id="S4.T6.3.10.7.5" class="ltx_td ltx_align_center ltx_border_r">5.4</td>
<td id="S4.T6.3.10.7.6" class="ltx_td ltx_align_center ltx_border_r">19.7M</td>
<td id="S4.T6.3.10.7.7" class="ltx_td ltx_align_center ltx_border_r">34ms</td>
<td id="S4.T6.3.10.7.8" class="ltx_td ltx_align_center">Image</td>
</tr>
<tr id="S4.T6.3.11.8" class="ltx_tr">
<th id="S4.T6.3.11.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">DB-ResNet-50 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> + EraseNet (Re)</th>
<td id="S4.T6.3.11.8.2" class="ltx_td ltx_align_center">32.70</td>
<td id="S4.T6.3.11.8.3" class="ltx_td ltx_align_center">95.18</td>
<td id="S4.T6.3.11.8.4" class="ltx_td ltx_align_center ltx_border_r">0.0021</td>
<td id="S4.T6.3.11.8.5" class="ltx_td ltx_align_center ltx_border_r">12.3</td>
<td id="S4.T6.3.11.8.6" class="ltx_td ltx_align_center ltx_border_r">26.1+19.7M</td>
<td id="S4.T6.3.11.8.7" class="ltx_td ltx_align_center ltx_border_r">37+34ms</td>
<td id="S4.T6.3.11.8.8" class="ltx_td ltx_align_center">Image</td>
</tr>
<tr id="S4.T6.3.12.9" class="ltx_tr">
<th id="S4.T6.3.12.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">CRAFT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> + EraseNet (Re)</th>
<td id="S4.T6.3.12.9.2" class="ltx_td ltx_align_center">34.15</td>
<td id="S4.T6.3.12.9.3" class="ltx_td ltx_align_center">95.66</td>
<td id="S4.T6.3.12.9.4" class="ltx_td ltx_align_center ltx_border_r">0.0015</td>
<td id="S4.T6.3.12.9.5" class="ltx_td ltx_align_center ltx_border_r">7.3</td>
<td id="S4.T6.3.12.9.6" class="ltx_td ltx_align_center ltx_border_r">20.7+19.7M</td>
<td id="S4.T6.3.12.9.7" class="ltx_td ltx_align_center ltx_border_r">120+34ms</td>
<td id="S4.T6.3.12.9.8" class="ltx_td ltx_align_center">Image</td>
</tr>
<tr id="S4.T6.1.1" class="ltx_tr">
<th id="S4.T6.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">DB-ResNet-18 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> + Ours</th>
<td id="S4.T6.1.1.3" class="ltx_td ltx_align_center ltx_border_t">33.17</td>
<td id="S4.T6.1.1.4" class="ltx_td ltx_align_center ltx_border_t">95.44</td>
<td id="S4.T6.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.0020</td>
<td id="S4.T6.1.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10.3</td>
<td id="S4.T6.1.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">12.6+9.9M</td>
<td id="S4.T6.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">17+27<math id="S4.T6.1.1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.T6.1.1.1.m1.1a"><mo id="S4.T6.1.1.1.m1.1.1" xref="S4.T6.1.1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.T6.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T6.1.1.1.m1.1.1.cmml" xref="S4.T6.1.1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.1.1.1.m1.1c">\sim</annotation></semantics></math>ms</td>
<td id="S4.T6.1.1.8" class="ltx_td ltx_align_center ltx_border_t">Image</td>
</tr>
<tr id="S4.T6.2.2" class="ltx_tr">
<th id="S4.T6.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">DB-ResNet-50 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> + Ours</th>
<td id="S4.T6.2.2.3" class="ltx_td ltx_align_center">33.54</td>
<td id="S4.T6.2.2.4" class="ltx_td ltx_align_center">95.57</td>
<td id="S4.T6.2.2.5" class="ltx_td ltx_align_center ltx_border_r">0.0018</td>
<td id="S4.T6.2.2.6" class="ltx_td ltx_align_center ltx_border_r">10.5</td>
<td id="S4.T6.2.2.7" class="ltx_td ltx_align_center ltx_border_r">26.1+9.9M</td>
<td id="S4.T6.2.2.1" class="ltx_td ltx_align_center ltx_border_r">37+27<math id="S4.T6.2.2.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.T6.2.2.1.m1.1a"><mo id="S4.T6.2.2.1.m1.1.1" xref="S4.T6.2.2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.T6.2.2.1.m1.1b"><csymbol cd="latexml" id="S4.T6.2.2.1.m1.1.1.cmml" xref="S4.T6.2.2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.2.2.1.m1.1c">\sim</annotation></semantics></math>ms</td>
<td id="S4.T6.2.2.8" class="ltx_td ltx_align_center">Image</td>
</tr>
<tr id="S4.T6.3.3" class="ltx_tr">
<th id="S4.T6.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r">CRAFT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> + Ours</th>
<td id="S4.T6.3.3.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T6.3.3.3.1" class="ltx_text ltx_font_bold">35.34</span></td>
<td id="S4.T6.3.3.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T6.3.3.4.1" class="ltx_text ltx_font_bold">96.24</span></td>
<td id="S4.T6.3.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T6.3.3.5.1" class="ltx_text ltx_font_bold">0.0009</span></td>
<td id="S4.T6.3.3.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T6.3.3.6.1" class="ltx_text ltx_font_bold">3.6</span></td>
<td id="S4.T6.3.3.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">20.7+9.9M</td>
<td id="S4.T6.3.3.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">120+27<math id="S4.T6.3.3.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S4.T6.3.3.1.m1.1a"><mo id="S4.T6.3.3.1.m1.1.1" xref="S4.T6.3.3.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.T6.3.3.1.m1.1b"><csymbol cd="latexml" id="S4.T6.3.3.1.m1.1.1.cmml" xref="S4.T6.3.3.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.3.3.1.m1.1c">\sim</annotation></semantics></math>ms</td>
<td id="S4.T6.3.3.8" class="ltx_td ltx_align_center ltx_border_b">Image</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.4.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.5.2" class="ltx_text ltx_font_italic">Comparison With State-of-the-Art Methods</span>
</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">To evaluate the performance of our proposed method, we compared it with recent state-of-the-art methods on the SCUT-Syn, ICDAR2013, and SCUT-EnsText datasets. For the SCUT-Syn and ICDAR2013 datasets, the results of SceneTextEraser, Pix2Pix, and EnsNet were implemented and reported by Zhang <span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. The results of MTRNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, weak supervision <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, MTRNet++ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, and EraseNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> were collected from official reports. If there is no specific description, the resolution of the input image is <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="512\times 512" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mrow id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mn id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">512</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS4.p1.1.m1.1.1.1" xref="S4.SS4.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><times id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1.1"></times><cn type="integer" id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">512</cn><cn type="integer" id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">512\times 512</annotation></semantics></math>. Table <a href="#S4.T4" title="TABLE IV ‣ IV-B3 Evaluation metrics ‣ IV-B Dataset and Evaluation Metrics ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> displays the results for the SCUT-Syn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and ICDAR2013 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> datasets. Our proposed method achieves the highest PSNR on the SCUT-Syn dataset and the lowest recall on the ICDAR2013 dataset when the bounding boxes are provided. Some text-erasing examples on the SCUT-Syn dataset are shown in Fig. <a href="#S4.F7" title="Figure 7 ‣ IV-B3 Evaluation metrics ‣ IV-B Dataset and Evaluation Metrics ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. Our method achieves lower recall on the ICDAR2013 dataset when the detection result of EAST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> is used to provide text location. Here, R represents recall, which is the detection result of the EAST under the ICDAR2013 evaluation protocol. We believe the reason why MTRNet++, EraseNet, and EnsNet could generate higher SSIM images on the SCUT-Syn dataset is because most test images are included in the training set, and share the same background images with training images when they are generated. The EAST and our model were not trained on the SCUT-Syn training set, thereby resulting in a lower PSNR and SSIM. We believe that this dataset cannot fully reflect the generalization ability of a network when it is used for training. Our text-erasing network is lightweight with only 9.9 million trainable parameters. For a fair comparison of the inference speed, we tested all methods using a single 1080ti GPU and an AMD Ryzen7 3700X @ 3.6GHz CPU with the original input size of the networks. The inference time of our method consisted of the time cost of the network forward, pre-processing, and post-processing. The time cost of pre-processing and post-processing was approximately 4 ms in the case of using perspective transformation and 76 ms in the case of using off-the-shell thin-plate-spline function in OpenCV.</p>
</div>
<figure id="S4.F10" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F10.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F10.sf1.4" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<img src="/html/2104.11493/assets/fig10/img_563_0.jpg" id="S4.F10.sf1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig10/img_428_0.jpg" id="S4.F10.sf1.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig10/img_144_0.jpg" id="S4.F10.sf1.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig10/img_390_0.jpg" id="S4.F10.sf1.4.g4" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F10.sf1.6.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S4.F10.sf1.7.2" class="ltx_text" style="font-size:80%;">Input</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F10.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F10.sf2.4" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<img src="/html/2104.11493/assets/fig10/img_563_1.jpg" id="S4.F10.sf2.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig10/img_428_1.jpg" id="S4.F10.sf2.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig10/img_144_1.jpg" id="S4.F10.sf2.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig10/img_390_1.jpg" id="S4.F10.sf2.4.g4" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F10.sf2.6.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S4.F10.sf2.7.2" class="ltx_text" style="font-size:80%;">Ground-truth</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F10.sf3" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F10.sf3.4" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<img src="/html/2104.11493/assets/fig10/img_563_2.jpg" id="S4.F10.sf3.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig10/img_428_2.jpg" id="S4.F10.sf3.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig10/img_144_2.jpg" id="S4.F10.sf3.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig10/img_390_2.jpg" id="S4.F10.sf3.4.g4" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F10.sf3.6.1.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="S4.F10.sf3.7.2" class="ltx_text" style="font-size:80%;">Ours</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F10.sf4" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F10.sf4.4" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<p id="S4.F10.sf4.4.4" class="ltx_p"><span id="S4.F10.sf4.1.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig10/img_563_3.jpg" id="S4.F10.sf4.1.1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span>
<span id="S4.F10.sf4.2.2.2" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig10/img_428_3.jpg" id="S4.F10.sf4.2.2.2.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span>
<span id="S4.F10.sf4.3.3.3" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig10/img_144_3.jpg" id="S4.F10.sf4.3.3.3.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span>
<span id="S4.F10.sf4.4.4.4" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig10/img_390_3.jpg" id="S4.F10.sf4.4.4.4.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span></p>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F10.sf4.6.1.1" class="ltx_text" style="font-size:80%;">(d)</span> </span><span id="S4.F10.sf4.7.2" class="ltx_text" style="font-size:80%;">Predicted text mask</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Our method can retain more detailed background information and restore the background texture. From left to right: input image and text bounding boxes, ground truth, output of our method, and predicted text mask.</figcaption>
</figure>
<figure id="S4.F11" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F11.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F11.sf1.3" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<img src="/html/2104.11493/assets/fig11/img_747_0.jpg" id="S4.F11.sf1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig11/img_708_0.jpg" id="S4.F11.sf1.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig11/img_58_0.jpg" id="S4.F11.sf1.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F11.sf1.5.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S4.F11.sf1.6.2" class="ltx_text" style="font-size:80%;">Input</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F11.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F11.sf2.3" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<img src="/html/2104.11493/assets/fig11/img_747_1.jpg" id="S4.F11.sf2.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig11/img_708_1.jpg" id="S4.F11.sf2.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig11/img_58_1.jpg" id="S4.F11.sf2.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F11.sf2.5.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S4.F11.sf2.6.2" class="ltx_text" style="font-size:80%;">Ground-truth</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F11.sf3" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F11.sf3.3" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<img src="/html/2104.11493/assets/fig11/img_747_2.jpg" id="S4.F11.sf3.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig11/img_708_2.jpg" id="S4.F11.sf3.2.g2" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"><img src="/html/2104.11493/assets/fig11/img_58_2.jpg" id="S4.F11.sf3.3.g3" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F11.sf3.5.1.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="S4.F11.sf3.6.2" class="ltx_text" style="font-size:80%;">Ours</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F11.sf4" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S4.F11.sf4.3" class="ltx_block ltx_minipage ltx_align_top" style="width:104.5pt;">
<p id="S4.F11.sf4.3.3" class="ltx_p"><span id="S4.F11.sf4.1.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig11/img_747_3.jpg" id="S4.F11.sf4.1.1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span>
<span id="S4.F11.sf4.2.2.2" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig11/img_708_3.jpg" id="S4.F11.sf4.2.2.2.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span>
<span id="S4.F11.sf4.3.3.3" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2104.11493/assets/fig11/img_58_3.jpg" id="S4.F11.sf4.3.3.3.g1" class="ltx_graphics ltx_img_square" width="598" height="509" alt="Refer to caption"></span></p>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F11.sf4.5.1.1" class="ltx_text" style="font-size:80%;">(d)</span> </span><span id="S4.F11.sf4.6.2" class="ltx_text" style="font-size:80%;">Predicted text mask</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Some failure cases of our method. From left to right: input image and text bounding boxes, ground truth, output of our method, and predicted text mask.</figcaption>
</figure>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">For the SCUT-EnsText dataset, we compared our method with state-of-the-art image inpainting methods and scene text erasing methods. The results of the comparison with the inpainting methods of the SCUT-EnsText dataset are shown in Table <a href="#S4.T5" title="TABLE V ‣ item • ‣ IV-C Ablation Study ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>. Our scene text erasing method achieves excellent results in image quality when text bounding box information is provided.
We made some revisions to the original text location annotation because we observed some unmatched cases between the location of the erased text and the text bounding box of the ground truth. We selected three state-of-the-art image inpainting methods: LBAM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, RFR-Net <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, and HiFill <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. The LBAM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> and RFR-Net <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> models were pretrained on the Paris Street View dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, and the HiFill <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> model was pretrained on the Places2 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite>. For a fair comparison with the pretrained inpainting methods, we generated the hole mask directly from our revised text location annotations and resized the input images to the same size because some pretrained inpainting models only work at a resolution of 256<math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><mo id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><times id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">\times</annotation></semantics></math>256. Our method generated images with higher quality than that of the state-of-the-art image inpainting methods under the same conditions. Some samples are presented for visual quality comparison in Fig. <a href="#S4.F8" title="Figure 8 ‣ IV-B3 Evaluation metrics ‣ IV-B Dataset and Evaluation Metrics ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. We observed that there are certain unusual textures or artifacts in the text-erased images inpainted via pretrained image inpainting methods, causing unnatural erasure results. We also found the inpainting logic of HiFill <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, a preference for restoring the hole region with further background information is displayed, leading to worse results than those obtained using the other two methods. Although this model is pretrained on the Places2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> dataset, which contains many indoor and urban views, it still presents a serious domain shift problem when facing scene-text-erasing tasks.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.1" class="ltx_p">In addition, we used our method with a pretrained scene text detector as a two-step automatic scene text eraser. In our experiment, we used DB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> and CRAFT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> for scene text detection and produced arbitrary quadrilateral bounding boxes as the input for our method. DB-ResNet-18 and DB-ResNet-50 were pretrained in the SynthText and ICDAR 2015 datasets with the box threshold set at 0.3. CRAFT was pretrained on the SynthText, ICDAR 2013, and MLT 2017 datasets, and the text threshold was set to 0.6. We compared our proposed methods with previous scene text erasing methods on the SCUT-EnsText dataset. For a fair comparison with one-step methods, such as EraseNet, we carefully re-implemented EraseNet and replaced the background regions of the output of EraseNet with the original images according to the detection results of the scene text detector. The results are shown in Table <a href="#S4.T6" title="TABLE VI ‣ IV-C Ablation Study ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a> and imply that the results of the first detection followed by inpainting via our method are significantly superior to those of existing state-of-the-art one-step methods in both qualitative and quantitative evaluations. Here, R denotes the recall, which is the detection result of the CRAFT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> under the ICDAR2015 evaluation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> protocol. Overall, compared with a single EraseNet, using an auxiliary scene text detector with the one-step method could help increase the quality of the output images by replacing excessive erasure of text-free areas with content from original images. On the other hand, this operation could also restore some text-erased instances to their original status because of the limited detection ability of the text detector, resulting in an increase in recall. Some qualitative results of our method on the SCUT-EnsText dataset are shown in Fig. <a href="#S4.F9" title="Figure 9 ‣ IV-B3 Evaluation metrics ‣ IV-B Dataset and Evaluation Metrics ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. Our method can clearly remove the text region, regardless of whether the text instances have varying shapes, fonts, or illumination conditions. Nonetheless, compared with one-step end-to-end scene text erasing methods, the inference speed of our two-step cropped-images-based pipeline is relatively slow, as shown in Table <a href="#S4.T6" title="TABLE VI ‣ IV-C Ablation Study ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a>.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS5.4.1.1" class="ltx_text">IV-E</span> </span><span id="S4.SS5.5.2" class="ltx_text ltx_font_italic">Discussion</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">From the experimental results, we observe that the model trained using our improved synthetic text dataset displays a different inpainting logic than that of the annotations of the real-world scene-text removal dataset, which was manually edited using Photoshop. As shown in Fig. <a href="#S4.F10" title="Figure 10 ‣ IV-D Comparison With State-of-the-Art Methods ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, our method can erase text while retaining more detailed background information of the image. In addition, owing to the model design and a large amount of training data, our method was able to reconstruct some background texture for better visual perception.
However, because of the limited text style of the synthetic text engine, the method failed during text erasing in case of text oriented in special shape or the stereoscopic text under complicated illumination conditions, as depicted in Fig. <a href="#S4.F11" title="Figure 11 ‣ IV-D Comparison With State-of-the-Art Methods ‣ IV Experiment ‣ Stroke-Based Scene Text Erasing Using Synthetic Data for Training" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>. Because we propose erasing word-level text in cropped images, our method encountered some difficulty in erasing small text instances in the images. As there are always JPEG boundary artifacts surrounding the text edge, our model cannot significantly discriminate whether the pixel near the text edge belongs to the background or to the artifact. Borrowing features from artifact regions can result in a text region being inpainted by strange colors, yielding poor inpainting results.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.1" class="ltx_p">When using scene text detector working with our method, the quality of the generated text bounding boxes also affects the quality of text erasure. Text instances partially covered by bounding boxes can result in residues of text outside boxes, because in our experimental setting, only the region inside the text bounding boxes are replaced by the output of our network. Moreover, curved text, bounded by poor quality polygons, will be heavily distorted after TPS transformation, which makes the prediction of stroke mask more difficult, resulting in poor text erasure. In contrast, curved text, with good polygon annotation, usually leads to high-quality erasing. In our evaluation, we found that using perspective transformation and quadrilateral bounding boxes is the safest way to maintain high-quality erasure on average.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this study, we propose a novel scene text erasing method that addresses the weak text location problem of one-step methods and the domain shift problem of using inpainting models pretrained on street view or Places datasets. To this end, our model was trained using only our improved synthetic text dataset. The model inpaints the text region based on a predicted text stroke mask derived from cropped text images, whereby more background information can be preserved. By utilizing a stroke mask prediction module, partial convolution layers, an attention block in the background inpainting module, and skip connection between two modules, our method can reasonably erase scene text with texture restoration. Using a pretrained scene text detector to provide text location information, our model can function as an automatic scene text eraser to remove text from the wild. Overall, our experimental results show that our method performs better than existing state-of-the-art methods.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
T. Nakamura, A. Zhu, K. Yanai, and S. Uchida, “Scene Text Eraser,” in
<em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. Doc. Anal. Recognit.</em>, vol. 1, 2017, pp. 832–837.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
O. Tursun, S. Denman, R. Zeng, S. Sivapalan, S. Sridharan, and C. Fookes,
“MTRNet++: One-stage mask-based scene text eraser,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Comput. Vis.
Image Underst.</em>, vol. 201, p. 103066, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
S. Zhang, Y. Liu, L. Jin, Y. Huang, and S. Lai, “EnsNet: Ensconce Text in the
Wild,” in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proc. AAAI Conf. Artif. Intell.</em>, vol. 33, 2019, pp.
801–808.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
C. Liu, Y. Liu, L. Jin, S. Zhang, C. Luo, and Y. Wang, “EraseNet: End-to-End
Text Removal in the Wild,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. Image Process.</em>, vol. 29, pp.
8760–8775, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
A. Gupta, A. Vedaldi, and A. Zisserman, “Synthetic Data for Text Localisation
in Natural Images,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE Conf. Comput. Vis. Pattern
Recognit.</em>, 2016, pp. 2315–2324.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
X. Bian, C. Wang, W. Quan, J. Ye, X. Zhang, and D.-M. Yan, “Scene text
removal via cascaded text stroke detection and erasing,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv</em>,
2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
O. Tursun, R. Zeng, S. Denman, S. Sivapalan, S. Sridharan, and C. Fookes,
“MTRNet: A Generic Scene Text Eraser,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. Doc.
Anal. Recognit.</em>, 2019, pp. 39–44.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
J. Zdenek and H. Nakayama, “Erasing Scene Text with Weak Supervision,” in
<em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE Winter Conf. Appl. Comput. Vis.</em>, 2020, pp. 2227–2235.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
C. Doersch, S. Singh, A. Gupta, J. Sivic, and A. A. Efros, “What makes Paris
look like Paris?” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">ACM Trans. Graph.</em>, vol. 31, no. 4, pp. 1–9, 2012.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
O. Russakovsky, J. Deng, H. Su, J. Krause, S. Satheesh, S. Ma, Z. Huang,
A. Karpathy, A. Khosla, M. Bernstein, A. C. Berg, and L. Fei-Fei, “ImageNet
Large Scale Visual Recognition Challenge,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Int. J. Comput. Vis.</em>,
vol. 115, no. 3, pp. 211–252, 2015.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
D. Karatzas, F. Shafait, S. Uchida, M. Iwamura, L. G. I. Bigorda, S. R. Mestre,
J. Mas, D. F. Mota, J. A. Almazan, and L. P. de las Heras, “ICDAR 2013
Robust Reading Competition,” in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proc. 12th Int. Conf. Doc. Anal.
Recognit.</em>, 2013, pp. 1484–1493.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Xiangrong Chen and A. Yuille, “Detecting and reading text in natural
scenes,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE Comput. Soc. Conf. Comput. Vis. Pattern
Recognit.</em>, vol. 2, 2004, pp. 366–373.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
L. Neumann and J. Matas, “A method for text localization and recognition in
real-world images,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proc. Asian Conf. Comput. Vis.</em>, vol. 6494,
2011, pp. 770–783.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
A. Jamil, I. Siddiqi, F. Arif, and A. Raza, “Edge-Based Features for
Localization of Artificial Urdu Text in Video Images,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proc. Int.
Conf. Doc. Anal. Recognit.</em>, 2011, pp. 1120–1124.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
A. Mosleh, N. Bouguila, and A. B. Hamza, “Automatic inpainting scheme for
video text detection and removal,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. Image Process.</em>,
vol. 22, no. 11, pp. 4460–4472, 2013.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
W. Huang, Z. Lin, J. Yang, and J. Wang, “Text Localization in Natural Images
Using Stroke Feature Transform and Text Covariance Descriptors,” in
<em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE Int. Conf. Comput. Vis.</em>, 2013, pp. 1241–1248.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
M. Liao, B. Shi, X. Bai, X. Wang, and W. Liu, “TextBoxes: A fast text
detector with a single deep neural network,” in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proc. AAAI Conf.
Artif. Intell.</em>, 2017, pp. 4161–4167.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
W. Liu, D. Anguelov, D. Erhan, C. Szegedy, S. Reed, C. Y. Fu, and A. C. Berg,
“SSD: Single shot multibox detector,” in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proc. Eur. Conf. Comput.
Vis.</em>, vol. 9905, 2016, pp. 21–37.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Z. Tian, W. Huang, T. He, P. He, and Y. Qiao, “Detecting text in natural
image with connectionist text proposal network,” in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proc. Eur. Conf.
Comput. Vis.</em>, vol. 9912, 2016, pp. 56–72.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
S. Ren, K. He, R. Girshick, and J. Sun, “Faster R-CNN: Towards real-time
object detection with region proposal networks,” in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proc. Adv. Neural
Inf. Process. Syst.</em>, 2015, pp. 91–99.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
J. Ma, W. Shao, H. Ye, L. Wang, H. Wang, Y. Zheng, and X. Xue,
“Arbitrary-Oriented Scene Text Detection via Rotation Proposals,”
<em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. Multimed.</em>, vol. 20, no. 11, pp. 3111–3122, 2018.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
X. Zhou, C. Yao, H. Wen, Y. Wang, S. Zhou, W. He, and J. Liang, “EAST: An
Efficient and Accurate Scene Text Detector,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE Conf.
Comput. Vis. Pattern Recognit.</em>, 2017, pp. 2642–2651.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
C. Zhang, B. Liang, Z. Huang, M. En, J. Han, E. Ding, and X. Ding, “Look More
Than Once: An Accurate Detector for Text of Arbitrary Shapes,” in
<em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conf. Comput. Vis. Pattern Recognit.</em>, 2019, pp.
10 544–10 553.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Z. Zhang, C. Zhang, W. Shen, C. Yao, W. Liu, and X. Bai, “Multi-oriented Text
Detection with Fully Convolutional Networks,” in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE Conf.
Comput. Vis. Pattern Recognit.</em>, 2016, pp. 4159–4167.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
P. Lyu, M. Liao, C. Yao, W. Wu, and X. Bai, “Mask textspotter: An end-to-end
trainable neural network for spotting text with arbitrary shapes,” in
<em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proc. Eur. Conf. Comput. Vis.</em>, vol. 11218, 2018, pp. 71–88.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
K. He, G. Gkioxari, P. Dollar, and R. Girshick, “Mask R-CNN,” in
<em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE Int. Conf. Comput. Vis.</em>, 2017, pp. 2980–2988.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
S. Long, J. Ruan, W. Zhang, X. He, W. Wu, and C. Yao, “TextSnake: A Flexible
Representation for Detecting Text of Arbitrary Shapes,” in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proc. Eur.
Conf. Comput. Vis.</em>, vol. 11206, 2018, pp. 19–35.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Y. Li, Z. Wu, S. Zhao, X. Wu, Y. Kuang, Y. Yan, S. Ge, K. Wang, W. Fan,
X. Chen, and Y. Wang, “PSENet: Psoriasis Severity Evaluation Network,” in
<em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proc. AAAI Conf. Artif. Intell.</em>, vol. 34, no. 01, 2020, pp. 800–807.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
M. Liao, Z. Wan, C. Yao, K. Chen, and X. Bai, “Real-Time Scene Text Detection
with Differentiable Binarization,” in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proc. AAAI Conf. Artif.
Intell.</em>, vol. 34, no. 07, 2020, pp. 11 474–11 481.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Y. Baek, B. Lee, D. Han, S. Yun, and H. Lee, “Character Region Awareness for
Text Detection,” in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conf. Comput. Vis. Pattern
Recognit.</em>, 2019, pp. 9357–9366.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
A. A. Efros and W. T. Freeman, “Image quilting for texture synthesis and
transfer,” in <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proc. 28th Annu. Conf. Comput. Graph. Interact. Tech. -
SIGGRAPH ’01</em>, 2001, pp. 341–346.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
C. Barnes, E. Shechtman, A. Finkelstein, and D. B. Goldman, “PatchMatch,”
<em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">ACM Trans. Graph.</em>, vol. 28, no. 3, pp. 1–11, 2009.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
S. Darabi, E. Shechtman, C. Barnes, Dan B Goldman, and P. Sen, “Image
melding: Combining inconsistent images using patch-based synthesis,”
<em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">ACM Trans. Graph.</em>, vol. 31, no. 4, pp. 1–10, 2012.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
M. Bertalmio, G. Sapiro, V. Caselles, and C. Ballester, “Image inpainting,”
in <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proc. ACM SIGGRAPH Conf. Comput. Graph.</em>, 2000.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
M. M. Oliveira, B. Bowen, R. McKenna, and Y.-S. Chang, “Fast Digital Image
Inpainting,” <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Int. Conf. Vis. Imaging Image Process.</em>, 2001.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
D. Pathak, P. Krahenbuhl, J. Donahue, T. Darrell, and A. A. Efros, “Context
Encoders: Feature Learning by Inpainting,” in <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE Conf.
Comput. Vis. Pattern Recognit.</em>, 2016, pp. 2536–2544.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
S. Iizuka, E. Simo-Serra, and H. Ishikawa, “Globally and locally consistent
image completion,” <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">ACM Trans. Graph.</em>, vol. 36, no. 4, pp. 1–14,
2017.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
G. Liu, F. A. Reda, K. J. Shih, T. C. Wang, A. Tao, and B. Catanzaro, “Image
Inpainting for Irregular Holes Using Partial Convolutions,” in <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proc.
Eur. Conf. Comput. Vis.</em>, vol. 11215, 2018, pp. 89–105.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
C. Xie, S. Liu, C. Li, M.-M. Cheng, W. Zuo, X. Liu, S. Wen, and E. Ding,
“Image Inpainting With Learnable Bidirectional Attention Maps,” in
<em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Int. Conf. Comput. Vis.</em>, 2019, pp. 8857–8866.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
J. Li, N. Wang, L. Zhang, B. Du, and D. Tao, “Recurrent Feature Reasoning for
Image Inpainting,” in <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conf. Comput. Vis. Pattern
Recognit.</em>, 2020, pp. 7757–7765.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
J. Yu, Z. Lin, J. Yang, X. Shen, X. Lu, and T. S. Huang, “Generative Image
Inpainting with Contextual Attention,” in <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conf.
Comput. Vis. Pattern Recognit.</em>, 2018, pp. 5505–5514.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
J. Yu, Z. Lin, J. Yang, X. Shen, X. Lu, and T. Huang, “Free-Form Image
Inpainting With Gated Convolution,” in <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Int. Conf.
Comput. Vis.</em>, 2019, pp. 4470–4479.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Z. Yi, Q. Tang, S. Azizi, D. Jang, and Z. Xu, “Contextual Residual
Aggregation for Ultra High-Resolution Image Inpainting,” in <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proc.
IEEE/CVF Conf. Comput. Vis. Pattern Recognit.</em>, 2020, pp. 7505–7514.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
C. W. Lee, K. Jung, and H. J. Kim, “Automatic text detection and removal in
video sequences,” <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Pattern Recognit. Lett.</em>, vol. 24, no. 15, pp.
2607–2623, 2003.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
E. A. Pnevmatikakis and P. Maragos, “An inpainting system for automatic image
structure - texture restoration with text removal,” in <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Proc. 15th
IEEE Int. Conf. Image Process.</em>, 2008, pp. 2616–2619.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
A. Mosleh, N. Bouguila, and A. B. Hamza, “Image Text Detection Using a
Bandlet-Based Edge Detector and Stroke Width Transform,” in <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Proc. Br.
Mach. Vis. Conf.</em>, 2012, pp. 63.1–63.12.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
M. Khodadadi and A. Behrad, “Text localization, extraction and inpainting in
color images,” in <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Proc. 20th Iran. Conf. Electr. Eng.</em>, 2012, pp.
1035–1040.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
P. D. Wagh and D. R. Patil, “Text detection and removal from image using
inpainting with smoothing,” in <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. Pervasive Comput.</em>,
2015.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
P. Isola, J.-Y. Zhu, T. Zhou, and A. A. Efros, “Image-to-Image Translation
with Conditional Adversarial Networks,” in <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE Conf. Comput.
Vis. Pattern Recognit.</em>, 2017, pp. 5967–5976.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
S. Qin, J. Wei, and R. Manduchi, “Automatic semantic content removal by
learning to neglect,” in <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Proc. Br. Mach. Vis. Conf.</em>, 2018.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
C. Zheng, T.-J. Cham, and J. Cai, “Pluralistic Image Completion,” in
<em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conf. Comput. Vis. Pattern Recognit.</em>, 2019, pp.
1438–1447.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Deep Residual Learning for Image
Recognition,” in <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE Conf. Comput. Vis. Pattern Recognit.</em>,
2016, pp. 770–778.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
F. Milletari, N. Navab, and S.-A. Ahmadi, “V-Net: Fully Convolutional Neural
Networks for Volumetric Medical Image Segmentation,” in <em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">Proc. Int.
Conf. 3D Vis.</em>, 2016, pp. 565–571.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Y. Cao, J. Xu, S. Lin, F. Wei, and H. Hu, “GCNet: Non-Local Networks Meet
Squeeze-Excitation Networks and Beyond,” in <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Int. Conf.
Comput. Vis. Work.</em>, 2019, pp. 1971–1980.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
J. Johnson, A. Alahi, and L. Fei-Fei, “Perceptual losses for real-time style
transfer and super-resolution,” in <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Proc. Eur. Conf. Comput. Vis.</em>,
vol. 9906, 2016, pp. 694–711.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
L. A. Gatys, A. S. Ecker, and M. Bethge, “Image Style Transfer Using
Convolutional Neural Networks,” in <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE Conf. Comput. Vis.
Pattern Recognit.</em>, 2016, pp. 2414–2423.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
K. Simonyan and A. Zisserman, “Very deep convolutional networks for
large-scale image recognition,” in <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">Proc. 3rd Int. Conf. Learn.
Represent.</em>, 2015.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
D. P. Kingma and J. L. Ba, “Adam: A method for stochastic optimization,” in
<em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">Proc. 3rd Int. Conf. Learn. Represent.</em>, 2015.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
N. Nayef, F. Yin, I. Bizid, H. Choi, Y. Feng, D. Karatzas, Z. Luo, U. Pal,
C. Rigaud, J. Chazalon, W. Khlif, M. M. Luqman, J.-C. Burie, C.-l. Liu, and
J.-M. Ogier, “ICDAR2017 Robust Reading Challenge on Multi-Lingual Scene
Text Detection and Script Identification - RRC-MLT,” in <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Proc. 14th
IAPR Int. Conf. Doc. Anal. Recognit.</em>, vol. 1, 2017, pp. 1454–1459.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
D. Karatzas, L. Gomez-Bigorda, A. Nicolaou, S. Ghosh, A. Bagdanov, M. Iwamura,
J. Matas, L. Neumann, V. R. Chandrasekhar, S. Lu, F. Shafait, S. Uchida, and
E. Valveny, “ICDAR 2015 competition on Robust Reading,” in <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">Proc.
13th Int. Conf. Doc. Anal. Recognit.</em>, 2015, pp. 1156–1160.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
A. Veit, T. Matera, L. Neumann, J. Matas, and S. Belongie, “COCO-Text:
Dataset and Benchmark for Text Detection and Recognition in Natural
Images,” <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2016.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
K. Wang and S. Belongie, “Word spotting in the wild,” in <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">Proc. Eur.
Conf. Comput. Vis.</em>, vol. 6311, 2010, pp. 591–604.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
N. Nayef, C.-l. Liu, J.-M. Ogier, Y. Patel, M. Busta, P. N. Chowdhury,
D. Karatzas, W. Khlif, J. Matas, U. Pal, and J.-C. Burie, “ICDAR2019 Robust
Reading Challenge on Multi-lingual Scene Text Detection and Recognition —
RRC-MLT-2019,” in <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. Doc. Anal. Recognit.</em>, 2019, pp.
1582–1587.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
C. K. Chng, E. Ding, J. Liu, D. Karatzas, C. S. Chan, L. Jin, Y. Liu, Y. Sun,
C. C. Ng, C. Luo, Z. Ni, C. Fang, S. Zhang, and J. Han, “ICDAR2019 Robust
Reading Challenge on Arbitrary-Shaped Text - RRC-ArT,” in <em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">Proc. Int.
Conf. Doc. Anal. Recognit.</em>, 2019, pp. 1571–1576.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
Z. Wang, A. C. Bovik, H. R. Sheikh, and E. P. Simoncelli, “Image quality
assessment: From error visibility to structural similarity,” <em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">IEEE
Trans. Image Process.</em>, vol. 13, no. 4, pp. 600–612, 2004.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
B. Zhou, A. Lapedriza, A. Khosla, A. Oliva, and A. Torralba, “Places: A 10
Million Image Database for Scene Recognition,” <em id="bib.bib66.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. Pattern
Anal. Mach. Intell.</em>, vol. 40, no. 6, pp. 1452–1464, 2018.

</span>
</li>
</ul>
</section>
<figure id="id1" class="ltx_float biography">
<table id="id1.1" class="ltx_tabular">
<tr id="id1.1.1" class="ltx_tr">
<td id="id1.1.1.1" class="ltx_td"><img src="/html/2104.11493/assets/tang.png" id="id1.1.1.1.g1" class="ltx_graphics ltx_img_square" width="100" height="122" alt="[Uncaptioned image]"></td>
<td id="id1.1.1.2" class="ltx_td">
<span id="id1.1.1.2.1" class="ltx_inline-block">
<span id="id1.1.1.2.1.1" class="ltx_p"><span id="id1.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Zhengmi Tang</span> 
received his B.E. degree from Xidian University, Shaanxi, China, in 2017 and his M.E. degree in cybernetics engineering from Hiroshima University, Japan, in 2020. He is currently pursuing a Ph.D. degree in communication engineering at the IIC-Lab at Tohoku University, Japan. His current research interests include computer vision, scene-text detection, and data synthesis.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id2" class="ltx_float biography">
<table id="id2.1" class="ltx_tabular">
<tr id="id2.1.1" class="ltx_tr">
<td id="id2.1.1.1" class="ltx_td"><img src="/html/2104.11493/assets/miyazaki.jpg" id="id2.1.1.1.g1" class="ltx_graphics ltx_img_square" width="100" height="117" alt="[Uncaptioned image]"></td>
<td id="id2.1.1.2" class="ltx_td">
<span id="id2.1.1.2.1" class="ltx_inline-block">
<span id="id2.1.1.2.1.1" class="ltx_p"><span id="id2.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Tomo Miyazaki</span> 
(Member, IEEE) received his B.E. and Ph.D. degrees from Yamagata University (2006) and Tohoku University (2011), respectively. From 2011 to 2012, he worked on the geographic information system at Hitachi, Ltd. From 2013 to 2014, he worked at Tohoku University as a postdoctoral researcher. Since 2015, he has been an Assistant Professor at the university. His research interests include pattern recognition and image processing.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id3" class="ltx_float biography">
<table id="id3.1" class="ltx_tabular">
<tr id="id3.1.1" class="ltx_tr">
<td id="id3.1.1.1" class="ltx_td"><img src="/html/2104.11493/assets/sugaya.jpg" id="id3.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="97" height="125" alt="[Uncaptioned image]"></td>
<td id="id3.1.1.2" class="ltx_td">
<span id="id3.1.1.2.1" class="ltx_inline-block">
<span id="id3.1.1.2.1.1" class="ltx_p"><span id="id3.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Yoshihiro Sugaya</span> 
(Member, IEEE) received his B.E., M.E., and Ph.D. degrees from Tohoku University, Sendai, Japan in 1995, 1997, and 2002, respectively. He is currently an Associate Professor at the Graduate School of Engineering, Tohoku University. His research interests include computer vision, pattern recognition, image processing, parallel processing, and distributed computing. Dr. Sugaya is a member of the Institute of Electronics, Information and Communication Engineers (IEICE) and the Information Processing Society of Japan.</span>
</span>
</td>
</tr>
</table>
</figure>
<figure id="id4" class="ltx_float biography">
<table id="id4.1" class="ltx_tabular">
<tr id="id4.1.1" class="ltx_tr">
<td id="id4.1.1.1" class="ltx_td"><img src="/html/2104.11493/assets/omachi.jpg" id="id4.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="97" height="125" alt="[Uncaptioned image]"></td>
<td id="id4.1.1.2" class="ltx_td">
<span id="id4.1.1.2.1" class="ltx_inline-block">
<span id="id4.1.1.2.1.1" class="ltx_p"><span id="id4.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Shinichiro Omachi</span> 
(M’96-SM’11) received his B.E., M.E., and Ph.D. degrees in Information Engineering from Tohoku University, Japan, in 1988, 1990, and 1993, respectively. He worked as an Assistant Professor at the Education Center for Information Processing at Tohoku University from 1993 to 1996. Since 1996, he has been affiliated with the Graduate School of Engineering at Tohoku University, where he is currently a Professor. From 2000 to 2001, he was a visiting Associate Professor at Brown University. His research interests include pattern recognition, computer vision, image processing, image coding, and parallel processing. He served as the Editor-in-Chief of IEICE Transactions on Information and Systems from 2013 to 2015. Dr. Omachi is a member of the Institute of Electronics, Information and Communication Engineers, the Information Processing Society of Japan, among others. He received the IAPR/ICDAR Best Paper Award in 2007, the Best Paper Method Award of the 33rd Annual Conference of the GfKl in 2010, the ICFHR Best Paper Award in 2010, and the IEICE Best Paper Award in 2012. He is currently the Vice Chair of the IEEE Sendai Section.</span>
</span>
</td>
</tr>
</table>
</figure>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2104.11492" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2104.11493" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2104.11493">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2104.11493" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2104.11494" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Mar 17 04:00:38 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
