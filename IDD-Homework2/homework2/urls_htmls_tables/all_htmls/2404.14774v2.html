<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation</title>
<!--Generated on Sat Sep  7 16:10:08 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Generative Recommendation,  Semantic Tokenization; Contrastive Quantization" lang="en" name="keywords"/>
<base href="/html/2404.14774v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S1" title="In CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S2" title="In CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S3" title="In CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Approach</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S3.SS1" title="In 3. Approach ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Contrastive Quantization-based Semantic Tokenization</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S3.SS1.SSS1" title="In 3.1. Contrastive Quantization-based Semantic Tokenization ‣ 3. Approach ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.1 </span>Reconstructive Quantization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S3.SS1.SSS2" title="In 3.1. Contrastive Quantization-based Semantic Tokenization ‣ 3. Approach ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.2 </span>Contrastive Quantization</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S3.SS2" title="In 3. Approach ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Autoregressive Generation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S4" title="In CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S4.SS1" title="In 4. Experiments ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S4.SS2" title="In 4. Experiments ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Performance Comparison and Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S5" title="In CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">CoST: Contrastive Quantization based Semantic Tokenization 
<br class="ltx_break"/>for Generative Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jieming Zhu<sup class="ltx_sup" id="id4.2.id1">∗</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.3.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_city" id="id6.4.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id7.5.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jiemingzhu@ieee.org">jiemingzhu@ieee.org</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mengqun Jin<sup class="ltx_sup" id="id8.2.id1">∗</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.3.id1">Shenzhen International Graduate School, Tsinghua University</span><span class="ltx_text ltx_affiliation_city" id="id10.4.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id11.5.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jinmq22@mails.tsinghua.edu.cn">jinmq22@mails.tsinghua.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qijiong Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id12.1.id1">The Hong Kong Polytechnic University</span><span class="ltx_text ltx_affiliation_city" id="id13.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id14.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:liu@qijiong.work">liu@qijiong.work</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zexuan Qiu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id15.1.id1">The Chinese University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id16.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id17.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:qzexuan@link.cuhk.edu.hk">qzexuan@link.cuhk.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhenhua Dong
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id18.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_city" id="id19.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id20.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:dongzhenhua@huawei.com">dongzhenhua@huawei.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiu Li<sup class="ltx_sup" id="id21.1.id1">🖂</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id22.2.id1">Shenzhen International Graduate
School, Tsinghua University</span><span class="ltx_text ltx_affiliation_city" id="id23.3.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id24.4.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:li.xiu@sz.tsinghua.edu.cn">li.xiu@sz.tsinghua.edu.cn</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id25.id1">Embedding-based retrieval serves as a dominant approach to candidate item matching for industrial recommender systems. With the success of generative AI, generative retrieval has recently emerged as a new retrieval paradigm for recommendation, which casts item retrieval as a generation problem. Its model consists of two stages: semantic tokenization and autoregressive generation. The first stage involves item tokenization that constructs discrete semantic tokens to index items, while the second stage autoregressively generates semantic tokens of candidate items. Therefore, semantic tokenization serves as a crucial preliminary step for training generative recommendation models. Existing research usually employs a vector quantizier with reconstruction loss (e.g., RQ-VAE) to obtain semantic tokens of items, but this method fails to capture the essential neighborhood relationships that are vital for effective item modeling in recommender systems. In this paper, we propose a contrastive quantization-based semantic tokenization approach, named CoST, which harnesses both item relationships and semantic information to learn semantic tokens. Our experimental results highlight
the significant impact of semantic tokenization on generative recommendation performance, with CoST achieving up to a 43% improvement in Recall@5 and 44% improvement in NDCG@5 on the MIND dataset over previous baselines.</p>
</div>
<div class="ltx_keywords">Generative Recommendation, Semantic Tokenization; Contrastive Quantization
</div>
<div class="ltx_acknowledgements">
<sup class="ltx_sup" id="id26.id1">∗</sup>  Equal contribution. The work was done during Mengqun’s internship at Huawei.
</div>
<div class="ltx_acknowledgements">
<sup class="ltx_sup" id="id27.id1">🖂</sup> Corresponding author.
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>18th ACM Conference
on Recommender Systems; October 14–18, 2024; Bari, Italy</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>18th ACM Conference on Recommender Systems (RecSys ’24),
October 14–18, 2024, Bari, Italy</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3640457.3688178</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0505-2/24/10</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Personalization</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Industrial recommender systems typically employ a retrieve-then-rank pipeline to serve online requests while adhering to strict response time requirements. In this pipeline, embedding-based retrieval plays a crucial role by efficiently retrieving highly relevant items from a large candidate pool for the subsequent fine-grained ranking stage. However, current embedding-based retrieval approaches are limited by either two-tower models <cite class="ltx_cite ltx_citemacro_citep">(Covington et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib3" title="">2016</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib39" title="">2020</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib33" title="">2021</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib43" title="">2023</a>)</cite> or graph networks <cite class="ltx_cite ltx_citemacro_citep">(Ying et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib40" title="">2018</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib31" title="">2018</a>; Nguyen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib20" title="">2023</a>; Mao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib19" title="">2021</a>)</cite>, which rely on dot-product (or cosine) similarity for approximate nearest neighbor (ANN) search in a pre-computed vector store (e.g., Faiss <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib12" title="">2021</a>; Douze et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib4" title="">2024</a>)</cite>). While ANN search systems facilitate efficient top-k item retrieval, they constrain model capacity by using simple dot-product similarity and lead to disjoint optimization of embedding models and ANN indexes.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">With the recent success of generative AI techniques, generative retrieval <cite class="ltx_cite ltx_citemacro_citep">(Tang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib27" title="">2024</a>; Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib24" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib36" title="">2024b</a>)</cite> has emerged as a new retrieval paradigm for recommendation, redefining item retrieval as a sequence generation problem. TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib24" title="">2023</a>)</cite> exemplifies this approach with its two-stage model: semantic tokenization and autoregressive generation. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, in the tokenization stage, the model maps each item to a sequence of discrete semantic tokens (also known as semantic IDs or codes), aiming to capture and preserve item content semantics within these tokens. This ensures that semantically similar items are assigned similar tokens. In the generation stage, an encoder-decoder architecture is employed to encode historical item sequences and decode target item tokens autoregressively. During inference, by using beam search with token-to-item mapping, the model can directly generate top-k candidate item IDs. In this way, generative recommendation models like TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib24" title="">2023</a>)</cite> and EAGER <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib36" title="">2024b</a>)</cite> facilitate fine-grained token-level relevance matching between users and items while eliminating the need for non-differentiable, external ANN search systems.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="658" id="S1.F1.g1" src="x1.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>A framework of generative recommendation including tokenization phase and generation phase.</figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this process, semantic tokenization plays a crucial role as a preliminary step for training generative recommendation models, reducing the vocabulary size from millions of item IDs to thousands of tokens, which enables more efficient decoding without the need for ANN indexes. To learn high-quality semantic tokens, existing work typically leverages textual descriptions of items with pretrained language models (e.g., Sentence-T5 <cite class="ltx_cite ltx_citemacro_citep">(Ni et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib21" title="">2021</a>)</cite>) to derive their semantic embeddings. Subsequently, some techniques such as vector quantization <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib24" title="">2023</a>; Singh et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib26" title="">2023</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib15" title="">2024a</a>)</cite> and hierarchical k-means clustering <cite class="ltx_cite ltx_citemacro_citep">(Tay et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib28" title="">2022</a>; Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib6" title="">2022</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib36" title="">2024b</a>)</cite> are applied to discretize semantic embeddings into semantic tokens (w.r.t. codes or clusters). Among them, RQ-VAE, first introduced in the TIGER framework <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib24" title="">2023</a>)</cite>, stands out as a leading approach for semantic tokenization. RQ-VAE employs a residual quantization-based autoencoder, optimized through reconstruction loss. However, its reliance on the autoencoder architecture, which compresses and discretizes semantic embeddings for each item independently, can result in a suboptimal distribution of the learned semantic token space when applied to generative recommendation models. For example, due to the long-tailed item distribution observed in practice, RQ-VAE often produces identical token sequences for similar items within the densest regions, making them difficult to differentiate. This thus motivates us to capture essential neighborhood relationships among items that are vital for recommendation models.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To achieve this goal, this paper introduces CoST, a <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.1">Co</span>ntrastive quantization-based <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.2">S</span>emantic <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.3">T</span>okenization method, which not only captures the semantic information of items but also integrates their neighborhood relationships. Building on the RQ-VAE structure, CoST encodes semantic item embeddings and then uses an iterative residual quantization process in the latent space to assign these embeddings to the closest codes (i.e., tokens) from a learnable codebook (i.e., vocabulary). A decoder further reconstructs the item embeddings from their corresponding semantic codes and codebook embeddings. However, unlike the reconstruction-based RQ-VAE, which aims to precisely reconstruct item embedding vectors using MSE loss, CoST adopts a contrastive learning framework to capture neighborhood relationships among items during quantization. Specifically, we enforce that reconstructed vectors are closer to their corresponding input vectors than to other vectors within a batch. This method thus preserves the neighborhood information between the input embedding and its reconstructed counterpart while enhancing dissimilarity from other items, facilitating clearer differentiation between each item and its neighbors. Our approach relaxes the requirement for exact reconstruction and instead prioritizes pairwise similarities between items. By leveraging contrastive loss, which maximizes the top-one probability within a batch, we more effectively capture the underlying distribution of item similarities. This provides a key advantage for recommendation tasks compared to RQ-VAE.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To evaluate the effectiveness of our approach, we use TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib24" title="">2023</a>)</cite> as the baseline generative recommendation model and assess CoST as a replacement for RQ-VAE during the semantic tokenization phase. Our experiments on multiple benchmark datasets highlight the significant impact of semantic tokenization on generative recommendation performance. Notably, on the MIND dataset <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib37" title="">2020</a>)</cite>, CoST achieves substantial improvements, with up to a 43% increase in Recall@5 and a 44% increase in NDCG@5 compared to the reconstruction-based RQ-VAE. These results underscore the pivotal role of semantic tokenization in generative recommendation and pave the way for future research in this direction.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Generative AI for Recommendation.</span> With the recent success of generative AI, generative recommendation has emerged as a trending research topic. On one hand, researchers are exploring the application of sequence generation models for recommendation tasks. Among them, generative retrieval (GR) <cite class="ltx_cite ltx_citemacro_citep">(Tang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib27" title="">2024</a>)</cite> stands out as a promising technique for retrieving relevant documents from a database by reframing the retrieval process as a sequence generation problem. Unlike traditional embedding-based retrieval methods, which rely on two-tower models for embedding computation and external ANN search systems for top-k lookups, GR generates document tokens sequentially, including document titles, document IDs, or assigned semantic IDs <cite class="ltx_cite ltx_citemacro_citep">(Tay et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib28" title="">2022</a>)</cite>. Notably, GENRE <cite class="ltx_cite ltx_citemacro_citep">(Cao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib2" title="">2021</a>)</cite> pioneered the use of a transformer architecture for entity retrieval, generating entity names token-by-token based on a given query. DSI <cite class="ltx_cite ltx_citemacro_citep">(Tay et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib28" title="">2022</a>)</cite> and NCI introduced the concept of assigning structured semantic IDs to documents and training encoder-decoder models for generative document retrieval. Upon receiving a query, these models generate semantic IDs autoregressively to retrieve documents. Following this paradigm, TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib24" title="">2023</a>)</cite> and EAGER <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib36" title="">2024b</a>)</cite> were developed as generative item retrieval models for recommender systems. Additionally, there have been efforts to apply non-autoregressive generative models for tasks such as item list continuation <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib17" title="">2023</a>)</cite> and item list re-ranking <cite class="ltx_cite ltx_citemacro_citep">(Ren et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib25" title="">2024</a>)</cite>. On the other hand, some research explores leveraging the generation and reasoning capabilities of large language models (LLMs) for recommendation tasks. Examples include generating item embeddings <cite class="ltx_cite ltx_citemacro_citep">(Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib38" title="">2023</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib42" title="">2024</a>)</cite>, item descriptions <cite class="ltx_cite ltx_citemacro_citep">(Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib14" title="">2024</a>)</cite>, conversational responses <cite class="ltx_cite ltx_citemacro_citep">(Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib7" title="">2023</a>)</cite>, explanations <cite class="ltx_cite ltx_citemacro_citep">(Lubos et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib18" title="">2024</a>)</cite>, or summaries <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib8" title="">2024</a>)</cite> to support recommendations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Semantic Indexing and Tokenization.</span>
With the rising popularity of generative recommendation, how to index items in these models has become a key challenge. <cite class="ltx_cite ltx_citemacro_citep">(Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib10" title="">2023</a>)</cite> conducts in-depth research on item indexing methods for LLM-based recommendation models, such as P5 <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib9" title="">2022</a>)</cite>. While simple indexing methods, such as random indexing and title indexing, are straightforward, they are not easily scalable to industrial-sized recommendation scenarios. To address this, research has focused on semantic indexing <cite class="ltx_cite ltx_citemacro_citep">(Tay et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib28" title="">2022</a>; Singh et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib26" title="">2023</a>)</cite>, which aims to index items based on coherent content information. Two primary techniques are used, including vector quantization <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib24" title="">2023</a>; Singh et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib26" title="">2023</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib15" title="">2024a</a>)</cite> and hierarchical k-means clustering <cite class="ltx_cite ltx_citemacro_citep">(Tay et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib28" title="">2022</a>; Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib6" title="">2022</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib36" title="">2024b</a>)</cite>. Given their discrete nature and similarities to visual tokenization <cite class="ltx_cite ltx_citemacro_citep">(Van Den Oord et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib29" title="">2017</a>; Du et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib5" title="">2024</a>)</cite>, this process is also referred to as semantic tokenization <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib16" title="">2024b</a>)</cite>. Specifically, TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib24" title="">2023</a>)</cite> and LC-Rec <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib44" title="">2024</a>)</cite> apply residual quantization (RQ-VAE) to textual embeddings derived from item titles and descriptions for tokenization. Recforest <cite class="ltx_cite ltx_citemacro_citep">(Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib6" title="">2022</a>)</cite> and EAGER <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib36" title="">2024b</a>)</cite> utilize hierarchical k-means clustering on item textual embeddings to obtain cluster indexes as tokens. Furthermore, recent studies such as EAGER <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib36" title="">2024b</a>)</cite>, TokenRec <cite class="ltx_cite ltx_citemacro_citep">(Qu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib23" title="">2024</a>)</cite>, and LETTER <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib35" title="">2024a</a>)</cite> explore integrating both semantic and collaborative information into the tokenization process. However, this work focuses on how to leverage contrastive quantization <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib32" title="">2022b</a>; O’Neill and Dutta, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib22" title="">2023</a>)</cite> to enhance semantic tokenization.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Approach</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the generative recommendation framework, which comprises two phases: semantic tokenization and autoregressive generation. In this section, we first introduce our proposed CoST approach for semantic tokenization, followed by a description of its integration with the generation task.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="671" id="S3.F2.g1" src="x2.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>The vector quantization workflow trained via reconstructive quantization and contrastive quantization.</figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Contrastive Quantization-based Semantic Tokenization</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, we initially employ pretrained text encoders, such as Sentence-T5 <cite class="ltx_cite ltx_citemacro_citep">(Ni et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib21" title="">2021</a>)</cite> and E5 <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib34" title="">2022a</a>)</cite>, to derive item embeddings from their textual content. For items with multiple textual fields, such as category, title, and description, we concatenate these fields using a prompt template, for example: ”Item category: ¡category¿. Title: ¡title¿. Description: ¡description¿.” Once the item embeddings are obtained, we utilize a residual-quantized variational autoencoder (RQ-VAE) <cite class="ltx_cite ltx_citemacro_citep">(Lee et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib13" title="">2022</a>)</cite> structure to learn discrete tokens of items, a process illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S3.F2" title="Figure 2 ‣ 3. Approach ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.16">Specifically, to tokenize an input vector <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">bold_x</annotation></semantics></math>, we employ an encoder <math alttext="\mathrm{E}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p2.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">E</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathrm{E}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">roman_E</annotation></semantics></math> (e.g., MLP) to project <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">bold_x</annotation></semantics></math> onto a low-dimensional latent representation <math alttext="\mathbf{z}=\mathrm{E}(\mathbf{x})" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.2" xref="S3.SS1.p2.4.m4.1.2.cmml"><mi id="S3.SS1.p2.4.m4.1.2.2" xref="S3.SS1.p2.4.m4.1.2.2.cmml">𝐳</mi><mo id="S3.SS1.p2.4.m4.1.2.1" xref="S3.SS1.p2.4.m4.1.2.1.cmml">=</mo><mrow id="S3.SS1.p2.4.m4.1.2.3" xref="S3.SS1.p2.4.m4.1.2.3.cmml"><mi id="S3.SS1.p2.4.m4.1.2.3.2" mathvariant="normal" xref="S3.SS1.p2.4.m4.1.2.3.2.cmml">E</mi><mo id="S3.SS1.p2.4.m4.1.2.3.1" xref="S3.SS1.p2.4.m4.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p2.4.m4.1.2.3.3.2" xref="S3.SS1.p2.4.m4.1.2.3.cmml"><mo id="S3.SS1.p2.4.m4.1.2.3.3.2.1" stretchy="false" xref="S3.SS1.p2.4.m4.1.2.3.cmml">(</mo><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">𝐱</mi><mo id="S3.SS1.p2.4.m4.1.2.3.3.2.2" stretchy="false" xref="S3.SS1.p2.4.m4.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.2.cmml" xref="S3.SS1.p2.4.m4.1.2"><eq id="S3.SS1.p2.4.m4.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.2.1"></eq><ci id="S3.SS1.p2.4.m4.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.2.2">𝐳</ci><apply id="S3.SS1.p2.4.m4.1.2.3.cmml" xref="S3.SS1.p2.4.m4.1.2.3"><times id="S3.SS1.p2.4.m4.1.2.3.1.cmml" xref="S3.SS1.p2.4.m4.1.2.3.1"></times><ci id="S3.SS1.p2.4.m4.1.2.3.2.cmml" xref="S3.SS1.p2.4.m4.1.2.3.2">E</ci><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\mathbf{z}=\mathrm{E}(\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">bold_z = roman_E ( bold_x )</annotation></semantics></math>. Residual quantization is an iterative process that quantizes the residual vector at each step, thereby generating a tuple of tokens. Initially, the residual is defined as <math alttext="\mathbf{r}_{0}=\mathbf{z}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><msub id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2.2" xref="S3.SS1.p2.5.m5.1.1.2.2.cmml">𝐫</mi><mn id="S3.SS1.p2.5.m5.1.1.2.3" xref="S3.SS1.p2.5.m5.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS1.p2.5.m5.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.cmml">=</mo><mi id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">𝐳</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><eq id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1"></eq><apply id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2.2">𝐫</ci><cn id="S3.SS1.p2.5.m5.1.1.2.3.cmml" type="integer" xref="S3.SS1.p2.5.m5.1.1.2.3">0</cn></apply><ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\mathbf{r}_{0}=\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">bold_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_z</annotation></semantics></math>. We then establish a set of codebooks <math alttext="\mathbf{C}_{i}=\{\mathbf{e}^{k}_{i}|k=1,\ldots,K\},\forall i\in[1,M]" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.7"><semantics id="S3.SS1.p2.6.m6.7a"><mrow id="S3.SS1.p2.6.m6.7.7.2" xref="S3.SS1.p2.6.m6.7.7.3.cmml"><mrow id="S3.SS1.p2.6.m6.6.6.1.1" xref="S3.SS1.p2.6.m6.6.6.1.1.cmml"><msub id="S3.SS1.p2.6.m6.6.6.1.1.4" xref="S3.SS1.p2.6.m6.6.6.1.1.4.cmml"><mi id="S3.SS1.p2.6.m6.6.6.1.1.4.2" xref="S3.SS1.p2.6.m6.6.6.1.1.4.2.cmml">𝐂</mi><mi id="S3.SS1.p2.6.m6.6.6.1.1.4.3" xref="S3.SS1.p2.6.m6.6.6.1.1.4.3.cmml">i</mi></msub><mo id="S3.SS1.p2.6.m6.6.6.1.1.3" xref="S3.SS1.p2.6.m6.6.6.1.1.3.cmml">=</mo><mrow id="S3.SS1.p2.6.m6.6.6.1.1.2.2" xref="S3.SS1.p2.6.m6.6.6.1.1.2.3.cmml"><mo id="S3.SS1.p2.6.m6.6.6.1.1.2.2.3" stretchy="false" xref="S3.SS1.p2.6.m6.6.6.1.1.2.3.1.cmml">{</mo><msubsup id="S3.SS1.p2.6.m6.6.6.1.1.1.1.1" xref="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.2.2" xref="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.2.2.cmml">𝐞</mi><mi id="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.3" xref="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.3.cmml">i</mi><mi id="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.2.3" xref="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS1.p2.6.m6.6.6.1.1.2.2.4" lspace="0em" rspace="0em" xref="S3.SS1.p2.6.m6.6.6.1.1.2.3.1.cmml">|</mo><mrow id="S3.SS1.p2.6.m6.6.6.1.1.2.2.2" xref="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.cmml"><mi id="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.2" xref="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.2.cmml">k</mi><mo id="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.1" xref="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.1.cmml">=</mo><mrow id="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.3.2" xref="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.3.1.cmml"><mn id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">1</mn><mo id="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.3.2.1" xref="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.3.1.cmml">,</mo><mi id="S3.SS1.p2.6.m6.2.2" mathvariant="normal" xref="S3.SS1.p2.6.m6.2.2.cmml">…</mi><mo id="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.3.2.2" xref="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.3.1.cmml">,</mo><mi id="S3.SS1.p2.6.m6.3.3" xref="S3.SS1.p2.6.m6.3.3.cmml">K</mi></mrow></mrow><mo id="S3.SS1.p2.6.m6.6.6.1.1.2.2.5" stretchy="false" xref="S3.SS1.p2.6.m6.6.6.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo id="S3.SS1.p2.6.m6.7.7.2.3" xref="S3.SS1.p2.6.m6.7.7.3a.cmml">,</mo><mrow id="S3.SS1.p2.6.m6.7.7.2.2" xref="S3.SS1.p2.6.m6.7.7.2.2.cmml"><mrow id="S3.SS1.p2.6.m6.7.7.2.2.2" xref="S3.SS1.p2.6.m6.7.7.2.2.2.cmml"><mo id="S3.SS1.p2.6.m6.7.7.2.2.2.1" rspace="0.167em" xref="S3.SS1.p2.6.m6.7.7.2.2.2.1.cmml">∀</mo><mi id="S3.SS1.p2.6.m6.7.7.2.2.2.2" xref="S3.SS1.p2.6.m6.7.7.2.2.2.2.cmml">i</mi></mrow><mo id="S3.SS1.p2.6.m6.7.7.2.2.1" xref="S3.SS1.p2.6.m6.7.7.2.2.1.cmml">∈</mo><mrow id="S3.SS1.p2.6.m6.7.7.2.2.3.2" xref="S3.SS1.p2.6.m6.7.7.2.2.3.1.cmml"><mo id="S3.SS1.p2.6.m6.7.7.2.2.3.2.1" stretchy="false" xref="S3.SS1.p2.6.m6.7.7.2.2.3.1.cmml">[</mo><mn id="S3.SS1.p2.6.m6.4.4" xref="S3.SS1.p2.6.m6.4.4.cmml">1</mn><mo id="S3.SS1.p2.6.m6.7.7.2.2.3.2.2" xref="S3.SS1.p2.6.m6.7.7.2.2.3.1.cmml">,</mo><mi id="S3.SS1.p2.6.m6.5.5" xref="S3.SS1.p2.6.m6.5.5.cmml">M</mi><mo id="S3.SS1.p2.6.m6.7.7.2.2.3.2.3" stretchy="false" xref="S3.SS1.p2.6.m6.7.7.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.7b"><apply id="S3.SS1.p2.6.m6.7.7.3.cmml" xref="S3.SS1.p2.6.m6.7.7.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.7.7.3a.cmml" xref="S3.SS1.p2.6.m6.7.7.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p2.6.m6.6.6.1.1.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1"><eq id="S3.SS1.p2.6.m6.6.6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.3"></eq><apply id="S3.SS1.p2.6.m6.6.6.1.1.4.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.6.6.1.1.4.1.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.4">subscript</csymbol><ci id="S3.SS1.p2.6.m6.6.6.1.1.4.2.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.4.2">𝐂</ci><ci id="S3.SS1.p2.6.m6.6.6.1.1.4.3.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.4.3">𝑖</ci></apply><apply id="S3.SS1.p2.6.m6.6.6.1.1.2.3.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.2.2"><csymbol cd="latexml" id="S3.SS1.p2.6.m6.6.6.1.1.2.3.1.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.2.2.3">conditional-set</csymbol><apply id="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.2.2">𝐞</ci><ci id="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.2.2.2"><eq id="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.1.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.1"></eq><ci id="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.2.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.2">𝑘</ci><list id="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.3.1.cmml" xref="S3.SS1.p2.6.m6.6.6.1.1.2.2.2.3.2"><cn id="S3.SS1.p2.6.m6.1.1.cmml" type="integer" xref="S3.SS1.p2.6.m6.1.1">1</cn><ci id="S3.SS1.p2.6.m6.2.2.cmml" xref="S3.SS1.p2.6.m6.2.2">…</ci><ci id="S3.SS1.p2.6.m6.3.3.cmml" xref="S3.SS1.p2.6.m6.3.3">𝐾</ci></list></apply></apply></apply><apply id="S3.SS1.p2.6.m6.7.7.2.2.cmml" xref="S3.SS1.p2.6.m6.7.7.2.2"><in id="S3.SS1.p2.6.m6.7.7.2.2.1.cmml" xref="S3.SS1.p2.6.m6.7.7.2.2.1"></in><apply id="S3.SS1.p2.6.m6.7.7.2.2.2.cmml" xref="S3.SS1.p2.6.m6.7.7.2.2.2"><csymbol cd="latexml" id="S3.SS1.p2.6.m6.7.7.2.2.2.1.cmml" xref="S3.SS1.p2.6.m6.7.7.2.2.2.1">for-all</csymbol><ci id="S3.SS1.p2.6.m6.7.7.2.2.2.2.cmml" xref="S3.SS1.p2.6.m6.7.7.2.2.2.2">𝑖</ci></apply><interval closure="closed" id="S3.SS1.p2.6.m6.7.7.2.2.3.1.cmml" xref="S3.SS1.p2.6.m6.7.7.2.2.3.2"><cn id="S3.SS1.p2.6.m6.4.4.cmml" type="integer" xref="S3.SS1.p2.6.m6.4.4">1</cn><ci id="S3.SS1.p2.6.m6.5.5.cmml" xref="S3.SS1.p2.6.m6.5.5">𝑀</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.7c">\mathbf{C}_{i}=\{\mathbf{e}^{k}_{i}|k=1,\ldots,K\},\forall i\in[1,M]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.7d">bold_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { bold_e start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_k = 1 , … , italic_K } , ∀ italic_i ∈ [ 1 , italic_M ]</annotation></semantics></math>, where <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">italic_M</annotation></semantics></math> represents the number of codebooks and <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><mi id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">italic_K</annotation></semantics></math> denotes the size of each codebook. To approximate <math alttext="\mathbf{r}_{0}" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.1"><semantics id="S3.SS1.p2.9.m9.1a"><msub id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml"><mi id="S3.SS1.p2.9.m9.1.1.2" xref="S3.SS1.p2.9.m9.1.1.2.cmml">𝐫</mi><mn id="S3.SS1.p2.9.m9.1.1.3" xref="S3.SS1.p2.9.m9.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2">𝐫</ci><cn id="S3.SS1.p2.9.m9.1.1.3.cmml" type="integer" xref="S3.SS1.p2.9.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">\mathbf{r}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m9.1d">bold_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, we perform a nearest neighbor search using the first codebook <math alttext="\mathbf{C}_{1}" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.1"><semantics id="S3.SS1.p2.10.m10.1a"><msub id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml"><mi id="S3.SS1.p2.10.m10.1.1.2" xref="S3.SS1.p2.10.m10.1.1.2.cmml">𝐂</mi><mn id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2">𝐂</ci><cn id="S3.SS1.p2.10.m10.1.1.3.cmml" type="integer" xref="S3.SS1.p2.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">\mathbf{C}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m10.1d">bold_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, selecting the closest code vector with its index <math alttext="c_{1}=\arg\min_{k}\|\mathbf{r}_{0}-\mathbf{e}^{k}_{1}\|_{2}" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m11.1"><semantics id="S3.SS1.p2.11.m11.1a"><mrow id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><msub id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml"><mi id="S3.SS1.p2.11.m11.1.1.3.2" xref="S3.SS1.p2.11.m11.1.1.3.2.cmml">c</mi><mn id="S3.SS1.p2.11.m11.1.1.3.3" xref="S3.SS1.p2.11.m11.1.1.3.3.cmml">1</mn></msub><mo id="S3.SS1.p2.11.m11.1.1.2" xref="S3.SS1.p2.11.m11.1.1.2.cmml">=</mo><mrow id="S3.SS1.p2.11.m11.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.cmml"><mi id="S3.SS1.p2.11.m11.1.1.1.2" xref="S3.SS1.p2.11.m11.1.1.1.2.cmml">arg</mi><mo id="S3.SS1.p2.11.m11.1.1.1a" lspace="0.167em" xref="S3.SS1.p2.11.m11.1.1.1.cmml">⁡</mo><mrow id="S3.SS1.p2.11.m11.1.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.1.cmml"><msub id="S3.SS1.p2.11.m11.1.1.1.1.2" xref="S3.SS1.p2.11.m11.1.1.1.1.2.cmml"><mi id="S3.SS1.p2.11.m11.1.1.1.1.2.2" xref="S3.SS1.p2.11.m11.1.1.1.1.2.2.cmml">min</mi><mi id="S3.SS1.p2.11.m11.1.1.1.1.2.3" xref="S3.SS1.p2.11.m11.1.1.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS1.p2.11.m11.1.1.1.1a" xref="S3.SS1.p2.11.m11.1.1.1.1.cmml">⁡</mo><msub id="S3.SS1.p2.11.m11.1.1.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.1.1.cmml"><mrow id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.2.cmml"><mo id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.2.cmml">𝐫</mi><mn id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.2.2" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐞</mi><mn id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.3.cmml">1</mn><mi id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.2.3" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi></msubsup></mrow><mo id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS1.p2.11.m11.1.1.1.1.1.3" xref="S3.SS1.p2.11.m11.1.1.1.1.1.3.cmml">2</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><eq id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2"></eq><apply id="S3.SS1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.3.1.cmml" xref="S3.SS1.p2.11.m11.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.3.2.cmml" xref="S3.SS1.p2.11.m11.1.1.3.2">𝑐</ci><cn id="S3.SS1.p2.11.m11.1.1.3.3.cmml" type="integer" xref="S3.SS1.p2.11.m11.1.1.3.3">1</cn></apply><apply id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1"><arg id="S3.SS1.p2.11.m11.1.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.2"></arg><apply id="S3.SS1.p2.11.m11.1.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1"><apply id="S3.SS1.p2.11.m11.1.1.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.2">subscript</csymbol><min id="S3.SS1.p2.11.m11.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.2.2"></min><ci id="S3.SS1.p2.11.m11.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS1.p2.11.m11.1.1.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p2.11.m11.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.11.m11.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1"><minus id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.2">𝐫</ci><cn id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.3">0</cn></apply><apply id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.2.2">𝐞</ci><ci id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><cn id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><cn id="S3.SS1.p2.11.m11.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.11.m11.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">c_{1}=\arg\min_{k}\|\mathbf{r}_{0}-\mathbf{e}^{k}_{1}\|_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m11.1d">italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ bold_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - bold_e start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.
Next, we compute the residual at the second level, <math alttext="\mathbf{r}_{1}=\mathbf{r}_{0}-\mathbf{e}_{1}^{c_{1}}" class="ltx_Math" display="inline" id="S3.SS1.p2.12.m12.1"><semantics id="S3.SS1.p2.12.m12.1a"><mrow id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml"><msub id="S3.SS1.p2.12.m12.1.1.2" xref="S3.SS1.p2.12.m12.1.1.2.cmml"><mi id="S3.SS1.p2.12.m12.1.1.2.2" xref="S3.SS1.p2.12.m12.1.1.2.2.cmml">𝐫</mi><mn id="S3.SS1.p2.12.m12.1.1.2.3" xref="S3.SS1.p2.12.m12.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS1.p2.12.m12.1.1.1" xref="S3.SS1.p2.12.m12.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.12.m12.1.1.3" xref="S3.SS1.p2.12.m12.1.1.3.cmml"><msub id="S3.SS1.p2.12.m12.1.1.3.2" xref="S3.SS1.p2.12.m12.1.1.3.2.cmml"><mi id="S3.SS1.p2.12.m12.1.1.3.2.2" xref="S3.SS1.p2.12.m12.1.1.3.2.2.cmml">𝐫</mi><mn id="S3.SS1.p2.12.m12.1.1.3.2.3" xref="S3.SS1.p2.12.m12.1.1.3.2.3.cmml">0</mn></msub><mo id="S3.SS1.p2.12.m12.1.1.3.1" xref="S3.SS1.p2.12.m12.1.1.3.1.cmml">−</mo><msubsup id="S3.SS1.p2.12.m12.1.1.3.3" xref="S3.SS1.p2.12.m12.1.1.3.3.cmml"><mi id="S3.SS1.p2.12.m12.1.1.3.3.2.2" xref="S3.SS1.p2.12.m12.1.1.3.3.2.2.cmml">𝐞</mi><mn id="S3.SS1.p2.12.m12.1.1.3.3.2.3" xref="S3.SS1.p2.12.m12.1.1.3.3.2.3.cmml">1</mn><msub id="S3.SS1.p2.12.m12.1.1.3.3.3" xref="S3.SS1.p2.12.m12.1.1.3.3.3.cmml"><mi id="S3.SS1.p2.12.m12.1.1.3.3.3.2" xref="S3.SS1.p2.12.m12.1.1.3.3.3.2.cmml">c</mi><mn id="S3.SS1.p2.12.m12.1.1.3.3.3.3" xref="S3.SS1.p2.12.m12.1.1.3.3.3.3.cmml">1</mn></msub></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><apply id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1"><eq id="S3.SS1.p2.12.m12.1.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1.1"></eq><apply id="S3.SS1.p2.12.m12.1.1.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.2.1.cmml" xref="S3.SS1.p2.12.m12.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.2.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2.2">𝐫</ci><cn id="S3.SS1.p2.12.m12.1.1.2.3.cmml" type="integer" xref="S3.SS1.p2.12.m12.1.1.2.3">1</cn></apply><apply id="S3.SS1.p2.12.m12.1.1.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3"><minus id="S3.SS1.p2.12.m12.1.1.3.1.cmml" xref="S3.SS1.p2.12.m12.1.1.3.1"></minus><apply id="S3.SS1.p2.12.m12.1.1.3.2.cmml" xref="S3.SS1.p2.12.m12.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.3.2.1.cmml" xref="S3.SS1.p2.12.m12.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.3.2.2.cmml" xref="S3.SS1.p2.12.m12.1.1.3.2.2">𝐫</ci><cn id="S3.SS1.p2.12.m12.1.1.3.2.3.cmml" type="integer" xref="S3.SS1.p2.12.m12.1.1.3.2.3">0</cn></apply><apply id="S3.SS1.p2.12.m12.1.1.3.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.3.3.1.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3">superscript</csymbol><apply id="S3.SS1.p2.12.m12.1.1.3.3.2.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3.2.2">𝐞</ci><cn id="S3.SS1.p2.12.m12.1.1.3.3.2.3.cmml" type="integer" xref="S3.SS1.p2.12.m12.1.1.3.3.2.3">1</cn></apply><apply id="S3.SS1.p2.12.m12.1.1.3.3.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.3.3.3.1.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.3.3.3.2.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3.3.2">𝑐</ci><cn id="S3.SS1.p2.12.m12.1.1.3.3.3.3.cmml" type="integer" xref="S3.SS1.p2.12.m12.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">\mathbf{r}_{1}=\mathbf{r}_{0}-\mathbf{e}_{1}^{c_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.12.m12.1d">bold_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = bold_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - bold_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, which captures the information not represented by the first code vector. This residual is then approximated using the second codebook <math alttext="\mathbf{C}_{2}" class="ltx_Math" display="inline" id="S3.SS1.p2.13.m13.1"><semantics id="S3.SS1.p2.13.m13.1a"><msub id="S3.SS1.p2.13.m13.1.1" xref="S3.SS1.p2.13.m13.1.1.cmml"><mi id="S3.SS1.p2.13.m13.1.1.2" xref="S3.SS1.p2.13.m13.1.1.2.cmml">𝐂</mi><mn id="S3.SS1.p2.13.m13.1.1.3" xref="S3.SS1.p2.13.m13.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m13.1b"><apply id="S3.SS1.p2.13.m13.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.1.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p2.13.m13.1.1.2.cmml" xref="S3.SS1.p2.13.m13.1.1.2">𝐂</ci><cn id="S3.SS1.p2.13.m13.1.1.3.cmml" type="integer" xref="S3.SS1.p2.13.m13.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m13.1c">\mathbf{C}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.13.m13.1d">bold_C start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. By iteratively repeating this procedure <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p2.14.m14.1"><semantics id="S3.SS1.p2.14.m14.1a"><mi id="S3.SS1.p2.14.m14.1.1" xref="S3.SS1.p2.14.m14.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m14.1b"><ci id="S3.SS1.p2.14.m14.1.1.cmml" xref="S3.SS1.p2.14.m14.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m14.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.14.m14.1d">italic_M</annotation></semantics></math> times, we generate a tuple of <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p2.15.m15.1"><semantics id="S3.SS1.p2.15.m15.1a"><mi id="S3.SS1.p2.15.m15.1.1" xref="S3.SS1.p2.15.m15.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m15.1b"><ci id="S3.SS1.p2.15.m15.1.1.cmml" xref="S3.SS1.p2.15.m15.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m15.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.15.m15.1d">italic_M</annotation></semantics></math> codes <math alttext="(c_{1},\dots,c_{M})" class="ltx_Math" display="inline" id="S3.SS1.p2.16.m16.3"><semantics id="S3.SS1.p2.16.m16.3a"><mrow id="S3.SS1.p2.16.m16.3.3.2" xref="S3.SS1.p2.16.m16.3.3.3.cmml"><mo id="S3.SS1.p2.16.m16.3.3.2.3" stretchy="false" xref="S3.SS1.p2.16.m16.3.3.3.cmml">(</mo><msub id="S3.SS1.p2.16.m16.2.2.1.1" xref="S3.SS1.p2.16.m16.2.2.1.1.cmml"><mi id="S3.SS1.p2.16.m16.2.2.1.1.2" xref="S3.SS1.p2.16.m16.2.2.1.1.2.cmml">c</mi><mn id="S3.SS1.p2.16.m16.2.2.1.1.3" xref="S3.SS1.p2.16.m16.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.16.m16.3.3.2.4" xref="S3.SS1.p2.16.m16.3.3.3.cmml">,</mo><mi id="S3.SS1.p2.16.m16.1.1" mathvariant="normal" xref="S3.SS1.p2.16.m16.1.1.cmml">…</mi><mo id="S3.SS1.p2.16.m16.3.3.2.5" xref="S3.SS1.p2.16.m16.3.3.3.cmml">,</mo><msub id="S3.SS1.p2.16.m16.3.3.2.2" xref="S3.SS1.p2.16.m16.3.3.2.2.cmml"><mi id="S3.SS1.p2.16.m16.3.3.2.2.2" xref="S3.SS1.p2.16.m16.3.3.2.2.2.cmml">c</mi><mi id="S3.SS1.p2.16.m16.3.3.2.2.3" xref="S3.SS1.p2.16.m16.3.3.2.2.3.cmml">M</mi></msub><mo id="S3.SS1.p2.16.m16.3.3.2.6" stretchy="false" xref="S3.SS1.p2.16.m16.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.16.m16.3b"><vector id="S3.SS1.p2.16.m16.3.3.3.cmml" xref="S3.SS1.p2.16.m16.3.3.2"><apply id="S3.SS1.p2.16.m16.2.2.1.1.cmml" xref="S3.SS1.p2.16.m16.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.16.m16.2.2.1.1.1.cmml" xref="S3.SS1.p2.16.m16.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p2.16.m16.2.2.1.1.2.cmml" xref="S3.SS1.p2.16.m16.2.2.1.1.2">𝑐</ci><cn id="S3.SS1.p2.16.m16.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p2.16.m16.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p2.16.m16.1.1.cmml" xref="S3.SS1.p2.16.m16.1.1">…</ci><apply id="S3.SS1.p2.16.m16.3.3.2.2.cmml" xref="S3.SS1.p2.16.m16.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.16.m16.3.3.2.2.1.cmml" xref="S3.SS1.p2.16.m16.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p2.16.m16.3.3.2.2.2.cmml" xref="S3.SS1.p2.16.m16.3.3.2.2.2">𝑐</ci><ci id="S3.SS1.p2.16.m16.3.3.2.2.3.cmml" xref="S3.SS1.p2.16.m16.3.3.2.2.3">𝑀</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.16.m16.3c">(c_{1},\dots,c_{M})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.16.m16.3d">( italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT )</annotation></semantics></math>, which are denoted as semantic tokens.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1. </span>Reconstructive Quantization</h4>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.6">As illustrated in the lower left of Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S3.F2" title="Figure 2 ‣ 3. Approach ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, existing work typically trains the quantizer by minimizing the reconstruction loss between the reconstructed vector and the input vector. Specifically, given the semantic tokens after quantization, we construct an approximated vector <math alttext="\widehat{\mathbf{z}}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.1.m1.1"><semantics id="S3.SS1.SSS1.p1.1.m1.1a"><mover accent="true" id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.1.m1.1.1.2" xref="S3.SS1.SSS1.p1.1.m1.1.1.2.cmml">𝐳</mi><mo id="S3.SS1.SSS1.p1.1.m1.1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.1b"><apply id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1"><ci id="S3.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1.1">^</ci><ci id="S3.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1.2">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.1c">\widehat{\mathbf{z}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.1.m1.1d">over^ start_ARG bold_z end_ARG</annotation></semantics></math> by summing over <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.2.m2.1"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><mi id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><ci id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.2.m2.1d">italic_M</annotation></semantics></math> code vectors: <math alttext="\widehat{\mathbf{z}}=\sum_{i=1}^{M}\mathbf{e}_{i}^{c_{i}}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.3.m3.1"><semantics id="S3.SS1.SSS1.p1.3.m3.1a"><mrow id="S3.SS1.SSS1.p1.3.m3.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.cmml"><mover accent="true" id="S3.SS1.SSS1.p1.3.m3.1.1.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.1.1.2.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.2.cmml">𝐳</mi><mo id="S3.SS1.SSS1.p1.3.m3.1.1.2.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS1.SSS1.p1.3.m3.1.1.1" rspace="0.111em" xref="S3.SS1.SSS1.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S3.SS1.SSS1.p1.3.m3.1.1.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml"><msubsup id="S3.SS1.SSS1.p1.3.m3.1.1.3.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.cmml"><mo id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.3.cmml">M</mi></msubsup><msubsup id="S3.SS1.SSS1.p1.3.m3.1.1.3.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.2.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.2.2.cmml">𝐞</mi><mi id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.2.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.2.3.cmml">i</mi><msub id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3.2.cmml">c</mi><mi id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3.3.cmml">i</mi></msub></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m3.1b"><apply id="S3.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1"><eq id="S3.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.1"></eq><apply id="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.2"><ci id="S3.SS1.SSS1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.1">^</ci><ci id="S3.SS1.SSS1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.2">𝐳</ci></apply><apply id="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3"><apply id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1">superscript</csymbol><apply id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1">subscript</csymbol><sum id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.2"></sum><apply id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3"><eq id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.1"></eq><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.2">𝑖</ci><cn id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.3">𝑀</ci></apply><apply id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2">superscript</csymbol><apply id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.2.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.2.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.2.2">𝐞</ci><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.2.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3">subscript</csymbol><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3.2">𝑐</ci><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m3.1c">\widehat{\mathbf{z}}=\sum_{i=1}^{M}\mathbf{e}_{i}^{c_{i}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.3.m3.1d">over^ start_ARG bold_z end_ARG = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. This approximated vector <math alttext="\widehat{\mathbf{z}}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.4.m4.1"><semantics id="S3.SS1.SSS1.p1.4.m4.1a"><mover accent="true" id="S3.SS1.SSS1.p1.4.m4.1.1" xref="S3.SS1.SSS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.SSS1.p1.4.m4.1.1.2" xref="S3.SS1.SSS1.p1.4.m4.1.1.2.cmml">𝐳</mi><mo id="S3.SS1.SSS1.p1.4.m4.1.1.1" xref="S3.SS1.SSS1.p1.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.4.m4.1b"><apply id="S3.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1"><ci id="S3.SS1.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.1">^</ci><ci id="S3.SS1.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS1.p1.4.m4.1.1.2">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.4.m4.1c">\widehat{\mathbf{z}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.4.m4.1d">over^ start_ARG bold_z end_ARG</annotation></semantics></math> is then fed into a decoder (e.g., an MLP) to produce <math alttext="\widehat{x}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.5.m5.1"><semantics id="S3.SS1.SSS1.p1.5.m5.1a"><mover accent="true" id="S3.SS1.SSS1.p1.5.m5.1.1" xref="S3.SS1.SSS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.SSS1.p1.5.m5.1.1.2" xref="S3.SS1.SSS1.p1.5.m5.1.1.2.cmml">x</mi><mo id="S3.SS1.SSS1.p1.5.m5.1.1.1" xref="S3.SS1.SSS1.p1.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.5.m5.1b"><apply id="S3.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1"><ci id="S3.SS1.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.1">^</ci><ci id="S3.SS1.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p1.5.m5.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.5.m5.1c">\widehat{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.5.m5.1d">over^ start_ARG italic_x end_ARG</annotation></semantics></math>, which serves as a reconstruction of the input <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.6.m6.1"><semantics id="S3.SS1.SSS1.p1.6.m6.1a"><mi id="S3.SS1.SSS1.p1.6.m6.1.1" xref="S3.SS1.SSS1.p1.6.m6.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.6.m6.1b"><ci id="S3.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m6.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.6.m6.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.6.m6.1d">bold_x</annotation></semantics></math>. Similar to the popular VQ-VAE technique <cite class="ltx_cite ltx_citemacro_citep">(Van Den Oord et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib29" title="">2017</a>)</cite>, the training loss function for reconstructive quantization is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{re}}=\mathcal{L}_{\text{mse}}+\mathcal{L}_{\text{rq}}" class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><msub id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.2.2" xref="S3.E1.m1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E1.m1.1.1.2.3" xref="S3.E1.m1.1.1.2.3a.cmml">re</mtext></msub><mo id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><msub id="S3.E1.m1.1.1.3.2" xref="S3.E1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.3.2.2" xref="S3.E1.m1.1.1.3.2.2.cmml">ℒ</mi><mtext id="S3.E1.m1.1.1.3.2.3" xref="S3.E1.m1.1.1.3.2.3a.cmml">mse</mtext></msub><mo id="S3.E1.m1.1.1.3.1" xref="S3.E1.m1.1.1.3.1.cmml">+</mo><msub id="S3.E1.m1.1.1.3.3" xref="S3.E1.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.3.3.2" xref="S3.E1.m1.1.1.3.3.2.cmml">ℒ</mi><mtext id="S3.E1.m1.1.1.3.3.3" xref="S3.E1.m1.1.1.3.3.3a.cmml">rq</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><eq id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"></eq><apply id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.2.2">ℒ</ci><ci id="S3.E1.m1.1.1.2.3a.cmml" xref="S3.E1.m1.1.1.2.3"><mtext id="S3.E1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.2.3">re</mtext></ci></apply><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><plus id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3.1"></plus><apply id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.3.2.2">ℒ</ci><ci id="S3.E1.m1.1.1.3.2.3a.cmml" xref="S3.E1.m1.1.1.3.2.3"><mtext id="S3.E1.m1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.3.2.3">mse</mtext></ci></apply><apply id="S3.E1.m1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.3.3.2">ℒ</ci><ci id="S3.E1.m1.1.1.3.3.3a.cmml" xref="S3.E1.m1.1.1.3.3.3"><mtext id="S3.E1.m1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.3.3.3">rq</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\mathcal{L}_{\text{re}}=\mathcal{L}_{\text{mse}}+\mathcal{L}_{\text{rq}}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">caligraphic_L start_POSTSUBSCRIPT re end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT mse end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT rq end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS1.p1.8">which consists of two main terms: <math alttext="\mathcal{L}_{\text{mse}}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.7.m1.1"><semantics id="S3.SS1.SSS1.p1.7.m1.1a"><msub id="S3.SS1.SSS1.p1.7.m1.1.1" xref="S3.SS1.SSS1.p1.7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.7.m1.1.1.2" xref="S3.SS1.SSS1.p1.7.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS1.p1.7.m1.1.1.3" xref="S3.SS1.SSS1.p1.7.m1.1.1.3a.cmml">mse</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.7.m1.1b"><apply id="S3.SS1.SSS1.p1.7.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.7.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.7.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1.2">ℒ</ci><ci id="S3.SS1.SSS1.p1.7.m1.1.1.3a.cmml" xref="S3.SS1.SSS1.p1.7.m1.1.1.3"><mtext id="S3.SS1.SSS1.p1.7.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS1.p1.7.m1.1.1.3">mse</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.7.m1.1c">\mathcal{L}_{\text{mse}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.7.m1.1d">caligraphic_L start_POSTSUBSCRIPT mse end_POSTSUBSCRIPT</annotation></semantics></math>, which represents the MSE reconstruction loss and <math alttext="\mathcal{L}_{\text{rq}}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.8.m2.1"><semantics id="S3.SS1.SSS1.p1.8.m2.1a"><msub id="S3.SS1.SSS1.p1.8.m2.1.1" xref="S3.SS1.SSS1.p1.8.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.8.m2.1.1.2" xref="S3.SS1.SSS1.p1.8.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS1.p1.8.m2.1.1.3" xref="S3.SS1.SSS1.p1.8.m2.1.1.3a.cmml">rq</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.8.m2.1b"><apply id="S3.SS1.SSS1.p1.8.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.8.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.8.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.8.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p1.8.m2.1.1.2">ℒ</ci><ci id="S3.SS1.SSS1.p1.8.m2.1.1.3a.cmml" xref="S3.SS1.SSS1.p1.8.m2.1.1.3"><mtext id="S3.SS1.SSS1.p1.8.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS1.p1.8.m2.1.1.3">rq</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.8.m2.1c">\mathcal{L}_{\text{rq}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.8.m2.1d">caligraphic_L start_POSTSUBSCRIPT rq end_POSTSUBSCRIPT</annotation></semantics></math>, which denotes the quantization loss for codebook learning.
</p>
<table class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table" id="S5.EGx1">
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{mse}}" class="ltx_Math" display="inline" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><msub id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3a.cmml">mse</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">ℒ</ci><ci id="S3.E2.m1.1.1.3a.cmml" xref="S3.E2.m1.1.1.3"><mtext id="S3.E2.m1.1.1.3.cmml" mathsize="70%" xref="S3.E2.m1.1.1.3">mse</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle\mathcal{L}_{\text{mse}}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">caligraphic_L start_POSTSUBSCRIPT mse end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="S3.E2.m2.1"><semantics id="S3.E2.m2.1a"><mo id="S3.E2.m2.1.1" xref="S3.E2.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E2.m2.1b"><eq id="S3.E2.m2.1.1.cmml" xref="S3.E2.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m2.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\|\mathbf{x}-\widehat{\mathbf{x}}\|_{2}^{2}" class="ltx_Math" display="inline" id="S3.E2.m3.1"><semantics id="S3.E2.m3.1a"><msubsup id="S3.E2.m3.1.1" xref="S3.E2.m3.1.1.cmml"><mrow id="S3.E2.m3.1.1.1.1.1" xref="S3.E2.m3.1.1.1.1.2.cmml"><mo id="S3.E2.m3.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m3.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E2.m3.1.1.1.1.1.1" xref="S3.E2.m3.1.1.1.1.1.1.cmml"><mi id="S3.E2.m3.1.1.1.1.1.1.2" xref="S3.E2.m3.1.1.1.1.1.1.2.cmml">𝐱</mi><mo id="S3.E2.m3.1.1.1.1.1.1.1" xref="S3.E2.m3.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S3.E2.m3.1.1.1.1.1.1.3" xref="S3.E2.m3.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m3.1.1.1.1.1.1.3.2" xref="S3.E2.m3.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mo id="S3.E2.m3.1.1.1.1.1.1.3.1" xref="S3.E2.m3.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S3.E2.m3.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m3.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E2.m3.1.1.1.3" xref="S3.E2.m3.1.1.1.3.cmml">2</mn><mn id="S3.E2.m3.1.1.3" xref="S3.E2.m3.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.E2.m3.1b"><apply id="S3.E2.m3.1.1.cmml" xref="S3.E2.m3.1.1"><csymbol cd="ambiguous" id="S3.E2.m3.1.1.2.cmml" xref="S3.E2.m3.1.1">superscript</csymbol><apply id="S3.E2.m3.1.1.1.cmml" xref="S3.E2.m3.1.1"><csymbol cd="ambiguous" id="S3.E2.m3.1.1.1.2.cmml" xref="S3.E2.m3.1.1">subscript</csymbol><apply id="S3.E2.m3.1.1.1.1.2.cmml" xref="S3.E2.m3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m3.1.1.1.1.2.1.cmml" xref="S3.E2.m3.1.1.1.1.1.2">norm</csymbol><apply id="S3.E2.m3.1.1.1.1.1.1.cmml" xref="S3.E2.m3.1.1.1.1.1.1"><minus id="S3.E2.m3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m3.1.1.1.1.1.1.1"></minus><ci id="S3.E2.m3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m3.1.1.1.1.1.1.2">𝐱</ci><apply id="S3.E2.m3.1.1.1.1.1.1.3.cmml" xref="S3.E2.m3.1.1.1.1.1.1.3"><ci id="S3.E2.m3.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m3.1.1.1.1.1.1.3.1">^</ci><ci id="S3.E2.m3.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m3.1.1.1.1.1.1.3.2">𝐱</ci></apply></apply></apply><cn id="S3.E2.m3.1.1.1.3.cmml" type="integer" xref="S3.E2.m3.1.1.1.3">2</cn></apply><cn id="S3.E2.m3.1.1.3.cmml" type="integer" xref="S3.E2.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m3.1c">\displaystyle\|\mathbf{x}-\widehat{\mathbf{x}}\|_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m3.1d">∥ bold_x - over^ start_ARG bold_x end_ARG ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{rq}}" class="ltx_Math" display="inline" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><msub id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3a.cmml">rq</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2">ℒ</ci><ci id="S3.E3.m1.1.1.3a.cmml" xref="S3.E3.m1.1.1.3"><mtext id="S3.E3.m1.1.1.3.cmml" mathsize="70%" xref="S3.E3.m1.1.1.3">rq</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle\mathcal{L}_{\text{rq}}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">caligraphic_L start_POSTSUBSCRIPT rq end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math alttext="\displaystyle=" class="ltx_Math" display="inline" id="S3.E3.m2.1"><semantics id="S3.E3.m2.1a"><mo id="S3.E3.m2.1.1" xref="S3.E3.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S3.E3.m2.1b"><eq id="S3.E3.m2.1.1.cmml" xref="S3.E3.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m2.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\sum\nolimits_{i=1}^{M}{\|\mathrm{sg}(\mathbf{r}_{i-1})-\mathbf{e%
}_{i}^{c_{i}}\|_{2}^{2}}+\beta\|\mathbf{r}_{i-1}-\mathrm{sg}(\mathbf{e}_{i}^{c%
_{i}})\|_{2}^{2}" class="ltx_Math" display="inline" id="S3.E3.m3.2"><semantics id="S3.E3.m3.2a"><mrow id="S3.E3.m3.2.2" xref="S3.E3.m3.2.2.cmml"><mrow id="S3.E3.m3.1.1.1" xref="S3.E3.m3.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E3.m3.1.1.1.2" xref="S3.E3.m3.1.1.1.2.cmml"><msubsup id="S3.E3.m3.1.1.1.2a" xref="S3.E3.m3.1.1.1.2.cmml"><mo id="S3.E3.m3.1.1.1.2.2.2" xref="S3.E3.m3.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m3.1.1.1.2.2.3" xref="S3.E3.m3.1.1.1.2.2.3.cmml"><mi id="S3.E3.m3.1.1.1.2.2.3.2" xref="S3.E3.m3.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E3.m3.1.1.1.2.2.3.1" xref="S3.E3.m3.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m3.1.1.1.2.2.3.3" xref="S3.E3.m3.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m3.1.1.1.2.3" xref="S3.E3.m3.1.1.1.2.3.cmml">M</mi></msubsup></mstyle><msubsup id="S3.E3.m3.1.1.1.1" xref="S3.E3.m3.1.1.1.1.cmml"><mrow id="S3.E3.m3.1.1.1.1.1.1.1" xref="S3.E3.m3.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m3.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E3.m3.1.1.1.1.1.1.1.1" xref="S3.E3.m3.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m3.1.1.1.1.1.1.1.1.1" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m3.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.3.cmml">sg</mi><mo id="S3.E3.m3.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐫</mi><mrow id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m3.1.1.1.1.1.1.1.1.2" xref="S3.E3.m3.1.1.1.1.1.1.1.1.2.cmml">−</mo><msubsup id="S3.E3.m3.1.1.1.1.1.1.1.1.3" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m3.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐞</mi><mi id="S3.E3.m3.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><msub id="S3.E3.m3.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m3.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3.3.2.cmml">c</mi><mi id="S3.E3.m3.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msubsup></mrow><mo id="S3.E3.m3.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m3.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E3.m3.1.1.1.1.1.3" xref="S3.E3.m3.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E3.m3.1.1.1.1.3" xref="S3.E3.m3.1.1.1.1.3.cmml">2</mn></msubsup></mrow><mo id="S3.E3.m3.2.2.3" xref="S3.E3.m3.2.2.3.cmml">+</mo><mrow id="S3.E3.m3.2.2.2" xref="S3.E3.m3.2.2.2.cmml"><mi id="S3.E3.m3.2.2.2.3" xref="S3.E3.m3.2.2.2.3.cmml">β</mi><mo id="S3.E3.m3.2.2.2.2" xref="S3.E3.m3.2.2.2.2.cmml">⁢</mo><msubsup id="S3.E3.m3.2.2.2.1" xref="S3.E3.m3.2.2.2.1.cmml"><mrow id="S3.E3.m3.2.2.2.1.1.1.1" xref="S3.E3.m3.2.2.2.1.1.1.2.cmml"><mo id="S3.E3.m3.2.2.2.1.1.1.1.2" stretchy="false" xref="S3.E3.m3.2.2.2.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E3.m3.2.2.2.1.1.1.1.1" xref="S3.E3.m3.2.2.2.1.1.1.1.1.cmml"><msub id="S3.E3.m3.2.2.2.1.1.1.1.1.3" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E3.m3.2.2.2.1.1.1.1.1.3.2" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3.2.cmml">𝐫</mi><mrow id="S3.E3.m3.2.2.2.1.1.1.1.1.3.3" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.2" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.1" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.3" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E3.m3.2.2.2.1.1.1.1.1.2" xref="S3.E3.m3.2.2.2.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E3.m3.2.2.2.1.1.1.1.1.1" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E3.m3.2.2.2.1.1.1.1.1.1.3" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.3.cmml">sg</mi><mo id="S3.E3.m3.2.2.2.1.1.1.1.1.1.2" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐞</mi><mi id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><msub id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mi id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msubsup><mo id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m3.2.2.2.1.1.1.1.3" stretchy="false" xref="S3.E3.m3.2.2.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E3.m3.2.2.2.1.1.3" xref="S3.E3.m3.2.2.2.1.1.3.cmml">2</mn><mn id="S3.E3.m3.2.2.2.1.3" xref="S3.E3.m3.2.2.2.1.3.cmml">2</mn></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m3.2b"><apply id="S3.E3.m3.2.2.cmml" xref="S3.E3.m3.2.2"><plus id="S3.E3.m3.2.2.3.cmml" xref="S3.E3.m3.2.2.3"></plus><apply id="S3.E3.m3.1.1.1.cmml" xref="S3.E3.m3.1.1.1"><apply id="S3.E3.m3.1.1.1.2.cmml" xref="S3.E3.m3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m3.1.1.1.2.1.cmml" xref="S3.E3.m3.1.1.1.2">superscript</csymbol><apply id="S3.E3.m3.1.1.1.2.2.cmml" xref="S3.E3.m3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m3.1.1.1.2.2.1.cmml" xref="S3.E3.m3.1.1.1.2">subscript</csymbol><sum id="S3.E3.m3.1.1.1.2.2.2.cmml" xref="S3.E3.m3.1.1.1.2.2.2"></sum><apply id="S3.E3.m3.1.1.1.2.2.3.cmml" xref="S3.E3.m3.1.1.1.2.2.3"><eq id="S3.E3.m3.1.1.1.2.2.3.1.cmml" xref="S3.E3.m3.1.1.1.2.2.3.1"></eq><ci id="S3.E3.m3.1.1.1.2.2.3.2.cmml" xref="S3.E3.m3.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E3.m3.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E3.m3.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E3.m3.1.1.1.2.3.cmml" xref="S3.E3.m3.1.1.1.2.3">𝑀</ci></apply><apply id="S3.E3.m3.1.1.1.1.cmml" xref="S3.E3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m3.1.1.1.1.2.cmml" xref="S3.E3.m3.1.1.1.1">superscript</csymbol><apply id="S3.E3.m3.1.1.1.1.1.cmml" xref="S3.E3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m3.1.1.1.1.1.2.cmml" xref="S3.E3.m3.1.1.1.1">subscript</csymbol><apply id="S3.E3.m3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1"><minus id="S3.E3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.2"></minus><apply id="S3.E3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1"><times id="S3.E3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.3">sg</ci><apply id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐫</ci><apply id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E3.m3.1.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S3.E3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E3.m3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m3.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3.2.2">𝐞</ci><ci id="S3.E3.m3.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.E3.m3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E3.m3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3.3.2">𝑐</ci><ci id="S3.E3.m3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m3.1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply><cn id="S3.E3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m3.1.1.1.1.1.3">2</cn></apply><cn id="S3.E3.m3.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m3.1.1.1.1.3">2</cn></apply></apply><apply id="S3.E3.m3.2.2.2.cmml" xref="S3.E3.m3.2.2.2"><times id="S3.E3.m3.2.2.2.2.cmml" xref="S3.E3.m3.2.2.2.2"></times><ci id="S3.E3.m3.2.2.2.3.cmml" xref="S3.E3.m3.2.2.2.3">𝛽</ci><apply id="S3.E3.m3.2.2.2.1.cmml" xref="S3.E3.m3.2.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m3.2.2.2.1.2.cmml" xref="S3.E3.m3.2.2.2.1">superscript</csymbol><apply id="S3.E3.m3.2.2.2.1.1.cmml" xref="S3.E3.m3.2.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m3.2.2.2.1.1.2.cmml" xref="S3.E3.m3.2.2.2.1">subscript</csymbol><apply id="S3.E3.m3.2.2.2.1.1.1.2.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m3.2.2.2.1.1.1.2.1.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.2">norm</csymbol><apply id="S3.E3.m3.2.2.2.1.1.1.1.1.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1"><minus id="S3.E3.m3.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.2"></minus><apply id="S3.E3.m3.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m3.2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m3.2.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3.2">𝐫</ci><apply id="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3.3"><minus id="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.1"></minus><ci id="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.2">𝑖</ci><cn id="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E3.m3.2.2.2.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E3.m3.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1"><times id="S3.E3.m3.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.2"></times><ci id="S3.E3.m3.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.3">sg</ci><apply id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.2.2">𝐞</ci><ci id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m3.2.2.2.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply><cn id="S3.E3.m3.2.2.2.1.1.3.cmml" type="integer" xref="S3.E3.m3.2.2.2.1.1.3">2</cn></apply><cn id="S3.E3.m3.2.2.2.1.3.cmml" type="integer" xref="S3.E3.m3.2.2.2.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m3.2c">\displaystyle\sum\nolimits_{i=1}^{M}{\|\mathrm{sg}(\mathbf{r}_{i-1})-\mathbf{e%
}_{i}^{c_{i}}\|_{2}^{2}}+\beta\|\mathbf{r}_{i-1}-\mathrm{sg}(\mathbf{e}_{i}^{c%
_{i}})\|_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m3.2d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT ∥ roman_sg ( bold_r start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ) - bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_β ∥ bold_r start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT - roman_sg ( bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS1.p1.10">where <math alttext="\mathrm{sg}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.9.m1.1"><semantics id="S3.SS1.SSS1.p1.9.m1.1a"><mi id="S3.SS1.SSS1.p1.9.m1.1.1" xref="S3.SS1.SSS1.p1.9.m1.1.1.cmml">sg</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.9.m1.1b"><ci id="S3.SS1.SSS1.p1.9.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.9.m1.1.1">sg</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.9.m1.1c">\mathrm{sg}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.9.m1.1d">roman_sg</annotation></semantics></math> denotes the stop-gradient operation <cite class="ltx_cite ltx_citemacro_citep">(van den Oord et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib30" title="">2018</a>)</cite>. The loss term <math alttext="\mathcal{L}_{\text{rq}}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.10.m2.1"><semantics id="S3.SS1.SSS1.p1.10.m2.1a"><msub id="S3.SS1.SSS1.p1.10.m2.1.1" xref="S3.SS1.SSS1.p1.10.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS1.p1.10.m2.1.1.2" xref="S3.SS1.SSS1.p1.10.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS1.p1.10.m2.1.1.3" xref="S3.SS1.SSS1.p1.10.m2.1.1.3a.cmml">rq</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.10.m2.1b"><apply id="S3.SS1.SSS1.p1.10.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.10.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.10.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p1.10.m2.1.1.2">ℒ</ci><ci id="S3.SS1.SSS1.p1.10.m2.1.1.3a.cmml" xref="S3.SS1.SSS1.p1.10.m2.1.1.3"><mtext id="S3.SS1.SSS1.p1.10.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS1.p1.10.m2.1.1.3">rq</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.10.m2.1c">\mathcal{L}_{\text{rq}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.10.m2.1d">caligraphic_L start_POSTSUBSCRIPT rq end_POSTSUBSCRIPT</annotation></semantics></math> acts as a straight-through estimator for quantization, enabling end-to-end training of the encoder, decoder, and codebooks.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS1.p2">
<p class="ltx_p" id="S3.SS1.SSS1.p2.1">To prevent the codebook collapse issue <cite class="ltx_cite ltx_citemacro_citep">(Huh et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib11" title="">2023</a>)</cite>, which refers to the under-utilization of codebook vectors, we employ an initialization approach based on k-means clustering <cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib41" title="">2021</a>)</cite>. During the initial training batch, the k-means algorithm is applied, and the resulting centroids are used to initialize the codebook vectors.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2. </span>Contrastive Quantization</h4>
<div class="ltx_para" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.1">Reconstructive quantization aims for the precise reconstruction of each item embedding independently, which can lead to a suboptimal distribution of the learned semantic token space when applied to generative recommendation models. Unlike visual tokens, which require pixel-level decoding for image generation <cite class="ltx_cite ltx_citemacro_citep">(Van Den Oord et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib29" title="">2017</a>)</cite>, generative retrieval tasks focus more on differentiating among items. Consequently, we introduce a contrastive quantization-based semantic tokenization method, CoST, to capture both semantic information of items and their neighborhood relationships.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS2.p2">
<p class="ltx_p" id="S3.SS1.SSS2.p2.3">Specifically, as shown in the lower right of Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S3.F2" title="Figure 2 ‣ 3. Approach ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, we enforce the positive pair between the input vector <math alttext="\mathbf{x}_{0}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.1.m1.1"><semantics id="S3.SS1.SSS2.p2.1.m1.1a"><msub id="S3.SS1.SSS2.p2.1.m1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p2.1.m1.1.1.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.SSS2.p2.1.m1.1.1.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.1.m1.1b"><apply id="S3.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.2">𝐱</ci><cn id="S3.SS1.SSS2.p2.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.SSS2.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.1.m1.1c">\mathbf{x}_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.1.m1.1d">bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and the reconstructed vector <math alttext="\widehat{\mathbf{x}_{0}}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.2.m2.1"><semantics id="S3.SS1.SSS2.p2.2.m2.1a"><mover accent="true" id="S3.SS1.SSS2.p2.2.m2.1.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.cmml"><msub id="S3.SS1.SSS2.p2.2.m2.1.1.2" xref="S3.SS1.SSS2.p2.2.m2.1.1.2.cmml"><mi id="S3.SS1.SSS2.p2.2.m2.1.1.2.2" xref="S3.SS1.SSS2.p2.2.m2.1.1.2.2.cmml">𝐱</mi><mn id="S3.SS1.SSS2.p2.2.m2.1.1.2.3" xref="S3.SS1.SSS2.p2.2.m2.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS1.SSS2.p2.2.m2.1.1.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.2.m2.1b"><apply id="S3.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1"><ci id="S3.SS1.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.1">^</ci><apply id="S3.SS1.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1.2.2">𝐱</ci><cn id="S3.SS1.SSS2.p2.2.m2.1.1.2.3.cmml" type="integer" xref="S3.SS1.SSS2.p2.2.m2.1.1.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.2.m2.1c">\widehat{\mathbf{x}_{0}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.2.m2.1d">over^ start_ARG bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> to be closer than other vectors <math alttext="\{\widehat{\mathbf{x}_{i}}|i=1,\ldots,K\}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.3.m3.5"><semantics id="S3.SS1.SSS2.p2.3.m3.5a"><mrow id="S3.SS1.SSS2.p2.3.m3.5.5.1" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.cmml"><mo id="S3.SS1.SSS2.p2.3.m3.5.5.1.2" stretchy="false" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.1.cmml">{</mo><mover accent="true" id="S3.SS1.SSS2.p2.3.m3.4.4" xref="S3.SS1.SSS2.p2.3.m3.4.4.cmml"><msub id="S3.SS1.SSS2.p2.3.m3.4.4.2" xref="S3.SS1.SSS2.p2.3.m3.4.4.2.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.4.4.2.2" xref="S3.SS1.SSS2.p2.3.m3.4.4.2.2.cmml">𝐱</mi><mi id="S3.SS1.SSS2.p2.3.m3.4.4.2.3" xref="S3.SS1.SSS2.p2.3.m3.4.4.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS2.p2.3.m3.4.4.1" xref="S3.SS1.SSS2.p2.3.m3.4.4.1.cmml">^</mo></mover><mo id="S3.SS1.SSS2.p2.3.m3.5.5.1.3" lspace="0em" rspace="0em" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.1.cmml">|</mo><mrow id="S3.SS1.SSS2.p2.3.m3.5.5.1.1" xref="S3.SS1.SSS2.p2.3.m3.5.5.1.1.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.5.5.1.1.2" xref="S3.SS1.SSS2.p2.3.m3.5.5.1.1.2.cmml">i</mi><mo id="S3.SS1.SSS2.p2.3.m3.5.5.1.1.1" xref="S3.SS1.SSS2.p2.3.m3.5.5.1.1.1.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.3.m3.5.5.1.1.3.2" xref="S3.SS1.SSS2.p2.3.m3.5.5.1.1.3.1.cmml"><mn id="S3.SS1.SSS2.p2.3.m3.1.1" xref="S3.SS1.SSS2.p2.3.m3.1.1.cmml">1</mn><mo id="S3.SS1.SSS2.p2.3.m3.5.5.1.1.3.2.1" xref="S3.SS1.SSS2.p2.3.m3.5.5.1.1.3.1.cmml">,</mo><mi id="S3.SS1.SSS2.p2.3.m3.2.2" mathvariant="normal" xref="S3.SS1.SSS2.p2.3.m3.2.2.cmml">…</mi><mo id="S3.SS1.SSS2.p2.3.m3.5.5.1.1.3.2.2" xref="S3.SS1.SSS2.p2.3.m3.5.5.1.1.3.1.cmml">,</mo><mi id="S3.SS1.SSS2.p2.3.m3.3.3" xref="S3.SS1.SSS2.p2.3.m3.3.3.cmml">K</mi></mrow></mrow><mo id="S3.SS1.SSS2.p2.3.m3.5.5.1.4" stretchy="false" xref="S3.SS1.SSS2.p2.3.m3.5.5.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.3.m3.5b"><apply id="S3.SS1.SSS2.p2.3.m3.5.5.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.1"><csymbol cd="latexml" id="S3.SS1.SSS2.p2.3.m3.5.5.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.1.2">conditional-set</csymbol><apply id="S3.SS1.SSS2.p2.3.m3.4.4.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4"><ci id="S3.SS1.SSS2.p2.3.m3.4.4.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.1">^</ci><apply id="S3.SS1.SSS2.p2.3.m3.4.4.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.4.4.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.2">subscript</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.4.4.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.2.2">𝐱</ci><ci id="S3.SS1.SSS2.p2.3.m3.4.4.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.2.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS2.p2.3.m3.5.5.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.1.1"><eq id="S3.SS1.SSS2.p2.3.m3.5.5.1.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.1.1.1"></eq><ci id="S3.SS1.SSS2.p2.3.m3.5.5.1.1.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.1.1.2">𝑖</ci><list id="S3.SS1.SSS2.p2.3.m3.5.5.1.1.3.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5.1.1.3.2"><cn id="S3.SS1.SSS2.p2.3.m3.1.1.cmml" type="integer" xref="S3.SS1.SSS2.p2.3.m3.1.1">1</cn><ci id="S3.SS1.SSS2.p2.3.m3.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.2.2">…</ci><ci id="S3.SS1.SSS2.p2.3.m3.3.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3">𝐾</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.3.m3.5c">\{\widehat{\mathbf{x}_{i}}|i=1,\ldots,K\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.3.m3.5d">{ over^ start_ARG bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG | italic_i = 1 , … , italic_K }</annotation></semantics></math> within a batch. This is achieved using the following contrastive loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{cl}}=-\log\frac{\exp{\big{(}\langle\mathbf{x}_{0},\widehat{%
\mathbf{x}_{0}}\rangle/\tau}\big{)}}{\sum_{i=0}^{K}\exp{\big{(}\langle\mathbf{%
x}_{0},\widehat{\mathbf{x}_{i}}\rangle/\tau}\big{)}}~{}~{}," class="ltx_Math" display="block" id="S3.E4.m1.7"><semantics id="S3.E4.m1.7a"><mrow id="S3.E4.m1.7.7.1" xref="S3.E4.m1.7.7.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1" xref="S3.E4.m1.7.7.1.1.cmml"><msub id="S3.E4.m1.7.7.1.1.2" xref="S3.E4.m1.7.7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.7.7.1.1.2.2" xref="S3.E4.m1.7.7.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E4.m1.7.7.1.1.2.3" xref="S3.E4.m1.7.7.1.1.2.3a.cmml">cl</mtext></msub><mo id="S3.E4.m1.7.7.1.1.1" xref="S3.E4.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.7.7.1.1.3" xref="S3.E4.m1.7.7.1.1.3.cmml"><mo id="S3.E4.m1.7.7.1.1.3a" rspace="0.167em" xref="S3.E4.m1.7.7.1.1.3.cmml">−</mo><mrow id="S3.E4.m1.7.7.1.1.3.2" xref="S3.E4.m1.7.7.1.1.3.2.cmml"><mi id="S3.E4.m1.7.7.1.1.3.2.1" xref="S3.E4.m1.7.7.1.1.3.2.1.cmml">log</mi><mo id="S3.E4.m1.7.7.1.1.3.2a" lspace="0.167em" xref="S3.E4.m1.7.7.1.1.3.2.cmml">⁡</mo><mfrac id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml"><mrow id="S3.E4.m1.3.3.3.3" xref="S3.E4.m1.3.3.3.4.cmml"><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">exp</mi><mo id="S3.E4.m1.3.3.3.3a" xref="S3.E4.m1.3.3.3.4.cmml">⁡</mo><mrow id="S3.E4.m1.3.3.3.3.1" xref="S3.E4.m1.3.3.3.4.cmml"><mo id="S3.E4.m1.3.3.3.3.1.2" maxsize="120%" minsize="120%" xref="S3.E4.m1.3.3.3.4.cmml">(</mo><mrow id="S3.E4.m1.3.3.3.3.1.1" xref="S3.E4.m1.3.3.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.3.3.1.1.1.1" xref="S3.E4.m1.3.3.3.3.1.1.1.2.cmml"><mo id="S3.E4.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.3.3.3.3.1.1.1.2.cmml">⟨</mo><msub id="S3.E4.m1.3.3.3.3.1.1.1.1.1" xref="S3.E4.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S3.E4.m1.3.3.3.3.1.1.1.1.1.2" xref="S3.E4.m1.3.3.3.3.1.1.1.1.1.2.cmml">𝐱</mi><mn id="S3.E4.m1.3.3.3.3.1.1.1.1.1.3" xref="S3.E4.m1.3.3.3.3.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E4.m1.3.3.3.3.1.1.1.1.3" xref="S3.E4.m1.3.3.3.3.1.1.1.2.cmml">,</mo><mover accent="true" id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.2.cmml">𝐱</mi><mn id="S3.E4.m1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml">^</mo></mover><mo id="S3.E4.m1.3.3.3.3.1.1.1.1.4" stretchy="false" xref="S3.E4.m1.3.3.3.3.1.1.1.2.cmml">⟩</mo></mrow><mo id="S3.E4.m1.3.3.3.3.1.1.2" xref="S3.E4.m1.3.3.3.3.1.1.2.cmml">/</mo><mi id="S3.E4.m1.3.3.3.3.1.1.3" xref="S3.E4.m1.3.3.3.3.1.1.3.cmml">τ</mi></mrow><mo id="S3.E4.m1.3.3.3.3.1.3" maxsize="120%" minsize="120%" xref="S3.E4.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.6.6.6" xref="S3.E4.m1.6.6.6.cmml"><msubsup id="S3.E4.m1.6.6.6.4" xref="S3.E4.m1.6.6.6.4.cmml"><mo id="S3.E4.m1.6.6.6.4.2.2" xref="S3.E4.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="S3.E4.m1.6.6.6.4.2.3" xref="S3.E4.m1.6.6.6.4.2.3.cmml"><mi id="S3.E4.m1.6.6.6.4.2.3.2" xref="S3.E4.m1.6.6.6.4.2.3.2.cmml">i</mi><mo id="S3.E4.m1.6.6.6.4.2.3.1" xref="S3.E4.m1.6.6.6.4.2.3.1.cmml">=</mo><mn id="S3.E4.m1.6.6.6.4.2.3.3" xref="S3.E4.m1.6.6.6.4.2.3.3.cmml">0</mn></mrow><mi id="S3.E4.m1.6.6.6.4.3" xref="S3.E4.m1.6.6.6.4.3.cmml">K</mi></msubsup><mrow id="S3.E4.m1.6.6.6.3.1" xref="S3.E4.m1.6.6.6.3.2.cmml"><mi id="S3.E4.m1.5.5.5.2" xref="S3.E4.m1.5.5.5.2.cmml">exp</mi><mo id="S3.E4.m1.6.6.6.3.1a" xref="S3.E4.m1.6.6.6.3.2.cmml">⁡</mo><mrow id="S3.E4.m1.6.6.6.3.1.1" xref="S3.E4.m1.6.6.6.3.2.cmml"><mo id="S3.E4.m1.6.6.6.3.1.1.2" maxsize="120%" minsize="120%" xref="S3.E4.m1.6.6.6.3.2.cmml">(</mo><mrow id="S3.E4.m1.6.6.6.3.1.1.1" xref="S3.E4.m1.6.6.6.3.1.1.1.cmml"><mrow id="S3.E4.m1.6.6.6.3.1.1.1.1.1" xref="S3.E4.m1.6.6.6.3.1.1.1.1.2.cmml"><mo id="S3.E4.m1.6.6.6.3.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.6.6.6.3.1.1.1.1.2.cmml">⟨</mo><msub id="S3.E4.m1.6.6.6.3.1.1.1.1.1.1" xref="S3.E4.m1.6.6.6.3.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.6.6.6.3.1.1.1.1.1.1.2" xref="S3.E4.m1.6.6.6.3.1.1.1.1.1.1.2.cmml">𝐱</mi><mn id="S3.E4.m1.6.6.6.3.1.1.1.1.1.1.3" xref="S3.E4.m1.6.6.6.3.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E4.m1.6.6.6.3.1.1.1.1.1.3" xref="S3.E4.m1.6.6.6.3.1.1.1.1.2.cmml">,</mo><mover accent="true" id="S3.E4.m1.4.4.4.1" xref="S3.E4.m1.4.4.4.1.cmml"><msub id="S3.E4.m1.4.4.4.1.2" xref="S3.E4.m1.4.4.4.1.2.cmml"><mi id="S3.E4.m1.4.4.4.1.2.2" xref="S3.E4.m1.4.4.4.1.2.2.cmml">𝐱</mi><mi id="S3.E4.m1.4.4.4.1.2.3" xref="S3.E4.m1.4.4.4.1.2.3.cmml">i</mi></msub><mo id="S3.E4.m1.4.4.4.1.1" xref="S3.E4.m1.4.4.4.1.1.cmml">^</mo></mover><mo id="S3.E4.m1.6.6.6.3.1.1.1.1.1.4" stretchy="false" xref="S3.E4.m1.6.6.6.3.1.1.1.1.2.cmml">⟩</mo></mrow><mo id="S3.E4.m1.6.6.6.3.1.1.1.2" xref="S3.E4.m1.6.6.6.3.1.1.1.2.cmml">/</mo><mi id="S3.E4.m1.6.6.6.3.1.1.1.3" xref="S3.E4.m1.6.6.6.3.1.1.1.3.cmml">τ</mi></mrow><mo id="S3.E4.m1.6.6.6.3.1.1.3" maxsize="120%" minsize="120%" xref="S3.E4.m1.6.6.6.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S3.E4.m1.7.7.1.2" lspace="0.660em" xref="S3.E4.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.7b"><apply id="S3.E4.m1.7.7.1.1.cmml" xref="S3.E4.m1.7.7.1"><eq id="S3.E4.m1.7.7.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1"></eq><apply id="S3.E4.m1.7.7.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.2.2">ℒ</ci><ci id="S3.E4.m1.7.7.1.1.2.3a.cmml" xref="S3.E4.m1.7.7.1.1.2.3"><mtext id="S3.E4.m1.7.7.1.1.2.3.cmml" mathsize="70%" xref="S3.E4.m1.7.7.1.1.2.3">cl</mtext></ci></apply><apply id="S3.E4.m1.7.7.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.3"><minus id="S3.E4.m1.7.7.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.3"></minus><apply id="S3.E4.m1.7.7.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2"><log id="S3.E4.m1.7.7.1.1.3.2.1.cmml" xref="S3.E4.m1.7.7.1.1.3.2.1"></log><apply id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6"><divide id="S3.E4.m1.6.6.7.cmml" xref="S3.E4.m1.6.6"></divide><apply id="S3.E4.m1.3.3.3.4.cmml" xref="S3.E4.m1.3.3.3.3"><exp id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2"></exp><apply id="S3.E4.m1.3.3.3.3.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1"><divide id="S3.E4.m1.3.3.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1.2"></divide><list id="S3.E4.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.1"><apply id="S3.E4.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.1.1.2">𝐱</ci><cn id="S3.E4.m1.3.3.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.3.3.3.3.1.1.1.1.1.3">0</cn></apply><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"><ci id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1">^</ci><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2">𝐱</ci><cn id="S3.E4.m1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.2.3">0</cn></apply></apply></list><ci id="S3.E4.m1.3.3.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.3.3.1.1.3">𝜏</ci></apply></apply><apply id="S3.E4.m1.6.6.6.cmml" xref="S3.E4.m1.6.6.6"><apply id="S3.E4.m1.6.6.6.4.cmml" xref="S3.E4.m1.6.6.6.4"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.6.4.1.cmml" xref="S3.E4.m1.6.6.6.4">superscript</csymbol><apply id="S3.E4.m1.6.6.6.4.2.cmml" xref="S3.E4.m1.6.6.6.4"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.6.4.2.1.cmml" xref="S3.E4.m1.6.6.6.4">subscript</csymbol><sum id="S3.E4.m1.6.6.6.4.2.2.cmml" xref="S3.E4.m1.6.6.6.4.2.2"></sum><apply id="S3.E4.m1.6.6.6.4.2.3.cmml" xref="S3.E4.m1.6.6.6.4.2.3"><eq id="S3.E4.m1.6.6.6.4.2.3.1.cmml" xref="S3.E4.m1.6.6.6.4.2.3.1"></eq><ci id="S3.E4.m1.6.6.6.4.2.3.2.cmml" xref="S3.E4.m1.6.6.6.4.2.3.2">𝑖</ci><cn id="S3.E4.m1.6.6.6.4.2.3.3.cmml" type="integer" xref="S3.E4.m1.6.6.6.4.2.3.3">0</cn></apply></apply><ci id="S3.E4.m1.6.6.6.4.3.cmml" xref="S3.E4.m1.6.6.6.4.3">𝐾</ci></apply><apply id="S3.E4.m1.6.6.6.3.2.cmml" xref="S3.E4.m1.6.6.6.3.1"><exp id="S3.E4.m1.5.5.5.2.cmml" xref="S3.E4.m1.5.5.5.2"></exp><apply id="S3.E4.m1.6.6.6.3.1.1.1.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1"><divide id="S3.E4.m1.6.6.6.3.1.1.1.2.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.2"></divide><list id="S3.E4.m1.6.6.6.3.1.1.1.1.2.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.1.1"><apply id="S3.E4.m1.6.6.6.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.6.6.6.3.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.1.1.1.2">𝐱</ci><cn id="S3.E4.m1.6.6.6.3.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.6.6.6.3.1.1.1.1.1.1.3">0</cn></apply><apply id="S3.E4.m1.4.4.4.1.cmml" xref="S3.E4.m1.4.4.4.1"><ci id="S3.E4.m1.4.4.4.1.1.cmml" xref="S3.E4.m1.4.4.4.1.1">^</ci><apply id="S3.E4.m1.4.4.4.1.2.cmml" xref="S3.E4.m1.4.4.4.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.1.2.1.cmml" xref="S3.E4.m1.4.4.4.1.2">subscript</csymbol><ci id="S3.E4.m1.4.4.4.1.2.2.cmml" xref="S3.E4.m1.4.4.4.1.2.2">𝐱</ci><ci id="S3.E4.m1.4.4.4.1.2.3.cmml" xref="S3.E4.m1.4.4.4.1.2.3">𝑖</ci></apply></apply></list><ci id="S3.E4.m1.6.6.6.3.1.1.1.3.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.7c">\mathcal{L}_{\text{cl}}=-\log\frac{\exp{\big{(}\langle\mathbf{x}_{0},\widehat{%
\mathbf{x}_{0}}\rangle/\tau}\big{)}}{\sum_{i=0}^{K}\exp{\big{(}\langle\mathbf{%
x}_{0},\widehat{\mathbf{x}_{i}}\rangle/\tau}\big{)}}~{}~{},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.7d">caligraphic_L start_POSTSUBSCRIPT cl end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ( ⟨ bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG ⟩ / italic_τ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_exp ( ⟨ bold_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG ⟩ / italic_τ ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS2.p2.6">where <math alttext="\langle\cdot,\cdot\rangle" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.4.m1.2"><semantics id="S3.SS1.SSS2.p2.4.m1.2a"><mrow id="S3.SS1.SSS2.p2.4.m1.2.3.2" xref="S3.SS1.SSS2.p2.4.m1.2.3.1.cmml"><mo id="S3.SS1.SSS2.p2.4.m1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS2.p2.4.m1.2.3.1.cmml">⟨</mo><mo id="S3.SS1.SSS2.p2.4.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS1.SSS2.p2.4.m1.1.1.cmml">⋅</mo><mo id="S3.SS1.SSS2.p2.4.m1.2.3.2.2" rspace="0em" xref="S3.SS1.SSS2.p2.4.m1.2.3.1.cmml">,</mo><mo id="S3.SS1.SSS2.p2.4.m1.2.2" lspace="0em" rspace="0em" xref="S3.SS1.SSS2.p2.4.m1.2.2.cmml">⋅</mo><mo id="S3.SS1.SSS2.p2.4.m1.2.3.2.3" stretchy="false" xref="S3.SS1.SSS2.p2.4.m1.2.3.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.4.m1.2b"><list id="S3.SS1.SSS2.p2.4.m1.2.3.1.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.3.2"><ci id="S3.SS1.SSS2.p2.4.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m1.1.1">⋅</ci><ci id="S3.SS1.SSS2.p2.4.m1.2.2.cmml" xref="S3.SS1.SSS2.p2.4.m1.2.2">⋅</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.4.m1.2c">\langle\cdot,\cdot\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.4.m1.2d">⟨ ⋅ , ⋅ ⟩</annotation></semantics></math> denotes the cosine similarity between two vectors, and <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.5.m2.1"><semantics id="S3.SS1.SSS2.p2.5.m2.1a"><mi id="S3.SS1.SSS2.p2.5.m2.1.1" xref="S3.SS1.SSS2.p2.5.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.5.m2.1b"><ci id="S3.SS1.SSS2.p2.5.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.5.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.5.m2.1d">italic_τ</annotation></semantics></math> represents the temperature parameter that regulates the level of concentration. The <math alttext="\mathcal{L}_{\text{cl}}" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.6.m3.1"><semantics id="S3.SS1.SSS2.p2.6.m3.1a"><msub id="S3.SS1.SSS2.p2.6.m3.1.1" xref="S3.SS1.SSS2.p2.6.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p2.6.m3.1.1.2" xref="S3.SS1.SSS2.p2.6.m3.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS2.p2.6.m3.1.1.3" xref="S3.SS1.SSS2.p2.6.m3.1.1.3a.cmml">cl</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.6.m3.1b"><apply id="S3.SS1.SSS2.p2.6.m3.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.6.m3.1.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.6.m3.1.1.2.cmml" xref="S3.SS1.SSS2.p2.6.m3.1.1.2">ℒ</ci><ci id="S3.SS1.SSS2.p2.6.m3.1.1.3a.cmml" xref="S3.SS1.SSS2.p2.6.m3.1.1.3"><mtext id="S3.SS1.SSS2.p2.6.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS2.p2.6.m3.1.1.3">cl</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.6.m3.1c">\mathcal{L}_{\text{cl}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.6.m3.1d">caligraphic_L start_POSTSUBSCRIPT cl end_POSTSUBSCRIPT</annotation></semantics></math> loss relaxes the requirement for exact reconstruction and instead prioritizes pairwise similarities between items, thereby preserving the neighborhood information between the input embedding and its reconstructed counterpart while enhancing the dissimilarity from other items. This facilitates clearer differentiation between each item and the others. Finally, the loss function for contrastive quantization is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{co}}=\alpha\mathcal{L}_{\text{cl}}+\mathcal{L}_{\text{rq}}~%
{}~{}," class="ltx_Math" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E5.m1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.2.3a.cmml">co</mtext></msub><mo id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><mrow id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.3.2.2.cmml">α</mi><mo id="S3.E5.m1.1.1.1.1.3.2.1" xref="S3.E5.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E5.m1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.3.2.3.2" xref="S3.E5.m1.1.1.1.1.3.2.3.2.cmml">ℒ</mi><mtext id="S3.E5.m1.1.1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.1.1.3.2.3.3a.cmml">cl</mtext></msub></mrow><mo id="S3.E5.m1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.2.cmml">ℒ</mi><mtext id="S3.E5.m1.1.1.1.1.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3a.cmml">rq</mtext></msub></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"></eq><apply id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2">ℒ</ci><ci id="S3.E5.m1.1.1.1.1.2.3a.cmml" xref="S3.E5.m1.1.1.1.1.2.3"><mtext id="S3.E5.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.1.1.2.3">co</mtext></ci></apply><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><plus id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.1"></plus><apply id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2"><times id="S3.E5.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.1"></times><ci id="S3.E5.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2">𝛼</ci><apply id="S3.E5.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.2">ℒ</ci><ci id="S3.E5.m1.1.1.1.1.3.2.3.3a.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.3"><mtext id="S3.E5.m1.1.1.1.1.3.2.3.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.1.1.3.2.3.3">cl</mtext></ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2">ℒ</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3a.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3"><mtext id="S3.E5.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.1.1.3.3.3">rq</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathcal{L}_{\text{co}}=\alpha\mathcal{L}_{\text{cl}}+\mathcal{L}_{\text{rq}}~%
{}~{},</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">caligraphic_L start_POSTSUBSCRIPT co end_POSTSUBSCRIPT = italic_α caligraphic_L start_POSTSUBSCRIPT cl end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT rq end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS2.p2.7">where <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS1.SSS2.p2.7.m1.1"><semantics id="S3.SS1.SSS2.p2.7.m1.1a"><mi id="S3.SS1.SSS2.p2.7.m1.1.1" xref="S3.SS1.SSS2.p2.7.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.7.m1.1b"><ci id="S3.SS1.SSS2.p2.7.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.7.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.7.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS2.p2.7.m1.1d">italic_α</annotation></semantics></math> is a hyperparameter used to balance the two terms.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Dataset statistics.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S3.T1.1.1.1.1" style="padding-left:5.7pt;padding-right:5.7pt;">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.2" style="padding-left:5.7pt;padding-right:5.7pt;">#User</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.3" style="padding-left:5.7pt;padding-right:5.7pt;">#Item</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.4" style="padding-left:5.7pt;padding-right:5.7pt;">Seq_Len</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.5" style="padding-left:5.7pt;padding-right:5.7pt;">Average</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.6" style="padding-left:5.7pt;padding-right:5.7pt;">Median</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.2.1.1" style="padding-left:5.7pt;padding-right:5.7pt;">MIND</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.2" style="padding-left:5.7pt;padding-right:5.7pt;">29,207</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.3" style="padding-left:5.7pt;padding-right:5.7pt;">12,251</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.4" style="padding-left:5.7pt;padding-right:5.7pt;">[15, 70]</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.5" style="padding-left:5.7pt;padding-right:5.7pt;">25.06</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.6" style="padding-left:5.7pt;padding-right:5.7pt;">22</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.3.2.1" style="padding-left:5.7pt;padding-right:5.7pt;">Office(S)</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.2" style="padding-left:5.7pt;padding-right:5.7pt;">2,868</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.3" style="padding-left:5.7pt;padding-right:5.7pt;">14,618</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.4" style="padding-left:5.7pt;padding-right:5.7pt;">[10, 20]</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.5" style="padding-left:5.7pt;padding-right:5.7pt;">13.21</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.6" style="padding-left:5.7pt;padding-right:5.7pt;">12</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.1.4.3.1" style="padding-left:5.7pt;padding-right:5.7pt;">Office(L)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.4.3.2" style="padding-left:5.7pt;padding-right:5.7pt;">16,696</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.4.3.3" style="padding-left:5.7pt;padding-right:5.7pt;">37,347</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.4.3.4" style="padding-left:5.7pt;padding-right:5.7pt;">[5, 50]</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.4.3.5" style="padding-left:5.7pt;padding-right:5.7pt;">8.38</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.4.3.6" style="padding-left:5.7pt;padding-right:5.7pt;">12</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Autoregressive Generation</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.6">Following the TIGER model <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib24" title="">2023</a>)</cite>, we employ an encoder-decoder transformer architecture for generative recommendation. Specifically, we tokenize each item into a tuple of tokens, resulting in a behavior sequence <math alttext="\mathbf{s}=(\mathbf{c}_{1,1},\dots,\mathbf{c}_{1,M},\mathbf{c}_{2,1},\dots,%
\mathbf{c}_{2,M},\dots,\mathbf{c}_{N,1},\dots,\mathbf{c}_{N,M})" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.22"><semantics id="S3.SS2.p1.1.m1.22a"><mrow id="S3.SS2.p1.1.m1.22.22" xref="S3.SS2.p1.1.m1.22.22.cmml"><mi id="S3.SS2.p1.1.m1.22.22.8" xref="S3.SS2.p1.1.m1.22.22.8.cmml">𝐬</mi><mo id="S3.SS2.p1.1.m1.22.22.7" xref="S3.SS2.p1.1.m1.22.22.7.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.22.22.6.6" xref="S3.SS2.p1.1.m1.22.22.6.7.cmml"><mo id="S3.SS2.p1.1.m1.22.22.6.6.7" stretchy="false" xref="S3.SS2.p1.1.m1.22.22.6.7.cmml">(</mo><msub id="S3.SS2.p1.1.m1.17.17.1.1.1" xref="S3.SS2.p1.1.m1.17.17.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.17.17.1.1.1.2" xref="S3.SS2.p1.1.m1.17.17.1.1.1.2.cmml">𝐜</mi><mrow id="S3.SS2.p1.1.m1.2.2.2.4" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml"><mn id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml">1</mn><mo id="S3.SS2.p1.1.m1.2.2.2.4.1" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml">,</mo><mn id="S3.SS2.p1.1.m1.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.SS2.p1.1.m1.22.22.6.6.8" xref="S3.SS2.p1.1.m1.22.22.6.7.cmml">,</mo><mi id="S3.SS2.p1.1.m1.13.13" mathvariant="normal" xref="S3.SS2.p1.1.m1.13.13.cmml">…</mi><mo id="S3.SS2.p1.1.m1.22.22.6.6.9" xref="S3.SS2.p1.1.m1.22.22.6.7.cmml">,</mo><msub id="S3.SS2.p1.1.m1.18.18.2.2.2" xref="S3.SS2.p1.1.m1.18.18.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.18.18.2.2.2.2" xref="S3.SS2.p1.1.m1.18.18.2.2.2.2.cmml">𝐜</mi><mrow id="S3.SS2.p1.1.m1.4.4.2.4" xref="S3.SS2.p1.1.m1.4.4.2.3.cmml"><mn id="S3.SS2.p1.1.m1.3.3.1.1" xref="S3.SS2.p1.1.m1.3.3.1.1.cmml">1</mn><mo id="S3.SS2.p1.1.m1.4.4.2.4.1" xref="S3.SS2.p1.1.m1.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p1.1.m1.4.4.2.2" xref="S3.SS2.p1.1.m1.4.4.2.2.cmml">M</mi></mrow></msub><mo id="S3.SS2.p1.1.m1.22.22.6.6.10" xref="S3.SS2.p1.1.m1.22.22.6.7.cmml">,</mo><msub id="S3.SS2.p1.1.m1.19.19.3.3.3" xref="S3.SS2.p1.1.m1.19.19.3.3.3.cmml"><mi id="S3.SS2.p1.1.m1.19.19.3.3.3.2" xref="S3.SS2.p1.1.m1.19.19.3.3.3.2.cmml">𝐜</mi><mrow id="S3.SS2.p1.1.m1.6.6.2.4" xref="S3.SS2.p1.1.m1.6.6.2.3.cmml"><mn id="S3.SS2.p1.1.m1.5.5.1.1" xref="S3.SS2.p1.1.m1.5.5.1.1.cmml">2</mn><mo id="S3.SS2.p1.1.m1.6.6.2.4.1" xref="S3.SS2.p1.1.m1.6.6.2.3.cmml">,</mo><mn id="S3.SS2.p1.1.m1.6.6.2.2" xref="S3.SS2.p1.1.m1.6.6.2.2.cmml">1</mn></mrow></msub><mo id="S3.SS2.p1.1.m1.22.22.6.6.11" xref="S3.SS2.p1.1.m1.22.22.6.7.cmml">,</mo><mi id="S3.SS2.p1.1.m1.14.14" mathvariant="normal" xref="S3.SS2.p1.1.m1.14.14.cmml">…</mi><mo id="S3.SS2.p1.1.m1.22.22.6.6.12" xref="S3.SS2.p1.1.m1.22.22.6.7.cmml">,</mo><msub id="S3.SS2.p1.1.m1.20.20.4.4.4" xref="S3.SS2.p1.1.m1.20.20.4.4.4.cmml"><mi id="S3.SS2.p1.1.m1.20.20.4.4.4.2" xref="S3.SS2.p1.1.m1.20.20.4.4.4.2.cmml">𝐜</mi><mrow id="S3.SS2.p1.1.m1.8.8.2.4" xref="S3.SS2.p1.1.m1.8.8.2.3.cmml"><mn id="S3.SS2.p1.1.m1.7.7.1.1" xref="S3.SS2.p1.1.m1.7.7.1.1.cmml">2</mn><mo id="S3.SS2.p1.1.m1.8.8.2.4.1" xref="S3.SS2.p1.1.m1.8.8.2.3.cmml">,</mo><mi id="S3.SS2.p1.1.m1.8.8.2.2" xref="S3.SS2.p1.1.m1.8.8.2.2.cmml">M</mi></mrow></msub><mo id="S3.SS2.p1.1.m1.22.22.6.6.13" xref="S3.SS2.p1.1.m1.22.22.6.7.cmml">,</mo><mi id="S3.SS2.p1.1.m1.15.15" mathvariant="normal" xref="S3.SS2.p1.1.m1.15.15.cmml">…</mi><mo id="S3.SS2.p1.1.m1.22.22.6.6.14" xref="S3.SS2.p1.1.m1.22.22.6.7.cmml">,</mo><msub id="S3.SS2.p1.1.m1.21.21.5.5.5" xref="S3.SS2.p1.1.m1.21.21.5.5.5.cmml"><mi id="S3.SS2.p1.1.m1.21.21.5.5.5.2" xref="S3.SS2.p1.1.m1.21.21.5.5.5.2.cmml">𝐜</mi><mrow id="S3.SS2.p1.1.m1.10.10.2.4" xref="S3.SS2.p1.1.m1.10.10.2.3.cmml"><mi id="S3.SS2.p1.1.m1.9.9.1.1" xref="S3.SS2.p1.1.m1.9.9.1.1.cmml">N</mi><mo id="S3.SS2.p1.1.m1.10.10.2.4.1" xref="S3.SS2.p1.1.m1.10.10.2.3.cmml">,</mo><mn id="S3.SS2.p1.1.m1.10.10.2.2" xref="S3.SS2.p1.1.m1.10.10.2.2.cmml">1</mn></mrow></msub><mo id="S3.SS2.p1.1.m1.22.22.6.6.15" xref="S3.SS2.p1.1.m1.22.22.6.7.cmml">,</mo><mi id="S3.SS2.p1.1.m1.16.16" mathvariant="normal" xref="S3.SS2.p1.1.m1.16.16.cmml">…</mi><mo id="S3.SS2.p1.1.m1.22.22.6.6.16" xref="S3.SS2.p1.1.m1.22.22.6.7.cmml">,</mo><msub id="S3.SS2.p1.1.m1.22.22.6.6.6" xref="S3.SS2.p1.1.m1.22.22.6.6.6.cmml"><mi id="S3.SS2.p1.1.m1.22.22.6.6.6.2" xref="S3.SS2.p1.1.m1.22.22.6.6.6.2.cmml">𝐜</mi><mrow id="S3.SS2.p1.1.m1.12.12.2.4" xref="S3.SS2.p1.1.m1.12.12.2.3.cmml"><mi id="S3.SS2.p1.1.m1.11.11.1.1" xref="S3.SS2.p1.1.m1.11.11.1.1.cmml">N</mi><mo id="S3.SS2.p1.1.m1.12.12.2.4.1" xref="S3.SS2.p1.1.m1.12.12.2.3.cmml">,</mo><mi id="S3.SS2.p1.1.m1.12.12.2.2" xref="S3.SS2.p1.1.m1.12.12.2.2.cmml">M</mi></mrow></msub><mo id="S3.SS2.p1.1.m1.22.22.6.6.17" stretchy="false" xref="S3.SS2.p1.1.m1.22.22.6.7.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.22b"><apply id="S3.SS2.p1.1.m1.22.22.cmml" xref="S3.SS2.p1.1.m1.22.22"><eq id="S3.SS2.p1.1.m1.22.22.7.cmml" xref="S3.SS2.p1.1.m1.22.22.7"></eq><ci id="S3.SS2.p1.1.m1.22.22.8.cmml" xref="S3.SS2.p1.1.m1.22.22.8">𝐬</ci><vector id="S3.SS2.p1.1.m1.22.22.6.7.cmml" xref="S3.SS2.p1.1.m1.22.22.6.6"><apply id="S3.SS2.p1.1.m1.17.17.1.1.1.cmml" xref="S3.SS2.p1.1.m1.17.17.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.17.17.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.17.17.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.17.17.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.17.17.1.1.1.2">𝐜</ci><list id="S3.SS2.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.4"><cn id="S3.SS2.p1.1.m1.1.1.1.1.cmml" type="integer" xref="S3.SS2.p1.1.m1.1.1.1.1">1</cn><cn id="S3.SS2.p1.1.m1.2.2.2.2.cmml" type="integer" xref="S3.SS2.p1.1.m1.2.2.2.2">1</cn></list></apply><ci id="S3.SS2.p1.1.m1.13.13.cmml" xref="S3.SS2.p1.1.m1.13.13">…</ci><apply id="S3.SS2.p1.1.m1.18.18.2.2.2.cmml" xref="S3.SS2.p1.1.m1.18.18.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.18.18.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.18.18.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.18.18.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.18.18.2.2.2.2">𝐜</ci><list id="S3.SS2.p1.1.m1.4.4.2.3.cmml" xref="S3.SS2.p1.1.m1.4.4.2.4"><cn id="S3.SS2.p1.1.m1.3.3.1.1.cmml" type="integer" xref="S3.SS2.p1.1.m1.3.3.1.1">1</cn><ci id="S3.SS2.p1.1.m1.4.4.2.2.cmml" xref="S3.SS2.p1.1.m1.4.4.2.2">𝑀</ci></list></apply><apply id="S3.SS2.p1.1.m1.19.19.3.3.3.cmml" xref="S3.SS2.p1.1.m1.19.19.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.19.19.3.3.3.1.cmml" xref="S3.SS2.p1.1.m1.19.19.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.19.19.3.3.3.2.cmml" xref="S3.SS2.p1.1.m1.19.19.3.3.3.2">𝐜</ci><list id="S3.SS2.p1.1.m1.6.6.2.3.cmml" xref="S3.SS2.p1.1.m1.6.6.2.4"><cn id="S3.SS2.p1.1.m1.5.5.1.1.cmml" type="integer" xref="S3.SS2.p1.1.m1.5.5.1.1">2</cn><cn id="S3.SS2.p1.1.m1.6.6.2.2.cmml" type="integer" xref="S3.SS2.p1.1.m1.6.6.2.2">1</cn></list></apply><ci id="S3.SS2.p1.1.m1.14.14.cmml" xref="S3.SS2.p1.1.m1.14.14">…</ci><apply id="S3.SS2.p1.1.m1.20.20.4.4.4.cmml" xref="S3.SS2.p1.1.m1.20.20.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.20.20.4.4.4.1.cmml" xref="S3.SS2.p1.1.m1.20.20.4.4.4">subscript</csymbol><ci id="S3.SS2.p1.1.m1.20.20.4.4.4.2.cmml" xref="S3.SS2.p1.1.m1.20.20.4.4.4.2">𝐜</ci><list id="S3.SS2.p1.1.m1.8.8.2.3.cmml" xref="S3.SS2.p1.1.m1.8.8.2.4"><cn id="S3.SS2.p1.1.m1.7.7.1.1.cmml" type="integer" xref="S3.SS2.p1.1.m1.7.7.1.1">2</cn><ci id="S3.SS2.p1.1.m1.8.8.2.2.cmml" xref="S3.SS2.p1.1.m1.8.8.2.2">𝑀</ci></list></apply><ci id="S3.SS2.p1.1.m1.15.15.cmml" xref="S3.SS2.p1.1.m1.15.15">…</ci><apply id="S3.SS2.p1.1.m1.21.21.5.5.5.cmml" xref="S3.SS2.p1.1.m1.21.21.5.5.5"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.21.21.5.5.5.1.cmml" xref="S3.SS2.p1.1.m1.21.21.5.5.5">subscript</csymbol><ci id="S3.SS2.p1.1.m1.21.21.5.5.5.2.cmml" xref="S3.SS2.p1.1.m1.21.21.5.5.5.2">𝐜</ci><list id="S3.SS2.p1.1.m1.10.10.2.3.cmml" xref="S3.SS2.p1.1.m1.10.10.2.4"><ci id="S3.SS2.p1.1.m1.9.9.1.1.cmml" xref="S3.SS2.p1.1.m1.9.9.1.1">𝑁</ci><cn id="S3.SS2.p1.1.m1.10.10.2.2.cmml" type="integer" xref="S3.SS2.p1.1.m1.10.10.2.2">1</cn></list></apply><ci id="S3.SS2.p1.1.m1.16.16.cmml" xref="S3.SS2.p1.1.m1.16.16">…</ci><apply id="S3.SS2.p1.1.m1.22.22.6.6.6.cmml" xref="S3.SS2.p1.1.m1.22.22.6.6.6"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.22.22.6.6.6.1.cmml" xref="S3.SS2.p1.1.m1.22.22.6.6.6">subscript</csymbol><ci id="S3.SS2.p1.1.m1.22.22.6.6.6.2.cmml" xref="S3.SS2.p1.1.m1.22.22.6.6.6.2">𝐜</ci><list id="S3.SS2.p1.1.m1.12.12.2.3.cmml" xref="S3.SS2.p1.1.m1.12.12.2.4"><ci id="S3.SS2.p1.1.m1.11.11.1.1.cmml" xref="S3.SS2.p1.1.m1.11.11.1.1">𝑁</ci><ci id="S3.SS2.p1.1.m1.12.12.2.2.cmml" xref="S3.SS2.p1.1.m1.12.12.2.2">𝑀</ci></list></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.22c">\mathbf{s}=(\mathbf{c}_{1,1},\dots,\mathbf{c}_{1,M},\mathbf{c}_{2,1},\dots,%
\mathbf{c}_{2,M},\dots,\mathbf{c}_{N,1},\dots,\mathbf{c}_{N,M})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.22d">bold_s = ( bold_c start_POSTSUBSCRIPT 1 , 1 end_POSTSUBSCRIPT , … , bold_c start_POSTSUBSCRIPT 1 , italic_M end_POSTSUBSCRIPT , bold_c start_POSTSUBSCRIPT 2 , 1 end_POSTSUBSCRIPT , … , bold_c start_POSTSUBSCRIPT 2 , italic_M end_POSTSUBSCRIPT , … , bold_c start_POSTSUBSCRIPT italic_N , 1 end_POSTSUBSCRIPT , … , bold_c start_POSTSUBSCRIPT italic_N , italic_M end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_N</annotation></semantics></math> represents the sequence length of items. The model is then trained as a seq2seq learning task for autoregressive token generation. Given the token sequence of the first <math alttext="i-1" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">i</mi><mo id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">−</mo><mn id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><minus id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></minus><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑖</ci><cn id="S3.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">i-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_i - 1</annotation></semantics></math> items, the model predicts the tokens <math alttext="(\mathbf{c}_{i,1},\dots,\mathbf{x}_{i,M})" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.7"><semantics id="S3.SS2.p1.4.m4.7a"><mrow id="S3.SS2.p1.4.m4.7.7.2" xref="S3.SS2.p1.4.m4.7.7.3.cmml"><mo id="S3.SS2.p1.4.m4.7.7.2.3" stretchy="false" xref="S3.SS2.p1.4.m4.7.7.3.cmml">(</mo><msub id="S3.SS2.p1.4.m4.6.6.1.1" xref="S3.SS2.p1.4.m4.6.6.1.1.cmml"><mi id="S3.SS2.p1.4.m4.6.6.1.1.2" xref="S3.SS2.p1.4.m4.6.6.1.1.2.cmml">𝐜</mi><mrow id="S3.SS2.p1.4.m4.2.2.2.4" xref="S3.SS2.p1.4.m4.2.2.2.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p1.4.m4.2.2.2.4.1" xref="S3.SS2.p1.4.m4.2.2.2.3.cmml">,</mo><mn id="S3.SS2.p1.4.m4.2.2.2.2" xref="S3.SS2.p1.4.m4.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.SS2.p1.4.m4.7.7.2.4" xref="S3.SS2.p1.4.m4.7.7.3.cmml">,</mo><mi id="S3.SS2.p1.4.m4.5.5" mathvariant="normal" xref="S3.SS2.p1.4.m4.5.5.cmml">…</mi><mo id="S3.SS2.p1.4.m4.7.7.2.5" xref="S3.SS2.p1.4.m4.7.7.3.cmml">,</mo><msub id="S3.SS2.p1.4.m4.7.7.2.2" xref="S3.SS2.p1.4.m4.7.7.2.2.cmml"><mi id="S3.SS2.p1.4.m4.7.7.2.2.2" xref="S3.SS2.p1.4.m4.7.7.2.2.2.cmml">𝐱</mi><mrow id="S3.SS2.p1.4.m4.4.4.2.4" xref="S3.SS2.p1.4.m4.4.4.2.3.cmml"><mi id="S3.SS2.p1.4.m4.3.3.1.1" xref="S3.SS2.p1.4.m4.3.3.1.1.cmml">i</mi><mo id="S3.SS2.p1.4.m4.4.4.2.4.1" xref="S3.SS2.p1.4.m4.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p1.4.m4.4.4.2.2" xref="S3.SS2.p1.4.m4.4.4.2.2.cmml">M</mi></mrow></msub><mo id="S3.SS2.p1.4.m4.7.7.2.6" stretchy="false" xref="S3.SS2.p1.4.m4.7.7.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.7b"><vector id="S3.SS2.p1.4.m4.7.7.3.cmml" xref="S3.SS2.p1.4.m4.7.7.2"><apply id="S3.SS2.p1.4.m4.6.6.1.1.cmml" xref="S3.SS2.p1.4.m4.6.6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.6.6.1.1.1.cmml" xref="S3.SS2.p1.4.m4.6.6.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.6.6.1.1.2.cmml" xref="S3.SS2.p1.4.m4.6.6.1.1.2">𝐜</ci><list id="S3.SS2.p1.4.m4.2.2.2.3.cmml" xref="S3.SS2.p1.4.m4.2.2.2.4"><ci id="S3.SS2.p1.4.m4.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1">𝑖</ci><cn id="S3.SS2.p1.4.m4.2.2.2.2.cmml" type="integer" xref="S3.SS2.p1.4.m4.2.2.2.2">1</cn></list></apply><ci id="S3.SS2.p1.4.m4.5.5.cmml" xref="S3.SS2.p1.4.m4.5.5">…</ci><apply id="S3.SS2.p1.4.m4.7.7.2.2.cmml" xref="S3.SS2.p1.4.m4.7.7.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.7.7.2.2.1.cmml" xref="S3.SS2.p1.4.m4.7.7.2.2">subscript</csymbol><ci id="S3.SS2.p1.4.m4.7.7.2.2.2.cmml" xref="S3.SS2.p1.4.m4.7.7.2.2.2">𝐱</ci><list id="S3.SS2.p1.4.m4.4.4.2.3.cmml" xref="S3.SS2.p1.4.m4.4.4.2.4"><ci id="S3.SS2.p1.4.m4.3.3.1.1.cmml" xref="S3.SS2.p1.4.m4.3.3.1.1">𝑖</ci><ci id="S3.SS2.p1.4.m4.4.4.2.2.cmml" xref="S3.SS2.p1.4.m4.4.4.2.2">𝑀</ci></list></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.7c">(\mathbf{c}_{i,1},\dots,\mathbf{x}_{i,M})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.7d">( bold_c start_POSTSUBSCRIPT italic_i , 1 end_POSTSUBSCRIPT , … , bold_x start_POSTSUBSCRIPT italic_i , italic_M end_POSTSUBSCRIPT )</annotation></semantics></math> for the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_i</annotation></semantics></math>-th item <math alttext="t_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">t</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝑡</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> autoregressively, rather than generating an item ID directly. After training, we use beam search to generate tokens and then lookup the token-item table to obtain the corresponding items for recommendation.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experimental Settings</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Datasets.</span>
We conducted experiments on two real-world datasets: MIND <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib37" title="">2020</a>)</cite>, and Amazon Office. The statistics of the preprocessed datasets are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S3.T1" title="Table 1 ‣ 3.1.2. Contrastive Quantization ‣ 3.1. Contrastive Quantization-based Semantic Tokenization ‣ 3. Approach ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, including the range (Seq_Len), average, and median of behavior sequence lengths. For MIND, we followed the preprocessing steps in <cite class="ltx_cite ltx_citemacro_citep">(Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib6" title="">2022</a>)</cite>, retaining interactions with at least 15 users and capping sequence lengths at 70. For Amazon-Office, we filtered out users with fewer than 5 interactions. To investigate the impact of item quantity, we split the Office dataset into Office (S) and Office (L), containing 14,000 and 37,000 items, respectively. We extracted categories, sub-categories, and titles from the MIND dataset, while utilizing type, brand, title, and category from the Amazon dataset as textual fields. We used Sentence-T5 <cite class="ltx_cite ltx_citemacro_citep">(Ni et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib21" title="">2021</a>)</cite> to obtain 768-dimensional semantic embeddings for each item.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.3"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.3.1">Hyperparameter Settings.</span>
The RQ-VAE model consists of three core components: an MLP encoder, a residual quantizer, and an MLP decoder. The encoder includes three hidden layers with dimensions [512, 256, 128], utilizing ReLU activations, and outputs a 96-dimensional latent representation. Each item is assigned a unique 3-tuple semantic token, with shared codebooks across the three levels, and the codebook size is set to 64. The hyperparameters are set as <math alttext="\alpha=0.1" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><eq id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></eq><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝛼</ci><cn id="S4.SS1.p2.1.m1.1.1.3.cmml" type="float" xref="S4.SS1.p2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\alpha=0.1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_α = 0.1</annotation></semantics></math>, <math alttext="\beta=0.25" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">β</mi><mo id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><eq id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"></eq><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝛽</ci><cn id="S4.SS1.p2.2.m2.1.1.3.cmml" type="float" xref="S4.SS1.p2.2.m2.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\beta=0.25</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_β = 0.25</annotation></semantics></math> and <math alttext="\tau=0.1" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">τ</mi><mo id="S4.SS1.p2.3.m3.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><eq id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1"></eq><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝜏</ci><cn id="S4.SS1.p2.3.m3.1.1.3.cmml" type="float" xref="S4.SS1.p2.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\tau=0.1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">italic_τ = 0.1</annotation></semantics></math>. We utilize the Adam optimizer with a learning rate of 0.0001 and a batch size of 256 for codebook learning. For seq2seq transformer model training, we adopt the same structure as TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#bib.bib24" title="">2023</a>)</cite>, setting the batch size to 512 and the learning rate to 0.001.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.2"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.2.1">Evaluation Metrics.</span> We employ the widely-used metrics, Recall@<math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_k</annotation></semantics></math> and NDCG@<math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_k</annotation></semantics></math>, to evaluate the effectiveness of our proposed method. Following the standard leave-one-out evaluation protocol, we reserve the last item for testing, the penultimate item for validation, and use the remaining items for training.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>Experimental results on the MIND dataset.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.11">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.11.12.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.11.12.1.1">Methods</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.11.12.1.2">Metrics</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.11.12.1.3">@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.11.12.1.4">@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.11.12.1.5">@20</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.11.12.1.6">@40</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.11.13.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.11.13.1.1" rowspan="2"><span class="ltx_text" id="S4.T2.11.13.1.1.1">Random</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.11.13.1.2">NDCG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.11.13.1.3">0.0201</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.11.13.1.4">0.0265</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.11.13.1.5">0.0327</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.11.13.1.6">0.0390</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.14.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.11.14.2.1">Recall</th>
<td class="ltx_td ltx_align_center" id="S4.T2.11.14.2.2">0.0319</td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.14.2.3">0.0519</td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.14.2.4">0.0766</td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.14.2.5">0.1075</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T2.1.1.1.1"><math alttext="\mathcal{L}_{re}" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.1.m1.1a"><msub id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T2.1.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.T2.1.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.1.m1.1.1.3.cmml"><mi id="S4.T2.1.1.1.1.m1.1.1.3.2" xref="S4.T2.1.1.1.1.m1.1.1.3.2.cmml">r</mi><mo id="S4.T2.1.1.1.1.m1.1.1.3.1" xref="S4.T2.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.1.1.1.1.m1.1.1.3.3" xref="S4.T2.1.1.1.1.m1.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2">ℒ</ci><apply id="S4.T2.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3"><times id="S4.T2.1.1.1.1.m1.1.1.3.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3.1"></times><ci id="S4.T2.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3.2">𝑟</ci><ci id="S4.T2.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\mathcal{L}_{re}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.1.1.2">NDCG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3">0.0363</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.4">0.0474</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.5">0.0594</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.6">0.0727</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.15.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.11.15.3.1">Recall</th>
<td class="ltx_td ltx_align_center" id="S4.T2.11.15.3.2">0.0560</td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.15.3.3">0.0905</td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.15.3.4">0.1384</td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.15.3.5">0.2031</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.2.1" rowspan="2"><span class="ltx_text" id="S4.T2.2.2.1.1"><math alttext="\mathcal{L}_{co}" class="ltx_Math" display="inline" id="S4.T2.2.2.1.1.m1.1"><semantics id="S4.T2.2.2.1.1.m1.1a"><msub id="S4.T2.2.2.1.1.m1.1.1" xref="S4.T2.2.2.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T2.2.2.1.1.m1.1.1.2" xref="S4.T2.2.2.1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.T2.2.2.1.1.m1.1.1.3" xref="S4.T2.2.2.1.1.m1.1.1.3.cmml"><mi id="S4.T2.2.2.1.1.m1.1.1.3.2" xref="S4.T2.2.2.1.1.m1.1.1.3.2.cmml">c</mi><mo id="S4.T2.2.2.1.1.m1.1.1.3.1" xref="S4.T2.2.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.2.2.1.1.m1.1.1.3.3" xref="S4.T2.2.2.1.1.m1.1.1.3.3.cmml">o</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.1.m1.1b"><apply id="S4.T2.2.2.1.1.m1.1.1.cmml" xref="S4.T2.2.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.2.2.1.1.m1.1.1.1.cmml" xref="S4.T2.2.2.1.1.m1.1.1">subscript</csymbol><ci id="S4.T2.2.2.1.1.m1.1.1.2.cmml" xref="S4.T2.2.2.1.1.m1.1.1.2">ℒ</ci><apply id="S4.T2.2.2.1.1.m1.1.1.3.cmml" xref="S4.T2.2.2.1.1.m1.1.1.3"><times id="S4.T2.2.2.1.1.m1.1.1.3.1.cmml" xref="S4.T2.2.2.1.1.m1.1.1.3.1"></times><ci id="S4.T2.2.2.1.1.m1.1.1.3.2.cmml" xref="S4.T2.2.2.1.1.m1.1.1.3.2">𝑐</ci><ci id="S4.T2.2.2.1.1.m1.1.1.3.3.cmml" xref="S4.T2.2.2.1.1.m1.1.1.3.3">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.1.m1.1c">\mathcal{L}_{co}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_c italic_o end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.2.2.2">NDCG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.3.1">0.0522</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.4"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.4.1">0.0663</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.5"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.5.1">0.0817</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.6"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.6.1">0.0975</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.16.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.11.16.4.1">Recall</th>
<td class="ltx_td ltx_align_center" id="S4.T2.11.16.4.2"><span class="ltx_text ltx_font_bold" id="S4.T2.11.16.4.2.1">0.0803</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.16.4.3"><span class="ltx_text ltx_font_bold" id="S4.T2.11.16.4.3.1">0.1241</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.16.4.4"><span class="ltx_text ltx_font_bold" id="S4.T2.11.16.4.4.1">0.1855</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.16.4.5"><span class="ltx_text ltx_font_bold" id="S4.T2.11.16.4.5.1">0.2625</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.3.3.1" rowspan="2"><span class="ltx_text" id="S4.T2.3.3.1.1"><math alttext="\mathcal{L}_{re}+\mathcal{L}_{co}" class="ltx_Math" display="inline" id="S4.T2.3.3.1.1.m1.1"><semantics id="S4.T2.3.3.1.1.m1.1a"><mrow id="S4.T2.3.3.1.1.m1.1.1" xref="S4.T2.3.3.1.1.m1.1.1.cmml"><msub id="S4.T2.3.3.1.1.m1.1.1.2" xref="S4.T2.3.3.1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T2.3.3.1.1.m1.1.1.2.2" xref="S4.T2.3.3.1.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.T2.3.3.1.1.m1.1.1.2.3" xref="S4.T2.3.3.1.1.m1.1.1.2.3.cmml"><mi id="S4.T2.3.3.1.1.m1.1.1.2.3.2" xref="S4.T2.3.3.1.1.m1.1.1.2.3.2.cmml">r</mi><mo id="S4.T2.3.3.1.1.m1.1.1.2.3.1" xref="S4.T2.3.3.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.T2.3.3.1.1.m1.1.1.2.3.3" xref="S4.T2.3.3.1.1.m1.1.1.2.3.3.cmml">e</mi></mrow></msub><mo id="S4.T2.3.3.1.1.m1.1.1.1" xref="S4.T2.3.3.1.1.m1.1.1.1.cmml">+</mo><msub id="S4.T2.3.3.1.1.m1.1.1.3" xref="S4.T2.3.3.1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T2.3.3.1.1.m1.1.1.3.2" xref="S4.T2.3.3.1.1.m1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.T2.3.3.1.1.m1.1.1.3.3" xref="S4.T2.3.3.1.1.m1.1.1.3.3.cmml"><mi id="S4.T2.3.3.1.1.m1.1.1.3.3.2" xref="S4.T2.3.3.1.1.m1.1.1.3.3.2.cmml">c</mi><mo id="S4.T2.3.3.1.1.m1.1.1.3.3.1" xref="S4.T2.3.3.1.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T2.3.3.1.1.m1.1.1.3.3.3" xref="S4.T2.3.3.1.1.m1.1.1.3.3.3.cmml">o</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.1.1.m1.1b"><apply id="S4.T2.3.3.1.1.m1.1.1.cmml" xref="S4.T2.3.3.1.1.m1.1.1"><plus id="S4.T2.3.3.1.1.m1.1.1.1.cmml" xref="S4.T2.3.3.1.1.m1.1.1.1"></plus><apply id="S4.T2.3.3.1.1.m1.1.1.2.cmml" xref="S4.T2.3.3.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T2.3.3.1.1.m1.1.1.2.1.cmml" xref="S4.T2.3.3.1.1.m1.1.1.2">subscript</csymbol><ci id="S4.T2.3.3.1.1.m1.1.1.2.2.cmml" xref="S4.T2.3.3.1.1.m1.1.1.2.2">ℒ</ci><apply id="S4.T2.3.3.1.1.m1.1.1.2.3.cmml" xref="S4.T2.3.3.1.1.m1.1.1.2.3"><times id="S4.T2.3.3.1.1.m1.1.1.2.3.1.cmml" xref="S4.T2.3.3.1.1.m1.1.1.2.3.1"></times><ci id="S4.T2.3.3.1.1.m1.1.1.2.3.2.cmml" xref="S4.T2.3.3.1.1.m1.1.1.2.3.2">𝑟</ci><ci id="S4.T2.3.3.1.1.m1.1.1.2.3.3.cmml" xref="S4.T2.3.3.1.1.m1.1.1.2.3.3">𝑒</ci></apply></apply><apply id="S4.T2.3.3.1.1.m1.1.1.3.cmml" xref="S4.T2.3.3.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T2.3.3.1.1.m1.1.1.3.1.cmml" xref="S4.T2.3.3.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.T2.3.3.1.1.m1.1.1.3.2.cmml" xref="S4.T2.3.3.1.1.m1.1.1.3.2">ℒ</ci><apply id="S4.T2.3.3.1.1.m1.1.1.3.3.cmml" xref="S4.T2.3.3.1.1.m1.1.1.3.3"><times id="S4.T2.3.3.1.1.m1.1.1.3.3.1.cmml" xref="S4.T2.3.3.1.1.m1.1.1.3.3.1"></times><ci id="S4.T2.3.3.1.1.m1.1.1.3.3.2.cmml" xref="S4.T2.3.3.1.1.m1.1.1.3.3.2">𝑐</ci><ci id="S4.T2.3.3.1.1.m1.1.1.3.3.3.cmml" xref="S4.T2.3.3.1.1.m1.1.1.3.3.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.1.1.m1.1c">\mathcal{L}_{re}+\mathcal{L}_{co}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT italic_c italic_o end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.3.3.2">NDCG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.3">0.0444</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.4">0.0574</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.5">0.0710</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.6">0.0865</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.17.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.11.17.5.1">Recall</th>
<td class="ltx_td ltx_align_center" id="S4.T2.11.17.5.2">0.0677</td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.17.5.3">0.1081</td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.17.5.4">0.1621</td>
<td class="ltx_td ltx_align_center" id="S4.T2.11.17.5.5">0.2376</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.7.7.5" rowspan="2"><span class="ltx_text" id="S4.T2.7.7.5.1">Impr.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.7.7.6">NDCG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.1"><span class="ltx_text ltx_font_bold" id="S4.T2.4.4.1.1">43.76<math alttext="\%" class="ltx_Math" display="inline" id="S4.T2.4.4.1.1.m1.1"><semantics id="S4.T2.4.4.1.1.m1.1a"><mo id="S4.T2.4.4.1.1.m1.1.1" xref="S4.T2.4.4.1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.1.1.m1.1b"><csymbol cd="latexml" id="S4.T2.4.4.1.1.m1.1.1.cmml" xref="S4.T2.4.4.1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.1.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.1.1.m1.1d">%</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.5.2"><span class="ltx_text ltx_font_bold" id="S4.T2.5.5.2.1">39.90<math alttext="\%" class="ltx_Math" display="inline" id="S4.T2.5.5.2.1.m1.1"><semantics id="S4.T2.5.5.2.1.m1.1a"><mo id="S4.T2.5.5.2.1.m1.1.1" xref="S4.T2.5.5.2.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.2.1.m1.1b"><csymbol cd="latexml" id="S4.T2.5.5.2.1.m1.1.1.cmml" xref="S4.T2.5.5.2.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.2.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.2.1.m1.1d">%</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.3"><span class="ltx_text ltx_font_bold" id="S4.T2.6.6.3.1">37.52<math alttext="\%" class="ltx_Math" display="inline" id="S4.T2.6.6.3.1.m1.1"><semantics id="S4.T2.6.6.3.1.m1.1a"><mo id="S4.T2.6.6.3.1.m1.1.1" xref="S4.T2.6.6.3.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.3.1.m1.1b"><csymbol cd="latexml" id="S4.T2.6.6.3.1.m1.1.1.cmml" xref="S4.T2.6.6.3.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.3.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.3.1.m1.1d">%</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.7.4"><span class="ltx_text ltx_font_bold" id="S4.T2.7.7.4.1">34.10<math alttext="\%" class="ltx_Math" display="inline" id="S4.T2.7.7.4.1.m1.1"><semantics id="S4.T2.7.7.4.1.m1.1a"><mo id="S4.T2.7.7.4.1.m1.1.1" xref="S4.T2.7.7.4.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.4.1.m1.1b"><csymbol cd="latexml" id="S4.T2.7.7.4.1.m1.1.1.cmml" xref="S4.T2.7.7.4.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.4.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.7.4.1.m1.1d">%</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T2.11.11.5">Recall</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.8.8.1"><span class="ltx_text ltx_font_bold" id="S4.T2.8.8.1.1">43.34<math alttext="\%" class="ltx_Math" display="inline" id="S4.T2.8.8.1.1.m1.1"><semantics id="S4.T2.8.8.1.1.m1.1a"><mo id="S4.T2.8.8.1.1.m1.1.1" xref="S4.T2.8.8.1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.1.1.m1.1b"><csymbol cd="latexml" id="S4.T2.8.8.1.1.m1.1.1.cmml" xref="S4.T2.8.8.1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.1.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.8.1.1.m1.1d">%</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.9.9.2"><span class="ltx_text ltx_font_bold" id="S4.T2.9.9.2.1">37.21<math alttext="\%" class="ltx_Math" display="inline" id="S4.T2.9.9.2.1.m1.1"><semantics id="S4.T2.9.9.2.1.m1.1a"><mo id="S4.T2.9.9.2.1.m1.1.1" xref="S4.T2.9.9.2.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.2.1.m1.1b"><csymbol cd="latexml" id="S4.T2.9.9.2.1.m1.1.1.cmml" xref="S4.T2.9.9.2.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.2.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T2.9.9.2.1.m1.1d">%</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.10.10.3"><span class="ltx_text ltx_font_bold" id="S4.T2.10.10.3.1">34.05<math alttext="\%" class="ltx_Math" display="inline" id="S4.T2.10.10.3.1.m1.1"><semantics id="S4.T2.10.10.3.1.m1.1a"><mo id="S4.T2.10.10.3.1.m1.1.1" xref="S4.T2.10.10.3.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.3.1.m1.1b"><csymbol cd="latexml" id="S4.T2.10.10.3.1.m1.1.1.cmml" xref="S4.T2.10.10.3.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.3.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T2.10.10.3.1.m1.1d">%</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.11.11.4"><span class="ltx_text ltx_font_bold" id="S4.T2.11.11.4.1">29.24<math alttext="\%" class="ltx_Math" display="inline" id="S4.T2.11.11.4.1.m1.1"><semantics id="S4.T2.11.11.4.1.m1.1a"><mo id="S4.T2.11.11.4.1.m1.1.1" xref="S4.T2.11.11.4.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.4.1.m1.1b"><csymbol cd="latexml" id="S4.T2.11.11.4.1.m1.1.1.cmml" xref="S4.T2.11.11.4.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.4.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T2.11.11.4.1.m1.1d">%</annotation></semantics></math></span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3. </span>Experimental results on the Office dataset.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.11">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.11.12.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T3.11.12.1.1" rowspan="2"><span class="ltx_text" id="S4.T3.11.12.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T3.11.12.1.2" rowspan="2"><span class="ltx_text" id="S4.T3.11.12.1.2.1">Metrics</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T3.11.12.1.3">Office (S)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T3.11.12.1.4">Office (L)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.11.13.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.11.13.2.1">@10</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.11.13.2.2">@20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.11.13.2.3">@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.11.13.2.4">@20</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T3.1.1.1.1"><math alttext="\mathcal{L}_{re}" class="ltx_Math" display="inline" id="S4.T3.1.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.1.m1.1a"><msub id="S4.T3.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T3.1.1.1.1.m1.1.1.2" xref="S4.T3.1.1.1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.T3.1.1.1.1.m1.1.1.3" xref="S4.T3.1.1.1.1.m1.1.1.3.cmml"><mi id="S4.T3.1.1.1.1.m1.1.1.3.2" xref="S4.T3.1.1.1.1.m1.1.1.3.2.cmml">r</mi><mo id="S4.T3.1.1.1.1.m1.1.1.3.1" xref="S4.T3.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T3.1.1.1.1.m1.1.1.3.3" xref="S4.T3.1.1.1.1.m1.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><apply id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.1.1.1.1.m1.1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T3.1.1.1.1.m1.1.1.2.cmml" xref="S4.T3.1.1.1.1.m1.1.1.2">ℒ</ci><apply id="S4.T3.1.1.1.1.m1.1.1.3.cmml" xref="S4.T3.1.1.1.1.m1.1.1.3"><times id="S4.T3.1.1.1.1.m1.1.1.3.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1.3.1"></times><ci id="S4.T3.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.T3.1.1.1.1.m1.1.1.3.2">𝑟</ci><ci id="S4.T3.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.T3.1.1.1.1.m1.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">\mathcal{L}_{re}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.2">NDCG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3">0.0024</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.4">0.0032</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.5">0.0041</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.6">0.0053</td>
</tr>
<tr class="ltx_tr" id="S4.T3.11.14.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.11.14.3.1">Recall</th>
<td class="ltx_td ltx_align_center" id="S4.T3.11.14.3.2">0.0037</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.11.14.3.3">0.0068</td>
<td class="ltx_td ltx_align_center" id="S4.T3.11.14.3.4">0.0075</td>
<td class="ltx_td ltx_align_center" id="S4.T3.11.14.3.5">0.0123</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.2.2.1" rowspan="2"><span class="ltx_text" id="S4.T3.2.2.1.1"><math alttext="\mathcal{L}_{co}" class="ltx_Math" display="inline" id="S4.T3.2.2.1.1.m1.1"><semantics id="S4.T3.2.2.1.1.m1.1a"><msub id="S4.T3.2.2.1.1.m1.1.1" xref="S4.T3.2.2.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T3.2.2.1.1.m1.1.1.2" xref="S4.T3.2.2.1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.T3.2.2.1.1.m1.1.1.3" xref="S4.T3.2.2.1.1.m1.1.1.3.cmml"><mi id="S4.T3.2.2.1.1.m1.1.1.3.2" xref="S4.T3.2.2.1.1.m1.1.1.3.2.cmml">c</mi><mo id="S4.T3.2.2.1.1.m1.1.1.3.1" xref="S4.T3.2.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T3.2.2.1.1.m1.1.1.3.3" xref="S4.T3.2.2.1.1.m1.1.1.3.3.cmml">o</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.1.1.m1.1b"><apply id="S4.T3.2.2.1.1.m1.1.1.cmml" xref="S4.T3.2.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.2.2.1.1.m1.1.1.1.cmml" xref="S4.T3.2.2.1.1.m1.1.1">subscript</csymbol><ci id="S4.T3.2.2.1.1.m1.1.1.2.cmml" xref="S4.T3.2.2.1.1.m1.1.1.2">ℒ</ci><apply id="S4.T3.2.2.1.1.m1.1.1.3.cmml" xref="S4.T3.2.2.1.1.m1.1.1.3"><times id="S4.T3.2.2.1.1.m1.1.1.3.1.cmml" xref="S4.T3.2.2.1.1.m1.1.1.3.1"></times><ci id="S4.T3.2.2.1.1.m1.1.1.3.2.cmml" xref="S4.T3.2.2.1.1.m1.1.1.3.2">𝑐</ci><ci id="S4.T3.2.2.1.1.m1.1.1.3.3.cmml" xref="S4.T3.2.2.1.1.m1.1.1.3.3">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.1.1.m1.1c">\mathcal{L}_{co}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_c italic_o end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.2.2.2">NDCG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.3">0.0034</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.2.2.4"><span class="ltx_text ltx_font_bold" id="S4.T3.2.2.4.1">0.0043</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.5"><span class="ltx_text ltx_font_bold" id="S4.T3.2.2.5.1">0.0047</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.6"><span class="ltx_text ltx_font_bold" id="S4.T3.2.2.6.1">0.0059</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.11.15.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.11.15.4.1">Recall</th>
<td class="ltx_td ltx_align_center" id="S4.T3.11.15.4.2">0.0060</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.11.15.4.3">0.0094</td>
<td class="ltx_td ltx_align_center" id="S4.T3.11.15.4.4"><span class="ltx_text ltx_font_bold" id="S4.T3.11.15.4.4.1">0.0079</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.11.15.4.5"><span class="ltx_text ltx_font_bold" id="S4.T3.11.15.4.5.1">0.0125</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.3.3.1" rowspan="2"><span class="ltx_text" id="S4.T3.3.3.1.1"><math alttext="\mathcal{L}_{re}+\mathcal{L}_{co}" class="ltx_Math" display="inline" id="S4.T3.3.3.1.1.m1.1"><semantics id="S4.T3.3.3.1.1.m1.1a"><mrow id="S4.T3.3.3.1.1.m1.1.1" xref="S4.T3.3.3.1.1.m1.1.1.cmml"><msub id="S4.T3.3.3.1.1.m1.1.1.2" xref="S4.T3.3.3.1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T3.3.3.1.1.m1.1.1.2.2" xref="S4.T3.3.3.1.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.T3.3.3.1.1.m1.1.1.2.3" xref="S4.T3.3.3.1.1.m1.1.1.2.3.cmml"><mi id="S4.T3.3.3.1.1.m1.1.1.2.3.2" xref="S4.T3.3.3.1.1.m1.1.1.2.3.2.cmml">r</mi><mo id="S4.T3.3.3.1.1.m1.1.1.2.3.1" xref="S4.T3.3.3.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.T3.3.3.1.1.m1.1.1.2.3.3" xref="S4.T3.3.3.1.1.m1.1.1.2.3.3.cmml">e</mi></mrow></msub><mo id="S4.T3.3.3.1.1.m1.1.1.1" xref="S4.T3.3.3.1.1.m1.1.1.1.cmml">+</mo><msub id="S4.T3.3.3.1.1.m1.1.1.3" xref="S4.T3.3.3.1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T3.3.3.1.1.m1.1.1.3.2" xref="S4.T3.3.3.1.1.m1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.T3.3.3.1.1.m1.1.1.3.3" xref="S4.T3.3.3.1.1.m1.1.1.3.3.cmml"><mi id="S4.T3.3.3.1.1.m1.1.1.3.3.2" xref="S4.T3.3.3.1.1.m1.1.1.3.3.2.cmml">c</mi><mo id="S4.T3.3.3.1.1.m1.1.1.3.3.1" xref="S4.T3.3.3.1.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.3.3.1.1.m1.1.1.3.3.3" xref="S4.T3.3.3.1.1.m1.1.1.3.3.3.cmml">o</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.1.1.m1.1b"><apply id="S4.T3.3.3.1.1.m1.1.1.cmml" xref="S4.T3.3.3.1.1.m1.1.1"><plus id="S4.T3.3.3.1.1.m1.1.1.1.cmml" xref="S4.T3.3.3.1.1.m1.1.1.1"></plus><apply id="S4.T3.3.3.1.1.m1.1.1.2.cmml" xref="S4.T3.3.3.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T3.3.3.1.1.m1.1.1.2.1.cmml" xref="S4.T3.3.3.1.1.m1.1.1.2">subscript</csymbol><ci id="S4.T3.3.3.1.1.m1.1.1.2.2.cmml" xref="S4.T3.3.3.1.1.m1.1.1.2.2">ℒ</ci><apply id="S4.T3.3.3.1.1.m1.1.1.2.3.cmml" xref="S4.T3.3.3.1.1.m1.1.1.2.3"><times id="S4.T3.3.3.1.1.m1.1.1.2.3.1.cmml" xref="S4.T3.3.3.1.1.m1.1.1.2.3.1"></times><ci id="S4.T3.3.3.1.1.m1.1.1.2.3.2.cmml" xref="S4.T3.3.3.1.1.m1.1.1.2.3.2">𝑟</ci><ci id="S4.T3.3.3.1.1.m1.1.1.2.3.3.cmml" xref="S4.T3.3.3.1.1.m1.1.1.2.3.3">𝑒</ci></apply></apply><apply id="S4.T3.3.3.1.1.m1.1.1.3.cmml" xref="S4.T3.3.3.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T3.3.3.1.1.m1.1.1.3.1.cmml" xref="S4.T3.3.3.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.T3.3.3.1.1.m1.1.1.3.2.cmml" xref="S4.T3.3.3.1.1.m1.1.1.3.2">ℒ</ci><apply id="S4.T3.3.3.1.1.m1.1.1.3.3.cmml" xref="S4.T3.3.3.1.1.m1.1.1.3.3"><times id="S4.T3.3.3.1.1.m1.1.1.3.3.1.cmml" xref="S4.T3.3.3.1.1.m1.1.1.3.3.1"></times><ci id="S4.T3.3.3.1.1.m1.1.1.3.3.2.cmml" xref="S4.T3.3.3.1.1.m1.1.1.3.3.2">𝑐</ci><ci id="S4.T3.3.3.1.1.m1.1.1.3.3.3.cmml" xref="S4.T3.3.3.1.1.m1.1.1.3.3.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.1.1.m1.1c">\mathcal{L}_{re}+\mathcal{L}_{co}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.3.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT italic_c italic_o end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.3.3.2">NDCG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.3.1">0.0035</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.4">0.0042</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.5">0.0042</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.6">0.0052</td>
</tr>
<tr class="ltx_tr" id="S4.T3.11.16.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.11.16.5.1">Recall</th>
<td class="ltx_td ltx_align_center" id="S4.T3.11.16.5.2"><span class="ltx_text ltx_font_bold" id="S4.T3.11.16.5.2.1">0.0066</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.11.16.5.3"><span class="ltx_text ltx_font_bold" id="S4.T3.11.16.5.3.1">0.0096</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.11.16.5.4"><span class="ltx_text ltx_font_bold" id="S4.T3.11.16.5.4.1">0.0079</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.11.16.5.5">0.0119</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.7.7.5" rowspan="2"><span class="ltx_text" id="S4.T3.7.7.5.1">Impr.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.7.7.6">NDCG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.4.1"><span class="ltx_text ltx_font_bold" id="S4.T3.4.4.1.1">43.80<math alttext="\%" class="ltx_Math" display="inline" id="S4.T3.4.4.1.1.m1.1"><semantics id="S4.T3.4.4.1.1.m1.1a"><mo id="S4.T3.4.4.1.1.m1.1.1" xref="S4.T3.4.4.1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.1.1.m1.1b"><csymbol cd="latexml" id="S4.T3.4.4.1.1.m1.1.1.cmml" xref="S4.T3.4.4.1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.1.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.4.1.1.m1.1d">%</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.5.2"><span class="ltx_text ltx_font_bold" id="S4.T3.5.5.2.1">31.06<math alttext="\%" class="ltx_Math" display="inline" id="S4.T3.5.5.2.1.m1.1"><semantics id="S4.T3.5.5.2.1.m1.1a"><mo id="S4.T3.5.5.2.1.m1.1.1" xref="S4.T3.5.5.2.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.2.1.m1.1b"><csymbol cd="latexml" id="S4.T3.5.5.2.1.m1.1.1.cmml" xref="S4.T3.5.5.2.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.2.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.5.2.1.m1.1d">%</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.6.3"><span class="ltx_text ltx_font_bold" id="S4.T3.6.6.3.1">15.11<math alttext="\%" class="ltx_Math" display="inline" id="S4.T3.6.6.3.1.m1.1"><semantics id="S4.T3.6.6.3.1.m1.1a"><mo id="S4.T3.6.6.3.1.m1.1.1" xref="S4.T3.6.6.3.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.3.1.m1.1b"><csymbol cd="latexml" id="S4.T3.6.6.3.1.m1.1.1.cmml" xref="S4.T3.6.6.3.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.3.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.6.3.1.m1.1d">%</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.7.4"><span class="ltx_text ltx_font_bold" id="S4.T3.7.7.4.1">10.53<math alttext="\%" class="ltx_Math" display="inline" id="S4.T3.7.7.4.1.m1.1"><semantics id="S4.T3.7.7.4.1.m1.1a"><mo id="S4.T3.7.7.4.1.m1.1.1" xref="S4.T3.7.7.4.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T3.7.7.4.1.m1.1b"><csymbol cd="latexml" id="S4.T3.7.7.4.1.m1.1.1.cmml" xref="S4.T3.7.7.4.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.7.4.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.7.4.1.m1.1d">%</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.11.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T3.11.11.5">Recall</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.8.8.1"><span class="ltx_text ltx_font_bold" id="S4.T3.8.8.1.1">80.95<math alttext="\%" class="ltx_Math" display="inline" id="S4.T3.8.8.1.1.m1.1"><semantics id="S4.T3.8.8.1.1.m1.1a"><mo id="S4.T3.8.8.1.1.m1.1.1" xref="S4.T3.8.8.1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T3.8.8.1.1.m1.1b"><csymbol cd="latexml" id="S4.T3.8.8.1.1.m1.1.1.cmml" xref="S4.T3.8.8.1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.8.1.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.8.1.1.m1.1d">%</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.9.9.2"><span class="ltx_text ltx_font_bold" id="S4.T3.9.9.2.1">41.03<math alttext="\%" class="ltx_Math" display="inline" id="S4.T3.9.9.2.1.m1.1"><semantics id="S4.T3.9.9.2.1.m1.1a"><mo id="S4.T3.9.9.2.1.m1.1.1" xref="S4.T3.9.9.2.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T3.9.9.2.1.m1.1b"><csymbol cd="latexml" id="S4.T3.9.9.2.1.m1.1.1.cmml" xref="S4.T3.9.9.2.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.9.2.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.9.9.2.1.m1.1d">%</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.10.10.3"><span class="ltx_text ltx_font_bold" id="S4.T3.10.10.3.1">5.38<math alttext="\%" class="ltx_Math" display="inline" id="S4.T3.10.10.3.1.m1.1"><semantics id="S4.T3.10.10.3.1.m1.1a"><mo id="S4.T3.10.10.3.1.m1.1.1" xref="S4.T3.10.10.3.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T3.10.10.3.1.m1.1b"><csymbol cd="latexml" id="S4.T3.10.10.3.1.m1.1.1.cmml" xref="S4.T3.10.10.3.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.10.3.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.10.10.3.1.m1.1d">%</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.11.11.4"><span class="ltx_text ltx_font_bold" id="S4.T3.11.11.4.1">1.46<math alttext="\%" class="ltx_Math" display="inline" id="S4.T3.11.11.4.1.m1.1"><semantics id="S4.T3.11.11.4.1.m1.1a"><mo id="S4.T3.11.11.4.1.m1.1.1" xref="S4.T3.11.11.4.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T3.11.11.4.1.m1.1b"><csymbol cd="latexml" id="S4.T3.11.11.4.1.m1.1.1.cmml" xref="S4.T3.11.11.4.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.11.4.1.m1.1c">\%</annotation><annotation encoding="application/x-llamapun" id="S4.T3.11.11.4.1.m1.1d">%</annotation></semantics></math></span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S4.F3">
<table class="ltx_tabular ltx_align_middle" id="S4.F3.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.F3.2.2">
<td class="ltx_td ltx_align_center" id="S4.F3.2.2.2">
<div class="ltx_inline-block ltx_transformed_outer" id="S4.F3.1.1.1.1" style="width:212.5pt;height:208.2pt;vertical-align:-0.5pt;"><span class="ltx_transformed_inner" style="transform:translate(-111.5pt,109.0pt) scale(0.487881273577991,0.487881273577991) ;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="816" id="S4.F3.1.1.1.1.g1" src="x3.png" width="831"/>
</span></div>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.F3.2.2.2.2" style="width:212.5pt;height:212.4pt;vertical-align:-0.5pt;"><span class="ltx_transformed_inner" style="transform:translate(-111.5pt,111.2pt) scale(0.487881273577991,0.487881273577991) ;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="833" id="S4.F3.2.2.2.2.g1" src="x4.png" width="830"/>
</span></div>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Analysis on temperature <math alttext="\tau" class="ltx_Math" display="inline" id="S4.F3.5.m1.1"><semantics id="S4.F3.5.m1.1b"><mi id="S4.F3.5.m1.1.1" xref="S4.F3.5.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.F3.5.m1.1c"><ci id="S4.F3.5.m1.1.1.cmml" xref="S4.F3.5.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.5.m1.1d">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.F3.5.m1.1e">italic_τ</annotation></semantics></math> and training epochs <math alttext="e" class="ltx_Math" display="inline" id="S4.F3.6.m2.1"><semantics id="S4.F3.6.m2.1b"><mi id="S4.F3.6.m2.1.1" xref="S4.F3.6.m2.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S4.F3.6.m2.1c"><ci id="S4.F3.6.m2.1.1.cmml" xref="S4.F3.6.m2.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.6.m2.1d">e</annotation><annotation encoding="application/x-llamapun" id="S4.F3.6.m2.1e">italic_e</annotation></semantics></math> on the MIND dataset.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Performance Comparison and Analysis</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.7"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.7.1">Performance Comparison.</span>
To validate our CoST method for semantic tokenization, we conducted experiments across various settings, including using random hashing and <math alttext="\mathcal{L}_{\text{re}}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3a.cmml">re</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">ℒ</ci><ci id="S4.SS2.p1.1.m1.1.1.3a.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><mtext id="S4.SS2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.1.m1.1.1.3">re</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mathcal{L}_{\text{re}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT re end_POSTSUBSCRIPT</annotation></semantics></math> as baselines, employing only <math alttext="\mathcal{L}_{\text{co}}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><msub id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3a.cmml">co</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">ℒ</ci><ci id="S4.SS2.p1.2.m2.1.1.3a.cmml" xref="S4.SS2.p1.2.m2.1.1.3"><mtext id="S4.SS2.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.2.m2.1.1.3">co</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\mathcal{L}_{\text{co}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT co end_POSTSUBSCRIPT</annotation></semantics></math>, and combining <math alttext="\mathcal{L}_{\text{re}}" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><msub id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3a.cmml">re</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">ℒ</ci><ci id="S4.SS2.p1.3.m3.1.1.3a.cmml" xref="S4.SS2.p1.3.m3.1.1.3"><mtext id="S4.SS2.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.3.m3.1.1.3">re</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\mathcal{L}_{\text{re}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT re end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="\mathcal{L}_{\text{co}}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><msub id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3a.cmml">co</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">ℒ</ci><ci id="S4.SS2.p1.4.m4.1.1.3a.cmml" xref="S4.SS2.p1.4.m4.1.1.3"><mtext id="S4.SS2.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.4.m4.1.1.3">co</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\mathcal{L}_{\text{co}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT co end_POSTSUBSCRIPT</annotation></semantics></math>. Table <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S4.T2" title="Table 2 ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> demonstrates that, on the MIND dataset, our CoST tokenization method outperforms these settings, showing significant improvements in both NDCG@k and Recall@k by approximately 38% and 36%, respectively. Table <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S4.T3" title="Table 3 ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> presents the results for the Office (S) and Office (L) datasets. For shorter sequences and fewer samples, the combination of <math alttext="\mathcal{L}_{\text{co}}+\mathcal{L}_{\text{re}}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><msub id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.5.m5.1.1.2.2" xref="S4.SS2.p1.5.m5.1.1.2.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.5.m5.1.1.2.3" xref="S4.SS2.p1.5.m5.1.1.2.3a.cmml">co</mtext></msub><mo id="S4.SS2.p1.5.m5.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.cmml">+</mo><msub id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.5.m5.1.1.3.2" xref="S4.SS2.p1.5.m5.1.1.3.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.5.m5.1.1.3.3" xref="S4.SS2.p1.5.m5.1.1.3.3a.cmml">re</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><plus id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1"></plus><apply id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.2.1.cmml" xref="S4.SS2.p1.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.2.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2.2">ℒ</ci><ci id="S4.SS2.p1.5.m5.1.1.2.3a.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3"><mtext id="S4.SS2.p1.5.m5.1.1.2.3.cmml" mathsize="70%" xref="S4.SS2.p1.5.m5.1.1.2.3">co</mtext></ci></apply><apply id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2">ℒ</ci><ci id="S4.SS2.p1.5.m5.1.1.3.3a.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3"><mtext id="S4.SS2.p1.5.m5.1.1.3.3.cmml" mathsize="70%" xref="S4.SS2.p1.5.m5.1.1.3.3">re</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\mathcal{L}_{\text{co}}+\mathcal{L}_{\text{re}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">caligraphic_L start_POSTSUBSCRIPT co end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT re end_POSTSUBSCRIPT</annotation></semantics></math> slightly outperforms <math alttext="\mathcal{L}_{\text{co}}" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.1"><semantics id="S4.SS2.p1.6.m6.1a"><msub id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.6.m6.1.1.2" xref="S4.SS2.p1.6.m6.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.6.m6.1.1.3" xref="S4.SS2.p1.6.m6.1.1.3a.cmml">co</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2">ℒ</ci><ci id="S4.SS2.p1.6.m6.1.1.3a.cmml" xref="S4.SS2.p1.6.m6.1.1.3"><mtext id="S4.SS2.p1.6.m6.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.6.m6.1.1.3">co</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">\mathcal{L}_{\text{co}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.1d">caligraphic_L start_POSTSUBSCRIPT co end_POSTSUBSCRIPT</annotation></semantics></math> alone, whereas for longer sequences and more samples, <math alttext="\mathcal{L}_{\text{co}}" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m7.1"><semantics id="S4.SS2.p1.7.m7.1a"><msub id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3a.cmml">co</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">ℒ</ci><ci id="S4.SS2.p1.7.m7.1.1.3a.cmml" xref="S4.SS2.p1.7.m7.1.1.3"><mtext id="S4.SS2.p1.7.m7.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.7.m7.1.1.3">co</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">\mathcal{L}_{\text{co}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m7.1d">caligraphic_L start_POSTSUBSCRIPT co end_POSTSUBSCRIPT</annotation></semantics></math> excels. This underscores the effectiveness of our CoST approach in the context of generative recommendation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.8"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">Sensitivity Analysis of Temperature <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS2.p2.1.1.m1.1"><semantics id="S4.SS2.p2.1.1.m1.1a"><mi id="S4.SS2.p2.1.1.m1.1.1" xref="S4.SS2.p2.1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.1.m1.1b"><ci id="S4.SS2.p2.1.1.m1.1.1.cmml" xref="S4.SS2.p2.1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.1.m1.1d">italic_τ</annotation></semantics></math> and Training Epochs.</span>
To analyze how the temperature <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m1.1"><semantics id="S4.SS2.p2.2.m1.1a"><mi id="S4.SS2.p2.2.m1.1.1" xref="S4.SS2.p2.2.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m1.1b"><ci id="S4.SS2.p2.2.m1.1.1.cmml" xref="S4.SS2.p2.2.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m1.1d">italic_τ</annotation></semantics></math> affects the training of CoST, we conducted experiments on the MIND dataset with <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m2.1"><semantics id="S4.SS2.p2.3.m2.1a"><mi id="S4.SS2.p2.3.m2.1.1" xref="S4.SS2.p2.3.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m2.1b"><ci id="S4.SS2.p2.3.m2.1.1.cmml" xref="S4.SS2.p2.3.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m2.1d">italic_τ</annotation></semantics></math> set to <math alttext="\{0.1,0.5,1.0\}" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m3.3"><semantics id="S4.SS2.p2.4.m3.3a"><mrow id="S4.SS2.p2.4.m3.3.4.2" xref="S4.SS2.p2.4.m3.3.4.1.cmml"><mo id="S4.SS2.p2.4.m3.3.4.2.1" stretchy="false" xref="S4.SS2.p2.4.m3.3.4.1.cmml">{</mo><mn id="S4.SS2.p2.4.m3.1.1" xref="S4.SS2.p2.4.m3.1.1.cmml">0.1</mn><mo id="S4.SS2.p2.4.m3.3.4.2.2" xref="S4.SS2.p2.4.m3.3.4.1.cmml">,</mo><mn id="S4.SS2.p2.4.m3.2.2" xref="S4.SS2.p2.4.m3.2.2.cmml">0.5</mn><mo id="S4.SS2.p2.4.m3.3.4.2.3" xref="S4.SS2.p2.4.m3.3.4.1.cmml">,</mo><mn id="S4.SS2.p2.4.m3.3.3" xref="S4.SS2.p2.4.m3.3.3.cmml">1.0</mn><mo id="S4.SS2.p2.4.m3.3.4.2.4" stretchy="false" xref="S4.SS2.p2.4.m3.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m3.3b"><set id="S4.SS2.p2.4.m3.3.4.1.cmml" xref="S4.SS2.p2.4.m3.3.4.2"><cn id="S4.SS2.p2.4.m3.1.1.cmml" type="float" xref="S4.SS2.p2.4.m3.1.1">0.1</cn><cn id="S4.SS2.p2.4.m3.2.2.cmml" type="float" xref="S4.SS2.p2.4.m3.2.2">0.5</cn><cn id="S4.SS2.p2.4.m3.3.3.cmml" type="float" xref="S4.SS2.p2.4.m3.3.3">1.0</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m3.3c">\{0.1,0.5,1.0\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m3.3d">{ 0.1 , 0.5 , 1.0 }</annotation></semantics></math>. CoST was trained for 20 and 100 epochs, respectively, yielding the best Recall@40 when <math alttext="\tau=1.0" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m4.1"><semantics id="S4.SS2.p2.5.m4.1a"><mrow id="S4.SS2.p2.5.m4.1.1" xref="S4.SS2.p2.5.m4.1.1.cmml"><mi id="S4.SS2.p2.5.m4.1.1.2" xref="S4.SS2.p2.5.m4.1.1.2.cmml">τ</mi><mo id="S4.SS2.p2.5.m4.1.1.1" xref="S4.SS2.p2.5.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.5.m4.1.1.3" xref="S4.SS2.p2.5.m4.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m4.1b"><apply id="S4.SS2.p2.5.m4.1.1.cmml" xref="S4.SS2.p2.5.m4.1.1"><eq id="S4.SS2.p2.5.m4.1.1.1.cmml" xref="S4.SS2.p2.5.m4.1.1.1"></eq><ci id="S4.SS2.p2.5.m4.1.1.2.cmml" xref="S4.SS2.p2.5.m4.1.1.2">𝜏</ci><cn id="S4.SS2.p2.5.m4.1.1.3.cmml" type="float" xref="S4.SS2.p2.5.m4.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m4.1c">\tau=1.0</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m4.1d">italic_τ = 1.0</annotation></semantics></math> and <math alttext="\tau=0.1" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m5.1"><semantics id="S4.SS2.p2.6.m5.1a"><mrow id="S4.SS2.p2.6.m5.1.1" xref="S4.SS2.p2.6.m5.1.1.cmml"><mi id="S4.SS2.p2.6.m5.1.1.2" xref="S4.SS2.p2.6.m5.1.1.2.cmml">τ</mi><mo id="S4.SS2.p2.6.m5.1.1.1" xref="S4.SS2.p2.6.m5.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.6.m5.1.1.3" xref="S4.SS2.p2.6.m5.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m5.1b"><apply id="S4.SS2.p2.6.m5.1.1.cmml" xref="S4.SS2.p2.6.m5.1.1"><eq id="S4.SS2.p2.6.m5.1.1.1.cmml" xref="S4.SS2.p2.6.m5.1.1.1"></eq><ci id="S4.SS2.p2.6.m5.1.1.2.cmml" xref="S4.SS2.p2.6.m5.1.1.2">𝜏</ci><cn id="S4.SS2.p2.6.m5.1.1.3.cmml" type="float" xref="S4.SS2.p2.6.m5.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m5.1c">\tau=0.1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m5.1d">italic_τ = 0.1</annotation></semantics></math>, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S4.F3" title="Figure 3 ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>. This indicates that the performance of CoST varies with <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m6.1"><semantics id="S4.SS2.p2.7.m6.1a"><mi id="S4.SS2.p2.7.m6.1.1" xref="S4.SS2.p2.7.m6.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m6.1b"><ci id="S4.SS2.p2.7.m6.1.1.cmml" xref="S4.SS2.p2.7.m6.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m6.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.7.m6.1d">italic_τ</annotation></semantics></math> within a specific range. Additionally, fixing <math alttext="\tau=0.1" class="ltx_Math" display="inline" id="S4.SS2.p2.8.m7.1"><semantics id="S4.SS2.p2.8.m7.1a"><mrow id="S4.SS2.p2.8.m7.1.1" xref="S4.SS2.p2.8.m7.1.1.cmml"><mi id="S4.SS2.p2.8.m7.1.1.2" xref="S4.SS2.p2.8.m7.1.1.2.cmml">τ</mi><mo id="S4.SS2.p2.8.m7.1.1.1" xref="S4.SS2.p2.8.m7.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.8.m7.1.1.3" xref="S4.SS2.p2.8.m7.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m7.1b"><apply id="S4.SS2.p2.8.m7.1.1.cmml" xref="S4.SS2.p2.8.m7.1.1"><eq id="S4.SS2.p2.8.m7.1.1.1.cmml" xref="S4.SS2.p2.8.m7.1.1.1"></eq><ci id="S4.SS2.p2.8.m7.1.1.2.cmml" xref="S4.SS2.p2.8.m7.1.1.2">𝜏</ci><cn id="S4.SS2.p2.8.m7.1.1.3.cmml" type="float" xref="S4.SS2.p2.8.m7.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m7.1c">\tau=0.1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.8.m7.1d">italic_τ = 0.1</annotation></semantics></math>, we trained the model for 20, 50, and 100 epochs. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S4.F3" title="Figure 3 ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, with an increase in the number of training epochs, the loss steadily decreases, and the NDCG and Recall metrics consistently improve, demonstrating the effectiveness of CoST in training generative recommendation models.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="424" id="S4.F4.g1" src="x5.png" width="457"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="424" id="S4.F4.g2" src="x6.png" width="457"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_square" height="422" id="S4.F4.g3" src="x7.png" width="456"/></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Sensitivity analysis on codebook size <math alttext="K" class="ltx_Math" display="inline" id="S4.F4.10.m1.1"><semantics id="S4.F4.10.m1.1b"><mi id="S4.F4.10.m1.1.1" xref="S4.F4.10.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.F4.10.m1.1c"><ci id="S4.F4.10.m1.1.1.cmml" xref="S4.F4.10.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.10.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S4.F4.10.m1.1e">italic_K</annotation></semantics></math> (fixed <math alttext="M=3" class="ltx_Math" display="inline" id="S4.F4.11.m2.1"><semantics id="S4.F4.11.m2.1b"><mrow id="S4.F4.11.m2.1.1" xref="S4.F4.11.m2.1.1.cmml"><mi id="S4.F4.11.m2.1.1.2" xref="S4.F4.11.m2.1.1.2.cmml">M</mi><mo id="S4.F4.11.m2.1.1.1" xref="S4.F4.11.m2.1.1.1.cmml">=</mo><mn id="S4.F4.11.m2.1.1.3" xref="S4.F4.11.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.11.m2.1c"><apply id="S4.F4.11.m2.1.1.cmml" xref="S4.F4.11.m2.1.1"><eq id="S4.F4.11.m2.1.1.1.cmml" xref="S4.F4.11.m2.1.1.1"></eq><ci id="S4.F4.11.m2.1.1.2.cmml" xref="S4.F4.11.m2.1.1.2">𝑀</ci><cn id="S4.F4.11.m2.1.1.3.cmml" type="integer" xref="S4.F4.11.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.11.m2.1d">M=3</annotation><annotation encoding="application/x-llamapun" id="S4.F4.11.m2.1e">italic_M = 3</annotation></semantics></math> and <math alttext="d=96" class="ltx_Math" display="inline" id="S4.F4.12.m3.1"><semantics id="S4.F4.12.m3.1b"><mrow id="S4.F4.12.m3.1.1" xref="S4.F4.12.m3.1.1.cmml"><mi id="S4.F4.12.m3.1.1.2" xref="S4.F4.12.m3.1.1.2.cmml">d</mi><mo id="S4.F4.12.m3.1.1.1" xref="S4.F4.12.m3.1.1.1.cmml">=</mo><mn id="S4.F4.12.m3.1.1.3" xref="S4.F4.12.m3.1.1.3.cmml">96</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.12.m3.1c"><apply id="S4.F4.12.m3.1.1.cmml" xref="S4.F4.12.m3.1.1"><eq id="S4.F4.12.m3.1.1.1.cmml" xref="S4.F4.12.m3.1.1.1"></eq><ci id="S4.F4.12.m3.1.1.2.cmml" xref="S4.F4.12.m3.1.1.2">𝑑</ci><cn id="S4.F4.12.m3.1.1.3.cmml" type="integer" xref="S4.F4.12.m3.1.1.3">96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.12.m3.1d">d=96</annotation><annotation encoding="application/x-llamapun" id="S4.F4.12.m3.1e">italic_d = 96</annotation></semantics></math>), number of codebooks <math alttext="M" class="ltx_Math" display="inline" id="S4.F4.13.m4.1"><semantics id="S4.F4.13.m4.1b"><mi id="S4.F4.13.m4.1.1" xref="S4.F4.13.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.F4.13.m4.1c"><ci id="S4.F4.13.m4.1.1.cmml" xref="S4.F4.13.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.13.m4.1d">M</annotation><annotation encoding="application/x-llamapun" id="S4.F4.13.m4.1e">italic_M</annotation></semantics></math> (fixed <math alttext="K=64" class="ltx_Math" display="inline" id="S4.F4.14.m5.1"><semantics id="S4.F4.14.m5.1b"><mrow id="S4.F4.14.m5.1.1" xref="S4.F4.14.m5.1.1.cmml"><mi id="S4.F4.14.m5.1.1.2" xref="S4.F4.14.m5.1.1.2.cmml">K</mi><mo id="S4.F4.14.m5.1.1.1" xref="S4.F4.14.m5.1.1.1.cmml">=</mo><mn id="S4.F4.14.m5.1.1.3" xref="S4.F4.14.m5.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.14.m5.1c"><apply id="S4.F4.14.m5.1.1.cmml" xref="S4.F4.14.m5.1.1"><eq id="S4.F4.14.m5.1.1.1.cmml" xref="S4.F4.14.m5.1.1.1"></eq><ci id="S4.F4.14.m5.1.1.2.cmml" xref="S4.F4.14.m5.1.1.2">𝐾</ci><cn id="S4.F4.14.m5.1.1.3.cmml" type="integer" xref="S4.F4.14.m5.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.14.m5.1d">K=64</annotation><annotation encoding="application/x-llamapun" id="S4.F4.14.m5.1e">italic_K = 64</annotation></semantics></math> and <math alttext="d=96" class="ltx_Math" display="inline" id="S4.F4.15.m6.1"><semantics id="S4.F4.15.m6.1b"><mrow id="S4.F4.15.m6.1.1" xref="S4.F4.15.m6.1.1.cmml"><mi id="S4.F4.15.m6.1.1.2" xref="S4.F4.15.m6.1.1.2.cmml">d</mi><mo id="S4.F4.15.m6.1.1.1" xref="S4.F4.15.m6.1.1.1.cmml">=</mo><mn id="S4.F4.15.m6.1.1.3" xref="S4.F4.15.m6.1.1.3.cmml">96</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.15.m6.1c"><apply id="S4.F4.15.m6.1.1.cmml" xref="S4.F4.15.m6.1.1"><eq id="S4.F4.15.m6.1.1.1.cmml" xref="S4.F4.15.m6.1.1.1"></eq><ci id="S4.F4.15.m6.1.1.2.cmml" xref="S4.F4.15.m6.1.1.2">𝑑</ci><cn id="S4.F4.15.m6.1.1.3.cmml" type="integer" xref="S4.F4.15.m6.1.1.3">96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.15.m6.1d">d=96</annotation><annotation encoding="application/x-llamapun" id="S4.F4.15.m6.1e">italic_d = 96</annotation></semantics></math>), embedding dimension <math alttext="d" class="ltx_Math" display="inline" id="S4.F4.16.m7.1"><semantics id="S4.F4.16.m7.1b"><mi id="S4.F4.16.m7.1.1" xref="S4.F4.16.m7.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.F4.16.m7.1c"><ci id="S4.F4.16.m7.1.1.cmml" xref="S4.F4.16.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.16.m7.1d">d</annotation><annotation encoding="application/x-llamapun" id="S4.F4.16.m7.1e">italic_d</annotation></semantics></math> (fixed <math alttext="K=64" class="ltx_Math" display="inline" id="S4.F4.17.m8.1"><semantics id="S4.F4.17.m8.1b"><mrow id="S4.F4.17.m8.1.1" xref="S4.F4.17.m8.1.1.cmml"><mi id="S4.F4.17.m8.1.1.2" xref="S4.F4.17.m8.1.1.2.cmml">K</mi><mo id="S4.F4.17.m8.1.1.1" xref="S4.F4.17.m8.1.1.1.cmml">=</mo><mn id="S4.F4.17.m8.1.1.3" xref="S4.F4.17.m8.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.17.m8.1c"><apply id="S4.F4.17.m8.1.1.cmml" xref="S4.F4.17.m8.1.1"><eq id="S4.F4.17.m8.1.1.1.cmml" xref="S4.F4.17.m8.1.1.1"></eq><ci id="S4.F4.17.m8.1.1.2.cmml" xref="S4.F4.17.m8.1.1.2">𝐾</ci><cn id="S4.F4.17.m8.1.1.3.cmml" type="integer" xref="S4.F4.17.m8.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.17.m8.1d">K=64</annotation><annotation encoding="application/x-llamapun" id="S4.F4.17.m8.1e">italic_K = 64</annotation></semantics></math> and <math alttext="M=3" class="ltx_Math" display="inline" id="S4.F4.18.m9.1"><semantics id="S4.F4.18.m9.1b"><mrow id="S4.F4.18.m9.1.1" xref="S4.F4.18.m9.1.1.cmml"><mi id="S4.F4.18.m9.1.1.2" xref="S4.F4.18.m9.1.1.2.cmml">M</mi><mo id="S4.F4.18.m9.1.1.1" xref="S4.F4.18.m9.1.1.1.cmml">=</mo><mn id="S4.F4.18.m9.1.1.3" xref="S4.F4.18.m9.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.18.m9.1c"><apply id="S4.F4.18.m9.1.1.cmml" xref="S4.F4.18.m9.1.1"><eq id="S4.F4.18.m9.1.1.1.cmml" xref="S4.F4.18.m9.1.1.1"></eq><ci id="S4.F4.18.m9.1.1.2.cmml" xref="S4.F4.18.m9.1.1.2">𝑀</ci><cn id="S4.F4.18.m9.1.1.3.cmml" type="integer" xref="S4.F4.18.m9.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.18.m9.1d">M=3</annotation><annotation encoding="application/x-llamapun" id="S4.F4.18.m9.1e">italic_M = 3</annotation></semantics></math>) on the MIND dataset.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.3.1">Sensitivity Analysis of Codebooks.</span>
The effectiveness of semantic tokenization can be influenced by key hyperparameters, such as the codebook size (<math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_K</annotation></semantics></math>), the number of codebooks (<math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_M</annotation></semantics></math>), and the embedding dimension (<math alttext="d" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">italic_d</annotation></semantics></math>) of code vectors. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.14774v2#S4.F4" title="Figure 4 ‣ 4.2. Performance Comparison and Analysis ‣ 4. Experiments ‣ CoST: Contrastive Quantization based Semantic Tokenization for Generative Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>, as the codebook size and the number of codebooks increases, NDCG shows a consistent upward trend. This suggests that a larger token space allows for more effective representation of each item, leading to more precise tokenization. Additionally, as the embedding dimension increases from 32 to 96, the model’s capability to represent items improves, leading to enhancements across various metrics. However, increasing the dimension to 256 results in a slight performance degradation due to overfitting.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this work, we delve deeper into semantic tokenization as a crucial preliminary step for generative recommendation tasks. To overcome the limitations of reconstruction quantization-based RQ-VAE, we introduce contrastive quantization into the tokenization process, resulting in the CoST method. By leveraging contrastive loss, which maximizes the top-one probability within a batch, CoST more effectively captures the underlying distribution of item similarities, providing a key advantage for recommendation tasks. Our experimental results demonstrate the effectiveness of CoST in enhancing generative recommendation performance. While CoST currently focuses on top-one neighborhood alignment, future work could extend this to consider top-k nearest neighbors. Looking ahead, we anticipate that further advancements in semantic tokenization, potentially incorporating multimodal information or user behavior data, will continue to improve the efficacy of generative recommender systems.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
We gratefully acknowledge the partial support of MindSpore (<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.mindspore.cn" title="">https://www.mindspore.cn</a>) for this work, which is a new deep learning computing framework.

</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Nicola De Cao, Gautier Izacard, Sebastian Riedel, and Fabio Petroni. 2021.

</span>
<span class="ltx_bibblock">Autoregressive Entity Retrieval.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2010.00904 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Covington et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Paul Covington, Jay Adams, and Emre Sargin. 2016.

</span>
<span class="ltx_bibblock">Deep Neural Networks for Youtube Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the 10th ACM Conference on Recommender Systems</em>. 191–198.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Douze et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Matthijs Douze, Alexandr Guzhva, Chengqi Deng, Jeff Johnson, Gergely Szilvasy, Pierre-Emmanuel Mazaré, Maria Lomeli, Lucas Hosseini, and Hervé Jégou. 2024.

</span>
<span class="ltx_bibblock">The Faiss library.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">CoRR</em> abs/2401.08281 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Tianqi Du, Yifei Wang, and Yisen Wang. 2024.

</span>
<span class="ltx_bibblock">On the Role of Discrete Tokenization in Visual Representation Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">The Twelfth International Conference on Learning Representations (ICLR)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Chao Feng, Wuchao Li, Defu Lian, Zheng Liu, and Enhong Chen. 2022.

</span>
<span class="ltx_bibblock">Recommender Forest for Efficient Retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">Advances in Neural Information Processing Systems</em> 35 (2022), 38912–38924.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yue Feng, Shuchang Liu, Zhenghai Xue, Qingpeng Cai, Lantao Hu, Peng Jiang, Kun Gai, and Fei Sun. 2023.

</span>
<span class="ltx_bibblock">A Large Language Model Enhanced Conversational Recommender System.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">CoRR</em> abs/2308.06212 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Shen Gao, Jiabao Fang, Quan Tu, Zhitao Yao, Zhumin Chen, Pengjie Ren, and Zhaochun Ren. 2024.

</span>
<span class="ltx_bibblock">Generative News Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">Proceedings of the ACM on Web Conference (WWW)</em>. 3444–3453.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Shijie Geng, Shuchang Liu, Zuohui Fu, Yingqiang Ge, and Yongfeng Zhang. 2022.

</span>
<span class="ltx_bibblock">Recommendation as language processing (rlp): A unified pretrain, personalized prompt &amp; predict paradigm (p5). In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the 16th ACM Conference on Recommender Systems</em>. 299–315.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hua et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wenyue Hua, Shuyuan Xu, Yingqiang Ge, and Yongfeng Zhang. 2023.

</span>
<span class="ltx_bibblock">How to Index Item IDs for Recommendation Foundation Models.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2305.06569 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huh et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Minyoung Huh, Brian Cheung, Pulkit Agrawal, and Phillip Isola. 2023.

</span>
<span class="ltx_bibblock">Straightening Out the Straight-Through Estimator: Overcoming Optimization Challenges in Vector Quantized Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">International Conference on Machine Learning (ICML)</em>. 14096–14113.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jeff Johnson, Matthijs Douze, and Hervé Jégou. 2021.

</span>
<span class="ltx_bibblock">Billion-Scale Similarity Search with GPUs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">IEEE Trans. Big Data</em> 7, 3 (2021), 535–547.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Doyup Lee, Chiheon Kim, Saehoon Kim, Minsu Cho, and Wook-Shin Han. 2022.

</span>
<span class="ltx_bibblock">Autoregressive image generation using residual quantization. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>. 11523–11532.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Xinyu Lin, Wenjie Wang, Yongqi Li, Fuli Feng, See-Kiong Ng, and Tat-Seng Chua. 2024.

</span>
<span class="ltx_bibblock">Bridging Items and Language: A Transition Paradigm for Large Language Model-Based Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (KDD)</em>. 1816–1826.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2024a)</span>
<span class="ltx_bibblock">
Qijiong Liu, Xiaoyu Dong, Jiaren Xiao, Nuo Chen, Hengchang Hu, Jieming Zhu, Chenxu Zhu, Tetsuya Sakai, and Xiao-Ming Wu. 2024a.

</span>
<span class="ltx_bibblock">Vector Quantization for Recommender Systems: A Review and Outlook.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">CoRR</em> abs/2405.03110 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2024b)</span>
<span class="ltx_bibblock">
Qijiong Liu, Hengchang Hu, Jiahao Wu, Jieming Zhu, Min-Yen Kan, and Xiao-Ming Wu. 2024b.

</span>
<span class="ltx_bibblock">Discrete Semantic Tokenization for Deep CTR Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Companion Proceedings of the ACM on Web Conference (WWW)</em>. ACM, 919–922.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Qijiong Liu, Jieming Zhu, Jiahao Wu, Tiandeng Wu, Zhenhua Dong, and Xiao-Ming Wu. 2023.

</span>
<span class="ltx_bibblock">FANS: Fast Non-Autoregressive Sequence Generation for Item List Continuation. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the ACM Web Conference (WWW)</em>. 3309–3318.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lubos et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Sebastian Lubos, Thi Ngoc Trang Tran, Alexander Felfernig, Seda Polat Erdeniz, and Viet-Man Le. 2024.

</span>
<span class="ltx_bibblock">LLM-generated Explanations for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Adjunct Proceedings of the 32nd ACM Conference on User Modeling, Adaptation and Personalization (UMAP)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mao et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Kelong Mao, Jieming Zhu, Xi Xiao, Biao Lu, Zhaowei Wang, and Xiuqiang He. 2021.

</span>
<span class="ltx_bibblock">UltraGCN: Ultra Simplification of Graph Convolutional Networks for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">The 30th ACM International Conference on Information and Knowledge Management (CIKM)</em>. 1253–1262.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Dang Minh Nguyen, Chenfei Wang, Yan Shen, and Yifan Zeng. 2023.

</span>
<span class="ltx_bibblock">LightSAGE: Graph Neural Networks for Large Scale Item Retrieval in Shopee’s Advertisement Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the 17th ACM Conference on Recommender Systems (RecSys)</em>. 334–337.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jianmo Ni, Gustavo Hernández Ábrego, Noah Constant, Ji Ma, Keith B Hall, Daniel Cer, and Yinfei Yang. 2021.

</span>
<span class="ltx_bibblock">Sentence-t5: Scalable sentence encoders from pre-trained text-to-text models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">arXiv preprint arXiv:2108.08877</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">O’Neill and Dutta (2023)</span>
<span class="ltx_bibblock">
James O’Neill and Sourav Dutta. 2023.

</span>
<span class="ltx_bibblock">Improved Vector Quantization For Dense Retrieval with Contrastive Distillation. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval (SIGIR)</em>. 2072–2076.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qu et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Haohao Qu, Wenqi Fan, Zihuai Zhao, and Qing Li. 2024.

</span>
<span class="ltx_bibblock">TokenRec: Learning to Tokenize ID for LLM-based Generative Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">CoRR</em> abs/2406.10450 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajput et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shashank Rajput, Nikhil Mehta, Anima Singh, Raghunandan Hulikal Keshavan, Trung Vu, Lukasz Heldt, Lichan Hong, Yi Tay, Vinh Q. Tran, Jonah Samost, Maciej Kula, Ed H. Chi, and Mahesh Sathiamoorthy. 2023.

</span>
<span class="ltx_bibblock">Recommender Systems with Generative Retrieval. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">Annual Conference on Neural Information Processing Systems (NeurIPS)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yuxin Ren, Qiya Yang, Yichun Wu, Wei Xu, Yalong Wang, and Zhiqiang Zhang. 2024.

</span>
<span class="ltx_bibblock">Non-autoregressive Generative Models for Reranking Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">CoRR</em> abs/2402.06871 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singh et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Anima Singh, Trung Vu, Raghunandan Keshavan, Nikhil Mehta, Xinyang Yi, Lichan Hong, Lukasz Heldt, Li Wei, Ed Chi, and Maheswaran Sathiamoorthy. 2023.

</span>
<span class="ltx_bibblock">Better Generalization with Semantic IDs: A case study in Ranking for Recommendations.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2306.08121 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yubao Tang, Ruqing Zhang, Weiwei Sun, Jiafeng Guo, and Maarten de Rijke. 2024.

</span>
<span class="ltx_bibblock">Recent Advances in Generative Information Retrieval. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Companion Proceedings of the ACM on Web Conference (WWW)</em>. 1238–1241.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tay et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yi Tay, Vinh Q. Tran, Mostafa Dehghani, Jianmo Ni, Dara Bahri, Harsh Mehta, Zhen Qin, Kai Hui, Zhe Zhao, Jai Gupta, Tal Schuster, William W. Cohen, and Donald Metzler. 2022.

</span>
<span class="ltx_bibblock">Transformer Memory as a Differentiable Search Index.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2202.06991 [cs.CL]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van Den Oord et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Aaron Van Den Oord, Oriol Vinyals, et al<span class="ltx_text" id="bib.bib29.3.1">.</span> 2017.

</span>
<span class="ltx_bibblock">Neural discrete representation learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.4.1">Advances in neural information processing systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van den Oord et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Aaron van den Oord, Oriol Vinyals, and Koray Kavukcuoglu. 2018.

</span>
<span class="ltx_bibblock">Neural Discrete Representation Learning.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:1711.00937 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Jizhe Wang, Pipei Huang, Huan Zhao, Zhibo Zhang, Binqiang Zhao, and Dik Lun Lee. 2018.

</span>
<span class="ltx_bibblock">Billion-scale Commodity Embedding for E-commerce Recommendation in Alibaba. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining (KDD)</em>. 839–848.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2022b)</span>
<span class="ltx_bibblock">
Jinpeng Wang, Ziyun Zeng, Bin Chen, Tao Dai, and Shu-Tao Xia. 2022b.

</span>
<span class="ltx_bibblock">Contrastive Quantization with Code Memory for Unsupervised Image Retrieval. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Thirty-Sixth AAAI Conference on Artificial Intelligence (AAAI)</em>. 2468–2476.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jinpeng Wang, Jieming Zhu, and Xiuqiang He. 2021.

</span>
<span class="ltx_bibblock">Cross-Batch Negative Sampling for Training Two-Tower Recommenders. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">The 44th International ACM SIGIR Conference on Research and Development in Information Retrieval (SIGIR)</em>. 1632–1636.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2022a)</span>
<span class="ltx_bibblock">
Liang Wang, Nan Yang, Xiaolong Huang, Binxing Jiao, Linjun Yang, Daxin Jiang, Rangan Majumder, and Furu Wei. 2022a.

</span>
<span class="ltx_bibblock">Text Embeddings by Weakly-Supervised Contrastive Pre-training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">CoRR</em> abs/2212.03533 (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2024a)</span>
<span class="ltx_bibblock">
Wenjie Wang, Honghui Bao, Xilin Chen, Jizhi Zhang, Yongqi Li, Fuli Feng, See-Kiong Ng, and Tat-Seng Chua. 2024a.

</span>
<span class="ltx_bibblock">Learnable Item Tokenization for Generative Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">CoRR</em> abs/2405.07314 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2024b)</span>
<span class="ltx_bibblock">
Ye Wang, Jiahao Xun, Mingjie Hong, Jieming Zhu, Tao Jin, Wang Lin, Haoyuan Li, Linjun Li, Yan Xia, Zhou Zhao, and Zhenhua Dong. 2024b.

</span>
<span class="ltx_bibblock">EAGER: Two-Stream Generative Recommender with Behavior-Semantic Collaboration. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining (KDD)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Fangzhao Wu, Ying Qiao, Jiun-Hung Chen, Chuhan Wu, Tao Qi, Jianxun Lian, Danyang Liu, Xing Xie, Jianfeng Gao, Winnie Wu, et al<span class="ltx_text" id="bib.bib37.3.1">.</span> 2020.

</span>
<span class="ltx_bibblock">Mind: A large-scale dataset for news recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.4.1">Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics</em>. 3597–3606.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xi et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yunjia Xi, Weiwen Liu, Jianghao Lin, Jieming Zhu, Bo Chen, Ruiming Tang, Weinan Zhang, Rui Zhang, and Yong Yu. 2023.

</span>
<span class="ltx_bibblock">Towards Open-World Recommendation with Knowledge Augmentation from Large Language Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">CoRR</em> abs/2306.10933 (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Ji Yang, Xinyang Yi, Derek Zhiyuan Cheng, Lichan Hong, Yang Li, Simon Xiaoming Wang, Taibai Xu, and Ed H. Chi. 2020.

</span>
<span class="ltx_bibblock">Mixed Negative Sampling for Learning Two-tower Neural Networks in Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">Companion of The 2020 Web Conference</em>. 441–447.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ying et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Rex Ying, Ruining He, Kaifeng Chen, Pong Eksombatchai, William L. Hamilton, and Jure Leskovec. 2018.

</span>
<span class="ltx_bibblock">Graph Convolutional Neural Networks for Web-Scale Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining (KDD)</em>. 974–983.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeghidour et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Neil Zeghidour, Alejandro Luebs, Ahmed Omran, Jan Skoglund, and Marco Tagliasacchi. 2021.

</span>
<span class="ltx_bibblock">Soundstream: An end-to-end neural audio codec.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">IEEE/ACM Transactions on Audio, Speech, and Language Processing</em> 30 (2021), 495–507.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Chao Zhang, Shiwei Wu, Haoxin Zhang, Tong Xu, Yan Gao, Yao Hu, and Enhong Chen. 2024.

</span>
<span class="ltx_bibblock">NoteLLM: A Retrievable Large Language Model for Note Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">Companion Proceedings of the ACM on Web Conference (WWW)</em>. 170–179.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yuan Zhang, Xue Dong, Weijie Ding, Biao Li, Peng Jiang, and Kun Gai. 2023.

</span>
<span class="ltx_bibblock">Divide and Conquer: Towards Better Embedding-based Retrieval for Recommender Systems from a Multi-task Perspective. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">Companion Proceedings of the ACM Web Conference (WWW)</em>. 366–370.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Bowen Zheng, Yupeng Hou, Hongyu Lu, Yu Chen, Wayne Xin Zhao, Ming Chen, and Ji-Rong Wen. 2024.

</span>
<span class="ltx_bibblock">Adapting Large Language Models by Integrating Collaborative Semantics for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">40th IEEE International Conference on Data Engineering (ICDE)</em>. 1435–1448.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Sep  7 16:10:08 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
